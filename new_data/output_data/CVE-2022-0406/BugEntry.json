{"buggy_code": ["# Security Policy\n\n## Reporting a Vulnerability\n\nPlease report security issues to ozzie.fernandez.isaacs@googlemail.com\n\n## Supported Versions\n\nTo receive fixes for security vulnerabilities it is required to always upgrade to the latest version of Calibre-Web. See https://github.com/janeczku/calibre-web/releases/latest for the latest release.\n\n## History\n\n| Fixed in      | Description                                                                                                        |CVE number |\n|---------------|--------------------------------------------------------------------------------------------------------------------|---------|\n| 3rd July 2018 | Guest access acts as a backdoor                                                                                    ||\n| V 0.6.7       | Hardcoded secret key for sessions                                                                                  |CVE-2020-12627 |\n| V 0.6.13      | Calibre-Web Metadata cross site scripting                                                                          |CVE-2021-25964|\n| V 0.6.13      | Name of Shelves are only visible to users who can access the corresponding shelf Thanks to @ibarrionuevo           ||\n| V 0.6.13      | JavaScript could get executed in the description field. Thanks to @ranjit-git  and Hagai Wechsler (WhiteSource)    ||\n| V 0.6.13      | JavaScript could get executed in a custom column of type \"comment\" field                                           ||\n| V 0.6.13      | JavaScript could get executed after converting a book to another format with a title containing javascript code    ||\n| V 0.6.13      | JavaScript could get executed after converting a book to another format with a username containing javascript code ||\n| V 0.6.13      | JavaScript could get executed in the description series, categories or publishers title                            ||\n| V 0.6.13      | JavaScript could get executed  in the shelf title                                                                  ||\n| V 0.6.13      | Login with the old session cookie after logout. Thanks to @ibarrionuevo                                            ||\n| V 0.6.14      | CSRF was possible. Thanks to @mik317 and Hagai Wechsler (WhiteSource)                                              |CVE-2021-25965|\n| V 0.6.14      | Migrated some routes to POST-requests (CSRF protection). Thanks to @scara31                                        ||\n| V 0.6.15      | Fix for \"javascript:\" script links in identifier. Thanks to @scara31                                               ||\n| V 0.6.15      | Cross-Site Scripting vulnerability on uploaded cover file names. Thanks to @ibarrionuevo                           ||\n| V 0.6.15      | Creating public shelfs is now denied if user is missing the edit public shelf right. Thanks to @ibarrionuevo       ||\n| V 0.6.15      | Changed error message in case of trying to delete a shelf unauthorized. Thanks to @ibarrionuevo                    ||\n\n\n## Staement regarding Log4j (CVE-2021-44228 and related)\n\nCalibre-web is not affected by bugs related to Log4j. Calibre-Web is a python program, therefore not using Java, and not using the Java logging feature log4j. \n", "# -*- coding: utf-8 -*-\n\n#   This file is part of the Calibre-Web (https://github.com/janeczku/calibre-web)\n#     Copyright (C) 2019 OzzieIsaacs, pwr\n#\n#   This program is free software: you can redistribute it and/or modify\n#   it under the terms of the GNU General Public License as published by\n#   the Free Software Foundation, either version 3 of the License, or\n#   (at your option) any later version.\n#\n#   This program is distributed in the hope that it will be useful,\n#   but WITHOUT ANY WARRANTY; without even the implied warranty of\n#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n#   GNU General Public License for more details.\n#\n#   You should have received a copy of the GNU General Public License\n#   along with this program. If not, see <http://www.gnu.org/licenses/>.\n\nimport sys\nimport os\nfrom collections import namedtuple\nfrom sqlalchemy import __version__ as sql_version\n\nsqlalchemy_version2 = ([int(x) for x in sql_version.split('.')] >= [2,0,0])\n\n# if installed via pip this variable is set to true (empty file with name .HOMEDIR present)\nHOME_CONFIG = os.path.isfile(os.path.join(os.path.dirname(os.path.abspath(__file__)), '.HOMEDIR'))\n\n#In executables updater is not available, so variable is set to False there\nUPDATER_AVAILABLE = True\n\n# Base dir is parent of current file, necessary if called from different folder\nBASE_DIR            = os.path.abspath(os.path.join(os.path.dirname(os.path.abspath(__file__)),os.pardir))\nSTATIC_DIR          = os.path.join(BASE_DIR, 'cps', 'static')\nTEMPLATES_DIR       = os.path.join(BASE_DIR, 'cps', 'templates')\nTRANSLATIONS_DIR    = os.path.join(BASE_DIR, 'cps', 'translations')\n\nif HOME_CONFIG:\n    home_dir = os.path.join(os.path.expanduser(\"~\"),\".calibre-web\")\n    if not os.path.exists(home_dir):\n        os.makedirs(home_dir)\n    CONFIG_DIR = os.environ.get('CALIBRE_DBPATH', home_dir)\nelse:\n    CONFIG_DIR = os.environ.get('CALIBRE_DBPATH', BASE_DIR)\n\n\nROLE_USER               = 0 << 0\nROLE_ADMIN              = 1 << 0\nROLE_DOWNLOAD           = 1 << 1\nROLE_UPLOAD             = 1 << 2\nROLE_EDIT               = 1 << 3\nROLE_PASSWD             = 1 << 4\nROLE_ANONYMOUS          = 1 << 5\nROLE_EDIT_SHELFS        = 1 << 6\nROLE_DELETE_BOOKS       = 1 << 7\nROLE_VIEWER             = 1 << 8\n\nALL_ROLES = {\n                \"admin_role\": ROLE_ADMIN,\n                \"download_role\": ROLE_DOWNLOAD,\n                \"upload_role\": ROLE_UPLOAD,\n                \"edit_role\": ROLE_EDIT,\n                \"passwd_role\": ROLE_PASSWD,\n                \"edit_shelf_role\": ROLE_EDIT_SHELFS,\n                \"delete_role\": ROLE_DELETE_BOOKS,\n                \"viewer_role\": ROLE_VIEWER,\n            }\n\nDETAIL_RANDOM           = 1 <<  0\nSIDEBAR_LANGUAGE        = 1 <<  1\nSIDEBAR_SERIES          = 1 <<  2\nSIDEBAR_CATEGORY        = 1 <<  3\nSIDEBAR_HOT             = 1 <<  4\nSIDEBAR_RANDOM          = 1 <<  5\nSIDEBAR_AUTHOR          = 1 <<  6\nSIDEBAR_BEST_RATED      = 1 <<  7\nSIDEBAR_READ_AND_UNREAD = 1 <<  8\nSIDEBAR_RECENT          = 1 <<  9\nSIDEBAR_SORTED          = 1 << 10\nMATURE_CONTENT          = 1 << 11\nSIDEBAR_PUBLISHER       = 1 << 12\nSIDEBAR_RATING          = 1 << 13\nSIDEBAR_FORMAT          = 1 << 14\nSIDEBAR_ARCHIVED        = 1 << 15\nSIDEBAR_DOWNLOAD        = 1 << 16\nSIDEBAR_LIST            = 1 << 17\n\nsidebar_settings = {\n                \"detail_random\": DETAIL_RANDOM,\n                \"sidebar_language\": SIDEBAR_LANGUAGE,\n                \"sidebar_series\": SIDEBAR_SERIES,\n                \"sidebar_category\": SIDEBAR_CATEGORY,\n                \"sidebar_random\": SIDEBAR_RANDOM,\n                \"sidebar_author\": SIDEBAR_AUTHOR,\n                \"sidebar_best_rated\": SIDEBAR_BEST_RATED,\n                \"sidebar_read_and_unread\": SIDEBAR_READ_AND_UNREAD,\n                \"sidebar_recent\": SIDEBAR_RECENT,\n                \"sidebar_sorted\": SIDEBAR_SORTED,\n                \"sidebar_publisher\": SIDEBAR_PUBLISHER,\n                \"sidebar_rating\": SIDEBAR_RATING,\n                \"sidebar_format\": SIDEBAR_FORMAT,\n                \"sidebar_archived\": SIDEBAR_ARCHIVED,\n                \"sidebar_download\": SIDEBAR_DOWNLOAD,\n                \"sidebar_list\": SIDEBAR_LIST,\n            }\n\n\nADMIN_USER_ROLES        = sum(r for r in ALL_ROLES.values()) & ~ROLE_ANONYMOUS\nADMIN_USER_SIDEBAR      = (SIDEBAR_LIST << 1) - 1\n\nUPDATE_STABLE       = 0 << 0\nAUTO_UPDATE_STABLE  = 1 << 0\nUPDATE_NIGHTLY      = 1 << 1\nAUTO_UPDATE_NIGHTLY = 1 << 2\n\nLOGIN_STANDARD      = 0\nLOGIN_LDAP          = 1\nLOGIN_OAUTH         = 2\n\nLDAP_AUTH_ANONYMOUS      = 0\nLDAP_AUTH_UNAUTHENTICATE = 1\nLDAP_AUTH_SIMPLE         = 0\n\nDEFAULT_MAIL_SERVER = \"mail.example.org\"\n\nDEFAULT_PASSWORD    = \"admin123\"  # nosec\nDEFAULT_PORT        = 8083\nenv_CALIBRE_PORT = os.environ.get(\"CALIBRE_PORT\", DEFAULT_PORT)\ntry:\n    DEFAULT_PORT = int(env_CALIBRE_PORT)\nexcept ValueError:\n    print('Environment variable CALIBRE_PORT has invalid value (%s), faling back to default (8083)' % env_CALIBRE_PORT)\ndel env_CALIBRE_PORT\n\n\nEXTENSIONS_AUDIO    = {'mp3', 'mp4', 'ogg', 'opus', 'wav', 'flac', 'm4a', 'm4b'}\nEXTENSIONS_CONVERT_FROM  = ['pdf', 'epub', 'mobi', 'azw3', 'docx', 'rtf', 'fb2', 'lit', 'lrf', 'txt', 'htmlz', 'rtf', 'odt','cbz','cbr']\nEXTENSIONS_CONVERT_TO  = ['pdf', 'epub', 'mobi', 'azw3', 'docx', 'rtf', 'fb2', 'lit', 'lrf', 'txt', 'htmlz', 'rtf', 'odt']\nEXTENSIONS_UPLOAD   = {'txt', 'pdf', 'epub', 'kepub', 'mobi', 'azw', 'azw3', 'cbr', 'cbz', 'cbt', 'djvu', 'prc', 'doc', 'docx',\n                       'fb2', 'html', 'rtf', 'lit', 'odt', 'mp3', 'mp4', 'ogg', 'opus', 'wav', 'flac', 'm4a', 'm4b'}\n\n\ndef has_flag(value, bit_flag):\n    return bit_flag == (bit_flag & (value or 0))\n\ndef selected_roles(dictionary):\n    return sum(v for k, v in ALL_ROLES.items() if k in dictionary)\n\n\n# :rtype: BookMeta\nBookMeta = namedtuple('BookMeta', 'file_path, extension, title, author, cover, description, tags, series, '\n                                  'series_id, languages, publisher')\n\nSTABLE_VERSION = {'version': '0.6.16 Beta'}\n\nNIGHTLY_VERSION = {}\nNIGHTLY_VERSION[0] = '$Format:%H$'\nNIGHTLY_VERSION[1] = '$Format:%cI$'\n# NIGHTLY_VERSION[0] = 'bb7d2c6273ae4560e83950d36d64533343623a57'\n# NIGHTLY_VERSION[1] = '2018-09-09T10:13:08+02:00'\n\n\n# clean-up the module namespace\ndel sys, os, namedtuple\n"], "fixing_code": ["# Security Policy\n\n## Reporting a Vulnerability\n\nPlease report security issues to ozzie.fernandez.isaacs@googlemail.com\n\n## Supported Versions\n\nTo receive fixes for security vulnerabilities it is required to always upgrade to the latest version of Calibre-Web. See https://github.com/janeczku/calibre-web/releases/latest for the latest release.\n\n## History\n\n| Fixed in      | Description                                                                                                        |CVE number |\n|---------------|--------------------------------------------------------------------------------------------------------------------|---------|\n| 3rd July 2018 | Guest access acts as a backdoor                                                                                    ||\n| V 0.6.7       | Hardcoded secret key for sessions                                                                                  |CVE-2020-12627 |\n| V 0.6.13      | Calibre-Web Metadata cross site scripting                                                                          |CVE-2021-25964|\n| V 0.6.13      | Name of Shelves are only visible to users who can access the corresponding shelf Thanks to @ibarrionuevo           ||\n| V 0.6.13      | JavaScript could get executed in the description field. Thanks to @ranjit-git  and Hagai Wechsler (WhiteSource)    ||\n| V 0.6.13      | JavaScript could get executed in a custom column of type \"comment\" field                                           ||\n| V 0.6.13      | JavaScript could get executed after converting a book to another format with a title containing javascript code    ||\n| V 0.6.13      | JavaScript could get executed after converting a book to another format with a username containing javascript code ||\n| V 0.6.13      | JavaScript could get executed in the description series, categories or publishers title                            ||\n| V 0.6.13      | JavaScript could get executed  in the shelf title                                                                  ||\n| V 0.6.13      | Login with the old session cookie after logout. Thanks to @ibarrionuevo                                            ||\n| V 0.6.14      | CSRF was possible. Thanks to @mik317 and Hagai Wechsler (WhiteSource)                                              |CVE-2021-25965|\n| V 0.6.14      | Migrated some routes to POST-requests (CSRF protection). Thanks to @scara31                                        ||\n| V 0.6.15      | Fix for \"javascript:\" script links in identifier. Thanks to @scara31                                               ||\n| V 0.6.15      | Cross-Site Scripting vulnerability on uploaded cover file names. Thanks to @ibarrionuevo                           ||\n| V 0.6.15      | Creating public shelfs is now denied if user is missing the edit public shelf right. Thanks to @ibarrionuevo       ||\n| V 0.6.15      | Changed error message in case of trying to delete a shelf unauthorized. Thanks to @ibarrionuevo                    ||\n| V 0.6.16      | JavaScript could get executed on authors page. Thanks to @alicaz                                                   ||\n| V 0.6.16      | Localhost can no longer be used to upload covers. Thanks to @scara31                                               ||\n| V 0.6.16      | Another case where public shelfs could be created without permission is prevented. Thanks to @ibarrionuevo         ||\n\n\n## Staement regarding Log4j (CVE-2021-44228 and related)\n\nCalibre-web is not affected by bugs related to Log4j. Calibre-Web is a python program, therefore not using Java, and not using the Java logging feature log4j. \n", "# -*- coding: utf-8 -*-\n\n#   This file is part of the Calibre-Web (https://github.com/janeczku/calibre-web)\n#     Copyright (C) 2019 OzzieIsaacs, pwr\n#\n#   This program is free software: you can redistribute it and/or modify\n#   it under the terms of the GNU General Public License as published by\n#   the Free Software Foundation, either version 3 of the License, or\n#   (at your option) any later version.\n#\n#   This program is distributed in the hope that it will be useful,\n#   but WITHOUT ANY WARRANTY; without even the implied warranty of\n#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n#   GNU General Public License for more details.\n#\n#   You should have received a copy of the GNU General Public License\n#   along with this program. If not, see <http://www.gnu.org/licenses/>.\n\nimport sys\nimport os\nfrom collections import namedtuple\nfrom sqlalchemy import __version__ as sql_version\n\nsqlalchemy_version2 = ([int(x) for x in sql_version.split('.')] >= [2,0,0])\n\n# if installed via pip this variable is set to true (empty file with name .HOMEDIR present)\nHOME_CONFIG = os.path.isfile(os.path.join(os.path.dirname(os.path.abspath(__file__)), '.HOMEDIR'))\n\n#In executables updater is not available, so variable is set to False there\nUPDATER_AVAILABLE = True\n\n# Base dir is parent of current file, necessary if called from different folder\nBASE_DIR            = os.path.abspath(os.path.join(os.path.dirname(os.path.abspath(__file__)),os.pardir))\nSTATIC_DIR          = os.path.join(BASE_DIR, 'cps', 'static')\nTEMPLATES_DIR       = os.path.join(BASE_DIR, 'cps', 'templates')\nTRANSLATIONS_DIR    = os.path.join(BASE_DIR, 'cps', 'translations')\n\nif HOME_CONFIG:\n    home_dir = os.path.join(os.path.expanduser(\"~\"),\".calibre-web\")\n    if not os.path.exists(home_dir):\n        os.makedirs(home_dir)\n    CONFIG_DIR = os.environ.get('CALIBRE_DBPATH', home_dir)\nelse:\n    CONFIG_DIR = os.environ.get('CALIBRE_DBPATH', BASE_DIR)\n\n\nROLE_USER               = 0 << 0\nROLE_ADMIN              = 1 << 0\nROLE_DOWNLOAD           = 1 << 1\nROLE_UPLOAD             = 1 << 2\nROLE_EDIT               = 1 << 3\nROLE_PASSWD             = 1 << 4\nROLE_ANONYMOUS          = 1 << 5\nROLE_EDIT_SHELFS        = 1 << 6\nROLE_DELETE_BOOKS       = 1 << 7\nROLE_VIEWER             = 1 << 8\n\nALL_ROLES = {\n                \"admin_role\": ROLE_ADMIN,\n                \"download_role\": ROLE_DOWNLOAD,\n                \"upload_role\": ROLE_UPLOAD,\n                \"edit_role\": ROLE_EDIT,\n                \"passwd_role\": ROLE_PASSWD,\n                \"edit_shelf_role\": ROLE_EDIT_SHELFS,\n                \"delete_role\": ROLE_DELETE_BOOKS,\n                \"viewer_role\": ROLE_VIEWER,\n            }\n\nDETAIL_RANDOM           = 1 <<  0\nSIDEBAR_LANGUAGE        = 1 <<  1\nSIDEBAR_SERIES          = 1 <<  2\nSIDEBAR_CATEGORY        = 1 <<  3\nSIDEBAR_HOT             = 1 <<  4\nSIDEBAR_RANDOM          = 1 <<  5\nSIDEBAR_AUTHOR          = 1 <<  6\nSIDEBAR_BEST_RATED      = 1 <<  7\nSIDEBAR_READ_AND_UNREAD = 1 <<  8\nSIDEBAR_RECENT          = 1 <<  9\nSIDEBAR_SORTED          = 1 << 10\nMATURE_CONTENT          = 1 << 11\nSIDEBAR_PUBLISHER       = 1 << 12\nSIDEBAR_RATING          = 1 << 13\nSIDEBAR_FORMAT          = 1 << 14\nSIDEBAR_ARCHIVED        = 1 << 15\nSIDEBAR_DOWNLOAD        = 1 << 16\nSIDEBAR_LIST            = 1 << 17\n\nsidebar_settings = {\n                \"detail_random\": DETAIL_RANDOM,\n                \"sidebar_language\": SIDEBAR_LANGUAGE,\n                \"sidebar_series\": SIDEBAR_SERIES,\n                \"sidebar_category\": SIDEBAR_CATEGORY,\n                \"sidebar_random\": SIDEBAR_RANDOM,\n                \"sidebar_author\": SIDEBAR_AUTHOR,\n                \"sidebar_best_rated\": SIDEBAR_BEST_RATED,\n                \"sidebar_read_and_unread\": SIDEBAR_READ_AND_UNREAD,\n                \"sidebar_recent\": SIDEBAR_RECENT,\n                \"sidebar_sorted\": SIDEBAR_SORTED,\n                \"sidebar_publisher\": SIDEBAR_PUBLISHER,\n                \"sidebar_rating\": SIDEBAR_RATING,\n                \"sidebar_format\": SIDEBAR_FORMAT,\n                \"sidebar_archived\": SIDEBAR_ARCHIVED,\n                \"sidebar_download\": SIDEBAR_DOWNLOAD,\n                \"sidebar_list\": SIDEBAR_LIST,\n            }\n\n\nADMIN_USER_ROLES        = sum(r for r in ALL_ROLES.values()) & ~ROLE_ANONYMOUS\nADMIN_USER_SIDEBAR      = (SIDEBAR_LIST << 1) - 1\n\nUPDATE_STABLE       = 0 << 0\nAUTO_UPDATE_STABLE  = 1 << 0\nUPDATE_NIGHTLY      = 1 << 1\nAUTO_UPDATE_NIGHTLY = 1 << 2\n\nLOGIN_STANDARD      = 0\nLOGIN_LDAP          = 1\nLOGIN_OAUTH         = 2\n\nLDAP_AUTH_ANONYMOUS      = 0\nLDAP_AUTH_UNAUTHENTICATE = 1\nLDAP_AUTH_SIMPLE         = 0\n\nDEFAULT_MAIL_SERVER = \"mail.example.org\"\n\nDEFAULT_PASSWORD    = \"admin123\"  # nosec\nDEFAULT_PORT        = 8083\nenv_CALIBRE_PORT = os.environ.get(\"CALIBRE_PORT\", DEFAULT_PORT)\ntry:\n    DEFAULT_PORT = int(env_CALIBRE_PORT)\nexcept ValueError:\n    print('Environment variable CALIBRE_PORT has invalid value (%s), faling back to default (8083)' % env_CALIBRE_PORT)\ndel env_CALIBRE_PORT\n\n\nEXTENSIONS_AUDIO    = {'mp3', 'mp4', 'ogg', 'opus', 'wav', 'flac', 'm4a', 'm4b'}\nEXTENSIONS_CONVERT_FROM  = ['pdf', 'epub', 'mobi', 'azw3', 'docx', 'rtf', 'fb2', 'lit', 'lrf', 'txt', 'htmlz', 'rtf', 'odt','cbz','cbr']\nEXTENSIONS_CONVERT_TO  = ['pdf', 'epub', 'mobi', 'azw3', 'docx', 'rtf', 'fb2', 'lit', 'lrf', 'txt', 'htmlz', 'rtf', 'odt']\nEXTENSIONS_UPLOAD   = {'txt', 'pdf', 'epub', 'kepub', 'mobi', 'azw', 'azw3', 'cbr', 'cbz', 'cbt', 'djvu', 'prc', 'doc', 'docx',\n                       'fb2', 'html', 'rtf', 'lit', 'odt', 'mp3', 'mp4', 'ogg', 'opus', 'wav', 'flac', 'm4a', 'm4b'}\n\n\ndef has_flag(value, bit_flag):\n    return bit_flag == (bit_flag & (value or 0))\n\ndef selected_roles(dictionary):\n    return sum(v for k, v in ALL_ROLES.items() if k in dictionary)\n\n\n# :rtype: BookMeta\nBookMeta = namedtuple('BookMeta', 'file_path, extension, title, author, cover, description, tags, series, '\n                                  'series_id, languages, publisher')\n\nSTABLE_VERSION = {'version': '0.6.16'}\n\nNIGHTLY_VERSION = {}\nNIGHTLY_VERSION[0] = '$Format:%H$'\nNIGHTLY_VERSION[1] = '$Format:%cI$'\n# NIGHTLY_VERSION[0] = 'bb7d2c6273ae4560e83950d36d64533343623a57'\n# NIGHTLY_VERSION[1] = '2018-09-09T10:13:08+02:00'\n\n\n# clean-up the module namespace\ndel sys, os, namedtuple\n"], "filenames": ["SECURITY.md", "cps/constants.py"], "buggy_code_start_loc": [31, 154], "buggy_code_end_loc": [31, 155], "fixing_code_start_loc": [32, 154], "fixing_code_end_loc": [35, 155], "type": "CWE-863", "message": "Improper Authorization in GitHub repository janeczku/calibre-web prior to 0.6.16.", "other": {"cve": {"id": "CVE-2022-0406", "sourceIdentifier": "security@huntr.dev", "published": "2022-04-03T19:15:07.880", "lastModified": "2022-04-09T15:52:49.447", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Improper Authorization in GitHub repository janeczku/calibre-web prior to 0.6.16."}, {"lang": "es", "value": "Una Autorizaci\u00f3n Inapropiada en el repositorio de GitHub janeczku/calibre-web versiones anteriores a 0.6.16"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-863"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-285"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:calibre-web_project:calibre-web:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.6.16", "matchCriteriaId": "617B843B-6C45-4C15-B38C-03A1E9052D91"}]}]}], "references": [{"url": "https://github.com/janeczku/calibre-web/commit/e0e04220109920575179a8f924543449c6de0706", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/d7498799-4797-4751-b5e2-b669e729d5db", "source": "security@huntr.dev", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/janeczku/calibre-web/commit/e0e04220109920575179a8f924543449c6de0706"}}