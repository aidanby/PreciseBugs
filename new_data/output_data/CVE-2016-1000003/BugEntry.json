{"buggy_code": ["# -*- coding: utf-8 -*-\n#\n# Copyright \u00a9 2014  Red Hat, Inc.\n#\n# This copyrighted material is made available to anyone wishing to use,\n# modify, copy, or redistribute it subject to the terms and conditions\n# of the GNU General Public License v.2, or (at your option) any later\n# version.  This program is distributed in the hope that it will be\n# useful, but WITHOUT ANY WARRANTY expressed or implied, including the\n# implied warranties of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n# PURPOSE.  See the GNU General Public License for more details.  You\n# should have received a copy of the GNU General Public License along\n# with this program; if not, write to the Free Software Foundation,\n# Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.\n#\n# Any Red Hat trademarks that are incorporated in the source\n# code or documentation are not subject to the GNU General Public\n# License and may only be used or replicated with the express permission\n# of Red Hat, Inc.\n#\n\n'''\nMirrorManager2 xmlrpc controller.\n'''\n\nimport base64\nimport pickle\nimport bz2\n\nimport flask\nfrom flaskext.xmlrpc import XMLRPCHandler, Fault\n\nfrom mirrormanager2.app import APP, ADMIN, SESSION\nfrom mirrormanager2.lib import model\nfrom mirrormanager2.lib.hostconfig import read_host_config\n\n\nXMLRPC = XMLRPCHandler('xmlrpc')\nXMLRPC.connect(APP, '/xmlrpc')\n\n\n@XMLRPC.register\ndef checkin(pickledata):\n    config = pickle.loads(bz2.decompress(base64.urlsafe_b64decode(pickledata)))\n    r, message = read_host_config(SESSION, config)\n    if r is not None:\n        return message + 'checked in successful'\n    else:\n        return message + 'error checking in'\n"], "fixing_code": ["# -*- coding: utf-8 -*-\n#\n# Copyright \u00a9 2014  Red Hat, Inc.\n#\n# This copyrighted material is made available to anyone wishing to use,\n# modify, copy, or redistribute it subject to the terms and conditions\n# of the GNU General Public License v.2, or (at your option) any later\n# version.  This program is distributed in the hope that it will be\n# useful, but WITHOUT ANY WARRANTY expressed or implied, including the\n# implied warranties of MERCHANTABILITY or FITNESS FOR A PARTICULAR\n# PURPOSE.  See the GNU General Public License for more details.  You\n# should have received a copy of the GNU General Public License along\n# with this program; if not, write to the Free Software Foundation,\n# Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.\n#\n# Any Red Hat trademarks that are incorporated in the source\n# code or documentation are not subject to the GNU General Public\n# License and may only be used or replicated with the express permission\n# of Red Hat, Inc.\n#\n\n'''\nMirrorManager2 xmlrpc controller.\n'''\n\nimport base64\nimport pickle\nimport json\nimport bz2\n\nimport flask\nfrom flaskext.xmlrpc import XMLRPCHandler, Fault\n\nfrom mirrormanager2.app import APP, ADMIN, SESSION\nfrom mirrormanager2.lib import model\nfrom mirrormanager2.lib.hostconfig import read_host_config\n\n\nXMLRPC = XMLRPCHandler('xmlrpc')\nXMLRPC.connect(APP, '/xmlrpc')\n\n\n@XMLRPC.register\ndef checkin(pickledata):\n    uncompressed = bz2.decompress(base64.urlsafe_b64decode(pickledata))\n    try:\n        config = json.loads(uncompressed)\n    except ValueError:\n        config = pickle.loads(uncompressed)\n    r, message = read_host_config(SESSION, config)\n    if r is not None:\n        return message + 'checked in successful'\n    else:\n        return message + 'error checking in'\n"], "filenames": ["mirrormanager2/xmlrpc.py"], "buggy_code_start_loc": [27], "buggy_code_end_loc": [45], "fixing_code_start_loc": [28], "fixing_code_end_loc": [50], "type": "CWE-94", "message": "Mirror Manager version 0.7.2 and older is vulnerable to remote code execution in the checkin code.", "other": {"cve": {"id": "CVE-2016-1000003", "sourceIdentifier": "cve@mitre.org", "published": "2016-10-07T18:59:01.303", "lastModified": "2016-12-22T14:40:13.323", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Mirror Manager version 0.7.2 and older is vulnerable to remote code execution in the checkin code."}, {"lang": "es", "value": "Mirror Manager versi\u00f3n 0.7.2 y versiones m\u00e1s antiguas es vulnerable a ejecuci\u00f3n remota de c\u00f3digo en el c\u00f3digo de control."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mirror_manager_project:mirror_manager:*:*:*:*:*:*:*:*", "versionEndIncluding": "0.7.2", "matchCriteriaId": "E2E59D78-9780-40B9-B19A-343EDD46073C"}]}]}], "references": [{"url": "https://github.com/fedora-infra/mirrormanager2/commit/2e227f6023477cbdbefd577f15d0846aa40c8775.patch", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/fedora-infra/mirrormanager2/commit/eb9b542bc818071b9eee41c3583b7e6e172b3a53.patch", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/fedora-infra/mirrormanager2/commit/2e227f6023477cbdbefd577f15d0846aa40c8775.patch"}}