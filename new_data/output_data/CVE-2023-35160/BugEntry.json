{"buggy_code": ["## ---------------------------------------------------------------------------\n## See the NOTICE file distributed with this work for additional\n## information regarding copyright ownership.\n##\n## This is free software; you can redistribute it and/or modify it\n## under the terms of the GNU Lesser General Public License as\n## published by the Free Software Foundation; either version 2.1 of\n## the License, or (at your option) any later version.\n##\n## This software is distributed in the hope that it will be useful,\n## but WITHOUT ANY WARRANTY; without even the implied warranty of\n## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n## Lesser General Public License for more details.\n##\n## You should have received a copy of the GNU Lesser General Public\n## License along with this software; if not, write to the Free\n## Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n## 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n## ---------------------------------------------------------------------------\n###\n### Resubmission page\n###\n$response.setStatus(401)##\n##\n## This page shouldn't be displayed in an IFRAME, in order to prevent clickjacking.\n##\n$response.addHeader( \"X-FRAME-OPTIONS\", \"DENY\" )\n#template(\"startpage.vm\")\n<div class=\"main layoutsubsection\">\n<div id=\"mainContentArea\">\n#xwikimessageboxstart($services.localization.render('warning') $services.localization.render('csrf.confirmation'))\n#set($resubmit = \"$!{escapetool.xml($request.getParameter('resubmit'))}\")\n#set($xback = \"$!{escapetool.xml($request.getParameter('xback'))}\")\n<form action=\"$resubmit\" method=\"post\">\n  <div class=\"hidden\">\n    ## Valid CSRF token\n    <input type=\"hidden\" name=\"form_token\" value=\"$!{services.csrf.getToken()}\" />\n  </div>\n  <div class=\"buttonwrapper\"><input type=\"submit\" class=\"button\" value=\"$services.localization.render('yes')\"/></div>\n  <div class=\"buttonwrapper\"><a class=\"secondary button\" href=\"$xback\">$services.localization.render('no')</a></div>\n</form>\n#xwikimessageboxend()\n<div class=\"clearfloats\"></div>\n</div>## mainContentArea\n</div>## main\n#template(\"endpage.vm\")\n\n"], "fixing_code": ["## ---------------------------------------------------------------------------\n## See the NOTICE file distributed with this work for additional\n## information regarding copyright ownership.\n##\n## This is free software; you can redistribute it and/or modify it\n## under the terms of the GNU Lesser General Public License as\n## published by the Free Software Foundation; either version 2.1 of\n## the License, or (at your option) any later version.\n##\n## This software is distributed in the hope that it will be useful,\n## but WITHOUT ANY WARRANTY; without even the implied warranty of\n## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n## Lesser General Public License for more details.\n##\n## You should have received a copy of the GNU Lesser General Public\n## License along with this software; if not, write to the Free\n## Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n## 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n## ---------------------------------------------------------------------------\n###\n### Resubmission page\n###\n$response.setStatus(401)##\n##\n## This page shouldn't be displayed in an IFRAME, in order to prevent clickjacking.\n##\n$response.addHeader( \"X-FRAME-OPTIONS\", \"DENY\" )\n#template(\"startpage.vm\")\n<div class=\"main layoutsubsection\">\n<div id=\"mainContentArea\">\n#xwikimessageboxstart($services.localization.render('warning') $services.localization.render('csrf.confirmation'))\n#getSanitizedURLAttributeValue('form','action', $request.getParameter('resubmit'), '', $resubmit)\n#getSanitizedURLAttributeValue('a','href', $request.getParameter('xback'), $doc.getURL(), $xback)\n<form action=\"$resubmit\" method=\"post\">\n  <div class=\"hidden\">\n    ## Valid CSRF token\n    <input type=\"hidden\" name=\"form_token\" value=\"$!{services.csrf.getToken()}\" />\n  </div>\n  <div class=\"buttonwrapper\"><input type=\"submit\" class=\"button\" value=\"$services.localization.render('yes')\"/></div>\n  <div class=\"buttonwrapper\"><a class=\"secondary button\" href=\"$xback\">$services.localization.render('no')</a></div>\n</form>\n#xwikimessageboxend()\n<div class=\"clearfloats\"></div>\n</div>## mainContentArea\n</div>## main\n#template(\"endpage.vm\")\n\n"], "filenames": ["xwiki-platform-core/xwiki-platform-web/xwiki-platform-web-templates/src/main/resources/templates/resubmit.vm"], "buggy_code_start_loc": [32], "buggy_code_end_loc": [34], "fixing_code_start_loc": [32], "fixing_code_end_loc": [34], "type": "CWE-79", "message": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Users are able to forge an URL with a payload allowing to inject Javascript in the page (XSS). It's possible to exploit the resubmit template to perform a XSS, e.g. by using URL such as: > xwiki/bin/view/XWiki/Main xpage=resubmit&resubmit=javascript:alert(document.domain)&xback=javascript:alert(document.domain). This vulnerability exists since XWiki 2.5-milestone-2. The vulnerability has been patched in XWiki 14.10.5 and 15.1-rc-1.", "other": {"cve": {"id": "CVE-2023-35160", "sourceIdentifier": "security-advisories@github.com", "published": "2023-06-23T19:15:09.570", "lastModified": "2023-06-30T13:11:43.243", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Users are able to forge an URL with a payload allowing to inject Javascript in the page (XSS). It's possible to exploit the resubmit template to perform a XSS, e.g. by using URL such as: > xwiki/bin/view/XWiki/Main xpage=resubmit&resubmit=javascript:alert(document.domain)&xback=javascript:alert(document.domain). This vulnerability exists since XWiki 2.5-milestone-2. The vulnerability has been patched in XWiki 14.10.5 and 15.1-rc-1."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.6, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.8, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-87"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "3.0", "versionEndExcluding": "14.10.5", "matchCriteriaId": "2589701B-EB0C-4EAF-B4D7-16EC9C4CD94B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:2.5:milestone2:*:*:*:*:*:*", "matchCriteriaId": "37D367C2-4799-4133-AEAC-18B6269481FB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:15.0:*:*:*:*:*:*:*", "matchCriteriaId": "8F9D9551-B148-44B6-A5B3-889E6E7B72E8"}]}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/dbc92dcdace33823ffd1e1591617006cb5fc6a7f", "source": "security-advisories@github.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-r8xc-xxh3-q5x3", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://jira.xwiki.org/browse/XWIKI-20343", "source": "security-advisories@github.com", "tags": ["Issue Tracking", "Permissions Required", "Vendor Advisory"]}, {"url": "https://jira.xwiki.org/browse/XWIKI-20583", "source": "security-advisories@github.com", "tags": ["Issue Tracking", "Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/xwiki/xwiki-platform/commit/dbc92dcdace33823ffd1e1591617006cb5fc6a7f"}}