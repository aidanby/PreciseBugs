{"buggy_code": ["<?php\r\n/*\r\n Plugin Name: 404Like\r\n Plugin URI: http://www.gnetos.de/projekte/404Like\r\n Description: Es wird keine 404 Fehlermeldung ausgegeben, sondern nach \u00e4hnlichen Seiten gesucht und auf eventuelle Treffer weitergeleitet oder eine Liste m\u00f6glicher Treffer ausgegeben / It is not issued any 404 error message, but looking for similar sites and forwarded to any results or output a list of possible matches\r\n Version: 1.0\r\n Author: Tobias Gafner\r\n Author URI: http://www.gnetos.de\r\n License: GPL2\r\n */\r\n\r\n/*  Copyright 2010  Tobias Gafner  (email : tobi@gnetos.de) \r\n\r\nThis program is free software; you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License, version 2, as\r\npublished by the Free Software Foundation.\r\n\r\nThis program is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\n\r\nYou should have received a copy of the GNU General Public License\r\nalong with this program; if not, write to the Free Software\r\nFoundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\r\n*/\r\n/**\r\n * Search function\r\n */ \r\nfunction findPostWhereLikeNameTitle($title = \"\") {\r\n\t$where .= \" (post_type = 'post' OR post_type = 'page') AND\r\n    post_status = 'publish' AND (post_name like '%\".$title.\"%' OR post_title like '%\".$title.\"%')\";\r\n\treturn $where;\r\n}\r\n/**\r\n * Search function\r\n */ \r\nfunction findPostWhereLike($title = \"\") {\r\n\t$where = \" (post_type = 'post' OR post_type = 'page') AND\r\n    post_status = 'publish' AND (post_title like '%\".$title.\"%')\";\r\n\treturn $where;\r\n}\r\n/**\r\n *  this function must call in your 404 Page\r\n *  \r\n *  <?php checkPage(); ? >\r\n    <?php\r\n    get_header();\r\n    ? >\r\n    .....\r\n *\r\n */  \r\nfunction checkPage() {\r\n\tglobal $wpdb;\r\n\r\n  $urltext =  $_SERVER['REQUEST_URI'];\r\n\t//$urltexta = substr($urltext,1);\r\n\t$urltext = trim($urltext);\r\n  //Letztes / loeschen\r\n  $urltext = htmlspecialchars($urltext); \r\n  if(strlen($urltext) != 0)   {\r\n    //Letztes Zeichen ist ?\r\n    if(substr ($urltext , -1,1) == \"/\") {\r\n      $urltext = substr ($urltext , 0,-1);\r\n    }\r\n    //Letztes von xxx/xxxx/xxx ist interessant\r\n    $searchWord = \tsubstr (strrchr ($urltext, \"/\"), 1);\r\n    //SQL \r\n    $querystr = \"SELECT * FROM $wpdb->posts WHERE \".findPostWhereLike($searchWord);\r\n    $pageposts = $wpdb->get_col($querystr);\r\n    if ($pageposts) {\r\n      ob_start();\r\n  \t\tif (count($pageposts) == 1) { \r\n      \tforeach ($pageposts as $id) {\r\n          $url = get_permalink($id); \r\n          echo $inhalt;\r\n          wp_redirect($url,301);\r\n          // Okay, stop.\r\n        }         \r\n        \r\n        wp_reset_query();               \r\n        ob_end_flush();     \r\n  \t\t}\r\n  \t}\r\n  }\r\n}\r\n\r\n/**\r\n * Result List by many results\r\n * \r\n * example:\r\n * ...</p>\r\n        < ? php new404ErrorPage(); ? >      \r\n\t....  \r\n */ \r\nfunction new404ErrorPage() {\r\n\tglobal $wpdb;\r\n\r\n  $urltext =  $_SERVER['REQUEST_URI'];\r\n  $urltext = trim($urltext);\r\n  //Letztes / loeschen\r\n  $urltext = htmlspecialchars($urltext); \r\n  if(strlen($urltext) != 0)   {\r\n    //Letztes Zeichen ist ?\r\n    if(substr ($urltext , -1,1) == \"/\") {\r\n      $urltext = substr ($urltext , 0,-1);\r\n    }                          \r\n    //Letztes von xxx/xxxx/xxx ist interessant\r\n    $searchWord = \tsubstr (strrchr ($urltext, \"/\"), 1);\r\n    //SQL\r\n    $querystr = \"SELECT *  FROM $wpdb->posts WHERE \".findPostWhereLikeNameTitle($searchWord);   \r\n    $pageposts = $wpdb->get_col($querystr);\r\n    if ($pageposts) {\r\n    //Ausgabe\r\n      echo '<div id=\"errorresults\"><h2 class=\"twost\">Folgendes Gesucht ?</h2><ul>';\r\n    \tforeach ($pageposts as $id) {\r\n        $post_id_7 = get_post($id);\r\n        $url = get_permalink($id);  \r\n        $title = $post_id_7->post_title;\r\n        echo \"<li>\".'<a href=\"'.$url.'\">'.$title.\"</a></li>\";\r\n    \t}\r\n    \techo \"</ul></div>\";\r\n    }\r\n  \t//Reset Query\r\n  \twp_reset_query();\r\n\t}\r\n}\r\n?>", "=== Plugin Name ===\nContributors: tobig\nDonate link: http://www.gnetos.de\nTags: 404, not found\nRequires at least: 2.7.0\nTested up to: 3.0\nStable tag: trunk\n\nIt is not issued any 404 error message, but looking for similar sites and forwarded to any results or output a list of possible matches\n\n== Description ==\nEs wird keine 404 Fehlermeldung ausgegeben, sondern nach \u00e4hnlichen Seiten gesucht und auf eventuelle Treffer weitergeleitet oder eine Liste m\u00f6glicher Treffer ausgegeben.\nIt is not issued any 404 error message, but looking for similar sites and forwarded to any results or output a list of possible matches\n\n== Installation ==\n\n1. Upload `404Like.php` to the `/wp-content/plugins/` directory\n2. Activate the plugin through the 'Plugins' menu in WordPress\n3. Place `<?php checkPage(); ? >` in first line of your 404 template page.\n4. Optional add < ? php new404ErrorPage(); ? >  to your 404 template page."], "fixing_code": ["<?php\r\n/*\r\n Plugin Name: 404Like\r\n Plugin URI: http://www.gnetos.de/projekte/404Like\r\n Description: Es wird keine 404 Fehlermeldung ausgegeben, sondern nach \u9123nlichen Seiten gesucht und auf eventuelle Treffer weitergeleitet oder eine Liste m\u9437licher Treffer ausgegeben / It is not issued any 404 error message, but looking for similar sites and forwarded to any results or output a list of possible matches\r\n Version: 1.0.2\r\n Author: Tobias Gafner\r\n Author URI: http://www.gnetos.de\r\n License: GPL2\r\n */\r\n\r\n/*  Copyright 2010  Tobias Gafner  (email : tobi@gnetos.de) \r\n\r\nThis program is free software; you can redistribute it and/or modify\r\nit under the terms of the GNU General Public License, version 2, as\r\npublished by the Free Software Foundation.\r\n\r\nThis program is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\n\r\nYou should have received a copy of the GNU General Public License\r\nalong with this program; if not, write to the Free Software\r\nFoundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\r\n*/\r\n/**\r\n * Search function\r\n */ \r\nfunction findPostWhereLikeNameTitle($title = \"\") {\r\n\t$title = strtolower($title);\r\n\t$where .= \" (post_type = 'post' OR post_type = 'page') AND\r\n    post_status = 'publish' AND (LOWER(post_name) like '%\".$title.\"%' OR post_title like '%\".$title.\"%')\";\r\n\treturn $where;\r\n}\r\n/**\r\n * Search function\r\n */ \r\nfunction findPostWhereLike($title = \"\") {\r\n\t$title = strtolower($title);\r\n\t$where = \" (post_type = 'post' OR post_type = 'page') AND\r\n    post_status = 'publish' AND (LOWER(post_title) like '%\".$title.\"%')\";\r\n\treturn $where;\r\n}\r\n/**\r\n *  this function must call in your 404 Page\r\n *  \r\n *  <?php checkPage(); ? >\r\n    <?php\r\n    get_header();\r\n    ? >\r\n    .....\r\n *\r\n */  \r\nfunction checkPage() {\r\n\tglobal $wpdb;\r\n\t\r\n\tif ( !is_404() )\r\n\treturn;\r\n\r\n  $urltext =  $_SERVER['REQUEST_URI'];\r\n\t//$urltexta = substr($urltext,1);\r\n\t$urltext = trim($urltext);\r\n  //Letztes / loeschen\r\n  //schuetzen\r\n  $urltext = htmlspecialchars($urltext); \r\n  if(strlen($urltext) != 0)   {\r\n    //Letztes Zeichen ist ?\r\n    if(substr ($urltext , -1,1) == \"/\") {\r\n      $urltext = substr ($urltext , 0,-1);\r\n    }\r\n    //Letztes von xxx/xxxx/xxx ist interessant\r\n    $searchWord = \tsubstr (strrchr ($urltext, \"/\"), 1);\r\n    //SQL \r\n    $searchWord = stripslashes($searchWord);\r\n    $searchWord = str_replace (\"'\", \"\", $searchWord);\r\n    $searchWord = str_replace ('\"', \"\", $searchWord);\r\n    $searchWord = str_replace (';', \"\", $searchWord);\r\n    $querystr = \"SELECT * FROM $wpdb->posts WHERE \".findPostWhereLike($searchWord);\r\n    $pageposts = $wpdb->get_col($querystr);\r\n    if ($pageposts) {\r\n      ob_start();\r\n      \r\n  \t\tif (count($pageposts) == 1 || ($searchWord == \"404Like\" || $searchWord == \"404like\")) { \r\n      \tforeach ($pageposts as $id) {\r\n          $url = get_permalink($id); \r\n          echo $inhalt;\r\n          wp_redirect($url,301);\r\n          // Okay, stop.\r\n          break;\r\n        }         \r\n        \r\n        wp_reset_query();               \r\n        ob_end_flush();     \r\n  \t\t}\r\n  \t}\r\n  }\r\n}\r\n\r\n/**\r\n * Result List by many results\r\n * \r\n * example:\r\n * ...</p>\r\n        < ? php new404ErrorPage(); ? >      \r\n\t....  \r\n */ \r\nfunction new404ErrorPage() {\r\n\tglobal $wpdb;\r\n\r\n  $urltext =  $_SERVER['REQUEST_URI'];\r\n  $urltext = trim($urltext);\r\n  //Letztes / loeschen\r\n  $urltext = htmlspecialchars($urltext); \r\n  if(strlen($urltext) != 0)   {\r\n    //Letztes Zeichen ist ?\r\n    if(substr ($urltext , -1,1) == \"/\") {\r\n      $urltext = substr ($urltext , 0,-1);\r\n    }                          \r\n    //Letztes von xxx/xxxx/xxx ist interessant\r\n    $searchWord = \tsubstr (strrchr ($urltext, \"/\"), 1);\r\n    //SQL\r\n    $querystr = \"SELECT *  FROM $wpdb->posts WHERE \".findPostWhereLikeNameTitle($searchWord);   \r\n    $pageposts = $wpdb->get_col($querystr);\r\n    if ($pageposts) {\r\n    //Ausgabe\r\n      echo '<div id=\"errorresults\"><h2 class=\"twost\">'.__(\"Folgendes Gesucht\").' ?</h2><ul>';\r\n    \tforeach ($pageposts as $id) {\r\n        $post_id_7 = get_post($id);\r\n        $url = get_permalink($id);  \r\n        $title = $post_id_7->post_title;\r\n        echo \"<li>\".'<a href=\"'.$url.'\">'.$title.\"</a></li>\";\r\n    \t}\r\n    \techo \"</ul></div>\";\r\n    }\r\n  \t//Reset Query\r\n  \twp_reset_query();\r\n\t}\r\n}\r\n\r\nfunction plugin404Like_filter($redirect, $request) {\r\n\r\n\tif ( is_404() ) {return false;}\r\n\treturn $redirect;\r\n}\r\n\r\nadd_action( 'template_redirect', 'checkPage' );\r\nadd_filter( 'redirect_canonical', 'plugin404Like_filter', 10, 2 );\r\n?>", "=== Plugin Name ===\nContributors: tobig\nDonate link: http://www.gnetos.de\nTags: 404, not found\nRequires at least: 2.7.0\nTested up to: 3.3.0\nStable tag: trunk\n\nIt is not issued any 404 error message, but looking for similar sites and forwarded to any results or output a list of possible matches\n\n== Description ==\nEs wird keine 404 Fehlermeldung ausgegeben, sondern nach \u00e4hnlichen Seiten gesucht und auf eventuelle Treffer weitergeleitet oder eine Liste m\u00f6glicher Treffer ausgegeben.\nIt is not issued any 404 error message, but looking for similar sites and forwarded to any results or output a list of possible matches\n\n== Installation ==\n\n1. Upload `404Like.php` to the `/wp-content/plugins/` directory\n2. Activate the plugin through the 'Plugins' menu in WordPress\n3. Nothing, it works without any other activities - you can test it\n4. Optional add < ? php new404ErrorPage(); ? >  to your 404 template page."], "filenames": ["404Like.php", "readme.txt"], "buggy_code_start_loc": [5, 6], "buggy_code_end_loc": [127, 20], "fixing_code_start_loc": [5, 6], "fixing_code_end_loc": [149, 20], "type": "CWE-89", "message": "A vulnerability was found in 404like Plugin up to 1.0.2. It has been classified as critical. Affected is the function checkPage of the file 404Like.php. The manipulation of the argument searchWord leads to sql injection. It is possible to launch the attack remotely. Upgrading to version 1.0.2 is able to address this issue. The name of the patch is 2c4b589d27554910ab1fd104ddbec9331b540f7f. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-223404.", "other": {"cve": {"id": "CVE-2012-10009", "sourceIdentifier": "cna@vuldb.com", "published": "2023-03-21T00:15:10.163", "lastModified": "2023-03-23T19:35:41.603", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in 404like Plugin up to 1.0.2. It has been classified as critical. Affected is the function checkPage of the file 404Like.php. The manipulation of the argument searchWord leads to sql injection. It is possible to launch the attack remotely. Upgrading to version 1.0.2 is able to address this issue. The name of the patch is 2c4b589d27554910ab1fd104ddbec9331b540f7f. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-223404."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:404like_project:404like:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "1.0.2", "matchCriteriaId": "92F09A44-FDFA-4D20-BEAC-6E7ACCF2041C"}]}]}], "references": [{"url": "https://github.com/wp-plugins/404like/commit/2c4b589d27554910ab1fd104ddbec9331b540f7f", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://github.com/wp-plugins/404like/releases/tag/1.0.2", "source": "cna@vuldb.com", "tags": ["Release Notes"]}, {"url": "https://vuldb.com/?ctiid.223404", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.223404", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/wp-plugins/404like/commit/2c4b589d27554910ab1fd104ddbec9331b540f7f"}}