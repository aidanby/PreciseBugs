{"buggy_code": ["<?php\n\nuse League\\CommonMark\\Extension\\ExternalLink\\ExternalLinkExtension;\nuse League\\CommonMark\\Extension\\HeadingPermalink\\HeadingPermalinkExtension;\n\n/*\n * This file is part of Laravel Markdown.\n *\n * (c) Graham Campbell <graham@alt-three.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nreturn [\n\n    /*\n    |--------------------------------------------------------------------------\n    | Enable View Integration\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies if the view integration is enabled so you can write\n    | markdown views and have them rendered as html. The following extensions\n    | are currently supported: \".md\", \".md.php\", and \".md.blade.php\". You may\n    | disable this integration if it is conflicting with another package.\n    |\n    | Default: true\n    |\n    */\n\n    'views' => false,\n\n    /*\n    |--------------------------------------------------------------------------\n    | CommonMark Extensions\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies what extensions will be automatically enabled.\n    | Simply provide your extension class names here.\n    |\n    | Default: []\n    |\n    */\n\n    'extensions' => [\n        ExternalLinkExtension::class,\n        HeadingPermalinkExtension::class,\n    ],\n\n    /*\n    |--------------------------------------------------------------------------\n    | Renderer Configuration\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies an array of options for rendering HTML.\n    |\n    | Default: [\n    |              'block_separator' => \"\\n\",\n    |              'inner_separator' => \"\\n\",\n    |              'soft_break'      => \"\\n\",\n    |          ]\n    |\n    */\n\n    'renderer' => [\n        'block_separator' => \"\\n\",\n        'inner_separator' => \"\\n\",\n        'soft_break'      => \"\\n\",\n    ],\n\n    /*\n    |--------------------------------------------------------------------------\n    | Enable Em Tag Parsing\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies if `<em>` parsing is enabled.\n    |\n    | Default: true\n    |\n    */\n\n    'enable_em' => true,\n\n    /*\n    |--------------------------------------------------------------------------\n    | Enable Strong Tag Parsing\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies if `<strong>` parsing is enabled.\n    |\n    | Default: true\n    |\n    */\n\n    'enable_strong' => true,\n\n    /*\n    |--------------------------------------------------------------------------\n    | Enable Asterisk Parsing\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies if `*` should be parsed for emphasis.\n    |\n    | Default: true\n    |\n    */\n\n    'use_asterisk' => true,\n\n    /*\n    |--------------------------------------------------------------------------\n    | Enable Underscore Parsing\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies if `_` should be parsed for emphasis.\n    |\n    | Default: true\n    |\n    */\n\n    'use_underscore' => true,\n\n    /*\n    |--------------------------------------------------------------------------\n    | HTML Input\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies how to handle untrusted HTML input.\n    |\n    | Default: 'strip'\n    |\n    */\n\n    'html_input' => 'strip',\n\n    /*\n    |--------------------------------------------------------------------------\n    | Allow Unsafe Links\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies whether to allow risky image URLs and links.\n    |\n    | Default: true\n    |\n    */\n\n    'allow_unsafe_links' => true,\n\n    /*\n     * Configuration related to ExternalLinkExtension\n     */\n    'external_link' => [\n        'internal_hosts' => '', // is empty as we would like to have all links marked as external\n        'open_in_new_window' => true,\n    ],\n\n    'heading_permalink' => [\n        'html_class' => 'markdown-header-link',\n        'id_prefix' => 'uc-',\n        'insert' => 'after',\n    ],\n];\n"], "fixing_code": ["<?php\n\nuse League\\CommonMark\\Extension\\ExternalLink\\ExternalLinkExtension;\nuse League\\CommonMark\\Extension\\HeadingPermalink\\HeadingPermalinkExtension;\n\n/*\n * This file is part of Laravel Markdown.\n *\n * (c) Graham Campbell <graham@alt-three.com>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nreturn [\n\n    /*\n    |--------------------------------------------------------------------------\n    | Enable View Integration\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies if the view integration is enabled so you can write\n    | markdown views and have them rendered as html. The following extensions\n    | are currently supported: \".md\", \".md.php\", and \".md.blade.php\". You may\n    | disable this integration if it is conflicting with another package.\n    |\n    | Default: true\n    |\n    */\n\n    'views' => false,\n\n    /*\n    |--------------------------------------------------------------------------\n    | CommonMark Extensions\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies what extensions will be automatically enabled.\n    | Simply provide your extension class names here.\n    |\n    | Default: []\n    |\n    */\n\n    'extensions' => [\n        ExternalLinkExtension::class,\n        HeadingPermalinkExtension::class,\n    ],\n\n    /*\n    |--------------------------------------------------------------------------\n    | Renderer Configuration\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies an array of options for rendering HTML.\n    |\n    | Default: [\n    |              'block_separator' => \"\\n\",\n    |              'inner_separator' => \"\\n\",\n    |              'soft_break'      => \"\\n\",\n    |          ]\n    |\n    */\n\n    'renderer' => [\n        'block_separator' => \"\\n\",\n        'inner_separator' => \"\\n\",\n        'soft_break'      => \"\\n\",\n    ],\n\n    /*\n    |--------------------------------------------------------------------------\n    | Enable Em Tag Parsing\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies if `<em>` parsing is enabled.\n    |\n    | Default: true\n    |\n    */\n\n    'enable_em' => true,\n\n    /*\n    |--------------------------------------------------------------------------\n    | Enable Strong Tag Parsing\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies if `<strong>` parsing is enabled.\n    |\n    | Default: true\n    |\n    */\n\n    'enable_strong' => true,\n\n    /*\n    |--------------------------------------------------------------------------\n    | Enable Asterisk Parsing\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies if `*` should be parsed for emphasis.\n    |\n    | Default: true\n    |\n    */\n\n    'use_asterisk' => true,\n\n    /*\n    |--------------------------------------------------------------------------\n    | Enable Underscore Parsing\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies if `_` should be parsed for emphasis.\n    |\n    | Default: true\n    |\n    */\n\n    'use_underscore' => true,\n\n    /*\n    |--------------------------------------------------------------------------\n    | HTML Input\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies how to handle untrusted HTML input.\n    |\n    | Default: 'strip'\n    |\n    */\n\n    'html_input' => 'strip',\n\n    /*\n    |--------------------------------------------------------------------------\n    | Allow Unsafe Links\n    |--------------------------------------------------------------------------\n    |\n    | This option specifies whether to allow risky image URLs and links.\n    |\n    | Default: true\n    |\n    */\n\n    'allow_unsafe_links' => false,\n\n    /*\n     * Configuration related to ExternalLinkExtension\n     */\n    'external_link' => [\n        'internal_hosts' => '', // is empty as we would like to have all links marked as external\n        'open_in_new_window' => true,\n    ],\n\n    'heading_permalink' => [\n        'html_class' => 'markdown-header-link',\n        'id_prefix' => 'uc-',\n        'insert' => 'after',\n    ],\n];\n"], "filenames": ["config/markdown.php"], "buggy_code_start_loc": [147], "buggy_code_end_loc": [148], "fixing_code_start_loc": [147], "fixing_code_end_loc": [148], "type": "CWE-79", "message": "K-Box is a web-based application to manage documents, images, videos and geodata. Prior to version 0.33.1, a stored Cross-Site-Scripting (XSS) vulnerability is present in the markdown editor used by the document abstract and markdown file preview. A specifically crafted anchor link can, if clicked, execute untrusted javascript actions, like retrieving user cookies. Version 0.33.1 includes a patch that allows discarding unsafe links.", "other": {"cve": {"id": "CVE-2022-23637", "sourceIdentifier": "security-advisories@github.com", "published": "2022-02-14T21:15:09.777", "lastModified": "2022-02-22T20:53:18.630", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "K-Box is a web-based application to manage documents, images, videos and geodata. Prior to version 0.33.1, a stored Cross-Site-Scripting (XSS) vulnerability is present in the markdown editor used by the document abstract and markdown file preview. A specifically crafted anchor link can, if clicked, execute untrusted javascript actions, like retrieving user cookies. Version 0.33.1 includes a patch that allows discarding unsafe links."}, {"lang": "es", "value": "K-Box es una aplicaci\u00f3n basada en la web para administrar documentos, im\u00e1genes, v\u00eddeos y geodatos. En versiones anteriores a 0.33.1, se presenta una vulnerabilidad de tipo Cross-Site-Scripting (XSS) almacenada en el editor markdown usado por el resumen de documentos y la vista previa de archivos markdown. Un enlace ancla espec\u00edficamente dise\u00f1ado puede, si hace clic, ejecutar acciones javascript no confiables, como la recuperaci\u00f3n de las cookies del usuario. La versi\u00f3n 0.33.1 incluye un parche que permite descartar los enlaces no seguros"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:k-link:k-box:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.33.1", "matchCriteriaId": "B79DDF27-7A54-4EBC-817D-1C213C827B4A"}]}]}], "references": [{"url": "https://github.com/k-box/k-box/commit/3bb4df9a4d01aade5bffaa603a514d1a5fabd214", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/k-box/k-box/security/advisories/GHSA-wwcw-h4mf-mvxf", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/k-box/k-box/commit/3bb4df9a4d01aade5bffaa603a514d1a5fabd214"}}