{"buggy_code": ["<?php\n/*\n * suricata_logs_browser.php\n *\n * Portions of this code are based on original work done for the\n * Snort package for pfSense from the following contributors:\n * \n * Copyright (C) 2005 Bill Marquette <bill.marquette@gmail.com>.\n * Copyright (C) 2003-2004 Manuel Kasper <mk@neon1.net>.\n * Copyright (C) 2006 Scott Ullrich\n * Copyright (C) 2009 Robert Zelaya Sr. Developer\n * Copyright (C) 2012 Ermal Luci\n * All rights reserved.\n *\n * Adapted for Suricata by:\n * Copyright (C) 2014 Bill Meeks\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n\n * 1. Redistributions of source code must retain the above copyright notice,\n * this list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright\n * notice, this list of conditions and the following disclaimer in the\n * documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,\n * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE\n * AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,\n * OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n*/\n\nrequire_once(\"guiconfig.inc\");\nrequire_once(\"/usr/local/pkg/suricata/suricata.inc\");\n\nif (isset($_POST['instance']) && is_numericint($_POST['instance']))\n\t$instanceid = $_POST['instance'];\nelseif (isset($_GET['instance']) && is_numericint($_GET['instance']))\n\t$instanceid = htmlspecialchars($_GET['instance']);\nif (empty($instanceid))\n\t$instanceid = 0;\n\nif (!is_array($config['installedpackages']['suricata']['rule']))\n\t$config['installedpackages']['suricata']['rule'] = array();\n$a_instance = $config['installedpackages']['suricata']['rule'];\n$suricata_uuid = $a_instance[$instanceid]['uuid'];\n$if_real = get_real_interface($a_instance[$instanceid]['interface']);\n\n// Construct a pointer to the instance's logging subdirectory\n$suricatalogdir = SURICATALOGDIR . \"suricata_{$if_real}{$suricata_uuid}\";\n\n$logfile = $_POST['file'];\n\nif ($_POST['action'] == 'load') {\n\tif(!is_file($_POST['file'])) {\n\t\techo \"|3|\" . gettext(\"Log file does not exist or that logging feature is not enabled\") . \".|\";\n\t}\n\telse {\n\t\t$data = file_get_contents($_POST['file']);\n\t\tif($data === false) {\n\t\t\techo \"|1|\" . gettext(\"Failed to read log file\") . \".|\";\n\t\t} else {\n\t\t\t$data = base64_encode($data);\n\t\t\techo \"|0|{$_POST['file']}|{$data}|\";\t\n\t\t}\n\t}\n\texit;\n}\n\n$pgtitle = gettext(\"Suricata: Logs Browser\");\ninclude_once(\"head.inc\");\n\n?>\n\n<body link=\"#000000\" vlink=\"#000000\" alink=\"#000000\">\n\n<?php\ninclude_once(\"fbegin.inc\");\nif($pfsense_stable == 'yes'){echo '<p class=\"pgtitle\">' . $pgtitle . '</p>';}\nif ($input_errors) {\n\tprint_input_errors($input_errors);\n}\n\n?>\n<script type=\"text/javascript\" src=\"/javascript/base64.js\"></script>\n<script type=\"text/javascript\">\t\n\tfunction loadFile() {\n\t\tjQuery(\"#fileStatus\").html(\"<?=gettext(\"Loading file\"); ?> ...\");\n\t\tjQuery(\"#fileStatusBox\").show(500);\n\t\tjQuery(\"#filePathBox\").show(500);\n\t\tjQuery(\"#fbTarget\").html(\"\");\n\n\t\tjQuery.ajax(\n\t\t\t\"<?=$_SERVER['SCRIPT_NAME'];?>\", {\n\t\t\t\ttype: 'POST',\n\t\t\t\tdata: \"action=load&file=\" + jQuery(\"#logFile\").val(),\n\t\t\t\tcomplete: loadComplete\n\t\t\t}\n\t\t);\n\t}\n\n\tfunction loadComplete(req) {\n\t\tjQuery(\"#fileContent\").show(1000);\n\t\tvar values = req.responseText.split(\"|\");\n\t\tvalues.shift(); values.pop();\n\n\t\tif(values.shift() == \"0\") {\n\t\t\tvar file = values.shift();\n\t\t\tvar fileContent = Base64.decode(values.join(\"|\"));\n\t\t\tjQuery(\"#fileStatus\").html(\"<?=gettext(\"File successfully loaded\"); ?>.\");\n\t\t\tjQuery(\"#fbTarget\").html(file);\n\t\t\tjQuery(\"#fileContent\").val(fileContent);\n\t\t}\n\t\telse {\n\t\t\tjQuery(\"#fileStatus\").html(values[0]);\n\t\t\tjQuery(\"#fbTarget\").html(\"\");\n\t\t\tjQuery(\"#fileContent\").val(\"\");\n\t\t}\n\t\tjQuery(\"#fileContent\").show(1000);\n\t}\n\n</script>\n\n<form action=\"/suricata/suricata_logs_browser.php\" method=\"post\" id=\"formbrowse\">\n<input type=\"hidden\" id=\"instance\" value=\"<?=$instanceid;?>\"/>\n<?php if ($savemsg) print_info_box($savemsg); ?>\n<table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n\t<tr><td>\n\t<?php\n        \t$tab_array = array();\n\t\t$tab_array[] = array(gettext(\"Suricata Interfaces\"), false, \"/suricata/suricata_interfaces.php\");\n\t\t$tab_array[] = array(gettext(\"Global Settings\"), false, \"/suricata/suricata_global.php\");\n\t\t$tab_array[] = array(gettext(\"Update Rules\"), false, \"/suricata/suricata_download_updates.php\");\n\t\t$tab_array[] = array(gettext(\"Alerts\"), false, \"/suricata/suricata_alerts.php?instance={$instanceid}\");\n\t\t$tab_array[] = array(gettext(\"Blocked\"), false, \"/suricata/suricata_blocked.php\");\n\t\t$tab_array[] = array(gettext(\"Pass Lists\"), false, \"/suricata/suricata_passlist.php\");\n\t\t$tab_array[] = array(gettext(\"Suppress\"), false, \"/suricata/suricata_suppress.php\");\n\t\t$tab_array[] = array(gettext(\"Logs Browser\"), true, \"/suricata/suricata_logs_browser.php\");\n\t\t$tab_array[] = array(gettext(\"Logs Mgmt\"), false, \"/suricata/suricata_logs_mgmt.php\");\n\t\tdisplay_top_tabs($tab_array, true);\n\t?>\n\t</td>\n\t</tr>\n\t<tr>\n\t<td><div id=\"mainarea\">\n\t\t<table id=\"maintable\" class=\"tabcont\" width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"6\">\n\t\t\t<tr>\n\t\t\t\t<td colspan=\"2\" class=\"listtopic\"><?php echo gettext(\"Logs Browser Selections\"); ?></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td width=\"22%\" class=\"vncell\"><?php echo gettext('Instance to View'); ?></td>\n\t\t\t\t<td width=\"78%\" class=\"vtable\">\n\t\t\t\t\t<select name=\"instance\" id=\"instance\" class=\"formselect\" onChange=\"document.getElementById('formbrowse').method='post';document.getElementById('formbrowse').submit()\">\n\t\t\t<?php\n\t\t\t\tforeach ($a_instance as $id => $instance) {\n\t\t\t\t\t$selected = \"\";\n\t\t\t\t\tif ($id == $instanceid)\n\t\t\t\t\t\t$selected = \"selected\";\n\t\t\t\t\techo \"<option value='{$id}' {$selected}> (\" . convert_friendly_interface_to_friendly_descr($instance['interface']) . \") {$instance['descr']}</option>\\n\";\n\t\t\t\t}\n\t\t\t?>\n\t\t\t\t\t</select>&nbsp;&nbsp;<?php echo gettext('Choose which instance logs you want to view.'); ?>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td width=\"22%\" class=\"vncell\"><?php echo gettext('Log File to View'); ?></td>\n\t\t\t\t<td width=\"78%\" class=\"vtable\">\n\t\t\t\t\t<select name=\"logFile\" id=\"logFile\" class=\"formselect\" onChange=\"loadFile();\">\n\t\t\t<?php\n\t\t\t\t$logs = array( \"alerts.log\", \"block.log\", \"files-json.log\", \"http.log\", \"stats.log\", \"suricata.log\", \"tls.log\" );\n\t\t\t\tforeach ($logs as $log) {\n\t\t\t\t\t$selected = \"\";\n\t\t\t\t\tif ($log == basename($logfile))\n\t\t\t\t\t\t$selected = \"selected\";\n\t\t\t\t\techo \"<option value='{$suricatalogdir}/{$log}' {$selected}>\" . $log . \"</option>\\n\";\n\t\t\t\t}\n\t\t\t?>\n\t\t\t\t\t</select>&nbsp;&nbsp;<?php echo gettext('Choose which log you want to view.'); ?>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td colspan=\"2\" class=\"listtopic\"><?php echo gettext(\"Log Contents\"); ?></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t<div style=\"display:none; \" id=\"fileStatusBox\">\n\t\t\t\t\t\t<div class=\"list\" style=\"padding-left:15px;\">\n\t\t\t\t\t\t\t<strong id=\"fileStatus\"></strong>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div style=\"padding-left:15px; display:none;\" id=\"filePathBox\">\n\t\t\t\t\t\t<strong><?=gettext(\"Log File Path\"); ?>:</strong>\n\t\t\t\t\t\t<div class=\"list\" style=\"display:inline;\" id=\"fbTarget\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td valign=\"top\" class=\"label\">\n\t\t\t\t\t\t\t<div style=\"background:#eeeeee;\" id=\"fileOutput\">\n\t\t\t\t\t\t\t<textarea id=\"fileContent\" name=\"fileContent\" style=\"width:100%;\" rows=\"30\" wrap=\"off\"></textarea>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t</div>\n\t</td>\n\t</tr>\n</table>\n</form>\n\n<?php if(empty($logfile)): ?>\n<script type=\"text/javascript\">\n\tdocument.getElementById(\"logFile\").selectedIndex=-1;\n</script>\n<?php endif; ?>\n\n<?php include(\"fend.inc\"); ?>\n</body>\n</html>\n"], "fixing_code": ["<?php\n/*\n * suricata_logs_browser.php\n *\n * Portions of this code are based on original work done for the\n * Snort package for pfSense from the following contributors:\n * \n * Copyright (C) 2005 Bill Marquette <bill.marquette@gmail.com>.\n * Copyright (C) 2003-2004 Manuel Kasper <mk@neon1.net>.\n * Copyright (C) 2006 Scott Ullrich\n * Copyright (C) 2009 Robert Zelaya Sr. Developer\n * Copyright (C) 2012 Ermal Luci\n * All rights reserved.\n *\n * Adapted for Suricata by:\n * Copyright (C) 2014 Bill Meeks\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n\n * 1. Redistributions of source code must retain the above copyright notice,\n * this list of conditions and the following disclaimer.\n *\n * 2. Redistributions in binary form must reproduce the above copyright\n * notice, this list of conditions and the following disclaimer in the\n * documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,\n * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY\n * AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE\n * AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY,\n * OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n*/\n\nrequire_once(\"guiconfig.inc\");\nrequire_once(\"/usr/local/pkg/suricata/suricata.inc\");\n\nif (isset($_POST['instance']) && is_numericint($_POST['instance']))\n\t$instanceid = $_POST['instance'];\nelseif (isset($_GET['instance']) && is_numericint($_GET['instance']))\n\t$instanceid = htmlspecialchars($_GET['instance']);\nif (empty($instanceid))\n\t$instanceid = 0;\n\nif (!is_array($config['installedpackages']['suricata']['rule']))\n\t$config['installedpackages']['suricata']['rule'] = array();\n$a_instance = $config['installedpackages']['suricata']['rule'];\n$suricata_uuid = $a_instance[$instanceid]['uuid'];\n$if_real = get_real_interface($a_instance[$instanceid]['interface']);\n\n// Construct a pointer to the instance's logging subdirectory\n$suricatalogdir = SURICATALOGDIR . \"suricata_{$if_real}{$suricata_uuid}/\";\n\n// Limit all file access to just the currently selected interface's logging subdirectory\n$logfile = htmlspecialchars($suricatalogdir . basename($_POST['file']));\n\nif ($_POST['action'] == 'load') {\n\tif(!is_file($logfile)) {\n\t\techo \"|3|\" . gettext(\"Log file does not exist or that logging feature is not enabled\") . \".|\";\n\t}\n\telse {\n\t\t$data = file_get_contents($logfile);\n\t\tif($data === false) {\n\t\t\techo \"|1|\" . gettext(\"Failed to read log file\") . \".|\";\n\t\t} else {\n\t\t\t$data = base64_encode($data);\n\t\t\techo \"|0|{$logfile}|{$data}|\";\t\n\t\t}\n\t}\n\texit;\n}\n\n$pgtitle = gettext(\"Suricata: Logs Browser\");\ninclude_once(\"head.inc\");\n\n?>\n\n<body link=\"#000000\" vlink=\"#000000\" alink=\"#000000\">\n\n<?php\ninclude_once(\"fbegin.inc\");\nif($pfsense_stable == 'yes'){echo '<p class=\"pgtitle\">' . $pgtitle . '</p>';}\nif ($input_errors) {\n\tprint_input_errors($input_errors);\n}\n\n?>\n<script type=\"text/javascript\" src=\"/javascript/base64.js\"></script>\n<script type=\"text/javascript\">\t\n\tfunction loadFile() {\n\t\tjQuery(\"#fileStatus\").html(\"<?=gettext(\"Loading file\"); ?> ...\");\n\t\tjQuery(\"#fileStatusBox\").show(500);\n\t\tjQuery(\"#filePathBox\").show(500);\n\t\tjQuery(\"#fbTarget\").html(\"\");\n\n\t\tjQuery.ajax(\n\t\t\t\"<?=$_SERVER['SCRIPT_NAME'];?>\", {\n\t\t\t\ttype: 'POST',\n\t\t\t\tdata: \"action=load&file=\" + jQuery(\"#logFile\").val(),\n\t\t\t\tcomplete: loadComplete\n\t\t\t}\n\t\t);\n\t}\n\n\tfunction loadComplete(req) {\n\t\tjQuery(\"#fileContent\").show(1000);\n\t\tvar values = req.responseText.split(\"|\");\n\t\tvalues.shift(); values.pop();\n\n\t\tif(values.shift() == \"0\") {\n\t\t\tvar file = values.shift();\n\t\t\tvar fileContent = Base64.decode(values.join(\"|\"));\n\t\t\tjQuery(\"#fileStatus\").html(\"<?=gettext(\"File successfully loaded\"); ?>.\");\n\t\t\tjQuery(\"#fbTarget\").html(file);\n\t\t\tjQuery(\"#fileContent\").val(fileContent);\n\t\t}\n\t\telse {\n\t\t\tjQuery(\"#fileStatus\").html(values[0]);\n\t\t\tjQuery(\"#fbTarget\").html(\"\");\n\t\t\tjQuery(\"#fileContent\").val(\"\");\n\t\t}\n\t\tjQuery(\"#fileContent\").show(1000);\n\t}\n\n</script>\n\n<form action=\"/suricata/suricata_logs_browser.php\" method=\"post\" id=\"formbrowse\">\n<input type=\"hidden\" id=\"instance\" value=\"<?=$instanceid;?>\"/>\n<?php if ($savemsg) print_info_box($savemsg); ?>\n<table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\">\n\t<tr><td>\n\t<?php\n        \t$tab_array = array();\n\t\t$tab_array[] = array(gettext(\"Suricata Interfaces\"), false, \"/suricata/suricata_interfaces.php\");\n\t\t$tab_array[] = array(gettext(\"Global Settings\"), false, \"/suricata/suricata_global.php\");\n\t\t$tab_array[] = array(gettext(\"Update Rules\"), false, \"/suricata/suricata_download_updates.php\");\n\t\t$tab_array[] = array(gettext(\"Alerts\"), false, \"/suricata/suricata_alerts.php?instance={$instanceid}\");\n\t\t$tab_array[] = array(gettext(\"Blocked\"), false, \"/suricata/suricata_blocked.php\");\n\t\t$tab_array[] = array(gettext(\"Pass Lists\"), false, \"/suricata/suricata_passlist.php\");\n\t\t$tab_array[] = array(gettext(\"Suppress\"), false, \"/suricata/suricata_suppress.php\");\n\t\t$tab_array[] = array(gettext(\"Logs Browser\"), true, \"/suricata/suricata_logs_browser.php\");\n\t\t$tab_array[] = array(gettext(\"Logs Mgmt\"), false, \"/suricata/suricata_logs_mgmt.php\");\n\t\tdisplay_top_tabs($tab_array, true);\n\t?>\n\t</td>\n\t</tr>\n\t<tr>\n\t<td><div id=\"mainarea\">\n\t\t<table id=\"maintable\" class=\"tabcont\" width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"6\">\n\t\t\t<tr>\n\t\t\t\t<td colspan=\"2\" class=\"listtopic\"><?php echo gettext(\"Logs Browser Selections\"); ?></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td width=\"22%\" class=\"vncell\"><?php echo gettext('Instance to View'); ?></td>\n\t\t\t\t<td width=\"78%\" class=\"vtable\">\n\t\t\t\t\t<select name=\"instance\" id=\"instance\" class=\"formselect\" onChange=\"document.getElementById('formbrowse').method='post';document.getElementById('formbrowse').submit()\">\n\t\t\t<?php\n\t\t\t\tforeach ($a_instance as $id => $instance) {\n\t\t\t\t\t$selected = \"\";\n\t\t\t\t\tif ($id == $instanceid)\n\t\t\t\t\t\t$selected = \"selected\";\n\t\t\t\t\techo \"<option value='{$id}' {$selected}> (\" . convert_friendly_interface_to_friendly_descr($instance['interface']) . \") {$instance['descr']}</option>\\n\";\n\t\t\t\t}\n\t\t\t?>\n\t\t\t\t\t</select>&nbsp;&nbsp;<?php echo gettext('Choose which instance logs you want to view.'); ?>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td width=\"22%\" class=\"vncell\"><?php echo gettext('Log File to View'); ?></td>\n\t\t\t\t<td width=\"78%\" class=\"vtable\">\n\t\t\t\t\t<select name=\"logFile\" id=\"logFile\" class=\"formselect\" onChange=\"loadFile();\">\n\t\t\t<?php\n\t\t\t\t$logs = array( \"alerts.log\", \"block.log\", \"files-json.log\", \"http.log\", \"stats.log\", \"suricata.log\", \"tls.log\" );\n\t\t\t\tforeach ($logs as $log) {\n\t\t\t\t\t$selected = \"\";\n\t\t\t\t\tif ($log == basename($logfile))\n\t\t\t\t\t\t$selected = \"selected\";\n\t\t\t\t\techo \"<option value='{$suricatalogdir}{$log}' {$selected}>\" . $log . \"</option>\\n\";\n\t\t\t\t}\n\t\t\t?>\n\t\t\t\t\t</select>&nbsp;&nbsp;<?php echo gettext('Choose which log you want to view.'); ?>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td colspan=\"2\" class=\"listtopic\"><?php echo gettext(\"Log Contents\"); ?></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t<div style=\"display:none; \" id=\"fileStatusBox\">\n\t\t\t\t\t\t<div class=\"list\" style=\"padding-left:15px;\">\n\t\t\t\t\t\t\t<strong id=\"fileStatus\"></strong>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div style=\"padding-left:15px; display:none;\" id=\"filePathBox\">\n\t\t\t\t\t\t<strong><?=gettext(\"Log File Path\"); ?>:</strong>\n\t\t\t\t\t\t<div class=\"list\" style=\"display:inline;\" id=\"fbTarget\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td colspan=\"2\">\n\t\t\t\t\t<table width=\"100%\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td valign=\"top\" class=\"label\">\n\t\t\t\t\t\t\t<div style=\"background:#eeeeee;\" id=\"fileOutput\">\n\t\t\t\t\t\t\t<textarea id=\"fileContent\" name=\"fileContent\" style=\"width:100%;\" rows=\"30\" wrap=\"off\"></textarea>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t</div>\n\t</td>\n\t</tr>\n</table>\n</form>\n\n<?php if(empty($_POST['file'])): ?>\n<script type=\"text/javascript\">\n\tdocument.getElementById(\"logFile\").selectedIndex=-1;\n</script>\n<?php endif; ?>\n\n<?php include(\"fend.inc\"); ?>\n</body>\n</html>\n"], "filenames": ["config/suricata/suricata_logs_browser.php"], "buggy_code_start_loc": [58], "buggy_code_end_loc": [226], "fixing_code_start_loc": [58], "fixing_code_end_loc": [227], "type": "CWE-22", "message": "Directory Traversal vulnerability found in Pfsense v.2.1.3 and Pfsense Suricata v.1.4.6 pkg v.1.0.1 allows a remote attacker to obtain sensitive information via the file parameter to suricata/suricata_logs_browser.php.", "other": {"cve": {"id": "CVE-2020-19678", "sourceIdentifier": "cve@mitre.org", "published": "2023-04-06T18:15:08.210", "lastModified": "2023-04-18T02:31:05.080", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Directory Traversal vulnerability found in Pfsense v.2.1.3 and Pfsense Suricata v.1.4.6 pkg v.1.0.1 allows a remote attacker to obtain sensitive information via the file parameter to suricata/suricata_logs_browser.php."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:oisf:suricata:1.4.6:*:*:*:*:*:*:*", "matchCriteriaId": "1A0C77AB-2ED7-4BE6-8E83-20CDEE6592D6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pfsense:pfsense:2.1.3:*:*:*:*:*:*:*", "matchCriteriaId": "E427DF08-7EE5-406A-BB5D-3635797C5B92"}, {"vulnerable": true, "criteria": "cpe:2.3:a:pfsense:suricata_package:1.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "78558C4B-83C7-4C3D-B9A9-83531691EF41"}]}]}], "references": [{"url": "http://www.2ngon.com/2015/01/lfi-vulnerability-suricata-146-pkg-v101.html", "source": "cve@mitre.org", "tags": ["Broken Link"]}, {"url": "https://github.com/pfsense/pfsense-packages/commit/59ed3438729fd56452f58a0f79f0c288db982ac3", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://pastebin.com/8dj59053", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/pfsense/pfsense-packages/commit/59ed3438729fd56452f58a0f79f0c288db982ac3"}}