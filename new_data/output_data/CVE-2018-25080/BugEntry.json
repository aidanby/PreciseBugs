{"buggy_code": ["<?php\n/**\n * MIT License\n * ===========\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n * \"Software\"), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to\n * permit persons to whom the Software is furnished to do so, subject to\n * the following conditions:\n *\n * The above copyright notice and this permission notice shall be included\n * in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\n * CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\n * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n *\n * -----------------------------------------------------------------------\n *\n *\n * Run this in your browser to see the example!\n *\n *\n *\n * IMPORTANT: Clear your sessions/cookies before running UA tests.\n *\n * This is a procedural approach example of how to switch your website layout\n * based on a variable $layoutType.\n *\n * The example also includes the switch links that you can put in the footer\n * of your page. Is a good practice to let the user switch between layouts,\n * even if he is visiting the page from a phone or tablet.\n * ------------------------------------------------------------------------\n *\n * @author      Serban Ghita <serbanghita@gmail.com>\n * @license     MIT License https://github.com/serbanghita/Mobile-Detect/blob/master/LICENSE.txt\n *\n */\n\n// This is mandatory if you're using sessions.\nsession_start();\n\n// It's mandatory to include the library.\nrequire_once '../Mobile_Detect.php';\n\n/**\n *  Begin helper functions.\n */\n\n// Your default site layouts.\n// Update this array if you have fewer layout types.\nfunction layoutTypes()\n{\n    return array('classic', 'mobile', 'tablet');\n\n}\n\nfunction initLayoutType()\n{\n    // Safety check.\n    if (!class_exists('Mobile_Detect')) { return 'classic'; }\n\n    $detect = new Mobile_Detect;\n    $isMobile = $detect->isMobile();\n    $isTablet = $detect->isTablet();\n\n    $layoutTypes = layoutTypes();\n\n    // Set the layout type.\n    if ( isset($_GET['layoutType']) ) {\n\n        $layoutType = $_GET['layoutType'];\n\n    } else {\n\n        if (empty($_SESSION['layoutType'])) {\n\n            $layoutType = ($isMobile ? ($isTablet ? 'tablet' : 'mobile') : 'classic');\n\n        } else {\n\n            $layoutType =  $_SESSION['layoutType'];\n\n        }\n\n    }\n\n    // Fallback. If everything fails choose classic layout.\n    if ( !in_array($layoutType, $layoutTypes) ) { $layoutType = 'classic'; }\n\n    // Store the layout type for future use.\n    $_SESSION['layoutType'] = $layoutType;\n\n    return $layoutType;\n\n}\n\n/**\n *  End helper functions.\n */\n\n// Let's roll. Call this function!\n$layoutType = initLayoutType();\n\n/**\n *\n * Example of layout switch links.\n * Eg. ['Classic' | Mobile | 'Tablet']\n *\n */\n?>\n\n<?php if(!isset($_GET['page'])): ?>\n\n    <!-- example page #1 -->\n    <h1>Demo page number one.</h1>\n    <p>You can go to page <a href=\"<?php echo $_SERVER['PHP_SELF']; ?>?page=two\">two</a>.</p>\n    <p>Showing you the <b><?php echo $layoutType; ?></b> version.</p>\n    <p><b>Note:</b> When running this test using the same browser with multiple User-Agents, clear your cookies/session before each test.</p>\n\n<?php endif; ?>\n\n<?php if(isset($_GET['page']) && $_GET['page']=='two'): ?>\n\n    <!-- example page #2 -->\n    <h1>Demo page number two.</h1>\n    <p>You can go back to page <a href=\"<?php echo $_SERVER['PHP_SELF']; ?>\">one</a>.</p>\n    <p>Showing you the <b><?php echo $layoutType; ?></b> version.</p>\n\n<?php endif; ?>\n\n<!-- Footer links example. Change this as you like. -->\n<?php foreach(layoutTypes() as $_layoutType): ?>\n    <?php if($_layoutType == $layoutType): ?>\n        <?php echo strtoupper($_layoutType); ?>\n    <?php else: ?>\n        <a href=\"<?php echo $_SERVER['PHP_SELF']; ?>?layoutType=<?php echo $_layoutType; ?>\"><?php echo strtoupper($_layoutType); ?></a>\n    <?php endif; ?>\n<?php endforeach;\n"], "fixing_code": ["<?php\n/**\n * MIT License\n * ===========\n *\n * Permission is hereby granted, free of charge, to any person obtaining\n * a copy of this software and associated documentation files (the\n * \"Software\"), to deal in the Software without restriction, including\n * without limitation the rights to use, copy, modify, merge, publish,\n * distribute, sublicense, and/or sell copies of the Software, and to\n * permit persons to whom the Software is furnished to do so, subject to\n * the following conditions:\n *\n * The above copyright notice and this permission notice shall be included\n * in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n * OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\n * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY\n * CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,\n * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE\n * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n *\n * -----------------------------------------------------------------------\n *\n *\n * Run this in your browser to see the example!\n *\n *\n *\n * IMPORTANT: Clear your sessions/cookies before running UA tests.\n *\n * This is a procedural approach example of how to switch your website layout\n * based on a variable $layoutType.\n *\n * The example also includes the switch links that you can put in the footer\n * of your page. Is a good practice to let the user switch between layouts,\n * even if he is visiting the page from a phone or tablet.\n * ------------------------------------------------------------------------\n *\n * @author      Serban Ghita <serbanghita@gmail.com>\n * @license     MIT License https://github.com/serbanghita/Mobile-Detect/blob/master/LICENSE.txt\n *\n */\n\n// This is mandatory if you're using sessions.\nsession_start();\n\n// It's mandatory to include the library.\nrequire_once '../Mobile_Detect.php';\n\n/**\n *  Begin helper functions.\n */\n\n// Your default site layouts.\n// Update this array if you have fewer layout types.\nfunction layoutTypes()\n{\n    return array('classic', 'mobile', 'tablet');\n\n}\n\nfunction initLayoutType()\n{\n    // Safety check.\n    if (!class_exists('Mobile_Detect')) { return 'classic'; }\n\n    $detect = new Mobile_Detect;\n    $isMobile = $detect->isMobile();\n    $isTablet = $detect->isTablet();\n\n    $layoutTypes = layoutTypes();\n\n    // Set the layout type.\n    if ( isset($_GET['layoutType']) ) {\n\n        $layoutType = $_GET['layoutType'];\n\n    } else {\n\n        if (empty($_SESSION['layoutType'])) {\n\n            $layoutType = ($isMobile ? ($isTablet ? 'tablet' : 'mobile') : 'classic');\n\n        } else {\n\n            $layoutType =  $_SESSION['layoutType'];\n\n        }\n\n    }\n\n    // Fallback. If everything fails choose classic layout.\n    if ( !in_array($layoutType, $layoutTypes) ) { $layoutType = 'classic'; }\n\n    // Store the layout type for future use.\n    $_SESSION['layoutType'] = $layoutType;\n\n    return $layoutType;\n\n}\n\n/**\n *  End helper functions.\n */\n\n// Let's roll. Call this function!\n$layoutType = initLayoutType();\n\n/**\n *\n * Example of layout switch links.\n * Eg. ['Classic' | Mobile | 'Tablet']\n *\n */\n?>\n\n<?php if(!isset($_GET['page'])): ?>\n\n    <!-- example page #1 -->\n    <h1>Demo page number one.</h1>\n    <p>You can go to page <a href=\"<?php echo htmlspecialchars($_SERVER['PHP_SELF']); ?>?page=two\">two</a>.</p>\n    <p>Showing you the <b><?php echo $layoutType; ?></b> version.</p>\n    <p><b>Note:</b> When running this test using the same browser with multiple User-Agents, clear your cookies/session before each test.</p>\n\n<?php endif; ?>\n\n<?php if(isset($_GET['page']) && $_GET['page']=='two'): ?>\n\n    <!-- example page #2 -->\n    <h1>Demo page number two.</h1>\n    <p>You can go back to page <a href=\"<?php echo htmlspecialchars($_SERVER['PHP_SELF']); ?>\">one</a>.</p>\n    <p>Showing you the <b><?php echo $layoutType; ?></b> version.</p>\n\n<?php endif; ?>\n\n<!-- Footer links example. Change this as you like. -->\n<?php foreach(layoutTypes() as $_layoutType): ?>\n    <?php if($_layoutType == $layoutType): ?>\n        <?php echo strtoupper($_layoutType); ?>\n    <?php else: ?>\n        <a href=\"<?php echo htmlspecialchars($_SERVER['PHP_SELF']); ?>?layoutType=<?php echo $_layoutType; ?>\"><?php echo strtoupper($_layoutType); ?></a>\n    <?php endif; ?>\n<?php endforeach;\n"], "filenames": ["examples/session_example.php"], "buggy_code_start_loc": [124], "buggy_code_end_loc": [145], "fixing_code_start_loc": [124], "fixing_code_end_loc": [145], "type": "CWE-79", "message": "A vulnerability, which was classified as problematic, has been found in MobileDetect 2.8.31. This issue affects the function initLayoutType of the file examples/session_example.php of the component Example. The manipulation of the argument $_SERVER['PHP_SELF'] leads to cross site scripting. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 2.8.32 is able to address this issue. The name of the patch is 31818a441b095bdc4838602dbb17b8377d1e5cce. It is recommended to upgrade the affected component. The identifier VDB-220061 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2018-25080", "sourceIdentifier": "cna@vuldb.com", "published": "2023-02-04T08:15:07.607", "lastModified": "2023-02-14T01:50:21.883", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability, which was classified as problematic, has been found in MobileDetect 2.8.31. This issue affects the function initLayoutType of the file examples/session_example.php of the component Example. The manipulation of the argument $_SERVER['PHP_SELF'] leads to cross site scripting. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 2.8.32 is able to address this issue. The name of the patch is 31818a441b095bdc4838602dbb17b8377d1e5cce. It is recommended to upgrade the affected component. The identifier VDB-220061 was assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mobile_detect_project:mobile_detect:2.8.31:*:*:*:*:*:*:*", "matchCriteriaId": "757772A2-65FF-46FA-AB76-176AF0EC1636"}]}]}], "references": [{"url": "https://github.com/serbanghita/Mobile-Detect/commit/31818a441b095bdc4838602dbb17b8377d1e5cce", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://github.com/serbanghita/Mobile-Detect/pull/741", "source": "cna@vuldb.com", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://github.com/serbanghita/Mobile-Detect/releases/tag/2.8.32", "source": "cna@vuldb.com", "tags": ["Release Notes"]}, {"url": "https://vuldb.com/?ctiid.220061", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.220061", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/serbanghita/Mobile-Detect/commit/31818a441b095bdc4838602dbb17b8377d1e5cce"}}