{"buggy_code": ["# Allowed uploadable file extensions and mimetypes are defined here.\n# To extend this file it is recommended to create a mime.local.conf\n# file. Mimetypes that should be downloadable and not be opened in the\n# should be prefixed with a !\n\njpg     image/jpeg\njpeg    image/jpeg\ngif     image/gif\npng     image/png\nico     image/vnd.microsoft.icon\n\nswf     application/x-shockwave-flash\nmp3     audio/mpeg\nogg     audio/ogg\nwav     audio/wav\nwebm    video/webm\nogv     video/ogg\nmp4     video/mp4\n\ntgz     !application/octet-stream\ntar     !application/x-gtar\ngz      !application/octet-stream\nbz2     !application/octet-stream\nzip     !application/zip\nrar     !application/rar\n7z      !application/x-7z-compressed\n\npdf     application/pdf\nps      !application/postscript\n\nrpm     !application/octet-stream\ndeb     !application/octet-stream\n\ndoc     !application/msword\nxls     !application/msexcel\nppt     !application/mspowerpoint\nrtf     !application/msword\n\ndocx    !application/vnd.openxmlformats-officedocument.wordprocessingml.document\nxlsx    !application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\npptx    !application/vnd.openxmlformats-officedocument.presentationml.presentation\n\nsxw     !application/soffice\nsxc     !application/soffice\nsxi     !application/soffice\nsxd     !application/soffice\n\nodc     !application/vnd.oasis.opendocument.chart\nodf     !application/vnd.oasis.opendocument.formula\nodg     !application/vnd.oasis.opendocument.graphics\nodi     !application/vnd.oasis.opendocument.image\nodp     !application/vnd.oasis.opendocument.presentation\nods     !application/vnd.oasis.opendocument.spreadsheet\nodt     !application/vnd.oasis.opendocument.text\n\n# You should enable HTML and Text uploads only for restricted Wikis.\n# Spammers are known to upload spam pages through unprotected Wikis.\n# Note: Enabling HTML opens Cross Site Scripting vulnerabilities\n#       through JavaScript. Only enable this with trusted users. You\n#       need to disable the iexssprotect option additionally to\n#       adding the mime type here\n#html    text/html\n#htm     text/html\n#txt     text/plain\n#conf    text/plain\n#xml     text/xml\n#csv     text/csv\n\n"], "fixing_code": ["# Allowed uploadable file extensions and mimetypes are defined here.\n# To extend this file it is recommended to create a mime.local.conf\n# file. Mimetypes that should be downloadable and not be opened in the\n# should be prefixed with a !\n\njpg     image/jpeg\njpeg    image/jpeg\ngif     image/gif\npng     image/png\nico     image/vnd.microsoft.icon\n\nmp3     audio/mpeg\nogg     audio/ogg\nwav     audio/wav\nwebm    video/webm\nogv     video/ogg\nmp4     video/mp4\n\ntgz     !application/octet-stream\ntar     !application/x-gtar\ngz      !application/octet-stream\nbz2     !application/octet-stream\nzip     !application/zip\nrar     !application/rar\n7z      !application/x-7z-compressed\n\npdf     application/pdf\nps      !application/postscript\n\nrpm     !application/octet-stream\ndeb     !application/octet-stream\n\ndoc     !application/msword\nxls     !application/msexcel\nppt     !application/mspowerpoint\nrtf     !application/msword\n\ndocx    !application/vnd.openxmlformats-officedocument.wordprocessingml.document\nxlsx    !application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\npptx    !application/vnd.openxmlformats-officedocument.presentationml.presentation\n\nsxw     !application/soffice\nsxc     !application/soffice\nsxi     !application/soffice\nsxd     !application/soffice\n\nodc     !application/vnd.oasis.opendocument.chart\nodf     !application/vnd.oasis.opendocument.formula\nodg     !application/vnd.oasis.opendocument.graphics\nodi     !application/vnd.oasis.opendocument.image\nodp     !application/vnd.oasis.opendocument.presentation\nods     !application/vnd.oasis.opendocument.spreadsheet\nodt     !application/vnd.oasis.opendocument.text\n\n# You should enable HTML and Text uploads only for restricted Wikis.\n# Spammers are known to upload spam pages through unprotected Wikis.\n# Note: Enabling HTML opens Cross Site Scripting vulnerabilities\n#       through JavaScript. Only enable this with trusted users. You\n#       need to disable the iexssprotect option additionally to\n#       adding the mime type here\n#html    text/html\n#htm     text/html\n#txt     text/plain\n#conf    text/plain\n#xml     text/xml\n#csv     text/csv\n\n# Also flash may be able to execute arbitrary scripts in the website's\n# context\n#swf     application/x-shockwave-flash\n\n"], "filenames": ["conf/mime.conf"], "buggy_code_start_loc": [12], "buggy_code_end_loc": [68], "fixing_code_start_loc": [11], "fixing_code_end_loc": [72], "type": "CWE-79", "message": "The default file type whitelist configuration in conf/mime.conf in the Media Manager in DokuWiki before 2014-09-29b allows remote attackers to execute arbitrary web script or HTML by uploading an SWF file, then accessing it via the media parameter to lib/exe/fetch.php.", "other": {"cve": {"id": "CVE-2014-9253", "sourceIdentifier": "cve@mitre.org", "published": "2014-12-17T18:59:02.533", "lastModified": "2017-09-08T01:29:33.043", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "The default file type whitelist configuration in conf/mime.conf in the Media Manager in DokuWiki before 2014-09-29b allows remote attackers to execute arbitrary web script or HTML by uploading an SWF file, then accessing it via the media parameter to lib/exe/fetch.php."}, {"lang": "es", "value": "La configuraci\u00f3n de la lista blanca del tipo de ficheros por defecto en conf/mime.conf en Media Manager en DokuWiki anterior a 2014-09-29b permite a atacantes remotos ejecutar secuencias de comandos web o HTML arbitrarios mediante la subida de un fuchero SWF, posteriormente el acceso a ello a trav\u00e9s del par\u00e1metro media en lib/exe/fetch.php."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:dokuwiki:dokuwiki:*:*:*:*:*:*:*:*", "versionEndIncluding": "2014-05-05c", "matchCriteriaId": "C6EB83DF-FD95-4DE1-B386-3C485BE4D7C5"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:mageia:mageia:4.0:*:*:*:*:*:*:*", "matchCriteriaId": "F805A106-9A6F-48E7-8582-D3C5A26DFC11"}]}]}], "references": [{"url": "http://advisories.mageia.org/MGASA-2014-0540.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://seclists.org/oss-sec/2014/q4/1050", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://security.szurek.pl/dokuwiki-20140929a-xss.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.securityfocus.com/bid/71671", "source": "cve@mitre.org", "tags": ["Not Applicable"]}, {"url": "http://www.securitytracker.com/id/1031369", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/99291", "source": "cve@mitre.org"}, {"url": "https://github.com/splitbrain/dokuwiki/commit/778ddf6f2cd9ed38b9db2d73e823b8c21243a960", "source": "cve@mitre.org", "tags": ["Patch", "Issue Tracking"]}, {"url": "https://www.dokuwiki.org/changes", "source": "cve@mitre.org", "tags": ["Release Notes"]}]}, "github_commit_url": "https://github.com/splitbrain/dokuwiki/commit/778ddf6f2cd9ed38b9db2d73e823b8c21243a960"}}