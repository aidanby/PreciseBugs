{"buggy_code": ["### This is a generated file from Dockerfile.in ###\n\n#@follow_tag(registry.redhat.io/ubi8:latest)\nFROM registry.ci.openshift.org/ocp/builder:rhel-8-base-openshift-4.7\nENV BUILD_VERSION=6.8.1\nENV SOURCE_GIT_COMMIT=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_COMMIT:-}\nENV SOURCE_GIT_URL=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_URL:-}\n\nMAINTAINER OpenShift Development <dev@lists.openshift.redhat.com>\n\nEXPOSE 9200\nEXPOSE 9300\nUSER 0\n\nARG ES_ARCHIVE_URL\nARG PROMETHEUS_EXPORTER_URL\nARG INGEST_PLUGIN_URL\nARG OPENDISTRO_URL\nARG OPENSHIFT_CI\n\n\nENV ES_PATH_CONF=/etc/elasticsearch/ \\\n    ES_HOME=/usr/share/elasticsearch \\\n    ES_VER=6.8.1.redhat-00018 \\\n    HOME=/opt/app-root/src \\\n    INSTANCE_RAM=512G \\\n    JAVA_VER=11 \\\n    JAVA_HOME=/usr/lib/jvm/jre \\\n    _JAVA_OPTIONS=\"-Dcom.redhat.fips=false\" \\\n    NODE_QUORUM=1 \\\n    PROMETHEUS_EXPORTER_VER=6.8.1.2-redhat-00001 \\\n    INGEST_PLUGIN_VER=6.8.1.0-redhat-00003 \\\n    OPENDISTRO_VER=0.10.1.2-redhat-00006 \\\n    PLUGIN_LOGLEVEL=INFO \\\n    RECOVER_AFTER_NODES=1 \\\n    RECOVER_EXPECTED_NODES=1 \\\n    RECOVER_AFTER_TIME=5m \\\n    DHE_TMP_KEY_SIZE=2048 \\\n    RELEASE_STREAM=prod \\\n    OPENSHIFT_CI=${OPENSHIFT_CI:-false}\n\n\n# COPY $REMOTE_SOURCE $REMOTE_SOURCE_DIR\n# WORKDIR $REMOTE_SOURCE_DIR/app/elasticsearch\n\nRUN packages=\"java-${JAVA_VER}-openjdk-headless \\\n              python36 \\\n              python3-pyyaml \\\n              hostname \\\n              openssl \\\n              zip \\\n              unzip\" && \\\n    yum install -y ${packages} && \\\n    rpm -V ${packages} && \\\n    alternatives --set python /usr/bin/python3 && \\\n    yum clean all\n\nARG MAVEN_REPO_URL=${MAVEN_REPO_URL:-file:///artifacts/}\nENV upstream_code=${upstream_code:-\".\"}\n\nCOPY  ${upstream_code}/extra-jvm.options /var/tmp\nCOPY  ${upstream_code}/ci-env.sh /var/tmp\nCOPY  ${upstream_code}/install-es.sh /var/tmp\nCOPY artifacts /artifacts\nRUN /var/tmp/install-es.sh && rm -rf /var/tmp/*\n\nCOPY  ${upstream_code}/sgconfig/ ${HOME}/sgconfig/\nCOPY  ${upstream_code}/index_templates/ ${ES_HOME}/index_templates/\nCOPY  ${upstream_code}/ingest_pipelines/ ${ES_HOME}/ingest_pipelines/\nCOPY  ${upstream_code}/index_patterns/ ${ES_HOME}/index_patterns/\nCOPY  ${upstream_code}/init/ ${ES_HOME}/init/\nCOPY  ${upstream_code}/probe/ ${ES_HOME}/probe/\nCOPY  ${upstream_code}/init.sh ${HOME}/\nCOPY  ${upstream_code}/run.sh ${HOME}/\nCOPY  ${upstream_code}/ci-env.sh ${HOME}/\nCOPY  ${upstream_code}/install.sh ${HOME}/\nCOPY  ${upstream_code}/utils/** /usr/local/bin/\n\nRUN ${HOME}/install.sh && rm -rf /artifacts && \\\n  mv ${ES_HOME}/lib/elasticsearch-${ES_VER}.jar ${ES_HOME}/lib/elasticsearch-$(echo $ES_VER | cut -d'.' -f1-3).jar\n\nWORKDIR ${HOME}\nUSER 1000\nCMD [\"sh\", \"/opt/app-root/src/run.sh\"]\n\nLABEL \\\n        License=\"Apache-2.0\" \\\n        io.k8s.description=\"Elasticsearch container for EFK aggregated logging storage\" \\\n        io.k8s.display-name=\"Elasticsearch 6\" \\\n        io.openshift.tags=\"logging,elk,elasticsearch\" \\\n        vendor=\"Red Hat\" \\\n        name=\"openshift-logging/elasticsearch6-rhel8\" \\\n        com.redhat.component=\"logging-elasticsearch6-container\" \\\n        io.openshift.maintainer.product=\"OpenShift Container Platform\" \\\n        io.openshift.build.commit.id=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_COMMIT} \\\n        io.openshift.build.source-location=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_URL} \\\n        io.openshift.build.commit.url=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_URL}/commit/${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_COMMIT} \\\n        version=v6.8.1\n\n", "## EXCLUDE BEGIN ##\n#@follow_tag(registry.redhat.io/ubi8:latest)\nFROM registry.redhat.io/ubi8:8.4-211 AS builder\n\nARG upstream_code=upstream_code\nARG upstream_tarball=${upstream_code}.tar.gz\n    \nCOPY ${CI_ARCHIVE_ORIGIN_AGGREGATED_LOGGING} ${upstream_tarball}    \nRUN mkdir -p ${upstream_code} \\    \n    && tar -xzf ${upstream_tarball} \\    \n        --strip-components 1 \\    \n        -C ${upstream_code}  \n## EXCLUDE END ##\n\n#@follow_tag(registry.redhat.io/ubi8:latest)\nFROM registry.redhat.io/ubi8:8.4-211\n## EXCLUDE BEGIN ##\nARG upstream_code=upstream_code/elasticsearch\n## EXCLUDE END ##\nENV BUILD_VERSION=6.8.1\nENV SOURCE_GIT_COMMIT=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_COMMIT:-}\nENV SOURCE_GIT_URL=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_URL:-}\n\nMAINTAINER OpenShift Development <dev@lists.openshift.redhat.com>\n\nEXPOSE 9200\nEXPOSE 9300\nUSER 0\n\nARG ES_ARCHIVE_URL\nARG PROMETHEUS_EXPORTER_URL\nARG INGEST_PLUGIN_URL\nARG OPENDISTRO_URL\nARG OPENSHIFT_CI\n\n\nENV ES_PATH_CONF=/etc/elasticsearch/ \\\n    ES_HOME=/usr/share/elasticsearch \\\n    ES_VER=6.8.1.redhat-00018 \\\n    HOME=/opt/app-root/src \\\n    INSTANCE_RAM=512G \\\n    JAVA_VER=11 \\\n    JAVA_HOME=/usr/lib/jvm/jre \\\n    _JAVA_OPTIONS=\"-Dcom.redhat.fips=false\" \\\n    NODE_QUORUM=1 \\\n    PROMETHEUS_EXPORTER_VER=6.8.1.2-redhat-00001 \\\n    INGEST_PLUGIN_VER=6.8.1.0-redhat-00003 \\\n    OPENDISTRO_VER=0.10.1.2-redhat-00006 \\\n    PLUGIN_LOGLEVEL=INFO \\\n    RECOVER_AFTER_NODES=1 \\\n    RECOVER_EXPECTED_NODES=1 \\\n    RECOVER_AFTER_TIME=5m \\\n    DHE_TMP_KEY_SIZE=2048 \\\n    RELEASE_STREAM=prod \\\n    OPENSHIFT_CI=${OPENSHIFT_CI:-false}\n\n\n# COPY $REMOTE_SOURCE $REMOTE_SOURCE_DIR\n# WORKDIR $REMOTE_SOURCE_DIR/app/elasticsearch\n\nRUN packages=\"java-${JAVA_VER}-openjdk-headless \\\n              python36 \\\n              python3-pyyaml \\\n              hostname \\\n              openssl \\\n              zip \\\n              unzip\" && \\\n    yum install -y ${packages} && \\\n    rpm -V ${packages} && \\\n    alternatives --set python /usr/bin/python3 && \\\n    yum clean all\n\nARG MAVEN_REPO_URL=${MAVEN_REPO_URL:-file:///artifacts/}\n## EXCLUDE BEGIN ##\nENV upstream_code=upstream_code/elasticsearch\n## EXCLUDE END ##\nENV upstream_code=${upstream_code:-\".\"}\n\nCOPY --from=builder ${upstream_code}/extra-jvm.options /var/tmp\nCOPY --from=builder ${upstream_code}/ci-env.sh /var/tmp\nCOPY --from=builder ${upstream_code}/install-es.sh /var/tmp\nCOPY artifacts /artifacts\nRUN /var/tmp/install-es.sh && rm -rf /var/tmp/*\n\nCOPY --from=builder ${upstream_code}/sgconfig/ ${HOME}/sgconfig/\nCOPY --from=builder ${upstream_code}/index_templates/ ${ES_HOME}/index_templates/\nCOPY --from=builder ${upstream_code}/ingest_pipelines/ ${ES_HOME}/ingest_pipelines/\nCOPY --from=builder ${upstream_code}/index_patterns/ ${ES_HOME}/index_patterns/\nCOPY --from=builder ${upstream_code}/init/ ${ES_HOME}/init/\nCOPY --from=builder ${upstream_code}/probe/ ${ES_HOME}/probe/\nCOPY --from=builder ${upstream_code}/init.sh ${HOME}/\nCOPY --from=builder ${upstream_code}/run.sh ${HOME}/\nCOPY --from=builder ${upstream_code}/ci-env.sh ${HOME}/\nCOPY --from=builder ${upstream_code}/install.sh ${HOME}/\nCOPY --from=builder ${upstream_code}/utils/** /usr/local/bin/\n\nRUN ${HOME}/install.sh && rm -rf /artifacts && \\\n  mv ${ES_HOME}/lib/elasticsearch-${ES_VER}.jar ${ES_HOME}/lib/elasticsearch-$(echo $ES_VER | cut -d'.' -f1-3).jar\n\nWORKDIR ${HOME}\nUSER 1000\nCMD [\"sh\", \"/opt/app-root/src/run.sh\"]\n\nLABEL \\\n        License=\"Apache-2.0\" \\\n        io.k8s.description=\"Elasticsearch container for EFK aggregated logging storage\" \\\n        io.k8s.display-name=\"Elasticsearch 6\" \\\n        io.openshift.tags=\"logging,elk,elasticsearch\" \\\n        vendor=\"Red Hat\" \\\n        name=\"openshift-logging/elasticsearch6-rhel8\" \\\n        com.redhat.component=\"logging-elasticsearch6-container\" \\\n        io.openshift.maintainer.product=\"OpenShift Container Platform\" \\\n        io.openshift.build.commit.id=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_COMMIT} \\\n        io.openshift.build.source-location=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_URL} \\\n        io.openshift.build.commit.url=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_URL}/commit/${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_COMMIT} \\\n        version=v6.8.1\n", "- nvr: org.elasticsearch-elasticsearch-6.8.1.redhat_00018-1\n- nvr: com.amazon.opendistroforelasticsearch-opendistro_security-0.10.1.2_redhat_00006-1\n- nvr: org.elasticsearch.plugin.prometheus-prometheus-exporter-6.8.1.2_redhat_00001-1\n- nvr: org.elasticsearch.plugin.ingest-openshift-ingest-plugin-6.8.1.0_redhat_00003-1\n"], "fixing_code": ["### This is a generated file from Dockerfile.in ###\n\n#@follow_tag(registry.redhat.io/ubi8:latest)\nFROM registry.ci.openshift.org/ocp/builder:rhel-8-base-openshift-4.7\nENV BUILD_VERSION=6.8.1\nENV SOURCE_GIT_COMMIT=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_COMMIT:-}\nENV SOURCE_GIT_URL=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_URL:-}\n\nMAINTAINER OpenShift Development <dev@lists.openshift.redhat.com>\n\nEXPOSE 9200\nEXPOSE 9300\nUSER 0\n\nARG ES_ARCHIVE_URL\nARG PROMETHEUS_EXPORTER_URL\nARG INGEST_PLUGIN_URL\nARG OPENDISTRO_URL\nARG OPENSHIFT_CI\n\n\nENV ES_PATH_CONF=/etc/elasticsearch/ \\\n    ES_HOME=/usr/share/elasticsearch \\\n    ES_VER=6.8.1.redhat-00019 \\\n    HOME=/opt/app-root/src \\\n    INSTANCE_RAM=512G \\\n    JAVA_VER=11 \\\n    JAVA_HOME=/usr/lib/jvm/jre \\\n    _JAVA_OPTIONS=\"-Dcom.redhat.fips=false\" \\\n    NODE_QUORUM=1 \\\n    PROMETHEUS_EXPORTER_VER=6.8.1.2-redhat-00001 \\\n    INGEST_PLUGIN_VER=6.8.1.0-redhat-00003 \\\n    OPENDISTRO_VER=0.10.1.2-redhat-00009 \\\n    PLUGIN_LOGLEVEL=INFO \\\n    RECOVER_AFTER_NODES=1 \\\n    RECOVER_EXPECTED_NODES=1 \\\n    RECOVER_AFTER_TIME=5m \\\n    DHE_TMP_KEY_SIZE=2048 \\\n    RELEASE_STREAM=prod \\\n    OPENSHIFT_CI=${OPENSHIFT_CI:-false}\n\n\n# COPY $REMOTE_SOURCE $REMOTE_SOURCE_DIR\n# WORKDIR $REMOTE_SOURCE_DIR/app/elasticsearch\n\nRUN packages=\"java-${JAVA_VER}-openjdk-headless \\\n              python36 \\\n              python3-pyyaml \\\n              hostname \\\n              openssl \\\n              zip \\\n              unzip\" && \\\n    yum install -y ${packages} && \\\n    rpm -V ${packages} && \\\n    alternatives --set python /usr/bin/python3 && \\\n    yum clean all\n\nARG MAVEN_REPO_URL=${MAVEN_REPO_URL:-file:///artifacts/}\nENV upstream_code=${upstream_code:-\".\"}\n\nCOPY  ${upstream_code}/extra-jvm.options /var/tmp\nCOPY  ${upstream_code}/ci-env.sh /var/tmp\nCOPY  ${upstream_code}/install-es.sh /var/tmp\nCOPY artifacts /artifacts\nRUN /var/tmp/install-es.sh && rm -rf /var/tmp/*\n\nCOPY  ${upstream_code}/sgconfig/ ${HOME}/sgconfig/\nCOPY  ${upstream_code}/index_templates/ ${ES_HOME}/index_templates/\nCOPY  ${upstream_code}/ingest_pipelines/ ${ES_HOME}/ingest_pipelines/\nCOPY  ${upstream_code}/index_patterns/ ${ES_HOME}/index_patterns/\nCOPY  ${upstream_code}/init/ ${ES_HOME}/init/\nCOPY  ${upstream_code}/probe/ ${ES_HOME}/probe/\nCOPY  ${upstream_code}/init.sh ${HOME}/\nCOPY  ${upstream_code}/run.sh ${HOME}/\nCOPY  ${upstream_code}/ci-env.sh ${HOME}/\nCOPY  ${upstream_code}/install.sh ${HOME}/\nCOPY  ${upstream_code}/utils/** /usr/local/bin/\n\nRUN ${HOME}/install.sh && rm -rf /artifacts && \\\n  mv ${ES_HOME}/lib/elasticsearch-${ES_VER}.jar ${ES_HOME}/lib/elasticsearch-$(echo $ES_VER | cut -d'.' -f1-3).jar\n\nWORKDIR ${HOME}\nUSER 1000\nCMD [\"sh\", \"/opt/app-root/src/run.sh\"]\n\nLABEL \\\n        License=\"Apache-2.0\" \\\n        io.k8s.description=\"Elasticsearch container for EFK aggregated logging storage\" \\\n        io.k8s.display-name=\"Elasticsearch 6\" \\\n        io.openshift.tags=\"logging,elk,elasticsearch\" \\\n        vendor=\"Red Hat\" \\\n        name=\"openshift-logging/elasticsearch6-rhel8\" \\\n        com.redhat.component=\"logging-elasticsearch6-container\" \\\n        io.openshift.maintainer.product=\"OpenShift Container Platform\" \\\n        io.openshift.build.commit.id=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_COMMIT} \\\n        io.openshift.build.source-location=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_URL} \\\n        io.openshift.build.commit.url=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_URL}/commit/${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_COMMIT} \\\n        version=v6.8.1\n\n", "## EXCLUDE BEGIN ##\n#@follow_tag(registry.redhat.io/ubi8:latest)\nFROM registry.redhat.io/ubi8:8.4-211 AS builder\n\nARG upstream_code=upstream_code\nARG upstream_tarball=${upstream_code}.tar.gz\n    \nCOPY ${CI_ARCHIVE_ORIGIN_AGGREGATED_LOGGING} ${upstream_tarball}    \nRUN mkdir -p ${upstream_code} \\    \n    && tar -xzf ${upstream_tarball} \\    \n        --strip-components 1 \\    \n        -C ${upstream_code}  \n## EXCLUDE END ##\n\n#@follow_tag(registry.redhat.io/ubi8:latest)\nFROM registry.redhat.io/ubi8:8.4-211\n## EXCLUDE BEGIN ##\nARG upstream_code=upstream_code/elasticsearch\n## EXCLUDE END ##\nENV BUILD_VERSION=6.8.1\nENV SOURCE_GIT_COMMIT=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_COMMIT:-}\nENV SOURCE_GIT_URL=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_URL:-}\n\nMAINTAINER OpenShift Development <dev@lists.openshift.redhat.com>\n\nEXPOSE 9200\nEXPOSE 9300\nUSER 0\n\nARG ES_ARCHIVE_URL\nARG PROMETHEUS_EXPORTER_URL\nARG INGEST_PLUGIN_URL\nARG OPENDISTRO_URL\nARG OPENSHIFT_CI\n\n\nENV ES_PATH_CONF=/etc/elasticsearch/ \\\n    ES_HOME=/usr/share/elasticsearch \\\n    ES_VER=6.8.1.redhat-00019 \\\n    HOME=/opt/app-root/src \\\n    INSTANCE_RAM=512G \\\n    JAVA_VER=11 \\\n    JAVA_HOME=/usr/lib/jvm/jre \\\n    _JAVA_OPTIONS=\"-Dcom.redhat.fips=false\" \\\n    NODE_QUORUM=1 \\\n    PROMETHEUS_EXPORTER_VER=6.8.1.2-redhat-00001 \\\n    INGEST_PLUGIN_VER=6.8.1.0-redhat-00003 \\\n    OPENDISTRO_VER=0.10.1.2-redhat-00009 \\\n    PLUGIN_LOGLEVEL=INFO \\\n    RECOVER_AFTER_NODES=1 \\\n    RECOVER_EXPECTED_NODES=1 \\\n    RECOVER_AFTER_TIME=5m \\\n    DHE_TMP_KEY_SIZE=2048 \\\n    RELEASE_STREAM=prod \\\n    OPENSHIFT_CI=${OPENSHIFT_CI:-false}\n\n\n# COPY $REMOTE_SOURCE $REMOTE_SOURCE_DIR\n# WORKDIR $REMOTE_SOURCE_DIR/app/elasticsearch\n\nRUN packages=\"java-${JAVA_VER}-openjdk-headless \\\n              python36 \\\n              python3-pyyaml \\\n              hostname \\\n              openssl \\\n              zip \\\n              unzip\" && \\\n    yum install -y ${packages} && \\\n    rpm -V ${packages} && \\\n    alternatives --set python /usr/bin/python3 && \\\n    yum clean all\n\nARG MAVEN_REPO_URL=${MAVEN_REPO_URL:-file:///artifacts/}\n## EXCLUDE BEGIN ##\nENV upstream_code=upstream_code/elasticsearch\n## EXCLUDE END ##\nENV upstream_code=${upstream_code:-\".\"}\n\nCOPY --from=builder ${upstream_code}/extra-jvm.options /var/tmp\nCOPY --from=builder ${upstream_code}/ci-env.sh /var/tmp\nCOPY --from=builder ${upstream_code}/install-es.sh /var/tmp\nCOPY artifacts /artifacts\nRUN /var/tmp/install-es.sh && rm -rf /var/tmp/*\n\nCOPY --from=builder ${upstream_code}/sgconfig/ ${HOME}/sgconfig/\nCOPY --from=builder ${upstream_code}/index_templates/ ${ES_HOME}/index_templates/\nCOPY --from=builder ${upstream_code}/ingest_pipelines/ ${ES_HOME}/ingest_pipelines/\nCOPY --from=builder ${upstream_code}/index_patterns/ ${ES_HOME}/index_patterns/\nCOPY --from=builder ${upstream_code}/init/ ${ES_HOME}/init/\nCOPY --from=builder ${upstream_code}/probe/ ${ES_HOME}/probe/\nCOPY --from=builder ${upstream_code}/init.sh ${HOME}/\nCOPY --from=builder ${upstream_code}/run.sh ${HOME}/\nCOPY --from=builder ${upstream_code}/ci-env.sh ${HOME}/\nCOPY --from=builder ${upstream_code}/install.sh ${HOME}/\nCOPY --from=builder ${upstream_code}/utils/** /usr/local/bin/\n\nRUN ${HOME}/install.sh && rm -rf /artifacts && \\\n  mv ${ES_HOME}/lib/elasticsearch-${ES_VER}.jar ${ES_HOME}/lib/elasticsearch-$(echo $ES_VER | cut -d'.' -f1-3).jar\n\nWORKDIR ${HOME}\nUSER 1000\nCMD [\"sh\", \"/opt/app-root/src/run.sh\"]\n\nLABEL \\\n        License=\"Apache-2.0\" \\\n        io.k8s.description=\"Elasticsearch container for EFK aggregated logging storage\" \\\n        io.k8s.display-name=\"Elasticsearch 6\" \\\n        io.openshift.tags=\"logging,elk,elasticsearch\" \\\n        vendor=\"Red Hat\" \\\n        name=\"openshift-logging/elasticsearch6-rhel8\" \\\n        com.redhat.component=\"logging-elasticsearch6-container\" \\\n        io.openshift.maintainer.product=\"OpenShift Container Platform\" \\\n        io.openshift.build.commit.id=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_COMMIT} \\\n        io.openshift.build.source-location=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_URL} \\\n        io.openshift.build.commit.url=${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_URL}/commit/${CI_ORIGIN_AGGREGATED_LOGGING_UPSTREAM_COMMIT} \\\n        version=v6.8.1\n", "- nvr: org.elasticsearch-elasticsearch-6.8.1.redhat_00019-1\n- nvr: com.amazon.opendistroforelasticsearch-opendistro_security-0.10.1.2_redhat_00009-1\n- nvr: org.elasticsearch.plugin.prometheus-prometheus-exporter-6.8.1.2_redhat_00001-1\n- nvr: org.elasticsearch.plugin.ingest-openshift-ingest-plugin-6.8.1.0_redhat_00003-1\n"], "filenames": ["elasticsearch/Dockerfile", "elasticsearch/Dockerfile.in", "elasticsearch/fetch-artifacts-koji.yaml"], "buggy_code_start_loc": [24, 39, 1], "buggy_code_end_loc": [34, 49, 3], "fixing_code_start_loc": [24, 39, 1], "fixing_code_end_loc": [34, 49, 3], "type": "CWE-444", "message": "A flaw was found in the original fix for the netty-codec-http CVE-2021-21409, where the OpenShift Logging openshift-logging/elasticsearch6-rhel8 container was incomplete. The vulnerable netty-codec-http maven package was not removed from the image content. This flaw affects origin-aggregated-logging versions 3.11.", "other": {"cve": {"id": "CVE-2022-0552", "sourceIdentifier": "secalert@redhat.com", "published": "2022-04-11T20:15:16.493", "lastModified": "2023-02-12T22:15:20.927", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "A flaw was found in the original fix for the netty-codec-http CVE-2021-21409, where the OpenShift Logging openshift-logging/elasticsearch6-rhel8 container was incomplete. The vulnerable netty-codec-http maven package was not removed from the image content. This flaw affects origin-aggregated-logging versions 3.11."}, {"lang": "es", "value": "Se ha encontrado un fallo en la correcci\u00f3n original de netty-codec-http CVE-2021-21409, donde el contenedor OpenShift Logging openshift-logging/elasticsearch6-rhel8 estaba incompleto. El paquete maven vulnerable netty-codec-http no fue eliminado del contenido de la imagen. Este fallo afecta a origin-aggregated-logging versiones 3.11"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-444"}]}, {"source": "nvd@nist.gov", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-444"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:origin-aggregated-logging:3.11:*:*:*:*:*:*:*", "matchCriteriaId": "9F9162FF-D9D7-4658-853E-8AB0605CC632"}]}]}], "references": [{"url": "https://access.redhat.com/security/cve/CVE-2021-21409", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2052539", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Vendor Advisory"]}, {"url": "https://github.com/openshift/origin-aggregated-logging/commit/d6b72d6c32e7c06b65324294d10406546734004d", "source": "secalert@redhat.com", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/openshift/origin-aggregated-logging/commit/d6b72d6c32e7c06b65324294d10406546734004d"}}