{"buggy_code": ["#\n# Copyright 2022 Apollo Authors\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n# http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\nspring:\n  application:\n    name: apollo-portal\n  profiles:\n    active: ${apollo_profile}\n  jpa:\n    properties:\n      hibernate:\n        metadata_builder_contributor: com.ctrip.framework.apollo.common.jpa.SqlFunctionsMetadataBuilderContributor\n        query:\n          plan_cache_max_size: 192 # limit query plan cache max size\n  session:\n    store-type: jdbc\n    jdbc:\n      initialize-schema: never\n  servlet:\n    multipart:\n      max-file-size: 200MB  # import data configs\n      max-request-size: 200MB\nserver:\n  port: 8070\n  compression:\n    enabled: true\n  tomcat:\n    use-relative-redirects: true\n\nlogging:\n  file:\n    name: /opt/logs/100003173/apollo-portal.log\n\nmanagement:\n  health:\n    status:\n      order: DOWN, OUT_OF_SERVICE, UNKNOWN, UP\n    ldap:\n      enabled: false # disable ldap health check by default\n"], "fixing_code": ["#\n# Copyright 2022 Apollo Authors\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at\n#\n# http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n#\nspring:\n  application:\n    name: apollo-portal\n  profiles:\n    active: ${apollo_profile}\n  jpa:\n    properties:\n      hibernate:\n        metadata_builder_contributor: com.ctrip.framework.apollo.common.jpa.SqlFunctionsMetadataBuilderContributor\n        query:\n          plan_cache_max_size: 192 # limit query plan cache max size\n  session:\n    store-type: jdbc\n    jdbc:\n      initialize-schema: never\n  servlet:\n    multipart:\n      max-file-size: 200MB  # import data configs\n      max-request-size: 200MB\nserver:\n  port: 8070\n  compression:\n    enabled: true\n  tomcat:\n    use-relative-redirects: true\n  servlet:\n    session:\n      cookie:\n        # prevent csrf\n        same-site: Lax\n\nlogging:\n  file:\n    name: /opt/logs/100003173/apollo-portal.log\n\nmanagement:\n  health:\n    status:\n      order: DOWN, OUT_OF_SERVICE, UNKNOWN, UP\n    ldap:\n      enabled: false # disable ldap health check by default\n"], "filenames": ["apollo-portal/src/main/resources/application.yml"], "buggy_code_start_loc": [40], "buggy_code_end_loc": [40], "fixing_code_start_loc": [41], "fixing_code_end_loc": [46], "type": "CWE-352", "message": "Apollo is a configuration management system. Prior to version 2.1.0, a low-privileged user can create a special web page. If an authenticated portal admin visits this page, the page can silently send a request to assign new roles for that user without any confirmation from the Portal admin. Cookie SameSite strategy was set to Lax in version 2.1.0. As a workaround, avoid visiting unknown source pages.", "other": {"cve": {"id": "CVE-2023-25569", "sourceIdentifier": "security-advisories@github.com", "published": "2023-02-20T16:15:10.503", "lastModified": "2023-03-01T15:51:22.117", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Apollo is a configuration management system. Prior to version 2.1.0, a low-privileged user can create a special web page. If an authenticated portal admin visits this page, the page can silently send a request to assign new roles for that user without any confirmation from the Portal admin. Cookie SameSite strategy was set to Lax in version 2.1.0. As a workaround, avoid visiting unknown source pages."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apolloconfig:apollo:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.1.0", "matchCriteriaId": "799ED7FE-4FAA-475E-A4E6-2F3179879F3E"}]}]}], "references": [{"url": "https://github.com/apolloconfig/apollo/commit/00d968a7229f809b0d8ed0532e8c01a6c2b7c750", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/apolloconfig/apollo/pull/4664", "source": "security-advisories@github.com", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://github.com/apolloconfig/apollo/releases/tag/v2.1.0", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/apolloconfig/apollo/security/advisories/GHSA-fmxq-v8mg-qh25", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://www.apolloconfig.com/#/en/usage/apollo-user-guide?id=_71-security-related", "source": "security-advisories@github.com", "tags": ["Product"]}]}, "github_commit_url": "https://github.com/apolloconfig/apollo/commit/00d968a7229f809b0d8ed0532e8c01a6c2b7c750"}}