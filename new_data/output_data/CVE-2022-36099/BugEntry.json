{"buggy_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.3\" reference=\"XWiki.XWikiServerClassSheet\" locale=\"\">\n  <web>XWiki</web>\n  <name>XWikiServerClassSheet</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>XWiki.XWikiServerClass</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>#if($doc.getObject('XWiki.XWikiServerClass'))$services.localization.render('platform.wiki.sheet.title', [$doc.documentReference.name.replaceAll('XWikiServer', '').toLowerCase()])#{else}Sheet for XWikiServerClass#end</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{velocity}}\n#############################\n##        GLOBALS\n#############################\n#set ($wikiId = $doc.documentReference.name.replaceAll('XWikiServer', '').toLowerCase())\n#set ($wiki = $services.wiki.getById($wikiId))\n#set ($descriptorObj = $doc.getObject('XWiki.XWikiServerClass'))\n#set ($templateObj = $doc.getObject('WikiManager.WikiTemplateClass'))\n#set ($aliases = $doc.getObjects('XWiki.XWikiServerClass'))\n#############################\n##       CONTROLLER\n#############################\n#controller()\n#macro(controller)\n  #if ($doc.fullName == \"XWiki.XWikiServerClassSheet\" || $doc.fullName == \"XWiki.XWikiServerClassTemplate\")\n    = Document \"$doc.documentReference.name\" =\n  #elseif ($request.action == 'create' &amp;&amp; \"$!request.domain\" != '' &amp;&amp; $request.domain.trim().length() &gt; 0)\n    #createAlias()\n  #elseif ($request.action == 'delete' &amp;&amp; \"$!request.domain\" != '' &amp;&amp; $request.domain.trim().length() &gt; 0)\n    #deleteAlias()\n  #elseif ($xcontext.action == 'edit')\n    #edit()\n  #else\n    #view()\n  #end\n#end\n#############################\n##         VIEW\n#############################\n#macro(view)\n  #set($adminPageRef = $services.model.createDocumentReference($wiki.id, 'XWiki', 'XWikiPreferences'))\n  #set($adminPageLink = \"[[$services.localization.render('platform.wiki.sheet.descriptor.admin')&gt;&gt;$adminPageRef]]\")\n  {{translation key=\"platform.wiki.sheet.descriptor\" parameters=\"${wiki.id},${adminPageLink}\"/}} $adminPageLink\n  \n  {{toc /}}\n  #displaySettings()\n  #displayAliases()\n  #createAliasForm()\n#end\n#############################\n##         EDIT\n#############################\n#macro(edit)\n  {{toc /}}\n  #displaySettings()\n  #displayAliases()\n#end\n#############################\n##      CREATE ALIAS\n#############################\n#macro(createAlias)\n  #if (!${services.csrf.isTokenValid(\"$!{request.getParameter('form_token')}\")})\n\n    {{error}}{{translation key=\"notallowed\"/}}{{/error}}\n\n  #elseif (!$wiki.aliases.contains($request.domain))\n    #set ($alias = $doc.newObject(\"XWiki.XWikiServerClass\"))\n    #set ($discard = $alias.set(\"server\", $request.domain))\n    #set ($discard = $alias.set(\"homepage\", \"Main.WebHome\"))\n    #set ($discard = $doc.save())\n    $response.sendRedirect($doc.getURL())\n  #else\n\n    {{error}}{{translation key=\"platform.wiki.sheet.erroraliasalreadynotexists\" parameters=\"$request.domain\"/}}{{/error}}\n\n  #end\n#end\n#############################\n##      DELETE ALIAS\n#############################\n#macro(deleteAlias)\n  #if (!${services.csrf.isTokenValid(\"$!{request.getParameter('form_token')}\")})\n\n    {{error}}{{translation key=\"notallowed\"/}}{{/error}}\n    \n  #elseif ($wiki.aliases.contains($request.domain))\n    #set ($alias = $doc.getObject('XWiki.XWikiServerClass', 'server', $request.domain))\n    #set ($removed = $doc.removeObject($alias))\n    #set ($discard = $doc.save())\n    $response.sendRedirect($doc.getURL())\n  #else\n  \n    {{error}}{{translation key=\"platform.wiki.sheet.erroraliasdoesnotexists\" parameters=\"$request.domain\"/}}{{/error}}\n    \n  #end\n#end\n#############################\n##    DISPLAY SETTINGS\n#############################\n#macro(displaySettings)\n  (% id=\"HWikiProperties\" %)\n  = {{translation key=\"platform.wiki.sheet.title.settings\"/}} =\n  {{html wiki=\"true\" clean=\"false\"}}\n  &lt;div class=\"xform\"&gt;\n  &lt;dl&gt;\n    #displayField('wikiprettyname', $descriptorObj)\n    #displayField('owner', $descriptorObj)\n    #displayField('secure', $descriptorObj)\n    #displayField('port', $descriptorObj)\n    #displayField('iswikitemplate', $templateObj)\n    #displayField('server', $descriptorObj)\n    #displayField('description', $descriptorObj)\n    #displayField('homepage', $descriptorObj, \"#homePagePicker($descriptorObj)\")\n  &lt;/dl&gt;\n  &lt;/div&gt;\n  {{/html}}\n#end\n#############################\n##      DISPLAY FIELD\n#############################\n#macro(displayField $fieldName $object $customDisplay)\n  #if (\"$!object\" != '')\n    &lt;dt&gt;\n      #if ($xcontext.action=='edit')\n        &lt;label for=\"${object.xWikiClass.name}_${object.number}_${fieldName}\"&gt;\n      #else\n        &lt;label&gt;\n      #end\n      {{translation key=\"platform.wiki.sheet.prop.${fieldName}\" /}}:\n      &lt;/label&gt;\n      &lt;span class=\"xHint\"&gt;{{translation key=\"platform.wiki.sheet.desc.${fieldName}\" /}}&lt;/span&gt;\n    &lt;/dt&gt;\n    &lt;dd&gt;#if (\"$!customDisplay\" != '')$customDisplay#else$object.get($fieldName)#end&lt;/dd&gt;\n  #end\n#end\n#macro (homePagePicker $object)\n  #if ($xcontext.action == 'edit')\n    ## The wiki descriptor is stored on the main wiki so we need to configure the page picker to give suggestions from\n    ## the corresponding wiki (not from the main wiki).\n    #set ($id = \"${object.xWikiClass.name}_${object.number}_homepage\")\n    #set ($homePagePickerParams = {\n      'id': $id,\n      'name': $id,\n      'value': $object.getValue('homepage'),\n      'data-search-scope': \"wiki:$wikiId\"\n    })\n    #pagePicker($homePagePickerParams)\n  #end\n#end\n#############################\n##    DISPLAY ALIASES\n#############################\n#macro(displayAliases)\n  (% id=\"HWikiViewAliases\" %)\n  = {{translation key=\"platform.wiki.sheet.title.viewaliases\"/}} =\n  {{translation key=\"platform.wiki.sheet.aliases\"/}}\n  #if ($aliases.size() &gt; 1)\n    #foreach ($alias in $aliases)\n      #if ($foreach.count &gt; 1)\n        == $alias.display('server', 'view') ==\n        {{html wiki=\"true\" clean=\"false\"}}\n        &lt;div class=\"xform\"&gt;\n          &lt;dl&gt;\n            #displayField('description', $alias)\n            #displayField('homepage', $alias)\n          &lt;/dl&gt;\n        &lt;/div&gt;\n        {{/html}}\n        #if ($xcontext.action == 'view')\n          #deleteButton($alias)\n        #end\n      #end\n    #end \n  #end\n#end\n#############################\n##   DELETE ALIAS BUTTON\n#############################\n#macro(deleteButton $alias)\n  #if($xcontext.action == 'view')\n\n    {{html}}\n      &lt;form method=\"get\" action=\"$doc.getURL('view')\"&gt;\n        &lt;fieldset&gt;\n          &lt;input type=\"hidden\" name=\"form_token\" value=\"$!{services.csrf.getToken()}\" /&gt;\n          &lt;input type=\"hidden\" name=\"action\" value=\"delete\"/&gt;\n          &lt;input type=\"hidden\" name=\"domain\" value=\"$alias.server\"/&gt;\n          &lt;input type=\"submit\" class=\"button\" value=\"$services.localization.render('delete')\"/&gt;\n        &lt;/fieldset&gt;\n      &lt;/form&gt;\n    {{/html}}\n\n  #end\n#end\n#############################\n##   CREATE ALIAS FORM\n#############################\n#macro(createAliasForm)\n  (% id=\"HWikiCreateNewAlias\" %)\n  = {{translation key=\"platform.wiki.sheet.title.createnewalias\"/}} =\n  \n  {{html}}\n    &lt;form method=\"get\" action=\"$doc.getURL('view')\"&gt;\n      &lt;fieldset&gt;\n        &lt;input type=\"hidden\" name=\"form_token\" value=\"$!{services.csrf.getToken()}\" /&gt;\n        &lt;input type=\"hidden\" name=\"action\" value=\"create\"/&gt;\n        &lt;label for=\"inputdomain\"&gt;$services.localization.render('platform.wiki.sheet.prop.server')&lt;/label&gt;:\n        &lt;input id=\"inputdomain\" type=\"text\" name=\"domain\" class=\"wikialiasinput\"/&gt;\n        &lt;input type=\"submit\" class=\"button\" value=\"$services.localization.render('create')\"/&gt;\n      &lt;/fieldset&gt;\n    &lt;/form&gt;\n  {{/html}}\n  \n#end\n{{/velocity}}</content>\n</xwikidoc>\n"], "fixing_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.3\" reference=\"XWiki.XWikiServerClassSheet\" locale=\"\">\n  <web>XWiki</web>\n  <name>XWikiServerClassSheet</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>XWiki.XWikiServerClass</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>#if($doc.getObject('XWiki.XWikiServerClass'))$services.localization.render('platform.wiki.sheet.title', [$doc.documentReference.name.replaceAll('XWikiServer', '').toLowerCase()])#{else}Sheet for XWikiServerClass#end</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{velocity}}\n#############################\n##        GLOBALS\n#############################\n#set ($wikiId = $doc.documentReference.name.replaceAll('XWikiServer', '').toLowerCase())\n#set ($wiki = $services.wiki.getById($wikiId))\n#set ($descriptorObj = $doc.getObject('XWiki.XWikiServerClass'))\n#set ($templateObj = $doc.getObject('WikiManager.WikiTemplateClass'))\n#set ($aliases = $doc.getObjects('XWiki.XWikiServerClass'))\n#############################\n##       CONTROLLER\n#############################\n#controller()\n#macro(controller)\n  #if ($doc.fullName == \"XWiki.XWikiServerClassSheet\" || $doc.fullName == \"XWiki.XWikiServerClassTemplate\")\n    = Document \"$doc.documentReference.name\" =\n  #elseif ($request.action == 'create' &amp;&amp; \"$!request.domain\" != '' &amp;&amp; $request.domain.trim().length() &gt; 0)\n    #createAlias()\n  #elseif ($request.action == 'delete' &amp;&amp; \"$!request.domain\" != '' &amp;&amp; $request.domain.trim().length() &gt; 0)\n    #deleteAlias()\n  #elseif ($xcontext.action == 'edit')\n    #edit()\n  #else\n    #view()\n  #end\n#end\n#############################\n##         VIEW\n#############################\n#macro(view)\n  #set($adminPageRef = $services.model.createDocumentReference($wiki.id, 'XWiki', 'XWikiPreferences'))\n  #set($adminPageLink = \"[[$services.localization.render('platform.wiki.sheet.descriptor.admin')&gt;&gt;$adminPageRef]]\")\n  {{translation key=\"platform.wiki.sheet.descriptor\" parameters=\"${wiki.id},${adminPageLink}\"/}} $adminPageLink\n  \n  {{toc /}}\n  #displaySettings()\n  #displayAliases()\n  #createAliasForm()\n#end\n#############################\n##         EDIT\n#############################\n#macro(edit)\n  {{toc /}}\n  #displaySettings()\n  #displayAliases()\n#end\n#############################\n##      CREATE ALIAS\n#############################\n#macro(createAlias)\n  #if (!${services.csrf.isTokenValid(\"$!{request.getParameter('form_token')}\")})\n\n    {{error}}{{translation key=\"notallowed\"/}}{{/error}}\n\n  #elseif (!$wiki.aliases.contains($request.domain))\n    #set ($alias = $doc.newObject(\"XWiki.XWikiServerClass\"))\n    #set ($discard = $alias.set(\"server\", $request.domain))\n    #set ($discard = $alias.set(\"homepage\", \"Main.WebHome\"))\n    #set ($discard = $doc.save())\n    $response.sendRedirect($doc.getURL())\n  #else\n\n    {{error}}{{translation key=\"platform.wiki.sheet.erroraliasalreadynotexists\" parameters=\"~\"${services.rendering.escape($escapetool.java($request.domain), 'xwiki/2.1')}~\"\"/}}{{/error}}\n\n  #end\n#end\n#############################\n##      DELETE ALIAS\n#############################\n#macro(deleteAlias)\n  #if (!${services.csrf.isTokenValid(\"$!{request.getParameter('form_token')}\")})\n\n    {{error}}{{translation key=\"notallowed\"/}}{{/error}}\n    \n  #elseif ($wiki.aliases.contains($request.domain))\n    #set ($alias = $doc.getObject('XWiki.XWikiServerClass', 'server', $request.domain))\n    #set ($removed = $doc.removeObject($alias))\n    #set ($discard = $doc.save())\n    $response.sendRedirect($doc.getURL())\n  #else\n  \n    {{error}}{{translation key=\"platform.wiki.sheet.erroraliasdoesnotexists\" parameters=\"~\"${services.rendering.escape($escapetool.java($request.domain), 'xwiki/2.1')}~\"\"/}}{{/error}}\n    \n  #end\n#end\n#############################\n##    DISPLAY SETTINGS\n#############################\n#macro(displaySettings)\n  (% id=\"HWikiProperties\" %)\n  = {{translation key=\"platform.wiki.sheet.title.settings\"/}} =\n  {{html wiki=\"true\" clean=\"false\"}}\n  &lt;div class=\"xform\"&gt;\n  &lt;dl&gt;\n    #displayField('wikiprettyname', $descriptorObj)\n    #displayField('owner', $descriptorObj)\n    #displayField('secure', $descriptorObj)\n    #displayField('port', $descriptorObj)\n    #displayField('iswikitemplate', $templateObj)\n    #displayField('server', $descriptorObj)\n    #displayField('description', $descriptorObj)\n    #displayField('homepage', $descriptorObj, \"#homePagePicker($descriptorObj)\")\n  &lt;/dl&gt;\n  &lt;/div&gt;\n  {{/html}}\n#end\n#############################\n##      DISPLAY FIELD\n#############################\n#macro(displayField $fieldName $object $customDisplay)\n  #if (\"$!object\" != '')\n    &lt;dt&gt;\n      #if ($xcontext.action=='edit')\n        &lt;label for=\"${object.xWikiClass.name}_${object.number}_${fieldName}\"&gt;\n      #else\n        &lt;label&gt;\n      #end\n      {{translation key=\"platform.wiki.sheet.prop.${fieldName}\" /}}:\n      &lt;/label&gt;\n      &lt;span class=\"xHint\"&gt;{{translation key=\"platform.wiki.sheet.desc.${fieldName}\" /}}&lt;/span&gt;\n    &lt;/dt&gt;\n    &lt;dd&gt;#if (\"$!customDisplay\" != '')$customDisplay#else$object.get($fieldName)#end&lt;/dd&gt;\n  #end\n#end\n#macro (homePagePicker $object)\n  #if ($xcontext.action == 'edit')\n    ## The wiki descriptor is stored on the main wiki so we need to configure the page picker to give suggestions from\n    ## the corresponding wiki (not from the main wiki).\n    #set ($id = \"${object.xWikiClass.name}_${object.number}_homepage\")\n    #set ($homePagePickerParams = {\n      'id': $id,\n      'name': $id,\n      'value': $object.getValue('homepage'),\n      'data-search-scope': \"wiki:$wikiId\"\n    })\n    #pagePicker($homePagePickerParams)\n  #end\n#end\n#############################\n##    DISPLAY ALIASES\n#############################\n#macro(displayAliases)\n  (% id=\"HWikiViewAliases\" %)\n  = {{translation key=\"platform.wiki.sheet.title.viewaliases\"/}} =\n  {{translation key=\"platform.wiki.sheet.aliases\"/}}\n  #if ($aliases.size() &gt; 1)\n    #foreach ($alias in $aliases)\n      #if ($foreach.count &gt; 1)\n        == $alias.display('server', 'view') ==\n        {{html wiki=\"true\" clean=\"false\"}}\n        &lt;div class=\"xform\"&gt;\n          &lt;dl&gt;\n            #displayField('description', $alias)\n            #displayField('homepage', $alias)\n          &lt;/dl&gt;\n        &lt;/div&gt;\n        {{/html}}\n        #if ($xcontext.action == 'view')\n          #deleteButton($alias)\n        #end\n      #end\n    #end \n  #end\n#end\n#############################\n##   DELETE ALIAS BUTTON\n#############################\n#macro(deleteButton $alias)\n  #if($xcontext.action == 'view')\n\n    {{html}}\n      &lt;form method=\"get\" action=\"$doc.getURL('view')\"&gt;\n        &lt;fieldset&gt;\n          &lt;input type=\"hidden\" name=\"form_token\" value=\"$!{services.csrf.getToken()}\" /&gt;\n          &lt;input type=\"hidden\" name=\"action\" value=\"delete\"/&gt;\n          &lt;input type=\"hidden\" name=\"domain\" value=\"$alias.server\"/&gt;\n          &lt;input type=\"submit\" class=\"button\" value=\"$services.localization.render('delete')\"/&gt;\n        &lt;/fieldset&gt;\n      &lt;/form&gt;\n    {{/html}}\n\n  #end\n#end\n#############################\n##   CREATE ALIAS FORM\n#############################\n#macro(createAliasForm)\n  (% id=\"HWikiCreateNewAlias\" %)\n  = {{translation key=\"platform.wiki.sheet.title.createnewalias\"/}} =\n  \n  {{html}}\n    &lt;form method=\"get\" action=\"$doc.getURL('view')\"&gt;\n      &lt;fieldset&gt;\n        &lt;input type=\"hidden\" name=\"form_token\" value=\"$!{services.csrf.getToken()}\" /&gt;\n        &lt;input type=\"hidden\" name=\"action\" value=\"create\"/&gt;\n        &lt;label for=\"inputdomain\"&gt;$services.localization.render('platform.wiki.sheet.prop.server')&lt;/label&gt;:\n        &lt;input id=\"inputdomain\" type=\"text\" name=\"domain\" class=\"wikialiasinput\"/&gt;\n        &lt;input type=\"submit\" class=\"button\" value=\"$services.localization.render('create')\"/&gt;\n      &lt;/fieldset&gt;\n    &lt;/form&gt;\n  {{/html}}\n  \n#end\n{{/velocity}}</content>\n</xwikidoc>\n"], "filenames": ["xwiki-platform-core/xwiki-platform-wiki/xwiki-platform-wiki-ui/xwiki-platform-wiki-ui-mainwiki/src/main/resources/XWiki/XWikiServerClassSheet.xml"], "buggy_code_start_loc": [102], "buggy_code_end_loc": [122], "fixing_code_start_loc": [102], "fixing_code_end_loc": [122], "type": "CWE-94", "message": "XWiki Platform Wiki UI Main Wiki is software for managing subwikis on XWiki Platform, a generic wiki platform. Starting with version 5.3-milestone-2 and prior to versions 13.10.6 and 14.4, it's possible to inject arbitrary wiki syntax including Groovy, Python and Velocity script macros via the request (URL parameter) using the `XWikiServerClassSheet` if the user has view access to this sheet and another page that has been saved with programming rights, a standard condition on a public read-only XWiki installation or a private XWiki installation where the user has an account. This allows arbitrary Groovy/Python/Velocity code execution which allows bypassing all rights checks and thus both modification and disclosure of all content stored in the XWiki installation. Also, this could be used to impact the availability of the wiki. This has been patched in versions 13.10.6 and 14.4. As a workaround, edit the affected document `XWiki.XWikiServerClassSheet` or `WikiManager.XWikiServerClassSheet` and manually perform the changes from the patch fixing the issue. On XWiki versions 12.0 and later, it is also possible to import the document `XWiki.XWikiServerClassSheet` from the xwiki-platform-wiki-ui-mainwiki package version 14.4 using the import feature of the administration application as there have been no other changes to this document since XWiki 12.0.", "other": {"cve": {"id": "CVE-2022-36099", "sourceIdentifier": "security-advisories@github.com", "published": "2022-09-08T21:15:08.167", "lastModified": "2022-09-14T16:17:13.283", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "XWiki Platform Wiki UI Main Wiki is software for managing subwikis on XWiki Platform, a generic wiki platform. Starting with version 5.3-milestone-2 and prior to versions 13.10.6 and 14.4, it's possible to inject arbitrary wiki syntax including Groovy, Python and Velocity script macros via the request (URL parameter) using the `XWikiServerClassSheet` if the user has view access to this sheet and another page that has been saved with programming rights, a standard condition on a public read-only XWiki installation or a private XWiki installation where the user has an account. This allows arbitrary Groovy/Python/Velocity code execution which allows bypassing all rights checks and thus both modification and disclosure of all content stored in the XWiki installation. Also, this could be used to impact the availability of the wiki. This has been patched in versions 13.10.6 and 14.4. As a workaround, edit the affected document `XWiki.XWikiServerClassSheet` or `WikiManager.XWikiServerClassSheet` and manually perform the changes from the patch fixing the issue. On XWiki versions 12.0 and later, it is also possible to import the document `XWiki.XWikiServerClassSheet` from the xwiki-platform-wiki-ui-mainwiki package version 14.4 using the import feature of the administration application as there have been no other changes to this document since XWiki 12.0."}, {"lang": "es", "value": "XWiki Platform Wiki UI Main Wiki es un software para administrar subwikis en XWiki Platform, una plataforma wiki gen\u00e9rica.&#xa0;A partir de la versi\u00f3n 5.3-milestone-2 y anteriores a 13.10.6 y 14.4, es posible inyectar sintaxis wiki arbitraria, incluidas macros de secuencias de comandos de Groovy, Python y Velocity por medio de la petici\u00f3n (par\u00e1metro de URL) utilizando \"XWikiServerClassSheet\" si el usuario presenta acceso de visualizaci\u00f3n a esta hoja y otra p\u00e1gina que ha sido guardada con derechos de programaci\u00f3n, una condici\u00f3n est\u00e1ndar en una instalaci\u00f3n de XWiki p\u00fablica de solo lectura o una instalaci\u00f3n de XWiki privada donde el usuario presenta una cuenta.&#xa0;Esto permite una ejecuci\u00f3n arbitraria de c\u00f3digo Groovy/Python/Velocity, lo que permite omitir todas las verificaciones de derechos y, por lo tanto, modificar y divulgar todo el contenido almacenado en la instalaci\u00f3n de XWiki.&#xa0;Adem\u00e1s, esto podr\u00eda usarse para afectar la disponibilidad de la wiki.&#xa0;Esto ha sido parcheado en las versiones 13.10.6 y 14.4.&#xa0;Como mitigaci\u00f3n, edite el documento afectado \"XWiki.XWikiServerClassSheet\" o \"WikiManager.XWikiServerClassSheet\" y realice manualmente los cambios del parche que corrigen el problema.&#xa0;En XWiki versiones 12.0 y posteriores, tambi\u00e9n es posible importar el documento \"XWiki.XWikiServerClassSheet\" desde el paquete xwiki-platform-wiki-ui-mainwiki versi\u00f3n 14.4 usando la funci\u00f3n de importaci\u00f3n de la aplicaci\u00f3n de administraci\u00f3n ya que no ha habido otros cambios en este documento desde XWiki versi\u00f3n 12.0"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.9, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}, {"lang": "en", "value": "CWE-95"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.4", "versionEndExcluding": "13.10.6", "matchCriteriaId": "35F7BA8F-C552-4CAA-8AF5-7C7DBD703797"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "14.0", "versionEndExcluding": "14.4", "matchCriteriaId": "78E9227E-5BAE-44FD-B327-13434E0AF974"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:5.3:milestone2:*:*:*:*:*:*", "matchCriteriaId": "067AAD11-1AB2-4688-8D81-F2464CD2FA14"}]}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/fc77f9f53bc65a4a9bfae3d5686615309c0c76cc", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-xr6m-2p4m-jvqf", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://jira.xwiki.org/browse/XWIKI-19746", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}]}, "github_commit_url": "https://github.com/xwiki/xwiki-platform/commit/fc77f9f53bc65a4a9bfae3d5686615309c0c76cc"}}