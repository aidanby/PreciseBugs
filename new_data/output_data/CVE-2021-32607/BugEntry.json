{"buggy_code": ["@model PrivateMessageModel\n@using SmartStore.Web.Models.PrivateMessages;\n@{\n    Layout = \"_Layout\";\n    Html.AddTitleParts(T(\"PageTitle.ViewPM\").Text);\n}\n\n<div class=\"page private-message-view-page\">\n    <div class=\"page-title\">\n        <h2>@T(\"PrivateMessages.View.ViewMessage\")</h2>\n    </div>\n\n    <div class=\"page-body\">\n        <div class=\"row my-1\">\n            <label class=\"col-sm-3\">@T(\"PrivateMessages.View.From\")</label>\n            <div class=\"col-sm-9\">@Model.CustomerFromName</div>\n        </div>\n        <div class=\"row my-1\">\n            <label class=\"col-sm-3\">@T(\"PrivateMessages.View.To\")</label>\n            <div class=\"col-sm-9\">@Model.CustomerToName</div>\n        </div>\n        <div class=\"row my-1\">\n            <label class=\"col-sm-3\">@T(\"PrivateMessages.View.Subject\")</label>\n            <div class=\"col-sm-9\" dir=\"auto\">@Model.Subject</div>\n        </div>\n        <div class=\"row mt-1 mb-3\">\n            <label class=\"col-sm-3\">@T(\"PrivateMessages.View.Message\")</label>\n            <div class=\"col-sm-9\">\n                <div class=\"card\">\n                    <div class=\"card-body\" dir=\"auto\">\n                        @Html.Raw(Model.Message)\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"row justify-content-end\">\n            <div class=\"col-sm-9\">\n                <a class=\"btn btn-secondary\" href='@Url.RouteUrl(\"PrivateMessages\", new { tab = \"inbox\" })' rel=\"nofollow\">\n                    <i class=\"fa fa-angle-left\"></i>\n                    <span>@T(\"PrivateMessages.View.BackButton\")</span>\n                </a>\n                <a class=\"btn btn-secondary\" href='@Url.Action(\"Send\", new { id = Model.FromCustomerId, replyToMessageId = Model.Id })' rel=\"nofollow\">\n                    <span>@T(\"PrivateMessages.View.ReplyButton\")</span>\n                    <i class=\"fa fa-share\"></i>\n                </a>\n                <a class=\"btn btn-danger\" href='@Url.Action(\"Delete\", new { id = Model.Id })' rel=\"nofollow\">\n                    <i class=\"far fa-trash-alt\"></i>\n                    <span>@T(\"PrivateMessages.View.DeleteButton\")</span>\n                </a>\n            </div>\n        </div>\n    </div>\n</div>\n"], "fixing_code": ["@model PrivateMessageModel\n@using SmartStore.Web.Models.PrivateMessages;\n@using SmartStore.Core.Html;\n@{\n    Layout = \"_Layout\";\n    Html.AddTitleParts(T(\"PageTitle.ViewPM\").Text);\n}\n\n<div class=\"page private-message-view-page\">\n    <div class=\"page-title\">\n        <h2>@T(\"PrivateMessages.View.ViewMessage\")</h2>\n    </div>\n\n    <div class=\"page-body\">\n        <div class=\"row my-1\">\n            <label class=\"col-sm-3\">@T(\"PrivateMessages.View.From\")</label>\n            <div class=\"col-sm-9\">@Model.CustomerFromName</div>\n        </div>\n        <div class=\"row my-1\">\n            <label class=\"col-sm-3\">@T(\"PrivateMessages.View.To\")</label>\n            <div class=\"col-sm-9\">@Model.CustomerToName</div>\n        </div>\n        <div class=\"row my-1\">\n            <label class=\"col-sm-3\">@T(\"PrivateMessages.View.Subject\")</label>\n            <div class=\"col-sm-9\" dir=\"auto\">@Model.Subject</div>\n        </div>\n        <div class=\"row mt-1 mb-3\">\n            <label class=\"col-sm-3\">@T(\"PrivateMessages.View.Message\")</label>\n            <div class=\"col-sm-9\">\n                <div class=\"card\">\n                    <div class=\"card-body\" dir=\"auto\">\n                        @Html.Raw(HtmlUtils.SanitizeHtml(Model.Message, true))\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"row justify-content-end\">\n            <div class=\"col-sm-9\">\n                <a class=\"btn btn-secondary\" href='@Url.RouteUrl(\"PrivateMessages\", new { tab = \"inbox\" })' rel=\"nofollow\">\n                    <i class=\"fa fa-angle-left\"></i>\n                    <span>@T(\"PrivateMessages.View.BackButton\")</span>\n                </a>\n                <a class=\"btn btn-secondary\" href='@Url.Action(\"Send\", new { id = Model.FromCustomerId, replyToMessageId = Model.Id })' rel=\"nofollow\">\n                    <span>@T(\"PrivateMessages.View.ReplyButton\")</span>\n                    <i class=\"fa fa-share\"></i>\n                </a>\n                <a class=\"btn btn-danger\" href='@Url.Action(\"Delete\", new { id = Model.Id })' rel=\"nofollow\">\n                    <i class=\"far fa-trash-alt\"></i>\n                    <span>@T(\"PrivateMessages.View.DeleteButton\")</span>\n                </a>\n            </div>\n        </div>\n    </div>\n</div>\n"], "filenames": ["src/Presentation/SmartStore.Web/Views/PrivateMessages/View.cshtml"], "buggy_code_start_loc": [2], "buggy_code_end_loc": [32], "fixing_code_start_loc": [3], "fixing_code_end_loc": [33], "type": "NVD-CWE-noinfo", "message": "An issue was discovered in Smartstore (aka SmartStoreNET) through 4.1.1. Views/PrivateMessages/View.cshtml does not call HtmlUtils.SanitizeHtml on a private message.", "other": {"cve": {"id": "CVE-2021-32607", "sourceIdentifier": "cve@mitre.org", "published": "2021-05-12T15:15:07.710", "lastModified": "2022-11-09T03:32:47.097", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "An issue was discovered in Smartstore (aka SmartStoreNET) through 4.1.1. Views/PrivateMessages/View.cshtml does not call HtmlUtils.SanitizeHtml on a private message."}, {"lang": "es", "value": "Se detect\u00f3 un problema en Smartstore (tambi\u00e9n se conoce como SmartStoreNET) versiones hasta 4.1.1.&#xa0;En el archivo Views/PrivateMessages/View.cshtml no llama a la funci\u00f3n HtmlUtils.SanitizeHtml en un mensaje privado"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:smartstore:smartstore:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.1.1", "matchCriteriaId": "AC3913BE-40B9-4F22-B649-585745D07E47"}]}]}], "references": [{"url": "https://blog.sonarsource.com/smartstorenet-malicious-message-leading-to-e-commerce-takeover/", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/smartstore/SmartStoreNET/commit/5b4e60ae7124df0898975cb8f994f9f23db1fae3", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/smartstore/SmartStoreNET/commit/5b4e60ae7124df0898975cb8f994f9f23db1fae3"}}