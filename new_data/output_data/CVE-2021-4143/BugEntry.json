{"buggy_code": ["#!/bin/bash -ex\n\nTARGET=`basename $(pwd)`\n\n\nPACKAGE=$(echo $TARGET | cut -d'_' -f1)\nVERSION=$(echo $TARGET | cut -d'_' -f2)\nDISTRO=$(echo $TARGET | cut -d'_' -f3)\nTAG=$(echo $TARGET | cut -d'_' -f4)\n\n\n#\n# Clean up directories\nrm -rf staging\n\n#\n# package\n\nset +e\nbin/installDeps.sh\nset -e\n\ngit clone https://github.com/pedrobmarin/ep_pad_ttl.git\nnpm pack ./ep_pad_ttl\nnpm install ./ep_pad_ttl-*.tgz\n\ngit clone https://github.com/alangecker/bbb-etherpad-plugin.git\nnpm pack ./bbb-etherpad-plugin\nnpm install ./ep_bigbluebutton_patches-*.tgz\n\ngit clone https://github.com/mconf/ep_redis_publisher.git\nnpm pack ./ep_redis_publisher\nnpm install ./ep_redis_publisher-*.tgz\n\n# npm install ep_cursortrace\n# using mconf's fork due to https://github.com/ether/ep_cursortrace/pull/25 not being accepted upstream\nnpm install git+https://github.com/mconf/ep_cursortrace.git\nnpm install ep_disable_chat\n\n# For some reason installing from github using npm 7.5.2 gives\n# fatal: could not create leading directories of '/root/.npm/_cacache/tmp/git-clone-76b94572': Permission denied\n#\n# npm install git+https://git@github.com/alangecker/bbb-etherpad-plugin.git\n# npm install git+https://git@github.com/mconf/ep_redis_publisher.git\n\nmkdir -p staging/usr/share/etherpad-lite\n\ncp -r CHANGELOG.md CONTRIBUTING.md LICENSE README.md bin doc src tests var node_modules staging/usr/share/etherpad-lite\n\ncp settings.json staging/usr/share/etherpad-lite\ngit clone https://github.com/alangecker/bbb-etherpad-skin.git staging/usr/share/etherpad-lite/src/static/skins/bigbluebutton\n\nmkdir -p staging/usr/lib/systemd/system\ncp etherpad.service staging/usr/lib/systemd/system\n\nmkdir -p staging/etc/bigbluebutton/nginx\ncp notes.nginx staging/etc/bigbluebutton/nginx\n\nrm -rf staging/usr/share/etherpad-lite/src/static/skins/bigbluebutton/.git\n\n##\n\n. ./opts-$DISTRO.sh\n\n#\n# Build RPM package\nfpm -s dir -C ./staging -n $PACKAGE \\\n    --version $VERSION --epoch $EPOCH \\\n    --before-install before-install.sh \\\n    --after-install after-install.sh \\\n    --before-remove before-remove.sh \\\n    --after-remove after-remove.sh \\\n    --description \"The EtherPad Lite components for BigBlueButton\" \\\n    $DIRECTORIES \\\n    $OPTS\n\n"], "fixing_code": ["#!/bin/bash -ex\n\nTARGET=`basename $(pwd)`\n\n\nPACKAGE=$(echo $TARGET | cut -d'_' -f1)\nVERSION=$(echo $TARGET | cut -d'_' -f2)\nDISTRO=$(echo $TARGET | cut -d'_' -f3)\nTAG=$(echo $TARGET | cut -d'_' -f4)\n\n\n#\n# Clean up directories\nrm -rf staging\n\n#\n# package\n\nset +e\nbin/installDeps.sh\nset -e\n\ngit clone https://github.com/pedrobmarin/ep_pad_ttl.git\nnpm pack ./ep_pad_ttl\nnpm install ./ep_pad_ttl-*.tgz\n\ngit clone https://github.com/alangecker/bbb-etherpad-plugin.git\nnpm pack ./bbb-etherpad-plugin\nnpm install ./ep_bigbluebutton_patches-*.tgz\n\ngit clone https://github.com/mconf/ep_redis_publisher.git\nnpm pack ./ep_redis_publisher\nnpm install ./ep_redis_publisher-*.tgz\n\nnpm install ep_cursortrace\nnpm install ep_disable_chat\n\n# For some reason installing from github using npm 7.5.2 gives\n# fatal: could not create leading directories of '/root/.npm/_cacache/tmp/git-clone-76b94572': Permission denied\n#\n# npm install git+https://git@github.com/alangecker/bbb-etherpad-plugin.git\n# npm install git+https://git@github.com/mconf/ep_redis_publisher.git\n\nmkdir -p staging/usr/share/etherpad-lite\n\ncp -r CHANGELOG.md CONTRIBUTING.md LICENSE README.md bin doc src tests var node_modules staging/usr/share/etherpad-lite\n\ncp settings.json staging/usr/share/etherpad-lite\ngit clone https://github.com/alangecker/bbb-etherpad-skin.git staging/usr/share/etherpad-lite/src/static/skins/bigbluebutton\n\nmkdir -p staging/usr/lib/systemd/system\ncp etherpad.service staging/usr/lib/systemd/system\n\nmkdir -p staging/etc/bigbluebutton/nginx\ncp notes.nginx staging/etc/bigbluebutton/nginx\n\nrm -rf staging/usr/share/etherpad-lite/src/static/skins/bigbluebutton/.git\n\n##\n\n. ./opts-$DISTRO.sh\n\n#\n# Build RPM package\nfpm -s dir -C ./staging -n $PACKAGE \\\n    --version $VERSION --epoch $EPOCH \\\n    --before-install before-install.sh \\\n    --after-install after-install.sh \\\n    --before-remove before-remove.sh \\\n    --after-remove after-remove.sh \\\n    --description \"The EtherPad Lite components for BigBlueButton\" \\\n    $DIRECTORIES \\\n    $OPTS\n\n"], "filenames": ["build/packages-template/bbb-etherpad/build.sh"], "buggy_code_start_loc": [35], "buggy_code_end_loc": [38], "fixing_code_start_loc": [35], "fixing_code_end_loc": [36], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Generic in GitHub repository bigbluebutton/bigbluebutton prior to 2.4.0.", "other": {"cve": {"id": "CVE-2021-4143", "sourceIdentifier": "security@huntr.dev", "published": "2022-01-19T23:15:08.113", "lastModified": "2022-01-25T14:37:42.263", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Generic in GitHub repository bigbluebutton/bigbluebutton prior to 2.4.0."}, {"lang": "es", "value": "Una vulnerabilidad de tipo Cross-site Scripting (XSS) - Gen\u00e9rico en el repositorio de GitHub bigbluebutton/bigbluebutton versiones anteriores a 2.4.0"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:bigbluebutton:bigbluebutton:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.4.0", "matchCriteriaId": "CDC57B52-53A4-4068-ADA9-092D1D43CE30"}]}]}], "references": [{"url": "https://github.com/bigbluebutton/bigbluebutton/commit/62040bdcb3c2f993ba72ab89f4db2015e18d1706", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/e67603e6-8497-4ab6-b93a-02c26407d443", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/bigbluebutton/bigbluebutton/commit/62040bdcb3c2f993ba72ab89f4db2015e18d1706"}}