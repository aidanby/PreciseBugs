{"buggy_code": ["## 8.12.7 (Unreleased)\n\n### Bugfixes\n\n - Fix refreshing LCD Display Function line options when changing number of lines\n - Fix installation of Function Action dependencies\n - Fix error when unauthenticated users attempting to land on the home page\n - Fix Gauge Widget dependencies ([#1100](https://github.com/kizniche/mycodo/issues/1100))\n - Fix installation of pigpiod\n\n### Features\n\n - Add ability to install on most Debian-based systems\n - Add ability for Actions to work on Function Controllers\n - Add LCD Backlight On/Off Actions to LCD Functions ([#1089](https://github.com/kizniche/mycodo/issues/1089))\n - Add Input: SHT2x (using alternate sht20 library with more accurate measurements and settable temperature resolution)\n - Add Input: SHTC3\n\n### Miscellaneous\n\n - Update python packages\n\n\n## 8.12.6 (2021-09-03)\n\n### Bugfixes\n\n - Fix accessing dependency page ([#1082](https://github.com/kizniche/mycodo/issues/1082))\n - Fix loading Input page if Math controllers are present ([#1083](https://github.com/kizniche/mycodo/issues/1083))\n - Fix MQTT JSON Input dependency version ([#1085](https://github.com/kizniche/mycodo/issues/1085))\n\n### Features\n\n - Add Inputs: MLX90393, DPS310\n\n\n## 8.12.5 (2021-09-01)\n\n### Bugfixes\n\n - Fix aggregate dependency page ([#1082](https://github.com/kizniche/mycodo/issues/1082))\n\n\n## 8.12.5 (2021-09-01)\n\n### Bugfixes\n\n - Fix loading of dependency install page\n - Prevent loading of Highstock JS more than once\n\n\n## 8.12.4 (2021-08-31)\n\n### Bugfixes\n\n - Fix Input temperature compensation\n\n### Features\n\n - Add ability to set Dependency Message to be displayed on dependency install page\n\n\n## 8.12.3 (2021-08-31)\n\n### Bugfixes\n\n - Fix redrawing Graph/Gauge Widgets on resize\n - Fix Gauge Widget dark theme ([#1080](https://github.com/kizniche/mycodo/issues/1080))\n - Really fix missing channels for Atlas EC sensor\n\n\n## 8.12.2 (2021-08-30)\n\n### Bugfixes\n\n - Fix missing channels for Atlas EC sensor\n\n\n## 8.12.1 (2021-08-30)\n\n### Bugfixes\n\n - Fix display of Graph and Gauge Widgets on dashboard ([#1078](https://github.com/kizniche/mycodo/issues/1078))\n\n\n## 8.12.0 (2021-08-29)\n\nThis release changes the way settings are saved, which requires a change to any custom Inputs/Outputs/Functions you have in use. If your custom module includes the seldom-used execute_at_modification() function (such as Mycodo/mycodo/inputs/python_code.py), you will need to change the parameters as well as the return variables.\n\nBefore:\n\n```python\ndef execute_at_modification(\n        mod_entry,\n        request_form,\n        custom_options_dict_presave,\n        custom_options_channels_dict_presave,\n        custom_options_dict_postsave,\n        custom_options_channels_dict_postsave):\n    allow_saving = True  # Allows saving of options to occur\n    return (allow_saving,\n            mod_entry,\n            custom_options_dict_postsave,\n            custom_options_channels_dict_postsave)\n```\n\nAfter:\n\n```python\ndef execute_at_modification(\n        messages,\n        mod_entry,\n        request_form,\n        custom_options_dict_presave,\n        custom_options_channels_dict_presave,\n        custom_options_dict_postsave,\n        custom_options_channels_dict_postsave):\n     # messages[\"page_refresh\"] = True  # Setting to True will cause the options on the user's page to refresh\n     # messages[\"error\"].append(\"Some error\")  # Uncomment this line to prevent options saving\n     # messages[\"warning\"].append(\"This will be a warning message\")\n     # messages[\"info\"].append(\"This will be an info message\")\n     if not messages[\"error\"]:\n        messages[\"success\"].append(\"Successfully completed execute_at_modification()\")\n     return (messages,\n             mod_entry,\n             custom_options_dict_postsave,\n             custom_options_channels_dict_postsave)\n```\n\nAdditionally, if you are currently using the MQTT JSON Input and your topics contain any special characters, you will need to enclose the topic in quotes (e.g. sensor-1 to \"sensor-1\").\n\n### Bugfixes\n\n - Fix taking photos with camera library \"raspistill\" when AWB set to off\n - Fix issue querying graph data\n - Fix flag/tag newlines on asynchronous graphs\n - Fix single quotes in translations causing error ([#1019](https://github.com/kizniche/mycodo/issues/1019))\n - Fix CCS811 Input dependency install issue ([#1023](https://github.com/kizniche/mycodo/issues/1023))\n - Fix sense-hat dependency issue\n - Fix saving Output checkboxes ([#1029](https://github.com/kizniche/mycodo/issues/1029))\n - Fix PiOLED Functions ([#1030](https://github.com/kizniche/mycodo/issues/1030))\n - Fix PID controller properly reporting if Held/Paused\n - Fix cmd_output() killing daemon upon command timeout ([#1047](https://github.com/kizniche/mycodo/issues/1047))\n - Fix missing check for Widget dependencies during upgrade/restore\n - Fix output_sec_currently_on()\n - Fix Widgets being able to be moved/resized when dashboard locked\n - Fix Indicator Widget unit not using correct font size\n - Fix display of tags on more than one Graph Widget\n - Fix first channel of L298N DC Motor Controller Output not working\n - Fix setting Graph Widget custom colors when tag selected\n - Fix Graph Widget custom colors when more than one Input selected\n - Fix note array memory leak on Graph Widgets\n - Fix FTDI device detection on Output page\n - Fix sending commands to Atlas Scientific devices via FTDI\n - Fix Atlas Scientific Peristaltic Pump Output calibration\n - Fix temperature compensation unit conversion for Atlas ORP, EC, and pH sensors ([#1064](https://github.com/kizniche/mycodo/issues/1064))\n - Fix Camera Widget displaying time-lapse images ([#1072](https://github.com/kizniche/mycodo/issues/1072))\n - Fix Activate/Deactivate Actions not working for Functions\n\n### Features\n\n - Add ability to install Javascript/CSS dependencies\n - Add ability to submit forms without refreshing the page ([#1040](https://github.com/kizniche/mycodo/issues/1040))\n - Add ability to install dependencies without changing the page\n - Add drag and drop sorting of Inputs/Outputs/Functions\n - Add modal dialog for Input/Output/Function configuration\n - Add option for a numerical keypad login\n - Add options for camera library raspistill: AWB Gain Blue, AWB Gain Red\n - Add Input: ADS1256 with Analog pH/EC sensors\n - Add Input: SI1145 Light/Proximity sensor\n - Add Output: MCP23017 16-Channel I/O Expander (On/Off)\n - Add return status to Conditional Controllers\n - Add 2- and 4-line variants of SSD1306 Display Functions and extra Options ([#1030](https://github.com/kizniche/mycodo/issues/1030))\n - Add calibration to the Atlas Scientific EC Input Peristaltic Pump Output\n - Add Spacers for Input and Output lists\n - Add PDF Manual\n - Add ability to set the Indicator Widget's unit font size\n - Add temperature compensation to Atlas Dissolved Oxygen sensor\n - Add TDS, Salinity, and Specific Gravity measurements for Atlas Scientific EC sensor ([#1065](https://github.com/kizniche/mycodo/issues/1065))\n - Add ability to define new Flask endpoints in Widget modules\n\n### Miscellaneous\n\n - Replace TravisCI (no longer free) with [Github Actions](https://github.com/kizniche/Mycodo/actions/workflows/main.yml) to perform unit tests\n - Update KP303 library ([#1028](https://github.com/kizniche/mycodo/issues/1028))\n - Add Try/Except for checking Output Triggers ([#1037](https://github.com/kizniche/mycodo/issues/1037))\n - Speed up loading of Camera page\n - Update Gridstack to the latest version\n - Ensure Atlas DO sensor only returns DO ([#1052](https://github.com/kizniche/mycodo/issues/1052))\n - Remove Highcharts/Highstock Javascript from package to be compliant with licensing\n - Remove calibration page (all functionality has been moved to modules)\n - Place Output columns at back of Graph Widget charts\n - Add Measurements/Units: Specific Gravity, Salinity, Total Dissolved Solids, Parts per Thousand\n - Add conversions for Parts per Thousand\n - Specify virtualenv install version in requirements.txt ([#1067](https://github.com/kizniche/mycodo/issues/1067))\n - Enable server-side Flask session\n\n\n## 8.11.0 (2021-06-05) \n\n### Bugfixes\n\n - Fix upgrading database to version 61a0d0568d24\n - Fix Generic Pump Output timestamps\n - Fix inability to add Camera Widget for some cameras\n - Fix error referencing key of Input dict that doesn't exist\n - Fix unnecessary reference to measurement dict causing error ([#1001](https://github.com/kizniche/mycodo/issues/1001), [#1005](https://github.com/kizniche/mycodo/issues/1005))\n - Add missing dependency for HC-SR04 Input ([#1003](https://github.com/kizniche/mycodo/issues/1003))\n - Fix 'id' KeyError when saving certain Inputs ([#1004](https://github.com/kizniche/mycodo/issues/1004))\n - Fix I2C PiOLED Display Functions\n - Fix clearing total volume of Hall Flow Input ([#994](https://github.com/kizniche/mycodo/issues/994))\n - Fix SSD1306 OLED Display Function initialization\n - Fix PID Min/Max options not being respected ([#998](https://github.com/kizniche/mycodo/issues/998))\n - Fix error when PWM Output duty cycle is 0\n - Change pin default when creating an Output from 0 to None\n - Don't run Output shutdown function if not set up\n - Fix Controller custom_option messages not being visible\n - Fix output state checking not handling errors ([#990](https://github.com/kizniche/mycodo/issues/990))\n - Fix BME680 Input dependency\n - Fix GrovePi DHT Input\n - Fix Method dependencies not being installed\n - Prevent non-streamable camera types from being selected to stream in Camera Widget ([#991](https://github.com/kizniche/mycodo/issues/991))\n\n### Features\n\n - Add ability to set decimal places for Angular and Solid Gauge Widgets\n - Add ability to lock Dashboards (remove ability to edit widget options) ([#996](https://github.com/kizniche/mycodo/issues/996))\n - Add ability to display the status of Functions and PID Controllers in the UI\n - Add Widget: Function Status\n - Add Conditional Controller option: Timeout (seconds)\n - Add Function Actions: Camera Timelapse Pause/Resume\n - Add Temperature Compensation for Atlas Scientific pH Input during calibration\n - Add Output channel names to Graph Widget multi-select and legend\n - Add Function: Backup to Remote Host (rsync)\n - Add Input: Anyleaf Electrical Conductivity\n - Add ability to calibrate Atlas Scientific ORP and DO sensors\n - Add ability to change I2C address of Atlas Scientific devices\n - Add Input: CCS811 (without temperature) ([#992](https://github.com/kizniche/mycodo/issues/992))\n - Add Input: MQTT Subscribe (JSON payload)\n - Add Output: Grove I2C Motor Driver (TB6612FNG, Board v1.0)\n - Add Output: Grove I2C Motor Driver (Board v1.3)\n - Make Enable Pin optional for L298N Output\n\n\n## 8.10.1 (2021-04-27)\n\n### Bugfixes\n\n - Fix warning preventing saving of Python code\n - Fix Sense Hat Input dependency\n\n### Features\n\n - Add Input: Atlas Scientific humidity sensor\n - Add Camera: raspistill\n - Make Add Output dropdown searchable\n\n### Miscellaneous\n\n - Add \"Both\" direction option for On/Off and PWM Bang-Bang Outputs\n\n\n## 8.10.0 (2021-04-24)\n\nThis release contains changes that requires modification to any Custom Functions you may have in use. In order for the new features to work for Custom Functions, it required the use of an abstract base function class (similarly to Inputs and Outputs). As a result, any Custom Functions that previously were formatted as such:\n\n```python\nfrom mycodo.controllers.base_controller import AbstractController\n\nclass CustomModule(AbstractController, threading.Thread):\n    \"\"\"\n    Class to operate custom controller\n    \"\"\"\n    def __init__(self, ready, unique_id, testing=False):\n        threading.Thread.__init__(self)\n        super(CustomModule, self).__init__(ready, unique_id=unique_id, name=__name__)\n\n        self.unique_id = unique_id\n        self.log_level_debug = None\n\n        # Set custom options\n        custom_function = db_retrieve_table_daemon(\n            CustomController, unique_id=unique_id)\n        self.setup_custom_options(\n            FUNCTION_INFORMATION['custom_options'], custom_function)\n```\n\nwill need to be changed to the format:\n\n```python\nfrom mycodo.functions.base_function import AbstractFunction\n\nclass CustomModule(AbstractFunction):\n    \"\"\"\n    Class to operate custom controller\n    \"\"\"\n    def __init__(self, function, testing=False):\n        super(CustomModule, self).__init__(function, testing=testing, name=__name__)\n\n        # Note: The following 2 lines are no longer needed to be defined here. Delete them.\n        # self.unique_id = function.unique_id  \n        # self.log_level_debug = None\n\n        # Set custom options\n        custom_function = db_retrieve_table_daemon(\n            CustomController, unique_id=self.unique_id)  # Note: \"self.\" is added here\n        self.setup_custom_options(\n            FUNCTION_INFORMATION['custom_options'], custom_function)\n\n        # These two lines are new and are required to execute initialize_variables()\n        if not testing:\n            self.initialize_variables()\n```\n\nYou also no longer need to define the following (i.e. you can remove these lines):\n\n```python\ncontroller = db_retrieve_table_daemon(\n    CustomController, unique_id=self.unique_id)\nself.log_level_debug = controller.log_level_debug\nself.set_log_level_debug(self.log_level_debug)\n```\n\nAdditionally, if you have pre_stop() in your Function Class, it will need to be renamed to stop_function().\n\nThere are two ways to perform these changes.\n\nMethod A:\n\n1. Deactivate all custom functions.\n2. Delete all custom functions on the Setup -> Function page.\n3. Delete all custom functions on the Configure -> Custom Functions page.\n4. Perform the Mycodo upgrade.\n5. Make the necessary edits to all your Custom Functions.\n6. Import all your updated Custom Functions on the Configure -> Custom Functions page.\n7. Add and configure your Custom Functions on the Setup -> Function page.\n\nMethod B:\n\n1. Either SSH into your Raspberry Pi or use a keyboard/mouse/monitor and edit the Custom Functions in the ~/Mycodo/mycodo/function/custom_functions directory.\n2. Perform the Mycodo upgrade.\n\nMethod A is more involved, but does not require accessing the Pi from outside the web UI. Method B has fewer steps and doesn't require deleting and reconfiguring new Functions, but requires being able to SSH in to your Raspberry Pi or connecting a keyboard/mouse/monitor to be able to edit the files in-place.\n\nAs always, a backup of the current system files and settings is performed during an upgrade, allowing you to restore your system to a previous release state if needed.\n\n### Bugfixes\n\n - Fix camera paths not saving ([#955](https://github.com/kizniche/mycodo/issues/955))\n - Fix returning pylint3 report after saving Python Code\n - Fix detection of multiple cameras by opencv\n - Fix SCD30 (CircuitPython) Input ([#963](https://github.com/kizniche/mycodo/issues/963))\n - Fix importing Mycodo Settings ZIP if custom modules were exported ([#967](https://github.com/kizniche/mycodo/issues/967))\n - Fix inability to install picamera library on some Pi 4s ([#967](https://github.com/kizniche/mycodo/issues/967))\n - Fix VPD Function saving and calculating pressure conversion ([#978](https://github.com/kizniche/mycodo/issues/978))\n - Fix pressure conversion equations ([#978](https://github.com/kizniche/mycodo/issues/978))\n - Fix issues with Function channels/measurements\n - Fix Mijia LYWSD03MMC Input using a nonexistent pybluez version\n - Fix Hall Flow Input\n - Remove Flask-Session to resolve bug preventing frontend loading ([#971](https://github.com/kizniche/mycodo/issues/971))\n\n### Features\n\n - Add Input: SHT41x\n - Add Input: Adafruit I2C capacitive soil sensor\n - Add Input: CircuitPython variants of the BME280 and SHT31-D Inputs\n - Add Input: KP303 Smart WiFi Power Strip ([#980](https://github.com/kizniche/mycodo/issues/980))\n - Add Input: Generic Analog pH/EC using ADS1115 ADC\n - Add Input: Tasmota Outlet Energy Monitor\n - Add Output: DS3502 Digital Potentiometer\n - Add Output: ULN2003 Unipolar Stepper Motor Driver\n - Add Function: SSD1309 Display\n - Add Function: Bang-Bang PWM\n - Add Function Action: MQTT Publish\n - Add Function Action: webhook to emit HTTP requests ([discussion](https://kylegabriel.com/forum/general-discussion/webhook-action/))\n - Partial conversion of Display/LCD controllers to Display Functions\n - Add external temperature compensation for Anyleaf pH Input\n - Add ability to set camera stream frames per second\n - Add missing stream resolution option to opencv cameras\n - Add ability for Atlas Scientific Peristaltic Pump Outputs to run in reverse\n - Add new ADC measurement rescaling method: Equation\n - Add Custom Actions to Functions\n - Add \"wait_for_return\" option to Custom Actions\n - Convert all LCD/Display controllers to Functions\n - Add ability to not have to set time-lapse end (defaults to 10 years) ([#987](https://github.com/kizniche/mycodo/issues/987))\n\n### Miscellaneous\n\n - Add Measurements: Apparent Power, Reactive Power, Power Factor\n - Add Units: kilowatt-hour, Watt, Volt-Amps, Volt-Amps-Reactive\n - Specify package versions for pypi dependencies\n - Update python libraries\n - Add unit testing for Custom Functions\n - Add ability to change theme from Config dropdown menu\n\n\n## 8.9.2 (2021-03-16)\n\nThis bugfix release changes how sessions are handled and as a result will log all users out following the upgrade.\n\n### Bugfixes\n\n - Fix Function measurements not appearing in some dropdowns\n - Fix displaying saved Custom Option values when Inputs/Outputs have Custom Actions ([#952](https://github.com/kizniche/mycodo/issues/952))\n - Fix silent failures when cookies are too large ([#950](https://github.com/kizniche/mycodo/issues/950))\n - Fix use of select_measurement_channel custom option in controllers ([#953](https://github.com/kizniche/mycodo/issues/953))\n - Fix error-handling of erroneous measurements/units ([#949](https://github.com/kizniche/mycodo/issues/949))\n\n\n## 8.9.1 (2021-03-13)\n\n### Bugfixes\n\n - Fix API deactivating controller in database ([#944](https://github.com/kizniche/mycodo/issues/944))\n - Fix invalid conversion ([#947](https://github.com/kizniche/mycodo/issues/947))\n - Fix inability to save MQTT Input ([#946](https://github.com/kizniche/mycodo/issues/946))\n - Fix Camera Widget ([#948](https://github.com/kizniche/mycodo/issues/948))\n\n\n## 8.9.0 (2021-03-08)\n\nThis release contains bug fixes and several new types of Inputs and Outputs. These include stepper motors, digital-to-analog converters, a multi-channel PWM output, as well as an input to acquire current and future weather conditions.\n\nThis release also deprecates Math controllers. Current Math controllers will continue to function, but new Math controllers cannot be created. Instead, all Math controller functionality has been ported to Functions (Setup -> Function page), in order to reduce complexity and improve customizability. Much like Inputs and Outputs, Functions are single-file modules that can be created by users and imported. Take a look at the Mycodo/mycodo/functions directory for the built-in Function modules.\n\nThe new weather input acquires current and future weather conditions from openweathermap.org with either a city (200,000 to choose from) or latitude/longitude for a location and a time frame from the present up to 7 days in the future, with a resolution of days or hours. An API key to use the service is free and the measurements returned include temperature (including minimum and maximum if forecasting days in the future), humidity, dew point, pressure, wind speed, and wind direction. This can be useful for incorporating current or future weather conditions into your conditional controllers or other functions or calculations. For instance, you may prevent Mycodo from watering your outdoor plants if the forecasted temperature in the next 12 to 24 hours is below freezing. You may also want to be alerted by email if the forecasted weather conditions are extreme. Not everyone wants to set up a weather station, but might still want to have local outdoor measurements, so this input was made to bridge that gap.\n\n### Bugfixes\n\n - Fix broken Output API get/post calls\n - Fix selecting output channels in custom functions\n - Fix Autotune PID Function ([#876](https://github.com/kizniche/mycodo/issues/876))\n - Fix issue with LockFile not locking\n - Fix Output State and Output Duration On Conditional Conditions ([#879](https://github.com/kizniche/mycodo/issues/879))\n - Fix not showing camera stream buttons for cameras libraries that don't have stream support ([#899](https://github.com/kizniche/mycodo/issues/899))\n - Fix Clock Pin option showing twice for UART Inputs\n - Fix MCP3008 Input error ([#902](https://github.com/kizniche/mycodo/issues/902))\n - Fix Input Measurement option Invert Scale not displaying properly ([#902](https://github.com/kizniche/mycodo/issues/902))\n - Fix MQTT output being able to set 0 to disable option\n - Fix compounding of Function Action return messages in Conditionals\n - Fix ADS1015 and ADS1115 inputs only measuring channel 0 ([#911](https://github.com/kizniche/mycodo/issues/911))\n - Fix install of pyusb dependency of Adafruit_Extended_Bus ([#863](https://github.com/kizniche/mycodo/issues/863))\n - Fix Message and New Line options in Custom Options\n - Fix Conditional sample_rate not being set from Config\n - Fix Saving Angular and Solid Gauge Widget stop values ([#916](https://github.com/kizniche/mycodo/issues/916))\n - Fix uncaught exception if trying to acquire image when opencv can't detect a camera ([#917](https://github.com/kizniche/mycodo/issues/917))\n - Fix displaying input/output pypi.org dependencies with \"==\"\n - Fix pressure measurement in BME680 and BME280 Inputs ([#923](https://github.com/kizniche/mycodo/issues/923))\n - Fix controllers disappearing following reorder ([#925](https://github.com/kizniche/mycodo/issues/925))\n - Fix Inputs that use w1thermsensor ([#926](https://github.com/kizniche/mycodo/issues/926))\n - Fix issue generating documentation for similar Inputs/Outputs/Widgets\n - Fix execution of Input stop_input()\n - Fix Input Pre-Outputs not turning on\n - Fix Output not activating for Camera\n - Fix PWM trigger and Duration Method ([#937](https://github.com/kizniche/mycodo/issues/937))\n - Fix stopping Trigger Controllers ([#940](https://github.com/kizniche/mycodo/issues/940))\n - Fix Tags not appearing in Graph Widgets\n - Fix variable measurement Inputs saving correctly\n - Fix detection of custom_option save type (CSV or JSON) for proper parsing\n - Fix saving of unchecked checkboxes when using forms\n\n### Features\n\n - Add Digital-to-Analog Converter output support (and add MCP4728) ([#893](https://github.com/kizniche/mycodo/issues/893))\n - Add Stepper Motor Controller output support (and add DRV8825) ([#857](https://github.com/kizniche/mycodo/issues/857))\n - Add Output: GrovePi multi-channel relay I2C board\n - Add Output: PCA9685 16-channel PWM servo/LED controller\n - Add Input: MAX31865 (CircuitPython) ([#900](https://github.com/kizniche/mycodo/issues/900))\n - Add Input: Generic Hall Effect Flow sensor\n - Add Input: INA219 current sensor\n - Add Input: Grove Pi DHT11/22 sensor\n - Add Input: HC-SR04 Ultrasonic Distance sensor\n - Add Input: SCD30 CO2/Humidity/Temperature sensor\n - Add Input: Current Weather from OpenWeatherMap.org (Free API Key, Latitude/Longitude, 200,000 cities, Humidity/Temperature/Pressure/Dewpoint/Wind Speed/Wind Direction)\n - Add Input: Forecast Hourly/Daily Weather from OpenWeatherMap.org (Free API Key, , Humidity/Temperature/Pressure/Dewpoint)\n - Add Input: Raspberry Pi Sense HAT (humidity/temperature/pressure/compass/magnetism/acceleration/gyroscope)\n - Add Input: Xiaomi Mijia LYWSD03MMC\n - Add Input: Atlas Scientific CO2 sensor\n - Add Input: AHTx0 Temperature/Humidity sensor\n - Add Input: BME680 (Circuitpython)\n - Add measurements to Custom Controllers\n - Add Measurement and Unit: Speed, Meters/Second\n - Add Measurement and Unit: Direction, Bearing\n - Add Conversions: m/s <-> mph <-> knots, hour <-> minutes and seconds\n - Add LCD: Grove RGB LCD\n - Add Function: Bang-bang/hysteretic\n - Add Function Action: Output Value\n - Add Function Action: Set LCD Backlight Color\n - Add configurable link for navbar brand link\n - Add User option to Shell Command Function Action\n - Add Message and New Line options to Custom Options of Outputs\n - Add set_custom_option/get_custom_option to Conditionals ([#901](https://github.com/kizniche/mycodo/issues/901))\n - Add ability to login with username/password using MQTT Input and Outputs\n - Add ability to use Custom Channel Options with Inputs (first used in MQTT Input)\n - Add Custom Functions/Inputs/Outputs/Widgets to Settings Export/Import\n - Add user_scripts directory for user code that's preserved during upgrade/export/import ([#930](https://github.com/kizniche/mycodo/issues/930))\n - Add pin mode option (float, pull-up, pull-down) for Edge and State Inputs\n - Add Method: Cascaded Method, allows combining (multiply) any number of existing methods\n - Add Functions and to API\n - Add missing Input Channels to Input API calls\n\n### Miscellaneous\n\n - Remove lirc\n - Change widget title styles\n - Fix GCC warnings ([#906](https://github.com/kizniche/mycodo/issues/906))\n - Remove default user \"pi\" with \"mycodo\" (for compatibility with non-Raspberry Pi operating systems)\n - Update pyusb to 1.1.1\n - Refactor Edge detection Input\n - Refactor method implementation from single large method into multiple small classes\n - Changed duration method start- and end-time handling\n - Port Math controllers to Functions: Equation (Single/Multi), Difference, Statistics (Single/Multi), Average (Single/Multi), Sum (Single/Multi), Wet-Bulb Humidity, Redundancy, Vapor Pressure Deficit, Verification\n - Deprecate Math controllers\n - Remove Math controllers from and add Functions to Live page\n\n\n## 8.8.8 (2020-10-30)\n\n### Bugfixes\n\n - Fix PiOLED (CircuitPython) ([#842](https://github.com/kizniche/mycodo/issues/842))\n\n### Miscellaneous\n\n - Update Polish translations\n\n\n## 8.8.7 (2020-10-27)\n\n### Bugfixes\n\n - Fix missing default values when adding new controllers ([#868](https://github.com/kizniche/mycodo/issues/868))\n - Fix catching loss of internet connection during upgrade ([#869](https://github.com/kizniche/mycodo/issues/869))\n - Fix Function Actions Output PWM and Output PWM Ramp not working ([#865](https://github.com/kizniche/mycodo/issues/865))\n - Fix dependencies not being installed for LCDs\n - Fix saving when missing/malformed custom_options JSON present ([#866](https://github.com/kizniche/mycodo/issues/866))\n\n### Features\n\n - Add LCDs: 128x32 and 128x64 PiOLED using the Adafruit CircuitPython library ([#842](https://github.com/kizniche/mycodo/issues/842))\n\n\n## 8.8.6 (2020-10-07)\n\n### Bugfixes\n\n - Fix order of Atlas Scientific pH sensor calibration points ([#861](https://github.com/kizniche/mycodo/issues/861))\n\n### Features\n\n - Add Polish translation\n\n\n## 8.8.5 (2020-10-01)\n\n### Bugfixes\n\n - Fix Output Widgets not able to control outputs\n - Fix ADS1256 ([#854](https://github.com/kizniche/mycodo/issues/854))\n - Fix PID controllers not obeying minimum off duration ([#859](https://github.com/kizniche/mycodo/issues/859))\n\n\n## 8.8.4 (2020-09-28)\n\n### Bugfixes\n\n - Increase nginx proxy buffer to accommodate large headers ([#849](https://github.com/kizniche/mycodo/issues/849))\n - Fix URL generation for cameras ([#850](https://github.com/kizniche/mycodo/issues/850))\n - Fix display of Output data on Asynchronous Graphs ([#847](https://github.com/kizniche/mycodo/issues/847))\n\n\n## 8.8.3 (2020-09-15)\n\n### Bugfixes\n\n - Fix inability to create Angular Gauge Widget with more than 4 stops ([#844](https://github.com/kizniche/mycodo/issues/844))\n - Fix issue with Python Code Input ([#846](https://github.com/kizniche/mycodo/issues/846))\n - Fix issue with install ([#845](https://github.com/kizniche/mycodo/issues/845))\n\n\n## 8.8.2 (2020-09-13)\n\n### Bugfixes\n\n - Fix PID Controller not operating ([#843](https://github.com/kizniche/mycodo/issues/843))\n - Fix inability to switch any output except channel 0 from web interface ([#840](https://github.com/kizniche/mycodo/issues/840))\n - Minor fixes for PCF8574 Output\n - Fix Atlas Pump recording two pump durations\n\n### Features\n\n - Add ability to select method in Input/Output/Function controller custom options\n\n\n## 8.8.1 (2020-09-09)\n\n### Bugfixes\n\n - Fix partially broken upgrade to new output system\n - Fix GPIO output startup states\n\n\n## 8.8.0 (2020-09-08)\n\nThis release changes the Output framework to add the ability for a single Output to control multiple channels. This was originally based on the PCF8574 8-bit I/O Expander, which allows 8 additional IO pins to be controlled via the I2C bus, but applies to any other output device with more than one channel. As a result of this change, you will need to update any Custom Outputs to follow the new format (see /mycodo/outputs directory).\n\n### Bugfixes\n\n - Fix inability to save Python Code Input settings ([#827](https://github.com/kizniche/mycodo/issues/827))\n - Fix Cameras not appearing in Camera Widget ([#828](https://github.com/kizniche/mycodo/issues/828))\n - Fix inability to save Pause PID Function Action ([#836](https://github.com/kizniche/mycodo/issues/836))\n - Fix error diaplying Measurement or Gauge Widgets with Math controllers using non-default units ([#831](https://github.com/kizniche/mycodo/issues/831))\n - Fix default values not displaying for Input/Output Custom Actions\n - Fix some apt packages being detected as installed when they are not installed\n \n### Features\n\n - Convert Input module custom_options from CSV to JSON\n - Add Anyleaf ORP and pH Inputs ([#825](https://github.com/kizniche/Mycodo/pull/825))\n\n### Miscellaneous\n\n - Remove unused Output selection in Methods\n\n\n## 8.7.2 (2020-08-23)\n\n### Bugfixes\n\n - Fix issue displaying Measurement Widgets when a Math measurement is selected ([#817](https://github.com/kizniche/mycodo/issues/817))\n - Fix inability to generate Widget HTML ([#817](https://github.com/kizniche/mycodo/issues/817), [#822](https://github.com/kizniche/mycodo/issues/822))\n\n### Features\n\n - Add ability to duplicate a dashboard and its widgets ([#812](https://github.com/kizniche/mycodo/issues/812))\n\n\n## 8.7.1 (2020-08-10)\n\n### Bugfixes\n\n - Remove copy of widget HTML files during upgrade\n\n\n## 8.7.0 (2020-08-10)\n\nThis update includes the final refactoring of the output system to accommodate output modules that can operate multiple different types of output types. For instance, a peristaltic pump can be instructed to turn on for a duration or instructed to pump a volume. As a result of the output framework being modified to accommodate this, the duty_cycle parameter was removed from ```output_on_off()``` and ```output_on()``` functions of the ```DaemonControl``` class of mycodo_client.py. As a result, if you were previously using either of these function, you will need to add the parameter ```output_type='pwm'``` and change the ```duty_cycle``` parameter to ```amount```. For example, ```output_on(output_id, duty_cycle=50)``` would need to be changed to ```output_on(output_id, output_type='pwm', amount=50)```, and ```output_on_off(output_id, 'on', duty_cycle=50)``` to ```output_on_off(output_id, 'on', output_type='pwm', amount=50)```.\n\nThis update also adds the ability to import custom Widget modules. Much like custom Inputs, Outputs, and Functions, you can now create and import your own single-file Widget module that allow new widgets to be added to a dashboard.\n\n### Bugfixes\n\n - Fix issue installing Python modules ([#804](https://github.com/kizniche/mycodo/issues/804))\n - Fix inability to save PID options when On/Off output selected ([#805](https://github.com/kizniche/mycodo/issues/805))\n - Fix graph shift issues\n - Fix PID Input/Math Setpoint Tracking unit and integer issue ([#811](https://github.com/kizniche/mycodo/issues/811))\n - Fix PID Controller debug logging ([#811](https://github.com/kizniche/mycodo/issues/811))\n - Fix bug in password reset function that would allow an attacker to discover if a user name doesn't exist\n\n### Features\n\n - Add Output: On/Off MQTT Publish\n - Add Output information links\n - Add ability to download Mycodo Backups ([#803](https://github.com/kizniche/mycodo/issues/803))\n - Add ability to import custom Widget modules\n - Add Widget Controller for background widget processes\n - Add Widget: Python Code ([#803](https://github.com/kizniche/mycodo/issues/803))\n - Add an option to the password reset function to save the reset code to a file\n\n### Miscellaneous\n\n - Deprecate duty_cycle parameter of output functions\n - Remove graph Shift X-Axis option\n - Move Autotune from PID Controller to Separate PID Autotune Controller ([#811](https://github.com/kizniche/mycodo/issues/811))\n\n\n## 8.6.4 (2020-07-25)\n\n### Bugfixes\n\n - Fix issue displaying lines 5-8 on SD1306 LCDs ([#800](https://github.com/kizniche/mycodo/issues/800))\n - Fix Atlas Scientific Pump duration unit issues ([#801](https://github.com/kizniche/mycodo/issues/801))\n\n### Features\n\n - Add Inputs: Ads1115 (Circuit Python library), ADS1015 (Circuit Python library)\n - Add Input: BMP280 (bmp280-python library, includes ability to set forced mode) ([#608](https://github.com/kizniche/mycodo/issues/608))\n\n### Miscellaneous\n\n - Deprecate Input using the Adafruit_ADS1x15 library\n\n\n## 8.6.3 (2020-07-25)\n\n### Bugfixes\n\n - Fix ADS1x15 Input\n\n\n## 8.6.2 (2020-07-25)\n\n### Bugfixes\n\n - Fix DS18S20 Input module ([#796](https://github.com/kizniche/mycodo/issues/796))\n - Fix Peristaltic Pump Outputs unable to turn on for durations ([#799](https://github.com/kizniche/mycodo/issues/799))\n\n### Features\n\n - Add a ([Building a Custom Input Module wiki page](https://github.com/kizniche/Mycodo/wiki/Building-a-Custom-Input)\n\n### Miscellaneous\n\n - Improve custom output framework\n - Consolidate locking code to utils/lockfile.py\n\n\n## 8.6.1 (2020-07-22)\n\n### Bugfixes\n\n - Fix Wireless 315/433 MHz Output module\n\n\n## 8.6.0 (2020-07-22)\n\nThis update adds a Generic Peristaltic Pump Output to compliment the Atlas Scientific Peristaltic Pump Output. Generic peristaltic pumps are less expensive but often have acceptable dispensing accuracy. Once your pump's flow rate has been measured and this rate set in the Output options, your pump can be used to dispense specific volumes of liquid just like the Atlas Scientific pumps. This release also enables pumps to dispense for durations of time in addition to specific volumes (once calibrated). So, you can now operate a PID controller or other functions/controllers that instruct a pump to dispense for a duration in seconds or a volume in milliliters.\n\nIn this update, the Atlas Scientific Peristaltic Pump Output duration units have been changed form minutes to seconds, to align with other Outputs that use the second SI unit.\n\nWARNING: As a result of how this new output operates, a potentially breaking change has been introduced. If you use any custom Output modules, you will need to add the parameter output_type=None to the output_switch() function of all of your custom Output module files. If you do not, the Mycodo daemon/backend will fail to start after upgrading to or beyond this version. It is advised to modify your custom Output modules prior to upgrading to ensure the daemon successfully starts after the upgrade. If you have not created or imported any custom Output modules, there is nothing that needs to be done.\n\n### Bugfixes\n\n - Fix measurement being stored in database after sensor error ([#795](https://github.com/kizniche/mycodo/issues/795))\n - Fix UART communication with Atlas Scientific devices ([#785](https://github.com/kizniche/mycodo/issues/785))\n - Fix FTDI communication with Atlas Scientific devices\n - Fix PID Dashboard Widget error in log when PID inactive\n - Fix install on Desktop version of Raspberry Pi OS by removing python3-cffi-backend\n - Fix inability to change I2C address of ADS1x15 Input ([#788](https://github.com/kizniche/mycodo/issues/788))\n - Fix issues with calibrating Atlas Scientific devices ([#789](https://github.com/kizniche/mycodo/issues/789))\n - Fix missing default input custom option values if not set in the database\n - Add missing TSL2561 I2C addresses\n - Fix daemon hang on use of incorrect Atlas Scientific UART device (add writeTimeout to every serial.Serial())\n - Fix uninstall of pigpiod\n - Fix missing pigpio dependency for GPIO PWM Outputs\n - Prevent LCD controllers from activating if Max Age or Decimal Places are unset ([#795](https://github.com/kizniche/mycodo/issues/795))\n\n### Features\n\n - Add Inputs: ADXL34x, ADT7410 ([#791](https://github.com/kizniche/mycodo/issues/791))\n - Add Output: Generic Peristaltic Pump\n - Add ability to turn peristaltic pumps on for durations (in addition to volumes)\n - Add Function Action: Output (Volume)\n - Improve general compatibility with Atlas Scientific devices\n - Add ability to utilize volume Outputs (pumps) with PID Controllers\n - Add pypi.org links to Input libraries in Input description information\n - Add SPI interface as an option for SD1306 LEDs ([#793](https://github.com/kizniche/mycodo/issues/793))\n\n### Miscellaneous\n\n - Change Atlas Scientific Peristaltic Pump Output duration unit from minute to second\n - Move clear total volume function for Atlas Scientific Flow Meter to Input Module\n - Add instruction for viewing the frontend web log on the web 502 error page ([#786](https://github.com/kizniche/mycodo/issues/786))\n\n\n## 8.5.8 (2020-07-07)\n\n### Bugfixes\n\n - Fix inability to install pigpio ([#783](https://github.com/kizniche/mycodo/issues/783))\n\n\n## 8.5.7 (2020-07-07)\n\n### Bugfixes\n\n - Fix inability to install internal dependencies (pigpio, bcm2835, etc.) ([#783](https://github.com/kizniche/mycodo/issues/783))\n\n\n## 8.5.6 (2020-06-30)\n\n### Bugfixes\n\n- Fix API database schema issue\n\n\n## 8.5.5 (2020-06-30)\n\n### Bugfixes\n\n - Prevent user with insufficient permissions from rearranging dashboard widgets\n - Fix installing internal dependencies\n - Fix restore of influxdb measurement data from import/Export page\n - Fix Gauge Widget Measurement options from being selected after saving\n\n### Features\n\n - Create scripts to automatically generate Input section of manual\n\n### Miscellaneous\n\n - Add URLs to Input information\n - Switch from deprecated SSLify to Talisman\n - Update Python dependencies\n\n\n## 8.5.4 (2020-06-06)\n\n### Bugfixes\n\n - Fix Atlas Scientific pump on duration calculation\n\n\n## 8.5.3 (2020-06-06)\n\n### Bugfixes\n\n - Fix upgrade not preserving custom outputs\n - Fix missing output device measurements in database ([#779](https://github.com/kizniche/mycodo/issues/779))\n\n\n## 8.5.2 (2020-06-01)\n\n### Bugfixes\n\n - Fix Atlas Scientific Pump Output timestamp parsing\n\n\n## 8.5.1 (2020-05-30)\n\n### Bugfixes\n\n - Fix translations\n - Fix dependency check during upgrade\n - Fix Atlas Scientific Pump Output\n\n\n## 8.5.0 (2020-05-30)\n\nWith this release comes the ability to write and import custom Outputs. If you want to utilize an output that Mycodo doesn't currently support, you can now create your own Output module and import it to be used within the system. See [Custom Outputs](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#custom-outputs) in the manual for more information.\n\nWARNING: There are changes with this version that may cause issues with your currently-configured outputs. Therefore, after upgrading, test if your outputs work and update their configuration if needed.\n\n### Bugfixes\n\n - Fix PID Widget preventing graph custom colors from being editable\n - Fix graph Widget custom color issues ([#760](https://github.com/kizniche/mycodo/issues/760))\n - Fix PWM Trigger Functions reacting to 0 % duty cycle being set ([#761](https://github.com/kizniche/mycodo/issues/761))\n - Fix KeyError if missing options when saving Input\n - Fix ZH03B Input: add repeat measurement option and discard erroneous measurements\n - Fix update check IndexError if there's no internet connection\n - Fix parsing API api_key from requests\n - Fix the inability of Math Controllers to use converted measurements\n - Fix Redundancy Math controller ([#768](https://github.com/kizniche/mycodo/issues/768))\n - Fix display of Custom Controller options\n - Fix hostname display on login page\n - Fix missing blank line check for LCDs with 8 lines ([#771](https://github.com/kizniche/mycodo/issues/771))\n - Fix unset user groups when executing shell commands\n - Fix guest users being able to create dashboards\n - Fix queries with updated influxdb Python library\n\n### Features\n\n - Add ability to write and import your own Custom Output Modules\n - Add Input: VL53L0X (Laser-Range Measurement) ([#769](https://github.com/kizniche/mycodo/issues/769))\n - Add Input: AS7262 Spectral Sensor (measures 450, 500, 550, 570, 600, and 650 nm wavelengths)\n - Add Input: Atlas Scientific EZO Pressure Sensor\n - Add ability to create custom Input actions\n - Add MH-Z19/MH-Z19B Input actions: zero and span point calibrations\n - Add unit conversions: PSI to kPa, PSI to cm H2O, kPa to PSI\n - Add literature links to Input options: Manufacturer, Datasheet, Product\n - Add 'tail dmesg' to System Information page\n - Add Function Actions: System Restart and System Shutdown ([#763](https://github.com/kizniche/mycodo/issues/763))\n - Add Conditional options: Log Level Debug and Message Includes Code\n - Add Force Command option for Command/Python/Wireless Outputs ([#728](https://github.com/kizniche/mycodo/issues/728))\n - Add ability to select which user executes Linux Output commands ([#719](https://github.com/kizniche/mycodo/issues/719))\n - Add Cameras: URL (urllib), URL (requests) \n - Add ability to encode videos from time-lapse image sets\n - Add send_email() to Daemon Control object\n\n### Miscellaneous\n\n - Upon controller activation, generate Input and Conditional code files if they don't exist\n - Update Werkzeug to 1.0.1 ([#742](https://github.com/kizniche/mycodo/issues/742)), Flask-RESTX to 0.2.0, alembic to 1.4.2, pyro5 to 5.8, SQLAlchemy to 1.3.15, distro to 1.5.0,\n - Refactor Python Output code \n - Update all translations (all complete)\n - Rename MH-Z19 Input to MH-Z19B (and add MH-Z19 Input)\n - Change Email Notification options to allow unauthenticated sending\n - Add conversions: m <-> cm <-> mm\n - Make PID Controller a class\n - Restyle Output page ([#732](https://github.com/kizniche/mycodo/issues/732))\n - Include error response in PWM/On-Off Command Output debug logging line\n - Update InfluxDB to 1.8.0\n\n\n## 8.4.0 (2020-03-23)\n\n### Bugfixes\n\n - Fix invalid links to Help pages\n - Prevent unstoppable Conditional Controller by adding self.running bool variable\n - Fix calculation error causing inaccuracy with ADS1x15 analog-to-digital converter Input\n - Remove PWM and Pump Outputs from Energy Usage calculations\n - Fix links to camera widget error images\n - Fix reference to input library to properly display 1-Wire device IDs ([#752](https://github.com/kizniche/mycodo/issues/752))\n - If a camera output is already on when capturing an image, dont' turn it off after capture\n - Discard first measurement of Atlas Scientific Inputs to prevent some erroneous measurements\n - Fix display of setpoint on PID widget if a band is in use ([#744](https://github.com/kizniche/mycodo/issues/744))\n - Fix Amp calculation ([#758](https://github.com/kizniche/mycodo/issues/758))\n\n### Features\n\n - Add temperature compensation option for the Atlas Scientific Electrical Conductivity and Dissolved Oxygen Inputs\n - Add Inputs: Atlas Scientific Flow Sensor, Atlas Scientific RGB Color Sensor\n - Add Function Action: Clear Total Volume of Flow Meter, Force Input Measurements\n - Add option to repeat measurements and store average for ADS1x15 analog-to-digital converter Input\n - Add PID option Always Min for PWM outputs to always use at least the min duty cycle ([#757](https://github.com/kizniche/mycodo/issues/757))\n - Add email password reset\n\n### Miscellaneous\n\n - Add prefix to device IDs when using w1thermsensor ([#752](https://github.com/kizniche/mycodo/issues/752))\n\n\n## 8.3.0 (2020-02-21)\n\n### Bugfixes\n\n - Fix determining frontend/backend virtualenv status\n - Fix error detecting GPIO state during energy usage report generation ([#745](https://github.com/kizniche/mycodo/issues/745))\n - Fix Atlas Scientific pH Input temperature calibration measurement\n - Fix Atlas Scientific EZO-PMP flow mode not taking effect immediately upon saving\n - Change deprecated w1thermsensor set_precision() to set_resolution()\n - Fix setting DS sensor resolution ([#747](https://github.com/kizniche/mycodo/issues/747))\n - Split DS18B20 Input into two files (one using w1thermsensor and another using ow-shell) ([#746](https://github.com/kizniche/mycodo/issues/746))\n - Prevent users without \"view settings\" permission from viewing email addresses\n - Fix TSL2561 input ([#750](https://github.com/kizniche/mycodo/issues/750))\n\n### Features\n\n - Add Temperature Offset option for BME680 Input ([#735](https://github.com/kizniche/mycodo/issues/735))\n - Add ability to change number of stops for Gauge Widgets ([#749](https://github.com/kizniche/mycodo/issues/749))\n\n### Miscellaneous\n\n - Fix logging level of calibration functions\n - Populate setpoint in field of PID dashboard widget ([#748](https://github.com/kizniche/mycodo/issues/748))\n\n\n## 8.2.5 (2020-02-09)\n\n### Bugfixes\n\n - Fix daemon not being able to read measurements ([#743](https://github.com/kizniche/mycodo/issues/743))\n\n\n## 8.2.4 (2020-02-08)\n\n### Bugfixes\n\n - Fix logs appearing blank after logrotate runs ([#734](https://github.com/kizniche/mycodo/issues/734))\n - Update Flask-Babel to 1.0.0 to fix broken werkzeug ([#742](https://github.com/kizniche/mycodo/issues/742))\n - Increase install wait times to prevent timeouts ([#742](https://github.com/kizniche/mycodo/issues/742))\n\n### Features\n\n - Add BME680 temperature/humidity/pressure/VOC sensor ([#735](https://github.com/kizniche/mycodo/issues/735))\n - Add measurement: resistance\n - Add unit: Ohm\n - Merge from [Flask-RESTPlus](https://github.com/noirbizarre/flask-restplus/issues/770) to [Flask-RESTX](https://github.com/python-restx/flask-restx) ([#742](https://github.com/kizniche/mycodo/issues/742))\n\n### Miscellaneous\n\n - Improve sanity-checking of Input custom_options\n - Improve sanity-checking of API endpoints ([#741](https://github.com/kizniche/mycodo/issues/741))\n - Update pip requirements\n\n\n## 8.2.3 (2020-01-27)\n\n### Bugfixes\n\n - Fix error during upgrade check if there is no internet connection\n - Fix MQTT input, prevent keepalive from being <= 0 ([#733](https://github.com/kizniche/mycodo/issues/733))\n - Fix issue restarting frontend using diagnostic database delete feature\n - Fix ability to import Inputs with measurements/units that don't exist in database ([#735](https://github.com/kizniche/mycodo/issues/735))\n - Fix ability to modify measurement/unit names that Inputs rely on\n - Fix inability to modify custom measurements\n - Fix error when deleting dashboards from the Config->Diagnostics menu ([#737](https://github.com/kizniche/mycodo/issues/737))\n - Fix dashboard gauges causing the dashboard to crash ([#736](https://github.com/kizniche/mycodo/issues/736))\n\n### Miscellaneous\n\n - Refactor upgrade check code into class to reduce the number of hits to github.com\n - Rearrange dashboard dropdown menu\n - Allow creation of measurement/unit IDs with upper-case letters ([#735](https://github.com/kizniche/mycodo/issues/735))\n\n## 8.2.2 (2020-01-06)\n\n### Bugfixes\n\n - Fix table colors ([#724](https://github.com/kizniche/mycodo/issues/724))\n - Fix error when dashboard is set to default landing page ([#727](https://github.com/kizniche/mycodo/issues/727))\n\n### Features\n\n - Add options to show/hide various widget info ([#717](https://github.com/kizniche/mycodo/issues/717))\n - Add Input: MLX90614 ([#723](https://github.com/kizniche/mycodo/pull/723))\n\n### Miscellaneous\n\n - Update Bootstrap to 4.4.1\n - Update Bootstrap themes\n\n\n## 8.2.1 (2019.12.08)\n\nThis update brings the ability to create multiple dashboards. The dashboard grid spacing has also changed, so you will need to resize your widgets.\n\nThis update also brings the ability to run Mycodo/Influxdb in Docker containers, enabling Mycodo to run outside the Raspberry Pi and Raspbian environment. For instance, I currently have Mycodo running on my 64-bit PC in Ubuntu 18.04. This is an experimental feature and is not yet recommended to be used in a production environment. See the [Docker README](https://github.com/kizniche/Mycodo/blob/master/docker/README.md) for more information.\n\n### Features\n\n - Add ability to run Mycodo in Docker containers ([#637](https://github.com/kizniche/mycodo/issues/637))\n - Add ability to create multiple dashboards ([#717](https://github.com/kizniche/mycodo/issues/717))\n - Add Dashboard Widget: Spacer ([#717](https://github.com/kizniche/mycodo/issues/717))\n - Add ability to hide Widget drag handle, set Widget name font size, and hide Graph Widget buttons ([#717](https://github.com/kizniche/mycodo/issues/717))\n - Add ability to set Dashboard grid cell height\n\n### Miscellaneous\n\n - Change grid width from 12 to 20 columns\n - Update InfluxDB from 1.7.8 to 1.7.9\n\n\n## 8.1.1 (2019.11.26)\n\n### Bugfixes\n\n - Fix outputs not turning on\n\n\n## 8.1.0 (2019.11.26)\n\nThis update brings a new Dashboard organization method, allowing drag-and drop placement and resizing of widgets using gridstack.js. This new system is not comparable to the old; and after upgrading, all widgets will lose their size and position and will need to be repositioned on your dashboard.\n\n### Bugfixes\n\n - Fix Atlas Scientific UART interfaces\n - Fix display of units in conversion list on Measurement Settings page\n - Fix unit conversions for Math controllers ([#716](https://github.com/kizniche/mycodo/issues/716))\n - Fix Wet-Bulb Humidity calculation in Math controller ([#716](https://github.com/kizniche/mycodo/issues/716))\n - Fix disabled measurements not appearing for math controllers ([#716](https://github.com/kizniche/mycodo/issues/716))\n - Fix disabled measurements from Math controllers still being recorded in influxdb\n - Fix inability to select PID Controller with PID Control Widget ([#718](https://github.com/kizniche/mycodo/issues/718))\n - Fix displaying image in Camera Widgets\n - Fix display of measurement unit on Gauge Widgets\n\n### Features\n\n - Implement new method for arranging and sizing Dashboard Widgets ([#717](https://github.com/kizniche/mycodo/issues/717))\n - Add API endpoints: /measurements/historical and /measurements/historical_function\n - Add ability to set timestamp with /measurements/create API endpoint\n - Display the entire log for the ongoing upgrade rather than only the last 40 lines\n - Add Calibration: Atlas Scientific Electrical Conductivity Sensor ([#710](https://github.com/kizniche/mycodo/issues/710))\n - Add Input: Mycodo Version (mainly for testing)\n - Allow timestamp to be specified for Python 3 Code Input measurement creation ([#716](https://github.com/kizniche/mycodo/issues/716))\n\n### Miscellaneous\n\n - Update Bootstrap to 4.3.1\n - Update FontAwesome to 5.11.2\n\n\n## 8.0.3 (2019.11.15)\n\n### Bugfixes\n\n - Fix timeout errors during settings/influxdb database import\n - Fix python3 version check during install ([#714](https://github.com/kizniche/mycodo/issues/714))\n - Fix upgrade checking\n \n\n## 8.0.2 (2019.11.13)\n\n### Bugfixes\n\n - Fix doubling the amount used to calculate Amp draw during an output being turned on\n\n\n## 8.0.1 (2019.11.11)\n\n### Bugfixes\n\n - Add Python version check to Mycodo installer ([#712](https://github.com/kizniche/mycodo/issues/712))\n - Daemon now checks for any newer version during upgrade check\n\n### Features\n\n - Allow any database version <= the currently-installed Mycodo version to be imported\n\n\n## 8.0.0 (2019.11.09)\n\nWarning: This version will not work with Python 3.5 (Raspbian Stretch). Only upgrade if you have Python 3.7 installed (Raspbian Buster).\n\nThis version introduces an improved upgrade system and a REST API (requiring Python >= 3.6) for communicating with Mycodo ([API Info](https://github.com/kizniche/Mycodo/blob/master/mycodo-api.rst) and [API Manual](https://kizniche.github.io/Mycodo/mycodo-api.html)).\n\n### Features\n\n - Add REST API ([#705](https://github.com/kizniche/mycodo/issues/705))\n\n\n## 7.10.0 (2019.11.09)\n\n### Bugfixes\n\n - Fix Output control toaster always displaying error\n - Fix translations not working ([#708](https://github.com/kizniche/mycodo/issues/708))\n - Fix display of units on LCDs\n - Fix inability of Graph Range Selector option to stay checked\n\n### Features\n\n - Add button to copy device UUID to clipboard\n - Add ability to set IP, port, and timeout for upgrade internet check\n - Add new Camera library: opencv\n - Add ability for variables to persist in Conditional statements\n - Add ability to import any database <= the current Mycodo version (database upgrade will be performed)\n - Add ability to install all unmet dependencies when importing a database\n - Improve upgrade system\n\n\n## 7.9.1 (2019.10.26)\n\n### Bugfixes\n\n - Fix issue querying data for Asynchronous graphs\n\n### Features\n\n - Add ability to select duty cycle step size for PWM Ramp Function Action ([#704](https://github.com/kizniche/mycodo/issues/704))\n\n\n## 7.9.0 (2019.10.24)\n\nThis update improves the backup/restore mechanism for the Mycodo InfluxDB time-series database. InfluxDB backups made prior to v7.8.5 will need to be restored manually. All new backups made will be in the Enterprise-compatible backup format, and only this format will be able to be restored moving forward. See [Backing up and restoring in InfluxDB](https://docs.influxdata.com/influxdb/v1.7/administration/backup_and_restore/) for more information.\n\nThis update also moves the Camera options from the Settings to the Camera page, to be more in-line with the formatting of other pages.\n\n### Bugfixes\n\n - Fix Asynchronous Graphs not displaying data\n - Fix Conditional Measurement (Multiple) Condition error\n - Fix inability to set Raspberry Pi (raspi-config) settings from the Configuration menu\n\n### Features\n\n - Update InfluxDB database export/import to use new Enterprise-compatible backup format\n - Add general camera options: stream height/width, hide last still, and hide last timelapse ([#703](https://github.com/kizniche/mycodo/issues/703))\n - Add picamera options: white balance, shutter speed, sharpness, iso, exposure mode, meter mode, and image effect ([#313](https://github.com/kizniche/mycodo/issues/313), [#703](https://github.com/kizniche/mycodo/issues/703))\n - Add Function Action: Ramp PWM ([#704](https://github.com/kizniche/mycodo/issues/704))\n - Add Conditional Conditions: Measurement (Single, Past, Average), Measurement (Single, Past, Sum) ([#636](https://github.com/kizniche/mycodo/issues/636))\n\n### Miscellaneous\n\n - Move camera settings from Settings page to Camera page\n\n\n## 7.8.4 (2019.10.18)\n\n### Bugfixes\n\n - Actually fix inability to save PID options ([#701](https://github.com/kizniche/mycodo/issues/701))\n\n\n## 7.8.3 (2019.10.18)\n\n### Bugfixes\n\n - Fix inability to save PID options ([#701](https://github.com/kizniche/mycodo/issues/701))\n\n\n## 7.8.2 (2019.10.17)\n\n### Bugfixes\n\n - Fix Output Action\n\n\n## 7.8.1 (2019.10.15)\n\n### Bugfixes\n\n - Fix copying custom controllers during upgrade\n\n\n## 7.8.0 (2019.10.14)\n\nThis release brings a big feature: Custom Controllers. Now users can import Custom Controllers just like Custom Inputs. There is a new settings section of the Configuration menu called Controllers, where a single-file Custom Controller can be imported into Mycodo. This new controller will appear in the dropdown list on the Functions page, and will act like any other function controller (PID, Trigger, LCD, etc.). See the [Custom Controllers](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#custom-controllers) section of the manual.\n\nThere's also a new Android app, [Mycodo Support](https://play.google.com/store/apps/details?id=com.mycodo.mycododocs) that provides access to several Mycodo support resources.\n\n### Bugfixes\n\n - Fix Atlas Scientific EZP Pump not working with PID Controllers ([#562](https://github.com/kizniche/mycodo/issues/562))\n - Fix Output page not showing Duty Cycle for PWM Output status\n - Fix blank Live page if Inputs added but not yet activated\n - Fix inability to capture photos with USB camera ([#677](https://github.com/kizniche/mycodo/issues/677))\n - Fix issues related to influxdb not fully starting before the Mycodo daemon\n - Fix timeout exporting large amounts of data\n\n### Features\n\n - Add ability to import Custom Controllers (See [Custom Controllers](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#custom-controllers))\n - Add ability to set PWM Output startup and shutdown state ([#699](https://github.com/kizniche/mycodo/issues/699))\n - Add Dashboard Widget: Output PWM Range Slider ([#699](https://github.com/kizniche/mycodo/issues/699))\n - Add ability to use Input/Math measurements with PID setpoint tracking ([#639](https://github.com/kizniche/mycodo/issues/639))\n - Add search to Function select\n\n### Miscellaneous\n\n - Remove Flask_influxdb\n - Upgrade Influxdb from 1.7.6 to 1.7.8\n\n\n## 7.7.9 (2019.09.29)\n\n### Bugfixes\n\n - Fix issue displaying Outputs on Asynchronous Graph\n\n### Features\n\n - Add Start Offset option for Inputs\n - Add ability to disable Graph series Data Grouping\n\n### Miscellaneous\n\n - Rename Conditional Statement measure() to condition() in Conditional Controllers\n - Add description for all Conditional Conditions and Actions\n\n\n## 7.7.8 (2019.09.22)\n\n### Bugfixes\n\n - Fix LCD controller\n\n### Miscellaneous\n\n - PEP8\n - Improve error/debug logging\n\n\n## 7.7.7 (2019.09.20)\n\n### Bugfixes\n\n - Add reset to SHT31 Input when it errors ([#695](https://github.com/kizniche/mycodo/issues/695))\n\n### Features\n\n - Add LCD Line: Custom Text\n - Add Input: BME280 using RPi.bme280 library ([#694](https://github.com/kizniche/mycodo/issues/694))\n - Add \"Library\" to distinguish inputs that use different libraries to acquire measurements for the same sensor\n\n\n## 7.7.6 (2019.09.19)\n\n### Bugfixes\n\n - Fix Outputs not showing up on Dashboard and mislabeled measurements ([#692](https://github.com/kizniche/mycodo/issues/692))\n - Update wiringpi to fix issue with Raspberry Pi 4 board ([#689](https://github.com/kizniche/mycodo/issues/689))\n\n### Features\n\n - Add Conditional Conditions: Output Duration On, Controller Running ([#691](https://github.com/kizniche/mycodo/issues/691))\n - Remove the need for Pyro5 Nameserver ([#692](https://github.com/kizniche/mycodo/issues/692))\n - Add Flask profiler\n\n\n## 7.7.5 (2019.09.18)\n\n### Bugfixes\n\n - Fix inability to activate Conditional Controllers ([#690](https://github.com/kizniche/mycodo/issues/690))\n\n### Miscellaneous\n\n - Improve post-alembic upgrade system\n - Improve Pyro5 logging\n\n\n## 7.7.4 (2019.09.18)\n\n### Bugfixes\n\n - Fix issue with Pyro5 proxy handling ([#688](https://github.com/kizniche/mycodo/issues/688))\n - Fix missing Stdout from several log files\n\n\n## 7.7.3 (2019.09.17)\n\n### Bugfixes\n\n - Fix wait time for Atlas Scientific pH Calibration ([#686](https://github.com/kizniche/mycodo/issues/686))\n - Add 'minute' measurement storage to EZO Pump Output\n - Fix database upgrade issues\n\n### Features\n\n - Add ability to store multiple measurements for Outputs ([#562](https://github.com/kizniche/mycodo/issues/562))\n - Add Calibration: Atlas Scientific EZO Pump ([#562](https://github.com/kizniche/mycodo/issues/562))\n - Add ability to select pump modes for Atlas Scientific EZO Pump ([#562](https://github.com/kizniche/mycodo/issues/562))\n - Add ability to enable Daemon debug mode from Configuration page\n - Add ability to use FTDI to communicate with Atlas Scientific EZO Pump\n - Upgrade from Pyro4 to Pyro5\n\n\n## 7.7.2 (2019.09.14)\n\n### Bugfixes\n\n - Remove redundant alembic upgrade that can cause upgrade errors\n - Fix moving Conditional/input code during upgrade\n - Generate Conditional/input code for next upgrade\n - Fix MQTT Input ([#685](https://github.com/kizniche/mycodo/issues/685))\n - Fix Atlas Scientific EZO Pump Input issue ([#562](https://github.com/kizniche/mycodo/issues/562))\n - Fix Atlas Scientific EZP Pump Output (UART) error on Output page\n - Fix Atlas Scientific pH Input issue ([#686](https://github.com/kizniche/mycodo/issues/686))\n - Fix issues with calibration of Atlas Scientific pH sensor ([#686](https://github.com/kizniche/mycodo/issues/686))\n\n### Features\n\n - Add ability to choose 1, 2, or 3 point pH calibration of Atlas Scientific pH sensor ([#686](https://github.com/kizniche/mycodo/issues/686))\n\n\n## 7.7.1 (2019.09.08)\n\n### Bugfixes\n\n - Fix issue with Pyro4\n - Fix issue with Trigger controllers\n\n\n## 7.7.0 (2019.09.08)\n\nThis release changes how user-created Python code is executed. This affects Python Code Inputs and Conditional Functions. All effort was made to reformat user scripts during the upgrade process to adhere to the new formatting guidelines, however there are a few instances where scripts could not be updated properly and will need to be done manually by the user before they will work properly. After upgrading your system, ensure your code conforms to the following guidelines:\n\n1. Conditional Functions\n   * Use 4-space indentation (not 2-space, tab, or other)\n   * Change measure() to self.measure()\n   * Change measure_dict() to self.measure_dict()\n   * Change run_action() to self.run_action()\n   * Change run_all_actions() to self.run_all_actions()\n   * Change message to self.message\n2. Python Code Inputs\n   * Use 4-space indentation (not 2-space, tab, or other)\n   * Change store_measurement() to self.store_measurement()\n\n### Bugfixes\n\n - Fix sunrise/sunset calculation\n - Fix inability to use \",\" in Input custom options\n - Fix install dependencies for Ruuvitag Input ([#638](https://github.com/kizniche/mycodo/issues/638))\n - Fix reliability issue with Ruuvitag Input (crashing Mycodo daemon) ([#638](https://github.com/kizniche/mycodo/issues/638))\n - Fix storing of SHT31 Smart Gadget erroneous measurements\n - Prevent Pyro4 TimeoutErrors from stopping PID and Conditional controllers\n - Improve Controller reliability/stability\n - Fix path to pigpiod ([#684](https://github.com/kizniche/mycodo/issues/684))\n\n### Features\n\n - Add Pylint test for Python 3 Code Input\n - Add execute_at_creation option for Inputs\n - Add Measurement: Radiation Dose Rate\n - Add Units: Microsieverts per hour (\u00b5Sv/hr), Counts per minute (cpm)\n - Add 'message' option for custom Inputs to display a message with the Input options in the web interface\n - Add more logs to view and consolidate \"View Logs\" page\n - Add automatic initialization of Input custom_options variables\n\n### Miscellaneous\n\n - Refactor how user-created Python code is executed (i.e. Python Code Inputs and Conditional Statements)\n - Refactor RPC by replacing RPyC with Pyro4 for improved system stability ([#671](https://github.com/kizniche/mycodo/issues/671), [#679](https://github.com/kizniche/mycodo/issues/679))\n - Increase Nginx file upload size\n - Reorganize menu layout\n - Modify linux_command exception-handling ([#682](https://github.com/kizniche/mycodo/issues/682))\n\n\n## 7.6.3 (2019-07-14)\n\n### Bugfixes\n\n - Fix calculating VPD\n\n### Features\n\n - Add Python 3 Code execution Input\n\n\n## 7.6.2 (2019-07-11)\n\n### Bugfixes\n\n - Various fixes for Raspbian Buster ([#668](https://github.com/kizniche/mycodo/issues/668))\n\n\n## 7.6.1 (2019-07-11)\n\n### Bugfixes\n\n - Fix TH1X-AM2301 Input ([#670](https://github.com/kizniche/mycodo/issues/670))\n\n\n## 7.6.0 (2019-07-10)\n\n### Bugfixes\n\n - Fix inability of Input custom_options value to be 0\n - Fix improper unit conversion for TH1X-AM2301 Input ([#670](https://github.com/kizniche/mycodo/issues/670))\n - Fix Bash Command Input script execution ([#667](https://github.com/kizniche/mycodo/issues/667))\n\n### Features\n\n - Add MQTT (paho) Input ([#664](https://github.com/kizniche/mycodo/issues/664))\n - Add timeout option for Linux Command Input\n\n\n## 7.5.10 (2019-06-17)\n\n### Bugfixes\n\n - Fix TTN Data Input timestamps\n\n\n## 7.5.9 (2019-06-16)\n\n### Bugfixes\n\n - Fix rare measurement issue with Ruuvitag\n - Ensure Output Controller has fully started before starting other controllers ([#665](https://github.com/kizniche/mycodo/issues/665))\n - Fix module path of mycodo_client.py when executed from symlink ([#665](https://github.com/kizniche/mycodo/issues/665))\n\n\n## 7.5.8 (2019-06-13)\n\n### Bugfixes\n\n - Fix \"getrandom() initialization failed\" with rng-tools ([#663](https://github.com/kizniche/mycodo/issues/663))\n - Fix issues with TH16/10 with AM2301 and Linux Command Inputs ([#663](https://github.com/kizniche/mycodo/issues/663))\n\n### Features\n\n - Add Debug Logging as an LCD option\n - Add traceback to error message during adding Input ([#664](https://github.com/kizniche/mycodo/issues/664))\n\n\n## 7.5.7 (2019-06-11)\n\n### Bugfixes\n\n - Fix Ruuvitag Input\n\n\n## 7.5.6 (2019-06-11)\n\n### Bugfixes\n\n - Fix issues with SHT31 Smart Gadget and Ruuvitag Inputs ([#638](https://github.com/kizniche/mycodo/issues/638))\n - Fix 500 Error generating measurement/unit choices ([#662](https://github.com/kizniche/mycodo/issues/662))\n - Change AM2320 Input code ([#585](https://github.com/kizniche/mycodo/issues/585))\n - Fix issue with Base Input\n\n### Features\n\n - Increase Live page measurement query duration to fix the display of Input measurements\n\n\n## 7.5.5 (2019-06-03)\n\n### Bugfixes\n\n - Add influxdb read/write wait timers to prevent connection errors at startup before influxdb has started\n\n### Features\n\n - Add --get_measurement parameter to mycodo_client.py\n \n### Miscellaneous\n\n - Replace locket with filelock\n\n\n## 7.5.4 (2019-05-29)\n\n### Bugfixes\n\n - Prevent rapid successive measurements from inputs after measurement delay\n - Increase lock timeout for Ruuvitag and SHT31 Smart Gadget ([#638](https://github.com/kizniche/mycodo/issues/638))\n - Fix IO error during locking for Ruuvitag ([#638](https://github.com/kizniche/mycodo/issues/638))\n - Fix pytests\n\n### Features\n\n - Add RPyC Timeout configuration option\n - Allow multiple PIDs to use the same output ([#661](https://github.com/kizniche/mycodo/issues/661))\n - Add timeout parameter to cmd_output() function\n \n### Miscellaneous\n\n - Refactor Min Off Duration to be centrally controlled by the Output Controller ([#660](https://github.com/kizniche/mycodo/issues/660))\n\n\n## 7.5.3 (2019-05-17)\n\n### Bugfixes\n\n - Prevent logging aberrant SHT31 Smart Gadget measurements\n - Handle type casting issues with Ruuvitag Input\n - Add Tags to Custom Colors selection of Graphs ([#656](https://github.com/kizniche/mycodo/issues/656))\n - Fix issues with Single Channel Sum and Average Math controllers\n - Fix inability to change Measurement Conversion back to \"Do Not Convert\"\n - Avoid build error with bcrypt 3.1.6 by lowering to version 3.1.4 ([#658](https://github.com/kizniche/mycodo/issues/658))\n - Fix issue with conversion calculation in wet-bulb humidity function\n\n### Features\n\n - Add Function Actions: Raise/Lower PID Setpoint ([#657](https://github.com/kizniche/mycodo/issues/657))\n\n### Miscellaneous\n\n - Add Unit: Pounds per square inch (psi) ([#657](https://github.com/kizniche/mycodo/issues/657))\n\n\n## 7.5.2 (2019-05-08)\n\n### Bugfixes\n\n - Fix issues with logging\n\n\n## 7.5.1 (2019-05-06)\n\n### Bugfixes\n\n - Fix bug in Input get_value() ([#654](https://github.com/kizniche/mycodo/issues/654))\n\n\n## 7.5.0 (2019-05-06)\n\n### Bugfixes\n\n - Fix storing latest SHT31 Smart Gadget measurements\n - Fix Base Input \\_\\_repr__ and \\_\\_str__\n - Fix unaccounted PID error if activation attempted when Measurement not set ([#649](https://github.com/kizniche/mycodo/issues/649))\n - Fix missing GPIO Pin sanity check ([#650](https://github.com/kizniche/mycodo/issues/650))\n - Fix \"Unknown math type\" filling log ([#651](https://github.com/kizniche/mycodo/issues/651))\n - Fix inability to stop PID autotune ([#651](https://github.com/kizniche/mycodo/issues/651))\n - Fix incomplete display of PID Settings on Mycodo Logs page\n\n### Features\n\n - Add Conditional Condition: Measurement (Multiple)\n - Add ability of Inputs to store measurements with the same or separate timestamps\n - Add option to show debug lines in Daemon Log (for Input/Math/PID/Trigger/Conditional)\n - Add Log Filters: Daemon INFO, Daemon DEBUG\n - Add Input: TH1x with DS18B20 ([#654](https://github.com/kizniche/mycodo/issues/654))\n\n### Miscellaneous\n\n - Update InfluxDB to 1.7.6\n\n\n## 7.4.3 (2019-04-17)\n\n### Bugfixes\n\n - Fix Sunrise/Sunset calculation\n - Update Infrared Remote section of manual to work with latest kernel\n - Add Bluetooth locking to prevent broken pipes\n\n### Features\n\n - Add Input: RuuviTag ([#638](https://github.com/kizniche/mycodo/issues/638))\n - Add Inputs: Atlas Scientific ORP, Atlas Scientific DO (FTDI, UART, I2C) ([#643](https://github.com/kizniche/mycodo/issues/643))\n - Add Reset Pin option and editable location for SD1306 OLED display ([#647](https://github.com/kizniche/mycodo/issues/647))\n\n\n## 7.4.2 (2019-04-02)\n\n### Bugfixes\n\n - Fix Average (single) and Sum (single) Math controllers with an Output selected\n\n\n## 7.4.1 (2019-04-02)\n\n### Bugfixes\n\n - Fix custom input preservation during upgrade\n\n\n## 7.4.0 (2019-04-01)\n\n### Bugfixes\n\n - Include Pre Output activation during Acquire Measurements Now instruction\n - Fix Outputs triggering at startup\n - Fix CCS811 Input measurement issue ([#641](https://github.com/kizniche/mycodo/issues/641))\n - Fix Math controller (equation)\n - Fix sending email notification to multiple recipients\n - Prevent RPyC TimeoutError from crashing PID controller\n\n### Features\n\n - Add Input: [The Things Network: Data Storage Integration](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#the-things-network)\n - Add Math controllers: Sum (past, single channel), Sum (last, multiple channels)\n - Add Outputs to Math controllers: Average, Redundancy, Statistics, Sum\n - Add 'required' option for Input 'custom_options' (indicates if option is required to activate Input)\n - Add 'Output State' ('on', 'off', or duty cycle) Condition for Conditional controllers ([#642](https://github.com/kizniche/mycodo/issues/642))\n\n### Miscellaneous\n\n - Change channel designations to start at 0\n\n\n## 7.3.1 (2019-02-26)\n\n### Bugfixes\n\n - Fix settings menu layout\n - Significantly improve speed of dependency-checking\n - Fix missing names for Function Actions\n\n### Features\n\n - Add dependency system for Function Actions\n - Add proper dependencies for infrared Send Function Action\n - Improve Infrared Send Action by detecting remotes and codes\n\n\n## 7.3.0 (2019-02-22)\n\n### Bugfixes\n\n - Fix issue with check_triggers() in output controller\n - Fix issue preventing export of Notes\n - Fix table issue on Note page\n\n### Features\n\n - Add Function Trigger: Infrared Remote Input\n - Add Function Action: Infrared Remote Send\n\n### Miscellaneous\n\n - Remove redundant Output (Duration) Trigger (use Output (On/Off) Trigger)\n\n\n## 7.2.4 (2019-02-20)\n\n### Bugfixes\n\n - Fix unset channel causing 500 error ([#631](https://github.com/kizniche/mycodo/issues/631))\n - During first install, initialize after install of influxdb\n\n### Miscellaneous\n\n - Add wiringpi to install\n\n\n## 7.2.3 (2019-02-19)\n\n### Bugfixes\n\n - Fix issue with SHT31 Smart Gadget disconnect error-handling\n - Prevent dashboard camera streaming if using the fswebcam library ([#630](https://github.com/kizniche/mycodo/issues/630))\n - Fix number of line characters for 20x4 LCDs ([#627](https://github.com/kizniche/mycodo/issues/627))\n - Fix PID Dashboard widget issues\n\n### Features\n\n - Add option to set Output shutdown state (on/off/neither)\n\n\n## 7.2.2 (2019-02-08)\n\n### Bugfixes\n\n - Fix inability to change BMP280 I2C address ([#625](https://github.com/kizniche/mycodo/issues/625))\n - Fix issue triggering function actions ([#626](https://github.com/kizniche/mycodo/issues/626))\n\n### Features\n\n - Add log line of PID settings when activated or saved\n - Add PID Settings button to Mycodo Logs page\n\n\n## 7.2.1 (2019-02-06)\n\n### Bugfixes\n\n - Remove bluepy version restriction that conflicts with another requirement for the latest version\n - Fix Energy Usage calculations\n - Fix output controller startup issue\n - Fix notes duplicating on graphs\n - Fix inability of Function Action (Output PWM) to set a duty cycle of 0\n - Fix inability of Function Action (Activate Controller) to activate Conditional\n - Fix pigpio dependency issue ([#617](https://github.com/kizniche/mycodo/issues/617))\n\n### Features\n\n - Add asynchronous graphs to Energy Usage summaries\n\n### Miscellaneous\n\n - Improve error-handling of Function Actions\n\n\n## 7.2.0 (2019-02-04)\n\n### Bugfixes\n\n - Fix calculating Output Usage\n - Fix error-handling of PWM signal generation ([#617](https://github.com/kizniche/mycodo/issues/617))\n - Fix output dependency issue ([#617](https://github.com/kizniche/mycodo/issues/617))\n\n### Features\n\n - Add new energy usage/cost analysis based on amperage measurements (See [Energy Usage](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#energy-usage) in the manual)\n - Add password recovery feature (technically just creates new admin user from the command line)\n\n\n## 7.1.7 (2019-02-02)\n\n### Bugfixes\n\n - Attempted fix of output dependency issue ([#617](https://github.com/kizniche/mycodo/issues/617))\n - Fix PID Autotune ungraceful exit ([#621](https://github.com/kizniche/mycodo/issues/621))\n\n\n## 7.1.6 (2019-01-30)\n\n### Bugfixes\n\n - Attempted fix of output dependency issue ([#617](https://github.com/kizniche/mycodo/issues/617))\n - Fix issue creating Triggers ([#618](https://github.com/kizniche/mycodo/issues/618))\n\n### Features\n\n - Add LCD: 128x64 OLED ([#589](https://github.com/kizniche/mycodo/issues/589))\n - Improve SHT31 Smart Gadget module\n\n### Miscellaneous\n\n - Update Translations\n - Add Languages: Dutch, Norwegian, Serbian, Swedish\n\n\n## 7.1.5 (2019-01-28)\n\n### Bugfixes\n\n - Fix issue downloading logged data from SHT31 Smart Gadget\n - Fix issue using PID measurements on Measurement Dashboard widget ([#616](https://github.com/kizniche/mycodo/issues/616))\n - Fix issue with Python Command Output variable declaration\n\n### Features\n\n - Add Dashboard widget: Indicator ([#606](https://github.com/kizniche/mycodo/issues/606))\n\n\n## 7.1.4 (2019-01-26)\n\n### Bugfixes\n\n - Fix dependency issue preventing Mycodo installation ([#614](https://github.com/kizniche/mycodo/issues/614))\n\n### Features\n\n - Add Diagnostic option: Delete Settings Database\n\n\n## 7.1.3 (2019-01-23)\n\n### Bugfixes\n\n - Fix missing PID Setpoint measurement\n - Fix missing location option for Free Space Input\n\n\n## 7.1.2 (2019-01-23)\n\n### Bugfixes\n\n - Fix Method editing\n\n\n## 7.1.1 (2019-01-22)\n\n### Bugfixes\n\n - Fix Conditional Statement testing during form save ([#610](https://github.com/kizniche/mycodo/issues/610))\n\n\n## 7.1.0 (2019-01-20)\n\nThis release changes Conditional behavior. After upgrading to this version, your Conditional Statements should have every Condition '{ID}' changed to 'measure(\"{ID}\")'. Check every Conditional after the upgrade to ensure they work as expected. Additionally, the recommended logic to store and test measurements has changed, so review the Examples in the [Conditionals section of the manual](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#conditional).\n\n### Bugfixes\n\n - Fix Error message when activating/deactivating controllers (no actual error occurred)\n - Fix (workaround) for inability to display Note whitespaces on Graphs\n\n### Features\n\n - Add ability to conduct individual measurement in Conditional Statements ([#605](https://github.com/kizniche/mycodo/issues/605))\n - Add ability to execute individual actions in Conditional Statements ([#605](https://github.com/kizniche/mycodo/issues/605))\n - Add ability to modify the Conditional message ([#605](https://github.com/kizniche/mycodo/issues/605))\n - Add Function Actions: Email with Photo Attachment, Email with Video Attachment\n\n\n## 7.0.5 (2019-01-10)\n\n### Bugfixes\n\n - Fix missing Atlas pH Input baud rate option ([#597](https://github.com/kizniche/mycodo/issues/597))\n - Fix properly displaying I2C/UART Input options\n - Fix issue requiring action selection to submit form ([#595](https://github.com/kizniche/mycodo/issues/595))\n - Fix output duration not being logged if settings saved while output is currently on\n - Fix instability of dependency system\n - Fix missing libglib2.0-dev dependency of SHT31 Smart Gadget\n\n### Features\n\n - Add FTDI support for Atlas Scientific sensors ([#597](https://github.com/kizniche/mycodo/issues/597))\n - Add Output option to trigger Functions at startup\n\n### Miscellaneous\n\n - Update SHT31 Smart Gadget Input module\n\n\n## 7.0.4 (2019-01-07)\n\n### Bugfixes\n\n - Fix issue with converted measurements unable to be used with Conditionals ([#592](https://github.com/kizniche/mycodo/issues/592))\n - Add pi-bluetooth to SHT31 Smart Gadget dependencies ([#588](https://github.com/kizniche/mycodo/issues/588))\n - Fix issue using PIDs and Graphs with converted measurement units ([#594](https://github.com/kizniche/mycodo/issues/594))\n - Fix issue with mixed up order of Graph series\n - Fix issue recording output durations\n\n### Features\n\n - Add OWFS support for 1-wire devices (currently only DS18B20, DS18S20 supported) ([#582](https://github.com/kizniche/mycodo/issues/582))\n - Add ability to delete .dependency and .upgrade files from the web UI ([#590](https://github.com/kizniche/mycodo/issues/590))\n\n### Miscellaneous\n\n - Update several Python modules, update InfluxDB to 1.7.2\n - Update manual FAQs\n\n\n## 7.0.3 (2018-12-25)\n\n### Bugfixes\n\n - Fix rendering new lines in Note text on graphs\n - Fix display of proper unit on Measurement Dashboard element ([#583](https://github.com/kizniche/mycodo/issues/583))\n - Fix missing libjpeg-dev dependency for PiOLED ([#584](https://github.com/kizniche/mycodo/issues/584))\n - Fix dependencies for AMG88xx Input\n\n### Features\n\n - Add Function Action: Create Note\n - Add Input: Sonoff TH10/16 humidity and temperature sensor ([#583](https://github.com/kizniche/mycodo/issues/583))\n - Add Input: AM2320 I2C humidity and temperature sensor ([#585](https://github.com/kizniche/mycodo/issues/585))\n\n### Miscellaneous\n\n - Change method for detecting 1-wire devices ([#582](https://github.com/kizniche/mycodo/issues/582))\n - Disable variable replacement in Command Execution Function Action until it can be fixed to work with new measurement system\n\n\n## 7.0.2 (2018-12-21)\n\n### Bugfixes\n\n - Fix inability to reorder Dashboard, Data, Output, and Function elements\n - Fix Edge Inputs not appearing in Edge Trigger input selection\n - Fix use of Atlas pH temperature calibration from Input/Math\n\n### Features\n\n - Add Additional check for Conditional Statements if {ID} is replaced with None ([#571](https://github.com/kizniche/mycodo/issues/571))\n - Add ability to set Logging Interval and download logged data from SHT31 Smart Gadget ([#559](https://github.com/kizniche/mycodo/issues/559))\n - Add Math: Input Backup: If a measurement of an Input cannot be found, look for a measurement of another (or another, etc.) ([#559](https://github.com/kizniche/mycodo/issues/559))\n\n### Miscellaneous\n\n - Add check so SHT31 Smart Gadget user options don't cause the number of stored measurements to exceed the internal memory\n\n\n## 7.0.1 (2018-12-09)\n\n### Bugfixes\n\n - Fix PiOLED LCD from changing I2C address when options are saved ([#579](https://github.com/kizniche/mycodo/issues/579))\n - Fix Generic 16x2/16x4 LCD display issue ([#578](https://github.com/kizniche/mycodo/issues/578))\n - Fix Math Add dropdown items having the same name ([#580](https://github.com/kizniche/mycodo/issues/580))\n\n### Features\n\n - Add ability to induce an Input to acquire/store measurements from the web UI\n - Add Input: SHT31 Smart Gadget (Bluetooth) humidity/temperature sensor ([#559](https://github.com/kizniche/mycodo/issues/559))\n - Add blank line to LCD display options ([#579](https://github.com/kizniche/mycodo/issues/579))\n\n ### Miscellaneous\n\n - Add verification for Conditional Statement code\n\n\n## 7.0.0 (2018-12-08)\n\nThe Mycodo 7.0 introduces many redesigned systems, including measurements/units, conversions, conditionals, and more (see full list, below). The remnants of Conditionals have been moved to a new controller, called Triggers, which executes actions in response to event triggers (such as time-based events, Output changes, sunrises/sunsets, etc.). The new Conditional system incorporates a powerful way of developing complex conditional statements. See ([#493](https://github.com/kizniche/mycodo/issues/493)) for more information. Since earlier versions are not compatible with 7.x, all 6.x users will have to perform a fresh install or delete their settings database. An option will be presented on the upgrade page to delete the database and perform an upgrade.\n\n### Bugfixes\n\n - Fix issue preventing PID Method from changing setpoint (#566)\n - Fix issue with calibration of DS-type sensors\n - Fix module loading issue by restarting the daemon following dependency install ([#569](https://github.com/kizniche/mycodo/issues/569))\n - Fix issue adding Daily Time-Based method ([#550](https://github.com/kizniche/mycodo/issues/550))\n\n### Features\n\n - Add Function: Execute Actions\n - Add Function Action: Pause (pause for a duration of time between executing specific actions)\n - Add Input: MCP9808 (I2C) high accuracy temperature sensor\n - Add Input: AMG8833 (I2C) 8x8 pixel thermal sensor\n - Add Input: SHT31 (I2C) humidity/temperature sensor\n - Add LCD: PiOLED 128x32 (I2C) LCD ([#579](https://github.com/kizniche/mycodo/issues/579))\n - Add Output: Python Command (On/Off and PWM)\n - Add Output: Atlas EZO-PMP (I2C/UART) Peristaltic Pump ([#562](https://github.com/kizniche/mycodo/issues/562))\n - Add Vapor Pressure Deficit calculation to Inputs that measure temperature and relative humidity ([#572](https://github.com/kizniche/mycodo/issues/572))\n - Add Vapor Pressure Deficit Math controller ([#572](https://github.com/kizniche/mycodo/issues/572))\n - Add Start Offset option for PID, Math, and Conditionals\n - Add ability to search Input selection dropdown list\n\n### Miscellaneous\n\n - Refactor Conditional system ([#493](https://github.com/kizniche/mycodo/issues/493))\n - Refactor Analog-to-digital converters ([#550](https://github.com/kizniche/mycodo/issues/550))\n - Refactor Measurement/Unit system ([#550](https://github.com/kizniche/mycodo/issues/550))\n - Refactor Conversion system ([#493](https://github.com/kizniche/mycodo/issues/493))\n - Upgrade InfluxDB from 1.6.0 to 1.7.0\n - Add User Role: Kiosk\n\n\n## 6.4.7 (2018-12-08)\n\nThis is the final release of version 6.x. Upgrading to 7.x will require a database wipe. This will be an option presented in the Mycodo upgrade page. If you do not want to lose your Mycodo data (settings AND measurement data), do not upgrade to 7.x.\n\n\n## 6.4.5 (2018-10-17)\n\n### Bugfixes\n\n - Fix issues with ADS1256 module ([#537](https://github.com/kizniche/mycodo/issues/537))\n - Fix issue with saving float values\n\n### Miscellaneous\n\n - Replace smbus with smbus2 ([#549](https://github.com/kizniche/mycodo/issues/549))\n\n\n## 6.4.4 (2018-10-14)\n\n### Features\n\n - Add enhanced reorder functionality for Input, Output, Math, PID, and Conditional controllers\n - Add ability to set camera still, timelapse, and video file save locations ([#498](https://github.com/kizniche/mycodo/issues/498))\n - Add ability to export/import notes and note attachments ([#548](https://github.com/kizniche/mycodo/issues/548))\n\n### Bugfixes\n\n - Fix authentication issue with Remote Administration\n - Fix issues with ADS1256 module ([#537](https://github.com/kizniche/mycodo/issues/537))\n - Fix issue with saving float values\n\n### Miscellaneous\n\n - Replace smbus with smbus2 ([#549](https://github.com/kizniche/mycodo/issues/549))\n\n\n## 6.4.3 (2018-10-13)\n\n### Bugfixes\n\n - Fix authentication issue introduced in 6.4.2\n\n\n## 6.4.2 (2018-10-13)\n\n### Features\n\n - Add MH-Z19 option: enable/disable automatic baseline correction (ABC)\n - Add ability to Test/trigger all Conditional Actions of a Conditional ([#524](https://github.com/kizniche/mycodo/issues/524))\n\n### Bugfixes\n\n - Fix Cozir module pycozir egg\n - Fix often-erroneous first measurement of ZH03B and MH-Z19 sensors\n - Fix issue with ADS1256 module ([#537](https://github.com/kizniche/mycodo/issues/537))\n\n\n## 6.4.1 (2018-10-11)\n\n### Bugfixes\n\n - Fix database upgrade issue\n\n\n## 6.4.0 (2018-10-11)\n\n### Features\n\n - Add Input: ADS1256 Analog-to-digital converter ([#537](https://github.com/kizniche/mycodo/issues/537))\n - Add ability to create custom options for Input modules ([#525](https://github.com/kizniche/mycodo/issues/525))\n - Add conversions between ppm/ppb and percent\n\n### Bugfixes\n\n - Fix issue determining PID setpoint unit on LCDs\n - Fix issue displaying IP address on LCD\n - Fix issue with client activating controllers ([#532](https://github.com/kizniche/mycodo/issues/532))\n - Fix issue with Linux Command Input ([#537](https://github.com/kizniche/mycodo/issues/537))\n - Fix issue with installing internal dependencies (e.g. pigpiod) ([#538](https://github.com/kizniche/mycodo/issues/538))\n - Potential fix for Miflora input ([#540](https://github.com/kizniche/mycodo/issues/540))\n - Fix missing Baud Rate option for K30 input ([#541](https://github.com/kizniche/mycodo/issues/541))\n - Fix 500 Error on Raspberry Pi Config page ([#536](https://github.com/kizniche/mycodo/issues/536))\n - Add turning ABC mode off during MHZ19 input initialization ([#546](https://github.com/kizniche/mycodo/issues/546))\n - Fix German \"Output\" translation\n\n### Miscellaneous\n\n - Set InfluxDB timeout to 5 seconds ([#539](https://github.com/kizniche/mycodo/issues/539))\n - Update Winsen ZH03B input module code ([#543](https://github.com/kizniche/mycodo/issues/543))\n\n\n## 6.3.9 (2018-09-18)\n\n### Bugfixes\n\n - Fix issue with installing dependencies ([#531](https://github.com/kizniche/mycodo/issues/531))\n - Fix issue with Edge devices\n\n\n## 6.3.8 (2018-09-17)\n\n### Bugfixes\n\n - Fix issue with database upgrade\n\n\n## 6.3.7 (2018-09-17)\n\n### Bugfixes\n\n - Fix issue with database upgrade\n\n\n## 6.3.6 (2018-09-17)\n\n### Bugfixes\n\n - Fix issue with Edge devices\n\n\n## 6.3.5 (2018-09-17)\n\n### Bugfixes\n\n - Fix issue with 1-Wire devices ([#529](https://github.com/kizniche/mycodo/issues/529))\n\n\n## 6.3.4 (2018-09-17)\n\n### Bugfixes\n\n - Fix issue with note system during upgrade ([#529](https://github.com/kizniche/mycodo/issues/529))\n\n\n## 6.3.3 (2018-09-17)\n\n### Bugfixes\n\n - Fix Cozir input issue\n\n\n## 6.3.2 (2018-09-16)\n\n### Bugfixes\n\n - Fix ZH03B input\n\n\n## 6.3.1 (2018-09-16)\n\nThis release adds the ability to import input modules, allowing new inputs to be created by the user. Documentation (https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#create-your-own-input-module) for developing your own input modules is in development. See issue #525 for more information about it's development and discussion. Also with this release is a new section for Notes (More -> Notes, https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#notes). Notes are associated with one more more tags that can be created. Notes can also have files attached to them. These notes can be displayed on graphs to easily identify when a certain event happened in the past (or future).\n\n### Features\n\n - Implement self-contained input modules ([#525](https://github.com/kizniche/mycodo/issues/525))\n - Add Note system ([#527](https://github.com/kizniche/mycodo/issues/527))\n\n\n## 6.2.4 (2018-09-03)\n\n### Features\n\n - Add Winsen ZH03B Particulate sensor ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Reduce install to one command\n\n### Bugfixes\n\n - Fix inability to set camera device ([#519](https://github.com/kizniche/mycodo/issues/519))\n - Fix initialization of UART MHZ16 ([#520](https://github.com/kizniche/mycodo/issues/520))\n - Fix issue with BMP280 ([#522](https://github.com/kizniche/mycodo/issues/522))\n\n## 6.2.3 (2018-08-28)\n\n### Bugfixes\n\n - Fix issue with major version upgrade initialization\n - Fix issue with PWM output dashboard element updating ([#517](https://github.com/kizniche/mycodo/issues/517))\n - Fix dependency check for DS-type sensor calibration ([#518](https://github.com/kizniche/mycodo/issues/518))\n - Fix issue with Adafruit deprecating BMP, TMP, and CCS811 ([#346](https://github.com/kizniche/mycodo/issues/346), [#503](https://github.com/kizniche/mycodo/issues/503))\n\n\n## 6.2.2 (2018-08-22)\n\n### Features\n\n - Add translations: Italian, Portuguese\n\n### Bugfixes\n\n - Fix display of IP address on LCD ([#507](https://github.com/kizniche/mycodo/issues/507))\n - Fix graph manual y-axis min/max ([#516](https://github.com/kizniche/mycodo/issues/516))\n - Fix issue with deleting all dashboard elements\n\n\n## 6.2.1 (2018-08-20)\n\n### Features\n\n - Add Diagnostic section of configuration menu with first function: Delete All Dashboard Elements ([#515](https://github.com/kizniche/mycodo/issues/515), [#516](https://github.com/kizniche/mycodo/issues/516))\n\n### Bugfixes\n\n - Fix issue with units on LCDs ([#514](https://github.com/kizniche/mycodo/issues/514))\n\n\n## 6.2.0 (2018-08-15)\n\n### Features\n\n - New measurement/unit configuration system (select which unit to convert/store for input measurements) ([#506](https://github.com/kizniche/mycodo/issues/506))\n - Add ability to create new measurements, units, and conversions ([#506](https://github.com/kizniche/mycodo/issues/506))\n - Enable conversion of disk space (kB, MB, GB), frequency (Hz, kHz, MHz), and humidity (%, decimal)\n - Add option to display IP address on LCD ([#507](https://github.com/kizniche/mycodo/issues/507))\n - Full German Translation ([#507](https://github.com/kizniche/mycodo/issues/507)) (@pmunz75)\n - Add PID Autotune feature (currently disabled; may be enabled in the release, pending testing)\n - Add New Translations: Russian, Chinese\n - Complete Translations: German, Spanish, French\n\n### Bugfixes\n\n - Fix issue activating Cozir CO2 sensor ([#495](https://github.com/kizniche/mycodo/issues/495))\n - Fix issue with order not updating correctly when Conditional is deleted\n - Fix issue with output usage report generation ([#504](https://github.com/kizniche/mycodo/issues/504))\n - Fix proper conversion of temperatures/pressure for Wet-Bulb Humidity Math\n - Fix Atlas pH UART sensor module ([#509](https://github.com/kizniche/mycodo/issues/509))\n\n### Miscellaneous\n\n - Update InfluxDB 1.5.0 -> 1.6.0\n\n\n## 6.1.4 (2018-06-28)\n\n### Features\n\n - Increase verbosity of conditional email notification\n - Add Cozir CO2 sensor Input ([#495](https://github.com/kizniche/mycodo/issues/495))\n - Allow CO2 to be converted from ppm <-> ppb\n\n### Bugfixes\n\n - Fix pressure measurements being forced to integer ([#476](https://github.com/kizniche/mycodo/issues/476))\n - Fix CCS811 Input measurement ([#467](https://github.com/kizniche/mycodo/issues/467))\n - Fix pigpio dependency install issue\n - Prevent pre-output from remaining on after an Input is deactivated\n - Enable unit conversions for AM2315\n - Fix issue setting PID setpoint from Dashboard ([#496](https://github.com/kizniche/mycodo/issues/496))\n - Fix displaying custom graph colors ([#491](https://github.com/kizniche/mycodo/issues/491))\n\n### Miscellaneous\n\n - Remove I2C support for K30 CO2 sensor (until properly tested)\n - Update to Bootstrap 4.1.1\n - Remove remaining Fahrenheit conversions from Live page\n - Update 433 MHz wireless script (test send/receive, determine/receive commands from remote)\n\n\n## 6.1.3 (2018-06-05)\n\n### Features\n\n - Add I2C support for K30 CO2 sensor (untested)\n\n### Bugfixes\n\n - Fix service executable location ([#487](https://github.com/kizniche/mycodo/issues/487))\n - Fix inability to set duty cycle from frontend ([#485](https://github.com/kizniche/mycodo/issues/485))\n - Fix (finally) saving Time-based Conditional times ([#488](https://github.com/kizniche/mycodo/issues/488))\n\n\n## 6.1.2 (2018-05-23)\n\n### Features\n\n - Add option to set Miflora Bluetooth adapter ([#483](https://github.com/kizniche/mycodo/issues/483))\n\n### Bugfixes\n\n - Fix exception-handling of sending test email ([#471](https://github.com/kizniche/mycodo/issues/471))\n - Fix HDC1000 initialization issue ([#467](https://github.com/kizniche/mycodo/issues/467))\n - Fix Command PWM frontend issues ([#469](https://github.com/kizniche/mycodo/issues/469))\n - Fix ADC modules ([#482](https://github.com/kizniche/mycodo/issues/482))\n - Update miflora to 0.4 ([#481](https://github.com/kizniche/mycodo/issues/481))\n - Fix BH1750 sensor ([#480](https://github.com/kizniche/mycodo/issues/480))\n\n### Miscellaneous\n\n- Update alembic, Flask, Flask_CSV, geocoder, gunicorn, imutils, pytest, python-dateutil, SQLAlchemy, testfixtures\n\n\n## 6.1.1 (2018-05-18)\n\n### Features\n\n- Add CCS811 CO2 sensor input ([#467](https://github.com/kizniche/mycodo/issues/467))\n- Add HDC1000/HDC1080 Temperature/Humidity sensor input ([#467](https://github.com/kizniche/mycodo/issues/467))\n- Add Pascal/kiloPascal conversion for pressure\n- Add ppm/ppb conversion for CO2 and VOC concentration\n- Improve accuracy of float measurement values\n- Add option to set camera output duration (before image capture)\n- Improve handling of multiple queries to a single device\n\n### Bugfixes\n\n - Fix saving settings of Conditional Timers ([#470](https://github.com/kizniche/mycodo/issues/470))\n - Fix Command PWM output use in PIDs ([#469](https://github.com/kizniche/mycodo/issues/469))\n - Fix proper display of Outputs in Conditionals ([#469](https://github.com/kizniche/mycodo/issues/469))\n\n\n## 6.1.0 (2018-05-02)\n\n### Features\n\n- Add Output (Duration) Conditional ([#186](https://github.com/kizniche/mycodo/issues/186))\n\n### Bugfixes\n\n - Fix refreshing settings of active conditional controllers\n - Fix saving settings of Conditional Timers ([#464](https://github.com/kizniche/mycodo/issues/464))\n\n\n## 6.0.9 (2018-04-27)\n\n### Bugfixes\n\n - Fix command measurement checking ([#460](https://github.com/kizniche/mycodo/issues/460))\n - Fix rendering of Math measurements/units ([#461](https://github.com/kizniche/mycodo/issues/461))\n\n\n## 6.0.8 (2018-04-27)\n\n### Bugfixes\n\n - Fix identification of custom command measurement/units ([#457](https://github.com/kizniche/mycodo/issues/457))\n - Fix AM2315 Input issue ([#459](https://github.com/kizniche/mycodo/issues/459))\n\n\n## 6.0.7 (2018-04-26)\n\n### Features\n\n- Add ability to change sample rate of controllers ([#386](https://github.com/kizniche/mycodo/issues/386))\n\n### Bugfixes\n\n - Fix display of graph custom y-axis names\n - Fix inability to change pigpiod sample rate ([#458](https://github.com/kizniche/mycodo/issues/458))\n\n\n## 6.0.6 (2018-04-23)\n\n### Bugfixes\n\n - Fix issue with Edge Input\n - Fix issue with Conditional timers\n - Fix issue with BME280 dependency identification\n\n\n## 6.0.5 (2018-04-22)\n\n### Features\n\n- Add Conditional: Time Span ([#444](https://github.com/kizniche/mycodo/issues/444))\n\n### Bugfixes\n\n - Fix dependency check ([#422](https://github.com/kizniche/mycodo/issues/422))\n - Try lower integration times when TSL2561 sensor is saturated ([#450](https://github.com/kizniche/mycodo/issues/450))\n - Fix DHT11/DHT22 output power check ([#454](https://github.com/kizniche/mycodo/issues/454))\n\n\n## 6.0.4 (2018-04-21)\n\n### Bugfixes\n\n - Fix scanning for DS18B20 sensors ([#452](https://github.com/kizniche/mycodo/issues/452))\n\n\n## 6.0.3 (2018-04-21)\n\n### Bugfixes\n\n - Fix upgrade issue\n\n\n## 6.0.1 (2018-04-21)\n\n### Bugfixes\n\n - Fix setting landing page ([#452](https://github.com/kizniche/mycodo/issues/452))\n\n\n## 6.0.0 (2018-04-21)\n\nVersion 6 has changes to the database schema that could not be upgraded to. To upgrade to this version, the settings database must be created anew. You either have the options of staying at the last version (5.7.x), or deleting the settings database and upgrading. A fresh install is necessary to run this version.\n\n### Features\n\n - Add Conditionals: Run PWM Method, Daily Time Point Timer, Duration Timer, Output PWM ([#444](https://github.com/kizniche/mycodo/issues/444), [#448](https://github.com/kizniche/mycodo/issues/448))\n - Add Conditional Actions: Activate/Deactivate any controller, Set PID Method ([#440](https://github.com/kizniche/mycodo/issues/440))\n - Use actual range value for color stops of solid gauges ([#434](https://github.com/kizniche/mycodo/issues/434))\n - Add option to set setpoint from PID dashboard element without epanding element ([#449](https://github.com/kizniche/mycodo/issues/449))\n - Refactor Conditional Controllers to be multithreaded\n\n### Bugfixes\n\n - Fix Hold bug in PID controllers\n - Fix error-handing when changing PID setting from Dashboard if PID is inactive ([#449](https://github.com/kizniche/mycodo/issues/449))\n\n### Miscellaneous\n\n - Remove multiplexer integration (use kernel driver)\n - Remove Timers (Conditionals have replaced their functionality)\n - Improve testing coverage of frontend ([#444](https://github.com/kizniche/mycodo/issues/444))\n\n\n## 5.7.3 (2018-04-20)\n\nThis is the last version of the 5.x branch. If your system is upgraded to 5.7.3, you will have the option of upgrading to the next major version (6.x), however the settings database will need to be deleted. This can be done through the web UI or manually by reinstalling Mycodo fresh.\n\n### Features\n\n - Add Conditional Action: Set PID Method ([#440](https://github.com/kizniche/mycodo/issues/440))\n\n\n## 5.7.2 (2018-04-07)\n\n### Features\n\n - Add ability to invert PWM duty cycle ([#444](https://github.com/kizniche/mycodo/issues/444))\n - Add ability to select landing page ([#444](https://github.com/kizniche/mycodo/issues/444))\n - Add ability to set setpoint from PID dashboard elements ([#444](https://github.com/kizniche/mycodo/issues/444))\n - Add Conditional Actions: Activate/Deactivate Timer ([#440](https://github.com/kizniche/mycodo/issues/440))\n\n### Bugfixes\n\n - Fix catching erroneous DS18B20 values ([#404](https://github.com/kizniche/mycodo/issues/404))\n - Fix camera selection of Photo Conditional Action ([#444](https://github.com/kizniche/mycodo/issues/444))\n\n### Miscellaneous\n\n - Set picamera use_video_port=False ([#444](https://github.com/kizniche/mycodo/issues/444))\n - Rearrange navigation menu ([#444](https://github.com/kizniche/mycodo/issues/444))\n\n\n## 5.7.1 (2018-04-04)\n\n### Features\n\n - Add Conditional Action: Set PID Setpoint\n - Add Input: Xiaomi MiFlora ([#422](https://github.com/kizniche/mycodo/issues/422))\n\n### Bugfixes\n\n - Restore missing help menu on navigation bar\n - Fix issue reading SHT sensors ([#437](https://github.com/kizniche/mycodo/issues/437))\n\n### Miscellaneous\n\n - Convert README and Manual from MD to RST\n - Update sht_sensor to 18.4.1\n\n\n## 5.7.0 (2018-04-03)\n\n### Features\n\n - Add ability to convert Input measurements between units ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add unit conversions: celsius, fahrenheit, kelvin, meters, feet\n - Add ability to select whether lowering PID outputs are stored as positive or negative values\n - Add Sunrise/Sunset Conditional ([#440](https://github.com/kizniche/mycodo/issues/440))\n - Add ability to set the precision for DS18B20, DS1822, DS28EA00, and DS1825 sensors ([#439](https://github.com/kizniche/mycodo/issues/439))\n - Add Inputs: DS18S20, DS1822, DS28EA00, DS1825, MAX31850K\n - Add Input option to select resolution for DS18B20, DS1822, DS28EA00, and DS1825 ([#439](https://github.com/kizniche/mycodo/issues/439))\n\n\n### Bugfixes\n\n - Fix issues with PID control on Dashboard ([#441](https://github.com/kizniche/mycodo/issues/441))\n - Improve LCD controller shutdown speed\n - Fix installer not displaying progress in console ([#442](https://github.com/kizniche/mycodo/issues/442))\n - Force measurement values to float before writing to influxdb (except 'pressure') ([#441](https://github.com/kizniche/mycodo/issues/441))\n\n\n## 5.6.10 (2018-03-31)\n\n### Bugfixes\n\n - Fix issue executing mycodo_client.py\n - Fix Command Outputs not turning off after turning on for a duration ([#432](https://github.com/kizniche/mycodo/issues/432))\n - Prevent DS18B20 measurements outside expected range ([#404](https://github.com/kizniche/mycodo/issues/404))\n - Prevent race condition preventing output from remaining on for a duration ([#436](https://github.com/kizniche/mycodo/issues/436))\n - Ensure outputs turned on for a duration only turn off once ([#436](https://github.com/kizniche/mycodo/issues/436))\n - Update sht-sensor to 18.3.6 for Python 3 compatibility ([#437](https://github.com/kizniche/mycodo/issues/437))\n\n### Miscellaneous\n\n - Change SSL certificate expiration from 1 year to 10 years\n - Fix style issues with Remote Admin following Bootstrap upgrade\n - Fix issue with setup.sh script not catching errors\n\n\n## 5.6.9 (2018-03-24)\n\n### Features\n\n - Add Refractory Period to Measurement Conditional options\n - Add method to hide/show/reorder all Dashboard Elements at once ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Make Output/PID popups respond to show/hide configuration options ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add Input: Atlas Electrical Conductivity sensor ([#411](https://github.com/kizniche/mycodo/issues/411))\n\n### Bugfixes\n\n - Fix issue saving reference resistor value ([#345](https://github.com/kizniche/mycodo/issues/345))\n - Fix LCD display of timestamps\n - Fix inability to change Solid Gauge Stops ([#433](https://github.com/kizniche/mycodo/issues/433))\n - Fix Command Outputs not turning off after turning on for a duration ([#432](https://github.com/kizniche/mycodo/issues/432))\n - Fix encoding issue with df command output ([#430](https://github.com/kizniche/mycodo/issues/430))\n\n\n## 5.6.8 (2018-03-19)\n\n### Bugfixes\n\n - Fix Camera Output not having an effect\n - Fix issues with MAX31856/MAX31865 ([#345](https://github.com/kizniche/mycodo/issues/345))\n\n\n## 5.6.7 (2018-03-18)\n\n### Bugfixes\n\n - Fix upgrade menu not turning red when an upgrade is available\n - Add lockfile breaking ([#418](https://github.com/kizniche/mycodo/issues/418))\n - Fix bcrypt dependency issue preventing install ([#429](https://github.com/kizniche/mycodo/issues/429))\n\n\n## 5.6.6 (2018-03-17)\n\n### Features\n\n - Add Input: MAX31865 for PT100 and PT1000 temperature probes ([#345](https://github.com/kizniche/mycodo/issues/345))\n\n### Bugfixes\n\n - Fix incorrect conversion of I2C address during Atlas pH sensor calibration ([#425](https://github.com/kizniche/mycodo/issues/425))\n - Potential fix for ADC issues when using pre-output ([#418](https://github.com/kizniche/mycodo/issues/418))\n - Fix Linux Command measurement display on lines 2 through 4 of LCDs ([#427](https://github.com/kizniche/mycodo/issues/427))\n - Fix display of PID setpoint units on LCDs\n - Fix display of LCD lines without measurement units\n - Fix locking to be thread safe (replaced fasteners with locket) ([#418](https://github.com/kizniche/mycodo/issues/418))\n\n\n## 5.6.5 (2018-03-14)\n\n### Features\n\n - Update to Bootstrap 4\n - Update to InfluxDB 1.5.0\n\n### Bugfixes\n\n - Add proper max voltage for MCP3008 ([#418](https://github.com/kizniche/mycodo/issues/418))\n - Fix PID persisting as paused/held after deactivating and activating\n - Fix Atlas pH Calibration issue ([#425](https://github.com/kizniche/mycodo/issues/425))\n - Fix issue with Linux Command Inputs and LCDs ([#427](https://github.com/kizniche/mycodo/issues/427))\n\n\n## 5.6.4 (2018-03-11)\n\n### Features\n\n - Add Input: MAX31856 for measuring several types of thermocouples (K, J, N, R, S, T, E, and B) ([#345](https://github.com/kizniche/mycodo/issues/345)\n - Add mycodo_client.py option: get or set PID setpoint, integrator, derivator, kp, ki, and kd ([#420](https://github.com/kizniche/mycodo/issues/420))\n - Add option to enable pre-output during measurement (previously turned off before measurement) ([#418](https://github.com/kizniche/mycodo/issues/418))\n\n### Bugfixes\n\n - Fix frontend pid in System Information page\n - Fix issue with mycodo_client.py PID hold and resume commands\n\n### Miscellaneous\n\n - Make rpi-rf an optional Output dependency\n\n\n## 5.6.3 (2018-03-09)\n\n### Features\n\n - Add ability to use custom command line options for fswebcam camera image captures ([#419](https://github.com/kizniche/mycodo/issues/419))\n - Add Input: MAX31855K for measuring K-type thermocouples ([#345](https://github.com/kizniche/mycodo/issues/345))\n - Add ability to set duty cycle of output via mycodo_client.py ([#420](https://github.com/kizniche/mycodo/issues/420))\n - Add Conditional Action: Output PWM ([#420](https://github.com/kizniche/mycodo/issues/420))\n - Add Output Type: Execute Command (PWM) ([#420](https://github.com/kizniche/mycodo/issues/420))\n\n### Bugfixes\n\n - Fix LCD issues\n - Fix state display of Command Outputs turned on for a duration\n\n\n## 5.6.2 (2018-03-04)\n\n### Features\n\n - Make install of WiringPi optional ([#412](https://github.com/kizniche/mycodo/issues/412))\n - Make install of numpy optional ([#412](https://github.com/kizniche/mycodo/issues/412))\n - Add pause color and Pause/Hold/Resume buttons to PID Dashboard element options ([#416](https://github.com/kizniche/mycodo/issues/416))\n - Display a log when installing dependencies to follow the progress\n - Add Dependency Install Log to the Log page\n - Add mycodo_client.py user commands: pid_pause, pid_hold, pid_resume\n \n### Bugfixes\n\n - Fix issues with PID Conditional Actions ([#416](https://github.com/kizniche/mycodo/issues/416))\n - Fix display of last edge on Live page\n - Fix issue updating the status of some dependencies after their install\n\n### Miscellaneous\n\n - Remove redundant upgrade commands ([#412](https://github.com/kizniche/mycodo/issues/412))\n - Remove GPIO State from Edge Conditional (use Measurement Conditional) ([#416](https://github.com/kizniche/mycodo/issues/416))\n\n\n## 5.6.1 (2018-02-27)\n\n### Features\n\n - Add Conditional Actions: Pause/Resume PID ([#346](https://github.com/kizniche/mycodo/issues/346))\n\n### Bugfixes\n\n - Fix pigpiod configuration options when pigpiod is not installed ([#412](https://github.com/kizniche/mycodo/issues/412))\n - Fix setting up pigpiod during install\n - Fix TSL2561 Input module ([#414](https://github.com/kizniche/mycodo/issues/414))\n - Fix Measurement Dashboard element condition/unit display ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Fix saving PID Conditional Actions ([#415](https://github.com/kizniche/mycodo/issues/415))\n\n\n## 5.6.0 (2018-02-25)\n\n### Features\n\n - Add interactive installer\n - Make Python modules conditionally imported ([#412](https://github.com/kizniche/mycodo/issues/412))\n\n\n## 5.5.24 (2018-02-24)\n\n### Features\n\n - Add new Input: MCP3008 Analog-to-Digital Converter ([#409](https://github.com/kizniche/mycodo/issues/409))\n\n\n## 5.5.23 (2018-02-23)\n\n### Features\n\n - Add option to set decimal places on Dashboard elements ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add option to show detailed PID information on Dashboard element ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add units to PID Dashboard element ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add Fahrenheit conversion to gauges ([#137](https://github.com/kizniche/mycodo/issues/137))\n - Add new Math: Average (Single Measurement) ([#335](https://github.com/kizniche/mycodo/issues/335))\n\n### Bugfixes\n\n - Allow disabled pigpiod to persist after upgrades ([#386](https://github.com/kizniche/mycodo/issues/386))\n - Fix display of Math measurement/units of Measurement Dashboard element\n - Prevent a large D-value the the first cycle after a PID is activated\n - Handle TypeErrors for Humidity Math controller\n\n\n## 5.5.22 (2018-02-19)\n\n### Features\n\n - Add PID-Values to Graphs ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add Dashboard elements: Measurement, Output, PID Control ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add system date and time to menu\n\n### Bugfixes\n\n - Add checks to ensure Humidity Math only returns 0% - 100% humidity\n - Prevent opposing relays from being turned off in PID Controllers ([#402](https://github.com/kizniche/mycodo/issues/402))\n - Fix adding and viewing hosts in Remote Admin ([#377](https://github.com/kizniche/mycodo/issues/377))\n - Fix error-handling of DS18B20 communication error ([#404](https://github.com/kizniche/mycodo/issues/404))\n - Add error-handling for influxdb queries ([#405](https://github.com/kizniche/mycodo/issues/405))\n\n\n## 5.5.21 (2018-02-13)\n\n### Bugfixes\n\n - Add error-handling of DS18B20 communication error ([#404](https://github.com/kizniche/mycodo/issues/404))\n - Fix setup abort from unmet pigpiod dependency ([#406](https://github.com/kizniche/mycodo/issues/406))\n\n\n## 5.5.20 (2018-02-11)\n\n### Features\n\n - Add new configuration section: Pi Settings\n - Add to Pi Settings: common ```raspi-config``` options\n - Add to Pi Settings: select pigpiod sample rate ([#386](https://github.com/kizniche/mycodo/issues/386))\n - Add option to completely disable pigpiod ([#386](https://github.com/kizniche/mycodo/issues/386))\n\n### Bugfixes\n\n - Add ability to set custom Graph colors for Math measurements\n \n\n## 5.5.19 (2018-02-06)\n\n### Features\n\n - Enable custom minimum/maximum to be set for any y-axis ([#335](https://github.com/kizniche/mycodo/issues/335))\n - Add Asynchronous Graph options for duration of data to display (All or past year, month, week, day)\n\n### Bugfixes\n\n - Fix saving Math Humidity options ([#400](https://github.com/kizniche/mycodo/issues/400))\n\n\n## 5.5.18 (2018-02-04)\n\n### Features\n\n - Allow multiple data series on Asynchronous Graphs ([#399](https://github.com/kizniche/mycodo/issues/399))\n - Add Outputs and PIDs to Asynchronous Graphs ([#399](https://github.com/kizniche/mycodo/issues/399))\n - Preserve Asynchronous Graph selections after form submissions ([#399](https://github.com/kizniche/mycodo/issues/399))\n\n### Bugfixes\n\n - Fix reloading of asynchronous graphs ([#399](https://github.com/kizniche/mycodo/issues/399))\n\n\n## 5.5.17 (2018-02-03)\n\n### Features\n\n - Add option to show/hide Gauge timestamp ([#392](https://github.com/kizniche/mycodo/issues/392))\n - Add new Math: Equation ([#335](https://github.com/kizniche/mycodo/issues/335))\n - Add PID control hysteresis ([#398](https://github.com/kizniche/mycodo/issues/398))\n - Automatically restart pigpiod when it fails\n\n### Bugfixes\n\n - Move pigpiod from cron to systemd service to improve reliability ([#388](https://github.com/kizniche/mycodo/issues/388))\n - Improve deamon error-handling and Input connectivity ([#388](https://github.com/kizniche/mycodo/issues/388))\n - Fix Mycodo service timeout ([#379](https://github.com/kizniche/mycodo/issues/379))\n - Fix display of Graph custom colors\n\n\n## 5.5.16 (2018-01-28)\n\n### Bugfixes\n\n - Fix issue with conditionals not triggering when measurement values are 0 ([#387](https://github.com/kizniche/mycodo/issues/387))\n - Fix issue with settings Output PWM duty cycles\n - Fix issues with Atlas UART module ([#382](https://github.com/kizniche/mycodo/issues/382))\n - Fix issues with calibrating the Atlas pH sensor ([#382](https://github.com/kizniche/mycodo/issues/382))\n\n\n## 5.5.15 (2018-01-28)\n\n### Features\n\n - Add Graph button to manually update graph with new data\n - Increase output timing accuracy (0.01 second, previously 0.1 second)\n - Improve graph update efficiency\n - Add Graph option: Enable Graph Shift (used in conjunction with Enable Navbar)\n - Add new Math: Difference ([#395](https://github.com/kizniche/mycodo/issues/395))\n\n### Bugfixes\n\n - Fix issue modifying the Conditional Max Age ([#387](https://github.com/kizniche/mycodo/issues/387))\n - Fix issue with new data on graphs requiring a page refresh to see\n - Fix issue with updating inputs/maths with long periods on the Live page\n\n### Miscellaneous\n\n - Remove debug line from GPIO State Input module ([#387](https://github.com/kizniche/mycodo/issues/387))\n\n\n## 5.5.14 (2018-01-25)\n\n### Bugfixes\n\n - Fix display of PID timestamp on LCDs\n - Fix missing pigpio.zip (breaks install/upgrade) on remote server (package pigpio.tar with Mycodo)\n\n\n## 5.5.13 (2018-01-23)\n\n### Features\n\n - Add Input: GPIO State ([#387](https://github.com/kizniche/mycodo/issues/387))\n - Refactor Dashboard code (improve load time, reduce code size)\n\n### Bugfixes\n\n - Fix inability to change Input Period ([#393](https://github.com/kizniche/mycodo/issues/393))\n - Fix Exception while reading the GPIO pin of Edge Conditional ([#387](https://github.com/kizniche/mycodo/issues/387))\n\n### Miscellaneous\n\n - Add Input Template for the [Wiki](https://github.com/kizniche/Mycodo/wiki/Adding-Support-for-a-New-Input)\n\n\n## 5.5.12 (2018-01-21)\n\n### Features\n\n - Add two new Inputs: Server Ping and Server Port Open ([#389](https://github.com/kizniche/mycodo/issues/389))\n\n\n## 5.5.11 (2018-01-21)\n\n### Bugfixes\n\n - Fix issues with Dashboard Gauges ([#391](https://github.com/kizniche/mycodo/issues/391))\n - Fix issues with Dashboard Cameras\n\n### Miscellaneous\n\n - Add ID numbers to Conditionals in UI for identification ([#387](https://github.com/kizniche/mycodo/issues/387))\n\n\n## 5.5.10 (2018-01-20)\n\n### Features\n\n - Add ability to set graph y-axis minimum/maximum ([#384](https://github.com/kizniche/mycodo/issues/384))\n - Add ability to view Math outputs on asynchronous graphs ([#335](https://github.com/kizniche/mycodo/issues/335))\n - Improve Dashboard Object creation/manipulation user interaction\n\n### Bugfixes\n\n - Fix inability to activate Edge Conditionals ([#381](https://github.com/kizniche/mycodo/issues/381))\n - Fix inability to add new gauges or graphs to the dashboard ([#384](https://github.com/kizniche/mycodo/issues/384))\n - Fix issues with UART Atlas pH Input device ([#382](https://github.com/kizniche/mycodo/issues/382))\n - Fix issue with Atlas pH calibration ([#382](https://github.com/kizniche/mycodo/issues/382))\n - Fix issue with caching of Camera images on the Dashboard\n - Fix issue with Edge Conditionals ([#387](https://github.com/kizniche/mycodo/issues/387))\n\n\n## 5.5.9 (2018-01-14)\n\n### Bugfixes\n\n - Fix issue generating output usage reports ([#380](https://github.com/kizniche/mycodo/issues/380))\n - Fix inability to save Edge Conditionals ([#381](https://github.com/kizniche/mycodo/issues/381))\n\n\n## 5.5.8 (2018-01-11)\n\n### Features\n\n - Add ability to add Camera modules to the Dashboard (formerly Live Graphs page)\n\n### Bugfixes\n\n - Fix issue with new installations failing to start the flask frontend ([#379](https://github.com/kizniche/mycodo/issues/379))\n - Fix issue with services starting on Pi Zeros ([#379](https://github.com/kizniche/mycodo/issues/379))\n\n### Miscellaneous\n\n - Reduce gunicorn (web UI) workers from 2 to 1\n\n\n## 5.5.7 (2018-01-08)\n\n### Bugfixes\n\n- Fix forcing of HTTPS via user configuration\n- Fix inability to save Gauge Refresh Period option ([#376](https://github.com/kizniche/mycodo/issues/376))\n- Fix Atlas Scientific communication issues ([#369](https://github.com/kizniche/mycodo/issues/369))\n\n\n## 5.5.6 (2018-01-05)\n\n### Features\n\n - Add ability to restart the frontend from the web UI\n\n### Bugfixes\n\n- Attempt to fix issue where DHT22 sensor may become unresponsive\n- Fix inability to stream video from PiCamera\n\n\n## 5.5.5 (2018-01-04)\n\n### Bugfixes\n\n - Fix IP address of user login log entries\n - Fix issue reading DHT11 sensor ([#370](https://github.com/kizniche/mycodo/issues/370))\n\n\n## 5.5.4 (2018-01-03)\n\n### Features\n\n - Add ability to replace edge variable in edge conditional command action\n\n### Bugfixes\n\n - Fix issue with proper python 3 virtualenv ([#362](https://github.com/kizniche/mycodo/issues/362))\n - Fix starting web server during install\n - Fix issue with gunicorn worker timeouts on Raspberry Pi Zeros ([#365](https://github.com/kizniche/mycodo/issues/365))\n - Fix command variable replacement for Output conditionals ([#367](https://github.com/kizniche/mycodo/issues/367))\n - Fix pH Input causing an error with a deactivated Calibration Measurement ([#369](https://github.com/kizniche/mycodo/issues/369))\n - Fix issue preventing capture of still images from the web interface ([#368](https://github.com/kizniche/mycodo/issues/368))\n\n### Miscellaneous\n\n - Move mycodo root symlink from /var/www to /var\n - Create symlinks in PATH for mycodo-backup, mycodo-client, mycodo-commands, mycodo-daemon, mycodo-pip, mycodo-python, mycodo-restore, and mycodo-wrapper\n\n\n## 5.5.3 (2017-12-29)\n\n### Bugfixes\n\n - Fix issue with web UI and daemon not restarting properly after upgrade\n - Fix issue with the log not updating properly on the Upgrade page\n\n\n## 5.5.2 (2017-12-27)\n\n### Features\n\n - Add Conditional Actions: Flash LCD Off, LCD Backlight On, LCD Backlight Off ([#363](https://github.com/kizniche/mycodo/issues/363))\n\n### Bugfixes\n\n - Add more log lines to find out exactly which part makes the end of an upgrade hang\n - Fix MHZ16/19 UART communication ([#359](https://github.com/kizniche/mycodo/issues/359))\n - Fix missing I2C devices from System Information page ([#354](https://github.com/kizniche/mycodo/issues/354))\n - Fix output state determination of other outputs if a wireless output is unconfigured ([#364](https://github.com/kizniche/mycodo/issues/364))\n - Fix LCD controller issues with flashing and backlight management\n\n\n## 5.5.1 (2017-12-25)\n\n### Bugfixes\n\n - Fix inability to send Conditional email notification to multiple recipients\n - Fix inability to select LCDs as Conditional Actions\n - Fix BME280 sensor module ([#358](https://github.com/kizniche/mycodo/issues/358))\n - Fix TSL2591 sensor module\n - Fix MHZ16/MHZ19 unicode errors (still investigating other potential issues reading these sensors)\n\n\n## 5.5.0 (2017-12-25)\n\nMerry Christmas!\n\nWith the release of 5.5.0, Mycodo becomes modern by migrating from Python 2.7.9 to Python 3 (3.5.3 if on Raspbian Stretch, 3.4.2 if on Raspbian Jessie). This release also brings a big switch from apache2+mod_wsgi to nginx+gunicorn as the web server.\n\n### Issues\n\n***You may experience an error during the upgrade that doesn't allow it to complete***\n\n***It will no longer be possible to restore pre-5.5.0 backups***\n\n***All users will be logged out of the web UI during the upgrade***\n\n***All Conditionals will be deactivated and need reconfiguring***\n\n***OpenCV has been removed as a camera module***\n\nIf you rely on your system to work, it is highly recommended that you ***DO NOT UPGRADE***. Wait until your system is no longer performing critical tasks to upgrade, in order to allow yourself the ability to thoroughly test your particular configuration works as expected, and top perform a fresh install if the upgrade fails. Although most parts of the system have been tested to work, there is, as always, the potential for unforeseen issues (for instance, not every sensor that Mycodo supports has physically been tested). Read the following notes carefully to determine if you want to upgrade to 5.5.0 and newer versions.\n\n#### Failure during the upgrade to >= 5.5.0\n\nI found that occasionally the upgrade will spontaneously stop without an indication of the issue. I've seen it happen during an apt-get install and during a pip upgrade. It does not seem consistent, and there were no erorrs, therefore it wasn't able to be fixed. If you experience an error during the upgrade that doesn't allow the upgrade to complete, issue the following commands to attempt to resume and complete the upgrade. If that doesn't fix it, you may have to install Mycodo from scratch.\n\n```bash\nsudo dpkg --configure -a\nsudo /bin/bash ~/Mycodo/mycodo/scripts/upgrade_post.sh\n```\n\n#### No restoring of pre-5.5.0 backups\n\nRestoring pre-5.5.0 backups will not work. This is due to the moving of the pip virtual environments during the restore, the post-5.5.0 (python3) virtualenv not being compatible with the pre-5.5.0 virtualenv (python2), and moving from the apache2 web server to nginx. If you absolutely need to restore a backup, it must be done manually. Create a new github issue to get asistance with this.\n\nAlso with this release, exporting and importing both the Mycodo settings database and InfluxDB measurement database has been added. These may be imported back into Mycodo at a later timer. Currently, the InfluxDB (measurement) database may be imported into any other version of Mycodo, and the Mycodo (settings) database may only be imported to the same version of Mycodo. Automatic upgrading or downgrading of the Mycodo database to allow cross-version compatibility will be included in a future release. For the meantime, if you need to restore Mycodo settings to a particular Mycodo version, you can do the following: download the tar.gz of the particular [Mycodo Release](https://github.com/kizniche/Mycodo/releases) compatible with your database backup, extract, install normally, import the Mycodo settings database, then perform an upgrade of Mycodo to the latest release.\n\n#### All users will be logged out during the upgrade\n\nAnother consequence of changing from Python 2 to 3 is current browser cookies will cause an error with the web user interface. Therefore, all users will be logged out after upgrading to >= 5.5.0. This will cause some strange behavior that may be misconstrued as a failed upgrade:\n \n 1. The upgrade log will not update during the upgrade. Give the upgrade ample time to finish, or monitor the upgrade log from the command line.\n \n 2. After the upgrade is successful, the upgrade log box on the Upgrade page will redirect to the login page. Do not log in through the log box, but rather refresh the entire page to be redirected to the login page.\n\n#### All Conditionals will be deactivated\n\nThe Conditional code has been refactored to make them more modular. Because some conditionals will need to be reconfigured before they will operate corectly, all conditionals have been deactivated. Therefore, after the upgrade, reconfigure them appropriately, then reactivate. Additionally, conditionals (for all controllers) have been moved to a new 'Function' page.\n\n#### OpenCV has been disabled\n\nA Python 3 compatible binary version of opencv, whoch doesn't require an extremely long (hours) compiling process, is unfortunately unavailable. Therefore, if you know of a library or module that can successfully acquire an image from your webcam (you have tested to work), create a [new issue](https://github.com/kizniche/Mycodo/issues/new) with the details of how you acquired the image and we can determine if the method can be integrated into Mycddo.\n\n### Features\n\n - Migrate from Python 2 to Python 3 ([#253](https://github.com/kizniche/mycodo/issues/253))\n - Migrate from apache2 (+mod_wsgi) to nginx (+gunicorn) ([#352](https://github.com/kizniche/mycodo/issues/352))\n - Add ability to export and import Mycodo (settings) database ([#348](https://github.com/kizniche/mycodo/issues/348))\n - Add ability to export and import Influxdb (measurements) database ([#348](https://github.com/kizniche/mycodo/issues/348))\n - Add size of each backup (in MB) on Backup Restore page\n - Add check to make sure there is enough free space before performing a backup/upgrade\n - Add dedicated, modular Conditional controller ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add PID and Math to input options of Conditionals\n\n### Bugfixes\n\n - Fix deleting Inputs ([#250](https://github.com/kizniche/mycodo/issues/250))\n - Fix 500 error if 1-wire support isn't enabled\n - Fix Edge Detection Input callback function missing required parameter\n - Fix LCD display of Output duty cycle\n - Fix email notification\n - Make Conditional email notification send after last Action to include all Actions in message\n\n### Miscellaneous\n\n - Disable the use of the opencv camera library\n - Update translations\n - Combine Input and Math pages to a new 'Data' page\n - Move Conditionals and PIDs to a new 'Function' page\n - Show tooltips by default\n\n\n## 5.4.19 (2017-12-15)\n\n### Features\n\n - Add ability to use other Math controller outputs as Math controller inputs\n - Add checks to ensure a measurement is selected for Gauges\n\n### Bugfixes\n\n - Fix not deleting associated Math Conditionals when a Math controller is deleted\n - Fix displaying LCD lines for Controllers/Measurements that no longer exist\n - Fix improper WBT input-checking for humidity math controller\n - Fix issue where Math controller could crash ([#335](https://github.com/kizniche/mycodo/issues/335))\n\n\n## 5.4.18 (2017-12-15)\n\n### Bugfixes\n\n - Fix error on Live page if no Math controllers exist ([#345](https://github.com/kizniche/mycodo/issues/345))\n\n\n## 5.4.17 (2017-12-14)\n\n### Features\n\n - Add Decimal Places option to LCD lines\n\n### Bugfixes\n\n - Fix Input conditional refresh upon settings change\n - Fix display of Math controllers with atypical measurements on Live page ([#343](https://github.com/kizniche/mycodo/issues/343))\n - Fix inability to use Math controller values with PID Controllers ([#343](https://github.com/kizniche/mycodo/issues/343))\n - Fix display of Math data on LCDs ([#343](https://github.com/kizniche/mycodo/issues/343))\n - Fix LCD Max Age only working for first line\n - Fix display of Math data on LCDs\n - Fix issue displaying some Graph page configurations\n - Fix issue with PID recording negative durations\n - Fix Date Methods ([#344](https://github.com/kizniche/mycodo/issues/344))\n\n### Miscellaneous\n\n - Place PID Controllers in a subcategory of new section called Function\n - Don't disable an LCD when an Input that's using it is disabled\n\n\n## 5.4.16 (2017-12-13)\n\n### Features\n\n - Add new Math controller type: Median\n - Add the ability to use Conditionals with Math controllers\n - Add ability to use Math Controllers with LCDs and PIDs\n - Add Math Controllers to Live page\n - Add Math and PID Controllers to Gauge measurement selection ([#342](https://github.com/kizniche/mycodo/issues/342))\n - Add \"None Found Last x Seconds\" to Conditional options (trigger action if a measurement was not found within the last x seconds)\n - Add Restart Daemon option to the Config menu\n - More detailed 'incorrect database version' error message on System Information page\n\n### Bugfixes\n\n - Fix measurement list length on Graph page\n - Fix PWM output display on Live page\n - Fix issue changing Gauge type ([#342](https://github.com/kizniche/mycodo/issues/342))\n - Fix display of multiplexer options for I2C devices\n - Fix display order of I2C busses on System Information page\n\n### Miscellaneous\n\n - Add new multiplexer overlay option to manual ([#184](https://github.com/kizniche/mycodo/issues/184))\n\n\n## 5.4.15 (2017-12-08)\n\n### Features\n\n - Add Math controller types: Humidity, Maximum, Minimum, and Verification ([#335](https://github.com/kizniche/mycodo/issues/335))\n\n### Bugfixes\n\n - Fix Atlas pH sensor calibration\n\n\n## 5.4.14 (2017-12-05)\n\n### Features\n\n - Add Math Controller (Math in menu) to perform math on Input data\n - Add first Math controller type: Average ([#328](https://github.com/kizniche/mycodo/issues/328))\n - Add fswebcam as a camera library for acquiring images from USB cameras\n - Complete Spanish translation\n - Update korean translations\n - Add more translatable texts\n - Make PIDs collapsible\n - Refactor daemon controller handling and daemonize threads\n\n### Bugfixes\n\n - Fix TCA9548A multiplexer channel issues ([#330](https://github.com/kizniche/mycodo/issues/330))\n - Fix selection of current language on General Config page\n - Fix saving options when adding a Timer\n - Fix Graph display of Lowering Output durations as negative values\n - Fix double-logging of output durations\n\n### Miscellaneous\n\n - Update Manual with Math Controller information\n\n\n## 5.4.11 (2017-11-29)\n\n### Bugfixes\n\n - Fix issue displaying Camera page\n\n\n## 5.4.10 (2017-11-28)\n\n### Features\n\n - Add display of all detected I2C devices on the System Information page\n\n### Bugfixes\n\n - Change web UI restart command\n - Fix issue saving Timer options ([#334](https://github.com/kizniche/mycodo/issues/334))\n - Fix Output Usage error\n\n\n## 5.4.9 (2017-11-27)\n\n### Bugfixes\n\n - Fix adding Gauges ([#333](https://github.com/kizniche/mycodo/issues/333))\n\n\n## 5.4.8 (2017-11-22)\n\n### Features\n\n - Add 1 minute, 5 minute, and 15 minute options to Graph Range Selector ([#319](https://github.com/kizniche/mycodo/issues/319))\n\n### Bugfixes\n\n - Fix AM2315 sensor measurement acquisition ([#328](https://github.com/kizniche/mycodo/issues/328))\n\n\n## 5.4.7 (2017-11-21)\n\n### Bugfixes\n\n - Fix flood of errors in the log if an LCD doesn't have a measurement to display\n - Fix LCD display being offset one character when displaying errors\n\n\n## 5.4.6 (2017-11-21)\n\n### Features\n\n - Add Max Age (seconds) to LCD line options\n - Make LCDs collapsable in the web UI\n\n### Bugfixes\n\n - Fix saving user theme ([#326](https://github.com/kizniche/mycodo/issues/326))\n\n\n## 5.4.5 (2017-11-21)\n\n### Features\n\n - Add Freqency, Duty Cycle, Pulse Width, RPM, and Linux Command variables to Conditional commands ([#311](https://github.com/kizniche/mycodo/issues/311)) (See [Input Conditional command variables](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.md#input-conditional-command-variables))\n - Add Graph options: Enable Auto Refresh, Enable Title, and Enable X-Axis Reset ([#319](https://github.com/kizniche/mycodo/issues/319))\n - Add automatic checks for Mycodo updates (can be disabled in the configuration)\n\n### Bugfixes\n\n - Fix Input Conditional variable\n\n\n## 5.4.4 (2017-11-19)\n\n### Features\n\n - Add 12-volt DC fan control circuit to manual (@Theoi-Meteoroi) ([#184](https://github.com/kizniche/mycodo/issues/184)) (See [Schematics for DC Fan Control](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.md#schematics-for-dc-fan-control))\n\n### Bugfixes\n\n - Fix PWM Signal, RPM Signal, DHT22, and DHT11 Inputs ([#324](https://github.com/kizniche/mycodo/issues/324))\n - Add Frequency, Duty Cycle, Pulse Width, and RPM to y-axis Graph display\n\n### Miscellaneous\n\n - Upgrade InfluxDB from 1.3.7 to 1.4.2\n\n\n## 5.4.3 (2017-11-18)\n\n### Bugfixes\n\n - Fix Output Conditional triggering ([#323](https://github.com/kizniche/mycodo/issues/323))\n \n\n## 5.4.2 (2017-11-18)\n\n### Features\n\n - Add Output Conditional If option of \"On (any duration)\" ([#323](https://github.com/kizniche/mycodo/issues/323)) (See [Output Conditional Statement If Options](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.md#output-conditional-statement-if-options))\n\n### Bugfixes\n\n - Fix display of first point of Daily Bezier method\n - Fix inability to use Daily Bezier method in PID ([#323](https://github.com/kizniche/mycodo/issues/323))\n - Fix saving Output options and turning Outputs On and Off\n\n\n## 5.4.1 (2017-11-17)\n\n### Features\n\n - Prevent currently-logged in user from: deleting own user, changing user role from Admin\n - Force iPhone to open Mycodo bookmark as standalone web app instead of in Safari\n - Refactor and add tests for all inputs ([#128](https://github.com/kizniche/mycodo/issues/128))\n - Add Flask-Limiter to limit authentication requests to 30 per minute (mainly for Remote Admin feature)\n - Add first working iteration of data acquisition to the Remote Admin dashboard\n - Add SSL certificate authentication with Remote Admin communication\n\n### Bugfixes\n\n - Fix inability to modify timer options ([#318](https://github.com/kizniche/mycodo/issues/318))\n\n### Miscellaneous\n\n - Rename objects (warning: this may break some things. I tried to be thorough with testing)\n - Switch from using init.d to systemd for controlling apache2\n\n\n## 5.4.0 (2017-11-12)\n\nThis release has refactored how LCD displays are handled, now allowing an infinite number of data sets on a single LCD.\n\nNote: All LDCs will be deactivated during the upgrade. As a consequence, LCD displays will need to be reconfigured and reactivated.\n\n***Note 2: During the upgrade, the web interface will display \"500 Internal Server Error.\" This is normal and you should give Mycodo 5 to 10 minutes (or longer) to complete the upgrade process before attempting to access the web interface again.***\n\n### Features\n\n - Add ability to cycle infinite sets of data on a single LCD display ([#316](https://github.com/kizniche/mycodo/issues/316))\n - Add logrotate script to manage mycodo logs\n\n### Bugfixes\n\n - Fix language selection being applied globally (each user now has own language)\n - Fix display of degree symbols on LCDs\n\n\n## 5.3.6 (2017-11-11)\n\n### Features\n\n - Allow camera options to be used for picamera library\n\n### Bugfixes\n\n - Fix inability to take a still image while a video stream is active\n - Make creating new user names case-insensitive\n - Fix theme not saving when creating a new user\n\n### Miscellaneous\n\n - Remove ability to change camera library after a camera has been added\n - Update Korean translation\n\n\n## 5.3.5 (2017-11-10)\n\n### Features\n\n - Add timestamp to lines of the upgrade/backup/restore logs\n - Add sensor measurement smoothing to Chirp light sensor (module will soon expand to all sensors)\n - Add ability to stream video from USB cameras\n - Add ability to stream video from several cameras at the same time\n\n### Bugfixes\n\n - Fix an issue loading the camera settings page without a camera connected\n - Fix video streaming with Pi Camera ([#228](https://github.com/kizniche/mycodo/issues/228))\n\n### Miscellaneous\n\n - Split flaskform.py and flaskutils.py into smaller files for easier management\n\n\n## 5.3.4 (2017-11-06)\n\nNote: The Chirp light sensor scale has been inverted. Please adjust your settings accordingly to respond to 0 as darkness and 65535 as bright.\n\n### Features\n\n - Replace deprecated LockFile with fasteners ([#260](https://github.com/kizniche/mycodo/issues/260))\n - Add Timer type: PWM duty cycle output using Method ([#262](https://github.com/kizniche/mycodo/issues/262)), read more: [PWM Method](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.md#pwm-method)\n\n### Bugfixes\n\n - Fix display of PID setpoints on Graphs\n - Invert Chirp light sensor scale (0=dark, 65535=bright)\n\n### Miscellaneous\n\n - Update Korean translations\n - Add 2 more significant digits to ADC voltage measurements\n - Upgrade InfluxDB to v1.3.7\n\n\n## 5.3.3 (2017-10-29)\n\n### Features\n\n - Add Sample Time option to PWM and RPM Input options ([#302](https://github.com/kizniche/mycodo/issues/302))\n\n### Bugfixes\n\n - Fix issues with PWM and RPM Inputs ([#306](https://github.com/kizniche/mycodo/issues/306))\n\n\n## 5.3.2 (2017-10-28)\n\n### Features\n\n - Turning Outputs On or Off no longer refreshes the page ([#192](https://github.com/kizniche/mycodo/issues/192))\n\n### Bugfixes\n\n - Fix exporting measurements\n - Fix Live Data page displaying special characters ([#304](https://github.com/kizniche/mycodo/issues/304))\n - Fix PWM and RPM Input issues ([#302](https://github.com/kizniche/mycodo/issues/302))\n\n## 5.3.1 (2017-10-27)\n\n### Features\n\n - Add two new Inputs: PWM and RPM ([#302](https://github.com/kizniche/mycodo/issues/302))\n - Allow a PID to use both Relay and PWM Outputs ([#303](https://github.com/kizniche/mycodo/issues/303))\n\n\n## 5.3.0 (2017-10-24)\n\n#### ***IMPORTANT***\n\nBecause of a necessary database schema change, this update will deactivate all PID controllers and deselect the input measurement. All PID controllers will need the input measurement reconfigured before they can be started again.\n\n### Features\n\nInput and Output Conditional commands may now include variables. There are 23 variables currently-supported. See [Conditional Statement variables](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.md#conditional-statement-variables) for details.\n\n - Add new Input type: Linux Command (measurement is the return value of an executed command) ([#264](https://github.com/kizniche/mycodo/issues/264))\n - Refactor PID input option to allow new input and simplify PID configuration\n - Add ability to select LCD I2C bus ([#300](https://github.com/kizniche/mycodo/issues/300))\n - Add ADC Option to Inverse Scale ([#297](https://github.com/kizniche/mycodo/issues/300))\n - Add ability to use variables in Input/Output Conditional commands\n\n### Bugfixes\n\n - Fix \"Too many files open\" error when using the TSL2591 sensor ([#254](https://github.com/kizniche/mycodo/issues/254))\n - Fix bug that had the potential to lose data with certain graph display configurations\n - Prevent more than one active PID from using the same output ([#108](https://github.com/kizniche/mycodo/issues/108))\n - Prevent a PID from using the same Raise and Lower output\n - Prevent a currently-active PID from changing the output to a currently-used output\n\n### Miscellaneous\n\n - Update Readme and Wiki to fix outdated and erroneous information and improve coverage ([#285](https://github.com/kizniche/mycodo/issues/285))\n\n\n## 5.2.5 (2017-10-14)\n\n### Features\n\n - Add another status indicator color (top-left of web UI): Orange: unable to connect to daemon\n\n### Bugfixes\n\n - Fix Asynchronous Graphs ([#296](https://github.com/kizniche/mycodo/issues/296))\n - Disable sensor tests to fix testing environment (will add later when the issue is diagnosed)\n\n\n## 5.2.4 (2017-10-05)\n\n### Features\n\n - Add ability to set time to end repeating duration method\n\n\n## 5.2.3 (2017-09-29)\n\n### Bugfixes\n\n - Fix issues with method repeat option\n\n\n## 5.2.2 (2017-09-27)\n\n### Features\n\n - Add 'restart from beginning' option to PID duration methods\n \n### Bugfixes\n\n - Fix adding new graphs\n\n\n## 5.2.1 (2017-09-21)\n\n### Bugfixes\n\n - Fix changing a gauge from angular to solid ([#274](https://github.com/kizniche/mycodo/issues/274))\n\n\n## 5.2.0 (2017-09-17)\n\n### Features\n\n - Add gauges to Live Graphs ([#274](https://github.com/kizniche/mycodo/issues/274))\n\n\n## 5.1.10 (2017-09-12)\n\n### Bugfixes\n\n - Fix issue reporting issue with the web UI communicating with the daemon ([#291](https://github.com/kizniche/mycodo/issues/291))\n\n\n## 5.1.9 (2017-09-07)\n\n### Features\n\n - Enable daemon monitoring script (cron @reboot) to start the daemon if it stops\n\n### Bugfixes\n\n - Potential fix for certain sensor initialization issues when using a multiplexer ([#290](https://github.com/kizniche/mycodo/issues/290))\n - Handle connection error when the web interface cannot connect to the daemon/relay controller ([#289](https://github.com/kizniche/mycodo/issues/289))\n\n\n## 5.1.8 (2017-08-29)\n\n### Bugfixes\n\n - Fix saving relay start state ([#289](https://github.com/kizniche/mycodo/issues/289))\n\n\n## 5.1.7 (2017-08-29)\n\n### Bugfixes\n\n - Fix MH-Z16 sensor issues in I2C read mode ([#281](https://github.com/kizniche/mycodo/issues/281))\n - Fix Atlas Scientific I2C device query response in the event of an error\n - Fix issue preventing PID from using duration Methods\n - Fix issue with PID starting a method again after it has already ended\n - Fix TSL2591 sensor ([#257](https://github.com/kizniche/mycodo/issues/257))\n - Fix saving relay trigger state ([#289](https://github.com/kizniche/mycodo/issues/289))\n\n\n## 5.1.6 (2017-08-11)\n\n### Features\n\n - Add MH-Z16 sensor module ([#281](https://github.com/kizniche/mycodo/issues/281))\n\n\n## 5.1.5 (2017-08-11)\n\n### Bugfixes\n\n - Fix MH-Z19 sensor module ([#281](https://github.com/kizniche/mycodo/issues/281))\n\n\n## 5.1.4 (2017-08-11)\n\n### Features\n\n - Update InfluxDB (v1.3.3) and pip packages\n\n### Bugfixes\n\n - Fix K30 sensor module ([#279](https://github.com/kizniche/mycodo/issues/279))\n\n\n## 5.1.3 (2017-08-10)\n\n### Bugfixes\n\n - Fix install issue in setup.sh install script (catch 1-wire error if not enabled) ([#258](https://github.com/kizniche/mycodo/issues/258))\n\n\n## 5.1.2 (2017-08-09)\n\n### Bugfixes\n\n - Fix new timers not working ([#284](https://github.com/kizniche/mycodo/issues/284))\n\n\n## 5.1.1 (2017-08-09)\n\n### Features\n\n - Add live display of upgrade log during upgrade\n \n### Bugfixes\n\n - Fix setup bug preventing database creation ([#277](https://github.com/kizniche/mycodo/issues/277), [#278](https://github.com/kizniche/mycodo/issues/278), [#283](https://github.com/kizniche/mycodo/issues/283))\n\n\n## 5.1.0 (2017-08-07)\n\nSome graphs will need to be manually reconfigured after upgrading to 5.1.0. This is due to adding PWM as an output and PID option, necessitating refactoring certain portions of code related to graph display.\n\n### Features\n\n - Add PWM support as output ([#262](https://github.com/kizniche/mycodo/issues/262))\n - Add PWM support as PID output\n - Add min and max duty cycle options to PWM PID\n - Add \"Max Amps\" as a general configuration option\n - Improve error reporting for devices and sensors\n - Add ability to power-cycle the DHT11 sensor if 3 consecutive measurements cannot be retrieved (uses power relay option) ([#273](https://github.com/kizniche/mycodo/issues/273))\n - Add MH-Z19 CO2 sensor\n\n### Bugfixes\n\n - Upgrade to InfluxDB 1.3.1 ([#8500](https://github.com/influxdata/influxdb/issues/8500) - fixes InfluxDB going unresponsive)\n - Fix K30 sensor module\n\n\n## 5.0.49 (2017-07-13)\n\n### Bugfixes\n\n - Move relay_usage_reports directory to new version during upgrade\n - Fix LCD display of PID setpoints with long float values (round two decimal places)\n - Fix geocoder issue\n\n\n## 5.0.48 (2017-07-11)\n\n### Features\n\n - Add power relay to AM2315 sensor configuration ([#273](https://github.com/kizniche/mycodo/issues/273))\n\n\n## 5.0.47 (2017-07-09)\n\n### Bugfixes\n\n - Fix upgrade script\n\n\n## 5.0.46 (2017-07-09)\n\n### Bugfixes\n\n - Fix upgrade initialization to include setting permissions\n\n\n## 5.0.45 (2017-07-07)\n\n### Bugfixes\n\n - Fix minor bug that leaves the .upgrade file in a backup, causing issue with upgrading after a restore\n\n\n## 5.0.44 (2017-07-06)\n\n### Bugfixes\n\n - Fix issues with restore functionality (still possibly buggy: use at own risk)\n\n\n## 5.0.43 (2017-07-06)\n\n### Bugfixes\n\n - Fix issues with restore functionality (still possibly buggy: use at own risk)\n\n\n## 5.0.42 (2017-07-06)\n\n### Features\n\n - Update InfluxDB to 1.3.0\n - Update pip package (geocoder)\n\n\n## 5.0.41 (2017-07-06)\n\n### Features\n\n - Add ability to restore backup (Warning: Experimental feature, not thoroughly tested)\n - Add ability to view the backup log on View Logs page\n - Add script to check if daemon uncleanly shut down during upgrade and remove stale PID file ([#198](https://github.com/kizniche/mycodo/issues/198))\n\n### Bugfixes\n\n - Fix error if country cannot be detected for anonymous statistics\n\n\n## 5.0.40 (2017-07-03)\n\n### Bugfixes\n\n - Fix install script error ([#253](https://github.com/kizniche/mycodo/issues/253))\n - Fix issue modulating relays if a conditionals using them are not properly configured ([#266](https://github.com/kizniche/mycodo/issues/266))\n\n\n## 5.0.39 (2017-06-27)\n\n### Bugfixes\n\n - Fix upgrade process\n\n\n## 5.0.38 (2017-06-27)\n\n### Bugfixes\n\n - Fix install script\n\n\n## 5.0.37 (2017-06-27)\n\n### Bugfixes\n\n - Change wiringpi during install\n\n\n## 5.0.36 (2017-06-27)\n\n### Features\n\n - Add ability to create a Mycodo backup\n - Add ability to delete a Mycodo backup\n - Remove mycodo-wrapper binary in favor of compiling it from source code during install/upgrade\n\n### Bugfixes\n\n - Fix issue with influxdb database and user creation during install ([#255](https://github.com/kizniche/mycodo/issues/255))\n \n### Work in progress\n\n - Add ability to restore a Mycodo backup\n\n\n## 5.0.35 (2017-06-18)\n\n### Bugfixes\n\n - Fix swap size check (and change to 512 MB) to permit pi_switch module compilation size requirement ([#258](https://github.com/kizniche/mycodo/issues/258))\n\n\n## 5.0.34 (2017-06-18)\n\n### Features\n\n - Add TSL2591 luminosity sensor ([#257](https://github.com/kizniche/mycodo/issues/257))\n - Update sensor page to more compact style\n\n### Bugfixes\n\n - Append setup.sh output to setup.log instead of overwriting ([#255](https://github.com/kizniche/mycodo/issues/255))\n - Fix display of error response when attempting to modify timer when it's active\n\n\n## 5.0.33 (2017-06-05)\n\n### Features\n\n - Add new relay type: Execute Commands (executes linux commands to turn the relay on and off)\n\n### Bugfixes\n\n - Fix query of ADC unit data (not voltage) from influxdb\n \n### Miscellaneous\n\n - Update influxdb to version 1.2.4\n - Update pip packages\n - Update Manual\n - Update translatable texts\n\n\n## 5.0.32 (2017-06-02)\n\n### Bugfixes\n\n - Fix display of PID output and setpoint on live graphs ([#252](https://github.com/kizniche/mycodo/issues/252))\n\n\n## 5.0.31 (2017-05-31)\n\n### Features\n\n - Add option to not turn wireless relay on or off at startup\n\n### Bugfixes\n\n - Fix inability to save SHT sensor options ([#251](https://github.com/kizniche/mycodo/issues/251))\n - Fix inability to turn relay on if another relay is unconfigured ([#251](https://github.com/kizniche/mycodo/issues/251))\n\n\n## 5.0.30 (2017-05-23)\n\n### Bugfixes\n\n - Fix display of proper relay status if pin is 0\n\n\n## 5.0.29 (2017-05-23)\n\n### Features\n\n - Relay and Timer page style improvements\n\n### Bugfixes\n\n - Add influxdb query generator with input checks\n\n\n## 5.0.28 (2017-05-23)\n\n### Features\n\n  - Add support for Atlas Scientific pH Sensor ([#238](https://github.com/kizniche/mycodo/issues/238))\n  - Add support for calibrating the Atlas Scientific pH sensor\n  - Add UART support for Atlas Scientific PT-1000 sensor\n  - Update Korean translations\n  - Add measurement retries upon CRC fail for AM2315 sensor ([#246](https://github.com/kizniche/mycodo/issues/246))\n  - Add page error handler that provides full traceback when the Web UI crashes\n  - Display live pH measurements during pH sensor calibration\n  - Add ability to clear calibration data from Atlas Scientific pH sensors\n  - Add sensor option to calibrate Atlas Scientific pH sensor with the temperature from another sensor before measuring pH\n  - Add 433MHz wireless transmitter/receiver support for relay actuation ([#88](https://github.com/kizniche/mycodo/issues/88), [#245](https://github.com/kizniche/mycodo/issues/245))\n\n### Bugfixes\n\n  - Fix saving of proper start time during timer creation ([#248](https://github.com/kizniche/mycodo/issues/248))\n  - Fix unicode error when generating relay usage reports\n\n\n## 5.0.27 (2017-04-12)\n\n### Bugfixes\n\n  - Fix issue with old database entries and new graph page parsing\n  - Revert to old relay form submission method (ajax method broken)\n\n\n## 5.0.26 (2017-04-12)\n\n### Bugfixes\n\n  - Fix critical issue with upgrade script\n\n\n## 5.0.25 (2017-04-12)\n\n### Bugfixes\n\n  - Fix setting custom graph colors\n\n\n## 5.0.24 (2017-04-12)\n\n### Features\n\n  - Add toastr and ajax support for submitting forms without refreshing the page (currently only used with relay On/Off/Duration buttons) ([#70](https://github.com/kizniche/mycodo/issues/70))\n\n### Bugfixes\n\n  - Fix issue with changing ownership of SSL certificates during install ([#240](https://github.com/kizniche/mycodo/issues/240))\n  - Fix PID Output not appearing when adding new graph (modifying graph works)\n  - Remove ineffective upgrade reversion script (reversion was risky)\n\n\n## 5.0.23 (2017-04-10)\n\n### Features\n\n  - Add PID Output as a graph display option (useful for tuning PID controllers)\n\n### Bugfixes\n\n  - Fix display of unicode characters ([#237](https://github.com/kizniche/mycodo/issues/237))\n\n\n## 5.0.22 (2017-04-08)\n\n### Features\n\n  - Add sensor conditional: emailing of photo or video (video only supported by picamera library at the moment) ([#226](https://github.com/kizniche/mycodo/issues/226))\n\n### Bugfixes\n\n  - Fix inability to display Sensor page if unable to detect DS18B20 sensors ([#236](https://github.com/kizniche/mycodo/issues/236))\n  - Fix inability to disable relay during camera capture\n  - Fix SSL generation script and strengthen from 2048 bit to 4096 bit RSA ([#234](https://github.com/kizniche/mycodo/issues/234))\n\n### Miscellaneous\n\n  - New cleaner Timer page style\n\n\n## 5.0.21 (2017-04-02)\n\n### Bugfixes\n\n  - Fix BMP280 sensor module initialization ([#233](https://github.com/kizniche/mycodo/issues/233))\n  - Fix saving and display of PID and Relay values on LCDs\n\n\n## 5.0.20 (2017-04-02)\n\n### Bugfixes\n\n  - Fix BMP280 sensor module initialization\n  - Fix saving and display of PID and Relay values on LCDs\n  - Fix inability to select certain measurements for a sensor under the PID options\n\n\n## 5.0.19 (2017-04-02)\n\n### Bugfixes\n\n  - Fix BMP280 sensor I<sup>2</sup>C address options ([#233](https://github.com/kizniche/mycodo/issues/233))\n\n\n## 5.0.18 (2017-04-01)\n\n### Features\n\n  - Add BMP280 I2C temperature and pressure sensor ([#233](https://github.com/kizniche/mycodo/issues/233))\n\n\n## 5.0.17 (2017-03-31)\n\n### Bugfixes\n\n  - Fix issue with graph page crashing when non-existent sensor referenced ([#232](https://github.com/kizniche/mycodo/issues/232))\n\n\n## 5.0.16 (2017-03-30)\n\n### Features\n\n  - New Mycodo Manual rendered in markdown, html, pdf, and plain text\n\n### Bugfixes\n\n  - Fix BME280 sensor module to include calibration code (fixes \"stuck\" measurements)\n  - Fix issue with graph page crashing when non-existent sensor referenced ([#231](https://github.com/kizniche/mycodo/issues/231))\n\n\n## 5.0.15 (2017-03-28)\n\n### Bugfixes\n\n  - Fix issue with graph page errors when creating a graph with PIDs or Relays\n  - Fix sensor conditional measurement selections ([#230](https://github.com/kizniche/mycodo/issues/230))\n  - Fix inability to stream video from a Pi camera ([#228](https://github.com/kizniche/mycodo/issues/228))\n  - Fix inability to delete LCD ([#229](https://github.com/kizniche/mycodo/issues/229))\n  - Fix measurements export\n  - Fix display of BMP and BH1750 sensor measurements in sensor lists (graphs/export)\n\n### Miscellaneous\n\n  - Better exception-handling (clean up logging of influxdb measurement errors)\n\n\n## 5.0.14 (2017-03-25)\n\n### Features\n\n  - Add BH1750 I2C light sensor ([#224](https://github.com/kizniche/mycodo/issues/224))\n\n### Bugfixes\n\n  - Change default opencv values for new cameras ([#225](https://github.com/kizniche/mycodo/issues/225))\n  - Fix relays not recording proper ON duration (which causes other issues) ([#223](https://github.com/kizniche/mycodo/issues/223))\n  - Fix new graphs occupying 100% width (12/12 columns)\n\n\n## 5.0.13 (2017-03-24)\n\n### Bugfixes\n\n  - Fix issue with adding/deleting relays\n  - Fix inability to have multiple graphs appear on the same row\n  - Fix UnicodeEncodeError when using translations\n  - Fix BME280 sensor pressure/altitude\n\n\n## 5.0.12 (2017-03-23)\n\n### Bugfixes\n\n  - Fix frontend and backend issues with conditionals\n\n\n## 5.0.11 (2017-03-22)\n\n### Bugfixes\n\n  - Fix alembic database upgrade error (hopefully)\n\n\n## 5.0.10 (2017-03-22)\n\n### Bugfixes\n\n  - Fix photos being taken uncontrollably when a time-lapse is active\n\n\n## 5.0.9 (2017-03-22)\n\n### Bugfixes\n\n  - Update geocoder to 1.21.0 to attempt to resolve issue\n  - Fix creation of alembic version number in database of new install\n  - Add suffixes to distinguish Object from Die temperatures of TMP006 sensor on Live page\n  - Fix reference to pybabel in virtualenv\n\n\n## 5.0.8 (2017-03-22)\n\n### Features\n\n  - Add option to hide tooltips\n\n### Bugfixes\n\n  - Add alembic upgrade check as a part of flask app startup\n  - Fix reference to alembic for database upgrades\n  - Fix photos being taken uncontrollably when a time-lapse is active\n  - Show edge measurements as vertical bars instead of lines on graphs\n  - Fix default image width/height when adding cameras\n  - Prevent attempting to setup a relay at startup if the GPIO pin is < 1\n  - Add coverage where DHT22 sensor could be power cycled to fix an inability to acquire measurements\n  - Display the device name next to each custom graph color\n  - Fix encoding error when collecting anonymous statistics ([#216](https://github.com/kizniche/mycodo/issues/216))\n\n### Miscellaneous\n\n  - Update Influxdb to version 1.2.2\n  - UI style improvements\n\n\n## 5.0.7 (2017-03-19)\n\n### Bugfixes\n\n  - Fix pybabel reference during install/upgrade ([#212](https://github.com/kizniche/mycodo/issues/212))\n\n\n## 5.0.6 (2017-03-19)\n\n### Bugfixes\n\n  -  Fix edge detection conditional statements ([#214](https://github.com/kizniche/mycodo/issues/214))\n  -  Fix identification and conversion of dewpoint on live page ([#215](https://github.com/kizniche/mycodo/issues/215))\n\n\n## 5.0.5 (2017-03-18)\n\n### Bugfixes\n\n  - Fix issue with timers not actuating relays ([#213](https://github.com/kizniche/mycodo/issues/213))\n\n\n## 5.0.4 (2017-03-18)\n\n### Bugfixes\n\n  - Fix issues with saving LCD options ([#211](https://github.com/kizniche/mycodo/issues/211))\n\n\n## 5.0.0 (2017-03-18)\n\n### Bugfixes\n\n  - Fixes inability of relay conditionals to operate ([#209](https://github.com/kizniche/mycodo/issues/209), [#210](https://github.com/kizniche/mycodo/issues/210))\n  - Fix issue with user creation/deletion in web UI\n  - Fix influxdb being unreachable directly after package install\n\n### Features\n\n  - Complete Spanish translation\n  - Add auto-generation of relay usage/cost reports on a daily, weekly, or monthly schedule\n  - Add ability to check daemon health (mycodo_client.py --checkdaemon)\n  - Add sensor conditional actions: Activate/Deactivate PID, Email Photo, Email Video\n  - Add PID option: maximum allowable sensor measurement age (to allow the PID controller to manipulate relays, the sensor measurement must have occurred in the past x seconds)\n  - Add PID option: minimum off duration for lower/raise relay (protects devices that require a minimum off period by preventing power cycling from occurring too quickly)\n  - Add new sensor: Free Disk Space (of a set path)\n  - Add new sensor: Mycodo Daemon RAM Usage (used for testing)\n  - Add ability to use multiple camera configurations (multiple cameras)\n  - Add OpenCV camera library to allow use of USB cameras ([#193](https://github.com/kizniche/mycodo/issues/193))\n  - Automatically detect DS18B20 sensors in sensor configuration\n  - Add ability to create custom user roles\n  - Add new user roles: Editor and Monitor ([#46](https://github.com/kizniche/mycodo/issues/46))\n\n### Miscellaneous\n\n  - Mobile display improvements\n  - Improve content and accessibility of help documentation\n  - Redesign navigation menu (including glyphs from bootstrap and fontawesome)\n  - Move to using a Python virtual environment ([#203](https://github.com/kizniche/mycodo/issues/203))\n  - Refactor the relay/sensor conditional management system\n  - User names are no longer case-sensitive\n  - Switch to using Flask-Login\n  - Switch to using flask_wtf.FlaskForm (from using deprecated flask_wtf.Form)\n  - Update web interface style and layout\n  - Update influxdb to 1.2.1\n  - Update Flask WTF to 0.14.2\n  - Move from using sqlalchemy to flask sqlalchemy\n  - Restructure database ([#115](https://github.com/kizniche/mycodo/issues/115), [#122](https://github.com/kizniche/mycodo/issues/122))\n\n\n## 4.2.0 (2017-03-16)\n\n### Features\n\n  - Add ability to turn a relay on for a specific duration of time\n  - Update style of Timer and Relay pages (mobile-compatibility)\n\n\n## 4.1.16 (2017-02-05)\n\n### Bugfixes\n\n  - Revert back to influxdb 1.1.1 to fix LCD time display ([#7877](https://github.com/influxdata/influxdb/issues/7877) will fix, when released)\n  - Fix influxdb not restarting after a new version is installed\n  - Fix issue with relay conditionals being triggered upon shutdown\n  - Fix asynchronous graph to use local timezone rather than UTC ([#185](https://github.com/kizniche/mycodo/issues/185))\n\n### Miscellaneous\n\n  - Remove archived versions of Mycodo (Mycodo/old) during upgrade (saves space during backup)\n\n\n## 4.1.15 (2017-01-31)\n\n### Bugfixes\n\n  - Fix LCD KeyError from missing measurement unit for durations_sec\n\n\n## 4.1.14 (2017-01-30)\n\n### Bugfixes\n\n  - Fix DHT11 sensor module ([#176](https://github.com/kizniche/mycodo/issues/176))\n\n### Miscellaneous\n\n  - Update influxdb to 1.2.0\n\n\n## 4.1.13 (2017-01-30)\n\n### Bugfixes\n\n  - Fix DHT11 sensor module ([#176](https://github.com/kizniche/mycodo/issues/176))\n\n\n## 4.1.12 (2017-01-30)\n\n### Bugfixes\n\n  - Fix PID controller crash\n\n\n## 4.1.11 (2017-01-30)\n\nThis is a small update, mainly to fix the install script. It also *should* fix the DHT11 sensor module from stopping at the first bad checksum.\n\n### Bugfixes\n\n  - Fix DHT11 sensor module, removing exception preventing acquisition of future measurements ([#176](https://github.com/kizniche/mycodo/issues/176))\n  - Fix setup.sh install script by adding git as a dependency ([#183](https://github.com/kizniche/mycodo/issues/183))\n  - Fix initialization script executed during install and upgrade\n\n\n## 4.1.10 (2017-01-29)\n\n### Bugfixes\n\n  - Fix PID variable initializations\n  - Fix KeyError in controller_lcd.py\n  - Fix camera termination bug ([#178](https://github.com/kizniche/mycodo/issues/178))\n  - Fix inability to pause/hold/resume PID controllers\n\n### Miscellaneous\n\n  - Add help text for conditional statements to relay page ([#181](https://github.com/kizniche/mycodo/issues/181))\n\n\n## 4.1.9 (2017-01-27)\n\nThis update fixes two major bugs: Sometimes admin users not being created properly from the web UI and the daemon not being set to automatically start during install.\n\nThis update also fixes an even more severe bug affecting the database upgrade system. If you installed a system before this upgrade, you are probably affected. This release will display a message indicating if your database has an issue. Deleting ~/Mycodo/databases/mycodo.db and restarting the web server (or reboot) will regenerate the database.\n\nIf your daemon doesn't automatically start because you installed it with a botched previous version, issue the following commands to add it to systemctl's autostart:\n\n***Important***: Make sure you rename 'user' below to your actual user where you installed Mycodo, and make sure the Mycodo install directory is correct and points to the correct mycodo.service file.\n\n```\nsudo service mycodo stop\nsudo systemctl disable mycodo.service\nsudo rm -rf /etc/systemd/system/mycodo.service\nsudo systemctl enable /home/user/Mycodo/install/mycodo.service\nsudo service mycodo start\n```\n\n### Features\n\n  - Add check for problematic database and notify user how to fix it\n  - Add ability to define the colors of lines on general graphs ([#161](https://github.com/kizniche/mycodo/issues/161))\n\n### Bugfixes\n\n  - Update install instructions to correct downloading the latest release tarball\n  - Fix for database upgrade bug that has been plaguing Mycodo for the past few releases\n  - Fix incorrect displaying of graphs with relay or PID data\n  - Fix relay turning off when saving relay settings and GPIO pin doesn't change\n  - Fix bug that crashes the daemon if the user database is empty\n  - Fix Spanish translation file errors\n  - Fix mycodo daemon not automatically starting after install\n  - Fix inability to create admin user from the web interface\n  - Fix inability to delete methods\n  - Fix Atlas PT100 sensor module 'invalid literal for float()' error\n  - Fix camera termination bug ([#178](https://github.com/kizniche/mycodo/issues/178))\n\nMiscellaneous\n\n  - Add new theme: Sun\n\n\n## 4.1.8 (2017-01-21)\n\n### Bugfixes\n\n  - Actually fix the upgrade system (mycodo_wrapper)\n  - Fix bug in DHT22 sensor module preventing measurements\n  - Fix inability to show latest time-lapse image on the camera page (images are still being captured)\n\n### Miscellaneous\n\n  - Update Spanish translations\n\n\n## 4.1.7 (2017-01-19)\n\n### Bugfixes\n\n  - Fix upgrade system (mycodo_wrapper). This may have broke the upgrade system (if so, use the manual method in the README)\n  - Fix time-lapses not resuming after an upgrade\n  - Fix calculation of total 1-month relay usage and cost\n  - Fix (and modify) the logging behavior in modules\n  - Fix K30 sensor module returning None as a measurement value\n  - Fix gpiod being added to crontab during install from setup.sh ([#174](https://github.com/kizniche/mycodo/issues/174))\n\n\n## 4.1.6 (2017-01-17)\n\n### Features\n\n  - Add ability to export selected measurement data (in CSV format) from a date/time span\n\n### Bugfixes\n\n  - Fix issue with setup.sh when the version of wget<1.16 ([#173](https://github.com/kizniche/mycodo/issues/173))\n  - Fix error calculating rely usage when it's currently the billing day of the month\n\n### Miscellaneous\n\n  - Remove Sensor Logs (Tools/Sensor Logs). The addition of the measurement export feature in this release deprecates Sensor Logs. Note that by the very nature of how the Sensor Log controllers were designed, there was a high probability of missing measurements. The new measurement export feature ensures all measurements are exported.\n  - Add more translatable text\n  - Add password repeat input when creating new admin user\n\n\n## 4.1.5 (2017-01-14)\n\n### Bugfixes\n\n  - Fix DHT11 sensor module not returning values ([#171](https://github.com/kizniche/mycodo/issues/171))\n  - Fix HTU21D sensor module not returning values ([#172](https://github.com/kizniche/mycodo/issues/172))\n\n\n## 4.1.4 (2017-01-13)\n\nThis release introduces a new method for upgrading Mycodo to the latest version. Upgrades will now be performed from github releases instead of commits, which should prevent unintended upgrades to the public, facilitate bug-tracking, and enable easier management of a changelog.\n\n### Performance\n\n  - Add ability to hold, pause and resume PID controllers\n  - Add ability to modify PID controller parameters while active, held, or paused\n  - New method of processing data on live graphs that is more accurate and reduced bandwidth\n  - Install numpy binary from apt instead of compiling with pip\n\n### Features\n\n  - Add ability to set the language of the web user interface ([#167](https://github.com/kizniche/mycodo/issues/167))\n  - Add Spanish language translation\n  - New upgrade system to perform upgrades from github releases instead of commits\n  - Allow symbols to be used in a user password ([#76](https://github.com/kizniche/mycodo/issues/76))\n  - Introduce changelog (CHANGELOG.md)\n\n### Bugfixes\n\n  - Fix inability to update long-duration relay times on live graphs\n  - Fix dew point being incorrectly inserted into the database\n  - Fix inability to start video stream ([#155](https://github.com/kizniche/mycodo/issues/155))\n  - Fix SHT1x7x sensor module not returning values ([#159](https://github.com/kizniche/mycodo/issues/159))\n\n### Miscellaneous\n\n  - Add more software tests\n  - Update Flask to v0.12\n  - Update InfluxDB to v1.1.1\n  - Update factory_boy to v2.8.1\n  - Update sht_sensor to v16.12.1\n  - Move install files to Mycodo/install\n\n\n## 4.0.26 (2016-11-23)\n\n### Features\n\n  - Add more I2C LCD address options (again)\n  - Add Fahrenheit conversion for temperatures on /live page\n  - Add github issue template ([#150](https://github.com/kizniche/mycodo/issues/150) [#151](https://github.com/kizniche/Mycodo/pull/151))\n  - Add information to the README about performing manual backup/restore\n  - Add universal sensor tests\n\n### Bugfixes\n\n  - Fix code warnings and errors\n  - Add exceptions, logging, and docstrings\n\n\n## 4.0.25 (2016-11-13)\n\n### Features\n\n  - New create admin user page if no admin user exists\n  - Add support for [Chirp soil moisture sensor](https://wemakethings.net/chirp/)\n  - Add more I2C LCD address options\n  - Add endpoint tests\n  - Add use of [Travis CI](https://travis-ci.org/) and [Codacy](https://www.codacy.com/)\n\n### Bugfixes\n\n  - Fix controller crash when using a 20x4 LCD ([#136](https://github.com/kizniche/mycodo/issues/136))\n  - Add short sleep() to login to reduce chance of brute-force success\n  - Fix code warnings and errors\n\n\n## 4.0.24 (2016-10-26)\n\n### Features\n\n  - Setup flask app using new create_app() factory\n  - Create application factory and moved view implementation into a general blueprint ([#129](https://github.com/kizniche/mycodo/issues/129) [#132](https://github.com/kizniche/Mycodo/pull/132) [#142](https://github.com/kizniche/Mycodo/pull/142))\n  - Add initial fixture tests\n\n\n## 4.0.23 (2016-10-18)\n\n### Performance\n\n  - Improve time-lapse capture method\n\n### Features\n\n  - Add BME280 sensor\n  - Create basic tests for flask app ([#112](https://github.com/kizniche/mycodo/issues/122))\n  - Relocated Flask UI into its own package ([#116](https://github.com/kizniche/Mycodo/pull/116))\n  - Add DB session fixtures; create model factories\n  - Add logging of relay durations that are turned on and off, without a known duration\n  - Add ability to define power billing cycle day, AC voltage, cost per kWh, and currency unit for relay usage statistics\n  - Add more Themes\n  - Add hostname to UI page title\n\n### Bugfixes\n\n  - Fix relay conditionals when relays turn on for durations of time ([#123](https://github.com/kizniche/mycodo/issues/123))\n  - Exclude photo/video directories from being backed up during upgrade\n  - Removed unused imports\n  - Changed print statements to logging statements\n  - Fix inability to save sensor settings ([#120](https://github.com/kizniche/mycodo/issues/120) [#134](https://github.com/kizniche/mycodo/issues/134))\n", "# coding=utf-8\nimport calendar\nimport datetime\nimport logging\nimport subprocess\nimport time\nfrom importlib import import_module\n\nimport flask_login\nimport os\nfrom dateutil.parser import parse as date_parse\nfrom flask import Response\nfrom flask import flash\nfrom flask import jsonify\nfrom flask import redirect\nfrom flask import send_file\nfrom flask import send_from_directory\nfrom flask import url_for\nfrom flask.blueprints import Blueprint\nfrom flask_babel import gettext\nfrom flask_limiter import Limiter\nfrom influxdb import InfluxDBClient\nfrom sqlalchemy import and_\n\nfrom mycodo.config import DOCKER_CONTAINER\nfrom mycodo.config import INFLUXDB_DATABASE\nfrom mycodo.config import INFLUXDB_HOST\nfrom mycodo.config import INFLUXDB_PASSWORD\nfrom mycodo.config import INFLUXDB_PORT\nfrom mycodo.config import INFLUXDB_USER\nfrom mycodo.config import INSTALL_DIRECTORY\nfrom mycodo.config import LOG_PATH\nfrom mycodo.config import PATH_CAMERAS\nfrom mycodo.config import PATH_NOTE_ATTACHMENTS\nfrom mycodo.databases.models import Camera\nfrom mycodo.databases.models import Conversion\nfrom mycodo.databases.models import DeviceMeasurements\nfrom mycodo.databases.models import Input\nfrom mycodo.databases.models import Math\nfrom mycodo.databases.models import NoteTags\nfrom mycodo.databases.models import Notes\nfrom mycodo.databases.models import Output\nfrom mycodo.databases.models import OutputChannel\nfrom mycodo.databases.models import PID\nfrom mycodo.devices.camera import camera_record\nfrom mycodo.mycodo_client import DaemonControl\nfrom mycodo.mycodo_flask.routes_authentication import clear_cookie_auth\nfrom mycodo.mycodo_flask.utils import utils_general\nfrom mycodo.mycodo_flask.utils.utils_general import get_ip_address\nfrom mycodo.mycodo_flask.utils.utils_output import get_all_output_states\nfrom mycodo.utils.database import db_retrieve_table\nfrom mycodo.utils.image import generate_thermal_image_from_pixels\nfrom mycodo.utils.influx import influx_time_str_to_milliseconds\nfrom mycodo.utils.influx import query_string\nfrom mycodo.utils.system_pi import assure_path_exists\nfrom mycodo.utils.system_pi import is_int\nfrom mycodo.utils.system_pi import return_measurement_info\nfrom mycodo.utils.system_pi import str_is_float\n\nblueprint = Blueprint('routes_general',\n                      __name__,\n                      static_folder='../static',\n                      template_folder='../templates')\n\nlogger = logging.getLogger(__name__)\n\nlimiter = Limiter(key_func=get_ip_address)\n\n\n@blueprint.route('/')\ndef home():\n    \"\"\"Load the default landing page\"\"\"\n    try:\n        if flask_login.current_user.is_authenticated:\n            if flask_login.current_user.landing_page == 'live':\n                return redirect(url_for('routes_page.page_live'))\n            elif flask_login.current_user.landing_page == 'dashboard':\n                return redirect(url_for('routes_dashboard.page_dashboard_default'))\n            elif flask_login.current_user.landing_page == 'info':\n                return redirect(url_for('routes_page.page_info'))\n            return redirect(url_for('routes_page.page_live'))\n    except:\n        logger.error(\"User may not be logged in. Clearing cookie auth.\")\n    return clear_cookie_auth()\n\n@blueprint.route('/index_page')\ndef index_page():\n    \"\"\"Load the index page\"\"\"\n    try:\n        if not flask_login.current_user.index_page:\n            return home()\n        elif flask_login.current_user.index_page == 'landing':\n            return home()\n        else:\n            if flask_login.current_user.is_authenticated:\n                if flask_login.current_user.index_page == 'live':\n                    return redirect(url_for('routes_page.page_live'))\n                elif flask_login.current_user.index_page == 'dashboard':\n                    return redirect(url_for('routes_dashboard.page_dashboard_default'))\n                elif flask_login.current_user.index_page == 'info':\n                    return redirect(url_for('routes_page.page_info'))\n                return redirect(url_for('routes_page.page_live'))\n    except:\n        logger.error(\"User may not be logged in. Clearing cookie auth.\")\n    return clear_cookie_auth()\n\n@blueprint.route('/settings', methods=('GET', 'POST'))\n@flask_login.login_required\ndef page_settings():\n    return redirect('settings/general')\n\n\n@blueprint.route('/note_attachment/<filename>')\n@flask_login.login_required\ndef send_note_attachment(filename):\n    \"\"\"Return a file from the note attachment directory\"\"\"\n    file_path = os.path.join(PATH_NOTE_ATTACHMENTS, filename)\n    if file_path is not None:\n        try:\n            return send_file(file_path, as_attachment=True)\n        except Exception:\n            logger.exception(\"Send note attachment\")\n\n\n@blueprint.route('/camera/<camera_unique_id>/<img_type>/<filename>')\n@flask_login.login_required\ndef camera_img_return_path(camera_unique_id, img_type, filename):\n    \"\"\"Return an image from stills or time-lapses\"\"\"\n    camera = Camera.query.filter(Camera.unique_id == camera_unique_id).first()\n    camera_path = assure_path_exists(\n        os.path.join(PATH_CAMERAS, '{uid}'.format(uid=camera.unique_id)))\n    if img_type == 'still':\n        if camera.path_still:\n            path = camera.path_still\n        else:\n            path = os.path.join(camera_path, img_type)\n    elif img_type == 'timelapse':\n        if camera.path_timelapse:\n            path = camera.path_timelapse\n        else:\n            path = os.path.join(camera_path, img_type)\n    else:\n        return \"Unknown Image Type\"\n\n    if os.path.isdir(path):\n        files = (files for files in os.listdir(path)\n                 if os.path.isfile(os.path.join(path, files)))\n    else:\n        files = []\n    if filename in files:\n        path_file = os.path.join(path, filename)\n        return send_file(path_file, mimetype='image/jpeg')\n\n    return \"Image not found\"\n\n\n@blueprint.route('/camera_acquire_image/<image_type>/<camera_unique_id>/<max_age>')\n@flask_login.login_required\ndef camera_img_acquire(image_type, camera_unique_id, max_age):\n    \"\"\"Capture an image and return the filename\"\"\"\n    if image_type == 'new':\n        tmp_filename = None\n    elif image_type == 'tmp':\n        tmp_filename = '{id}_tmp.jpg'.format(id=camera_unique_id)\n    else:\n        return\n    path, filename = camera_record('photo', camera_unique_id, tmp_filename=tmp_filename)\n    image_path = os.path.join(path, filename)\n    time_max_age = datetime.datetime.now() - datetime.timedelta(seconds=int(max_age))\n    timestamp = os.path.getctime(image_path)\n    if datetime.datetime.fromtimestamp(timestamp) > time_max_age:\n        date_time = datetime.datetime.fromtimestamp(timestamp).strftime('%Y-%m-%d %H:%M:%S')\n        return_values = '[\"{}\",\"{}\"]'.format(filename, date_time)\n    else:\n        return_values = '[\"max_age_exceeded\"]'\n    return Response(return_values, mimetype='text/json')\n\n\n@blueprint.route('/camera_latest_timelapse/<camera_unique_id>/<max_age>')\n@flask_login.login_required\ndef camera_img_latest_timelapse(camera_unique_id, max_age):\n    \"\"\"Capture an image and/or return a filename\"\"\"\n    camera = Camera.query.filter(\n            Camera.unique_id == camera_unique_id).first()\n\n    _, tl_path = utils_general.get_camera_paths(camera)\n\n    timelapse_file_path = os.path.join(tl_path, str(camera.timelapse_last_file))\n\n    if camera.timelapse_last_file is not None and os.path.exists(timelapse_file_path):\n        time_max_age = datetime.datetime.now() - datetime.timedelta(seconds=int(max_age))\n        if datetime.datetime.fromtimestamp(camera.timelapse_last_ts) > time_max_age:\n            ts = datetime.datetime.fromtimestamp(camera.timelapse_last_ts).strftime(\"%Y-%m-%d %H:%M:%S\")\n            return_values = '[\"{}\",\"{}\"]'.format(camera.timelapse_last_file, ts)\n        else:\n            return_values = '[\"max_age_exceeded\"]'\n    else:\n        return_values = '[\"file_not_found\"]'\n    return Response(return_values, mimetype='text/json')\n\n\ndef gen(camera):\n    \"\"\"Video streaming generator function.\"\"\"\n    while True:\n        frame = camera.get_frame()\n        yield (b'--frame\\r\\n'\n               b'Content-Type: image/jpeg\\r\\n\\r\\n' + frame + b'\\r\\n')\n\n\n@blueprint.route('/video_feed/<unique_id>')\n@flask_login.login_required\ndef video_feed(unique_id):\n    \"\"\"Video streaming route. Put this in the src attribute of an img tag.\"\"\"\n    camera_options = Camera.query.filter(Camera.unique_id == unique_id).first()\n    camera_stream = import_module('mycodo.mycodo_flask.camera.camera_' + camera_options.library).Camera\n    camera_stream.set_camera_options(camera_options)\n    return Response(gen(camera_stream(unique_id=unique_id)),\n                    mimetype='multipart/x-mixed-replace; boundary=frame')\n\n\n@blueprint.route('/outputstate')\n@flask_login.login_required\ndef gpio_state():\n    \"\"\"Return all output states\"\"\"\n    return jsonify(get_all_output_states())\n\n\n@blueprint.route('/outputstate_unique_id/<unique_id>/<channel_id>')\n@flask_login.login_required\ndef gpio_state_unique_id(unique_id, channel_id):\n    \"\"\"Return the GPIO state, for dashboard output \"\"\"\n    channel = OutputChannel.query.filter(OutputChannel.unique_id == channel_id).first()\n    daemon_control = DaemonControl()\n    state = daemon_control.output_state(unique_id, channel.channel)\n    return jsonify(state)\n\n\n@blueprint.route('/widget_execute/<unique_id>')\n@flask_login.login_required\ndef widget_execute(unique_id):\n    \"\"\"Return the response from the execution of widget code \"\"\"\n    daemon_control = DaemonControl()\n    return_value = daemon_control.widget_execute(unique_id)\n    return jsonify(return_value)\n\n\n@blueprint.route('/time')\n@flask_login.login_required\ndef get_time():\n    \"\"\" Return the current time \"\"\"\n    return jsonify(datetime.datetime.now().strftime('%m/%d %H:%M'))\n\n\n@blueprint.route('/dl/<dl_type>/<path:filename>')\n@flask_login.login_required\ndef download_file(dl_type, filename):\n    \"\"\"Serve log file to download\"\"\"\n    if dl_type == 'log':\n        return send_from_directory(LOG_PATH, filename, as_attachment=True)\n\n    return '', 204\n\n\n@blueprint.route('/last/<unique_id>/<measure_type>/<measurement_id>/<period>')\n@flask_login.login_required\ndef last_data(unique_id, measure_type, measurement_id, period):\n    \"\"\"Return the most recent time and value from influxdb\"\"\"\n    if not str_is_float(period):\n        return '', 204\n\n    if measure_type in ['input', 'math', 'function', 'output', 'pid']:\n        dbcon = InfluxDBClient(\n            INFLUXDB_HOST,\n            INFLUXDB_PORT,\n            INFLUXDB_USER,\n            INFLUXDB_PASSWORD,\n            INFLUXDB_DATABASE)\n\n        if measure_type in ['input', 'math', 'function', 'output', 'pid']:\n            measure = DeviceMeasurements.query.filter(\n                DeviceMeasurements.unique_id == measurement_id).first()\n        else:\n            return '', 204\n\n        if measure:\n            conversion = Conversion.query.filter(\n                Conversion.unique_id == measure.conversion_id).first()\n        else:\n            conversion = None\n\n        channel, unit, measurement = return_measurement_info(\n            measure, conversion)\n\n        if hasattr(measure, 'measurement_type') and measure.measurement_type == 'setpoint':\n            setpoint_pid = PID.query.filter(PID.unique_id == measure.device_id).first()\n            if setpoint_pid and ',' in setpoint_pid.measurement:\n                pid_measurement = setpoint_pid.measurement.split(',')[1]\n                setpoint_measurement = DeviceMeasurements.query.filter(\n                    DeviceMeasurements.unique_id == pid_measurement).first()\n                if setpoint_measurement:\n                    conversion = Conversion.query.filter(\n                        Conversion.unique_id == setpoint_measurement.conversion_id).first()\n                    _, unit, measurement = return_measurement_info(setpoint_measurement, conversion)\n        try:\n            if period != '0':\n                query_str = query_string(\n                    unit, unique_id,\n                    measure=measurement, channel=channel,\n                    value='LAST', past_sec=period)\n            else:\n                query_str = query_string(\n                    unit, unique_id,\n                    measure=measurement, channel=channel,\n                    value='LAST')\n            if query_str == 1:\n                return '', 204\n\n            raw_data = dbcon.query(query_str).raw\n\n            number = len(raw_data['series'][0]['values'])\n            time_raw = raw_data['series'][0]['values'][number - 1][0]\n            value = raw_data['series'][0]['values'][number - 1][1]\n            value = float(value)\n            # Convert date-time to epoch (potential bottleneck for data)\n            dt = date_parse(time_raw)\n            timestamp = calendar.timegm(dt.timetuple()) * 1000\n            live_data = '[{},{}]'.format(timestamp, value)\n\n            return Response(live_data, mimetype='text/json')\n        except KeyError:\n            logger.debug(\"No Data returned form influxdb\")\n            return '', 204\n        except IndexError:\n            logger.debug(\"No Data returned form influxdb\")\n            return '', 204\n        except Exception as e:\n            logger.exception(\"URL for 'last_data' raised and error: \"\n                             \"{err}\".format(err=e))\n            return '', 204\n\n\n@blueprint.route('/past/<unique_id>/<measure_type>/<measurement_id>/<past_seconds>')\n@flask_login.login_required\ndef past_data(unique_id, measure_type, measurement_id, past_seconds):\n    \"\"\"Return data from past_seconds until present from influxdb\"\"\"\n    if not str_is_float(past_seconds):\n        return '', 204\n\n    if measure_type == 'tag':\n        notes_list = []\n\n        tag = NoteTags.query.filter(NoteTags.unique_id == unique_id).first()\n        notes = Notes.query.filter(\n            Notes.date_time >= (datetime.datetime.utcnow() - datetime.timedelta(seconds=int(past_seconds)))).all()\n\n        for each_note in notes:\n            if tag.unique_id in each_note.tags.split(','):\n                notes_list.append(\n                    [each_note.date_time.strftime(\"%Y-%m-%dT%H:%M:%S.000000000Z\"), each_note.name, each_note.note])\n\n        if notes_list:\n            return jsonify(notes_list)\n        else:\n            return '', 204\n\n    elif measure_type in ['input', 'math', 'function', 'output', 'pid']:\n        dbcon = InfluxDBClient(\n            INFLUXDB_HOST,\n            INFLUXDB_PORT,\n            INFLUXDB_USER,\n            INFLUXDB_PASSWORD,\n            INFLUXDB_DATABASE)\n\n        if measure_type in ['input', 'math', 'function', 'output', 'pid']:\n            measure = DeviceMeasurements.query.filter(\n                DeviceMeasurements.unique_id == measurement_id).first()\n        else:\n            measure = None\n\n        if not measure:\n            return \"Could not find measurement\"\n\n        if measure:\n            conversion = Conversion.query.filter(\n                Conversion.unique_id == measure.conversion_id).first()\n        else:\n            conversion = None\n\n        channel, unit, measurement = return_measurement_info(\n            measure, conversion)\n\n        if hasattr(measure, 'measurement_type') and measure.measurement_type == 'setpoint':\n            setpoint_pid = PID.query.filter(PID.unique_id == measure.device_id).first()\n            if setpoint_pid and ',' in setpoint_pid.measurement:\n                pid_measurement = setpoint_pid.measurement.split(',')[1]\n                setpoint_measurement = DeviceMeasurements.query.filter(\n                    DeviceMeasurements.unique_id == pid_measurement).first()\n                if setpoint_measurement:\n                    conversion = Conversion.query.filter(\n                        Conversion.unique_id == setpoint_measurement.conversion_id).first()\n                    _, unit, measurement = return_measurement_info(setpoint_measurement, conversion)\n\n        try:\n            query_str = query_string(\n                unit, unique_id,\n                measure=measurement,\n                channel=channel,\n                past_sec=past_seconds)\n\n            if query_str == 1:\n                return '', 204\n\n            raw_data = dbcon.query(query_str).raw\n\n            if 'series' in raw_data and raw_data['series']:\n                return jsonify(raw_data['series'][0]['values'])\n            else:\n                return '', 204\n        except Exception as e:\n            logger.debug(\"URL for 'past_data' raised and error: \"\n                         \"{err}\".format(err=e))\n            return '', 204\n\n\n@blueprint.route('/generate_thermal_image/<unique_id>/<timestamp>')\n@flask_login.login_required\ndef generate_thermal_image_from_timestamp(unique_id, timestamp):\n    \"\"\"Return a file from the note attachment directory\"\"\"\n    ts_now = datetime.datetime.now().strftime('%Y-%m-%d_%H-%M-%S')\n    camera_path = assure_path_exists(\n        os.path.join(PATH_CAMERAS, '{uid}'.format(uid=unique_id)))\n    filename = 'Still-{uid}-{ts}.jpg'.format(\n        uid=unique_id,\n        ts=ts_now).replace(\" \", \"_\")\n    save_path = assure_path_exists(os.path.join(camera_path, 'thermal'))\n    assure_path_exists(save_path)\n    path_file = os.path.join(save_path, filename)\n\n    dbcon = InfluxDBClient(\n        INFLUXDB_HOST,\n        INFLUXDB_PORT,\n        INFLUXDB_USER,\n        INFLUXDB_PASSWORD,\n        INFLUXDB_DATABASE)\n\n    input_dev = Input.query.filter(Input.unique_id == unique_id).first()\n    pixels = []\n    success = True\n\n    start = int(int(timestamp) / 1000.0)  # Round down\n    end = start + 1  # Round up\n\n    start_timestamp = time.strftime('%Y-%m-%dT%H:%M:%S.000000000Z', time.gmtime(start))\n    end_timestamp = time.strftime('%Y-%m-%dT%H:%M:%S.000000000Z', time.gmtime(end))\n\n    for each_channel in range(input_dev.channels):\n        measurement = 'channel_{chan}'.format(\n            chan=each_channel)\n        query_str = query_string(measurement, unique_id,\n                                 start_str=start_timestamp,\n                                 end_str=end_timestamp)\n        if query_str == 1:\n            logger.error('Invalid query string')\n            success = False\n        else:\n            raw_data = dbcon.query(query_str).raw\n            if not raw_data or 'series' not in raw_data or not raw_data['series']:\n                logger.error('No measurements to export in this time period')\n                success = False\n            else:\n                pixels.append(raw_data['series'][0]['values'][0][1])\n\n    # logger.error(\"generate_thermal_image_from_timestamp: success: {}, pixels: {}\".format(success, pixels))\n\n    if success:\n        generate_thermal_image_from_pixels(pixels, 8, 8, path_file)\n        return send_file(path_file, mimetype='image/jpeg')\n    else:\n        return \"Could not generate image\"\n\n\n@blueprint.route('/export_data/<unique_id>/<measurement_id>/<start_seconds>/<end_seconds>')\n@flask_login.login_required\ndef export_data(unique_id, measurement_id, start_seconds, end_seconds):\n    \"\"\"\n    Return data from start_seconds to end_seconds from influxdb.\n    Used for exporting data.\n    \"\"\"\n    dbcon = InfluxDBClient(\n        INFLUXDB_HOST,\n        INFLUXDB_PORT,\n        INFLUXDB_USER,\n        INFLUXDB_PASSWORD,\n        INFLUXDB_DATABASE, timeout=100)\n\n    output = Output.query.filter(Output.unique_id == unique_id).first()\n    input_dev = Input.query.filter(Input.unique_id == unique_id).first()\n    math = Math.query.filter(Math.unique_id == unique_id).first()\n\n    if output:\n        name = output.name\n    elif input_dev:\n        name = input_dev.name\n    elif math:\n        name = math.name\n    else:\n        name = None\n\n    device_measurement = DeviceMeasurements.query.filter(\n        DeviceMeasurements.unique_id == measurement_id).first()\n    if device_measurement:\n        conversion = Conversion.query.filter(\n            Conversion.unique_id == device_measurement.conversion_id).first()\n    else:\n        conversion = None\n    channel, unit, measurement = return_measurement_info(\n        device_measurement, conversion)\n\n    utc_offset_timedelta = datetime.datetime.utcnow() - datetime.datetime.now()\n    start = datetime.datetime.fromtimestamp(float(start_seconds))\n    start += utc_offset_timedelta\n    start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n    end = datetime.datetime.fromtimestamp(float(end_seconds))\n    end += utc_offset_timedelta\n    end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n    query_str = query_string(\n        unit, unique_id,\n        measure=measurement, channel=channel,\n        start_str=start_str, end_str=end_str)\n    if query_str == 1:\n        flash('Invalid query string', 'error')\n        return redirect(url_for('routes_page.page_export'))\n    raw_data = dbcon.query(query_str).raw\n\n    if not raw_data or 'series' not in raw_data or not raw_data['series']:\n        flash('No measurements to export in this time period', 'error')\n        return redirect(url_for('routes_page.page_export'))\n\n    # Generate column names\n    col_1 = 'timestamp (UTC)'\n    col_2 = '{name} {meas} ({id})'.format(\n        name=name, meas=measurement, id=unique_id)\n    csv_filename = '{id}_{name}_{meas}.csv'.format(\n        id=unique_id, name=name, meas=measurement)\n    import csv\n    from io import StringIO\n\n    def iter_csv(data):\n        \"\"\" Stream CSV file to user for download \"\"\"\n        line = StringIO()\n        writer = csv.writer(line)\n        writer.writerow([col_1, col_2])\n        for csv_line in data:\n            writer.writerow([\n                str(csv_line[0][:-4]).replace('T', ' '),\n                csv_line[1]\n            ])\n            line.seek(0)\n            yield line.read()\n            line.truncate(0)\n            line.seek(0)\n\n    response = Response(iter_csv(raw_data['series'][0]['values']), mimetype='text/csv')\n    response.headers['Content-Disposition'] = 'attachment; filename=\"{}\"'.format(csv_filename)\n    return response\n\n\n@blueprint.route('/async/<device_id>/<device_type>/<measurement_id>/<start_seconds>/<end_seconds>')\n@flask_login.login_required\ndef async_data(device_id, device_type, measurement_id, start_seconds, end_seconds):\n    \"\"\"\n    Return data from start_seconds to end_seconds from influxdb.\n    Used for asynchronous graph display of many points (up to millions).\n    \"\"\"\n    if device_type == 'tag':\n        notes_list = []\n        tag = NoteTags.query.filter(NoteTags.unique_id == device_id).first()\n\n        start = datetime.datetime.utcfromtimestamp(float(start_seconds))\n        if end_seconds == '0':\n            end = datetime.datetime.utcnow()\n        else:\n            end = datetime.datetime.utcfromtimestamp(float(end_seconds))\n\n        notes = Notes.query.filter(\n            and_(Notes.date_time >= start, Notes.date_time <= end)).all()\n        for each_note in notes:\n            if tag.unique_id in each_note.tags.split(','):\n                notes_list.append(\n                    [each_note.date_time.strftime(\"%Y-%m-%dT%H:%M:%S.000000000Z\"), each_note.name, each_note.note])\n\n        if notes_list:\n            return jsonify(notes_list)\n        else:\n            return '', 204\n\n    dbcon = InfluxDBClient(\n        INFLUXDB_HOST,\n        INFLUXDB_PORT,\n        INFLUXDB_USER,\n        INFLUXDB_PASSWORD,\n        INFLUXDB_DATABASE)\n\n    if device_type in ['input', 'math', 'function', 'output', 'pid']:\n        measure = DeviceMeasurements.query.filter(\n            DeviceMeasurements.unique_id == measurement_id).first()\n    else:\n        measure = None\n\n    if not measure:\n        return \"Could not find measurement\"\n\n    if measure:\n        conversion = Conversion.query.filter(\n            Conversion.unique_id == measure.conversion_id).first()\n    else:\n        conversion = None\n    channel, unit, measurement = return_measurement_info(\n        measure, conversion)\n\n    # Set the time frame to the past year if start/end not specified\n    if start_seconds == '0' and end_seconds == '0':\n        # Get how many points there are in the past year\n        query_str = query_string(\n            unit, device_id,\n            measure=measurement,\n            channel=channel,\n            value='COUNT')\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        count_points = raw_data['series'][0]['values'][0][1]\n        # Get the timestamp of the first point in the past year\n        query_str = query_string(\n            unit, device_id,\n            measure=measurement,\n            channel=channel,\n            limit=1)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        try:\n            first_point = raw_data['series'][0]['values'][0][0]\n        except:\n            return '', 204\n\n        end = datetime.datetime.utcnow()\n        end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n    # Set the time frame to the past start epoch to now\n    elif start_seconds != '0' and end_seconds == '0':\n        start = datetime.datetime.utcfromtimestamp(float(start_seconds))\n        start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n        end = datetime.datetime.utcnow()\n        end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n        query_str = query_string(\n            unit, device_id,\n            measure=measurement,\n            channel=channel,\n            value='COUNT',\n            start_str=start_str,\n            end_str=end_str)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        try:\n            count_points = raw_data['series'][0]['values'][0][1]\n        except:\n            return '', 204\n\n        # Get the timestamp of the first point in the past year\n        query_str = query_string(\n            unit, device_id,\n            measure=measurement,\n            channel=channel,\n            start_str=start_str,\n            end_str=end_str,\n            limit=1)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        try:\n            first_point = raw_data['series'][0]['values'][0][0]\n        except:\n            return '', 204\n    else:\n        start = datetime.datetime.utcfromtimestamp(float(start_seconds))\n        start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n        end = datetime.datetime.utcfromtimestamp(float(end_seconds))\n        end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n        query_str = query_string(\n            unit, device_id,\n            measure=measurement,\n            channel=channel,\n            value='COUNT',\n            start_str=start_str,\n            end_str=end_str)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        try:\n            count_points = raw_data['series'][0]['values'][0][1]\n        except:\n            return '', 204\n\n        # Get the timestamp of the first point in the past year\n        query_str = query_string(\n            unit, device_id,\n            measure=measurement,\n            channel=channel,\n            start_str=start_str,\n            end_str=end_str,\n            limit=1)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        try:\n            first_point = raw_data['series'][0]['values'][0][0]\n        except:\n            return '', 204\n\n    start = datetime.datetime.strptime(\n        influx_time_str_to_milliseconds(first_point),\n        '%Y-%m-%dT%H:%M:%S.%f')\n    start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n    logger.debug('Count = {}'.format(count_points))\n    logger.debug('Start = {}'.format(start))\n    logger.debug('End   = {}'.format(end))\n\n    # How many seconds between the start and end period\n    time_difference_seconds = (end - start).total_seconds()\n    logger.debug('Difference seconds = {}'.format(time_difference_seconds))\n\n    # If there are more than 700 points in the time frame, we need to group\n    # data points into 700 groups with points averaged in each group.\n    if count_points > 700:\n        # Average period between input reads\n        seconds_per_point = time_difference_seconds / count_points\n        logger.debug('Seconds per point = {}'.format(seconds_per_point))\n\n        # How many seconds to group data points in\n        group_seconds = int(time_difference_seconds / 700)\n        logger.debug('Group seconds = {}'.format(group_seconds))\n\n        try:\n            query_str = query_string(\n                unit, device_id,\n                measure=measurement,\n                channel=channel,\n                value='MEAN',\n                start_str=start_str,\n                end_str=end_str,\n                group_sec=group_seconds)\n\n            if query_str == 1:\n                return '', 204\n            raw_data = dbcon.query(query_str).raw\n\n            try:\n                return jsonify(raw_data['series'][0]['values'])\n            except:\n                return '', 204\n        except Exception as e:\n            logger.error(\"URL for 'async_data' raised and error: \"\n                         \"{err}\".format(err=e))\n            return '', 204\n    else:\n        try:\n            query_str = query_string(\n                unit, device_id,\n                measure=measurement,\n                channel=channel,\n                start_str=start_str,\n                end_str=end_str)\n\n            if query_str == 1:\n                return '', 204\n            raw_data = dbcon.query(query_str).raw\n\n            return jsonify(raw_data['series'][0]['values'])\n        except Exception as e:\n            logger.error(\"URL for 'async_data' raised and error: \"\n                         \"{err}\".format(err=e))\n            return '', 204\n\n\n@blueprint.route('/async_usage/<device_id>/<unit>/<channel>/<start_seconds>/<end_seconds>')\n@flask_login.login_required\ndef async_usage_data(device_id, unit, channel, start_seconds, end_seconds):\n    \"\"\"\n    Return data from start_seconds to end_seconds from influxdb.\n    Used for asynchronous energy usage display of many points (up to millions).\n    \"\"\"\n    dbcon = InfluxDBClient(\n        INFLUXDB_HOST,\n        INFLUXDB_PORT,\n        INFLUXDB_USER,\n        INFLUXDB_PASSWORD,\n        INFLUXDB_DATABASE)\n\n    # Set the time frame to the past year if start/end not specified\n    if start_seconds == '0' and end_seconds == '0':\n        # Get how many points there are in the past year\n        query_str = query_string(\n            unit, device_id,\n            channel=channel,\n            value='COUNT')\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        count_points = raw_data['series'][0]['values'][0][1]\n        # Get the timestamp of the first point in the past year\n        query_str = query_string(\n            unit, device_id,\n            channel=channel,\n            limit=1)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        first_point = raw_data['series'][0]['values'][0][0]\n        end = datetime.datetime.utcnow()\n        end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n    # Set the time frame to the past start epoch to now\n    elif start_seconds != '0' and end_seconds == '0':\n        start = datetime.datetime.utcfromtimestamp(float(start_seconds))\n        start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n        end = datetime.datetime.utcnow()\n        end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n        query_str = query_string(\n            unit, device_id,\n            channel=channel,\n            value='COUNT',\n            start_str=start_str,\n            end_str=end_str)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        count_points = raw_data['series'][0]['values'][0][1]\n        # Get the timestamp of the first point in the past year\n\n        query_str = query_string(\n            unit, device_id,\n            channel=channel,\n            start_str=start_str,\n            end_str=end_str,\n            limit=1)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        first_point = raw_data['series'][0]['values'][0][0]\n    else:\n        start = datetime.datetime.utcfromtimestamp(float(start_seconds))\n        start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n        end = datetime.datetime.utcfromtimestamp(float(end_seconds))\n        end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n        query_str = query_string(\n            unit, device_id,\n            channel=channel,\n            value='COUNT',\n            start_str=start_str,\n            end_str=end_str)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        count_points = raw_data['series'][0]['values'][0][1]\n        # Get the timestamp of the first point in the past year\n\n        query_str = query_string(\n            unit, device_id,\n            channel=channel,\n            start_str=start_str,\n            end_str=end_str,\n            limit=1)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        first_point = raw_data['series'][0]['values'][0][0]\n\n    start = datetime.datetime.strptime(\n        influx_time_str_to_milliseconds(first_point),\n        '%Y-%m-%dT%H:%M:%S.%f')\n    start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n    logger.debug('Count = {}'.format(count_points))\n    logger.debug('Start = {}'.format(start))\n    logger.debug('End   = {}'.format(end))\n\n    # How many seconds between the start and end period\n    time_difference_seconds = (end - start).total_seconds()\n    logger.debug('Difference seconds = {}'.format(time_difference_seconds))\n\n    # If there are more than 700 points in the time frame, we need to group\n    # data points into 700 groups with points averaged in each group.\n    if count_points > 700:\n        # Average period between input reads\n        seconds_per_point = time_difference_seconds / count_points\n        logger.debug('Seconds per point = {}'.format(seconds_per_point))\n\n        # How many seconds to group data points in\n        group_seconds = int(time_difference_seconds / 700)\n        logger.debug('Group seconds = {}'.format(group_seconds))\n\n        try:\n            query_str = query_string(\n                unit, device_id,\n                channel=channel,\n                value='MEAN',\n                start_str=start_str,\n                end_str=end_str,\n                group_sec=group_seconds)\n\n            if query_str == 1:\n                return '', 204\n            raw_data = dbcon.query(query_str).raw\n\n            return jsonify(raw_data['series'][0]['values'])\n        except Exception as e:\n            logger.error(\"URL for 'async_data' raised and error: \"\n                         \"{err}\".format(err=e))\n            return '', 204\n    else:\n        try:\n            query_str = query_string(\n                unit, device_id,\n                channel=channel,\n                start_str=start_str,\n                end_str=end_str)\n\n            if query_str == 1:\n                return '', 204\n            raw_data = dbcon.query(query_str).raw\n\n            return jsonify(raw_data['series'][0]['values'])\n        except Exception as e:\n            logger.error(\"URL for 'async_usage' raised and error: \"\n                         \"{err}\".format(err=e))\n            return '', 204\n\n\n@blueprint.route('/output_mod/<output_id>/<channel>/<state>/<output_type>/<amount>')\n@flask_login.login_required\ndef output_mod(output_id, channel, state, output_type, amount):\n    \"\"\" Manipulate output (using non-unique ID) \"\"\"\n    if not utils_general.user_has_permission('edit_controllers'):\n        return 'Insufficient user permissions to manipulate outputs'\n\n    if is_int(channel):\n        # if an integer was returned\n        output_channel = int(channel)\n    else:\n        # if a channel ID was returned\n        channel_dev = db_retrieve_table(OutputChannel).filter(\n            OutputChannel.unique_id == channel).first()\n        if channel_dev:\n            output_channel = channel_dev.channel\n        else:\n            return \"Could not determine channel number from channel ID '{}'\".format(channel)\n\n    daemon = DaemonControl()\n    if (state in ['on', 'off'] and str_is_float(amount) and\n            (\n                (output_type in ['sec', 'pwm'] and float(amount) >= 0) or\n                output_type == 'vol' or\n                output_type == 'value'\n            )):\n        out_status = daemon.output_on_off(\n            output_id,\n            state,\n            output_type=output_type,\n            amount=float(amount),\n            output_channel=output_channel)\n        if out_status[0]:\n            return 'ERROR: {}'.format(out_status[1])\n        else:\n            return 'SUCCESS: {}'.format(out_status[1])\n    else:\n        return 'ERROR: unknown parameters: ' \\\n               'output_id: {}, channel: {}, state: {}, output_type: {}, amount: {}'.format(\n                output_id, channel, state, output_type, amount)\n\n\n@blueprint.route('/daemonactive')\n@flask_login.login_required\ndef daemon_active():\n    \"\"\"Return 'alive' if the daemon is running\"\"\"\n    try:\n        control = DaemonControl()\n        return control.daemon_status()\n    except Exception as e:\n        logger.error(\"URL for 'daemon_active' raised and error: \"\n                     \"{err}\".format(err=e))\n        return '0'\n\n\n@blueprint.route('/systemctl/<action>')\n@flask_login.login_required\ndef computer_command(action):\n    \"\"\"Execute one of several commands as root\"\"\"\n    if not utils_general.user_has_permission('edit_settings'):\n        return redirect(url_for('routes_general.home'))\n\n    try:\n        if action not in ['restart', 'shutdown', 'daemon_restart', 'frontend_reload']:\n            flash(\"Unrecognized command: {action}\".format(\n                action=action), \"success\")\n            return redirect('/settings')\n\n        if DOCKER_CONTAINER:\n            if action == 'daemon_restart':\n                control = DaemonControl()\n                control.terminate_daemon()\n                flash(gettext(\"Command to restart the daemon sent\"), \"success\")\n            elif action == 'frontend_reload':\n                subprocess.Popen('docker restart mycodo_flask 2>&1', shell=True)\n                flash(gettext(\"Command to reload the frontend sent\"), \"success\")\n        else:\n            cmd = '{path}/mycodo/scripts/mycodo_wrapper {action} 2>&1'.format(\n                    path=INSTALL_DIRECTORY, action=action)\n            subprocess.Popen(cmd, shell=True)\n\n        if action == 'restart':\n            flash(gettext(\"System rebooting in 10 seconds\"), \"success\")\n        elif action == 'shutdown':\n            flash(gettext(\"System shutting down in 10 seconds\"), \"success\")\n        elif action == 'daemon_restart':\n            flash(gettext(\"Command to restart the daemon sent\"), \"success\")\n        elif action == 'frontend_reload':\n            flash(gettext(\"Command to reload the frontend sent\"), \"success\")\n\n        return redirect('/settings')\n\n    except Exception as e:\n        logger.error(\"System command '{cmd}' raised and error: \"\n                     \"{err}\".format(cmd=action, err=e))\n        flash(\"System command '{cmd}' raised and error: \"\n              \"{err}\".format(cmd=action, err=e), \"error\")\n        return redirect(url_for('routes_general.home'))\n\n\n#\n# PID Dashboard object routes\n#\n\ndef return_point_timestamp(dev_id, unit, period, measurement=None, channel=None):\n    dbcon = InfluxDBClient(\n        INFLUXDB_HOST,\n        INFLUXDB_PORT,\n        INFLUXDB_USER,\n        INFLUXDB_PASSWORD,\n        INFLUXDB_DATABASE)\n\n    query_str = query_string(\n        unit,\n        dev_id,\n        measure=measurement,\n        channel=channel,\n        value='LAST',\n        past_sec=period)\n    if query_str == 1:\n        return [None, None]\n\n    try:\n        raw_data = dbcon.query(query_str).raw\n        number = len(raw_data['series'][0]['values'])\n        time_raw = raw_data['series'][0]['values'][number - 1][0]\n        value = raw_data['series'][0]['values'][number - 1][1]\n        value = '{:.3f}'.format(float(value))\n        # Convert date-time to epoch (potential bottleneck for data)\n        dt = date_parse(time_raw)\n        timestamp = calendar.timegm(dt.timetuple()) * 1000\n        return [timestamp, value]\n    except KeyError:\n        return [None, None]\n    except Exception:\n        return [None, None]\n\n\n@blueprint.route('/last_pid/<pid_id>/<input_period>')\n@flask_login.login_required\ndef last_data_pid(pid_id, input_period):\n    \"\"\"Return the most recent time and value from influxdb\"\"\"\n    if not str_is_float(input_period):\n        return '', 204\n\n    try:\n        pid = PID.query.filter(PID.unique_id == pid_id).first()\n\n        if len(pid.measurement.split(',')) == 2:\n            device_id = pid.measurement.split(',')[0]\n            measurement_id = pid.measurement.split(',')[1]\n        else:\n            device_id = None\n            measurement_id = None\n\n        actual_measurement = DeviceMeasurements.query.filter(\n            DeviceMeasurements.unique_id == measurement_id).first()\n        if actual_measurement:\n            actual_conversion = Conversion.query.filter(\n                Conversion.unique_id == actual_measurement.conversion_id).first()\n        else:\n            actual_conversion = None\n\n        (actual_channel,\n         actual_unit,\n         actual_measurement) = return_measurement_info(\n            actual_measurement, actual_conversion)\n\n        setpoint_unit = None\n        if pid and ',' in pid.measurement:\n            pid_measurement = pid.measurement.split(',')[1]\n            setpoint_measurement = DeviceMeasurements.query.filter(\n                DeviceMeasurements.unique_id == pid_measurement).first()\n            if setpoint_measurement:\n                conversion = Conversion.query.filter(\n                    Conversion.unique_id == setpoint_measurement.conversion_id).first()\n                _, setpoint_unit, _ = return_measurement_info(setpoint_measurement, conversion)\n\n        p_value = return_point_timestamp(\n            pid_id, 'pid_value', input_period, measurement='pid_p_value')\n        i_value = return_point_timestamp(\n            pid_id, 'pid_value', input_period, measurement='pid_i_value')\n        d_value = return_point_timestamp(\n            pid_id, 'pid_value', input_period, measurement='pid_d_value')\n        if None not in (p_value[1], i_value[1], d_value[1]):\n            pid_value = [p_value[0], '{:.3f}'.format(float(p_value[1]) + float(i_value[1]) + float(d_value[1]))]\n        else:\n            pid_value = None\n\n        setpoint_band = None\n        if pid.band:\n            try:\n                daemon = DaemonControl()\n                setpoint_band = daemon.pid_get(pid.unique_id, 'setpoint_band')\n            except:\n                logger.debug(\"Couldn't get setpoint\")\n\n        live_data = {\n            'activated': pid.is_activated,\n            'paused': pid.is_paused,\n            'held': pid.is_held,\n            'setpoint': return_point_timestamp(\n                pid_id, setpoint_unit, input_period, channel=0),\n            'setpoint_band': setpoint_band,\n            'pid_p_value': p_value,\n            'pid_i_value': i_value,\n            'pid_d_value': d_value,\n            'pid_pid_value': pid_value,\n            'duration_time': return_point_timestamp(\n                pid_id, 's', input_period, measurement='duration_time'),\n            'duty_cycle': return_point_timestamp(\n                pid_id, 'percent', input_period, measurement='duty_cycle'),\n            'actual': return_point_timestamp(\n                device_id,\n                actual_unit,\n                input_period,\n                measurement=actual_measurement,\n                channel=actual_channel)\n        }\n        return jsonify(live_data)\n    except KeyError:\n        logger.debug(\"No Data returned form influxdb\")\n        return '', 204\n    except Exception as e:\n        logger.exception(\"URL for 'last_pid' raised and error: \"\n                         \"{err}\".format(err=e))\n        return '', 204\n\n\n@blueprint.route('/pid_mod_unique_id/<unique_id>/<state>')\n@flask_login.login_required\ndef pid_mod_unique_id(unique_id, state):\n    \"\"\" Manipulate output (using unique ID) \"\"\"\n    if not utils_general.user_has_permission('edit_controllers'):\n        return 'Insufficient user permissions to manipulate PID'\n\n    pid = PID.query.filter(PID.unique_id == unique_id).first()\n\n    daemon = DaemonControl()\n    if state == 'activate_pid':\n        pid.is_activated = True\n        pid.save()\n        _, return_str = daemon.controller_activate(pid.unique_id)\n        return return_str\n    elif state == 'deactivate_pid':\n        pid.is_activated = False\n        pid.is_paused = False\n        pid.is_held = False\n        pid.save()\n        _, return_str = daemon.controller_deactivate(pid.unique_id)\n        return return_str\n    elif state == 'pause_pid':\n        pid.is_paused = True\n        pid.save()\n        if pid.is_activated:\n            return_str = daemon.pid_pause(pid.unique_id)\n        else:\n            return_str = \"PID Paused (Note: PID is not currently active)\"\n        return return_str\n    elif state == 'hold_pid':\n        pid.is_held = True\n        pid.save()\n        if pid.is_activated:\n            return_str = daemon.pid_hold(pid.unique_id)\n        else:\n            return_str = \"PID Held (Note: PID is not currently active)\"\n        return return_str\n    elif state == 'resume_pid':\n        pid.is_held = False\n        pid.is_paused = False\n        pid.save()\n        if pid.is_activated:\n            return_str = daemon.pid_resume(pid.unique_id)\n        else:\n            return_str = \"PID Resumed (Note: PID is not currently active)\"\n        return return_str\n    elif 'set_setpoint_pid' in state:\n        pid.setpoint = state.split('|')[1]\n        pid.save()\n        if pid.is_activated:\n            return_str = daemon.pid_set(pid.unique_id, 'setpoint', float(state.split('|')[1]))\n        else:\n            return_str = \"PID Setpoint changed (Note: PID is not currently active)\"\n        return return_str\n\n\n# import flask_login\n# from mycodo.mycodo_flask.api import api\n# @blueprint.route('/export_swagger')\n# @flask_login.login_required\n# def export_swagger():\n#     \"\"\"Export swagger JSON to swagger.json file\"\"\"\n#     from mycodo.mycodo_flask.utils import utils_general\n#     import json\n#     if not utils_general.user_has_permission('view_settings'):\n#         return 'You do not have permission to access this.', 401\n#     with open(\"/home/pi/swagger.json\", \"w\") as text_file:\n#         text_file.write(json.dumps(api.__schema__, indent=2))\n#     return 'success'\n"], "fixing_code": ["## 8.12.7 (2021-10-25)\n\nThis is a bugfix release that includes a fix to a severe security vulnerability. It is recommended that all users that have Mycodo exposed to the internet and allow guest access upgrade to patch this vulnerability. Users that only run Mycodo on a local network and/or don't allow unknown user (i.e. guest) access likely won't be affected.\n\n### Bugfixes\n\n - Fix refreshing LCD Display Function line options when changing number of lines\n - Fix installation of Function Action dependencies\n - Fix error when unauthenticated users attempting to land on the home page\n - Fix Gauge Widget dependencies ([#1100](https://github.com/kizniche/mycodo/issues/1100))\n - Fix installation of pigpiod\n - Fix file exploit vulnerability ([#1105](https://github.com/kizniche/mycodo/issues/1105))\n\n### Features\n\n - Add ability to install on most Debian-based systems\n - Add ability for Actions to work on Function Controllers\n - Add LCD Backlight On/Off Actions to LCD Functions ([#1089](https://github.com/kizniche/mycodo/issues/1089))\n - Add Input: SHT2x (using alternate sht20 library with more accurate measurements and settable temperature resolution)\n - Add Input: SHTC3\n\n### Miscellaneous\n\n - Update python packages\n\n\n## 8.12.6 (2021-09-03)\n\n### Bugfixes\n\n - Fix accessing dependency page ([#1082](https://github.com/kizniche/mycodo/issues/1082))\n - Fix loading Input page if Math controllers are present ([#1083](https://github.com/kizniche/mycodo/issues/1083))\n - Fix MQTT JSON Input dependency version ([#1085](https://github.com/kizniche/mycodo/issues/1085))\n\n### Features\n\n - Add Inputs: MLX90393, DPS310\n\n\n## 8.12.5 (2021-09-01)\n\n### Bugfixes\n\n - Fix aggregate dependency page ([#1082](https://github.com/kizniche/mycodo/issues/1082))\n\n\n## 8.12.5 (2021-09-01)\n\n### Bugfixes\n\n - Fix loading of dependency install page\n - Prevent loading of Highstock JS more than once\n\n\n## 8.12.4 (2021-08-31)\n\n### Bugfixes\n\n - Fix Input temperature compensation\n\n### Features\n\n - Add ability to set Dependency Message to be displayed on dependency install page\n\n\n## 8.12.3 (2021-08-31)\n\n### Bugfixes\n\n - Fix redrawing Graph/Gauge Widgets on resize\n - Fix Gauge Widget dark theme ([#1080](https://github.com/kizniche/mycodo/issues/1080))\n - Really fix missing channels for Atlas EC sensor\n\n\n## 8.12.2 (2021-08-30)\n\n### Bugfixes\n\n - Fix missing channels for Atlas EC sensor\n\n\n## 8.12.1 (2021-08-30)\n\n### Bugfixes\n\n - Fix display of Graph and Gauge Widgets on dashboard ([#1078](https://github.com/kizniche/mycodo/issues/1078))\n\n\n## 8.12.0 (2021-08-29)\n\nThis release changes the way settings are saved, which requires a change to any custom Inputs/Outputs/Functions you have in use. If your custom module includes the seldom-used execute_at_modification() function (such as Mycodo/mycodo/inputs/python_code.py), you will need to change the parameters as well as the return variables.\n\nBefore:\n\n```python\ndef execute_at_modification(\n        mod_entry,\n        request_form,\n        custom_options_dict_presave,\n        custom_options_channels_dict_presave,\n        custom_options_dict_postsave,\n        custom_options_channels_dict_postsave):\n    allow_saving = True  # Allows saving of options to occur\n    return (allow_saving,\n            mod_entry,\n            custom_options_dict_postsave,\n            custom_options_channels_dict_postsave)\n```\n\nAfter:\n\n```python\ndef execute_at_modification(\n        messages,\n        mod_entry,\n        request_form,\n        custom_options_dict_presave,\n        custom_options_channels_dict_presave,\n        custom_options_dict_postsave,\n        custom_options_channels_dict_postsave):\n     # messages[\"page_refresh\"] = True  # Setting to True will cause the options on the user's page to refresh\n     # messages[\"error\"].append(\"Some error\")  # Uncomment this line to prevent options saving\n     # messages[\"warning\"].append(\"This will be a warning message\")\n     # messages[\"info\"].append(\"This will be an info message\")\n     if not messages[\"error\"]:\n        messages[\"success\"].append(\"Successfully completed execute_at_modification()\")\n     return (messages,\n             mod_entry,\n             custom_options_dict_postsave,\n             custom_options_channels_dict_postsave)\n```\n\nAdditionally, if you are currently using the MQTT JSON Input and your topics contain any special characters, you will need to enclose the topic in quotes (e.g. sensor-1 to \"sensor-1\").\n\n### Bugfixes\n\n - Fix taking photos with camera library \"raspistill\" when AWB set to off\n - Fix issue querying graph data\n - Fix flag/tag newlines on asynchronous graphs\n - Fix single quotes in translations causing error ([#1019](https://github.com/kizniche/mycodo/issues/1019))\n - Fix CCS811 Input dependency install issue ([#1023](https://github.com/kizniche/mycodo/issues/1023))\n - Fix sense-hat dependency issue\n - Fix saving Output checkboxes ([#1029](https://github.com/kizniche/mycodo/issues/1029))\n - Fix PiOLED Functions ([#1030](https://github.com/kizniche/mycodo/issues/1030))\n - Fix PID controller properly reporting if Held/Paused\n - Fix cmd_output() killing daemon upon command timeout ([#1047](https://github.com/kizniche/mycodo/issues/1047))\n - Fix missing check for Widget dependencies during upgrade/restore\n - Fix output_sec_currently_on()\n - Fix Widgets being able to be moved/resized when dashboard locked\n - Fix Indicator Widget unit not using correct font size\n - Fix display of tags on more than one Graph Widget\n - Fix first channel of L298N DC Motor Controller Output not working\n - Fix setting Graph Widget custom colors when tag selected\n - Fix Graph Widget custom colors when more than one Input selected\n - Fix note array memory leak on Graph Widgets\n - Fix FTDI device detection on Output page\n - Fix sending commands to Atlas Scientific devices via FTDI\n - Fix Atlas Scientific Peristaltic Pump Output calibration\n - Fix temperature compensation unit conversion for Atlas ORP, EC, and pH sensors ([#1064](https://github.com/kizniche/mycodo/issues/1064))\n - Fix Camera Widget displaying time-lapse images ([#1072](https://github.com/kizniche/mycodo/issues/1072))\n - Fix Activate/Deactivate Actions not working for Functions\n\n### Features\n\n - Add ability to install Javascript/CSS dependencies\n - Add ability to submit forms without refreshing the page ([#1040](https://github.com/kizniche/mycodo/issues/1040))\n - Add ability to install dependencies without changing the page\n - Add drag and drop sorting of Inputs/Outputs/Functions\n - Add modal dialog for Input/Output/Function configuration\n - Add option for a numerical keypad login\n - Add options for camera library raspistill: AWB Gain Blue, AWB Gain Red\n - Add Input: ADS1256 with Analog pH/EC sensors\n - Add Input: SI1145 Light/Proximity sensor\n - Add Output: MCP23017 16-Channel I/O Expander (On/Off)\n - Add return status to Conditional Controllers\n - Add 2- and 4-line variants of SSD1306 Display Functions and extra Options ([#1030](https://github.com/kizniche/mycodo/issues/1030))\n - Add calibration to the Atlas Scientific EC Input Peristaltic Pump Output\n - Add Spacers for Input and Output lists\n - Add PDF Manual\n - Add ability to set the Indicator Widget's unit font size\n - Add temperature compensation to Atlas Dissolved Oxygen sensor\n - Add TDS, Salinity, and Specific Gravity measurements for Atlas Scientific EC sensor ([#1065](https://github.com/kizniche/mycodo/issues/1065))\n - Add ability to define new Flask endpoints in Widget modules\n\n### Miscellaneous\n\n - Replace TravisCI (no longer free) with [Github Actions](https://github.com/kizniche/Mycodo/actions/workflows/main.yml) to perform unit tests\n - Update KP303 library ([#1028](https://github.com/kizniche/mycodo/issues/1028))\n - Add Try/Except for checking Output Triggers ([#1037](https://github.com/kizniche/mycodo/issues/1037))\n - Speed up loading of Camera page\n - Update Gridstack to the latest version\n - Ensure Atlas DO sensor only returns DO ([#1052](https://github.com/kizniche/mycodo/issues/1052))\n - Remove Highcharts/Highstock Javascript from package to be compliant with licensing\n - Remove calibration page (all functionality has been moved to modules)\n - Place Output columns at back of Graph Widget charts\n - Add Measurements/Units: Specific Gravity, Salinity, Total Dissolved Solids, Parts per Thousand\n - Add conversions for Parts per Thousand\n - Specify virtualenv install version in requirements.txt ([#1067](https://github.com/kizniche/mycodo/issues/1067))\n - Enable server-side Flask session\n\n\n## 8.11.0 (2021-06-05) \n\n### Bugfixes\n\n - Fix upgrading database to version 61a0d0568d24\n - Fix Generic Pump Output timestamps\n - Fix inability to add Camera Widget for some cameras\n - Fix error referencing key of Input dict that doesn't exist\n - Fix unnecessary reference to measurement dict causing error ([#1001](https://github.com/kizniche/mycodo/issues/1001), [#1005](https://github.com/kizniche/mycodo/issues/1005))\n - Add missing dependency for HC-SR04 Input ([#1003](https://github.com/kizniche/mycodo/issues/1003))\n - Fix 'id' KeyError when saving certain Inputs ([#1004](https://github.com/kizniche/mycodo/issues/1004))\n - Fix I2C PiOLED Display Functions\n - Fix clearing total volume of Hall Flow Input ([#994](https://github.com/kizniche/mycodo/issues/994))\n - Fix SSD1306 OLED Display Function initialization\n - Fix PID Min/Max options not being respected ([#998](https://github.com/kizniche/mycodo/issues/998))\n - Fix error when PWM Output duty cycle is 0\n - Change pin default when creating an Output from 0 to None\n - Don't run Output shutdown function if not set up\n - Fix Controller custom_option messages not being visible\n - Fix output state checking not handling errors ([#990](https://github.com/kizniche/mycodo/issues/990))\n - Fix BME680 Input dependency\n - Fix GrovePi DHT Input\n - Fix Method dependencies not being installed\n - Prevent non-streamable camera types from being selected to stream in Camera Widget ([#991](https://github.com/kizniche/mycodo/issues/991))\n\n### Features\n\n - Add ability to set decimal places for Angular and Solid Gauge Widgets\n - Add ability to lock Dashboards (remove ability to edit widget options) ([#996](https://github.com/kizniche/mycodo/issues/996))\n - Add ability to display the status of Functions and PID Controllers in the UI\n - Add Widget: Function Status\n - Add Conditional Controller option: Timeout (seconds)\n - Add Function Actions: Camera Timelapse Pause/Resume\n - Add Temperature Compensation for Atlas Scientific pH Input during calibration\n - Add Output channel names to Graph Widget multi-select and legend\n - Add Function: Backup to Remote Host (rsync)\n - Add Input: Anyleaf Electrical Conductivity\n - Add ability to calibrate Atlas Scientific ORP and DO sensors\n - Add ability to change I2C address of Atlas Scientific devices\n - Add Input: CCS811 (without temperature) ([#992](https://github.com/kizniche/mycodo/issues/992))\n - Add Input: MQTT Subscribe (JSON payload)\n - Add Output: Grove I2C Motor Driver (TB6612FNG, Board v1.0)\n - Add Output: Grove I2C Motor Driver (Board v1.3)\n - Make Enable Pin optional for L298N Output\n\n\n## 8.10.1 (2021-04-27)\n\n### Bugfixes\n\n - Fix warning preventing saving of Python code\n - Fix Sense Hat Input dependency\n\n### Features\n\n - Add Input: Atlas Scientific humidity sensor\n - Add Camera: raspistill\n - Make Add Output dropdown searchable\n\n### Miscellaneous\n\n - Add \"Both\" direction option for On/Off and PWM Bang-Bang Outputs\n\n\n## 8.10.0 (2021-04-24)\n\nThis release contains changes that requires modification to any Custom Functions you may have in use. In order for the new features to work for Custom Functions, it required the use of an abstract base function class (similarly to Inputs and Outputs). As a result, any Custom Functions that previously were formatted as such:\n\n```python\nfrom mycodo.controllers.base_controller import AbstractController\n\nclass CustomModule(AbstractController, threading.Thread):\n    \"\"\"\n    Class to operate custom controller\n    \"\"\"\n    def __init__(self, ready, unique_id, testing=False):\n        threading.Thread.__init__(self)\n        super(CustomModule, self).__init__(ready, unique_id=unique_id, name=__name__)\n\n        self.unique_id = unique_id\n        self.log_level_debug = None\n\n        # Set custom options\n        custom_function = db_retrieve_table_daemon(\n            CustomController, unique_id=unique_id)\n        self.setup_custom_options(\n            FUNCTION_INFORMATION['custom_options'], custom_function)\n```\n\nwill need to be changed to the format:\n\n```python\nfrom mycodo.functions.base_function import AbstractFunction\n\nclass CustomModule(AbstractFunction):\n    \"\"\"\n    Class to operate custom controller\n    \"\"\"\n    def __init__(self, function, testing=False):\n        super(CustomModule, self).__init__(function, testing=testing, name=__name__)\n\n        # Note: The following 2 lines are no longer needed to be defined here. Delete them.\n        # self.unique_id = function.unique_id  \n        # self.log_level_debug = None\n\n        # Set custom options\n        custom_function = db_retrieve_table_daemon(\n            CustomController, unique_id=self.unique_id)  # Note: \"self.\" is added here\n        self.setup_custom_options(\n            FUNCTION_INFORMATION['custom_options'], custom_function)\n\n        # These two lines are new and are required to execute initialize_variables()\n        if not testing:\n            self.initialize_variables()\n```\n\nYou also no longer need to define the following (i.e. you can remove these lines):\n\n```python\ncontroller = db_retrieve_table_daemon(\n    CustomController, unique_id=self.unique_id)\nself.log_level_debug = controller.log_level_debug\nself.set_log_level_debug(self.log_level_debug)\n```\n\nAdditionally, if you have pre_stop() in your Function Class, it will need to be renamed to stop_function().\n\nThere are two ways to perform these changes.\n\nMethod A:\n\n1. Deactivate all custom functions.\n2. Delete all custom functions on the Setup -> Function page.\n3. Delete all custom functions on the Configure -> Custom Functions page.\n4. Perform the Mycodo upgrade.\n5. Make the necessary edits to all your Custom Functions.\n6. Import all your updated Custom Functions on the Configure -> Custom Functions page.\n7. Add and configure your Custom Functions on the Setup -> Function page.\n\nMethod B:\n\n1. Either SSH into your Raspberry Pi or use a keyboard/mouse/monitor and edit the Custom Functions in the ~/Mycodo/mycodo/function/custom_functions directory.\n2. Perform the Mycodo upgrade.\n\nMethod A is more involved, but does not require accessing the Pi from outside the web UI. Method B has fewer steps and doesn't require deleting and reconfiguring new Functions, but requires being able to SSH in to your Raspberry Pi or connecting a keyboard/mouse/monitor to be able to edit the files in-place.\n\nAs always, a backup of the current system files and settings is performed during an upgrade, allowing you to restore your system to a previous release state if needed.\n\n### Bugfixes\n\n - Fix camera paths not saving ([#955](https://github.com/kizniche/mycodo/issues/955))\n - Fix returning pylint3 report after saving Python Code\n - Fix detection of multiple cameras by opencv\n - Fix SCD30 (CircuitPython) Input ([#963](https://github.com/kizniche/mycodo/issues/963))\n - Fix importing Mycodo Settings ZIP if custom modules were exported ([#967](https://github.com/kizniche/mycodo/issues/967))\n - Fix inability to install picamera library on some Pi 4s ([#967](https://github.com/kizniche/mycodo/issues/967))\n - Fix VPD Function saving and calculating pressure conversion ([#978](https://github.com/kizniche/mycodo/issues/978))\n - Fix pressure conversion equations ([#978](https://github.com/kizniche/mycodo/issues/978))\n - Fix issues with Function channels/measurements\n - Fix Mijia LYWSD03MMC Input using a nonexistent pybluez version\n - Fix Hall Flow Input\n - Remove Flask-Session to resolve bug preventing frontend loading ([#971](https://github.com/kizniche/mycodo/issues/971))\n\n### Features\n\n - Add Input: SHT41x\n - Add Input: Adafruit I2C capacitive soil sensor\n - Add Input: CircuitPython variants of the BME280 and SHT31-D Inputs\n - Add Input: KP303 Smart WiFi Power Strip ([#980](https://github.com/kizniche/mycodo/issues/980))\n - Add Input: Generic Analog pH/EC using ADS1115 ADC\n - Add Input: Tasmota Outlet Energy Monitor\n - Add Output: DS3502 Digital Potentiometer\n - Add Output: ULN2003 Unipolar Stepper Motor Driver\n - Add Function: SSD1309 Display\n - Add Function: Bang-Bang PWM\n - Add Function Action: MQTT Publish\n - Add Function Action: webhook to emit HTTP requests ([discussion](https://kylegabriel.com/forum/general-discussion/webhook-action/))\n - Partial conversion of Display/LCD controllers to Display Functions\n - Add external temperature compensation for Anyleaf pH Input\n - Add ability to set camera stream frames per second\n - Add missing stream resolution option to opencv cameras\n - Add ability for Atlas Scientific Peristaltic Pump Outputs to run in reverse\n - Add new ADC measurement rescaling method: Equation\n - Add Custom Actions to Functions\n - Add \"wait_for_return\" option to Custom Actions\n - Convert all LCD/Display controllers to Functions\n - Add ability to not have to set time-lapse end (defaults to 10 years) ([#987](https://github.com/kizniche/mycodo/issues/987))\n\n### Miscellaneous\n\n - Add Measurements: Apparent Power, Reactive Power, Power Factor\n - Add Units: kilowatt-hour, Watt, Volt-Amps, Volt-Amps-Reactive\n - Specify package versions for pypi dependencies\n - Update python libraries\n - Add unit testing for Custom Functions\n - Add ability to change theme from Config dropdown menu\n\n\n## 8.9.2 (2021-03-16)\n\nThis bugfix release changes how sessions are handled and as a result will log all users out following the upgrade.\n\n### Bugfixes\n\n - Fix Function measurements not appearing in some dropdowns\n - Fix displaying saved Custom Option values when Inputs/Outputs have Custom Actions ([#952](https://github.com/kizniche/mycodo/issues/952))\n - Fix silent failures when cookies are too large ([#950](https://github.com/kizniche/mycodo/issues/950))\n - Fix use of select_measurement_channel custom option in controllers ([#953](https://github.com/kizniche/mycodo/issues/953))\n - Fix error-handling of erroneous measurements/units ([#949](https://github.com/kizniche/mycodo/issues/949))\n\n\n## 8.9.1 (2021-03-13)\n\n### Bugfixes\n\n - Fix API deactivating controller in database ([#944](https://github.com/kizniche/mycodo/issues/944))\n - Fix invalid conversion ([#947](https://github.com/kizniche/mycodo/issues/947))\n - Fix inability to save MQTT Input ([#946](https://github.com/kizniche/mycodo/issues/946))\n - Fix Camera Widget ([#948](https://github.com/kizniche/mycodo/issues/948))\n\n\n## 8.9.0 (2021-03-08)\n\nThis release contains bug fixes and several new types of Inputs and Outputs. These include stepper motors, digital-to-analog converters, a multi-channel PWM output, as well as an input to acquire current and future weather conditions.\n\nThis release also deprecates Math controllers. Current Math controllers will continue to function, but new Math controllers cannot be created. Instead, all Math controller functionality has been ported to Functions (Setup -> Function page), in order to reduce complexity and improve customizability. Much like Inputs and Outputs, Functions are single-file modules that can be created by users and imported. Take a look at the Mycodo/mycodo/functions directory for the built-in Function modules.\n\nThe new weather input acquires current and future weather conditions from openweathermap.org with either a city (200,000 to choose from) or latitude/longitude for a location and a time frame from the present up to 7 days in the future, with a resolution of days or hours. An API key to use the service is free and the measurements returned include temperature (including minimum and maximum if forecasting days in the future), humidity, dew point, pressure, wind speed, and wind direction. This can be useful for incorporating current or future weather conditions into your conditional controllers or other functions or calculations. For instance, you may prevent Mycodo from watering your outdoor plants if the forecasted temperature in the next 12 to 24 hours is below freezing. You may also want to be alerted by email if the forecasted weather conditions are extreme. Not everyone wants to set up a weather station, but might still want to have local outdoor measurements, so this input was made to bridge that gap.\n\n### Bugfixes\n\n - Fix broken Output API get/post calls\n - Fix selecting output channels in custom functions\n - Fix Autotune PID Function ([#876](https://github.com/kizniche/mycodo/issues/876))\n - Fix issue with LockFile not locking\n - Fix Output State and Output Duration On Conditional Conditions ([#879](https://github.com/kizniche/mycodo/issues/879))\n - Fix not showing camera stream buttons for cameras libraries that don't have stream support ([#899](https://github.com/kizniche/mycodo/issues/899))\n - Fix Clock Pin option showing twice for UART Inputs\n - Fix MCP3008 Input error ([#902](https://github.com/kizniche/mycodo/issues/902))\n - Fix Input Measurement option Invert Scale not displaying properly ([#902](https://github.com/kizniche/mycodo/issues/902))\n - Fix MQTT output being able to set 0 to disable option\n - Fix compounding of Function Action return messages in Conditionals\n - Fix ADS1015 and ADS1115 inputs only measuring channel 0 ([#911](https://github.com/kizniche/mycodo/issues/911))\n - Fix install of pyusb dependency of Adafruit_Extended_Bus ([#863](https://github.com/kizniche/mycodo/issues/863))\n - Fix Message and New Line options in Custom Options\n - Fix Conditional sample_rate not being set from Config\n - Fix Saving Angular and Solid Gauge Widget stop values ([#916](https://github.com/kizniche/mycodo/issues/916))\n - Fix uncaught exception if trying to acquire image when opencv can't detect a camera ([#917](https://github.com/kizniche/mycodo/issues/917))\n - Fix displaying input/output pypi.org dependencies with \"==\"\n - Fix pressure measurement in BME680 and BME280 Inputs ([#923](https://github.com/kizniche/mycodo/issues/923))\n - Fix controllers disappearing following reorder ([#925](https://github.com/kizniche/mycodo/issues/925))\n - Fix Inputs that use w1thermsensor ([#926](https://github.com/kizniche/mycodo/issues/926))\n - Fix issue generating documentation for similar Inputs/Outputs/Widgets\n - Fix execution of Input stop_input()\n - Fix Input Pre-Outputs not turning on\n - Fix Output not activating for Camera\n - Fix PWM trigger and Duration Method ([#937](https://github.com/kizniche/mycodo/issues/937))\n - Fix stopping Trigger Controllers ([#940](https://github.com/kizniche/mycodo/issues/940))\n - Fix Tags not appearing in Graph Widgets\n - Fix variable measurement Inputs saving correctly\n - Fix detection of custom_option save type (CSV or JSON) for proper parsing\n - Fix saving of unchecked checkboxes when using forms\n\n### Features\n\n - Add Digital-to-Analog Converter output support (and add MCP4728) ([#893](https://github.com/kizniche/mycodo/issues/893))\n - Add Stepper Motor Controller output support (and add DRV8825) ([#857](https://github.com/kizniche/mycodo/issues/857))\n - Add Output: GrovePi multi-channel relay I2C board\n - Add Output: PCA9685 16-channel PWM servo/LED controller\n - Add Input: MAX31865 (CircuitPython) ([#900](https://github.com/kizniche/mycodo/issues/900))\n - Add Input: Generic Hall Effect Flow sensor\n - Add Input: INA219 current sensor\n - Add Input: Grove Pi DHT11/22 sensor\n - Add Input: HC-SR04 Ultrasonic Distance sensor\n - Add Input: SCD30 CO2/Humidity/Temperature sensor\n - Add Input: Current Weather from OpenWeatherMap.org (Free API Key, Latitude/Longitude, 200,000 cities, Humidity/Temperature/Pressure/Dewpoint/Wind Speed/Wind Direction)\n - Add Input: Forecast Hourly/Daily Weather from OpenWeatherMap.org (Free API Key, , Humidity/Temperature/Pressure/Dewpoint)\n - Add Input: Raspberry Pi Sense HAT (humidity/temperature/pressure/compass/magnetism/acceleration/gyroscope)\n - Add Input: Xiaomi Mijia LYWSD03MMC\n - Add Input: Atlas Scientific CO2 sensor\n - Add Input: AHTx0 Temperature/Humidity sensor\n - Add Input: BME680 (Circuitpython)\n - Add measurements to Custom Controllers\n - Add Measurement and Unit: Speed, Meters/Second\n - Add Measurement and Unit: Direction, Bearing\n - Add Conversions: m/s <-> mph <-> knots, hour <-> minutes and seconds\n - Add LCD: Grove RGB LCD\n - Add Function: Bang-bang/hysteretic\n - Add Function Action: Output Value\n - Add Function Action: Set LCD Backlight Color\n - Add configurable link for navbar brand link\n - Add User option to Shell Command Function Action\n - Add Message and New Line options to Custom Options of Outputs\n - Add set_custom_option/get_custom_option to Conditionals ([#901](https://github.com/kizniche/mycodo/issues/901))\n - Add ability to login with username/password using MQTT Input and Outputs\n - Add ability to use Custom Channel Options with Inputs (first used in MQTT Input)\n - Add Custom Functions/Inputs/Outputs/Widgets to Settings Export/Import\n - Add user_scripts directory for user code that's preserved during upgrade/export/import ([#930](https://github.com/kizniche/mycodo/issues/930))\n - Add pin mode option (float, pull-up, pull-down) for Edge and State Inputs\n - Add Method: Cascaded Method, allows combining (multiply) any number of existing methods\n - Add Functions and to API\n - Add missing Input Channels to Input API calls\n\n### Miscellaneous\n\n - Remove lirc\n - Change widget title styles\n - Fix GCC warnings ([#906](https://github.com/kizniche/mycodo/issues/906))\n - Remove default user \"pi\" with \"mycodo\" (for compatibility with non-Raspberry Pi operating systems)\n - Update pyusb to 1.1.1\n - Refactor Edge detection Input\n - Refactor method implementation from single large method into multiple small classes\n - Changed duration method start- and end-time handling\n - Port Math controllers to Functions: Equation (Single/Multi), Difference, Statistics (Single/Multi), Average (Single/Multi), Sum (Single/Multi), Wet-Bulb Humidity, Redundancy, Vapor Pressure Deficit, Verification\n - Deprecate Math controllers\n - Remove Math controllers from and add Functions to Live page\n\n\n## 8.8.8 (2020-10-30)\n\n### Bugfixes\n\n - Fix PiOLED (CircuitPython) ([#842](https://github.com/kizniche/mycodo/issues/842))\n\n### Miscellaneous\n\n - Update Polish translations\n\n\n## 8.8.7 (2020-10-27)\n\n### Bugfixes\n\n - Fix missing default values when adding new controllers ([#868](https://github.com/kizniche/mycodo/issues/868))\n - Fix catching loss of internet connection during upgrade ([#869](https://github.com/kizniche/mycodo/issues/869))\n - Fix Function Actions Output PWM and Output PWM Ramp not working ([#865](https://github.com/kizniche/mycodo/issues/865))\n - Fix dependencies not being installed for LCDs\n - Fix saving when missing/malformed custom_options JSON present ([#866](https://github.com/kizniche/mycodo/issues/866))\n\n### Features\n\n - Add LCDs: 128x32 and 128x64 PiOLED using the Adafruit CircuitPython library ([#842](https://github.com/kizniche/mycodo/issues/842))\n\n\n## 8.8.6 (2020-10-07)\n\n### Bugfixes\n\n - Fix order of Atlas Scientific pH sensor calibration points ([#861](https://github.com/kizniche/mycodo/issues/861))\n\n### Features\n\n - Add Polish translation\n\n\n## 8.8.5 (2020-10-01)\n\n### Bugfixes\n\n - Fix Output Widgets not able to control outputs\n - Fix ADS1256 ([#854](https://github.com/kizniche/mycodo/issues/854))\n - Fix PID controllers not obeying minimum off duration ([#859](https://github.com/kizniche/mycodo/issues/859))\n\n\n## 8.8.4 (2020-09-28)\n\n### Bugfixes\n\n - Increase nginx proxy buffer to accommodate large headers ([#849](https://github.com/kizniche/mycodo/issues/849))\n - Fix URL generation for cameras ([#850](https://github.com/kizniche/mycodo/issues/850))\n - Fix display of Output data on Asynchronous Graphs ([#847](https://github.com/kizniche/mycodo/issues/847))\n\n\n## 8.8.3 (2020-09-15)\n\n### Bugfixes\n\n - Fix inability to create Angular Gauge Widget with more than 4 stops ([#844](https://github.com/kizniche/mycodo/issues/844))\n - Fix issue with Python Code Input ([#846](https://github.com/kizniche/mycodo/issues/846))\n - Fix issue with install ([#845](https://github.com/kizniche/mycodo/issues/845))\n\n\n## 8.8.2 (2020-09-13)\n\n### Bugfixes\n\n - Fix PID Controller not operating ([#843](https://github.com/kizniche/mycodo/issues/843))\n - Fix inability to switch any output except channel 0 from web interface ([#840](https://github.com/kizniche/mycodo/issues/840))\n - Minor fixes for PCF8574 Output\n - Fix Atlas Pump recording two pump durations\n\n### Features\n\n - Add ability to select method in Input/Output/Function controller custom options\n\n\n## 8.8.1 (2020-09-09)\n\n### Bugfixes\n\n - Fix partially broken upgrade to new output system\n - Fix GPIO output startup states\n\n\n## 8.8.0 (2020-09-08)\n\nThis release changes the Output framework to add the ability for a single Output to control multiple channels. This was originally based on the PCF8574 8-bit I/O Expander, which allows 8 additional IO pins to be controlled via the I2C bus, but applies to any other output device with more than one channel. As a result of this change, you will need to update any Custom Outputs to follow the new format (see /mycodo/outputs directory).\n\n### Bugfixes\n\n - Fix inability to save Python Code Input settings ([#827](https://github.com/kizniche/mycodo/issues/827))\n - Fix Cameras not appearing in Camera Widget ([#828](https://github.com/kizniche/mycodo/issues/828))\n - Fix inability to save Pause PID Function Action ([#836](https://github.com/kizniche/mycodo/issues/836))\n - Fix error diaplying Measurement or Gauge Widgets with Math controllers using non-default units ([#831](https://github.com/kizniche/mycodo/issues/831))\n - Fix default values not displaying for Input/Output Custom Actions\n - Fix some apt packages being detected as installed when they are not installed\n \n### Features\n\n - Convert Input module custom_options from CSV to JSON\n - Add Anyleaf ORP and pH Inputs ([#825](https://github.com/kizniche/Mycodo/pull/825))\n\n### Miscellaneous\n\n - Remove unused Output selection in Methods\n\n\n## 8.7.2 (2020-08-23)\n\n### Bugfixes\n\n - Fix issue displaying Measurement Widgets when a Math measurement is selected ([#817](https://github.com/kizniche/mycodo/issues/817))\n - Fix inability to generate Widget HTML ([#817](https://github.com/kizniche/mycodo/issues/817), [#822](https://github.com/kizniche/mycodo/issues/822))\n\n### Features\n\n - Add ability to duplicate a dashboard and its widgets ([#812](https://github.com/kizniche/mycodo/issues/812))\n\n\n## 8.7.1 (2020-08-10)\n\n### Bugfixes\n\n - Remove copy of widget HTML files during upgrade\n\n\n## 8.7.0 (2020-08-10)\n\nThis update includes the final refactoring of the output system to accommodate output modules that can operate multiple different types of output types. For instance, a peristaltic pump can be instructed to turn on for a duration or instructed to pump a volume. As a result of the output framework being modified to accommodate this, the duty_cycle parameter was removed from ```output_on_off()``` and ```output_on()``` functions of the ```DaemonControl``` class of mycodo_client.py. As a result, if you were previously using either of these function, you will need to add the parameter ```output_type='pwm'``` and change the ```duty_cycle``` parameter to ```amount```. For example, ```output_on(output_id, duty_cycle=50)``` would need to be changed to ```output_on(output_id, output_type='pwm', amount=50)```, and ```output_on_off(output_id, 'on', duty_cycle=50)``` to ```output_on_off(output_id, 'on', output_type='pwm', amount=50)```.\n\nThis update also adds the ability to import custom Widget modules. Much like custom Inputs, Outputs, and Functions, you can now create and import your own single-file Widget module that allow new widgets to be added to a dashboard.\n\n### Bugfixes\n\n - Fix issue installing Python modules ([#804](https://github.com/kizniche/mycodo/issues/804))\n - Fix inability to save PID options when On/Off output selected ([#805](https://github.com/kizniche/mycodo/issues/805))\n - Fix graph shift issues\n - Fix PID Input/Math Setpoint Tracking unit and integer issue ([#811](https://github.com/kizniche/mycodo/issues/811))\n - Fix PID Controller debug logging ([#811](https://github.com/kizniche/mycodo/issues/811))\n - Fix bug in password reset function that would allow an attacker to discover if a user name doesn't exist\n\n### Features\n\n - Add Output: On/Off MQTT Publish\n - Add Output information links\n - Add ability to download Mycodo Backups ([#803](https://github.com/kizniche/mycodo/issues/803))\n - Add ability to import custom Widget modules\n - Add Widget Controller for background widget processes\n - Add Widget: Python Code ([#803](https://github.com/kizniche/mycodo/issues/803))\n - Add an option to the password reset function to save the reset code to a file\n\n### Miscellaneous\n\n - Deprecate duty_cycle parameter of output functions\n - Remove graph Shift X-Axis option\n - Move Autotune from PID Controller to Separate PID Autotune Controller ([#811](https://github.com/kizniche/mycodo/issues/811))\n\n\n## 8.6.4 (2020-07-25)\n\n### Bugfixes\n\n - Fix issue displaying lines 5-8 on SD1306 LCDs ([#800](https://github.com/kizniche/mycodo/issues/800))\n - Fix Atlas Scientific Pump duration unit issues ([#801](https://github.com/kizniche/mycodo/issues/801))\n\n### Features\n\n - Add Inputs: Ads1115 (Circuit Python library), ADS1015 (Circuit Python library)\n - Add Input: BMP280 (bmp280-python library, includes ability to set forced mode) ([#608](https://github.com/kizniche/mycodo/issues/608))\n\n### Miscellaneous\n\n - Deprecate Input using the Adafruit_ADS1x15 library\n\n\n## 8.6.3 (2020-07-25)\n\n### Bugfixes\n\n - Fix ADS1x15 Input\n\n\n## 8.6.2 (2020-07-25)\n\n### Bugfixes\n\n - Fix DS18S20 Input module ([#796](https://github.com/kizniche/mycodo/issues/796))\n - Fix Peristaltic Pump Outputs unable to turn on for durations ([#799](https://github.com/kizniche/mycodo/issues/799))\n\n### Features\n\n - Add a ([Building a Custom Input Module wiki page](https://github.com/kizniche/Mycodo/wiki/Building-a-Custom-Input)\n\n### Miscellaneous\n\n - Improve custom output framework\n - Consolidate locking code to utils/lockfile.py\n\n\n## 8.6.1 (2020-07-22)\n\n### Bugfixes\n\n - Fix Wireless 315/433 MHz Output module\n\n\n## 8.6.0 (2020-07-22)\n\nThis update adds a Generic Peristaltic Pump Output to compliment the Atlas Scientific Peristaltic Pump Output. Generic peristaltic pumps are less expensive but often have acceptable dispensing accuracy. Once your pump's flow rate has been measured and this rate set in the Output options, your pump can be used to dispense specific volumes of liquid just like the Atlas Scientific pumps. This release also enables pumps to dispense for durations of time in addition to specific volumes (once calibrated). So, you can now operate a PID controller or other functions/controllers that instruct a pump to dispense for a duration in seconds or a volume in milliliters.\n\nIn this update, the Atlas Scientific Peristaltic Pump Output duration units have been changed form minutes to seconds, to align with other Outputs that use the second SI unit.\n\nWARNING: As a result of how this new output operates, a potentially breaking change has been introduced. If you use any custom Output modules, you will need to add the parameter output_type=None to the output_switch() function of all of your custom Output module files. If you do not, the Mycodo daemon/backend will fail to start after upgrading to or beyond this version. It is advised to modify your custom Output modules prior to upgrading to ensure the daemon successfully starts after the upgrade. If you have not created or imported any custom Output modules, there is nothing that needs to be done.\n\n### Bugfixes\n\n - Fix measurement being stored in database after sensor error ([#795](https://github.com/kizniche/mycodo/issues/795))\n - Fix UART communication with Atlas Scientific devices ([#785](https://github.com/kizniche/mycodo/issues/785))\n - Fix FTDI communication with Atlas Scientific devices\n - Fix PID Dashboard Widget error in log when PID inactive\n - Fix install on Desktop version of Raspberry Pi OS by removing python3-cffi-backend\n - Fix inability to change I2C address of ADS1x15 Input ([#788](https://github.com/kizniche/mycodo/issues/788))\n - Fix issues with calibrating Atlas Scientific devices ([#789](https://github.com/kizniche/mycodo/issues/789))\n - Fix missing default input custom option values if not set in the database\n - Add missing TSL2561 I2C addresses\n - Fix daemon hang on use of incorrect Atlas Scientific UART device (add writeTimeout to every serial.Serial())\n - Fix uninstall of pigpiod\n - Fix missing pigpio dependency for GPIO PWM Outputs\n - Prevent LCD controllers from activating if Max Age or Decimal Places are unset ([#795](https://github.com/kizniche/mycodo/issues/795))\n\n### Features\n\n - Add Inputs: ADXL34x, ADT7410 ([#791](https://github.com/kizniche/mycodo/issues/791))\n - Add Output: Generic Peristaltic Pump\n - Add ability to turn peristaltic pumps on for durations (in addition to volumes)\n - Add Function Action: Output (Volume)\n - Improve general compatibility with Atlas Scientific devices\n - Add ability to utilize volume Outputs (pumps) with PID Controllers\n - Add pypi.org links to Input libraries in Input description information\n - Add SPI interface as an option for SD1306 LEDs ([#793](https://github.com/kizniche/mycodo/issues/793))\n\n### Miscellaneous\n\n - Change Atlas Scientific Peristaltic Pump Output duration unit from minute to second\n - Move clear total volume function for Atlas Scientific Flow Meter to Input Module\n - Add instruction for viewing the frontend web log on the web 502 error page ([#786](https://github.com/kizniche/mycodo/issues/786))\n\n\n## 8.5.8 (2020-07-07)\n\n### Bugfixes\n\n - Fix inability to install pigpio ([#783](https://github.com/kizniche/mycodo/issues/783))\n\n\n## 8.5.7 (2020-07-07)\n\n### Bugfixes\n\n - Fix inability to install internal dependencies (pigpio, bcm2835, etc.) ([#783](https://github.com/kizniche/mycodo/issues/783))\n\n\n## 8.5.6 (2020-06-30)\n\n### Bugfixes\n\n- Fix API database schema issue\n\n\n## 8.5.5 (2020-06-30)\n\n### Bugfixes\n\n - Prevent user with insufficient permissions from rearranging dashboard widgets\n - Fix installing internal dependencies\n - Fix restore of influxdb measurement data from import/Export page\n - Fix Gauge Widget Measurement options from being selected after saving\n\n### Features\n\n - Create scripts to automatically generate Input section of manual\n\n### Miscellaneous\n\n - Add URLs to Input information\n - Switch from deprecated SSLify to Talisman\n - Update Python dependencies\n\n\n## 8.5.4 (2020-06-06)\n\n### Bugfixes\n\n - Fix Atlas Scientific pump on duration calculation\n\n\n## 8.5.3 (2020-06-06)\n\n### Bugfixes\n\n - Fix upgrade not preserving custom outputs\n - Fix missing output device measurements in database ([#779](https://github.com/kizniche/mycodo/issues/779))\n\n\n## 8.5.2 (2020-06-01)\n\n### Bugfixes\n\n - Fix Atlas Scientific Pump Output timestamp parsing\n\n\n## 8.5.1 (2020-05-30)\n\n### Bugfixes\n\n - Fix translations\n - Fix dependency check during upgrade\n - Fix Atlas Scientific Pump Output\n\n\n## 8.5.0 (2020-05-30)\n\nWith this release comes the ability to write and import custom Outputs. If you want to utilize an output that Mycodo doesn't currently support, you can now create your own Output module and import it to be used within the system. See [Custom Outputs](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#custom-outputs) in the manual for more information.\n\nWARNING: There are changes with this version that may cause issues with your currently-configured outputs. Therefore, after upgrading, test if your outputs work and update their configuration if needed.\n\n### Bugfixes\n\n - Fix PID Widget preventing graph custom colors from being editable\n - Fix graph Widget custom color issues ([#760](https://github.com/kizniche/mycodo/issues/760))\n - Fix PWM Trigger Functions reacting to 0 % duty cycle being set ([#761](https://github.com/kizniche/mycodo/issues/761))\n - Fix KeyError if missing options when saving Input\n - Fix ZH03B Input: add repeat measurement option and discard erroneous measurements\n - Fix update check IndexError if there's no internet connection\n - Fix parsing API api_key from requests\n - Fix the inability of Math Controllers to use converted measurements\n - Fix Redundancy Math controller ([#768](https://github.com/kizniche/mycodo/issues/768))\n - Fix display of Custom Controller options\n - Fix hostname display on login page\n - Fix missing blank line check for LCDs with 8 lines ([#771](https://github.com/kizniche/mycodo/issues/771))\n - Fix unset user groups when executing shell commands\n - Fix guest users being able to create dashboards\n - Fix queries with updated influxdb Python library\n\n### Features\n\n - Add ability to write and import your own Custom Output Modules\n - Add Input: VL53L0X (Laser-Range Measurement) ([#769](https://github.com/kizniche/mycodo/issues/769))\n - Add Input: AS7262 Spectral Sensor (measures 450, 500, 550, 570, 600, and 650 nm wavelengths)\n - Add Input: Atlas Scientific EZO Pressure Sensor\n - Add ability to create custom Input actions\n - Add MH-Z19/MH-Z19B Input actions: zero and span point calibrations\n - Add unit conversions: PSI to kPa, PSI to cm H2O, kPa to PSI\n - Add literature links to Input options: Manufacturer, Datasheet, Product\n - Add 'tail dmesg' to System Information page\n - Add Function Actions: System Restart and System Shutdown ([#763](https://github.com/kizniche/mycodo/issues/763))\n - Add Conditional options: Log Level Debug and Message Includes Code\n - Add Force Command option for Command/Python/Wireless Outputs ([#728](https://github.com/kizniche/mycodo/issues/728))\n - Add ability to select which user executes Linux Output commands ([#719](https://github.com/kizniche/mycodo/issues/719))\n - Add Cameras: URL (urllib), URL (requests) \n - Add ability to encode videos from time-lapse image sets\n - Add send_email() to Daemon Control object\n\n### Miscellaneous\n\n - Upon controller activation, generate Input and Conditional code files if they don't exist\n - Update Werkzeug to 1.0.1 ([#742](https://github.com/kizniche/mycodo/issues/742)), Flask-RESTX to 0.2.0, alembic to 1.4.2, pyro5 to 5.8, SQLAlchemy to 1.3.15, distro to 1.5.0,\n - Refactor Python Output code \n - Update all translations (all complete)\n - Rename MH-Z19 Input to MH-Z19B (and add MH-Z19 Input)\n - Change Email Notification options to allow unauthenticated sending\n - Add conversions: m <-> cm <-> mm\n - Make PID Controller a class\n - Restyle Output page ([#732](https://github.com/kizniche/mycodo/issues/732))\n - Include error response in PWM/On-Off Command Output debug logging line\n - Update InfluxDB to 1.8.0\n\n\n## 8.4.0 (2020-03-23)\n\n### Bugfixes\n\n - Fix invalid links to Help pages\n - Prevent unstoppable Conditional Controller by adding self.running bool variable\n - Fix calculation error causing inaccuracy with ADS1x15 analog-to-digital converter Input\n - Remove PWM and Pump Outputs from Energy Usage calculations\n - Fix links to camera widget error images\n - Fix reference to input library to properly display 1-Wire device IDs ([#752](https://github.com/kizniche/mycodo/issues/752))\n - If a camera output is already on when capturing an image, dont' turn it off after capture\n - Discard first measurement of Atlas Scientific Inputs to prevent some erroneous measurements\n - Fix display of setpoint on PID widget if a band is in use ([#744](https://github.com/kizniche/mycodo/issues/744))\n - Fix Amp calculation ([#758](https://github.com/kizniche/mycodo/issues/758))\n\n### Features\n\n - Add temperature compensation option for the Atlas Scientific Electrical Conductivity and Dissolved Oxygen Inputs\n - Add Inputs: Atlas Scientific Flow Sensor, Atlas Scientific RGB Color Sensor\n - Add Function Action: Clear Total Volume of Flow Meter, Force Input Measurements\n - Add option to repeat measurements and store average for ADS1x15 analog-to-digital converter Input\n - Add PID option Always Min for PWM outputs to always use at least the min duty cycle ([#757](https://github.com/kizniche/mycodo/issues/757))\n - Add email password reset\n\n### Miscellaneous\n\n - Add prefix to device IDs when using w1thermsensor ([#752](https://github.com/kizniche/mycodo/issues/752))\n\n\n## 8.3.0 (2020-02-21)\n\n### Bugfixes\n\n - Fix determining frontend/backend virtualenv status\n - Fix error detecting GPIO state during energy usage report generation ([#745](https://github.com/kizniche/mycodo/issues/745))\n - Fix Atlas Scientific pH Input temperature calibration measurement\n - Fix Atlas Scientific EZO-PMP flow mode not taking effect immediately upon saving\n - Change deprecated w1thermsensor set_precision() to set_resolution()\n - Fix setting DS sensor resolution ([#747](https://github.com/kizniche/mycodo/issues/747))\n - Split DS18B20 Input into two files (one using w1thermsensor and another using ow-shell) ([#746](https://github.com/kizniche/mycodo/issues/746))\n - Prevent users without \"view settings\" permission from viewing email addresses\n - Fix TSL2561 input ([#750](https://github.com/kizniche/mycodo/issues/750))\n\n### Features\n\n - Add Temperature Offset option for BME680 Input ([#735](https://github.com/kizniche/mycodo/issues/735))\n - Add ability to change number of stops for Gauge Widgets ([#749](https://github.com/kizniche/mycodo/issues/749))\n\n### Miscellaneous\n\n - Fix logging level of calibration functions\n - Populate setpoint in field of PID dashboard widget ([#748](https://github.com/kizniche/mycodo/issues/748))\n\n\n## 8.2.5 (2020-02-09)\n\n### Bugfixes\n\n - Fix daemon not being able to read measurements ([#743](https://github.com/kizniche/mycodo/issues/743))\n\n\n## 8.2.4 (2020-02-08)\n\n### Bugfixes\n\n - Fix logs appearing blank after logrotate runs ([#734](https://github.com/kizniche/mycodo/issues/734))\n - Update Flask-Babel to 1.0.0 to fix broken werkzeug ([#742](https://github.com/kizniche/mycodo/issues/742))\n - Increase install wait times to prevent timeouts ([#742](https://github.com/kizniche/mycodo/issues/742))\n\n### Features\n\n - Add BME680 temperature/humidity/pressure/VOC sensor ([#735](https://github.com/kizniche/mycodo/issues/735))\n - Add measurement: resistance\n - Add unit: Ohm\n - Merge from [Flask-RESTPlus](https://github.com/noirbizarre/flask-restplus/issues/770) to [Flask-RESTX](https://github.com/python-restx/flask-restx) ([#742](https://github.com/kizniche/mycodo/issues/742))\n\n### Miscellaneous\n\n - Improve sanity-checking of Input custom_options\n - Improve sanity-checking of API endpoints ([#741](https://github.com/kizniche/mycodo/issues/741))\n - Update pip requirements\n\n\n## 8.2.3 (2020-01-27)\n\n### Bugfixes\n\n - Fix error during upgrade check if there is no internet connection\n - Fix MQTT input, prevent keepalive from being <= 0 ([#733](https://github.com/kizniche/mycodo/issues/733))\n - Fix issue restarting frontend using diagnostic database delete feature\n - Fix ability to import Inputs with measurements/units that don't exist in database ([#735](https://github.com/kizniche/mycodo/issues/735))\n - Fix ability to modify measurement/unit names that Inputs rely on\n - Fix inability to modify custom measurements\n - Fix error when deleting dashboards from the Config->Diagnostics menu ([#737](https://github.com/kizniche/mycodo/issues/737))\n - Fix dashboard gauges causing the dashboard to crash ([#736](https://github.com/kizniche/mycodo/issues/736))\n\n### Miscellaneous\n\n - Refactor upgrade check code into class to reduce the number of hits to github.com\n - Rearrange dashboard dropdown menu\n - Allow creation of measurement/unit IDs with upper-case letters ([#735](https://github.com/kizniche/mycodo/issues/735))\n\n## 8.2.2 (2020-01-06)\n\n### Bugfixes\n\n - Fix table colors ([#724](https://github.com/kizniche/mycodo/issues/724))\n - Fix error when dashboard is set to default landing page ([#727](https://github.com/kizniche/mycodo/issues/727))\n\n### Features\n\n - Add options to show/hide various widget info ([#717](https://github.com/kizniche/mycodo/issues/717))\n - Add Input: MLX90614 ([#723](https://github.com/kizniche/mycodo/pull/723))\n\n### Miscellaneous\n\n - Update Bootstrap to 4.4.1\n - Update Bootstrap themes\n\n\n## 8.2.1 (2019.12.08)\n\nThis update brings the ability to create multiple dashboards. The dashboard grid spacing has also changed, so you will need to resize your widgets.\n\nThis update also brings the ability to run Mycodo/Influxdb in Docker containers, enabling Mycodo to run outside the Raspberry Pi and Raspbian environment. For instance, I currently have Mycodo running on my 64-bit PC in Ubuntu 18.04. This is an experimental feature and is not yet recommended to be used in a production environment. See the [Docker README](https://github.com/kizniche/Mycodo/blob/master/docker/README.md) for more information.\n\n### Features\n\n - Add ability to run Mycodo in Docker containers ([#637](https://github.com/kizniche/mycodo/issues/637))\n - Add ability to create multiple dashboards ([#717](https://github.com/kizniche/mycodo/issues/717))\n - Add Dashboard Widget: Spacer ([#717](https://github.com/kizniche/mycodo/issues/717))\n - Add ability to hide Widget drag handle, set Widget name font size, and hide Graph Widget buttons ([#717](https://github.com/kizniche/mycodo/issues/717))\n - Add ability to set Dashboard grid cell height\n\n### Miscellaneous\n\n - Change grid width from 12 to 20 columns\n - Update InfluxDB from 1.7.8 to 1.7.9\n\n\n## 8.1.1 (2019.11.26)\n\n### Bugfixes\n\n - Fix outputs not turning on\n\n\n## 8.1.0 (2019.11.26)\n\nThis update brings a new Dashboard organization method, allowing drag-and drop placement and resizing of widgets using gridstack.js. This new system is not comparable to the old; and after upgrading, all widgets will lose their size and position and will need to be repositioned on your dashboard.\n\n### Bugfixes\n\n - Fix Atlas Scientific UART interfaces\n - Fix display of units in conversion list on Measurement Settings page\n - Fix unit conversions for Math controllers ([#716](https://github.com/kizniche/mycodo/issues/716))\n - Fix Wet-Bulb Humidity calculation in Math controller ([#716](https://github.com/kizniche/mycodo/issues/716))\n - Fix disabled measurements not appearing for math controllers ([#716](https://github.com/kizniche/mycodo/issues/716))\n - Fix disabled measurements from Math controllers still being recorded in influxdb\n - Fix inability to select PID Controller with PID Control Widget ([#718](https://github.com/kizniche/mycodo/issues/718))\n - Fix displaying image in Camera Widgets\n - Fix display of measurement unit on Gauge Widgets\n\n### Features\n\n - Implement new method for arranging and sizing Dashboard Widgets ([#717](https://github.com/kizniche/mycodo/issues/717))\n - Add API endpoints: /measurements/historical and /measurements/historical_function\n - Add ability to set timestamp with /measurements/create API endpoint\n - Display the entire log for the ongoing upgrade rather than only the last 40 lines\n - Add Calibration: Atlas Scientific Electrical Conductivity Sensor ([#710](https://github.com/kizniche/mycodo/issues/710))\n - Add Input: Mycodo Version (mainly for testing)\n - Allow timestamp to be specified for Python 3 Code Input measurement creation ([#716](https://github.com/kizniche/mycodo/issues/716))\n\n### Miscellaneous\n\n - Update Bootstrap to 4.3.1\n - Update FontAwesome to 5.11.2\n\n\n## 8.0.3 (2019.11.15)\n\n### Bugfixes\n\n - Fix timeout errors during settings/influxdb database import\n - Fix python3 version check during install ([#714](https://github.com/kizniche/mycodo/issues/714))\n - Fix upgrade checking\n \n\n## 8.0.2 (2019.11.13)\n\n### Bugfixes\n\n - Fix doubling the amount used to calculate Amp draw during an output being turned on\n\n\n## 8.0.1 (2019.11.11)\n\n### Bugfixes\n\n - Add Python version check to Mycodo installer ([#712](https://github.com/kizniche/mycodo/issues/712))\n - Daemon now checks for any newer version during upgrade check\n\n### Features\n\n - Allow any database version <= the currently-installed Mycodo version to be imported\n\n\n## 8.0.0 (2019.11.09)\n\nWarning: This version will not work with Python 3.5 (Raspbian Stretch). Only upgrade if you have Python 3.7 installed (Raspbian Buster).\n\nThis version introduces an improved upgrade system and a REST API (requiring Python >= 3.6) for communicating with Mycodo ([API Info](https://github.com/kizniche/Mycodo/blob/master/mycodo-api.rst) and [API Manual](https://kizniche.github.io/Mycodo/mycodo-api.html)).\n\n### Features\n\n - Add REST API ([#705](https://github.com/kizniche/mycodo/issues/705))\n\n\n## 7.10.0 (2019.11.09)\n\n### Bugfixes\n\n - Fix Output control toaster always displaying error\n - Fix translations not working ([#708](https://github.com/kizniche/mycodo/issues/708))\n - Fix display of units on LCDs\n - Fix inability of Graph Range Selector option to stay checked\n\n### Features\n\n - Add button to copy device UUID to clipboard\n - Add ability to set IP, port, and timeout for upgrade internet check\n - Add new Camera library: opencv\n - Add ability for variables to persist in Conditional statements\n - Add ability to import any database <= the current Mycodo version (database upgrade will be performed)\n - Add ability to install all unmet dependencies when importing a database\n - Improve upgrade system\n\n\n## 7.9.1 (2019.10.26)\n\n### Bugfixes\n\n - Fix issue querying data for Asynchronous graphs\n\n### Features\n\n - Add ability to select duty cycle step size for PWM Ramp Function Action ([#704](https://github.com/kizniche/mycodo/issues/704))\n\n\n## 7.9.0 (2019.10.24)\n\nThis update improves the backup/restore mechanism for the Mycodo InfluxDB time-series database. InfluxDB backups made prior to v7.8.5 will need to be restored manually. All new backups made will be in the Enterprise-compatible backup format, and only this format will be able to be restored moving forward. See [Backing up and restoring in InfluxDB](https://docs.influxdata.com/influxdb/v1.7/administration/backup_and_restore/) for more information.\n\nThis update also moves the Camera options from the Settings to the Camera page, to be more in-line with the formatting of other pages.\n\n### Bugfixes\n\n - Fix Asynchronous Graphs not displaying data\n - Fix Conditional Measurement (Multiple) Condition error\n - Fix inability to set Raspberry Pi (raspi-config) settings from the Configuration menu\n\n### Features\n\n - Update InfluxDB database export/import to use new Enterprise-compatible backup format\n - Add general camera options: stream height/width, hide last still, and hide last timelapse ([#703](https://github.com/kizniche/mycodo/issues/703))\n - Add picamera options: white balance, shutter speed, sharpness, iso, exposure mode, meter mode, and image effect ([#313](https://github.com/kizniche/mycodo/issues/313), [#703](https://github.com/kizniche/mycodo/issues/703))\n - Add Function Action: Ramp PWM ([#704](https://github.com/kizniche/mycodo/issues/704))\n - Add Conditional Conditions: Measurement (Single, Past, Average), Measurement (Single, Past, Sum) ([#636](https://github.com/kizniche/mycodo/issues/636))\n\n### Miscellaneous\n\n - Move camera settings from Settings page to Camera page\n\n\n## 7.8.4 (2019.10.18)\n\n### Bugfixes\n\n - Actually fix inability to save PID options ([#701](https://github.com/kizniche/mycodo/issues/701))\n\n\n## 7.8.3 (2019.10.18)\n\n### Bugfixes\n\n - Fix inability to save PID options ([#701](https://github.com/kizniche/mycodo/issues/701))\n\n\n## 7.8.2 (2019.10.17)\n\n### Bugfixes\n\n - Fix Output Action\n\n\n## 7.8.1 (2019.10.15)\n\n### Bugfixes\n\n - Fix copying custom controllers during upgrade\n\n\n## 7.8.0 (2019.10.14)\n\nThis release brings a big feature: Custom Controllers. Now users can import Custom Controllers just like Custom Inputs. There is a new settings section of the Configuration menu called Controllers, where a single-file Custom Controller can be imported into Mycodo. This new controller will appear in the dropdown list on the Functions page, and will act like any other function controller (PID, Trigger, LCD, etc.). See the [Custom Controllers](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#custom-controllers) section of the manual.\n\nThere's also a new Android app, [Mycodo Support](https://play.google.com/store/apps/details?id=com.mycodo.mycododocs) that provides access to several Mycodo support resources.\n\n### Bugfixes\n\n - Fix Atlas Scientific EZP Pump not working with PID Controllers ([#562](https://github.com/kizniche/mycodo/issues/562))\n - Fix Output page not showing Duty Cycle for PWM Output status\n - Fix blank Live page if Inputs added but not yet activated\n - Fix inability to capture photos with USB camera ([#677](https://github.com/kizniche/mycodo/issues/677))\n - Fix issues related to influxdb not fully starting before the Mycodo daemon\n - Fix timeout exporting large amounts of data\n\n### Features\n\n - Add ability to import Custom Controllers (See [Custom Controllers](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#custom-controllers))\n - Add ability to set PWM Output startup and shutdown state ([#699](https://github.com/kizniche/mycodo/issues/699))\n - Add Dashboard Widget: Output PWM Range Slider ([#699](https://github.com/kizniche/mycodo/issues/699))\n - Add ability to use Input/Math measurements with PID setpoint tracking ([#639](https://github.com/kizniche/mycodo/issues/639))\n - Add search to Function select\n\n### Miscellaneous\n\n - Remove Flask_influxdb\n - Upgrade Influxdb from 1.7.6 to 1.7.8\n\n\n## 7.7.9 (2019.09.29)\n\n### Bugfixes\n\n - Fix issue displaying Outputs on Asynchronous Graph\n\n### Features\n\n - Add Start Offset option for Inputs\n - Add ability to disable Graph series Data Grouping\n\n### Miscellaneous\n\n - Rename Conditional Statement measure() to condition() in Conditional Controllers\n - Add description for all Conditional Conditions and Actions\n\n\n## 7.7.8 (2019.09.22)\n\n### Bugfixes\n\n - Fix LCD controller\n\n### Miscellaneous\n\n - PEP8\n - Improve error/debug logging\n\n\n## 7.7.7 (2019.09.20)\n\n### Bugfixes\n\n - Add reset to SHT31 Input when it errors ([#695](https://github.com/kizniche/mycodo/issues/695))\n\n### Features\n\n - Add LCD Line: Custom Text\n - Add Input: BME280 using RPi.bme280 library ([#694](https://github.com/kizniche/mycodo/issues/694))\n - Add \"Library\" to distinguish inputs that use different libraries to acquire measurements for the same sensor\n\n\n## 7.7.6 (2019.09.19)\n\n### Bugfixes\n\n - Fix Outputs not showing up on Dashboard and mislabeled measurements ([#692](https://github.com/kizniche/mycodo/issues/692))\n - Update wiringpi to fix issue with Raspberry Pi 4 board ([#689](https://github.com/kizniche/mycodo/issues/689))\n\n### Features\n\n - Add Conditional Conditions: Output Duration On, Controller Running ([#691](https://github.com/kizniche/mycodo/issues/691))\n - Remove the need for Pyro5 Nameserver ([#692](https://github.com/kizniche/mycodo/issues/692))\n - Add Flask profiler\n\n\n## 7.7.5 (2019.09.18)\n\n### Bugfixes\n\n - Fix inability to activate Conditional Controllers ([#690](https://github.com/kizniche/mycodo/issues/690))\n\n### Miscellaneous\n\n - Improve post-alembic upgrade system\n - Improve Pyro5 logging\n\n\n## 7.7.4 (2019.09.18)\n\n### Bugfixes\n\n - Fix issue with Pyro5 proxy handling ([#688](https://github.com/kizniche/mycodo/issues/688))\n - Fix missing Stdout from several log files\n\n\n## 7.7.3 (2019.09.17)\n\n### Bugfixes\n\n - Fix wait time for Atlas Scientific pH Calibration ([#686](https://github.com/kizniche/mycodo/issues/686))\n - Add 'minute' measurement storage to EZO Pump Output\n - Fix database upgrade issues\n\n### Features\n\n - Add ability to store multiple measurements for Outputs ([#562](https://github.com/kizniche/mycodo/issues/562))\n - Add Calibration: Atlas Scientific EZO Pump ([#562](https://github.com/kizniche/mycodo/issues/562))\n - Add ability to select pump modes for Atlas Scientific EZO Pump ([#562](https://github.com/kizniche/mycodo/issues/562))\n - Add ability to enable Daemon debug mode from Configuration page\n - Add ability to use FTDI to communicate with Atlas Scientific EZO Pump\n - Upgrade from Pyro4 to Pyro5\n\n\n## 7.7.2 (2019.09.14)\n\n### Bugfixes\n\n - Remove redundant alembic upgrade that can cause upgrade errors\n - Fix moving Conditional/input code during upgrade\n - Generate Conditional/input code for next upgrade\n - Fix MQTT Input ([#685](https://github.com/kizniche/mycodo/issues/685))\n - Fix Atlas Scientific EZO Pump Input issue ([#562](https://github.com/kizniche/mycodo/issues/562))\n - Fix Atlas Scientific EZP Pump Output (UART) error on Output page\n - Fix Atlas Scientific pH Input issue ([#686](https://github.com/kizniche/mycodo/issues/686))\n - Fix issues with calibration of Atlas Scientific pH sensor ([#686](https://github.com/kizniche/mycodo/issues/686))\n\n### Features\n\n - Add ability to choose 1, 2, or 3 point pH calibration of Atlas Scientific pH sensor ([#686](https://github.com/kizniche/mycodo/issues/686))\n\n\n## 7.7.1 (2019.09.08)\n\n### Bugfixes\n\n - Fix issue with Pyro4\n - Fix issue with Trigger controllers\n\n\n## 7.7.0 (2019.09.08)\n\nThis release changes how user-created Python code is executed. This affects Python Code Inputs and Conditional Functions. All effort was made to reformat user scripts during the upgrade process to adhere to the new formatting guidelines, however there are a few instances where scripts could not be updated properly and will need to be done manually by the user before they will work properly. After upgrading your system, ensure your code conforms to the following guidelines:\n\n1. Conditional Functions\n   * Use 4-space indentation (not 2-space, tab, or other)\n   * Change measure() to self.measure()\n   * Change measure_dict() to self.measure_dict()\n   * Change run_action() to self.run_action()\n   * Change run_all_actions() to self.run_all_actions()\n   * Change message to self.message\n2. Python Code Inputs\n   * Use 4-space indentation (not 2-space, tab, or other)\n   * Change store_measurement() to self.store_measurement()\n\n### Bugfixes\n\n - Fix sunrise/sunset calculation\n - Fix inability to use \",\" in Input custom options\n - Fix install dependencies for Ruuvitag Input ([#638](https://github.com/kizniche/mycodo/issues/638))\n - Fix reliability issue with Ruuvitag Input (crashing Mycodo daemon) ([#638](https://github.com/kizniche/mycodo/issues/638))\n - Fix storing of SHT31 Smart Gadget erroneous measurements\n - Prevent Pyro4 TimeoutErrors from stopping PID and Conditional controllers\n - Improve Controller reliability/stability\n - Fix path to pigpiod ([#684](https://github.com/kizniche/mycodo/issues/684))\n\n### Features\n\n - Add Pylint test for Python 3 Code Input\n - Add execute_at_creation option for Inputs\n - Add Measurement: Radiation Dose Rate\n - Add Units: Microsieverts per hour (\u00b5Sv/hr), Counts per minute (cpm)\n - Add 'message' option for custom Inputs to display a message with the Input options in the web interface\n - Add more logs to view and consolidate \"View Logs\" page\n - Add automatic initialization of Input custom_options variables\n\n### Miscellaneous\n\n - Refactor how user-created Python code is executed (i.e. Python Code Inputs and Conditional Statements)\n - Refactor RPC by replacing RPyC with Pyro4 for improved system stability ([#671](https://github.com/kizniche/mycodo/issues/671), [#679](https://github.com/kizniche/mycodo/issues/679))\n - Increase Nginx file upload size\n - Reorganize menu layout\n - Modify linux_command exception-handling ([#682](https://github.com/kizniche/mycodo/issues/682))\n\n\n## 7.6.3 (2019-07-14)\n\n### Bugfixes\n\n - Fix calculating VPD\n\n### Features\n\n - Add Python 3 Code execution Input\n\n\n## 7.6.2 (2019-07-11)\n\n### Bugfixes\n\n - Various fixes for Raspbian Buster ([#668](https://github.com/kizniche/mycodo/issues/668))\n\n\n## 7.6.1 (2019-07-11)\n\n### Bugfixes\n\n - Fix TH1X-AM2301 Input ([#670](https://github.com/kizniche/mycodo/issues/670))\n\n\n## 7.6.0 (2019-07-10)\n\n### Bugfixes\n\n - Fix inability of Input custom_options value to be 0\n - Fix improper unit conversion for TH1X-AM2301 Input ([#670](https://github.com/kizniche/mycodo/issues/670))\n - Fix Bash Command Input script execution ([#667](https://github.com/kizniche/mycodo/issues/667))\n\n### Features\n\n - Add MQTT (paho) Input ([#664](https://github.com/kizniche/mycodo/issues/664))\n - Add timeout option for Linux Command Input\n\n\n## 7.5.10 (2019-06-17)\n\n### Bugfixes\n\n - Fix TTN Data Input timestamps\n\n\n## 7.5.9 (2019-06-16)\n\n### Bugfixes\n\n - Fix rare measurement issue with Ruuvitag\n - Ensure Output Controller has fully started before starting other controllers ([#665](https://github.com/kizniche/mycodo/issues/665))\n - Fix module path of mycodo_client.py when executed from symlink ([#665](https://github.com/kizniche/mycodo/issues/665))\n\n\n## 7.5.8 (2019-06-13)\n\n### Bugfixes\n\n - Fix \"getrandom() initialization failed\" with rng-tools ([#663](https://github.com/kizniche/mycodo/issues/663))\n - Fix issues with TH16/10 with AM2301 and Linux Command Inputs ([#663](https://github.com/kizniche/mycodo/issues/663))\n\n### Features\n\n - Add Debug Logging as an LCD option\n - Add traceback to error message during adding Input ([#664](https://github.com/kizniche/mycodo/issues/664))\n\n\n## 7.5.7 (2019-06-11)\n\n### Bugfixes\n\n - Fix Ruuvitag Input\n\n\n## 7.5.6 (2019-06-11)\n\n### Bugfixes\n\n - Fix issues with SHT31 Smart Gadget and Ruuvitag Inputs ([#638](https://github.com/kizniche/mycodo/issues/638))\n - Fix 500 Error generating measurement/unit choices ([#662](https://github.com/kizniche/mycodo/issues/662))\n - Change AM2320 Input code ([#585](https://github.com/kizniche/mycodo/issues/585))\n - Fix issue with Base Input\n\n### Features\n\n - Increase Live page measurement query duration to fix the display of Input measurements\n\n\n## 7.5.5 (2019-06-03)\n\n### Bugfixes\n\n - Add influxdb read/write wait timers to prevent connection errors at startup before influxdb has started\n\n### Features\n\n - Add --get_measurement parameter to mycodo_client.py\n \n### Miscellaneous\n\n - Replace locket with filelock\n\n\n## 7.5.4 (2019-05-29)\n\n### Bugfixes\n\n - Prevent rapid successive measurements from inputs after measurement delay\n - Increase lock timeout for Ruuvitag and SHT31 Smart Gadget ([#638](https://github.com/kizniche/mycodo/issues/638))\n - Fix IO error during locking for Ruuvitag ([#638](https://github.com/kizniche/mycodo/issues/638))\n - Fix pytests\n\n### Features\n\n - Add RPyC Timeout configuration option\n - Allow multiple PIDs to use the same output ([#661](https://github.com/kizniche/mycodo/issues/661))\n - Add timeout parameter to cmd_output() function\n \n### Miscellaneous\n\n - Refactor Min Off Duration to be centrally controlled by the Output Controller ([#660](https://github.com/kizniche/mycodo/issues/660))\n\n\n## 7.5.3 (2019-05-17)\n\n### Bugfixes\n\n - Prevent logging aberrant SHT31 Smart Gadget measurements\n - Handle type casting issues with Ruuvitag Input\n - Add Tags to Custom Colors selection of Graphs ([#656](https://github.com/kizniche/mycodo/issues/656))\n - Fix issues with Single Channel Sum and Average Math controllers\n - Fix inability to change Measurement Conversion back to \"Do Not Convert\"\n - Avoid build error with bcrypt 3.1.6 by lowering to version 3.1.4 ([#658](https://github.com/kizniche/mycodo/issues/658))\n - Fix issue with conversion calculation in wet-bulb humidity function\n\n### Features\n\n - Add Function Actions: Raise/Lower PID Setpoint ([#657](https://github.com/kizniche/mycodo/issues/657))\n\n### Miscellaneous\n\n - Add Unit: Pounds per square inch (psi) ([#657](https://github.com/kizniche/mycodo/issues/657))\n\n\n## 7.5.2 (2019-05-08)\n\n### Bugfixes\n\n - Fix issues with logging\n\n\n## 7.5.1 (2019-05-06)\n\n### Bugfixes\n\n - Fix bug in Input get_value() ([#654](https://github.com/kizniche/mycodo/issues/654))\n\n\n## 7.5.0 (2019-05-06)\n\n### Bugfixes\n\n - Fix storing latest SHT31 Smart Gadget measurements\n - Fix Base Input \\_\\_repr__ and \\_\\_str__\n - Fix unaccounted PID error if activation attempted when Measurement not set ([#649](https://github.com/kizniche/mycodo/issues/649))\n - Fix missing GPIO Pin sanity check ([#650](https://github.com/kizniche/mycodo/issues/650))\n - Fix \"Unknown math type\" filling log ([#651](https://github.com/kizniche/mycodo/issues/651))\n - Fix inability to stop PID autotune ([#651](https://github.com/kizniche/mycodo/issues/651))\n - Fix incomplete display of PID Settings on Mycodo Logs page\n\n### Features\n\n - Add Conditional Condition: Measurement (Multiple)\n - Add ability of Inputs to store measurements with the same or separate timestamps\n - Add option to show debug lines in Daemon Log (for Input/Math/PID/Trigger/Conditional)\n - Add Log Filters: Daemon INFO, Daemon DEBUG\n - Add Input: TH1x with DS18B20 ([#654](https://github.com/kizniche/mycodo/issues/654))\n\n### Miscellaneous\n\n - Update InfluxDB to 1.7.6\n\n\n## 7.4.3 (2019-04-17)\n\n### Bugfixes\n\n - Fix Sunrise/Sunset calculation\n - Update Infrared Remote section of manual to work with latest kernel\n - Add Bluetooth locking to prevent broken pipes\n\n### Features\n\n - Add Input: RuuviTag ([#638](https://github.com/kizniche/mycodo/issues/638))\n - Add Inputs: Atlas Scientific ORP, Atlas Scientific DO (FTDI, UART, I2C) ([#643](https://github.com/kizniche/mycodo/issues/643))\n - Add Reset Pin option and editable location for SD1306 OLED display ([#647](https://github.com/kizniche/mycodo/issues/647))\n\n\n## 7.4.2 (2019-04-02)\n\n### Bugfixes\n\n - Fix Average (single) and Sum (single) Math controllers with an Output selected\n\n\n## 7.4.1 (2019-04-02)\n\n### Bugfixes\n\n - Fix custom input preservation during upgrade\n\n\n## 7.4.0 (2019-04-01)\n\n### Bugfixes\n\n - Include Pre Output activation during Acquire Measurements Now instruction\n - Fix Outputs triggering at startup\n - Fix CCS811 Input measurement issue ([#641](https://github.com/kizniche/mycodo/issues/641))\n - Fix Math controller (equation)\n - Fix sending email notification to multiple recipients\n - Prevent RPyC TimeoutError from crashing PID controller\n\n### Features\n\n - Add Input: [The Things Network: Data Storage Integration](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#the-things-network)\n - Add Math controllers: Sum (past, single channel), Sum (last, multiple channels)\n - Add Outputs to Math controllers: Average, Redundancy, Statistics, Sum\n - Add 'required' option for Input 'custom_options' (indicates if option is required to activate Input)\n - Add 'Output State' ('on', 'off', or duty cycle) Condition for Conditional controllers ([#642](https://github.com/kizniche/mycodo/issues/642))\n\n### Miscellaneous\n\n - Change channel designations to start at 0\n\n\n## 7.3.1 (2019-02-26)\n\n### Bugfixes\n\n - Fix settings menu layout\n - Significantly improve speed of dependency-checking\n - Fix missing names for Function Actions\n\n### Features\n\n - Add dependency system for Function Actions\n - Add proper dependencies for infrared Send Function Action\n - Improve Infrared Send Action by detecting remotes and codes\n\n\n## 7.3.0 (2019-02-22)\n\n### Bugfixes\n\n - Fix issue with check_triggers() in output controller\n - Fix issue preventing export of Notes\n - Fix table issue on Note page\n\n### Features\n\n - Add Function Trigger: Infrared Remote Input\n - Add Function Action: Infrared Remote Send\n\n### Miscellaneous\n\n - Remove redundant Output (Duration) Trigger (use Output (On/Off) Trigger)\n\n\n## 7.2.4 (2019-02-20)\n\n### Bugfixes\n\n - Fix unset channel causing 500 error ([#631](https://github.com/kizniche/mycodo/issues/631))\n - During first install, initialize after install of influxdb\n\n### Miscellaneous\n\n - Add wiringpi to install\n\n\n## 7.2.3 (2019-02-19)\n\n### Bugfixes\n\n - Fix issue with SHT31 Smart Gadget disconnect error-handling\n - Prevent dashboard camera streaming if using the fswebcam library ([#630](https://github.com/kizniche/mycodo/issues/630))\n - Fix number of line characters for 20x4 LCDs ([#627](https://github.com/kizniche/mycodo/issues/627))\n - Fix PID Dashboard widget issues\n\n### Features\n\n - Add option to set Output shutdown state (on/off/neither)\n\n\n## 7.2.2 (2019-02-08)\n\n### Bugfixes\n\n - Fix inability to change BMP280 I2C address ([#625](https://github.com/kizniche/mycodo/issues/625))\n - Fix issue triggering function actions ([#626](https://github.com/kizniche/mycodo/issues/626))\n\n### Features\n\n - Add log line of PID settings when activated or saved\n - Add PID Settings button to Mycodo Logs page\n\n\n## 7.2.1 (2019-02-06)\n\n### Bugfixes\n\n - Remove bluepy version restriction that conflicts with another requirement for the latest version\n - Fix Energy Usage calculations\n - Fix output controller startup issue\n - Fix notes duplicating on graphs\n - Fix inability of Function Action (Output PWM) to set a duty cycle of 0\n - Fix inability of Function Action (Activate Controller) to activate Conditional\n - Fix pigpio dependency issue ([#617](https://github.com/kizniche/mycodo/issues/617))\n\n### Features\n\n - Add asynchronous graphs to Energy Usage summaries\n\n### Miscellaneous\n\n - Improve error-handling of Function Actions\n\n\n## 7.2.0 (2019-02-04)\n\n### Bugfixes\n\n - Fix calculating Output Usage\n - Fix error-handling of PWM signal generation ([#617](https://github.com/kizniche/mycodo/issues/617))\n - Fix output dependency issue ([#617](https://github.com/kizniche/mycodo/issues/617))\n\n### Features\n\n - Add new energy usage/cost analysis based on amperage measurements (See [Energy Usage](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#energy-usage) in the manual)\n - Add password recovery feature (technically just creates new admin user from the command line)\n\n\n## 7.1.7 (2019-02-02)\n\n### Bugfixes\n\n - Attempted fix of output dependency issue ([#617](https://github.com/kizniche/mycodo/issues/617))\n - Fix PID Autotune ungraceful exit ([#621](https://github.com/kizniche/mycodo/issues/621))\n\n\n## 7.1.6 (2019-01-30)\n\n### Bugfixes\n\n - Attempted fix of output dependency issue ([#617](https://github.com/kizniche/mycodo/issues/617))\n - Fix issue creating Triggers ([#618](https://github.com/kizniche/mycodo/issues/618))\n\n### Features\n\n - Add LCD: 128x64 OLED ([#589](https://github.com/kizniche/mycodo/issues/589))\n - Improve SHT31 Smart Gadget module\n\n### Miscellaneous\n\n - Update Translations\n - Add Languages: Dutch, Norwegian, Serbian, Swedish\n\n\n## 7.1.5 (2019-01-28)\n\n### Bugfixes\n\n - Fix issue downloading logged data from SHT31 Smart Gadget\n - Fix issue using PID measurements on Measurement Dashboard widget ([#616](https://github.com/kizniche/mycodo/issues/616))\n - Fix issue with Python Command Output variable declaration\n\n### Features\n\n - Add Dashboard widget: Indicator ([#606](https://github.com/kizniche/mycodo/issues/606))\n\n\n## 7.1.4 (2019-01-26)\n\n### Bugfixes\n\n - Fix dependency issue preventing Mycodo installation ([#614](https://github.com/kizniche/mycodo/issues/614))\n\n### Features\n\n - Add Diagnostic option: Delete Settings Database\n\n\n## 7.1.3 (2019-01-23)\n\n### Bugfixes\n\n - Fix missing PID Setpoint measurement\n - Fix missing location option for Free Space Input\n\n\n## 7.1.2 (2019-01-23)\n\n### Bugfixes\n\n - Fix Method editing\n\n\n## 7.1.1 (2019-01-22)\n\n### Bugfixes\n\n - Fix Conditional Statement testing during form save ([#610](https://github.com/kizniche/mycodo/issues/610))\n\n\n## 7.1.0 (2019-01-20)\n\nThis release changes Conditional behavior. After upgrading to this version, your Conditional Statements should have every Condition '{ID}' changed to 'measure(\"{ID}\")'. Check every Conditional after the upgrade to ensure they work as expected. Additionally, the recommended logic to store and test measurements has changed, so review the Examples in the [Conditionals section of the manual](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#conditional).\n\n### Bugfixes\n\n - Fix Error message when activating/deactivating controllers (no actual error occurred)\n - Fix (workaround) for inability to display Note whitespaces on Graphs\n\n### Features\n\n - Add ability to conduct individual measurement in Conditional Statements ([#605](https://github.com/kizniche/mycodo/issues/605))\n - Add ability to execute individual actions in Conditional Statements ([#605](https://github.com/kizniche/mycodo/issues/605))\n - Add ability to modify the Conditional message ([#605](https://github.com/kizniche/mycodo/issues/605))\n - Add Function Actions: Email with Photo Attachment, Email with Video Attachment\n\n\n## 7.0.5 (2019-01-10)\n\n### Bugfixes\n\n - Fix missing Atlas pH Input baud rate option ([#597](https://github.com/kizniche/mycodo/issues/597))\n - Fix properly displaying I2C/UART Input options\n - Fix issue requiring action selection to submit form ([#595](https://github.com/kizniche/mycodo/issues/595))\n - Fix output duration not being logged if settings saved while output is currently on\n - Fix instability of dependency system\n - Fix missing libglib2.0-dev dependency of SHT31 Smart Gadget\n\n### Features\n\n - Add FTDI support for Atlas Scientific sensors ([#597](https://github.com/kizniche/mycodo/issues/597))\n - Add Output option to trigger Functions at startup\n\n### Miscellaneous\n\n - Update SHT31 Smart Gadget Input module\n\n\n## 7.0.4 (2019-01-07)\n\n### Bugfixes\n\n - Fix issue with converted measurements unable to be used with Conditionals ([#592](https://github.com/kizniche/mycodo/issues/592))\n - Add pi-bluetooth to SHT31 Smart Gadget dependencies ([#588](https://github.com/kizniche/mycodo/issues/588))\n - Fix issue using PIDs and Graphs with converted measurement units ([#594](https://github.com/kizniche/mycodo/issues/594))\n - Fix issue with mixed up order of Graph series\n - Fix issue recording output durations\n\n### Features\n\n - Add OWFS support for 1-wire devices (currently only DS18B20, DS18S20 supported) ([#582](https://github.com/kizniche/mycodo/issues/582))\n - Add ability to delete .dependency and .upgrade files from the web UI ([#590](https://github.com/kizniche/mycodo/issues/590))\n\n### Miscellaneous\n\n - Update several Python modules, update InfluxDB to 1.7.2\n - Update manual FAQs\n\n\n## 7.0.3 (2018-12-25)\n\n### Bugfixes\n\n - Fix rendering new lines in Note text on graphs\n - Fix display of proper unit on Measurement Dashboard element ([#583](https://github.com/kizniche/mycodo/issues/583))\n - Fix missing libjpeg-dev dependency for PiOLED ([#584](https://github.com/kizniche/mycodo/issues/584))\n - Fix dependencies for AMG88xx Input\n\n### Features\n\n - Add Function Action: Create Note\n - Add Input: Sonoff TH10/16 humidity and temperature sensor ([#583](https://github.com/kizniche/mycodo/issues/583))\n - Add Input: AM2320 I2C humidity and temperature sensor ([#585](https://github.com/kizniche/mycodo/issues/585))\n\n### Miscellaneous\n\n - Change method for detecting 1-wire devices ([#582](https://github.com/kizniche/mycodo/issues/582))\n - Disable variable replacement in Command Execution Function Action until it can be fixed to work with new measurement system\n\n\n## 7.0.2 (2018-12-21)\n\n### Bugfixes\n\n - Fix inability to reorder Dashboard, Data, Output, and Function elements\n - Fix Edge Inputs not appearing in Edge Trigger input selection\n - Fix use of Atlas pH temperature calibration from Input/Math\n\n### Features\n\n - Add Additional check for Conditional Statements if {ID} is replaced with None ([#571](https://github.com/kizniche/mycodo/issues/571))\n - Add ability to set Logging Interval and download logged data from SHT31 Smart Gadget ([#559](https://github.com/kizniche/mycodo/issues/559))\n - Add Math: Input Backup: If a measurement of an Input cannot be found, look for a measurement of another (or another, etc.) ([#559](https://github.com/kizniche/mycodo/issues/559))\n\n### Miscellaneous\n\n - Add check so SHT31 Smart Gadget user options don't cause the number of stored measurements to exceed the internal memory\n\n\n## 7.0.1 (2018-12-09)\n\n### Bugfixes\n\n - Fix PiOLED LCD from changing I2C address when options are saved ([#579](https://github.com/kizniche/mycodo/issues/579))\n - Fix Generic 16x2/16x4 LCD display issue ([#578](https://github.com/kizniche/mycodo/issues/578))\n - Fix Math Add dropdown items having the same name ([#580](https://github.com/kizniche/mycodo/issues/580))\n\n### Features\n\n - Add ability to induce an Input to acquire/store measurements from the web UI\n - Add Input: SHT31 Smart Gadget (Bluetooth) humidity/temperature sensor ([#559](https://github.com/kizniche/mycodo/issues/559))\n - Add blank line to LCD display options ([#579](https://github.com/kizniche/mycodo/issues/579))\n\n ### Miscellaneous\n\n - Add verification for Conditional Statement code\n\n\n## 7.0.0 (2018-12-08)\n\nThe Mycodo 7.0 introduces many redesigned systems, including measurements/units, conversions, conditionals, and more (see full list, below). The remnants of Conditionals have been moved to a new controller, called Triggers, which executes actions in response to event triggers (such as time-based events, Output changes, sunrises/sunsets, etc.). The new Conditional system incorporates a powerful way of developing complex conditional statements. See ([#493](https://github.com/kizniche/mycodo/issues/493)) for more information. Since earlier versions are not compatible with 7.x, all 6.x users will have to perform a fresh install or delete their settings database. An option will be presented on the upgrade page to delete the database and perform an upgrade.\n\n### Bugfixes\n\n - Fix issue preventing PID Method from changing setpoint (#566)\n - Fix issue with calibration of DS-type sensors\n - Fix module loading issue by restarting the daemon following dependency install ([#569](https://github.com/kizniche/mycodo/issues/569))\n - Fix issue adding Daily Time-Based method ([#550](https://github.com/kizniche/mycodo/issues/550))\n\n### Features\n\n - Add Function: Execute Actions\n - Add Function Action: Pause (pause for a duration of time between executing specific actions)\n - Add Input: MCP9808 (I2C) high accuracy temperature sensor\n - Add Input: AMG8833 (I2C) 8x8 pixel thermal sensor\n - Add Input: SHT31 (I2C) humidity/temperature sensor\n - Add LCD: PiOLED 128x32 (I2C) LCD ([#579](https://github.com/kizniche/mycodo/issues/579))\n - Add Output: Python Command (On/Off and PWM)\n - Add Output: Atlas EZO-PMP (I2C/UART) Peristaltic Pump ([#562](https://github.com/kizniche/mycodo/issues/562))\n - Add Vapor Pressure Deficit calculation to Inputs that measure temperature and relative humidity ([#572](https://github.com/kizniche/mycodo/issues/572))\n - Add Vapor Pressure Deficit Math controller ([#572](https://github.com/kizniche/mycodo/issues/572))\n - Add Start Offset option for PID, Math, and Conditionals\n - Add ability to search Input selection dropdown list\n\n### Miscellaneous\n\n - Refactor Conditional system ([#493](https://github.com/kizniche/mycodo/issues/493))\n - Refactor Analog-to-digital converters ([#550](https://github.com/kizniche/mycodo/issues/550))\n - Refactor Measurement/Unit system ([#550](https://github.com/kizniche/mycodo/issues/550))\n - Refactor Conversion system ([#493](https://github.com/kizniche/mycodo/issues/493))\n - Upgrade InfluxDB from 1.6.0 to 1.7.0\n - Add User Role: Kiosk\n\n\n## 6.4.7 (2018-12-08)\n\nThis is the final release of version 6.x. Upgrading to 7.x will require a database wipe. This will be an option presented in the Mycodo upgrade page. If you do not want to lose your Mycodo data (settings AND measurement data), do not upgrade to 7.x.\n\n\n## 6.4.5 (2018-10-17)\n\n### Bugfixes\n\n - Fix issues with ADS1256 module ([#537](https://github.com/kizniche/mycodo/issues/537))\n - Fix issue with saving float values\n\n### Miscellaneous\n\n - Replace smbus with smbus2 ([#549](https://github.com/kizniche/mycodo/issues/549))\n\n\n## 6.4.4 (2018-10-14)\n\n### Features\n\n - Add enhanced reorder functionality for Input, Output, Math, PID, and Conditional controllers\n - Add ability to set camera still, timelapse, and video file save locations ([#498](https://github.com/kizniche/mycodo/issues/498))\n - Add ability to export/import notes and note attachments ([#548](https://github.com/kizniche/mycodo/issues/548))\n\n### Bugfixes\n\n - Fix authentication issue with Remote Administration\n - Fix issues with ADS1256 module ([#537](https://github.com/kizniche/mycodo/issues/537))\n - Fix issue with saving float values\n\n### Miscellaneous\n\n - Replace smbus with smbus2 ([#549](https://github.com/kizniche/mycodo/issues/549))\n\n\n## 6.4.3 (2018-10-13)\n\n### Bugfixes\n\n - Fix authentication issue introduced in 6.4.2\n\n\n## 6.4.2 (2018-10-13)\n\n### Features\n\n - Add MH-Z19 option: enable/disable automatic baseline correction (ABC)\n - Add ability to Test/trigger all Conditional Actions of a Conditional ([#524](https://github.com/kizniche/mycodo/issues/524))\n\n### Bugfixes\n\n - Fix Cozir module pycozir egg\n - Fix often-erroneous first measurement of ZH03B and MH-Z19 sensors\n - Fix issue with ADS1256 module ([#537](https://github.com/kizniche/mycodo/issues/537))\n\n\n## 6.4.1 (2018-10-11)\n\n### Bugfixes\n\n - Fix database upgrade issue\n\n\n## 6.4.0 (2018-10-11)\n\n### Features\n\n - Add Input: ADS1256 Analog-to-digital converter ([#537](https://github.com/kizniche/mycodo/issues/537))\n - Add ability to create custom options for Input modules ([#525](https://github.com/kizniche/mycodo/issues/525))\n - Add conversions between ppm/ppb and percent\n\n### Bugfixes\n\n - Fix issue determining PID setpoint unit on LCDs\n - Fix issue displaying IP address on LCD\n - Fix issue with client activating controllers ([#532](https://github.com/kizniche/mycodo/issues/532))\n - Fix issue with Linux Command Input ([#537](https://github.com/kizniche/mycodo/issues/537))\n - Fix issue with installing internal dependencies (e.g. pigpiod) ([#538](https://github.com/kizniche/mycodo/issues/538))\n - Potential fix for Miflora input ([#540](https://github.com/kizniche/mycodo/issues/540))\n - Fix missing Baud Rate option for K30 input ([#541](https://github.com/kizniche/mycodo/issues/541))\n - Fix 500 Error on Raspberry Pi Config page ([#536](https://github.com/kizniche/mycodo/issues/536))\n - Add turning ABC mode off during MHZ19 input initialization ([#546](https://github.com/kizniche/mycodo/issues/546))\n - Fix German \"Output\" translation\n\n### Miscellaneous\n\n - Set InfluxDB timeout to 5 seconds ([#539](https://github.com/kizniche/mycodo/issues/539))\n - Update Winsen ZH03B input module code ([#543](https://github.com/kizniche/mycodo/issues/543))\n\n\n## 6.3.9 (2018-09-18)\n\n### Bugfixes\n\n - Fix issue with installing dependencies ([#531](https://github.com/kizniche/mycodo/issues/531))\n - Fix issue with Edge devices\n\n\n## 6.3.8 (2018-09-17)\n\n### Bugfixes\n\n - Fix issue with database upgrade\n\n\n## 6.3.7 (2018-09-17)\n\n### Bugfixes\n\n - Fix issue with database upgrade\n\n\n## 6.3.6 (2018-09-17)\n\n### Bugfixes\n\n - Fix issue with Edge devices\n\n\n## 6.3.5 (2018-09-17)\n\n### Bugfixes\n\n - Fix issue with 1-Wire devices ([#529](https://github.com/kizniche/mycodo/issues/529))\n\n\n## 6.3.4 (2018-09-17)\n\n### Bugfixes\n\n - Fix issue with note system during upgrade ([#529](https://github.com/kizniche/mycodo/issues/529))\n\n\n## 6.3.3 (2018-09-17)\n\n### Bugfixes\n\n - Fix Cozir input issue\n\n\n## 6.3.2 (2018-09-16)\n\n### Bugfixes\n\n - Fix ZH03B input\n\n\n## 6.3.1 (2018-09-16)\n\nThis release adds the ability to import input modules, allowing new inputs to be created by the user. Documentation (https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#create-your-own-input-module) for developing your own input modules is in development. See issue #525 for more information about it's development and discussion. Also with this release is a new section for Notes (More -> Notes, https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.rst#notes). Notes are associated with one more more tags that can be created. Notes can also have files attached to them. These notes can be displayed on graphs to easily identify when a certain event happened in the past (or future).\n\n### Features\n\n - Implement self-contained input modules ([#525](https://github.com/kizniche/mycodo/issues/525))\n - Add Note system ([#527](https://github.com/kizniche/mycodo/issues/527))\n\n\n## 6.2.4 (2018-09-03)\n\n### Features\n\n - Add Winsen ZH03B Particulate sensor ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Reduce install to one command\n\n### Bugfixes\n\n - Fix inability to set camera device ([#519](https://github.com/kizniche/mycodo/issues/519))\n - Fix initialization of UART MHZ16 ([#520](https://github.com/kizniche/mycodo/issues/520))\n - Fix issue with BMP280 ([#522](https://github.com/kizniche/mycodo/issues/522))\n\n## 6.2.3 (2018-08-28)\n\n### Bugfixes\n\n - Fix issue with major version upgrade initialization\n - Fix issue with PWM output dashboard element updating ([#517](https://github.com/kizniche/mycodo/issues/517))\n - Fix dependency check for DS-type sensor calibration ([#518](https://github.com/kizniche/mycodo/issues/518))\n - Fix issue with Adafruit deprecating BMP, TMP, and CCS811 ([#346](https://github.com/kizniche/mycodo/issues/346), [#503](https://github.com/kizniche/mycodo/issues/503))\n\n\n## 6.2.2 (2018-08-22)\n\n### Features\n\n - Add translations: Italian, Portuguese\n\n### Bugfixes\n\n - Fix display of IP address on LCD ([#507](https://github.com/kizniche/mycodo/issues/507))\n - Fix graph manual y-axis min/max ([#516](https://github.com/kizniche/mycodo/issues/516))\n - Fix issue with deleting all dashboard elements\n\n\n## 6.2.1 (2018-08-20)\n\n### Features\n\n - Add Diagnostic section of configuration menu with first function: Delete All Dashboard Elements ([#515](https://github.com/kizniche/mycodo/issues/515), [#516](https://github.com/kizniche/mycodo/issues/516))\n\n### Bugfixes\n\n - Fix issue with units on LCDs ([#514](https://github.com/kizniche/mycodo/issues/514))\n\n\n## 6.2.0 (2018-08-15)\n\n### Features\n\n - New measurement/unit configuration system (select which unit to convert/store for input measurements) ([#506](https://github.com/kizniche/mycodo/issues/506))\n - Add ability to create new measurements, units, and conversions ([#506](https://github.com/kizniche/mycodo/issues/506))\n - Enable conversion of disk space (kB, MB, GB), frequency (Hz, kHz, MHz), and humidity (%, decimal)\n - Add option to display IP address on LCD ([#507](https://github.com/kizniche/mycodo/issues/507))\n - Full German Translation ([#507](https://github.com/kizniche/mycodo/issues/507)) (@pmunz75)\n - Add PID Autotune feature (currently disabled; may be enabled in the release, pending testing)\n - Add New Translations: Russian, Chinese\n - Complete Translations: German, Spanish, French\n\n### Bugfixes\n\n - Fix issue activating Cozir CO2 sensor ([#495](https://github.com/kizniche/mycodo/issues/495))\n - Fix issue with order not updating correctly when Conditional is deleted\n - Fix issue with output usage report generation ([#504](https://github.com/kizniche/mycodo/issues/504))\n - Fix proper conversion of temperatures/pressure for Wet-Bulb Humidity Math\n - Fix Atlas pH UART sensor module ([#509](https://github.com/kizniche/mycodo/issues/509))\n\n### Miscellaneous\n\n - Update InfluxDB 1.5.0 -> 1.6.0\n\n\n## 6.1.4 (2018-06-28)\n\n### Features\n\n - Increase verbosity of conditional email notification\n - Add Cozir CO2 sensor Input ([#495](https://github.com/kizniche/mycodo/issues/495))\n - Allow CO2 to be converted from ppm <-> ppb\n\n### Bugfixes\n\n - Fix pressure measurements being forced to integer ([#476](https://github.com/kizniche/mycodo/issues/476))\n - Fix CCS811 Input measurement ([#467](https://github.com/kizniche/mycodo/issues/467))\n - Fix pigpio dependency install issue\n - Prevent pre-output from remaining on after an Input is deactivated\n - Enable unit conversions for AM2315\n - Fix issue setting PID setpoint from Dashboard ([#496](https://github.com/kizniche/mycodo/issues/496))\n - Fix displaying custom graph colors ([#491](https://github.com/kizniche/mycodo/issues/491))\n\n### Miscellaneous\n\n - Remove I2C support for K30 CO2 sensor (until properly tested)\n - Update to Bootstrap 4.1.1\n - Remove remaining Fahrenheit conversions from Live page\n - Update 433 MHz wireless script (test send/receive, determine/receive commands from remote)\n\n\n## 6.1.3 (2018-06-05)\n\n### Features\n\n - Add I2C support for K30 CO2 sensor (untested)\n\n### Bugfixes\n\n - Fix service executable location ([#487](https://github.com/kizniche/mycodo/issues/487))\n - Fix inability to set duty cycle from frontend ([#485](https://github.com/kizniche/mycodo/issues/485))\n - Fix (finally) saving Time-based Conditional times ([#488](https://github.com/kizniche/mycodo/issues/488))\n\n\n## 6.1.2 (2018-05-23)\n\n### Features\n\n - Add option to set Miflora Bluetooth adapter ([#483](https://github.com/kizniche/mycodo/issues/483))\n\n### Bugfixes\n\n - Fix exception-handling of sending test email ([#471](https://github.com/kizniche/mycodo/issues/471))\n - Fix HDC1000 initialization issue ([#467](https://github.com/kizniche/mycodo/issues/467))\n - Fix Command PWM frontend issues ([#469](https://github.com/kizniche/mycodo/issues/469))\n - Fix ADC modules ([#482](https://github.com/kizniche/mycodo/issues/482))\n - Update miflora to 0.4 ([#481](https://github.com/kizniche/mycodo/issues/481))\n - Fix BH1750 sensor ([#480](https://github.com/kizniche/mycodo/issues/480))\n\n### Miscellaneous\n\n- Update alembic, Flask, Flask_CSV, geocoder, gunicorn, imutils, pytest, python-dateutil, SQLAlchemy, testfixtures\n\n\n## 6.1.1 (2018-05-18)\n\n### Features\n\n- Add CCS811 CO2 sensor input ([#467](https://github.com/kizniche/mycodo/issues/467))\n- Add HDC1000/HDC1080 Temperature/Humidity sensor input ([#467](https://github.com/kizniche/mycodo/issues/467))\n- Add Pascal/kiloPascal conversion for pressure\n- Add ppm/ppb conversion for CO2 and VOC concentration\n- Improve accuracy of float measurement values\n- Add option to set camera output duration (before image capture)\n- Improve handling of multiple queries to a single device\n\n### Bugfixes\n\n - Fix saving settings of Conditional Timers ([#470](https://github.com/kizniche/mycodo/issues/470))\n - Fix Command PWM output use in PIDs ([#469](https://github.com/kizniche/mycodo/issues/469))\n - Fix proper display of Outputs in Conditionals ([#469](https://github.com/kizniche/mycodo/issues/469))\n\n\n## 6.1.0 (2018-05-02)\n\n### Features\n\n- Add Output (Duration) Conditional ([#186](https://github.com/kizniche/mycodo/issues/186))\n\n### Bugfixes\n\n - Fix refreshing settings of active conditional controllers\n - Fix saving settings of Conditional Timers ([#464](https://github.com/kizniche/mycodo/issues/464))\n\n\n## 6.0.9 (2018-04-27)\n\n### Bugfixes\n\n - Fix command measurement checking ([#460](https://github.com/kizniche/mycodo/issues/460))\n - Fix rendering of Math measurements/units ([#461](https://github.com/kizniche/mycodo/issues/461))\n\n\n## 6.0.8 (2018-04-27)\n\n### Bugfixes\n\n - Fix identification of custom command measurement/units ([#457](https://github.com/kizniche/mycodo/issues/457))\n - Fix AM2315 Input issue ([#459](https://github.com/kizniche/mycodo/issues/459))\n\n\n## 6.0.7 (2018-04-26)\n\n### Features\n\n- Add ability to change sample rate of controllers ([#386](https://github.com/kizniche/mycodo/issues/386))\n\n### Bugfixes\n\n - Fix display of graph custom y-axis names\n - Fix inability to change pigpiod sample rate ([#458](https://github.com/kizniche/mycodo/issues/458))\n\n\n## 6.0.6 (2018-04-23)\n\n### Bugfixes\n\n - Fix issue with Edge Input\n - Fix issue with Conditional timers\n - Fix issue with BME280 dependency identification\n\n\n## 6.0.5 (2018-04-22)\n\n### Features\n\n- Add Conditional: Time Span ([#444](https://github.com/kizniche/mycodo/issues/444))\n\n### Bugfixes\n\n - Fix dependency check ([#422](https://github.com/kizniche/mycodo/issues/422))\n - Try lower integration times when TSL2561 sensor is saturated ([#450](https://github.com/kizniche/mycodo/issues/450))\n - Fix DHT11/DHT22 output power check ([#454](https://github.com/kizniche/mycodo/issues/454))\n\n\n## 6.0.4 (2018-04-21)\n\n### Bugfixes\n\n - Fix scanning for DS18B20 sensors ([#452](https://github.com/kizniche/mycodo/issues/452))\n\n\n## 6.0.3 (2018-04-21)\n\n### Bugfixes\n\n - Fix upgrade issue\n\n\n## 6.0.1 (2018-04-21)\n\n### Bugfixes\n\n - Fix setting landing page ([#452](https://github.com/kizniche/mycodo/issues/452))\n\n\n## 6.0.0 (2018-04-21)\n\nVersion 6 has changes to the database schema that could not be upgraded to. To upgrade to this version, the settings database must be created anew. You either have the options of staying at the last version (5.7.x), or deleting the settings database and upgrading. A fresh install is necessary to run this version.\n\n### Features\n\n - Add Conditionals: Run PWM Method, Daily Time Point Timer, Duration Timer, Output PWM ([#444](https://github.com/kizniche/mycodo/issues/444), [#448](https://github.com/kizniche/mycodo/issues/448))\n - Add Conditional Actions: Activate/Deactivate any controller, Set PID Method ([#440](https://github.com/kizniche/mycodo/issues/440))\n - Use actual range value for color stops of solid gauges ([#434](https://github.com/kizniche/mycodo/issues/434))\n - Add option to set setpoint from PID dashboard element without epanding element ([#449](https://github.com/kizniche/mycodo/issues/449))\n - Refactor Conditional Controllers to be multithreaded\n\n### Bugfixes\n\n - Fix Hold bug in PID controllers\n - Fix error-handing when changing PID setting from Dashboard if PID is inactive ([#449](https://github.com/kizniche/mycodo/issues/449))\n\n### Miscellaneous\n\n - Remove multiplexer integration (use kernel driver)\n - Remove Timers (Conditionals have replaced their functionality)\n - Improve testing coverage of frontend ([#444](https://github.com/kizniche/mycodo/issues/444))\n\n\n## 5.7.3 (2018-04-20)\n\nThis is the last version of the 5.x branch. If your system is upgraded to 5.7.3, you will have the option of upgrading to the next major version (6.x), however the settings database will need to be deleted. This can be done through the web UI or manually by reinstalling Mycodo fresh.\n\n### Features\n\n - Add Conditional Action: Set PID Method ([#440](https://github.com/kizniche/mycodo/issues/440))\n\n\n## 5.7.2 (2018-04-07)\n\n### Features\n\n - Add ability to invert PWM duty cycle ([#444](https://github.com/kizniche/mycodo/issues/444))\n - Add ability to select landing page ([#444](https://github.com/kizniche/mycodo/issues/444))\n - Add ability to set setpoint from PID dashboard elements ([#444](https://github.com/kizniche/mycodo/issues/444))\n - Add Conditional Actions: Activate/Deactivate Timer ([#440](https://github.com/kizniche/mycodo/issues/440))\n\n### Bugfixes\n\n - Fix catching erroneous DS18B20 values ([#404](https://github.com/kizniche/mycodo/issues/404))\n - Fix camera selection of Photo Conditional Action ([#444](https://github.com/kizniche/mycodo/issues/444))\n\n### Miscellaneous\n\n - Set picamera use_video_port=False ([#444](https://github.com/kizniche/mycodo/issues/444))\n - Rearrange navigation menu ([#444](https://github.com/kizniche/mycodo/issues/444))\n\n\n## 5.7.1 (2018-04-04)\n\n### Features\n\n - Add Conditional Action: Set PID Setpoint\n - Add Input: Xiaomi MiFlora ([#422](https://github.com/kizniche/mycodo/issues/422))\n\n### Bugfixes\n\n - Restore missing help menu on navigation bar\n - Fix issue reading SHT sensors ([#437](https://github.com/kizniche/mycodo/issues/437))\n\n### Miscellaneous\n\n - Convert README and Manual from MD to RST\n - Update sht_sensor to 18.4.1\n\n\n## 5.7.0 (2018-04-03)\n\n### Features\n\n - Add ability to convert Input measurements between units ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add unit conversions: celsius, fahrenheit, kelvin, meters, feet\n - Add ability to select whether lowering PID outputs are stored as positive or negative values\n - Add Sunrise/Sunset Conditional ([#440](https://github.com/kizniche/mycodo/issues/440))\n - Add ability to set the precision for DS18B20, DS1822, DS28EA00, and DS1825 sensors ([#439](https://github.com/kizniche/mycodo/issues/439))\n - Add Inputs: DS18S20, DS1822, DS28EA00, DS1825, MAX31850K\n - Add Input option to select resolution for DS18B20, DS1822, DS28EA00, and DS1825 ([#439](https://github.com/kizniche/mycodo/issues/439))\n\n\n### Bugfixes\n\n - Fix issues with PID control on Dashboard ([#441](https://github.com/kizniche/mycodo/issues/441))\n - Improve LCD controller shutdown speed\n - Fix installer not displaying progress in console ([#442](https://github.com/kizniche/mycodo/issues/442))\n - Force measurement values to float before writing to influxdb (except 'pressure') ([#441](https://github.com/kizniche/mycodo/issues/441))\n\n\n## 5.6.10 (2018-03-31)\n\n### Bugfixes\n\n - Fix issue executing mycodo_client.py\n - Fix Command Outputs not turning off after turning on for a duration ([#432](https://github.com/kizniche/mycodo/issues/432))\n - Prevent DS18B20 measurements outside expected range ([#404](https://github.com/kizniche/mycodo/issues/404))\n - Prevent race condition preventing output from remaining on for a duration ([#436](https://github.com/kizniche/mycodo/issues/436))\n - Ensure outputs turned on for a duration only turn off once ([#436](https://github.com/kizniche/mycodo/issues/436))\n - Update sht-sensor to 18.3.6 for Python 3 compatibility ([#437](https://github.com/kizniche/mycodo/issues/437))\n\n### Miscellaneous\n\n - Change SSL certificate expiration from 1 year to 10 years\n - Fix style issues with Remote Admin following Bootstrap upgrade\n - Fix issue with setup.sh script not catching errors\n\n\n## 5.6.9 (2018-03-24)\n\n### Features\n\n - Add Refractory Period to Measurement Conditional options\n - Add method to hide/show/reorder all Dashboard Elements at once ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Make Output/PID popups respond to show/hide configuration options ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add Input: Atlas Electrical Conductivity sensor ([#411](https://github.com/kizniche/mycodo/issues/411))\n\n### Bugfixes\n\n - Fix issue saving reference resistor value ([#345](https://github.com/kizniche/mycodo/issues/345))\n - Fix LCD display of timestamps\n - Fix inability to change Solid Gauge Stops ([#433](https://github.com/kizniche/mycodo/issues/433))\n - Fix Command Outputs not turning off after turning on for a duration ([#432](https://github.com/kizniche/mycodo/issues/432))\n - Fix encoding issue with df command output ([#430](https://github.com/kizniche/mycodo/issues/430))\n\n\n## 5.6.8 (2018-03-19)\n\n### Bugfixes\n\n - Fix Camera Output not having an effect\n - Fix issues with MAX31856/MAX31865 ([#345](https://github.com/kizniche/mycodo/issues/345))\n\n\n## 5.6.7 (2018-03-18)\n\n### Bugfixes\n\n - Fix upgrade menu not turning red when an upgrade is available\n - Add lockfile breaking ([#418](https://github.com/kizniche/mycodo/issues/418))\n - Fix bcrypt dependency issue preventing install ([#429](https://github.com/kizniche/mycodo/issues/429))\n\n\n## 5.6.6 (2018-03-17)\n\n### Features\n\n - Add Input: MAX31865 for PT100 and PT1000 temperature probes ([#345](https://github.com/kizniche/mycodo/issues/345))\n\n### Bugfixes\n\n - Fix incorrect conversion of I2C address during Atlas pH sensor calibration ([#425](https://github.com/kizniche/mycodo/issues/425))\n - Potential fix for ADC issues when using pre-output ([#418](https://github.com/kizniche/mycodo/issues/418))\n - Fix Linux Command measurement display on lines 2 through 4 of LCDs ([#427](https://github.com/kizniche/mycodo/issues/427))\n - Fix display of PID setpoint units on LCDs\n - Fix display of LCD lines without measurement units\n - Fix locking to be thread safe (replaced fasteners with locket) ([#418](https://github.com/kizniche/mycodo/issues/418))\n\n\n## 5.6.5 (2018-03-14)\n\n### Features\n\n - Update to Bootstrap 4\n - Update to InfluxDB 1.5.0\n\n### Bugfixes\n\n - Add proper max voltage for MCP3008 ([#418](https://github.com/kizniche/mycodo/issues/418))\n - Fix PID persisting as paused/held after deactivating and activating\n - Fix Atlas pH Calibration issue ([#425](https://github.com/kizniche/mycodo/issues/425))\n - Fix issue with Linux Command Inputs and LCDs ([#427](https://github.com/kizniche/mycodo/issues/427))\n\n\n## 5.6.4 (2018-03-11)\n\n### Features\n\n - Add Input: MAX31856 for measuring several types of thermocouples (K, J, N, R, S, T, E, and B) ([#345](https://github.com/kizniche/mycodo/issues/345)\n - Add mycodo_client.py option: get or set PID setpoint, integrator, derivator, kp, ki, and kd ([#420](https://github.com/kizniche/mycodo/issues/420))\n - Add option to enable pre-output during measurement (previously turned off before measurement) ([#418](https://github.com/kizniche/mycodo/issues/418))\n\n### Bugfixes\n\n - Fix frontend pid in System Information page\n - Fix issue with mycodo_client.py PID hold and resume commands\n\n### Miscellaneous\n\n - Make rpi-rf an optional Output dependency\n\n\n## 5.6.3 (2018-03-09)\n\n### Features\n\n - Add ability to use custom command line options for fswebcam camera image captures ([#419](https://github.com/kizniche/mycodo/issues/419))\n - Add Input: MAX31855K for measuring K-type thermocouples ([#345](https://github.com/kizniche/mycodo/issues/345))\n - Add ability to set duty cycle of output via mycodo_client.py ([#420](https://github.com/kizniche/mycodo/issues/420))\n - Add Conditional Action: Output PWM ([#420](https://github.com/kizniche/mycodo/issues/420))\n - Add Output Type: Execute Command (PWM) ([#420](https://github.com/kizniche/mycodo/issues/420))\n\n### Bugfixes\n\n - Fix LCD issues\n - Fix state display of Command Outputs turned on for a duration\n\n\n## 5.6.2 (2018-03-04)\n\n### Features\n\n - Make install of WiringPi optional ([#412](https://github.com/kizniche/mycodo/issues/412))\n - Make install of numpy optional ([#412](https://github.com/kizniche/mycodo/issues/412))\n - Add pause color and Pause/Hold/Resume buttons to PID Dashboard element options ([#416](https://github.com/kizniche/mycodo/issues/416))\n - Display a log when installing dependencies to follow the progress\n - Add Dependency Install Log to the Log page\n - Add mycodo_client.py user commands: pid_pause, pid_hold, pid_resume\n \n### Bugfixes\n\n - Fix issues with PID Conditional Actions ([#416](https://github.com/kizniche/mycodo/issues/416))\n - Fix display of last edge on Live page\n - Fix issue updating the status of some dependencies after their install\n\n### Miscellaneous\n\n - Remove redundant upgrade commands ([#412](https://github.com/kizniche/mycodo/issues/412))\n - Remove GPIO State from Edge Conditional (use Measurement Conditional) ([#416](https://github.com/kizniche/mycodo/issues/416))\n\n\n## 5.6.1 (2018-02-27)\n\n### Features\n\n - Add Conditional Actions: Pause/Resume PID ([#346](https://github.com/kizniche/mycodo/issues/346))\n\n### Bugfixes\n\n - Fix pigpiod configuration options when pigpiod is not installed ([#412](https://github.com/kizniche/mycodo/issues/412))\n - Fix setting up pigpiod during install\n - Fix TSL2561 Input module ([#414](https://github.com/kizniche/mycodo/issues/414))\n - Fix Measurement Dashboard element condition/unit display ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Fix saving PID Conditional Actions ([#415](https://github.com/kizniche/mycodo/issues/415))\n\n\n## 5.6.0 (2018-02-25)\n\n### Features\n\n - Add interactive installer\n - Make Python modules conditionally imported ([#412](https://github.com/kizniche/mycodo/issues/412))\n\n\n## 5.5.24 (2018-02-24)\n\n### Features\n\n - Add new Input: MCP3008 Analog-to-Digital Converter ([#409](https://github.com/kizniche/mycodo/issues/409))\n\n\n## 5.5.23 (2018-02-23)\n\n### Features\n\n - Add option to set decimal places on Dashboard elements ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add option to show detailed PID information on Dashboard element ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add units to PID Dashboard element ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add Fahrenheit conversion to gauges ([#137](https://github.com/kizniche/mycodo/issues/137))\n - Add new Math: Average (Single Measurement) ([#335](https://github.com/kizniche/mycodo/issues/335))\n\n### Bugfixes\n\n - Allow disabled pigpiod to persist after upgrades ([#386](https://github.com/kizniche/mycodo/issues/386))\n - Fix display of Math measurement/units of Measurement Dashboard element\n - Prevent a large D-value the the first cycle after a PID is activated\n - Handle TypeErrors for Humidity Math controller\n\n\n## 5.5.22 (2018-02-19)\n\n### Features\n\n - Add PID-Values to Graphs ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add Dashboard elements: Measurement, Output, PID Control ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add system date and time to menu\n\n### Bugfixes\n\n - Add checks to ensure Humidity Math only returns 0% - 100% humidity\n - Prevent opposing relays from being turned off in PID Controllers ([#402](https://github.com/kizniche/mycodo/issues/402))\n - Fix adding and viewing hosts in Remote Admin ([#377](https://github.com/kizniche/mycodo/issues/377))\n - Fix error-handling of DS18B20 communication error ([#404](https://github.com/kizniche/mycodo/issues/404))\n - Add error-handling for influxdb queries ([#405](https://github.com/kizniche/mycodo/issues/405))\n\n\n## 5.5.21 (2018-02-13)\n\n### Bugfixes\n\n - Add error-handling of DS18B20 communication error ([#404](https://github.com/kizniche/mycodo/issues/404))\n - Fix setup abort from unmet pigpiod dependency ([#406](https://github.com/kizniche/mycodo/issues/406))\n\n\n## 5.5.20 (2018-02-11)\n\n### Features\n\n - Add new configuration section: Pi Settings\n - Add to Pi Settings: common ```raspi-config``` options\n - Add to Pi Settings: select pigpiod sample rate ([#386](https://github.com/kizniche/mycodo/issues/386))\n - Add option to completely disable pigpiod ([#386](https://github.com/kizniche/mycodo/issues/386))\n\n### Bugfixes\n\n - Add ability to set custom Graph colors for Math measurements\n \n\n## 5.5.19 (2018-02-06)\n\n### Features\n\n - Enable custom minimum/maximum to be set for any y-axis ([#335](https://github.com/kizniche/mycodo/issues/335))\n - Add Asynchronous Graph options for duration of data to display (All or past year, month, week, day)\n\n### Bugfixes\n\n - Fix saving Math Humidity options ([#400](https://github.com/kizniche/mycodo/issues/400))\n\n\n## 5.5.18 (2018-02-04)\n\n### Features\n\n - Allow multiple data series on Asynchronous Graphs ([#399](https://github.com/kizniche/mycodo/issues/399))\n - Add Outputs and PIDs to Asynchronous Graphs ([#399](https://github.com/kizniche/mycodo/issues/399))\n - Preserve Asynchronous Graph selections after form submissions ([#399](https://github.com/kizniche/mycodo/issues/399))\n\n### Bugfixes\n\n - Fix reloading of asynchronous graphs ([#399](https://github.com/kizniche/mycodo/issues/399))\n\n\n## 5.5.17 (2018-02-03)\n\n### Features\n\n - Add option to show/hide Gauge timestamp ([#392](https://github.com/kizniche/mycodo/issues/392))\n - Add new Math: Equation ([#335](https://github.com/kizniche/mycodo/issues/335))\n - Add PID control hysteresis ([#398](https://github.com/kizniche/mycodo/issues/398))\n - Automatically restart pigpiod when it fails\n\n### Bugfixes\n\n - Move pigpiod from cron to systemd service to improve reliability ([#388](https://github.com/kizniche/mycodo/issues/388))\n - Improve deamon error-handling and Input connectivity ([#388](https://github.com/kizniche/mycodo/issues/388))\n - Fix Mycodo service timeout ([#379](https://github.com/kizniche/mycodo/issues/379))\n - Fix display of Graph custom colors\n\n\n## 5.5.16 (2018-01-28)\n\n### Bugfixes\n\n - Fix issue with conditionals not triggering when measurement values are 0 ([#387](https://github.com/kizniche/mycodo/issues/387))\n - Fix issue with settings Output PWM duty cycles\n - Fix issues with Atlas UART module ([#382](https://github.com/kizniche/mycodo/issues/382))\n - Fix issues with calibrating the Atlas pH sensor ([#382](https://github.com/kizniche/mycodo/issues/382))\n\n\n## 5.5.15 (2018-01-28)\n\n### Features\n\n - Add Graph button to manually update graph with new data\n - Increase output timing accuracy (0.01 second, previously 0.1 second)\n - Improve graph update efficiency\n - Add Graph option: Enable Graph Shift (used in conjunction with Enable Navbar)\n - Add new Math: Difference ([#395](https://github.com/kizniche/mycodo/issues/395))\n\n### Bugfixes\n\n - Fix issue modifying the Conditional Max Age ([#387](https://github.com/kizniche/mycodo/issues/387))\n - Fix issue with new data on graphs requiring a page refresh to see\n - Fix issue with updating inputs/maths with long periods on the Live page\n\n### Miscellaneous\n\n - Remove debug line from GPIO State Input module ([#387](https://github.com/kizniche/mycodo/issues/387))\n\n\n## 5.5.14 (2018-01-25)\n\n### Bugfixes\n\n - Fix display of PID timestamp on LCDs\n - Fix missing pigpio.zip (breaks install/upgrade) on remote server (package pigpio.tar with Mycodo)\n\n\n## 5.5.13 (2018-01-23)\n\n### Features\n\n - Add Input: GPIO State ([#387](https://github.com/kizniche/mycodo/issues/387))\n - Refactor Dashboard code (improve load time, reduce code size)\n\n### Bugfixes\n\n - Fix inability to change Input Period ([#393](https://github.com/kizniche/mycodo/issues/393))\n - Fix Exception while reading the GPIO pin of Edge Conditional ([#387](https://github.com/kizniche/mycodo/issues/387))\n\n### Miscellaneous\n\n - Add Input Template for the [Wiki](https://github.com/kizniche/Mycodo/wiki/Adding-Support-for-a-New-Input)\n\n\n## 5.5.12 (2018-01-21)\n\n### Features\n\n - Add two new Inputs: Server Ping and Server Port Open ([#389](https://github.com/kizniche/mycodo/issues/389))\n\n\n## 5.5.11 (2018-01-21)\n\n### Bugfixes\n\n - Fix issues with Dashboard Gauges ([#391](https://github.com/kizniche/mycodo/issues/391))\n - Fix issues with Dashboard Cameras\n\n### Miscellaneous\n\n - Add ID numbers to Conditionals in UI for identification ([#387](https://github.com/kizniche/mycodo/issues/387))\n\n\n## 5.5.10 (2018-01-20)\n\n### Features\n\n - Add ability to set graph y-axis minimum/maximum ([#384](https://github.com/kizniche/mycodo/issues/384))\n - Add ability to view Math outputs on asynchronous graphs ([#335](https://github.com/kizniche/mycodo/issues/335))\n - Improve Dashboard Object creation/manipulation user interaction\n\n### Bugfixes\n\n - Fix inability to activate Edge Conditionals ([#381](https://github.com/kizniche/mycodo/issues/381))\n - Fix inability to add new gauges or graphs to the dashboard ([#384](https://github.com/kizniche/mycodo/issues/384))\n - Fix issues with UART Atlas pH Input device ([#382](https://github.com/kizniche/mycodo/issues/382))\n - Fix issue with Atlas pH calibration ([#382](https://github.com/kizniche/mycodo/issues/382))\n - Fix issue with caching of Camera images on the Dashboard\n - Fix issue with Edge Conditionals ([#387](https://github.com/kizniche/mycodo/issues/387))\n\n\n## 5.5.9 (2018-01-14)\n\n### Bugfixes\n\n - Fix issue generating output usage reports ([#380](https://github.com/kizniche/mycodo/issues/380))\n - Fix inability to save Edge Conditionals ([#381](https://github.com/kizniche/mycodo/issues/381))\n\n\n## 5.5.8 (2018-01-11)\n\n### Features\n\n - Add ability to add Camera modules to the Dashboard (formerly Live Graphs page)\n\n### Bugfixes\n\n - Fix issue with new installations failing to start the flask frontend ([#379](https://github.com/kizniche/mycodo/issues/379))\n - Fix issue with services starting on Pi Zeros ([#379](https://github.com/kizniche/mycodo/issues/379))\n\n### Miscellaneous\n\n - Reduce gunicorn (web UI) workers from 2 to 1\n\n\n## 5.5.7 (2018-01-08)\n\n### Bugfixes\n\n- Fix forcing of HTTPS via user configuration\n- Fix inability to save Gauge Refresh Period option ([#376](https://github.com/kizniche/mycodo/issues/376))\n- Fix Atlas Scientific communication issues ([#369](https://github.com/kizniche/mycodo/issues/369))\n\n\n## 5.5.6 (2018-01-05)\n\n### Features\n\n - Add ability to restart the frontend from the web UI\n\n### Bugfixes\n\n- Attempt to fix issue where DHT22 sensor may become unresponsive\n- Fix inability to stream video from PiCamera\n\n\n## 5.5.5 (2018-01-04)\n\n### Bugfixes\n\n - Fix IP address of user login log entries\n - Fix issue reading DHT11 sensor ([#370](https://github.com/kizniche/mycodo/issues/370))\n\n\n## 5.5.4 (2018-01-03)\n\n### Features\n\n - Add ability to replace edge variable in edge conditional command action\n\n### Bugfixes\n\n - Fix issue with proper python 3 virtualenv ([#362](https://github.com/kizniche/mycodo/issues/362))\n - Fix starting web server during install\n - Fix issue with gunicorn worker timeouts on Raspberry Pi Zeros ([#365](https://github.com/kizniche/mycodo/issues/365))\n - Fix command variable replacement for Output conditionals ([#367](https://github.com/kizniche/mycodo/issues/367))\n - Fix pH Input causing an error with a deactivated Calibration Measurement ([#369](https://github.com/kizniche/mycodo/issues/369))\n - Fix issue preventing capture of still images from the web interface ([#368](https://github.com/kizniche/mycodo/issues/368))\n\n### Miscellaneous\n\n - Move mycodo root symlink from /var/www to /var\n - Create symlinks in PATH for mycodo-backup, mycodo-client, mycodo-commands, mycodo-daemon, mycodo-pip, mycodo-python, mycodo-restore, and mycodo-wrapper\n\n\n## 5.5.3 (2017-12-29)\n\n### Bugfixes\n\n - Fix issue with web UI and daemon not restarting properly after upgrade\n - Fix issue with the log not updating properly on the Upgrade page\n\n\n## 5.5.2 (2017-12-27)\n\n### Features\n\n - Add Conditional Actions: Flash LCD Off, LCD Backlight On, LCD Backlight Off ([#363](https://github.com/kizniche/mycodo/issues/363))\n\n### Bugfixes\n\n - Add more log lines to find out exactly which part makes the end of an upgrade hang\n - Fix MHZ16/19 UART communication ([#359](https://github.com/kizniche/mycodo/issues/359))\n - Fix missing I2C devices from System Information page ([#354](https://github.com/kizniche/mycodo/issues/354))\n - Fix output state determination of other outputs if a wireless output is unconfigured ([#364](https://github.com/kizniche/mycodo/issues/364))\n - Fix LCD controller issues with flashing and backlight management\n\n\n## 5.5.1 (2017-12-25)\n\n### Bugfixes\n\n - Fix inability to send Conditional email notification to multiple recipients\n - Fix inability to select LCDs as Conditional Actions\n - Fix BME280 sensor module ([#358](https://github.com/kizniche/mycodo/issues/358))\n - Fix TSL2591 sensor module\n - Fix MHZ16/MHZ19 unicode errors (still investigating other potential issues reading these sensors)\n\n\n## 5.5.0 (2017-12-25)\n\nMerry Christmas!\n\nWith the release of 5.5.0, Mycodo becomes modern by migrating from Python 2.7.9 to Python 3 (3.5.3 if on Raspbian Stretch, 3.4.2 if on Raspbian Jessie). This release also brings a big switch from apache2+mod_wsgi to nginx+gunicorn as the web server.\n\n### Issues\n\n***You may experience an error during the upgrade that doesn't allow it to complete***\n\n***It will no longer be possible to restore pre-5.5.0 backups***\n\n***All users will be logged out of the web UI during the upgrade***\n\n***All Conditionals will be deactivated and need reconfiguring***\n\n***OpenCV has been removed as a camera module***\n\nIf you rely on your system to work, it is highly recommended that you ***DO NOT UPGRADE***. Wait until your system is no longer performing critical tasks to upgrade, in order to allow yourself the ability to thoroughly test your particular configuration works as expected, and top perform a fresh install if the upgrade fails. Although most parts of the system have been tested to work, there is, as always, the potential for unforeseen issues (for instance, not every sensor that Mycodo supports has physically been tested). Read the following notes carefully to determine if you want to upgrade to 5.5.0 and newer versions.\n\n#### Failure during the upgrade to >= 5.5.0\n\nI found that occasionally the upgrade will spontaneously stop without an indication of the issue. I've seen it happen during an apt-get install and during a pip upgrade. It does not seem consistent, and there were no erorrs, therefore it wasn't able to be fixed. If you experience an error during the upgrade that doesn't allow the upgrade to complete, issue the following commands to attempt to resume and complete the upgrade. If that doesn't fix it, you may have to install Mycodo from scratch.\n\n```bash\nsudo dpkg --configure -a\nsudo /bin/bash ~/Mycodo/mycodo/scripts/upgrade_post.sh\n```\n\n#### No restoring of pre-5.5.0 backups\n\nRestoring pre-5.5.0 backups will not work. This is due to the moving of the pip virtual environments during the restore, the post-5.5.0 (python3) virtualenv not being compatible with the pre-5.5.0 virtualenv (python2), and moving from the apache2 web server to nginx. If you absolutely need to restore a backup, it must be done manually. Create a new github issue to get asistance with this.\n\nAlso with this release, exporting and importing both the Mycodo settings database and InfluxDB measurement database has been added. These may be imported back into Mycodo at a later timer. Currently, the InfluxDB (measurement) database may be imported into any other version of Mycodo, and the Mycodo (settings) database may only be imported to the same version of Mycodo. Automatic upgrading or downgrading of the Mycodo database to allow cross-version compatibility will be included in a future release. For the meantime, if you need to restore Mycodo settings to a particular Mycodo version, you can do the following: download the tar.gz of the particular [Mycodo Release](https://github.com/kizniche/Mycodo/releases) compatible with your database backup, extract, install normally, import the Mycodo settings database, then perform an upgrade of Mycodo to the latest release.\n\n#### All users will be logged out during the upgrade\n\nAnother consequence of changing from Python 2 to 3 is current browser cookies will cause an error with the web user interface. Therefore, all users will be logged out after upgrading to >= 5.5.0. This will cause some strange behavior that may be misconstrued as a failed upgrade:\n \n 1. The upgrade log will not update during the upgrade. Give the upgrade ample time to finish, or monitor the upgrade log from the command line.\n \n 2. After the upgrade is successful, the upgrade log box on the Upgrade page will redirect to the login page. Do not log in through the log box, but rather refresh the entire page to be redirected to the login page.\n\n#### All Conditionals will be deactivated\n\nThe Conditional code has been refactored to make them more modular. Because some conditionals will need to be reconfigured before they will operate corectly, all conditionals have been deactivated. Therefore, after the upgrade, reconfigure them appropriately, then reactivate. Additionally, conditionals (for all controllers) have been moved to a new 'Function' page.\n\n#### OpenCV has been disabled\n\nA Python 3 compatible binary version of opencv, whoch doesn't require an extremely long (hours) compiling process, is unfortunately unavailable. Therefore, if you know of a library or module that can successfully acquire an image from your webcam (you have tested to work), create a [new issue](https://github.com/kizniche/Mycodo/issues/new) with the details of how you acquired the image and we can determine if the method can be integrated into Mycddo.\n\n### Features\n\n - Migrate from Python 2 to Python 3 ([#253](https://github.com/kizniche/mycodo/issues/253))\n - Migrate from apache2 (+mod_wsgi) to nginx (+gunicorn) ([#352](https://github.com/kizniche/mycodo/issues/352))\n - Add ability to export and import Mycodo (settings) database ([#348](https://github.com/kizniche/mycodo/issues/348))\n - Add ability to export and import Influxdb (measurements) database ([#348](https://github.com/kizniche/mycodo/issues/348))\n - Add size of each backup (in MB) on Backup Restore page\n - Add check to make sure there is enough free space before performing a backup/upgrade\n - Add dedicated, modular Conditional controller ([#346](https://github.com/kizniche/mycodo/issues/346))\n - Add PID and Math to input options of Conditionals\n\n### Bugfixes\n\n - Fix deleting Inputs ([#250](https://github.com/kizniche/mycodo/issues/250))\n - Fix 500 error if 1-wire support isn't enabled\n - Fix Edge Detection Input callback function missing required parameter\n - Fix LCD display of Output duty cycle\n - Fix email notification\n - Make Conditional email notification send after last Action to include all Actions in message\n\n### Miscellaneous\n\n - Disable the use of the opencv camera library\n - Update translations\n - Combine Input and Math pages to a new 'Data' page\n - Move Conditionals and PIDs to a new 'Function' page\n - Show tooltips by default\n\n\n## 5.4.19 (2017-12-15)\n\n### Features\n\n - Add ability to use other Math controller outputs as Math controller inputs\n - Add checks to ensure a measurement is selected for Gauges\n\n### Bugfixes\n\n - Fix not deleting associated Math Conditionals when a Math controller is deleted\n - Fix displaying LCD lines for Controllers/Measurements that no longer exist\n - Fix improper WBT input-checking for humidity math controller\n - Fix issue where Math controller could crash ([#335](https://github.com/kizniche/mycodo/issues/335))\n\n\n## 5.4.18 (2017-12-15)\n\n### Bugfixes\n\n - Fix error on Live page if no Math controllers exist ([#345](https://github.com/kizniche/mycodo/issues/345))\n\n\n## 5.4.17 (2017-12-14)\n\n### Features\n\n - Add Decimal Places option to LCD lines\n\n### Bugfixes\n\n - Fix Input conditional refresh upon settings change\n - Fix display of Math controllers with atypical measurements on Live page ([#343](https://github.com/kizniche/mycodo/issues/343))\n - Fix inability to use Math controller values with PID Controllers ([#343](https://github.com/kizniche/mycodo/issues/343))\n - Fix display of Math data on LCDs ([#343](https://github.com/kizniche/mycodo/issues/343))\n - Fix LCD Max Age only working for first line\n - Fix display of Math data on LCDs\n - Fix issue displaying some Graph page configurations\n - Fix issue with PID recording negative durations\n - Fix Date Methods ([#344](https://github.com/kizniche/mycodo/issues/344))\n\n### Miscellaneous\n\n - Place PID Controllers in a subcategory of new section called Function\n - Don't disable an LCD when an Input that's using it is disabled\n\n\n## 5.4.16 (2017-12-13)\n\n### Features\n\n - Add new Math controller type: Median\n - Add the ability to use Conditionals with Math controllers\n - Add ability to use Math Controllers with LCDs and PIDs\n - Add Math Controllers to Live page\n - Add Math and PID Controllers to Gauge measurement selection ([#342](https://github.com/kizniche/mycodo/issues/342))\n - Add \"None Found Last x Seconds\" to Conditional options (trigger action if a measurement was not found within the last x seconds)\n - Add Restart Daemon option to the Config menu\n - More detailed 'incorrect database version' error message on System Information page\n\n### Bugfixes\n\n - Fix measurement list length on Graph page\n - Fix PWM output display on Live page\n - Fix issue changing Gauge type ([#342](https://github.com/kizniche/mycodo/issues/342))\n - Fix display of multiplexer options for I2C devices\n - Fix display order of I2C busses on System Information page\n\n### Miscellaneous\n\n - Add new multiplexer overlay option to manual ([#184](https://github.com/kizniche/mycodo/issues/184))\n\n\n## 5.4.15 (2017-12-08)\n\n### Features\n\n - Add Math controller types: Humidity, Maximum, Minimum, and Verification ([#335](https://github.com/kizniche/mycodo/issues/335))\n\n### Bugfixes\n\n - Fix Atlas pH sensor calibration\n\n\n## 5.4.14 (2017-12-05)\n\n### Features\n\n - Add Math Controller (Math in menu) to perform math on Input data\n - Add first Math controller type: Average ([#328](https://github.com/kizniche/mycodo/issues/328))\n - Add fswebcam as a camera library for acquiring images from USB cameras\n - Complete Spanish translation\n - Update korean translations\n - Add more translatable texts\n - Make PIDs collapsible\n - Refactor daemon controller handling and daemonize threads\n\n### Bugfixes\n\n - Fix TCA9548A multiplexer channel issues ([#330](https://github.com/kizniche/mycodo/issues/330))\n - Fix selection of current language on General Config page\n - Fix saving options when adding a Timer\n - Fix Graph display of Lowering Output durations as negative values\n - Fix double-logging of output durations\n\n### Miscellaneous\n\n - Update Manual with Math Controller information\n\n\n## 5.4.11 (2017-11-29)\n\n### Bugfixes\n\n - Fix issue displaying Camera page\n\n\n## 5.4.10 (2017-11-28)\n\n### Features\n\n - Add display of all detected I2C devices on the System Information page\n\n### Bugfixes\n\n - Change web UI restart command\n - Fix issue saving Timer options ([#334](https://github.com/kizniche/mycodo/issues/334))\n - Fix Output Usage error\n\n\n## 5.4.9 (2017-11-27)\n\n### Bugfixes\n\n - Fix adding Gauges ([#333](https://github.com/kizniche/mycodo/issues/333))\n\n\n## 5.4.8 (2017-11-22)\n\n### Features\n\n - Add 1 minute, 5 minute, and 15 minute options to Graph Range Selector ([#319](https://github.com/kizniche/mycodo/issues/319))\n\n### Bugfixes\n\n - Fix AM2315 sensor measurement acquisition ([#328](https://github.com/kizniche/mycodo/issues/328))\n\n\n## 5.4.7 (2017-11-21)\n\n### Bugfixes\n\n - Fix flood of errors in the log if an LCD doesn't have a measurement to display\n - Fix LCD display being offset one character when displaying errors\n\n\n## 5.4.6 (2017-11-21)\n\n### Features\n\n - Add Max Age (seconds) to LCD line options\n - Make LCDs collapsable in the web UI\n\n### Bugfixes\n\n - Fix saving user theme ([#326](https://github.com/kizniche/mycodo/issues/326))\n\n\n## 5.4.5 (2017-11-21)\n\n### Features\n\n - Add Freqency, Duty Cycle, Pulse Width, RPM, and Linux Command variables to Conditional commands ([#311](https://github.com/kizniche/mycodo/issues/311)) (See [Input Conditional command variables](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.md#input-conditional-command-variables))\n - Add Graph options: Enable Auto Refresh, Enable Title, and Enable X-Axis Reset ([#319](https://github.com/kizniche/mycodo/issues/319))\n - Add automatic checks for Mycodo updates (can be disabled in the configuration)\n\n### Bugfixes\n\n - Fix Input Conditional variable\n\n\n## 5.4.4 (2017-11-19)\n\n### Features\n\n - Add 12-volt DC fan control circuit to manual (@Theoi-Meteoroi) ([#184](https://github.com/kizniche/mycodo/issues/184)) (See [Schematics for DC Fan Control](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.md#schematics-for-dc-fan-control))\n\n### Bugfixes\n\n - Fix PWM Signal, RPM Signal, DHT22, and DHT11 Inputs ([#324](https://github.com/kizniche/mycodo/issues/324))\n - Add Frequency, Duty Cycle, Pulse Width, and RPM to y-axis Graph display\n\n### Miscellaneous\n\n - Upgrade InfluxDB from 1.3.7 to 1.4.2\n\n\n## 5.4.3 (2017-11-18)\n\n### Bugfixes\n\n - Fix Output Conditional triggering ([#323](https://github.com/kizniche/mycodo/issues/323))\n \n\n## 5.4.2 (2017-11-18)\n\n### Features\n\n - Add Output Conditional If option of \"On (any duration)\" ([#323](https://github.com/kizniche/mycodo/issues/323)) (See [Output Conditional Statement If Options](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.md#output-conditional-statement-if-options))\n\n### Bugfixes\n\n - Fix display of first point of Daily Bezier method\n - Fix inability to use Daily Bezier method in PID ([#323](https://github.com/kizniche/mycodo/issues/323))\n - Fix saving Output options and turning Outputs On and Off\n\n\n## 5.4.1 (2017-11-17)\n\n### Features\n\n - Prevent currently-logged in user from: deleting own user, changing user role from Admin\n - Force iPhone to open Mycodo bookmark as standalone web app instead of in Safari\n - Refactor and add tests for all inputs ([#128](https://github.com/kizniche/mycodo/issues/128))\n - Add Flask-Limiter to limit authentication requests to 30 per minute (mainly for Remote Admin feature)\n - Add first working iteration of data acquisition to the Remote Admin dashboard\n - Add SSL certificate authentication with Remote Admin communication\n\n### Bugfixes\n\n - Fix inability to modify timer options ([#318](https://github.com/kizniche/mycodo/issues/318))\n\n### Miscellaneous\n\n - Rename objects (warning: this may break some things. I tried to be thorough with testing)\n - Switch from using init.d to systemd for controlling apache2\n\n\n## 5.4.0 (2017-11-12)\n\nThis release has refactored how LCD displays are handled, now allowing an infinite number of data sets on a single LCD.\n\nNote: All LDCs will be deactivated during the upgrade. As a consequence, LCD displays will need to be reconfigured and reactivated.\n\n***Note 2: During the upgrade, the web interface will display \"500 Internal Server Error.\" This is normal and you should give Mycodo 5 to 10 minutes (or longer) to complete the upgrade process before attempting to access the web interface again.***\n\n### Features\n\n - Add ability to cycle infinite sets of data on a single LCD display ([#316](https://github.com/kizniche/mycodo/issues/316))\n - Add logrotate script to manage mycodo logs\n\n### Bugfixes\n\n - Fix language selection being applied globally (each user now has own language)\n - Fix display of degree symbols on LCDs\n\n\n## 5.3.6 (2017-11-11)\n\n### Features\n\n - Allow camera options to be used for picamera library\n\n### Bugfixes\n\n - Fix inability to take a still image while a video stream is active\n - Make creating new user names case-insensitive\n - Fix theme not saving when creating a new user\n\n### Miscellaneous\n\n - Remove ability to change camera library after a camera has been added\n - Update Korean translation\n\n\n## 5.3.5 (2017-11-10)\n\n### Features\n\n - Add timestamp to lines of the upgrade/backup/restore logs\n - Add sensor measurement smoothing to Chirp light sensor (module will soon expand to all sensors)\n - Add ability to stream video from USB cameras\n - Add ability to stream video from several cameras at the same time\n\n### Bugfixes\n\n - Fix an issue loading the camera settings page without a camera connected\n - Fix video streaming with Pi Camera ([#228](https://github.com/kizniche/mycodo/issues/228))\n\n### Miscellaneous\n\n - Split flaskform.py and flaskutils.py into smaller files for easier management\n\n\n## 5.3.4 (2017-11-06)\n\nNote: The Chirp light sensor scale has been inverted. Please adjust your settings accordingly to respond to 0 as darkness and 65535 as bright.\n\n### Features\n\n - Replace deprecated LockFile with fasteners ([#260](https://github.com/kizniche/mycodo/issues/260))\n - Add Timer type: PWM duty cycle output using Method ([#262](https://github.com/kizniche/mycodo/issues/262)), read more: [PWM Method](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.md#pwm-method)\n\n### Bugfixes\n\n - Fix display of PID setpoints on Graphs\n - Invert Chirp light sensor scale (0=dark, 65535=bright)\n\n### Miscellaneous\n\n - Update Korean translations\n - Add 2 more significant digits to ADC voltage measurements\n - Upgrade InfluxDB to v1.3.7\n\n\n## 5.3.3 (2017-10-29)\n\n### Features\n\n - Add Sample Time option to PWM and RPM Input options ([#302](https://github.com/kizniche/mycodo/issues/302))\n\n### Bugfixes\n\n - Fix issues with PWM and RPM Inputs ([#306](https://github.com/kizniche/mycodo/issues/306))\n\n\n## 5.3.2 (2017-10-28)\n\n### Features\n\n - Turning Outputs On or Off no longer refreshes the page ([#192](https://github.com/kizniche/mycodo/issues/192))\n\n### Bugfixes\n\n - Fix exporting measurements\n - Fix Live Data page displaying special characters ([#304](https://github.com/kizniche/mycodo/issues/304))\n - Fix PWM and RPM Input issues ([#302](https://github.com/kizniche/mycodo/issues/302))\n\n## 5.3.1 (2017-10-27)\n\n### Features\n\n - Add two new Inputs: PWM and RPM ([#302](https://github.com/kizniche/mycodo/issues/302))\n - Allow a PID to use both Relay and PWM Outputs ([#303](https://github.com/kizniche/mycodo/issues/303))\n\n\n## 5.3.0 (2017-10-24)\n\n#### ***IMPORTANT***\n\nBecause of a necessary database schema change, this update will deactivate all PID controllers and deselect the input measurement. All PID controllers will need the input measurement reconfigured before they can be started again.\n\n### Features\n\nInput and Output Conditional commands may now include variables. There are 23 variables currently-supported. See [Conditional Statement variables](https://github.com/kizniche/Mycodo/blob/master/mycodo-manual.md#conditional-statement-variables) for details.\n\n - Add new Input type: Linux Command (measurement is the return value of an executed command) ([#264](https://github.com/kizniche/mycodo/issues/264))\n - Refactor PID input option to allow new input and simplify PID configuration\n - Add ability to select LCD I2C bus ([#300](https://github.com/kizniche/mycodo/issues/300))\n - Add ADC Option to Inverse Scale ([#297](https://github.com/kizniche/mycodo/issues/300))\n - Add ability to use variables in Input/Output Conditional commands\n\n### Bugfixes\n\n - Fix \"Too many files open\" error when using the TSL2591 sensor ([#254](https://github.com/kizniche/mycodo/issues/254))\n - Fix bug that had the potential to lose data with certain graph display configurations\n - Prevent more than one active PID from using the same output ([#108](https://github.com/kizniche/mycodo/issues/108))\n - Prevent a PID from using the same Raise and Lower output\n - Prevent a currently-active PID from changing the output to a currently-used output\n\n### Miscellaneous\n\n - Update Readme and Wiki to fix outdated and erroneous information and improve coverage ([#285](https://github.com/kizniche/mycodo/issues/285))\n\n\n## 5.2.5 (2017-10-14)\n\n### Features\n\n - Add another status indicator color (top-left of web UI): Orange: unable to connect to daemon\n\n### Bugfixes\n\n - Fix Asynchronous Graphs ([#296](https://github.com/kizniche/mycodo/issues/296))\n - Disable sensor tests to fix testing environment (will add later when the issue is diagnosed)\n\n\n## 5.2.4 (2017-10-05)\n\n### Features\n\n - Add ability to set time to end repeating duration method\n\n\n## 5.2.3 (2017-09-29)\n\n### Bugfixes\n\n - Fix issues with method repeat option\n\n\n## 5.2.2 (2017-09-27)\n\n### Features\n\n - Add 'restart from beginning' option to PID duration methods\n \n### Bugfixes\n\n - Fix adding new graphs\n\n\n## 5.2.1 (2017-09-21)\n\n### Bugfixes\n\n - Fix changing a gauge from angular to solid ([#274](https://github.com/kizniche/mycodo/issues/274))\n\n\n## 5.2.0 (2017-09-17)\n\n### Features\n\n - Add gauges to Live Graphs ([#274](https://github.com/kizniche/mycodo/issues/274))\n\n\n## 5.1.10 (2017-09-12)\n\n### Bugfixes\n\n - Fix issue reporting issue with the web UI communicating with the daemon ([#291](https://github.com/kizniche/mycodo/issues/291))\n\n\n## 5.1.9 (2017-09-07)\n\n### Features\n\n - Enable daemon monitoring script (cron @reboot) to start the daemon if it stops\n\n### Bugfixes\n\n - Potential fix for certain sensor initialization issues when using a multiplexer ([#290](https://github.com/kizniche/mycodo/issues/290))\n - Handle connection error when the web interface cannot connect to the daemon/relay controller ([#289](https://github.com/kizniche/mycodo/issues/289))\n\n\n## 5.1.8 (2017-08-29)\n\n### Bugfixes\n\n - Fix saving relay start state ([#289](https://github.com/kizniche/mycodo/issues/289))\n\n\n## 5.1.7 (2017-08-29)\n\n### Bugfixes\n\n - Fix MH-Z16 sensor issues in I2C read mode ([#281](https://github.com/kizniche/mycodo/issues/281))\n - Fix Atlas Scientific I2C device query response in the event of an error\n - Fix issue preventing PID from using duration Methods\n - Fix issue with PID starting a method again after it has already ended\n - Fix TSL2591 sensor ([#257](https://github.com/kizniche/mycodo/issues/257))\n - Fix saving relay trigger state ([#289](https://github.com/kizniche/mycodo/issues/289))\n\n\n## 5.1.6 (2017-08-11)\n\n### Features\n\n - Add MH-Z16 sensor module ([#281](https://github.com/kizniche/mycodo/issues/281))\n\n\n## 5.1.5 (2017-08-11)\n\n### Bugfixes\n\n - Fix MH-Z19 sensor module ([#281](https://github.com/kizniche/mycodo/issues/281))\n\n\n## 5.1.4 (2017-08-11)\n\n### Features\n\n - Update InfluxDB (v1.3.3) and pip packages\n\n### Bugfixes\n\n - Fix K30 sensor module ([#279](https://github.com/kizniche/mycodo/issues/279))\n\n\n## 5.1.3 (2017-08-10)\n\n### Bugfixes\n\n - Fix install issue in setup.sh install script (catch 1-wire error if not enabled) ([#258](https://github.com/kizniche/mycodo/issues/258))\n\n\n## 5.1.2 (2017-08-09)\n\n### Bugfixes\n\n - Fix new timers not working ([#284](https://github.com/kizniche/mycodo/issues/284))\n\n\n## 5.1.1 (2017-08-09)\n\n### Features\n\n - Add live display of upgrade log during upgrade\n \n### Bugfixes\n\n - Fix setup bug preventing database creation ([#277](https://github.com/kizniche/mycodo/issues/277), [#278](https://github.com/kizniche/mycodo/issues/278), [#283](https://github.com/kizniche/mycodo/issues/283))\n\n\n## 5.1.0 (2017-08-07)\n\nSome graphs will need to be manually reconfigured after upgrading to 5.1.0. This is due to adding PWM as an output and PID option, necessitating refactoring certain portions of code related to graph display.\n\n### Features\n\n - Add PWM support as output ([#262](https://github.com/kizniche/mycodo/issues/262))\n - Add PWM support as PID output\n - Add min and max duty cycle options to PWM PID\n - Add \"Max Amps\" as a general configuration option\n - Improve error reporting for devices and sensors\n - Add ability to power-cycle the DHT11 sensor if 3 consecutive measurements cannot be retrieved (uses power relay option) ([#273](https://github.com/kizniche/mycodo/issues/273))\n - Add MH-Z19 CO2 sensor\n\n### Bugfixes\n\n - Upgrade to InfluxDB 1.3.1 ([#8500](https://github.com/influxdata/influxdb/issues/8500) - fixes InfluxDB going unresponsive)\n - Fix K30 sensor module\n\n\n## 5.0.49 (2017-07-13)\n\n### Bugfixes\n\n - Move relay_usage_reports directory to new version during upgrade\n - Fix LCD display of PID setpoints with long float values (round two decimal places)\n - Fix geocoder issue\n\n\n## 5.0.48 (2017-07-11)\n\n### Features\n\n - Add power relay to AM2315 sensor configuration ([#273](https://github.com/kizniche/mycodo/issues/273))\n\n\n## 5.0.47 (2017-07-09)\n\n### Bugfixes\n\n - Fix upgrade script\n\n\n## 5.0.46 (2017-07-09)\n\n### Bugfixes\n\n - Fix upgrade initialization to include setting permissions\n\n\n## 5.0.45 (2017-07-07)\n\n### Bugfixes\n\n - Fix minor bug that leaves the .upgrade file in a backup, causing issue with upgrading after a restore\n\n\n## 5.0.44 (2017-07-06)\n\n### Bugfixes\n\n - Fix issues with restore functionality (still possibly buggy: use at own risk)\n\n\n## 5.0.43 (2017-07-06)\n\n### Bugfixes\n\n - Fix issues with restore functionality (still possibly buggy: use at own risk)\n\n\n## 5.0.42 (2017-07-06)\n\n### Features\n\n - Update InfluxDB to 1.3.0\n - Update pip package (geocoder)\n\n\n## 5.0.41 (2017-07-06)\n\n### Features\n\n - Add ability to restore backup (Warning: Experimental feature, not thoroughly tested)\n - Add ability to view the backup log on View Logs page\n - Add script to check if daemon uncleanly shut down during upgrade and remove stale PID file ([#198](https://github.com/kizniche/mycodo/issues/198))\n\n### Bugfixes\n\n - Fix error if country cannot be detected for anonymous statistics\n\n\n## 5.0.40 (2017-07-03)\n\n### Bugfixes\n\n - Fix install script error ([#253](https://github.com/kizniche/mycodo/issues/253))\n - Fix issue modulating relays if a conditionals using them are not properly configured ([#266](https://github.com/kizniche/mycodo/issues/266))\n\n\n## 5.0.39 (2017-06-27)\n\n### Bugfixes\n\n - Fix upgrade process\n\n\n## 5.0.38 (2017-06-27)\n\n### Bugfixes\n\n - Fix install script\n\n\n## 5.0.37 (2017-06-27)\n\n### Bugfixes\n\n - Change wiringpi during install\n\n\n## 5.0.36 (2017-06-27)\n\n### Features\n\n - Add ability to create a Mycodo backup\n - Add ability to delete a Mycodo backup\n - Remove mycodo-wrapper binary in favor of compiling it from source code during install/upgrade\n\n### Bugfixes\n\n - Fix issue with influxdb database and user creation during install ([#255](https://github.com/kizniche/mycodo/issues/255))\n \n### Work in progress\n\n - Add ability to restore a Mycodo backup\n\n\n## 5.0.35 (2017-06-18)\n\n### Bugfixes\n\n - Fix swap size check (and change to 512 MB) to permit pi_switch module compilation size requirement ([#258](https://github.com/kizniche/mycodo/issues/258))\n\n\n## 5.0.34 (2017-06-18)\n\n### Features\n\n - Add TSL2591 luminosity sensor ([#257](https://github.com/kizniche/mycodo/issues/257))\n - Update sensor page to more compact style\n\n### Bugfixes\n\n - Append setup.sh output to setup.log instead of overwriting ([#255](https://github.com/kizniche/mycodo/issues/255))\n - Fix display of error response when attempting to modify timer when it's active\n\n\n## 5.0.33 (2017-06-05)\n\n### Features\n\n - Add new relay type: Execute Commands (executes linux commands to turn the relay on and off)\n\n### Bugfixes\n\n - Fix query of ADC unit data (not voltage) from influxdb\n \n### Miscellaneous\n\n - Update influxdb to version 1.2.4\n - Update pip packages\n - Update Manual\n - Update translatable texts\n\n\n## 5.0.32 (2017-06-02)\n\n### Bugfixes\n\n - Fix display of PID output and setpoint on live graphs ([#252](https://github.com/kizniche/mycodo/issues/252))\n\n\n## 5.0.31 (2017-05-31)\n\n### Features\n\n - Add option to not turn wireless relay on or off at startup\n\n### Bugfixes\n\n - Fix inability to save SHT sensor options ([#251](https://github.com/kizniche/mycodo/issues/251))\n - Fix inability to turn relay on if another relay is unconfigured ([#251](https://github.com/kizniche/mycodo/issues/251))\n\n\n## 5.0.30 (2017-05-23)\n\n### Bugfixes\n\n - Fix display of proper relay status if pin is 0\n\n\n## 5.0.29 (2017-05-23)\n\n### Features\n\n - Relay and Timer page style improvements\n\n### Bugfixes\n\n - Add influxdb query generator with input checks\n\n\n## 5.0.28 (2017-05-23)\n\n### Features\n\n  - Add support for Atlas Scientific pH Sensor ([#238](https://github.com/kizniche/mycodo/issues/238))\n  - Add support for calibrating the Atlas Scientific pH sensor\n  - Add UART support for Atlas Scientific PT-1000 sensor\n  - Update Korean translations\n  - Add measurement retries upon CRC fail for AM2315 sensor ([#246](https://github.com/kizniche/mycodo/issues/246))\n  - Add page error handler that provides full traceback when the Web UI crashes\n  - Display live pH measurements during pH sensor calibration\n  - Add ability to clear calibration data from Atlas Scientific pH sensors\n  - Add sensor option to calibrate Atlas Scientific pH sensor with the temperature from another sensor before measuring pH\n  - Add 433MHz wireless transmitter/receiver support for relay actuation ([#88](https://github.com/kizniche/mycodo/issues/88), [#245](https://github.com/kizniche/mycodo/issues/245))\n\n### Bugfixes\n\n  - Fix saving of proper start time during timer creation ([#248](https://github.com/kizniche/mycodo/issues/248))\n  - Fix unicode error when generating relay usage reports\n\n\n## 5.0.27 (2017-04-12)\n\n### Bugfixes\n\n  - Fix issue with old database entries and new graph page parsing\n  - Revert to old relay form submission method (ajax method broken)\n\n\n## 5.0.26 (2017-04-12)\n\n### Bugfixes\n\n  - Fix critical issue with upgrade script\n\n\n## 5.0.25 (2017-04-12)\n\n### Bugfixes\n\n  - Fix setting custom graph colors\n\n\n## 5.0.24 (2017-04-12)\n\n### Features\n\n  - Add toastr and ajax support for submitting forms without refreshing the page (currently only used with relay On/Off/Duration buttons) ([#70](https://github.com/kizniche/mycodo/issues/70))\n\n### Bugfixes\n\n  - Fix issue with changing ownership of SSL certificates during install ([#240](https://github.com/kizniche/mycodo/issues/240))\n  - Fix PID Output not appearing when adding new graph (modifying graph works)\n  - Remove ineffective upgrade reversion script (reversion was risky)\n\n\n## 5.0.23 (2017-04-10)\n\n### Features\n\n  - Add PID Output as a graph display option (useful for tuning PID controllers)\n\n### Bugfixes\n\n  - Fix display of unicode characters ([#237](https://github.com/kizniche/mycodo/issues/237))\n\n\n## 5.0.22 (2017-04-08)\n\n### Features\n\n  - Add sensor conditional: emailing of photo or video (video only supported by picamera library at the moment) ([#226](https://github.com/kizniche/mycodo/issues/226))\n\n### Bugfixes\n\n  - Fix inability to display Sensor page if unable to detect DS18B20 sensors ([#236](https://github.com/kizniche/mycodo/issues/236))\n  - Fix inability to disable relay during camera capture\n  - Fix SSL generation script and strengthen from 2048 bit to 4096 bit RSA ([#234](https://github.com/kizniche/mycodo/issues/234))\n\n### Miscellaneous\n\n  - New cleaner Timer page style\n\n\n## 5.0.21 (2017-04-02)\n\n### Bugfixes\n\n  - Fix BMP280 sensor module initialization ([#233](https://github.com/kizniche/mycodo/issues/233))\n  - Fix saving and display of PID and Relay values on LCDs\n\n\n## 5.0.20 (2017-04-02)\n\n### Bugfixes\n\n  - Fix BMP280 sensor module initialization\n  - Fix saving and display of PID and Relay values on LCDs\n  - Fix inability to select certain measurements for a sensor under the PID options\n\n\n## 5.0.19 (2017-04-02)\n\n### Bugfixes\n\n  - Fix BMP280 sensor I<sup>2</sup>C address options ([#233](https://github.com/kizniche/mycodo/issues/233))\n\n\n## 5.0.18 (2017-04-01)\n\n### Features\n\n  - Add BMP280 I2C temperature and pressure sensor ([#233](https://github.com/kizniche/mycodo/issues/233))\n\n\n## 5.0.17 (2017-03-31)\n\n### Bugfixes\n\n  - Fix issue with graph page crashing when non-existent sensor referenced ([#232](https://github.com/kizniche/mycodo/issues/232))\n\n\n## 5.0.16 (2017-03-30)\n\n### Features\n\n  - New Mycodo Manual rendered in markdown, html, pdf, and plain text\n\n### Bugfixes\n\n  - Fix BME280 sensor module to include calibration code (fixes \"stuck\" measurements)\n  - Fix issue with graph page crashing when non-existent sensor referenced ([#231](https://github.com/kizniche/mycodo/issues/231))\n\n\n## 5.0.15 (2017-03-28)\n\n### Bugfixes\n\n  - Fix issue with graph page errors when creating a graph with PIDs or Relays\n  - Fix sensor conditional measurement selections ([#230](https://github.com/kizniche/mycodo/issues/230))\n  - Fix inability to stream video from a Pi camera ([#228](https://github.com/kizniche/mycodo/issues/228))\n  - Fix inability to delete LCD ([#229](https://github.com/kizniche/mycodo/issues/229))\n  - Fix measurements export\n  - Fix display of BMP and BH1750 sensor measurements in sensor lists (graphs/export)\n\n### Miscellaneous\n\n  - Better exception-handling (clean up logging of influxdb measurement errors)\n\n\n## 5.0.14 (2017-03-25)\n\n### Features\n\n  - Add BH1750 I2C light sensor ([#224](https://github.com/kizniche/mycodo/issues/224))\n\n### Bugfixes\n\n  - Change default opencv values for new cameras ([#225](https://github.com/kizniche/mycodo/issues/225))\n  - Fix relays not recording proper ON duration (which causes other issues) ([#223](https://github.com/kizniche/mycodo/issues/223))\n  - Fix new graphs occupying 100% width (12/12 columns)\n\n\n## 5.0.13 (2017-03-24)\n\n### Bugfixes\n\n  - Fix issue with adding/deleting relays\n  - Fix inability to have multiple graphs appear on the same row\n  - Fix UnicodeEncodeError when using translations\n  - Fix BME280 sensor pressure/altitude\n\n\n## 5.0.12 (2017-03-23)\n\n### Bugfixes\n\n  - Fix frontend and backend issues with conditionals\n\n\n## 5.0.11 (2017-03-22)\n\n### Bugfixes\n\n  - Fix alembic database upgrade error (hopefully)\n\n\n## 5.0.10 (2017-03-22)\n\n### Bugfixes\n\n  - Fix photos being taken uncontrollably when a time-lapse is active\n\n\n## 5.0.9 (2017-03-22)\n\n### Bugfixes\n\n  - Update geocoder to 1.21.0 to attempt to resolve issue\n  - Fix creation of alembic version number in database of new install\n  - Add suffixes to distinguish Object from Die temperatures of TMP006 sensor on Live page\n  - Fix reference to pybabel in virtualenv\n\n\n## 5.0.8 (2017-03-22)\n\n### Features\n\n  - Add option to hide tooltips\n\n### Bugfixes\n\n  - Add alembic upgrade check as a part of flask app startup\n  - Fix reference to alembic for database upgrades\n  - Fix photos being taken uncontrollably when a time-lapse is active\n  - Show edge measurements as vertical bars instead of lines on graphs\n  - Fix default image width/height when adding cameras\n  - Prevent attempting to setup a relay at startup if the GPIO pin is < 1\n  - Add coverage where DHT22 sensor could be power cycled to fix an inability to acquire measurements\n  - Display the device name next to each custom graph color\n  - Fix encoding error when collecting anonymous statistics ([#216](https://github.com/kizniche/mycodo/issues/216))\n\n### Miscellaneous\n\n  - Update Influxdb to version 1.2.2\n  - UI style improvements\n\n\n## 5.0.7 (2017-03-19)\n\n### Bugfixes\n\n  - Fix pybabel reference during install/upgrade ([#212](https://github.com/kizniche/mycodo/issues/212))\n\n\n## 5.0.6 (2017-03-19)\n\n### Bugfixes\n\n  -  Fix edge detection conditional statements ([#214](https://github.com/kizniche/mycodo/issues/214))\n  -  Fix identification and conversion of dewpoint on live page ([#215](https://github.com/kizniche/mycodo/issues/215))\n\n\n## 5.0.5 (2017-03-18)\n\n### Bugfixes\n\n  - Fix issue with timers not actuating relays ([#213](https://github.com/kizniche/mycodo/issues/213))\n\n\n## 5.0.4 (2017-03-18)\n\n### Bugfixes\n\n  - Fix issues with saving LCD options ([#211](https://github.com/kizniche/mycodo/issues/211))\n\n\n## 5.0.0 (2017-03-18)\n\n### Bugfixes\n\n  - Fixes inability of relay conditionals to operate ([#209](https://github.com/kizniche/mycodo/issues/209), [#210](https://github.com/kizniche/mycodo/issues/210))\n  - Fix issue with user creation/deletion in web UI\n  - Fix influxdb being unreachable directly after package install\n\n### Features\n\n  - Complete Spanish translation\n  - Add auto-generation of relay usage/cost reports on a daily, weekly, or monthly schedule\n  - Add ability to check daemon health (mycodo_client.py --checkdaemon)\n  - Add sensor conditional actions: Activate/Deactivate PID, Email Photo, Email Video\n  - Add PID option: maximum allowable sensor measurement age (to allow the PID controller to manipulate relays, the sensor measurement must have occurred in the past x seconds)\n  - Add PID option: minimum off duration for lower/raise relay (protects devices that require a minimum off period by preventing power cycling from occurring too quickly)\n  - Add new sensor: Free Disk Space (of a set path)\n  - Add new sensor: Mycodo Daemon RAM Usage (used for testing)\n  - Add ability to use multiple camera configurations (multiple cameras)\n  - Add OpenCV camera library to allow use of USB cameras ([#193](https://github.com/kizniche/mycodo/issues/193))\n  - Automatically detect DS18B20 sensors in sensor configuration\n  - Add ability to create custom user roles\n  - Add new user roles: Editor and Monitor ([#46](https://github.com/kizniche/mycodo/issues/46))\n\n### Miscellaneous\n\n  - Mobile display improvements\n  - Improve content and accessibility of help documentation\n  - Redesign navigation menu (including glyphs from bootstrap and fontawesome)\n  - Move to using a Python virtual environment ([#203](https://github.com/kizniche/mycodo/issues/203))\n  - Refactor the relay/sensor conditional management system\n  - User names are no longer case-sensitive\n  - Switch to using Flask-Login\n  - Switch to using flask_wtf.FlaskForm (from using deprecated flask_wtf.Form)\n  - Update web interface style and layout\n  - Update influxdb to 1.2.1\n  - Update Flask WTF to 0.14.2\n  - Move from using sqlalchemy to flask sqlalchemy\n  - Restructure database ([#115](https://github.com/kizniche/mycodo/issues/115), [#122](https://github.com/kizniche/mycodo/issues/122))\n\n\n## 4.2.0 (2017-03-16)\n\n### Features\n\n  - Add ability to turn a relay on for a specific duration of time\n  - Update style of Timer and Relay pages (mobile-compatibility)\n\n\n## 4.1.16 (2017-02-05)\n\n### Bugfixes\n\n  - Revert back to influxdb 1.1.1 to fix LCD time display ([#7877](https://github.com/influxdata/influxdb/issues/7877) will fix, when released)\n  - Fix influxdb not restarting after a new version is installed\n  - Fix issue with relay conditionals being triggered upon shutdown\n  - Fix asynchronous graph to use local timezone rather than UTC ([#185](https://github.com/kizniche/mycodo/issues/185))\n\n### Miscellaneous\n\n  - Remove archived versions of Mycodo (Mycodo/old) during upgrade (saves space during backup)\n\n\n## 4.1.15 (2017-01-31)\n\n### Bugfixes\n\n  - Fix LCD KeyError from missing measurement unit for durations_sec\n\n\n## 4.1.14 (2017-01-30)\n\n### Bugfixes\n\n  - Fix DHT11 sensor module ([#176](https://github.com/kizniche/mycodo/issues/176))\n\n### Miscellaneous\n\n  - Update influxdb to 1.2.0\n\n\n## 4.1.13 (2017-01-30)\n\n### Bugfixes\n\n  - Fix DHT11 sensor module ([#176](https://github.com/kizniche/mycodo/issues/176))\n\n\n## 4.1.12 (2017-01-30)\n\n### Bugfixes\n\n  - Fix PID controller crash\n\n\n## 4.1.11 (2017-01-30)\n\nThis is a small update, mainly to fix the install script. It also *should* fix the DHT11 sensor module from stopping at the first bad checksum.\n\n### Bugfixes\n\n  - Fix DHT11 sensor module, removing exception preventing acquisition of future measurements ([#176](https://github.com/kizniche/mycodo/issues/176))\n  - Fix setup.sh install script by adding git as a dependency ([#183](https://github.com/kizniche/mycodo/issues/183))\n  - Fix initialization script executed during install and upgrade\n\n\n## 4.1.10 (2017-01-29)\n\n### Bugfixes\n\n  - Fix PID variable initializations\n  - Fix KeyError in controller_lcd.py\n  - Fix camera termination bug ([#178](https://github.com/kizniche/mycodo/issues/178))\n  - Fix inability to pause/hold/resume PID controllers\n\n### Miscellaneous\n\n  - Add help text for conditional statements to relay page ([#181](https://github.com/kizniche/mycodo/issues/181))\n\n\n## 4.1.9 (2017-01-27)\n\nThis update fixes two major bugs: Sometimes admin users not being created properly from the web UI and the daemon not being set to automatically start during install.\n\nThis update also fixes an even more severe bug affecting the database upgrade system. If you installed a system before this upgrade, you are probably affected. This release will display a message indicating if your database has an issue. Deleting ~/Mycodo/databases/mycodo.db and restarting the web server (or reboot) will regenerate the database.\n\nIf your daemon doesn't automatically start because you installed it with a botched previous version, issue the following commands to add it to systemctl's autostart:\n\n***Important***: Make sure you rename 'user' below to your actual user where you installed Mycodo, and make sure the Mycodo install directory is correct and points to the correct mycodo.service file.\n\n```\nsudo service mycodo stop\nsudo systemctl disable mycodo.service\nsudo rm -rf /etc/systemd/system/mycodo.service\nsudo systemctl enable /home/user/Mycodo/install/mycodo.service\nsudo service mycodo start\n```\n\n### Features\n\n  - Add check for problematic database and notify user how to fix it\n  - Add ability to define the colors of lines on general graphs ([#161](https://github.com/kizniche/mycodo/issues/161))\n\n### Bugfixes\n\n  - Update install instructions to correct downloading the latest release tarball\n  - Fix for database upgrade bug that has been plaguing Mycodo for the past few releases\n  - Fix incorrect displaying of graphs with relay or PID data\n  - Fix relay turning off when saving relay settings and GPIO pin doesn't change\n  - Fix bug that crashes the daemon if the user database is empty\n  - Fix Spanish translation file errors\n  - Fix mycodo daemon not automatically starting after install\n  - Fix inability to create admin user from the web interface\n  - Fix inability to delete methods\n  - Fix Atlas PT100 sensor module 'invalid literal for float()' error\n  - Fix camera termination bug ([#178](https://github.com/kizniche/mycodo/issues/178))\n\nMiscellaneous\n\n  - Add new theme: Sun\n\n\n## 4.1.8 (2017-01-21)\n\n### Bugfixes\n\n  - Actually fix the upgrade system (mycodo_wrapper)\n  - Fix bug in DHT22 sensor module preventing measurements\n  - Fix inability to show latest time-lapse image on the camera page (images are still being captured)\n\n### Miscellaneous\n\n  - Update Spanish translations\n\n\n## 4.1.7 (2017-01-19)\n\n### Bugfixes\n\n  - Fix upgrade system (mycodo_wrapper). This may have broke the upgrade system (if so, use the manual method in the README)\n  - Fix time-lapses not resuming after an upgrade\n  - Fix calculation of total 1-month relay usage and cost\n  - Fix (and modify) the logging behavior in modules\n  - Fix K30 sensor module returning None as a measurement value\n  - Fix gpiod being added to crontab during install from setup.sh ([#174](https://github.com/kizniche/mycodo/issues/174))\n\n\n## 4.1.6 (2017-01-17)\n\n### Features\n\n  - Add ability to export selected measurement data (in CSV format) from a date/time span\n\n### Bugfixes\n\n  - Fix issue with setup.sh when the version of wget<1.16 ([#173](https://github.com/kizniche/mycodo/issues/173))\n  - Fix error calculating rely usage when it's currently the billing day of the month\n\n### Miscellaneous\n\n  - Remove Sensor Logs (Tools/Sensor Logs). The addition of the measurement export feature in this release deprecates Sensor Logs. Note that by the very nature of how the Sensor Log controllers were designed, there was a high probability of missing measurements. The new measurement export feature ensures all measurements are exported.\n  - Add more translatable text\n  - Add password repeat input when creating new admin user\n\n\n## 4.1.5 (2017-01-14)\n\n### Bugfixes\n\n  - Fix DHT11 sensor module not returning values ([#171](https://github.com/kizniche/mycodo/issues/171))\n  - Fix HTU21D sensor module not returning values ([#172](https://github.com/kizniche/mycodo/issues/172))\n\n\n## 4.1.4 (2017-01-13)\n\nThis release introduces a new method for upgrading Mycodo to the latest version. Upgrades will now be performed from github releases instead of commits, which should prevent unintended upgrades to the public, facilitate bug-tracking, and enable easier management of a changelog.\n\n### Performance\n\n  - Add ability to hold, pause and resume PID controllers\n  - Add ability to modify PID controller parameters while active, held, or paused\n  - New method of processing data on live graphs that is more accurate and reduced bandwidth\n  - Install numpy binary from apt instead of compiling with pip\n\n### Features\n\n  - Add ability to set the language of the web user interface ([#167](https://github.com/kizniche/mycodo/issues/167))\n  - Add Spanish language translation\n  - New upgrade system to perform upgrades from github releases instead of commits\n  - Allow symbols to be used in a user password ([#76](https://github.com/kizniche/mycodo/issues/76))\n  - Introduce changelog (CHANGELOG.md)\n\n### Bugfixes\n\n  - Fix inability to update long-duration relay times on live graphs\n  - Fix dew point being incorrectly inserted into the database\n  - Fix inability to start video stream ([#155](https://github.com/kizniche/mycodo/issues/155))\n  - Fix SHT1x7x sensor module not returning values ([#159](https://github.com/kizniche/mycodo/issues/159))\n\n### Miscellaneous\n\n  - Add more software tests\n  - Update Flask to v0.12\n  - Update InfluxDB to v1.1.1\n  - Update factory_boy to v2.8.1\n  - Update sht_sensor to v16.12.1\n  - Move install files to Mycodo/install\n\n\n## 4.0.26 (2016-11-23)\n\n### Features\n\n  - Add more I2C LCD address options (again)\n  - Add Fahrenheit conversion for temperatures on /live page\n  - Add github issue template ([#150](https://github.com/kizniche/mycodo/issues/150) [#151](https://github.com/kizniche/Mycodo/pull/151))\n  - Add information to the README about performing manual backup/restore\n  - Add universal sensor tests\n\n### Bugfixes\n\n  - Fix code warnings and errors\n  - Add exceptions, logging, and docstrings\n\n\n## 4.0.25 (2016-11-13)\n\n### Features\n\n  - New create admin user page if no admin user exists\n  - Add support for [Chirp soil moisture sensor](https://wemakethings.net/chirp/)\n  - Add more I2C LCD address options\n  - Add endpoint tests\n  - Add use of [Travis CI](https://travis-ci.org/) and [Codacy](https://www.codacy.com/)\n\n### Bugfixes\n\n  - Fix controller crash when using a 20x4 LCD ([#136](https://github.com/kizniche/mycodo/issues/136))\n  - Add short sleep() to login to reduce chance of brute-force success\n  - Fix code warnings and errors\n\n\n## 4.0.24 (2016-10-26)\n\n### Features\n\n  - Setup flask app using new create_app() factory\n  - Create application factory and moved view implementation into a general blueprint ([#129](https://github.com/kizniche/mycodo/issues/129) [#132](https://github.com/kizniche/Mycodo/pull/132) [#142](https://github.com/kizniche/Mycodo/pull/142))\n  - Add initial fixture tests\n\n\n## 4.0.23 (2016-10-18)\n\n### Performance\n\n  - Improve time-lapse capture method\n\n### Features\n\n  - Add BME280 sensor\n  - Create basic tests for flask app ([#112](https://github.com/kizniche/mycodo/issues/122))\n  - Relocated Flask UI into its own package ([#116](https://github.com/kizniche/Mycodo/pull/116))\n  - Add DB session fixtures; create model factories\n  - Add logging of relay durations that are turned on and off, without a known duration\n  - Add ability to define power billing cycle day, AC voltage, cost per kWh, and currency unit for relay usage statistics\n  - Add more Themes\n  - Add hostname to UI page title\n\n### Bugfixes\n\n  - Fix relay conditionals when relays turn on for durations of time ([#123](https://github.com/kizniche/mycodo/issues/123))\n  - Exclude photo/video directories from being backed up during upgrade\n  - Removed unused imports\n  - Changed print statements to logging statements\n  - Fix inability to save sensor settings ([#120](https://github.com/kizniche/mycodo/issues/120) [#134](https://github.com/kizniche/mycodo/issues/134))\n", "# coding=utf-8\nimport calendar\nimport datetime\nimport logging\nimport subprocess\nimport time\nfrom importlib import import_module\n\nimport flask_login\nimport os\nfrom dateutil.parser import parse as date_parse\nfrom flask import Response\nfrom flask import flash\nfrom flask import jsonify\nfrom flask import redirect\nfrom flask import send_file\nfrom flask import send_from_directory\nfrom flask import url_for\nfrom flask.blueprints import Blueprint\nfrom flask_babel import gettext\nfrom flask_limiter import Limiter\nfrom influxdb import InfluxDBClient\nfrom sqlalchemy import and_\n\nfrom mycodo.config import DOCKER_CONTAINER\nfrom mycodo.config import INFLUXDB_DATABASE\nfrom mycodo.config import INFLUXDB_HOST\nfrom mycodo.config import INFLUXDB_PASSWORD\nfrom mycodo.config import INFLUXDB_PORT\nfrom mycodo.config import INFLUXDB_USER\nfrom mycodo.config import INSTALL_DIRECTORY\nfrom mycodo.config import LOG_PATH\nfrom mycodo.config import PATH_CAMERAS\nfrom mycodo.config import PATH_NOTE_ATTACHMENTS\nfrom mycodo.databases.models import Camera\nfrom mycodo.databases.models import Conversion\nfrom mycodo.databases.models import DeviceMeasurements\nfrom mycodo.databases.models import Input\nfrom mycodo.databases.models import Math\nfrom mycodo.databases.models import NoteTags\nfrom mycodo.databases.models import Notes\nfrom mycodo.databases.models import Output\nfrom mycodo.databases.models import OutputChannel\nfrom mycodo.databases.models import PID\nfrom mycodo.devices.camera import camera_record\nfrom mycodo.mycodo_client import DaemonControl\nfrom mycodo.mycodo_flask.routes_authentication import clear_cookie_auth\nfrom mycodo.mycodo_flask.utils import utils_general\nfrom mycodo.mycodo_flask.utils.utils_general import get_ip_address\nfrom mycodo.mycodo_flask.utils.utils_output import get_all_output_states\nfrom mycodo.utils.database import db_retrieve_table\nfrom mycodo.utils.image import generate_thermal_image_from_pixels\nfrom mycodo.utils.influx import influx_time_str_to_milliseconds\nfrom mycodo.utils.influx import query_string\nfrom mycodo.utils.system_pi import assure_path_exists\nfrom mycodo.utils.system_pi import is_int\nfrom mycodo.utils.system_pi import return_measurement_info\nfrom mycodo.utils.system_pi import str_is_float\n\nblueprint = Blueprint('routes_general',\n                      __name__,\n                      static_folder='../static',\n                      template_folder='../templates')\n\nlogger = logging.getLogger(__name__)\n\nlimiter = Limiter(key_func=get_ip_address)\n\n\n@blueprint.route('/')\ndef home():\n    \"\"\"Load the default landing page\"\"\"\n    try:\n        if flask_login.current_user.is_authenticated:\n            if flask_login.current_user.landing_page == 'live':\n                return redirect(url_for('routes_page.page_live'))\n            elif flask_login.current_user.landing_page == 'dashboard':\n                return redirect(url_for('routes_dashboard.page_dashboard_default'))\n            elif flask_login.current_user.landing_page == 'info':\n                return redirect(url_for('routes_page.page_info'))\n            return redirect(url_for('routes_page.page_live'))\n    except:\n        logger.error(\"User may not be logged in. Clearing cookie auth.\")\n    return clear_cookie_auth()\n\n@blueprint.route('/index_page')\ndef index_page():\n    \"\"\"Load the index page\"\"\"\n    try:\n        if not flask_login.current_user.index_page:\n            return home()\n        elif flask_login.current_user.index_page == 'landing':\n            return home()\n        else:\n            if flask_login.current_user.is_authenticated:\n                if flask_login.current_user.index_page == 'live':\n                    return redirect(url_for('routes_page.page_live'))\n                elif flask_login.current_user.index_page == 'dashboard':\n                    return redirect(url_for('routes_dashboard.page_dashboard_default'))\n                elif flask_login.current_user.index_page == 'info':\n                    return redirect(url_for('routes_page.page_info'))\n                return redirect(url_for('routes_page.page_live'))\n    except:\n        logger.error(\"User may not be logged in. Clearing cookie auth.\")\n    return clear_cookie_auth()\n\n@blueprint.route('/settings', methods=('GET', 'POST'))\n@flask_login.login_required\ndef page_settings():\n    return redirect('settings/general')\n\n\n@blueprint.route('/note_attachment/<filename>')\n@flask_login.login_required\ndef send_note_attachment(filename):\n    \"\"\"Return a file from the note attachment directory\"\"\"\n    file_path = os.path.join(PATH_NOTE_ATTACHMENTS, filename)\n    if file_path is not None:\n        try:\n            if os.path.abspath(file_path).startswith(PATH_NOTE_ATTACHMENTS):\n                return send_file(file_path, as_attachment=True)\n        except Exception:\n            logger.exception(\"Send note attachment\")\n\n\n@blueprint.route('/camera/<camera_unique_id>/<img_type>/<filename>')\n@flask_login.login_required\ndef camera_img_return_path(camera_unique_id, img_type, filename):\n    \"\"\"Return an image from stills or time-lapses\"\"\"\n    camera = Camera.query.filter(Camera.unique_id == camera_unique_id).first()\n    camera_path = assure_path_exists(\n        os.path.join(PATH_CAMERAS, '{uid}'.format(uid=camera.unique_id)))\n    if img_type == 'still':\n        if camera.path_still:\n            path = camera.path_still\n        else:\n            path = os.path.join(camera_path, img_type)\n    elif img_type == 'timelapse':\n        if camera.path_timelapse:\n            path = camera.path_timelapse\n        else:\n            path = os.path.join(camera_path, img_type)\n    else:\n        return \"Unknown Image Type\"\n\n    if os.path.isdir(path):\n        files = (files for files in os.listdir(path)\n                 if os.path.isfile(os.path.join(path, files)))\n    else:\n        files = []\n    if filename in files:\n        path_file = os.path.join(path, filename)\n        if os.path.abspath(path_file).startswith(path):\n            return send_file(path_file, mimetype='image/jpeg')\n\n    return \"Image not found\"\n\n\n@blueprint.route('/camera_acquire_image/<image_type>/<camera_unique_id>/<max_age>')\n@flask_login.login_required\ndef camera_img_acquire(image_type, camera_unique_id, max_age):\n    \"\"\"Capture an image and return the filename\"\"\"\n    if image_type == 'new':\n        tmp_filename = None\n    elif image_type == 'tmp':\n        tmp_filename = '{id}_tmp.jpg'.format(id=camera_unique_id)\n    else:\n        return\n    path, filename = camera_record('photo', camera_unique_id, tmp_filename=tmp_filename)\n    image_path = os.path.join(path, filename)\n    time_max_age = datetime.datetime.now() - datetime.timedelta(seconds=int(max_age))\n    timestamp = os.path.getctime(image_path)\n    if datetime.datetime.fromtimestamp(timestamp) > time_max_age:\n        date_time = datetime.datetime.fromtimestamp(timestamp).strftime('%Y-%m-%d %H:%M:%S')\n        return_values = '[\"{}\",\"{}\"]'.format(filename, date_time)\n    else:\n        return_values = '[\"max_age_exceeded\"]'\n    return Response(return_values, mimetype='text/json')\n\n\n@blueprint.route('/camera_latest_timelapse/<camera_unique_id>/<max_age>')\n@flask_login.login_required\ndef camera_img_latest_timelapse(camera_unique_id, max_age):\n    \"\"\"Capture an image and/or return a filename\"\"\"\n    camera = Camera.query.filter(\n            Camera.unique_id == camera_unique_id).first()\n\n    _, tl_path = utils_general.get_camera_paths(camera)\n\n    timelapse_file_path = os.path.join(tl_path, str(camera.timelapse_last_file))\n\n    if camera.timelapse_last_file is not None and os.path.exists(timelapse_file_path):\n        time_max_age = datetime.datetime.now() - datetime.timedelta(seconds=int(max_age))\n        if datetime.datetime.fromtimestamp(camera.timelapse_last_ts) > time_max_age:\n            ts = datetime.datetime.fromtimestamp(camera.timelapse_last_ts).strftime(\"%Y-%m-%d %H:%M:%S\")\n            return_values = '[\"{}\",\"{}\"]'.format(camera.timelapse_last_file, ts)\n        else:\n            return_values = '[\"max_age_exceeded\"]'\n    else:\n        return_values = '[\"file_not_found\"]'\n    return Response(return_values, mimetype='text/json')\n\n\ndef gen(camera):\n    \"\"\"Video streaming generator function.\"\"\"\n    while True:\n        frame = camera.get_frame()\n        yield (b'--frame\\r\\n'\n               b'Content-Type: image/jpeg\\r\\n\\r\\n' + frame + b'\\r\\n')\n\n\n@blueprint.route('/video_feed/<unique_id>')\n@flask_login.login_required\ndef video_feed(unique_id):\n    \"\"\"Video streaming route. Put this in the src attribute of an img tag.\"\"\"\n    camera_options = Camera.query.filter(Camera.unique_id == unique_id).first()\n    camera_stream = import_module('mycodo.mycodo_flask.camera.camera_' + camera_options.library).Camera\n    camera_stream.set_camera_options(camera_options)\n    return Response(gen(camera_stream(unique_id=unique_id)),\n                    mimetype='multipart/x-mixed-replace; boundary=frame')\n\n\n@blueprint.route('/outputstate')\n@flask_login.login_required\ndef gpio_state():\n    \"\"\"Return all output states\"\"\"\n    return jsonify(get_all_output_states())\n\n\n@blueprint.route('/outputstate_unique_id/<unique_id>/<channel_id>')\n@flask_login.login_required\ndef gpio_state_unique_id(unique_id, channel_id):\n    \"\"\"Return the GPIO state, for dashboard output \"\"\"\n    channel = OutputChannel.query.filter(OutputChannel.unique_id == channel_id).first()\n    daemon_control = DaemonControl()\n    state = daemon_control.output_state(unique_id, channel.channel)\n    return jsonify(state)\n\n\n@blueprint.route('/widget_execute/<unique_id>')\n@flask_login.login_required\ndef widget_execute(unique_id):\n    \"\"\"Return the response from the execution of widget code \"\"\"\n    daemon_control = DaemonControl()\n    return_value = daemon_control.widget_execute(unique_id)\n    return jsonify(return_value)\n\n\n@blueprint.route('/time')\n@flask_login.login_required\ndef get_time():\n    \"\"\" Return the current time \"\"\"\n    return jsonify(datetime.datetime.now().strftime('%m/%d %H:%M'))\n\n\n@blueprint.route('/dl/<dl_type>/<path:filename>')\n@flask_login.login_required\ndef download_file(dl_type, filename):\n    \"\"\"Serve log file to download\"\"\"\n    if dl_type == 'log':\n        return send_from_directory(LOG_PATH, filename, as_attachment=True)\n\n    return '', 204\n\n\n@blueprint.route('/last/<unique_id>/<measure_type>/<measurement_id>/<period>')\n@flask_login.login_required\ndef last_data(unique_id, measure_type, measurement_id, period):\n    \"\"\"Return the most recent time and value from influxdb\"\"\"\n    if not str_is_float(period):\n        return '', 204\n\n    if measure_type in ['input', 'math', 'function', 'output', 'pid']:\n        dbcon = InfluxDBClient(\n            INFLUXDB_HOST,\n            INFLUXDB_PORT,\n            INFLUXDB_USER,\n            INFLUXDB_PASSWORD,\n            INFLUXDB_DATABASE)\n\n        if measure_type in ['input', 'math', 'function', 'output', 'pid']:\n            measure = DeviceMeasurements.query.filter(\n                DeviceMeasurements.unique_id == measurement_id).first()\n        else:\n            return '', 204\n\n        if measure:\n            conversion = Conversion.query.filter(\n                Conversion.unique_id == measure.conversion_id).first()\n        else:\n            conversion = None\n\n        channel, unit, measurement = return_measurement_info(\n            measure, conversion)\n\n        if hasattr(measure, 'measurement_type') and measure.measurement_type == 'setpoint':\n            setpoint_pid = PID.query.filter(PID.unique_id == measure.device_id).first()\n            if setpoint_pid and ',' in setpoint_pid.measurement:\n                pid_measurement = setpoint_pid.measurement.split(',')[1]\n                setpoint_measurement = DeviceMeasurements.query.filter(\n                    DeviceMeasurements.unique_id == pid_measurement).first()\n                if setpoint_measurement:\n                    conversion = Conversion.query.filter(\n                        Conversion.unique_id == setpoint_measurement.conversion_id).first()\n                    _, unit, measurement = return_measurement_info(setpoint_measurement, conversion)\n        try:\n            if period != '0':\n                query_str = query_string(\n                    unit, unique_id,\n                    measure=measurement, channel=channel,\n                    value='LAST', past_sec=period)\n            else:\n                query_str = query_string(\n                    unit, unique_id,\n                    measure=measurement, channel=channel,\n                    value='LAST')\n            if query_str == 1:\n                return '', 204\n\n            raw_data = dbcon.query(query_str).raw\n\n            number = len(raw_data['series'][0]['values'])\n            time_raw = raw_data['series'][0]['values'][number - 1][0]\n            value = raw_data['series'][0]['values'][number - 1][1]\n            value = float(value)\n            # Convert date-time to epoch (potential bottleneck for data)\n            dt = date_parse(time_raw)\n            timestamp = calendar.timegm(dt.timetuple()) * 1000\n            live_data = '[{},{}]'.format(timestamp, value)\n\n            return Response(live_data, mimetype='text/json')\n        except KeyError:\n            logger.debug(\"No Data returned form influxdb\")\n            return '', 204\n        except IndexError:\n            logger.debug(\"No Data returned form influxdb\")\n            return '', 204\n        except Exception as e:\n            logger.exception(\"URL for 'last_data' raised and error: \"\n                             \"{err}\".format(err=e))\n            return '', 204\n\n\n@blueprint.route('/past/<unique_id>/<measure_type>/<measurement_id>/<past_seconds>')\n@flask_login.login_required\ndef past_data(unique_id, measure_type, measurement_id, past_seconds):\n    \"\"\"Return data from past_seconds until present from influxdb\"\"\"\n    if not str_is_float(past_seconds):\n        return '', 204\n\n    if measure_type == 'tag':\n        notes_list = []\n\n        tag = NoteTags.query.filter(NoteTags.unique_id == unique_id).first()\n        notes = Notes.query.filter(\n            Notes.date_time >= (datetime.datetime.utcnow() - datetime.timedelta(seconds=int(past_seconds)))).all()\n\n        for each_note in notes:\n            if tag.unique_id in each_note.tags.split(','):\n                notes_list.append(\n                    [each_note.date_time.strftime(\"%Y-%m-%dT%H:%M:%S.000000000Z\"), each_note.name, each_note.note])\n\n        if notes_list:\n            return jsonify(notes_list)\n        else:\n            return '', 204\n\n    elif measure_type in ['input', 'math', 'function', 'output', 'pid']:\n        dbcon = InfluxDBClient(\n            INFLUXDB_HOST,\n            INFLUXDB_PORT,\n            INFLUXDB_USER,\n            INFLUXDB_PASSWORD,\n            INFLUXDB_DATABASE)\n\n        if measure_type in ['input', 'math', 'function', 'output', 'pid']:\n            measure = DeviceMeasurements.query.filter(\n                DeviceMeasurements.unique_id == measurement_id).first()\n        else:\n            measure = None\n\n        if not measure:\n            return \"Could not find measurement\"\n\n        if measure:\n            conversion = Conversion.query.filter(\n                Conversion.unique_id == measure.conversion_id).first()\n        else:\n            conversion = None\n\n        channel, unit, measurement = return_measurement_info(\n            measure, conversion)\n\n        if hasattr(measure, 'measurement_type') and measure.measurement_type == 'setpoint':\n            setpoint_pid = PID.query.filter(PID.unique_id == measure.device_id).first()\n            if setpoint_pid and ',' in setpoint_pid.measurement:\n                pid_measurement = setpoint_pid.measurement.split(',')[1]\n                setpoint_measurement = DeviceMeasurements.query.filter(\n                    DeviceMeasurements.unique_id == pid_measurement).first()\n                if setpoint_measurement:\n                    conversion = Conversion.query.filter(\n                        Conversion.unique_id == setpoint_measurement.conversion_id).first()\n                    _, unit, measurement = return_measurement_info(setpoint_measurement, conversion)\n\n        try:\n            query_str = query_string(\n                unit, unique_id,\n                measure=measurement,\n                channel=channel,\n                past_sec=past_seconds)\n\n            if query_str == 1:\n                return '', 204\n\n            raw_data = dbcon.query(query_str).raw\n\n            if 'series' in raw_data and raw_data['series']:\n                return jsonify(raw_data['series'][0]['values'])\n            else:\n                return '', 204\n        except Exception as e:\n            logger.debug(\"URL for 'past_data' raised and error: \"\n                         \"{err}\".format(err=e))\n            return '', 204\n\n\n@blueprint.route('/generate_thermal_image/<unique_id>/<timestamp>')\n@flask_login.login_required\ndef generate_thermal_image_from_timestamp(unique_id, timestamp):\n    \"\"\"Return a file from the note attachment directory\"\"\"\n    ts_now = datetime.datetime.now().strftime('%Y-%m-%d_%H-%M-%S')\n    camera_path = assure_path_exists(\n        os.path.join(PATH_CAMERAS, '{uid}'.format(uid=unique_id)))\n    filename = 'Still-{uid}-{ts}.jpg'.format(\n        uid=unique_id,\n        ts=ts_now).replace(\" \", \"_\")\n    save_path = assure_path_exists(os.path.join(camera_path, 'thermal'))\n    assure_path_exists(save_path)\n    path_file = os.path.join(save_path, filename)\n\n    dbcon = InfluxDBClient(\n        INFLUXDB_HOST,\n        INFLUXDB_PORT,\n        INFLUXDB_USER,\n        INFLUXDB_PASSWORD,\n        INFLUXDB_DATABASE)\n\n    input_dev = Input.query.filter(Input.unique_id == unique_id).first()\n    pixels = []\n    success = True\n\n    start = int(int(timestamp) / 1000.0)  # Round down\n    end = start + 1  # Round up\n\n    start_timestamp = time.strftime('%Y-%m-%dT%H:%M:%S.000000000Z', time.gmtime(start))\n    end_timestamp = time.strftime('%Y-%m-%dT%H:%M:%S.000000000Z', time.gmtime(end))\n\n    for each_channel in range(input_dev.channels):\n        measurement = 'channel_{chan}'.format(\n            chan=each_channel)\n        query_str = query_string(measurement, unique_id,\n                                 start_str=start_timestamp,\n                                 end_str=end_timestamp)\n        if query_str == 1:\n            logger.error('Invalid query string')\n            success = False\n        else:\n            raw_data = dbcon.query(query_str).raw\n            if not raw_data or 'series' not in raw_data or not raw_data['series']:\n                logger.error('No measurements to export in this time period')\n                success = False\n            else:\n                pixels.append(raw_data['series'][0]['values'][0][1])\n\n    # logger.error(\"generate_thermal_image_from_timestamp: success: {}, pixels: {}\".format(success, pixels))\n\n    if success:\n        generate_thermal_image_from_pixels(pixels, 8, 8, path_file)\n        return send_file(path_file, mimetype='image/jpeg')\n    else:\n        return \"Could not generate image\"\n\n\n@blueprint.route('/export_data/<unique_id>/<measurement_id>/<start_seconds>/<end_seconds>')\n@flask_login.login_required\ndef export_data(unique_id, measurement_id, start_seconds, end_seconds):\n    \"\"\"\n    Return data from start_seconds to end_seconds from influxdb.\n    Used for exporting data.\n    \"\"\"\n    dbcon = InfluxDBClient(\n        INFLUXDB_HOST,\n        INFLUXDB_PORT,\n        INFLUXDB_USER,\n        INFLUXDB_PASSWORD,\n        INFLUXDB_DATABASE, timeout=100)\n\n    output = Output.query.filter(Output.unique_id == unique_id).first()\n    input_dev = Input.query.filter(Input.unique_id == unique_id).first()\n    math = Math.query.filter(Math.unique_id == unique_id).first()\n\n    if output:\n        name = output.name\n    elif input_dev:\n        name = input_dev.name\n    elif math:\n        name = math.name\n    else:\n        name = None\n\n    device_measurement = DeviceMeasurements.query.filter(\n        DeviceMeasurements.unique_id == measurement_id).first()\n    if device_measurement:\n        conversion = Conversion.query.filter(\n            Conversion.unique_id == device_measurement.conversion_id).first()\n    else:\n        conversion = None\n    channel, unit, measurement = return_measurement_info(\n        device_measurement, conversion)\n\n    utc_offset_timedelta = datetime.datetime.utcnow() - datetime.datetime.now()\n    start = datetime.datetime.fromtimestamp(float(start_seconds))\n    start += utc_offset_timedelta\n    start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n    end = datetime.datetime.fromtimestamp(float(end_seconds))\n    end += utc_offset_timedelta\n    end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n    query_str = query_string(\n        unit, unique_id,\n        measure=measurement, channel=channel,\n        start_str=start_str, end_str=end_str)\n    if query_str == 1:\n        flash('Invalid query string', 'error')\n        return redirect(url_for('routes_page.page_export'))\n    raw_data = dbcon.query(query_str).raw\n\n    if not raw_data or 'series' not in raw_data or not raw_data['series']:\n        flash('No measurements to export in this time period', 'error')\n        return redirect(url_for('routes_page.page_export'))\n\n    # Generate column names\n    col_1 = 'timestamp (UTC)'\n    col_2 = '{name} {meas} ({id})'.format(\n        name=name, meas=measurement, id=unique_id)\n    csv_filename = '{id}_{name}_{meas}.csv'.format(\n        id=unique_id, name=name, meas=measurement)\n    import csv\n    from io import StringIO\n\n    def iter_csv(data):\n        \"\"\" Stream CSV file to user for download \"\"\"\n        line = StringIO()\n        writer = csv.writer(line)\n        writer.writerow([col_1, col_2])\n        for csv_line in data:\n            writer.writerow([\n                str(csv_line[0][:-4]).replace('T', ' '),\n                csv_line[1]\n            ])\n            line.seek(0)\n            yield line.read()\n            line.truncate(0)\n            line.seek(0)\n\n    response = Response(iter_csv(raw_data['series'][0]['values']), mimetype='text/csv')\n    response.headers['Content-Disposition'] = 'attachment; filename=\"{}\"'.format(csv_filename)\n    return response\n\n\n@blueprint.route('/async/<device_id>/<device_type>/<measurement_id>/<start_seconds>/<end_seconds>')\n@flask_login.login_required\ndef async_data(device_id, device_type, measurement_id, start_seconds, end_seconds):\n    \"\"\"\n    Return data from start_seconds to end_seconds from influxdb.\n    Used for asynchronous graph display of many points (up to millions).\n    \"\"\"\n    if device_type == 'tag':\n        notes_list = []\n        tag = NoteTags.query.filter(NoteTags.unique_id == device_id).first()\n\n        start = datetime.datetime.utcfromtimestamp(float(start_seconds))\n        if end_seconds == '0':\n            end = datetime.datetime.utcnow()\n        else:\n            end = datetime.datetime.utcfromtimestamp(float(end_seconds))\n\n        notes = Notes.query.filter(\n            and_(Notes.date_time >= start, Notes.date_time <= end)).all()\n        for each_note in notes:\n            if tag.unique_id in each_note.tags.split(','):\n                notes_list.append(\n                    [each_note.date_time.strftime(\"%Y-%m-%dT%H:%M:%S.000000000Z\"), each_note.name, each_note.note])\n\n        if notes_list:\n            return jsonify(notes_list)\n        else:\n            return '', 204\n\n    dbcon = InfluxDBClient(\n        INFLUXDB_HOST,\n        INFLUXDB_PORT,\n        INFLUXDB_USER,\n        INFLUXDB_PASSWORD,\n        INFLUXDB_DATABASE)\n\n    if device_type in ['input', 'math', 'function', 'output', 'pid']:\n        measure = DeviceMeasurements.query.filter(\n            DeviceMeasurements.unique_id == measurement_id).first()\n    else:\n        measure = None\n\n    if not measure:\n        return \"Could not find measurement\"\n\n    if measure:\n        conversion = Conversion.query.filter(\n            Conversion.unique_id == measure.conversion_id).first()\n    else:\n        conversion = None\n    channel, unit, measurement = return_measurement_info(\n        measure, conversion)\n\n    # Set the time frame to the past year if start/end not specified\n    if start_seconds == '0' and end_seconds == '0':\n        # Get how many points there are in the past year\n        query_str = query_string(\n            unit, device_id,\n            measure=measurement,\n            channel=channel,\n            value='COUNT')\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        count_points = raw_data['series'][0]['values'][0][1]\n        # Get the timestamp of the first point in the past year\n        query_str = query_string(\n            unit, device_id,\n            measure=measurement,\n            channel=channel,\n            limit=1)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        try:\n            first_point = raw_data['series'][0]['values'][0][0]\n        except:\n            return '', 204\n\n        end = datetime.datetime.utcnow()\n        end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n    # Set the time frame to the past start epoch to now\n    elif start_seconds != '0' and end_seconds == '0':\n        start = datetime.datetime.utcfromtimestamp(float(start_seconds))\n        start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n        end = datetime.datetime.utcnow()\n        end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n        query_str = query_string(\n            unit, device_id,\n            measure=measurement,\n            channel=channel,\n            value='COUNT',\n            start_str=start_str,\n            end_str=end_str)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        try:\n            count_points = raw_data['series'][0]['values'][0][1]\n        except:\n            return '', 204\n\n        # Get the timestamp of the first point in the past year\n        query_str = query_string(\n            unit, device_id,\n            measure=measurement,\n            channel=channel,\n            start_str=start_str,\n            end_str=end_str,\n            limit=1)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        try:\n            first_point = raw_data['series'][0]['values'][0][0]\n        except:\n            return '', 204\n    else:\n        start = datetime.datetime.utcfromtimestamp(float(start_seconds))\n        start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n        end = datetime.datetime.utcfromtimestamp(float(end_seconds))\n        end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n        query_str = query_string(\n            unit, device_id,\n            measure=measurement,\n            channel=channel,\n            value='COUNT',\n            start_str=start_str,\n            end_str=end_str)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        try:\n            count_points = raw_data['series'][0]['values'][0][1]\n        except:\n            return '', 204\n\n        # Get the timestamp of the first point in the past year\n        query_str = query_string(\n            unit, device_id,\n            measure=measurement,\n            channel=channel,\n            start_str=start_str,\n            end_str=end_str,\n            limit=1)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        try:\n            first_point = raw_data['series'][0]['values'][0][0]\n        except:\n            return '', 204\n\n    start = datetime.datetime.strptime(\n        influx_time_str_to_milliseconds(first_point),\n        '%Y-%m-%dT%H:%M:%S.%f')\n    start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n    logger.debug('Count = {}'.format(count_points))\n    logger.debug('Start = {}'.format(start))\n    logger.debug('End   = {}'.format(end))\n\n    # How many seconds between the start and end period\n    time_difference_seconds = (end - start).total_seconds()\n    logger.debug('Difference seconds = {}'.format(time_difference_seconds))\n\n    # If there are more than 700 points in the time frame, we need to group\n    # data points into 700 groups with points averaged in each group.\n    if count_points > 700:\n        # Average period between input reads\n        seconds_per_point = time_difference_seconds / count_points\n        logger.debug('Seconds per point = {}'.format(seconds_per_point))\n\n        # How many seconds to group data points in\n        group_seconds = int(time_difference_seconds / 700)\n        logger.debug('Group seconds = {}'.format(group_seconds))\n\n        try:\n            query_str = query_string(\n                unit, device_id,\n                measure=measurement,\n                channel=channel,\n                value='MEAN',\n                start_str=start_str,\n                end_str=end_str,\n                group_sec=group_seconds)\n\n            if query_str == 1:\n                return '', 204\n            raw_data = dbcon.query(query_str).raw\n\n            try:\n                return jsonify(raw_data['series'][0]['values'])\n            except:\n                return '', 204\n        except Exception as e:\n            logger.error(\"URL for 'async_data' raised and error: \"\n                         \"{err}\".format(err=e))\n            return '', 204\n    else:\n        try:\n            query_str = query_string(\n                unit, device_id,\n                measure=measurement,\n                channel=channel,\n                start_str=start_str,\n                end_str=end_str)\n\n            if query_str == 1:\n                return '', 204\n            raw_data = dbcon.query(query_str).raw\n\n            return jsonify(raw_data['series'][0]['values'])\n        except Exception as e:\n            logger.error(\"URL for 'async_data' raised and error: \"\n                         \"{err}\".format(err=e))\n            return '', 204\n\n\n@blueprint.route('/async_usage/<device_id>/<unit>/<channel>/<start_seconds>/<end_seconds>')\n@flask_login.login_required\ndef async_usage_data(device_id, unit, channel, start_seconds, end_seconds):\n    \"\"\"\n    Return data from start_seconds to end_seconds from influxdb.\n    Used for asynchronous energy usage display of many points (up to millions).\n    \"\"\"\n    dbcon = InfluxDBClient(\n        INFLUXDB_HOST,\n        INFLUXDB_PORT,\n        INFLUXDB_USER,\n        INFLUXDB_PASSWORD,\n        INFLUXDB_DATABASE)\n\n    # Set the time frame to the past year if start/end not specified\n    if start_seconds == '0' and end_seconds == '0':\n        # Get how many points there are in the past year\n        query_str = query_string(\n            unit, device_id,\n            channel=channel,\n            value='COUNT')\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        count_points = raw_data['series'][0]['values'][0][1]\n        # Get the timestamp of the first point in the past year\n        query_str = query_string(\n            unit, device_id,\n            channel=channel,\n            limit=1)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        first_point = raw_data['series'][0]['values'][0][0]\n        end = datetime.datetime.utcnow()\n        end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n    # Set the time frame to the past start epoch to now\n    elif start_seconds != '0' and end_seconds == '0':\n        start = datetime.datetime.utcfromtimestamp(float(start_seconds))\n        start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n        end = datetime.datetime.utcnow()\n        end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n        query_str = query_string(\n            unit, device_id,\n            channel=channel,\n            value='COUNT',\n            start_str=start_str,\n            end_str=end_str)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        count_points = raw_data['series'][0]['values'][0][1]\n        # Get the timestamp of the first point in the past year\n\n        query_str = query_string(\n            unit, device_id,\n            channel=channel,\n            start_str=start_str,\n            end_str=end_str,\n            limit=1)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        first_point = raw_data['series'][0]['values'][0][0]\n    else:\n        start = datetime.datetime.utcfromtimestamp(float(start_seconds))\n        start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n        end = datetime.datetime.utcfromtimestamp(float(end_seconds))\n        end_str = end.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n        query_str = query_string(\n            unit, device_id,\n            channel=channel,\n            value='COUNT',\n            start_str=start_str,\n            end_str=end_str)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        count_points = raw_data['series'][0]['values'][0][1]\n        # Get the timestamp of the first point in the past year\n\n        query_str = query_string(\n            unit, device_id,\n            channel=channel,\n            start_str=start_str,\n            end_str=end_str,\n            limit=1)\n\n        if query_str == 1:\n            return '', 204\n        raw_data = dbcon.query(query_str).raw\n\n        first_point = raw_data['series'][0]['values'][0][0]\n\n    start = datetime.datetime.strptime(\n        influx_time_str_to_milliseconds(first_point),\n        '%Y-%m-%dT%H:%M:%S.%f')\n    start_str = start.strftime('%Y-%m-%dT%H:%M:%S.%fZ')\n\n    logger.debug('Count = {}'.format(count_points))\n    logger.debug('Start = {}'.format(start))\n    logger.debug('End   = {}'.format(end))\n\n    # How many seconds between the start and end period\n    time_difference_seconds = (end - start).total_seconds()\n    logger.debug('Difference seconds = {}'.format(time_difference_seconds))\n\n    # If there are more than 700 points in the time frame, we need to group\n    # data points into 700 groups with points averaged in each group.\n    if count_points > 700:\n        # Average period between input reads\n        seconds_per_point = time_difference_seconds / count_points\n        logger.debug('Seconds per point = {}'.format(seconds_per_point))\n\n        # How many seconds to group data points in\n        group_seconds = int(time_difference_seconds / 700)\n        logger.debug('Group seconds = {}'.format(group_seconds))\n\n        try:\n            query_str = query_string(\n                unit, device_id,\n                channel=channel,\n                value='MEAN',\n                start_str=start_str,\n                end_str=end_str,\n                group_sec=group_seconds)\n\n            if query_str == 1:\n                return '', 204\n            raw_data = dbcon.query(query_str).raw\n\n            return jsonify(raw_data['series'][0]['values'])\n        except Exception as e:\n            logger.error(\"URL for 'async_data' raised and error: \"\n                         \"{err}\".format(err=e))\n            return '', 204\n    else:\n        try:\n            query_str = query_string(\n                unit, device_id,\n                channel=channel,\n                start_str=start_str,\n                end_str=end_str)\n\n            if query_str == 1:\n                return '', 204\n            raw_data = dbcon.query(query_str).raw\n\n            return jsonify(raw_data['series'][0]['values'])\n        except Exception as e:\n            logger.error(\"URL for 'async_usage' raised and error: \"\n                         \"{err}\".format(err=e))\n            return '', 204\n\n\n@blueprint.route('/output_mod/<output_id>/<channel>/<state>/<output_type>/<amount>')\n@flask_login.login_required\ndef output_mod(output_id, channel, state, output_type, amount):\n    \"\"\" Manipulate output (using non-unique ID) \"\"\"\n    if not utils_general.user_has_permission('edit_controllers'):\n        return 'Insufficient user permissions to manipulate outputs'\n\n    if is_int(channel):\n        # if an integer was returned\n        output_channel = int(channel)\n    else:\n        # if a channel ID was returned\n        channel_dev = db_retrieve_table(OutputChannel).filter(\n            OutputChannel.unique_id == channel).first()\n        if channel_dev:\n            output_channel = channel_dev.channel\n        else:\n            return \"Could not determine channel number from channel ID '{}'\".format(channel)\n\n    daemon = DaemonControl()\n    if (state in ['on', 'off'] and str_is_float(amount) and\n            (\n                (output_type in ['sec', 'pwm'] and float(amount) >= 0) or\n                output_type == 'vol' or\n                output_type == 'value'\n            )):\n        out_status = daemon.output_on_off(\n            output_id,\n            state,\n            output_type=output_type,\n            amount=float(amount),\n            output_channel=output_channel)\n        if out_status[0]:\n            return 'ERROR: {}'.format(out_status[1])\n        else:\n            return 'SUCCESS: {}'.format(out_status[1])\n    else:\n        return 'ERROR: unknown parameters: ' \\\n               'output_id: {}, channel: {}, state: {}, output_type: {}, amount: {}'.format(\n                output_id, channel, state, output_type, amount)\n\n\n@blueprint.route('/daemonactive')\n@flask_login.login_required\ndef daemon_active():\n    \"\"\"Return 'alive' if the daemon is running\"\"\"\n    try:\n        control = DaemonControl()\n        return control.daemon_status()\n    except Exception as e:\n        logger.error(\"URL for 'daemon_active' raised and error: \"\n                     \"{err}\".format(err=e))\n        return '0'\n\n\n@blueprint.route('/systemctl/<action>')\n@flask_login.login_required\ndef computer_command(action):\n    \"\"\"Execute one of several commands as root\"\"\"\n    if not utils_general.user_has_permission('edit_settings'):\n        return redirect(url_for('routes_general.home'))\n\n    try:\n        if action not in ['restart', 'shutdown', 'daemon_restart', 'frontend_reload']:\n            flash(\"Unrecognized command: {action}\".format(\n                action=action), \"success\")\n            return redirect('/settings')\n\n        if DOCKER_CONTAINER:\n            if action == 'daemon_restart':\n                control = DaemonControl()\n                control.terminate_daemon()\n                flash(gettext(\"Command to restart the daemon sent\"), \"success\")\n            elif action == 'frontend_reload':\n                subprocess.Popen('docker restart mycodo_flask 2>&1', shell=True)\n                flash(gettext(\"Command to reload the frontend sent\"), \"success\")\n        else:\n            cmd = '{path}/mycodo/scripts/mycodo_wrapper {action} 2>&1'.format(\n                    path=INSTALL_DIRECTORY, action=action)\n            subprocess.Popen(cmd, shell=True)\n\n        if action == 'restart':\n            flash(gettext(\"System rebooting in 10 seconds\"), \"success\")\n        elif action == 'shutdown':\n            flash(gettext(\"System shutting down in 10 seconds\"), \"success\")\n        elif action == 'daemon_restart':\n            flash(gettext(\"Command to restart the daemon sent\"), \"success\")\n        elif action == 'frontend_reload':\n            flash(gettext(\"Command to reload the frontend sent\"), \"success\")\n\n        return redirect('/settings')\n\n    except Exception as e:\n        logger.error(\"System command '{cmd}' raised and error: \"\n                     \"{err}\".format(cmd=action, err=e))\n        flash(\"System command '{cmd}' raised and error: \"\n              \"{err}\".format(cmd=action, err=e), \"error\")\n        return redirect(url_for('routes_general.home'))\n\n\n#\n# PID Dashboard object routes\n#\n\ndef return_point_timestamp(dev_id, unit, period, measurement=None, channel=None):\n    dbcon = InfluxDBClient(\n        INFLUXDB_HOST,\n        INFLUXDB_PORT,\n        INFLUXDB_USER,\n        INFLUXDB_PASSWORD,\n        INFLUXDB_DATABASE)\n\n    query_str = query_string(\n        unit,\n        dev_id,\n        measure=measurement,\n        channel=channel,\n        value='LAST',\n        past_sec=period)\n    if query_str == 1:\n        return [None, None]\n\n    try:\n        raw_data = dbcon.query(query_str).raw\n        number = len(raw_data['series'][0]['values'])\n        time_raw = raw_data['series'][0]['values'][number - 1][0]\n        value = raw_data['series'][0]['values'][number - 1][1]\n        value = '{:.3f}'.format(float(value))\n        # Convert date-time to epoch (potential bottleneck for data)\n        dt = date_parse(time_raw)\n        timestamp = calendar.timegm(dt.timetuple()) * 1000\n        return [timestamp, value]\n    except KeyError:\n        return [None, None]\n    except Exception:\n        return [None, None]\n\n\n@blueprint.route('/last_pid/<pid_id>/<input_period>')\n@flask_login.login_required\ndef last_data_pid(pid_id, input_period):\n    \"\"\"Return the most recent time and value from influxdb\"\"\"\n    if not str_is_float(input_period):\n        return '', 204\n\n    try:\n        pid = PID.query.filter(PID.unique_id == pid_id).first()\n\n        if len(pid.measurement.split(',')) == 2:\n            device_id = pid.measurement.split(',')[0]\n            measurement_id = pid.measurement.split(',')[1]\n        else:\n            device_id = None\n            measurement_id = None\n\n        actual_measurement = DeviceMeasurements.query.filter(\n            DeviceMeasurements.unique_id == measurement_id).first()\n        if actual_measurement:\n            actual_conversion = Conversion.query.filter(\n                Conversion.unique_id == actual_measurement.conversion_id).first()\n        else:\n            actual_conversion = None\n\n        (actual_channel,\n         actual_unit,\n         actual_measurement) = return_measurement_info(\n            actual_measurement, actual_conversion)\n\n        setpoint_unit = None\n        if pid and ',' in pid.measurement:\n            pid_measurement = pid.measurement.split(',')[1]\n            setpoint_measurement = DeviceMeasurements.query.filter(\n                DeviceMeasurements.unique_id == pid_measurement).first()\n            if setpoint_measurement:\n                conversion = Conversion.query.filter(\n                    Conversion.unique_id == setpoint_measurement.conversion_id).first()\n                _, setpoint_unit, _ = return_measurement_info(setpoint_measurement, conversion)\n\n        p_value = return_point_timestamp(\n            pid_id, 'pid_value', input_period, measurement='pid_p_value')\n        i_value = return_point_timestamp(\n            pid_id, 'pid_value', input_period, measurement='pid_i_value')\n        d_value = return_point_timestamp(\n            pid_id, 'pid_value', input_period, measurement='pid_d_value')\n        if None not in (p_value[1], i_value[1], d_value[1]):\n            pid_value = [p_value[0], '{:.3f}'.format(float(p_value[1]) + float(i_value[1]) + float(d_value[1]))]\n        else:\n            pid_value = None\n\n        setpoint_band = None\n        if pid.band:\n            try:\n                daemon = DaemonControl()\n                setpoint_band = daemon.pid_get(pid.unique_id, 'setpoint_band')\n            except:\n                logger.debug(\"Couldn't get setpoint\")\n\n        live_data = {\n            'activated': pid.is_activated,\n            'paused': pid.is_paused,\n            'held': pid.is_held,\n            'setpoint': return_point_timestamp(\n                pid_id, setpoint_unit, input_period, channel=0),\n            'setpoint_band': setpoint_band,\n            'pid_p_value': p_value,\n            'pid_i_value': i_value,\n            'pid_d_value': d_value,\n            'pid_pid_value': pid_value,\n            'duration_time': return_point_timestamp(\n                pid_id, 's', input_period, measurement='duration_time'),\n            'duty_cycle': return_point_timestamp(\n                pid_id, 'percent', input_period, measurement='duty_cycle'),\n            'actual': return_point_timestamp(\n                device_id,\n                actual_unit,\n                input_period,\n                measurement=actual_measurement,\n                channel=actual_channel)\n        }\n        return jsonify(live_data)\n    except KeyError:\n        logger.debug(\"No Data returned form influxdb\")\n        return '', 204\n    except Exception as e:\n        logger.exception(\"URL for 'last_pid' raised and error: \"\n                         \"{err}\".format(err=e))\n        return '', 204\n\n\n@blueprint.route('/pid_mod_unique_id/<unique_id>/<state>')\n@flask_login.login_required\ndef pid_mod_unique_id(unique_id, state):\n    \"\"\" Manipulate output (using unique ID) \"\"\"\n    if not utils_general.user_has_permission('edit_controllers'):\n        return 'Insufficient user permissions to manipulate PID'\n\n    pid = PID.query.filter(PID.unique_id == unique_id).first()\n\n    daemon = DaemonControl()\n    if state == 'activate_pid':\n        pid.is_activated = True\n        pid.save()\n        _, return_str = daemon.controller_activate(pid.unique_id)\n        return return_str\n    elif state == 'deactivate_pid':\n        pid.is_activated = False\n        pid.is_paused = False\n        pid.is_held = False\n        pid.save()\n        _, return_str = daemon.controller_deactivate(pid.unique_id)\n        return return_str\n    elif state == 'pause_pid':\n        pid.is_paused = True\n        pid.save()\n        if pid.is_activated:\n            return_str = daemon.pid_pause(pid.unique_id)\n        else:\n            return_str = \"PID Paused (Note: PID is not currently active)\"\n        return return_str\n    elif state == 'hold_pid':\n        pid.is_held = True\n        pid.save()\n        if pid.is_activated:\n            return_str = daemon.pid_hold(pid.unique_id)\n        else:\n            return_str = \"PID Held (Note: PID is not currently active)\"\n        return return_str\n    elif state == 'resume_pid':\n        pid.is_held = False\n        pid.is_paused = False\n        pid.save()\n        if pid.is_activated:\n            return_str = daemon.pid_resume(pid.unique_id)\n        else:\n            return_str = \"PID Resumed (Note: PID is not currently active)\"\n        return return_str\n    elif 'set_setpoint_pid' in state:\n        pid.setpoint = state.split('|')[1]\n        pid.save()\n        if pid.is_activated:\n            return_str = daemon.pid_set(pid.unique_id, 'setpoint', float(state.split('|')[1]))\n        else:\n            return_str = \"PID Setpoint changed (Note: PID is not currently active)\"\n        return return_str\n\n\n# import flask_login\n# from mycodo.mycodo_flask.api import api\n# @blueprint.route('/export_swagger')\n# @flask_login.login_required\n# def export_swagger():\n#     \"\"\"Export swagger JSON to swagger.json file\"\"\"\n#     from mycodo.mycodo_flask.utils import utils_general\n#     import json\n#     if not utils_general.user_has_permission('view_settings'):\n#         return 'You do not have permission to access this.', 401\n#     with open(\"/home/pi/swagger.json\", \"w\") as text_file:\n#         text_file.write(json.dumps(api.__schema__, indent=2))\n#     return 'success'\n"], "filenames": ["CHANGELOG.md", "mycodo/mycodo_flask/routes_general.py"], "buggy_code_start_loc": [1, 120], "buggy_code_end_loc": [9, 153], "fixing_code_start_loc": [1, 120], "fixing_code_end_loc": [13, 155], "type": "CWE-22", "message": "Mycodo is an environmental monitoring and regulation system. An exploit in versions prior to 8.12.7 allows anyone with access to endpoints to download files outside the intended directory. A patch has been applied and a release made. Users should upgrade to version 8.12.7. As a workaround, users may manually apply the changes from the fix commit.", "other": {"cve": {"id": "CVE-2021-41185", "sourceIdentifier": "security-advisories@github.com", "published": "2021-10-26T15:15:10.533", "lastModified": "2021-10-27T19:33:23.407", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Mycodo is an environmental monitoring and regulation system. An exploit in versions prior to 8.12.7 allows anyone with access to endpoints to download files outside the intended directory. A patch has been applied and a release made. Users should upgrade to version 8.12.7. As a workaround, users may manually apply the changes from the fix commit."}, {"lang": "es", "value": "Mycodo es un sistema de monitorizaci\u00f3n y regulaci\u00f3n ambiental. Una explotaci\u00f3n en versiones anteriores a 8.12.7, permite a cualquiera con acceso a los endpoints descargar archivos fuera del directorio previsto. Se ha aplicado un parche y se ha realizado un lanzamiento. Los usuarios deben actualizar a la versi\u00f3n 8.12.7. Como soluci\u00f3n, los usuarios pueden aplicar manualmente los cambios del commit de correcci\u00f3n"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mycodo_project:mycodo:*:*:*:*:*:*:*:*", "versionEndExcluding": "8.12.7", "matchCriteriaId": "C8B4BD3A-4B47-41A4-84D2-B9E703773D53"}]}]}], "references": [{"url": "https://github.com/kizniche/Mycodo/commit/23ac5dd422029c2b6ae1701a3599b6d41b66a6a9", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/kizniche/Mycodo/issues/1105", "source": "security-advisories@github.com", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/kizniche/Mycodo/releases/tag/v8.12.7", "source": "security-advisories@github.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://github.com/kizniche/Mycodo/security/advisories/GHSA-252r-94ph-m229", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/kizniche/Mycodo/commit/23ac5dd422029c2b6ae1701a3599b6d41b66a6a9"}}