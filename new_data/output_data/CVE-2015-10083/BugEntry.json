{"buggy_code": ["require 'bcrypt'\n\nclass ApplicationController < ActionController::Base\n  DEFAULT_USERNAME = \"admin\"\n  DEFAULT_PASSWORD = \"password\"\n  DEFAULT_IP_WHITELIST = \"127.0.0.1,0.0.0.0\"\n\n  before_filter :ip_whitelist\n  before_filter :basic_auth\n  protect_from_forgery\n\n  def basic_auth\n    authenticate_or_request_with_http_basic do |username, password|\n      expected_username = ENV.fetch(\"DYNOSAUR_USERNAME\", DEFAULT_USERNAME)\n      expected_password = ENV.fetch(\"DYNOSAUR_PASSWORD\", DEFAULT_PASSWORD)\n      if username != expected_username\n        puts \"Failed username\"\n        return false\n      end\n      if expected_password == password\n        @passed_auth=true\n        return true\n      else\n        begin\n          bcyrpt_password = BCrypt::Password.new(expected_password)\n          if bcyrpt_password == password\n            @passed_auth=true\n            return true\n          else\n            puts \"Failed password\"\n          end\n        rescue BCrypt::Errors::InvalidHash\n          puts \"DYNOSAUR_PASSWORD is not a valid bcrypt hash, so that's not gonna work\"\n        end\n\n      end\n      puts \"ERROR: Failed basic auth\"\n      request_http_basic_authentication\n      return false\n    end\n  end\n\n  def ip_whitelist\n    allowed_ips = ENV.fetch(\"DYNOSAUR_IP_WHITELIST\", DEFAULT_IP_WHITELIST).split(\",\")\n    ip = request.headers.fetch(\"X-Forwarded-For\", request.ip)\n    if !allowed_ips.include?(ip)\n      puts \"ERROR: Failed IP check for #{ip}\"\n      unless ENV.has_key?(\"DYNOSAUR_IP_WHITELIST\")\n        puts \"You probably need to set DYNOSAUR_IP_WHITELIST env variable\"\n      end\n      render :file => \"public/401.html\", :status => :unauthorized, layout: false\n    end\n  end\nend\n"], "fixing_code": ["require 'bcrypt'\n\nclass ApplicationController < ActionController::Base\n  DEFAULT_USERNAME = \"admin\"\n  DEFAULT_PASSWORD = \"password\"\n  DEFAULT_IP_WHITELIST = \"127.0.0.1,0.0.0.0\"\n\n  before_filter :ip_whitelist\n  before_filter :basic_auth\n  protect_from_forgery\n\n  def basic_auth\n    authenticate_or_request_with_http_basic do |username, password|\n      expected_username = ENV.fetch(\"DYNOSAUR_USERNAME\", DEFAULT_USERNAME)\n      expected_password = ENV.fetch(\"DYNOSAUR_PASSWORD\", DEFAULT_PASSWORD)\n      if username != expected_username\n        puts \"Failed username\"\n        return request_http_basic_authentication\n      end\n      if expected_password == password\n        return true\n      else\n        begin\n          bcyrpt_password = BCrypt::Password.new(expected_password)\n          if bcyrpt_password == password\n            return true\n          else\n            puts \"Failed password\"\n          end\n        rescue BCrypt::Errors::InvalidHash\n          puts \"DYNOSAUR_PASSWORD is not a valid bcrypt hash, so that's not gonna work\"\n        end\n\n      end\n      puts \"ERROR: Failed basic auth\"\n      return request_http_basic_authentication\n    end\n  end\n\n  def ip_whitelist\n    allowed_ips = ENV.fetch(\"DYNOSAUR_IP_WHITELIST\", DEFAULT_IP_WHITELIST).split(\",\")\n    ip = request.headers.fetch(\"X-Forwarded-For\", request.ip)\n    if !allowed_ips.include?(ip)\n      puts \"ERROR: Failed IP check for #{ip}\"\n      unless ENV.has_key?(\"DYNOSAUR_IP_WHITELIST\")\n        puts \"You probably need to set DYNOSAUR_IP_WHITELIST env variable\"\n      end\n      render :file => \"public/401.html\", :status => :unauthorized, layout: false\n    end\n  end\nend\n"], "filenames": ["app/controllers/application_controller.rb"], "buggy_code_start_loc": [18], "buggy_code_end_loc": [40], "fixing_code_start_loc": [18], "fixing_code_end_loc": [37], "type": "CWE-287", "message": "A vulnerability has been found in harrystech Dynosaur-Rails and classified as critical. Affected by this vulnerability is the function basic_auth of the file app/controllers/application_controller.rb. The manipulation leads to improper authentication. This product does not use versioning. This is why information about affected and unaffected releases are unavailable. The name of the patch is 04b223813f0e336aab50bff140d0f5889c31dbec. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-221503.", "other": {"cve": {"id": "CVE-2015-10083", "sourceIdentifier": "cna@vuldb.com", "published": "2023-02-21T15:15:10.527", "lastModified": "2023-03-02T16:16:47.613", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability has been found in harrystech Dynosaur-Rails and classified as critical. Affected by this vulnerability is the function basic_auth of the file app/controllers/application_controller.rb. The manipulation leads to improper authentication. This product does not use versioning. This is why information about affected and unaffected releases are unavailable. The name of the patch is 04b223813f0e336aab50bff140d0f5889c31dbec. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-221503."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 6.5, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-287"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:harrys:dynosaur-rails:*:*:*:*:*:*:*:*", "versionEndExcluding": "2015-09-15", "matchCriteriaId": "21CAF008-739D-4859-AE74-CF8B8D325311"}]}]}], "references": [{"url": "https://github.com/harrystech/dynosaur-rails/commit/04b223813f0e336aab50bff140d0f5889c31dbec", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://github.com/harrystech/dynosaur-rails/pull/11", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.221503", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Press/Media Coverage", "Third Party Advisory", "VDB Entry"]}, {"url": "https://vuldb.com/?id.221503", "source": "cna@vuldb.com", "tags": ["Third Party Advisory", "VDB Entry"]}]}, "github_commit_url": "https://github.com/harrystech/dynosaur-rails/commit/04b223813f0e336aab50bff140d0f5889c31dbec"}}