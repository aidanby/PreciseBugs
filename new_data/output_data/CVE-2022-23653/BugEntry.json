{"buggy_code": ["# Changelog\nAll notable changes to this project will be documented in this file.\n\nThe format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),\nand this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).\n\n## [Unreleased]\n\n## [3.2.0] - 2021-12-23\n\n### Added\n* Add compatibility support for arrow >= 1.0.2 on newer Python versions while\n  continuing to support Python 3.5\n\n### Fixed\n* Fallback to `ascii` decoder when printing help in case the locales are not properly set\n\n## [3.1.0] - 2021-11-02\n\n### Added\n* Add `--allCapabilities` to `create-key`\n* Add support for Python 3.10\n\n### Fixed\n* Fix testing bundle in CI for a new `staticx` version\n\n## [3.0.3] - 2021-09-27\n\n### Fixed\n* Fix pypy selector in CI\n* Fix for static linking of Linux binary (CD uses python container)\n\n## [3.0.2] - 2021-09-17\n\n### Added\n* Sign Windows binary\n\n### Changed\n* Download instruction in README.md (wording suggested by https://github.com/philh7456)\n* Make Linux binary statically linked\n\n## [3.0.1] - 2021-08-09\n\n### Fixed\n* logs from all loggers (in dependencies too) brought back\n\n## [3.0.0] - 2021-08-07\n\n### Added\n* Add possibility to change realm during integration tests\n* Add possibility to install SDK from local folder instead of pypi when running tests\n* Add full support of establishing file metadata when copying, with either source or target using SSE-C\n* Add `--noInfo` option to `copy-file-by-id`\n* Integration test for checking if `bad_bucket_id` error code is returned\n\n### Fixed\n* Fix integration tests on non-production environments\n* Fix warnings thrown by integration tests\n* delete-key unit test adjusted to a less mocked simulator\n* Fix integration test cleanup\n* Representing encryption-related metadata in buckets and file versions is now consistent\n\n### Changed\n* CLI now uses `b2sdk.v2`\n* Downloading files prints file metadata as soon as the download commences (not when it finishes)\n* New way of establishing location of the SQLite cache file, using `XDG_CONFIG_HOME` env var\n* Downloaded file's metadata is complete and is displayed before the file is downloaded, a `Download finished` message\n  is issued at the end\n* `contentLength` changed to `size` where appropriate\n* Log configuration: stack traces are not printed in case of errors by default, `--verbose` changes that \n* Log configuration arguments behaviour altered: `--logConfig` is exclusive with `--verbose` and `--debugLogs`\n* Log configuration arguments behaviour altered: `--verbose` and `--debugLogs` can be used at the same time \n  (and they will both be taken into account)\n\n### Removed\n* Support of `--metadataDirective` argument in `copy-file-by-id` (the `metadataDirective` sent to B2 cloud is\n  detected automatically)\n\n## [2.5.1] - 2021-08-06\n\n* `SRC_LAST_MODIFIED_MILLIS` import fix\n\n## [2.5.0] - 2021-05-22\n\n### Added\n* Add integration test for sync within one bucket with different encryption\n* Notarize OSX binary\n* File lock arguments and new commands\n\n### Fixed\n* Fixed breaking integration test case\n* Add zoneinfo to the Windows bundle\n* Fixed unit tests failing on new attributes of FileVersionInfo\n* Removing old buckets in integration tests\n* Bucket name entropy in tests increased\n\n## [2.4.0] - 2021-04-22\n\n### Added\n* Sign OSX binary\n* Add support for SSE-C server-side encryption mode\n\n### Fixed\n* Exclude packages inside the test package when installing\n\n## [2.3.0] - 2021-03-25\n\n### Added\n* Add support for SSE-B2 server-side encryption mode\n\n### Fixed\n* Pin `setuptools-scm<6.0` as `>=6.0` doesn't support Python 3.5\n* Fix boot speed regression caused by the `rst2ansi` invocations\n\n## [2.2.0] - 2021-03-15\n\n### Added\n* Option to automatically authorize account when running commands other than `authorize-account` via \n  `B2_APPLICATION_KEY_ID` and `B2_APPLICATION_KEY` env vars\n\n### Changed\n* Improve setup and teardown for the integration tests\n* Use `setuptools-scm` for versioning\n* Improve CLI and RTD descriptions of the commands\n* Add upper version limit for arrow dependency, because of a breaking change\n\n### Fixed\n* Fix for the Windows bundled version\n* Fix docs autogen\n\n## [2.1.0] - 2020-11-03\n\n### Added\n* Add support for Python 3.9\n* Add a possibility to append a string to the User-Agent via `B2_USER_AGENT_APPEND` env\n\n### Changed\n* Update `b2 sync` usage text for bucket-to-bucket sync\n\n### Removed\n* Drop Python 2 support :tada: (for old systems you can now use the [binary distribution](https://www.backblaze.com/b2/docs/quick_command_line.html))\n* Remove `--prefix` from `ls` (it didn't really work, use `folderName` argument)\n* Clean up legacy code (`CliBucket`, etc.)\n\n### Fixed\n* Fix docs generation in CI\n* Correct names of the arguments in `b2 create-key` usage text\n\n## [2.0.2] - 2020-07-15\n\n### Added\n* Add `--environment` internal parameter for `authorize-account`\n\n## [2.0.0] - 2020-06-25\n\n### Added\n* Add official support for python 3.8\n* Add `make-friendly-url` command\n* Add `--excludeIfModifiedAfter` parameter for `sync`\n* Add `--json` parameter to `ls` and `list-buckets`\n* Introduce bundled versions of B2 CLI for Linux, Mac OS and Windows\n\n### Changed\n* Switch to b2sdk api version v1: remove output of `delete-bucket`\n* Use b2sdk >1.1.0: add large file server-side copy\n* Switch option parser to argparse: readthedocs documentation is now generated automatically\n* Normalize output indentation level to 4 spaces\n\n### Removed\n* Remove the ability to import b2sdk classes through b2cli (please use b2sdk directly)\n* Remove official support for python 3.4\n* Remove `list-file-names` command. Use `ls --recursive --json` instead\n* Remove `list-file-versions` command. Use `ls --recursive --json --versions` instead\n\n## [1.4.2] - 2019-10-03\n\n### Added\n* Add `prefix` parameter to `list-file-names` and `list-file-versions`\n* Add support for (server-side) copy-file command\n\n### Changed\n* Make parameters of `list-file-names` and `list-file-versions` optional (use an empty string like this: `\"\"`)\n* (b2sdk) Fix sync when used with a key restricted to filename prefix\n* When authorizing with application keys, optional application key ID and \n  application key can be added using environment variables \n  B2_APPLICATION_KEY_ID and B2_APPLICATION_KEY respectively.\n\n## [1.4.0] - 2019-04-25\n\n### Added\n* (b2sdk) Support for python 3.7\n\n### Changed\n* Renaming accountId for authentication to application key Id\n    Note: this means account Id is still backwards compatible,\n    only the terminology has changed.\n* Most of the code moved to b2sdk [repository](https://github.com/Backblaze/b2-sdk-python) and [package](https://pypi.org/project/b2sdk/)\n* (b2sdk) Fix transferer crashing on empty file download attempt\n* (b2sdk) Enable retries of non-transfer operations\n* (b2sdk) Enable continuation of download operations\n\n### Deprecated\n* Deprecation warning added for imports of sdk classes from cli package\n\n## [1.3.8] - 2018-12-06\n\n### Added\n* New `--excludeAllSymlinks` option for `sync`.\n* Faster downloading of large files using multiple threads and bigger buffers.\n\n### Fixed\n* Fixed doc for cancel-all-unfinished-large-files\n\n## [1.3.6] - 2018-08-21\n\n### Fixed\n* Fix auto-reauthorize for application keys.\n* Fix problem with bash auto-completion module.\n* Fix (hopefully) markdown display in PyPI.\n\n## [1.3.4] - 2018-08-10\n\n### Fixed\n* Better documentation for authorize-account command.\n* Fix error reporting when using application keys\n* Fix auth issues with bucket-restricted application keys.\n\n## [1.3.2] - 2018-07-28\n\n### Fixed\n* Tests fixed for Python 3.7\n* Add documentation about what capabilities are required for different commands.\n* Better error messages for authorization problems with application keys.\n\n## [1.3.0] - 2018-07-20\n\n### Added\n* Support for [application keys](https://www.backblaze.com/b2/docs/application_keys.html).\n* Support for Python 3.6\n* Drop support for Python 3.3 (`setuptools` no longer supports 3.3)\n\n### Changed\n* Faster and more complete integration tests\n\n### Fixed\n* Fix content type so markdown displays properly in PyPI\n* The testing package is called `test`, not `tests`\n\n## [1.2.0] - 2018-07-06\n\n### Added\n* New `--recursive` option for ls\n* New `--showSize` option for get-bucket\n* New `--excludeDirRegex` option for sync\n\n### Fixed\n* Include LICENSE file in the source tarball. Fixes #433\n* Test suite now runs as root (fixes #427)\n* Validate file names before trying to upload\n* Fix scaling problems when syncing large numbers of files\n* Prefix Windows paths during sync to handle long paths (fixes #265)\n* Check if file to be synced is still accessible before syncing (fixes #397)\n\n## [1.1.0] - 2017-11-30\n\n### Added\n* Add support for CORS rules in `create-bucket` and `update-bucket`.  `get-bucket` will display CORS rules.\n\n### Fixed\n* cleanup in integration tests works\n\n## [1.0.0] - 2017-11-09\n\n### Added\n* Require `--allowEmptySource` to sync from empty directory, to help avoid accidental deletion of all files.\n\n## [0.7.4] - 2017-11-09\n\n### Added\n* More efficient uploads by sending SHA1 checksum at the end.\n\n### Fixed\n* File modification times are set correctly when downloading.\n* Fix an off-by-one issue when downloading a range of a file (affects library, but not CLI).\n* Better handling of some errors from the B2 service.\n\n[Unreleased]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.2.0...HEAD\n[3.1.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.1.0...v3.2.0\n[3.1.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.0.3...v3.1.0\n[3.0.3]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.0.2...v3.0.3\n[3.0.2]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.0.1...v3.0.2\n[3.0.1]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.0.0...v3.0.1\n[3.0.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.5.1...v3.0.0\n[2.5.1]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.5.0...v2.5.1\n[2.5.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.4.0...v2.5.0\n[2.4.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.3.0...v2.4.0\n[2.3.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.2.0...v2.3.0\n[2.2.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.1.0...v2.2.0\n[2.1.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.0.2...v2.1.0\n[2.0.2]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.0.0...v2.0.2\n[2.0.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.4.2...v2.0.0\n[1.4.2]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.4.0...v1.4.2\n[1.4.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.3.8...v1.4.0\n[1.3.8]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.3.6...v1.3.8\n[1.3.6]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.3.4...v1.3.6\n[1.3.4]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.3.2...v1.3.4\n[1.3.2]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.3.0...v1.3.2\n[1.3.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.2.0...v1.3.0\n[1.2.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.1.0...v1.2.0\n[1.1.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.0.0...v1.1.0\n[1.0.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v0.7.4...v1.0.0\n[0.7.4]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v0.7.2...v0.7.4\n", "arrow>=0.8.0,<1.0.0; python_version <= '3.5'\narrow>=1.0.2,<2.0.0; python_version >= '3.6'\nb2sdk>=1.14.0,<2.0.0\ndocutils==0.16\nidna>=2.2.0; platform_system == 'Java'\nimportlib-metadata>=2.1.1,<3.0.0; python_version <= '3.5'\nimportlib-metadata>=3.3.0; python_version > '3.5' and python_version < '3.8'\nphx-class-registry==3.0.5\nrst2ansi==0.1.5\n"], "fixing_code": ["# Changelog\nAll notable changes to this project will be documented in this file.\n\nThe format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),\nand this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).\n\n## [Unreleased]\n\n## [3.2.1] - 2022-02-23\n\n### Fixed\n* Fix setting permissions for local sqlite database (thanks to Jan Schejbal for responsible disclosure!)\n\n## [3.2.0] - 2021-12-23\n\n### Added\n* Add compatibility support for arrow >= 1.0.2 on newer Python versions while\n  continuing to support Python 3.5\n\n### Fixed\n* Fallback to `ascii` decoder when printing help in case the locales are not properly set\n\n## [3.1.0] - 2021-11-02\n\n### Added\n* Add `--allCapabilities` to `create-key`\n* Add support for Python 3.10\n\n### Fixed\n* Fix testing bundle in CI for a new `staticx` version\n\n## [3.0.3] - 2021-09-27\n\n### Fixed\n* Fix pypy selector in CI\n* Fix for static linking of Linux binary (CD uses python container)\n\n## [3.0.2] - 2021-09-17\n\n### Added\n* Sign Windows binary\n\n### Changed\n* Download instruction in README.md (wording suggested by https://github.com/philh7456)\n* Make Linux binary statically linked\n\n## [3.0.1] - 2021-08-09\n\n### Fixed\n* logs from all loggers (in dependencies too) brought back\n\n## [3.0.0] - 2021-08-07\n\n### Added\n* Add possibility to change realm during integration tests\n* Add possibility to install SDK from local folder instead of pypi when running tests\n* Add full support of establishing file metadata when copying, with either source or target using SSE-C\n* Add `--noInfo` option to `copy-file-by-id`\n* Integration test for checking if `bad_bucket_id` error code is returned\n\n### Fixed\n* Fix integration tests on non-production environments\n* Fix warnings thrown by integration tests\n* delete-key unit test adjusted to a less mocked simulator\n* Fix integration test cleanup\n* Representing encryption-related metadata in buckets and file versions is now consistent\n\n### Changed\n* CLI now uses `b2sdk.v2`\n* Downloading files prints file metadata as soon as the download commences (not when it finishes)\n* New way of establishing location of the SQLite cache file, using `XDG_CONFIG_HOME` env var\n* Downloaded file's metadata is complete and is displayed before the file is downloaded, a `Download finished` message\n  is issued at the end\n* `contentLength` changed to `size` where appropriate\n* Log configuration: stack traces are not printed in case of errors by default, `--verbose` changes that \n* Log configuration arguments behaviour altered: `--logConfig` is exclusive with `--verbose` and `--debugLogs`\n* Log configuration arguments behaviour altered: `--verbose` and `--debugLogs` can be used at the same time \n  (and they will both be taken into account)\n\n### Removed\n* Support of `--metadataDirective` argument in `copy-file-by-id` (the `metadataDirective` sent to B2 cloud is\n  detected automatically)\n\n## [2.5.1] - 2021-08-06\n\n* `SRC_LAST_MODIFIED_MILLIS` import fix\n\n## [2.5.0] - 2021-05-22\n\n### Added\n* Add integration test for sync within one bucket with different encryption\n* Notarize OSX binary\n* File lock arguments and new commands\n\n### Fixed\n* Fixed breaking integration test case\n* Add zoneinfo to the Windows bundle\n* Fixed unit tests failing on new attributes of FileVersionInfo\n* Removing old buckets in integration tests\n* Bucket name entropy in tests increased\n\n## [2.4.0] - 2021-04-22\n\n### Added\n* Sign OSX binary\n* Add support for SSE-C server-side encryption mode\n\n### Fixed\n* Exclude packages inside the test package when installing\n\n## [2.3.0] - 2021-03-25\n\n### Added\n* Add support for SSE-B2 server-side encryption mode\n\n### Fixed\n* Pin `setuptools-scm<6.0` as `>=6.0` doesn't support Python 3.5\n* Fix boot speed regression caused by the `rst2ansi` invocations\n\n## [2.2.0] - 2021-03-15\n\n### Added\n* Option to automatically authorize account when running commands other than `authorize-account` via \n  `B2_APPLICATION_KEY_ID` and `B2_APPLICATION_KEY` env vars\n\n### Changed\n* Improve setup and teardown for the integration tests\n* Use `setuptools-scm` for versioning\n* Improve CLI and RTD descriptions of the commands\n* Add upper version limit for arrow dependency, because of a breaking change\n\n### Fixed\n* Fix for the Windows bundled version\n* Fix docs autogen\n\n## [2.1.0] - 2020-11-03\n\n### Added\n* Add support for Python 3.9\n* Add a possibility to append a string to the User-Agent via `B2_USER_AGENT_APPEND` env\n\n### Changed\n* Update `b2 sync` usage text for bucket-to-bucket sync\n\n### Removed\n* Drop Python 2 support :tada: (for old systems you can now use the [binary distribution](https://www.backblaze.com/b2/docs/quick_command_line.html))\n* Remove `--prefix` from `ls` (it didn't really work, use `folderName` argument)\n* Clean up legacy code (`CliBucket`, etc.)\n\n### Fixed\n* Fix docs generation in CI\n* Correct names of the arguments in `b2 create-key` usage text\n\n## [2.0.2] - 2020-07-15\n\n### Added\n* Add `--environment` internal parameter for `authorize-account`\n\n## [2.0.0] - 2020-06-25\n\n### Added\n* Add official support for python 3.8\n* Add `make-friendly-url` command\n* Add `--excludeIfModifiedAfter` parameter for `sync`\n* Add `--json` parameter to `ls` and `list-buckets`\n* Introduce bundled versions of B2 CLI for Linux, Mac OS and Windows\n\n### Changed\n* Switch to b2sdk api version v1: remove output of `delete-bucket`\n* Use b2sdk >1.1.0: add large file server-side copy\n* Switch option parser to argparse: readthedocs documentation is now generated automatically\n* Normalize output indentation level to 4 spaces\n\n### Removed\n* Remove the ability to import b2sdk classes through b2cli (please use b2sdk directly)\n* Remove official support for python 3.4\n* Remove `list-file-names` command. Use `ls --recursive --json` instead\n* Remove `list-file-versions` command. Use `ls --recursive --json --versions` instead\n\n## [1.4.2] - 2019-10-03\n\n### Added\n* Add `prefix` parameter to `list-file-names` and `list-file-versions`\n* Add support for (server-side) copy-file command\n\n### Changed\n* Make parameters of `list-file-names` and `list-file-versions` optional (use an empty string like this: `\"\"`)\n* (b2sdk) Fix sync when used with a key restricted to filename prefix\n* When authorizing with application keys, optional application key ID and \n  application key can be added using environment variables \n  B2_APPLICATION_KEY_ID and B2_APPLICATION_KEY respectively.\n\n## [1.4.0] - 2019-04-25\n\n### Added\n* (b2sdk) Support for python 3.7\n\n### Changed\n* Renaming accountId for authentication to application key Id\n    Note: this means account Id is still backwards compatible,\n    only the terminology has changed.\n* Most of the code moved to b2sdk [repository](https://github.com/Backblaze/b2-sdk-python) and [package](https://pypi.org/project/b2sdk/)\n* (b2sdk) Fix transferer crashing on empty file download attempt\n* (b2sdk) Enable retries of non-transfer operations\n* (b2sdk) Enable continuation of download operations\n\n### Deprecated\n* Deprecation warning added for imports of sdk classes from cli package\n\n## [1.3.8] - 2018-12-06\n\n### Added\n* New `--excludeAllSymlinks` option for `sync`.\n* Faster downloading of large files using multiple threads and bigger buffers.\n\n### Fixed\n* Fixed doc for cancel-all-unfinished-large-files\n\n## [1.3.6] - 2018-08-21\n\n### Fixed\n* Fix auto-reauthorize for application keys.\n* Fix problem with bash auto-completion module.\n* Fix (hopefully) markdown display in PyPI.\n\n## [1.3.4] - 2018-08-10\n\n### Fixed\n* Better documentation for authorize-account command.\n* Fix error reporting when using application keys\n* Fix auth issues with bucket-restricted application keys.\n\n## [1.3.2] - 2018-07-28\n\n### Fixed\n* Tests fixed for Python 3.7\n* Add documentation about what capabilities are required for different commands.\n* Better error messages for authorization problems with application keys.\n\n## [1.3.0] - 2018-07-20\n\n### Added\n* Support for [application keys](https://www.backblaze.com/b2/docs/application_keys.html).\n* Support for Python 3.6\n* Drop support for Python 3.3 (`setuptools` no longer supports 3.3)\n\n### Changed\n* Faster and more complete integration tests\n\n### Fixed\n* Fix content type so markdown displays properly in PyPI\n* The testing package is called `test`, not `tests`\n\n## [1.2.0] - 2018-07-06\n\n### Added\n* New `--recursive` option for ls\n* New `--showSize` option for get-bucket\n* New `--excludeDirRegex` option for sync\n\n### Fixed\n* Include LICENSE file in the source tarball. Fixes #433\n* Test suite now runs as root (fixes #427)\n* Validate file names before trying to upload\n* Fix scaling problems when syncing large numbers of files\n* Prefix Windows paths during sync to handle long paths (fixes #265)\n* Check if file to be synced is still accessible before syncing (fixes #397)\n\n## [1.1.0] - 2017-11-30\n\n### Added\n* Add support for CORS rules in `create-bucket` and `update-bucket`.  `get-bucket` will display CORS rules.\n\n### Fixed\n* cleanup in integration tests works\n\n## [1.0.0] - 2017-11-09\n\n### Added\n* Require `--allowEmptySource` to sync from empty directory, to help avoid accidental deletion of all files.\n\n## [0.7.4] - 2017-11-09\n\n### Added\n* More efficient uploads by sending SHA1 checksum at the end.\n\n### Fixed\n* File modification times are set correctly when downloading.\n* Fix an off-by-one issue when downloading a range of a file (affects library, but not CLI).\n* Better handling of some errors from the B2 service.\n\n[Unreleased]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.2.1...HEAD\n[3.2.1]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.2.0...v3.2.1\n[3.2.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.1.0...v3.2.0\n[3.1.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.0.3...v3.1.0\n[3.0.3]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.0.2...v3.0.3\n[3.0.2]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.0.1...v3.0.2\n[3.0.1]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v3.0.0...v3.0.1\n[3.0.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.5.1...v3.0.0\n[2.5.1]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.5.0...v2.5.1\n[2.5.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.4.0...v2.5.0\n[2.4.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.3.0...v2.4.0\n[2.3.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.2.0...v2.3.0\n[2.2.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.1.0...v2.2.0\n[2.1.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.0.2...v2.1.0\n[2.0.2]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v2.0.0...v2.0.2\n[2.0.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.4.2...v2.0.0\n[1.4.2]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.4.0...v1.4.2\n[1.4.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.3.8...v1.4.0\n[1.3.8]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.3.6...v1.3.8\n[1.3.6]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.3.4...v1.3.6\n[1.3.4]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.3.2...v1.3.4\n[1.3.2]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.3.0...v1.3.2\n[1.3.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.2.0...v1.3.0\n[1.2.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.1.0...v1.2.0\n[1.1.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v1.0.0...v1.1.0\n[1.0.0]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v0.7.4...v1.0.0\n[0.7.4]: https://github.com/Backblaze/B2_Command_Line_Tool/compare/v0.7.2...v0.7.4\n", "arrow>=0.8.0,<1.0.0; python_version <= '3.5'\narrow>=1.0.2,<2.0.0; python_version >= '3.6'\nb2sdk>=1.14.1,<2.0.0\ndocutils==0.16\nidna>=2.2.0; platform_system == 'Java'\nimportlib-metadata>=2.1.1,<3.0.0; python_version <= '3.5'\nimportlib-metadata>=3.3.0; python_version > '3.5' and python_version < '3.8'\nphx-class-registry==3.0.5\nrst2ansi==0.1.5\n"], "filenames": ["CHANGELOG.md", "requirements.txt"], "buggy_code_start_loc": [7, 3], "buggy_code_end_loc": [289, 4], "fixing_code_start_loc": [8, 3], "fixing_code_end_loc": [295, 4], "type": "CWE-367", "message": "B2 Command Line Tool is the official command line tool for the backblaze cloud storage service. Linux and Mac releases of the B2 command-line tool version 3.2.0 and below contain a key disclosure vulnerability that, in certain conditions, can be exploited by local attackers through a time-of-check-time-of-use (TOCTOU) race condition. The command line tool saves API keys (and bucket name-to-id mapping) in a local database file (`$XDG_CONFIG_HOME/b2/account_info`, `~/.b2_account_info` or a user-defined path) when `b2 authorize-account` is first run. This happens regardless of whether a valid key is provided or not. When first created, the file is world readable and is (typically a few milliseconds) later altered to be private to the user. If the directory is readable by a local attacker and the user did not yet run `b2 authorize-account` then during the brief period between file creation and permission modification, a local attacker can race to open the file and maintain a handle to it. This allows the local attacker to read the contents after the file after the sensitive information has been saved to it. Users that have not yet run `b2 authorize-account` should upgrade to B2 Command-Line Tool v3.2.1 before running it. Users that have run `b2 authorize-account` are safe if at the time of the file creation no other local users had read access to the local configuration file. Users that have run `b2 authorize-account` where the designated path could be opened by another local user should upgrade to B2 Command-Line Tool v3.2.1 and remove the database and regenerate all application keys. Note that `b2 clear-account` does not remove the database file and it should not be used to ensure that all open handles to the file are invalidated. If B2 Command-Line Tool cannot be upgraded to v3.2.1 due to a dependency conflict, a binary release can be used instead. Alternatively a new version could be installed within a virtualenv, or the permissions can be changed to prevent local users from opening the database file.", "other": {"cve": {"id": "CVE-2022-23653", "sourceIdentifier": "security-advisories@github.com", "published": "2022-02-23T23:15:07.900", "lastModified": "2022-03-07T16:18:36.353", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "B2 Command Line Tool is the official command line tool for the backblaze cloud storage service. Linux and Mac releases of the B2 command-line tool version 3.2.0 and below contain a key disclosure vulnerability that, in certain conditions, can be exploited by local attackers through a time-of-check-time-of-use (TOCTOU) race condition. The command line tool saves API keys (and bucket name-to-id mapping) in a local database file (`$XDG_CONFIG_HOME/b2/account_info`, `~/.b2_account_info` or a user-defined path) when `b2 authorize-account` is first run. This happens regardless of whether a valid key is provided or not. When first created, the file is world readable and is (typically a few milliseconds) later altered to be private to the user. If the directory is readable by a local attacker and the user did not yet run `b2 authorize-account` then during the brief period between file creation and permission modification, a local attacker can race to open the file and maintain a handle to it. This allows the local attacker to read the contents after the file after the sensitive information has been saved to it. Users that have not yet run `b2 authorize-account` should upgrade to B2 Command-Line Tool v3.2.1 before running it. Users that have run `b2 authorize-account` are safe if at the time of the file creation no other local users had read access to the local configuration file. Users that have run `b2 authorize-account` where the designated path could be opened by another local user should upgrade to B2 Command-Line Tool v3.2.1 and remove the database and regenerate all application keys. Note that `b2 clear-account` does not remove the database file and it should not be used to ensure that all open handles to the file are invalidated. If B2 Command-Line Tool cannot be upgraded to v3.2.1 due to a dependency conflict, a binary release can be used instead. Alternatively a new version could be installed within a virtualenv, or the permissions can be changed to prevent local users from opening the database file."}, {"lang": "es", "value": "B2 Command Line Tool es la herramienta oficial de l\u00ednea de comandos para el servicio de almacenamiento en la nube de Backblaze. Las versiones para Linux y Mac de la herramienta de l\u00ednea de comandos B2, versi\u00f3n 3.2.0 y anteriores, contienen una vulnerabilidad de divulgaci\u00f3n de claves que, en determinadas condiciones, puede ser explotada por atacantes locales mediante una condici\u00f3n de carrera de tiempo de comprobaci\u00f3n de uso (TOCTOU). La herramienta de l\u00ednea de comandos guarda las claves de la API (y el mapeo de nombres de cubos a identificadores) en un archivo de base de datos local (\"$XDG_CONFIG_HOME/b2/account_info\", \"~/.b2_account_info\" o una ruta definida por el usuario) cuando es ejecutado \"b2 authorize-account\" por primera vez. Esto ocurre independientemente de si es proporcionada una clave v\u00e1lida o no. Cuando es creado por primera vez, el archivo es legible para todo el mundo y m\u00e1s tarde (normalmente unos milisegundos) es alterada para que sea privado para el usuario. Si el directorio es legible por un atacante local y el usuario a\u00fan no ha ejecutado \"b2 authorize-account\", entonces durante el breve per\u00edodo entre la creaci\u00f3n del archivo y la modificaci\u00f3n del permiso, un atacante local puede correr para abrir el archivo y mantener un manejo del mismo. Esto permite al atacante local leer el contenido despu\u00e9s del archivo una vez que la informaci\u00f3n confidencial ha sido guardada en \u00e9l. Los usuarios que a\u00fan no hayan ejecutado \"b2 authorize-account\" deber\u00edan actualizar a B2 Command Line Tool versi\u00f3n v3.2.1 antes de ejecutarla. Los usuarios que han ejecutado \"b2 authorize-account\" est\u00e1n seguros si en el momento de la creaci\u00f3n del archivo ning\u00fan otro usuario local ten\u00eda acceso de lectura al archivo de configuraci\u00f3n local. Los usuarios que hayan ejecutado \"b2 authorize-account\" cuando la ruta designada pueda ser abierta por otro usuario local deben actualizar a B2 Command-Line Tool versi\u00f3n v3.2.1 y eliminar la base de datos y regenerar todas las claves de aplicaci\u00f3n. Tenga en cuenta que \"b2 clear-account\" no elimina el archivo de la base de datos y no debe usarse para asegurar que todos los manejadores abiertos al archivo sean invalidados. Si la herramienta de l\u00ednea de comandos B2 no puede actualizarse a versi\u00f3n 3.2.1 debido a un conflicto de dependencias, puede usarse una versi\u00f3n binaria en su lugar. Tambi\u00e9n puede instalarse una nueva versi\u00f3n dentro de un virtualenv, o pueden cambiarse los permisos para evitar que usuarios locales abran el archivo de la base de datos"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:M/Au:N/C:P/I:N/A:N", "accessVector": "LOCAL", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 1.9}, "baseSeverity": "LOW", "exploitabilityScore": 3.4, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-367"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:backblaze:b2_command_line_tool:*:*:*:*:*:linux:*:*", "versionEndIncluding": "3.2.0", "matchCriteriaId": "8C0E07A2-B0E4-4CB3-8A51-52A48CA903A7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:backblaze:b2_command_line_tool:*:*:*:*:*:mac:*:*", "versionEndIncluding": "3.2.0", "matchCriteriaId": "D48B24B7-6F45-48AD-BE6D-704C7FEDAE03"}]}]}], "references": [{"url": "https://github.com/Backblaze/B2_Command_Line_Tool/commit/c74029f9f75065e8f7e3c3ec8e0a23fb8204feeb", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/Backblaze/B2_Command_Line_Tool/security/advisories/GHSA-8wr4-2wm6-w3pr", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/Backblaze/B2_Command_Line_Tool/commit/c74029f9f75065e8f7e3c3ec8e0a23fb8204feeb"}}