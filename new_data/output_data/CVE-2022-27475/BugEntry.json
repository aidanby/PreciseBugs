{"buggy_code": ["<?php\n\nclass Util\n{\n    const DB_SERVER_ERROR = \"Server error occurred. Please try again later.\";\n\n    public static function dateToday($plus)\n    {\n        $dateToday = date(\"Y-m-d\");\n        if ($plus != '0') {\n            return date('Y-m-d', strtotime($dateToday . ' + ' . $plus . ' days'));\n        }\n        return date(\"Y-m-d\");\n    }\n\n    public static function timestampNow()\n    {\n        return date(\"Y-m-d H:i:s\");\n    }\n\n    public static function displayAlertV1($msg, $type)\n    {\n        return '<div class=\"alert alert-' . $type . ' alert-dismissible fade show\" role=\"alert\">\n          ' . $msg . '\n          <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n        </div>';\n    }\n\n    public static function displayAlertV2($message, $type)\n    {\n        return '<div class=\"alert alert-' . $type . ' alert-dismissible fade show\" role=\"alert\">\n          <h4 class=\"alert-heading\">' . $message[\"heading\"] . '</h4>\n          <p>' . $message[\"content\"] . '</p><hr>\n          <p class=\"mb-0\">' . $message[\"footer\"] . '</p>\n        </div>';\n    }\n}\n"], "fixing_code": ["<?php\n\nclass Util\n{\n    const DB_SERVER_ERROR = \"Server error occurred. Please try again later.\";\n\n    public static function dateToday($plus)\n    {\n        $dateToday = date(\"Y-m-d\");\n        if ($plus != '0') {\n            return date('Y-m-d', strtotime($dateToday . ' + ' . $plus . ' days'));\n        }\n        return date(\"Y-m-d\");\n    }\n\n    public static function timestampNow()\n    {\n        return date(\"Y-m-d H:i:s\");\n    }\n\n    public static function displayAlertV1($msg, $type)\n    {\n        return '<div class=\"alert alert-' . $type . ' alert-dismissible fade show\" role=\"alert\">\n          ' . $msg . '\n          <button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">\n            <span aria-hidden=\"true\">&times;</span>\n          </button>\n        </div>';\n    }\n\n    public static function displayAlertV2($message, $type)\n    {\n        return '<div class=\"alert alert-' . $type . ' alert-dismissible fade show\" role=\"alert\">\n          <h4 class=\"alert-heading\">' . $message[\"heading\"] . '</h4>\n          <p>' . $message[\"content\"] . '</p><hr>\n          <p class=\"mb-0\">' . $message[\"footer\"] . '</p>\n        </div>';\n    }\n\n    public static function sanitize_xss($value) \n    {\n      return htmlspecialchars(strip_tags($value));\n    }\n      \n  \n}\n"], "filenames": ["app/Util.php"], "buggy_code_start_loc": [38], "buggy_code_end_loc": [38], "fixing_code_start_loc": [39], "fixing_code_end_loc": [46], "type": "CWE-79", "message": "Cross site scripting (XSS) vulnerability in tramyardg hotel-mgmt-system, allows attackers to execute arbitrary code when when /admin.php is loaded.", "other": {"cve": {"id": "CVE-2022-27475", "sourceIdentifier": "cve@mitre.org", "published": "2022-04-13T12:15:27.373", "lastModified": "2022-04-20T16:21:22.510", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross site scripting (XSS) vulnerability in tramyardg hotel-mgmt-system, allows attackers to execute arbitrary code when when /admin.php is loaded."}, {"lang": "es", "value": "Una vulnerabilidad de tipo cross site scripting (XSS) en tramyardg hotel-mgmt-system, permite a atacantes ejecutar c\u00f3digo arbitrario cuando es cargado /admin.php"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hotel_management_system_project:hotel_management_system:1.0:*:*:*:*:*:*:*", "matchCriteriaId": "8F64636D-FD66-4CE6-8BD2-F9772B65CCC9"}]}]}], "references": [{"url": "https://github.com/tramyardg/hotel-mgmt-system", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/tramyardg/hotel-mgmt-system/commit/3aa5fdd736927f4ba8d4b7efbba850a258ab42ce", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/tramyardg/hotel-mgmt-system/commit/3aa5fdd736927f4ba8d4b7efbba850a258ab42ce"}}