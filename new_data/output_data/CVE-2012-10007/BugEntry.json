{"buggy_code": ["<?php\n/*\nPlugin Name: BuddyStream\nPlugin URI: http://www.buddystream.net\nDescription: BuddyStream\nVersion: 2.6.2\nAuthor: Peter Hofman\nAuthor URI: http://www.buddystream.net\n*/\n\n// Copyright (c) 2010/2011/2012 Buddystream.net All rights reserved.\n//\n// Released under the GPL license\n// http://www.opensource.org/licenses/gpl-license.php\n//\n// This is an add-on for Buddypress\n// http://buddypress.org/\n//\n// **********************************************************************\n// This program is distributed in the hope that it will be useful, but\n// WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n// **********************************************************************\n\n/*\n * Only load code that needs BuddyPress\n * to run once BP is loaded and initialized.\n */\nfunction buddystream_init()\n{\n    global $bp;\n\n    //define plugin version and installed value\n    define('BP_BUDDYSTREAM_VERSION', '2.6.2');\n    define('BP_BUDDYSTREAM_IS_INSTALLED', 1);\n    define('BP_BUDDYSTREAM_DIR', dirname(__FILE__));\n    define('BP_BUDDYSTREAM_URL', $bp->root_domain.\"/\".str_replace(ABSPATH,\"\",dirname(__FILE__)));\n\n    //first load translations\n    buddyStreamLoadTranslations();\n\n    //initialize the database if needed\n    buddyStreamInitDatabase();\n    \n    //initialize settings if needed\n    buddyStreamInitSettings();\n    \n    //now initialize the core\n    include_once('lib/BuddyStreamCurl.php');\n    include_once('lib/BuddyStreamOAuth.php');\n    include_once('lib/BuddyStreamLog.php');\n    include_once('lib/BuddyStreamExtensions.php');\n    include_once('lib/BuddyStreamFilters.php');\n    include_once('lib/BuddyStreamSupport.php');\n    include_once('lib/BuddyStreamPageLoader.php');\n    include_once('lib/BuddyStreamCore.php');\n}\n\n/**\n * Initialise default settings\n */\nfunction buddyStreamInitSettings(){\n\n    if( ! get_site_option('buddystream_init_settings') != 'BP_BUDDYSTREAM_VERSION'){\n        \n        if(!get_site_option('buddystream_sharebox')){\n            update_site_option('buddystream_sharebox', 'on');\n        }\n        \n        if(!get_site_option('buddystream_social_albums')){\n            update_site_option('buddystream_social_albums', 'on');\n        }\n\n        if(!get_site_option('buddystream_group_sharing')){\n            update_site_option('buddystream_group_sharing', 'on');\n        }\n        \n        update_site_option('buddystream_init_settings', BP_BUDDYSTREAM_VERSION);\n    }\n\n    if( ! get_site_option('buddystream_2512')) {\n        update_site_option('buddystream_facebook_privacy_setting', 'on');\n        update_site_option('buddystream_2512', '1');\n    }\n}\n\n/**\n * Initialise database tables needed for plugin.\n */\nfunction buddyStreamInitDatabase(){\n    \n   if( ! get_site_option(\"buddystream_installed_version\")){\n\n        global $wpdb;\n        require_once(ABSPATH . 'wp-admin/includes/upgrade.php');\n\n        $buddystreamSql = \"CREATE TABLE IF NOT EXISTS \" . $wpdb->base_prefix . \"buddystream_log (\n          `id` int(11) NOT NULL auto_increment,\n          `date` timestamp NOT NULL default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,\n          `type` text NOT NULL,\n          `message` text NOT NULL,\n          PRIMARY KEY  (`id`)\n        );\";\n\n        dbDelta($buddystreamSql);\n        unset($buddystreamSql);\n\n        update_site_option(\"buddystream_installed_version\", \"1\");\n    }\n\n   if( ! get_site_option('buddystream_26')) {\n\n        global $wpdb,$bp;\n        require_once(ABSPATH . 'wp-admin/includes/upgrade.php');\n\n        $buddystreamSql = \"CREATE TABLE IF NOT EXISTS \" . $wpdb->base_prefix . \"buddystream_imports (\n          `id` int(11) NOT NULL auto_increment,\n          `item_id` varchar(255) NOT NULL,\n          PRIMARY KEY  (`id`)\n        );\";\n\n        dbDelta($buddystreamSql);\n        unset($buddystreamSql);\n\n       //now get all activity items with a secondary id adn add it to them buddystream imports table\n       $items = $wpdb->get_results(\"SELECT * FROM \".$bp->activity->table_name.\" WHERE secondary_item_id != ''\");\n\n       foreach($items as $item){\n\n           $item_id = str_replace($item->user_id.\"_\", \"\", $item->secondary_item_id);\n           $item_id = $item->user_id.\"-\".$item_id.\"-\".$item->component;\n\n           $wpdb->query($wpdb->prepare(\"INSERT INTO \".$wpdb->base_prefix.\"buddystream_imports set item_id='\".$item_id.\"'\"));\n       }\n\n       //enable the new Facebook extensions by default when Facebook extension is enabled.\n       if(get_site_option('buddystream_facebook_power') == \"on\"){\n           update_site_option('buddystream_facebookWall_power','on');\n           update_site_option('buddystream_facebookWall_setup','1');\n           update_site_option('buddystream_facebookPages_power','on');\n           update_site_option('buddystream_facebookPages_setup','1');\n           update_site_option('buddystream_facebookAlbums_power','on');\n           update_site_option('buddystream_facebookAlbums_setup','1');\n       }\n\n        update_site_option('buddystream_26', '1');\n   }\n}\n\n/*\n * Load the translation files for the plugin and extensions\n */\nfunction buddyStreamLoadTranslations() {\n    \n    if (file_exists( BP_BUDDYSTREAM_DIR.\"/languages/buddystream-\" . get_locale() . \".mo\")) {\n        load_textdomain('buddystream_lang', BP_BUDDYSTREAM_DIR.\"/languages/buddystream-\" . get_locale().\".mo\");\n    }else{\n        load_textdomain('buddystream_lang', BP_BUDDYSTREAM_DIR.\"/languages/buddystream-en_US.mo\");\n    }\n\n    $handle = opendir(dirname(__FILE__).\"/extensions\");\n    if ($handle) {\n        while (false !== ($file = readdir($handle))) {\n            if ($file != \".\" && $file != \"..\" && $file != \".DS_Store\") {\n                if (file_exists(BP_BUDDYSTREAM_DIR.\"/extensions/\".$file.\"/languages/buddystream_\".$file.\"-\".get_locale().\".mo\")) {\n                    load_textdomain('buddystream_' . $file, BP_BUDDYSTREAM_DIR.\"/extensions/\".$file.\"/languages/buddystream_\".$file.\"-\".get_locale().\".mo\");\n                }else{\n                    load_textdomain('buddystream_' . $file, BP_BUDDYSTREAM_DIR.\"/extensions/\".$file.\"/languages/buddystream_\".$file.\"-en_US.mo\");\n                }\n            }\n        }\n    }\n}\n\nadd_action('bp_init', 'buddystream_init', 4);\n\n/**\n * Add the BuddyStream Connect Widget\n */\nadd_action('widgets_init', 'buddystream_connect_widget');\n\nfunction buddystream_connect_widget() {\n    include_once('lib/BuddyStreamWidgets.php');\n    register_widget('BuddyStream_Connect_Widget');\n}", "\n<div class=\"buddystream_sharebox_box\">\n<h3>ShareBox</h3>\n<br/>\n\n<blockquote>\n    <h4><i>\"<?php echo $_GET['content']; ?>\"</i></h4>\n</blockquote>\n<br/>\n\n<?php\n\n$content   = $_GET['content'];\n$link      = $_GET['link'];\n$arrShares = explode(',', $_GET['shares']);\n\nforeach($arrShares as $share){\n\n    if($share == 'facebook'){\n        echo '<a href=\"http://www.facebook.com/share.php?u=' . urlencode($link) . '&t=' . urlencode($content) . '\" class=\"buddystream_sharebutton facebook\">Facebook share</a> ';\n        echo '<iframe src=\"http://www.facebook.com/plugins/like.php?href='.$link.'&amp;&amp;action=like\" scrolling=\"no\" frameborder=\"0\" allowTransparency=\"true\" style=\"border:none; overflow:hidden; margin:0px; padding:0px; height:20px\"></iframe> ';\n    }\n\n    if($share == 'twitter'){\n        echo '<a href=\"http://twitter.com/home?status=' . urlencode($content) . ' ' . urlencode($link) . '\" class=\"buddystream_sharebutton twitter\">Share on Twitter</a> ';\n    }\n\n    if($share == 'linkedin'){\n        echo '<script src=\"http://platform.linkedin.com/in.js\" type=\"text/javascript\"></script><script type=\"IN/Share\" data-url=\"'.$link.'\"></script> ';\n    }\n\n    if($share == 'googleplus'){\n        echo '<script type=\"text/javascript\" src=\"https://apis.google.com/js/plusone.js\"></script>\n        <g:plusone size=\"medium\" annotation=\"none\" href=\"'.$url.'\"></g:plusone>\n        <meta itemprop=\"description\" content=\"'.$content.'\">';\n    }\n}\n    \n?>\n</div>", "=== BuddyStream===\nContributors: Blackphantom\nTags: Buddypress, Twitter, Facebook, Flickr, Tweetstream, Facestream, Google+, Soundcloud, Rss, Last.fm, Vimeo, LinkedIn, Buddystream, Apollo\nRequires at least: WP 2.9.1, BuddyPress 1.2.3\nTested up to: WP 3.4.1, BuddyPress 1.6.1\nStable tag: 2.6.2\n\n== Released under the GPL license ==\nhttp://www.opensource.org/licenses/gpl-license.php\n\n== Description ==\nBuddyStream is a BuddyPress plugin that will synchronize all of your favorite Social Networks to the BuddyPress activity stream.\n\nThe plugin is easy to set-up, operate, and for your members to use.\nEach Social Network has its own admin panel where you can see which users are using the network, view cool statistics, and manage the advanced filtering settings.\n\nNetworks that the free plugin currently supports:\n- Twitter\n- Flickr\n- Youtube\n- Last.fm\n\nRequirements.\n- PHP 5.2.1+\n- CURL\n- JSON\n- CRONJOB access\n\nYou may find FREE translations on: http://www.buddystream.net.\nFor support and other feature request, please contact us on our website.\n\n== Installation ==\n1. Upload this plugin to your `/wp-content/plugins/` directory.\n2. Activate the plugin through the 'Plugins' menu in WordPress.\n3. Setup the BuddyStream plugin in the admin sidebar.\n4. Done!\n\n== Screenshots ==\n\n== ChangeLog ==\n\n= 2.6.2 =\n* Improved check for sending out to networks (now no longer conflicts with plugins like activity hashtags)\n* Small CSS fix for BuddyPress 1.6 support.\n* Fixed stylesheet loading issues\n* Removed highcharts graph script, alternative will be implemented in 3.0\n\n= 2.6.1 =\n* Fixed power switches in network setting pages.\n* Fixed new cronjob url.\n* Fixed incorrect path loading for import.\n\n= 2.6 =\n* Fixed consistent typo in extensions.\n* Fixed fatal error due class loading.\n* Fixed typo in support link.\n* Fixed correct url to support site.\n* Fixed Soundcloud imports (you users need to re-authenticate)\n\n* Added Facebook Wall extension.\n* Added Facebook Pages extension.\n* Added Facebook Albums extension.\n* Added new language files for new Facebook extensions.\n* Added better way for loading plugins files.\n\n* Improved content exist check.\n* Improved loading of core functionality in imports.\n\n* Removed Google+ javascript due non usage.\n* Removed all secondary_id checks and replaced with own.\n* Removed activity delete filter since we now use own table for imports\n\n= 2.5.13 =\n* Improved cron command line (please update your current cron)\n* Fixed link to members page (gave 404 when different then default)\n* Fixed Youtube imports\n* Fixed network settings link showing up in widget even when network is powered off.\n* Fixed disable Facebook imports completely.\n* Fixed disable Twitter imports completely.\n* Fixed disable LinkedIn imports completely.\n* Fixed members directory showing tags ex: #facebook...\n* Fixed update always pushed to wall and page even when only page was chosen.\n\n= 2.5.12 =\n* Removed update check so plugin wont be downgraded.\n* Extended cron with network parameter so multiple crons are possible (add network=THENETWORK) to the cronjob url.\n* Prepared core for accepting extensions with parents (to extend other extensions).\n* Added check to see if extension exists.\n* By default import also items that are rated \"friend only\" can be turned of in the settings.\n\n= 2.5.11 =\n* Fixed php opening tags.\n* Fixed error when user does not have Facebook pages.\n\n= 2.5.10 =\n* Added general option to turn off all css including of BuddyStream (for complete own css styling)\n* ColorBox javascript now only loaded if function does not exist.\n* Updated the tour, now includes general settings tab.\n* Fixed ShareBox not opening in popup.\n* Fixed javascript conflict in wp-admin.\n* Fixed javascript undefined variables.\n* Fixed RSS filter.\n* Fixed RSS stats page.\n* Fixed Facebook privacy settings now working.\n* Fixed Facebook imports.\n* Fixed buttons in interface for Internet Explorer\n\n= 2.5.09 =\n* Removed dashboard widget.\n* Refactored the filters they are now stable.\n* Added css classes to widget for custom styling.\n* Fixed cron service license check.\n* Import counters calculations are now correct.\n* Colorbox integration improvement.\n\n= 2.5.08 =\n* Removed usage of simpleXml load from file for several imports.\n* Fixed dashboard javascript errors.\n* Fixed Flickr not importing photos with no titles\n* Fixed issue with imports not importing all items due failure secondary_item_id check (now made unique per user).\n* Fixed post to Facebook page(s) button shown when user did revoked authorization.\n* Added configurable widget to get your users connecting there social accounts faster.\n\n= 2.5.07 =\n* Fixed Facebook video imports.\n* Added core functionality to check existing content.\n* Removed since => till filter so all items get imported from Facebook.\n\n= 2.5.06 =\n* Fixed imports not working due configuration error.\n\n= 2.5.05 = \n* Added Facebook pages select on user settings (user can now choose which pages to sync.)\n* Added Facebook albums select on user settings (user can now choose which albums to sync.)\n* Added check so non-public items won't be imported anymore. (privacy)\n* Fixed Social albums not hiding when albums feature is turned off.\n\n= 2.5.04 =\n* Fixed LinkedIn import due change LinkedIn API.\n* Fixed Google+ import.\n* Fixed general settings page nog saving\n* Added turn all on/off buttons on general settings page.\n* Added feature to move social albums under profile navigation instead of top-level.\n\n= 2.5.03 =\n* Fixed loading issue with .DS_Store file.\n* Fixed version tab error.\n* Fixed Facebook imports.\n* Fixed Twitter username cut-off in items (fix, works only for new items).\n\n= 2.5.02 =\n* Added general setting page to turn on/off some features.\n* Added extra check to make sure a activity item is not empty.\n* Improved ShareBox loading and showing.\n\n* Fixed Twitter usernames in backend.\n* Fixed Facebook importing items from friends.\n* Fixed Vimeo, Twitter, Facebook import\n* Fixed filters\n* Fixed loading of the ShareBox\n\n= 2.5.01 =\n* Fixed double declared class in certain cases.\n* Fixed soundcloud set-up description\n\n= 2.5 =\n* Added Vimeo imports.\n* Added Google+ imports.\n* Added quickstats widget for admin dashboard.\n* Added tour option for WordPress 3.3 and higher.\n* Added new share buttons and counters.\n* Added more core functionality.\n* Added Facebook pages sync.\n* Added social albums, one page to see all album (cleaner menu's)\n* Added social network settings page, one page for all network settings (cleaner menu's)\n* Added admin notices when networks are turned on but not yet configured.\n* Added buttons to turn all networks on/off with one button.\n* Added Sharebox (one pop up box for sharing activity items)\n\n* Fixed problems with max item imports.\n* Fixed problems with filters.\n* Fixed user album pages.\n* Fixed counters (now not counting the added hashtags of BuddyStream)\n\n* Removed separate share buttons (replaced by sharebox) \n* Removed Zend Framework and made it really lightweight.\n* Cleaned up activity items styling.\n* Ported all networks to new OAuth library.\n* Changed the user setting pages for better usability.\n* Improved admin css.\n* Replaced lightbox library.\n\n* And more we can't remember."], "fixing_code": ["<?php\n/*\nPlugin Name: BuddyStream\nPlugin URI: http://www.buddystream.net\nDescription: BuddyStream\nVersion: 2.6.3\nAuthor: Peter Hofman\nAuthor URI: http://www.buddystream.net\n*/\n\n// Copyright (c) 2010/2011/2012 Buddystream.net All rights reserved.\n//\n// Released under the GPL license\n// http://www.opensource.org/licenses/gpl-license.php\n//\n// This is an add-on for Buddypress\n// http://buddypress.org/\n//\n// **********************************************************************\n// This program is distributed in the hope that it will be useful, but\n// WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n// **********************************************************************\n\n/*\n * Only load code that needs BuddyPress\n * to run once BP is loaded and initialized.\n */\nfunction buddystream_init()\n{\n    global $bp;\n\n    //define plugin version and installed value\n    define('BP_BUDDYSTREAM_VERSION', '2.6.3');\n    define('BP_BUDDYSTREAM_IS_INSTALLED', 1);\n    define('BP_BUDDYSTREAM_DIR', dirname(__FILE__));\n    define('BP_BUDDYSTREAM_URL', $bp->root_domain.\"/\".str_replace(ABSPATH,\"\",dirname(__FILE__)));\n\n    //first load translations\n    buddyStreamLoadTranslations();\n\n    //initialize the database if needed\n    buddyStreamInitDatabase();\n    \n    //initialize settings if needed\n    buddyStreamInitSettings();\n    \n    //now initialize the core\n    include_once('lib/BuddyStreamCurl.php');\n    include_once('lib/BuddyStreamOAuth.php');\n    include_once('lib/BuddyStreamLog.php');\n    include_once('lib/BuddyStreamExtensions.php');\n    include_once('lib/BuddyStreamFilters.php');\n    include_once('lib/BuddyStreamSupport.php');\n    include_once('lib/BuddyStreamPageLoader.php');\n    include_once('lib/BuddyStreamCore.php');\n}\n\n/**\n * Initialise default settings\n */\nfunction buddyStreamInitSettings(){\n\n    if( ! get_site_option('buddystream_init_settings') != 'BP_BUDDYSTREAM_VERSION'){\n        \n        if(!get_site_option('buddystream_sharebox')){\n            update_site_option('buddystream_sharebox', 'on');\n        }\n        \n        if(!get_site_option('buddystream_social_albums')){\n            update_site_option('buddystream_social_albums', 'on');\n        }\n\n        if(!get_site_option('buddystream_group_sharing')){\n            update_site_option('buddystream_group_sharing', 'on');\n        }\n        \n        update_site_option('buddystream_init_settings', BP_BUDDYSTREAM_VERSION);\n    }\n\n    if( ! get_site_option('buddystream_2512')) {\n        update_site_option('buddystream_facebook_privacy_setting', 'on');\n        update_site_option('buddystream_2512', '1');\n    }\n}\n\n/**\n * Initialise database tables needed for plugin.\n */\nfunction buddyStreamInitDatabase(){\n    \n   if( ! get_site_option(\"buddystream_installed_version\")){\n\n        global $wpdb;\n        require_once(ABSPATH . 'wp-admin/includes/upgrade.php');\n\n        $buddystreamSql = \"CREATE TABLE IF NOT EXISTS \" . $wpdb->base_prefix . \"buddystream_log (\n          `id` int(11) NOT NULL auto_increment,\n          `date` timestamp NOT NULL default CURRENT_TIMESTAMP on update CURRENT_TIMESTAMP,\n          `type` text NOT NULL,\n          `message` text NOT NULL,\n          PRIMARY KEY  (`id`)\n        );\";\n\n        dbDelta($buddystreamSql);\n        unset($buddystreamSql);\n\n        update_site_option(\"buddystream_installed_version\", \"1\");\n    }\n\n   if( ! get_site_option('buddystream_26')) {\n\n        global $wpdb,$bp;\n        require_once(ABSPATH . 'wp-admin/includes/upgrade.php');\n\n        $buddystreamSql = \"CREATE TABLE IF NOT EXISTS \" . $wpdb->base_prefix . \"buddystream_imports (\n          `id` int(11) NOT NULL auto_increment,\n          `item_id` varchar(255) NOT NULL,\n          PRIMARY KEY  (`id`)\n        );\";\n\n        dbDelta($buddystreamSql);\n        unset($buddystreamSql);\n\n       //now get all activity items with a secondary id adn add it to them buddystream imports table\n       $items = $wpdb->get_results(\"SELECT * FROM \".$bp->activity->table_name.\" WHERE secondary_item_id != ''\");\n\n       foreach($items as $item){\n\n           $item_id = str_replace($item->user_id.\"_\", \"\", $item->secondary_item_id);\n           $item_id = $item->user_id.\"-\".$item_id.\"-\".$item->component;\n\n           $wpdb->query($wpdb->prepare(\"INSERT INTO \".$wpdb->base_prefix.\"buddystream_imports set item_id='\".$item_id.\"'\"));\n       }\n\n       //enable the new Facebook extensions by default when Facebook extension is enabled.\n       if(get_site_option('buddystream_facebook_power') == \"on\"){\n           update_site_option('buddystream_facebookWall_power','on');\n           update_site_option('buddystream_facebookWall_setup','1');\n           update_site_option('buddystream_facebookPages_power','on');\n           update_site_option('buddystream_facebookPages_setup','1');\n           update_site_option('buddystream_facebookAlbums_power','on');\n           update_site_option('buddystream_facebookAlbums_setup','1');\n       }\n\n        update_site_option('buddystream_26', '1');\n   }\n}\n\n/*\n * Load the translation files for the plugin and extensions\n */\nfunction buddyStreamLoadTranslations() {\n    \n    if (file_exists( BP_BUDDYSTREAM_DIR.\"/languages/buddystream-\" . get_locale() . \".mo\")) {\n        load_textdomain('buddystream_lang', BP_BUDDYSTREAM_DIR.\"/languages/buddystream-\" . get_locale().\".mo\");\n    }else{\n        load_textdomain('buddystream_lang', BP_BUDDYSTREAM_DIR.\"/languages/buddystream-en_US.mo\");\n    }\n\n    $handle = opendir(dirname(__FILE__).\"/extensions\");\n    if ($handle) {\n        while (false !== ($file = readdir($handle))) {\n            if ($file != \".\" && $file != \"..\" && $file != \".DS_Store\") {\n                if (file_exists(BP_BUDDYSTREAM_DIR.\"/extensions/\".$file.\"/languages/buddystream_\".$file.\"-\".get_locale().\".mo\")) {\n                    load_textdomain('buddystream_' . $file, BP_BUDDYSTREAM_DIR.\"/extensions/\".$file.\"/languages/buddystream_\".$file.\"-\".get_locale().\".mo\");\n                }else{\n                    load_textdomain('buddystream_' . $file, BP_BUDDYSTREAM_DIR.\"/extensions/\".$file.\"/languages/buddystream_\".$file.\"-en_US.mo\");\n                }\n            }\n        }\n    }\n}\n\nadd_action('bp_init', 'buddystream_init', 4);\n\n/**\n * Add the BuddyStream Connect Widget\n */\nadd_action('widgets_init', 'buddystream_connect_widget');\n\nfunction buddystream_connect_widget() {\n    include_once('lib/BuddyStreamWidgets.php');\n    register_widget('BuddyStream_Connect_Widget');\n}", "\n<div class=\"buddystream_sharebox_box\">\n<h3>ShareBox</h3>\n<br/>\n\n<blockquote>\n    <h4><i>\"<?php echo esc_attr($_GET['content']); ?>\"</i></h4>\n</blockquote>\n<br/>\n\n<?php\n\n$content   = esc_attr($_GET['content']);\n$link      = esc_attr($_GET['link']);\n$arrShares = explode(',', esc_attr($_GET['shares']));\n\nforeach($arrShares as $share){\n\n    if($share == 'facebook'){\n        echo '<a href=\"http://www.facebook.com/share.php?u=' . urlencode($link) . '&t=' . urlencode($content) . '\" class=\"buddystream_sharebutton facebook\">Facebook share</a> ';\n        echo '<iframe src=\"http://www.facebook.com/plugins/like.php?href='.$link.'&amp;&amp;action=like\" scrolling=\"no\" frameborder=\"0\" allowTransparency=\"true\" style=\"border:none; overflow:hidden; margin:0px; padding:0px; height:20px\"></iframe> ';\n    }\n\n    if($share == 'twitter'){\n        echo '<a href=\"http://twitter.com/home?status=' . urlencode($content) . ' ' . urlencode($link) . '\" class=\"buddystream_sharebutton twitter\">Share on Twitter</a> ';\n    }\n\n    if($share == 'linkedin'){\n        echo '<script src=\"http://platform.linkedin.com/in.js\" type=\"text/javascript\"></script><script type=\"IN/Share\" data-url=\"'.urlencode($link).'\"></script> ';\n    }\n\n    if($share == 'googleplus'){\n        echo '<script type=\"text/javascript\" src=\"https://apis.google.com/js/plusone.js\"></script>\n        <g:plusone size=\"medium\" annotation=\"none\" href=\"'.$url.'\"></g:plusone>\n        <meta itemprop=\"description\" content=\"'.$content.'\">';\n    }\n}\n    \n?>\n</div>", "=== BuddyStream===\nContributors: Blackphantom\nTags: Buddypress, Twitter, Facebook, Flickr, Tweetstream, Facestream, Google+, Soundcloud, Rss, Last.fm, Vimeo, LinkedIn, Buddystream, Apollo\nRequires at least: WP 2.9.1, BuddyPress 1.2.3\nTested up to: WP 3.4.2, BuddyPress 1.6.1\nStable tag: 2.6.3\n\n== Released under the GPL license ==\nhttp://www.opensource.org/licenses/gpl-license.php\n\n== Description ==\nBuddyStream is a BuddyPress plugin that will synchronize all of your favorite Social Networks to the BuddyPress activity stream.\n\nThe plugin is easy to set-up, operate, and for your members to use.\nEach Social Network has its own admin panel where you can see which users are using the network, view cool statistics, and manage the advanced filtering settings.\n\nNetworks that the free plugin currently supports:\n- Twitter\n- Flickr\n- Youtube\n- Last.fm\n\nRequirements.\n- PHP 5.2.1+\n- CURL\n- JSON\n- CRONJOB access\n\nYou may find FREE translations on: http://www.buddystream.net.\nFor support and other feature request, please contact us on our website.\n\n== Installation ==\n1. Upload this plugin to your `/wp-content/plugins/` directory.\n2. Activate the plugin through the 'Plugins' menu in WordPress.\n3. Setup the BuddyStream plugin in the admin sidebar.\n4. Done!\n\n== Screenshots ==\n\n== ChangeLog ==\n\n= 2.6.3 =\n* Fixed vulnerability in the ShareBox\n\n= 2.6.2 =\n* Improved check for sending out to networks (now no longer conflicts with plugins like activity hashtags)\n* Small CSS fix for BuddyPress 1.6 support.\n* Fixed stylesheet loading issues\n* Removed highcharts graph script, alternative will be implemented in 3.0\n\n= 2.6.1 =\n* Fixed power switches in network setting pages.\n* Fixed new cronjob url.\n* Fixed incorrect path loading for import.\n\n= 2.6 =\n* Fixed consistent typo in extensions.\n* Fixed fatal error due class loading.\n* Fixed typo in support link.\n* Fixed correct url to support site.\n* Fixed Soundcloud imports (you users need to re-authenticate)\n\n* Added Facebook Wall extension.\n* Added Facebook Pages extension.\n* Added Facebook Albums extension.\n* Added new language files for new Facebook extensions.\n* Added better way for loading plugins files.\n\n* Improved content exist check.\n* Improved loading of core functionality in imports.\n\n* Removed Google+ javascript due non usage.\n* Removed all secondary_id checks and replaced with own.\n* Removed activity delete filter since we now use own table for imports\n\n= 2.5.13 =\n* Improved cron command line (please update your current cron)\n* Fixed link to members page (gave 404 when different then default)\n* Fixed Youtube imports\n* Fixed network settings link showing up in widget even when network is powered off.\n* Fixed disable Facebook imports completely.\n* Fixed disable Twitter imports completely.\n* Fixed disable LinkedIn imports completely.\n* Fixed members directory showing tags ex: #facebook...\n* Fixed update always pushed to wall and page even when only page was chosen.\n\n= 2.5.12 =\n* Removed update check so plugin wont be downgraded.\n* Extended cron with network parameter so multiple crons are possible (add network=THENETWORK) to the cronjob url.\n* Prepared core for accepting extensions with parents (to extend other extensions).\n* Added check to see if extension exists.\n* By default import also items that are rated \"friend only\" can be turned of in the settings.\n\n= 2.5.11 =\n* Fixed php opening tags.\n* Fixed error when user does not have Facebook pages.\n\n= 2.5.10 =\n* Added general option to turn off all css including of BuddyStream (for complete own css styling)\n* ColorBox javascript now only loaded if function does not exist.\n* Updated the tour, now includes general settings tab.\n* Fixed ShareBox not opening in popup.\n* Fixed javascript conflict in wp-admin.\n* Fixed javascript undefined variables.\n* Fixed RSS filter.\n* Fixed RSS stats page.\n* Fixed Facebook privacy settings now working.\n* Fixed Facebook imports.\n* Fixed buttons in interface for Internet Explorer\n\n= 2.5.09 =\n* Removed dashboard widget.\n* Refactored the filters they are now stable.\n* Added css classes to widget for custom styling.\n* Fixed cron service license check.\n* Import counters calculations are now correct.\n* Colorbox integration improvement.\n\n= 2.5.08 =\n* Removed usage of simpleXml load from file for several imports.\n* Fixed dashboard javascript errors.\n* Fixed Flickr not importing photos with no titles\n* Fixed issue with imports not importing all items due failure secondary_item_id check (now made unique per user).\n* Fixed post to Facebook page(s) button shown when user did revoked authorization.\n* Added configurable widget to get your users connecting there social accounts faster.\n\n= 2.5.07 =\n* Fixed Facebook video imports.\n* Added core functionality to check existing content.\n* Removed since => till filter so all items get imported from Facebook.\n\n= 2.5.06 =\n* Fixed imports not working due configuration error.\n\n= 2.5.05 = \n* Added Facebook pages select on user settings (user can now choose which pages to sync.)\n* Added Facebook albums select on user settings (user can now choose which albums to sync.)\n* Added check so non-public items won't be imported anymore. (privacy)\n* Fixed Social albums not hiding when albums feature is turned off.\n\n= 2.5.04 =\n* Fixed LinkedIn import due change LinkedIn API.\n* Fixed Google+ import.\n* Fixed general settings page nog saving\n* Added turn all on/off buttons on general settings page.\n* Added feature to move social albums under profile navigation instead of top-level.\n\n= 2.5.03 =\n* Fixed loading issue with .DS_Store file.\n* Fixed version tab error.\n* Fixed Facebook imports.\n* Fixed Twitter username cut-off in items (fix, works only for new items).\n\n= 2.5.02 =\n* Added general setting page to turn on/off some features.\n* Added extra check to make sure a activity item is not empty.\n* Improved ShareBox loading and showing.\n\n* Fixed Twitter usernames in backend.\n* Fixed Facebook importing items from friends.\n* Fixed Vimeo, Twitter, Facebook import\n* Fixed filters\n* Fixed loading of the ShareBox\n\n= 2.5.01 =\n* Fixed double declared class in certain cases.\n* Fixed soundcloud set-up description\n\n= 2.5 =\n* Added Vimeo imports.\n* Added Google+ imports.\n* Added quickstats widget for admin dashboard.\n* Added tour option for WordPress 3.3 and higher.\n* Added new share buttons and counters.\n* Added more core functionality.\n* Added Facebook pages sync.\n* Added social albums, one page to see all album (cleaner menu's)\n* Added social network settings page, one page for all network settings (cleaner menu's)\n* Added admin notices when networks are turned on but not yet configured.\n* Added buttons to turn all networks on/off with one button.\n* Added Sharebox (one pop up box for sharing activity items)\n\n* Fixed problems with max item imports.\n* Fixed problems with filters.\n* Fixed user album pages.\n* Fixed counters (now not counting the added hashtags of BuddyStream)\n\n* Removed separate share buttons (replaced by sharebox) \n* Removed Zend Framework and made it really lightweight.\n* Cleaned up activity items styling.\n* Ported all networks to new OAuth library.\n* Changed the user setting pages for better usability.\n* Improved admin css.\n* Replaced lightbox library.\n\n* And more we can't remember."], "filenames": ["buddystream.php", "extensions/default/templates/ShareBox.php", "readme.txt"], "buggy_code_start_loc": [6, 7, 5], "buggy_code_end_loc": [35, 30, 40], "fixing_code_start_loc": [6, 7, 5], "fixing_code_end_loc": [35, 30, 44], "type": "CWE-79", "message": "A vulnerability was found in madgicweb BuddyStream Plugin up to 3.2.7. It has been declared as problematic. Affected by this vulnerability is an unknown functionality of the file ShareBox.php. The manipulation of the argument content/link/shares leads to cross site scripting. The attack can be launched remotely. Upgrading to version 3.2.8 is able to address this issue. The name of the patch is 7d5b9a89a27711aad76fd55ab4cc4185b545a1d0. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-221479.", "other": {"cve": {"id": "CVE-2012-10007", "sourceIdentifier": "cna@vuldb.com", "published": "2023-02-19T16:15:16.357", "lastModified": "2023-02-28T20:25:44.497", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in madgicweb BuddyStream Plugin up to 3.2.7. It has been declared as problematic. Affected by this vulnerability is an unknown functionality of the file ShareBox.php. The manipulation of the argument content/link/shares leads to cross site scripting. The attack can be launched remotely. Upgrading to version 3.2.8 is able to address this issue. The name of the patch is 7d5b9a89a27711aad76fd55ab4cc4185b545a1d0. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-221479."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:buddystream_project:buddystream:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.2.8", "matchCriteriaId": "078F48C9-FFE9-4F71-80BA-AF14C25788FD"}]}]}], "references": [{"url": "https://github.com/madgicweb/buddystream/commit/7d5b9a89a27711aad76fd55ab4cc4185b545a1d0", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://github.com/madgicweb/buddystream/releases/tag/3.2.8", "source": "cna@vuldb.com", "tags": ["Release Notes"]}, {"url": "https://vuldb.com/?ctiid.221479", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.221479", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/madgicweb/buddystream/commit/7d5b9a89a27711aad76fd55ab4cc4185b545a1d0"}}