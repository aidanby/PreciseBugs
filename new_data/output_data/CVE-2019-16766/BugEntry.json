{"buggy_code": ["1.2.0 (2019-10-30)\n==================\n - Added missing deps for generation of the docs\n - Added Microsoft Authenticator as example app and removed double space\n - Allow admins to delete devices from user accounts\n\n\n1.1.0 (2019-03-28)\n==================\n - Require the user to enter their password when creating a new token. This is\n   done based on feedback of a security test by an external company.\n - Remove the \"Manage 2FA button\" on the user listing for now since that didn't\n   actually work. It always managed the devices of the current logged in user.\n   This will be added properly in a later version.\n - Make the package compatible with django-hosts. The middleware initially\n   resolved a number of paths on start up time, this is now lazy.\n - Update django-otp to version 5.2.0\n - Update qrcode to version 6.1\n\n\n1.0.1 (2019-01-18)\n==================\n - Add Dutch translations (#9)\n - Add support for Wagtail running in a subdirectory (#10)\n - Add WAGTAIL_2FA_OTP_TOTP_NAME for easier identification the site (#11)\n - Update badges in README file (GitHub organisation rename)\n\n\n0.1.0 (2018-05-26)\n==================\n - Require atleast Wagtail 2.1 for the new account management hooks\n - Add information about how to add a device\n - Added several unittests\n\n\n0.0.1 (unreleased)\n==================\n - Created package\n"], "fixing_code": ["1.3.0 (2019.11.26)\n==================\n - Add OtpRequiredMixin to enforce OTP checks in views\n - Resolve possible vulnerabilities:\n    - [CWE-290](http://cwe.mitre.org/data/definitions/290.html)\n    - [CWE-20](http://cwe.mitre.org/data/definitions/20.html)\n\n\n1.2.0 (2019-10-30)\n==================\n - Added missing deps for generation of the docs\n - Added Microsoft Authenticator as example app and removed double space\n - Allow admins to delete devices from user accounts\n\n\n1.1.0 (2019-03-28)\n==================\n - Require the user to enter their password when creating a new token. This is\n   done based on feedback of a security test by an external company.\n - Remove the \"Manage 2FA button\" on the user listing for now since that didn't\n   actually work. It always managed the devices of the current logged in user.\n   This will be added properly in a later version.\n - Make the package compatible with django-hosts. The middleware initially\n   resolved a number of paths on start up time, this is now lazy.\n - Update django-otp to version 5.2.0\n - Update qrcode to version 6.1\n\n\n1.0.1 (2019-01-18)\n==================\n - Add Dutch translations (#9)\n - Add support for Wagtail running in a subdirectory (#10)\n - Add WAGTAIL_2FA_OTP_TOTP_NAME for easier identification the site (#11)\n - Update badges in README file (GitHub organisation rename)\n\n\n0.1.0 (2018-05-26)\n==================\n - Require atleast Wagtail 2.1 for the new account management hooks\n - Add information about how to add a device\n - Added several unittests\n\n\n0.0.1 (unreleased)\n==================\n - Created package\n"], "filenames": ["CHANGES"], "buggy_code_start_loc": [0], "buggy_code_end_loc": [0], "fixing_code_start_loc": [1], "fixing_code_end_loc": [9], "type": "NVD-CWE-noinfo", "message": "When using wagtail-2fa before 1.3.0, if someone gains access to someone's Wagtail login credentials, they can log into the CMS and bypass the 2FA check by changing the URL. They can then add a new device and gain full access to the CMS. This problem has been patched in version 1.3.0.", "other": {"cve": {"id": "CVE-2019-16766", "sourceIdentifier": "security-advisories@github.com", "published": "2019-11-29T17:15:11.683", "lastModified": "2020-10-09T13:27:22.567", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "When using wagtail-2fa before 1.3.0, if someone gains access to someone's Wagtail login credentials, they can log into the CMS and bypass the 2FA check by changing the URL. They can then add a new device and gain full access to the CMS. This problem has been patched in version 1.3.0."}, {"lang": "es", "value": "Cuando se utiliza wagtail-2fa versiones anteriores a 1.3.0, si alguien consigue acceso a las credenciales de inicio de sesi\u00f3n de Wagtail de otro, puede iniciar sesi\u00f3n en el CMS y omitir la comprobaci\u00f3n de 2FA al cambiar la URL. Luego pueden agregar un nuevo dispositivo y conseguir acceso completo al CMS. Este problema ha sido parcheado en la versi\u00f3n 1.3.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.3, "impactScore": 5.8}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-290"}, {"lang": "en", "value": "CWE-304"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:labdigital:wagtail-2fa:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.3.0", "matchCriteriaId": "D2DC866A-C5F3-4807-87A5-3DBE12166499"}]}]}], "references": [{"url": "https://github.com/LabD/wagtail-2fa/security/advisories/GHSA-89px-ww3j-g2mm", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://github.com/labd/wagtail-2fa/commit/13b12995d35b566df08a17257a23863ab6efb0ca", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/labd/wagtail-2fa/commit/a6711b29711729005770ff481b22675b35ff5c81", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/labd/wagtail-2fa/commit/13b12995d35b566df08a17257a23863ab6efb0ca"}}