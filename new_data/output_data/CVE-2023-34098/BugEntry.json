{"buggy_code": ["# BEGIN Shopware\n# The directives (lines) between \"# BEGIN Shopware\" and \"# END Shopware\" are dynamically generated. Any changes to the directives between these markers will be overwritten.\n\n<IfModule mod_rewrite.c>\nRewriteEngine on\n\n#RewriteBase /shopware/\n\n# Fix for office 365 autodiscover feature to prevent CSRF errors\nRewriteRule ^autodiscover/autodiscover.xml$ - [F,L,NC]\n\n# HTTPS config for the backend\n#RewriteCond %{HTTPS} !=on\n#RewriteRule backend/(.*) https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]\n\nRewriteRule shopware.dll shopware.php\nRewriteRule files/documents/.* engine [NC,L]\nRewriteRule backend/media/(.*) media/$1 [NC,L]\nRewriteRule custom/.*(config|menu|services|plugin)\\.xml$ ./shopware.php?controller=Error&action=pageNotFoundError [NC,L]\n\nRewriteCond %{REQUEST_URI} !(\\/(engine|files|templates|themes|web)\\/)\nRewriteCond %{REQUEST_URI} !(\\/media\\/(archive|banner|image|music|pdf|unknown|video)\\/)\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule ^(.*)$ shopware.php [PT,L,QSA]\n\n# Fix missing authorization-header on fast_cgi installations\nRewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization},L]\n</IfModule>\n\n<IfModule mod_alias.c>\n    # Restrict access to VCS directories\n    RedirectMatch 404 /\\\\.(svn|git|hg|bzr|cvs)(/|$)\n\n    # Restrict access to root folder files\n    RedirectMatch 404 /(autoload\\.php|composer\\.(json|lock|phar)|README\\.md|UPGRADE-(.*)\\.md|CONTRIBUTING\\.md|eula.*\\.txt|\\.gitignore|.*\\.dist|\\.env.*)$\n\n    # Restrict access to shop configs files\n    RedirectMatch 404 /(web\\/cache\\/(config_\\d+\\.json|all.less))$\n\n    # Restrict access to theme configurations\n    RedirectMatch 404 /themes/(.*)(.*\\.lock|package\\.json|\\.gitignore|Gruntfile\\.js|all\\.less|node_modules\\/.*)$\n</IfModule>\n\n# Staging environment\n#SetEnvIf Host \"staging.test.shopware.in\" SHOPWARE_ENV=staging\n\n# Development environment\n#SetEnvIf Host \"dev.shopware.in\" SHOPWARE_ENV=dev\n#SetEnv SHOPWARE_ENV dev\n\nDirectoryIndex index.html\nDirectoryIndex index.php\nDirectoryIndex shopware.php\n\n# Disables download of configuration\n<Files ~ \"\\.(tpl|yml|ini)$\">\n    # Deny all requests from Apache 2.4+.\n    <IfModule mod_authz_core.c>\n          Require all denied\n    </IfModule>\n\n    # Deny all requests from Apache 2.0-2.2.\n    <IfModule !mod_authz_core.c>\n        Deny from all\n    </IfModule>\n</Files>\n\n# Enable gzip compression\n<IfModule mod_deflate.c>\n    AddOutputFilterByType DEFLATE text/html text/xml text/plain text/css text/javascript application/javascript application/json application/font-woff application/font-woff2 image/svg+xml\n</IfModule>\n\n<Files ~ \"\\.(jpe?g|png|gif|css|js|woff|woff2|ttf|svg|webp|eot|ico)$\">\n    <IfModule mod_expires.c>\n        ExpiresActive on\n        ExpiresDefault \"access plus 1 month\"\n    </IfModule>\n\n    <IfModule mod_headers.c>\n        Header append Cache-Control \"public\"\n        Header unset ETag\n    </IfModule>\n\n    FileETag None\n</Files>\n\n# Match generated files like:\n# 1429684458_t22_s1.css\n# 1429684458_t22_s1.js\n<FilesMatch \"([0-9]{10})_(.+)\\.(js|css)$\">\n    <ifModule mod_headers.c>\n        Header set Cache-Control \"max-age=31536000, public\"\n    </ifModule>\n\n    <IfModule mod_expires.c>\n        ExpiresActive on\n        ExpiresDefault \"access plus 1 year\"\n    </IfModule>\n</FilesMatch>\n\n<IfModule mod_headers.c>\n    <FilesMatch \"\\.(?i:svg)$\">\n        Header set Content-Security-Policy \"script-src 'none'\"\n    </FilesMatch>\n</IfModule>\n\n# Disables auto directory index\n<IfModule mod_autoindex.c>\n    Options -Indexes\n</IfModule>\n\n<IfModule mod_negotiation.c>\n    Options -MultiViews\n</IfModule>\n\n# AddType x-mapp-php7 .php\n# AddHandler x-mapp-php7.php\n\n<IfModule mod_headers.c>\n    Header append X-Frame-Options SAMEORIGIN\n    # Uncomment the following line to enable HSTS (https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security) and force clients to use HTTPS for at least one year (31536000 seconds)\n    # Header always set Strict-Transport-Security \"max-age=31536000\"\n</IfModule>\n\n# END Shopware\n"], "fixing_code": ["# BEGIN Shopware\n# The directives (lines) between \"# BEGIN Shopware\" and \"# END Shopware\" are dynamically generated. Any changes to the directives between these markers will be overwritten.\n\n<IfModule mod_rewrite.c>\nRewriteEngine on\n\n#RewriteBase /shopware/\n\n# Fix for office 365 autodiscover feature to prevent CSRF errors\nRewriteRule ^autodiscover/autodiscover.xml$ - [F,L,NC]\n\n# HTTPS config for the backend\n#RewriteCond %{HTTPS} !=on\n#RewriteRule backend/(.*) https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]\n\nRewriteRule shopware.dll shopware.php\nRewriteRule files/documents/.* engine [NC,L]\nRewriteRule backend/media/(.*) media/$1 [NC,L]\nRewriteRule custom/.*(config|menu|services|plugin)\\.xml$ ./shopware.php?controller=Error&action=pageNotFoundError [NC,L]\n\nRewriteCond %{REQUEST_URI} !(\\/(engine|files|templates|themes|web)\\/)\nRewriteCond %{REQUEST_URI} !(\\/media\\/(archive|banner|image|music|pdf|unknown|video)\\/)\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule ^(.*)$ shopware.php [PT,L,QSA]\n\n# Fix missing authorization-header on fast_cgi installations\nRewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization},L]\n</IfModule>\n\n<IfModule mod_alias.c>\n    # Restrict access to VCS directories\n    RedirectMatch 404 /\\\\.(svn|git|hg|bzr|cvs)(/|$)\n\n    # Restrict access to root folder files\n    RedirectMatch 404 /(autoload\\.php|composer\\.(json|lock|phar)|README\\.md|UPGRADE-(.*)\\.md|CONTRIBUTING\\.md|eula.*\\.txt|\\.gitignore|.*\\.dist|\\.env.*)$\n\n    # Restrict access to shop configs files\n    RedirectMatch 404 /(web\\/cache\\/(config_\\d+\\.json|all.less))$\n\n    # Restrict access to theme configurations\n    RedirectMatch 404 /themes/(.*)(.(lock|package)\\.json|\\.gitignore|Gruntfile\\.js|all\\.less|node_modules\\/.*)$\n</IfModule>\n\n# Staging environment\n#SetEnvIf Host \"staging.test.shopware.in\" SHOPWARE_ENV=staging\n\n# Development environment\n#SetEnvIf Host \"dev.shopware.in\" SHOPWARE_ENV=dev\n#SetEnv SHOPWARE_ENV dev\n\nDirectoryIndex index.html\nDirectoryIndex index.php\nDirectoryIndex shopware.php\n\n# Disables download of configuration\n<Files ~ \"\\.(tpl|yml|ini)$\">\n    # Deny all requests from Apache 2.4+.\n    <IfModule mod_authz_core.c>\n          Require all denied\n    </IfModule>\n\n    # Deny all requests from Apache 2.0-2.2.\n    <IfModule !mod_authz_core.c>\n        Deny from all\n    </IfModule>\n</Files>\n\n# Enable gzip compression\n<IfModule mod_deflate.c>\n    AddOutputFilterByType DEFLATE text/html text/xml text/plain text/css text/javascript application/javascript application/json application/font-woff application/font-woff2 image/svg+xml\n</IfModule>\n\n<Files ~ \"\\.(jpe?g|png|gif|css|js|woff|woff2|ttf|svg|webp|eot|ico)$\">\n    <IfModule mod_expires.c>\n        ExpiresActive on\n        ExpiresDefault \"access plus 1 month\"\n    </IfModule>\n\n    <IfModule mod_headers.c>\n        Header append Cache-Control \"public\"\n        Header unset ETag\n    </IfModule>\n\n    FileETag None\n</Files>\n\n# Match generated files like:\n# 1429684458_t22_s1.css\n# 1429684458_t22_s1.js\n<FilesMatch \"([0-9]{10})_(.+)\\.(js|css)$\">\n    <ifModule mod_headers.c>\n        Header set Cache-Control \"max-age=31536000, public\"\n    </ifModule>\n\n    <IfModule mod_expires.c>\n        ExpiresActive on\n        ExpiresDefault \"access plus 1 year\"\n    </IfModule>\n</FilesMatch>\n\n<IfModule mod_headers.c>\n    <FilesMatch \"\\.(?i:svg)$\">\n        Header set Content-Security-Policy \"script-src 'none'\"\n    </FilesMatch>\n</IfModule>\n\n# Disables auto directory index\n<IfModule mod_autoindex.c>\n    Options -Indexes\n</IfModule>\n\n<IfModule mod_negotiation.c>\n    Options -MultiViews\n</IfModule>\n\n# AddType x-mapp-php7 .php\n# AddHandler x-mapp-php7.php\n\n<IfModule mod_headers.c>\n    Header append X-Frame-Options SAMEORIGIN\n    # Uncomment the following line to enable HSTS (https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security) and force clients to use HTTPS for at least one year (31536000 seconds)\n    # Header always set Strict-Transport-Security \"max-age=31536000\"\n</IfModule>\n\n# END Shopware\n"], "filenames": [".htaccess.dist"], "buggy_code_start_loc": [42], "buggy_code_end_loc": [43], "fixing_code_start_loc": [42], "fixing_code_end_loc": [43], "type": "CWE-200", "message": "Shopware is an open source e-commerce software. Due to an incorrect configuration in the `.htaccess` file, the configuration file of the Javascript could be read in production environments (`themes/package-lock.json`). With this information, the specific Shopware version in a deployment might be determined by an attacker, which could be used for further attacks. Users are advised to update to version 5.7.18. There are no known workarounds for this vulnerability.\n", "other": {"cve": {"id": "CVE-2023-34098", "sourceIdentifier": "security-advisories@github.com", "published": "2023-06-27T17:15:09.683", "lastModified": "2023-07-05T16:25:47.773", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Shopware is an open source e-commerce software. Due to an incorrect configuration in the `.htaccess` file, the configuration file of the Javascript could be read in production environments (`themes/package-lock.json`). With this information, the specific Shopware version in a deployment might be determined by an attacker, which could be used for further attacks. Users are advised to update to version 5.7.18. There are no known workarounds for this vulnerability.\n"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:shopware:shopware:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.6.0", "versionEndExcluding": "5.7.18", "matchCriteriaId": "53316913-DCF1-4ED6-B9D6-05867CD86BCF"}]}]}], "references": [{"url": "https://docs.shopware.com/en/shopware-5-en/security-updates/security-update-06-2023", "source": "security-advisories@github.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/shopware/shopware/security/advisories/GHSA-q97c-2mh3-pgw9", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/shopware5/shopware/commit/b3518c8d9562a38615d638f31f79829f6e2f4b6a", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://www.shopware.com/en/changelog-sw5/#5-7-18", "source": "security-advisories@github.com", "tags": ["Release Notes"]}]}, "github_commit_url": "https://github.com/shopware5/shopware/commit/b3518c8d9562a38615d638f31f79829f6e2f4b6a"}}