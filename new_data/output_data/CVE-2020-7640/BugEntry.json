{"buggy_code": ["// Simple OOP Tools for Node.JS\n// Copyright (c) 2014 Joseph Huckaby\n// Released under the MIT License\n\nvar util = require(\"util\");\nvar events = require(\"events\");\n\nexports.create = function create(members) {\n\t// create new class using php-style syntax (sort of)\n\tif (!members) members = {};\n\t\n\t// setup constructor\n\tvar constructor = null;\n\t\n\t// inherit from parent class\n\tif (members.__parent) {\n\t\tif (members.__construct) {\n\t\t\t// explicit constructor passed in\n\t\t\tconstructor = members.__construct;\n\t\t}\n\t\telse {\n\t\t\t// inherit parent's constructor\n\t\t\tvar code = members.__parent.toString();\n\t\t\tvar args = code.substring( code.indexOf(\"(\")+1, code.indexOf(\")\") );\n\t\t\tvar inner_code = code.substring( code.indexOf(\"{\")+1, code.lastIndexOf(\"}\") );\n\t\t\teval('constructor = function ('+args+') {'+inner_code+'};');\n\t\t}\n\t\t\n\t\t// inherit rest of parent members\n\t\tutil.inherits(constructor, members.__parent);\n\t\tdelete members.__parent;\n\t}\n\telse {\n\t\t// create new base class\n\t\tconstructor = members.__construct || function() {};\n\t}\n\tdelete members.__construct;\n\t\n\t// handle static variables\n\tif (members.__static) {\n\t\tfor (var key in members.__static) {\n\t\t\tconstructor[key] = members.__static[key];\n\t\t}\n\t\tdelete members.__static;\n\t}\n\t\n\t// all classes are event emitters unless explicitly disabled\n\tif (members.__events !== false) {\n\t\tif (!members.__mixins) members.__mixins = [];\n\t\tif (members.__mixins.indexOf(events.EventEmitter) == -1) {\n\t\t\tmembers.__mixins.push( events.EventEmitter );\n\t\t}\n\t}\n\tdelete members.__events;\n\t\n\t// handle mixins\n\tif (members.__mixins) {\n\t\tfor (var idx = 0, len = members.__mixins.length; idx < len; idx++) {\n\t\t\tvar class_obj = members.__mixins[idx];\n\t\t\t\n\t\t\tfor (var key in class_obj.prototype) {\n\t\t\t\tif (!key.match(/^__/) && (typeof(constructor.prototype[key]) == 'undefined')) {\n\t\t\t\t\tconstructor.prototype[key] = class_obj.prototype[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar static_members = class_obj.__static;\n\t\t\tif (static_members) {\n\t\t\t\tfor (var key in static_members) {\n\t\t\t\t\tif (typeof(constructor[key]) == 'undefined') constructor[key] = static_members[key];\n\t\t\t\t}\n\t\t\t}\n\t\t} // foreach mixin\n\t\tdelete members.__mixins;\n\t} // mixins\n\t\n\t// handle promisify (node 8+)\n\tif (members.__promisify && util.promisify) {\n\t\tif (Array.isArray(members.__promisify)) {\n\t\t\t// promisify some\n\t\t\tmembers.__promisify.forEach( function(key) {\n\t\t\t\tif (typeof(members[key]) == 'function') {\n\t\t\t\t\tmembers[key] = util.promisify( members[key] );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t\telse {\n\t\t\t// promisify all\n\t\t\tfor (var key in members) {\n\t\t\t\tif (!key.match(/^__/) && (typeof(members[key]) == 'function')) {\n\t\t\t\t\tmembers[key] = util.promisify( members[key] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdelete members.__promisify;\n\t}\n\t\n\t// fill prototype members\n\tfor (var key in members) {\n\t\tconstructor.prototype[key] = members[key];\n\t}\n\t\n\t// return completed class definition\n\treturn constructor;\n};\n", "{\n  \"name\": \"pixl-class\",\n  \"version\": \"1.0.2\",\n  \"description\": \"A simple module for creating classes, with inheritance and mixins.\",\n  \"author\": \"Joseph Huckaby <jhuckaby@gmail.com>\",\n  \"homepage\": \"https://github.com/jhuckaby/pixl-class\",\n  \"license\": \"MIT\",\n  \"main\": \"class.js\",\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/jhuckaby/pixl-class\"\n  },\n  \"bugs\": {\n    \"url\": \"https://github.com/jhuckaby/pixl-class/issues\"\n  },\n  \"keywords\": [\n    \"oop\",\n    \"class\"\n  ],\n  \"dependencies\": {},\n  \"devDependencies\": {}\n}\n"], "fixing_code": ["// Simple OOP Tools for Node.JS\n// Copyright (c) 2014 Joseph Huckaby\n// Released under the MIT License\n\nvar util = require(\"util\");\nvar events = require(\"events\");\n\nexports.create = function create(members) {\n\t// create new class using php-style syntax (sort of)\n\tif (!members) members = {};\n\t\n\t// setup constructor\n\tvar constructor = null;\n\t\n\t// inherit from parent class\n\tif (members.__parent) {\n\t\tif (members.__construct) {\n\t\t\t// explicit constructor passed in\n\t\t\tconstructor = members.__construct;\n\t\t}\n\t\telse {\n\t\t\t// inherit parent's constructor\n\t\t\tvar parent = members.__parent;\n\t\t\tconstructor = function() {\n\t\t\t\tvar args = Array.prototype.slice.call(arguments);\n\t\t\t\tparent.apply( this, args );\n\t\t\t};\n\t\t}\n\t\t\n\t\t// inherit rest of parent members\n\t\tutil.inherits(constructor, members.__parent);\n\t\tdelete members.__parent;\n\t}\n\telse {\n\t\t// create new base class\n\t\tconstructor = members.__construct || function() {};\n\t}\n\tdelete members.__construct;\n\t\n\t// handle static variables\n\tif (members.__static) {\n\t\tfor (var key in members.__static) {\n\t\t\tconstructor[key] = members.__static[key];\n\t\t}\n\t\tdelete members.__static;\n\t}\n\t\n\t// all classes are event emitters unless explicitly disabled\n\tif (members.__events !== false) {\n\t\tif (!members.__mixins) members.__mixins = [];\n\t\tif (members.__mixins.indexOf(events.EventEmitter) == -1) {\n\t\t\tmembers.__mixins.push( events.EventEmitter );\n\t\t}\n\t}\n\tdelete members.__events;\n\t\n\t// handle mixins\n\tif (members.__mixins) {\n\t\tfor (var idx = 0, len = members.__mixins.length; idx < len; idx++) {\n\t\t\tvar class_obj = members.__mixins[idx];\n\t\t\t\n\t\t\tfor (var key in class_obj.prototype) {\n\t\t\t\tif (!key.match(/^__/) && (typeof(constructor.prototype[key]) == 'undefined')) {\n\t\t\t\t\tconstructor.prototype[key] = class_obj.prototype[key];\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar static_members = class_obj.__static;\n\t\t\tif (static_members) {\n\t\t\t\tfor (var key in static_members) {\n\t\t\t\t\tif (typeof(constructor[key]) == 'undefined') constructor[key] = static_members[key];\n\t\t\t\t}\n\t\t\t}\n\t\t} // foreach mixin\n\t\tdelete members.__mixins;\n\t} // mixins\n\t\n\t// handle promisify (node 8+)\n\tif (members.__promisify && util.promisify) {\n\t\tif (Array.isArray(members.__promisify)) {\n\t\t\t// promisify some\n\t\t\tmembers.__promisify.forEach( function(key) {\n\t\t\t\tif (typeof(members[key]) == 'function') {\n\t\t\t\t\tmembers[key] = util.promisify( members[key] );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\t\telse {\n\t\t\t// promisify all\n\t\t\tfor (var key in members) {\n\t\t\t\tif (!key.match(/^__/) && (typeof(members[key]) == 'function')) {\n\t\t\t\t\tmembers[key] = util.promisify( members[key] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdelete members.__promisify;\n\t}\n\t\n\t// fill prototype members\n\tfor (var key in members) {\n\t\tconstructor.prototype[key] = members[key];\n\t}\n\t\n\t// return completed class definition\n\treturn constructor;\n};\n", "{\n\t\"name\": \"pixl-class\",\n\t\"version\": \"1.0.3\",\n\t\"description\": \"A simple module for creating classes, with inheritance and mixins.\",\n\t\"author\": \"Joseph Huckaby <jhuckaby@gmail.com>\",\n\t\"homepage\": \"https://github.com/jhuckaby/pixl-class\",\n\t\"license\": \"MIT\",\n\t\"main\": \"class.js\",\n\t\"repository\": {\n\t\t\"type\": \"git\",\n\t\t\"url\": \"https://github.com/jhuckaby/pixl-class\"\n\t},\n\t\"bugs\": {\n\t\t\"url\": \"https://github.com/jhuckaby/pixl-class/issues\"\n\t},\n\t\"keywords\": [\n\t\t\"oop\",\n\t\t\"class\"\n\t],\n\t\"dependencies\": {},\n\t\"devDependencies\": {}\n}\n"], "filenames": ["class.js", "package.json"], "buggy_code_start_loc": [23, 2], "buggy_code_end_loc": [27, 22], "fixing_code_start_loc": [23, 2], "fixing_code_end_loc": [28, 22], "type": "CWE-78", "message": "pixl-class prior to 1.0.3 allows execution of arbitrary commands. The members argument of the create function can be controlled by users without any sanitization.", "other": {"cve": {"id": "CVE-2020-7640", "sourceIdentifier": "report@snyk.io", "published": "2020-04-27T22:15:12.397", "lastModified": "2020-05-01T16:30:52.250", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "pixl-class prior to 1.0.3 allows execution of arbitrary commands. The members argument of the create function can be controlled by users without any sanitization."}, {"lang": "es", "value": "pixl-class versiones anteriores a 1.0.3, permite una ejecuci\u00f3n de comandos arbitrarios. El argumento members de la funci\u00f3n create puede ser controlado por usuarios sin ning\u00fan saneamiento"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:pixlcore:pixl-class:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "1.0.3", "matchCriteriaId": "98C45273-030E-463E-AF06-DB32D297DBAF"}]}]}], "references": [{"url": "https://github.com/jhuckaby/pixl-class/commit/47677a3638e3583e42f3a05cc7f0b30293d2acc8", "source": "nvd@nist.gov", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://snyk.io/vuln/SNYK-JS-PIXLCLASS-564968", "source": "report@snyk.io", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/jhuckaby/pixl-class/commit/47677a3638e3583e42f3a05cc7f0b30293d2acc8"}}