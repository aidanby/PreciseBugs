{"buggy_code": ["include /etc/nginx/conf.d/server_config;\n\nupstream web {\n    server web:8000;\n}\n\nserver {\n    listen 80;\n\n    location / {\n        proxy_pass http://web;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Host $host;\n        proxy_redirect off;\n    }\n\n    location /images/ {\n        alias /app/images/;\n    }\n\n    location /static/ {\n        alias /app/static/;\n    }\n}\n", "include /etc/nginx/conf.d/server_config;\n\nupstream web {\n    server web:8000;\n}\n\nserver {\n    listen [::]:80;\n    listen 80;\n\n    server_name your-domain.com www.your-domain.com;\n\n    location ~ /.well-known/acme-challenge {\n        allow all;\n        root /var/www/certbot;\n    }\n\n#     # redirect http to https\n#     return 301 https://your-domain.com$request_uri;\n}\n\n#\n# server {\n#     listen [::]:443 ssl http2;\n#     listen 443 ssl http2;\n#\n#     server_name your-domain.com;\n#\n#     client_max_body_size 3M;\n#\n#     if ($host != \"your-domain.com\") {\n#         return 301 $scheme://your-domain.com$request_uri;\n#     }\n#\n#     # SSL code\n#     ssl_certificate /etc/nginx/ssl/live/your-domain.com/fullchain.pem;\n#     ssl_certificate_key /etc/nginx/ssl/live/your-domain.com/privkey.pem;\n#\n#     location ~ /.well-known/acme-challenge {\n#         allow all;\n#         root /var/www/certbot;\n#     }\n#\n#     location / {\n#         proxy_pass http://web;\n#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n#         proxy_set_header Host $host;\n#         proxy_redirect off;\n#     }\n#\n#     location /images/ {\n#         alias /app/images/;\n#     }\n#\n#     location /static/ {\n#         alias /app/static/;\n#     }\n# }\n\n# Reverse-Proxy server\n# server {\n#     listen [::]:8001;\n#     listen 8001;\n\n#     server_name your-domain.com www.your-domain.com;\n\n#     location / {\n#         proxy_pass http://web;\n#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n#         proxy_set_header Host $host;\n#         proxy_redirect off;\n#     }\n\n#     location /images/ {\n#         alias /app/images/;\n#     }\n\n#     location /static/ {\n#         alias /app/static/;\n#     }\n# }\n", "client_max_body_size 10m;\n"], "fixing_code": ["include /etc/nginx/conf.d/server_config;\n\nupstream web {\n    server web:8000;\n}\n\nserver {\n    listen 80;\n\n    location ~ ^/(login|password-reset|resend-link) {\n        limit_req zone=loginlimit;\n\n        proxy_pass http://web;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Host $host;\n        proxy_redirect off;\n    }\n\n    location / {\n        proxy_pass http://web;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header Host $host;\n        proxy_redirect off;\n    }\n\n    location /images/ {\n        alias /app/images/;\n    }\n\n    location /static/ {\n        alias /app/static/;\n    }\n}\n", "include /etc/nginx/conf.d/server_config;\n\nupstream web {\n    server web:8000;\n}\n\nserver {\n    listen [::]:80;\n    listen 80;\n\n    server_name your-domain.com www.your-domain.com;\n\n    location ~ /.well-known/acme-challenge {\n        allow all;\n        root /var/www/certbot;\n    }\n\n#     # redirect http to https\n#     return 301 https://your-domain.com$request_uri;\n}\n\n#\n# server {\n#     listen [::]:443 ssl http2;\n#     listen 443 ssl http2;\n#\n#     server_name your-domain.com;\n#\n#     client_max_body_size 3M;\n#\n#     if ($host != \"your-domain.com\") {\n#         return 301 $scheme://your-domain.com$request_uri;\n#     }\n#\n#     # SSL code\n#     ssl_certificate /etc/nginx/ssl/live/your-domain.com/fullchain.pem;\n#     ssl_certificate_key /etc/nginx/ssl/live/your-domain.com/privkey.pem;\n#\n#     location ~ /.well-known/acme-challenge {\n#         allow all;\n#         root /var/www/certbot;\n#     }\n#\n#     location ~ ^/(login|password-reset|resend-link) {\n#         limit_req zone=loginlimit;\n#\n#         proxy_pass http://web;\n#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n#         proxy_set_header Host $host;\n#         proxy_redirect off;\n#     }\n#\n#     location / {\n#         proxy_pass http://web;\n#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n#         proxy_set_header Host $host;\n#         proxy_redirect off;\n#     }\n#\n#     location /images/ {\n#         alias /app/images/;\n#     }\n#\n#     location /static/ {\n#         alias /app/static/;\n#     }\n# }\n\n# Reverse-Proxy server\n# server {\n#     listen [::]:8001;\n#     listen 8001;\n\n#     server_name your-domain.com www.your-domain.com;\n\n#     location / {\n#         proxy_pass http://web;\n#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n#         proxy_set_header Host $host;\n#         proxy_redirect off;\n#     }\n\n#     location /images/ {\n#         alias /app/images/;\n#     }\n\n#     location /static/ {\n#         alias /app/static/;\n#     }\n# }\n", "client_max_body_size 10m;\nlimit_req_zone $binary_remote_addr zone=loginlimit:10m rate=1r/s;\n"], "filenames": ["nginx/development", "nginx/production", "nginx/server_config"], "buggy_code_start_loc": [8, 43, 1], "buggy_code_end_loc": [8, 43, 1], "fixing_code_start_loc": [9, 44, 2], "fixing_code_end_loc": [18, 53, 3], "type": "CWE-305", "message": "Authentication Bypass by Primary Weakness in GitHub repository bookwyrm-social/bookwyrm prior to 0.4.5.", "other": {"cve": {"id": "CVE-2022-2651", "sourceIdentifier": "security@huntr.dev", "published": "2022-08-04T09:15:08.647", "lastModified": "2022-09-29T15:41:32.753", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Authentication Bypass by Primary Weakness in GitHub repository bookwyrm-social/bookwyrm prior to 0.4.5."}, {"lang": "es", "value": "Una Omisi\u00f3n de autenticaci\u00f3n por Debilidad Primaria en el repositorio de GitHub bookwyrm-social/bookwyrm versiones anteriores a 0.4.5"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-305"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:joinbookwyrm:bookwyrm:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.4.5", "matchCriteriaId": "D72588D8-BF2B-42A3-8DD6-FE4381B2C502"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/168423/Bookwyrm-0.4.3-Authentication-Bypass.html", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/bookwyrm-social/bookwyrm/commit/7bbe42fb30a79a26115524d18b697d895563c92f", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/428eee94-f1a0-45d0-9e25-318641115550", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/bookwyrm-social/bookwyrm/commit/7bbe42fb30a79a26115524d18b697d895563c92f"}}