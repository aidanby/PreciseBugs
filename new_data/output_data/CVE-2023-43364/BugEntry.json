{"buggy_code": ["import click\r\nfrom searchor import Engine\r\nimport searchor.history\r\n\r\n\r\n@click.group()\r\ndef cli():\r\n    pass\r\n\r\n\r\n@cli.command()\r\n@click.option(\r\n    \"-o\",\r\n    \"--open\",\r\n    is_flag=True,\r\n    default=False,\r\n    show_default=True,\r\n    help=\"Opens your web browser to the generated link address\",\r\n)\r\n@click.option(\r\n    \"-c\",\r\n    \"--copy\",\r\n    is_flag=True,\r\n    default=False,\r\n    show_default=True,\r\n    help=\"Copies the generated link address to your clipboard\",\r\n)\r\n@click.argument(\"engine\")\r\n@click.argument(\"query\")\r\ndef search(engine, query, open, copy):\r\n    try:\r\n        url = eval(\r\n            f\"Engine.{engine}.search('{query}', copy_url={copy}, open_web={open})\"\r\n        )\r\n        click.echo(url)\r\n        searchor.history.update(engine, query, url)\r\n        if open:\r\n            click.echo(\"opening browser...\")\r\n        if copy:\r\n            click.echo(\"link copied to clipboard\")\r\n    except AttributeError:\r\n        print(\"engine not recognized\")\r\n\r\n\r\n@cli.command()\r\n@click.option(\r\n    \"-c\",\r\n    \"--clear\",\r\n    is_flag=True,\r\n    default=False,\r\n    show_default=True,\r\n    help=\"clears the search history\",\r\n)\r\ndef history(clear):\r\n    if clear:\r\n        searchor.history.clear()\r\n    else:\r\n        searchor.history.view()\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    cli()\r\n"], "fixing_code": ["import click\r\nfrom searchor import Engine\r\nimport searchor.history\r\n\r\n\r\n@click.group()\r\ndef cli():\r\n    pass\r\n\r\n\r\n@cli.command()\r\n@click.option(\r\n    \"-o\",\r\n    \"--open\",\r\n    is_flag=True,\r\n    default=False,\r\n    show_default=True,\r\n    help=\"Opens your web browser to the generated link address\",\r\n)\r\n@click.option(\r\n    \"-c\",\r\n    \"--copy\",\r\n    is_flag=True,\r\n    default=False,\r\n    show_default=True,\r\n    help=\"Copies the generated link address to your clipboard\",\r\n)\r\n@click.argument(\"engine\")\r\n@click.argument(\"query\")\r\ndef search(engine, query, open, copy):\r\n    try:\r\n        url = Engine[engine].search(query, copy_url=copy, open_web=open)\r\n        click.echo(url)\r\n        searchor.history.update(engine, query, url)\r\n        if open:\r\n            click.echo(\"opening browser...\")\r\n        if copy:\r\n            click.echo(\"link copied to clipboard\")\r\n    except AttributeError:\r\n        print(\"engine not recognized\")\r\n\r\n\r\n@cli.command()\r\n@click.option(\r\n    \"-c\",\r\n    \"--clear\",\r\n    is_flag=True,\r\n    default=False,\r\n    show_default=True,\r\n    help=\"clears the search history\",\r\n)\r\ndef history(clear):\r\n    if clear:\r\n        searchor.history.clear()\r\n    else:\r\n        searchor.history.view()\r\n\r\n\r\nif __name__ == \"__main__\":\r\n    cli()\r\n"], "filenames": ["src/searchor/main.py"], "buggy_code_start_loc": [32], "buggy_code_end_loc": [35], "fixing_code_start_loc": [32], "fixing_code_end_loc": [33], "type": "CWE-74", "message": "main.py in Searchor before 2.4.2 uses eval on CLI input, which may cause unexpected code execution.", "other": {"cve": {"id": "CVE-2023-43364", "sourceIdentifier": "cve@mitre.org", "published": "2023-12-12T18:15:22.887", "lastModified": "2023-12-14T21:15:15.067", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "main.py in Searchor before 2.4.2 uses eval on CLI input, which may cause unexpected code execution."}, {"lang": "es", "value": "main.py en Searchor anterior a 2.4.2 usa eval en la entrada CLI, lo que puede provocar la ejecuci\u00f3n inesperada de c\u00f3digo."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:arjunsharda:searchor:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.4.2", "matchCriteriaId": "5F8591B8-9059-4791-A680-0CD942D1EDC0"}]}]}], "references": [{"url": "https://github.com/ArjunSharda/Searchor/commit/16016506f7bf92b0f21f51841d599126d6fcd15b", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/ArjunSharda/Searchor/pull/130", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://github.com/advisories/GHSA-66m2-493m-crh2", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/nexis-nexis/Searchor-2.4.0-POC-Exploit-", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://github.com/nikn0laty/Exploit-for-Searchor-2.4.0-Arbitrary-CMD-Injection", "source": "cve@mitre.org", "tags": ["Exploit"]}]}, "github_commit_url": "https://github.com/ArjunSharda/Searchor/commit/16016506f7bf92b0f21f51841d599126d6fcd15b"}}