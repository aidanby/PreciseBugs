{"buggy_code": ["/**\r\n * (c) jSuites Javascript Web Components\r\n *\r\n * Website: https://jsuites.net\r\n * Description: Create amazing web based applications.\r\n *\r\n * MIT License\r\n *\r\n */\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jSuites = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\nvar jSuites = function(options) {\r\n    var obj = {}\r\n    var version = '4.4.0';\r\n\r\n    var find = function(DOMElement, component) {\r\n        if (DOMElement[component.type] && DOMElement[component.type] == component) {\r\n            return true;\r\n        }\r\n        if (DOMElement.parentNode) {\r\n            return find(DOMElement.parentNode, component);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    var isOpened = function(e) {\r\n        if (jSuites.current.length > 0) {\r\n            for (var i = 0; i < jSuites.current.length; i++) {\r\n                if (jSuites.current[i] && ! find(e.target, jSuites.current[i])) {\r\n                    jSuites.current[i].close();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.init = function() {\r\n        document.addEventListener(\"click\", isOpened);\r\n\r\n        obj.version = version;\r\n    }\r\n\r\n    obj.tracking = function(component, state) {\r\n        if (state == true) {\r\n            jSuites.current = jSuites.current.filter(function(v) {\r\n                return v !== null;\r\n            });\r\n\r\n            // Start after all events\r\n            setTimeout(function() {\r\n                jSuites.current.push(component);\r\n            }, 0);\r\n\r\n        } else {\r\n            var index = jSuites.current.indexOf(component);\r\n            if (index >= 0) {\r\n                jSuites.current[index] = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get or set a property from a JSON from a string.\r\n     */\r\n    obj.path = function(str, val) {\r\n        str = str.split('.');\r\n        if (str.length) {\r\n            var o = this;\r\n            var p = null;\r\n            while (str.length > 1) {\r\n                // Get the property\r\n                p = str.shift();\r\n                // Check if the property exists\r\n                if (o.hasOwnProperty(p)) {\r\n                    o = o[p];\r\n                } else {\r\n                    // Property does not exists\r\n                    if (val === undefined) {\r\n                        return undefined;\r\n                    } else {\r\n                        // Create the property\r\n                        o[p] = {};\r\n                        // Next property\r\n                        o = o[p];\r\n                    }\r\n                }\r\n            }\r\n            // Get the property\r\n            p = str.shift();\r\n            // Set or get the value\r\n            if (val !== undefined) {\r\n                o[p] = val;\r\n                // Success\r\n                return true;\r\n            } else {\r\n                // Return the value\r\n                return o[p];\r\n            }\r\n        }\r\n        // Something went wrong\r\n        return false;\r\n    }\r\n\r\n    // Update dictionary\r\n    obj.setDictionary = function(d) {\r\n        obj.dictionary = d;\r\n\r\n        // Translations\r\n        var t = null;\r\n        for (var i = 0; i < jSuites.calendar.weekdays.length; i++) {\r\n            t =  jSuites.translate(jSuites.calendar.weekdays[i]);\r\n            if (jSuites.calendar.weekdays[i]) {\r\n                jSuites.calendar.weekdays[i] = t;\r\n                jSuites.calendar.weekdaysShort[i] = t.substr(0,3);\r\n            }\r\n        }\r\n        for (var i = 0; i < jSuites.calendar.months.length; i++) {\r\n            t = jSuites.translate(jSuites.calendar.months[i]);\r\n            if (t) {\r\n                jSuites.calendar.months[i] = t;\r\n                jSuites.calendar.monthsShort[i] = t.substr(0,3);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Dictionary\r\n    obj.dictionary = {};\r\n\r\n    // Translate\r\n    obj.translate = function(t) {\r\n        return obj.dictionary[t] || t;\r\n    }\r\n\r\n    // Array of opened components\r\n    obj.current = [];\r\n\r\n    return obj;\r\n}();\r\n\r\n/**\r\n * Global jsuites event\r\n */\r\nif (typeof(document) !== \"undefined\") {\r\n    jSuites.init();\r\n}\r\n\r\njSuites.ajax = (function(options, complete) {\r\n    if (Array.isArray(options)) {\r\n        // Create multiple request controller \r\n        var multiple = {\r\n            instance: [],\r\n            complete: complete,\r\n        }\r\n\r\n        if (options.length > 0) {\r\n            for (var i = 0; i < options.length; i++) {\r\n                options[i].multiple = multiple;\r\n                multiple.instance.push(jSuites.ajax(options[i]));\r\n            }\r\n        }\r\n\r\n        return multiple;\r\n    }\r\n\r\n    if (! options.data) {\r\n        options.data = {};\r\n    }\r\n\r\n    if (options.type) {\r\n        options.method = options.type;\r\n    }\r\n\r\n    // Default method\r\n    if (! options.method) {\r\n        options.method = 'GET';\r\n    }\r\n\r\n    // Default type\r\n    if (! options.dataType) {\r\n        options.dataType = 'json';\r\n    }\r\n\r\n    if (options.data) {\r\n        // Parse object to variables format\r\n        var parseData = function(value, key) {\r\n            var vars = [];\r\n            var keys = Object.keys(value);\r\n            if (keys.length) {\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    if (key) {\r\n                        var k = key + '[' + keys[i] + ']';\r\n                    } else {\r\n                        var k = keys[i];\r\n                    }\r\n\r\n                    if (typeof(value[keys[i]]) == 'object') {\r\n                        var r = parseData(value[keys[i]], k);\r\n                        var o = Object.keys(r);\r\n                        for (var j = 0; j < o.length; j++) {\r\n                            vars[o[j]] = r[o[j]];\r\n                        }\r\n                    } else {\r\n                        vars[k] = value[keys[i]];\r\n                    }\r\n                }\r\n            }\r\n\r\n            return vars;\r\n        }\r\n\r\n        var data = [];\r\n        var d = parseData(options.data);\r\n        var k = Object.keys(d);\r\n        for (var i = 0; i < k.length; i++) {\r\n            data.push(k[i] + '=' + encodeURIComponent(d[k[i]]));\r\n        }\r\n\r\n        if (options.method == 'GET' && data.length > 0) {\r\n            if (options.url.indexOf('?') < 0) {\r\n                options.url += '?';\r\n            }\r\n            options.url += data.join('&');\r\n        }\r\n    }\r\n\r\n    var httpRequest = new XMLHttpRequest();\r\n    httpRequest.open(options.method, options.url, true);\r\n    httpRequest.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\r\n\r\n    if (options.method == 'POST') {\r\n        httpRequest.setRequestHeader('Accept', 'application/json');\r\n        httpRequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n    } else {\r\n        if (options.dataType == 'json') {\r\n            httpRequest.setRequestHeader('Content-Type', 'text/json');\r\n        } else if (options.dataType == 'blob') {\r\n            httpRequest.responseType = \"blob\";\r\n        } else if (options.dataType == 'html') {\r\n            httpRequest.setRequestHeader('Content-Type', 'text/html');\r\n        }\r\n    }\r\n\r\n    // No cache\r\n    if (options.cache != true) {\r\n        httpRequest.setRequestHeader('pragma', 'no-cache');\r\n        httpRequest.setRequestHeader('cache-control', 'no-cache');\r\n    }\r\n\r\n    // Authentication\r\n    if (options.withCredentials == true) {\r\n        httpRequest.withCredentials = true\r\n    }\r\n\r\n    // Before send\r\n    if (typeof(options.beforeSend) == 'function') {\r\n        options.beforeSend(httpRequest);\r\n    }\r\n\r\n    httpRequest.onload = function() {\r\n        if (httpRequest.status === 200) {\r\n            if (options.dataType == 'json') {\r\n                try {\r\n                    var result = JSON.parse(httpRequest.responseText);\r\n\r\n                    if (options.success && typeof(options.success) == 'function') {\r\n                        options.success(result);\r\n                    }\r\n                } catch(err) {\r\n                    if (options.error && typeof(options.error) == 'function') {\r\n                        options.error(err, result);\r\n                    }\r\n                }\r\n            } else {\r\n                if (options.dataType == 'blob') {\r\n                    var result = httpRequest.response;\r\n                } else {\r\n                    var result = httpRequest.responseText;\r\n                }\r\n\r\n                if (options.success && typeof(options.success) == 'function') {\r\n                    options.success(result);\r\n                }\r\n            }\r\n        } else {\r\n            if (options.error && typeof(options.error) == 'function') {\r\n                options.error(httpRequest.responseText, httpRequest.status);\r\n            }\r\n        }\r\n\r\n        // Global queue\r\n        if (jSuites.ajax.queue && jSuites.ajax.queue.length > 0) {\r\n            jSuites.ajax.send(jSuites.ajax.queue.shift());\r\n        }\r\n\r\n        // Global complete method\r\n        if (jSuites.ajax.requests && jSuites.ajax.requests.length) {\r\n            // Get index of this request in the container\r\n            var index = jSuites.ajax.requests.indexOf(httpRequest);\r\n            // Remove from the ajax requests container\r\n            jSuites.ajax.requests.splice(index, 1);\r\n            // Deprected: Last one?\r\n            if (! jSuites.ajax.requests.length) {\r\n                // Object event\r\n                if (options.complete && typeof(options.complete) == 'function') {\r\n                    options.complete(result);\r\n                }\r\n            }\r\n            // Group requests\r\n            if (options.group) {\r\n                if (jSuites.ajax.oncomplete && typeof(jSuites.ajax.oncomplete[options.group]) == 'function') {\r\n                    if (! jSuites.ajax.pending(options.group)) {\r\n                        jSuites.ajax.oncomplete[options.group]();\r\n                        jSuites.ajax.oncomplete[options.group] = null;\r\n                    }\r\n                }\r\n            }\r\n            // Multiple requests controller\r\n            if (options.multiple && options.multiple.instance) {\r\n                // Get index of this request in the container\r\n                var index = options.multiple.instance.indexOf(httpRequest);\r\n                // Remove from the ajax requests container\r\n                options.multiple.instance.splice(index, 1);\r\n                // If this is the last one call method complete\r\n                if (! options.multiple.instance.length) {\r\n                    if (options.multiple.complete && typeof(options.multiple.complete) == 'function') {\r\n                        options.multiple.complete(result);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Keep the options\r\n    httpRequest.options = options;\r\n    // Data\r\n    httpRequest.data = data;\r\n\r\n    // Queue\r\n    if (options.queue == true && jSuites.ajax.requests.length > 0) {\r\n        jSuites.ajax.queue.push(httpRequest);\r\n    } else {\r\n        jSuites.ajax.send(httpRequest)\r\n    }\r\n\r\n    return httpRequest;\r\n});\r\n\r\njSuites.ajax.send = function(httpRequest) {\r\n    if (httpRequest.data) {\r\n        httpRequest.send(httpRequest.data.join('&'));\r\n    } else {\r\n        httpRequest.send();\r\n    }\r\n\r\n    jSuites.ajax.requests.push(httpRequest);\r\n}\r\n\r\njSuites.ajax.exists = function(url, __callback) {\r\n    var http = new XMLHttpRequest();\r\n    http.open('HEAD', url, false);\r\n    http.send();\r\n    if (http.status) {\r\n        __callback(http.status);\r\n    }\r\n}\r\n\r\njSuites.ajax.pending = function(group) {\r\n    var n = 0;\r\n    var o = jSuites.ajax.requests;\r\n    if (o && o.length) {\r\n        for (var i = 0; i < o.length; i++) {\r\n            if (! group || group == o[i].options.group) {\r\n                n++\r\n            }\r\n        }\r\n    }\r\n    return n;\r\n}\r\n\r\njSuites.ajax.oncomplete = {};\r\njSuites.ajax.requests = [];\r\njSuites.ajax.queue = [];\r\n\r\njSuites.animation = {};\r\n\r\njSuites.animation.slideLeft = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-left-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-left-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-left-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-left-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideRight = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-right-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-right-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-right-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-right-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideTop = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-top-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-top-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-top-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-top-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideBottom = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-bottom-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-bottom-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-bottom-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-bottom-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\njSuites.animation.fadeIn = function(element, done) {\r\n    element.style.display = '';\r\n    element.classList.add('fade-in');\r\n    setTimeout(function() {\r\n        element.classList.remove('fade-in');\r\n        if (typeof(done) == 'function') {\r\n            done();\r\n        }\r\n    }, 2000);\r\n}\r\n\r\njSuites.animation.fadeOut = function(element, done) {\r\n    element.classList.add('fade-out');\r\n    setTimeout(function() {\r\n        element.style.display = 'none';\r\n        element.classList.remove('fade-out');\r\n        if (typeof(done) == 'function') {\r\n            done();\r\n        }\r\n    }, 1000);\r\n}\r\n\r\njSuites.calendar = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.calendar) {\r\n        return el.calendar.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type:'calendar' };\r\n    obj.options = {};\r\n\r\n    // Date\r\n    obj.date = null;\r\n\r\n    /**\r\n     * Update options\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            // Render type: [ default | year-month-picker ]\r\n            type: 'default',\r\n            // Restrictions\r\n            validRange: null,\r\n            // Starting weekday - 0 for sunday, 6 for saturday\r\n            startingDay: null, \r\n            // Date format\r\n            format: 'DD/MM/YYYY',\r\n            // Allow keyboard date entry\r\n            readonly: true,\r\n            // Today is default\r\n            today: false,\r\n            // Show timepicker\r\n            time: false,\r\n            // Show the reset button\r\n            resetButton: true,\r\n            // Placeholder\r\n            placeholder: '',\r\n            // Translations can be done here\r\n            months: jSuites.calendar.monthsShort,\r\n            monthsFull: jSuites.calendar.months,\r\n            weekdays: jSuites.calendar.weekdays,\r\n            weekdays_short: jSuites.calendar.weekdays,\r\n            textDone: jSuites.translate('Done'),\r\n            textReset: jSuites.translate('Reset'),\r\n            textUpdate: jSuites.translate('Update'),\r\n            // Value\r\n            value: null,\r\n            // Fullscreen (this is automatic set for screensize < 800)\r\n            fullscreen: false,\r\n            // Create the calendar closed as default\r\n            opened: false,\r\n            // Events\r\n            onopen: null,\r\n            onclose: null,\r\n            onchange: null,\r\n            onupdate: null,\r\n            // Internal mode controller\r\n            mode: null,\r\n            position: null,\r\n            // Data type\r\n            dataType: null,\r\n        }\r\n\r\n        for (var i = 0; i < defaults.weekdays_short.length; i++) {\r\n            defaults.weekdays_short[i] = defaults.weekdays_short[i].substr(0,1);\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Reset button\r\n        if (obj.options.resetButton == false) {\r\n            calendarReset.style.display = 'none';\r\n        } else {\r\n            calendarReset.style.display = '';\r\n        }\r\n\r\n        // Readonly\r\n        if (obj.options.readonly) {\r\n            el.setAttribute('readonly', 'readonly');\r\n        } else {\r\n            el.removeAttribute('readonly');\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            el.removeAttribute('placeholder');\r\n        }\r\n\r\n        if (jSuites.isNumeric(obj.options.value) && obj.options.value > 0) {\r\n            obj.options.value = jSuites.calendar.numToDate(obj.options.value);\r\n            // Data type numberic\r\n            obj.options.dataType = 'numeric';\r\n        }\r\n\r\n        // Texts\r\n        calendarReset.innerHTML = obj.options.textReset;\r\n        calendarConfirm.innerHTML = obj.options.textDone;\r\n        calendarControlsUpdateButton.innerHTML = obj.options.textUpdate;\r\n\r\n        // Define mask\r\n        el.setAttribute('data-mask', obj.options.format.toLowerCase());\r\n\r\n        // Value\r\n        if (! obj.options.value && obj.options.today) {\r\n            var value = jSuites.calendar.now();\r\n        } else {\r\n            var value = obj.options.value;\r\n        }\r\n\r\n        // Set internal date\r\n        if (value) {\r\n            // Force the update\r\n            obj.options.value = null;\r\n            // New value\r\n            obj.setValue(value);\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Open the calendar\r\n     */\r\n    obj.open = function (value) {\r\n        if (! calendar.classList.contains('jcalendar-focus')) {\r\n            if (! calendar.classList.contains('jcalendar-inline')) {\r\n                // Current\r\n                jSuites.calendar.current = obj;\r\n                // Start tracking\r\n                jSuites.tracking(obj, true);\r\n                // Create the days\r\n                obj.getDays();\r\n                // Render months\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.getMonths();\r\n                }\r\n                // Get time\r\n                if (obj.options.time) {\r\n                    calendarSelectHour.value = obj.date[3];\r\n                    calendarSelectMin.value = obj.date[4];\r\n                }\r\n\r\n                // Show calendar\r\n                calendar.classList.add('jcalendar-focus');\r\n\r\n                // Get the position of the corner helper\r\n                if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen) {\r\n                    calendar.classList.add('jcalendar-fullsize');\r\n                    // Animation\r\n                    jSuites.animation.slideBottom(calendarContent, 1);\r\n                } else {\r\n                    calendar.classList.remove('jcalendar-fullsize');\r\n\r\n                    var rect = el.getBoundingClientRect();\r\n                    var rectContent = calendarContent.getBoundingClientRect();\r\n\r\n                    if (obj.options.position) {\r\n                        calendarContainer.style.position = 'fixed';\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            calendarContainer.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                        } else {\r\n                            calendarContainer.style.top = (rect.top + rect.height + 2) + 'px';\r\n                        }\r\n                        calendarContainer.style.left = rect.left + 'px';\r\n                    } else {\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            var d = -1 * (rect.height + rectContent.height + 2);\r\n                            if (d + rect.top < 0) {\r\n                                d = -1 * (rect.top + rect.height);\r\n                            }\r\n                            calendarContainer.style.top = d + 'px';\r\n                        } else {\r\n                            calendarContainer.style.top = 2 + 'px'; \r\n                        }\r\n\r\n                        if (window.innerWidth < rect.left + rectContent.width) {\r\n                            var d = window.innerWidth - (rect.left + rectContent.width + 20);\r\n                            calendarContainer.style.left = d + 'px';\r\n                        } else {\r\n                            calendarContainer.style.left = '0px'; \r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Events\r\n                if (typeof(obj.options.onopen) == 'function') {\r\n                    obj.options.onopen(el);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.close = function (ignoreEvents, update) {\r\n        if (calendar.classList.contains('jcalendar-focus')) {\r\n            if (update !== false) {\r\n                var element = calendar.querySelector('.jcalendar-selected');\r\n\r\n                if (typeof(update) == 'string') {\r\n                    var value = update;\r\n                } else if (! element || element.classList.contains('jcalendar-disabled')) {\r\n                    var value = obj.options.value\r\n                } else {\r\n                    var value = obj.getValue();\r\n                }\r\n\r\n                obj.setValue(value);\r\n            }\r\n\r\n            // Events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Hide\r\n            calendar.classList.remove('jcalendar-focus');\r\n            // Stop tracking\r\n            jSuites.tracking(obj, false);\r\n            // Current\r\n            jSuites.calendar.current = null;\r\n        }\r\n\r\n        return obj.options.value;\r\n    }\r\n\r\n    obj.prev = function() {\r\n        // Check if the visualization is the days picker or years picker\r\n        if (obj.options.mode == 'years') {\r\n            obj.date[0] = obj.date[0] - 12;\r\n\r\n            // Update picker table of days\r\n            obj.getYears();\r\n        } else if (obj.options.mode == 'months') {\r\n            obj.date[0] = parseInt(obj.date[0]) - 1;\r\n            // Update picker table of months\r\n            obj.getMonths();\r\n        } else {\r\n            // Go to the previous month\r\n            if (obj.date[1] < 2) {\r\n                obj.date[0] = obj.date[0] - 1;\r\n                obj.date[1] = 12;\r\n            } else {\r\n                obj.date[1] = obj.date[1] - 1;\r\n            }\r\n\r\n            // Update picker table of days\r\n            obj.getDays();\r\n        }\r\n    }\r\n\r\n    obj.next = function() {\r\n        // Check if the visualization is the days picker or years picker\r\n        if (obj.options.mode == 'years') {\r\n            obj.date[0] = parseInt(obj.date[0]) + 12;\r\n\r\n            // Update picker table of days\r\n            obj.getYears();\r\n        } else if (obj.options.mode == 'months') {\r\n            obj.date[0] = parseInt(obj.date[0]) + 1;\r\n            // Update picker table of months\r\n            obj.getMonths();\r\n        } else {\r\n            // Go to the previous month\r\n            if (obj.date[1] > 11) {\r\n                obj.date[0] = parseInt(obj.date[0]) + 1;\r\n                obj.date[1] = 1;\r\n            } else {\r\n                obj.date[1] = parseInt(obj.date[1]) + 1;\r\n            }\r\n\r\n            // Update picker table of days\r\n            obj.getDays();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set today\r\n     */\r\n    obj.setToday = function() {\r\n        // Today\r\n        var value = new Date().toISOString().substr(0, 10);\r\n        // Change value\r\n        obj.setValue(value);\r\n        // Value\r\n        return value;\r\n    }\r\n\r\n    obj.setValue = function(val) {\r\n        if (! val) {\r\n            val = '' + val;\r\n        }\r\n        // Values\r\n        var newValue = val;\r\n        var oldValue = obj.options.value;\r\n\r\n        if (oldValue != newValue) {\r\n            // Set label\r\n            if (! newValue) {\r\n                obj.date = null;\r\n                var val = '';\r\n            } else {\r\n                var value = obj.setLabel(newValue, obj.options);\r\n                var date = newValue.split(' ');\r\n                if (! date[1]) {\r\n                    date[1] = '00:00:00';\r\n                }\r\n                var time = date[1].split(':')\r\n                var date = date[0].split('-');\r\n                var y = parseInt(date[0]);\r\n                var m = parseInt(date[1]);\r\n                var d = parseInt(date[2]);\r\n                var h = parseInt(time[0]);\r\n                var i = parseInt(time[1]);\r\n                obj.date = [ y, m, d, h, i, 0 ];\r\n                var val = obj.setLabel(newValue, obj.options);\r\n            }\r\n\r\n            // New value\r\n            obj.options.value = newValue;\r\n\r\n            if (typeof(obj.options.onchange) ==  'function') {\r\n                obj.options.onchange(el, newValue, oldValue);\r\n            }\r\n\r\n            // Lemonade JS\r\n            if (el.value != val) {\r\n                el.value = val;\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        obj.getDays();\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        if (obj.date) {\r\n            if (obj.options.time) {\r\n                return jSuites.two(obj.date[0]) + '-' + jSuites.two(obj.date[1]) + '-' + jSuites.two(obj.date[2]) + ' ' + jSuites.two(obj.date[3]) + ':' + jSuites.two(obj.date[4]) + ':' + jSuites.two(0);\r\n            } else {\r\n                return jSuites.two(obj.date[0]) + '-' + jSuites.two(obj.date[1]) + '-' + jSuites.two(obj.date[2]) + ' ' + jSuites.two(0) + ':' + jSuites.two(0) + ':' + jSuites.two(0);\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     *  Calendar\r\n     */\r\n    obj.update = function(element, v) {\r\n        if (element.classList.contains('jcalendar-disabled')) {\r\n            // Do nothing\r\n        } else {\r\n            var elements = calendar.querySelector('.jcalendar-selected');\r\n            if (elements) {\r\n                elements.classList.remove('jcalendar-selected');\r\n            }\r\n            element.classList.add('jcalendar-selected');\r\n\r\n            if (element.classList.contains('jcalendar-set-month')) {\r\n                obj.date[1] = v;\r\n            } else {\r\n                obj.date[2] = element.innerText;\r\n            }\r\n\r\n            if (! obj.options.time) {\r\n                obj.close();\r\n            } else {\r\n                obj.date[3] = calendarSelectHour.value;\r\n                obj.date[4] = calendarSelectMin.value;\r\n            }\r\n        }\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    /**\r\n     * Set to blank\r\n     */\r\n    obj.reset = function() {\r\n        // Close calendar\r\n        obj.setValue('');\r\n        obj.date = null;\r\n        obj.close(false, false);\r\n    }\r\n\r\n    /**\r\n     * Get calendar days\r\n     */\r\n    obj.getDays = function() {\r\n        // Mode\r\n        obj.options.mode = 'days';\r\n\r\n        // Setting current values in case of NULLs\r\n        var date = new Date();\r\n\r\n        // Current selection\r\n        var year = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : parseInt(date.getFullYear());\r\n        var month = obj.date && jSuites.isNumeric(obj.date[1]) ? obj.date[1] : parseInt(date.getMonth()) + 1;\r\n        var day = obj.date && jSuites.isNumeric(obj.date[2]) ? obj.date[2] : parseInt(date.getDate());\r\n        var hour = obj.date && jSuites.isNumeric(obj.date[3]) ? obj.date[3] : parseInt(date.getHours());\r\n        var min = obj.date && jSuites.isNumeric(obj.date[4]) ? obj.date[4] : parseInt(date.getMinutes());\r\n\r\n        // Selection container\r\n        obj.date = [ year, month, day, hour, min, 0 ];\r\n\r\n        // Update title\r\n        calendarLabelYear.innerHTML = year;\r\n        calendarLabelMonth.innerHTML = obj.options.months[month - 1];\r\n\r\n        // Current month and Year\r\n        var isCurrentMonthAndYear = (date.getMonth() == month - 1) && (date.getFullYear() == year) ? true : false;\r\n        var currentDay = date.getDate();\r\n\r\n        // Number of days in the month\r\n        var date = new Date(year, month, 0, 0, 0);\r\n        var numberOfDays = date.getDate();\r\n\r\n        // First day\r\n        var date = new Date(year, month-1, 0, 0, 0);\r\n        var firstDay = date.getDay() + 1;\r\n\r\n        // Index value\r\n        var index = obj.options.startingDay || 0;\r\n\r\n        // First of day relative to the starting calendar weekday\r\n        firstDay = firstDay - index;\r\n\r\n        // Reset table\r\n        calendarBody.innerHTML = '';\r\n\r\n        // Weekdays Row\r\n        var row = document.createElement('tr');\r\n        row.setAttribute('align', 'center');\r\n        calendarBody.appendChild(row);\r\n\r\n        // Create weekdays row\r\n        for (var i = 0; i < 7; i++) {\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-weekday')\r\n            cell.innerHTML = obj.options.weekdays_short[index];\r\n            row.appendChild(cell);\r\n            // Next week day\r\n            index++;\r\n            // Restart index\r\n            if (index > 6) {\r\n                index = 0;\r\n            }\r\n        }\r\n\r\n        // Index of days\r\n        var index = 0;\r\n        var d = 0;\r\n \r\n        // Calendar table\r\n        for (var j = 0; j < 6; j++) {\r\n            // Reset cells container\r\n            var row = document.createElement('tr');\r\n            row.setAttribute('align', 'center');\r\n            // Data control\r\n            var emptyRow = true;\r\n            // Create cells\r\n            for (var i = 0; i < 7; i++) {\r\n                // Create cell\r\n                var cell = document.createElement('td');\r\n                cell.classList.add('jcalendar-set-day');\r\n\r\n                if (index >= firstDay && index < (firstDay + numberOfDays)) {\r\n                    // Day cell\r\n                    d++;\r\n                    cell.innerHTML = d;\r\n\r\n                    // Selected\r\n                    if (d == day) {\r\n                        cell.classList.add('jcalendar-selected');\r\n                    }\r\n\r\n                    // Current selection day is today\r\n                    if (isCurrentMonthAndYear && currentDay == d) {\r\n                        cell.style.fontWeight = 'bold';\r\n                    }\r\n\r\n                    // Current selection day\r\n                    var current = jSuites.calendar.now(new Date(year, month-1, d), true);\r\n\r\n                    // Available ranges\r\n                    if (obj.options.validRange) {\r\n                        if (! obj.options.validRange[0] || current >= obj.options.validRange[0]) {\r\n                            var test1 = true;\r\n                        } else {\r\n                            var test1 = false;\r\n                        }\r\n\r\n                        if (! obj.options.validRange[1] || current <= obj.options.validRange[1]) {\r\n                            var test2 = true;\r\n                        } else {\r\n                            var test2 = false;\r\n                        }\r\n\r\n                        if (! (test1 && test2)) {\r\n                            cell.classList.add('jcalendar-disabled');\r\n                        }\r\n                    }\r\n\r\n                    // Control\r\n                    emptyRow = false;\r\n                }\r\n                // Day cell\r\n                row.appendChild(cell);\r\n                // Index\r\n                index++;\r\n            }\r\n\r\n            // Add cell to the calendar body\r\n            if (emptyRow == false) {\r\n                calendarBody.appendChild(row);\r\n            }\r\n        }\r\n\r\n        // Show time controls\r\n        if (obj.options.time) {\r\n            calendarControlsTime.style.display = '';\r\n        } else {\r\n            calendarControlsTime.style.display = 'none';\r\n        }\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.getMonths = function() {\r\n        // Mode\r\n        obj.options.mode = 'months';\r\n\r\n        // Loading month labels\r\n        var months = obj.options.months;\r\n\r\n        // Value\r\n        var value = obj.options.value; \r\n\r\n        // Current date\r\n        var date = new Date();\r\n        var currentYear = parseInt(date.getFullYear());\r\n        var currentMonth = parseInt(date.getMonth()) + 1;\r\n        var selectedYear = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : currentYear;\r\n        var selectedMonth = obj.date && jSuites.isNumeric(obj.date[1]) ? obj.date[1] : currentMonth;\r\n\r\n        // Update title\r\n        calendarLabelYear.innerHTML = obj.date[0];\r\n        calendarLabelMonth.innerHTML = months[selectedMonth-1];\r\n\r\n        // Table\r\n        var table = document.createElement('table');\r\n        table.setAttribute('width', '100%');\r\n\r\n        // Row\r\n        var row = null;\r\n\r\n        // Calendar table\r\n        for (var i = 0; i < 12; i++) {\r\n            if (! (i % 4)) {\r\n                // Reset cells container\r\n                var row = document.createElement('tr');\r\n                row.setAttribute('align', 'center');\r\n                table.appendChild(row);\r\n            }\r\n\r\n            // Create cell\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-set-month');\r\n            cell.setAttribute('data-value', i+1);\r\n            cell.innerText = months[i];\r\n\r\n            if (obj.options.validRange) {\r\n                var current = selectedYear + '-' + jSuites.two(i+1);\r\n                if (! obj.options.validRange[0] || current >= obj.options.validRange[0].substr(0,7)) {\r\n                    var test1 = true;\r\n                } else {\r\n                    var test1 = false;\r\n                }\r\n\r\n                if (! obj.options.validRange[1] || current <= obj.options.validRange[1].substr(0,7)) {\r\n                    var test2 = true;\r\n                } else {\r\n                    var test2 = false;\r\n                }\r\n\r\n                if (! (test1 && test2)) {\r\n                    cell.classList.add('jcalendar-disabled');\r\n                }\r\n            }\r\n\r\n            if (i+1 == selectedMonth) {\r\n                cell.classList.add('jcalendar-selected');\r\n            }\r\n\r\n            if (currentYear == selectedYear && i+1 == currentMonth) {\r\n                cell.style.fontWeight = 'bold';\r\n            }\r\n\r\n            row.appendChild(cell);\r\n        }\r\n\r\n        calendarBody.innerHTML = '<tr><td colspan=\"7\"></td></tr>';\r\n        calendarBody.children[0].children[0].appendChild(table);\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.getYears = function() { \r\n        // Mode\r\n        obj.options.mode = 'years';\r\n\r\n        // Current date\r\n        var date = new Date();\r\n        var currentYear = date.getFullYear();\r\n        var selectedYear = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : parseInt(date.getFullYear());\r\n\r\n        // Array of years\r\n        var y = [];\r\n        for (var i = 0; i < 25; i++) {\r\n            y[i] = parseInt(obj.date[0]) + (i - 12);\r\n        }\r\n\r\n        // Assembling the year tables\r\n        var table = document.createElement('table');\r\n        table.setAttribute('width', '100%');\r\n\r\n        for (var i = 0; i < 25; i++) {\r\n            if (! (i % 5)) {\r\n                // Reset cells container\r\n                var row = document.createElement('tr');\r\n                row.setAttribute('align', 'center');\r\n                table.appendChild(row);\r\n            }\r\n\r\n            // Create cell\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-set-year');\r\n            cell.innerText = y[i];\r\n\r\n            if (selectedYear == y[i]) {\r\n                cell.classList.add('jcalendar-selected');\r\n            }\r\n\r\n            if (currentYear == y[i]) {\r\n                cell.style.fontWeight = 'bold';\r\n            }\r\n\r\n            row.appendChild(cell);\r\n        }\r\n\r\n        calendarBody.innerHTML = '<tr><td colspan=\"7\"></td></tr>';\r\n        calendarBody.firstChild.firstChild.appendChild(table);\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.setLabel = function(value, mixed) {\r\n        return jSuites.calendar.getDateString(value, mixed);\r\n    }\r\n\r\n    obj.fromFormatted = function (value, format) {\r\n        return jSuites.calendar.extractDateFromString(value, format);\r\n    }\r\n\r\n    var mouseUpControls = function(e) {\r\n        var element = jSuites.findElement(e.target, 'jcalendar-container');\r\n        if (element) {\r\n            var action = e.target.className;\r\n\r\n            // Object id\r\n            if (action == 'jcalendar-prev') {\r\n                obj.prev();\r\n            } else if (action == 'jcalendar-next') {\r\n                obj.next();\r\n            } else if (action == 'jcalendar-month') {\r\n                obj.getMonths();\r\n            } else if (action == 'jcalendar-year') {\r\n                obj.getYears();\r\n            } else if (action == 'jcalendar-set-year') {\r\n                obj.date[0] = e.target.innerText;\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.getMonths();\r\n                } else {\r\n                    obj.getDays();\r\n                }\r\n            } else if (e.target.classList.contains('jcalendar-set-month')) {\r\n                var month = parseInt(e.target.getAttribute('data-value'));\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.update(e.target, month);\r\n                } else {\r\n                    obj.date[1] = month;\r\n                    obj.getDays();\r\n                }\r\n            } else if (action == 'jcalendar-confirm' || action == 'jcalendar-update' || action == 'jcalendar-close') {\r\n                obj.close();\r\n            } else if (action == 'jcalendar-backdrop') {\r\n                obj.close(false, false);\r\n            } else if (action == 'jcalendar-reset') {\r\n                obj.reset();\r\n            } else if (e.target.classList.contains('jcalendar-set-day') && e.target.innerText) {\r\n                obj.update(e.target);\r\n            }\r\n        } else {\r\n            obj.close();\r\n        }\r\n    }\r\n\r\n    var keyUpControls = function(e) {\r\n        if (e.target.value && e.target.value.length > 3) {\r\n            var test = jSuites.calendar.extractDateFromString(e.target.value, obj.options.format);\r\n            if (test) {\r\n                obj.setValue(test);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Update actions button\r\n    var updateActions = function() {\r\n        var currentDay = calendar.querySelector('.jcalendar-selected');\r\n\r\n        if (currentDay && currentDay.classList.contains('jcalendar-disabled')) {\r\n            calendarControlsUpdateButton.setAttribute('disabled', 'disabled');\r\n            calendarSelectHour.setAttribute('disabled', 'disabled');\r\n            calendarSelectMin.setAttribute('disabled', 'disabled');\r\n        } else {\r\n            calendarControlsUpdateButton.removeAttribute('disabled');\r\n            calendarSelectHour.removeAttribute('disabled');\r\n            calendarSelectMin.removeAttribute('disabled');\r\n        }\r\n\r\n        // Event\r\n        if (typeof(obj.options.onupdate) == 'function') {\r\n            obj.options.onupdate(el, obj.getValue());\r\n        }\r\n    }\r\n\r\n    var calendar = null;\r\n    var calendarReset = null;\r\n    var calendarConfirm = null;\r\n    var calendarContainer = null;\r\n    var calendarContent = null;\r\n    var calendarLabelYear = null;\r\n    var calendarLabelMonth = null;\r\n    var calendarTable = null;\r\n    var calendarBody = null;\r\n\r\n    var calendarControls = null;\r\n    var calendarControlsTime = null;\r\n    var calendarControlsUpdate = null;\r\n    var calendarControlsUpdateButton = null;\r\n    var calendarSelectHour = null;\r\n    var calendarSelectMin = null;\r\n\r\n    var init = function() {\r\n        // Get value from initial element if that is an input\r\n        if (el.tagName == 'INPUT' && el.value) {\r\n            options.value = el.value;\r\n        }\r\n\r\n        // Calendar DOM elements\r\n        calendarReset = document.createElement('div');\r\n        calendarReset.className = 'jcalendar-reset';\r\n\r\n        calendarConfirm = document.createElement('div');\r\n        calendarConfirm.className = 'jcalendar-confirm';\r\n\r\n        calendarControls = document.createElement('div');\r\n        calendarControls.className = 'jcalendar-controls'\r\n        calendarControls.style.borderBottom = '1px solid #ddd';\r\n        calendarControls.appendChild(calendarReset);\r\n        calendarControls.appendChild(calendarConfirm);\r\n\r\n        calendarContainer = document.createElement('div');\r\n        calendarContainer.className = 'jcalendar-container';\r\n\r\n        calendarContent = document.createElement('div');\r\n        calendarContent.className = 'jcalendar-content';\r\n        calendarContainer.appendChild(calendarContent);\r\n\r\n        // Main element\r\n        if (el.tagName == 'DIV') {\r\n            calendar = el;\r\n            calendar.classList.add('jcalendar-inline');\r\n        } else {\r\n            // Add controls to the screen\r\n            calendarContent.appendChild(calendarControls);\r\n\r\n            calendar = document.createElement('div');\r\n            calendar.className = 'jcalendar';\r\n        }\r\n        calendar.classList.add('jcalendar-container');\r\n        calendar.appendChild(calendarContainer);\r\n\r\n        // Table container\r\n        var calendarTableContainer = document.createElement('div');\r\n        calendarTableContainer.className = 'jcalendar-table';\r\n        calendarContent.appendChild(calendarTableContainer);\r\n\r\n        // Previous button\r\n        var calendarHeaderPrev = document.createElement('td');\r\n        calendarHeaderPrev.setAttribute('colspan', '2');\r\n        calendarHeaderPrev.className = 'jcalendar-prev';\r\n\r\n        // Header with year and month\r\n        calendarLabelYear = document.createElement('span');\r\n        calendarLabelYear.className = 'jcalendar-year';\r\n        calendarLabelMonth = document.createElement('span');\r\n        calendarLabelMonth.className = 'jcalendar-month';\r\n\r\n        var calendarHeaderTitle = document.createElement('td');\r\n        calendarHeaderTitle.className = 'jcalendar-header';\r\n        calendarHeaderTitle.setAttribute('colspan', '3');\r\n        calendarHeaderTitle.appendChild(calendarLabelMonth);\r\n        calendarHeaderTitle.appendChild(calendarLabelYear);\r\n\r\n        var calendarHeaderNext = document.createElement('td');\r\n        calendarHeaderNext.setAttribute('colspan', '2');\r\n        calendarHeaderNext.className = 'jcalendar-next';\r\n\r\n        var calendarHeader = document.createElement('thead');\r\n        var calendarHeaderRow = document.createElement('tr');\r\n        calendarHeaderRow.appendChild(calendarHeaderPrev);\r\n        calendarHeaderRow.appendChild(calendarHeaderTitle);\r\n        calendarHeaderRow.appendChild(calendarHeaderNext);\r\n        calendarHeader.appendChild(calendarHeaderRow);\r\n\r\n        calendarTable = document.createElement('table');\r\n        calendarBody = document.createElement('tbody');\r\n        calendarTable.setAttribute('cellpadding', '0');\r\n        calendarTable.setAttribute('cellspacing', '0');\r\n        calendarTable.appendChild(calendarHeader);\r\n        calendarTable.appendChild(calendarBody);\r\n        calendarTableContainer.appendChild(calendarTable);\r\n\r\n        calendarSelectHour = document.createElement('select');\r\n        calendarSelectHour.className = 'jcalendar-select';\r\n        calendarSelectHour.onchange = function() {\r\n            obj.date[3] = this.value; \r\n\r\n            // Event\r\n            if (typeof(obj.options.onupdate) == 'function') {\r\n                obj.options.onupdate(el, obj.getValue());\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 24; i++) {\r\n            var element = document.createElement('option');\r\n            element.value = i;\r\n            element.innerHTML = jSuites.two(i);\r\n            calendarSelectHour.appendChild(element);\r\n        }\r\n\r\n        calendarSelectMin = document.createElement('select');\r\n        calendarSelectMin.className = 'jcalendar-select';\r\n        calendarSelectMin.onchange = function() {\r\n            obj.date[4] = this.value;\r\n\r\n            // Event\r\n            if (typeof(obj.options.onupdate) == 'function') {\r\n                obj.options.onupdate(el, obj.getValue());\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 60; i++) {\r\n            var element = document.createElement('option');\r\n            element.value = i;\r\n            element.innerHTML = jSuites.two(i);\r\n            calendarSelectMin.appendChild(element);\r\n        }\r\n\r\n        // Footer controls\r\n        var calendarControlsFooter = document.createElement('div');\r\n        calendarControlsFooter.className = 'jcalendar-controls';\r\n\r\n        calendarControlsTime = document.createElement('div');\r\n        calendarControlsTime.className = 'jcalendar-time';\r\n        calendarControlsTime.style.maxWidth = '140px';\r\n        calendarControlsTime.appendChild(calendarSelectHour);\r\n        calendarControlsTime.appendChild(calendarSelectMin);\r\n\r\n        calendarControlsUpdateButton = document.createElement('button');\r\n        calendarControlsUpdateButton.setAttribute('type', 'button');\r\n        calendarControlsUpdateButton.className = 'jcalendar-update';\r\n\r\n        calendarControlsUpdate = document.createElement('div');\r\n        calendarControlsUpdate.style.flexGrow = '10';\r\n        calendarControlsUpdate.appendChild(calendarControlsUpdateButton);\r\n        calendarControlsFooter.appendChild(calendarControlsTime);\r\n\r\n        // Only show the update button for input elements\r\n        if (el.tagName == 'INPUT') {\r\n            calendarControlsFooter.appendChild(calendarControlsUpdate);\r\n        }\r\n\r\n        calendarContent.appendChild(calendarControlsFooter);\r\n\r\n        var calendarBackdrop = document.createElement('div');\r\n        calendarBackdrop.className = 'jcalendar-backdrop';\r\n        calendar.appendChild(calendarBackdrop);\r\n\r\n        // Handle events\r\n        el.addEventListener(\"keyup\", keyUpControls);\r\n\r\n        // Add global events\r\n        calendar.addEventListener(\"swipeleft\", function(e) {\r\n            jSuites.animation.slideLeft(calendarTable, 0, function() {\r\n                obj.next();\r\n                jSuites.animation.slideRight(calendarTable, 1);\r\n            });\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n\r\n        calendar.addEventListener(\"swiperight\", function(e) {\r\n            jSuites.animation.slideRight(calendarTable, 0, function() {\r\n                obj.prev();\r\n                jSuites.animation.slideLeft(calendarTable, 1);\r\n            });\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n\r\n        el.onmouseup = function() {\r\n            obj.open();\r\n        }\r\n\r\n        if ('ontouchend' in document.documentElement === true) {\r\n            calendar.addEventListener(\"touchend\", mouseUpControls);\r\n        } else {\r\n            calendar.addEventListener(\"mouseup\", mouseUpControls);\r\n        }\r\n\r\n        // Global controls\r\n        if (! jSuites.calendar.hasEvents) {\r\n            // Execute only one time\r\n            jSuites.calendar.hasEvents = true;\r\n            // Enter and Esc\r\n            document.addEventListener(\"keydown\", jSuites.calendar.keydown);\r\n        }\r\n\r\n        // Set configuration\r\n        obj.setOptions(options);\r\n\r\n        // Append element to the DOM\r\n        if (el.tagName == 'INPUT') {\r\n            el.parentNode.insertBefore(calendar, el.nextSibling);\r\n            // Add properties\r\n            el.setAttribute('autocomplete', 'off');\r\n            // Element\r\n            el.classList.add('jcalendar-input');\r\n            // Value\r\n            el.value = obj.setLabel(obj.getValue(), obj.options);\r\n        } else {\r\n            // Get days\r\n            obj.getDays();\r\n            // Hour\r\n            if (obj.options.time) {\r\n                calendarSelectHour.value = obj.date[3];\r\n                calendarSelectMin.value = obj.date[4];\r\n            }\r\n        }\r\n\r\n        // Default opened\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n\r\n        // Change method\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.calendar = calendar.calendar = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.calendar.keydown = function(e) {\r\n    var calendar = null;\r\n    if (calendar = jSuites.calendar.current) { \r\n        if (e.which == 13) {\r\n            // ENTER\r\n            calendar.close(false, true);\r\n        } else if (e.which == 27) {\r\n            // ESC\r\n            calendar.close(false, false);\r\n        }\r\n    }\r\n}\r\n\r\njSuites.calendar.prettify = function(d, texts) {\r\n    if (! texts) {\r\n        var texts = {\r\n            justNow: 'Just now',\r\n            xMinutesAgo: '{0}m ago',\r\n            xHoursAgo: '{0}h ago',\r\n            xDaysAgo: '{0}d ago',\r\n            xWeeksAgo: '{0}w ago',\r\n            xMonthsAgo: '{0} mon ago',\r\n            xYearsAgo: '{0}y ago',\r\n        }\r\n    }\r\n\r\n    var d1 = new Date();\r\n    var d2 = new Date(d);\r\n    var total = parseInt((d1 - d2) / 1000 / 60);\r\n\r\n    String.prototype.format = function(o) {\r\n        return this.replace('{0}', o);\r\n    }\r\n\r\n    if (total == 0) {\r\n        var text = texts.justNow;\r\n    } else if (total < 90) {\r\n        var text = texts.xMinutesAgo.format(total);\r\n    } else if (total < 1440) { // One day\r\n        var text = texts.xHoursAgo.format(Math.round(total/60));\r\n    } else if (total < 20160) { // 14 days\r\n        var text = texts.xDaysAgo.format(Math.round(total / 1440));\r\n    } else if (total < 43200) { // 30 days\r\n        var text = texts.xWeeksAgo.format(Math.round(total / 10080));\r\n    } else if (total < 1036800) { // 24 months\r\n        var text = texts.xMonthsAgo.format(Math.round(total / 43200));\r\n    } else { // 24 months+\r\n        var text = texts.xYearsAgo.format(Math.round(total / 525600));\r\n    }\r\n\r\n    return text;\r\n}\r\n\r\njSuites.calendar.prettifyAll = function() {\r\n    var elements = document.querySelectorAll('.prettydate');\r\n    for (var i = 0; i < elements.length; i++) {\r\n        if (elements[i].getAttribute('data-date')) {\r\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].getAttribute('data-date'));\r\n        } else {\r\n            elements[i].setAttribute('data-date', elements[i].innerHTML);\r\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].innerHTML);\r\n        }\r\n    }\r\n}\r\n\r\njSuites.calendar.now = function(date, dateOnly) {\r\n    if (Array.isArray(date)) {\r\n        var y = date[0];\r\n        var m = date[1];\r\n        var d = date[2];\r\n        var h = date[3];\r\n        var i = date[4];\r\n        var s = date[5];\r\n    } else {\r\n        if (! date) {\r\n            var date = new Date();\r\n        }\r\n        var y = date.getFullYear();\r\n        var m = date.getMonth() + 1;\r\n        var d = date.getDate();\r\n        var h = date.getHours();\r\n        var i = date.getMinutes();\r\n        var s = date.getSeconds();\r\n    }\r\n\r\n    if (dateOnly == true) {\r\n        return jSuites.two(y) + '-' + jSuites.two(m) + '-' + jSuites.two(d);\r\n    } else {\r\n        return jSuites.two(y) + '-' + jSuites.two(m) + '-' + jSuites.two(d) + ' ' + jSuites.two(h) + ':' + jSuites.two(i) + ':' + jSuites.two(s);\r\n    }\r\n}\r\n\r\njSuites.calendar.toArray = function(value) {\r\n    var date = value.split(((value.indexOf('T') !== -1) ? 'T' : ' '));\r\n    var time = date[1];\r\n    var date = date[0].split('-');\r\n    var y = parseInt(date[0]);\r\n    var m = parseInt(date[1]);\r\n    var d = parseInt(date[2]);\r\n\r\n    if (time) {\r\n        var time = time.split(':');\r\n        var h = parseInt(time[0]);\r\n        var i = parseInt(time[1]);\r\n    } else {\r\n        var h = 0;\r\n        var i = 0;\r\n    }\r\n    return [ y, m, d, h, i, 0 ];\r\n}\r\n\r\n// Helper to extract date from a string\r\njSuites.calendar.extractDateFromString = function(date, format) {\r\n    if (date > 0 && Number(date) == date) {\r\n        var d = new Date(Math.round((date - 25569)*86400*1000));\r\n        return d.getFullYear() + \"-\" + jSuites.two(d.getMonth()) + \"-\" + jSuites.two(d.getDate()) + ' 00:00:00';\r\n    }\r\n\r\n    var v1 = '' + date;\r\n    var v2 = format.replace(/[0-9]/g,'');\r\n\r\n    var test = 1;\r\n\r\n    // Get year\r\n    var y = v2.search(\"YYYY\");\r\n    y = v1.substr(y,4);\r\n    if (parseInt(y) != y) {\r\n        test = 0;\r\n    }\r\n\r\n    // Get month\r\n    var m = v2.search(\"MM\");\r\n    m = v1.substr(m,2);\r\n    if (parseInt(m) != m || m > 12) {\r\n        test = 0;\r\n    }\r\n\r\n    // Get day\r\n    var d = v2.search(\"DD\");\r\n    if (d >= 0) {\r\n        d = v1.substr(d,2);\r\n        if (parseInt(d) != d  || d > 31) {\r\n            test = 0;\r\n        }\r\n    } else {\r\n        d = '01';\r\n    }\r\n\r\n    // Get hour\r\n    var h = v2.search(\"HH\");\r\n    if (h >= 0) {\r\n        h = v1.substr(h,2);\r\n        if (! parseInt(h) || h > 23) {\r\n            h = '00';\r\n        }\r\n    } else {\r\n        h = '00';\r\n    }\r\n\r\n    // Get minutes\r\n    var i = v2.search(\"MI\");\r\n    if (i >= 0) {\r\n        i = v1.substr(i,2);\r\n        if (! parseInt(i) || i > 59) {\r\n            i = '00';\r\n        }\r\n    } else {\r\n        i = '00';\r\n    }\r\n\r\n    // Get seconds\r\n    var s = v2.search(\"SS\");\r\n    if (s >= 0) {\r\n        s = v1.substr(s,2);\r\n        if (! parseInt(s) || s > 59) {\r\n            s = '00';\r\n        }\r\n    } else {\r\n        s = '00';\r\n    }\r\n\r\n    if (test == 1 && date.length == v2.length) {\r\n        // Update source\r\n        return y + '-' + m + '-' + d + ' ' + h + ':' +  i + ':' + s;\r\n    }\r\n\r\n    return '';\r\n}\r\n\r\n/**\r\n * Date to number\r\n */\r\njSuites.calendar.dateToNum = function(a, b) {\r\n    a = new Date(a);\r\n    if (! b) {\r\n        b = '1899-12-30 ' + a.getHours() + ':' + a.getMinutes() + ':' + a.getSeconds();\r\n    }\r\n    b = new Date(b);\r\n    var v = a.getTime() - b.getTime();\r\n    return Math.round(v / 86400000);\r\n}\r\n\r\n/**\r\n * Number to date\r\n */\r\njSuites.calendar.numToDate = function(value) {\r\n    var d = new Date(Math.round((value - 25569)*86400*1000));\r\n    return d.getFullYear() + \"-\" + jSuites.two(d.getMonth()+1) + \"-\" + jSuites.two(d.getDate()) + ' 00:00:00';\r\n}\r\n\r\n// Helper to convert date into string\r\njSuites.calendar.getDateString = function(value, options) {\r\n    if (! options) {\r\n        var options = {};\r\n    }\r\n\r\n    // Labels\r\n    if (options && typeof(options) == 'object') {\r\n        var format = options.format;\r\n    } else {\r\n        var format = options;\r\n    }\r\n\r\n    if (! format) {\r\n        format = 'YYYY-MM-DD';\r\n    }\r\n\r\n    // Convert to number of hours\r\n    if (typeof(value) == 'number' && format.indexOf('[h]') >= 0) {\r\n        var result = parseFloat(24 * Number(value));\r\n        if (format.indexOf('mm') >= 0) {\r\n            var h = (''+result).split('.');\r\n            if (h[1]) {\r\n                var d = 60 * parseFloat('0.' + h[1])\r\n                d = parseFloat(d.toFixed(2));\r\n            } else {\r\n                var d = 0;\r\n            }\r\n            result = parseInt(h[0]) + ':' + jSuites.two(d);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // Date instance\r\n    if (value instanceof Date) {\r\n        value = jSuites.calendar.now(value);\r\n    } else if (value && jSuites.isNumeric(value)) {\r\n        value = jSuites.calendar.numToDate(value);\r\n    }\r\n\r\n    // Tokens\r\n    var tokens = [ 'DAY', 'WD', 'DDDD', 'DDD', 'DD', 'D', 'Q', 'HH24', 'HH12', 'HH', 'H', 'AM/PM', 'MI', 'SS', 'MS', 'YYYY', 'YYY', 'YY', 'Y', 'MONTH', 'MON', 'MMMMM', 'MMMM', 'MMM', 'MM', 'M', '.' ];\r\n\r\n    // Expression to extract all tokens from the string\r\n    var e = new RegExp(tokens.join('|'), 'gi');\r\n    // Extract\r\n    var t = format.match(e);\r\n\r\n    // Compatibility with excel\r\n    for (var i = 0; i < t.length; i++) {\r\n        if (t[i].toUpperCase() == 'MM') {\r\n            // Not a month, correct to minutes\r\n            if (t[i-1] && t[i-1].toUpperCase().indexOf('H') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i-2] && t[i-2].toUpperCase().indexOf('H') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i+1] && t[i+1].toUpperCase().indexOf('S') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i+2] && t[i+2].toUpperCase().indexOf('S') >= 0) {\r\n                t[i] = 'mi';\r\n            }\r\n        }\r\n    }\r\n\r\n    // Object\r\n    var o = {\r\n        tokens: t\r\n    }\r\n\r\n    // Value\r\n    if (value) {\r\n        var d = ''+value;\r\n        var splitStr = (d.indexOf('T') !== -1) ? 'T' : ' ';\r\n        d = d.split(splitStr);\r\n \r\n        var h = 0;\r\n        var m = 0;\r\n        var s = 0;\r\n\r\n        if (d[1]) {\r\n            h = d[1].split(':');\r\n            m = h[1] ? h[1] : 0;\r\n            s = h[2] ? h[2] : 0;\r\n            h = h[0] ? h[0] : 0;\r\n        }\r\n\r\n        d = d[0].split('-');\r\n\r\n        if (d[0] && d[1] && d[2] && d[0] > 0 && d[1] > 0 && d[1] < 13 && d[2] > 0 && d[2] < 32) {\r\n\r\n            // Data\r\n            o.data = [ d[0], d[1], d[2], h, m, s ];\r\n\r\n            // Value\r\n            o.value = [];\r\n\r\n            // Calendar instance\r\n            var calendar = new Date(o.data[0], o.data[1]-1, o.data[2], o.data[3], o.data[4], o.data[5]);\r\n\r\n            // Get method\r\n            var get = function(i) {\r\n                // Token\r\n                var t = this.tokens[i];\r\n                // Case token\r\n                var s = t.toUpperCase();\r\n                var v = null;\r\n\r\n                if (s === 'YYYY') {\r\n                    v = this.data[0];\r\n                } else if (s === 'YYY') {\r\n                    v = this.data[0].substring(1,4);\r\n                } else if (s === 'YY') {\r\n                    v = this.data[0].substring(2,4);\r\n                } else if (s === 'Y') {\r\n                    v = this.data[0].substring(3,4);\r\n                } else if (t === 'MON') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3).toUpperCase();\r\n                } else if (t === 'mon') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3).toLowerCase();\r\n                } else if (t === 'MONTH') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].toUpperCase();\r\n                } else if (t === 'month') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].toLowerCase();\r\n                } else if (s === 'MMMMM') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0, 1);\r\n                } else if (s === 'MMMM' || t === 'Month') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()];\r\n                } else if (s === 'MMM' || t == 'Mon') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3);\r\n                } else if (s === 'MM') {\r\n                    v = jSuites.two(this.data[1]);\r\n                } else if (s === 'M') {\r\n                    v = calendar.getMonth()+1;\r\n                } else if (t === 'DAY') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].toUpperCase();\r\n                } else if (t === 'day') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].toLowerCase();\r\n                } else if (s === 'DDDD' || t == 'Day') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()];\r\n                } else if (s === 'DDD') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].substr(0,3);\r\n                } else if (s === 'DD') {\r\n                    v = jSuites.two(this.data[2]);\r\n                } else if (s === 'D') {\r\n                    v = this.data[2];\r\n                } else if (s === 'Q') {\r\n                    v = Math.floor((calendar.getMonth() + 3) / 3);\r\n                } else if (s === 'HH24' || s === 'HH') {\r\n                    v = jSuites.two(this.data[3]);\r\n                } else if (s === 'HH12') {\r\n                    if (this.data[3] > 12) {\r\n                        v = jSuites.two(this.data[3] - 12);\r\n                    } else {\r\n                        v = jSuites.two(this.data[3]);\r\n                    }\r\n                } else if (s === 'H') {\r\n                    v = this.data[3];\r\n                } else if (s === 'MI') {\r\n                    v = jSuites.two(this.data[4]);\r\n                } else if (s === 'SS') {\r\n                    v = jSuites.two(this.data[5]);\r\n                } else if (s === 'MS') {\r\n                    v = calendar.getMilliseconds();\r\n                } else if (s === 'AM/PM') {\r\n                    if (this.data[3] >= 12) {\r\n                        v = 'PM';\r\n                    } else {\r\n                        v = 'AM';\r\n                    }\r\n                } else if (s === 'WD') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()];\r\n                }\r\n\r\n                if (v === null) {\r\n                    this.value[i] = this.tokens[i];\r\n                } else {\r\n                    this.value[i] = v;\r\n                }\r\n            }\r\n\r\n            for (var i = 0; i < o.tokens.length; i++) {\r\n                get.call(o, i);\r\n            }\r\n            // Put pieces together\r\n            value = o.value.join('');\r\n        } else {\r\n            value = '';\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n// Jsuites calendar labels\r\njSuites.calendar.weekdays = [ 'Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday' ];\r\njSuites.calendar.months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\r\njSuites.calendar.weekdaysShort = [ 'Sun','Mon','Tue','Wed','Thu','Fri','Sat' ];\r\njSuites.calendar.monthsShort = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n\r\n\r\njSuites.color = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.color) {\r\n        return el.color.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'color' };\r\n    obj.options = {};\r\n\r\n    var container = null;\r\n    var backdrop = null;\r\n    var content = null;\r\n    var resetButton = null;\r\n    var closeButton = null;\r\n    var tabs = null;\r\n    var jsuitesTabs = null;\r\n\r\n    /**\r\n     * Update options\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        /**\r\n         * @typedef {Object} defaults\r\n         * @property {(string|Array)} value - Initial value of the compontent\r\n         * @property {string} placeholder - The default instruction text on the element\r\n         * @property {requestCallback} onchange - Method to be execute after any changes on the element\r\n         * @property {requestCallback} onclose - Method to be execute when the element is closed\r\n         * @property {string} doneLabel - Label for button done\r\n         * @property {string} resetLabel - Label for button reset\r\n         * @property {string} resetValue - Value for button reset\r\n         * @property {Bool} showResetButton - Active or note for button reset - default false\r\n         */\r\n        var defaults = {\r\n            placeholder: '',\r\n            value: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onchange: null,\r\n            closeOnChange: true,\r\n            palette: null,\r\n            position: null,\r\n            doneLabel: 'Done',\r\n            resetLabel: 'Reset',\r\n            fullscreen: false,\r\n            opened: false,\r\n        }\r\n\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        if (options && ! options.palette) {\r\n            // Default pallete\r\n            options.palette = jSuites.palette();\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Update the text of the controls, if they have already been created\r\n        if (resetButton) {\r\n            resetButton.innerHTML = obj.options.resetLabel;\r\n        }\r\n        if (closeButton) {\r\n            closeButton.innerHTML = obj.options.doneLabel;\r\n        }\r\n\r\n        // Update the pallete\r\n        if (obj.options.palette && jsuitesTabs) {\r\n            jsuitesTabs.updateContent(0, table());\r\n        }\r\n\r\n        // Value\r\n        if (typeof obj.options.value === 'string') {\r\n            el.value = obj.options.value;\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            if (el.getAttribute('placeholder')) {\r\n                el.removeAttribute('placeholder');\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Open color pallete\r\n     */\r\n    obj.open = function() {\r\n        if (! container.classList.contains('jcolor-focus')) {\r\n            // Start tracking\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Show colorpicker\r\n            container.classList.add('jcolor-focus');\r\n\r\n            var rectContent = content.getBoundingClientRect();\r\n\r\n            if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen == true) {\r\n                content.style.top = '';\r\n                content.classList.add('jcolor-fullscreen');\r\n                jSuites.animation.slideBottom(content, 1);\r\n                backdrop.style.display = 'block';\r\n            } else {\r\n                if (content.classList.contains('jcolor-fullscreen')) {\r\n                    content.classList.remove('jcolor-fullscreen');\r\n                    backdrop.style.display = '';\r\n                }\r\n\r\n                var rect = el.getBoundingClientRect();\r\n\r\n                if (obj.options.position) {\r\n                    content.style.position = 'fixed';\r\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                        content.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                    } else {\r\n                        content.style.top = (rect.top + rect.height + 2) + 'px';\r\n                    }\r\n                    content.style.left = rect.left + 'px';\r\n                } else {\r\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                        content.style.top = -1 * (rectContent.height + rect.height + 2) + 'px';\r\n                    } else {\r\n                        content.style.top = '2px';\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (typeof(obj.options.onopen) == 'function') {\r\n                obj.options.onopen(el);\r\n            }\r\n\r\n            jsuitesTabs.setBorder(jsuitesTabs.getActive());\r\n\r\n            // Update sliders\r\n            if (obj.options.value) {\r\n                var rgb = HexToRgb(obj.options.value);\r\n\r\n                rgbInputs.forEach(function(rgbInput, index) {\r\n                    rgbInput.value = rgb[index];\r\n                    rgbInput.dispatchEvent(new Event('input'));\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Close color pallete\r\n     */\r\n    obj.close = function(ignoreEvents) {\r\n        if (container.classList.contains('jcolor-focus')) {\r\n            // Remove focus\r\n            container.classList.remove('jcolor-focus');\r\n            // Make sure backdrop is hidden\r\n            backdrop.style.display = '';\r\n            // Call related events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Stop  the object\r\n            jSuites.tracking(obj, false);\r\n        }\r\n\r\n        return obj.options.value;\r\n    }\r\n\r\n    /**\r\n     * Set value\r\n     */\r\n    obj.setValue = function(color) {\r\n        if (! color) {\r\n            color = '';\r\n        }\r\n\r\n        if (color != obj.options.value) {\r\n            obj.options.value = color;\r\n            slidersResult = color;\r\n\r\n            // Remove current selecded mark\r\n            var selected = container.querySelector('.jcolor-selected');\r\n            if (selected) {\r\n                selected.classList.remove('jcolor-selected');\r\n            }\r\n\r\n            // Mark cell as selected\r\n            if (obj.values[color]) {\r\n                obj.values[color].classList.add('jcolor-selected');\r\n            }\r\n\r\n            // Onchange\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, color);\r\n            }\r\n\r\n            // Changes\r\n            if (el.value != obj.options.value) {\r\n                // Set input value\r\n                el.value = obj.options.value;\r\n                // Element onchange native\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (obj.options.closeOnChange == true) {\r\n                obj.close();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get value\r\n     */\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var backdropClickControl = false;\r\n\r\n    // Converts a number in decimal to hexadecimal\r\n    var decToHex = function(num) {\r\n        var hex = num.toString(16);\r\n        return hex.length === 1 ? \"0\" + hex : hex;\r\n    }\r\n\r\n    // Converts a color in rgb to hexadecimal\r\n    var rgbToHex = function(r, g, b) {\r\n        return \"#\" + decToHex(r) + decToHex(g) + decToHex(b);\r\n    }\r\n\r\n    // Converts a number in hexadecimal to decimal\r\n    var hexToDec = function(hex) {\r\n        return parseInt('0x' + hex);\r\n    }\r\n\r\n    // Converts a color in hexadecimal to rgb\r\n    var HexToRgb = function(hex) {\r\n        return [hexToDec(hex.substr(1, 2)), hexToDec(hex.substr(3, 2)), hexToDec(hex.substr(5, 2))]\r\n    }\r\n\r\n    var table = function() {\r\n        // Content of the first tab\r\n        var tableContainer = document.createElement('div');\r\n        tableContainer.className = 'jcolor-grid';\r\n\r\n        // Cells\r\n        obj.values = [];\r\n\r\n        // Table pallete\r\n        var t = document.createElement('table');\r\n        t.setAttribute('cellpadding', '7');\r\n        t.setAttribute('cellspacing', '0');\r\n\r\n        for (var j = 0; j < obj.options.palette.length; j++) {\r\n            var tr = document.createElement('tr');\r\n            for (var i = 0; i < obj.options.palette[j].length; i++) {\r\n                var td = document.createElement('td');\r\n                var color = obj.options.palette[j][i];\r\n                if (color.length < 7 && color.substr(0,1) !== '#') {\r\n                    color = '#' + color;\r\n                }\r\n                td.style.backgroundColor = color;\r\n                td.setAttribute('data-value', color);\r\n                td.innerHTML = '';\r\n                tr.appendChild(td);\r\n\r\n                // Selected color\r\n                if (obj.options.value == color) {\r\n                    td.classList.add('jcolor-selected');\r\n                }\r\n\r\n                // Possible values\r\n                obj.values[color] = td;\r\n            }\r\n            t.appendChild(tr);\r\n        }\r\n\r\n        // Append to the table\r\n        tableContainer.appendChild(t);\r\n\r\n        // Select color\r\n        tableContainer.addEventListener(\"mousedown\", function(e) {\r\n            if (e.target.tagName == 'TD') {\r\n                var value = e.target.getAttribute('data-value');\r\n                if (value) {\r\n                    obj.setValue(value);\r\n                }\r\n            }\r\n        });\r\n\r\n        return tableContainer;\r\n    }\r\n\r\n    // Canvas where the image will be rendered\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = 200;\r\n    canvas.height = 160;\r\n    var context = canvas.getContext(\"2d\");\r\n\r\n    var resizeCanvas = function() {\r\n        // Specifications necessary to correctly obtain colors later in certain positions\r\n        var m = tabs.firstChild.getBoundingClientRect();\r\n        canvas.width = m.width - 14;\r\n        gradient()\r\n    }\r\n\r\n    var gradient = function() {\r\n        var g = context.createLinearGradient(0, 0, canvas.width, 0);\r\n        // Create color gradient\r\n        g.addColorStop(0,    \"rgb(255,0,0)\");\r\n        g.addColorStop(0.15, \"rgb(255,0,255)\");\r\n        g.addColorStop(0.33, \"rgb(0,0,255)\");\r\n        g.addColorStop(0.49, \"rgb(0,255,255)\");\r\n        g.addColorStop(0.67, \"rgb(0,255,0)\");\r\n        g.addColorStop(0.84, \"rgb(255,255,0)\");\r\n        g.addColorStop(1,    \"rgb(255,0,0)\");\r\n        context.fillStyle = g;\r\n        context.fillRect(0, 0, canvas.width, canvas.height);\r\n        g = context.createLinearGradient(0, 0, 0, canvas.height);\r\n        g.addColorStop(0,   \"rgba(255,255,255,1)\");\r\n        g.addColorStop(0.5, \"rgba(255,255,255,0)\");\r\n        g.addColorStop(0.5, \"rgba(0,0,0,0)\");\r\n        g.addColorStop(1,   \"rgba(0,0,0,1)\");\r\n        context.fillStyle = g;\r\n        context.fillRect(0, 0, canvas.width, canvas.height);\r\n    }\r\n\r\n    var hsl = function() {\r\n        var element = document.createElement('div');\r\n        element.className = \"jcolor-hsl\";\r\n\r\n        var point = document.createElement('div');\r\n        point.className = 'jcolor-point';\r\n\r\n        var div = document.createElement('div');\r\n        div.appendChild(canvas);\r\n        div.appendChild(point);\r\n        element.appendChild(div);\r\n\r\n        // Moves the marquee point to the specified position\r\n        var update = function(buttons, x, y) {\r\n            if (buttons === 1) {\r\n                var rect = element.getBoundingClientRect();\r\n                var left = x - rect.left;\r\n                var top = y - rect.top;\r\n                if (left < 0) {\r\n                    left = 0;\r\n                }\r\n                if (top < 0) {\r\n                    top = 0;\r\n                }\r\n                if (left > rect.width) {\r\n                    left = rect.width;\r\n                }\r\n                if (top > rect.height) {\r\n                    top = rect.height;\r\n                }\r\n                point.style.left = left + 'px';\r\n                point.style.top = top + 'px';\r\n                var pixel = context.getImageData(left, top, 1, 1).data;\r\n                slidersResult = rgbToHex(pixel[0], pixel[1], pixel[2]);\r\n            }\r\n        }\r\n\r\n        // Applies the point's motion function to the div that contains it\r\n        element.addEventListener('mousedown', function(e) {\r\n            update(e.buttons, e.clientX, e.clientY);\r\n        });\r\n\r\n        element.addEventListener('mousemove', function(e) {\r\n            update(e.buttons, e.clientX, e.clientY);\r\n        });\r\n\r\n        element.addEventListener('touchmove', function(e) {\r\n            update(1, e.changedTouches[0].clientX, e.changedTouches[0].clientY);\r\n        });\r\n\r\n        return element;\r\n    }\r\n\r\n    var slidersResult = '';\r\n\r\n    var rgbInputs = [];\r\n\r\n    var changeInputColors = function() {\r\n        if (slidersResult !== '') {\r\n            for (var j = 0; j < rgbInputs.length; j++) {\r\n                var currentColor = HexToRgb(slidersResult);\r\n\r\n                currentColor[j] = 0;\r\n\r\n                var newGradient = 'linear-gradient(90deg, rgb(';\r\n                newGradient += currentColor.join(', ');\r\n                newGradient += '), rgb(';\r\n\r\n                currentColor[j] = 255;\r\n\r\n                newGradient += currentColor.join(', ');\r\n                newGradient += '))';\r\n\r\n                rgbInputs[j].style.backgroundImage = newGradient;\r\n            }\r\n        }\r\n    }\r\n\r\n    var sliders = function() {\r\n        // Content of the third tab\r\n        var slidersElement = document.createElement('div');\r\n        slidersElement.className = 'jcolor-sliders';\r\n\r\n        var slidersBody = document.createElement('div');\r\n\r\n        // Creates a range-type input with the specified name\r\n        var createSliderInput = function(name) {\r\n            var inputContainer = document.createElement('div');\r\n            inputContainer.className = 'jcolor-sliders-input-container';\r\n\r\n            var label = document.createElement('label');\r\n            label.innerText = name;\r\n\r\n            var subContainer = document.createElement('div');\r\n            subContainer.className = 'jcolor-sliders-input-subcontainer';\r\n\r\n            var input = document.createElement('input');\r\n            input.type = 'range';\r\n            input.min = 0;\r\n            input.max = 255;\r\n            input.value = 0;\r\n\r\n            inputContainer.appendChild(label);\r\n            subContainer.appendChild(input);\r\n\r\n            var value = document.createElement('div');\r\n            value.innerText = input.value;\r\n\r\n            input.addEventListener('input', function() {\r\n                value.innerText = input.value;\r\n            });\r\n\r\n            subContainer.appendChild(value);\r\n            inputContainer.appendChild(subContainer);\r\n\r\n            slidersBody.appendChild(inputContainer);\r\n\r\n            return input;\r\n        }\r\n\r\n        // Creates red, green and blue inputs\r\n        rgbInputs = [\r\n            createSliderInput('Red'),\r\n            createSliderInput('Green'),\r\n            createSliderInput('Blue'),\r\n        ];\r\n\r\n        slidersElement.appendChild(slidersBody);\r\n\r\n        // Element that prints the current color\r\n        var slidersResultColor = document.createElement('div');\r\n        slidersResultColor.className = 'jcolor-sliders-final-color';\r\n\r\n        var resultElement = document.createElement('div');\r\n        resultElement.style.visibility = 'hidden';\r\n        resultElement.innerText = 'a';\r\n        slidersResultColor.appendChild(resultElement)\r\n\r\n        // Update the element that prints the current color\r\n        var updateResult = function() {\r\n            var resultColor = rgbToHex(parseInt(rgbInputs[0].value), parseInt(rgbInputs[1].value), parseInt(rgbInputs[2].value));\r\n\r\n            resultElement.innerText = resultColor;\r\n            resultElement.style.color = resultColor;\r\n            resultElement.style.removeProperty('visibility');\r\n\r\n            slidersResult = resultColor;\r\n        }\r\n\r\n        // Apply the update function to color inputs\r\n        rgbInputs.forEach(function(rgbInput) {\r\n            rgbInput.addEventListener('input', function() {\r\n                updateResult();\r\n                changeInputColors();\r\n            });\r\n        });\r\n\r\n        slidersElement.appendChild(slidersResultColor);\r\n\r\n        return slidersElement;\r\n    }\r\n\r\n    var init = function() {\r\n        // Initial options\r\n        obj.setOptions(options);\r\n\r\n        // Add a proper input tag when the element is an input\r\n        if (el.tagName == 'INPUT') {\r\n            el.classList.add('jcolor-input');\r\n            el.readOnly = true;\r\n        }\r\n\r\n        // Table container\r\n        container = document.createElement('div');\r\n        container.className = 'jcolor';\r\n\r\n        // Table container\r\n        backdrop = document.createElement('div');\r\n        backdrop.className = 'jcolor-backdrop';\r\n        container.appendChild(backdrop);\r\n\r\n        // Content\r\n        content = document.createElement('div');\r\n        content.className = 'jcolor-content';\r\n\r\n        // Controls\r\n        var controls = document.createElement('div');\r\n        controls.className = 'jcolor-controls';\r\n        content.appendChild(controls);\r\n\r\n        // Reset button\r\n        resetButton  = document.createElement('div');\r\n        resetButton.className = 'jcolor-reset';\r\n        resetButton.innerHTML = obj.options.resetLabel;\r\n        resetButton.onclick = function(e) {\r\n            obj.setValue('');\r\n            obj.close();\r\n        }\r\n        controls.appendChild(resetButton);\r\n\r\n        // Close button\r\n        closeButton  = document.createElement('div');\r\n        closeButton.className = 'jcolor-close';\r\n        closeButton.innerHTML = obj.options.doneLabel;\r\n        closeButton.onclick = function(e) {\r\n            if (jsuitesTabs.getActive() > 0) {\r\n                obj.setValue(slidersResult);\r\n            }\r\n            obj.close();\r\n        }\r\n        controls.appendChild(closeButton);\r\n\r\n        // Element that will be used to create the tabs\r\n        tabs = document.createElement('div');\r\n        content.appendChild(tabs);\r\n\r\n        // Starts the jSuites tabs component\r\n        jsuitesTabs = jSuites.tabs(tabs, {\r\n            animation: true,\r\n            data: [\r\n                {\r\n                    title: 'Grid',\r\n                    contentElement: table(),\r\n                },\r\n                {\r\n                    title: 'Spectrum',\r\n                    contentElement: hsl(),\r\n                },\r\n                {\r\n                    title: 'Sliders',\r\n                    contentElement: sliders(),\r\n                }\r\n            ],\r\n            onchange: function(element, instance, index) {\r\n                if (index === 1) {\r\n                    resizeCanvas();\r\n                } else {\r\n                    var color = slidersResult !== '' ? slidersResult : obj.getValue();\r\n\r\n                    if (index === 2 && color) {\r\n                        var rgb = HexToRgb(color);\r\n\r\n                        rgbInputs.forEach(function(rgbInput, index) {\r\n                            rgbInput.value = rgb[index];\r\n                            rgbInput.dispatchEvent(new Event('input'));\r\n                        });\r\n                    }\r\n                }\r\n            },\r\n            palette: 'modern',\r\n        });\r\n\r\n        container.appendChild(content);\r\n\r\n        // Insert picker after the element\r\n        if (el.tagName == 'INPUT') {\r\n            el.parentNode.insertBefore(container, el.nextSibling);\r\n        } else {\r\n            el.appendChild(container);\r\n        }\r\n\r\n        /**\r\n         * If element is focus open the picker\r\n         */\r\n        el.addEventListener(\"mouseup\", function(e) {\r\n            obj.open();\r\n        });\r\n\r\n        backdrop.addEventListener(\"mousedown\", function(e) {\r\n            backdropClickControl = true;\r\n        });\r\n\r\n        backdrop.addEventListener(\"mouseup\", function(e) {\r\n            if (backdropClickControl) {\r\n                obj.close();\r\n                backdropClickControl = false;\r\n            }\r\n        });\r\n\r\n        // If the picker is open on the spectrum tab, it changes the canvas size when the window size is changed\r\n        window.addEventListener('resize', function() {\r\n            if (container.classList.contains('jcolor-focus') && jsuitesTabs.getActive() == 1) {\r\n                resizeCanvas();\r\n            }\r\n        });\r\n\r\n        // Default opened\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.color = obj;\r\n\r\n        // Container shortcut\r\n        container.color = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n\r\njSuites.contextmenu = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        items: null,\r\n        onclick: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class definition\r\n    el.classList.add('jcontextmenu');\r\n    // Focusable\r\n    el.setAttribute('tabindex', '900');\r\n\r\n    /**\r\n     * Open contextmenu\r\n     */\r\n    obj.open = function(e, items) {\r\n        if (items) {\r\n            // Update content\r\n            obj.options.items = items;\r\n            // Create items\r\n            obj.create(items);\r\n        }\r\n\r\n        // Coordinates\r\n        if ((obj.options.items && obj.options.items.length > 0) || el.children.length) {\r\n            if (e.target) {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            } else {\r\n                var x = e.x;\r\n                var y = e.y;\r\n            }\r\n\r\n            el.classList.add('jcontextmenu-focus');\r\n            el.focus();\r\n\r\n            var rect = el.getBoundingClientRect();\r\n\r\n            if (window.innerHeight < y + rect.height) {\r\n                var h = y - rect.height;\r\n                if (h < 0) {\r\n                    h = 0;\r\n                }\r\n                el.style.top = h + 'px';\r\n            } else {\r\n                el.style.top = y + 'px';\r\n            }\r\n\r\n            if (window.innerWidth < x + rect.width) {\r\n                if (x - rect.width > 0) {\r\n                    el.style.left = (x - rect.width) + 'px';\r\n                } else {\r\n                    el.style.left = '10px';\r\n                }\r\n            } else {\r\n                el.style.left = x + 'px';\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Close menu\r\n     */\r\n    obj.close = function() {\r\n        if (el.classList.contains('jcontextmenu-focus')) {\r\n            el.classList.remove('jcontextmenu-focus');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create items based on the declared objectd\r\n     * @param {object} items - List of object\r\n     */\r\n    obj.create = function(items) {\r\n        // Update content\r\n        el.innerHTML = '';\r\n\r\n        // Append items\r\n        for (var i = 0; i < items.length; i++) {\r\n            var itemContainer = createItemElement(items[i]);\r\n            el.appendChild(itemContainer);\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Private function for create a new Item element\r\n     * @param {type} item\r\n     * @returns {jsuitesL#15.jSuites.contextmenu.createItemElement.itemContainer}\r\n     */\r\n    function createItemElement(item) {\r\n        if (item.type && (item.type == 'line' || item.type == 'divisor')) {\r\n            var itemContainer = document.createElement('hr');\r\n        } else {\r\n            var itemContainer = document.createElement('div');\r\n            var itemText = document.createElement('a');\r\n            itemText.innerHTML = item.title;\r\n\r\n            if (item.tooltip) {\r\n                itemContainer.setAttribute('title', item.tooltip);\r\n            }\r\n\r\n            if (item.icon) {\r\n                itemContainer.setAttribute('data-icon', item.icon);\r\n            }\r\n\r\n            if (item.id) {\r\n                itemContainer.id = item.id;\r\n            }\r\n\r\n            if (item.disabled) {\r\n                itemContainer.className = 'jcontextmenu-disabled';\r\n            } else if (item.onclick) {\r\n                itemContainer.method = item.onclick;\r\n                itemContainer.addEventListener(\"mousedown\", function(e) {\r\n                    e.preventDefault();\r\n                });\r\n                itemContainer.addEventListener(\"mouseup\", function() {\r\n                    // Execute method\r\n                    this.method(this);\r\n                });\r\n            }\r\n            itemContainer.appendChild(itemText);\r\n\r\n            if (item.submenu) {\r\n                var itemIconSubmenu = document.createElement('span');\r\n                itemIconSubmenu.innerHTML = \"&#9658;\";\r\n                itemContainer.appendChild(itemIconSubmenu);\r\n                itemContainer.classList.add('jcontexthassubmenu');\r\n                var el_submenu = document.createElement('div');\r\n                // Class definition\r\n                el_submenu.classList.add('jcontextmenu');\r\n                // Focusable\r\n                el_submenu.setAttribute('tabindex', '900');\r\n                \r\n                // Append items\r\n                var submenu = item.submenu;\r\n                for (var i = 0; i < submenu.length; i++) {\r\n                    var itemContainerSubMenu = createItemElement(submenu[i]);\r\n                    el_submenu.appendChild(itemContainerSubMenu);\r\n                }\r\n\r\n                itemContainer.appendChild(el_submenu);\r\n            } else if (item.shortcut) {\r\n                var itemShortCut = document.createElement('span');\r\n                itemShortCut.innerHTML = item.shortcut;\r\n                itemContainer.appendChild(itemShortCut);\r\n            }\r\n        }\r\n        return itemContainer;\r\n    }\r\n\r\n    if (typeof(obj.options.onclick) == 'function') {\r\n        el.addEventListener('click', function(e) {\r\n            obj.options.onclick(obj, e);\r\n        });\r\n    }\r\n\r\n    // Create items\r\n    if (obj.options.items) {\r\n        obj.create(obj.options.items);\r\n    }\r\n\r\n    el.addEventListener('blur', function(e) {\r\n        obj.close();\r\n    });\r\n\r\n    if (! jSuites.contextmenu.hasEvents) {\r\n        window.addEventListener(\"mousewheel\", function() {\r\n            obj.close();\r\n        });\r\n\r\n        document.addEventListener(\"contextmenu\", function(e) {\r\n            var id = jSuites.contextmenu.getElement(e.target);\r\n            if (id) {\r\n                var element = document.querySelector('#' + id);\r\n                if (! element) {\r\n                    console.error('JSUITES: Contextmenu id not found');\r\n                } else {\r\n                    element.contextmenu.open(e);\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        });\r\n\r\n        jSuites.contextmenu.hasEvents = true;\r\n    }\r\n\r\n    el.contextmenu = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.contextmenu.getElement = function(element) {\r\n    var foundId = 0;\r\n\r\n    function path (element) {\r\n        if (element.parentNode && element.getAttribute('aria-contextmenu-id')) {\r\n            foundId = element.getAttribute('aria-contextmenu-id')\r\n        } else {\r\n            if (element.parentNode) {\r\n                path(element.parentNode);\r\n            }\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return foundId;\r\n}\r\n\r\njSuites.dropdown = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.dropdown) {\r\n        return el.dropdown.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'dropdown' };\r\n    obj.options = {};\r\n\r\n    // Success\r\n    var success = function(data, val) {\r\n        // Set data\r\n        if (data && data.length) {\r\n            // Sort\r\n            if (obj.options.sortResults !== false) {\r\n                if(typeof obj.options.sortResults == \"function\") {\r\n                    data.sort(obj.options.sortResults);\r\n                } else {\r\n                    data.sort(sortData);\r\n                }\r\n            }\r\n\r\n            obj.setData(data);\r\n\r\n            // Onload method\r\n            if (typeof(obj.options.onload) == 'function') {\r\n                obj.options.onload(el, obj, data, val);\r\n            }\r\n        }\r\n\r\n        // Set value\r\n        if (val) {\r\n            applyValue(val);\r\n        }\r\n\r\n        // Component value\r\n        if (val === undefined || val === null) {\r\n            obj.options.value = '';\r\n        }\r\n        el.value = obj.options.value;\r\n\r\n        // Open dropdown\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    \r\n    // Default sort\r\n    var sortData = function(itemA, itemB) {\r\n        var testA, testB;\r\n        if(typeof itemA == \"string\") {\r\n            testA = itemA;\r\n        } else {\r\n            if(itemA.text) {\r\n                testA = itemA.text;\r\n            } else if(itemA.name) {\r\n                testA = itemA.name;\r\n            }\r\n        }\r\n        \r\n        if(typeof itemB == \"string\") {\r\n            testB = itemB;\r\n        } else {\r\n            if(itemB.text) {\r\n                testB = itemB.text;\r\n            } else if(itemB.name) {\r\n                testB = itemB.name;\r\n            }\r\n        }\r\n        \r\n        if(typeof testA == \"string\" || typeof testB == \"string\") {\r\n            if(typeof testA != \"string\") { testA = \"\"+testA; }\r\n            if(typeof testB != \"string\") { testB = \"\"+testB; }\r\n            return testA.localeCompare(testB);\r\n        } else {\r\n            return testA - testB;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reset the options for the dropdown\r\n     */\r\n    var resetValue = function() {\r\n        // Reset value container\r\n        obj.value = {};\r\n        // Remove selected\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (obj.items[i].selected == true) {\r\n                if (obj.items[i].element) {\r\n                    obj.items[i].element.classList.remove('jdropdown-selected')\r\n                }\r\n                obj.items[i].selected = null;\r\n            }\r\n        }\r\n        // Reset options\r\n        obj.options.value = '';\r\n    }\r\n\r\n    /**\r\n     * Apply values to the dropdown\r\n     */\r\n    var applyValue = function(values) {\r\n        // Reset the current values\r\n        resetValue();\r\n\r\n        // Read values\r\n        if (values !== null) {\r\n            if (! values) {\r\n                if (typeof(obj.value['']) !== 'undefined') {\r\n                    obj.value[''] = '';\r\n                }\r\n            } else {\r\n                if (! Array.isArray(values)) {\r\n                    values = ('' + values).split(';');\r\n                }\r\n                for (var i = 0; i < values.length; i++) {\r\n                    obj.value[values[i]] = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Update the DOM\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (typeof(obj.value[Value(i)]) !== 'undefined') {\r\n                if (obj.items[i].element) {\r\n                    obj.items[i].element.classList.add('jdropdown-selected')\r\n                }\r\n                obj.items[i].selected = true;\r\n\r\n                // Keep label\r\n                obj.value[Value(i)] = Text(i);\r\n            }\r\n        }\r\n\r\n        // Global value\r\n        obj.options.value = Object.keys(obj.value).join(';');\r\n\r\n        // Update labels\r\n        obj.header.value = obj.getText();\r\n    }\r\n\r\n    // Get the value of one item\r\n    var Value = function(k, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'value';\r\n        } else {\r\n            var property = 'id';\r\n        }\r\n\r\n        if (obj.items[k]) {\r\n            if (v !== undefined) {\r\n                return obj.items[k].data[property] = v;\r\n            } else {\r\n                return obj.items[k].data[property];\r\n            }\r\n        }\r\n\r\n        return '';\r\n    }\r\n\r\n    // Get the label of one item\r\n    var Text = function(k, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'text';\r\n        } else {\r\n            var property = 'name';\r\n        }\r\n\r\n        if (obj.items[k]) {\r\n            if (v !== undefined) {\r\n                return obj.items[k].data[property] = v;\r\n            } else {\r\n                return obj.items[k].data[property];\r\n            }\r\n        }\r\n\r\n        return '';\r\n    }\r\n\r\n    var getValue = function() {\r\n        return Object.keys(obj.value);\r\n    }\r\n\r\n    var getText = function() {\r\n        var data = [];\r\n        var k = Object.keys(obj.value);\r\n        for (var i = 0; i < k.length; i++) {\r\n            data.push(obj.value[k[i]]);\r\n        }\r\n        return data;\r\n    }\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        // Default configuration\r\n        var defaults = {\r\n            url: null,\r\n            data: [],\r\n            format: 0,\r\n            multiple: false,\r\n            autocomplete: false,\r\n            remoteSearch: false,\r\n            lazyLoading: false,\r\n            type: null,\r\n            width: null,\r\n            maxWidth: null,\r\n            opened: false,\r\n            value: null,\r\n            placeholder: '',\r\n            newOptions: false,\r\n            position: false,\r\n            onchange: null,\r\n            onload: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onfocus: null,\r\n            onblur: null,\r\n            oninsert: null,\r\n            onbeforeinsert: null,\n            sortResults: false,\n            autofocus: false,\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Force autocomplete search\r\n        if (obj.options.remoteSearch == true || obj.options.type === 'searchbar') {\r\n            obj.options.autocomplete = true;\r\n        }\r\n\r\n        // New options\r\n        if (obj.options.newOptions == true) {\r\n            obj.header.classList.add('jdropdown-add');\r\n        } else {\r\n            obj.header.classList.remove('jdropdown-add');\r\n        }\r\n\r\n        // Autocomplete\r\n        if (obj.options.autocomplete == true) {\r\n            obj.header.removeAttribute('readonly');\r\n        } else {\r\n            obj.header.setAttribute('readonly', 'readonly');\r\n        }\r\n\r\n        // Place holder\r\n        if (obj.options.placeholder) {\r\n            obj.header.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            obj.header.removeAttribute('placeholder');\r\n        }\r\n\r\n        // Remove specific dropdown typing to add again\r\n        el.classList.remove('jdropdown-searchbar');\r\n        el.classList.remove('jdropdown-picker');\r\n        el.classList.remove('jdropdown-list');\r\n\r\n        if (obj.options.type == 'searchbar') {\r\n            el.classList.add('jdropdown-searchbar');\r\n        } else if (obj.options.type == 'list') {\r\n            el.classList.add('jdropdown-list');\r\n        } else if (obj.options.type == 'picker') {\r\n            el.classList.add('jdropdown-picker');\r\n        } else {\r\n            if (jSuites.getWindowWidth() < 800) {\r\n                if (obj.options.autocomplete) {\r\n                    el.classList.add('jdropdown-searchbar');\r\n                    obj.options.type = 'searchbar';\r\n                } else {\r\n                    el.classList.add('jdropdown-picker');\r\n                    obj.options.type = 'picker';\r\n                }\r\n            } else {\r\n                if (obj.options.width) {\r\n                    el.style.width = obj.options.width;\r\n                    el.style.minWidth = obj.options.width;\r\n                } else {\r\n                    el.style.removeProperty('width');\r\n                    el.style.removeProperty('min-width');\r\n                }\r\n\r\n                el.classList.add('jdropdown-default');\r\n                obj.options.type = 'default';\r\n            }\r\n        }\r\n\r\n        // Close button\r\n        if (obj.options.type == 'searchbar') {\r\n            containerHeader.appendChild(closeButton);\r\n        } else {\r\n            container.insertBefore(closeButton, container.firstChild);\r\n        }\r\n\r\n        // Load the content\r\n        if (obj.options.url && ! options.data) {\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    if (data) {\r\n                        success(data, obj.options.value);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            success(obj.options.data, obj.options.value);\r\n        }\r\n\r\n        // Return the instance\r\n        return obj;\r\n    }\r\n\r\n    // Helpers\r\n    var containerHeader = null;\r\n    var container = null;\r\n    var content = null;\r\n    var closeButton = null;\r\n    var resetButton = null;\r\n    var backdrop = null;\r\n\r\n    var keyTimer = null;\r\n\r\n    /**\r\n     * Init dropdown\r\n     */\r\n    var init = function() {\r\n        // Do not accept null\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        // If the element is a SELECT tag, create a configuration object\r\n        if (el.tagName == 'SELECT') {\r\n            var ret = jSuites.dropdown.extractFromDom(el, options);\r\n            el = ret.el;\r\n            options = ret.options;\r\n        }\r\n\r\n        // Place holder\r\n        if (! options.placeholder && el.getAttribute('placeholder')) {\r\n            options.placeholder = el.getAttribute('placeholder');\r\n        }\r\n\r\n        // Value container\r\n        obj.value = {};\r\n        // Containers\r\n        obj.items = [];\r\n        obj.groups = [];\r\n        // Search options\r\n        obj.search = '';\r\n        obj.results = null;\r\n\r\n        // Create dropdown\r\n        el.classList.add('jdropdown');\r\n\r\n        // Header container\r\n        containerHeader = document.createElement('div');\r\n        containerHeader.className = 'jdropdown-container-header';\r\n\r\n        // Header\r\n        obj.header = document.createElement('input');\r\n        obj.header.className = 'jdropdown-header';\r\n        obj.header.type = 'text';\r\n        obj.header.setAttribute('autocomplete', 'off');\r\n        obj.header.onfocus = function() {\r\n            if (typeof(obj.options.onfocus) == 'function') {\r\n                obj.options.onfocus(el);\r\n            }\r\n        }\r\n\r\n        obj.header.onblur = function() {\r\n            if (typeof(obj.options.onblur) == 'function') {\r\n                obj.options.onblur(el);\r\n            }\r\n        }\r\n\r\n        obj.header.onkeyup = function(e) {\r\n            if (obj.options.autocomplete == true && ! keyTimer) {\r\n                if (obj.search != obj.header.value.trim()) {\r\n                    keyTimer = setTimeout(function() {\r\n                        obj.find(obj.header.value.trim());\r\n                        keyTimer = null;\r\n                    }, 400);\r\n                }\r\n\r\n                if (! el.classList.contains('jdropdown-focus')) {\r\n                    obj.open();\r\n                }\r\n            } else {\r\n                if (! obj.options.autocomplete) {\r\n                    obj.next(e.key);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Global controls\r\n        if (! jSuites.dropdown.hasEvents) {\r\n            // Execute only one time\r\n            jSuites.dropdown.hasEvents = true;\r\n            // Enter and Esc\r\n            document.addEventListener(\"keydown\", jSuites.dropdown.keydown);\r\n        }\r\n\r\n        // Container\r\n        container = document.createElement('div');\r\n        container.className = 'jdropdown-container';\r\n\r\n        // Dropdown content\r\n        content = document.createElement('div');\r\n        content.className = 'jdropdown-content';\r\n\r\n        // Close button\r\n        closeButton = document.createElement('div');\r\n        closeButton.className = 'jdropdown-close';\r\n        closeButton.innerHTML = 'Done';\r\n\r\n        // Reset button\r\n        resetButton = document.createElement('div');\r\n        resetButton.className = 'jdropdown-reset';\r\n        resetButton.innerHTML = 'x';\r\n        resetButton.onclick = function() {\r\n            obj.reset();\r\n            obj.close();\r\n        }\r\n\r\n        // Create backdrop\r\n        backdrop = document.createElement('div');\r\n        backdrop.className = 'jdropdown-backdrop';\r\n\r\n        // Append elements\r\n        containerHeader.appendChild(obj.header);\r\n\r\n        container.appendChild(content);\r\n        el.appendChild(containerHeader);\r\n        el.appendChild(container);\r\n        el.appendChild(backdrop);\r\n\r\n        // Set the otiptions\r\n        obj.setOptions(options);\r\n\r\n        if ('ontouchsend' in document.documentElement === true) {\r\n            el.addEventListener('touchsend', jSuites.dropdown.mouseup);\r\n        } else {\r\n            el.addEventListener('mouseup', jSuites.dropdown.mouseup);\r\n        }\r\n\r\n        // Lazyloading\r\n        if (obj.options.lazyLoading == true) {\r\n            jSuites.lazyLoading(content, {\r\n                loadUp: obj.loadUp,\r\n                loadDown: obj.loadDown,\r\n            });\r\n        }\r\n\r\n        content.onwheel = function(e) {\r\n            e.stopPropagation();\r\n        }\r\n\r\n        // Change method\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue(obj.options.multiple ? true : false);\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.dropdown = obj;\r\n    }\r\n\r\n    /**\r\n     * Get the current remote source of data URL\r\n     */\r\n    obj.getUrl = function() {\r\n        return obj.options.url;\r\n    }\r\n\r\n    /**\r\n     * Set the new data from a remote source\r\n     * @param {string} url - url from the remote source\r\n     * @param {function} callback - callback when the data is loaded\r\n     */\r\n    obj.setUrl = function(url, callback) {\r\n        obj.options.url = url;\r\n\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'json',\r\n            success: function(data) {\r\n                obj.setData(data);\r\n                // Callback\r\n                if (typeof(callback) == 'function') {\r\n                    callback(obj);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Set ID for one item\r\n     */\r\n    obj.setId = function(item, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'value';\r\n        } else {\r\n            var property = 'id';\r\n        }\r\n\r\n        if (typeof(item) == 'object') {\r\n            item[property] = v;\r\n        } else {\r\n            obj.items[item].data[property] = v;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add a new item\r\n     * @param {string} title - title of the new item\r\n     * @param {string} id - value/id of the new item\n     */\r\n    obj.add = function(title, id) {\r\n        if (! title) {\r\n            var current = obj.options.autocomplete == true ? obj.header.value : '';\r\n            var title = prompt(jSuites.translate('Add A New Option'), current);\r\n            if (! title) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Id\r\n        if (! id) {\r\n           id = jSuites.guid();\r\n        }\r\n\r\n        // Create new item\r\n        if (! obj.options.format) {\r\n            var item = {\r\n                value: id,\r\n                text: title,\r\n            }\r\n        } else {\r\n            var item = {\r\n                id: id,\r\n                name: title,\r\n            }\r\n        }\r\n\r\n        // Callback\r\n        if (typeof(obj.options.onbeforeinsert) == 'function') {\r\n            var ret = obj.options.onbeforeinsert(obj, item);\r\n            if (ret === false) {\r\n                return false;\r\n            } else if (ret) {\r\n                item = ret;\r\n            }\r\n        }\n\n        // Add item to the main list\r\n        obj.options.data.push(item);\r\n\r\n        // Create DOM\r\n        var newItem = obj.createItem(item);\r\n\r\n        // Append DOM to the list\r\n        content.appendChild(newItem.element);\r\n\r\n        // Callback\r\n        if (typeof(obj.options.oninsert) == 'function') {\r\n            obj.options.oninsert(obj, item, newItem);\r\n        }\r\n\r\n        // Show content\r\n        if (content.style.display == 'none') {\r\n            content.style.display = '';\r\n        }\r\n\r\n        // Search?\r\n        if (obj.results) {\r\n            obj.results.push(newItem);\r\n        }\r\n\r\n        return item;\r\n    }\r\n\r\n    /**\r\n     * Create a new item\r\n     */\r\n    obj.createItem = function(data, group, groupName) {\r\n        // Keep the correct source of data\r\n        if (! obj.options.format) {\r\n            if (! data.value && data.id !== undefined) {\r\n                data.value = data.id;\r\n                //delete data.id;\r\n            }\r\n            if (! data.text && data.name !== undefined) {\r\n                data.text = data.name;\r\n                //delete data.name;\r\n            }\r\n        } else {\r\n            if (! data.id && data.value !== undefined) {\r\n                data.id = data.value;\r\n                //delete data.value;\r\n            }\r\n            if (! data.name && data.text !== undefined) {\r\n                data.name = data.text\r\n                //delete data.text;\r\n            }\r\n        }\r\n\r\n        // Create item\r\n        var item = {};\r\n        item.element = document.createElement('div');\r\n        item.element.className = 'jdropdown-item';\r\n        item.element.indexValue = obj.items.length;\r\n        item.data = data;\r\n\r\n        // Groupd DOM\r\n        if (group) {\r\n            item.group = group; \r\n        }\r\n\r\n        // Id\r\n        if (data.id) {\r\n            item.element.setAttribute('id', data.id);\r\n        }\r\n\r\n        // Disabled\r\n        if (data.disabled == true) {\r\n            item.element.setAttribute('data-disabled', true);\r\n        }\r\n\r\n        // Tooltip\n        if (data.tooltip) {\n            item.element.setAttribute('title', data.tooltip);\n        }\n\n        // Image\r\n        if (data.image) {\r\n            var image = document.createElement('img');\r\n            image.className = 'jdropdown-image';\r\n            image.src = data.image;\r\n            if (! data.title) {\r\n               image.classList.add('jdropdown-image-small');\r\n            }\r\n            item.element.appendChild(image);\r\n        } else if (data.icon) {\r\n            var icon = document.createElement('span');\r\n            icon.className = \"jdropdown-icon material-icons\";\r\n            icon.innerText = data.icon;\r\n            if (! data.title) {\r\n               icon.classList.add('jdropdown-icon-small');\r\n            }\r\n            if (data.color) {\r\n                icon.style.color = data.color;\r\n            }\r\n            item.element.appendChild(icon);\n        } else if (data.color) {\r\n            var color = document.createElement('div');\r\n            color.className = 'jdropdown-color';\r\n            color.style.backgroundColor = data.color;\r\n            item.element.appendChild(color);\r\n        }\r\n\r\n        // Set content\r\n        if (! obj.options.format) {\r\n            var text = data.text;\r\n        } else {\r\n            var text = data.name;\r\n        }\r\n\r\n        var node = document.createElement('div');\r\n        node.className = 'jdropdown-description';\r\n        node.innerHTML = text || '&nbsp;'; \r\n\r\n        // Title\r\n        if (data.title) {\r\n            var title = document.createElement('div');\r\n            title.className = 'jdropdown-title';\r\n            title.innerText = data.title;\r\n            node.appendChild(title);\r\n        }\r\n\r\n        // Set content\r\n        if (! obj.options.format) {\r\n            var val = data.value;\r\n        } else {\r\n            var val = data.id;\r\n        }\r\n\r\n        // Value\r\n        if (obj.value[val]) {\r\n            item.element.classList.add('jdropdown-selected');\r\n            item.selected = true;\r\n        }\r\n\r\n        // Keep DOM accessible\r\n        obj.items.push(item);\r\n\r\n        // Add node to item\r\n        item.element.appendChild(node);\r\n\r\n        return item;\r\n    }\r\n\r\n    obj.appendData = function(data) {\r\n        // Create elements\r\n        if (data.length) {\r\n            // Helpers\r\n            var items = [];\r\n            var groups = [];\r\n\r\n            // Prepare data\r\n            for (var i = 0; i < data.length; i++) {\r\n                // Process groups\r\n                if (data[i].group) {\r\n                    if (! groups[data[i].group]) {\r\n                        groups[data[i].group] = [];\r\n                    }\r\n                    groups[data[i].group].push(i);\r\n                } else {\r\n                    items.push(i);\r\n                }\r\n            }\r\n\r\n            // Number of items counter\r\n            var counter = 0;\r\n\r\n            // Groups\r\n            var groupNames = Object.keys(groups);\r\n\r\n            // Append groups in case exists\r\n            if (groupNames.length > 0) {\r\n                for (var i = 0; i < groupNames.length; i++) {\r\n                    // Group container\r\n                    var group = document.createElement('div');\r\n                    group.className = 'jdropdown-group';\r\n                    // Group name\r\n                    var groupName = document.createElement('div');\r\n                    groupName.className = 'jdropdown-group-name';\r\n                    groupName.innerHTML = groupNames[i];\r\n                    // Group arrow\r\n                    var groupArrow = document.createElement('i');\r\n                    groupArrow.className = 'jdropdown-group-arrow jdropdown-group-arrow-down';\r\n                    groupName.appendChild(groupArrow);\r\n                    // Group items\r\n                    var groupContent = document.createElement('div');\r\n                    groupContent.className = 'jdropdown-group-items';\r\n                    for (var j = 0; j < groups[groupNames[i]].length; j++) {\r\n                        var item = obj.createItem(data[groups[groupNames[i]][j]], group, groupNames[i]);\r\n\r\n                        if (obj.options.lazyLoading == false || counter < 200) {\r\n                            groupContent.appendChild(item.element);\r\n                            counter++;\r\n                        }\r\n                    }\r\n                    // Group itens\r\n                    group.appendChild(groupName);\r\n                    group.appendChild(groupContent);\r\n                    // Keep group DOM\r\n                    obj.groups.push(group);\r\n                    // Only add to the screen if children on the group\r\n                    if (groupContent.children.length > 0) {\r\n                        // Add DOM to the content\r\n                        content.appendChild(group);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (items.length) {\r\n                for (var i = 0; i < items.length; i++) {\r\n                    var item = obj.createItem(data[items[i]]);\r\n                    if (obj.options.lazyLoading == false || counter < 200) {\r\n                        content.appendChild(item.element);\r\n                        counter++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.setData = function(data) {\r\n        // Prepare data\r\n        if (data.length) {\r\n            for (var i = 0; i < data.length; i++) {\r\n                // Compatibility\r\n                if (typeof(data[i]) != 'object') {\r\n                    // Correct format\r\n                    if (! obj.options.format) {\r\n                        data[i] = {\r\n                            value: data[i],\r\n                            text: data[i]\r\n                        }\r\n                    } else {\r\n                        data[i] = {\r\n                            id: data[i],\r\n                            name: data[i]\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Reset current value\r\n            resetValue();\r\n\r\n            // Make sure the content container is blank\r\n            content.innerHTML = '';\r\n\r\n            // Reset\r\n            obj.header.value = '';\r\n\r\n            // Reset items and values\r\n            obj.items = [];\r\n\r\n            // Append data\r\n            obj.appendData(data);\r\n\r\n            // Update data\r\n            obj.options.data = data;\r\n        }\r\n    }\r\n\r\n    obj.getData = function() {\r\n        return obj.options.data;\r\n    }\r\n\r\n    /**\r\n     * Get position of the item\r\n     */\r\n    obj.getPosition = function(val) {\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (Value(i) == val) {\r\n                return i;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Get dropdown current text\r\n     */\r\n    obj.getText = function(asArray) {\r\n        // Get value\r\n        var v = getText();\r\n        // Return value\r\n        if (asArray) {\r\n            return v;\r\n        } else {\r\n            return v.join('; ');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get dropdown current value\r\n     */\r\n    obj.getValue = function(asArray) {\r\n        // Get value\r\n        var v = getValue();\r\n        // Return value\r\n        if (asArray) {\r\n            return v;\r\n        } else {\r\n            return v.join(';');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Change event\r\n     */\r\n    var change = function(oldValue) {\r\n        // Events\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, obj, oldValue, obj.options.value);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set value\r\n     */\r\n    obj.setValue = function(newValue) {\r\n        // Current value\r\n        var oldValue = obj.getValue();\r\n        // New value\r\n        if (Array.isArray(newValue)) {\r\n            newValue = newValue.join(';')\r\n        }\r\n\r\n        if (oldValue !== newValue) {\r\n            // Set value\r\n            applyValue(newValue);\r\n\r\n            // Change\r\n            change(oldValue);\r\n        }\r\n    }\r\n\r\n    obj.resetSelected = function() {\r\n        obj.setValue(null);\r\n    } \r\n\r\n    obj.selectIndex = function(index, force) {\r\n        // Make sure is a number\r\n        var index = parseInt(index);\r\n\r\n        // Only select those existing elements\r\n        if (obj.items && obj.items[index] && (force === true || obj.items[index].data.disabled !== true)) {\r\n            // Reset cursor to a new position\r\n            obj.setCursor(index, false);\r\n\r\n            // Behaviour\r\n            if (! obj.options.multiple) {\r\n                // Update value\r\n                if (obj.items[index].selected) {\r\n                    obj.setValue(null);\r\n                } else {\r\n                    obj.setValue(Value(index));\r\n                }\r\n\r\n                // Close component\r\n                obj.close();\r\n            } else {\r\n                // Old value\r\n                var oldValue = obj.options.value;\r\n\r\n                // Toggle option\r\n                if (obj.items[index].selected) {\r\n                    obj.items[index].element.classList.remove('jdropdown-selected');\r\n                    obj.items[index].selected = false;\r\n\r\n                    delete obj.value[Value(index)];\r\n                } else {\r\n                    // Select element\r\n                    obj.items[index].element.classList.add('jdropdown-selected');\r\n                    obj.items[index].selected = true;\r\n\r\n                    // Set value\r\n                    obj.value[Value(index)] = Text(index);\r\n                }\r\n\r\n                // Global value\r\n                obj.options.value = Object.keys(obj.value).join(';');\r\n\r\n                // Update labels for multiple dropdown\r\n                if (obj.options.autocomplete == false) {\r\n                    obj.header.value = getText().join('; ');\r\n                }\r\n\r\n                // Events\r\n                change(oldValue);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.selectItem = function(item) {\r\n        obj.selectIndex(item.indexValue);\r\n    }\r\n\r\n    var exists = function(k, result) {\r\n        for (var j = 0; j < result.length; j++) {\r\n            if (! obj.options.format) {\r\n                if (result[j].value == k) {\r\n                    return true;\r\n                }\r\n            } else {\r\n                if (result[j].id == k) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    obj.find = function(str) {\r\n        if (obj.search == str.trim()) {\r\n            return false;\r\n        }\r\n\r\n        // Search term\r\n        obj.search = str;\r\n\r\n        // Reset index\r\n        obj.setCursor();\r\n\r\n        // Remove nodes from all groups\r\n        if (obj.groups.length) {\r\n            for (var i = 0; i < obj.groups.length; i++) {\r\n                obj.groups[i].lastChild.innerHTML = '';\r\n            }\r\n        }\r\n\r\n        // Remove all nodes\r\n        content.innerHTML = '';\r\n\r\n        // Remove current items in the remote search\r\n        if (obj.options.remoteSearch == true) {\r\n            // Reset results\r\n            obj.results = null;\r\n            // URL\r\n            var url = obj.options.url + (obj.options.url.indexOf('?') > 0 ? '&' : '?') + 'q=' + str;\r\n            // Remote search\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Reset items\r\n                    obj.items = [];\r\n\r\n                    // Add the current selected items to the results in case they are not there\r\n                    var current = Object.keys(obj.value);\r\n                    if (current.length) {\r\n                        for (var i = 0; i < current.length; i++) {\r\n                            if (! exists(current[i], result)) {\r\n                                if (! obj.options.format) {\r\n                                    result.unshift({ value: current[i], text: obj.value[current[i]] });\r\n                                } else {\r\n                                    result.unshift({ id: current[i], name: obj.value[current[i]] });\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    // Append data\r\n                    obj.appendData(result);\r\n                    // Show or hide results\r\n                    if (! result.length) {\r\n                        content.style.display = 'none';\r\n                    } else {\r\n                        content.style.display = '';\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            // Search terms\r\n            str = new RegExp(str, 'gi');\r\n\r\n            // Reset search\r\n            var results = [];\r\n\r\n            // Append options\r\n            for (var i = 0; i < obj.items.length; i++) {\r\n                // Item label\r\n                var label = Text(i);\r\n                // Item title\r\n                var title = obj.items[i].data.title || '';\r\n                // Group name\r\n                var groupName = obj.items[i].data.group || '';\r\n                // Synonym\r\n                var synonym = obj.items[i].data.synonym || '';\r\n                if (synonym) {\r\n                    synonym = synonym.join(' ');\r\n                }\r\n\r\n                if (str == null || obj.items[i].selected == true || label.match(str) || title.match(str) || groupName.match(str) || synonym.match(str)) {\r\n                    results.push(obj.items[i]);\r\n                }\r\n            }\r\n\r\n            if (! results.length) {\r\n                content.style.display = 'none';\r\n\r\n                // Results\r\n                obj.results = null;\r\n            } else {\r\n                content.style.display = '';\r\n\r\n                // Results\r\n                obj.results = results;\r\n\r\n                // Show 200 items at once\r\n                var number = results.length || 0;\r\n\r\n                // Lazyloading\r\n                if (obj.options.lazyLoading == true && number > 200) {\r\n                    number = 200;\r\n                }\r\n\r\n                for (var i = 0; i < number; i++) {\r\n                    if (obj.results[i].group) {\r\n                        if (! obj.results[i].group.parentNode) {\r\n                            content.appendChild(obj.results[i].group);\r\n                        }\r\n                        obj.results[i].group.lastChild.appendChild(obj.results[i].element);\r\n                    } else {\r\n                        content.appendChild(obj.results[i].element);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Auto focus\r\n        if (obj.options.autofocus == true) {\r\n            obj.first();\r\n        }\r\n    }\r\n\r\n    obj.open = function() {\r\n        // Focus\r\n        if (! el.classList.contains('jdropdown-focus')) {\r\n            // Current dropdown\r\n            jSuites.dropdown.current = obj;\r\n\r\n            // Start tracking\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Add focus\r\n            el.classList.add('jdropdown-focus');\r\n\r\n            // Animation\r\n            if (jSuites.getWindowWidth() < 800) {\r\n                if (obj.options.type == null || obj.options.type == 'picker') {\r\n                    jSuites.animation.slideBottom(container, 1);\r\n                }\r\n            }\r\n\r\n            // Filter\r\n            if (obj.options.autocomplete == true) {\r\n                obj.header.value = obj.search;\r\n                obj.header.focus();\r\n            }\r\n\r\n            // Set cursor for the first or first selected element\r\n            var k = getValue();\r\n            if (k[0]) {\r\n                var cursor = obj.getPosition(k[0]);\r\n                if (cursor !== false) {\r\n                    obj.setCursor(cursor);\r\n                }\r\n            }\r\n\r\n            // Container Size\r\n            if (! obj.options.type || obj.options.type == 'default') {\r\n                var rect = el.getBoundingClientRect();\r\n                var rectContainer = container.getBoundingClientRect();\r\n\r\n                if (obj.options.position) {\r\n                    container.style.position = 'fixed';\r\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\r\n                        container.style.top = '';\r\n                        container.style.bottom = (window.innerHeight - rect.top ) + 1 + 'px';\r\n                    } else {\r\n                        container.style.top = rect.bottom + 'px';\r\n                        container.style.bottom = '';\r\n                    }\r\n                    container.style.left = rect.left + 'px';\r\n                } else {\r\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\r\n                        container.style.top = '';\r\n                        container.style.bottom = rect.height + 1 + 'px';\r\n                    } else {\r\n                        container.style.top = '';\r\n                        container.style.bottom = '';\r\n                    }\r\n                }\r\n\r\n                container.style.minWidth = rect.width + 'px';\r\n\r\n                if (obj.options.maxWidth) {\r\n                    container.style.maxWidth = obj.options.maxWidth;\r\n                }\r\n\r\n                if (! obj.items.length && obj.options.autocomplete == true) {\r\n                    content.style.display = 'none';\r\n                } else {\r\n                    content.style.display = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Events\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el);\r\n        }\r\n    }\r\n\r\n    obj.close = function(ignoreEvents) {\r\n        if (el.classList.contains('jdropdown-focus')) {\r\n            // Update labels\r\n            obj.header.value = obj.getText();\r\n            // Remove cursor\r\n            obj.setCursor();\r\n            // Events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Blur\r\n            if (obj.header.blur) {\r\n                obj.header.blur();\r\n            }\r\n            // Remove focus\r\n            el.classList.remove('jdropdown-focus');\r\n            // Start tracking\r\n            jSuites.tracking(obj, false);\r\n            // Current dropdown\r\n            jSuites.dropdown.current = null;\r\n        }\r\n\r\n        return obj.getValue();\r\n    }\r\n\r\n    /**\r\n     * Set cursor\r\n     */\r\n    obj.setCursor = function(index, setPosition) {\r\n        // Remove current cursor\r\n        if (obj.currentIndex != null) {\r\n            // Remove visual cursor\r\n            if (obj.items && obj.items[obj.currentIndex]) {\r\n                obj.items[obj.currentIndex].element.classList.remove('jdropdown-cursor');\r\n            }\r\n        }\r\n\r\n        if (index == undefined) {\r\n            obj.currentIndex = null;\r\n        } else {\r\n            index = parseInt(index);\r\n\r\n            // Cursor only for visible items\r\n            if (obj.items[index].element.parentNode) {\r\n                obj.items[index].element.classList.add('jdropdown-cursor');\r\n                obj.currentIndex = index;\r\n\r\n                // Update scroll to the cursor element\r\n                if (setPosition !== false && obj.items[obj.currentIndex].element) {\r\n                    var container = content.scrollTop;\r\n                    var element = obj.items[obj.currentIndex].element;\r\n                    content.scrollTop = element.offsetTop - element.scrollTop + element.clientTop - 95;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Compatibility\r\n    obj.resetCursor = obj.setCursor;\r\n    obj.updateCursor = obj.setCursor;\r\n\r\n    /**\r\n     * Reset cursor and selected items\r\n     */\r\n    obj.reset = function() {\r\n        // Reset cursor\r\n        obj.setCursor();\r\n\r\n        // Reset selected\r\n        obj.setValue(null);\r\n    }\r\n\r\n    /**\r\n     * First available item\r\n     */\r\n    obj.first = function() {\r\n        if (obj.options.lazyLoading === true) {\r\n            obj.loadFirst();\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        if (items.length) {\r\n            var newIndex = items[0].indexValue;\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Last available item \r\n     */\r\n    obj.last = function() {\r\n        if (obj.options.lazyLoading === true) {\r\n            obj.loadLast();\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        if (items.length) {\r\n            var newIndex = items[items.length-1].indexValue;\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    obj.next = function(letter) {\r\n        var newIndex = null;\r\n\r\n        if (letter) {\r\n            if (letter.length == 1) {\r\n                // Current index\r\n                var current = obj.currentIndex || -1;\r\n                // Letter\r\n                letter = letter.toLowerCase();\r\n\r\n                var e = null;\r\n                var l = null;\r\n                var items = content.querySelectorAll('.jdropdown-item');\r\n                if (items.length) {\r\n                    for (var i = 0; i < items.length; i++) {\r\n                        if (items[i].indexValue > current) {\r\n                            if (e = obj.items[items[i].indexValue]) {\r\n                                if (l = e.element.innerText[0]) {\r\n                                    l = l.toLowerCase();\r\n                                    if (letter == l) {\r\n                                        newIndex = items[i].indexValue;\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    obj.setCursor(newIndex);\r\n                }\r\n            }\r\n        } else {\r\n            if (obj.currentIndex == undefined || obj.currentIndex == null) {\r\n                obj.first();\r\n            } else {\r\n                var element = obj.items[obj.currentIndex].element;\r\n\r\n                var next = element.nextElementSibling;\r\n                if (next) {\r\n                    if (next.classList.contains('jdropdown-group')) {\r\n                        next = next.lastChild.firstChild;\r\n                    }\r\n                    newIndex = next.indexValue;\r\n                } else {\r\n                    if (element.parentNode.classList.contains('jdropdown-group-items')) {\r\n                        if (next = element.parentNode.parentNode.nextElementSibling) {\r\n                            if (next.classList.contains('jdropdown-group')) {\r\n                                next = next.lastChild.firstChild;\r\n                            } else if (next.classList.contains('jdropdown-item')) {\r\n                                newIndex = next.indexValue;\r\n                            } else {\r\n                                next = null;\r\n                            }\r\n                        }\r\n\r\n                        if (next) {\r\n                            newIndex = next.indexValue;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (newIndex !== null) {\r\n                    obj.setCursor(newIndex);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.prev = function() {\r\n        var newIndex = null;\r\n\r\n        if (obj.currentIndex === null) {\r\n            obj.first();\r\n        } else {\r\n            var element = obj.items[obj.currentIndex].element;\r\n\r\n            var prev = element.previousElementSibling;\r\n            if (prev) {\r\n                if (prev.classList.contains('jdropdown-group')) {\r\n                    prev = prev.lastChild.lastChild;\r\n                }\r\n                newIndex = prev.indexValue;\r\n            } else {\r\n                if (element.parentNode.classList.contains('jdropdown-group-items')) {\r\n                    if (prev = element.parentNode.parentNode.previousElementSibling) {\r\n                        if (prev.classList.contains('jdropdown-group')) {\r\n                            prev = prev.lastChild.lastChild;\r\n                        } else if (prev.classList.contains('jdropdown-item')) {\r\n                            newIndex = prev.indexValue;\r\n                        } else {\r\n                            prev = null\r\n                        }\r\n                    }\r\n\r\n                    if (prev) {\r\n                        newIndex = prev.indexValue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (newIndex !== null) {\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    obj.loadFirst = function() {\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        // Show 200 items at once\r\n        var number = results.length || 0;\r\n\r\n        // Lazyloading\r\n        if (obj.options.lazyLoading == true && number > 200) {\r\n            number = 200;\r\n        }\r\n\r\n        // Reset container\r\n        content.innerHTML = '';\r\n\r\n        // First 200 items\r\n        for (var i = 0; i < number; i++) {\r\n            if (results[i].group) {\r\n                if (! results[i].group.parentNode) {\r\n                    content.appendChild(results[i].group);\r\n                }\r\n                results[i].group.lastChild.appendChild(results[i].element);\r\n            } else {\r\n                content.appendChild(results[i].element);\r\n            }\r\n        }\r\n\r\n        // Scroll go to the begin\r\n        content.scrollTop = 0;\r\n    }\r\n\r\n    obj.loadLast = function() {\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        // Show first page\r\n        var number = results.length;\r\n\r\n        // Max 200 items\r\n        if (number > 200) {\r\n            number = number - 200;\r\n\r\n            // Reset container\r\n            content.innerHTML = '';\r\n\r\n            // First 200 items\r\n            for (var i = number; i < results.length; i++) {\r\n                if (results[i].group) {\r\n                    if (! results[i].group.parentNode) {\r\n                        content.appendChild(results[i].group);\r\n                    }\r\n                    results[i].group.lastChild.appendChild(results[i].element);\r\n                } else {\r\n                    content.appendChild(results[i].element);\r\n                }\r\n            }\r\n\r\n            // Scroll go to the begin\r\n            content.scrollTop = content.scrollHeight;\r\n        }\r\n    }\r\n\r\n    obj.loadUp = function() {\r\n        var test = false;\r\n\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        var fistItem = items[0].indexValue;\r\n        fistItem = obj.items[fistItem];\r\n        var index = results.indexOf(fistItem) - 1;\r\n\r\n        if (index > 0) {\r\n            var number = 0;\r\n\r\n            while (index > 0 && results[index] && number < 200) {\r\n                if (results[index].group) {\r\n                    if (! results[index].group.parentNode) {\r\n                        content.insertBefore(results[index].group, content.firstChild);\r\n                    }\r\n                    results[index].group.lastChild.insertBefore(results[index].element, results[index].group.lastChild.firstChild);\r\n                } else {\r\n                    content.insertBefore(results[index].element, content.firstChild);\r\n                }\r\n\r\n                index--;\r\n                number++;\r\n            }\r\n\r\n            // New item added\r\n            test = true;\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    obj.loadDown = function() {\r\n        var test = false;\r\n\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        var lastItem = items[items.length-1].indexValue;\r\n        lastItem = obj.items[lastItem];\r\n        var index = results.indexOf(lastItem) + 1;\r\n\r\n        if (index < results.length) {\r\n            var number = 0;\r\n            while (index < results.length && results[index] && number < 200) {\r\n                if (results[index].group) {\r\n                    if (! results[index].group.parentNode) {\r\n                        content.appendChild(results[index].group);\r\n                    }\r\n                    results[index].group.lastChild.appendChild(results[index].element);\r\n                } else {\r\n                    content.appendChild(results[index].element);\r\n                }\r\n\r\n                index++;\r\n                number++;\r\n            }\r\n\r\n            // New item added\r\n            test = true;\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.dropdown.keydown = function(e) {\r\n    var dropdown = null;\r\n    if (dropdown = jSuites.dropdown.current) {\r\n        if (e.which == 13 || e.which == 9) {  // enter or tab\n            if (dropdown.header.value && dropdown.currentIndex == null && dropdown.options.newOptions) {\n                // if they typed something in, but it matched nothing, and newOptions are allowed, start that flow\n                dropdown.add();\n            } else {\n                // Quick Select/Filter\r\n                if (dropdown.currentIndex == null && dropdown.options.autocomplete == true && dropdown.header.value != \"\") {\r\n                    dropdown.find(dropdown.header.value);\r\n                }\r\n                dropdown.selectIndex(dropdown.currentIndex);\r\n            }\n        } else if (e.which == 38) {  // up arrow\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex > 0) {\r\n                dropdown.prev();\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 40) {  // down arrow\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex + 1 < dropdown.items.length) {\r\n                dropdown.next();\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 36) {\r\n            dropdown.first();\r\n            if (! e.target.classList.contains('jdropdown-header')) {\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 35) {\r\n            dropdown.last();\r\n            if (! e.target.classList.contains('jdropdown-header')) {\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 27) {\r\n            dropdown.close();\r\n        } else if (e.which == 33) {  // page up\r\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex > 0) {\r\n                for (var i = 0; i < 7; i++) {\r\n                    dropdown.prev()\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 34) {  // page down\r\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex + 1 < dropdown.items.length) {\r\n                for (var i = 0; i < 7; i++) {\r\n                    dropdown.next()\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.dropdown.mouseup = function(e) {\r\n    var element = jSuites.findElement(e.target, 'jdropdown');\r\n    if (element) {\r\n        var dropdown = element.dropdown;\r\n        if (e.target.classList.contains('jdropdown-header')) {\r\n            if (element.classList.contains('jdropdown-focus') && element.classList.contains('jdropdown-default')) {\r\n                var rect = element.getBoundingClientRect();\r\n\r\n                if (e.changedTouches && e.changedTouches[0]) {\r\n                    var x = e.changedTouches[0].clientX;\r\n                    var y = e.changedTouches[0].clientY;\r\n                } else {\r\n                    var x = e.clientX;\r\n                    var y = e.clientY;\r\n                }\r\n\r\n                if (rect.width - (x - rect.left) < 30) {\r\n                    if (e.target.classList.contains('jdropdown-add')) {\r\n                        dropdown.add();\r\n                    } else {\r\n                        dropdown.close();\r\n                    }\r\n                } else {\r\n                    if (dropdown.options.autocomplete == false) {\r\n                        dropdown.close();\r\n                    }\r\n                }\r\n            } else {\r\n                dropdown.open();\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-group-name')) {\r\n            var items = e.target.nextSibling.children;\r\n            if (e.target.nextSibling.style.display != 'none') {\r\n                for (var i = 0; i < items.length; i++) {\r\n                    if (items[i].style.display != 'none') {\r\n                        dropdown.selectItem(items[i]);\r\n                    }\r\n                }\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-group-arrow')) {\r\n            if (e.target.classList.contains('jdropdown-group-arrow-down')) {\r\n                e.target.classList.remove('jdropdown-group-arrow-down');\r\n                e.target.classList.add('jdropdown-group-arrow-up');\r\n                e.target.parentNode.nextSibling.style.display = 'none';\r\n            } else {\r\n                e.target.classList.remove('jdropdown-group-arrow-up');\r\n                e.target.classList.add('jdropdown-group-arrow-down');\r\n                e.target.parentNode.nextSibling.style.display = '';\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-item')) {\r\n            dropdown.selectItem(e.target);\r\n        } else if (e.target.classList.contains('jdropdown-image')) {\r\n            dropdown.selectItem(e.target.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-description')) {\r\n            dropdown.selectItem(e.target.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-title')) {\r\n            dropdown.selectItem(e.target.parentNode.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-close') || e.target.classList.contains('jdropdown-backdrop')) {\r\n            dropdown.close();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.dropdown.extractFromDom = function(el, options) {\r\n    // Keep reference\r\n    var select = el;\r\n    if (! options) {\r\n        options = {};\r\n    }\r\n    // Prepare configuration\r\n    if (el.getAttribute('multiple') && (! options || options.multiple == undefined)) {\r\n        options.multiple = true;\r\n    }\r\n    if (el.getAttribute('placeholder') && (! options || options.placeholder == undefined)) {\r\n        options.placeholder = el.getAttribute('placeholder');\r\n    }\r\n    if (el.getAttribute('data-autocomplete') && (! options || options.autocomplete == undefined)) {\r\n        options.autocomplete = true;\r\n    }\r\n    if (! options || options.width == undefined) {\r\n        options.width = el.offsetWidth;\r\n    }\r\n    if (el.value && (! options || options.value == undefined)) {\r\n        options.value = el.value;\r\n    }\r\n    if (! options || options.data == undefined) {\r\n        options.data = [];\r\n        for (var j = 0; j < el.children.length; j++) {\r\n            if (el.children[j].tagName == 'OPTGROUP') {\r\n                for (var i = 0; i < el.children[j].children.length; i++) {\r\n                    options.data.push({\r\n                        value: el.children[j].children[i].value,\r\n                        text: el.children[j].children[i].innerHTML,\r\n                        group: el.children[j].getAttribute('label'),\r\n                    });\r\n                }\r\n            } else {\r\n                options.data.push({\r\n                    value: el.children[j].value,\r\n                    text: el.children[j].innerHTML,\r\n                });\r\n            }\r\n        }\r\n    }\r\n    if (! options || options.onchange == undefined) {\r\n        options.onchange = function(a,b,c,d) {\r\n            if (options.multiple == true) {\r\n                if (obj.items[b].classList.contains('jdropdown-selected')) {\r\n                    select.options[b].setAttribute('selected', 'selected');\r\n                } else {\r\n                    select.options[b].removeAttribute('selected');\r\n                }\r\n            } else {\r\n                select.value = d;\r\n            }\r\n        }\r\n    }\r\n    // Create DIV\r\n    var div = document.createElement('div');\r\n    el.parentNode.insertBefore(div, el);\r\n    el.style.display = 'none';\r\n    el = div;\r\n\r\n    return { el:el, options:options };\r\n}\r\n\r\njSuites.editor = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        // Initial HTML content\r\n        value: null,\r\n        // Initial snippet\r\n        snippet: null,\r\n        // Add toolbar\r\n        toolbar: null,\r\n        // Website parser is to read websites and images from cross domain\r\n        remoteParser: null,\r\n        // Placeholder\r\n        placeholder: null,\r\n        // Parse URL\r\n        parseURL: false,\r\n        filterPaste: true,\r\n        // Accept drop files\r\n        dropZone: false,\r\n        dropAsSnippet: false,\r\n        acceptImages: false,\r\n        acceptFiles: false,\r\n        maxFileSize: 5000000,\r\n        allowImageResize: true,\r\n        // Style\r\n        border: true,\r\n        padding: true,\r\n        maxHeight: null,\r\n        height: null,\r\n        focus: false,\r\n        // Events\r\n        onclick: null,\r\n        onfocus: null,\r\n        onblur: null,\r\n        onload: null,\r\n        onkeyup: null,\r\n        onkeydown: null,\r\n        onchange: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Private controllers\r\n    var imageResize = 0;\r\n    var editorTimer = null;\r\n    var editorAction = null;\r\n    var files = [];\r\n\r\n    // Make sure element is empty\r\n    el.innerHTML = '';\r\n\r\n    // Keep the reference for the container\r\n    obj.el = el;\r\n\r\n    if (typeof(obj.options.onclick) == 'function') {\r\n        el.onclick = function(e) {\r\n            obj.options.onclick(el, obj, e);\r\n        }\r\n    }\r\n\r\n    // Prepare container\r\n    el.classList.add('jeditor-container');\r\n\r\n    // Padding\r\n    if (obj.options.padding == true) {\r\n        el.classList.add('jeditor-padding');\r\n    }\r\n\r\n    // Border\r\n    if (obj.options.border == false) {\r\n        el.style.border = '0px';\r\n    }\r\n\r\n    // Snippet\r\n    var snippet = document.createElement('div');\r\n    snippet.className = 'jsnippet';\r\n    snippet.setAttribute('contenteditable', false);\r\n\r\n    // Toolbar\r\n    var toolbar = document.createElement('div');\r\n    toolbar.className = 'jeditor-toolbar';\r\n\r\n    // Create editor\r\n    var editor = document.createElement('div');\r\n    editor.setAttribute('contenteditable', true);\r\n    editor.setAttribute('spellcheck', false);\r\n    editor.className = 'jeditor';\r\n\r\n    // Placeholder\r\n    if (obj.options.placeholder) {\r\n        editor.setAttribute('data-placeholder', obj.options.placeholder);\r\n    }\r\n\r\n    // Max height\r\n    if (obj.options.maxHeight || obj.options.height) {\r\n        editor.style.overflowY = 'auto';\r\n\r\n        if (obj.options.maxHeight) {\r\n            editor.style.maxHeight = obj.options.maxHeight;\r\n        }\r\n        if (obj.options.height) {\r\n            editor.style.height = obj.options.height;\r\n        }\r\n    }\r\n\r\n    // Set editor initial value\r\n    if (obj.options.value) {\r\n        var value = obj.options.value;\r\n    } else {\r\n        var value = el.innerHTML ? el.innerHTML : ''; \r\n    }\r\n\r\n    if (! value) {\r\n        var value = '';\r\n    }\r\n\r\n    /**\r\n     * Onchange event controllers\r\n     */\r\n    var change = function(e) {\r\n        if (typeof(obj.options.onchange) == 'function') { \r\n            obj.options.onchange(el, obj, e);\r\n        }\r\n\r\n        // Update value\r\n        obj.options.value = obj.getData();\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract images from a HTML string\r\n     */\r\n    var extractImageFromHtml = function(html) {\r\n        // Create temp element\r\n        var div = document.createElement('div');\r\n        div.innerHTML = html;\r\n\r\n        // Extract images\r\n        var img = div.querySelectorAll('img');\r\n\r\n        if (img.length) {\r\n            for (var i = 0; i < img.length; i++) {\r\n                obj.addImage(img[i].src);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Insert node at caret\r\n     */\r\n    var insertNodeAtCaret = function(newNode) {\r\n        var sel, range;\r\n\r\n        if (window.getSelection) {\r\n            sel = window.getSelection();\r\n            if (sel.rangeCount) {\r\n                range = sel.getRangeAt(0);\r\n                var selectedText = range.toString();\r\n                range.deleteContents();\r\n                range.insertNode(newNode); \r\n                // move the cursor after element\r\n                range.setStartAfter(newNode);\r\n                range.setEndAfter(newNode); \r\n                sel.removeAllRanges();\r\n                sel.addRange(range);\r\n            }\r\n        }\r\n    }\r\n\r\n    var updateTotalImages = function() {\r\n        var o = null;\r\n        if (o = snippet.children[0]) {\r\n            // Make sure is a grid\r\n            if (! o.classList.contains('jslider-grid')) {\r\n                o.classList.add('jslider-grid');\r\n            }\r\n            // Quantify of images\r\n            var number = o.children.length;\r\n            // Set the configuration of the grid\r\n            o.setAttribute('data-number', number > 4 ? 4 : number);\r\n            // Total of images inside the grid\r\n            if (number > 4) {\r\n                o.setAttribute('data-total', number - 4);\r\n            } else {\r\n                o.removeAttribute('data-total');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Append image to the snippet\r\n     */\r\n    var appendImage = function(image) {\r\n        if (! snippet.innerHTML) {\r\n            appendElement({});\r\n        }\r\n        snippet.children[0].appendChild(image);\r\n        updateTotalImages();\r\n    }\r\n\r\n    /**\r\n     * Append snippet\r\n     * @Param object data\r\n     */\r\n    var appendElement = function(data) {\r\n        // Reset snippet\r\n        snippet.innerHTML = '';\r\n\r\n        // Attributes\r\n        var a = [ 'image', 'title', 'description', 'host', 'url' ];\r\n\r\n        for (var i = 0; i < a.length; i++) {\r\n            var div = document.createElement('div');\r\n            div.className = 'jsnippet-' + a[i];\r\n            div.setAttribute('data-k', a[i]);\r\n            snippet.appendChild(div);\r\n            if (data[a[i]]) {\r\n                if (a[i] == 'image') {\r\n                    if (! Array.isArray(data.image)) {\r\n                        data.image = [ data.image ];\r\n                    }\r\n                    for (var j = 0; j < data.image.length; j++) {\r\n                        var img = document.createElement('img');\r\n                        img.src = data.image[j];\r\n                        div.appendChild(img);\r\n                    }\r\n                } else {\r\n                    div.innerHTML = data[a[i]];\r\n                }\r\n            }\r\n        }\r\n\r\n        editor.appendChild(document.createElement('br'));\r\n        editor.appendChild(snippet);\r\n    }\r\n\r\n    var verifyEditor = function() {\r\n        clearTimeout(editorTimer);\r\n        editorTimer = setTimeout(function() {\r\n            var snippet = editor.querySelector('.jsnippet');\r\n            if (! snippet) {\r\n                var html = editor.innerHTML.replace(/\\n/g, ' ');\r\n                var container = document.createElement('div');\r\n                container.innerHTML = html;\r\n                var text = container.innerText; \r\n                var url = jSuites.editor.detectUrl(text);\r\n\r\n                if (url) {\r\n                    if (url[0].substr(-3) == 'jpg' || url[0].substr(-3) == 'png' || url[0].substr(-3) == 'gif') {\r\n                         obj.addImage(url[0], true);\r\n                    } else {\r\n                        var id = jSuites.editor.youtubeParser(url[0]);\r\n                        obj.parseWebsite(url[0], id);\r\n                    }\r\n                }\r\n            }\r\n        }, 1000);\r\n    }\r\n\r\n    obj.parseContent = function() {\r\n        verifyEditor();\r\n    }\r\n\r\n    obj.parseWebsite = function(url, youtubeId) {\r\n        if (! obj.options.remoteParser) {\r\n            console.log('The remoteParser is not defined');\r\n        } else {\r\n            // Youtube definitions\r\n            if (youtubeId) {\r\n                var url = 'https://www.youtube.com/watch?v=' + youtubeId;\r\n            }\r\n\r\n            var p = {\r\n                title: '',\r\n                description: '',\r\n                image: '',\r\n                host: url.split('/')[2],\r\n                url: url,\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.remoteParser + encodeURI(url.trim()),\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Get title\r\n                    if (result.title) {\r\n                        p.title = result.title;\r\n                    }\r\n                    // Description\r\n                    if (result.description) {\r\n                        p.description = result.description;\r\n                    }\r\n                    // Host\r\n                    if (result.host) {\r\n                        p.host = result.host;\r\n                    }\r\n                    // Url\r\n                    if (result.url) {\r\n                        p.url = result.url;\r\n                    }\r\n                    // Append snippet\r\n                    appendElement(p);\r\n                    // Add image\r\n                    if (result.image) {\r\n                        obj.addImage(result.image, true);\r\n                    } else if (result['og:image']) {\r\n                        obj.addImage(result['og:image'], true);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set editor value\r\n     */\r\n    obj.setData = function(html) {\r\n        editor.innerHTML = html;\r\n\r\n        if (obj.options.focus) {\r\n            jSuites.editor.setCursor(editor, true);\r\n        }\r\n\r\n        // Reset files container\r\n        files = [];\r\n    }\r\n\r\n    obj.getFiles = function() {\r\n        var f = editor.querySelectorAll('.jfile');\r\n        var d = [];\r\n        for (var i = 0; i < f.length; i++) {\r\n            if (files[f[i].src]) {\r\n                d.push(files[f[i].src]);\r\n            }\r\n        }\r\n        return d;\r\n    }\r\n\r\n    obj.getText = function() {\r\n        return editor.innerText;\r\n    }\r\n\r\n    /**\r\n     * Get editor data\r\n     */\r\n    obj.getData = function(json) {\r\n        if (! json) {\r\n            var data = editor.innerHTML;\r\n        } else {\r\n            var data = {\r\n                content : '',\r\n            }\r\n\r\n            // Get snippet\r\n            if (snippet.innerHTML) {\r\n                var index = 0;\r\n                data.snippet = {};\r\n                for (var i = 0; i < snippet.children.length; i++) {\r\n                    // Get key from element\r\n                    var key = snippet.children[i].getAttribute('data-k');\r\n                    if (key) {\r\n                        if (key == 'image') {\r\n                            if (! data.snippet.image) {\r\n                                data.snippet.image = [];\r\n                            }\r\n                            // Get all images\r\n                            for (var j = 0; j < snippet.children[i].children.length; j++) {\r\n                                data.snippet.image.push(snippet.children[i].children[j].getAttribute('src'))\r\n                            }\r\n                        } else {\r\n                            data.snippet[key] = snippet.children[i].innerHTML;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Get files\r\n            var f = Object.keys(files);\r\n            if (f.length) {\r\n                data.files = [];\r\n                for (var i = 0; i < f.length; i++) {\r\n                    data.files.push(files[f[i]]);\r\n                }\r\n            }\r\n\r\n            // Get content\r\n            var text = editor.innerHTML;\r\n            text = text.replace(/<br>/g, \"\\n\");\r\n            text = text.replace(/<\\/div>/g, \"<\\/div>\\n\");\r\n            text = text.replace(/<(?:.|\\n)*?>/gm, \"\");\r\n            data.content = text.trim();\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    // Reset\r\n    obj.reset = function() {\r\n        editor.innerHTML = '';\r\n        snippet.innerHTML = '';\r\n        files = [];\r\n    }\r\n\r\n    obj.addPdf = function(data) {\r\n        if (data.result.substr(0,4) != 'data') {\r\n            console.error('Invalid source');\r\n        } else {\r\n            var canvas = document.createElement('canvas');\r\n            canvas.width = 60;\r\n            canvas.height = 60;\r\n\r\n            var img = new Image();\r\n            var ctx = canvas.getContext('2d');\r\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n            canvas.toBlob(function(blob) {\r\n                var newImage = document.createElement('img');\r\n                newImage.src = window.URL.createObjectURL(blob);\r\n                newImage.title = data.name;\r\n                newImage.className = 'jfile pdf';\r\n\r\n                files[newImage.src] = {\r\n                    file: newImage.src,\r\n                    extension: 'pdf',\r\n                    content: data.result,\r\n                }\r\n\r\n                insertNodeAtCaret(newImage);\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.addImage = function(src, asSnippet) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                extension = extension[1];\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n            }\r\n\r\n            var img = new Image();\r\n\r\n            img.onload = function onload() {\r\n                var canvas = document.createElement('canvas');\r\n                canvas.width = img.width;\r\n                canvas.height = img.height;\r\n\r\n                var ctx = canvas.getContext('2d');\r\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                canvas.toBlob(function(blob) {\r\n                    var newImage = document.createElement('img');\r\n                    newImage.src = window.URL.createObjectURL(blob);\r\n                    newImage.classList.add('jfile');\r\n                    newImage.setAttribute('tabindex', '900');\r\n                    files[newImage.src] = {\r\n                        file: newImage.src,\r\n                        extension: extension,\r\n                        content: canvas.toDataURL(),\r\n                    }\r\n\r\n                    if (obj.options.dropAsSnippet || asSnippet) {\r\n                        appendImage(newImage);\r\n                        // Just to understand the attachment is part of a snippet\r\n                        files[newImage.src].snippet = true;\r\n                    } else {\r\n                        insertNodeAtCaret(newImage);\r\n                    }\r\n\r\n                    change();\r\n                });\r\n            };\r\n\r\n            img.src = src;\r\n        }\r\n    }\r\n\r\n    obj.addFile = function(files) {\r\n        var reader = [];\r\n\r\n        for (var i = 0; i < files.length; i++) {\r\n            if (files[i].size > obj.options.maxFileSize) {\r\n                alert('The file is too big');\r\n            } else {\r\n                // Only PDF or Images\r\n                var type = files[i].type.split('/');\r\n\r\n                if (type[0] == 'image') {\r\n                    type = 1;\r\n                } else if (type[1] == 'pdf') {\r\n                    type = 2;\r\n                } else {\r\n                    type = 0;\r\n                }\r\n\r\n                if (type) {\r\n                    // Create file\r\n                    reader[i] = new FileReader();\r\n                    reader[i].index = i;\r\n                    reader[i].type = type;\r\n                    reader[i].name = files[i].name;\r\n                    reader[i].date = files[i].lastModified;\r\n                    reader[i].size = files[i].size;\r\n                    reader[i].addEventListener(\"load\", function (data) {\r\n                        // Get result\r\n                        if (data.target.type == 2) {\r\n                            if (obj.options.acceptFiles == true) {\r\n                                obj.addPdf(data.target);\r\n                            }\r\n                        } else {\r\n                            obj.addImage(data.target.result);\r\n                        }\r\n                    }, false);\r\n\r\n                    reader[i].readAsDataURL(files[i])\r\n                } else {\r\n                    alert('The extension is not allowed');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Destroy\r\n    obj.destroy = function() {\r\n        editor.removeEventListener('mouseup', editorMouseUp);\r\n        editor.removeEventListener('mousedown', editorMouseDown);\r\n        editor.removeEventListener('mousemove', editorMouseMove);\r\n        editor.removeEventListener('keyup', editorKeyUp);\r\n        editor.removeEventListener('keydown', editorKeyDown);\r\n        editor.removeEventListener('dragstart', editorDragStart);\r\n        editor.removeEventListener('dragenter', editorDragEnter);\r\n        editor.removeEventListener('dragover', editorDragOver);\r\n        editor.removeEventListener('drop', editorDrop);\r\n        editor.removeEventListener('paste', editorPaste);\r\n\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            editor.removeEventListener('blur', editorBlur);\r\n        }\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            editor.removeEventListener('focus', editorFocus);\r\n        }\r\n\r\n        el.editor = null;\r\n        el.classList.remove('jeditor-container');\r\n\r\n        toolbar.remove();\r\n        snippet.remove();\r\n        editor.remove();\r\n    }\r\n\r\n    var isLetter = function (str) {\r\n        var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]+)/g;\r\n        return str.match(regex) ? 1 : 0;\r\n    }\r\n\r\n    // Event handlers\r\n    var editorMouseUp = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            editorAction.e.classList.remove('resizing');\r\n        }\r\n\r\n        editorAction = false;\r\n    }\r\n\r\n    var editorMouseDown = function(e) {\r\n        var close = function(snippet) {\r\n            var rect = snippet.getBoundingClientRect();\r\n            if (rect.width - (e.clientX - rect.left) < 40 && e.clientY - rect.top < 40) {\r\n                snippet.innerHTML = '';\r\n                snippet.remove();\r\n            }\r\n        }\r\n\r\n        if (e.target.tagName == 'IMG') {\r\n            if (e.target.style.cursor) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                editorAction = {\r\n                    e: e.target,\r\n                    x: e.clientX,\r\n                    y: e.clientY,\r\n                    w: rect.width,\r\n                    h: rect.height,\r\n                    d: e.target.style.cursor,\r\n                }\r\n\r\n                if (! e.target.width) {\r\n                    e.target.width = rect.width + 'px';\r\n                }\r\n\r\n                if (! e.target.height) {\r\n                    e.target.height = rect.height + 'px';\r\n                }\r\n\r\n                var s = window.getSelection();\r\n                if (s.rangeCount) {\r\n                    for (var i = 0; i < s.rangeCount; i++) {\r\n                        s.removeRange(s.getRangeAt(i));\r\n                    }\r\n                }\r\n\r\n                e.target.classList.add('resizing');\r\n            } else {\r\n                editorAction = true;\r\n            }\r\n        } else { \r\n            if (e.target.classList.contains('jsnippet')) {\r\n                close(e.target);\r\n            } else if (e.target.parentNode.classList.contains('jsnippet')) {\r\n                close(e.target.parentNode);\r\n            }\r\n\r\n            editorAction = true;\r\n        }\r\n    }\r\n\r\n    var editorMouseMove = function(e) {\r\n        if (e.target.tagName == 'IMG' && ! e.target.parentNode.classList.contains('jsnippet-image') && obj.options.allowImageResize == true) {\r\n            if (e.target.getAttribute('tabindex')) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                if (e.clientY - rect.top < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'ne-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'nw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 'n-resize';\r\n                    }\r\n                } else if (rect.height - (e.clientY - rect.top) < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'se-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'sw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 's-resize';\r\n                    }\r\n                } else if (rect.width - (e.clientX - rect.left) < 5) {\r\n                    e.target.style.cursor = 'e-resize';\r\n                } else if (e.clientX - rect.left < 5) {\r\n                    e.target.style.cursor = 'w-resize';\r\n                } else {\r\n                    e.target.style.cursor = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Move\r\n        if (e.which == 1 && editorAction && editorAction.d) {\r\n            if (editorAction.d == 'e-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'se-resize') {\r\n                editorAction.e.width = (editorAction.w + (e.clientX - editorAction.x));\r\n\r\n                if (e.shiftKey) {\r\n                    var newHeight = (e.clientX - editorAction.x) * (editorAction.h / editorAction.w);\r\n                    editorAction.e.height = editorAction.h + newHeight;\r\n                } else {\r\n                    var newHeight =  null;\r\n                }\r\n            }\r\n\r\n            if (! newHeight) {\r\n                if (editorAction.d == 's-resize' || editorAction.d == 'se-resize' || editorAction.d == 'sw-resize') {\r\n                    if (! e.shiftKey) {\r\n                        editorAction.e.height = editorAction.h + (e.clientY - editorAction.y);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    var editorKeyUp = function(e) {\r\n        if (! editor.innerHTML) {\r\n            editor.innerHTML = '<div><br></div>';\r\n        }\r\n\r\n        if (typeof(obj.options.onkeyup) == 'function') { \r\n            obj.options.onkeyup(el, obj, e);\r\n        }\r\n    }\r\n\r\n\r\n    var editorKeyDown = function(e) {\r\n        // Check for URL\r\n        if (obj.options.parseURL == true) {\r\n            verifyEditor();\r\n        }\r\n\r\n        if (typeof(obj.options.onkeydown) == 'function') { \r\n            obj.options.onkeydown(el, obj, e);\r\n        }\r\n\r\n        if (e.key == 'Delete') {\r\n            if (e.target.tagName == 'IMG' && e.target.parentNode.classList.contains('jsnippet-image')) {\r\n                e.target.remove();\r\n                updateTotalImages();\r\n            }\r\n        }\r\n    }\r\n\r\n    // Elements to be removed\r\n    var remove = [HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement];\r\n\r\n    // Valid CSS attributes\r\n    var validStyle = ['color', 'font-weight', 'font-size', 'background', 'background-color', 'margin'];\r\n\r\n    var parse = function(element) {\r\n       // Remove attributes\r\n       if (element.attributes && element.attributes.length) {\r\n           var image = null;\r\n           var style = null;\r\n           // Process style attribute\r\n           var elementStyle = element.getAttribute('style');\r\n           if (elementStyle) {\r\n               style = [];\r\n               var t = elementStyle.split(';');\r\n               for (var j = 0; j < t.length; j++) {\r\n                   var v = t[j].trim().split(':');\r\n                   if (validStyle.indexOf(v[0].trim()) >= 0) {\r\n                       var k = v.shift();\r\n                       var v = v.join(':');\r\n                       style.push(k + ':' + v);\r\n                   }\r\n               }\r\n           }\r\n           // Process image\r\n           if (element.tagName.toUpperCase() == 'IMG') {\r\n               if (! obj.options.acceptImages) {\r\n                   element.parentNode.removeChild(element);\r\n               } else {\r\n                   // Check if is data\r\n                   element.setAttribute('tabindex', '900');\r\n                   // Check attributes for persistance\r\n                   obj.addImage(element.src);\r\n               }\r\n           } else {\r\n               // Remove attributes\r\n               var numAttributes = element.attributes.length - 1;\r\n               for (var i = numAttributes; i >= 0 ; i--) {\r\n                   element.removeAttribute(element.attributes[i].name);\r\n               }\r\n           }\r\n           element.style = '';\r\n           // Add valid style\r\n           if (style && style.length) {\r\n               element.setAttribute('style', style.join(';'));\r\n           }\r\n       }\r\n       // Parse children\r\n       if (element.children.length) {\r\n           for (var i = 0; i < element.children.length; i++) {\r\n               parse(element.children[i]);\r\n           }\r\n       }\r\n\r\n       if (remove.indexOf(element.constructor) >= 0) {\r\n           element.remove();\r\n       }\r\n    }\r\n\r\n    var filter = function(data) {\r\n        if (data) {\r\n            data = data.replace(new RegExp('<!--(.*?)-->', 'gsi'), '');\r\n        }\r\n        var parser = new DOMParser();\r\n        var d = parser.parseFromString(data, \"text/html\");\r\n        parse(d);\r\n        var span = document.createElement('span');\r\n        span.innerHTML = d.firstChild.innerHTML;\r\n        return span;\r\n    } \r\n\r\n    var editorPaste = function(e) {\r\n        if (obj.options.filterPaste == true) {\r\n            if (e.clipboardData || e.originalEvent.clipboardData) {\r\n                var html = (e.originalEvent || e).clipboardData.getData('text/html');\r\n                var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n                var file = (e.originalEvent || e).clipboardData.files\r\n            } else if (window.clipboardData) {\r\n                var html = window.clipboardData.getData('Html');\r\n                var text = window.clipboardData.getData('Text');\r\n                var file = window.clipboardData.files\r\n            }\r\n\r\n            if (file.length) {\r\n                // Paste a image from the clipboard\r\n                obj.addFile(file);\r\n            } else {\r\n                if (! html) {\r\n                    html = text.split('\\r\\n');\r\n                    if (! e.target.innerText) {\r\n                        html.map(function(v) {\r\n                            var d = document.createElement('div');\r\n                            d.innerText = v;\r\n                            editor.appendChild(d);\r\n                        });\r\n                    } else {\r\n                        html = html.map(function(v) {\r\n                            return '<div>' + v + '</div>';\r\n                        });\r\n                        document.execCommand('insertHtml', false, html.join(''));\r\n                    }\r\n                } else {\r\n                    var d = filter(html);\r\n                    // Paste to the editor\r\n                    insertNodeAtCaret(d);\r\n                }\r\n            }\r\n\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragStart = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragEnter = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            el.classList.add('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragOver = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            if (editorTimer) {\r\n                clearTimeout(editorTimer);\r\n            }\r\n\r\n            editorTimer = setTimeout(function() {\r\n                el.classList.remove('jeditor-dragging');\r\n            }, 100);\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDrop = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            // Position caret on the drop\r\n            var range = null;\r\n            if (document.caretRangeFromPoint) {\r\n                range=document.caretRangeFromPoint(e.clientX, e.clientY);\r\n            } else if (e.rangeParent) {\r\n                range=document.createRange();\r\n                range.setStart(e.rangeParent,e.rangeOffset);\r\n            }\r\n            var sel = window.getSelection();\r\n            sel.removeAllRanges();\r\n            sel.addRange(range);\r\n            sel.anchorNode.parentNode.focus();\r\n\r\n            var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n            var text = (e.originalEvent || e).dataTransfer.getData('text/plain');\r\n            var file = (e.originalEvent || e).dataTransfer.files;\r\n    \r\n            if (file.length) {\r\n                obj.addFile(file);\r\n            } else if (text) {\r\n                extractImageFromHtml(html);\r\n            }\r\n\r\n            el.classList.remove('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorBlur = function(e) {\r\n        // Blur\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            obj.options.onblur(el, obj, e);\r\n        }\r\n\r\n        change(e);\r\n    }\r\n\r\n    var editorFocus = function(e) {\r\n        // Focus\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            obj.options.onfocus(el, obj, e);\r\n        }\r\n    }\r\n\r\n    editor.addEventListener('mouseup', editorMouseUp);\r\n    editor.addEventListener('mousedown', editorMouseDown);\r\n    editor.addEventListener('mousemove', editorMouseMove);\r\n    editor.addEventListener('keyup', editorKeyUp);\r\n    editor.addEventListener('keydown', editorKeyDown);\r\n    editor.addEventListener('dragstart', editorDragStart);\r\n    editor.addEventListener('dragenter', editorDragEnter);\r\n    editor.addEventListener('dragover', editorDragOver);\r\n    editor.addEventListener('drop', editorDrop);\r\n    editor.addEventListener('paste', editorPaste);\r\n    editor.addEventListener('focus', editorFocus);\r\n    editor.addEventListener('blur', editorBlur);\r\n\r\n    // Onload\r\n    if (typeof(obj.options.onload) == 'function') {\r\n        obj.options.onload(el, obj, editor);\r\n    }\r\n\r\n    // Set value to the editor\r\n    editor.innerHTML = value;\r\n\r\n    // Append editor to the containre\r\n    el.appendChild(editor);\r\n\r\n    // Snippet\r\n    if (obj.options.snippet) {\r\n        appendElement(obj.options.snippet);\r\n    }\r\n\r\n    // Default toolbar\r\n    if (obj.options.toolbar == null) {\r\n        obj.options.toolbar = jSuites.editor.getDefaultToolbar();\r\n    }\r\n\r\n    // Add toolbar\r\n    if (obj.options.toolbar) {\r\n        // Append to the DOM\r\n        el.appendChild(toolbar);\r\n        // Create toolbar\r\n        jSuites.toolbar(toolbar, {\r\n            container: true,\r\n            responsive: true,\r\n            items: obj.options.toolbar\r\n        });\r\n    }\r\n\r\n    // Focus to the editor\r\n    if (obj.options.focus) {\r\n        jSuites.editor.setCursor(editor, obj.options.focus == 'initial' ? true : false);\r\n    }\r\n\r\n    // Change method\r\n    el.change = obj.setData;\r\n\r\n    // Global generic value handler\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            // Data type\r\n            var o = el.getAttribute('data-html') === 'true' ? false : true;\r\n            return obj.getData(o);\r\n        } else {\r\n            obj.setData(val);\r\n        }\r\n    }\r\n\r\n    el.editor = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.editor.setCursor = function(element, first) {\r\n    element.focus();\r\n    document.execCommand('selectAll');\r\n    var sel = window.getSelection();\r\n    var range = sel.getRangeAt(0);\r\n    if (first == true) {\r\n        var node = range.startContainer;\r\n        var size = 0;\r\n    } else {\r\n        var node = range.endContainer;\r\n        var size = node.length;\r\n    }\r\n    range.setStart(node, size);\r\n    range.setEnd(node, size);\r\n    sel.removeAllRanges();\r\n    sel.addRange(range);\r\n}\r\n\r\njSuites.editor.getDomain = function(url) {\r\n    return url.replace('http://','').replace('https://','').replace('www.','').split(/[/?#]/)[0].split(/:/g)[0];\r\n}\r\n\r\njSuites.editor.detectUrl = function(text) {\r\n    var expression = /(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig;\r\n    var links = text.match(expression);\r\n\r\n    if (links) {\r\n        if (links[0].substr(0,3) == 'www') {\r\n            links[0] = 'http://' + links[0];\r\n        }\r\n    }\r\n\r\n    return links;\r\n}\r\n\r\njSuites.editor.youtubeParser = function(url) {\r\n    var regExp = /^.*((youtu.be\\/)|(v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#\\&\\?]*).*/;\r\n    var match = url.match(regExp);\r\n\r\n    return (match && match[7].length == 11) ? match[7] : false;\r\n}\r\n\r\njSuites.editor.getDefaultToolbar = function() { \r\n    return [\r\n        {\r\n            content: 'undo',\r\n            onclick: function() {\r\n                document.execCommand('undo');\r\n            }\r\n        },\r\n        {\r\n            content: 'redo',\r\n            onclick: function() {\r\n                document.execCommand('redo');\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_bold',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('bold');\r\n\r\n                if (document.queryCommandState(\"bold\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_italic',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('italic');\r\n\r\n                if (document.queryCommandState(\"italic\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_underline',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('underline');\r\n\r\n                if (document.queryCommandState(\"underline\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_list_bulleted',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_list_numbered',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertOrderedList');\r\n\r\n                if (document.queryCommandState(\"insertOrderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_increase',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('indent', true, null);\r\n\r\n                if (document.queryCommandState(\"indent\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_decrease',\r\n            onclick: function() {\r\n                document.execCommand('outdent');\r\n\r\n                if (document.queryCommandState(\"outdent\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }/*,\r\n        {\r\n            icon: ['format_align_left', 'format_align_right', 'format_align_center'],\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }\r\n        {\r\n            type:'select',\r\n            items: ['Verdana','Arial','Courier New'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            type:'select',\r\n            items: ['10px','12px','14px','16px','18px','20px','22px'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_left',\r\n            onclick: function() {\r\n                document.execCommand('JustifyLeft');\r\n\r\n                if (document.queryCommandState(\"JustifyLeft\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_center',\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_right',\r\n            onclick: function() {\r\n                document.execCommand('justifyRight');\r\n\r\n                if (document.queryCommandState(\"justifyRight\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_justify',\r\n            onclick: function() {\r\n                document.execCommand('justifyFull');\r\n\r\n                if (document.queryCommandState(\"justifyFull\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_list_bulleted',\r\n            onclick: function() {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }*/\r\n    ];\r\n}\r\n\r\n\r\njSuites.focus = function(el) {\r\n    if (el.innerText.length) {\r\n        var range = document.createRange();\r\n        var sel = window.getSelection();\r\n        var node = el.childNodes[el.childNodes.length-1];\r\n        range.setStart(node, node.length)\r\n        range.collapse(true)\r\n        sel.removeAllRanges()\r\n        sel.addRange(range)\r\n        el.scrollLeft = el.scrollWidth;\r\n    }\r\n}\r\n\r\njSuites.isNumeric = (function (num) {\r\n    return !isNaN(num) && num !== null && num !== '';\r\n});\r\n\r\njSuites.guid = function() {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n        return v.toString(16);\r\n    });\r\n}\r\n\r\njSuites.getNode = function() {\r\n    var node = document.getSelection().anchorNode;\r\n    if (node) {\r\n        return (node.nodeType == 3 ? node.parentNode : node);\r\n    } else {\r\n        return null;\r\n    }\r\n}\r\n/**\r\n * Generate hash from a string\r\n */\r\njSuites.hash = function(str) {\r\n    var hash = 0, i, chr;\r\n\r\n    if (str.length === 0) {\r\n        return hash;\r\n    } else {\r\n        for (i = 0; i < str.length; i++) {\r\n            chr = str.charCodeAt(i);\r\n            if (chr > 32) {\r\n                hash = ((hash << 5) - hash) + chr;\r\n                hash |= 0;\r\n            }\r\n        }\r\n    }\r\n    return hash;\r\n}\r\n\r\n/**\r\n * Generate a random color\r\n */\r\njSuites.randomColor = function(h) {\r\n    var lum = -0.25;\r\n    var hex = String('#' + Math.random().toString(16).slice(2, 8).toUpperCase()).replace(/[^0-9a-f]/gi, '');\r\n    if (hex.length < 6) {\r\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\r\n    }\r\n    var rgb = [], c, i;\r\n    for (i = 0; i < 3; i++) {\r\n        c = parseInt(hex.substr(i * 2, 2), 16);\r\n        c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);\r\n        rgb.push((\"00\" + c).substr(c.length));\r\n    }\r\n\r\n    // Return hex\r\n    if (h == true) {\r\n        return '#' + jSuites.two(rgb[0].toString(16)) + jSuites.two(rgb[1].toString(16)) + jSuites.two(rgb[2].toString(16));\r\n    }\r\n\r\n    return rgb;\r\n}\r\n\r\njSuites.getWindowWidth = function() {\r\n    var w = window,\r\n    d = document,\r\n    e = d.documentElement,\r\n    g = d.getElementsByTagName('body')[0],\r\n    x = w.innerWidth || e.clientWidth || g.clientWidth;\r\n    return x;\r\n}\r\n\r\njSuites.getWindowHeight = function() {\r\n    var w = window,\r\n    d = document,\r\n    e = d.documentElement,\r\n    g = d.getElementsByTagName('body')[0],\r\n    y = w.innerHeight|| e.clientHeight|| g.clientHeight;\r\n    return  y;\r\n}\r\n\r\njSuites.getPosition = function(e) {\r\n    if (e.changedTouches && e.changedTouches[0]) {\r\n        var x = e.changedTouches[0].pageX;\r\n        var y = e.changedTouches[0].pageY;\r\n    } else {\r\n        var x = (window.Event) ? e.pageX : e.clientX + (document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft);\r\n        var y = (window.Event) ? e.pageY : e.clientY + (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop);\r\n    }\r\n\r\n    return [ x, y ];\r\n}\r\n\r\njSuites.click = function(el) {\r\n    if (el.click) {\r\n        el.click();\r\n    } else {\r\n        var evt = new MouseEvent('click', {\r\n            bubbles: true,\r\n            cancelable: true,\r\n            view: window\r\n        });\r\n        el.dispatchEvent(evt);\r\n    }\r\n}\r\n\r\njSuites.findElement = function(element, condition) {\r\n    var foundElement = false;\r\n\r\n    function path (element) {\r\n        if (element && ! foundElement) {\r\n            if (typeof(condition) == 'function') {\r\n                foundElement = condition(element)\r\n            } else if (typeof(condition) == 'string') {\r\n                if (element.classList && element.classList.contains(condition)) {\r\n                    foundElement = element;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (element.parentNode && ! foundElement) {\r\n            path(element.parentNode);\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return foundElement;\r\n}\r\n\r\n// Two digits\r\njSuites.two = function(value) {\r\n    value = '' + value;\r\n    if (value.length == 1) {\r\n        value = '0' + value;\r\n    }\r\n    return value;\r\n}\r\n\r\njSuites.sha512 = (function(str) {\r\n    function int64(msint_32, lsint_32) {\r\n        this.highOrder = msint_32;\r\n        this.lowOrder = lsint_32;\r\n    }\r\n\r\n    var H = [new int64(0x6a09e667, 0xf3bcc908), new int64(0xbb67ae85, 0x84caa73b),\r\n        new int64(0x3c6ef372, 0xfe94f82b), new int64(0xa54ff53a, 0x5f1d36f1),\r\n        new int64(0x510e527f, 0xade682d1), new int64(0x9b05688c, 0x2b3e6c1f),\r\n        new int64(0x1f83d9ab, 0xfb41bd6b), new int64(0x5be0cd19, 0x137e2179)];\r\n\r\n    var K = [new int64(0x428a2f98, 0xd728ae22), new int64(0x71374491, 0x23ef65cd),\r\n        new int64(0xb5c0fbcf, 0xec4d3b2f), new int64(0xe9b5dba5, 0x8189dbbc),\r\n        new int64(0x3956c25b, 0xf348b538), new int64(0x59f111f1, 0xb605d019),\r\n        new int64(0x923f82a4, 0xaf194f9b), new int64(0xab1c5ed5, 0xda6d8118),\r\n        new int64(0xd807aa98, 0xa3030242), new int64(0x12835b01, 0x45706fbe),\r\n        new int64(0x243185be, 0x4ee4b28c), new int64(0x550c7dc3, 0xd5ffb4e2),\r\n        new int64(0x72be5d74, 0xf27b896f), new int64(0x80deb1fe, 0x3b1696b1),\r\n        new int64(0x9bdc06a7, 0x25c71235), new int64(0xc19bf174, 0xcf692694),\r\n        new int64(0xe49b69c1, 0x9ef14ad2), new int64(0xefbe4786, 0x384f25e3),\r\n        new int64(0x0fc19dc6, 0x8b8cd5b5), new int64(0x240ca1cc, 0x77ac9c65),\r\n        new int64(0x2de92c6f, 0x592b0275), new int64(0x4a7484aa, 0x6ea6e483),\r\n        new int64(0x5cb0a9dc, 0xbd41fbd4), new int64(0x76f988da, 0x831153b5),\r\n        new int64(0x983e5152, 0xee66dfab), new int64(0xa831c66d, 0x2db43210),\r\n        new int64(0xb00327c8, 0x98fb213f), new int64(0xbf597fc7, 0xbeef0ee4),\r\n        new int64(0xc6e00bf3, 0x3da88fc2), new int64(0xd5a79147, 0x930aa725),\r\n        new int64(0x06ca6351, 0xe003826f), new int64(0x14292967, 0x0a0e6e70),\r\n        new int64(0x27b70a85, 0x46d22ffc), new int64(0x2e1b2138, 0x5c26c926),\r\n        new int64(0x4d2c6dfc, 0x5ac42aed), new int64(0x53380d13, 0x9d95b3df),\r\n        new int64(0x650a7354, 0x8baf63de), new int64(0x766a0abb, 0x3c77b2a8),\r\n        new int64(0x81c2c92e, 0x47edaee6), new int64(0x92722c85, 0x1482353b),\r\n        new int64(0xa2bfe8a1, 0x4cf10364), new int64(0xa81a664b, 0xbc423001),\r\n        new int64(0xc24b8b70, 0xd0f89791), new int64(0xc76c51a3, 0x0654be30),\r\n        new int64(0xd192e819, 0xd6ef5218), new int64(0xd6990624, 0x5565a910),\r\n        new int64(0xf40e3585, 0x5771202a), new int64(0x106aa070, 0x32bbd1b8),\r\n        new int64(0x19a4c116, 0xb8d2d0c8), new int64(0x1e376c08, 0x5141ab53),\r\n        new int64(0x2748774c, 0xdf8eeb99), new int64(0x34b0bcb5, 0xe19b48a8),\r\n        new int64(0x391c0cb3, 0xc5c95a63), new int64(0x4ed8aa4a, 0xe3418acb),\r\n        new int64(0x5b9cca4f, 0x7763e373), new int64(0x682e6ff3, 0xd6b2b8a3),\r\n        new int64(0x748f82ee, 0x5defb2fc), new int64(0x78a5636f, 0x43172f60),\r\n        new int64(0x84c87814, 0xa1f0ab72), new int64(0x8cc70208, 0x1a6439ec),\r\n        new int64(0x90befffa, 0x23631e28), new int64(0xa4506ceb, 0xde82bde9),\r\n        new int64(0xbef9a3f7, 0xb2c67915), new int64(0xc67178f2, 0xe372532b),\r\n        new int64(0xca273ece, 0xea26619c), new int64(0xd186b8c7, 0x21c0c207),\r\n        new int64(0xeada7dd6, 0xcde0eb1e), new int64(0xf57d4f7f, 0xee6ed178),\r\n        new int64(0x06f067aa, 0x72176fba), new int64(0x0a637dc5, 0xa2c898a6),\r\n        new int64(0x113f9804, 0xbef90dae), new int64(0x1b710b35, 0x131c471b),\r\n        new int64(0x28db77f5, 0x23047d84), new int64(0x32caab7b, 0x40c72493),\r\n        new int64(0x3c9ebe0a, 0x15c9bebc), new int64(0x431d67c4, 0x9c100d4c),\r\n        new int64(0x4cc5d4be, 0xcb3e42b6), new int64(0x597f299c, 0xfc657e2a),\r\n        new int64(0x5fcb6fab, 0x3ad6faec), new int64(0x6c44198c, 0x4a475817)];\r\n\r\n    var W = new Array(64);\r\n    var a, b, c, d, e, f, g, h, i, j;\r\n    var T1, T2;\r\n    var charsize = 8;\r\n\r\n    function utf8_encode(str) {\r\n        return unescape(encodeURIComponent(str));\r\n    }\r\n\r\n    function str2binb(str) {\r\n        var bin = [];\r\n        var mask = (1 << charsize) - 1;\r\n        var len = str.length * charsize;\r\n    \r\n        for (var i = 0; i < len; i += charsize) {\r\n            bin[i >> 5] |= (str.charCodeAt(i / charsize) & mask) << (32 - charsize - (i % 32));\r\n        }\r\n    \r\n        return bin;\r\n    }\r\n\r\n    function binb2hex(binarray) {\r\n        var hex_tab = \"0123456789abcdef\";\r\n        var str = \"\";\r\n        var length = binarray.length * 4;\r\n        var srcByte;\r\n\r\n        for (var i = 0; i < length; i += 1) {\r\n            srcByte = binarray[i >> 2] >> ((3 - (i % 4)) * 8);\r\n            str += hex_tab.charAt((srcByte >> 4) & 0xF) + hex_tab.charAt(srcByte & 0xF);\r\n        }\r\n\r\n        return str;\r\n    }\r\n\r\n    function safe_add_2(x, y) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (x.lowOrder & 0xFFFF) + (y.lowOrder & 0xFFFF);\r\n        msw = (x.lowOrder >>> 16) + (y.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (x.highOrder & 0xFFFF) + (y.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (x.highOrder >>> 16) + (y.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function safe_add_4(a, b, c, d) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF);\r\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function safe_add_5(a, b, c, d, e) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF) + (e.lowOrder & 0xFFFF);\r\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (e.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (e.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (e.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function maj(x, y, z) {\r\n        return new int64(\r\n            (x.highOrder & y.highOrder) ^ (x.highOrder & z.highOrder) ^ (y.highOrder & z.highOrder),\r\n            (x.lowOrder & y.lowOrder) ^ (x.lowOrder & z.lowOrder) ^ (y.lowOrder & z.lowOrder)\r\n        );\r\n    }\r\n\r\n    function ch(x, y, z) {\r\n        return new int64(\r\n            (x.highOrder & y.highOrder) ^ (~x.highOrder & z.highOrder),\r\n            (x.lowOrder & y.lowOrder) ^ (~x.lowOrder & z.lowOrder)\r\n        );\r\n    }\r\n\r\n    function rotr(x, n) {\r\n        if (n <= 32) {\r\n            return new int64(\r\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n)),\r\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n))\r\n            );\r\n        } else {\r\n            return new int64(\r\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n)),\r\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n))\r\n            );\r\n        }\r\n    }\r\n\r\n    function sigma0(x) {\r\n        var rotr28 = rotr(x, 28);\r\n        var rotr34 = rotr(x, 34);\r\n        var rotr39 = rotr(x, 39);\r\n\r\n        return new int64(\r\n            rotr28.highOrder ^ rotr34.highOrder ^ rotr39.highOrder,\r\n            rotr28.lowOrder ^ rotr34.lowOrder ^ rotr39.lowOrder\r\n        );\r\n    }\r\n\r\n    function sigma1(x) {\r\n        var rotr14 = rotr(x, 14);\r\n        var rotr18 = rotr(x, 18);\r\n        var rotr41 = rotr(x, 41);\r\n\r\n        return new int64(\r\n            rotr14.highOrder ^ rotr18.highOrder ^ rotr41.highOrder,\r\n            rotr14.lowOrder ^ rotr18.lowOrder ^ rotr41.lowOrder\r\n        );\r\n    }\r\n\r\n    function gamma0(x) {\r\n        var rotr1 = rotr(x, 1), rotr8 = rotr(x, 8), shr7 = shr(x, 7);\r\n\r\n        return new int64(\r\n            rotr1.highOrder ^ rotr8.highOrder ^ shr7.highOrder,\r\n            rotr1.lowOrder ^ rotr8.lowOrder ^ shr7.lowOrder\r\n        );\r\n    }\r\n\r\n    function gamma1(x) {\r\n        var rotr19 = rotr(x, 19);\r\n        var rotr61 = rotr(x, 61);\r\n        var shr6 = shr(x, 6);\r\n\r\n        return new int64(\r\n            rotr19.highOrder ^ rotr61.highOrder ^ shr6.highOrder,\r\n            rotr19.lowOrder ^ rotr61.lowOrder ^ shr6.lowOrder\r\n        );\r\n    }\r\n\r\n    function shr(x, n) {\r\n        if (n <= 32) {\r\n            return new int64(\r\n                x.highOrder >>> n,\r\n                x.lowOrder >>> n | (x.highOrder << (32 - n))\r\n            );\r\n        } else {\r\n            return new int64(\r\n                0,\r\n                x.highOrder << (32 - n)\r\n            );\r\n        }\r\n    }\r\n\r\n    var str = utf8_encode(str);\r\n    var strlen = str.length*charsize;\r\n    str = str2binb(str);\r\n\r\n    str[strlen >> 5] |= 0x80 << (24 - strlen % 32);\r\n    str[(((strlen + 128) >> 10) << 5) + 31] = strlen;\r\n\r\n    for (var i = 0; i < str.length; i += 32) {\r\n        a = H[0];\r\n        b = H[1];\r\n        c = H[2];\r\n        d = H[3];\r\n        e = H[4];\r\n        f = H[5];\r\n        g = H[6];\r\n        h = H[7];\r\n\r\n        for (var j = 0; j < 80; j++) {\r\n            if (j < 16) {\r\n                W[j] = new int64(str[j*2 + i], str[j*2 + i + 1]);\r\n            } else {\r\n                W[j] = safe_add_4(gamma1(W[j - 2]), W[j - 7], gamma0(W[j - 15]), W[j - 16]);\r\n            }\r\n\r\n            T1 = safe_add_5(h, sigma1(e), ch(e, f, g), K[j], W[j]);\r\n            T2 = safe_add_2(sigma0(a), maj(a, b, c));\r\n            h = g;\r\n            g = f;\r\n            f = e;\r\n            e = safe_add_2(d, T1);\r\n            d = c;\r\n            c = b;\r\n            b = a;\r\n            a = safe_add_2(T1, T2);\r\n        }\r\n\r\n        H[0] = safe_add_2(a, H[0]);\r\n        H[1] = safe_add_2(b, H[1]);\r\n        H[2] = safe_add_2(c, H[2]);\r\n        H[3] = safe_add_2(d, H[3]);\r\n        H[4] = safe_add_2(e, H[4]);\r\n        H[5] = safe_add_2(f, H[5]);\r\n        H[6] = safe_add_2(g, H[6]);\r\n        H[7] = safe_add_2(h, H[7]);\r\n    }\r\n\r\n    var binarray = [];\r\n    for (var i = 0; i < H.length; i++) {\r\n        binarray.push(H[i].highOrder);\r\n        binarray.push(H[i].lowOrder);\r\n    }\r\n\r\n    return binb2hex(binarray);\r\n});\r\n\r\nif (! jSuites.login) {\r\n    jSuites.login = {};\r\n    jSuites.login.sha512 = jSuites.sha512;\r\n}\r\n\r\njSuites.image = jSuites.upload = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        type: 'image',\r\n        extension: '*',\r\n        input: false,\r\n        minWidth: false,\r\n        maxWidth: null,\r\n        maxHeight: null,\r\n        maxJpegSizeBytes: null, // For example, 350Kb would be 350000\r\n        onchange: null,\r\n        multiple: false,\r\n        remoteParser: null,\r\n        text:{\r\n            extensionNotAllowed:'The extension is not allowed',\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Multiple\r\n    if (obj.options.multiple == true) {\r\n        el.setAttribute('data-multiple', true);\r\n    }\r\n\r\n    // Container\r\n    el.content = [];\r\n\r\n    // Upload icon\r\n    el.classList.add('jupload');\r\n\r\n    if (obj.options.input == true) {\r\n        el.classList.add('input');\r\n    }\r\n\r\n    obj.add = function(data) {\r\n        // Reset container for single files\r\n        if (obj.options.multiple == false) {\r\n            el.content = [];\r\n            el.innerText = '';\r\n        }\r\n\r\n        // Append to the element\r\n        if (obj.options.type == 'image') {\r\n            var img = document.createElement('img');\r\n            img.setAttribute('src', data.file);\r\n            img.setAttribute('tabindex', -1);\r\n            if (! el.getAttribute('name')) {\r\n                img.className = 'jfile';\r\n                img.content = data;\r\n            }\r\n            el.appendChild(img);\r\n        } else {\r\n            if (data.name) {\r\n                var name = data.name;\r\n            } else {\r\n                var name = data.file;\r\n            }\r\n            var div = document.createElement('div');\r\n            div.innerText = name || obj.options.type;\r\n            div.classList.add('jupload-item');\r\n            div.setAttribute('tabindex', -1);\r\n            el.appendChild(div);\r\n        }\r\n\r\n        if (data.content) {\r\n            data.file = jSuites.guid();\r\n        }\r\n\r\n        // Push content\r\n        el.content.push(data);\r\n\r\n        // Onchange\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, data);\r\n        }\r\n    }\r\n\r\n    obj.addFromFile = function(file) {\r\n        var type = file.type.split('/');\r\n        if (type[0] == obj.options.type) {\r\n            var readFile = new FileReader();\r\n            readFile.addEventListener(\"load\", function (v) {\r\n                var data = {\r\n                    file: v.srcElement.result,\r\n                    extension: file.name.substr(file.name.lastIndexOf('.') + 1),\r\n                    name: file.name,\r\n                    size: file.size,\r\n                    lastmodified: file.lastModified,\r\n                    content: v.srcElement.result,\r\n                }\r\n\r\n                obj.add(data);\r\n            });\r\n\r\n            readFile.readAsDataURL(file);\r\n        } else {\r\n            alert(obj.options.text.extensionNotAllowed);\r\n        }\r\n    }\r\n\r\n    obj.addFromUrl = function(src) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                var type = extension[0].replace('data:','');\r\n                if (type == obj.options.type) {\r\n                    var data = {\r\n                        file: src,\r\n                        name: '',\r\n                        extension: extension[1],\r\n                        content: src,\r\n                    }\r\n                    obj.add(data);\r\n                } else {\r\n                    alert(obj.options.text.extensionNotAllowed);\r\n                }\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n                // Get remove content\r\n                jSuites.ajax({\r\n                    url: src,\r\n                    type: 'GET',\r\n                    dataType: 'blob',\r\n                    success: function(data) {\r\n                        //add(extension[0].replace('data:',''), data);\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    var getDataURL = function(canvas, type) {\r\n        var compression = 0.92;\r\n        var lastContentLength = null;\r\n        var content = canvas.toDataURL(type, compression);\r\n        while (obj.options.maxJpegSizeBytes && type === 'image/jpeg' &&\r\n               content.length > obj.options.maxJpegSizeBytes && content.length !== lastContentLength) {\r\n            // Apply the compression\r\n            compression *= 0.9;\r\n            lastContentLength = content.length;\r\n            content = canvas.toDataURL(type, compression);\r\n        }\r\n        return content;\r\n    }\r\n\r\n    var mime = obj.options.type + '/' + obj.options.extension;\r\n    var input = document.createElement('input');\r\n    input.type = 'file';\r\n    input.setAttribute('accept', mime);\r\n    input.onchange = function() {\r\n        for (var i = 0; i < this.files.length; i++) {\r\n            obj.addFromFile(this.files[i]);\r\n        }\r\n    }\r\n\r\n    // Allow multiple files\r\n    if (obj.options.multiple == true) {\r\n        input.setAttribute('multiple', true);\r\n    }\r\n\r\n    var current = null;\r\n\r\n    el.addEventListener(\"click\", function(e) {\r\n        current = null;\r\n        if (! el.children.length || e.target === el) {\r\n            jSuites.click(input);\r\n        } else {\r\n            if (e.target.parentNode == el) {\r\n                current = e.target;\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener(\"dblclick\", function(e) {\r\n        jSuites.click(input);\r\n    });\r\n\r\n    el.addEventListener('dragenter', function(e) {\r\n        el.style.border = '1px dashed #000';\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragstop', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('keydown', function(e) {\r\n        if (current && e.which == 46) {\r\n            var index = Array.prototype.indexOf.call(el.children, current);\r\n            if (index >= 0) {\r\n                el.content.splice(index, 1);\r\n                current.remove();\r\n                current = null;\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();  \r\n        e.stopPropagation();\r\n\r\n        var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n        var file = (e.originalEvent || e).dataTransfer.files;\r\n\r\n        if (file.length) {\r\n            for (var i = 0; i < e.dataTransfer.files.length; i++) {\r\n                obj.addFromFile(e.dataTransfer.files[i]);\r\n            }\r\n        } else if (html) {\r\n            if (obj.options.multiple == false) {\r\n                el.innerText = '';\r\n            }\r\n\r\n            // Create temp element\r\n            var div = document.createElement('div');\r\n            div.innerHTML = html;\r\n\r\n            // Extract images\r\n            var img = div.querySelectorAll('img');\r\n\r\n            if (img.length) {\r\n                for (var i = 0; i < img.length; i++) {\r\n                    obj.addFromUrl(img[i].src);\r\n                }\r\n            }\r\n        }\r\n\r\n        el.style.border = '1px solid #eee';\r\n\r\n        return false;\r\n    });\r\n\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            return el.content && el.content.length ? el.content : null;\r\n        } else {\r\n            // Reset\r\n            el.innerText = '';\r\n            el.content = [];\r\n\r\n            if (val) {\r\n                if (Array.isArray(val)) {\r\n                    for (var i = 0; i < val.length; i++) {\r\n                        if (typeof(val[i]) == 'string') {\r\n                            obj.add({ file: val[i] });\r\n                        } else {\r\n                            obj.add(val[i]);\r\n                        }\r\n                    }\r\n                } else if (typeof(val) == 'string') {\r\n                    obj.add({ file: val });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    el.upload = el.image = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.image.create = function(data) {\r\n    var img = document.createElement('img');\r\n    img.setAttribute('src', data.file);\r\n    img.className = 'jfile';\r\n    img.setAttribute('tabindex', -1);\r\n    img.content = data;\r\n\r\n    return img;\r\n}\r\n\r\n\r\njSuites.lazyLoading = (function(el, options) {\r\n    var obj = {}\r\n\r\n    // Mandatory options\r\n    if (! options.loadUp || typeof(options.loadUp) != 'function') {\r\n        options.loadUp = function() {\r\n            return false;\r\n        }\r\n    }\r\n    if (! options.loadDown || typeof(options.loadDown) != 'function') {\r\n        options.loadDown = function() {\r\n            return false;\r\n        }\r\n    }\r\n    // Timer ms\r\n    if (! options.timer) {\r\n        options.timer = 100;\r\n    }\r\n\r\n    // Timer\r\n    var timeControlLoading = null;\r\n\r\n    // Controls\r\n    var scrollControls = function(e) {\r\n        if (timeControlLoading == null) {\r\n            var event = false;\r\n            var scrollTop = el.scrollTop;\r\n            if (el.scrollTop + (el.clientHeight * 2) >= el.scrollHeight) {\r\n                if (options.loadDown()) {\r\n                    if (scrollTop == el.scrollTop) {\r\n                        el.scrollTop = el.scrollTop - (el.clientHeight);\r\n                    }\r\n                    event = true;\r\n                }\r\n            } else if (el.scrollTop <= el.clientHeight) {\r\n                if (options.loadUp()) {\r\n                    if (scrollTop == el.scrollTop) {\r\n                        el.scrollTop = el.scrollTop + (el.clientHeight);\r\n                    }\r\n                    event = true;\r\n                }\r\n            }\r\n\r\n            timeControlLoading = setTimeout(function() {\r\n                timeControlLoading = null;\r\n            }, options.timer);\r\n\r\n            if (event) {\r\n                if (typeof(options.onupdate) == 'function') {\r\n                    options.onupdate();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Onscroll\r\n    el.onscroll = function(e) {\r\n        scrollControls(e);\r\n    }\r\n\r\n    el.onwheel = function(e) {\r\n        scrollControls(e);\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.loading = (function() {\r\n    var obj = {};\r\n\r\n    var loading = null;\r\n\r\n    obj.show = function() {\r\n        if (! loading) {\r\n            loading = document.createElement('div');\r\n            loading.className = 'jloading';\r\n        }\r\n        document.body.appendChild(loading);\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (loading && loading.parentNode) {\r\n            document.body.removeChild(loading);\r\n        }\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.mask = (function() {\r\n    // Currency \r\n    var tokens = {\r\n        // Currency tokens\r\n        currency: [ '#(.{1})##0?(.{1}0+)?( ?;(.*)?)?', '#' ],\r\n        // Percentage\r\n        percentage: [ '0{1}(.{1}0+)?%' ],\r\n        // Number\r\n        numeric: [ '0{1}(.{1}0+)?' ],\r\n        // Data tokens\r\n        datetime: [ 'YYYY', 'YYY', 'YY', 'MMMMM', 'MMMM', 'MMM', 'MM', 'DDDDD', 'DDDD', 'DDD', 'DD', 'DY', 'DAY', 'WD', 'D', 'Q', 'HH24', 'HH12', 'HH', '\\\\[H\\\\]', 'H', 'AM/PM', 'PM', 'AM', 'MI', 'SS', 'MS', 'MONTH', 'MON', 'Y', 'M' ],\r\n        // Other\r\n        general: [ 'A', '0', '[0-9a-zA-Z\\$]+', '.']\r\n    }\r\n\r\n    var getDate = function() {\r\n        if (this.mask.toLowerCase().indexOf('[h]') !== -1) {\r\n            var m = 0;\r\n            if (this.date[4]) {\r\n                m = parseFloat(this.date[4] / 60);\r\n            }\r\n            var v = parseInt(this.date[3]) + m;\r\n            v /= 24;\r\n        } else if (! (this.date[0] && this.date[1] && this.date[2]) && (this.date[3] || this.date[4])) {\r\n            v = jSuites.two(this.date[3]) + ':' + jSuites.two(this.date[4]) + ':' + jSuites.two(this.date[5]) \r\n        } else {\r\n            if (this.date[0] && this.date[1] && ! this.date[2]) {\r\n                this.date[2] = 1;\r\n            }\r\n            v = jSuites.two(this.date[0]) + '-' + jSuites.two(this.date[1]) + '-' + jSuites.two(this.date[2]);\r\n\r\n            if (this.date[3] || this.date[4] || this.date[5]) {\r\n                v += ' ' + jSuites.two(this.date[3]) + ':' + jSuites.two(this.date[4]) + ':' + jSuites.two(this.date[5]);\r\n            }\r\n        }\r\n\r\n        return v;\r\n    }\r\n\r\n    var isBlank = function(v) {\r\n        return v === null || v === '' || v === undefined ? true : false;\r\n    }\r\n\r\n    var isFormula = function(value) {\r\n        return (''+value).chartAt(0) == '=';\r\n    }\r\n\r\n    var isNumeric = function(t) {\r\n        return t === 'currency' || t === 'percentage' || t === 'numeric' ? true : false;\r\n    }\r\n    /**\r\n     * Get the decimal defined in the mask configuration\r\n     */\r\n    var getDecimal = function(v) {\r\n        if (v && Number(v) == v) {\r\n            return '.';\r\n        } else {\r\n            if (this.options.decimal) {\r\n                return this.options.decimal;\r\n            } else {\r\n                if (this.locale) {\r\n                    var t = Intl.NumberFormat(this.locale).format(1.1);\r\n                    return this.options.decimal = t[1];\r\n                } else {\r\n                    if (! v) {\r\n                        v  = this.mask;\r\n                    }\r\n                    var e = new RegExp('0{1}(.{1})0+', 'ig');\r\n                    var t = e.exec(v);\r\n                    if (t && t[1] && t[1].length == 1) {\r\n                        // Save decimal\r\n                        this.options.decimal = t[1];\r\n                        // Return decimal\r\n                        return t[1];\r\n                    } else {\r\n                        // Did not find any decimal last resort the default\r\n                        var e = new RegExp('#,##', 'ig');\r\n                        if ((v && v.match(e)) || '1.1'.toLocaleString().substring(1,2) == '.') {\r\n                            this.options.decimal = '.';\r\n                        } else {\r\n                            this.options.decimal = ',';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.options.decimal) {\r\n            return this.options.decimal;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    var ParseValue = function(v, decimal) {\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n\r\n        // Get decimal\r\n        if (! decimal) {\r\n            decimal = getDecimal.call(this);\r\n        }\r\n\r\n        // New value\r\n        v = (''+v).split(decimal);\r\n        v[0] = v[0].match(/[\\-0-9]+/g, '');\r\n        if (v[0]) {\r\n            v[0] = v[0].join('');\r\n        }\r\n        if (v[0] || v[1]) {\r\n            if (v[1] !== undefined) {\r\n                v[1] = v[1].match(/[0-9]+/g, '');\r\n                if (v[1]) {\r\n                    v[1] = v[1].join('');\r\n                } else {\r\n                    v[1] = '';\r\n                }\r\n            }\r\n        } else {\r\n            return '';\r\n        }\r\n\r\n        return v;\r\n    }\r\n\r\n    var FormatValue = function(v) {\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n        // Get decimal\r\n        var d = getDecimal.call(this);\r\n        // Convert value\r\n        var o = Object.create(this.options || {});\r\n        if (! o.minimumFractionDigits) {\r\n            o.minimumFractionDigits = 1;\r\n        }\r\n        // Parse value\r\n        v = ParseValue.call(this, v);\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n        // Temporary value\r\n        if (v[0]) {\r\n            var t = parseFloat(v.join('.'));\r\n            if (o.style == 'percent') {\r\n                t /= 100;\r\n            }\r\n        } else {\r\n            var t = null;\r\n        }\r\n        var n = new Intl.NumberFormat(this.locale, o).format(t);\r\n        n = n.split(d);\r\n        var s = n[1].replace(/[0-9]*/g, '');\r\n        if (s) {\r\n            n[2] = s;\r\n        }\r\n        if (v[1] !== undefined) {\r\n            n[1] = d + v[1];\r\n        } else {\r\n            n[1] = '';\r\n        }\r\n\r\n        return n.join('');\r\n    }\r\n\r\n    var Format = function(e) {\r\n        var v = Value.call(e);\r\n        if (! v) {\r\n            return;\r\n        }\r\n\r\n        // Get decimal\r\n        var d = getDecimal.call(this);\r\n        var n = FormatValue.call(this, v);\r\n        var t = (n.length) - v.length;\r\n        var index = Caret.call(e) + t;\r\n        // Set value and update caret\r\n        Value.call(e, n, index, true);\r\n    }\r\n\r\n    var Extract = function(v) {\r\n        // Keep the raw value\r\n        var current = ParseValue.call(this, v);\r\n        if (current) {\r\n            return parseFloat(current.join('.'));\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Caret getter and setter methods\r\n     */\r\n    var Caret = function(index, adjustNumeric) {\r\n        if (index === undefined) {\r\n            if (this.tagName == 'DIV') {\r\n                var pos = 0;\r\n                var s = window.getSelection();\r\n                if (s) {\r\n                    if (s.rangeCount !== 0) {\r\n                        var r = s.getRangeAt(0);\r\n                        var p = r.cloneRange();\r\n                        p.selectNodeContents(this);\r\n                        p.setEnd(r.endContainer, r.endOffset);\r\n                        pos = p.toString().length;\r\n                    }\r\n                }\r\n                return pos;\r\n            } else {\r\n                return this.selectionStart;\r\n            }\r\n        } else {\r\n            // Get the current value\r\n            var n = Value.call(this);\r\n\r\n            // Review the position\r\n            if (adjustNumeric) {\r\n                var p = null;\r\n                for (var i = 0; i < n.length; i++) {\r\n                    if (n[i].match(/[\\-0-9]/g) || n[i] == '.' || n[i] == ',') {  \r\n                        p = i;\r\n                    }\r\n                }\r\n\r\n                // If the string has no numbers\r\n                if (p === null) {\r\n                    p = n.indexOf(' ');\r\n                }\r\n\r\n                if (index >= p) {\r\n                    index = p + 1;\r\n                }\r\n            }\r\n\r\n            // Do not update caret\r\n            if (index > n.length) {\r\n                index = n.length;\r\n            }\r\n\r\n            if (index) {\r\n                // Set caret\r\n                if (this.tagName == 'DIV') {\r\n                    var s = window.getSelection();\r\n                    var r = document.createRange();\r\n                    r.setStart(this.childNodes[0], index);\r\n                    s.removeAllRanges();\r\n                    s.addRange(r);\r\n                } else {\r\n                    this.selectionStart = index;\r\n                    this.selectionEnd = index;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Value getter and setter method\r\n     */\r\n    var Value = function(v, updateCaret, adjustNumeric) {\r\n        if (this.tagName == 'DIV') {\r\n            if (v === undefined) {\r\n                return this.innerText;\r\n            } else {\r\n                if (this.innerText !== v) {\r\n                    this.innerText = v;\r\n\r\n                    if (updateCaret) {\r\n                        Caret.call(this, updateCaret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            if (v === undefined) {\r\n                return this.value;\r\n            } else {\r\n                if (this.value !== v) {\r\n                    this.value = v;\r\n                    if (updateCaret) {\r\n                        Caret.call(this, updateCaret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Labels\r\n    var weekDaysFull = jSuites.calendar.weekdays;\r\n    var weekDays = jSuites.calendar.weekdaysShort;\r\n    var monthsFull = jSuites.calendar.months;\r\n    var months = jSuites.calendar.monthsShort;\r\n\r\n    var parser = {\r\n        'YEAR': function(v, s) {\r\n            var y = ''+new Date().getFullYear();\r\n\r\n            if (typeof(this.values[this.index]) === 'undefined') {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (parseInt(v) >= 0 && parseInt(v) <= 10) {\r\n                if (this.values[this.index].length < s) {\r\n                    this.values[this.index] += v;\r\n                }\r\n            }\r\n            if (this.values[this.index].length == s) {\r\n                if (s == 2) {\r\n                    var y = y.substr(0,2) + this.values[this.index];\r\n                } else if (s == 3) {\r\n                    var y = y.substr(0,1) + this.values[this.index];\r\n                } else if (s == 4) {\r\n                    var y = this.values[this.index];\r\n                }\r\n                this.date[0] = y;\r\n                this.index++;\r\n            }\r\n        },\r\n        'YYYY': function(v) {\r\n            parser.YEAR.call(this, v, 4);\r\n        },\r\n        'YYY': function(v) {\r\n            parser.YEAR.call(this, v, 3);\r\n        },\r\n        'YY': function(v) {\r\n            parser.YEAR.call(this, v, 2);\r\n        },\r\n        'FIND': function(v, a) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var pos = 0;\r\n            var count = 0;\r\n            var value = (this.values[this.index] + v).toLowerCase();\r\n            for (var i = 0; i < a.length; i++) {\r\n                if (a[i].toLowerCase().indexOf(value) == 0) {\r\n                    pos = i;\r\n                    count++;\r\n                }\r\n            }\r\n            if (count > 1) {\r\n                this.values[this.index] += v;\r\n            } else if (count == 1) {\r\n                this.values[this.index] = a[pos];\r\n                this.index++;\r\n\r\n                return pos;\r\n            }\r\n        },\r\n        'MMM': function(v) {\r\n            var ret = parser.FIND.call(this, v, months);\r\n            if (ret !== undefined) {\r\n                this.date[1] = ret + 1;\r\n            }\r\n        },\r\n        'MMMM': function(v) {\r\n            var ret = parser.FIND.call(this, v, monthsFull);\r\n            if (ret !== undefined) {\r\n                this.date[1] = ret + 1;\r\n            }\r\n        },\r\n        'MMMMM': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var pos = 0;\r\n            var count = 0;\r\n            var value = (this.values[this.index] + v).toLowerCase();\r\n            for (var i = 0; i < monthsFull.length; i++) {\r\n                if (monthsFull[i][0].toLowerCase().indexOf(value) == 0) {\r\n                    this.values[this.index] = monthsFull[i][0];\r\n                    this.date[1] = i + 1;\r\n                    this.index++;\r\n                    break;\r\n                }\r\n            }\r\n        },\r\n        'MM': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 1 && parseInt(v) < 10) {\r\n                    this.date[1] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 2) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                    this.date[1] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] == 0 && parseInt(v) > 0 && parseInt(v) < 10) {\r\n                    this.date[1] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'M': function(v) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (isBlank(this.values[this.index])) {\r\n                    this.values[this.index] = v;\r\n                    if (v > 1) {\r\n                        this.date[1] = this.values[this.index];\r\n                        this.index++;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                        this.date[1] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 0 && parseInt(v) > 0) {\r\n                        this.date[1] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else {\r\n                        var test = true;\r\n                    }\r\n                }\r\n            } else {\r\n                var test = true;\r\n            }\r\n\r\n            // Re-test\r\n            if (test == true) {\r\n                var t = parseInt(this.values[this.index]);\r\n                if (t > 0 && t < 12) {\r\n                    this.date[2] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'D': function(v) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (isBlank(this.values[this.index])) {\r\n                    this.values[this.index] = v;\r\n                    if (parseInt(v) > 3) {\r\n                        this.date[2] = this.values[this.index];\r\n                        this.index++;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 3 && parseInt(v) < 2) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 1 || this.values[this.index] == 2) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 0 && parseInt(v) > 0) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else {\r\n                        var test = true;\r\n                    }\r\n                }\r\n            } else {\r\n                var test = true;\r\n            }\r\n\r\n            // Re-test\r\n            if (test == true) {\r\n                var t = parseInt(this.values[this.index]);\r\n                if (t > 0 && t < 32) {\r\n                    this.date[2] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'DD': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 3 && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 3 && parseInt(v) < 2) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if ((this.values[this.index] == 1 || this.values[this.index] == 2) && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] == 0 && parseInt(v) > 0 && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'DDD': function(v) {\r\n            parser.FIND.call(this, v, weekDays);\r\n        },\r\n        'DDDD': function(v) {\r\n            parser.FIND.call(this, v, weekDaysFull);\r\n        },\r\n        'HH12': function(v, two) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 1 && parseInt(v) < 10) {\r\n                    if (two) {\r\n                        v = 0 + v;\r\n                    }\r\n                    this.date[3] = this.values[this.index] = v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                    this.date[3] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] < 1 && parseInt(v) < 10) {\r\n                    this.date[3] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'HH24': function(v, two) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (this.values[this.index] == null || this.values[this.index] == '') {\r\n                    if (parseInt(v) > 2 && parseInt(v) < 10) {\r\n                        if (two) {\r\n                            v = 0 + v;\r\n                        }\r\n                        this.date[3] = this.values[this.index] = v;\r\n                        this.index++;\r\n                    } else if (parseInt(v) < 10) {\r\n                        this.values[this.index] = v;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 2 && parseInt(v) < 4) {\r\n                        this.date[3] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] < 2 && parseInt(v) < 10) {\r\n                        this.date[3] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        'HH': function(v) {\r\n            parser['HH24'].call(this, v, 1);\r\n        },\r\n        'H': function(v) {\r\n            parser['HH24'].call(this, v, 0);\r\n        },\r\n        '\\\\[H\\\\]': function(v) {\r\n            if (this.values[this.index] == undefined) {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (v.match(/[0-9]/g)) {\r\n                this.date[3] = this.values[this.index] += v;\r\n            } else {\r\n                if (this.values[this.index].match(/[0-9]/g)) {\r\n                    this.date[3] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'N60': function(v, i) {\r\n            if (this.values[this.index] == null || this.values[this.index] == '') {\r\n                if (parseInt(v) > 5 && parseInt(v) < 10) {\r\n                    this.date[i] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (parseInt(v) < 10) {\r\n                    this.date[i] = this.values[this.index] += v;\r\n                    this.index++;\r\n                 }\r\n            }\r\n        },\r\n        'MI': function(v) {\r\n            parser.N60.call(this, v, 4);\r\n        },\r\n        'SS': function(v) {\r\n            parser.N60.call(this, v, 5);\r\n        },\r\n        'AM/PM': function(v) {\r\n            this.values[this.index] = '';\r\n            if (v) {\r\n                if (this.date[3] > 12) {\r\n                    this.values[this.index] = 'PM';\r\n                } else {\r\n                    this.values[this.index] = 'AM';\r\n                }\r\n            }\r\n            this.index++;\r\n        },\r\n        'WD': function(v) {\r\n            if (typeof(this.values[this.index]) === 'undefined') {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (parseInt(v) >= 0 && parseInt(v) < 7) {\r\n                this.values[this.index] = v;\r\n            }\r\n            if (this.value[this.index].length == 1) {\r\n                this.index++;\r\n            }\r\n        },\r\n        '0{1}(.{1}0+)?': function(v) {\r\n            // Get decimal\r\n            var decimal = getDecimal.call(this);\r\n            // Negative number\r\n            var neg = false;\r\n            // Create if is blank\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            } else {\r\n                if (this.values[this.index] == '-') {\r\n                    neg = true;\r\n                }\r\n            }\r\n            var current = ParseValue.call(this, this.values[this.index], decimal);\r\n            if (current) {\r\n                this.values[this.index] = current.join(decimal);\r\n            }\r\n            // New entry\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (this.values[this.index] != '0' || v == decimal) {\r\n                    this.values[this.index] += v;\r\n                }\r\n            } else if (decimal && v == decimal) {\r\n                if (this.values[this.index].indexOf(decimal) == -1) {\r\n                    if (! this.values[this.index]) {\r\n                        this.values[this.index] = '0';\r\n                    }\r\n                    this.values[this.index] += v;\r\n                }\r\n            } else if (v == '-') {\r\n                // Negative signed\r\n                neg = true;\r\n            }\r\n\r\n            if (neg === true && this.values[this.index][0] !== '-') {\r\n                this.values[this.index] = '-' + this.values[this.index];\r\n            }\r\n        },\r\n        '0{1}(.{1}0+)?%': function(v) {\r\n            parser['0{1}(.{1}0+)?'].call(this, v);\r\n\r\n            if (this.values[this.index].match(/[\\-0-9]/g)) {\r\n                if (this.values[this.index] && this.values[this.index].indexOf('%') == -1) {\r\n                    this.values[this.index] += '%';\r\n                }\r\n            } else {\r\n                this.values[this.index] = '';\r\n            }\r\n        },\r\n        '#(.{1})##0?(.{1}0+)?( ?;(.*)?)?': function(v) {\r\n            // Parse number\r\n            parser['0{1}(.{1}0+)?'].call(this, v);\r\n            // Get decimal\r\n            var decimal = getDecimal.call(this);\r\n            // Get separator\r\n            var separator = this.tokens[this.index].substr(1,1);\r\n            // Negative\r\n            var negative = this.values[this.index][0] === '-' ? true : false;\r\n            // Current value\r\n            var current = ParseValue.call(this, this.values[this.index], decimal);\r\n\r\n            // Get main and decimal parts\r\n            if (current !== '') {\r\n                // Format number\r\n                var n = current[0].match(/[0-9]/g);\r\n                if (n) {\r\n                    // Format\r\n                    n = n.join('');\r\n                    var t = [];\r\n                    var s = 0;\r\n                    for (var j = n.length - 1; j >= 0 ; j--) {\r\n                        t.push(n[j]);\r\n                        s++;\r\n                        if (! (s % 3)) {\r\n                            t.push(separator);\r\n                        }\r\n                    }\r\n                    t = t.reverse();\r\n                    current[0] = t.join('');\r\n                    if (current[0].substr(0,1) == separator) {\r\n                        current[0] = current[0].substr(1);\r\n                    }\r\n                } else {\r\n                    current[0] = '';\r\n                }\r\n\r\n                // Value\r\n                this.values[this.index] = current.join(decimal);\r\n\r\n                // Negative\r\n                if (negative) {\r\n                    this.values[this.index] = '-' + this.values[this.index];\r\n                }\r\n            }\r\n        },\r\n        '0': function(v) {\r\n            if (v.match(/[0-9]/g)) {\r\n                this.values[this.index] = v;\r\n                this.index++;\r\n            }\r\n        },\r\n        '[0-9a-zA-Z$]+': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var t = this.tokens[this.index];\r\n            var s = this.values[this.index];\r\n            var i = s.length;\r\n\r\n            if (t[i] == v) {\r\n                this.values[this.index] += v;\r\n\r\n                if (this.values[this.index] == t) {\r\n                    this.index++;\r\n                }\r\n            } else {\r\n                this.values[this.index] = t;\r\n                this.index++;\r\n\r\n                if (v.match(/[\\-0-9]/g)) {\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'A': function(v) {\r\n            if (v.match(/[a-zA-Z]/gi)) {\r\n                this.values[this.index] = v;\r\n                this.index++;\r\n            }\r\n        },\r\n        '.': function(v) {\r\n            parser['[0-9a-zA-Z$]+'].call(this, v);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the tokens in the mask string\r\n     */\r\n    var getTokens = function(str) {\r\n        if (this.type == 'general') {\r\n            var t = [].concat(tokens.general);\r\n        } else {\r\n            var t = [].concat(tokens.currency, tokens.datetime, tokens.percentage, tokens.numeric, tokens.general);\r\n        }\r\n        // Expression to extract all tokens from the string\r\n        var e = new RegExp(t.join('|'), 'gi');\r\n        // Extract\r\n        return str.match(e);\r\n    }\r\n\r\n    /**\r\n     * Get the method of one given token\r\n     */\r\n    var getMethod = function(str) {\r\n        if (! this.type) {\r\n            var types = Object.keys(tokens);\r\n        } else if (this.type == 'general') {\r\n            var types = [ 'general' ];\r\n        } else if (this.type == 'datetime') {\r\n            var types = [ 'numeric', 'datetime', 'general' ];\r\n        } else {\r\n            var types = [ 'currency', 'percentage', 'numeric', 'general' ];\r\n        }\r\n\r\n        // Found\r\n        for (var i = 0; i < types.length; i++) {\r\n            var type = types[i];\r\n            for (var j = 0; j < tokens[type].length; j++) {\r\n                var e = new RegExp(tokens[type][j], 'gi');\r\n                var r = str.match(e);\r\n                if (r) {\r\n                    return { type: type, method: tokens[type][j] }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Identify each method for each token\r\n     */\r\n    var getMethods = function(t) {\r\n        var result = [];\r\n        for (var i = 0; i < t.length; i++) {\r\n            var m = getMethod.call(this, t[i]);\r\n            if (m) {\r\n                result.push(m.method);\r\n            } else {\r\n                result.push(null);\r\n            }\r\n        }\r\n\r\n        // Compatibility with excel\r\n        for (var i = 0; i < result.length; i++) {\r\n            if (result[i] == 'MM') {\r\n                // Not a month, correct to minutes\r\n                if (result[i-1] && result[i-1].indexOf('H') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i-2] && result[i-2].indexOf('H') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i+1] && result[i+1].indexOf('S') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i+2] && result[i+2].indexOf('S') >= 0) {\r\n                    result[i] = 'MI';\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Get the type for one given token\r\n     */\r\n    var getType = function(str) {\r\n        var m = getMethod.call(this, str);\r\n        if (m) {\r\n            var type = m.type;\r\n        }\r\n\r\n        if (type) {\r\n            var numeric = 0;\r\n            // Make sure the correct type\r\n            var t = getTokens.call(this, str);\r\n            for (var i = 0; i < t.length; i++) {\r\n                m = getMethod.call(this, t[i]);\r\n                if (m && isNumeric(m.type)) {\r\n                    numeric++;\r\n                }\r\n            }\r\n            if (numeric > 1) {\r\n                type = 'general';\r\n            }\r\n        }\r\n\r\n        return type;\r\n    }\r\n\r\n    /**\r\n     * Parse character per character using the detected tokens in the mask\r\n     */\r\n    var parse = function() {\r\n        // Parser method for this position\r\n        if (typeof(parser[this.methods[this.index]]) == 'function') {\r\n            parser[this.methods[this.index]].call(this, this.value[this.position]);\r\n            this.position++;\r\n        } else {\r\n            this.values[this.index] = this.tokens[this.index];\r\n            this.index++;\r\n        }\r\n    }\r\n\r\n    var isFormula = function(value) {\r\n        var v = (''+value)[0];\r\n        return v == '=' ? true : false;\r\n    }\r\n\r\n    var toPlainString = function(num) {\r\n        return (''+ +num).replace(/(-?)(\\d*)\\.?(\\d*)e([+-]\\d+)/,\r\n          function(a,b,c,d,e) {\r\n            return e < 0\r\n              ? b + '0.' + Array(1-e-c.length).join(0) + c + d\r\n              : b + c + d + Array(e-d.length+1).join(0);\r\n          });\r\n    }\r\n\r\n    /**\r\n     * Mask function\r\n     * @param {mixed|string} JS input or a string to be parsed\r\n     * @param {object|string} When the first param is a string, the second is the mask or object with the mask options\r\n     */\r\n    var obj = function(e, config, returnObject) {\r\n        // Options\r\n        var r = null;\r\n        var t = null;\r\n        var o = {\r\n            // Element\r\n            input: null,\r\n            // Current value\r\n            value: null,\r\n            // Mask options\r\n            options: {},\r\n            // New values for each token found\r\n            values: [],\r\n            // Token position\r\n            index: 0,\r\n            // Character position\r\n            position: 0,\r\n            // Date raw values\r\n            date: [0,0,0,0,0,0],\r\n            // Raw number for the numeric values\r\n            number: 0,\r\n        }\r\n\r\n        // This is a JavaScript Event\r\n        if (typeof(e) == 'object') {\r\n            // Element\r\n            o.input = e.target;\r\n            // Current value\r\n            o.value = Value.call(e.target);\r\n            // Current caret position\r\n            o.caret = Caret.call(e.target);\r\n            // Mask\r\n            if (t = e.target.getAttribute('data-mask')) {\r\n                o.mask = t;\r\n            }\r\n            // Type\r\n            if (t = e.target.getAttribute('data-type')) {\r\n                o.type = t;\r\n            }\r\n            // Options\r\n            if (e.target.mask) {\r\n                if (e.target.mask.options) {\r\n                    o.options = e.target.mask.options;\r\n                }\r\n                if (e.target.mask.locale) {\r\n                    o.locale = e.target.mask.locale;\r\n                }\r\n            } else {\r\n                // Locale\r\n                if (t = e.target.getAttribute('data-locale')) {\r\n                    o.locale = t;\r\n                    if (o.mask) {\r\n                        o.options.style = o.mask;\r\n                    }\r\n                }\r\n            }\r\n            // Extra configuration\r\n            if (e.target.attributes && e.target.attributes.length) {\r\n                for (var i = 0; i < e.target.attributes.length; i++) {\r\n                    var k = e.target.attributes[i].name;\r\n                    var v = e.target.attributes[i].value;\r\n                    if (k.substr(0,4) == 'data') {\r\n                        o.options[k.substr(5)] = v;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            // Options\r\n            if (typeof(config) == 'string') {\r\n                // Mask\r\n                o.mask = config;\r\n            } else {\r\n                // Mask\r\n                var k = Object.keys(config);\r\n                for (var i = 0; i < k.length; i++) {\r\n                    o[k[i]] = config[k[i]];\r\n                }\r\n            }\r\n\r\n            if (typeof(e) === 'number') {\r\n                // Get decimal\r\n                getDecimal.call(o, o.mask);\r\n                // Replace to the correct decimal\r\n                e = (''+e).replace('.', o.options.decimal);\r\n            }\r\n\r\n            // Current\r\n            o.value = e;\r\n\r\n            if (o.input) {\r\n                // Value\r\n                Value.call(o.input, e);\r\n                // Focus\r\n                jSuites.focus(o.input);\r\n                // Caret\r\n                o.caret = Caret.call(o.input);\r\n            }\r\n        }\r\n\r\n        // Mask detected start the process\r\n        if (! isFormula(o.value) && (o.mask || o.locale)) {\r\n            // Compatibility ixes\r\n            if (o.mask) {\r\n                // Legacy\r\n                o.mask = o.mask.replace('[-]', '');\r\n                // Excel mask TODO: Improve\r\n                if (o.mask.indexOf('##')) {\r\n                    var d = o.mask.split(';');\r\n                    if (d[0]) {\r\n                        d[0] = d[0].replace('*', '');\r\n                        d[0] = d[0].replace(/_/g, '');\r\n                        d[0] = d[0].replace(/-/g, '');\r\n                        d[0] = d[0].replace('(','');\r\n                        d[0] = d[0].replace(')','');\r\n                        d[0] = d[0].replace('##0.###','##0.000');\r\n                        d[0] = d[0].replace('##0.##','##0.00');\r\n                        d[0] = d[0].replace('##0.#','##0.0');\r\n                    }\r\n                    o.mask = d[0];\r\n                }\r\n                // Get type\r\n                if (! o.type) {\r\n                    o.type = getType.call(o, o.mask);\r\n                }\r\n                // Get tokens\r\n                o.tokens = getTokens.call(o, o.mask);\r\n            }\r\n            // On new input\r\n            if (typeof(e) !== 'object' || ! e.inputType || e.inputType == 'insertText' || e.inputType == 'insertFromPaste') {\r\n                // Start tranformation\r\n                if (o.locale) {\r\n                    if (o.input) {\r\n                        Format.call(o, o.input);\r\n                    } else {\r\n                        var newValue = FormatValue.call(o, o.value);\r\n                    }\r\n                } else {\r\n                    // Get tokens\r\n                    o.methods = getMethods.call(o, o.tokens);\r\n                    // Go through all tokes\r\n                    while (o.position < o.value.length && typeof(o.tokens[o.index]) !== 'undefined') {\r\n                        // Get the approate parser\r\n                        parse.call(o);\r\n                    }\r\n\r\n                    if (isNumeric(o.type)) {\r\n                        // Complement things in the end of the mask\r\n                        while (typeof(o.tokens[o.index]) !== 'undefined') {\r\n                            var t = getMethod.call(o, o.tokens[o.index]);\r\n                            if (t && t.type == 'general') {\r\n                                o.values[o.index] = o.tokens[o.index];\r\n                            }\r\n                            o.index++;\r\n                        }\r\n\r\n                        var adjustNumeric = true;\r\n                    } else {\r\n                        var adjustNumeric = false;\r\n                    }\r\n\r\n                    // New value\r\n                    var newValue = o.values.join('');\r\n\r\n                    // Reset value\r\n                    if (o.input) {\r\n                        t = newValue.length - o.value.length;\r\n                        if (t > 0) {\r\n                            var caret = o.caret + t;\r\n                        } else {\r\n                            var caret = o.caret;\r\n                        }\r\n                        Value.call(o.input, newValue, caret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Update raw data\r\n            if (o.input) {\r\n                var label = null;\r\n                if (isNumeric(o.type)) {\r\n                    // Extract the number\r\n                    o.number = Extract.call(o, Value.call(o.input));\r\n                    // Keep the raw data as a property of the tag\r\n                    if (o.type == 'percentage') {\r\n                        label = o.number / 100;\r\n                    } else {\r\n                        label = o.number;\r\n                    }\r\n                } else if (o.type == 'datetime') {\r\n                    label = getDate.call(o);\r\n\r\n                    if (o.date[0] && o.date[1] && o.date[2]) {\r\n                        o.input.setAttribute('data-completed', true);\r\n                    }\r\n                }\r\n\r\n                if (label) {\r\n                    o.input.setAttribute('data-value', label);\r\n                }\r\n            }\r\n\r\n            if (newValue !== undefined) {\r\n                if (returnObject) {\r\n                    return o;\r\n                } else {\r\n                    return newValue;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Extract the tokens from a mask\r\n    obj.prepare = function(str, o) {\r\n        if (! o) {\r\n            o = {};\r\n        }\r\n        return getTokens.call(o, str);\r\n    }\r\n\r\n    /**\r\n     * Apply the mask to a element (legacy)\r\n     */\r\n    obj.apply = function(e) {\r\n        var v = Value.call(e.target);\r\n        if (e.key.length == 1) {\r\n            v += e.key;\r\n        }\r\n        Value.call(e.target, obj(v, e.target.getAttribute('data-mask')));\r\n    }\r\n\r\n    /**\r\n     * Legacy support\r\n     */\r\n    obj.run = function(value, mask, decimal) {\r\n        return obj(value, { mask, decimal });\r\n    }\r\n\r\n    /**\r\n     * Extract number from masked string\r\n     */\r\n    obj.extract = function(v, options, returnObject) {\r\n        if (isBlank(v)) {\r\n            return v;\r\n        }\r\n        if (typeof(options) != 'object') {\r\n            return value;\r\n        } else {\r\n            if (! options.options) {\r\n                options.options = {};\r\n            }\r\n        }\r\n\r\n        // Compatibility\r\n        if (! options.mask && options.format) {\r\n            options.mask = options.format;\r\n        }\r\n\r\n        // Get decimal\r\n        getDecimal.call(options, options.mask);\r\n\r\n        var type = null;\r\n        if (options.type == 'percent' || options.options.style == 'percent') {\r\n            type = 'percentage';\r\n        } else if (options.mask) {\r\n            type = getType.call(options, options.mask);\r\n        }\r\n\r\n\r\n        if (type === 'datetime') {\r\n            if (v instanceof Date) {\r\n                var t = jSuites.calendar.getDateString(value, options.mask);\r\n            }\r\n\r\n            var o = obj(v, options, true);\r\n            var value = getDate.call(o);\r\n            if ((o.date[0] && o.date[1] && o.date[2]) && ! (o.date[3] || o.date[4] || o.date[5])) {\r\n                var t = jSuites.calendar.now(o.date);\r\n                value = jSuites.calendar.dateToNum(t);\r\n            }\r\n        } else {\r\n            var value = Extract.call(options, v);\r\n            // Percentage\r\n            if (type == 'percentage') {\r\n                value /= 100;\r\n            }\r\n            var o = options;\r\n        }\r\n\r\n        o.value = value;\r\n\r\n        if (returnObject) {\r\n            return o;\r\n        } else {\r\n            return value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Render\r\n     */\r\n    obj.render = function(value, options, fullMask) {\r\n        if (isBlank(value)) {\r\n            return value;\r\n        }\r\n\r\n        if (typeof(options) != 'object') {\r\n            return value;\r\n        } else {\r\n            if (! options.options) {\r\n                options.options = {};\r\n            }\r\n        }\r\n\r\n        // Compatibility\r\n        if (! options.mask && options.format) {\r\n            options.mask = options.format;\r\n        }\r\n\r\n        var type = null;\r\n        if (options.type == 'percent' || options.options.style == 'percent') {\r\n            type = 'percentage';\r\n        } else if (options.mask) {\r\n            type = getType.call(options, options.mask);\r\n        } else if (value instanceof Date) {\r\n            type = 'datetime';\r\n        }\r\n\r\n        // Fill with blanks\r\n        var fillWithBlanks = false;\r\n\r\n        if (type =='datetime' || options.type == 'calendar') {\r\n            var t = jSuites.calendar.getDateString(value, options.mask);\r\n            if (t) {\r\n                value = t;\r\n            }\r\n\r\n            if (options.mask && fullMask) {\r\n                fillWithBlanks = true;\r\n            }\r\n        } else {\r\n            // Percentage\r\n            if (type == 'percentage') {\r\n                value *= 100;\r\n            }\r\n            // Number of decimal places\r\n            if (typeof(value) === 'number') {\r\n                var t = null;\r\n                if (options.mask && fullMask) {\r\n                    var e = new RegExp('0{1}(.{1})0+', 'ig');\r\n                    var d = options.mask.match(e);\r\n                    if (d && d[0]) {\r\n                        d = d[0].length - 2;\r\n                        t = value.toFixed(d);\r\n                    } else {\r\n                        t = (''+value);\r\n                    }\r\n                } else if (options.locale && fullMask) {\r\n                    var d = (''+value).split('.');\r\n                    if (! d[1]) {\r\n                        d[1] = '00';\r\n                    } else {\r\n                        if (d[1].length == 1) {\r\n                            d[1] += '0';\r\n                        }\r\n                    }\r\n                    t = d.join('.');\r\n                } else {\r\n                    t = toPlainString(value);\r\n                }\r\n\r\n                if (t !== null) {\r\n                    value = t;\r\n                    // Get decimal\r\n                    getDecimal.call(options, options.mask);\r\n                    // Replace to the correct decimal\r\n                    if (options.options.decimal) {\r\n                        value = value.replace('.', options.options.decimal);\r\n                    }\r\n                }\r\n            } else {\r\n                if (options.mask && fullMask) {\r\n                    fillWithBlanks = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (fillWithBlanks) {\r\n            var s = options.mask.length - value.length;\r\n            if (s > 0) {\r\n                for (var i = 0; i < s; i++) {\r\n                    value += ' ';\r\n                }\r\n            }\r\n        }\r\n\r\n        value = obj(value, options);\r\n\r\n        return value;\r\n    }\r\n\r\n    obj.set = function(e, m) {\r\n        if (m) {\r\n            e.setAttribute('data-mask', m);\r\n            // Reset the value\r\n            var event = new Event('input', {\r\n                bubbles: true,\r\n                cancelable: true,\r\n            });\r\n            e.dispatchEvent(event);\r\n        }\r\n    }\r\n\r\n    if (typeof document !== 'undefined') {\r\n        document.addEventListener('input', function(e) {\r\n            if (e.target.getAttribute('data-mask') || e.target.mask) {\r\n                obj(e);\r\n            }\r\n        });\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.notification = (function(options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        icon: null,\r\n        name: 'Notification',\r\n        date: null,\r\n        error: null,\r\n        title: null,\r\n        message: null,\r\n        timeout: 4000,\r\n        autoHide: true,\r\n        closeable: true,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    var notification = document.createElement('div');\r\n    notification.className = 'jnotification';\r\n\r\n    if (obj.options.error) {\r\n        notification.classList.add('jnotification-error');\r\n    }\r\n\r\n    var notificationContainer = document.createElement('div');\r\n    notificationContainer.className = 'jnotification-container';\r\n    notification.appendChild(notificationContainer);\r\n\r\n    var notificationHeader = document.createElement('div');\r\n    notificationHeader.className = 'jnotification-header';\r\n    notificationContainer.appendChild(notificationHeader);\r\n\r\n    var notificationImage = document.createElement('div');\r\n    notificationImage.className = 'jnotification-image';\r\n    notificationHeader.appendChild(notificationImage);\r\n\r\n    if (obj.options.icon) {\r\n        var notificationIcon = document.createElement('img');\r\n        notificationIcon.src = obj.options.icon;\r\n        notificationImage.appendChild(notificationIcon);\r\n    }\r\n\r\n    var notificationName = document.createElement('div');\r\n    notificationName.className = 'jnotification-name';\r\n    notificationName.innerHTML = obj.options.name;\r\n    notificationHeader.appendChild(notificationName);\r\n\r\n    if (obj.options.closeable == true) {\r\n        var notificationClose = document.createElement('div');\r\n        notificationClose.className = 'jnotification-close';\r\n        notificationClose.onclick = function() {\r\n            obj.hide();\r\n        }\r\n        notificationHeader.appendChild(notificationClose);\r\n    }\r\n\r\n    var notificationDate = document.createElement('div');\r\n    notificationDate.className = 'jnotification-date';\r\n    notificationHeader.appendChild(notificationDate);\r\n\r\n    var notificationContent = document.createElement('div');\r\n    notificationContent.className = 'jnotification-content';\r\n    notificationContainer.appendChild(notificationContent);\r\n\r\n    if (obj.options.title) {\r\n        var notificationTitle = document.createElement('div');\r\n        notificationTitle.className = 'jnotification-title';\r\n        notificationTitle.innerHTML = obj.options.title;\r\n        notificationContent.appendChild(notificationTitle);\r\n    }\r\n\r\n    var notificationMessage = document.createElement('div');\r\n    notificationMessage.className = 'jnotification-message';\r\n    notificationMessage.innerHTML = obj.options.message;\r\n    notificationContent.appendChild(notificationMessage);\r\n\r\n    obj.show = function() {\r\n        document.body.appendChild(notification);\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.animation.fadeIn(notification);\r\n        } else {\r\n            jSuites.animation.slideTop(notification, 1);\r\n        }\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.animation.fadeOut(notification, function() {\r\n                if (notification.parentNode) {\r\n                    notification.parentNode.removeChild(notification);\r\n                    if (notificationTimeout) {\r\n                        clearTimeout(notificationTimeout);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            jSuites.animation.slideTop(notification, 0, function() {\r\n                if (notification.parentNode) {\r\n                    notification.parentNode.removeChild(notification);\r\n                    if (notificationTimeout) {\r\n                        clearTimeout(notificationTimeout);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    obj.show();\r\n\r\n    if (obj.options.autoHide == true) {\r\n        var notificationTimeout = setTimeout(function() {\r\n            obj.hide();\r\n        }, obj.options.timeout);\r\n    }\r\n\r\n    if (jSuites.getWindowWidth() < 800) {\r\n        notification.addEventListener(\"swipeup\", function(e) {\r\n            obj.hide();\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.notification.isVisible = function() {\r\n    var j = document.querySelector('.jnotification');\r\n    return j && j.parentNode ? true : false;\r\n}\r\n\r\n// More palettes https://coolors.co/ or https://gka.github.io/palettes/#/10|s|003790,005647,ffffe0|ffffe0,ff005e,93003a|1|1\r\n\r\njSuites.palette = function(o) {\r\n    // Material\r\n    var palette = {};\r\n\r\n    palette.material = [\r\n        [ \"#ffebee\", \"#fce4ec\", \"#f3e5f5\", \"#e8eaf6\", \"#e3f2fd\", \"#e0f7fa\", \"#e0f2f1\", \"#e8f5e9\", \"#f1f8e9\", \"#f9fbe7\", \"#fffde7\", \"#fff8e1\", \"#fff3e0\", \"#fbe9e7\", \"#efebe9\", \"#fafafa\", \"#eceff1\" ],\r\n        [ \"#ffcdd2\", \"#f8bbd0\", \"#e1bee7\", \"#c5cae9\", \"#bbdefb\", \"#b2ebf2\", \"#b2dfdb\", \"#c8e6c9\", \"#dcedc8\", \"#f0f4c3\", \"#fff9c4\", \"#ffecb3\", \"#ffe0b2\", \"#ffccbc\", \"#d7ccc8\", \"#f5f5f5\", \"#cfd8dc\" ],\r\n        [ \"#ef9a9a\", \"#f48fb1\", \"#ce93d8\", \"#9fa8da\", \"#90caf9\", \"#80deea\", \"#80cbc4\", \"#a5d6a7\", \"#c5e1a5\", \"#e6ee9c\", \"#fff59d\", \"#ffe082\", \"#ffcc80\", \"#ffab91\", \"#bcaaa4\", \"#eeeeee\", \"#b0bec5\" ],\r\n        [ \"#e57373\", \"#f06292\", \"#ba68c8\", \"#7986cb\", \"#64b5f6\", \"#4dd0e1\", \"#4db6ac\", \"#81c784\", \"#aed581\", \"#dce775\", \"#fff176\", \"#ffd54f\", \"#ffb74d\", \"#ff8a65\", \"#a1887f\", \"#e0e0e0\", \"#90a4ae\" ],\r\n        [ \"#ef5350\", \"#ec407a\", \"#ab47bc\", \"#5c6bc0\", \"#42a5f5\", \"#26c6da\", \"#26a69a\", \"#66bb6a\", \"#9ccc65\", \"#d4e157\", \"#ffee58\", \"#ffca28\", \"#ffa726\", \"#ff7043\", \"#8d6e63\", \"#bdbdbd\", \"#78909c\" ],\r\n        [ \"#f44336\", \"#e91e63\", \"#9c27b0\", \"#3f51b5\", \"#2196f3\", \"#00bcd4\", \"#009688\", \"#4caf50\", \"#8bc34a\", \"#cddc39\", \"#ffeb3b\", \"#ffc107\", \"#ff9800\", \"#ff5722\", \"#795548\", \"#9e9e9e\", \"#607d8b\" ],\r\n        [ \"#e53935\", \"#d81b60\", \"#8e24aa\", \"#3949ab\", \"#1e88e5\", \"#00acc1\", \"#00897b\", \"#43a047\", \"#7cb342\", \"#c0ca33\", \"#fdd835\", \"#ffb300\", \"#fb8c00\", \"#f4511e\", \"#6d4c41\", \"#757575\", \"#546e7a\" ],\r\n        [ \"#d32f2f\", \"#c2185b\", \"#7b1fa2\", \"#303f9f\", \"#1976d2\", \"#0097a7\", \"#00796b\", \"#388e3c\", \"#689f38\", \"#afb42b\", \"#fbc02d\", \"#ffa000\", \"#f57c00\", \"#e64a19\", \"#5d4037\", \"#616161\", \"#455a64\" ],\r\n        [ \"#c62828\", \"#ad1457\", \"#6a1b9a\", \"#283593\", \"#1565c0\", \"#00838f\", \"#00695c\", \"#2e7d32\", \"#558b2f\", \"#9e9d24\", \"#f9a825\", \"#ff8f00\", \"#ef6c00\", \"#d84315\", \"#4e342e\", \"#424242\", \"#37474f\" ],\r\n        [ \"#b71c1c\", \"#880e4f\", \"#4a148c\", \"#1a237e\", \"#0d47a1\", \"#006064\", \"#004d40\", \"#1b5e20\", \"#33691e\", \"#827717\", \"#f57f17\", \"#ff6f00\", \"#e65100\", \"#bf360c\", \"#3e2723\", \"#212121\", \"#263238\" ],\r\n    ];\r\n\r\n    palette.fire = [\r\n        [\"0b1a6d\",\"840f38\",\"b60718\",\"de030b\",\"ff0c0c\",\"fd491c\",\"fc7521\",\"faa331\",\"fbb535\",\"ffc73a\"],\r\n        [\"071147\",\"5f0b28\",\"930513\",\"be0309\",\"ef0000\",\"fa3403\",\"fb670b\",\"f9991b\",\"faad1e\",\"ffc123\"],\r\n        [\"03071e\",\"370617\",\"6a040f\",\"9d0208\",\"d00000\",\"dc2f02\",\"e85d04\",\"f48c06\",\"faa307\",\"ffba08\"],\r\n        [\"020619\",\"320615\",\"61040d\",\"8c0207\",\"bc0000\",\"c82a02\",\"d05203\",\"db7f06\",\"e19405\",\"efab00\"],\r\n        [\"020515\",\"2d0513\",\"58040c\",\"7f0206\",\"aa0000\",\"b62602\",\"b94903\",\"c57205\",\"ca8504\",\"d89b00\"],\r\n    ]\r\n\r\n    palette.baby = [\r\n        [\"eddcd2\",\"fff1e6\",\"fde2e4\",\"fad2e1\",\"c5dedd\",\"dbe7e4\",\"f0efeb\",\"d6e2e9\",\"bcd4e6\",\"99c1de\"],\r\n        [\"e1c4b3\",\"ffd5b5\",\"fab6ba\",\"f5a8c4\",\"aacecd\",\"bfd5cf\",\"dbd9d0\",\"baceda\",\"9dc0db\",\"7eb1d5\"],\r\n        [\"daa990\",\"ffb787\",\"f88e95\",\"f282a9\",\"8fc4c3\",\"a3c8be\",\"cec9b3\",\"9dbcce\",\"82acd2\",\"649dcb\"],\r\n        [\"d69070\",\"ff9c5e\",\"f66770\",\"f05f8f\",\"74bbb9\",\"87bfae\",\"c5b993\",\"83aac3\",\"699bca\",\"4d89c2\"],\r\n        [\"c97d5d\",\"f58443\",\"eb4d57\",\"e54a7b\",\"66a9a7\",\"78ae9c\",\"b5a67e\",\"7599b1\",\"5c88b7\",\"4978aa\"],\r\n    ]\r\n\r\n    if (palette[o]) {\r\n        return palette[o];\r\n    } else {\r\n        return palette.material;\r\n    }\r\n}\r\n\r\njSuites.picker = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.picker) {\r\n        return el.picker.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'picker' };\r\n    obj.options = {};\r\n\r\n    var dropdownHeader = null;\r\n    var dropdownContent = null;\r\n\r\n    /**\r\n     * Create the content options\r\n     */\r\n    var createContent = function() {\r\n        dropdownContent.innerHTML = '';\r\n\r\n        // Create items\r\n        var keys = Object.keys(obj.options.data);\r\n\r\n        // Go though all options\r\n        for (var i = 0; i < keys.length; i++) {\r\n            // Item\r\n            var dropdownItem = document.createElement('div');\r\n            dropdownItem.classList.add('jpicker-item');\r\n            dropdownItem.k = keys[i];\r\n            dropdownItem.v = obj.options.data[keys[i]];\r\n            // Label\r\n            dropdownItem.innerHTML = obj.getLabel(keys[i]);\r\n            // Append\r\n            dropdownContent.appendChild(dropdownItem);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set or reset the options for the picker\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            value: 0,\r\n            data: null,\r\n            render: null,\r\n            onchange: null,\r\n            onselect: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onload: null,\r\n            width: null,\r\n            header: true,\r\n            right: false,\r\n            content: false,\r\n            columns: null,\r\n            height: null,\r\n        }\r\n\r\n        // Legacy purpose only\r\n        if (options && options.options) {\r\n            options.data = options.options;\r\n        }\r\n\r\n        // Loop through the initial configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Start using the options\r\n        if (obj.options.header === false) {\r\n            dropdownHeader.style.display = 'none';\r\n        } else {\r\n            dropdownHeader.style.display = '';\r\n        }\r\n\r\n        // Width\r\n        if (obj.options.width) {\r\n            dropdownHeader.style.width = parseInt(obj.options.width) + 'px';\r\n        } else {\r\n            dropdownHeader.style.width = '';\r\n        }\r\n\r\n        // Height\r\n        if (obj.options.height) {\r\n            dropdownContent.style.maxHeight = obj.options.height + 'px';\r\n            dropdownContent.style.overflow = 'scroll';\r\n        } else {\r\n            dropdownContent.style.overflow = '';\r\n        }\r\n\r\n        if (obj.options.columns > 0) {\r\n            dropdownContent.classList.add('jpicker-columns');\r\n            dropdownContent.style.width =  obj.options.width ? obj.options.width : 36 * obj.options.columns + 'px';\r\n        }\r\n\r\n        if (isNaN(obj.options.value)) {\r\n            obj.options.value = '0';\r\n        }\r\n\r\n        // Create list from data\r\n        createContent();\r\n\r\n        // Set value\r\n        obj.setValue(obj.options.value);\r\n\r\n        // Set options all returns the own instance\r\n        return obj;\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    obj.setValue = function(v) {\r\n        // Set label\r\n        obj.setLabel(v);\r\n\r\n        // Update value\r\n        obj.options.value = String(v);\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n\r\n        if (dropdownContent.children[v].getAttribute('type') !== 'generic') {\r\n            obj.close();\r\n        }\r\n    }\r\n\r\n    obj.getLabel = function(v) {\r\n        var label = obj.options.data[v] || null;\r\n        if (typeof(obj.options.render) == 'function') {\r\n            label = obj.options.render(label);\r\n        }\r\n        return label;\r\n    }\r\n\r\n    obj.setLabel = function(v) {\r\n        if (obj.options.content) {\r\n            var label = '<i class=\"material-icons\">' + obj.options.content + '</i>';\r\n        } else {\r\n            var label = obj.getLabel(v);\r\n        }\r\n\r\n        dropdownHeader.innerHTML = label;\r\n    }\r\n\r\n    obj.open = function() {\r\n        if (! el.classList.contains('jpicker-focus')) {\r\n            // Start tracking the element\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Open picker\r\n            el.classList.add('jpicker-focus');\r\n            el.focus();\r\n\r\n            var rectHeader = dropdownHeader.getBoundingClientRect();\r\n            var rectContent = dropdownContent.getBoundingClientRect();\r\n            if (window.innerHeight < rectHeader.bottom + rectContent.height) {\r\n                dropdownContent.style.marginTop = -1 * (rectContent.height + 4) + 'px';\r\n            } else {\r\n                dropdownContent.style.marginTop = rectHeader.height + 2 + 'px';\r\n            }\r\n\r\n            if (obj.options.right === true) {\r\n                dropdownContent.style.marginLeft = -1 * rectContent.width + 24 + 'px';\r\n            }\r\n\r\n            if (typeof obj.options.onopen == 'function') {\r\n                obj.options.onopen(el, obj);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (el.classList.contains('jpicker-focus')) {\r\n            el.classList.remove('jpicker-focus');\r\n\r\n            // Start tracking the element\r\n            jSuites.tracking(obj, false);\r\n\r\n            if (typeof obj.options.onclose == 'function') {\r\n                obj.options.onclose(el, obj);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create floating picker\r\n     */\r\n    var init = function() {\r\n        // Class\r\n        el.classList.add('jpicker');\r\n        el.setAttribute('tabindex', '900');\r\n        el.onmousedown = function(e) {\r\n            if (! el.classList.contains('jpicker-focus')) {\r\n                obj.open();\r\n            }\r\n        }\r\n\r\n        // Dropdown Header\r\n        dropdownHeader = document.createElement('div');\r\n        dropdownHeader.classList.add('jpicker-header');\r\n\r\n        // Dropdown content\r\n        dropdownContent = document.createElement('div');\r\n        dropdownContent.classList.add('jpicker-content');\r\n        dropdownContent.onclick = function(e) {\r\n            var item = jSuites.findElement(e.target, 'jpicker-item');\r\n            if (item) {\r\n                if (item.parentNode === dropdownContent) {\r\n                    // Update label\r\n                    obj.setValue(item.k);\r\n                    // Call method\r\n                    if (typeof(obj.options.onchange) == 'function') {\r\n                        obj.options.onchange.call(obj, el, obj, item.v, item.v, item.k);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Append content and header\r\n        el.appendChild(dropdownHeader);\r\n        el.appendChild(dropdownContent);\r\n\r\n        // Default value\r\n        el.value = options.value || 0;\r\n\r\n        // Set options\r\n        obj.setOptions(options);\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Reference\r\n        el.picker = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.rating = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.rating) {\r\n        return el.rating.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            number: 5,\r\n            value: 0,\r\n            tooltip: [ 'Very bad', 'Bad', 'Average', 'Good', 'Very good' ],\r\n            onchange: null,\r\n        };\r\n\r\n        // Loop through the initial configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Make sure the container is empty\r\n        el.innerHTML = '';\r\n\r\n        // Add elements\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            var div = document.createElement('div');\r\n            div.setAttribute('data-index', (i + 1))\r\n            div.setAttribute('title', obj.options.tooltip[i])\r\n            el.appendChild(div);\r\n        }\r\n\r\n        // Selected option\r\n        if (obj.options.value) {\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                if (i < obj.options.value) {\r\n                    el.children[i].classList.add('jrating-selected');\r\n                }\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    // Set value\r\n    obj.setValue = function(index) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < index) {\r\n                el.children[i].classList.add('jrating-selected');\r\n            } else {\r\n                el.children[i].classList.remove('jrating-over');\r\n                el.children[i].classList.remove('jrating-selected');\r\n            }\r\n        }\r\n\r\n        obj.options.value = index;\r\n\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, index);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var init = function() {\r\n        // Start plugin\r\n        obj.setOptions(options);\r\n\r\n        // Class\r\n        el.classList.add('jrating');\r\n\r\n        // Events\r\n        el.addEventListener(\"click\", function(e) {\r\n            var index = e.target.getAttribute('data-index');\r\n            if (index != undefined) {\r\n                if (index == obj.options.value) {\r\n                    obj.setValue(0);\r\n                } else {\r\n                    obj.setValue(index);\r\n                }\r\n            }\r\n        });\r\n\r\n        el.addEventListener(\"mouseover\", function(e) {\r\n            var index = e.target.getAttribute('data-index');\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                if (i < index) {\r\n                    el.children[i].classList.add('jrating-over');\r\n                } else {\r\n                    el.children[i].classList.remove('jrating-over');\r\n                }\r\n            }\r\n        });\r\n\r\n        el.addEventListener(\"mouseout\", function(e) {\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                el.children[i].classList.remove('jrating-over');\r\n            }\r\n        });\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Reference\r\n        el.rating = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\n\r\njSuites.sorting = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    var defaults = {\r\n        pointer: null,\r\n        direction: null,\r\n        ondragstart: null,\r\n        ondragend: null,\r\n        ondrop: null,\r\n    }\r\n\r\n    var dragElement = null;\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    el.classList.add('jsorting');\r\n\r\n    el.addEventListener('dragstart', function(e) {\r\n        var position = Array.prototype.indexOf.call(e.target.parentNode.children, e.target);\r\n        dragElement = {\r\n            element: e.target,\r\n            o: position,\r\n            d: position\r\n        }\r\n        e.target.style.opacity = '0.25';\r\n\r\n        if (typeof(obj.options.ondragstart) == 'function') {\r\n            obj.options.ondragstart(el, e.target, e);\r\n        }\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (getElement(e.target) && dragElement) {\r\n            if (e.target.getAttribute('draggable') == 'true' && dragElement.element != e.target) {\r\n                if (! obj.options.direction) {\r\n                    var condition = e.target.clientHeight / 2 > e.offsetY;\r\n                } else {\r\n                    var condition = e.target.clientWidth / 2 > e.offsetX;\r\n                }\r\n\r\n                if (condition) {\r\n                    e.target.parentNode.insertBefore(dragElement.element, e.target);\r\n                } else {\r\n                    e.target.parentNode.insertBefore(dragElement.element, e.target.nextSibling);\r\n                }\r\n\r\n                dragElement.d = Array.prototype.indexOf.call(e.target.parentNode.children, dragElement.element);\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('dragend', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (dragElement) {\r\n            if (typeof(obj.options.ondragend) == 'function') {\r\n                obj.options.ondragend(el, dragElement.element, e);\r\n            }\r\n\r\n            // Cancelled put element to the original position\r\n            if (dragElement.o < dragElement.d) {\r\n                e.target.parentNode.insertBefore(dragElement.element, e.target.parentNode.children[dragElement.o]);\r\n            } else {\r\n                e.target.parentNode.insertBefore(dragElement.element, e.target.parentNode.children[dragElement.o].nextSibling);\r\n            }\r\n\r\n            dragElement.element.style.opacity = '';\r\n            dragElement = null;\r\n        }\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (dragElement && (dragElement.o != dragElement.d)) {\r\n            if (typeof(obj.options.ondrop) == 'function') {\r\n                obj.options.ondrop(el, dragElement.o, dragElement.d, dragElement.element, e.target, e);\r\n            }\r\n        }\r\n\r\n        dragElement.element.style.opacity = '';\r\n        dragElement = null;\r\n    });\r\n\r\n    var getElement = function(element) {\r\n        var sorting = false;\r\n\r\n        function path (element) {\r\n            if (element.className) {\r\n                if (element.classList.contains('jsorting')) {\r\n                    sorting = true;\r\n                }\r\n            }\r\n\r\n            if (! sorting) {\r\n                path(element.parentNode);\r\n            }\r\n        }\r\n\r\n        path(element);\r\n\r\n        return sorting;\r\n    }\r\n\r\n    for (var i = 0; i < el.children.length; i++) {\r\n        if (! el.children[i].hasAttribute('draggable')) {\r\n            el.children[i].setAttribute('draggable', 'true');\r\n        }\r\n    }\r\n\r\n    el.val = function() {\r\n        var id = null;\r\n        var data = [];\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            if (id = el.children[i].getAttribute('data-id')) {\r\n                data.push(id);\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n    return el;\r\n});\r\n\r\njSuites.tabs = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        data: [],\r\n        position: null,\r\n        allowCreate: false,\r\n        allowChangePosition: false,\r\n        onclick: null,\r\n        onload: null,\r\n        onchange: null,\r\n        oncreate: null,\r\n        ondelete: null,\r\n        onbeforecreate: null,\r\n        onchangeposition: null,\r\n        animation: false,\r\n        hideHeaders: false,\r\n        padding: null,\r\n        palette: null,\r\n        maxWidth: null,\r\n    }\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jtabs');\r\n\r\n    var prev = null;\r\n    var next = null;\r\n    var border = null;\r\n\r\n    // Helpers\r\n    var setBorder = function(index) {\r\n        if (obj.options.animation) {\r\n            var rect = obj.headers.children[index].getBoundingClientRect();\r\n\r\n            if (obj.options.palette == 'modern') {\r\n                border.style.width = rect.width - 4 + 'px';\r\n                border.style.left = obj.headers.children[index].offsetLeft + 2 + 'px';\r\n            } else {\r\n                border.style.width = rect.width + 'px';\r\n                border.style.left = obj.headers.children[index].offsetLeft + 'px';\r\n            }\r\n\r\n            if (obj.options.position == 'bottom') {\r\n                border.style.top = '0px';\r\n            } else {\r\n                border.style.bottom = '0px';\r\n            }\r\n        }\r\n    }\r\n\r\n    var updateControls = function(x) {\r\n        if (typeof(obj.headers.scrollTo) == 'function') {\r\n            obj.headers.scrollTo({\r\n                left: x,\r\n                behavior: 'smooth',\r\n            });\r\n        } else {\r\n            obj.headers.scrollLeft = x;\r\n        }\r\n\r\n        if (x <= 1) {\r\n            prev.classList.add('disabled');\r\n        } else {\r\n            prev.classList.remove('disabled');\r\n        }\r\n\r\n        if (x >= obj.headers.scrollWidth - obj.headers.offsetWidth) {\r\n            next.classList.add('disabled');\r\n        } else {\r\n            next.classList.remove('disabled');\r\n        }\r\n\r\n        if (obj.headers.scrollWidth <= obj.headers.offsetWidth) {\r\n            prev.style.display = 'none';\r\n            next.style.display = 'none';\r\n        } else {\r\n            prev.style.display = '';\r\n            next.style.display = '';\r\n        }\r\n    }\r\n\r\n    obj.setBorder = setBorder;\r\n\r\n    // Set value\r\n    obj.open = function(index) {\r\n        var previous = null;\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            if (obj.headers.children[i].classList.contains('jtabs-selected')) {\r\n                // Current one\r\n                previous = i;\r\n            }\r\n            // Remote selected\r\n            obj.headers.children[i].classList.remove('jtabs-selected');\r\n            if (obj.content.children[i]) {\r\n                obj.content.children[i].classList.remove('jtabs-selected');\r\n            }\r\n        }\r\n\r\n        obj.headers.children[index].classList.add('jtabs-selected');\r\n        if (obj.content.children[index]) {\r\n            obj.content.children[index].classList.add('jtabs-selected');\r\n        }\r\n\r\n        if (previous != index && typeof(obj.options.onchange) == 'function') {\r\n            if (obj.content.children[index]) {\r\n                obj.options.onchange(el, obj, index, obj.headers.children[index], obj.content.children[index]);\r\n            }\r\n        }\r\n\r\n        // Hide\r\n        if (obj.options.hideHeaders == true && (obj.headers.children.length < 3 && obj.options.allowCreate == false)) {\r\n            obj.headers.parentNode.style.display = 'none';\r\n        } else {\r\n            // Set border\r\n            setBorder(index);\r\n\r\n            obj.headers.parentNode.style.display = '';\r\n\r\n            var x1 = obj.headers.children[index].offsetLeft;\r\n            var x2 = x1 + obj.headers.children[index].offsetWidth;\r\n            var r1 = obj.headers.scrollLeft;\r\n            var r2 = r1 + obj.headers.offsetWidth;\r\n\r\n            if (! (r1 <= x1 && r2 >= x2)) {\r\n                // Out of the viewport\r\n                updateControls(x1 - 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.selectIndex = function(a) {\r\n        var index = Array.prototype.indexOf.call(obj.headers.children, a);\r\n        if (index >= 0) {\r\n            obj.open(index);\r\n        }\r\n\r\n        return index;\r\n    }\r\n\r\n    obj.rename = function(i, title) {\r\n        if (! title) {\r\n            title = prompt('New title', obj.headers.children[i].innerText);\r\n        }\r\n        obj.headers.children[i].innerText = title;\r\n        obj.open(i);\r\n    }\r\n\r\n    obj.create = function(title, url) {\r\n        if (typeof(obj.options.onbeforecreate) == 'function') {\r\n            var ret = obj.options.onbeforecreate(el);\r\n            if (ret === false) {\r\n                return false;\r\n            } else {\r\n                title = ret;\r\n            }\r\n        }\r\n\r\n        var div = obj.appendElement(title);\r\n\r\n        if (typeof(obj.options.oncreate) == 'function') {\r\n            obj.options.oncreate(el, div)\r\n        }\r\n\r\n        return div;\r\n    }\r\n\r\n    obj.remove = function(index) {\r\n        return obj.deleteElement(index);\r\n    }\r\n\r\n    obj.nextNumber = function() {\r\n        var num = 0;\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            var tmp = obj.headers.children[i].innerText.match(/[0-9].*/);\r\n            if (tmp > num) {\r\n                num = parseInt(tmp);\r\n            }\r\n        }\r\n        if (! num) {\r\n            num = 1;\r\n        } else {\r\n            num++;\r\n        }\r\n\r\n        return num;\r\n    }\r\n\r\n    obj.deleteElement = function(index) {\r\n        if (! obj.headers.children[index]) {\r\n            return false;\r\n        } else {\r\n            obj.headers.removeChild(obj.headers.children[index]);\r\n            obj.content.removeChild(obj.content.children[index]);\r\n        }\r\n\r\n        obj.open(0);\r\n\r\n        if (typeof(obj.options.ondelete) == 'function') {\r\n            obj.options.ondelete(el, index)\r\n        }\r\n    }\r\n\r\n    obj.appendElement = function(title, cb) {\r\n        if (! title) {\r\n            var title = prompt('Title?', '');\r\n        }\r\n\r\n        if (title) {\r\n            // Add content\r\n            var div = document.createElement('div');\r\n            obj.content.appendChild(div);\r\n\r\n            // Add headers\r\n            var h = document.createElement('div');\r\n            h.innerHTML = title;\r\n            h.content = div;\r\n            obj.headers.insertBefore(h, obj.headers.lastChild);\r\n\r\n            // Sortable\r\n            if (obj.options.allowChangePosition) {\r\n                h.setAttribute('draggable', 'true');\r\n            }\r\n            // Open new tab\r\n            obj.selectIndex(h);\r\n\r\n            // Callback\r\n            if (typeof(cb) == 'function') {\r\n                cb(div, h);\r\n            }\r\n\r\n            // Return element\r\n            return div;\r\n        }\r\n    }\r\n\r\n    obj.getActive = function() {\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            if (obj.headers.children[i].classList.contains('jtabs-selected')) {\r\n                return i\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    obj.updateContent = function(position, newContent) {\r\n        if (typeof newContent !== 'string') {\r\n            var contentItem = newContent;\r\n        } else {\r\n            var contentItem = document.createElement('div');\r\n            contentItem.innerHTML = newContent;\r\n        }\r\n\r\n        if (obj.content.children[position].classList.contains('jtabs-selected')) {\r\n            newContent.classList.add('jtabs-selected');\r\n        }\r\n\r\n        obj.content.replaceChild(newContent, obj.content.children[position]);\r\n    }\r\n\r\n    obj.updatePosition = function(f, t) {\r\n        // Ondrop update position of content\r\n        if (f > t) {\r\n            obj.content.insertBefore(obj.content.children[f], obj.content.children[t]);\r\n        } else {\r\n            obj.content.insertBefore(obj.content.children[f], obj.content.children[t].nextSibling);\r\n        }\r\n\r\n        // Open destination tab\r\n        obj.open(t);\r\n\r\n        // Call event\r\n        if (typeof(obj.options.onchangeposition) == 'function') {\r\n            obj.options.onchangeposition(obj.headers, f, t);\r\n        }\r\n    }\r\n\r\n    obj.move = function(f, t) {\r\n        if (f > t) {\r\n            obj.headers.insertBefore(obj.headers.children[f], obj.headers.children[t]);\r\n        } else {\r\n            obj.headers.insertBefore(obj.headers.children[f], obj.headers.children[t].nextSibling);\r\n        }\r\n\r\n        obj.updatePosition(f, t);\r\n    }\r\n\r\n    obj.setBorder = setBorder;\r\n\r\n    obj.init = function() {\r\n        el.innerHTML = '';\r\n\r\n        // Make sure the component is blank\r\n        obj.headers = document.createElement('div');\r\n        obj.content = document.createElement('div');\r\n        obj.headers.classList.add('jtabs-headers');\r\n        obj.content.classList.add('jtabs-content');\r\n\r\n        if (obj.options.palette) {\r\n            el.classList.add('jtabs-modern');\r\n        } else {\r\n            el.classList.remove('jtabs-modern');\r\n        }\r\n\r\n        // Padding\r\n        if (obj.options.padding) {\r\n            obj.content.style.padding = parseInt(obj.options.padding) + 'px';\r\n        }\r\n\r\n        // Header\r\n        var header = document.createElement('div');\r\n        header.className = 'jtabs-headers-container';\r\n        header.appendChild(obj.headers);\r\n        if (obj.options.maxWidth) {\r\n            header.style.maxWidth = parseInt(obj.options.maxWidth) + 'px';\r\n        }\r\n\r\n        // Controls\r\n        var controls = document.createElement('div');\r\n        controls.className = 'jtabs-controls';\r\n        controls.setAttribute('draggable', 'false');\r\n        header.appendChild(controls);\r\n\r\n        // Append DOM elements\r\n        if (obj.options.position == 'bottom') {\r\n            el.appendChild(obj.content);\r\n            el.appendChild(header);\r\n        } else {\r\n            el.appendChild(header);\r\n            el.appendChild(obj.content);\r\n        }\r\n\r\n        // New button\r\n        if (obj.options.allowCreate == true) {\r\n            var add = document.createElement('div');\r\n            add.className = 'jtabs-add';\r\n            add.onclick = function() {\r\n                obj.create();\r\n            }\r\n            controls.appendChild(add);\r\n        }\r\n\r\n        prev = document.createElement('div');\r\n        prev.className = 'jtabs-prev';\r\n        prev.onclick = function() {\r\n            updateControls(obj.headers.scrollLeft - obj.headers.offsetWidth);\r\n        }\r\n        controls.appendChild(prev);\r\n\r\n        next = document.createElement('div');\r\n        next.className = 'jtabs-next';\r\n        next.onclick = function() {\r\n            updateControls(obj.headers.scrollLeft + obj.headers.offsetWidth);\r\n        }\r\n        controls.appendChild(next);\r\n\r\n        // Data\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            // Title\r\n            if (obj.options.data[i].titleElement) {\r\n                var headerItem = obj.options.data[i].titleElement;\r\n            } else {\r\n                var headerItem = document.createElement('div');\r\n            }\r\n            // Icon\r\n            if (obj.options.data[i].icon) {\r\n                var iconContainer = document.createElement('div');\r\n                var icon = document.createElement('i');\r\n                icon.classList.add('material-icons');\r\n                icon.innerHTML = obj.options.data[i].icon;\r\n                iconContainer.appendChild(icon);\r\n                headerItem.appendChild(iconContainer);\r\n            }\r\n            // Title\r\n            if (obj.options.data[i].title) {\r\n                var title = document.createTextNode(obj.options.data[i].title);\r\n                headerItem.appendChild(title);\r\n            }\r\n            // Width\r\n            if (obj.options.data[i].width) {\r\n                headerItem.style.width = obj.options.data[i].width;\r\n            }\r\n            // Content\r\n            if (obj.options.data[i].contentElement) {\r\n                var contentItem = obj.options.data[i].contentElement;\r\n            } else {\r\n                var contentItem = document.createElement('div');\r\n                contentItem.innerHTML = obj.options.data[i].content;\r\n            }\r\n            obj.headers.appendChild(headerItem);\r\n            obj.content.appendChild(contentItem);\r\n        }\r\n\r\n        // Animation\r\n        border = document.createElement('div');\r\n        border.className = 'jtabs-border';\r\n        obj.headers.appendChild(border);\r\n\r\n        if (obj.options.animation) {\r\n            el.classList.add('jtabs-animation');\r\n        }\r\n\r\n        // Events\r\n        obj.headers.addEventListener(\"click\", function(e) {\r\n            if (e.target.parentNode.classList.contains('jtabs-headers')) {\r\n                var target = e.target;\r\n            } else {\r\n                if (e.target.tagName == 'I') {\r\n                    var target = e.target.parentNode.parentNode;\r\n                } else {\r\n                    var target = e.target.parentNode;\r\n                }\r\n            }\r\n\r\n            var index = obj.selectIndex(target);\r\n\r\n            if (typeof(obj.options.onclick) == 'function') {\r\n                obj.options.onclick(el, obj, index, obj.headers.children[index], obj.content.children[index]);\r\n            }\r\n        });\r\n\r\n        obj.headers.addEventListener(\"contextmenu\", function(e) {\r\n            obj.selectIndex(e.target);\r\n        });\r\n\r\n        if (obj.headers.children.length) {\r\n            // Open first tab\r\n            obj.open(0);\r\n        }\r\n\r\n        // Update controls\r\n        updateControls(0);\r\n\r\n        if (obj.options.allowChangePosition == true) {\r\n            jSuites.sorting(obj.headers, {\r\n                direction: 1,\r\n                ondrop: function(a,b,c) {\r\n                    obj.updatePosition(b,c);\r\n                },\r\n            });\r\n        }\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n    }\r\n\r\n    // Loading existing nodes as the data\r\n    if (el.children[0] && el.children[0].children.length) {\r\n        // Create from existing elements\r\n        for (var i = 0; i < el.children[0].children.length; i++) {\r\n            var item = obj.options.data && obj.options.data[i] ? obj.options.data[i] : {};\r\n\r\n            if (el.children[1] && el.children[1].children[i]) {\r\n                item.titleElement = el.children[0].children[i];\r\n                item.contentElement = el.children[1].children[i];\r\n            } else {\r\n                item.contentElement = el.children[0].children[i];\r\n            }\r\n\r\n            obj.options.data[i] = item;\r\n        }\r\n    }\r\n\r\n    // Remote controller flag\r\n    var loadingRemoteData = false;\r\n\r\n    // Create from data\r\n    if (obj.options.data) {\r\n        // Append children\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            if (obj.options.data[i].url) {\r\n                jSuites.ajax({\r\n                    url: obj.options.data[i].url,\r\n                    type: 'GET',\r\n                    dataType: 'text/html',\r\n                    index: i,\r\n                    success: function(result) {\r\n                        obj.options.data[this.index].content = result;\r\n                    },\r\n                    complete: function() {\r\n                        obj.init();\r\n                    }\r\n                });\r\n\r\n                // Flag loading\r\n                loadingRemoteData = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (! loadingRemoteData) {\r\n        obj.init();\r\n    }\r\n\r\n    el.tabs = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.toolbar = (function(el, options) {\r\n    // New instance\r\n    var obj = { type:'toolbar' };\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        app: null,\r\n        container: false,\r\n        badge: false,\r\n        title: false,\r\n        responsive: false,\r\n        maxWidth: null,\r\n        items: [],\r\n    }\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    if (! el && options.app && options.app.el) {\r\n        el = document.createElement('div');\r\n        options.app.el.appendChild(el);\r\n    }\r\n\r\n    // Arrow\r\n    var toolbarArrow = document.createElement('div');\r\n    toolbarArrow.classList.add('jtoolbar-item');\r\n    toolbarArrow.classList.add('jtoolbar-arrow');\r\n\r\n    var toolbarFloating = document.createElement('div');\r\n    toolbarFloating.classList.add('jtoolbar-floating');\r\n    toolbarArrow.appendChild(toolbarFloating);\r\n\r\n    obj.selectItem = function(element) {\r\n        var elements = toolbarContent.children;\r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (element != elements[i]) {\r\n                elements[i].classList.remove('jtoolbar-selected');\r\n            }\r\n        }\r\n        element.classList.add('jtoolbar-selected');\r\n    }\r\n\r\n    obj.hide = function() {\r\n        jSuites.animation.slideBottom(el, 0, function() {\r\n            el.style.display = 'none';\r\n        });\r\n    }\r\n\r\n    obj.show = function() {\r\n        el.style.display = '';\r\n        jSuites.animation.slideBottom(el, 1);\r\n    }\r\n\r\n    obj.get = function() {\r\n        return el;\r\n    }\r\n\r\n    obj.setBadge = function(index, value) {\r\n        toolbarContent.children[index].children[1].firstChild.innerHTML = value;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        toolbar.remove();\r\n        el.innerHTML = '';\r\n    }\r\n\r\n    obj.update = function(a, b) {\r\n        for (var i = 0; i < toolbarContent.children.length; i++) {\r\n            // Toolbar element\r\n            var toolbarItem = toolbarContent.children[i];\r\n            // State management\r\n            if (typeof(toolbarItem.updateState) == 'function') {\r\n                toolbarItem.updateState(el, obj, toolbarItem, a, b);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.create = function(items) {\r\n        // Reset anything in the toolbar\r\n        toolbarContent.innerHTML = '';\r\n        // Create elements in the toolbar\r\n        for (var i = 0; i < items.length; i++) {\r\n            var toolbarItem = document.createElement('div');\r\n            toolbarItem.classList.add('jtoolbar-item');\r\n\r\n            if (items[i].width) {\r\n                toolbarItem.style.width = parseInt(items[i].width) + 'px'; \r\n            }\r\n\r\n            if (items[i].k) {\r\n                toolbarItem.k = items[i].k;\r\n            }\r\n\r\n            if (items[i].tooltip) {\r\n                toolbarItem.setAttribute('title', items[i].tooltip);\r\n            }\r\n\r\n            // Id\r\n            if (items[i].id) {\r\n                toolbarItem.setAttribute('id', items[i].id);\r\n            }\r\n\r\n            // Selected\r\n            if (items[i].updateState) {\r\n                toolbarItem.updateState = items[i].updateState;\r\n            }\r\n\r\n            if (items[i].active) {\r\n                toolbarItem.classList.add('jtoolbar-active');\r\n            }\r\n\r\n            if (items[i].type == 'select' || items[i].type == 'dropdown') {\r\n                jSuites.picker(toolbarItem, items[i]);\r\n            } else if (items[i].type == 'divisor') {\r\n                toolbarItem.classList.add('jtoolbar-divisor');\r\n            } else if (items[i].type == 'label') {\r\n                toolbarItem.classList.add('jtoolbar-label');\r\n                toolbarItem.innerHTML = items[i].content;\r\n            } else {\r\n                // Material icons\r\n                var toolbarIcon = document.createElement('i');\r\n                if (typeof(items[i].class) === 'undefined') {\r\n                    toolbarIcon.classList.add('material-icons');\r\n                } else {\r\n                    var c = items[i].class.split(' ');\r\n                    for (var j = 0; j < c.length; j++) {\r\n                        toolbarIcon.classList.add(c[j]);\r\n                    }\r\n                }\r\n                toolbarIcon.innerHTML = items[i].content ? items[i].content : '';\r\n                toolbarItem.appendChild(toolbarIcon);\r\n\r\n                // Badge options\r\n                if (obj.options.badge == true) {\r\n                    var toolbarBadge = document.createElement('div');\r\n                    toolbarBadge.classList.add('jbadge');\r\n                    var toolbarBadgeContent = document.createElement('div');\r\n                    toolbarBadgeContent.innerHTML = items[i].badge ? items[i].badge : '';\r\n                    toolbarBadge.appendChild(toolbarBadgeContent);\r\n                    toolbarItem.appendChild(toolbarBadge);\r\n                }\r\n\r\n                // Title\r\n                if (items[i].title) {\r\n                    if (obj.options.title == true) {\r\n                        var toolbarTitle = document.createElement('span');\r\n                        toolbarTitle.innerHTML = items[i].title;\r\n                        toolbarItem.appendChild(toolbarTitle);\r\n                    } else {\r\n                        toolbarItem.setAttribute('title', items[i].title);\r\n                    }\r\n                }\r\n\r\n                if (obj.options.app && items[i].route) {\r\n                    // Route\r\n                    toolbarItem.route = items[i].route;\r\n                    // Onclick for route\r\n                    toolbarItem.onclick = function() {\r\n                        obj.options.app.pages(this.route);\r\n                    }\r\n                    // Create pages\r\n                    obj.options.app.pages(items[i].route, {\r\n                        toolbarItem: toolbarItem,\r\n                        closed: true\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (items[i].onclick) {\r\n                toolbarItem.onclick = items[i].onclick.bind(items[i], el, obj, toolbarItem);\r\n            }\r\n\r\n            toolbarContent.appendChild(toolbarItem);\r\n        }\r\n\r\n        // Fits to the page\r\n        obj.refresh();\r\n    }\r\n\r\n    obj.open = function() {\r\n        toolbarArrow.classList.add('jtoolbar-arrow-selected');\r\n\r\n        var rect = toolbarFloating.getBoundingClientRect();\r\n        if (rect.bottom > window.innerHeight) {\r\n            toolbarFloating.style.bottom = '0';\r\n        } else {\r\n            toolbarFloating.style.removeProperty('bottom');\r\n        }\r\n\r\n        toolbarFloating.style.right = '0';\r\n\r\n        toolbarArrow.children[0].focus();\r\n        // Start tracking\r\n        jSuites.tracking(obj, true);\r\n    }\r\n\r\n    obj.close = function() {\r\n        toolbarArrow.classList.remove('jtoolbar-arrow-selected')\r\n        // End tracking\r\n        jSuites.tracking(obj, false);\r\n    }\r\n\r\n    obj.refresh = function() {\r\n        if (obj.options.responsive == true) {\r\n            // Width of the c\r\n            var rect = el.parentNode.getBoundingClientRect();\r\n            if (! obj.options.maxWidth) {\r\n                obj.options.maxWidth = rect.width;\r\n            }\r\n            // Max width\r\n            var width = parseInt(obj.options.maxWidth); \r\n            // Remove arrow\r\n            toolbarArrow.remove();\r\n            // Move all items to the toolbar\r\n            while (toolbarFloating.firstChild) {\r\n                toolbarContent.appendChild(toolbarFloating.firstChild);\r\n            }\r\n            // Available parent space\r\n            var available = obj.options.maxWidth;\r\n            // Toolbar is larger than the parent, move elements to the floating element\r\n            if (available < toolbarContent.offsetWidth) {\r\n                // Give space to the floating element\r\n                available -= 50;\r\n                // Move to the floating option\r\n                while (toolbarContent.lastChild && available < toolbarContent.offsetWidth) {\r\n                    toolbarFloating.insertBefore(toolbarContent.lastChild, toolbarFloating.firstChild);\r\n                }\r\n            }\r\n            // Show arrow\r\n            if (toolbarFloating.children.length > 0) {\r\n                toolbarContent.appendChild(toolbarArrow);\r\n            }\r\n        }\r\n    }\r\n\r\n    el.onclick = function(e) {\r\n        var element = jSuites.findElement(e.target, 'jtoolbar-item');\r\n        if (element) {\r\n            obj.selectItem(element);\r\n        }\r\n\r\n        if (e.target.classList.contains('jtoolbar-arrow')) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    window.addEventListener('resize', function() {\r\n        obj.refresh();\r\n    });\r\n\r\n    // Toolbar\r\n    el.classList.add('jtoolbar');\r\n    // Reset content\r\n    el.innerHTML = '';\r\n    // Container\r\n    if (obj.options.container == true) {\r\n        el.classList.add('jtoolbar-container');\r\n    }\r\n    // Content\r\n    var toolbarContent = document.createElement('div');\r\n    el.appendChild(toolbarContent);\r\n    // Special toolbar for mobile applications\r\n    if (obj.options.app) {\r\n        el.classList.add('jtoolbar-mobile');\r\n    }\r\n    // Create toolbar\r\n    obj.create(obj.options.items);\r\n    // Shortcut\r\n    el.toolbar = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n\r\n    return jSuites;\r\n\r\n})));", "/**\r\n * (c) jSuites Javascript Web Components\r\n *\r\n * Website: https://jsuites.net\r\n * Description: Create amazing web based applications.\r\n *\r\n * MIT License\r\n *\r\n */\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jSuites = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\nvar jSuites = function(options) {\r\n    var obj = {}\r\n    var version = '4.4.0';\r\n\r\n    var find = function(DOMElement, component) {\r\n        if (DOMElement[component.type] && DOMElement[component.type] == component) {\r\n            return true;\r\n        }\r\n        if (DOMElement.parentNode) {\r\n            return find(DOMElement.parentNode, component);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    var isOpened = function(e) {\r\n        if (jSuites.current.length > 0) {\r\n            for (var i = 0; i < jSuites.current.length; i++) {\r\n                if (jSuites.current[i] && ! find(e.target, jSuites.current[i])) {\r\n                    jSuites.current[i].close();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.init = function() {\r\n        document.addEventListener(\"click\", isOpened);\r\n\r\n        obj.version = version;\r\n    }\r\n\r\n    obj.tracking = function(component, state) {\r\n        if (state == true) {\r\n            jSuites.current = jSuites.current.filter(function(v) {\r\n                return v !== null;\r\n            });\r\n\r\n            // Start after all events\r\n            setTimeout(function() {\r\n                jSuites.current.push(component);\r\n            }, 0);\r\n\r\n        } else {\r\n            var index = jSuites.current.indexOf(component);\r\n            if (index >= 0) {\r\n                jSuites.current[index] = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get or set a property from a JSON from a string.\r\n     */\r\n    obj.path = function(str, val) {\r\n        str = str.split('.');\r\n        if (str.length) {\r\n            var o = this;\r\n            var p = null;\r\n            while (str.length > 1) {\r\n                // Get the property\r\n                p = str.shift();\r\n                // Check if the property exists\r\n                if (o.hasOwnProperty(p)) {\r\n                    o = o[p];\r\n                } else {\r\n                    // Property does not exists\r\n                    if (val === undefined) {\r\n                        return undefined;\r\n                    } else {\r\n                        // Create the property\r\n                        o[p] = {};\r\n                        // Next property\r\n                        o = o[p];\r\n                    }\r\n                }\r\n            }\r\n            // Get the property\r\n            p = str.shift();\r\n            // Set or get the value\r\n            if (val !== undefined) {\r\n                o[p] = val;\r\n                // Success\r\n                return true;\r\n            } else {\r\n                // Return the value\r\n                return o[p];\r\n            }\r\n        }\r\n        // Something went wrong\r\n        return false;\r\n    }\r\n\r\n    // Update dictionary\r\n    obj.setDictionary = function(d) {\r\n        obj.dictionary = d;\r\n\r\n        // Translations\r\n        var t = null;\r\n        for (var i = 0; i < jSuites.calendar.weekdays.length; i++) {\r\n            t =  jSuites.translate(jSuites.calendar.weekdays[i]);\r\n            if (jSuites.calendar.weekdays[i]) {\r\n                jSuites.calendar.weekdays[i] = t;\r\n                jSuites.calendar.weekdaysShort[i] = t.substr(0,3);\r\n            }\r\n        }\r\n        for (var i = 0; i < jSuites.calendar.months.length; i++) {\r\n            t = jSuites.translate(jSuites.calendar.months[i]);\r\n            if (t) {\r\n                jSuites.calendar.months[i] = t;\r\n                jSuites.calendar.monthsShort[i] = t.substr(0,3);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Dictionary\r\n    obj.dictionary = {};\r\n\r\n    // Translate\r\n    obj.translate = function(t) {\r\n        return obj.dictionary[t] || t;\r\n    }\r\n\r\n    // Array of opened components\r\n    obj.current = [];\r\n\r\n    return obj;\r\n}();\r\n\r\n/**\r\n * Global jsuites event\r\n */\r\nif (typeof(document) !== \"undefined\") {\r\n    jSuites.init();\r\n}\r\n\r\njSuites.ajax = (function(options, complete) {\r\n    if (Array.isArray(options)) {\r\n        // Create multiple request controller \r\n        var multiple = {\r\n            instance: [],\r\n            complete: complete,\r\n        }\r\n\r\n        if (options.length > 0) {\r\n            for (var i = 0; i < options.length; i++) {\r\n                options[i].multiple = multiple;\r\n                multiple.instance.push(jSuites.ajax(options[i]));\r\n            }\r\n        }\r\n\r\n        return multiple;\r\n    }\r\n\r\n    if (! options.data) {\r\n        options.data = {};\r\n    }\r\n\r\n    if (options.type) {\r\n        options.method = options.type;\r\n    }\r\n\r\n    // Default method\r\n    if (! options.method) {\r\n        options.method = 'GET';\r\n    }\r\n\r\n    // Default type\r\n    if (! options.dataType) {\r\n        options.dataType = 'json';\r\n    }\r\n\r\n    if (options.data) {\r\n        // Parse object to variables format\r\n        var parseData = function(value, key) {\r\n            var vars = [];\r\n            var keys = Object.keys(value);\r\n            if (keys.length) {\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    if (key) {\r\n                        var k = key + '[' + keys[i] + ']';\r\n                    } else {\r\n                        var k = keys[i];\r\n                    }\r\n\r\n                    if (typeof(value[keys[i]]) == 'object') {\r\n                        var r = parseData(value[keys[i]], k);\r\n                        var o = Object.keys(r);\r\n                        for (var j = 0; j < o.length; j++) {\r\n                            vars[o[j]] = r[o[j]];\r\n                        }\r\n                    } else {\r\n                        vars[k] = value[keys[i]];\r\n                    }\r\n                }\r\n            }\r\n\r\n            return vars;\r\n        }\r\n\r\n        var data = [];\r\n        var d = parseData(options.data);\r\n        var k = Object.keys(d);\r\n        for (var i = 0; i < k.length; i++) {\r\n            data.push(k[i] + '=' + encodeURIComponent(d[k[i]]));\r\n        }\r\n\r\n        if (options.method == 'GET' && data.length > 0) {\r\n            if (options.url.indexOf('?') < 0) {\r\n                options.url += '?';\r\n            }\r\n            options.url += data.join('&');\r\n        }\r\n    }\r\n\r\n    var httpRequest = new XMLHttpRequest();\r\n    httpRequest.open(options.method, options.url, true);\r\n    httpRequest.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\r\n\r\n    if (options.method == 'POST') {\r\n        httpRequest.setRequestHeader('Accept', 'application/json');\r\n        httpRequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n    } else {\r\n        if (options.dataType == 'json') {\r\n            httpRequest.setRequestHeader('Content-Type', 'text/json');\r\n        } else if (options.dataType == 'blob') {\r\n            httpRequest.responseType = \"blob\";\r\n        } else if (options.dataType == 'html') {\r\n            httpRequest.setRequestHeader('Content-Type', 'text/html');\r\n        }\r\n    }\r\n\r\n    // No cache\r\n    if (options.cache != true) {\r\n        httpRequest.setRequestHeader('pragma', 'no-cache');\r\n        httpRequest.setRequestHeader('cache-control', 'no-cache');\r\n    }\r\n\r\n    // Authentication\r\n    if (options.withCredentials == true) {\r\n        httpRequest.withCredentials = true\r\n    }\r\n\r\n    // Before send\r\n    if (typeof(options.beforeSend) == 'function') {\r\n        options.beforeSend(httpRequest);\r\n    }\r\n\r\n    httpRequest.onload = function() {\r\n        if (httpRequest.status === 200) {\r\n            if (options.dataType == 'json') {\r\n                try {\r\n                    var result = JSON.parse(httpRequest.responseText);\r\n\r\n                    if (options.success && typeof(options.success) == 'function') {\r\n                        options.success(result);\r\n                    }\r\n                } catch(err) {\r\n                    if (options.error && typeof(options.error) == 'function') {\r\n                        options.error(err, result);\r\n                    }\r\n                }\r\n            } else {\r\n                if (options.dataType == 'blob') {\r\n                    var result = httpRequest.response;\r\n                } else {\r\n                    var result = httpRequest.responseText;\r\n                }\r\n\r\n                if (options.success && typeof(options.success) == 'function') {\r\n                    options.success(result);\r\n                }\r\n            }\r\n        } else {\r\n            if (options.error && typeof(options.error) == 'function') {\r\n                options.error(httpRequest.responseText, httpRequest.status);\r\n            }\r\n        }\r\n\r\n        // Global queue\r\n        if (jSuites.ajax.queue && jSuites.ajax.queue.length > 0) {\r\n            jSuites.ajax.send(jSuites.ajax.queue.shift());\r\n        }\r\n\r\n        // Global complete method\r\n        if (jSuites.ajax.requests && jSuites.ajax.requests.length) {\r\n            // Get index of this request in the container\r\n            var index = jSuites.ajax.requests.indexOf(httpRequest);\r\n            // Remove from the ajax requests container\r\n            jSuites.ajax.requests.splice(index, 1);\r\n            // Deprected: Last one?\r\n            if (! jSuites.ajax.requests.length) {\r\n                // Object event\r\n                if (options.complete && typeof(options.complete) == 'function') {\r\n                    options.complete(result);\r\n                }\r\n            }\r\n            // Group requests\r\n            if (options.group) {\r\n                if (jSuites.ajax.oncomplete && typeof(jSuites.ajax.oncomplete[options.group]) == 'function') {\r\n                    if (! jSuites.ajax.pending(options.group)) {\r\n                        jSuites.ajax.oncomplete[options.group]();\r\n                        jSuites.ajax.oncomplete[options.group] = null;\r\n                    }\r\n                }\r\n            }\r\n            // Multiple requests controller\r\n            if (options.multiple && options.multiple.instance) {\r\n                // Get index of this request in the container\r\n                var index = options.multiple.instance.indexOf(httpRequest);\r\n                // Remove from the ajax requests container\r\n                options.multiple.instance.splice(index, 1);\r\n                // If this is the last one call method complete\r\n                if (! options.multiple.instance.length) {\r\n                    if (options.multiple.complete && typeof(options.multiple.complete) == 'function') {\r\n                        options.multiple.complete(result);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Keep the options\r\n    httpRequest.options = options;\r\n    // Data\r\n    httpRequest.data = data;\r\n\r\n    // Queue\r\n    if (options.queue == true && jSuites.ajax.requests.length > 0) {\r\n        jSuites.ajax.queue.push(httpRequest);\r\n    } else {\r\n        jSuites.ajax.send(httpRequest)\r\n    }\r\n\r\n    return httpRequest;\r\n});\r\n\r\njSuites.ajax.send = function(httpRequest) {\r\n    if (httpRequest.data) {\r\n        httpRequest.send(httpRequest.data.join('&'));\r\n    } else {\r\n        httpRequest.send();\r\n    }\r\n\r\n    jSuites.ajax.requests.push(httpRequest);\r\n}\r\n\r\njSuites.ajax.exists = function(url, __callback) {\r\n    var http = new XMLHttpRequest();\r\n    http.open('HEAD', url, false);\r\n    http.send();\r\n    if (http.status) {\r\n        __callback(http.status);\r\n    }\r\n}\r\n\r\njSuites.ajax.pending = function(group) {\r\n    var n = 0;\r\n    var o = jSuites.ajax.requests;\r\n    if (o && o.length) {\r\n        for (var i = 0; i < o.length; i++) {\r\n            if (! group || group == o[i].options.group) {\r\n                n++\r\n            }\r\n        }\r\n    }\r\n    return n;\r\n}\r\n\r\njSuites.ajax.oncomplete = {};\r\njSuites.ajax.requests = [];\r\njSuites.ajax.queue = [];\r\n\r\njSuites.alert = function(message) {\r\n    if (jSuites.getWindowWidth() < 800 && jSuites.dialog) {\r\n        jSuites.dialog.open({\r\n            title:'Alert',\r\n            message:message,\r\n        });\r\n    } else {\r\n        alert(message);\r\n    }\r\n}\r\n\r\njSuites.animation = {};\r\n\r\njSuites.animation.slideLeft = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-left-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-left-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-left-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-left-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideRight = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-right-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-right-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-right-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-right-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideTop = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-top-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-top-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-top-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-top-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideBottom = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-bottom-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-bottom-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-bottom-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-bottom-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\njSuites.animation.fadeIn = function(element, done) {\r\n    element.style.display = '';\r\n    element.classList.add('fade-in');\r\n    setTimeout(function() {\r\n        element.classList.remove('fade-in');\r\n        if (typeof(done) == 'function') {\r\n            done();\r\n        }\r\n    }, 2000);\r\n}\r\n\r\njSuites.animation.fadeOut = function(element, done) {\r\n    element.classList.add('fade-out');\r\n    setTimeout(function() {\r\n        element.style.display = 'none';\r\n        element.classList.remove('fade-out');\r\n        if (typeof(done) == 'function') {\r\n            done();\r\n        }\r\n    }, 1000);\r\n}\r\n\r\njSuites.calendar = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.calendar) {\r\n        return el.calendar.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type:'calendar' };\r\n    obj.options = {};\r\n\r\n    // Date\r\n    obj.date = null;\r\n\r\n    /**\r\n     * Update options\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            // Render type: [ default | year-month-picker ]\r\n            type: 'default',\r\n            // Restrictions\r\n            validRange: null,\r\n            // Starting weekday - 0 for sunday, 6 for saturday\r\n            startingDay: null, \r\n            // Date format\r\n            format: 'DD/MM/YYYY',\r\n            // Allow keyboard date entry\r\n            readonly: true,\r\n            // Today is default\r\n            today: false,\r\n            // Show timepicker\r\n            time: false,\r\n            // Show the reset button\r\n            resetButton: true,\r\n            // Placeholder\r\n            placeholder: '',\r\n            // Translations can be done here\r\n            months: jSuites.calendar.monthsShort,\r\n            monthsFull: jSuites.calendar.months,\r\n            weekdays: jSuites.calendar.weekdays,\r\n            weekdays_short: jSuites.calendar.weekdays,\r\n            textDone: jSuites.translate('Done'),\r\n            textReset: jSuites.translate('Reset'),\r\n            textUpdate: jSuites.translate('Update'),\r\n            // Value\r\n            value: null,\r\n            // Fullscreen (this is automatic set for screensize < 800)\r\n            fullscreen: false,\r\n            // Create the calendar closed as default\r\n            opened: false,\r\n            // Events\r\n            onopen: null,\r\n            onclose: null,\r\n            onchange: null,\r\n            onupdate: null,\r\n            // Internal mode controller\r\n            mode: null,\r\n            position: null,\r\n            // Data type\r\n            dataType: null,\r\n        }\r\n\r\n        for (var i = 0; i < defaults.weekdays_short.length; i++) {\r\n            defaults.weekdays_short[i] = defaults.weekdays_short[i].substr(0,1);\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Reset button\r\n        if (obj.options.resetButton == false) {\r\n            calendarReset.style.display = 'none';\r\n        } else {\r\n            calendarReset.style.display = '';\r\n        }\r\n\r\n        // Readonly\r\n        if (obj.options.readonly) {\r\n            el.setAttribute('readonly', 'readonly');\r\n        } else {\r\n            el.removeAttribute('readonly');\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            el.removeAttribute('placeholder');\r\n        }\r\n\r\n        if (jSuites.isNumeric(obj.options.value) && obj.options.value > 0) {\r\n            obj.options.value = jSuites.calendar.numToDate(obj.options.value);\r\n            // Data type numberic\r\n            obj.options.dataType = 'numeric';\r\n        }\r\n\r\n        // Texts\r\n        calendarReset.innerHTML = obj.options.textReset;\r\n        calendarConfirm.innerHTML = obj.options.textDone;\r\n        calendarControlsUpdateButton.innerHTML = obj.options.textUpdate;\r\n\r\n        // Define mask\r\n        el.setAttribute('data-mask', obj.options.format.toLowerCase());\r\n\r\n        // Value\r\n        if (! obj.options.value && obj.options.today) {\r\n            var value = jSuites.calendar.now();\r\n        } else {\r\n            var value = obj.options.value;\r\n        }\r\n\r\n        // Set internal date\r\n        if (value) {\r\n            // Force the update\r\n            obj.options.value = null;\r\n            // New value\r\n            obj.setValue(value);\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Open the calendar\r\n     */\r\n    obj.open = function (value) {\r\n        if (! calendar.classList.contains('jcalendar-focus')) {\r\n            if (! calendar.classList.contains('jcalendar-inline')) {\r\n                // Current\r\n                jSuites.calendar.current = obj;\r\n                // Start tracking\r\n                jSuites.tracking(obj, true);\r\n                // Create the days\r\n                obj.getDays();\r\n                // Render months\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.getMonths();\r\n                }\r\n                // Get time\r\n                if (obj.options.time) {\r\n                    calendarSelectHour.value = obj.date[3];\r\n                    calendarSelectMin.value = obj.date[4];\r\n                }\r\n\r\n                // Show calendar\r\n                calendar.classList.add('jcalendar-focus');\r\n\r\n                // Get the position of the corner helper\r\n                if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen) {\r\n                    calendar.classList.add('jcalendar-fullsize');\r\n                    // Animation\r\n                    jSuites.animation.slideBottom(calendarContent, 1);\r\n                } else {\r\n                    calendar.classList.remove('jcalendar-fullsize');\r\n\r\n                    var rect = el.getBoundingClientRect();\r\n                    var rectContent = calendarContent.getBoundingClientRect();\r\n\r\n                    if (obj.options.position) {\r\n                        calendarContainer.style.position = 'fixed';\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            calendarContainer.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                        } else {\r\n                            calendarContainer.style.top = (rect.top + rect.height + 2) + 'px';\r\n                        }\r\n                        calendarContainer.style.left = rect.left + 'px';\r\n                    } else {\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            var d = -1 * (rect.height + rectContent.height + 2);\r\n                            if (d + rect.top < 0) {\r\n                                d = -1 * (rect.top + rect.height);\r\n                            }\r\n                            calendarContainer.style.top = d + 'px';\r\n                        } else {\r\n                            calendarContainer.style.top = 2 + 'px'; \r\n                        }\r\n\r\n                        if (window.innerWidth < rect.left + rectContent.width) {\r\n                            var d = window.innerWidth - (rect.left + rectContent.width + 20);\r\n                            calendarContainer.style.left = d + 'px';\r\n                        } else {\r\n                            calendarContainer.style.left = '0px'; \r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Events\r\n                if (typeof(obj.options.onopen) == 'function') {\r\n                    obj.options.onopen(el);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.close = function (ignoreEvents, update) {\r\n        if (calendar.classList.contains('jcalendar-focus')) {\r\n            if (update !== false) {\r\n                var element = calendar.querySelector('.jcalendar-selected');\r\n\r\n                if (typeof(update) == 'string') {\r\n                    var value = update;\r\n                } else if (! element || element.classList.contains('jcalendar-disabled')) {\r\n                    var value = obj.options.value\r\n                } else {\r\n                    var value = obj.getValue();\r\n                }\r\n\r\n                obj.setValue(value);\r\n            }\r\n\r\n            // Events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Hide\r\n            calendar.classList.remove('jcalendar-focus');\r\n            // Stop tracking\r\n            jSuites.tracking(obj, false);\r\n            // Current\r\n            jSuites.calendar.current = null;\r\n        }\r\n\r\n        return obj.options.value;\r\n    }\r\n\r\n    obj.prev = function() {\r\n        // Check if the visualization is the days picker or years picker\r\n        if (obj.options.mode == 'years') {\r\n            obj.date[0] = obj.date[0] - 12;\r\n\r\n            // Update picker table of days\r\n            obj.getYears();\r\n        } else if (obj.options.mode == 'months') {\r\n            obj.date[0] = parseInt(obj.date[0]) - 1;\r\n            // Update picker table of months\r\n            obj.getMonths();\r\n        } else {\r\n            // Go to the previous month\r\n            if (obj.date[1] < 2) {\r\n                obj.date[0] = obj.date[0] - 1;\r\n                obj.date[1] = 12;\r\n            } else {\r\n                obj.date[1] = obj.date[1] - 1;\r\n            }\r\n\r\n            // Update picker table of days\r\n            obj.getDays();\r\n        }\r\n    }\r\n\r\n    obj.next = function() {\r\n        // Check if the visualization is the days picker or years picker\r\n        if (obj.options.mode == 'years') {\r\n            obj.date[0] = parseInt(obj.date[0]) + 12;\r\n\r\n            // Update picker table of days\r\n            obj.getYears();\r\n        } else if (obj.options.mode == 'months') {\r\n            obj.date[0] = parseInt(obj.date[0]) + 1;\r\n            // Update picker table of months\r\n            obj.getMonths();\r\n        } else {\r\n            // Go to the previous month\r\n            if (obj.date[1] > 11) {\r\n                obj.date[0] = parseInt(obj.date[0]) + 1;\r\n                obj.date[1] = 1;\r\n            } else {\r\n                obj.date[1] = parseInt(obj.date[1]) + 1;\r\n            }\r\n\r\n            // Update picker table of days\r\n            obj.getDays();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set today\r\n     */\r\n    obj.setToday = function() {\r\n        // Today\r\n        var value = new Date().toISOString().substr(0, 10);\r\n        // Change value\r\n        obj.setValue(value);\r\n        // Value\r\n        return value;\r\n    }\r\n\r\n    obj.setValue = function(val) {\r\n        if (! val) {\r\n            val = '' + val;\r\n        }\r\n        // Values\r\n        var newValue = val;\r\n        var oldValue = obj.options.value;\r\n\r\n        if (oldValue != newValue) {\r\n            // Set label\r\n            if (! newValue) {\r\n                obj.date = null;\r\n                var val = '';\r\n            } else {\r\n                var value = obj.setLabel(newValue, obj.options);\r\n                var date = newValue.split(' ');\r\n                if (! date[1]) {\r\n                    date[1] = '00:00:00';\r\n                }\r\n                var time = date[1].split(':')\r\n                var date = date[0].split('-');\r\n                var y = parseInt(date[0]);\r\n                var m = parseInt(date[1]);\r\n                var d = parseInt(date[2]);\r\n                var h = parseInt(time[0]);\r\n                var i = parseInt(time[1]);\r\n                obj.date = [ y, m, d, h, i, 0 ];\r\n                var val = obj.setLabel(newValue, obj.options);\r\n            }\r\n\r\n            // New value\r\n            obj.options.value = newValue;\r\n\r\n            if (typeof(obj.options.onchange) ==  'function') {\r\n                obj.options.onchange(el, newValue, oldValue);\r\n            }\r\n\r\n            // Lemonade JS\r\n            if (el.value != val) {\r\n                el.value = val;\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        obj.getDays();\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        if (obj.date) {\r\n            if (obj.options.time) {\r\n                return jSuites.two(obj.date[0]) + '-' + jSuites.two(obj.date[1]) + '-' + jSuites.two(obj.date[2]) + ' ' + jSuites.two(obj.date[3]) + ':' + jSuites.two(obj.date[4]) + ':' + jSuites.two(0);\r\n            } else {\r\n                return jSuites.two(obj.date[0]) + '-' + jSuites.two(obj.date[1]) + '-' + jSuites.two(obj.date[2]) + ' ' + jSuites.two(0) + ':' + jSuites.two(0) + ':' + jSuites.two(0);\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     *  Calendar\r\n     */\r\n    obj.update = function(element, v) {\r\n        if (element.classList.contains('jcalendar-disabled')) {\r\n            // Do nothing\r\n        } else {\r\n            var elements = calendar.querySelector('.jcalendar-selected');\r\n            if (elements) {\r\n                elements.classList.remove('jcalendar-selected');\r\n            }\r\n            element.classList.add('jcalendar-selected');\r\n\r\n            if (element.classList.contains('jcalendar-set-month')) {\r\n                obj.date[1] = v;\r\n            } else {\r\n                obj.date[2] = element.innerText;\r\n            }\r\n\r\n            if (! obj.options.time) {\r\n                obj.close();\r\n            } else {\r\n                obj.date[3] = calendarSelectHour.value;\r\n                obj.date[4] = calendarSelectMin.value;\r\n            }\r\n        }\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    /**\r\n     * Set to blank\r\n     */\r\n    obj.reset = function() {\r\n        // Close calendar\r\n        obj.setValue('');\r\n        obj.date = null;\r\n        obj.close(false, false);\r\n    }\r\n\r\n    /**\r\n     * Get calendar days\r\n     */\r\n    obj.getDays = function() {\r\n        // Mode\r\n        obj.options.mode = 'days';\r\n\r\n        // Setting current values in case of NULLs\r\n        var date = new Date();\r\n\r\n        // Current selection\r\n        var year = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : parseInt(date.getFullYear());\r\n        var month = obj.date && jSuites.isNumeric(obj.date[1]) ? obj.date[1] : parseInt(date.getMonth()) + 1;\r\n        var day = obj.date && jSuites.isNumeric(obj.date[2]) ? obj.date[2] : parseInt(date.getDate());\r\n        var hour = obj.date && jSuites.isNumeric(obj.date[3]) ? obj.date[3] : parseInt(date.getHours());\r\n        var min = obj.date && jSuites.isNumeric(obj.date[4]) ? obj.date[4] : parseInt(date.getMinutes());\r\n\r\n        // Selection container\r\n        obj.date = [ year, month, day, hour, min, 0 ];\r\n\r\n        // Update title\r\n        calendarLabelYear.innerHTML = year;\r\n        calendarLabelMonth.innerHTML = obj.options.months[month - 1];\r\n\r\n        // Current month and Year\r\n        var isCurrentMonthAndYear = (date.getMonth() == month - 1) && (date.getFullYear() == year) ? true : false;\r\n        var currentDay = date.getDate();\r\n\r\n        // Number of days in the month\r\n        var date = new Date(year, month, 0, 0, 0);\r\n        var numberOfDays = date.getDate();\r\n\r\n        // First day\r\n        var date = new Date(year, month-1, 0, 0, 0);\r\n        var firstDay = date.getDay() + 1;\r\n\r\n        // Index value\r\n        var index = obj.options.startingDay || 0;\r\n\r\n        // First of day relative to the starting calendar weekday\r\n        firstDay = firstDay - index;\r\n\r\n        // Reset table\r\n        calendarBody.innerHTML = '';\r\n\r\n        // Weekdays Row\r\n        var row = document.createElement('tr');\r\n        row.setAttribute('align', 'center');\r\n        calendarBody.appendChild(row);\r\n\r\n        // Create weekdays row\r\n        for (var i = 0; i < 7; i++) {\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-weekday')\r\n            cell.innerHTML = obj.options.weekdays_short[index];\r\n            row.appendChild(cell);\r\n            // Next week day\r\n            index++;\r\n            // Restart index\r\n            if (index > 6) {\r\n                index = 0;\r\n            }\r\n        }\r\n\r\n        // Index of days\r\n        var index = 0;\r\n        var d = 0;\r\n \r\n        // Calendar table\r\n        for (var j = 0; j < 6; j++) {\r\n            // Reset cells container\r\n            var row = document.createElement('tr');\r\n            row.setAttribute('align', 'center');\r\n            // Data control\r\n            var emptyRow = true;\r\n            // Create cells\r\n            for (var i = 0; i < 7; i++) {\r\n                // Create cell\r\n                var cell = document.createElement('td');\r\n                cell.classList.add('jcalendar-set-day');\r\n\r\n                if (index >= firstDay && index < (firstDay + numberOfDays)) {\r\n                    // Day cell\r\n                    d++;\r\n                    cell.innerHTML = d;\r\n\r\n                    // Selected\r\n                    if (d == day) {\r\n                        cell.classList.add('jcalendar-selected');\r\n                    }\r\n\r\n                    // Current selection day is today\r\n                    if (isCurrentMonthAndYear && currentDay == d) {\r\n                        cell.style.fontWeight = 'bold';\r\n                    }\r\n\r\n                    // Current selection day\r\n                    var current = jSuites.calendar.now(new Date(year, month-1, d), true);\r\n\r\n                    // Available ranges\r\n                    if (obj.options.validRange) {\r\n                        if (! obj.options.validRange[0] || current >= obj.options.validRange[0]) {\r\n                            var test1 = true;\r\n                        } else {\r\n                            var test1 = false;\r\n                        }\r\n\r\n                        if (! obj.options.validRange[1] || current <= obj.options.validRange[1]) {\r\n                            var test2 = true;\r\n                        } else {\r\n                            var test2 = false;\r\n                        }\r\n\r\n                        if (! (test1 && test2)) {\r\n                            cell.classList.add('jcalendar-disabled');\r\n                        }\r\n                    }\r\n\r\n                    // Control\r\n                    emptyRow = false;\r\n                }\r\n                // Day cell\r\n                row.appendChild(cell);\r\n                // Index\r\n                index++;\r\n            }\r\n\r\n            // Add cell to the calendar body\r\n            if (emptyRow == false) {\r\n                calendarBody.appendChild(row);\r\n            }\r\n        }\r\n\r\n        // Show time controls\r\n        if (obj.options.time) {\r\n            calendarControlsTime.style.display = '';\r\n        } else {\r\n            calendarControlsTime.style.display = 'none';\r\n        }\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.getMonths = function() {\r\n        // Mode\r\n        obj.options.mode = 'months';\r\n\r\n        // Loading month labels\r\n        var months = obj.options.months;\r\n\r\n        // Value\r\n        var value = obj.options.value; \r\n\r\n        // Current date\r\n        var date = new Date();\r\n        var currentYear = parseInt(date.getFullYear());\r\n        var currentMonth = parseInt(date.getMonth()) + 1;\r\n        var selectedYear = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : currentYear;\r\n        var selectedMonth = obj.date && jSuites.isNumeric(obj.date[1]) ? obj.date[1] : currentMonth;\r\n\r\n        // Update title\r\n        calendarLabelYear.innerHTML = obj.date[0];\r\n        calendarLabelMonth.innerHTML = months[selectedMonth-1];\r\n\r\n        // Table\r\n        var table = document.createElement('table');\r\n        table.setAttribute('width', '100%');\r\n\r\n        // Row\r\n        var row = null;\r\n\r\n        // Calendar table\r\n        for (var i = 0; i < 12; i++) {\r\n            if (! (i % 4)) {\r\n                // Reset cells container\r\n                var row = document.createElement('tr');\r\n                row.setAttribute('align', 'center');\r\n                table.appendChild(row);\r\n            }\r\n\r\n            // Create cell\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-set-month');\r\n            cell.setAttribute('data-value', i+1);\r\n            cell.innerText = months[i];\r\n\r\n            if (obj.options.validRange) {\r\n                var current = selectedYear + '-' + jSuites.two(i+1);\r\n                if (! obj.options.validRange[0] || current >= obj.options.validRange[0].substr(0,7)) {\r\n                    var test1 = true;\r\n                } else {\r\n                    var test1 = false;\r\n                }\r\n\r\n                if (! obj.options.validRange[1] || current <= obj.options.validRange[1].substr(0,7)) {\r\n                    var test2 = true;\r\n                } else {\r\n                    var test2 = false;\r\n                }\r\n\r\n                if (! (test1 && test2)) {\r\n                    cell.classList.add('jcalendar-disabled');\r\n                }\r\n            }\r\n\r\n            if (i+1 == selectedMonth) {\r\n                cell.classList.add('jcalendar-selected');\r\n            }\r\n\r\n            if (currentYear == selectedYear && i+1 == currentMonth) {\r\n                cell.style.fontWeight = 'bold';\r\n            }\r\n\r\n            row.appendChild(cell);\r\n        }\r\n\r\n        calendarBody.innerHTML = '<tr><td colspan=\"7\"></td></tr>';\r\n        calendarBody.children[0].children[0].appendChild(table);\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.getYears = function() { \r\n        // Mode\r\n        obj.options.mode = 'years';\r\n\r\n        // Current date\r\n        var date = new Date();\r\n        var currentYear = date.getFullYear();\r\n        var selectedYear = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : parseInt(date.getFullYear());\r\n\r\n        // Array of years\r\n        var y = [];\r\n        for (var i = 0; i < 25; i++) {\r\n            y[i] = parseInt(obj.date[0]) + (i - 12);\r\n        }\r\n\r\n        // Assembling the year tables\r\n        var table = document.createElement('table');\r\n        table.setAttribute('width', '100%');\r\n\r\n        for (var i = 0; i < 25; i++) {\r\n            if (! (i % 5)) {\r\n                // Reset cells container\r\n                var row = document.createElement('tr');\r\n                row.setAttribute('align', 'center');\r\n                table.appendChild(row);\r\n            }\r\n\r\n            // Create cell\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-set-year');\r\n            cell.innerText = y[i];\r\n\r\n            if (selectedYear == y[i]) {\r\n                cell.classList.add('jcalendar-selected');\r\n            }\r\n\r\n            if (currentYear == y[i]) {\r\n                cell.style.fontWeight = 'bold';\r\n            }\r\n\r\n            row.appendChild(cell);\r\n        }\r\n\r\n        calendarBody.innerHTML = '<tr><td colspan=\"7\"></td></tr>';\r\n        calendarBody.firstChild.firstChild.appendChild(table);\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.setLabel = function(value, mixed) {\r\n        return jSuites.calendar.getDateString(value, mixed);\r\n    }\r\n\r\n    obj.fromFormatted = function (value, format) {\r\n        return jSuites.calendar.extractDateFromString(value, format);\r\n    }\r\n\r\n    var mouseUpControls = function(e) {\r\n        var element = jSuites.findElement(e.target, 'jcalendar-container');\r\n        if (element) {\r\n            var action = e.target.className;\r\n\r\n            // Object id\r\n            if (action == 'jcalendar-prev') {\r\n                obj.prev();\r\n            } else if (action == 'jcalendar-next') {\r\n                obj.next();\r\n            } else if (action == 'jcalendar-month') {\r\n                obj.getMonths();\r\n            } else if (action == 'jcalendar-year') {\r\n                obj.getYears();\r\n            } else if (action == 'jcalendar-set-year') {\r\n                obj.date[0] = e.target.innerText;\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.getMonths();\r\n                } else {\r\n                    obj.getDays();\r\n                }\r\n            } else if (e.target.classList.contains('jcalendar-set-month')) {\r\n                var month = parseInt(e.target.getAttribute('data-value'));\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.update(e.target, month);\r\n                } else {\r\n                    obj.date[1] = month;\r\n                    obj.getDays();\r\n                }\r\n            } else if (action == 'jcalendar-confirm' || action == 'jcalendar-update' || action == 'jcalendar-close') {\r\n                obj.close();\r\n            } else if (action == 'jcalendar-backdrop') {\r\n                obj.close(false, false);\r\n            } else if (action == 'jcalendar-reset') {\r\n                obj.reset();\r\n            } else if (e.target.classList.contains('jcalendar-set-day') && e.target.innerText) {\r\n                obj.update(e.target);\r\n            }\r\n        } else {\r\n            obj.close();\r\n        }\r\n    }\r\n\r\n    var keyUpControls = function(e) {\r\n        if (e.target.value && e.target.value.length > 3) {\r\n            var test = jSuites.calendar.extractDateFromString(e.target.value, obj.options.format);\r\n            if (test) {\r\n                obj.setValue(test);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Update actions button\r\n    var updateActions = function() {\r\n        var currentDay = calendar.querySelector('.jcalendar-selected');\r\n\r\n        if (currentDay && currentDay.classList.contains('jcalendar-disabled')) {\r\n            calendarControlsUpdateButton.setAttribute('disabled', 'disabled');\r\n            calendarSelectHour.setAttribute('disabled', 'disabled');\r\n            calendarSelectMin.setAttribute('disabled', 'disabled');\r\n        } else {\r\n            calendarControlsUpdateButton.removeAttribute('disabled');\r\n            calendarSelectHour.removeAttribute('disabled');\r\n            calendarSelectMin.removeAttribute('disabled');\r\n        }\r\n\r\n        // Event\r\n        if (typeof(obj.options.onupdate) == 'function') {\r\n            obj.options.onupdate(el, obj.getValue());\r\n        }\r\n    }\r\n\r\n    var calendar = null;\r\n    var calendarReset = null;\r\n    var calendarConfirm = null;\r\n    var calendarContainer = null;\r\n    var calendarContent = null;\r\n    var calendarLabelYear = null;\r\n    var calendarLabelMonth = null;\r\n    var calendarTable = null;\r\n    var calendarBody = null;\r\n\r\n    var calendarControls = null;\r\n    var calendarControlsTime = null;\r\n    var calendarControlsUpdate = null;\r\n    var calendarControlsUpdateButton = null;\r\n    var calendarSelectHour = null;\r\n    var calendarSelectMin = null;\r\n\r\n    var init = function() {\r\n        // Get value from initial element if that is an input\r\n        if (el.tagName == 'INPUT' && el.value) {\r\n            options.value = el.value;\r\n        }\r\n\r\n        // Calendar DOM elements\r\n        calendarReset = document.createElement('div');\r\n        calendarReset.className = 'jcalendar-reset';\r\n\r\n        calendarConfirm = document.createElement('div');\r\n        calendarConfirm.className = 'jcalendar-confirm';\r\n\r\n        calendarControls = document.createElement('div');\r\n        calendarControls.className = 'jcalendar-controls'\r\n        calendarControls.style.borderBottom = '1px solid #ddd';\r\n        calendarControls.appendChild(calendarReset);\r\n        calendarControls.appendChild(calendarConfirm);\r\n\r\n        calendarContainer = document.createElement('div');\r\n        calendarContainer.className = 'jcalendar-container';\r\n\r\n        calendarContent = document.createElement('div');\r\n        calendarContent.className = 'jcalendar-content';\r\n        calendarContainer.appendChild(calendarContent);\r\n\r\n        // Main element\r\n        if (el.tagName == 'DIV') {\r\n            calendar = el;\r\n            calendar.classList.add('jcalendar-inline');\r\n        } else {\r\n            // Add controls to the screen\r\n            calendarContent.appendChild(calendarControls);\r\n\r\n            calendar = document.createElement('div');\r\n            calendar.className = 'jcalendar';\r\n        }\r\n        calendar.classList.add('jcalendar-container');\r\n        calendar.appendChild(calendarContainer);\r\n\r\n        // Table container\r\n        var calendarTableContainer = document.createElement('div');\r\n        calendarTableContainer.className = 'jcalendar-table';\r\n        calendarContent.appendChild(calendarTableContainer);\r\n\r\n        // Previous button\r\n        var calendarHeaderPrev = document.createElement('td');\r\n        calendarHeaderPrev.setAttribute('colspan', '2');\r\n        calendarHeaderPrev.className = 'jcalendar-prev';\r\n\r\n        // Header with year and month\r\n        calendarLabelYear = document.createElement('span');\r\n        calendarLabelYear.className = 'jcalendar-year';\r\n        calendarLabelMonth = document.createElement('span');\r\n        calendarLabelMonth.className = 'jcalendar-month';\r\n\r\n        var calendarHeaderTitle = document.createElement('td');\r\n        calendarHeaderTitle.className = 'jcalendar-header';\r\n        calendarHeaderTitle.setAttribute('colspan', '3');\r\n        calendarHeaderTitle.appendChild(calendarLabelMonth);\r\n        calendarHeaderTitle.appendChild(calendarLabelYear);\r\n\r\n        var calendarHeaderNext = document.createElement('td');\r\n        calendarHeaderNext.setAttribute('colspan', '2');\r\n        calendarHeaderNext.className = 'jcalendar-next';\r\n\r\n        var calendarHeader = document.createElement('thead');\r\n        var calendarHeaderRow = document.createElement('tr');\r\n        calendarHeaderRow.appendChild(calendarHeaderPrev);\r\n        calendarHeaderRow.appendChild(calendarHeaderTitle);\r\n        calendarHeaderRow.appendChild(calendarHeaderNext);\r\n        calendarHeader.appendChild(calendarHeaderRow);\r\n\r\n        calendarTable = document.createElement('table');\r\n        calendarBody = document.createElement('tbody');\r\n        calendarTable.setAttribute('cellpadding', '0');\r\n        calendarTable.setAttribute('cellspacing', '0');\r\n        calendarTable.appendChild(calendarHeader);\r\n        calendarTable.appendChild(calendarBody);\r\n        calendarTableContainer.appendChild(calendarTable);\r\n\r\n        calendarSelectHour = document.createElement('select');\r\n        calendarSelectHour.className = 'jcalendar-select';\r\n        calendarSelectHour.onchange = function() {\r\n            obj.date[3] = this.value; \r\n\r\n            // Event\r\n            if (typeof(obj.options.onupdate) == 'function') {\r\n                obj.options.onupdate(el, obj.getValue());\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 24; i++) {\r\n            var element = document.createElement('option');\r\n            element.value = i;\r\n            element.innerHTML = jSuites.two(i);\r\n            calendarSelectHour.appendChild(element);\r\n        }\r\n\r\n        calendarSelectMin = document.createElement('select');\r\n        calendarSelectMin.className = 'jcalendar-select';\r\n        calendarSelectMin.onchange = function() {\r\n            obj.date[4] = this.value;\r\n\r\n            // Event\r\n            if (typeof(obj.options.onupdate) == 'function') {\r\n                obj.options.onupdate(el, obj.getValue());\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 60; i++) {\r\n            var element = document.createElement('option');\r\n            element.value = i;\r\n            element.innerHTML = jSuites.two(i);\r\n            calendarSelectMin.appendChild(element);\r\n        }\r\n\r\n        // Footer controls\r\n        var calendarControlsFooter = document.createElement('div');\r\n        calendarControlsFooter.className = 'jcalendar-controls';\r\n\r\n        calendarControlsTime = document.createElement('div');\r\n        calendarControlsTime.className = 'jcalendar-time';\r\n        calendarControlsTime.style.maxWidth = '140px';\r\n        calendarControlsTime.appendChild(calendarSelectHour);\r\n        calendarControlsTime.appendChild(calendarSelectMin);\r\n\r\n        calendarControlsUpdateButton = document.createElement('button');\r\n        calendarControlsUpdateButton.setAttribute('type', 'button');\r\n        calendarControlsUpdateButton.className = 'jcalendar-update';\r\n\r\n        calendarControlsUpdate = document.createElement('div');\r\n        calendarControlsUpdate.style.flexGrow = '10';\r\n        calendarControlsUpdate.appendChild(calendarControlsUpdateButton);\r\n        calendarControlsFooter.appendChild(calendarControlsTime);\r\n\r\n        // Only show the update button for input elements\r\n        if (el.tagName == 'INPUT') {\r\n            calendarControlsFooter.appendChild(calendarControlsUpdate);\r\n        }\r\n\r\n        calendarContent.appendChild(calendarControlsFooter);\r\n\r\n        var calendarBackdrop = document.createElement('div');\r\n        calendarBackdrop.className = 'jcalendar-backdrop';\r\n        calendar.appendChild(calendarBackdrop);\r\n\r\n        // Handle events\r\n        el.addEventListener(\"keyup\", keyUpControls);\r\n\r\n        // Add global events\r\n        calendar.addEventListener(\"swipeleft\", function(e) {\r\n            jSuites.animation.slideLeft(calendarTable, 0, function() {\r\n                obj.next();\r\n                jSuites.animation.slideRight(calendarTable, 1);\r\n            });\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n\r\n        calendar.addEventListener(\"swiperight\", function(e) {\r\n            jSuites.animation.slideRight(calendarTable, 0, function() {\r\n                obj.prev();\r\n                jSuites.animation.slideLeft(calendarTable, 1);\r\n            });\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n\r\n        el.onmouseup = function() {\r\n            obj.open();\r\n        }\r\n\r\n        if ('ontouchend' in document.documentElement === true) {\r\n            calendar.addEventListener(\"touchend\", mouseUpControls);\r\n        } else {\r\n            calendar.addEventListener(\"mouseup\", mouseUpControls);\r\n        }\r\n\r\n        // Global controls\r\n        if (! jSuites.calendar.hasEvents) {\r\n            // Execute only one time\r\n            jSuites.calendar.hasEvents = true;\r\n            // Enter and Esc\r\n            document.addEventListener(\"keydown\", jSuites.calendar.keydown);\r\n        }\r\n\r\n        // Set configuration\r\n        obj.setOptions(options);\r\n\r\n        // Append element to the DOM\r\n        if (el.tagName == 'INPUT') {\r\n            el.parentNode.insertBefore(calendar, el.nextSibling);\r\n            // Add properties\r\n            el.setAttribute('autocomplete', 'off');\r\n            // Element\r\n            el.classList.add('jcalendar-input');\r\n            // Value\r\n            el.value = obj.setLabel(obj.getValue(), obj.options);\r\n        } else {\r\n            // Get days\r\n            obj.getDays();\r\n            // Hour\r\n            if (obj.options.time) {\r\n                calendarSelectHour.value = obj.date[3];\r\n                calendarSelectMin.value = obj.date[4];\r\n            }\r\n        }\r\n\r\n        // Default opened\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n\r\n        // Change method\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.calendar = calendar.calendar = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.calendar.keydown = function(e) {\r\n    var calendar = null;\r\n    if (calendar = jSuites.calendar.current) { \r\n        if (e.which == 13) {\r\n            // ENTER\r\n            calendar.close(false, true);\r\n        } else if (e.which == 27) {\r\n            // ESC\r\n            calendar.close(false, false);\r\n        }\r\n    }\r\n}\r\n\r\njSuites.calendar.prettify = function(d, texts) {\r\n    if (! texts) {\r\n        var texts = {\r\n            justNow: 'Just now',\r\n            xMinutesAgo: '{0}m ago',\r\n            xHoursAgo: '{0}h ago',\r\n            xDaysAgo: '{0}d ago',\r\n            xWeeksAgo: '{0}w ago',\r\n            xMonthsAgo: '{0} mon ago',\r\n            xYearsAgo: '{0}y ago',\r\n        }\r\n    }\r\n\r\n    var d1 = new Date();\r\n    var d2 = new Date(d);\r\n    var total = parseInt((d1 - d2) / 1000 / 60);\r\n\r\n    String.prototype.format = function(o) {\r\n        return this.replace('{0}', o);\r\n    }\r\n\r\n    if (total == 0) {\r\n        var text = texts.justNow;\r\n    } else if (total < 90) {\r\n        var text = texts.xMinutesAgo.format(total);\r\n    } else if (total < 1440) { // One day\r\n        var text = texts.xHoursAgo.format(Math.round(total/60));\r\n    } else if (total < 20160) { // 14 days\r\n        var text = texts.xDaysAgo.format(Math.round(total / 1440));\r\n    } else if (total < 43200) { // 30 days\r\n        var text = texts.xWeeksAgo.format(Math.round(total / 10080));\r\n    } else if (total < 1036800) { // 24 months\r\n        var text = texts.xMonthsAgo.format(Math.round(total / 43200));\r\n    } else { // 24 months+\r\n        var text = texts.xYearsAgo.format(Math.round(total / 525600));\r\n    }\r\n\r\n    return text;\r\n}\r\n\r\njSuites.calendar.prettifyAll = function() {\r\n    var elements = document.querySelectorAll('.prettydate');\r\n    for (var i = 0; i < elements.length; i++) {\r\n        if (elements[i].getAttribute('data-date')) {\r\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].getAttribute('data-date'));\r\n        } else {\r\n            elements[i].setAttribute('data-date', elements[i].innerHTML);\r\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].innerHTML);\r\n        }\r\n    }\r\n}\r\n\r\njSuites.calendar.now = function(date, dateOnly) {\r\n    if (Array.isArray(date)) {\r\n        var y = date[0];\r\n        var m = date[1];\r\n        var d = date[2];\r\n        var h = date[3];\r\n        var i = date[4];\r\n        var s = date[5];\r\n    } else {\r\n        if (! date) {\r\n            var date = new Date();\r\n        }\r\n        var y = date.getFullYear();\r\n        var m = date.getMonth() + 1;\r\n        var d = date.getDate();\r\n        var h = date.getHours();\r\n        var i = date.getMinutes();\r\n        var s = date.getSeconds();\r\n    }\r\n\r\n    if (dateOnly == true) {\r\n        return jSuites.two(y) + '-' + jSuites.two(m) + '-' + jSuites.two(d);\r\n    } else {\r\n        return jSuites.two(y) + '-' + jSuites.two(m) + '-' + jSuites.two(d) + ' ' + jSuites.two(h) + ':' + jSuites.two(i) + ':' + jSuites.two(s);\r\n    }\r\n}\r\n\r\njSuites.calendar.toArray = function(value) {\r\n    var date = value.split(((value.indexOf('T') !== -1) ? 'T' : ' '));\r\n    var time = date[1];\r\n    var date = date[0].split('-');\r\n    var y = parseInt(date[0]);\r\n    var m = parseInt(date[1]);\r\n    var d = parseInt(date[2]);\r\n\r\n    if (time) {\r\n        var time = time.split(':');\r\n        var h = parseInt(time[0]);\r\n        var i = parseInt(time[1]);\r\n    } else {\r\n        var h = 0;\r\n        var i = 0;\r\n    }\r\n    return [ y, m, d, h, i, 0 ];\r\n}\r\n\r\n// Helper to extract date from a string\r\njSuites.calendar.extractDateFromString = function(date, format) {\r\n    if (date > 0 && Number(date) == date) {\r\n        var d = new Date(Math.round((date - 25569)*86400*1000));\r\n        return d.getFullYear() + \"-\" + jSuites.two(d.getMonth()) + \"-\" + jSuites.two(d.getDate()) + ' 00:00:00';\r\n    }\r\n\r\n    var v1 = '' + date;\r\n    var v2 = format.replace(/[0-9]/g,'');\r\n\r\n    var test = 1;\r\n\r\n    // Get year\r\n    var y = v2.search(\"YYYY\");\r\n    y = v1.substr(y,4);\r\n    if (parseInt(y) != y) {\r\n        test = 0;\r\n    }\r\n\r\n    // Get month\r\n    var m = v2.search(\"MM\");\r\n    m = v1.substr(m,2);\r\n    if (parseInt(m) != m || m > 12) {\r\n        test = 0;\r\n    }\r\n\r\n    // Get day\r\n    var d = v2.search(\"DD\");\r\n    if (d >= 0) {\r\n        d = v1.substr(d,2);\r\n        if (parseInt(d) != d  || d > 31) {\r\n            test = 0;\r\n        }\r\n    } else {\r\n        d = '01';\r\n    }\r\n\r\n    // Get hour\r\n    var h = v2.search(\"HH\");\r\n    if (h >= 0) {\r\n        h = v1.substr(h,2);\r\n        if (! parseInt(h) || h > 23) {\r\n            h = '00';\r\n        }\r\n    } else {\r\n        h = '00';\r\n    }\r\n\r\n    // Get minutes\r\n    var i = v2.search(\"MI\");\r\n    if (i >= 0) {\r\n        i = v1.substr(i,2);\r\n        if (! parseInt(i) || i > 59) {\r\n            i = '00';\r\n        }\r\n    } else {\r\n        i = '00';\r\n    }\r\n\r\n    // Get seconds\r\n    var s = v2.search(\"SS\");\r\n    if (s >= 0) {\r\n        s = v1.substr(s,2);\r\n        if (! parseInt(s) || s > 59) {\r\n            s = '00';\r\n        }\r\n    } else {\r\n        s = '00';\r\n    }\r\n\r\n    if (test == 1 && date.length == v2.length) {\r\n        // Update source\r\n        return y + '-' + m + '-' + d + ' ' + h + ':' +  i + ':' + s;\r\n    }\r\n\r\n    return '';\r\n}\r\n\r\n/**\r\n * Date to number\r\n */\r\njSuites.calendar.dateToNum = function(a, b) {\r\n    a = new Date(a);\r\n    if (! b) {\r\n        b = '1899-12-30 ' + a.getHours() + ':' + a.getMinutes() + ':' + a.getSeconds();\r\n    }\r\n    b = new Date(b);\r\n    var v = a.getTime() - b.getTime();\r\n    return Math.round(v / 86400000);\r\n}\r\n\r\n/**\r\n * Number to date\r\n */\r\njSuites.calendar.numToDate = function(value) {\r\n    var d = new Date(Math.round((value - 25569)*86400*1000));\r\n    return d.getFullYear() + \"-\" + jSuites.two(d.getMonth()+1) + \"-\" + jSuites.two(d.getDate()) + ' 00:00:00';\r\n}\r\n\r\n// Helper to convert date into string\r\njSuites.calendar.getDateString = function(value, options) {\r\n    if (! options) {\r\n        var options = {};\r\n    }\r\n\r\n    // Labels\r\n    if (options && typeof(options) == 'object') {\r\n        var format = options.format;\r\n    } else {\r\n        var format = options;\r\n    }\r\n\r\n    if (! format) {\r\n        format = 'YYYY-MM-DD';\r\n    }\r\n\r\n    // Convert to number of hours\r\n    if (typeof(value) == 'number' && format.indexOf('[h]') >= 0) {\r\n        var result = parseFloat(24 * Number(value));\r\n        if (format.indexOf('mm') >= 0) {\r\n            var h = (''+result).split('.');\r\n            if (h[1]) {\r\n                var d = 60 * parseFloat('0.' + h[1])\r\n                d = parseFloat(d.toFixed(2));\r\n            } else {\r\n                var d = 0;\r\n            }\r\n            result = parseInt(h[0]) + ':' + jSuites.two(d);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // Date instance\r\n    if (value instanceof Date) {\r\n        value = jSuites.calendar.now(value);\r\n    } else if (value && jSuites.isNumeric(value)) {\r\n        value = jSuites.calendar.numToDate(value);\r\n    }\r\n\r\n    // Tokens\r\n    var tokens = [ 'DAY', 'WD', 'DDDD', 'DDD', 'DD', 'D', 'Q', 'HH24', 'HH12', 'HH', 'H', 'AM/PM', 'MI', 'SS', 'MS', 'YYYY', 'YYY', 'YY', 'Y', 'MONTH', 'MON', 'MMMMM', 'MMMM', 'MMM', 'MM', 'M', '.' ];\r\n\r\n    // Expression to extract all tokens from the string\r\n    var e = new RegExp(tokens.join('|'), 'gi');\r\n    // Extract\r\n    var t = format.match(e);\r\n\r\n    // Compatibility with excel\r\n    for (var i = 0; i < t.length; i++) {\r\n        if (t[i].toUpperCase() == 'MM') {\r\n            // Not a month, correct to minutes\r\n            if (t[i-1] && t[i-1].toUpperCase().indexOf('H') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i-2] && t[i-2].toUpperCase().indexOf('H') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i+1] && t[i+1].toUpperCase().indexOf('S') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i+2] && t[i+2].toUpperCase().indexOf('S') >= 0) {\r\n                t[i] = 'mi';\r\n            }\r\n        }\r\n    }\r\n\r\n    // Object\r\n    var o = {\r\n        tokens: t\r\n    }\r\n\r\n    // Value\r\n    if (value) {\r\n        var d = ''+value;\r\n        var splitStr = (d.indexOf('T') !== -1) ? 'T' : ' ';\r\n        d = d.split(splitStr);\r\n \r\n        var h = 0;\r\n        var m = 0;\r\n        var s = 0;\r\n\r\n        if (d[1]) {\r\n            h = d[1].split(':');\r\n            m = h[1] ? h[1] : 0;\r\n            s = h[2] ? h[2] : 0;\r\n            h = h[0] ? h[0] : 0;\r\n        }\r\n\r\n        d = d[0].split('-');\r\n\r\n        if (d[0] && d[1] && d[2] && d[0] > 0 && d[1] > 0 && d[1] < 13 && d[2] > 0 && d[2] < 32) {\r\n\r\n            // Data\r\n            o.data = [ d[0], d[1], d[2], h, m, s ];\r\n\r\n            // Value\r\n            o.value = [];\r\n\r\n            // Calendar instance\r\n            var calendar = new Date(o.data[0], o.data[1]-1, o.data[2], o.data[3], o.data[4], o.data[5]);\r\n\r\n            // Get method\r\n            var get = function(i) {\r\n                // Token\r\n                var t = this.tokens[i];\r\n                // Case token\r\n                var s = t.toUpperCase();\r\n                var v = null;\r\n\r\n                if (s === 'YYYY') {\r\n                    v = this.data[0];\r\n                } else if (s === 'YYY') {\r\n                    v = this.data[0].substring(1,4);\r\n                } else if (s === 'YY') {\r\n                    v = this.data[0].substring(2,4);\r\n                } else if (s === 'Y') {\r\n                    v = this.data[0].substring(3,4);\r\n                } else if (t === 'MON') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3).toUpperCase();\r\n                } else if (t === 'mon') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3).toLowerCase();\r\n                } else if (t === 'MONTH') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].toUpperCase();\r\n                } else if (t === 'month') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].toLowerCase();\r\n                } else if (s === 'MMMMM') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0, 1);\r\n                } else if (s === 'MMMM' || t === 'Month') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()];\r\n                } else if (s === 'MMM' || t == 'Mon') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3);\r\n                } else if (s === 'MM') {\r\n                    v = jSuites.two(this.data[1]);\r\n                } else if (s === 'M') {\r\n                    v = calendar.getMonth()+1;\r\n                } else if (t === 'DAY') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].toUpperCase();\r\n                } else if (t === 'day') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].toLowerCase();\r\n                } else if (s === 'DDDD' || t == 'Day') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()];\r\n                } else if (s === 'DDD') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].substr(0,3);\r\n                } else if (s === 'DD') {\r\n                    v = jSuites.two(this.data[2]);\r\n                } else if (s === 'D') {\r\n                    v = this.data[2];\r\n                } else if (s === 'Q') {\r\n                    v = Math.floor((calendar.getMonth() + 3) / 3);\r\n                } else if (s === 'HH24' || s === 'HH') {\r\n                    v = jSuites.two(this.data[3]);\r\n                } else if (s === 'HH12') {\r\n                    if (this.data[3] > 12) {\r\n                        v = jSuites.two(this.data[3] - 12);\r\n                    } else {\r\n                        v = jSuites.two(this.data[3]);\r\n                    }\r\n                } else if (s === 'H') {\r\n                    v = this.data[3];\r\n                } else if (s === 'MI') {\r\n                    v = jSuites.two(this.data[4]);\r\n                } else if (s === 'SS') {\r\n                    v = jSuites.two(this.data[5]);\r\n                } else if (s === 'MS') {\r\n                    v = calendar.getMilliseconds();\r\n                } else if (s === 'AM/PM') {\r\n                    if (this.data[3] >= 12) {\r\n                        v = 'PM';\r\n                    } else {\r\n                        v = 'AM';\r\n                    }\r\n                } else if (s === 'WD') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()];\r\n                }\r\n\r\n                if (v === null) {\r\n                    this.value[i] = this.tokens[i];\r\n                } else {\r\n                    this.value[i] = v;\r\n                }\r\n            }\r\n\r\n            for (var i = 0; i < o.tokens.length; i++) {\r\n                get.call(o, i);\r\n            }\r\n            // Put pieces together\r\n            value = o.value.join('');\r\n        } else {\r\n            value = '';\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n// Jsuites calendar labels\r\njSuites.calendar.weekdays = [ 'Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday' ];\r\njSuites.calendar.months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\r\njSuites.calendar.weekdaysShort = [ 'Sun','Mon','Tue','Wed','Thu','Fri','Sat' ];\r\njSuites.calendar.monthsShort = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n\r\n\r\njSuites.color = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.color) {\r\n        return el.color.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'color' };\r\n    obj.options = {};\r\n\r\n    var container = null;\r\n    var backdrop = null;\r\n    var content = null;\r\n    var resetButton = null;\r\n    var closeButton = null;\r\n    var tabs = null;\r\n    var jsuitesTabs = null;\r\n\r\n    /**\r\n     * Update options\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        /**\r\n         * @typedef {Object} defaults\r\n         * @property {(string|Array)} value - Initial value of the compontent\r\n         * @property {string} placeholder - The default instruction text on the element\r\n         * @property {requestCallback} onchange - Method to be execute after any changes on the element\r\n         * @property {requestCallback} onclose - Method to be execute when the element is closed\r\n         * @property {string} doneLabel - Label for button done\r\n         * @property {string} resetLabel - Label for button reset\r\n         * @property {string} resetValue - Value for button reset\r\n         * @property {Bool} showResetButton - Active or note for button reset - default false\r\n         */\r\n        var defaults = {\r\n            placeholder: '',\r\n            value: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onchange: null,\r\n            closeOnChange: true,\r\n            palette: null,\r\n            position: null,\r\n            doneLabel: 'Done',\r\n            resetLabel: 'Reset',\r\n            fullscreen: false,\r\n            opened: false,\r\n        }\r\n\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        if (options && ! options.palette) {\r\n            // Default pallete\r\n            options.palette = jSuites.palette();\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Update the text of the controls, if they have already been created\r\n        if (resetButton) {\r\n            resetButton.innerHTML = obj.options.resetLabel;\r\n        }\r\n        if (closeButton) {\r\n            closeButton.innerHTML = obj.options.doneLabel;\r\n        }\r\n\r\n        // Update the pallete\r\n        if (obj.options.palette && jsuitesTabs) {\r\n            jsuitesTabs.updateContent(0, table());\r\n        }\r\n\r\n        // Value\r\n        if (typeof obj.options.value === 'string') {\r\n            el.value = obj.options.value;\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            if (el.getAttribute('placeholder')) {\r\n                el.removeAttribute('placeholder');\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Open color pallete\r\n     */\r\n    obj.open = function() {\r\n        if (! container.classList.contains('jcolor-focus')) {\r\n            // Start tracking\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Show colorpicker\r\n            container.classList.add('jcolor-focus');\r\n\r\n            var rectContent = content.getBoundingClientRect();\r\n\r\n            if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen == true) {\r\n                content.style.top = '';\r\n                content.classList.add('jcolor-fullscreen');\r\n                jSuites.animation.slideBottom(content, 1);\r\n                backdrop.style.display = 'block';\r\n            } else {\r\n                if (content.classList.contains('jcolor-fullscreen')) {\r\n                    content.classList.remove('jcolor-fullscreen');\r\n                    backdrop.style.display = '';\r\n                }\r\n\r\n                var rect = el.getBoundingClientRect();\r\n\r\n                if (obj.options.position) {\r\n                    content.style.position = 'fixed';\r\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                        content.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                    } else {\r\n                        content.style.top = (rect.top + rect.height + 2) + 'px';\r\n                    }\r\n                    content.style.left = rect.left + 'px';\r\n                } else {\r\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                        content.style.top = -1 * (rectContent.height + rect.height + 2) + 'px';\r\n                    } else {\r\n                        content.style.top = '2px';\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (typeof(obj.options.onopen) == 'function') {\r\n                obj.options.onopen(el);\r\n            }\r\n\r\n            jsuitesTabs.setBorder(jsuitesTabs.getActive());\r\n\r\n            // Update sliders\r\n            if (obj.options.value) {\r\n                var rgb = HexToRgb(obj.options.value);\r\n\r\n                rgbInputs.forEach(function(rgbInput, index) {\r\n                    rgbInput.value = rgb[index];\r\n                    rgbInput.dispatchEvent(new Event('input'));\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Close color pallete\r\n     */\r\n    obj.close = function(ignoreEvents) {\r\n        if (container.classList.contains('jcolor-focus')) {\r\n            // Remove focus\r\n            container.classList.remove('jcolor-focus');\r\n            // Make sure backdrop is hidden\r\n            backdrop.style.display = '';\r\n            // Call related events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Stop  the object\r\n            jSuites.tracking(obj, false);\r\n        }\r\n\r\n        return obj.options.value;\r\n    }\r\n\r\n    /**\r\n     * Set value\r\n     */\r\n    obj.setValue = function(color) {\r\n        if (! color) {\r\n            color = '';\r\n        }\r\n\r\n        if (color != obj.options.value) {\r\n            obj.options.value = color;\r\n            slidersResult = color;\r\n\r\n            // Remove current selecded mark\r\n            var selected = container.querySelector('.jcolor-selected');\r\n            if (selected) {\r\n                selected.classList.remove('jcolor-selected');\r\n            }\r\n\r\n            // Mark cell as selected\r\n            if (obj.values[color]) {\r\n                obj.values[color].classList.add('jcolor-selected');\r\n            }\r\n\r\n            // Onchange\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, color);\r\n            }\r\n\r\n            // Changes\r\n            if (el.value != obj.options.value) {\r\n                // Set input value\r\n                el.value = obj.options.value;\r\n                // Element onchange native\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (obj.options.closeOnChange == true) {\r\n                obj.close();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get value\r\n     */\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var backdropClickControl = false;\r\n\r\n    // Converts a number in decimal to hexadecimal\r\n    var decToHex = function(num) {\r\n        var hex = num.toString(16);\r\n        return hex.length === 1 ? \"0\" + hex : hex;\r\n    }\r\n\r\n    // Converts a color in rgb to hexadecimal\r\n    var rgbToHex = function(r, g, b) {\r\n        return \"#\" + decToHex(r) + decToHex(g) + decToHex(b);\r\n    }\r\n\r\n    // Converts a number in hexadecimal to decimal\r\n    var hexToDec = function(hex) {\r\n        return parseInt('0x' + hex);\r\n    }\r\n\r\n    // Converts a color in hexadecimal to rgb\r\n    var HexToRgb = function(hex) {\r\n        return [hexToDec(hex.substr(1, 2)), hexToDec(hex.substr(3, 2)), hexToDec(hex.substr(5, 2))]\r\n    }\r\n\r\n    var table = function() {\r\n        // Content of the first tab\r\n        var tableContainer = document.createElement('div');\r\n        tableContainer.className = 'jcolor-grid';\r\n\r\n        // Cells\r\n        obj.values = [];\r\n\r\n        // Table pallete\r\n        var t = document.createElement('table');\r\n        t.setAttribute('cellpadding', '7');\r\n        t.setAttribute('cellspacing', '0');\r\n\r\n        for (var j = 0; j < obj.options.palette.length; j++) {\r\n            var tr = document.createElement('tr');\r\n            for (var i = 0; i < obj.options.palette[j].length; i++) {\r\n                var td = document.createElement('td');\r\n                var color = obj.options.palette[j][i];\r\n                if (color.length < 7 && color.substr(0,1) !== '#') {\r\n                    color = '#' + color;\r\n                }\r\n                td.style.backgroundColor = color;\r\n                td.setAttribute('data-value', color);\r\n                td.innerHTML = '';\r\n                tr.appendChild(td);\r\n\r\n                // Selected color\r\n                if (obj.options.value == color) {\r\n                    td.classList.add('jcolor-selected');\r\n                }\r\n\r\n                // Possible values\r\n                obj.values[color] = td;\r\n            }\r\n            t.appendChild(tr);\r\n        }\r\n\r\n        // Append to the table\r\n        tableContainer.appendChild(t);\r\n\r\n        // Select color\r\n        tableContainer.addEventListener(\"mousedown\", function(e) {\r\n            if (e.target.tagName == 'TD') {\r\n                var value = e.target.getAttribute('data-value');\r\n                if (value) {\r\n                    obj.setValue(value);\r\n                }\r\n            }\r\n        });\r\n\r\n        return tableContainer;\r\n    }\r\n\r\n    // Canvas where the image will be rendered\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = 200;\r\n    canvas.height = 160;\r\n    var context = canvas.getContext(\"2d\");\r\n\r\n    var resizeCanvas = function() {\r\n        // Specifications necessary to correctly obtain colors later in certain positions\r\n        var m = tabs.firstChild.getBoundingClientRect();\r\n        canvas.width = m.width - 14;\r\n        gradient()\r\n    }\r\n\r\n    var gradient = function() {\r\n        var g = context.createLinearGradient(0, 0, canvas.width, 0);\r\n        // Create color gradient\r\n        g.addColorStop(0,    \"rgb(255,0,0)\");\r\n        g.addColorStop(0.15, \"rgb(255,0,255)\");\r\n        g.addColorStop(0.33, \"rgb(0,0,255)\");\r\n        g.addColorStop(0.49, \"rgb(0,255,255)\");\r\n        g.addColorStop(0.67, \"rgb(0,255,0)\");\r\n        g.addColorStop(0.84, \"rgb(255,255,0)\");\r\n        g.addColorStop(1,    \"rgb(255,0,0)\");\r\n        context.fillStyle = g;\r\n        context.fillRect(0, 0, canvas.width, canvas.height);\r\n        g = context.createLinearGradient(0, 0, 0, canvas.height);\r\n        g.addColorStop(0,   \"rgba(255,255,255,1)\");\r\n        g.addColorStop(0.5, \"rgba(255,255,255,0)\");\r\n        g.addColorStop(0.5, \"rgba(0,0,0,0)\");\r\n        g.addColorStop(1,   \"rgba(0,0,0,1)\");\r\n        context.fillStyle = g;\r\n        context.fillRect(0, 0, canvas.width, canvas.height);\r\n    }\r\n\r\n    var hsl = function() {\r\n        var element = document.createElement('div');\r\n        element.className = \"jcolor-hsl\";\r\n\r\n        var point = document.createElement('div');\r\n        point.className = 'jcolor-point';\r\n\r\n        var div = document.createElement('div');\r\n        div.appendChild(canvas);\r\n        div.appendChild(point);\r\n        element.appendChild(div);\r\n\r\n        // Moves the marquee point to the specified position\r\n        var update = function(buttons, x, y) {\r\n            if (buttons === 1) {\r\n                var rect = element.getBoundingClientRect();\r\n                var left = x - rect.left;\r\n                var top = y - rect.top;\r\n                if (left < 0) {\r\n                    left = 0;\r\n                }\r\n                if (top < 0) {\r\n                    top = 0;\r\n                }\r\n                if (left > rect.width) {\r\n                    left = rect.width;\r\n                }\r\n                if (top > rect.height) {\r\n                    top = rect.height;\r\n                }\r\n                point.style.left = left + 'px';\r\n                point.style.top = top + 'px';\r\n                var pixel = context.getImageData(left, top, 1, 1).data;\r\n                slidersResult = rgbToHex(pixel[0], pixel[1], pixel[2]);\r\n            }\r\n        }\r\n\r\n        // Applies the point's motion function to the div that contains it\r\n        element.addEventListener('mousedown', function(e) {\r\n            update(e.buttons, e.clientX, e.clientY);\r\n        });\r\n\r\n        element.addEventListener('mousemove', function(e) {\r\n            update(e.buttons, e.clientX, e.clientY);\r\n        });\r\n\r\n        element.addEventListener('touchmove', function(e) {\r\n            update(1, e.changedTouches[0].clientX, e.changedTouches[0].clientY);\r\n        });\r\n\r\n        return element;\r\n    }\r\n\r\n    var slidersResult = '';\r\n\r\n    var rgbInputs = [];\r\n\r\n    var changeInputColors = function() {\r\n        if (slidersResult !== '') {\r\n            for (var j = 0; j < rgbInputs.length; j++) {\r\n                var currentColor = HexToRgb(slidersResult);\r\n\r\n                currentColor[j] = 0;\r\n\r\n                var newGradient = 'linear-gradient(90deg, rgb(';\r\n                newGradient += currentColor.join(', ');\r\n                newGradient += '), rgb(';\r\n\r\n                currentColor[j] = 255;\r\n\r\n                newGradient += currentColor.join(', ');\r\n                newGradient += '))';\r\n\r\n                rgbInputs[j].style.backgroundImage = newGradient;\r\n            }\r\n        }\r\n    }\r\n\r\n    var sliders = function() {\r\n        // Content of the third tab\r\n        var slidersElement = document.createElement('div');\r\n        slidersElement.className = 'jcolor-sliders';\r\n\r\n        var slidersBody = document.createElement('div');\r\n\r\n        // Creates a range-type input with the specified name\r\n        var createSliderInput = function(name) {\r\n            var inputContainer = document.createElement('div');\r\n            inputContainer.className = 'jcolor-sliders-input-container';\r\n\r\n            var label = document.createElement('label');\r\n            label.innerText = name;\r\n\r\n            var subContainer = document.createElement('div');\r\n            subContainer.className = 'jcolor-sliders-input-subcontainer';\r\n\r\n            var input = document.createElement('input');\r\n            input.type = 'range';\r\n            input.min = 0;\r\n            input.max = 255;\r\n            input.value = 0;\r\n\r\n            inputContainer.appendChild(label);\r\n            subContainer.appendChild(input);\r\n\r\n            var value = document.createElement('div');\r\n            value.innerText = input.value;\r\n\r\n            input.addEventListener('input', function() {\r\n                value.innerText = input.value;\r\n            });\r\n\r\n            subContainer.appendChild(value);\r\n            inputContainer.appendChild(subContainer);\r\n\r\n            slidersBody.appendChild(inputContainer);\r\n\r\n            return input;\r\n        }\r\n\r\n        // Creates red, green and blue inputs\r\n        rgbInputs = [\r\n            createSliderInput('Red'),\r\n            createSliderInput('Green'),\r\n            createSliderInput('Blue'),\r\n        ];\r\n\r\n        slidersElement.appendChild(slidersBody);\r\n\r\n        // Element that prints the current color\r\n        var slidersResultColor = document.createElement('div');\r\n        slidersResultColor.className = 'jcolor-sliders-final-color';\r\n\r\n        var resultElement = document.createElement('div');\r\n        resultElement.style.visibility = 'hidden';\r\n        resultElement.innerText = 'a';\r\n        slidersResultColor.appendChild(resultElement)\r\n\r\n        // Update the element that prints the current color\r\n        var updateResult = function() {\r\n            var resultColor = rgbToHex(parseInt(rgbInputs[0].value), parseInt(rgbInputs[1].value), parseInt(rgbInputs[2].value));\r\n\r\n            resultElement.innerText = resultColor;\r\n            resultElement.style.color = resultColor;\r\n            resultElement.style.removeProperty('visibility');\r\n\r\n            slidersResult = resultColor;\r\n        }\r\n\r\n        // Apply the update function to color inputs\r\n        rgbInputs.forEach(function(rgbInput) {\r\n            rgbInput.addEventListener('input', function() {\r\n                updateResult();\r\n                changeInputColors();\r\n            });\r\n        });\r\n\r\n        slidersElement.appendChild(slidersResultColor);\r\n\r\n        return slidersElement;\r\n    }\r\n\r\n    var init = function() {\r\n        // Initial options\r\n        obj.setOptions(options);\r\n\r\n        // Add a proper input tag when the element is an input\r\n        if (el.tagName == 'INPUT') {\r\n            el.classList.add('jcolor-input');\r\n            el.readOnly = true;\r\n        }\r\n\r\n        // Table container\r\n        container = document.createElement('div');\r\n        container.className = 'jcolor';\r\n\r\n        // Table container\r\n        backdrop = document.createElement('div');\r\n        backdrop.className = 'jcolor-backdrop';\r\n        container.appendChild(backdrop);\r\n\r\n        // Content\r\n        content = document.createElement('div');\r\n        content.className = 'jcolor-content';\r\n\r\n        // Controls\r\n        var controls = document.createElement('div');\r\n        controls.className = 'jcolor-controls';\r\n        content.appendChild(controls);\r\n\r\n        // Reset button\r\n        resetButton  = document.createElement('div');\r\n        resetButton.className = 'jcolor-reset';\r\n        resetButton.innerHTML = obj.options.resetLabel;\r\n        resetButton.onclick = function(e) {\r\n            obj.setValue('');\r\n            obj.close();\r\n        }\r\n        controls.appendChild(resetButton);\r\n\r\n        // Close button\r\n        closeButton  = document.createElement('div');\r\n        closeButton.className = 'jcolor-close';\r\n        closeButton.innerHTML = obj.options.doneLabel;\r\n        closeButton.onclick = function(e) {\r\n            if (jsuitesTabs.getActive() > 0) {\r\n                obj.setValue(slidersResult);\r\n            }\r\n            obj.close();\r\n        }\r\n        controls.appendChild(closeButton);\r\n\r\n        // Element that will be used to create the tabs\r\n        tabs = document.createElement('div');\r\n        content.appendChild(tabs);\r\n\r\n        // Starts the jSuites tabs component\r\n        jsuitesTabs = jSuites.tabs(tabs, {\r\n            animation: true,\r\n            data: [\r\n                {\r\n                    title: 'Grid',\r\n                    contentElement: table(),\r\n                },\r\n                {\r\n                    title: 'Spectrum',\r\n                    contentElement: hsl(),\r\n                },\r\n                {\r\n                    title: 'Sliders',\r\n                    contentElement: sliders(),\r\n                }\r\n            ],\r\n            onchange: function(element, instance, index) {\r\n                if (index === 1) {\r\n                    resizeCanvas();\r\n                } else {\r\n                    var color = slidersResult !== '' ? slidersResult : obj.getValue();\r\n\r\n                    if (index === 2 && color) {\r\n                        var rgb = HexToRgb(color);\r\n\r\n                        rgbInputs.forEach(function(rgbInput, index) {\r\n                            rgbInput.value = rgb[index];\r\n                            rgbInput.dispatchEvent(new Event('input'));\r\n                        });\r\n                    }\r\n                }\r\n            },\r\n            palette: 'modern',\r\n        });\r\n\r\n        container.appendChild(content);\r\n\r\n        // Insert picker after the element\r\n        if (el.tagName == 'INPUT') {\r\n            el.parentNode.insertBefore(container, el.nextSibling);\r\n        } else {\r\n            el.appendChild(container);\r\n        }\r\n\r\n        /**\r\n         * If element is focus open the picker\r\n         */\r\n        el.addEventListener(\"mouseup\", function(e) {\r\n            obj.open();\r\n        });\r\n\r\n        backdrop.addEventListener(\"mousedown\", function(e) {\r\n            backdropClickControl = true;\r\n        });\r\n\r\n        backdrop.addEventListener(\"mouseup\", function(e) {\r\n            if (backdropClickControl) {\r\n                obj.close();\r\n                backdropClickControl = false;\r\n            }\r\n        });\r\n\r\n        // If the picker is open on the spectrum tab, it changes the canvas size when the window size is changed\r\n        window.addEventListener('resize', function() {\r\n            if (container.classList.contains('jcolor-focus') && jsuitesTabs.getActive() == 1) {\r\n                resizeCanvas();\r\n            }\r\n        });\r\n\r\n        // Default opened\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.color = obj;\r\n\r\n        // Container shortcut\r\n        container.color = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n\r\njSuites.contextmenu = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        items: null,\r\n        onclick: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class definition\r\n    el.classList.add('jcontextmenu');\r\n    // Focusable\r\n    el.setAttribute('tabindex', '900');\r\n\r\n    /**\r\n     * Open contextmenu\r\n     */\r\n    obj.open = function(e, items) {\r\n        if (items) {\r\n            // Update content\r\n            obj.options.items = items;\r\n            // Create items\r\n            obj.create(items);\r\n        }\r\n\r\n        // Coordinates\r\n        if ((obj.options.items && obj.options.items.length > 0) || el.children.length) {\r\n            if (e.target) {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            } else {\r\n                var x = e.x;\r\n                var y = e.y;\r\n            }\r\n\r\n            el.classList.add('jcontextmenu-focus');\r\n            el.focus();\r\n\r\n            var rect = el.getBoundingClientRect();\r\n\r\n            if (window.innerHeight < y + rect.height) {\r\n                var h = y - rect.height;\r\n                if (h < 0) {\r\n                    h = 0;\r\n                }\r\n                el.style.top = h + 'px';\r\n            } else {\r\n                el.style.top = y + 'px';\r\n            }\r\n\r\n            if (window.innerWidth < x + rect.width) {\r\n                if (x - rect.width > 0) {\r\n                    el.style.left = (x - rect.width) + 'px';\r\n                } else {\r\n                    el.style.left = '10px';\r\n                }\r\n            } else {\r\n                el.style.left = x + 'px';\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Close menu\r\n     */\r\n    obj.close = function() {\r\n        if (el.classList.contains('jcontextmenu-focus')) {\r\n            el.classList.remove('jcontextmenu-focus');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create items based on the declared objectd\r\n     * @param {object} items - List of object\r\n     */\r\n    obj.create = function(items) {\r\n        // Update content\r\n        el.innerHTML = '';\r\n\r\n        // Append items\r\n        for (var i = 0; i < items.length; i++) {\r\n            var itemContainer = createItemElement(items[i]);\r\n            el.appendChild(itemContainer);\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Private function for create a new Item element\r\n     * @param {type} item\r\n     * @returns {jsuitesL#15.jSuites.contextmenu.createItemElement.itemContainer}\r\n     */\r\n    function createItemElement(item) {\r\n        if (item.type && (item.type == 'line' || item.type == 'divisor')) {\r\n            var itemContainer = document.createElement('hr');\r\n        } else {\r\n            var itemContainer = document.createElement('div');\r\n            var itemText = document.createElement('a');\r\n            itemText.innerHTML = item.title;\r\n\r\n            if (item.tooltip) {\r\n                itemContainer.setAttribute('title', item.tooltip);\r\n            }\r\n\r\n            if (item.icon) {\r\n                itemContainer.setAttribute('data-icon', item.icon);\r\n            }\r\n\r\n            if (item.id) {\r\n                itemContainer.id = item.id;\r\n            }\r\n\r\n            if (item.disabled) {\r\n                itemContainer.className = 'jcontextmenu-disabled';\r\n            } else if (item.onclick) {\r\n                itemContainer.method = item.onclick;\r\n                itemContainer.addEventListener(\"mousedown\", function(e) {\r\n                    e.preventDefault();\r\n                });\r\n                itemContainer.addEventListener(\"mouseup\", function() {\r\n                    // Execute method\r\n                    this.method(this);\r\n                });\r\n            }\r\n            itemContainer.appendChild(itemText);\r\n\r\n            if (item.submenu) {\r\n                var itemIconSubmenu = document.createElement('span');\r\n                itemIconSubmenu.innerHTML = \"&#9658;\";\r\n                itemContainer.appendChild(itemIconSubmenu);\r\n                itemContainer.classList.add('jcontexthassubmenu');\r\n                var el_submenu = document.createElement('div');\r\n                // Class definition\r\n                el_submenu.classList.add('jcontextmenu');\r\n                // Focusable\r\n                el_submenu.setAttribute('tabindex', '900');\r\n                \r\n                // Append items\r\n                var submenu = item.submenu;\r\n                for (var i = 0; i < submenu.length; i++) {\r\n                    var itemContainerSubMenu = createItemElement(submenu[i]);\r\n                    el_submenu.appendChild(itemContainerSubMenu);\r\n                }\r\n\r\n                itemContainer.appendChild(el_submenu);\r\n            } else if (item.shortcut) {\r\n                var itemShortCut = document.createElement('span');\r\n                itemShortCut.innerHTML = item.shortcut;\r\n                itemContainer.appendChild(itemShortCut);\r\n            }\r\n        }\r\n        return itemContainer;\r\n    }\r\n\r\n    if (typeof(obj.options.onclick) == 'function') {\r\n        el.addEventListener('click', function(e) {\r\n            obj.options.onclick(obj, e);\r\n        });\r\n    }\r\n\r\n    // Create items\r\n    if (obj.options.items) {\r\n        obj.create(obj.options.items);\r\n    }\r\n\r\n    el.addEventListener('blur', function(e) {\r\n        obj.close();\r\n    });\r\n\r\n    if (! jSuites.contextmenu.hasEvents) {\r\n        window.addEventListener(\"mousewheel\", function() {\r\n            obj.close();\r\n        });\r\n\r\n        document.addEventListener(\"contextmenu\", function(e) {\r\n            var id = jSuites.contextmenu.getElement(e.target);\r\n            if (id) {\r\n                var element = document.querySelector('#' + id);\r\n                if (! element) {\r\n                    console.error('JSUITES: Contextmenu id not found');\r\n                } else {\r\n                    element.contextmenu.open(e);\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        });\r\n\r\n        jSuites.contextmenu.hasEvents = true;\r\n    }\r\n\r\n    el.contextmenu = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.contextmenu.getElement = function(element) {\r\n    var foundId = 0;\r\n\r\n    function path (element) {\r\n        if (element.parentNode && element.getAttribute('aria-contextmenu-id')) {\r\n            foundId = element.getAttribute('aria-contextmenu-id')\r\n        } else {\r\n            if (element.parentNode) {\r\n                path(element.parentNode);\r\n            }\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return foundId;\r\n}\r\n\r\njSuites.dropdown = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.dropdown) {\r\n        return el.dropdown.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'dropdown' };\r\n    obj.options = {};\r\n\r\n    // Success\r\n    var success = function(data, val) {\r\n        // Set data\r\n        if (data && data.length) {\r\n            // Sort\r\n            if (obj.options.sortResults !== false) {\r\n                if(typeof obj.options.sortResults == \"function\") {\r\n                    data.sort(obj.options.sortResults);\r\n                } else {\r\n                    data.sort(sortData);\r\n                }\r\n            }\r\n\r\n            obj.setData(data);\r\n\r\n            // Onload method\r\n            if (typeof(obj.options.onload) == 'function') {\r\n                obj.options.onload(el, obj, data, val);\r\n            }\r\n        }\r\n\r\n        // Set value\r\n        if (val) {\r\n            applyValue(val);\r\n        }\r\n\r\n        // Component value\r\n        if (val === undefined || val === null) {\r\n            obj.options.value = '';\r\n        }\r\n        el.value = obj.options.value;\r\n\r\n        // Open dropdown\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    \r\n    // Default sort\r\n    var sortData = function(itemA, itemB) {\r\n        var testA, testB;\r\n        if(typeof itemA == \"string\") {\r\n            testA = itemA;\r\n        } else {\r\n            if(itemA.text) {\r\n                testA = itemA.text;\r\n            } else if(itemA.name) {\r\n                testA = itemA.name;\r\n            }\r\n        }\r\n        \r\n        if(typeof itemB == \"string\") {\r\n            testB = itemB;\r\n        } else {\r\n            if(itemB.text) {\r\n                testB = itemB.text;\r\n            } else if(itemB.name) {\r\n                testB = itemB.name;\r\n            }\r\n        }\r\n        \r\n        if(typeof testA == \"string\" || typeof testB == \"string\") {\r\n            if(typeof testA != \"string\") { testA = \"\"+testA; }\r\n            if(typeof testB != \"string\") { testB = \"\"+testB; }\r\n            return testA.localeCompare(testB);\r\n        } else {\r\n            return testA - testB;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reset the options for the dropdown\r\n     */\r\n    var resetValue = function() {\r\n        // Reset value container\r\n        obj.value = {};\r\n        // Remove selected\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (obj.items[i].selected == true) {\r\n                if (obj.items[i].element) {\r\n                    obj.items[i].element.classList.remove('jdropdown-selected')\r\n                }\r\n                obj.items[i].selected = null;\r\n            }\r\n        }\r\n        // Reset options\r\n        obj.options.value = '';\r\n    }\r\n\r\n    /**\r\n     * Apply values to the dropdown\r\n     */\r\n    var applyValue = function(values) {\r\n        // Reset the current values\r\n        resetValue();\r\n\r\n        // Read values\r\n        if (values !== null) {\r\n            if (! values) {\r\n                if (typeof(obj.value['']) !== 'undefined') {\r\n                    obj.value[''] = '';\r\n                }\r\n            } else {\r\n                if (! Array.isArray(values)) {\r\n                    values = ('' + values).split(';');\r\n                }\r\n                for (var i = 0; i < values.length; i++) {\r\n                    obj.value[values[i]] = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Update the DOM\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (typeof(obj.value[Value(i)]) !== 'undefined') {\r\n                if (obj.items[i].element) {\r\n                    obj.items[i].element.classList.add('jdropdown-selected')\r\n                }\r\n                obj.items[i].selected = true;\r\n\r\n                // Keep label\r\n                obj.value[Value(i)] = Text(i);\r\n            }\r\n        }\r\n\r\n        // Global value\r\n        obj.options.value = Object.keys(obj.value).join(';');\r\n\r\n        // Update labels\r\n        obj.header.value = obj.getText();\r\n    }\r\n\r\n    // Get the value of one item\r\n    var Value = function(k, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'value';\r\n        } else {\r\n            var property = 'id';\r\n        }\r\n\r\n        if (obj.items[k]) {\r\n            if (v !== undefined) {\r\n                return obj.items[k].data[property] = v;\r\n            } else {\r\n                return obj.items[k].data[property];\r\n            }\r\n        }\r\n\r\n        return '';\r\n    }\r\n\r\n    // Get the label of one item\r\n    var Text = function(k, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'text';\r\n        } else {\r\n            var property = 'name';\r\n        }\r\n\r\n        if (obj.items[k]) {\r\n            if (v !== undefined) {\r\n                return obj.items[k].data[property] = v;\r\n            } else {\r\n                return obj.items[k].data[property];\r\n            }\r\n        }\r\n\r\n        return '';\r\n    }\r\n\r\n    var getValue = function() {\r\n        return Object.keys(obj.value);\r\n    }\r\n\r\n    var getText = function() {\r\n        var data = [];\r\n        var k = Object.keys(obj.value);\r\n        for (var i = 0; i < k.length; i++) {\r\n            data.push(obj.value[k[i]]);\r\n        }\r\n        return data;\r\n    }\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        // Default configuration\r\n        var defaults = {\r\n            url: null,\r\n            data: [],\r\n            format: 0,\r\n            multiple: false,\r\n            autocomplete: false,\r\n            remoteSearch: false,\r\n            lazyLoading: false,\r\n            type: null,\r\n            width: null,\r\n            maxWidth: null,\r\n            opened: false,\r\n            value: null,\r\n            placeholder: '',\r\n            newOptions: false,\r\n            position: false,\r\n            onchange: null,\r\n            onload: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onfocus: null,\r\n            onblur: null,\r\n            oninsert: null,\r\n            onbeforeinsert: null,\n            sortResults: false,\n            autofocus: false,\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Force autocomplete search\r\n        if (obj.options.remoteSearch == true || obj.options.type === 'searchbar') {\r\n            obj.options.autocomplete = true;\r\n        }\r\n\r\n        // New options\r\n        if (obj.options.newOptions == true) {\r\n            obj.header.classList.add('jdropdown-add');\r\n        } else {\r\n            obj.header.classList.remove('jdropdown-add');\r\n        }\r\n\r\n        // Autocomplete\r\n        if (obj.options.autocomplete == true) {\r\n            obj.header.removeAttribute('readonly');\r\n        } else {\r\n            obj.header.setAttribute('readonly', 'readonly');\r\n        }\r\n\r\n        // Place holder\r\n        if (obj.options.placeholder) {\r\n            obj.header.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            obj.header.removeAttribute('placeholder');\r\n        }\r\n\r\n        // Remove specific dropdown typing to add again\r\n        el.classList.remove('jdropdown-searchbar');\r\n        el.classList.remove('jdropdown-picker');\r\n        el.classList.remove('jdropdown-list');\r\n\r\n        if (obj.options.type == 'searchbar') {\r\n            el.classList.add('jdropdown-searchbar');\r\n        } else if (obj.options.type == 'list') {\r\n            el.classList.add('jdropdown-list');\r\n        } else if (obj.options.type == 'picker') {\r\n            el.classList.add('jdropdown-picker');\r\n        } else {\r\n            if (jSuites.getWindowWidth() < 800) {\r\n                if (obj.options.autocomplete) {\r\n                    el.classList.add('jdropdown-searchbar');\r\n                    obj.options.type = 'searchbar';\r\n                } else {\r\n                    el.classList.add('jdropdown-picker');\r\n                    obj.options.type = 'picker';\r\n                }\r\n            } else {\r\n                if (obj.options.width) {\r\n                    el.style.width = obj.options.width;\r\n                    el.style.minWidth = obj.options.width;\r\n                } else {\r\n                    el.style.removeProperty('width');\r\n                    el.style.removeProperty('min-width');\r\n                }\r\n\r\n                el.classList.add('jdropdown-default');\r\n                obj.options.type = 'default';\r\n            }\r\n        }\r\n\r\n        // Close button\r\n        if (obj.options.type == 'searchbar') {\r\n            containerHeader.appendChild(closeButton);\r\n        } else {\r\n            container.insertBefore(closeButton, container.firstChild);\r\n        }\r\n\r\n        // Load the content\r\n        if (obj.options.url && ! options.data) {\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    if (data) {\r\n                        success(data, obj.options.value);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            success(obj.options.data, obj.options.value);\r\n        }\r\n\r\n        // Return the instance\r\n        return obj;\r\n    }\r\n\r\n    // Helpers\r\n    var containerHeader = null;\r\n    var container = null;\r\n    var content = null;\r\n    var closeButton = null;\r\n    var resetButton = null;\r\n    var backdrop = null;\r\n\r\n    var keyTimer = null;\r\n\r\n    /**\r\n     * Init dropdown\r\n     */\r\n    var init = function() {\r\n        // Do not accept null\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        // If the element is a SELECT tag, create a configuration object\r\n        if (el.tagName == 'SELECT') {\r\n            var ret = jSuites.dropdown.extractFromDom(el, options);\r\n            el = ret.el;\r\n            options = ret.options;\r\n        }\r\n\r\n        // Place holder\r\n        if (! options.placeholder && el.getAttribute('placeholder')) {\r\n            options.placeholder = el.getAttribute('placeholder');\r\n        }\r\n\r\n        // Value container\r\n        obj.value = {};\r\n        // Containers\r\n        obj.items = [];\r\n        obj.groups = [];\r\n        // Search options\r\n        obj.search = '';\r\n        obj.results = null;\r\n\r\n        // Create dropdown\r\n        el.classList.add('jdropdown');\r\n\r\n        // Header container\r\n        containerHeader = document.createElement('div');\r\n        containerHeader.className = 'jdropdown-container-header';\r\n\r\n        // Header\r\n        obj.header = document.createElement('input');\r\n        obj.header.className = 'jdropdown-header';\r\n        obj.header.type = 'text';\r\n        obj.header.setAttribute('autocomplete', 'off');\r\n        obj.header.onfocus = function() {\r\n            if (typeof(obj.options.onfocus) == 'function') {\r\n                obj.options.onfocus(el);\r\n            }\r\n        }\r\n\r\n        obj.header.onblur = function() {\r\n            if (typeof(obj.options.onblur) == 'function') {\r\n                obj.options.onblur(el);\r\n            }\r\n        }\r\n\r\n        obj.header.onkeyup = function(e) {\r\n            if (obj.options.autocomplete == true && ! keyTimer) {\r\n                if (obj.search != obj.header.value.trim()) {\r\n                    keyTimer = setTimeout(function() {\r\n                        obj.find(obj.header.value.trim());\r\n                        keyTimer = null;\r\n                    }, 400);\r\n                }\r\n\r\n                if (! el.classList.contains('jdropdown-focus')) {\r\n                    obj.open();\r\n                }\r\n            } else {\r\n                if (! obj.options.autocomplete) {\r\n                    obj.next(e.key);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Global controls\r\n        if (! jSuites.dropdown.hasEvents) {\r\n            // Execute only one time\r\n            jSuites.dropdown.hasEvents = true;\r\n            // Enter and Esc\r\n            document.addEventListener(\"keydown\", jSuites.dropdown.keydown);\r\n        }\r\n\r\n        // Container\r\n        container = document.createElement('div');\r\n        container.className = 'jdropdown-container';\r\n\r\n        // Dropdown content\r\n        content = document.createElement('div');\r\n        content.className = 'jdropdown-content';\r\n\r\n        // Close button\r\n        closeButton = document.createElement('div');\r\n        closeButton.className = 'jdropdown-close';\r\n        closeButton.innerHTML = 'Done';\r\n\r\n        // Reset button\r\n        resetButton = document.createElement('div');\r\n        resetButton.className = 'jdropdown-reset';\r\n        resetButton.innerHTML = 'x';\r\n        resetButton.onclick = function() {\r\n            obj.reset();\r\n            obj.close();\r\n        }\r\n\r\n        // Create backdrop\r\n        backdrop = document.createElement('div');\r\n        backdrop.className = 'jdropdown-backdrop';\r\n\r\n        // Append elements\r\n        containerHeader.appendChild(obj.header);\r\n\r\n        container.appendChild(content);\r\n        el.appendChild(containerHeader);\r\n        el.appendChild(container);\r\n        el.appendChild(backdrop);\r\n\r\n        // Set the otiptions\r\n        obj.setOptions(options);\r\n\r\n        if ('ontouchsend' in document.documentElement === true) {\r\n            el.addEventListener('touchsend', jSuites.dropdown.mouseup);\r\n        } else {\r\n            el.addEventListener('mouseup', jSuites.dropdown.mouseup);\r\n        }\r\n\r\n        // Lazyloading\r\n        if (obj.options.lazyLoading == true) {\r\n            jSuites.lazyLoading(content, {\r\n                loadUp: obj.loadUp,\r\n                loadDown: obj.loadDown,\r\n            });\r\n        }\r\n\r\n        content.onwheel = function(e) {\r\n            e.stopPropagation();\r\n        }\r\n\r\n        // Change method\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue(obj.options.multiple ? true : false);\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.dropdown = obj;\r\n    }\r\n\r\n    /**\r\n     * Get the current remote source of data URL\r\n     */\r\n    obj.getUrl = function() {\r\n        return obj.options.url;\r\n    }\r\n\r\n    /**\r\n     * Set the new data from a remote source\r\n     * @param {string} url - url from the remote source\r\n     * @param {function} callback - callback when the data is loaded\r\n     */\r\n    obj.setUrl = function(url, callback) {\r\n        obj.options.url = url;\r\n\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'json',\r\n            success: function(data) {\r\n                obj.setData(data);\r\n                // Callback\r\n                if (typeof(callback) == 'function') {\r\n                    callback(obj);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Set ID for one item\r\n     */\r\n    obj.setId = function(item, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'value';\r\n        } else {\r\n            var property = 'id';\r\n        }\r\n\r\n        if (typeof(item) == 'object') {\r\n            item[property] = v;\r\n        } else {\r\n            obj.items[item].data[property] = v;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add a new item\r\n     * @param {string} title - title of the new item\r\n     * @param {string} id - value/id of the new item\n     */\r\n    obj.add = function(title, id) {\r\n        if (! title) {\r\n            var current = obj.options.autocomplete == true ? obj.header.value : '';\r\n            var title = prompt(jSuites.translate('Add A New Option'), current);\r\n            if (! title) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Id\r\n        if (! id) {\r\n           id = jSuites.guid();\r\n        }\r\n\r\n        // Create new item\r\n        if (! obj.options.format) {\r\n            var item = {\r\n                value: id,\r\n                text: title,\r\n            }\r\n        } else {\r\n            var item = {\r\n                id: id,\r\n                name: title,\r\n            }\r\n        }\r\n\r\n        // Callback\r\n        if (typeof(obj.options.onbeforeinsert) == 'function') {\r\n            var ret = obj.options.onbeforeinsert(obj, item);\r\n            if (ret === false) {\r\n                return false;\r\n            } else if (ret) {\r\n                item = ret;\r\n            }\r\n        }\n\n        // Add item to the main list\r\n        obj.options.data.push(item);\r\n\r\n        // Create DOM\r\n        var newItem = obj.createItem(item);\r\n\r\n        // Append DOM to the list\r\n        content.appendChild(newItem.element);\r\n\r\n        // Callback\r\n        if (typeof(obj.options.oninsert) == 'function') {\r\n            obj.options.oninsert(obj, item, newItem);\r\n        }\r\n\r\n        // Show content\r\n        if (content.style.display == 'none') {\r\n            content.style.display = '';\r\n        }\r\n\r\n        // Search?\r\n        if (obj.results) {\r\n            obj.results.push(newItem);\r\n        }\r\n\r\n        return item;\r\n    }\r\n\r\n    /**\r\n     * Create a new item\r\n     */\r\n    obj.createItem = function(data, group, groupName) {\r\n        // Keep the correct source of data\r\n        if (! obj.options.format) {\r\n            if (! data.value && data.id !== undefined) {\r\n                data.value = data.id;\r\n                //delete data.id;\r\n            }\r\n            if (! data.text && data.name !== undefined) {\r\n                data.text = data.name;\r\n                //delete data.name;\r\n            }\r\n        } else {\r\n            if (! data.id && data.value !== undefined) {\r\n                data.id = data.value;\r\n                //delete data.value;\r\n            }\r\n            if (! data.name && data.text !== undefined) {\r\n                data.name = data.text\r\n                //delete data.text;\r\n            }\r\n        }\r\n\r\n        // Create item\r\n        var item = {};\r\n        item.element = document.createElement('div');\r\n        item.element.className = 'jdropdown-item';\r\n        item.element.indexValue = obj.items.length;\r\n        item.data = data;\r\n\r\n        // Groupd DOM\r\n        if (group) {\r\n            item.group = group; \r\n        }\r\n\r\n        // Id\r\n        if (data.id) {\r\n            item.element.setAttribute('id', data.id);\r\n        }\r\n\r\n        // Disabled\r\n        if (data.disabled == true) {\r\n            item.element.setAttribute('data-disabled', true);\r\n        }\r\n\r\n        // Tooltip\n        if (data.tooltip) {\n            item.element.setAttribute('title', data.tooltip);\n        }\n\n        // Image\r\n        if (data.image) {\r\n            var image = document.createElement('img');\r\n            image.className = 'jdropdown-image';\r\n            image.src = data.image;\r\n            if (! data.title) {\r\n               image.classList.add('jdropdown-image-small');\r\n            }\r\n            item.element.appendChild(image);\r\n        } else if (data.icon) {\r\n            var icon = document.createElement('span');\r\n            icon.className = \"jdropdown-icon material-icons\";\r\n            icon.innerText = data.icon;\r\n            if (! data.title) {\r\n               icon.classList.add('jdropdown-icon-small');\r\n            }\r\n            if (data.color) {\r\n                icon.style.color = data.color;\r\n            }\r\n            item.element.appendChild(icon);\n        } else if (data.color) {\r\n            var color = document.createElement('div');\r\n            color.className = 'jdropdown-color';\r\n            color.style.backgroundColor = data.color;\r\n            item.element.appendChild(color);\r\n        }\r\n\r\n        // Set content\r\n        if (! obj.options.format) {\r\n            var text = data.text;\r\n        } else {\r\n            var text = data.name;\r\n        }\r\n\r\n        var node = document.createElement('div');\r\n        node.className = 'jdropdown-description';\r\n        node.innerHTML = text || '&nbsp;'; \r\n\r\n        // Title\r\n        if (data.title) {\r\n            var title = document.createElement('div');\r\n            title.className = 'jdropdown-title';\r\n            title.innerText = data.title;\r\n            node.appendChild(title);\r\n        }\r\n\r\n        // Set content\r\n        if (! obj.options.format) {\r\n            var val = data.value;\r\n        } else {\r\n            var val = data.id;\r\n        }\r\n\r\n        // Value\r\n        if (obj.value[val]) {\r\n            item.element.classList.add('jdropdown-selected');\r\n            item.selected = true;\r\n        }\r\n\r\n        // Keep DOM accessible\r\n        obj.items.push(item);\r\n\r\n        // Add node to item\r\n        item.element.appendChild(node);\r\n\r\n        return item;\r\n    }\r\n\r\n    obj.appendData = function(data) {\r\n        // Create elements\r\n        if (data.length) {\r\n            // Helpers\r\n            var items = [];\r\n            var groups = [];\r\n\r\n            // Prepare data\r\n            for (var i = 0; i < data.length; i++) {\r\n                // Process groups\r\n                if (data[i].group) {\r\n                    if (! groups[data[i].group]) {\r\n                        groups[data[i].group] = [];\r\n                    }\r\n                    groups[data[i].group].push(i);\r\n                } else {\r\n                    items.push(i);\r\n                }\r\n            }\r\n\r\n            // Number of items counter\r\n            var counter = 0;\r\n\r\n            // Groups\r\n            var groupNames = Object.keys(groups);\r\n\r\n            // Append groups in case exists\r\n            if (groupNames.length > 0) {\r\n                for (var i = 0; i < groupNames.length; i++) {\r\n                    // Group container\r\n                    var group = document.createElement('div');\r\n                    group.className = 'jdropdown-group';\r\n                    // Group name\r\n                    var groupName = document.createElement('div');\r\n                    groupName.className = 'jdropdown-group-name';\r\n                    groupName.innerHTML = groupNames[i];\r\n                    // Group arrow\r\n                    var groupArrow = document.createElement('i');\r\n                    groupArrow.className = 'jdropdown-group-arrow jdropdown-group-arrow-down';\r\n                    groupName.appendChild(groupArrow);\r\n                    // Group items\r\n                    var groupContent = document.createElement('div');\r\n                    groupContent.className = 'jdropdown-group-items';\r\n                    for (var j = 0; j < groups[groupNames[i]].length; j++) {\r\n                        var item = obj.createItem(data[groups[groupNames[i]][j]], group, groupNames[i]);\r\n\r\n                        if (obj.options.lazyLoading == false || counter < 200) {\r\n                            groupContent.appendChild(item.element);\r\n                            counter++;\r\n                        }\r\n                    }\r\n                    // Group itens\r\n                    group.appendChild(groupName);\r\n                    group.appendChild(groupContent);\r\n                    // Keep group DOM\r\n                    obj.groups.push(group);\r\n                    // Only add to the screen if children on the group\r\n                    if (groupContent.children.length > 0) {\r\n                        // Add DOM to the content\r\n                        content.appendChild(group);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (items.length) {\r\n                for (var i = 0; i < items.length; i++) {\r\n                    var item = obj.createItem(data[items[i]]);\r\n                    if (obj.options.lazyLoading == false || counter < 200) {\r\n                        content.appendChild(item.element);\r\n                        counter++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.setData = function(data) {\r\n        // Prepare data\r\n        if (data.length) {\r\n            for (var i = 0; i < data.length; i++) {\r\n                // Compatibility\r\n                if (typeof(data[i]) != 'object') {\r\n                    // Correct format\r\n                    if (! obj.options.format) {\r\n                        data[i] = {\r\n                            value: data[i],\r\n                            text: data[i]\r\n                        }\r\n                    } else {\r\n                        data[i] = {\r\n                            id: data[i],\r\n                            name: data[i]\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Reset current value\r\n            resetValue();\r\n\r\n            // Make sure the content container is blank\r\n            content.innerHTML = '';\r\n\r\n            // Reset\r\n            obj.header.value = '';\r\n\r\n            // Reset items and values\r\n            obj.items = [];\r\n\r\n            // Append data\r\n            obj.appendData(data);\r\n\r\n            // Update data\r\n            obj.options.data = data;\r\n        }\r\n    }\r\n\r\n    obj.getData = function() {\r\n        return obj.options.data;\r\n    }\r\n\r\n    /**\r\n     * Get position of the item\r\n     */\r\n    obj.getPosition = function(val) {\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (Value(i) == val) {\r\n                return i;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Get dropdown current text\r\n     */\r\n    obj.getText = function(asArray) {\r\n        // Get value\r\n        var v = getText();\r\n        // Return value\r\n        if (asArray) {\r\n            return v;\r\n        } else {\r\n            return v.join('; ');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get dropdown current value\r\n     */\r\n    obj.getValue = function(asArray) {\r\n        // Get value\r\n        var v = getValue();\r\n        // Return value\r\n        if (asArray) {\r\n            return v;\r\n        } else {\r\n            return v.join(';');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Change event\r\n     */\r\n    var change = function(oldValue) {\r\n        // Events\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, obj, oldValue, obj.options.value);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set value\r\n     */\r\n    obj.setValue = function(newValue) {\r\n        // Current value\r\n        var oldValue = obj.getValue();\r\n        // New value\r\n        if (Array.isArray(newValue)) {\r\n            newValue = newValue.join(';')\r\n        }\r\n\r\n        if (oldValue !== newValue) {\r\n            // Set value\r\n            applyValue(newValue);\r\n\r\n            // Change\r\n            change(oldValue);\r\n        }\r\n    }\r\n\r\n    obj.resetSelected = function() {\r\n        obj.setValue(null);\r\n    } \r\n\r\n    obj.selectIndex = function(index, force) {\r\n        // Make sure is a number\r\n        var index = parseInt(index);\r\n\r\n        // Only select those existing elements\r\n        if (obj.items && obj.items[index] && (force === true || obj.items[index].data.disabled !== true)) {\r\n            // Reset cursor to a new position\r\n            obj.setCursor(index, false);\r\n\r\n            // Behaviour\r\n            if (! obj.options.multiple) {\r\n                // Update value\r\n                if (obj.items[index].selected) {\r\n                    obj.setValue(null);\r\n                } else {\r\n                    obj.setValue(Value(index));\r\n                }\r\n\r\n                // Close component\r\n                obj.close();\r\n            } else {\r\n                // Old value\r\n                var oldValue = obj.options.value;\r\n\r\n                // Toggle option\r\n                if (obj.items[index].selected) {\r\n                    obj.items[index].element.classList.remove('jdropdown-selected');\r\n                    obj.items[index].selected = false;\r\n\r\n                    delete obj.value[Value(index)];\r\n                } else {\r\n                    // Select element\r\n                    obj.items[index].element.classList.add('jdropdown-selected');\r\n                    obj.items[index].selected = true;\r\n\r\n                    // Set value\r\n                    obj.value[Value(index)] = Text(index);\r\n                }\r\n\r\n                // Global value\r\n                obj.options.value = Object.keys(obj.value).join(';');\r\n\r\n                // Update labels for multiple dropdown\r\n                if (obj.options.autocomplete == false) {\r\n                    obj.header.value = getText().join('; ');\r\n                }\r\n\r\n                // Events\r\n                change(oldValue);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.selectItem = function(item) {\r\n        obj.selectIndex(item.indexValue);\r\n    }\r\n\r\n    var exists = function(k, result) {\r\n        for (var j = 0; j < result.length; j++) {\r\n            if (! obj.options.format) {\r\n                if (result[j].value == k) {\r\n                    return true;\r\n                }\r\n            } else {\r\n                if (result[j].id == k) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    obj.find = function(str) {\r\n        if (obj.search == str.trim()) {\r\n            return false;\r\n        }\r\n\r\n        // Search term\r\n        obj.search = str;\r\n\r\n        // Reset index\r\n        obj.setCursor();\r\n\r\n        // Remove nodes from all groups\r\n        if (obj.groups.length) {\r\n            for (var i = 0; i < obj.groups.length; i++) {\r\n                obj.groups[i].lastChild.innerHTML = '';\r\n            }\r\n        }\r\n\r\n        // Remove all nodes\r\n        content.innerHTML = '';\r\n\r\n        // Remove current items in the remote search\r\n        if (obj.options.remoteSearch == true) {\r\n            // Reset results\r\n            obj.results = null;\r\n            // URL\r\n            var url = obj.options.url + (obj.options.url.indexOf('?') > 0 ? '&' : '?') + 'q=' + str;\r\n            // Remote search\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Reset items\r\n                    obj.items = [];\r\n\r\n                    // Add the current selected items to the results in case they are not there\r\n                    var current = Object.keys(obj.value);\r\n                    if (current.length) {\r\n                        for (var i = 0; i < current.length; i++) {\r\n                            if (! exists(current[i], result)) {\r\n                                if (! obj.options.format) {\r\n                                    result.unshift({ value: current[i], text: obj.value[current[i]] });\r\n                                } else {\r\n                                    result.unshift({ id: current[i], name: obj.value[current[i]] });\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    // Append data\r\n                    obj.appendData(result);\r\n                    // Show or hide results\r\n                    if (! result.length) {\r\n                        content.style.display = 'none';\r\n                    } else {\r\n                        content.style.display = '';\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            // Search terms\r\n            str = new RegExp(str, 'gi');\r\n\r\n            // Reset search\r\n            var results = [];\r\n\r\n            // Append options\r\n            for (var i = 0; i < obj.items.length; i++) {\r\n                // Item label\r\n                var label = Text(i);\r\n                // Item title\r\n                var title = obj.items[i].data.title || '';\r\n                // Group name\r\n                var groupName = obj.items[i].data.group || '';\r\n                // Synonym\r\n                var synonym = obj.items[i].data.synonym || '';\r\n                if (synonym) {\r\n                    synonym = synonym.join(' ');\r\n                }\r\n\r\n                if (str == null || obj.items[i].selected == true || label.match(str) || title.match(str) || groupName.match(str) || synonym.match(str)) {\r\n                    results.push(obj.items[i]);\r\n                }\r\n            }\r\n\r\n            if (! results.length) {\r\n                content.style.display = 'none';\r\n\r\n                // Results\r\n                obj.results = null;\r\n            } else {\r\n                content.style.display = '';\r\n\r\n                // Results\r\n                obj.results = results;\r\n\r\n                // Show 200 items at once\r\n                var number = results.length || 0;\r\n\r\n                // Lazyloading\r\n                if (obj.options.lazyLoading == true && number > 200) {\r\n                    number = 200;\r\n                }\r\n\r\n                for (var i = 0; i < number; i++) {\r\n                    if (obj.results[i].group) {\r\n                        if (! obj.results[i].group.parentNode) {\r\n                            content.appendChild(obj.results[i].group);\r\n                        }\r\n                        obj.results[i].group.lastChild.appendChild(obj.results[i].element);\r\n                    } else {\r\n                        content.appendChild(obj.results[i].element);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Auto focus\r\n        if (obj.options.autofocus == true) {\r\n            obj.first();\r\n        }\r\n    }\r\n\r\n    obj.open = function() {\r\n        // Focus\r\n        if (! el.classList.contains('jdropdown-focus')) {\r\n            // Current dropdown\r\n            jSuites.dropdown.current = obj;\r\n\r\n            // Start tracking\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Add focus\r\n            el.classList.add('jdropdown-focus');\r\n\r\n            // Animation\r\n            if (jSuites.getWindowWidth() < 800) {\r\n                if (obj.options.type == null || obj.options.type == 'picker') {\r\n                    jSuites.animation.slideBottom(container, 1);\r\n                }\r\n            }\r\n\r\n            // Filter\r\n            if (obj.options.autocomplete == true) {\r\n                obj.header.value = obj.search;\r\n                obj.header.focus();\r\n            }\r\n\r\n            // Set cursor for the first or first selected element\r\n            var k = getValue();\r\n            if (k[0]) {\r\n                var cursor = obj.getPosition(k[0]);\r\n                if (cursor !== false) {\r\n                    obj.setCursor(cursor);\r\n                }\r\n            }\r\n\r\n            // Container Size\r\n            if (! obj.options.type || obj.options.type == 'default') {\r\n                var rect = el.getBoundingClientRect();\r\n                var rectContainer = container.getBoundingClientRect();\r\n\r\n                if (obj.options.position) {\r\n                    container.style.position = 'fixed';\r\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\r\n                        container.style.top = '';\r\n                        container.style.bottom = (window.innerHeight - rect.top ) + 1 + 'px';\r\n                    } else {\r\n                        container.style.top = rect.bottom + 'px';\r\n                        container.style.bottom = '';\r\n                    }\r\n                    container.style.left = rect.left + 'px';\r\n                } else {\r\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\r\n                        container.style.top = '';\r\n                        container.style.bottom = rect.height + 1 + 'px';\r\n                    } else {\r\n                        container.style.top = '';\r\n                        container.style.bottom = '';\r\n                    }\r\n                }\r\n\r\n                container.style.minWidth = rect.width + 'px';\r\n\r\n                if (obj.options.maxWidth) {\r\n                    container.style.maxWidth = obj.options.maxWidth;\r\n                }\r\n\r\n                if (! obj.items.length && obj.options.autocomplete == true) {\r\n                    content.style.display = 'none';\r\n                } else {\r\n                    content.style.display = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Events\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el);\r\n        }\r\n    }\r\n\r\n    obj.close = function(ignoreEvents) {\r\n        if (el.classList.contains('jdropdown-focus')) {\r\n            // Update labels\r\n            obj.header.value = obj.getText();\r\n            // Remove cursor\r\n            obj.setCursor();\r\n            // Events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Blur\r\n            if (obj.header.blur) {\r\n                obj.header.blur();\r\n            }\r\n            // Remove focus\r\n            el.classList.remove('jdropdown-focus');\r\n            // Start tracking\r\n            jSuites.tracking(obj, false);\r\n            // Current dropdown\r\n            jSuites.dropdown.current = null;\r\n        }\r\n\r\n        return obj.getValue();\r\n    }\r\n\r\n    /**\r\n     * Set cursor\r\n     */\r\n    obj.setCursor = function(index, setPosition) {\r\n        // Remove current cursor\r\n        if (obj.currentIndex != null) {\r\n            // Remove visual cursor\r\n            if (obj.items && obj.items[obj.currentIndex]) {\r\n                obj.items[obj.currentIndex].element.classList.remove('jdropdown-cursor');\r\n            }\r\n        }\r\n\r\n        if (index == undefined) {\r\n            obj.currentIndex = null;\r\n        } else {\r\n            index = parseInt(index);\r\n\r\n            // Cursor only for visible items\r\n            if (obj.items[index].element.parentNode) {\r\n                obj.items[index].element.classList.add('jdropdown-cursor');\r\n                obj.currentIndex = index;\r\n\r\n                // Update scroll to the cursor element\r\n                if (setPosition !== false && obj.items[obj.currentIndex].element) {\r\n                    var container = content.scrollTop;\r\n                    var element = obj.items[obj.currentIndex].element;\r\n                    content.scrollTop = element.offsetTop - element.scrollTop + element.clientTop - 95;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Compatibility\r\n    obj.resetCursor = obj.setCursor;\r\n    obj.updateCursor = obj.setCursor;\r\n\r\n    /**\r\n     * Reset cursor and selected items\r\n     */\r\n    obj.reset = function() {\r\n        // Reset cursor\r\n        obj.setCursor();\r\n\r\n        // Reset selected\r\n        obj.setValue(null);\r\n    }\r\n\r\n    /**\r\n     * First available item\r\n     */\r\n    obj.first = function() {\r\n        if (obj.options.lazyLoading === true) {\r\n            obj.loadFirst();\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        if (items.length) {\r\n            var newIndex = items[0].indexValue;\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Last available item \r\n     */\r\n    obj.last = function() {\r\n        if (obj.options.lazyLoading === true) {\r\n            obj.loadLast();\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        if (items.length) {\r\n            var newIndex = items[items.length-1].indexValue;\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    obj.next = function(letter) {\r\n        var newIndex = null;\r\n\r\n        if (letter) {\r\n            if (letter.length == 1) {\r\n                // Current index\r\n                var current = obj.currentIndex || -1;\r\n                // Letter\r\n                letter = letter.toLowerCase();\r\n\r\n                var e = null;\r\n                var l = null;\r\n                var items = content.querySelectorAll('.jdropdown-item');\r\n                if (items.length) {\r\n                    for (var i = 0; i < items.length; i++) {\r\n                        if (items[i].indexValue > current) {\r\n                            if (e = obj.items[items[i].indexValue]) {\r\n                                if (l = e.element.innerText[0]) {\r\n                                    l = l.toLowerCase();\r\n                                    if (letter == l) {\r\n                                        newIndex = items[i].indexValue;\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    obj.setCursor(newIndex);\r\n                }\r\n            }\r\n        } else {\r\n            if (obj.currentIndex == undefined || obj.currentIndex == null) {\r\n                obj.first();\r\n            } else {\r\n                var element = obj.items[obj.currentIndex].element;\r\n\r\n                var next = element.nextElementSibling;\r\n                if (next) {\r\n                    if (next.classList.contains('jdropdown-group')) {\r\n                        next = next.lastChild.firstChild;\r\n                    }\r\n                    newIndex = next.indexValue;\r\n                } else {\r\n                    if (element.parentNode.classList.contains('jdropdown-group-items')) {\r\n                        if (next = element.parentNode.parentNode.nextElementSibling) {\r\n                            if (next.classList.contains('jdropdown-group')) {\r\n                                next = next.lastChild.firstChild;\r\n                            } else if (next.classList.contains('jdropdown-item')) {\r\n                                newIndex = next.indexValue;\r\n                            } else {\r\n                                next = null;\r\n                            }\r\n                        }\r\n\r\n                        if (next) {\r\n                            newIndex = next.indexValue;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (newIndex !== null) {\r\n                    obj.setCursor(newIndex);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.prev = function() {\r\n        var newIndex = null;\r\n\r\n        if (obj.currentIndex === null) {\r\n            obj.first();\r\n        } else {\r\n            var element = obj.items[obj.currentIndex].element;\r\n\r\n            var prev = element.previousElementSibling;\r\n            if (prev) {\r\n                if (prev.classList.contains('jdropdown-group')) {\r\n                    prev = prev.lastChild.lastChild;\r\n                }\r\n                newIndex = prev.indexValue;\r\n            } else {\r\n                if (element.parentNode.classList.contains('jdropdown-group-items')) {\r\n                    if (prev = element.parentNode.parentNode.previousElementSibling) {\r\n                        if (prev.classList.contains('jdropdown-group')) {\r\n                            prev = prev.lastChild.lastChild;\r\n                        } else if (prev.classList.contains('jdropdown-item')) {\r\n                            newIndex = prev.indexValue;\r\n                        } else {\r\n                            prev = null\r\n                        }\r\n                    }\r\n\r\n                    if (prev) {\r\n                        newIndex = prev.indexValue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (newIndex !== null) {\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    obj.loadFirst = function() {\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        // Show 200 items at once\r\n        var number = results.length || 0;\r\n\r\n        // Lazyloading\r\n        if (obj.options.lazyLoading == true && number > 200) {\r\n            number = 200;\r\n        }\r\n\r\n        // Reset container\r\n        content.innerHTML = '';\r\n\r\n        // First 200 items\r\n        for (var i = 0; i < number; i++) {\r\n            if (results[i].group) {\r\n                if (! results[i].group.parentNode) {\r\n                    content.appendChild(results[i].group);\r\n                }\r\n                results[i].group.lastChild.appendChild(results[i].element);\r\n            } else {\r\n                content.appendChild(results[i].element);\r\n            }\r\n        }\r\n\r\n        // Scroll go to the begin\r\n        content.scrollTop = 0;\r\n    }\r\n\r\n    obj.loadLast = function() {\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        // Show first page\r\n        var number = results.length;\r\n\r\n        // Max 200 items\r\n        if (number > 200) {\r\n            number = number - 200;\r\n\r\n            // Reset container\r\n            content.innerHTML = '';\r\n\r\n            // First 200 items\r\n            for (var i = number; i < results.length; i++) {\r\n                if (results[i].group) {\r\n                    if (! results[i].group.parentNode) {\r\n                        content.appendChild(results[i].group);\r\n                    }\r\n                    results[i].group.lastChild.appendChild(results[i].element);\r\n                } else {\r\n                    content.appendChild(results[i].element);\r\n                }\r\n            }\r\n\r\n            // Scroll go to the begin\r\n            content.scrollTop = content.scrollHeight;\r\n        }\r\n    }\r\n\r\n    obj.loadUp = function() {\r\n        var test = false;\r\n\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        var fistItem = items[0].indexValue;\r\n        fistItem = obj.items[fistItem];\r\n        var index = results.indexOf(fistItem) - 1;\r\n\r\n        if (index > 0) {\r\n            var number = 0;\r\n\r\n            while (index > 0 && results[index] && number < 200) {\r\n                if (results[index].group) {\r\n                    if (! results[index].group.parentNode) {\r\n                        content.insertBefore(results[index].group, content.firstChild);\r\n                    }\r\n                    results[index].group.lastChild.insertBefore(results[index].element, results[index].group.lastChild.firstChild);\r\n                } else {\r\n                    content.insertBefore(results[index].element, content.firstChild);\r\n                }\r\n\r\n                index--;\r\n                number++;\r\n            }\r\n\r\n            // New item added\r\n            test = true;\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    obj.loadDown = function() {\r\n        var test = false;\r\n\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        var lastItem = items[items.length-1].indexValue;\r\n        lastItem = obj.items[lastItem];\r\n        var index = results.indexOf(lastItem) + 1;\r\n\r\n        if (index < results.length) {\r\n            var number = 0;\r\n            while (index < results.length && results[index] && number < 200) {\r\n                if (results[index].group) {\r\n                    if (! results[index].group.parentNode) {\r\n                        content.appendChild(results[index].group);\r\n                    }\r\n                    results[index].group.lastChild.appendChild(results[index].element);\r\n                } else {\r\n                    content.appendChild(results[index].element);\r\n                }\r\n\r\n                index++;\r\n                number++;\r\n            }\r\n\r\n            // New item added\r\n            test = true;\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.dropdown.keydown = function(e) {\r\n    var dropdown = null;\r\n    if (dropdown = jSuites.dropdown.current) {\r\n        if (e.which == 13 || e.which == 9) {  // enter or tab\n            if (dropdown.header.value && dropdown.currentIndex == null && dropdown.options.newOptions) {\n                // if they typed something in, but it matched nothing, and newOptions are allowed, start that flow\n                dropdown.add();\n            } else {\n                // Quick Select/Filter\r\n                if (dropdown.currentIndex == null && dropdown.options.autocomplete == true && dropdown.header.value != \"\") {\r\n                    dropdown.find(dropdown.header.value);\r\n                }\r\n                dropdown.selectIndex(dropdown.currentIndex);\r\n            }\n        } else if (e.which == 38) {  // up arrow\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex > 0) {\r\n                dropdown.prev();\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 40) {  // down arrow\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex + 1 < dropdown.items.length) {\r\n                dropdown.next();\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 36) {\r\n            dropdown.first();\r\n            if (! e.target.classList.contains('jdropdown-header')) {\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 35) {\r\n            dropdown.last();\r\n            if (! e.target.classList.contains('jdropdown-header')) {\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 27) {\r\n            dropdown.close();\r\n        } else if (e.which == 33) {  // page up\r\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex > 0) {\r\n                for (var i = 0; i < 7; i++) {\r\n                    dropdown.prev()\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 34) {  // page down\r\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex + 1 < dropdown.items.length) {\r\n                for (var i = 0; i < 7; i++) {\r\n                    dropdown.next()\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.dropdown.mouseup = function(e) {\r\n    var element = jSuites.findElement(e.target, 'jdropdown');\r\n    if (element) {\r\n        var dropdown = element.dropdown;\r\n        if (e.target.classList.contains('jdropdown-header')) {\r\n            if (element.classList.contains('jdropdown-focus') && element.classList.contains('jdropdown-default')) {\r\n                var rect = element.getBoundingClientRect();\r\n\r\n                if (e.changedTouches && e.changedTouches[0]) {\r\n                    var x = e.changedTouches[0].clientX;\r\n                    var y = e.changedTouches[0].clientY;\r\n                } else {\r\n                    var x = e.clientX;\r\n                    var y = e.clientY;\r\n                }\r\n\r\n                if (rect.width - (x - rect.left) < 30) {\r\n                    if (e.target.classList.contains('jdropdown-add')) {\r\n                        dropdown.add();\r\n                    } else {\r\n                        dropdown.close();\r\n                    }\r\n                } else {\r\n                    if (dropdown.options.autocomplete == false) {\r\n                        dropdown.close();\r\n                    }\r\n                }\r\n            } else {\r\n                dropdown.open();\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-group-name')) {\r\n            var items = e.target.nextSibling.children;\r\n            if (e.target.nextSibling.style.display != 'none') {\r\n                for (var i = 0; i < items.length; i++) {\r\n                    if (items[i].style.display != 'none') {\r\n                        dropdown.selectItem(items[i]);\r\n                    }\r\n                }\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-group-arrow')) {\r\n            if (e.target.classList.contains('jdropdown-group-arrow-down')) {\r\n                e.target.classList.remove('jdropdown-group-arrow-down');\r\n                e.target.classList.add('jdropdown-group-arrow-up');\r\n                e.target.parentNode.nextSibling.style.display = 'none';\r\n            } else {\r\n                e.target.classList.remove('jdropdown-group-arrow-up');\r\n                e.target.classList.add('jdropdown-group-arrow-down');\r\n                e.target.parentNode.nextSibling.style.display = '';\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-item')) {\r\n            dropdown.selectItem(e.target);\r\n        } else if (e.target.classList.contains('jdropdown-image')) {\r\n            dropdown.selectItem(e.target.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-description')) {\r\n            dropdown.selectItem(e.target.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-title')) {\r\n            dropdown.selectItem(e.target.parentNode.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-close') || e.target.classList.contains('jdropdown-backdrop')) {\r\n            dropdown.close();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.dropdown.extractFromDom = function(el, options) {\r\n    // Keep reference\r\n    var select = el;\r\n    if (! options) {\r\n        options = {};\r\n    }\r\n    // Prepare configuration\r\n    if (el.getAttribute('multiple') && (! options || options.multiple == undefined)) {\r\n        options.multiple = true;\r\n    }\r\n    if (el.getAttribute('placeholder') && (! options || options.placeholder == undefined)) {\r\n        options.placeholder = el.getAttribute('placeholder');\r\n    }\r\n    if (el.getAttribute('data-autocomplete') && (! options || options.autocomplete == undefined)) {\r\n        options.autocomplete = true;\r\n    }\r\n    if (! options || options.width == undefined) {\r\n        options.width = el.offsetWidth;\r\n    }\r\n    if (el.value && (! options || options.value == undefined)) {\r\n        options.value = el.value;\r\n    }\r\n    if (! options || options.data == undefined) {\r\n        options.data = [];\r\n        for (var j = 0; j < el.children.length; j++) {\r\n            if (el.children[j].tagName == 'OPTGROUP') {\r\n                for (var i = 0; i < el.children[j].children.length; i++) {\r\n                    options.data.push({\r\n                        value: el.children[j].children[i].value,\r\n                        text: el.children[j].children[i].innerHTML,\r\n                        group: el.children[j].getAttribute('label'),\r\n                    });\r\n                }\r\n            } else {\r\n                options.data.push({\r\n                    value: el.children[j].value,\r\n                    text: el.children[j].innerHTML,\r\n                });\r\n            }\r\n        }\r\n    }\r\n    if (! options || options.onchange == undefined) {\r\n        options.onchange = function(a,b,c,d) {\r\n            if (options.multiple == true) {\r\n                if (obj.items[b].classList.contains('jdropdown-selected')) {\r\n                    select.options[b].setAttribute('selected', 'selected');\r\n                } else {\r\n                    select.options[b].removeAttribute('selected');\r\n                }\r\n            } else {\r\n                select.value = d;\r\n            }\r\n        }\r\n    }\r\n    // Create DIV\r\n    var div = document.createElement('div');\r\n    el.parentNode.insertBefore(div, el);\r\n    el.style.display = 'none';\r\n    el = div;\r\n\r\n    return { el:el, options:options };\r\n}\r\n\r\njSuites.editor = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        // Initial HTML content\r\n        value: null,\r\n        // Initial snippet\r\n        snippet: null,\r\n        // Add toolbar\r\n        toolbar: null,\r\n        // Website parser is to read websites and images from cross domain\r\n        remoteParser: null,\r\n        // Placeholder\r\n        placeholder: null,\r\n        // Parse URL\r\n        parseURL: false,\r\n        filterPaste: true,\r\n        // Accept drop files\r\n        dropZone: false,\r\n        dropAsSnippet: false,\r\n        acceptImages: false,\r\n        acceptFiles: false,\r\n        maxFileSize: 5000000,\r\n        allowImageResize: true,\r\n        // Style\r\n        border: true,\r\n        padding: true,\r\n        maxHeight: null,\r\n        height: null,\r\n        focus: false,\r\n        // Events\r\n        onclick: null,\r\n        onfocus: null,\r\n        onblur: null,\r\n        onload: null,\r\n        onkeyup: null,\r\n        onkeydown: null,\r\n        onchange: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Private controllers\r\n    var imageResize = 0;\r\n    var editorTimer = null;\r\n    var editorAction = null;\r\n    var files = [];\r\n\r\n    // Make sure element is empty\r\n    el.innerHTML = '';\r\n\r\n    // Keep the reference for the container\r\n    obj.el = el;\r\n\r\n    if (typeof(obj.options.onclick) == 'function') {\r\n        el.onclick = function(e) {\r\n            obj.options.onclick(el, obj, e);\r\n        }\r\n    }\r\n\r\n    // Prepare container\r\n    el.classList.add('jeditor-container');\r\n\r\n    // Padding\r\n    if (obj.options.padding == true) {\r\n        el.classList.add('jeditor-padding');\r\n    }\r\n\r\n    // Border\r\n    if (obj.options.border == false) {\r\n        el.style.border = '0px';\r\n    }\r\n\r\n    // Snippet\r\n    var snippet = document.createElement('div');\r\n    snippet.className = 'jsnippet';\r\n    snippet.setAttribute('contenteditable', false);\r\n\r\n    // Toolbar\r\n    var toolbar = document.createElement('div');\r\n    toolbar.className = 'jeditor-toolbar';\r\n\r\n    // Create editor\r\n    var editor = document.createElement('div');\r\n    editor.setAttribute('contenteditable', true);\r\n    editor.setAttribute('spellcheck', false);\r\n    editor.className = 'jeditor';\r\n\r\n    // Placeholder\r\n    if (obj.options.placeholder) {\r\n        editor.setAttribute('data-placeholder', obj.options.placeholder);\r\n    }\r\n\r\n    // Max height\r\n    if (obj.options.maxHeight || obj.options.height) {\r\n        editor.style.overflowY = 'auto';\r\n\r\n        if (obj.options.maxHeight) {\r\n            editor.style.maxHeight = obj.options.maxHeight;\r\n        }\r\n        if (obj.options.height) {\r\n            editor.style.height = obj.options.height;\r\n        }\r\n    }\r\n\r\n    // Set editor initial value\r\n    if (obj.options.value) {\r\n        var value = obj.options.value;\r\n    } else {\r\n        var value = el.innerHTML ? el.innerHTML : ''; \r\n    }\r\n\r\n    if (! value) {\r\n        var value = '';\r\n    }\r\n\r\n    /**\r\n     * Onchange event controllers\r\n     */\r\n    var change = function(e) {\r\n        if (typeof(obj.options.onchange) == 'function') { \r\n            obj.options.onchange(el, obj, e);\r\n        }\r\n\r\n        // Update value\r\n        obj.options.value = obj.getData();\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract images from a HTML string\r\n     */\r\n    var extractImageFromHtml = function(html) {\r\n        // Create temp element\r\n        var div = document.createElement('div');\r\n        div.innerHTML = html;\r\n\r\n        // Extract images\r\n        var img = div.querySelectorAll('img');\r\n\r\n        if (img.length) {\r\n            for (var i = 0; i < img.length; i++) {\r\n                obj.addImage(img[i].src);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Insert node at caret\r\n     */\r\n    var insertNodeAtCaret = function(newNode) {\r\n        var sel, range;\r\n\r\n        if (window.getSelection) {\r\n            sel = window.getSelection();\r\n            if (sel.rangeCount) {\r\n                range = sel.getRangeAt(0);\r\n                var selectedText = range.toString();\r\n                range.deleteContents();\r\n                range.insertNode(newNode); \r\n                // move the cursor after element\r\n                range.setStartAfter(newNode);\r\n                range.setEndAfter(newNode); \r\n                sel.removeAllRanges();\r\n                sel.addRange(range);\r\n            }\r\n        }\r\n    }\r\n\r\n    var updateTotalImages = function() {\r\n        var o = null;\r\n        if (o = snippet.children[0]) {\r\n            // Make sure is a grid\r\n            if (! o.classList.contains('jslider-grid')) {\r\n                o.classList.add('jslider-grid');\r\n            }\r\n            // Quantify of images\r\n            var number = o.children.length;\r\n            // Set the configuration of the grid\r\n            o.setAttribute('data-number', number > 4 ? 4 : number);\r\n            // Total of images inside the grid\r\n            if (number > 4) {\r\n                o.setAttribute('data-total', number - 4);\r\n            } else {\r\n                o.removeAttribute('data-total');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Append image to the snippet\r\n     */\r\n    var appendImage = function(image) {\r\n        if (! snippet.innerHTML) {\r\n            appendElement({});\r\n        }\r\n        snippet.children[0].appendChild(image);\r\n        updateTotalImages();\r\n    }\r\n\r\n    /**\r\n     * Append snippet\r\n     * @Param object data\r\n     */\r\n    var appendElement = function(data) {\r\n        // Reset snippet\r\n        snippet.innerHTML = '';\r\n\r\n        // Attributes\r\n        var a = [ 'image', 'title', 'description', 'host', 'url' ];\r\n\r\n        for (var i = 0; i < a.length; i++) {\r\n            var div = document.createElement('div');\r\n            div.className = 'jsnippet-' + a[i];\r\n            div.setAttribute('data-k', a[i]);\r\n            snippet.appendChild(div);\r\n            if (data[a[i]]) {\r\n                if (a[i] == 'image') {\r\n                    if (! Array.isArray(data.image)) {\r\n                        data.image = [ data.image ];\r\n                    }\r\n                    for (var j = 0; j < data.image.length; j++) {\r\n                        var img = document.createElement('img');\r\n                        img.src = data.image[j];\r\n                        div.appendChild(img);\r\n                    }\r\n                } else {\r\n                    div.innerHTML = data[a[i]];\r\n                }\r\n            }\r\n        }\r\n\r\n        editor.appendChild(document.createElement('br'));\r\n        editor.appendChild(snippet);\r\n    }\r\n\r\n    var verifyEditor = function() {\r\n        clearTimeout(editorTimer);\r\n        editorTimer = setTimeout(function() {\r\n            var snippet = editor.querySelector('.jsnippet');\r\n            if (! snippet) {\r\n                var html = editor.innerHTML.replace(/\\n/g, ' ');\r\n                var container = document.createElement('div');\r\n                container.innerHTML = html;\r\n                var text = container.innerText; \r\n                var url = jSuites.editor.detectUrl(text);\r\n\r\n                if (url) {\r\n                    if (url[0].substr(-3) == 'jpg' || url[0].substr(-3) == 'png' || url[0].substr(-3) == 'gif') {\r\n                         obj.addImage(url[0], true);\r\n                    } else {\r\n                        var id = jSuites.editor.youtubeParser(url[0]);\r\n                        obj.parseWebsite(url[0], id);\r\n                    }\r\n                }\r\n            }\r\n        }, 1000);\r\n    }\r\n\r\n    obj.parseContent = function() {\r\n        verifyEditor();\r\n    }\r\n\r\n    obj.parseWebsite = function(url, youtubeId) {\r\n        if (! obj.options.remoteParser) {\r\n            console.log('The remoteParser is not defined');\r\n        } else {\r\n            // Youtube definitions\r\n            if (youtubeId) {\r\n                var url = 'https://www.youtube.com/watch?v=' + youtubeId;\r\n            }\r\n\r\n            var p = {\r\n                title: '',\r\n                description: '',\r\n                image: '',\r\n                host: url.split('/')[2],\r\n                url: url,\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.remoteParser + encodeURI(url.trim()),\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Get title\r\n                    if (result.title) {\r\n                        p.title = result.title;\r\n                    }\r\n                    // Description\r\n                    if (result.description) {\r\n                        p.description = result.description;\r\n                    }\r\n                    // Host\r\n                    if (result.host) {\r\n                        p.host = result.host;\r\n                    }\r\n                    // Url\r\n                    if (result.url) {\r\n                        p.url = result.url;\r\n                    }\r\n                    // Append snippet\r\n                    appendElement(p);\r\n                    // Add image\r\n                    if (result.image) {\r\n                        obj.addImage(result.image, true);\r\n                    } else if (result['og:image']) {\r\n                        obj.addImage(result['og:image'], true);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set editor value\r\n     */\r\n    obj.setData = function(html) {\r\n        editor.innerHTML = html;\r\n\r\n        if (obj.options.focus) {\r\n            jSuites.editor.setCursor(editor, true);\r\n        }\r\n\r\n        // Reset files container\r\n        files = [];\r\n    }\r\n\r\n    obj.getFiles = function() {\r\n        var f = editor.querySelectorAll('.jfile');\r\n        var d = [];\r\n        for (var i = 0; i < f.length; i++) {\r\n            if (files[f[i].src]) {\r\n                d.push(files[f[i].src]);\r\n            }\r\n        }\r\n        return d;\r\n    }\r\n\r\n    obj.getText = function() {\r\n        return editor.innerText;\r\n    }\r\n\r\n    /**\r\n     * Get editor data\r\n     */\r\n    obj.getData = function(json) {\r\n        if (! json) {\r\n            var data = editor.innerHTML;\r\n        } else {\r\n            var data = {\r\n                content : '',\r\n            }\r\n\r\n            // Get snippet\r\n            if (snippet.innerHTML) {\r\n                var index = 0;\r\n                data.snippet = {};\r\n                for (var i = 0; i < snippet.children.length; i++) {\r\n                    // Get key from element\r\n                    var key = snippet.children[i].getAttribute('data-k');\r\n                    if (key) {\r\n                        if (key == 'image') {\r\n                            if (! data.snippet.image) {\r\n                                data.snippet.image = [];\r\n                            }\r\n                            // Get all images\r\n                            for (var j = 0; j < snippet.children[i].children.length; j++) {\r\n                                data.snippet.image.push(snippet.children[i].children[j].getAttribute('src'))\r\n                            }\r\n                        } else {\r\n                            data.snippet[key] = snippet.children[i].innerHTML;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Get files\r\n            var f = Object.keys(files);\r\n            if (f.length) {\r\n                data.files = [];\r\n                for (var i = 0; i < f.length; i++) {\r\n                    data.files.push(files[f[i]]);\r\n                }\r\n            }\r\n\r\n            // Get content\r\n            var text = editor.innerHTML;\r\n            text = text.replace(/<br>/g, \"\\n\");\r\n            text = text.replace(/<\\/div>/g, \"<\\/div>\\n\");\r\n            text = text.replace(/<(?:.|\\n)*?>/gm, \"\");\r\n            data.content = text.trim();\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    // Reset\r\n    obj.reset = function() {\r\n        editor.innerHTML = '';\r\n        snippet.innerHTML = '';\r\n        files = [];\r\n    }\r\n\r\n    obj.addPdf = function(data) {\r\n        if (data.result.substr(0,4) != 'data') {\r\n            console.error('Invalid source');\r\n        } else {\r\n            var canvas = document.createElement('canvas');\r\n            canvas.width = 60;\r\n            canvas.height = 60;\r\n\r\n            var img = new Image();\r\n            var ctx = canvas.getContext('2d');\r\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n            canvas.toBlob(function(blob) {\r\n                var newImage = document.createElement('img');\r\n                newImage.src = window.URL.createObjectURL(blob);\r\n                newImage.title = data.name;\r\n                newImage.className = 'jfile pdf';\r\n\r\n                files[newImage.src] = {\r\n                    file: newImage.src,\r\n                    extension: 'pdf',\r\n                    content: data.result,\r\n                }\r\n\r\n                insertNodeAtCaret(newImage);\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.addImage = function(src, asSnippet) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                extension = extension[1];\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n            }\r\n\r\n            var img = new Image();\r\n\r\n            img.onload = function onload() {\r\n                var canvas = document.createElement('canvas');\r\n                canvas.width = img.width;\r\n                canvas.height = img.height;\r\n\r\n                var ctx = canvas.getContext('2d');\r\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                canvas.toBlob(function(blob) {\r\n                    var newImage = document.createElement('img');\r\n                    newImage.src = window.URL.createObjectURL(blob);\r\n                    newImage.classList.add('jfile');\r\n                    newImage.setAttribute('tabindex', '900');\r\n                    files[newImage.src] = {\r\n                        file: newImage.src,\r\n                        extension: extension,\r\n                        content: canvas.toDataURL(),\r\n                    }\r\n\r\n                    if (obj.options.dropAsSnippet || asSnippet) {\r\n                        appendImage(newImage);\r\n                        // Just to understand the attachment is part of a snippet\r\n                        files[newImage.src].snippet = true;\r\n                    } else {\r\n                        insertNodeAtCaret(newImage);\r\n                    }\r\n\r\n                    change();\r\n                });\r\n            };\r\n\r\n            img.src = src;\r\n        }\r\n    }\r\n\r\n    obj.addFile = function(files) {\r\n        var reader = [];\r\n\r\n        for (var i = 0; i < files.length; i++) {\r\n            if (files[i].size > obj.options.maxFileSize) {\r\n                alert('The file is too big');\r\n            } else {\r\n                // Only PDF or Images\r\n                var type = files[i].type.split('/');\r\n\r\n                if (type[0] == 'image') {\r\n                    type = 1;\r\n                } else if (type[1] == 'pdf') {\r\n                    type = 2;\r\n                } else {\r\n                    type = 0;\r\n                }\r\n\r\n                if (type) {\r\n                    // Create file\r\n                    reader[i] = new FileReader();\r\n                    reader[i].index = i;\r\n                    reader[i].type = type;\r\n                    reader[i].name = files[i].name;\r\n                    reader[i].date = files[i].lastModified;\r\n                    reader[i].size = files[i].size;\r\n                    reader[i].addEventListener(\"load\", function (data) {\r\n                        // Get result\r\n                        if (data.target.type == 2) {\r\n                            if (obj.options.acceptFiles == true) {\r\n                                obj.addPdf(data.target);\r\n                            }\r\n                        } else {\r\n                            obj.addImage(data.target.result);\r\n                        }\r\n                    }, false);\r\n\r\n                    reader[i].readAsDataURL(files[i])\r\n                } else {\r\n                    alert('The extension is not allowed');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Destroy\r\n    obj.destroy = function() {\r\n        editor.removeEventListener('mouseup', editorMouseUp);\r\n        editor.removeEventListener('mousedown', editorMouseDown);\r\n        editor.removeEventListener('mousemove', editorMouseMove);\r\n        editor.removeEventListener('keyup', editorKeyUp);\r\n        editor.removeEventListener('keydown', editorKeyDown);\r\n        editor.removeEventListener('dragstart', editorDragStart);\r\n        editor.removeEventListener('dragenter', editorDragEnter);\r\n        editor.removeEventListener('dragover', editorDragOver);\r\n        editor.removeEventListener('drop', editorDrop);\r\n        editor.removeEventListener('paste', editorPaste);\r\n\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            editor.removeEventListener('blur', editorBlur);\r\n        }\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            editor.removeEventListener('focus', editorFocus);\r\n        }\r\n\r\n        el.editor = null;\r\n        el.classList.remove('jeditor-container');\r\n\r\n        toolbar.remove();\r\n        snippet.remove();\r\n        editor.remove();\r\n    }\r\n\r\n    var isLetter = function (str) {\r\n        var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]+)/g;\r\n        return str.match(regex) ? 1 : 0;\r\n    }\r\n\r\n    // Event handlers\r\n    var editorMouseUp = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            editorAction.e.classList.remove('resizing');\r\n        }\r\n\r\n        editorAction = false;\r\n    }\r\n\r\n    var editorMouseDown = function(e) {\r\n        var close = function(snippet) {\r\n            var rect = snippet.getBoundingClientRect();\r\n            if (rect.width - (e.clientX - rect.left) < 40 && e.clientY - rect.top < 40) {\r\n                snippet.innerHTML = '';\r\n                snippet.remove();\r\n            }\r\n        }\r\n\r\n        if (e.target.tagName == 'IMG') {\r\n            if (e.target.style.cursor) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                editorAction = {\r\n                    e: e.target,\r\n                    x: e.clientX,\r\n                    y: e.clientY,\r\n                    w: rect.width,\r\n                    h: rect.height,\r\n                    d: e.target.style.cursor,\r\n                }\r\n\r\n                if (! e.target.width) {\r\n                    e.target.width = rect.width + 'px';\r\n                }\r\n\r\n                if (! e.target.height) {\r\n                    e.target.height = rect.height + 'px';\r\n                }\r\n\r\n                var s = window.getSelection();\r\n                if (s.rangeCount) {\r\n                    for (var i = 0; i < s.rangeCount; i++) {\r\n                        s.removeRange(s.getRangeAt(i));\r\n                    }\r\n                }\r\n\r\n                e.target.classList.add('resizing');\r\n            } else {\r\n                editorAction = true;\r\n            }\r\n        } else { \r\n            if (e.target.classList.contains('jsnippet')) {\r\n                close(e.target);\r\n            } else if (e.target.parentNode.classList.contains('jsnippet')) {\r\n                close(e.target.parentNode);\r\n            }\r\n\r\n            editorAction = true;\r\n        }\r\n    }\r\n\r\n    var editorMouseMove = function(e) {\r\n        if (e.target.tagName == 'IMG' && ! e.target.parentNode.classList.contains('jsnippet-image') && obj.options.allowImageResize == true) {\r\n            if (e.target.getAttribute('tabindex')) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                if (e.clientY - rect.top < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'ne-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'nw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 'n-resize';\r\n                    }\r\n                } else if (rect.height - (e.clientY - rect.top) < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'se-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'sw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 's-resize';\r\n                    }\r\n                } else if (rect.width - (e.clientX - rect.left) < 5) {\r\n                    e.target.style.cursor = 'e-resize';\r\n                } else if (e.clientX - rect.left < 5) {\r\n                    e.target.style.cursor = 'w-resize';\r\n                } else {\r\n                    e.target.style.cursor = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Move\r\n        if (e.which == 1 && editorAction && editorAction.d) {\r\n            if (editorAction.d == 'e-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'se-resize') {\r\n                editorAction.e.width = (editorAction.w + (e.clientX - editorAction.x));\r\n\r\n                if (e.shiftKey) {\r\n                    var newHeight = (e.clientX - editorAction.x) * (editorAction.h / editorAction.w);\r\n                    editorAction.e.height = editorAction.h + newHeight;\r\n                } else {\r\n                    var newHeight =  null;\r\n                }\r\n            }\r\n\r\n            if (! newHeight) {\r\n                if (editorAction.d == 's-resize' || editorAction.d == 'se-resize' || editorAction.d == 'sw-resize') {\r\n                    if (! e.shiftKey) {\r\n                        editorAction.e.height = editorAction.h + (e.clientY - editorAction.y);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    var editorKeyUp = function(e) {\r\n        if (! editor.innerHTML) {\r\n            editor.innerHTML = '<div><br></div>';\r\n        }\r\n\r\n        if (typeof(obj.options.onkeyup) == 'function') { \r\n            obj.options.onkeyup(el, obj, e);\r\n        }\r\n    }\r\n\r\n\r\n    var editorKeyDown = function(e) {\r\n        // Check for URL\r\n        if (obj.options.parseURL == true) {\r\n            verifyEditor();\r\n        }\r\n\r\n        if (typeof(obj.options.onkeydown) == 'function') { \r\n            obj.options.onkeydown(el, obj, e);\r\n        }\r\n\r\n        if (e.key == 'Delete') {\r\n            if (e.target.tagName == 'IMG' && e.target.parentNode.classList.contains('jsnippet-image')) {\r\n                e.target.remove();\r\n                updateTotalImages();\r\n            }\r\n        }\r\n    }\r\n\r\n    // Elements to be removed\r\n    var remove = [HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement];\r\n\r\n    // Valid CSS attributes\r\n    var validStyle = ['color', 'font-weight', 'font-size', 'background', 'background-color', 'margin'];\r\n\r\n    var parse = function(element) {\r\n       // Remove attributes\r\n       if (element.attributes && element.attributes.length) {\r\n           var image = null;\r\n           var style = null;\r\n           // Process style attribute\r\n           var elementStyle = element.getAttribute('style');\r\n           if (elementStyle) {\r\n               style = [];\r\n               var t = elementStyle.split(';');\r\n               for (var j = 0; j < t.length; j++) {\r\n                   var v = t[j].trim().split(':');\r\n                   if (validStyle.indexOf(v[0].trim()) >= 0) {\r\n                       var k = v.shift();\r\n                       var v = v.join(':');\r\n                       style.push(k + ':' + v);\r\n                   }\r\n               }\r\n           }\r\n           // Process image\r\n           if (element.tagName.toUpperCase() == 'IMG') {\r\n               if (! obj.options.acceptImages) {\r\n                   element.parentNode.removeChild(element);\r\n               } else {\r\n                   // Check if is data\r\n                   element.setAttribute('tabindex', '900');\r\n                   // Check attributes for persistance\r\n                   obj.addImage(element.src);\r\n               }\r\n           } else {\r\n               // Remove attributes\r\n               var numAttributes = element.attributes.length - 1;\r\n               for (var i = numAttributes; i >= 0 ; i--) {\r\n                   element.removeAttribute(element.attributes[i].name);\r\n               }\r\n           }\r\n           element.style = '';\r\n           // Add valid style\r\n           if (style && style.length) {\r\n               element.setAttribute('style', style.join(';'));\r\n           }\r\n       }\r\n       // Parse children\r\n       if (element.children.length) {\r\n           for (var i = 0; i < element.children.length; i++) {\r\n               parse(element.children[i]);\r\n           }\r\n       }\r\n\r\n       if (remove.indexOf(element.constructor) >= 0) {\r\n           element.remove();\r\n       }\r\n    }\r\n\r\n    var filter = function(data) {\r\n        if (data) {\r\n            data = data.replace(new RegExp('<!--(.*?)-->', 'gsi'), '');\r\n        }\r\n        var parser = new DOMParser();\r\n        var d = parser.parseFromString(data, \"text/html\");\r\n        parse(d);\r\n        var span = document.createElement('span');\r\n        span.innerHTML = d.firstChild.innerHTML;\r\n        return span;\r\n    } \r\n\r\n    var editorPaste = function(e) {\r\n        if (obj.options.filterPaste == true) {\r\n            if (e.clipboardData || e.originalEvent.clipboardData) {\r\n                var html = (e.originalEvent || e).clipboardData.getData('text/html');\r\n                var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n                var file = (e.originalEvent || e).clipboardData.files\r\n            } else if (window.clipboardData) {\r\n                var html = window.clipboardData.getData('Html');\r\n                var text = window.clipboardData.getData('Text');\r\n                var file = window.clipboardData.files\r\n            }\r\n\r\n            if (file.length) {\r\n                // Paste a image from the clipboard\r\n                obj.addFile(file);\r\n            } else {\r\n                if (! html) {\r\n                    html = text.split('\\r\\n');\r\n                    if (! e.target.innerText) {\r\n                        html.map(function(v) {\r\n                            var d = document.createElement('div');\r\n                            d.innerText = v;\r\n                            editor.appendChild(d);\r\n                        });\r\n                    } else {\r\n                        html = html.map(function(v) {\r\n                            return '<div>' + v + '</div>';\r\n                        });\r\n                        document.execCommand('insertHtml', false, html.join(''));\r\n                    }\r\n                } else {\r\n                    var d = filter(html);\r\n                    // Paste to the editor\r\n                    insertNodeAtCaret(d);\r\n                }\r\n            }\r\n\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragStart = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragEnter = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            el.classList.add('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragOver = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            if (editorTimer) {\r\n                clearTimeout(editorTimer);\r\n            }\r\n\r\n            editorTimer = setTimeout(function() {\r\n                el.classList.remove('jeditor-dragging');\r\n            }, 100);\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDrop = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            // Position caret on the drop\r\n            var range = null;\r\n            if (document.caretRangeFromPoint) {\r\n                range=document.caretRangeFromPoint(e.clientX, e.clientY);\r\n            } else if (e.rangeParent) {\r\n                range=document.createRange();\r\n                range.setStart(e.rangeParent,e.rangeOffset);\r\n            }\r\n            var sel = window.getSelection();\r\n            sel.removeAllRanges();\r\n            sel.addRange(range);\r\n            sel.anchorNode.parentNode.focus();\r\n\r\n            var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n            var text = (e.originalEvent || e).dataTransfer.getData('text/plain');\r\n            var file = (e.originalEvent || e).dataTransfer.files;\r\n    \r\n            if (file.length) {\r\n                obj.addFile(file);\r\n            } else if (text) {\r\n                extractImageFromHtml(html);\r\n            }\r\n\r\n            el.classList.remove('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorBlur = function(e) {\r\n        // Blur\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            obj.options.onblur(el, obj, e);\r\n        }\r\n\r\n        change(e);\r\n    }\r\n\r\n    var editorFocus = function(e) {\r\n        // Focus\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            obj.options.onfocus(el, obj, e);\r\n        }\r\n    }\r\n\r\n    editor.addEventListener('mouseup', editorMouseUp);\r\n    editor.addEventListener('mousedown', editorMouseDown);\r\n    editor.addEventListener('mousemove', editorMouseMove);\r\n    editor.addEventListener('keyup', editorKeyUp);\r\n    editor.addEventListener('keydown', editorKeyDown);\r\n    editor.addEventListener('dragstart', editorDragStart);\r\n    editor.addEventListener('dragenter', editorDragEnter);\r\n    editor.addEventListener('dragover', editorDragOver);\r\n    editor.addEventListener('drop', editorDrop);\r\n    editor.addEventListener('paste', editorPaste);\r\n    editor.addEventListener('focus', editorFocus);\r\n    editor.addEventListener('blur', editorBlur);\r\n\r\n    // Onload\r\n    if (typeof(obj.options.onload) == 'function') {\r\n        obj.options.onload(el, obj, editor);\r\n    }\r\n\r\n    // Set value to the editor\r\n    editor.innerHTML = value;\r\n\r\n    // Append editor to the containre\r\n    el.appendChild(editor);\r\n\r\n    // Snippet\r\n    if (obj.options.snippet) {\r\n        appendElement(obj.options.snippet);\r\n    }\r\n\r\n    // Default toolbar\r\n    if (obj.options.toolbar == null) {\r\n        obj.options.toolbar = jSuites.editor.getDefaultToolbar();\r\n    }\r\n\r\n    // Add toolbar\r\n    if (obj.options.toolbar) {\r\n        // Append to the DOM\r\n        el.appendChild(toolbar);\r\n        // Create toolbar\r\n        jSuites.toolbar(toolbar, {\r\n            container: true,\r\n            responsive: true,\r\n            items: obj.options.toolbar\r\n        });\r\n    }\r\n\r\n    // Focus to the editor\r\n    if (obj.options.focus) {\r\n        jSuites.editor.setCursor(editor, obj.options.focus == 'initial' ? true : false);\r\n    }\r\n\r\n    // Change method\r\n    el.change = obj.setData;\r\n\r\n    // Global generic value handler\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            // Data type\r\n            var o = el.getAttribute('data-html') === 'true' ? false : true;\r\n            return obj.getData(o);\r\n        } else {\r\n            obj.setData(val);\r\n        }\r\n    }\r\n\r\n    el.editor = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.editor.setCursor = function(element, first) {\r\n    element.focus();\r\n    document.execCommand('selectAll');\r\n    var sel = window.getSelection();\r\n    var range = sel.getRangeAt(0);\r\n    if (first == true) {\r\n        var node = range.startContainer;\r\n        var size = 0;\r\n    } else {\r\n        var node = range.endContainer;\r\n        var size = node.length;\r\n    }\r\n    range.setStart(node, size);\r\n    range.setEnd(node, size);\r\n    sel.removeAllRanges();\r\n    sel.addRange(range);\r\n}\r\n\r\njSuites.editor.getDomain = function(url) {\r\n    return url.replace('http://','').replace('https://','').replace('www.','').split(/[/?#]/)[0].split(/:/g)[0];\r\n}\r\n\r\njSuites.editor.detectUrl = function(text) {\r\n    var expression = /(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig;\r\n    var links = text.match(expression);\r\n\r\n    if (links) {\r\n        if (links[0].substr(0,3) == 'www') {\r\n            links[0] = 'http://' + links[0];\r\n        }\r\n    }\r\n\r\n    return links;\r\n}\r\n\r\njSuites.editor.youtubeParser = function(url) {\r\n    var regExp = /^.*((youtu.be\\/)|(v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#\\&\\?]*).*/;\r\n    var match = url.match(regExp);\r\n\r\n    return (match && match[7].length == 11) ? match[7] : false;\r\n}\r\n\r\njSuites.editor.getDefaultToolbar = function() { \r\n    return [\r\n        {\r\n            content: 'undo',\r\n            onclick: function() {\r\n                document.execCommand('undo');\r\n            }\r\n        },\r\n        {\r\n            content: 'redo',\r\n            onclick: function() {\r\n                document.execCommand('redo');\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_bold',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('bold');\r\n\r\n                if (document.queryCommandState(\"bold\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_italic',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('italic');\r\n\r\n                if (document.queryCommandState(\"italic\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_underline',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('underline');\r\n\r\n                if (document.queryCommandState(\"underline\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_list_bulleted',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_list_numbered',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertOrderedList');\r\n\r\n                if (document.queryCommandState(\"insertOrderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_increase',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('indent', true, null);\r\n\r\n                if (document.queryCommandState(\"indent\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_decrease',\r\n            onclick: function() {\r\n                document.execCommand('outdent');\r\n\r\n                if (document.queryCommandState(\"outdent\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }/*,\r\n        {\r\n            icon: ['format_align_left', 'format_align_right', 'format_align_center'],\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }\r\n        {\r\n            type:'select',\r\n            items: ['Verdana','Arial','Courier New'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            type:'select',\r\n            items: ['10px','12px','14px','16px','18px','20px','22px'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_left',\r\n            onclick: function() {\r\n                document.execCommand('JustifyLeft');\r\n\r\n                if (document.queryCommandState(\"JustifyLeft\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_center',\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_right',\r\n            onclick: function() {\r\n                document.execCommand('justifyRight');\r\n\r\n                if (document.queryCommandState(\"justifyRight\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_justify',\r\n            onclick: function() {\r\n                document.execCommand('justifyFull');\r\n\r\n                if (document.queryCommandState(\"justifyFull\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_list_bulleted',\r\n            onclick: function() {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }*/\r\n    ];\r\n}\r\n\r\n\r\njSuites.form = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: null,\r\n        message: 'Are you sure? There are unsaved information in your form',\r\n        ignore: false,\r\n        currentHash: null,\r\n        submitButton:null,\r\n        validations: null,\r\n        onbeforeload: null,\r\n        onload: null,\r\n        onbeforesave: null,\r\n        onsave: null,\r\n        onbeforeremove: null,\r\n        onremove: null,\r\n        onerror: function(el, message) {\r\n            jSuites.alert(message);\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Validations\r\n    if (! obj.options.validations) {\r\n        obj.options.validations = {};\r\n    }\r\n\r\n    // Submit Button\r\n    if (! obj.options.submitButton) {\r\n        obj.options.submitButton = el.querySelector('input[type=submit]');\r\n    }\r\n\r\n    if (obj.options.submitButton && obj.options.url) {\r\n        obj.options.submitButton.onclick = function() {\r\n            obj.save();\r\n        }\r\n    }\r\n\r\n    if (! obj.options.validations.email) {\r\n        obj.options.validations.email = jSuites.validations.email;\r\n    }\r\n\r\n    if (! obj.options.validations.length) {\r\n        obj.options.validations.length = jSuites.validations.length;\r\n    }\r\n\r\n    if (! obj.options.validations.required) {\r\n        obj.options.validations.required = jSuites.validations.required;\r\n    }\r\n\r\n    obj.setUrl = function(url) {\r\n        obj.options.url = url;\r\n    }\r\n\r\n    obj.load = function() {\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'json',\r\n            queue: true,\r\n            success: function(data) {\r\n                // Overwrite values from the backend\r\n                if (typeof(obj.options.onbeforeload) == 'function') {\r\n                    var ret = obj.options.onbeforeload(el, data);\r\n                    if (ret) {\r\n                        data = ret;\r\n                    }\r\n                }\r\n                // Apply values to the form\r\n                jSuites.form.setElements(el, data);\r\n                // Onload methods\r\n                if (typeof(obj.options.onload) == 'function') {\r\n                    obj.options.onload(el, data);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    obj.save = function() {\r\n        var test = obj.validate();\r\n\r\n        if (test) {\r\n            obj.options.onerror(el, test);\r\n        } else {\r\n            var data = jSuites.form.getElements(el, true);\r\n\r\n            if (typeof(obj.options.onbeforesave) == 'function') {\r\n                var data = obj.options.onbeforesave(el, data);\r\n\r\n                if (data === false) {\r\n                    return; \r\n                }\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'POST',\r\n                dataType: 'json',\r\n                data: data,\r\n                success: function(result) {\r\n                    if (typeof(obj.options.onsave) == 'function') {\r\n                        obj.options.onsave(el, data, result);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.remove = function() {\r\n        if (typeof(obj.options.onbeforeremove) == 'function') {\r\n            var ret = obj.options.onbeforeremove(el, obj);\r\n            if (ret === false) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'DELETE',\r\n            dataType: 'json',\r\n            success: function(result) {\r\n                if (typeof(obj.options.onremove) == 'function') {\r\n                    obj.options.onremove(el, obj, result);\r\n                }\r\n\r\n                obj.reset();\r\n            }\r\n        });\r\n    }\r\n\r\n    var addError = function(element) {\r\n        // Add error in the element\r\n        element.classList.add('error');\r\n        // Submit button\r\n        if (obj.options.submitButton) {\r\n            obj.options.submitButton.setAttribute('disabled', true);\r\n        }\r\n        // Return error message\r\n        var error = element.getAttribute('data-error') || 'There is an error in the form';\r\n        element.setAttribute('title', error);\r\n        return error;\r\n    }\r\n\r\n    var delError = function(element) {\r\n        var error = false;\r\n        // Remove class from this element\r\n        element.classList.remove('error');\r\n        element.removeAttribute('title');\r\n        // Get elements in the form\r\n        var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n        // Run all elements \r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (elements[i].getAttribute('data-validation')) {\r\n                if (elements[i].classList.contains('error')) {\r\n                    error = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (obj.options.submitButton) {\r\n            if (error) {\r\n                obj.options.submitButton.setAttribute('disabled', true);\r\n            } else {\r\n                obj.options.submitButton.removeAttribute('disabled');\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.validateElement = function(element) {\r\n        // Test results\r\n        var test = false;\r\n        // Value\r\n        var value = jSuites.form.getValue(element);\r\n        // Validation\r\n        var validation = element.getAttribute('data-validation');\r\n        // Parse\r\n        if (typeof(obj.options.validations[validation]) == 'function' && ! obj.options.validations[validation](value, element)) {\r\n            // Not passed in the test\r\n            test = addError(element);\r\n        } else {\r\n            if (element.classList.contains('error')) {\r\n                delError(element);\r\n            }\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    obj.reset = function() {\r\n        // Get elements in the form\r\n        var name = null;\r\n        var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n        // Run all elements \r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (name = elements[i].getAttribute('name')) {\r\n                if (elements[i].type == 'checkbox' || elements[i].type == 'radio') {\r\n                    elements[i].checked = false;\r\n                } else {\r\n                    if (typeof(elements[i].val) == 'function') {\r\n                        elements[i].val('');\r\n                    } else {\r\n                        elements[i].value = '';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Run form validation\r\n    obj.validate = function() {\r\n        var test = [];\r\n        // Get elements in the form\r\n        var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n        // Run all elements \r\n        for (var i = 0; i < elements.length; i++) {\r\n            // Required\r\n            if (elements[i].getAttribute('data-validation')) {\r\n                var res = obj.validateElement(elements[i]);\r\n                if (res) {\r\n                    test.push(res);\r\n                }\r\n            }\r\n        }\r\n        if (test.length > 0) {\r\n            return test.join('<br>');\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // Check the form\r\n    obj.getError = function() {\r\n        // Validation\r\n        return obj.validation() ? true : false;\r\n    }\r\n\r\n    // Return the form hash\r\n    obj.setHash = function() {\r\n        return obj.getHash(jSuites.form.getElements(el));\r\n    }\r\n\r\n    // Get the form hash\r\n    obj.getHash = function(str) {\r\n        var hash = 0, i, chr;\r\n\r\n        if (str.length === 0) {\r\n            return hash;\r\n        } else {\r\n            for (i = 0; i < str.length; i++) {\r\n              chr = str.charCodeAt(i);\r\n              hash = ((hash << 5) - hash) + chr;\r\n              hash |= 0;\r\n            }\r\n        }\r\n\r\n        return hash;\r\n    }\r\n\r\n    // Is there any change in the form since start tracking?\r\n    obj.isChanged = function() {\r\n        var hash = obj.setHash();\r\n        return (obj.options.currentHash != hash);\r\n    }\r\n\r\n    // Restart tracking\r\n    obj.resetTracker = function() {\r\n        obj.options.currentHash = obj.setHash();\r\n        obj.options.ignore = false;\r\n    }\r\n\r\n    // Ignore flag\r\n    obj.setIgnore = function(ignoreFlag) {\r\n        obj.options.ignore = ignoreFlag ? true : false;\r\n    }\r\n\r\n    // Start tracking in one second\r\n    setTimeout(function() {\r\n        obj.options.currentHash = obj.setHash();\r\n    }, 1000);\r\n\r\n    // Validations\r\n    el.addEventListener(\"keyup\", function(e) {\r\n        if (e.target.getAttribute('data-validation')) {\r\n            obj.validateElement(e.target);\r\n        }\r\n    });\r\n\r\n    // Alert\r\n    if (! jSuites.form.hasEvents) {\r\n        window.addEventListener(\"beforeunload\", function (e) {\r\n            if (obj.isChanged() && obj.options.ignore == false) {\r\n                var confirmationMessage =  obj.options.message? obj.options.message : \"\\o/\";\r\n\r\n                if (confirmationMessage) {\r\n                    if (typeof e == 'undefined') {\r\n                        e = window.event;\r\n                    }\r\n\r\n                    if (e) {\r\n                        e.returnValue = confirmationMessage;\r\n                    }\r\n\r\n                    return confirmationMessage;\r\n                } else {\r\n                    return void(0);\r\n                }\r\n            }\r\n        });\r\n\r\n        jSuites.form.hasEvents = true;\r\n    }\r\n\r\n    el.form = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n// Get value from one element\r\njSuites.form.getValue = function(element) {\r\n    var value = null;\r\n    if (element.type == 'checkbox') {\r\n        if (element.checked == true) {\r\n            value = element.value || true;\r\n        }\r\n    } else if (element.type == 'radio') {\r\n        if (element.checked == true) {\r\n            value = element.value;\r\n        }\r\n    } else if (element.tagName == 'select' && element.multiple == true) {\r\n        value = [];\r\n        var options = element.querySelectorAll(\"options[selected]\");\r\n        for (var j = 0; j < options.length; j++) {\r\n            value.push(options[j].value);\r\n        }\r\n    } else if (typeof(element.val) == 'function') {\r\n        value = element.val();\r\n    } else {\r\n        value = element.value || '';\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n// Get form elements\r\njSuites.form.getElements = function(el, asArray) {\r\n    var data = {};\r\n    var name = null;\r\n    var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n\r\n    for (var i = 0; i < elements.length; i++) {\r\n        if (name = elements[i].getAttribute('name')) {\r\n            data[name] = jSuites.form.getValue(elements[i]) || '';\r\n        }\r\n    }\r\n\r\n    return asArray == true ? data : JSON.stringify(data);\r\n}\r\n\r\n//Get form elements\r\njSuites.form.setElements = function(el, data) {\r\n    var name = null;\r\n    var value = null;\r\n    var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n    for (var i = 0; i < elements.length; i++) {\r\n        // Attributes\r\n        var type = elements[i].getAttribute('type');\r\n        if (name = elements[i].getAttribute('name')) {\r\n            // Transform variable names in pathname\r\n            name = name.replace(new RegExp(/\\[(.*?)\\]/ig), '.$1');\r\n            value = null;\r\n            // Seach for the data in the path\r\n            if (name.match(/\\./)) {\r\n                var tmp = jSuites.path.call(data, name) || '';\r\n                if (typeof(tmp) !== 'undefined') {\r\n                    value = tmp;\r\n                }\r\n            } else {\r\n                if (typeof(data[name]) !== 'undefined') {\r\n                    value = data[name];\r\n                }\r\n            }\r\n            // Set the values\r\n            if (value !== null) {\r\n                if (type == 'checkbox' || type == 'radio') {\r\n                    elements[i].checked = value ? true : false;\r\n                } else {\r\n                    if (typeof (elements[i].val) == 'function') {\r\n                        elements[i].val(value);\r\n                    } else {\r\n                        elements[i].value = value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// Legacy\r\njSuites.tracker = jSuites.form;\r\n\r\njSuites.focus = function(el) {\r\n    if (el.innerText.length) {\r\n        var range = document.createRange();\r\n        var sel = window.getSelection();\r\n        var node = el.childNodes[el.childNodes.length-1];\r\n        range.setStart(node, node.length)\r\n        range.collapse(true)\r\n        sel.removeAllRanges()\r\n        sel.addRange(range)\r\n        el.scrollLeft = el.scrollWidth;\r\n    }\r\n}\r\n\r\njSuites.isNumeric = (function (num) {\r\n    return !isNaN(num) && num !== null && num !== '';\r\n});\r\n\r\njSuites.guid = function() {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n        return v.toString(16);\r\n    });\r\n}\r\n\r\njSuites.getNode = function() {\r\n    var node = document.getSelection().anchorNode;\r\n    if (node) {\r\n        return (node.nodeType == 3 ? node.parentNode : node);\r\n    } else {\r\n        return null;\r\n    }\r\n}\r\n/**\r\n * Generate hash from a string\r\n */\r\njSuites.hash = function(str) {\r\n    var hash = 0, i, chr;\r\n\r\n    if (str.length === 0) {\r\n        return hash;\r\n    } else {\r\n        for (i = 0; i < str.length; i++) {\r\n            chr = str.charCodeAt(i);\r\n            if (chr > 32) {\r\n                hash = ((hash << 5) - hash) + chr;\r\n                hash |= 0;\r\n            }\r\n        }\r\n    }\r\n    return hash;\r\n}\r\n\r\n/**\r\n * Generate a random color\r\n */\r\njSuites.randomColor = function(h) {\r\n    var lum = -0.25;\r\n    var hex = String('#' + Math.random().toString(16).slice(2, 8).toUpperCase()).replace(/[^0-9a-f]/gi, '');\r\n    if (hex.length < 6) {\r\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\r\n    }\r\n    var rgb = [], c, i;\r\n    for (i = 0; i < 3; i++) {\r\n        c = parseInt(hex.substr(i * 2, 2), 16);\r\n        c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);\r\n        rgb.push((\"00\" + c).substr(c.length));\r\n    }\r\n\r\n    // Return hex\r\n    if (h == true) {\r\n        return '#' + jSuites.two(rgb[0].toString(16)) + jSuites.two(rgb[1].toString(16)) + jSuites.two(rgb[2].toString(16));\r\n    }\r\n\r\n    return rgb;\r\n}\r\n\r\njSuites.getWindowWidth = function() {\r\n    var w = window,\r\n    d = document,\r\n    e = d.documentElement,\r\n    g = d.getElementsByTagName('body')[0],\r\n    x = w.innerWidth || e.clientWidth || g.clientWidth;\r\n    return x;\r\n}\r\n\r\njSuites.getWindowHeight = function() {\r\n    var w = window,\r\n    d = document,\r\n    e = d.documentElement,\r\n    g = d.getElementsByTagName('body')[0],\r\n    y = w.innerHeight|| e.clientHeight|| g.clientHeight;\r\n    return  y;\r\n}\r\n\r\njSuites.getPosition = function(e) {\r\n    if (e.changedTouches && e.changedTouches[0]) {\r\n        var x = e.changedTouches[0].pageX;\r\n        var y = e.changedTouches[0].pageY;\r\n    } else {\r\n        var x = (window.Event) ? e.pageX : e.clientX + (document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft);\r\n        var y = (window.Event) ? e.pageY : e.clientY + (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop);\r\n    }\r\n\r\n    return [ x, y ];\r\n}\r\n\r\njSuites.click = function(el) {\r\n    if (el.click) {\r\n        el.click();\r\n    } else {\r\n        var evt = new MouseEvent('click', {\r\n            bubbles: true,\r\n            cancelable: true,\r\n            view: window\r\n        });\r\n        el.dispatchEvent(evt);\r\n    }\r\n}\r\n\r\njSuites.findElement = function(element, condition) {\r\n    var foundElement = false;\r\n\r\n    function path (element) {\r\n        if (element && ! foundElement) {\r\n            if (typeof(condition) == 'function') {\r\n                foundElement = condition(element)\r\n            } else if (typeof(condition) == 'string') {\r\n                if (element.classList && element.classList.contains(condition)) {\r\n                    foundElement = element;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (element.parentNode && ! foundElement) {\r\n            path(element.parentNode);\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return foundElement;\r\n}\r\n\r\n// Two digits\r\njSuites.two = function(value) {\r\n    value = '' + value;\r\n    if (value.length == 1) {\r\n        value = '0' + value;\r\n    }\r\n    return value;\r\n}\r\n\r\njSuites.sha512 = (function(str) {\r\n    function int64(msint_32, lsint_32) {\r\n        this.highOrder = msint_32;\r\n        this.lowOrder = lsint_32;\r\n    }\r\n\r\n    var H = [new int64(0x6a09e667, 0xf3bcc908), new int64(0xbb67ae85, 0x84caa73b),\r\n        new int64(0x3c6ef372, 0xfe94f82b), new int64(0xa54ff53a, 0x5f1d36f1),\r\n        new int64(0x510e527f, 0xade682d1), new int64(0x9b05688c, 0x2b3e6c1f),\r\n        new int64(0x1f83d9ab, 0xfb41bd6b), new int64(0x5be0cd19, 0x137e2179)];\r\n\r\n    var K = [new int64(0x428a2f98, 0xd728ae22), new int64(0x71374491, 0x23ef65cd),\r\n        new int64(0xb5c0fbcf, 0xec4d3b2f), new int64(0xe9b5dba5, 0x8189dbbc),\r\n        new int64(0x3956c25b, 0xf348b538), new int64(0x59f111f1, 0xb605d019),\r\n        new int64(0x923f82a4, 0xaf194f9b), new int64(0xab1c5ed5, 0xda6d8118),\r\n        new int64(0xd807aa98, 0xa3030242), new int64(0x12835b01, 0x45706fbe),\r\n        new int64(0x243185be, 0x4ee4b28c), new int64(0x550c7dc3, 0xd5ffb4e2),\r\n        new int64(0x72be5d74, 0xf27b896f), new int64(0x80deb1fe, 0x3b1696b1),\r\n        new int64(0x9bdc06a7, 0x25c71235), new int64(0xc19bf174, 0xcf692694),\r\n        new int64(0xe49b69c1, 0x9ef14ad2), new int64(0xefbe4786, 0x384f25e3),\r\n        new int64(0x0fc19dc6, 0x8b8cd5b5), new int64(0x240ca1cc, 0x77ac9c65),\r\n        new int64(0x2de92c6f, 0x592b0275), new int64(0x4a7484aa, 0x6ea6e483),\r\n        new int64(0x5cb0a9dc, 0xbd41fbd4), new int64(0x76f988da, 0x831153b5),\r\n        new int64(0x983e5152, 0xee66dfab), new int64(0xa831c66d, 0x2db43210),\r\n        new int64(0xb00327c8, 0x98fb213f), new int64(0xbf597fc7, 0xbeef0ee4),\r\n        new int64(0xc6e00bf3, 0x3da88fc2), new int64(0xd5a79147, 0x930aa725),\r\n        new int64(0x06ca6351, 0xe003826f), new int64(0x14292967, 0x0a0e6e70),\r\n        new int64(0x27b70a85, 0x46d22ffc), new int64(0x2e1b2138, 0x5c26c926),\r\n        new int64(0x4d2c6dfc, 0x5ac42aed), new int64(0x53380d13, 0x9d95b3df),\r\n        new int64(0x650a7354, 0x8baf63de), new int64(0x766a0abb, 0x3c77b2a8),\r\n        new int64(0x81c2c92e, 0x47edaee6), new int64(0x92722c85, 0x1482353b),\r\n        new int64(0xa2bfe8a1, 0x4cf10364), new int64(0xa81a664b, 0xbc423001),\r\n        new int64(0xc24b8b70, 0xd0f89791), new int64(0xc76c51a3, 0x0654be30),\r\n        new int64(0xd192e819, 0xd6ef5218), new int64(0xd6990624, 0x5565a910),\r\n        new int64(0xf40e3585, 0x5771202a), new int64(0x106aa070, 0x32bbd1b8),\r\n        new int64(0x19a4c116, 0xb8d2d0c8), new int64(0x1e376c08, 0x5141ab53),\r\n        new int64(0x2748774c, 0xdf8eeb99), new int64(0x34b0bcb5, 0xe19b48a8),\r\n        new int64(0x391c0cb3, 0xc5c95a63), new int64(0x4ed8aa4a, 0xe3418acb),\r\n        new int64(0x5b9cca4f, 0x7763e373), new int64(0x682e6ff3, 0xd6b2b8a3),\r\n        new int64(0x748f82ee, 0x5defb2fc), new int64(0x78a5636f, 0x43172f60),\r\n        new int64(0x84c87814, 0xa1f0ab72), new int64(0x8cc70208, 0x1a6439ec),\r\n        new int64(0x90befffa, 0x23631e28), new int64(0xa4506ceb, 0xde82bde9),\r\n        new int64(0xbef9a3f7, 0xb2c67915), new int64(0xc67178f2, 0xe372532b),\r\n        new int64(0xca273ece, 0xea26619c), new int64(0xd186b8c7, 0x21c0c207),\r\n        new int64(0xeada7dd6, 0xcde0eb1e), new int64(0xf57d4f7f, 0xee6ed178),\r\n        new int64(0x06f067aa, 0x72176fba), new int64(0x0a637dc5, 0xa2c898a6),\r\n        new int64(0x113f9804, 0xbef90dae), new int64(0x1b710b35, 0x131c471b),\r\n        new int64(0x28db77f5, 0x23047d84), new int64(0x32caab7b, 0x40c72493),\r\n        new int64(0x3c9ebe0a, 0x15c9bebc), new int64(0x431d67c4, 0x9c100d4c),\r\n        new int64(0x4cc5d4be, 0xcb3e42b6), new int64(0x597f299c, 0xfc657e2a),\r\n        new int64(0x5fcb6fab, 0x3ad6faec), new int64(0x6c44198c, 0x4a475817)];\r\n\r\n    var W = new Array(64);\r\n    var a, b, c, d, e, f, g, h, i, j;\r\n    var T1, T2;\r\n    var charsize = 8;\r\n\r\n    function utf8_encode(str) {\r\n        return unescape(encodeURIComponent(str));\r\n    }\r\n\r\n    function str2binb(str) {\r\n        var bin = [];\r\n        var mask = (1 << charsize) - 1;\r\n        var len = str.length * charsize;\r\n    \r\n        for (var i = 0; i < len; i += charsize) {\r\n            bin[i >> 5] |= (str.charCodeAt(i / charsize) & mask) << (32 - charsize - (i % 32));\r\n        }\r\n    \r\n        return bin;\r\n    }\r\n\r\n    function binb2hex(binarray) {\r\n        var hex_tab = \"0123456789abcdef\";\r\n        var str = \"\";\r\n        var length = binarray.length * 4;\r\n        var srcByte;\r\n\r\n        for (var i = 0; i < length; i += 1) {\r\n            srcByte = binarray[i >> 2] >> ((3 - (i % 4)) * 8);\r\n            str += hex_tab.charAt((srcByte >> 4) & 0xF) + hex_tab.charAt(srcByte & 0xF);\r\n        }\r\n\r\n        return str;\r\n    }\r\n\r\n    function safe_add_2(x, y) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (x.lowOrder & 0xFFFF) + (y.lowOrder & 0xFFFF);\r\n        msw = (x.lowOrder >>> 16) + (y.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (x.highOrder & 0xFFFF) + (y.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (x.highOrder >>> 16) + (y.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function safe_add_4(a, b, c, d) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF);\r\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function safe_add_5(a, b, c, d, e) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF) + (e.lowOrder & 0xFFFF);\r\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (e.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (e.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (e.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function maj(x, y, z) {\r\n        return new int64(\r\n            (x.highOrder & y.highOrder) ^ (x.highOrder & z.highOrder) ^ (y.highOrder & z.highOrder),\r\n            (x.lowOrder & y.lowOrder) ^ (x.lowOrder & z.lowOrder) ^ (y.lowOrder & z.lowOrder)\r\n        );\r\n    }\r\n\r\n    function ch(x, y, z) {\r\n        return new int64(\r\n            (x.highOrder & y.highOrder) ^ (~x.highOrder & z.highOrder),\r\n            (x.lowOrder & y.lowOrder) ^ (~x.lowOrder & z.lowOrder)\r\n        );\r\n    }\r\n\r\n    function rotr(x, n) {\r\n        if (n <= 32) {\r\n            return new int64(\r\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n)),\r\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n))\r\n            );\r\n        } else {\r\n            return new int64(\r\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n)),\r\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n))\r\n            );\r\n        }\r\n    }\r\n\r\n    function sigma0(x) {\r\n        var rotr28 = rotr(x, 28);\r\n        var rotr34 = rotr(x, 34);\r\n        var rotr39 = rotr(x, 39);\r\n\r\n        return new int64(\r\n            rotr28.highOrder ^ rotr34.highOrder ^ rotr39.highOrder,\r\n            rotr28.lowOrder ^ rotr34.lowOrder ^ rotr39.lowOrder\r\n        );\r\n    }\r\n\r\n    function sigma1(x) {\r\n        var rotr14 = rotr(x, 14);\r\n        var rotr18 = rotr(x, 18);\r\n        var rotr41 = rotr(x, 41);\r\n\r\n        return new int64(\r\n            rotr14.highOrder ^ rotr18.highOrder ^ rotr41.highOrder,\r\n            rotr14.lowOrder ^ rotr18.lowOrder ^ rotr41.lowOrder\r\n        );\r\n    }\r\n\r\n    function gamma0(x) {\r\n        var rotr1 = rotr(x, 1), rotr8 = rotr(x, 8), shr7 = shr(x, 7);\r\n\r\n        return new int64(\r\n            rotr1.highOrder ^ rotr8.highOrder ^ shr7.highOrder,\r\n            rotr1.lowOrder ^ rotr8.lowOrder ^ shr7.lowOrder\r\n        );\r\n    }\r\n\r\n    function gamma1(x) {\r\n        var rotr19 = rotr(x, 19);\r\n        var rotr61 = rotr(x, 61);\r\n        var shr6 = shr(x, 6);\r\n\r\n        return new int64(\r\n            rotr19.highOrder ^ rotr61.highOrder ^ shr6.highOrder,\r\n            rotr19.lowOrder ^ rotr61.lowOrder ^ shr6.lowOrder\r\n        );\r\n    }\r\n\r\n    function shr(x, n) {\r\n        if (n <= 32) {\r\n            return new int64(\r\n                x.highOrder >>> n,\r\n                x.lowOrder >>> n | (x.highOrder << (32 - n))\r\n            );\r\n        } else {\r\n            return new int64(\r\n                0,\r\n                x.highOrder << (32 - n)\r\n            );\r\n        }\r\n    }\r\n\r\n    var str = utf8_encode(str);\r\n    var strlen = str.length*charsize;\r\n    str = str2binb(str);\r\n\r\n    str[strlen >> 5] |= 0x80 << (24 - strlen % 32);\r\n    str[(((strlen + 128) >> 10) << 5) + 31] = strlen;\r\n\r\n    for (var i = 0; i < str.length; i += 32) {\r\n        a = H[0];\r\n        b = H[1];\r\n        c = H[2];\r\n        d = H[3];\r\n        e = H[4];\r\n        f = H[5];\r\n        g = H[6];\r\n        h = H[7];\r\n\r\n        for (var j = 0; j < 80; j++) {\r\n            if (j < 16) {\r\n                W[j] = new int64(str[j*2 + i], str[j*2 + i + 1]);\r\n            } else {\r\n                W[j] = safe_add_4(gamma1(W[j - 2]), W[j - 7], gamma0(W[j - 15]), W[j - 16]);\r\n            }\r\n\r\n            T1 = safe_add_5(h, sigma1(e), ch(e, f, g), K[j], W[j]);\r\n            T2 = safe_add_2(sigma0(a), maj(a, b, c));\r\n            h = g;\r\n            g = f;\r\n            f = e;\r\n            e = safe_add_2(d, T1);\r\n            d = c;\r\n            c = b;\r\n            b = a;\r\n            a = safe_add_2(T1, T2);\r\n        }\r\n\r\n        H[0] = safe_add_2(a, H[0]);\r\n        H[1] = safe_add_2(b, H[1]);\r\n        H[2] = safe_add_2(c, H[2]);\r\n        H[3] = safe_add_2(d, H[3]);\r\n        H[4] = safe_add_2(e, H[4]);\r\n        H[5] = safe_add_2(f, H[5]);\r\n        H[6] = safe_add_2(g, H[6]);\r\n        H[7] = safe_add_2(h, H[7]);\r\n    }\r\n\r\n    var binarray = [];\r\n    for (var i = 0; i < H.length; i++) {\r\n        binarray.push(H[i].highOrder);\r\n        binarray.push(H[i].lowOrder);\r\n    }\r\n\r\n    return binb2hex(binarray);\r\n});\r\n\r\nif (! jSuites.login) {\r\n    jSuites.login = {};\r\n    jSuites.login.sha512 = jSuites.sha512;\r\n}\r\n\r\njSuites.image = jSuites.upload = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        type: 'image',\r\n        extension: '*',\r\n        input: false,\r\n        minWidth: false,\r\n        maxWidth: null,\r\n        maxHeight: null,\r\n        maxJpegSizeBytes: null, // For example, 350Kb would be 350000\r\n        onchange: null,\r\n        multiple: false,\r\n        remoteParser: null,\r\n        text:{\r\n            extensionNotAllowed:'The extension is not allowed',\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Multiple\r\n    if (obj.options.multiple == true) {\r\n        el.setAttribute('data-multiple', true);\r\n    }\r\n\r\n    // Container\r\n    el.content = [];\r\n\r\n    // Upload icon\r\n    el.classList.add('jupload');\r\n\r\n    if (obj.options.input == true) {\r\n        el.classList.add('input');\r\n    }\r\n\r\n    obj.add = function(data) {\r\n        // Reset container for single files\r\n        if (obj.options.multiple == false) {\r\n            el.content = [];\r\n            el.innerText = '';\r\n        }\r\n\r\n        // Append to the element\r\n        if (obj.options.type == 'image') {\r\n            var img = document.createElement('img');\r\n            img.setAttribute('src', data.file);\r\n            img.setAttribute('tabindex', -1);\r\n            if (! el.getAttribute('name')) {\r\n                img.className = 'jfile';\r\n                img.content = data;\r\n            }\r\n            el.appendChild(img);\r\n        } else {\r\n            if (data.name) {\r\n                var name = data.name;\r\n            } else {\r\n                var name = data.file;\r\n            }\r\n            var div = document.createElement('div');\r\n            div.innerText = name || obj.options.type;\r\n            div.classList.add('jupload-item');\r\n            div.setAttribute('tabindex', -1);\r\n            el.appendChild(div);\r\n        }\r\n\r\n        if (data.content) {\r\n            data.file = jSuites.guid();\r\n        }\r\n\r\n        // Push content\r\n        el.content.push(data);\r\n\r\n        // Onchange\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, data);\r\n        }\r\n    }\r\n\r\n    obj.addFromFile = function(file) {\r\n        var type = file.type.split('/');\r\n        if (type[0] == obj.options.type) {\r\n            var readFile = new FileReader();\r\n            readFile.addEventListener(\"load\", function (v) {\r\n                var data = {\r\n                    file: v.srcElement.result,\r\n                    extension: file.name.substr(file.name.lastIndexOf('.') + 1),\r\n                    name: file.name,\r\n                    size: file.size,\r\n                    lastmodified: file.lastModified,\r\n                    content: v.srcElement.result,\r\n                }\r\n\r\n                obj.add(data);\r\n            });\r\n\r\n            readFile.readAsDataURL(file);\r\n        } else {\r\n            alert(obj.options.text.extensionNotAllowed);\r\n        }\r\n    }\r\n\r\n    obj.addFromUrl = function(src) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                var type = extension[0].replace('data:','');\r\n                if (type == obj.options.type) {\r\n                    var data = {\r\n                        file: src,\r\n                        name: '',\r\n                        extension: extension[1],\r\n                        content: src,\r\n                    }\r\n                    obj.add(data);\r\n                } else {\r\n                    alert(obj.options.text.extensionNotAllowed);\r\n                }\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n                // Get remove content\r\n                jSuites.ajax({\r\n                    url: src,\r\n                    type: 'GET',\r\n                    dataType: 'blob',\r\n                    success: function(data) {\r\n                        //add(extension[0].replace('data:',''), data);\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    var getDataURL = function(canvas, type) {\r\n        var compression = 0.92;\r\n        var lastContentLength = null;\r\n        var content = canvas.toDataURL(type, compression);\r\n        while (obj.options.maxJpegSizeBytes && type === 'image/jpeg' &&\r\n               content.length > obj.options.maxJpegSizeBytes && content.length !== lastContentLength) {\r\n            // Apply the compression\r\n            compression *= 0.9;\r\n            lastContentLength = content.length;\r\n            content = canvas.toDataURL(type, compression);\r\n        }\r\n        return content;\r\n    }\r\n\r\n    var mime = obj.options.type + '/' + obj.options.extension;\r\n    var input = document.createElement('input');\r\n    input.type = 'file';\r\n    input.setAttribute('accept', mime);\r\n    input.onchange = function() {\r\n        for (var i = 0; i < this.files.length; i++) {\r\n            obj.addFromFile(this.files[i]);\r\n        }\r\n    }\r\n\r\n    // Allow multiple files\r\n    if (obj.options.multiple == true) {\r\n        input.setAttribute('multiple', true);\r\n    }\r\n\r\n    var current = null;\r\n\r\n    el.addEventListener(\"click\", function(e) {\r\n        current = null;\r\n        if (! el.children.length || e.target === el) {\r\n            jSuites.click(input);\r\n        } else {\r\n            if (e.target.parentNode == el) {\r\n                current = e.target;\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener(\"dblclick\", function(e) {\r\n        jSuites.click(input);\r\n    });\r\n\r\n    el.addEventListener('dragenter', function(e) {\r\n        el.style.border = '1px dashed #000';\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragstop', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('keydown', function(e) {\r\n        if (current && e.which == 46) {\r\n            var index = Array.prototype.indexOf.call(el.children, current);\r\n            if (index >= 0) {\r\n                el.content.splice(index, 1);\r\n                current.remove();\r\n                current = null;\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();  \r\n        e.stopPropagation();\r\n\r\n        var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n        var file = (e.originalEvent || e).dataTransfer.files;\r\n\r\n        if (file.length) {\r\n            for (var i = 0; i < e.dataTransfer.files.length; i++) {\r\n                obj.addFromFile(e.dataTransfer.files[i]);\r\n            }\r\n        } else if (html) {\r\n            if (obj.options.multiple == false) {\r\n                el.innerText = '';\r\n            }\r\n\r\n            // Create temp element\r\n            var div = document.createElement('div');\r\n            div.innerHTML = html;\r\n\r\n            // Extract images\r\n            var img = div.querySelectorAll('img');\r\n\r\n            if (img.length) {\r\n                for (var i = 0; i < img.length; i++) {\r\n                    obj.addFromUrl(img[i].src);\r\n                }\r\n            }\r\n        }\r\n\r\n        el.style.border = '1px solid #eee';\r\n\r\n        return false;\r\n    });\r\n\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            return el.content && el.content.length ? el.content : null;\r\n        } else {\r\n            // Reset\r\n            el.innerText = '';\r\n            el.content = [];\r\n\r\n            if (val) {\r\n                if (Array.isArray(val)) {\r\n                    for (var i = 0; i < val.length; i++) {\r\n                        if (typeof(val[i]) == 'string') {\r\n                            obj.add({ file: val[i] });\r\n                        } else {\r\n                            obj.add(val[i]);\r\n                        }\r\n                    }\r\n                } else if (typeof(val) == 'string') {\r\n                    obj.add({ file: val });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    el.upload = el.image = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.image.create = function(data) {\r\n    var img = document.createElement('img');\r\n    img.setAttribute('src', data.file);\r\n    img.className = 'jfile';\r\n    img.setAttribute('tabindex', -1);\r\n    img.content = data;\r\n\r\n    return img;\r\n}\r\n\r\n\r\njSuites.lazyLoading = (function(el, options) {\r\n    var obj = {}\r\n\r\n    // Mandatory options\r\n    if (! options.loadUp || typeof(options.loadUp) != 'function') {\r\n        options.loadUp = function() {\r\n            return false;\r\n        }\r\n    }\r\n    if (! options.loadDown || typeof(options.loadDown) != 'function') {\r\n        options.loadDown = function() {\r\n            return false;\r\n        }\r\n    }\r\n    // Timer ms\r\n    if (! options.timer) {\r\n        options.timer = 100;\r\n    }\r\n\r\n    // Timer\r\n    var timeControlLoading = null;\r\n\r\n    // Controls\r\n    var scrollControls = function(e) {\r\n        if (timeControlLoading == null) {\r\n            var event = false;\r\n            var scrollTop = el.scrollTop;\r\n            if (el.scrollTop + (el.clientHeight * 2) >= el.scrollHeight) {\r\n                if (options.loadDown()) {\r\n                    if (scrollTop == el.scrollTop) {\r\n                        el.scrollTop = el.scrollTop - (el.clientHeight);\r\n                    }\r\n                    event = true;\r\n                }\r\n            } else if (el.scrollTop <= el.clientHeight) {\r\n                if (options.loadUp()) {\r\n                    if (scrollTop == el.scrollTop) {\r\n                        el.scrollTop = el.scrollTop + (el.clientHeight);\r\n                    }\r\n                    event = true;\r\n                }\r\n            }\r\n\r\n            timeControlLoading = setTimeout(function() {\r\n                timeControlLoading = null;\r\n            }, options.timer);\r\n\r\n            if (event) {\r\n                if (typeof(options.onupdate) == 'function') {\r\n                    options.onupdate();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Onscroll\r\n    el.onscroll = function(e) {\r\n        scrollControls(e);\r\n    }\r\n\r\n    el.onwheel = function(e) {\r\n        scrollControls(e);\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.loading = (function() {\r\n    var obj = {};\r\n\r\n    var loading = null;\r\n\r\n    obj.show = function() {\r\n        if (! loading) {\r\n            loading = document.createElement('div');\r\n            loading.className = 'jloading';\r\n        }\r\n        document.body.appendChild(loading);\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (loading && loading.parentNode) {\r\n            document.body.removeChild(loading);\r\n        }\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.mask = (function() {\r\n    // Currency \r\n    var tokens = {\r\n        // Currency tokens\r\n        currency: [ '#(.{1})##0?(.{1}0+)?( ?;(.*)?)?', '#' ],\r\n        // Percentage\r\n        percentage: [ '0{1}(.{1}0+)?%' ],\r\n        // Number\r\n        numeric: [ '0{1}(.{1}0+)?' ],\r\n        // Data tokens\r\n        datetime: [ 'YYYY', 'YYY', 'YY', 'MMMMM', 'MMMM', 'MMM', 'MM', 'DDDDD', 'DDDD', 'DDD', 'DD', 'DY', 'DAY', 'WD', 'D', 'Q', 'HH24', 'HH12', 'HH', '\\\\[H\\\\]', 'H', 'AM/PM', 'PM', 'AM', 'MI', 'SS', 'MS', 'MONTH', 'MON', 'Y', 'M' ],\r\n        // Other\r\n        general: [ 'A', '0', '[0-9a-zA-Z\\$]+', '.']\r\n    }\r\n\r\n    var getDate = function() {\r\n        if (this.mask.toLowerCase().indexOf('[h]') !== -1) {\r\n            var m = 0;\r\n            if (this.date[4]) {\r\n                m = parseFloat(this.date[4] / 60);\r\n            }\r\n            var v = parseInt(this.date[3]) + m;\r\n            v /= 24;\r\n        } else if (! (this.date[0] && this.date[1] && this.date[2]) && (this.date[3] || this.date[4])) {\r\n            v = jSuites.two(this.date[3]) + ':' + jSuites.two(this.date[4]) + ':' + jSuites.two(this.date[5]) \r\n        } else {\r\n            if (this.date[0] && this.date[1] && ! this.date[2]) {\r\n                this.date[2] = 1;\r\n            }\r\n            v = jSuites.two(this.date[0]) + '-' + jSuites.two(this.date[1]) + '-' + jSuites.two(this.date[2]);\r\n\r\n            if (this.date[3] || this.date[4] || this.date[5]) {\r\n                v += ' ' + jSuites.two(this.date[3]) + ':' + jSuites.two(this.date[4]) + ':' + jSuites.two(this.date[5]);\r\n            }\r\n        }\r\n\r\n        return v;\r\n    }\r\n\r\n    var isBlank = function(v) {\r\n        return v === null || v === '' || v === undefined ? true : false;\r\n    }\r\n\r\n    var isFormula = function(value) {\r\n        return (''+value).chartAt(0) == '=';\r\n    }\r\n\r\n    var isNumeric = function(t) {\r\n        return t === 'currency' || t === 'percentage' || t === 'numeric' ? true : false;\r\n    }\r\n    /**\r\n     * Get the decimal defined in the mask configuration\r\n     */\r\n    var getDecimal = function(v) {\r\n        if (v && Number(v) == v) {\r\n            return '.';\r\n        } else {\r\n            if (this.options.decimal) {\r\n                return this.options.decimal;\r\n            } else {\r\n                if (this.locale) {\r\n                    var t = Intl.NumberFormat(this.locale).format(1.1);\r\n                    return this.options.decimal = t[1];\r\n                } else {\r\n                    if (! v) {\r\n                        v  = this.mask;\r\n                    }\r\n                    var e = new RegExp('0{1}(.{1})0+', 'ig');\r\n                    var t = e.exec(v);\r\n                    if (t && t[1] && t[1].length == 1) {\r\n                        // Save decimal\r\n                        this.options.decimal = t[1];\r\n                        // Return decimal\r\n                        return t[1];\r\n                    } else {\r\n                        // Did not find any decimal last resort the default\r\n                        var e = new RegExp('#,##', 'ig');\r\n                        if ((v && v.match(e)) || '1.1'.toLocaleString().substring(1,2) == '.') {\r\n                            this.options.decimal = '.';\r\n                        } else {\r\n                            this.options.decimal = ',';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.options.decimal) {\r\n            return this.options.decimal;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    var ParseValue = function(v, decimal) {\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n\r\n        // Get decimal\r\n        if (! decimal) {\r\n            decimal = getDecimal.call(this);\r\n        }\r\n\r\n        // New value\r\n        v = (''+v).split(decimal);\r\n        v[0] = v[0].match(/[\\-0-9]+/g, '');\r\n        if (v[0]) {\r\n            v[0] = v[0].join('');\r\n        }\r\n        if (v[0] || v[1]) {\r\n            if (v[1] !== undefined) {\r\n                v[1] = v[1].match(/[0-9]+/g, '');\r\n                if (v[1]) {\r\n                    v[1] = v[1].join('');\r\n                } else {\r\n                    v[1] = '';\r\n                }\r\n            }\r\n        } else {\r\n            return '';\r\n        }\r\n\r\n        return v;\r\n    }\r\n\r\n    var FormatValue = function(v) {\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n        // Get decimal\r\n        var d = getDecimal.call(this);\r\n        // Convert value\r\n        var o = Object.create(this.options || {});\r\n        if (! o.minimumFractionDigits) {\r\n            o.minimumFractionDigits = 1;\r\n        }\r\n        // Parse value\r\n        v = ParseValue.call(this, v);\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n        // Temporary value\r\n        if (v[0]) {\r\n            var t = parseFloat(v.join('.'));\r\n            if (o.style == 'percent') {\r\n                t /= 100;\r\n            }\r\n        } else {\r\n            var t = null;\r\n        }\r\n        var n = new Intl.NumberFormat(this.locale, o).format(t);\r\n        n = n.split(d);\r\n        var s = n[1].replace(/[0-9]*/g, '');\r\n        if (s) {\r\n            n[2] = s;\r\n        }\r\n        if (v[1] !== undefined) {\r\n            n[1] = d + v[1];\r\n        } else {\r\n            n[1] = '';\r\n        }\r\n\r\n        return n.join('');\r\n    }\r\n\r\n    var Format = function(e) {\r\n        var v = Value.call(e);\r\n        if (! v) {\r\n            return;\r\n        }\r\n\r\n        // Get decimal\r\n        var d = getDecimal.call(this);\r\n        var n = FormatValue.call(this, v);\r\n        var t = (n.length) - v.length;\r\n        var index = Caret.call(e) + t;\r\n        // Set value and update caret\r\n        Value.call(e, n, index, true);\r\n    }\r\n\r\n    var Extract = function(v) {\r\n        // Keep the raw value\r\n        var current = ParseValue.call(this, v);\r\n        if (current) {\r\n            return parseFloat(current.join('.'));\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Caret getter and setter methods\r\n     */\r\n    var Caret = function(index, adjustNumeric) {\r\n        if (index === undefined) {\r\n            if (this.tagName == 'DIV') {\r\n                var pos = 0;\r\n                var s = window.getSelection();\r\n                if (s) {\r\n                    if (s.rangeCount !== 0) {\r\n                        var r = s.getRangeAt(0);\r\n                        var p = r.cloneRange();\r\n                        p.selectNodeContents(this);\r\n                        p.setEnd(r.endContainer, r.endOffset);\r\n                        pos = p.toString().length;\r\n                    }\r\n                }\r\n                return pos;\r\n            } else {\r\n                return this.selectionStart;\r\n            }\r\n        } else {\r\n            // Get the current value\r\n            var n = Value.call(this);\r\n\r\n            // Review the position\r\n            if (adjustNumeric) {\r\n                var p = null;\r\n                for (var i = 0; i < n.length; i++) {\r\n                    if (n[i].match(/[\\-0-9]/g) || n[i] == '.' || n[i] == ',') {  \r\n                        p = i;\r\n                    }\r\n                }\r\n\r\n                // If the string has no numbers\r\n                if (p === null) {\r\n                    p = n.indexOf(' ');\r\n                }\r\n\r\n                if (index >= p) {\r\n                    index = p + 1;\r\n                }\r\n            }\r\n\r\n            // Do not update caret\r\n            if (index > n.length) {\r\n                index = n.length;\r\n            }\r\n\r\n            if (index) {\r\n                // Set caret\r\n                if (this.tagName == 'DIV') {\r\n                    var s = window.getSelection();\r\n                    var r = document.createRange();\r\n                    r.setStart(this.childNodes[0], index);\r\n                    s.removeAllRanges();\r\n                    s.addRange(r);\r\n                } else {\r\n                    this.selectionStart = index;\r\n                    this.selectionEnd = index;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Value getter and setter method\r\n     */\r\n    var Value = function(v, updateCaret, adjustNumeric) {\r\n        if (this.tagName == 'DIV') {\r\n            if (v === undefined) {\r\n                return this.innerText;\r\n            } else {\r\n                if (this.innerText !== v) {\r\n                    this.innerText = v;\r\n\r\n                    if (updateCaret) {\r\n                        Caret.call(this, updateCaret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            if (v === undefined) {\r\n                return this.value;\r\n            } else {\r\n                if (this.value !== v) {\r\n                    this.value = v;\r\n                    if (updateCaret) {\r\n                        Caret.call(this, updateCaret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Labels\r\n    var weekDaysFull = jSuites.calendar.weekdays;\r\n    var weekDays = jSuites.calendar.weekdaysShort;\r\n    var monthsFull = jSuites.calendar.months;\r\n    var months = jSuites.calendar.monthsShort;\r\n\r\n    var parser = {\r\n        'YEAR': function(v, s) {\r\n            var y = ''+new Date().getFullYear();\r\n\r\n            if (typeof(this.values[this.index]) === 'undefined') {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (parseInt(v) >= 0 && parseInt(v) <= 10) {\r\n                if (this.values[this.index].length < s) {\r\n                    this.values[this.index] += v;\r\n                }\r\n            }\r\n            if (this.values[this.index].length == s) {\r\n                if (s == 2) {\r\n                    var y = y.substr(0,2) + this.values[this.index];\r\n                } else if (s == 3) {\r\n                    var y = y.substr(0,1) + this.values[this.index];\r\n                } else if (s == 4) {\r\n                    var y = this.values[this.index];\r\n                }\r\n                this.date[0] = y;\r\n                this.index++;\r\n            }\r\n        },\r\n        'YYYY': function(v) {\r\n            parser.YEAR.call(this, v, 4);\r\n        },\r\n        'YYY': function(v) {\r\n            parser.YEAR.call(this, v, 3);\r\n        },\r\n        'YY': function(v) {\r\n            parser.YEAR.call(this, v, 2);\r\n        },\r\n        'FIND': function(v, a) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var pos = 0;\r\n            var count = 0;\r\n            var value = (this.values[this.index] + v).toLowerCase();\r\n            for (var i = 0; i < a.length; i++) {\r\n                if (a[i].toLowerCase().indexOf(value) == 0) {\r\n                    pos = i;\r\n                    count++;\r\n                }\r\n            }\r\n            if (count > 1) {\r\n                this.values[this.index] += v;\r\n            } else if (count == 1) {\r\n                this.values[this.index] = a[pos];\r\n                this.index++;\r\n\r\n                return pos;\r\n            }\r\n        },\r\n        'MMM': function(v) {\r\n            var ret = parser.FIND.call(this, v, months);\r\n            if (ret !== undefined) {\r\n                this.date[1] = ret + 1;\r\n            }\r\n        },\r\n        'MMMM': function(v) {\r\n            var ret = parser.FIND.call(this, v, monthsFull);\r\n            if (ret !== undefined) {\r\n                this.date[1] = ret + 1;\r\n            }\r\n        },\r\n        'MMMMM': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var pos = 0;\r\n            var count = 0;\r\n            var value = (this.values[this.index] + v).toLowerCase();\r\n            for (var i = 0; i < monthsFull.length; i++) {\r\n                if (monthsFull[i][0].toLowerCase().indexOf(value) == 0) {\r\n                    this.values[this.index] = monthsFull[i][0];\r\n                    this.date[1] = i + 1;\r\n                    this.index++;\r\n                    break;\r\n                }\r\n            }\r\n        },\r\n        'MM': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 1 && parseInt(v) < 10) {\r\n                    this.date[1] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 2) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                    this.date[1] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] == 0 && parseInt(v) > 0 && parseInt(v) < 10) {\r\n                    this.date[1] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'M': function(v) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (isBlank(this.values[this.index])) {\r\n                    this.values[this.index] = v;\r\n                    if (v > 1) {\r\n                        this.date[1] = this.values[this.index];\r\n                        this.index++;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                        this.date[1] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 0 && parseInt(v) > 0) {\r\n                        this.date[1] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else {\r\n                        var test = true;\r\n                    }\r\n                }\r\n            } else {\r\n                var test = true;\r\n            }\r\n\r\n            // Re-test\r\n            if (test == true) {\r\n                var t = parseInt(this.values[this.index]);\r\n                if (t > 0 && t < 12) {\r\n                    this.date[2] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'D': function(v) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (isBlank(this.values[this.index])) {\r\n                    this.values[this.index] = v;\r\n                    if (parseInt(v) > 3) {\r\n                        this.date[2] = this.values[this.index];\r\n                        this.index++;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 3 && parseInt(v) < 2) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 1 || this.values[this.index] == 2) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 0 && parseInt(v) > 0) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else {\r\n                        var test = true;\r\n                    }\r\n                }\r\n            } else {\r\n                var test = true;\r\n            }\r\n\r\n            // Re-test\r\n            if (test == true) {\r\n                var t = parseInt(this.values[this.index]);\r\n                if (t > 0 && t < 32) {\r\n                    this.date[2] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'DD': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 3 && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 3 && parseInt(v) < 2) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if ((this.values[this.index] == 1 || this.values[this.index] == 2) && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] == 0 && parseInt(v) > 0 && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'DDD': function(v) {\r\n            parser.FIND.call(this, v, weekDays);\r\n        },\r\n        'DDDD': function(v) {\r\n            parser.FIND.call(this, v, weekDaysFull);\r\n        },\r\n        'HH12': function(v, two) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 1 && parseInt(v) < 10) {\r\n                    if (two) {\r\n                        v = 0 + v;\r\n                    }\r\n                    this.date[3] = this.values[this.index] = v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                    this.date[3] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] < 1 && parseInt(v) < 10) {\r\n                    this.date[3] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'HH24': function(v, two) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (this.values[this.index] == null || this.values[this.index] == '') {\r\n                    if (parseInt(v) > 2 && parseInt(v) < 10) {\r\n                        if (two) {\r\n                            v = 0 + v;\r\n                        }\r\n                        this.date[3] = this.values[this.index] = v;\r\n                        this.index++;\r\n                    } else if (parseInt(v) < 10) {\r\n                        this.values[this.index] = v;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 2 && parseInt(v) < 4) {\r\n                        this.date[3] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] < 2 && parseInt(v) < 10) {\r\n                        this.date[3] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        'HH': function(v) {\r\n            parser['HH24'].call(this, v, 1);\r\n        },\r\n        'H': function(v) {\r\n            parser['HH24'].call(this, v, 0);\r\n        },\r\n        '\\\\[H\\\\]': function(v) {\r\n            if (this.values[this.index] == undefined) {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (v.match(/[0-9]/g)) {\r\n                this.date[3] = this.values[this.index] += v;\r\n            } else {\r\n                if (this.values[this.index].match(/[0-9]/g)) {\r\n                    this.date[3] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'N60': function(v, i) {\r\n            if (this.values[this.index] == null || this.values[this.index] == '') {\r\n                if (parseInt(v) > 5 && parseInt(v) < 10) {\r\n                    this.date[i] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (parseInt(v) < 10) {\r\n                    this.date[i] = this.values[this.index] += v;\r\n                    this.index++;\r\n                 }\r\n            }\r\n        },\r\n        'MI': function(v) {\r\n            parser.N60.call(this, v, 4);\r\n        },\r\n        'SS': function(v) {\r\n            parser.N60.call(this, v, 5);\r\n        },\r\n        'AM/PM': function(v) {\r\n            this.values[this.index] = '';\r\n            if (v) {\r\n                if (this.date[3] > 12) {\r\n                    this.values[this.index] = 'PM';\r\n                } else {\r\n                    this.values[this.index] = 'AM';\r\n                }\r\n            }\r\n            this.index++;\r\n        },\r\n        'WD': function(v) {\r\n            if (typeof(this.values[this.index]) === 'undefined') {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (parseInt(v) >= 0 && parseInt(v) < 7) {\r\n                this.values[this.index] = v;\r\n            }\r\n            if (this.value[this.index].length == 1) {\r\n                this.index++;\r\n            }\r\n        },\r\n        '0{1}(.{1}0+)?': function(v) {\r\n            // Get decimal\r\n            var decimal = getDecimal.call(this);\r\n            // Negative number\r\n            var neg = false;\r\n            // Create if is blank\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            } else {\r\n                if (this.values[this.index] == '-') {\r\n                    neg = true;\r\n                }\r\n            }\r\n            var current = ParseValue.call(this, this.values[this.index], decimal);\r\n            if (current) {\r\n                this.values[this.index] = current.join(decimal);\r\n            }\r\n            // New entry\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (this.values[this.index] != '0' || v == decimal) {\r\n                    this.values[this.index] += v;\r\n                }\r\n            } else if (decimal && v == decimal) {\r\n                if (this.values[this.index].indexOf(decimal) == -1) {\r\n                    if (! this.values[this.index]) {\r\n                        this.values[this.index] = '0';\r\n                    }\r\n                    this.values[this.index] += v;\r\n                }\r\n            } else if (v == '-') {\r\n                // Negative signed\r\n                neg = true;\r\n            }\r\n\r\n            if (neg === true && this.values[this.index][0] !== '-') {\r\n                this.values[this.index] = '-' + this.values[this.index];\r\n            }\r\n        },\r\n        '0{1}(.{1}0+)?%': function(v) {\r\n            parser['0{1}(.{1}0+)?'].call(this, v);\r\n\r\n            if (this.values[this.index].match(/[\\-0-9]/g)) {\r\n                if (this.values[this.index] && this.values[this.index].indexOf('%') == -1) {\r\n                    this.values[this.index] += '%';\r\n                }\r\n            } else {\r\n                this.values[this.index] = '';\r\n            }\r\n        },\r\n        '#(.{1})##0?(.{1}0+)?( ?;(.*)?)?': function(v) {\r\n            // Parse number\r\n            parser['0{1}(.{1}0+)?'].call(this, v);\r\n            // Get decimal\r\n            var decimal = getDecimal.call(this);\r\n            // Get separator\r\n            var separator = this.tokens[this.index].substr(1,1);\r\n            // Negative\r\n            var negative = this.values[this.index][0] === '-' ? true : false;\r\n            // Current value\r\n            var current = ParseValue.call(this, this.values[this.index], decimal);\r\n\r\n            // Get main and decimal parts\r\n            if (current !== '') {\r\n                // Format number\r\n                var n = current[0].match(/[0-9]/g);\r\n                if (n) {\r\n                    // Format\r\n                    n = n.join('');\r\n                    var t = [];\r\n                    var s = 0;\r\n                    for (var j = n.length - 1; j >= 0 ; j--) {\r\n                        t.push(n[j]);\r\n                        s++;\r\n                        if (! (s % 3)) {\r\n                            t.push(separator);\r\n                        }\r\n                    }\r\n                    t = t.reverse();\r\n                    current[0] = t.join('');\r\n                    if (current[0].substr(0,1) == separator) {\r\n                        current[0] = current[0].substr(1);\r\n                    }\r\n                } else {\r\n                    current[0] = '';\r\n                }\r\n\r\n                // Value\r\n                this.values[this.index] = current.join(decimal);\r\n\r\n                // Negative\r\n                if (negative) {\r\n                    this.values[this.index] = '-' + this.values[this.index];\r\n                }\r\n            }\r\n        },\r\n        '0': function(v) {\r\n            if (v.match(/[0-9]/g)) {\r\n                this.values[this.index] = v;\r\n                this.index++;\r\n            }\r\n        },\r\n        '[0-9a-zA-Z$]+': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var t = this.tokens[this.index];\r\n            var s = this.values[this.index];\r\n            var i = s.length;\r\n\r\n            if (t[i] == v) {\r\n                this.values[this.index] += v;\r\n\r\n                if (this.values[this.index] == t) {\r\n                    this.index++;\r\n                }\r\n            } else {\r\n                this.values[this.index] = t;\r\n                this.index++;\r\n\r\n                if (v.match(/[\\-0-9]/g)) {\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'A': function(v) {\r\n            if (v.match(/[a-zA-Z]/gi)) {\r\n                this.values[this.index] = v;\r\n                this.index++;\r\n            }\r\n        },\r\n        '.': function(v) {\r\n            parser['[0-9a-zA-Z$]+'].call(this, v);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the tokens in the mask string\r\n     */\r\n    var getTokens = function(str) {\r\n        if (this.type == 'general') {\r\n            var t = [].concat(tokens.general);\r\n        } else {\r\n            var t = [].concat(tokens.currency, tokens.datetime, tokens.percentage, tokens.numeric, tokens.general);\r\n        }\r\n        // Expression to extract all tokens from the string\r\n        var e = new RegExp(t.join('|'), 'gi');\r\n        // Extract\r\n        return str.match(e);\r\n    }\r\n\r\n    /**\r\n     * Get the method of one given token\r\n     */\r\n    var getMethod = function(str) {\r\n        if (! this.type) {\r\n            var types = Object.keys(tokens);\r\n        } else if (this.type == 'general') {\r\n            var types = [ 'general' ];\r\n        } else if (this.type == 'datetime') {\r\n            var types = [ 'numeric', 'datetime', 'general' ];\r\n        } else {\r\n            var types = [ 'currency', 'percentage', 'numeric', 'general' ];\r\n        }\r\n\r\n        // Found\r\n        for (var i = 0; i < types.length; i++) {\r\n            var type = types[i];\r\n            for (var j = 0; j < tokens[type].length; j++) {\r\n                var e = new RegExp(tokens[type][j], 'gi');\r\n                var r = str.match(e);\r\n                if (r) {\r\n                    return { type: type, method: tokens[type][j] }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Identify each method for each token\r\n     */\r\n    var getMethods = function(t) {\r\n        var result = [];\r\n        for (var i = 0; i < t.length; i++) {\r\n            var m = getMethod.call(this, t[i]);\r\n            if (m) {\r\n                result.push(m.method);\r\n            } else {\r\n                result.push(null);\r\n            }\r\n        }\r\n\r\n        // Compatibility with excel\r\n        for (var i = 0; i < result.length; i++) {\r\n            if (result[i] == 'MM') {\r\n                // Not a month, correct to minutes\r\n                if (result[i-1] && result[i-1].indexOf('H') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i-2] && result[i-2].indexOf('H') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i+1] && result[i+1].indexOf('S') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i+2] && result[i+2].indexOf('S') >= 0) {\r\n                    result[i] = 'MI';\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Get the type for one given token\r\n     */\r\n    var getType = function(str) {\r\n        var m = getMethod.call(this, str);\r\n        if (m) {\r\n            var type = m.type;\r\n        }\r\n\r\n        if (type) {\r\n            var numeric = 0;\r\n            // Make sure the correct type\r\n            var t = getTokens.call(this, str);\r\n            for (var i = 0; i < t.length; i++) {\r\n                m = getMethod.call(this, t[i]);\r\n                if (m && isNumeric(m.type)) {\r\n                    numeric++;\r\n                }\r\n            }\r\n            if (numeric > 1) {\r\n                type = 'general';\r\n            }\r\n        }\r\n\r\n        return type;\r\n    }\r\n\r\n    /**\r\n     * Parse character per character using the detected tokens in the mask\r\n     */\r\n    var parse = function() {\r\n        // Parser method for this position\r\n        if (typeof(parser[this.methods[this.index]]) == 'function') {\r\n            parser[this.methods[this.index]].call(this, this.value[this.position]);\r\n            this.position++;\r\n        } else {\r\n            this.values[this.index] = this.tokens[this.index];\r\n            this.index++;\r\n        }\r\n    }\r\n\r\n    var isFormula = function(value) {\r\n        var v = (''+value)[0];\r\n        return v == '=' ? true : false;\r\n    }\r\n\r\n    var toPlainString = function(num) {\r\n        return (''+ +num).replace(/(-?)(\\d*)\\.?(\\d*)e([+-]\\d+)/,\r\n          function(a,b,c,d,e) {\r\n            return e < 0\r\n              ? b + '0.' + Array(1-e-c.length).join(0) + c + d\r\n              : b + c + d + Array(e-d.length+1).join(0);\r\n          });\r\n    }\r\n\r\n    /**\r\n     * Mask function\r\n     * @param {mixed|string} JS input or a string to be parsed\r\n     * @param {object|string} When the first param is a string, the second is the mask or object with the mask options\r\n     */\r\n    var obj = function(e, config, returnObject) {\r\n        // Options\r\n        var r = null;\r\n        var t = null;\r\n        var o = {\r\n            // Element\r\n            input: null,\r\n            // Current value\r\n            value: null,\r\n            // Mask options\r\n            options: {},\r\n            // New values for each token found\r\n            values: [],\r\n            // Token position\r\n            index: 0,\r\n            // Character position\r\n            position: 0,\r\n            // Date raw values\r\n            date: [0,0,0,0,0,0],\r\n            // Raw number for the numeric values\r\n            number: 0,\r\n        }\r\n\r\n        // This is a JavaScript Event\r\n        if (typeof(e) == 'object') {\r\n            // Element\r\n            o.input = e.target;\r\n            // Current value\r\n            o.value = Value.call(e.target);\r\n            // Current caret position\r\n            o.caret = Caret.call(e.target);\r\n            // Mask\r\n            if (t = e.target.getAttribute('data-mask')) {\r\n                o.mask = t;\r\n            }\r\n            // Type\r\n            if (t = e.target.getAttribute('data-type')) {\r\n                o.type = t;\r\n            }\r\n            // Options\r\n            if (e.target.mask) {\r\n                if (e.target.mask.options) {\r\n                    o.options = e.target.mask.options;\r\n                }\r\n                if (e.target.mask.locale) {\r\n                    o.locale = e.target.mask.locale;\r\n                }\r\n            } else {\r\n                // Locale\r\n                if (t = e.target.getAttribute('data-locale')) {\r\n                    o.locale = t;\r\n                    if (o.mask) {\r\n                        o.options.style = o.mask;\r\n                    }\r\n                }\r\n            }\r\n            // Extra configuration\r\n            if (e.target.attributes && e.target.attributes.length) {\r\n                for (var i = 0; i < e.target.attributes.length; i++) {\r\n                    var k = e.target.attributes[i].name;\r\n                    var v = e.target.attributes[i].value;\r\n                    if (k.substr(0,4) == 'data') {\r\n                        o.options[k.substr(5)] = v;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            // Options\r\n            if (typeof(config) == 'string') {\r\n                // Mask\r\n                o.mask = config;\r\n            } else {\r\n                // Mask\r\n                var k = Object.keys(config);\r\n                for (var i = 0; i < k.length; i++) {\r\n                    o[k[i]] = config[k[i]];\r\n                }\r\n            }\r\n\r\n            if (typeof(e) === 'number') {\r\n                // Get decimal\r\n                getDecimal.call(o, o.mask);\r\n                // Replace to the correct decimal\r\n                e = (''+e).replace('.', o.options.decimal);\r\n            }\r\n\r\n            // Current\r\n            o.value = e;\r\n\r\n            if (o.input) {\r\n                // Value\r\n                Value.call(o.input, e);\r\n                // Focus\r\n                jSuites.focus(o.input);\r\n                // Caret\r\n                o.caret = Caret.call(o.input);\r\n            }\r\n        }\r\n\r\n        // Mask detected start the process\r\n        if (! isFormula(o.value) && (o.mask || o.locale)) {\r\n            // Compatibility ixes\r\n            if (o.mask) {\r\n                // Legacy\r\n                o.mask = o.mask.replace('[-]', '');\r\n                // Excel mask TODO: Improve\r\n                if (o.mask.indexOf('##')) {\r\n                    var d = o.mask.split(';');\r\n                    if (d[0]) {\r\n                        d[0] = d[0].replace('*', '');\r\n                        d[0] = d[0].replace(/_/g, '');\r\n                        d[0] = d[0].replace(/-/g, '');\r\n                        d[0] = d[0].replace('(','');\r\n                        d[0] = d[0].replace(')','');\r\n                        d[0] = d[0].replace('##0.###','##0.000');\r\n                        d[0] = d[0].replace('##0.##','##0.00');\r\n                        d[0] = d[0].replace('##0.#','##0.0');\r\n                    }\r\n                    o.mask = d[0];\r\n                }\r\n                // Get type\r\n                if (! o.type) {\r\n                    o.type = getType.call(o, o.mask);\r\n                }\r\n                // Get tokens\r\n                o.tokens = getTokens.call(o, o.mask);\r\n            }\r\n            // On new input\r\n            if (typeof(e) !== 'object' || ! e.inputType || e.inputType == 'insertText' || e.inputType == 'insertFromPaste') {\r\n                // Start tranformation\r\n                if (o.locale) {\r\n                    if (o.input) {\r\n                        Format.call(o, o.input);\r\n                    } else {\r\n                        var newValue = FormatValue.call(o, o.value);\r\n                    }\r\n                } else {\r\n                    // Get tokens\r\n                    o.methods = getMethods.call(o, o.tokens);\r\n                    // Go through all tokes\r\n                    while (o.position < o.value.length && typeof(o.tokens[o.index]) !== 'undefined') {\r\n                        // Get the approate parser\r\n                        parse.call(o);\r\n                    }\r\n\r\n                    if (isNumeric(o.type)) {\r\n                        // Complement things in the end of the mask\r\n                        while (typeof(o.tokens[o.index]) !== 'undefined') {\r\n                            var t = getMethod.call(o, o.tokens[o.index]);\r\n                            if (t && t.type == 'general') {\r\n                                o.values[o.index] = o.tokens[o.index];\r\n                            }\r\n                            o.index++;\r\n                        }\r\n\r\n                        var adjustNumeric = true;\r\n                    } else {\r\n                        var adjustNumeric = false;\r\n                    }\r\n\r\n                    // New value\r\n                    var newValue = o.values.join('');\r\n\r\n                    // Reset value\r\n                    if (o.input) {\r\n                        t = newValue.length - o.value.length;\r\n                        if (t > 0) {\r\n                            var caret = o.caret + t;\r\n                        } else {\r\n                            var caret = o.caret;\r\n                        }\r\n                        Value.call(o.input, newValue, caret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Update raw data\r\n            if (o.input) {\r\n                var label = null;\r\n                if (isNumeric(o.type)) {\r\n                    // Extract the number\r\n                    o.number = Extract.call(o, Value.call(o.input));\r\n                    // Keep the raw data as a property of the tag\r\n                    if (o.type == 'percentage') {\r\n                        label = o.number / 100;\r\n                    } else {\r\n                        label = o.number;\r\n                    }\r\n                } else if (o.type == 'datetime') {\r\n                    label = getDate.call(o);\r\n\r\n                    if (o.date[0] && o.date[1] && o.date[2]) {\r\n                        o.input.setAttribute('data-completed', true);\r\n                    }\r\n                }\r\n\r\n                if (label) {\r\n                    o.input.setAttribute('data-value', label);\r\n                }\r\n            }\r\n\r\n            if (newValue !== undefined) {\r\n                if (returnObject) {\r\n                    return o;\r\n                } else {\r\n                    return newValue;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Extract the tokens from a mask\r\n    obj.prepare = function(str, o) {\r\n        if (! o) {\r\n            o = {};\r\n        }\r\n        return getTokens.call(o, str);\r\n    }\r\n\r\n    /**\r\n     * Apply the mask to a element (legacy)\r\n     */\r\n    obj.apply = function(e) {\r\n        var v = Value.call(e.target);\r\n        if (e.key.length == 1) {\r\n            v += e.key;\r\n        }\r\n        Value.call(e.target, obj(v, e.target.getAttribute('data-mask')));\r\n    }\r\n\r\n    /**\r\n     * Legacy support\r\n     */\r\n    obj.run = function(value, mask, decimal) {\r\n        return obj(value, { mask, decimal });\r\n    }\r\n\r\n    /**\r\n     * Extract number from masked string\r\n     */\r\n    obj.extract = function(v, options, returnObject) {\r\n        if (isBlank(v)) {\r\n            return v;\r\n        }\r\n        if (typeof(options) != 'object') {\r\n            return value;\r\n        } else {\r\n            if (! options.options) {\r\n                options.options = {};\r\n            }\r\n        }\r\n\r\n        // Compatibility\r\n        if (! options.mask && options.format) {\r\n            options.mask = options.format;\r\n        }\r\n\r\n        // Get decimal\r\n        getDecimal.call(options, options.mask);\r\n\r\n        var type = null;\r\n        if (options.type == 'percent' || options.options.style == 'percent') {\r\n            type = 'percentage';\r\n        } else if (options.mask) {\r\n            type = getType.call(options, options.mask);\r\n        }\r\n\r\n\r\n        if (type === 'datetime') {\r\n            if (v instanceof Date) {\r\n                var t = jSuites.calendar.getDateString(value, options.mask);\r\n            }\r\n\r\n            var o = obj(v, options, true);\r\n            var value = getDate.call(o);\r\n            if ((o.date[0] && o.date[1] && o.date[2]) && ! (o.date[3] || o.date[4] || o.date[5])) {\r\n                var t = jSuites.calendar.now(o.date);\r\n                value = jSuites.calendar.dateToNum(t);\r\n            }\r\n        } else {\r\n            var value = Extract.call(options, v);\r\n            // Percentage\r\n            if (type == 'percentage') {\r\n                value /= 100;\r\n            }\r\n            var o = options;\r\n        }\r\n\r\n        o.value = value;\r\n\r\n        if (returnObject) {\r\n            return o;\r\n        } else {\r\n            return value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Render\r\n     */\r\n    obj.render = function(value, options, fullMask) {\r\n        if (isBlank(value)) {\r\n            return value;\r\n        }\r\n\r\n        if (typeof(options) != 'object') {\r\n            return value;\r\n        } else {\r\n            if (! options.options) {\r\n                options.options = {};\r\n            }\r\n        }\r\n\r\n        // Compatibility\r\n        if (! options.mask && options.format) {\r\n            options.mask = options.format;\r\n        }\r\n\r\n        var type = null;\r\n        if (options.type == 'percent' || options.options.style == 'percent') {\r\n            type = 'percentage';\r\n        } else if (options.mask) {\r\n            type = getType.call(options, options.mask);\r\n        } else if (value instanceof Date) {\r\n            type = 'datetime';\r\n        }\r\n\r\n        // Fill with blanks\r\n        var fillWithBlanks = false;\r\n\r\n        if (type =='datetime' || options.type == 'calendar') {\r\n            var t = jSuites.calendar.getDateString(value, options.mask);\r\n            if (t) {\r\n                value = t;\r\n            }\r\n\r\n            if (options.mask && fullMask) {\r\n                fillWithBlanks = true;\r\n            }\r\n        } else {\r\n            // Percentage\r\n            if (type == 'percentage') {\r\n                value *= 100;\r\n            }\r\n            // Number of decimal places\r\n            if (typeof(value) === 'number') {\r\n                var t = null;\r\n                if (options.mask && fullMask) {\r\n                    var e = new RegExp('0{1}(.{1})0+', 'ig');\r\n                    var d = options.mask.match(e);\r\n                    if (d && d[0]) {\r\n                        d = d[0].length - 2;\r\n                        t = value.toFixed(d);\r\n                    } else {\r\n                        t = (''+value);\r\n                    }\r\n                } else if (options.locale && fullMask) {\r\n                    var d = (''+value).split('.');\r\n                    if (! d[1]) {\r\n                        d[1] = '00';\r\n                    } else {\r\n                        if (d[1].length == 1) {\r\n                            d[1] += '0';\r\n                        }\r\n                    }\r\n                    t = d.join('.');\r\n                } else {\r\n                    t = toPlainString(value);\r\n                }\r\n\r\n                if (t !== null) {\r\n                    value = t;\r\n                    // Get decimal\r\n                    getDecimal.call(options, options.mask);\r\n                    // Replace to the correct decimal\r\n                    if (options.options.decimal) {\r\n                        value = value.replace('.', options.options.decimal);\r\n                    }\r\n                }\r\n            } else {\r\n                if (options.mask && fullMask) {\r\n                    fillWithBlanks = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (fillWithBlanks) {\r\n            var s = options.mask.length - value.length;\r\n            if (s > 0) {\r\n                for (var i = 0; i < s; i++) {\r\n                    value += ' ';\r\n                }\r\n            }\r\n        }\r\n\r\n        value = obj(value, options);\r\n\r\n        return value;\r\n    }\r\n\r\n    obj.set = function(e, m) {\r\n        if (m) {\r\n            e.setAttribute('data-mask', m);\r\n            // Reset the value\r\n            var event = new Event('input', {\r\n                bubbles: true,\r\n                cancelable: true,\r\n            });\r\n            e.dispatchEvent(event);\r\n        }\r\n    }\r\n\r\n    if (typeof document !== 'undefined') {\r\n        document.addEventListener('input', function(e) {\r\n            if (e.target.getAttribute('data-mask') || e.target.mask) {\r\n                obj(e);\r\n            }\r\n        });\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.modal = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: null,\r\n        onopen: null,\r\n        onclose: null,\r\n        closed: false,\r\n        width: null,\r\n        height: null,\r\n        title: null,\r\n        padding: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Title\r\n    if (! obj.options.title && el.getAttribute('title')) {\r\n        obj.options.title = el.getAttribute('title');\r\n    }\r\n\r\n    var temp = document.createElement('div');\r\n    while (el.children[0]) {\r\n        temp.appendChild(el.children[0]);\r\n    }\r\n\r\n    obj.content = document.createElement('div');\r\n    obj.content.className = 'jmodal_content';\r\n    obj.content.innerHTML = el.innerHTML;\r\n\r\n    while (temp.children[0]) {\r\n        obj.content.appendChild(temp.children[0]);\r\n    }\r\n\r\n    obj.container = document.createElement('div');\r\n    obj.container.className = 'jmodal';\r\n    obj.container.appendChild(obj.content);\r\n\r\n    if (obj.options.padding) {\r\n        obj.content.style.padding = obj.options.padding;\r\n    }\r\n    if (obj.options.width) {\r\n        obj.container.style.width = obj.options.width;\r\n    }\r\n    if (obj.options.height) {\r\n        obj.container.style.height = obj.options.height;\r\n    }\r\n    if (obj.options.title) {\r\n        obj.container.setAttribute('title', obj.options.title);\r\n    } else {\r\n        obj.container.classList.add('no-title');\r\n    }\r\n    el.innerHTML = '';\r\n    el.style.display = 'none';\r\n    el.appendChild(obj.container);\r\n\r\n    // Backdrop\r\n    var backdrop = document.createElement('div');\r\n    backdrop.className = 'jmodal_backdrop';\r\n    backdrop.onclick = function() {\r\n        obj.close();\r\n    }\r\n    el.appendChild(backdrop);\r\n\r\n    obj.open = function() {\r\n        el.style.display = 'block';\r\n        // Fullscreen\r\n        var rect = obj.container.getBoundingClientRect();\r\n        if (jSuites.getWindowWidth() < rect.width) {\r\n            obj.container.style.top = '';\r\n            obj.container.style.left = '';\r\n            obj.container.classList.add('jmodal_fullscreen');\r\n            jSuites.animation.slideBottom(obj.container, 1);\r\n        } else {\r\n            backdrop.style.display = 'block';\r\n        }\r\n        // Current\r\n        jSuites.modal.current = obj;\r\n        // Event\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el, obj);\r\n        }\r\n    }\r\n\r\n    obj.resetPosition = function() {\r\n        obj.container.style.top = '';\r\n        obj.container.style.left = '';\r\n    }\r\n\r\n    obj.isOpen = function() {\r\n        return el.style.display != 'none' ? true : false;\r\n    }\r\n\r\n    obj.close = function() {\r\n        el.style.display = 'none';\r\n        // Backdrop\r\n        backdrop.style.display = '';\r\n        // Current\r\n        jSuites.modal.current = null;\r\n        // Remove fullscreen class\r\n        obj.container.classList.remove('jmodal_fullscreen');\r\n        // Event\r\n        if (typeof(obj.options.onclose) == 'function') {\r\n            obj.options.onclose(el, obj);\r\n        }\r\n    }\r\n\r\n    if (! jSuites.modal.hasEvents) {\r\n        jSuites.modal.current = obj;\r\n\r\n        if ('ontouchstart' in document.documentElement === true) {\r\n            document.addEventListener(\"touchstart\", jSuites.modal.mouseDownControls);\r\n        } else {\r\n            document.addEventListener('mousedown', jSuites.modal.mouseDownControls);\r\n            document.addEventListener('mousemove', jSuites.modal.mouseMoveControls);\r\n            document.addEventListener('mouseup', jSuites.modal.mouseUpControls);\r\n        }\r\n\r\n        document.addEventListener('keydown', jSuites.modal.keyDownControls);\r\n\r\n        jSuites.modal.hasEvents = true;\r\n    }\r\n\r\n    if (obj.options.url) {\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'text/html',\r\n            success: function(data) {\r\n                obj.content.innerHTML = data;\r\n\r\n                if (! obj.options.closed) {\r\n                    obj.open();\r\n                }\r\n            }\r\n        });\r\n    } else {\r\n        if (! obj.options.closed) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    // Keep object available from the node\r\n    el.modal = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.modal.current = null;\r\njSuites.modal.position = null;\r\n\r\njSuites.modal.keyDownControls = function(e) {\r\n    if (e.which == 27) {\r\n        if (jSuites.modal.current) {\r\n            jSuites.modal.current.close();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.modal.mouseUpControls = function(e) {\r\n    if (jSuites.modal.current) {\r\n        jSuites.modal.current.container.style.cursor = 'auto';\r\n    }\r\n    jSuites.modal.position = null;\r\n}\r\n\r\njSuites.modal.mouseMoveControls = function(e) {\r\n    if (jSuites.modal.current && jSuites.modal.position) {\r\n        if (e.which == 1 || e.which == 3) {\r\n            var position = jSuites.modal.position;\r\n            jSuites.modal.current.container.style.top = (position[1] + (e.clientY - position[3]) + (position[5] / 2)) + 'px';\r\n            jSuites.modal.current.container.style.left = (position[0] + (e.clientX - position[2]) + (position[4] / 2)) + 'px';\r\n            jSuites.modal.current.container.style.cursor = 'move';\r\n        } else {\r\n            jSuites.modal.current.container.style.cursor = 'auto';\r\n        }\r\n    }\r\n}\r\n\r\njSuites.modal.mouseDownControls = function(e) {\r\n    jSuites.modal.position = [];\r\n\r\n    if (e.target.classList.contains('jmodal')) {\r\n        setTimeout(function() {\r\n            // Get target info\r\n            var rect = e.target.getBoundingClientRect();\r\n\r\n            if (e.changedTouches && e.changedTouches[0]) {\r\n                var x = e.changedTouches[0].clientX;\r\n                var y = e.changedTouches[0].clientY;\r\n            } else {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            }\r\n\r\n            if (rect.width - (x - rect.left) < 50 && (y - rect.top) < 50) {\r\n                setTimeout(function() {\r\n                    jSuites.modal.current.close();\r\n                }, 100);\r\n            } else {\r\n                if (e.target.getAttribute('title') && (y - rect.top) < 50) {\r\n                    if (document.selection) {\r\n                        document.selection.empty();\r\n                    } else if ( window.getSelection ) {\r\n                        window.getSelection().removeAllRanges();\r\n                    }\r\n\r\n                    jSuites.modal.position = [\r\n                        rect.left,\r\n                        rect.top,\r\n                        e.clientX,\r\n                        e.clientY,\r\n                        rect.width,\r\n                        rect.height,\r\n                    ];\r\n                }\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\n\r\njSuites.notification = (function(options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        icon: null,\r\n        name: 'Notification',\r\n        date: null,\r\n        error: null,\r\n        title: null,\r\n        message: null,\r\n        timeout: 4000,\r\n        autoHide: true,\r\n        closeable: true,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    var notification = document.createElement('div');\r\n    notification.className = 'jnotification';\r\n\r\n    if (obj.options.error) {\r\n        notification.classList.add('jnotification-error');\r\n    }\r\n\r\n    var notificationContainer = document.createElement('div');\r\n    notificationContainer.className = 'jnotification-container';\r\n    notification.appendChild(notificationContainer);\r\n\r\n    var notificationHeader = document.createElement('div');\r\n    notificationHeader.className = 'jnotification-header';\r\n    notificationContainer.appendChild(notificationHeader);\r\n\r\n    var notificationImage = document.createElement('div');\r\n    notificationImage.className = 'jnotification-image';\r\n    notificationHeader.appendChild(notificationImage);\r\n\r\n    if (obj.options.icon) {\r\n        var notificationIcon = document.createElement('img');\r\n        notificationIcon.src = obj.options.icon;\r\n        notificationImage.appendChild(notificationIcon);\r\n    }\r\n\r\n    var notificationName = document.createElement('div');\r\n    notificationName.className = 'jnotification-name';\r\n    notificationName.innerHTML = obj.options.name;\r\n    notificationHeader.appendChild(notificationName);\r\n\r\n    if (obj.options.closeable == true) {\r\n        var notificationClose = document.createElement('div');\r\n        notificationClose.className = 'jnotification-close';\r\n        notificationClose.onclick = function() {\r\n            obj.hide();\r\n        }\r\n        notificationHeader.appendChild(notificationClose);\r\n    }\r\n\r\n    var notificationDate = document.createElement('div');\r\n    notificationDate.className = 'jnotification-date';\r\n    notificationHeader.appendChild(notificationDate);\r\n\r\n    var notificationContent = document.createElement('div');\r\n    notificationContent.className = 'jnotification-content';\r\n    notificationContainer.appendChild(notificationContent);\r\n\r\n    if (obj.options.title) {\r\n        var notificationTitle = document.createElement('div');\r\n        notificationTitle.className = 'jnotification-title';\r\n        notificationTitle.innerHTML = obj.options.title;\r\n        notificationContent.appendChild(notificationTitle);\r\n    }\r\n\r\n    var notificationMessage = document.createElement('div');\r\n    notificationMessage.className = 'jnotification-message';\r\n    notificationMessage.innerHTML = obj.options.message;\r\n    notificationContent.appendChild(notificationMessage);\r\n\r\n    obj.show = function() {\r\n        document.body.appendChild(notification);\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.animation.fadeIn(notification);\r\n        } else {\r\n            jSuites.animation.slideTop(notification, 1);\r\n        }\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.animation.fadeOut(notification, function() {\r\n                if (notification.parentNode) {\r\n                    notification.parentNode.removeChild(notification);\r\n                    if (notificationTimeout) {\r\n                        clearTimeout(notificationTimeout);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            jSuites.animation.slideTop(notification, 0, function() {\r\n                if (notification.parentNode) {\r\n                    notification.parentNode.removeChild(notification);\r\n                    if (notificationTimeout) {\r\n                        clearTimeout(notificationTimeout);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    obj.show();\r\n\r\n    if (obj.options.autoHide == true) {\r\n        var notificationTimeout = setTimeout(function() {\r\n            obj.hide();\r\n        }, obj.options.timeout);\r\n    }\r\n\r\n    if (jSuites.getWindowWidth() < 800) {\r\n        notification.addEventListener(\"swipeup\", function(e) {\r\n            obj.hide();\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.notification.isVisible = function() {\r\n    var j = document.querySelector('.jnotification');\r\n    return j && j.parentNode ? true : false;\r\n}\r\n\r\n// More palettes https://coolors.co/ or https://gka.github.io/palettes/#/10|s|003790,005647,ffffe0|ffffe0,ff005e,93003a|1|1\r\n\r\njSuites.palette = function(o) {\r\n    // Material\r\n    var palette = {};\r\n\r\n    palette.material = [\r\n        [ \"#ffebee\", \"#fce4ec\", \"#f3e5f5\", \"#e8eaf6\", \"#e3f2fd\", \"#e0f7fa\", \"#e0f2f1\", \"#e8f5e9\", \"#f1f8e9\", \"#f9fbe7\", \"#fffde7\", \"#fff8e1\", \"#fff3e0\", \"#fbe9e7\", \"#efebe9\", \"#fafafa\", \"#eceff1\" ],\r\n        [ \"#ffcdd2\", \"#f8bbd0\", \"#e1bee7\", \"#c5cae9\", \"#bbdefb\", \"#b2ebf2\", \"#b2dfdb\", \"#c8e6c9\", \"#dcedc8\", \"#f0f4c3\", \"#fff9c4\", \"#ffecb3\", \"#ffe0b2\", \"#ffccbc\", \"#d7ccc8\", \"#f5f5f5\", \"#cfd8dc\" ],\r\n        [ \"#ef9a9a\", \"#f48fb1\", \"#ce93d8\", \"#9fa8da\", \"#90caf9\", \"#80deea\", \"#80cbc4\", \"#a5d6a7\", \"#c5e1a5\", \"#e6ee9c\", \"#fff59d\", \"#ffe082\", \"#ffcc80\", \"#ffab91\", \"#bcaaa4\", \"#eeeeee\", \"#b0bec5\" ],\r\n        [ \"#e57373\", \"#f06292\", \"#ba68c8\", \"#7986cb\", \"#64b5f6\", \"#4dd0e1\", \"#4db6ac\", \"#81c784\", \"#aed581\", \"#dce775\", \"#fff176\", \"#ffd54f\", \"#ffb74d\", \"#ff8a65\", \"#a1887f\", \"#e0e0e0\", \"#90a4ae\" ],\r\n        [ \"#ef5350\", \"#ec407a\", \"#ab47bc\", \"#5c6bc0\", \"#42a5f5\", \"#26c6da\", \"#26a69a\", \"#66bb6a\", \"#9ccc65\", \"#d4e157\", \"#ffee58\", \"#ffca28\", \"#ffa726\", \"#ff7043\", \"#8d6e63\", \"#bdbdbd\", \"#78909c\" ],\r\n        [ \"#f44336\", \"#e91e63\", \"#9c27b0\", \"#3f51b5\", \"#2196f3\", \"#00bcd4\", \"#009688\", \"#4caf50\", \"#8bc34a\", \"#cddc39\", \"#ffeb3b\", \"#ffc107\", \"#ff9800\", \"#ff5722\", \"#795548\", \"#9e9e9e\", \"#607d8b\" ],\r\n        [ \"#e53935\", \"#d81b60\", \"#8e24aa\", \"#3949ab\", \"#1e88e5\", \"#00acc1\", \"#00897b\", \"#43a047\", \"#7cb342\", \"#c0ca33\", \"#fdd835\", \"#ffb300\", \"#fb8c00\", \"#f4511e\", \"#6d4c41\", \"#757575\", \"#546e7a\" ],\r\n        [ \"#d32f2f\", \"#c2185b\", \"#7b1fa2\", \"#303f9f\", \"#1976d2\", \"#0097a7\", \"#00796b\", \"#388e3c\", \"#689f38\", \"#afb42b\", \"#fbc02d\", \"#ffa000\", \"#f57c00\", \"#e64a19\", \"#5d4037\", \"#616161\", \"#455a64\" ],\r\n        [ \"#c62828\", \"#ad1457\", \"#6a1b9a\", \"#283593\", \"#1565c0\", \"#00838f\", \"#00695c\", \"#2e7d32\", \"#558b2f\", \"#9e9d24\", \"#f9a825\", \"#ff8f00\", \"#ef6c00\", \"#d84315\", \"#4e342e\", \"#424242\", \"#37474f\" ],\r\n        [ \"#b71c1c\", \"#880e4f\", \"#4a148c\", \"#1a237e\", \"#0d47a1\", \"#006064\", \"#004d40\", \"#1b5e20\", \"#33691e\", \"#827717\", \"#f57f17\", \"#ff6f00\", \"#e65100\", \"#bf360c\", \"#3e2723\", \"#212121\", \"#263238\" ],\r\n    ];\r\n\r\n    palette.fire = [\r\n        [\"0b1a6d\",\"840f38\",\"b60718\",\"de030b\",\"ff0c0c\",\"fd491c\",\"fc7521\",\"faa331\",\"fbb535\",\"ffc73a\"],\r\n        [\"071147\",\"5f0b28\",\"930513\",\"be0309\",\"ef0000\",\"fa3403\",\"fb670b\",\"f9991b\",\"faad1e\",\"ffc123\"],\r\n        [\"03071e\",\"370617\",\"6a040f\",\"9d0208\",\"d00000\",\"dc2f02\",\"e85d04\",\"f48c06\",\"faa307\",\"ffba08\"],\r\n        [\"020619\",\"320615\",\"61040d\",\"8c0207\",\"bc0000\",\"c82a02\",\"d05203\",\"db7f06\",\"e19405\",\"efab00\"],\r\n        [\"020515\",\"2d0513\",\"58040c\",\"7f0206\",\"aa0000\",\"b62602\",\"b94903\",\"c57205\",\"ca8504\",\"d89b00\"],\r\n    ]\r\n\r\n    palette.baby = [\r\n        [\"eddcd2\",\"fff1e6\",\"fde2e4\",\"fad2e1\",\"c5dedd\",\"dbe7e4\",\"f0efeb\",\"d6e2e9\",\"bcd4e6\",\"99c1de\"],\r\n        [\"e1c4b3\",\"ffd5b5\",\"fab6ba\",\"f5a8c4\",\"aacecd\",\"bfd5cf\",\"dbd9d0\",\"baceda\",\"9dc0db\",\"7eb1d5\"],\r\n        [\"daa990\",\"ffb787\",\"f88e95\",\"f282a9\",\"8fc4c3\",\"a3c8be\",\"cec9b3\",\"9dbcce\",\"82acd2\",\"649dcb\"],\r\n        [\"d69070\",\"ff9c5e\",\"f66770\",\"f05f8f\",\"74bbb9\",\"87bfae\",\"c5b993\",\"83aac3\",\"699bca\",\"4d89c2\"],\r\n        [\"c97d5d\",\"f58443\",\"eb4d57\",\"e54a7b\",\"66a9a7\",\"78ae9c\",\"b5a67e\",\"7599b1\",\"5c88b7\",\"4978aa\"],\r\n    ]\r\n\r\n    if (palette[o]) {\r\n        return palette[o];\r\n    } else {\r\n        return palette.material;\r\n    }\r\n}\r\n\r\njSuites.picker = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.picker) {\r\n        return el.picker.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'picker' };\r\n    obj.options = {};\r\n\r\n    var dropdownHeader = null;\r\n    var dropdownContent = null;\r\n\r\n    /**\r\n     * Create the content options\r\n     */\r\n    var createContent = function() {\r\n        dropdownContent.innerHTML = '';\r\n\r\n        // Create items\r\n        var keys = Object.keys(obj.options.data);\r\n\r\n        // Go though all options\r\n        for (var i = 0; i < keys.length; i++) {\r\n            // Item\r\n            var dropdownItem = document.createElement('div');\r\n            dropdownItem.classList.add('jpicker-item');\r\n            dropdownItem.k = keys[i];\r\n            dropdownItem.v = obj.options.data[keys[i]];\r\n            // Label\r\n            dropdownItem.innerHTML = obj.getLabel(keys[i]);\r\n            // Append\r\n            dropdownContent.appendChild(dropdownItem);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set or reset the options for the picker\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            value: 0,\r\n            data: null,\r\n            render: null,\r\n            onchange: null,\r\n            onselect: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onload: null,\r\n            width: null,\r\n            header: true,\r\n            right: false,\r\n            content: false,\r\n            columns: null,\r\n            height: null,\r\n        }\r\n\r\n        // Legacy purpose only\r\n        if (options && options.options) {\r\n            options.data = options.options;\r\n        }\r\n\r\n        // Loop through the initial configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Start using the options\r\n        if (obj.options.header === false) {\r\n            dropdownHeader.style.display = 'none';\r\n        } else {\r\n            dropdownHeader.style.display = '';\r\n        }\r\n\r\n        // Width\r\n        if (obj.options.width) {\r\n            dropdownHeader.style.width = parseInt(obj.options.width) + 'px';\r\n        } else {\r\n            dropdownHeader.style.width = '';\r\n        }\r\n\r\n        // Height\r\n        if (obj.options.height) {\r\n            dropdownContent.style.maxHeight = obj.options.height + 'px';\r\n            dropdownContent.style.overflow = 'scroll';\r\n        } else {\r\n            dropdownContent.style.overflow = '';\r\n        }\r\n\r\n        if (obj.options.columns > 0) {\r\n            dropdownContent.classList.add('jpicker-columns');\r\n            dropdownContent.style.width =  obj.options.width ? obj.options.width : 36 * obj.options.columns + 'px';\r\n        }\r\n\r\n        if (isNaN(obj.options.value)) {\r\n            obj.options.value = '0';\r\n        }\r\n\r\n        // Create list from data\r\n        createContent();\r\n\r\n        // Set value\r\n        obj.setValue(obj.options.value);\r\n\r\n        // Set options all returns the own instance\r\n        return obj;\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    obj.setValue = function(v) {\r\n        // Set label\r\n        obj.setLabel(v);\r\n\r\n        // Update value\r\n        obj.options.value = String(v);\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n\r\n        if (dropdownContent.children[v].getAttribute('type') !== 'generic') {\r\n            obj.close();\r\n        }\r\n    }\r\n\r\n    obj.getLabel = function(v) {\r\n        var label = obj.options.data[v] || null;\r\n        if (typeof(obj.options.render) == 'function') {\r\n            label = obj.options.render(label);\r\n        }\r\n        return label;\r\n    }\r\n\r\n    obj.setLabel = function(v) {\r\n        if (obj.options.content) {\r\n            var label = '<i class=\"material-icons\">' + obj.options.content + '</i>';\r\n        } else {\r\n            var label = obj.getLabel(v);\r\n        }\r\n\r\n        dropdownHeader.innerHTML = label;\r\n    }\r\n\r\n    obj.open = function() {\r\n        if (! el.classList.contains('jpicker-focus')) {\r\n            // Start tracking the element\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Open picker\r\n            el.classList.add('jpicker-focus');\r\n            el.focus();\r\n\r\n            var rectHeader = dropdownHeader.getBoundingClientRect();\r\n            var rectContent = dropdownContent.getBoundingClientRect();\r\n            if (window.innerHeight < rectHeader.bottom + rectContent.height) {\r\n                dropdownContent.style.marginTop = -1 * (rectContent.height + 4) + 'px';\r\n            } else {\r\n                dropdownContent.style.marginTop = rectHeader.height + 2 + 'px';\r\n            }\r\n\r\n            if (obj.options.right === true) {\r\n                dropdownContent.style.marginLeft = -1 * rectContent.width + 24 + 'px';\r\n            }\r\n\r\n            if (typeof obj.options.onopen == 'function') {\r\n                obj.options.onopen(el, obj);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (el.classList.contains('jpicker-focus')) {\r\n            el.classList.remove('jpicker-focus');\r\n\r\n            // Start tracking the element\r\n            jSuites.tracking(obj, false);\r\n\r\n            if (typeof obj.options.onclose == 'function') {\r\n                obj.options.onclose(el, obj);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create floating picker\r\n     */\r\n    var init = function() {\r\n        // Class\r\n        el.classList.add('jpicker');\r\n        el.setAttribute('tabindex', '900');\r\n        el.onmousedown = function(e) {\r\n            if (! el.classList.contains('jpicker-focus')) {\r\n                obj.open();\r\n            }\r\n        }\r\n\r\n        // Dropdown Header\r\n        dropdownHeader = document.createElement('div');\r\n        dropdownHeader.classList.add('jpicker-header');\r\n\r\n        // Dropdown content\r\n        dropdownContent = document.createElement('div');\r\n        dropdownContent.classList.add('jpicker-content');\r\n        dropdownContent.onclick = function(e) {\r\n            var item = jSuites.findElement(e.target, 'jpicker-item');\r\n            if (item) {\r\n                if (item.parentNode === dropdownContent) {\r\n                    // Update label\r\n                    obj.setValue(item.k);\r\n                    // Call method\r\n                    if (typeof(obj.options.onchange) == 'function') {\r\n                        obj.options.onchange.call(obj, el, obj, item.v, item.v, item.k);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Append content and header\r\n        el.appendChild(dropdownHeader);\r\n        el.appendChild(dropdownContent);\r\n\r\n        // Default value\r\n        el.value = options.value || 0;\r\n\r\n        // Set options\r\n        obj.setOptions(options);\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Reference\r\n        el.picker = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.progressbar = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        value: 0,\r\n        onchange: null,\r\n        width: null,\r\n    };\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jprogressbar');\r\n    el.setAttribute('tabindex', 1);\r\n    el.setAttribute('data-value', obj.options.value);\r\n\r\n    var bar = document.createElement('div');\r\n    bar.style.width = obj.options.value + '%';\r\n    bar.style.color = '#fff';\r\n    el.appendChild(bar);\r\n\r\n    if (obj.options.width) {\r\n        el.style.width = obj.options.width;\r\n    }\r\n\r\n    // Set value\r\n    obj.setValue = function(value) {\r\n        value = parseInt(value);\r\n        obj.options.value = value;\r\n        bar.style.width = value + '%';\r\n        el.setAttribute('data-value', value + '%');\r\n\r\n        if (value < 6) {\r\n            el.style.color = '#000';\r\n        } else {\r\n            el.style.color = '#fff';\r\n        }\r\n\r\n        // Update value\r\n        obj.options.value = value;\r\n\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, value);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var action = function(e) {\r\n        if (e.which) {\r\n            // Get target info\r\n            var rect = el.getBoundingClientRect();\r\n\r\n            if (e.changedTouches && e.changedTouches[0]) {\r\n                var x = e.changedTouches[0].clientX;\r\n                var y = e.changedTouches[0].clientY;\r\n            } else {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            }\r\n\r\n            obj.setValue(Math.round((x - rect.left) / rect.width * 100));\r\n        }\r\n    }\r\n\r\n    // Events\r\n    if ('touchstart' in document.documentElement === true) {\r\n        el.addEventListener('touchstart', action);\r\n        el.addEventListener('touchend', action);\r\n    } else {\r\n        el.addEventListener('mousedown', action);\r\n        el.addEventListener(\"mousemove\", action);\r\n    }\r\n\r\n    // Change\r\n    el.change = obj.setValue;\r\n\r\n    // Global generic value handler\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            return obj.getValue();\r\n        } else {\r\n            obj.setValue(val);\r\n        }\r\n    }\r\n\r\n    // Reference\r\n    el.progressbar = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.rating = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.rating) {\r\n        return el.rating.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            number: 5,\r\n            value: 0,\r\n            tooltip: [ 'Very bad', 'Bad', 'Average', 'Good', 'Very good' ],\r\n            onchange: null,\r\n        };\r\n\r\n        // Loop through the initial configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Make sure the container is empty\r\n        el.innerHTML = '';\r\n\r\n        // Add elements\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            var div = document.createElement('div');\r\n            div.setAttribute('data-index', (i + 1))\r\n            div.setAttribute('title', obj.options.tooltip[i])\r\n            el.appendChild(div);\r\n        }\r\n\r\n        // Selected option\r\n        if (obj.options.value) {\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                if (i < obj.options.value) {\r\n                    el.children[i].classList.add('jrating-selected');\r\n                }\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    // Set value\r\n    obj.setValue = function(index) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < index) {\r\n                el.children[i].classList.add('jrating-selected');\r\n            } else {\r\n                el.children[i].classList.remove('jrating-over');\r\n                el.children[i].classList.remove('jrating-selected');\r\n            }\r\n        }\r\n\r\n        obj.options.value = index;\r\n\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, index);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var init = function() {\r\n        // Start plugin\r\n        obj.setOptions(options);\r\n\r\n        // Class\r\n        el.classList.add('jrating');\r\n\r\n        // Events\r\n        el.addEventListener(\"click\", function(e) {\r\n            var index = e.target.getAttribute('data-index');\r\n            if (index != undefined) {\r\n                if (index == obj.options.value) {\r\n                    obj.setValue(0);\r\n                } else {\r\n                    obj.setValue(index);\r\n                }\r\n            }\r\n        });\r\n\r\n        el.addEventListener(\"mouseover\", function(e) {\r\n            var index = e.target.getAttribute('data-index');\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                if (i < index) {\r\n                    el.children[i].classList.add('jrating-over');\r\n                } else {\r\n                    el.children[i].classList.remove('jrating-over');\r\n                }\r\n            }\r\n        });\r\n\r\n        el.addEventListener(\"mouseout\", function(e) {\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                el.children[i].classList.remove('jrating-over');\r\n            }\r\n        });\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Reference\r\n        el.rating = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\n\r\njSuites.search = (function(el, options) {\r\n    if (el.search) {\r\n        return el.search;\r\n    }\r\n\r\n    var index =  null;\r\n\r\n    var select = function(e) {\r\n        if (e.target.classList.contains('jsearch_item')) {\r\n            var element = e.target;\r\n        } else {\r\n            var element = e.target.parentNode;\r\n        }\r\n\r\n        obj.selectIndex(element);\r\n        e.preventDefault();\r\n    }\r\n\r\n    var createList = function(data) {\r\n        // Reset container\r\n        container.innerHTML = '';\r\n        // Print results\r\n        if (! data.length) {\r\n            // Show container\r\n            el.style.display = '';\r\n        } else {\r\n            // Show container\r\n            el.style.display = 'block';\r\n\r\n            // Show items (only 10)\r\n            var len = data.length < 11 ? data.length : 10;\r\n            for (var i = 0; i < len; i++) {\r\n                if (typeof(data[i]) == 'string') {\r\n                    var text = data[i];\r\n                    var value = data[i];\r\n                } else {\r\n                    // Legacy\r\n                    var text = data[i].text;\r\n                    if (! text && data[i].name) {\r\n                        text = data[i].name;\r\n                    }\r\n                    var value = data[i].value;\r\n                    if (! value && data[i].id) {\r\n                        value = data[i].id;\r\n                    }\r\n                }\r\n\r\n                var div = document.createElement('div');\r\n                div.setAttribute('data-value', value);\r\n                div.setAttribute('data-text', text);\r\n                div.className = 'jsearch_item';\r\n\r\n                if (data[i].id) {\r\n                    div.setAttribute('id', data[i].id)\r\n                }\r\n\r\n                if (obj.options.forceSelect && i == 0) {\r\n                    div.classList.add('selected');\r\n                }\r\n                var img = document.createElement('img');\r\n                if (data[i].image) {\r\n                    img.src = data[i].image;\r\n                } else {\r\n                    img.style.display = 'none';\r\n                }\r\n                div.appendChild(img);\r\n\r\n                var item = document.createElement('div');\r\n                item.innerHTML = text;\r\n                div.appendChild(item);\r\n\r\n                // Append item to the container\r\n                container.appendChild(div);\r\n            }\r\n        }\r\n    }\r\n\r\n    var execute = function(str) {\r\n        if (str != obj.terms) {\r\n            // New terms\r\n            obj.terms = str;\r\n            // New index\r\n            if (obj.options.forceSelect) {\r\n                index = 0;\r\n            } else {\r\n                index = null;\r\n            }\r\n            // Array or remote search\r\n            if (Array.isArray(obj.options.data)) {\r\n                var test = function(o) {\r\n                    if (typeof(o) == 'string') {\r\n                        if ((''+o).toLowerCase().search(str.toLowerCase()) >= 0) {\r\n                            return true;\r\n                        }\r\n                    } else {\r\n                        for (var key in o) {\r\n                            var value = o[key];\r\n                            if ((''+value).toLowerCase().search(str.toLowerCase()) >= 0) {\r\n                                return true;\r\n                            }\r\n                        }\r\n                    }\r\n                    return false;\r\n                }\r\n\r\n                var results = obj.options.data.filter(function(item) {\r\n                    return test(item);\r\n                });\r\n\r\n                // Show items\r\n                createList(results);\r\n            } else {\r\n                // Get remove results\r\n                jSuites.ajax({\r\n                    url: obj.options.data + str,\r\n                    method: 'GET',\r\n                    dataType: 'json',\r\n                    success: function(data) {\r\n                        // Show items\r\n                        createList(data);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    // Search timer\r\n    var timer = null;\r\n\r\n    // Search methods\r\n    var obj = function(str) {\r\n        if (timer) {\r\n            clearTimeout(timer);\r\n        }\r\n        timer = setTimeout(function() {\r\n            execute(str);\r\n        }, 500);\r\n    }\r\n    if(options.forceSelect === null) {\r\n        options.forceSelect = true;\r\n    }\r\n    obj.options = {\r\n        data: options.data || null,\r\n        input: options.input || null,\r\n        onselect: options.onselect || null,\r\n        forceSelect: options.forceSelect,\r\n    };\r\n\r\n    obj.selectIndex = function(item) {\r\n        var id = item.getAttribute('id');\r\n        var text = item.getAttribute('data-text');\r\n        var value = item.getAttribute('data-value');\r\n        // Onselect\r\n        if (typeof(obj.options.onselect) == 'function') {\r\n            obj.options.onselect(obj, text, value, id);\r\n        }\r\n        // Close container\r\n        obj.close();\r\n    }\r\n\r\n    obj.open = function() {\r\n        el.style.display = 'block';\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (timer) {\r\n            clearTimeout(timer);\r\n        }\r\n        // Current terms\r\n        obj.terms = '';\r\n        // Remove results\r\n        container.innerHTML = '';\r\n        // Hide\r\n        el.style.display = '';\r\n    }\r\n\r\n    obj.isOpened = function() {\r\n        return el.style.display ? true : false;\r\n    }\r\n\r\n    obj.keydown = function(e) {\r\n        if (obj.isOpened()) {\r\n            if (e.key == 'Enter') {\r\n                // Enter\r\n                if (index!==null && container.children[index]) {\r\n                    obj.selectIndex(container.children[index]);\r\n                    e.preventDefault();\r\n                } else {\r\n                    obj.close();\r\n                }\r\n            } else if (e.key === 'ArrowUp') {\r\n                // Up\r\n                if (index!==null && container.children[0]) {\r\n                    container.children[index].classList.remove('selected');\r\n                    if(!obj.options.forceSelect && index === 0) {\r\n                        index = null;\r\n                    } else {\r\n                        index = Math.max(0, index-1);\r\n                        container.children[index].classList.add('selected');\r\n                    }\r\n                }\r\n                e.preventDefault();\r\n            } else if (e.key === 'ArrowDown') {\r\n                // Down\r\n                if(index == null) {\r\n                    index = -1;\r\n                } else {\r\n                    container.children[index].classList.remove('selected');\r\n                }\r\n                if (index < 9 && container.children[index+1]) {\r\n                    index++;\r\n                }\r\n                container.children[index].classList.add('selected');\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.keyup = function(e) {\r\n        if (obj.options.input) {\r\n            obj(obj.options.input.value);\r\n        } else {\r\n            // Current node\r\n            var node = jSuites.getNode();\r\n            if (node) {\r\n                obj(node.innerText);\r\n            }\r\n        }\r\n    }\r\n    \r\n    // Add events\r\n    if (obj.options.input) {\r\n        obj.options.input.addEventListener(\"keyup\", obj.keyup);\r\n        obj.options.input.addEventListener(\"keydown\", obj.keydown);\r\n    }\r\n\r\n    // Append element\r\n    var container = document.createElement('div');\r\n    container.classList.add('jsearch_container');\r\n    container.onmousedown = select;\r\n    el.appendChild(container);\r\n\r\n    el.classList.add('jsearch');\r\n    el.search = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\njSuites.slider = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n    obj.currentImage = null;\r\n\r\n    if (options) {\r\n        obj.options = options;\r\n    }\r\n\r\n    // Focus\r\n    el.setAttribute('tabindex', '900')\r\n\r\n    // Items\r\n    obj.options.items = [];\r\n\r\n    if (! el.classList.contains('jslider')) {\r\n        el.classList.add('jslider');\r\n        el.classList.add('unselectable');\r\n\r\n        if (obj.options.height) {\r\n            el.style.minHeight = obj.options.height;\r\n        }\r\n        if (obj.options.width) {\r\n            el.style.width = obj.options.width;\r\n        }\r\n        if (obj.options.grid) {\r\n            el.classList.add('jslider-grid');\r\n            var number = el.children.length;\r\n            if (number > 4) {\r\n                el.setAttribute('data-total', number - 4);\r\n            }\r\n            el.setAttribute('data-number', (number > 4 ? 4 : number));\r\n        }\r\n\r\n        // Add slider counter\r\n        var counter = document.createElement('div');\r\n        counter.classList.add('jslider-counter');\r\n\r\n        // Move children inside\r\n        if (el.children.length > 0) {\r\n            // Keep children items\r\n            for (var i = 0; i < el.children.length; i++) {\r\n                obj.options.items.push(el.children[i]);\r\n                \r\n                // counter click event\r\n                var item = document.createElement('div');\r\n                item.onclick = function() {\r\n                    var index = Array.prototype.slice.call(counter.children).indexOf(this);\r\n                    obj.show(obj.currentImage = obj.options.items[index]);\r\n                }\r\n                counter.appendChild(item);\r\n            }\r\n        }\r\n        // Add caption\r\n        var caption = document.createElement('div');\r\n        caption.className = 'jslider-caption';\r\n\r\n        // Add close buttom\r\n        var controls = document.createElement('div');\r\n        var close = document.createElement('div');\r\n        close.className = 'jslider-close';\r\n        close.innerHTML = '';\r\n        \r\n        close.onclick = function() {\r\n            obj.close();\r\n        }\r\n        controls.appendChild(caption);\r\n        controls.appendChild(close);\r\n    }\r\n\r\n    obj.updateCounter = function(index) {\r\n        for (var i = 0; i < counter.children.length; i ++) {\r\n            if (counter.children[i].classList.contains('jslider-counter-focus')) {\r\n                counter.children[i].classList.remove('jslider-counter-focus');\r\n                break;\r\n            }\r\n        }\r\n        counter.children[index].classList.add('jslider-counter-focus');\r\n    }\r\n\r\n    obj.show = function(target) {\r\n        if (! target) {\r\n            var target = el.children[0];\r\n        }\r\n\r\n        // Focus element\r\n        el.classList.add('jslider-focus');\r\n        el.classList.remove('jslider-grid');\r\n        el.appendChild(controls);\r\n        el.appendChild(counter);\r\n\r\n        // Update counter\r\n        var index = obj.options.items.indexOf(target);\r\n        obj.updateCounter(index);\r\n\r\n        // Remove display\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            el.children[i].style.display = '';\r\n        }\r\n        target.style.display = 'block';\r\n\r\n        // Is there any previous\r\n        if (target.previousElementSibling) {\r\n            el.classList.add('jslider-left');\r\n        } else {\r\n            el.classList.remove('jslider-left');\r\n        }\r\n\r\n        // Is there any next\r\n        if (target.nextElementSibling && target.nextElementSibling.tagName == 'IMG') {\r\n            el.classList.add('jslider-right');\r\n        } else {\r\n            el.classList.remove('jslider-right');\r\n        }\r\n\r\n        obj.currentImage = target;\r\n\r\n        // Vertical image\r\n        if (obj.currentImage.offsetHeight > obj.currentImage.offsetWidth) {\r\n            obj.currentImage.classList.add('jslider-vertical');\r\n        }\r\n\r\n        controls.children[0].innerText = obj.currentImage.getAttribute('title');\r\n    }\r\n\r\n    obj.open = function() {\r\n        obj.show();\r\n\r\n        // Event\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el);\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        // Remove control classes\r\n        el.classList.remove('jslider-focus');\r\n        el.classList.remove('jslider-left');\r\n        el.classList.remove('jslider-right');\r\n        // Show as a grid depending on the configuration\r\n        if (obj.options.grid) {\r\n            el.classList.add('jslider-grid');\r\n        }\r\n        // Remove display\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            el.children[i].style.display = '';\r\n        }\r\n        // Remove controls from the component\r\n        counter.remove();\r\n        controls.remove();\r\n        // Current image\r\n        obj.currentImage = null;\r\n        // Event\r\n        if (typeof(obj.options.onclose) == 'function') {\r\n            obj.options.onclose(el);\r\n        }\r\n    }\r\n\r\n    obj.reset = function() {\r\n        el.innerHTML = '';\r\n    }\r\n\r\n    obj.next = function() {\r\n        var nextImage = obj.currentImage.nextElementSibling;\r\n        if (nextImage && nextImage.tagName === 'IMG') {\r\n            obj.show(obj.currentImage.nextElementSibling);\r\n        }\r\n    }\r\n    \r\n    obj.prev = function() {\r\n        if (obj.currentImage.previousElementSibling) {\r\n            obj.show(obj.currentImage.previousElementSibling);\r\n        }\r\n    }\r\n\r\n    var mouseUp = function(e) {\r\n        // Open slider\r\n        if (e.target.tagName == 'IMG') {\r\n            obj.show(e.target);\r\n        } else if (! e.target.classList.contains('jslider-close') && ! (e.target.parentNode.classList.contains('jslider-counter') || e.target.classList.contains('jslider-counter'))){\r\n            // Arrow controls\r\n            var offsetX = e.offsetX || e.changedTouches[0].clientX;\r\n            if (e.target.clientWidth - offsetX < 40) {\r\n                // Show next image\r\n                obj.next();\r\n            } else if (offsetX < 40) {\r\n                // Show previous image\r\n                obj.prev();\r\n            }\r\n        }\r\n    }\r\n\r\n    if ('ontouchend' in document.documentElement === true) {\r\n        el.addEventListener('touchend', mouseUp);\r\n    } else {\r\n        el.addEventListener('mouseup', mouseUp);\r\n    }\r\n\r\n    // Add global events\r\n    el.addEventListener(\"swipeleft\", function(e) {\r\n        obj.next();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    el.addEventListener(\"swiperight\", function(e) {\r\n        obj.prev();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    el.addEventListener('keydown', function(e) {\r\n        if (e.which == 27) {\r\n            obj.close();\r\n        }\r\n    });\r\n\r\n    el.slider = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.sorting = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    var defaults = {\r\n        pointer: null,\r\n        direction: null,\r\n        ondragstart: null,\r\n        ondragend: null,\r\n        ondrop: null,\r\n    }\r\n\r\n    var dragElement = null;\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    el.classList.add('jsorting');\r\n\r\n    el.addEventListener('dragstart', function(e) {\r\n        var position = Array.prototype.indexOf.call(e.target.parentNode.children, e.target);\r\n        dragElement = {\r\n            element: e.target,\r\n            o: position,\r\n            d: position\r\n        }\r\n        e.target.style.opacity = '0.25';\r\n\r\n        if (typeof(obj.options.ondragstart) == 'function') {\r\n            obj.options.ondragstart(el, e.target, e);\r\n        }\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (getElement(e.target) && dragElement) {\r\n            if (e.target.getAttribute('draggable') == 'true' && dragElement.element != e.target) {\r\n                if (! obj.options.direction) {\r\n                    var condition = e.target.clientHeight / 2 > e.offsetY;\r\n                } else {\r\n                    var condition = e.target.clientWidth / 2 > e.offsetX;\r\n                }\r\n\r\n                if (condition) {\r\n                    e.target.parentNode.insertBefore(dragElement.element, e.target);\r\n                } else {\r\n                    e.target.parentNode.insertBefore(dragElement.element, e.target.nextSibling);\r\n                }\r\n\r\n                dragElement.d = Array.prototype.indexOf.call(e.target.parentNode.children, dragElement.element);\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('dragend', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (dragElement) {\r\n            if (typeof(obj.options.ondragend) == 'function') {\r\n                obj.options.ondragend(el, dragElement.element, e);\r\n            }\r\n\r\n            // Cancelled put element to the original position\r\n            if (dragElement.o < dragElement.d) {\r\n                e.target.parentNode.insertBefore(dragElement.element, e.target.parentNode.children[dragElement.o]);\r\n            } else {\r\n                e.target.parentNode.insertBefore(dragElement.element, e.target.parentNode.children[dragElement.o].nextSibling);\r\n            }\r\n\r\n            dragElement.element.style.opacity = '';\r\n            dragElement = null;\r\n        }\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (dragElement && (dragElement.o != dragElement.d)) {\r\n            if (typeof(obj.options.ondrop) == 'function') {\r\n                obj.options.ondrop(el, dragElement.o, dragElement.d, dragElement.element, e.target, e);\r\n            }\r\n        }\r\n\r\n        dragElement.element.style.opacity = '';\r\n        dragElement = null;\r\n    });\r\n\r\n    var getElement = function(element) {\r\n        var sorting = false;\r\n\r\n        function path (element) {\r\n            if (element.className) {\r\n                if (element.classList.contains('jsorting')) {\r\n                    sorting = true;\r\n                }\r\n            }\r\n\r\n            if (! sorting) {\r\n                path(element.parentNode);\r\n            }\r\n        }\r\n\r\n        path(element);\r\n\r\n        return sorting;\r\n    }\r\n\r\n    for (var i = 0; i < el.children.length; i++) {\r\n        if (! el.children[i].hasAttribute('draggable')) {\r\n            el.children[i].setAttribute('draggable', 'true');\r\n        }\r\n    }\r\n\r\n    el.val = function() {\r\n        var id = null;\r\n        var data = [];\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            if (id = el.children[i].getAttribute('data-id')) {\r\n                data.push(id);\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n    return el;\r\n});\r\n\r\njSuites.tabs = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        data: [],\r\n        position: null,\r\n        allowCreate: false,\r\n        allowChangePosition: false,\r\n        onclick: null,\r\n        onload: null,\r\n        onchange: null,\r\n        oncreate: null,\r\n        ondelete: null,\r\n        onbeforecreate: null,\r\n        onchangeposition: null,\r\n        animation: false,\r\n        hideHeaders: false,\r\n        padding: null,\r\n        palette: null,\r\n        maxWidth: null,\r\n    }\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jtabs');\r\n\r\n    var prev = null;\r\n    var next = null;\r\n    var border = null;\r\n\r\n    // Helpers\r\n    var setBorder = function(index) {\r\n        if (obj.options.animation) {\r\n            var rect = obj.headers.children[index].getBoundingClientRect();\r\n\r\n            if (obj.options.palette == 'modern') {\r\n                border.style.width = rect.width - 4 + 'px';\r\n                border.style.left = obj.headers.children[index].offsetLeft + 2 + 'px';\r\n            } else {\r\n                border.style.width = rect.width + 'px';\r\n                border.style.left = obj.headers.children[index].offsetLeft + 'px';\r\n            }\r\n\r\n            if (obj.options.position == 'bottom') {\r\n                border.style.top = '0px';\r\n            } else {\r\n                border.style.bottom = '0px';\r\n            }\r\n        }\r\n    }\r\n\r\n    var updateControls = function(x) {\r\n        if (typeof(obj.headers.scrollTo) == 'function') {\r\n            obj.headers.scrollTo({\r\n                left: x,\r\n                behavior: 'smooth',\r\n            });\r\n        } else {\r\n            obj.headers.scrollLeft = x;\r\n        }\r\n\r\n        if (x <= 1) {\r\n            prev.classList.add('disabled');\r\n        } else {\r\n            prev.classList.remove('disabled');\r\n        }\r\n\r\n        if (x >= obj.headers.scrollWidth - obj.headers.offsetWidth) {\r\n            next.classList.add('disabled');\r\n        } else {\r\n            next.classList.remove('disabled');\r\n        }\r\n\r\n        if (obj.headers.scrollWidth <= obj.headers.offsetWidth) {\r\n            prev.style.display = 'none';\r\n            next.style.display = 'none';\r\n        } else {\r\n            prev.style.display = '';\r\n            next.style.display = '';\r\n        }\r\n    }\r\n\r\n    obj.setBorder = setBorder;\r\n\r\n    // Set value\r\n    obj.open = function(index) {\r\n        var previous = null;\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            if (obj.headers.children[i].classList.contains('jtabs-selected')) {\r\n                // Current one\r\n                previous = i;\r\n            }\r\n            // Remote selected\r\n            obj.headers.children[i].classList.remove('jtabs-selected');\r\n            if (obj.content.children[i]) {\r\n                obj.content.children[i].classList.remove('jtabs-selected');\r\n            }\r\n        }\r\n\r\n        obj.headers.children[index].classList.add('jtabs-selected');\r\n        if (obj.content.children[index]) {\r\n            obj.content.children[index].classList.add('jtabs-selected');\r\n        }\r\n\r\n        if (previous != index && typeof(obj.options.onchange) == 'function') {\r\n            if (obj.content.children[index]) {\r\n                obj.options.onchange(el, obj, index, obj.headers.children[index], obj.content.children[index]);\r\n            }\r\n        }\r\n\r\n        // Hide\r\n        if (obj.options.hideHeaders == true && (obj.headers.children.length < 3 && obj.options.allowCreate == false)) {\r\n            obj.headers.parentNode.style.display = 'none';\r\n        } else {\r\n            // Set border\r\n            setBorder(index);\r\n\r\n            obj.headers.parentNode.style.display = '';\r\n\r\n            var x1 = obj.headers.children[index].offsetLeft;\r\n            var x2 = x1 + obj.headers.children[index].offsetWidth;\r\n            var r1 = obj.headers.scrollLeft;\r\n            var r2 = r1 + obj.headers.offsetWidth;\r\n\r\n            if (! (r1 <= x1 && r2 >= x2)) {\r\n                // Out of the viewport\r\n                updateControls(x1 - 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.selectIndex = function(a) {\r\n        var index = Array.prototype.indexOf.call(obj.headers.children, a);\r\n        if (index >= 0) {\r\n            obj.open(index);\r\n        }\r\n\r\n        return index;\r\n    }\r\n\r\n    obj.rename = function(i, title) {\r\n        if (! title) {\r\n            title = prompt('New title', obj.headers.children[i].innerText);\r\n        }\r\n        obj.headers.children[i].innerText = title;\r\n        obj.open(i);\r\n    }\r\n\r\n    obj.create = function(title, url) {\r\n        if (typeof(obj.options.onbeforecreate) == 'function') {\r\n            var ret = obj.options.onbeforecreate(el);\r\n            if (ret === false) {\r\n                return false;\r\n            } else {\r\n                title = ret;\r\n            }\r\n        }\r\n\r\n        var div = obj.appendElement(title);\r\n\r\n        if (typeof(obj.options.oncreate) == 'function') {\r\n            obj.options.oncreate(el, div)\r\n        }\r\n\r\n        return div;\r\n    }\r\n\r\n    obj.remove = function(index) {\r\n        return obj.deleteElement(index);\r\n    }\r\n\r\n    obj.nextNumber = function() {\r\n        var num = 0;\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            var tmp = obj.headers.children[i].innerText.match(/[0-9].*/);\r\n            if (tmp > num) {\r\n                num = parseInt(tmp);\r\n            }\r\n        }\r\n        if (! num) {\r\n            num = 1;\r\n        } else {\r\n            num++;\r\n        }\r\n\r\n        return num;\r\n    }\r\n\r\n    obj.deleteElement = function(index) {\r\n        if (! obj.headers.children[index]) {\r\n            return false;\r\n        } else {\r\n            obj.headers.removeChild(obj.headers.children[index]);\r\n            obj.content.removeChild(obj.content.children[index]);\r\n        }\r\n\r\n        obj.open(0);\r\n\r\n        if (typeof(obj.options.ondelete) == 'function') {\r\n            obj.options.ondelete(el, index)\r\n        }\r\n    }\r\n\r\n    obj.appendElement = function(title, cb) {\r\n        if (! title) {\r\n            var title = prompt('Title?', '');\r\n        }\r\n\r\n        if (title) {\r\n            // Add content\r\n            var div = document.createElement('div');\r\n            obj.content.appendChild(div);\r\n\r\n            // Add headers\r\n            var h = document.createElement('div');\r\n            h.innerHTML = title;\r\n            h.content = div;\r\n            obj.headers.insertBefore(h, obj.headers.lastChild);\r\n\r\n            // Sortable\r\n            if (obj.options.allowChangePosition) {\r\n                h.setAttribute('draggable', 'true');\r\n            }\r\n            // Open new tab\r\n            obj.selectIndex(h);\r\n\r\n            // Callback\r\n            if (typeof(cb) == 'function') {\r\n                cb(div, h);\r\n            }\r\n\r\n            // Return element\r\n            return div;\r\n        }\r\n    }\r\n\r\n    obj.getActive = function() {\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            if (obj.headers.children[i].classList.contains('jtabs-selected')) {\r\n                return i\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    obj.updateContent = function(position, newContent) {\r\n        if (typeof newContent !== 'string') {\r\n            var contentItem = newContent;\r\n        } else {\r\n            var contentItem = document.createElement('div');\r\n            contentItem.innerHTML = newContent;\r\n        }\r\n\r\n        if (obj.content.children[position].classList.contains('jtabs-selected')) {\r\n            newContent.classList.add('jtabs-selected');\r\n        }\r\n\r\n        obj.content.replaceChild(newContent, obj.content.children[position]);\r\n    }\r\n\r\n    obj.updatePosition = function(f, t) {\r\n        // Ondrop update position of content\r\n        if (f > t) {\r\n            obj.content.insertBefore(obj.content.children[f], obj.content.children[t]);\r\n        } else {\r\n            obj.content.insertBefore(obj.content.children[f], obj.content.children[t].nextSibling);\r\n        }\r\n\r\n        // Open destination tab\r\n        obj.open(t);\r\n\r\n        // Call event\r\n        if (typeof(obj.options.onchangeposition) == 'function') {\r\n            obj.options.onchangeposition(obj.headers, f, t);\r\n        }\r\n    }\r\n\r\n    obj.move = function(f, t) {\r\n        if (f > t) {\r\n            obj.headers.insertBefore(obj.headers.children[f], obj.headers.children[t]);\r\n        } else {\r\n            obj.headers.insertBefore(obj.headers.children[f], obj.headers.children[t].nextSibling);\r\n        }\r\n\r\n        obj.updatePosition(f, t);\r\n    }\r\n\r\n    obj.setBorder = setBorder;\r\n\r\n    obj.init = function() {\r\n        el.innerHTML = '';\r\n\r\n        // Make sure the component is blank\r\n        obj.headers = document.createElement('div');\r\n        obj.content = document.createElement('div');\r\n        obj.headers.classList.add('jtabs-headers');\r\n        obj.content.classList.add('jtabs-content');\r\n\r\n        if (obj.options.palette) {\r\n            el.classList.add('jtabs-modern');\r\n        } else {\r\n            el.classList.remove('jtabs-modern');\r\n        }\r\n\r\n        // Padding\r\n        if (obj.options.padding) {\r\n            obj.content.style.padding = parseInt(obj.options.padding) + 'px';\r\n        }\r\n\r\n        // Header\r\n        var header = document.createElement('div');\r\n        header.className = 'jtabs-headers-container';\r\n        header.appendChild(obj.headers);\r\n        if (obj.options.maxWidth) {\r\n            header.style.maxWidth = parseInt(obj.options.maxWidth) + 'px';\r\n        }\r\n\r\n        // Controls\r\n        var controls = document.createElement('div');\r\n        controls.className = 'jtabs-controls';\r\n        controls.setAttribute('draggable', 'false');\r\n        header.appendChild(controls);\r\n\r\n        // Append DOM elements\r\n        if (obj.options.position == 'bottom') {\r\n            el.appendChild(obj.content);\r\n            el.appendChild(header);\r\n        } else {\r\n            el.appendChild(header);\r\n            el.appendChild(obj.content);\r\n        }\r\n\r\n        // New button\r\n        if (obj.options.allowCreate == true) {\r\n            var add = document.createElement('div');\r\n            add.className = 'jtabs-add';\r\n            add.onclick = function() {\r\n                obj.create();\r\n            }\r\n            controls.appendChild(add);\r\n        }\r\n\r\n        prev = document.createElement('div');\r\n        prev.className = 'jtabs-prev';\r\n        prev.onclick = function() {\r\n            updateControls(obj.headers.scrollLeft - obj.headers.offsetWidth);\r\n        }\r\n        controls.appendChild(prev);\r\n\r\n        next = document.createElement('div');\r\n        next.className = 'jtabs-next';\r\n        next.onclick = function() {\r\n            updateControls(obj.headers.scrollLeft + obj.headers.offsetWidth);\r\n        }\r\n        controls.appendChild(next);\r\n\r\n        // Data\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            // Title\r\n            if (obj.options.data[i].titleElement) {\r\n                var headerItem = obj.options.data[i].titleElement;\r\n            } else {\r\n                var headerItem = document.createElement('div');\r\n            }\r\n            // Icon\r\n            if (obj.options.data[i].icon) {\r\n                var iconContainer = document.createElement('div');\r\n                var icon = document.createElement('i');\r\n                icon.classList.add('material-icons');\r\n                icon.innerHTML = obj.options.data[i].icon;\r\n                iconContainer.appendChild(icon);\r\n                headerItem.appendChild(iconContainer);\r\n            }\r\n            // Title\r\n            if (obj.options.data[i].title) {\r\n                var title = document.createTextNode(obj.options.data[i].title);\r\n                headerItem.appendChild(title);\r\n            }\r\n            // Width\r\n            if (obj.options.data[i].width) {\r\n                headerItem.style.width = obj.options.data[i].width;\r\n            }\r\n            // Content\r\n            if (obj.options.data[i].contentElement) {\r\n                var contentItem = obj.options.data[i].contentElement;\r\n            } else {\r\n                var contentItem = document.createElement('div');\r\n                contentItem.innerHTML = obj.options.data[i].content;\r\n            }\r\n            obj.headers.appendChild(headerItem);\r\n            obj.content.appendChild(contentItem);\r\n        }\r\n\r\n        // Animation\r\n        border = document.createElement('div');\r\n        border.className = 'jtabs-border';\r\n        obj.headers.appendChild(border);\r\n\r\n        if (obj.options.animation) {\r\n            el.classList.add('jtabs-animation');\r\n        }\r\n\r\n        // Events\r\n        obj.headers.addEventListener(\"click\", function(e) {\r\n            if (e.target.parentNode.classList.contains('jtabs-headers')) {\r\n                var target = e.target;\r\n            } else {\r\n                if (e.target.tagName == 'I') {\r\n                    var target = e.target.parentNode.parentNode;\r\n                } else {\r\n                    var target = e.target.parentNode;\r\n                }\r\n            }\r\n\r\n            var index = obj.selectIndex(target);\r\n\r\n            if (typeof(obj.options.onclick) == 'function') {\r\n                obj.options.onclick(el, obj, index, obj.headers.children[index], obj.content.children[index]);\r\n            }\r\n        });\r\n\r\n        obj.headers.addEventListener(\"contextmenu\", function(e) {\r\n            obj.selectIndex(e.target);\r\n        });\r\n\r\n        if (obj.headers.children.length) {\r\n            // Open first tab\r\n            obj.open(0);\r\n        }\r\n\r\n        // Update controls\r\n        updateControls(0);\r\n\r\n        if (obj.options.allowChangePosition == true) {\r\n            jSuites.sorting(obj.headers, {\r\n                direction: 1,\r\n                ondrop: function(a,b,c) {\r\n                    obj.updatePosition(b,c);\r\n                },\r\n            });\r\n        }\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n    }\r\n\r\n    // Loading existing nodes as the data\r\n    if (el.children[0] && el.children[0].children.length) {\r\n        // Create from existing elements\r\n        for (var i = 0; i < el.children[0].children.length; i++) {\r\n            var item = obj.options.data && obj.options.data[i] ? obj.options.data[i] : {};\r\n\r\n            if (el.children[1] && el.children[1].children[i]) {\r\n                item.titleElement = el.children[0].children[i];\r\n                item.contentElement = el.children[1].children[i];\r\n            } else {\r\n                item.contentElement = el.children[0].children[i];\r\n            }\r\n\r\n            obj.options.data[i] = item;\r\n        }\r\n    }\r\n\r\n    // Remote controller flag\r\n    var loadingRemoteData = false;\r\n\r\n    // Create from data\r\n    if (obj.options.data) {\r\n        // Append children\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            if (obj.options.data[i].url) {\r\n                jSuites.ajax({\r\n                    url: obj.options.data[i].url,\r\n                    type: 'GET',\r\n                    dataType: 'text/html',\r\n                    index: i,\r\n                    success: function(result) {\r\n                        obj.options.data[this.index].content = result;\r\n                    },\r\n                    complete: function() {\r\n                        obj.init();\r\n                    }\r\n                });\r\n\r\n                // Flag loading\r\n                loadingRemoteData = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (! loadingRemoteData) {\r\n        obj.init();\r\n    }\r\n\r\n    el.tabs = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.tags = (function(el, options) {\r\n    // Redefine configuration\r\n    if (el.tags) {\r\n        return el.tags.setOptions(options, true);\r\n    }\r\n\r\n    var obj = { type:'tags' };\r\n    obj.options = {};\r\n\r\n    // Limit\r\n    var limit = function() {\r\n        return obj.options.limit && el.children.length >= obj.options.limit ? true : false;\r\n    }\r\n\r\n    // Search helpers\r\n    var search = null;\r\n    var searchContainer = null;\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        /**\r\n         * @typedef {Object} defaults\r\n         * @property {(string|Array)} value - Initial value of the compontent\r\n         * @property {number} limit - Max number of tags inside the element\r\n         * @property {string} search - The URL for suggestions\r\n         * @property {string} placeholder - The default instruction text on the element\r\n         * @property {validation} validation - Method to validate the tags\r\n         * @property {requestCallback} onbeforechange - Method to be execute before any changes on the element\r\n         * @property {requestCallback} onchange - Method to be execute after any changes on the element\r\n         * @property {requestCallback} onfocus - Method to be execute when on focus\r\n         * @property {requestCallback} onblur - Method to be execute when on blur\r\n         * @property {requestCallback} onload - Method to be execute when the element is loaded\r\n         */\r\n        var defaults = {\r\n            value: '',\r\n            limit: null,\r\n            limitMessage: null,\r\n            search: null,\r\n            placeholder: null,\r\n            validation: null,\r\n            onbeforechange: null,\r\n            onlimit: null,\r\n            onchange: null,\r\n            onfocus: null,\r\n            onblur: null,\r\n            onload: null,\r\n            colors: null,\r\n        }\r\n\r\n        // Loop through though the default configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('data-placeholder', obj.options.placeholder);\r\n        } else {\r\n            el.removeAttribute('data-placeholder');\r\n        }\r\n        el.placeholder = obj.options.placeholder;\r\n\r\n        // Update value\r\n        obj.setValue(obj.options.value);\r\n\r\n        // Validate items\r\n        filter();\r\n\r\n        // Create search box\r\n        if (obj.options.search) {\r\n            if (! searchContainer) {\r\n                searchContainer = document.createElement('div');\r\n                el.parentNode.insertBefore(searchContainer, el.nextSibling);\r\n\r\n                // Create container\r\n                search = jSuites.search(searchContainer, {\r\n                    data: obj.options.search,\r\n                    onselect: function(a,b,c) {\r\n                        obj.selectIndex(b,c);\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            if (searchContainer) {\r\n                search = null;\r\n                searchContainer.remove();\r\n                searchContainer = null;\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Add a new tag to the element\r\n     * @param {(?string|Array)} value - The value of the new element\r\n     */\r\n    obj.add = function(value, focus) {\r\n        if (typeof(obj.options.onbeforechange) == 'function') {\r\n            var ret = obj.options.onbeforechange(el, obj, obj.options.value, value);\r\n            if (ret === false) {\r\n                return false;\r\n            } else { \r\n                if (ret != null) {\r\n                    value = ret;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Make sure search is closed\r\n        if (search) {\r\n            search.close();\r\n        }\r\n\r\n        if (limit()) {\r\n            if (typeof(obj.options.onlimit) == 'function') {\r\n                obj.options.onlimit(obj, obj.options.limit);\r\n            } else if (obj.options.limitMessage) {\r\n                alert(obj.options.limitMessage + ' ' + obj.options.limit);\r\n            }\r\n        } else {\r\n            // Get node\r\n            var node = jSuites.getNode();\r\n\r\n            if (node && node.parentNode && node.parentNode.classList.contains('jtags') &&\r\n                node.nextSibling && (! (node.nextSibling.innerText && node.nextSibling.innerText.trim()))) {\r\n                div = node.nextSibling;\r\n            } else {\r\n                // Remove not used last item\r\n                if (el.lastChild) {\r\n                    if (! el.lastChild.innerText.trim()) {\r\n                        el.removeChild(el.lastChild);\r\n                    }\r\n                }\r\n\r\n                // Mix argument string or array\r\n                if (! value || typeof(value) == 'string') {\r\n                    var div = createElement(value, value, node);\r\n                } else {\r\n                    for (var i = 0; i <= value.length; i++) {\r\n                        if (! limit()) {\r\n                            if (! value[i] || typeof(value[i]) == 'string') {\r\n                                var t = value[i] || '';\r\n                                var v = null;\r\n                            } else {\r\n                                var t = value[i].text;\r\n                                var v = value[i].value;\r\n                            }\r\n\r\n                            // Add element\r\n                            var div = createElement(t, v);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Change\r\n                change();\r\n            }\r\n\r\n            // Place caret\r\n            if (focus) {\r\n                setFocus(div);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.setLimit = function(limit) {\r\n        obj.options.limit = limit;\r\n        var n = el.children.length - limit;\r\n        while (el.children.length > limit) {\r\n            el.removeChild(el.lastChild);\r\n        }\r\n    }\r\n\r\n    // Remove a item node\r\n    obj.remove = function(node) {\r\n        // Remove node\r\n        node.parentNode.removeChild(node);\r\n        // Make sure element is not blank\r\n        if (! el.children.length) {\r\n            obj.add('', true);\r\n        } else {\r\n            change();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get all tags in the element\r\n     * @return {Array} data - All tags as an array\r\n     */\r\n    obj.getData = function() {\r\n        var data = [];\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            // Get value\r\n            var text = el.children[i].innerText.replace(\"\\n\", \"\");\r\n            // Get id\r\n            var value = el.children[i].getAttribute('data-value');\r\n            if (! value) {\r\n                value = text;\r\n            }\r\n            // Item\r\n            if (text || value) {\r\n                data.push({ text: text, value: value });\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Get the value of one tag. Null for all tags\r\n     * @param {?number} index - Tag index number. Null for all tags.\r\n     * @return {string} value - All tags separated by comma\r\n     */\r\n    obj.getValue = function(index) {\r\n        var value = null;\r\n\r\n        if (index != null) {\r\n            // Get one individual value\r\n            value = el.children[index].getAttribute('data-value');\r\n            if (! value) {\r\n                value = el.children[index].innerText.replace(\"\\n\", \"\");\r\n            }\r\n        } else {\r\n            // Get all\r\n            var data = [];\r\n            for (var i = 0; i < el.children.length; i++) {\r\n                value = el.children[i].innerText.replace(\"\\n\", \"\");\r\n                if (value) {\r\n                    data.push(obj.getValue(i));\r\n                }\r\n            }\r\n            value = data.join(',');\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Set the value of the element based on a string separeted by (,|;|\\r\\n)\r\n     * @param {mixed} value - A string or array object with values\r\n     */\r\n    obj.setValue = function(mixed) {\r\n        if (! mixed) {\r\n            obj.reset();\r\n        } else {\r\n            if (el.value != mixed) {\r\n                if (Array.isArray(mixed)) {\r\n                    obj.add(mixed);\r\n                } else {\r\n                    // Remove whitespaces\r\n                    var text = (''+mixed).trim();\r\n                    // Tags\r\n                    var data = extractTags(text);\r\n                    // Reset\r\n                    el.innerHTML = '';\r\n                    // Add tags to the element\r\n                    obj.add(data);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reset the data from the element\r\n     */\r\n    obj.reset = function() {\r\n        // Empty class\r\n        el.classList.add('jtags-empty');\r\n        // Empty element\r\n        el.innerHTML = '<div></div>';\r\n        // Execute changes\r\n        change();\r\n    }\r\n\r\n    /**\r\n     * Verify if all tags in the element are valid\r\n     * @return {boolean}\r\n     */\r\n    obj.isValid = function() {\r\n        var test = 0;\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            if (el.children[i].classList.contains('jtags_error')) {\r\n                test++;\r\n            }\r\n        }\r\n        return test == 0 ? true : false;\r\n    }\r\n\r\n    /**\r\n     * Add one element from the suggestions to the element\r\n     * @param {object} item - Node element in the suggestions container\r\n     */ \r\n    obj.selectIndex = function(text, value) {\r\n        var node = jSuites.getNode();\r\n        if (node) {\r\n            // Append text to the caret\r\n            node.innerText = text;\r\n            // Set node id\r\n            if (value) {\r\n                node.setAttribute('data-value', value);\r\n            }\r\n            // Remove any error\r\n            node.classList.remove('jtags_error');\r\n            if (! limit()) {\r\n                // Add new item\r\n                obj.add('', true);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Search for suggestions\r\n     * @param {object} node - Target node for any suggestions\r\n     */\r\n    obj.search = function(node) {\r\n        // Search for\r\n        var terms = node.innerText;\r\n    }\r\n\r\n    // Destroy tags element\r\n    obj.destroy = function() {\r\n        // Bind events\r\n        el.removeEventListener('mouseup', tagsMouseUp);\r\n        el.removeEventListener('keydown', tagsKeyDown);\r\n        el.removeEventListener('keyup', tagsKeyUp);\r\n        el.removeEventListener('paste', tagsPaste);\r\n        el.removeEventListener('focus', tagsFocus);\r\n        el.removeEventListener('blur', tagsBlur);\r\n\r\n        // Remove element\r\n        el.parentNode.removeChild(el);\r\n    }\r\n\r\n    var setFocus = function(node) {\r\n        if (el.children.length > 1) {\r\n            var range = document.createRange();\r\n            var sel = window.getSelection();\r\n            if (! node) {\r\n                var node = el.childNodes[el.childNodes.length-1];\r\n            }\r\n            range.setStart(node, node.length)\r\n            range.collapse(true)\r\n            sel.removeAllRanges()\r\n            sel.addRange(range)\r\n            el.scrollLeft = el.scrollWidth;\r\n        }\r\n    }\r\n\r\n    var createElement = function(label, value, node) {\r\n        var div = document.createElement('div');\r\n        div.innerHTML = label ? label : '';\r\n        if (value) {\r\n            div.setAttribute('data-value', value);\r\n        }\r\n\r\n        if (node && node.parentNode.classList.contains('jtags')) {\r\n            el.insertBefore(div, node.nextSibling);\r\n        } else {\r\n            el.appendChild(div);\r\n        }\r\n\r\n        return div;\r\n    }\r\n\r\n    var change = function() {\r\n        // Value\r\n        var value = obj.getValue();\r\n\r\n        if (value != obj.options.value) {\r\n            obj.options.value = value;\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, obj, obj.options.value);\r\n            }\r\n\r\n            // Lemonade JS\r\n            if (el.value != obj.options.value) {\r\n                el.value = obj.options.value;\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        filter();\r\n    }\r\n\r\n    /**\r\n     * Filter tags\r\n     */\r\n    var filter = function() {\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            // Create label design\r\n            if (! obj.getValue(i)) {\r\n                el.children[i].classList.remove('jtags_label');\r\n            } else {\r\n                el.children[i].classList.add('jtags_label');\r\n\r\n                // Validation in place\r\n                if (typeof(obj.options.validation) == 'function') {\r\n                    if (obj.getValue(i)) {\r\n                        if (! obj.options.validation(el.children[i], el.children[i].innerText, el.children[i].getAttribute('data-value'))) {\r\n                            el.children[i].classList.add('jtags_error');\r\n                        } else {\r\n                            el.children[i].classList.remove('jtags_error');\r\n                        }\r\n                    } else {\r\n                        el.children[i].classList.remove('jtags_error');\r\n                    }\r\n                } else {\r\n                    el.children[i].classList.remove('jtags_error');\r\n                }\r\n            }\r\n        }\r\n\r\n        isEmpty();\r\n    }\r\n\r\n    var isEmpty = function() {\r\n        // Can't be empty\r\n        if (! el.innerText.trim()) {\r\n            el.innerHTML = '<div></div>';\r\n            el.classList.add('jtags-empty');\r\n        } else {\r\n            el.classList.remove('jtags-empty');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract tags from a string\r\n     * @param {string} text - Raw string\r\n     * @return {Array} data - Array with extracted tags\r\n     */\r\n    var extractTags = function(text) {\r\n        /** @type {Array} */\r\n        var data = [];\r\n\r\n        /** @type {string} */\r\n        var word = '';\r\n\r\n        // Remove whitespaces\r\n        text = text.trim();\r\n\r\n        if (text) {\r\n            for (var i = 0; i < text.length; i++) {\r\n                if (text[i] == ',' || text[i] == ';' || text[i] == '\\n') {\r\n                    if (word) {\r\n                        data.push(word.trim());\r\n                        word = '';\r\n                    }\r\n                } else {\r\n                    word += text[i];\r\n                }\r\n            }\r\n\r\n            if (word) {\r\n                data.push(word);\r\n            }\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    /** @type {number} */\r\n    var anchorOffset = 0;\r\n\r\n    /**\r\n     * Processing event keydown on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsKeyDown = function(e) {\r\n        // Anchoroffset\r\n        anchorOffset = window.getSelection().anchorOffset;\r\n\r\n        // Verify if is empty\r\n        isEmpty();\r\n\r\n        // Comma\r\n        if (e.key === 'Tab'  || e.key === ';' || e.key === ',') {\r\n            var n = window.getSelection().anchorOffset;\r\n            if (n > 1) {\r\n                if (limit()) {\r\n                    if (typeof(obj.options.onlimit) == 'function') {\r\n                        obj.options.onlimit(obj, obj.options.limit)\r\n                    }\r\n                } else {\r\n                    obj.add('', true);\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.key == 'Enter') {\r\n            if (! search || ! search.isOpened()) {\r\n                var n = window.getSelection().anchorOffset;\r\n                if (n > 1) {\r\n                    if (! limit()) {\r\n                        obj.add('', true);\r\n                    }\r\n                }\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.key == 'Backspace') {\r\n            // Back space - do not let last item to be removed\r\n            if (el.children.length == 1 && window.getSelection().anchorOffset < 1) {\r\n                e.preventDefault();\r\n            }\r\n        }\r\n\r\n        // Search events\r\n        if (search) {\r\n            search.keydown(e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event keyup on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsKeyUp = function(e) {\r\n        if (e.which == 39) {\r\n            // Right arrow\r\n            var n = window.getSelection().anchorOffset;\r\n            if (n > 1 && n == anchorOffset) {\r\n                obj.add('', true);\r\n            }\r\n        } else if (e.which == 13 || e.which == 38 || e.which == 40) {\r\n            e.preventDefault();\r\n        } else {\r\n            if (search) {\r\n                search.keyup(e);\r\n            }\r\n        }\r\n\r\n        filter();\r\n    }\r\n\r\n    /**\r\n     * Processing event paste on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsPaste =  function(e) {\r\n        if (e.clipboardData || e.originalEvent.clipboardData) {\r\n            var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n        } else if (window.clipboardData) {\r\n            var text = window.clipboardData.getData('Text');\r\n        }\r\n\r\n        var data = extractTags(text);\r\n        if (data.length > 1) {\r\n            obj.add(data, true);\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event mouseup on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsMouseUp = function(e) {\r\n        if (e.target.parentNode && e.target.parentNode.classList.contains('jtags')) {\r\n            if (e.target.classList.contains('jtags_label') || e.target.classList.contains('jtags_error')) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                if (rect.width - (e.clientX - rect.left) < 16) {\r\n                    obj.remove(e.target);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Set focus in the last item\r\n        if (e.target == el) {\r\n            setFocus();\r\n        }\r\n    }\r\n\r\n    var tagsFocus = function() {\r\n        if (! el.classList.contains('jtags-focus')) {\r\n            if (! el.children.length || obj.getValue(el.children.length - 1)) {\r\n                if (! limit()) {\r\n                    createElement('');\r\n                }\r\n            }\r\n\r\n            if (typeof(obj.options.onfocus) == 'function') {\r\n                obj.options.onfocus(el, obj, obj.getValue());\r\n            }\r\n\r\n            el.classList.add('jtags-focus');\r\n        }\r\n    }\r\n\r\n    var tagsBlur = function() {\r\n        if (el.classList.contains('jtags-focus')) {\r\n            if (search) {\r\n                search.close();\r\n            }\r\n\r\n            for (var i = 0; i < el.children.length - 1; i++) {\r\n                // Create label design\r\n                if (! obj.getValue(i)) {\r\n                    el.removeChild(el.children[i]);\r\n                }\r\n            }\r\n\r\n            change();\r\n\r\n            el.classList.remove('jtags-focus');\r\n\r\n            if (typeof(obj.options.onblur) == 'function') {\r\n                obj.options.onblur(el, obj, obj.getValue());\r\n            }\r\n        }\r\n    }\r\n\r\n    var init = function() {\r\n        // Bind events\r\n        if ('touchend' in document.documentElement === true) {\r\n            el.addEventListener('touchend', tagsMouseUp);\r\n        } else {\r\n            el.addEventListener('mouseup', tagsMouseUp);\r\n        }\r\n\r\n        el.addEventListener('keydown', tagsKeyDown);\r\n        el.addEventListener('keyup', tagsKeyUp);\r\n        el.addEventListener('paste', tagsPaste);\r\n        el.addEventListener('focus', tagsFocus);\r\n        el.addEventListener('blur', tagsBlur);\r\n\r\n        // Editable\r\n        el.setAttribute('contenteditable', true);\r\n\r\n        // Prepare container\r\n        el.classList.add('jtags');\r\n\r\n        // Initial options\r\n        obj.setOptions(options);\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n\r\n        // Change methods\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        el.tags = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.toolbar = (function(el, options) {\r\n    // New instance\r\n    var obj = { type:'toolbar' };\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        app: null,\r\n        container: false,\r\n        badge: false,\r\n        title: false,\r\n        responsive: false,\r\n        maxWidth: null,\r\n        items: [],\r\n    }\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    if (! el && options.app && options.app.el) {\r\n        el = document.createElement('div');\r\n        options.app.el.appendChild(el);\r\n    }\r\n\r\n    // Arrow\r\n    var toolbarArrow = document.createElement('div');\r\n    toolbarArrow.classList.add('jtoolbar-item');\r\n    toolbarArrow.classList.add('jtoolbar-arrow');\r\n\r\n    var toolbarFloating = document.createElement('div');\r\n    toolbarFloating.classList.add('jtoolbar-floating');\r\n    toolbarArrow.appendChild(toolbarFloating);\r\n\r\n    obj.selectItem = function(element) {\r\n        var elements = toolbarContent.children;\r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (element != elements[i]) {\r\n                elements[i].classList.remove('jtoolbar-selected');\r\n            }\r\n        }\r\n        element.classList.add('jtoolbar-selected');\r\n    }\r\n\r\n    obj.hide = function() {\r\n        jSuites.animation.slideBottom(el, 0, function() {\r\n            el.style.display = 'none';\r\n        });\r\n    }\r\n\r\n    obj.show = function() {\r\n        el.style.display = '';\r\n        jSuites.animation.slideBottom(el, 1);\r\n    }\r\n\r\n    obj.get = function() {\r\n        return el;\r\n    }\r\n\r\n    obj.setBadge = function(index, value) {\r\n        toolbarContent.children[index].children[1].firstChild.innerHTML = value;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        toolbar.remove();\r\n        el.innerHTML = '';\r\n    }\r\n\r\n    obj.update = function(a, b) {\r\n        for (var i = 0; i < toolbarContent.children.length; i++) {\r\n            // Toolbar element\r\n            var toolbarItem = toolbarContent.children[i];\r\n            // State management\r\n            if (typeof(toolbarItem.updateState) == 'function') {\r\n                toolbarItem.updateState(el, obj, toolbarItem, a, b);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.create = function(items) {\r\n        // Reset anything in the toolbar\r\n        toolbarContent.innerHTML = '';\r\n        // Create elements in the toolbar\r\n        for (var i = 0; i < items.length; i++) {\r\n            var toolbarItem = document.createElement('div');\r\n            toolbarItem.classList.add('jtoolbar-item');\r\n\r\n            if (items[i].width) {\r\n                toolbarItem.style.width = parseInt(items[i].width) + 'px'; \r\n            }\r\n\r\n            if (items[i].k) {\r\n                toolbarItem.k = items[i].k;\r\n            }\r\n\r\n            if (items[i].tooltip) {\r\n                toolbarItem.setAttribute('title', items[i].tooltip);\r\n            }\r\n\r\n            // Id\r\n            if (items[i].id) {\r\n                toolbarItem.setAttribute('id', items[i].id);\r\n            }\r\n\r\n            // Selected\r\n            if (items[i].updateState) {\r\n                toolbarItem.updateState = items[i].updateState;\r\n            }\r\n\r\n            if (items[i].active) {\r\n                toolbarItem.classList.add('jtoolbar-active');\r\n            }\r\n\r\n            if (items[i].type == 'select' || items[i].type == 'dropdown') {\r\n                jSuites.picker(toolbarItem, items[i]);\r\n            } else if (items[i].type == 'divisor') {\r\n                toolbarItem.classList.add('jtoolbar-divisor');\r\n            } else if (items[i].type == 'label') {\r\n                toolbarItem.classList.add('jtoolbar-label');\r\n                toolbarItem.innerHTML = items[i].content;\r\n            } else {\r\n                // Material icons\r\n                var toolbarIcon = document.createElement('i');\r\n                if (typeof(items[i].class) === 'undefined') {\r\n                    toolbarIcon.classList.add('material-icons');\r\n                } else {\r\n                    var c = items[i].class.split(' ');\r\n                    for (var j = 0; j < c.length; j++) {\r\n                        toolbarIcon.classList.add(c[j]);\r\n                    }\r\n                }\r\n                toolbarIcon.innerHTML = items[i].content ? items[i].content : '';\r\n                toolbarItem.appendChild(toolbarIcon);\r\n\r\n                // Badge options\r\n                if (obj.options.badge == true) {\r\n                    var toolbarBadge = document.createElement('div');\r\n                    toolbarBadge.classList.add('jbadge');\r\n                    var toolbarBadgeContent = document.createElement('div');\r\n                    toolbarBadgeContent.innerHTML = items[i].badge ? items[i].badge : '';\r\n                    toolbarBadge.appendChild(toolbarBadgeContent);\r\n                    toolbarItem.appendChild(toolbarBadge);\r\n                }\r\n\r\n                // Title\r\n                if (items[i].title) {\r\n                    if (obj.options.title == true) {\r\n                        var toolbarTitle = document.createElement('span');\r\n                        toolbarTitle.innerHTML = items[i].title;\r\n                        toolbarItem.appendChild(toolbarTitle);\r\n                    } else {\r\n                        toolbarItem.setAttribute('title', items[i].title);\r\n                    }\r\n                }\r\n\r\n                if (obj.options.app && items[i].route) {\r\n                    // Route\r\n                    toolbarItem.route = items[i].route;\r\n                    // Onclick for route\r\n                    toolbarItem.onclick = function() {\r\n                        obj.options.app.pages(this.route);\r\n                    }\r\n                    // Create pages\r\n                    obj.options.app.pages(items[i].route, {\r\n                        toolbarItem: toolbarItem,\r\n                        closed: true\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (items[i].onclick) {\r\n                toolbarItem.onclick = items[i].onclick.bind(items[i], el, obj, toolbarItem);\r\n            }\r\n\r\n            toolbarContent.appendChild(toolbarItem);\r\n        }\r\n\r\n        // Fits to the page\r\n        obj.refresh();\r\n    }\r\n\r\n    obj.open = function() {\r\n        toolbarArrow.classList.add('jtoolbar-arrow-selected');\r\n\r\n        var rect = toolbarFloating.getBoundingClientRect();\r\n        if (rect.bottom > window.innerHeight) {\r\n            toolbarFloating.style.bottom = '0';\r\n        } else {\r\n            toolbarFloating.style.removeProperty('bottom');\r\n        }\r\n\r\n        toolbarFloating.style.right = '0';\r\n\r\n        toolbarArrow.children[0].focus();\r\n        // Start tracking\r\n        jSuites.tracking(obj, true);\r\n    }\r\n\r\n    obj.close = function() {\r\n        toolbarArrow.classList.remove('jtoolbar-arrow-selected')\r\n        // End tracking\r\n        jSuites.tracking(obj, false);\r\n    }\r\n\r\n    obj.refresh = function() {\r\n        if (obj.options.responsive == true) {\r\n            // Width of the c\r\n            var rect = el.parentNode.getBoundingClientRect();\r\n            if (! obj.options.maxWidth) {\r\n                obj.options.maxWidth = rect.width;\r\n            }\r\n            // Max width\r\n            var width = parseInt(obj.options.maxWidth); \r\n            // Remove arrow\r\n            toolbarArrow.remove();\r\n            // Move all items to the toolbar\r\n            while (toolbarFloating.firstChild) {\r\n                toolbarContent.appendChild(toolbarFloating.firstChild);\r\n            }\r\n            // Available parent space\r\n            var available = obj.options.maxWidth;\r\n            // Toolbar is larger than the parent, move elements to the floating element\r\n            if (available < toolbarContent.offsetWidth) {\r\n                // Give space to the floating element\r\n                available -= 50;\r\n                // Move to the floating option\r\n                while (toolbarContent.lastChild && available < toolbarContent.offsetWidth) {\r\n                    toolbarFloating.insertBefore(toolbarContent.lastChild, toolbarFloating.firstChild);\r\n                }\r\n            }\r\n            // Show arrow\r\n            if (toolbarFloating.children.length > 0) {\r\n                toolbarContent.appendChild(toolbarArrow);\r\n            }\r\n        }\r\n    }\r\n\r\n    el.onclick = function(e) {\r\n        var element = jSuites.findElement(e.target, 'jtoolbar-item');\r\n        if (element) {\r\n            obj.selectItem(element);\r\n        }\r\n\r\n        if (e.target.classList.contains('jtoolbar-arrow')) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    window.addEventListener('resize', function() {\r\n        obj.refresh();\r\n    });\r\n\r\n    // Toolbar\r\n    el.classList.add('jtoolbar');\r\n    // Reset content\r\n    el.innerHTML = '';\r\n    // Container\r\n    if (obj.options.container == true) {\r\n        el.classList.add('jtoolbar-container');\r\n    }\r\n    // Content\r\n    var toolbarContent = document.createElement('div');\r\n    el.appendChild(toolbarContent);\r\n    // Special toolbar for mobile applications\r\n    if (obj.options.app) {\r\n        el.classList.add('jtoolbar-mobile');\r\n    }\r\n    // Create toolbar\r\n    obj.create(obj.options.items);\r\n    // Shortcut\r\n    el.toolbar = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.validations = function(value, options) {\r\n    if (typeof(jSuites.validations[options.type]) === 'function') {\r\n        return jSuites.validations[options.type](value, options);\r\n    }\r\n    return null;\r\n};\r\n\r\n// Legacy\r\njSuites.validations.email = function(data) {\r\n    var pattern = new RegExp(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/);\r\n    return data && pattern.test(data) ? true : false; \r\n}\r\n\r\njSuites.validations.required = function(data) {\r\n    return data.trim() ? true : false;\r\n}\r\n\r\njSuites.validations.number = function(data) {\r\n    return jSuites.isNumber(data);\r\n}\r\n\r\njSuites.validations.login = function(data) {\r\n    var pattern = new RegExp(/^[a-zA-Z0-9\\_\\-\\.\\s+]+$/);\r\n    return data && pattern.test(data) ? true : false;\r\n}\r\n\r\n/**\r\n * Options: Object,\r\n * Properties: \r\n * Constraint,\r\n * Reference,\r\n * Value\r\n */\r\n\r\nvar valueComparisons = function(data, options) {\r\n    if (options.constraint === '=') {\r\n        return data === options.reference;\r\n    }\r\n    if (options.constraint === '<') {\r\n        return data < options.reference;\r\n    }\r\n    if (options.constraint === '<=') {\r\n        return data <= options.reference;\r\n    }\r\n    if (options.constraint === '>') {\r\n        return data > options.reference;\r\n    }\r\n    if (options.constraint === '>=') {\r\n        return data >= options.reference;\r\n    }\r\n    if (options.constraint === 'between') {\r\n        return data >= options.reference[0] && data <= options.reference[1];\r\n    }\r\n    if (options.constraint === 'not between') {\r\n        return data < options.reference[0] || data > options.reference[1];\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\njSuites.validations.number = function(data, options) {\r\n    if (!jSuites.isNumeric(data)) {\r\n        return false;\r\n    }\r\n\r\n    if (options === undefined || options.constraint === undefined) {\r\n        return true;\r\n    }\r\n\r\n    return valueComparisons(data, options);\r\n}\r\n\r\njSuites.validations.date = function(data, options) {\r\n    if (new Date(data) == 'Invalid Date') {\r\n        return false;\r\n    }\r\n\r\n    if (options === undefined || options.constraint === undefined) {\r\n        return true;\r\n    } else if (typeof(options) === 'object') {\r\n        data = new Date(data).getTime();\r\n\r\n        if (Array.isArray(options.reference)) {\r\n            options.reference = options.reference.map(function(reference) {\r\n                return new Date(reference).getTime();\r\n            });\r\n        } else {\r\n            options.reference = new Date(options.reference).getTime();\r\n        }\r\n\r\n        return valueComparisons(data, options);\r\n    }\r\n    return null;\r\n}\r\n\r\njSuites.validations.itemList = function(data, options) {\r\n    return options.reference.some(function(reference) {\r\n        return reference == data;\r\n    });\r\n}\r\n\r\njSuites.validations.text = function(data, options) {\r\n    if (typeof data !== 'string') {\r\n        return false;\r\n    }\r\n\r\n    if (options === undefined || options.constraint === undefined) {\r\n        return true;\r\n    }\r\n    if (options.constraint === '=') {\r\n        return data === options.reference;\r\n    }\r\n    if (options.constraint === 'contains') {\r\n        return data.includes(options.reference);\r\n    }\r\n    if (options.constraint === 'not contain') {\r\n        return !data.includes(options.reference);\r\n    }\r\n    if (options.constraint === 'email') {\r\n        return jSuites.validations.email(data);\r\n    }\r\n    if (options.constraint === 'url') {\r\n        var pattern = new RegExp(/(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig);\r\n        return pattern.test(data) ? true : false;\r\n    }\r\n    return null;\r\n}\r\n\r\njSuites.validations.constraints = function() {\r\n}\r\n\r\n\r\n\r\n    return jSuites;\r\n\r\n})));", "\r\n/**\r\n * (c) jSuites Javascript Web Components\r\n *\r\n * Website: https://jsuites.net\r\n * Description: Create amazing web based applications.\r\n *\r\n * MIT License\r\n *\r\n */\r\n\r\n/** Buttons **/\r\n\r\n.jbutton {\r\n    padding: 8px;\r\n    padding-left: 15px;\r\n    padding-right: 15px;\r\n    border: 1px solid #ddd;\r\n    border-radius: 2px;\r\n    cursor:pointer;\r\n    -webkit-font-smoothing: antialiased;\r\n    outline: none;\r\n}\r\n\r\n.jbutton.dark {\r\n    background-color: #737373;\r\n    border: 1px solid transparent;\r\n    color: #fff;\r\n}\r\n\r\n.jbutton.red {\r\n    background-color: #a23131;\r\n    border: 1px solid transparent;\r\n    color: #fff;\r\n}\r\n\r\n.jbutton.blue {\r\n    border:1px solid transparent;\r\n    color:#fff;\r\n    background-color:#1a73e8;\r\n}\r\n\r\n.jbutton.mobile {\r\n    padding:4px;\r\n    padding-left:25px;\r\n    padding-right:25px;\r\n    cursor:pointer;\r\n    min-width:100px;\r\n    outline:none;\r\n}\r\n\r\n.jbutton[data-icon] {\r\n    display: flex;\r\n}\r\n\r\n.jbutton[data-icon].center {\r\n    -webkit-justify-content: center;\r\n    justify-content: center;\r\n    padding-right:20px;\r\n}\r\n\r\n.jbutton[data-icon]::before {\r\n    content: attr(data-icon);\r\n    width: 24px;\r\n    height: 24px;\r\n    font-size: 24px;\r\n    line-height: 24px;\r\n    font-family: 'Material icons';\r\n    color: #999;\r\n    margin-right:2px;\r\n    color: #fff;\r\n}\r\n\r\n.jbutton:hover {\r\n    opacity: 0.8;\r\n    text-decoration: underline;\r\n}\r\n\r\n.jbutton[disabled] {\r\n    opacity: 0.5;\r\n    text-decoration: none;\r\n}\r\n\r\n@media only screen and (max-width : 800px) {\r\n    .jbutton {\r\n        margin: 2px;\r\n    }\r\n}\r\n\r\n.jbuttons-group {\r\n    display: flex;\r\n    cursor: pointer;\r\n    align-items: center;\r\n    justify-content: center;\r\n    -webkit-tap-highlight-color: transparent;\r\n}\r\n\r\n.jbuttons-group .jbutton {\r\n    border-radius: 0px;\r\n    border: 1px solid gray;\r\n    margin: 0px;\r\n    font-size: 0.9em;\r\n}\r\n\r\n.jbuttons-group.mobile .jbutton {\r\n    border-color: var(--active-color);\r\n    color: var(--active-color);\r\n    padding:4px;\r\n    padding-left:25px;\r\n    padding-right:25px;\r\n    cursor:pointer;\r\n    min-width:100px;\r\n    outline:none;\r\n}\r\n\r\n.jbuttons-group .jbutton.selected {\r\n    color: white;\r\n    background-color: var(--active-color);\r\n}\r\n\r\n.jbuttons-group .jbutton:first-child {\r\n    border-top-left-radius: 4px;\r\n    border-bottom-left-radius: 4px;\r\n}\r\n\r\n.jbuttons-group .jbutton:last-child {\r\n    border-top-right-radius: 4px;\r\n    border-bottom-right-radius: 4px;\r\n}\r\n\r\n/*.button-plain {\r\n    border:0px;\r\n    background-color:transparent;\r\n    cursor:pointer;\r\n    outline: none;\r\n}\r\n\r\n.button-dark {\r\n    background-color:#737373;\r\n    color:#fff;\r\n    border:1px solid transparent;\r\n    border-radius:2px;\r\n    cursor:pointer;\r\n    min-width:120px;\r\n    outline:none;\r\n}\r\n\r\n.button-dark:disabled {\r\n    background-color:#d3d3d3;\r\n    color:#a3a3a3;\r\n}\r\n\r\n.button-light {\r\n    background-color:#fff;\r\n    color:#737373;\r\n    border:1px solid #737373;\r\n    border-radius:2px;\r\n    cursor:pointer;\r\n    min-width:120px;\r\n    outline:none;\r\n}\r\n\r\n.button-light:disabled {\r\n    color:#a3a3a3;\r\n}\r\n\r\n.button-red {\r\n    background-color:#733333;\r\n    color:#fff;\r\n    border:1px solid transparent;\r\n    border-radius:2px;\r\n    cursor:pointer;\r\n    min-width:120px;\r\n    outline:none;\r\n}*/\r\n\r\n\r\n\r\n\r\n/** Switch **/\r\n\r\n.jswitch {\r\n    display: flex;\r\n    cursor: pointer;\r\n    -webkit-tap-highlight-color: transparent;\r\n    align-items: center;\r\n}\r\n\r\n.jswitch i {\r\n    position: relative;\r\n    display: inline-block;\r\n    width: 46px;\r\n    height: 26px;\r\n    background-color: #e6e6e6;\r\n    border-radius: 23px;\r\n    vertical-align: text-bottom;\r\n    transition: all 0.3s linear;\r\n}\r\n\r\n.jswitch i::before {\r\n  content: \"\";\r\n  position: absolute;\r\n  left: 0;\r\n  width: 42px;\r\n  height: 22px;\r\n  background-color: #fff;\r\n  border-radius: 11px;\r\n  transform: translate3d(2px, 2px, 0) scale3d(1, 1, 1);\r\n  transition: all 0.25s linear;\r\n}\r\n\r\n.jswitch i::after {\r\n  content: \"\";\r\n  position: absolute;\r\n  left: 0;\r\n  width: 22px;\r\n  height: 22px;\r\n  background-color: #fff;\r\n  border-radius: 11px;\r\n  box-shadow: 0 2px 2px rgba(0, 0, 0, 0.24);\r\n  transform: translate3d(2px, 2px, 0);\r\n  transition: all 0.2s ease-in-out;\r\n}\r\n\r\n.jswitch:active i::after {\r\n  width: 28px;\r\n  transform: translate3d(2px, 2px, 0);\r\n}\r\n\r\n.jswitch:active input:checked + i::after { transform: translate3d(16px, 2px, 0); }\r\n\r\n.jswitch input { display: none; }\r\n\r\n.jswitch input:checked + i { background-color: #4BD763; }\r\n\r\n.jswitch input:checked + i::before { transform: translate3d(18px, 2px, 0) scale3d(0, 0, 0); }\r\n\r\n.jswitch input:checked + i::after { transform: translate3d(22px, 2px, 0); }\r\n\r\n.jrange {\r\n    -webkit-appearance: none;\r\n    width: 100%;\r\n    height: 4px;\r\n    background: #d3d3d3;\r\n    outline: none;\r\n    opacity: 0.7;\r\n    -webkit-transition: .2s;\r\n    transition: opacity .2s;\r\n    padding: 0px;\r\n}\r\n\r\n.jrange:hover {\r\n  opacity: 1;\r\n}\r\n\r\n.jrange::-webkit-slider-thumb {\r\n  background: #4CAF50;\r\n  cursor: pointer;\r\n}\r\n\r\n.jrange::-moz-range-thumb {\r\n  background: #4CAF50;\r\n  cursor: pointer;\r\n}\r\n\r\n.jcrop {\r\n    position: relative;\r\n    overflow: hidden;\r\n}\r\n.jcrop-area {\r\n    position: absolute;\r\n    border: 1px solid transparent;\r\n    background: url('data:image/gif;base64,R0lGODlhWAIBAPAAAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAAABACwAAAAAWAIBAAACQ0QeoIbL51BaMjZ6VcWQT509n2h1oEl65bidbNim7kqr9nzLeszDPtoD/l7CIvFYwyl3wyTT6Awic9Jok3pdVrFQRQEAIfkECQAAAQAsAAAAAFgCAQAAAkIEgmGWur1OivBNi+hlW2bscJ8YemVFaqOpnh3Kgu0s16kd33rOw/4LXP2EQRfxaEzSdkMlrrnsFaPQ59SKpF6Z1wIAIfkECQAAAQAsAAAAAFgCAQAAAkKEg2GXC6kWdFM2i+hlGUf+PZvYgVpJhpXpneq4pu7c1uwt2zke9/CP8gWBr6GxiKTxiMqdU5jUQZtTKdN6pF6X2QIAIfkECQAAAQAsAAAAAFgCAQAAAkOEERmHyroOfE5WM22iW0d8NR04ip/JnRmphivqpXJMs7Ndw/iu9+/vCpaAQ2GriDwqbz4jk7jMQZ9OaZU3tSapSEABACH5BAkAAAEALAAAAABYAgEAAAJDDA6hhsvnUFoyNnpVxZBPnT2faHWgSXrluJ1s2KbuSqv2fMt6zMM+2gP+XsIi8VjDKXfDJNPoDCJz0miTel1WsVBFAQAh+QQJAAABACwAAAAAWAIBAAACQkyAYJa6vU6K8E2L6GVbZuxwnxh6ZUVqo6meHcqC7SzXqR3fes7D/gtc/YRBF/FoTNJ2QyWuuewVo9Dn1IqkXpnXAgAh+QQJAAABACwAAAAAWAIBAAACQoyBYJcbqRZ0UzaL6GUZR/49m9iBWkmGlemd6rim7tzW7C3bOR738I/yBYGvobGIpPGIyp1TmNRBm1Mp03qkXpfZAgAh+QQFAAABACwAAAAAWAIBAAACQowDCYfKug58TlYzbaJbR3w1HTiKn8mdGamGK+qlckyzs13D+K737+8KloBDYauIPCpvPiOTuMxBn05plTe1JqnJAgA7') repeat-x top border-box,\r\n                url('data:image/gif;base64,R0lGODlhWAIBAPAAAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAAABACwAAAAAWAIBAAACQ0QeoIbL51BaMjZ6VcWQT509n2h1oEl65bidbNim7kqr9nzLeszDPtoD/l7CIvFYwyl3wyTT6Awic9Jok3pdVrFQRQEAIfkECQAAAQAsAAAAAFgCAQAAAkIEgmGWur1OivBNi+hlW2bscJ8YemVFaqOpnh3Kgu0s16kd33rOw/4LXP2EQRfxaEzSdkMlrrnsFaPQ59SKpF6Z1wIAIfkECQAAAQAsAAAAAFgCAQAAAkKEg2GXC6kWdFM2i+hlGUf+PZvYgVpJhpXpneq4pu7c1uwt2zke9/CP8gWBr6GxiKTxiMqdU5jUQZtTKdN6pF6X2QIAIfkECQAAAQAsAAAAAFgCAQAAAkOEERmHyroOfE5WM22iW0d8NR04ip/JnRmphivqpXJMs7Ndw/iu9+/vCpaAQ2GriDwqbz4jk7jMQZ9OaZU3tSapSEABACH5BAkAAAEALAAAAABYAgEAAAJDDA6hhsvnUFoyNnpVxZBPnT2faHWgSXrluJ1s2KbuSqv2fMt6zMM+2gP+XsIi8VjDKXfDJNPoDCJz0miTel1WsVBFAQAh+QQJAAABACwAAAAAWAIBAAACQkyAYJa6vU6K8E2L6GVbZuxwnxh6ZUVqo6meHcqC7SzXqR3fes7D/gtc/YRBF/FoTNJ2QyWuuewVo9Dn1IqkXpnXAgAh+QQJAAABACwAAAAAWAIBAAACQoyBYJcbqRZ0UzaL6GUZR/49m9iBWkmGlemd6rim7tzW7C3bOR738I/yBYGvobGIpPGIyp1TmNRBm1Mp03qkXpfZAgAh+QQFAAABACwAAAAAWAIBAAACQowDCYfKug58TlYzbaJbR3w1HTiKn8mdGamGK+qlckyzs13D+K737+8KloBDYauIPCpvPiOTuMxBn05plTe1JqnJAgA7') repeat-x bottom border-box,\r\n                url('data:image/gif;base64,R0lGODlhAQCQAfAAAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAAABACwAAAAAAQCQAQACM0QeoIbL51BaMjZ6VcWQT509n2h1oEl65bidbNim7kqr9nzLeszDPtoD/l7CIvFYwyllBQAh+QQJAAABACwAAAAAAQCQAQACMwSCYZa6vU6K8E2L6GVbZuxwnxh6ZUVqo6meHcqC7SzXqR3fes7D/gtc/YRBF/FoTNJuBQAh+QQJAAABACwAAAAAAQCQAQACM4SDYZcLqRZ0UzaL6GUZR/49m9iBWkmGlemd6rim7tzW7C3bOR738I/yBYGvobGIpPEaBQAh+QQJAAABACwAAAAAAQCQAQACNIQRGYfKug58TlYzbaJbR3w1HTiKn8mdGamGK+qlckyzs13D+K737+8KloBDYauIPCo5gAIAIfkECQAAAQAsAAAAAAEAkAEAAjMMDqGGy+dQWjI2elXFkE+dPZ9odaBJeuW4nWzYpu5Kq/Z8y3rMwz7aA/5ewiLxWMMpZQUAIfkECQAAAQAsAAAAAAEAkAEAAjNMgGCWur1OivBNi+hlW2bscJ8YemVFaqOpnh3Kgu0s16kd33rOw/4LXP2EQRfxaEzSbgUAIfkECQAAAQAsAAAAAAEAkAEAAjOMgWCXG6kWdFM2i+hlGUf+PZvYgVpJhpXpneq4pu7c1uwt2zke9/CP8gWBr6GxiKTxGgUAIfkEBQAAAQAsAAAAAAEAkAEAAjOMAwmHyroOfE5WM22iW0d8NR04ip/JnRmphivqpXJMs7Ndw/iu9+/vCpaAQ2GriDwqUwUAOw==') repeat-y left border-box,\r\n                url('data:image/gif;base64,R0lGODlhAQCQAfAAAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAAABACwAAAAAAQCQAQACM0QeoIbL51BaMjZ6VcWQT509n2h1oEl65bidbNim7kqr9nzLeszDPtoD/l7CIvFYwyllBQAh+QQJAAABACwAAAAAAQCQAQACMwSCYZa6vU6K8E2L6GVbZuxwnxh6ZUVqo6meHcqC7SzXqR3fes7D/gtc/YRBF/FoTNJuBQAh+QQJAAABACwAAAAAAQCQAQACM4SDYZcLqRZ0UzaL6GUZR/49m9iBWkmGlemd6rim7tzW7C3bOR738I/yBYGvobGIpPEaBQAh+QQJAAABACwAAAAAAQCQAQACNIQRGYfKug58TlYzbaJbR3w1HTiKn8mdGamGK+qlckyzs13D+K737+8KloBDYauIPCo5gAIAIfkECQAAAQAsAAAAAAEAkAEAAjMMDqGGy+dQWjI2elXFkE+dPZ9odaBJeuW4nWzYpu5Kq/Z8y3rMwz7aA/5ewiLxWMMpZQUAIfkECQAAAQAsAAAAAAEAkAEAAjNMgGCWur1OivBNi+hlW2bscJ8YemVFaqOpnh3Kgu0s16kd33rOw/4LXP2EQRfxaEzSbgUAIfkECQAAAQAsAAAAAAEAkAEAAjOMgWCXG6kWdFM2i+hlGUf+PZvYgVpJhpXpneq4pu7c1uwt2zke9/CP8gWBr6GxiKTxGgUAIfkEBQAAAQAsAAAAAAEAkAEAAjOMAwmHyroOfE5WM22iW0d8NR04ip/JnRmphivqpXJMs7Ndw/iu9+/vCpaAQ2GriDwqUwUAOw==') repeat-y right border-box;\r\n    display: none;\r\n}\r\n\r\n.jcrop canvas {\r\n    position: absolute;\r\n    background: transparent;\r\n    left: 0;\r\n    top: 0;\r\n}\r\n\r\n.jcrop.jcrop_edition {\r\n    background-repeat: initial;\r\n    background-size: initial;\r\n    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAIAAAC0Ujn1AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIwLTExLTIxVDIwOjQzOjQ4WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMC0xMS0yMVQyMDo0Mzo0OFoiIHhtcDpNb2RpZnlEYXRlPSIyMDIwLTExLTIxVDIwOjQzOjQ4WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3ZmI2ZmZiNS00NmVmLWNhNDctOGUxMy1mYWY4NTA5MzJlNDIiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpjOWE3NGEyZi02MGJlLWJjNDItODc3Ny0zY2E2ZjkxMTRmOGQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjMWQzMzMxNy1jZDE4LTY5NDEtYWY5Ni0xMWNjZjE4ODE1NjgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjMWQzMzMxNy1jZDE4LTY5NDEtYWY5Ni0xMWNjZjE4ODE1NjgiIHN0RXZ0OndoZW49IjIwMjAtMTEtMjFUMjA6NDM6NDhaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjdmYjZmZmI1LTQ2ZWYtY2E0Ny04ZTEzLWZhZjg1MDkzMmU0MiIgc3RFdnQ6d2hlbj0iMjAyMC0xMS0yMVQyMDo0Mzo0OFoiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7KEhjgAAAAPklEQVRIie3QsQ0AIAwDQcIE3n/JZINkBSMakN716wpHZi57kvx4++npoKGhoR+lo7v9uqr8+M9DoKGhoW82fHEJBd4qufYAAAAASUVORK5CYII=)\r\n}\r\n\r\n.jcrop.jcrop_edition .jcrop-area {\r\n    display: block;\r\n}\r\n\r\n@media screen and (min-width:0\\0) and (min-resolution: +72dpi) {\r\n    .jcrop-area {\r\n        background: none;\r\n        border-image: url('data:image/gif;base64,R0lGODlhCgAKAJECAAAAAP///////wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEI5RDc5MTFDNkE2MTFFM0JCMDZEODI2QTI4MzJBOTIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEI5RDc5MTBDNkE2MTFFM0JCMDZEODI2QTI4MzJBOTIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuZGlkOjAyODAxMTc0MDcyMDY4MTE4MDgzQzNDMjA5MzREQ0ZDIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjAyODAxMTc0MDcyMDY4MTE4MDgzQzNDMjA5MzREQ0ZDIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEBQoAAgAsAAAAAAoACgAAAhWEERkn7W3ei7KlagMWF/dKgYeyGAUAIfkEBQoAAgAsAAAAAAoACgAAAg+UYwLJ7RnQm7QmsCyVKhUAIfkEBQoAAgAsAAAAAAoACgAAAhCUYgLJHdiinNSAVfOEKoUCACH5BAUKAAIALAAAAAAKAAoAAAIRVISAdusPo3RAzYtjaMIaUQAAIfkEBQoAAgAsAAAAAAoACgAAAg+MDiem7Q8bSLFaG5il6xQAIfkEBQoAAgAsAAAAAAoACgAAAg+UYRLJ7QnQm7SmsCyVKhUAIfkEBQoAAgAsAAAAAAoACgAAAhCUYBLJDdiinNSEVfOEKoECACH5BAUKAAIALAAAAAAKAAoAAAIRFISBdusPo3RBzYsjaMIaUQAAOw==') 1 repeat;\r\n    }\r\n}\r\n\r\n@-moz-document url-prefix() {\r\n    .jcrop-area {\r\n        background: none;\r\n        border-image: url('data:image/gif;base64,R0lGODlhCgAKAJECAAAAAP///////wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEI5RDc5MTFDNkE2MTFFM0JCMDZEODI2QTI4MzJBOTIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEI5RDc5MTBDNkE2MTFFM0JCMDZEODI2QTI4MzJBOTIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuZGlkOjAyODAxMTc0MDcyMDY4MTE4MDgzQzNDMjA5MzREQ0ZDIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjAyODAxMTc0MDcyMDY4MTE4MDgzQzNDMjA5MzREQ0ZDIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEBQoAAgAsAAAAAAoACgAAAhWEERkn7W3ei7KlagMWF/dKgYeyGAUAIfkEBQoAAgAsAAAAAAoACgAAAg+UYwLJ7RnQm7QmsCyVKhUAIfkEBQoAAgAsAAAAAAoACgAAAhCUYgLJHdiinNSAVfOEKoUCACH5BAUKAAIALAAAAAAKAAoAAAIRVISAdusPo3RAzYtjaMIaUQAAIfkEBQoAAgAsAAAAAAoACgAAAg+MDiem7Q8bSLFaG5il6xQAIfkEBQoAAgAsAAAAAAoACgAAAg+UYRLJ7QnQm7SmsCyVKhUAIfkEBQoAAgAsAAAAAAoACgAAAhCUYBLJDdiinNSEVfOEKoECACH5BAUKAAIALAAAAAAKAAoAAAIRFISBdusPo3RBzYsjaMIaUQAAOw==') 1 repeat;\r\n    }\r\n}\r\n\r\n@media only screen and (max-width: 800px) {\r\n    .jcrop.jcrop_edition .jcrop-area {\r\n        background: none;\r\n        width: 100% !important;\r\n        height: 100% !important;\r\n        top: 0 !important;\r\n        left: 0 !important;\r\n        z-index: -1 !important;\r\n    }\r\n}\r\n\r\n\r\n.jfloating {\r\n    position:fixed;\r\n    bottom:0px;\r\n    right:0px;\r\n    margin-right:5px;\r\n\r\n    -webkit-box-shadow: 0 2px 10px rgba(0,0,0,.2);\r\n    -moz-box-shadow: 0 2px 10px rgba(0,0,0,.2);\r\n    border:1px solid #ccc;\r\n    background-color:#fff;\r\n    box-sizing: border-box;\r\n    padding-top:50px !important;\r\n    z-index:9002;\r\n    border-radius: 8px;\r\n}\r\n\r\n.jfloating.jfloating-big {\r\n    width: 510px !important;\r\n    height: 472px !important;\r\n}\r\n\r\n.jfloating.jfloating-small {\r\n    width: 300px !important;\r\n    height: 320px !important;\r\n}\r\n\r\n.jfloating.jfloating-large {\r\n    width: 600px !important;\r\n    height: 600px !important;\r\n}\r\n\r\n.jfloating:before {\r\n    position:absolute;\r\n    top:0;\r\n    left:0;\r\n    width:100%;\r\n    content:attr(title);\r\n    padding:15px;\r\n    box-sizing: border-box;\r\n    font-size:1.2em;\r\n    box-shadow: 1px 1px 3px rgba(0,0,0,.2);\r\n    background-color: #fff;\r\n    border-radius: 8px 8px 0px 0px;\r\n    background-color: #404040;\r\n    font-size: .93rem;\r\n    font-weight: 600;\r\n    color: white;\r\n    letter-spacing: .5px;\r\n}\r\n\r\n.jfloating:after {\r\n    content:'';\r\n    background-image: url(\"data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='%23FFF' d='M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\");\r\n    position:absolute;\r\n    top:0;\r\n    right:0;\r\n    margin:14px;\r\n    font-size:24px;\r\n    width:24px;\r\n    height:24px;\r\n    cursor:pointer;\r\n    text-shadow: 0px 0px 5px #fff;\r\n}\r\n\r\n.jfloating_content {\r\n    padding:20px;\r\n    overflow-y:auto;\r\n    max-height:100%;\r\n    box-sizing: border-box;\r\n    height: -webkit-fill-available;\r\n}\r\n\r\n.jfloating.jfloating-minimized {\r\n    height: 50px !important;\r\n}\r\n\r\n.jfloating.jfloating-minimized .jfloating_content {\r\n    display: none;\r\n}\r\n\r\n\r\n@media (min-width: 576px)\r\n{\r\n    .container {\r\n        max-width: 540px;\r\n    }\r\n}\r\n\r\n@media (min-width: 768px)\r\n{\r\n    .container {\r\n        max-width: 732px;\r\n    }\r\n}\r\n\r\n@media (min-width: 992px)\r\n{\r\n    .container {\r\n        max-width: 956px;\r\n    }\r\n}\r\n\r\n@media (min-width: 1200px)\r\n{\r\n    .container {\r\n        max-width: 1168px;\r\n    }\r\n}\r\n\r\n@media (min-width: 1440px) {\r\n    .container {\r\n        max-width: 1404px;\r\n    }\r\n}\r\n\r\n@media only screen and (max-device-width: 800px)\r\n{\r\n    .form-group {\r\n        min-width: 50vw !important;\r\n        margin-right: 0px !important;\r\n    }\r\n    .section {\r\n        margin-right:0px !important;\r\n    }\r\n    .section-content {\r\n        padding: 12px !important;\r\n    }\r\n}\r\n\r\n/* mobile */\r\n@media (max-device-width: 600px) {\r\n    .small-screen-only {\r\n        display: block;\r\n    }\r\n    .medium-screen-only {\r\n        display: none;\r\n    }\r\n    .big-screen-only {\r\n        display: none;\r\n    }\r\n}\r\n\r\n/* tablet */\r\n@media (max-device-width:992px) and (min-device-width:601px) {\r\n    .small-screen-only {\r\n        display: none;\r\n    }\r\n    .medium-screen-only {\r\n        display: block;\r\n    }\r\n    .big-screen-only {\r\n        display: none;\r\n    }\r\n}\r\n\r\n/* desktop */\r\n@media (min-device-width: 993px) {\r\n    .small-screen-only {\r\n        display: none;\r\n    }\r\n    .medium-screen-only {\r\n        display: none;\r\n    }\r\n    .big-screen-only {\r\n        display: block;\r\n    }\r\n}\r\n\r\nbody, div, td\r\n{\r\n    font-family:'Open Sans';\r\n}\r\n\r\nbody\r\n{\r\n    margin:0px;\r\n}\r\n\r\nh1:empty\r\n{\r\n    display:none;\r\n}\r\n\r\nh2:empty\r\n{\r\n    display:none;\r\n}\r\n\r\ninput, select, textarea, button, .input {\r\n    border-radius: 1px;\r\n    border:1px solid #ccc;\r\n    padding:8px;\r\n    box-sizing: border-box;\r\n    -moz-box-sizing: border-box;\r\n    background-color:#fff;\r\n    font-size:1em;\r\n    line-height: initial;\r\n}\r\n\r\n.jdropdown .jdropdown-header {\r\n    padding-top: 8px;\r\n    padding-bottom: 8px;\r\n}\r\n    \r\n.input[data-mask] {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n}\r\n\r\n.input[data-mask] * {\r\n    display: none;\r\n}\r\n\r\nselect {\r\n    padding:7px;\r\n}\r\n\r\ninput:disabled, select:disabled, textarea:disabled, button:disabled {\r\n    background-color:#eee;\r\n    color:#888;\r\n}\r\n\r\nblockquote {\r\n    font-style: italic;\r\n    font-family: Georgia, Times, \"Times New Roman\", serif;\r\n    padding: 2px 0;\r\n    border-style: solid;\r\n    border-color: #ccc;\r\n    border-width: 0;\r\n    padding-left: 20px;\r\n    padding-right: 8px;\r\n    border-left-width: 5px;\r\n}\r\n\r\nsection.middle {\r\n    max-width:540px;\r\n}\r\n\r\n.nowrap {\r\n    flex-wrap:nowrap;\r\n}\r\n\r\n.center {\r\n    text-align:center;\r\n}\r\n\r\n.justify {\r\n    text-align:justify;\r\n}\r\n\r\n.separator {\r\n    background-color:#eee;\r\n    height:1px;\r\n}\r\n\r\n.clear {\r\n    clear:both;\r\n}\r\n\r\n.top {\r\n    padding-left:2px;\r\n    padding-right:2px;\r\n}\r\n\r\n.top > .row > .column {\r\n    margin-top:5px;\r\n    margin-bottom:5px;\r\n}\r\n\r\n.container {\r\n    width: 100%;\r\n    margin-right: auto;\r\n    margin-left: auto;\r\n}\r\n\r\n.container-box {\r\n    padding-right: 15px;\r\n    padding-left: 15px;\r\n}\r\n\r\n.row {\r\n    display:flex;\r\n    flex-wrap: wrap;\r\n    -ms-flex-direction: row;\r\n    -webkit-flex-direction: row;\r\n    flex-direction: row;\r\n    -ms-flex-pack: justify;\r\n    -webkit-justify-content: space-between;\r\n    justify-content: space-between;\r\n    box-sizing: border-box;\r\n}\r\n\r\n.row.container {\r\n    flex-wrap: nowrap;\r\n}\r\n\r\n.row.middle {\r\n    -ms-flex-align: center;\r\n    -webkit-align-items: center;\r\n    -webkit-box-align: center;\r\n    align-items: center;\r\n}\r\n\r\n.column {\r\n    box-sizing: border-box;\r\n}\r\n\r\n.column.top {\r\n    -webkit-align-self: flex-start;\r\n    -ms-flex-item-align: start;\r\n    align-self: flex-start;\r\n}\r\n\r\n.column.bottom {\r\n    -webkit-align-self: flex-end;\r\n    -ms-flex-item-align: end;\r\n    align-self: flex-end;\r\n}\r\n\r\n@media only screen and (max-width: 480px) {\r\n    .column {\r\n        min-width: 100%;\r\n    }\r\n    .cmr1 {\r\n        margin-right: 0px;\r\n    }\r\n    .cmr2 {\r\n        margin-right: 0px;\r\n    }\r\n    .cml1 {\r\n        margin-left: 0px;\r\n    }\r\n    .cml2 {\r\n        margin-left: 0px;\r\n    }\r\n}\r\n\r\n.start {\r\n    justify-content:flex-start;\r\n}\r\n\r\n.header {\r\n    width:100%;\r\n    position:absolute;\r\n    background-color:rgba(255, 255, 255, 0.2);\r\n    padding-top:12px;\r\n    padding-bottom:12px;\r\n    text-align:center;\r\n}\r\n\r\n.space {\r\n    height:4px;\r\n}\r\n\r\n.line .row {\r\n    max-width:1280px;\r\n    margin: 0 auto; \r\n}\r\n\r\n.large {\r\n    font-size:1.2em;\r\n}\r\n\r\n.extra-large {\r\n    font-size:1.4em;\r\n}\r\n\r\n.small {\r\n    font-size: 0.8em;\r\n}\r\n\r\n.extra-small {\r\n    font-size: 0.7em;\r\n}\r\n\r\n.form-group {\r\n    padding: 4px;\r\n    margin-right: 4px;\r\n}\r\n\r\n.form-group label {\r\n}\r\n\r\n.form-group input[type='text'], .form-group input[type='number'], .form-group input[type='password'], .form-group select, .form-group textarea, .form-group .jdropdown, .form-group .jprogressbar {\r\n    width:100%;\r\n}\r\n\r\n.f1\r\n{\r\n    flex:1;\r\n}\r\n\r\n.f2\r\n{\r\n    flex:2;\r\n}\r\n\r\n.f3\r\n{\r\n    flex:3;\r\n}\r\n\r\n.f4\r\n{\r\n    flex:4;\r\n}\r\n\r\n.f5\r\n{\r\n    flex:5;\r\n}\r\n\r\n.f6\r\n{\r\n    flex:6;\r\n}\r\n\r\n.f7\r\n{\r\n    flex:7;\r\n}\r\n\r\n.f8\r\n{\r\n    flex:8;\r\n}\r\n\r\n.f9\r\n{\r\n    flex:9;\r\n}\r\n\r\n.f10\r\n{\r\n    flex:10;\r\n}\r\n\r\n.w5\r\n{\r\n    width:5% !important;\r\n}\r\n\r\n.w10\r\n{\r\n    width:10% !important;\r\n}\r\n\r\n.w15\r\n{\r\n    width:15% !important;\r\n}\r\n\r\n.w20\r\n{\r\n    width:15% !important;\r\n}\r\n\r\n.w25\r\n{\r\n    width:25% !important;\r\n}\r\n\r\n.w30\r\n{\r\n    width:30% !important;\r\n}\r\n\r\n.w33\r\n{\r\n    width:33% !important;\r\n}\r\n\r\n.w40\r\n{\r\n    width:40% !important;\r\n}\r\n\r\n.w50\r\n{\r\n    width:50% !important;\r\n}\r\n\r\n.w60\r\n{\r\n    width:60% !important;\r\n}\r\n\r\n.w66\r\n{\r\n    width:66% !important;\r\n}\r\n\r\n.w70\r\n{\r\n    width:70% !important;\r\n}\r\n\r\n.w100\r\n{\r\n    width:100% !important;\r\n}\r\n\r\n.r20 .column\r\n{\r\n    width:20%;\r\n}\r\n\r\n.r25 .column\r\n{\r\n    width:25%;\r\n}\r\n\r\n.r33 .column\r\n{\r\n    width:33%;\r\n}\r\n\r\n.r66 .column\r\n{\r\n    width:66%;\r\n}\r\n\r\n.r50 .column\r\n{\r\n    width:50%;\r\n}\r\n\r\n.r100 .column\r\n{\r\n    width:100%;\r\n}\r\n\r\n.p0\r\n{\r\n    padding:0px;\r\n}\r\n\r\n.p2\r\n{\r\n    padding:2px;\r\n}\r\n\r\n.p4\r\n{\r\n    padding:4px;\r\n}\r\n\r\n.p6\r\n{\r\n    padding:6px;\r\n}\r\n\r\n.p8\r\n{\r\n    padding:8px;\r\n}\r\n\r\n.p10\r\n{\r\n    padding:10px;\r\n}\r\n\r\n.p15\r\n{\r\n    padding:15px;\r\n}\r\n\r\n.p20\r\n{\r\n    padding:20px;\r\n}\r\n\r\n.m0\r\n{\r\n    margin:0px;\r\n}\r\n\r\n.m2\r\n{\r\n    margin:2px;\r\n}\r\n\r\n.m4\r\n{\r\n    margin:4px;\r\n}\r\n\r\n.m6\r\n{\r\n    margin:6px;\r\n}\r\n\r\n.m8\r\n{\r\n    margin:8px;\r\n}\r\n\r\n.m10\r\n{\r\n    margin:10px;\r\n}\r\n\r\n.m15\r\n{\r\n    margin:15px;\r\n}\r\n\r\n.m20\r\n{\r\n    margin:20px;\r\n}\r\n\r\n.mr1 {\r\n    margin-right:10px;\r\n}\r\n\r\n.mr2 {\r\n    margin-right:20px;\r\n}\r\n\r\n.mr3 {\r\n    margin-right:30px;\r\n}\r\n\r\n.ml1 {\r\n    margin-left:10px;\r\n}\r\n\r\n.ml2 {\r\n    margin-left:20px;\r\n}\r\n\r\n.ml3 {\r\n    margin-left:30px;\r\n}\r\n\r\n.pl1 {\r\n    padding-left:10px;\r\n}\r\n\r\n.pl2 {\r\n    padding-left:20px;\r\n}\r\n\r\n.pl3 {\r\n    padding-left:30px;\r\n}\r\n\r\n.pr1 {\r\n    padding-right:10px;\r\n}\r\n\r\n.pr2 {\r\n    padding-right:20px;\r\n}\r\n\r\n.pr3 {\r\n    padding-right:30px;\r\n}\r\n\r\n.cmr1 {\r\n    margin-right: 10px;\r\n}\r\n\r\n.cmr2 {\r\n    margin-right: 20px;\r\n}\r\n\r\n.cml1 {\r\n    margin-left: 10px;\r\n}\r\n\r\n.cml2 {\r\n    margin-left: 20px;\r\n}\r\n\r\n.section {\r\n    background-color: #fff;\r\n    box-shadow: 1px 1px 2px rgba(0,0,0,.1);\r\n    margin-top:10px;\r\n    margin-right:10px;\r\n}\r\n\r\n.section-divisor {\r\n    margin-top:6px;\r\n    margin-bottom:5px;\r\n    border-bottom:1px solid #e1e1e1;\r\n    text-transform:uppercase;\r\n}\r\n\r\n.section-divisor div {\r\n    display:inline-block;\r\n}\r\n\r\n.section-divisor .section-number {\r\n    padding:8px;\r\n    width:40px;\r\n    height:40px;\r\n    text-align:center;\r\n    font-weight:bold;\r\n    font-size:23px;\r\n    display:inline;\r\n}\r\n\r\n.section-container {\r\n    padding:6px;\r\n}\r\n\r\n.section-header {\r\n    font-size:2em;\r\n    margin-bottom:20px;\r\n}\r\n\r\n.section-content {\r\n    padding:30px;\r\n}\r\n\r\n.fullpath {\r\n    display:flex;\r\n    color: #999;\r\n    padding:4px;\r\n    padding-left:8px;\r\n}\r\n\r\n.fullpath > div {\r\n    line-height:24px;\r\n}\r\n.fullpath > input {\r\n    border-color: transparent;\r\n    padding: 0px;\r\n    margin: 0px;\r\n    outline: none;\r\n}\r\n\r\n.fullpath > input.error {\r\n    border-bottom: 1px solid red;\r\n}\r\n\r\n.title {\r\n    font-size:1.8em;\r\n    font-family: Roboto,Helvetica,Arial,sans-serif;\r\n    font-size: 22px;\r\n    font-weight: 400;\r\n    line-height: 28px;\r\n}\r\n\r\n.t1 {\r\n    font-family: Roboto,Helvetica,Arial,sans-serif;\r\n    font-size: 22px;\r\n    font-weight: 400;\r\n    line-height: 28px;\r\n}\r\n\r\n.t2 {\r\n    font-family: Roboto,Helvetica,Arial,sans-serif;\r\n    font-size: 18px;\r\n    font-weight: 400;\r\n    line-height: 22px;\r\n}\r\n\r\n.uppercase {\r\n    text-transform:uppercase;\r\n}\r\n\r\n.subtitle {\r\n    position:relative;\r\n    top:-5px;\r\n    margin-bottom:10px;\r\n}\r\n\r\n.breadcrumb {\r\n    display: inline-flex;\r\n    list-style: none;\r\n    margin: 0px;\r\n    padding: 0px;\r\n}\r\n\r\n.breadcrumb > li:after {\r\n    content: '\\00BB';\r\n    padding: 8px;\r\n    font-size: 1.2em;\r\n}\r\n\r\n.breadcrumb > li:last-child:after {\r\n    opacity: 0;\r\n}\r\n\r\n.breadcrumb a:hover {\r\n    color: #000;\r\n    text-decoration: underline;\r\n}\r\n\r\n.left {\r\n    float:left;\r\n}\r\n\r\n.right {\r\n    float:right;\r\n}\r\n\r\n.material-icons {\r\n    font-size:24px;\r\n    width:24px;\r\n    height:24px;\r\n    line-height:24px;\r\n}\r\n\r\n.material-icons.selected {\r\n    color:#777;\r\n}\r\n\r\n.material-icons.small {\r\n    font-size:16px;\r\n    width:16px;\r\n    height:16px;\r\n    line-height:16px;\r\n}\r\n\r\n.material-icons.large {\r\n    font-size:36px;\r\n    width:36px;\r\n    height:36px;\r\n    line-height:36px;\r\n}\r\n\r\n.material-icons.larger {\r\n    font-size:48px;\r\n    width:48px;\r\n    height:48px;\r\n    line-height:48px;\r\n}\r\n\r\n.favorite {\r\n    font-size:24px;\r\n    width:24px;\r\n    height:24px;\r\n}\r\n\r\n.favorite.selected {\r\n    color:red;\r\n}\r\n\r\n.alert {\r\n    padding: 12px;\r\n    padding-left: 30px;\r\n    padding-right: 30px;\r\n    background-color: #f44336;\r\n    color: white;\r\n    display:none;\r\n}\r\n\r\n.alert.success {\r\n    background-color: #4CAF50;\r\n}\r\n\r\n.alert.info {\r\n    background-color: #2196F3;\r\n}\r\n\r\n.alert.warning {\r\n    background-color: #ff9800;\r\n}\r\n\r\n.error {\r\n    outline: 1px solid red;\r\n}\r\n\r\n.users {\r\n    width:40px;\r\n    height:40px;\r\n    border-radius:20px;\r\n}\r\n\r\n.users-overlap {\r\n    vertical-align:bottom;\r\n    min-height:28px;\r\n    padding-left:10px;\r\n}\r\n\r\n.users-overlap img {\r\n    width:24px;\r\n    height:24px;\r\n    line-height:24px;\r\n    border-radius:24px;\r\n    border:2px solid #fff;\r\n    vertical-align: middle;\r\n    margin-left:-10px;\r\n}\r\n\r\n.users-overlap span {\r\n    margin-left:3px;\r\n    font-size:0.8em;\r\n}\r\n\r\n.users-micro {\r\n    width:24px;\r\n    height:24px;\r\n    border-radius:12px;\r\n}\r\n\r\n.users-small {\r\n    width:30px;\r\n    height:30px;\r\n    border-radius:15px;\r\n}\r\n\r\n.users-medium {\r\n    width:45px;\r\n    height:45px;\r\n    border-radius:23px;\r\n}\r\n\r\n.users-large {\r\n    width:60px;\r\n    height:60px;\r\n    border-radius:30px;\r\n}\r\n\r\n.users-extra-large {\r\n    width:120px;\r\n    height:120px;\r\n    border-radius:60px;\r\n}\r\n\r\n.badge {\r\n    position:absolute;\r\n    background-color:red;\r\n    color:#fff;\r\n    width:16px;\r\n    height:16px;\r\n    line-height:16px;\r\n    border-radius:16px;\r\n    text-align:center;\r\n    font-size:8px;\r\n    margin:12px;\r\n}\r\n\r\n.badge:empty {\r\n    display:none;\r\n}\r\n\r\n.video-container {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 0;\r\n    padding-bottom: 56.25%;\r\n}\r\n\r\n.video-container iframe {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n\r\n.cursor {\r\n    cursor:pointer;\r\n}\r\n\r\n.cursor.link:hover {\r\n    text-decoration: underline;\r\n}\r\n\r\n.arrow-right {\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath d='M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z' fill='gray'/%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    width:24px;\r\n    height:24px;\r\n    line-height:24px;\r\n    cursor:pointer;\r\n}\r\n\r\n.arrow-left {\r\n    background-image: url(\"data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath d='M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z' fill='gray'/%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    width:24px;\r\n    height:24px;\r\n    line-height:24px;\r\n    cursor:pointer;\r\n}\r\n\r\n.mirror {\r\n    -moz-transform: scaleX(-1);\r\n    -o-transform: scaleX(-1);\r\n    -webkit-transform: scaleX(-1);\r\n    transform: scaleX(-1);\r\n    filter: FlipH;\r\n}\r\n\r\n.hover:hover {\r\n    background-color:#efefef;\r\n}\r\n\r\n.unselectable {\r\n    -webkit-touch-callout: none;\r\n    -webkit-user-select: none;\r\n    -khtml-user-select: none;\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n}\r\n\r\n.disabled {\r\n    pointer-events: none;\r\n    opacity: 0.5;\r\n}\r\n\r\n::-webkit-input-placeholder {\r\n   color: #ccc;\r\n}\r\n\r\n:-moz-placeholder {\r\n   color: #ccc;  \r\n}\r\n\r\n::-moz-placeholder {\r\n   color: #ccc;  \r\n}\r\n\r\n:-ms-input-placeholder {\r\n   color: #ccc;  \r\n}\r\n\r\n\r\n.jlogin {\r\n    width: 100%;\r\n    box-sizing: border-box;\r\n    margin:0 auto;\r\n    vertical-align:middle;\r\n    border-radius: 5px;\r\n    -webkit-border-radius: 5px;\r\n    -moz-border-radius: 5px;\r\n    font-size:1em;\r\n}\r\n\r\n.jlogin-fullscreen {\r\n    position:absolute;\r\n    top:0px;\r\n    left:0px;\r\n    width:100%;\r\n    height:100%;\r\n    background-color:#fff;\r\n    z-index:9000;\r\n}\r\n\r\n.jlogin > form {\r\n    max-width:480px;\r\n    padding:20px;\r\n    margin: 0 auto;\r\n}\r\n\r\n.jlogin > form > div {\r\n    margin-bottom:10px;\r\n}\r\n\r\n.jlogin label {\r\n    display:block;\r\n}\r\n\r\n.jlogin > form > div > input {\r\n    width:100%;\r\n    outline:none;\r\n    padding:15px;\r\n    margin:0px;\r\n}\r\n\r\n.jlogin input[type='checkbox'] {\r\n    float:left;\r\n}\r\n\r\n.jlogin input[type='button'] {\r\n    padding:10px;\r\n    background-color: var(--button-color);\r\n    border: 1px solid var(--button-color);\r\n    color: #fff;\r\n    cursor:pointer;\r\n    -webkit-appearance: none;\r\n    -moz-appearance: none;\r\n    appearance: none;\r\n}\r\n\r\n.jlogin span\r\n{\r\n    margin:0 auto;\r\n}\r\n.jlogin img\r\n{\r\n    text-align:center;\r\n    max-width:220px;\r\n}\r\n\r\n.jlogin .jlogin-logo\r\n{\r\n    text-align:center;\r\n    padding:20px;\r\n}\r\n\r\n.jlogin .jlogin-logo:empty {\r\n    display: none;\r\n}\r\n\r\n.jlogin .captcha\r\n{\r\n    width:100%;\r\n    margin-top:4px;\r\n    margin-bottom:4px;\r\n    border:1px solid #ccc;\r\n    display:block;\r\n}\r\n\r\n.jlogin .facebookButton\r\n{\r\n    padding:10px;\r\n    background-color: var(--button-color);\r\n    border: 1px solid var(--button-color);\r\n    color: #fff;\r\n    text-align:center;\r\n    background-repeat:no-repeat;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24px' height='24px'%3E%3Cpath d='M19,3H5C3.895,3,3,3.895,3,5v14c0,1.105,0.895,2,2,2h7.621v-6.961h-2.343v-2.725h2.343V9.309 c0-2.324,1.421-3.591,3.495-3.591c0.699-0.002,1.397,0.034,2.092,0.105v2.43h-1.428c-1.13,0-1.35,0.534-1.35,1.322v1.735h2.7 l-0.351,2.725h-2.365V21H19c1.105,0,2-0.895,2-2V5C21,3.895,20.105,3,19,3z' fill='white'/%3E%3C/svg%3E%0A\");\r\n    background-position:10px 40%;\r\n    cursor:pointer;\r\n}\r\n\r\n.jlogin .rememberButton\r\n{\r\n    padding:10px;\r\n    display:none;\r\n}\r\n\r\n.jlogin .requestButton, .jlogin .cancelButton, .jlogin .newProfileButton\r\n{\r\n    padding:20px;\r\n    padding-bottom:0px;\r\n    text-align:center;\r\n    cursor:pointer;\r\n}\r\n\r\n.jlogin-captcha img {\r\n    min-width:280px;\r\n}\r\n\r\n.jlogin-loading:before {\r\n    content: \"\";\r\n    display: block;\r\n    position: fixed;\r\n    top: 0px;\r\n    left: 0px;\r\n    width: 200px;\r\n    height: 4px;\r\n    background-color: var(--button-color);\r\n    animation: loading 2s linear infinite;\r\n}\r\n\r\n@keyframes loading {\r\n    from { left: 0px; width: 25%; }\r\n    25%  { width: 25%; }\r\n    50%  { width: 50%; }\r\n    75%  { left:  75%; }\r\n    100% { left:  100%; }\r\n    to { left: 100%; }\r\n}\r\n\r\n.jmenu .close {\r\n    position: absolute;\r\n    top: 20px;\r\n    right: 20px;\r\n}\r\n\r\n.jmenu nav {\r\n    font-family: Roboto;\r\n    position: relative;\r\n    margin-left: 5px;\r\n    margin-bottom: 25px;\r\n}\r\n\r\n.jmenu nav[data-icon] {\r\n    padding-left: 28px;\r\n}\r\n\r\n.jmenu nav[data-icon]:before {\r\n    position: absolute;\r\n    margin-top: -2px;\r\n    top: 0px;\r\n    left: 0px;\r\n    content: attr(data-icon);\r\n    width: 24px;\r\n    height: 24px;\r\n    font-size: 24px;\r\n    line-height: 24px;\r\n    font-family: 'Material icons';\r\n}\r\n\r\n.jmenu nav h2 {\r\n    text-transform: uppercase;\r\n    cursor: pointer;\r\n    display: flex;\r\n    align-items: center;\r\n    font-weight: bold;\r\n    font-size: 0.9em;\r\n}\r\n\r\n.jmenu nav h2::before {\r\n    margin-left: -18px;\r\n    position: absolute;\r\n    width: 18px;\r\n    height: 18px;\r\n    content: '';\r\n    background-repeat: no-repeat;\r\n    background-image: url(\"data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='black' width='18px' height='18px'%3E%3Cpath d='M10 17l5-5-5-5v10z'/%3E%3Cpath d='M0 24V0h24v24H0z' fill='none'/%3E%3C/svg%3E\");\r\n    transition: transform .25s ease-in-out;\r\n}\r\n\r\n.jmenu nav[data-icon] h2::before {\r\n    margin-left: -44px;\r\n}\r\n\r\n.jmenu nav.selected h2::before {\r\n    transform: rotate(90deg);\r\n    -ms-transform: rotate(90deg);\r\n    -webkit-transform: rotate(90deg);\r\n}\r\n\r\n.jmenu nav div {\r\n    font-family: Roboto;\r\n    padding: 2px;\r\n    padding-bottom: 10px;\r\n    display: none;\r\n}\r\n\r\n.jmenu nav.selected div {\r\n    display: block;\r\n}\r\n\r\n.jmenu nav h3 {\r\n    font-size: 1em;\r\n    font-weight: normal;\r\n    color: #999;\r\n    margin-left: 10px;\r\n}\r\n\r\n.jmenu ul {\r\n    margin: 0px;\r\n    padding-left: 20px;\r\n    padding-bottom: 20px;\r\n}\r\n\r\n.jmenu div ul:last-child {\r\n    padding-bottom: 0px;\r\n}\r\n\r\n.jmenu li {\r\n    margin-bottom: 2px;\r\n    list-style: none;\r\n}\r\n\r\n.jmenu i {\r\n    margin-left: 2px;\r\n    margin-right: 5px;\r\n}\r\n\r\n.jmenu a {\r\n    color: #555;\r\n    text-decoration: none;\r\n}\r\n\r\n.jmenu a:hover, .jmenu a.selected {\r\n    text-decoration: underline;\r\n}\r\n\r\n.jmenu .title {\r\n    border-bottom: 1px solid #ddd;\r\n    margin-bottom: 20px;\r\n    padding-bottom: 5px;\r\n}\r\n\r\n@media only screen and (max-device-width : 800px) {\r\n    .jmenu {\r\n        height:100vh;\r\n        position: fixed;\r\n        top:0px;\r\n        left:0px;\r\n        background-color:#fff;\r\n        z-index:9000;\r\n        overflow: scroll;\r\n        padding-left: 20px;\r\n        box-shadow: 1px 1px 0px 0.1px #ccc !important;\r\n        -webkit-box-shadow: 1px 0px 1px 0.1px #ccc !important;\r\n        -moz-box-shadow: 1px 1px 0px 0.1px #ccc !important;\r\n    }\r\n\r\n    .jmenu li {\r\n        margin-bottom: 10px;\r\n    }\r\n}\r\n\r\n.jorg {\n    position: relative;\n    overflow: hidden;\n}\n\n.jorg-hide-scrollbars {\n    overflow: hidden !important;\n}\n\n.jorg.fullscreen-mode {\n    position: fixed;\n    top: 0 !important;\n    left: 0 !important;\n    width: 100vw !important;\n    height: 100vh !important;\n    background: #fff;\n}\n\n.jorg-scrollParent {\n    overflow: auto;\n}\n.jorg > ul {\n    margin: 0;\n    width: 100%;\n    height: 100%;\n    padding: 0px;\n    position: relative;\n    overflow: auto;\n    display: block !important;\n}\n\n.jorg-scrollParent {\n    overflow: auto;\n}\n.jorg > ul {\n    margin: 0;\n    width: 100%;\n    height: 100%;\n    position: relative;\n    overflow: auto;\n    padding: 40px;\n    display: block !important;\n}\n\n.jorg > ul > li {\n   position: absolute;\n   left: 0;\n   min-width: 100%;\n   background: transparent;\n   min-height: 100%;\n}\n\n.jorg-search {\n    position: absolute;\n    left: 25px;\n    top: 25px;\n}\n\n.jorg-tf-tree {\n    font-size: 16px;\n}\n\n.jorg-tf-tree ul {\n    box-sizing: border-box;\n}\n\n.jorg-tf-tree ul {\n    display: inline-flex;\n}\n\n.jorg-tf-tree li {\n    align-items: center;\n    display: flex;\n    flex-direction: column;\n    flex-wrap: wrap;\n    padding: 0 1em;\n    position: relative\n}\n\n.jorg-tf-tree li ul {\n    margin: 2em 0;\n    margin-right: 40px;\n}\n\n.jorg-tf-tree li li:before {\n    border-top: 3.5px solid #CCC;\n    content: \"\";\n    display: block;\n    height: .0625em;\n    left: -.03125em;\n    position: absolute;\n    top: -1.03125em;\n    width: 100%\n}\n\n.jorg-tf-tree li li:first-child:before {\n    left: calc(50% - .03125em);\n    max-width: calc(50% + .0625em)\n}\n\n.jorg-tf-tree li li:last-child:before {\n    left: auto;\n    max-width: calc(50% + .0625em);\n    right: calc(50% - .03125em)\n}\n\n.jorg-tf-tree li li:only-child:before {\n    display: none\n}\n\n.jorg-tf-tree li li:only-child>.jorg-tf-nc:before,\n.jorg-tf-tree li li:only-child>.tf-node-content:before {\n    height: 1.0625em;\n    top: -1.0625em\n}\n\n.jorg-tf-tree .jorg-tf-nc,\n.jorg-tf-tree .tf-node-content {\n    border: 3.5px solid #CCC;\n    display: inline-block;\n    padding: .5em 1em;\n    position: relative\n}\n\n.jorg-tf-tree .jorg-tf-nc:before,\n.jorg-tf-tree .tf-node-content:before {\n    top: -1.03125em\n}\n\n.jorg-tf-tree .jorg-tf-nc:after,\n.jorg-tf-tree .jorg-tf-nc:before,\n.jorg-tf-tree .tf-node-content:after,\n.jorg-tf-tree .tf-node-content:before {\n    border-left: 3.5px solid #CCC;\n    content: \"\";\n    display: block;\n    height: 1em;\n    left: calc(50% - .03125em);\n    position: absolute;\n    width: .0625em\n}\n\n.jorg-tf-tree .jorg-tf-nc:after,\n.jorg-tf-tree .tf-node-content:after {\n    top: calc(100% + .04725em)\n}\n\n.jorg-tf-tree .jorg-tf-nc:only-child:after,\n.jorg-tf-tree .tf-node-content:only-child:after,\n.jorg-tf-tree>ul>li>.jorg-tf-nc:before,\n.jorg-tf-tree>ul>li>.tf-node-content:before {\n    display: none\n}\n\n.jorg-tf-tree.tf-gap-sm li {\n    padding: 0 .6em\n}\n\n.jorg-tf-tree.tf-gap-sm li>.jorg-tf-nc:before,\n.jorg-tf-tree.tf-gap-sm li>.tf-node-content:before {\n    height: .6em;\n    top: -.6em\n}\n\n.jorg-tf-tree.tf-gap-sm li>.jorg-tf-nc:after,\n.jorg-tf-tree.tf-gap-sm li>.tf-node-content:after {\n    height: .6em\n}\n\n.jorg-tf-tree.tf-gap-sm li ul {\n    margin: 1.2em 0\n}\n\n.jorg-tf-tree.tf-gap-sm li li:before {\n    top: -.63125em\n}\n\n.jorg-tf-tree.tf-gap-sm li li:only-child>.jorg-tf-nc:before,\n.jorg-tf-tree.tf-gap-sm li li:only-child>.tf-node-content:before {\n    height: .6625em;\n    top: -.6625em\n}\n\n.jorg-tf-tree.tf-gap-lg li {\n    padding: 0 1.5em\n}\n\n.jorg-tf-tree.tf-gap-lg li>.jorg-tf-nc:before,\n.jorg-tf-tree.tf-gap-lg li>.tf-node-content:before {\n    height: 1.5em;\n    top: -1.5em\n}\n\n.jorg-tf-tree.tf-gap-lg li>.jorg-tf-nc:after,\n.jorg-tf-tree.tf-gap-lg li>.tf-node-content:after {\n    height: 1.5em\n}\n\n.jorg-tf-tree.tf-gap-lg li ul {\n    margin: 3em 0\n}\n\n.jorg-tf-tree.tf-gap-lg li li:before {\n    top: -1.53125em\n}\n\n.jorg-tf-tree.tf-gap-lg li li:only-child>.jorg-tf-nc:before,\n.jorg-tf-tree.tf-gap-lg li li:only-child>.tf-node-content:before {\n    height: 1.5625em;\n    top: -1.5625em\n}\n\n.jorg-tf-tree li.jorg-tf-dotted-children .jorg-tf-nc:after,\n.jorg-tf-tree li.jorg-tf-dotted-children .jorg-tf-nc:before,\n.jorg-tf-tree li.jorg-tf-dotted-children .tf-node-content:after,\n.jorg-tf-tree li.jorg-tf-dotted-children .tf-node-content:before {\n    border-left-style: dotted\n}\n\n.jorg-tf-tree li.jorg-tf-dotted-children li:before {\n    border-top-style: dotted\n}\n\n.jorg-tf-tree li.jorg-tf-dotted-children>.jorg-tf-nc:before,\n.jorg-tf-tree li.jorg-tf-dotted-children>.tf-node-content:before {\n    border-left-style: solid\n}\n\n.jorg-tf-tree li.jorg-tf-dashed-children .jorg-tf-nc:after,\n.jorg-tf-tree li.jorg-tf-dashed-children .jorg-tf-nc:before,\n.jorg-tf-tree li.jorg-tf-dashed-children .tf-node-content:after,\n.jorg-tf-tree li.jorg-tf-dashed-children .tf-node-content:before {\n    border-left-style: dashed\n}\n\n.jorg-tf-tree li.jorg-tf-dashed-children li:before {\n    border-top-style: dashed\n}\n\n.jorg-tf-tree li.jorg-tf-dashed-children>.jorg-tf-nc:before,\n.jorg-tf-tree li.jorg-tf-dashed-children>.tf-node-content:before {\n    border-left-style: solid\n}\n\n/* ORGANOGRAM STYLES */\n\n.jorg-unselectable {\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -khtml-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n}\n\n.jorg-tf-tree ul.jorg-vertical {\n\tmargin: 2em 0px !important;\n\tdisplay: flex;\n\tflex-direction: column;\n\tpadding: 0px;\n\tpadding-left: 4em !important;\n    position: relative;\n}\n\n.jorg-tf-tree ul.jorg-vertical li:before {\n    content: none;\n}\n\n.jorg-tf-tree ul.jorg-vertical li {\n\tmargin-bottom: 40px;\n}\n\n.jorg-tf-tree ul.jorg-vertical span.jorg-tf-nc:before {\n    content: none;\n}\n\n.jorg-tf-tree span.jorg-after-none:after {\n    content: none;\n}\n\n.jorg-tf-tree ul.jorg-vertical:before {\n    content: '';\n    position: absolute;\n    width: 3px;\n    height: calc(100% - 2.75em);\n    top: -2em;\n    left: 3em;\n    background:#CCC;\n}\n\n.jorg-tf-tree ul.jorg-vertical li span.jorg-tf-nc:before {\n    content: '';\n    position: absolute;\n    width: 26px;\n    left: -30px;\n    top: calc(50% + 2px);\n    height: 3px;\n    background: #CCC;\n}\n\n.jorg-disable-scrollbars::-webkit-scrollbar {\n    width: 0px;\n    background: transparent; /* Chrome/Safari/Webkit */\n}\n\n.jorg-disable-scrollbars {\n  scrollbar-width: none; /* Firefox */\n  -ms-overflow-style: none;  /* IE 10+ */\n}\n\n.jorg-tf-nc {\n    width: 180px;\n    background: var(--white);\n    height: 80px;\n    word-break: break-word;\n    color: rgba(0,0,0,.7);\n    border: 1px solid rgb(228, 228, 228) !important;\n    display: flex !important;\n    flex-direction: column;\n    padding: 0 !important;\n}\n\n.jorg-user-status {\n    width: 100%;\n    height: 4px;\n    background: lightgreen;\n}\n\n.jorg-user-info {\n    width: 100%;\n    height: calc(100% - 4px);\n    display: flex;\n    flex-direction: row;\n}\n\n.jorg-user-content {\n    font-family: Roboto,Arial,Tahoma,Verdana,sans-serif;\n    text-align: left;\n    width: 108px;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: flex-start;\n    flex-direction: column;\n    overflow: hidden;\n}\n\n.jorg-user-content span:nth-child(1) {\n    color: rgba(0,0,0,.38);\n    font-weight: 500;\n    line-height: 18px;\n    text-transform: uppercase;\n}\n.jorg-user-content, .jorg-user-img {\n    font-size: 14px;\n}\n\n.jorg-user-img {\n    width: 72px;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n.jorg-user-img img {\n    width: 50px;\n    height: 50px;\n    background: var(--white);\n    border-radius: 50%;\n}\n\n.jorg-node-icon {\n    width: 18px;\n    height: 18px;\n    border-radius: 50%;\n    position: absolute;\n    bottom: -9px;\n    left: 0;\n    right: 0;\n    opacity: 0;\n    margin-left: auto;\n    margin-right: auto;\n    z-index: 1000;\n    transition: .2s opacity ease-in;\n    cursor: pointer;\n    font-weight: bold;\n    font-size: 1rem;\n}\n\n.jorg-node-icon.remove {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23607D8B' width='18px' height='18px'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11H7v-2h10v2z'/%3E%3C/svg%3E\");\n    background-size: 100% 100%;\n}\n\n.jorg-node-icon.plus {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' fill='%23607D8B' width='24'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z'/%3E%3C/svg%3E\");\n    background-size: 100% 100%;\n}\n\n.jorg-tf-nc:hover .jorg-node-icon {\n    opacity: 1;\n}\n\n.jorg-search-animation {\n    animation: jorg-searching-hide .3s forwards;\n}\n\n.jorg-search-animation.visible {\n    animation: jorg-searching-visible .3s forwards;\n}\n\n@keyframes jorg-searching-hide {\n    0% {\n        opacity: 1;\n    }\n    100% {\n        opacity: 0;\n    }\n}\n\n@keyframes jorg-searching-visible {\n    0% {\n        opacity: 0;\n    }\n    100% {\n        opacity: 1;\n    }\n}\n\n.jorg-tf-nc[visibility='hidden']::after {\n    display: none;\n}\n\n.jorg-zoom-container {\n    position: absolute;\n    right: 25px;\n    top: 25px;\n    background: transparent;\n    margin-left: 25px;\n    display: flex;\n    justify-content: space-between;\n}\n\n.jorg-action {\n    font-size: 30px;\n    line-height: 30px;\n    width: 30px;\n    height: 30px;\n    cursor: pointer;\n}\n\n\n@media only screen and (max-width : 800px) {\n    .jorg {\n        width: 100vw !important;\n    }\n\n    .jorg > ul {\n        width: 95% !important;\n    }\n}\r\n\r\n.jtemplate-pagination {\r\n    display:flex;\r\n    cursor:pointer;\r\n    margin-top:10px;\r\n    margin-bottom:10px;\r\n}\r\n\r\n.jtemplate-pagination {\r\n    display: flex;\r\n    margin-bottom: 15px;\r\n}\r\n\r\n.jtemplate-pagination div {\r\n    text-align:center;\r\n    font-size:0.8em;\r\n    width:30px;\r\n    height:30px;\r\n    line-height:30px;\r\n    -webkit-touch-callout: none; /* iOS Safari */\r\n    -webkit-user-select: none; /* Safari */\r\n    khtml-user-select: none; /* Konqueror HTML */\r\n    -moz-user-select: none; /* Firefox */\r\n    -ms-user-select: none; /* Internet Explorer/Edge */\r\n    user-select: none;\r\n}\r\n\r\n.jtemplate-pagination div:hover {\r\n    background-color:#eee;\r\n}\r\n\r\n.jtemplate-pagination:empty {\r\n    display:none;\r\n}\r\n\r\n.jtemplate-empty:empty {\r\n    display:none;\r\n}\r\n\r\n.jtemplate-results {\r\n    margin-top:15px;\r\n    margin-bottom:15px;\r\n}\r\n\r\n\r\n.jtimeline {\r\n    overflow: hidden;\r\n    min-height:calc(100vh - 90px);\r\n    min-width: 300px;\r\n}\r\n\r\n.jtimeline-item {\r\n    display:flex;\r\n    margin-left:15px;\r\n    margin-right:15px;\r\n}\r\n\r\n.jtimeline-header {\r\n    position:fixed;\r\n    width:100%;\r\n    display:flex;\r\n    align-items: center;\r\n    justify-content:space-between;\r\n    padding:15px;\r\n    border-top:1px solid #eee;\r\n    border-bottom:1px solid #eee;\r\n    margin-top:-1px;\r\n    margin-bottom:10px;\r\n    background-color:#fff;\r\n    z-index:1;\r\n    box-sizing: border-box;\r\n}\r\n\r\n.jtimeline-year {\r\n    font-size:2.2em;\r\n    display:inline-block;\r\n}\r\n\r\n.jtimeline-month {\r\n    font-size:0.8em;\r\n    position:relative;\r\n    top:6px;\r\n}\r\n\r\n.jtimeline-navigation div {\r\n    display:inline-block;\r\n    padding-right:12px;\r\n    padding-left:12px;\r\n    margin-left:4px;\r\n    text-align: center;\r\n    cursor: pointer;\r\n}\r\n\r\n.jtimeline-navigation i {\r\n    font-size: 1.5rem !important;\r\n    line-height:32px;\r\n    display:inline-block;\r\n}\r\n\r\n.jtimeline-container {\r\n    position: relative;\r\n    padding-top:110px;\r\n    padding-bottom:30px;\r\n}\r\n\r\n.jtimeline-subtitle {\r\n    color:#aaa;\r\n    font-size:0.8em;\r\n}\r\n\r\n.jtimeline-content {\r\n    padding-top:0px;\r\n    padding-left:20px;\r\n    padding-bottom:30px;\r\n    font-size:0.8em;\r\n    border-left:3px solid #aaa;\r\n    width:100%;\r\n}\r\n\r\n.jtimeline-item:last-child .jtimeline-content {\r\n    padding-bottom:0px;\r\n}\r\n\r\n.jtimeline-text {\r\n    color:#888;\r\n    font-size:0.9em;\r\n    line-height:18px;\r\n    margin-top:5px;\r\n    margin-bottom:5px;\r\n}\r\n\r\n.jtimeline-item:last-child .jtimeline-text {\r\n}\r\n\r\n.jtimeline-date-container {\r\n    position:relative;\r\n    padding-top:0px;\r\n}\r\n\r\n.jtimeline-date {\r\n    font-size:1em;\r\n    width:40px;\r\n    padding-top:2px;\r\n}\r\n\r\n.jtimeline-title-container {\r\n    display:flex;\r\n}\r\n\r\n.jtimeline-title {\r\n    font-size:1.4em;\r\n    max-width:calc(100% - 30px);\r\n}\r\n\r\n.jtimeline-controls {\r\n    margin-left:5px;\r\n}\r\n\r\n.jtimeline-controls i {\r\n    font-size:16px;\r\n    width:16px;\r\n    height:16px;\r\n    line-height:24px;\r\n    color:#aaa;\r\n}\r\n\r\n.jtimeline-date small {\r\n    font-size:0.7em;\r\n}\r\n\r\n.jtimeline-date-bullet::after {\r\n    content:'';\r\n    width:12px;\r\n    height:12px;\r\n    border-radius:12px;\r\n    border:3px solid #00688B;\r\n    display: inline-block;\r\n    position:absolute;\r\n    top:4px;\r\n    right:-10px;\r\n    background-color:#fff;\r\n}\r\n\r\n.jtimeline-tags {\r\n    margin-top:15px;\r\n    margin-bottom:0px;\r\n    border-bottom:1px solid #fefefe;\r\n}\r\n\r\n.jtimeline-tags:empty {\r\n    display:none;\r\n}\r\n\r\n.jtimeline-tag {\r\n    padding:1px;\r\n    padding-right:10px;\r\n    padding-left:10px;\r\n    background-color:red;\r\n    color:#fff;\r\n    display:inline-block;\r\n    font-size:0.8em;\r\n    margin-bottom:5px;\r\n    margin-right:5px;\r\n}\r\n\r\n.jtimeline-message {\r\n    text-align:center;\r\n    padding:20px;\r\n    font-size:0.7em;\r\n}\r\n\r\n.jtimeline-action {\r\n    cursor: pointer;\r\n}\r\n\r\n@media only screen and (min-width: 992px) {\r\n    .jtimeline-header {\r\n        position: relative !important;\r\n    }\r\n    \r\n    .jtimeline-container {\r\n        padding: 0px !important;\r\n    }\r\n}\r\n\r\n\r\n", "jSuites.crop = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.crop) {\r\n        return el.crop.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    el.classList.add('jcrop');\r\n    // Upload icon\r\n    el.classList.add('jupload');\r\n\r\n    // Area do crop\r\n    var crop = document.createElement('div');\r\n    crop.classList.add('jcrop-area');\r\n    el.appendChild(crop);\r\n\r\n    // Canvas editor\r\n    var canvas = document.createElement('canvas');\r\n    var context = canvas.getContext('2d');\r\n    el.appendChild(canvas);\r\n\r\n    // Image\r\n    var drawImage = function() {\r\n        if (el.clientHeight > obj.image.height) {\r\n            var pointY = (el.clientHeight - obj.image.height) / 2;\r\n        } else {\r\n            var pointY = 0;\r\n        }\r\n\r\n        if (el.clientWidth > obj.image.width) {\r\n            var pointX = (el.clientWidth - obj.image.width) / 2;\r\n        } else {\r\n            var pointX = 0;\r\n        }\r\n\r\n        obj.image.left = pointX;\r\n        obj.image.top = pointY;\r\n\r\n        context.translate(pointX, pointY);\r\n        context.drawImage(obj.image, 0, 0, obj.image.width, obj.image.height);\r\n    }\r\n\r\n    obj.image = new Image();\r\n    obj.image.onload = function onload() {\r\n        obj.resetCanvas();\r\n\r\n        var w = obj.options.area[0] / this.naturalWidth;\r\n        var h = obj.options.area[1] / this.naturalHeight;\r\n\r\n        // Proportion\r\n        var p = Math.min(h, w);\r\n\r\n        // Image size\r\n        this.width = this.naturalWidth * p;\r\n        this.height = this.naturalHeight * p;\r\n\r\n        drawImage();\r\n\r\n        // Edition model\r\n        el.classList.add('jcrop_edition');\r\n\r\n        // Reset selection on desktop only\r\n        if (jSuites.getWindowWidth() > 800) {\r\n            obj.resetCropSelection();\r\n        }\r\n\r\n        // Onchange\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, obj.image);\r\n        }\r\n    };\r\n\r\n    // Properties\r\n    var properties = {\r\n        zoom: {\r\n            origin: { x: null, y: null, },\r\n            scale: 1,\r\n            fingerDistance: 0\r\n        },\r\n        contrast: 0,\r\n        brightness: 0,\r\n        rotate: 0,\r\n        saturation: 0,\r\n    };\r\n\r\n    var secondCanvas = document.createElement('canvas');\r\n    var secondContext = secondCanvas.getContext('2d');\r\n    var secondImage = document.createElement('img');\r\n\r\n    // Reload filters\r\n    var refreshFilters = function() {\r\n        secondCanvas.width = obj.image.width;\r\n        secondCanvas.height = obj.image.height;\r\n\r\n        secondContext.clearRect(0, 0, secondContext.width, secondContext.height);\r\n\r\n        secondImage.width = secondCanvas.width;\r\n        secondImage.height = secondCanvas.height;\r\n\r\n        if (obj.image) {\r\n            //drawImage();\r\n            secondContext.drawImage(obj.image, 0, 0, obj.image.width, obj.image.height);\r\n        }\r\n\r\n        // Performs the contrast, if its value is different from the initial\r\n        if (properties.contrast) {\r\n            runContrast();\r\n        }\r\n\r\n        // Performs the brightness, if its value is different from the initial\r\n        if (properties.brightness) {\r\n            runBrightness();\r\n        }\r\n\r\n        if (properties.greyScale) {\r\n            runGreyScale();\r\n        }\r\n\r\n        if (properties.saturation) {\r\n            runSaturation();\r\n        }\r\n\r\n        secondImage.src = secondCanvas.toDataURL(obj.getImageType);\r\n        secondImage.onload = function() {\r\n            context.drawImage(secondImage, 0, 0, secondImage.width, secondImage.height);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set options\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            area: [ 800, 600 ],\r\n            crop: [ 200, 150 ],\r\n            value: null,\r\n            onload: null,\r\n            onchange: null,\r\n            remoteParser: null,\r\n            allowResize: true,\r\n            text: {\r\n                extensionNotAllowed: 'The extension is not allowed',\r\n            },\r\n            eventListeners: {}\r\n        };\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Default for mobile\r\n        if (jSuites.getWindowWidth() < 800) {\r\n            if (! obj.options.area[0]) {\r\n                obj.options.area[0] = window.clientWidth * 2;\r\n            }\r\n            if (! obj.options.area[1]) {\r\n                obj.options.area[1] = window.clientHeight * 2;\r\n            }\r\n        }\r\n\r\n        // Set options\r\n        el.style.width = obj.options.area[0] + 'px';\r\n        el.style.height = obj.options.area[1] + 'px';\r\n\r\n        canvas.width = obj.options.area[0];\r\n        canvas.height = obj.options.area[1];\r\n\r\n        // Reset all\r\n        obj.reset();\r\n\r\n        // Initial image\r\n        if (typeof obj.options.value === 'string') {\r\n            obj.image.src = obj.options.value;\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Reset crop to the initial conditions\r\n     */\r\n    obj.resetCropSelection = function() {\r\n        crop.style.left = (obj.options.area[0]/2 - obj.options.crop[0]/2) + 'px';\r\n        crop.style.top = (obj.options.area[1]/2 - obj.options.crop[1]/2) + 'px';\r\n        crop.style.width = obj.options.crop[0] + 'px';\r\n        crop.style.height = obj.options.crop[1] + 'px';\r\n        crop.style.zIndex = 1;\r\n    }\r\n\r\n    obj.getCropSelection = function() {\r\n        obj.getSelectionCoordinates();\r\n    }\r\n\r\n    // Reset canvas\r\n    obj.resetCanvas = function() {\r\n        context.setTransform(1, 0, 0, 1, 0, 0);\r\n        context.clearRect(0,0,canvas.width,canvas.height);\r\n    }\r\n\r\n    // Reset all the properties\r\n    obj.reset = function() {\r\n        // Reset crop selection\r\n        obj.resetCropSelection()\r\n        // Reset canvas\r\n        obj.resetCanvas();\r\n        // Reset state\r\n        properties = {\r\n            zoom: {\r\n                origin: { x: null, y: null },\r\n                scale: 1,\r\n            },\r\n            contrast: 0,\r\n            brightness: 0,\r\n            rotate: 0,\r\n            greyScale: 0,\r\n            saturation: 0,\r\n        }\r\n        // Reset file input\r\n        attachmentInput.value = '';\r\n        // Stop edition\r\n        el.classList.remove('jcrop_edition')\r\n    }\r\n\r\n    var callListeningFunction = function(type) {\r\n        if (typeof obj.options.eventListeners[type] === 'function') {\r\n            var types = {\r\n                zoom: properties.zoom.scale,\r\n                rotate: properties.rotate,\r\n                brightness: properties.brightness,\r\n                contrast: properties.contrast,\r\n            };\r\n\r\n            obj.options.eventListeners[type](types[type]);\r\n        }\r\n    }\r\n\r\n    // Apply the contrast on the image data\r\n    var runContrast = function() {\r\n        var contrast = properties.contrast;\r\n        var imageData = secondContext.getImageData(0, 0, secondCanvas.width, secondCanvas.height);\r\n        var data = imageData.data;  // Note: original dataset modified directly!\r\n        contrast *= 255;\r\n        var factor = (contrast + 255) / (255.01 - contrast);  //add .1 to avoid /0 error.\r\n\r\n        for (var i = 0; i < data.length; i+=4) {\r\n            data[i] = factor * (data[i] - 128) + 128;\r\n            data[i+1] = factor * (data[i+1] - 128) + 128;\r\n            data[i+2] = factor * (data[i+2] - 128) + 128;\r\n        }\r\n\r\n        secondContext.putImageData(imageData, 0, 0);\r\n\r\n        return imageData;  //optional (e.g. for filter function chaining)\r\n    }\r\n\r\n    // Change the contrast and apply that to the image\r\n    obj.contrast = function(val) { // contrast input as percent; range [-1..1]\r\n        if (! Number.isNaN(parseFloat(val))) {\r\n            properties.contrast = val;\r\n        }\r\n\r\n        callListeningFunction('contrast');\r\n\r\n        refreshFilters();\r\n    }\r\n\r\n    // Apply the brightness on the image data\r\n    var runBrightness = function () {  // brightness input as percent; range [-1..1]\r\n        var brightness = properties.brightness;\r\n        var imageData = secondContext.getImageData(0, 0, secondCanvas.width, secondCanvas.height);\r\n\r\n        var data = imageData.data;  // Note: original dataset modified directly!\r\n        brightness *= 255;\r\n\r\n        for (var i = 0; i < data.length; i+=4) {\r\n            data[i] += brightness;\r\n            data[i+1] += brightness;\r\n            data[i+2] += brightness;\r\n        }\r\n\r\n        secondContext.putImageData(imageData, 0, 0);\r\n\r\n        return imageData;  //optional (e.g. for filter function chaining)\r\n    }\r\n\r\n    // Change the brightness and apply that to the image\r\n    obj.brightness = function(val) {\r\n        if (! Number.isNaN(parseFloat(val))) {\r\n            properties.brightness = val;\r\n        }\r\n\r\n        callListeningFunction('brightness');\r\n\r\n        refreshFilters();\r\n    }\r\n\r\n    /**\r\n     * Returns the current image type\r\n     */\r\n    obj.getImageType = function() {\r\n        var dataType = obj.image.src.substr(0,20);\r\n        if (dataType.includes('data')){\r\n            return dataType.split('/')[1].split(';')[0];\r\n        }\r\n        return null;\r\n    }\r\n     /**\r\n     * Returns cropped area coordinates\r\n     */\r\n    obj.getSelectionCoordinates = function() {\r\n        return {\r\n            left: crop.offsetLeft,\r\n            top: crop.offsetTop,\r\n            right: crop.offsetLeft + crop.clientWidth,\r\n            bottom: crop.offsetTop + crop.clientHeight\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns cropped image on canvas\r\n     */\r\n    obj.getCroppedImage = function() {\r\n        return jSuites.image.create({\r\n            extension: obj.getImageType(),\r\n            file: obj.getCroppedContent(),\r\n            name: '',\r\n            size: '',\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get cropped base64 content\r\n     */\r\n    obj.getCroppedContent = function() {\r\n        var coordinates = obj.getSelectionCoordinates();\r\n        var canvasCropped = document.createElement('canvas');\r\n        var contextCropped = canvasCropped.getContext('2d');\r\n        canvasCropped.width = crop.clientWidth;\r\n        canvasCropped.height = crop.clientHeight;\r\n\r\n        // Get cropped selection\r\n        var imageData = context.getImageData(coordinates.left, coordinates.top, crop.clientWidth, crop.clientHeight);\r\n        contextCropped.putImageData(imageData,0,0);\r\n        return canvasCropped.toDataURL(obj.getImageType());\r\n    }\r\n\r\n    /**\r\n     * Get cropped as blob\r\n     */\r\n    obj.getCroppedAsBlob = function(callback) {\r\n        if (! typeof(callback) == 'function') {\r\n            console.error('Callback not defined')\r\n            return false;\r\n        }\r\n\r\n        var coordinates = obj.getSelectionCoordinates();\r\n        var canvasCropped = document.createElement('canvas');\r\n        var contextCropped = canvasCropped.getContext('2d');\r\n        canvasCropped.width = crop.clientWidth;\r\n        canvasCropped.height = crop.clientHeight;\r\n\r\n        // Get cropped selection\r\n        var imageData = context.getImageData(coordinates.left, coordinates.top, crop.clientWidth, crop.clientHeight);\r\n        contextCropped.putImageData(imageData,0,0);\r\n\r\n        // Callback\r\n        canvasCropped.toBlob(callback);\r\n    }\r\n\r\n    /**\r\n     * Returns the current image on canvas\r\n     */\r\n    obj.getImage = function() {\r\n        return obj.image;\r\n    }\r\n\r\n    /**\r\n     *  Returns the attachment input\r\n     */\r\n    obj.getFileInput = function() { \r\n        return attachmentInput;\r\n    }\r\n\r\n    /**\r\n     * Returns the current canvas\r\n     */\r\n    obj.getCanvas = function() {\r\n        return canvas;\r\n    }\r\n\r\n    /**\r\n     * Load a image from the computer\r\n     */\r\n    obj.addFromFile = function(file) {\r\n        var type = file.type.split('/');\r\n        if (type[0] == 'image') {\r\n            var imageFile = new FileReader();\r\n            imageFile.addEventListener(\"load\", function (v) {\r\n                obj.image.src = v.target.result;\r\n            });\r\n            imageFile.readAsDataURL(file);\r\n        } else {\r\n            alert(obj.options.text.extensionNotAllowed);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load a image from a remote URL\r\n     */\r\n    obj.addFromUrl = function(src) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            src = obj.options.remoteParser + src;\r\n            obj.image.src = src;\r\n        }\r\n    }\r\n\r\n    // X-axis spacing of the zoom at the last scroll change\r\n    var zoomOffsetX;\r\n\r\n    // Y-axis spacing of the zoom at the last scroll change\r\n    var zoomOffsetY;\r\n\r\n    // Mouse position on the x-axis in the last use of the scroll\r\n    var lastX;\r\n\r\n    // Mouse position on the y-axis in the last use of the scroll\r\n    var lastY;\r\n\r\n    // Last zoom applied\r\n    var lastScale;\r\n\r\n    // Runs image movements\r\n    var runMove = function() {\r\n        // If the mouse was moved after the last scroll, it moves the image in relation to the x-axis\r\n        if (lastX && lastX !== properties.zoom.origin.x) {\r\n            var temp = Math.abs(properties.zoom.origin.x - zoomOffsetX - obj.image.left);\r\n            temp /= lastScale;\r\n            temp -= properties.zoom.origin.x - obj.image.left;\r\n\r\n            obj.image.left -= temp;\r\n        }\r\n\r\n        // If the mouse was moved after the last scroll, it moves the image in relation to the y-axis\r\n        if (lastY && lastY !== properties.zoom.origin.y) {\r\n            var temp = Math.abs(properties.zoom.origin.y - zoomOffsetY - obj.image.top);\r\n            temp /= lastScale;\r\n            temp -= properties.zoom.origin.y - obj.image.top;\r\n\r\n            obj.image.top -= temp;\r\n        }\r\n\r\n        // Update variables\r\n        zoomOffsetX = (properties.zoom.origin.x - obj.image.left) - (properties.zoom.origin.x - obj.image.left) * properties.zoom.scale;\r\n        zoomOffsetY = (properties.zoom.origin.y - obj.image.top) - (properties.zoom.origin.y - obj.image.top) * properties.zoom.scale;\r\n        lastX = properties.zoom.origin.x;\r\n        lastY = properties.zoom.origin.y;\r\n        lastScale = properties.zoom.scale;\r\n\r\n        // Move image\r\n        context.translate(obj.image.left + zoomOffsetX, obj.image.top + zoomOffsetY);\r\n    }\r\n\r\n    // Reload resizers and filters\r\n    var refreshResizers = function() {\r\n        // Clear canvas\r\n        context.setTransform(1, 0, 0, 1, 0, 0);\r\n        context.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n        runMove();\r\n\r\n        // Performs the zoom, if its value is different from the initial\r\n        if (properties.zoom.scale !== 1) {\r\n            runZoom();\r\n        }\r\n\r\n        // Performs the rotation, if its value is different from the initial\r\n        if (properties.rotate) {\r\n            runRotate();\r\n        }\r\n\r\n        // Calls the filter reloader\r\n        if (properties.brightness || properties.contrast) {\r\n            context.drawImage(secondImage, 0, 0, secondImage.width, secondImage.height);\r\n        } else {\r\n            context.drawImage(obj.image, 0, 0, obj.image.width, obj.image.height);\r\n        }\r\n    }\r\n\r\n    // Apply the zoom on the image\r\n    var runZoom = function() {\r\n        context.scale(properties.zoom.scale, properties.zoom.scale);\r\n    }\r\n\r\n    /**\r\n     * Change the zoom and apply that to the image\r\n     * @param mixed value / null to refresh or int for a new percentage of zoom\r\n     */\r\n    obj.zoom = function(value) {\r\n        if (value) {\r\n            properties.zoom.scale = value;\r\n        }\r\n\r\n        callListeningFunction('zoom');\r\n\r\n        refreshResizers();\r\n    }\r\n\r\n    // Apply the rotations on the image\r\n    var runRotate = function() {\r\n        var value = properties.rotate;\r\n        value *= 180;\r\n\r\n        context.translate(obj.image.width / 2, obj.image.height / 2);\r\n        context.rotate(value * Math.PI / 180);\r\n        context.translate(- obj.image.width / 2, - obj.image.height / 2);\r\n    }\r\n\r\n    // Change the rotation and apply that to the image\r\n    obj.rotate = function(val) {  // rotate input as percent; range [-1..1]\r\n        if (! Number.isNaN(parseFloat(val))) {\r\n            properties.rotate = val;\r\n        }\r\n\r\n        callListeningFunction('rotate');\r\n\r\n        refreshResizers();\r\n    }\r\n\r\n    // HTML element to load a image from the computer\r\n    var attachmentInput = document.createElement('input');\r\n    attachmentInput.type = 'file';\r\n    attachmentInput.setAttribute('accept', 'image/*');\r\n    attachmentInput.onchange = function() {\r\n        for (var i = 0; i < this.files.length; i++) {\r\n            obj.addFromFile(this.files[i]);\r\n        }\r\n    }\r\n\r\n    /** Events start here **/\r\n    var editorAction = null;\r\n    var scaling = null;\r\n\r\n    var editorMouseUp = function(e) {\r\n        editorAction = false;\r\n    }\r\n\r\n    var editorMouseDown = function(e) {\r\n        if (e.target.classList.contains('jcrop-area')) {\r\n            var rect = e.target.getBoundingClientRect();\r\n\r\n            var offsetX = (e.target.style.left !== '') ? e.target.style.left : '0px';\r\n            var offsetY = (e.target.style.top !== '') ? e.target.style.top : '0px';\r\n\r\n            if (e.target.style.cursor) {\r\n                editorAction = {\r\n                    e: e.target,\r\n                    x: e.clientX,\r\n                    y: e.clientY,\r\n                    w: rect.width,\r\n                    h: rect.height,\r\n                    d: e.target.style.cursor,\r\n                    xOffset: e.clientX - parseInt(offsetX.slice(0, offsetX.length - 2)),\r\n                    yOffset: e.clientY - parseInt(offsetY.slice(0, offsetY.length - 2)),\r\n                }\r\n\r\n                if (! e.target.style.width) {\r\n                    e.target.style.width = rect.width + 'px';\r\n                }\r\n\r\n                if (! e.target.style.height) {\r\n                    e.target.style.height = rect.height + 'px';\r\n                }\r\n\r\n                var s = window.getSelection();\r\n                if (s.rangeCount) {\r\n                    for (var i = 0; i < s.rangeCount; i++) {\r\n                        s.removeRange(s.getRangeAt(i));\r\n                    }\r\n                }\r\n            }\r\n        } else { \r\n            editorAction = true;\r\n        }\r\n    }\r\n\r\n    var editorMouseMove = function(e) {\r\n        e = e || window.event;\r\n        if (typeof(e.buttons) !== undefined) {\r\n            var mouseButton = e.buttons;\r\n        } else if (typeof(e.button) !== undefined) {\r\n            var mouseButton = e.button;\r\n        } else {\r\n            var mouseButton = e.which;\r\n        }\r\n\r\n        if (! e.buttons) {\r\n            if (e.target.classList.contains('jcrop-area')) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                if (obj.options.allowResize == true) {\r\n                    if (e.clientY - rect.top < 5) {\r\n                        if (rect.width - (e.clientX - rect.left) < 5) {\r\n                            e.target.style.cursor = 'ne-resize';\r\n                        } else if (e.clientX - rect.left < 5) {\r\n                            e.target.style.cursor = 'nw-resize';\r\n                        } else {\r\n                            e.target.style.cursor = 'n-resize';\r\n                        }\r\n                    } else if (rect.height - (e.clientY - rect.top) < 5) {\r\n                        if (rect.width - (e.clientX - rect.left) < 5) {\r\n                            e.target.style.cursor = 'se-resize';\r\n                        } else if (e.clientX - rect.left < 5) {\r\n                            e.target.style.cursor = 'sw-resize';\r\n                        } else {\r\n                            e.target.style.cursor = 's-resize';\r\n                        }\r\n                    } else if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'e-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'w-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 'move';\r\n                    }\r\n                } else {\r\n                    e.target.style.cursor = 'move';\r\n                }\r\n            }\r\n        }\r\n\r\n        if (mouseButton == 1 && editorAction && editorAction.d) {\r\n            // Change position or size\r\n            if (editorAction.d == 'move') {\r\n                // Change the position of the cropper\r\n                var cropOffsetX = e.clientX - editorAction.xOffset;\r\n                var cropOffsetY = e.clientY - editorAction.yOffset;\r\n\r\n                if (cropOffsetX < 0) {\r\n                    editorAction.e.style.left = '0px';\r\n                } else if (cropOffsetX > el.offsetWidth - crop.offsetWidth - 2) {\r\n                    editorAction.e.style.left = el.offsetWidth - crop.offsetWidth - 2 + 'px';\r\n                } else {\r\n                    editorAction.e.style.left = cropOffsetX + 'px';\r\n                }\r\n                \r\n                if (cropOffsetY < 0) {\r\n                    editorAction.e.style.top = '0px';\r\n                } else if (cropOffsetY > el.offsetHeight - crop.offsetHeight - 2){\r\n                    editorAction.e.style.top = el.offsetHeight - crop.offsetHeight - 2 + 'px';\r\n                } else {\r\n                    editorAction.e.style.top = cropOffsetY + 'px';\r\n                }\r\n            } else {\r\n                // Change the size of the cropper\r\n                if (editorAction.d == 'e-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'se-resize') {\r\n                    // Handles size changes involving the right side of the cropper\r\n                    var newWidth = editorAction.w + e.clientX - editorAction.x;\r\n                    var offset = editorAction.e.style.left.slice(0, editorAction.e.style.left.length - 2);\r\n\r\n                    if (newWidth < obj.options.crop[0]) {\r\n                        editorAction.e.style.width = obj.options.crop[0] + 'px';\r\n                    } else if (newWidth + parseInt(offset) > el.offsetWidth - 2) {\r\n                        editorAction.e.style.width = el.offsetWidth - offset - 2 + 'px';\r\n                    } else {\r\n                        editorAction.e.style.width = editorAction.w + e.clientX - editorAction.x + 'px';\r\n                    }\r\n                } else if (editorAction.d == 'w-resize' || editorAction.d == 'nw-resize' ||  editorAction.d == 'sw-resize') {\r\n                    // Handles size changes involving the left side of the cropper\r\n                    var newOffset = e.clientX - editorAction.xOffset;\r\n                    var newWidth = editorAction.x + editorAction.w - e.clientX;\r\n\r\n                    if (newWidth < obj.options.crop[0]) {\r\n                        editorAction.e.style.left = editorAction.x + editorAction.w - obj.options.crop[0] - editorAction.xOffset + 'px';\r\n                        editorAction.e.style.width = obj.options.crop[0] + 'px';\r\n                    } else if (newOffset < 0) {\r\n                        editorAction.e.style.left = '0px';\r\n                        editorAction.e.style.width = editorAction.x + editorAction.w - editorAction.xOffset + 'px';\r\n                    } else {\r\n                        editorAction.e.style.left = newOffset + 'px';\r\n                        editorAction.e.style.width = newWidth + 'px';\r\n                    }\r\n                }\r\n\r\n                if (editorAction.d == 's-resize' || editorAction.d == 'se-resize' ||  editorAction.d == 'sw-resize') {\r\n                    // Handles size changes involving the top side of the cropper\r\n                    var newHeight = editorAction.h + e.clientY - editorAction.y;\r\n                    var offset = editorAction.e.style.top.slice(0, editorAction.e.style.top.length - 2);\r\n\r\n                    if (newHeight < obj.options.crop[1]) {\r\n                        editorAction.e.style.height = obj.options.crop[1] + 'px';\r\n                    } else if (newHeight + parseInt(offset) > el.offsetHeight - 2) {\r\n                        editorAction.e.style.height = el.offsetHeight - parseInt(offset) - 2 + 'px';\r\n                    } else {\r\n                        editorAction.e.style.height = newHeight + 'px';\r\n                    }\r\n                } else if (editorAction.d == 'n-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'nw-resize') {\r\n                    // Handles size changes involving the bottom side of the cropper\r\n                    var newOffset = e.clientY - editorAction.yOffset;\r\n                    var newHeight = editorAction.h + editorAction.y - e.clientY;\r\n\r\n                    if (newHeight < obj.options.crop[1]) {\r\n                        editorAction.e.style.top = editorAction.y + editorAction.h - obj.options.crop[1] - editorAction.yOffset + 'px';\r\n                        editorAction.e.style.height = obj.options.crop[1] + 'px';\r\n                    } else if (newOffset < 0) {\r\n                        editorAction.e.style.top = '0px';\r\n                        editorAction.e.style.height = editorAction.y + editorAction.h - editorAction.yOffset + 'px';\r\n                    } else {\r\n                        editorAction.e.style.top = newOffset + 'px';\r\n                        editorAction.e.style.height = newHeight + 'px';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // image state to change its current position in el container (mobile only)\r\n    var imageState = {\r\n        mousedown: false,\r\n        mouseX: 0,\r\n        mouseY: 0\r\n    }\r\n\r\n    var touchstartListener = function(e) {\r\n        if (! e.target.classList.contains('jcrop-area')) {\r\n            imageState.mousedown = true;\r\n        }\r\n\r\n        if (e.changedTouches && e.changedTouches[0]) {\r\n            imageState.mouseX = e.changedTouches[0].clientX;\r\n            imageState.mouseY = e.changedTouches[0].clientY;\r\n        } else {\r\n            imageState.mouseX = e.clientX;\r\n            imageState.mouseY = e.clientY;\r\n        }\r\n\r\n        if (e.touches) {\r\n            if(e.touches.length == 2) {\r\n                imageState.mousedown = false;\r\n                scaling = true;\r\n                pinchStart(e);\r\n            }\r\n        }\r\n    }\r\n    var touchEndListener = function(e) {\r\n        if (scaling) {\r\n            scaling = false;\r\n        }\r\n    }\r\n\r\n    var imageMoveListener = function(e) {\r\n        if (el.classList.contains('jcrop_edition') && ! scaling) {\r\n            // Mark position\r\n            if (e.changedTouches && e.changedTouches[0]) {\r\n                var x = e.changedTouches[0].clientX;\r\n                var y = e.changedTouches[0].clientY;\r\n            } else {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            }\r\n\r\n            var currentX = x;\r\n            var newX = currentX - imageState.mouseX;\r\n            imageState.mouseX = currentX;\r\n\r\n            var currentY = y;\r\n            var newY = currentY - imageState.mouseY;\r\n            imageState.mouseY = currentY;\r\n\r\n            if (imageState.mousedown) {\r\n                obj.image.left += newX/properties.zoom.scale;\r\n                obj.image.top += newY/properties.zoom.scale;\r\n                refreshResizers();\r\n            }\r\n\r\n            e.preventDefault();\r\n        }\r\n\r\n        if(scaling) {\r\n            pinchMove(e);\r\n        }\r\n    }\r\n\r\n    document.addEventListener('mouseup', function(e) {\r\n        imageState.mousedown = false;\r\n    });\r\n\r\n    el.addEventListener('mouseup', editorMouseUp);\r\n    el.addEventListener('mousedown', editorMouseDown);\r\n    el.addEventListener('mousemove', editorMouseMove);\r\n    el.addEventListener('touchstart',touchstartListener);\r\n\r\n    el.addEventListener('touchend', touchEndListener);\r\n    el.addEventListener('touchmove', imageMoveListener);\r\n    el.addEventListener('mousedown',touchstartListener);\r\n    el.addEventListener('mousemove', imageMoveListener);\r\n\r\n    el.addEventListener(\"dblclick\", function(e) {\r\n        jSuites.click(attachmentInput);\r\n    });\r\n\r\n    el.addEventListener('dragenter', function(e) {\r\n        el.style.border = '1px dashed #000';\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragstop', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();  \r\n        e.stopPropagation();\r\n\r\n\r\n        var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n        var file = (e.originalEvent || e).dataTransfer.files;\r\n\r\n        if (file.length) {\r\n            for (var i = 0; i < e.dataTransfer.files.length; i++) {\r\n                obj.addFromFile(e.dataTransfer.files[i]);\r\n            }\r\n        } else if (html) {\r\n            // Create temp element\r\n            var div = document.createElement('div');\r\n            div.innerHTML = html;\r\n\r\n            // Extract images\r\n            var img = div.querySelector('img');\r\n\r\n            if (img) {\r\n                obj.addFromUrl(img.src);\r\n            }\r\n        }\r\n\r\n        el.style.border = '1px solid #eee';\r\n\r\n        return false;\r\n    });\r\n\r\n    el.addEventListener(\"wheel\", function(e) {\r\n        if (el.classList.contains('jcrop_edition')) {\r\n            // Update scale\r\n            if (e.deltaY > 0) {\r\n                if (properties.zoom.scale > 0.1) {\r\n                    properties.zoom.scale *= 0.97;\r\n                }\r\n            } else {\r\n                if (properties.zoom.scale < 5) {\r\n                    properties.zoom.scale *= 1.03;\r\n                }\r\n            }\r\n            properties.zoom.scale = parseFloat(properties.zoom.scale.toFixed(2));\r\n\r\n            // Update coordinates\r\n            var rect = el.getBoundingClientRect();\r\n            var x = e.clientX - rect.left;\r\n            var y = e.clientY - rect.top;\r\n\r\n            // Zoom on the image\r\n            var c = context.getImageData(x, y, 1, 1).data;\r\n            if (c[3] != 0) {\r\n                properties.zoom.origin.x = x;\r\n                properties.zoom.origin.y = y;\r\n            } else {\r\n            }\r\n\r\n            // Apply zoom\r\n            obj.zoom();\r\n\r\n            e.preventDefault();\r\n        }\r\n    });\r\n\r\n    // mobile events\r\n    el.addEventListener(\"click\", function(e) {\r\n        if (! el.classList.contains('jcrop_edition')) {\r\n            jSuites.click(attachmentInput);\r\n        }\r\n    });\r\n\r\n    // Initial options\r\n    obj.setOptions(options);\r\n\r\n    // Onchange\r\n    if (typeof(obj.options.onload) == 'function') {\r\n        obj.options.onload(el, obj);\r\n    }\r\n\r\n    // Mobile pinch zoom\r\n    var pinchStart = function(e) {\r\n        var rect = el.getBoundingClientRect();\r\n        properties.zoom.fingerDistance = Math.hypot(\r\n                e.touches[0].pageX - e.touches[1].pageX,\r\n                e.touches[0].pageY - e.touches[1].pageY);\r\n\r\n        properties.zoom.origin.x = ((e.touches[0].pageX - rect.left) + (e.touches[1].pageX - rect.left))/2;\r\n        properties.zoom.origin.y = ((e.touches[0].pageY - rect.top) + (e.touches[1].pageY - rect.top))/2;\r\n    }\r\n\r\n    var pinchMove = function(e) {\r\n        e.preventDefault();\r\n\r\n        var dist2 = Math.hypot(e.touches[0].pageX - e.touches[1].pageX,e.touches[0].pageY - e.touches[1].pageY);\r\n\r\n        if (dist2 > properties.zoom.fingerDistance) {\r\n            var dif =  dist2 - properties.zoom.fingerDistance;\r\n            var newZoom = properties.zoom.scale + properties.zoom.scale * dif * 0.0025;\r\n            if (newZoom <= 5.09) {\r\n               obj.zoom(newZoom);\r\n            }\r\n        }\r\n\r\n        if (dist2 < properties.zoom.fingerDistance) {\r\n            var dif =  properties.zoom.fingerDistance - dist2;\r\n            var newZoom = properties.zoom.scale - properties.zoom.scale * dif * 0.0025;\r\n            if (newZoom >= 0.1) {\r\n               obj.zoom(newZoom);\r\n            }\r\n        }\r\n        properties.zoom.fingerDistance = dist2;\r\n    }\r\n\r\n    el.crop = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.floating = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        type: 'big',\r\n        title: 'Untitled',\r\n        width: 510,\r\n        height: 472,\r\n    }\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Private methods\r\n\r\n    var setContent = function() {\r\n        var temp = document.createElement('div');\r\n        while (el.children[0]) {\r\n            temp.appendChild(el.children[0]);\r\n        }\r\n\r\n        obj.content = document.createElement('div');\r\n        obj.content.className = 'jfloating_content';\r\n        obj.content.innerHTML = el.innerHTML;\r\n\r\n        while (temp.children[0]) {\r\n            obj.content.appendChild(temp.children[0]);\r\n        }\r\n\r\n        obj.container = document.createElement('div');\r\n        obj.container.className = 'jfloating';\r\n        obj.container.appendChild(obj.content);\r\n\r\n        if (obj.options.title) {\r\n            obj.container.setAttribute('title', obj.options.title);\r\n        } else {\r\n            obj.container.classList.add('no-title');\r\n        }\r\n\r\n        // validate element dimensions\r\n        if (obj.options.width) {\r\n            obj.container.style.width = parseInt(obj.options.width) + 'px';\r\n        }\r\n\r\n        if (obj.options.height) {\r\n            obj.container.style.height = parseInt(obj.options.height) + 'px';\r\n        }\r\n\r\n        el.innerHTML = '';\r\n        el.appendChild(obj.container);\r\n    }\r\n\r\n    var setEvents = function() {\r\n        if (obj.container) {\r\n            obj.container.addEventListener('click', function(e) {\r\n                var rect = e.target.getBoundingClientRect();\r\n\r\n                if (e.target.classList.contains('jfloating')) {\r\n                    if (e.changedTouches && e.changedTouches[0]) {\r\n                        var x = e.changedTouches[0].clientX;\r\n                        var y = e.changedTouches[0].clientY;\r\n                    } else {\r\n                        var x = e.clientX;\r\n                        var y = e.clientY;\r\n                    }\r\n    \r\n                    if (rect.width - (x - rect.left) < 50 && (y - rect.top) < 50) {\r\n                        setTimeout(function() {\r\n                            obj.close();\r\n                        }, 100);\r\n                    } else {\r\n                        obj.setState();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    var setType = function() {\r\n        obj.container.classList.add('jfloating-' + obj.options.type);\r\n    }\r\n\r\n    obj.state = {\r\n        isMinized: false,\r\n    }\r\n\r\n    obj.setState = function() {\r\n        if (obj.state.isMinized) {\r\n            obj.container.classList.remove('jfloating-minimized');\r\n        } else {\r\n            obj.container.classList.add('jfloating-minimized');\r\n        }\r\n        obj.state.isMinized = ! obj.state.isMinized;\r\n    }\r\n\r\n    obj.close = function() {\r\n        jSuites.floating.elements.splice(jSuites.floating.elements.indexOf(obj.container), 1);\r\n        obj.updatePosition();\r\n        el.remove();\r\n    }\r\n\r\n    obj.updatePosition = function() {\r\n        for (var i = 0; i < jSuites.floating.elements.length; i ++) {\r\n            var floating = jSuites.floating.elements[i];\r\n            var prevFloating = jSuites.floating.elements[i - 1];\r\n            floating.style.right = i * (prevFloating ? prevFloating.offsetWidth : floating.offsetWidth) * 1.01 + 'px';\r\n        }\r\n    }   \r\n\r\n    obj.init = function() {\r\n        // Set content into root\r\n        setContent();\r\n\r\n        // Set dialog events\r\n        setEvents();\r\n\r\n        // Set dialog type\r\n        setType();\r\n\r\n        // Update floating position\r\n        jSuites.floating.elements.push(obj.container);\r\n        obj.updatePosition();\r\n\r\n        el.floating = obj;\r\n    }\r\n    \r\n    obj.init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.floating.elements = [];\r\n\r\njSuites.login = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: window.location.href,\r\n        prepareRequest: null,\r\n        accessToken: null,\r\n        deviceToken: null,\r\n        facebookUrl: null,\r\n        facebookAuthentication: null,\r\n        maxHeight: null,\r\n        onload: null,\r\n        onsuccess: null,\r\n        onerror: null,\r\n        message: null,\r\n        logo: null,\r\n        newProfile: false,\r\n        newProfileUrl: false,\r\n        newProfileLogin: false,\r\n        fullscreen: false,\r\n        newPasswordValidation: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Action\r\n    var action = null;\r\n\r\n    // Container\r\n    var container = document.createElement('form');\r\n    el.appendChild(container);\r\n\r\n    // Logo\r\n    var divLogo = document.createElement('div');\r\n    divLogo.className = 'jlogin-logo'\r\n    container.appendChild(divLogo);\r\n\r\n    if (obj.options.logo) {\r\n        var logo = document.createElement('img');\r\n        logo.src = obj.options.logo;\r\n        divLogo.appendChild(logo);\r\n    }\r\n\r\n    // Code\r\n    var labelCode = document.createElement('label');\r\n    labelCode.innerHTML = jSuites.translate('Please enter here the code received by email');\r\n    var inputCode = document.createElement('input');\r\n    inputCode.type = 'number';\r\n    inputCode.id = 'code';\r\n    inputCode.setAttribute('maxlength', 6);\r\n    var divCode = document.createElement('div');\r\n    divCode.appendChild(labelCode);\r\n    divCode.appendChild(inputCode);\r\n\r\n    // Hash\r\n    var inputHash = document.createElement('input');\r\n    inputHash.type = 'hidden';\r\n    inputHash.name = 'h';\r\n    var divHash = document.createElement('div');\r\n    divHash.appendChild(inputHash);\r\n\r\n    // Recovery\r\n    var inputRecovery = document.createElement('input');\r\n    inputRecovery.type = 'hidden';\r\n    inputRecovery.name = 'recovery';\r\n    inputRecovery.value = '1';\r\n    var divRecovery = document.createElement('div');\r\n    divRecovery.appendChild(inputRecovery);\r\n\r\n    // Login\r\n    var labelLogin = document.createElement('label');\r\n    labelLogin.innerHTML = jSuites.translate('Login');\r\n    var inputLogin = document.createElement('input');\r\n    inputLogin.type = 'text';\r\n    inputLogin.name = 'login';\r\n    inputLogin.setAttribute('autocomplete', 'off');\r\n    inputLogin.onkeyup = function() {\r\n        this.value = this.value.toLowerCase().replace(/[^a-zA-Z0-9_+]+/gi, '');\r\n    } \r\n    var divLogin = document.createElement('div');\r\n    divLogin.appendChild(labelLogin);\r\n    divLogin.appendChild(inputLogin);\r\n\r\n    // Name\r\n    var labelName = document.createElement('label');\r\n    labelName.innerHTML = jSuites.translate('Name');\r\n    var inputName = document.createElement('input');\r\n    inputName.type = 'text';\r\n    inputName.name = 'name';\r\n    var divName = document.createElement('div');\r\n    divName.appendChild(labelName);\r\n    divName.appendChild(inputName);\r\n\r\n    // Email\r\n    var labelUsername = document.createElement('label');\r\n    labelUsername.innerHTML = jSuites.translate('E-mail');\r\n    var inputUsername = document.createElement('input');\r\n    inputUsername.type = 'text';\r\n    inputUsername.name = 'username';\r\n    inputUsername.setAttribute('autocomplete', 'new-username');\r\n    var divUsername = document.createElement('div');\r\n    divUsername.appendChild(labelUsername);\r\n    divUsername.appendChild(inputUsername);\r\n\r\n    // Password\r\n    var labelPassword = document.createElement('label');\r\n    labelPassword.innerHTML = jSuites.translate('Password');\r\n    var inputPassword = document.createElement('input');\r\n    inputPassword.type = 'password';\r\n    inputPassword.name = 'password';\r\n    inputPassword.setAttribute('autocomplete', 'new-password');\r\n    var divPassword = document.createElement('div');\r\n    divPassword.appendChild(labelPassword);\r\n    divPassword.appendChild(inputPassword);\r\n    divPassword.onkeydown = function(e) {\r\n        if (e.keyCode == 13) {\r\n            obj.execute();\r\n        }\r\n    }\r\n\r\n    // Repeat password\r\n    var labelRepeatPassword = document.createElement('label');\r\n    labelRepeatPassword.innerHTML = jSuites.translate('Repeat the new password');\r\n    var inputRepeatPassword = document.createElement('input');\r\n    inputRepeatPassword.type = 'password';\r\n    inputRepeatPassword.name = 'password';\r\n    var divRepeatPassword = document.createElement('div');\r\n    divRepeatPassword.appendChild(labelRepeatPassword);\r\n    divRepeatPassword.appendChild(inputRepeatPassword);\r\n\r\n    // Remember checkbox\r\n    var labelRemember = document.createElement('label');\r\n    labelRemember.innerHTML = jSuites.translate('Remember me on this device');\r\n    var inputRemember = document.createElement('input');\r\n    inputRemember.type = 'checkbox';\r\n    inputRemember.name = 'remember';\r\n    inputRemember.value = '1';\r\n    labelRemember.appendChild(inputRemember);\r\n    var divRememberButton = document.createElement('div');\r\n    divRememberButton.className = 'rememberButton';\r\n    divRememberButton.appendChild(labelRemember);\r\n\r\n    // Login button\r\n    var actionButton = document.createElement('input');\r\n    actionButton.type = 'button';\r\n    actionButton.value = 'Log In';\r\n    actionButton.onclick = function() {\r\n        obj.execute();\r\n    }\r\n    var divActionButton = document.createElement('div');\r\n    divActionButton.appendChild(actionButton);\r\n\r\n    // Cancel button\r\n    var cancelButton = document.createElement('div');\r\n    cancelButton.innerHTML = jSuites.translate('Cancel');\r\n    cancelButton.className = 'cancelButton';\r\n    cancelButton.onclick = function() {\r\n        obj.requestAccess();\r\n    }\r\n    var divCancelButton = document.createElement('div');\r\n    divCancelButton.appendChild(cancelButton);\r\n\r\n    // Captcha\r\n    var labelCaptcha = document.createElement('label');\r\n    labelCaptcha.innerHTML = jSuites.translate('Please type here the code shown below');\r\n    var inputCaptcha = document.createElement('input');\r\n    inputCaptcha.type = 'text';\r\n    inputCaptcha.name = 'captcha';\r\n    var imageCaptcha = document.createElement('img');\r\n    var divCaptcha = document.createElement('div');\r\n    divCaptcha.className = 'jlogin-captcha';\r\n    divCaptcha.appendChild(labelCaptcha);\r\n    divCaptcha.appendChild(inputCaptcha);\r\n    divCaptcha.appendChild(imageCaptcha);\r\n\r\n    // Facebook\r\n    var facebookButton = document.createElement('div');\r\n    facebookButton.innerHTML = jSuites.translate('Login with Facebook');\r\n    facebookButton.className = 'facebookButton';\r\n    var divFacebookButton = document.createElement('div');\r\n    divFacebookButton.appendChild(facebookButton);\r\n    divFacebookButton.onclick = function() {\r\n        obj.requestLoginViaFacebook();\r\n    }\r\n    // Forgot password\r\n    var inputRequest = document.createElement('span');\r\n    inputRequest.innerHTML = jSuites.translate('Request a new password');\r\n    var divRequestButton = document.createElement('div');\r\n    divRequestButton.className = 'requestButton';\r\n    divRequestButton.appendChild(inputRequest);\r\n    divRequestButton.onclick = function() {\r\n        obj.requestNewPassword();\r\n    }\r\n    // Create a new Profile\r\n    var inputNewProfile = document.createElement('span');\r\n    inputNewProfile.innerHTML = jSuites.translate('Create a new profile');\r\n    var divNewProfileButton = document.createElement('div');\r\n    divNewProfileButton.className = 'newProfileButton';\r\n    divNewProfileButton.appendChild(inputNewProfile);\r\n    divNewProfileButton.onclick = function() {\r\n        obj.newProfile();\r\n    }\r\n\r\n    el.className = 'jlogin';\r\n\r\n    if (obj.options.fullscreen == true) {\r\n        el.classList.add('jlogin-fullscreen');\r\n    }\r\n\r\n    /** \r\n     * Show message\r\n     */\r\n    obj.showMessage = function(data) {\r\n        var message = (typeof(data) == 'object') ? data.message : data;\r\n\r\n        if (typeof(obj.options.message) == 'function') {\r\n            obj.options.message(data);\r\n        } else {\r\n            jSuites.alert(data);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * New profile\r\n     */\r\n    obj.newProfile = function() {\r\n        container.innerHTML = '';\r\n        container.appendChild(divLogo);\r\n        if (obj.options.newProfileLogin) {\r\n            container.appendChild(divLogin);\r\n        }\r\n        container.appendChild(divName);\r\n        container.appendChild(divUsername);\r\n        container.appendChild(divActionButton);\r\n        if (obj.options.facebookAuthentication == true) {\r\n            container.appendChild(divFacebookButton);\r\n        }\r\n        container.appendChild(divCancelButton);\r\n\r\n        // Reset inputs\r\n        inputLogin.value = '';\r\n        inputUsername.value = '';\r\n        inputPassword.value = '';\r\n\r\n        // Button\r\n        actionButton.value = jSuites.translate('Create a new profile');\r\n\r\n        // Action\r\n        action = 'newProfile';\r\n    }\r\n\r\n    /**\r\n     * Request the email with the recovery instructions\r\n     */\r\n    obj.requestNewPassword = function() {\r\n        if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\r\n            var captcha = true;\r\n        }\r\n\r\n        container.innerHTML = '';\r\n        container.appendChild(divLogo);\r\n        container.appendChild(divRecovery);\r\n        container.appendChild(divUsername);\r\n        if (captcha) {\r\n            container.appendChild(divCaptcha);\r\n        }\r\n        container.appendChild(divActionButton);\r\n        container.appendChild(divCancelButton);\r\n        actionButton.value = jSuites.translate('Request a new password');\r\n        inputRecovery.value = 1;\r\n\r\n        // Action\r\n        action = 'requestNewPassword';\r\n    }\r\n\r\n    /**\r\n     * Confirm recovery code\r\n     */\r\n    obj.codeConfirmation = function() {\r\n        container.innerHTML = '';\r\n        container.appendChild(divLogo);\r\n        container.appendChild(divHash);\r\n        container.appendChild(divCode);\r\n        container.appendChild(divActionButton);\r\n        container.appendChild(divCancelButton);\r\n        actionButton.value = jSuites.translate('Confirm the code');\r\n        inputRecovery.value = 2;\r\n\r\n        // Action\r\n        action = 'codeConfirmation';\r\n    }\r\n\r\n    /**\r\n     * Update my password\r\n     */\r\n    obj.changeMyPassword = function(hash) {\r\n        container.innerHTML = '';\r\n        container.appendChild(divLogo);\r\n        container.appendChild(divHash);\r\n        container.appendChild(divPassword);\r\n        container.appendChild(divRepeatPassword);\r\n        container.appendChild(divActionButton);\r\n        container.appendChild(divCancelButton);\r\n        actionButton.value = jSuites.translate('Change my password');\r\n        inputHash.value = hash;\r\n\r\n        // Action\r\n        action = 'changeMyPassword';\r\n    }\r\n\r\n    /**\r\n     * Request access default method\r\n     */\r\n    obj.requestAccess = function() {\r\n        container.innerHTML = '';\r\n        container.appendChild(divLogo);\r\n        container.appendChild(divUsername);\r\n        container.appendChild(divPassword);\r\n        container.appendChild(divActionButton);\r\n        if (obj.options.facebookAuthentication == true) {\r\n            container.appendChild(divFacebookButton);\r\n        }\r\n        container.appendChild(divRequestButton);\r\n        container.appendChild(divRememberButton);\r\n        container.appendChild(divRequestButton);\r\n        if (obj.options.newProfile == true) {\r\n            container.appendChild(divNewProfileButton);\r\n        }\r\n\r\n        // Button\r\n        actionButton.value = jSuites.translate('Login');\r\n\r\n        // Password\r\n        inputPassword.value = '';\r\n\r\n        // Email persistence\r\n        if (window.localStorage.getItem('username')) {\r\n            inputUsername.value = window.localStorage.getItem('username');\r\n            inputPassword.focus();\r\n        } else {\r\n            inputUsername.focus();\r\n        }\r\n\r\n        // Action\r\n        action = 'requestAccess';\r\n    }\r\n\r\n    /**\r\n     * Request login via facebook\r\n     */\r\n    obj.requestLoginViaFacebook = function() {\r\n        if (typeof(deviceNotificationToken) == 'undefined') {\r\n            FB.getLoginStatus(function(response) {\r\n                if (! response.status || response.status != 'connected') {\r\n                    FB.login(function(response) {\r\n                        if (response.authResponse) {\r\n                            obj.execute({ f:response.authResponse.accessToken });\r\n                        } else {\r\n                            obj.showMessage(jSuites.translate('Not authorized by facebook'));\r\n                        }\r\n                    }, {scope: 'public_profile,email'});\r\n                } else {\r\n                    obj.execute({ f:response.authResponse.accessToken });\r\n                }\r\n            }, true);\r\n        } else {\r\n            jDestroy = function() {\r\n                fbLogin.removeEventListener('loadstart', jStart);\r\n                fbLogin.removeEventListener('loaderror', jError);\r\n                fbLogin.removeEventListener('exit', jExit);\r\n                fbLogin.close();\r\n                fbLogin = null;\r\n            }\r\n\r\n            jStart = function(event) {\r\n                var url = event.url;\r\n                if (url.indexOf(\"access_token\") >= 0) {\r\n                    setTimeout(function(){\r\n                        var u = url.match(/=(.*?)&/);\r\n                        if (u[1].length > 32) {\r\n                            obj.execute({ f:u[1] });\r\n                        }\r\n                        jDestroy();\r\n                   },500);\r\n                }\r\n\r\n                if (url.indexOf(\"error=access_denied\") >= 0) {\r\n                   setTimeout(jDestroy ,500);\r\n                   // Not authorized by facebook\r\n                   obj.showMessage(jSuites.translate('Not authorized by facebook'));\r\n                }\r\n            }\r\n\r\n            jError = function(event) {\r\n                jDestroy();\r\n            }\r\n        \r\n            jExit = function(event) {\r\n                jDestroy();\r\n            }\r\n\r\n            fbLogin = window.open(obj.options.facebookUrl, \"_blank\", \"location=no,closebuttoncaption=Exit,disallowoverscroll=yes,toolbar=no\");\r\n            fbLogin.addEventListener('loadstart', jStart);\r\n            fbLogin.addEventListener('loaderror', jError);\r\n            fbLogin.addEventListener('exit', jExit);\r\n        }\r\n\r\n        // Action\r\n        action = 'requestLoginViaFacebook';\r\n    }\r\n\r\n    // Perform request\r\n    obj.execute = function(data) {\r\n        // New profile\r\n        if (action == 'newProfile') {\r\n            if (! jSuites.validations.email(inputUsername.value)) {\r\n                var message = jSuites.translate('Invalid e-mail address'); \r\n            }\r\n            if (! jSuites.validations.login(inputLogin.value)) {\r\n                var message = jSuites.translate('Invalid username, please use only characters and numbers');\r\n            }\r\n            if (message) {\r\n                obj.showMessage(message);\r\n                return false;\r\n            }\r\n        } else if (action == 'changeMyPassword') {\r\n            if (inputPassword.value.length < 3) {\r\n                var message = jSuites.translate('Password is too short');\r\n            } else  if (inputPassword.value != inputRepeatPassword.value) {\r\n                var message = jSuites.translate('Password should match');\r\n            } else {\r\n                if (typeof(obj.options.newPasswordValidation) == 'function') {\r\n                    var val = obj.options.newPasswordValidation(obj, inputPassword.value, inputPassword.value);\r\n                    if (val != undefined) {\r\n                        message = val;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (message) {\r\n                obj.showMessage(message);\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Keep email\r\n        if (inputUsername.value != '') {\r\n            window.localStorage.setItem('username', inputUsername.value);\r\n        }\r\n\r\n        // Captcha\r\n        if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\r\n            if (inputCaptcha.value == '') {\r\n                obj.showMessage(jSuites.translate('Please enter the captch code below'));\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Url\r\n        var url = obj.options.url;\r\n\r\n        // Device token\r\n        if (obj.options.deviceToken) {\r\n            url += '?token=' + obj.options.deviceToken;\r\n        }\r\n\r\n        // Callback\r\n        var onsuccess = function(result) {\r\n            if (result) {\r\n                // Successfully response\r\n                if (result.success == 1) {\r\n                    // Recovery process\r\n                    if (action == 'requestNewPassword') {\r\n                        obj.codeConfirmation();\r\n                    } else if (action == 'codeConfirmation') {\r\n                        obj.requestAccess();\r\n                    } else if (action == 'newProfile') {\r\n                        obj.requestAccess();\r\n                        // New profile\r\n                        result.newProfile = true;\r\n                    }\r\n\r\n                    // Token\r\n                    if (result.token) {\r\n                        // Set token\r\n                        obj.options.accessToken = result.token;\r\n                        // Save token\r\n                        window.localStorage.setItem('Access-Token', result.token);\r\n                    }\r\n                }\r\n\r\n                // Show message\r\n                if (result.message) {\r\n                    // Show message\r\n                    obj.showMessage(result.message)\r\n                }\r\n\r\n                // Request captcha code\r\n                if (! result.data) {\r\n                    if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\r\n                        divCaptcha.remove();\r\n                    }\r\n                } else {\r\n                    container.insertBefore(divCaptcha, divActionButton);\r\n                    imageCaptcha.setAttribute('src', 'data:image/png;base64,' + result.data);\r\n                }\r\n\r\n                // Give time to user see the message\r\n                if (result.hash) {\r\n                    // Change password\r\n                    obj.changeMyPassword(result.hash);\r\n                } else if (result.url) {\r\n                    // App initialization\r\n                    if (result.success == 1) {\r\n                        if (typeof(obj.options.onsuccess) == 'function') {\r\n                            obj.options.onsuccess(result);\r\n                        } else {\r\n                            if (result.message) {\r\n                                setTimeout(function() { window.location.href = result.url; }, 2000);\r\n                            } else {\r\n                                window.location.href = result.url;\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (typeof(obj.options.onerror) == 'function') {\r\n                            obj.options.onerror(result);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Password\r\n        if (! data) {\r\n            var data = jSuites.form.getElements(el, true);\r\n            // Encode passworfd\r\n            if (data.password) {\r\n                data.password = jSuites.sha512(data.password);\r\n            }\r\n            // Recovery code\r\n            if (Array.prototype.indexOf.call(container.children, divCode) >= 0 && inputCode.value) {\r\n                data.h = jSuites.sha512(inputCode.value);\r\n            }\r\n        }\r\n\r\n        // Loading\r\n        el.classList.add('jlogin-loading');\r\n\r\n        // Url\r\n        var url = (action == 'newProfile' && obj.options.newProfileUrl) ? obj.options.newProfileUrl : obj.options.url;\r\n\r\n        // Remote call\r\n        jSuites.ajax({\r\n            url: url,\r\n            method: 'POST',\r\n            dataType: 'json',\r\n            data: data,\r\n            success: function(result) {\r\n                // Remove loading\r\n                el.classList.remove('jlogin-loading');\r\n                // Callback\r\n                onsuccess(result);\r\n            },\r\n            error: function(result) {\r\n                // Error\r\n                el.classList.remove('jlogin-loading');\r\n\r\n                if (typeof(obj.options.onerror) == 'function') {\r\n                    obj.options.onerror(result);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    var queryString = window.location.href.split('?');\r\n    if (queryString[1] && queryString[1].length == 130 && queryString[1].substr(0,2) == 'h=') {\r\n        obj.changeMyPassword(queryString[1].substr(2));\r\n    } else {\r\n        obj.requestAccess();\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.login.sha512 = jSuites.sha512;\r\n\r\njSuites.menu = (function(el, options) {\r\n    var obj = {};\r\n\r\n    obj.show = function() {\r\n        el.style.display = 'block';\r\n        jSuites.animation.slideLeft(el, 1);\r\n    }\r\n\r\n    obj.hide = function() {\r\n        jSuites.animation.slideLeft(el, 0, function() {\r\n            el.style.display = '';\r\n        });\r\n    }\r\n\r\n    obj.load = function() {\r\n        if (localStorage) {\r\n            var menu = el.querySelectorAll('nav');\r\n            var selected = null;\r\n            for (var i = 0; i < menu.length; i++) {\r\n                menu[i].classList.remove('selected');\r\n                if (menu[i].getAttribute('data-id')) {\r\n                    var state = localStorage.getItem('jmenu-' + menu[i].getAttribute('data-id'));\r\n                    if (state === null || state == 1) {\r\n                        menu[i].classList.add('selected');\r\n                    }\r\n                }\r\n            }\r\n            var href = window.location.pathname;\r\n            if (href) {\r\n                var menu = document.querySelector('.jmenu a[href=\"'+ href +'\"]');\r\n                if (menu) {\r\n                    menu.classList.add('selected');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.select = function(o) {\r\n        var menu = el.querySelectorAll('nav a');\r\n        for (var i = 0; i < menu.length; i++) {\r\n            menu[i].classList.remove('selected');\r\n        }\r\n        o.classList.add('selected');\r\n\r\n        // Better navigation\r\n        if (options && options.collapse == true) {\r\n            if (o.classList.contains('show')) {\r\n                menu = el.querySelectorAll('nav');\r\n                for (var i = 0; i < menu.length; i++) {\r\n                    menu[i].style.display = '';\r\n                }\r\n                o.style.display = 'none';\r\n            } else {\r\n                menu = el.querySelectorAll('nav');\r\n                for (var i = 0; i < menu.length; i++) {\r\n                    menu[i].style.display = 'none';\r\n                }\r\n\r\n                menu = el.querySelector('.show');\r\n                if (menu) {\r\n                    menu.style.display = 'block';\r\n                }\r\n\r\n                menu = jSuites.findElement(o.parentNode, 'selected');\r\n                if (menu) {\r\n                    menu.style.display = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Close menu if is oped\r\n        if (jSuites.getWindowWidth() < 800) {\r\n            setTimeout(function() {\r\n                obj.hide();\r\n            }, 0);\r\n        }\r\n    }\r\n\r\n    var actionDown = function(e) {\r\n        if (e.target.tagName == 'H2') {\r\n            if (e.target.parentNode.classList.contains('selected')) {\r\n                e.target.parentNode.classList.remove('selected');\r\n                localStorage.setItem('jmenu-' + e.target.parentNode.getAttribute('data-id'), 0);\r\n            } else {\r\n                e.target.parentNode.classList.add('selected');\r\n                localStorage.setItem('jmenu-' + e.target.parentNode.getAttribute('data-id'), 1);\r\n            }\r\n        } else if (e.target.tagName == 'A') {\r\n            // Mark link as selected\r\n            obj.select(e.target);\r\n        }\r\n    }\r\n\r\n    if ('ontouchstart' in document.documentElement === true) {\r\n        el.addEventListener('touchstart', actionDown);\r\n    } else {\r\n        el.addEventListener('mousedown', actionDown);\r\n    }\r\n\r\n    // Add close action\r\n    var i = document.createElement('i');\r\n    i.className = 'material-icons small-screen-only close';\r\n    i.innerText = 'close';\r\n    i.onclick = function() {\r\n        obj.hide();\r\n    }\r\n    el.appendChild(i);\r\n\r\n    // Add menu class\r\n    el.classList.add('jmenu');\r\n\r\n    // Load state\r\n    obj.load();\r\n\r\n    if (options && typeof(options.onload) == 'function') {\r\n        options.onload(el);\r\n    }\r\n\r\n    // Keep reference\r\n    el.menu = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\njSuites.organogram = (function(el, options) {\n    if (el.organogram) {\n        return el.organogram.setOptions(options, true);\n    }\n\n    var obj = {};\n    obj.options = {};\n\n    // Defines the state to deal with mouse events \n    var state = {\n        x: 0,\n        y: 0,\n        initialWidth: 0,\n        initialTop: 100,\n        fingerDistance: 0,\n        mobileDown: false,\n        scaling: false,\n        scale: 1,\n    }\n\n    var getRoleById = function(id) {\n       for (var i = 0; i < obj.options.roles.length; i++) {\n           if (id == obj.options.roles[i].id) {\n               return obj.options.roles[i];\n           }\n       }\n       return false;\n    }\n\n    var getContent = function(node) {\n        var role = node.role;\n        var color = node.color || 'lightgreen';\n        if (obj.options.roles && node.role >= 0) {\n            var o = getRoleById(node.role);\n            if (o) {\n                role = o.name;\n                var color = o.color;\n            }\n        }\n\n        return `<div class=\"jorg-user-status\" style=\"background:${color}\"></div>\n            <div class=\"jorg-user-info\">\n                <div class='jorg-user-img'><img src=\"${node.img ? node.img : '#'}\" ondragstart=\"return false\" /></div>\n                <div class='jorg-user-content'><span>${node.name}</span><span>${role}</span></div>\n            </div>`;\n    }\n\n    // Creates the shape of a node to be added to the organogram chart tree\n    var mountNodes = function(node, container) {\n        var li = document.createElement('li');\n        var span = document.createElement('span');\n        span.className = 'jorg-tf-nc';\n        span.innerHTML = getContent(node);\n        span.setAttribute('id', node.id);\n        var ul = document.createElement('ul');\n        li.appendChild(span);\n        li.appendChild(ul);\n        container.appendChild(li);\n\n        return ul;\n    }\n\n    // Return the render mode ( vertical or horizontal )\n    var getRenderMode = function(container) {\n        if (container.parentNode == el) {\n            return 'horizontal';\n        }\n        if (container.children.length > 1) {\n            for (var i = 0; i < container.children.length; i ++) {\n                if (Array.from(container.children[i].children).find(element => element.tagName == 'UL')) {\n                    return 'horizontal';\n                }\n            }\n            return 'vertical';\n        }\n        return 'vertical';\n    }\n\n    // Node visibility feature\n    var setNodeVisibility = function(node) {\n        var className = \"jorg-node-icon\";\n        var icon = document.createElement('div');\n        var ulNode = node.nextElementSibling;\n        node.appendChild(icon);\n\n        if (ulNode) {\n            icon.className = className + ' remove';\n        } else {\n            icon.className = className + ' plus'\n            return ;\n        }\n\n        icon.addEventListener('click', function(e) {\n            if (node.nextElementSibling.style.display == 'none') {\n                node.nextElementSibling.style.display = 'inline-flex';\n                node.removeAttribute('visibility');\n                e.target.className = className + ' remove';\n            } else {\n                node.nextElementSibling.style.display = 'none';\n                node.setAttribute('visibility','hidden');\n                e.target.className = className + ' plus';\n            }\n            ul.children[0].style.width = state.initialWidth + 'px';\n        });\n    }\n\n    // Renders the organogram\n    var render = function (parent, container) {\n        for (var i = 0; i < obj.options.data.length; i ++) {\n            if (obj.options.data[i].parent == parent) {\n                var ul = mountNodes(obj.options.data[i], container);\n                render(obj.options.data[i].id, ul);\n            }\n        }\n\n        // Check render mode / vertical / horizontal\n        var mode = getRenderMode(container);\n\n        if (mode == 'vertical' && obj.options.vertical) {\n            container.previousElementSibling.classList.add('jorg-after-none');\n            container.classList.add('jorg-vertical');\n        } else {\n            container.classList.add('jorg-horizontal');\n        }\n\n        if (! container.childNodes.length) {\n            container.remove();\n        } else if (container.previousElementSibling) {\n            setNodeVisibility(container.previousElementSibling);\n        }\n    }\n\n    // Sets the full screen mode\n    var setFullScreenMode = function(e) {\n        var windowScrollTop = document.body.scrollTop || document.documentElement.scrollTop;\n\n        if (el.classList.contains('fullscreen-mode')) {\n            el.classList.remove('fullscreen-mode');\n            document.body.classList.remove('jorg-hide-scrollbars');\n            el.style.top = '0px';\n            e.target.innerText ='slideshow';\n        } else {\n            el.classList.add('fullscreen-mode');\n            document.body.classList.add('jorg-hide-scrollbars');\n            el.style.top = windowScrollTop + 'px';\n            e.target.innerText ='close_fullscreen';\n        }\n    }\n\n    // Deals with zoom in and zoom out in the organogram\n    var zoom = function(e) {\n        e = event || window.event;\n        // Current zoom\n        var currentZoom = state.scale = el.children[0].style.zoom * 1;\n        var prevWidth = el.children[0].offsetWidth;\n        var prevHeight = el.children[0].offsetHeight;\n        var widthVar, heightVar;\n        // Action\n        if (e.target.classList.contains('jorg-zoom-in') || e.deltaY < 0) {\n            el.children[0].style.zoom = currentZoom + obj.options.zoom;\n            widthVar = prevWidth - el.children[0].offsetWidth;\n            heightVar = prevHeight - el.children[0].offsetHeight;\n            el.children[0].scrollLeft += (widthVar/2)\n            el.children[0].scrollTop += (heightVar/2)\n        } else if (currentZoom > .5) {\n            el.children[0].style.zoom = state.scale = currentZoom - obj.options.zoom;\n            widthVar = el.children[0].offsetWidth - prevWidth;\n            heightVar = el.children[0].offsetHeight - prevHeight;\n            el.children[0].scrollLeft -= (widthVar/2);\n            el.children[0].scrollTop -= (heightVar/2);\n        }\n        e.preventDefault();\n    }\n\n    // Finds a node in the organogram chart by a node propertie\n    var findNode = function(o) {\n        if (o && typeof o == 'object') {\n            var keys = Object.keys(o);\n            for (var i = 0; i < keys.length; i ++) {\n                var property = keys[i];\n                var node = obj.options.data.find(node => node[property] == o[property]);\n                if (node) {\n                    return Array.prototype.slice.call(document.querySelectorAll('.jorg-tf-nc')).find(n => n.getAttribute('id') == node.id);\n                } else {\n                    continue;\n                }\n            }\n        }\n        return 0;\n    }\n\n    //\n    var setInitialPosition = function() {\n        if (ul && ul.children[0]) {\n            ul.children[0].style.left = (ul.clientWidth / 2  - ul.children[0].clientWidth / 2) + 'px';\n            ul.children[0].style.top = '100px';\n        }\n    }\n\n    //\n    var setInitialWidth = function() {\n        if (ul.children[0]) {\n            state.initialWidth = ul.children[0].clientWidth;\n        }\n    }\n\n    //\n    var animateOnSearch = function(newLeft, newTop) {\n        ul.classList.add('jorg-search-animation');\n        ul.onanimationend = function(e) {\n            if (e.animationName == 'jorg-searching-hide') {\n                ul.children[0].style.left = newLeft + 'px';\n                ul.children[0].style.top = newTop + 'px';\n                ul.classList.remove('jorg-search-animation');\n                ul.classList.add('jorg-searching-visible');\n            }else if(e.animationName == 'jorg-searching-visible') {\n                ul.classList.remove('jorg-searching-visible');\n            }\n        }\n    }\n\n    /**\n     * Set the options\n     * @param {object} options\n     */\n    obj.setOptions = function(options, reset) {\n        // Default configuration\n        var defaults = {\n            data: null,\n            url: null,\n            zoom: 0.1,\n            width: 800,\n            height: 600,\n            search: true,\n            searchPlaceHolder: 'Search',\n            vertical: false,\n            roles: null,\n            // Events\n            onload: null,\n            onchange: null,\n            onclick: null\n        };\n\n        // Loop through our object\n        for (var property in defaults) {\n            if (options && options.hasOwnProperty(property)) {\n                obj.options[property] = options[property];\n            } else {\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\n                    obj.options[property] = defaults[property];\n                }\n            }\n        }\n\n        // Show search box\n        if (obj.options.search) {\n            el.appendChild(search);\n        } else {\n            if (search.parentElement) {\n                el.removeChild(search);\n            }\n        }\n\n        // Make sure correct format\n        obj.options.width = parseInt(obj.options.width);\n        obj.options.height = parseInt(obj.options.height);\n\n        // Update placeholder\n        search.placeholder = obj.options.searchPlaceHolder;\n\n        // Set default dimensions\n        if (options.width || options.height) {\n            obj.setDimensions(obj.options.width, obj.options.height);\n        }\n\n        // Only execute when is not the first time\n        if (el.organogram) {\n            obj.refresh();\n        }\n\n        return obj;\n    }\n\n    /**\n     * Reset roles\n     */\n    obj.setRoles = function(roles) {\n        if (roles) {\n            obj.options.roles = roles;\n            obj.refresh();\n        }\n    }\n\n    obj.setUrl = function(url) {\n        jSuites.ajax({\n            url: url,\n            method: 'GET',\n            dataType: 'json',\n            success: function(result) {\n                obj.setData(result);\n            }\n        });\n    }\n\n    /**\n     * Refreshes the organozation chart\n     */\n    obj.update = function() {\n        el.children[0].innerHTML = '';\n        render(0,el.children[0]);\n    }\n\n    /**\n     * applies a zoom in the organization chart\n     */\n    obj.zoom = function(scale) {\n        if (scale < .5 ) {\n            scale = .5;\n        }\n        ul.style.zoom = state.scale = scale;\n    }\n\n    /**\n     * Reset the organogram chart tree\n     */\n    obj.refresh = function() {\n        el.children[0].innerHTML = '';\n        render(0,el.children[0]);\n        setInitialPosition();\n        setInitialWidth();\n    }\n\n    /**\n     * Show or hide childrens of a node\n     */\n    obj.show = function(id) {\n        var node = findNode({ id: id });\n        // Check if the node exists and if it has an icon\n        if (node && node.lastChild) {\n            // Click on the icon\n            node.lastChild.click();\n        }\n    }\n\n    /**\n     * Appends a new element in the organogram chart\n     */\n    obj.addItem = function(item) {\n        if (typeof item == 'object' && item.hasOwnProperty('id') && item.hasOwnProperty('parent') && ! isNaN(item.parent) && ! isNaN(item.id)) {\n            var findedParent = obj.options.data.find(function(node) {\n                if (node.id == item.parent) {\n                    return true;\n                }\n                return false;\n            });\n\n            if (findedParent) {\n                obj.options.data.push(item);\n                \n                obj.refresh();\n\n                if (typeof obj.options.onchange == 'function') {\n                    obj.options.onchange(el, obj);\n                }\n            }\n            else {\n                console.log('cannot add this item');\n            }\n        }\n    }\n\n    var removeItemRecursively = function(id) {\n        var itemIndex = obj.options.data.findIndex(function(node) {\n            return node.id == id;\n        });\n\n        if (itemIndex > 0) {\n            obj.options.data.splice(itemIndex, 1);\n\n            var itemChildrenList = obj.options.data.filter(function(node) {\n                return node.parent === id;\n            });\n\n            itemChildrenList.forEach(function(childItem) {\n                removeItemRecursively(childItem.id);\n            });\n        }\n    }\n\n    /**\n     * Removes a item from the organogram chart\n     */\n    obj.removeItem = function(id) {\n        removeItemRecursively(id);\n\n        obj.refresh();\n    }\n\n    /**\n     * Sets a new value for the data array and re-render the organogram.\n     */\n    obj.setData = function(data) {\n        if (typeof(data) == 'object') {\n            obj.options.data = data;\n            obj.refresh();\n        }\n    }\n\n    /**\n     * Search for any item with the string and centralize it.\n     */\n    obj.search = function(str) {\n       var input = str.toLowerCase();\n\n       if (options) {\n            var data = obj.options.data;\n            var searchedNode = data.find(node => node.name.toLowerCase() == input);\n            if (searchedNode) {\n                var node = findNode({ id: searchedNode.id });\n                // Got to the node position\n                if (node) {\n                    var nodeRect = node.getBoundingClientRect();\n                    var ulRect = ul.getBoundingClientRect();\n                    var tm = (nodeRect.top - ulRect.top) - (ul.clientHeight / 2) + (node.clientHeight / 2)\n                    var lm = (nodeRect.left - ulRect.left) - (ul.clientWidth / 2) + (node.clientWidth / 2);\n                    var newTop = (parseFloat(ul.children[0].style.top) - tm);\n                    var newLeft = (parseFloat(ul.children[0].style.left) - lm);\n                    animateOnSearch(newLeft, newTop);\n                }\n            }\n        }\n    }\n\n    /**\n     * Change the organogram dimensions\n     */\n    obj.setDimensions = function(width, height) {\n        el.style.width = width + 'px';\n        el.style.height = height + 'px';\n    }\n\n    var pinchStart = function(e) {\n        state.fingerDistance = Math.hypot(e.touches[0].pageX - e.touches[1].pageX, e.touches[0].pageY - e.touches[1].pageY);\n    }\n\n    var pinchMove = function(e) {\n        e.preventDefault();\n\n        var dist2 = Math.hypot(e.touches[0].pageX - e.touches[1].pageX,e.touches[0].pageY - e.touches[1].pageY);\n\n        if (dist2 > state.fingerDistance) {\n            var dif =  dist2 - state.fingerDistance;\n            var newZoom = state.scale + state.scale * dif * 0.0025;\n            if (newZoom <= 5.09) {\n               obj.zoom(newZoom);\n               document.getElementById('info').textContent = newZoom;\n            }\n        }\n\n        if (dist2 < state.fingerDistance) {\n            var dif =  state.fingerDistance - dist2;\n            var newZoom = state.scale - state.scale * dif * 0.0025;\n            if (newZoom >= 0.1) {\n               obj.zoom(newZoom);\n               document.getElementById('info').textContent = newZoom;\n            }\n        }\n        state.fingerDistance = dist2;\n    }\n\n    var moving = false;\n\n    var moveListener = function(e){\n        e = e || window.event;\n        e.preventDefault();\n\n        if (! state.scaling) {\n            if (e.which || state.mobileDown) {\n                moving = true;\n\n                var currentX = e.clientX || e.pageX || (e.changedTouches && (e.changedTouches[0].pageX || e.changedTouches[0].clientX));\n                var currentY = e.clientY || e.pageY || (e.changedTouches && (e.changedTouches[0].pageY || e.changedTouches[0].clientY));\n\n                var x = state.x - currentX;\n                var y = (state.y - currentY);\n                var zoomFactor = ul.style.zoom <= 1 ? 1 + (1 - ul.style.zoom) : 1 - (ul.style.zoom - 1) < .5 ? .5 : 1 - (ul.style.zoom - 1);\n                ul.children[0].style.left = -(state.scrollLeft + x * zoomFactor)   + 'px';\n                ul.children[0].style.top = (state.scrollTop + y * zoomFactor * -1)   + 'px';\n            }\n        }\n        \n        if (state.scaling) {\n            pinchMove(e);\n        }\n    }\n\n    var touchListener = function(e) {\n        e = e || window.event;\n\n        if (e.changedTouches) {\n            state.mobileDown = true;\n        }\n\n        state.x = e.clientX || e.pageX || e.changedTouches[0].pageX || e.changedTouches[0].clientX;\n        state.y = e.clientY || e.pageY || e.changedTouches[0].pageY || e.changedTouches[0].clientY;\n        state.scrollLeft = - 1 * parseFloat(ul.children[0].style.left) || 0;\n        state.scrollTop = parseFloat(ul.children[0].style.top);\n\n        if (e.touches) {\n            if(e.touches.length == 2) {\n                state.scaling = true;\n                pinchStart(e);\n            }\n        }\n    }\n\n    var touchEnd = function(e) {\n        state.mobileDown = false;\n        if (state.scaling) {\n            state.scaling = false;\n        }\n\n        moving = false;\n    }\n\n    var ul = null;\n    var search = null;\n    var zoomContainer = null;\n    var zoomIn = null;\n    var zoomOut = null;\n    var fullscreen = null;\n\n    var init = function() {\n        // Create zoom action\n        zoomContainer = document.createElement('div');\n        zoomContainer.className = 'jorg-zoom-container';\n        obj.zoomContainer = zoomContainer;\n\n        zoomIn = document.createElement('i');\n        zoomIn.className = 'jorg-zoom-in material-icons jorg-action';\n        zoomIn.innerHTML = \"add_box\";\n\n        zoomOut = document.createElement('i');\n        zoomOut.className = 'jorg-zoom-out material-icons jorg-action';\n        zoomOut.innerHTML = \"indeterminate_check_box\";\n\n        fullscreen = document.createElement('i');\n        fullscreen.className = 'jorg-fullscreen material-icons jorg-action';\n        fullscreen.title = 'Fullscreen';\n        fullscreen.innerHTML = \"slideshow\";\n\n        zoomContainer.appendChild(fullscreen);\n        zoomContainer.appendChild(zoomIn);\n        zoomContainer.appendChild(zoomOut);\n\n        zoomIn.addEventListener('click', zoom);\n        zoomOut.addEventListener('click', zoom);\n        fullscreen.addEventListener('click', setFullScreenMode);\n\n        // Create container\n        ul = document.createElement('ul');\n\n        // Default zoom\n        if (! ul.style.zoom) {\n            ul.style.zoom = '1';\n        }\n\n        // Default classes\n        el.classList.add('jorg');\n        el.classList.add('jorg-tf-tree');\n        el.classList.add('jorg-unselectable');\n        ul.classList.add('jorg-disable-scrollbars');\n\n        // Append elements\n        el.appendChild(ul);\n        el.appendChild(zoomContainer);\n\n        search = document.createElement('input');\n        search.type = 'text';\n        search.classList.add('jorg-search');\n        search.onkeyup = function(e) {\n            obj.search(e.target.value);\n        }\n        search.onblur = function(e) {\n            e.target.value = '';\n        }\n\n        // Event handlers\n        ul.addEventListener('wheel', zoom);\n        ul.addEventListener('mousemove', moveListener);\n        ul.addEventListener('touchmove', moveListener);\n        ul.addEventListener('touchstart', touchListener);\n        ul.addEventListener('touchend', touchEnd);\n        ul.addEventListener('mousedown', touchListener);\n\n        el.addEventListener('click', function(e) {\n            if (!moving) {\n                if (typeof(obj.options.onclick) == 'function') {\n                    obj.options.onclick(el, obj, e);\n                }\n            } else {\n                moving = false;\n            }\n        });\n\n        obj.setOptions(options);\n\n        // Create\n        var create = function() {\n            render(0, ul);\n            setInitialPosition();\n            setInitialWidth();\n            // Set default dimensions\n            obj.setDimensions(obj.options.width, obj.options.height);\n\n            if (typeof obj.options.onload == 'function') {\n                obj.options.onload(el, obj);\n            }\n        }\n\n        // Loading data\n        if (obj.options.url) {\n            jSuites.ajax({\n                url: obj.options.url,\n                method: 'GET',\n                dataType: 'json',\n                success: function(result) {\n                    obj.options.data = result;\n\n                    create();\n                }\n            });\n        } else if (obj.options.data && obj.options.data.length) {\n            create();\n        }\n\n        el.organogram = obj;\n    }\n\n    init();\n\n    return obj;\n});\r\n\r\njSuites.template = (function(el, options) {\r\n    // Update configuration\r\n    if (el.classList.contains('jtemplate')) {\r\n        return el.template.setOptions(options);\r\n    }\r\n\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Search controls\r\n    var pageNumber = 0;\r\n    var searchTimer = null;\r\n    var searchResults = null;\r\n\r\n    // Parse events inside the template\r\n    var parse = function(element) {\r\n        // Attributes\r\n        var attr = {};\r\n\r\n        if (element.attributes && element.attributes.length) {\r\n            for (var i = 0; i < element.attributes.length; i++) {\r\n                attr[element.attributes[i].name] = element.attributes[i].value;\r\n            }\r\n        }\r\n\r\n        // Keys\r\n        var k = Object.keys(attr);\r\n\r\n        if (k.length) {\r\n            for (var i = 0; i < k.length; i++) {\r\n                // Parse events\r\n                if (k[i].substring(0,2) == 'on') {\r\n                    // Get event\r\n                    var event = k[i].toLowerCase();\r\n                    var value = attr[k[i]];\r\n\r\n                    // Get action\r\n                    element.removeAttribute(event);\r\n                    if (! element.events) {\r\n                        element.events = []\r\n                    }\r\n\r\n                    // Keep method to the event\r\n                    element[k[i].substring(2)] = value;\r\n                    if (obj.options.version == 2) {\r\n                        element[event] = function(e) {\r\n                            Function('template', 'e', element[e.type]).call(element, obj.options.template, e);\r\n                        }\r\n                    } else {\r\n                        element[event] = function(e) {\r\n                            Function('e', 'element', element[e.type]).call(obj.options.template, e, element);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check the children\r\n        if (element.children.length) {\r\n            for (var i = 0; i < element.children.length; i++) {\r\n                parse(element.children[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the options\r\n     */\r\n    obj.setOptions = function() {\r\n        // Default configuration\r\n        var defaults = {\r\n            version: null,\r\n            url: null,\r\n            data: null,\r\n            total: null,\r\n            filter: null,\r\n            template: null,\r\n            render: null,\r\n            noRecordsFound: 'No records found',\r\n            containerClass: null,\r\n            // Searchable\r\n            search: null,\r\n            searchInput: true,\r\n            searchPlaceHolder: '',\r\n            searchValue: '',\r\n            // Remote search\r\n            remoteData: false,\r\n            // Pagination page number of items\r\n            pagination: null,\r\n            // Events\r\n            onload: null,\r\n            onupdate: null,\r\n            onchange: null,\r\n            onsearch: null,\r\n            onclick: null,\r\n            oncreateitem: null,\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else if (typeof(obj.options[property]) === 'undefined') {\r\n                obj.options[property] = defaults[property];\r\n            }\r\n        }\r\n\r\n        // Pagination container\r\n        if (obj.options.pagination) {\r\n            el.insertBefore(pagination, el.firstChild);\r\n        } else {\r\n            if (pagination && pagination.parentNode) {\r\n                el.removeChild(pagination);\r\n            }\r\n        }\r\n\r\n\r\n        // Input search\r\n        if (obj.options.search && obj.options.searchInput == true) {\r\n            el.insertBefore(searchContainer, el.firstChild);\r\n            // Input value\r\n            obj.searchInput.value = obj.options.searchValue;\r\n        } else {\r\n            if (searchContainer && searchContainer.parentNode) {\r\n                el.removeChild(searchContainer);\r\n            }\r\n        }\r\n\r\n        // Search placeholder\r\n        if (obj.options.searchPlaceHolder) {\r\n            obj.searchInput.setAttribute('placeholder', obj.options.searchPlaceHolder);\r\n        } else {\r\n            obj.searchInput.removeAttribute('placeholder');\r\n        }\r\n\r\n        // Class for the container\r\n        if (obj.options.containerClass) {\r\n            container.classList.add(obj.options.containerClass);\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Contains the cache of local data loaded\r\n     */\r\n    obj.cache = [];\r\n\r\n    /**\r\n     * Append data to the template and add to the DOMContainer\r\n     * @param data\r\n     * @param contentDOMContainer\r\n     */\r\n    obj.setContent = function(a, b) {\r\n        // Get template\r\n        var c = obj.options.template[Object.keys(obj.options.template)[0]](a, obj);\r\n        // Process events\r\n        if ((c instanceof Element || c instanceof HTMLDocument)) {\r\n            b.appendChild(c);\r\n        } else {\r\n            b.innerHTML = c;\r\n        }\r\n\r\n        parse(b);\r\n    \r\n        // Oncreate a new item\r\n        if (typeof(obj.options.oncreateitem) == 'function') {\r\n            obj.options.oncreateitem(el, obj, b.children[0], a);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add a new option in the data\r\n     */\r\n    obj.addItem = function(data, beginOfDataSet) {\r\n        // Append itens\r\n        var content = document.createElement('div');\r\n        // Append data\r\n        if (beginOfDataSet) {\r\n            obj.options.data.unshift(data);\r\n        } else {\r\n            obj.options.data.push(data);\r\n        }\r\n        // If is empty remove indication\r\n        if (container.classList.contains('jtemplate-empty')) {\r\n            container.classList.remove('jtemplate-empty');\r\n            container.innerHTML = '';\r\n        }\r\n        // Get content\r\n        obj.setContent(data, content);\r\n        // Add animation\r\n        jSuites.animation.fadeIn(content.children[0]);\r\n        // Add and do the animation\r\n        if (beginOfDataSet) {\r\n            container.prepend(content.children[0]);\r\n        } else {\r\n            container.append(content.children[0]);\r\n        }\r\n        // Onchange method\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, obj.options.data);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Remove the item from the data\r\n     */\r\n    obj.removeItem = function(element) {\r\n        if (Array.prototype.indexOf.call(container.children, element) > -1) {\r\n            // Remove data from array\r\n            var index = obj.options.data.indexOf(element.dataReference);\r\n            if (index > -1) {\r\n                obj.options.data.splice(index, 1);\r\n            }\r\n            // Remove element from DOM\r\n            jSuites.animation.fadeOut(element, function() {\r\n                element.parentNode.removeChild(element);\r\n\r\n                if (! container.innerHTML) {\r\n                    container.classList.add('jtemplate-empty');\r\n                    container.innerHTML = obj.options.noRecordsFound;\r\n                }\r\n            });\r\n        } else {\r\n            console.error('Element not found');\r\n        }\r\n    }\r\n    /**\r\n     * Reset the data of the element\r\n     */\r\n    obj.setData = function(data) {\r\n        if (data) {\r\n            // Current page number\r\n            pageNumber = 0;\r\n            // Reset search\r\n            obj.options.searchValue = '';\r\n            // Set data\r\n            obj.options.data = data;\r\n            // Reset any search results\r\n            searchResults = null;\r\n\r\n            // Render new data\r\n            obj.render();\r\n\r\n            // Onchange method\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, obj.options.data);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the current page number\r\n     */\r\n    obj.getPage = function() {\r\n        return pageNumber;\r\n    }\r\n\r\n    /**\r\n     * Append data to the component \r\n     */\r\n    obj.appendData = function(data, p) {\r\n        if (p) {\r\n            pageNumber = p;\r\n        }\r\n\r\n        var execute = function(data) {\r\n            // Concat data\r\n            obj.options.data.concat(data);\r\n\r\n            var startNumber = 0;\r\n            var finalNumber = data.length;\r\n            // Append itens\r\n            var content = document.createElement('div');\r\n            for (var i = startNumber; i < finalNumber; i++) {\r\n                obj.setContent(data[i], content)\r\n                content.children[0].dataReference = data[i];\r\n                container.appendChild(content.children[0]);\r\n            }\r\n            \r\n        }\r\n\r\n        if (obj.options.url && obj.options.remoteData == true) {\r\n            // URL\r\n            var url = obj.options.url;\r\n            // Data\r\n            var ajaxData = {};\r\n            // Options for backend search\r\n            if (obj.options.remoteData) {\r\n                // Search value\r\n                if (obj.options.searchValue) {\r\n                    ajaxData.q = obj.options.searchValue;\r\n                }\r\n                // Page number\r\n                if (pageNumber) {\r\n                    ajaxData.p = pageNumber;\r\n                }\r\n                // Number items per page\r\n                if (obj.options.pagination) {\r\n                    ajaxData.t = obj.options.pagination;\r\n                }\r\n            }\r\n            // Remote loading\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                data: ajaxData,\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    execute(data);\r\n                }\r\n            });\r\n        } else {\r\n            if (! obj.options.data) {\r\n                console.log('TEMPLATE: no data or external url defined');\r\n            } else {\r\n                execute(data);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.renderTemplate = function() {\r\n        // Data container\r\n        var data = searchResults ? searchResults : obj.options.data;\r\n\r\n        // Data filtering\r\n        if (typeof(obj.options.filter) == 'function') {\r\n            data = obj.options.filter(data);\r\n        }\r\n\r\n        // Reset pagination container\r\n        pagination.innerHTML = '';\r\n\r\n        if (! data.length) {\r\n            container.innerHTML = obj.options.noRecordsFound;\r\n            container.classList.add('jtemplate-empty');\r\n        } else {\r\n            // Reset content\r\n            container.classList.remove('jtemplate-empty');\r\n\r\n            // Create pagination\r\n            if (obj.options.pagination && data.length > obj.options.pagination) {\r\n                var startNumber = (obj.options.pagination * pageNumber);\r\n                var finalNumber = (obj.options.pagination * pageNumber) + obj.options.pagination;\r\n\r\n                if (data.length < finalNumber) {\r\n                    var finalNumber = data.length;\r\n                }\r\n            } else {\r\n                var startNumber = 0;\r\n                var finalNumber = data.length;\r\n            }\r\n\r\n            // Append itens\r\n            var content = document.createElement('div');\r\n            for (var i = startNumber; i < finalNumber; i++) {\r\n                // Check if cache obj contains the element\r\n                if (! data[i].element) {\r\n                    obj.setContent(data[i], content);\r\n                    content.children[0].dataReference = data[i];\r\n                    data[i].element = content.children[0];\r\n                    // append element into cache\r\n                    obj.cache.push(data[i]);\r\n                    container.appendChild(content.children[0]);\r\n                } else {\r\n                    container.appendChild(data[i].element);\r\n                }\r\n            }\r\n\r\n            if (obj.options.total) {\r\n                var numberOfPages = Math.ceil(obj.options.total / obj.options.pagination);\r\n            } else {\r\n                var numberOfPages = Math.ceil(data.length / obj.options.pagination);\r\n            }\r\n\r\n            // Update pagination\r\n            if (obj.options.pagination > 0 && numberOfPages > 1) {\r\n                // Controllers\r\n                if (pageNumber < 6) {\r\n                    var startNumber = 0;\r\n                    var finalNumber = numberOfPages < 10 ? numberOfPages : 10;\r\n                } else if (numberOfPages - pageNumber < 5) {\r\n                    var startNumber = numberOfPages - 9;\r\n                    var finalNumber = numberOfPages;\r\n                    if (startNumber < 0) {\r\n                        startNumber = 0;\r\n                    }\r\n                } else {\r\n                    var startNumber = pageNumber - 4;\r\n                    var finalNumber = pageNumber + 5;\r\n                }\r\n\r\n                // First\r\n                if (startNumber > 0) {\r\n                    var paginationItem = document.createElement('div');\r\n                    paginationItem.innerHTML = '<';\r\n                    paginationItem.title = 0;\r\n                    pagination.appendChild(paginationItem);\r\n                }\r\n\r\n                // Get page links\r\n                for (var i = startNumber; i < finalNumber; i++) {\r\n                    var paginationItem = document.createElement('div');\r\n                    paginationItem.innerHTML = (i + 1);\r\n                    pagination.appendChild(paginationItem);\r\n\r\n                    if (pageNumber == i) {\r\n                        paginationItem.style.fontWeight = 'bold';\r\n                        paginationItem.style.textDecoration = 'underline';\r\n                    }\r\n                }\r\n\r\n                // Last\r\n                if (finalNumber < numberOfPages) {\r\n                    var paginationItem = document.createElement('div');\r\n                    paginationItem.innerHTML = '>';\r\n                    paginationItem.title = numberOfPages - 1;\r\n                    pagination.appendChild(paginationItem);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.render = function(p, forceLoad) {\r\n        // Update page number\r\n        if (p !== undefined) {\r\n            pageNumber = p;\r\n        }\r\n\r\n        // Render data into template\r\n        var execute = function() {\r\n            // Render new content\r\n            if (typeof(obj.options.render) == 'function') {\r\n                container.innerHTML = obj.options.render(obj);\r\n            } else {\r\n               container.innerHTML = '';\r\n            }\r\n\r\n            // Load data\r\n            obj.renderTemplate();\r\n\r\n            // On Update\r\n            if (typeof(obj.options.onupdate) == 'function') {\r\n                obj.options.onupdate(el, obj, pageNumber);\r\n            }\r\n\r\n            if (forceLoad) {\r\n                // Onload\r\n                if (typeof(obj.options.onload) == 'function') {\r\n                    obj.options.onload(el, obj, pageNumber);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (obj.options.url && (obj.options.remoteData == true || forceLoad)) {\r\n            // URL\r\n            var url = obj.options.url;\r\n            // Data\r\n            var ajaxData = {};\r\n            // Options for backend search\r\n            if (obj.options.remoteData) {\r\n                // Search value\r\n                if (obj.options.searchValue) {\r\n                    ajaxData.q = obj.options.searchValue;\r\n                }\r\n                // Page number\r\n                if (pageNumber) {\r\n                    ajaxData.p = pageNumber;\r\n                }\r\n                // Number items per page\r\n                if (obj.options.pagination) {\r\n                    ajaxData.t = obj.options.pagination;\r\n                }\r\n            }\r\n            // Remote loading\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                data: ajaxData,\r\n                success: function(data) {\r\n                    // Search and keep data in the client side\r\n                    if (data.hasOwnProperty(\"total\")) {\r\n                        obj.options.total = data.total;\r\n                        obj.options.data = data.data;\r\n                    } else {\r\n                        obj.options.total = null;\r\n                        obj.options.data = data;\r\n                    }\r\n\r\n                    // Load data for the user\r\n                    execute();\r\n                }\r\n            });\r\n        } else {\r\n            if (! obj.options.data) {\r\n                console.log('TEMPLATE: no data or external url defined');\r\n            } else {\r\n                // Load data for the user\r\n                execute();\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.search = function(query) {\r\n        // Page number\r\n        pageNumber = 0;\r\n        // Search query\r\n        obj.options.searchValue = query ? query : '';\r\n\r\n        // Filter data\r\n        if (obj.options.remoteData == true || ! query) {\r\n            searchResults = null;\r\n        } else {\r\n            var test = function(o, query) {\r\n                for (var key in o) {\r\n                    var value = o[key];\r\n\r\n                    if ((''+value).toLowerCase().search(query) >= 0) {\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n\r\n            searchResults = obj.options.data.filter(function(item) {\r\n                return test(item, query);\r\n            });\r\n        }\r\n\r\n        obj.render(0);\r\n\r\n        if (typeof(obj.options.onsearch) == 'function') {\r\n            obj.options.onsearch(el, obj, query);\r\n        }\r\n    }\r\n\r\n    obj.refresh = function() {\r\n        obj.cache = [];\r\n        obj.render();\r\n    }\r\n\r\n    obj.reload = function() {\r\n        obj.cache = [];\r\n        obj.render(0, true);\r\n    }\r\n\r\n    /**\r\n     * Events\r\n     */\r\n    el.addEventListener('mousedown', function(e) {\r\n        if (e.target.parentNode.classList.contains('jtemplate-pagination')) {\r\n            var index = e.target.innerText;\r\n            if (index == '<') {\r\n                obj.render(0);\r\n            } else if (index == '>') {\r\n                obj.render(e.target.getAttribute('title'));\r\n            } else {\r\n                obj.render(parseInt(index)-1);\r\n            }\r\n            e.preventDefault();\r\n        }\r\n    });\r\n\r\n    el.addEventListener('mouseup', function(e) {\r\n        if (typeof(obj.options.onclick) == 'function') {\r\n            obj.options.onclick(el, obj, e);\r\n        }\r\n    });\r\n\r\n    // Reset content\r\n    el.innerHTML = '';\r\n\r\n    // Container\r\n    var container = document.createElement('div');\r\n    container.classList.add ('jtemplate-content');\r\n    el.appendChild(container);\r\n\r\n    // Pagination container\r\n    var pagination = document.createElement('div');\r\n    pagination.className = 'jtemplate-pagination';\r\n\r\n    // Search DOM elements\r\n    var searchContainer = document.createElement('div');\r\n    searchContainer.className = 'jtemplate-results';\r\n    obj.searchInput = document.createElement('input');\r\n    obj.searchInput.onkeyup = function(e) {\r\n        // Clear current trigger\r\n        if (searchTimer) {\r\n            clearTimeout(searchTimer);\r\n        }\r\n        // Prepare search\r\n        searchTimer = setTimeout(function() {\r\n            obj.search(obj.searchInput.value.toLowerCase());\r\n            searchTimer = null;\r\n        }, 300)\r\n    }\r\n    searchContainer.appendChild(obj.searchInput);\r\n\r\n    // Set the options\r\n    obj.setOptions(options);\r\n\r\n    // Keep the reference in the DOM container\r\n    el.template = obj;\r\n\r\n    // Render data\r\n    obj.render(0, true);\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.timeline = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Two digits\r\n    var two = function(value) {\r\n        value = '' + value;\r\n        if (value.length == 1) {\r\n            value = '0' + value;\r\n        }\r\n        return value;\r\n    }\r\n\r\n    // Default date format\r\n    if (! options.date) {\r\n        var date = new Date();\r\n        var y = date.getFullYear();\r\n        var m = two(date.getMonth() + 1);\r\n        date = y + '-' + m;\r\n    }\r\n\r\n    // Default configurations\r\n    var defaults = {\r\n        url: null,  \r\n        data: [],\r\n        date: date,\r\n        months: [ 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec' ],\r\n        monthsFull: [ 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December' ],\r\n        onaction: null,\r\n        text: {\r\n            noInformation: '<div class=\"jtimeline-message\">No information for this period</div>',\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Add class\r\n    el.classList.add('jtimeline');\r\n\r\n    obj.options.container = el;\r\n\r\n    // Header\r\n    var timelineHeader = document.createElement('div');\r\n    timelineHeader.className = 'jtimeline-header';\r\n\r\n    var timelineLabel = document.createElement('div');\r\n    timelineLabel.className = 'jtimeline-label';\r\n\r\n    var timelineNavigation = document.createElement('div');\r\n    timelineNavigation.className = 'jtimeline-navigation';\r\n\r\n    // Labels \r\n    var timelineMonth = document.createElement('div');\r\n    timelineMonth.className = 'jtimeline-month';\r\n    timelineMonth.innerHTML = '';\r\n    timelineLabel.appendChild(timelineMonth);\r\n\r\n    var timelineYear = document.createElement('div');\r\n    timelineYear.className = 'jtimeline-year';\r\n    timelineYear.innerHTML = '';\r\n    timelineLabel.appendChild(timelineYear);\r\n\r\n    // Navigation\r\n    var timelinePrev = document.createElement('div');\r\n    timelinePrev.className = 'jtimeline-prev';\r\n    timelinePrev.innerHTML = '<i class=\"material-icons\">keyboard_arrow_left</i>';\r\n    timelineNavigation.appendChild(timelinePrev);\r\n\r\n    var timelineNext = document.createElement('div');\r\n    timelineNext.className = 'jtimeline-next';\r\n    timelineNext.innerHTML = '<i class=\"material-icons\">keyboard_arrow_right</i>';\r\n    timelineNavigation.appendChild(timelineNext);\r\n\r\n    timelineHeader.appendChild(timelineLabel);\r\n    timelineHeader.appendChild(timelineNavigation);\r\n\r\n    // Data container\r\n    var timelineContainer = document.createElement('div');\r\n    timelineContainer.className = 'jtimeline-container';\r\n\r\n    // Append headers\r\n    el.appendChild(timelineHeader);\r\n    el.appendChild(timelineContainer);\r\n\r\n    // Date\r\n    if (obj.options.date.length > 7) {\r\n        obj.options.date = obj.options.date.substr(0, 7)\r\n    }\r\n\r\n    // Action\r\n    var action = function(o) {\r\n        // Get item\r\n        var item = o.parentNode.parentNode.parentNode.parentNode;\r\n        // Get id\r\n        var id = item.getAttribute('data-id');\r\n\r\n    }\r\n\r\n    // Get item by date \r\n    var getEventByDate = function(date) {\r\n        return obj.options.data.filter(function(evt) {\r\n            return (evt.date.length > 7 ? evt.date.substr(0,7) : evt.date) == date;\r\n        });\r\n    }\r\n\r\n    obj.setData = function(rows) {\r\n        obj.options.data = rows;\r\n        obj.render(obj.options.date);\r\n    }\r\n\r\n    obj.add = function(data) {\r\n        var date = data.date.substr(0,7);\r\n\r\n        // Format date\r\n        data.date = data.date.substr(0,10);\r\n\r\n        // Append data\r\n        obj.options.data.push(data);\r\n\r\n        // Reorder\r\n        obj.options.data[obj.options.data.indexOf(data)] = data.order();\r\n\r\n        // Render\r\n        obj.render(date);\r\n    }\r\n\r\n    obj.remove = function(item) {\r\n        var index = item.getAttribute('data-index');\r\n        var date = item.getAttribute('data-date');\r\n\r\n        jSuites.animation.fadeOut(item, function() {\r\n            item.remove();\r\n        });\r\n\r\n        var data = getEventByDate(date)[0];\r\n        data.splice(index, 1);\r\n    }\r\n\r\n    obj.reload = function() {\r\n        var date = obj.options.date\r\n        obj.render(date);\r\n    }\r\n\r\n    obj.render = function(date) {\r\n        // Filter\r\n        if (date.length > 7) {\r\n            var date = date.substr(0,7);\r\n        }\r\n\r\n        // Update current date\r\n        obj.options.date = date;\r\n\r\n        // Reset data\r\n        timelineContainer.innerHTML = '';\r\n\r\n        // Days\r\n        var timelineDays = [];\r\n        var events = getEventByDate(date);\r\n\r\n        // Itens\r\n        if (! events.length) {\r\n            timelineContainer.innerHTML = obj.options.text.noInformation;\r\n        } else {\r\n            for (var i = 0; i < events.length; i++) {\r\n                var v = events[i];\r\n                var d = v.date.length > 10 ? v.date.substr(0,10).split('-') : v.date.split('-');\r\n\r\n                // Item container\r\n                var timelineItem = document.createElement('div');\r\n                timelineItem.className = 'jtimeline-item';\r\n                timelineItem.setAttribute('data-id', v.id);\r\n                timelineItem.setAttribute('data-index', i);\r\n                timelineItem.setAttribute('data-date', date);\r\n\r\n                // Date\r\n                var timelineDateContainer = document.createElement('div');\r\n                timelineDateContainer.className = 'jtimeline-date-container';\r\n\r\n                var timelineDate = document.createElement('div');\r\n                if (! timelineDays[d[2]]) {\r\n                    timelineDate.className = 'jtimeline-date jtimeline-date-bullet';\r\n                    timelineDate.innerHTML = d[2];\r\n                } else {\r\n                    timelineDate.className = 'jtimeline-date';\r\n                    timelineDate.innerHTML = '';\r\n                }\r\n                timelineDateContainer.appendChild(timelineDate);\r\n\r\n                var timelineContent = document.createElement('div');\r\n                timelineContent.className = 'jtimeline-content';\r\n\r\n                // Title\r\n                if (! v.title) {\r\n                    v.title = v.subtitle ? v.subtitle : 'Information';\r\n                }\r\n\r\n                var timelineTitleContainer = document.createElement('div');\r\n                timelineTitleContainer.className = 'jtimeline-title-container';\r\n                timelineContent.appendChild(timelineTitleContainer);\r\n\r\n                var timelineTitle = document.createElement('div');\r\n                timelineTitle.className = 'jtimeline-title';\r\n                timelineTitle.innerHTML = v.title;\r\n                timelineTitleContainer.appendChild(timelineTitle);\r\n\r\n                var timelineControls = document.createElement('div');\r\n                timelineControls.className = 'jtimeline-controls';\r\n                timelineTitleContainer.appendChild(timelineControls);\r\n\r\n                var timelineEdit = document.createElement('i');\r\n                timelineEdit.className = 'material-icons timeline-edit';\r\n                timelineEdit.innerHTML = 'edit';\r\n                timelineEdit.id = v.id;\r\n                timelineEdit.onclick = function() {\r\n                    if (typeof(obj.options.onaction) == 'function') {\r\n                        obj.options.onaction(obj, this, this.id);\r\n                    }\r\n                }\r\n                if (v.author == 1) {\r\n                    timelineControls.appendChild(timelineEdit);\r\n                }\r\n\r\n                var timelineSubtitle = document.createElement('div');\r\n                timelineSubtitle.className = 'jtimeline-subtitle';\r\n                timelineSubtitle.innerHTML = v.subtitle ? v.subtitle : '';\r\n                timelineContent.appendChild(timelineSubtitle);\r\n\r\n                // Text\r\n                var timelineText = document.createElement('div');\r\n                timelineText.className = 'jtimeline-text';\r\n                timelineText.innerHTML = v.text;\r\n                timelineContent.appendChild(timelineText);\r\n\r\n                // Tag\r\n                var timelineTags = document.createElement('div');\r\n                timelineTags.className = 'jtimeline-tags';\r\n                timelineContent.appendChild(timelineTags);\r\n\r\n                if (v.tags) {\r\n                    var createTag = function(name, color) {\r\n                        var timelineTag = document.createElement('div');\r\n                        timelineTag.className = 'jtimeline-tag';\r\n                        timelineTag.innerHTML = name;\r\n                        if (color) {\r\n                            timelineTag.style.backgroundColor = color;\r\n                        }\r\n                        return timelineTag; \r\n                    }\r\n\r\n                    if (typeof(v.tags) == 'string') {\r\n                        var t = createTag(v.tags);\r\n                        timelineTags.appendChild(t);\r\n                    } else {\r\n                        for (var j = 0; j < v.tags.length; j++) {\r\n                            var t = createTag(v.tags[j].text, v.tags[j].color);\r\n                            timelineTags.appendChild(t);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Day\r\n                timelineDays[d[2]] = true;\r\n\r\n                // Append Item\r\n                timelineItem.appendChild(timelineDateContainer);\r\n                timelineItem.appendChild(timelineContent);\r\n                timelineContainer.appendChild(timelineItem);\r\n            };\r\n        }\r\n\r\n        // Update labels\r\n        var d = date.split('-');\r\n        timelineYear.innerHTML = d[0];\r\n        timelineMonth.innerHTML = obj.options.monthsFull[parseInt(d[1]) - 1];\r\n    }\r\n\r\n    obj.next = function() {\r\n        // Update current date\r\n        var d = obj.options.date.split('-');\r\n        // Next month\r\n        d[1]++;\r\n        // Next year\r\n        if (d[1] > 12) {\r\n            d[0]++;\r\n            d[1] = 1;\r\n        }\r\n        date = d[0] + '-' + (d[1] < 10 ? '0' + d[1] : d[1]);\r\n\r\n        // Animation\r\n        jSuites.animation.slideLeft(timelineContainer, 0, function() {\r\n            obj.render(date);\r\n            jSuites.animation.slideRight(timelineContainer, 1);\r\n        });\r\n    }\r\n\r\n    obj.prev = function() {\r\n        // Update current date\r\n        var d = obj.options.date.split('-');\r\n        // Next month\r\n        d[1]--;\r\n        // Next year\r\n        if (d[1] < 1) {\r\n            d[0]--;\r\n            d[1] = 12;\r\n        }\r\n        date = d[0] + '-' + (d[1] < 10 ? '0' + d[1] : d[1]);\r\n\r\n        // Animation\r\n        jSuites.animation.slideRight(timelineContainer, 0, function() {\r\n            obj.render(date);\r\n            jSuites.animation.slideLeft(timelineContainer, 1);\r\n        });\r\n    }\r\n\r\n    obj.load = function() {\r\n        // Init\r\n        if (obj.options.url) {\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                type: 'GET',\r\n                dataType:'json',\r\n                success: function(data) {\r\n                    // Timeline data\r\n                    obj.setData(data);\r\n                }\r\n            });\r\n        } else {\r\n            // Timeline data\r\n            obj.setData(obj.options.data);\r\n        }\r\n    }\r\n\r\n    obj.reload = function() {\r\n        obj.load();\r\n    }\r\n\r\n    obj.load();\r\n\r\n    var timelineMouseUpControls = function(e) {\r\n        if (e.target.classList.contains('jtimeline-next') || e.target.parentNode.classList.contains('jtimeline-next')) {\r\n            obj.next();\r\n        } else if (e.target.classList.contains('jtimeline-prev') || e.target.parentNode.classList.contains('jtimeline-prev')) {\r\n            obj.prev();\r\n        }\r\n    }\r\n\r\n    if ('ontouchend' in document.documentElement === true) {\r\n        el.addEventListener(\"touchend\", timelineMouseUpControls);\r\n    } else {\r\n        el.addEventListener(\"mouseup\", timelineMouseUpControls);\r\n    }\r\n\r\n    // Add global events\r\n    el.addEventListener(\"swipeleft\", function(e) {\r\n        obj.next();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    el.addEventListener(\"swiperight\", function(e) {\r\n        obj.prev();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    // Orderby\r\n    Array.prototype.order = function() {\r\n        return this.slice(0).sort(function(a, b) {\r\n            var valueA = a.date;\r\n            var valueB = b.date;\r\n\r\n            return (valueA > valueB) ? 1 : (valueA < valueB) ? -1 : 0;\r\n        });\r\n    }\r\n\r\n    el.timeline = obj;\r\n\r\n    return obj;\r\n});\r\n", "{\r\n    \"name\": \"jsuites\",\r\n    \"title\": \"A collection of common JavaScript plugins & web components\",\r\n    \"description\": \"jSuites is a collection of lightweight common required javascript plugins and web components. It is composed of fully responsive vanilla plugins to help you bring the best user experience to your projects, independent of the platform.\",\r\n    \"repository\": {\r\n        \"type\": \"git\",\r\n        \"url\": \"https://github.com/jsuites/jsuites.git\"\r\n    },\r\n    \"author\": {\r\n        \"name\": \"jSuites <contact@jsuites.net>\"\r\n    },\r\n    \"licenses\": [\r\n        {\r\n            \"type\": \"MIT\",\r\n            \"url\": \"https://github.com/jsuites/jsuites/blob/master/LICENSE\"\r\n        }\r\n    ],\r\n    \"keywords\": [\r\n        \"javascript plugins\"\r\n    ],\r\n    \"main\": \"dist/jsuites.js\",\r\n    \"version\": \"4.9.10\",\r\n    \"bugs\": \"https://github.com/jsuites/jsuites/issues\",\r\n    \"homepage\": \"https://github.com/jsuites/jsuites\",\r\n    \"docs\": \"https://jsuites.net\",\r\n    \"download\": \"https://github.com/jsuites/jsuites/archive/master.zip\"\r\n}\r\n", "jSuites.editor = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        // Initial HTML content\r\n        value: null,\r\n        // Initial snippet\r\n        snippet: null,\r\n        // Add toolbar\r\n        toolbar: null,\r\n        // Website parser is to read websites and images from cross domain\r\n        remoteParser: null,\r\n        // Placeholder\r\n        placeholder: null,\r\n        // Parse URL\r\n        parseURL: false,\r\n        filterPaste: true,\r\n        // Accept drop files\r\n        dropZone: false,\r\n        dropAsSnippet: false,\r\n        acceptImages: false,\r\n        acceptFiles: false,\r\n        maxFileSize: 5000000,\r\n        allowImageResize: true,\r\n        // Style\r\n        border: true,\r\n        padding: true,\r\n        maxHeight: null,\r\n        height: null,\r\n        focus: false,\r\n        // Events\r\n        onclick: null,\r\n        onfocus: null,\r\n        onblur: null,\r\n        onload: null,\r\n        onkeyup: null,\r\n        onkeydown: null,\r\n        onchange: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Private controllers\r\n    var imageResize = 0;\r\n    var editorTimer = null;\r\n    var editorAction = null;\r\n    var files = [];\r\n\r\n    // Make sure element is empty\r\n    el.innerHTML = '';\r\n\r\n    // Keep the reference for the container\r\n    obj.el = el;\r\n\r\n    if (typeof(obj.options.onclick) == 'function') {\r\n        el.onclick = function(e) {\r\n            obj.options.onclick(el, obj, e);\r\n        }\r\n    }\r\n\r\n    // Prepare container\r\n    el.classList.add('jeditor-container');\r\n\r\n    // Padding\r\n    if (obj.options.padding == true) {\r\n        el.classList.add('jeditor-padding');\r\n    }\r\n\r\n    // Border\r\n    if (obj.options.border == false) {\r\n        el.style.border = '0px';\r\n    }\r\n\r\n    // Snippet\r\n    var snippet = document.createElement('div');\r\n    snippet.className = 'jsnippet';\r\n    snippet.setAttribute('contenteditable', false);\r\n\r\n    // Toolbar\r\n    var toolbar = document.createElement('div');\r\n    toolbar.className = 'jeditor-toolbar';\r\n\r\n    // Create editor\r\n    var editor = document.createElement('div');\r\n    editor.setAttribute('contenteditable', true);\r\n    editor.setAttribute('spellcheck', false);\r\n    editor.className = 'jeditor';\r\n\r\n    // Placeholder\r\n    if (obj.options.placeholder) {\r\n        editor.setAttribute('data-placeholder', obj.options.placeholder);\r\n    }\r\n\r\n    // Max height\r\n    if (obj.options.maxHeight || obj.options.height) {\r\n        editor.style.overflowY = 'auto';\r\n\r\n        if (obj.options.maxHeight) {\r\n            editor.style.maxHeight = obj.options.maxHeight;\r\n        }\r\n        if (obj.options.height) {\r\n            editor.style.height = obj.options.height;\r\n        }\r\n    }\r\n\r\n    // Set editor initial value\r\n    if (obj.options.value) {\r\n        var value = obj.options.value;\r\n    } else {\r\n        var value = el.innerHTML ? el.innerHTML : ''; \r\n    }\r\n\r\n    if (! value) {\r\n        var value = '';\r\n    }\r\n\r\n    /**\r\n     * Onchange event controllers\r\n     */\r\n    var change = function(e) {\r\n        if (typeof(obj.options.onchange) == 'function') { \r\n            obj.options.onchange(el, obj, e);\r\n        }\r\n\r\n        // Update value\r\n        obj.options.value = obj.getData();\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract images from a HTML string\r\n     */\r\n    var extractImageFromHtml = function(html) {\r\n        // Create temp element\r\n        var div = document.createElement('div');\r\n        div.innerHTML = html;\r\n\r\n        // Extract images\r\n        var img = div.querySelectorAll('img');\r\n\r\n        if (img.length) {\r\n            for (var i = 0; i < img.length; i++) {\r\n                obj.addImage(img[i].src);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Insert node at caret\r\n     */\r\n    var insertNodeAtCaret = function(newNode) {\r\n        var sel, range;\r\n\r\n        if (window.getSelection) {\r\n            sel = window.getSelection();\r\n            if (sel.rangeCount) {\r\n                range = sel.getRangeAt(0);\r\n                var selectedText = range.toString();\r\n                range.deleteContents();\r\n                range.insertNode(newNode); \r\n                // move the cursor after element\r\n                range.setStartAfter(newNode);\r\n                range.setEndAfter(newNode); \r\n                sel.removeAllRanges();\r\n                sel.addRange(range);\r\n            }\r\n        }\r\n    }\r\n\r\n    var updateTotalImages = function() {\r\n        var o = null;\r\n        if (o = snippet.children[0]) {\r\n            // Make sure is a grid\r\n            if (! o.classList.contains('jslider-grid')) {\r\n                o.classList.add('jslider-grid');\r\n            }\r\n            // Quantify of images\r\n            var number = o.children.length;\r\n            // Set the configuration of the grid\r\n            o.setAttribute('data-number', number > 4 ? 4 : number);\r\n            // Total of images inside the grid\r\n            if (number > 4) {\r\n                o.setAttribute('data-total', number - 4);\r\n            } else {\r\n                o.removeAttribute('data-total');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Append image to the snippet\r\n     */\r\n    var appendImage = function(image) {\r\n        if (! snippet.innerHTML) {\r\n            appendElement({});\r\n        }\r\n        snippet.children[0].appendChild(image);\r\n        updateTotalImages();\r\n    }\r\n\r\n    /**\r\n     * Append snippet\r\n     * @Param object data\r\n     */\r\n    var appendElement = function(data) {\r\n        // Reset snippet\r\n        snippet.innerHTML = '';\r\n\r\n        // Attributes\r\n        var a = [ 'image', 'title', 'description', 'host', 'url' ];\r\n\r\n        for (var i = 0; i < a.length; i++) {\r\n            var div = document.createElement('div');\r\n            div.className = 'jsnippet-' + a[i];\r\n            div.setAttribute('data-k', a[i]);\r\n            snippet.appendChild(div);\r\n            if (data[a[i]]) {\r\n                if (a[i] == 'image') {\r\n                    if (! Array.isArray(data.image)) {\r\n                        data.image = [ data.image ];\r\n                    }\r\n                    for (var j = 0; j < data.image.length; j++) {\r\n                        var img = document.createElement('img');\r\n                        img.src = data.image[j];\r\n                        div.appendChild(img);\r\n                    }\r\n                } else {\r\n                    div.innerHTML = data[a[i]];\r\n                }\r\n            }\r\n        }\r\n\r\n        editor.appendChild(document.createElement('br'));\r\n        editor.appendChild(snippet);\r\n    }\r\n\r\n    var verifyEditor = function() {\r\n        clearTimeout(editorTimer);\r\n        editorTimer = setTimeout(function() {\r\n            var snippet = editor.querySelector('.jsnippet');\r\n            if (! snippet) {\r\n                var html = editor.innerHTML.replace(/\\n/g, ' ');\r\n                var container = document.createElement('div');\r\n                container.innerHTML = html;\r\n                var text = container.innerText; \r\n                var url = jSuites.editor.detectUrl(text);\r\n\r\n                if (url) {\r\n                    if (url[0].substr(-3) == 'jpg' || url[0].substr(-3) == 'png' || url[0].substr(-3) == 'gif') {\r\n                         obj.addImage(url[0], true);\r\n                    } else {\r\n                        var id = jSuites.editor.youtubeParser(url[0]);\r\n                        obj.parseWebsite(url[0], id);\r\n                    }\r\n                }\r\n            }\r\n        }, 1000);\r\n    }\r\n\r\n    obj.parseContent = function() {\r\n        verifyEditor();\r\n    }\r\n\r\n    obj.parseWebsite = function(url, youtubeId) {\r\n        if (! obj.options.remoteParser) {\r\n            console.log('The remoteParser is not defined');\r\n        } else {\r\n            // Youtube definitions\r\n            if (youtubeId) {\r\n                var url = 'https://www.youtube.com/watch?v=' + youtubeId;\r\n            }\r\n\r\n            var p = {\r\n                title: '',\r\n                description: '',\r\n                image: '',\r\n                host: url.split('/')[2],\r\n                url: url,\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.remoteParser + encodeURI(url.trim()),\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Get title\r\n                    if (result.title) {\r\n                        p.title = result.title;\r\n                    }\r\n                    // Description\r\n                    if (result.description) {\r\n                        p.description = result.description;\r\n                    }\r\n                    // Host\r\n                    if (result.host) {\r\n                        p.host = result.host;\r\n                    }\r\n                    // Url\r\n                    if (result.url) {\r\n                        p.url = result.url;\r\n                    }\r\n                    // Append snippet\r\n                    appendElement(p);\r\n                    // Add image\r\n                    if (result.image) {\r\n                        obj.addImage(result.image, true);\r\n                    } else if (result['og:image']) {\r\n                        obj.addImage(result['og:image'], true);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set editor value\r\n     */\r\n    obj.setData = function(html) {\r\n        editor.innerHTML = html;\r\n\r\n        if (obj.options.focus) {\r\n            jSuites.editor.setCursor(editor, true);\r\n        }\r\n\r\n        // Reset files container\r\n        files = [];\r\n    }\r\n\r\n    obj.getFiles = function() {\r\n        var f = editor.querySelectorAll('.jfile');\r\n        var d = [];\r\n        for (var i = 0; i < f.length; i++) {\r\n            if (files[f[i].src]) {\r\n                d.push(files[f[i].src]);\r\n            }\r\n        }\r\n        return d;\r\n    }\r\n\r\n    obj.getText = function() {\r\n        return editor.innerText;\r\n    }\r\n\r\n    /**\r\n     * Get editor data\r\n     */\r\n    obj.getData = function(json) {\r\n        if (! json) {\r\n            var data = editor.innerHTML;\r\n        } else {\r\n            var data = {\r\n                content : '',\r\n            }\r\n\r\n            // Get snippet\r\n            if (snippet.innerHTML) {\r\n                var index = 0;\r\n                data.snippet = {};\r\n                for (var i = 0; i < snippet.children.length; i++) {\r\n                    // Get key from element\r\n                    var key = snippet.children[i].getAttribute('data-k');\r\n                    if (key) {\r\n                        if (key == 'image') {\r\n                            if (! data.snippet.image) {\r\n                                data.snippet.image = [];\r\n                            }\r\n                            // Get all images\r\n                            for (var j = 0; j < snippet.children[i].children.length; j++) {\r\n                                data.snippet.image.push(snippet.children[i].children[j].getAttribute('src'))\r\n                            }\r\n                        } else {\r\n                            data.snippet[key] = snippet.children[i].innerHTML;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Get files\r\n            var f = Object.keys(files);\r\n            if (f.length) {\r\n                data.files = [];\r\n                for (var i = 0; i < f.length; i++) {\r\n                    data.files.push(files[f[i]]);\r\n                }\r\n            }\r\n\r\n            // Get content\r\n            var text = editor.innerHTML;\r\n            text = text.replace(/<br>/g, \"\\n\");\r\n            text = text.replace(/<\\/div>/g, \"<\\/div>\\n\");\r\n            text = text.replace(/<(?:.|\\n)*?>/gm, \"\");\r\n            data.content = text.trim();\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    // Reset\r\n    obj.reset = function() {\r\n        editor.innerHTML = '';\r\n        snippet.innerHTML = '';\r\n        files = [];\r\n    }\r\n\r\n    obj.addPdf = function(data) {\r\n        if (data.result.substr(0,4) != 'data') {\r\n            console.error('Invalid source');\r\n        } else {\r\n            var canvas = document.createElement('canvas');\r\n            canvas.width = 60;\r\n            canvas.height = 60;\r\n\r\n            var img = new Image();\r\n            var ctx = canvas.getContext('2d');\r\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n            canvas.toBlob(function(blob) {\r\n                var newImage = document.createElement('img');\r\n                newImage.src = window.URL.createObjectURL(blob);\r\n                newImage.title = data.name;\r\n                newImage.className = 'jfile pdf';\r\n\r\n                files[newImage.src] = {\r\n                    file: newImage.src,\r\n                    extension: 'pdf',\r\n                    content: data.result,\r\n                }\r\n\r\n                insertNodeAtCaret(newImage);\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.addImage = function(src, asSnippet) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                extension = extension[1];\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n            }\r\n\r\n            var img = new Image();\r\n\r\n            img.onload = function onload() {\r\n                var canvas = document.createElement('canvas');\r\n                canvas.width = img.width;\r\n                canvas.height = img.height;\r\n\r\n                var ctx = canvas.getContext('2d');\r\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                canvas.toBlob(function(blob) {\r\n                    var newImage = document.createElement('img');\r\n                    newImage.src = window.URL.createObjectURL(blob);\r\n                    newImage.classList.add('jfile');\r\n                    newImage.setAttribute('tabindex', '900');\r\n                    files[newImage.src] = {\r\n                        file: newImage.src,\r\n                        extension: extension,\r\n                        content: canvas.toDataURL(),\r\n                    }\r\n\r\n                    if (obj.options.dropAsSnippet || asSnippet) {\r\n                        appendImage(newImage);\r\n                        // Just to understand the attachment is part of a snippet\r\n                        files[newImage.src].snippet = true;\r\n                    } else {\r\n                        insertNodeAtCaret(newImage);\r\n                    }\r\n\r\n                    change();\r\n                });\r\n            };\r\n\r\n            img.src = src;\r\n        }\r\n    }\r\n\r\n    obj.addFile = function(files) {\r\n        var reader = [];\r\n\r\n        for (var i = 0; i < files.length; i++) {\r\n            if (files[i].size > obj.options.maxFileSize) {\r\n                alert('The file is too big');\r\n            } else {\r\n                // Only PDF or Images\r\n                var type = files[i].type.split('/');\r\n\r\n                if (type[0] == 'image') {\r\n                    type = 1;\r\n                } else if (type[1] == 'pdf') {\r\n                    type = 2;\r\n                } else {\r\n                    type = 0;\r\n                }\r\n\r\n                if (type) {\r\n                    // Create file\r\n                    reader[i] = new FileReader();\r\n                    reader[i].index = i;\r\n                    reader[i].type = type;\r\n                    reader[i].name = files[i].name;\r\n                    reader[i].date = files[i].lastModified;\r\n                    reader[i].size = files[i].size;\r\n                    reader[i].addEventListener(\"load\", function (data) {\r\n                        // Get result\r\n                        if (data.target.type == 2) {\r\n                            if (obj.options.acceptFiles == true) {\r\n                                obj.addPdf(data.target);\r\n                            }\r\n                        } else {\r\n                            obj.addImage(data.target.result);\r\n                        }\r\n                    }, false);\r\n\r\n                    reader[i].readAsDataURL(files[i])\r\n                } else {\r\n                    alert('The extension is not allowed');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Destroy\r\n    obj.destroy = function() {\r\n        editor.removeEventListener('mouseup', editorMouseUp);\r\n        editor.removeEventListener('mousedown', editorMouseDown);\r\n        editor.removeEventListener('mousemove', editorMouseMove);\r\n        editor.removeEventListener('keyup', editorKeyUp);\r\n        editor.removeEventListener('keydown', editorKeyDown);\r\n        editor.removeEventListener('dragstart', editorDragStart);\r\n        editor.removeEventListener('dragenter', editorDragEnter);\r\n        editor.removeEventListener('dragover', editorDragOver);\r\n        editor.removeEventListener('drop', editorDrop);\r\n        editor.removeEventListener('paste', editorPaste);\r\n\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            editor.removeEventListener('blur', editorBlur);\r\n        }\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            editor.removeEventListener('focus', editorFocus);\r\n        }\r\n\r\n        el.editor = null;\r\n        el.classList.remove('jeditor-container');\r\n\r\n        toolbar.remove();\r\n        snippet.remove();\r\n        editor.remove();\r\n    }\r\n\r\n    var isLetter = function (str) {\r\n        var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]+)/g;\r\n        return str.match(regex) ? 1 : 0;\r\n    }\r\n\r\n    // Event handlers\r\n    var editorMouseUp = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            editorAction.e.classList.remove('resizing');\r\n        }\r\n\r\n        editorAction = false;\r\n    }\r\n\r\n    var editorMouseDown = function(e) {\r\n        var close = function(snippet) {\r\n            var rect = snippet.getBoundingClientRect();\r\n            if (rect.width - (e.clientX - rect.left) < 40 && e.clientY - rect.top < 40) {\r\n                snippet.innerHTML = '';\r\n                snippet.remove();\r\n            }\r\n        }\r\n\r\n        if (e.target.tagName == 'IMG') {\r\n            if (e.target.style.cursor) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                editorAction = {\r\n                    e: e.target,\r\n                    x: e.clientX,\r\n                    y: e.clientY,\r\n                    w: rect.width,\r\n                    h: rect.height,\r\n                    d: e.target.style.cursor,\r\n                }\r\n\r\n                if (! e.target.width) {\r\n                    e.target.width = rect.width + 'px';\r\n                }\r\n\r\n                if (! e.target.height) {\r\n                    e.target.height = rect.height + 'px';\r\n                }\r\n\r\n                var s = window.getSelection();\r\n                if (s.rangeCount) {\r\n                    for (var i = 0; i < s.rangeCount; i++) {\r\n                        s.removeRange(s.getRangeAt(i));\r\n                    }\r\n                }\r\n\r\n                e.target.classList.add('resizing');\r\n            } else {\r\n                editorAction = true;\r\n            }\r\n        } else { \r\n            if (e.target.classList.contains('jsnippet')) {\r\n                close(e.target);\r\n            } else if (e.target.parentNode.classList.contains('jsnippet')) {\r\n                close(e.target.parentNode);\r\n            }\r\n\r\n            editorAction = true;\r\n        }\r\n    }\r\n\r\n    var editorMouseMove = function(e) {\r\n        if (e.target.tagName == 'IMG' && ! e.target.parentNode.classList.contains('jsnippet-image') && obj.options.allowImageResize == true) {\r\n            if (e.target.getAttribute('tabindex')) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                if (e.clientY - rect.top < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'ne-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'nw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 'n-resize';\r\n                    }\r\n                } else if (rect.height - (e.clientY - rect.top) < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'se-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'sw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 's-resize';\r\n                    }\r\n                } else if (rect.width - (e.clientX - rect.left) < 5) {\r\n                    e.target.style.cursor = 'e-resize';\r\n                } else if (e.clientX - rect.left < 5) {\r\n                    e.target.style.cursor = 'w-resize';\r\n                } else {\r\n                    e.target.style.cursor = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Move\r\n        if (e.which == 1 && editorAction && editorAction.d) {\r\n            if (editorAction.d == 'e-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'se-resize') {\r\n                editorAction.e.width = (editorAction.w + (e.clientX - editorAction.x));\r\n\r\n                if (e.shiftKey) {\r\n                    var newHeight = (e.clientX - editorAction.x) * (editorAction.h / editorAction.w);\r\n                    editorAction.e.height = editorAction.h + newHeight;\r\n                } else {\r\n                    var newHeight =  null;\r\n                }\r\n            }\r\n\r\n            if (! newHeight) {\r\n                if (editorAction.d == 's-resize' || editorAction.d == 'se-resize' || editorAction.d == 'sw-resize') {\r\n                    if (! e.shiftKey) {\r\n                        editorAction.e.height = editorAction.h + (e.clientY - editorAction.y);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    var editorKeyUp = function(e) {\r\n        if (! editor.innerHTML) {\r\n            editor.innerHTML = '<div><br></div>';\r\n        }\r\n\r\n        if (typeof(obj.options.onkeyup) == 'function') { \r\n            obj.options.onkeyup(el, obj, e);\r\n        }\r\n    }\r\n\r\n\r\n    var editorKeyDown = function(e) {\r\n        // Check for URL\r\n        if (obj.options.parseURL == true) {\r\n            verifyEditor();\r\n        }\r\n\r\n        if (typeof(obj.options.onkeydown) == 'function') { \r\n            obj.options.onkeydown(el, obj, e);\r\n        }\r\n\r\n        if (e.key == 'Delete') {\r\n            if (e.target.tagName == 'IMG' && e.target.parentNode.classList.contains('jsnippet-image')) {\r\n                e.target.remove();\r\n                updateTotalImages();\r\n            }\r\n        }\r\n    }\r\n\r\n    // Elements to be removed\r\n    var remove = [HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement];\r\n\r\n    // Valid CSS attributes\r\n    var validStyle = ['color', 'font-weight', 'font-size', 'background', 'background-color', 'margin'];\r\n\r\n    var parse = function(element) {\r\n       // Remove attributes\r\n       if (element.attributes && element.attributes.length) {\r\n           var image = null;\r\n           var style = null;\r\n           // Process style attribute\r\n           var elementStyle = element.getAttribute('style');\r\n           if (elementStyle) {\r\n               style = [];\r\n               var t = elementStyle.split(';');\r\n               for (var j = 0; j < t.length; j++) {\r\n                   var v = t[j].trim().split(':');\r\n                   if (validStyle.indexOf(v[0].trim()) >= 0) {\r\n                       var k = v.shift();\r\n                       var v = v.join(':');\r\n                       style.push(k + ':' + v);\r\n                   }\r\n               }\r\n           }\r\n           // Process image\r\n           if (element.tagName.toUpperCase() == 'IMG') {\r\n               if (! obj.options.acceptImages) {\r\n                   element.parentNode.removeChild(element);\r\n               } else {\r\n                   // Check if is data\r\n                   element.setAttribute('tabindex', '900');\r\n                   // Check attributes for persistance\r\n                   obj.addImage(element.src);\r\n               }\r\n           } else {\r\n               // Remove attributes\r\n               var numAttributes = element.attributes.length - 1;\r\n               for (var i = numAttributes; i >= 0 ; i--) {\r\n                   element.removeAttribute(element.attributes[i].name);\r\n               }\r\n           }\r\n           element.style = '';\r\n           // Add valid style\r\n           if (style && style.length) {\r\n               element.setAttribute('style', style.join(';'));\r\n           }\r\n       }\r\n       // Parse children\r\n       if (element.children.length) {\r\n           for (var i = 0; i < element.children.length; i++) {\r\n               parse(element.children[i]);\r\n           }\r\n       }\r\n\r\n       if (remove.indexOf(element.constructor) >= 0) {\r\n           element.remove();\r\n       }\r\n    }\r\n\r\n    var filter = function(data) {\r\n        if (data) {\r\n            data = data.replace(new RegExp('<!--(.*?)-->', 'gsi'), '');\r\n        }\r\n        var parser = new DOMParser();\r\n        var d = parser.parseFromString(data, \"text/html\");\r\n        parse(d);\r\n        var span = document.createElement('span');\r\n        span.innerHTML = d.firstChild.innerHTML;\r\n        return span;\r\n    } \r\n\r\n    var editorPaste = function(e) {\r\n        if (obj.options.filterPaste == true) {\r\n            if (e.clipboardData || e.originalEvent.clipboardData) {\r\n                var html = (e.originalEvent || e).clipboardData.getData('text/html');\r\n                var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n                var file = (e.originalEvent || e).clipboardData.files\r\n            } else if (window.clipboardData) {\r\n                var html = window.clipboardData.getData('Html');\r\n                var text = window.clipboardData.getData('Text');\r\n                var file = window.clipboardData.files\r\n            }\r\n\r\n            if (file.length) {\r\n                // Paste a image from the clipboard\r\n                obj.addFile(file);\r\n            } else {\r\n                if (! html) {\r\n                    html = text.split('\\r\\n');\r\n                    if (! e.target.innerText) {\r\n                        html.map(function(v) {\r\n                            var d = document.createElement('div');\r\n                            d.innerText = v;\r\n                            editor.appendChild(d);\r\n                        });\r\n                    } else {\r\n                        html = html.map(function(v) {\r\n                            return '<div>' + v + '</div>';\r\n                        });\r\n                        document.execCommand('insertHtml', false, html.join(''));\r\n                    }\r\n                } else {\r\n                    var d = filter(html);\r\n                    // Paste to the editor\r\n                    insertNodeAtCaret(d);\r\n                }\r\n            }\r\n\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragStart = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragEnter = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            el.classList.add('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragOver = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            if (editorTimer) {\r\n                clearTimeout(editorTimer);\r\n            }\r\n\r\n            editorTimer = setTimeout(function() {\r\n                el.classList.remove('jeditor-dragging');\r\n            }, 100);\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDrop = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            // Position caret on the drop\r\n            var range = null;\r\n            if (document.caretRangeFromPoint) {\r\n                range=document.caretRangeFromPoint(e.clientX, e.clientY);\r\n            } else if (e.rangeParent) {\r\n                range=document.createRange();\r\n                range.setStart(e.rangeParent,e.rangeOffset);\r\n            }\r\n            var sel = window.getSelection();\r\n            sel.removeAllRanges();\r\n            sel.addRange(range);\r\n            sel.anchorNode.parentNode.focus();\r\n\r\n            var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n            var text = (e.originalEvent || e).dataTransfer.getData('text/plain');\r\n            var file = (e.originalEvent || e).dataTransfer.files;\r\n    \r\n            if (file.length) {\r\n                obj.addFile(file);\r\n            } else if (text) {\r\n                extractImageFromHtml(html);\r\n            }\r\n\r\n            el.classList.remove('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorBlur = function(e) {\r\n        // Blur\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            obj.options.onblur(el, obj, e);\r\n        }\r\n\r\n        change(e);\r\n    }\r\n\r\n    var editorFocus = function(e) {\r\n        // Focus\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            obj.options.onfocus(el, obj, e);\r\n        }\r\n    }\r\n\r\n    editor.addEventListener('mouseup', editorMouseUp);\r\n    editor.addEventListener('mousedown', editorMouseDown);\r\n    editor.addEventListener('mousemove', editorMouseMove);\r\n    editor.addEventListener('keyup', editorKeyUp);\r\n    editor.addEventListener('keydown', editorKeyDown);\r\n    editor.addEventListener('dragstart', editorDragStart);\r\n    editor.addEventListener('dragenter', editorDragEnter);\r\n    editor.addEventListener('dragover', editorDragOver);\r\n    editor.addEventListener('drop', editorDrop);\r\n    editor.addEventListener('paste', editorPaste);\r\n    editor.addEventListener('focus', editorFocus);\r\n    editor.addEventListener('blur', editorBlur);\r\n\r\n    // Onload\r\n    if (typeof(obj.options.onload) == 'function') {\r\n        obj.options.onload(el, obj, editor);\r\n    }\r\n\r\n    // Set value to the editor\r\n    editor.innerHTML = value;\r\n\r\n    // Append editor to the containre\r\n    el.appendChild(editor);\r\n\r\n    // Snippet\r\n    if (obj.options.snippet) {\r\n        appendElement(obj.options.snippet);\r\n    }\r\n\r\n    // Default toolbar\r\n    if (obj.options.toolbar == null) {\r\n        obj.options.toolbar = jSuites.editor.getDefaultToolbar();\r\n    }\r\n\r\n    // Add toolbar\r\n    if (obj.options.toolbar) {\r\n        // Append to the DOM\r\n        el.appendChild(toolbar);\r\n        // Create toolbar\r\n        jSuites.toolbar(toolbar, {\r\n            container: true,\r\n            responsive: true,\r\n            items: obj.options.toolbar\r\n        });\r\n    }\r\n\r\n    // Focus to the editor\r\n    if (obj.options.focus) {\r\n        jSuites.editor.setCursor(editor, obj.options.focus == 'initial' ? true : false);\r\n    }\r\n\r\n    // Change method\r\n    el.change = obj.setData;\r\n\r\n    // Global generic value handler\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            // Data type\r\n            var o = el.getAttribute('data-html') === 'true' ? false : true;\r\n            return obj.getData(o);\r\n        } else {\r\n            obj.setData(val);\r\n        }\r\n    }\r\n\r\n    el.editor = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.editor.setCursor = function(element, first) {\r\n    element.focus();\r\n    document.execCommand('selectAll');\r\n    var sel = window.getSelection();\r\n    var range = sel.getRangeAt(0);\r\n    if (first == true) {\r\n        var node = range.startContainer;\r\n        var size = 0;\r\n    } else {\r\n        var node = range.endContainer;\r\n        var size = node.length;\r\n    }\r\n    range.setStart(node, size);\r\n    range.setEnd(node, size);\r\n    sel.removeAllRanges();\r\n    sel.addRange(range);\r\n}\r\n\r\njSuites.editor.getDomain = function(url) {\r\n    return url.replace('http://','').replace('https://','').replace('www.','').split(/[/?#]/)[0].split(/:/g)[0];\r\n}\r\n\r\njSuites.editor.detectUrl = function(text) {\r\n    var expression = /(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig;\r\n    var links = text.match(expression);\r\n\r\n    if (links) {\r\n        if (links[0].substr(0,3) == 'www') {\r\n            links[0] = 'http://' + links[0];\r\n        }\r\n    }\r\n\r\n    return links;\r\n}\r\n\r\njSuites.editor.youtubeParser = function(url) {\r\n    var regExp = /^.*((youtu.be\\/)|(v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#\\&\\?]*).*/;\r\n    var match = url.match(regExp);\r\n\r\n    return (match && match[7].length == 11) ? match[7] : false;\r\n}\r\n\r\njSuites.editor.getDefaultToolbar = function() { \r\n    return [\r\n        {\r\n            content: 'undo',\r\n            onclick: function() {\r\n                document.execCommand('undo');\r\n            }\r\n        },\r\n        {\r\n            content: 'redo',\r\n            onclick: function() {\r\n                document.execCommand('redo');\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_bold',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('bold');\r\n\r\n                if (document.queryCommandState(\"bold\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_italic',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('italic');\r\n\r\n                if (document.queryCommandState(\"italic\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_underline',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('underline');\r\n\r\n                if (document.queryCommandState(\"underline\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_list_bulleted',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_list_numbered',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertOrderedList');\r\n\r\n                if (document.queryCommandState(\"insertOrderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_increase',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('indent', true, null);\r\n\r\n                if (document.queryCommandState(\"indent\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_decrease',\r\n            onclick: function() {\r\n                document.execCommand('outdent');\r\n\r\n                if (document.queryCommandState(\"outdent\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }/*,\r\n        {\r\n            icon: ['format_align_left', 'format_align_right', 'format_align_center'],\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }\r\n        {\r\n            type:'select',\r\n            items: ['Verdana','Arial','Courier New'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            type:'select',\r\n            items: ['10px','12px','14px','16px','18px','20px','22px'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_left',\r\n            onclick: function() {\r\n                document.execCommand('JustifyLeft');\r\n\r\n                if (document.queryCommandState(\"JustifyLeft\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_center',\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_right',\r\n            onclick: function() {\r\n                document.execCommand('justifyRight');\r\n\r\n                if (document.queryCommandState(\"justifyRight\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_justify',\r\n            onclick: function() {\r\n                document.execCommand('justifyFull');\r\n\r\n                if (document.queryCommandState(\"justifyFull\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_list_bulleted',\r\n            onclick: function() {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }*/\r\n    ];\r\n}\r\n"], "fixing_code": ["/**\r\n * (c) jSuites Javascript Web Components\r\n *\r\n * Website: https://jsuites.net\r\n * Description: Create amazing web based applications.\r\n *\r\n * MIT License\r\n *\r\n */\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jSuites = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\nvar jSuites = function(options) {\r\n    var obj = {}\r\n    var version = '4.9.11';\r\n\r\n    var find = function(DOMElement, component) {\r\n        if (DOMElement[component.type] && DOMElement[component.type] == component) {\r\n            return true;\r\n        }\r\n        if (DOMElement.parentNode) {\r\n            return find(DOMElement.parentNode, component);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    var isOpened = function(e) {\r\n        if (jSuites.current.length > 0) {\r\n            for (var i = 0; i < jSuites.current.length; i++) {\r\n                if (jSuites.current[i] && ! find(e.target, jSuites.current[i])) {\r\n                    jSuites.current[i].close();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.init = function() {\r\n        document.addEventListener(\"click\", isOpened);\r\n\r\n        obj.version = version;\r\n    }\r\n\r\n    obj.tracking = function(component, state) {\r\n        if (state == true) {\r\n            jSuites.current = jSuites.current.filter(function(v) {\r\n                return v !== null;\r\n            });\r\n\r\n            // Start after all events\r\n            setTimeout(function() {\r\n                jSuites.current.push(component);\r\n            }, 0);\r\n\r\n        } else {\r\n            var index = jSuites.current.indexOf(component);\r\n            if (index >= 0) {\r\n                jSuites.current[index] = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get or set a property from a JSON from a string.\r\n     */\r\n    obj.path = function(str, val) {\r\n        str = str.split('.');\r\n        if (str.length) {\r\n            var o = this;\r\n            var p = null;\r\n            while (str.length > 1) {\r\n                // Get the property\r\n                p = str.shift();\r\n                // Check if the property exists\r\n                if (o.hasOwnProperty(p)) {\r\n                    o = o[p];\r\n                } else {\r\n                    // Property does not exists\r\n                    if (val === undefined) {\r\n                        return undefined;\r\n                    } else {\r\n                        // Create the property\r\n                        o[p] = {};\r\n                        // Next property\r\n                        o = o[p];\r\n                    }\r\n                }\r\n            }\r\n            // Get the property\r\n            p = str.shift();\r\n            // Set or get the value\r\n            if (val !== undefined) {\r\n                o[p] = val;\r\n                // Success\r\n                return true;\r\n            } else {\r\n                // Return the value\r\n                return o[p];\r\n            }\r\n        }\r\n        // Something went wrong\r\n        return false;\r\n    }\r\n\r\n    // Update dictionary\r\n    obj.setDictionary = function(d) {\r\n        obj.dictionary = d;\r\n\r\n        // Translations\r\n        var t = null;\r\n        for (var i = 0; i < jSuites.calendar.weekdays.length; i++) {\r\n            t =  jSuites.translate(jSuites.calendar.weekdays[i]);\r\n            if (jSuites.calendar.weekdays[i]) {\r\n                jSuites.calendar.weekdays[i] = t;\r\n                jSuites.calendar.weekdaysShort[i] = t.substr(0,3);\r\n            }\r\n        }\r\n        for (var i = 0; i < jSuites.calendar.months.length; i++) {\r\n            t = jSuites.translate(jSuites.calendar.months[i]);\r\n            if (t) {\r\n                jSuites.calendar.months[i] = t;\r\n                jSuites.calendar.monthsShort[i] = t.substr(0,3);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Dictionary\r\n    obj.dictionary = {};\r\n\r\n    // Translate\r\n    obj.translate = function(t) {\r\n        return obj.dictionary[t] || t;\r\n    }\r\n\r\n    // Array of opened components\r\n    obj.current = [];\r\n\r\n    return obj;\r\n}();\r\n\r\n/**\r\n * Global jsuites event\r\n */\r\nif (typeof(document) !== \"undefined\") {\r\n    jSuites.init();\r\n}\r\n\r\njSuites.ajax = (function(options, complete) {\r\n    if (Array.isArray(options)) {\r\n        // Create multiple request controller \r\n        var multiple = {\r\n            instance: [],\r\n            complete: complete,\r\n        }\r\n\r\n        if (options.length > 0) {\r\n            for (var i = 0; i < options.length; i++) {\r\n                options[i].multiple = multiple;\r\n                multiple.instance.push(jSuites.ajax(options[i]));\r\n            }\r\n        }\r\n\r\n        return multiple;\r\n    }\r\n\r\n    if (! options.data) {\r\n        options.data = {};\r\n    }\r\n\r\n    if (options.type) {\r\n        options.method = options.type;\r\n    }\r\n\r\n    // Default method\r\n    if (! options.method) {\r\n        options.method = 'GET';\r\n    }\r\n\r\n    // Default type\r\n    if (! options.dataType) {\r\n        options.dataType = 'json';\r\n    }\r\n\r\n    if (options.data) {\r\n        // Parse object to variables format\r\n        var parseData = function(value, key) {\r\n            var vars = [];\r\n            var keys = Object.keys(value);\r\n            if (keys.length) {\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    if (key) {\r\n                        var k = key + '[' + keys[i] + ']';\r\n                    } else {\r\n                        var k = keys[i];\r\n                    }\r\n\r\n                    if (typeof(value[keys[i]]) == 'object') {\r\n                        var r = parseData(value[keys[i]], k);\r\n                        var o = Object.keys(r);\r\n                        for (var j = 0; j < o.length; j++) {\r\n                            vars[o[j]] = r[o[j]];\r\n                        }\r\n                    } else {\r\n                        vars[k] = value[keys[i]];\r\n                    }\r\n                }\r\n            }\r\n\r\n            return vars;\r\n        }\r\n\r\n        var data = [];\r\n        var d = parseData(options.data);\r\n        var k = Object.keys(d);\r\n        for (var i = 0; i < k.length; i++) {\r\n            data.push(k[i] + '=' + encodeURIComponent(d[k[i]]));\r\n        }\r\n\r\n        if (options.method == 'GET' && data.length > 0) {\r\n            if (options.url.indexOf('?') < 0) {\r\n                options.url += '?';\r\n            }\r\n            options.url += data.join('&');\r\n        }\r\n    }\r\n\r\n    var httpRequest = new XMLHttpRequest();\r\n    httpRequest.open(options.method, options.url, true);\r\n    httpRequest.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\r\n\r\n    if (options.method == 'POST') {\r\n        httpRequest.setRequestHeader('Accept', 'application/json');\r\n        httpRequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n    } else {\r\n        if (options.dataType == 'json') {\r\n            httpRequest.setRequestHeader('Content-Type', 'text/json');\r\n        } else if (options.dataType == 'blob') {\r\n            httpRequest.responseType = \"blob\";\r\n        } else if (options.dataType == 'html') {\r\n            httpRequest.setRequestHeader('Content-Type', 'text/html');\r\n        }\r\n    }\r\n\r\n    // No cache\r\n    if (options.cache != true) {\r\n        httpRequest.setRequestHeader('pragma', 'no-cache');\r\n        httpRequest.setRequestHeader('cache-control', 'no-cache');\r\n    }\r\n\r\n    // Authentication\r\n    if (options.withCredentials == true) {\r\n        httpRequest.withCredentials = true\r\n    }\r\n\r\n    // Before send\r\n    if (typeof(options.beforeSend) == 'function') {\r\n        options.beforeSend(httpRequest);\r\n    }\r\n\r\n    httpRequest.onload = function() {\r\n        if (httpRequest.status === 200) {\r\n            if (options.dataType == 'json') {\r\n                try {\r\n                    var result = JSON.parse(httpRequest.responseText);\r\n\r\n                    if (options.success && typeof(options.success) == 'function') {\r\n                        options.success(result);\r\n                    }\r\n                } catch(err) {\r\n                    if (options.error && typeof(options.error) == 'function') {\r\n                        options.error(err, result);\r\n                    }\r\n                }\r\n            } else {\r\n                if (options.dataType == 'blob') {\r\n                    var result = httpRequest.response;\r\n                } else {\r\n                    var result = httpRequest.responseText;\r\n                }\r\n\r\n                if (options.success && typeof(options.success) == 'function') {\r\n                    options.success(result);\r\n                }\r\n            }\r\n        } else {\r\n            if (options.error && typeof(options.error) == 'function') {\r\n                options.error(httpRequest.responseText, httpRequest.status);\r\n            }\r\n        }\r\n\r\n        // Global queue\r\n        if (jSuites.ajax.queue && jSuites.ajax.queue.length > 0) {\r\n            jSuites.ajax.send(jSuites.ajax.queue.shift());\r\n        }\r\n\r\n        // Global complete method\r\n        if (jSuites.ajax.requests && jSuites.ajax.requests.length) {\r\n            // Get index of this request in the container\r\n            var index = jSuites.ajax.requests.indexOf(httpRequest);\r\n            // Remove from the ajax requests container\r\n            jSuites.ajax.requests.splice(index, 1);\r\n            // Deprected: Last one?\r\n            if (! jSuites.ajax.requests.length) {\r\n                // Object event\r\n                if (options.complete && typeof(options.complete) == 'function') {\r\n                    options.complete(result);\r\n                }\r\n            }\r\n            // Group requests\r\n            if (options.group) {\r\n                if (jSuites.ajax.oncomplete && typeof(jSuites.ajax.oncomplete[options.group]) == 'function') {\r\n                    if (! jSuites.ajax.pending(options.group)) {\r\n                        jSuites.ajax.oncomplete[options.group]();\r\n                        jSuites.ajax.oncomplete[options.group] = null;\r\n                    }\r\n                }\r\n            }\r\n            // Multiple requests controller\r\n            if (options.multiple && options.multiple.instance) {\r\n                // Get index of this request in the container\r\n                var index = options.multiple.instance.indexOf(httpRequest);\r\n                // Remove from the ajax requests container\r\n                options.multiple.instance.splice(index, 1);\r\n                // If this is the last one call method complete\r\n                if (! options.multiple.instance.length) {\r\n                    if (options.multiple.complete && typeof(options.multiple.complete) == 'function') {\r\n                        options.multiple.complete(result);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Keep the options\r\n    httpRequest.options = options;\r\n    // Data\r\n    httpRequest.data = data;\r\n\r\n    // Queue\r\n    if (options.queue == true && jSuites.ajax.requests.length > 0) {\r\n        jSuites.ajax.queue.push(httpRequest);\r\n    } else {\r\n        jSuites.ajax.send(httpRequest)\r\n    }\r\n\r\n    return httpRequest;\r\n});\r\n\r\njSuites.ajax.send = function(httpRequest) {\r\n    if (httpRequest.data) {\r\n        httpRequest.send(httpRequest.data.join('&'));\r\n    } else {\r\n        httpRequest.send();\r\n    }\r\n\r\n    jSuites.ajax.requests.push(httpRequest);\r\n}\r\n\r\njSuites.ajax.exists = function(url, __callback) {\r\n    var http = new XMLHttpRequest();\r\n    http.open('HEAD', url, false);\r\n    http.send();\r\n    if (http.status) {\r\n        __callback(http.status);\r\n    }\r\n}\r\n\r\njSuites.ajax.pending = function(group) {\r\n    var n = 0;\r\n    var o = jSuites.ajax.requests;\r\n    if (o && o.length) {\r\n        for (var i = 0; i < o.length; i++) {\r\n            if (! group || group == o[i].options.group) {\r\n                n++\r\n            }\r\n        }\r\n    }\r\n    return n;\r\n}\r\n\r\njSuites.ajax.oncomplete = {};\r\njSuites.ajax.requests = [];\r\njSuites.ajax.queue = [];\r\n\r\njSuites.animation = {};\r\n\r\njSuites.animation.slideLeft = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-left-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-left-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-left-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-left-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideRight = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-right-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-right-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-right-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-right-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideTop = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-top-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-top-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-top-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-top-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideBottom = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-bottom-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-bottom-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-bottom-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-bottom-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\njSuites.animation.fadeIn = function(element, done) {\r\n    element.style.display = '';\r\n    element.classList.add('fade-in');\r\n    setTimeout(function() {\r\n        element.classList.remove('fade-in');\r\n        if (typeof(done) == 'function') {\r\n            done();\r\n        }\r\n    }, 2000);\r\n}\r\n\r\njSuites.animation.fadeOut = function(element, done) {\r\n    element.classList.add('fade-out');\r\n    setTimeout(function() {\r\n        element.style.display = 'none';\r\n        element.classList.remove('fade-out');\r\n        if (typeof(done) == 'function') {\r\n            done();\r\n        }\r\n    }, 1000);\r\n}\r\n\r\njSuites.calendar = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.calendar) {\r\n        return el.calendar.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type:'calendar' };\r\n    obj.options = {};\r\n\r\n    // Date\r\n    obj.date = null;\r\n\r\n    /**\r\n     * Update options\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            // Render type: [ default | year-month-picker ]\r\n            type: 'default',\r\n            // Restrictions\r\n            validRange: null,\r\n            // Starting weekday - 0 for sunday, 6 for saturday\r\n            startingDay: null, \r\n            // Date format\r\n            format: 'DD/MM/YYYY',\r\n            // Allow keyboard date entry\r\n            readonly: true,\r\n            // Today is default\r\n            today: false,\r\n            // Show timepicker\r\n            time: false,\r\n            // Show the reset button\r\n            resetButton: true,\r\n            // Placeholder\r\n            placeholder: '',\r\n            // Translations can be done here\r\n            months: jSuites.calendar.monthsShort,\r\n            monthsFull: jSuites.calendar.months,\r\n            weekdays: jSuites.calendar.weekdays,\r\n            weekdays_short: jSuites.calendar.weekdays,\r\n            textDone: jSuites.translate('Done'),\r\n            textReset: jSuites.translate('Reset'),\r\n            textUpdate: jSuites.translate('Update'),\r\n            // Value\r\n            value: null,\r\n            // Fullscreen (this is automatic set for screensize < 800)\r\n            fullscreen: false,\r\n            // Create the calendar closed as default\r\n            opened: false,\r\n            // Events\r\n            onopen: null,\r\n            onclose: null,\r\n            onchange: null,\r\n            onupdate: null,\r\n            // Internal mode controller\r\n            mode: null,\r\n            position: null,\r\n            // Data type\r\n            dataType: null,\r\n        }\r\n\r\n        for (var i = 0; i < defaults.weekdays_short.length; i++) {\r\n            defaults.weekdays_short[i] = defaults.weekdays_short[i].substr(0,1);\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Reset button\r\n        if (obj.options.resetButton == false) {\r\n            calendarReset.style.display = 'none';\r\n        } else {\r\n            calendarReset.style.display = '';\r\n        }\r\n\r\n        // Readonly\r\n        if (obj.options.readonly) {\r\n            el.setAttribute('readonly', 'readonly');\r\n        } else {\r\n            el.removeAttribute('readonly');\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            el.removeAttribute('placeholder');\r\n        }\r\n\r\n        if (jSuites.isNumeric(obj.options.value) && obj.options.value > 0) {\r\n            obj.options.value = jSuites.calendar.numToDate(obj.options.value);\r\n            // Data type numberic\r\n            obj.options.dataType = 'numeric';\r\n        }\r\n\r\n        // Texts\r\n        calendarReset.innerHTML = obj.options.textReset;\r\n        calendarConfirm.innerHTML = obj.options.textDone;\r\n        calendarControlsUpdateButton.innerHTML = obj.options.textUpdate;\r\n\r\n        // Define mask\r\n        el.setAttribute('data-mask', obj.options.format.toLowerCase());\r\n\r\n        // Value\r\n        if (! obj.options.value && obj.options.today) {\r\n            var value = jSuites.calendar.now();\r\n        } else {\r\n            var value = obj.options.value;\r\n        }\r\n\r\n        // Set internal date\r\n        if (value) {\r\n            // Force the update\r\n            obj.options.value = null;\r\n            // New value\r\n            obj.setValue(value);\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Open the calendar\r\n     */\r\n    obj.open = function (value) {\r\n        if (! calendar.classList.contains('jcalendar-focus')) {\r\n            if (! calendar.classList.contains('jcalendar-inline')) {\r\n                // Current\r\n                jSuites.calendar.current = obj;\r\n                // Start tracking\r\n                jSuites.tracking(obj, true);\r\n                // Create the days\r\n                obj.getDays();\r\n                // Render months\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.getMonths();\r\n                }\r\n                // Get time\r\n                if (obj.options.time) {\r\n                    calendarSelectHour.value = obj.date[3];\r\n                    calendarSelectMin.value = obj.date[4];\r\n                }\r\n\r\n                // Show calendar\r\n                calendar.classList.add('jcalendar-focus');\r\n\r\n                // Get the position of the corner helper\r\n                if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen) {\r\n                    calendar.classList.add('jcalendar-fullsize');\r\n                    // Animation\r\n                    jSuites.animation.slideBottom(calendarContent, 1);\r\n                } else {\r\n                    calendar.classList.remove('jcalendar-fullsize');\r\n\r\n                    var rect = el.getBoundingClientRect();\r\n                    var rectContent = calendarContent.getBoundingClientRect();\r\n\r\n                    if (obj.options.position) {\r\n                        calendarContainer.style.position = 'fixed';\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            calendarContainer.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                        } else {\r\n                            calendarContainer.style.top = (rect.top + rect.height + 2) + 'px';\r\n                        }\r\n                        calendarContainer.style.left = rect.left + 'px';\r\n                    } else {\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            var d = -1 * (rect.height + rectContent.height + 2);\r\n                            if (d + rect.top < 0) {\r\n                                d = -1 * (rect.top + rect.height);\r\n                            }\r\n                            calendarContainer.style.top = d + 'px';\r\n                        } else {\r\n                            calendarContainer.style.top = 2 + 'px'; \r\n                        }\r\n\r\n                        if (window.innerWidth < rect.left + rectContent.width) {\r\n                            var d = window.innerWidth - (rect.left + rectContent.width + 20);\r\n                            calendarContainer.style.left = d + 'px';\r\n                        } else {\r\n                            calendarContainer.style.left = '0px'; \r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Events\r\n                if (typeof(obj.options.onopen) == 'function') {\r\n                    obj.options.onopen(el);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.close = function (ignoreEvents, update) {\r\n        if (calendar.classList.contains('jcalendar-focus')) {\r\n            if (update !== false) {\r\n                var element = calendar.querySelector('.jcalendar-selected');\r\n\r\n                if (typeof(update) == 'string') {\r\n                    var value = update;\r\n                } else if (! element || element.classList.contains('jcalendar-disabled')) {\r\n                    var value = obj.options.value\r\n                } else {\r\n                    var value = obj.getValue();\r\n                }\r\n\r\n                obj.setValue(value);\r\n            }\r\n\r\n            // Events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Hide\r\n            calendar.classList.remove('jcalendar-focus');\r\n            // Stop tracking\r\n            jSuites.tracking(obj, false);\r\n            // Current\r\n            jSuites.calendar.current = null;\r\n        }\r\n\r\n        return obj.options.value;\r\n    }\r\n\r\n    obj.prev = function() {\r\n        // Check if the visualization is the days picker or years picker\r\n        if (obj.options.mode == 'years') {\r\n            obj.date[0] = obj.date[0] - 12;\r\n\r\n            // Update picker table of days\r\n            obj.getYears();\r\n        } else if (obj.options.mode == 'months') {\r\n            obj.date[0] = parseInt(obj.date[0]) - 1;\r\n            // Update picker table of months\r\n            obj.getMonths();\r\n        } else {\r\n            // Go to the previous month\r\n            if (obj.date[1] < 2) {\r\n                obj.date[0] = obj.date[0] - 1;\r\n                obj.date[1] = 12;\r\n            } else {\r\n                obj.date[1] = obj.date[1] - 1;\r\n            }\r\n\r\n            // Update picker table of days\r\n            obj.getDays();\r\n        }\r\n    }\r\n\r\n    obj.next = function() {\r\n        // Check if the visualization is the days picker or years picker\r\n        if (obj.options.mode == 'years') {\r\n            obj.date[0] = parseInt(obj.date[0]) + 12;\r\n\r\n            // Update picker table of days\r\n            obj.getYears();\r\n        } else if (obj.options.mode == 'months') {\r\n            obj.date[0] = parseInt(obj.date[0]) + 1;\r\n            // Update picker table of months\r\n            obj.getMonths();\r\n        } else {\r\n            // Go to the previous month\r\n            if (obj.date[1] > 11) {\r\n                obj.date[0] = parseInt(obj.date[0]) + 1;\r\n                obj.date[1] = 1;\r\n            } else {\r\n                obj.date[1] = parseInt(obj.date[1]) + 1;\r\n            }\r\n\r\n            // Update picker table of days\r\n            obj.getDays();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set today\r\n     */\r\n    obj.setToday = function() {\r\n        // Today\r\n        var value = new Date().toISOString().substr(0, 10);\r\n        // Change value\r\n        obj.setValue(value);\r\n        // Value\r\n        return value;\r\n    }\r\n\r\n    obj.setValue = function(val) {\r\n        if (! val) {\r\n            val = '' + val;\r\n        }\r\n        // Values\r\n        var newValue = val;\r\n        var oldValue = obj.options.value;\r\n\r\n        if (oldValue != newValue) {\r\n            // Set label\r\n            if (! newValue) {\r\n                obj.date = null;\r\n                var val = '';\r\n            } else {\r\n                var value = obj.setLabel(newValue, obj.options);\r\n                var date = newValue.split(' ');\r\n                if (! date[1]) {\r\n                    date[1] = '00:00:00';\r\n                }\r\n                var time = date[1].split(':')\r\n                var date = date[0].split('-');\r\n                var y = parseInt(date[0]);\r\n                var m = parseInt(date[1]);\r\n                var d = parseInt(date[2]);\r\n                var h = parseInt(time[0]);\r\n                var i = parseInt(time[1]);\r\n                obj.date = [ y, m, d, h, i, 0 ];\r\n                var val = obj.setLabel(newValue, obj.options);\r\n            }\r\n\r\n            // New value\r\n            obj.options.value = newValue;\r\n\r\n            if (typeof(obj.options.onchange) ==  'function') {\r\n                obj.options.onchange(el, newValue, oldValue);\r\n            }\r\n\r\n            // Lemonade JS\r\n            if (el.value != val) {\r\n                el.value = val;\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        obj.getDays();\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        if (obj.date) {\r\n            if (obj.options.time) {\r\n                return jSuites.two(obj.date[0]) + '-' + jSuites.two(obj.date[1]) + '-' + jSuites.two(obj.date[2]) + ' ' + jSuites.two(obj.date[3]) + ':' + jSuites.two(obj.date[4]) + ':' + jSuites.two(0);\r\n            } else {\r\n                return jSuites.two(obj.date[0]) + '-' + jSuites.two(obj.date[1]) + '-' + jSuites.two(obj.date[2]) + ' ' + jSuites.two(0) + ':' + jSuites.two(0) + ':' + jSuites.two(0);\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     *  Calendar\r\n     */\r\n    obj.update = function(element, v) {\r\n        if (element.classList.contains('jcalendar-disabled')) {\r\n            // Do nothing\r\n        } else {\r\n            var elements = calendar.querySelector('.jcalendar-selected');\r\n            if (elements) {\r\n                elements.classList.remove('jcalendar-selected');\r\n            }\r\n            element.classList.add('jcalendar-selected');\r\n\r\n            if (element.classList.contains('jcalendar-set-month')) {\r\n                obj.date[1] = v;\r\n            } else {\r\n                obj.date[2] = element.innerText;\r\n            }\r\n\r\n            if (! obj.options.time) {\r\n                obj.close();\r\n            } else {\r\n                obj.date[3] = calendarSelectHour.value;\r\n                obj.date[4] = calendarSelectMin.value;\r\n            }\r\n        }\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    /**\r\n     * Set to blank\r\n     */\r\n    obj.reset = function() {\r\n        // Close calendar\r\n        obj.setValue('');\r\n        obj.date = null;\r\n        obj.close(false, false);\r\n    }\r\n\r\n    /**\r\n     * Get calendar days\r\n     */\r\n    obj.getDays = function() {\r\n        // Mode\r\n        obj.options.mode = 'days';\r\n\r\n        // Setting current values in case of NULLs\r\n        var date = new Date();\r\n\r\n        // Current selection\r\n        var year = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : parseInt(date.getFullYear());\r\n        var month = obj.date && jSuites.isNumeric(obj.date[1]) ? obj.date[1] : parseInt(date.getMonth()) + 1;\r\n        var day = obj.date && jSuites.isNumeric(obj.date[2]) ? obj.date[2] : parseInt(date.getDate());\r\n        var hour = obj.date && jSuites.isNumeric(obj.date[3]) ? obj.date[3] : parseInt(date.getHours());\r\n        var min = obj.date && jSuites.isNumeric(obj.date[4]) ? obj.date[4] : parseInt(date.getMinutes());\r\n\r\n        // Selection container\r\n        obj.date = [ year, month, day, hour, min, 0 ];\r\n\r\n        // Update title\r\n        calendarLabelYear.innerHTML = year;\r\n        calendarLabelMonth.innerHTML = obj.options.months[month - 1];\r\n\r\n        // Current month and Year\r\n        var isCurrentMonthAndYear = (date.getMonth() == month - 1) && (date.getFullYear() == year) ? true : false;\r\n        var currentDay = date.getDate();\r\n\r\n        // Number of days in the month\r\n        var date = new Date(year, month, 0, 0, 0);\r\n        var numberOfDays = date.getDate();\r\n\r\n        // First day\r\n        var date = new Date(year, month-1, 0, 0, 0);\r\n        var firstDay = date.getDay() + 1;\r\n\r\n        // Index value\r\n        var index = obj.options.startingDay || 0;\r\n\r\n        // First of day relative to the starting calendar weekday\r\n        firstDay = firstDay - index;\r\n\r\n        // Reset table\r\n        calendarBody.innerHTML = '';\r\n\r\n        // Weekdays Row\r\n        var row = document.createElement('tr');\r\n        row.setAttribute('align', 'center');\r\n        calendarBody.appendChild(row);\r\n\r\n        // Create weekdays row\r\n        for (var i = 0; i < 7; i++) {\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-weekday')\r\n            cell.innerHTML = obj.options.weekdays_short[index];\r\n            row.appendChild(cell);\r\n            // Next week day\r\n            index++;\r\n            // Restart index\r\n            if (index > 6) {\r\n                index = 0;\r\n            }\r\n        }\r\n\r\n        // Index of days\r\n        var index = 0;\r\n        var d = 0;\r\n \r\n        // Calendar table\r\n        for (var j = 0; j < 6; j++) {\r\n            // Reset cells container\r\n            var row = document.createElement('tr');\r\n            row.setAttribute('align', 'center');\r\n            // Data control\r\n            var emptyRow = true;\r\n            // Create cells\r\n            for (var i = 0; i < 7; i++) {\r\n                // Create cell\r\n                var cell = document.createElement('td');\r\n                cell.classList.add('jcalendar-set-day');\r\n\r\n                if (index >= firstDay && index < (firstDay + numberOfDays)) {\r\n                    // Day cell\r\n                    d++;\r\n                    cell.innerHTML = d;\r\n\r\n                    // Selected\r\n                    if (d == day) {\r\n                        cell.classList.add('jcalendar-selected');\r\n                    }\r\n\r\n                    // Current selection day is today\r\n                    if (isCurrentMonthAndYear && currentDay == d) {\r\n                        cell.style.fontWeight = 'bold';\r\n                    }\r\n\r\n                    // Current selection day\r\n                    var current = jSuites.calendar.now(new Date(year, month-1, d), true);\r\n\r\n                    // Available ranges\r\n                    if (obj.options.validRange) {\r\n                        if (! obj.options.validRange[0] || current >= obj.options.validRange[0]) {\r\n                            var test1 = true;\r\n                        } else {\r\n                            var test1 = false;\r\n                        }\r\n\r\n                        if (! obj.options.validRange[1] || current <= obj.options.validRange[1]) {\r\n                            var test2 = true;\r\n                        } else {\r\n                            var test2 = false;\r\n                        }\r\n\r\n                        if (! (test1 && test2)) {\r\n                            cell.classList.add('jcalendar-disabled');\r\n                        }\r\n                    }\r\n\r\n                    // Control\r\n                    emptyRow = false;\r\n                }\r\n                // Day cell\r\n                row.appendChild(cell);\r\n                // Index\r\n                index++;\r\n            }\r\n\r\n            // Add cell to the calendar body\r\n            if (emptyRow == false) {\r\n                calendarBody.appendChild(row);\r\n            }\r\n        }\r\n\r\n        // Show time controls\r\n        if (obj.options.time) {\r\n            calendarControlsTime.style.display = '';\r\n        } else {\r\n            calendarControlsTime.style.display = 'none';\r\n        }\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.getMonths = function() {\r\n        // Mode\r\n        obj.options.mode = 'months';\r\n\r\n        // Loading month labels\r\n        var months = obj.options.months;\r\n\r\n        // Value\r\n        var value = obj.options.value; \r\n\r\n        // Current date\r\n        var date = new Date();\r\n        var currentYear = parseInt(date.getFullYear());\r\n        var currentMonth = parseInt(date.getMonth()) + 1;\r\n        var selectedYear = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : currentYear;\r\n        var selectedMonth = obj.date && jSuites.isNumeric(obj.date[1]) ? obj.date[1] : currentMonth;\r\n\r\n        // Update title\r\n        calendarLabelYear.innerHTML = obj.date[0];\r\n        calendarLabelMonth.innerHTML = months[selectedMonth-1];\r\n\r\n        // Table\r\n        var table = document.createElement('table');\r\n        table.setAttribute('width', '100%');\r\n\r\n        // Row\r\n        var row = null;\r\n\r\n        // Calendar table\r\n        for (var i = 0; i < 12; i++) {\r\n            if (! (i % 4)) {\r\n                // Reset cells container\r\n                var row = document.createElement('tr');\r\n                row.setAttribute('align', 'center');\r\n                table.appendChild(row);\r\n            }\r\n\r\n            // Create cell\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-set-month');\r\n            cell.setAttribute('data-value', i+1);\r\n            cell.innerText = months[i];\r\n\r\n            if (obj.options.validRange) {\r\n                var current = selectedYear + '-' + jSuites.two(i+1);\r\n                if (! obj.options.validRange[0] || current >= obj.options.validRange[0].substr(0,7)) {\r\n                    var test1 = true;\r\n                } else {\r\n                    var test1 = false;\r\n                }\r\n\r\n                if (! obj.options.validRange[1] || current <= obj.options.validRange[1].substr(0,7)) {\r\n                    var test2 = true;\r\n                } else {\r\n                    var test2 = false;\r\n                }\r\n\r\n                if (! (test1 && test2)) {\r\n                    cell.classList.add('jcalendar-disabled');\r\n                }\r\n            }\r\n\r\n            if (i+1 == selectedMonth) {\r\n                cell.classList.add('jcalendar-selected');\r\n            }\r\n\r\n            if (currentYear == selectedYear && i+1 == currentMonth) {\r\n                cell.style.fontWeight = 'bold';\r\n            }\r\n\r\n            row.appendChild(cell);\r\n        }\r\n\r\n        calendarBody.innerHTML = '<tr><td colspan=\"7\"></td></tr>';\r\n        calendarBody.children[0].children[0].appendChild(table);\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.getYears = function() { \r\n        // Mode\r\n        obj.options.mode = 'years';\r\n\r\n        // Current date\r\n        var date = new Date();\r\n        var currentYear = date.getFullYear();\r\n        var selectedYear = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : parseInt(date.getFullYear());\r\n\r\n        // Array of years\r\n        var y = [];\r\n        for (var i = 0; i < 25; i++) {\r\n            y[i] = parseInt(obj.date[0]) + (i - 12);\r\n        }\r\n\r\n        // Assembling the year tables\r\n        var table = document.createElement('table');\r\n        table.setAttribute('width', '100%');\r\n\r\n        for (var i = 0; i < 25; i++) {\r\n            if (! (i % 5)) {\r\n                // Reset cells container\r\n                var row = document.createElement('tr');\r\n                row.setAttribute('align', 'center');\r\n                table.appendChild(row);\r\n            }\r\n\r\n            // Create cell\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-set-year');\r\n            cell.innerText = y[i];\r\n\r\n            if (selectedYear == y[i]) {\r\n                cell.classList.add('jcalendar-selected');\r\n            }\r\n\r\n            if (currentYear == y[i]) {\r\n                cell.style.fontWeight = 'bold';\r\n            }\r\n\r\n            row.appendChild(cell);\r\n        }\r\n\r\n        calendarBody.innerHTML = '<tr><td colspan=\"7\"></td></tr>';\r\n        calendarBody.firstChild.firstChild.appendChild(table);\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.setLabel = function(value, mixed) {\r\n        return jSuites.calendar.getDateString(value, mixed);\r\n    }\r\n\r\n    obj.fromFormatted = function (value, format) {\r\n        return jSuites.calendar.extractDateFromString(value, format);\r\n    }\r\n\r\n    var mouseUpControls = function(e) {\r\n        var element = jSuites.findElement(e.target, 'jcalendar-container');\r\n        if (element) {\r\n            var action = e.target.className;\r\n\r\n            // Object id\r\n            if (action == 'jcalendar-prev') {\r\n                obj.prev();\r\n            } else if (action == 'jcalendar-next') {\r\n                obj.next();\r\n            } else if (action == 'jcalendar-month') {\r\n                obj.getMonths();\r\n            } else if (action == 'jcalendar-year') {\r\n                obj.getYears();\r\n            } else if (action == 'jcalendar-set-year') {\r\n                obj.date[0] = e.target.innerText;\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.getMonths();\r\n                } else {\r\n                    obj.getDays();\r\n                }\r\n            } else if (e.target.classList.contains('jcalendar-set-month')) {\r\n                var month = parseInt(e.target.getAttribute('data-value'));\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.update(e.target, month);\r\n                } else {\r\n                    obj.date[1] = month;\r\n                    obj.getDays();\r\n                }\r\n            } else if (action == 'jcalendar-confirm' || action == 'jcalendar-update' || action == 'jcalendar-close') {\r\n                obj.close();\r\n            } else if (action == 'jcalendar-backdrop') {\r\n                obj.close(false, false);\r\n            } else if (action == 'jcalendar-reset') {\r\n                obj.reset();\r\n            } else if (e.target.classList.contains('jcalendar-set-day') && e.target.innerText) {\r\n                obj.update(e.target);\r\n            }\r\n        } else {\r\n            obj.close();\r\n        }\r\n    }\r\n\r\n    var keyUpControls = function(e) {\r\n        if (e.target.value && e.target.value.length > 3) {\r\n            var test = jSuites.calendar.extractDateFromString(e.target.value, obj.options.format);\r\n            if (test) {\r\n                obj.setValue(test);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Update actions button\r\n    var updateActions = function() {\r\n        var currentDay = calendar.querySelector('.jcalendar-selected');\r\n\r\n        if (currentDay && currentDay.classList.contains('jcalendar-disabled')) {\r\n            calendarControlsUpdateButton.setAttribute('disabled', 'disabled');\r\n            calendarSelectHour.setAttribute('disabled', 'disabled');\r\n            calendarSelectMin.setAttribute('disabled', 'disabled');\r\n        } else {\r\n            calendarControlsUpdateButton.removeAttribute('disabled');\r\n            calendarSelectHour.removeAttribute('disabled');\r\n            calendarSelectMin.removeAttribute('disabled');\r\n        }\r\n\r\n        // Event\r\n        if (typeof(obj.options.onupdate) == 'function') {\r\n            obj.options.onupdate(el, obj.getValue());\r\n        }\r\n    }\r\n\r\n    var calendar = null;\r\n    var calendarReset = null;\r\n    var calendarConfirm = null;\r\n    var calendarContainer = null;\r\n    var calendarContent = null;\r\n    var calendarLabelYear = null;\r\n    var calendarLabelMonth = null;\r\n    var calendarTable = null;\r\n    var calendarBody = null;\r\n\r\n    var calendarControls = null;\r\n    var calendarControlsTime = null;\r\n    var calendarControlsUpdate = null;\r\n    var calendarControlsUpdateButton = null;\r\n    var calendarSelectHour = null;\r\n    var calendarSelectMin = null;\r\n\r\n    var init = function() {\r\n        // Get value from initial element if that is an input\r\n        if (el.tagName == 'INPUT' && el.value) {\r\n            options.value = el.value;\r\n        }\r\n\r\n        // Calendar DOM elements\r\n        calendarReset = document.createElement('div');\r\n        calendarReset.className = 'jcalendar-reset';\r\n\r\n        calendarConfirm = document.createElement('div');\r\n        calendarConfirm.className = 'jcalendar-confirm';\r\n\r\n        calendarControls = document.createElement('div');\r\n        calendarControls.className = 'jcalendar-controls'\r\n        calendarControls.style.borderBottom = '1px solid #ddd';\r\n        calendarControls.appendChild(calendarReset);\r\n        calendarControls.appendChild(calendarConfirm);\r\n\r\n        calendarContainer = document.createElement('div');\r\n        calendarContainer.className = 'jcalendar-container';\r\n\r\n        calendarContent = document.createElement('div');\r\n        calendarContent.className = 'jcalendar-content';\r\n        calendarContainer.appendChild(calendarContent);\r\n\r\n        // Main element\r\n        if (el.tagName == 'DIV') {\r\n            calendar = el;\r\n            calendar.classList.add('jcalendar-inline');\r\n        } else {\r\n            // Add controls to the screen\r\n            calendarContent.appendChild(calendarControls);\r\n\r\n            calendar = document.createElement('div');\r\n            calendar.className = 'jcalendar';\r\n        }\r\n        calendar.classList.add('jcalendar-container');\r\n        calendar.appendChild(calendarContainer);\r\n\r\n        // Table container\r\n        var calendarTableContainer = document.createElement('div');\r\n        calendarTableContainer.className = 'jcalendar-table';\r\n        calendarContent.appendChild(calendarTableContainer);\r\n\r\n        // Previous button\r\n        var calendarHeaderPrev = document.createElement('td');\r\n        calendarHeaderPrev.setAttribute('colspan', '2');\r\n        calendarHeaderPrev.className = 'jcalendar-prev';\r\n\r\n        // Header with year and month\r\n        calendarLabelYear = document.createElement('span');\r\n        calendarLabelYear.className = 'jcalendar-year';\r\n        calendarLabelMonth = document.createElement('span');\r\n        calendarLabelMonth.className = 'jcalendar-month';\r\n\r\n        var calendarHeaderTitle = document.createElement('td');\r\n        calendarHeaderTitle.className = 'jcalendar-header';\r\n        calendarHeaderTitle.setAttribute('colspan', '3');\r\n        calendarHeaderTitle.appendChild(calendarLabelMonth);\r\n        calendarHeaderTitle.appendChild(calendarLabelYear);\r\n\r\n        var calendarHeaderNext = document.createElement('td');\r\n        calendarHeaderNext.setAttribute('colspan', '2');\r\n        calendarHeaderNext.className = 'jcalendar-next';\r\n\r\n        var calendarHeader = document.createElement('thead');\r\n        var calendarHeaderRow = document.createElement('tr');\r\n        calendarHeaderRow.appendChild(calendarHeaderPrev);\r\n        calendarHeaderRow.appendChild(calendarHeaderTitle);\r\n        calendarHeaderRow.appendChild(calendarHeaderNext);\r\n        calendarHeader.appendChild(calendarHeaderRow);\r\n\r\n        calendarTable = document.createElement('table');\r\n        calendarBody = document.createElement('tbody');\r\n        calendarTable.setAttribute('cellpadding', '0');\r\n        calendarTable.setAttribute('cellspacing', '0');\r\n        calendarTable.appendChild(calendarHeader);\r\n        calendarTable.appendChild(calendarBody);\r\n        calendarTableContainer.appendChild(calendarTable);\r\n\r\n        calendarSelectHour = document.createElement('select');\r\n        calendarSelectHour.className = 'jcalendar-select';\r\n        calendarSelectHour.onchange = function() {\r\n            obj.date[3] = this.value; \r\n\r\n            // Event\r\n            if (typeof(obj.options.onupdate) == 'function') {\r\n                obj.options.onupdate(el, obj.getValue());\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 24; i++) {\r\n            var element = document.createElement('option');\r\n            element.value = i;\r\n            element.innerHTML = jSuites.two(i);\r\n            calendarSelectHour.appendChild(element);\r\n        }\r\n\r\n        calendarSelectMin = document.createElement('select');\r\n        calendarSelectMin.className = 'jcalendar-select';\r\n        calendarSelectMin.onchange = function() {\r\n            obj.date[4] = this.value;\r\n\r\n            // Event\r\n            if (typeof(obj.options.onupdate) == 'function') {\r\n                obj.options.onupdate(el, obj.getValue());\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 60; i++) {\r\n            var element = document.createElement('option');\r\n            element.value = i;\r\n            element.innerHTML = jSuites.two(i);\r\n            calendarSelectMin.appendChild(element);\r\n        }\r\n\r\n        // Footer controls\r\n        var calendarControlsFooter = document.createElement('div');\r\n        calendarControlsFooter.className = 'jcalendar-controls';\r\n\r\n        calendarControlsTime = document.createElement('div');\r\n        calendarControlsTime.className = 'jcalendar-time';\r\n        calendarControlsTime.style.maxWidth = '140px';\r\n        calendarControlsTime.appendChild(calendarSelectHour);\r\n        calendarControlsTime.appendChild(calendarSelectMin);\r\n\r\n        calendarControlsUpdateButton = document.createElement('button');\r\n        calendarControlsUpdateButton.setAttribute('type', 'button');\r\n        calendarControlsUpdateButton.className = 'jcalendar-update';\r\n\r\n        calendarControlsUpdate = document.createElement('div');\r\n        calendarControlsUpdate.style.flexGrow = '10';\r\n        calendarControlsUpdate.appendChild(calendarControlsUpdateButton);\r\n        calendarControlsFooter.appendChild(calendarControlsTime);\r\n\r\n        // Only show the update button for input elements\r\n        if (el.tagName == 'INPUT') {\r\n            calendarControlsFooter.appendChild(calendarControlsUpdate);\r\n        }\r\n\r\n        calendarContent.appendChild(calendarControlsFooter);\r\n\r\n        var calendarBackdrop = document.createElement('div');\r\n        calendarBackdrop.className = 'jcalendar-backdrop';\r\n        calendar.appendChild(calendarBackdrop);\r\n\r\n        // Handle events\r\n        el.addEventListener(\"keyup\", keyUpControls);\r\n\r\n        // Add global events\r\n        calendar.addEventListener(\"swipeleft\", function(e) {\r\n            jSuites.animation.slideLeft(calendarTable, 0, function() {\r\n                obj.next();\r\n                jSuites.animation.slideRight(calendarTable, 1);\r\n            });\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n\r\n        calendar.addEventListener(\"swiperight\", function(e) {\r\n            jSuites.animation.slideRight(calendarTable, 0, function() {\r\n                obj.prev();\r\n                jSuites.animation.slideLeft(calendarTable, 1);\r\n            });\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n\r\n        el.onmouseup = function() {\r\n            obj.open();\r\n        }\r\n\r\n        if ('ontouchend' in document.documentElement === true) {\r\n            calendar.addEventListener(\"touchend\", mouseUpControls);\r\n        } else {\r\n            calendar.addEventListener(\"mouseup\", mouseUpControls);\r\n        }\r\n\r\n        // Global controls\r\n        if (! jSuites.calendar.hasEvents) {\r\n            // Execute only one time\r\n            jSuites.calendar.hasEvents = true;\r\n            // Enter and Esc\r\n            document.addEventListener(\"keydown\", jSuites.calendar.keydown);\r\n        }\r\n\r\n        // Set configuration\r\n        obj.setOptions(options);\r\n\r\n        // Append element to the DOM\r\n        if (el.tagName == 'INPUT') {\r\n            el.parentNode.insertBefore(calendar, el.nextSibling);\r\n            // Add properties\r\n            el.setAttribute('autocomplete', 'off');\r\n            // Element\r\n            el.classList.add('jcalendar-input');\r\n            // Value\r\n            el.value = obj.setLabel(obj.getValue(), obj.options);\r\n        } else {\r\n            // Get days\r\n            obj.getDays();\r\n            // Hour\r\n            if (obj.options.time) {\r\n                calendarSelectHour.value = obj.date[3];\r\n                calendarSelectMin.value = obj.date[4];\r\n            }\r\n        }\r\n\r\n        // Default opened\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n\r\n        // Change method\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.calendar = calendar.calendar = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.calendar.keydown = function(e) {\r\n    var calendar = null;\r\n    if (calendar = jSuites.calendar.current) { \r\n        if (e.which == 13) {\r\n            // ENTER\r\n            calendar.close(false, true);\r\n        } else if (e.which == 27) {\r\n            // ESC\r\n            calendar.close(false, false);\r\n        }\r\n    }\r\n}\r\n\r\njSuites.calendar.prettify = function(d, texts) {\r\n    if (! texts) {\r\n        var texts = {\r\n            justNow: 'Just now',\r\n            xMinutesAgo: '{0}m ago',\r\n            xHoursAgo: '{0}h ago',\r\n            xDaysAgo: '{0}d ago',\r\n            xWeeksAgo: '{0}w ago',\r\n            xMonthsAgo: '{0} mon ago',\r\n            xYearsAgo: '{0}y ago',\r\n        }\r\n    }\r\n\r\n    var d1 = new Date();\r\n    var d2 = new Date(d);\r\n    var total = parseInt((d1 - d2) / 1000 / 60);\r\n\r\n    String.prototype.format = function(o) {\r\n        return this.replace('{0}', o);\r\n    }\r\n\r\n    if (total == 0) {\r\n        var text = texts.justNow;\r\n    } else if (total < 90) {\r\n        var text = texts.xMinutesAgo.format(total);\r\n    } else if (total < 1440) { // One day\r\n        var text = texts.xHoursAgo.format(Math.round(total/60));\r\n    } else if (total < 20160) { // 14 days\r\n        var text = texts.xDaysAgo.format(Math.round(total / 1440));\r\n    } else if (total < 43200) { // 30 days\r\n        var text = texts.xWeeksAgo.format(Math.round(total / 10080));\r\n    } else if (total < 1036800) { // 24 months\r\n        var text = texts.xMonthsAgo.format(Math.round(total / 43200));\r\n    } else { // 24 months+\r\n        var text = texts.xYearsAgo.format(Math.round(total / 525600));\r\n    }\r\n\r\n    return text;\r\n}\r\n\r\njSuites.calendar.prettifyAll = function() {\r\n    var elements = document.querySelectorAll('.prettydate');\r\n    for (var i = 0; i < elements.length; i++) {\r\n        if (elements[i].getAttribute('data-date')) {\r\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].getAttribute('data-date'));\r\n        } else {\r\n            elements[i].setAttribute('data-date', elements[i].innerHTML);\r\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].innerHTML);\r\n        }\r\n    }\r\n}\r\n\r\njSuites.calendar.now = function(date, dateOnly) {\r\n    if (Array.isArray(date)) {\r\n        var y = date[0];\r\n        var m = date[1];\r\n        var d = date[2];\r\n        var h = date[3];\r\n        var i = date[4];\r\n        var s = date[5];\r\n    } else {\r\n        if (! date) {\r\n            var date = new Date();\r\n        }\r\n        var y = date.getFullYear();\r\n        var m = date.getMonth() + 1;\r\n        var d = date.getDate();\r\n        var h = date.getHours();\r\n        var i = date.getMinutes();\r\n        var s = date.getSeconds();\r\n    }\r\n\r\n    if (dateOnly == true) {\r\n        return jSuites.two(y) + '-' + jSuites.two(m) + '-' + jSuites.two(d);\r\n    } else {\r\n        return jSuites.two(y) + '-' + jSuites.two(m) + '-' + jSuites.two(d) + ' ' + jSuites.two(h) + ':' + jSuites.two(i) + ':' + jSuites.two(s);\r\n    }\r\n}\r\n\r\njSuites.calendar.toArray = function(value) {\r\n    var date = value.split(((value.indexOf('T') !== -1) ? 'T' : ' '));\r\n    var time = date[1];\r\n    var date = date[0].split('-');\r\n    var y = parseInt(date[0]);\r\n    var m = parseInt(date[1]);\r\n    var d = parseInt(date[2]);\r\n\r\n    if (time) {\r\n        var time = time.split(':');\r\n        var h = parseInt(time[0]);\r\n        var i = parseInt(time[1]);\r\n    } else {\r\n        var h = 0;\r\n        var i = 0;\r\n    }\r\n    return [ y, m, d, h, i, 0 ];\r\n}\r\n\r\n// Helper to extract date from a string\r\njSuites.calendar.extractDateFromString = function(date, format) {\r\n    if (date > 0 && Number(date) == date) {\r\n        var d = new Date(Math.round((date - 25569)*86400*1000));\r\n        return d.getFullYear() + \"-\" + jSuites.two(d.getMonth()) + \"-\" + jSuites.two(d.getDate()) + ' 00:00:00';\r\n    }\r\n\r\n    var v1 = '' + date;\r\n    var v2 = format.replace(/[0-9]/g,'');\r\n\r\n    var test = 1;\r\n\r\n    // Get year\r\n    var y = v2.search(\"YYYY\");\r\n    y = v1.substr(y,4);\r\n    if (parseInt(y) != y) {\r\n        test = 0;\r\n    }\r\n\r\n    // Get month\r\n    var m = v2.search(\"MM\");\r\n    m = v1.substr(m,2);\r\n    if (parseInt(m) != m || m > 12) {\r\n        test = 0;\r\n    }\r\n\r\n    // Get day\r\n    var d = v2.search(\"DD\");\r\n    if (d >= 0) {\r\n        d = v1.substr(d,2);\r\n        if (parseInt(d) != d  || d > 31) {\r\n            test = 0;\r\n        }\r\n    } else {\r\n        d = '01';\r\n    }\r\n\r\n    // Get hour\r\n    var h = v2.search(\"HH\");\r\n    if (h >= 0) {\r\n        h = v1.substr(h,2);\r\n        if (! parseInt(h) || h > 23) {\r\n            h = '00';\r\n        }\r\n    } else {\r\n        h = '00';\r\n    }\r\n\r\n    // Get minutes\r\n    var i = v2.search(\"MI\");\r\n    if (i >= 0) {\r\n        i = v1.substr(i,2);\r\n        if (! parseInt(i) || i > 59) {\r\n            i = '00';\r\n        }\r\n    } else {\r\n        i = '00';\r\n    }\r\n\r\n    // Get seconds\r\n    var s = v2.search(\"SS\");\r\n    if (s >= 0) {\r\n        s = v1.substr(s,2);\r\n        if (! parseInt(s) || s > 59) {\r\n            s = '00';\r\n        }\r\n    } else {\r\n        s = '00';\r\n    }\r\n\r\n    if (test == 1 && date.length == v2.length) {\r\n        // Update source\r\n        return y + '-' + m + '-' + d + ' ' + h + ':' +  i + ':' + s;\r\n    }\r\n\r\n    return '';\r\n}\r\n\r\n/**\r\n * Date to number\r\n */\r\njSuites.calendar.dateToNum = function(a, b) {\r\n    a = new Date(a);\r\n    if (! b) {\r\n        b = '1899-12-30 ' + a.getHours() + ':' + a.getMinutes() + ':' + a.getSeconds();\r\n    }\r\n    b = new Date(b);\r\n    var v = a.getTime() - b.getTime();\r\n    return Math.round(v / 86400000);\r\n}\r\n\r\n/**\r\n * Number to date\r\n */\r\njSuites.calendar.numToDate = function(value) {\r\n    var d = new Date(Math.round((value - 25569)*86400*1000));\r\n    return d.getFullYear() + \"-\" + jSuites.two(d.getMonth()+1) + \"-\" + jSuites.two(d.getDate()) + ' 00:00:00';\r\n}\r\n\r\n// Helper to convert date into string\r\njSuites.calendar.getDateString = function(value, options) {\r\n    if (! options) {\r\n        var options = {};\r\n    }\r\n\r\n    // Labels\r\n    if (options && typeof(options) == 'object') {\r\n        var format = options.format;\r\n    } else {\r\n        var format = options;\r\n    }\r\n\r\n    if (! format) {\r\n        format = 'YYYY-MM-DD';\r\n    }\r\n\r\n    // Convert to number of hours\r\n    if (typeof(value) == 'number' && format.indexOf('[h]') >= 0) {\r\n        var result = parseFloat(24 * Number(value));\r\n        if (format.indexOf('mm') >= 0) {\r\n            var h = (''+result).split('.');\r\n            if (h[1]) {\r\n                var d = 60 * parseFloat('0.' + h[1])\r\n                d = parseFloat(d.toFixed(2));\r\n            } else {\r\n                var d = 0;\r\n            }\r\n            result = parseInt(h[0]) + ':' + jSuites.two(d);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // Date instance\r\n    if (value instanceof Date) {\r\n        value = jSuites.calendar.now(value);\r\n    } else if (value && jSuites.isNumeric(value)) {\r\n        value = jSuites.calendar.numToDate(value);\r\n    }\r\n\r\n    // Tokens\r\n    var tokens = [ 'DAY', 'WD', 'DDDD', 'DDD', 'DD', 'D', 'Q', 'HH24', 'HH12', 'HH', 'H', 'AM/PM', 'MI', 'SS', 'MS', 'YYYY', 'YYY', 'YY', 'Y', 'MONTH', 'MON', 'MMMMM', 'MMMM', 'MMM', 'MM', 'M', '.' ];\r\n\r\n    // Expression to extract all tokens from the string\r\n    var e = new RegExp(tokens.join('|'), 'gi');\r\n    // Extract\r\n    var t = format.match(e);\r\n\r\n    // Compatibility with excel\r\n    for (var i = 0; i < t.length; i++) {\r\n        if (t[i].toUpperCase() == 'MM') {\r\n            // Not a month, correct to minutes\r\n            if (t[i-1] && t[i-1].toUpperCase().indexOf('H') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i-2] && t[i-2].toUpperCase().indexOf('H') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i+1] && t[i+1].toUpperCase().indexOf('S') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i+2] && t[i+2].toUpperCase().indexOf('S') >= 0) {\r\n                t[i] = 'mi';\r\n            }\r\n        }\r\n    }\r\n\r\n    // Object\r\n    var o = {\r\n        tokens: t\r\n    }\r\n\r\n    // Value\r\n    if (value) {\r\n        var d = ''+value;\r\n        var splitStr = (d.indexOf('T') !== -1) ? 'T' : ' ';\r\n        d = d.split(splitStr);\r\n \r\n        var h = 0;\r\n        var m = 0;\r\n        var s = 0;\r\n\r\n        if (d[1]) {\r\n            h = d[1].split(':');\r\n            m = h[1] ? h[1] : 0;\r\n            s = h[2] ? h[2] : 0;\r\n            h = h[0] ? h[0] : 0;\r\n        }\r\n\r\n        d = d[0].split('-');\r\n\r\n        if (d[0] && d[1] && d[2] && d[0] > 0 && d[1] > 0 && d[1] < 13 && d[2] > 0 && d[2] < 32) {\r\n\r\n            // Data\r\n            o.data = [ d[0], d[1], d[2], h, m, s ];\r\n\r\n            // Value\r\n            o.value = [];\r\n\r\n            // Calendar instance\r\n            var calendar = new Date(o.data[0], o.data[1]-1, o.data[2], o.data[3], o.data[4], o.data[5]);\r\n\r\n            // Get method\r\n            var get = function(i) {\r\n                // Token\r\n                var t = this.tokens[i];\r\n                // Case token\r\n                var s = t.toUpperCase();\r\n                var v = null;\r\n\r\n                if (s === 'YYYY') {\r\n                    v = this.data[0];\r\n                } else if (s === 'YYY') {\r\n                    v = this.data[0].substring(1,4);\r\n                } else if (s === 'YY') {\r\n                    v = this.data[0].substring(2,4);\r\n                } else if (s === 'Y') {\r\n                    v = this.data[0].substring(3,4);\r\n                } else if (t === 'MON') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3).toUpperCase();\r\n                } else if (t === 'mon') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3).toLowerCase();\r\n                } else if (t === 'MONTH') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].toUpperCase();\r\n                } else if (t === 'month') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].toLowerCase();\r\n                } else if (s === 'MMMMM') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0, 1);\r\n                } else if (s === 'MMMM' || t === 'Month') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()];\r\n                } else if (s === 'MMM' || t == 'Mon') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3);\r\n                } else if (s === 'MM') {\r\n                    v = jSuites.two(this.data[1]);\r\n                } else if (s === 'M') {\r\n                    v = calendar.getMonth()+1;\r\n                } else if (t === 'DAY') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].toUpperCase();\r\n                } else if (t === 'day') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].toLowerCase();\r\n                } else if (s === 'DDDD' || t == 'Day') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()];\r\n                } else if (s === 'DDD') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].substr(0,3);\r\n                } else if (s === 'DD') {\r\n                    v = jSuites.two(this.data[2]);\r\n                } else if (s === 'D') {\r\n                    v = this.data[2];\r\n                } else if (s === 'Q') {\r\n                    v = Math.floor((calendar.getMonth() + 3) / 3);\r\n                } else if (s === 'HH24' || s === 'HH') {\r\n                    v = jSuites.two(this.data[3]);\r\n                } else if (s === 'HH12') {\r\n                    if (this.data[3] > 12) {\r\n                        v = jSuites.two(this.data[3] - 12);\r\n                    } else {\r\n                        v = jSuites.two(this.data[3]);\r\n                    }\r\n                } else if (s === 'H') {\r\n                    v = this.data[3];\r\n                } else if (s === 'MI') {\r\n                    v = jSuites.two(this.data[4]);\r\n                } else if (s === 'SS') {\r\n                    v = jSuites.two(this.data[5]);\r\n                } else if (s === 'MS') {\r\n                    v = calendar.getMilliseconds();\r\n                } else if (s === 'AM/PM') {\r\n                    if (this.data[3] >= 12) {\r\n                        v = 'PM';\r\n                    } else {\r\n                        v = 'AM';\r\n                    }\r\n                } else if (s === 'WD') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()];\r\n                }\r\n\r\n                if (v === null) {\r\n                    this.value[i] = this.tokens[i];\r\n                } else {\r\n                    this.value[i] = v;\r\n                }\r\n            }\r\n\r\n            for (var i = 0; i < o.tokens.length; i++) {\r\n                get.call(o, i);\r\n            }\r\n            // Put pieces together\r\n            value = o.value.join('');\r\n        } else {\r\n            value = '';\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n// Jsuites calendar labels\r\njSuites.calendar.weekdays = [ 'Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday' ];\r\njSuites.calendar.months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\r\njSuites.calendar.weekdaysShort = [ 'Sun','Mon','Tue','Wed','Thu','Fri','Sat' ];\r\njSuites.calendar.monthsShort = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n\r\n\r\njSuites.color = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.color) {\r\n        return el.color.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'color' };\r\n    obj.options = {};\r\n\r\n    var container = null;\r\n    var backdrop = null;\r\n    var content = null;\r\n    var resetButton = null;\r\n    var closeButton = null;\r\n    var tabs = null;\r\n    var jsuitesTabs = null;\r\n\r\n    /**\r\n     * Update options\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        /**\r\n         * @typedef {Object} defaults\r\n         * @property {(string|Array)} value - Initial value of the compontent\r\n         * @property {string} placeholder - The default instruction text on the element\r\n         * @property {requestCallback} onchange - Method to be execute after any changes on the element\r\n         * @property {requestCallback} onclose - Method to be execute when the element is closed\r\n         * @property {string} doneLabel - Label for button done\r\n         * @property {string} resetLabel - Label for button reset\r\n         * @property {string} resetValue - Value for button reset\r\n         * @property {Bool} showResetButton - Active or note for button reset - default false\r\n         */\r\n        var defaults = {\r\n            placeholder: '',\r\n            value: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onchange: null,\r\n            closeOnChange: true,\r\n            palette: null,\r\n            position: null,\r\n            doneLabel: 'Done',\r\n            resetLabel: 'Reset',\r\n            fullscreen: false,\r\n            opened: false,\r\n        }\r\n\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        if (options && ! options.palette) {\r\n            // Default pallete\r\n            options.palette = jSuites.palette();\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Update the text of the controls, if they have already been created\r\n        if (resetButton) {\r\n            resetButton.innerHTML = obj.options.resetLabel;\r\n        }\r\n        if (closeButton) {\r\n            closeButton.innerHTML = obj.options.doneLabel;\r\n        }\r\n\r\n        // Update the pallete\r\n        if (obj.options.palette && jsuitesTabs) {\r\n            jsuitesTabs.updateContent(0, table());\r\n        }\r\n\r\n        // Value\r\n        if (typeof obj.options.value === 'string') {\r\n            el.value = obj.options.value;\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            if (el.getAttribute('placeholder')) {\r\n                el.removeAttribute('placeholder');\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Open color pallete\r\n     */\r\n    obj.open = function() {\r\n        if (! container.classList.contains('jcolor-focus')) {\r\n            // Start tracking\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Show colorpicker\r\n            container.classList.add('jcolor-focus');\r\n\r\n            var rectContent = content.getBoundingClientRect();\r\n\r\n            if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen == true) {\r\n                content.style.top = '';\r\n                content.classList.add('jcolor-fullscreen');\r\n                jSuites.animation.slideBottom(content, 1);\r\n                backdrop.style.display = 'block';\r\n            } else {\r\n                if (content.classList.contains('jcolor-fullscreen')) {\r\n                    content.classList.remove('jcolor-fullscreen');\r\n                    backdrop.style.display = '';\r\n                }\r\n\r\n                var rect = el.getBoundingClientRect();\r\n\r\n                if (obj.options.position) {\r\n                    content.style.position = 'fixed';\r\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                        content.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                    } else {\r\n                        content.style.top = (rect.top + rect.height + 2) + 'px';\r\n                    }\r\n                    content.style.left = rect.left + 'px';\r\n                } else {\r\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                        content.style.top = -1 * (rectContent.height + rect.height + 2) + 'px';\r\n                    } else {\r\n                        content.style.top = '2px';\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (typeof(obj.options.onopen) == 'function') {\r\n                obj.options.onopen(el);\r\n            }\r\n\r\n            jsuitesTabs.setBorder(jsuitesTabs.getActive());\r\n\r\n            // Update sliders\r\n            if (obj.options.value) {\r\n                var rgb = HexToRgb(obj.options.value);\r\n\r\n                rgbInputs.forEach(function(rgbInput, index) {\r\n                    rgbInput.value = rgb[index];\r\n                    rgbInput.dispatchEvent(new Event('input'));\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Close color pallete\r\n     */\r\n    obj.close = function(ignoreEvents) {\r\n        if (container.classList.contains('jcolor-focus')) {\r\n            // Remove focus\r\n            container.classList.remove('jcolor-focus');\r\n            // Make sure backdrop is hidden\r\n            backdrop.style.display = '';\r\n            // Call related events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Stop  the object\r\n            jSuites.tracking(obj, false);\r\n        }\r\n\r\n        return obj.options.value;\r\n    }\r\n\r\n    /**\r\n     * Set value\r\n     */\r\n    obj.setValue = function(color) {\r\n        if (! color) {\r\n            color = '';\r\n        }\r\n\r\n        if (color != obj.options.value) {\r\n            obj.options.value = color;\r\n            slidersResult = color;\r\n\r\n            // Remove current selecded mark\r\n            var selected = container.querySelector('.jcolor-selected');\r\n            if (selected) {\r\n                selected.classList.remove('jcolor-selected');\r\n            }\r\n\r\n            // Mark cell as selected\r\n            if (obj.values[color]) {\r\n                obj.values[color].classList.add('jcolor-selected');\r\n            }\r\n\r\n            // Onchange\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, color);\r\n            }\r\n\r\n            // Changes\r\n            if (el.value != obj.options.value) {\r\n                // Set input value\r\n                el.value = obj.options.value;\r\n                // Element onchange native\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (obj.options.closeOnChange == true) {\r\n                obj.close();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get value\r\n     */\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var backdropClickControl = false;\r\n\r\n    // Converts a number in decimal to hexadecimal\r\n    var decToHex = function(num) {\r\n        var hex = num.toString(16);\r\n        return hex.length === 1 ? \"0\" + hex : hex;\r\n    }\r\n\r\n    // Converts a color in rgb to hexadecimal\r\n    var rgbToHex = function(r, g, b) {\r\n        return \"#\" + decToHex(r) + decToHex(g) + decToHex(b);\r\n    }\r\n\r\n    // Converts a number in hexadecimal to decimal\r\n    var hexToDec = function(hex) {\r\n        return parseInt('0x' + hex);\r\n    }\r\n\r\n    // Converts a color in hexadecimal to rgb\r\n    var HexToRgb = function(hex) {\r\n        return [hexToDec(hex.substr(1, 2)), hexToDec(hex.substr(3, 2)), hexToDec(hex.substr(5, 2))]\r\n    }\r\n\r\n    var table = function() {\r\n        // Content of the first tab\r\n        var tableContainer = document.createElement('div');\r\n        tableContainer.className = 'jcolor-grid';\r\n\r\n        // Cells\r\n        obj.values = [];\r\n\r\n        // Table pallete\r\n        var t = document.createElement('table');\r\n        t.setAttribute('cellpadding', '7');\r\n        t.setAttribute('cellspacing', '0');\r\n\r\n        for (var j = 0; j < obj.options.palette.length; j++) {\r\n            var tr = document.createElement('tr');\r\n            for (var i = 0; i < obj.options.palette[j].length; i++) {\r\n                var td = document.createElement('td');\r\n                var color = obj.options.palette[j][i];\r\n                if (color.length < 7 && color.substr(0,1) !== '#') {\r\n                    color = '#' + color;\r\n                }\r\n                td.style.backgroundColor = color;\r\n                td.setAttribute('data-value', color);\r\n                td.innerHTML = '';\r\n                tr.appendChild(td);\r\n\r\n                // Selected color\r\n                if (obj.options.value == color) {\r\n                    td.classList.add('jcolor-selected');\r\n                }\r\n\r\n                // Possible values\r\n                obj.values[color] = td;\r\n            }\r\n            t.appendChild(tr);\r\n        }\r\n\r\n        // Append to the table\r\n        tableContainer.appendChild(t);\r\n\r\n        // Select color\r\n        tableContainer.addEventListener(\"mousedown\", function(e) {\r\n            if (e.target.tagName == 'TD') {\r\n                var value = e.target.getAttribute('data-value');\r\n                if (value) {\r\n                    obj.setValue(value);\r\n                }\r\n            }\r\n        });\r\n\r\n        return tableContainer;\r\n    }\r\n\r\n    // Canvas where the image will be rendered\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = 200;\r\n    canvas.height = 160;\r\n    var context = canvas.getContext(\"2d\");\r\n\r\n    var resizeCanvas = function() {\r\n        // Specifications necessary to correctly obtain colors later in certain positions\r\n        var m = tabs.firstChild.getBoundingClientRect();\r\n        canvas.width = m.width - 14;\r\n        gradient()\r\n    }\r\n\r\n    var gradient = function() {\r\n        var g = context.createLinearGradient(0, 0, canvas.width, 0);\r\n        // Create color gradient\r\n        g.addColorStop(0,    \"rgb(255,0,0)\");\r\n        g.addColorStop(0.15, \"rgb(255,0,255)\");\r\n        g.addColorStop(0.33, \"rgb(0,0,255)\");\r\n        g.addColorStop(0.49, \"rgb(0,255,255)\");\r\n        g.addColorStop(0.67, \"rgb(0,255,0)\");\r\n        g.addColorStop(0.84, \"rgb(255,255,0)\");\r\n        g.addColorStop(1,    \"rgb(255,0,0)\");\r\n        context.fillStyle = g;\r\n        context.fillRect(0, 0, canvas.width, canvas.height);\r\n        g = context.createLinearGradient(0, 0, 0, canvas.height);\r\n        g.addColorStop(0,   \"rgba(255,255,255,1)\");\r\n        g.addColorStop(0.5, \"rgba(255,255,255,0)\");\r\n        g.addColorStop(0.5, \"rgba(0,0,0,0)\");\r\n        g.addColorStop(1,   \"rgba(0,0,0,1)\");\r\n        context.fillStyle = g;\r\n        context.fillRect(0, 0, canvas.width, canvas.height);\r\n    }\r\n\r\n    var hsl = function() {\r\n        var element = document.createElement('div');\r\n        element.className = \"jcolor-hsl\";\r\n\r\n        var point = document.createElement('div');\r\n        point.className = 'jcolor-point';\r\n\r\n        var div = document.createElement('div');\r\n        div.appendChild(canvas);\r\n        div.appendChild(point);\r\n        element.appendChild(div);\r\n\r\n        // Moves the marquee point to the specified position\r\n        var update = function(buttons, x, y) {\r\n            if (buttons === 1) {\r\n                var rect = element.getBoundingClientRect();\r\n                var left = x - rect.left;\r\n                var top = y - rect.top;\r\n                if (left < 0) {\r\n                    left = 0;\r\n                }\r\n                if (top < 0) {\r\n                    top = 0;\r\n                }\r\n                if (left > rect.width) {\r\n                    left = rect.width;\r\n                }\r\n                if (top > rect.height) {\r\n                    top = rect.height;\r\n                }\r\n                point.style.left = left + 'px';\r\n                point.style.top = top + 'px';\r\n                var pixel = context.getImageData(left, top, 1, 1).data;\r\n                slidersResult = rgbToHex(pixel[0], pixel[1], pixel[2]);\r\n            }\r\n        }\r\n\r\n        // Applies the point's motion function to the div that contains it\r\n        element.addEventListener('mousedown', function(e) {\r\n            update(e.buttons, e.clientX, e.clientY);\r\n        });\r\n\r\n        element.addEventListener('mousemove', function(e) {\r\n            update(e.buttons, e.clientX, e.clientY);\r\n        });\r\n\r\n        element.addEventListener('touchmove', function(e) {\r\n            update(1, e.changedTouches[0].clientX, e.changedTouches[0].clientY);\r\n        });\r\n\r\n        return element;\r\n    }\r\n\r\n    var slidersResult = '';\r\n\r\n    var rgbInputs = [];\r\n\r\n    var changeInputColors = function() {\r\n        if (slidersResult !== '') {\r\n            for (var j = 0; j < rgbInputs.length; j++) {\r\n                var currentColor = HexToRgb(slidersResult);\r\n\r\n                currentColor[j] = 0;\r\n\r\n                var newGradient = 'linear-gradient(90deg, rgb(';\r\n                newGradient += currentColor.join(', ');\r\n                newGradient += '), rgb(';\r\n\r\n                currentColor[j] = 255;\r\n\r\n                newGradient += currentColor.join(', ');\r\n                newGradient += '))';\r\n\r\n                rgbInputs[j].style.backgroundImage = newGradient;\r\n            }\r\n        }\r\n    }\r\n\r\n    var sliders = function() {\r\n        // Content of the third tab\r\n        var slidersElement = document.createElement('div');\r\n        slidersElement.className = 'jcolor-sliders';\r\n\r\n        var slidersBody = document.createElement('div');\r\n\r\n        // Creates a range-type input with the specified name\r\n        var createSliderInput = function(name) {\r\n            var inputContainer = document.createElement('div');\r\n            inputContainer.className = 'jcolor-sliders-input-container';\r\n\r\n            var label = document.createElement('label');\r\n            label.innerText = name;\r\n\r\n            var subContainer = document.createElement('div');\r\n            subContainer.className = 'jcolor-sliders-input-subcontainer';\r\n\r\n            var input = document.createElement('input');\r\n            input.type = 'range';\r\n            input.min = 0;\r\n            input.max = 255;\r\n            input.value = 0;\r\n\r\n            inputContainer.appendChild(label);\r\n            subContainer.appendChild(input);\r\n\r\n            var value = document.createElement('div');\r\n            value.innerText = input.value;\r\n\r\n            input.addEventListener('input', function() {\r\n                value.innerText = input.value;\r\n            });\r\n\r\n            subContainer.appendChild(value);\r\n            inputContainer.appendChild(subContainer);\r\n\r\n            slidersBody.appendChild(inputContainer);\r\n\r\n            return input;\r\n        }\r\n\r\n        // Creates red, green and blue inputs\r\n        rgbInputs = [\r\n            createSliderInput('Red'),\r\n            createSliderInput('Green'),\r\n            createSliderInput('Blue'),\r\n        ];\r\n\r\n        slidersElement.appendChild(slidersBody);\r\n\r\n        // Element that prints the current color\r\n        var slidersResultColor = document.createElement('div');\r\n        slidersResultColor.className = 'jcolor-sliders-final-color';\r\n\r\n        var resultElement = document.createElement('div');\r\n        resultElement.style.visibility = 'hidden';\r\n        resultElement.innerText = 'a';\r\n        slidersResultColor.appendChild(resultElement)\r\n\r\n        // Update the element that prints the current color\r\n        var updateResult = function() {\r\n            var resultColor = rgbToHex(parseInt(rgbInputs[0].value), parseInt(rgbInputs[1].value), parseInt(rgbInputs[2].value));\r\n\r\n            resultElement.innerText = resultColor;\r\n            resultElement.style.color = resultColor;\r\n            resultElement.style.removeProperty('visibility');\r\n\r\n            slidersResult = resultColor;\r\n        }\r\n\r\n        // Apply the update function to color inputs\r\n        rgbInputs.forEach(function(rgbInput) {\r\n            rgbInput.addEventListener('input', function() {\r\n                updateResult();\r\n                changeInputColors();\r\n            });\r\n        });\r\n\r\n        slidersElement.appendChild(slidersResultColor);\r\n\r\n        return slidersElement;\r\n    }\r\n\r\n    var init = function() {\r\n        // Initial options\r\n        obj.setOptions(options);\r\n\r\n        // Add a proper input tag when the element is an input\r\n        if (el.tagName == 'INPUT') {\r\n            el.classList.add('jcolor-input');\r\n            el.readOnly = true;\r\n        }\r\n\r\n        // Table container\r\n        container = document.createElement('div');\r\n        container.className = 'jcolor';\r\n\r\n        // Table container\r\n        backdrop = document.createElement('div');\r\n        backdrop.className = 'jcolor-backdrop';\r\n        container.appendChild(backdrop);\r\n\r\n        // Content\r\n        content = document.createElement('div');\r\n        content.className = 'jcolor-content';\r\n\r\n        // Controls\r\n        var controls = document.createElement('div');\r\n        controls.className = 'jcolor-controls';\r\n        content.appendChild(controls);\r\n\r\n        // Reset button\r\n        resetButton  = document.createElement('div');\r\n        resetButton.className = 'jcolor-reset';\r\n        resetButton.innerHTML = obj.options.resetLabel;\r\n        resetButton.onclick = function(e) {\r\n            obj.setValue('');\r\n            obj.close();\r\n        }\r\n        controls.appendChild(resetButton);\r\n\r\n        // Close button\r\n        closeButton  = document.createElement('div');\r\n        closeButton.className = 'jcolor-close';\r\n        closeButton.innerHTML = obj.options.doneLabel;\r\n        closeButton.onclick = function(e) {\r\n            if (jsuitesTabs.getActive() > 0) {\r\n                obj.setValue(slidersResult);\r\n            }\r\n            obj.close();\r\n        }\r\n        controls.appendChild(closeButton);\r\n\r\n        // Element that will be used to create the tabs\r\n        tabs = document.createElement('div');\r\n        content.appendChild(tabs);\r\n\r\n        // Starts the jSuites tabs component\r\n        jsuitesTabs = jSuites.tabs(tabs, {\r\n            animation: true,\r\n            data: [\r\n                {\r\n                    title: 'Grid',\r\n                    contentElement: table(),\r\n                },\r\n                {\r\n                    title: 'Spectrum',\r\n                    contentElement: hsl(),\r\n                },\r\n                {\r\n                    title: 'Sliders',\r\n                    contentElement: sliders(),\r\n                }\r\n            ],\r\n            onchange: function(element, instance, index) {\r\n                if (index === 1) {\r\n                    resizeCanvas();\r\n                } else {\r\n                    var color = slidersResult !== '' ? slidersResult : obj.getValue();\r\n\r\n                    if (index === 2 && color) {\r\n                        var rgb = HexToRgb(color);\r\n\r\n                        rgbInputs.forEach(function(rgbInput, index) {\r\n                            rgbInput.value = rgb[index];\r\n                            rgbInput.dispatchEvent(new Event('input'));\r\n                        });\r\n                    }\r\n                }\r\n            },\r\n            palette: 'modern',\r\n        });\r\n\r\n        container.appendChild(content);\r\n\r\n        // Insert picker after the element\r\n        if (el.tagName == 'INPUT') {\r\n            el.parentNode.insertBefore(container, el.nextSibling);\r\n        } else {\r\n            el.appendChild(container);\r\n        }\r\n\r\n        /**\r\n         * If element is focus open the picker\r\n         */\r\n        el.addEventListener(\"mouseup\", function(e) {\r\n            obj.open();\r\n        });\r\n\r\n        backdrop.addEventListener(\"mousedown\", function(e) {\r\n            backdropClickControl = true;\r\n        });\r\n\r\n        backdrop.addEventListener(\"mouseup\", function(e) {\r\n            if (backdropClickControl) {\r\n                obj.close();\r\n                backdropClickControl = false;\r\n            }\r\n        });\r\n\r\n        // If the picker is open on the spectrum tab, it changes the canvas size when the window size is changed\r\n        window.addEventListener('resize', function() {\r\n            if (container.classList.contains('jcolor-focus') && jsuitesTabs.getActive() == 1) {\r\n                resizeCanvas();\r\n            }\r\n        });\r\n\r\n        // Default opened\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.color = obj;\r\n\r\n        // Container shortcut\r\n        container.color = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n\r\njSuites.contextmenu = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        items: null,\r\n        onclick: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class definition\r\n    el.classList.add('jcontextmenu');\r\n    // Focusable\r\n    el.setAttribute('tabindex', '900');\r\n\r\n    /**\r\n     * Open contextmenu\r\n     */\r\n    obj.open = function(e, items) {\r\n        if (items) {\r\n            // Update content\r\n            obj.options.items = items;\r\n            // Create items\r\n            obj.create(items);\r\n        }\r\n\r\n        // Coordinates\r\n        if ((obj.options.items && obj.options.items.length > 0) || el.children.length) {\r\n            if (e.target) {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            } else {\r\n                var x = e.x;\r\n                var y = e.y;\r\n            }\r\n\r\n            el.classList.add('jcontextmenu-focus');\r\n            el.focus();\r\n\r\n            var rect = el.getBoundingClientRect();\r\n\r\n            if (window.innerHeight < y + rect.height) {\r\n                var h = y - rect.height;\r\n                if (h < 0) {\r\n                    h = 0;\r\n                }\r\n                el.style.top = h + 'px';\r\n            } else {\r\n                el.style.top = y + 'px';\r\n            }\r\n\r\n            if (window.innerWidth < x + rect.width) {\r\n                if (x - rect.width > 0) {\r\n                    el.style.left = (x - rect.width) + 'px';\r\n                } else {\r\n                    el.style.left = '10px';\r\n                }\r\n            } else {\r\n                el.style.left = x + 'px';\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Close menu\r\n     */\r\n    obj.close = function() {\r\n        if (el.classList.contains('jcontextmenu-focus')) {\r\n            el.classList.remove('jcontextmenu-focus');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create items based on the declared objectd\r\n     * @param {object} items - List of object\r\n     */\r\n    obj.create = function(items) {\r\n        // Update content\r\n        el.innerHTML = '';\r\n\r\n        // Append items\r\n        for (var i = 0; i < items.length; i++) {\r\n            var itemContainer = createItemElement(items[i]);\r\n            el.appendChild(itemContainer);\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Private function for create a new Item element\r\n     * @param {type} item\r\n     * @returns {jsuitesL#15.jSuites.contextmenu.createItemElement.itemContainer}\r\n     */\r\n    function createItemElement(item) {\r\n        if (item.type && (item.type == 'line' || item.type == 'divisor')) {\r\n            var itemContainer = document.createElement('hr');\r\n        } else {\r\n            var itemContainer = document.createElement('div');\r\n            var itemText = document.createElement('a');\r\n            itemText.innerHTML = item.title;\r\n\r\n            if (item.tooltip) {\r\n                itemContainer.setAttribute('title', item.tooltip);\r\n            }\r\n\r\n            if (item.icon) {\r\n                itemContainer.setAttribute('data-icon', item.icon);\r\n            }\r\n\r\n            if (item.id) {\r\n                itemContainer.id = item.id;\r\n            }\r\n\r\n            if (item.disabled) {\r\n                itemContainer.className = 'jcontextmenu-disabled';\r\n            } else if (item.onclick) {\r\n                itemContainer.method = item.onclick;\r\n                itemContainer.addEventListener(\"mousedown\", function(e) {\r\n                    e.preventDefault();\r\n                });\r\n                itemContainer.addEventListener(\"mouseup\", function() {\r\n                    // Execute method\r\n                    this.method(this);\r\n                });\r\n            }\r\n            itemContainer.appendChild(itemText);\r\n\r\n            if (item.submenu) {\r\n                var itemIconSubmenu = document.createElement('span');\r\n                itemIconSubmenu.innerHTML = \"&#9658;\";\r\n                itemContainer.appendChild(itemIconSubmenu);\r\n                itemContainer.classList.add('jcontexthassubmenu');\r\n                var el_submenu = document.createElement('div');\r\n                // Class definition\r\n                el_submenu.classList.add('jcontextmenu');\r\n                // Focusable\r\n                el_submenu.setAttribute('tabindex', '900');\r\n                \r\n                // Append items\r\n                var submenu = item.submenu;\r\n                for (var i = 0; i < submenu.length; i++) {\r\n                    var itemContainerSubMenu = createItemElement(submenu[i]);\r\n                    el_submenu.appendChild(itemContainerSubMenu);\r\n                }\r\n\r\n                itemContainer.appendChild(el_submenu);\r\n            } else if (item.shortcut) {\r\n                var itemShortCut = document.createElement('span');\r\n                itemShortCut.innerHTML = item.shortcut;\r\n                itemContainer.appendChild(itemShortCut);\r\n            }\r\n        }\r\n        return itemContainer;\r\n    }\r\n\r\n    if (typeof(obj.options.onclick) == 'function') {\r\n        el.addEventListener('click', function(e) {\r\n            obj.options.onclick(obj, e);\r\n        });\r\n    }\r\n\r\n    // Create items\r\n    if (obj.options.items) {\r\n        obj.create(obj.options.items);\r\n    }\r\n\r\n    el.addEventListener('blur', function(e) {\r\n        obj.close();\r\n    });\r\n\r\n    if (! jSuites.contextmenu.hasEvents) {\r\n        window.addEventListener(\"mousewheel\", function() {\r\n            obj.close();\r\n        });\r\n\r\n        document.addEventListener(\"contextmenu\", function(e) {\r\n            var id = jSuites.contextmenu.getElement(e.target);\r\n            if (id) {\r\n                var element = document.querySelector('#' + id);\r\n                if (! element) {\r\n                    console.error('JSUITES: Contextmenu id not found');\r\n                } else {\r\n                    element.contextmenu.open(e);\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        });\r\n\r\n        jSuites.contextmenu.hasEvents = true;\r\n    }\r\n\r\n    el.contextmenu = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.contextmenu.getElement = function(element) {\r\n    var foundId = 0;\r\n\r\n    function path (element) {\r\n        if (element.parentNode && element.getAttribute('aria-contextmenu-id')) {\r\n            foundId = element.getAttribute('aria-contextmenu-id')\r\n        } else {\r\n            if (element.parentNode) {\r\n                path(element.parentNode);\r\n            }\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return foundId;\r\n}\r\n\r\njSuites.dropdown = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.dropdown) {\r\n        return el.dropdown.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'dropdown' };\r\n    obj.options = {};\r\n\r\n    // Success\r\n    var success = function(data, val) {\r\n        // Set data\r\n        if (data && data.length) {\r\n            // Sort\r\n            if (obj.options.sortResults !== false) {\r\n                if(typeof obj.options.sortResults == \"function\") {\r\n                    data.sort(obj.options.sortResults);\r\n                } else {\r\n                    data.sort(sortData);\r\n                }\r\n            }\r\n\r\n            obj.setData(data);\r\n\r\n            // Onload method\r\n            if (typeof(obj.options.onload) == 'function') {\r\n                obj.options.onload(el, obj, data, val);\r\n            }\r\n        }\r\n\r\n        // Set value\r\n        if (val) {\r\n            applyValue(val);\r\n        }\r\n\r\n        // Component value\r\n        if (val === undefined || val === null) {\r\n            obj.options.value = '';\r\n        }\r\n        el.value = obj.options.value;\r\n\r\n        // Open dropdown\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    \r\n    // Default sort\r\n    var sortData = function(itemA, itemB) {\r\n        var testA, testB;\r\n        if(typeof itemA == \"string\") {\r\n            testA = itemA;\r\n        } else {\r\n            if(itemA.text) {\r\n                testA = itemA.text;\r\n            } else if(itemA.name) {\r\n                testA = itemA.name;\r\n            }\r\n        }\r\n        \r\n        if(typeof itemB == \"string\") {\r\n            testB = itemB;\r\n        } else {\r\n            if(itemB.text) {\r\n                testB = itemB.text;\r\n            } else if(itemB.name) {\r\n                testB = itemB.name;\r\n            }\r\n        }\r\n        \r\n        if(typeof testA == \"string\" || typeof testB == \"string\") {\r\n            if(typeof testA != \"string\") { testA = \"\"+testA; }\r\n            if(typeof testB != \"string\") { testB = \"\"+testB; }\r\n            return testA.localeCompare(testB);\r\n        } else {\r\n            return testA - testB;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reset the options for the dropdown\r\n     */\r\n    var resetValue = function() {\r\n        // Reset value container\r\n        obj.value = {};\r\n        // Remove selected\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (obj.items[i].selected == true) {\r\n                if (obj.items[i].element) {\r\n                    obj.items[i].element.classList.remove('jdropdown-selected')\r\n                }\r\n                obj.items[i].selected = null;\r\n            }\r\n        }\r\n        // Reset options\r\n        obj.options.value = '';\r\n    }\r\n\r\n    /**\r\n     * Apply values to the dropdown\r\n     */\r\n    var applyValue = function(values) {\r\n        // Reset the current values\r\n        resetValue();\r\n\r\n        // Read values\r\n        if (values !== null) {\r\n            if (! values) {\r\n                if (typeof(obj.value['']) !== 'undefined') {\r\n                    obj.value[''] = '';\r\n                }\r\n            } else {\r\n                if (! Array.isArray(values)) {\r\n                    values = ('' + values).split(';');\r\n                }\r\n                for (var i = 0; i < values.length; i++) {\r\n                    obj.value[values[i]] = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Update the DOM\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (typeof(obj.value[Value(i)]) !== 'undefined') {\r\n                if (obj.items[i].element) {\r\n                    obj.items[i].element.classList.add('jdropdown-selected')\r\n                }\r\n                obj.items[i].selected = true;\r\n\r\n                // Keep label\r\n                obj.value[Value(i)] = Text(i);\r\n            }\r\n        }\r\n\r\n        // Global value\r\n        obj.options.value = Object.keys(obj.value).join(';');\r\n\r\n        // Update labels\r\n        obj.header.value = obj.getText();\r\n    }\r\n\r\n    // Get the value of one item\r\n    var Value = function(k, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'value';\r\n        } else {\r\n            var property = 'id';\r\n        }\r\n\r\n        if (obj.items[k]) {\r\n            if (v !== undefined) {\r\n                return obj.items[k].data[property] = v;\r\n            } else {\r\n                return obj.items[k].data[property];\r\n            }\r\n        }\r\n\r\n        return '';\r\n    }\r\n\r\n    // Get the label of one item\r\n    var Text = function(k, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'text';\r\n        } else {\r\n            var property = 'name';\r\n        }\r\n\r\n        if (obj.items[k]) {\r\n            if (v !== undefined) {\r\n                return obj.items[k].data[property] = v;\r\n            } else {\r\n                return obj.items[k].data[property];\r\n            }\r\n        }\r\n\r\n        return '';\r\n    }\r\n\r\n    var getValue = function() {\r\n        return Object.keys(obj.value);\r\n    }\r\n\r\n    var getText = function() {\r\n        var data = [];\r\n        var k = Object.keys(obj.value);\r\n        for (var i = 0; i < k.length; i++) {\r\n            data.push(obj.value[k[i]]);\r\n        }\r\n        return data;\r\n    }\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        // Default configuration\r\n        var defaults = {\r\n            url: null,\r\n            data: [],\r\n            format: 0,\r\n            multiple: false,\r\n            autocomplete: false,\r\n            remoteSearch: false,\r\n            lazyLoading: false,\r\n            type: null,\r\n            width: null,\r\n            maxWidth: null,\r\n            opened: false,\r\n            value: null,\r\n            placeholder: '',\r\n            newOptions: false,\r\n            position: false,\r\n            onchange: null,\r\n            onload: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onfocus: null,\r\n            onblur: null,\r\n            oninsert: null,\r\n            onbeforeinsert: null,\n            sortResults: false,\n            autofocus: false,\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Force autocomplete search\r\n        if (obj.options.remoteSearch == true || obj.options.type === 'searchbar') {\r\n            obj.options.autocomplete = true;\r\n        }\r\n\r\n        // New options\r\n        if (obj.options.newOptions == true) {\r\n            obj.header.classList.add('jdropdown-add');\r\n        } else {\r\n            obj.header.classList.remove('jdropdown-add');\r\n        }\r\n\r\n        // Autocomplete\r\n        if (obj.options.autocomplete == true) {\r\n            obj.header.removeAttribute('readonly');\r\n        } else {\r\n            obj.header.setAttribute('readonly', 'readonly');\r\n        }\r\n\r\n        // Place holder\r\n        if (obj.options.placeholder) {\r\n            obj.header.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            obj.header.removeAttribute('placeholder');\r\n        }\r\n\r\n        // Remove specific dropdown typing to add again\r\n        el.classList.remove('jdropdown-searchbar');\r\n        el.classList.remove('jdropdown-picker');\r\n        el.classList.remove('jdropdown-list');\r\n\r\n        if (obj.options.type == 'searchbar') {\r\n            el.classList.add('jdropdown-searchbar');\r\n        } else if (obj.options.type == 'list') {\r\n            el.classList.add('jdropdown-list');\r\n        } else if (obj.options.type == 'picker') {\r\n            el.classList.add('jdropdown-picker');\r\n        } else {\r\n            if (jSuites.getWindowWidth() < 800) {\r\n                if (obj.options.autocomplete) {\r\n                    el.classList.add('jdropdown-searchbar');\r\n                    obj.options.type = 'searchbar';\r\n                } else {\r\n                    el.classList.add('jdropdown-picker');\r\n                    obj.options.type = 'picker';\r\n                }\r\n            } else {\r\n                if (obj.options.width) {\r\n                    el.style.width = obj.options.width;\r\n                    el.style.minWidth = obj.options.width;\r\n                } else {\r\n                    el.style.removeProperty('width');\r\n                    el.style.removeProperty('min-width');\r\n                }\r\n\r\n                el.classList.add('jdropdown-default');\r\n                obj.options.type = 'default';\r\n            }\r\n        }\r\n\r\n        // Close button\r\n        if (obj.options.type == 'searchbar') {\r\n            containerHeader.appendChild(closeButton);\r\n        } else {\r\n            container.insertBefore(closeButton, container.firstChild);\r\n        }\r\n\r\n        // Load the content\r\n        if (obj.options.url && ! options.data) {\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    if (data) {\r\n                        success(data, obj.options.value);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            success(obj.options.data, obj.options.value);\r\n        }\r\n\r\n        // Return the instance\r\n        return obj;\r\n    }\r\n\r\n    // Helpers\r\n    var containerHeader = null;\r\n    var container = null;\r\n    var content = null;\r\n    var closeButton = null;\r\n    var resetButton = null;\r\n    var backdrop = null;\r\n\r\n    var keyTimer = null;\r\n\r\n    /**\r\n     * Init dropdown\r\n     */\r\n    var init = function() {\r\n        // Do not accept null\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        // If the element is a SELECT tag, create a configuration object\r\n        if (el.tagName == 'SELECT') {\r\n            var ret = jSuites.dropdown.extractFromDom(el, options);\r\n            el = ret.el;\r\n            options = ret.options;\r\n        }\r\n\r\n        // Place holder\r\n        if (! options.placeholder && el.getAttribute('placeholder')) {\r\n            options.placeholder = el.getAttribute('placeholder');\r\n        }\r\n\r\n        // Value container\r\n        obj.value = {};\r\n        // Containers\r\n        obj.items = [];\r\n        obj.groups = [];\r\n        // Search options\r\n        obj.search = '';\r\n        obj.results = null;\r\n\r\n        // Create dropdown\r\n        el.classList.add('jdropdown');\r\n\r\n        // Header container\r\n        containerHeader = document.createElement('div');\r\n        containerHeader.className = 'jdropdown-container-header';\r\n\r\n        // Header\r\n        obj.header = document.createElement('input');\r\n        obj.header.className = 'jdropdown-header';\r\n        obj.header.type = 'text';\r\n        obj.header.setAttribute('autocomplete', 'off');\r\n        obj.header.onfocus = function() {\r\n            if (typeof(obj.options.onfocus) == 'function') {\r\n                obj.options.onfocus(el);\r\n            }\r\n        }\r\n\r\n        obj.header.onblur = function() {\r\n            if (typeof(obj.options.onblur) == 'function') {\r\n                obj.options.onblur(el);\r\n            }\r\n        }\r\n\r\n        obj.header.onkeyup = function(e) {\r\n            if (obj.options.autocomplete == true && ! keyTimer) {\r\n                if (obj.search != obj.header.value.trim()) {\r\n                    keyTimer = setTimeout(function() {\r\n                        obj.find(obj.header.value.trim());\r\n                        keyTimer = null;\r\n                    }, 400);\r\n                }\r\n\r\n                if (! el.classList.contains('jdropdown-focus')) {\r\n                    obj.open();\r\n                }\r\n            } else {\r\n                if (! obj.options.autocomplete) {\r\n                    obj.next(e.key);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Global controls\r\n        if (! jSuites.dropdown.hasEvents) {\r\n            // Execute only one time\r\n            jSuites.dropdown.hasEvents = true;\r\n            // Enter and Esc\r\n            document.addEventListener(\"keydown\", jSuites.dropdown.keydown);\r\n        }\r\n\r\n        // Container\r\n        container = document.createElement('div');\r\n        container.className = 'jdropdown-container';\r\n\r\n        // Dropdown content\r\n        content = document.createElement('div');\r\n        content.className = 'jdropdown-content';\r\n\r\n        // Close button\r\n        closeButton = document.createElement('div');\r\n        closeButton.className = 'jdropdown-close';\r\n        closeButton.innerHTML = 'Done';\r\n\r\n        // Reset button\r\n        resetButton = document.createElement('div');\r\n        resetButton.className = 'jdropdown-reset';\r\n        resetButton.innerHTML = 'x';\r\n        resetButton.onclick = function() {\r\n            obj.reset();\r\n            obj.close();\r\n        }\r\n\r\n        // Create backdrop\r\n        backdrop = document.createElement('div');\r\n        backdrop.className = 'jdropdown-backdrop';\r\n\r\n        // Append elements\r\n        containerHeader.appendChild(obj.header);\r\n\r\n        container.appendChild(content);\r\n        el.appendChild(containerHeader);\r\n        el.appendChild(container);\r\n        el.appendChild(backdrop);\r\n\r\n        // Set the otiptions\r\n        obj.setOptions(options);\r\n\r\n        if ('ontouchsend' in document.documentElement === true) {\r\n            el.addEventListener('touchsend', jSuites.dropdown.mouseup);\r\n        } else {\r\n            el.addEventListener('mouseup', jSuites.dropdown.mouseup);\r\n        }\r\n\r\n        // Lazyloading\r\n        if (obj.options.lazyLoading == true) {\r\n            jSuites.lazyLoading(content, {\r\n                loadUp: obj.loadUp,\r\n                loadDown: obj.loadDown,\r\n            });\r\n        }\r\n\r\n        content.onwheel = function(e) {\r\n            e.stopPropagation();\r\n        }\r\n\r\n        // Change method\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue(obj.options.multiple ? true : false);\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.dropdown = obj;\r\n    }\r\n\r\n    /**\r\n     * Get the current remote source of data URL\r\n     */\r\n    obj.getUrl = function() {\r\n        return obj.options.url;\r\n    }\r\n\r\n    /**\r\n     * Set the new data from a remote source\r\n     * @param {string} url - url from the remote source\r\n     * @param {function} callback - callback when the data is loaded\r\n     */\r\n    obj.setUrl = function(url, callback) {\r\n        obj.options.url = url;\r\n\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'json',\r\n            success: function(data) {\r\n                obj.setData(data);\r\n                // Callback\r\n                if (typeof(callback) == 'function') {\r\n                    callback(obj);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Set ID for one item\r\n     */\r\n    obj.setId = function(item, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'value';\r\n        } else {\r\n            var property = 'id';\r\n        }\r\n\r\n        if (typeof(item) == 'object') {\r\n            item[property] = v;\r\n        } else {\r\n            obj.items[item].data[property] = v;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add a new item\r\n     * @param {string} title - title of the new item\r\n     * @param {string} id - value/id of the new item\n     */\r\n    obj.add = function(title, id) {\r\n        if (! title) {\r\n            var current = obj.options.autocomplete == true ? obj.header.value : '';\r\n            var title = prompt(jSuites.translate('Add A New Option'), current);\r\n            if (! title) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Id\r\n        if (! id) {\r\n           id = jSuites.guid();\r\n        }\r\n\r\n        // Create new item\r\n        if (! obj.options.format) {\r\n            var item = {\r\n                value: id,\r\n                text: title,\r\n            }\r\n        } else {\r\n            var item = {\r\n                id: id,\r\n                name: title,\r\n            }\r\n        }\r\n\r\n        // Callback\r\n        if (typeof(obj.options.onbeforeinsert) == 'function') {\r\n            var ret = obj.options.onbeforeinsert(obj, item);\r\n            if (ret === false) {\r\n                return false;\r\n            } else if (ret) {\r\n                item = ret;\r\n            }\r\n        }\n\n        // Add item to the main list\r\n        obj.options.data.push(item);\r\n\r\n        // Create DOM\r\n        var newItem = obj.createItem(item);\r\n\r\n        // Append DOM to the list\r\n        content.appendChild(newItem.element);\r\n\r\n        // Callback\r\n        if (typeof(obj.options.oninsert) == 'function') {\r\n            obj.options.oninsert(obj, item, newItem);\r\n        }\r\n\r\n        // Show content\r\n        if (content.style.display == 'none') {\r\n            content.style.display = '';\r\n        }\r\n\r\n        // Search?\r\n        if (obj.results) {\r\n            obj.results.push(newItem);\r\n        }\r\n\r\n        return item;\r\n    }\r\n\r\n    /**\r\n     * Create a new item\r\n     */\r\n    obj.createItem = function(data, group, groupName) {\r\n        // Keep the correct source of data\r\n        if (! obj.options.format) {\r\n            if (! data.value && data.id !== undefined) {\r\n                data.value = data.id;\r\n                //delete data.id;\r\n            }\r\n            if (! data.text && data.name !== undefined) {\r\n                data.text = data.name;\r\n                //delete data.name;\r\n            }\r\n        } else {\r\n            if (! data.id && data.value !== undefined) {\r\n                data.id = data.value;\r\n                //delete data.value;\r\n            }\r\n            if (! data.name && data.text !== undefined) {\r\n                data.name = data.text\r\n                //delete data.text;\r\n            }\r\n        }\r\n\r\n        // Create item\r\n        var item = {};\r\n        item.element = document.createElement('div');\r\n        item.element.className = 'jdropdown-item';\r\n        item.element.indexValue = obj.items.length;\r\n        item.data = data;\r\n\r\n        // Groupd DOM\r\n        if (group) {\r\n            item.group = group; \r\n        }\r\n\r\n        // Id\r\n        if (data.id) {\r\n            item.element.setAttribute('id', data.id);\r\n        }\r\n\r\n        // Disabled\r\n        if (data.disabled == true) {\r\n            item.element.setAttribute('data-disabled', true);\r\n        }\r\n\r\n        // Tooltip\n        if (data.tooltip) {\n            item.element.setAttribute('title', data.tooltip);\n        }\n\n        // Image\r\n        if (data.image) {\r\n            var image = document.createElement('img');\r\n            image.className = 'jdropdown-image';\r\n            image.src = data.image;\r\n            if (! data.title) {\r\n               image.classList.add('jdropdown-image-small');\r\n            }\r\n            item.element.appendChild(image);\r\n        } else if (data.icon) {\r\n            var icon = document.createElement('span');\r\n            icon.className = \"jdropdown-icon material-icons\";\r\n            icon.innerText = data.icon;\r\n            if (! data.title) {\r\n               icon.classList.add('jdropdown-icon-small');\r\n            }\r\n            if (data.color) {\r\n                icon.style.color = data.color;\r\n            }\r\n            item.element.appendChild(icon);\n        } else if (data.color) {\r\n            var color = document.createElement('div');\r\n            color.className = 'jdropdown-color';\r\n            color.style.backgroundColor = data.color;\r\n            item.element.appendChild(color);\r\n        }\r\n\r\n        // Set content\r\n        if (! obj.options.format) {\r\n            var text = data.text;\r\n        } else {\r\n            var text = data.name;\r\n        }\r\n\r\n        var node = document.createElement('div');\r\n        node.className = 'jdropdown-description';\r\n        node.innerHTML = text || '&nbsp;'; \r\n\r\n        // Title\r\n        if (data.title) {\r\n            var title = document.createElement('div');\r\n            title.className = 'jdropdown-title';\r\n            title.innerText = data.title;\r\n            node.appendChild(title);\r\n        }\r\n\r\n        // Set content\r\n        if (! obj.options.format) {\r\n            var val = data.value;\r\n        } else {\r\n            var val = data.id;\r\n        }\r\n\r\n        // Value\r\n        if (obj.value[val]) {\r\n            item.element.classList.add('jdropdown-selected');\r\n            item.selected = true;\r\n        }\r\n\r\n        // Keep DOM accessible\r\n        obj.items.push(item);\r\n\r\n        // Add node to item\r\n        item.element.appendChild(node);\r\n\r\n        return item;\r\n    }\r\n\r\n    obj.appendData = function(data) {\r\n        // Create elements\r\n        if (data.length) {\r\n            // Helpers\r\n            var items = [];\r\n            var groups = [];\r\n\r\n            // Prepare data\r\n            for (var i = 0; i < data.length; i++) {\r\n                // Process groups\r\n                if (data[i].group) {\r\n                    if (! groups[data[i].group]) {\r\n                        groups[data[i].group] = [];\r\n                    }\r\n                    groups[data[i].group].push(i);\r\n                } else {\r\n                    items.push(i);\r\n                }\r\n            }\r\n\r\n            // Number of items counter\r\n            var counter = 0;\r\n\r\n            // Groups\r\n            var groupNames = Object.keys(groups);\r\n\r\n            // Append groups in case exists\r\n            if (groupNames.length > 0) {\r\n                for (var i = 0; i < groupNames.length; i++) {\r\n                    // Group container\r\n                    var group = document.createElement('div');\r\n                    group.className = 'jdropdown-group';\r\n                    // Group name\r\n                    var groupName = document.createElement('div');\r\n                    groupName.className = 'jdropdown-group-name';\r\n                    groupName.innerHTML = groupNames[i];\r\n                    // Group arrow\r\n                    var groupArrow = document.createElement('i');\r\n                    groupArrow.className = 'jdropdown-group-arrow jdropdown-group-arrow-down';\r\n                    groupName.appendChild(groupArrow);\r\n                    // Group items\r\n                    var groupContent = document.createElement('div');\r\n                    groupContent.className = 'jdropdown-group-items';\r\n                    for (var j = 0; j < groups[groupNames[i]].length; j++) {\r\n                        var item = obj.createItem(data[groups[groupNames[i]][j]], group, groupNames[i]);\r\n\r\n                        if (obj.options.lazyLoading == false || counter < 200) {\r\n                            groupContent.appendChild(item.element);\r\n                            counter++;\r\n                        }\r\n                    }\r\n                    // Group itens\r\n                    group.appendChild(groupName);\r\n                    group.appendChild(groupContent);\r\n                    // Keep group DOM\r\n                    obj.groups.push(group);\r\n                    // Only add to the screen if children on the group\r\n                    if (groupContent.children.length > 0) {\r\n                        // Add DOM to the content\r\n                        content.appendChild(group);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (items.length) {\r\n                for (var i = 0; i < items.length; i++) {\r\n                    var item = obj.createItem(data[items[i]]);\r\n                    if (obj.options.lazyLoading == false || counter < 200) {\r\n                        content.appendChild(item.element);\r\n                        counter++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.setData = function(data) {\r\n        // Prepare data\r\n        if (data.length) {\r\n            for (var i = 0; i < data.length; i++) {\r\n                // Compatibility\r\n                if (typeof(data[i]) != 'object') {\r\n                    // Correct format\r\n                    if (! obj.options.format) {\r\n                        data[i] = {\r\n                            value: data[i],\r\n                            text: data[i]\r\n                        }\r\n                    } else {\r\n                        data[i] = {\r\n                            id: data[i],\r\n                            name: data[i]\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Reset current value\r\n            resetValue();\r\n\r\n            // Make sure the content container is blank\r\n            content.innerHTML = '';\r\n\r\n            // Reset\r\n            obj.header.value = '';\r\n\r\n            // Reset items and values\r\n            obj.items = [];\r\n\r\n            // Append data\r\n            obj.appendData(data);\r\n\r\n            // Update data\r\n            obj.options.data = data;\r\n        }\r\n    }\r\n\r\n    obj.getData = function() {\r\n        return obj.options.data;\r\n    }\r\n\r\n    /**\r\n     * Get position of the item\r\n     */\r\n    obj.getPosition = function(val) {\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (Value(i) == val) {\r\n                return i;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Get dropdown current text\r\n     */\r\n    obj.getText = function(asArray) {\r\n        // Get value\r\n        var v = getText();\r\n        // Return value\r\n        if (asArray) {\r\n            return v;\r\n        } else {\r\n            return v.join('; ');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get dropdown current value\r\n     */\r\n    obj.getValue = function(asArray) {\r\n        // Get value\r\n        var v = getValue();\r\n        // Return value\r\n        if (asArray) {\r\n            return v;\r\n        } else {\r\n            return v.join(';');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Change event\r\n     */\r\n    var change = function(oldValue) {\r\n        // Events\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, obj, oldValue, obj.options.value);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set value\r\n     */\r\n    obj.setValue = function(newValue) {\r\n        // Current value\r\n        var oldValue = obj.getValue();\r\n        // New value\r\n        if (Array.isArray(newValue)) {\r\n            newValue = newValue.join(';')\r\n        }\r\n\r\n        if (oldValue !== newValue) {\r\n            // Set value\r\n            applyValue(newValue);\r\n\r\n            // Change\r\n            change(oldValue);\r\n        }\r\n    }\r\n\r\n    obj.resetSelected = function() {\r\n        obj.setValue(null);\r\n    } \r\n\r\n    obj.selectIndex = function(index, force) {\r\n        // Make sure is a number\r\n        var index = parseInt(index);\r\n\r\n        // Only select those existing elements\r\n        if (obj.items && obj.items[index] && (force === true || obj.items[index].data.disabled !== true)) {\r\n            // Reset cursor to a new position\r\n            obj.setCursor(index, false);\r\n\r\n            // Behaviour\r\n            if (! obj.options.multiple) {\r\n                // Update value\r\n                if (obj.items[index].selected) {\r\n                    obj.setValue(null);\r\n                } else {\r\n                    obj.setValue(Value(index));\r\n                }\r\n\r\n                // Close component\r\n                obj.close();\r\n            } else {\r\n                // Old value\r\n                var oldValue = obj.options.value;\r\n\r\n                // Toggle option\r\n                if (obj.items[index].selected) {\r\n                    obj.items[index].element.classList.remove('jdropdown-selected');\r\n                    obj.items[index].selected = false;\r\n\r\n                    delete obj.value[Value(index)];\r\n                } else {\r\n                    // Select element\r\n                    obj.items[index].element.classList.add('jdropdown-selected');\r\n                    obj.items[index].selected = true;\r\n\r\n                    // Set value\r\n                    obj.value[Value(index)] = Text(index);\r\n                }\r\n\r\n                // Global value\r\n                obj.options.value = Object.keys(obj.value).join(';');\r\n\r\n                // Update labels for multiple dropdown\r\n                if (obj.options.autocomplete == false) {\r\n                    obj.header.value = getText().join('; ');\r\n                }\r\n\r\n                // Events\r\n                change(oldValue);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.selectItem = function(item) {\r\n        obj.selectIndex(item.indexValue);\r\n    }\r\n\r\n    var exists = function(k, result) {\r\n        for (var j = 0; j < result.length; j++) {\r\n            if (! obj.options.format) {\r\n                if (result[j].value == k) {\r\n                    return true;\r\n                }\r\n            } else {\r\n                if (result[j].id == k) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    obj.find = function(str) {\r\n        if (obj.search == str.trim()) {\r\n            return false;\r\n        }\r\n\r\n        // Search term\r\n        obj.search = str;\r\n\r\n        // Reset index\r\n        obj.setCursor();\r\n\r\n        // Remove nodes from all groups\r\n        if (obj.groups.length) {\r\n            for (var i = 0; i < obj.groups.length; i++) {\r\n                obj.groups[i].lastChild.innerHTML = '';\r\n            }\r\n        }\r\n\r\n        // Remove all nodes\r\n        content.innerHTML = '';\r\n\r\n        // Remove current items in the remote search\r\n        if (obj.options.remoteSearch == true) {\r\n            // Reset results\r\n            obj.results = null;\r\n            // URL\r\n            var url = obj.options.url + (obj.options.url.indexOf('?') > 0 ? '&' : '?') + 'q=' + str;\r\n            // Remote search\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Reset items\r\n                    obj.items = [];\r\n\r\n                    // Add the current selected items to the results in case they are not there\r\n                    var current = Object.keys(obj.value);\r\n                    if (current.length) {\r\n                        for (var i = 0; i < current.length; i++) {\r\n                            if (! exists(current[i], result)) {\r\n                                if (! obj.options.format) {\r\n                                    result.unshift({ value: current[i], text: obj.value[current[i]] });\r\n                                } else {\r\n                                    result.unshift({ id: current[i], name: obj.value[current[i]] });\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    // Append data\r\n                    obj.appendData(result);\r\n                    // Show or hide results\r\n                    if (! result.length) {\r\n                        content.style.display = 'none';\r\n                    } else {\r\n                        content.style.display = '';\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            // Search terms\r\n            str = new RegExp(str, 'gi');\r\n\r\n            // Reset search\r\n            var results = [];\r\n\r\n            // Append options\r\n            for (var i = 0; i < obj.items.length; i++) {\r\n                // Item label\r\n                var label = Text(i);\r\n                // Item title\r\n                var title = obj.items[i].data.title || '';\r\n                // Group name\r\n                var groupName = obj.items[i].data.group || '';\r\n                // Synonym\r\n                var synonym = obj.items[i].data.synonym || '';\r\n                if (synonym) {\r\n                    synonym = synonym.join(' ');\r\n                }\r\n\r\n                if (str == null || obj.items[i].selected == true || label.match(str) || title.match(str) || groupName.match(str) || synonym.match(str)) {\r\n                    results.push(obj.items[i]);\r\n                }\r\n            }\r\n\r\n            if (! results.length) {\r\n                content.style.display = 'none';\r\n\r\n                // Results\r\n                obj.results = null;\r\n            } else {\r\n                content.style.display = '';\r\n\r\n                // Results\r\n                obj.results = results;\r\n\r\n                // Show 200 items at once\r\n                var number = results.length || 0;\r\n\r\n                // Lazyloading\r\n                if (obj.options.lazyLoading == true && number > 200) {\r\n                    number = 200;\r\n                }\r\n\r\n                for (var i = 0; i < number; i++) {\r\n                    if (obj.results[i].group) {\r\n                        if (! obj.results[i].group.parentNode) {\r\n                            content.appendChild(obj.results[i].group);\r\n                        }\r\n                        obj.results[i].group.lastChild.appendChild(obj.results[i].element);\r\n                    } else {\r\n                        content.appendChild(obj.results[i].element);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Auto focus\r\n        if (obj.options.autofocus == true) {\r\n            obj.first();\r\n        }\r\n    }\r\n\r\n    obj.open = function() {\r\n        // Focus\r\n        if (! el.classList.contains('jdropdown-focus')) {\r\n            // Current dropdown\r\n            jSuites.dropdown.current = obj;\r\n\r\n            // Start tracking\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Add focus\r\n            el.classList.add('jdropdown-focus');\r\n\r\n            // Animation\r\n            if (jSuites.getWindowWidth() < 800) {\r\n                if (obj.options.type == null || obj.options.type == 'picker') {\r\n                    jSuites.animation.slideBottom(container, 1);\r\n                }\r\n            }\r\n\r\n            // Filter\r\n            if (obj.options.autocomplete == true) {\r\n                obj.header.value = obj.search;\r\n                obj.header.focus();\r\n            }\r\n\r\n            // Set cursor for the first or first selected element\r\n            var k = getValue();\r\n            if (k[0]) {\r\n                var cursor = obj.getPosition(k[0]);\r\n                if (cursor !== false) {\r\n                    obj.setCursor(cursor);\r\n                }\r\n            }\r\n\r\n            // Container Size\r\n            if (! obj.options.type || obj.options.type == 'default') {\r\n                var rect = el.getBoundingClientRect();\r\n                var rectContainer = container.getBoundingClientRect();\r\n\r\n                if (obj.options.position) {\r\n                    container.style.position = 'fixed';\r\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\r\n                        container.style.top = '';\r\n                        container.style.bottom = (window.innerHeight - rect.top ) + 1 + 'px';\r\n                    } else {\r\n                        container.style.top = rect.bottom + 'px';\r\n                        container.style.bottom = '';\r\n                    }\r\n                    container.style.left = rect.left + 'px';\r\n                } else {\r\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\r\n                        container.style.top = '';\r\n                        container.style.bottom = rect.height + 1 + 'px';\r\n                    } else {\r\n                        container.style.top = '';\r\n                        container.style.bottom = '';\r\n                    }\r\n                }\r\n\r\n                container.style.minWidth = rect.width + 'px';\r\n\r\n                if (obj.options.maxWidth) {\r\n                    container.style.maxWidth = obj.options.maxWidth;\r\n                }\r\n\r\n                if (! obj.items.length && obj.options.autocomplete == true) {\r\n                    content.style.display = 'none';\r\n                } else {\r\n                    content.style.display = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Events\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el);\r\n        }\r\n    }\r\n\r\n    obj.close = function(ignoreEvents) {\r\n        if (el.classList.contains('jdropdown-focus')) {\r\n            // Update labels\r\n            obj.header.value = obj.getText();\r\n            // Remove cursor\r\n            obj.setCursor();\r\n            // Events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Blur\r\n            if (obj.header.blur) {\r\n                obj.header.blur();\r\n            }\r\n            // Remove focus\r\n            el.classList.remove('jdropdown-focus');\r\n            // Start tracking\r\n            jSuites.tracking(obj, false);\r\n            // Current dropdown\r\n            jSuites.dropdown.current = null;\r\n        }\r\n\r\n        return obj.getValue();\r\n    }\r\n\r\n    /**\r\n     * Set cursor\r\n     */\r\n    obj.setCursor = function(index, setPosition) {\r\n        // Remove current cursor\r\n        if (obj.currentIndex != null) {\r\n            // Remove visual cursor\r\n            if (obj.items && obj.items[obj.currentIndex]) {\r\n                obj.items[obj.currentIndex].element.classList.remove('jdropdown-cursor');\r\n            }\r\n        }\r\n\r\n        if (index == undefined) {\r\n            obj.currentIndex = null;\r\n        } else {\r\n            index = parseInt(index);\r\n\r\n            // Cursor only for visible items\r\n            if (obj.items[index].element.parentNode) {\r\n                obj.items[index].element.classList.add('jdropdown-cursor');\r\n                obj.currentIndex = index;\r\n\r\n                // Update scroll to the cursor element\r\n                if (setPosition !== false && obj.items[obj.currentIndex].element) {\r\n                    var container = content.scrollTop;\r\n                    var element = obj.items[obj.currentIndex].element;\r\n                    content.scrollTop = element.offsetTop - element.scrollTop + element.clientTop - 95;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Compatibility\r\n    obj.resetCursor = obj.setCursor;\r\n    obj.updateCursor = obj.setCursor;\r\n\r\n    /**\r\n     * Reset cursor and selected items\r\n     */\r\n    obj.reset = function() {\r\n        // Reset cursor\r\n        obj.setCursor();\r\n\r\n        // Reset selected\r\n        obj.setValue(null);\r\n    }\r\n\r\n    /**\r\n     * First available item\r\n     */\r\n    obj.first = function() {\r\n        if (obj.options.lazyLoading === true) {\r\n            obj.loadFirst();\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        if (items.length) {\r\n            var newIndex = items[0].indexValue;\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Last available item \r\n     */\r\n    obj.last = function() {\r\n        if (obj.options.lazyLoading === true) {\r\n            obj.loadLast();\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        if (items.length) {\r\n            var newIndex = items[items.length-1].indexValue;\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    obj.next = function(letter) {\r\n        var newIndex = null;\r\n\r\n        if (letter) {\r\n            if (letter.length == 1) {\r\n                // Current index\r\n                var current = obj.currentIndex || -1;\r\n                // Letter\r\n                letter = letter.toLowerCase();\r\n\r\n                var e = null;\r\n                var l = null;\r\n                var items = content.querySelectorAll('.jdropdown-item');\r\n                if (items.length) {\r\n                    for (var i = 0; i < items.length; i++) {\r\n                        if (items[i].indexValue > current) {\r\n                            if (e = obj.items[items[i].indexValue]) {\r\n                                if (l = e.element.innerText[0]) {\r\n                                    l = l.toLowerCase();\r\n                                    if (letter == l) {\r\n                                        newIndex = items[i].indexValue;\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    obj.setCursor(newIndex);\r\n                }\r\n            }\r\n        } else {\r\n            if (obj.currentIndex == undefined || obj.currentIndex == null) {\r\n                obj.first();\r\n            } else {\r\n                var element = obj.items[obj.currentIndex].element;\r\n\r\n                var next = element.nextElementSibling;\r\n                if (next) {\r\n                    if (next.classList.contains('jdropdown-group')) {\r\n                        next = next.lastChild.firstChild;\r\n                    }\r\n                    newIndex = next.indexValue;\r\n                } else {\r\n                    if (element.parentNode.classList.contains('jdropdown-group-items')) {\r\n                        if (next = element.parentNode.parentNode.nextElementSibling) {\r\n                            if (next.classList.contains('jdropdown-group')) {\r\n                                next = next.lastChild.firstChild;\r\n                            } else if (next.classList.contains('jdropdown-item')) {\r\n                                newIndex = next.indexValue;\r\n                            } else {\r\n                                next = null;\r\n                            }\r\n                        }\r\n\r\n                        if (next) {\r\n                            newIndex = next.indexValue;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (newIndex !== null) {\r\n                    obj.setCursor(newIndex);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.prev = function() {\r\n        var newIndex = null;\r\n\r\n        if (obj.currentIndex === null) {\r\n            obj.first();\r\n        } else {\r\n            var element = obj.items[obj.currentIndex].element;\r\n\r\n            var prev = element.previousElementSibling;\r\n            if (prev) {\r\n                if (prev.classList.contains('jdropdown-group')) {\r\n                    prev = prev.lastChild.lastChild;\r\n                }\r\n                newIndex = prev.indexValue;\r\n            } else {\r\n                if (element.parentNode.classList.contains('jdropdown-group-items')) {\r\n                    if (prev = element.parentNode.parentNode.previousElementSibling) {\r\n                        if (prev.classList.contains('jdropdown-group')) {\r\n                            prev = prev.lastChild.lastChild;\r\n                        } else if (prev.classList.contains('jdropdown-item')) {\r\n                            newIndex = prev.indexValue;\r\n                        } else {\r\n                            prev = null\r\n                        }\r\n                    }\r\n\r\n                    if (prev) {\r\n                        newIndex = prev.indexValue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (newIndex !== null) {\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    obj.loadFirst = function() {\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        // Show 200 items at once\r\n        var number = results.length || 0;\r\n\r\n        // Lazyloading\r\n        if (obj.options.lazyLoading == true && number > 200) {\r\n            number = 200;\r\n        }\r\n\r\n        // Reset container\r\n        content.innerHTML = '';\r\n\r\n        // First 200 items\r\n        for (var i = 0; i < number; i++) {\r\n            if (results[i].group) {\r\n                if (! results[i].group.parentNode) {\r\n                    content.appendChild(results[i].group);\r\n                }\r\n                results[i].group.lastChild.appendChild(results[i].element);\r\n            } else {\r\n                content.appendChild(results[i].element);\r\n            }\r\n        }\r\n\r\n        // Scroll go to the begin\r\n        content.scrollTop = 0;\r\n    }\r\n\r\n    obj.loadLast = function() {\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        // Show first page\r\n        var number = results.length;\r\n\r\n        // Max 200 items\r\n        if (number > 200) {\r\n            number = number - 200;\r\n\r\n            // Reset container\r\n            content.innerHTML = '';\r\n\r\n            // First 200 items\r\n            for (var i = number; i < results.length; i++) {\r\n                if (results[i].group) {\r\n                    if (! results[i].group.parentNode) {\r\n                        content.appendChild(results[i].group);\r\n                    }\r\n                    results[i].group.lastChild.appendChild(results[i].element);\r\n                } else {\r\n                    content.appendChild(results[i].element);\r\n                }\r\n            }\r\n\r\n            // Scroll go to the begin\r\n            content.scrollTop = content.scrollHeight;\r\n        }\r\n    }\r\n\r\n    obj.loadUp = function() {\r\n        var test = false;\r\n\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        var fistItem = items[0].indexValue;\r\n        fistItem = obj.items[fistItem];\r\n        var index = results.indexOf(fistItem) - 1;\r\n\r\n        if (index > 0) {\r\n            var number = 0;\r\n\r\n            while (index > 0 && results[index] && number < 200) {\r\n                if (results[index].group) {\r\n                    if (! results[index].group.parentNode) {\r\n                        content.insertBefore(results[index].group, content.firstChild);\r\n                    }\r\n                    results[index].group.lastChild.insertBefore(results[index].element, results[index].group.lastChild.firstChild);\r\n                } else {\r\n                    content.insertBefore(results[index].element, content.firstChild);\r\n                }\r\n\r\n                index--;\r\n                number++;\r\n            }\r\n\r\n            // New item added\r\n            test = true;\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    obj.loadDown = function() {\r\n        var test = false;\r\n\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        var lastItem = items[items.length-1].indexValue;\r\n        lastItem = obj.items[lastItem];\r\n        var index = results.indexOf(lastItem) + 1;\r\n\r\n        if (index < results.length) {\r\n            var number = 0;\r\n            while (index < results.length && results[index] && number < 200) {\r\n                if (results[index].group) {\r\n                    if (! results[index].group.parentNode) {\r\n                        content.appendChild(results[index].group);\r\n                    }\r\n                    results[index].group.lastChild.appendChild(results[index].element);\r\n                } else {\r\n                    content.appendChild(results[index].element);\r\n                }\r\n\r\n                index++;\r\n                number++;\r\n            }\r\n\r\n            // New item added\r\n            test = true;\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.dropdown.keydown = function(e) {\r\n    var dropdown = null;\r\n    if (dropdown = jSuites.dropdown.current) {\r\n        if (e.which == 13 || e.which == 9) {  // enter or tab\n            if (dropdown.header.value && dropdown.currentIndex == null && dropdown.options.newOptions) {\n                // if they typed something in, but it matched nothing, and newOptions are allowed, start that flow\n                dropdown.add();\n            } else {\n                // Quick Select/Filter\r\n                if (dropdown.currentIndex == null && dropdown.options.autocomplete == true && dropdown.header.value != \"\") {\r\n                    dropdown.find(dropdown.header.value);\r\n                }\r\n                dropdown.selectIndex(dropdown.currentIndex);\r\n            }\n        } else if (e.which == 38) {  // up arrow\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex > 0) {\r\n                dropdown.prev();\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 40) {  // down arrow\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex + 1 < dropdown.items.length) {\r\n                dropdown.next();\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 36) {\r\n            dropdown.first();\r\n            if (! e.target.classList.contains('jdropdown-header')) {\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 35) {\r\n            dropdown.last();\r\n            if (! e.target.classList.contains('jdropdown-header')) {\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 27) {\r\n            dropdown.close();\r\n        } else if (e.which == 33) {  // page up\r\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex > 0) {\r\n                for (var i = 0; i < 7; i++) {\r\n                    dropdown.prev()\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 34) {  // page down\r\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex + 1 < dropdown.items.length) {\r\n                for (var i = 0; i < 7; i++) {\r\n                    dropdown.next()\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.dropdown.mouseup = function(e) {\r\n    var element = jSuites.findElement(e.target, 'jdropdown');\r\n    if (element) {\r\n        var dropdown = element.dropdown;\r\n        if (e.target.classList.contains('jdropdown-header')) {\r\n            if (element.classList.contains('jdropdown-focus') && element.classList.contains('jdropdown-default')) {\r\n                var rect = element.getBoundingClientRect();\r\n\r\n                if (e.changedTouches && e.changedTouches[0]) {\r\n                    var x = e.changedTouches[0].clientX;\r\n                    var y = e.changedTouches[0].clientY;\r\n                } else {\r\n                    var x = e.clientX;\r\n                    var y = e.clientY;\r\n                }\r\n\r\n                if (rect.width - (x - rect.left) < 30) {\r\n                    if (e.target.classList.contains('jdropdown-add')) {\r\n                        dropdown.add();\r\n                    } else {\r\n                        dropdown.close();\r\n                    }\r\n                } else {\r\n                    if (dropdown.options.autocomplete == false) {\r\n                        dropdown.close();\r\n                    }\r\n                }\r\n            } else {\r\n                dropdown.open();\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-group-name')) {\r\n            var items = e.target.nextSibling.children;\r\n            if (e.target.nextSibling.style.display != 'none') {\r\n                for (var i = 0; i < items.length; i++) {\r\n                    if (items[i].style.display != 'none') {\r\n                        dropdown.selectItem(items[i]);\r\n                    }\r\n                }\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-group-arrow')) {\r\n            if (e.target.classList.contains('jdropdown-group-arrow-down')) {\r\n                e.target.classList.remove('jdropdown-group-arrow-down');\r\n                e.target.classList.add('jdropdown-group-arrow-up');\r\n                e.target.parentNode.nextSibling.style.display = 'none';\r\n            } else {\r\n                e.target.classList.remove('jdropdown-group-arrow-up');\r\n                e.target.classList.add('jdropdown-group-arrow-down');\r\n                e.target.parentNode.nextSibling.style.display = '';\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-item')) {\r\n            dropdown.selectItem(e.target);\r\n        } else if (e.target.classList.contains('jdropdown-image')) {\r\n            dropdown.selectItem(e.target.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-description')) {\r\n            dropdown.selectItem(e.target.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-title')) {\r\n            dropdown.selectItem(e.target.parentNode.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-close') || e.target.classList.contains('jdropdown-backdrop')) {\r\n            dropdown.close();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.dropdown.extractFromDom = function(el, options) {\r\n    // Keep reference\r\n    var select = el;\r\n    if (! options) {\r\n        options = {};\r\n    }\r\n    // Prepare configuration\r\n    if (el.getAttribute('multiple') && (! options || options.multiple == undefined)) {\r\n        options.multiple = true;\r\n    }\r\n    if (el.getAttribute('placeholder') && (! options || options.placeholder == undefined)) {\r\n        options.placeholder = el.getAttribute('placeholder');\r\n    }\r\n    if (el.getAttribute('data-autocomplete') && (! options || options.autocomplete == undefined)) {\r\n        options.autocomplete = true;\r\n    }\r\n    if (! options || options.width == undefined) {\r\n        options.width = el.offsetWidth;\r\n    }\r\n    if (el.value && (! options || options.value == undefined)) {\r\n        options.value = el.value;\r\n    }\r\n    if (! options || options.data == undefined) {\r\n        options.data = [];\r\n        for (var j = 0; j < el.children.length; j++) {\r\n            if (el.children[j].tagName == 'OPTGROUP') {\r\n                for (var i = 0; i < el.children[j].children.length; i++) {\r\n                    options.data.push({\r\n                        value: el.children[j].children[i].value,\r\n                        text: el.children[j].children[i].innerHTML,\r\n                        group: el.children[j].getAttribute('label'),\r\n                    });\r\n                }\r\n            } else {\r\n                options.data.push({\r\n                    value: el.children[j].value,\r\n                    text: el.children[j].innerHTML,\r\n                });\r\n            }\r\n        }\r\n    }\r\n    if (! options || options.onchange == undefined) {\r\n        options.onchange = function(a,b,c,d) {\r\n            if (options.multiple == true) {\r\n                if (obj.items[b].classList.contains('jdropdown-selected')) {\r\n                    select.options[b].setAttribute('selected', 'selected');\r\n                } else {\r\n                    select.options[b].removeAttribute('selected');\r\n                }\r\n            } else {\r\n                select.value = d;\r\n            }\r\n        }\r\n    }\r\n    // Create DIV\r\n    var div = document.createElement('div');\r\n    el.parentNode.insertBefore(div, el);\r\n    el.style.display = 'none';\r\n    el = div;\r\n\r\n    return { el:el, options:options };\r\n}\r\n\r\njSuites.editor = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        // Initial HTML content\r\n        value: null,\r\n        // Initial snippet\r\n        snippet: null,\r\n        // Add toolbar\r\n        toolbar: null,\r\n        // Website parser is to read websites and images from cross domain\r\n        remoteParser: null,\r\n        // Placeholder\r\n        placeholder: null,\r\n        // Parse URL\r\n        parseURL: false,\r\n        filterPaste: true,\r\n        // Accept drop files\r\n        dropZone: false,\r\n        dropAsSnippet: false,\r\n        acceptImages: false,\r\n        acceptFiles: false,\r\n        maxFileSize: 5000000,\r\n        allowImageResize: true,\r\n        // Style\r\n        border: true,\r\n        padding: true,\r\n        maxHeight: null,\r\n        height: null,\r\n        focus: false,\r\n        // Events\r\n        onclick: null,\r\n        onfocus: null,\r\n        onblur: null,\r\n        onload: null,\r\n        onkeyup: null,\r\n        onkeydown: null,\r\n        onchange: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Private controllers\r\n    var imageResize = 0;\r\n    var editorTimer = null;\r\n    var editorAction = null;\r\n    var files = [];\r\n\r\n    // Make sure element is empty\r\n    el.innerHTML = '';\r\n\r\n    // Keep the reference for the container\r\n    obj.el = el;\r\n\r\n    if (typeof(obj.options.onclick) == 'function') {\r\n        el.onclick = function(e) {\r\n            obj.options.onclick(el, obj, e);\r\n        }\r\n    }\r\n\r\n    // Prepare container\r\n    el.classList.add('jeditor-container');\r\n\r\n    // Padding\r\n    if (obj.options.padding == true) {\r\n        el.classList.add('jeditor-padding');\r\n    }\r\n\r\n    // Border\r\n    if (obj.options.border == false) {\r\n        el.style.border = '0px';\r\n    }\r\n\r\n    // Snippet\r\n    var snippet = document.createElement('div');\r\n    snippet.className = 'jsnippet';\r\n    snippet.setAttribute('contenteditable', false);\r\n\r\n    // Toolbar\r\n    var toolbar = document.createElement('div');\r\n    toolbar.className = 'jeditor-toolbar';\r\n\r\n    // Create editor\r\n    var editor = document.createElement('div');\r\n    editor.setAttribute('contenteditable', true);\r\n    editor.setAttribute('spellcheck', false);\r\n    editor.className = 'jeditor';\r\n\r\n    // Placeholder\r\n    if (obj.options.placeholder) {\r\n        editor.setAttribute('data-placeholder', obj.options.placeholder);\r\n    }\r\n\r\n    // Max height\r\n    if (obj.options.maxHeight || obj.options.height) {\r\n        editor.style.overflowY = 'auto';\r\n\r\n        if (obj.options.maxHeight) {\r\n            editor.style.maxHeight = obj.options.maxHeight;\r\n        }\r\n        if (obj.options.height) {\r\n            editor.style.height = obj.options.height;\r\n        }\r\n    }\r\n\r\n    // Set editor initial value\r\n    if (obj.options.value) {\r\n        var value = obj.options.value;\r\n    } else {\r\n        var value = el.innerHTML ? el.innerHTML : ''; \r\n    }\r\n\r\n    if (! value) {\r\n        var value = '';\r\n    }\r\n\r\n    /**\r\n     * Onchange event controllers\r\n     */\r\n    var change = function(e) {\r\n        if (typeof(obj.options.onchange) == 'function') { \r\n            obj.options.onchange(el, obj, e);\r\n        }\r\n\r\n        // Update value\r\n        obj.options.value = obj.getData();\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract images from a HTML string\r\n     */\r\n    var extractImageFromHtml = function(html) {\r\n        // Create temp element\r\n        var div = document.createElement('div');\r\n        div.innerHTML = html;\r\n\r\n        // Extract images\r\n        var img = div.querySelectorAll('img');\r\n\r\n        if (img.length) {\r\n            for (var i = 0; i < img.length; i++) {\r\n                obj.addImage(img[i].src);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Insert node at caret\r\n     */\r\n    var insertNodeAtCaret = function(newNode) {\r\n        var sel, range;\r\n\r\n        if (window.getSelection) {\r\n            sel = window.getSelection();\r\n            if (sel.rangeCount) {\r\n                range = sel.getRangeAt(0);\r\n                var selectedText = range.toString();\r\n                range.deleteContents();\r\n                range.insertNode(newNode); \r\n                // move the cursor after element\r\n                range.setStartAfter(newNode);\r\n                range.setEndAfter(newNode); \r\n                sel.removeAllRanges();\r\n                sel.addRange(range);\r\n            }\r\n        }\r\n    }\r\n\r\n    var updateTotalImages = function() {\r\n        var o = null;\r\n        if (o = snippet.children[0]) {\r\n            // Make sure is a grid\r\n            if (! o.classList.contains('jslider-grid')) {\r\n                o.classList.add('jslider-grid');\r\n            }\r\n            // Quantify of images\r\n            var number = o.children.length;\r\n            // Set the configuration of the grid\r\n            o.setAttribute('data-number', number > 4 ? 4 : number);\r\n            // Total of images inside the grid\r\n            if (number > 4) {\r\n                o.setAttribute('data-total', number - 4);\r\n            } else {\r\n                o.removeAttribute('data-total');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Append image to the snippet\r\n     */\r\n    var appendImage = function(image) {\r\n        if (! snippet.innerHTML) {\r\n            appendElement({});\r\n        }\r\n        snippet.children[0].appendChild(image);\r\n        updateTotalImages();\r\n    }\r\n\r\n    /**\r\n     * Append snippet\r\n     * @Param object data\r\n     */\r\n    var appendElement = function(data) {\r\n        // Reset snippet\r\n        snippet.innerHTML = '';\r\n\r\n        // Attributes\r\n        var a = [ 'image', 'title', 'description', 'host', 'url' ];\r\n\r\n        for (var i = 0; i < a.length; i++) {\r\n            var div = document.createElement('div');\r\n            div.className = 'jsnippet-' + a[i];\r\n            div.setAttribute('data-k', a[i]);\r\n            snippet.appendChild(div);\r\n            if (data[a[i]]) {\r\n                if (a[i] == 'image') {\r\n                    if (! Array.isArray(data.image)) {\r\n                        data.image = [ data.image ];\r\n                    }\r\n                    for (var j = 0; j < data.image.length; j++) {\r\n                        var img = document.createElement('img');\r\n                        img.src = data.image[j];\r\n                        div.appendChild(img);\r\n                    }\r\n                } else {\r\n                    div.innerHTML = data[a[i]];\r\n                }\r\n            }\r\n        }\r\n\r\n        editor.appendChild(document.createElement('br'));\r\n        editor.appendChild(snippet);\r\n    }\r\n\r\n    var verifyEditor = function() {\r\n        clearTimeout(editorTimer);\r\n        editorTimer = setTimeout(function() {\r\n            var snippet = editor.querySelector('.jsnippet');\r\n            if (! snippet) {\r\n                var html = editor.innerHTML.replace(/\\n/g, ' ');\r\n                var container = document.createElement('div');\r\n                container.innerHTML = html;\r\n                var text = container.innerText; \r\n                var url = jSuites.editor.detectUrl(text);\r\n\r\n                if (url) {\r\n                    if (url[0].substr(-3) == 'jpg' || url[0].substr(-3) == 'png' || url[0].substr(-3) == 'gif') {\r\n                         obj.addImage(url[0], true);\r\n                    } else {\r\n                        var id = jSuites.editor.youtubeParser(url[0]);\r\n                        obj.parseWebsite(url[0], id);\r\n                    }\r\n                }\r\n            }\r\n        }, 1000);\r\n    }\r\n\r\n    obj.parseContent = function() {\r\n        verifyEditor();\r\n    }\r\n\r\n    obj.parseWebsite = function(url, youtubeId) {\r\n        if (! obj.options.remoteParser) {\r\n            console.log('The remoteParser is not defined');\r\n        } else {\r\n            // Youtube definitions\r\n            if (youtubeId) {\r\n                var url = 'https://www.youtube.com/watch?v=' + youtubeId;\r\n            }\r\n\r\n            var p = {\r\n                title: '',\r\n                description: '',\r\n                image: '',\r\n                host: url.split('/')[2],\r\n                url: url,\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.remoteParser + encodeURI(url.trim()),\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Get title\r\n                    if (result.title) {\r\n                        p.title = result.title;\r\n                    }\r\n                    // Description\r\n                    if (result.description) {\r\n                        p.description = result.description;\r\n                    }\r\n                    // Host\r\n                    if (result.host) {\r\n                        p.host = result.host;\r\n                    }\r\n                    // Url\r\n                    if (result.url) {\r\n                        p.url = result.url;\r\n                    }\r\n                    // Append snippet\r\n                    appendElement(p);\r\n                    // Add image\r\n                    if (result.image) {\r\n                        obj.addImage(result.image, true);\r\n                    } else if (result['og:image']) {\r\n                        obj.addImage(result['og:image'], true);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set editor value\r\n     */\r\n    obj.setData = function(html) {\r\n        editor.innerHTML = html;\r\n\r\n        if (obj.options.focus) {\r\n            jSuites.editor.setCursor(editor, true);\r\n        }\r\n\r\n        // Reset files container\r\n        files = [];\r\n    }\r\n\r\n    obj.getFiles = function() {\r\n        var f = editor.querySelectorAll('.jfile');\r\n        var d = [];\r\n        for (var i = 0; i < f.length; i++) {\r\n            if (files[f[i].src]) {\r\n                d.push(files[f[i].src]);\r\n            }\r\n        }\r\n        return d;\r\n    }\r\n\r\n    obj.getText = function() {\r\n        return editor.innerText;\r\n    }\r\n\r\n    /**\r\n     * Get editor data\r\n     */\r\n    obj.getData = function(json) {\r\n        if (! json) {\r\n            var data = editor.innerHTML;\r\n        } else {\r\n            var data = {\r\n                content : '',\r\n            }\r\n\r\n            // Get snippet\r\n            if (snippet.innerHTML) {\r\n                var index = 0;\r\n                data.snippet = {};\r\n                for (var i = 0; i < snippet.children.length; i++) {\r\n                    // Get key from element\r\n                    var key = snippet.children[i].getAttribute('data-k');\r\n                    if (key) {\r\n                        if (key == 'image') {\r\n                            if (! data.snippet.image) {\r\n                                data.snippet.image = [];\r\n                            }\r\n                            // Get all images\r\n                            for (var j = 0; j < snippet.children[i].children.length; j++) {\r\n                                data.snippet.image.push(snippet.children[i].children[j].getAttribute('src'))\r\n                            }\r\n                        } else {\r\n                            data.snippet[key] = snippet.children[i].innerHTML;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Get files\r\n            var f = Object.keys(files);\r\n            if (f.length) {\r\n                data.files = [];\r\n                for (var i = 0; i < f.length; i++) {\r\n                    data.files.push(files[f[i]]);\r\n                }\r\n            }\r\n\r\n            // Get content\r\n            var text = editor.innerHTML;\r\n            text = text.replace(/<br>/g, \"\\n\");\r\n            text = text.replace(/<\\/div>/g, \"<\\/div>\\n\");\r\n            text = text.replace(/<(?:.|\\n)*?>/gm, \"\");\r\n            data.content = text.trim();\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    // Reset\r\n    obj.reset = function() {\r\n        editor.innerHTML = '';\r\n        snippet.innerHTML = '';\r\n        files = [];\r\n    }\r\n\r\n    obj.addPdf = function(data) {\r\n        if (data.result.substr(0,4) != 'data') {\r\n            console.error('Invalid source');\r\n        } else {\r\n            var canvas = document.createElement('canvas');\r\n            canvas.width = 60;\r\n            canvas.height = 60;\r\n\r\n            var img = new Image();\r\n            var ctx = canvas.getContext('2d');\r\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n            canvas.toBlob(function(blob) {\r\n                var newImage = document.createElement('img');\r\n                newImage.src = window.URL.createObjectURL(blob);\r\n                newImage.title = data.name;\r\n                newImage.className = 'jfile pdf';\r\n\r\n                files[newImage.src] = {\r\n                    file: newImage.src,\r\n                    extension: 'pdf',\r\n                    content: data.result,\r\n                }\r\n\r\n                insertNodeAtCaret(newImage);\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.addImage = function(src, asSnippet) {\r\n        if (! src) {\r\n            src = '';\r\n        }\r\n\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                extension = extension[1];\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n            }\r\n\r\n            var img = new Image();\r\n\r\n            img.onload = function onload() {\r\n                var canvas = document.createElement('canvas');\r\n                canvas.width = img.width;\r\n                canvas.height = img.height;\r\n\r\n                var ctx = canvas.getContext('2d');\r\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                canvas.toBlob(function(blob) {\r\n                    var newImage = document.createElement('img');\r\n                    newImage.src = window.URL.createObjectURL(blob);\r\n                    newImage.classList.add('jfile');\r\n                    newImage.setAttribute('tabindex', '900');\r\n                    files[newImage.src] = {\r\n                        file: newImage.src,\r\n                        extension: extension,\r\n                        content: canvas.toDataURL(),\r\n                    }\r\n\r\n                    if (obj.options.dropAsSnippet || asSnippet) {\r\n                        appendImage(newImage);\r\n                        // Just to understand the attachment is part of a snippet\r\n                        files[newImage.src].snippet = true;\r\n                    } else {\r\n                        insertNodeAtCaret(newImage);\r\n                    }\r\n\r\n                    change();\r\n                });\r\n            };\r\n\r\n            img.src = src;\r\n        }\r\n    }\r\n\r\n    obj.addFile = function(files) {\r\n        var reader = [];\r\n\r\n        for (var i = 0; i < files.length; i++) {\r\n            if (files[i].size > obj.options.maxFileSize) {\r\n                alert('The file is too big');\r\n            } else {\r\n                // Only PDF or Images\r\n                var type = files[i].type.split('/');\r\n\r\n                if (type[0] == 'image') {\r\n                    type = 1;\r\n                } else if (type[1] == 'pdf') {\r\n                    type = 2;\r\n                } else {\r\n                    type = 0;\r\n                }\r\n\r\n                if (type) {\r\n                    // Create file\r\n                    reader[i] = new FileReader();\r\n                    reader[i].index = i;\r\n                    reader[i].type = type;\r\n                    reader[i].name = files[i].name;\r\n                    reader[i].date = files[i].lastModified;\r\n                    reader[i].size = files[i].size;\r\n                    reader[i].addEventListener(\"load\", function (data) {\r\n                        // Get result\r\n                        if (data.target.type == 2) {\r\n                            if (obj.options.acceptFiles == true) {\r\n                                obj.addPdf(data.target);\r\n                            }\r\n                        } else {\r\n                            obj.addImage(data.target.result);\r\n                        }\r\n                    }, false);\r\n\r\n                    reader[i].readAsDataURL(files[i])\r\n                } else {\r\n                    alert('The extension is not allowed');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Destroy\r\n    obj.destroy = function() {\r\n        editor.removeEventListener('mouseup', editorMouseUp);\r\n        editor.removeEventListener('mousedown', editorMouseDown);\r\n        editor.removeEventListener('mousemove', editorMouseMove);\r\n        editor.removeEventListener('keyup', editorKeyUp);\r\n        editor.removeEventListener('keydown', editorKeyDown);\r\n        editor.removeEventListener('dragstart', editorDragStart);\r\n        editor.removeEventListener('dragenter', editorDragEnter);\r\n        editor.removeEventListener('dragover', editorDragOver);\r\n        editor.removeEventListener('drop', editorDrop);\r\n        editor.removeEventListener('paste', editorPaste);\r\n\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            editor.removeEventListener('blur', editorBlur);\r\n        }\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            editor.removeEventListener('focus', editorFocus);\r\n        }\r\n\r\n        el.editor = null;\r\n        el.classList.remove('jeditor-container');\r\n\r\n        toolbar.remove();\r\n        snippet.remove();\r\n        editor.remove();\r\n    }\r\n\r\n    var isLetter = function (str) {\r\n        var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]+)/g;\r\n        return str.match(regex) ? 1 : 0;\r\n    }\r\n\r\n    // Event handlers\r\n    var editorMouseUp = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            editorAction.e.classList.remove('resizing');\r\n        }\r\n\r\n        editorAction = false;\r\n    }\r\n\r\n    var editorMouseDown = function(e) {\r\n        var close = function(snippet) {\r\n            var rect = snippet.getBoundingClientRect();\r\n            if (rect.width - (e.clientX - rect.left) < 40 && e.clientY - rect.top < 40) {\r\n                snippet.innerHTML = '';\r\n                snippet.remove();\r\n            }\r\n        }\r\n\r\n        if (e.target.tagName == 'IMG') {\r\n            if (e.target.style.cursor) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                editorAction = {\r\n                    e: e.target,\r\n                    x: e.clientX,\r\n                    y: e.clientY,\r\n                    w: rect.width,\r\n                    h: rect.height,\r\n                    d: e.target.style.cursor,\r\n                }\r\n\r\n                if (! e.target.width) {\r\n                    e.target.width = rect.width + 'px';\r\n                }\r\n\r\n                if (! e.target.height) {\r\n                    e.target.height = rect.height + 'px';\r\n                }\r\n\r\n                var s = window.getSelection();\r\n                if (s.rangeCount) {\r\n                    for (var i = 0; i < s.rangeCount; i++) {\r\n                        s.removeRange(s.getRangeAt(i));\r\n                    }\r\n                }\r\n\r\n                e.target.classList.add('resizing');\r\n            } else {\r\n                editorAction = true;\r\n            }\r\n        } else { \r\n            if (e.target.classList.contains('jsnippet')) {\r\n                close(e.target);\r\n            } else if (e.target.parentNode.classList.contains('jsnippet')) {\r\n                close(e.target.parentNode);\r\n            }\r\n\r\n            editorAction = true;\r\n        }\r\n    }\r\n\r\n    var editorMouseMove = function(e) {\r\n        if (e.target.tagName == 'IMG' && ! e.target.parentNode.classList.contains('jsnippet-image') && obj.options.allowImageResize == true) {\r\n            if (e.target.getAttribute('tabindex')) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                if (e.clientY - rect.top < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'ne-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'nw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 'n-resize';\r\n                    }\r\n                } else if (rect.height - (e.clientY - rect.top) < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'se-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'sw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 's-resize';\r\n                    }\r\n                } else if (rect.width - (e.clientX - rect.left) < 5) {\r\n                    e.target.style.cursor = 'e-resize';\r\n                } else if (e.clientX - rect.left < 5) {\r\n                    e.target.style.cursor = 'w-resize';\r\n                } else {\r\n                    e.target.style.cursor = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Move\r\n        if (e.which == 1 && editorAction && editorAction.d) {\r\n            if (editorAction.d == 'e-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'se-resize') {\r\n                editorAction.e.width = (editorAction.w + (e.clientX - editorAction.x));\r\n\r\n                if (e.shiftKey) {\r\n                    var newHeight = (e.clientX - editorAction.x) * (editorAction.h / editorAction.w);\r\n                    editorAction.e.height = editorAction.h + newHeight;\r\n                } else {\r\n                    var newHeight =  null;\r\n                }\r\n            }\r\n\r\n            if (! newHeight) {\r\n                if (editorAction.d == 's-resize' || editorAction.d == 'se-resize' || editorAction.d == 'sw-resize') {\r\n                    if (! e.shiftKey) {\r\n                        editorAction.e.height = editorAction.h + (e.clientY - editorAction.y);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    var editorKeyUp = function(e) {\r\n        if (! editor.innerHTML) {\r\n            editor.innerHTML = '<div><br></div>';\r\n        }\r\n\r\n        if (typeof(obj.options.onkeyup) == 'function') { \r\n            obj.options.onkeyup(el, obj, e);\r\n        }\r\n    }\r\n\r\n\r\n    var editorKeyDown = function(e) {\r\n        // Check for URL\r\n        if (obj.options.parseURL == true) {\r\n            verifyEditor();\r\n        }\r\n\r\n        if (typeof(obj.options.onkeydown) == 'function') { \r\n            obj.options.onkeydown(el, obj, e);\r\n        }\r\n\r\n        if (e.key == 'Delete') {\r\n            if (e.target.tagName == 'IMG' && e.target.parentNode.classList.contains('jsnippet-image')) {\r\n                e.target.remove();\r\n                updateTotalImages();\r\n            }\r\n        }\r\n    }\r\n\r\n    // Elements to be removed\r\n    var remove = [HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement];\r\n\r\n    // Valid properties\r\n    var validProperty = ['width', 'height', 'align', 'border', 'src', 'tabindex'];\r\n\r\n    // Valid CSS attributes\r\n    var validStyle = ['color', 'font-weight', 'font-size', 'background', 'background-color', 'margin'];\r\n\r\n    var parse = function(element) {\r\n       // Remove attributes\r\n       if (element.attributes && element.attributes.length) {\r\n           var image = null;\r\n           var style = null;\r\n           // Process style attribute\r\n           var elementStyle = element.getAttribute('style');\r\n           if (elementStyle) {\r\n               style = [];\r\n               var t = elementStyle.split(';');\r\n               for (var j = 0; j < t.length; j++) {\r\n                   var v = t[j].trim().split(':');\r\n                   if (validStyle.indexOf(v[0].trim()) >= 0) {\r\n                       var k = v.shift();\r\n                       var v = v.join(':');\r\n                       style.push(k + ':' + v);\r\n                   }\r\n               }\r\n           }\r\n           // Process image\r\n           if (element.tagName.toUpperCase() == 'IMG') {\r\n               if (! obj.options.acceptImages || ! element.src) {\r\n                   element.parentNode.removeChild(element);\r\n               } else {\r\n                   // Check if is data\r\n                   element.setAttribute('tabindex', '900');\r\n                   // Check attributes for persistance\r\n                   obj.addImage(element.src);\r\n               }\r\n           }\r\n           // Remove attributes\r\n           var attr = [];\r\n           var numAttributes = element.attributes.length - 1;\r\n           if (numAttributes > 0) {\r\n               for (var i = numAttributes; i >= 0 ; i--) {\r\n                   attr.push(element.attributes[i].name);\r\n               }\r\n               attr.forEach(function(v) {\r\n                   if (validProperty.indexOf(v) == -1) {\r\n                       element.removeAttribute(v);\r\n                   }\r\n               });\r\n           }\r\n           element.style = '';\r\n           // Add valid style\r\n           if (style && style.length) {\r\n               element.setAttribute('style', style.join(';'));\r\n           }\r\n       }\r\n       // Parse children\r\n       if (element.children.length) {\r\n           for (var i = 0; i < element.children.length; i++) {\r\n               parse(element.children[i]);\r\n           }\r\n       }\r\n\r\n       if (remove.indexOf(element.constructor) >= 0) {\r\n           element.remove();\r\n       }\r\n    }\r\n\r\n    var filter = function(data) {\r\n        if (data) {\r\n            data = data.replace(new RegExp('<!--(.*?)-->', 'gsi'), '');\r\n        }\r\n        var parser = new DOMParser();\r\n        var d = parser.parseFromString(data, \"text/html\");\r\n        parse(d);\r\n        var span = document.createElement('span');\r\n        span.innerHTML = d.firstChild.innerHTML;\r\n        return span;\r\n    } \r\n\r\n    var editorPaste = function(e) {\r\n        if (obj.options.filterPaste == true) {\r\n            if (e.clipboardData || e.originalEvent.clipboardData) {\r\n                var html = (e.originalEvent || e).clipboardData.getData('text/html');\r\n                var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n                var file = (e.originalEvent || e).clipboardData.files\r\n            } else if (window.clipboardData) {\r\n                var html = window.clipboardData.getData('Html');\r\n                var text = window.clipboardData.getData('Text');\r\n                var file = window.clipboardData.files\r\n            }\r\n\r\n            if (file.length) {\r\n                // Paste a image from the clipboard\r\n                obj.addFile(file);\r\n            } else {\r\n                if (! html) {\r\n                    html = text.split('\\r\\n');\r\n                    if (! e.target.innerText) {\r\n                        html.map(function(v) {\r\n                            var d = document.createElement('div');\r\n                            d.innerText = v;\r\n                            editor.appendChild(d);\r\n                        });\r\n                    } else {\r\n                        html = html.map(function(v) {\r\n                            return '<div>' + v + '</div>';\r\n                        });\r\n                        document.execCommand('insertHtml', false, html.join(''));\r\n                    }\r\n                } else {\r\n                    var d = filter(html);\r\n                    // Paste to the editor\r\n                    insertNodeAtCaret(d);\r\n                }\r\n            }\r\n\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragStart = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragEnter = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            el.classList.add('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragOver = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            if (editorTimer) {\r\n                clearTimeout(editorTimer);\r\n            }\r\n\r\n            editorTimer = setTimeout(function() {\r\n                el.classList.remove('jeditor-dragging');\r\n            }, 100);\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDrop = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            // Position caret on the drop\r\n            var range = null;\r\n            if (document.caretRangeFromPoint) {\r\n                range=document.caretRangeFromPoint(e.clientX, e.clientY);\r\n            } else if (e.rangeParent) {\r\n                range=document.createRange();\r\n                range.setStart(e.rangeParent,e.rangeOffset);\r\n            }\r\n            var sel = window.getSelection();\r\n            sel.removeAllRanges();\r\n            sel.addRange(range);\r\n            sel.anchorNode.parentNode.focus();\r\n\r\n            var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n            var text = (e.originalEvent || e).dataTransfer.getData('text/plain');\r\n            var file = (e.originalEvent || e).dataTransfer.files;\r\n    \r\n            if (file.length) {\r\n                obj.addFile(file);\r\n            } else if (text) {\r\n                extractImageFromHtml(html);\r\n            }\r\n\r\n            el.classList.remove('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorBlur = function(e) {\r\n        // Blur\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            obj.options.onblur(el, obj, e);\r\n        }\r\n\r\n        change(e);\r\n    }\r\n\r\n    var editorFocus = function(e) {\r\n        // Focus\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            obj.options.onfocus(el, obj, e);\r\n        }\r\n    }\r\n\r\n    editor.addEventListener('mouseup', editorMouseUp);\r\n    editor.addEventListener('mousedown', editorMouseDown);\r\n    editor.addEventListener('mousemove', editorMouseMove);\r\n    editor.addEventListener('keyup', editorKeyUp);\r\n    editor.addEventListener('keydown', editorKeyDown);\r\n    editor.addEventListener('dragstart', editorDragStart);\r\n    editor.addEventListener('dragenter', editorDragEnter);\r\n    editor.addEventListener('dragover', editorDragOver);\r\n    editor.addEventListener('drop', editorDrop);\r\n    editor.addEventListener('paste', editorPaste);\r\n    editor.addEventListener('focus', editorFocus);\r\n    editor.addEventListener('blur', editorBlur);\r\n\r\n    // Onload\r\n    if (typeof(obj.options.onload) == 'function') {\r\n        obj.options.onload(el, obj, editor);\r\n    }\r\n\r\n    // Set value to the editor\r\n    editor.innerHTML = value;\r\n\r\n    // Append editor to the containre\r\n    el.appendChild(editor);\r\n\r\n    // Snippet\r\n    if (obj.options.snippet) {\r\n        appendElement(obj.options.snippet);\r\n    }\r\n\r\n    // Default toolbar\r\n    if (obj.options.toolbar == null) {\r\n        obj.options.toolbar = jSuites.editor.getDefaultToolbar();\r\n    }\r\n\r\n    // Add toolbar\r\n    if (obj.options.toolbar) {\r\n        // Append to the DOM\r\n        el.appendChild(toolbar);\r\n        // Create toolbar\r\n        jSuites.toolbar(toolbar, {\r\n            container: true,\r\n            responsive: true,\r\n            items: obj.options.toolbar\r\n        });\r\n    }\r\n\r\n    // Focus to the editor\r\n    if (obj.options.focus) {\r\n        jSuites.editor.setCursor(editor, obj.options.focus == 'initial' ? true : false);\r\n    }\r\n\r\n    // Change method\r\n    el.change = obj.setData;\r\n\r\n    // Global generic value handler\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            // Data type\r\n            var o = el.getAttribute('data-html') === 'true' ? false : true;\r\n            return obj.getData(o);\r\n        } else {\r\n            obj.setData(val);\r\n        }\r\n    }\r\n\r\n    el.editor = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.editor.setCursor = function(element, first) {\r\n    element.focus();\r\n    document.execCommand('selectAll');\r\n    var sel = window.getSelection();\r\n    var range = sel.getRangeAt(0);\r\n    if (first == true) {\r\n        var node = range.startContainer;\r\n        var size = 0;\r\n    } else {\r\n        var node = range.endContainer;\r\n        var size = node.length;\r\n    }\r\n    range.setStart(node, size);\r\n    range.setEnd(node, size);\r\n    sel.removeAllRanges();\r\n    sel.addRange(range);\r\n}\r\n\r\njSuites.editor.getDomain = function(url) {\r\n    return url.replace('http://','').replace('https://','').replace('www.','').split(/[/?#]/)[0].split(/:/g)[0];\r\n}\r\n\r\njSuites.editor.detectUrl = function(text) {\r\n    var expression = /(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig;\r\n    var links = text.match(expression);\r\n\r\n    if (links) {\r\n        if (links[0].substr(0,3) == 'www') {\r\n            links[0] = 'http://' + links[0];\r\n        }\r\n    }\r\n\r\n    return links;\r\n}\r\n\r\njSuites.editor.youtubeParser = function(url) {\r\n    var regExp = /^.*((youtu.be\\/)|(v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#\\&\\?]*).*/;\r\n    var match = url.match(regExp);\r\n\r\n    return (match && match[7].length == 11) ? match[7] : false;\r\n}\r\n\r\njSuites.editor.getDefaultToolbar = function() { \r\n    return [\r\n        {\r\n            content: 'undo',\r\n            onclick: function() {\r\n                document.execCommand('undo');\r\n            }\r\n        },\r\n        {\r\n            content: 'redo',\r\n            onclick: function() {\r\n                document.execCommand('redo');\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_bold',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('bold');\r\n\r\n                if (document.queryCommandState(\"bold\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_italic',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('italic');\r\n\r\n                if (document.queryCommandState(\"italic\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_underline',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('underline');\r\n\r\n                if (document.queryCommandState(\"underline\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_list_bulleted',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_list_numbered',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertOrderedList');\r\n\r\n                if (document.queryCommandState(\"insertOrderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_increase',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('indent', true, null);\r\n\r\n                if (document.queryCommandState(\"indent\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_decrease',\r\n            onclick: function() {\r\n                document.execCommand('outdent');\r\n\r\n                if (document.queryCommandState(\"outdent\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }/*,\r\n        {\r\n            icon: ['format_align_left', 'format_align_right', 'format_align_center'],\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }\r\n        {\r\n            type:'select',\r\n            items: ['Verdana','Arial','Courier New'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            type:'select',\r\n            items: ['10px','12px','14px','16px','18px','20px','22px'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_left',\r\n            onclick: function() {\r\n                document.execCommand('JustifyLeft');\r\n\r\n                if (document.queryCommandState(\"JustifyLeft\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_center',\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_right',\r\n            onclick: function() {\r\n                document.execCommand('justifyRight');\r\n\r\n                if (document.queryCommandState(\"justifyRight\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_justify',\r\n            onclick: function() {\r\n                document.execCommand('justifyFull');\r\n\r\n                if (document.queryCommandState(\"justifyFull\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_list_bulleted',\r\n            onclick: function() {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }*/\r\n    ];\r\n}\r\n\r\n\r\njSuites.focus = function(el) {\r\n    if (el.innerText.length) {\r\n        var range = document.createRange();\r\n        var sel = window.getSelection();\r\n        var node = el.childNodes[el.childNodes.length-1];\r\n        range.setStart(node, node.length)\r\n        range.collapse(true)\r\n        sel.removeAllRanges()\r\n        sel.addRange(range)\r\n        el.scrollLeft = el.scrollWidth;\r\n    }\r\n}\r\n\r\njSuites.isNumeric = (function (num) {\r\n    return !isNaN(num) && num !== null && num !== '';\r\n});\r\n\r\njSuites.guid = function() {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n        return v.toString(16);\r\n    });\r\n}\r\n\r\njSuites.getNode = function() {\r\n    var node = document.getSelection().anchorNode;\r\n    if (node) {\r\n        return (node.nodeType == 3 ? node.parentNode : node);\r\n    } else {\r\n        return null;\r\n    }\r\n}\r\n/**\r\n * Generate hash from a string\r\n */\r\njSuites.hash = function(str) {\r\n    var hash = 0, i, chr;\r\n\r\n    if (str.length === 0) {\r\n        return hash;\r\n    } else {\r\n        for (i = 0; i < str.length; i++) {\r\n            chr = str.charCodeAt(i);\r\n            if (chr > 32) {\r\n                hash = ((hash << 5) - hash) + chr;\r\n                hash |= 0;\r\n            }\r\n        }\r\n    }\r\n    return hash;\r\n}\r\n\r\n/**\r\n * Generate a random color\r\n */\r\njSuites.randomColor = function(h) {\r\n    var lum = -0.25;\r\n    var hex = String('#' + Math.random().toString(16).slice(2, 8).toUpperCase()).replace(/[^0-9a-f]/gi, '');\r\n    if (hex.length < 6) {\r\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\r\n    }\r\n    var rgb = [], c, i;\r\n    for (i = 0; i < 3; i++) {\r\n        c = parseInt(hex.substr(i * 2, 2), 16);\r\n        c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);\r\n        rgb.push((\"00\" + c).substr(c.length));\r\n    }\r\n\r\n    // Return hex\r\n    if (h == true) {\r\n        return '#' + jSuites.two(rgb[0].toString(16)) + jSuites.two(rgb[1].toString(16)) + jSuites.two(rgb[2].toString(16));\r\n    }\r\n\r\n    return rgb;\r\n}\r\n\r\njSuites.getWindowWidth = function() {\r\n    var w = window,\r\n    d = document,\r\n    e = d.documentElement,\r\n    g = d.getElementsByTagName('body')[0],\r\n    x = w.innerWidth || e.clientWidth || g.clientWidth;\r\n    return x;\r\n}\r\n\r\njSuites.getWindowHeight = function() {\r\n    var w = window,\r\n    d = document,\r\n    e = d.documentElement,\r\n    g = d.getElementsByTagName('body')[0],\r\n    y = w.innerHeight|| e.clientHeight|| g.clientHeight;\r\n    return  y;\r\n}\r\n\r\njSuites.getPosition = function(e) {\r\n    if (e.changedTouches && e.changedTouches[0]) {\r\n        var x = e.changedTouches[0].pageX;\r\n        var y = e.changedTouches[0].pageY;\r\n    } else {\r\n        var x = (window.Event) ? e.pageX : e.clientX + (document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft);\r\n        var y = (window.Event) ? e.pageY : e.clientY + (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop);\r\n    }\r\n\r\n    return [ x, y ];\r\n}\r\n\r\njSuites.click = function(el) {\r\n    if (el.click) {\r\n        el.click();\r\n    } else {\r\n        var evt = new MouseEvent('click', {\r\n            bubbles: true,\r\n            cancelable: true,\r\n            view: window\r\n        });\r\n        el.dispatchEvent(evt);\r\n    }\r\n}\r\n\r\njSuites.findElement = function(element, condition) {\r\n    var foundElement = false;\r\n\r\n    function path (element) {\r\n        if (element && ! foundElement) {\r\n            if (typeof(condition) == 'function') {\r\n                foundElement = condition(element)\r\n            } else if (typeof(condition) == 'string') {\r\n                if (element.classList && element.classList.contains(condition)) {\r\n                    foundElement = element;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (element.parentNode && ! foundElement) {\r\n            path(element.parentNode);\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return foundElement;\r\n}\r\n\r\n// Two digits\r\njSuites.two = function(value) {\r\n    value = '' + value;\r\n    if (value.length == 1) {\r\n        value = '0' + value;\r\n    }\r\n    return value;\r\n}\r\n\r\njSuites.sha512 = (function(str) {\r\n    function int64(msint_32, lsint_32) {\r\n        this.highOrder = msint_32;\r\n        this.lowOrder = lsint_32;\r\n    }\r\n\r\n    var H = [new int64(0x6a09e667, 0xf3bcc908), new int64(0xbb67ae85, 0x84caa73b),\r\n        new int64(0x3c6ef372, 0xfe94f82b), new int64(0xa54ff53a, 0x5f1d36f1),\r\n        new int64(0x510e527f, 0xade682d1), new int64(0x9b05688c, 0x2b3e6c1f),\r\n        new int64(0x1f83d9ab, 0xfb41bd6b), new int64(0x5be0cd19, 0x137e2179)];\r\n\r\n    var K = [new int64(0x428a2f98, 0xd728ae22), new int64(0x71374491, 0x23ef65cd),\r\n        new int64(0xb5c0fbcf, 0xec4d3b2f), new int64(0xe9b5dba5, 0x8189dbbc),\r\n        new int64(0x3956c25b, 0xf348b538), new int64(0x59f111f1, 0xb605d019),\r\n        new int64(0x923f82a4, 0xaf194f9b), new int64(0xab1c5ed5, 0xda6d8118),\r\n        new int64(0xd807aa98, 0xa3030242), new int64(0x12835b01, 0x45706fbe),\r\n        new int64(0x243185be, 0x4ee4b28c), new int64(0x550c7dc3, 0xd5ffb4e2),\r\n        new int64(0x72be5d74, 0xf27b896f), new int64(0x80deb1fe, 0x3b1696b1),\r\n        new int64(0x9bdc06a7, 0x25c71235), new int64(0xc19bf174, 0xcf692694),\r\n        new int64(0xe49b69c1, 0x9ef14ad2), new int64(0xefbe4786, 0x384f25e3),\r\n        new int64(0x0fc19dc6, 0x8b8cd5b5), new int64(0x240ca1cc, 0x77ac9c65),\r\n        new int64(0x2de92c6f, 0x592b0275), new int64(0x4a7484aa, 0x6ea6e483),\r\n        new int64(0x5cb0a9dc, 0xbd41fbd4), new int64(0x76f988da, 0x831153b5),\r\n        new int64(0x983e5152, 0xee66dfab), new int64(0xa831c66d, 0x2db43210),\r\n        new int64(0xb00327c8, 0x98fb213f), new int64(0xbf597fc7, 0xbeef0ee4),\r\n        new int64(0xc6e00bf3, 0x3da88fc2), new int64(0xd5a79147, 0x930aa725),\r\n        new int64(0x06ca6351, 0xe003826f), new int64(0x14292967, 0x0a0e6e70),\r\n        new int64(0x27b70a85, 0x46d22ffc), new int64(0x2e1b2138, 0x5c26c926),\r\n        new int64(0x4d2c6dfc, 0x5ac42aed), new int64(0x53380d13, 0x9d95b3df),\r\n        new int64(0x650a7354, 0x8baf63de), new int64(0x766a0abb, 0x3c77b2a8),\r\n        new int64(0x81c2c92e, 0x47edaee6), new int64(0x92722c85, 0x1482353b),\r\n        new int64(0xa2bfe8a1, 0x4cf10364), new int64(0xa81a664b, 0xbc423001),\r\n        new int64(0xc24b8b70, 0xd0f89791), new int64(0xc76c51a3, 0x0654be30),\r\n        new int64(0xd192e819, 0xd6ef5218), new int64(0xd6990624, 0x5565a910),\r\n        new int64(0xf40e3585, 0x5771202a), new int64(0x106aa070, 0x32bbd1b8),\r\n        new int64(0x19a4c116, 0xb8d2d0c8), new int64(0x1e376c08, 0x5141ab53),\r\n        new int64(0x2748774c, 0xdf8eeb99), new int64(0x34b0bcb5, 0xe19b48a8),\r\n        new int64(0x391c0cb3, 0xc5c95a63), new int64(0x4ed8aa4a, 0xe3418acb),\r\n        new int64(0x5b9cca4f, 0x7763e373), new int64(0x682e6ff3, 0xd6b2b8a3),\r\n        new int64(0x748f82ee, 0x5defb2fc), new int64(0x78a5636f, 0x43172f60),\r\n        new int64(0x84c87814, 0xa1f0ab72), new int64(0x8cc70208, 0x1a6439ec),\r\n        new int64(0x90befffa, 0x23631e28), new int64(0xa4506ceb, 0xde82bde9),\r\n        new int64(0xbef9a3f7, 0xb2c67915), new int64(0xc67178f2, 0xe372532b),\r\n        new int64(0xca273ece, 0xea26619c), new int64(0xd186b8c7, 0x21c0c207),\r\n        new int64(0xeada7dd6, 0xcde0eb1e), new int64(0xf57d4f7f, 0xee6ed178),\r\n        new int64(0x06f067aa, 0x72176fba), new int64(0x0a637dc5, 0xa2c898a6),\r\n        new int64(0x113f9804, 0xbef90dae), new int64(0x1b710b35, 0x131c471b),\r\n        new int64(0x28db77f5, 0x23047d84), new int64(0x32caab7b, 0x40c72493),\r\n        new int64(0x3c9ebe0a, 0x15c9bebc), new int64(0x431d67c4, 0x9c100d4c),\r\n        new int64(0x4cc5d4be, 0xcb3e42b6), new int64(0x597f299c, 0xfc657e2a),\r\n        new int64(0x5fcb6fab, 0x3ad6faec), new int64(0x6c44198c, 0x4a475817)];\r\n\r\n    var W = new Array(64);\r\n    var a, b, c, d, e, f, g, h, i, j;\r\n    var T1, T2;\r\n    var charsize = 8;\r\n\r\n    function utf8_encode(str) {\r\n        return unescape(encodeURIComponent(str));\r\n    }\r\n\r\n    function str2binb(str) {\r\n        var bin = [];\r\n        var mask = (1 << charsize) - 1;\r\n        var len = str.length * charsize;\r\n    \r\n        for (var i = 0; i < len; i += charsize) {\r\n            bin[i >> 5] |= (str.charCodeAt(i / charsize) & mask) << (32 - charsize - (i % 32));\r\n        }\r\n    \r\n        return bin;\r\n    }\r\n\r\n    function binb2hex(binarray) {\r\n        var hex_tab = \"0123456789abcdef\";\r\n        var str = \"\";\r\n        var length = binarray.length * 4;\r\n        var srcByte;\r\n\r\n        for (var i = 0; i < length; i += 1) {\r\n            srcByte = binarray[i >> 2] >> ((3 - (i % 4)) * 8);\r\n            str += hex_tab.charAt((srcByte >> 4) & 0xF) + hex_tab.charAt(srcByte & 0xF);\r\n        }\r\n\r\n        return str;\r\n    }\r\n\r\n    function safe_add_2(x, y) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (x.lowOrder & 0xFFFF) + (y.lowOrder & 0xFFFF);\r\n        msw = (x.lowOrder >>> 16) + (y.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (x.highOrder & 0xFFFF) + (y.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (x.highOrder >>> 16) + (y.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function safe_add_4(a, b, c, d) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF);\r\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function safe_add_5(a, b, c, d, e) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF) + (e.lowOrder & 0xFFFF);\r\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (e.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (e.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (e.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function maj(x, y, z) {\r\n        return new int64(\r\n            (x.highOrder & y.highOrder) ^ (x.highOrder & z.highOrder) ^ (y.highOrder & z.highOrder),\r\n            (x.lowOrder & y.lowOrder) ^ (x.lowOrder & z.lowOrder) ^ (y.lowOrder & z.lowOrder)\r\n        );\r\n    }\r\n\r\n    function ch(x, y, z) {\r\n        return new int64(\r\n            (x.highOrder & y.highOrder) ^ (~x.highOrder & z.highOrder),\r\n            (x.lowOrder & y.lowOrder) ^ (~x.lowOrder & z.lowOrder)\r\n        );\r\n    }\r\n\r\n    function rotr(x, n) {\r\n        if (n <= 32) {\r\n            return new int64(\r\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n)),\r\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n))\r\n            );\r\n        } else {\r\n            return new int64(\r\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n)),\r\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n))\r\n            );\r\n        }\r\n    }\r\n\r\n    function sigma0(x) {\r\n        var rotr28 = rotr(x, 28);\r\n        var rotr34 = rotr(x, 34);\r\n        var rotr39 = rotr(x, 39);\r\n\r\n        return new int64(\r\n            rotr28.highOrder ^ rotr34.highOrder ^ rotr39.highOrder,\r\n            rotr28.lowOrder ^ rotr34.lowOrder ^ rotr39.lowOrder\r\n        );\r\n    }\r\n\r\n    function sigma1(x) {\r\n        var rotr14 = rotr(x, 14);\r\n        var rotr18 = rotr(x, 18);\r\n        var rotr41 = rotr(x, 41);\r\n\r\n        return new int64(\r\n            rotr14.highOrder ^ rotr18.highOrder ^ rotr41.highOrder,\r\n            rotr14.lowOrder ^ rotr18.lowOrder ^ rotr41.lowOrder\r\n        );\r\n    }\r\n\r\n    function gamma0(x) {\r\n        var rotr1 = rotr(x, 1), rotr8 = rotr(x, 8), shr7 = shr(x, 7);\r\n\r\n        return new int64(\r\n            rotr1.highOrder ^ rotr8.highOrder ^ shr7.highOrder,\r\n            rotr1.lowOrder ^ rotr8.lowOrder ^ shr7.lowOrder\r\n        );\r\n    }\r\n\r\n    function gamma1(x) {\r\n        var rotr19 = rotr(x, 19);\r\n        var rotr61 = rotr(x, 61);\r\n        var shr6 = shr(x, 6);\r\n\r\n        return new int64(\r\n            rotr19.highOrder ^ rotr61.highOrder ^ shr6.highOrder,\r\n            rotr19.lowOrder ^ rotr61.lowOrder ^ shr6.lowOrder\r\n        );\r\n    }\r\n\r\n    function shr(x, n) {\r\n        if (n <= 32) {\r\n            return new int64(\r\n                x.highOrder >>> n,\r\n                x.lowOrder >>> n | (x.highOrder << (32 - n))\r\n            );\r\n        } else {\r\n            return new int64(\r\n                0,\r\n                x.highOrder << (32 - n)\r\n            );\r\n        }\r\n    }\r\n\r\n    var str = utf8_encode(str);\r\n    var strlen = str.length*charsize;\r\n    str = str2binb(str);\r\n\r\n    str[strlen >> 5] |= 0x80 << (24 - strlen % 32);\r\n    str[(((strlen + 128) >> 10) << 5) + 31] = strlen;\r\n\r\n    for (var i = 0; i < str.length; i += 32) {\r\n        a = H[0];\r\n        b = H[1];\r\n        c = H[2];\r\n        d = H[3];\r\n        e = H[4];\r\n        f = H[5];\r\n        g = H[6];\r\n        h = H[7];\r\n\r\n        for (var j = 0; j < 80; j++) {\r\n            if (j < 16) {\r\n                W[j] = new int64(str[j*2 + i], str[j*2 + i + 1]);\r\n            } else {\r\n                W[j] = safe_add_4(gamma1(W[j - 2]), W[j - 7], gamma0(W[j - 15]), W[j - 16]);\r\n            }\r\n\r\n            T1 = safe_add_5(h, sigma1(e), ch(e, f, g), K[j], W[j]);\r\n            T2 = safe_add_2(sigma0(a), maj(a, b, c));\r\n            h = g;\r\n            g = f;\r\n            f = e;\r\n            e = safe_add_2(d, T1);\r\n            d = c;\r\n            c = b;\r\n            b = a;\r\n            a = safe_add_2(T1, T2);\r\n        }\r\n\r\n        H[0] = safe_add_2(a, H[0]);\r\n        H[1] = safe_add_2(b, H[1]);\r\n        H[2] = safe_add_2(c, H[2]);\r\n        H[3] = safe_add_2(d, H[3]);\r\n        H[4] = safe_add_2(e, H[4]);\r\n        H[5] = safe_add_2(f, H[5]);\r\n        H[6] = safe_add_2(g, H[6]);\r\n        H[7] = safe_add_2(h, H[7]);\r\n    }\r\n\r\n    var binarray = [];\r\n    for (var i = 0; i < H.length; i++) {\r\n        binarray.push(H[i].highOrder);\r\n        binarray.push(H[i].lowOrder);\r\n    }\r\n\r\n    return binb2hex(binarray);\r\n});\r\n\r\nif (! jSuites.login) {\r\n    jSuites.login = {};\r\n    jSuites.login.sha512 = jSuites.sha512;\r\n}\r\n\r\njSuites.image = jSuites.upload = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        type: 'image',\r\n        extension: '*',\r\n        input: false,\r\n        minWidth: false,\r\n        maxWidth: null,\r\n        maxHeight: null,\r\n        maxJpegSizeBytes: null, // For example, 350Kb would be 350000\r\n        onchange: null,\r\n        multiple: false,\r\n        remoteParser: null,\r\n        text:{\r\n            extensionNotAllowed:'The extension is not allowed',\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Multiple\r\n    if (obj.options.multiple == true) {\r\n        el.setAttribute('data-multiple', true);\r\n    }\r\n\r\n    // Container\r\n    el.content = [];\r\n\r\n    // Upload icon\r\n    el.classList.add('jupload');\r\n\r\n    if (obj.options.input == true) {\r\n        el.classList.add('input');\r\n    }\r\n\r\n    obj.add = function(data) {\r\n        // Reset container for single files\r\n        if (obj.options.multiple == false) {\r\n            el.content = [];\r\n            el.innerText = '';\r\n        }\r\n\r\n        // Append to the element\r\n        if (obj.options.type == 'image') {\r\n            var img = document.createElement('img');\r\n            img.setAttribute('src', data.file);\r\n            img.setAttribute('tabindex', -1);\r\n            if (! el.getAttribute('name')) {\r\n                img.className = 'jfile';\r\n                img.content = data;\r\n            }\r\n            el.appendChild(img);\r\n        } else {\r\n            if (data.name) {\r\n                var name = data.name;\r\n            } else {\r\n                var name = data.file;\r\n            }\r\n            var div = document.createElement('div');\r\n            div.innerText = name || obj.options.type;\r\n            div.classList.add('jupload-item');\r\n            div.setAttribute('tabindex', -1);\r\n            el.appendChild(div);\r\n        }\r\n\r\n        if (data.content) {\r\n            data.file = jSuites.guid();\r\n        }\r\n\r\n        // Push content\r\n        el.content.push(data);\r\n\r\n        // Onchange\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, data);\r\n        }\r\n    }\r\n\r\n    obj.addFromFile = function(file) {\r\n        var type = file.type.split('/');\r\n        if (type[0] == obj.options.type) {\r\n            var readFile = new FileReader();\r\n            readFile.addEventListener(\"load\", function (v) {\r\n                var data = {\r\n                    file: v.srcElement.result,\r\n                    extension: file.name.substr(file.name.lastIndexOf('.') + 1),\r\n                    name: file.name,\r\n                    size: file.size,\r\n                    lastmodified: file.lastModified,\r\n                    content: v.srcElement.result,\r\n                }\r\n\r\n                obj.add(data);\r\n            });\r\n\r\n            readFile.readAsDataURL(file);\r\n        } else {\r\n            alert(obj.options.text.extensionNotAllowed);\r\n        }\r\n    }\r\n\r\n    obj.addFromUrl = function(src) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                var type = extension[0].replace('data:','');\r\n                if (type == obj.options.type) {\r\n                    var data = {\r\n                        file: src,\r\n                        name: '',\r\n                        extension: extension[1],\r\n                        content: src,\r\n                    }\r\n                    obj.add(data);\r\n                } else {\r\n                    alert(obj.options.text.extensionNotAllowed);\r\n                }\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n                // Get remove content\r\n                jSuites.ajax({\r\n                    url: src,\r\n                    type: 'GET',\r\n                    dataType: 'blob',\r\n                    success: function(data) {\r\n                        //add(extension[0].replace('data:',''), data);\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    var getDataURL = function(canvas, type) {\r\n        var compression = 0.92;\r\n        var lastContentLength = null;\r\n        var content = canvas.toDataURL(type, compression);\r\n        while (obj.options.maxJpegSizeBytes && type === 'image/jpeg' &&\r\n               content.length > obj.options.maxJpegSizeBytes && content.length !== lastContentLength) {\r\n            // Apply the compression\r\n            compression *= 0.9;\r\n            lastContentLength = content.length;\r\n            content = canvas.toDataURL(type, compression);\r\n        }\r\n        return content;\r\n    }\r\n\r\n    var mime = obj.options.type + '/' + obj.options.extension;\r\n    var input = document.createElement('input');\r\n    input.type = 'file';\r\n    input.setAttribute('accept', mime);\r\n    input.onchange = function() {\r\n        for (var i = 0; i < this.files.length; i++) {\r\n            obj.addFromFile(this.files[i]);\r\n        }\r\n    }\r\n\r\n    // Allow multiple files\r\n    if (obj.options.multiple == true) {\r\n        input.setAttribute('multiple', true);\r\n    }\r\n\r\n    var current = null;\r\n\r\n    el.addEventListener(\"click\", function(e) {\r\n        current = null;\r\n        if (! el.children.length || e.target === el) {\r\n            jSuites.click(input);\r\n        } else {\r\n            if (e.target.parentNode == el) {\r\n                current = e.target;\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener(\"dblclick\", function(e) {\r\n        jSuites.click(input);\r\n    });\r\n\r\n    el.addEventListener('dragenter', function(e) {\r\n        el.style.border = '1px dashed #000';\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragstop', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('keydown', function(e) {\r\n        if (current && e.which == 46) {\r\n            var index = Array.prototype.indexOf.call(el.children, current);\r\n            if (index >= 0) {\r\n                el.content.splice(index, 1);\r\n                current.remove();\r\n                current = null;\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();  \r\n        e.stopPropagation();\r\n\r\n        var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n        var file = (e.originalEvent || e).dataTransfer.files;\r\n\r\n        if (file.length) {\r\n            for (var i = 0; i < e.dataTransfer.files.length; i++) {\r\n                obj.addFromFile(e.dataTransfer.files[i]);\r\n            }\r\n        } else if (html) {\r\n            if (obj.options.multiple == false) {\r\n                el.innerText = '';\r\n            }\r\n\r\n            // Create temp element\r\n            var div = document.createElement('div');\r\n            div.innerHTML = html;\r\n\r\n            // Extract images\r\n            var img = div.querySelectorAll('img');\r\n\r\n            if (img.length) {\r\n                for (var i = 0; i < img.length; i++) {\r\n                    obj.addFromUrl(img[i].src);\r\n                }\r\n            }\r\n        }\r\n\r\n        el.style.border = '1px solid #eee';\r\n\r\n        return false;\r\n    });\r\n\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            return el.content && el.content.length ? el.content : null;\r\n        } else {\r\n            // Reset\r\n            el.innerText = '';\r\n            el.content = [];\r\n\r\n            if (val) {\r\n                if (Array.isArray(val)) {\r\n                    for (var i = 0; i < val.length; i++) {\r\n                        if (typeof(val[i]) == 'string') {\r\n                            obj.add({ file: val[i] });\r\n                        } else {\r\n                            obj.add(val[i]);\r\n                        }\r\n                    }\r\n                } else if (typeof(val) == 'string') {\r\n                    obj.add({ file: val });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    el.upload = el.image = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.image.create = function(data) {\r\n    var img = document.createElement('img');\r\n    img.setAttribute('src', data.file);\r\n    img.className = 'jfile';\r\n    img.setAttribute('tabindex', -1);\r\n    img.content = data;\r\n\r\n    return img;\r\n}\r\n\r\n\r\njSuites.lazyLoading = (function(el, options) {\r\n    var obj = {}\r\n\r\n    // Mandatory options\r\n    if (! options.loadUp || typeof(options.loadUp) != 'function') {\r\n        options.loadUp = function() {\r\n            return false;\r\n        }\r\n    }\r\n    if (! options.loadDown || typeof(options.loadDown) != 'function') {\r\n        options.loadDown = function() {\r\n            return false;\r\n        }\r\n    }\r\n    // Timer ms\r\n    if (! options.timer) {\r\n        options.timer = 100;\r\n    }\r\n\r\n    // Timer\r\n    var timeControlLoading = null;\r\n\r\n    // Controls\r\n    var scrollControls = function(e) {\r\n        if (timeControlLoading == null) {\r\n            var event = false;\r\n            var scrollTop = el.scrollTop;\r\n            if (el.scrollTop + (el.clientHeight * 2) >= el.scrollHeight) {\r\n                if (options.loadDown()) {\r\n                    if (scrollTop == el.scrollTop) {\r\n                        el.scrollTop = el.scrollTop - (el.clientHeight);\r\n                    }\r\n                    event = true;\r\n                }\r\n            } else if (el.scrollTop <= el.clientHeight) {\r\n                if (options.loadUp()) {\r\n                    if (scrollTop == el.scrollTop) {\r\n                        el.scrollTop = el.scrollTop + (el.clientHeight);\r\n                    }\r\n                    event = true;\r\n                }\r\n            }\r\n\r\n            timeControlLoading = setTimeout(function() {\r\n                timeControlLoading = null;\r\n            }, options.timer);\r\n\r\n            if (event) {\r\n                if (typeof(options.onupdate) == 'function') {\r\n                    options.onupdate();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Onscroll\r\n    el.onscroll = function(e) {\r\n        scrollControls(e);\r\n    }\r\n\r\n    el.onwheel = function(e) {\r\n        scrollControls(e);\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.loading = (function() {\r\n    var obj = {};\r\n\r\n    var loading = null;\r\n\r\n    obj.show = function() {\r\n        if (! loading) {\r\n            loading = document.createElement('div');\r\n            loading.className = 'jloading';\r\n        }\r\n        document.body.appendChild(loading);\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (loading && loading.parentNode) {\r\n            document.body.removeChild(loading);\r\n        }\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.mask = (function() {\r\n    // Currency \r\n    var tokens = {\r\n        // Currency tokens\r\n        currency: [ '#(.{1})##0?(.{1}0+)?( ?;(.*)?)?', '#' ],\r\n        // Percentage\r\n        percentage: [ '0{1}(.{1}0+)?%' ],\r\n        // Number\r\n        numeric: [ '0{1}(.{1}0+)?' ],\r\n        // Data tokens\r\n        datetime: [ 'YYYY', 'YYY', 'YY', 'MMMMM', 'MMMM', 'MMM', 'MM', 'DDDDD', 'DDDD', 'DDD', 'DD', 'DY', 'DAY', 'WD', 'D', 'Q', 'HH24', 'HH12', 'HH', '\\\\[H\\\\]', 'H', 'AM/PM', 'PM', 'AM', 'MI', 'SS', 'MS', 'MONTH', 'MON', 'Y', 'M' ],\r\n        // Other\r\n        general: [ 'A', '0', '[0-9a-zA-Z\\$]+', '.']\r\n    }\r\n\r\n    var getDate = function() {\r\n        if (this.mask.toLowerCase().indexOf('[h]') !== -1) {\r\n            var m = 0;\r\n            if (this.date[4]) {\r\n                m = parseFloat(this.date[4] / 60);\r\n            }\r\n            var v = parseInt(this.date[3]) + m;\r\n            v /= 24;\r\n        } else if (! (this.date[0] && this.date[1] && this.date[2]) && (this.date[3] || this.date[4])) {\r\n            v = jSuites.two(this.date[3]) + ':' + jSuites.two(this.date[4]) + ':' + jSuites.two(this.date[5]) \r\n        } else {\r\n            if (this.date[0] && this.date[1] && ! this.date[2]) {\r\n                this.date[2] = 1;\r\n            }\r\n            v = jSuites.two(this.date[0]) + '-' + jSuites.two(this.date[1]) + '-' + jSuites.two(this.date[2]);\r\n\r\n            if (this.date[3] || this.date[4] || this.date[5]) {\r\n                v += ' ' + jSuites.two(this.date[3]) + ':' + jSuites.two(this.date[4]) + ':' + jSuites.two(this.date[5]);\r\n            }\r\n        }\r\n\r\n        return v;\r\n    }\r\n\r\n    var isBlank = function(v) {\r\n        return v === null || v === '' || v === undefined ? true : false;\r\n    }\r\n\r\n    var isFormula = function(value) {\r\n        return (''+value).chartAt(0) == '=';\r\n    }\r\n\r\n    var isNumeric = function(t) {\r\n        return t === 'currency' || t === 'percentage' || t === 'numeric' ? true : false;\r\n    }\r\n    /**\r\n     * Get the decimal defined in the mask configuration\r\n     */\r\n    var getDecimal = function(v) {\r\n        if (v && Number(v) == v) {\r\n            return '.';\r\n        } else {\r\n            if (this.options.decimal) {\r\n                return this.options.decimal;\r\n            } else {\r\n                if (this.locale) {\r\n                    var t = Intl.NumberFormat(this.locale).format(1.1);\r\n                    return this.options.decimal = t[1];\r\n                } else {\r\n                    if (! v) {\r\n                        v  = this.mask;\r\n                    }\r\n                    var e = new RegExp('0{1}(.{1})0+', 'ig');\r\n                    var t = e.exec(v);\r\n                    if (t && t[1] && t[1].length == 1) {\r\n                        // Save decimal\r\n                        this.options.decimal = t[1];\r\n                        // Return decimal\r\n                        return t[1];\r\n                    } else {\r\n                        // Did not find any decimal last resort the default\r\n                        var e = new RegExp('#,##', 'ig');\r\n                        if ((v && v.match(e)) || '1.1'.toLocaleString().substring(1,2) == '.') {\r\n                            this.options.decimal = '.';\r\n                        } else {\r\n                            this.options.decimal = ',';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.options.decimal) {\r\n            return this.options.decimal;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    var ParseValue = function(v, decimal) {\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n\r\n        // Get decimal\r\n        if (! decimal) {\r\n            decimal = getDecimal.call(this);\r\n        }\r\n\r\n        // New value\r\n        v = (''+v).split(decimal);\r\n        v[0] = v[0].match(/[\\-0-9]+/g, '');\r\n        if (v[0]) {\r\n            v[0] = v[0].join('');\r\n        }\r\n        if (v[0] || v[1]) {\r\n            if (v[1] !== undefined) {\r\n                v[1] = v[1].match(/[0-9]+/g, '');\r\n                if (v[1]) {\r\n                    v[1] = v[1].join('');\r\n                } else {\r\n                    v[1] = '';\r\n                }\r\n            }\r\n        } else {\r\n            return '';\r\n        }\r\n\r\n        return v;\r\n    }\r\n\r\n    var FormatValue = function(v) {\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n        // Get decimal\r\n        var d = getDecimal.call(this);\r\n        // Convert value\r\n        var o = Object.create(this.options || {});\r\n        if (! o.minimumFractionDigits) {\r\n            o.minimumFractionDigits = 1;\r\n        }\r\n        // Parse value\r\n        v = ParseValue.call(this, v);\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n        // Temporary value\r\n        if (v[0]) {\r\n            var t = parseFloat(v.join('.'));\r\n            if (o.style == 'percent') {\r\n                t /= 100;\r\n            }\r\n        } else {\r\n            var t = null;\r\n        }\r\n        var n = new Intl.NumberFormat(this.locale, o).format(t);\r\n        n = n.split(d);\r\n        var s = n[1].replace(/[0-9]*/g, '');\r\n        if (s) {\r\n            n[2] = s;\r\n        }\r\n        if (v[1] !== undefined) {\r\n            n[1] = d + v[1];\r\n        } else {\r\n            n[1] = '';\r\n        }\r\n\r\n        return n.join('');\r\n    }\r\n\r\n    var Format = function(e) {\r\n        var v = Value.call(e);\r\n        if (! v) {\r\n            return;\r\n        }\r\n\r\n        // Get decimal\r\n        var d = getDecimal.call(this);\r\n        var n = FormatValue.call(this, v);\r\n        var t = (n.length) - v.length;\r\n        var index = Caret.call(e) + t;\r\n        // Set value and update caret\r\n        Value.call(e, n, index, true);\r\n    }\r\n\r\n    var Extract = function(v) {\r\n        // Keep the raw value\r\n        var current = ParseValue.call(this, v);\r\n        if (current) {\r\n            return parseFloat(current.join('.'));\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Caret getter and setter methods\r\n     */\r\n    var Caret = function(index, adjustNumeric) {\r\n        if (index === undefined) {\r\n            if (this.tagName == 'DIV') {\r\n                var pos = 0;\r\n                var s = window.getSelection();\r\n                if (s) {\r\n                    if (s.rangeCount !== 0) {\r\n                        var r = s.getRangeAt(0);\r\n                        var p = r.cloneRange();\r\n                        p.selectNodeContents(this);\r\n                        p.setEnd(r.endContainer, r.endOffset);\r\n                        pos = p.toString().length;\r\n                    }\r\n                }\r\n                return pos;\r\n            } else {\r\n                return this.selectionStart;\r\n            }\r\n        } else {\r\n            // Get the current value\r\n            var n = Value.call(this);\r\n\r\n            // Review the position\r\n            if (adjustNumeric) {\r\n                var p = null;\r\n                for (var i = 0; i < n.length; i++) {\r\n                    if (n[i].match(/[\\-0-9]/g) || n[i] == '.' || n[i] == ',') {  \r\n                        p = i;\r\n                    }\r\n                }\r\n\r\n                // If the string has no numbers\r\n                if (p === null) {\r\n                    p = n.indexOf(' ');\r\n                }\r\n\r\n                if (index >= p) {\r\n                    index = p + 1;\r\n                }\r\n            }\r\n\r\n            // Do not update caret\r\n            if (index > n.length) {\r\n                index = n.length;\r\n            }\r\n\r\n            if (index) {\r\n                // Set caret\r\n                if (this.tagName == 'DIV') {\r\n                    var s = window.getSelection();\r\n                    var r = document.createRange();\r\n                    r.setStart(this.childNodes[0], index);\r\n                    s.removeAllRanges();\r\n                    s.addRange(r);\r\n                } else {\r\n                    this.selectionStart = index;\r\n                    this.selectionEnd = index;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Value getter and setter method\r\n     */\r\n    var Value = function(v, updateCaret, adjustNumeric) {\r\n        if (this.tagName == 'DIV') {\r\n            if (v === undefined) {\r\n                return this.innerText;\r\n            } else {\r\n                if (this.innerText !== v) {\r\n                    this.innerText = v;\r\n\r\n                    if (updateCaret) {\r\n                        Caret.call(this, updateCaret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            if (v === undefined) {\r\n                return this.value;\r\n            } else {\r\n                if (this.value !== v) {\r\n                    this.value = v;\r\n                    if (updateCaret) {\r\n                        Caret.call(this, updateCaret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Labels\r\n    var weekDaysFull = jSuites.calendar.weekdays;\r\n    var weekDays = jSuites.calendar.weekdaysShort;\r\n    var monthsFull = jSuites.calendar.months;\r\n    var months = jSuites.calendar.monthsShort;\r\n\r\n    var parser = {\r\n        'YEAR': function(v, s) {\r\n            var y = ''+new Date().getFullYear();\r\n\r\n            if (typeof(this.values[this.index]) === 'undefined') {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (parseInt(v) >= 0 && parseInt(v) <= 10) {\r\n                if (this.values[this.index].length < s) {\r\n                    this.values[this.index] += v;\r\n                }\r\n            }\r\n            if (this.values[this.index].length == s) {\r\n                if (s == 2) {\r\n                    var y = y.substr(0,2) + this.values[this.index];\r\n                } else if (s == 3) {\r\n                    var y = y.substr(0,1) + this.values[this.index];\r\n                } else if (s == 4) {\r\n                    var y = this.values[this.index];\r\n                }\r\n                this.date[0] = y;\r\n                this.index++;\r\n            }\r\n        },\r\n        'YYYY': function(v) {\r\n            parser.YEAR.call(this, v, 4);\r\n        },\r\n        'YYY': function(v) {\r\n            parser.YEAR.call(this, v, 3);\r\n        },\r\n        'YY': function(v) {\r\n            parser.YEAR.call(this, v, 2);\r\n        },\r\n        'FIND': function(v, a) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var pos = 0;\r\n            var count = 0;\r\n            var value = (this.values[this.index] + v).toLowerCase();\r\n            for (var i = 0; i < a.length; i++) {\r\n                if (a[i].toLowerCase().indexOf(value) == 0) {\r\n                    pos = i;\r\n                    count++;\r\n                }\r\n            }\r\n            if (count > 1) {\r\n                this.values[this.index] += v;\r\n            } else if (count == 1) {\r\n                this.values[this.index] = a[pos];\r\n                this.index++;\r\n\r\n                return pos;\r\n            }\r\n        },\r\n        'MMM': function(v) {\r\n            var ret = parser.FIND.call(this, v, months);\r\n            if (ret !== undefined) {\r\n                this.date[1] = ret + 1;\r\n            }\r\n        },\r\n        'MMMM': function(v) {\r\n            var ret = parser.FIND.call(this, v, monthsFull);\r\n            if (ret !== undefined) {\r\n                this.date[1] = ret + 1;\r\n            }\r\n        },\r\n        'MMMMM': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var pos = 0;\r\n            var count = 0;\r\n            var value = (this.values[this.index] + v).toLowerCase();\r\n            for (var i = 0; i < monthsFull.length; i++) {\r\n                if (monthsFull[i][0].toLowerCase().indexOf(value) == 0) {\r\n                    this.values[this.index] = monthsFull[i][0];\r\n                    this.date[1] = i + 1;\r\n                    this.index++;\r\n                    break;\r\n                }\r\n            }\r\n        },\r\n        'MM': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 1 && parseInt(v) < 10) {\r\n                    this.date[1] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 2) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                    this.date[1] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] == 0 && parseInt(v) > 0 && parseInt(v) < 10) {\r\n                    this.date[1] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'M': function(v) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (isBlank(this.values[this.index])) {\r\n                    this.values[this.index] = v;\r\n                    if (v > 1) {\r\n                        this.date[1] = this.values[this.index];\r\n                        this.index++;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                        this.date[1] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 0 && parseInt(v) > 0) {\r\n                        this.date[1] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else {\r\n                        var test = true;\r\n                    }\r\n                }\r\n            } else {\r\n                var test = true;\r\n            }\r\n\r\n            // Re-test\r\n            if (test == true) {\r\n                var t = parseInt(this.values[this.index]);\r\n                if (t > 0 && t < 12) {\r\n                    this.date[2] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'D': function(v) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (isBlank(this.values[this.index])) {\r\n                    this.values[this.index] = v;\r\n                    if (parseInt(v) > 3) {\r\n                        this.date[2] = this.values[this.index];\r\n                        this.index++;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 3 && parseInt(v) < 2) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 1 || this.values[this.index] == 2) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 0 && parseInt(v) > 0) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else {\r\n                        var test = true;\r\n                    }\r\n                }\r\n            } else {\r\n                var test = true;\r\n            }\r\n\r\n            // Re-test\r\n            if (test == true) {\r\n                var t = parseInt(this.values[this.index]);\r\n                if (t > 0 && t < 32) {\r\n                    this.date[2] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'DD': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 3 && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 3 && parseInt(v) < 2) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if ((this.values[this.index] == 1 || this.values[this.index] == 2) && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] == 0 && parseInt(v) > 0 && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'DDD': function(v) {\r\n            parser.FIND.call(this, v, weekDays);\r\n        },\r\n        'DDDD': function(v) {\r\n            parser.FIND.call(this, v, weekDaysFull);\r\n        },\r\n        'HH12': function(v, two) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 1 && parseInt(v) < 10) {\r\n                    if (two) {\r\n                        v = 0 + v;\r\n                    }\r\n                    this.date[3] = this.values[this.index] = v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                    this.date[3] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] < 1 && parseInt(v) < 10) {\r\n                    this.date[3] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'HH24': function(v, two) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (this.values[this.index] == null || this.values[this.index] == '') {\r\n                    if (parseInt(v) > 2 && parseInt(v) < 10) {\r\n                        if (two) {\r\n                            v = 0 + v;\r\n                        }\r\n                        this.date[3] = this.values[this.index] = v;\r\n                        this.index++;\r\n                    } else if (parseInt(v) < 10) {\r\n                        this.values[this.index] = v;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 2 && parseInt(v) < 4) {\r\n                        this.date[3] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] < 2 && parseInt(v) < 10) {\r\n                        this.date[3] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        'HH': function(v) {\r\n            parser['HH24'].call(this, v, 1);\r\n        },\r\n        'H': function(v) {\r\n            parser['HH24'].call(this, v, 0);\r\n        },\r\n        '\\\\[H\\\\]': function(v) {\r\n            if (this.values[this.index] == undefined) {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (v.match(/[0-9]/g)) {\r\n                this.date[3] = this.values[this.index] += v;\r\n            } else {\r\n                if (this.values[this.index].match(/[0-9]/g)) {\r\n                    this.date[3] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'N60': function(v, i) {\r\n            if (this.values[this.index] == null || this.values[this.index] == '') {\r\n                if (parseInt(v) > 5 && parseInt(v) < 10) {\r\n                    this.date[i] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (parseInt(v) < 10) {\r\n                    this.date[i] = this.values[this.index] += v;\r\n                    this.index++;\r\n                 }\r\n            }\r\n        },\r\n        'MI': function(v) {\r\n            parser.N60.call(this, v, 4);\r\n        },\r\n        'SS': function(v) {\r\n            parser.N60.call(this, v, 5);\r\n        },\r\n        'AM/PM': function(v) {\r\n            this.values[this.index] = '';\r\n            if (v) {\r\n                if (this.date[3] > 12) {\r\n                    this.values[this.index] = 'PM';\r\n                } else {\r\n                    this.values[this.index] = 'AM';\r\n                }\r\n            }\r\n            this.index++;\r\n        },\r\n        'WD': function(v) {\r\n            if (typeof(this.values[this.index]) === 'undefined') {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (parseInt(v) >= 0 && parseInt(v) < 7) {\r\n                this.values[this.index] = v;\r\n            }\r\n            if (this.value[this.index].length == 1) {\r\n                this.index++;\r\n            }\r\n        },\r\n        '0{1}(.{1}0+)?': function(v) {\r\n            // Get decimal\r\n            var decimal = getDecimal.call(this);\r\n            // Negative number\r\n            var neg = false;\r\n            // Create if is blank\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            } else {\r\n                if (this.values[this.index] == '-') {\r\n                    neg = true;\r\n                }\r\n            }\r\n            var current = ParseValue.call(this, this.values[this.index], decimal);\r\n            if (current) {\r\n                this.values[this.index] = current.join(decimal);\r\n            }\r\n            // New entry\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (this.values[this.index] != '0' || v == decimal) {\r\n                    this.values[this.index] += v;\r\n                }\r\n            } else if (decimal && v == decimal) {\r\n                if (this.values[this.index].indexOf(decimal) == -1) {\r\n                    if (! this.values[this.index]) {\r\n                        this.values[this.index] = '0';\r\n                    }\r\n                    this.values[this.index] += v;\r\n                }\r\n            } else if (v == '-') {\r\n                // Negative signed\r\n                neg = true;\r\n            }\r\n\r\n            if (neg === true && this.values[this.index][0] !== '-') {\r\n                this.values[this.index] = '-' + this.values[this.index];\r\n            }\r\n        },\r\n        '0{1}(.{1}0+)?%': function(v) {\r\n            parser['0{1}(.{1}0+)?'].call(this, v);\r\n\r\n            if (this.values[this.index].match(/[\\-0-9]/g)) {\r\n                if (this.values[this.index] && this.values[this.index].indexOf('%') == -1) {\r\n                    this.values[this.index] += '%';\r\n                }\r\n            } else {\r\n                this.values[this.index] = '';\r\n            }\r\n        },\r\n        '#(.{1})##0?(.{1}0+)?( ?;(.*)?)?': function(v) {\r\n            // Parse number\r\n            parser['0{1}(.{1}0+)?'].call(this, v);\r\n            // Get decimal\r\n            var decimal = getDecimal.call(this);\r\n            // Get separator\r\n            var separator = this.tokens[this.index].substr(1,1);\r\n            // Negative\r\n            var negative = this.values[this.index][0] === '-' ? true : false;\r\n            // Current value\r\n            var current = ParseValue.call(this, this.values[this.index], decimal);\r\n\r\n            // Get main and decimal parts\r\n            if (current !== '') {\r\n                // Format number\r\n                var n = current[0].match(/[0-9]/g);\r\n                if (n) {\r\n                    // Format\r\n                    n = n.join('');\r\n                    var t = [];\r\n                    var s = 0;\r\n                    for (var j = n.length - 1; j >= 0 ; j--) {\r\n                        t.push(n[j]);\r\n                        s++;\r\n                        if (! (s % 3)) {\r\n                            t.push(separator);\r\n                        }\r\n                    }\r\n                    t = t.reverse();\r\n                    current[0] = t.join('');\r\n                    if (current[0].substr(0,1) == separator) {\r\n                        current[0] = current[0].substr(1);\r\n                    }\r\n                } else {\r\n                    current[0] = '';\r\n                }\r\n\r\n                // Value\r\n                this.values[this.index] = current.join(decimal);\r\n\r\n                // Negative\r\n                if (negative) {\r\n                    this.values[this.index] = '-' + this.values[this.index];\r\n                }\r\n            }\r\n        },\r\n        '0': function(v) {\r\n            if (v.match(/[0-9]/g)) {\r\n                this.values[this.index] = v;\r\n                this.index++;\r\n            }\r\n        },\r\n        '[0-9a-zA-Z$]+': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var t = this.tokens[this.index];\r\n            var s = this.values[this.index];\r\n            var i = s.length;\r\n\r\n            if (t[i] == v) {\r\n                this.values[this.index] += v;\r\n\r\n                if (this.values[this.index] == t) {\r\n                    this.index++;\r\n                }\r\n            } else {\r\n                this.values[this.index] = t;\r\n                this.index++;\r\n\r\n                if (v.match(/[\\-0-9]/g)) {\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'A': function(v) {\r\n            if (v.match(/[a-zA-Z]/gi)) {\r\n                this.values[this.index] = v;\r\n                this.index++;\r\n            }\r\n        },\r\n        '.': function(v) {\r\n            parser['[0-9a-zA-Z$]+'].call(this, v);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the tokens in the mask string\r\n     */\r\n    var getTokens = function(str) {\r\n        if (this.type == 'general') {\r\n            var t = [].concat(tokens.general);\r\n        } else {\r\n            var t = [].concat(tokens.currency, tokens.datetime, tokens.percentage, tokens.numeric, tokens.general);\r\n        }\r\n        // Expression to extract all tokens from the string\r\n        var e = new RegExp(t.join('|'), 'gi');\r\n        // Extract\r\n        return str.match(e);\r\n    }\r\n\r\n    /**\r\n     * Get the method of one given token\r\n     */\r\n    var getMethod = function(str) {\r\n        if (! this.type) {\r\n            var types = Object.keys(tokens);\r\n        } else if (this.type == 'general') {\r\n            var types = [ 'general' ];\r\n        } else if (this.type == 'datetime') {\r\n            var types = [ 'numeric', 'datetime', 'general' ];\r\n        } else {\r\n            var types = [ 'currency', 'percentage', 'numeric', 'general' ];\r\n        }\r\n\r\n        // Found\r\n        for (var i = 0; i < types.length; i++) {\r\n            var type = types[i];\r\n            for (var j = 0; j < tokens[type].length; j++) {\r\n                var e = new RegExp(tokens[type][j], 'gi');\r\n                var r = str.match(e);\r\n                if (r) {\r\n                    return { type: type, method: tokens[type][j] }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Identify each method for each token\r\n     */\r\n    var getMethods = function(t) {\r\n        var result = [];\r\n        for (var i = 0; i < t.length; i++) {\r\n            var m = getMethod.call(this, t[i]);\r\n            if (m) {\r\n                result.push(m.method);\r\n            } else {\r\n                result.push(null);\r\n            }\r\n        }\r\n\r\n        // Compatibility with excel\r\n        for (var i = 0; i < result.length; i++) {\r\n            if (result[i] == 'MM') {\r\n                // Not a month, correct to minutes\r\n                if (result[i-1] && result[i-1].indexOf('H') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i-2] && result[i-2].indexOf('H') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i+1] && result[i+1].indexOf('S') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i+2] && result[i+2].indexOf('S') >= 0) {\r\n                    result[i] = 'MI';\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Get the type for one given token\r\n     */\r\n    var getType = function(str) {\r\n        var m = getMethod.call(this, str);\r\n        if (m) {\r\n            var type = m.type;\r\n        }\r\n\r\n        if (type) {\r\n            var numeric = 0;\r\n            // Make sure the correct type\r\n            var t = getTokens.call(this, str);\r\n            for (var i = 0; i < t.length; i++) {\r\n                m = getMethod.call(this, t[i]);\r\n                if (m && isNumeric(m.type)) {\r\n                    numeric++;\r\n                }\r\n            }\r\n            if (numeric > 1) {\r\n                type = 'general';\r\n            }\r\n        }\r\n\r\n        return type;\r\n    }\r\n\r\n    /**\r\n     * Parse character per character using the detected tokens in the mask\r\n     */\r\n    var parse = function() {\r\n        // Parser method for this position\r\n        if (typeof(parser[this.methods[this.index]]) == 'function') {\r\n            parser[this.methods[this.index]].call(this, this.value[this.position]);\r\n            this.position++;\r\n        } else {\r\n            this.values[this.index] = this.tokens[this.index];\r\n            this.index++;\r\n        }\r\n    }\r\n\r\n    var isFormula = function(value) {\r\n        var v = (''+value)[0];\r\n        return v == '=' ? true : false;\r\n    }\r\n\r\n    var toPlainString = function(num) {\r\n        return (''+ +num).replace(/(-?)(\\d*)\\.?(\\d*)e([+-]\\d+)/,\r\n          function(a,b,c,d,e) {\r\n            return e < 0\r\n              ? b + '0.' + Array(1-e-c.length).join(0) + c + d\r\n              : b + c + d + Array(e-d.length+1).join(0);\r\n          });\r\n    }\r\n\r\n    /**\r\n     * Mask function\r\n     * @param {mixed|string} JS input or a string to be parsed\r\n     * @param {object|string} When the first param is a string, the second is the mask or object with the mask options\r\n     */\r\n    var obj = function(e, config, returnObject) {\r\n        // Options\r\n        var r = null;\r\n        var t = null;\r\n        var o = {\r\n            // Element\r\n            input: null,\r\n            // Current value\r\n            value: null,\r\n            // Mask options\r\n            options: {},\r\n            // New values for each token found\r\n            values: [],\r\n            // Token position\r\n            index: 0,\r\n            // Character position\r\n            position: 0,\r\n            // Date raw values\r\n            date: [0,0,0,0,0,0],\r\n            // Raw number for the numeric values\r\n            number: 0,\r\n        }\r\n\r\n        // This is a JavaScript Event\r\n        if (typeof(e) == 'object') {\r\n            // Element\r\n            o.input = e.target;\r\n            // Current value\r\n            o.value = Value.call(e.target);\r\n            // Current caret position\r\n            o.caret = Caret.call(e.target);\r\n            // Mask\r\n            if (t = e.target.getAttribute('data-mask')) {\r\n                o.mask = t;\r\n            }\r\n            // Type\r\n            if (t = e.target.getAttribute('data-type')) {\r\n                o.type = t;\r\n            }\r\n            // Options\r\n            if (e.target.mask) {\r\n                if (e.target.mask.options) {\r\n                    o.options = e.target.mask.options;\r\n                }\r\n                if (e.target.mask.locale) {\r\n                    o.locale = e.target.mask.locale;\r\n                }\r\n            } else {\r\n                // Locale\r\n                if (t = e.target.getAttribute('data-locale')) {\r\n                    o.locale = t;\r\n                    if (o.mask) {\r\n                        o.options.style = o.mask;\r\n                    }\r\n                }\r\n            }\r\n            // Extra configuration\r\n            if (e.target.attributes && e.target.attributes.length) {\r\n                for (var i = 0; i < e.target.attributes.length; i++) {\r\n                    var k = e.target.attributes[i].name;\r\n                    var v = e.target.attributes[i].value;\r\n                    if (k.substr(0,4) == 'data') {\r\n                        o.options[k.substr(5)] = v;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            // Options\r\n            if (typeof(config) == 'string') {\r\n                // Mask\r\n                o.mask = config;\r\n            } else {\r\n                // Mask\r\n                var k = Object.keys(config);\r\n                for (var i = 0; i < k.length; i++) {\r\n                    o[k[i]] = config[k[i]];\r\n                }\r\n            }\r\n\r\n            if (typeof(e) === 'number') {\r\n                // Get decimal\r\n                getDecimal.call(o, o.mask);\r\n                // Replace to the correct decimal\r\n                e = (''+e).replace('.', o.options.decimal);\r\n            }\r\n\r\n            // Current\r\n            o.value = e;\r\n\r\n            if (o.input) {\r\n                // Value\r\n                Value.call(o.input, e);\r\n                // Focus\r\n                jSuites.focus(o.input);\r\n                // Caret\r\n                o.caret = Caret.call(o.input);\r\n            }\r\n        }\r\n\r\n        // Mask detected start the process\r\n        if (! isFormula(o.value) && (o.mask || o.locale)) {\r\n            // Compatibility ixes\r\n            if (o.mask) {\r\n                // Legacy\r\n                o.mask = o.mask.replace('[-]', '');\r\n                // Excel mask TODO: Improve\r\n                if (o.mask.indexOf('##')) {\r\n                    var d = o.mask.split(';');\r\n                    if (d[0]) {\r\n                        d[0] = d[0].replace('*', '');\r\n                        d[0] = d[0].replace(/_/g, '');\r\n                        d[0] = d[0].replace(/-/g, '');\r\n                        d[0] = d[0].replace('(','');\r\n                        d[0] = d[0].replace(')','');\r\n                        d[0] = d[0].replace('##0.###','##0.000');\r\n                        d[0] = d[0].replace('##0.##','##0.00');\r\n                        d[0] = d[0].replace('##0.#','##0.0');\r\n                    }\r\n                    o.mask = d[0];\r\n                }\r\n                // Get type\r\n                if (! o.type) {\r\n                    o.type = getType.call(o, o.mask);\r\n                }\r\n                // Get tokens\r\n                o.tokens = getTokens.call(o, o.mask);\r\n            }\r\n            // On new input\r\n            if (typeof(e) !== 'object' || ! e.inputType || e.inputType == 'insertText' || e.inputType == 'insertFromPaste') {\r\n                // Start tranformation\r\n                if (o.locale) {\r\n                    if (o.input) {\r\n                        Format.call(o, o.input);\r\n                    } else {\r\n                        var newValue = FormatValue.call(o, o.value);\r\n                    }\r\n                } else {\r\n                    // Get tokens\r\n                    o.methods = getMethods.call(o, o.tokens);\r\n                    // Go through all tokes\r\n                    while (o.position < o.value.length && typeof(o.tokens[o.index]) !== 'undefined') {\r\n                        // Get the approate parser\r\n                        parse.call(o);\r\n                    }\r\n\r\n                    if (isNumeric(o.type)) {\r\n                        // Complement things in the end of the mask\r\n                        while (typeof(o.tokens[o.index]) !== 'undefined') {\r\n                            var t = getMethod.call(o, o.tokens[o.index]);\r\n                            if (t && t.type == 'general') {\r\n                                o.values[o.index] = o.tokens[o.index];\r\n                            }\r\n                            o.index++;\r\n                        }\r\n\r\n                        var adjustNumeric = true;\r\n                    } else {\r\n                        var adjustNumeric = false;\r\n                    }\r\n\r\n                    // New value\r\n                    var newValue = o.values.join('');\r\n\r\n                    // Reset value\r\n                    if (o.input) {\r\n                        t = newValue.length - o.value.length;\r\n                        if (t > 0) {\r\n                            var caret = o.caret + t;\r\n                        } else {\r\n                            var caret = o.caret;\r\n                        }\r\n                        Value.call(o.input, newValue, caret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Update raw data\r\n            if (o.input) {\r\n                var label = null;\r\n                if (isNumeric(o.type)) {\r\n                    // Extract the number\r\n                    o.number = Extract.call(o, Value.call(o.input));\r\n                    // Keep the raw data as a property of the tag\r\n                    if (o.type == 'percentage') {\r\n                        label = o.number / 100;\r\n                    } else {\r\n                        label = o.number;\r\n                    }\r\n                } else if (o.type == 'datetime') {\r\n                    label = getDate.call(o);\r\n\r\n                    if (o.date[0] && o.date[1] && o.date[2]) {\r\n                        o.input.setAttribute('data-completed', true);\r\n                    }\r\n                }\r\n\r\n                if (label) {\r\n                    o.input.setAttribute('data-value', label);\r\n                }\r\n            }\r\n\r\n            if (newValue !== undefined) {\r\n                if (returnObject) {\r\n                    return o;\r\n                } else {\r\n                    return newValue;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Extract the tokens from a mask\r\n    obj.prepare = function(str, o) {\r\n        if (! o) {\r\n            o = {};\r\n        }\r\n        return getTokens.call(o, str);\r\n    }\r\n\r\n    /**\r\n     * Apply the mask to a element (legacy)\r\n     */\r\n    obj.apply = function(e) {\r\n        var v = Value.call(e.target);\r\n        if (e.key.length == 1) {\r\n            v += e.key;\r\n        }\r\n        Value.call(e.target, obj(v, e.target.getAttribute('data-mask')));\r\n    }\r\n\r\n    /**\r\n     * Legacy support\r\n     */\r\n    obj.run = function(value, mask, decimal) {\r\n        return obj(value, { mask, decimal });\r\n    }\r\n\r\n    /**\r\n     * Extract number from masked string\r\n     */\r\n    obj.extract = function(v, options, returnObject) {\r\n        if (isBlank(v)) {\r\n            return v;\r\n        }\r\n        if (typeof(options) != 'object') {\r\n            return value;\r\n        } else {\r\n            if (! options.options) {\r\n                options.options = {};\r\n            }\r\n        }\r\n\r\n        // Compatibility\r\n        if (! options.mask && options.format) {\r\n            options.mask = options.format;\r\n        }\r\n\r\n        // Get decimal\r\n        getDecimal.call(options, options.mask);\r\n\r\n        var type = null;\r\n        if (options.type == 'percent' || options.options.style == 'percent') {\r\n            type = 'percentage';\r\n        } else if (options.mask) {\r\n            type = getType.call(options, options.mask);\r\n        }\r\n\r\n\r\n        if (type === 'datetime') {\r\n            if (v instanceof Date) {\r\n                var t = jSuites.calendar.getDateString(value, options.mask);\r\n            }\r\n\r\n            var o = obj(v, options, true);\r\n            var value = getDate.call(o);\r\n            if ((o.date[0] && o.date[1] && o.date[2]) && ! (o.date[3] || o.date[4] || o.date[5])) {\r\n                var t = jSuites.calendar.now(o.date);\r\n                value = jSuites.calendar.dateToNum(t);\r\n            }\r\n        } else {\r\n            var value = Extract.call(options, v);\r\n            // Percentage\r\n            if (type == 'percentage') {\r\n                value /= 100;\r\n            }\r\n            var o = options;\r\n        }\r\n\r\n        o.value = value;\r\n\r\n        if (returnObject) {\r\n            return o;\r\n        } else {\r\n            return value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Render\r\n     */\r\n    obj.render = function(value, options, fullMask) {\r\n        if (isBlank(value)) {\r\n            return value;\r\n        }\r\n\r\n        if (typeof(options) != 'object') {\r\n            return value;\r\n        } else {\r\n            if (! options.options) {\r\n                options.options = {};\r\n            }\r\n        }\r\n\r\n        // Compatibility\r\n        if (! options.mask && options.format) {\r\n            options.mask = options.format;\r\n        }\r\n\r\n        var type = null;\r\n        if (options.type == 'percent' || options.options.style == 'percent') {\r\n            type = 'percentage';\r\n        } else if (options.mask) {\r\n            type = getType.call(options, options.mask);\r\n        } else if (value instanceof Date) {\r\n            type = 'datetime';\r\n        }\r\n\r\n        // Fill with blanks\r\n        var fillWithBlanks = false;\r\n\r\n        if (type =='datetime' || options.type == 'calendar') {\r\n            var t = jSuites.calendar.getDateString(value, options.mask);\r\n            if (t) {\r\n                value = t;\r\n            }\r\n\r\n            if (options.mask && fullMask) {\r\n                fillWithBlanks = true;\r\n            }\r\n        } else {\r\n            // Percentage\r\n            if (type == 'percentage') {\r\n                value *= 100;\r\n            }\r\n            // Number of decimal places\r\n            if (typeof(value) === 'number') {\r\n                var t = null;\r\n                if (options.mask && fullMask) {\r\n                    var e = new RegExp('0{1}(.{1})0+', 'ig');\r\n                    var d = options.mask.match(e);\r\n                    if (d && d[0]) {\r\n                        d = d[0].length - 2;\r\n                        t = value.toFixed(d);\r\n                    } else {\r\n                        t = (''+value);\r\n                    }\r\n                } else if (options.locale && fullMask) {\r\n                    var d = (''+value).split('.');\r\n                    if (! d[1]) {\r\n                        d[1] = '00';\r\n                    } else {\r\n                        if (d[1].length == 1) {\r\n                            d[1] += '0';\r\n                        }\r\n                    }\r\n                    t = d.join('.');\r\n                } else {\r\n                    t = toPlainString(value);\r\n                }\r\n\r\n                if (t !== null) {\r\n                    value = t;\r\n                    // Get decimal\r\n                    getDecimal.call(options, options.mask);\r\n                    // Replace to the correct decimal\r\n                    if (options.options.decimal) {\r\n                        value = value.replace('.', options.options.decimal);\r\n                    }\r\n                }\r\n            } else {\r\n                if (options.mask && fullMask) {\r\n                    fillWithBlanks = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (fillWithBlanks) {\r\n            var s = options.mask.length - value.length;\r\n            if (s > 0) {\r\n                for (var i = 0; i < s; i++) {\r\n                    value += ' ';\r\n                }\r\n            }\r\n        }\r\n\r\n        value = obj(value, options);\r\n\r\n        return value;\r\n    }\r\n\r\n    obj.set = function(e, m) {\r\n        if (m) {\r\n            e.setAttribute('data-mask', m);\r\n            // Reset the value\r\n            var event = new Event('input', {\r\n                bubbles: true,\r\n                cancelable: true,\r\n            });\r\n            e.dispatchEvent(event);\r\n        }\r\n    }\r\n\r\n    if (typeof document !== 'undefined') {\r\n        document.addEventListener('input', function(e) {\r\n            if (e.target.getAttribute('data-mask') || e.target.mask) {\r\n                obj(e);\r\n            }\r\n        });\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.notification = (function(options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        icon: null,\r\n        name: 'Notification',\r\n        date: null,\r\n        error: null,\r\n        title: null,\r\n        message: null,\r\n        timeout: 4000,\r\n        autoHide: true,\r\n        closeable: true,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    var notification = document.createElement('div');\r\n    notification.className = 'jnotification';\r\n\r\n    if (obj.options.error) {\r\n        notification.classList.add('jnotification-error');\r\n    }\r\n\r\n    var notificationContainer = document.createElement('div');\r\n    notificationContainer.className = 'jnotification-container';\r\n    notification.appendChild(notificationContainer);\r\n\r\n    var notificationHeader = document.createElement('div');\r\n    notificationHeader.className = 'jnotification-header';\r\n    notificationContainer.appendChild(notificationHeader);\r\n\r\n    var notificationImage = document.createElement('div');\r\n    notificationImage.className = 'jnotification-image';\r\n    notificationHeader.appendChild(notificationImage);\r\n\r\n    if (obj.options.icon) {\r\n        var notificationIcon = document.createElement('img');\r\n        notificationIcon.src = obj.options.icon;\r\n        notificationImage.appendChild(notificationIcon);\r\n    }\r\n\r\n    var notificationName = document.createElement('div');\r\n    notificationName.className = 'jnotification-name';\r\n    notificationName.innerHTML = obj.options.name;\r\n    notificationHeader.appendChild(notificationName);\r\n\r\n    if (obj.options.closeable == true) {\r\n        var notificationClose = document.createElement('div');\r\n        notificationClose.className = 'jnotification-close';\r\n        notificationClose.onclick = function() {\r\n            obj.hide();\r\n        }\r\n        notificationHeader.appendChild(notificationClose);\r\n    }\r\n\r\n    var notificationDate = document.createElement('div');\r\n    notificationDate.className = 'jnotification-date';\r\n    notificationHeader.appendChild(notificationDate);\r\n\r\n    var notificationContent = document.createElement('div');\r\n    notificationContent.className = 'jnotification-content';\r\n    notificationContainer.appendChild(notificationContent);\r\n\r\n    if (obj.options.title) {\r\n        var notificationTitle = document.createElement('div');\r\n        notificationTitle.className = 'jnotification-title';\r\n        notificationTitle.innerHTML = obj.options.title;\r\n        notificationContent.appendChild(notificationTitle);\r\n    }\r\n\r\n    var notificationMessage = document.createElement('div');\r\n    notificationMessage.className = 'jnotification-message';\r\n    notificationMessage.innerHTML = obj.options.message;\r\n    notificationContent.appendChild(notificationMessage);\r\n\r\n    obj.show = function() {\r\n        document.body.appendChild(notification);\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.animation.fadeIn(notification);\r\n        } else {\r\n            jSuites.animation.slideTop(notification, 1);\r\n        }\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.animation.fadeOut(notification, function() {\r\n                if (notification.parentNode) {\r\n                    notification.parentNode.removeChild(notification);\r\n                    if (notificationTimeout) {\r\n                        clearTimeout(notificationTimeout);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            jSuites.animation.slideTop(notification, 0, function() {\r\n                if (notification.parentNode) {\r\n                    notification.parentNode.removeChild(notification);\r\n                    if (notificationTimeout) {\r\n                        clearTimeout(notificationTimeout);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    obj.show();\r\n\r\n    if (obj.options.autoHide == true) {\r\n        var notificationTimeout = setTimeout(function() {\r\n            obj.hide();\r\n        }, obj.options.timeout);\r\n    }\r\n\r\n    if (jSuites.getWindowWidth() < 800) {\r\n        notification.addEventListener(\"swipeup\", function(e) {\r\n            obj.hide();\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.notification.isVisible = function() {\r\n    var j = document.querySelector('.jnotification');\r\n    return j && j.parentNode ? true : false;\r\n}\r\n\r\n// More palettes https://coolors.co/ or https://gka.github.io/palettes/#/10|s|003790,005647,ffffe0|ffffe0,ff005e,93003a|1|1\r\n\r\njSuites.palette = function(o) {\r\n    // Material\r\n    var palette = {};\r\n\r\n    palette.material = [\r\n        [ \"#ffebee\", \"#fce4ec\", \"#f3e5f5\", \"#e8eaf6\", \"#e3f2fd\", \"#e0f7fa\", \"#e0f2f1\", \"#e8f5e9\", \"#f1f8e9\", \"#f9fbe7\", \"#fffde7\", \"#fff8e1\", \"#fff3e0\", \"#fbe9e7\", \"#efebe9\", \"#fafafa\", \"#eceff1\" ],\r\n        [ \"#ffcdd2\", \"#f8bbd0\", \"#e1bee7\", \"#c5cae9\", \"#bbdefb\", \"#b2ebf2\", \"#b2dfdb\", \"#c8e6c9\", \"#dcedc8\", \"#f0f4c3\", \"#fff9c4\", \"#ffecb3\", \"#ffe0b2\", \"#ffccbc\", \"#d7ccc8\", \"#f5f5f5\", \"#cfd8dc\" ],\r\n        [ \"#ef9a9a\", \"#f48fb1\", \"#ce93d8\", \"#9fa8da\", \"#90caf9\", \"#80deea\", \"#80cbc4\", \"#a5d6a7\", \"#c5e1a5\", \"#e6ee9c\", \"#fff59d\", \"#ffe082\", \"#ffcc80\", \"#ffab91\", \"#bcaaa4\", \"#eeeeee\", \"#b0bec5\" ],\r\n        [ \"#e57373\", \"#f06292\", \"#ba68c8\", \"#7986cb\", \"#64b5f6\", \"#4dd0e1\", \"#4db6ac\", \"#81c784\", \"#aed581\", \"#dce775\", \"#fff176\", \"#ffd54f\", \"#ffb74d\", \"#ff8a65\", \"#a1887f\", \"#e0e0e0\", \"#90a4ae\" ],\r\n        [ \"#ef5350\", \"#ec407a\", \"#ab47bc\", \"#5c6bc0\", \"#42a5f5\", \"#26c6da\", \"#26a69a\", \"#66bb6a\", \"#9ccc65\", \"#d4e157\", \"#ffee58\", \"#ffca28\", \"#ffa726\", \"#ff7043\", \"#8d6e63\", \"#bdbdbd\", \"#78909c\" ],\r\n        [ \"#f44336\", \"#e91e63\", \"#9c27b0\", \"#3f51b5\", \"#2196f3\", \"#00bcd4\", \"#009688\", \"#4caf50\", \"#8bc34a\", \"#cddc39\", \"#ffeb3b\", \"#ffc107\", \"#ff9800\", \"#ff5722\", \"#795548\", \"#9e9e9e\", \"#607d8b\" ],\r\n        [ \"#e53935\", \"#d81b60\", \"#8e24aa\", \"#3949ab\", \"#1e88e5\", \"#00acc1\", \"#00897b\", \"#43a047\", \"#7cb342\", \"#c0ca33\", \"#fdd835\", \"#ffb300\", \"#fb8c00\", \"#f4511e\", \"#6d4c41\", \"#757575\", \"#546e7a\" ],\r\n        [ \"#d32f2f\", \"#c2185b\", \"#7b1fa2\", \"#303f9f\", \"#1976d2\", \"#0097a7\", \"#00796b\", \"#388e3c\", \"#689f38\", \"#afb42b\", \"#fbc02d\", \"#ffa000\", \"#f57c00\", \"#e64a19\", \"#5d4037\", \"#616161\", \"#455a64\" ],\r\n        [ \"#c62828\", \"#ad1457\", \"#6a1b9a\", \"#283593\", \"#1565c0\", \"#00838f\", \"#00695c\", \"#2e7d32\", \"#558b2f\", \"#9e9d24\", \"#f9a825\", \"#ff8f00\", \"#ef6c00\", \"#d84315\", \"#4e342e\", \"#424242\", \"#37474f\" ],\r\n        [ \"#b71c1c\", \"#880e4f\", \"#4a148c\", \"#1a237e\", \"#0d47a1\", \"#006064\", \"#004d40\", \"#1b5e20\", \"#33691e\", \"#827717\", \"#f57f17\", \"#ff6f00\", \"#e65100\", \"#bf360c\", \"#3e2723\", \"#212121\", \"#263238\" ],\r\n    ];\r\n\r\n    palette.fire = [\r\n        [\"0b1a6d\",\"840f38\",\"b60718\",\"de030b\",\"ff0c0c\",\"fd491c\",\"fc7521\",\"faa331\",\"fbb535\",\"ffc73a\"],\r\n        [\"071147\",\"5f0b28\",\"930513\",\"be0309\",\"ef0000\",\"fa3403\",\"fb670b\",\"f9991b\",\"faad1e\",\"ffc123\"],\r\n        [\"03071e\",\"370617\",\"6a040f\",\"9d0208\",\"d00000\",\"dc2f02\",\"e85d04\",\"f48c06\",\"faa307\",\"ffba08\"],\r\n        [\"020619\",\"320615\",\"61040d\",\"8c0207\",\"bc0000\",\"c82a02\",\"d05203\",\"db7f06\",\"e19405\",\"efab00\"],\r\n        [\"020515\",\"2d0513\",\"58040c\",\"7f0206\",\"aa0000\",\"b62602\",\"b94903\",\"c57205\",\"ca8504\",\"d89b00\"],\r\n    ]\r\n\r\n    palette.baby = [\r\n        [\"eddcd2\",\"fff1e6\",\"fde2e4\",\"fad2e1\",\"c5dedd\",\"dbe7e4\",\"f0efeb\",\"d6e2e9\",\"bcd4e6\",\"99c1de\"],\r\n        [\"e1c4b3\",\"ffd5b5\",\"fab6ba\",\"f5a8c4\",\"aacecd\",\"bfd5cf\",\"dbd9d0\",\"baceda\",\"9dc0db\",\"7eb1d5\"],\r\n        [\"daa990\",\"ffb787\",\"f88e95\",\"f282a9\",\"8fc4c3\",\"a3c8be\",\"cec9b3\",\"9dbcce\",\"82acd2\",\"649dcb\"],\r\n        [\"d69070\",\"ff9c5e\",\"f66770\",\"f05f8f\",\"74bbb9\",\"87bfae\",\"c5b993\",\"83aac3\",\"699bca\",\"4d89c2\"],\r\n        [\"c97d5d\",\"f58443\",\"eb4d57\",\"e54a7b\",\"66a9a7\",\"78ae9c\",\"b5a67e\",\"7599b1\",\"5c88b7\",\"4978aa\"],\r\n    ]\r\n\r\n    if (palette[o]) {\r\n        return palette[o];\r\n    } else {\r\n        return palette.material;\r\n    }\r\n}\r\n\r\njSuites.picker = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.picker) {\r\n        return el.picker.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'picker' };\r\n    obj.options = {};\r\n\r\n    var dropdownHeader = null;\r\n    var dropdownContent = null;\r\n\r\n    /**\r\n     * Create the content options\r\n     */\r\n    var createContent = function() {\r\n        dropdownContent.innerHTML = '';\r\n\r\n        // Create items\r\n        var keys = Object.keys(obj.options.data);\r\n\r\n        // Go though all options\r\n        for (var i = 0; i < keys.length; i++) {\r\n            // Item\r\n            var dropdownItem = document.createElement('div');\r\n            dropdownItem.classList.add('jpicker-item');\r\n            dropdownItem.k = keys[i];\r\n            dropdownItem.v = obj.options.data[keys[i]];\r\n            // Label\r\n            dropdownItem.innerHTML = obj.getLabel(keys[i]);\r\n            // Append\r\n            dropdownContent.appendChild(dropdownItem);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set or reset the options for the picker\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            value: 0,\r\n            data: null,\r\n            render: null,\r\n            onchange: null,\r\n            onselect: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onload: null,\r\n            width: null,\r\n            header: true,\r\n            right: false,\r\n            content: false,\r\n            columns: null,\r\n            height: null,\r\n        }\r\n\r\n        // Legacy purpose only\r\n        if (options && options.options) {\r\n            options.data = options.options;\r\n        }\r\n\r\n        // Loop through the initial configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Start using the options\r\n        if (obj.options.header === false) {\r\n            dropdownHeader.style.display = 'none';\r\n        } else {\r\n            dropdownHeader.style.display = '';\r\n        }\r\n\r\n        // Width\r\n        if (obj.options.width) {\r\n            dropdownHeader.style.width = parseInt(obj.options.width) + 'px';\r\n        } else {\r\n            dropdownHeader.style.width = '';\r\n        }\r\n\r\n        // Height\r\n        if (obj.options.height) {\r\n            dropdownContent.style.maxHeight = obj.options.height + 'px';\r\n            dropdownContent.style.overflow = 'scroll';\r\n        } else {\r\n            dropdownContent.style.overflow = '';\r\n        }\r\n\r\n        if (obj.options.columns > 0) {\r\n            dropdownContent.classList.add('jpicker-columns');\r\n            dropdownContent.style.width =  obj.options.width ? obj.options.width : 36 * obj.options.columns + 'px';\r\n        }\r\n\r\n        if (isNaN(obj.options.value)) {\r\n            obj.options.value = '0';\r\n        }\r\n\r\n        // Create list from data\r\n        createContent();\r\n\r\n        // Set value\r\n        obj.setValue(obj.options.value);\r\n\r\n        // Set options all returns the own instance\r\n        return obj;\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    obj.setValue = function(v) {\r\n        // Set label\r\n        obj.setLabel(v);\r\n\r\n        // Update value\r\n        obj.options.value = String(v);\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n\r\n        if (dropdownContent.children[v].getAttribute('type') !== 'generic') {\r\n            obj.close();\r\n        }\r\n    }\r\n\r\n    obj.getLabel = function(v) {\r\n        var label = obj.options.data[v] || null;\r\n        if (typeof(obj.options.render) == 'function') {\r\n            label = obj.options.render(label);\r\n        }\r\n        return label;\r\n    }\r\n\r\n    obj.setLabel = function(v) {\r\n        if (obj.options.content) {\r\n            var label = '<i class=\"material-icons\">' + obj.options.content + '</i>';\r\n        } else {\r\n            var label = obj.getLabel(v);\r\n        }\r\n\r\n        dropdownHeader.innerHTML = label;\r\n    }\r\n\r\n    obj.open = function() {\r\n        if (! el.classList.contains('jpicker-focus')) {\r\n            // Start tracking the element\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Open picker\r\n            el.classList.add('jpicker-focus');\r\n            el.focus();\r\n\r\n            var rectHeader = dropdownHeader.getBoundingClientRect();\r\n            var rectContent = dropdownContent.getBoundingClientRect();\r\n            if (window.innerHeight < rectHeader.bottom + rectContent.height) {\r\n                dropdownContent.style.marginTop = -1 * (rectContent.height + 4) + 'px';\r\n            } else {\r\n                dropdownContent.style.marginTop = rectHeader.height + 2 + 'px';\r\n            }\r\n\r\n            if (obj.options.right === true) {\r\n                dropdownContent.style.marginLeft = -1 * rectContent.width + 24 + 'px';\r\n            }\r\n\r\n            if (typeof obj.options.onopen == 'function') {\r\n                obj.options.onopen(el, obj);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (el.classList.contains('jpicker-focus')) {\r\n            el.classList.remove('jpicker-focus');\r\n\r\n            // Start tracking the element\r\n            jSuites.tracking(obj, false);\r\n\r\n            if (typeof obj.options.onclose == 'function') {\r\n                obj.options.onclose(el, obj);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create floating picker\r\n     */\r\n    var init = function() {\r\n        // Class\r\n        el.classList.add('jpicker');\r\n        el.setAttribute('tabindex', '900');\r\n        el.onmousedown = function(e) {\r\n            if (! el.classList.contains('jpicker-focus')) {\r\n                obj.open();\r\n            }\r\n        }\r\n\r\n        // Dropdown Header\r\n        dropdownHeader = document.createElement('div');\r\n        dropdownHeader.classList.add('jpicker-header');\r\n\r\n        // Dropdown content\r\n        dropdownContent = document.createElement('div');\r\n        dropdownContent.classList.add('jpicker-content');\r\n        dropdownContent.onclick = function(e) {\r\n            var item = jSuites.findElement(e.target, 'jpicker-item');\r\n            if (item) {\r\n                if (item.parentNode === dropdownContent) {\r\n                    // Update label\r\n                    obj.setValue(item.k);\r\n                    // Call method\r\n                    if (typeof(obj.options.onchange) == 'function') {\r\n                        obj.options.onchange.call(obj, el, obj, item.v, item.v, item.k);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Append content and header\r\n        el.appendChild(dropdownHeader);\r\n        el.appendChild(dropdownContent);\r\n\r\n        // Default value\r\n        el.value = options.value || 0;\r\n\r\n        // Set options\r\n        obj.setOptions(options);\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Reference\r\n        el.picker = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.rating = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.rating) {\r\n        return el.rating.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            number: 5,\r\n            value: 0,\r\n            tooltip: [ 'Very bad', 'Bad', 'Average', 'Good', 'Very good' ],\r\n            onchange: null,\r\n        };\r\n\r\n        // Loop through the initial configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Make sure the container is empty\r\n        el.innerHTML = '';\r\n\r\n        // Add elements\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            var div = document.createElement('div');\r\n            div.setAttribute('data-index', (i + 1))\r\n            div.setAttribute('title', obj.options.tooltip[i])\r\n            el.appendChild(div);\r\n        }\r\n\r\n        // Selected option\r\n        if (obj.options.value) {\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                if (i < obj.options.value) {\r\n                    el.children[i].classList.add('jrating-selected');\r\n                }\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    // Set value\r\n    obj.setValue = function(index) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < index) {\r\n                el.children[i].classList.add('jrating-selected');\r\n            } else {\r\n                el.children[i].classList.remove('jrating-over');\r\n                el.children[i].classList.remove('jrating-selected');\r\n            }\r\n        }\r\n\r\n        obj.options.value = index;\r\n\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, index);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var init = function() {\r\n        // Start plugin\r\n        obj.setOptions(options);\r\n\r\n        // Class\r\n        el.classList.add('jrating');\r\n\r\n        // Events\r\n        el.addEventListener(\"click\", function(e) {\r\n            var index = e.target.getAttribute('data-index');\r\n            if (index != undefined) {\r\n                if (index == obj.options.value) {\r\n                    obj.setValue(0);\r\n                } else {\r\n                    obj.setValue(index);\r\n                }\r\n            }\r\n        });\r\n\r\n        el.addEventListener(\"mouseover\", function(e) {\r\n            var index = e.target.getAttribute('data-index');\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                if (i < index) {\r\n                    el.children[i].classList.add('jrating-over');\r\n                } else {\r\n                    el.children[i].classList.remove('jrating-over');\r\n                }\r\n            }\r\n        });\r\n\r\n        el.addEventListener(\"mouseout\", function(e) {\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                el.children[i].classList.remove('jrating-over');\r\n            }\r\n        });\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Reference\r\n        el.rating = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\n\r\njSuites.sorting = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    var defaults = {\r\n        pointer: null,\r\n        direction: null,\r\n        ondragstart: null,\r\n        ondragend: null,\r\n        ondrop: null,\r\n    }\r\n\r\n    var dragElement = null;\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    el.classList.add('jsorting');\r\n\r\n    el.addEventListener('dragstart', function(e) {\r\n        var position = Array.prototype.indexOf.call(e.target.parentNode.children, e.target);\r\n        dragElement = {\r\n            element: e.target,\r\n            o: position,\r\n            d: position\r\n        }\r\n        e.target.style.opacity = '0.25';\r\n\r\n        if (typeof(obj.options.ondragstart) == 'function') {\r\n            obj.options.ondragstart(el, e.target, e);\r\n        }\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (getElement(e.target) && dragElement) {\r\n            if (e.target.getAttribute('draggable') == 'true' && dragElement.element != e.target) {\r\n                if (! obj.options.direction) {\r\n                    var condition = e.target.clientHeight / 2 > e.offsetY;\r\n                } else {\r\n                    var condition = e.target.clientWidth / 2 > e.offsetX;\r\n                }\r\n\r\n                if (condition) {\r\n                    e.target.parentNode.insertBefore(dragElement.element, e.target);\r\n                } else {\r\n                    e.target.parentNode.insertBefore(dragElement.element, e.target.nextSibling);\r\n                }\r\n\r\n                dragElement.d = Array.prototype.indexOf.call(e.target.parentNode.children, dragElement.element);\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('dragend', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (dragElement) {\r\n            if (typeof(obj.options.ondragend) == 'function') {\r\n                obj.options.ondragend(el, dragElement.element, e);\r\n            }\r\n\r\n            // Cancelled put element to the original position\r\n            if (dragElement.o < dragElement.d) {\r\n                e.target.parentNode.insertBefore(dragElement.element, e.target.parentNode.children[dragElement.o]);\r\n            } else {\r\n                e.target.parentNode.insertBefore(dragElement.element, e.target.parentNode.children[dragElement.o].nextSibling);\r\n            }\r\n\r\n            dragElement.element.style.opacity = '';\r\n            dragElement = null;\r\n        }\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (dragElement && (dragElement.o != dragElement.d)) {\r\n            if (typeof(obj.options.ondrop) == 'function') {\r\n                obj.options.ondrop(el, dragElement.o, dragElement.d, dragElement.element, e.target, e);\r\n            }\r\n        }\r\n\r\n        dragElement.element.style.opacity = '';\r\n        dragElement = null;\r\n    });\r\n\r\n    var getElement = function(element) {\r\n        var sorting = false;\r\n\r\n        function path (element) {\r\n            if (element.className) {\r\n                if (element.classList.contains('jsorting')) {\r\n                    sorting = true;\r\n                }\r\n            }\r\n\r\n            if (! sorting) {\r\n                path(element.parentNode);\r\n            }\r\n        }\r\n\r\n        path(element);\r\n\r\n        return sorting;\r\n    }\r\n\r\n    for (var i = 0; i < el.children.length; i++) {\r\n        if (! el.children[i].hasAttribute('draggable')) {\r\n            el.children[i].setAttribute('draggable', 'true');\r\n        }\r\n    }\r\n\r\n    el.val = function() {\r\n        var id = null;\r\n        var data = [];\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            if (id = el.children[i].getAttribute('data-id')) {\r\n                data.push(id);\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n    return el;\r\n});\r\n\r\njSuites.tabs = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        data: [],\r\n        position: null,\r\n        allowCreate: false,\r\n        allowChangePosition: false,\r\n        onclick: null,\r\n        onload: null,\r\n        onchange: null,\r\n        oncreate: null,\r\n        ondelete: null,\r\n        onbeforecreate: null,\r\n        onchangeposition: null,\r\n        animation: false,\r\n        hideHeaders: false,\r\n        padding: null,\r\n        palette: null,\r\n        maxWidth: null,\r\n    }\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jtabs');\r\n\r\n    var prev = null;\r\n    var next = null;\r\n    var border = null;\r\n\r\n    // Helpers\r\n    var setBorder = function(index) {\r\n        if (obj.options.animation) {\r\n            var rect = obj.headers.children[index].getBoundingClientRect();\r\n\r\n            if (obj.options.palette == 'modern') {\r\n                border.style.width = rect.width - 4 + 'px';\r\n                border.style.left = obj.headers.children[index].offsetLeft + 2 + 'px';\r\n            } else {\r\n                border.style.width = rect.width + 'px';\r\n                border.style.left = obj.headers.children[index].offsetLeft + 'px';\r\n            }\r\n\r\n            if (obj.options.position == 'bottom') {\r\n                border.style.top = '0px';\r\n            } else {\r\n                border.style.bottom = '0px';\r\n            }\r\n        }\r\n    }\r\n\r\n    var updateControls = function(x) {\r\n        if (typeof(obj.headers.scrollTo) == 'function') {\r\n            obj.headers.scrollTo({\r\n                left: x,\r\n                behavior: 'smooth',\r\n            });\r\n        } else {\r\n            obj.headers.scrollLeft = x;\r\n        }\r\n\r\n        if (x <= 1) {\r\n            prev.classList.add('disabled');\r\n        } else {\r\n            prev.classList.remove('disabled');\r\n        }\r\n\r\n        if (x >= obj.headers.scrollWidth - obj.headers.offsetWidth) {\r\n            next.classList.add('disabled');\r\n        } else {\r\n            next.classList.remove('disabled');\r\n        }\r\n\r\n        if (obj.headers.scrollWidth <= obj.headers.offsetWidth) {\r\n            prev.style.display = 'none';\r\n            next.style.display = 'none';\r\n        } else {\r\n            prev.style.display = '';\r\n            next.style.display = '';\r\n        }\r\n    }\r\n\r\n    obj.setBorder = setBorder;\r\n\r\n    // Set value\r\n    obj.open = function(index) {\r\n        var previous = null;\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            if (obj.headers.children[i].classList.contains('jtabs-selected')) {\r\n                // Current one\r\n                previous = i;\r\n            }\r\n            // Remote selected\r\n            obj.headers.children[i].classList.remove('jtabs-selected');\r\n            if (obj.content.children[i]) {\r\n                obj.content.children[i].classList.remove('jtabs-selected');\r\n            }\r\n        }\r\n\r\n        obj.headers.children[index].classList.add('jtabs-selected');\r\n        if (obj.content.children[index]) {\r\n            obj.content.children[index].classList.add('jtabs-selected');\r\n        }\r\n\r\n        if (previous != index && typeof(obj.options.onchange) == 'function') {\r\n            if (obj.content.children[index]) {\r\n                obj.options.onchange(el, obj, index, obj.headers.children[index], obj.content.children[index]);\r\n            }\r\n        }\r\n\r\n        // Hide\r\n        if (obj.options.hideHeaders == true && (obj.headers.children.length < 3 && obj.options.allowCreate == false)) {\r\n            obj.headers.parentNode.style.display = 'none';\r\n        } else {\r\n            // Set border\r\n            setBorder(index);\r\n\r\n            obj.headers.parentNode.style.display = '';\r\n\r\n            var x1 = obj.headers.children[index].offsetLeft;\r\n            var x2 = x1 + obj.headers.children[index].offsetWidth;\r\n            var r1 = obj.headers.scrollLeft;\r\n            var r2 = r1 + obj.headers.offsetWidth;\r\n\r\n            if (! (r1 <= x1 && r2 >= x2)) {\r\n                // Out of the viewport\r\n                updateControls(x1 - 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.selectIndex = function(a) {\r\n        var index = Array.prototype.indexOf.call(obj.headers.children, a);\r\n        if (index >= 0) {\r\n            obj.open(index);\r\n        }\r\n\r\n        return index;\r\n    }\r\n\r\n    obj.rename = function(i, title) {\r\n        if (! title) {\r\n            title = prompt('New title', obj.headers.children[i].innerText);\r\n        }\r\n        obj.headers.children[i].innerText = title;\r\n        obj.open(i);\r\n    }\r\n\r\n    obj.create = function(title, url) {\r\n        if (typeof(obj.options.onbeforecreate) == 'function') {\r\n            var ret = obj.options.onbeforecreate(el);\r\n            if (ret === false) {\r\n                return false;\r\n            } else {\r\n                title = ret;\r\n            }\r\n        }\r\n\r\n        var div = obj.appendElement(title);\r\n\r\n        if (typeof(obj.options.oncreate) == 'function') {\r\n            obj.options.oncreate(el, div)\r\n        }\r\n\r\n        return div;\r\n    }\r\n\r\n    obj.remove = function(index) {\r\n        return obj.deleteElement(index);\r\n    }\r\n\r\n    obj.nextNumber = function() {\r\n        var num = 0;\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            var tmp = obj.headers.children[i].innerText.match(/[0-9].*/);\r\n            if (tmp > num) {\r\n                num = parseInt(tmp);\r\n            }\r\n        }\r\n        if (! num) {\r\n            num = 1;\r\n        } else {\r\n            num++;\r\n        }\r\n\r\n        return num;\r\n    }\r\n\r\n    obj.deleteElement = function(index) {\r\n        if (! obj.headers.children[index]) {\r\n            return false;\r\n        } else {\r\n            obj.headers.removeChild(obj.headers.children[index]);\r\n            obj.content.removeChild(obj.content.children[index]);\r\n        }\r\n\r\n        obj.open(0);\r\n\r\n        if (typeof(obj.options.ondelete) == 'function') {\r\n            obj.options.ondelete(el, index)\r\n        }\r\n    }\r\n\r\n    obj.appendElement = function(title, cb) {\r\n        if (! title) {\r\n            var title = prompt('Title?', '');\r\n        }\r\n\r\n        if (title) {\r\n            // Add content\r\n            var div = document.createElement('div');\r\n            obj.content.appendChild(div);\r\n\r\n            // Add headers\r\n            var h = document.createElement('div');\r\n            h.innerHTML = title;\r\n            h.content = div;\r\n            obj.headers.insertBefore(h, obj.headers.lastChild);\r\n\r\n            // Sortable\r\n            if (obj.options.allowChangePosition) {\r\n                h.setAttribute('draggable', 'true');\r\n            }\r\n            // Open new tab\r\n            obj.selectIndex(h);\r\n\r\n            // Callback\r\n            if (typeof(cb) == 'function') {\r\n                cb(div, h);\r\n            }\r\n\r\n            // Return element\r\n            return div;\r\n        }\r\n    }\r\n\r\n    obj.getActive = function() {\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            if (obj.headers.children[i].classList.contains('jtabs-selected')) {\r\n                return i\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    obj.updateContent = function(position, newContent) {\r\n        if (typeof newContent !== 'string') {\r\n            var contentItem = newContent;\r\n        } else {\r\n            var contentItem = document.createElement('div');\r\n            contentItem.innerHTML = newContent;\r\n        }\r\n\r\n        if (obj.content.children[position].classList.contains('jtabs-selected')) {\r\n            newContent.classList.add('jtabs-selected');\r\n        }\r\n\r\n        obj.content.replaceChild(newContent, obj.content.children[position]);\r\n    }\r\n\r\n    obj.updatePosition = function(f, t) {\r\n        // Ondrop update position of content\r\n        if (f > t) {\r\n            obj.content.insertBefore(obj.content.children[f], obj.content.children[t]);\r\n        } else {\r\n            obj.content.insertBefore(obj.content.children[f], obj.content.children[t].nextSibling);\r\n        }\r\n\r\n        // Open destination tab\r\n        obj.open(t);\r\n\r\n        // Call event\r\n        if (typeof(obj.options.onchangeposition) == 'function') {\r\n            obj.options.onchangeposition(obj.headers, f, t);\r\n        }\r\n    }\r\n\r\n    obj.move = function(f, t) {\r\n        if (f > t) {\r\n            obj.headers.insertBefore(obj.headers.children[f], obj.headers.children[t]);\r\n        } else {\r\n            obj.headers.insertBefore(obj.headers.children[f], obj.headers.children[t].nextSibling);\r\n        }\r\n\r\n        obj.updatePosition(f, t);\r\n    }\r\n\r\n    obj.setBorder = setBorder;\r\n\r\n    obj.init = function() {\r\n        el.innerHTML = '';\r\n\r\n        // Make sure the component is blank\r\n        obj.headers = document.createElement('div');\r\n        obj.content = document.createElement('div');\r\n        obj.headers.classList.add('jtabs-headers');\r\n        obj.content.classList.add('jtabs-content');\r\n\r\n        if (obj.options.palette) {\r\n            el.classList.add('jtabs-modern');\r\n        } else {\r\n            el.classList.remove('jtabs-modern');\r\n        }\r\n\r\n        // Padding\r\n        if (obj.options.padding) {\r\n            obj.content.style.padding = parseInt(obj.options.padding) + 'px';\r\n        }\r\n\r\n        // Header\r\n        var header = document.createElement('div');\r\n        header.className = 'jtabs-headers-container';\r\n        header.appendChild(obj.headers);\r\n        if (obj.options.maxWidth) {\r\n            header.style.maxWidth = parseInt(obj.options.maxWidth) + 'px';\r\n        }\r\n\r\n        // Controls\r\n        var controls = document.createElement('div');\r\n        controls.className = 'jtabs-controls';\r\n        controls.setAttribute('draggable', 'false');\r\n        header.appendChild(controls);\r\n\r\n        // Append DOM elements\r\n        if (obj.options.position == 'bottom') {\r\n            el.appendChild(obj.content);\r\n            el.appendChild(header);\r\n        } else {\r\n            el.appendChild(header);\r\n            el.appendChild(obj.content);\r\n        }\r\n\r\n        // New button\r\n        if (obj.options.allowCreate == true) {\r\n            var add = document.createElement('div');\r\n            add.className = 'jtabs-add';\r\n            add.onclick = function() {\r\n                obj.create();\r\n            }\r\n            controls.appendChild(add);\r\n        }\r\n\r\n        prev = document.createElement('div');\r\n        prev.className = 'jtabs-prev';\r\n        prev.onclick = function() {\r\n            updateControls(obj.headers.scrollLeft - obj.headers.offsetWidth);\r\n        }\r\n        controls.appendChild(prev);\r\n\r\n        next = document.createElement('div');\r\n        next.className = 'jtabs-next';\r\n        next.onclick = function() {\r\n            updateControls(obj.headers.scrollLeft + obj.headers.offsetWidth);\r\n        }\r\n        controls.appendChild(next);\r\n\r\n        // Data\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            // Title\r\n            if (obj.options.data[i].titleElement) {\r\n                var headerItem = obj.options.data[i].titleElement;\r\n            } else {\r\n                var headerItem = document.createElement('div');\r\n            }\r\n            // Icon\r\n            if (obj.options.data[i].icon) {\r\n                var iconContainer = document.createElement('div');\r\n                var icon = document.createElement('i');\r\n                icon.classList.add('material-icons');\r\n                icon.innerHTML = obj.options.data[i].icon;\r\n                iconContainer.appendChild(icon);\r\n                headerItem.appendChild(iconContainer);\r\n            }\r\n            // Title\r\n            if (obj.options.data[i].title) {\r\n                var title = document.createTextNode(obj.options.data[i].title);\r\n                headerItem.appendChild(title);\r\n            }\r\n            // Width\r\n            if (obj.options.data[i].width) {\r\n                headerItem.style.width = obj.options.data[i].width;\r\n            }\r\n            // Content\r\n            if (obj.options.data[i].contentElement) {\r\n                var contentItem = obj.options.data[i].contentElement;\r\n            } else {\r\n                var contentItem = document.createElement('div');\r\n                contentItem.innerHTML = obj.options.data[i].content;\r\n            }\r\n            obj.headers.appendChild(headerItem);\r\n            obj.content.appendChild(contentItem);\r\n        }\r\n\r\n        // Animation\r\n        border = document.createElement('div');\r\n        border.className = 'jtabs-border';\r\n        obj.headers.appendChild(border);\r\n\r\n        if (obj.options.animation) {\r\n            el.classList.add('jtabs-animation');\r\n        }\r\n\r\n        // Events\r\n        obj.headers.addEventListener(\"click\", function(e) {\r\n            if (e.target.parentNode.classList.contains('jtabs-headers')) {\r\n                var target = e.target;\r\n            } else {\r\n                if (e.target.tagName == 'I') {\r\n                    var target = e.target.parentNode.parentNode;\r\n                } else {\r\n                    var target = e.target.parentNode;\r\n                }\r\n            }\r\n\r\n            var index = obj.selectIndex(target);\r\n\r\n            if (typeof(obj.options.onclick) == 'function') {\r\n                obj.options.onclick(el, obj, index, obj.headers.children[index], obj.content.children[index]);\r\n            }\r\n        });\r\n\r\n        obj.headers.addEventListener(\"contextmenu\", function(e) {\r\n            obj.selectIndex(e.target);\r\n        });\r\n\r\n        if (obj.headers.children.length) {\r\n            // Open first tab\r\n            obj.open(0);\r\n        }\r\n\r\n        // Update controls\r\n        updateControls(0);\r\n\r\n        if (obj.options.allowChangePosition == true) {\r\n            jSuites.sorting(obj.headers, {\r\n                direction: 1,\r\n                ondrop: function(a,b,c) {\r\n                    obj.updatePosition(b,c);\r\n                },\r\n            });\r\n        }\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n    }\r\n\r\n    // Loading existing nodes as the data\r\n    if (el.children[0] && el.children[0].children.length) {\r\n        // Create from existing elements\r\n        for (var i = 0; i < el.children[0].children.length; i++) {\r\n            var item = obj.options.data && obj.options.data[i] ? obj.options.data[i] : {};\r\n\r\n            if (el.children[1] && el.children[1].children[i]) {\r\n                item.titleElement = el.children[0].children[i];\r\n                item.contentElement = el.children[1].children[i];\r\n            } else {\r\n                item.contentElement = el.children[0].children[i];\r\n            }\r\n\r\n            obj.options.data[i] = item;\r\n        }\r\n    }\r\n\r\n    // Remote controller flag\r\n    var loadingRemoteData = false;\r\n\r\n    // Create from data\r\n    if (obj.options.data) {\r\n        // Append children\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            if (obj.options.data[i].url) {\r\n                jSuites.ajax({\r\n                    url: obj.options.data[i].url,\r\n                    type: 'GET',\r\n                    dataType: 'text/html',\r\n                    index: i,\r\n                    success: function(result) {\r\n                        obj.options.data[this.index].content = result;\r\n                    },\r\n                    complete: function() {\r\n                        obj.init();\r\n                    }\r\n                });\r\n\r\n                // Flag loading\r\n                loadingRemoteData = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (! loadingRemoteData) {\r\n        obj.init();\r\n    }\r\n\r\n    el.tabs = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.toolbar = (function(el, options) {\r\n    // New instance\r\n    var obj = { type:'toolbar' };\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        app: null,\r\n        container: false,\r\n        badge: false,\r\n        title: false,\r\n        responsive: false,\r\n        maxWidth: null,\r\n        items: [],\r\n    }\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    if (! el && options.app && options.app.el) {\r\n        el = document.createElement('div');\r\n        options.app.el.appendChild(el);\r\n    }\r\n\r\n    // Arrow\r\n    var toolbarArrow = document.createElement('div');\r\n    toolbarArrow.classList.add('jtoolbar-item');\r\n    toolbarArrow.classList.add('jtoolbar-arrow');\r\n\r\n    var toolbarFloating = document.createElement('div');\r\n    toolbarFloating.classList.add('jtoolbar-floating');\r\n    toolbarArrow.appendChild(toolbarFloating);\r\n\r\n    obj.selectItem = function(element) {\r\n        var elements = toolbarContent.children;\r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (element != elements[i]) {\r\n                elements[i].classList.remove('jtoolbar-selected');\r\n            }\r\n        }\r\n        element.classList.add('jtoolbar-selected');\r\n    }\r\n\r\n    obj.hide = function() {\r\n        jSuites.animation.slideBottom(el, 0, function() {\r\n            el.style.display = 'none';\r\n        });\r\n    }\r\n\r\n    obj.show = function() {\r\n        el.style.display = '';\r\n        jSuites.animation.slideBottom(el, 1);\r\n    }\r\n\r\n    obj.get = function() {\r\n        return el;\r\n    }\r\n\r\n    obj.setBadge = function(index, value) {\r\n        toolbarContent.children[index].children[1].firstChild.innerHTML = value;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        toolbar.remove();\r\n        el.innerHTML = '';\r\n    }\r\n\r\n    obj.update = function(a, b) {\r\n        for (var i = 0; i < toolbarContent.children.length; i++) {\r\n            // Toolbar element\r\n            var toolbarItem = toolbarContent.children[i];\r\n            // State management\r\n            if (typeof(toolbarItem.updateState) == 'function') {\r\n                toolbarItem.updateState(el, obj, toolbarItem, a, b);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.create = function(items) {\r\n        // Reset anything in the toolbar\r\n        toolbarContent.innerHTML = '';\r\n        // Create elements in the toolbar\r\n        for (var i = 0; i < items.length; i++) {\r\n            var toolbarItem = document.createElement('div');\r\n            toolbarItem.classList.add('jtoolbar-item');\r\n\r\n            if (items[i].width) {\r\n                toolbarItem.style.width = parseInt(items[i].width) + 'px'; \r\n            }\r\n\r\n            if (items[i].k) {\r\n                toolbarItem.k = items[i].k;\r\n            }\r\n\r\n            if (items[i].tooltip) {\r\n                toolbarItem.setAttribute('title', items[i].tooltip);\r\n            }\r\n\r\n            // Id\r\n            if (items[i].id) {\r\n                toolbarItem.setAttribute('id', items[i].id);\r\n            }\r\n\r\n            // Selected\r\n            if (items[i].updateState) {\r\n                toolbarItem.updateState = items[i].updateState;\r\n            }\r\n\r\n            if (items[i].active) {\r\n                toolbarItem.classList.add('jtoolbar-active');\r\n            }\r\n\r\n            if (items[i].type == 'select' || items[i].type == 'dropdown') {\r\n                jSuites.picker(toolbarItem, items[i]);\r\n            } else if (items[i].type == 'divisor') {\r\n                toolbarItem.classList.add('jtoolbar-divisor');\r\n            } else if (items[i].type == 'label') {\r\n                toolbarItem.classList.add('jtoolbar-label');\r\n                toolbarItem.innerHTML = items[i].content;\r\n            } else {\r\n                // Material icons\r\n                var toolbarIcon = document.createElement('i');\r\n                if (typeof(items[i].class) === 'undefined') {\r\n                    toolbarIcon.classList.add('material-icons');\r\n                } else {\r\n                    var c = items[i].class.split(' ');\r\n                    for (var j = 0; j < c.length; j++) {\r\n                        toolbarIcon.classList.add(c[j]);\r\n                    }\r\n                }\r\n                toolbarIcon.innerHTML = items[i].content ? items[i].content : '';\r\n                toolbarItem.appendChild(toolbarIcon);\r\n\r\n                // Badge options\r\n                if (obj.options.badge == true) {\r\n                    var toolbarBadge = document.createElement('div');\r\n                    toolbarBadge.classList.add('jbadge');\r\n                    var toolbarBadgeContent = document.createElement('div');\r\n                    toolbarBadgeContent.innerHTML = items[i].badge ? items[i].badge : '';\r\n                    toolbarBadge.appendChild(toolbarBadgeContent);\r\n                    toolbarItem.appendChild(toolbarBadge);\r\n                }\r\n\r\n                // Title\r\n                if (items[i].title) {\r\n                    if (obj.options.title == true) {\r\n                        var toolbarTitle = document.createElement('span');\r\n                        toolbarTitle.innerHTML = items[i].title;\r\n                        toolbarItem.appendChild(toolbarTitle);\r\n                    } else {\r\n                        toolbarItem.setAttribute('title', items[i].title);\r\n                    }\r\n                }\r\n\r\n                if (obj.options.app && items[i].route) {\r\n                    // Route\r\n                    toolbarItem.route = items[i].route;\r\n                    // Onclick for route\r\n                    toolbarItem.onclick = function() {\r\n                        obj.options.app.pages(this.route);\r\n                    }\r\n                    // Create pages\r\n                    obj.options.app.pages(items[i].route, {\r\n                        toolbarItem: toolbarItem,\r\n                        closed: true\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (items[i].onclick) {\r\n                toolbarItem.onclick = items[i].onclick.bind(items[i], el, obj, toolbarItem);\r\n            }\r\n\r\n            toolbarContent.appendChild(toolbarItem);\r\n        }\r\n\r\n        // Fits to the page\r\n        obj.refresh();\r\n    }\r\n\r\n    obj.open = function() {\r\n        toolbarArrow.classList.add('jtoolbar-arrow-selected');\r\n\r\n        var rect = toolbarFloating.getBoundingClientRect();\r\n        if (rect.bottom > window.innerHeight) {\r\n            toolbarFloating.style.bottom = '0';\r\n        } else {\r\n            toolbarFloating.style.removeProperty('bottom');\r\n        }\r\n\r\n        toolbarFloating.style.right = '0';\r\n\r\n        toolbarArrow.children[0].focus();\r\n        // Start tracking\r\n        jSuites.tracking(obj, true);\r\n    }\r\n\r\n    obj.close = function() {\r\n        toolbarArrow.classList.remove('jtoolbar-arrow-selected')\r\n        // End tracking\r\n        jSuites.tracking(obj, false);\r\n    }\r\n\r\n    obj.refresh = function() {\r\n        if (obj.options.responsive == true) {\r\n            // Width of the c\r\n            var rect = el.parentNode.getBoundingClientRect();\r\n            if (! obj.options.maxWidth) {\r\n                obj.options.maxWidth = rect.width;\r\n            }\r\n            // Max width\r\n            var width = parseInt(obj.options.maxWidth); \r\n            // Remove arrow\r\n            toolbarArrow.remove();\r\n            // Move all items to the toolbar\r\n            while (toolbarFloating.firstChild) {\r\n                toolbarContent.appendChild(toolbarFloating.firstChild);\r\n            }\r\n            // Available parent space\r\n            var available = obj.options.maxWidth;\r\n            // Toolbar is larger than the parent, move elements to the floating element\r\n            if (available < toolbarContent.offsetWidth) {\r\n                // Give space to the floating element\r\n                available -= 50;\r\n                // Move to the floating option\r\n                while (toolbarContent.lastChild && available < toolbarContent.offsetWidth) {\r\n                    toolbarFloating.insertBefore(toolbarContent.lastChild, toolbarFloating.firstChild);\r\n                }\r\n            }\r\n            // Show arrow\r\n            if (toolbarFloating.children.length > 0) {\r\n                toolbarContent.appendChild(toolbarArrow);\r\n            }\r\n        }\r\n    }\r\n\r\n    el.onclick = function(e) {\r\n        var element = jSuites.findElement(e.target, 'jtoolbar-item');\r\n        if (element) {\r\n            obj.selectItem(element);\r\n        }\r\n\r\n        if (e.target.classList.contains('jtoolbar-arrow')) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    window.addEventListener('resize', function() {\r\n        obj.refresh();\r\n    });\r\n\r\n    // Toolbar\r\n    el.classList.add('jtoolbar');\r\n    // Reset content\r\n    el.innerHTML = '';\r\n    // Container\r\n    if (obj.options.container == true) {\r\n        el.classList.add('jtoolbar-container');\r\n    }\r\n    // Content\r\n    var toolbarContent = document.createElement('div');\r\n    el.appendChild(toolbarContent);\r\n    // Special toolbar for mobile applications\r\n    if (obj.options.app) {\r\n        el.classList.add('jtoolbar-mobile');\r\n    }\r\n    // Create toolbar\r\n    obj.create(obj.options.items);\r\n    // Shortcut\r\n    el.toolbar = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n\r\n    return jSuites;\r\n\r\n})));", "/**\r\n * (c) jSuites Javascript Web Components\r\n *\r\n * Website: https://jsuites.net\r\n * Description: Create amazing web based applications.\r\n *\r\n * MIT License\r\n *\r\n */\r\n;(function (global, factory) {\r\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n    typeof define === 'function' && define.amd ? define(factory) :\r\n    global.jSuites = factory();\r\n}(this, (function () {\r\n\r\n    'use strict';\r\n\r\nvar jSuites = function(options) {\r\n    var obj = {}\r\n    var version = '4.9.11';\r\n\r\n    var find = function(DOMElement, component) {\r\n        if (DOMElement[component.type] && DOMElement[component.type] == component) {\r\n            return true;\r\n        }\r\n        if (DOMElement.parentNode) {\r\n            return find(DOMElement.parentNode, component);\r\n        }\r\n        return false;\r\n    }\r\n\r\n    var isOpened = function(e) {\r\n        if (jSuites.current.length > 0) {\r\n            for (var i = 0; i < jSuites.current.length; i++) {\r\n                if (jSuites.current[i] && ! find(e.target, jSuites.current[i])) {\r\n                    jSuites.current[i].close();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.init = function() {\r\n        document.addEventListener(\"click\", isOpened);\r\n\r\n        obj.version = version;\r\n    }\r\n\r\n    obj.tracking = function(component, state) {\r\n        if (state == true) {\r\n            jSuites.current = jSuites.current.filter(function(v) {\r\n                return v !== null;\r\n            });\r\n\r\n            // Start after all events\r\n            setTimeout(function() {\r\n                jSuites.current.push(component);\r\n            }, 0);\r\n\r\n        } else {\r\n            var index = jSuites.current.indexOf(component);\r\n            if (index >= 0) {\r\n                jSuites.current[index] = null;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get or set a property from a JSON from a string.\r\n     */\r\n    obj.path = function(str, val) {\r\n        str = str.split('.');\r\n        if (str.length) {\r\n            var o = this;\r\n            var p = null;\r\n            while (str.length > 1) {\r\n                // Get the property\r\n                p = str.shift();\r\n                // Check if the property exists\r\n                if (o.hasOwnProperty(p)) {\r\n                    o = o[p];\r\n                } else {\r\n                    // Property does not exists\r\n                    if (val === undefined) {\r\n                        return undefined;\r\n                    } else {\r\n                        // Create the property\r\n                        o[p] = {};\r\n                        // Next property\r\n                        o = o[p];\r\n                    }\r\n                }\r\n            }\r\n            // Get the property\r\n            p = str.shift();\r\n            // Set or get the value\r\n            if (val !== undefined) {\r\n                o[p] = val;\r\n                // Success\r\n                return true;\r\n            } else {\r\n                // Return the value\r\n                return o[p];\r\n            }\r\n        }\r\n        // Something went wrong\r\n        return false;\r\n    }\r\n\r\n    // Update dictionary\r\n    obj.setDictionary = function(d) {\r\n        obj.dictionary = d;\r\n\r\n        // Translations\r\n        var t = null;\r\n        for (var i = 0; i < jSuites.calendar.weekdays.length; i++) {\r\n            t =  jSuites.translate(jSuites.calendar.weekdays[i]);\r\n            if (jSuites.calendar.weekdays[i]) {\r\n                jSuites.calendar.weekdays[i] = t;\r\n                jSuites.calendar.weekdaysShort[i] = t.substr(0,3);\r\n            }\r\n        }\r\n        for (var i = 0; i < jSuites.calendar.months.length; i++) {\r\n            t = jSuites.translate(jSuites.calendar.months[i]);\r\n            if (t) {\r\n                jSuites.calendar.months[i] = t;\r\n                jSuites.calendar.monthsShort[i] = t.substr(0,3);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Dictionary\r\n    obj.dictionary = {};\r\n\r\n    // Translate\r\n    obj.translate = function(t) {\r\n        return obj.dictionary[t] || t;\r\n    }\r\n\r\n    // Array of opened components\r\n    obj.current = [];\r\n\r\n    return obj;\r\n}();\r\n\r\n/**\r\n * Global jsuites event\r\n */\r\nif (typeof(document) !== \"undefined\") {\r\n    jSuites.init();\r\n}\r\n\r\njSuites.ajax = (function(options, complete) {\r\n    if (Array.isArray(options)) {\r\n        // Create multiple request controller \r\n        var multiple = {\r\n            instance: [],\r\n            complete: complete,\r\n        }\r\n\r\n        if (options.length > 0) {\r\n            for (var i = 0; i < options.length; i++) {\r\n                options[i].multiple = multiple;\r\n                multiple.instance.push(jSuites.ajax(options[i]));\r\n            }\r\n        }\r\n\r\n        return multiple;\r\n    }\r\n\r\n    if (! options.data) {\r\n        options.data = {};\r\n    }\r\n\r\n    if (options.type) {\r\n        options.method = options.type;\r\n    }\r\n\r\n    // Default method\r\n    if (! options.method) {\r\n        options.method = 'GET';\r\n    }\r\n\r\n    // Default type\r\n    if (! options.dataType) {\r\n        options.dataType = 'json';\r\n    }\r\n\r\n    if (options.data) {\r\n        // Parse object to variables format\r\n        var parseData = function(value, key) {\r\n            var vars = [];\r\n            var keys = Object.keys(value);\r\n            if (keys.length) {\r\n                for (var i = 0; i < keys.length; i++) {\r\n                    if (key) {\r\n                        var k = key + '[' + keys[i] + ']';\r\n                    } else {\r\n                        var k = keys[i];\r\n                    }\r\n\r\n                    if (typeof(value[keys[i]]) == 'object') {\r\n                        var r = parseData(value[keys[i]], k);\r\n                        var o = Object.keys(r);\r\n                        for (var j = 0; j < o.length; j++) {\r\n                            vars[o[j]] = r[o[j]];\r\n                        }\r\n                    } else {\r\n                        vars[k] = value[keys[i]];\r\n                    }\r\n                }\r\n            }\r\n\r\n            return vars;\r\n        }\r\n\r\n        var data = [];\r\n        var d = parseData(options.data);\r\n        var k = Object.keys(d);\r\n        for (var i = 0; i < k.length; i++) {\r\n            data.push(k[i] + '=' + encodeURIComponent(d[k[i]]));\r\n        }\r\n\r\n        if (options.method == 'GET' && data.length > 0) {\r\n            if (options.url.indexOf('?') < 0) {\r\n                options.url += '?';\r\n            }\r\n            options.url += data.join('&');\r\n        }\r\n    }\r\n\r\n    var httpRequest = new XMLHttpRequest();\r\n    httpRequest.open(options.method, options.url, true);\r\n    httpRequest.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\r\n\r\n    if (options.method == 'POST') {\r\n        httpRequest.setRequestHeader('Accept', 'application/json');\r\n        httpRequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n    } else {\r\n        if (options.dataType == 'json') {\r\n            httpRequest.setRequestHeader('Content-Type', 'text/json');\r\n        } else if (options.dataType == 'blob') {\r\n            httpRequest.responseType = \"blob\";\r\n        } else if (options.dataType == 'html') {\r\n            httpRequest.setRequestHeader('Content-Type', 'text/html');\r\n        }\r\n    }\r\n\r\n    // No cache\r\n    if (options.cache != true) {\r\n        httpRequest.setRequestHeader('pragma', 'no-cache');\r\n        httpRequest.setRequestHeader('cache-control', 'no-cache');\r\n    }\r\n\r\n    // Authentication\r\n    if (options.withCredentials == true) {\r\n        httpRequest.withCredentials = true\r\n    }\r\n\r\n    // Before send\r\n    if (typeof(options.beforeSend) == 'function') {\r\n        options.beforeSend(httpRequest);\r\n    }\r\n\r\n    httpRequest.onload = function() {\r\n        if (httpRequest.status === 200) {\r\n            if (options.dataType == 'json') {\r\n                try {\r\n                    var result = JSON.parse(httpRequest.responseText);\r\n\r\n                    if (options.success && typeof(options.success) == 'function') {\r\n                        options.success(result);\r\n                    }\r\n                } catch(err) {\r\n                    if (options.error && typeof(options.error) == 'function') {\r\n                        options.error(err, result);\r\n                    }\r\n                }\r\n            } else {\r\n                if (options.dataType == 'blob') {\r\n                    var result = httpRequest.response;\r\n                } else {\r\n                    var result = httpRequest.responseText;\r\n                }\r\n\r\n                if (options.success && typeof(options.success) == 'function') {\r\n                    options.success(result);\r\n                }\r\n            }\r\n        } else {\r\n            if (options.error && typeof(options.error) == 'function') {\r\n                options.error(httpRequest.responseText, httpRequest.status);\r\n            }\r\n        }\r\n\r\n        // Global queue\r\n        if (jSuites.ajax.queue && jSuites.ajax.queue.length > 0) {\r\n            jSuites.ajax.send(jSuites.ajax.queue.shift());\r\n        }\r\n\r\n        // Global complete method\r\n        if (jSuites.ajax.requests && jSuites.ajax.requests.length) {\r\n            // Get index of this request in the container\r\n            var index = jSuites.ajax.requests.indexOf(httpRequest);\r\n            // Remove from the ajax requests container\r\n            jSuites.ajax.requests.splice(index, 1);\r\n            // Deprected: Last one?\r\n            if (! jSuites.ajax.requests.length) {\r\n                // Object event\r\n                if (options.complete && typeof(options.complete) == 'function') {\r\n                    options.complete(result);\r\n                }\r\n            }\r\n            // Group requests\r\n            if (options.group) {\r\n                if (jSuites.ajax.oncomplete && typeof(jSuites.ajax.oncomplete[options.group]) == 'function') {\r\n                    if (! jSuites.ajax.pending(options.group)) {\r\n                        jSuites.ajax.oncomplete[options.group]();\r\n                        jSuites.ajax.oncomplete[options.group] = null;\r\n                    }\r\n                }\r\n            }\r\n            // Multiple requests controller\r\n            if (options.multiple && options.multiple.instance) {\r\n                // Get index of this request in the container\r\n                var index = options.multiple.instance.indexOf(httpRequest);\r\n                // Remove from the ajax requests container\r\n                options.multiple.instance.splice(index, 1);\r\n                // If this is the last one call method complete\r\n                if (! options.multiple.instance.length) {\r\n                    if (options.multiple.complete && typeof(options.multiple.complete) == 'function') {\r\n                        options.multiple.complete(result);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Keep the options\r\n    httpRequest.options = options;\r\n    // Data\r\n    httpRequest.data = data;\r\n\r\n    // Queue\r\n    if (options.queue == true && jSuites.ajax.requests.length > 0) {\r\n        jSuites.ajax.queue.push(httpRequest);\r\n    } else {\r\n        jSuites.ajax.send(httpRequest)\r\n    }\r\n\r\n    return httpRequest;\r\n});\r\n\r\njSuites.ajax.send = function(httpRequest) {\r\n    if (httpRequest.data) {\r\n        httpRequest.send(httpRequest.data.join('&'));\r\n    } else {\r\n        httpRequest.send();\r\n    }\r\n\r\n    jSuites.ajax.requests.push(httpRequest);\r\n}\r\n\r\njSuites.ajax.exists = function(url, __callback) {\r\n    var http = new XMLHttpRequest();\r\n    http.open('HEAD', url, false);\r\n    http.send();\r\n    if (http.status) {\r\n        __callback(http.status);\r\n    }\r\n}\r\n\r\njSuites.ajax.pending = function(group) {\r\n    var n = 0;\r\n    var o = jSuites.ajax.requests;\r\n    if (o && o.length) {\r\n        for (var i = 0; i < o.length; i++) {\r\n            if (! group || group == o[i].options.group) {\r\n                n++\r\n            }\r\n        }\r\n    }\r\n    return n;\r\n}\r\n\r\njSuites.ajax.oncomplete = {};\r\njSuites.ajax.requests = [];\r\njSuites.ajax.queue = [];\r\n\r\njSuites.alert = function(message) {\r\n    if (jSuites.getWindowWidth() < 800 && jSuites.dialog) {\r\n        jSuites.dialog.open({\r\n            title:'Alert',\r\n            message:message,\r\n        });\r\n    } else {\r\n        alert(message);\r\n    }\r\n}\r\n\r\njSuites.animation = {};\r\n\r\njSuites.animation.slideLeft = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-left-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-left-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-left-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-left-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideRight = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-right-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-right-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-right-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-right-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideTop = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-top-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-top-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-top-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-top-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    }\r\n}\r\n\r\njSuites.animation.slideBottom = function(element, direction, done) {\r\n    if (direction == true) {\r\n        element.classList.add('slide-bottom-in');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-bottom-in');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 400);\r\n    } else {\r\n        element.classList.add('slide-bottom-out');\r\n        setTimeout(function() {\r\n            element.classList.remove('slide-bottom-out');\r\n            if (typeof(done) == 'function') {\r\n                done();\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\njSuites.animation.fadeIn = function(element, done) {\r\n    element.style.display = '';\r\n    element.classList.add('fade-in');\r\n    setTimeout(function() {\r\n        element.classList.remove('fade-in');\r\n        if (typeof(done) == 'function') {\r\n            done();\r\n        }\r\n    }, 2000);\r\n}\r\n\r\njSuites.animation.fadeOut = function(element, done) {\r\n    element.classList.add('fade-out');\r\n    setTimeout(function() {\r\n        element.style.display = 'none';\r\n        element.classList.remove('fade-out');\r\n        if (typeof(done) == 'function') {\r\n            done();\r\n        }\r\n    }, 1000);\r\n}\r\n\r\njSuites.calendar = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.calendar) {\r\n        return el.calendar.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type:'calendar' };\r\n    obj.options = {};\r\n\r\n    // Date\r\n    obj.date = null;\r\n\r\n    /**\r\n     * Update options\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            // Render type: [ default | year-month-picker ]\r\n            type: 'default',\r\n            // Restrictions\r\n            validRange: null,\r\n            // Starting weekday - 0 for sunday, 6 for saturday\r\n            startingDay: null, \r\n            // Date format\r\n            format: 'DD/MM/YYYY',\r\n            // Allow keyboard date entry\r\n            readonly: true,\r\n            // Today is default\r\n            today: false,\r\n            // Show timepicker\r\n            time: false,\r\n            // Show the reset button\r\n            resetButton: true,\r\n            // Placeholder\r\n            placeholder: '',\r\n            // Translations can be done here\r\n            months: jSuites.calendar.monthsShort,\r\n            monthsFull: jSuites.calendar.months,\r\n            weekdays: jSuites.calendar.weekdays,\r\n            weekdays_short: jSuites.calendar.weekdays,\r\n            textDone: jSuites.translate('Done'),\r\n            textReset: jSuites.translate('Reset'),\r\n            textUpdate: jSuites.translate('Update'),\r\n            // Value\r\n            value: null,\r\n            // Fullscreen (this is automatic set for screensize < 800)\r\n            fullscreen: false,\r\n            // Create the calendar closed as default\r\n            opened: false,\r\n            // Events\r\n            onopen: null,\r\n            onclose: null,\r\n            onchange: null,\r\n            onupdate: null,\r\n            // Internal mode controller\r\n            mode: null,\r\n            position: null,\r\n            // Data type\r\n            dataType: null,\r\n        }\r\n\r\n        for (var i = 0; i < defaults.weekdays_short.length; i++) {\r\n            defaults.weekdays_short[i] = defaults.weekdays_short[i].substr(0,1);\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Reset button\r\n        if (obj.options.resetButton == false) {\r\n            calendarReset.style.display = 'none';\r\n        } else {\r\n            calendarReset.style.display = '';\r\n        }\r\n\r\n        // Readonly\r\n        if (obj.options.readonly) {\r\n            el.setAttribute('readonly', 'readonly');\r\n        } else {\r\n            el.removeAttribute('readonly');\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            el.removeAttribute('placeholder');\r\n        }\r\n\r\n        if (jSuites.isNumeric(obj.options.value) && obj.options.value > 0) {\r\n            obj.options.value = jSuites.calendar.numToDate(obj.options.value);\r\n            // Data type numberic\r\n            obj.options.dataType = 'numeric';\r\n        }\r\n\r\n        // Texts\r\n        calendarReset.innerHTML = obj.options.textReset;\r\n        calendarConfirm.innerHTML = obj.options.textDone;\r\n        calendarControlsUpdateButton.innerHTML = obj.options.textUpdate;\r\n\r\n        // Define mask\r\n        el.setAttribute('data-mask', obj.options.format.toLowerCase());\r\n\r\n        // Value\r\n        if (! obj.options.value && obj.options.today) {\r\n            var value = jSuites.calendar.now();\r\n        } else {\r\n            var value = obj.options.value;\r\n        }\r\n\r\n        // Set internal date\r\n        if (value) {\r\n            // Force the update\r\n            obj.options.value = null;\r\n            // New value\r\n            obj.setValue(value);\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Open the calendar\r\n     */\r\n    obj.open = function (value) {\r\n        if (! calendar.classList.contains('jcalendar-focus')) {\r\n            if (! calendar.classList.contains('jcalendar-inline')) {\r\n                // Current\r\n                jSuites.calendar.current = obj;\r\n                // Start tracking\r\n                jSuites.tracking(obj, true);\r\n                // Create the days\r\n                obj.getDays();\r\n                // Render months\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.getMonths();\r\n                }\r\n                // Get time\r\n                if (obj.options.time) {\r\n                    calendarSelectHour.value = obj.date[3];\r\n                    calendarSelectMin.value = obj.date[4];\r\n                }\r\n\r\n                // Show calendar\r\n                calendar.classList.add('jcalendar-focus');\r\n\r\n                // Get the position of the corner helper\r\n                if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen) {\r\n                    calendar.classList.add('jcalendar-fullsize');\r\n                    // Animation\r\n                    jSuites.animation.slideBottom(calendarContent, 1);\r\n                } else {\r\n                    calendar.classList.remove('jcalendar-fullsize');\r\n\r\n                    var rect = el.getBoundingClientRect();\r\n                    var rectContent = calendarContent.getBoundingClientRect();\r\n\r\n                    if (obj.options.position) {\r\n                        calendarContainer.style.position = 'fixed';\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            calendarContainer.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                        } else {\r\n                            calendarContainer.style.top = (rect.top + rect.height + 2) + 'px';\r\n                        }\r\n                        calendarContainer.style.left = rect.left + 'px';\r\n                    } else {\r\n                        if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                            var d = -1 * (rect.height + rectContent.height + 2);\r\n                            if (d + rect.top < 0) {\r\n                                d = -1 * (rect.top + rect.height);\r\n                            }\r\n                            calendarContainer.style.top = d + 'px';\r\n                        } else {\r\n                            calendarContainer.style.top = 2 + 'px'; \r\n                        }\r\n\r\n                        if (window.innerWidth < rect.left + rectContent.width) {\r\n                            var d = window.innerWidth - (rect.left + rectContent.width + 20);\r\n                            calendarContainer.style.left = d + 'px';\r\n                        } else {\r\n                            calendarContainer.style.left = '0px'; \r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Events\r\n                if (typeof(obj.options.onopen) == 'function') {\r\n                    obj.options.onopen(el);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.close = function (ignoreEvents, update) {\r\n        if (calendar.classList.contains('jcalendar-focus')) {\r\n            if (update !== false) {\r\n                var element = calendar.querySelector('.jcalendar-selected');\r\n\r\n                if (typeof(update) == 'string') {\r\n                    var value = update;\r\n                } else if (! element || element.classList.contains('jcalendar-disabled')) {\r\n                    var value = obj.options.value\r\n                } else {\r\n                    var value = obj.getValue();\r\n                }\r\n\r\n                obj.setValue(value);\r\n            }\r\n\r\n            // Events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Hide\r\n            calendar.classList.remove('jcalendar-focus');\r\n            // Stop tracking\r\n            jSuites.tracking(obj, false);\r\n            // Current\r\n            jSuites.calendar.current = null;\r\n        }\r\n\r\n        return obj.options.value;\r\n    }\r\n\r\n    obj.prev = function() {\r\n        // Check if the visualization is the days picker or years picker\r\n        if (obj.options.mode == 'years') {\r\n            obj.date[0] = obj.date[0] - 12;\r\n\r\n            // Update picker table of days\r\n            obj.getYears();\r\n        } else if (obj.options.mode == 'months') {\r\n            obj.date[0] = parseInt(obj.date[0]) - 1;\r\n            // Update picker table of months\r\n            obj.getMonths();\r\n        } else {\r\n            // Go to the previous month\r\n            if (obj.date[1] < 2) {\r\n                obj.date[0] = obj.date[0] - 1;\r\n                obj.date[1] = 12;\r\n            } else {\r\n                obj.date[1] = obj.date[1] - 1;\r\n            }\r\n\r\n            // Update picker table of days\r\n            obj.getDays();\r\n        }\r\n    }\r\n\r\n    obj.next = function() {\r\n        // Check if the visualization is the days picker or years picker\r\n        if (obj.options.mode == 'years') {\r\n            obj.date[0] = parseInt(obj.date[0]) + 12;\r\n\r\n            // Update picker table of days\r\n            obj.getYears();\r\n        } else if (obj.options.mode == 'months') {\r\n            obj.date[0] = parseInt(obj.date[0]) + 1;\r\n            // Update picker table of months\r\n            obj.getMonths();\r\n        } else {\r\n            // Go to the previous month\r\n            if (obj.date[1] > 11) {\r\n                obj.date[0] = parseInt(obj.date[0]) + 1;\r\n                obj.date[1] = 1;\r\n            } else {\r\n                obj.date[1] = parseInt(obj.date[1]) + 1;\r\n            }\r\n\r\n            // Update picker table of days\r\n            obj.getDays();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set today\r\n     */\r\n    obj.setToday = function() {\r\n        // Today\r\n        var value = new Date().toISOString().substr(0, 10);\r\n        // Change value\r\n        obj.setValue(value);\r\n        // Value\r\n        return value;\r\n    }\r\n\r\n    obj.setValue = function(val) {\r\n        if (! val) {\r\n            val = '' + val;\r\n        }\r\n        // Values\r\n        var newValue = val;\r\n        var oldValue = obj.options.value;\r\n\r\n        if (oldValue != newValue) {\r\n            // Set label\r\n            if (! newValue) {\r\n                obj.date = null;\r\n                var val = '';\r\n            } else {\r\n                var value = obj.setLabel(newValue, obj.options);\r\n                var date = newValue.split(' ');\r\n                if (! date[1]) {\r\n                    date[1] = '00:00:00';\r\n                }\r\n                var time = date[1].split(':')\r\n                var date = date[0].split('-');\r\n                var y = parseInt(date[0]);\r\n                var m = parseInt(date[1]);\r\n                var d = parseInt(date[2]);\r\n                var h = parseInt(time[0]);\r\n                var i = parseInt(time[1]);\r\n                obj.date = [ y, m, d, h, i, 0 ];\r\n                var val = obj.setLabel(newValue, obj.options);\r\n            }\r\n\r\n            // New value\r\n            obj.options.value = newValue;\r\n\r\n            if (typeof(obj.options.onchange) ==  'function') {\r\n                obj.options.onchange(el, newValue, oldValue);\r\n            }\r\n\r\n            // Lemonade JS\r\n            if (el.value != val) {\r\n                el.value = val;\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        obj.getDays();\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        if (obj.date) {\r\n            if (obj.options.time) {\r\n                return jSuites.two(obj.date[0]) + '-' + jSuites.two(obj.date[1]) + '-' + jSuites.two(obj.date[2]) + ' ' + jSuites.two(obj.date[3]) + ':' + jSuites.two(obj.date[4]) + ':' + jSuites.two(0);\r\n            } else {\r\n                return jSuites.two(obj.date[0]) + '-' + jSuites.two(obj.date[1]) + '-' + jSuites.two(obj.date[2]) + ' ' + jSuites.two(0) + ':' + jSuites.two(0) + ':' + jSuites.two(0);\r\n            }\r\n        } else {\r\n            return \"\";\r\n        }\r\n    }\r\n\r\n    /**\r\n     *  Calendar\r\n     */\r\n    obj.update = function(element, v) {\r\n        if (element.classList.contains('jcalendar-disabled')) {\r\n            // Do nothing\r\n        } else {\r\n            var elements = calendar.querySelector('.jcalendar-selected');\r\n            if (elements) {\r\n                elements.classList.remove('jcalendar-selected');\r\n            }\r\n            element.classList.add('jcalendar-selected');\r\n\r\n            if (element.classList.contains('jcalendar-set-month')) {\r\n                obj.date[1] = v;\r\n            } else {\r\n                obj.date[2] = element.innerText;\r\n            }\r\n\r\n            if (! obj.options.time) {\r\n                obj.close();\r\n            } else {\r\n                obj.date[3] = calendarSelectHour.value;\r\n                obj.date[4] = calendarSelectMin.value;\r\n            }\r\n        }\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    /**\r\n     * Set to blank\r\n     */\r\n    obj.reset = function() {\r\n        // Close calendar\r\n        obj.setValue('');\r\n        obj.date = null;\r\n        obj.close(false, false);\r\n    }\r\n\r\n    /**\r\n     * Get calendar days\r\n     */\r\n    obj.getDays = function() {\r\n        // Mode\r\n        obj.options.mode = 'days';\r\n\r\n        // Setting current values in case of NULLs\r\n        var date = new Date();\r\n\r\n        // Current selection\r\n        var year = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : parseInt(date.getFullYear());\r\n        var month = obj.date && jSuites.isNumeric(obj.date[1]) ? obj.date[1] : parseInt(date.getMonth()) + 1;\r\n        var day = obj.date && jSuites.isNumeric(obj.date[2]) ? obj.date[2] : parseInt(date.getDate());\r\n        var hour = obj.date && jSuites.isNumeric(obj.date[3]) ? obj.date[3] : parseInt(date.getHours());\r\n        var min = obj.date && jSuites.isNumeric(obj.date[4]) ? obj.date[4] : parseInt(date.getMinutes());\r\n\r\n        // Selection container\r\n        obj.date = [ year, month, day, hour, min, 0 ];\r\n\r\n        // Update title\r\n        calendarLabelYear.innerHTML = year;\r\n        calendarLabelMonth.innerHTML = obj.options.months[month - 1];\r\n\r\n        // Current month and Year\r\n        var isCurrentMonthAndYear = (date.getMonth() == month - 1) && (date.getFullYear() == year) ? true : false;\r\n        var currentDay = date.getDate();\r\n\r\n        // Number of days in the month\r\n        var date = new Date(year, month, 0, 0, 0);\r\n        var numberOfDays = date.getDate();\r\n\r\n        // First day\r\n        var date = new Date(year, month-1, 0, 0, 0);\r\n        var firstDay = date.getDay() + 1;\r\n\r\n        // Index value\r\n        var index = obj.options.startingDay || 0;\r\n\r\n        // First of day relative to the starting calendar weekday\r\n        firstDay = firstDay - index;\r\n\r\n        // Reset table\r\n        calendarBody.innerHTML = '';\r\n\r\n        // Weekdays Row\r\n        var row = document.createElement('tr');\r\n        row.setAttribute('align', 'center');\r\n        calendarBody.appendChild(row);\r\n\r\n        // Create weekdays row\r\n        for (var i = 0; i < 7; i++) {\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-weekday')\r\n            cell.innerHTML = obj.options.weekdays_short[index];\r\n            row.appendChild(cell);\r\n            // Next week day\r\n            index++;\r\n            // Restart index\r\n            if (index > 6) {\r\n                index = 0;\r\n            }\r\n        }\r\n\r\n        // Index of days\r\n        var index = 0;\r\n        var d = 0;\r\n \r\n        // Calendar table\r\n        for (var j = 0; j < 6; j++) {\r\n            // Reset cells container\r\n            var row = document.createElement('tr');\r\n            row.setAttribute('align', 'center');\r\n            // Data control\r\n            var emptyRow = true;\r\n            // Create cells\r\n            for (var i = 0; i < 7; i++) {\r\n                // Create cell\r\n                var cell = document.createElement('td');\r\n                cell.classList.add('jcalendar-set-day');\r\n\r\n                if (index >= firstDay && index < (firstDay + numberOfDays)) {\r\n                    // Day cell\r\n                    d++;\r\n                    cell.innerHTML = d;\r\n\r\n                    // Selected\r\n                    if (d == day) {\r\n                        cell.classList.add('jcalendar-selected');\r\n                    }\r\n\r\n                    // Current selection day is today\r\n                    if (isCurrentMonthAndYear && currentDay == d) {\r\n                        cell.style.fontWeight = 'bold';\r\n                    }\r\n\r\n                    // Current selection day\r\n                    var current = jSuites.calendar.now(new Date(year, month-1, d), true);\r\n\r\n                    // Available ranges\r\n                    if (obj.options.validRange) {\r\n                        if (! obj.options.validRange[0] || current >= obj.options.validRange[0]) {\r\n                            var test1 = true;\r\n                        } else {\r\n                            var test1 = false;\r\n                        }\r\n\r\n                        if (! obj.options.validRange[1] || current <= obj.options.validRange[1]) {\r\n                            var test2 = true;\r\n                        } else {\r\n                            var test2 = false;\r\n                        }\r\n\r\n                        if (! (test1 && test2)) {\r\n                            cell.classList.add('jcalendar-disabled');\r\n                        }\r\n                    }\r\n\r\n                    // Control\r\n                    emptyRow = false;\r\n                }\r\n                // Day cell\r\n                row.appendChild(cell);\r\n                // Index\r\n                index++;\r\n            }\r\n\r\n            // Add cell to the calendar body\r\n            if (emptyRow == false) {\r\n                calendarBody.appendChild(row);\r\n            }\r\n        }\r\n\r\n        // Show time controls\r\n        if (obj.options.time) {\r\n            calendarControlsTime.style.display = '';\r\n        } else {\r\n            calendarControlsTime.style.display = 'none';\r\n        }\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.getMonths = function() {\r\n        // Mode\r\n        obj.options.mode = 'months';\r\n\r\n        // Loading month labels\r\n        var months = obj.options.months;\r\n\r\n        // Value\r\n        var value = obj.options.value; \r\n\r\n        // Current date\r\n        var date = new Date();\r\n        var currentYear = parseInt(date.getFullYear());\r\n        var currentMonth = parseInt(date.getMonth()) + 1;\r\n        var selectedYear = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : currentYear;\r\n        var selectedMonth = obj.date && jSuites.isNumeric(obj.date[1]) ? obj.date[1] : currentMonth;\r\n\r\n        // Update title\r\n        calendarLabelYear.innerHTML = obj.date[0];\r\n        calendarLabelMonth.innerHTML = months[selectedMonth-1];\r\n\r\n        // Table\r\n        var table = document.createElement('table');\r\n        table.setAttribute('width', '100%');\r\n\r\n        // Row\r\n        var row = null;\r\n\r\n        // Calendar table\r\n        for (var i = 0; i < 12; i++) {\r\n            if (! (i % 4)) {\r\n                // Reset cells container\r\n                var row = document.createElement('tr');\r\n                row.setAttribute('align', 'center');\r\n                table.appendChild(row);\r\n            }\r\n\r\n            // Create cell\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-set-month');\r\n            cell.setAttribute('data-value', i+1);\r\n            cell.innerText = months[i];\r\n\r\n            if (obj.options.validRange) {\r\n                var current = selectedYear + '-' + jSuites.two(i+1);\r\n                if (! obj.options.validRange[0] || current >= obj.options.validRange[0].substr(0,7)) {\r\n                    var test1 = true;\r\n                } else {\r\n                    var test1 = false;\r\n                }\r\n\r\n                if (! obj.options.validRange[1] || current <= obj.options.validRange[1].substr(0,7)) {\r\n                    var test2 = true;\r\n                } else {\r\n                    var test2 = false;\r\n                }\r\n\r\n                if (! (test1 && test2)) {\r\n                    cell.classList.add('jcalendar-disabled');\r\n                }\r\n            }\r\n\r\n            if (i+1 == selectedMonth) {\r\n                cell.classList.add('jcalendar-selected');\r\n            }\r\n\r\n            if (currentYear == selectedYear && i+1 == currentMonth) {\r\n                cell.style.fontWeight = 'bold';\r\n            }\r\n\r\n            row.appendChild(cell);\r\n        }\r\n\r\n        calendarBody.innerHTML = '<tr><td colspan=\"7\"></td></tr>';\r\n        calendarBody.children[0].children[0].appendChild(table);\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.getYears = function() { \r\n        // Mode\r\n        obj.options.mode = 'years';\r\n\r\n        // Current date\r\n        var date = new Date();\r\n        var currentYear = date.getFullYear();\r\n        var selectedYear = obj.date && jSuites.isNumeric(obj.date[0]) ? obj.date[0] : parseInt(date.getFullYear());\r\n\r\n        // Array of years\r\n        var y = [];\r\n        for (var i = 0; i < 25; i++) {\r\n            y[i] = parseInt(obj.date[0]) + (i - 12);\r\n        }\r\n\r\n        // Assembling the year tables\r\n        var table = document.createElement('table');\r\n        table.setAttribute('width', '100%');\r\n\r\n        for (var i = 0; i < 25; i++) {\r\n            if (! (i % 5)) {\r\n                // Reset cells container\r\n                var row = document.createElement('tr');\r\n                row.setAttribute('align', 'center');\r\n                table.appendChild(row);\r\n            }\r\n\r\n            // Create cell\r\n            var cell = document.createElement('td');\r\n            cell.classList.add('jcalendar-set-year');\r\n            cell.innerText = y[i];\r\n\r\n            if (selectedYear == y[i]) {\r\n                cell.classList.add('jcalendar-selected');\r\n            }\r\n\r\n            if (currentYear == y[i]) {\r\n                cell.style.fontWeight = 'bold';\r\n            }\r\n\r\n            row.appendChild(cell);\r\n        }\r\n\r\n        calendarBody.innerHTML = '<tr><td colspan=\"7\"></td></tr>';\r\n        calendarBody.firstChild.firstChild.appendChild(table);\r\n\r\n        // Update\r\n        updateActions();\r\n    }\r\n\r\n    obj.setLabel = function(value, mixed) {\r\n        return jSuites.calendar.getDateString(value, mixed);\r\n    }\r\n\r\n    obj.fromFormatted = function (value, format) {\r\n        return jSuites.calendar.extractDateFromString(value, format);\r\n    }\r\n\r\n    var mouseUpControls = function(e) {\r\n        var element = jSuites.findElement(e.target, 'jcalendar-container');\r\n        if (element) {\r\n            var action = e.target.className;\r\n\r\n            // Object id\r\n            if (action == 'jcalendar-prev') {\r\n                obj.prev();\r\n            } else if (action == 'jcalendar-next') {\r\n                obj.next();\r\n            } else if (action == 'jcalendar-month') {\r\n                obj.getMonths();\r\n            } else if (action == 'jcalendar-year') {\r\n                obj.getYears();\r\n            } else if (action == 'jcalendar-set-year') {\r\n                obj.date[0] = e.target.innerText;\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.getMonths();\r\n                } else {\r\n                    obj.getDays();\r\n                }\r\n            } else if (e.target.classList.contains('jcalendar-set-month')) {\r\n                var month = parseInt(e.target.getAttribute('data-value'));\r\n                if (obj.options.type == 'year-month-picker') {\r\n                    obj.update(e.target, month);\r\n                } else {\r\n                    obj.date[1] = month;\r\n                    obj.getDays();\r\n                }\r\n            } else if (action == 'jcalendar-confirm' || action == 'jcalendar-update' || action == 'jcalendar-close') {\r\n                obj.close();\r\n            } else if (action == 'jcalendar-backdrop') {\r\n                obj.close(false, false);\r\n            } else if (action == 'jcalendar-reset') {\r\n                obj.reset();\r\n            } else if (e.target.classList.contains('jcalendar-set-day') && e.target.innerText) {\r\n                obj.update(e.target);\r\n            }\r\n        } else {\r\n            obj.close();\r\n        }\r\n    }\r\n\r\n    var keyUpControls = function(e) {\r\n        if (e.target.value && e.target.value.length > 3) {\r\n            var test = jSuites.calendar.extractDateFromString(e.target.value, obj.options.format);\r\n            if (test) {\r\n                obj.setValue(test);\r\n            }\r\n        }\r\n    }\r\n\r\n    // Update actions button\r\n    var updateActions = function() {\r\n        var currentDay = calendar.querySelector('.jcalendar-selected');\r\n\r\n        if (currentDay && currentDay.classList.contains('jcalendar-disabled')) {\r\n            calendarControlsUpdateButton.setAttribute('disabled', 'disabled');\r\n            calendarSelectHour.setAttribute('disabled', 'disabled');\r\n            calendarSelectMin.setAttribute('disabled', 'disabled');\r\n        } else {\r\n            calendarControlsUpdateButton.removeAttribute('disabled');\r\n            calendarSelectHour.removeAttribute('disabled');\r\n            calendarSelectMin.removeAttribute('disabled');\r\n        }\r\n\r\n        // Event\r\n        if (typeof(obj.options.onupdate) == 'function') {\r\n            obj.options.onupdate(el, obj.getValue());\r\n        }\r\n    }\r\n\r\n    var calendar = null;\r\n    var calendarReset = null;\r\n    var calendarConfirm = null;\r\n    var calendarContainer = null;\r\n    var calendarContent = null;\r\n    var calendarLabelYear = null;\r\n    var calendarLabelMonth = null;\r\n    var calendarTable = null;\r\n    var calendarBody = null;\r\n\r\n    var calendarControls = null;\r\n    var calendarControlsTime = null;\r\n    var calendarControlsUpdate = null;\r\n    var calendarControlsUpdateButton = null;\r\n    var calendarSelectHour = null;\r\n    var calendarSelectMin = null;\r\n\r\n    var init = function() {\r\n        // Get value from initial element if that is an input\r\n        if (el.tagName == 'INPUT' && el.value) {\r\n            options.value = el.value;\r\n        }\r\n\r\n        // Calendar DOM elements\r\n        calendarReset = document.createElement('div');\r\n        calendarReset.className = 'jcalendar-reset';\r\n\r\n        calendarConfirm = document.createElement('div');\r\n        calendarConfirm.className = 'jcalendar-confirm';\r\n\r\n        calendarControls = document.createElement('div');\r\n        calendarControls.className = 'jcalendar-controls'\r\n        calendarControls.style.borderBottom = '1px solid #ddd';\r\n        calendarControls.appendChild(calendarReset);\r\n        calendarControls.appendChild(calendarConfirm);\r\n\r\n        calendarContainer = document.createElement('div');\r\n        calendarContainer.className = 'jcalendar-container';\r\n\r\n        calendarContent = document.createElement('div');\r\n        calendarContent.className = 'jcalendar-content';\r\n        calendarContainer.appendChild(calendarContent);\r\n\r\n        // Main element\r\n        if (el.tagName == 'DIV') {\r\n            calendar = el;\r\n            calendar.classList.add('jcalendar-inline');\r\n        } else {\r\n            // Add controls to the screen\r\n            calendarContent.appendChild(calendarControls);\r\n\r\n            calendar = document.createElement('div');\r\n            calendar.className = 'jcalendar';\r\n        }\r\n        calendar.classList.add('jcalendar-container');\r\n        calendar.appendChild(calendarContainer);\r\n\r\n        // Table container\r\n        var calendarTableContainer = document.createElement('div');\r\n        calendarTableContainer.className = 'jcalendar-table';\r\n        calendarContent.appendChild(calendarTableContainer);\r\n\r\n        // Previous button\r\n        var calendarHeaderPrev = document.createElement('td');\r\n        calendarHeaderPrev.setAttribute('colspan', '2');\r\n        calendarHeaderPrev.className = 'jcalendar-prev';\r\n\r\n        // Header with year and month\r\n        calendarLabelYear = document.createElement('span');\r\n        calendarLabelYear.className = 'jcalendar-year';\r\n        calendarLabelMonth = document.createElement('span');\r\n        calendarLabelMonth.className = 'jcalendar-month';\r\n\r\n        var calendarHeaderTitle = document.createElement('td');\r\n        calendarHeaderTitle.className = 'jcalendar-header';\r\n        calendarHeaderTitle.setAttribute('colspan', '3');\r\n        calendarHeaderTitle.appendChild(calendarLabelMonth);\r\n        calendarHeaderTitle.appendChild(calendarLabelYear);\r\n\r\n        var calendarHeaderNext = document.createElement('td');\r\n        calendarHeaderNext.setAttribute('colspan', '2');\r\n        calendarHeaderNext.className = 'jcalendar-next';\r\n\r\n        var calendarHeader = document.createElement('thead');\r\n        var calendarHeaderRow = document.createElement('tr');\r\n        calendarHeaderRow.appendChild(calendarHeaderPrev);\r\n        calendarHeaderRow.appendChild(calendarHeaderTitle);\r\n        calendarHeaderRow.appendChild(calendarHeaderNext);\r\n        calendarHeader.appendChild(calendarHeaderRow);\r\n\r\n        calendarTable = document.createElement('table');\r\n        calendarBody = document.createElement('tbody');\r\n        calendarTable.setAttribute('cellpadding', '0');\r\n        calendarTable.setAttribute('cellspacing', '0');\r\n        calendarTable.appendChild(calendarHeader);\r\n        calendarTable.appendChild(calendarBody);\r\n        calendarTableContainer.appendChild(calendarTable);\r\n\r\n        calendarSelectHour = document.createElement('select');\r\n        calendarSelectHour.className = 'jcalendar-select';\r\n        calendarSelectHour.onchange = function() {\r\n            obj.date[3] = this.value; \r\n\r\n            // Event\r\n            if (typeof(obj.options.onupdate) == 'function') {\r\n                obj.options.onupdate(el, obj.getValue());\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 24; i++) {\r\n            var element = document.createElement('option');\r\n            element.value = i;\r\n            element.innerHTML = jSuites.two(i);\r\n            calendarSelectHour.appendChild(element);\r\n        }\r\n\r\n        calendarSelectMin = document.createElement('select');\r\n        calendarSelectMin.className = 'jcalendar-select';\r\n        calendarSelectMin.onchange = function() {\r\n            obj.date[4] = this.value;\r\n\r\n            // Event\r\n            if (typeof(obj.options.onupdate) == 'function') {\r\n                obj.options.onupdate(el, obj.getValue());\r\n            }\r\n        }\r\n\r\n        for (var i = 0; i < 60; i++) {\r\n            var element = document.createElement('option');\r\n            element.value = i;\r\n            element.innerHTML = jSuites.two(i);\r\n            calendarSelectMin.appendChild(element);\r\n        }\r\n\r\n        // Footer controls\r\n        var calendarControlsFooter = document.createElement('div');\r\n        calendarControlsFooter.className = 'jcalendar-controls';\r\n\r\n        calendarControlsTime = document.createElement('div');\r\n        calendarControlsTime.className = 'jcalendar-time';\r\n        calendarControlsTime.style.maxWidth = '140px';\r\n        calendarControlsTime.appendChild(calendarSelectHour);\r\n        calendarControlsTime.appendChild(calendarSelectMin);\r\n\r\n        calendarControlsUpdateButton = document.createElement('button');\r\n        calendarControlsUpdateButton.setAttribute('type', 'button');\r\n        calendarControlsUpdateButton.className = 'jcalendar-update';\r\n\r\n        calendarControlsUpdate = document.createElement('div');\r\n        calendarControlsUpdate.style.flexGrow = '10';\r\n        calendarControlsUpdate.appendChild(calendarControlsUpdateButton);\r\n        calendarControlsFooter.appendChild(calendarControlsTime);\r\n\r\n        // Only show the update button for input elements\r\n        if (el.tagName == 'INPUT') {\r\n            calendarControlsFooter.appendChild(calendarControlsUpdate);\r\n        }\r\n\r\n        calendarContent.appendChild(calendarControlsFooter);\r\n\r\n        var calendarBackdrop = document.createElement('div');\r\n        calendarBackdrop.className = 'jcalendar-backdrop';\r\n        calendar.appendChild(calendarBackdrop);\r\n\r\n        // Handle events\r\n        el.addEventListener(\"keyup\", keyUpControls);\r\n\r\n        // Add global events\r\n        calendar.addEventListener(\"swipeleft\", function(e) {\r\n            jSuites.animation.slideLeft(calendarTable, 0, function() {\r\n                obj.next();\r\n                jSuites.animation.slideRight(calendarTable, 1);\r\n            });\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n\r\n        calendar.addEventListener(\"swiperight\", function(e) {\r\n            jSuites.animation.slideRight(calendarTable, 0, function() {\r\n                obj.prev();\r\n                jSuites.animation.slideLeft(calendarTable, 1);\r\n            });\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n\r\n        el.onmouseup = function() {\r\n            obj.open();\r\n        }\r\n\r\n        if ('ontouchend' in document.documentElement === true) {\r\n            calendar.addEventListener(\"touchend\", mouseUpControls);\r\n        } else {\r\n            calendar.addEventListener(\"mouseup\", mouseUpControls);\r\n        }\r\n\r\n        // Global controls\r\n        if (! jSuites.calendar.hasEvents) {\r\n            // Execute only one time\r\n            jSuites.calendar.hasEvents = true;\r\n            // Enter and Esc\r\n            document.addEventListener(\"keydown\", jSuites.calendar.keydown);\r\n        }\r\n\r\n        // Set configuration\r\n        obj.setOptions(options);\r\n\r\n        // Append element to the DOM\r\n        if (el.tagName == 'INPUT') {\r\n            el.parentNode.insertBefore(calendar, el.nextSibling);\r\n            // Add properties\r\n            el.setAttribute('autocomplete', 'off');\r\n            // Element\r\n            el.classList.add('jcalendar-input');\r\n            // Value\r\n            el.value = obj.setLabel(obj.getValue(), obj.options);\r\n        } else {\r\n            // Get days\r\n            obj.getDays();\r\n            // Hour\r\n            if (obj.options.time) {\r\n                calendarSelectHour.value = obj.date[3];\r\n                calendarSelectMin.value = obj.date[4];\r\n            }\r\n        }\r\n\r\n        // Default opened\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n\r\n        // Change method\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.calendar = calendar.calendar = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.calendar.keydown = function(e) {\r\n    var calendar = null;\r\n    if (calendar = jSuites.calendar.current) { \r\n        if (e.which == 13) {\r\n            // ENTER\r\n            calendar.close(false, true);\r\n        } else if (e.which == 27) {\r\n            // ESC\r\n            calendar.close(false, false);\r\n        }\r\n    }\r\n}\r\n\r\njSuites.calendar.prettify = function(d, texts) {\r\n    if (! texts) {\r\n        var texts = {\r\n            justNow: 'Just now',\r\n            xMinutesAgo: '{0}m ago',\r\n            xHoursAgo: '{0}h ago',\r\n            xDaysAgo: '{0}d ago',\r\n            xWeeksAgo: '{0}w ago',\r\n            xMonthsAgo: '{0} mon ago',\r\n            xYearsAgo: '{0}y ago',\r\n        }\r\n    }\r\n\r\n    var d1 = new Date();\r\n    var d2 = new Date(d);\r\n    var total = parseInt((d1 - d2) / 1000 / 60);\r\n\r\n    String.prototype.format = function(o) {\r\n        return this.replace('{0}', o);\r\n    }\r\n\r\n    if (total == 0) {\r\n        var text = texts.justNow;\r\n    } else if (total < 90) {\r\n        var text = texts.xMinutesAgo.format(total);\r\n    } else if (total < 1440) { // One day\r\n        var text = texts.xHoursAgo.format(Math.round(total/60));\r\n    } else if (total < 20160) { // 14 days\r\n        var text = texts.xDaysAgo.format(Math.round(total / 1440));\r\n    } else if (total < 43200) { // 30 days\r\n        var text = texts.xWeeksAgo.format(Math.round(total / 10080));\r\n    } else if (total < 1036800) { // 24 months\r\n        var text = texts.xMonthsAgo.format(Math.round(total / 43200));\r\n    } else { // 24 months+\r\n        var text = texts.xYearsAgo.format(Math.round(total / 525600));\r\n    }\r\n\r\n    return text;\r\n}\r\n\r\njSuites.calendar.prettifyAll = function() {\r\n    var elements = document.querySelectorAll('.prettydate');\r\n    for (var i = 0; i < elements.length; i++) {\r\n        if (elements[i].getAttribute('data-date')) {\r\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].getAttribute('data-date'));\r\n        } else {\r\n            elements[i].setAttribute('data-date', elements[i].innerHTML);\r\n            elements[i].innerHTML = jSuites.calendar.prettify(elements[i].innerHTML);\r\n        }\r\n    }\r\n}\r\n\r\njSuites.calendar.now = function(date, dateOnly) {\r\n    if (Array.isArray(date)) {\r\n        var y = date[0];\r\n        var m = date[1];\r\n        var d = date[2];\r\n        var h = date[3];\r\n        var i = date[4];\r\n        var s = date[5];\r\n    } else {\r\n        if (! date) {\r\n            var date = new Date();\r\n        }\r\n        var y = date.getFullYear();\r\n        var m = date.getMonth() + 1;\r\n        var d = date.getDate();\r\n        var h = date.getHours();\r\n        var i = date.getMinutes();\r\n        var s = date.getSeconds();\r\n    }\r\n\r\n    if (dateOnly == true) {\r\n        return jSuites.two(y) + '-' + jSuites.two(m) + '-' + jSuites.two(d);\r\n    } else {\r\n        return jSuites.two(y) + '-' + jSuites.two(m) + '-' + jSuites.two(d) + ' ' + jSuites.two(h) + ':' + jSuites.two(i) + ':' + jSuites.two(s);\r\n    }\r\n}\r\n\r\njSuites.calendar.toArray = function(value) {\r\n    var date = value.split(((value.indexOf('T') !== -1) ? 'T' : ' '));\r\n    var time = date[1];\r\n    var date = date[0].split('-');\r\n    var y = parseInt(date[0]);\r\n    var m = parseInt(date[1]);\r\n    var d = parseInt(date[2]);\r\n\r\n    if (time) {\r\n        var time = time.split(':');\r\n        var h = parseInt(time[0]);\r\n        var i = parseInt(time[1]);\r\n    } else {\r\n        var h = 0;\r\n        var i = 0;\r\n    }\r\n    return [ y, m, d, h, i, 0 ];\r\n}\r\n\r\n// Helper to extract date from a string\r\njSuites.calendar.extractDateFromString = function(date, format) {\r\n    if (date > 0 && Number(date) == date) {\r\n        var d = new Date(Math.round((date - 25569)*86400*1000));\r\n        return d.getFullYear() + \"-\" + jSuites.two(d.getMonth()) + \"-\" + jSuites.two(d.getDate()) + ' 00:00:00';\r\n    }\r\n\r\n    var v1 = '' + date;\r\n    var v2 = format.replace(/[0-9]/g,'');\r\n\r\n    var test = 1;\r\n\r\n    // Get year\r\n    var y = v2.search(\"YYYY\");\r\n    y = v1.substr(y,4);\r\n    if (parseInt(y) != y) {\r\n        test = 0;\r\n    }\r\n\r\n    // Get month\r\n    var m = v2.search(\"MM\");\r\n    m = v1.substr(m,2);\r\n    if (parseInt(m) != m || m > 12) {\r\n        test = 0;\r\n    }\r\n\r\n    // Get day\r\n    var d = v2.search(\"DD\");\r\n    if (d >= 0) {\r\n        d = v1.substr(d,2);\r\n        if (parseInt(d) != d  || d > 31) {\r\n            test = 0;\r\n        }\r\n    } else {\r\n        d = '01';\r\n    }\r\n\r\n    // Get hour\r\n    var h = v2.search(\"HH\");\r\n    if (h >= 0) {\r\n        h = v1.substr(h,2);\r\n        if (! parseInt(h) || h > 23) {\r\n            h = '00';\r\n        }\r\n    } else {\r\n        h = '00';\r\n    }\r\n\r\n    // Get minutes\r\n    var i = v2.search(\"MI\");\r\n    if (i >= 0) {\r\n        i = v1.substr(i,2);\r\n        if (! parseInt(i) || i > 59) {\r\n            i = '00';\r\n        }\r\n    } else {\r\n        i = '00';\r\n    }\r\n\r\n    // Get seconds\r\n    var s = v2.search(\"SS\");\r\n    if (s >= 0) {\r\n        s = v1.substr(s,2);\r\n        if (! parseInt(s) || s > 59) {\r\n            s = '00';\r\n        }\r\n    } else {\r\n        s = '00';\r\n    }\r\n\r\n    if (test == 1 && date.length == v2.length) {\r\n        // Update source\r\n        return y + '-' + m + '-' + d + ' ' + h + ':' +  i + ':' + s;\r\n    }\r\n\r\n    return '';\r\n}\r\n\r\n/**\r\n * Date to number\r\n */\r\njSuites.calendar.dateToNum = function(a, b) {\r\n    a = new Date(a);\r\n    if (! b) {\r\n        b = '1899-12-30 ' + a.getHours() + ':' + a.getMinutes() + ':' + a.getSeconds();\r\n    }\r\n    b = new Date(b);\r\n    var v = a.getTime() - b.getTime();\r\n    return Math.round(v / 86400000);\r\n}\r\n\r\n/**\r\n * Number to date\r\n */\r\njSuites.calendar.numToDate = function(value) {\r\n    var d = new Date(Math.round((value - 25569)*86400*1000));\r\n    return d.getFullYear() + \"-\" + jSuites.two(d.getMonth()+1) + \"-\" + jSuites.two(d.getDate()) + ' 00:00:00';\r\n}\r\n\r\n// Helper to convert date into string\r\njSuites.calendar.getDateString = function(value, options) {\r\n    if (! options) {\r\n        var options = {};\r\n    }\r\n\r\n    // Labels\r\n    if (options && typeof(options) == 'object') {\r\n        var format = options.format;\r\n    } else {\r\n        var format = options;\r\n    }\r\n\r\n    if (! format) {\r\n        format = 'YYYY-MM-DD';\r\n    }\r\n\r\n    // Convert to number of hours\r\n    if (typeof(value) == 'number' && format.indexOf('[h]') >= 0) {\r\n        var result = parseFloat(24 * Number(value));\r\n        if (format.indexOf('mm') >= 0) {\r\n            var h = (''+result).split('.');\r\n            if (h[1]) {\r\n                var d = 60 * parseFloat('0.' + h[1])\r\n                d = parseFloat(d.toFixed(2));\r\n            } else {\r\n                var d = 0;\r\n            }\r\n            result = parseInt(h[0]) + ':' + jSuites.two(d);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    // Date instance\r\n    if (value instanceof Date) {\r\n        value = jSuites.calendar.now(value);\r\n    } else if (value && jSuites.isNumeric(value)) {\r\n        value = jSuites.calendar.numToDate(value);\r\n    }\r\n\r\n    // Tokens\r\n    var tokens = [ 'DAY', 'WD', 'DDDD', 'DDD', 'DD', 'D', 'Q', 'HH24', 'HH12', 'HH', 'H', 'AM/PM', 'MI', 'SS', 'MS', 'YYYY', 'YYY', 'YY', 'Y', 'MONTH', 'MON', 'MMMMM', 'MMMM', 'MMM', 'MM', 'M', '.' ];\r\n\r\n    // Expression to extract all tokens from the string\r\n    var e = new RegExp(tokens.join('|'), 'gi');\r\n    // Extract\r\n    var t = format.match(e);\r\n\r\n    // Compatibility with excel\r\n    for (var i = 0; i < t.length; i++) {\r\n        if (t[i].toUpperCase() == 'MM') {\r\n            // Not a month, correct to minutes\r\n            if (t[i-1] && t[i-1].toUpperCase().indexOf('H') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i-2] && t[i-2].toUpperCase().indexOf('H') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i+1] && t[i+1].toUpperCase().indexOf('S') >= 0) {\r\n                t[i] = 'mi';\r\n            } else if (t[i+2] && t[i+2].toUpperCase().indexOf('S') >= 0) {\r\n                t[i] = 'mi';\r\n            }\r\n        }\r\n    }\r\n\r\n    // Object\r\n    var o = {\r\n        tokens: t\r\n    }\r\n\r\n    // Value\r\n    if (value) {\r\n        var d = ''+value;\r\n        var splitStr = (d.indexOf('T') !== -1) ? 'T' : ' ';\r\n        d = d.split(splitStr);\r\n \r\n        var h = 0;\r\n        var m = 0;\r\n        var s = 0;\r\n\r\n        if (d[1]) {\r\n            h = d[1].split(':');\r\n            m = h[1] ? h[1] : 0;\r\n            s = h[2] ? h[2] : 0;\r\n            h = h[0] ? h[0] : 0;\r\n        }\r\n\r\n        d = d[0].split('-');\r\n\r\n        if (d[0] && d[1] && d[2] && d[0] > 0 && d[1] > 0 && d[1] < 13 && d[2] > 0 && d[2] < 32) {\r\n\r\n            // Data\r\n            o.data = [ d[0], d[1], d[2], h, m, s ];\r\n\r\n            // Value\r\n            o.value = [];\r\n\r\n            // Calendar instance\r\n            var calendar = new Date(o.data[0], o.data[1]-1, o.data[2], o.data[3], o.data[4], o.data[5]);\r\n\r\n            // Get method\r\n            var get = function(i) {\r\n                // Token\r\n                var t = this.tokens[i];\r\n                // Case token\r\n                var s = t.toUpperCase();\r\n                var v = null;\r\n\r\n                if (s === 'YYYY') {\r\n                    v = this.data[0];\r\n                } else if (s === 'YYY') {\r\n                    v = this.data[0].substring(1,4);\r\n                } else if (s === 'YY') {\r\n                    v = this.data[0].substring(2,4);\r\n                } else if (s === 'Y') {\r\n                    v = this.data[0].substring(3,4);\r\n                } else if (t === 'MON') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3).toUpperCase();\r\n                } else if (t === 'mon') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3).toLowerCase();\r\n                } else if (t === 'MONTH') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].toUpperCase();\r\n                } else if (t === 'month') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].toLowerCase();\r\n                } else if (s === 'MMMMM') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0, 1);\r\n                } else if (s === 'MMMM' || t === 'Month') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()];\r\n                } else if (s === 'MMM' || t == 'Mon') {\r\n                    v = jSuites.calendar.months[calendar.getMonth()].substr(0,3);\r\n                } else if (s === 'MM') {\r\n                    v = jSuites.two(this.data[1]);\r\n                } else if (s === 'M') {\r\n                    v = calendar.getMonth()+1;\r\n                } else if (t === 'DAY') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].toUpperCase();\r\n                } else if (t === 'day') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].toLowerCase();\r\n                } else if (s === 'DDDD' || t == 'Day') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()];\r\n                } else if (s === 'DDD') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()].substr(0,3);\r\n                } else if (s === 'DD') {\r\n                    v = jSuites.two(this.data[2]);\r\n                } else if (s === 'D') {\r\n                    v = this.data[2];\r\n                } else if (s === 'Q') {\r\n                    v = Math.floor((calendar.getMonth() + 3) / 3);\r\n                } else if (s === 'HH24' || s === 'HH') {\r\n                    v = jSuites.two(this.data[3]);\r\n                } else if (s === 'HH12') {\r\n                    if (this.data[3] > 12) {\r\n                        v = jSuites.two(this.data[3] - 12);\r\n                    } else {\r\n                        v = jSuites.two(this.data[3]);\r\n                    }\r\n                } else if (s === 'H') {\r\n                    v = this.data[3];\r\n                } else if (s === 'MI') {\r\n                    v = jSuites.two(this.data[4]);\r\n                } else if (s === 'SS') {\r\n                    v = jSuites.two(this.data[5]);\r\n                } else if (s === 'MS') {\r\n                    v = calendar.getMilliseconds();\r\n                } else if (s === 'AM/PM') {\r\n                    if (this.data[3] >= 12) {\r\n                        v = 'PM';\r\n                    } else {\r\n                        v = 'AM';\r\n                    }\r\n                } else if (s === 'WD') {\r\n                    v = jSuites.calendar.weekdays[calendar.getDay()];\r\n                }\r\n\r\n                if (v === null) {\r\n                    this.value[i] = this.tokens[i];\r\n                } else {\r\n                    this.value[i] = v;\r\n                }\r\n            }\r\n\r\n            for (var i = 0; i < o.tokens.length; i++) {\r\n                get.call(o, i);\r\n            }\r\n            // Put pieces together\r\n            value = o.value.join('');\r\n        } else {\r\n            value = '';\r\n        }\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n// Jsuites calendar labels\r\njSuites.calendar.weekdays = [ 'Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday' ];\r\njSuites.calendar.months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];\r\njSuites.calendar.weekdaysShort = [ 'Sun','Mon','Tue','Wed','Thu','Fri','Sat' ];\r\njSuites.calendar.monthsShort = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n\r\n\r\njSuites.color = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.color) {\r\n        return el.color.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'color' };\r\n    obj.options = {};\r\n\r\n    var container = null;\r\n    var backdrop = null;\r\n    var content = null;\r\n    var resetButton = null;\r\n    var closeButton = null;\r\n    var tabs = null;\r\n    var jsuitesTabs = null;\r\n\r\n    /**\r\n     * Update options\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        /**\r\n         * @typedef {Object} defaults\r\n         * @property {(string|Array)} value - Initial value of the compontent\r\n         * @property {string} placeholder - The default instruction text on the element\r\n         * @property {requestCallback} onchange - Method to be execute after any changes on the element\r\n         * @property {requestCallback} onclose - Method to be execute when the element is closed\r\n         * @property {string} doneLabel - Label for button done\r\n         * @property {string} resetLabel - Label for button reset\r\n         * @property {string} resetValue - Value for button reset\r\n         * @property {Bool} showResetButton - Active or note for button reset - default false\r\n         */\r\n        var defaults = {\r\n            placeholder: '',\r\n            value: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onchange: null,\r\n            closeOnChange: true,\r\n            palette: null,\r\n            position: null,\r\n            doneLabel: 'Done',\r\n            resetLabel: 'Reset',\r\n            fullscreen: false,\r\n            opened: false,\r\n        }\r\n\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        if (options && ! options.palette) {\r\n            // Default pallete\r\n            options.palette = jSuites.palette();\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Update the text of the controls, if they have already been created\r\n        if (resetButton) {\r\n            resetButton.innerHTML = obj.options.resetLabel;\r\n        }\r\n        if (closeButton) {\r\n            closeButton.innerHTML = obj.options.doneLabel;\r\n        }\r\n\r\n        // Update the pallete\r\n        if (obj.options.palette && jsuitesTabs) {\r\n            jsuitesTabs.updateContent(0, table());\r\n        }\r\n\r\n        // Value\r\n        if (typeof obj.options.value === 'string') {\r\n            el.value = obj.options.value;\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            if (el.getAttribute('placeholder')) {\r\n                el.removeAttribute('placeholder');\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Open color pallete\r\n     */\r\n    obj.open = function() {\r\n        if (! container.classList.contains('jcolor-focus')) {\r\n            // Start tracking\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Show colorpicker\r\n            container.classList.add('jcolor-focus');\r\n\r\n            var rectContent = content.getBoundingClientRect();\r\n\r\n            if (jSuites.getWindowWidth() < 800 || obj.options.fullscreen == true) {\r\n                content.style.top = '';\r\n                content.classList.add('jcolor-fullscreen');\r\n                jSuites.animation.slideBottom(content, 1);\r\n                backdrop.style.display = 'block';\r\n            } else {\r\n                if (content.classList.contains('jcolor-fullscreen')) {\r\n                    content.classList.remove('jcolor-fullscreen');\r\n                    backdrop.style.display = '';\r\n                }\r\n\r\n                var rect = el.getBoundingClientRect();\r\n\r\n                if (obj.options.position) {\r\n                    content.style.position = 'fixed';\r\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                        content.style.top = (rect.top - (rectContent.height + 2)) + 'px';\r\n                    } else {\r\n                        content.style.top = (rect.top + rect.height + 2) + 'px';\r\n                    }\r\n                    content.style.left = rect.left + 'px';\r\n                } else {\r\n                    if (window.innerHeight < rect.bottom + rectContent.height) {\r\n                        content.style.top = -1 * (rectContent.height + rect.height + 2) + 'px';\r\n                    } else {\r\n                        content.style.top = '2px';\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (typeof(obj.options.onopen) == 'function') {\r\n                obj.options.onopen(el);\r\n            }\r\n\r\n            jsuitesTabs.setBorder(jsuitesTabs.getActive());\r\n\r\n            // Update sliders\r\n            if (obj.options.value) {\r\n                var rgb = HexToRgb(obj.options.value);\r\n\r\n                rgbInputs.forEach(function(rgbInput, index) {\r\n                    rgbInput.value = rgb[index];\r\n                    rgbInput.dispatchEvent(new Event('input'));\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Close color pallete\r\n     */\r\n    obj.close = function(ignoreEvents) {\r\n        if (container.classList.contains('jcolor-focus')) {\r\n            // Remove focus\r\n            container.classList.remove('jcolor-focus');\r\n            // Make sure backdrop is hidden\r\n            backdrop.style.display = '';\r\n            // Call related events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Stop  the object\r\n            jSuites.tracking(obj, false);\r\n        }\r\n\r\n        return obj.options.value;\r\n    }\r\n\r\n    /**\r\n     * Set value\r\n     */\r\n    obj.setValue = function(color) {\r\n        if (! color) {\r\n            color = '';\r\n        }\r\n\r\n        if (color != obj.options.value) {\r\n            obj.options.value = color;\r\n            slidersResult = color;\r\n\r\n            // Remove current selecded mark\r\n            var selected = container.querySelector('.jcolor-selected');\r\n            if (selected) {\r\n                selected.classList.remove('jcolor-selected');\r\n            }\r\n\r\n            // Mark cell as selected\r\n            if (obj.values[color]) {\r\n                obj.values[color].classList.add('jcolor-selected');\r\n            }\r\n\r\n            // Onchange\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, color);\r\n            }\r\n\r\n            // Changes\r\n            if (el.value != obj.options.value) {\r\n                // Set input value\r\n                el.value = obj.options.value;\r\n                // Element onchange native\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (obj.options.closeOnChange == true) {\r\n                obj.close();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get value\r\n     */\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var backdropClickControl = false;\r\n\r\n    // Converts a number in decimal to hexadecimal\r\n    var decToHex = function(num) {\r\n        var hex = num.toString(16);\r\n        return hex.length === 1 ? \"0\" + hex : hex;\r\n    }\r\n\r\n    // Converts a color in rgb to hexadecimal\r\n    var rgbToHex = function(r, g, b) {\r\n        return \"#\" + decToHex(r) + decToHex(g) + decToHex(b);\r\n    }\r\n\r\n    // Converts a number in hexadecimal to decimal\r\n    var hexToDec = function(hex) {\r\n        return parseInt('0x' + hex);\r\n    }\r\n\r\n    // Converts a color in hexadecimal to rgb\r\n    var HexToRgb = function(hex) {\r\n        return [hexToDec(hex.substr(1, 2)), hexToDec(hex.substr(3, 2)), hexToDec(hex.substr(5, 2))]\r\n    }\r\n\r\n    var table = function() {\r\n        // Content of the first tab\r\n        var tableContainer = document.createElement('div');\r\n        tableContainer.className = 'jcolor-grid';\r\n\r\n        // Cells\r\n        obj.values = [];\r\n\r\n        // Table pallete\r\n        var t = document.createElement('table');\r\n        t.setAttribute('cellpadding', '7');\r\n        t.setAttribute('cellspacing', '0');\r\n\r\n        for (var j = 0; j < obj.options.palette.length; j++) {\r\n            var tr = document.createElement('tr');\r\n            for (var i = 0; i < obj.options.palette[j].length; i++) {\r\n                var td = document.createElement('td');\r\n                var color = obj.options.palette[j][i];\r\n                if (color.length < 7 && color.substr(0,1) !== '#') {\r\n                    color = '#' + color;\r\n                }\r\n                td.style.backgroundColor = color;\r\n                td.setAttribute('data-value', color);\r\n                td.innerHTML = '';\r\n                tr.appendChild(td);\r\n\r\n                // Selected color\r\n                if (obj.options.value == color) {\r\n                    td.classList.add('jcolor-selected');\r\n                }\r\n\r\n                // Possible values\r\n                obj.values[color] = td;\r\n            }\r\n            t.appendChild(tr);\r\n        }\r\n\r\n        // Append to the table\r\n        tableContainer.appendChild(t);\r\n\r\n        // Select color\r\n        tableContainer.addEventListener(\"mousedown\", function(e) {\r\n            if (e.target.tagName == 'TD') {\r\n                var value = e.target.getAttribute('data-value');\r\n                if (value) {\r\n                    obj.setValue(value);\r\n                }\r\n            }\r\n        });\r\n\r\n        return tableContainer;\r\n    }\r\n\r\n    // Canvas where the image will be rendered\r\n    var canvas = document.createElement('canvas');\r\n    canvas.width = 200;\r\n    canvas.height = 160;\r\n    var context = canvas.getContext(\"2d\");\r\n\r\n    var resizeCanvas = function() {\r\n        // Specifications necessary to correctly obtain colors later in certain positions\r\n        var m = tabs.firstChild.getBoundingClientRect();\r\n        canvas.width = m.width - 14;\r\n        gradient()\r\n    }\r\n\r\n    var gradient = function() {\r\n        var g = context.createLinearGradient(0, 0, canvas.width, 0);\r\n        // Create color gradient\r\n        g.addColorStop(0,    \"rgb(255,0,0)\");\r\n        g.addColorStop(0.15, \"rgb(255,0,255)\");\r\n        g.addColorStop(0.33, \"rgb(0,0,255)\");\r\n        g.addColorStop(0.49, \"rgb(0,255,255)\");\r\n        g.addColorStop(0.67, \"rgb(0,255,0)\");\r\n        g.addColorStop(0.84, \"rgb(255,255,0)\");\r\n        g.addColorStop(1,    \"rgb(255,0,0)\");\r\n        context.fillStyle = g;\r\n        context.fillRect(0, 0, canvas.width, canvas.height);\r\n        g = context.createLinearGradient(0, 0, 0, canvas.height);\r\n        g.addColorStop(0,   \"rgba(255,255,255,1)\");\r\n        g.addColorStop(0.5, \"rgba(255,255,255,0)\");\r\n        g.addColorStop(0.5, \"rgba(0,0,0,0)\");\r\n        g.addColorStop(1,   \"rgba(0,0,0,1)\");\r\n        context.fillStyle = g;\r\n        context.fillRect(0, 0, canvas.width, canvas.height);\r\n    }\r\n\r\n    var hsl = function() {\r\n        var element = document.createElement('div');\r\n        element.className = \"jcolor-hsl\";\r\n\r\n        var point = document.createElement('div');\r\n        point.className = 'jcolor-point';\r\n\r\n        var div = document.createElement('div');\r\n        div.appendChild(canvas);\r\n        div.appendChild(point);\r\n        element.appendChild(div);\r\n\r\n        // Moves the marquee point to the specified position\r\n        var update = function(buttons, x, y) {\r\n            if (buttons === 1) {\r\n                var rect = element.getBoundingClientRect();\r\n                var left = x - rect.left;\r\n                var top = y - rect.top;\r\n                if (left < 0) {\r\n                    left = 0;\r\n                }\r\n                if (top < 0) {\r\n                    top = 0;\r\n                }\r\n                if (left > rect.width) {\r\n                    left = rect.width;\r\n                }\r\n                if (top > rect.height) {\r\n                    top = rect.height;\r\n                }\r\n                point.style.left = left + 'px';\r\n                point.style.top = top + 'px';\r\n                var pixel = context.getImageData(left, top, 1, 1).data;\r\n                slidersResult = rgbToHex(pixel[0], pixel[1], pixel[2]);\r\n            }\r\n        }\r\n\r\n        // Applies the point's motion function to the div that contains it\r\n        element.addEventListener('mousedown', function(e) {\r\n            update(e.buttons, e.clientX, e.clientY);\r\n        });\r\n\r\n        element.addEventListener('mousemove', function(e) {\r\n            update(e.buttons, e.clientX, e.clientY);\r\n        });\r\n\r\n        element.addEventListener('touchmove', function(e) {\r\n            update(1, e.changedTouches[0].clientX, e.changedTouches[0].clientY);\r\n        });\r\n\r\n        return element;\r\n    }\r\n\r\n    var slidersResult = '';\r\n\r\n    var rgbInputs = [];\r\n\r\n    var changeInputColors = function() {\r\n        if (slidersResult !== '') {\r\n            for (var j = 0; j < rgbInputs.length; j++) {\r\n                var currentColor = HexToRgb(slidersResult);\r\n\r\n                currentColor[j] = 0;\r\n\r\n                var newGradient = 'linear-gradient(90deg, rgb(';\r\n                newGradient += currentColor.join(', ');\r\n                newGradient += '), rgb(';\r\n\r\n                currentColor[j] = 255;\r\n\r\n                newGradient += currentColor.join(', ');\r\n                newGradient += '))';\r\n\r\n                rgbInputs[j].style.backgroundImage = newGradient;\r\n            }\r\n        }\r\n    }\r\n\r\n    var sliders = function() {\r\n        // Content of the third tab\r\n        var slidersElement = document.createElement('div');\r\n        slidersElement.className = 'jcolor-sliders';\r\n\r\n        var slidersBody = document.createElement('div');\r\n\r\n        // Creates a range-type input with the specified name\r\n        var createSliderInput = function(name) {\r\n            var inputContainer = document.createElement('div');\r\n            inputContainer.className = 'jcolor-sliders-input-container';\r\n\r\n            var label = document.createElement('label');\r\n            label.innerText = name;\r\n\r\n            var subContainer = document.createElement('div');\r\n            subContainer.className = 'jcolor-sliders-input-subcontainer';\r\n\r\n            var input = document.createElement('input');\r\n            input.type = 'range';\r\n            input.min = 0;\r\n            input.max = 255;\r\n            input.value = 0;\r\n\r\n            inputContainer.appendChild(label);\r\n            subContainer.appendChild(input);\r\n\r\n            var value = document.createElement('div');\r\n            value.innerText = input.value;\r\n\r\n            input.addEventListener('input', function() {\r\n                value.innerText = input.value;\r\n            });\r\n\r\n            subContainer.appendChild(value);\r\n            inputContainer.appendChild(subContainer);\r\n\r\n            slidersBody.appendChild(inputContainer);\r\n\r\n            return input;\r\n        }\r\n\r\n        // Creates red, green and blue inputs\r\n        rgbInputs = [\r\n            createSliderInput('Red'),\r\n            createSliderInput('Green'),\r\n            createSliderInput('Blue'),\r\n        ];\r\n\r\n        slidersElement.appendChild(slidersBody);\r\n\r\n        // Element that prints the current color\r\n        var slidersResultColor = document.createElement('div');\r\n        slidersResultColor.className = 'jcolor-sliders-final-color';\r\n\r\n        var resultElement = document.createElement('div');\r\n        resultElement.style.visibility = 'hidden';\r\n        resultElement.innerText = 'a';\r\n        slidersResultColor.appendChild(resultElement)\r\n\r\n        // Update the element that prints the current color\r\n        var updateResult = function() {\r\n            var resultColor = rgbToHex(parseInt(rgbInputs[0].value), parseInt(rgbInputs[1].value), parseInt(rgbInputs[2].value));\r\n\r\n            resultElement.innerText = resultColor;\r\n            resultElement.style.color = resultColor;\r\n            resultElement.style.removeProperty('visibility');\r\n\r\n            slidersResult = resultColor;\r\n        }\r\n\r\n        // Apply the update function to color inputs\r\n        rgbInputs.forEach(function(rgbInput) {\r\n            rgbInput.addEventListener('input', function() {\r\n                updateResult();\r\n                changeInputColors();\r\n            });\r\n        });\r\n\r\n        slidersElement.appendChild(slidersResultColor);\r\n\r\n        return slidersElement;\r\n    }\r\n\r\n    var init = function() {\r\n        // Initial options\r\n        obj.setOptions(options);\r\n\r\n        // Add a proper input tag when the element is an input\r\n        if (el.tagName == 'INPUT') {\r\n            el.classList.add('jcolor-input');\r\n            el.readOnly = true;\r\n        }\r\n\r\n        // Table container\r\n        container = document.createElement('div');\r\n        container.className = 'jcolor';\r\n\r\n        // Table container\r\n        backdrop = document.createElement('div');\r\n        backdrop.className = 'jcolor-backdrop';\r\n        container.appendChild(backdrop);\r\n\r\n        // Content\r\n        content = document.createElement('div');\r\n        content.className = 'jcolor-content';\r\n\r\n        // Controls\r\n        var controls = document.createElement('div');\r\n        controls.className = 'jcolor-controls';\r\n        content.appendChild(controls);\r\n\r\n        // Reset button\r\n        resetButton  = document.createElement('div');\r\n        resetButton.className = 'jcolor-reset';\r\n        resetButton.innerHTML = obj.options.resetLabel;\r\n        resetButton.onclick = function(e) {\r\n            obj.setValue('');\r\n            obj.close();\r\n        }\r\n        controls.appendChild(resetButton);\r\n\r\n        // Close button\r\n        closeButton  = document.createElement('div');\r\n        closeButton.className = 'jcolor-close';\r\n        closeButton.innerHTML = obj.options.doneLabel;\r\n        closeButton.onclick = function(e) {\r\n            if (jsuitesTabs.getActive() > 0) {\r\n                obj.setValue(slidersResult);\r\n            }\r\n            obj.close();\r\n        }\r\n        controls.appendChild(closeButton);\r\n\r\n        // Element that will be used to create the tabs\r\n        tabs = document.createElement('div');\r\n        content.appendChild(tabs);\r\n\r\n        // Starts the jSuites tabs component\r\n        jsuitesTabs = jSuites.tabs(tabs, {\r\n            animation: true,\r\n            data: [\r\n                {\r\n                    title: 'Grid',\r\n                    contentElement: table(),\r\n                },\r\n                {\r\n                    title: 'Spectrum',\r\n                    contentElement: hsl(),\r\n                },\r\n                {\r\n                    title: 'Sliders',\r\n                    contentElement: sliders(),\r\n                }\r\n            ],\r\n            onchange: function(element, instance, index) {\r\n                if (index === 1) {\r\n                    resizeCanvas();\r\n                } else {\r\n                    var color = slidersResult !== '' ? slidersResult : obj.getValue();\r\n\r\n                    if (index === 2 && color) {\r\n                        var rgb = HexToRgb(color);\r\n\r\n                        rgbInputs.forEach(function(rgbInput, index) {\r\n                            rgbInput.value = rgb[index];\r\n                            rgbInput.dispatchEvent(new Event('input'));\r\n                        });\r\n                    }\r\n                }\r\n            },\r\n            palette: 'modern',\r\n        });\r\n\r\n        container.appendChild(content);\r\n\r\n        // Insert picker after the element\r\n        if (el.tagName == 'INPUT') {\r\n            el.parentNode.insertBefore(container, el.nextSibling);\r\n        } else {\r\n            el.appendChild(container);\r\n        }\r\n\r\n        /**\r\n         * If element is focus open the picker\r\n         */\r\n        el.addEventListener(\"mouseup\", function(e) {\r\n            obj.open();\r\n        });\r\n\r\n        backdrop.addEventListener(\"mousedown\", function(e) {\r\n            backdropClickControl = true;\r\n        });\r\n\r\n        backdrop.addEventListener(\"mouseup\", function(e) {\r\n            if (backdropClickControl) {\r\n                obj.close();\r\n                backdropClickControl = false;\r\n            }\r\n        });\r\n\r\n        // If the picker is open on the spectrum tab, it changes the canvas size when the window size is changed\r\n        window.addEventListener('resize', function() {\r\n            if (container.classList.contains('jcolor-focus') && jsuitesTabs.getActive() == 1) {\r\n                resizeCanvas();\r\n            }\r\n        });\r\n\r\n        // Default opened\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.color = obj;\r\n\r\n        // Container shortcut\r\n        container.color = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\n\r\n\r\njSuites.contextmenu = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        items: null,\r\n        onclick: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class definition\r\n    el.classList.add('jcontextmenu');\r\n    // Focusable\r\n    el.setAttribute('tabindex', '900');\r\n\r\n    /**\r\n     * Open contextmenu\r\n     */\r\n    obj.open = function(e, items) {\r\n        if (items) {\r\n            // Update content\r\n            obj.options.items = items;\r\n            // Create items\r\n            obj.create(items);\r\n        }\r\n\r\n        // Coordinates\r\n        if ((obj.options.items && obj.options.items.length > 0) || el.children.length) {\r\n            if (e.target) {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            } else {\r\n                var x = e.x;\r\n                var y = e.y;\r\n            }\r\n\r\n            el.classList.add('jcontextmenu-focus');\r\n            el.focus();\r\n\r\n            var rect = el.getBoundingClientRect();\r\n\r\n            if (window.innerHeight < y + rect.height) {\r\n                var h = y - rect.height;\r\n                if (h < 0) {\r\n                    h = 0;\r\n                }\r\n                el.style.top = h + 'px';\r\n            } else {\r\n                el.style.top = y + 'px';\r\n            }\r\n\r\n            if (window.innerWidth < x + rect.width) {\r\n                if (x - rect.width > 0) {\r\n                    el.style.left = (x - rect.width) + 'px';\r\n                } else {\r\n                    el.style.left = '10px';\r\n                }\r\n            } else {\r\n                el.style.left = x + 'px';\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Close menu\r\n     */\r\n    obj.close = function() {\r\n        if (el.classList.contains('jcontextmenu-focus')) {\r\n            el.classList.remove('jcontextmenu-focus');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create items based on the declared objectd\r\n     * @param {object} items - List of object\r\n     */\r\n    obj.create = function(items) {\r\n        // Update content\r\n        el.innerHTML = '';\r\n\r\n        // Append items\r\n        for (var i = 0; i < items.length; i++) {\r\n            var itemContainer = createItemElement(items[i]);\r\n            el.appendChild(itemContainer);\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Private function for create a new Item element\r\n     * @param {type} item\r\n     * @returns {jsuitesL#15.jSuites.contextmenu.createItemElement.itemContainer}\r\n     */\r\n    function createItemElement(item) {\r\n        if (item.type && (item.type == 'line' || item.type == 'divisor')) {\r\n            var itemContainer = document.createElement('hr');\r\n        } else {\r\n            var itemContainer = document.createElement('div');\r\n            var itemText = document.createElement('a');\r\n            itemText.innerHTML = item.title;\r\n\r\n            if (item.tooltip) {\r\n                itemContainer.setAttribute('title', item.tooltip);\r\n            }\r\n\r\n            if (item.icon) {\r\n                itemContainer.setAttribute('data-icon', item.icon);\r\n            }\r\n\r\n            if (item.id) {\r\n                itemContainer.id = item.id;\r\n            }\r\n\r\n            if (item.disabled) {\r\n                itemContainer.className = 'jcontextmenu-disabled';\r\n            } else if (item.onclick) {\r\n                itemContainer.method = item.onclick;\r\n                itemContainer.addEventListener(\"mousedown\", function(e) {\r\n                    e.preventDefault();\r\n                });\r\n                itemContainer.addEventListener(\"mouseup\", function() {\r\n                    // Execute method\r\n                    this.method(this);\r\n                });\r\n            }\r\n            itemContainer.appendChild(itemText);\r\n\r\n            if (item.submenu) {\r\n                var itemIconSubmenu = document.createElement('span');\r\n                itemIconSubmenu.innerHTML = \"&#9658;\";\r\n                itemContainer.appendChild(itemIconSubmenu);\r\n                itemContainer.classList.add('jcontexthassubmenu');\r\n                var el_submenu = document.createElement('div');\r\n                // Class definition\r\n                el_submenu.classList.add('jcontextmenu');\r\n                // Focusable\r\n                el_submenu.setAttribute('tabindex', '900');\r\n                \r\n                // Append items\r\n                var submenu = item.submenu;\r\n                for (var i = 0; i < submenu.length; i++) {\r\n                    var itemContainerSubMenu = createItemElement(submenu[i]);\r\n                    el_submenu.appendChild(itemContainerSubMenu);\r\n                }\r\n\r\n                itemContainer.appendChild(el_submenu);\r\n            } else if (item.shortcut) {\r\n                var itemShortCut = document.createElement('span');\r\n                itemShortCut.innerHTML = item.shortcut;\r\n                itemContainer.appendChild(itemShortCut);\r\n            }\r\n        }\r\n        return itemContainer;\r\n    }\r\n\r\n    if (typeof(obj.options.onclick) == 'function') {\r\n        el.addEventListener('click', function(e) {\r\n            obj.options.onclick(obj, e);\r\n        });\r\n    }\r\n\r\n    // Create items\r\n    if (obj.options.items) {\r\n        obj.create(obj.options.items);\r\n    }\r\n\r\n    el.addEventListener('blur', function(e) {\r\n        obj.close();\r\n    });\r\n\r\n    if (! jSuites.contextmenu.hasEvents) {\r\n        window.addEventListener(\"mousewheel\", function() {\r\n            obj.close();\r\n        });\r\n\r\n        document.addEventListener(\"contextmenu\", function(e) {\r\n            var id = jSuites.contextmenu.getElement(e.target);\r\n            if (id) {\r\n                var element = document.querySelector('#' + id);\r\n                if (! element) {\r\n                    console.error('JSUITES: Contextmenu id not found');\r\n                } else {\r\n                    element.contextmenu.open(e);\r\n                    e.preventDefault();\r\n                }\r\n            }\r\n        });\r\n\r\n        jSuites.contextmenu.hasEvents = true;\r\n    }\r\n\r\n    el.contextmenu = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.contextmenu.getElement = function(element) {\r\n    var foundId = 0;\r\n\r\n    function path (element) {\r\n        if (element.parentNode && element.getAttribute('aria-contextmenu-id')) {\r\n            foundId = element.getAttribute('aria-contextmenu-id')\r\n        } else {\r\n            if (element.parentNode) {\r\n                path(element.parentNode);\r\n            }\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return foundId;\r\n}\r\n\r\njSuites.dropdown = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.dropdown) {\r\n        return el.dropdown.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'dropdown' };\r\n    obj.options = {};\r\n\r\n    // Success\r\n    var success = function(data, val) {\r\n        // Set data\r\n        if (data && data.length) {\r\n            // Sort\r\n            if (obj.options.sortResults !== false) {\r\n                if(typeof obj.options.sortResults == \"function\") {\r\n                    data.sort(obj.options.sortResults);\r\n                } else {\r\n                    data.sort(sortData);\r\n                }\r\n            }\r\n\r\n            obj.setData(data);\r\n\r\n            // Onload method\r\n            if (typeof(obj.options.onload) == 'function') {\r\n                obj.options.onload(el, obj, data, val);\r\n            }\r\n        }\r\n\r\n        // Set value\r\n        if (val) {\r\n            applyValue(val);\r\n        }\r\n\r\n        // Component value\r\n        if (val === undefined || val === null) {\r\n            obj.options.value = '';\r\n        }\r\n        el.value = obj.options.value;\r\n\r\n        // Open dropdown\r\n        if (obj.options.opened == true) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    \r\n    // Default sort\r\n    var sortData = function(itemA, itemB) {\r\n        var testA, testB;\r\n        if(typeof itemA == \"string\") {\r\n            testA = itemA;\r\n        } else {\r\n            if(itemA.text) {\r\n                testA = itemA.text;\r\n            } else if(itemA.name) {\r\n                testA = itemA.name;\r\n            }\r\n        }\r\n        \r\n        if(typeof itemB == \"string\") {\r\n            testB = itemB;\r\n        } else {\r\n            if(itemB.text) {\r\n                testB = itemB.text;\r\n            } else if(itemB.name) {\r\n                testB = itemB.name;\r\n            }\r\n        }\r\n        \r\n        if(typeof testA == \"string\" || typeof testB == \"string\") {\r\n            if(typeof testA != \"string\") { testA = \"\"+testA; }\r\n            if(typeof testB != \"string\") { testB = \"\"+testB; }\r\n            return testA.localeCompare(testB);\r\n        } else {\r\n            return testA - testB;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reset the options for the dropdown\r\n     */\r\n    var resetValue = function() {\r\n        // Reset value container\r\n        obj.value = {};\r\n        // Remove selected\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (obj.items[i].selected == true) {\r\n                if (obj.items[i].element) {\r\n                    obj.items[i].element.classList.remove('jdropdown-selected')\r\n                }\r\n                obj.items[i].selected = null;\r\n            }\r\n        }\r\n        // Reset options\r\n        obj.options.value = '';\r\n    }\r\n\r\n    /**\r\n     * Apply values to the dropdown\r\n     */\r\n    var applyValue = function(values) {\r\n        // Reset the current values\r\n        resetValue();\r\n\r\n        // Read values\r\n        if (values !== null) {\r\n            if (! values) {\r\n                if (typeof(obj.value['']) !== 'undefined') {\r\n                    obj.value[''] = '';\r\n                }\r\n            } else {\r\n                if (! Array.isArray(values)) {\r\n                    values = ('' + values).split(';');\r\n                }\r\n                for (var i = 0; i < values.length; i++) {\r\n                    obj.value[values[i]] = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Update the DOM\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (typeof(obj.value[Value(i)]) !== 'undefined') {\r\n                if (obj.items[i].element) {\r\n                    obj.items[i].element.classList.add('jdropdown-selected')\r\n                }\r\n                obj.items[i].selected = true;\r\n\r\n                // Keep label\r\n                obj.value[Value(i)] = Text(i);\r\n            }\r\n        }\r\n\r\n        // Global value\r\n        obj.options.value = Object.keys(obj.value).join(';');\r\n\r\n        // Update labels\r\n        obj.header.value = obj.getText();\r\n    }\r\n\r\n    // Get the value of one item\r\n    var Value = function(k, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'value';\r\n        } else {\r\n            var property = 'id';\r\n        }\r\n\r\n        if (obj.items[k]) {\r\n            if (v !== undefined) {\r\n                return obj.items[k].data[property] = v;\r\n            } else {\r\n                return obj.items[k].data[property];\r\n            }\r\n        }\r\n\r\n        return '';\r\n    }\r\n\r\n    // Get the label of one item\r\n    var Text = function(k, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'text';\r\n        } else {\r\n            var property = 'name';\r\n        }\r\n\r\n        if (obj.items[k]) {\r\n            if (v !== undefined) {\r\n                return obj.items[k].data[property] = v;\r\n            } else {\r\n                return obj.items[k].data[property];\r\n            }\r\n        }\r\n\r\n        return '';\r\n    }\r\n\r\n    var getValue = function() {\r\n        return Object.keys(obj.value);\r\n    }\r\n\r\n    var getText = function() {\r\n        var data = [];\r\n        var k = Object.keys(obj.value);\r\n        for (var i = 0; i < k.length; i++) {\r\n            data.push(obj.value[k[i]]);\r\n        }\r\n        return data;\r\n    }\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        // Default configuration\r\n        var defaults = {\r\n            url: null,\r\n            data: [],\r\n            format: 0,\r\n            multiple: false,\r\n            autocomplete: false,\r\n            remoteSearch: false,\r\n            lazyLoading: false,\r\n            type: null,\r\n            width: null,\r\n            maxWidth: null,\r\n            opened: false,\r\n            value: null,\r\n            placeholder: '',\r\n            newOptions: false,\r\n            position: false,\r\n            onchange: null,\r\n            onload: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onfocus: null,\r\n            onblur: null,\r\n            oninsert: null,\r\n            onbeforeinsert: null,\n            sortResults: false,\n            autofocus: false,\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Force autocomplete search\r\n        if (obj.options.remoteSearch == true || obj.options.type === 'searchbar') {\r\n            obj.options.autocomplete = true;\r\n        }\r\n\r\n        // New options\r\n        if (obj.options.newOptions == true) {\r\n            obj.header.classList.add('jdropdown-add');\r\n        } else {\r\n            obj.header.classList.remove('jdropdown-add');\r\n        }\r\n\r\n        // Autocomplete\r\n        if (obj.options.autocomplete == true) {\r\n            obj.header.removeAttribute('readonly');\r\n        } else {\r\n            obj.header.setAttribute('readonly', 'readonly');\r\n        }\r\n\r\n        // Place holder\r\n        if (obj.options.placeholder) {\r\n            obj.header.setAttribute('placeholder', obj.options.placeholder);\r\n        } else {\r\n            obj.header.removeAttribute('placeholder');\r\n        }\r\n\r\n        // Remove specific dropdown typing to add again\r\n        el.classList.remove('jdropdown-searchbar');\r\n        el.classList.remove('jdropdown-picker');\r\n        el.classList.remove('jdropdown-list');\r\n\r\n        if (obj.options.type == 'searchbar') {\r\n            el.classList.add('jdropdown-searchbar');\r\n        } else if (obj.options.type == 'list') {\r\n            el.classList.add('jdropdown-list');\r\n        } else if (obj.options.type == 'picker') {\r\n            el.classList.add('jdropdown-picker');\r\n        } else {\r\n            if (jSuites.getWindowWidth() < 800) {\r\n                if (obj.options.autocomplete) {\r\n                    el.classList.add('jdropdown-searchbar');\r\n                    obj.options.type = 'searchbar';\r\n                } else {\r\n                    el.classList.add('jdropdown-picker');\r\n                    obj.options.type = 'picker';\r\n                }\r\n            } else {\r\n                if (obj.options.width) {\r\n                    el.style.width = obj.options.width;\r\n                    el.style.minWidth = obj.options.width;\r\n                } else {\r\n                    el.style.removeProperty('width');\r\n                    el.style.removeProperty('min-width');\r\n                }\r\n\r\n                el.classList.add('jdropdown-default');\r\n                obj.options.type = 'default';\r\n            }\r\n        }\r\n\r\n        // Close button\r\n        if (obj.options.type == 'searchbar') {\r\n            containerHeader.appendChild(closeButton);\r\n        } else {\r\n            container.insertBefore(closeButton, container.firstChild);\r\n        }\r\n\r\n        // Load the content\r\n        if (obj.options.url && ! options.data) {\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    if (data) {\r\n                        success(data, obj.options.value);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            success(obj.options.data, obj.options.value);\r\n        }\r\n\r\n        // Return the instance\r\n        return obj;\r\n    }\r\n\r\n    // Helpers\r\n    var containerHeader = null;\r\n    var container = null;\r\n    var content = null;\r\n    var closeButton = null;\r\n    var resetButton = null;\r\n    var backdrop = null;\r\n\r\n    var keyTimer = null;\r\n\r\n    /**\r\n     * Init dropdown\r\n     */\r\n    var init = function() {\r\n        // Do not accept null\r\n        if (! options) {\r\n            options = {};\r\n        }\r\n\r\n        // If the element is a SELECT tag, create a configuration object\r\n        if (el.tagName == 'SELECT') {\r\n            var ret = jSuites.dropdown.extractFromDom(el, options);\r\n            el = ret.el;\r\n            options = ret.options;\r\n        }\r\n\r\n        // Place holder\r\n        if (! options.placeholder && el.getAttribute('placeholder')) {\r\n            options.placeholder = el.getAttribute('placeholder');\r\n        }\r\n\r\n        // Value container\r\n        obj.value = {};\r\n        // Containers\r\n        obj.items = [];\r\n        obj.groups = [];\r\n        // Search options\r\n        obj.search = '';\r\n        obj.results = null;\r\n\r\n        // Create dropdown\r\n        el.classList.add('jdropdown');\r\n\r\n        // Header container\r\n        containerHeader = document.createElement('div');\r\n        containerHeader.className = 'jdropdown-container-header';\r\n\r\n        // Header\r\n        obj.header = document.createElement('input');\r\n        obj.header.className = 'jdropdown-header';\r\n        obj.header.type = 'text';\r\n        obj.header.setAttribute('autocomplete', 'off');\r\n        obj.header.onfocus = function() {\r\n            if (typeof(obj.options.onfocus) == 'function') {\r\n                obj.options.onfocus(el);\r\n            }\r\n        }\r\n\r\n        obj.header.onblur = function() {\r\n            if (typeof(obj.options.onblur) == 'function') {\r\n                obj.options.onblur(el);\r\n            }\r\n        }\r\n\r\n        obj.header.onkeyup = function(e) {\r\n            if (obj.options.autocomplete == true && ! keyTimer) {\r\n                if (obj.search != obj.header.value.trim()) {\r\n                    keyTimer = setTimeout(function() {\r\n                        obj.find(obj.header.value.trim());\r\n                        keyTimer = null;\r\n                    }, 400);\r\n                }\r\n\r\n                if (! el.classList.contains('jdropdown-focus')) {\r\n                    obj.open();\r\n                }\r\n            } else {\r\n                if (! obj.options.autocomplete) {\r\n                    obj.next(e.key);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Global controls\r\n        if (! jSuites.dropdown.hasEvents) {\r\n            // Execute only one time\r\n            jSuites.dropdown.hasEvents = true;\r\n            // Enter and Esc\r\n            document.addEventListener(\"keydown\", jSuites.dropdown.keydown);\r\n        }\r\n\r\n        // Container\r\n        container = document.createElement('div');\r\n        container.className = 'jdropdown-container';\r\n\r\n        // Dropdown content\r\n        content = document.createElement('div');\r\n        content.className = 'jdropdown-content';\r\n\r\n        // Close button\r\n        closeButton = document.createElement('div');\r\n        closeButton.className = 'jdropdown-close';\r\n        closeButton.innerHTML = 'Done';\r\n\r\n        // Reset button\r\n        resetButton = document.createElement('div');\r\n        resetButton.className = 'jdropdown-reset';\r\n        resetButton.innerHTML = 'x';\r\n        resetButton.onclick = function() {\r\n            obj.reset();\r\n            obj.close();\r\n        }\r\n\r\n        // Create backdrop\r\n        backdrop = document.createElement('div');\r\n        backdrop.className = 'jdropdown-backdrop';\r\n\r\n        // Append elements\r\n        containerHeader.appendChild(obj.header);\r\n\r\n        container.appendChild(content);\r\n        el.appendChild(containerHeader);\r\n        el.appendChild(container);\r\n        el.appendChild(backdrop);\r\n\r\n        // Set the otiptions\r\n        obj.setOptions(options);\r\n\r\n        if ('ontouchsend' in document.documentElement === true) {\r\n            el.addEventListener('touchsend', jSuites.dropdown.mouseup);\r\n        } else {\r\n            el.addEventListener('mouseup', jSuites.dropdown.mouseup);\r\n        }\r\n\r\n        // Lazyloading\r\n        if (obj.options.lazyLoading == true) {\r\n            jSuites.lazyLoading(content, {\r\n                loadUp: obj.loadUp,\r\n                loadDown: obj.loadDown,\r\n            });\r\n        }\r\n\r\n        content.onwheel = function(e) {\r\n            e.stopPropagation();\r\n        }\r\n\r\n        // Change method\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue(obj.options.multiple ? true : false);\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Keep object available from the node\r\n        el.dropdown = obj;\r\n    }\r\n\r\n    /**\r\n     * Get the current remote source of data URL\r\n     */\r\n    obj.getUrl = function() {\r\n        return obj.options.url;\r\n    }\r\n\r\n    /**\r\n     * Set the new data from a remote source\r\n     * @param {string} url - url from the remote source\r\n     * @param {function} callback - callback when the data is loaded\r\n     */\r\n    obj.setUrl = function(url, callback) {\r\n        obj.options.url = url;\r\n\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'json',\r\n            success: function(data) {\r\n                obj.setData(data);\r\n                // Callback\r\n                if (typeof(callback) == 'function') {\r\n                    callback(obj);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Set ID for one item\r\n     */\r\n    obj.setId = function(item, v) {\r\n        // Legacy purposes\r\n        if (! obj.options.format) {\r\n            var property = 'value';\r\n        } else {\r\n            var property = 'id';\r\n        }\r\n\r\n        if (typeof(item) == 'object') {\r\n            item[property] = v;\r\n        } else {\r\n            obj.items[item].data[property] = v;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add a new item\r\n     * @param {string} title - title of the new item\r\n     * @param {string} id - value/id of the new item\n     */\r\n    obj.add = function(title, id) {\r\n        if (! title) {\r\n            var current = obj.options.autocomplete == true ? obj.header.value : '';\r\n            var title = prompt(jSuites.translate('Add A New Option'), current);\r\n            if (! title) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Id\r\n        if (! id) {\r\n           id = jSuites.guid();\r\n        }\r\n\r\n        // Create new item\r\n        if (! obj.options.format) {\r\n            var item = {\r\n                value: id,\r\n                text: title,\r\n            }\r\n        } else {\r\n            var item = {\r\n                id: id,\r\n                name: title,\r\n            }\r\n        }\r\n\r\n        // Callback\r\n        if (typeof(obj.options.onbeforeinsert) == 'function') {\r\n            var ret = obj.options.onbeforeinsert(obj, item);\r\n            if (ret === false) {\r\n                return false;\r\n            } else if (ret) {\r\n                item = ret;\r\n            }\r\n        }\n\n        // Add item to the main list\r\n        obj.options.data.push(item);\r\n\r\n        // Create DOM\r\n        var newItem = obj.createItem(item);\r\n\r\n        // Append DOM to the list\r\n        content.appendChild(newItem.element);\r\n\r\n        // Callback\r\n        if (typeof(obj.options.oninsert) == 'function') {\r\n            obj.options.oninsert(obj, item, newItem);\r\n        }\r\n\r\n        // Show content\r\n        if (content.style.display == 'none') {\r\n            content.style.display = '';\r\n        }\r\n\r\n        // Search?\r\n        if (obj.results) {\r\n            obj.results.push(newItem);\r\n        }\r\n\r\n        return item;\r\n    }\r\n\r\n    /**\r\n     * Create a new item\r\n     */\r\n    obj.createItem = function(data, group, groupName) {\r\n        // Keep the correct source of data\r\n        if (! obj.options.format) {\r\n            if (! data.value && data.id !== undefined) {\r\n                data.value = data.id;\r\n                //delete data.id;\r\n            }\r\n            if (! data.text && data.name !== undefined) {\r\n                data.text = data.name;\r\n                //delete data.name;\r\n            }\r\n        } else {\r\n            if (! data.id && data.value !== undefined) {\r\n                data.id = data.value;\r\n                //delete data.value;\r\n            }\r\n            if (! data.name && data.text !== undefined) {\r\n                data.name = data.text\r\n                //delete data.text;\r\n            }\r\n        }\r\n\r\n        // Create item\r\n        var item = {};\r\n        item.element = document.createElement('div');\r\n        item.element.className = 'jdropdown-item';\r\n        item.element.indexValue = obj.items.length;\r\n        item.data = data;\r\n\r\n        // Groupd DOM\r\n        if (group) {\r\n            item.group = group; \r\n        }\r\n\r\n        // Id\r\n        if (data.id) {\r\n            item.element.setAttribute('id', data.id);\r\n        }\r\n\r\n        // Disabled\r\n        if (data.disabled == true) {\r\n            item.element.setAttribute('data-disabled', true);\r\n        }\r\n\r\n        // Tooltip\n        if (data.tooltip) {\n            item.element.setAttribute('title', data.tooltip);\n        }\n\n        // Image\r\n        if (data.image) {\r\n            var image = document.createElement('img');\r\n            image.className = 'jdropdown-image';\r\n            image.src = data.image;\r\n            if (! data.title) {\r\n               image.classList.add('jdropdown-image-small');\r\n            }\r\n            item.element.appendChild(image);\r\n        } else if (data.icon) {\r\n            var icon = document.createElement('span');\r\n            icon.className = \"jdropdown-icon material-icons\";\r\n            icon.innerText = data.icon;\r\n            if (! data.title) {\r\n               icon.classList.add('jdropdown-icon-small');\r\n            }\r\n            if (data.color) {\r\n                icon.style.color = data.color;\r\n            }\r\n            item.element.appendChild(icon);\n        } else if (data.color) {\r\n            var color = document.createElement('div');\r\n            color.className = 'jdropdown-color';\r\n            color.style.backgroundColor = data.color;\r\n            item.element.appendChild(color);\r\n        }\r\n\r\n        // Set content\r\n        if (! obj.options.format) {\r\n            var text = data.text;\r\n        } else {\r\n            var text = data.name;\r\n        }\r\n\r\n        var node = document.createElement('div');\r\n        node.className = 'jdropdown-description';\r\n        node.innerHTML = text || '&nbsp;'; \r\n\r\n        // Title\r\n        if (data.title) {\r\n            var title = document.createElement('div');\r\n            title.className = 'jdropdown-title';\r\n            title.innerText = data.title;\r\n            node.appendChild(title);\r\n        }\r\n\r\n        // Set content\r\n        if (! obj.options.format) {\r\n            var val = data.value;\r\n        } else {\r\n            var val = data.id;\r\n        }\r\n\r\n        // Value\r\n        if (obj.value[val]) {\r\n            item.element.classList.add('jdropdown-selected');\r\n            item.selected = true;\r\n        }\r\n\r\n        // Keep DOM accessible\r\n        obj.items.push(item);\r\n\r\n        // Add node to item\r\n        item.element.appendChild(node);\r\n\r\n        return item;\r\n    }\r\n\r\n    obj.appendData = function(data) {\r\n        // Create elements\r\n        if (data.length) {\r\n            // Helpers\r\n            var items = [];\r\n            var groups = [];\r\n\r\n            // Prepare data\r\n            for (var i = 0; i < data.length; i++) {\r\n                // Process groups\r\n                if (data[i].group) {\r\n                    if (! groups[data[i].group]) {\r\n                        groups[data[i].group] = [];\r\n                    }\r\n                    groups[data[i].group].push(i);\r\n                } else {\r\n                    items.push(i);\r\n                }\r\n            }\r\n\r\n            // Number of items counter\r\n            var counter = 0;\r\n\r\n            // Groups\r\n            var groupNames = Object.keys(groups);\r\n\r\n            // Append groups in case exists\r\n            if (groupNames.length > 0) {\r\n                for (var i = 0; i < groupNames.length; i++) {\r\n                    // Group container\r\n                    var group = document.createElement('div');\r\n                    group.className = 'jdropdown-group';\r\n                    // Group name\r\n                    var groupName = document.createElement('div');\r\n                    groupName.className = 'jdropdown-group-name';\r\n                    groupName.innerHTML = groupNames[i];\r\n                    // Group arrow\r\n                    var groupArrow = document.createElement('i');\r\n                    groupArrow.className = 'jdropdown-group-arrow jdropdown-group-arrow-down';\r\n                    groupName.appendChild(groupArrow);\r\n                    // Group items\r\n                    var groupContent = document.createElement('div');\r\n                    groupContent.className = 'jdropdown-group-items';\r\n                    for (var j = 0; j < groups[groupNames[i]].length; j++) {\r\n                        var item = obj.createItem(data[groups[groupNames[i]][j]], group, groupNames[i]);\r\n\r\n                        if (obj.options.lazyLoading == false || counter < 200) {\r\n                            groupContent.appendChild(item.element);\r\n                            counter++;\r\n                        }\r\n                    }\r\n                    // Group itens\r\n                    group.appendChild(groupName);\r\n                    group.appendChild(groupContent);\r\n                    // Keep group DOM\r\n                    obj.groups.push(group);\r\n                    // Only add to the screen if children on the group\r\n                    if (groupContent.children.length > 0) {\r\n                        // Add DOM to the content\r\n                        content.appendChild(group);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (items.length) {\r\n                for (var i = 0; i < items.length; i++) {\r\n                    var item = obj.createItem(data[items[i]]);\r\n                    if (obj.options.lazyLoading == false || counter < 200) {\r\n                        content.appendChild(item.element);\r\n                        counter++;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.setData = function(data) {\r\n        // Prepare data\r\n        if (data.length) {\r\n            for (var i = 0; i < data.length; i++) {\r\n                // Compatibility\r\n                if (typeof(data[i]) != 'object') {\r\n                    // Correct format\r\n                    if (! obj.options.format) {\r\n                        data[i] = {\r\n                            value: data[i],\r\n                            text: data[i]\r\n                        }\r\n                    } else {\r\n                        data[i] = {\r\n                            id: data[i],\r\n                            name: data[i]\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Reset current value\r\n            resetValue();\r\n\r\n            // Make sure the content container is blank\r\n            content.innerHTML = '';\r\n\r\n            // Reset\r\n            obj.header.value = '';\r\n\r\n            // Reset items and values\r\n            obj.items = [];\r\n\r\n            // Append data\r\n            obj.appendData(data);\r\n\r\n            // Update data\r\n            obj.options.data = data;\r\n        }\r\n    }\r\n\r\n    obj.getData = function() {\r\n        return obj.options.data;\r\n    }\r\n\r\n    /**\r\n     * Get position of the item\r\n     */\r\n    obj.getPosition = function(val) {\r\n        for (var i = 0; i < obj.items.length; i++) {\r\n            if (Value(i) == val) {\r\n                return i;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Get dropdown current text\r\n     */\r\n    obj.getText = function(asArray) {\r\n        // Get value\r\n        var v = getText();\r\n        // Return value\r\n        if (asArray) {\r\n            return v;\r\n        } else {\r\n            return v.join('; ');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get dropdown current value\r\n     */\r\n    obj.getValue = function(asArray) {\r\n        // Get value\r\n        var v = getValue();\r\n        // Return value\r\n        if (asArray) {\r\n            return v;\r\n        } else {\r\n            return v.join(';');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Change event\r\n     */\r\n    var change = function(oldValue) {\r\n        // Events\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, obj, oldValue, obj.options.value);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set value\r\n     */\r\n    obj.setValue = function(newValue) {\r\n        // Current value\r\n        var oldValue = obj.getValue();\r\n        // New value\r\n        if (Array.isArray(newValue)) {\r\n            newValue = newValue.join(';')\r\n        }\r\n\r\n        if (oldValue !== newValue) {\r\n            // Set value\r\n            applyValue(newValue);\r\n\r\n            // Change\r\n            change(oldValue);\r\n        }\r\n    }\r\n\r\n    obj.resetSelected = function() {\r\n        obj.setValue(null);\r\n    } \r\n\r\n    obj.selectIndex = function(index, force) {\r\n        // Make sure is a number\r\n        var index = parseInt(index);\r\n\r\n        // Only select those existing elements\r\n        if (obj.items && obj.items[index] && (force === true || obj.items[index].data.disabled !== true)) {\r\n            // Reset cursor to a new position\r\n            obj.setCursor(index, false);\r\n\r\n            // Behaviour\r\n            if (! obj.options.multiple) {\r\n                // Update value\r\n                if (obj.items[index].selected) {\r\n                    obj.setValue(null);\r\n                } else {\r\n                    obj.setValue(Value(index));\r\n                }\r\n\r\n                // Close component\r\n                obj.close();\r\n            } else {\r\n                // Old value\r\n                var oldValue = obj.options.value;\r\n\r\n                // Toggle option\r\n                if (obj.items[index].selected) {\r\n                    obj.items[index].element.classList.remove('jdropdown-selected');\r\n                    obj.items[index].selected = false;\r\n\r\n                    delete obj.value[Value(index)];\r\n                } else {\r\n                    // Select element\r\n                    obj.items[index].element.classList.add('jdropdown-selected');\r\n                    obj.items[index].selected = true;\r\n\r\n                    // Set value\r\n                    obj.value[Value(index)] = Text(index);\r\n                }\r\n\r\n                // Global value\r\n                obj.options.value = Object.keys(obj.value).join(';');\r\n\r\n                // Update labels for multiple dropdown\r\n                if (obj.options.autocomplete == false) {\r\n                    obj.header.value = getText().join('; ');\r\n                }\r\n\r\n                // Events\r\n                change(oldValue);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.selectItem = function(item) {\r\n        obj.selectIndex(item.indexValue);\r\n    }\r\n\r\n    var exists = function(k, result) {\r\n        for (var j = 0; j < result.length; j++) {\r\n            if (! obj.options.format) {\r\n                if (result[j].value == k) {\r\n                    return true;\r\n                }\r\n            } else {\r\n                if (result[j].id == k) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    obj.find = function(str) {\r\n        if (obj.search == str.trim()) {\r\n            return false;\r\n        }\r\n\r\n        // Search term\r\n        obj.search = str;\r\n\r\n        // Reset index\r\n        obj.setCursor();\r\n\r\n        // Remove nodes from all groups\r\n        if (obj.groups.length) {\r\n            for (var i = 0; i < obj.groups.length; i++) {\r\n                obj.groups[i].lastChild.innerHTML = '';\r\n            }\r\n        }\r\n\r\n        // Remove all nodes\r\n        content.innerHTML = '';\r\n\r\n        // Remove current items in the remote search\r\n        if (obj.options.remoteSearch == true) {\r\n            // Reset results\r\n            obj.results = null;\r\n            // URL\r\n            var url = obj.options.url + (obj.options.url.indexOf('?') > 0 ? '&' : '?') + 'q=' + str;\r\n            // Remote search\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Reset items\r\n                    obj.items = [];\r\n\r\n                    // Add the current selected items to the results in case they are not there\r\n                    var current = Object.keys(obj.value);\r\n                    if (current.length) {\r\n                        for (var i = 0; i < current.length; i++) {\r\n                            if (! exists(current[i], result)) {\r\n                                if (! obj.options.format) {\r\n                                    result.unshift({ value: current[i], text: obj.value[current[i]] });\r\n                                } else {\r\n                                    result.unshift({ id: current[i], name: obj.value[current[i]] });\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    // Append data\r\n                    obj.appendData(result);\r\n                    // Show or hide results\r\n                    if (! result.length) {\r\n                        content.style.display = 'none';\r\n                    } else {\r\n                        content.style.display = '';\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            // Search terms\r\n            str = new RegExp(str, 'gi');\r\n\r\n            // Reset search\r\n            var results = [];\r\n\r\n            // Append options\r\n            for (var i = 0; i < obj.items.length; i++) {\r\n                // Item label\r\n                var label = Text(i);\r\n                // Item title\r\n                var title = obj.items[i].data.title || '';\r\n                // Group name\r\n                var groupName = obj.items[i].data.group || '';\r\n                // Synonym\r\n                var synonym = obj.items[i].data.synonym || '';\r\n                if (synonym) {\r\n                    synonym = synonym.join(' ');\r\n                }\r\n\r\n                if (str == null || obj.items[i].selected == true || label.match(str) || title.match(str) || groupName.match(str) || synonym.match(str)) {\r\n                    results.push(obj.items[i]);\r\n                }\r\n            }\r\n\r\n            if (! results.length) {\r\n                content.style.display = 'none';\r\n\r\n                // Results\r\n                obj.results = null;\r\n            } else {\r\n                content.style.display = '';\r\n\r\n                // Results\r\n                obj.results = results;\r\n\r\n                // Show 200 items at once\r\n                var number = results.length || 0;\r\n\r\n                // Lazyloading\r\n                if (obj.options.lazyLoading == true && number > 200) {\r\n                    number = 200;\r\n                }\r\n\r\n                for (var i = 0; i < number; i++) {\r\n                    if (obj.results[i].group) {\r\n                        if (! obj.results[i].group.parentNode) {\r\n                            content.appendChild(obj.results[i].group);\r\n                        }\r\n                        obj.results[i].group.lastChild.appendChild(obj.results[i].element);\r\n                    } else {\r\n                        content.appendChild(obj.results[i].element);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Auto focus\r\n        if (obj.options.autofocus == true) {\r\n            obj.first();\r\n        }\r\n    }\r\n\r\n    obj.open = function() {\r\n        // Focus\r\n        if (! el.classList.contains('jdropdown-focus')) {\r\n            // Current dropdown\r\n            jSuites.dropdown.current = obj;\r\n\r\n            // Start tracking\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Add focus\r\n            el.classList.add('jdropdown-focus');\r\n\r\n            // Animation\r\n            if (jSuites.getWindowWidth() < 800) {\r\n                if (obj.options.type == null || obj.options.type == 'picker') {\r\n                    jSuites.animation.slideBottom(container, 1);\r\n                }\r\n            }\r\n\r\n            // Filter\r\n            if (obj.options.autocomplete == true) {\r\n                obj.header.value = obj.search;\r\n                obj.header.focus();\r\n            }\r\n\r\n            // Set cursor for the first or first selected element\r\n            var k = getValue();\r\n            if (k[0]) {\r\n                var cursor = obj.getPosition(k[0]);\r\n                if (cursor !== false) {\r\n                    obj.setCursor(cursor);\r\n                }\r\n            }\r\n\r\n            // Container Size\r\n            if (! obj.options.type || obj.options.type == 'default') {\r\n                var rect = el.getBoundingClientRect();\r\n                var rectContainer = container.getBoundingClientRect();\r\n\r\n                if (obj.options.position) {\r\n                    container.style.position = 'fixed';\r\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\r\n                        container.style.top = '';\r\n                        container.style.bottom = (window.innerHeight - rect.top ) + 1 + 'px';\r\n                    } else {\r\n                        container.style.top = rect.bottom + 'px';\r\n                        container.style.bottom = '';\r\n                    }\r\n                    container.style.left = rect.left + 'px';\r\n                } else {\r\n                    if (window.innerHeight < rect.bottom + rectContainer.height) {\r\n                        container.style.top = '';\r\n                        container.style.bottom = rect.height + 1 + 'px';\r\n                    } else {\r\n                        container.style.top = '';\r\n                        container.style.bottom = '';\r\n                    }\r\n                }\r\n\r\n                container.style.minWidth = rect.width + 'px';\r\n\r\n                if (obj.options.maxWidth) {\r\n                    container.style.maxWidth = obj.options.maxWidth;\r\n                }\r\n\r\n                if (! obj.items.length && obj.options.autocomplete == true) {\r\n                    content.style.display = 'none';\r\n                } else {\r\n                    content.style.display = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Events\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el);\r\n        }\r\n    }\r\n\r\n    obj.close = function(ignoreEvents) {\r\n        if (el.classList.contains('jdropdown-focus')) {\r\n            // Update labels\r\n            obj.header.value = obj.getText();\r\n            // Remove cursor\r\n            obj.setCursor();\r\n            // Events\r\n            if (! ignoreEvents && typeof(obj.options.onclose) == 'function') {\r\n                obj.options.onclose(el);\r\n            }\r\n            // Blur\r\n            if (obj.header.blur) {\r\n                obj.header.blur();\r\n            }\r\n            // Remove focus\r\n            el.classList.remove('jdropdown-focus');\r\n            // Start tracking\r\n            jSuites.tracking(obj, false);\r\n            // Current dropdown\r\n            jSuites.dropdown.current = null;\r\n        }\r\n\r\n        return obj.getValue();\r\n    }\r\n\r\n    /**\r\n     * Set cursor\r\n     */\r\n    obj.setCursor = function(index, setPosition) {\r\n        // Remove current cursor\r\n        if (obj.currentIndex != null) {\r\n            // Remove visual cursor\r\n            if (obj.items && obj.items[obj.currentIndex]) {\r\n                obj.items[obj.currentIndex].element.classList.remove('jdropdown-cursor');\r\n            }\r\n        }\r\n\r\n        if (index == undefined) {\r\n            obj.currentIndex = null;\r\n        } else {\r\n            index = parseInt(index);\r\n\r\n            // Cursor only for visible items\r\n            if (obj.items[index].element.parentNode) {\r\n                obj.items[index].element.classList.add('jdropdown-cursor');\r\n                obj.currentIndex = index;\r\n\r\n                // Update scroll to the cursor element\r\n                if (setPosition !== false && obj.items[obj.currentIndex].element) {\r\n                    var container = content.scrollTop;\r\n                    var element = obj.items[obj.currentIndex].element;\r\n                    content.scrollTop = element.offsetTop - element.scrollTop + element.clientTop - 95;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Compatibility\r\n    obj.resetCursor = obj.setCursor;\r\n    obj.updateCursor = obj.setCursor;\r\n\r\n    /**\r\n     * Reset cursor and selected items\r\n     */\r\n    obj.reset = function() {\r\n        // Reset cursor\r\n        obj.setCursor();\r\n\r\n        // Reset selected\r\n        obj.setValue(null);\r\n    }\r\n\r\n    /**\r\n     * First available item\r\n     */\r\n    obj.first = function() {\r\n        if (obj.options.lazyLoading === true) {\r\n            obj.loadFirst();\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        if (items.length) {\r\n            var newIndex = items[0].indexValue;\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Last available item \r\n     */\r\n    obj.last = function() {\r\n        if (obj.options.lazyLoading === true) {\r\n            obj.loadLast();\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        if (items.length) {\r\n            var newIndex = items[items.length-1].indexValue;\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    obj.next = function(letter) {\r\n        var newIndex = null;\r\n\r\n        if (letter) {\r\n            if (letter.length == 1) {\r\n                // Current index\r\n                var current = obj.currentIndex || -1;\r\n                // Letter\r\n                letter = letter.toLowerCase();\r\n\r\n                var e = null;\r\n                var l = null;\r\n                var items = content.querySelectorAll('.jdropdown-item');\r\n                if (items.length) {\r\n                    for (var i = 0; i < items.length; i++) {\r\n                        if (items[i].indexValue > current) {\r\n                            if (e = obj.items[items[i].indexValue]) {\r\n                                if (l = e.element.innerText[0]) {\r\n                                    l = l.toLowerCase();\r\n                                    if (letter == l) {\r\n                                        newIndex = items[i].indexValue;\r\n                                        break;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                    obj.setCursor(newIndex);\r\n                }\r\n            }\r\n        } else {\r\n            if (obj.currentIndex == undefined || obj.currentIndex == null) {\r\n                obj.first();\r\n            } else {\r\n                var element = obj.items[obj.currentIndex].element;\r\n\r\n                var next = element.nextElementSibling;\r\n                if (next) {\r\n                    if (next.classList.contains('jdropdown-group')) {\r\n                        next = next.lastChild.firstChild;\r\n                    }\r\n                    newIndex = next.indexValue;\r\n                } else {\r\n                    if (element.parentNode.classList.contains('jdropdown-group-items')) {\r\n                        if (next = element.parentNode.parentNode.nextElementSibling) {\r\n                            if (next.classList.contains('jdropdown-group')) {\r\n                                next = next.lastChild.firstChild;\r\n                            } else if (next.classList.contains('jdropdown-item')) {\r\n                                newIndex = next.indexValue;\r\n                            } else {\r\n                                next = null;\r\n                            }\r\n                        }\r\n\r\n                        if (next) {\r\n                            newIndex = next.indexValue;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                if (newIndex !== null) {\r\n                    obj.setCursor(newIndex);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.prev = function() {\r\n        var newIndex = null;\r\n\r\n        if (obj.currentIndex === null) {\r\n            obj.first();\r\n        } else {\r\n            var element = obj.items[obj.currentIndex].element;\r\n\r\n            var prev = element.previousElementSibling;\r\n            if (prev) {\r\n                if (prev.classList.contains('jdropdown-group')) {\r\n                    prev = prev.lastChild.lastChild;\r\n                }\r\n                newIndex = prev.indexValue;\r\n            } else {\r\n                if (element.parentNode.classList.contains('jdropdown-group-items')) {\r\n                    if (prev = element.parentNode.parentNode.previousElementSibling) {\r\n                        if (prev.classList.contains('jdropdown-group')) {\r\n                            prev = prev.lastChild.lastChild;\r\n                        } else if (prev.classList.contains('jdropdown-item')) {\r\n                            newIndex = prev.indexValue;\r\n                        } else {\r\n                            prev = null\r\n                        }\r\n                    }\r\n\r\n                    if (prev) {\r\n                        newIndex = prev.indexValue;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (newIndex !== null) {\r\n            obj.setCursor(newIndex);\r\n        }\r\n    }\r\n\r\n    obj.loadFirst = function() {\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        // Show 200 items at once\r\n        var number = results.length || 0;\r\n\r\n        // Lazyloading\r\n        if (obj.options.lazyLoading == true && number > 200) {\r\n            number = 200;\r\n        }\r\n\r\n        // Reset container\r\n        content.innerHTML = '';\r\n\r\n        // First 200 items\r\n        for (var i = 0; i < number; i++) {\r\n            if (results[i].group) {\r\n                if (! results[i].group.parentNode) {\r\n                    content.appendChild(results[i].group);\r\n                }\r\n                results[i].group.lastChild.appendChild(results[i].element);\r\n            } else {\r\n                content.appendChild(results[i].element);\r\n            }\r\n        }\r\n\r\n        // Scroll go to the begin\r\n        content.scrollTop = 0;\r\n    }\r\n\r\n    obj.loadLast = function() {\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        // Show first page\r\n        var number = results.length;\r\n\r\n        // Max 200 items\r\n        if (number > 200) {\r\n            number = number - 200;\r\n\r\n            // Reset container\r\n            content.innerHTML = '';\r\n\r\n            // First 200 items\r\n            for (var i = number; i < results.length; i++) {\r\n                if (results[i].group) {\r\n                    if (! results[i].group.parentNode) {\r\n                        content.appendChild(results[i].group);\r\n                    }\r\n                    results[i].group.lastChild.appendChild(results[i].element);\r\n                } else {\r\n                    content.appendChild(results[i].element);\r\n                }\r\n            }\r\n\r\n            // Scroll go to the begin\r\n            content.scrollTop = content.scrollHeight;\r\n        }\r\n    }\r\n\r\n    obj.loadUp = function() {\r\n        var test = false;\r\n\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        var fistItem = items[0].indexValue;\r\n        fistItem = obj.items[fistItem];\r\n        var index = results.indexOf(fistItem) - 1;\r\n\r\n        if (index > 0) {\r\n            var number = 0;\r\n\r\n            while (index > 0 && results[index] && number < 200) {\r\n                if (results[index].group) {\r\n                    if (! results[index].group.parentNode) {\r\n                        content.insertBefore(results[index].group, content.firstChild);\r\n                    }\r\n                    results[index].group.lastChild.insertBefore(results[index].element, results[index].group.lastChild.firstChild);\r\n                } else {\r\n                    content.insertBefore(results[index].element, content.firstChild);\r\n                }\r\n\r\n                index--;\r\n                number++;\r\n            }\r\n\r\n            // New item added\r\n            test = true;\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    obj.loadDown = function() {\r\n        var test = false;\r\n\r\n        // Search\r\n        if (obj.results) {\r\n            var results = obj.results;\r\n        } else {\r\n            var results = obj.items;\r\n        }\r\n\r\n        var items = content.querySelectorAll('.jdropdown-item');\r\n        var lastItem = items[items.length-1].indexValue;\r\n        lastItem = obj.items[lastItem];\r\n        var index = results.indexOf(lastItem) + 1;\r\n\r\n        if (index < results.length) {\r\n            var number = 0;\r\n            while (index < results.length && results[index] && number < 200) {\r\n                if (results[index].group) {\r\n                    if (! results[index].group.parentNode) {\r\n                        content.appendChild(results[index].group);\r\n                    }\r\n                    results[index].group.lastChild.appendChild(results[index].element);\r\n                } else {\r\n                    content.appendChild(results[index].element);\r\n                }\r\n\r\n                index++;\r\n                number++;\r\n            }\r\n\r\n            // New item added\r\n            test = true;\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.dropdown.keydown = function(e) {\r\n    var dropdown = null;\r\n    if (dropdown = jSuites.dropdown.current) {\r\n        if (e.which == 13 || e.which == 9) {  // enter or tab\n            if (dropdown.header.value && dropdown.currentIndex == null && dropdown.options.newOptions) {\n                // if they typed something in, but it matched nothing, and newOptions are allowed, start that flow\n                dropdown.add();\n            } else {\n                // Quick Select/Filter\r\n                if (dropdown.currentIndex == null && dropdown.options.autocomplete == true && dropdown.header.value != \"\") {\r\n                    dropdown.find(dropdown.header.value);\r\n                }\r\n                dropdown.selectIndex(dropdown.currentIndex);\r\n            }\n        } else if (e.which == 38) {  // up arrow\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex > 0) {\r\n                dropdown.prev();\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 40) {  // down arrow\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex + 1 < dropdown.items.length) {\r\n                dropdown.next();\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 36) {\r\n            dropdown.first();\r\n            if (! e.target.classList.contains('jdropdown-header')) {\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 35) {\r\n            dropdown.last();\r\n            if (! e.target.classList.contains('jdropdown-header')) {\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.which == 27) {\r\n            dropdown.close();\r\n        } else if (e.which == 33) {  // page up\r\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex > 0) {\r\n                for (var i = 0; i < 7; i++) {\r\n                    dropdown.prev()\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.which == 34) {  // page down\r\n            if (dropdown.currentIndex == null) {\r\n                dropdown.first();\r\n            } else if (dropdown.currentIndex + 1 < dropdown.items.length) {\r\n                for (var i = 0; i < 7; i++) {\r\n                    dropdown.next()\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.dropdown.mouseup = function(e) {\r\n    var element = jSuites.findElement(e.target, 'jdropdown');\r\n    if (element) {\r\n        var dropdown = element.dropdown;\r\n        if (e.target.classList.contains('jdropdown-header')) {\r\n            if (element.classList.contains('jdropdown-focus') && element.classList.contains('jdropdown-default')) {\r\n                var rect = element.getBoundingClientRect();\r\n\r\n                if (e.changedTouches && e.changedTouches[0]) {\r\n                    var x = e.changedTouches[0].clientX;\r\n                    var y = e.changedTouches[0].clientY;\r\n                } else {\r\n                    var x = e.clientX;\r\n                    var y = e.clientY;\r\n                }\r\n\r\n                if (rect.width - (x - rect.left) < 30) {\r\n                    if (e.target.classList.contains('jdropdown-add')) {\r\n                        dropdown.add();\r\n                    } else {\r\n                        dropdown.close();\r\n                    }\r\n                } else {\r\n                    if (dropdown.options.autocomplete == false) {\r\n                        dropdown.close();\r\n                    }\r\n                }\r\n            } else {\r\n                dropdown.open();\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-group-name')) {\r\n            var items = e.target.nextSibling.children;\r\n            if (e.target.nextSibling.style.display != 'none') {\r\n                for (var i = 0; i < items.length; i++) {\r\n                    if (items[i].style.display != 'none') {\r\n                        dropdown.selectItem(items[i]);\r\n                    }\r\n                }\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-group-arrow')) {\r\n            if (e.target.classList.contains('jdropdown-group-arrow-down')) {\r\n                e.target.classList.remove('jdropdown-group-arrow-down');\r\n                e.target.classList.add('jdropdown-group-arrow-up');\r\n                e.target.parentNode.nextSibling.style.display = 'none';\r\n            } else {\r\n                e.target.classList.remove('jdropdown-group-arrow-up');\r\n                e.target.classList.add('jdropdown-group-arrow-down');\r\n                e.target.parentNode.nextSibling.style.display = '';\r\n            }\r\n        } else if (e.target.classList.contains('jdropdown-item')) {\r\n            dropdown.selectItem(e.target);\r\n        } else if (e.target.classList.contains('jdropdown-image')) {\r\n            dropdown.selectItem(e.target.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-description')) {\r\n            dropdown.selectItem(e.target.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-title')) {\r\n            dropdown.selectItem(e.target.parentNode.parentNode);\r\n        } else if (e.target.classList.contains('jdropdown-close') || e.target.classList.contains('jdropdown-backdrop')) {\r\n            dropdown.close();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.dropdown.extractFromDom = function(el, options) {\r\n    // Keep reference\r\n    var select = el;\r\n    if (! options) {\r\n        options = {};\r\n    }\r\n    // Prepare configuration\r\n    if (el.getAttribute('multiple') && (! options || options.multiple == undefined)) {\r\n        options.multiple = true;\r\n    }\r\n    if (el.getAttribute('placeholder') && (! options || options.placeholder == undefined)) {\r\n        options.placeholder = el.getAttribute('placeholder');\r\n    }\r\n    if (el.getAttribute('data-autocomplete') && (! options || options.autocomplete == undefined)) {\r\n        options.autocomplete = true;\r\n    }\r\n    if (! options || options.width == undefined) {\r\n        options.width = el.offsetWidth;\r\n    }\r\n    if (el.value && (! options || options.value == undefined)) {\r\n        options.value = el.value;\r\n    }\r\n    if (! options || options.data == undefined) {\r\n        options.data = [];\r\n        for (var j = 0; j < el.children.length; j++) {\r\n            if (el.children[j].tagName == 'OPTGROUP') {\r\n                for (var i = 0; i < el.children[j].children.length; i++) {\r\n                    options.data.push({\r\n                        value: el.children[j].children[i].value,\r\n                        text: el.children[j].children[i].innerHTML,\r\n                        group: el.children[j].getAttribute('label'),\r\n                    });\r\n                }\r\n            } else {\r\n                options.data.push({\r\n                    value: el.children[j].value,\r\n                    text: el.children[j].innerHTML,\r\n                });\r\n            }\r\n        }\r\n    }\r\n    if (! options || options.onchange == undefined) {\r\n        options.onchange = function(a,b,c,d) {\r\n            if (options.multiple == true) {\r\n                if (obj.items[b].classList.contains('jdropdown-selected')) {\r\n                    select.options[b].setAttribute('selected', 'selected');\r\n                } else {\r\n                    select.options[b].removeAttribute('selected');\r\n                }\r\n            } else {\r\n                select.value = d;\r\n            }\r\n        }\r\n    }\r\n    // Create DIV\r\n    var div = document.createElement('div');\r\n    el.parentNode.insertBefore(div, el);\r\n    el.style.display = 'none';\r\n    el = div;\r\n\r\n    return { el:el, options:options };\r\n}\r\n\r\njSuites.editor = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        // Initial HTML content\r\n        value: null,\r\n        // Initial snippet\r\n        snippet: null,\r\n        // Add toolbar\r\n        toolbar: null,\r\n        // Website parser is to read websites and images from cross domain\r\n        remoteParser: null,\r\n        // Placeholder\r\n        placeholder: null,\r\n        // Parse URL\r\n        parseURL: false,\r\n        filterPaste: true,\r\n        // Accept drop files\r\n        dropZone: false,\r\n        dropAsSnippet: false,\r\n        acceptImages: false,\r\n        acceptFiles: false,\r\n        maxFileSize: 5000000,\r\n        allowImageResize: true,\r\n        // Style\r\n        border: true,\r\n        padding: true,\r\n        maxHeight: null,\r\n        height: null,\r\n        focus: false,\r\n        // Events\r\n        onclick: null,\r\n        onfocus: null,\r\n        onblur: null,\r\n        onload: null,\r\n        onkeyup: null,\r\n        onkeydown: null,\r\n        onchange: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Private controllers\r\n    var imageResize = 0;\r\n    var editorTimer = null;\r\n    var editorAction = null;\r\n    var files = [];\r\n\r\n    // Make sure element is empty\r\n    el.innerHTML = '';\r\n\r\n    // Keep the reference for the container\r\n    obj.el = el;\r\n\r\n    if (typeof(obj.options.onclick) == 'function') {\r\n        el.onclick = function(e) {\r\n            obj.options.onclick(el, obj, e);\r\n        }\r\n    }\r\n\r\n    // Prepare container\r\n    el.classList.add('jeditor-container');\r\n\r\n    // Padding\r\n    if (obj.options.padding == true) {\r\n        el.classList.add('jeditor-padding');\r\n    }\r\n\r\n    // Border\r\n    if (obj.options.border == false) {\r\n        el.style.border = '0px';\r\n    }\r\n\r\n    // Snippet\r\n    var snippet = document.createElement('div');\r\n    snippet.className = 'jsnippet';\r\n    snippet.setAttribute('contenteditable', false);\r\n\r\n    // Toolbar\r\n    var toolbar = document.createElement('div');\r\n    toolbar.className = 'jeditor-toolbar';\r\n\r\n    // Create editor\r\n    var editor = document.createElement('div');\r\n    editor.setAttribute('contenteditable', true);\r\n    editor.setAttribute('spellcheck', false);\r\n    editor.className = 'jeditor';\r\n\r\n    // Placeholder\r\n    if (obj.options.placeholder) {\r\n        editor.setAttribute('data-placeholder', obj.options.placeholder);\r\n    }\r\n\r\n    // Max height\r\n    if (obj.options.maxHeight || obj.options.height) {\r\n        editor.style.overflowY = 'auto';\r\n\r\n        if (obj.options.maxHeight) {\r\n            editor.style.maxHeight = obj.options.maxHeight;\r\n        }\r\n        if (obj.options.height) {\r\n            editor.style.height = obj.options.height;\r\n        }\r\n    }\r\n\r\n    // Set editor initial value\r\n    if (obj.options.value) {\r\n        var value = obj.options.value;\r\n    } else {\r\n        var value = el.innerHTML ? el.innerHTML : ''; \r\n    }\r\n\r\n    if (! value) {\r\n        var value = '';\r\n    }\r\n\r\n    /**\r\n     * Onchange event controllers\r\n     */\r\n    var change = function(e) {\r\n        if (typeof(obj.options.onchange) == 'function') { \r\n            obj.options.onchange(el, obj, e);\r\n        }\r\n\r\n        // Update value\r\n        obj.options.value = obj.getData();\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract images from a HTML string\r\n     */\r\n    var extractImageFromHtml = function(html) {\r\n        // Create temp element\r\n        var div = document.createElement('div');\r\n        div.innerHTML = html;\r\n\r\n        // Extract images\r\n        var img = div.querySelectorAll('img');\r\n\r\n        if (img.length) {\r\n            for (var i = 0; i < img.length; i++) {\r\n                obj.addImage(img[i].src);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Insert node at caret\r\n     */\r\n    var insertNodeAtCaret = function(newNode) {\r\n        var sel, range;\r\n\r\n        if (window.getSelection) {\r\n            sel = window.getSelection();\r\n            if (sel.rangeCount) {\r\n                range = sel.getRangeAt(0);\r\n                var selectedText = range.toString();\r\n                range.deleteContents();\r\n                range.insertNode(newNode); \r\n                // move the cursor after element\r\n                range.setStartAfter(newNode);\r\n                range.setEndAfter(newNode); \r\n                sel.removeAllRanges();\r\n                sel.addRange(range);\r\n            }\r\n        }\r\n    }\r\n\r\n    var updateTotalImages = function() {\r\n        var o = null;\r\n        if (o = snippet.children[0]) {\r\n            // Make sure is a grid\r\n            if (! o.classList.contains('jslider-grid')) {\r\n                o.classList.add('jslider-grid');\r\n            }\r\n            // Quantify of images\r\n            var number = o.children.length;\r\n            // Set the configuration of the grid\r\n            o.setAttribute('data-number', number > 4 ? 4 : number);\r\n            // Total of images inside the grid\r\n            if (number > 4) {\r\n                o.setAttribute('data-total', number - 4);\r\n            } else {\r\n                o.removeAttribute('data-total');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Append image to the snippet\r\n     */\r\n    var appendImage = function(image) {\r\n        if (! snippet.innerHTML) {\r\n            appendElement({});\r\n        }\r\n        snippet.children[0].appendChild(image);\r\n        updateTotalImages();\r\n    }\r\n\r\n    /**\r\n     * Append snippet\r\n     * @Param object data\r\n     */\r\n    var appendElement = function(data) {\r\n        // Reset snippet\r\n        snippet.innerHTML = '';\r\n\r\n        // Attributes\r\n        var a = [ 'image', 'title', 'description', 'host', 'url' ];\r\n\r\n        for (var i = 0; i < a.length; i++) {\r\n            var div = document.createElement('div');\r\n            div.className = 'jsnippet-' + a[i];\r\n            div.setAttribute('data-k', a[i]);\r\n            snippet.appendChild(div);\r\n            if (data[a[i]]) {\r\n                if (a[i] == 'image') {\r\n                    if (! Array.isArray(data.image)) {\r\n                        data.image = [ data.image ];\r\n                    }\r\n                    for (var j = 0; j < data.image.length; j++) {\r\n                        var img = document.createElement('img');\r\n                        img.src = data.image[j];\r\n                        div.appendChild(img);\r\n                    }\r\n                } else {\r\n                    div.innerHTML = data[a[i]];\r\n                }\r\n            }\r\n        }\r\n\r\n        editor.appendChild(document.createElement('br'));\r\n        editor.appendChild(snippet);\r\n    }\r\n\r\n    var verifyEditor = function() {\r\n        clearTimeout(editorTimer);\r\n        editorTimer = setTimeout(function() {\r\n            var snippet = editor.querySelector('.jsnippet');\r\n            if (! snippet) {\r\n                var html = editor.innerHTML.replace(/\\n/g, ' ');\r\n                var container = document.createElement('div');\r\n                container.innerHTML = html;\r\n                var text = container.innerText; \r\n                var url = jSuites.editor.detectUrl(text);\r\n\r\n                if (url) {\r\n                    if (url[0].substr(-3) == 'jpg' || url[0].substr(-3) == 'png' || url[0].substr(-3) == 'gif') {\r\n                         obj.addImage(url[0], true);\r\n                    } else {\r\n                        var id = jSuites.editor.youtubeParser(url[0]);\r\n                        obj.parseWebsite(url[0], id);\r\n                    }\r\n                }\r\n            }\r\n        }, 1000);\r\n    }\r\n\r\n    obj.parseContent = function() {\r\n        verifyEditor();\r\n    }\r\n\r\n    obj.parseWebsite = function(url, youtubeId) {\r\n        if (! obj.options.remoteParser) {\r\n            console.log('The remoteParser is not defined');\r\n        } else {\r\n            // Youtube definitions\r\n            if (youtubeId) {\r\n                var url = 'https://www.youtube.com/watch?v=' + youtubeId;\r\n            }\r\n\r\n            var p = {\r\n                title: '',\r\n                description: '',\r\n                image: '',\r\n                host: url.split('/')[2],\r\n                url: url,\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.remoteParser + encodeURI(url.trim()),\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Get title\r\n                    if (result.title) {\r\n                        p.title = result.title;\r\n                    }\r\n                    // Description\r\n                    if (result.description) {\r\n                        p.description = result.description;\r\n                    }\r\n                    // Host\r\n                    if (result.host) {\r\n                        p.host = result.host;\r\n                    }\r\n                    // Url\r\n                    if (result.url) {\r\n                        p.url = result.url;\r\n                    }\r\n                    // Append snippet\r\n                    appendElement(p);\r\n                    // Add image\r\n                    if (result.image) {\r\n                        obj.addImage(result.image, true);\r\n                    } else if (result['og:image']) {\r\n                        obj.addImage(result['og:image'], true);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set editor value\r\n     */\r\n    obj.setData = function(html) {\r\n        editor.innerHTML = html;\r\n\r\n        if (obj.options.focus) {\r\n            jSuites.editor.setCursor(editor, true);\r\n        }\r\n\r\n        // Reset files container\r\n        files = [];\r\n    }\r\n\r\n    obj.getFiles = function() {\r\n        var f = editor.querySelectorAll('.jfile');\r\n        var d = [];\r\n        for (var i = 0; i < f.length; i++) {\r\n            if (files[f[i].src]) {\r\n                d.push(files[f[i].src]);\r\n            }\r\n        }\r\n        return d;\r\n    }\r\n\r\n    obj.getText = function() {\r\n        return editor.innerText;\r\n    }\r\n\r\n    /**\r\n     * Get editor data\r\n     */\r\n    obj.getData = function(json) {\r\n        if (! json) {\r\n            var data = editor.innerHTML;\r\n        } else {\r\n            var data = {\r\n                content : '',\r\n            }\r\n\r\n            // Get snippet\r\n            if (snippet.innerHTML) {\r\n                var index = 0;\r\n                data.snippet = {};\r\n                for (var i = 0; i < snippet.children.length; i++) {\r\n                    // Get key from element\r\n                    var key = snippet.children[i].getAttribute('data-k');\r\n                    if (key) {\r\n                        if (key == 'image') {\r\n                            if (! data.snippet.image) {\r\n                                data.snippet.image = [];\r\n                            }\r\n                            // Get all images\r\n                            for (var j = 0; j < snippet.children[i].children.length; j++) {\r\n                                data.snippet.image.push(snippet.children[i].children[j].getAttribute('src'))\r\n                            }\r\n                        } else {\r\n                            data.snippet[key] = snippet.children[i].innerHTML;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Get files\r\n            var f = Object.keys(files);\r\n            if (f.length) {\r\n                data.files = [];\r\n                for (var i = 0; i < f.length; i++) {\r\n                    data.files.push(files[f[i]]);\r\n                }\r\n            }\r\n\r\n            // Get content\r\n            var text = editor.innerHTML;\r\n            text = text.replace(/<br>/g, \"\\n\");\r\n            text = text.replace(/<\\/div>/g, \"<\\/div>\\n\");\r\n            text = text.replace(/<(?:.|\\n)*?>/gm, \"\");\r\n            data.content = text.trim();\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    // Reset\r\n    obj.reset = function() {\r\n        editor.innerHTML = '';\r\n        snippet.innerHTML = '';\r\n        files = [];\r\n    }\r\n\r\n    obj.addPdf = function(data) {\r\n        if (data.result.substr(0,4) != 'data') {\r\n            console.error('Invalid source');\r\n        } else {\r\n            var canvas = document.createElement('canvas');\r\n            canvas.width = 60;\r\n            canvas.height = 60;\r\n\r\n            var img = new Image();\r\n            var ctx = canvas.getContext('2d');\r\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n            canvas.toBlob(function(blob) {\r\n                var newImage = document.createElement('img');\r\n                newImage.src = window.URL.createObjectURL(blob);\r\n                newImage.title = data.name;\r\n                newImage.className = 'jfile pdf';\r\n\r\n                files[newImage.src] = {\r\n                    file: newImage.src,\r\n                    extension: 'pdf',\r\n                    content: data.result,\r\n                }\r\n\r\n                insertNodeAtCaret(newImage);\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.addImage = function(src, asSnippet) {\r\n        if (! src) {\r\n            src = '';\r\n        }\r\n\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                extension = extension[1];\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n            }\r\n\r\n            var img = new Image();\r\n\r\n            img.onload = function onload() {\r\n                var canvas = document.createElement('canvas');\r\n                canvas.width = img.width;\r\n                canvas.height = img.height;\r\n\r\n                var ctx = canvas.getContext('2d');\r\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                canvas.toBlob(function(blob) {\r\n                    var newImage = document.createElement('img');\r\n                    newImage.src = window.URL.createObjectURL(blob);\r\n                    newImage.classList.add('jfile');\r\n                    newImage.setAttribute('tabindex', '900');\r\n                    files[newImage.src] = {\r\n                        file: newImage.src,\r\n                        extension: extension,\r\n                        content: canvas.toDataURL(),\r\n                    }\r\n\r\n                    if (obj.options.dropAsSnippet || asSnippet) {\r\n                        appendImage(newImage);\r\n                        // Just to understand the attachment is part of a snippet\r\n                        files[newImage.src].snippet = true;\r\n                    } else {\r\n                        insertNodeAtCaret(newImage);\r\n                    }\r\n\r\n                    change();\r\n                });\r\n            };\r\n\r\n            img.src = src;\r\n        }\r\n    }\r\n\r\n    obj.addFile = function(files) {\r\n        var reader = [];\r\n\r\n        for (var i = 0; i < files.length; i++) {\r\n            if (files[i].size > obj.options.maxFileSize) {\r\n                alert('The file is too big');\r\n            } else {\r\n                // Only PDF or Images\r\n                var type = files[i].type.split('/');\r\n\r\n                if (type[0] == 'image') {\r\n                    type = 1;\r\n                } else if (type[1] == 'pdf') {\r\n                    type = 2;\r\n                } else {\r\n                    type = 0;\r\n                }\r\n\r\n                if (type) {\r\n                    // Create file\r\n                    reader[i] = new FileReader();\r\n                    reader[i].index = i;\r\n                    reader[i].type = type;\r\n                    reader[i].name = files[i].name;\r\n                    reader[i].date = files[i].lastModified;\r\n                    reader[i].size = files[i].size;\r\n                    reader[i].addEventListener(\"load\", function (data) {\r\n                        // Get result\r\n                        if (data.target.type == 2) {\r\n                            if (obj.options.acceptFiles == true) {\r\n                                obj.addPdf(data.target);\r\n                            }\r\n                        } else {\r\n                            obj.addImage(data.target.result);\r\n                        }\r\n                    }, false);\r\n\r\n                    reader[i].readAsDataURL(files[i])\r\n                } else {\r\n                    alert('The extension is not allowed');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Destroy\r\n    obj.destroy = function() {\r\n        editor.removeEventListener('mouseup', editorMouseUp);\r\n        editor.removeEventListener('mousedown', editorMouseDown);\r\n        editor.removeEventListener('mousemove', editorMouseMove);\r\n        editor.removeEventListener('keyup', editorKeyUp);\r\n        editor.removeEventListener('keydown', editorKeyDown);\r\n        editor.removeEventListener('dragstart', editorDragStart);\r\n        editor.removeEventListener('dragenter', editorDragEnter);\r\n        editor.removeEventListener('dragover', editorDragOver);\r\n        editor.removeEventListener('drop', editorDrop);\r\n        editor.removeEventListener('paste', editorPaste);\r\n\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            editor.removeEventListener('blur', editorBlur);\r\n        }\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            editor.removeEventListener('focus', editorFocus);\r\n        }\r\n\r\n        el.editor = null;\r\n        el.classList.remove('jeditor-container');\r\n\r\n        toolbar.remove();\r\n        snippet.remove();\r\n        editor.remove();\r\n    }\r\n\r\n    var isLetter = function (str) {\r\n        var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]+)/g;\r\n        return str.match(regex) ? 1 : 0;\r\n    }\r\n\r\n    // Event handlers\r\n    var editorMouseUp = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            editorAction.e.classList.remove('resizing');\r\n        }\r\n\r\n        editorAction = false;\r\n    }\r\n\r\n    var editorMouseDown = function(e) {\r\n        var close = function(snippet) {\r\n            var rect = snippet.getBoundingClientRect();\r\n            if (rect.width - (e.clientX - rect.left) < 40 && e.clientY - rect.top < 40) {\r\n                snippet.innerHTML = '';\r\n                snippet.remove();\r\n            }\r\n        }\r\n\r\n        if (e.target.tagName == 'IMG') {\r\n            if (e.target.style.cursor) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                editorAction = {\r\n                    e: e.target,\r\n                    x: e.clientX,\r\n                    y: e.clientY,\r\n                    w: rect.width,\r\n                    h: rect.height,\r\n                    d: e.target.style.cursor,\r\n                }\r\n\r\n                if (! e.target.width) {\r\n                    e.target.width = rect.width + 'px';\r\n                }\r\n\r\n                if (! e.target.height) {\r\n                    e.target.height = rect.height + 'px';\r\n                }\r\n\r\n                var s = window.getSelection();\r\n                if (s.rangeCount) {\r\n                    for (var i = 0; i < s.rangeCount; i++) {\r\n                        s.removeRange(s.getRangeAt(i));\r\n                    }\r\n                }\r\n\r\n                e.target.classList.add('resizing');\r\n            } else {\r\n                editorAction = true;\r\n            }\r\n        } else { \r\n            if (e.target.classList.contains('jsnippet')) {\r\n                close(e.target);\r\n            } else if (e.target.parentNode.classList.contains('jsnippet')) {\r\n                close(e.target.parentNode);\r\n            }\r\n\r\n            editorAction = true;\r\n        }\r\n    }\r\n\r\n    var editorMouseMove = function(e) {\r\n        if (e.target.tagName == 'IMG' && ! e.target.parentNode.classList.contains('jsnippet-image') && obj.options.allowImageResize == true) {\r\n            if (e.target.getAttribute('tabindex')) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                if (e.clientY - rect.top < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'ne-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'nw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 'n-resize';\r\n                    }\r\n                } else if (rect.height - (e.clientY - rect.top) < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'se-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'sw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 's-resize';\r\n                    }\r\n                } else if (rect.width - (e.clientX - rect.left) < 5) {\r\n                    e.target.style.cursor = 'e-resize';\r\n                } else if (e.clientX - rect.left < 5) {\r\n                    e.target.style.cursor = 'w-resize';\r\n                } else {\r\n                    e.target.style.cursor = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Move\r\n        if (e.which == 1 && editorAction && editorAction.d) {\r\n            if (editorAction.d == 'e-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'se-resize') {\r\n                editorAction.e.width = (editorAction.w + (e.clientX - editorAction.x));\r\n\r\n                if (e.shiftKey) {\r\n                    var newHeight = (e.clientX - editorAction.x) * (editorAction.h / editorAction.w);\r\n                    editorAction.e.height = editorAction.h + newHeight;\r\n                } else {\r\n                    var newHeight =  null;\r\n                }\r\n            }\r\n\r\n            if (! newHeight) {\r\n                if (editorAction.d == 's-resize' || editorAction.d == 'se-resize' || editorAction.d == 'sw-resize') {\r\n                    if (! e.shiftKey) {\r\n                        editorAction.e.height = editorAction.h + (e.clientY - editorAction.y);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    var editorKeyUp = function(e) {\r\n        if (! editor.innerHTML) {\r\n            editor.innerHTML = '<div><br></div>';\r\n        }\r\n\r\n        if (typeof(obj.options.onkeyup) == 'function') { \r\n            obj.options.onkeyup(el, obj, e);\r\n        }\r\n    }\r\n\r\n\r\n    var editorKeyDown = function(e) {\r\n        // Check for URL\r\n        if (obj.options.parseURL == true) {\r\n            verifyEditor();\r\n        }\r\n\r\n        if (typeof(obj.options.onkeydown) == 'function') { \r\n            obj.options.onkeydown(el, obj, e);\r\n        }\r\n\r\n        if (e.key == 'Delete') {\r\n            if (e.target.tagName == 'IMG' && e.target.parentNode.classList.contains('jsnippet-image')) {\r\n                e.target.remove();\r\n                updateTotalImages();\r\n            }\r\n        }\r\n    }\r\n\r\n    // Elements to be removed\r\n    var remove = [HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement];\r\n\r\n    // Valid properties\r\n    var validProperty = ['width', 'height', 'align', 'border', 'src', 'tabindex'];\r\n\r\n    // Valid CSS attributes\r\n    var validStyle = ['color', 'font-weight', 'font-size', 'background', 'background-color', 'margin'];\r\n\r\n    var parse = function(element) {\r\n       // Remove attributes\r\n       if (element.attributes && element.attributes.length) {\r\n           var image = null;\r\n           var style = null;\r\n           // Process style attribute\r\n           var elementStyle = element.getAttribute('style');\r\n           if (elementStyle) {\r\n               style = [];\r\n               var t = elementStyle.split(';');\r\n               for (var j = 0; j < t.length; j++) {\r\n                   var v = t[j].trim().split(':');\r\n                   if (validStyle.indexOf(v[0].trim()) >= 0) {\r\n                       var k = v.shift();\r\n                       var v = v.join(':');\r\n                       style.push(k + ':' + v);\r\n                   }\r\n               }\r\n           }\r\n           // Process image\r\n           if (element.tagName.toUpperCase() == 'IMG') {\r\n               if (! obj.options.acceptImages || ! element.src) {\r\n                   element.parentNode.removeChild(element);\r\n               } else {\r\n                   // Check if is data\r\n                   element.setAttribute('tabindex', '900');\r\n                   // Check attributes for persistance\r\n                   obj.addImage(element.src);\r\n               }\r\n           }\r\n           // Remove attributes\r\n           var attr = [];\r\n           var numAttributes = element.attributes.length - 1;\r\n           if (numAttributes > 0) {\r\n               for (var i = numAttributes; i >= 0 ; i--) {\r\n                   attr.push(element.attributes[i].name);\r\n               }\r\n               attr.forEach(function(v) {\r\n                   if (validProperty.indexOf(v) == -1) {\r\n                       element.removeAttribute(v);\r\n                   }\r\n               });\r\n           }\r\n           element.style = '';\r\n           // Add valid style\r\n           if (style && style.length) {\r\n               element.setAttribute('style', style.join(';'));\r\n           }\r\n       }\r\n       // Parse children\r\n       if (element.children.length) {\r\n           for (var i = 0; i < element.children.length; i++) {\r\n               parse(element.children[i]);\r\n           }\r\n       }\r\n\r\n       if (remove.indexOf(element.constructor) >= 0) {\r\n           element.remove();\r\n       }\r\n    }\r\n\r\n    var filter = function(data) {\r\n        if (data) {\r\n            data = data.replace(new RegExp('<!--(.*?)-->', 'gsi'), '');\r\n        }\r\n        var parser = new DOMParser();\r\n        var d = parser.parseFromString(data, \"text/html\");\r\n        parse(d);\r\n        var span = document.createElement('span');\r\n        span.innerHTML = d.firstChild.innerHTML;\r\n        return span;\r\n    } \r\n\r\n    var editorPaste = function(e) {\r\n        if (obj.options.filterPaste == true) {\r\n            if (e.clipboardData || e.originalEvent.clipboardData) {\r\n                var html = (e.originalEvent || e).clipboardData.getData('text/html');\r\n                var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n                var file = (e.originalEvent || e).clipboardData.files\r\n            } else if (window.clipboardData) {\r\n                var html = window.clipboardData.getData('Html');\r\n                var text = window.clipboardData.getData('Text');\r\n                var file = window.clipboardData.files\r\n            }\r\n\r\n            if (file.length) {\r\n                // Paste a image from the clipboard\r\n                obj.addFile(file);\r\n            } else {\r\n                if (! html) {\r\n                    html = text.split('\\r\\n');\r\n                    if (! e.target.innerText) {\r\n                        html.map(function(v) {\r\n                            var d = document.createElement('div');\r\n                            d.innerText = v;\r\n                            editor.appendChild(d);\r\n                        });\r\n                    } else {\r\n                        html = html.map(function(v) {\r\n                            return '<div>' + v + '</div>';\r\n                        });\r\n                        document.execCommand('insertHtml', false, html.join(''));\r\n                    }\r\n                } else {\r\n                    var d = filter(html);\r\n                    // Paste to the editor\r\n                    insertNodeAtCaret(d);\r\n                }\r\n            }\r\n\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragStart = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragEnter = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            el.classList.add('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragOver = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            if (editorTimer) {\r\n                clearTimeout(editorTimer);\r\n            }\r\n\r\n            editorTimer = setTimeout(function() {\r\n                el.classList.remove('jeditor-dragging');\r\n            }, 100);\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDrop = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            // Position caret on the drop\r\n            var range = null;\r\n            if (document.caretRangeFromPoint) {\r\n                range=document.caretRangeFromPoint(e.clientX, e.clientY);\r\n            } else if (e.rangeParent) {\r\n                range=document.createRange();\r\n                range.setStart(e.rangeParent,e.rangeOffset);\r\n            }\r\n            var sel = window.getSelection();\r\n            sel.removeAllRanges();\r\n            sel.addRange(range);\r\n            sel.anchorNode.parentNode.focus();\r\n\r\n            var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n            var text = (e.originalEvent || e).dataTransfer.getData('text/plain');\r\n            var file = (e.originalEvent || e).dataTransfer.files;\r\n    \r\n            if (file.length) {\r\n                obj.addFile(file);\r\n            } else if (text) {\r\n                extractImageFromHtml(html);\r\n            }\r\n\r\n            el.classList.remove('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorBlur = function(e) {\r\n        // Blur\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            obj.options.onblur(el, obj, e);\r\n        }\r\n\r\n        change(e);\r\n    }\r\n\r\n    var editorFocus = function(e) {\r\n        // Focus\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            obj.options.onfocus(el, obj, e);\r\n        }\r\n    }\r\n\r\n    editor.addEventListener('mouseup', editorMouseUp);\r\n    editor.addEventListener('mousedown', editorMouseDown);\r\n    editor.addEventListener('mousemove', editorMouseMove);\r\n    editor.addEventListener('keyup', editorKeyUp);\r\n    editor.addEventListener('keydown', editorKeyDown);\r\n    editor.addEventListener('dragstart', editorDragStart);\r\n    editor.addEventListener('dragenter', editorDragEnter);\r\n    editor.addEventListener('dragover', editorDragOver);\r\n    editor.addEventListener('drop', editorDrop);\r\n    editor.addEventListener('paste', editorPaste);\r\n    editor.addEventListener('focus', editorFocus);\r\n    editor.addEventListener('blur', editorBlur);\r\n\r\n    // Onload\r\n    if (typeof(obj.options.onload) == 'function') {\r\n        obj.options.onload(el, obj, editor);\r\n    }\r\n\r\n    // Set value to the editor\r\n    editor.innerHTML = value;\r\n\r\n    // Append editor to the containre\r\n    el.appendChild(editor);\r\n\r\n    // Snippet\r\n    if (obj.options.snippet) {\r\n        appendElement(obj.options.snippet);\r\n    }\r\n\r\n    // Default toolbar\r\n    if (obj.options.toolbar == null) {\r\n        obj.options.toolbar = jSuites.editor.getDefaultToolbar();\r\n    }\r\n\r\n    // Add toolbar\r\n    if (obj.options.toolbar) {\r\n        // Append to the DOM\r\n        el.appendChild(toolbar);\r\n        // Create toolbar\r\n        jSuites.toolbar(toolbar, {\r\n            container: true,\r\n            responsive: true,\r\n            items: obj.options.toolbar\r\n        });\r\n    }\r\n\r\n    // Focus to the editor\r\n    if (obj.options.focus) {\r\n        jSuites.editor.setCursor(editor, obj.options.focus == 'initial' ? true : false);\r\n    }\r\n\r\n    // Change method\r\n    el.change = obj.setData;\r\n\r\n    // Global generic value handler\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            // Data type\r\n            var o = el.getAttribute('data-html') === 'true' ? false : true;\r\n            return obj.getData(o);\r\n        } else {\r\n            obj.setData(val);\r\n        }\r\n    }\r\n\r\n    el.editor = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.editor.setCursor = function(element, first) {\r\n    element.focus();\r\n    document.execCommand('selectAll');\r\n    var sel = window.getSelection();\r\n    var range = sel.getRangeAt(0);\r\n    if (first == true) {\r\n        var node = range.startContainer;\r\n        var size = 0;\r\n    } else {\r\n        var node = range.endContainer;\r\n        var size = node.length;\r\n    }\r\n    range.setStart(node, size);\r\n    range.setEnd(node, size);\r\n    sel.removeAllRanges();\r\n    sel.addRange(range);\r\n}\r\n\r\njSuites.editor.getDomain = function(url) {\r\n    return url.replace('http://','').replace('https://','').replace('www.','').split(/[/?#]/)[0].split(/:/g)[0];\r\n}\r\n\r\njSuites.editor.detectUrl = function(text) {\r\n    var expression = /(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig;\r\n    var links = text.match(expression);\r\n\r\n    if (links) {\r\n        if (links[0].substr(0,3) == 'www') {\r\n            links[0] = 'http://' + links[0];\r\n        }\r\n    }\r\n\r\n    return links;\r\n}\r\n\r\njSuites.editor.youtubeParser = function(url) {\r\n    var regExp = /^.*((youtu.be\\/)|(v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#\\&\\?]*).*/;\r\n    var match = url.match(regExp);\r\n\r\n    return (match && match[7].length == 11) ? match[7] : false;\r\n}\r\n\r\njSuites.editor.getDefaultToolbar = function() { \r\n    return [\r\n        {\r\n            content: 'undo',\r\n            onclick: function() {\r\n                document.execCommand('undo');\r\n            }\r\n        },\r\n        {\r\n            content: 'redo',\r\n            onclick: function() {\r\n                document.execCommand('redo');\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_bold',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('bold');\r\n\r\n                if (document.queryCommandState(\"bold\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_italic',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('italic');\r\n\r\n                if (document.queryCommandState(\"italic\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_underline',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('underline');\r\n\r\n                if (document.queryCommandState(\"underline\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_list_bulleted',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_list_numbered',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertOrderedList');\r\n\r\n                if (document.queryCommandState(\"insertOrderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_increase',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('indent', true, null);\r\n\r\n                if (document.queryCommandState(\"indent\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_decrease',\r\n            onclick: function() {\r\n                document.execCommand('outdent');\r\n\r\n                if (document.queryCommandState(\"outdent\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }/*,\r\n        {\r\n            icon: ['format_align_left', 'format_align_right', 'format_align_center'],\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }\r\n        {\r\n            type:'select',\r\n            items: ['Verdana','Arial','Courier New'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            type:'select',\r\n            items: ['10px','12px','14px','16px','18px','20px','22px'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_left',\r\n            onclick: function() {\r\n                document.execCommand('JustifyLeft');\r\n\r\n                if (document.queryCommandState(\"JustifyLeft\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_center',\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_right',\r\n            onclick: function() {\r\n                document.execCommand('justifyRight');\r\n\r\n                if (document.queryCommandState(\"justifyRight\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_justify',\r\n            onclick: function() {\r\n                document.execCommand('justifyFull');\r\n\r\n                if (document.queryCommandState(\"justifyFull\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_list_bulleted',\r\n            onclick: function() {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }*/\r\n    ];\r\n}\r\n\r\n\r\njSuites.form = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: null,\r\n        message: 'Are you sure? There are unsaved information in your form',\r\n        ignore: false,\r\n        currentHash: null,\r\n        submitButton:null,\r\n        validations: null,\r\n        onbeforeload: null,\r\n        onload: null,\r\n        onbeforesave: null,\r\n        onsave: null,\r\n        onbeforeremove: null,\r\n        onremove: null,\r\n        onerror: function(el, message) {\r\n            jSuites.alert(message);\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Validations\r\n    if (! obj.options.validations) {\r\n        obj.options.validations = {};\r\n    }\r\n\r\n    // Submit Button\r\n    if (! obj.options.submitButton) {\r\n        obj.options.submitButton = el.querySelector('input[type=submit]');\r\n    }\r\n\r\n    if (obj.options.submitButton && obj.options.url) {\r\n        obj.options.submitButton.onclick = function() {\r\n            obj.save();\r\n        }\r\n    }\r\n\r\n    if (! obj.options.validations.email) {\r\n        obj.options.validations.email = jSuites.validations.email;\r\n    }\r\n\r\n    if (! obj.options.validations.length) {\r\n        obj.options.validations.length = jSuites.validations.length;\r\n    }\r\n\r\n    if (! obj.options.validations.required) {\r\n        obj.options.validations.required = jSuites.validations.required;\r\n    }\r\n\r\n    obj.setUrl = function(url) {\r\n        obj.options.url = url;\r\n    }\r\n\r\n    obj.load = function() {\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'json',\r\n            queue: true,\r\n            success: function(data) {\r\n                // Overwrite values from the backend\r\n                if (typeof(obj.options.onbeforeload) == 'function') {\r\n                    var ret = obj.options.onbeforeload(el, data);\r\n                    if (ret) {\r\n                        data = ret;\r\n                    }\r\n                }\r\n                // Apply values to the form\r\n                jSuites.form.setElements(el, data);\r\n                // Onload methods\r\n                if (typeof(obj.options.onload) == 'function') {\r\n                    obj.options.onload(el, data);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    obj.save = function() {\r\n        var test = obj.validate();\r\n\r\n        if (test) {\r\n            obj.options.onerror(el, test);\r\n        } else {\r\n            var data = jSuites.form.getElements(el, true);\r\n\r\n            if (typeof(obj.options.onbeforesave) == 'function') {\r\n                var data = obj.options.onbeforesave(el, data);\r\n\r\n                if (data === false) {\r\n                    return; \r\n                }\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                method: 'POST',\r\n                dataType: 'json',\r\n                data: data,\r\n                success: function(result) {\r\n                    if (typeof(obj.options.onsave) == 'function') {\r\n                        obj.options.onsave(el, data, result);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.remove = function() {\r\n        if (typeof(obj.options.onbeforeremove) == 'function') {\r\n            var ret = obj.options.onbeforeremove(el, obj);\r\n            if (ret === false) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'DELETE',\r\n            dataType: 'json',\r\n            success: function(result) {\r\n                if (typeof(obj.options.onremove) == 'function') {\r\n                    obj.options.onremove(el, obj, result);\r\n                }\r\n\r\n                obj.reset();\r\n            }\r\n        });\r\n    }\r\n\r\n    var addError = function(element) {\r\n        // Add error in the element\r\n        element.classList.add('error');\r\n        // Submit button\r\n        if (obj.options.submitButton) {\r\n            obj.options.submitButton.setAttribute('disabled', true);\r\n        }\r\n        // Return error message\r\n        var error = element.getAttribute('data-error') || 'There is an error in the form';\r\n        element.setAttribute('title', error);\r\n        return error;\r\n    }\r\n\r\n    var delError = function(element) {\r\n        var error = false;\r\n        // Remove class from this element\r\n        element.classList.remove('error');\r\n        element.removeAttribute('title');\r\n        // Get elements in the form\r\n        var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n        // Run all elements \r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (elements[i].getAttribute('data-validation')) {\r\n                if (elements[i].classList.contains('error')) {\r\n                    error = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (obj.options.submitButton) {\r\n            if (error) {\r\n                obj.options.submitButton.setAttribute('disabled', true);\r\n            } else {\r\n                obj.options.submitButton.removeAttribute('disabled');\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.validateElement = function(element) {\r\n        // Test results\r\n        var test = false;\r\n        // Value\r\n        var value = jSuites.form.getValue(element);\r\n        // Validation\r\n        var validation = element.getAttribute('data-validation');\r\n        // Parse\r\n        if (typeof(obj.options.validations[validation]) == 'function' && ! obj.options.validations[validation](value, element)) {\r\n            // Not passed in the test\r\n            test = addError(element);\r\n        } else {\r\n            if (element.classList.contains('error')) {\r\n                delError(element);\r\n            }\r\n        }\r\n\r\n        return test;\r\n    }\r\n\r\n    obj.reset = function() {\r\n        // Get elements in the form\r\n        var name = null;\r\n        var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n        // Run all elements \r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (name = elements[i].getAttribute('name')) {\r\n                if (elements[i].type == 'checkbox' || elements[i].type == 'radio') {\r\n                    elements[i].checked = false;\r\n                } else {\r\n                    if (typeof(elements[i].val) == 'function') {\r\n                        elements[i].val('');\r\n                    } else {\r\n                        elements[i].value = '';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Run form validation\r\n    obj.validate = function() {\r\n        var test = [];\r\n        // Get elements in the form\r\n        var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n        // Run all elements \r\n        for (var i = 0; i < elements.length; i++) {\r\n            // Required\r\n            if (elements[i].getAttribute('data-validation')) {\r\n                var res = obj.validateElement(elements[i]);\r\n                if (res) {\r\n                    test.push(res);\r\n                }\r\n            }\r\n        }\r\n        if (test.length > 0) {\r\n            return test.join('<br>');\r\n        } else {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    // Check the form\r\n    obj.getError = function() {\r\n        // Validation\r\n        return obj.validation() ? true : false;\r\n    }\r\n\r\n    // Return the form hash\r\n    obj.setHash = function() {\r\n        return obj.getHash(jSuites.form.getElements(el));\r\n    }\r\n\r\n    // Get the form hash\r\n    obj.getHash = function(str) {\r\n        var hash = 0, i, chr;\r\n\r\n        if (str.length === 0) {\r\n            return hash;\r\n        } else {\r\n            for (i = 0; i < str.length; i++) {\r\n              chr = str.charCodeAt(i);\r\n              hash = ((hash << 5) - hash) + chr;\r\n              hash |= 0;\r\n            }\r\n        }\r\n\r\n        return hash;\r\n    }\r\n\r\n    // Is there any change in the form since start tracking?\r\n    obj.isChanged = function() {\r\n        var hash = obj.setHash();\r\n        return (obj.options.currentHash != hash);\r\n    }\r\n\r\n    // Restart tracking\r\n    obj.resetTracker = function() {\r\n        obj.options.currentHash = obj.setHash();\r\n        obj.options.ignore = false;\r\n    }\r\n\r\n    // Ignore flag\r\n    obj.setIgnore = function(ignoreFlag) {\r\n        obj.options.ignore = ignoreFlag ? true : false;\r\n    }\r\n\r\n    // Start tracking in one second\r\n    setTimeout(function() {\r\n        obj.options.currentHash = obj.setHash();\r\n    }, 1000);\r\n\r\n    // Validations\r\n    el.addEventListener(\"keyup\", function(e) {\r\n        if (e.target.getAttribute('data-validation')) {\r\n            obj.validateElement(e.target);\r\n        }\r\n    });\r\n\r\n    // Alert\r\n    if (! jSuites.form.hasEvents) {\r\n        window.addEventListener(\"beforeunload\", function (e) {\r\n            if (obj.isChanged() && obj.options.ignore == false) {\r\n                var confirmationMessage =  obj.options.message? obj.options.message : \"\\o/\";\r\n\r\n                if (confirmationMessage) {\r\n                    if (typeof e == 'undefined') {\r\n                        e = window.event;\r\n                    }\r\n\r\n                    if (e) {\r\n                        e.returnValue = confirmationMessage;\r\n                    }\r\n\r\n                    return confirmationMessage;\r\n                } else {\r\n                    return void(0);\r\n                }\r\n            }\r\n        });\r\n\r\n        jSuites.form.hasEvents = true;\r\n    }\r\n\r\n    el.form = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n// Get value from one element\r\njSuites.form.getValue = function(element) {\r\n    var value = null;\r\n    if (element.type == 'checkbox') {\r\n        if (element.checked == true) {\r\n            value = element.value || true;\r\n        }\r\n    } else if (element.type == 'radio') {\r\n        if (element.checked == true) {\r\n            value = element.value;\r\n        }\r\n    } else if (element.tagName == 'select' && element.multiple == true) {\r\n        value = [];\r\n        var options = element.querySelectorAll(\"options[selected]\");\r\n        for (var j = 0; j < options.length; j++) {\r\n            value.push(options[j].value);\r\n        }\r\n    } else if (typeof(element.val) == 'function') {\r\n        value = element.val();\r\n    } else {\r\n        value = element.value || '';\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n// Get form elements\r\njSuites.form.getElements = function(el, asArray) {\r\n    var data = {};\r\n    var name = null;\r\n    var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n\r\n    for (var i = 0; i < elements.length; i++) {\r\n        if (name = elements[i].getAttribute('name')) {\r\n            data[name] = jSuites.form.getValue(elements[i]) || '';\r\n        }\r\n    }\r\n\r\n    return asArray == true ? data : JSON.stringify(data);\r\n}\r\n\r\n//Get form elements\r\njSuites.form.setElements = function(el, data) {\r\n    var name = null;\r\n    var value = null;\r\n    var elements = el.querySelectorAll(\"input, select, textarea, div[name]\");\r\n    for (var i = 0; i < elements.length; i++) {\r\n        // Attributes\r\n        var type = elements[i].getAttribute('type');\r\n        if (name = elements[i].getAttribute('name')) {\r\n            // Transform variable names in pathname\r\n            name = name.replace(new RegExp(/\\[(.*?)\\]/ig), '.$1');\r\n            value = null;\r\n            // Seach for the data in the path\r\n            if (name.match(/\\./)) {\r\n                var tmp = jSuites.path.call(data, name) || '';\r\n                if (typeof(tmp) !== 'undefined') {\r\n                    value = tmp;\r\n                }\r\n            } else {\r\n                if (typeof(data[name]) !== 'undefined') {\r\n                    value = data[name];\r\n                }\r\n            }\r\n            // Set the values\r\n            if (value !== null) {\r\n                if (type == 'checkbox' || type == 'radio') {\r\n                    elements[i].checked = value ? true : false;\r\n                } else {\r\n                    if (typeof (elements[i].val) == 'function') {\r\n                        elements[i].val(value);\r\n                    } else {\r\n                        elements[i].value = value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n// Legacy\r\njSuites.tracker = jSuites.form;\r\n\r\njSuites.focus = function(el) {\r\n    if (el.innerText.length) {\r\n        var range = document.createRange();\r\n        var sel = window.getSelection();\r\n        var node = el.childNodes[el.childNodes.length-1];\r\n        range.setStart(node, node.length)\r\n        range.collapse(true)\r\n        sel.removeAllRanges()\r\n        sel.addRange(range)\r\n        el.scrollLeft = el.scrollWidth;\r\n    }\r\n}\r\n\r\njSuites.isNumeric = (function (num) {\r\n    return !isNaN(num) && num !== null && num !== '';\r\n});\r\n\r\njSuites.guid = function() {\r\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n        var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\r\n        return v.toString(16);\r\n    });\r\n}\r\n\r\njSuites.getNode = function() {\r\n    var node = document.getSelection().anchorNode;\r\n    if (node) {\r\n        return (node.nodeType == 3 ? node.parentNode : node);\r\n    } else {\r\n        return null;\r\n    }\r\n}\r\n/**\r\n * Generate hash from a string\r\n */\r\njSuites.hash = function(str) {\r\n    var hash = 0, i, chr;\r\n\r\n    if (str.length === 0) {\r\n        return hash;\r\n    } else {\r\n        for (i = 0; i < str.length; i++) {\r\n            chr = str.charCodeAt(i);\r\n            if (chr > 32) {\r\n                hash = ((hash << 5) - hash) + chr;\r\n                hash |= 0;\r\n            }\r\n        }\r\n    }\r\n    return hash;\r\n}\r\n\r\n/**\r\n * Generate a random color\r\n */\r\njSuites.randomColor = function(h) {\r\n    var lum = -0.25;\r\n    var hex = String('#' + Math.random().toString(16).slice(2, 8).toUpperCase()).replace(/[^0-9a-f]/gi, '');\r\n    if (hex.length < 6) {\r\n        hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\r\n    }\r\n    var rgb = [], c, i;\r\n    for (i = 0; i < 3; i++) {\r\n        c = parseInt(hex.substr(i * 2, 2), 16);\r\n        c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);\r\n        rgb.push((\"00\" + c).substr(c.length));\r\n    }\r\n\r\n    // Return hex\r\n    if (h == true) {\r\n        return '#' + jSuites.two(rgb[0].toString(16)) + jSuites.two(rgb[1].toString(16)) + jSuites.two(rgb[2].toString(16));\r\n    }\r\n\r\n    return rgb;\r\n}\r\n\r\njSuites.getWindowWidth = function() {\r\n    var w = window,\r\n    d = document,\r\n    e = d.documentElement,\r\n    g = d.getElementsByTagName('body')[0],\r\n    x = w.innerWidth || e.clientWidth || g.clientWidth;\r\n    return x;\r\n}\r\n\r\njSuites.getWindowHeight = function() {\r\n    var w = window,\r\n    d = document,\r\n    e = d.documentElement,\r\n    g = d.getElementsByTagName('body')[0],\r\n    y = w.innerHeight|| e.clientHeight|| g.clientHeight;\r\n    return  y;\r\n}\r\n\r\njSuites.getPosition = function(e) {\r\n    if (e.changedTouches && e.changedTouches[0]) {\r\n        var x = e.changedTouches[0].pageX;\r\n        var y = e.changedTouches[0].pageY;\r\n    } else {\r\n        var x = (window.Event) ? e.pageX : e.clientX + (document.documentElement.scrollLeft ? document.documentElement.scrollLeft : document.body.scrollLeft);\r\n        var y = (window.Event) ? e.pageY : e.clientY + (document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop);\r\n    }\r\n\r\n    return [ x, y ];\r\n}\r\n\r\njSuites.click = function(el) {\r\n    if (el.click) {\r\n        el.click();\r\n    } else {\r\n        var evt = new MouseEvent('click', {\r\n            bubbles: true,\r\n            cancelable: true,\r\n            view: window\r\n        });\r\n        el.dispatchEvent(evt);\r\n    }\r\n}\r\n\r\njSuites.findElement = function(element, condition) {\r\n    var foundElement = false;\r\n\r\n    function path (element) {\r\n        if (element && ! foundElement) {\r\n            if (typeof(condition) == 'function') {\r\n                foundElement = condition(element)\r\n            } else if (typeof(condition) == 'string') {\r\n                if (element.classList && element.classList.contains(condition)) {\r\n                    foundElement = element;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (element.parentNode && ! foundElement) {\r\n            path(element.parentNode);\r\n        }\r\n    }\r\n\r\n    path(element);\r\n\r\n    return foundElement;\r\n}\r\n\r\n// Two digits\r\njSuites.two = function(value) {\r\n    value = '' + value;\r\n    if (value.length == 1) {\r\n        value = '0' + value;\r\n    }\r\n    return value;\r\n}\r\n\r\njSuites.sha512 = (function(str) {\r\n    function int64(msint_32, lsint_32) {\r\n        this.highOrder = msint_32;\r\n        this.lowOrder = lsint_32;\r\n    }\r\n\r\n    var H = [new int64(0x6a09e667, 0xf3bcc908), new int64(0xbb67ae85, 0x84caa73b),\r\n        new int64(0x3c6ef372, 0xfe94f82b), new int64(0xa54ff53a, 0x5f1d36f1),\r\n        new int64(0x510e527f, 0xade682d1), new int64(0x9b05688c, 0x2b3e6c1f),\r\n        new int64(0x1f83d9ab, 0xfb41bd6b), new int64(0x5be0cd19, 0x137e2179)];\r\n\r\n    var K = [new int64(0x428a2f98, 0xd728ae22), new int64(0x71374491, 0x23ef65cd),\r\n        new int64(0xb5c0fbcf, 0xec4d3b2f), new int64(0xe9b5dba5, 0x8189dbbc),\r\n        new int64(0x3956c25b, 0xf348b538), new int64(0x59f111f1, 0xb605d019),\r\n        new int64(0x923f82a4, 0xaf194f9b), new int64(0xab1c5ed5, 0xda6d8118),\r\n        new int64(0xd807aa98, 0xa3030242), new int64(0x12835b01, 0x45706fbe),\r\n        new int64(0x243185be, 0x4ee4b28c), new int64(0x550c7dc3, 0xd5ffb4e2),\r\n        new int64(0x72be5d74, 0xf27b896f), new int64(0x80deb1fe, 0x3b1696b1),\r\n        new int64(0x9bdc06a7, 0x25c71235), new int64(0xc19bf174, 0xcf692694),\r\n        new int64(0xe49b69c1, 0x9ef14ad2), new int64(0xefbe4786, 0x384f25e3),\r\n        new int64(0x0fc19dc6, 0x8b8cd5b5), new int64(0x240ca1cc, 0x77ac9c65),\r\n        new int64(0x2de92c6f, 0x592b0275), new int64(0x4a7484aa, 0x6ea6e483),\r\n        new int64(0x5cb0a9dc, 0xbd41fbd4), new int64(0x76f988da, 0x831153b5),\r\n        new int64(0x983e5152, 0xee66dfab), new int64(0xa831c66d, 0x2db43210),\r\n        new int64(0xb00327c8, 0x98fb213f), new int64(0xbf597fc7, 0xbeef0ee4),\r\n        new int64(0xc6e00bf3, 0x3da88fc2), new int64(0xd5a79147, 0x930aa725),\r\n        new int64(0x06ca6351, 0xe003826f), new int64(0x14292967, 0x0a0e6e70),\r\n        new int64(0x27b70a85, 0x46d22ffc), new int64(0x2e1b2138, 0x5c26c926),\r\n        new int64(0x4d2c6dfc, 0x5ac42aed), new int64(0x53380d13, 0x9d95b3df),\r\n        new int64(0x650a7354, 0x8baf63de), new int64(0x766a0abb, 0x3c77b2a8),\r\n        new int64(0x81c2c92e, 0x47edaee6), new int64(0x92722c85, 0x1482353b),\r\n        new int64(0xa2bfe8a1, 0x4cf10364), new int64(0xa81a664b, 0xbc423001),\r\n        new int64(0xc24b8b70, 0xd0f89791), new int64(0xc76c51a3, 0x0654be30),\r\n        new int64(0xd192e819, 0xd6ef5218), new int64(0xd6990624, 0x5565a910),\r\n        new int64(0xf40e3585, 0x5771202a), new int64(0x106aa070, 0x32bbd1b8),\r\n        new int64(0x19a4c116, 0xb8d2d0c8), new int64(0x1e376c08, 0x5141ab53),\r\n        new int64(0x2748774c, 0xdf8eeb99), new int64(0x34b0bcb5, 0xe19b48a8),\r\n        new int64(0x391c0cb3, 0xc5c95a63), new int64(0x4ed8aa4a, 0xe3418acb),\r\n        new int64(0x5b9cca4f, 0x7763e373), new int64(0x682e6ff3, 0xd6b2b8a3),\r\n        new int64(0x748f82ee, 0x5defb2fc), new int64(0x78a5636f, 0x43172f60),\r\n        new int64(0x84c87814, 0xa1f0ab72), new int64(0x8cc70208, 0x1a6439ec),\r\n        new int64(0x90befffa, 0x23631e28), new int64(0xa4506ceb, 0xde82bde9),\r\n        new int64(0xbef9a3f7, 0xb2c67915), new int64(0xc67178f2, 0xe372532b),\r\n        new int64(0xca273ece, 0xea26619c), new int64(0xd186b8c7, 0x21c0c207),\r\n        new int64(0xeada7dd6, 0xcde0eb1e), new int64(0xf57d4f7f, 0xee6ed178),\r\n        new int64(0x06f067aa, 0x72176fba), new int64(0x0a637dc5, 0xa2c898a6),\r\n        new int64(0x113f9804, 0xbef90dae), new int64(0x1b710b35, 0x131c471b),\r\n        new int64(0x28db77f5, 0x23047d84), new int64(0x32caab7b, 0x40c72493),\r\n        new int64(0x3c9ebe0a, 0x15c9bebc), new int64(0x431d67c4, 0x9c100d4c),\r\n        new int64(0x4cc5d4be, 0xcb3e42b6), new int64(0x597f299c, 0xfc657e2a),\r\n        new int64(0x5fcb6fab, 0x3ad6faec), new int64(0x6c44198c, 0x4a475817)];\r\n\r\n    var W = new Array(64);\r\n    var a, b, c, d, e, f, g, h, i, j;\r\n    var T1, T2;\r\n    var charsize = 8;\r\n\r\n    function utf8_encode(str) {\r\n        return unescape(encodeURIComponent(str));\r\n    }\r\n\r\n    function str2binb(str) {\r\n        var bin = [];\r\n        var mask = (1 << charsize) - 1;\r\n        var len = str.length * charsize;\r\n    \r\n        for (var i = 0; i < len; i += charsize) {\r\n            bin[i >> 5] |= (str.charCodeAt(i / charsize) & mask) << (32 - charsize - (i % 32));\r\n        }\r\n    \r\n        return bin;\r\n    }\r\n\r\n    function binb2hex(binarray) {\r\n        var hex_tab = \"0123456789abcdef\";\r\n        var str = \"\";\r\n        var length = binarray.length * 4;\r\n        var srcByte;\r\n\r\n        for (var i = 0; i < length; i += 1) {\r\n            srcByte = binarray[i >> 2] >> ((3 - (i % 4)) * 8);\r\n            str += hex_tab.charAt((srcByte >> 4) & 0xF) + hex_tab.charAt(srcByte & 0xF);\r\n        }\r\n\r\n        return str;\r\n    }\r\n\r\n    function safe_add_2(x, y) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (x.lowOrder & 0xFFFF) + (y.lowOrder & 0xFFFF);\r\n        msw = (x.lowOrder >>> 16) + (y.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (x.highOrder & 0xFFFF) + (y.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (x.highOrder >>> 16) + (y.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function safe_add_4(a, b, c, d) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF);\r\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function safe_add_5(a, b, c, d, e) {\r\n        var lsw, msw, lowOrder, highOrder;\r\n\r\n        lsw = (a.lowOrder & 0xFFFF) + (b.lowOrder & 0xFFFF) + (c.lowOrder & 0xFFFF) + (d.lowOrder & 0xFFFF) + (e.lowOrder & 0xFFFF);\r\n        msw = (a.lowOrder >>> 16) + (b.lowOrder >>> 16) + (c.lowOrder >>> 16) + (d.lowOrder >>> 16) + (e.lowOrder >>> 16) + (lsw >>> 16);\r\n        lowOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        lsw = (a.highOrder & 0xFFFF) + (b.highOrder & 0xFFFF) + (c.highOrder & 0xFFFF) + (d.highOrder & 0xFFFF) + (e.highOrder & 0xFFFF) + (msw >>> 16);\r\n        msw = (a.highOrder >>> 16) + (b.highOrder >>> 16) + (c.highOrder >>> 16) + (d.highOrder >>> 16) + (e.highOrder >>> 16) + (lsw >>> 16);\r\n        highOrder = ((msw & 0xFFFF) << 16) | (lsw & 0xFFFF);\r\n\r\n        return new int64(highOrder, lowOrder);\r\n    }\r\n\r\n    function maj(x, y, z) {\r\n        return new int64(\r\n            (x.highOrder & y.highOrder) ^ (x.highOrder & z.highOrder) ^ (y.highOrder & z.highOrder),\r\n            (x.lowOrder & y.lowOrder) ^ (x.lowOrder & z.lowOrder) ^ (y.lowOrder & z.lowOrder)\r\n        );\r\n    }\r\n\r\n    function ch(x, y, z) {\r\n        return new int64(\r\n            (x.highOrder & y.highOrder) ^ (~x.highOrder & z.highOrder),\r\n            (x.lowOrder & y.lowOrder) ^ (~x.lowOrder & z.lowOrder)\r\n        );\r\n    }\r\n\r\n    function rotr(x, n) {\r\n        if (n <= 32) {\r\n            return new int64(\r\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n)),\r\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n))\r\n            );\r\n        } else {\r\n            return new int64(\r\n             (x.lowOrder >>> n) | (x.highOrder << (32 - n)),\r\n             (x.highOrder >>> n) | (x.lowOrder << (32 - n))\r\n            );\r\n        }\r\n    }\r\n\r\n    function sigma0(x) {\r\n        var rotr28 = rotr(x, 28);\r\n        var rotr34 = rotr(x, 34);\r\n        var rotr39 = rotr(x, 39);\r\n\r\n        return new int64(\r\n            rotr28.highOrder ^ rotr34.highOrder ^ rotr39.highOrder,\r\n            rotr28.lowOrder ^ rotr34.lowOrder ^ rotr39.lowOrder\r\n        );\r\n    }\r\n\r\n    function sigma1(x) {\r\n        var rotr14 = rotr(x, 14);\r\n        var rotr18 = rotr(x, 18);\r\n        var rotr41 = rotr(x, 41);\r\n\r\n        return new int64(\r\n            rotr14.highOrder ^ rotr18.highOrder ^ rotr41.highOrder,\r\n            rotr14.lowOrder ^ rotr18.lowOrder ^ rotr41.lowOrder\r\n        );\r\n    }\r\n\r\n    function gamma0(x) {\r\n        var rotr1 = rotr(x, 1), rotr8 = rotr(x, 8), shr7 = shr(x, 7);\r\n\r\n        return new int64(\r\n            rotr1.highOrder ^ rotr8.highOrder ^ shr7.highOrder,\r\n            rotr1.lowOrder ^ rotr8.lowOrder ^ shr7.lowOrder\r\n        );\r\n    }\r\n\r\n    function gamma1(x) {\r\n        var rotr19 = rotr(x, 19);\r\n        var rotr61 = rotr(x, 61);\r\n        var shr6 = shr(x, 6);\r\n\r\n        return new int64(\r\n            rotr19.highOrder ^ rotr61.highOrder ^ shr6.highOrder,\r\n            rotr19.lowOrder ^ rotr61.lowOrder ^ shr6.lowOrder\r\n        );\r\n    }\r\n\r\n    function shr(x, n) {\r\n        if (n <= 32) {\r\n            return new int64(\r\n                x.highOrder >>> n,\r\n                x.lowOrder >>> n | (x.highOrder << (32 - n))\r\n            );\r\n        } else {\r\n            return new int64(\r\n                0,\r\n                x.highOrder << (32 - n)\r\n            );\r\n        }\r\n    }\r\n\r\n    var str = utf8_encode(str);\r\n    var strlen = str.length*charsize;\r\n    str = str2binb(str);\r\n\r\n    str[strlen >> 5] |= 0x80 << (24 - strlen % 32);\r\n    str[(((strlen + 128) >> 10) << 5) + 31] = strlen;\r\n\r\n    for (var i = 0; i < str.length; i += 32) {\r\n        a = H[0];\r\n        b = H[1];\r\n        c = H[2];\r\n        d = H[3];\r\n        e = H[4];\r\n        f = H[5];\r\n        g = H[6];\r\n        h = H[7];\r\n\r\n        for (var j = 0; j < 80; j++) {\r\n            if (j < 16) {\r\n                W[j] = new int64(str[j*2 + i], str[j*2 + i + 1]);\r\n            } else {\r\n                W[j] = safe_add_4(gamma1(W[j - 2]), W[j - 7], gamma0(W[j - 15]), W[j - 16]);\r\n            }\r\n\r\n            T1 = safe_add_5(h, sigma1(e), ch(e, f, g), K[j], W[j]);\r\n            T2 = safe_add_2(sigma0(a), maj(a, b, c));\r\n            h = g;\r\n            g = f;\r\n            f = e;\r\n            e = safe_add_2(d, T1);\r\n            d = c;\r\n            c = b;\r\n            b = a;\r\n            a = safe_add_2(T1, T2);\r\n        }\r\n\r\n        H[0] = safe_add_2(a, H[0]);\r\n        H[1] = safe_add_2(b, H[1]);\r\n        H[2] = safe_add_2(c, H[2]);\r\n        H[3] = safe_add_2(d, H[3]);\r\n        H[4] = safe_add_2(e, H[4]);\r\n        H[5] = safe_add_2(f, H[5]);\r\n        H[6] = safe_add_2(g, H[6]);\r\n        H[7] = safe_add_2(h, H[7]);\r\n    }\r\n\r\n    var binarray = [];\r\n    for (var i = 0; i < H.length; i++) {\r\n        binarray.push(H[i].highOrder);\r\n        binarray.push(H[i].lowOrder);\r\n    }\r\n\r\n    return binb2hex(binarray);\r\n});\r\n\r\nif (! jSuites.login) {\r\n    jSuites.login = {};\r\n    jSuites.login.sha512 = jSuites.sha512;\r\n}\r\n\r\njSuites.image = jSuites.upload = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        type: 'image',\r\n        extension: '*',\r\n        input: false,\r\n        minWidth: false,\r\n        maxWidth: null,\r\n        maxHeight: null,\r\n        maxJpegSizeBytes: null, // For example, 350Kb would be 350000\r\n        onchange: null,\r\n        multiple: false,\r\n        remoteParser: null,\r\n        text:{\r\n            extensionNotAllowed:'The extension is not allowed',\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Multiple\r\n    if (obj.options.multiple == true) {\r\n        el.setAttribute('data-multiple', true);\r\n    }\r\n\r\n    // Container\r\n    el.content = [];\r\n\r\n    // Upload icon\r\n    el.classList.add('jupload');\r\n\r\n    if (obj.options.input == true) {\r\n        el.classList.add('input');\r\n    }\r\n\r\n    obj.add = function(data) {\r\n        // Reset container for single files\r\n        if (obj.options.multiple == false) {\r\n            el.content = [];\r\n            el.innerText = '';\r\n        }\r\n\r\n        // Append to the element\r\n        if (obj.options.type == 'image') {\r\n            var img = document.createElement('img');\r\n            img.setAttribute('src', data.file);\r\n            img.setAttribute('tabindex', -1);\r\n            if (! el.getAttribute('name')) {\r\n                img.className = 'jfile';\r\n                img.content = data;\r\n            }\r\n            el.appendChild(img);\r\n        } else {\r\n            if (data.name) {\r\n                var name = data.name;\r\n            } else {\r\n                var name = data.file;\r\n            }\r\n            var div = document.createElement('div');\r\n            div.innerText = name || obj.options.type;\r\n            div.classList.add('jupload-item');\r\n            div.setAttribute('tabindex', -1);\r\n            el.appendChild(div);\r\n        }\r\n\r\n        if (data.content) {\r\n            data.file = jSuites.guid();\r\n        }\r\n\r\n        // Push content\r\n        el.content.push(data);\r\n\r\n        // Onchange\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, data);\r\n        }\r\n    }\r\n\r\n    obj.addFromFile = function(file) {\r\n        var type = file.type.split('/');\r\n        if (type[0] == obj.options.type) {\r\n            var readFile = new FileReader();\r\n            readFile.addEventListener(\"load\", function (v) {\r\n                var data = {\r\n                    file: v.srcElement.result,\r\n                    extension: file.name.substr(file.name.lastIndexOf('.') + 1),\r\n                    name: file.name,\r\n                    size: file.size,\r\n                    lastmodified: file.lastModified,\r\n                    content: v.srcElement.result,\r\n                }\r\n\r\n                obj.add(data);\r\n            });\r\n\r\n            readFile.readAsDataURL(file);\r\n        } else {\r\n            alert(obj.options.text.extensionNotAllowed);\r\n        }\r\n    }\r\n\r\n    obj.addFromUrl = function(src) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                var type = extension[0].replace('data:','');\r\n                if (type == obj.options.type) {\r\n                    var data = {\r\n                        file: src,\r\n                        name: '',\r\n                        extension: extension[1],\r\n                        content: src,\r\n                    }\r\n                    obj.add(data);\r\n                } else {\r\n                    alert(obj.options.text.extensionNotAllowed);\r\n                }\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n                // Get remove content\r\n                jSuites.ajax({\r\n                    url: src,\r\n                    type: 'GET',\r\n                    dataType: 'blob',\r\n                    success: function(data) {\r\n                        //add(extension[0].replace('data:',''), data);\r\n                    }\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n    var getDataURL = function(canvas, type) {\r\n        var compression = 0.92;\r\n        var lastContentLength = null;\r\n        var content = canvas.toDataURL(type, compression);\r\n        while (obj.options.maxJpegSizeBytes && type === 'image/jpeg' &&\r\n               content.length > obj.options.maxJpegSizeBytes && content.length !== lastContentLength) {\r\n            // Apply the compression\r\n            compression *= 0.9;\r\n            lastContentLength = content.length;\r\n            content = canvas.toDataURL(type, compression);\r\n        }\r\n        return content;\r\n    }\r\n\r\n    var mime = obj.options.type + '/' + obj.options.extension;\r\n    var input = document.createElement('input');\r\n    input.type = 'file';\r\n    input.setAttribute('accept', mime);\r\n    input.onchange = function() {\r\n        for (var i = 0; i < this.files.length; i++) {\r\n            obj.addFromFile(this.files[i]);\r\n        }\r\n    }\r\n\r\n    // Allow multiple files\r\n    if (obj.options.multiple == true) {\r\n        input.setAttribute('multiple', true);\r\n    }\r\n\r\n    var current = null;\r\n\r\n    el.addEventListener(\"click\", function(e) {\r\n        current = null;\r\n        if (! el.children.length || e.target === el) {\r\n            jSuites.click(input);\r\n        } else {\r\n            if (e.target.parentNode == el) {\r\n                current = e.target;\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener(\"dblclick\", function(e) {\r\n        jSuites.click(input);\r\n    });\r\n\r\n    el.addEventListener('dragenter', function(e) {\r\n        el.style.border = '1px dashed #000';\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragstop', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('keydown', function(e) {\r\n        if (current && e.which == 46) {\r\n            var index = Array.prototype.indexOf.call(el.children, current);\r\n            if (index >= 0) {\r\n                el.content.splice(index, 1);\r\n                current.remove();\r\n                current = null;\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();  \r\n        e.stopPropagation();\r\n\r\n        var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n        var file = (e.originalEvent || e).dataTransfer.files;\r\n\r\n        if (file.length) {\r\n            for (var i = 0; i < e.dataTransfer.files.length; i++) {\r\n                obj.addFromFile(e.dataTransfer.files[i]);\r\n            }\r\n        } else if (html) {\r\n            if (obj.options.multiple == false) {\r\n                el.innerText = '';\r\n            }\r\n\r\n            // Create temp element\r\n            var div = document.createElement('div');\r\n            div.innerHTML = html;\r\n\r\n            // Extract images\r\n            var img = div.querySelectorAll('img');\r\n\r\n            if (img.length) {\r\n                for (var i = 0; i < img.length; i++) {\r\n                    obj.addFromUrl(img[i].src);\r\n                }\r\n            }\r\n        }\r\n\r\n        el.style.border = '1px solid #eee';\r\n\r\n        return false;\r\n    });\r\n\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            return el.content && el.content.length ? el.content : null;\r\n        } else {\r\n            // Reset\r\n            el.innerText = '';\r\n            el.content = [];\r\n\r\n            if (val) {\r\n                if (Array.isArray(val)) {\r\n                    for (var i = 0; i < val.length; i++) {\r\n                        if (typeof(val[i]) == 'string') {\r\n                            obj.add({ file: val[i] });\r\n                        } else {\r\n                            obj.add(val[i]);\r\n                        }\r\n                    }\r\n                } else if (typeof(val) == 'string') {\r\n                    obj.add({ file: val });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    el.upload = el.image = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.image.create = function(data) {\r\n    var img = document.createElement('img');\r\n    img.setAttribute('src', data.file);\r\n    img.className = 'jfile';\r\n    img.setAttribute('tabindex', -1);\r\n    img.content = data;\r\n\r\n    return img;\r\n}\r\n\r\n\r\njSuites.lazyLoading = (function(el, options) {\r\n    var obj = {}\r\n\r\n    // Mandatory options\r\n    if (! options.loadUp || typeof(options.loadUp) != 'function') {\r\n        options.loadUp = function() {\r\n            return false;\r\n        }\r\n    }\r\n    if (! options.loadDown || typeof(options.loadDown) != 'function') {\r\n        options.loadDown = function() {\r\n            return false;\r\n        }\r\n    }\r\n    // Timer ms\r\n    if (! options.timer) {\r\n        options.timer = 100;\r\n    }\r\n\r\n    // Timer\r\n    var timeControlLoading = null;\r\n\r\n    // Controls\r\n    var scrollControls = function(e) {\r\n        if (timeControlLoading == null) {\r\n            var event = false;\r\n            var scrollTop = el.scrollTop;\r\n            if (el.scrollTop + (el.clientHeight * 2) >= el.scrollHeight) {\r\n                if (options.loadDown()) {\r\n                    if (scrollTop == el.scrollTop) {\r\n                        el.scrollTop = el.scrollTop - (el.clientHeight);\r\n                    }\r\n                    event = true;\r\n                }\r\n            } else if (el.scrollTop <= el.clientHeight) {\r\n                if (options.loadUp()) {\r\n                    if (scrollTop == el.scrollTop) {\r\n                        el.scrollTop = el.scrollTop + (el.clientHeight);\r\n                    }\r\n                    event = true;\r\n                }\r\n            }\r\n\r\n            timeControlLoading = setTimeout(function() {\r\n                timeControlLoading = null;\r\n            }, options.timer);\r\n\r\n            if (event) {\r\n                if (typeof(options.onupdate) == 'function') {\r\n                    options.onupdate();\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Onscroll\r\n    el.onscroll = function(e) {\r\n        scrollControls(e);\r\n    }\r\n\r\n    el.onwheel = function(e) {\r\n        scrollControls(e);\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.loading = (function() {\r\n    var obj = {};\r\n\r\n    var loading = null;\r\n\r\n    obj.show = function() {\r\n        if (! loading) {\r\n            loading = document.createElement('div');\r\n            loading.className = 'jloading';\r\n        }\r\n        document.body.appendChild(loading);\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (loading && loading.parentNode) {\r\n            document.body.removeChild(loading);\r\n        }\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.mask = (function() {\r\n    // Currency \r\n    var tokens = {\r\n        // Currency tokens\r\n        currency: [ '#(.{1})##0?(.{1}0+)?( ?;(.*)?)?', '#' ],\r\n        // Percentage\r\n        percentage: [ '0{1}(.{1}0+)?%' ],\r\n        // Number\r\n        numeric: [ '0{1}(.{1}0+)?' ],\r\n        // Data tokens\r\n        datetime: [ 'YYYY', 'YYY', 'YY', 'MMMMM', 'MMMM', 'MMM', 'MM', 'DDDDD', 'DDDD', 'DDD', 'DD', 'DY', 'DAY', 'WD', 'D', 'Q', 'HH24', 'HH12', 'HH', '\\\\[H\\\\]', 'H', 'AM/PM', 'PM', 'AM', 'MI', 'SS', 'MS', 'MONTH', 'MON', 'Y', 'M' ],\r\n        // Other\r\n        general: [ 'A', '0', '[0-9a-zA-Z\\$]+', '.']\r\n    }\r\n\r\n    var getDate = function() {\r\n        if (this.mask.toLowerCase().indexOf('[h]') !== -1) {\r\n            var m = 0;\r\n            if (this.date[4]) {\r\n                m = parseFloat(this.date[4] / 60);\r\n            }\r\n            var v = parseInt(this.date[3]) + m;\r\n            v /= 24;\r\n        } else if (! (this.date[0] && this.date[1] && this.date[2]) && (this.date[3] || this.date[4])) {\r\n            v = jSuites.two(this.date[3]) + ':' + jSuites.two(this.date[4]) + ':' + jSuites.two(this.date[5]) \r\n        } else {\r\n            if (this.date[0] && this.date[1] && ! this.date[2]) {\r\n                this.date[2] = 1;\r\n            }\r\n            v = jSuites.two(this.date[0]) + '-' + jSuites.two(this.date[1]) + '-' + jSuites.two(this.date[2]);\r\n\r\n            if (this.date[3] || this.date[4] || this.date[5]) {\r\n                v += ' ' + jSuites.two(this.date[3]) + ':' + jSuites.two(this.date[4]) + ':' + jSuites.two(this.date[5]);\r\n            }\r\n        }\r\n\r\n        return v;\r\n    }\r\n\r\n    var isBlank = function(v) {\r\n        return v === null || v === '' || v === undefined ? true : false;\r\n    }\r\n\r\n    var isFormula = function(value) {\r\n        return (''+value).chartAt(0) == '=';\r\n    }\r\n\r\n    var isNumeric = function(t) {\r\n        return t === 'currency' || t === 'percentage' || t === 'numeric' ? true : false;\r\n    }\r\n    /**\r\n     * Get the decimal defined in the mask configuration\r\n     */\r\n    var getDecimal = function(v) {\r\n        if (v && Number(v) == v) {\r\n            return '.';\r\n        } else {\r\n            if (this.options.decimal) {\r\n                return this.options.decimal;\r\n            } else {\r\n                if (this.locale) {\r\n                    var t = Intl.NumberFormat(this.locale).format(1.1);\r\n                    return this.options.decimal = t[1];\r\n                } else {\r\n                    if (! v) {\r\n                        v  = this.mask;\r\n                    }\r\n                    var e = new RegExp('0{1}(.{1})0+', 'ig');\r\n                    var t = e.exec(v);\r\n                    if (t && t[1] && t[1].length == 1) {\r\n                        // Save decimal\r\n                        this.options.decimal = t[1];\r\n                        // Return decimal\r\n                        return t[1];\r\n                    } else {\r\n                        // Did not find any decimal last resort the default\r\n                        var e = new RegExp('#,##', 'ig');\r\n                        if ((v && v.match(e)) || '1.1'.toLocaleString().substring(1,2) == '.') {\r\n                            this.options.decimal = '.';\r\n                        } else {\r\n                            this.options.decimal = ',';\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this.options.decimal) {\r\n            return this.options.decimal;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n\r\n    var ParseValue = function(v, decimal) {\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n\r\n        // Get decimal\r\n        if (! decimal) {\r\n            decimal = getDecimal.call(this);\r\n        }\r\n\r\n        // New value\r\n        v = (''+v).split(decimal);\r\n        v[0] = v[0].match(/[\\-0-9]+/g, '');\r\n        if (v[0]) {\r\n            v[0] = v[0].join('');\r\n        }\r\n        if (v[0] || v[1]) {\r\n            if (v[1] !== undefined) {\r\n                v[1] = v[1].match(/[0-9]+/g, '');\r\n                if (v[1]) {\r\n                    v[1] = v[1].join('');\r\n                } else {\r\n                    v[1] = '';\r\n                }\r\n            }\r\n        } else {\r\n            return '';\r\n        }\r\n\r\n        return v;\r\n    }\r\n\r\n    var FormatValue = function(v) {\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n        // Get decimal\r\n        var d = getDecimal.call(this);\r\n        // Convert value\r\n        var o = Object.create(this.options || {});\r\n        if (! o.minimumFractionDigits) {\r\n            o.minimumFractionDigits = 1;\r\n        }\r\n        // Parse value\r\n        v = ParseValue.call(this, v);\r\n        if (v == '') {\r\n            return '';\r\n        }\r\n        // Temporary value\r\n        if (v[0]) {\r\n            var t = parseFloat(v.join('.'));\r\n            if (o.style == 'percent') {\r\n                t /= 100;\r\n            }\r\n        } else {\r\n            var t = null;\r\n        }\r\n        var n = new Intl.NumberFormat(this.locale, o).format(t);\r\n        n = n.split(d);\r\n        var s = n[1].replace(/[0-9]*/g, '');\r\n        if (s) {\r\n            n[2] = s;\r\n        }\r\n        if (v[1] !== undefined) {\r\n            n[1] = d + v[1];\r\n        } else {\r\n            n[1] = '';\r\n        }\r\n\r\n        return n.join('');\r\n    }\r\n\r\n    var Format = function(e) {\r\n        var v = Value.call(e);\r\n        if (! v) {\r\n            return;\r\n        }\r\n\r\n        // Get decimal\r\n        var d = getDecimal.call(this);\r\n        var n = FormatValue.call(this, v);\r\n        var t = (n.length) - v.length;\r\n        var index = Caret.call(e) + t;\r\n        // Set value and update caret\r\n        Value.call(e, n, index, true);\r\n    }\r\n\r\n    var Extract = function(v) {\r\n        // Keep the raw value\r\n        var current = ParseValue.call(this, v);\r\n        if (current) {\r\n            return parseFloat(current.join('.'));\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Caret getter and setter methods\r\n     */\r\n    var Caret = function(index, adjustNumeric) {\r\n        if (index === undefined) {\r\n            if (this.tagName == 'DIV') {\r\n                var pos = 0;\r\n                var s = window.getSelection();\r\n                if (s) {\r\n                    if (s.rangeCount !== 0) {\r\n                        var r = s.getRangeAt(0);\r\n                        var p = r.cloneRange();\r\n                        p.selectNodeContents(this);\r\n                        p.setEnd(r.endContainer, r.endOffset);\r\n                        pos = p.toString().length;\r\n                    }\r\n                }\r\n                return pos;\r\n            } else {\r\n                return this.selectionStart;\r\n            }\r\n        } else {\r\n            // Get the current value\r\n            var n = Value.call(this);\r\n\r\n            // Review the position\r\n            if (adjustNumeric) {\r\n                var p = null;\r\n                for (var i = 0; i < n.length; i++) {\r\n                    if (n[i].match(/[\\-0-9]/g) || n[i] == '.' || n[i] == ',') {  \r\n                        p = i;\r\n                    }\r\n                }\r\n\r\n                // If the string has no numbers\r\n                if (p === null) {\r\n                    p = n.indexOf(' ');\r\n                }\r\n\r\n                if (index >= p) {\r\n                    index = p + 1;\r\n                }\r\n            }\r\n\r\n            // Do not update caret\r\n            if (index > n.length) {\r\n                index = n.length;\r\n            }\r\n\r\n            if (index) {\r\n                // Set caret\r\n                if (this.tagName == 'DIV') {\r\n                    var s = window.getSelection();\r\n                    var r = document.createRange();\r\n                    r.setStart(this.childNodes[0], index);\r\n                    s.removeAllRanges();\r\n                    s.addRange(r);\r\n                } else {\r\n                    this.selectionStart = index;\r\n                    this.selectionEnd = index;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Value getter and setter method\r\n     */\r\n    var Value = function(v, updateCaret, adjustNumeric) {\r\n        if (this.tagName == 'DIV') {\r\n            if (v === undefined) {\r\n                return this.innerText;\r\n            } else {\r\n                if (this.innerText !== v) {\r\n                    this.innerText = v;\r\n\r\n                    if (updateCaret) {\r\n                        Caret.call(this, updateCaret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            if (v === undefined) {\r\n                return this.value;\r\n            } else {\r\n                if (this.value !== v) {\r\n                    this.value = v;\r\n                    if (updateCaret) {\r\n                        Caret.call(this, updateCaret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Labels\r\n    var weekDaysFull = jSuites.calendar.weekdays;\r\n    var weekDays = jSuites.calendar.weekdaysShort;\r\n    var monthsFull = jSuites.calendar.months;\r\n    var months = jSuites.calendar.monthsShort;\r\n\r\n    var parser = {\r\n        'YEAR': function(v, s) {\r\n            var y = ''+new Date().getFullYear();\r\n\r\n            if (typeof(this.values[this.index]) === 'undefined') {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (parseInt(v) >= 0 && parseInt(v) <= 10) {\r\n                if (this.values[this.index].length < s) {\r\n                    this.values[this.index] += v;\r\n                }\r\n            }\r\n            if (this.values[this.index].length == s) {\r\n                if (s == 2) {\r\n                    var y = y.substr(0,2) + this.values[this.index];\r\n                } else if (s == 3) {\r\n                    var y = y.substr(0,1) + this.values[this.index];\r\n                } else if (s == 4) {\r\n                    var y = this.values[this.index];\r\n                }\r\n                this.date[0] = y;\r\n                this.index++;\r\n            }\r\n        },\r\n        'YYYY': function(v) {\r\n            parser.YEAR.call(this, v, 4);\r\n        },\r\n        'YYY': function(v) {\r\n            parser.YEAR.call(this, v, 3);\r\n        },\r\n        'YY': function(v) {\r\n            parser.YEAR.call(this, v, 2);\r\n        },\r\n        'FIND': function(v, a) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var pos = 0;\r\n            var count = 0;\r\n            var value = (this.values[this.index] + v).toLowerCase();\r\n            for (var i = 0; i < a.length; i++) {\r\n                if (a[i].toLowerCase().indexOf(value) == 0) {\r\n                    pos = i;\r\n                    count++;\r\n                }\r\n            }\r\n            if (count > 1) {\r\n                this.values[this.index] += v;\r\n            } else if (count == 1) {\r\n                this.values[this.index] = a[pos];\r\n                this.index++;\r\n\r\n                return pos;\r\n            }\r\n        },\r\n        'MMM': function(v) {\r\n            var ret = parser.FIND.call(this, v, months);\r\n            if (ret !== undefined) {\r\n                this.date[1] = ret + 1;\r\n            }\r\n        },\r\n        'MMMM': function(v) {\r\n            var ret = parser.FIND.call(this, v, monthsFull);\r\n            if (ret !== undefined) {\r\n                this.date[1] = ret + 1;\r\n            }\r\n        },\r\n        'MMMMM': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var pos = 0;\r\n            var count = 0;\r\n            var value = (this.values[this.index] + v).toLowerCase();\r\n            for (var i = 0; i < monthsFull.length; i++) {\r\n                if (monthsFull[i][0].toLowerCase().indexOf(value) == 0) {\r\n                    this.values[this.index] = monthsFull[i][0];\r\n                    this.date[1] = i + 1;\r\n                    this.index++;\r\n                    break;\r\n                }\r\n            }\r\n        },\r\n        'MM': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 1 && parseInt(v) < 10) {\r\n                    this.date[1] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 2) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                    this.date[1] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] == 0 && parseInt(v) > 0 && parseInt(v) < 10) {\r\n                    this.date[1] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'M': function(v) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (isBlank(this.values[this.index])) {\r\n                    this.values[this.index] = v;\r\n                    if (v > 1) {\r\n                        this.date[1] = this.values[this.index];\r\n                        this.index++;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                        this.date[1] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 0 && parseInt(v) > 0) {\r\n                        this.date[1] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else {\r\n                        var test = true;\r\n                    }\r\n                }\r\n            } else {\r\n                var test = true;\r\n            }\r\n\r\n            // Re-test\r\n            if (test == true) {\r\n                var t = parseInt(this.values[this.index]);\r\n                if (t > 0 && t < 12) {\r\n                    this.date[2] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'D': function(v) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (isBlank(this.values[this.index])) {\r\n                    this.values[this.index] = v;\r\n                    if (parseInt(v) > 3) {\r\n                        this.date[2] = this.values[this.index];\r\n                        this.index++;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 3 && parseInt(v) < 2) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 1 || this.values[this.index] == 2) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] == 0 && parseInt(v) > 0) {\r\n                        this.date[2] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else {\r\n                        var test = true;\r\n                    }\r\n                }\r\n            } else {\r\n                var test = true;\r\n            }\r\n\r\n            // Re-test\r\n            if (test == true) {\r\n                var t = parseInt(this.values[this.index]);\r\n                if (t > 0 && t < 32) {\r\n                    this.date[2] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'DD': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 3 && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 3 && parseInt(v) < 2) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if ((this.values[this.index] == 1 || this.values[this.index] == 2) && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] == 0 && parseInt(v) > 0 && parseInt(v) < 10) {\r\n                    this.date[2] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'DDD': function(v) {\r\n            parser.FIND.call(this, v, weekDays);\r\n        },\r\n        'DDDD': function(v) {\r\n            parser.FIND.call(this, v, weekDaysFull);\r\n        },\r\n        'HH12': function(v, two) {\r\n            if (isBlank(this.values[this.index])) {\r\n                if (parseInt(v) > 1 && parseInt(v) < 10) {\r\n                    if (two) {\r\n                        v = 0 + v;\r\n                    }\r\n                    this.date[3] = this.values[this.index] = v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (this.values[this.index] == 1 && parseInt(v) < 3) {\r\n                    this.date[3] = this.values[this.index] += v;\r\n                    this.index++;\r\n                } else if (this.values[this.index] < 1 && parseInt(v) < 10) {\r\n                    this.date[3] = this.values[this.index] += v;\r\n                    this.index++;\r\n                }\r\n            }\r\n        },\r\n        'HH24': function(v, two) {\r\n            var test = false;\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (this.values[this.index] == null || this.values[this.index] == '') {\r\n                    if (parseInt(v) > 2 && parseInt(v) < 10) {\r\n                        if (two) {\r\n                            v = 0 + v;\r\n                        }\r\n                        this.date[3] = this.values[this.index] = v;\r\n                        this.index++;\r\n                    } else if (parseInt(v) < 10) {\r\n                        this.values[this.index] = v;\r\n                    }\r\n                } else {\r\n                    if (this.values[this.index] == 2 && parseInt(v) < 4) {\r\n                        this.date[3] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    } else if (this.values[this.index] < 2 && parseInt(v) < 10) {\r\n                        this.date[3] = this.values[this.index] += v;\r\n                        this.index++;\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        'HH': function(v) {\r\n            parser['HH24'].call(this, v, 1);\r\n        },\r\n        'H': function(v) {\r\n            parser['HH24'].call(this, v, 0);\r\n        },\r\n        '\\\\[H\\\\]': function(v) {\r\n            if (this.values[this.index] == undefined) {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (v.match(/[0-9]/g)) {\r\n                this.date[3] = this.values[this.index] += v;\r\n            } else {\r\n                if (this.values[this.index].match(/[0-9]/g)) {\r\n                    this.date[3] = this.values[this.index];\r\n                    this.index++;\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'N60': function(v, i) {\r\n            if (this.values[this.index] == null || this.values[this.index] == '') {\r\n                if (parseInt(v) > 5 && parseInt(v) < 10) {\r\n                    this.date[i] = this.values[this.index] = '0' + v;\r\n                    this.index++;\r\n                } else if (parseInt(v) < 10) {\r\n                    this.values[this.index] = v;\r\n                }\r\n            } else {\r\n                if (parseInt(v) < 10) {\r\n                    this.date[i] = this.values[this.index] += v;\r\n                    this.index++;\r\n                 }\r\n            }\r\n        },\r\n        'MI': function(v) {\r\n            parser.N60.call(this, v, 4);\r\n        },\r\n        'SS': function(v) {\r\n            parser.N60.call(this, v, 5);\r\n        },\r\n        'AM/PM': function(v) {\r\n            this.values[this.index] = '';\r\n            if (v) {\r\n                if (this.date[3] > 12) {\r\n                    this.values[this.index] = 'PM';\r\n                } else {\r\n                    this.values[this.index] = 'AM';\r\n                }\r\n            }\r\n            this.index++;\r\n        },\r\n        'WD': function(v) {\r\n            if (typeof(this.values[this.index]) === 'undefined') {\r\n                this.values[this.index] = '';\r\n            }\r\n            if (parseInt(v) >= 0 && parseInt(v) < 7) {\r\n                this.values[this.index] = v;\r\n            }\r\n            if (this.value[this.index].length == 1) {\r\n                this.index++;\r\n            }\r\n        },\r\n        '0{1}(.{1}0+)?': function(v) {\r\n            // Get decimal\r\n            var decimal = getDecimal.call(this);\r\n            // Negative number\r\n            var neg = false;\r\n            // Create if is blank\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            } else {\r\n                if (this.values[this.index] == '-') {\r\n                    neg = true;\r\n                }\r\n            }\r\n            var current = ParseValue.call(this, this.values[this.index], decimal);\r\n            if (current) {\r\n                this.values[this.index] = current.join(decimal);\r\n            }\r\n            // New entry\r\n            if (parseInt(v) >= 0 && parseInt(v) < 10) {\r\n                if (this.values[this.index] != '0' || v == decimal) {\r\n                    this.values[this.index] += v;\r\n                }\r\n            } else if (decimal && v == decimal) {\r\n                if (this.values[this.index].indexOf(decimal) == -1) {\r\n                    if (! this.values[this.index]) {\r\n                        this.values[this.index] = '0';\r\n                    }\r\n                    this.values[this.index] += v;\r\n                }\r\n            } else if (v == '-') {\r\n                // Negative signed\r\n                neg = true;\r\n            }\r\n\r\n            if (neg === true && this.values[this.index][0] !== '-') {\r\n                this.values[this.index] = '-' + this.values[this.index];\r\n            }\r\n        },\r\n        '0{1}(.{1}0+)?%': function(v) {\r\n            parser['0{1}(.{1}0+)?'].call(this, v);\r\n\r\n            if (this.values[this.index].match(/[\\-0-9]/g)) {\r\n                if (this.values[this.index] && this.values[this.index].indexOf('%') == -1) {\r\n                    this.values[this.index] += '%';\r\n                }\r\n            } else {\r\n                this.values[this.index] = '';\r\n            }\r\n        },\r\n        '#(.{1})##0?(.{1}0+)?( ?;(.*)?)?': function(v) {\r\n            // Parse number\r\n            parser['0{1}(.{1}0+)?'].call(this, v);\r\n            // Get decimal\r\n            var decimal = getDecimal.call(this);\r\n            // Get separator\r\n            var separator = this.tokens[this.index].substr(1,1);\r\n            // Negative\r\n            var negative = this.values[this.index][0] === '-' ? true : false;\r\n            // Current value\r\n            var current = ParseValue.call(this, this.values[this.index], decimal);\r\n\r\n            // Get main and decimal parts\r\n            if (current !== '') {\r\n                // Format number\r\n                var n = current[0].match(/[0-9]/g);\r\n                if (n) {\r\n                    // Format\r\n                    n = n.join('');\r\n                    var t = [];\r\n                    var s = 0;\r\n                    for (var j = n.length - 1; j >= 0 ; j--) {\r\n                        t.push(n[j]);\r\n                        s++;\r\n                        if (! (s % 3)) {\r\n                            t.push(separator);\r\n                        }\r\n                    }\r\n                    t = t.reverse();\r\n                    current[0] = t.join('');\r\n                    if (current[0].substr(0,1) == separator) {\r\n                        current[0] = current[0].substr(1);\r\n                    }\r\n                } else {\r\n                    current[0] = '';\r\n                }\r\n\r\n                // Value\r\n                this.values[this.index] = current.join(decimal);\r\n\r\n                // Negative\r\n                if (negative) {\r\n                    this.values[this.index] = '-' + this.values[this.index];\r\n                }\r\n            }\r\n        },\r\n        '0': function(v) {\r\n            if (v.match(/[0-9]/g)) {\r\n                this.values[this.index] = v;\r\n                this.index++;\r\n            }\r\n        },\r\n        '[0-9a-zA-Z$]+': function(v) {\r\n            if (isBlank(this.values[this.index])) {\r\n                this.values[this.index] = '';\r\n            }\r\n            var t = this.tokens[this.index];\r\n            var s = this.values[this.index];\r\n            var i = s.length;\r\n\r\n            if (t[i] == v) {\r\n                this.values[this.index] += v;\r\n\r\n                if (this.values[this.index] == t) {\r\n                    this.index++;\r\n                }\r\n            } else {\r\n                this.values[this.index] = t;\r\n                this.index++;\r\n\r\n                if (v.match(/[\\-0-9]/g)) {\r\n                    // Repeat the character\r\n                    this.position--;\r\n                }\r\n            }\r\n        },\r\n        'A': function(v) {\r\n            if (v.match(/[a-zA-Z]/gi)) {\r\n                this.values[this.index] = v;\r\n                this.index++;\r\n            }\r\n        },\r\n        '.': function(v) {\r\n            parser['[0-9a-zA-Z$]+'].call(this, v);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the tokens in the mask string\r\n     */\r\n    var getTokens = function(str) {\r\n        if (this.type == 'general') {\r\n            var t = [].concat(tokens.general);\r\n        } else {\r\n            var t = [].concat(tokens.currency, tokens.datetime, tokens.percentage, tokens.numeric, tokens.general);\r\n        }\r\n        // Expression to extract all tokens from the string\r\n        var e = new RegExp(t.join('|'), 'gi');\r\n        // Extract\r\n        return str.match(e);\r\n    }\r\n\r\n    /**\r\n     * Get the method of one given token\r\n     */\r\n    var getMethod = function(str) {\r\n        if (! this.type) {\r\n            var types = Object.keys(tokens);\r\n        } else if (this.type == 'general') {\r\n            var types = [ 'general' ];\r\n        } else if (this.type == 'datetime') {\r\n            var types = [ 'numeric', 'datetime', 'general' ];\r\n        } else {\r\n            var types = [ 'currency', 'percentage', 'numeric', 'general' ];\r\n        }\r\n\r\n        // Found\r\n        for (var i = 0; i < types.length; i++) {\r\n            var type = types[i];\r\n            for (var j = 0; j < tokens[type].length; j++) {\r\n                var e = new RegExp(tokens[type][j], 'gi');\r\n                var r = str.match(e);\r\n                if (r) {\r\n                    return { type: type, method: tokens[type][j] }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Identify each method for each token\r\n     */\r\n    var getMethods = function(t) {\r\n        var result = [];\r\n        for (var i = 0; i < t.length; i++) {\r\n            var m = getMethod.call(this, t[i]);\r\n            if (m) {\r\n                result.push(m.method);\r\n            } else {\r\n                result.push(null);\r\n            }\r\n        }\r\n\r\n        // Compatibility with excel\r\n        for (var i = 0; i < result.length; i++) {\r\n            if (result[i] == 'MM') {\r\n                // Not a month, correct to minutes\r\n                if (result[i-1] && result[i-1].indexOf('H') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i-2] && result[i-2].indexOf('H') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i+1] && result[i+1].indexOf('S') >= 0) {\r\n                    result[i] = 'MI';\r\n                } else if (result[i+2] && result[i+2].indexOf('S') >= 0) {\r\n                    result[i] = 'MI';\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * Get the type for one given token\r\n     */\r\n    var getType = function(str) {\r\n        var m = getMethod.call(this, str);\r\n        if (m) {\r\n            var type = m.type;\r\n        }\r\n\r\n        if (type) {\r\n            var numeric = 0;\r\n            // Make sure the correct type\r\n            var t = getTokens.call(this, str);\r\n            for (var i = 0; i < t.length; i++) {\r\n                m = getMethod.call(this, t[i]);\r\n                if (m && isNumeric(m.type)) {\r\n                    numeric++;\r\n                }\r\n            }\r\n            if (numeric > 1) {\r\n                type = 'general';\r\n            }\r\n        }\r\n\r\n        return type;\r\n    }\r\n\r\n    /**\r\n     * Parse character per character using the detected tokens in the mask\r\n     */\r\n    var parse = function() {\r\n        // Parser method for this position\r\n        if (typeof(parser[this.methods[this.index]]) == 'function') {\r\n            parser[this.methods[this.index]].call(this, this.value[this.position]);\r\n            this.position++;\r\n        } else {\r\n            this.values[this.index] = this.tokens[this.index];\r\n            this.index++;\r\n        }\r\n    }\r\n\r\n    var isFormula = function(value) {\r\n        var v = (''+value)[0];\r\n        return v == '=' ? true : false;\r\n    }\r\n\r\n    var toPlainString = function(num) {\r\n        return (''+ +num).replace(/(-?)(\\d*)\\.?(\\d*)e([+-]\\d+)/,\r\n          function(a,b,c,d,e) {\r\n            return e < 0\r\n              ? b + '0.' + Array(1-e-c.length).join(0) + c + d\r\n              : b + c + d + Array(e-d.length+1).join(0);\r\n          });\r\n    }\r\n\r\n    /**\r\n     * Mask function\r\n     * @param {mixed|string} JS input or a string to be parsed\r\n     * @param {object|string} When the first param is a string, the second is the mask or object with the mask options\r\n     */\r\n    var obj = function(e, config, returnObject) {\r\n        // Options\r\n        var r = null;\r\n        var t = null;\r\n        var o = {\r\n            // Element\r\n            input: null,\r\n            // Current value\r\n            value: null,\r\n            // Mask options\r\n            options: {},\r\n            // New values for each token found\r\n            values: [],\r\n            // Token position\r\n            index: 0,\r\n            // Character position\r\n            position: 0,\r\n            // Date raw values\r\n            date: [0,0,0,0,0,0],\r\n            // Raw number for the numeric values\r\n            number: 0,\r\n        }\r\n\r\n        // This is a JavaScript Event\r\n        if (typeof(e) == 'object') {\r\n            // Element\r\n            o.input = e.target;\r\n            // Current value\r\n            o.value = Value.call(e.target);\r\n            // Current caret position\r\n            o.caret = Caret.call(e.target);\r\n            // Mask\r\n            if (t = e.target.getAttribute('data-mask')) {\r\n                o.mask = t;\r\n            }\r\n            // Type\r\n            if (t = e.target.getAttribute('data-type')) {\r\n                o.type = t;\r\n            }\r\n            // Options\r\n            if (e.target.mask) {\r\n                if (e.target.mask.options) {\r\n                    o.options = e.target.mask.options;\r\n                }\r\n                if (e.target.mask.locale) {\r\n                    o.locale = e.target.mask.locale;\r\n                }\r\n            } else {\r\n                // Locale\r\n                if (t = e.target.getAttribute('data-locale')) {\r\n                    o.locale = t;\r\n                    if (o.mask) {\r\n                        o.options.style = o.mask;\r\n                    }\r\n                }\r\n            }\r\n            // Extra configuration\r\n            if (e.target.attributes && e.target.attributes.length) {\r\n                for (var i = 0; i < e.target.attributes.length; i++) {\r\n                    var k = e.target.attributes[i].name;\r\n                    var v = e.target.attributes[i].value;\r\n                    if (k.substr(0,4) == 'data') {\r\n                        o.options[k.substr(5)] = v;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            // Options\r\n            if (typeof(config) == 'string') {\r\n                // Mask\r\n                o.mask = config;\r\n            } else {\r\n                // Mask\r\n                var k = Object.keys(config);\r\n                for (var i = 0; i < k.length; i++) {\r\n                    o[k[i]] = config[k[i]];\r\n                }\r\n            }\r\n\r\n            if (typeof(e) === 'number') {\r\n                // Get decimal\r\n                getDecimal.call(o, o.mask);\r\n                // Replace to the correct decimal\r\n                e = (''+e).replace('.', o.options.decimal);\r\n            }\r\n\r\n            // Current\r\n            o.value = e;\r\n\r\n            if (o.input) {\r\n                // Value\r\n                Value.call(o.input, e);\r\n                // Focus\r\n                jSuites.focus(o.input);\r\n                // Caret\r\n                o.caret = Caret.call(o.input);\r\n            }\r\n        }\r\n\r\n        // Mask detected start the process\r\n        if (! isFormula(o.value) && (o.mask || o.locale)) {\r\n            // Compatibility ixes\r\n            if (o.mask) {\r\n                // Legacy\r\n                o.mask = o.mask.replace('[-]', '');\r\n                // Excel mask TODO: Improve\r\n                if (o.mask.indexOf('##')) {\r\n                    var d = o.mask.split(';');\r\n                    if (d[0]) {\r\n                        d[0] = d[0].replace('*', '');\r\n                        d[0] = d[0].replace(/_/g, '');\r\n                        d[0] = d[0].replace(/-/g, '');\r\n                        d[0] = d[0].replace('(','');\r\n                        d[0] = d[0].replace(')','');\r\n                        d[0] = d[0].replace('##0.###','##0.000');\r\n                        d[0] = d[0].replace('##0.##','##0.00');\r\n                        d[0] = d[0].replace('##0.#','##0.0');\r\n                    }\r\n                    o.mask = d[0];\r\n                }\r\n                // Get type\r\n                if (! o.type) {\r\n                    o.type = getType.call(o, o.mask);\r\n                }\r\n                // Get tokens\r\n                o.tokens = getTokens.call(o, o.mask);\r\n            }\r\n            // On new input\r\n            if (typeof(e) !== 'object' || ! e.inputType || e.inputType == 'insertText' || e.inputType == 'insertFromPaste') {\r\n                // Start tranformation\r\n                if (o.locale) {\r\n                    if (o.input) {\r\n                        Format.call(o, o.input);\r\n                    } else {\r\n                        var newValue = FormatValue.call(o, o.value);\r\n                    }\r\n                } else {\r\n                    // Get tokens\r\n                    o.methods = getMethods.call(o, o.tokens);\r\n                    // Go through all tokes\r\n                    while (o.position < o.value.length && typeof(o.tokens[o.index]) !== 'undefined') {\r\n                        // Get the approate parser\r\n                        parse.call(o);\r\n                    }\r\n\r\n                    if (isNumeric(o.type)) {\r\n                        // Complement things in the end of the mask\r\n                        while (typeof(o.tokens[o.index]) !== 'undefined') {\r\n                            var t = getMethod.call(o, o.tokens[o.index]);\r\n                            if (t && t.type == 'general') {\r\n                                o.values[o.index] = o.tokens[o.index];\r\n                            }\r\n                            o.index++;\r\n                        }\r\n\r\n                        var adjustNumeric = true;\r\n                    } else {\r\n                        var adjustNumeric = false;\r\n                    }\r\n\r\n                    // New value\r\n                    var newValue = o.values.join('');\r\n\r\n                    // Reset value\r\n                    if (o.input) {\r\n                        t = newValue.length - o.value.length;\r\n                        if (t > 0) {\r\n                            var caret = o.caret + t;\r\n                        } else {\r\n                            var caret = o.caret;\r\n                        }\r\n                        Value.call(o.input, newValue, caret, adjustNumeric);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Update raw data\r\n            if (o.input) {\r\n                var label = null;\r\n                if (isNumeric(o.type)) {\r\n                    // Extract the number\r\n                    o.number = Extract.call(o, Value.call(o.input));\r\n                    // Keep the raw data as a property of the tag\r\n                    if (o.type == 'percentage') {\r\n                        label = o.number / 100;\r\n                    } else {\r\n                        label = o.number;\r\n                    }\r\n                } else if (o.type == 'datetime') {\r\n                    label = getDate.call(o);\r\n\r\n                    if (o.date[0] && o.date[1] && o.date[2]) {\r\n                        o.input.setAttribute('data-completed', true);\r\n                    }\r\n                }\r\n\r\n                if (label) {\r\n                    o.input.setAttribute('data-value', label);\r\n                }\r\n            }\r\n\r\n            if (newValue !== undefined) {\r\n                if (returnObject) {\r\n                    return o;\r\n                } else {\r\n                    return newValue;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Extract the tokens from a mask\r\n    obj.prepare = function(str, o) {\r\n        if (! o) {\r\n            o = {};\r\n        }\r\n        return getTokens.call(o, str);\r\n    }\r\n\r\n    /**\r\n     * Apply the mask to a element (legacy)\r\n     */\r\n    obj.apply = function(e) {\r\n        var v = Value.call(e.target);\r\n        if (e.key.length == 1) {\r\n            v += e.key;\r\n        }\r\n        Value.call(e.target, obj(v, e.target.getAttribute('data-mask')));\r\n    }\r\n\r\n    /**\r\n     * Legacy support\r\n     */\r\n    obj.run = function(value, mask, decimal) {\r\n        return obj(value, { mask, decimal });\r\n    }\r\n\r\n    /**\r\n     * Extract number from masked string\r\n     */\r\n    obj.extract = function(v, options, returnObject) {\r\n        if (isBlank(v)) {\r\n            return v;\r\n        }\r\n        if (typeof(options) != 'object') {\r\n            return value;\r\n        } else {\r\n            if (! options.options) {\r\n                options.options = {};\r\n            }\r\n        }\r\n\r\n        // Compatibility\r\n        if (! options.mask && options.format) {\r\n            options.mask = options.format;\r\n        }\r\n\r\n        // Get decimal\r\n        getDecimal.call(options, options.mask);\r\n\r\n        var type = null;\r\n        if (options.type == 'percent' || options.options.style == 'percent') {\r\n            type = 'percentage';\r\n        } else if (options.mask) {\r\n            type = getType.call(options, options.mask);\r\n        }\r\n\r\n\r\n        if (type === 'datetime') {\r\n            if (v instanceof Date) {\r\n                var t = jSuites.calendar.getDateString(value, options.mask);\r\n            }\r\n\r\n            var o = obj(v, options, true);\r\n            var value = getDate.call(o);\r\n            if ((o.date[0] && o.date[1] && o.date[2]) && ! (o.date[3] || o.date[4] || o.date[5])) {\r\n                var t = jSuites.calendar.now(o.date);\r\n                value = jSuites.calendar.dateToNum(t);\r\n            }\r\n        } else {\r\n            var value = Extract.call(options, v);\r\n            // Percentage\r\n            if (type == 'percentage') {\r\n                value /= 100;\r\n            }\r\n            var o = options;\r\n        }\r\n\r\n        o.value = value;\r\n\r\n        if (returnObject) {\r\n            return o;\r\n        } else {\r\n            return value;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Render\r\n     */\r\n    obj.render = function(value, options, fullMask) {\r\n        if (isBlank(value)) {\r\n            return value;\r\n        }\r\n\r\n        if (typeof(options) != 'object') {\r\n            return value;\r\n        } else {\r\n            if (! options.options) {\r\n                options.options = {};\r\n            }\r\n        }\r\n\r\n        // Compatibility\r\n        if (! options.mask && options.format) {\r\n            options.mask = options.format;\r\n        }\r\n\r\n        var type = null;\r\n        if (options.type == 'percent' || options.options.style == 'percent') {\r\n            type = 'percentage';\r\n        } else if (options.mask) {\r\n            type = getType.call(options, options.mask);\r\n        } else if (value instanceof Date) {\r\n            type = 'datetime';\r\n        }\r\n\r\n        // Fill with blanks\r\n        var fillWithBlanks = false;\r\n\r\n        if (type =='datetime' || options.type == 'calendar') {\r\n            var t = jSuites.calendar.getDateString(value, options.mask);\r\n            if (t) {\r\n                value = t;\r\n            }\r\n\r\n            if (options.mask && fullMask) {\r\n                fillWithBlanks = true;\r\n            }\r\n        } else {\r\n            // Percentage\r\n            if (type == 'percentage') {\r\n                value *= 100;\r\n            }\r\n            // Number of decimal places\r\n            if (typeof(value) === 'number') {\r\n                var t = null;\r\n                if (options.mask && fullMask) {\r\n                    var e = new RegExp('0{1}(.{1})0+', 'ig');\r\n                    var d = options.mask.match(e);\r\n                    if (d && d[0]) {\r\n                        d = d[0].length - 2;\r\n                        t = value.toFixed(d);\r\n                    } else {\r\n                        t = (''+value);\r\n                    }\r\n                } else if (options.locale && fullMask) {\r\n                    var d = (''+value).split('.');\r\n                    if (! d[1]) {\r\n                        d[1] = '00';\r\n                    } else {\r\n                        if (d[1].length == 1) {\r\n                            d[1] += '0';\r\n                        }\r\n                    }\r\n                    t = d.join('.');\r\n                } else {\r\n                    t = toPlainString(value);\r\n                }\r\n\r\n                if (t !== null) {\r\n                    value = t;\r\n                    // Get decimal\r\n                    getDecimal.call(options, options.mask);\r\n                    // Replace to the correct decimal\r\n                    if (options.options.decimal) {\r\n                        value = value.replace('.', options.options.decimal);\r\n                    }\r\n                }\r\n            } else {\r\n                if (options.mask && fullMask) {\r\n                    fillWithBlanks = true;\r\n                }\r\n            }\r\n        }\r\n\r\n        if (fillWithBlanks) {\r\n            var s = options.mask.length - value.length;\r\n            if (s > 0) {\r\n                for (var i = 0; i < s; i++) {\r\n                    value += ' ';\r\n                }\r\n            }\r\n        }\r\n\r\n        value = obj(value, options);\r\n\r\n        return value;\r\n    }\r\n\r\n    obj.set = function(e, m) {\r\n        if (m) {\r\n            e.setAttribute('data-mask', m);\r\n            // Reset the value\r\n            var event = new Event('input', {\r\n                bubbles: true,\r\n                cancelable: true,\r\n            });\r\n            e.dispatchEvent(event);\r\n        }\r\n    }\r\n\r\n    if (typeof document !== 'undefined') {\r\n        document.addEventListener('input', function(e) {\r\n            if (e.target.getAttribute('data-mask') || e.target.mask) {\r\n                obj(e);\r\n            }\r\n        });\r\n    }\r\n\r\n    return obj;\r\n})();\r\n\r\njSuites.modal = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: null,\r\n        onopen: null,\r\n        onclose: null,\r\n        closed: false,\r\n        width: null,\r\n        height: null,\r\n        title: null,\r\n        padding: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Title\r\n    if (! obj.options.title && el.getAttribute('title')) {\r\n        obj.options.title = el.getAttribute('title');\r\n    }\r\n\r\n    var temp = document.createElement('div');\r\n    while (el.children[0]) {\r\n        temp.appendChild(el.children[0]);\r\n    }\r\n\r\n    obj.content = document.createElement('div');\r\n    obj.content.className = 'jmodal_content';\r\n    obj.content.innerHTML = el.innerHTML;\r\n\r\n    while (temp.children[0]) {\r\n        obj.content.appendChild(temp.children[0]);\r\n    }\r\n\r\n    obj.container = document.createElement('div');\r\n    obj.container.className = 'jmodal';\r\n    obj.container.appendChild(obj.content);\r\n\r\n    if (obj.options.padding) {\r\n        obj.content.style.padding = obj.options.padding;\r\n    }\r\n    if (obj.options.width) {\r\n        obj.container.style.width = obj.options.width;\r\n    }\r\n    if (obj.options.height) {\r\n        obj.container.style.height = obj.options.height;\r\n    }\r\n    if (obj.options.title) {\r\n        obj.container.setAttribute('title', obj.options.title);\r\n    } else {\r\n        obj.container.classList.add('no-title');\r\n    }\r\n    el.innerHTML = '';\r\n    el.style.display = 'none';\r\n    el.appendChild(obj.container);\r\n\r\n    // Backdrop\r\n    var backdrop = document.createElement('div');\r\n    backdrop.className = 'jmodal_backdrop';\r\n    backdrop.onclick = function() {\r\n        obj.close();\r\n    }\r\n    el.appendChild(backdrop);\r\n\r\n    obj.open = function() {\r\n        el.style.display = 'block';\r\n        // Fullscreen\r\n        var rect = obj.container.getBoundingClientRect();\r\n        if (jSuites.getWindowWidth() < rect.width) {\r\n            obj.container.style.top = '';\r\n            obj.container.style.left = '';\r\n            obj.container.classList.add('jmodal_fullscreen');\r\n            jSuites.animation.slideBottom(obj.container, 1);\r\n        } else {\r\n            backdrop.style.display = 'block';\r\n        }\r\n        // Current\r\n        jSuites.modal.current = obj;\r\n        // Event\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el, obj);\r\n        }\r\n    }\r\n\r\n    obj.resetPosition = function() {\r\n        obj.container.style.top = '';\r\n        obj.container.style.left = '';\r\n    }\r\n\r\n    obj.isOpen = function() {\r\n        return el.style.display != 'none' ? true : false;\r\n    }\r\n\r\n    obj.close = function() {\r\n        el.style.display = 'none';\r\n        // Backdrop\r\n        backdrop.style.display = '';\r\n        // Current\r\n        jSuites.modal.current = null;\r\n        // Remove fullscreen class\r\n        obj.container.classList.remove('jmodal_fullscreen');\r\n        // Event\r\n        if (typeof(obj.options.onclose) == 'function') {\r\n            obj.options.onclose(el, obj);\r\n        }\r\n    }\r\n\r\n    if (! jSuites.modal.hasEvents) {\r\n        jSuites.modal.current = obj;\r\n\r\n        if ('ontouchstart' in document.documentElement === true) {\r\n            document.addEventListener(\"touchstart\", jSuites.modal.mouseDownControls);\r\n        } else {\r\n            document.addEventListener('mousedown', jSuites.modal.mouseDownControls);\r\n            document.addEventListener('mousemove', jSuites.modal.mouseMoveControls);\r\n            document.addEventListener('mouseup', jSuites.modal.mouseUpControls);\r\n        }\r\n\r\n        document.addEventListener('keydown', jSuites.modal.keyDownControls);\r\n\r\n        jSuites.modal.hasEvents = true;\r\n    }\r\n\r\n    if (obj.options.url) {\r\n        jSuites.ajax({\r\n            url: obj.options.url,\r\n            method: 'GET',\r\n            dataType: 'text/html',\r\n            success: function(data) {\r\n                obj.content.innerHTML = data;\r\n\r\n                if (! obj.options.closed) {\r\n                    obj.open();\r\n                }\r\n            }\r\n        });\r\n    } else {\r\n        if (! obj.options.closed) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    // Keep object available from the node\r\n    el.modal = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.modal.current = null;\r\njSuites.modal.position = null;\r\n\r\njSuites.modal.keyDownControls = function(e) {\r\n    if (e.which == 27) {\r\n        if (jSuites.modal.current) {\r\n            jSuites.modal.current.close();\r\n        }\r\n    }\r\n}\r\n\r\njSuites.modal.mouseUpControls = function(e) {\r\n    if (jSuites.modal.current) {\r\n        jSuites.modal.current.container.style.cursor = 'auto';\r\n    }\r\n    jSuites.modal.position = null;\r\n}\r\n\r\njSuites.modal.mouseMoveControls = function(e) {\r\n    if (jSuites.modal.current && jSuites.modal.position) {\r\n        if (e.which == 1 || e.which == 3) {\r\n            var position = jSuites.modal.position;\r\n            jSuites.modal.current.container.style.top = (position[1] + (e.clientY - position[3]) + (position[5] / 2)) + 'px';\r\n            jSuites.modal.current.container.style.left = (position[0] + (e.clientX - position[2]) + (position[4] / 2)) + 'px';\r\n            jSuites.modal.current.container.style.cursor = 'move';\r\n        } else {\r\n            jSuites.modal.current.container.style.cursor = 'auto';\r\n        }\r\n    }\r\n}\r\n\r\njSuites.modal.mouseDownControls = function(e) {\r\n    jSuites.modal.position = [];\r\n\r\n    if (e.target.classList.contains('jmodal')) {\r\n        setTimeout(function() {\r\n            // Get target info\r\n            var rect = e.target.getBoundingClientRect();\r\n\r\n            if (e.changedTouches && e.changedTouches[0]) {\r\n                var x = e.changedTouches[0].clientX;\r\n                var y = e.changedTouches[0].clientY;\r\n            } else {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            }\r\n\r\n            if (rect.width - (x - rect.left) < 50 && (y - rect.top) < 50) {\r\n                setTimeout(function() {\r\n                    jSuites.modal.current.close();\r\n                }, 100);\r\n            } else {\r\n                if (e.target.getAttribute('title') && (y - rect.top) < 50) {\r\n                    if (document.selection) {\r\n                        document.selection.empty();\r\n                    } else if ( window.getSelection ) {\r\n                        window.getSelection().removeAllRanges();\r\n                    }\r\n\r\n                    jSuites.modal.position = [\r\n                        rect.left,\r\n                        rect.top,\r\n                        e.clientX,\r\n                        e.clientY,\r\n                        rect.width,\r\n                        rect.height,\r\n                    ];\r\n                }\r\n            }\r\n        }, 100);\r\n    }\r\n}\r\n\r\n\r\njSuites.notification = (function(options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        icon: null,\r\n        name: 'Notification',\r\n        date: null,\r\n        error: null,\r\n        title: null,\r\n        message: null,\r\n        timeout: 4000,\r\n        autoHide: true,\r\n        closeable: true,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    var notification = document.createElement('div');\r\n    notification.className = 'jnotification';\r\n\r\n    if (obj.options.error) {\r\n        notification.classList.add('jnotification-error');\r\n    }\r\n\r\n    var notificationContainer = document.createElement('div');\r\n    notificationContainer.className = 'jnotification-container';\r\n    notification.appendChild(notificationContainer);\r\n\r\n    var notificationHeader = document.createElement('div');\r\n    notificationHeader.className = 'jnotification-header';\r\n    notificationContainer.appendChild(notificationHeader);\r\n\r\n    var notificationImage = document.createElement('div');\r\n    notificationImage.className = 'jnotification-image';\r\n    notificationHeader.appendChild(notificationImage);\r\n\r\n    if (obj.options.icon) {\r\n        var notificationIcon = document.createElement('img');\r\n        notificationIcon.src = obj.options.icon;\r\n        notificationImage.appendChild(notificationIcon);\r\n    }\r\n\r\n    var notificationName = document.createElement('div');\r\n    notificationName.className = 'jnotification-name';\r\n    notificationName.innerHTML = obj.options.name;\r\n    notificationHeader.appendChild(notificationName);\r\n\r\n    if (obj.options.closeable == true) {\r\n        var notificationClose = document.createElement('div');\r\n        notificationClose.className = 'jnotification-close';\r\n        notificationClose.onclick = function() {\r\n            obj.hide();\r\n        }\r\n        notificationHeader.appendChild(notificationClose);\r\n    }\r\n\r\n    var notificationDate = document.createElement('div');\r\n    notificationDate.className = 'jnotification-date';\r\n    notificationHeader.appendChild(notificationDate);\r\n\r\n    var notificationContent = document.createElement('div');\r\n    notificationContent.className = 'jnotification-content';\r\n    notificationContainer.appendChild(notificationContent);\r\n\r\n    if (obj.options.title) {\r\n        var notificationTitle = document.createElement('div');\r\n        notificationTitle.className = 'jnotification-title';\r\n        notificationTitle.innerHTML = obj.options.title;\r\n        notificationContent.appendChild(notificationTitle);\r\n    }\r\n\r\n    var notificationMessage = document.createElement('div');\r\n    notificationMessage.className = 'jnotification-message';\r\n    notificationMessage.innerHTML = obj.options.message;\r\n    notificationContent.appendChild(notificationMessage);\r\n\r\n    obj.show = function() {\r\n        document.body.appendChild(notification);\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.animation.fadeIn(notification);\r\n        } else {\r\n            jSuites.animation.slideTop(notification, 1);\r\n        }\r\n    }\r\n\r\n    obj.hide = function() {\r\n        if (jSuites.getWindowWidth() > 800) { \r\n            jSuites.animation.fadeOut(notification, function() {\r\n                if (notification.parentNode) {\r\n                    notification.parentNode.removeChild(notification);\r\n                    if (notificationTimeout) {\r\n                        clearTimeout(notificationTimeout);\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            jSuites.animation.slideTop(notification, 0, function() {\r\n                if (notification.parentNode) {\r\n                    notification.parentNode.removeChild(notification);\r\n                    if (notificationTimeout) {\r\n                        clearTimeout(notificationTimeout);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    };\r\n\r\n    obj.show();\r\n\r\n    if (obj.options.autoHide == true) {\r\n        var notificationTimeout = setTimeout(function() {\r\n            obj.hide();\r\n        }, obj.options.timeout);\r\n    }\r\n\r\n    if (jSuites.getWindowWidth() < 800) {\r\n        notification.addEventListener(\"swipeup\", function(e) {\r\n            obj.hide();\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n        });\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.notification.isVisible = function() {\r\n    var j = document.querySelector('.jnotification');\r\n    return j && j.parentNode ? true : false;\r\n}\r\n\r\n// More palettes https://coolors.co/ or https://gka.github.io/palettes/#/10|s|003790,005647,ffffe0|ffffe0,ff005e,93003a|1|1\r\n\r\njSuites.palette = function(o) {\r\n    // Material\r\n    var palette = {};\r\n\r\n    palette.material = [\r\n        [ \"#ffebee\", \"#fce4ec\", \"#f3e5f5\", \"#e8eaf6\", \"#e3f2fd\", \"#e0f7fa\", \"#e0f2f1\", \"#e8f5e9\", \"#f1f8e9\", \"#f9fbe7\", \"#fffde7\", \"#fff8e1\", \"#fff3e0\", \"#fbe9e7\", \"#efebe9\", \"#fafafa\", \"#eceff1\" ],\r\n        [ \"#ffcdd2\", \"#f8bbd0\", \"#e1bee7\", \"#c5cae9\", \"#bbdefb\", \"#b2ebf2\", \"#b2dfdb\", \"#c8e6c9\", \"#dcedc8\", \"#f0f4c3\", \"#fff9c4\", \"#ffecb3\", \"#ffe0b2\", \"#ffccbc\", \"#d7ccc8\", \"#f5f5f5\", \"#cfd8dc\" ],\r\n        [ \"#ef9a9a\", \"#f48fb1\", \"#ce93d8\", \"#9fa8da\", \"#90caf9\", \"#80deea\", \"#80cbc4\", \"#a5d6a7\", \"#c5e1a5\", \"#e6ee9c\", \"#fff59d\", \"#ffe082\", \"#ffcc80\", \"#ffab91\", \"#bcaaa4\", \"#eeeeee\", \"#b0bec5\" ],\r\n        [ \"#e57373\", \"#f06292\", \"#ba68c8\", \"#7986cb\", \"#64b5f6\", \"#4dd0e1\", \"#4db6ac\", \"#81c784\", \"#aed581\", \"#dce775\", \"#fff176\", \"#ffd54f\", \"#ffb74d\", \"#ff8a65\", \"#a1887f\", \"#e0e0e0\", \"#90a4ae\" ],\r\n        [ \"#ef5350\", \"#ec407a\", \"#ab47bc\", \"#5c6bc0\", \"#42a5f5\", \"#26c6da\", \"#26a69a\", \"#66bb6a\", \"#9ccc65\", \"#d4e157\", \"#ffee58\", \"#ffca28\", \"#ffa726\", \"#ff7043\", \"#8d6e63\", \"#bdbdbd\", \"#78909c\" ],\r\n        [ \"#f44336\", \"#e91e63\", \"#9c27b0\", \"#3f51b5\", \"#2196f3\", \"#00bcd4\", \"#009688\", \"#4caf50\", \"#8bc34a\", \"#cddc39\", \"#ffeb3b\", \"#ffc107\", \"#ff9800\", \"#ff5722\", \"#795548\", \"#9e9e9e\", \"#607d8b\" ],\r\n        [ \"#e53935\", \"#d81b60\", \"#8e24aa\", \"#3949ab\", \"#1e88e5\", \"#00acc1\", \"#00897b\", \"#43a047\", \"#7cb342\", \"#c0ca33\", \"#fdd835\", \"#ffb300\", \"#fb8c00\", \"#f4511e\", \"#6d4c41\", \"#757575\", \"#546e7a\" ],\r\n        [ \"#d32f2f\", \"#c2185b\", \"#7b1fa2\", \"#303f9f\", \"#1976d2\", \"#0097a7\", \"#00796b\", \"#388e3c\", \"#689f38\", \"#afb42b\", \"#fbc02d\", \"#ffa000\", \"#f57c00\", \"#e64a19\", \"#5d4037\", \"#616161\", \"#455a64\" ],\r\n        [ \"#c62828\", \"#ad1457\", \"#6a1b9a\", \"#283593\", \"#1565c0\", \"#00838f\", \"#00695c\", \"#2e7d32\", \"#558b2f\", \"#9e9d24\", \"#f9a825\", \"#ff8f00\", \"#ef6c00\", \"#d84315\", \"#4e342e\", \"#424242\", \"#37474f\" ],\r\n        [ \"#b71c1c\", \"#880e4f\", \"#4a148c\", \"#1a237e\", \"#0d47a1\", \"#006064\", \"#004d40\", \"#1b5e20\", \"#33691e\", \"#827717\", \"#f57f17\", \"#ff6f00\", \"#e65100\", \"#bf360c\", \"#3e2723\", \"#212121\", \"#263238\" ],\r\n    ];\r\n\r\n    palette.fire = [\r\n        [\"0b1a6d\",\"840f38\",\"b60718\",\"de030b\",\"ff0c0c\",\"fd491c\",\"fc7521\",\"faa331\",\"fbb535\",\"ffc73a\"],\r\n        [\"071147\",\"5f0b28\",\"930513\",\"be0309\",\"ef0000\",\"fa3403\",\"fb670b\",\"f9991b\",\"faad1e\",\"ffc123\"],\r\n        [\"03071e\",\"370617\",\"6a040f\",\"9d0208\",\"d00000\",\"dc2f02\",\"e85d04\",\"f48c06\",\"faa307\",\"ffba08\"],\r\n        [\"020619\",\"320615\",\"61040d\",\"8c0207\",\"bc0000\",\"c82a02\",\"d05203\",\"db7f06\",\"e19405\",\"efab00\"],\r\n        [\"020515\",\"2d0513\",\"58040c\",\"7f0206\",\"aa0000\",\"b62602\",\"b94903\",\"c57205\",\"ca8504\",\"d89b00\"],\r\n    ]\r\n\r\n    palette.baby = [\r\n        [\"eddcd2\",\"fff1e6\",\"fde2e4\",\"fad2e1\",\"c5dedd\",\"dbe7e4\",\"f0efeb\",\"d6e2e9\",\"bcd4e6\",\"99c1de\"],\r\n        [\"e1c4b3\",\"ffd5b5\",\"fab6ba\",\"f5a8c4\",\"aacecd\",\"bfd5cf\",\"dbd9d0\",\"baceda\",\"9dc0db\",\"7eb1d5\"],\r\n        [\"daa990\",\"ffb787\",\"f88e95\",\"f282a9\",\"8fc4c3\",\"a3c8be\",\"cec9b3\",\"9dbcce\",\"82acd2\",\"649dcb\"],\r\n        [\"d69070\",\"ff9c5e\",\"f66770\",\"f05f8f\",\"74bbb9\",\"87bfae\",\"c5b993\",\"83aac3\",\"699bca\",\"4d89c2\"],\r\n        [\"c97d5d\",\"f58443\",\"eb4d57\",\"e54a7b\",\"66a9a7\",\"78ae9c\",\"b5a67e\",\"7599b1\",\"5c88b7\",\"4978aa\"],\r\n    ]\r\n\r\n    if (palette[o]) {\r\n        return palette[o];\r\n    } else {\r\n        return palette.material;\r\n    }\r\n}\r\n\r\njSuites.picker = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.picker) {\r\n        return el.picker.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = { type: 'picker' };\r\n    obj.options = {};\r\n\r\n    var dropdownHeader = null;\r\n    var dropdownContent = null;\r\n\r\n    /**\r\n     * Create the content options\r\n     */\r\n    var createContent = function() {\r\n        dropdownContent.innerHTML = '';\r\n\r\n        // Create items\r\n        var keys = Object.keys(obj.options.data);\r\n\r\n        // Go though all options\r\n        for (var i = 0; i < keys.length; i++) {\r\n            // Item\r\n            var dropdownItem = document.createElement('div');\r\n            dropdownItem.classList.add('jpicker-item');\r\n            dropdownItem.k = keys[i];\r\n            dropdownItem.v = obj.options.data[keys[i]];\r\n            // Label\r\n            dropdownItem.innerHTML = obj.getLabel(keys[i]);\r\n            // Append\r\n            dropdownContent.appendChild(dropdownItem);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set or reset the options for the picker\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            value: 0,\r\n            data: null,\r\n            render: null,\r\n            onchange: null,\r\n            onselect: null,\r\n            onopen: null,\r\n            onclose: null,\r\n            onload: null,\r\n            width: null,\r\n            header: true,\r\n            right: false,\r\n            content: false,\r\n            columns: null,\r\n            height: null,\r\n        }\r\n\r\n        // Legacy purpose only\r\n        if (options && options.options) {\r\n            options.data = options.options;\r\n        }\r\n\r\n        // Loop through the initial configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Start using the options\r\n        if (obj.options.header === false) {\r\n            dropdownHeader.style.display = 'none';\r\n        } else {\r\n            dropdownHeader.style.display = '';\r\n        }\r\n\r\n        // Width\r\n        if (obj.options.width) {\r\n            dropdownHeader.style.width = parseInt(obj.options.width) + 'px';\r\n        } else {\r\n            dropdownHeader.style.width = '';\r\n        }\r\n\r\n        // Height\r\n        if (obj.options.height) {\r\n            dropdownContent.style.maxHeight = obj.options.height + 'px';\r\n            dropdownContent.style.overflow = 'scroll';\r\n        } else {\r\n            dropdownContent.style.overflow = '';\r\n        }\r\n\r\n        if (obj.options.columns > 0) {\r\n            dropdownContent.classList.add('jpicker-columns');\r\n            dropdownContent.style.width =  obj.options.width ? obj.options.width : 36 * obj.options.columns + 'px';\r\n        }\r\n\r\n        if (isNaN(obj.options.value)) {\r\n            obj.options.value = '0';\r\n        }\r\n\r\n        // Create list from data\r\n        createContent();\r\n\r\n        // Set value\r\n        obj.setValue(obj.options.value);\r\n\r\n        // Set options all returns the own instance\r\n        return obj;\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    obj.setValue = function(v) {\r\n        // Set label\r\n        obj.setLabel(v);\r\n\r\n        // Update value\r\n        obj.options.value = String(v);\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n\r\n        if (dropdownContent.children[v].getAttribute('type') !== 'generic') {\r\n            obj.close();\r\n        }\r\n    }\r\n\r\n    obj.getLabel = function(v) {\r\n        var label = obj.options.data[v] || null;\r\n        if (typeof(obj.options.render) == 'function') {\r\n            label = obj.options.render(label);\r\n        }\r\n        return label;\r\n    }\r\n\r\n    obj.setLabel = function(v) {\r\n        if (obj.options.content) {\r\n            var label = '<i class=\"material-icons\">' + obj.options.content + '</i>';\r\n        } else {\r\n            var label = obj.getLabel(v);\r\n        }\r\n\r\n        dropdownHeader.innerHTML = label;\r\n    }\r\n\r\n    obj.open = function() {\r\n        if (! el.classList.contains('jpicker-focus')) {\r\n            // Start tracking the element\r\n            jSuites.tracking(obj, true);\r\n\r\n            // Open picker\r\n            el.classList.add('jpicker-focus');\r\n            el.focus();\r\n\r\n            var rectHeader = dropdownHeader.getBoundingClientRect();\r\n            var rectContent = dropdownContent.getBoundingClientRect();\r\n            if (window.innerHeight < rectHeader.bottom + rectContent.height) {\r\n                dropdownContent.style.marginTop = -1 * (rectContent.height + 4) + 'px';\r\n            } else {\r\n                dropdownContent.style.marginTop = rectHeader.height + 2 + 'px';\r\n            }\r\n\r\n            if (obj.options.right === true) {\r\n                dropdownContent.style.marginLeft = -1 * rectContent.width + 24 + 'px';\r\n            }\r\n\r\n            if (typeof obj.options.onopen == 'function') {\r\n                obj.options.onopen(el, obj);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (el.classList.contains('jpicker-focus')) {\r\n            el.classList.remove('jpicker-focus');\r\n\r\n            // Start tracking the element\r\n            jSuites.tracking(obj, false);\r\n\r\n            if (typeof obj.options.onclose == 'function') {\r\n                obj.options.onclose(el, obj);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Create floating picker\r\n     */\r\n    var init = function() {\r\n        // Class\r\n        el.classList.add('jpicker');\r\n        el.setAttribute('tabindex', '900');\r\n        el.onmousedown = function(e) {\r\n            if (! el.classList.contains('jpicker-focus')) {\r\n                obj.open();\r\n            }\r\n        }\r\n\r\n        // Dropdown Header\r\n        dropdownHeader = document.createElement('div');\r\n        dropdownHeader.classList.add('jpicker-header');\r\n\r\n        // Dropdown content\r\n        dropdownContent = document.createElement('div');\r\n        dropdownContent.classList.add('jpicker-content');\r\n        dropdownContent.onclick = function(e) {\r\n            var item = jSuites.findElement(e.target, 'jpicker-item');\r\n            if (item) {\r\n                if (item.parentNode === dropdownContent) {\r\n                    // Update label\r\n                    obj.setValue(item.k);\r\n                    // Call method\r\n                    if (typeof(obj.options.onchange) == 'function') {\r\n                        obj.options.onchange.call(obj, el, obj, item.v, item.v, item.k);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Append content and header\r\n        el.appendChild(dropdownHeader);\r\n        el.appendChild(dropdownContent);\r\n\r\n        // Default value\r\n        el.value = options.value || 0;\r\n\r\n        // Set options\r\n        obj.setOptions(options);\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Reference\r\n        el.picker = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.progressbar = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        value: 0,\r\n        onchange: null,\r\n        width: null,\r\n    };\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jprogressbar');\r\n    el.setAttribute('tabindex', 1);\r\n    el.setAttribute('data-value', obj.options.value);\r\n\r\n    var bar = document.createElement('div');\r\n    bar.style.width = obj.options.value + '%';\r\n    bar.style.color = '#fff';\r\n    el.appendChild(bar);\r\n\r\n    if (obj.options.width) {\r\n        el.style.width = obj.options.width;\r\n    }\r\n\r\n    // Set value\r\n    obj.setValue = function(value) {\r\n        value = parseInt(value);\r\n        obj.options.value = value;\r\n        bar.style.width = value + '%';\r\n        el.setAttribute('data-value', value + '%');\r\n\r\n        if (value < 6) {\r\n            el.style.color = '#000';\r\n        } else {\r\n            el.style.color = '#fff';\r\n        }\r\n\r\n        // Update value\r\n        obj.options.value = value;\r\n\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, value);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var action = function(e) {\r\n        if (e.which) {\r\n            // Get target info\r\n            var rect = el.getBoundingClientRect();\r\n\r\n            if (e.changedTouches && e.changedTouches[0]) {\r\n                var x = e.changedTouches[0].clientX;\r\n                var y = e.changedTouches[0].clientY;\r\n            } else {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            }\r\n\r\n            obj.setValue(Math.round((x - rect.left) / rect.width * 100));\r\n        }\r\n    }\r\n\r\n    // Events\r\n    if ('touchstart' in document.documentElement === true) {\r\n        el.addEventListener('touchstart', action);\r\n        el.addEventListener('touchend', action);\r\n    } else {\r\n        el.addEventListener('mousedown', action);\r\n        el.addEventListener(\"mousemove\", action);\r\n    }\r\n\r\n    // Change\r\n    el.change = obj.setValue;\r\n\r\n    // Global generic value handler\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            return obj.getValue();\r\n        } else {\r\n            obj.setValue(val);\r\n        }\r\n    }\r\n\r\n    // Reference\r\n    el.progressbar = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.rating = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.rating) {\r\n        return el.rating.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            number: 5,\r\n            value: 0,\r\n            tooltip: [ 'Very bad', 'Bad', 'Average', 'Good', 'Very good' ],\r\n            onchange: null,\r\n        };\r\n\r\n        // Loop through the initial configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Make sure the container is empty\r\n        el.innerHTML = '';\r\n\r\n        // Add elements\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            var div = document.createElement('div');\r\n            div.setAttribute('data-index', (i + 1))\r\n            div.setAttribute('title', obj.options.tooltip[i])\r\n            el.appendChild(div);\r\n        }\r\n\r\n        // Selected option\r\n        if (obj.options.value) {\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                if (i < obj.options.value) {\r\n                    el.children[i].classList.add('jrating-selected');\r\n                }\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    // Set value\r\n    obj.setValue = function(index) {\r\n        for (var i = 0; i < obj.options.number; i++) {\r\n            if (i < index) {\r\n                el.children[i].classList.add('jrating-selected');\r\n            } else {\r\n                el.children[i].classList.remove('jrating-over');\r\n                el.children[i].classList.remove('jrating-selected');\r\n            }\r\n        }\r\n\r\n        obj.options.value = index;\r\n\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, index);\r\n        }\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.getValue = function() {\r\n        return obj.options.value;\r\n    }\r\n\r\n    var init = function() {\r\n        // Start plugin\r\n        obj.setOptions(options);\r\n\r\n        // Class\r\n        el.classList.add('jrating');\r\n\r\n        // Events\r\n        el.addEventListener(\"click\", function(e) {\r\n            var index = e.target.getAttribute('data-index');\r\n            if (index != undefined) {\r\n                if (index == obj.options.value) {\r\n                    obj.setValue(0);\r\n                } else {\r\n                    obj.setValue(index);\r\n                }\r\n            }\r\n        });\r\n\r\n        el.addEventListener(\"mouseover\", function(e) {\r\n            var index = e.target.getAttribute('data-index');\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                if (i < index) {\r\n                    el.children[i].classList.add('jrating-over');\r\n                } else {\r\n                    el.children[i].classList.remove('jrating-over');\r\n                }\r\n            }\r\n        });\r\n\r\n        el.addEventListener(\"mouseout\", function(e) {\r\n            for (var i = 0; i < obj.options.number; i++) {\r\n                el.children[i].classList.remove('jrating-over');\r\n            }\r\n        });\r\n\r\n        // Change\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        // Reference\r\n        el.rating = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\n\r\njSuites.search = (function(el, options) {\r\n    if (el.search) {\r\n        return el.search;\r\n    }\r\n\r\n    var index =  null;\r\n\r\n    var select = function(e) {\r\n        if (e.target.classList.contains('jsearch_item')) {\r\n            var element = e.target;\r\n        } else {\r\n            var element = e.target.parentNode;\r\n        }\r\n\r\n        obj.selectIndex(element);\r\n        e.preventDefault();\r\n    }\r\n\r\n    var createList = function(data) {\r\n        // Reset container\r\n        container.innerHTML = '';\r\n        // Print results\r\n        if (! data.length) {\r\n            // Show container\r\n            el.style.display = '';\r\n        } else {\r\n            // Show container\r\n            el.style.display = 'block';\r\n\r\n            // Show items (only 10)\r\n            var len = data.length < 11 ? data.length : 10;\r\n            for (var i = 0; i < len; i++) {\r\n                if (typeof(data[i]) == 'string') {\r\n                    var text = data[i];\r\n                    var value = data[i];\r\n                } else {\r\n                    // Legacy\r\n                    var text = data[i].text;\r\n                    if (! text && data[i].name) {\r\n                        text = data[i].name;\r\n                    }\r\n                    var value = data[i].value;\r\n                    if (! value && data[i].id) {\r\n                        value = data[i].id;\r\n                    }\r\n                }\r\n\r\n                var div = document.createElement('div');\r\n                div.setAttribute('data-value', value);\r\n                div.setAttribute('data-text', text);\r\n                div.className = 'jsearch_item';\r\n\r\n                if (data[i].id) {\r\n                    div.setAttribute('id', data[i].id)\r\n                }\r\n\r\n                if (obj.options.forceSelect && i == 0) {\r\n                    div.classList.add('selected');\r\n                }\r\n                var img = document.createElement('img');\r\n                if (data[i].image) {\r\n                    img.src = data[i].image;\r\n                } else {\r\n                    img.style.display = 'none';\r\n                }\r\n                div.appendChild(img);\r\n\r\n                var item = document.createElement('div');\r\n                item.innerHTML = text;\r\n                div.appendChild(item);\r\n\r\n                // Append item to the container\r\n                container.appendChild(div);\r\n            }\r\n        }\r\n    }\r\n\r\n    var execute = function(str) {\r\n        if (str != obj.terms) {\r\n            // New terms\r\n            obj.terms = str;\r\n            // New index\r\n            if (obj.options.forceSelect) {\r\n                index = 0;\r\n            } else {\r\n                index = null;\r\n            }\r\n            // Array or remote search\r\n            if (Array.isArray(obj.options.data)) {\r\n                var test = function(o) {\r\n                    if (typeof(o) == 'string') {\r\n                        if ((''+o).toLowerCase().search(str.toLowerCase()) >= 0) {\r\n                            return true;\r\n                        }\r\n                    } else {\r\n                        for (var key in o) {\r\n                            var value = o[key];\r\n                            if ((''+value).toLowerCase().search(str.toLowerCase()) >= 0) {\r\n                                return true;\r\n                            }\r\n                        }\r\n                    }\r\n                    return false;\r\n                }\r\n\r\n                var results = obj.options.data.filter(function(item) {\r\n                    return test(item);\r\n                });\r\n\r\n                // Show items\r\n                createList(results);\r\n            } else {\r\n                // Get remove results\r\n                jSuites.ajax({\r\n                    url: obj.options.data + str,\r\n                    method: 'GET',\r\n                    dataType: 'json',\r\n                    success: function(data) {\r\n                        // Show items\r\n                        createList(data);\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    // Search timer\r\n    var timer = null;\r\n\r\n    // Search methods\r\n    var obj = function(str) {\r\n        if (timer) {\r\n            clearTimeout(timer);\r\n        }\r\n        timer = setTimeout(function() {\r\n            execute(str);\r\n        }, 500);\r\n    }\r\n    if(options.forceSelect === null) {\r\n        options.forceSelect = true;\r\n    }\r\n    obj.options = {\r\n        data: options.data || null,\r\n        input: options.input || null,\r\n        onselect: options.onselect || null,\r\n        forceSelect: options.forceSelect,\r\n    };\r\n\r\n    obj.selectIndex = function(item) {\r\n        var id = item.getAttribute('id');\r\n        var text = item.getAttribute('data-text');\r\n        var value = item.getAttribute('data-value');\r\n        // Onselect\r\n        if (typeof(obj.options.onselect) == 'function') {\r\n            obj.options.onselect(obj, text, value, id);\r\n        }\r\n        // Close container\r\n        obj.close();\r\n    }\r\n\r\n    obj.open = function() {\r\n        el.style.display = 'block';\r\n    }\r\n\r\n    obj.close = function() {\r\n        if (timer) {\r\n            clearTimeout(timer);\r\n        }\r\n        // Current terms\r\n        obj.terms = '';\r\n        // Remove results\r\n        container.innerHTML = '';\r\n        // Hide\r\n        el.style.display = '';\r\n    }\r\n\r\n    obj.isOpened = function() {\r\n        return el.style.display ? true : false;\r\n    }\r\n\r\n    obj.keydown = function(e) {\r\n        if (obj.isOpened()) {\r\n            if (e.key == 'Enter') {\r\n                // Enter\r\n                if (index!==null && container.children[index]) {\r\n                    obj.selectIndex(container.children[index]);\r\n                    e.preventDefault();\r\n                } else {\r\n                    obj.close();\r\n                }\r\n            } else if (e.key === 'ArrowUp') {\r\n                // Up\r\n                if (index!==null && container.children[0]) {\r\n                    container.children[index].classList.remove('selected');\r\n                    if(!obj.options.forceSelect && index === 0) {\r\n                        index = null;\r\n                    } else {\r\n                        index = Math.max(0, index-1);\r\n                        container.children[index].classList.add('selected');\r\n                    }\r\n                }\r\n                e.preventDefault();\r\n            } else if (e.key === 'ArrowDown') {\r\n                // Down\r\n                if(index == null) {\r\n                    index = -1;\r\n                } else {\r\n                    container.children[index].classList.remove('selected');\r\n                }\r\n                if (index < 9 && container.children[index+1]) {\r\n                    index++;\r\n                }\r\n                container.children[index].classList.add('selected');\r\n                e.preventDefault();\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.keyup = function(e) {\r\n        if (obj.options.input) {\r\n            obj(obj.options.input.value);\r\n        } else {\r\n            // Current node\r\n            var node = jSuites.getNode();\r\n            if (node) {\r\n                obj(node.innerText);\r\n            }\r\n        }\r\n    }\r\n    \r\n    // Add events\r\n    if (obj.options.input) {\r\n        obj.options.input.addEventListener(\"keyup\", obj.keyup);\r\n        obj.options.input.addEventListener(\"keydown\", obj.keydown);\r\n    }\r\n\r\n    // Append element\r\n    var container = document.createElement('div');\r\n    container.classList.add('jsearch_container');\r\n    container.onmousedown = select;\r\n    el.appendChild(container);\r\n\r\n    el.classList.add('jsearch');\r\n    el.search = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\njSuites.slider = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n    obj.currentImage = null;\r\n\r\n    if (options) {\r\n        obj.options = options;\r\n    }\r\n\r\n    // Focus\r\n    el.setAttribute('tabindex', '900')\r\n\r\n    // Items\r\n    obj.options.items = [];\r\n\r\n    if (! el.classList.contains('jslider')) {\r\n        el.classList.add('jslider');\r\n        el.classList.add('unselectable');\r\n\r\n        if (obj.options.height) {\r\n            el.style.minHeight = obj.options.height;\r\n        }\r\n        if (obj.options.width) {\r\n            el.style.width = obj.options.width;\r\n        }\r\n        if (obj.options.grid) {\r\n            el.classList.add('jslider-grid');\r\n            var number = el.children.length;\r\n            if (number > 4) {\r\n                el.setAttribute('data-total', number - 4);\r\n            }\r\n            el.setAttribute('data-number', (number > 4 ? 4 : number));\r\n        }\r\n\r\n        // Add slider counter\r\n        var counter = document.createElement('div');\r\n        counter.classList.add('jslider-counter');\r\n\r\n        // Move children inside\r\n        if (el.children.length > 0) {\r\n            // Keep children items\r\n            for (var i = 0; i < el.children.length; i++) {\r\n                obj.options.items.push(el.children[i]);\r\n                \r\n                // counter click event\r\n                var item = document.createElement('div');\r\n                item.onclick = function() {\r\n                    var index = Array.prototype.slice.call(counter.children).indexOf(this);\r\n                    obj.show(obj.currentImage = obj.options.items[index]);\r\n                }\r\n                counter.appendChild(item);\r\n            }\r\n        }\r\n        // Add caption\r\n        var caption = document.createElement('div');\r\n        caption.className = 'jslider-caption';\r\n\r\n        // Add close buttom\r\n        var controls = document.createElement('div');\r\n        var close = document.createElement('div');\r\n        close.className = 'jslider-close';\r\n        close.innerHTML = '';\r\n        \r\n        close.onclick = function() {\r\n            obj.close();\r\n        }\r\n        controls.appendChild(caption);\r\n        controls.appendChild(close);\r\n    }\r\n\r\n    obj.updateCounter = function(index) {\r\n        for (var i = 0; i < counter.children.length; i ++) {\r\n            if (counter.children[i].classList.contains('jslider-counter-focus')) {\r\n                counter.children[i].classList.remove('jslider-counter-focus');\r\n                break;\r\n            }\r\n        }\r\n        counter.children[index].classList.add('jslider-counter-focus');\r\n    }\r\n\r\n    obj.show = function(target) {\r\n        if (! target) {\r\n            var target = el.children[0];\r\n        }\r\n\r\n        // Focus element\r\n        el.classList.add('jslider-focus');\r\n        el.classList.remove('jslider-grid');\r\n        el.appendChild(controls);\r\n        el.appendChild(counter);\r\n\r\n        // Update counter\r\n        var index = obj.options.items.indexOf(target);\r\n        obj.updateCounter(index);\r\n\r\n        // Remove display\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            el.children[i].style.display = '';\r\n        }\r\n        target.style.display = 'block';\r\n\r\n        // Is there any previous\r\n        if (target.previousElementSibling) {\r\n            el.classList.add('jslider-left');\r\n        } else {\r\n            el.classList.remove('jslider-left');\r\n        }\r\n\r\n        // Is there any next\r\n        if (target.nextElementSibling && target.nextElementSibling.tagName == 'IMG') {\r\n            el.classList.add('jslider-right');\r\n        } else {\r\n            el.classList.remove('jslider-right');\r\n        }\r\n\r\n        obj.currentImage = target;\r\n\r\n        // Vertical image\r\n        if (obj.currentImage.offsetHeight > obj.currentImage.offsetWidth) {\r\n            obj.currentImage.classList.add('jslider-vertical');\r\n        }\r\n\r\n        controls.children[0].innerText = obj.currentImage.getAttribute('title');\r\n    }\r\n\r\n    obj.open = function() {\r\n        obj.show();\r\n\r\n        // Event\r\n        if (typeof(obj.options.onopen) == 'function') {\r\n            obj.options.onopen(el);\r\n        }\r\n    }\r\n\r\n    obj.close = function() {\r\n        // Remove control classes\r\n        el.classList.remove('jslider-focus');\r\n        el.classList.remove('jslider-left');\r\n        el.classList.remove('jslider-right');\r\n        // Show as a grid depending on the configuration\r\n        if (obj.options.grid) {\r\n            el.classList.add('jslider-grid');\r\n        }\r\n        // Remove display\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            el.children[i].style.display = '';\r\n        }\r\n        // Remove controls from the component\r\n        counter.remove();\r\n        controls.remove();\r\n        // Current image\r\n        obj.currentImage = null;\r\n        // Event\r\n        if (typeof(obj.options.onclose) == 'function') {\r\n            obj.options.onclose(el);\r\n        }\r\n    }\r\n\r\n    obj.reset = function() {\r\n        el.innerHTML = '';\r\n    }\r\n\r\n    obj.next = function() {\r\n        var nextImage = obj.currentImage.nextElementSibling;\r\n        if (nextImage && nextImage.tagName === 'IMG') {\r\n            obj.show(obj.currentImage.nextElementSibling);\r\n        }\r\n    }\r\n    \r\n    obj.prev = function() {\r\n        if (obj.currentImage.previousElementSibling) {\r\n            obj.show(obj.currentImage.previousElementSibling);\r\n        }\r\n    }\r\n\r\n    var mouseUp = function(e) {\r\n        // Open slider\r\n        if (e.target.tagName == 'IMG') {\r\n            obj.show(e.target);\r\n        } else if (! e.target.classList.contains('jslider-close') && ! (e.target.parentNode.classList.contains('jslider-counter') || e.target.classList.contains('jslider-counter'))){\r\n            // Arrow controls\r\n            var offsetX = e.offsetX || e.changedTouches[0].clientX;\r\n            if (e.target.clientWidth - offsetX < 40) {\r\n                // Show next image\r\n                obj.next();\r\n            } else if (offsetX < 40) {\r\n                // Show previous image\r\n                obj.prev();\r\n            }\r\n        }\r\n    }\r\n\r\n    if ('ontouchend' in document.documentElement === true) {\r\n        el.addEventListener('touchend', mouseUp);\r\n    } else {\r\n        el.addEventListener('mouseup', mouseUp);\r\n    }\r\n\r\n    // Add global events\r\n    el.addEventListener(\"swipeleft\", function(e) {\r\n        obj.next();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    el.addEventListener(\"swiperight\", function(e) {\r\n        obj.prev();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    el.addEventListener('keydown', function(e) {\r\n        if (e.which == 27) {\r\n            obj.close();\r\n        }\r\n    });\r\n\r\n    el.slider = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.sorting = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    var defaults = {\r\n        pointer: null,\r\n        direction: null,\r\n        ondragstart: null,\r\n        ondragend: null,\r\n        ondrop: null,\r\n    }\r\n\r\n    var dragElement = null;\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    el.classList.add('jsorting');\r\n\r\n    el.addEventListener('dragstart', function(e) {\r\n        var position = Array.prototype.indexOf.call(e.target.parentNode.children, e.target);\r\n        dragElement = {\r\n            element: e.target,\r\n            o: position,\r\n            d: position\r\n        }\r\n        e.target.style.opacity = '0.25';\r\n\r\n        if (typeof(obj.options.ondragstart) == 'function') {\r\n            obj.options.ondragstart(el, e.target, e);\r\n        }\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (getElement(e.target) && dragElement) {\r\n            if (e.target.getAttribute('draggable') == 'true' && dragElement.element != e.target) {\r\n                if (! obj.options.direction) {\r\n                    var condition = e.target.clientHeight / 2 > e.offsetY;\r\n                } else {\r\n                    var condition = e.target.clientWidth / 2 > e.offsetX;\r\n                }\r\n\r\n                if (condition) {\r\n                    e.target.parentNode.insertBefore(dragElement.element, e.target);\r\n                } else {\r\n                    e.target.parentNode.insertBefore(dragElement.element, e.target.nextSibling);\r\n                }\r\n\r\n                dragElement.d = Array.prototype.indexOf.call(e.target.parentNode.children, dragElement.element);\r\n            }\r\n        }\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('dragend', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (dragElement) {\r\n            if (typeof(obj.options.ondragend) == 'function') {\r\n                obj.options.ondragend(el, dragElement.element, e);\r\n            }\r\n\r\n            // Cancelled put element to the original position\r\n            if (dragElement.o < dragElement.d) {\r\n                e.target.parentNode.insertBefore(dragElement.element, e.target.parentNode.children[dragElement.o]);\r\n            } else {\r\n                e.target.parentNode.insertBefore(dragElement.element, e.target.parentNode.children[dragElement.o].nextSibling);\r\n            }\r\n\r\n            dragElement.element.style.opacity = '';\r\n            dragElement = null;\r\n        }\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();\r\n\r\n        if (dragElement && (dragElement.o != dragElement.d)) {\r\n            if (typeof(obj.options.ondrop) == 'function') {\r\n                obj.options.ondrop(el, dragElement.o, dragElement.d, dragElement.element, e.target, e);\r\n            }\r\n        }\r\n\r\n        dragElement.element.style.opacity = '';\r\n        dragElement = null;\r\n    });\r\n\r\n    var getElement = function(element) {\r\n        var sorting = false;\r\n\r\n        function path (element) {\r\n            if (element.className) {\r\n                if (element.classList.contains('jsorting')) {\r\n                    sorting = true;\r\n                }\r\n            }\r\n\r\n            if (! sorting) {\r\n                path(element.parentNode);\r\n            }\r\n        }\r\n\r\n        path(element);\r\n\r\n        return sorting;\r\n    }\r\n\r\n    for (var i = 0; i < el.children.length; i++) {\r\n        if (! el.children[i].hasAttribute('draggable')) {\r\n            el.children[i].setAttribute('draggable', 'true');\r\n        }\r\n    }\r\n\r\n    el.val = function() {\r\n        var id = null;\r\n        var data = [];\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            if (id = el.children[i].getAttribute('data-id')) {\r\n                data.push(id);\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n    return el;\r\n});\r\n\r\njSuites.tabs = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        data: [],\r\n        position: null,\r\n        allowCreate: false,\r\n        allowChangePosition: false,\r\n        onclick: null,\r\n        onload: null,\r\n        onchange: null,\r\n        oncreate: null,\r\n        ondelete: null,\r\n        onbeforecreate: null,\r\n        onchangeposition: null,\r\n        animation: false,\r\n        hideHeaders: false,\r\n        padding: null,\r\n        palette: null,\r\n        maxWidth: null,\r\n    }\r\n\r\n    // Loop through the initial configuration\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Class\r\n    el.classList.add('jtabs');\r\n\r\n    var prev = null;\r\n    var next = null;\r\n    var border = null;\r\n\r\n    // Helpers\r\n    var setBorder = function(index) {\r\n        if (obj.options.animation) {\r\n            var rect = obj.headers.children[index].getBoundingClientRect();\r\n\r\n            if (obj.options.palette == 'modern') {\r\n                border.style.width = rect.width - 4 + 'px';\r\n                border.style.left = obj.headers.children[index].offsetLeft + 2 + 'px';\r\n            } else {\r\n                border.style.width = rect.width + 'px';\r\n                border.style.left = obj.headers.children[index].offsetLeft + 'px';\r\n            }\r\n\r\n            if (obj.options.position == 'bottom') {\r\n                border.style.top = '0px';\r\n            } else {\r\n                border.style.bottom = '0px';\r\n            }\r\n        }\r\n    }\r\n\r\n    var updateControls = function(x) {\r\n        if (typeof(obj.headers.scrollTo) == 'function') {\r\n            obj.headers.scrollTo({\r\n                left: x,\r\n                behavior: 'smooth',\r\n            });\r\n        } else {\r\n            obj.headers.scrollLeft = x;\r\n        }\r\n\r\n        if (x <= 1) {\r\n            prev.classList.add('disabled');\r\n        } else {\r\n            prev.classList.remove('disabled');\r\n        }\r\n\r\n        if (x >= obj.headers.scrollWidth - obj.headers.offsetWidth) {\r\n            next.classList.add('disabled');\r\n        } else {\r\n            next.classList.remove('disabled');\r\n        }\r\n\r\n        if (obj.headers.scrollWidth <= obj.headers.offsetWidth) {\r\n            prev.style.display = 'none';\r\n            next.style.display = 'none';\r\n        } else {\r\n            prev.style.display = '';\r\n            next.style.display = '';\r\n        }\r\n    }\r\n\r\n    obj.setBorder = setBorder;\r\n\r\n    // Set value\r\n    obj.open = function(index) {\r\n        var previous = null;\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            if (obj.headers.children[i].classList.contains('jtabs-selected')) {\r\n                // Current one\r\n                previous = i;\r\n            }\r\n            // Remote selected\r\n            obj.headers.children[i].classList.remove('jtabs-selected');\r\n            if (obj.content.children[i]) {\r\n                obj.content.children[i].classList.remove('jtabs-selected');\r\n            }\r\n        }\r\n\r\n        obj.headers.children[index].classList.add('jtabs-selected');\r\n        if (obj.content.children[index]) {\r\n            obj.content.children[index].classList.add('jtabs-selected');\r\n        }\r\n\r\n        if (previous != index && typeof(obj.options.onchange) == 'function') {\r\n            if (obj.content.children[index]) {\r\n                obj.options.onchange(el, obj, index, obj.headers.children[index], obj.content.children[index]);\r\n            }\r\n        }\r\n\r\n        // Hide\r\n        if (obj.options.hideHeaders == true && (obj.headers.children.length < 3 && obj.options.allowCreate == false)) {\r\n            obj.headers.parentNode.style.display = 'none';\r\n        } else {\r\n            // Set border\r\n            setBorder(index);\r\n\r\n            obj.headers.parentNode.style.display = '';\r\n\r\n            var x1 = obj.headers.children[index].offsetLeft;\r\n            var x2 = x1 + obj.headers.children[index].offsetWidth;\r\n            var r1 = obj.headers.scrollLeft;\r\n            var r2 = r1 + obj.headers.offsetWidth;\r\n\r\n            if (! (r1 <= x1 && r2 >= x2)) {\r\n                // Out of the viewport\r\n                updateControls(x1 - 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.selectIndex = function(a) {\r\n        var index = Array.prototype.indexOf.call(obj.headers.children, a);\r\n        if (index >= 0) {\r\n            obj.open(index);\r\n        }\r\n\r\n        return index;\r\n    }\r\n\r\n    obj.rename = function(i, title) {\r\n        if (! title) {\r\n            title = prompt('New title', obj.headers.children[i].innerText);\r\n        }\r\n        obj.headers.children[i].innerText = title;\r\n        obj.open(i);\r\n    }\r\n\r\n    obj.create = function(title, url) {\r\n        if (typeof(obj.options.onbeforecreate) == 'function') {\r\n            var ret = obj.options.onbeforecreate(el);\r\n            if (ret === false) {\r\n                return false;\r\n            } else {\r\n                title = ret;\r\n            }\r\n        }\r\n\r\n        var div = obj.appendElement(title);\r\n\r\n        if (typeof(obj.options.oncreate) == 'function') {\r\n            obj.options.oncreate(el, div)\r\n        }\r\n\r\n        return div;\r\n    }\r\n\r\n    obj.remove = function(index) {\r\n        return obj.deleteElement(index);\r\n    }\r\n\r\n    obj.nextNumber = function() {\r\n        var num = 0;\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            var tmp = obj.headers.children[i].innerText.match(/[0-9].*/);\r\n            if (tmp > num) {\r\n                num = parseInt(tmp);\r\n            }\r\n        }\r\n        if (! num) {\r\n            num = 1;\r\n        } else {\r\n            num++;\r\n        }\r\n\r\n        return num;\r\n    }\r\n\r\n    obj.deleteElement = function(index) {\r\n        if (! obj.headers.children[index]) {\r\n            return false;\r\n        } else {\r\n            obj.headers.removeChild(obj.headers.children[index]);\r\n            obj.content.removeChild(obj.content.children[index]);\r\n        }\r\n\r\n        obj.open(0);\r\n\r\n        if (typeof(obj.options.ondelete) == 'function') {\r\n            obj.options.ondelete(el, index)\r\n        }\r\n    }\r\n\r\n    obj.appendElement = function(title, cb) {\r\n        if (! title) {\r\n            var title = prompt('Title?', '');\r\n        }\r\n\r\n        if (title) {\r\n            // Add content\r\n            var div = document.createElement('div');\r\n            obj.content.appendChild(div);\r\n\r\n            // Add headers\r\n            var h = document.createElement('div');\r\n            h.innerHTML = title;\r\n            h.content = div;\r\n            obj.headers.insertBefore(h, obj.headers.lastChild);\r\n\r\n            // Sortable\r\n            if (obj.options.allowChangePosition) {\r\n                h.setAttribute('draggable', 'true');\r\n            }\r\n            // Open new tab\r\n            obj.selectIndex(h);\r\n\r\n            // Callback\r\n            if (typeof(cb) == 'function') {\r\n                cb(div, h);\r\n            }\r\n\r\n            // Return element\r\n            return div;\r\n        }\r\n    }\r\n\r\n    obj.getActive = function() {\r\n        for (var i = 0; i < obj.headers.children.length; i++) {\r\n            if (obj.headers.children[i].classList.contains('jtabs-selected')) {\r\n                return i\r\n            }\r\n        }\r\n        return 0;\r\n    }\r\n\r\n    obj.updateContent = function(position, newContent) {\r\n        if (typeof newContent !== 'string') {\r\n            var contentItem = newContent;\r\n        } else {\r\n            var contentItem = document.createElement('div');\r\n            contentItem.innerHTML = newContent;\r\n        }\r\n\r\n        if (obj.content.children[position].classList.contains('jtabs-selected')) {\r\n            newContent.classList.add('jtabs-selected');\r\n        }\r\n\r\n        obj.content.replaceChild(newContent, obj.content.children[position]);\r\n    }\r\n\r\n    obj.updatePosition = function(f, t) {\r\n        // Ondrop update position of content\r\n        if (f > t) {\r\n            obj.content.insertBefore(obj.content.children[f], obj.content.children[t]);\r\n        } else {\r\n            obj.content.insertBefore(obj.content.children[f], obj.content.children[t].nextSibling);\r\n        }\r\n\r\n        // Open destination tab\r\n        obj.open(t);\r\n\r\n        // Call event\r\n        if (typeof(obj.options.onchangeposition) == 'function') {\r\n            obj.options.onchangeposition(obj.headers, f, t);\r\n        }\r\n    }\r\n\r\n    obj.move = function(f, t) {\r\n        if (f > t) {\r\n            obj.headers.insertBefore(obj.headers.children[f], obj.headers.children[t]);\r\n        } else {\r\n            obj.headers.insertBefore(obj.headers.children[f], obj.headers.children[t].nextSibling);\r\n        }\r\n\r\n        obj.updatePosition(f, t);\r\n    }\r\n\r\n    obj.setBorder = setBorder;\r\n\r\n    obj.init = function() {\r\n        el.innerHTML = '';\r\n\r\n        // Make sure the component is blank\r\n        obj.headers = document.createElement('div');\r\n        obj.content = document.createElement('div');\r\n        obj.headers.classList.add('jtabs-headers');\r\n        obj.content.classList.add('jtabs-content');\r\n\r\n        if (obj.options.palette) {\r\n            el.classList.add('jtabs-modern');\r\n        } else {\r\n            el.classList.remove('jtabs-modern');\r\n        }\r\n\r\n        // Padding\r\n        if (obj.options.padding) {\r\n            obj.content.style.padding = parseInt(obj.options.padding) + 'px';\r\n        }\r\n\r\n        // Header\r\n        var header = document.createElement('div');\r\n        header.className = 'jtabs-headers-container';\r\n        header.appendChild(obj.headers);\r\n        if (obj.options.maxWidth) {\r\n            header.style.maxWidth = parseInt(obj.options.maxWidth) + 'px';\r\n        }\r\n\r\n        // Controls\r\n        var controls = document.createElement('div');\r\n        controls.className = 'jtabs-controls';\r\n        controls.setAttribute('draggable', 'false');\r\n        header.appendChild(controls);\r\n\r\n        // Append DOM elements\r\n        if (obj.options.position == 'bottom') {\r\n            el.appendChild(obj.content);\r\n            el.appendChild(header);\r\n        } else {\r\n            el.appendChild(header);\r\n            el.appendChild(obj.content);\r\n        }\r\n\r\n        // New button\r\n        if (obj.options.allowCreate == true) {\r\n            var add = document.createElement('div');\r\n            add.className = 'jtabs-add';\r\n            add.onclick = function() {\r\n                obj.create();\r\n            }\r\n            controls.appendChild(add);\r\n        }\r\n\r\n        prev = document.createElement('div');\r\n        prev.className = 'jtabs-prev';\r\n        prev.onclick = function() {\r\n            updateControls(obj.headers.scrollLeft - obj.headers.offsetWidth);\r\n        }\r\n        controls.appendChild(prev);\r\n\r\n        next = document.createElement('div');\r\n        next.className = 'jtabs-next';\r\n        next.onclick = function() {\r\n            updateControls(obj.headers.scrollLeft + obj.headers.offsetWidth);\r\n        }\r\n        controls.appendChild(next);\r\n\r\n        // Data\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            // Title\r\n            if (obj.options.data[i].titleElement) {\r\n                var headerItem = obj.options.data[i].titleElement;\r\n            } else {\r\n                var headerItem = document.createElement('div');\r\n            }\r\n            // Icon\r\n            if (obj.options.data[i].icon) {\r\n                var iconContainer = document.createElement('div');\r\n                var icon = document.createElement('i');\r\n                icon.classList.add('material-icons');\r\n                icon.innerHTML = obj.options.data[i].icon;\r\n                iconContainer.appendChild(icon);\r\n                headerItem.appendChild(iconContainer);\r\n            }\r\n            // Title\r\n            if (obj.options.data[i].title) {\r\n                var title = document.createTextNode(obj.options.data[i].title);\r\n                headerItem.appendChild(title);\r\n            }\r\n            // Width\r\n            if (obj.options.data[i].width) {\r\n                headerItem.style.width = obj.options.data[i].width;\r\n            }\r\n            // Content\r\n            if (obj.options.data[i].contentElement) {\r\n                var contentItem = obj.options.data[i].contentElement;\r\n            } else {\r\n                var contentItem = document.createElement('div');\r\n                contentItem.innerHTML = obj.options.data[i].content;\r\n            }\r\n            obj.headers.appendChild(headerItem);\r\n            obj.content.appendChild(contentItem);\r\n        }\r\n\r\n        // Animation\r\n        border = document.createElement('div');\r\n        border.className = 'jtabs-border';\r\n        obj.headers.appendChild(border);\r\n\r\n        if (obj.options.animation) {\r\n            el.classList.add('jtabs-animation');\r\n        }\r\n\r\n        // Events\r\n        obj.headers.addEventListener(\"click\", function(e) {\r\n            if (e.target.parentNode.classList.contains('jtabs-headers')) {\r\n                var target = e.target;\r\n            } else {\r\n                if (e.target.tagName == 'I') {\r\n                    var target = e.target.parentNode.parentNode;\r\n                } else {\r\n                    var target = e.target.parentNode;\r\n                }\r\n            }\r\n\r\n            var index = obj.selectIndex(target);\r\n\r\n            if (typeof(obj.options.onclick) == 'function') {\r\n                obj.options.onclick(el, obj, index, obj.headers.children[index], obj.content.children[index]);\r\n            }\r\n        });\r\n\r\n        obj.headers.addEventListener(\"contextmenu\", function(e) {\r\n            obj.selectIndex(e.target);\r\n        });\r\n\r\n        if (obj.headers.children.length) {\r\n            // Open first tab\r\n            obj.open(0);\r\n        }\r\n\r\n        // Update controls\r\n        updateControls(0);\r\n\r\n        if (obj.options.allowChangePosition == true) {\r\n            jSuites.sorting(obj.headers, {\r\n                direction: 1,\r\n                ondrop: function(a,b,c) {\r\n                    obj.updatePosition(b,c);\r\n                },\r\n            });\r\n        }\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n    }\r\n\r\n    // Loading existing nodes as the data\r\n    if (el.children[0] && el.children[0].children.length) {\r\n        // Create from existing elements\r\n        for (var i = 0; i < el.children[0].children.length; i++) {\r\n            var item = obj.options.data && obj.options.data[i] ? obj.options.data[i] : {};\r\n\r\n            if (el.children[1] && el.children[1].children[i]) {\r\n                item.titleElement = el.children[0].children[i];\r\n                item.contentElement = el.children[1].children[i];\r\n            } else {\r\n                item.contentElement = el.children[0].children[i];\r\n            }\r\n\r\n            obj.options.data[i] = item;\r\n        }\r\n    }\r\n\r\n    // Remote controller flag\r\n    var loadingRemoteData = false;\r\n\r\n    // Create from data\r\n    if (obj.options.data) {\r\n        // Append children\r\n        for (var i = 0; i < obj.options.data.length; i++) {\r\n            if (obj.options.data[i].url) {\r\n                jSuites.ajax({\r\n                    url: obj.options.data[i].url,\r\n                    type: 'GET',\r\n                    dataType: 'text/html',\r\n                    index: i,\r\n                    success: function(result) {\r\n                        obj.options.data[this.index].content = result;\r\n                    },\r\n                    complete: function() {\r\n                        obj.init();\r\n                    }\r\n                });\r\n\r\n                // Flag loading\r\n                loadingRemoteData = true;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (! loadingRemoteData) {\r\n        obj.init();\r\n    }\r\n\r\n    el.tabs = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.tags = (function(el, options) {\r\n    // Redefine configuration\r\n    if (el.tags) {\r\n        return el.tags.setOptions(options, true);\r\n    }\r\n\r\n    var obj = { type:'tags' };\r\n    obj.options = {};\r\n\r\n    // Limit\r\n    var limit = function() {\r\n        return obj.options.limit && el.children.length >= obj.options.limit ? true : false;\r\n    }\r\n\r\n    // Search helpers\r\n    var search = null;\r\n    var searchContainer = null;\r\n\r\n    obj.setOptions = function(options, reset) {\r\n        /**\r\n         * @typedef {Object} defaults\r\n         * @property {(string|Array)} value - Initial value of the compontent\r\n         * @property {number} limit - Max number of tags inside the element\r\n         * @property {string} search - The URL for suggestions\r\n         * @property {string} placeholder - The default instruction text on the element\r\n         * @property {validation} validation - Method to validate the tags\r\n         * @property {requestCallback} onbeforechange - Method to be execute before any changes on the element\r\n         * @property {requestCallback} onchange - Method to be execute after any changes on the element\r\n         * @property {requestCallback} onfocus - Method to be execute when on focus\r\n         * @property {requestCallback} onblur - Method to be execute when on blur\r\n         * @property {requestCallback} onload - Method to be execute when the element is loaded\r\n         */\r\n        var defaults = {\r\n            value: '',\r\n            limit: null,\r\n            limitMessage: null,\r\n            search: null,\r\n            placeholder: null,\r\n            validation: null,\r\n            onbeforechange: null,\r\n            onlimit: null,\r\n            onchange: null,\r\n            onfocus: null,\r\n            onblur: null,\r\n            onload: null,\r\n            colors: null,\r\n        }\r\n\r\n        // Loop through though the default configuration\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Placeholder\r\n        if (obj.options.placeholder) {\r\n            el.setAttribute('data-placeholder', obj.options.placeholder);\r\n        } else {\r\n            el.removeAttribute('data-placeholder');\r\n        }\r\n        el.placeholder = obj.options.placeholder;\r\n\r\n        // Update value\r\n        obj.setValue(obj.options.value);\r\n\r\n        // Validate items\r\n        filter();\r\n\r\n        // Create search box\r\n        if (obj.options.search) {\r\n            if (! searchContainer) {\r\n                searchContainer = document.createElement('div');\r\n                el.parentNode.insertBefore(searchContainer, el.nextSibling);\r\n\r\n                // Create container\r\n                search = jSuites.search(searchContainer, {\r\n                    data: obj.options.search,\r\n                    onselect: function(a,b,c) {\r\n                        obj.selectIndex(b,c);\r\n                    }\r\n                });\r\n            }\r\n        } else {\r\n            if (searchContainer) {\r\n                search = null;\r\n                searchContainer.remove();\r\n                searchContainer = null;\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Add a new tag to the element\r\n     * @param {(?string|Array)} value - The value of the new element\r\n     */\r\n    obj.add = function(value, focus) {\r\n        if (typeof(obj.options.onbeforechange) == 'function') {\r\n            var ret = obj.options.onbeforechange(el, obj, obj.options.value, value);\r\n            if (ret === false) {\r\n                return false;\r\n            } else { \r\n                if (ret != null) {\r\n                    value = ret;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Make sure search is closed\r\n        if (search) {\r\n            search.close();\r\n        }\r\n\r\n        if (limit()) {\r\n            if (typeof(obj.options.onlimit) == 'function') {\r\n                obj.options.onlimit(obj, obj.options.limit);\r\n            } else if (obj.options.limitMessage) {\r\n                alert(obj.options.limitMessage + ' ' + obj.options.limit);\r\n            }\r\n        } else {\r\n            // Get node\r\n            var node = jSuites.getNode();\r\n\r\n            if (node && node.parentNode && node.parentNode.classList.contains('jtags') &&\r\n                node.nextSibling && (! (node.nextSibling.innerText && node.nextSibling.innerText.trim()))) {\r\n                div = node.nextSibling;\r\n            } else {\r\n                // Remove not used last item\r\n                if (el.lastChild) {\r\n                    if (! el.lastChild.innerText.trim()) {\r\n                        el.removeChild(el.lastChild);\r\n                    }\r\n                }\r\n\r\n                // Mix argument string or array\r\n                if (! value || typeof(value) == 'string') {\r\n                    var div = createElement(value, value, node);\r\n                } else {\r\n                    for (var i = 0; i <= value.length; i++) {\r\n                        if (! limit()) {\r\n                            if (! value[i] || typeof(value[i]) == 'string') {\r\n                                var t = value[i] || '';\r\n                                var v = null;\r\n                            } else {\r\n                                var t = value[i].text;\r\n                                var v = value[i].value;\r\n                            }\r\n\r\n                            // Add element\r\n                            var div = createElement(t, v);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Change\r\n                change();\r\n            }\r\n\r\n            // Place caret\r\n            if (focus) {\r\n                setFocus(div);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.setLimit = function(limit) {\r\n        obj.options.limit = limit;\r\n        var n = el.children.length - limit;\r\n        while (el.children.length > limit) {\r\n            el.removeChild(el.lastChild);\r\n        }\r\n    }\r\n\r\n    // Remove a item node\r\n    obj.remove = function(node) {\r\n        // Remove node\r\n        node.parentNode.removeChild(node);\r\n        // Make sure element is not blank\r\n        if (! el.children.length) {\r\n            obj.add('', true);\r\n        } else {\r\n            change();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get all tags in the element\r\n     * @return {Array} data - All tags as an array\r\n     */\r\n    obj.getData = function() {\r\n        var data = [];\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            // Get value\r\n            var text = el.children[i].innerText.replace(\"\\n\", \"\");\r\n            // Get id\r\n            var value = el.children[i].getAttribute('data-value');\r\n            if (! value) {\r\n                value = text;\r\n            }\r\n            // Item\r\n            if (text || value) {\r\n                data.push({ text: text, value: value });\r\n            }\r\n        }\r\n        return data;\r\n    }\r\n\r\n    /**\r\n     * Get the value of one tag. Null for all tags\r\n     * @param {?number} index - Tag index number. Null for all tags.\r\n     * @return {string} value - All tags separated by comma\r\n     */\r\n    obj.getValue = function(index) {\r\n        var value = null;\r\n\r\n        if (index != null) {\r\n            // Get one individual value\r\n            value = el.children[index].getAttribute('data-value');\r\n            if (! value) {\r\n                value = el.children[index].innerText.replace(\"\\n\", \"\");\r\n            }\r\n        } else {\r\n            // Get all\r\n            var data = [];\r\n            for (var i = 0; i < el.children.length; i++) {\r\n                value = el.children[i].innerText.replace(\"\\n\", \"\");\r\n                if (value) {\r\n                    data.push(obj.getValue(i));\r\n                }\r\n            }\r\n            value = data.join(',');\r\n        }\r\n\r\n        return value;\r\n    }\r\n\r\n    /**\r\n     * Set the value of the element based on a string separeted by (,|;|\\r\\n)\r\n     * @param {mixed} value - A string or array object with values\r\n     */\r\n    obj.setValue = function(mixed) {\r\n        if (! mixed) {\r\n            obj.reset();\r\n        } else {\r\n            if (el.value != mixed) {\r\n                if (Array.isArray(mixed)) {\r\n                    obj.add(mixed);\r\n                } else {\r\n                    // Remove whitespaces\r\n                    var text = (''+mixed).trim();\r\n                    // Tags\r\n                    var data = extractTags(text);\r\n                    // Reset\r\n                    el.innerHTML = '';\r\n                    // Add tags to the element\r\n                    obj.add(data);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reset the data from the element\r\n     */\r\n    obj.reset = function() {\r\n        // Empty class\r\n        el.classList.add('jtags-empty');\r\n        // Empty element\r\n        el.innerHTML = '<div></div>';\r\n        // Execute changes\r\n        change();\r\n    }\r\n\r\n    /**\r\n     * Verify if all tags in the element are valid\r\n     * @return {boolean}\r\n     */\r\n    obj.isValid = function() {\r\n        var test = 0;\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            if (el.children[i].classList.contains('jtags_error')) {\r\n                test++;\r\n            }\r\n        }\r\n        return test == 0 ? true : false;\r\n    }\r\n\r\n    /**\r\n     * Add one element from the suggestions to the element\r\n     * @param {object} item - Node element in the suggestions container\r\n     */ \r\n    obj.selectIndex = function(text, value) {\r\n        var node = jSuites.getNode();\r\n        if (node) {\r\n            // Append text to the caret\r\n            node.innerText = text;\r\n            // Set node id\r\n            if (value) {\r\n                node.setAttribute('data-value', value);\r\n            }\r\n            // Remove any error\r\n            node.classList.remove('jtags_error');\r\n            if (! limit()) {\r\n                // Add new item\r\n                obj.add('', true);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Search for suggestions\r\n     * @param {object} node - Target node for any suggestions\r\n     */\r\n    obj.search = function(node) {\r\n        // Search for\r\n        var terms = node.innerText;\r\n    }\r\n\r\n    // Destroy tags element\r\n    obj.destroy = function() {\r\n        // Bind events\r\n        el.removeEventListener('mouseup', tagsMouseUp);\r\n        el.removeEventListener('keydown', tagsKeyDown);\r\n        el.removeEventListener('keyup', tagsKeyUp);\r\n        el.removeEventListener('paste', tagsPaste);\r\n        el.removeEventListener('focus', tagsFocus);\r\n        el.removeEventListener('blur', tagsBlur);\r\n\r\n        // Remove element\r\n        el.parentNode.removeChild(el);\r\n    }\r\n\r\n    var setFocus = function(node) {\r\n        if (el.children.length > 1) {\r\n            var range = document.createRange();\r\n            var sel = window.getSelection();\r\n            if (! node) {\r\n                var node = el.childNodes[el.childNodes.length-1];\r\n            }\r\n            range.setStart(node, node.length)\r\n            range.collapse(true)\r\n            sel.removeAllRanges()\r\n            sel.addRange(range)\r\n            el.scrollLeft = el.scrollWidth;\r\n        }\r\n    }\r\n\r\n    var createElement = function(label, value, node) {\r\n        var div = document.createElement('div');\r\n        div.innerHTML = label ? label : '';\r\n        if (value) {\r\n            div.setAttribute('data-value', value);\r\n        }\r\n\r\n        if (node && node.parentNode.classList.contains('jtags')) {\r\n            el.insertBefore(div, node.nextSibling);\r\n        } else {\r\n            el.appendChild(div);\r\n        }\r\n\r\n        return div;\r\n    }\r\n\r\n    var change = function() {\r\n        // Value\r\n        var value = obj.getValue();\r\n\r\n        if (value != obj.options.value) {\r\n            obj.options.value = value;\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, obj, obj.options.value);\r\n            }\r\n\r\n            // Lemonade JS\r\n            if (el.value != obj.options.value) {\r\n                el.value = obj.options.value;\r\n                if (typeof(el.onchange) == 'function') {\r\n                    el.onchange({\r\n                        type: 'change',\r\n                        target: el,\r\n                        value: el.value\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        filter();\r\n    }\r\n\r\n    /**\r\n     * Filter tags\r\n     */\r\n    var filter = function() {\r\n        for (var i = 0; i < el.children.length; i++) {\r\n            // Create label design\r\n            if (! obj.getValue(i)) {\r\n                el.children[i].classList.remove('jtags_label');\r\n            } else {\r\n                el.children[i].classList.add('jtags_label');\r\n\r\n                // Validation in place\r\n                if (typeof(obj.options.validation) == 'function') {\r\n                    if (obj.getValue(i)) {\r\n                        if (! obj.options.validation(el.children[i], el.children[i].innerText, el.children[i].getAttribute('data-value'))) {\r\n                            el.children[i].classList.add('jtags_error');\r\n                        } else {\r\n                            el.children[i].classList.remove('jtags_error');\r\n                        }\r\n                    } else {\r\n                        el.children[i].classList.remove('jtags_error');\r\n                    }\r\n                } else {\r\n                    el.children[i].classList.remove('jtags_error');\r\n                }\r\n            }\r\n        }\r\n\r\n        isEmpty();\r\n    }\r\n\r\n    var isEmpty = function() {\r\n        // Can't be empty\r\n        if (! el.innerText.trim()) {\r\n            el.innerHTML = '<div></div>';\r\n            el.classList.add('jtags-empty');\r\n        } else {\r\n            el.classList.remove('jtags-empty');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract tags from a string\r\n     * @param {string} text - Raw string\r\n     * @return {Array} data - Array with extracted tags\r\n     */\r\n    var extractTags = function(text) {\r\n        /** @type {Array} */\r\n        var data = [];\r\n\r\n        /** @type {string} */\r\n        var word = '';\r\n\r\n        // Remove whitespaces\r\n        text = text.trim();\r\n\r\n        if (text) {\r\n            for (var i = 0; i < text.length; i++) {\r\n                if (text[i] == ',' || text[i] == ';' || text[i] == '\\n') {\r\n                    if (word) {\r\n                        data.push(word.trim());\r\n                        word = '';\r\n                    }\r\n                } else {\r\n                    word += text[i];\r\n                }\r\n            }\r\n\r\n            if (word) {\r\n                data.push(word);\r\n            }\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    /** @type {number} */\r\n    var anchorOffset = 0;\r\n\r\n    /**\r\n     * Processing event keydown on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsKeyDown = function(e) {\r\n        // Anchoroffset\r\n        anchorOffset = window.getSelection().anchorOffset;\r\n\r\n        // Verify if is empty\r\n        isEmpty();\r\n\r\n        // Comma\r\n        if (e.key === 'Tab'  || e.key === ';' || e.key === ',') {\r\n            var n = window.getSelection().anchorOffset;\r\n            if (n > 1) {\r\n                if (limit()) {\r\n                    if (typeof(obj.options.onlimit) == 'function') {\r\n                        obj.options.onlimit(obj, obj.options.limit)\r\n                    }\r\n                } else {\r\n                    obj.add('', true);\r\n                }\r\n            }\r\n            e.preventDefault();\r\n        } else if (e.key == 'Enter') {\r\n            if (! search || ! search.isOpened()) {\r\n                var n = window.getSelection().anchorOffset;\r\n                if (n > 1) {\r\n                    if (! limit()) {\r\n                        obj.add('', true);\r\n                    }\r\n                }\r\n                e.preventDefault();\r\n            }\r\n        } else if (e.key == 'Backspace') {\r\n            // Back space - do not let last item to be removed\r\n            if (el.children.length == 1 && window.getSelection().anchorOffset < 1) {\r\n                e.preventDefault();\r\n            }\r\n        }\r\n\r\n        // Search events\r\n        if (search) {\r\n            search.keydown(e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event keyup on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsKeyUp = function(e) {\r\n        if (e.which == 39) {\r\n            // Right arrow\r\n            var n = window.getSelection().anchorOffset;\r\n            if (n > 1 && n == anchorOffset) {\r\n                obj.add('', true);\r\n            }\r\n        } else if (e.which == 13 || e.which == 38 || e.which == 40) {\r\n            e.preventDefault();\r\n        } else {\r\n            if (search) {\r\n                search.keyup(e);\r\n            }\r\n        }\r\n\r\n        filter();\r\n    }\r\n\r\n    /**\r\n     * Processing event paste on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsPaste =  function(e) {\r\n        if (e.clipboardData || e.originalEvent.clipboardData) {\r\n            var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n        } else if (window.clipboardData) {\r\n            var text = window.clipboardData.getData('Text');\r\n        }\r\n\r\n        var data = extractTags(text);\r\n        if (data.length > 1) {\r\n            obj.add(data, true);\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Processing event mouseup on the element\r\n     * @param e {object}\r\n     */\r\n    var tagsMouseUp = function(e) {\r\n        if (e.target.parentNode && e.target.parentNode.classList.contains('jtags')) {\r\n            if (e.target.classList.contains('jtags_label') || e.target.classList.contains('jtags_error')) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                if (rect.width - (e.clientX - rect.left) < 16) {\r\n                    obj.remove(e.target);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Set focus in the last item\r\n        if (e.target == el) {\r\n            setFocus();\r\n        }\r\n    }\r\n\r\n    var tagsFocus = function() {\r\n        if (! el.classList.contains('jtags-focus')) {\r\n            if (! el.children.length || obj.getValue(el.children.length - 1)) {\r\n                if (! limit()) {\r\n                    createElement('');\r\n                }\r\n            }\r\n\r\n            if (typeof(obj.options.onfocus) == 'function') {\r\n                obj.options.onfocus(el, obj, obj.getValue());\r\n            }\r\n\r\n            el.classList.add('jtags-focus');\r\n        }\r\n    }\r\n\r\n    var tagsBlur = function() {\r\n        if (el.classList.contains('jtags-focus')) {\r\n            if (search) {\r\n                search.close();\r\n            }\r\n\r\n            for (var i = 0; i < el.children.length - 1; i++) {\r\n                // Create label design\r\n                if (! obj.getValue(i)) {\r\n                    el.removeChild(el.children[i]);\r\n                }\r\n            }\r\n\r\n            change();\r\n\r\n            el.classList.remove('jtags-focus');\r\n\r\n            if (typeof(obj.options.onblur) == 'function') {\r\n                obj.options.onblur(el, obj, obj.getValue());\r\n            }\r\n        }\r\n    }\r\n\r\n    var init = function() {\r\n        // Bind events\r\n        if ('touchend' in document.documentElement === true) {\r\n            el.addEventListener('touchend', tagsMouseUp);\r\n        } else {\r\n            el.addEventListener('mouseup', tagsMouseUp);\r\n        }\r\n\r\n        el.addEventListener('keydown', tagsKeyDown);\r\n        el.addEventListener('keyup', tagsKeyUp);\r\n        el.addEventListener('paste', tagsPaste);\r\n        el.addEventListener('focus', tagsFocus);\r\n        el.addEventListener('blur', tagsBlur);\r\n\r\n        // Editable\r\n        el.setAttribute('contenteditable', true);\r\n\r\n        // Prepare container\r\n        el.classList.add('jtags');\r\n\r\n        // Initial options\r\n        obj.setOptions(options);\r\n\r\n        if (typeof(obj.options.onload) == 'function') {\r\n            obj.options.onload(el, obj);\r\n        }\r\n\r\n        // Change methods\r\n        el.change = obj.setValue;\r\n\r\n        // Global generic value handler\r\n        el.val = function(val) {\r\n            if (val === undefined) {\r\n                return obj.getValue();\r\n            } else {\r\n                obj.setValue(val);\r\n            }\r\n        }\r\n\r\n        el.tags = obj;\r\n    }\r\n\r\n    init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.toolbar = (function(el, options) {\r\n    // New instance\r\n    var obj = { type:'toolbar' };\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        app: null,\r\n        container: false,\r\n        badge: false,\r\n        title: false,\r\n        responsive: false,\r\n        maxWidth: null,\r\n        items: [],\r\n    }\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    if (! el && options.app && options.app.el) {\r\n        el = document.createElement('div');\r\n        options.app.el.appendChild(el);\r\n    }\r\n\r\n    // Arrow\r\n    var toolbarArrow = document.createElement('div');\r\n    toolbarArrow.classList.add('jtoolbar-item');\r\n    toolbarArrow.classList.add('jtoolbar-arrow');\r\n\r\n    var toolbarFloating = document.createElement('div');\r\n    toolbarFloating.classList.add('jtoolbar-floating');\r\n    toolbarArrow.appendChild(toolbarFloating);\r\n\r\n    obj.selectItem = function(element) {\r\n        var elements = toolbarContent.children;\r\n        for (var i = 0; i < elements.length; i++) {\r\n            if (element != elements[i]) {\r\n                elements[i].classList.remove('jtoolbar-selected');\r\n            }\r\n        }\r\n        element.classList.add('jtoolbar-selected');\r\n    }\r\n\r\n    obj.hide = function() {\r\n        jSuites.animation.slideBottom(el, 0, function() {\r\n            el.style.display = 'none';\r\n        });\r\n    }\r\n\r\n    obj.show = function() {\r\n        el.style.display = '';\r\n        jSuites.animation.slideBottom(el, 1);\r\n    }\r\n\r\n    obj.get = function() {\r\n        return el;\r\n    }\r\n\r\n    obj.setBadge = function(index, value) {\r\n        toolbarContent.children[index].children[1].firstChild.innerHTML = value;\r\n    }\r\n\r\n    obj.destroy = function() {\r\n        toolbar.remove();\r\n        el.innerHTML = '';\r\n    }\r\n\r\n    obj.update = function(a, b) {\r\n        for (var i = 0; i < toolbarContent.children.length; i++) {\r\n            // Toolbar element\r\n            var toolbarItem = toolbarContent.children[i];\r\n            // State management\r\n            if (typeof(toolbarItem.updateState) == 'function') {\r\n                toolbarItem.updateState(el, obj, toolbarItem, a, b);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.create = function(items) {\r\n        // Reset anything in the toolbar\r\n        toolbarContent.innerHTML = '';\r\n        // Create elements in the toolbar\r\n        for (var i = 0; i < items.length; i++) {\r\n            var toolbarItem = document.createElement('div');\r\n            toolbarItem.classList.add('jtoolbar-item');\r\n\r\n            if (items[i].width) {\r\n                toolbarItem.style.width = parseInt(items[i].width) + 'px'; \r\n            }\r\n\r\n            if (items[i].k) {\r\n                toolbarItem.k = items[i].k;\r\n            }\r\n\r\n            if (items[i].tooltip) {\r\n                toolbarItem.setAttribute('title', items[i].tooltip);\r\n            }\r\n\r\n            // Id\r\n            if (items[i].id) {\r\n                toolbarItem.setAttribute('id', items[i].id);\r\n            }\r\n\r\n            // Selected\r\n            if (items[i].updateState) {\r\n                toolbarItem.updateState = items[i].updateState;\r\n            }\r\n\r\n            if (items[i].active) {\r\n                toolbarItem.classList.add('jtoolbar-active');\r\n            }\r\n\r\n            if (items[i].type == 'select' || items[i].type == 'dropdown') {\r\n                jSuites.picker(toolbarItem, items[i]);\r\n            } else if (items[i].type == 'divisor') {\r\n                toolbarItem.classList.add('jtoolbar-divisor');\r\n            } else if (items[i].type == 'label') {\r\n                toolbarItem.classList.add('jtoolbar-label');\r\n                toolbarItem.innerHTML = items[i].content;\r\n            } else {\r\n                // Material icons\r\n                var toolbarIcon = document.createElement('i');\r\n                if (typeof(items[i].class) === 'undefined') {\r\n                    toolbarIcon.classList.add('material-icons');\r\n                } else {\r\n                    var c = items[i].class.split(' ');\r\n                    for (var j = 0; j < c.length; j++) {\r\n                        toolbarIcon.classList.add(c[j]);\r\n                    }\r\n                }\r\n                toolbarIcon.innerHTML = items[i].content ? items[i].content : '';\r\n                toolbarItem.appendChild(toolbarIcon);\r\n\r\n                // Badge options\r\n                if (obj.options.badge == true) {\r\n                    var toolbarBadge = document.createElement('div');\r\n                    toolbarBadge.classList.add('jbadge');\r\n                    var toolbarBadgeContent = document.createElement('div');\r\n                    toolbarBadgeContent.innerHTML = items[i].badge ? items[i].badge : '';\r\n                    toolbarBadge.appendChild(toolbarBadgeContent);\r\n                    toolbarItem.appendChild(toolbarBadge);\r\n                }\r\n\r\n                // Title\r\n                if (items[i].title) {\r\n                    if (obj.options.title == true) {\r\n                        var toolbarTitle = document.createElement('span');\r\n                        toolbarTitle.innerHTML = items[i].title;\r\n                        toolbarItem.appendChild(toolbarTitle);\r\n                    } else {\r\n                        toolbarItem.setAttribute('title', items[i].title);\r\n                    }\r\n                }\r\n\r\n                if (obj.options.app && items[i].route) {\r\n                    // Route\r\n                    toolbarItem.route = items[i].route;\r\n                    // Onclick for route\r\n                    toolbarItem.onclick = function() {\r\n                        obj.options.app.pages(this.route);\r\n                    }\r\n                    // Create pages\r\n                    obj.options.app.pages(items[i].route, {\r\n                        toolbarItem: toolbarItem,\r\n                        closed: true\r\n                    });\r\n                }\r\n            }\r\n\r\n            if (items[i].onclick) {\r\n                toolbarItem.onclick = items[i].onclick.bind(items[i], el, obj, toolbarItem);\r\n            }\r\n\r\n            toolbarContent.appendChild(toolbarItem);\r\n        }\r\n\r\n        // Fits to the page\r\n        obj.refresh();\r\n    }\r\n\r\n    obj.open = function() {\r\n        toolbarArrow.classList.add('jtoolbar-arrow-selected');\r\n\r\n        var rect = toolbarFloating.getBoundingClientRect();\r\n        if (rect.bottom > window.innerHeight) {\r\n            toolbarFloating.style.bottom = '0';\r\n        } else {\r\n            toolbarFloating.style.removeProperty('bottom');\r\n        }\r\n\r\n        toolbarFloating.style.right = '0';\r\n\r\n        toolbarArrow.children[0].focus();\r\n        // Start tracking\r\n        jSuites.tracking(obj, true);\r\n    }\r\n\r\n    obj.close = function() {\r\n        toolbarArrow.classList.remove('jtoolbar-arrow-selected')\r\n        // End tracking\r\n        jSuites.tracking(obj, false);\r\n    }\r\n\r\n    obj.refresh = function() {\r\n        if (obj.options.responsive == true) {\r\n            // Width of the c\r\n            var rect = el.parentNode.getBoundingClientRect();\r\n            if (! obj.options.maxWidth) {\r\n                obj.options.maxWidth = rect.width;\r\n            }\r\n            // Max width\r\n            var width = parseInt(obj.options.maxWidth); \r\n            // Remove arrow\r\n            toolbarArrow.remove();\r\n            // Move all items to the toolbar\r\n            while (toolbarFloating.firstChild) {\r\n                toolbarContent.appendChild(toolbarFloating.firstChild);\r\n            }\r\n            // Available parent space\r\n            var available = obj.options.maxWidth;\r\n            // Toolbar is larger than the parent, move elements to the floating element\r\n            if (available < toolbarContent.offsetWidth) {\r\n                // Give space to the floating element\r\n                available -= 50;\r\n                // Move to the floating option\r\n                while (toolbarContent.lastChild && available < toolbarContent.offsetWidth) {\r\n                    toolbarFloating.insertBefore(toolbarContent.lastChild, toolbarFloating.firstChild);\r\n                }\r\n            }\r\n            // Show arrow\r\n            if (toolbarFloating.children.length > 0) {\r\n                toolbarContent.appendChild(toolbarArrow);\r\n            }\r\n        }\r\n    }\r\n\r\n    el.onclick = function(e) {\r\n        var element = jSuites.findElement(e.target, 'jtoolbar-item');\r\n        if (element) {\r\n            obj.selectItem(element);\r\n        }\r\n\r\n        if (e.target.classList.contains('jtoolbar-arrow')) {\r\n            obj.open();\r\n        }\r\n    }\r\n\r\n    window.addEventListener('resize', function() {\r\n        obj.refresh();\r\n    });\r\n\r\n    // Toolbar\r\n    el.classList.add('jtoolbar');\r\n    // Reset content\r\n    el.innerHTML = '';\r\n    // Container\r\n    if (obj.options.container == true) {\r\n        el.classList.add('jtoolbar-container');\r\n    }\r\n    // Content\r\n    var toolbarContent = document.createElement('div');\r\n    el.appendChild(toolbarContent);\r\n    // Special toolbar for mobile applications\r\n    if (obj.options.app) {\r\n        el.classList.add('jtoolbar-mobile');\r\n    }\r\n    // Create toolbar\r\n    obj.create(obj.options.items);\r\n    // Shortcut\r\n    el.toolbar = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.validations = function(value, options) {\r\n    if (typeof(jSuites.validations[options.type]) === 'function') {\r\n        return jSuites.validations[options.type](value, options);\r\n    }\r\n    return null;\r\n};\r\n\r\n// Legacy\r\njSuites.validations.email = function(data) {\r\n    var pattern = new RegExp(/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/);\r\n    return data && pattern.test(data) ? true : false; \r\n}\r\n\r\njSuites.validations.required = function(data) {\r\n    return data.trim() ? true : false;\r\n}\r\n\r\njSuites.validations.number = function(data) {\r\n    return jSuites.isNumber(data);\r\n}\r\n\r\njSuites.validations.login = function(data) {\r\n    var pattern = new RegExp(/^[a-zA-Z0-9\\_\\-\\.\\s+]+$/);\r\n    return data && pattern.test(data) ? true : false;\r\n}\r\n\r\n/**\r\n * Options: Object,\r\n * Properties: \r\n * Constraint,\r\n * Reference,\r\n * Value\r\n */\r\n\r\nvar valueComparisons = function(data, options) {\r\n    if (options.constraint === '=') {\r\n        return data === options.reference;\r\n    }\r\n    if (options.constraint === '<') {\r\n        return data < options.reference;\r\n    }\r\n    if (options.constraint === '<=') {\r\n        return data <= options.reference;\r\n    }\r\n    if (options.constraint === '>') {\r\n        return data > options.reference;\r\n    }\r\n    if (options.constraint === '>=') {\r\n        return data >= options.reference;\r\n    }\r\n    if (options.constraint === 'between') {\r\n        return data >= options.reference[0] && data <= options.reference[1];\r\n    }\r\n    if (options.constraint === 'not between') {\r\n        return data < options.reference[0] || data > options.reference[1];\r\n    }\r\n\r\n    return null;\r\n}\r\n\r\njSuites.validations.number = function(data, options) {\r\n    if (!jSuites.isNumeric(data)) {\r\n        return false;\r\n    }\r\n\r\n    if (options === undefined || options.constraint === undefined) {\r\n        return true;\r\n    }\r\n\r\n    return valueComparisons(data, options);\r\n}\r\n\r\njSuites.validations.date = function(data, options) {\r\n    if (new Date(data) == 'Invalid Date') {\r\n        return false;\r\n    }\r\n\r\n    if (options === undefined || options.constraint === undefined) {\r\n        return true;\r\n    } else if (typeof(options) === 'object') {\r\n        data = new Date(data).getTime();\r\n\r\n        if (Array.isArray(options.reference)) {\r\n            options.reference = options.reference.map(function(reference) {\r\n                return new Date(reference).getTime();\r\n            });\r\n        } else {\r\n            options.reference = new Date(options.reference).getTime();\r\n        }\r\n\r\n        return valueComparisons(data, options);\r\n    }\r\n    return null;\r\n}\r\n\r\njSuites.validations.itemList = function(data, options) {\r\n    return options.reference.some(function(reference) {\r\n        return reference == data;\r\n    });\r\n}\r\n\r\njSuites.validations.text = function(data, options) {\r\n    if (typeof data !== 'string') {\r\n        return false;\r\n    }\r\n\r\n    if (options === undefined || options.constraint === undefined) {\r\n        return true;\r\n    }\r\n    if (options.constraint === '=') {\r\n        return data === options.reference;\r\n    }\r\n    if (options.constraint === 'contains') {\r\n        return data.includes(options.reference);\r\n    }\r\n    if (options.constraint === 'not contain') {\r\n        return !data.includes(options.reference);\r\n    }\r\n    if (options.constraint === 'email') {\r\n        return jSuites.validations.email(data);\r\n    }\r\n    if (options.constraint === 'url') {\r\n        var pattern = new RegExp(/(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig);\r\n        return pattern.test(data) ? true : false;\r\n    }\r\n    return null;\r\n}\r\n\r\njSuites.validations.constraints = function() {\r\n}\r\n\r\n\r\n\r\n    return jSuites;\r\n\r\n})));", "\r\n/**\r\n * (c) jSuites Javascript Web Components\r\n *\r\n * Website: https://jsuites.net\r\n * Description: Create amazing web based applications.\r\n *\r\n * MIT License\r\n *\r\n */\r\n\r\n/** Buttons **/\r\n\r\n.jbutton {\r\n    padding: 8px;\r\n    padding-left: 15px;\r\n    padding-right: 15px;\r\n    border: 1px solid #ddd;\r\n    border-radius: 2px;\r\n    cursor:pointer;\r\n    -webkit-font-smoothing: antialiased;\r\n    outline: none;\r\n}\r\n\r\n.jbutton.dark {\r\n    background-color: #737373;\r\n    border: 1px solid transparent;\r\n    color: #fff;\r\n}\r\n\r\n.jbutton.red {\r\n    background-color: #a23131;\r\n    border: 1px solid transparent;\r\n    color: #fff;\r\n}\r\n\r\n.jbutton.blue {\r\n    border:1px solid transparent;\r\n    color:#fff;\r\n    background-color:#1a73e8;\r\n}\r\n\r\n.jbutton.mobile {\r\n    padding:4px;\r\n    padding-left:25px;\r\n    padding-right:25px;\r\n    cursor:pointer;\r\n    min-width:100px;\r\n    outline:none;\r\n}\r\n\r\n.jbutton[data-icon] {\r\n    display: flex;\r\n}\r\n\r\n.jbutton[data-icon].center {\r\n    -webkit-justify-content: center;\r\n    justify-content: center;\r\n    padding-right:20px;\r\n}\r\n\r\n.jbutton[data-icon]::before {\r\n    content: attr(data-icon);\r\n    width: 24px;\r\n    height: 24px;\r\n    font-size: 24px;\r\n    line-height: 24px;\r\n    font-family: 'Material icons';\r\n    color: #999;\r\n    margin-right:2px;\r\n    color: #fff;\r\n}\r\n\r\n.jbutton:hover {\r\n    opacity: 0.8;\r\n    text-decoration: underline;\r\n}\r\n\r\n.jbutton[disabled] {\r\n    opacity: 0.5;\r\n    text-decoration: none;\r\n}\r\n\r\n@media only screen and (max-width : 800px) {\r\n    .jbutton {\r\n        margin: 2px;\r\n    }\r\n}\r\n\r\n.jbuttons-group {\r\n    display: flex;\r\n    cursor: pointer;\r\n    align-items: center;\r\n    justify-content: center;\r\n    -webkit-tap-highlight-color: transparent;\r\n}\r\n\r\n.jbuttons-group .jbutton {\r\n    border-radius: 0px;\r\n    border: 1px solid gray;\r\n    margin: 0px;\r\n    font-size: 0.9em;\r\n}\r\n\r\n.jbuttons-group.mobile .jbutton {\r\n    border-color: var(--active-color);\r\n    color: var(--active-color);\r\n    padding:4px;\r\n    padding-left:25px;\r\n    padding-right:25px;\r\n    cursor:pointer;\r\n    min-width:100px;\r\n    outline:none;\r\n}\r\n\r\n.jbuttons-group .jbutton.selected {\r\n    color: white;\r\n    background-color: var(--active-color);\r\n}\r\n\r\n.jbuttons-group .jbutton:first-child {\r\n    border-top-left-radius: 4px;\r\n    border-bottom-left-radius: 4px;\r\n}\r\n\r\n.jbuttons-group .jbutton:last-child {\r\n    border-top-right-radius: 4px;\r\n    border-bottom-right-radius: 4px;\r\n}\r\n\r\n/*.button-plain {\r\n    border:0px;\r\n    background-color:transparent;\r\n    cursor:pointer;\r\n    outline: none;\r\n}\r\n\r\n.button-dark {\r\n    background-color:#737373;\r\n    color:#fff;\r\n    border:1px solid transparent;\r\n    border-radius:2px;\r\n    cursor:pointer;\r\n    min-width:120px;\r\n    outline:none;\r\n}\r\n\r\n.button-dark:disabled {\r\n    background-color:#d3d3d3;\r\n    color:#a3a3a3;\r\n}\r\n\r\n.button-light {\r\n    background-color:#fff;\r\n    color:#737373;\r\n    border:1px solid #737373;\r\n    border-radius:2px;\r\n    cursor:pointer;\r\n    min-width:120px;\r\n    outline:none;\r\n}\r\n\r\n.button-light:disabled {\r\n    color:#a3a3a3;\r\n}\r\n\r\n.button-red {\r\n    background-color:#733333;\r\n    color:#fff;\r\n    border:1px solid transparent;\r\n    border-radius:2px;\r\n    cursor:pointer;\r\n    min-width:120px;\r\n    outline:none;\r\n}*/\r\n\r\n\r\n\r\n\r\n/** Switch **/\r\n\r\n.jswitch {\r\n    display: flex;\r\n    cursor: pointer;\r\n    -webkit-tap-highlight-color: transparent;\r\n    align-items: center;\r\n}\r\n\r\n.jswitch i {\r\n    position: relative;\r\n    display: inline-block;\r\n    width: 46px;\r\n    height: 26px;\r\n    background-color: #e6e6e6;\r\n    border-radius: 23px;\r\n    vertical-align: text-bottom;\r\n    transition: all 0.3s linear;\r\n}\r\n\r\n.jswitch i::before {\r\n  content: \"\";\r\n  position: absolute;\r\n  left: 0;\r\n  width: 42px;\r\n  height: 22px;\r\n  background-color: #fff;\r\n  border-radius: 11px;\r\n  transform: translate3d(2px, 2px, 0) scale3d(1, 1, 1);\r\n  transition: all 0.25s linear;\r\n}\r\n\r\n.jswitch i::after {\r\n  content: \"\";\r\n  position: absolute;\r\n  left: 0;\r\n  width: 22px;\r\n  height: 22px;\r\n  background-color: #fff;\r\n  border-radius: 11px;\r\n  box-shadow: 0 2px 2px rgba(0, 0, 0, 0.24);\r\n  transform: translate3d(2px, 2px, 0);\r\n  transition: all 0.2s ease-in-out;\r\n}\r\n\r\n.jswitch:active i::after {\r\n  width: 28px;\r\n  transform: translate3d(2px, 2px, 0);\r\n}\r\n\r\n.jswitch:active input:checked + i::after { transform: translate3d(16px, 2px, 0); }\r\n\r\n.jswitch input { display: none; }\r\n\r\n.jswitch input:checked + i { background-color: #4BD763; }\r\n\r\n.jswitch input:checked + i::before { transform: translate3d(18px, 2px, 0) scale3d(0, 0, 0); }\r\n\r\n.jswitch input:checked + i::after { transform: translate3d(22px, 2px, 0); }\r\n\r\n.jrange {\r\n    -webkit-appearance: none;\r\n    width: 100%;\r\n    height: 4px;\r\n    background: #d3d3d3;\r\n    outline: none;\r\n    opacity: 0.7;\r\n    -webkit-transition: .2s;\r\n    transition: opacity .2s;\r\n    padding: 0px;\r\n}\r\n\r\n.jrange:hover {\r\n  opacity: 1;\r\n}\r\n\r\n.jrange::-webkit-slider-thumb {\r\n  background: #4CAF50;\r\n  cursor: pointer;\r\n}\r\n\r\n.jrange::-moz-range-thumb {\r\n  background: #4CAF50;\r\n  cursor: pointer;\r\n}\r\n\r\n.jcrop {\r\n    position: relative;\r\n    overflow: hidden;\r\n}\r\n.jcrop-area {\r\n    position: absolute;\r\n    border: 1px solid transparent;\r\n    background: url('data:image/gif;base64,R0lGODlhWAIBAPAAAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAAABACwAAAAAWAIBAAACQ0QeoIbL51BaMjZ6VcWQT509n2h1oEl65bidbNim7kqr9nzLeszDPtoD/l7CIvFYwyl3wyTT6Awic9Jok3pdVrFQRQEAIfkECQAAAQAsAAAAAFgCAQAAAkIEgmGWur1OivBNi+hlW2bscJ8YemVFaqOpnh3Kgu0s16kd33rOw/4LXP2EQRfxaEzSdkMlrrnsFaPQ59SKpF6Z1wIAIfkECQAAAQAsAAAAAFgCAQAAAkKEg2GXC6kWdFM2i+hlGUf+PZvYgVpJhpXpneq4pu7c1uwt2zke9/CP8gWBr6GxiKTxiMqdU5jUQZtTKdN6pF6X2QIAIfkECQAAAQAsAAAAAFgCAQAAAkOEERmHyroOfE5WM22iW0d8NR04ip/JnRmphivqpXJMs7Ndw/iu9+/vCpaAQ2GriDwqbz4jk7jMQZ9OaZU3tSapSEABACH5BAkAAAEALAAAAABYAgEAAAJDDA6hhsvnUFoyNnpVxZBPnT2faHWgSXrluJ1s2KbuSqv2fMt6zMM+2gP+XsIi8VjDKXfDJNPoDCJz0miTel1WsVBFAQAh+QQJAAABACwAAAAAWAIBAAACQkyAYJa6vU6K8E2L6GVbZuxwnxh6ZUVqo6meHcqC7SzXqR3fes7D/gtc/YRBF/FoTNJ2QyWuuewVo9Dn1IqkXpnXAgAh+QQJAAABACwAAAAAWAIBAAACQoyBYJcbqRZ0UzaL6GUZR/49m9iBWkmGlemd6rim7tzW7C3bOR738I/yBYGvobGIpPGIyp1TmNRBm1Mp03qkXpfZAgAh+QQFAAABACwAAAAAWAIBAAACQowDCYfKug58TlYzbaJbR3w1HTiKn8mdGamGK+qlckyzs13D+K737+8KloBDYauIPCpvPiOTuMxBn05plTe1JqnJAgA7') repeat-x top border-box,\r\n                url('data:image/gif;base64,R0lGODlhWAIBAPAAAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAAABACwAAAAAWAIBAAACQ0QeoIbL51BaMjZ6VcWQT509n2h1oEl65bidbNim7kqr9nzLeszDPtoD/l7CIvFYwyl3wyTT6Awic9Jok3pdVrFQRQEAIfkECQAAAQAsAAAAAFgCAQAAAkIEgmGWur1OivBNi+hlW2bscJ8YemVFaqOpnh3Kgu0s16kd33rOw/4LXP2EQRfxaEzSdkMlrrnsFaPQ59SKpF6Z1wIAIfkECQAAAQAsAAAAAFgCAQAAAkKEg2GXC6kWdFM2i+hlGUf+PZvYgVpJhpXpneq4pu7c1uwt2zke9/CP8gWBr6GxiKTxiMqdU5jUQZtTKdN6pF6X2QIAIfkECQAAAQAsAAAAAFgCAQAAAkOEERmHyroOfE5WM22iW0d8NR04ip/JnRmphivqpXJMs7Ndw/iu9+/vCpaAQ2GriDwqbz4jk7jMQZ9OaZU3tSapSEABACH5BAkAAAEALAAAAABYAgEAAAJDDA6hhsvnUFoyNnpVxZBPnT2faHWgSXrluJ1s2KbuSqv2fMt6zMM+2gP+XsIi8VjDKXfDJNPoDCJz0miTel1WsVBFAQAh+QQJAAABACwAAAAAWAIBAAACQkyAYJa6vU6K8E2L6GVbZuxwnxh6ZUVqo6meHcqC7SzXqR3fes7D/gtc/YRBF/FoTNJ2QyWuuewVo9Dn1IqkXpnXAgAh+QQJAAABACwAAAAAWAIBAAACQoyBYJcbqRZ0UzaL6GUZR/49m9iBWkmGlemd6rim7tzW7C3bOR738I/yBYGvobGIpPGIyp1TmNRBm1Mp03qkXpfZAgAh+QQFAAABACwAAAAAWAIBAAACQowDCYfKug58TlYzbaJbR3w1HTiKn8mdGamGK+qlckyzs13D+K737+8KloBDYauIPCpvPiOTuMxBn05plTe1JqnJAgA7') repeat-x bottom border-box,\r\n                url('data:image/gif;base64,R0lGODlhAQCQAfAAAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAAABACwAAAAAAQCQAQACM0QeoIbL51BaMjZ6VcWQT509n2h1oEl65bidbNim7kqr9nzLeszDPtoD/l7CIvFYwyllBQAh+QQJAAABACwAAAAAAQCQAQACMwSCYZa6vU6K8E2L6GVbZuxwnxh6ZUVqo6meHcqC7SzXqR3fes7D/gtc/YRBF/FoTNJuBQAh+QQJAAABACwAAAAAAQCQAQACM4SDYZcLqRZ0UzaL6GUZR/49m9iBWkmGlemd6rim7tzW7C3bOR738I/yBYGvobGIpPEaBQAh+QQJAAABACwAAAAAAQCQAQACNIQRGYfKug58TlYzbaJbR3w1HTiKn8mdGamGK+qlckyzs13D+K737+8KloBDYauIPCo5gAIAIfkECQAAAQAsAAAAAAEAkAEAAjMMDqGGy+dQWjI2elXFkE+dPZ9odaBJeuW4nWzYpu5Kq/Z8y3rMwz7aA/5ewiLxWMMpZQUAIfkECQAAAQAsAAAAAAEAkAEAAjNMgGCWur1OivBNi+hlW2bscJ8YemVFaqOpnh3Kgu0s16kd33rOw/4LXP2EQRfxaEzSbgUAIfkECQAAAQAsAAAAAAEAkAEAAjOMgWCXG6kWdFM2i+hlGUf+PZvYgVpJhpXpneq4pu7c1uwt2zke9/CP8gWBr6GxiKTxGgUAIfkEBQAAAQAsAAAAAAEAkAEAAjOMAwmHyroOfE5WM22iW0d8NR04ip/JnRmphivqpXJMs7Ndw/iu9+/vCpaAQ2GriDwqUwUAOw==') repeat-y left border-box,\r\n                url('data:image/gif;base64,R0lGODlhAQCQAfAAAAAAAP///yH/C05FVFNDQVBFMi4wAwEAAAAh+QQJAAABACwAAAAAAQCQAQACM0QeoIbL51BaMjZ6VcWQT509n2h1oEl65bidbNim7kqr9nzLeszDPtoD/l7CIvFYwyllBQAh+QQJAAABACwAAAAAAQCQAQACMwSCYZa6vU6K8E2L6GVbZuxwnxh6ZUVqo6meHcqC7SzXqR3fes7D/gtc/YRBF/FoTNJuBQAh+QQJAAABACwAAAAAAQCQAQACM4SDYZcLqRZ0UzaL6GUZR/49m9iBWkmGlemd6rim7tzW7C3bOR738I/yBYGvobGIpPEaBQAh+QQJAAABACwAAAAAAQCQAQACNIQRGYfKug58TlYzbaJbR3w1HTiKn8mdGamGK+qlckyzs13D+K737+8KloBDYauIPCo5gAIAIfkECQAAAQAsAAAAAAEAkAEAAjMMDqGGy+dQWjI2elXFkE+dPZ9odaBJeuW4nWzYpu5Kq/Z8y3rMwz7aA/5ewiLxWMMpZQUAIfkECQAAAQAsAAAAAAEAkAEAAjNMgGCWur1OivBNi+hlW2bscJ8YemVFaqOpnh3Kgu0s16kd33rOw/4LXP2EQRfxaEzSbgUAIfkECQAAAQAsAAAAAAEAkAEAAjOMgWCXG6kWdFM2i+hlGUf+PZvYgVpJhpXpneq4pu7c1uwt2zke9/CP8gWBr6GxiKTxGgUAIfkEBQAAAQAsAAAAAAEAkAEAAjOMAwmHyroOfE5WM22iW0d8NR04ip/JnRmphivqpXJMs7Ndw/iu9+/vCpaAQ2GriDwqUwUAOw==') repeat-y right border-box;\r\n    display: none;\r\n}\r\n\r\n.jcrop canvas {\r\n    position: absolute;\r\n    background: transparent;\r\n    left: 0;\r\n    top: 0;\r\n}\r\n\r\n.jcrop.jcrop_edition {\r\n    background-repeat: initial;\r\n    background-size: initial;\r\n    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAIAAAC0Ujn1AAAACXBIWXMAAAsTAAALEwEAmpwYAAAFuGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDUgNzkuMTYzNDk5LCAyMDE4LzA4LzEzLTE2OjQwOjIyICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIwLTExLTIxVDIwOjQzOjQ4WiIgeG1wOk1ldGFkYXRhRGF0ZT0iMjAyMC0xMS0yMVQyMDo0Mzo0OFoiIHhtcDpNb2RpZnlEYXRlPSIyMDIwLTExLTIxVDIwOjQzOjQ4WiIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3ZmI2ZmZiNS00NmVmLWNhNDctOGUxMy1mYWY4NTA5MzJlNDIiIHhtcE1NOkRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpjOWE3NGEyZi02MGJlLWJjNDItODc3Ny0zY2E2ZjkxMTRmOGQiIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpjMWQzMzMxNy1jZDE4LTY5NDEtYWY5Ni0xMWNjZjE4ODE1NjgiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIj4gPHhtcE1NOkhpc3Rvcnk+IDxyZGY6U2VxPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY3JlYXRlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjMWQzMzMxNy1jZDE4LTY5NDEtYWY5Ni0xMWNjZjE4ODE1NjgiIHN0RXZ0OndoZW49IjIwMjAtMTEtMjFUMjA6NDM6NDhaIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjdmYjZmZmI1LTQ2ZWYtY2E0Ny04ZTEzLWZhZjg1MDkzMmU0MiIgc3RFdnQ6d2hlbj0iMjAyMC0xMS0yMVQyMDo0Mzo0OFoiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8L3JkZjpTZXE+IDwveG1wTU06SGlzdG9yeT4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7KEhjgAAAAPklEQVRIie3QsQ0AIAwDQcIE3n/JZINkBSMakN716wpHZi57kvx4++npoKGhoR+lo7v9uqr8+M9DoKGhoW82fHEJBd4qufYAAAAASUVORK5CYII=)\r\n}\r\n\r\n.jcrop.jcrop_edition .jcrop-area {\r\n    display: block;\r\n}\r\n\r\n@media screen and (min-width:0\\0) and (min-resolution: +72dpi) {\r\n    .jcrop-area {\r\n        background: none;\r\n        border-image: url('data:image/gif;base64,R0lGODlhCgAKAJECAAAAAP///////wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEI5RDc5MTFDNkE2MTFFM0JCMDZEODI2QTI4MzJBOTIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEI5RDc5MTBDNkE2MTFFM0JCMDZEODI2QTI4MzJBOTIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuZGlkOjAyODAxMTc0MDcyMDY4MTE4MDgzQzNDMjA5MzREQ0ZDIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjAyODAxMTc0MDcyMDY4MTE4MDgzQzNDMjA5MzREQ0ZDIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEBQoAAgAsAAAAAAoACgAAAhWEERkn7W3ei7KlagMWF/dKgYeyGAUAIfkEBQoAAgAsAAAAAAoACgAAAg+UYwLJ7RnQm7QmsCyVKhUAIfkEBQoAAgAsAAAAAAoACgAAAhCUYgLJHdiinNSAVfOEKoUCACH5BAUKAAIALAAAAAAKAAoAAAIRVISAdusPo3RAzYtjaMIaUQAAIfkEBQoAAgAsAAAAAAoACgAAAg+MDiem7Q8bSLFaG5il6xQAIfkEBQoAAgAsAAAAAAoACgAAAg+UYRLJ7QnQm7SmsCyVKhUAIfkEBQoAAgAsAAAAAAoACgAAAhCUYBLJDdiinNSEVfOEKoECACH5BAUKAAIALAAAAAAKAAoAAAIRFISBdusPo3RBzYsjaMIaUQAAOw==') 1 repeat;\r\n    }\r\n}\r\n\r\n@-moz-document url-prefix() {\r\n    .jcrop-area {\r\n        background: none;\r\n        border-image: url('data:image/gif;base64,R0lGODlhCgAKAJECAAAAAP///////wAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEI5RDc5MTFDNkE2MTFFM0JCMDZEODI2QTI4MzJBOTIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEI5RDc5MTBDNkE2MTFFM0JCMDZEODI2QTI4MzJBOTIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuZGlkOjAyODAxMTc0MDcyMDY4MTE4MDgzQzNDMjA5MzREQ0ZDIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjAyODAxMTc0MDcyMDY4MTE4MDgzQzNDMjA5MzREQ0ZDIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Af/+/fz7+vn49/b19PPy8fDv7u3s6+rp6Ofm5eTj4uHg397d3Nva2djX1tXU09LR0M/OzczLysnIx8bFxMPCwcC/vr28u7q5uLe2tbSzsrGwr66trKuqqainpqWko6KhoJ+enZybmpmYl5aVlJOSkZCPjo2Mi4qJiIeGhYSDgoGAf359fHt6eXh3dnV0c3JxcG9ubWxramloZ2ZlZGNiYWBfXl1cW1pZWFdWVVRTUlFQT05NTEtKSUhHRkVEQ0JBQD8+PTw7Ojk4NzY1NDMyMTAvLi0sKyopKCcmJSQjIiEgHx4dHBsaGRgXFhUUExIREA8ODQwLCgkIBwYFBAMCAQAAIfkEBQoAAgAsAAAAAAoACgAAAhWEERkn7W3ei7KlagMWF/dKgYeyGAUAIfkEBQoAAgAsAAAAAAoACgAAAg+UYwLJ7RnQm7QmsCyVKhUAIfkEBQoAAgAsAAAAAAoACgAAAhCUYgLJHdiinNSAVfOEKoUCACH5BAUKAAIALAAAAAAKAAoAAAIRVISAdusPo3RAzYtjaMIaUQAAIfkEBQoAAgAsAAAAAAoACgAAAg+MDiem7Q8bSLFaG5il6xQAIfkEBQoAAgAsAAAAAAoACgAAAg+UYRLJ7QnQm7SmsCyVKhUAIfkEBQoAAgAsAAAAAAoACgAAAhCUYBLJDdiinNSEVfOEKoECACH5BAUKAAIALAAAAAAKAAoAAAIRFISBdusPo3RBzYsjaMIaUQAAOw==') 1 repeat;\r\n    }\r\n}\r\n\r\n@media only screen and (max-width: 800px) {\r\n    .jcrop.jcrop_edition .jcrop-area {\r\n        background: none;\r\n        width: 100% !important;\r\n        height: 100% !important;\r\n        top: 0 !important;\r\n        left: 0 !important;\r\n        z-index: -1 !important;\r\n    }\r\n}\r\n\r\n\r\n.jfloating {\r\n    position:fixed;\r\n    bottom:0px;\r\n    right:0px;\r\n    margin-right:5px;\r\n\r\n    -webkit-box-shadow: 0 2px 10px rgba(0,0,0,.2);\r\n    -moz-box-shadow: 0 2px 10px rgba(0,0,0,.2);\r\n    border:1px solid #ccc;\r\n    background-color:#fff;\r\n    box-sizing: border-box;\r\n    padding-top:50px !important;\r\n    z-index:9002;\r\n    border-radius: 8px;\r\n}\r\n\r\n.jfloating.jfloating-big {\r\n    width: 510px !important;\r\n    height: 472px !important;\r\n}\r\n\r\n.jfloating.jfloating-small {\r\n    width: 300px !important;\r\n    height: 320px !important;\r\n}\r\n\r\n.jfloating.jfloating-large {\r\n    width: 600px !important;\r\n    height: 600px !important;\r\n}\r\n\r\n.jfloating:before {\r\n    position:absolute;\r\n    top:0;\r\n    left:0;\r\n    width:100%;\r\n    content:attr(title);\r\n    padding:15px;\r\n    box-sizing: border-box;\r\n    font-size:1.2em;\r\n    box-shadow: 1px 1px 3px rgba(0,0,0,.2);\r\n    background-color: #fff;\r\n    border-radius: 8px 8px 0px 0px;\r\n    background-color: #404040;\r\n    font-size: .93rem;\r\n    font-weight: 600;\r\n    color: white;\r\n    letter-spacing: .5px;\r\n}\r\n\r\n.jfloating:after {\r\n    content:'';\r\n    background-image: url(\"data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath fill='%23FFF' d='M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\");\r\n    position:absolute;\r\n    top:0;\r\n    right:0;\r\n    margin:14px;\r\n    font-size:24px;\r\n    width:24px;\r\n    height:24px;\r\n    cursor:pointer;\r\n    text-shadow: 0px 0px 5px #fff;\r\n}\r\n\r\n.jfloating_content {\r\n    padding:20px;\r\n    overflow-y:auto;\r\n    max-height:100%;\r\n    box-sizing: border-box;\r\n    height: -webkit-fill-available;\r\n}\r\n\r\n.jfloating.jfloating-minimized {\r\n    height: 50px !important;\r\n}\r\n\r\n.jfloating.jfloating-minimized .jfloating_content {\r\n    display: none;\r\n}\r\n\r\n\r\n@media (min-width: 576px)\r\n{\r\n    .container {\r\n        max-width: 540px;\r\n    }\r\n}\r\n\r\n@media (min-width: 768px)\r\n{\r\n    .container {\r\n        max-width: 732px;\r\n    }\r\n}\r\n\r\n@media (min-width: 992px)\r\n{\r\n    .container {\r\n        max-width: 956px;\r\n    }\r\n}\r\n\r\n@media (min-width: 1200px)\r\n{\r\n    .container {\r\n        max-width: 1168px;\r\n    }\r\n}\r\n\r\n@media (min-width: 1440px) {\r\n    .container {\r\n        max-width: 1404px;\r\n    }\r\n}\r\n\r\n@media only screen and (max-device-width: 800px)\r\n{\r\n    .form-group {\r\n        min-width: 50vw !important;\r\n        margin-right: 0px !important;\r\n    }\r\n    .section {\r\n        margin-right:0px !important;\r\n    }\r\n    .section-content {\r\n        padding: 12px !important;\r\n    }\r\n}\r\n\r\n/* mobile */\r\n@media (max-device-width: 600px) {\r\n    .small-screen-only {\r\n        display: block;\r\n    }\r\n    .medium-screen-only {\r\n        display: none;\r\n    }\r\n    .big-screen-only {\r\n        display: none;\r\n    }\r\n}\r\n\r\n/* tablet */\r\n@media (max-device-width:992px) and (min-device-width:601px) {\r\n    .small-screen-only {\r\n        display: none;\r\n    }\r\n    .medium-screen-only {\r\n        display: block;\r\n    }\r\n    .big-screen-only {\r\n        display: none;\r\n    }\r\n}\r\n\r\n/* desktop */\r\n@media (min-device-width: 993px) {\r\n    .small-screen-only {\r\n        display: none;\r\n    }\r\n    .medium-screen-only {\r\n        display: none;\r\n    }\r\n    .big-screen-only {\r\n        display: block;\r\n    }\r\n}\r\n\r\nbody, div, td\r\n{\r\n    font-family:'Open Sans';\r\n}\r\n\r\nbody\r\n{\r\n    margin:0px;\r\n}\r\n\r\nh1:empty\r\n{\r\n    display:none;\r\n}\r\n\r\nh2:empty\r\n{\r\n    display:none;\r\n}\r\n\r\ninput, select, textarea, button, .input {\r\n    border-radius: 1px;\r\n    border:1px solid #ccc;\r\n    padding:8px;\r\n    box-sizing: border-box;\r\n    -moz-box-sizing: border-box;\r\n    background-color:#fff;\r\n    font-size:1em;\r\n    line-height: initial;\r\n}\r\n\r\n.jdropdown .jdropdown-header {\r\n    padding-top: 8px;\r\n    padding-bottom: 8px;\r\n}\r\n    \r\n.input[data-mask] {\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n}\r\n\r\n.input[data-mask] * {\r\n    display: none;\r\n}\r\n\r\nselect {\r\n    padding:7px;\r\n}\r\n\r\ninput:disabled, select:disabled, textarea:disabled, button:disabled {\r\n    background-color:#eee;\r\n    color:#888;\r\n}\r\n\r\nblockquote {\r\n    font-style: italic;\r\n    font-family: Georgia, Times, \"Times New Roman\", serif;\r\n    padding: 2px 0;\r\n    border-style: solid;\r\n    border-color: #ccc;\r\n    border-width: 0;\r\n    padding-left: 20px;\r\n    padding-right: 8px;\r\n    border-left-width: 5px;\r\n}\r\n\r\nsection.middle {\r\n    max-width:540px;\r\n}\r\n\r\n.nowrap {\r\n    flex-wrap:nowrap;\r\n}\r\n\r\n.center {\r\n    text-align:center;\r\n}\r\n\r\n.justify {\r\n    text-align:justify;\r\n}\r\n\r\n.separator {\r\n    background-color:#eee;\r\n    height:1px;\r\n}\r\n\r\n.clear {\r\n    clear:both;\r\n}\r\n\r\n.top {\r\n    padding-left:2px;\r\n    padding-right:2px;\r\n}\r\n\r\n.top > .row > .column {\r\n    margin-top:5px;\r\n    margin-bottom:5px;\r\n}\r\n\r\n.container {\r\n    width: 100%;\r\n    margin-right: auto;\r\n    margin-left: auto;\r\n}\r\n\r\n.container-box {\r\n    padding-right: 15px;\r\n    padding-left: 15px;\r\n}\r\n\r\n.row {\r\n    display:flex;\r\n    flex-wrap: wrap;\r\n    -ms-flex-direction: row;\r\n    -webkit-flex-direction: row;\r\n    flex-direction: row;\r\n    -ms-flex-pack: justify;\r\n    -webkit-justify-content: space-between;\r\n    justify-content: space-between;\r\n    box-sizing: border-box;\r\n}\r\n\r\n.row.container {\r\n    flex-wrap: nowrap;\r\n}\r\n\r\n.row.middle {\r\n    -ms-flex-align: center;\r\n    -webkit-align-items: center;\r\n    -webkit-box-align: center;\r\n    align-items: center;\r\n}\r\n\r\n.column {\r\n    box-sizing: border-box;\r\n}\r\n\r\n.column.top {\r\n    -webkit-align-self: flex-start;\r\n    -ms-flex-item-align: start;\r\n    align-self: flex-start;\r\n}\r\n\r\n.column.bottom {\r\n    -webkit-align-self: flex-end;\r\n    -ms-flex-item-align: end;\r\n    align-self: flex-end;\r\n}\r\n\r\n@media only screen and (max-width: 480px) {\r\n    .column {\r\n        min-width: 100%;\r\n    }\r\n    .cmr1 {\r\n        margin-right: 0px;\r\n    }\r\n    .cmr2 {\r\n        margin-right: 0px;\r\n    }\r\n    .cml1 {\r\n        margin-left: 0px;\r\n    }\r\n    .cml2 {\r\n        margin-left: 0px;\r\n    }\r\n}\r\n\r\n.start {\r\n    justify-content:flex-start;\r\n}\r\n\r\n.header {\r\n    width:100%;\r\n    position:absolute;\r\n    background-color:rgba(255, 255, 255, 0.2);\r\n    padding-top:12px;\r\n    padding-bottom:12px;\r\n    text-align:center;\r\n}\r\n\r\n.space {\r\n    height:4px;\r\n}\r\n\r\n.line .row {\r\n    max-width:1280px;\r\n    margin: 0 auto; \r\n}\r\n\r\n.large {\r\n    font-size:1.2em;\r\n}\r\n\r\n.extra-large {\r\n    font-size:1.4em;\r\n}\r\n\r\n.small {\r\n    font-size: 0.8em;\r\n}\r\n\r\n.extra-small {\r\n    font-size: 0.7em;\r\n}\r\n\r\n.form-group {\r\n    padding: 4px;\r\n    margin-right: 4px;\r\n}\r\n\r\n.form-group label {\r\n}\r\n\r\n.form-group input[type='text'], .form-group input[type='number'], .form-group input[type='password'], .form-group select, .form-group textarea, .form-group .jdropdown, .form-group .jprogressbar {\r\n    width:100%;\r\n}\r\n\r\n.f1\r\n{\r\n    flex:1;\r\n}\r\n\r\n.f2\r\n{\r\n    flex:2;\r\n}\r\n\r\n.f3\r\n{\r\n    flex:3;\r\n}\r\n\r\n.f4\r\n{\r\n    flex:4;\r\n}\r\n\r\n.f5\r\n{\r\n    flex:5;\r\n}\r\n\r\n.f6\r\n{\r\n    flex:6;\r\n}\r\n\r\n.f7\r\n{\r\n    flex:7;\r\n}\r\n\r\n.f8\r\n{\r\n    flex:8;\r\n}\r\n\r\n.f9\r\n{\r\n    flex:9;\r\n}\r\n\r\n.f10\r\n{\r\n    flex:10;\r\n}\r\n\r\n.w5\r\n{\r\n    width:5% !important;\r\n}\r\n\r\n.w10\r\n{\r\n    width:10% !important;\r\n}\r\n\r\n.w15\r\n{\r\n    width:15% !important;\r\n}\r\n\r\n.w20\r\n{\r\n    width:15% !important;\r\n}\r\n\r\n.w25\r\n{\r\n    width:25% !important;\r\n}\r\n\r\n.w30\r\n{\r\n    width:30% !important;\r\n}\r\n\r\n.w33\r\n{\r\n    width:33% !important;\r\n}\r\n\r\n.w40\r\n{\r\n    width:40% !important;\r\n}\r\n\r\n.w50\r\n{\r\n    width:50% !important;\r\n}\r\n\r\n.w60\r\n{\r\n    width:60% !important;\r\n}\r\n\r\n.w66\r\n{\r\n    width:66% !important;\r\n}\r\n\r\n.w70\r\n{\r\n    width:70% !important;\r\n}\r\n\r\n.w100\r\n{\r\n    width:100% !important;\r\n}\r\n\r\n.r20 .column\r\n{\r\n    width:20%;\r\n}\r\n\r\n.r25 .column\r\n{\r\n    width:25%;\r\n}\r\n\r\n.r33 .column\r\n{\r\n    width:33%;\r\n}\r\n\r\n.r66 .column\r\n{\r\n    width:66%;\r\n}\r\n\r\n.r50 .column\r\n{\r\n    width:50%;\r\n}\r\n\r\n.r100 .column\r\n{\r\n    width:100%;\r\n}\r\n\r\n.p0\r\n{\r\n    padding:0px;\r\n}\r\n\r\n.p2\r\n{\r\n    padding:2px;\r\n}\r\n\r\n.p4\r\n{\r\n    padding:4px;\r\n}\r\n\r\n.p6\r\n{\r\n    padding:6px;\r\n}\r\n\r\n.p8\r\n{\r\n    padding:8px;\r\n}\r\n\r\n.p10\r\n{\r\n    padding:10px;\r\n}\r\n\r\n.p15\r\n{\r\n    padding:15px;\r\n}\r\n\r\n.p20\r\n{\r\n    padding:20px;\r\n}\r\n\r\n.m0\r\n{\r\n    margin:0px;\r\n}\r\n\r\n.m2\r\n{\r\n    margin:2px;\r\n}\r\n\r\n.m4\r\n{\r\n    margin:4px;\r\n}\r\n\r\n.m6\r\n{\r\n    margin:6px;\r\n}\r\n\r\n.m8\r\n{\r\n    margin:8px;\r\n}\r\n\r\n.m10\r\n{\r\n    margin:10px;\r\n}\r\n\r\n.m15\r\n{\r\n    margin:15px;\r\n}\r\n\r\n.m20\r\n{\r\n    margin:20px;\r\n}\r\n\r\n.mr1 {\r\n    margin-right:10px;\r\n}\r\n\r\n.mr2 {\r\n    margin-right:20px;\r\n}\r\n\r\n.mr3 {\r\n    margin-right:30px;\r\n}\r\n\r\n.ml1 {\r\n    margin-left:10px;\r\n}\r\n\r\n.ml2 {\r\n    margin-left:20px;\r\n}\r\n\r\n.ml3 {\r\n    margin-left:30px;\r\n}\r\n\r\n.pl1 {\r\n    padding-left:10px;\r\n}\r\n\r\n.pl2 {\r\n    padding-left:20px;\r\n}\r\n\r\n.pl3 {\r\n    padding-left:30px;\r\n}\r\n\r\n.pr1 {\r\n    padding-right:10px;\r\n}\r\n\r\n.pr2 {\r\n    padding-right:20px;\r\n}\r\n\r\n.pr3 {\r\n    padding-right:30px;\r\n}\r\n\r\n.cmr1 {\r\n    margin-right: 10px;\r\n}\r\n\r\n.cmr2 {\r\n    margin-right: 20px;\r\n}\r\n\r\n.cml1 {\r\n    margin-left: 10px;\r\n}\r\n\r\n.cml2 {\r\n    margin-left: 20px;\r\n}\r\n\r\n.section {\r\n    background-color: #fff;\r\n    box-shadow: 1px 1px 2px rgba(0,0,0,.1);\r\n    margin-top:10px;\r\n    margin-right:10px;\r\n}\r\n\r\n.section-divisor {\r\n    margin-top:6px;\r\n    margin-bottom:5px;\r\n    border-bottom:1px solid #e1e1e1;\r\n    text-transform:uppercase;\r\n}\r\n\r\n.section-divisor div {\r\n    display:inline-block;\r\n}\r\n\r\n.section-divisor .section-number {\r\n    padding:8px;\r\n    width:40px;\r\n    height:40px;\r\n    text-align:center;\r\n    font-weight:bold;\r\n    font-size:23px;\r\n    display:inline;\r\n}\r\n\r\n.section-container {\r\n    padding:6px;\r\n}\r\n\r\n.section-header {\r\n    font-size:2em;\r\n    margin-bottom:20px;\r\n}\r\n\r\n.section-content {\r\n    padding:30px;\r\n}\r\n\r\n.fullpath {\r\n    display:flex;\r\n    color: #999;\r\n    padding:4px;\r\n    padding-left:8px;\r\n}\r\n\r\n.fullpath > div {\r\n    line-height:24px;\r\n}\r\n.fullpath > input {\r\n    border-color: transparent;\r\n    padding: 0px;\r\n    margin: 0px;\r\n    outline: none;\r\n}\r\n\r\n.fullpath > input.error {\r\n    border-bottom: 1px solid red;\r\n}\r\n\r\n.title {\r\n    font-size:1.8em;\r\n    font-family: Roboto,Helvetica,Arial,sans-serif;\r\n    font-size: 22px;\r\n    font-weight: 400;\r\n    line-height: 28px;\r\n}\r\n\r\n.t1 {\r\n    font-family: Roboto,Helvetica,Arial,sans-serif;\r\n    font-size: 22px;\r\n    font-weight: 400;\r\n    line-height: 28px;\r\n}\r\n\r\n.t2 {\r\n    font-family: Roboto,Helvetica,Arial,sans-serif;\r\n    font-size: 18px;\r\n    font-weight: 400;\r\n    line-height: 22px;\r\n}\r\n\r\n.uppercase {\r\n    text-transform:uppercase;\r\n}\r\n\r\n.subtitle {\r\n    position:relative;\r\n    top:-5px;\r\n    margin-bottom:10px;\r\n}\r\n\r\n.breadcrumb {\r\n    display: inline-flex;\r\n    list-style: none;\r\n    margin: 0px;\r\n    padding: 0px;\r\n}\r\n\r\n.breadcrumb > li:after {\r\n    content: '\\00BB';\r\n    padding: 8px;\r\n    font-size: 1.2em;\r\n}\r\n\r\n.breadcrumb > li:last-child:after {\r\n    opacity: 0;\r\n}\r\n\r\n.breadcrumb a:hover {\r\n    color: #000;\r\n    text-decoration: underline;\r\n}\r\n\r\n.left {\r\n    float:left;\r\n}\r\n\r\n.right {\r\n    float:right;\r\n}\r\n\r\n.material-icons {\r\n    font-size:24px;\r\n    width:24px;\r\n    height:24px;\r\n    line-height:24px;\r\n}\r\n\r\n.material-icons.selected {\r\n    color:#777;\r\n}\r\n\r\n.material-icons.small {\r\n    font-size:16px;\r\n    width:16px;\r\n    height:16px;\r\n    line-height:16px;\r\n}\r\n\r\n.material-icons.large {\r\n    font-size:36px;\r\n    width:36px;\r\n    height:36px;\r\n    line-height:36px;\r\n}\r\n\r\n.material-icons.larger {\r\n    font-size:48px;\r\n    width:48px;\r\n    height:48px;\r\n    line-height:48px;\r\n}\r\n\r\n.favorite {\r\n    font-size:24px;\r\n    width:24px;\r\n    height:24px;\r\n}\r\n\r\n.favorite.selected {\r\n    color:red;\r\n}\r\n\r\n.alert {\r\n    padding: 12px;\r\n    padding-left: 30px;\r\n    padding-right: 30px;\r\n    background-color: #f44336;\r\n    color: white;\r\n    display:none;\r\n}\r\n\r\n.alert.success {\r\n    background-color: #4CAF50;\r\n}\r\n\r\n.alert.info {\r\n    background-color: #2196F3;\r\n}\r\n\r\n.alert.warning {\r\n    background-color: #ff9800;\r\n}\r\n\r\n.error {\r\n    outline: 1px solid red;\r\n}\r\n\r\n.users {\r\n    width:40px;\r\n    height:40px;\r\n    border-radius:20px;\r\n}\r\n\r\n.users-overlap {\r\n    vertical-align:bottom;\r\n    min-height:28px;\r\n    padding-left:10px;\r\n}\r\n\r\n.users-overlap img {\r\n    width:24px;\r\n    height:24px;\r\n    line-height:24px;\r\n    border-radius:24px;\r\n    border:2px solid #fff;\r\n    vertical-align: middle;\r\n    margin-left:-10px;\r\n}\r\n\r\n.users-overlap span {\r\n    margin-left:3px;\r\n    font-size:0.8em;\r\n}\r\n\r\n.users-micro {\r\n    width:24px;\r\n    height:24px;\r\n    border-radius:12px;\r\n}\r\n\r\n.users-small {\r\n    width:30px;\r\n    height:30px;\r\n    border-radius:15px;\r\n}\r\n\r\n.users-medium {\r\n    width:45px;\r\n    height:45px;\r\n    border-radius:23px;\r\n}\r\n\r\n.users-large {\r\n    width:60px;\r\n    height:60px;\r\n    border-radius:30px;\r\n}\r\n\r\n.users-extra-large {\r\n    width:120px;\r\n    height:120px;\r\n    border-radius:60px;\r\n}\r\n\r\n.badge {\r\n    position:absolute;\r\n    background-color:red;\r\n    color:#fff;\r\n    width:16px;\r\n    height:16px;\r\n    line-height:16px;\r\n    border-radius:16px;\r\n    text-align:center;\r\n    font-size:8px;\r\n    margin:12px;\r\n}\r\n\r\n.badge:empty {\r\n    display:none;\r\n}\r\n\r\n.video-container {\r\n    position: relative;\r\n    width: 100%;\r\n    height: 0;\r\n    padding-bottom: 56.25%;\r\n}\r\n\r\n.video-container iframe {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n\r\n.cursor {\r\n    cursor:pointer;\r\n}\r\n\r\n.cursor.link:hover {\r\n    text-decoration: underline;\r\n}\r\n\r\n.arrow-right {\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath d='M8.59 16.59L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.41z' fill='gray'/%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    width:24px;\r\n    height:24px;\r\n    line-height:24px;\r\n    cursor:pointer;\r\n}\r\n\r\n.arrow-left {\r\n    background-image: url(\"data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath d='M15.41 16.59L10.83 12l4.58-4.59L14 6l-6 6 6 6 1.41-1.41z' fill='gray'/%3E%3Cpath fill='none' d='M0 0h24v24H0V0z'/%3E%3C/svg%3E\");\r\n    background-repeat: no-repeat;\r\n    width:24px;\r\n    height:24px;\r\n    line-height:24px;\r\n    cursor:pointer;\r\n}\r\n\r\n.mirror {\r\n    -moz-transform: scaleX(-1);\r\n    -o-transform: scaleX(-1);\r\n    -webkit-transform: scaleX(-1);\r\n    transform: scaleX(-1);\r\n    filter: FlipH;\r\n}\r\n\r\n.hover:hover {\r\n    background-color:#efefef;\r\n}\r\n\r\n.unselectable {\r\n    -webkit-touch-callout: none;\r\n    -webkit-user-select: none;\r\n    -khtml-user-select: none;\r\n    -moz-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n}\r\n\r\n.disabled {\r\n    pointer-events: none;\r\n    opacity: 0.5;\r\n}\r\n\r\n::-webkit-input-placeholder {\r\n   color: #ccc;\r\n}\r\n\r\n:-moz-placeholder {\r\n   color: #ccc;  \r\n}\r\n\r\n::-moz-placeholder {\r\n   color: #ccc;  \r\n}\r\n\r\n:-ms-input-placeholder {\r\n   color: #ccc;  \r\n}\r\n\r\n\r\n.jlogin {\r\n    width: 100%;\r\n    box-sizing: border-box;\r\n    margin:0 auto;\r\n    vertical-align:middle;\r\n    border-radius: 5px;\r\n    -webkit-border-radius: 5px;\r\n    -moz-border-radius: 5px;\r\n    font-size:1em;\r\n}\r\n\r\n.jlogin-fullscreen {\r\n    position:absolute;\r\n    top:0px;\r\n    left:0px;\r\n    width:100%;\r\n    height:100%;\r\n    background-color:#fff;\r\n    z-index:9000;\r\n}\r\n\r\n.jlogin > form {\r\n    max-width:480px;\r\n    padding:20px;\r\n    margin: 0 auto;\r\n}\r\n\r\n.jlogin > form > div {\r\n    margin-bottom:10px;\r\n}\r\n\r\n.jlogin label {\r\n    display:block;\r\n}\r\n\r\n.jlogin > form > div > input {\r\n    width:100%;\r\n    outline:none;\r\n    padding:15px;\r\n    margin:0px;\r\n}\r\n\r\n.jlogin input[type='checkbox'] {\r\n    float:left;\r\n}\r\n\r\n.jlogin input[type='button'] {\r\n    padding:10px;\r\n    background-color: var(--button-color);\r\n    border: 1px solid var(--button-color);\r\n    color: #fff;\r\n    cursor:pointer;\r\n    -webkit-appearance: none;\r\n    -moz-appearance: none;\r\n    appearance: none;\r\n}\r\n\r\n.jlogin span\r\n{\r\n    margin:0 auto;\r\n}\r\n.jlogin img\r\n{\r\n    text-align:center;\r\n    max-width:220px;\r\n}\r\n\r\n.jlogin .jlogin-logo\r\n{\r\n    text-align:center;\r\n    padding:20px;\r\n}\r\n\r\n.jlogin .jlogin-logo:empty {\r\n    display: none;\r\n}\r\n\r\n.jlogin .captcha\r\n{\r\n    width:100%;\r\n    margin-top:4px;\r\n    margin-bottom:4px;\r\n    border:1px solid #ccc;\r\n    display:block;\r\n}\r\n\r\n.jlogin .facebookButton\r\n{\r\n    padding:10px;\r\n    background-color: var(--button-color);\r\n    border: 1px solid var(--button-color);\r\n    color: #fff;\r\n    text-align:center;\r\n    background-repeat:no-repeat;\r\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24px' height='24px'%3E%3Cpath d='M19,3H5C3.895,3,3,3.895,3,5v14c0,1.105,0.895,2,2,2h7.621v-6.961h-2.343v-2.725h2.343V9.309 c0-2.324,1.421-3.591,3.495-3.591c0.699-0.002,1.397,0.034,2.092,0.105v2.43h-1.428c-1.13,0-1.35,0.534-1.35,1.322v1.735h2.7 l-0.351,2.725h-2.365V21H19c1.105,0,2-0.895,2-2V5C21,3.895,20.105,3,19,3z' fill='white'/%3E%3C/svg%3E%0A\");\r\n    background-position:10px 40%;\r\n    cursor:pointer;\r\n}\r\n\r\n.jlogin .rememberButton\r\n{\r\n    padding:10px;\r\n    display:none;\r\n}\r\n\r\n.jlogin .requestButton, .jlogin .cancelButton, .jlogin .newProfileButton\r\n{\r\n    padding:20px;\r\n    padding-bottom:0px;\r\n    text-align:center;\r\n    cursor:pointer;\r\n}\r\n\r\n.jlogin-captcha img {\r\n    min-width:280px;\r\n}\r\n\r\n.jlogin-loading:before {\r\n    content: \"\";\r\n    display: block;\r\n    position: fixed;\r\n    top: 0px;\r\n    left: 0px;\r\n    width: 200px;\r\n    height: 4px;\r\n    background-color: var(--button-color);\r\n    animation: loading 2s linear infinite;\r\n}\r\n\r\n@keyframes loading {\r\n    from { left: 0px; width: 25%; }\r\n    25%  { width: 25%; }\r\n    50%  { width: 50%; }\r\n    75%  { left:  75%; }\r\n    100% { left:  100%; }\r\n    to { left: 100%; }\r\n}\r\n\r\n.jmenu .close {\r\n    position: absolute;\r\n    top: 20px;\r\n    right: 20px;\r\n}\r\n\r\n.jmenu nav {\r\n    font-family: Roboto;\r\n    position: relative;\r\n    margin-left: 5px;\r\n    margin-bottom: 25px;\r\n}\r\n\r\n.jmenu nav[data-icon] {\r\n    padding-left: 28px;\r\n}\r\n\r\n.jmenu nav[data-icon]:before {\r\n    position: absolute;\r\n    margin-top: -2px;\r\n    top: 0px;\r\n    left: 0px;\r\n    content: attr(data-icon);\r\n    width: 24px;\r\n    height: 24px;\r\n    font-size: 24px;\r\n    line-height: 24px;\r\n    font-family: 'Material icons';\r\n}\r\n\r\n.jmenu nav h2 {\r\n    text-transform: uppercase;\r\n    cursor: pointer;\r\n    display: flex;\r\n    align-items: center;\r\n    font-weight: bold;\r\n    font-size: 0.9em;\r\n}\r\n\r\n.jmenu nav h2::before {\r\n    margin-left: -18px;\r\n    position: absolute;\r\n    width: 18px;\r\n    height: 18px;\r\n    content: '';\r\n    background-repeat: no-repeat;\r\n    background-image: url(\"data:image/svg+xml,%0A%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='black' width='18px' height='18px'%3E%3Cpath d='M10 17l5-5-5-5v10z'/%3E%3Cpath d='M0 24V0h24v24H0z' fill='none'/%3E%3C/svg%3E\");\r\n    transition: transform .25s ease-in-out;\r\n}\r\n\r\n.jmenu nav[data-icon] h2::before {\r\n    margin-left: -44px;\r\n}\r\n\r\n.jmenu nav.selected h2::before {\r\n    transform: rotate(90deg);\r\n    -ms-transform: rotate(90deg);\r\n    -webkit-transform: rotate(90deg);\r\n}\r\n\r\n.jmenu nav div {\r\n    font-family: Roboto;\r\n    padding: 2px;\r\n    padding-bottom: 10px;\r\n    display: none;\r\n}\r\n\r\n.jmenu nav.selected div {\r\n    display: block;\r\n}\r\n\r\n.jmenu nav h3 {\r\n    font-size: 1em;\r\n    font-weight: normal;\r\n    color: #999;\r\n    margin-left: 10px;\r\n}\r\n\r\n.jmenu ul {\r\n    margin: 0px;\r\n    padding-left: 20px;\r\n    padding-bottom: 20px;\r\n}\r\n\r\n.jmenu div ul:last-child {\r\n    padding-bottom: 0px;\r\n}\r\n\r\n.jmenu li {\r\n    margin-bottom: 2px;\r\n    list-style: none;\r\n}\r\n\r\n.jmenu i {\r\n    margin-left: 2px;\r\n    margin-right: 5px;\r\n}\r\n\r\n.jmenu a {\r\n    color: #555;\r\n    text-decoration: none;\r\n}\r\n\r\n.jmenu a:hover, .jmenu a.selected {\r\n    text-decoration: underline;\r\n    font-weight: bold;\r\n}\r\n\r\n.jmenu .title {\r\n    border-bottom: 1px solid #ddd;\r\n    margin-bottom: 20px;\r\n    padding-bottom: 5px;\r\n}\r\n\r\n@media only screen and (max-device-width : 800px) {\r\n    .jmenu {\r\n        height:100vh;\r\n        position: fixed;\r\n        top:0px;\r\n        left:0px;\r\n        background-color:#fff;\r\n        z-index:9000;\r\n        overflow: scroll;\r\n        padding-left: 20px;\r\n        box-shadow: 1px 1px 0px 0.1px #ccc !important;\r\n        -webkit-box-shadow: 1px 0px 1px 0.1px #ccc !important;\r\n        -moz-box-shadow: 1px 1px 0px 0.1px #ccc !important;\r\n    }\r\n\r\n    .jmenu li {\r\n        margin-bottom: 10px;\r\n    }\r\n}\r\n\r\n.jorg {\n    position: relative;\n    overflow: hidden;\n}\n\n.jorg-hide-scrollbars {\n    overflow: hidden !important;\n}\n\n.jorg.fullscreen-mode {\n    position: fixed;\n    top: 0 !important;\n    left: 0 !important;\n    width: 100vw !important;\n    height: 100vh !important;\n    background: #fff;\n}\n\n.jorg-scrollParent {\n    overflow: auto;\n}\n.jorg > ul {\n    margin: 0;\n    width: 100%;\n    height: 100%;\n    padding: 0px;\n    position: relative;\n    overflow: auto;\n    display: block !important;\n}\n\n.jorg-scrollParent {\n    overflow: auto;\n}\n.jorg > ul {\n    margin: 0;\n    width: 100%;\n    height: 100%;\n    position: relative;\n    overflow: auto;\n    padding: 40px;\n    display: block !important;\n}\n\n.jorg > ul > li {\n   position: absolute;\n   left: 0;\n   min-width: 100%;\n   background: transparent;\n   min-height: 100%;\n}\n\n.jorg-search {\n    position: absolute;\n    left: 25px;\n    top: 25px;\n}\n\n.jorg-tf-tree {\n    font-size: 16px;\n}\n\n.jorg-tf-tree ul {\n    box-sizing: border-box;\n}\n\n.jorg-tf-tree ul {\n    display: inline-flex;\n}\n\n.jorg-tf-tree li {\n    align-items: center;\n    display: flex;\n    flex-direction: column;\n    flex-wrap: wrap;\n    padding: 0 1em;\n    position: relative\n}\n\n.jorg-tf-tree li ul {\n    margin: 2em 0;\n    margin-right: 40px;\n}\n\n.jorg-tf-tree li li:before {\n    border-top: 3.5px solid #CCC;\n    content: \"\";\n    display: block;\n    height: .0625em;\n    left: -.03125em;\n    position: absolute;\n    top: -1.03125em;\n    width: 100%\n}\n\n.jorg-tf-tree li li:first-child:before {\n    left: calc(50% - .03125em);\n    max-width: calc(50% + .0625em)\n}\n\n.jorg-tf-tree li li:last-child:before {\n    left: auto;\n    max-width: calc(50% + .0625em);\n    right: calc(50% - .03125em)\n}\n\n.jorg-tf-tree li li:only-child:before {\n    display: none\n}\n\n.jorg-tf-tree li li:only-child>.jorg-tf-nc:before,\n.jorg-tf-tree li li:only-child>.tf-node-content:before {\n    height: 1.0625em;\n    top: -1.0625em\n}\n\n.jorg-tf-tree .jorg-tf-nc,\n.jorg-tf-tree .tf-node-content {\n    border: 3.5px solid #CCC;\n    display: inline-block;\n    padding: .5em 1em;\n    position: relative\n}\n\n.jorg-tf-tree .jorg-tf-nc:before,\n.jorg-tf-tree .tf-node-content:before {\n    top: -1.03125em\n}\n\n.jorg-tf-tree .jorg-tf-nc:after,\n.jorg-tf-tree .jorg-tf-nc:before,\n.jorg-tf-tree .tf-node-content:after,\n.jorg-tf-tree .tf-node-content:before {\n    border-left: 3.5px solid #CCC;\n    content: \"\";\n    display: block;\n    height: 1em;\n    left: calc(50% - .03125em);\n    position: absolute;\n    width: .0625em\n}\n\n.jorg-tf-tree .jorg-tf-nc:after,\n.jorg-tf-tree .tf-node-content:after {\n    top: calc(100% + .04725em)\n}\n\n.jorg-tf-tree .jorg-tf-nc:only-child:after,\n.jorg-tf-tree .tf-node-content:only-child:after,\n.jorg-tf-tree>ul>li>.jorg-tf-nc:before,\n.jorg-tf-tree>ul>li>.tf-node-content:before {\n    display: none\n}\n\n.jorg-tf-tree.tf-gap-sm li {\n    padding: 0 .6em\n}\n\n.jorg-tf-tree.tf-gap-sm li>.jorg-tf-nc:before,\n.jorg-tf-tree.tf-gap-sm li>.tf-node-content:before {\n    height: .6em;\n    top: -.6em\n}\n\n.jorg-tf-tree.tf-gap-sm li>.jorg-tf-nc:after,\n.jorg-tf-tree.tf-gap-sm li>.tf-node-content:after {\n    height: .6em\n}\n\n.jorg-tf-tree.tf-gap-sm li ul {\n    margin: 1.2em 0\n}\n\n.jorg-tf-tree.tf-gap-sm li li:before {\n    top: -.63125em\n}\n\n.jorg-tf-tree.tf-gap-sm li li:only-child>.jorg-tf-nc:before,\n.jorg-tf-tree.tf-gap-sm li li:only-child>.tf-node-content:before {\n    height: .6625em;\n    top: -.6625em\n}\n\n.jorg-tf-tree.tf-gap-lg li {\n    padding: 0 1.5em\n}\n\n.jorg-tf-tree.tf-gap-lg li>.jorg-tf-nc:before,\n.jorg-tf-tree.tf-gap-lg li>.tf-node-content:before {\n    height: 1.5em;\n    top: -1.5em\n}\n\n.jorg-tf-tree.tf-gap-lg li>.jorg-tf-nc:after,\n.jorg-tf-tree.tf-gap-lg li>.tf-node-content:after {\n    height: 1.5em\n}\n\n.jorg-tf-tree.tf-gap-lg li ul {\n    margin: 3em 0\n}\n\n.jorg-tf-tree.tf-gap-lg li li:before {\n    top: -1.53125em\n}\n\n.jorg-tf-tree.tf-gap-lg li li:only-child>.jorg-tf-nc:before,\n.jorg-tf-tree.tf-gap-lg li li:only-child>.tf-node-content:before {\n    height: 1.5625em;\n    top: -1.5625em\n}\n\n.jorg-tf-tree li.jorg-tf-dotted-children .jorg-tf-nc:after,\n.jorg-tf-tree li.jorg-tf-dotted-children .jorg-tf-nc:before,\n.jorg-tf-tree li.jorg-tf-dotted-children .tf-node-content:after,\n.jorg-tf-tree li.jorg-tf-dotted-children .tf-node-content:before {\n    border-left-style: dotted\n}\n\n.jorg-tf-tree li.jorg-tf-dotted-children li:before {\n    border-top-style: dotted\n}\n\n.jorg-tf-tree li.jorg-tf-dotted-children>.jorg-tf-nc:before,\n.jorg-tf-tree li.jorg-tf-dotted-children>.tf-node-content:before {\n    border-left-style: solid\n}\n\n.jorg-tf-tree li.jorg-tf-dashed-children .jorg-tf-nc:after,\n.jorg-tf-tree li.jorg-tf-dashed-children .jorg-tf-nc:before,\n.jorg-tf-tree li.jorg-tf-dashed-children .tf-node-content:after,\n.jorg-tf-tree li.jorg-tf-dashed-children .tf-node-content:before {\n    border-left-style: dashed\n}\n\n.jorg-tf-tree li.jorg-tf-dashed-children li:before {\n    border-top-style: dashed\n}\n\n.jorg-tf-tree li.jorg-tf-dashed-children>.jorg-tf-nc:before,\n.jorg-tf-tree li.jorg-tf-dashed-children>.tf-node-content:before {\n    border-left-style: solid\n}\n\n/* ORGANOGRAM STYLES */\n\n.jorg-unselectable {\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -khtml-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n}\n\n.jorg-tf-tree ul.jorg-vertical {\n\tmargin: 2em 0px !important;\n\tdisplay: flex;\n\tflex-direction: column;\n\tpadding: 0px;\n\tpadding-left: 4em !important;\n    position: relative;\n}\n\n.jorg-tf-tree ul.jorg-vertical li:before {\n    content: none;\n}\n\n.jorg-tf-tree ul.jorg-vertical li {\n\tmargin-bottom: 40px;\n}\n\n.jorg-tf-tree ul.jorg-vertical span.jorg-tf-nc:before {\n    content: none;\n}\n\n.jorg-tf-tree span.jorg-after-none:after {\n    content: none;\n}\n\n.jorg-tf-tree ul.jorg-vertical:before {\n    content: '';\n    position: absolute;\n    width: 3px;\n    height: calc(100% - 2.75em);\n    top: -2em;\n    left: 3em;\n    background:#CCC;\n}\n\n.jorg-tf-tree ul.jorg-vertical li span.jorg-tf-nc:before {\n    content: '';\n    position: absolute;\n    width: 26px;\n    left: -30px;\n    top: calc(50% + 2px);\n    height: 3px;\n    background: #CCC;\n}\n\n.jorg-disable-scrollbars::-webkit-scrollbar {\n    width: 0px;\n    background: transparent; /* Chrome/Safari/Webkit */\n}\n\n.jorg-disable-scrollbars {\n  scrollbar-width: none; /* Firefox */\n  -ms-overflow-style: none;  /* IE 10+ */\n}\n\n.jorg-tf-nc {\n    width: 180px;\n    background: var(--white);\n    height: 80px;\n    word-break: break-word;\n    color: rgba(0,0,0,.7);\n    border: 1px solid rgb(228, 228, 228) !important;\n    display: flex !important;\n    flex-direction: column;\n    padding: 0 !important;\n}\n\n.jorg-user-status {\n    width: 100%;\n    height: 4px;\n    background: lightgreen;\n}\n\n.jorg-user-info {\n    width: 100%;\n    height: calc(100% - 4px);\n    display: flex;\n    flex-direction: row;\n}\n\n.jorg-user-content {\n    font-family: Roboto,Arial,Tahoma,Verdana,sans-serif;\n    text-align: left;\n    width: 108px;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: flex-start;\n    flex-direction: column;\n    overflow: hidden;\n}\n\n.jorg-user-content span:nth-child(1) {\n    color: rgba(0,0,0,.38);\n    font-weight: 500;\n    line-height: 18px;\n    text-transform: uppercase;\n}\n.jorg-user-content, .jorg-user-img {\n    font-size: 14px;\n}\n\n.jorg-user-img {\n    width: 72px;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n.jorg-user-img img {\n    width: 50px;\n    height: 50px;\n    background: var(--white);\n    border-radius: 50%;\n}\n\n.jorg-node-icon {\n    width: 18px;\n    height: 18px;\n    border-radius: 50%;\n    position: absolute;\n    bottom: -9px;\n    left: 0;\n    right: 0;\n    opacity: 0;\n    margin-left: auto;\n    margin-right: auto;\n    z-index: 1000;\n    transition: .2s opacity ease-in;\n    cursor: pointer;\n    font-weight: bold;\n    font-size: 1rem;\n}\n\n.jorg-node-icon.remove {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23607D8B' width='18px' height='18px'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11H7v-2h10v2z'/%3E%3C/svg%3E\");\n    background-size: 100% 100%;\n}\n\n.jorg-node-icon.plus {\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='24' viewBox='0 0 24 24' fill='%23607D8B' width='24'%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z'/%3E%3C/svg%3E\");\n    background-size: 100% 100%;\n}\n\n.jorg-tf-nc:hover .jorg-node-icon {\n    opacity: 1;\n}\n\n.jorg-search-animation {\n    animation: jorg-searching-hide .3s forwards;\n}\n\n.jorg-search-animation.visible {\n    animation: jorg-searching-visible .3s forwards;\n}\n\n@keyframes jorg-searching-hide {\n    0% {\n        opacity: 1;\n    }\n    100% {\n        opacity: 0;\n    }\n}\n\n@keyframes jorg-searching-visible {\n    0% {\n        opacity: 0;\n    }\n    100% {\n        opacity: 1;\n    }\n}\n\n.jorg-tf-nc[visibility='hidden']::after {\n    display: none;\n}\n\n.jorg-zoom-container {\n    position: absolute;\n    right: 25px;\n    top: 25px;\n    background: transparent;\n    margin-left: 25px;\n    display: flex;\n    justify-content: space-between;\n}\n\n.jorg-action {\n    font-size: 30px;\n    line-height: 30px;\n    width: 30px;\n    height: 30px;\n    cursor: pointer;\n}\n\n\n@media only screen and (max-width : 800px) {\n    .jorg {\n        width: 100vw !important;\n    }\n\n    .jorg > ul {\n        width: 95% !important;\n    }\n}\r\n\r\n.jtemplate-pagination {\r\n    display:flex;\r\n    cursor:pointer;\r\n    margin-top:10px;\r\n    margin-bottom:10px;\r\n}\r\n\r\n.jtemplate-pagination {\r\n    display: flex;\r\n    margin-bottom: 15px;\r\n}\r\n\r\n.jtemplate-pagination div {\r\n    text-align:center;\r\n    font-size:0.8em;\r\n    width:30px;\r\n    height:30px;\r\n    line-height:30px;\r\n    -webkit-touch-callout: none; /* iOS Safari */\r\n    -webkit-user-select: none; /* Safari */\r\n    khtml-user-select: none; /* Konqueror HTML */\r\n    -moz-user-select: none; /* Firefox */\r\n    -ms-user-select: none; /* Internet Explorer/Edge */\r\n    user-select: none;\r\n}\r\n\r\n.jtemplate-pagination div:hover {\r\n    background-color:#eee;\r\n}\r\n\r\n.jtemplate-pagination:empty {\r\n    display:none;\r\n}\r\n\r\n.jtemplate-empty:empty {\r\n    display:none;\r\n}\r\n\r\n.jtemplate-results {\r\n    margin-top:15px;\r\n    margin-bottom:15px;\r\n}\r\n\r\n\r\n.jtimeline {\r\n    overflow: hidden;\r\n    min-height:calc(100vh - 90px);\r\n    min-width: 300px;\r\n}\r\n\r\n.jtimeline-item {\r\n    display:flex;\r\n    margin-left:15px;\r\n    margin-right:15px;\r\n}\r\n\r\n.jtimeline-header {\r\n    position:fixed;\r\n    width:100%;\r\n    display:flex;\r\n    align-items: center;\r\n    justify-content:space-between;\r\n    padding:15px;\r\n    border-top:1px solid #eee;\r\n    border-bottom:1px solid #eee;\r\n    margin-top:-1px;\r\n    margin-bottom:10px;\r\n    background-color:#fff;\r\n    z-index:1;\r\n    box-sizing: border-box;\r\n}\r\n\r\n.jtimeline-year {\r\n    font-size:2.2em;\r\n    display:inline-block;\r\n}\r\n\r\n.jtimeline-month {\r\n    font-size:0.8em;\r\n    position:relative;\r\n    top:6px;\r\n}\r\n\r\n.jtimeline-navigation div {\r\n    display:inline-block;\r\n    padding-right:12px;\r\n    padding-left:12px;\r\n    margin-left:4px;\r\n    text-align: center;\r\n    cursor: pointer;\r\n}\r\n\r\n.jtimeline-navigation i {\r\n    font-size: 1.5rem !important;\r\n    line-height:32px;\r\n    display:inline-block;\r\n}\r\n\r\n.jtimeline-container {\r\n    position: relative;\r\n    padding-top:110px;\r\n    padding-bottom:30px;\r\n}\r\n\r\n.jtimeline-subtitle {\r\n    color:#aaa;\r\n    font-size:0.8em;\r\n}\r\n\r\n.jtimeline-content {\r\n    padding-top:0px;\r\n    padding-left:20px;\r\n    padding-bottom:30px;\r\n    font-size:0.8em;\r\n    border-left:3px solid #aaa;\r\n    width:100%;\r\n}\r\n\r\n.jtimeline-item:last-child .jtimeline-content {\r\n    padding-bottom:0px;\r\n}\r\n\r\n.jtimeline-text {\r\n    color:#888;\r\n    font-size:0.9em;\r\n    line-height:18px;\r\n    margin-top:5px;\r\n    margin-bottom:5px;\r\n}\r\n\r\n.jtimeline-item:last-child .jtimeline-text {\r\n}\r\n\r\n.jtimeline-date-container {\r\n    position:relative;\r\n    padding-top:0px;\r\n}\r\n\r\n.jtimeline-date {\r\n    font-size:1em;\r\n    width:40px;\r\n    padding-top:2px;\r\n}\r\n\r\n.jtimeline-title-container {\r\n    display:flex;\r\n}\r\n\r\n.jtimeline-title {\r\n    font-size:1.4em;\r\n    max-width:calc(100% - 30px);\r\n}\r\n\r\n.jtimeline-controls {\r\n    margin-left:5px;\r\n}\r\n\r\n.jtimeline-controls i {\r\n    font-size:16px;\r\n    width:16px;\r\n    height:16px;\r\n    line-height:24px;\r\n    color:#aaa;\r\n}\r\n\r\n.jtimeline-date small {\r\n    font-size:0.7em;\r\n}\r\n\r\n.jtimeline-date-bullet::after {\r\n    content:'';\r\n    width:12px;\r\n    height:12px;\r\n    border-radius:12px;\r\n    border:3px solid #00688B;\r\n    display: inline-block;\r\n    position:absolute;\r\n    top:4px;\r\n    right:-10px;\r\n    background-color:#fff;\r\n}\r\n\r\n.jtimeline-tags {\r\n    margin-top:15px;\r\n    margin-bottom:0px;\r\n    border-bottom:1px solid #fefefe;\r\n}\r\n\r\n.jtimeline-tags:empty {\r\n    display:none;\r\n}\r\n\r\n.jtimeline-tag {\r\n    padding:1px;\r\n    padding-right:10px;\r\n    padding-left:10px;\r\n    background-color:red;\r\n    color:#fff;\r\n    display:inline-block;\r\n    font-size:0.8em;\r\n    margin-bottom:5px;\r\n    margin-right:5px;\r\n}\r\n\r\n.jtimeline-message {\r\n    text-align:center;\r\n    padding:20px;\r\n    font-size:0.7em;\r\n}\r\n\r\n.jtimeline-action {\r\n    cursor: pointer;\r\n}\r\n\r\n@media only screen and (min-width: 992px) {\r\n    .jtimeline-header {\r\n        position: relative !important;\r\n    }\r\n    \r\n    .jtimeline-container {\r\n        padding: 0px !important;\r\n    }\r\n}\r\n\r\n\r\n", "jSuites.crop = (function(el, options) {\r\n    // Already created, update options\r\n    if (el.crop) {\r\n        return el.crop.setOptions(options, true);\r\n    }\r\n\r\n    // New instance\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    el.classList.add('jcrop');\r\n    // Upload icon\r\n    el.classList.add('jupload');\r\n\r\n    // Area do crop\r\n    var crop = document.createElement('div');\r\n    crop.classList.add('jcrop-area');\r\n    el.appendChild(crop);\r\n\r\n    // Canvas editor\r\n    var canvas = document.createElement('canvas');\r\n    var context = canvas.getContext('2d');\r\n    el.appendChild(canvas);\r\n\r\n    // Image\r\n    var drawImage = function() {\r\n        if (el.clientHeight > obj.image.height) {\r\n            var pointY = (el.clientHeight - obj.image.height) / 2;\r\n        } else {\r\n            var pointY = 0;\r\n        }\r\n\r\n        if (el.clientWidth > obj.image.width) {\r\n            var pointX = (el.clientWidth - obj.image.width) / 2;\r\n        } else {\r\n            var pointX = 0;\r\n        }\r\n\r\n        obj.image.left = pointX;\r\n        obj.image.top = pointY;\r\n\r\n        context.translate(pointX, pointY);\r\n        context.drawImage(obj.image, 0, 0, obj.image.width, obj.image.height);\r\n    }\r\n\r\n    obj.image = new Image();\r\n    obj.image.onload = function onload() {\r\n        obj.resetCanvas();\r\n\r\n        var w = obj.options.area[0] / this.naturalWidth;\r\n        var h = obj.options.area[1] / this.naturalHeight;\r\n\r\n        // Proportion\r\n        var p = Math.min(h, w);\r\n\r\n        // Image size\r\n        this.width = this.naturalWidth * p;\r\n        this.height = this.naturalHeight * p;\r\n\r\n        drawImage();\r\n\r\n        // Edition model\r\n        el.classList.add('jcrop_edition');\r\n\r\n        // Reset selection on desktop only\r\n        if (jSuites.getWindowWidth() > 800) {\r\n            obj.resetCropSelection();\r\n        }\r\n\r\n        // Onchange\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, obj.image);\r\n        }\r\n    };\r\n\r\n    // Properties\r\n    var properties = {\r\n        zoom: {\r\n            origin: { x: null, y: null, },\r\n            scale: 1,\r\n            fingerDistance: 0\r\n        },\r\n        contrast: 0,\r\n        brightness: 0,\r\n        rotate: 0,\r\n        saturation: 0,\r\n    };\r\n\r\n    var secondCanvas = document.createElement('canvas');\r\n    var secondContext = secondCanvas.getContext('2d');\r\n    var secondImage = document.createElement('img');\r\n\r\n    // Reload filters\r\n    var refreshFilters = function() {\r\n        secondCanvas.width = obj.image.width;\r\n        secondCanvas.height = obj.image.height;\r\n\r\n        secondContext.clearRect(0, 0, secondContext.width, secondContext.height);\r\n\r\n        secondImage.width = secondCanvas.width;\r\n        secondImage.height = secondCanvas.height;\r\n\r\n        if (obj.image) {\r\n            //drawImage();\r\n            secondContext.drawImage(obj.image, 0, 0, obj.image.width, obj.image.height);\r\n        }\r\n\r\n        // Performs the contrast, if its value is different from the initial\r\n        if (properties.contrast) {\r\n            runContrast();\r\n        }\r\n\r\n        // Performs the brightness, if its value is different from the initial\r\n        if (properties.brightness) {\r\n            runBrightness();\r\n        }\r\n\r\n        if (properties.greyScale) {\r\n            runGreyScale();\r\n        }\r\n\r\n        if (properties.saturation) {\r\n            runSaturation();\r\n        }\r\n\r\n        secondImage.src = secondCanvas.toDataURL(obj.getImageType);\r\n        secondImage.onload = function() {\r\n            context.drawImage(secondImage, 0, 0, secondImage.width, secondImage.height);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set options\r\n     */\r\n    obj.setOptions = function(options, reset) {\r\n        // Default configuration\r\n        var defaults = {\r\n            area: [ 800, 600 ],\r\n            crop: [ 200, 150 ],\r\n            value: null,\r\n            onload: null,\r\n            onchange: null,\r\n            remoteParser: null,\r\n            allowResize: true,\r\n            text: {\r\n                extensionNotAllowed: 'The extension is not allowed',\r\n            },\r\n            eventListeners: {}\r\n        };\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else {\r\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\r\n                    obj.options[property] = defaults[property];\r\n                }\r\n            }\r\n        }\r\n\r\n        // Default for mobile\r\n        if (jSuites.getWindowWidth() < 800) {\r\n            if (! obj.options.area[0]) {\r\n                obj.options.area[0] = window.clientWidth * 2;\r\n            }\r\n            if (! obj.options.area[1]) {\r\n                obj.options.area[1] = window.clientHeight * 2;\r\n            }\r\n        }\r\n\r\n        // Set options\r\n        el.style.width = obj.options.area[0] + 'px';\r\n        el.style.height = obj.options.area[1] + 'px';\r\n\r\n        canvas.width = obj.options.area[0];\r\n        canvas.height = obj.options.area[1];\r\n\r\n        // Reset all\r\n        obj.reset();\r\n\r\n        // Initial image\r\n        if (typeof obj.options.value === 'string') {\r\n            obj.image.src = obj.options.value;\r\n        }\r\n\r\n        return obj;\r\n    }\r\n\r\n    /**\r\n     * Reset crop to the initial conditions\r\n     */\r\n    obj.resetCropSelection = function() {\r\n        crop.style.left = (obj.options.area[0]/2 - obj.options.crop[0]/2) + 'px';\r\n        crop.style.top = (obj.options.area[1]/2 - obj.options.crop[1]/2) + 'px';\r\n        crop.style.width = obj.options.crop[0] + 'px';\r\n        crop.style.height = obj.options.crop[1] + 'px';\r\n        crop.style.zIndex = 1;\r\n    }\r\n\r\n    obj.getCropSelection = function() {\r\n        obj.getSelectionCoordinates();\r\n    }\r\n\r\n    // Reset canvas\r\n    obj.resetCanvas = function() {\r\n        context.setTransform(1, 0, 0, 1, 0, 0);\r\n        context.clearRect(0,0,canvas.width,canvas.height);\r\n    }\r\n\r\n    // Reset all the properties\r\n    obj.reset = function() {\r\n        // Reset crop selection\r\n        obj.resetCropSelection()\r\n        // Reset canvas\r\n        obj.resetCanvas();\r\n        // Reset state\r\n        properties = {\r\n            zoom: {\r\n                origin: { x: null, y: null },\r\n                scale: 1,\r\n            },\r\n            contrast: 0,\r\n            brightness: 0,\r\n            rotate: 0,\r\n            greyScale: 0,\r\n            saturation: 0,\r\n        }\r\n        // Reset file input\r\n        attachmentInput.value = '';\r\n        // Stop edition\r\n        el.classList.remove('jcrop_edition')\r\n    }\r\n\r\n    var callListeningFunction = function(type) {\r\n        if (typeof obj.options.eventListeners[type] === 'function') {\r\n            var types = {\r\n                zoom: properties.zoom.scale,\r\n                rotate: properties.rotate,\r\n                brightness: properties.brightness,\r\n                contrast: properties.contrast,\r\n            };\r\n\r\n            obj.options.eventListeners[type](types[type]);\r\n        }\r\n    }\r\n\r\n    // Apply the contrast on the image data\r\n    var runContrast = function() {\r\n        var contrast = properties.contrast;\r\n        var imageData = secondContext.getImageData(0, 0, secondCanvas.width, secondCanvas.height);\r\n        var data = imageData.data;  // Note: original dataset modified directly!\r\n        contrast *= 255;\r\n        var factor = (contrast + 255) / (255.01 - contrast);  //add .1 to avoid /0 error.\r\n\r\n        for (var i = 0; i < data.length; i+=4) {\r\n            data[i] = factor * (data[i] - 128) + 128;\r\n            data[i+1] = factor * (data[i+1] - 128) + 128;\r\n            data[i+2] = factor * (data[i+2] - 128) + 128;\r\n        }\r\n\r\n        secondContext.putImageData(imageData, 0, 0);\r\n\r\n        return imageData;  //optional (e.g. for filter function chaining)\r\n    }\r\n\r\n    // Change the contrast and apply that to the image\r\n    obj.contrast = function(val) { // contrast input as percent; range [-1..1]\r\n        if (! Number.isNaN(parseFloat(val))) {\r\n            properties.contrast = val;\r\n        }\r\n\r\n        callListeningFunction('contrast');\r\n\r\n        refreshFilters();\r\n    }\r\n\r\n    // Apply the brightness on the image data\r\n    var runBrightness = function () {  // brightness input as percent; range [-1..1]\r\n        var brightness = properties.brightness;\r\n        var imageData = secondContext.getImageData(0, 0, secondCanvas.width, secondCanvas.height);\r\n\r\n        var data = imageData.data;  // Note: original dataset modified directly!\r\n        brightness *= 255;\r\n\r\n        for (var i = 0; i < data.length; i+=4) {\r\n            data[i] += brightness;\r\n            data[i+1] += brightness;\r\n            data[i+2] += brightness;\r\n        }\r\n\r\n        secondContext.putImageData(imageData, 0, 0);\r\n\r\n        return imageData;  //optional (e.g. for filter function chaining)\r\n    }\r\n\r\n    // Change the brightness and apply that to the image\r\n    obj.brightness = function(val) {\r\n        if (! Number.isNaN(parseFloat(val))) {\r\n            properties.brightness = val;\r\n        }\r\n\r\n        callListeningFunction('brightness');\r\n\r\n        refreshFilters();\r\n    }\r\n\r\n    /**\r\n     * Returns the current image type\r\n     */\r\n    obj.getImageType = function() {\r\n        var dataType = obj.image.src.substr(0,20);\r\n        if (dataType.includes('data')){\r\n            return dataType.split('/')[1].split(';')[0];\r\n        }\r\n        return null;\r\n    }\r\n     /**\r\n     * Returns cropped area coordinates\r\n     */\r\n    obj.getSelectionCoordinates = function() {\r\n        return {\r\n            left: crop.offsetLeft,\r\n            top: crop.offsetTop,\r\n            right: crop.offsetLeft + crop.clientWidth,\r\n            bottom: crop.offsetTop + crop.clientHeight\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns cropped image on canvas\r\n     */\r\n    obj.getCroppedImage = function() {\r\n        return jSuites.image.create({\r\n            extension: obj.getImageType(),\r\n            file: obj.getCroppedContent(),\r\n            name: '',\r\n            size: '',\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Get cropped base64 content\r\n     */\r\n    obj.getCroppedContent = function() {\r\n        var coordinates = obj.getSelectionCoordinates();\r\n        var canvasCropped = document.createElement('canvas');\r\n        var contextCropped = canvasCropped.getContext('2d');\r\n        canvasCropped.width = crop.clientWidth;\r\n        canvasCropped.height = crop.clientHeight;\r\n\r\n        // Get cropped selection\r\n        var imageData = context.getImageData(coordinates.left, coordinates.top, crop.clientWidth, crop.clientHeight);\r\n        contextCropped.putImageData(imageData,0,0);\r\n        return canvasCropped.toDataURL(obj.getImageType());\r\n    }\r\n\r\n    /**\r\n     * Get cropped as blob\r\n     */\r\n    obj.getCroppedAsBlob = function(callback) {\r\n        if (! typeof(callback) == 'function') {\r\n            console.error('Callback not defined')\r\n            return false;\r\n        }\r\n\r\n        var coordinates = obj.getSelectionCoordinates();\r\n        var canvasCropped = document.createElement('canvas');\r\n        var contextCropped = canvasCropped.getContext('2d');\r\n        canvasCropped.width = crop.clientWidth;\r\n        canvasCropped.height = crop.clientHeight;\r\n\r\n        // Get cropped selection\r\n        var imageData = context.getImageData(coordinates.left, coordinates.top, crop.clientWidth, crop.clientHeight);\r\n        contextCropped.putImageData(imageData,0,0);\r\n\r\n        // Callback\r\n        canvasCropped.toBlob(callback);\r\n    }\r\n\r\n    /**\r\n     * Returns the current image on canvas\r\n     */\r\n    obj.getImage = function() {\r\n        return obj.image;\r\n    }\r\n\r\n    /**\r\n     *  Returns the attachment input\r\n     */\r\n    obj.getFileInput = function() { \r\n        return attachmentInput;\r\n    }\r\n\r\n    /**\r\n     * Returns the current canvas\r\n     */\r\n    obj.getCanvas = function() {\r\n        return canvas;\r\n    }\r\n\r\n    /**\r\n     * Load a image from the computer\r\n     */\r\n    obj.addFromFile = function(file) {\r\n        var type = file.type.split('/');\r\n        if (type[0] == 'image') {\r\n            var imageFile = new FileReader();\r\n            imageFile.addEventListener(\"load\", function (v) {\r\n                obj.image.src = v.target.result;\r\n            });\r\n            imageFile.readAsDataURL(file);\r\n        } else {\r\n            alert(obj.options.text.extensionNotAllowed);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load a image from a remote URL\r\n     */\r\n    obj.addFromUrl = function(src) {\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            src = obj.options.remoteParser + src;\r\n            obj.image.src = src;\r\n        }\r\n    }\r\n\r\n    // X-axis spacing of the zoom at the last scroll change\r\n    var zoomOffsetX;\r\n\r\n    // Y-axis spacing of the zoom at the last scroll change\r\n    var zoomOffsetY;\r\n\r\n    // Mouse position on the x-axis in the last use of the scroll\r\n    var lastX;\r\n\r\n    // Mouse position on the y-axis in the last use of the scroll\r\n    var lastY;\r\n\r\n    // Last zoom applied\r\n    var lastScale;\r\n\r\n    // Runs image movements\r\n    var runMove = function() {\r\n        // If the mouse was moved after the last scroll, it moves the image in relation to the x-axis\r\n        if (lastX && lastX !== properties.zoom.origin.x) {\r\n            var temp = Math.abs(properties.zoom.origin.x - zoomOffsetX - obj.image.left);\r\n            temp /= lastScale;\r\n            temp -= properties.zoom.origin.x - obj.image.left;\r\n\r\n            obj.image.left -= temp;\r\n        }\r\n\r\n        // If the mouse was moved after the last scroll, it moves the image in relation to the y-axis\r\n        if (lastY && lastY !== properties.zoom.origin.y) {\r\n            var temp = Math.abs(properties.zoom.origin.y - zoomOffsetY - obj.image.top);\r\n            temp /= lastScale;\r\n            temp -= properties.zoom.origin.y - obj.image.top;\r\n\r\n            obj.image.top -= temp;\r\n        }\r\n\r\n        // Update variables\r\n        zoomOffsetX = (properties.zoom.origin.x - obj.image.left) - (properties.zoom.origin.x - obj.image.left) * properties.zoom.scale;\r\n        zoomOffsetY = (properties.zoom.origin.y - obj.image.top) - (properties.zoom.origin.y - obj.image.top) * properties.zoom.scale;\r\n        lastX = properties.zoom.origin.x;\r\n        lastY = properties.zoom.origin.y;\r\n        lastScale = properties.zoom.scale;\r\n\r\n        // Move image\r\n        context.translate(obj.image.left + zoomOffsetX, obj.image.top + zoomOffsetY);\r\n    }\r\n\r\n    // Reload resizers and filters\r\n    var refreshResizers = function() {\r\n        // Clear canvas\r\n        context.setTransform(1, 0, 0, 1, 0, 0);\r\n        context.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n        runMove();\r\n\r\n        // Performs the zoom, if its value is different from the initial\r\n        if (properties.zoom.scale !== 1) {\r\n            runZoom();\r\n        }\r\n\r\n        // Performs the rotation, if its value is different from the initial\r\n        if (properties.rotate) {\r\n            runRotate();\r\n        }\r\n\r\n        // Calls the filter reloader\r\n        if (properties.brightness || properties.contrast) {\r\n            context.drawImage(secondImage, 0, 0, secondImage.width, secondImage.height);\r\n        } else {\r\n            context.drawImage(obj.image, 0, 0, obj.image.width, obj.image.height);\r\n        }\r\n    }\r\n\r\n    // Apply the zoom on the image\r\n    var runZoom = function() {\r\n        context.scale(properties.zoom.scale, properties.zoom.scale);\r\n    }\r\n\r\n    /**\r\n     * Change the zoom and apply that to the image\r\n     * @param mixed value / null to refresh or int for a new percentage of zoom\r\n     */\r\n    obj.zoom = function(value) {\r\n        if (value) {\r\n            properties.zoom.scale = value;\r\n        }\r\n\r\n        callListeningFunction('zoom');\r\n\r\n        refreshResizers();\r\n    }\r\n\r\n    // Apply the rotations on the image\r\n    var runRotate = function() {\r\n        var value = properties.rotate;\r\n        value *= 180;\r\n\r\n        context.translate(obj.image.width / 2, obj.image.height / 2);\r\n        context.rotate(value * Math.PI / 180);\r\n        context.translate(- obj.image.width / 2, - obj.image.height / 2);\r\n    }\r\n\r\n    // Change the rotation and apply that to the image\r\n    obj.rotate = function(val) {  // rotate input as percent; range [-1..1]\r\n        if (! Number.isNaN(parseFloat(val))) {\r\n            properties.rotate = val;\r\n        }\r\n\r\n        callListeningFunction('rotate');\r\n\r\n        refreshResizers();\r\n    }\r\n\r\n    // HTML element to load a image from the computer\r\n    var attachmentInput = document.createElement('input');\r\n    attachmentInput.type = 'file';\r\n    attachmentInput.setAttribute('accept', 'image/*');\r\n    attachmentInput.onchange = function() {\r\n        for (var i = 0; i < this.files.length; i++) {\r\n            obj.addFromFile(this.files[i]);\r\n        }\r\n    }\r\n\r\n    /** Events start here **/\r\n    var editorAction = null;\r\n    var scaling = null;\r\n\r\n    var editorMouseUp = function(e) {\r\n        editorAction = false;\r\n    }\r\n\r\n    var editorMouseDown = function(e) {\r\n        if (e.target.classList.contains('jcrop-area')) {\r\n            var rect = e.target.getBoundingClientRect();\r\n\r\n            var offsetX = (e.target.style.left !== '') ? e.target.style.left : '0px';\r\n            var offsetY = (e.target.style.top !== '') ? e.target.style.top : '0px';\r\n\r\n            if (e.target.style.cursor) {\r\n                editorAction = {\r\n                    e: e.target,\r\n                    x: e.clientX,\r\n                    y: e.clientY,\r\n                    w: rect.width,\r\n                    h: rect.height,\r\n                    d: e.target.style.cursor,\r\n                    xOffset: e.clientX - parseInt(offsetX.slice(0, offsetX.length - 2)),\r\n                    yOffset: e.clientY - parseInt(offsetY.slice(0, offsetY.length - 2)),\r\n                }\r\n\r\n                if (! e.target.style.width) {\r\n                    e.target.style.width = rect.width + 'px';\r\n                }\r\n\r\n                if (! e.target.style.height) {\r\n                    e.target.style.height = rect.height + 'px';\r\n                }\r\n\r\n                var s = window.getSelection();\r\n                if (s.rangeCount) {\r\n                    for (var i = 0; i < s.rangeCount; i++) {\r\n                        s.removeRange(s.getRangeAt(i));\r\n                    }\r\n                }\r\n            }\r\n        } else { \r\n            editorAction = true;\r\n        }\r\n    }\r\n\r\n    var editorMouseMove = function(e) {\r\n        e = e || window.event;\r\n        if (typeof(e.buttons) !== undefined) {\r\n            var mouseButton = e.buttons;\r\n        } else if (typeof(e.button) !== undefined) {\r\n            var mouseButton = e.button;\r\n        } else {\r\n            var mouseButton = e.which;\r\n        }\r\n\r\n        if (! e.buttons) {\r\n            if (e.target.classList.contains('jcrop-area')) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                if (obj.options.allowResize == true) {\r\n                    if (e.clientY - rect.top < 5) {\r\n                        if (rect.width - (e.clientX - rect.left) < 5) {\r\n                            e.target.style.cursor = 'ne-resize';\r\n                        } else if (e.clientX - rect.left < 5) {\r\n                            e.target.style.cursor = 'nw-resize';\r\n                        } else {\r\n                            e.target.style.cursor = 'n-resize';\r\n                        }\r\n                    } else if (rect.height - (e.clientY - rect.top) < 5) {\r\n                        if (rect.width - (e.clientX - rect.left) < 5) {\r\n                            e.target.style.cursor = 'se-resize';\r\n                        } else if (e.clientX - rect.left < 5) {\r\n                            e.target.style.cursor = 'sw-resize';\r\n                        } else {\r\n                            e.target.style.cursor = 's-resize';\r\n                        }\r\n                    } else if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'e-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'w-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 'move';\r\n                    }\r\n                } else {\r\n                    e.target.style.cursor = 'move';\r\n                }\r\n            }\r\n        }\r\n\r\n        if (mouseButton == 1 && editorAction && editorAction.d) {\r\n            // Change position or size\r\n            if (editorAction.d == 'move') {\r\n                // Change the position of the cropper\r\n                var cropOffsetX = e.clientX - editorAction.xOffset;\r\n                var cropOffsetY = e.clientY - editorAction.yOffset;\r\n\r\n                if (cropOffsetX < 0) {\r\n                    editorAction.e.style.left = '0px';\r\n                } else if (cropOffsetX > el.offsetWidth - crop.offsetWidth - 2) {\r\n                    editorAction.e.style.left = el.offsetWidth - crop.offsetWidth - 2 + 'px';\r\n                } else {\r\n                    editorAction.e.style.left = cropOffsetX + 'px';\r\n                }\r\n                \r\n                if (cropOffsetY < 0) {\r\n                    editorAction.e.style.top = '0px';\r\n                } else if (cropOffsetY > el.offsetHeight - crop.offsetHeight - 2){\r\n                    editorAction.e.style.top = el.offsetHeight - crop.offsetHeight - 2 + 'px';\r\n                } else {\r\n                    editorAction.e.style.top = cropOffsetY + 'px';\r\n                }\r\n            } else {\r\n                // Change the size of the cropper\r\n                if (editorAction.d == 'e-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'se-resize') {\r\n                    // Handles size changes involving the right side of the cropper\r\n                    var newWidth = editorAction.w + e.clientX - editorAction.x;\r\n                    var offset = editorAction.e.style.left.slice(0, editorAction.e.style.left.length - 2);\r\n\r\n                    if (newWidth < obj.options.crop[0]) {\r\n                        editorAction.e.style.width = obj.options.crop[0] + 'px';\r\n                    } else if (newWidth + parseInt(offset) > el.offsetWidth - 2) {\r\n                        editorAction.e.style.width = el.offsetWidth - offset - 2 + 'px';\r\n                    } else {\r\n                        editorAction.e.style.width = editorAction.w + e.clientX - editorAction.x + 'px';\r\n                    }\r\n                } else if (editorAction.d == 'w-resize' || editorAction.d == 'nw-resize' ||  editorAction.d == 'sw-resize') {\r\n                    // Handles size changes involving the left side of the cropper\r\n                    var newOffset = e.clientX - editorAction.xOffset;\r\n                    var newWidth = editorAction.x + editorAction.w - e.clientX;\r\n\r\n                    if (newWidth < obj.options.crop[0]) {\r\n                        editorAction.e.style.left = editorAction.x + editorAction.w - obj.options.crop[0] - editorAction.xOffset + 'px';\r\n                        editorAction.e.style.width = obj.options.crop[0] + 'px';\r\n                    } else if (newOffset < 0) {\r\n                        editorAction.e.style.left = '0px';\r\n                        editorAction.e.style.width = editorAction.x + editorAction.w - editorAction.xOffset + 'px';\r\n                    } else {\r\n                        editorAction.e.style.left = newOffset + 'px';\r\n                        editorAction.e.style.width = newWidth + 'px';\r\n                    }\r\n                }\r\n\r\n                if (editorAction.d == 's-resize' || editorAction.d == 'se-resize' ||  editorAction.d == 'sw-resize') {\r\n                    // Handles size changes involving the top side of the cropper\r\n                    var newHeight = editorAction.h + e.clientY - editorAction.y;\r\n                    var offset = editorAction.e.style.top.slice(0, editorAction.e.style.top.length - 2);\r\n\r\n                    if (newHeight < obj.options.crop[1]) {\r\n                        editorAction.e.style.height = obj.options.crop[1] + 'px';\r\n                    } else if (newHeight + parseInt(offset) > el.offsetHeight - 2) {\r\n                        editorAction.e.style.height = el.offsetHeight - parseInt(offset) - 2 + 'px';\r\n                    } else {\r\n                        editorAction.e.style.height = newHeight + 'px';\r\n                    }\r\n                } else if (editorAction.d == 'n-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'nw-resize') {\r\n                    // Handles size changes involving the bottom side of the cropper\r\n                    var newOffset = e.clientY - editorAction.yOffset;\r\n                    var newHeight = editorAction.h + editorAction.y - e.clientY;\r\n\r\n                    if (newHeight < obj.options.crop[1]) {\r\n                        editorAction.e.style.top = editorAction.y + editorAction.h - obj.options.crop[1] - editorAction.yOffset + 'px';\r\n                        editorAction.e.style.height = obj.options.crop[1] + 'px';\r\n                    } else if (newOffset < 0) {\r\n                        editorAction.e.style.top = '0px';\r\n                        editorAction.e.style.height = editorAction.y + editorAction.h - editorAction.yOffset + 'px';\r\n                    } else {\r\n                        editorAction.e.style.top = newOffset + 'px';\r\n                        editorAction.e.style.height = newHeight + 'px';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // image state to change its current position in el container (mobile only)\r\n    var imageState = {\r\n        mousedown: false,\r\n        mouseX: 0,\r\n        mouseY: 0\r\n    }\r\n\r\n    var touchstartListener = function(e) {\r\n        if (! e.target.classList.contains('jcrop-area')) {\r\n            imageState.mousedown = true;\r\n        }\r\n\r\n        if (e.changedTouches && e.changedTouches[0]) {\r\n            imageState.mouseX = e.changedTouches[0].clientX;\r\n            imageState.mouseY = e.changedTouches[0].clientY;\r\n        } else {\r\n            imageState.mouseX = e.clientX;\r\n            imageState.mouseY = e.clientY;\r\n        }\r\n\r\n        if (e.touches) {\r\n            if(e.touches.length == 2) {\r\n                imageState.mousedown = false;\r\n                scaling = true;\r\n                pinchStart(e);\r\n            }\r\n        }\r\n    }\r\n    var touchEndListener = function(e) {\r\n        if (scaling) {\r\n            scaling = false;\r\n        }\r\n    }\r\n\r\n    var imageMoveListener = function(e) {\r\n        if (el.classList.contains('jcrop_edition') && ! scaling) {\r\n            // Mark position\r\n            if (e.changedTouches && e.changedTouches[0]) {\r\n                var x = e.changedTouches[0].clientX;\r\n                var y = e.changedTouches[0].clientY;\r\n            } else {\r\n                var x = e.clientX;\r\n                var y = e.clientY;\r\n            }\r\n\r\n            var currentX = x;\r\n            var newX = currentX - imageState.mouseX;\r\n            imageState.mouseX = currentX;\r\n\r\n            var currentY = y;\r\n            var newY = currentY - imageState.mouseY;\r\n            imageState.mouseY = currentY;\r\n\r\n            if (imageState.mousedown) {\r\n                obj.image.left += newX/properties.zoom.scale;\r\n                obj.image.top += newY/properties.zoom.scale;\r\n                refreshResizers();\r\n            }\r\n\r\n            e.preventDefault();\r\n        }\r\n\r\n        if(scaling) {\r\n            pinchMove(e);\r\n        }\r\n    }\r\n\r\n    document.addEventListener('mouseup', function(e) {\r\n        imageState.mousedown = false;\r\n    });\r\n\r\n    el.addEventListener('mouseup', editorMouseUp);\r\n    el.addEventListener('mousedown', editorMouseDown);\r\n    el.addEventListener('mousemove', editorMouseMove);\r\n    el.addEventListener('touchstart',touchstartListener);\r\n\r\n    el.addEventListener('touchend', touchEndListener);\r\n    el.addEventListener('touchmove', imageMoveListener);\r\n    el.addEventListener('mousedown',touchstartListener);\r\n    el.addEventListener('mousemove', imageMoveListener);\r\n\r\n    el.addEventListener(\"dblclick\", function(e) {\r\n        jSuites.click(attachmentInput);\r\n    });\r\n\r\n    el.addEventListener('dragenter', function(e) {\r\n        el.style.border = '1px dashed #000';\r\n    });\r\n\r\n    el.addEventListener('dragleave', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragstop', function(e) {\r\n        el.style.border = '1px solid #eee';\r\n    });\r\n\r\n    el.addEventListener('dragover', function(e) {\r\n        e.preventDefault();\r\n    });\r\n\r\n    el.addEventListener('drop', function(e) {\r\n        e.preventDefault();  \r\n        e.stopPropagation();\r\n\r\n\r\n        var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n        var file = (e.originalEvent || e).dataTransfer.files;\r\n\r\n        if (file.length) {\r\n            for (var i = 0; i < e.dataTransfer.files.length; i++) {\r\n                obj.addFromFile(e.dataTransfer.files[i]);\r\n            }\r\n        } else if (html) {\r\n            // Create temp element\r\n            var div = document.createElement('div');\r\n            div.innerHTML = html;\r\n\r\n            // Extract images\r\n            var img = div.querySelector('img');\r\n\r\n            if (img) {\r\n                obj.addFromUrl(img.src);\r\n            }\r\n        }\r\n\r\n        el.style.border = '1px solid #eee';\r\n\r\n        return false;\r\n    });\r\n\r\n    el.addEventListener(\"wheel\", function(e) {\r\n        if (el.classList.contains('jcrop_edition')) {\r\n            // Update scale\r\n            if (e.deltaY > 0) {\r\n                if (properties.zoom.scale > 0.1) {\r\n                    properties.zoom.scale *= 0.97;\r\n                }\r\n            } else {\r\n                if (properties.zoom.scale < 5) {\r\n                    properties.zoom.scale *= 1.03;\r\n                }\r\n            }\r\n            properties.zoom.scale = parseFloat(properties.zoom.scale.toFixed(2));\r\n\r\n            // Update coordinates\r\n            var rect = el.getBoundingClientRect();\r\n            var x = e.clientX - rect.left;\r\n            var y = e.clientY - rect.top;\r\n\r\n            // Zoom on the image\r\n            var c = context.getImageData(x, y, 1, 1).data;\r\n            if (c[3] != 0) {\r\n                properties.zoom.origin.x = x;\r\n                properties.zoom.origin.y = y;\r\n            } else {\r\n            }\r\n\r\n            // Apply zoom\r\n            obj.zoom();\r\n\r\n            e.preventDefault();\r\n        }\r\n    });\r\n\r\n    // mobile events\r\n    el.addEventListener(\"click\", function(e) {\r\n        if (! el.classList.contains('jcrop_edition')) {\r\n            jSuites.click(attachmentInput);\r\n        }\r\n    });\r\n\r\n    // Initial options\r\n    obj.setOptions(options);\r\n\r\n    // Onchange\r\n    if (typeof(obj.options.onload) == 'function') {\r\n        obj.options.onload(el, obj);\r\n    }\r\n\r\n    // Mobile pinch zoom\r\n    var pinchStart = function(e) {\r\n        var rect = el.getBoundingClientRect();\r\n        properties.zoom.fingerDistance = Math.hypot(\r\n                e.touches[0].pageX - e.touches[1].pageX,\r\n                e.touches[0].pageY - e.touches[1].pageY);\r\n\r\n        properties.zoom.origin.x = ((e.touches[0].pageX - rect.left) + (e.touches[1].pageX - rect.left))/2;\r\n        properties.zoom.origin.y = ((e.touches[0].pageY - rect.top) + (e.touches[1].pageY - rect.top))/2;\r\n    }\r\n\r\n    var pinchMove = function(e) {\r\n        e.preventDefault();\r\n\r\n        var dist2 = Math.hypot(e.touches[0].pageX - e.touches[1].pageX,e.touches[0].pageY - e.touches[1].pageY);\r\n\r\n        if (dist2 > properties.zoom.fingerDistance) {\r\n            var dif =  dist2 - properties.zoom.fingerDistance;\r\n            var newZoom = properties.zoom.scale + properties.zoom.scale * dif * 0.0025;\r\n            if (newZoom <= 5.09) {\r\n               obj.zoom(newZoom);\r\n            }\r\n        }\r\n\r\n        if (dist2 < properties.zoom.fingerDistance) {\r\n            var dif =  properties.zoom.fingerDistance - dist2;\r\n            var newZoom = properties.zoom.scale - properties.zoom.scale * dif * 0.0025;\r\n            if (newZoom >= 0.1) {\r\n               obj.zoom(newZoom);\r\n            }\r\n        }\r\n        properties.zoom.fingerDistance = dist2;\r\n    }\r\n\r\n    el.crop = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.floating = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        type: 'big',\r\n        title: 'Untitled',\r\n        width: 510,\r\n        height: 472,\r\n    }\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Private methods\r\n\r\n    var setContent = function() {\r\n        var temp = document.createElement('div');\r\n        while (el.children[0]) {\r\n            temp.appendChild(el.children[0]);\r\n        }\r\n\r\n        obj.content = document.createElement('div');\r\n        obj.content.className = 'jfloating_content';\r\n        obj.content.innerHTML = el.innerHTML;\r\n\r\n        while (temp.children[0]) {\r\n            obj.content.appendChild(temp.children[0]);\r\n        }\r\n\r\n        obj.container = document.createElement('div');\r\n        obj.container.className = 'jfloating';\r\n        obj.container.appendChild(obj.content);\r\n\r\n        if (obj.options.title) {\r\n            obj.container.setAttribute('title', obj.options.title);\r\n        } else {\r\n            obj.container.classList.add('no-title');\r\n        }\r\n\r\n        // validate element dimensions\r\n        if (obj.options.width) {\r\n            obj.container.style.width = parseInt(obj.options.width) + 'px';\r\n        }\r\n\r\n        if (obj.options.height) {\r\n            obj.container.style.height = parseInt(obj.options.height) + 'px';\r\n        }\r\n\r\n        el.innerHTML = '';\r\n        el.appendChild(obj.container);\r\n    }\r\n\r\n    var setEvents = function() {\r\n        if (obj.container) {\r\n            obj.container.addEventListener('click', function(e) {\r\n                var rect = e.target.getBoundingClientRect();\r\n\r\n                if (e.target.classList.contains('jfloating')) {\r\n                    if (e.changedTouches && e.changedTouches[0]) {\r\n                        var x = e.changedTouches[0].clientX;\r\n                        var y = e.changedTouches[0].clientY;\r\n                    } else {\r\n                        var x = e.clientX;\r\n                        var y = e.clientY;\r\n                    }\r\n    \r\n                    if (rect.width - (x - rect.left) < 50 && (y - rect.top) < 50) {\r\n                        setTimeout(function() {\r\n                            obj.close();\r\n                        }, 100);\r\n                    } else {\r\n                        obj.setState();\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    var setType = function() {\r\n        obj.container.classList.add('jfloating-' + obj.options.type);\r\n    }\r\n\r\n    obj.state = {\r\n        isMinized: false,\r\n    }\r\n\r\n    obj.setState = function() {\r\n        if (obj.state.isMinized) {\r\n            obj.container.classList.remove('jfloating-minimized');\r\n        } else {\r\n            obj.container.classList.add('jfloating-minimized');\r\n        }\r\n        obj.state.isMinized = ! obj.state.isMinized;\r\n    }\r\n\r\n    obj.close = function() {\r\n        jSuites.floating.elements.splice(jSuites.floating.elements.indexOf(obj.container), 1);\r\n        obj.updatePosition();\r\n        el.remove();\r\n    }\r\n\r\n    obj.updatePosition = function() {\r\n        for (var i = 0; i < jSuites.floating.elements.length; i ++) {\r\n            var floating = jSuites.floating.elements[i];\r\n            var prevFloating = jSuites.floating.elements[i - 1];\r\n            floating.style.right = i * (prevFloating ? prevFloating.offsetWidth : floating.offsetWidth) * 1.01 + 'px';\r\n        }\r\n    }   \r\n\r\n    obj.init = function() {\r\n        // Set content into root\r\n        setContent();\r\n\r\n        // Set dialog events\r\n        setEvents();\r\n\r\n        // Set dialog type\r\n        setType();\r\n\r\n        // Update floating position\r\n        jSuites.floating.elements.push(obj.container);\r\n        obj.updatePosition();\r\n\r\n        el.floating = obj;\r\n    }\r\n    \r\n    obj.init();\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.floating.elements = [];\r\n\r\njSuites.login = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        url: window.location.href,\r\n        prepareRequest: null,\r\n        accessToken: null,\r\n        deviceToken: null,\r\n        facebookUrl: null,\r\n        facebookAuthentication: null,\r\n        maxHeight: null,\r\n        onload: null,\r\n        onsuccess: null,\r\n        onerror: null,\r\n        message: null,\r\n        logo: null,\r\n        newProfile: false,\r\n        newProfileUrl: false,\r\n        newProfileLogin: false,\r\n        fullscreen: false,\r\n        newPasswordValidation: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Action\r\n    var action = null;\r\n\r\n    // Container\r\n    var container = document.createElement('form');\r\n    el.appendChild(container);\r\n\r\n    // Logo\r\n    var divLogo = document.createElement('div');\r\n    divLogo.className = 'jlogin-logo'\r\n    container.appendChild(divLogo);\r\n\r\n    if (obj.options.logo) {\r\n        var logo = document.createElement('img');\r\n        logo.src = obj.options.logo;\r\n        divLogo.appendChild(logo);\r\n    }\r\n\r\n    // Code\r\n    var labelCode = document.createElement('label');\r\n    labelCode.innerHTML = jSuites.translate('Please enter here the code received by email');\r\n    var inputCode = document.createElement('input');\r\n    inputCode.type = 'number';\r\n    inputCode.id = 'code';\r\n    inputCode.setAttribute('maxlength', 6);\r\n    var divCode = document.createElement('div');\r\n    divCode.appendChild(labelCode);\r\n    divCode.appendChild(inputCode);\r\n\r\n    // Hash\r\n    var inputHash = document.createElement('input');\r\n    inputHash.type = 'hidden';\r\n    inputHash.name = 'h';\r\n    var divHash = document.createElement('div');\r\n    divHash.appendChild(inputHash);\r\n\r\n    // Recovery\r\n    var inputRecovery = document.createElement('input');\r\n    inputRecovery.type = 'hidden';\r\n    inputRecovery.name = 'recovery';\r\n    inputRecovery.value = '1';\r\n    var divRecovery = document.createElement('div');\r\n    divRecovery.appendChild(inputRecovery);\r\n\r\n    // Login\r\n    var labelLogin = document.createElement('label');\r\n    labelLogin.innerHTML = jSuites.translate('Login');\r\n    var inputLogin = document.createElement('input');\r\n    inputLogin.type = 'text';\r\n    inputLogin.name = 'login';\r\n    inputLogin.setAttribute('autocomplete', 'off');\r\n    inputLogin.onkeyup = function() {\r\n        this.value = this.value.toLowerCase().replace(/[^a-zA-Z0-9_+]+/gi, '');\r\n    } \r\n    var divLogin = document.createElement('div');\r\n    divLogin.appendChild(labelLogin);\r\n    divLogin.appendChild(inputLogin);\r\n\r\n    // Name\r\n    var labelName = document.createElement('label');\r\n    labelName.innerHTML = jSuites.translate('Name');\r\n    var inputName = document.createElement('input');\r\n    inputName.type = 'text';\r\n    inputName.name = 'name';\r\n    var divName = document.createElement('div');\r\n    divName.appendChild(labelName);\r\n    divName.appendChild(inputName);\r\n\r\n    // Email\r\n    var labelUsername = document.createElement('label');\r\n    labelUsername.innerHTML = jSuites.translate('E-mail');\r\n    var inputUsername = document.createElement('input');\r\n    inputUsername.type = 'text';\r\n    inputUsername.name = 'username';\r\n    inputUsername.setAttribute('autocomplete', 'new-username');\r\n    var divUsername = document.createElement('div');\r\n    divUsername.appendChild(labelUsername);\r\n    divUsername.appendChild(inputUsername);\r\n\r\n    // Password\r\n    var labelPassword = document.createElement('label');\r\n    labelPassword.innerHTML = jSuites.translate('Password');\r\n    var inputPassword = document.createElement('input');\r\n    inputPassword.type = 'password';\r\n    inputPassword.name = 'password';\r\n    inputPassword.setAttribute('autocomplete', 'new-password');\r\n    var divPassword = document.createElement('div');\r\n    divPassword.appendChild(labelPassword);\r\n    divPassword.appendChild(inputPassword);\r\n    divPassword.onkeydown = function(e) {\r\n        if (e.keyCode == 13) {\r\n            obj.execute();\r\n        }\r\n    }\r\n\r\n    // Repeat password\r\n    var labelRepeatPassword = document.createElement('label');\r\n    labelRepeatPassword.innerHTML = jSuites.translate('Repeat the new password');\r\n    var inputRepeatPassword = document.createElement('input');\r\n    inputRepeatPassword.type = 'password';\r\n    inputRepeatPassword.name = 'password';\r\n    var divRepeatPassword = document.createElement('div');\r\n    divRepeatPassword.appendChild(labelRepeatPassword);\r\n    divRepeatPassword.appendChild(inputRepeatPassword);\r\n\r\n    // Remember checkbox\r\n    var labelRemember = document.createElement('label');\r\n    labelRemember.innerHTML = jSuites.translate('Remember me on this device');\r\n    var inputRemember = document.createElement('input');\r\n    inputRemember.type = 'checkbox';\r\n    inputRemember.name = 'remember';\r\n    inputRemember.value = '1';\r\n    labelRemember.appendChild(inputRemember);\r\n    var divRememberButton = document.createElement('div');\r\n    divRememberButton.className = 'rememberButton';\r\n    divRememberButton.appendChild(labelRemember);\r\n\r\n    // Login button\r\n    var actionButton = document.createElement('input');\r\n    actionButton.type = 'button';\r\n    actionButton.value = 'Log In';\r\n    actionButton.onclick = function() {\r\n        obj.execute();\r\n    }\r\n    var divActionButton = document.createElement('div');\r\n    divActionButton.appendChild(actionButton);\r\n\r\n    // Cancel button\r\n    var cancelButton = document.createElement('div');\r\n    cancelButton.innerHTML = jSuites.translate('Cancel');\r\n    cancelButton.className = 'cancelButton';\r\n    cancelButton.onclick = function() {\r\n        obj.requestAccess();\r\n    }\r\n    var divCancelButton = document.createElement('div');\r\n    divCancelButton.appendChild(cancelButton);\r\n\r\n    // Captcha\r\n    var labelCaptcha = document.createElement('label');\r\n    labelCaptcha.innerHTML = jSuites.translate('Please type here the code shown below');\r\n    var inputCaptcha = document.createElement('input');\r\n    inputCaptcha.type = 'text';\r\n    inputCaptcha.name = 'captcha';\r\n    var imageCaptcha = document.createElement('img');\r\n    var divCaptcha = document.createElement('div');\r\n    divCaptcha.className = 'jlogin-captcha';\r\n    divCaptcha.appendChild(labelCaptcha);\r\n    divCaptcha.appendChild(inputCaptcha);\r\n    divCaptcha.appendChild(imageCaptcha);\r\n\r\n    // Facebook\r\n    var facebookButton = document.createElement('div');\r\n    facebookButton.innerHTML = jSuites.translate('Login with Facebook');\r\n    facebookButton.className = 'facebookButton';\r\n    var divFacebookButton = document.createElement('div');\r\n    divFacebookButton.appendChild(facebookButton);\r\n    divFacebookButton.onclick = function() {\r\n        obj.requestLoginViaFacebook();\r\n    }\r\n    // Forgot password\r\n    var inputRequest = document.createElement('span');\r\n    inputRequest.innerHTML = jSuites.translate('Request a new password');\r\n    var divRequestButton = document.createElement('div');\r\n    divRequestButton.className = 'requestButton';\r\n    divRequestButton.appendChild(inputRequest);\r\n    divRequestButton.onclick = function() {\r\n        obj.requestNewPassword();\r\n    }\r\n    // Create a new Profile\r\n    var inputNewProfile = document.createElement('span');\r\n    inputNewProfile.innerHTML = jSuites.translate('Create a new profile');\r\n    var divNewProfileButton = document.createElement('div');\r\n    divNewProfileButton.className = 'newProfileButton';\r\n    divNewProfileButton.appendChild(inputNewProfile);\r\n    divNewProfileButton.onclick = function() {\r\n        obj.newProfile();\r\n    }\r\n\r\n    el.className = 'jlogin';\r\n\r\n    if (obj.options.fullscreen == true) {\r\n        el.classList.add('jlogin-fullscreen');\r\n    }\r\n\r\n    /** \r\n     * Show message\r\n     */\r\n    obj.showMessage = function(data) {\r\n        var message = (typeof(data) == 'object') ? data.message : data;\r\n\r\n        if (typeof(obj.options.message) == 'function') {\r\n            obj.options.message(data);\r\n        } else {\r\n            jSuites.alert(data);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * New profile\r\n     */\r\n    obj.newProfile = function() {\r\n        container.innerHTML = '';\r\n        container.appendChild(divLogo);\r\n        if (obj.options.newProfileLogin) {\r\n            container.appendChild(divLogin);\r\n        }\r\n        container.appendChild(divName);\r\n        container.appendChild(divUsername);\r\n        container.appendChild(divActionButton);\r\n        if (obj.options.facebookAuthentication == true) {\r\n            container.appendChild(divFacebookButton);\r\n        }\r\n        container.appendChild(divCancelButton);\r\n\r\n        // Reset inputs\r\n        inputLogin.value = '';\r\n        inputUsername.value = '';\r\n        inputPassword.value = '';\r\n\r\n        // Button\r\n        actionButton.value = jSuites.translate('Create a new profile');\r\n\r\n        // Action\r\n        action = 'newProfile';\r\n    }\r\n\r\n    /**\r\n     * Request the email with the recovery instructions\r\n     */\r\n    obj.requestNewPassword = function() {\r\n        if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\r\n            var captcha = true;\r\n        }\r\n\r\n        container.innerHTML = '';\r\n        container.appendChild(divLogo);\r\n        container.appendChild(divRecovery);\r\n        container.appendChild(divUsername);\r\n        if (captcha) {\r\n            container.appendChild(divCaptcha);\r\n        }\r\n        container.appendChild(divActionButton);\r\n        container.appendChild(divCancelButton);\r\n        actionButton.value = jSuites.translate('Request a new password');\r\n        inputRecovery.value = 1;\r\n\r\n        // Action\r\n        action = 'requestNewPassword';\r\n    }\r\n\r\n    /**\r\n     * Confirm recovery code\r\n     */\r\n    obj.codeConfirmation = function() {\r\n        container.innerHTML = '';\r\n        container.appendChild(divLogo);\r\n        container.appendChild(divHash);\r\n        container.appendChild(divCode);\r\n        container.appendChild(divActionButton);\r\n        container.appendChild(divCancelButton);\r\n        actionButton.value = jSuites.translate('Confirm the code');\r\n        inputRecovery.value = 2;\r\n\r\n        // Action\r\n        action = 'codeConfirmation';\r\n    }\r\n\r\n    /**\r\n     * Update my password\r\n     */\r\n    obj.changeMyPassword = function(hash) {\r\n        container.innerHTML = '';\r\n        container.appendChild(divLogo);\r\n        container.appendChild(divHash);\r\n        container.appendChild(divPassword);\r\n        container.appendChild(divRepeatPassword);\r\n        container.appendChild(divActionButton);\r\n        container.appendChild(divCancelButton);\r\n        actionButton.value = jSuites.translate('Change my password');\r\n        inputHash.value = hash;\r\n\r\n        // Action\r\n        action = 'changeMyPassword';\r\n    }\r\n\r\n    /**\r\n     * Request access default method\r\n     */\r\n    obj.requestAccess = function() {\r\n        container.innerHTML = '';\r\n        container.appendChild(divLogo);\r\n        container.appendChild(divUsername);\r\n        container.appendChild(divPassword);\r\n        container.appendChild(divActionButton);\r\n        if (obj.options.facebookAuthentication == true) {\r\n            container.appendChild(divFacebookButton);\r\n        }\r\n        container.appendChild(divRequestButton);\r\n        container.appendChild(divRememberButton);\r\n        container.appendChild(divRequestButton);\r\n        if (obj.options.newProfile == true) {\r\n            container.appendChild(divNewProfileButton);\r\n        }\r\n\r\n        // Button\r\n        actionButton.value = jSuites.translate('Login');\r\n\r\n        // Password\r\n        inputPassword.value = '';\r\n\r\n        // Email persistence\r\n        if (window.localStorage.getItem('username')) {\r\n            inputUsername.value = window.localStorage.getItem('username');\r\n            inputPassword.focus();\r\n        } else {\r\n            inputUsername.focus();\r\n        }\r\n\r\n        // Action\r\n        action = 'requestAccess';\r\n    }\r\n\r\n    /**\r\n     * Request login via facebook\r\n     */\r\n    obj.requestLoginViaFacebook = function() {\r\n        if (typeof(deviceNotificationToken) == 'undefined') {\r\n            FB.getLoginStatus(function(response) {\r\n                if (! response.status || response.status != 'connected') {\r\n                    FB.login(function(response) {\r\n                        if (response.authResponse) {\r\n                            obj.execute({ f:response.authResponse.accessToken });\r\n                        } else {\r\n                            obj.showMessage(jSuites.translate('Not authorized by facebook'));\r\n                        }\r\n                    }, {scope: 'public_profile,email'});\r\n                } else {\r\n                    obj.execute({ f:response.authResponse.accessToken });\r\n                }\r\n            }, true);\r\n        } else {\r\n            jDestroy = function() {\r\n                fbLogin.removeEventListener('loadstart', jStart);\r\n                fbLogin.removeEventListener('loaderror', jError);\r\n                fbLogin.removeEventListener('exit', jExit);\r\n                fbLogin.close();\r\n                fbLogin = null;\r\n            }\r\n\r\n            jStart = function(event) {\r\n                var url = event.url;\r\n                if (url.indexOf(\"access_token\") >= 0) {\r\n                    setTimeout(function(){\r\n                        var u = url.match(/=(.*?)&/);\r\n                        if (u[1].length > 32) {\r\n                            obj.execute({ f:u[1] });\r\n                        }\r\n                        jDestroy();\r\n                   },500);\r\n                }\r\n\r\n                if (url.indexOf(\"error=access_denied\") >= 0) {\r\n                   setTimeout(jDestroy ,500);\r\n                   // Not authorized by facebook\r\n                   obj.showMessage(jSuites.translate('Not authorized by facebook'));\r\n                }\r\n            }\r\n\r\n            jError = function(event) {\r\n                jDestroy();\r\n            }\r\n        \r\n            jExit = function(event) {\r\n                jDestroy();\r\n            }\r\n\r\n            fbLogin = window.open(obj.options.facebookUrl, \"_blank\", \"location=no,closebuttoncaption=Exit,disallowoverscroll=yes,toolbar=no\");\r\n            fbLogin.addEventListener('loadstart', jStart);\r\n            fbLogin.addEventListener('loaderror', jError);\r\n            fbLogin.addEventListener('exit', jExit);\r\n        }\r\n\r\n        // Action\r\n        action = 'requestLoginViaFacebook';\r\n    }\r\n\r\n    // Perform request\r\n    obj.execute = function(data) {\r\n        // New profile\r\n        if (action == 'newProfile') {\r\n            if (! jSuites.validations.email(inputUsername.value)) {\r\n                var message = jSuites.translate('Invalid e-mail address'); \r\n            }\r\n            if (! jSuites.validations.login(inputLogin.value)) {\r\n                var message = jSuites.translate('Invalid username, please use only characters and numbers');\r\n            }\r\n            if (message) {\r\n                obj.showMessage(message);\r\n                return false;\r\n            }\r\n        } else if (action == 'changeMyPassword') {\r\n            if (inputPassword.value.length < 3) {\r\n                var message = jSuites.translate('Password is too short');\r\n            } else  if (inputPassword.value != inputRepeatPassword.value) {\r\n                var message = jSuites.translate('Password should match');\r\n            } else {\r\n                if (typeof(obj.options.newPasswordValidation) == 'function') {\r\n                    var val = obj.options.newPasswordValidation(obj, inputPassword.value, inputPassword.value);\r\n                    if (val != undefined) {\r\n                        message = val;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (message) {\r\n                obj.showMessage(message);\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Keep email\r\n        if (inputUsername.value != '') {\r\n            window.localStorage.setItem('username', inputUsername.value);\r\n        }\r\n\r\n        // Captcha\r\n        if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\r\n            if (inputCaptcha.value == '') {\r\n                obj.showMessage(jSuites.translate('Please enter the captch code below'));\r\n                return false;\r\n            }\r\n        }\r\n\r\n        // Url\r\n        var url = obj.options.url;\r\n\r\n        // Device token\r\n        if (obj.options.deviceToken) {\r\n            url += '?token=' + obj.options.deviceToken;\r\n        }\r\n\r\n        // Callback\r\n        var onsuccess = function(result) {\r\n            if (result) {\r\n                // Successfully response\r\n                if (result.success == 1) {\r\n                    // Recovery process\r\n                    if (action == 'requestNewPassword') {\r\n                        obj.codeConfirmation();\r\n                    } else if (action == 'codeConfirmation') {\r\n                        obj.requestAccess();\r\n                    } else if (action == 'newProfile') {\r\n                        obj.requestAccess();\r\n                        // New profile\r\n                        result.newProfile = true;\r\n                    }\r\n\r\n                    // Token\r\n                    if (result.token) {\r\n                        // Set token\r\n                        obj.options.accessToken = result.token;\r\n                        // Save token\r\n                        window.localStorage.setItem('Access-Token', result.token);\r\n                    }\r\n                }\r\n\r\n                // Show message\r\n                if (result.message) {\r\n                    // Show message\r\n                    obj.showMessage(result.message)\r\n                }\r\n\r\n                // Request captcha code\r\n                if (! result.data) {\r\n                    if (Array.prototype.indexOf.call(container.children, divCaptcha) >= 0) {\r\n                        divCaptcha.remove();\r\n                    }\r\n                } else {\r\n                    container.insertBefore(divCaptcha, divActionButton);\r\n                    imageCaptcha.setAttribute('src', 'data:image/png;base64,' + result.data);\r\n                }\r\n\r\n                // Give time to user see the message\r\n                if (result.hash) {\r\n                    // Change password\r\n                    obj.changeMyPassword(result.hash);\r\n                } else if (result.url) {\r\n                    // App initialization\r\n                    if (result.success == 1) {\r\n                        if (typeof(obj.options.onsuccess) == 'function') {\r\n                            obj.options.onsuccess(result);\r\n                        } else {\r\n                            if (result.message) {\r\n                                setTimeout(function() { window.location.href = result.url; }, 2000);\r\n                            } else {\r\n                                window.location.href = result.url;\r\n                            }\r\n                        }\r\n                    } else {\r\n                        if (typeof(obj.options.onerror) == 'function') {\r\n                            obj.options.onerror(result);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Password\r\n        if (! data) {\r\n            var data = jSuites.form.getElements(el, true);\r\n            // Encode passworfd\r\n            if (data.password) {\r\n                data.password = jSuites.sha512(data.password);\r\n            }\r\n            // Recovery code\r\n            if (Array.prototype.indexOf.call(container.children, divCode) >= 0 && inputCode.value) {\r\n                data.h = jSuites.sha512(inputCode.value);\r\n            }\r\n        }\r\n\r\n        // Loading\r\n        el.classList.add('jlogin-loading');\r\n\r\n        // Url\r\n        var url = (action == 'newProfile' && obj.options.newProfileUrl) ? obj.options.newProfileUrl : obj.options.url;\r\n\r\n        // Remote call\r\n        jSuites.ajax({\r\n            url: url,\r\n            method: 'POST',\r\n            dataType: 'json',\r\n            data: data,\r\n            success: function(result) {\r\n                // Remove loading\r\n                el.classList.remove('jlogin-loading');\r\n                // Callback\r\n                onsuccess(result);\r\n            },\r\n            error: function(result) {\r\n                // Error\r\n                el.classList.remove('jlogin-loading');\r\n\r\n                if (typeof(obj.options.onerror) == 'function') {\r\n                    obj.options.onerror(result);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    var queryString = window.location.href.split('?');\r\n    if (queryString[1] && queryString[1].length == 130 && queryString[1].substr(0,2) == 'h=') {\r\n        obj.changeMyPassword(queryString[1].substr(2));\r\n    } else {\r\n        obj.requestAccess();\r\n    }\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.login.sha512 = jSuites.sha512;\r\n\r\njSuites.menu = (function(el, options) {\r\n    var obj = {};\r\n\r\n    obj.show = function() {\r\n        el.style.display = 'block';\r\n        jSuites.animation.slideLeft(el, 1);\r\n    }\r\n\r\n    obj.hide = function() {\r\n        jSuites.animation.slideLeft(el, 0, function() {\r\n            el.style.display = '';\r\n        });\r\n    }\r\n\r\n    obj.load = function() {\r\n        if (localStorage) {\r\n            var menu = el.querySelectorAll('nav');\r\n            var selected = null;\r\n            for (var i = 0; i < menu.length; i++) {\r\n                menu[i].classList.remove('selected');\r\n                if (menu[i].getAttribute('data-id')) {\r\n                    var state = localStorage.getItem('jmenu-' + menu[i].getAttribute('data-id'));\r\n                    if (state == 1) {\r\n                        menu[i].classList.add('selected');\r\n                    }\r\n                }\r\n            }\r\n            var href = window.location.pathname;\r\n            if (href) {\r\n                var menu = document.querySelector('.jmenu a[href=\"'+ href +'\"]');\r\n                if (menu) {\r\n                    menu.classList.add('selected');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.select = function(o, e) {\r\n        if (o.tagName == 'NAV') {\r\n            var m = el.querySelectorAll('nav');\r\n            for (var i = 0; i < m.length; i++) {\r\n                m[i].style.display = 'none';\r\n            }\r\n            o.style.display = '';\r\n            o.classList.add('selected');\r\n        } else {\r\n            var m = el.querySelectorAll('nav a');\r\n            for (var i = 0; i < m.length; i++) {\r\n                m[i].classList.remove('selected');\r\n            }\r\n            o.classList.add('selected');\r\n\r\n            // Better navigation\r\n            if (options && options.collapse == true) {\r\n                if (o.classList.contains('show')) {\r\n                    m = el.querySelectorAll('nav');\r\n                    for (var i = 0; i < m.length; i++) {\r\n                        m[i].style.display = '';\r\n                    }\r\n                    o.style.display = 'none';\r\n                } else {\r\n                    m = el.querySelectorAll('nav');\r\n                    for (var i = 0; i < m.length; i++) {\r\n                        m[i].style.display = 'none';\r\n                    }\r\n\r\n                    m = el.querySelector('.show');\r\n                    if (m) {\r\n                        m.style.display = 'block';\r\n                    }\r\n\r\n                    m = jSuites.findElement(o.parentNode, 'selected');\r\n                    if (m) {\r\n                        m.style.display = '';\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (options && typeof(options.onclick) == 'function') {\r\n            options.onclick(obj, e);\r\n        }\r\n\r\n        // Close menu if is oped\r\n        if (jSuites.getWindowWidth() < 800) {\r\n            obj.hide();\r\n        }\r\n    }\r\n\r\n    var action = function(e) {\r\n        if (e.target.tagName == 'H2') {\r\n            if (e.target.parentNode.classList.contains('selected')) {\r\n                e.target.parentNode.classList.remove('selected');\r\n                localStorage.setItem('jmenu-' + e.target.parentNode.getAttribute('data-id'), 0);\r\n            } else {\r\n                e.target.parentNode.classList.add('selected');\r\n                localStorage.setItem('jmenu-' + e.target.parentNode.getAttribute('data-id'), 1);\r\n            }\r\n        } else if (e.target.tagName == 'A') {\r\n            // Mark link as selected\r\n            obj.select(e.target, e);\r\n        }\r\n    }\r\n\r\n    if ('ontouchstart' in document.documentElement === true) {\r\n        el.addEventListener('touchsend', action);\r\n    } else {\r\n        el.addEventListener('mouseup', action);\r\n    }\r\n\r\n    // Add close action\r\n    var i = document.createElement('i');\r\n    i.className = 'material-icons small-screen-only close';\r\n    i.innerText = 'close';\r\n    i.onclick = function() {\r\n        obj.hide();\r\n    }\r\n    el.appendChild(i);\r\n\r\n    // Add menu class\r\n    el.classList.add('jmenu');\r\n\r\n    // Load state\r\n    obj.load();\r\n\r\n    if (options && typeof(options.onload) == 'function') {\r\n        options.onload(el);\r\n    }\r\n\r\n    // Keep reference\r\n    el.menu = obj;\r\n\r\n    return obj;\r\n});\r\n\r\n\r\njSuites.organogram = (function(el, options) {\n    if (el.organogram) {\n        return el.organogram.setOptions(options, true);\n    }\n\n    var obj = {};\n    obj.options = {};\n\n    // Defines the state to deal with mouse events \n    var state = {\n        x: 0,\n        y: 0,\n        initialWidth: 0,\n        initialTop: 100,\n        fingerDistance: 0,\n        mobileDown: false,\n        scaling: false,\n        scale: 1,\n    }\n\n    var getRoleById = function(id) {\n       for (var i = 0; i < obj.options.roles.length; i++) {\n           if (id == obj.options.roles[i].id) {\n               return obj.options.roles[i];\n           }\n       }\n       return false;\n    }\n\n    var getContent = function(node) {\n        var role = node.role;\n        var color = node.color || 'lightgreen';\n        if (obj.options.roles && node.role >= 0) {\n            var o = getRoleById(node.role);\n            if (o) {\n                role = o.name;\n                var color = o.color;\n            }\n        }\n\n        return `<div class=\"jorg-user-status\" style=\"background:${color}\"></div>\n            <div class=\"jorg-user-info\">\n                <div class='jorg-user-img'><img src=\"${node.img ? node.img : '#'}\" ondragstart=\"return false\" /></div>\n                <div class='jorg-user-content'><span>${node.name}</span><span>${role}</span></div>\n            </div>`;\n    }\n\n    // Creates the shape of a node to be added to the organogram chart tree\n    var mountNodes = function(node, container) {\n        var li = document.createElement('li');\n        var span = document.createElement('span');\n        span.className = 'jorg-tf-nc';\n        span.innerHTML = getContent(node);\n        span.setAttribute('id', node.id);\n        var ul = document.createElement('ul');\n        li.appendChild(span);\n        li.appendChild(ul);\n        container.appendChild(li);\n\n        return ul;\n    }\n\n    // Return the render mode ( vertical or horizontal )\n    var getRenderMode = function(container) {\n        if (container.parentNode == el) {\n            return 'horizontal';\n        }\n        if (container.children.length > 1) {\n            for (var i = 0; i < container.children.length; i ++) {\n                if (Array.from(container.children[i].children).find(element => element.tagName == 'UL')) {\n                    return 'horizontal';\n                }\n            }\n            return 'vertical';\n        }\n        return 'vertical';\n    }\n\n    // Node visibility feature\n    var setNodeVisibility = function(node) {\n        var className = \"jorg-node-icon\";\n        var icon = document.createElement('div');\n        var ulNode = node.nextElementSibling;\n        node.appendChild(icon);\n\n        if (ulNode) {\n            icon.className = className + ' remove';\n        } else {\n            icon.className = className + ' plus'\n            return ;\n        }\n\n        icon.addEventListener('click', function(e) {\n            if (node.nextElementSibling.style.display == 'none') {\n                node.nextElementSibling.style.display = 'inline-flex';\n                node.removeAttribute('visibility');\n                e.target.className = className + ' remove';\n            } else {\n                node.nextElementSibling.style.display = 'none';\n                node.setAttribute('visibility','hidden');\n                e.target.className = className + ' plus';\n            }\n            ul.children[0].style.width = state.initialWidth + 'px';\n        });\n    }\n\n    // Renders the organogram\n    var render = function (parent, container) {\n        for (var i = 0; i < obj.options.data.length; i ++) {\n            if (obj.options.data[i].parent == parent) {\n                var ul = mountNodes(obj.options.data[i], container);\n                render(obj.options.data[i].id, ul);\n            }\n        }\n\n        // Check render mode / vertical / horizontal\n        var mode = getRenderMode(container);\n\n        if (mode == 'vertical' && obj.options.vertical) {\n            container.previousElementSibling.classList.add('jorg-after-none');\n            container.classList.add('jorg-vertical');\n        } else {\n            container.classList.add('jorg-horizontal');\n        }\n\n        if (! container.childNodes.length) {\n            container.remove();\n        } else if (container.previousElementSibling) {\n            setNodeVisibility(container.previousElementSibling);\n        }\n    }\n\n    // Sets the full screen mode\n    var setFullScreenMode = function(e) {\n        var windowScrollTop = document.body.scrollTop || document.documentElement.scrollTop;\n\n        if (el.classList.contains('fullscreen-mode')) {\n            el.classList.remove('fullscreen-mode');\n            document.body.classList.remove('jorg-hide-scrollbars');\n            el.style.top = '0px';\n            e.target.innerText ='slideshow';\n        } else {\n            el.classList.add('fullscreen-mode');\n            document.body.classList.add('jorg-hide-scrollbars');\n            el.style.top = windowScrollTop + 'px';\n            e.target.innerText ='close_fullscreen';\n        }\n    }\n\n    // Deals with zoom in and zoom out in the organogram\n    var zoom = function(e) {\n        e = event || window.event;\n        // Current zoom\n        var currentZoom = state.scale = el.children[0].style.zoom * 1;\n        var prevWidth = el.children[0].offsetWidth;\n        var prevHeight = el.children[0].offsetHeight;\n        var widthVar, heightVar;\n        // Action\n        if (e.target.classList.contains('jorg-zoom-in') || e.deltaY < 0) {\n            el.children[0].style.zoom = currentZoom + obj.options.zoom;\n            widthVar = prevWidth - el.children[0].offsetWidth;\n            heightVar = prevHeight - el.children[0].offsetHeight;\n            el.children[0].scrollLeft += (widthVar/2)\n            el.children[0].scrollTop += (heightVar/2)\n        } else if (currentZoom > .5) {\n            el.children[0].style.zoom = state.scale = currentZoom - obj.options.zoom;\n            widthVar = el.children[0].offsetWidth - prevWidth;\n            heightVar = el.children[0].offsetHeight - prevHeight;\n            el.children[0].scrollLeft -= (widthVar/2);\n            el.children[0].scrollTop -= (heightVar/2);\n        }\n        e.preventDefault();\n    }\n\n    // Finds a node in the organogram chart by a node propertie\n    var findNode = function(o) {\n        if (o && typeof o == 'object') {\n            var keys = Object.keys(o);\n            for (var i = 0; i < keys.length; i ++) {\n                var property = keys[i];\n                var node = obj.options.data.find(node => node[property] == o[property]);\n                if (node) {\n                    return Array.prototype.slice.call(document.querySelectorAll('.jorg-tf-nc')).find(n => n.getAttribute('id') == node.id);\n                } else {\n                    continue;\n                }\n            }\n        }\n        return 0;\n    }\n\n    //\n    var setInitialPosition = function() {\n        if (ul && ul.children[0]) {\n            ul.children[0].style.left = (ul.clientWidth / 2  - ul.children[0].clientWidth / 2) + 'px';\n            ul.children[0].style.top = '100px';\n        }\n    }\n\n    //\n    var setInitialWidth = function() {\n        if (ul.children[0]) {\n            state.initialWidth = ul.children[0].clientWidth;\n        }\n    }\n\n    //\n    var animateOnSearch = function(newLeft, newTop) {\n        ul.classList.add('jorg-search-animation');\n        ul.onanimationend = function(e) {\n            if (e.animationName == 'jorg-searching-hide') {\n                ul.children[0].style.left = newLeft + 'px';\n                ul.children[0].style.top = newTop + 'px';\n                ul.classList.remove('jorg-search-animation');\n                ul.classList.add('jorg-searching-visible');\n            }else if(e.animationName == 'jorg-searching-visible') {\n                ul.classList.remove('jorg-searching-visible');\n            }\n        }\n    }\n\n    /**\n     * Set the options\n     * @param {object} options\n     */\n    obj.setOptions = function(options, reset) {\n        // Default configuration\n        var defaults = {\n            data: null,\n            url: null,\n            zoom: 0.1,\n            width: 800,\n            height: 600,\n            search: true,\n            searchPlaceHolder: 'Search',\n            vertical: false,\n            roles: null,\n            // Events\n            onload: null,\n            onchange: null,\n            onclick: null\n        };\n\n        // Loop through our object\n        for (var property in defaults) {\n            if (options && options.hasOwnProperty(property)) {\n                obj.options[property] = options[property];\n            } else {\n                if (typeof(obj.options[property]) == 'undefined' || reset === true) {\n                    obj.options[property] = defaults[property];\n                }\n            }\n        }\n\n        // Show search box\n        if (obj.options.search) {\n            el.appendChild(search);\n        } else {\n            if (search.parentElement) {\n                el.removeChild(search);\n            }\n        }\n\n        // Make sure correct format\n        obj.options.width = parseInt(obj.options.width);\n        obj.options.height = parseInt(obj.options.height);\n\n        // Update placeholder\n        search.placeholder = obj.options.searchPlaceHolder;\n\n        // Set default dimensions\n        if (options.width || options.height) {\n            obj.setDimensions(obj.options.width, obj.options.height);\n        }\n\n        // Only execute when is not the first time\n        if (el.organogram) {\n            obj.refresh();\n        }\n\n        return obj;\n    }\n\n    /**\n     * Reset roles\n     */\n    obj.setRoles = function(roles) {\n        if (roles) {\n            obj.options.roles = roles;\n            obj.refresh();\n        }\n    }\n\n    obj.setUrl = function(url) {\n        jSuites.ajax({\n            url: url,\n            method: 'GET',\n            dataType: 'json',\n            success: function(result) {\n                obj.setData(result);\n            }\n        });\n    }\n\n    /**\n     * Refreshes the organozation chart\n     */\n    obj.update = function() {\n        el.children[0].innerHTML = '';\n        render(0,el.children[0]);\n    }\n\n    /**\n     * applies a zoom in the organization chart\n     */\n    obj.zoom = function(scale) {\n        if (scale < .5 ) {\n            scale = .5;\n        }\n        ul.style.zoom = state.scale = scale;\n    }\n\n    /**\n     * Reset the organogram chart tree\n     */\n    obj.refresh = function() {\n        el.children[0].innerHTML = '';\n        render(0,el.children[0]);\n        setInitialPosition();\n        setInitialWidth();\n    }\n\n    /**\n     * Show or hide childrens of a node\n     */\n    obj.show = function(id) {\n        var node = findNode({ id: id });\n        // Check if the node exists and if it has an icon\n        if (node && node.lastChild) {\n            // Click on the icon\n            node.lastChild.click();\n        }\n    }\n\n    /**\n     * Appends a new element in the organogram chart\n     */\n    obj.addItem = function(item) {\n        if (typeof item == 'object' && item.hasOwnProperty('id') && item.hasOwnProperty('parent') && ! isNaN(item.parent) && ! isNaN(item.id)) {\n            var findedParent = obj.options.data.find(function(node) {\n                if (node.id == item.parent) {\n                    return true;\n                }\n                return false;\n            });\n\n            if (findedParent) {\n                obj.options.data.push(item);\n                \n                obj.refresh();\n\n                if (typeof obj.options.onchange == 'function') {\n                    obj.options.onchange(el, obj);\n                }\n            }\n            else {\n                console.log('cannot add this item');\n            }\n        }\n    }\n\n    var removeItemRecursively = function(id) {\n        var itemIndex = obj.options.data.findIndex(function(node) {\n            return node.id == id;\n        });\n\n        if (itemIndex > 0) {\n            obj.options.data.splice(itemIndex, 1);\n\n            var itemChildrenList = obj.options.data.filter(function(node) {\n                return node.parent === id;\n            });\n\n            itemChildrenList.forEach(function(childItem) {\n                removeItemRecursively(childItem.id);\n            });\n        }\n    }\n\n    /**\n     * Removes a item from the organogram chart\n     */\n    obj.removeItem = function(id) {\n        removeItemRecursively(id);\n\n        obj.refresh();\n    }\n\n    /**\n     * Sets a new value for the data array and re-render the organogram.\n     */\n    obj.setData = function(data) {\n        if (typeof(data) == 'object') {\n            obj.options.data = data;\n            obj.refresh();\n        }\n    }\n\n    /**\n     * Search for any item with the string and centralize it.\n     */\n    obj.search = function(str) {\n       var input = str.toLowerCase();\n\n       if (options) {\n            var data = obj.options.data;\n            var searchedNode = data.find(node => node.name.toLowerCase() == input);\n            if (searchedNode) {\n                var node = findNode({ id: searchedNode.id });\n                // Got to the node position\n                if (node) {\n                    var nodeRect = node.getBoundingClientRect();\n                    var ulRect = ul.getBoundingClientRect();\n                    var tm = (nodeRect.top - ulRect.top) - (ul.clientHeight / 2) + (node.clientHeight / 2)\n                    var lm = (nodeRect.left - ulRect.left) - (ul.clientWidth / 2) + (node.clientWidth / 2);\n                    var newTop = (parseFloat(ul.children[0].style.top) - tm);\n                    var newLeft = (parseFloat(ul.children[0].style.left) - lm);\n                    animateOnSearch(newLeft, newTop);\n                }\n            }\n        }\n    }\n\n    /**\n     * Change the organogram dimensions\n     */\n    obj.setDimensions = function(width, height) {\n        el.style.width = width + 'px';\n        el.style.height = height + 'px';\n    }\n\n    var pinchStart = function(e) {\n        state.fingerDistance = Math.hypot(e.touches[0].pageX - e.touches[1].pageX, e.touches[0].pageY - e.touches[1].pageY);\n    }\n\n    var pinchMove = function(e) {\n        e.preventDefault();\n\n        var dist2 = Math.hypot(e.touches[0].pageX - e.touches[1].pageX,e.touches[0].pageY - e.touches[1].pageY);\n\n        if (dist2 > state.fingerDistance) {\n            var dif =  dist2 - state.fingerDistance;\n            var newZoom = state.scale + state.scale * dif * 0.0025;\n            if (newZoom <= 5.09) {\n               obj.zoom(newZoom);\n               document.getElementById('info').textContent = newZoom;\n            }\n        }\n\n        if (dist2 < state.fingerDistance) {\n            var dif =  state.fingerDistance - dist2;\n            var newZoom = state.scale - state.scale * dif * 0.0025;\n            if (newZoom >= 0.1) {\n               obj.zoom(newZoom);\n               document.getElementById('info').textContent = newZoom;\n            }\n        }\n        state.fingerDistance = dist2;\n    }\n\n    var moving = false;\n\n    var moveListener = function(e){\n        e = e || window.event;\n        e.preventDefault();\n\n        if (! state.scaling) {\n            if (e.which || state.mobileDown) {\n                moving = true;\n\n                var currentX = e.clientX || e.pageX || (e.changedTouches && (e.changedTouches[0].pageX || e.changedTouches[0].clientX));\n                var currentY = e.clientY || e.pageY || (e.changedTouches && (e.changedTouches[0].pageY || e.changedTouches[0].clientY));\n\n                var x = state.x - currentX;\n                var y = (state.y - currentY);\n                var zoomFactor = ul.style.zoom <= 1 ? 1 + (1 - ul.style.zoom) : 1 - (ul.style.zoom - 1) < .5 ? .5 : 1 - (ul.style.zoom - 1);\n                ul.children[0].style.left = -(state.scrollLeft + x * zoomFactor)   + 'px';\n                ul.children[0].style.top = (state.scrollTop + y * zoomFactor * -1)   + 'px';\n            }\n        }\n        \n        if (state.scaling) {\n            pinchMove(e);\n        }\n    }\n\n    var touchListener = function(e) {\n        e = e || window.event;\n\n        if (e.changedTouches) {\n            state.mobileDown = true;\n        }\n\n        state.x = e.clientX || e.pageX || e.changedTouches[0].pageX || e.changedTouches[0].clientX;\n        state.y = e.clientY || e.pageY || e.changedTouches[0].pageY || e.changedTouches[0].clientY;\n        state.scrollLeft = - 1 * parseFloat(ul.children[0].style.left) || 0;\n        state.scrollTop = parseFloat(ul.children[0].style.top);\n\n        if (e.touches) {\n            if(e.touches.length == 2) {\n                state.scaling = true;\n                pinchStart(e);\n            }\n        }\n    }\n\n    var touchEnd = function(e) {\n        state.mobileDown = false;\n        if (state.scaling) {\n            state.scaling = false;\n        }\n\n        moving = false;\n    }\n\n    var ul = null;\n    var search = null;\n    var zoomContainer = null;\n    var zoomIn = null;\n    var zoomOut = null;\n    var fullscreen = null;\n\n    var init = function() {\n        // Create zoom action\n        zoomContainer = document.createElement('div');\n        zoomContainer.className = 'jorg-zoom-container';\n        obj.zoomContainer = zoomContainer;\n\n        zoomIn = document.createElement('i');\n        zoomIn.className = 'jorg-zoom-in material-icons jorg-action';\n        zoomIn.innerHTML = \"add_box\";\n\n        zoomOut = document.createElement('i');\n        zoomOut.className = 'jorg-zoom-out material-icons jorg-action';\n        zoomOut.innerHTML = \"indeterminate_check_box\";\n\n        fullscreen = document.createElement('i');\n        fullscreen.className = 'jorg-fullscreen material-icons jorg-action';\n        fullscreen.title = 'Fullscreen';\n        fullscreen.innerHTML = \"slideshow\";\n\n        zoomContainer.appendChild(fullscreen);\n        zoomContainer.appendChild(zoomIn);\n        zoomContainer.appendChild(zoomOut);\n\n        zoomIn.addEventListener('click', zoom);\n        zoomOut.addEventListener('click', zoom);\n        fullscreen.addEventListener('click', setFullScreenMode);\n\n        // Create container\n        ul = document.createElement('ul');\n\n        // Default zoom\n        if (! ul.style.zoom) {\n            ul.style.zoom = '1';\n        }\n\n        // Default classes\n        el.classList.add('jorg');\n        el.classList.add('jorg-tf-tree');\n        el.classList.add('jorg-unselectable');\n        ul.classList.add('jorg-disable-scrollbars');\n\n        // Append elements\n        el.appendChild(ul);\n        el.appendChild(zoomContainer);\n\n        search = document.createElement('input');\n        search.type = 'text';\n        search.classList.add('jorg-search');\n        search.onkeyup = function(e) {\n            obj.search(e.target.value);\n        }\n        search.onblur = function(e) {\n            e.target.value = '';\n        }\n\n        // Event handlers\n        ul.addEventListener('wheel', zoom);\n        ul.addEventListener('mousemove', moveListener);\n        ul.addEventListener('touchmove', moveListener);\n        ul.addEventListener('touchstart', touchListener);\n        ul.addEventListener('touchend', touchEnd);\n        ul.addEventListener('mousedown', touchListener);\n\n        el.addEventListener('click', function(e) {\n            if (!moving) {\n                if (typeof(obj.options.onclick) == 'function') {\n                    obj.options.onclick(el, obj, e);\n                }\n            } else {\n                moving = false;\n            }\n        });\n\n        obj.setOptions(options);\n\n        // Create\n        var create = function() {\n            render(0, ul);\n            setInitialPosition();\n            setInitialWidth();\n            // Set default dimensions\n            obj.setDimensions(obj.options.width, obj.options.height);\n\n            if (typeof obj.options.onload == 'function') {\n                obj.options.onload(el, obj);\n            }\n        }\n\n        // Loading data\n        if (obj.options.url) {\n            jSuites.ajax({\n                url: obj.options.url,\n                method: 'GET',\n                dataType: 'json',\n                success: function(result) {\n                    obj.options.data = result;\n\n                    create();\n                }\n            });\n        } else if (obj.options.data && obj.options.data.length) {\n            create();\n        }\n\n        el.organogram = obj;\n    }\n\n    init();\n\n    return obj;\n});\r\n\r\njSuites.template = (function(el, options) {\r\n    // Update configuration\r\n    if (el.classList.contains('jtemplate')) {\r\n        return el.template.setOptions(options);\r\n    }\r\n\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Search controls\r\n    var pageNumber = 0;\r\n    var searchTimer = null;\r\n    var searchResults = null;\r\n\r\n    // Parse events inside the template\r\n    var parse = function(element) {\r\n        // Attributes\r\n        var attr = {};\r\n\r\n        if (element.attributes && element.attributes.length) {\r\n            for (var i = 0; i < element.attributes.length; i++) {\r\n                attr[element.attributes[i].name] = element.attributes[i].value;\r\n            }\r\n        }\r\n\r\n        // Keys\r\n        var k = Object.keys(attr);\r\n\r\n        if (k.length) {\r\n            for (var i = 0; i < k.length; i++) {\r\n                // Parse events\r\n                if (k[i].substring(0,2) == 'on') {\r\n                    // Get event\r\n                    var event = k[i].toLowerCase();\r\n                    var value = attr[k[i]];\r\n\r\n                    // Get action\r\n                    element.removeAttribute(event);\r\n                    if (! element.events) {\r\n                        element.events = []\r\n                    }\r\n\r\n                    // Keep method to the event\r\n                    element[k[i].substring(2)] = value;\r\n                    if (obj.options.version == 2) {\r\n                        element[event] = function(e) {\r\n                            Function('template', 'e', element[e.type]).call(element, obj.options.template, e);\r\n                        }\r\n                    } else {\r\n                        element[event] = function(e) {\r\n                            Function('e', 'element', element[e.type]).call(obj.options.template, e, element);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check the children\r\n        if (element.children.length) {\r\n            for (var i = 0; i < element.children.length; i++) {\r\n                parse(element.children[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the options\r\n     */\r\n    obj.setOptions = function() {\r\n        // Default configuration\r\n        var defaults = {\r\n            version: null,\r\n            url: null,\r\n            data: null,\r\n            total: null,\r\n            filter: null,\r\n            template: null,\r\n            render: null,\r\n            noRecordsFound: 'No records found',\r\n            containerClass: null,\r\n            // Searchable\r\n            search: null,\r\n            searchInput: true,\r\n            searchPlaceHolder: '',\r\n            searchValue: '',\r\n            // Remote search\r\n            remoteData: false,\r\n            // Pagination page number of items\r\n            pagination: null,\r\n            // Events\r\n            onload: null,\r\n            onupdate: null,\r\n            onchange: null,\r\n            onsearch: null,\r\n            onclick: null,\r\n            oncreateitem: null,\r\n        }\r\n\r\n        // Loop through our object\r\n        for (var property in defaults) {\r\n            if (options && options.hasOwnProperty(property)) {\r\n                obj.options[property] = options[property];\r\n            } else if (typeof(obj.options[property]) === 'undefined') {\r\n                obj.options[property] = defaults[property];\r\n            }\r\n        }\r\n\r\n        // Pagination container\r\n        if (obj.options.pagination) {\r\n            el.insertBefore(pagination, el.firstChild);\r\n        } else {\r\n            if (pagination && pagination.parentNode) {\r\n                el.removeChild(pagination);\r\n            }\r\n        }\r\n\r\n\r\n        // Input search\r\n        if (obj.options.search && obj.options.searchInput == true) {\r\n            el.insertBefore(searchContainer, el.firstChild);\r\n            // Input value\r\n            obj.searchInput.value = obj.options.searchValue;\r\n        } else {\r\n            if (searchContainer && searchContainer.parentNode) {\r\n                el.removeChild(searchContainer);\r\n            }\r\n        }\r\n\r\n        // Search placeholder\r\n        if (obj.options.searchPlaceHolder) {\r\n            obj.searchInput.setAttribute('placeholder', obj.options.searchPlaceHolder);\r\n        } else {\r\n            obj.searchInput.removeAttribute('placeholder');\r\n        }\r\n\r\n        // Class for the container\r\n        if (obj.options.containerClass) {\r\n            container.classList.add(obj.options.containerClass);\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Contains the cache of local data loaded\r\n     */\r\n    obj.cache = [];\r\n\r\n    /**\r\n     * Append data to the template and add to the DOMContainer\r\n     * @param data\r\n     * @param contentDOMContainer\r\n     */\r\n    obj.setContent = function(a, b) {\r\n        // Get template\r\n        var c = obj.options.template[Object.keys(obj.options.template)[0]](a, obj);\r\n        // Process events\r\n        if ((c instanceof Element || c instanceof HTMLDocument)) {\r\n            b.appendChild(c);\r\n        } else {\r\n            b.innerHTML = c;\r\n        }\r\n\r\n        parse(b);\r\n    \r\n        // Oncreate a new item\r\n        if (typeof(obj.options.oncreateitem) == 'function') {\r\n            obj.options.oncreateitem(el, obj, b.children[0], a);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Add a new option in the data\r\n     */\r\n    obj.addItem = function(data, beginOfDataSet) {\r\n        // Append itens\r\n        var content = document.createElement('div');\r\n        // Append data\r\n        if (beginOfDataSet) {\r\n            obj.options.data.unshift(data);\r\n        } else {\r\n            obj.options.data.push(data);\r\n        }\r\n        // If is empty remove indication\r\n        if (container.classList.contains('jtemplate-empty')) {\r\n            container.classList.remove('jtemplate-empty');\r\n            container.innerHTML = '';\r\n        }\r\n        // Get content\r\n        obj.setContent(data, content);\r\n        // Add animation\r\n        jSuites.animation.fadeIn(content.children[0]);\r\n        // Add and do the animation\r\n        if (beginOfDataSet) {\r\n            container.prepend(content.children[0]);\r\n        } else {\r\n            container.append(content.children[0]);\r\n        }\r\n        // Onchange method\r\n        if (typeof(obj.options.onchange) == 'function') {\r\n            obj.options.onchange(el, obj.options.data);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Remove the item from the data\r\n     */\r\n    obj.removeItem = function(element) {\r\n        if (Array.prototype.indexOf.call(container.children, element) > -1) {\r\n            // Remove data from array\r\n            var index = obj.options.data.indexOf(element.dataReference);\r\n            if (index > -1) {\r\n                obj.options.data.splice(index, 1);\r\n            }\r\n            // Remove element from DOM\r\n            jSuites.animation.fadeOut(element, function() {\r\n                element.parentNode.removeChild(element);\r\n\r\n                if (! container.innerHTML) {\r\n                    container.classList.add('jtemplate-empty');\r\n                    container.innerHTML = obj.options.noRecordsFound;\r\n                }\r\n            });\r\n        } else {\r\n            console.error('Element not found');\r\n        }\r\n    }\r\n    /**\r\n     * Reset the data of the element\r\n     */\r\n    obj.setData = function(data) {\r\n        if (data) {\r\n            // Current page number\r\n            pageNumber = 0;\r\n            // Reset search\r\n            obj.options.searchValue = '';\r\n            // Set data\r\n            obj.options.data = data;\r\n            // Reset any search results\r\n            searchResults = null;\r\n\r\n            // Render new data\r\n            obj.render();\r\n\r\n            // Onchange method\r\n            if (typeof(obj.options.onchange) == 'function') {\r\n                obj.options.onchange(el, obj.options.data);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get the current page number\r\n     */\r\n    obj.getPage = function() {\r\n        return pageNumber;\r\n    }\r\n\r\n    /**\r\n     * Append data to the component \r\n     */\r\n    obj.appendData = function(data, p) {\r\n        if (p) {\r\n            pageNumber = p;\r\n        }\r\n\r\n        var execute = function(data) {\r\n            // Concat data\r\n            obj.options.data.concat(data);\r\n\r\n            var startNumber = 0;\r\n            var finalNumber = data.length;\r\n            // Append itens\r\n            var content = document.createElement('div');\r\n            for (var i = startNumber; i < finalNumber; i++) {\r\n                obj.setContent(data[i], content)\r\n                content.children[0].dataReference = data[i];\r\n                container.appendChild(content.children[0]);\r\n            }\r\n            \r\n        }\r\n\r\n        if (obj.options.url && obj.options.remoteData == true) {\r\n            // URL\r\n            var url = obj.options.url;\r\n            // Data\r\n            var ajaxData = {};\r\n            // Options for backend search\r\n            if (obj.options.remoteData) {\r\n                // Search value\r\n                if (obj.options.searchValue) {\r\n                    ajaxData.q = obj.options.searchValue;\r\n                }\r\n                // Page number\r\n                if (pageNumber) {\r\n                    ajaxData.p = pageNumber;\r\n                }\r\n                // Number items per page\r\n                if (obj.options.pagination) {\r\n                    ajaxData.t = obj.options.pagination;\r\n                }\r\n            }\r\n            // Remote loading\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                data: ajaxData,\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    execute(data);\r\n                }\r\n            });\r\n        } else {\r\n            if (! obj.options.data) {\r\n                console.log('TEMPLATE: no data or external url defined');\r\n            } else {\r\n                execute(data);\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.renderTemplate = function() {\r\n        // Data container\r\n        var data = searchResults ? searchResults : obj.options.data;\r\n\r\n        // Data filtering\r\n        if (typeof(obj.options.filter) == 'function') {\r\n            data = obj.options.filter(data);\r\n        }\r\n\r\n        // Reset pagination container\r\n        pagination.innerHTML = '';\r\n\r\n        if (! data.length) {\r\n            container.innerHTML = obj.options.noRecordsFound;\r\n            container.classList.add('jtemplate-empty');\r\n        } else {\r\n            // Reset content\r\n            container.classList.remove('jtemplate-empty');\r\n\r\n            // Create pagination\r\n            if (obj.options.pagination && data.length > obj.options.pagination) {\r\n                var startNumber = (obj.options.pagination * pageNumber);\r\n                var finalNumber = (obj.options.pagination * pageNumber) + obj.options.pagination;\r\n\r\n                if (data.length < finalNumber) {\r\n                    var finalNumber = data.length;\r\n                }\r\n            } else {\r\n                var startNumber = 0;\r\n                var finalNumber = data.length;\r\n            }\r\n\r\n            // Append itens\r\n            var content = document.createElement('div');\r\n            for (var i = startNumber; i < finalNumber; i++) {\r\n                // Check if cache obj contains the element\r\n                if (! data[i].element) {\r\n                    obj.setContent(data[i], content);\r\n                    content.children[0].dataReference = data[i];\r\n                    data[i].element = content.children[0];\r\n                    // append element into cache\r\n                    obj.cache.push(data[i]);\r\n                    container.appendChild(content.children[0]);\r\n                } else {\r\n                    container.appendChild(data[i].element);\r\n                }\r\n            }\r\n\r\n            if (obj.options.total) {\r\n                var numberOfPages = Math.ceil(obj.options.total / obj.options.pagination);\r\n            } else {\r\n                var numberOfPages = Math.ceil(data.length / obj.options.pagination);\r\n            }\r\n\r\n            // Update pagination\r\n            if (obj.options.pagination > 0 && numberOfPages > 1) {\r\n                // Controllers\r\n                if (pageNumber < 6) {\r\n                    var startNumber = 0;\r\n                    var finalNumber = numberOfPages < 10 ? numberOfPages : 10;\r\n                } else if (numberOfPages - pageNumber < 5) {\r\n                    var startNumber = numberOfPages - 9;\r\n                    var finalNumber = numberOfPages;\r\n                    if (startNumber < 0) {\r\n                        startNumber = 0;\r\n                    }\r\n                } else {\r\n                    var startNumber = pageNumber - 4;\r\n                    var finalNumber = pageNumber + 5;\r\n                }\r\n\r\n                // First\r\n                if (startNumber > 0) {\r\n                    var paginationItem = document.createElement('div');\r\n                    paginationItem.innerHTML = '<';\r\n                    paginationItem.title = 0;\r\n                    pagination.appendChild(paginationItem);\r\n                }\r\n\r\n                // Get page links\r\n                for (var i = startNumber; i < finalNumber; i++) {\r\n                    var paginationItem = document.createElement('div');\r\n                    paginationItem.innerHTML = (i + 1);\r\n                    pagination.appendChild(paginationItem);\r\n\r\n                    if (pageNumber == i) {\r\n                        paginationItem.style.fontWeight = 'bold';\r\n                        paginationItem.style.textDecoration = 'underline';\r\n                    }\r\n                }\r\n\r\n                // Last\r\n                if (finalNumber < numberOfPages) {\r\n                    var paginationItem = document.createElement('div');\r\n                    paginationItem.innerHTML = '>';\r\n                    paginationItem.title = numberOfPages - 1;\r\n                    pagination.appendChild(paginationItem);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.render = function(p, forceLoad) {\r\n        // Update page number\r\n        if (p !== undefined) {\r\n            pageNumber = p;\r\n        }\r\n\r\n        // Render data into template\r\n        var execute = function() {\r\n            // Render new content\r\n            if (typeof(obj.options.render) == 'function') {\r\n                container.innerHTML = obj.options.render(obj);\r\n            } else {\r\n               container.innerHTML = '';\r\n            }\r\n\r\n            // Load data\r\n            obj.renderTemplate();\r\n\r\n            // On Update\r\n            if (typeof(obj.options.onupdate) == 'function') {\r\n                obj.options.onupdate(el, obj, pageNumber);\r\n            }\r\n\r\n            if (forceLoad) {\r\n                // Onload\r\n                if (typeof(obj.options.onload) == 'function') {\r\n                    obj.options.onload(el, obj, pageNumber);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (obj.options.url && (obj.options.remoteData == true || forceLoad)) {\r\n            // URL\r\n            var url = obj.options.url;\r\n            // Data\r\n            var ajaxData = {};\r\n            // Options for backend search\r\n            if (obj.options.remoteData) {\r\n                // Search value\r\n                if (obj.options.searchValue) {\r\n                    ajaxData.q = obj.options.searchValue;\r\n                }\r\n                // Page number\r\n                if (pageNumber) {\r\n                    ajaxData.p = pageNumber;\r\n                }\r\n                // Number items per page\r\n                if (obj.options.pagination) {\r\n                    ajaxData.t = obj.options.pagination;\r\n                }\r\n            }\r\n            // Remote loading\r\n            jSuites.ajax({\r\n                url: url,\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                data: ajaxData,\r\n                success: function(data) {\r\n                    // Search and keep data in the client side\r\n                    if (data.hasOwnProperty(\"total\")) {\r\n                        obj.options.total = data.total;\r\n                        obj.options.data = data.data;\r\n                    } else {\r\n                        obj.options.total = null;\r\n                        obj.options.data = data;\r\n                    }\r\n\r\n                    // Load data for the user\r\n                    execute();\r\n                }\r\n            });\r\n        } else {\r\n            if (! obj.options.data) {\r\n                console.log('TEMPLATE: no data or external url defined');\r\n            } else {\r\n                // Load data for the user\r\n                execute();\r\n            }\r\n        }\r\n    }\r\n\r\n    obj.search = function(query) {\r\n        // Page number\r\n        pageNumber = 0;\r\n        // Search query\r\n        obj.options.searchValue = query ? query : '';\r\n\r\n        // Filter data\r\n        if (obj.options.remoteData == true || ! query) {\r\n            searchResults = null;\r\n        } else {\r\n            var test = function(o, query) {\r\n                for (var key in o) {\r\n                    var value = o[key];\r\n\r\n                    if ((''+value).toLowerCase().search(query) >= 0) {\r\n                        return true;\r\n                    }\r\n                }\r\n                return false;\r\n            }\r\n\r\n            searchResults = obj.options.data.filter(function(item) {\r\n                return test(item, query);\r\n            });\r\n        }\r\n\r\n        obj.render(0);\r\n\r\n        if (typeof(obj.options.onsearch) == 'function') {\r\n            obj.options.onsearch(el, obj, query);\r\n        }\r\n    }\r\n\r\n    obj.refresh = function() {\r\n        obj.cache = [];\r\n        obj.render();\r\n    }\r\n\r\n    obj.reload = function() {\r\n        obj.cache = [];\r\n        obj.render(0, true);\r\n    }\r\n\r\n    /**\r\n     * Events\r\n     */\r\n    el.addEventListener('mousedown', function(e) {\r\n        if (e.target.parentNode.classList.contains('jtemplate-pagination')) {\r\n            var index = e.target.innerText;\r\n            if (index == '<') {\r\n                obj.render(0);\r\n            } else if (index == '>') {\r\n                obj.render(e.target.getAttribute('title'));\r\n            } else {\r\n                obj.render(parseInt(index)-1);\r\n            }\r\n            e.preventDefault();\r\n        }\r\n    });\r\n\r\n    el.addEventListener('mouseup', function(e) {\r\n        if (typeof(obj.options.onclick) == 'function') {\r\n            obj.options.onclick(el, obj, e);\r\n        }\r\n    });\r\n\r\n    // Reset content\r\n    el.innerHTML = '';\r\n\r\n    // Container\r\n    var container = document.createElement('div');\r\n    container.classList.add ('jtemplate-content');\r\n    el.appendChild(container);\r\n\r\n    // Pagination container\r\n    var pagination = document.createElement('div');\r\n    pagination.className = 'jtemplate-pagination';\r\n\r\n    // Search DOM elements\r\n    var searchContainer = document.createElement('div');\r\n    searchContainer.className = 'jtemplate-results';\r\n    obj.searchInput = document.createElement('input');\r\n    obj.searchInput.onkeyup = function(e) {\r\n        // Clear current trigger\r\n        if (searchTimer) {\r\n            clearTimeout(searchTimer);\r\n        }\r\n        // Prepare search\r\n        searchTimer = setTimeout(function() {\r\n            obj.search(obj.searchInput.value.toLowerCase());\r\n            searchTimer = null;\r\n        }, 300)\r\n    }\r\n    searchContainer.appendChild(obj.searchInput);\r\n\r\n    // Set the options\r\n    obj.setOptions(options);\r\n\r\n    // Keep the reference in the DOM container\r\n    el.template = obj;\r\n\r\n    // Render data\r\n    obj.render(0, true);\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.timeline = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Two digits\r\n    var two = function(value) {\r\n        value = '' + value;\r\n        if (value.length == 1) {\r\n            value = '0' + value;\r\n        }\r\n        return value;\r\n    }\r\n\r\n    // Default date format\r\n    if (! options.date) {\r\n        var date = new Date();\r\n        var y = date.getFullYear();\r\n        var m = two(date.getMonth() + 1);\r\n        date = y + '-' + m;\r\n    }\r\n\r\n    // Default configurations\r\n    var defaults = {\r\n        url: null,  \r\n        data: [],\r\n        date: date,\r\n        months: [ 'Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec' ],\r\n        monthsFull: [ 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December' ],\r\n        onaction: null,\r\n        text: {\r\n            noInformation: '<div class=\"jtimeline-message\">No information for this period</div>',\r\n        }\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Add class\r\n    el.classList.add('jtimeline');\r\n\r\n    obj.options.container = el;\r\n\r\n    // Header\r\n    var timelineHeader = document.createElement('div');\r\n    timelineHeader.className = 'jtimeline-header';\r\n\r\n    var timelineLabel = document.createElement('div');\r\n    timelineLabel.className = 'jtimeline-label';\r\n\r\n    var timelineNavigation = document.createElement('div');\r\n    timelineNavigation.className = 'jtimeline-navigation';\r\n\r\n    // Labels \r\n    var timelineMonth = document.createElement('div');\r\n    timelineMonth.className = 'jtimeline-month';\r\n    timelineMonth.innerHTML = '';\r\n    timelineLabel.appendChild(timelineMonth);\r\n\r\n    var timelineYear = document.createElement('div');\r\n    timelineYear.className = 'jtimeline-year';\r\n    timelineYear.innerHTML = '';\r\n    timelineLabel.appendChild(timelineYear);\r\n\r\n    // Navigation\r\n    var timelinePrev = document.createElement('div');\r\n    timelinePrev.className = 'jtimeline-prev';\r\n    timelinePrev.innerHTML = '<i class=\"material-icons\">keyboard_arrow_left</i>';\r\n    timelineNavigation.appendChild(timelinePrev);\r\n\r\n    var timelineNext = document.createElement('div');\r\n    timelineNext.className = 'jtimeline-next';\r\n    timelineNext.innerHTML = '<i class=\"material-icons\">keyboard_arrow_right</i>';\r\n    timelineNavigation.appendChild(timelineNext);\r\n\r\n    timelineHeader.appendChild(timelineLabel);\r\n    timelineHeader.appendChild(timelineNavigation);\r\n\r\n    // Data container\r\n    var timelineContainer = document.createElement('div');\r\n    timelineContainer.className = 'jtimeline-container';\r\n\r\n    // Append headers\r\n    el.appendChild(timelineHeader);\r\n    el.appendChild(timelineContainer);\r\n\r\n    // Date\r\n    if (obj.options.date.length > 7) {\r\n        obj.options.date = obj.options.date.substr(0, 7)\r\n    }\r\n\r\n    // Action\r\n    var action = function(o) {\r\n        // Get item\r\n        var item = o.parentNode.parentNode.parentNode.parentNode;\r\n        // Get id\r\n        var id = item.getAttribute('data-id');\r\n\r\n    }\r\n\r\n    // Get item by date \r\n    var getEventByDate = function(date) {\r\n        return obj.options.data.filter(function(evt) {\r\n            return (evt.date.length > 7 ? evt.date.substr(0,7) : evt.date) == date;\r\n        });\r\n    }\r\n\r\n    obj.setData = function(rows) {\r\n        obj.options.data = rows;\r\n        obj.render(obj.options.date);\r\n    }\r\n\r\n    obj.add = function(data) {\r\n        var date = data.date.substr(0,7);\r\n\r\n        // Format date\r\n        data.date = data.date.substr(0,10);\r\n\r\n        // Append data\r\n        obj.options.data.push(data);\r\n\r\n        // Reorder\r\n        obj.options.data[obj.options.data.indexOf(data)] = data.order();\r\n\r\n        // Render\r\n        obj.render(date);\r\n    }\r\n\r\n    obj.remove = function(item) {\r\n        var index = item.getAttribute('data-index');\r\n        var date = item.getAttribute('data-date');\r\n\r\n        jSuites.animation.fadeOut(item, function() {\r\n            item.remove();\r\n        });\r\n\r\n        var data = getEventByDate(date)[0];\r\n        data.splice(index, 1);\r\n    }\r\n\r\n    obj.reload = function() {\r\n        var date = obj.options.date\r\n        obj.render(date);\r\n    }\r\n\r\n    obj.render = function(date) {\r\n        // Filter\r\n        if (date.length > 7) {\r\n            var date = date.substr(0,7);\r\n        }\r\n\r\n        // Update current date\r\n        obj.options.date = date;\r\n\r\n        // Reset data\r\n        timelineContainer.innerHTML = '';\r\n\r\n        // Days\r\n        var timelineDays = [];\r\n        var events = getEventByDate(date);\r\n\r\n        // Itens\r\n        if (! events.length) {\r\n            timelineContainer.innerHTML = obj.options.text.noInformation;\r\n        } else {\r\n            for (var i = 0; i < events.length; i++) {\r\n                var v = events[i];\r\n                var d = v.date.length > 10 ? v.date.substr(0,10).split('-') : v.date.split('-');\r\n\r\n                // Item container\r\n                var timelineItem = document.createElement('div');\r\n                timelineItem.className = 'jtimeline-item';\r\n                timelineItem.setAttribute('data-id', v.id);\r\n                timelineItem.setAttribute('data-index', i);\r\n                timelineItem.setAttribute('data-date', date);\r\n\r\n                // Date\r\n                var timelineDateContainer = document.createElement('div');\r\n                timelineDateContainer.className = 'jtimeline-date-container';\r\n\r\n                var timelineDate = document.createElement('div');\r\n                if (! timelineDays[d[2]]) {\r\n                    timelineDate.className = 'jtimeline-date jtimeline-date-bullet';\r\n                    timelineDate.innerHTML = d[2];\r\n                } else {\r\n                    timelineDate.className = 'jtimeline-date';\r\n                    timelineDate.innerHTML = '';\r\n                }\r\n                timelineDateContainer.appendChild(timelineDate);\r\n\r\n                var timelineContent = document.createElement('div');\r\n                timelineContent.className = 'jtimeline-content';\r\n\r\n                // Title\r\n                if (! v.title) {\r\n                    v.title = v.subtitle ? v.subtitle : 'Information';\r\n                }\r\n\r\n                var timelineTitleContainer = document.createElement('div');\r\n                timelineTitleContainer.className = 'jtimeline-title-container';\r\n                timelineContent.appendChild(timelineTitleContainer);\r\n\r\n                var timelineTitle = document.createElement('div');\r\n                timelineTitle.className = 'jtimeline-title';\r\n                timelineTitle.innerHTML = v.title;\r\n                timelineTitleContainer.appendChild(timelineTitle);\r\n\r\n                var timelineControls = document.createElement('div');\r\n                timelineControls.className = 'jtimeline-controls';\r\n                timelineTitleContainer.appendChild(timelineControls);\r\n\r\n                var timelineEdit = document.createElement('i');\r\n                timelineEdit.className = 'material-icons timeline-edit';\r\n                timelineEdit.innerHTML = 'edit';\r\n                timelineEdit.id = v.id;\r\n                timelineEdit.onclick = function() {\r\n                    if (typeof(obj.options.onaction) == 'function') {\r\n                        obj.options.onaction(obj, this, this.id);\r\n                    }\r\n                }\r\n                if (v.author == 1) {\r\n                    timelineControls.appendChild(timelineEdit);\r\n                }\r\n\r\n                var timelineSubtitle = document.createElement('div');\r\n                timelineSubtitle.className = 'jtimeline-subtitle';\r\n                timelineSubtitle.innerHTML = v.subtitle ? v.subtitle : '';\r\n                timelineContent.appendChild(timelineSubtitle);\r\n\r\n                // Text\r\n                var timelineText = document.createElement('div');\r\n                timelineText.className = 'jtimeline-text';\r\n                timelineText.innerHTML = v.text;\r\n                timelineContent.appendChild(timelineText);\r\n\r\n                // Tag\r\n                var timelineTags = document.createElement('div');\r\n                timelineTags.className = 'jtimeline-tags';\r\n                timelineContent.appendChild(timelineTags);\r\n\r\n                if (v.tags) {\r\n                    var createTag = function(name, color) {\r\n                        var timelineTag = document.createElement('div');\r\n                        timelineTag.className = 'jtimeline-tag';\r\n                        timelineTag.innerHTML = name;\r\n                        if (color) {\r\n                            timelineTag.style.backgroundColor = color;\r\n                        }\r\n                        return timelineTag; \r\n                    }\r\n\r\n                    if (typeof(v.tags) == 'string') {\r\n                        var t = createTag(v.tags);\r\n                        timelineTags.appendChild(t);\r\n                    } else {\r\n                        for (var j = 0; j < v.tags.length; j++) {\r\n                            var t = createTag(v.tags[j].text, v.tags[j].color);\r\n                            timelineTags.appendChild(t);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                // Day\r\n                timelineDays[d[2]] = true;\r\n\r\n                // Append Item\r\n                timelineItem.appendChild(timelineDateContainer);\r\n                timelineItem.appendChild(timelineContent);\r\n                timelineContainer.appendChild(timelineItem);\r\n            };\r\n        }\r\n\r\n        // Update labels\r\n        var d = date.split('-');\r\n        timelineYear.innerHTML = d[0];\r\n        timelineMonth.innerHTML = obj.options.monthsFull[parseInt(d[1]) - 1];\r\n    }\r\n\r\n    obj.next = function() {\r\n        // Update current date\r\n        var d = obj.options.date.split('-');\r\n        // Next month\r\n        d[1]++;\r\n        // Next year\r\n        if (d[1] > 12) {\r\n            d[0]++;\r\n            d[1] = 1;\r\n        }\r\n        date = d[0] + '-' + (d[1] < 10 ? '0' + d[1] : d[1]);\r\n\r\n        // Animation\r\n        jSuites.animation.slideLeft(timelineContainer, 0, function() {\r\n            obj.render(date);\r\n            jSuites.animation.slideRight(timelineContainer, 1);\r\n        });\r\n    }\r\n\r\n    obj.prev = function() {\r\n        // Update current date\r\n        var d = obj.options.date.split('-');\r\n        // Next month\r\n        d[1]--;\r\n        // Next year\r\n        if (d[1] < 1) {\r\n            d[0]--;\r\n            d[1] = 12;\r\n        }\r\n        date = d[0] + '-' + (d[1] < 10 ? '0' + d[1] : d[1]);\r\n\r\n        // Animation\r\n        jSuites.animation.slideRight(timelineContainer, 0, function() {\r\n            obj.render(date);\r\n            jSuites.animation.slideLeft(timelineContainer, 1);\r\n        });\r\n    }\r\n\r\n    obj.load = function() {\r\n        // Init\r\n        if (obj.options.url) {\r\n            jSuites.ajax({\r\n                url: obj.options.url,\r\n                type: 'GET',\r\n                dataType:'json',\r\n                success: function(data) {\r\n                    // Timeline data\r\n                    obj.setData(data);\r\n                }\r\n            });\r\n        } else {\r\n            // Timeline data\r\n            obj.setData(obj.options.data);\r\n        }\r\n    }\r\n\r\n    obj.reload = function() {\r\n        obj.load();\r\n    }\r\n\r\n    obj.load();\r\n\r\n    var timelineMouseUpControls = function(e) {\r\n        if (e.target.classList.contains('jtimeline-next') || e.target.parentNode.classList.contains('jtimeline-next')) {\r\n            obj.next();\r\n        } else if (e.target.classList.contains('jtimeline-prev') || e.target.parentNode.classList.contains('jtimeline-prev')) {\r\n            obj.prev();\r\n        }\r\n    }\r\n\r\n    if ('ontouchend' in document.documentElement === true) {\r\n        el.addEventListener(\"touchend\", timelineMouseUpControls);\r\n    } else {\r\n        el.addEventListener(\"mouseup\", timelineMouseUpControls);\r\n    }\r\n\r\n    // Add global events\r\n    el.addEventListener(\"swipeleft\", function(e) {\r\n        obj.next();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    el.addEventListener(\"swiperight\", function(e) {\r\n        obj.prev();\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n    });\r\n\r\n    // Orderby\r\n    Array.prototype.order = function() {\r\n        return this.slice(0).sort(function(a, b) {\r\n            var valueA = a.date;\r\n            var valueB = b.date;\r\n\r\n            return (valueA > valueB) ? 1 : (valueA < valueB) ? -1 : 0;\r\n        });\r\n    }\r\n\r\n    el.timeline = obj;\r\n\r\n    return obj;\r\n});\r\n", "{\r\n    \"name\": \"jsuites\",\r\n    \"title\": \"A collection of common JavaScript plugins & web components\",\r\n    \"description\": \"jSuites is a collection of lightweight common required javascript plugins and web components. It is composed of fully responsive vanilla plugins to help you bring the best user experience to your projects, independent of the platform.\",\r\n    \"repository\": {\r\n        \"type\": \"git\",\r\n        \"url\": \"https://github.com/jsuites/jsuites.git\"\r\n    },\r\n    \"author\": {\r\n        \"name\": \"jSuites <contact@jsuites.net>\"\r\n    },\r\n    \"licenses\": [\r\n        {\r\n            \"type\": \"MIT\",\r\n            \"url\": \"https://github.com/jsuites/jsuites/blob/master/LICENSE\"\r\n        }\r\n    ],\r\n    \"keywords\": [\r\n        \"javascript plugins\"\r\n    ],\r\n    \"main\": \"dist/jsuites.js\",\r\n    \"version\": \"4.9.11\",\r\n    \"bugs\": \"https://github.com/jsuites/jsuites/issues\",\r\n    \"homepage\": \"https://github.com/jsuites/jsuites\",\r\n    \"docs\": \"https://jsuites.net\",\r\n    \"download\": \"https://github.com/jsuites/jsuites/archive/master.zip\"\r\n}\r\n", "jSuites.editor = (function(el, options) {\r\n    var obj = {};\r\n    obj.options = {};\r\n\r\n    // Default configuration\r\n    var defaults = {\r\n        // Initial HTML content\r\n        value: null,\r\n        // Initial snippet\r\n        snippet: null,\r\n        // Add toolbar\r\n        toolbar: null,\r\n        // Website parser is to read websites and images from cross domain\r\n        remoteParser: null,\r\n        // Placeholder\r\n        placeholder: null,\r\n        // Parse URL\r\n        parseURL: false,\r\n        filterPaste: true,\r\n        // Accept drop files\r\n        dropZone: false,\r\n        dropAsSnippet: false,\r\n        acceptImages: false,\r\n        acceptFiles: false,\r\n        maxFileSize: 5000000,\r\n        allowImageResize: true,\r\n        // Style\r\n        border: true,\r\n        padding: true,\r\n        maxHeight: null,\r\n        height: null,\r\n        focus: false,\r\n        // Events\r\n        onclick: null,\r\n        onfocus: null,\r\n        onblur: null,\r\n        onload: null,\r\n        onkeyup: null,\r\n        onkeydown: null,\r\n        onchange: null,\r\n    };\r\n\r\n    // Loop through our object\r\n    for (var property in defaults) {\r\n        if (options && options.hasOwnProperty(property)) {\r\n            obj.options[property] = options[property];\r\n        } else {\r\n            obj.options[property] = defaults[property];\r\n        }\r\n    }\r\n\r\n    // Private controllers\r\n    var imageResize = 0;\r\n    var editorTimer = null;\r\n    var editorAction = null;\r\n    var files = [];\r\n\r\n    // Make sure element is empty\r\n    el.innerHTML = '';\r\n\r\n    // Keep the reference for the container\r\n    obj.el = el;\r\n\r\n    if (typeof(obj.options.onclick) == 'function') {\r\n        el.onclick = function(e) {\r\n            obj.options.onclick(el, obj, e);\r\n        }\r\n    }\r\n\r\n    // Prepare container\r\n    el.classList.add('jeditor-container');\r\n\r\n    // Padding\r\n    if (obj.options.padding == true) {\r\n        el.classList.add('jeditor-padding');\r\n    }\r\n\r\n    // Border\r\n    if (obj.options.border == false) {\r\n        el.style.border = '0px';\r\n    }\r\n\r\n    // Snippet\r\n    var snippet = document.createElement('div');\r\n    snippet.className = 'jsnippet';\r\n    snippet.setAttribute('contenteditable', false);\r\n\r\n    // Toolbar\r\n    var toolbar = document.createElement('div');\r\n    toolbar.className = 'jeditor-toolbar';\r\n\r\n    // Create editor\r\n    var editor = document.createElement('div');\r\n    editor.setAttribute('contenteditable', true);\r\n    editor.setAttribute('spellcheck', false);\r\n    editor.className = 'jeditor';\r\n\r\n    // Placeholder\r\n    if (obj.options.placeholder) {\r\n        editor.setAttribute('data-placeholder', obj.options.placeholder);\r\n    }\r\n\r\n    // Max height\r\n    if (obj.options.maxHeight || obj.options.height) {\r\n        editor.style.overflowY = 'auto';\r\n\r\n        if (obj.options.maxHeight) {\r\n            editor.style.maxHeight = obj.options.maxHeight;\r\n        }\r\n        if (obj.options.height) {\r\n            editor.style.height = obj.options.height;\r\n        }\r\n    }\r\n\r\n    // Set editor initial value\r\n    if (obj.options.value) {\r\n        var value = obj.options.value;\r\n    } else {\r\n        var value = el.innerHTML ? el.innerHTML : ''; \r\n    }\r\n\r\n    if (! value) {\r\n        var value = '';\r\n    }\r\n\r\n    /**\r\n     * Onchange event controllers\r\n     */\r\n    var change = function(e) {\r\n        if (typeof(obj.options.onchange) == 'function') { \r\n            obj.options.onchange(el, obj, e);\r\n        }\r\n\r\n        // Update value\r\n        obj.options.value = obj.getData();\r\n\r\n        // Lemonade JS\r\n        if (el.value != obj.options.value) {\r\n            el.value = obj.options.value;\r\n            if (typeof(el.onchange) == 'function') {\r\n                el.onchange({\r\n                    type: 'change',\r\n                    target: el,\r\n                    value: el.value\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extract images from a HTML string\r\n     */\r\n    var extractImageFromHtml = function(html) {\r\n        // Create temp element\r\n        var div = document.createElement('div');\r\n        div.innerHTML = html;\r\n\r\n        // Extract images\r\n        var img = div.querySelectorAll('img');\r\n\r\n        if (img.length) {\r\n            for (var i = 0; i < img.length; i++) {\r\n                obj.addImage(img[i].src);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Insert node at caret\r\n     */\r\n    var insertNodeAtCaret = function(newNode) {\r\n        var sel, range;\r\n\r\n        if (window.getSelection) {\r\n            sel = window.getSelection();\r\n            if (sel.rangeCount) {\r\n                range = sel.getRangeAt(0);\r\n                var selectedText = range.toString();\r\n                range.deleteContents();\r\n                range.insertNode(newNode); \r\n                // move the cursor after element\r\n                range.setStartAfter(newNode);\r\n                range.setEndAfter(newNode); \r\n                sel.removeAllRanges();\r\n                sel.addRange(range);\r\n            }\r\n        }\r\n    }\r\n\r\n    var updateTotalImages = function() {\r\n        var o = null;\r\n        if (o = snippet.children[0]) {\r\n            // Make sure is a grid\r\n            if (! o.classList.contains('jslider-grid')) {\r\n                o.classList.add('jslider-grid');\r\n            }\r\n            // Quantify of images\r\n            var number = o.children.length;\r\n            // Set the configuration of the grid\r\n            o.setAttribute('data-number', number > 4 ? 4 : number);\r\n            // Total of images inside the grid\r\n            if (number > 4) {\r\n                o.setAttribute('data-total', number - 4);\r\n            } else {\r\n                o.removeAttribute('data-total');\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Append image to the snippet\r\n     */\r\n    var appendImage = function(image) {\r\n        if (! snippet.innerHTML) {\r\n            appendElement({});\r\n        }\r\n        snippet.children[0].appendChild(image);\r\n        updateTotalImages();\r\n    }\r\n\r\n    /**\r\n     * Append snippet\r\n     * @Param object data\r\n     */\r\n    var appendElement = function(data) {\r\n        // Reset snippet\r\n        snippet.innerHTML = '';\r\n\r\n        // Attributes\r\n        var a = [ 'image', 'title', 'description', 'host', 'url' ];\r\n\r\n        for (var i = 0; i < a.length; i++) {\r\n            var div = document.createElement('div');\r\n            div.className = 'jsnippet-' + a[i];\r\n            div.setAttribute('data-k', a[i]);\r\n            snippet.appendChild(div);\r\n            if (data[a[i]]) {\r\n                if (a[i] == 'image') {\r\n                    if (! Array.isArray(data.image)) {\r\n                        data.image = [ data.image ];\r\n                    }\r\n                    for (var j = 0; j < data.image.length; j++) {\r\n                        var img = document.createElement('img');\r\n                        img.src = data.image[j];\r\n                        div.appendChild(img);\r\n                    }\r\n                } else {\r\n                    div.innerHTML = data[a[i]];\r\n                }\r\n            }\r\n        }\r\n\r\n        editor.appendChild(document.createElement('br'));\r\n        editor.appendChild(snippet);\r\n    }\r\n\r\n    var verifyEditor = function() {\r\n        clearTimeout(editorTimer);\r\n        editorTimer = setTimeout(function() {\r\n            var snippet = editor.querySelector('.jsnippet');\r\n            if (! snippet) {\r\n                var html = editor.innerHTML.replace(/\\n/g, ' ');\r\n                var container = document.createElement('div');\r\n                container.innerHTML = html;\r\n                var text = container.innerText; \r\n                var url = jSuites.editor.detectUrl(text);\r\n\r\n                if (url) {\r\n                    if (url[0].substr(-3) == 'jpg' || url[0].substr(-3) == 'png' || url[0].substr(-3) == 'gif') {\r\n                         obj.addImage(url[0], true);\r\n                    } else {\r\n                        var id = jSuites.editor.youtubeParser(url[0]);\r\n                        obj.parseWebsite(url[0], id);\r\n                    }\r\n                }\r\n            }\r\n        }, 1000);\r\n    }\r\n\r\n    obj.parseContent = function() {\r\n        verifyEditor();\r\n    }\r\n\r\n    obj.parseWebsite = function(url, youtubeId) {\r\n        if (! obj.options.remoteParser) {\r\n            console.log('The remoteParser is not defined');\r\n        } else {\r\n            // Youtube definitions\r\n            if (youtubeId) {\r\n                var url = 'https://www.youtube.com/watch?v=' + youtubeId;\r\n            }\r\n\r\n            var p = {\r\n                title: '',\r\n                description: '',\r\n                image: '',\r\n                host: url.split('/')[2],\r\n                url: url,\r\n            }\r\n\r\n            jSuites.ajax({\r\n                url: obj.options.remoteParser + encodeURI(url.trim()),\r\n                method: 'GET',\r\n                dataType: 'json',\r\n                success: function(result) {\r\n                    // Get title\r\n                    if (result.title) {\r\n                        p.title = result.title;\r\n                    }\r\n                    // Description\r\n                    if (result.description) {\r\n                        p.description = result.description;\r\n                    }\r\n                    // Host\r\n                    if (result.host) {\r\n                        p.host = result.host;\r\n                    }\r\n                    // Url\r\n                    if (result.url) {\r\n                        p.url = result.url;\r\n                    }\r\n                    // Append snippet\r\n                    appendElement(p);\r\n                    // Add image\r\n                    if (result.image) {\r\n                        obj.addImage(result.image, true);\r\n                    } else if (result['og:image']) {\r\n                        obj.addImage(result['og:image'], true);\r\n                    }\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set editor value\r\n     */\r\n    obj.setData = function(html) {\r\n        editor.innerHTML = html;\r\n\r\n        if (obj.options.focus) {\r\n            jSuites.editor.setCursor(editor, true);\r\n        }\r\n\r\n        // Reset files container\r\n        files = [];\r\n    }\r\n\r\n    obj.getFiles = function() {\r\n        var f = editor.querySelectorAll('.jfile');\r\n        var d = [];\r\n        for (var i = 0; i < f.length; i++) {\r\n            if (files[f[i].src]) {\r\n                d.push(files[f[i].src]);\r\n            }\r\n        }\r\n        return d;\r\n    }\r\n\r\n    obj.getText = function() {\r\n        return editor.innerText;\r\n    }\r\n\r\n    /**\r\n     * Get editor data\r\n     */\r\n    obj.getData = function(json) {\r\n        if (! json) {\r\n            var data = editor.innerHTML;\r\n        } else {\r\n            var data = {\r\n                content : '',\r\n            }\r\n\r\n            // Get snippet\r\n            if (snippet.innerHTML) {\r\n                var index = 0;\r\n                data.snippet = {};\r\n                for (var i = 0; i < snippet.children.length; i++) {\r\n                    // Get key from element\r\n                    var key = snippet.children[i].getAttribute('data-k');\r\n                    if (key) {\r\n                        if (key == 'image') {\r\n                            if (! data.snippet.image) {\r\n                                data.snippet.image = [];\r\n                            }\r\n                            // Get all images\r\n                            for (var j = 0; j < snippet.children[i].children.length; j++) {\r\n                                data.snippet.image.push(snippet.children[i].children[j].getAttribute('src'))\r\n                            }\r\n                        } else {\r\n                            data.snippet[key] = snippet.children[i].innerHTML;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Get files\r\n            var f = Object.keys(files);\r\n            if (f.length) {\r\n                data.files = [];\r\n                for (var i = 0; i < f.length; i++) {\r\n                    data.files.push(files[f[i]]);\r\n                }\r\n            }\r\n\r\n            // Get content\r\n            var text = editor.innerHTML;\r\n            text = text.replace(/<br>/g, \"\\n\");\r\n            text = text.replace(/<\\/div>/g, \"<\\/div>\\n\");\r\n            text = text.replace(/<(?:.|\\n)*?>/gm, \"\");\r\n            data.content = text.trim();\r\n        }\r\n\r\n        return data;\r\n    }\r\n\r\n    // Reset\r\n    obj.reset = function() {\r\n        editor.innerHTML = '';\r\n        snippet.innerHTML = '';\r\n        files = [];\r\n    }\r\n\r\n    obj.addPdf = function(data) {\r\n        if (data.result.substr(0,4) != 'data') {\r\n            console.error('Invalid source');\r\n        } else {\r\n            var canvas = document.createElement('canvas');\r\n            canvas.width = 60;\r\n            canvas.height = 60;\r\n\r\n            var img = new Image();\r\n            var ctx = canvas.getContext('2d');\r\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n            canvas.toBlob(function(blob) {\r\n                var newImage = document.createElement('img');\r\n                newImage.src = window.URL.createObjectURL(blob);\r\n                newImage.title = data.name;\r\n                newImage.className = 'jfile pdf';\r\n\r\n                files[newImage.src] = {\r\n                    file: newImage.src,\r\n                    extension: 'pdf',\r\n                    content: data.result,\r\n                }\r\n\r\n                insertNodeAtCaret(newImage);\r\n            });\r\n        }\r\n    }\r\n\r\n    obj.addImage = function(src, asSnippet) {\r\n        if (! src) {\r\n            src = '';\r\n        }\r\n\r\n        if (src.substr(0,4) != 'data' && ! obj.options.remoteParser) {\r\n            console.error('remoteParser not defined in your initialization');\r\n        } else {\r\n            // This is to process cross domain images\r\n            if (src.substr(0,4) == 'data') {\r\n                var extension = src.split(';')\r\n                extension = extension[0].split('/');\r\n                extension = extension[1];\r\n            } else {\r\n                var extension = src.substr(src.lastIndexOf('.') + 1);\r\n                // Work for cross browsers\r\n                src = obj.options.remoteParser + src;\r\n            }\r\n\r\n            var img = new Image();\r\n\r\n            img.onload = function onload() {\r\n                var canvas = document.createElement('canvas');\r\n                canvas.width = img.width;\r\n                canvas.height = img.height;\r\n\r\n                var ctx = canvas.getContext('2d');\r\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n\r\n                canvas.toBlob(function(blob) {\r\n                    var newImage = document.createElement('img');\r\n                    newImage.src = window.URL.createObjectURL(blob);\r\n                    newImage.classList.add('jfile');\r\n                    newImage.setAttribute('tabindex', '900');\r\n                    files[newImage.src] = {\r\n                        file: newImage.src,\r\n                        extension: extension,\r\n                        content: canvas.toDataURL(),\r\n                    }\r\n\r\n                    if (obj.options.dropAsSnippet || asSnippet) {\r\n                        appendImage(newImage);\r\n                        // Just to understand the attachment is part of a snippet\r\n                        files[newImage.src].snippet = true;\r\n                    } else {\r\n                        insertNodeAtCaret(newImage);\r\n                    }\r\n\r\n                    change();\r\n                });\r\n            };\r\n\r\n            img.src = src;\r\n        }\r\n    }\r\n\r\n    obj.addFile = function(files) {\r\n        var reader = [];\r\n\r\n        for (var i = 0; i < files.length; i++) {\r\n            if (files[i].size > obj.options.maxFileSize) {\r\n                alert('The file is too big');\r\n            } else {\r\n                // Only PDF or Images\r\n                var type = files[i].type.split('/');\r\n\r\n                if (type[0] == 'image') {\r\n                    type = 1;\r\n                } else if (type[1] == 'pdf') {\r\n                    type = 2;\r\n                } else {\r\n                    type = 0;\r\n                }\r\n\r\n                if (type) {\r\n                    // Create file\r\n                    reader[i] = new FileReader();\r\n                    reader[i].index = i;\r\n                    reader[i].type = type;\r\n                    reader[i].name = files[i].name;\r\n                    reader[i].date = files[i].lastModified;\r\n                    reader[i].size = files[i].size;\r\n                    reader[i].addEventListener(\"load\", function (data) {\r\n                        // Get result\r\n                        if (data.target.type == 2) {\r\n                            if (obj.options.acceptFiles == true) {\r\n                                obj.addPdf(data.target);\r\n                            }\r\n                        } else {\r\n                            obj.addImage(data.target.result);\r\n                        }\r\n                    }, false);\r\n\r\n                    reader[i].readAsDataURL(files[i])\r\n                } else {\r\n                    alert('The extension is not allowed');\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // Destroy\r\n    obj.destroy = function() {\r\n        editor.removeEventListener('mouseup', editorMouseUp);\r\n        editor.removeEventListener('mousedown', editorMouseDown);\r\n        editor.removeEventListener('mousemove', editorMouseMove);\r\n        editor.removeEventListener('keyup', editorKeyUp);\r\n        editor.removeEventListener('keydown', editorKeyDown);\r\n        editor.removeEventListener('dragstart', editorDragStart);\r\n        editor.removeEventListener('dragenter', editorDragEnter);\r\n        editor.removeEventListener('dragover', editorDragOver);\r\n        editor.removeEventListener('drop', editorDrop);\r\n        editor.removeEventListener('paste', editorPaste);\r\n\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            editor.removeEventListener('blur', editorBlur);\r\n        }\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            editor.removeEventListener('focus', editorFocus);\r\n        }\r\n\r\n        el.editor = null;\r\n        el.classList.remove('jeditor-container');\r\n\r\n        toolbar.remove();\r\n        snippet.remove();\r\n        editor.remove();\r\n    }\r\n\r\n    var isLetter = function (str) {\r\n        var regex = /([\\u0041-\\u005A\\u0061-\\u007A\\u00AA\\u00B5\\u00BA\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0\\u08A2-\\u08AC\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097F\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C33\\u0C35-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191C\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2183\\u2184\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005\\u3006\\u3031-\\u3035\\u303B\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA697\\uA6A0-\\uA6E5\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA793\\uA7A0-\\uA7AA\\uA7F8-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA80-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]+)/g;\r\n        return str.match(regex) ? 1 : 0;\r\n    }\r\n\r\n    // Event handlers\r\n    var editorMouseUp = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            editorAction.e.classList.remove('resizing');\r\n        }\r\n\r\n        editorAction = false;\r\n    }\r\n\r\n    var editorMouseDown = function(e) {\r\n        var close = function(snippet) {\r\n            var rect = snippet.getBoundingClientRect();\r\n            if (rect.width - (e.clientX - rect.left) < 40 && e.clientY - rect.top < 40) {\r\n                snippet.innerHTML = '';\r\n                snippet.remove();\r\n            }\r\n        }\r\n\r\n        if (e.target.tagName == 'IMG') {\r\n            if (e.target.style.cursor) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                editorAction = {\r\n                    e: e.target,\r\n                    x: e.clientX,\r\n                    y: e.clientY,\r\n                    w: rect.width,\r\n                    h: rect.height,\r\n                    d: e.target.style.cursor,\r\n                }\r\n\r\n                if (! e.target.width) {\r\n                    e.target.width = rect.width + 'px';\r\n                }\r\n\r\n                if (! e.target.height) {\r\n                    e.target.height = rect.height + 'px';\r\n                }\r\n\r\n                var s = window.getSelection();\r\n                if (s.rangeCount) {\r\n                    for (var i = 0; i < s.rangeCount; i++) {\r\n                        s.removeRange(s.getRangeAt(i));\r\n                    }\r\n                }\r\n\r\n                e.target.classList.add('resizing');\r\n            } else {\r\n                editorAction = true;\r\n            }\r\n        } else { \r\n            if (e.target.classList.contains('jsnippet')) {\r\n                close(e.target);\r\n            } else if (e.target.parentNode.classList.contains('jsnippet')) {\r\n                close(e.target.parentNode);\r\n            }\r\n\r\n            editorAction = true;\r\n        }\r\n    }\r\n\r\n    var editorMouseMove = function(e) {\r\n        if (e.target.tagName == 'IMG' && ! e.target.parentNode.classList.contains('jsnippet-image') && obj.options.allowImageResize == true) {\r\n            if (e.target.getAttribute('tabindex')) {\r\n                var rect = e.target.getBoundingClientRect();\r\n                if (e.clientY - rect.top < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'ne-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'nw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 'n-resize';\r\n                    }\r\n                } else if (rect.height - (e.clientY - rect.top) < 5) {\r\n                    if (rect.width - (e.clientX - rect.left) < 5) {\r\n                        e.target.style.cursor = 'se-resize';\r\n                    } else if (e.clientX - rect.left < 5) {\r\n                        e.target.style.cursor = 'sw-resize';\r\n                    } else {\r\n                        e.target.style.cursor = 's-resize';\r\n                    }\r\n                } else if (rect.width - (e.clientX - rect.left) < 5) {\r\n                    e.target.style.cursor = 'e-resize';\r\n                } else if (e.clientX - rect.left < 5) {\r\n                    e.target.style.cursor = 'w-resize';\r\n                } else {\r\n                    e.target.style.cursor = '';\r\n                }\r\n            }\r\n        }\r\n\r\n        // Move\r\n        if (e.which == 1 && editorAction && editorAction.d) {\r\n            if (editorAction.d == 'e-resize' || editorAction.d == 'ne-resize' ||  editorAction.d == 'se-resize') {\r\n                editorAction.e.width = (editorAction.w + (e.clientX - editorAction.x));\r\n\r\n                if (e.shiftKey) {\r\n                    var newHeight = (e.clientX - editorAction.x) * (editorAction.h / editorAction.w);\r\n                    editorAction.e.height = editorAction.h + newHeight;\r\n                } else {\r\n                    var newHeight =  null;\r\n                }\r\n            }\r\n\r\n            if (! newHeight) {\r\n                if (editorAction.d == 's-resize' || editorAction.d == 'se-resize' || editorAction.d == 'sw-resize') {\r\n                    if (! e.shiftKey) {\r\n                        editorAction.e.height = editorAction.h + (e.clientY - editorAction.y);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    var editorKeyUp = function(e) {\r\n        if (! editor.innerHTML) {\r\n            editor.innerHTML = '<div><br></div>';\r\n        }\r\n\r\n        if (typeof(obj.options.onkeyup) == 'function') { \r\n            obj.options.onkeyup(el, obj, e);\r\n        }\r\n    }\r\n\r\n\r\n    var editorKeyDown = function(e) {\r\n        // Check for URL\r\n        if (obj.options.parseURL == true) {\r\n            verifyEditor();\r\n        }\r\n\r\n        if (typeof(obj.options.onkeydown) == 'function') { \r\n            obj.options.onkeydown(el, obj, e);\r\n        }\r\n\r\n        if (e.key == 'Delete') {\r\n            if (e.target.tagName == 'IMG' && e.target.parentNode.classList.contains('jsnippet-image')) {\r\n                e.target.remove();\r\n                updateTotalImages();\r\n            }\r\n        }\r\n    }\r\n\r\n    // Elements to be removed\r\n    var remove = [HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement];\r\n\r\n    // Valid properties\r\n    var validProperty = ['width', 'height', 'align', 'border', 'src', 'tabindex'];\r\n\r\n    // Valid CSS attributes\r\n    var validStyle = ['color', 'font-weight', 'font-size', 'background', 'background-color', 'margin'];\r\n\r\n    var parse = function(element) {\r\n       // Remove attributes\r\n       if (element.attributes && element.attributes.length) {\r\n           var image = null;\r\n           var style = null;\r\n           // Process style attribute\r\n           var elementStyle = element.getAttribute('style');\r\n           if (elementStyle) {\r\n               style = [];\r\n               var t = elementStyle.split(';');\r\n               for (var j = 0; j < t.length; j++) {\r\n                   var v = t[j].trim().split(':');\r\n                   if (validStyle.indexOf(v[0].trim()) >= 0) {\r\n                       var k = v.shift();\r\n                       var v = v.join(':');\r\n                       style.push(k + ':' + v);\r\n                   }\r\n               }\r\n           }\r\n           // Process image\r\n           if (element.tagName.toUpperCase() == 'IMG') {\r\n               if (! obj.options.acceptImages || ! element.src) {\r\n                   element.parentNode.removeChild(element);\r\n               } else {\r\n                   // Check if is data\r\n                   element.setAttribute('tabindex', '900');\r\n                   // Check attributes for persistance\r\n                   obj.addImage(element.src);\r\n               }\r\n           }\r\n           // Remove attributes\r\n           var attr = [];\r\n           var numAttributes = element.attributes.length - 1;\r\n           if (numAttributes > 0) {\r\n               for (var i = numAttributes; i >= 0 ; i--) {\r\n                   attr.push(element.attributes[i].name);\r\n               }\r\n               attr.forEach(function(v) {\r\n                   if (validProperty.indexOf(v) == -1) {\r\n                       element.removeAttribute(v);\r\n                   }\r\n               });\r\n           }\r\n           element.style = '';\r\n           // Add valid style\r\n           if (style && style.length) {\r\n               element.setAttribute('style', style.join(';'));\r\n           }\r\n       }\r\n       // Parse children\r\n       if (element.children.length) {\r\n           for (var i = 0; i < element.children.length; i++) {\r\n               parse(element.children[i]);\r\n           }\r\n       }\r\n\r\n       if (remove.indexOf(element.constructor) >= 0) {\r\n           element.remove();\r\n       }\r\n    }\r\n\r\n    var filter = function(data) {\r\n        if (data) {\r\n            data = data.replace(new RegExp('<!--(.*?)-->', 'gsi'), '');\r\n        }\r\n        var parser = new DOMParser();\r\n        var d = parser.parseFromString(data, \"text/html\");\r\n        parse(d);\r\n        var span = document.createElement('span');\r\n        span.innerHTML = d.firstChild.innerHTML;\r\n        return span;\r\n    } \r\n\r\n    var editorPaste = function(e) {\r\n        if (obj.options.filterPaste == true) {\r\n            if (e.clipboardData || e.originalEvent.clipboardData) {\r\n                var html = (e.originalEvent || e).clipboardData.getData('text/html');\r\n                var text = (e.originalEvent || e).clipboardData.getData('text/plain');\r\n                var file = (e.originalEvent || e).clipboardData.files\r\n            } else if (window.clipboardData) {\r\n                var html = window.clipboardData.getData('Html');\r\n                var text = window.clipboardData.getData('Text');\r\n                var file = window.clipboardData.files\r\n            }\r\n\r\n            if (file.length) {\r\n                // Paste a image from the clipboard\r\n                obj.addFile(file);\r\n            } else {\r\n                if (! html) {\r\n                    html = text.split('\\r\\n');\r\n                    if (! e.target.innerText) {\r\n                        html.map(function(v) {\r\n                            var d = document.createElement('div');\r\n                            d.innerText = v;\r\n                            editor.appendChild(d);\r\n                        });\r\n                    } else {\r\n                        html = html.map(function(v) {\r\n                            return '<div>' + v + '</div>';\r\n                        });\r\n                        document.execCommand('insertHtml', false, html.join(''));\r\n                    }\r\n                } else {\r\n                    var d = filter(html);\r\n                    // Paste to the editor\r\n                    insertNodeAtCaret(d);\r\n                }\r\n            }\r\n\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragStart = function(e) {\r\n        if (editorAction && editorAction.e) {\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragEnter = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            el.classList.add('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDragOver = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            if (editorTimer) {\r\n                clearTimeout(editorTimer);\r\n            }\r\n\r\n            editorTimer = setTimeout(function() {\r\n                el.classList.remove('jeditor-dragging');\r\n            }, 100);\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorDrop = function(e) {\r\n        if (editorAction || obj.options.dropZone == false) {\r\n            // Do nothing\r\n        } else {\r\n            // Position caret on the drop\r\n            var range = null;\r\n            if (document.caretRangeFromPoint) {\r\n                range=document.caretRangeFromPoint(e.clientX, e.clientY);\r\n            } else if (e.rangeParent) {\r\n                range=document.createRange();\r\n                range.setStart(e.rangeParent,e.rangeOffset);\r\n            }\r\n            var sel = window.getSelection();\r\n            sel.removeAllRanges();\r\n            sel.addRange(range);\r\n            sel.anchorNode.parentNode.focus();\r\n\r\n            var html = (e.originalEvent || e).dataTransfer.getData('text/html');\r\n            var text = (e.originalEvent || e).dataTransfer.getData('text/plain');\r\n            var file = (e.originalEvent || e).dataTransfer.files;\r\n    \r\n            if (file.length) {\r\n                obj.addFile(file);\r\n            } else if (text) {\r\n                extractImageFromHtml(html);\r\n            }\r\n\r\n            el.classList.remove('jeditor-dragging');\r\n            e.preventDefault();\r\n        }\r\n    }\r\n\r\n    var editorBlur = function(e) {\r\n        // Blur\r\n        if (typeof(obj.options.onblur) == 'function') {\r\n            obj.options.onblur(el, obj, e);\r\n        }\r\n\r\n        change(e);\r\n    }\r\n\r\n    var editorFocus = function(e) {\r\n        // Focus\r\n        if (typeof(obj.options.onfocus) == 'function') {\r\n            obj.options.onfocus(el, obj, e);\r\n        }\r\n    }\r\n\r\n    editor.addEventListener('mouseup', editorMouseUp);\r\n    editor.addEventListener('mousedown', editorMouseDown);\r\n    editor.addEventListener('mousemove', editorMouseMove);\r\n    editor.addEventListener('keyup', editorKeyUp);\r\n    editor.addEventListener('keydown', editorKeyDown);\r\n    editor.addEventListener('dragstart', editorDragStart);\r\n    editor.addEventListener('dragenter', editorDragEnter);\r\n    editor.addEventListener('dragover', editorDragOver);\r\n    editor.addEventListener('drop', editorDrop);\r\n    editor.addEventListener('paste', editorPaste);\r\n    editor.addEventListener('focus', editorFocus);\r\n    editor.addEventListener('blur', editorBlur);\r\n\r\n    // Onload\r\n    if (typeof(obj.options.onload) == 'function') {\r\n        obj.options.onload(el, obj, editor);\r\n    }\r\n\r\n    // Set value to the editor\r\n    editor.innerHTML = value;\r\n\r\n    // Append editor to the containre\r\n    el.appendChild(editor);\r\n\r\n    // Snippet\r\n    if (obj.options.snippet) {\r\n        appendElement(obj.options.snippet);\r\n    }\r\n\r\n    // Default toolbar\r\n    if (obj.options.toolbar == null) {\r\n        obj.options.toolbar = jSuites.editor.getDefaultToolbar();\r\n    }\r\n\r\n    // Add toolbar\r\n    if (obj.options.toolbar) {\r\n        // Append to the DOM\r\n        el.appendChild(toolbar);\r\n        // Create toolbar\r\n        jSuites.toolbar(toolbar, {\r\n            container: true,\r\n            responsive: true,\r\n            items: obj.options.toolbar\r\n        });\r\n    }\r\n\r\n    // Focus to the editor\r\n    if (obj.options.focus) {\r\n        jSuites.editor.setCursor(editor, obj.options.focus == 'initial' ? true : false);\r\n    }\r\n\r\n    // Change method\r\n    el.change = obj.setData;\r\n\r\n    // Global generic value handler\r\n    el.val = function(val) {\r\n        if (val === undefined) {\r\n            // Data type\r\n            var o = el.getAttribute('data-html') === 'true' ? false : true;\r\n            return obj.getData(o);\r\n        } else {\r\n            obj.setData(val);\r\n        }\r\n    }\r\n\r\n    el.editor = obj;\r\n\r\n    return obj;\r\n});\r\n\r\njSuites.editor.setCursor = function(element, first) {\r\n    element.focus();\r\n    document.execCommand('selectAll');\r\n    var sel = window.getSelection();\r\n    var range = sel.getRangeAt(0);\r\n    if (first == true) {\r\n        var node = range.startContainer;\r\n        var size = 0;\r\n    } else {\r\n        var node = range.endContainer;\r\n        var size = node.length;\r\n    }\r\n    range.setStart(node, size);\r\n    range.setEnd(node, size);\r\n    sel.removeAllRanges();\r\n    sel.addRange(range);\r\n}\r\n\r\njSuites.editor.getDomain = function(url) {\r\n    return url.replace('http://','').replace('https://','').replace('www.','').split(/[/?#]/)[0].split(/:/g)[0];\r\n}\r\n\r\njSuites.editor.detectUrl = function(text) {\r\n    var expression = /(((https?:\\/\\/)|(www\\.))[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|]+)/ig;\r\n    var links = text.match(expression);\r\n\r\n    if (links) {\r\n        if (links[0].substr(0,3) == 'www') {\r\n            links[0] = 'http://' + links[0];\r\n        }\r\n    }\r\n\r\n    return links;\r\n}\r\n\r\njSuites.editor.youtubeParser = function(url) {\r\n    var regExp = /^.*((youtu.be\\/)|(v\\/)|(\\/u\\/\\w\\/)|(embed\\/)|(watch\\?))\\??v?=?([^#\\&\\?]*).*/;\r\n    var match = url.match(regExp);\r\n\r\n    return (match && match[7].length == 11) ? match[7] : false;\r\n}\r\n\r\njSuites.editor.getDefaultToolbar = function() { \r\n    return [\r\n        {\r\n            content: 'undo',\r\n            onclick: function() {\r\n                document.execCommand('undo');\r\n            }\r\n        },\r\n        {\r\n            content: 'redo',\r\n            onclick: function() {\r\n                document.execCommand('redo');\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_bold',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('bold');\r\n\r\n                if (document.queryCommandState(\"bold\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_italic',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('italic');\r\n\r\n                if (document.queryCommandState(\"italic\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_underline',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('underline');\r\n\r\n                if (document.queryCommandState(\"underline\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            type:'divisor'\r\n        },\r\n        {\r\n            content: 'format_list_bulleted',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_list_numbered',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('insertOrderedList');\r\n\r\n                if (document.queryCommandState(\"insertOrderedList\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_increase',\r\n            onclick: function(a,b,c) {\r\n                document.execCommand('indent', true, null);\r\n\r\n                if (document.queryCommandState(\"indent\")) {\r\n                    c.classList.add('selected');\r\n                } else {\r\n                    c.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            content: 'format_indent_decrease',\r\n            onclick: function() {\r\n                document.execCommand('outdent');\r\n\r\n                if (document.queryCommandState(\"outdent\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }/*,\r\n        {\r\n            icon: ['format_align_left', 'format_align_right', 'format_align_center'],\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }\r\n        {\r\n            type:'select',\r\n            items: ['Verdana','Arial','Courier New'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            type:'select',\r\n            items: ['10px','12px','14px','16px','18px','20px','22px'],\r\n            onchange: function() {\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_left',\r\n            onclick: function() {\r\n                document.execCommand('JustifyLeft');\r\n\r\n                if (document.queryCommandState(\"JustifyLeft\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_center',\r\n            onclick: function() {\r\n                document.execCommand('justifyCenter');\r\n\r\n                if (document.queryCommandState(\"justifyCenter\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_right',\r\n            onclick: function() {\r\n                document.execCommand('justifyRight');\r\n\r\n                if (document.queryCommandState(\"justifyRight\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_align_justify',\r\n            onclick: function() {\r\n                document.execCommand('justifyFull');\r\n\r\n                if (document.queryCommandState(\"justifyFull\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        },\r\n        {\r\n            icon:'format_list_bulleted',\r\n            onclick: function() {\r\n                document.execCommand('insertUnorderedList');\r\n\r\n                if (document.queryCommandState(\"insertUnorderedList\")) {\r\n                    this.classList.add('selected');\r\n                } else {\r\n                    this.classList.remove('selected');\r\n                }\r\n            }\r\n        }*/\r\n    ];\r\n}\r\n"], "filenames": ["dist/jsuites.basic.js", "dist/jsuites.js", "dist/jsuites.layout.css", "dist/jsuites.layout.js", "package.json", "src/editor.js"], "buggy_code_start_loc": [20, 20, 1590, 1704, 22, 454], "buggy_code_end_loc": [5313, 5324, 1590, 1779, 23, 766], "fixing_code_start_loc": [20, 20, 1591, 1704, 22, 455], "fixing_code_end_loc": [5328, 5339, 1592, 1790, 23, 781], "type": "CWE-79", "message": "jsuites is an open source collection of common required javascript web components. In affected versions users are subject to cross site scripting (XSS) attacks via clipboard content. jsuites is vulnerable to DOM based XSS if the user can be tricked into copying _anything_ from a malicious and pasting it into the html editor. This is because a part of the clipboard content is directly written to `innerHTML` allowing for javascript injection and thus XSS. Users are advised to update to version 4.9.11 to resolve.", "other": {"cve": {"id": "CVE-2021-41086", "sourceIdentifier": "security-advisories@github.com", "published": "2021-09-21T21:15:07.130", "lastModified": "2021-09-29T14:34:34.340", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "jsuites is an open source collection of common required javascript web components. In affected versions users are subject to cross site scripting (XSS) attacks via clipboard content. jsuites is vulnerable to DOM based XSS if the user can be tricked into copying _anything_ from a malicious and pasting it into the html editor. This is because a part of the clipboard content is directly written to `innerHTML` allowing for javascript injection and thus XSS. Users are advised to update to version 4.9.11 to resolve."}, {"lang": "es", "value": "jsuites es una colecci\u00f3n de c\u00f3digo abierto de componentes web javascript comunes necesarios. En las versiones afectadas los usuarios est\u00e1n sujetos a ataques de tipo cross site scripting (XSS) por medio del contenido del portapapeles. jsuites es vulnerable a un ataque de tipo XSS basado en el DOM si es posible enga\u00f1ar al usuario para que copie _anything_ de un malicioso y lo pegue en el editor html. Esto es debido a que una parte del contenido del portapapeles es escrita directamente en \"innerHTML\", permitiendo una inyecci\u00f3n de javascript y, por tanto, un ataque de tipo XSS. Se recomienda a usuarios que actualicen a la versi\u00f3n 4.9.11 para resolverlo"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.3, "impactScore": 5.8}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:jsuites:jsuites:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.9.11", "matchCriteriaId": "E2FCB12E-821F-4EC0-9023-7FA9BDF2528D"}]}]}], "references": [{"url": "https://github.com/jsuites/jsuites/commit/d47a6f4e143188dde2742f4cffd313e1068ad3b3", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/jsuites/jsuites/commit/fe1d3cc5e339f2f4da8ed1f9f42271fdf9cbd8d2", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/jsuites/jsuites/security/advisories/GHSA-qh7x-j4v8-qw5w", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/jsuites/jsuites/commit/d47a6f4e143188dde2742f4cffd313e1068ad3b3"}}