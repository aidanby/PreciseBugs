{"buggy_code": ["AllowedHosts=\"*\"\r\n\r\n[Headquarters]\r\n# External URL that should be used by clients to access application. Do not append trailing / at the end\r\nBaseUrl={BaseUrl}\r\nTenantName={TenantName}\r\n\r\n\r\n[FileStorage]\r\n# Path to binary files storage, like images and audio\r\n# Can be relative to executable directory \r\n# Can be absolute path\r\n# Can be S3:// path, i.e. s3://bucketname/path/to/data/folder. \r\n#   Please refer to [AWS] section for Amazon S3 configuration\r\nAppData=~/AppData\r\n# Temporary data location.\r\nTempData=~/AppData\r\nFFmpegExecutablePath=\r\n\r\n[ExportSettings]\r\nDirectoryPath=~/AppData/export\r\n\r\n[Designer]\r\nDesignerAddress=https://designer.mysurvey.solutions\r\n# value in seconds\r\nRestTimeout=30\r\nAcceptUnsignedCertificate=false\r\n\r\n[PreLoading]\r\nInterviewsImportParallelTasksLimit=2\r\n# MaxAllowedRecordNumber=\r\n# EmailFormatRegex=\r\n# PhoneNumberFormatRegex=\r\n# PasswordStrengthRegularExpression=\r\n\r\n[Geospatial]\r\nGdalHome=C:\\OSGeo4W64\\bin\\\r\n\r\n[DataExport]\r\nExportServiceUrl=${ExportServiceUrl}\r\n\r\n[Apks]\r\nClientApkPath=${ClientApkPath}\r\n\r\n[Tracking]\r\nWebInterviewPauseResumeGraceTimespan=\"00:00:10\"\r\n\r\n[Metrics]\r\n# Pushgateway endpoint location where HQ should report metrics data\r\nPushGatewayEndpoint = http://localhost:9091/metrics\r\n# Should HQ use Pushgateway to report metrics data\r\nUsePushGateway = false\r\n# Should HQ expose metrics data via '/metrics' endpoint\r\nUseMetricsEndpoint = true\r\n\r\n[ConnectionStrings]\r\nDefaultConnection=\r\n\r\n[VersionCheck]\r\nNewVersionCheckEnabled=true\r\nNewVersionCheckUrl=https://pds.mysurvey.solutions/api/apps/release\r\n\r\n[Scheduler]\r\nInstanceId=\r\nIsClustered=false\r\n\r\n[SyncPackageReprocessor]\r\nSynchronizationInterval=10\r\nSynchronizationBatchCount=5\r\nSynchronizationParallelExecutorsCount=1\r\n\r\n[Captcha]\r\nCaptchaType=Hosted\r\nSecretKey=\r\nSiteKey=\r\nVersion=v2\r\n\r\n[GoogleMap]\r\nApiKey=\r\nApiBaseUrl=https://maps.googleapis.com\r\nBaseUrl=https://www.google.com\r\n\r\n# For Amazon configuration please refer to this doc: \r\n# https://docs.aws.amazon.com/sdk-for-net/v3/developer-guide/net-dg-config-netcore.html\r\n# Please note, that AWS SDK do not allow to provider S3 credentials in APP config: \r\n# https://docs.aws.amazon.com/sdk-for-net/v3/developer-guide/net-dg-config-creds.html\r\n# It's required to specify either Region or ServiceURL configurations for S3 provider to work \r\n[AWS]\r\nRegion = us-east-1\r\n\r\n[EventHandlers]\r\n# following denormalizers wont receive events\r\n# disabled:0=\"WB.Core.BoundedContexts.Headquarters.EventHandler.CumulativeChartDenormalizer, WB.Core.BoundedContexts.Headquarters\"\r\n\r\n# exceptions thrown by following denormalizers wont stop events processing and rolling back made changes\r\nignoredException:0=\"WB.Core.BoundedContexts.Headquarters.EventHandler.InterviewStatusTimeSpanDenormalizer, WB.Core.BoundedContexts.Headquarters\"\r\nignoredException:1=\"WB.Core.BoundedContexts.Headquarters.EventHandler.CumulativeChartDenormalizer, WB.Core.BoundedContexts.Headquarters\"\r\nignoredException:2=\"WB.Enumerator.Native.WebInterview.InterviewLifecycleEventHandler, WB.Enumerator.Native.Core\"\r\n\r\n[PasswordOptions]\r\nRequireDigit=true\r\nRequiredLength=10\r\nRequiredUniqueChars=0\r\nRequireLowercase=true\r\nRequireNonAlphanumeric=false\r\nRequireUppercase=true\r\n\r\n[Authentication]\r\n# accepted values are parsed by TimeSpan.Parse method with invariant culture\r\n# one day if not set\r\nTicketExpirationTimeOut=1.00:00:00 \r\nMaxFailedAccessAttemptsBeforeLockout=15\r\nLockoutDuration=00:15:00\r\n\r\n[Policies]\r\n# overrides default policy\r\n# true - enforces always\r\n# false - enforces none\r\n# ommited - default behaviour:  SameAsRequest\r\n# CookiesSecurePolicyAlways=true\r\n\r\n[Exceptional:Store]\r\nApplicationName=\"HQ\"\r\nType=\"PostgreSql\"\r\n\r\n[Exceptional:LogFilters:Cookie]\r\n.AspNetCore.Identity.Application=\"***\"\r\n\r\n[Exceptional:LogFilters:Form]\r\npassword=\"*********\"\r\nconfirmPassword=\"*********\"\r\n\r\n[Exceptional:Ignore]\r\n[Exceptional:Ignore:Regexes]\r\n404=\"was not found or does not implement\"\r\n\r\n[Exceptional:Ignore:Types]\r\nOperationCanceledException=\"System.OperationCanceledException\"\r\n\r\n[WebInterview]\r\nLazyNotification=false\r\n"], "fixing_code": ["AllowedHosts=\"*\"\r\n\r\n[Headquarters]\r\n# External URL that should be used by clients to access application. Do not append trailing / at the end\r\nBaseUrl={BaseUrl}\r\nTenantName={TenantName}\r\n\r\n\r\n[FileStorage]\r\n# Path to binary files storage, like images and audio\r\n# Can be relative to executable directory \r\n# Can be absolute path\r\n# Can be S3:// path, i.e. s3://bucketname/path/to/data/folder. \r\n#   Please refer to [AWS] section for Amazon S3 configuration\r\nAppData=~/AppData\r\n# Temporary data location.\r\nTempData=~/AppData\r\nFFmpegExecutablePath=\r\n\r\n[ExportSettings]\r\nDirectoryPath=~/AppData/export\r\n\r\n[Designer]\r\nDesignerAddress=https://designer.mysurvey.solutions\r\n# value in seconds\r\nRestTimeout=30\r\nAcceptUnsignedCertificate=false\r\n\r\n[PreLoading]\r\nInterviewsImportParallelTasksLimit=2\r\n# MaxAllowedRecordNumber=\r\n# EmailFormatRegex=\r\n# PhoneNumberFormatRegex=\r\n# PasswordStrengthRegularExpression=\r\n\r\n[Geospatial]\r\nGdalHome=C:\\OSGeo4W64\\bin\\\r\n\r\n[DataExport]\r\nExportServiceUrl=${ExportServiceUrl}\r\n\r\n[Apks]\r\nClientApkPath=${ClientApkPath}\r\n\r\n[Tracking]\r\nWebInterviewPauseResumeGraceTimespan=\"00:00:10\"\r\n\r\n[Metrics]\r\n# Pushgateway endpoint location where HQ should report metrics data\r\nPushGatewayEndpoint = http://localhost:9091/metrics\r\n# Should HQ use Pushgateway to report metrics data\r\nUsePushGateway = false\r\n# Should HQ expose metrics data via '/metrics' endpoint\r\nUseMetricsEndpoint = false\r\n\r\n[ConnectionStrings]\r\nDefaultConnection=\r\n\r\n[VersionCheck]\r\nNewVersionCheckEnabled=true\r\nNewVersionCheckUrl=https://pds.mysurvey.solutions/api/apps/release\r\n\r\n[Scheduler]\r\nInstanceId=\r\nIsClustered=false\r\n\r\n[SyncPackageReprocessor]\r\nSynchronizationInterval=10\r\nSynchronizationBatchCount=5\r\nSynchronizationParallelExecutorsCount=1\r\n\r\n[Captcha]\r\nCaptchaType=Hosted\r\nSecretKey=\r\nSiteKey=\r\nVersion=v2\r\n\r\n[GoogleMap]\r\nApiKey=\r\nApiBaseUrl=https://maps.googleapis.com\r\nBaseUrl=https://www.google.com\r\n\r\n# For Amazon configuration please refer to this doc: \r\n# https://docs.aws.amazon.com/sdk-for-net/v3/developer-guide/net-dg-config-netcore.html\r\n# Please note, that AWS SDK do not allow to provider S3 credentials in APP config: \r\n# https://docs.aws.amazon.com/sdk-for-net/v3/developer-guide/net-dg-config-creds.html\r\n# It's required to specify either Region or ServiceURL configurations for S3 provider to work \r\n[AWS]\r\nRegion = us-east-1\r\n\r\n[EventHandlers]\r\n# following denormalizers wont receive events\r\n# disabled:0=\"WB.Core.BoundedContexts.Headquarters.EventHandler.CumulativeChartDenormalizer, WB.Core.BoundedContexts.Headquarters\"\r\n\r\n# exceptions thrown by following denormalizers wont stop events processing and rolling back made changes\r\nignoredException:0=\"WB.Core.BoundedContexts.Headquarters.EventHandler.InterviewStatusTimeSpanDenormalizer, WB.Core.BoundedContexts.Headquarters\"\r\nignoredException:1=\"WB.Core.BoundedContexts.Headquarters.EventHandler.CumulativeChartDenormalizer, WB.Core.BoundedContexts.Headquarters\"\r\nignoredException:2=\"WB.Enumerator.Native.WebInterview.InterviewLifecycleEventHandler, WB.Enumerator.Native.Core\"\r\n\r\n[PasswordOptions]\r\nRequireDigit=true\r\nRequiredLength=10\r\nRequiredUniqueChars=0\r\nRequireLowercase=true\r\nRequireNonAlphanumeric=false\r\nRequireUppercase=true\r\n\r\n[Authentication]\r\n# accepted values are parsed by TimeSpan.Parse method with invariant culture\r\n# one day if not set\r\nTicketExpirationTimeOut=1.00:00:00 \r\nMaxFailedAccessAttemptsBeforeLockout=15\r\nLockoutDuration=00:15:00\r\n\r\n[Policies]\r\n# overrides default policy\r\n# true - enforces always\r\n# false - enforces none\r\n# ommited - default behaviour:  SameAsRequest\r\n# CookiesSecurePolicyAlways=true\r\n\r\n[Exceptional:Store]\r\nApplicationName=\"HQ\"\r\nType=\"PostgreSql\"\r\n\r\n[Exceptional:LogFilters:Cookie]\r\n.AspNetCore.Identity.Application=\"***\"\r\n\r\n[Exceptional:LogFilters:Form]\r\npassword=\"*********\"\r\nconfirmPassword=\"*********\"\r\n\r\n[Exceptional:Ignore]\r\n[Exceptional:Ignore:Regexes]\r\n404=\"was not found or does not implement\"\r\n\r\n[Exceptional:Ignore:Types]\r\nOperationCanceledException=\"System.OperationCanceledException\"\r\n\r\n[WebInterview]\r\nLazyNotification=false\r\n"], "filenames": ["src/UI/WB.UI.Headquarters.Core/appsettings.ini"], "buggy_code_start_loc": [54], "buggy_code_end_loc": [55], "fixing_code_start_loc": [54], "fixing_code_end_loc": [55], "type": "NVD-CWE-Other", "message": "Survey Solutions is a survey management and data collection system. In affected versions the Headquarters application publishes /metrics endpoint available to any user. None of the survey answers are ever exposed, only the aggregate counters, including count of interviews, or count of assignments. Starting from version 21.09.1 the endpoint is turned off by default.", "other": {"cve": {"id": "CVE-2021-41123", "sourceIdentifier": "security-advisories@github.com", "published": "2021-10-04T23:15:08.470", "lastModified": "2022-08-12T16:49:27.533", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Survey Solutions is a survey management and data collection system. In affected versions the Headquarters application publishes /metrics endpoint available to any user. None of the survey answers are ever exposed, only the aggregate counters, including count of interviews, or count of assignments. Starting from version 21.09.1 the endpoint is turned off by default."}, {"lang": "es", "value": "Survey Solutions es un sistema de administraci\u00f3n de encuestas y recogida de datos. En las versiones afectadas, la aplicaci\u00f3n de la Sede publica el endpoint /metrics disponible para cualquier usuario. Ninguna de las respuestas de la encuesta es expuesta, s\u00f3lo los contadores agregados, incluyendo el recuento de entrevistas, o el recuento de asignaciones. A partir de la versi\u00f3n 21.09.1, el endpoint est\u00e1 desactivado por defecto"}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mysurvey:survey_solutions:*:*:*:*:*:*:*:*", "versionEndExcluding": "21.09.1", "matchCriteriaId": "AFC12803-8271-455E-BA3F-1E0CBF6E1EC2"}]}]}], "references": [{"url": "https://github.com/surveysolutions/surveysolutions/commit/99e7e8345cb98f2eda08e37976e3d3aeb49971c9", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/surveysolutions/surveysolutions/security/advisories/GHSA-6c7j-7jf3-9p3j", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/surveysolutions/surveysolutions/commit/99e7e8345cb98f2eda08e37976e3d3aeb49971c9"}}