{"buggy_code": ["# frozen_string_literal: true\n\n# Copyright (c) 2008-2013 Michael Dvorkin and contributors.\n#\n# Fat Free CRM is freely distributable under the terms of MIT license.\n# See MIT-LICENSE file or http://www.opensource.org/licenses/mit-license.php\n#------------------------------------------------------------------------------\nmodule TagsHelper\n  # Generate tag links for use on asset index pages.\n  #----------------------------------------------------------------------------\n  def tags_for_index(model)\n    model.tags.inject(\"\".html_safe) do |out, tag|\n      query = controller.send(:current_query) || \"\"\n      hashtag = \"##{tag}\"\n      if query.empty?\n        query = hashtag\n      elsif !query.include?(hashtag)\n        query += \" #{hashtag}\"\n      end\n      out << link_to_function(tag, \"crm.search_tagged('#{query}', '#{model.class.to_s.tableize}')\", title: tag)\n    end\n  end\n\n  def tags_for_dashboard(model)\n    content_tag(:ul) do\n      model.tags.each do |tag|\n        concat(content_tag(:li, tag.name))\n      end\n    end\n  end\nend\n"], "fixing_code": ["# frozen_string_literal: true\n\n# Copyright (c) 2008-2013 Michael Dvorkin and contributors.\n#\n# Fat Free CRM is freely distributable under the terms of MIT license.\n# See MIT-LICENSE file or http://www.opensource.org/licenses/mit-license.php\n#------------------------------------------------------------------------------\nmodule TagsHelper\n  # Generate tag links for use on asset index pages.\n  #----------------------------------------------------------------------------\n  def tags_for_index(model)\n    model.tags.inject(\"\".html_safe) do |out, tag|\n      query = controller.send(:current_query) || \"\"\n      hashtag = \"##{tag}\"\n      if query.empty?\n        query = hashtag\n      elsif !query.include?(hashtag)\n        query += \" #{hashtag}\"\n      end\n      out << link_to_function(tag, \"crm.search_tagged('#{escape_javascript(query)}', '#{model.class.to_s.tableize}')\", title: tag)\n    end\n  end\n\n  def tags_for_dashboard(model)\n    content_tag(:ul) do\n      model.tags.each do |tag|\n        concat(content_tag(:li, tag.name))\n      end\n    end\n  end\nend\n"], "filenames": ["app/helpers/tags_helper.rb"], "buggy_code_start_loc": [20], "buggy_code_end_loc": [21], "fixing_code_start_loc": [20], "fixing_code_end_loc": [21], "type": "CWE-79", "message": "Fat Free CRM before 0.18.1 has XSS in the tags_helper in app/helpers/tags_helper.rb.", "other": {"cve": {"id": "CVE-2018-20975", "sourceIdentifier": "cve@mitre.org", "published": "2019-08-20T13:15:11.323", "lastModified": "2019-08-26T13:53:55.583", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Fat Free CRM before 0.18.1 has XSS in the tags_helper in app/helpers/tags_helper.rb."}, {"lang": "es", "value": "Fat Free CRM antes de 0.18.1 tiene XSS en tags_helper en app / helpers / tags_helper.rb."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:fatfreecrm:fat_free_crm:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.18.1", "matchCriteriaId": "0E244B52-0A10-4332-A60E-3A6633317D25"}]}]}], "references": [{"url": "https://github.com/fatfreecrm/fat_free_crm/commit/6d60bc8ed010c4eda05d6645c64849f415f68d65", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/fatfreecrm/fat_free_crm/compare/v0.17.3...v0.18.1", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/fatfreecrm/fat_free_crm/releases/tag/v0.18.1", "source": "cve@mitre.org", "tags": ["Release Notes"]}]}, "github_commit_url": "https://github.com/fatfreecrm/fat_free_crm/commit/6d60bc8ed010c4eda05d6645c64849f415f68d65"}}