{"buggy_code": ["{\n  \"name\": \"underscore.deep\",\n  \"version\": \"0.5.1\",\n  \"lockfileVersion\": 1,\n  \"requires\": true,\n  \"dependencies\": {\n    \"coffee-script\": {\n      \"version\": \"1.6.3\",\n      \"resolved\": \"https://registry.npmjs.org/coffee-script/-/coffee-script-1.6.3.tgz\",\n      \"integrity\": \"sha512-lpusDYw9xym9ZOqFIeQuzzvTvunm2nlRL++BYhUcLn+77vuidExZG+qDPSKUfDXvuaHeFK6QavntXF+HiOq+/Q==\",\n      \"dev\": true\n    },\n    \"commander\": {\n      \"version\": \"2.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/commander/-/commander-2.3.0.tgz\",\n      \"integrity\": \"sha512-CD452fnk0jQyk3NfnK+KkR/hUPoHt5pVaKHogtyyv3N0U4QfAal9W0/rXLOg/vVZgQKa7jdtXypKs1YAip11uQ==\",\n      \"dev\": true\n    },\n    \"debug\": {\n      \"version\": \"2.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/debug/-/debug-2.2.0.tgz\",\n      \"integrity\": \"sha512-X0rGvJcskG1c3TgSCPqHJ0XJgwlcvOC7elJ5Y0hYuKBZoVqWpAMfLOeIh2UI/DCQ5ruodIjvsugZtjUYUw2pUw==\",\n      \"dev\": true,\n      \"requires\": {\n        \"ms\": \"0.7.1\"\n      }\n    },\n    \"diff\": {\n      \"version\": \"1.4.0\",\n      \"resolved\": \"https://registry.npmjs.org/diff/-/diff-1.4.0.tgz\",\n      \"integrity\": \"sha512-VzVc42hMZbYU9Sx/ltb7KYuQ6pqAw+cbFWVy4XKdkuEL2CFaRLGEnISPs7YdzaUGpi+CpIqvRmu7hPQ4T7EQ5w==\",\n      \"dev\": true\n    },\n    \"escape-string-regexp\": {\n      \"version\": \"1.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/escape-string-regexp/-/escape-string-regexp-1.0.2.tgz\",\n      \"integrity\": \"sha512-cQpUid7bdTUnFin8S7BnNdOk+/eDqQmKgCANSyd/jAhrKEvxUvr9VQ8XZzXiOtest8NLfk3FSBZzwvemZNQ6Vg==\",\n      \"dev\": true\n    },\n    \"glob\": {\n      \"version\": \"3.2.11\",\n      \"resolved\": \"https://registry.npmjs.org/glob/-/glob-3.2.11.tgz\",\n      \"integrity\": \"sha512-hVb0zwEZwC1FXSKRPFTeOtN7AArJcJlI6ULGLtrstaswKNlrTJqAA+1lYlSUop4vjA423xlBzqfVS3iWGlqJ+g==\",\n      \"dev\": true,\n      \"requires\": {\n        \"inherits\": \"2\",\n        \"minimatch\": \"0.3\"\n      }\n    },\n    \"growl\": {\n      \"version\": \"1.9.2\",\n      \"resolved\": \"https://registry.npmjs.org/growl/-/growl-1.9.2.tgz\",\n      \"integrity\": \"sha512-RTBwDHhNuOx4F0hqzItc/siXCasGfC4DeWcBamclWd+6jWtBaeB/SGbMkGf0eiQoW7ib8JpvOgnUsmgMHI3Mfw==\",\n      \"dev\": true\n    },\n    \"inherits\": {\n      \"version\": \"2.0.4\",\n      \"resolved\": \"https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz\",\n      \"integrity\": \"sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==\",\n      \"dev\": true\n    },\n    \"jade\": {\n      \"version\": \"0.26.3\",\n      \"resolved\": \"https://registry.npmjs.org/jade/-/jade-0.26.3.tgz\",\n      \"integrity\": \"sha512-mkk3vzUHFjzKjpCXeu+IjXeZD+QOTjUUdubgmHtHTDwvAO2ZTkMTTVrapts5CWz3JvJryh/4KWZpjeZrCepZ3A==\",\n      \"dev\": true,\n      \"requires\": {\n        \"commander\": \"0.6.1\",\n        \"mkdirp\": \"0.3.0\"\n      },\n      \"dependencies\": {\n        \"commander\": {\n          \"version\": \"0.6.1\",\n          \"resolved\": \"https://registry.npmjs.org/commander/-/commander-0.6.1.tgz\",\n          \"integrity\": \"sha512-0fLycpl1UMTGX257hRsu/arL/cUbcvQM4zMKwvLvzXtfdezIV4yotPS2dYtknF+NmEfWSoCEF6+hj9XLm/6hEw==\",\n          \"dev\": true\n        },\n        \"mkdirp\": {\n          \"version\": \"0.3.0\",\n          \"resolved\": \"https://registry.npmjs.org/mkdirp/-/mkdirp-0.3.0.tgz\",\n          \"integrity\": \"sha512-OHsdUcVAQ6pOtg5JYWpCBo9W/GySVuwvP9hueRMW7UqshC0tbfzLv8wjySTPm3tfUZ/21CE9E1pJagOA91Pxew==\",\n          \"dev\": true\n        }\n      }\n    },\n    \"lru-cache\": {\n      \"version\": \"2.7.3\",\n      \"resolved\": \"https://registry.npmjs.org/lru-cache/-/lru-cache-2.7.3.tgz\",\n      \"integrity\": \"sha512-WpibWJ60c3AgAz8a2iYErDrcT2C7OmKnsWhIcHOjkUHFjkXncJhtLxNSqUmxRxRunpb5I8Vprd7aNSd2NtksJQ==\",\n      \"dev\": true\n    },\n    \"minimatch\": {\n      \"version\": \"0.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/minimatch/-/minimatch-0.3.0.tgz\",\n      \"integrity\": \"sha512-WFX1jI1AaxNTZVOHLBVazwTWKaQjoykSzCBNXB72vDTCzopQGtyP91tKdFK5cv1+qMwPyiTu1HqUriqplI8pcA==\",\n      \"dev\": true,\n      \"requires\": {\n        \"lru-cache\": \"2\",\n        \"sigmund\": \"~1.0.0\"\n      }\n    },\n    \"minimist\": {\n      \"version\": \"0.0.8\",\n      \"resolved\": \"https://registry.npmjs.org/minimist/-/minimist-0.0.8.tgz\",\n      \"integrity\": \"sha512-miQKw5Hv4NS1Psg2517mV4e4dYNaO3++hjAvLOAzKqZ61rH8NS1SK+vbfBWZ5PY/Me/bEWhUwqMghEW5Fb9T7Q==\",\n      \"dev\": true\n    },\n    \"mkdirp\": {\n      \"version\": \"0.5.1\",\n      \"resolved\": \"https://registry.npmjs.org/mkdirp/-/mkdirp-0.5.1.tgz\",\n      \"integrity\": \"sha512-SknJC52obPfGQPnjIkXbmA6+5H15E+fR+E4iR2oQ3zzCLbd7/ONua69R/Gw7AgkTLsRG+r5fzksYwWe1AgTyWA==\",\n      \"dev\": true,\n      \"requires\": {\n        \"minimist\": \"0.0.8\"\n      }\n    },\n    \"mocha\": {\n      \"version\": \"2.5.3\",\n      \"resolved\": \"https://registry.npmjs.org/mocha/-/mocha-2.5.3.tgz\",\n      \"integrity\": \"sha512-jNt2iEk9FPmZLzL+sm4FNyOIDYXf2wUU6L4Cc8OIKK/kzgMHKPi4YhTZqG4bW4kQVdIv6wutDybRhXfdnujA1Q==\",\n      \"dev\": true,\n      \"requires\": {\n        \"commander\": \"2.3.0\",\n        \"debug\": \"2.2.0\",\n        \"diff\": \"1.4.0\",\n        \"escape-string-regexp\": \"1.0.2\",\n        \"glob\": \"3.2.11\",\n        \"growl\": \"1.9.2\",\n        \"jade\": \"0.26.3\",\n        \"mkdirp\": \"0.5.1\",\n        \"supports-color\": \"1.2.0\",\n        \"to-iso-string\": \"0.0.2\"\n      }\n    },\n    \"ms\": {\n      \"version\": \"0.7.1\",\n      \"resolved\": \"https://registry.npmjs.org/ms/-/ms-0.7.1.tgz\",\n      \"integrity\": \"sha512-lRLiIR9fSNpnP6TC4v8+4OU7oStC01esuNowdQ34L+Gk8e5Puoc88IqJ+XAY/B3Mn2ZKis8l8HX90oU8ivzUHg==\",\n      \"dev\": true\n    },\n    \"sigmund\": {\n      \"version\": \"1.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/sigmund/-/sigmund-1.0.1.tgz\",\n      \"integrity\": \"sha512-fCvEXfh6NWpm+YSuY2bpXb/VIihqWA6hLsgboC+0nl71Q7N7o2eaCW8mJa/NLvQhs6jpd3VZV4UiUQlV6+lc8g==\",\n      \"dev\": true\n    },\n    \"supports-color\": {\n      \"version\": \"1.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/supports-color/-/supports-color-1.2.0.tgz\",\n      \"integrity\": \"sha512-mS5xsnjTh5b7f2DM6bch6lR582UCOTphzINlZnDsfpIRrwI6r58rb6YSSGsdexkm8qw2bBVO2ID2fnJOTuLiPA==\",\n      \"dev\": true\n    },\n    \"to-iso-string\": {\n      \"version\": \"0.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/to-iso-string/-/to-iso-string-0.0.2.tgz\",\n      \"integrity\": \"sha512-oeHLgfWA7d0CPQa6h0+i5DAJZISz5un0d5SHPkw+Untclcvzv9T+AC3CvGXlZJdOlIbxbTfyyzlqCXc5hjpXYg==\",\n      \"dev\": true\n    },\n    \"underscore\": {\n      \"version\": \"1.5.2\",\n      \"resolved\": \"https://registry.npmjs.org/underscore/-/underscore-1.5.2.tgz\",\n      \"integrity\": \"sha512-yejOFsRnTJs0N9CK5Apzf6maDO2djxGoLLrlZlvGs2o9ZQuhIhDL18rtFyy4FBIbOkzA6+4hDgXbgz5EvDQCXQ==\",\n      \"dev\": true\n    }\n  }\n}\n", "{\n  \"name\": \"underscore.deep\",\n  \"version\": \"0.5.2\",\n  \"description\": \"Underscore mixins for deeply nested objects\",\n  \"main\": \"underscore.deep.js\",\n  \"engines\": {\n    \"node\": \">=0.10.x\"\n  },\n  \"repository\": \"https://github.com/Clever/underscore.deep\",\n  \"scripts\": {\n    \"prepublish\": \"make\",\n    \"test\": \"make test\"\n  },\n  \"license\": \"BSD\",\n  \"peerDependencies\": {\n    \"underscore\": \"1.x\"\n  },\n  \"devDependencies\": {\n    \"coffee-script\": \"~1.6.3\",\n    \"mocha\": \"^2.5.3\",\n    \"underscore\": \"~1.5.2\"\n  },\n  \"publishConfig\": {\n    \"registry\": \"https://registry.npmjs.org\"\n  }\n}\n", "assert = require 'assert'\n_ = require('underscore')\n_.mixin require('../underscore.deep.js')\n\ndescribe '_.deepFromFlat', ->\n\n  tests = [\n    input:\n      \"a.b\":1\n      \"a.c\": 2\n      \"b\": 3\n      \"5.4.3.2.1\": 0\n    output:\n      5: 4: 3: 2: 1: 0\n      a:\n        b: 1\n        c: 2\n      b: 3\n  ]\n  _(tests).each (test) ->\n    it \"deepens #{JSON.stringify test.input}\", ->\n      assert.deepEqual _.deepFromFlat(test.input), test.output\n", "_ = require 'underscore'\n\nmodule.exports =\n\n  deepKeys: deepKeys = (obj) ->\n    throw new Error \"deepKeys must be called on an object, not '#{obj}'\" unless isPlainObject obj\n    # In the base case where obj is empty, _.map(obj, ...) will produce []\n    _.flatten _.map obj, (v, k) ->\n      if isPlainObject(v) and not _.isEmpty(v)\n        _.map deepKeys(v), (subkey) -> \"#{k}.#{subkey}\"\n      else\n        [k]\n\n  # http://stackoverflow.com/questions/4459928/how-to-deep-clone-in-javascript\n  # This is mostly the same as the accepted answer, just shorter.\n  # However, whereas they convert instances of String, etc. to the literal, we create a new instance\n  # (`return type object for type` -> `return new type object for type`). This also allows us to\n  # handle Dates in the same statement.\n  # TODO: Support all core objects in js: Array, Boolean, Date, Function, Math, Number, RegExp, and\n  #       String. Currently missing Function, Math, and RegExp.\n  deepClone: deepClone = (object) ->\n    return object if not object?\n\n    # normalizing primitives e.g. if someone did new String('aaa'), or new Number('444');\n    # boolean objects are very weird; explicitly case to force false values.\n    return new Boolean() if object instanceof Boolean && object.valueOf() == false\n    return new type object for type in [Date, Number, String, Boolean] when object instanceof type\n\n    # for arrays clone each element of it\n    return _(object).map deepClone if _(object).isArray()\n\n    # primitives like numbers, strings and stuff\n    return object if not _(object).isObject()\n\n    # if this is a DOM element\n    return object.cloneNode true if object.nodeType and _(object.cloneNode).isFunction()\n\n    # a class of some sort - we can't handle this, so we just return it\n    return object unless object.constructor is {}.constructor\n\n    # it is an object literal\n    mapValues object, deepClone\n\n  # like \"of\" operator except can recurse on keys with dot notation\n  deepHas: (obj, keys) ->\n    helper = (obj, keys) ->\n      if (keys.length is 0) or (not _.isObject obj)\n        false\n      else if keys.length is 1\n        _.first(keys) of obj\n      else\n        helper obj[_.first(keys)], _.rest(keys)\n    helper obj, if _.isArray keys then keys else keys.split('.')\n\n  deepOmit: (obj, keys) ->\n    unless isPlainObject obj\n      throw new Error \"deepOmit must be called on an object, not '#{obj}'\"\n    deepOmitOne = (obj, key) ->\n      helper = (obj, key_arr) ->\n        switch\n          when _.isEmpty key_arr then obj\n          when key_arr.length is 1 then _.omit obj, _.first key_arr\n          when not isPlainObject obj[_.first key_arr] then obj\n          else\n            _.extend {}, obj, _.object [_.first key_arr], [\n              helper obj[_.first key_arr], _.rest key_arr\n            ]\n      helper obj, key.split('.')\n    _.reduce keys, deepOmitOne, obj\n\n  deepPick: do ->\n    deepGet = (obj, key) ->\n      helper = (obj, key_arr) ->\n        if key_arr.length is 1\n          obj?[_.first key_arr]\n        else\n          helper obj[_.first key_arr], _.rest key_arr\n      helper obj, key.split('.')\n\n    (obj, keys) ->\n      unless isPlainObject obj\n        throw new Error \"deepPick must be called on an object, not '#{obj}'\"\n      flat_new_obj = _.reduce keys, (new_obj, key) ->\n        val = deepGet obj, key\n        new_obj[key] = val if val isnt undefined\n        new_obj\n      , {}\n      deepFromFlat flat_new_obj\n\n  deepDelete: deepDelete = (obj, key) ->\n    return if not key? or not obj?\n    key = key.split '.' if not _(key).isArray()\n    if key.length is 1\n      delete obj[key]\n      return\n    deepDelete obj[key[0]], key.slice(1, key.length)\n\n  # Like _.extend, except instead of overwriting all nested objects, it extends\n  # each leaf of `obj` with the value at the corresponding leaf of `ext`.\n  # Note: this function is pure - it returns a new object instead of mutating\n  # the original object. If you must have a mutative version, pass true as the\n  # third `mutate` parameter.\n  deepExtend: deepExtend = (obj, ext, mutate) ->\n    _.reduce ext, (acc, val, key) ->\n      acc[key] =\n        if (key of obj) and isPlainObject(obj[key]) and isPlainObject(val)\n        then deepExtend obj[key], val\n        else val\n      acc\n    , if mutate then obj else _.clone obj\n\n  isPlainObject: isPlainObject = (value) -> value?.constructor is {}.constructor\n\n  deepToFlat: (obj) ->\n    res = {}\n    recurse = (obj, current) ->\n      for key of obj\n        value = obj[key]\n        newKey = ((if current then current + \".\" + key else key)) # joined key with dot\n        if value and isPlainObject value\n          recurse value, newKey # it's a nested object, so do it again\n        else\n          res[newKey] = value # it's not an object, so set the property\n    recurse obj\n    res\n\n  # Takes an object with keys with dot.notation and deepens it into dot{notation:{}}\n  deepFromFlat: deepFromFlat = (o) ->\n    oo = {}\n    t = undefined\n    parts = undefined\n    part = undefined\n    for k of o\n      t = oo\n      parts = k.split(\".\")\n      key = parts.pop()\n      while parts.length\n        part = parts.shift()\n        t = t[part] = t[part] or {}\n      t[key] = o[k]\n    oo\n\n  # Takes an object and replaces each of its values with the result of a\n  # function applied to that value (and its key).\n  mapValues: mapValues = (obj, f_val) ->\n    unless isPlainObject obj\n      throw new Error \"mapValues must be called on an object, not '#{obj}'\"\n    _.object _.keys(obj), _.map(obj, f_val)\n\n  deepMapValues: deepMapValues = (obj, f) ->\n    unless isPlainObject obj\n      throw new Error \"deepMapValues must be called on an object, not '#{obj}'\"\n    mapValues obj, (v, k) ->\n      if isPlainObject v\n        deepMapValues v, (subv, subk) ->\n          f subv, \"#{k}.#{subk}\"\n      else\n        f v, k\n\n  # note that the function takes a key and optionally a value, not the usual\n  # mapping function pattern of taking a value and optionally a key\n  mapKeys: mapKeys = (obj, f_val) ->\n    unless isPlainObject obj\n      throw new Error \"mapKeys must be called on an object, not '#{obj}'\"\n    _.object _.map(obj, (v,k) -> f_val k,v), _.values obj\n"], "fixing_code": ["{\n  \"name\": \"underscore.deep\",\n  \"version\": \"0.5.3\",\n  \"lockfileVersion\": 1,\n  \"requires\": true,\n  \"dependencies\": {\n    \"coffee-script\": {\n      \"version\": \"1.6.3\",\n      \"resolved\": \"https://registry.npmjs.org/coffee-script/-/coffee-script-1.6.3.tgz\",\n      \"integrity\": \"sha512-lpusDYw9xym9ZOqFIeQuzzvTvunm2nlRL++BYhUcLn+77vuidExZG+qDPSKUfDXvuaHeFK6QavntXF+HiOq+/Q==\",\n      \"dev\": true\n    },\n    \"commander\": {\n      \"version\": \"2.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/commander/-/commander-2.3.0.tgz\",\n      \"integrity\": \"sha512-CD452fnk0jQyk3NfnK+KkR/hUPoHt5pVaKHogtyyv3N0U4QfAal9W0/rXLOg/vVZgQKa7jdtXypKs1YAip11uQ==\",\n      \"dev\": true\n    },\n    \"debug\": {\n      \"version\": \"2.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/debug/-/debug-2.2.0.tgz\",\n      \"integrity\": \"sha512-X0rGvJcskG1c3TgSCPqHJ0XJgwlcvOC7elJ5Y0hYuKBZoVqWpAMfLOeIh2UI/DCQ5ruodIjvsugZtjUYUw2pUw==\",\n      \"dev\": true,\n      \"requires\": {\n        \"ms\": \"0.7.1\"\n      }\n    },\n    \"diff\": {\n      \"version\": \"1.4.0\",\n      \"resolved\": \"https://registry.npmjs.org/diff/-/diff-1.4.0.tgz\",\n      \"integrity\": \"sha512-VzVc42hMZbYU9Sx/ltb7KYuQ6pqAw+cbFWVy4XKdkuEL2CFaRLGEnISPs7YdzaUGpi+CpIqvRmu7hPQ4T7EQ5w==\",\n      \"dev\": true\n    },\n    \"escape-string-regexp\": {\n      \"version\": \"1.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/escape-string-regexp/-/escape-string-regexp-1.0.2.tgz\",\n      \"integrity\": \"sha512-cQpUid7bdTUnFin8S7BnNdOk+/eDqQmKgCANSyd/jAhrKEvxUvr9VQ8XZzXiOtest8NLfk3FSBZzwvemZNQ6Vg==\",\n      \"dev\": true\n    },\n    \"glob\": {\n      \"version\": \"3.2.11\",\n      \"resolved\": \"https://registry.npmjs.org/glob/-/glob-3.2.11.tgz\",\n      \"integrity\": \"sha512-hVb0zwEZwC1FXSKRPFTeOtN7AArJcJlI6ULGLtrstaswKNlrTJqAA+1lYlSUop4vjA423xlBzqfVS3iWGlqJ+g==\",\n      \"dev\": true,\n      \"requires\": {\n        \"inherits\": \"2\",\n        \"minimatch\": \"0.3\"\n      }\n    },\n    \"growl\": {\n      \"version\": \"1.9.2\",\n      \"resolved\": \"https://registry.npmjs.org/growl/-/growl-1.9.2.tgz\",\n      \"integrity\": \"sha512-RTBwDHhNuOx4F0hqzItc/siXCasGfC4DeWcBamclWd+6jWtBaeB/SGbMkGf0eiQoW7ib8JpvOgnUsmgMHI3Mfw==\",\n      \"dev\": true\n    },\n    \"inherits\": {\n      \"version\": \"2.0.4\",\n      \"resolved\": \"https://registry.npmjs.org/inherits/-/inherits-2.0.4.tgz\",\n      \"integrity\": \"sha512-k/vGaX4/Yla3WzyMCvTQOXYeIHvqOKtnqBduzTHpzpQZzAskKMhZ2K+EnBiSM9zGSoIFeMpXKxa4dYeZIQqewQ==\",\n      \"dev\": true\n    },\n    \"jade\": {\n      \"version\": \"0.26.3\",\n      \"resolved\": \"https://registry.npmjs.org/jade/-/jade-0.26.3.tgz\",\n      \"integrity\": \"sha512-mkk3vzUHFjzKjpCXeu+IjXeZD+QOTjUUdubgmHtHTDwvAO2ZTkMTTVrapts5CWz3JvJryh/4KWZpjeZrCepZ3A==\",\n      \"dev\": true,\n      \"requires\": {\n        \"commander\": \"0.6.1\",\n        \"mkdirp\": \"0.3.0\"\n      },\n      \"dependencies\": {\n        \"commander\": {\n          \"version\": \"0.6.1\",\n          \"resolved\": \"https://registry.npmjs.org/commander/-/commander-0.6.1.tgz\",\n          \"integrity\": \"sha512-0fLycpl1UMTGX257hRsu/arL/cUbcvQM4zMKwvLvzXtfdezIV4yotPS2dYtknF+NmEfWSoCEF6+hj9XLm/6hEw==\",\n          \"dev\": true\n        },\n        \"mkdirp\": {\n          \"version\": \"0.3.0\",\n          \"resolved\": \"https://registry.npmjs.org/mkdirp/-/mkdirp-0.3.0.tgz\",\n          \"integrity\": \"sha512-OHsdUcVAQ6pOtg5JYWpCBo9W/GySVuwvP9hueRMW7UqshC0tbfzLv8wjySTPm3tfUZ/21CE9E1pJagOA91Pxew==\",\n          \"dev\": true\n        }\n      }\n    },\n    \"lru-cache\": {\n      \"version\": \"2.7.3\",\n      \"resolved\": \"https://registry.npmjs.org/lru-cache/-/lru-cache-2.7.3.tgz\",\n      \"integrity\": \"sha512-WpibWJ60c3AgAz8a2iYErDrcT2C7OmKnsWhIcHOjkUHFjkXncJhtLxNSqUmxRxRunpb5I8Vprd7aNSd2NtksJQ==\",\n      \"dev\": true\n    },\n    \"minimatch\": {\n      \"version\": \"0.3.0\",\n      \"resolved\": \"https://registry.npmjs.org/minimatch/-/minimatch-0.3.0.tgz\",\n      \"integrity\": \"sha512-WFX1jI1AaxNTZVOHLBVazwTWKaQjoykSzCBNXB72vDTCzopQGtyP91tKdFK5cv1+qMwPyiTu1HqUriqplI8pcA==\",\n      \"dev\": true,\n      \"requires\": {\n        \"lru-cache\": \"2\",\n        \"sigmund\": \"~1.0.0\"\n      }\n    },\n    \"minimist\": {\n      \"version\": \"0.0.8\",\n      \"resolved\": \"https://registry.npmjs.org/minimist/-/minimist-0.0.8.tgz\",\n      \"integrity\": \"sha512-miQKw5Hv4NS1Psg2517mV4e4dYNaO3++hjAvLOAzKqZ61rH8NS1SK+vbfBWZ5PY/Me/bEWhUwqMghEW5Fb9T7Q==\",\n      \"dev\": true\n    },\n    \"mkdirp\": {\n      \"version\": \"0.5.1\",\n      \"resolved\": \"https://registry.npmjs.org/mkdirp/-/mkdirp-0.5.1.tgz\",\n      \"integrity\": \"sha512-SknJC52obPfGQPnjIkXbmA6+5H15E+fR+E4iR2oQ3zzCLbd7/ONua69R/Gw7AgkTLsRG+r5fzksYwWe1AgTyWA==\",\n      \"dev\": true,\n      \"requires\": {\n        \"minimist\": \"0.0.8\"\n      }\n    },\n    \"mocha\": {\n      \"version\": \"2.5.3\",\n      \"resolved\": \"https://registry.npmjs.org/mocha/-/mocha-2.5.3.tgz\",\n      \"integrity\": \"sha512-jNt2iEk9FPmZLzL+sm4FNyOIDYXf2wUU6L4Cc8OIKK/kzgMHKPi4YhTZqG4bW4kQVdIv6wutDybRhXfdnujA1Q==\",\n      \"dev\": true,\n      \"requires\": {\n        \"commander\": \"2.3.0\",\n        \"debug\": \"2.2.0\",\n        \"diff\": \"1.4.0\",\n        \"escape-string-regexp\": \"1.0.2\",\n        \"glob\": \"3.2.11\",\n        \"growl\": \"1.9.2\",\n        \"jade\": \"0.26.3\",\n        \"mkdirp\": \"0.5.1\",\n        \"supports-color\": \"1.2.0\",\n        \"to-iso-string\": \"0.0.2\"\n      }\n    },\n    \"ms\": {\n      \"version\": \"0.7.1\",\n      \"resolved\": \"https://registry.npmjs.org/ms/-/ms-0.7.1.tgz\",\n      \"integrity\": \"sha512-lRLiIR9fSNpnP6TC4v8+4OU7oStC01esuNowdQ34L+Gk8e5Puoc88IqJ+XAY/B3Mn2ZKis8l8HX90oU8ivzUHg==\",\n      \"dev\": true\n    },\n    \"sigmund\": {\n      \"version\": \"1.0.1\",\n      \"resolved\": \"https://registry.npmjs.org/sigmund/-/sigmund-1.0.1.tgz\",\n      \"integrity\": \"sha512-fCvEXfh6NWpm+YSuY2bpXb/VIihqWA6hLsgboC+0nl71Q7N7o2eaCW8mJa/NLvQhs6jpd3VZV4UiUQlV6+lc8g==\",\n      \"dev\": true\n    },\n    \"supports-color\": {\n      \"version\": \"1.2.0\",\n      \"resolved\": \"https://registry.npmjs.org/supports-color/-/supports-color-1.2.0.tgz\",\n      \"integrity\": \"sha512-mS5xsnjTh5b7f2DM6bch6lR582UCOTphzINlZnDsfpIRrwI6r58rb6YSSGsdexkm8qw2bBVO2ID2fnJOTuLiPA==\",\n      \"dev\": true\n    },\n    \"to-iso-string\": {\n      \"version\": \"0.0.2\",\n      \"resolved\": \"https://registry.npmjs.org/to-iso-string/-/to-iso-string-0.0.2.tgz\",\n      \"integrity\": \"sha512-oeHLgfWA7d0CPQa6h0+i5DAJZISz5un0d5SHPkw+Untclcvzv9T+AC3CvGXlZJdOlIbxbTfyyzlqCXc5hjpXYg==\",\n      \"dev\": true\n    },\n    \"underscore\": {\n      \"version\": \"1.5.2\",\n      \"resolved\": \"https://registry.npmjs.org/underscore/-/underscore-1.5.2.tgz\",\n      \"integrity\": \"sha512-yejOFsRnTJs0N9CK5Apzf6maDO2djxGoLLrlZlvGs2o9ZQuhIhDL18rtFyy4FBIbOkzA6+4hDgXbgz5EvDQCXQ==\",\n      \"dev\": true\n    }\n  }\n}\n", "{\n  \"name\": \"underscore.deep\",\n  \"version\": \"0.5.3\",\n  \"description\": \"Underscore mixins for deeply nested objects\",\n  \"main\": \"underscore.deep.js\",\n  \"engines\": {\n    \"node\": \">=0.10.x\"\n  },\n  \"repository\": \"https://github.com/Clever/underscore.deep\",\n  \"scripts\": {\n    \"prepublish\": \"make\",\n    \"test\": \"make test\"\n  },\n  \"license\": \"BSD\",\n  \"peerDependencies\": {\n    \"underscore\": \"1.x\"\n  },\n  \"devDependencies\": {\n    \"coffee-script\": \"~1.6.3\",\n    \"mocha\": \"^2.5.3\",\n    \"underscore\": \"~1.5.2\"\n  },\n  \"publishConfig\": {\n    \"registry\": \"https://registry.npmjs.org\"\n  }\n}\n", "assert = require 'assert'\n_ = require('underscore')\n_.mixin require('../underscore.deep.js')\n\ndescribe '_.deepFromFlat', ->\n\n  tests = [\n    input:\n      \"a.b\":1\n      \"a.c\": 2\n      \"b\": 3\n      \"5.4.3.2.1\": 0\n    output:\n      5: 4: 3: 2: 1: 0\n      a:\n        b: 1\n        c: 2\n      b: 3\n  ]\n  _(tests).each (test) ->\n    it \"deepens #{JSON.stringify test.input}\", ->\n      assert.deepEqual _.deepFromFlat(test.input), test.output\n\n  it \"does not merge special `Object` properties\", ->\n    _.deepFromFlat({ \"__proto__.polluted1\": true })\n    _.deepFromFlat({ \"constructor.prototype.polluted2\": true })\n    p1 = {}.polluted1\n    p2 = {}.polluted2\n    assert.strictEqual(p1, undefined)\n    assert.strictEqual(p2, undefined)\n    delete Object.prototype.polluted1\n    delete Object.prototype.polluted2\n", "_ = require 'underscore'\n\nmodule.exports =\n\n  deepKeys: deepKeys = (obj) ->\n    throw new Error \"deepKeys must be called on an object, not '#{obj}'\" unless isPlainObject obj\n    # In the base case where obj is empty, _.map(obj, ...) will produce []\n    _.flatten _.map obj, (v, k) ->\n      if isPlainObject(v) and not _.isEmpty(v)\n        _.map deepKeys(v), (subkey) -> \"#{k}.#{subkey}\"\n      else\n        [k]\n\n  # http://stackoverflow.com/questions/4459928/how-to-deep-clone-in-javascript\n  # This is mostly the same as the accepted answer, just shorter.\n  # However, whereas they convert instances of String, etc. to the literal, we create a new instance\n  # (`return type object for type` -> `return new type object for type`). This also allows us to\n  # handle Dates in the same statement.\n  # TODO: Support all core objects in js: Array, Boolean, Date, Function, Math, Number, RegExp, and\n  #       String. Currently missing Function, Math, and RegExp.\n  deepClone: deepClone = (object) ->\n    return object if not object?\n\n    # normalizing primitives e.g. if someone did new String('aaa'), or new Number('444');\n    # boolean objects are very weird; explicitly case to force false values.\n    return new Boolean() if object instanceof Boolean && object.valueOf() == false\n    return new type object for type in [Date, Number, String, Boolean] when object instanceof type\n\n    # for arrays clone each element of it\n    return _(object).map deepClone if _(object).isArray()\n\n    # primitives like numbers, strings and stuff\n    return object if not _(object).isObject()\n\n    # if this is a DOM element\n    return object.cloneNode true if object.nodeType and _(object.cloneNode).isFunction()\n\n    # a class of some sort - we can't handle this, so we just return it\n    return object unless object.constructor is {}.constructor\n\n    # it is an object literal\n    mapValues object, deepClone\n\n  # like \"of\" operator except can recurse on keys with dot notation\n  deepHas: (obj, keys) ->\n    helper = (obj, keys) ->\n      if (keys.length is 0) or (not _.isObject obj)\n        false\n      else if keys.length is 1\n        _.first(keys) of obj\n      else\n        helper obj[_.first(keys)], _.rest(keys)\n    helper obj, if _.isArray keys then keys else keys.split('.')\n\n  deepOmit: (obj, keys) ->\n    unless isPlainObject obj\n      throw new Error \"deepOmit must be called on an object, not '#{obj}'\"\n    deepOmitOne = (obj, key) ->\n      helper = (obj, key_arr) ->\n        switch\n          when _.isEmpty key_arr then obj\n          when key_arr.length is 1 then _.omit obj, _.first key_arr\n          when not isPlainObject obj[_.first key_arr] then obj\n          else\n            _.extend {}, obj, _.object [_.first key_arr], [\n              helper obj[_.first key_arr], _.rest key_arr\n            ]\n      helper obj, key.split('.')\n    _.reduce keys, deepOmitOne, obj\n\n  deepPick: do ->\n    deepGet = (obj, key) ->\n      helper = (obj, key_arr) ->\n        if key_arr.length is 1\n          obj?[_.first key_arr]\n        else\n          helper obj[_.first key_arr], _.rest key_arr\n      helper obj, key.split('.')\n\n    (obj, keys) ->\n      unless isPlainObject obj\n        throw new Error \"deepPick must be called on an object, not '#{obj}'\"\n      flat_new_obj = _.reduce keys, (new_obj, key) ->\n        val = deepGet obj, key\n        new_obj[key] = val if val isnt undefined\n        new_obj\n      , {}\n      deepFromFlat flat_new_obj\n\n  deepDelete: deepDelete = (obj, key) ->\n    return if not key? or not obj?\n    key = key.split '.' if not _(key).isArray()\n    if key.length is 1\n      delete obj[key]\n      return\n    deepDelete obj[key[0]], key.slice(1, key.length)\n\n  # Like _.extend, except instead of overwriting all nested objects, it extends\n  # each leaf of `obj` with the value at the corresponding leaf of `ext`.\n  # Note: this function is pure - it returns a new object instead of mutating\n  # the original object. If you must have a mutative version, pass true as the\n  # third `mutate` parameter.\n  deepExtend: deepExtend = (obj, ext, mutate) ->\n    _.reduce ext, (acc, val, key) ->\n      acc[key] =\n        if (key of obj) and isPlainObject(obj[key]) and isPlainObject(val)\n        then deepExtend obj[key], val\n        else val\n      acc\n    , if mutate then obj else _.clone obj\n\n  isPlainObject: isPlainObject = (value) -> value?.constructor is {}.constructor\n\n  deepToFlat: (obj) ->\n    res = {}\n    recurse = (obj, current) ->\n      for key of obj\n        value = obj[key]\n        newKey = ((if current then current + \".\" + key else key)) # joined key with dot\n        if value and isPlainObject value\n          recurse value, newKey # it's a nested object, so do it again\n        else\n          res[newKey] = value # it's not an object, so set the property\n    recurse obj\n    res\n\n  # Takes an object with keys with dot.notation and deepens it into dot{notation:{}}\n  deepFromFlat: deepFromFlat = (o) ->\n    oo = {}\n    t = undefined\n    parts = undefined\n    part = undefined\n    for k of o\n      t = oo\n      parts = k.split(\".\")\n      key = parts.pop()\n      while parts.length\n        part = parts.shift()\n        continue if part in [\"__proto__\", \"constructor\", \"prototype\"]\n        t = t[part] = t[part] or {}\n      t[key] = o[k]\n    oo\n\n  # Takes an object and replaces each of its values with the result of a\n  # function applied to that value (and its key).\n  mapValues: mapValues = (obj, f_val) ->\n    unless isPlainObject obj\n      throw new Error \"mapValues must be called on an object, not '#{obj}'\"\n    _.object _.keys(obj), _.map(obj, f_val)\n\n  deepMapValues: deepMapValues = (obj, f) ->\n    unless isPlainObject obj\n      throw new Error \"deepMapValues must be called on an object, not '#{obj}'\"\n    mapValues obj, (v, k) ->\n      if isPlainObject v\n        deepMapValues v, (subv, subk) ->\n          f subv, \"#{k}.#{subk}\"\n      else\n        f v, k\n\n  # note that the function takes a key and optionally a value, not the usual\n  # mapping function pattern of taking a value and optionally a key\n  mapKeys: mapKeys = (obj, f_val) ->\n    unless isPlainObject obj\n      throw new Error \"mapKeys must be called on an object, not '#{obj}'\"\n    _.object _.map(obj, (v,k) -> f_val k,v), _.values obj\n"], "filenames": ["package-lock.json", "package.json", "test/deepFromFlat.coffee", "underscore.deep.coffee"], "buggy_code_start_loc": [3, 3, 22, 138], "buggy_code_end_loc": [4, 4, 22, 138], "fixing_code_start_loc": [3, 3, 23, 139], "fixing_code_end_loc": [4, 4, 33, 140], "type": "CWE-1321", "message": "Underscore.deep is a collection of Underscore mixins that operate on nested objects. Versions of `underscore.deep` prior to version 0.5.3 are vulnerable to a prototype pollution vulnerability. An attacker can craft a malicious payload and pass it to `deepFromFlat`, which would pollute any future Objects created. Any users that have `deepFromFlat` or `deepPick` (due to its dependency on `deepFromFlat`) in their code should upgrade to version 0.5.3 as soon as possible. Users unable to upgrade may mitigate this issue by modifying `deepFromFlat` to prevent specific keywords which will prevent this from happening.", "other": {"cve": {"id": "CVE-2022-31106", "sourceIdentifier": "security-advisories@github.com", "published": "2022-06-28T18:15:08.550", "lastModified": "2022-07-08T13:40:38.370", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Underscore.deep is a collection of Underscore mixins that operate on nested objects. Versions of `underscore.deep` prior to version 0.5.3 are vulnerable to a prototype pollution vulnerability. An attacker can craft a malicious payload and pass it to `deepFromFlat`, which would pollute any future Objects created. Any users that have `deepFromFlat` or `deepPick` (due to its dependency on `deepFromFlat`) in their code should upgrade to version 0.5.3 as soon as possible. Users unable to upgrade may mitigate this issue by modifying `deepFromFlat` to prevent specific keywords which will prevent this from happening."}, {"lang": "es", "value": "Underscore.deep es una colecci\u00f3n de mixins de Underscore que operan sobre objetos anidados. Las versiones de \"underscore.deep\" anteriores a 0.5.3 son susceptibles a una vulnerabilidad de contaminaci\u00f3n de prototipos. Un atacante puede dise\u00f1ar una carga maliciosa y pasarla a \"deepFromFlat\", lo que contaminar\u00eda cualquier objeto creado en el futuro. Cualquier usuario que tenga \"deepFromFlat\" o \"deepPick\" (debido a su dependencia de \"deepFromFlat\") en su c\u00f3digo deber\u00eda actualizar a versi\u00f3n 0.5.3 lo antes posible. Los usuarios que no puedan actualizarse pueden mitigar este problema al modificar \"deepFromFlat\" para evitar palabras clave espec\u00edficas que impidan que esto ocurra"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 8.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-1321"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1321"}, {"lang": "en", "value": "CWE-915"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:clever:underscore.deep:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "0.5.3", "matchCriteriaId": "7BAC5AEC-FFAB-4972-8835-48C19036EB78"}]}]}], "references": [{"url": "https://github.com/Clever/underscore.deep/commit/b5e109ad05b48371be225fa4d490dd08a94e8ef7", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/Clever/underscore.deep/security/advisories/GHSA-8j79-hfj5-f2xm", "source": "security-advisories@github.com", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/Clever/underscore.deep/commit/b5e109ad05b48371be225fa4d490dd08a94e8ef7"}}