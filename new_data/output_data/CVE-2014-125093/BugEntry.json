{"buggy_code": ["<?php\r\n/**\r\n * Plugin Name: Ad Blocking Detector\r\n * Plugin URI: http://adblockingdetector.jtmorris.net\r\n * Description: A plugin to detect ad blocking browser extensions and display alternative content to site visitors.\r\n * Version: 1.2.1\r\n * Author: John Morris\r\n * Author URI: http://jtmorris.net\r\n * License: GPL2\r\n */\r\n\r\n/*  Copyright 2013 - 2014  John Morris  (email : johntylermorris@jtmorris.net)\r\n\r\n    This program is free software; you can redistribute it and/or modify\r\n    it under the terms of the GNU General Public License, version 2, as \r\n    published by the Free Software Foundation.\r\n\r\n    This program is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\n    You should have received a copy of the GNU General Public License\r\n    along with this program; if not, write to the Free Software\r\n    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\r\n*/\r\n\r\n\r\ndefine ( 'ABD_ROOT_PATH', plugin_dir_path( __FILE__ ) );\r\ndefine ( 'ABD_ROOT_URL', plugin_dir_url( __FILE__ ) );\r\ndefine ( 'ABD_PLUGIN_FILE', ABD_ROOT_PATH . 'ad-blocking-detector.php' );\r\n\r\ninclude_once ( ABD_ROOT_PATH . 'includes/specify-admin-menus.php' );\r\ninclude_once ( ABD_ROOT_PATH . 'includes/admin-page.php' );\r\ninclude_once ( ABD_ROOT_PATH . 'includes/hooks.php' );\r\ninclude_once ( ABD_ROOT_PATH . 'includes/enqueue.php' );\r\ninclude_once ( ABD_ROOT_PATH . 'includes/ajax-actions.php' );\r\ninclude_once ( ABD_ROOT_PATH . 'includes/shortcodes.php' );\r\n\r\n\r\n//\tStart SESSION to facilitate data transfers\r\nif ( !session_id() ) {\r\n\tsession_start();\r\n}", "=== Ad Blocking Detector ===\r\nContributors: jtmorris\r\nDonate link: http://adblockingdetector.jtmorris.net/\r\nTags: adblock, adblocker, ad blocker, adblock plus, detector, advertisement\r\nRequires at least: 3.8\r\nTested up to: 3.9\r\nStable tag: 1.2.1\r\nLicense: GPLv2 or later\r\nLicense URI: http://www.gnu.org/licenses/gpl-2.0.html\r\n\r\nDon't let ad blocker wielding visitors see a blank space. This plugin will display alternative content if ad blocking is detected.\r\n\r\n== Description ==\r\n= Ad Blocking Detector =\r\nThis plugin allows you to specify two alternative sections of content.  One for normal visitors, \r\nand the other for visitors using common ad blocking software, such as the popular Adblock Plus.  Don't let\r\nthose ad blockers take away your revenue stream!\r\n\r\nThis plugin works by creating shortcodes which check for active ad blockers and displays the appropriate content \r\nyou specify.\r\n\r\nYou can use this to display different ads that don't get flagged by ad blockers, substitute other content like\r\nnewsletter signup forms, show pleas to disable ad blockers, and much more.\r\n\r\n\r\nAd Blocking Detector works with all popular web browsers, including mobile browsers, and all popular ad blocking browser extensions/add-ons.\r\n\r\n== Installation ==\r\n1. Upload the `adblock-detector` directory to your `wp-content/plugins` directory.\r\n1. Activate the plugin through the \"Plugins\" menu in your admin section.\r\n1. Visit the newly added \"Adblock\" menu in your admin section to get started.\r\n\r\n== Frequently Asked Questions ==\r\n= How can I use a shortcode in sidebar widget? =\r\nBy default, WordPress does not parse shortcodes in widgets.  You must enable that functionality manually.\r\nYou can find instructions from the folks at WPBeginner.com \r\n[here](http://www.wpbeginner.com/wp-tutorials/how-to-use-shortcodes-in-your-wordpress-sidebar-widgets/).\r\n\r\nThe short version is you must add the following code to your theme's *functions.php* file:\r\n`add_filter('widget_text', 'do_shortcode');`\r\n\r\nThis enables shortcode parsing in the \"text\" widget.\r\n\r\n\r\n= How does this plugin treat visitors with Javascript disabled? =\r\nAt this time, this plugin does not treat disabled Javascript as an ad blocker.  \r\nHowever, this plugin requires Javascript to *detect* ad blocking plugins.  If the visitor has Javascript\r\ndisabled, the plugin will not know whether the user has an ad blocker or not.\r\nTherefore, if Javascript is disabled, the plugin display the content used\r\nfor normal visitors with no ad blockers.\r\n\r\n\r\n= Does this plugin prevent visitors with an ad blocker from visiting my site or in any other way obscure the content? =\r\nNo.  In an indirect and inefficient way, you *can* obscure large portions of content from visitors using this plugin,\r\nbut that is not what it was designed to do.\r\n\r\n\r\n= Why doesn't this plugin detect the _______________ ad blocker? =\r\nNot all ad blockers operate the same way.  This plugin was tested with the most common ad blockers, but it is\r\npossible that some ad blockers use different techniques for disabling ads than we are detecting.  If you find an\r\nad blocker we aren't detecting, [contact us](http://adblockingdetector.jtmorris.net/contact/) and let us know the ad blocker, \r\nweb browser, and operating system you are using.  We will then investigate the problem.\r\n\r\n\r\n= Can this plugin integrate with ad rotation plugins? =\r\nThis plugin recognizes shortcodes.  Some ad rotation plugins, like the popular *[Ad Rotate](http://wordpress.org/plugins/adrotate/)* plugin\r\ndisplay collections of rotating ads using shortcodes.  You can use the shortcode generated by other plugins inside *Ad Block Detector*, allowing you\r\nto display rotating ads while harnessing the power of ad block detection.  You can find more information at the plugin's website: (http://adblockingdetector.jtmorris.net/display-rotating-ads/)\r\n\r\n\r\n== Screenshots ==\r\n1. Example of the administration backend.\r\n2. Example of behavior in a WordPress post with one of the sample shortcodes.\r\n\r\n\r\n== Changelog ==\r\n= 1.2.1 =\r\n* Add support for WordPress 3.9.\r\n= 1.2.0 =\r\n* Enabled shortcode processing in ad code. Now you can take advantage of other [plugin's capabilities](http://adblockingdetector.jtmorris.net/display-rotating-ads/) inside Ad Blocking Detector code.\r\n* Bug fixes.\r\n= 1.1.3 =\r\n* Bug fixes.\r\n= 1.1.1 =\r\n* Add screenshots and a banner image to the plugin listing.\r\n= 1.1.0 =\r\n* Add two new ad block detection methods\r\n* Fix broken detection in Firefox's Adblock Plus\r\n* Fix repeated ad block toggling problem\r\n* Several bug fixes and performance improvements\r\n= 1.0.2 =\r\n* Fix default shortcodes\r\n= 1.0 =\r\n* Prep for initial publishing on WordPress.org.\r\n* Fix a few links.\r\n= 0.2 =\r\n* Add content and formatting required to submit this plugin to WordPress.org's repository.\r\n= 0.1 =\r\n* Initial version. No changes to report.\r\n\r\n\r\n== Upgrade Notice ==\r\n= 1.2.0 =\r\nAdded a powerful new feature: shortcode support. Now you can [integrate content from other plugins](http://adblockingdetector.jtmorris.net/display-rotating-ads/) with Ad Blocking Detector.\r\n= 1.1.3 =\r\nBug fixes allowing for easier error debugging.\r\n= 1.1.0 =\r\nFixed detection of Firefox's Adblock Plus and added numerous bug fixes and performance improvements\r\n= 0.1 =\r\nBecause it's the awesome first version!"], "fixing_code": ["<?php\r\n/**\r\n * Plugin Name: Ad Blocking Detector\r\n * Plugin URI: http://adblockingdetector.jtmorris.net\r\n * Description: A plugin to detect ad blocking browser extensions and display alternative content to site visitors.\r\n * Version: 1.2.2\r\n * Author: John Morris\r\n * Author URI: http://jtmorris.net\r\n * License: GPL2\r\n */\r\n\r\n/*  Copyright 2013 - 2014  John Morris  (email : johntylermorris@jtmorris.net)\r\n\r\n    This program is free software; you can redistribute it and/or modify\r\n    it under the terms of the GNU General Public License, version 2, as \r\n    published by the Free Software Foundation.\r\n\r\n    This program is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\n    You should have received a copy of the GNU General Public License\r\n    along with this program; if not, write to the Free Software\r\n    Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA\r\n*/\r\n\r\n\r\ndefine ( 'ABD_ROOT_PATH', plugin_dir_path( __FILE__ ) );\r\ndefine ( 'ABD_ROOT_URL', plugin_dir_url( __FILE__ ) );\r\ndefine ( 'ABD_PLUGIN_FILE', ABD_ROOT_PATH . 'ad-blocking-detector.php' );\r\n\r\ninclude_once ( ABD_ROOT_PATH . 'includes/specify-admin-menus.php' );\r\ninclude_once ( ABD_ROOT_PATH . 'includes/admin-page.php' );\r\ninclude_once ( ABD_ROOT_PATH . 'includes/hooks.php' );\r\ninclude_once ( ABD_ROOT_PATH . 'includes/enqueue.php' );\r\ninclude_once ( ABD_ROOT_PATH . 'includes/ajax-actions.php' );\r\ninclude_once ( ABD_ROOT_PATH . 'includes/shortcodes.php' );\r\n\r\n\r\n//      Start SESSION to facilitate data transfers\r\n//      Error Prevention: http://www.php.net/manual/en/function.session-start.php#82957\r\nfunction my_session_start()\r\n{\r\n        if (isset($_COOKIE['PHPSESSID'])) {\r\n                $sessid = $_COOKIE['PHPSESSID'];\r\n        }\r\n        else if (isset($_GET['PHPSESSID'])) {\r\n                $sessid = $_GET['PHPSESSID'];\r\n        }\r\n        else {\r\n                session_start();\r\n                return false;\r\n        }\r\n\r\n        if (!preg_match('/^[a-z0-9]{32}$/', $sessid)) {\r\n                return false;\r\n        }\r\n        session_start();\r\n\r\n        return true;\r\n}\r\nmy_session_start();\r\n", "=== Ad Blocking Detector ===\r\nContributors: jtmorris\r\nDonate link: http://adblockingdetector.jtmorris.net/\r\nTags: adblock, adblocker, ad blocker, adblock plus, detector, advertisement\r\nRequires at least: 3.8\r\nTested up to: 3.9\r\nStable tag: 1.2.2\r\nLicense: GPLv2 or later\r\nLicense URI: http://www.gnu.org/licenses/gpl-2.0.html\r\n\r\nDon't let ad blocker wielding visitors see a blank space. This plugin will display alternative content if ad blocking is detected.\r\n\r\n== Description ==\r\n= Ad Blocking Detector =\r\nThis plugin allows you to specify two alternative sections of content.  One for normal visitors, \r\nand the other for visitors using common ad blocking software, such as the popular Adblock Plus.  Don't let\r\nthose ad blockers take away your revenue stream!\r\n\r\nThis plugin works by creating shortcodes which check for active ad blockers and displays the appropriate content \r\nyou specify.\r\n\r\nYou can use this to display different ads that don't get flagged by ad blockers, substitute other content like\r\nnewsletter signup forms, show pleas to disable ad blockers, and much more.\r\n\r\n\r\nAd Blocking Detector works with all popular web browsers, including mobile browsers, and all popular ad blocking browser extensions/add-ons.\r\n\r\n== Installation ==\r\n1. Upload the `adblock-detector` directory to your `wp-content/plugins` directory.\r\n1. Activate the plugin through the \"Plugins\" menu in your admin section.\r\n1. Visit the newly added \"Adblock\" menu in your admin section to get started.\r\n\r\n== Frequently Asked Questions ==\r\n= How can I use a shortcode in sidebar widget? =\r\nBy default, WordPress does not parse shortcodes in widgets.  You must enable that functionality manually.\r\nYou can find instructions from the folks at WPBeginner.com \r\n[here](http://www.wpbeginner.com/wp-tutorials/how-to-use-shortcodes-in-your-wordpress-sidebar-widgets/).\r\n\r\nThe short version is you must add the following code to your theme's *functions.php* file:\r\n`add_filter('widget_text', 'do_shortcode');`\r\n\r\nThis enables shortcode parsing in the \"text\" widget.\r\n\r\n\r\n= How does this plugin treat visitors with Javascript disabled? =\r\nAt this time, this plugin does not treat disabled Javascript as an ad blocker.  \r\nHowever, this plugin requires Javascript to *detect* ad blocking plugins.  If the visitor has Javascript\r\ndisabled, the plugin will not know whether the user has an ad blocker or not.\r\nTherefore, if Javascript is disabled, the plugin display the content used\r\nfor normal visitors with no ad blockers.\r\n\r\n\r\n= Does this plugin prevent visitors with an ad blocker from visiting my site or in any other way obscure the content? =\r\nNo.  In an indirect and inefficient way, you *can* obscure large portions of content from visitors using this plugin,\r\nbut that is not what it was designed to do.\r\n\r\n\r\n= Why doesn't this plugin detect the _______________ ad blocker? =\r\nNot all ad blockers operate the same way.  This plugin was tested with the most common ad blockers, but it is\r\npossible that some ad blockers use different techniques for disabling ads than we are detecting.  If you find an\r\nad blocker we aren't detecting, [contact us](http://adblockingdetector.jtmorris.net/contact/) and let us know the ad blocker, \r\nweb browser, and operating system you are using.  We will then investigate the problem.\r\n\r\n\r\n= Can this plugin integrate with ad rotation plugins? =\r\nThis plugin recognizes shortcodes.  Some ad rotation plugins, like the popular *[Ad Rotate](http://wordpress.org/plugins/adrotate/)* plugin\r\ndisplay collections of rotating ads using shortcodes.  You can use the shortcode generated by other plugins inside *Ad Block Detector*, allowing you\r\nto display rotating ads while harnessing the power of ad block detection.  You can find more information at the plugin's website: (http://adblockingdetector.jtmorris.net/display-rotating-ads/)\r\n\r\n\r\n== Screenshots ==\r\n1. Example of the administration backend.\r\n2. Example of behavior in a WordPress post with one of the sample shortcodes.\r\n\r\n\r\n== Changelog ==\r\n= 1.2.2 =\r\n* Fixed PHP warnings when PHPSESSID cookie contains illegal characters.\r\n= 1.2.1 =\r\n* Add support for WordPress 3.9.\r\n= 1.2.0 =\r\n* Enabled shortcode processing in ad code. Now you can take advantage of other [plugin's capabilities](http://adblockingdetector.jtmorris.net/display-rotating-ads/) inside Ad Blocking Detector code.\r\n* Bug fixes.\r\n= 1.1.3 =\r\n* Bug fixes.\r\n= 1.1.1 =\r\n* Add screenshots and a banner image to the plugin listing.\r\n= 1.1.0 =\r\n* Add two new ad block detection methods\r\n* Fix broken detection in Firefox's Adblock Plus\r\n* Fix repeated ad block toggling problem\r\n* Several bug fixes and performance improvements\r\n= 1.0.2 =\r\n* Fix default shortcodes\r\n= 1.0 =\r\n* Prep for initial publishing on WordPress.org.\r\n* Fix a few links.\r\n= 0.2 =\r\n* Add content and formatting required to submit this plugin to WordPress.org's repository.\r\n= 0.1 =\r\n* Initial version. No changes to report.\r\n\r\n\r\n== Upgrade Notice ==\r\n= 1.2.2 =\r\nSECURITY UPDATE: This update plugs a security hole that, in cicumstances, gave [Full Path Disclosure](https://www.owasp.org/index.php/Full_Path_Disclosure).\r\n= 1.2.0 =\r\nAdded a powerful new feature: shortcode support. Now you can [integrate content from other plugins](http://adblockingdetector.jtmorris.net/display-rotating-ads/) with Ad Blocking Detector.\r\n= 1.1.3 =\r\nBug fixes allowing for easier error debugging.\r\n= 1.1.0 =\r\nFixed detection of Firefox's Adblock Plus and added numerous bug fixes and performance improvements\r\n= 0.1 =\r\nBecause it's the awesome first version!"], "filenames": ["ad-blocking-detector.php", "readme.txt"], "buggy_code_start_loc": [6, 7], "buggy_code_end_loc": [45, 102], "fixing_code_start_loc": [6, 7], "fixing_code_end_loc": [64, 107], "type": "NVD-CWE-noinfo", "message": "A vulnerability has been found in Ad Blocking Detector Plugin up to 1.2.1 and classified as problematic. This vulnerability affects unknown code of the file ad-blocking-detector.php. The manipulation leads to information disclosure. The attack can be initiated remotely. Upgrading to version 1.2.2 is able to address this issue. The name of the patch is 3312b9cd79e5710d1e282fc9216a4e5ab31b3d94. It is recommended to upgrade the affected component. VDB-222610 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2014-125093", "sourceIdentifier": "cna@vuldb.com", "published": "2023-03-10T02:15:58.147", "lastModified": "2023-03-15T16:28:43.793", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability has been found in Ad Blocking Detector Plugin up to 1.2.1 and classified as problematic. This vulnerability affects unknown code of the file ad-blocking-detector.php. The manipulation leads to information disclosure. The attack can be initiated remotely. Upgrading to version 1.2.2 is able to address this issue. The name of the patch is 3312b9cd79e5710d1e282fc9216a4e5ab31b3d94. It is recommended to upgrade the affected component. VDB-222610 is the identifier assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:getadmiral:ad_blocking_detector:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "1.2.2", "matchCriteriaId": "E91A6BD7-38A8-4D58-A661-0981055E9644"}]}]}], "references": [{"url": "https://github.com/wp-plugins/ad-blocking-detector/commit/3312b9cd79e5710d1e282fc9216a4e5ab31b3d94", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://github.com/wp-plugins/ad-blocking-detector/releases/tag/1.2.2", "source": "cna@vuldb.com", "tags": ["Release Notes"]}, {"url": "https://vuldb.com/?ctiid.222610", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory", "VDB Entry"]}, {"url": "https://vuldb.com/?id.222610", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory", "VDB Entry"]}]}, "github_commit_url": "https://github.com/wp-plugins/ad-blocking-detector/commit/3312b9cd79e5710d1e282fc9216a4e5ab31b3d94"}}