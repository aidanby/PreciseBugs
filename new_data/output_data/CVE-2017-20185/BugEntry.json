{"buggy_code": ["<?php\n\n/*///////////////////////////////////////////////\n///                                           ///\n///     SWMP - Server Web Monitoring Page     ///\n///       By Fuzzy - thefuzz.xyz - 2016       ///\n///                                           ///\n/////////////////////////////////////////////////\n///                                           ///\n///    Credits, downloads and usage info:     ///\n///    https://github.com/fuzzymannerz/swmp   ///\n///                                           ///\n////////////////////////////////////////////////////////////\n///                                                      ///\n///    If you make use of SWMP please consider to        ///\n///    show some love via PayPal, Flattr or BTC. <3      ///\n///   (Details are on the GitHub page or my website.)    ///\n///                                                      ///\n//////////////////////////////////////////////////////////*/\n\n// ================  Load settings ================\n\n$config = require \"config.php\";\nif(file_exists('config.local.php')){\n    $config = array_merge($config,  require 'config.local.php');\n};\n\n//===================================================\n\nrequire 'php/system.php';\n\n$all_errors = array();\n\n// ================  Get system info ================\n\n$hostname = getSystemHostname($all_errors);\n$ip = getLanIp($all_errors);\n$cores = getCpuCoresNumber($all_errors);\n$os = getOperatingSystem($all_errors);\n$kernel = getKernel($all_errors);\n$uptime = getUptime($all_errors);\n$bootTime = getBootupTime($all_errors);\n\n$cpumodel      = getCpuModel($all_errors);\n$cpufrequency  = getCpuFrequency($all_errors);\n$cpucache      = getCpuCacheSize($all_errors);\n$cputemp       = getCpuTemperature($all_errors);\n\n$cpudata = getCpuLoadData($all_errors);\n\n$ramdata = getRamInfo($all_errors);\n\n\n$swap = getSwapData($all_errors);\n$network = getNetworkData($all_errors);\n$disk = getDiskData($all_errors);\n\n//===================================================\n\n// Limit shown errors to max 8\n\n$error_count = count($all_errors);\nif ($error_count > 8) {\n    $all_errors = array_slice($all_errors, 0, 7);\n    $all_errors[] = \"There were \" . ($error_count - 7) . \" more errors that are currently not shown\";\n}\n\n$wtitle = $config[\"window_title\"];\n$wtitle = str_replace(\"{hostname}\", $hostname, $wtitle);\n$wtitle = str_replace(\"{ip}\", $ip, $wtitle);\n$wtitle = str_replace(\"{os}\", $os, $wtitle);\n$wtitle = str_replace(\"{kernel}\", $kernel, $wtitle);\n\n//===================================================\n\n// Allow the user to specify the theme in the address\n\nif ($_GET['theme']) {\n    $config['theme'] = $_GET['theme'];\n}\n"], "fixing_code": ["<?php\n\n/*///////////////////////////////////////////////\n///                                           ///\n///     SWMP - Server Web Monitoring Page     ///\n///       By Fuzzy - thefuzz.xyz - 2016       ///\n///                                           ///\n/////////////////////////////////////////////////\n///                                           ///\n///    Credits, downloads and usage info:     ///\n///    https://github.com/fuzzymannerz/swmp   ///\n///                                           ///\n////////////////////////////////////////////////////////////\n///                                                      ///\n///    If you make use of SWMP please consider to        ///\n///    show some love via PayPal, Flattr or BTC. <3      ///\n///   (Details are on the GitHub page or my website.)    ///\n///                                                      ///\n//////////////////////////////////////////////////////////*/\n\n// ================  Load settings ================\n\n$config = require \"config.php\";\nif(file_exists('config.local.php')){\n    $config = array_merge($config,  require 'config.local.php');\n};\n\n//===================================================\n\nrequire 'php/system.php';\n\n$all_errors = array();\n\n// ================  Get system info ================\n\n$hostname = getSystemHostname($all_errors);\n$ip = getLanIp($all_errors);\n$cores = getCpuCoresNumber($all_errors);\n$os = getOperatingSystem($all_errors);\n$kernel = getKernel($all_errors);\n$uptime = getUptime($all_errors);\n$bootTime = getBootupTime($all_errors);\n\n$cpumodel      = getCpuModel($all_errors);\n$cpufrequency  = getCpuFrequency($all_errors);\n$cpucache      = getCpuCacheSize($all_errors);\n$cputemp       = getCpuTemperature($all_errors);\n\n$cpudata = getCpuLoadData($all_errors);\n\n$ramdata = getRamInfo($all_errors);\n\n$swap = getSwapData($all_errors);\n$network = getNetworkData($all_errors);\n$disk = getDiskData($all_errors);\n\n//===================================================\n\n// Limit shown errors to max 8\n\n$error_count = count($all_errors);\nif ($error_count > 8) {\n    $all_errors = array_slice($all_errors, 0, 7);\n    $all_errors[] = \"There were \" . ($error_count - 7) . \" more errors that are currently not shown\";\n}\n\n$wtitle = $config[\"window_title\"];\n$wtitle = str_replace(\"{hostname}\", $hostname, $wtitle);\n$wtitle = str_replace(\"{ip}\", $ip, $wtitle);\n$wtitle = str_replace(\"{os}\", $os, $wtitle);\n$wtitle = str_replace(\"{kernel}\", $kernel, $wtitle);\n\n//===================================================\n\n// Allow the user to specify the theme in the address\n\nif (isset($_GET['theme'])) {\n    $theme = basename($_GET['theme']);\n    \n    if(file_exists(\"css/themes/{$theme}.css\"))\n        $config['theme'] = $theme;\n}\n"], "filenames": ["php/swmp.php"], "buggy_code_start_loc": [53], "buggy_code_end_loc": [80], "fixing_code_start_loc": [52], "fixing_code_end_loc": [82], "type": "CWE-79", "message": "** UNSUPPORTED WHEN ASSIGNED ** A vulnerability was found in Fuzzy SWMP. It has been rated as problematic. This issue affects some unknown processing of the file swmp.php of the component GET Parameter Handler. The manipulation of the argument theme leads to cross site scripting. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. This product takes the approach of rolling releases to provide continious delivery. Therefore, version details for affected and updated releases are not available. The identifier of the patch is 792bcab637cb8c3bd251d8fc8771512c5329a93e. It is recommended to apply a patch to fix this issue. The identifier VDB-230669 was assigned to this vulnerability. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.", "other": {"cve": {"id": "CVE-2017-20185", "sourceIdentifier": "cna@vuldb.com", "published": "2023-06-06T02:15:09.473", "lastModified": "2024-02-29T01:20:30.007", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "** UNSUPPORTED WHEN ASSIGNED ** A vulnerability was found in Fuzzy SWMP. It has been rated as problematic. This issue affects some unknown processing of the file swmp.php of the component GET Parameter Handler. The manipulation of the argument theme leads to cross site scripting. The attack may be initiated remotely. The exploit has been disclosed to the public and may be used. This product takes the approach of rolling releases to provide continious delivery. Therefore, version details for affected and updated releases are not available. The identifier of the patch is 792bcab637cb8c3bd251d8fc8771512c5329a93e. It is recommended to apply a patch to fix this issue. The identifier VDB-230669 was assigned to this vulnerability. NOTE: This vulnerability only affects products that are no longer supported by the maintainer."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:server_web_monitor_page_project:server_web_monitor_page:*:*:*:*:*:*:*:*", "versionEndExcluding": "2017-05-26", "matchCriteriaId": "03C28F04-33E0-46EC-B0D5-861EB0851B9C"}]}]}], "references": [{"url": "https://github.com/fuzzymannerz/swmp/commit/792bcab637cb8c3bd251d8fc8771512c5329a93e", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://github.com/fuzzymannerz/swmp/pull/12", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.230669", "source": "cna@vuldb.com", "tags": ["Permissions Required"]}, {"url": "https://vuldb.com/?id.230669", "source": "cna@vuldb.com", "tags": ["Permissions Required"]}]}, "github_commit_url": "https://github.com/fuzzymannerz/swmp/commit/792bcab637cb8c3bd251d8fc8771512c5329a93e"}}