{"buggy_code": ["<?php\nrequire_once 'base.php';\nrequire_once W2P_BASE_DIR . '/includes/config.php';\nrequire_once W2P_BASE_DIR . '/includes/main_functions.php';\nrequire_once W2P_BASE_DIR . '/includes/db_adodb.php';\n\n$AppUI = new w2p_Core_CAppUI();\n\n$updatekey = w2PgetParam($_POST, 'updatekey', 0);\n$contact_id = (int) CContact::getContactByUpdatekey($updatekey);\n\nif (!$contact_id) {\n\techo $AppUI->_('You are not authorized to use this page. If you should be authorized please contact the sender to give you another valid link, thank you.');\n\texit;\n}\n\n$contact = new CContact();\nif (!$contact->bind($_POST)) {\n\t$msg = $AppUI->_('There was an error recording your contact data, please contact the system administrator. Thank you very much.');\n} else {\n\n    $result = $contact->store();\n\n    if (is_array($result)) {\n        $msg = $AppUI->_('There was an error recording your contact data, please contact the system administrator. Thank you very much.');\n    } else {\n        $contact->clearUpdateKey();\n\n        $msg = $AppUI->_('Your contact data has been recorded successfully. Your may now close your browser window.  Thank you very much, ' . $contact->contact_first_name);\n    }\n}\n?>\n<html>\n\t<body>\n\t\t<?php echo $msg; ?>\n\t</body>\n</html>", "<?php\nrequire_once 'base.php';\nrequire_once W2P_BASE_DIR . '/includes/config.php';\nrequire_once W2P_BASE_DIR . '/includes/main_functions.php';\nrequire_once W2P_BASE_DIR . '/includes/db_adodb.php';\n$AppUI = new w2p_Core_CAppUI();\n\n$updatekey = w2PgetParam($_GET, 'updatekey', 0);\n$contact_id = CContact::getContactByUpdatekey($updatekey);\n\n$company_id = intval(w2PgetParam($_REQUEST, 'company_id', 0));\n$company_name = w2PgetParam($_REQUEST, 'company_name', null);\n\n// check permissions for this record\n\nif (!$contact_id) {\n    echo ($AppUI->_('You are not authorized to use this page. If you should be authorized please contact') . ' ' . $w2Pconfig['company_name'] . ' ' . $AppUI->_('to give you another valid link, thank you.'));\n    exit;\n}\n\n// load the record data\n$msg = '';\n$row = new CContact();\n\nif (!$row->load($contact_id) && $contact_id > 0) {\n    $AppUI->setMsg('Contact');\n    $AppUI->setMsg('invalidID', UI_MSG_ERROR, true);\n    $AppUI->redirect();\n} else {\n    //TODO: replace with the proper canEdit()\n    if ($row->contact_private && $row->contact_owner != $AppUI->user_id && $row->contact_owner && $contact_id != 0) {\n        // check only owner can edit\n        $AppUI->redirect(ACCESS_DENIED);\n    }\n}\n$df = $AppUI->getPref('SHDATEFORMAT');\n$df .= ' ' . $AppUI->getPref('TIMEFORMAT');\n\n// setup the title block\n$ttl = $contact_id > 0 ? 'Edit Contact' : 'Add Contact';\n$company_detail = $row->getCompanyDetails();\n$dept_detail = $row->getDepartmentDetails();\nif ($contact_id == 0 && $company_id > 0) {\n    $company_detail['company_id'] = $company_id;\n    $company_detail['company_name'] = $company_name;\n    echo $company_name;\n}\n\n$uistyle = 'web2project';\n$outsider = $row->contact_display_name;\nrequire W2P_BASE_DIR . '/style/' . $uistyle . '/overrides.php';\nrequire W2P_BASE_DIR . '/style/' . $uistyle . '/header.php';\n\necho $AppUI->getTheme()->styleRenderBoxTop();\n?>\n\n<script language=\"javascript\">\nfunction submitIt() {\n    var form = document.changecontact;\n    if (form.contact_last_name.value.length < 1) {\n        alert( \"<?php echo $AppUI->_('contactsValidName', UI_OUTPUT_JS); ?>\" );\n        form.contact_last_name.focus();\n    } else {\n        form.submit();\n    }\n}\n\nfunction orderByName( x ){\n    var form = document.changecontact;\n    if (x == 'name') {\n        form.contact_order_by.value = form.contact_last_name.value + \", \" + form.contact_first_name.value;\n    } else {\n        form.contact_order_by.value = form.contact_company_name.value;\n    }\n}\n</script>\n<?php\n\n$form = new w2p_Output_HTML_FormHelper($AppUI);\n\n?>\n<form name=\"changecontact\" action=\"do_updatecontact.php\" method=\"post\" accept-charset=\"utf-8\">\n    <input type=\"hidden\" name=\"contact_project\" value=\"0\" />\n    <input type=\"hidden\" name=\"contact_unique_update\" value=\"<?php echo uniqid(''); ?>\" />\n    <input type=\"hidden\" name=\"updatekey\" value=\"<?php echo $updatekey; ?>\" />\n    <input type=\"hidden\" name=\"contact_id\" value=\"<?php echo $contact_id; ?>\" />\n    <input type=\"hidden\" name=\"contact_owner\" value=\"<?php echo $row->contact_owner ? $row->contact_owner : $AppUI->user_id; ?>\" />\n    <input type=\"hidden\" name=\"contact_company\" value=\"<?php echo $row->contact_company ? $row->contact_company : 0; ?>\" />\n    <input type=\"hidden\" name=\"contact_department\" value=\"<?php echo $row->contact_department ? $row->contact_department : 0; ?>\" />\n    <?php echo $form->addNonce(); ?>\n\n    <table border=\"0\" cellpadding=\"4\" cellspacing=\"0\" width=\"100%\" class=\"std\">\n        <tr>\n            <td colspan=\"2\">\n                <table border=\"0\" cellpadding=\"1\" cellspacing=\"1\">\n                    <tr>\n                        <td nowrap=\"nowrap\">\n                            <strong><?php echo $AppUI->_('Please Edit Your Contact Information Below:'); ?></strong>\n                        </td>\n                        <td>\n                            <input type=\"hidden\" class=\"text\" size=\"25\" name=\"contact_first_name\" value=\"<?php echo $row->contact_first_name; ?>\" maxlength=\"50\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <input type=\"hidden\" class=\"text\" size=\"25\" name=\"contact_last_name\" value=\"<?php echo $row->contact_last_name; ?>\" maxlength=\"50\" <?php if ($contact_id == 0) { ?> onblur=\"orderByName('name')\"<?php } ?> />\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n        <tr>\n            <td valign=\"top\" width=\"50%\">\n                <table border=\"0\" cellpadding=\"1\" cellspacing=\"1\" class=\"details\" width=\"100%\">\n                    <tr>\n                        <td align=\"right\" width=\"100\"><?php echo $AppUI->_('Job Title'); ?>:</td>\n                        <td nowrap=\"nowrap\">\n                            <input type=\"text\" class=\"text\" name=\"contact_job\" value=\"<?php echo $row->contact_job; ?>\" maxlength=\"100\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Title'); ?>:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_title\" value=\"<?php echo $row->contact_title; ?>\" maxlength=\"50\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Type'); ?>:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_type\" value=\"<?php echo $row->contact_type; ?>\" maxlength=\"50\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\" width=\"100\"><?php echo $AppUI->_('Address'); ?>1:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_address1\" value=\"<?php echo $row->contact_address1; ?>\" maxlength=\"60\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Address'); ?>2:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_address2\" value=\"<?php echo $row->contact_address2; ?>\" maxlength=\"60\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('City'); ?>:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_city\" value=\"<?php echo $row->contact_city; ?>\" maxlength=\"30\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('State'); ?>:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_state\" value=\"<?php echo $row->contact_state; ?>\" maxlength=\"30\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Postcode') . ' / ' . $AppUI->_('Zip'); ?>:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_zip\" value=\"<?php echo $row->contact_zip; ?>\" maxlength=\"11\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Country'); ?>:</td>\n                        <td>\n                            <?php\n                                $countries = array('' => $AppUI->_('(Select a Country)')) + w2PgetSysVal('GlobalCountries');\n                                echo arraySelect($countries, 'contact_country', 'size=\"1\" class=\"text\"', $row->contact_country ? $row->contact_country : 0);\n                            ?>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\" width=\"100\"><?php echo $AppUI->_('Work Phone'); ?>:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_phone\" value=\"<?php echo $row->contact_phone; ?>\" maxlength=\"30\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Home Phone'); ?>:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_phone2\" value=\"<?php echo $row->contact_phone2; ?>\" maxlength=\"30\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Fax'); ?>:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_fax\" value=\"<?php echo $row->contact_fax; ?>\" maxlength=\"30\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Mobile Phone'); ?>:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_mobile\" value=\"<?php echo $row->contact_mobile; ?>\" maxlength=\"30\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\" width=\"100\"><?php echo $AppUI->_('Email'); ?>:</td>\n                        <td nowrap=\"nowrap\">\n                            <input type=\"text\" class=\"text\" name=\"contact_email\" value=\"<?php echo $row->contact_email; ?>\" maxlength=\"255\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Email'); ?>2:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_email2\" value=\"<?php echo $row->contact_email2; ?>\" maxlength=\"255\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Home Page'); ?>2:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_url\" value=\"<?php echo $row->contact_url; ?>\" maxlength=\"255\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\">Jabber:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_jabber\" value=\"<?php echo $row->contact_jabber; ?>\" maxlength=\"255\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\">ICQ:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_icq\" value=\"<?php echo $row->contact_icq; ?>\" maxlength=\"20\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\">AOL:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_aol\" value=\"<?php echo $row->contact_aol; ?>\" maxlength=\"20\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\">MSN:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_msn\" value=\"<?php echo $row->contact_msn; ?>\" maxlength=\"255\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\">Yahoo:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_yahoo\" value=\"<?php echo $row->contact_yahoo; ?>\" maxlength=\"255\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Birthday'); ?>:</td>\n                        <td nowrap=\"nowrap\">\n                            <input type=\"text\" class=\"text\" name=\"contact_birthday\" value=\"<?php echo substr($row->contact_birthday, 0, 10); ?>\" maxlength=\"10\" size=\"25\" />(<?php echo $AppUI->_('yyyy-mm-dd'); ?>)\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\" colspan=\"3\">\n                            <?php\n                                $custom_fields = new w2p_Core_CustomFields('contacts', 'addedit', $row->contact_id, \"edit\", 1);\n                                $custom_fields->printHTML();\n                            ?>\n                        </td>\n                    </tr>\n                </table>\n            </td>\n            <td valign=\"top\" width=\"50%\">\n                <strong><?php echo $AppUI->_('Contact Notes'); ?></strong><br />\n                <textarea class=\"textarea\" name=\"contact_notes\" rows=\"20\" cols=\"40\"><?php echo $row->contact_notes; ?></textarea>\n            </td>\n        </tr>\n        <tr>\n            <td colspan=\"2\"></td>\n            <td align=\"right\">\n                <input type=\"button\" value=\"<?php echo $AppUI->_('submit'); ?>\" class=\"button\" onclick=\"submitIt()\" />\n            </td>\n        </tr>\n    </table>\n</form>\n<?php\nif (is_callable('styleRenderBoxBottom')) {\n    echo styleRenderBoxBottom();\n}"], "fixing_code": ["<?php\nrequire_once 'base.php';\nrequire_once W2P_BASE_DIR . '/includes/config.php';\nrequire_once W2P_BASE_DIR . '/includes/main_functions.php';\nrequire_once W2P_BASE_DIR . '/includes/db_adodb.php';\n\n$AppUI = new w2p_Core_CAppUI();\n\n$updatekey = w2PgetParam($_POST, 'updatekey', 0);\n$updatekey = preg_replace(\"/[^A-Za-z0-9]/\", \"\", $updatekey);\n$contact_id = (int) CContact::getContactByUpdatekey($updatekey);\n\nif (!$contact_id) {\n\techo $AppUI->_('You are not authorized to use this page. If you should be authorized please contact the sender to give you another valid link, thank you.');\n\texit;\n}\n\n$contact = new CContact();\nif (!$contact->bind($_POST)) {\n\t$msg = $AppUI->_('There was an error recording your contact data, please contact the system administrator. Thank you very much.');\n} else {\n\n    $result = $contact->store();\n\n    if (is_array($result)) {\n        $msg = $AppUI->_('There was an error recording your contact data, please contact the system administrator. Thank you very much.');\n    } else {\n        $contact->clearUpdateKey();\n\n        $msg = $AppUI->_('Your contact data has been recorded successfully. Your may now close your browser window.  Thank you very much, ' . $contact->contact_first_name);\n    }\n}\n?>\n<html>\n\t<body>\n\t\t<?php echo $msg; ?>\n\t</body>\n</html>", "<?php\nrequire_once 'base.php';\nrequire_once W2P_BASE_DIR . '/includes/config.php';\nrequire_once W2P_BASE_DIR . '/includes/main_functions.php';\nrequire_once W2P_BASE_DIR . '/includes/db_adodb.php';\n$AppUI = new w2p_Core_CAppUI();\n\n$updatekey = w2PgetParam($_GET, 'updatekey', 0);\n$updatekey = preg_replace(\"/[^A-Za-z0-9]/\", \"\", $updatekey);\n$contact_id = CContact::getContactByUpdatekey($updatekey);\n\n$company_id = intval(w2PgetParam($_REQUEST, 'company_id', 0));\n$company_name = w2PgetParam($_REQUEST, 'company_name', null);\n\n// check permissions for this record\n\nif (!$contact_id) {\n    echo ($AppUI->_('You are not authorized to use this page. If you should be authorized please contact') . ' ' . $w2Pconfig['company_name'] . ' ' . $AppUI->_('to give you another valid link, thank you.'));\n    exit;\n}\n\n// load the record data\n$msg = '';\n$row = new CContact();\n\nif (!$row->load($contact_id) && $contact_id > 0) {\n    $AppUI->setMsg('Contact');\n    $AppUI->setMsg('invalidID', UI_MSG_ERROR, true);\n    $AppUI->redirect();\n} else {\n    //TODO: replace with the proper canEdit()\n    if ($row->contact_private && $row->contact_owner != $AppUI->user_id && $row->contact_owner && $contact_id != 0) {\n        // check only owner can edit\n        $AppUI->redirect(ACCESS_DENIED);\n    }\n}\n$df = $AppUI->getPref('SHDATEFORMAT');\n$df .= ' ' . $AppUI->getPref('TIMEFORMAT');\n\n// setup the title block\n$ttl = $contact_id > 0 ? 'Edit Contact' : 'Add Contact';\n$company_detail = $row->getCompanyDetails();\n$dept_detail = $row->getDepartmentDetails();\nif ($contact_id == 0 && $company_id > 0) {\n    $company_detail['company_id'] = $company_id;\n    $company_detail['company_name'] = $company_name;\n    echo $company_name;\n}\n\n$uistyle = 'web2project';\n$outsider = $row->contact_display_name;\nrequire W2P_BASE_DIR . '/style/' . $uistyle . '/overrides.php';\nrequire W2P_BASE_DIR . '/style/' . $uistyle . '/header.php';\n\necho $AppUI->getTheme()->styleRenderBoxTop();\n?>\n\n<script language=\"javascript\">\nfunction submitIt() {\n    var form = document.changecontact;\n    if (form.contact_last_name.value.length < 1) {\n        alert( \"<?php echo $AppUI->_('contactsValidName', UI_OUTPUT_JS); ?>\" );\n        form.contact_last_name.focus();\n    } else {\n        form.submit();\n    }\n}\n\nfunction orderByName( x ){\n    var form = document.changecontact;\n    if (x == 'name') {\n        form.contact_order_by.value = form.contact_last_name.value + \", \" + form.contact_first_name.value;\n    } else {\n        form.contact_order_by.value = form.contact_company_name.value;\n    }\n}\n</script>\n<?php\n\n$form = new w2p_Output_HTML_FormHelper($AppUI);\n\n?>\n<form name=\"changecontact\" action=\"do_updatecontact.php\" method=\"post\" accept-charset=\"utf-8\">\n    <input type=\"hidden\" name=\"contact_project\" value=\"0\" />\n    <input type=\"hidden\" name=\"contact_unique_update\" value=\"<?php echo uniqid(''); ?>\" />\n    <input type=\"hidden\" name=\"updatekey\" value=\"<?php echo $updatekey; ?>\" />\n    <input type=\"hidden\" name=\"contact_id\" value=\"<?php echo $contact_id; ?>\" />\n    <input type=\"hidden\" name=\"contact_owner\" value=\"<?php echo $row->contact_owner ? $row->contact_owner : $AppUI->user_id; ?>\" />\n    <input type=\"hidden\" name=\"contact_company\" value=\"<?php echo $row->contact_company ? $row->contact_company : 0; ?>\" />\n    <input type=\"hidden\" name=\"contact_department\" value=\"<?php echo $row->contact_department ? $row->contact_department : 0; ?>\" />\n    <?php echo $form->addNonce(); ?>\n\n    <table border=\"0\" cellpadding=\"4\" cellspacing=\"0\" width=\"100%\" class=\"std\">\n        <tr>\n            <td colspan=\"2\">\n                <table border=\"0\" cellpadding=\"1\" cellspacing=\"1\">\n                    <tr>\n                        <td nowrap=\"nowrap\">\n                            <strong><?php echo $AppUI->_('Please Edit Your Contact Information Below:'); ?></strong>\n                        </td>\n                        <td>\n                            <input type=\"hidden\" class=\"text\" size=\"25\" name=\"contact_first_name\" value=\"<?php echo $row->contact_first_name; ?>\" maxlength=\"50\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <input type=\"hidden\" class=\"text\" size=\"25\" name=\"contact_last_name\" value=\"<?php echo $row->contact_last_name; ?>\" maxlength=\"50\" <?php if ($contact_id == 0) { ?> onblur=\"orderByName('name')\"<?php } ?> />\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n        <tr>\n            <td valign=\"top\" width=\"50%\">\n                <table border=\"0\" cellpadding=\"1\" cellspacing=\"1\" class=\"details\" width=\"100%\">\n                    <tr>\n                        <td align=\"right\" width=\"100\"><?php echo $AppUI->_('Job Title'); ?>:</td>\n                        <td nowrap=\"nowrap\">\n                            <input type=\"text\" class=\"text\" name=\"contact_job\" value=\"<?php echo $row->contact_job; ?>\" maxlength=\"100\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Title'); ?>:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_title\" value=\"<?php echo $row->contact_title; ?>\" maxlength=\"50\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Type'); ?>:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_type\" value=\"<?php echo $row->contact_type; ?>\" maxlength=\"50\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\" width=\"100\"><?php echo $AppUI->_('Address'); ?>1:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_address1\" value=\"<?php echo $row->contact_address1; ?>\" maxlength=\"60\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Address'); ?>2:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_address2\" value=\"<?php echo $row->contact_address2; ?>\" maxlength=\"60\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('City'); ?>:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_city\" value=\"<?php echo $row->contact_city; ?>\" maxlength=\"30\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('State'); ?>:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_state\" value=\"<?php echo $row->contact_state; ?>\" maxlength=\"30\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Postcode') . ' / ' . $AppUI->_('Zip'); ?>:</td>\n                        <td><input type=\"text\" class=\"text\" name=\"contact_zip\" value=\"<?php echo $row->contact_zip; ?>\" maxlength=\"11\" size=\"25\" /></td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Country'); ?>:</td>\n                        <td>\n                            <?php\n                                $countries = array('' => $AppUI->_('(Select a Country)')) + w2PgetSysVal('GlobalCountries');\n                                echo arraySelect($countries, 'contact_country', 'size=\"1\" class=\"text\"', $row->contact_country ? $row->contact_country : 0);\n                            ?>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\" width=\"100\"><?php echo $AppUI->_('Work Phone'); ?>:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_phone\" value=\"<?php echo $row->contact_phone; ?>\" maxlength=\"30\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Home Phone'); ?>:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_phone2\" value=\"<?php echo $row->contact_phone2; ?>\" maxlength=\"30\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Fax'); ?>:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_fax\" value=\"<?php echo $row->contact_fax; ?>\" maxlength=\"30\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Mobile Phone'); ?>:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_mobile\" value=\"<?php echo $row->contact_mobile; ?>\" maxlength=\"30\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\" width=\"100\"><?php echo $AppUI->_('Email'); ?>:</td>\n                        <td nowrap=\"nowrap\">\n                            <input type=\"text\" class=\"text\" name=\"contact_email\" value=\"<?php echo $row->contact_email; ?>\" maxlength=\"255\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Email'); ?>2:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_email2\" value=\"<?php echo $row->contact_email2; ?>\" maxlength=\"255\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Home Page'); ?>2:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_url\" value=\"<?php echo $row->contact_url; ?>\" maxlength=\"255\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\">Jabber:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_jabber\" value=\"<?php echo $row->contact_jabber; ?>\" maxlength=\"255\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\">ICQ:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_icq\" value=\"<?php echo $row->contact_icq; ?>\" maxlength=\"20\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\">AOL:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_aol\" value=\"<?php echo $row->contact_aol; ?>\" maxlength=\"20\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\">MSN:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_msn\" value=\"<?php echo $row->contact_msn; ?>\" maxlength=\"255\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\">Yahoo:</td>\n                        <td>\n                            <input type=\"text\" class=\"text\" name=\"contact_yahoo\" value=\"<?php echo $row->contact_yahoo; ?>\" maxlength=\"255\" size=\"25\" />\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\"><?php echo $AppUI->_('Birthday'); ?>:</td>\n                        <td nowrap=\"nowrap\">\n                            <input type=\"text\" class=\"text\" name=\"contact_birthday\" value=\"<?php echo substr($row->contact_birthday, 0, 10); ?>\" maxlength=\"10\" size=\"25\" />(<?php echo $AppUI->_('yyyy-mm-dd'); ?>)\n                        </td>\n                    </tr>\n                    <tr>\n                        <td align=\"right\" colspan=\"3\">\n                            <?php\n                                $custom_fields = new w2p_Core_CustomFields('contacts', 'addedit', $row->contact_id, \"edit\", 1);\n                                $custom_fields->printHTML();\n                            ?>\n                        </td>\n                    </tr>\n                </table>\n            </td>\n            <td valign=\"top\" width=\"50%\">\n                <strong><?php echo $AppUI->_('Contact Notes'); ?></strong><br />\n                <textarea class=\"textarea\" name=\"contact_notes\" rows=\"20\" cols=\"40\"><?php echo $row->contact_notes; ?></textarea>\n            </td>\n        </tr>\n        <tr>\n            <td colspan=\"2\"></td>\n            <td align=\"right\">\n                <input type=\"button\" value=\"<?php echo $AppUI->_('submit'); ?>\" class=\"button\" onclick=\"submitIt()\" />\n            </td>\n        </tr>\n    </table>\n</form>\n<?php\nif (is_callable('styleRenderBoxBottom')) {\n    echo styleRenderBoxBottom();\n}"], "filenames": ["do_updatecontact.php", "updatecontact.php"], "buggy_code_start_loc": [9, 8], "buggy_code_end_loc": [9, 8], "fixing_code_start_loc": [10, 9], "fixing_code_end_loc": [11, 10], "type": "CWE-89", "message": "Multiple SQL injection vulnerabilities in web2Project 3.1 and earlier allow remote authenticated users to execute arbitrary SQL commands via the (1) search_string parameter in the contacts module to index.php or allow remote attackers to execute arbitrary SQL commands via the updatekey parameter to (2) do_updatecontact.php or (3) updatecontact.php.", "other": {"cve": {"id": "CVE-2014-3119", "sourceIdentifier": "cve@mitre.org", "published": "2020-01-31T21:15:10.347", "lastModified": "2020-02-05T16:29:23.120", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Multiple SQL injection vulnerabilities in web2Project 3.1 and earlier allow remote authenticated users to execute arbitrary SQL commands via the (1) search_string parameter in the contacts module to index.php or allow remote attackers to execute arbitrary SQL commands via the updatekey parameter to (2) do_updatecontact.php or (3) updatecontact.php."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de inyecci\u00f3n SQL en web2Project versiones 3.1 y anteriores, permiten a usuarios autenticados remotos ejecutar comandos SQL arbitrarios por medio del (1) par\u00e1metro search_string en el m\u00f3dulo contacts en el archivo index.php o permitir a atacantes remotos ejecutar comandos SQL arbitrarios por medio del par\u00e1metro updatekey en (2) el archivo do_updatecontact.php o (3) updatecontact.php."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:web2project:web2project:*:*:*:*:*:*:*:*", "versionEndIncluding": "3.1", "matchCriteriaId": "B3791964-9F00-4860-96D3-8738A522697F"}]}]}], "references": [{"url": "https://github.com/web2project/web2project/commit/ab5ba92a6aaf0435cd0b2132cf7f9b7b41575a28", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/web2project/web2project/commit/eead99b36f62a8222d9f3a913f1a2268200687ef", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://www.htbridge.com/advisory/HTB23213", "source": "cve@mitre.org", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/web2project/web2project/commit/ab5ba92a6aaf0435cd0b2132cf7f9b7b41575a28"}}