{"buggy_code": ["<?php\n\ndefined('BASEPATH') OR exit('No direct script access allowed');\n\n/*\n  |--------------------------------------------------------------------------\n  | Base Site URL\n  |--------------------------------------------------------------------------\n  |\n  | URL to your CodeIgniter root. Typically this will be your base URL,\n  | WITH a trailing slash:\n  |\n  |\thttp://example.com/\n  |\n  | WARNING: You MUST set this value!\n  |\n  | If it is not set, then CodeIgniter will try guess the protocol and path\n  | your installation, but due to security concerns the hostname will be set\n  | to $_SERVER['SERVER_ADDR'] if available, or localhost otherwise.\n  | The auto-detection mechanism exists only for convenience during\n  | development and MUST NOT be used in production!\n  |\n  | If you need to allow multiple domains, remember that this file is still\n  | a PHP script and you can easily do that on your own.\n  |\n */\n$config['base_url'] = defined('BASE_URL')?BASE_URL:'';\n\n/*\n  |--------------------------------------------------------------------------\n  | Index File\n  |--------------------------------------------------------------------------\n  |\n  | Typically this will be your index.php file, unless you've renamed it to\n  | something else. If you are using mod_rewrite to remove the page set this\n  | variable so that it is blank.\n  |\n */\n$config['index_page'] = 'index.php';\n\n/*\n  |--------------------------------------------------------------------------\n  | URI PROTOCOL\n  |--------------------------------------------------------------------------\n  |\n  | This item determines which server global should be used to retrieve the\n  | URI string.  The default setting of 'REQUEST_URI' works for most servers.\n  | If your links do not seem to work, try one of the other delicious flavors:\n  |\n  | 'REQUEST_URI'    Uses $_SERVER['REQUEST_URI']\n  | 'QUERY_STRING'   Uses $_SERVER['QUERY_STRING']\n  | 'PATH_INFO'      Uses $_SERVER['PATH_INFO']\n  |\n  | WARNING: If you set this to 'PATH_INFO', URIs will always be URL-decoded!\n */\n$config['uri_protocol'] = 'REQUEST_URI';\n\n/*\n  |--------------------------------------------------------------------------\n  | URL suffix\n  |--------------------------------------------------------------------------\n  |\n  | This option allows you to add a suffix to all URLs generated by CodeIgniter.\n  | For more information please see the user guide:\n  |\n  | https://codeigniter.com/user_guide/general/urls.html\n */\n$config['url_suffix'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Send confirm link to email\n  |--------------------------------------------------------------------------\n */\n$config['send_confirm_link'] = TRUE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Admin history\n  |--------------------------------------------------------------------------\n  |\n  | When make it TRUE history in admin panel will work\n */\n$config['admin_history'] = false;\n\n/*\n  |--------------------------------------------------------------------------\n  | Default Language\n  |--------------------------------------------------------------------------\n  |\n  | This determines which set of language files should be used. Make sure\n  | there is an available translation if you intend to use something other\n  | than english.\n  | Must set currencyKey: BGN, USD or other.. Look in currency\n  | hepler for help.. :)\n  |\n */\n$config['language'] = 'english';\n$config['language_abbr'] = 'en';\n$config['currency'] = '\u20ac';\n$config['currencyKey'] = 'EUR';\n\n/*\n  |--------------------------------------------------------------------------\n  | Thumbnails\n  |--------------------------------------------------------------------------\n  |\n  | Thumbnails settings when upload images from administration\n  |\n */\n$config['thumb_width'] = 300;\n$config['thumb_height'] = 300;\n$config['allowed_img_types'] = 'gif|jpg|png|jpeg|JPG|PNG|JPEG';\n\n/*\n  |--------------------------------------------------------------------------\n  | Default array of non dynamic pages\n  |--------------------------------------------------------------------------\n  |\n  | Here must set pages that are not added from interface..\n  |\n */\n$config['no_dynamic_pages'] = array('blog');\n\n/*\n  |--------------------------------------------------------------------------\n  | Default Character Set\n  |--------------------------------------------------------------------------\n  |\n  | This determines which character set is used by default in various methods\n  | that require a character set to be provided.\n  |\n  | See http://php.net/htmlspecialchars for a list of supported charsets.\n  |\n */\n$config['charset'] = 'UTF-8';\n\n/*\n  |--------------------------------------------------------------------------\n  | Enable/Disable System Hooks\n  |--------------------------------------------------------------------------\n  |\n  | If you would like to use the 'hooks' feature you must enable it by\n  | setting this variable to TRUE (boolean).  See the user guide for details.\n  |\n */\n$config['enable_hooks'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Class Extension Prefix\n  |--------------------------------------------------------------------------\n  |\n  | This item allows you to set the filename/classname prefix when extending\n  | native libraries.  For more information please see the user guide:\n  |\n  | https://codeigniter.com/user_guide/general/core_classes.html\n  | https://codeigniter.com/user_guide/general/creating_libraries.html\n  |\n */\n$config['subclass_prefix'] = 'MY_';\n\n/*\n  |--------------------------------------------------------------------------\n  | Composer auto-loading\n  |--------------------------------------------------------------------------\n  |\n  | Enabling this setting will tell CodeIgniter to look for a Composer\n  | package auto-loader script in application/vendor/autoload.php.\n  |\n  |\t$config['composer_autoload'] = TRUE;\n  |\n  | Or if you have your vendor/ directory located somewhere else, you\n  | can opt to set a specific path as well:\n  |\n  |\t$config['composer_autoload'] = '/path/to/vendor/autoload.php';\n  |\n  | For more information about Composer, please visit http://getcomposer.org/\n  |\n  | Note: This will NOT disable or override the CodeIgniter-specific\n  |\tautoloading (application/config/autoload.php)\n */\n$config['composer_autoload'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Allowed URL Characters\n  |--------------------------------------------------------------------------\n  |\n  | This lets you specify which characters are permitted within your URLs.\n  | When someone tries to submit a URL with disallowed characters they will\n  | get a warning message.\n  |\n  | As a security measure you are STRONGLY encouraged to restrict URLs to\n  | as few characters as possible.  By default only these are allowed: a-z 0-9~%.:_-\n  |\n  | Leave blank to allow all characters -- but only if you are insane.\n  |\n  | The configured value is actually a regular expression character group\n  | and it will be executed as: ! preg_match('/^[<permitted_uri_chars>]+$/i\n  |\n  | DO NOT CHANGE THIS UNLESS YOU FULLY UNDERSTAND THE REPERCUSSIONS!!\n  |\n */\n$config['permitted_uri_chars'] = 'a-z 0-9~%.:_\\-';\n\n/*\n  |--------------------------------------------------------------------------\n  | Enable Query Strings\n  |--------------------------------------------------------------------------\n  |\n  | By default CodeIgniter uses search-engine friendly segment based URLs:\n  | example.com/who/what/where/\n  |\n  | By default CodeIgniter enables access to the $_GET array.  If for some\n  | reason you would like to disable it, set 'allow_get_array' to FALSE.\n  |\n  | You can optionally enable standard query string based URLs:\n  | example.com?who=me&what=something&where=here\n  |\n  | Options are: TRUE or FALSE (boolean)\n  |\n  | The other items let you set the query string 'words' that will\n  | invoke your controllers and its functions:\n  | example.com/index.php?c=controller&m=function\n  |\n  | Please note that some of the helpers won't work as expected when\n  | this feature is enabled, since CodeIgniter is designed primarily to\n  | use segment based URLs.\n  |\n */\n$config['allow_get_array'] = TRUE;\n$config['enable_query_strings'] = FALSE;\n$config['controller_trigger'] = 'c';\n$config['function_trigger'] = 'm';\n$config['directory_trigger'] = 'd';\n\n/*\n  |--------------------------------------------------------------------------\n  | Error Logging Threshold\n  |--------------------------------------------------------------------------\n  |\n  | You can enable error logging by setting a threshold over zero. The\n  | threshold determines what gets logged. Threshold options are:\n  |\n  |\t0 = Disables logging, Error logging TURNED OFF\n  |\t1 = Error Messages (including PHP errors)\n  |\t2 = Debug Messages\n  |\t3 = Informational Messages\n  |\t4 = All Messages\n  |\n  | You can also pass an array with threshold levels to show individual error types\n  |\n  | \tarray(2) = Debug Messages, without Error Messages\n  |\n  | For a live site you'll usually only enable Errors (1) to be logged otherwise\n  | your log files will fill up very fast.\n  |\n */\n$config['log_threshold'] = 1;\n\n/*\n  |--------------------------------------------------------------------------\n  | Error Logging Directory Path\n  |--------------------------------------------------------------------------\n  |\n  | Leave this BLANK unless you would like to set something other than the default\n  | application/logs/ directory. Use a full server path with trailing slash.\n  |\n */\n$config['log_path'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Log File Extension\n  |--------------------------------------------------------------------------\n  |\n  | The default filename extension for log files. The default 'php' allows for\n  | protecting the log files via basic scripting, when they are to be stored\n  | under a publicly accessible directory.\n  |\n  | Note: Leaving it blank will default to 'php'.\n  |\n */\n$config['log_file_extension'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Log File Permissions\n  |--------------------------------------------------------------------------\n  |\n  | The file system permissions to be applied on newly created log files.\n  |\n  | IMPORTANT: This MUST be an integer (no quotes) and you MUST use octal\n  |            integer notation (i.e. 0700, 0644, etc.)\n */\n$config['log_file_permissions'] = 0644;\n\n/*\n  |--------------------------------------------------------------------------\n  | Date Format for Logs\n  |--------------------------------------------------------------------------\n  |\n  | Each item that is logged has an associated date. You can use PHP date\n  | codes to set your own date formatting\n  |\n */\n$config['log_date_format'] = 'Y-m-d H:i:s';\n\n/*\n  |--------------------------------------------------------------------------\n  | Error Views Directory Path\n  |--------------------------------------------------------------------------\n  |\n  | Leave this BLANK unless you would like to set something other than the default\n  | application/views/errors/ directory.  Use a full server path with trailing slash.\n  |\n */\n$config['error_views_path'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Cache Directory Path\n  |--------------------------------------------------------------------------\n  |\n  | Leave this BLANK unless you would like to set something other than the default\n  | application/cache/ directory.  Use a full server path with trailing slash.\n  |\n */\n$config['cache_path'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Cache Include Query String\n  |--------------------------------------------------------------------------\n  |\n  | Whether to take the URL query string into consideration when generating\n  | output cache files. Valid options are:\n  |\n  |\tFALSE      = Disabled\n  |\tTRUE       = Enabled, take all query parameters into account.\n  |\t             Please be aware that this may result in numerous cache\n  |\t             files generated for the same page over and over again.\n  |\tarray('q') = Enabled, but only take into account the specified list\n  |\t             of query parameters.\n  |\n */\n$config['cache_query_string'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Encryption Key\n  |--------------------------------------------------------------------------\n  |\n  | If you use the Encryption class, you must set an encryption key.\n  | See the user guide for more info.\n  |\n  | https://codeigniter.com/user_guide/libraries/encryption.html\n  |\n */\n$config['encryption_key'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Session Variables\n  |--------------------------------------------------------------------------\n  |\n  | 'sess_driver'\n  |\n  |\tThe storage driver to use: files, database, redis, memcached\n  |\n  | 'sess_cookie_name'\n  |\n  |\tThe session cookie name, must contain only [0-9a-z_-] characters\n  |\n  | 'sess_expiration'\n  |\n  |\tThe number of SECONDS you want the session to last.\n  |\tSetting to 0 (zero) means expire when the browser is closed.\n  |\n  | 'sess_save_path'\n  |\n  |\tThe location to save sessions to, driver dependent.\n  |\n  |\tFor the 'files' driver, it's a path to a writable directory.\n  |\tWARNING: Only absolute paths are supported!\n  |\n  |\tFor the 'database' driver, it's a table name.\n  |\tPlease read up the manual for the format with other session drivers.\n  |\n  |\tIMPORTANT: You are REQUIRED to set a valid save path!\n  |\n  | 'sess_match_ip'\n  |\n  |\tWhether to match the user's IP address when reading the session data.\n  |\n  |\tWARNING: If you're using the database driver, don't forget to update\n  |\t         your session table's PRIMARY KEY when changing this setting.\n  |\n  | 'sess_time_to_update'\n  |\n  |\tHow many seconds between CI regenerating the session ID.\n  |\n  | 'sess_regenerate_destroy'\n  |\n  |\tWhether to destroy session data associated with the old session ID\n  |\twhen auto-regenerating the session ID. When set to FALSE, the data\n  |\twill be later deleted by the garbage collector.\n  |\n  | Other session cookie settings are shared with the rest of the application,\n  | except for 'cookie_prefix' and 'cookie_httponly', which are ignored here.\n  |\n */\n$config['sess_driver'] = 'files';\n$config['sess_cookie_name'] = 'ci_session';\n$config['sess_expiration'] = 7200;\n$config['sess_save_path'] = NULL;\n$config['sess_match_ip'] = FALSE;\n$config['sess_time_to_update'] = 300;\n$config['sess_regenerate_destroy'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Cookie Related Variables\n  |--------------------------------------------------------------------------\n  |\n  | 'cookie_prefix'   = Set a cookie name prefix if you need to avoid collisions\n  | 'cookie_domain'   = Set to .your-domain.com for site-wide cookies\n  | 'cookie_path'     = Typically will be a forward slash\n  | 'cookie_secure'   = Cookie will only be set if a secure HTTPS connection exists.\n  | 'cookie_httponly' = Cookie will only be accessible via HTTP(S) (no javascript)\n  |\n  | Note: These settings (with the exception of 'cookie_prefix' and\n  |       'cookie_httponly') will also affect sessions.\n  |\n */\n$config['cookie_prefix'] = '';\n$config['cookie_domain'] = '';\n$config['cookie_path'] = '/';\n$config['cookie_secure'] = FALSE;\n$config['cookie_httponly'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Standardize newlines\n  |--------------------------------------------------------------------------\n  |\n  | Determines whether to standardize newline characters in input data,\n  | meaning to replace \\r\\n, \\r, \\n occurrences with the PHP_EOL value.\n  |\n  | This is particularly useful for portability between UNIX-based OSes,\n  | (usually \\n) and Windows (\\r\\n).\n  |\n */\n$config['standardize_newlines'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Global XSS Filtering\n  |--------------------------------------------------------------------------\n  |\n  | Determines whether the XSS filter is always active when GET, POST or\n  | COOKIE data is encountered\n  |\n  | WARNING: This feature is DEPRECATED and currently available only\n  |          for backwards compatibility purposes!\n  |\n */\n$config['global_xss_filtering'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Cross Site Request Forgery\n  |--------------------------------------------------------------------------\n  | Enables a CSRF cookie token to be set. When set to TRUE, token will be\n  | checked on a submitted form. If you are accepting user data, it is strongly\n  | recommended CSRF protection be enabled.\n  |\n  | 'csrf_token_name' = The token name\n  | 'csrf_cookie_name' = The cookie name\n  | 'csrf_expire' = The number in seconds the token should expire.\n  | 'csrf_regenerate' = Regenerate token on every submission\n  | 'csrf_exclude_uris' = Array of URIs which ignore CSRF checks\n */\n$config['csrf_protection'] = FALSE;\n$config['csrf_token_name'] = 'csrf_test_name';\n$config['csrf_cookie_name'] = 'csrf_cookie_name';\n$config['csrf_expire'] = 7200;\n$config['csrf_regenerate'] = TRUE;\n$config['csrf_exclude_uris'] = array();\n\n/*\n  |--------------------------------------------------------------------------\n  | Output Compression\n  |--------------------------------------------------------------------------\n  |\n  | Enables Gzip output compression for faster page loads.  When enabled,\n  | the output class will test whether your server supports Gzip.\n  | Even if it does, however, not all browsers support compression\n  | so enable only if you are reasonably sure your visitors can handle it.\n  |\n  | Only used if zlib.output_compression is turned off in your php.ini.\n  | Please do not use it together with httpd-level output compression.\n  |\n  | VERY IMPORTANT:  If you are getting a blank page when compression is enabled it\n  | means you are prematurely outputting something to your browser. It could\n  | even be a line of whitespace at the end of one of your scripts.  For\n  | compression to work, nothing can be sent before the output buffer is called\n  | by the output class.  Do not 'echo' any values with compression enabled.\n  |\n */\n$config['compress_output'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Master Time Reference\n  |--------------------------------------------------------------------------\n  |\n  | Options are 'local' or any PHP supported timezone. This preference tells\n  | the system whether to use your server's local time as the master 'now'\n  | reference, or convert it to the configured one timezone. See the 'date\n  | helper' page of the user guide for information regarding date handling.\n  |\n */\n$config['time_reference'] = 'local';\n\n/*\n  |--------------------------------------------------------------------------\n  | Rewrite PHP Short Tags\n  |--------------------------------------------------------------------------\n  |\n  | If your PHP installation does not have short tag support enabled CI\n  | can rewrite the tags on-the-fly, enabling you to utilize that syntax\n  | in your view files.  Options are TRUE or FALSE (boolean)\n  |\n  | Note: You need to have eval() enabled for this to work.\n  |\n */\n$config['rewrite_short_tags'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Reverse Proxy IPs\n  |--------------------------------------------------------------------------\n  |\n  | If your server is behind a reverse proxy, you must whitelist the proxy\n  | IP addresses from which CodeIgniter should trust headers such as\n  | HTTP_X_FORWARDED_FOR and HTTP_CLIENT_IP in order to properly identify\n  | the visitor's IP address.\n  |\n  | You can use both an array or a comma-separated list of proxy addresses,\n  | as well as specifying whole subnets. Here are a few examples:\n  |\n  | Comma-separated:\t'10.0.1.200,192.168.5.0/24'\n  | Array:\t\tarray('10.0.1.200', '192.168.5.0/24')\n */\n$config['proxy_ips'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Site Template Name That Will Be Loaded\n  |--------------------------------------------------------------------------\n  |\n  | By default is redlabel.\n  |\n */\n$config['template'] = 'redlabel';\n", "<script src=\"<?= base_url('assets/ckeditor/ckeditor.js') ?>\"></script>\n<h1><img src=\"<?= base_url('assets/imgs/blogger.png') ?>\" class=\"header-img\" style=\"margin-top:-2px;\"> Publish post</h1>\n<hr>\n<div class=\"row\">\n    <div class=\"col-sm-8 col-md-7\">\n        <?php if (validation_errors()) { ?>\n            <hr>\n            <div class=\"alert alert-danger\"><?= validation_errors() ?></div>\n            <hr>\n        <?php }\n        ?>\n        <?php if ($this->session->flashdata('result_publish')) { ?>\n            <hr>\n            <div class=\"alert alert-danger\"><?= $this->session->flashdata('result_publish'); ?></div>\n            <hr>\n        <?php }\n        ?>\n        <form method=\"POST\" enctype=\"multipart/form-data\">\n            <?php foreach ($languages as $language) { ?>\n                <input type=\"hidden\" name=\"translations[]\" value=\"<?= $language->abbr ?>\">\n            <?php } foreach ($languages as $language) { ?>\n                <div class=\"form-group\"> \n                    <label>Title (<?= $language->name ?><img src=\"<?= base_url('attachments/lang_flags/' . $language->flag) ?>\" alt=\"\">)</label>\n                    <input type=\"text\" name=\"title[]\" value=\"<?= $trans_load != null && isset($trans_load[$language->abbr]['title']) ? $trans_load[$language->abbr]['title'] : '' ?>\" class=\"form-control\">\n                </div>\n                <?php\n            } $i = 0;\n            foreach ($languages as $language) {\n                ?>\n                <div class=\"form-group\">\n                    <label for=\"description<?= $i ?>\">Description (<?= $language->name ?><img src=\"<?= base_url('attachments/lang_flags/' . $language->flag) ?>\" alt=\"\">)</label>\n                    <textarea name=\"description[]\" id=\"description<?= $i ?>\" rows=\"50\" class=\"form-control\"><?= $trans_load != null && isset($trans_load[$language->abbr]['description']) ? $trans_load[$language->abbr]['description'] : '' ?></textarea>\n                    <script>\n                        CKEDITOR.replace('description<?= $i ?>');\n                        CKEDITOR.config.entities = false;\n                    </script>\n                </div>\n                <?php\n                $i++;\n            }\n            ?>\n            <div class=\"form-group\">\n                <?php if (isset($_POST['image'])) { ?>\n                    <input type=\"hidden\" name=\"old_image\" value=\"<?= htmlspecialchars($_POST['image']) ?>\">\n                    <div><img class=\"img-responsive\" src=\"<?= base_url('attachments/blog_images/' . $_POST['image']) ?>\"></div>\n                    <label for=\"userfile\">Choose another image:</label>\n                <?php } else { ?>\n                    <label for=\"userfile\">Upload image:</label>\n                <?php } ?>\n                <input type=\"file\" id=\"userfile\" name=\"userfile\">\n            </div>\n            <button type=\"submit\" name=\"submit\" class=\"btn btn-default\">Publish</button>\n            <?php if ($id > 0) { ?>\n                <a href=\"<?= base_url('admin/blog') ?>\" class=\"btn btn-info\">Cancel</a>\n            <?php } ?>\n        </form>\n    </div>\n</div>"], "fixing_code": ["<?php\n\ndefined('BASEPATH') OR exit('No direct script access allowed');\n\n/*\n  |--------------------------------------------------------------------------\n  | Base Site URL\n  |--------------------------------------------------------------------------\n  |\n  | URL to your CodeIgniter root. Typically this will be your base URL,\n  | WITH a trailing slash:\n  |\n  |\thttp://example.com/\n  |\n  | WARNING: You MUST set this value!\n  |\n  | If it is not set, then CodeIgniter will try guess the protocol and path\n  | your installation, but due to security concerns the hostname will be set\n  | to $_SERVER['SERVER_ADDR'] if available, or localhost otherwise.\n  | The auto-detection mechanism exists only for convenience during\n  | development and MUST NOT be used in production!\n  |\n  | If you need to allow multiple domains, remember that this file is still\n  | a PHP script and you can easily do that on your own.\n  |\n */\n$config['base_url'] = defined('BASE_URL')?BASE_URL:'';\n\n/*\n  |--------------------------------------------------------------------------\n  | Index File\n  |--------------------------------------------------------------------------\n  |\n  | Typically this will be your index.php file, unless you've renamed it to\n  | something else. If you are using mod_rewrite to remove the page set this\n  | variable so that it is blank.\n  |\n */\n$config['index_page'] = 'index.php';\n\n/*\n  |--------------------------------------------------------------------------\n  | URI PROTOCOL\n  |--------------------------------------------------------------------------\n  |\n  | This item determines which server global should be used to retrieve the\n  | URI string.  The default setting of 'REQUEST_URI' works for most servers.\n  | If your links do not seem to work, try one of the other delicious flavors:\n  |\n  | 'REQUEST_URI'    Uses $_SERVER['REQUEST_URI']\n  | 'QUERY_STRING'   Uses $_SERVER['QUERY_STRING']\n  | 'PATH_INFO'      Uses $_SERVER['PATH_INFO']\n  |\n  | WARNING: If you set this to 'PATH_INFO', URIs will always be URL-decoded!\n */\n$config['uri_protocol'] = 'REQUEST_URI';\n\n/*\n  |--------------------------------------------------------------------------\n  | URL suffix\n  |--------------------------------------------------------------------------\n  |\n  | This option allows you to add a suffix to all URLs generated by CodeIgniter.\n  | For more information please see the user guide:\n  |\n  | https://codeigniter.com/user_guide/general/urls.html\n */\n$config['url_suffix'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Send confirm link to email\n  |--------------------------------------------------------------------------\n */\n$config['send_confirm_link'] = TRUE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Admin history\n  |--------------------------------------------------------------------------\n  |\n  | When make it TRUE history in admin panel will work\n */\n$config['admin_history'] = false;\n\n/*\n  |--------------------------------------------------------------------------\n  | Default Language\n  |--------------------------------------------------------------------------\n  |\n  | This determines which set of language files should be used. Make sure\n  | there is an available translation if you intend to use something other\n  | than english.\n  | Must set currencyKey: BGN, USD or other.. Look in currency\n  | hepler for help.. :)\n  |\n */\n$config['language'] = 'english';\n$config['language_abbr'] = 'en';\n$config['currency'] = '\u20ac';\n$config['currencyKey'] = 'EUR';\n\n/*\n  |--------------------------------------------------------------------------\n  | Thumbnails\n  |--------------------------------------------------------------------------\n  |\n  | Thumbnails settings when upload images from administration\n  |\n */\n$config['thumb_width'] = 300;\n$config['thumb_height'] = 300;\n$config['allowed_img_types'] = 'gif|jpg|png|jpeg|JPG|PNG|JPEG';\n\n/*\n  |--------------------------------------------------------------------------\n  | Default array of non dynamic pages\n  |--------------------------------------------------------------------------\n  |\n  | Here must set pages that are not added from interface..\n  |\n */\n$config['no_dynamic_pages'] = array('blog');\n\n/*\n  |--------------------------------------------------------------------------\n  | Default Character Set\n  |--------------------------------------------------------------------------\n  |\n  | This determines which character set is used by default in various methods\n  | that require a character set to be provided.\n  |\n  | See http://php.net/htmlspecialchars for a list of supported charsets.\n  |\n */\n$config['charset'] = 'UTF-8';\n\n/*\n  |--------------------------------------------------------------------------\n  | Enable/Disable System Hooks\n  |--------------------------------------------------------------------------\n  |\n  | If you would like to use the 'hooks' feature you must enable it by\n  | setting this variable to TRUE (boolean).  See the user guide for details.\n  |\n */\n$config['enable_hooks'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Class Extension Prefix\n  |--------------------------------------------------------------------------\n  |\n  | This item allows you to set the filename/classname prefix when extending\n  | native libraries.  For more information please see the user guide:\n  |\n  | https://codeigniter.com/user_guide/general/core_classes.html\n  | https://codeigniter.com/user_guide/general/creating_libraries.html\n  |\n */\n$config['subclass_prefix'] = 'MY_';\n\n/*\n  |--------------------------------------------------------------------------\n  | Composer auto-loading\n  |--------------------------------------------------------------------------\n  |\n  | Enabling this setting will tell CodeIgniter to look for a Composer\n  | package auto-loader script in application/vendor/autoload.php.\n  |\n  |\t$config['composer_autoload'] = TRUE;\n  |\n  | Or if you have your vendor/ directory located somewhere else, you\n  | can opt to set a specific path as well:\n  |\n  |\t$config['composer_autoload'] = '/path/to/vendor/autoload.php';\n  |\n  | For more information about Composer, please visit http://getcomposer.org/\n  |\n  | Note: This will NOT disable or override the CodeIgniter-specific\n  |\tautoloading (application/config/autoload.php)\n */\n$config['composer_autoload'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Allowed URL Characters\n  |--------------------------------------------------------------------------\n  |\n  | This lets you specify which characters are permitted within your URLs.\n  | When someone tries to submit a URL with disallowed characters they will\n  | get a warning message.\n  |\n  | As a security measure you are STRONGLY encouraged to restrict URLs to\n  | as few characters as possible.  By default only these are allowed: a-z 0-9~%.:_-\n  |\n  | Leave blank to allow all characters -- but only if you are insane.\n  |\n  | The configured value is actually a regular expression character group\n  | and it will be executed as: ! preg_match('/^[<permitted_uri_chars>]+$/i\n  |\n  | DO NOT CHANGE THIS UNLESS YOU FULLY UNDERSTAND THE REPERCUSSIONS!!\n  |\n */\n$config['permitted_uri_chars'] = 'a-z 0-9~%.:_\\-';\n\n/*\n  |--------------------------------------------------------------------------\n  | Enable Query Strings\n  |--------------------------------------------------------------------------\n  |\n  | By default CodeIgniter uses search-engine friendly segment based URLs:\n  | example.com/who/what/where/\n  |\n  | By default CodeIgniter enables access to the $_GET array.  If for some\n  | reason you would like to disable it, set 'allow_get_array' to FALSE.\n  |\n  | You can optionally enable standard query string based URLs:\n  | example.com?who=me&what=something&where=here\n  |\n  | Options are: TRUE or FALSE (boolean)\n  |\n  | The other items let you set the query string 'words' that will\n  | invoke your controllers and its functions:\n  | example.com/index.php?c=controller&m=function\n  |\n  | Please note that some of the helpers won't work as expected when\n  | this feature is enabled, since CodeIgniter is designed primarily to\n  | use segment based URLs.\n  |\n */\n$config['allow_get_array'] = TRUE;\n$config['enable_query_strings'] = FALSE;\n$config['controller_trigger'] = 'c';\n$config['function_trigger'] = 'm';\n$config['directory_trigger'] = 'd';\n\n/*\n  |--------------------------------------------------------------------------\n  | Error Logging Threshold\n  |--------------------------------------------------------------------------\n  |\n  | You can enable error logging by setting a threshold over zero. The\n  | threshold determines what gets logged. Threshold options are:\n  |\n  |\t0 = Disables logging, Error logging TURNED OFF\n  |\t1 = Error Messages (including PHP errors)\n  |\t2 = Debug Messages\n  |\t3 = Informational Messages\n  |\t4 = All Messages\n  |\n  | You can also pass an array with threshold levels to show individual error types\n  |\n  | \tarray(2) = Debug Messages, without Error Messages\n  |\n  | For a live site you'll usually only enable Errors (1) to be logged otherwise\n  | your log files will fill up very fast.\n  |\n */\n$config['log_threshold'] = 1;\n\n/*\n  |--------------------------------------------------------------------------\n  | Error Logging Directory Path\n  |--------------------------------------------------------------------------\n  |\n  | Leave this BLANK unless you would like to set something other than the default\n  | application/logs/ directory. Use a full server path with trailing slash.\n  |\n */\n$config['log_path'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Log File Extension\n  |--------------------------------------------------------------------------\n  |\n  | The default filename extension for log files. The default 'php' allows for\n  | protecting the log files via basic scripting, when they are to be stored\n  | under a publicly accessible directory.\n  |\n  | Note: Leaving it blank will default to 'php'.\n  |\n */\n$config['log_file_extension'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Log File Permissions\n  |--------------------------------------------------------------------------\n  |\n  | The file system permissions to be applied on newly created log files.\n  |\n  | IMPORTANT: This MUST be an integer (no quotes) and you MUST use octal\n  |            integer notation (i.e. 0700, 0644, etc.)\n */\n$config['log_file_permissions'] = 0644;\n\n/*\n  |--------------------------------------------------------------------------\n  | Date Format for Logs\n  |--------------------------------------------------------------------------\n  |\n  | Each item that is logged has an associated date. You can use PHP date\n  | codes to set your own date formatting\n  |\n */\n$config['log_date_format'] = 'Y-m-d H:i:s';\n\n/*\n  |--------------------------------------------------------------------------\n  | Error Views Directory Path\n  |--------------------------------------------------------------------------\n  |\n  | Leave this BLANK unless you would like to set something other than the default\n  | application/views/errors/ directory.  Use a full server path with trailing slash.\n  |\n */\n$config['error_views_path'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Cache Directory Path\n  |--------------------------------------------------------------------------\n  |\n  | Leave this BLANK unless you would like to set something other than the default\n  | application/cache/ directory.  Use a full server path with trailing slash.\n  |\n */\n$config['cache_path'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Cache Include Query String\n  |--------------------------------------------------------------------------\n  |\n  | Whether to take the URL query string into consideration when generating\n  | output cache files. Valid options are:\n  |\n  |\tFALSE      = Disabled\n  |\tTRUE       = Enabled, take all query parameters into account.\n  |\t             Please be aware that this may result in numerous cache\n  |\t             files generated for the same page over and over again.\n  |\tarray('q') = Enabled, but only take into account the specified list\n  |\t             of query parameters.\n  |\n */\n$config['cache_query_string'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Encryption Key\n  |--------------------------------------------------------------------------\n  |\n  | If you use the Encryption class, you must set an encryption key.\n  | See the user guide for more info.\n  |\n  | https://codeigniter.com/user_guide/libraries/encryption.html\n  |\n */\n$config['encryption_key'] = 'asd';\n\n/*\n  |--------------------------------------------------------------------------\n  | Session Variables\n  |--------------------------------------------------------------------------\n  |\n  | 'sess_driver'\n  |\n  |\tThe storage driver to use: files, database, redis, memcached\n  |\n  | 'sess_cookie_name'\n  |\n  |\tThe session cookie name, must contain only [0-9a-z_-] characters\n  |\n  | 'sess_expiration'\n  |\n  |\tThe number of SECONDS you want the session to last.\n  |\tSetting to 0 (zero) means expire when the browser is closed.\n  |\n  | 'sess_save_path'\n  |\n  |\tThe location to save sessions to, driver dependent.\n  |\n  |\tFor the 'files' driver, it's a path to a writable directory.\n  |\tWARNING: Only absolute paths are supported!\n  |\n  |\tFor the 'database' driver, it's a table name.\n  |\tPlease read up the manual for the format with other session drivers.\n  |\n  |\tIMPORTANT: You are REQUIRED to set a valid save path!\n  |\n  | 'sess_match_ip'\n  |\n  |\tWhether to match the user's IP address when reading the session data.\n  |\n  |\tWARNING: If you're using the database driver, don't forget to update\n  |\t         your session table's PRIMARY KEY when changing this setting.\n  |\n  | 'sess_time_to_update'\n  |\n  |\tHow many seconds between CI regenerating the session ID.\n  |\n  | 'sess_regenerate_destroy'\n  |\n  |\tWhether to destroy session data associated with the old session ID\n  |\twhen auto-regenerating the session ID. When set to FALSE, the data\n  |\twill be later deleted by the garbage collector.\n  |\n  | Other session cookie settings are shared with the rest of the application,\n  | except for 'cookie_prefix' and 'cookie_httponly', which are ignored here.\n  |\n */\n$config['sess_driver'] = 'files';\n$config['sess_cookie_name'] = 'ci_session';\n$config['sess_expiration'] = 7200;\n$config['sess_save_path'] = sys_get_temp_dir();\n$config['sess_match_ip'] = FALSE;\n$config['sess_time_to_update'] = 300;\n$config['sess_regenerate_destroy'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Cookie Related Variables\n  |--------------------------------------------------------------------------\n  |\n  | 'cookie_prefix'   = Set a cookie name prefix if you need to avoid collisions\n  | 'cookie_domain'   = Set to .your-domain.com for site-wide cookies\n  | 'cookie_path'     = Typically will be a forward slash\n  | 'cookie_secure'   = Cookie will only be set if a secure HTTPS connection exists.\n  | 'cookie_httponly' = Cookie will only be accessible via HTTP(S) (no javascript)\n  |\n  | Note: These settings (with the exception of 'cookie_prefix' and\n  |       'cookie_httponly') will also affect sessions.\n  |\n */\n$config['cookie_prefix'] = '';\n$config['cookie_domain'] = '';\n$config['cookie_path'] = '/';\n$config['cookie_secure'] = FALSE;\n$config['cookie_httponly'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Standardize newlines\n  |--------------------------------------------------------------------------\n  |\n  | Determines whether to standardize newline characters in input data,\n  | meaning to replace \\r\\n, \\r, \\n occurrences with the PHP_EOL value.\n  |\n  | This is particularly useful for portability between UNIX-based OSes,\n  | (usually \\n) and Windows (\\r\\n).\n  |\n */\n$config['standardize_newlines'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Global XSS Filtering\n  |--------------------------------------------------------------------------\n  |\n  | Determines whether the XSS filter is always active when GET, POST or\n  | COOKIE data is encountered\n  |\n  | WARNING: This feature is DEPRECATED and currently available only\n  |          for backwards compatibility purposes!\n  |\n */\n$config['global_xss_filtering'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Cross Site Request Forgery\n  |--------------------------------------------------------------------------\n  | Enables a CSRF cookie token to be set. When set to TRUE, token will be\n  | checked on a submitted form. If you are accepting user data, it is strongly\n  | recommended CSRF protection be enabled.\n  |\n  | 'csrf_token_name' = The token name\n  | 'csrf_cookie_name' = The cookie name\n  | 'csrf_expire' = The number in seconds the token should expire.\n  | 'csrf_regenerate' = Regenerate token on every submission\n  | 'csrf_exclude_uris' = Array of URIs which ignore CSRF checks\n */\n$config['csrf_protection'] = FALSE;\n$config['csrf_token_name'] = 'csrf_test_name';\n$config['csrf_cookie_name'] = 'csrf_cookie_name';\n$config['csrf_expire'] = 7200;\n$config['csrf_regenerate'] = TRUE;\n$config['csrf_exclude_uris'] = array();\n\n/*\n  |--------------------------------------------------------------------------\n  | Output Compression\n  |--------------------------------------------------------------------------\n  |\n  | Enables Gzip output compression for faster page loads.  When enabled,\n  | the output class will test whether your server supports Gzip.\n  | Even if it does, however, not all browsers support compression\n  | so enable only if you are reasonably sure your visitors can handle it.\n  |\n  | Only used if zlib.output_compression is turned off in your php.ini.\n  | Please do not use it together with httpd-level output compression.\n  |\n  | VERY IMPORTANT:  If you are getting a blank page when compression is enabled it\n  | means you are prematurely outputting something to your browser. It could\n  | even be a line of whitespace at the end of one of your scripts.  For\n  | compression to work, nothing can be sent before the output buffer is called\n  | by the output class.  Do not 'echo' any values with compression enabled.\n  |\n */\n$config['compress_output'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Master Time Reference\n  |--------------------------------------------------------------------------\n  |\n  | Options are 'local' or any PHP supported timezone. This preference tells\n  | the system whether to use your server's local time as the master 'now'\n  | reference, or convert it to the configured one timezone. See the 'date\n  | helper' page of the user guide for information regarding date handling.\n  |\n */\n$config['time_reference'] = 'local';\n\n/*\n  |--------------------------------------------------------------------------\n  | Rewrite PHP Short Tags\n  |--------------------------------------------------------------------------\n  |\n  | If your PHP installation does not have short tag support enabled CI\n  | can rewrite the tags on-the-fly, enabling you to utilize that syntax\n  | in your view files.  Options are TRUE or FALSE (boolean)\n  |\n  | Note: You need to have eval() enabled for this to work.\n  |\n */\n$config['rewrite_short_tags'] = FALSE;\n\n/*\n  |--------------------------------------------------------------------------\n  | Reverse Proxy IPs\n  |--------------------------------------------------------------------------\n  |\n  | If your server is behind a reverse proxy, you must whitelist the proxy\n  | IP addresses from which CodeIgniter should trust headers such as\n  | HTTP_X_FORWARDED_FOR and HTTP_CLIENT_IP in order to properly identify\n  | the visitor's IP address.\n  |\n  | You can use both an array or a comma-separated list of proxy addresses,\n  | as well as specifying whole subnets. Here are a few examples:\n  |\n  | Comma-separated:\t'10.0.1.200,192.168.5.0/24'\n  | Array:\t\tarray('10.0.1.200', '192.168.5.0/24')\n */\n$config['proxy_ips'] = '';\n\n/*\n  |--------------------------------------------------------------------------\n  | Site Template Name That Will Be Loaded\n  |--------------------------------------------------------------------------\n  |\n  | By default is redlabel.\n  |\n */\n$config['template'] = 'redlabel';\n", "<script src=\"<?= base_url('assets/ckeditor/ckeditor.js') ?>\"></script>\n<h1><img src=\"<?= base_url('assets/imgs/blogger.png') ?>\" class=\"header-img\" style=\"margin-top:-2px;\"> Publish post</h1>\n<hr>\n<div class=\"row\">\n    <div class=\"col-sm-8 col-md-7\">\n        <?php if (validation_errors()) { ?>\n            <hr>\n            <div class=\"alert alert-danger\"><?= validation_errors() ?></div>\n            <hr>\n        <?php }\n        ?>\n        <?php if ($this->session->flashdata('result_publish')) { ?>\n            <hr>\n            <div class=\"alert alert-danger\"><?= $this->session->flashdata('result_publish'); ?></div>\n            <hr>\n        <?php }\n        ?>\n        <form method=\"POST\" enctype=\"multipart/form-data\">\n            <?php foreach ($languages as $language) { ?>\n                <input type=\"hidden\" name=\"translations[]\" value=\"<?= $language->abbr ?>\">\n            <?php } foreach ($languages as $language) { ?>\n                <div class=\"form-group\"> \n                    <label>Title (<?= $language->name ?><img src=\"<?= base_url('attachments/lang_flags/' . $language->flag) ?>\" alt=\"\">)</label>\n                    <input type=\"text\" name=\"title[]\" value=\"<?= $trans_load != null && isset($trans_load[$language->abbr]['title']) ? $trans_load[$language->abbr]['title'] : '' ?>\" class=\"form-control\">\n                </div>\n                <?php\n            } $i = 0;\n            foreach ($languages as $language) {\n                ?>\n                <div class=\"form-group\">\n                    <label for=\"description<?= $i ?>\">Description (<?= $language->name ?><img src=\"<?= base_url('attachments/lang_flags/' . $language->flag) ?>\" alt=\"\">)</label>\n                    <textarea name=\"description[]\" id=\"description<?= $i ?>\" rows=\"50\" class=\"form-control\"><?= $trans_load != null && isset($trans_load[$language->abbr]['description']) ? $trans_load[$language->abbr]['description'] : '' ?></textarea>\n                    <script>\n                        CKEDITOR.replace('description<?= $i ?>');\n                        CKEDITOR.config.entities = false;\n                    </script>\n                </div>\n                <?php\n                $i++;\n            }\n            ?>\n            <div class=\"form-group\">\n                <?php if (isset($_POST['image'])) { ?>\n                    <input type=\"hidden\" name=\"old_image\" value=\"<?= htmlspecialchars($_POST['image']) ?>\">\n                    <div><img class=\"img-responsive\" src=\"<?= base_url('attachments/blog_images/' . htmlspecialchars($_POST['image'])) ?>\"></div>\n                    <label for=\"userfile\">Choose another image:</label>\n                <?php } else { ?>\n                    <label for=\"userfile\">Upload image:</label>\n                <?php } ?>\n                <input type=\"file\" id=\"userfile\" name=\"userfile\">\n            </div>\n            <button type=\"submit\" name=\"submit\" class=\"btn btn-default\">Publish</button>\n            <?php if ($id > 0) { ?>\n                <a href=\"<?= base_url('admin/blog') ?>\" class=\"btn btn-info\">Cancel</a>\n            <?php } ?>\n        </form>\n    </div>\n</div>"], "filenames": ["application/config/config.php", "application/modules/admin/views/blog/blogpublish.php"], "buggy_code_start_loc": [361, 45], "buggy_code_end_loc": [418, 46], "fixing_code_start_loc": [361, 45], "fixing_code_end_loc": [418, 46], "type": "CWE-79", "message": "Ecommerce-CodeIgniter-Bootstrap before commit 56465f was discovered to contain a cross-site scripting (XSS) vulnerability via the function base_url() at /blog/blogpublish.php.", "other": {"cve": {"id": "CVE-2022-35213", "sourceIdentifier": "cve@mitre.org", "published": "2022-08-18T20:15:11.573", "lastModified": "2022-08-22T18:35:23.867", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Ecommerce-CodeIgniter-Bootstrap before commit 56465f was discovered to contain a cross-site scripting (XSS) vulnerability via the function base_url() at /blog/blogpublish.php."}, {"lang": "es", "value": "Se ha detectado que Ecommerce-CodeIgniter-Bootstrap versiones anteriores al commit 56465f, conten\u00eda una vulnerabilidad de tipo cross-site scripting (XSS) por medio de la funci\u00f3n base_url() en el archivo /blog/blogpublish.php."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ecommerce-codeigniter-bootstrap_project:ecommerce-codeigniter-bootstrap:*:*:*:*:*:*:*:*", "versionEndExcluding": "2021-08-21", "matchCriteriaId": "A2060B33-D99A-4D99-8D54-6AB28E1EE59A"}]}]}], "references": [{"url": "https://github.com/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/commit/56465fb6a83aaa934a76615a8579100938b790a1", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/issues/219", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/commit/56465fb6a83aaa934a76615a8579100938b790a1"}}