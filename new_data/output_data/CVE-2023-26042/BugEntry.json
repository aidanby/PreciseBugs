{"buggy_code": ["{% extends \"base.html.twig\" %}\n\n{% block  title %}\n    {% trans %}parts_list.search.title{% endtrans %}: {{ keyword }}\n{% endblock %}\n\n{% block content %}\n\n    <div class=\"accordion mb-3\" id=\"listAccordion\">\n        <div class=\"accordion-item\">\n            <div class=\"accordion-header\">\n                <button class=\"accordion-button collapsed py-2\" data-bs-toggle=\"collapse\" data-bs-target=\"#searchInfo\">\n                    <i class=\"fa-solid fa-magnifying-glass fa-fw\"></i>\n                    {% trans %}parts_list.search.title{% endtrans %}:&nbsp;<b>{{ keyword }}</b>\n                </button>\n            </div>\n            <div id=\"searchInfo\" class=\"accordion-collapse collapse\" data-bs-parent=\"#listAccordion\">\n                <div class=\"accordion-body\">\n                    <h4>{% trans with {\"%keyword%\": keyword} %}parts_list.search.searching_for{% endtrans %}</h4>\n                    {% trans %}parts_list.search_options.caption{% endtrans %}:\n\n\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.name %}checked{% endif %}>\n                        <label class=\"form-check-label justify-content-start\">{% trans %}name.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.category %}checked{% endif %}>\n                        <label class=\"form-check-label justify-content-start\">{% trans %}category.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.description %}checked{% endif %}>\n                        <label class=\"form-check-label justify-content-start\">{% trans %}description.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.mpn %}checked{% endif %}>\n                        <label class=\"form-check-label justify-content-start\">{% trans %}part.edit.mpn{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.tags %}checked{% endif %}>\n                        <label  class=\"form-check-label justify-content-start\">{% trans %}tags.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.storelocation %}checked{% endif %}>\n                        <label class=\"form-check-label justify-content-start\">{% trans %}storelocation.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.comment %}checked{% endif %}>\n                        <label class=\"form-check-label justify-content-start\">{% trans %}comment.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.ordernr %}checked{% endif %}>\n                        <label for=\"search_supplierpartnr\" class=\"form-check-label justify-content-start\">{% trans %}ordernumber.label.short{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.supplier %}checked{% endif %}>\n                        <label for=\"search_supplier\" class=\"form-check-label justify-content-start\">{% trans %}supplier.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.manufacturer %}checked{% endif %}>\n                        <label for=\"search_manufacturer\" class=\"form-check-label justify-content-start\">{% trans %}manufacturer.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.footprint %}checked{% endif %}>\n                        <label for=\"search_footprint\" class=\"form-check-label justify-content-start\">{% trans %}footprint.label{% endtrans %}</label>\n                    </div>\n                    <hr>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.regex %}checked{% endif %}>\n                        <label for=\"regex\" class=\"form-check-label justify-content-start\">{% trans %}search.regexmatching{% endtrans %}</label>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n\n        {% include \"parts/lists/_filter.html.twig\" %}\n    </div>\n\n    {% include \"parts/lists/_parts_list.html.twig\" %}\n\n{% endblock %}\n"], "fixing_code": ["{% extends \"base.html.twig\" %}\n\n{% block  title %}\n    {% trans %}parts_list.search.title{% endtrans %}: {{ keyword }}\n{% endblock %}\n\n{% block content %}\n\n    <div class=\"accordion mb-3\" id=\"listAccordion\">\n        <div class=\"accordion-item\">\n            <div class=\"accordion-header\">\n                <button class=\"accordion-button collapsed py-2\" data-bs-toggle=\"collapse\" data-bs-target=\"#searchInfo\">\n                    <i class=\"fa-solid fa-magnifying-glass fa-fw\"></i>\n                    {% trans %}parts_list.search.title{% endtrans %}:&nbsp;<b>{{ keyword }}</b>\n                </button>\n            </div>\n            <div id=\"searchInfo\" class=\"accordion-collapse collapse\" data-bs-parent=\"#listAccordion\">\n                <div class=\"accordion-body\">\n                    <h4>{% trans with {\"%keyword%\": keyword|escape} %}parts_list.search.searching_for{% endtrans %}</h4>\n                    {% trans %}parts_list.search_options.caption{% endtrans %}:\n\n\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.name %}checked{% endif %}>\n                        <label class=\"form-check-label justify-content-start\">{% trans %}name.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.category %}checked{% endif %}>\n                        <label class=\"form-check-label justify-content-start\">{% trans %}category.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.description %}checked{% endif %}>\n                        <label class=\"form-check-label justify-content-start\">{% trans %}description.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.mpn %}checked{% endif %}>\n                        <label class=\"form-check-label justify-content-start\">{% trans %}part.edit.mpn{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.tags %}checked{% endif %}>\n                        <label  class=\"form-check-label justify-content-start\">{% trans %}tags.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.storelocation %}checked{% endif %}>\n                        <label class=\"form-check-label justify-content-start\">{% trans %}storelocation.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.comment %}checked{% endif %}>\n                        <label class=\"form-check-label justify-content-start\">{% trans %}comment.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.ordernr %}checked{% endif %}>\n                        <label for=\"search_supplierpartnr\" class=\"form-check-label justify-content-start\">{% trans %}ordernumber.label.short{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.supplier %}checked{% endif %}>\n                        <label for=\"search_supplier\" class=\"form-check-label justify-content-start\">{% trans %}supplier.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.manufacturer %}checked{% endif %}>\n                        <label for=\"search_manufacturer\" class=\"form-check-label justify-content-start\">{% trans %}manufacturer.label{% endtrans %}</label>\n                    </div>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.footprint %}checked{% endif %}>\n                        <label for=\"search_footprint\" class=\"form-check-label justify-content-start\">{% trans %}footprint.label{% endtrans %}</label>\n                    </div>\n                    <hr>\n                    <div class=\"form-check\">\n                        <input type=\"checkbox\" class=\"form-check-input\" disabled {% if searchFilter.regex %}checked{% endif %}>\n                        <label for=\"regex\" class=\"form-check-label justify-content-start\">{% trans %}search.regexmatching{% endtrans %}</label>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n\n        {% include \"parts/lists/_filter.html.twig\" %}\n    </div>\n\n    {% include \"parts/lists/_parts_list.html.twig\" %}\n\n{% endblock %}\n"], "filenames": ["templates/parts/lists/search_list.html.twig"], "buggy_code_start_loc": [19], "buggy_code_end_loc": [20], "fixing_code_start_loc": [19], "fixing_code_end_loc": [20], "type": "CWE-79", "message": "Part-DB is an open source inventory management system for your electronic components. User input was found not being properly escaped, which allowed malicious users to inject arbitrary HTML into the pages. The Content-Security-Policy forbids inline and external scripts so it is not possible to execute JavaScript code, unless in combination with other vulnerabilities. There are no workarounds, please upgrade to Pat-DB 1.0.2 or later.", "other": {"cve": {"id": "CVE-2023-26042", "sourceIdentifier": "security-advisories@github.com", "published": "2023-02-27T15:15:11.753", "lastModified": "2023-03-07T17:30:44.930", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Part-DB is an open source inventory management system for your electronic components. User input was found not being properly escaped, which allowed malicious users to inject arbitrary HTML into the pages. The Content-Security-Policy forbids inline and external scripts so it is not possible to execute JavaScript code, unless in combination with other vulnerabilities. There are no workarounds, please upgrade to Pat-DB 1.0.2 or later."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:part-db_project:part-db:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.0.0", "versionEndExcluding": "1.0.2", "matchCriteriaId": "CFE67675-403E-49C9-99BE-E3B4B8BA3C18"}]}]}], "references": [{"url": "https://github.com/Part-DB/Part-DB-server/commit/5b7f44f4eaacad8a79bcedec32780e00d7347099", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/Part-DB/Part-DB-server/pull/227", "source": "security-advisories@github.com", "tags": ["Issue Tracking"]}, {"url": "https://github.com/Part-DB/Part-DB-server/releases/tag/v1.0.2", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/Part-DB/Part-DB-server/security/advisories/GHSA-9pmh-gmxx-rg2x", "source": "security-advisories@github.com", "tags": ["Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/Part-DB/Part-DB-server/commit/5b7f44f4eaacad8a79bcedec32780e00d7347099"}}