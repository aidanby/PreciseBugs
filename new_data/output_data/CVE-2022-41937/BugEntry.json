{"buggy_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.3\" reference=\"Filter.WebHome\" locale=\"\">\n  <web>Filter</web>\n  <name>WebHome</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>Main.WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>Filter streams</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{warning}}Filter module is still young and experimental and while exporting should be safe enough, importing can be more risky for the current instance.{{/warning}}\n\n{{include reference=\"FilterStreamDescriptorForm\"/}}\n\n{{velocity output=\"true\"}}\n#set($input = $request.input)\n#set($output = $request.output)\n\n#set($inputProperties = {})\n#foreach($parameterName in $request.parameterNames)\n  #if ($parameterName.startsWith('filter_input_properties_descriptor_'))\n    #set($propertyName = $parameterName.substring(35))\n    #if ($request.getParameter($parameterName) &amp;&amp; $request.getParameter($parameterName) != '')\n      #set($void = $inputProperties.put($propertyName, $request.getParameter($parameterName)))\n    #end\n  #end\n#end\n## Set request input by default\n#if (!$inputProperties.source &amp;&amp; $services.filter.getInputFilterStreamDescriptor($request.input).getPropertyDescriptor('source'))\n  #set($sourceStandardInput = true)\n  #set($void = $inputProperties.put('source', $request.inputStream))\n#end\n\n#set($outputProperties = {})\n#foreach($parameterName in $request.parameterNames)\n  #if ($parameterName.startsWith('filter_output_properties_descriptor_'))\n    #set($propertyName = $parameterName.substring(36))\n    #if ($request.getParameter($parameterName) &amp;&amp; $request.getParameter($parameterName) != '')\n      #set($void = $outputProperties.put($propertyName, $request.getParameter($parameterName)))\n    #end\n  #end\n#end\n## Set response output by default\n#if (!$outputProperties.target &amp;&amp; $services.filter.getOutputFilterStreamDescriptor($request.output).getPropertyDescriptor('target'))\n  #set($targetStandardOutput = true)\n  #set($void = $outputProperties.put('target', $services.filter.createOutputStreamOutputTarget($response.outputStream, true)))\n#end\n{{/velocity}}\n\n{{velocity}}\n#if ($request.convert)\n  #if ($targetStandardOutput)\n    $response.setContentType('application/octet-stream')\n    $response.setHeader('Content-Disposition', 'attachment; filename=target');\n    $services.filter.convert($input, $inputProperties, $output, $outputProperties)\n    $xcontext.setFinished(true)\n  #else\n    #if ($sourceStandardInput)\n      #set($job = $services.filter.convert($input, $inputProperties, $output, $outputProperties))\n    #else\n      #set($job = $services.filter.startConvert($input, $inputProperties, $output, $outputProperties))\n    #end\n    #if ($job)\n      #if (!$sourceStandardInput)\n        {{success}}Conversion started.{{/success}}\n      #end\n    #else\n      #set ($lastError = $services.filter.lastError)\n      #if ($lastError)\n        {{error}}\n          Failed to start conversion\n\n          {{html}}\n            &lt;pre&gt;\n              #printThrowable($lastError)\n            &lt;/pre&gt;\n          {{/html}}\n        {{/error}}\n      #end\n    #end\n  #end\n#end\n{{/velocity}}\n\n== Current conversion\n\n{{include reference=\"FilterStreamJob\"/}}\n\n== Configuration ==\n\n{{velocity}}\n{{html}}\n&lt;form class=\"xform\" method=\"post\"&gt;\n&lt;div id=\"filter_form\"&gt;\n  &lt;fieldset&gt;\n    &lt;legend&gt;Input&lt;/legend&gt;\n    &lt;dl&gt;\n      &lt;dt&gt;&lt;label for=\"filter_input_select\"&gt;Input type&lt;/label&gt;&lt;/dt&gt;\n      &lt;dd&gt;\n        &lt;select name=\"input\" id=\"filter_input_type\"&gt;\n          #foreach($type in $services.filter.availableInputStreams)\n            &lt;option value=\"$escapetool.xml($type.serialize())\"#if($type.serialize() == $input)selected=\"selected\"#end&gt;$services.filter.getInputFilterStreamDescriptor($type).name ($type)&lt;/option&gt;\n            #if (!$input)\n              #set($input = $type.serialize())\n            #end\n          #end\n        &lt;/select&gt;\n      &lt;/dd&gt;\n      #if ($input)\n      &lt;dt&gt;&lt;label&gt;Input configuration&lt;/label&gt;&lt;/dt&gt;\n      &lt;dd&gt;\n        #filterDescriptorForm($services.filter.getInputFilterStreamDescriptor($input), 'filter_input_properties')\n      &lt;/dd&gt;\n      #end\n    &lt;/dl&gt;\n  &lt;/fieldset&gt;\n\n  &lt;fieldset&gt;\n    &lt;legend&gt;Output&lt;/legend&gt;\n    &lt;dl&gt;\n      &lt;dt&gt;&lt;label for=\"filter_output_select\"&gt;Output type&lt;/label&gt;&lt;/dt&gt;\n      &lt;dd&gt;\n        &lt;select name=\"output\" id=\"filter_output_type\"&gt;\n          #foreach($type in $services.filter.availableOutputStreams)\n            &lt;option value=\"$escapetool.xml($type.serialize())\"#if($type.serialize() == $output)selected=\"selected\"#end&gt;$services.filter.getOutputFilterStreamDescriptor($type).name ($type)&lt;/option&gt;\n            #if (!$output)\n              #set($output = $type.serialize())\n            #end\n          #end\n        &lt;/select&gt;\n      &lt;/dd&gt;\n      #if ($output)\n      &lt;dt&gt;&lt;label&gt;Output configuration&lt;/label&gt;&lt;/dt&gt;\n      &lt;dd&gt;\n        #filterDescriptorForm($services.filter.getOutputFilterStreamDescriptor($output), 'filter_output_properties')\n      &lt;/dd&gt;\n      #end\n    &lt;/dl&gt;\n  &lt;/fieldset&gt;\n\n  &lt;p&gt;\n  &lt;input class=\"button\" type=\"submit\" name=\"convert\" value=\"Convert\"/&gt;\n  &lt;/p&gt;\n&lt;/div&gt;\n&lt;/form&gt;\n{{/html}}\n{{/velocity}}</content>\n  <object>\n    <name>Filter.WebHome</name>\n    <number>0</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>752192f2-18d6-47ae-9c5a-4e4e151ef9fe</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>forbid</cache>\n    </property>\n    <property>\n      <code>$('filter_input_type').observe('change', function() {\n  new Ajax.Updater('filter_input_properties', '${xwiki.getURL('FilterStreamDescriptorForm', 'get')}', {\n    parameters:\n      {\n        type: this.value,\n        id: 'filter_input_properties',\n        outputSyntax: 'plain',\n        input: 'true'\n      }\n  });\n})\n\n$('filter_output_type').observe('change', function() {\n    new Ajax.Updater('filter_output_properties', '${xwiki.getURL('FilterStreamDescriptorForm', 'get')}', {\n    parameters:\n      {\n        type: this.value,\n        id: 'filter_output_properties',\n        outputSyntax: 'plain',\n        input: 'false'\n      }\n  });\n})</code>\n    </property>\n    <property>\n      <name>Update stream configuration form</name>\n    </property>\n    <property>\n      <parse>1</parse>\n    </property>\n    <property>\n      <use>currentPage</use>\n    </property>\n  </object>\n  <object>\n    <name>Filter.WebHome</name>\n    <number>0</number>\n    <className>XWiki.RequiredRightClass</className>\n    <guid>710a9c71-8450-4f28-92cc-2cd39b7437ba</guid>\n    <class>\n      <name>XWiki.RequiredRightClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <level>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>level</name>\n        <number>1</number>\n        <picker>0</picker>\n        <prettyName>level</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators> ,|</separators>\n        <size>1</size>\n        <sort>none</sort>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <values>edit|programming</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </level>\n    </class>\n    <property>\n      <level>programming</level>\n    </property>\n  </object>\n</xwikidoc>\n"], "fixing_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.5\" reference=\"Filter.WebHome\" locale=\"\">\n  <web>Filter</web>\n  <name>WebHome</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>Main.WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>Filter streams</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{include reference=\"FilterStreamDescriptorForm\"/}}\n\n{{velocity output=\"true\"}}\n#set($input = $request.input)\n#set($output = $request.output)\n\n#set($inputProperties = {})\n#foreach($parameterName in $request.parameterNames)\n  #if ($parameterName.startsWith('filter_input_properties_descriptor_'))\n    #set($propertyName = $parameterName.substring(35))\n    #if ($request.getParameter($parameterName) &amp;&amp; $request.getParameter($parameterName) != '')\n      #set($void = $inputProperties.put($propertyName, $request.getParameter($parameterName)))\n    #end\n  #end\n#end\n## Set request input by default\n#if (!$inputProperties.source &amp;&amp; $services.filter.getInputFilterStreamDescriptor($request.input).getPropertyDescriptor('source'))\n  #set($sourceStandardInput = true)\n  #set($void = $inputProperties.put('source', $request.inputStream))\n#end\n\n#set($outputProperties = {})\n#foreach($parameterName in $request.parameterNames)\n  #if ($parameterName.startsWith('filter_output_properties_descriptor_'))\n    #set($propertyName = $parameterName.substring(36))\n    #if ($request.getParameter($parameterName) &amp;&amp; $request.getParameter($parameterName) != '')\n      #set($void = $outputProperties.put($propertyName, $request.getParameter($parameterName)))\n    #end\n  #end\n#end\n## Set response output by default\n#if (!$outputProperties.target &amp;&amp; $services.filter.getOutputFilterStreamDescriptor($request.output).getPropertyDescriptor('target'))\n  #set($targetStandardOutput = true)\n  #set($void = $outputProperties.put('target', $services.filter.createOutputStreamOutputTarget($response.outputStream, true)))\n#end\n{{/velocity}}\n\n{{velocity}}\n#if ($request.convert)\n  #if ($services.security.authorization.hasAccess('programming', $context.userReference, $doc.documentReference))\n  #if ($targetStandardOutput)\n    $response.setContentType('application/octet-stream')\n    $response.setHeader('Content-Disposition', 'attachment; filename=target');\n    $services.filter.convert($input, $inputProperties, $output, $outputProperties)\n    $xcontext.setFinished(true)\n  #else\n    #if ($sourceStandardInput)\n      #set($job = $services.filter.convert($input, $inputProperties, $output, $outputProperties))\n    #else\n      #set($job = $services.filter.startConvert($input, $inputProperties, $output, $outputProperties))\n    #end\n    #if ($job)\n      #if (!$sourceStandardInput)\n        {{success}}Conversion started.{{/success}}\n      #end\n    #else\n      #set ($lastError = $services.filter.lastError)\n      #if ($lastError)\n        {{error}}\n          Failed to start conversion\n\n          {{html}}\n            &lt;pre&gt;\n              #printThrowable($lastError)\n            &lt;/pre&gt;\n          {{/html}}\n        {{/error}}\n      #end\n    #end\n  #end\n  #else\n    {{error}}You are not allowed to start a conversion.{{/error}}\n  #end\n#end\n{{/velocity}}\n\n== Current conversion\n\n{{include reference=\"FilterStreamJob\"/}}\n\n== Configuration ==\n\n{{velocity}}\n{{html}}\n&lt;form class=\"xform\" method=\"post\"&gt;\n&lt;div id=\"filter_form\"&gt;\n  &lt;fieldset&gt;\n    &lt;legend&gt;Input&lt;/legend&gt;\n    &lt;dl&gt;\n      &lt;dt&gt;&lt;label for=\"filter_input_select\"&gt;Input type&lt;/label&gt;&lt;/dt&gt;\n      &lt;dd&gt;\n        &lt;select name=\"input\" id=\"filter_input_type\"&gt;\n          #foreach($type in $services.filter.availableInputStreams)\n            &lt;option value=\"$escapetool.xml($type.serialize())\"#if($type.serialize() == $input)selected=\"selected\"#end&gt;$services.filter.getInputFilterStreamDescriptor($type).name ($type)&lt;/option&gt;\n            #if (!$input)\n              #set($input = $type.serialize())\n            #end\n          #end\n        &lt;/select&gt;\n      &lt;/dd&gt;\n      #if ($input)\n      &lt;dt&gt;&lt;label&gt;Input configuration&lt;/label&gt;&lt;/dt&gt;\n      &lt;dd&gt;\n        #filterDescriptorForm($services.filter.getInputFilterStreamDescriptor($input), 'filter_input_properties')\n      &lt;/dd&gt;\n      #end\n    &lt;/dl&gt;\n  &lt;/fieldset&gt;\n\n  &lt;fieldset&gt;\n    &lt;legend&gt;Output&lt;/legend&gt;\n    &lt;dl&gt;\n      &lt;dt&gt;&lt;label for=\"filter_output_select\"&gt;Output type&lt;/label&gt;&lt;/dt&gt;\n      &lt;dd&gt;\n        &lt;select name=\"output\" id=\"filter_output_type\"&gt;\n          #foreach($type in $services.filter.availableOutputStreams)\n            &lt;option value=\"$escapetool.xml($type.serialize())\"#if($type.serialize() == $output)selected=\"selected\"#end&gt;$services.filter.getOutputFilterStreamDescriptor($type).name ($type)&lt;/option&gt;\n            #if (!$output)\n              #set($output = $type.serialize())\n            #end\n          #end\n        &lt;/select&gt;\n      &lt;/dd&gt;\n      #if ($output)\n      &lt;dt&gt;&lt;label&gt;Output configuration&lt;/label&gt;&lt;/dt&gt;\n      &lt;dd&gt;\n        #filterDescriptorForm($services.filter.getOutputFilterStreamDescriptor($output), 'filter_output_properties')\n      &lt;/dd&gt;\n      #end\n    &lt;/dl&gt;\n  &lt;/fieldset&gt;\n\n  &lt;p&gt;\n    #if ($services.security.authorization.hasAccess('programming', $context.userReference, $doc.documentReference))\n      &lt;input class=\"button\" type=\"submit\" name=\"convert\" value=\"Convert\"/&gt;\n    #else\n      &lt;input class=\"button\" type=\"submit\" name=\"convert\" value=\"Convert\" disabled title=\"You are not allowed to start a conversion.\"/&gt;\n    #end\n  &lt;/p&gt;\n&lt;/div&gt;\n&lt;/form&gt;\n{{/html}}\n{{/velocity}}</content>\n  <object>\n    <name>Filter.WebHome</name>\n    <number>0</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>752192f2-18d6-47ae-9c5a-4e4e151ef9fe</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>forbid</cache>\n    </property>\n    <property>\n      <code>$('filter_input_type').observe('change', function() {\n  new Ajax.Updater('filter_input_properties', '${xwiki.getURL('FilterStreamDescriptorForm', 'get')}', {\n    parameters:\n      {\n        type: this.value,\n        id: 'filter_input_properties',\n        outputSyntax: 'plain',\n        input: 'true'\n      }\n  });\n})\n\n$('filter_output_type').observe('change', function() {\n    new Ajax.Updater('filter_output_properties', '${xwiki.getURL('FilterStreamDescriptorForm', 'get')}', {\n    parameters:\n      {\n        type: this.value,\n        id: 'filter_output_properties',\n        outputSyntax: 'plain',\n        input: 'false'\n      }\n  });\n})</code>\n    </property>\n    <property>\n      <name>Update stream configuration form</name>\n    </property>\n    <property>\n      <parse>1</parse>\n    </property>\n    <property>\n      <use>currentPage</use>\n    </property>\n  </object>\n  <object>\n    <name>Filter.WebHome</name>\n    <number>0</number>\n    <className>XWiki.RequiredRightClass</className>\n    <guid>710a9c71-8450-4f28-92cc-2cd39b7437ba</guid>\n    <class>\n      <name>XWiki.RequiredRightClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <level>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>level</name>\n        <number>1</number>\n        <picker>0</picker>\n        <prettyName>level</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators> ,|</separators>\n        <size>1</size>\n        <sort>none</sort>\n        <unmodifiable>0</unmodifiable>\n        <validationMessage/>\n        <validationRegExp/>\n        <values>edit|programming</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </level>\n    </class>\n    <property>\n      <level>programming</level>\n    </property>\n  </object>\n</xwikidoc>\n"], "filenames": ["xwiki-platform-core/xwiki-platform-filter/xwiki-platform-filter-ui/src/main/resources/Filter/WebHome.xml"], "buggy_code_start_loc": [23], "buggy_code_end_loc": [240], "fixing_code_start_loc": [23], "fixing_code_end_loc": [252], "type": "CWE-862", "message": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. The application allows anyone with view access to modify any page of the wiki by importing a crafted XAR package. The problem has been patched in XWiki 14.6RC1, 14.6 and 13.10.8. As a workaround, setting the right of the page Filter.WebHome and making sure only the main wiki administrators can view the application installed on main wiki or edit the page and apply the changed described in commit fb49b4f.", "other": {"cve": {"id": "CVE-2022-41937", "sourceIdentifier": "security-advisories@github.com", "published": "2022-11-22T01:15:36.727", "lastModified": "2022-11-28T14:42:50.803", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. The application allows anyone with view access to modify any page of the wiki by importing a crafted XAR package. The problem has been patched in XWiki 14.6RC1, 14.6 and 13.10.8. As a workaround, setting the right of the page Filter.WebHome and making sure only the main wiki administrators can view the application installed on main wiki or edit the page and apply the changed described in commit fb49b4f."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 9.6, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 5.8}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-862"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionEndExcluding": "13.10.8", "matchCriteriaId": "826127A0-9698-4FA6-8FFD-64C933B52A94"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "14.0", "versionEndExcluding": "14.4.3", "matchCriteriaId": "DCDE8612-07AB-4ED8-A457-E6D2FBD3C543"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:14.5:*:*:*:*:*:*:*", "matchCriteriaId": "4F6B6AFE-73B1-458D-B601-DF044CA1A141"}]}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/fb49b4f289ee28e45cfada8e97e320cd3ed27113", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-q6jp-gcww-8v2j", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://jira.xwiki.org/browse/XWIKI-19758", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}]}, "github_commit_url": "https://github.com/xwiki/xwiki-platform/commit/fb49b4f289ee28e45cfada8e97e320cd3ed27113"}}