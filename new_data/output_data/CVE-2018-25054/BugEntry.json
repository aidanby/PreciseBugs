{"buggy_code": ["<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<%@ page contentType=\"text/html; charset=utf-8\" pageEncoding=\"utf-8\" %>\n<%--\n -\n -  cilla - Blog Management System\n -\n -  Copyright (C) 2013 Richard \"Shred\" K\u00f6rber\n -    http://cilla.shredzone.org\n -\n -  This program is free software: you can redistribute it and/or modify\n -  it under the terms of the GNU Affero General Public License as published\n -  by the Free Software Foundation, either version 3 of the License, or\n -  (at your option) any later version.\n -\n -  This program is distributed in the hope that it will be useful,\n -  but WITHOUT ANY WARRANTY; without even the implied warranty of\n -  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n -  GNU General Public License for more details.\n -\n -  You should have received a copy of the GNU Affero General Public License\n -  along with this program.  If not, see <http://www.gnu.org/licenses/>.\n -\n --%>\n<%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\" %>\n<%@ taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\" %>\n<%@ taglib prefix=\"cilla\" uri=\"http://cilla.shredzone.org/taglib/cilla\" %>\n<%@ taglib prefix=\"sz\" tagdir=\"/WEB-INF/tags/sz\" %>\n<fmt:setBundle basename=\"messages\"/>\n<c:set var=\"headTitle\" value=\"${search.title}\" scope=\"request\"/>\n<c:import url=\"/WEB-INF/jsp/design/header.jspf\"/>\n<c:import url=\"/WEB-INF/jsp/design/sidebar-left.jsp\"/>\n\n<div id=\"content\" class=\"content\">\n  <cilla:link view=\"search\" var=\"searchUrl\"/>\n\n  <div class=\"page-toolbar\">\n    <form action=\"<c:url value=\"${searchUrl}\"/>\" method=\"get\"><fmt:message key=\"search.term\"/> <input style=\"width:50%\" type=\"text\" name=\"q\" value=\"<c:out value=\"${query}\"/>\" /><button class=\"button\" type=\"submit\"><fmt:message key=\"search.execute\"/></button></form>\n  </div>\n\n  <c:if test=\"${not empty message}\">\n    <p>\n      <fmt:message key=\"${message}\">\n        <fmt:param value=\"${details}\"/>\n      </fmt:message>\n    </p>\n  </c:if>\n\n  <c:if test=\"${empty result.pages and empty message}\">\n    <p>\n      <fmt:message key=\"search.msg.empty\"/>\n    </p>\n  </c:if>\n\n  <cilla:render fragment=\"paginator\" item=\"${paginator}\" rendered=\"${paginator.pageCount gt 1}\">\n    <cilla:param name=\"filter\" value=\"${result.filter}\"/>\n  </cilla:render>\n\n  <c:forEach var=\"page\" items=\"${result.pages}\" varStatus=\"pageStatus\">\n    <h1><cilla:link page=\"${page}\"><c:out value=\"${page.title}\"/></cilla:link></h1>\n    <c:out value=\"${result.highlighted[pageStatus.index]}\" escapeXml=\"false\"/>\n  </c:forEach>\n\n  <cilla:render fragment=\"paginator\" item=\"${paginator}\" rendered=\"${paginator.pageCount gt 1}\">\n    <cilla:param name=\"filter\" value=\"${result.filter}\"/>\n  </cilla:render>\n\n</div>\n<c:import url=\"/WEB-INF/jsp/design/sidebar-right.jsp\"/>\n<c:import url=\"/WEB-INF/jsp/design/footer.jspf\"/>\n"], "fixing_code": ["<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<%@ page contentType=\"text/html; charset=utf-8\" pageEncoding=\"utf-8\" %>\n<%--\n -\n -  cilla - Blog Management System\n -\n -  Copyright (C) 2013 Richard \"Shred\" K\u00f6rber\n -    http://cilla.shredzone.org\n -\n -  This program is free software: you can redistribute it and/or modify\n -  it under the terms of the GNU Affero General Public License as published\n -  by the Free Software Foundation, either version 3 of the License, or\n -  (at your option) any later version.\n -\n -  This program is distributed in the hope that it will be useful,\n -  but WITHOUT ANY WARRANTY; without even the implied warranty of\n -  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n -  GNU General Public License for more details.\n -\n -  You should have received a copy of the GNU Affero General Public License\n -  along with this program.  If not, see <http://www.gnu.org/licenses/>.\n -\n --%>\n<%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\" %>\n<%@ taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\" %>\n<%@ taglib prefix=\"cilla\" uri=\"http://cilla.shredzone.org/taglib/cilla\" %>\n<%@ taglib prefix=\"sz\" tagdir=\"/WEB-INF/tags/sz\" %>\n<%@ taglib prefix=\"fn\" uri=\"http://java.sun.com/jsp/jstl/functions\" %>\n<fmt:setBundle basename=\"messages\"/>\n<c:set var=\"headTitle\" value=\"${search.title}\" scope=\"request\"/>\n<c:import url=\"/WEB-INF/jsp/design/header.jspf\"/>\n<c:import url=\"/WEB-INF/jsp/design/sidebar-left.jsp\"/>\n\n<div id=\"content\" class=\"content\">\n  <cilla:link view=\"search\" var=\"searchUrl\"/>\n\n  <div class=\"page-toolbar\">\n    <form action=\"<c:url value=\"${searchUrl}\"/>\" method=\"get\"><fmt:message key=\"search.term\"/> <input style=\"width:50%\" type=\"text\" name=\"q\" value=\"<c:out value=\"${query}\"/>\" /><button class=\"button\" type=\"submit\"><fmt:message key=\"search.execute\"/></button></form>\n  </div>\n\n  <c:if test=\"${not empty message}\">\n    <p>\n      <fmt:message key=\"${message}\">\n        <fmt:param value=\"${fn:escapeXml(details)}\"/>\n      </fmt:message>\n    </p>\n  </c:if>\n\n  <c:if test=\"${empty result.pages and empty message}\">\n    <p>\n      <fmt:message key=\"search.msg.empty\"/>\n    </p>\n  </c:if>\n\n  <cilla:render fragment=\"paginator\" item=\"${paginator}\" rendered=\"${paginator.pageCount gt 1}\">\n    <cilla:param name=\"filter\" value=\"${result.filter}\"/>\n  </cilla:render>\n\n  <c:forEach var=\"page\" items=\"${result.pages}\" varStatus=\"pageStatus\">\n    <h1><cilla:link page=\"${page}\"><c:out value=\"${page.title}\"/></cilla:link></h1>\n    <c:out value=\"${result.highlighted[pageStatus.index]}\" escapeXml=\"false\"/>\n  </c:forEach>\n\n  <cilla:render fragment=\"paginator\" item=\"${paginator}\" rendered=\"${paginator.pageCount gt 1}\">\n    <cilla:param name=\"filter\" value=\"${result.filter}\"/>\n  </cilla:render>\n\n</div>\n<c:import url=\"/WEB-INF/jsp/design/sidebar-right.jsp\"/>\n<c:import url=\"/WEB-INF/jsp/design/footer.jspf\"/>\n"], "filenames": ["cilla-xample/src/main/webapp/WEB-INF/jsp/view/search.jsp"], "buggy_code_start_loc": [28], "buggy_code_end_loc": [45], "fixing_code_start_loc": [29], "fixing_code_end_loc": [46], "type": "CWE-79", "message": "A vulnerability was found in shred cilla. It has been classified as problematic. Affected is an unknown function of the file cilla-xample/src/main/webapp/WEB-INF/jsp/view/search.jsp of the component Search Handler. The manipulation of the argument details leads to cross site scripting. It is possible to launch the attack remotely. The name of the patch is d345e6bc7798bd717a583ec7f545ca387819d5c7. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-216960.", "other": {"cve": {"id": "CVE-2018-25054", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-28T12:15:08.753", "lastModified": "2023-01-06T18:19:52.263", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in shred cilla. It has been classified as problematic. Affected is an unknown function of the file cilla-xample/src/main/webapp/WEB-INF/jsp/view/search.jsp of the component Search Handler. The manipulation of the argument details leads to cross site scripting. It is possible to launch the attack remotely. The name of the patch is d345e6bc7798bd717a583ec7f545ca387819d5c7. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-216960."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:shredzone:cilla:*:*:*:*:*:*:*:*", "versionEndExcluding": "2019-10-28", "matchCriteriaId": "DC22C701-C954-4582-9017-3DFA9179EFDF"}]}]}], "references": [{"url": "https://github.com/shred/cilla/commit/d345e6bc7798bd717a583ec7f545ca387819d5c7", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.216960", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.216960", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/shred/cilla/commit/d345e6bc7798bd717a583ec7f545ca387819d5c7"}}