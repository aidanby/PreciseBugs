{"buggy_code": ["<?php\n\n// \u5f53php\u7248\u672c\u8fbe\u5230composer\u5305\u8981\u6c42\u7684\u7248\u672c\u65f6\u5019\uff0c\u5219require autoload\n// vendor/composer/platform_check.php \u91cc\u9762\u53ef\u4ee5\u770b\u5230composer\u5305\u8981\u6c42\u7684\u6700\u4f4e\u7248\u672c\ndefine('COMPOSER_PHP_VERSION', '7.2.5' );\nif(version_compare(PHP_VERSION,COMPOSER_PHP_VERSION,'>')){\n    // \u589e\u52a0\u81ea\u52a8\u52a0\u8f7d\n    require './vendor/autoload.php';\n}\n\n// \u5f00\u542f\u8c03\u8bd5\u6a21\u5f0f \u5efa\u8bae\u5f00\u53d1\u9636\u6bb5\u5f00\u542f \u90e8\u7f72\u9636\u6bb5\u6ce8\u91ca\u6216\u8005\u8bbe\u4e3afalse\ndefine('APP_DEBUG',True);\n\n// \u5b9a\u4e49\u5e94\u7528\u76ee\u5f55\ndefine('APP_PATH','./Application/');\n\n// \u5f15\u5165ThinkPHP\u5165\u53e3\u6587\u4ef6\nrequire './ThinkPHP/ThinkPHP.php';"], "fixing_code": ["<?php\n\n// \u5f53php\u7248\u672c\u8fbe\u5230composer\u5305\u8981\u6c42\u7684\u7248\u672c\u65f6\u5019\uff0c\u5219require autoload\n// vendor/composer/platform_check.php \u91cc\u9762\u53ef\u4ee5\u770b\u5230composer\u5305\u8981\u6c42\u7684\u6700\u4f4e\u7248\u672c\ndefine('COMPOSER_PHP_VERSION', '7.2.5' );\nif(version_compare(PHP_VERSION,COMPOSER_PHP_VERSION,'>')){\n    // \u589e\u52a0\u81ea\u52a8\u52a0\u8f7d\n    require './vendor/autoload.php';\n}\n\n// cookie\u5b89\u5168\uff0c\u7ed9PHPSESSID\u52a0\u4e0aStrict\nif (PHP_VERSION_ID >= 70300) {\n    session_set_cookie_params([\n        'samesite' => 'Strict'\n    ]);\n} else { \n    session_set_cookie_params(\n        NULL,\n        '/; samesite=Strict',\n    );\n}\n\n// \u5f00\u542f\u8c03\u8bd5\u6a21\u5f0f \u5efa\u8bae\u5f00\u53d1\u9636\u6bb5\u5f00\u542f \u90e8\u7f72\u9636\u6bb5\u6ce8\u91ca\u6216\u8005\u8bbe\u4e3afalse\ndefine('APP_DEBUG',True);\n\n// \u5b9a\u4e49\u5e94\u7528\u76ee\u5f55\ndefine('APP_PATH','./Application/');\n\n// \u5f15\u5165ThinkPHP\u5165\u53e3\u6587\u4ef6\nrequire './ThinkPHP/ThinkPHP.php';"], "filenames": ["server/index.php"], "buggy_code_start_loc": [10], "buggy_code_end_loc": [10], "fixing_code_start_loc": [11], "fixing_code_end_loc": [23], "type": "CWE-352", "message": "showdoc is vulnerable to Cross-Site Request Forgery (CSRF)", "other": {"cve": {"id": "CVE-2021-3993", "sourceIdentifier": "security@huntr.dev", "published": "2021-12-01T11:15:08.097", "lastModified": "2021-12-02T20:13:30.863", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "showdoc is vulnerable to Cross-Site Request Forgery (CSRF)"}, {"lang": "es", "value": "showdoc es vulnerable a un ataque de tipo Cross-Site Request Forgery (CSRF)"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "LOW", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:showdoc:showdoc:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.9.13", "matchCriteriaId": "3ED61945-F39E-4395-BA12-8F3F8A7E55A0"}]}]}], "references": [{"url": "https://github.com/star7th/showdoc/commit/654e871a3923e79076818a9a03533fe88222c871", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/0aa84736-139b-4ae7-becf-604f7f60b1c9", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/star7th/showdoc/commit/654e871a3923e79076818a9a03533fe88222c871"}}