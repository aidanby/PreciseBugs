{"buggy_code": ["<?php\n/*\nPlugin Name: Beeliked Microsite\nPlugin URI: http://beeliked.com\nDescription: Allows the insertion of code to display a BeeLiked microsite within an iframe. The tag to insert the code is: <code>[BEELIKED_MICROSITE]</code>, containing url, width, height and autosize parameters.\nVersion: 1.0.1\nAuthor: Beeliked\nAuthor URI: http://beeliked.com\nLicense: GPLv2 or later\nText Domain: beeliked\n*/\n\n/*\nThis program is free software; you can redistribute it and/or\nmodify it under the terms of the GNU General Public License\nas published by the Free Software Foundation; either version 2\nof the License, or (at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program; if not, write to the Free Software\nFoundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n*/\n\n\n/*\n1.0   - Initial release\n1.0.1 - Documentation change\n*/\n\ninclude (dirname (__FILE__).'/plugin.php');\n\nclass BeelikedMicrosite extends BeelikedMicrosite_Plugin\n{\n\tfunction BeelikedMicrosite ()\n\t{\n\t\t$this->register_plugin ('beelikedmicrosite', __FILE__);\n\t\t\n\t\t$this->add_action('template_redirect', 'load_js');\n\t\t\n\t\tadd_shortcode('BEELIKED_MICROSITE', array($this, 'embed_handler'));\n\t\t\n\t\t$this->add_filter('tiny_mce_version', array($this, 'refresh_mce'));\n\t\t$this->add_action('init', 'add_beeliked_button');\n\t\t\n\t\t$this->add_action('admin_print_footer_scripts', 'add_quicktags');\n\t}\n\t\n\t/* TINYMCE */\n\t\n\tfunction refresh_mce () \n\t{\n\t\t$ver += 3;\n\t\treturn $ver;\n\t}\n\t\n\tfunction add_beeliked_button() \n\t{\n      if ( ! current_user_can('edit_posts') && ! current_user_can('edit_pages') )\n        return;\n \n      // Add only in Rich Editor mode\n      //if ( get_user_option('rich_editing') == 'true') {\n        $this->add_filter(\"mce_external_plugins\", \"add_tinymce_plugin\");        \n\t\t$this->add_filter('mce_buttons', 'register_tinymce_button');\n\t\t\n      //}\n\t}\n\t\n\tfunction add_tinymce_plugin($plugin_array)\n\t{\n\t  $plugin_array['beelikedmicrosite'] = plugins_url('/js/editor_plugin.js', __file__);\n\t  return $plugin_array;\n\t}\n\t\n\tfunction register_tinymce_button($buttons)\n\t{\n\t  array_push($buttons, \"beelikedmicrosite\");\n      return $buttons;\n\t}\n\t\n\tfunction add_quicktags()\n\t{\n\t\tif (wp_script_is('quicktags'))\n\t\t{\n\t\t?>\n\t\t<script type=\"text/javascript\">\n\t\tQTags.addButton('beeliked_microsite', 'Beeliked Microsite', '[BEELIKED_MICROSITE url=\"', '\" width=\"100%\" height=\"1400px\" autosize=\"1\"]', '' );\n\t\t</script>\n\t\t<?php \n\t\t}\n\t}\n\t\n\t/* SHORTCODE */\n\t\n\tfunction load_js() \n\t{\n\t\twp_register_script('jquery_iframeResizer', plugins_url('/js/iframeResizer.min.js', __file__), array('jquery'));\t\t\n\t\twp_enqueue_script('jquery_iframeResizer');\n\t}\n\t\n\tprotected $iframeId = 0;\n\t\n\tfunction embed_handler($atts = array()) \n\t{\n\t\tshortcode_atts(array(\n\t\t\t'url' => 'http://beta.beeliked.com',\n\t\t\t'width' => '100%',\n\t\t\t'height' => '1400px',\n\t\t\t'autosize' => true\n\t\t), $atts);\n\t\t\n\t\t$autosize = $atts['autosize'] ? 1 : 0;\n\t\t\n\t\t$this->iframeId++;\n\t\t$return = \"<iframe load-url=\\\"{$atts['url']}\\\" id=\\\"bee-microsite-iframe-{$this->iframeId}\\\" class=\\\"bee-microsite-iframe\\\" width=\\\"{$atts['width']}\\\" height=\\\"{$atts['height']}\\\" data-autosize=\\\"{$autosize}\\\" frameborder=\\\"0\\\"></iframe>\n<script type=\\\"text/javascript\\\" src=\\\"http://beta.beeliked.com/microsite/js/beeliked.clientIframe.js\\\"></script>\n<script type=\\\"text/javascript\\\">jQuery(document).ready(function() { jQuery('.bee-microsite-iframe[data-autosize=1]').iFrameResize({heightCalculationMethod : 'max'}); });</script>\";\n\t\treturn $return;\n\t}\n}\n\n$beelikedMicrosite = new BeelikedMicrosite;\n?>\n"], "fixing_code": ["<?php\n/*\nPlugin Name: Beeliked Microsite\nPlugin URI: http://beeliked.com\nDescription: Allows the insertion of code to display a BeeLiked microsite within an iframe. The tag to insert the code is: <code>[BEELIKED_MICROSITE]</code>, containing url, width, height and autosize parameters.\nVersion: 1.0.2\nAuthor: Beeliked\nAuthor URI: http://beeliked.com\nLicense: GPLv2 or later\nText Domain: beeliked\n*/\n\n/*\nThis program is free software; you can redistribute it and/or\nmodify it under the terms of the GNU General Public License\nas published by the Free Software Foundation; either version 2\nof the License, or (at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program; if not, write to the Free Software\nFoundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n*/\n\n\n/*\n1.0   - Initial release\n1.0.1 - Documentation change\n*/\n\ninclude (dirname (__FILE__).'/plugin.php');\n\nclass BeelikedMicrosite extends BeelikedMicrosite_Plugin\n{\n\tfunction BeelikedMicrosite ()\n\t{\n\t\t$this->register_plugin ('beelikedmicrosite', __FILE__);\n\t\t\n\t\t$this->add_action('template_redirect', 'load_js');\n\t\t\n\t\tadd_shortcode('BEELIKED_MICROSITE', array($this, 'embed_handler'));\n\t\t\n\t\t$this->add_filter('tiny_mce_version', array($this, 'refresh_mce'));\n\t\t$this->add_action('init', 'add_beeliked_button');\n\t\t\n\t\t$this->add_action('admin_print_footer_scripts', 'add_quicktags');\n\t}\n\t\n\t/* TINYMCE */\n\t\n\tfunction refresh_mce () \n\t{\n\t\t$ver += 3;\n\t\treturn $ver;\n\t}\n\t\n\tfunction add_beeliked_button() \n\t{\n      if ( ! current_user_can('edit_posts') && ! current_user_can('edit_pages') )\n        return;\n \n      // Add only in Rich Editor mode\n      //if ( get_user_option('rich_editing') == 'true') {\n        $this->add_filter(\"mce_external_plugins\", \"add_tinymce_plugin\");        \n\t\t$this->add_filter('mce_buttons', 'register_tinymce_button');\n\t\t\n      //}\n\t}\n\t\n\tfunction add_tinymce_plugin($plugin_array)\n\t{\n\t  $plugin_array['beelikedmicrosite'] = plugins_url('/js/editor_plugin.js', __file__);\n\t  return $plugin_array;\n\t}\n\t\n\tfunction register_tinymce_button($buttons)\n\t{\n\t  array_push($buttons, \"beelikedmicrosite\");\n      return $buttons;\n\t}\n\t\n\tfunction add_quicktags()\n\t{\n\t\tif (wp_script_is('quicktags'))\n\t\t{\n\t\t?>\n\t\t<script type=\"text/javascript\">\n\t\tQTags.addButton('beeliked_microsite', 'Beeliked Microsite', '[BEELIKED_MICROSITE url=\"', '\" width=\"100%\" height=\"1400px\" autosize=\"1\"]', '' );\n\t\t</script>\n\t\t<?php \n\t\t}\n\t}\n\t\n\t/* SHORTCODE */\n\t\n\tfunction load_js() \n\t{\n\t\twp_register_script('jquery_iframeResizer', plugins_url('/js/iframeResizer.min.js', __file__), array('jquery'));\t\t\n\t\twp_enqueue_script('jquery_iframeResizer');\n\t}\n\t\n\tprotected $iframeId = 0;\n\t\n\tfunction embed_handler($atts = array()) \n\t{\n\t\tshortcode_atts(array(\n\t\t\t'url' => 'http://beta.beeliked.com',\n\t\t\t'width' => '100%',\n\t\t\t'height' => '1400px',\n\t\t\t'autosize' => true\n\t\t), $atts);\n\t\t\n\t\t$autosize = $atts['autosize'] ? 1 : 0;\n\t\t\n\t\t$this->iframeId++;\n\t\t$return = \"<iframe load-url=\\\"{$atts['url']}\\\" id=\\\"bee-microsite-iframe-{$this->iframeId}\\\" class=\\\"bee-microsite-iframe\\\" width=\\\"{$atts['width']}\\\" height=\\\"{$atts['height']}\\\" data-autosize=\\\"{$autosize}\\\" frameborder=\\\"0\\\"></iframe>\n<script type=\\\"text/javascript\\\" src=\\\"http://beta.beeliked.com/microsite/js/beeliked.clientIframe.js\\\"></script>\n<script type=\\\"text/javascript\\\">jQuery(document).ready(function() { jQuery('.bee-microsite-iframe[data-autosize=1]').iFrameResize({heightCalculationMethod : 'max', checkOrigin: false}); });</script>\";\n\t\treturn $return;\n\t}\n}\n\n$beelikedMicrosite = new BeelikedMicrosite;\n?>\n"], "filenames": ["beelikedmicrosite.php"], "buggy_code_start_loc": [6], "buggy_code_end_loc": [123], "fixing_code_start_loc": [6], "fixing_code_end_loc": [123], "type": "CWE-79", "message": "A vulnerability has been found in Beeliked Microsite Plugin up to 1.0.1 on WordPress and classified as problematic. Affected by this vulnerability is the function embed_handler of the file beelikedmicrosite.php. The manipulation leads to cross site scripting. The attack can be launched remotely. Upgrading to version 1.0.2 is able to address this issue. The identifier of the patch is d23bafb5d05fb2636a2b78331f9d3fca152903dc. It is recommended to upgrade the affected component. The identifier VDB-233365 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2015-10121", "sourceIdentifier": "cna@vuldb.com", "published": "2023-07-10T16:15:47.357", "lastModified": "2024-02-29T01:16:12.260", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "A vulnerability has been found in Beeliked Microsite Plugin up to 1.0.1 on WordPress and classified as problematic. Affected by this vulnerability is the function embed_handler of the file beelikedmicrosite.php. The manipulation leads to cross site scripting. The attack can be launched remotely. Upgrading to version 1.0.2 is able to address this issue. The identifier of the patch is d23bafb5d05fb2636a2b78331f9d3fca152903dc. It is recommended to upgrade the affected component. The identifier VDB-233365 was assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:beeliked:beeliked:*:*:*:*:*:wordpress:*:*", "versionEndIncluding": "1.0.1", "matchCriteriaId": "920BC786-E114-44DB-BA9A-CF335E6559A2"}]}]}], "references": [{"url": "https://github.com/wp-plugins/beeliked-microsite/commit/d23bafb5d05fb2636a2b78331f9d3fca152903dc", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.233365", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory", "VDB Entry"]}, {"url": "https://vuldb.com/?id.233365", "source": "cna@vuldb.com", "tags": ["Third Party Advisory", "VDB Entry"]}]}, "github_commit_url": "https://github.com/wp-plugins/beeliked-microsite/commit/d23bafb5d05fb2636a2b78331f9d3fca152903dc"}}