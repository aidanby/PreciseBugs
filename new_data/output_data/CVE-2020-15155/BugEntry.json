{"buggy_code": ["<?php\n/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) baserCMS Users Community <https://basercms.net/community/>\n *\n * @copyright\t\tCopyright (c) baserCMS Users Community\n * @link\t\t\thttps://basercms.net baserCMS Project\n * @package\t\t\tBaser.View\n * @since\t\t\tbaserCMS v 4.1.0\n * @license\t\t\thttps://basercms.net/license/index.html\n */\n\n/**\n * [ADMIN] \u30c4\u30fc\u30eb\u30d0\u30fc\n */\n// JS\u306e\u51fa\u529b\u306b\u3064\u3044\u3066\u3001\u30c4\u30fc\u30eb\u30d0\u30fc\u306f\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u3067\u3082\u5229\u7528\u3059\u308b\u305f\u3081\u3001inline\u306b\u51fa\u529b\u3059\u308b\n$this->BcBaser->js(['admin/vendors/outerClick', 'admin/vendors/jquery.fixedMenu', 'admin/toolbar']);\nApp::uses('AuthComponent', 'Controller/Component');\n$loginUrl = '';\n$currentAuthPrefix = Configure::read('BcAuthPrefix.' . $currentPrefix);\nif (!empty($currentAuthPrefix['loginAction'])) {\n\t$loginUrl = preg_replace('/^\\//', '', $currentAuthPrefix['loginAction']);\n}\nif (in_array('admin', $currentUserAuthPrefixes)) {\n\t$logoutAction = Configure::read('BcAuthPrefix.admin.logoutAction');\n} else {\n\t$logoutAction = Hash::get((array)$currentAuthPrefix, 'logoutAction');\n}\nif (!empty($currentAuthPrefix['name']) && $currentPrefix != 'front') {\n\t$authName = $currentAuthPrefix['name'];\n} elseif (isset($this->BcBaser->siteConfig['formal_name'])) {\n\t$authName = $this->BcBaser->siteConfig['formal_name'];\n} else {\n\t$authName = '';\n}\n?>\n\n\n<div id=\"ToolBar\" class=\"bca-toolbar\">\n\t<div id=\"ToolbarInner\" class=\"clearfix bca-toolbar__body\">\n\t\t<div class=\"bca-toolbar__logo\">\n\t\t\t<?php\n\t\t\t\t# \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u753b\u9762\n\t\t\t\tif ($this->name == 'Installations'): ?>\n\t\t\t\t<?php $this->BcBaser->link(\n\t\t\t\t\t\t$this->BcBaser->getImg('admin/logo_icon.svg', ['alt' => '', 'width' => '24', 'height' => '21', 'class' => 'bca-toolbar__logo-symbol']) . \n\t\t\t\t        '<span class=\"bca-toolbar__logo-text\">' . __d('baser', '\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30de\u30cb\u30e5\u30a2\u30eb') . '</span>', \n                        'https://basercms.net/manuals/introductions/4.html', ['target' => '_blank', 'class' => 'bca-toolbar__logo-link']) ?>\n\t\t\t<?php\n\t\t\t\t# \u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u753b\u9762\n\t\t\t\telseif (Configure::read('BcRequest.isUpdater')): ?>\n\t\t\t\t<?php $this->BcBaser->link(\n\t\t\t\t\t\t$this->BcBaser->getImg('admin/logo_icon.svg', ['alt' => '', 'width' => '24', 'height' => '21', 'class' => 'bca-toolbar__logo-symbol']) .\n\t\t\t\t\t\t'<span class=\"bca-toolbar__logo-text\">' . __d('baser', '\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u30de\u30cb\u30e5\u30a2\u30eb') . '</span>', \n                        'https://basercms.net/manuals/introductions/8.html', ['target' => '_blank', 'class' => 'bca-toolbar__logo-link']) ?>\n\t\t\t<?php\n\t\t\t\t# \u901a\u5e38\n\t\t\t\telseif (!empty($this->request->params['admin']) || ('/' . $this->request->url) == $loginUrl): ?>\n\t\t\t\t<?php\n\t\t\t\t\t$this->BcBaser->link(\n\t\t\t\t\t\t$this->BcBaser->getImg('admin/logo_icon.svg', ['alt' => '', 'width' => '24', 'height' => '21', 'class' => 'bca-toolbar__logo-symbol'])\n\t\t\t\t\t\t\t.'<span class=\"bca-toolbar__logo-text\">'\n\t\t\t\t\t\t\t.$this->BcBaser->siteConfig['formal_name']\n\t\t\t\t\t\t\t.'</span>', '/'\n\t\t\t\t\t\t,\n\t\t\t\t\t\t['class' => 'bca-toolbar__logo-link']\n\t\t\t\t\t)\n\t\t\t\t?>\n\t\t\t<?php\n\t\t\t\telse: ?>\n\t\t\t\t<?php\n\t\t\t\t\t# \u7ba1\u7406\u753b\u9762\u306b\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u306a\u6a29\u9650\u304c\u3042\u308b\u5834\u5408\n\t\t\t\t\tif (in_array('admin', $currentUserAuthPrefixes)): ?>\n\t\t\t\t\t<?php\n\t\t\t\t\t$this->BcBaser->link(\n\t\t\t\t\t\t$this->BcBaser->getImg('admin/logo_icon.svg', ['alt' => '', 'width' => '24', 'height' => '21', 'class' => 'bca-toolbar__logo-symbol'])\n\t\t\t\t\t\t\t.'<span class=\"bca-toolbar__logo-text\">'\n\t\t\t\t\t\t\t.$this->BcBaser->siteConfig['formal_name']\n\t\t\t\t\t\t\t.'</span>', ['plugin' => null, 'admin' => true, 'controller' => 'dashboard', 'action' => 'index']\n\t\t\t\t\t\t,\n\t\t\t\t\t\t['class' => 'bca-toolbar__logo-link']\n\t\t\t\t\t)\n\t\t\t\t\t?>\n\t\t\t\t<?php\n\t\t\t\t# \u7ba1\u7406\u753b\u9762\u306b\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u304c\u306a\u3044\u5834\u5408\n\t\t\t\telse: ?>\n\t\t\t\t\t<?php $this->BcBaser->link($authName, Configure::read('BcAuthPrefix.' . $currentPrefix . '.loginRedirect'), ['title' => $authName]) ?>\n\t\t\t\t<?php endif ?>\n\t\t\t<?php endif ?>\n\t\t</div>\n\t\t<div id=\"ToolMenu\" class=\"bca-toolbar__tools\">\n\t\t\t<?php if ($this->BcBaser->existsEditLink() && !isset($this->request->query['preview'])): ?>\n\t\t\t\t<div class=\"bca-toolbar__tools-button bca-toolbar__tools-button-edit\">\n\t\t\t\t\t<?php $this->BcBaser->editLink() ?>\n\t\t\t\t</div>\n\t\t\t<?php endif ?>\n\t\t\t<?php if ($this->BcBaser->existsPublishLink()): ?>\n\t\t\t\t<div class=\"bca-toolbar__tools-button bca-toolbar__tools-button-publish\">\n\t\t\t\t\t<?php $this->BcBaser->publishLink() ?>\n\t\t\t\t</div>\n\t\t\t<?php endif ?>\n\t\t\t<?php if (!$loginUrl || $this->request->url != $loginUrl): ?>\n\t\t\t\t<div class=\"bca-toolbar__tools-mode\">\n\t\t\t\t\t<?php if (Configure::read('debug') == -1 && $this->name != \"Installations\"): ?>\n\t\t\t\t\t\t<span id=\"DebugMode\" class=\"bca-debug-mode\" title=\"<?php echo __d('baser', '\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30e2\u30fc\u30c9\u3067\u3059\u3002\u904b\u55b6\u3092\u958b\u59cb\u3059\u308b\u524d\u306b\u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u3088\u308a\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u3057\u307e\u3057\u3087\u3046\u3002') ?>\"><?php echo __d('baser', '\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30e2\u30fc\u30c9') ?></span>\n\t\t\t\t\t<?php elseif (Configure::read('debug') > 0): ?>\n\t\t\t\t\t\t<span id=\"DebugMode\" class=\"bca-debug-mode\" title=\"<?php echo __d('baser', '\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9\u3067\u3059\u3002\u904b\u55b6\u3092\u958b\u59cb\u3059\u308b\u524d\u306b\u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u3088\u308a\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u3057\u307e\u3057\u3087\u3046\u3002') ?>\"><?php echo __d('baser', '\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9') ?><?php echo mb_convert_kana(Configure::read('debug'), 'N') ?></span>\n\t\t\t\t\t<?php endif; ?>\n\t\t\t\t</div>\n\t\t\t<?php endif ?>\n\t\t</div>\n\t\t<div id=\"UserMenu\" class=\"bca-toolbar__users\">\n\t\t\t<ul class=\"clearfix\">\n\t\t\t\t<?php\n\t\t\t\t# TODO: \u304a\u6c17\u306b\u5165\u308a\u3092\u8868\u793a\uff08\u30b5\u30a4\u30c9\u30e1\u30cb\u30e5\u30fc\u3068\u306e\u30a4\u30d9\u30f3\u30c8\u51e6\u7406\u30fb\u540c\u671f\u30fb\u30b9\u30bf\u30a4\u30eb\u306e\u8abf\u6574\u3092\u691c\u8a0e\u4e2d\uff09\n\t\t\t\t# <li>\n\t\t\t\t# <a href=\"javascript:void(0)\" class=\"title\"><?php echo __d('baser', '\u304a\u6c17\u306b\u5165\u308a') ? ><img src=\"/theme/admin-third/img/admin/btn_dropdown.png\" width=\"8\" height=\"11\" class=\"bc-btn\"></a>\n\t\t\t\t#\t<div id=\"FavoriteArea\" hidden>\n\t\t\t\t#\t\t<?php $this->BcBaser->element('favorite_menu') ? >\n\t\t\t\t#\t\t<?php $this->BcBaser->element('permission') ? >\n\t\t\t\t#\t</div>\n\t\t\t\t#</li>\n\t\t\t\t?>\n\t\t\t\t<li>\n\t\t\t\t\t<?php if (!empty($user)): ?>\n\t\t\t\t\t\t<?php $this->BcBaser->link(h($this->BcBaser->getUserName($user)) . ' ' . $this->BcBaser->getImg('admin/btn_dropdown.png', ['width' => 8, 'height' => 11, 'class' => 'bc-btn']), 'javascript:void(0)', ['class' => 'title']) ?>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<?php if ($this->Session->check('AuthAgent')): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u5143\u306e\u30e6\u30fc\u30b6\u30fc\u306b\u623b\u308b'), ['admin' => false, 'plugin' => null, 'controller' => 'users', 'action' => 'back_agent']) ?></li>\n\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t<?php if (in_array('admin', $currentUserAuthPrefixes)): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30a2\u30ab\u30a6\u30f3\u30c8\u8a2d\u5b9a'), ['admin' => true, 'plugin' => null, 'controller' => 'users', 'action' => 'edit', $user['id']]) ?></li>\n\t\t\t\t\t\t\t<?php else: ?>\n                                <?php if ($currentPrefix != 'front'): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30a2\u30ab\u30a6\u30f3\u30c8\u8a2d\u5b9a'), [$currentPrefix => true, 'plugin' => null, 'controller' => 'users', 'action' => 'edit', $user['id']]) ?></li>\n\t\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a2\u30a6\u30c8'), $logoutAction) ?></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t<?php elseif ($this->name != 'Installations' && $this->request->url != $loginUrl && !Configure::read('BcRequest.isUpdater')): ?>\n\t\t\t\t\t\t<?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u307e\u305b\u3093 ') . $this->BcBaser->getImg('admin/btn_dropdown.png', ['width' => 8, 'height' => 11, 'class' => 'bc-btn']), 'javascript:void(0)', ['class' => 'title']) ?>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<?php if ($currentPrefix == 'front'): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a4\u30f3'), ['plugin' => null, 'controller' => 'users', 'action' => 'login']) ?></li>\n\t\t\t\t\t\t\t<?php else: ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a4\u30f3'), [$currentPrefix => true, 'plugin' => null, 'controller' => 'users', 'action' => 'login']) ?></li>\n\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t<?php endif ?>\n\t\t\t\t</li>\n\t\t\t\t<?php if (!empty($user) && in_array('admin', $currentUserAuthPrefixes)): ?>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<?php $this->BcBaser->link(__d('baser', '\u30ad\u30e3\u30c3\u30b7\u30e5\u30af\u30ea\u30a2'), ['admin' => true, 'plugin'=> false, 'controller' => 'site_configs', 'action' => 'del_cache'], ['confirm' => __d('baser', '\u30ad\u30e3\u30c3\u30b7\u30e5\u30af\u30ea\u30a2\u3057\u307e\u3059\u3002\u3044\u3044\u3067\u3059\u304b\uff1f')]) ?>\u3000\n\t\t\t\t\t</li>\n\t\t\t\t<?php endif ?>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n</div>\n", "<?php\n/**\n * baserCMS :  Based Website Development Project <http://basercms.net>\n * Copyright (c) baserCMS Users Community <http://basercms.net/community/>\n *\n * @copyright\t\tCopyright (c) baserCMS Users Community\n * @link\t\t\thttp://basercms.net baserCMS Project\n * @package\t\t\tBaser.View\n * @since\t\t\tbaserCMS v 2.0.0\n * @license\t\t\thttp://basercms.net/license/index.html\n */\n\n/**\n * [ADMIN] \u30c4\u30fc\u30eb\u30d0\u30fc\n * \n * @var BcAppView $this\n */\n// JS\u306e\u51fa\u529b\u306b\u3064\u3044\u3066\u3001\u30c4\u30fc\u30eb\u30d0\u30fc\u306f\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u3067\u3082\u5229\u7528\u3059\u308b\u305f\u3081\u3001inline\u306b\u51fa\u529b\u3059\u308b\n$this->BcBaser->js(['admin/vendors/outerClick', 'admin/vendors/jquery.fixedMenu', 'admin/toolbar']);\nApp::uses('AuthComponent', 'Controller/Component');\n$loginUrl = '';\n$currentAuthPrefix = Configure::read('BcAuthPrefix.' . $currentPrefix);\nif (!empty($currentAuthPrefix['loginAction'])) {\n\t$loginUrl = preg_replace('/^\\//', '', $currentAuthPrefix['loginAction']);\n}\nif (in_array('admin', $currentUserAuthPrefixes)) {\n\t$logoutAction = Configure::read('BcAuthPrefix.admin.logoutAction');\n} else {\n\t$logoutAction = $currentAuthPrefix['logoutAction'];\n}\nif (!empty($currentAuthPrefix['name']) && $currentPrefix != 'front') {\n\t$authName = $currentAuthPrefix['name'];\n} elseif (isset($this->BcBaser->siteConfig['formal_name'])) {\n\t$authName = $this->BcBaser->siteConfig['formal_name'];\n} else {\n\t$authName = '';\n}\n?>\n\n\n<div id=\"ToolBar\">\n\t<div id=\"ToolbarInner\" class=\"clearfix\">\n\t\t<div id=\"ToolMenu\">\n\t\t\t<ul>\n\t\t\t\t<?php if ($this->name == 'Installations'): ?>\n\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30de\u30cb\u30e5\u30a2\u30eb'), 'http://wiki.basercms.net/%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%82%AC%E3%82%A4%E3%83%89', ['target' => '_blank', 'class' => 'tool-menu']) ?></li>\n\t\t\t\t<?php elseif (Configure::read('BcRequest.isUpdater')): ?>\n\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u30de\u30cb\u30e5\u30a2\u30eb'), 'http://wiki.basercms.net/%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E3%82%AC%E3%82%A4%E3%83%89', ['target' => '_blank', 'class' => 'tool-menu']) ?></li>\n\t\t\t\t<?php elseif (!empty($this->request->params['admin']) || ('/' . $this->request->url) == $loginUrl): ?>\t\n\t\t\t\t\t<li><?php $this->BcBaser->link($this->BcBaser->siteConfig['formal_name'], '/') ?></li>\n\t\t\t\t<?php else: ?>\n\t\t\t\t\t<?php if (in_array('admin', $currentUserAuthPrefixes)): ?>\n\t\t\t\t\t\t<li><?php $this->BcBaser->link($this->BcBaser->getImg('admin/btn_logo.png', ['alt' => __d('baser', 'baserCMS\u7ba1\u7406\u30b7\u30b9\u30c6\u30e0'), 'class' => 'bc-btn']), ['plugin' => null, 'admin' => true, 'controller' => 'dashboard', 'action' => 'index'], ['title' => __d('baser', 'baserCMS\u7ba1\u7406\u30b7\u30b9\u30c6\u30e0')]) ?></li>\n\t\t\t\t\t<?php else: ?>\n\t\t\t\t\t\t<li><?php $this->BcBaser->link($authName, Configure::read('BcAuthPrefix.' . $currentPrefix . '.loginRedirect'), ['title' => $authName]) ?></li>\n\t\t\t\t\t<?php endif ?>\n\t\t\t\t<?php endif ?>\n\t\t\t\t<?php if ($this->BcBaser->existsEditLink() && !isset($this->request->query['preview'])): ?>\n\t\t\t\t\t<li><?php $this->BcBaser->editLink() ?></li>\n\t\t\t\t<?php endif ?>\n\t\t\t\t<?php if ($this->BcBaser->existsPublishLink()): ?>\n\t\t\t\t\t<li><?php $this->BcBaser->publishLink() ?></li>\n\t\t\t\t<?php endif ?>\n\t\t\t\t<?php if (!$loginUrl || $this->request->url != $loginUrl): ?>\n\t\t\t\t\t<?php if (Configure::read('debug') == -1 && $this->name != \"Installations\"): ?>\n\t\t\t\t\t\t<li>&nbsp;&nbsp;<span id=\"DebugMode\" title=\"<?php echo __d('baser', '\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30e2\u30fc\u30c9\u3067\u3059\u3002\u904b\u55b6\u3092\u958b\u59cb\u3059\u308b\u524d\u306b\u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u3088\u308a\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u3057\u307e\u3057\u3087\u3046\u3002') ?>\"><?php echo __d('baser', '\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30e2\u30fc\u30c9') ?></span>&nbsp;&nbsp;</li>\n\t\t\t\t\t<?php elseif (Configure::read('debug') > 0): ?>\n\t\t\t\t\t\t<li>&nbsp;&nbsp;<span id=\"DebugMode\" title=\"<?php echo __d('baser', '\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9\u3067\u3059\u3002\u904b\u55b6\u3092\u958b\u59cb\u3059\u308b\u524d\u306b\u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u3088\u308a\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u3057\u307e\u3057\u3087\u3046\u3002') ?>\"><?php echo __d('baser', '\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9') ?> <?php echo mb_convert_kana(Configure::read('debug'), 'N') ?></span>&nbsp;&nbsp;</li>\n\t\t\t\t\t<?php endif; ?>\n\t\t\t\t<?php endif ?>\n\t\t\t</ul>\n\t\t</div>\n\t\t<div id=\"UserMenu\">\n\t\t\t<ul class=\"clearfix\">\n\t\t\t\t<li>\n\t\t\t\t\t<?php if (!empty($user)): ?>\n\t\t\t\t\t\t<?php $this->BcBaser->link(h($this->BcBaser->getUserName($user)) . ' ' . $this->BcBaser->getImg('admin/btn_dropdown.png', ['width' => 8, 'height' => 11, 'class' => 'bc-btn']), 'javascript:void(0)', ['class' => 'title']) ?>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<?php if ($this->Session->check('AuthAgent')): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u5143\u306e\u30e6\u30fc\u30b6\u30fc\u306b\u623b\u308b'), '/users/back_agent') ?></li>\n\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t<?php if (in_array('admin', $currentUserAuthPrefixes)): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30a2\u30ab\u30a6\u30f3\u30c8\u8a2d\u5b9a'), ['admin' => true, 'plugin' => null, 'controller' => 'users', 'action' => 'edit', $user['id']]) ?></li>\n\t\t\t\t\t\t\t<?php else: ?>\n\t\t\t\t\t\t\t\t<?php if ($currentPrefix != 'front'): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30a2\u30ab\u30a6\u30f3\u30c8\u8a2d\u5b9a'), [$currentPrefix => true, 'plugin' => null, 'controller' => 'users', 'action' => 'edit', $user['id']]) ?></li>\n\t\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a2\u30a6\u30c8'), $logoutAction) ?></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t<?php elseif ($this->name != 'Installations' && $this->request->url != $loginUrl && !Configure::read('BcRequest.isUpdater')): ?>\n\t\t\t\t\t\t<?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u307e\u305b\u3093 ') . $this->BcBaser->getImg('admin/btn_dropdown.png', ['width' => 8, 'height' => 11, 'class' => 'bc-btn']), 'javascript:void(0)', ['class' => 'title']) ?>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<?php if ($currentPrefix == 'front'): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a4\u30f3'), ['plugin' => null, 'controller' => 'users', 'action' => 'login']) ?></li>\n\t\t\t\t\t\t\t<?php else: ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a4\u30f3'), [$currentPrefix => true, 'plugin' => null, 'controller' => 'users', 'action' => 'login']) ?></li>\n\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t<?php endif ?>\n\t\t\t\t</li>\n\t\t\t\t<?php if (!empty($user) && in_array('admin', $currentUserAuthPrefixes) && Configure::read('BcApp.adminNavi')): ?>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<?php $this->BcBaser->link(__d('baser', '\u30b7\u30b9\u30c6\u30e0\u30ca\u30d3') . ' ' . $this->BcBaser->getImg('admin/btn_dropdown.png', ['width' => 8, 'height' => 11, 'class' => 'bc-btn']), 'javascript:void(0)', ['class' => 'title']) ?>\n\t\t\t\t\t\t<div id=\"SystemMenu\"><div>\n\t\t\t\t\t\t\t\t<?php \n\t\t\t\t\t\t\t\t$adminSitemap = Configure::read('BcApp.adminNavi');\n\t\t\t\t\t\t\t\t$isAdminGlobalmenuUsed = $this->BcAdmin->isAdminGlobalmenuUsed();\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t<?php foreach ($adminSitemap as $key => $package): ?>\n\t\t\t\t\t\t\t\t\t<?php \n\t\t\t\t\t\t\t\t\tif(!$isAdminGlobalmenuUsed && $key == 'core') {\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<?php if (empty($package['name'])): ?>\n\t\t\t\t\t\t\t\t\t\t<?php $package['name'] = $key ?>\n\t\t\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t\t\t<h2><?php echo $package['name'] ?></h2>\n\t\t\t\t\t\t\t\t\t<?php if (!empty($package['contents'])): ?>\n\t\t\t\t\t\t\t\t\t\t<ul class=\"clearfix\">\n\t\t\t\t\t\t\t\t\t\t\t<?php foreach ($package['contents'] as $contents): ?>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\t\t$options =  ['title' => $contents['name']];\n\t\t\t\t\t\t\t\t\t\t\t\tif(!empty($contents['options'])){\n\t\t\t\t\t\t\t\t\t\t\t\t\t$options = array_merge($options, $contents['options']);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link($contents['name'], $contents['url'], $options) ?></li>\n\t\t\t\t\t\t\t\t\t\t\t<?php endforeach ?>\n\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t\t<?php endforeach ?>\n\t\t\t\t\t\t\t</div></div>\n\t\t\t\t\t</li>\n\t\t\t\t<?php endif ?>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n</div>\n"], "fixing_code": ["<?php\n/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) baserCMS Users Community <https://basercms.net/community/>\n *\n * @copyright\t\tCopyright (c) baserCMS Users Community\n * @link\t\t\thttps://basercms.net baserCMS Project\n * @package\t\t\tBaser.View\n * @since\t\t\tbaserCMS v 4.1.0\n * @license\t\t\thttps://basercms.net/license/index.html\n */\n\n/**\n * [ADMIN] \u30c4\u30fc\u30eb\u30d0\u30fc\n */\n// JS\u306e\u51fa\u529b\u306b\u3064\u3044\u3066\u3001\u30c4\u30fc\u30eb\u30d0\u30fc\u306f\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u3067\u3082\u5229\u7528\u3059\u308b\u305f\u3081\u3001inline\u306b\u51fa\u529b\u3059\u308b\n$this->BcBaser->js(['admin/vendors/outerClick', 'admin/vendors/jquery.fixedMenu', 'admin/toolbar']);\nApp::uses('AuthComponent', 'Controller/Component');\n$loginUrl = '';\n$currentAuthPrefix = Configure::read('BcAuthPrefix.' . $currentPrefix);\nif (!empty($currentAuthPrefix['loginAction'])) {\n\t$loginUrl = preg_replace('/^\\//', '', $currentAuthPrefix['loginAction']);\n}\nif (in_array('admin', $currentUserAuthPrefixes)) {\n\t$logoutAction = Configure::read('BcAuthPrefix.admin.logoutAction');\n} else {\n\t$logoutAction = Hash::get((array)$currentAuthPrefix, 'logoutAction');\n}\nif (!empty($currentAuthPrefix['name']) && $currentPrefix != 'front') {\n\t$authName = $currentAuthPrefix['name'];\n} elseif (isset($this->BcBaser->siteConfig['formal_name'])) {\n\t$authName = $this->BcBaser->siteConfig['formal_name'];\n} else {\n\t$authName = '';\n}\n?>\n\n\n<div id=\"ToolBar\" class=\"bca-toolbar\">\n\t<div id=\"ToolbarInner\" class=\"clearfix bca-toolbar__body\">\n\t\t<div class=\"bca-toolbar__logo\">\n\t\t\t<?php // \u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u753b\u9762 ?>\n\t\t\t<?php if ($this->name == 'Installations'): ?>\n\t\t\t\t<?php $this->BcBaser->link(\n\t\t\t\t\t\t$this->BcBaser->getImg('admin/logo_icon.svg', ['alt' => '', 'width' => '24', 'height' => '21', 'class' => 'bca-toolbar__logo-symbol']) . \n\t\t\t\t        '<span class=\"bca-toolbar__logo-text\">' . __d('baser', '\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30de\u30cb\u30e5\u30a2\u30eb') . '</span>', \n\t\t\t\t\t\t'https://basercms.net/manuals/introductions/4.html',\n\t\t\t\t\t\t['target' => '_blank', 'class' => 'bca-toolbar__logo-link']\n\t\t\t\t) ?>\n\t\t\t\t\t\t\n\t\t\t<?php // \u30d0\u30fc\u30b8\u30e7\u30f3\u30a2\u30c3\u30d7\u753b\u9762 ?>\n\t\t\t<?php elseif (Configure::read('BcRequest.isUpdater')): ?>\n\t\t\t\t<?php $this->BcBaser->link(\n\t\t\t\t\t\t$this->BcBaser->getImg('admin/logo_icon.svg', ['alt' => '', 'width' => '24', 'height' => '21', 'class' => 'bca-toolbar__logo-symbol']) .\n\t\t\t\t\t\t'<span class=\"bca-toolbar__logo-text\">' . __d('baser', '\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u30de\u30cb\u30e5\u30a2\u30eb') . '</span>', \n\t\t\t\t\t\t'https://basercms.net/manuals/introductions/8.html',\n\t\t\t\t\t\t['target' => '_blank', 'class' => 'bca-toolbar__logo-link']\n\t\t\t\t) ?>\n\t\t\t\t\t\t\n\t\t\t<?php // \u901a\u5e38\u7ba1\u7406\u753b\u9762 ?>\n\t\t\t<?php elseif (!empty($this->request->params['admin']) || ('/' . $this->request->url) == $loginUrl): ?>\n\t\t\t\t<?php\n\t\t\t\t\t$this->BcBaser->link(\n\t\t\t\t\t\t$this->BcBaser->getImg('admin/logo_icon.svg', ['alt' => '', 'width' => '24', 'height' => '21', 'class' => 'bca-toolbar__logo-symbol'])\n\t\t\t\t\t\t\t. '<span class=\"bca-toolbar__logo-text\">'\n\t\t\t\t\t\t\t. h($this->BcBaser->siteConfig['formal_name'])\n\t\t\t\t\t\t\t. '</span>', '/'\n\t\t\t\t\t\t,\n\t\t\t\t\t\t['class' => 'bca-toolbar__logo-link']\n\t\t\t\t\t)\n\t\t\t\t?>\n\t\t\t\t\n\t\t\t<?php // \u516c\u958b\u753b\u9762 ?>\n\t\t\t<?php else: ?>\n\t\t\t\t<?php // \u7ba1\u7406\u753b\u9762\u306b\u30a2\u30af\u30bb\u30b9\u53ef\u80fd\u306a\u6a29\u9650\u304c\u3042\u308b\u5834\u5408 ?>\n\t\t\t\t<?php if (in_array('admin', $currentUserAuthPrefixes)): ?>\n\t\t\t\t\t<?php\n\t\t\t\t\t$this->BcBaser->link(\n\t\t\t\t\t\t$this->BcBaser->getImg('admin/logo_icon.svg', ['alt' => '', 'width' => '24', 'height' => '21', 'class' => 'bca-toolbar__logo-symbol'])\n\t\t\t\t\t\t\t. '<span class=\"bca-toolbar__logo-text\">'\n\t\t\t\t\t\t\t. h($this->BcBaser->siteConfig['formal_name'])\n\t\t\t\t\t\t\t. '</span>', ['plugin' => null, 'admin' => true, 'controller' => 'dashboard', 'action' => 'index']\n\t\t\t\t\t\t,\n\t\t\t\t\t\t['class' => 'bca-toolbar__logo-link']\n\t\t\t\t\t)\n\t\t\t\t\t?>\n\t\t\t\t<?php // \u7ba1\u7406\u753b\u9762\u306b\u30a2\u30af\u30bb\u30b9\u6a29\u9650\u304c\u306a\u3044\u5834\u5408 ?>\n\t\t\t\t<?php else: ?>\n\t\t\t\t\t<?php $this->BcBaser->link(h($authName), Configure::read('BcAuthPrefix.' . $currentPrefix . '.loginRedirect'), ['title' => h($authName)]) ?>\n\t\t\t\t<?php endif ?>\n\t\t\t<?php endif ?>\n\t\t</div>\n\t\t<div id=\"ToolMenu\" class=\"bca-toolbar__tools\">\n\t\t\t<?php if ($this->BcBaser->existsEditLink() && !isset($this->request->query['preview'])): ?>\n\t\t\t\t<div class=\"bca-toolbar__tools-button bca-toolbar__tools-button-edit\">\n\t\t\t\t\t<?php $this->BcBaser->editLink() ?>\n\t\t\t\t</div>\n\t\t\t<?php endif ?>\n\t\t\t<?php if ($this->BcBaser->existsPublishLink()): ?>\n\t\t\t\t<div class=\"bca-toolbar__tools-button bca-toolbar__tools-button-publish\">\n\t\t\t\t\t<?php $this->BcBaser->publishLink() ?>\n\t\t\t\t</div>\n\t\t\t<?php endif ?>\n\t\t\t<?php if (!$loginUrl || $this->request->url != $loginUrl): ?>\n\t\t\t\t<div class=\"bca-toolbar__tools-mode\">\n\t\t\t\t\t<?php if (Configure::read('debug') == -1 && $this->name != \"Installations\"): ?>\n\t\t\t\t\t\t<span id=\"DebugMode\" class=\"bca-debug-mode\" title=\"<?php echo __d('baser', '\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30e2\u30fc\u30c9\u3067\u3059\u3002\u904b\u55b6\u3092\u958b\u59cb\u3059\u308b\u524d\u306b\u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u3088\u308a\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u3057\u307e\u3057\u3087\u3046\u3002') ?>\"><?php echo __d('baser', '\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30e2\u30fc\u30c9') ?></span>\n\t\t\t\t\t<?php elseif (Configure::read('debug') > 0): ?>\n\t\t\t\t\t\t<span id=\"DebugMode\" class=\"bca-debug-mode\" title=\"<?php echo __d('baser', '\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9\u3067\u3059\u3002\u904b\u55b6\u3092\u958b\u59cb\u3059\u308b\u524d\u306b\u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u3088\u308a\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u3057\u307e\u3057\u3087\u3046\u3002') ?>\"><?php echo __d('baser', '\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9') ?><?php echo mb_convert_kana(Configure::read('debug'), 'N') ?></span>\n\t\t\t\t\t<?php endif; ?>\n\t\t\t\t</div>\n\t\t\t<?php endif ?>\n\t\t</div>\n\t\t<div id=\"UserMenu\" class=\"bca-toolbar__users\">\n\t\t\t<ul class=\"clearfix\">\n\t\t\t\t<?php\n\t\t\t\t/**\n\t\t\t\t * TODO: \u304a\u6c17\u306b\u5165\u308a\u3092\u8868\u793a\uff08\u30b5\u30a4\u30c9\u30e1\u30cb\u30e5\u30fc\u3068\u306e\u30a4\u30d9\u30f3\u30c8\u51e6\u7406\u30fb\u540c\u671f\u30fb\u30b9\u30bf\u30a4\u30eb\u306e\u8abf\u6574\u3092\u691c\u8a0e\u4e2d\uff09\n\t\t\t\t * <li>\n\t\t\t\t * <a href=\"javascript:void(0)\" class=\"title\"><?php echo __d('baser', '\u304a\u6c17\u306b\u5165\u308a') ? ><img src=\"/theme/admin-third/img/admin/btn_dropdown.png\" width=\"8\" height=\"11\" class=\"bc-btn\"></a>\n\t\t\t\t * \t<div id=\"FavoriteArea\" hidden>\n\t\t\t\t * \t\t<?php $this->BcBaser->element('favorite_menu') ? >\n\t\t\t\t * \t\t<?php $this->BcBaser->element('permission') ? >\n\t\t\t\t * \t</div>\n\t\t\t\t * </li>\n\t\t\t\t */\n\t\t\t\t?>\n\t\t\t\t<li>\n\t\t\t\t\t<?php if (!empty($user)): ?>\n\t\t\t\t\t\t<?php $this->BcBaser->link(h($this->BcBaser->getUserName($user)) . ' ' . $this->BcBaser->getImg('admin/btn_dropdown.png', ['width' => 8, 'height' => 11, 'class' => 'bc-btn']), 'javascript:void(0)', ['class' => 'title']) ?>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<?php if ($this->Session->check('AuthAgent')): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u5143\u306e\u30e6\u30fc\u30b6\u30fc\u306b\u623b\u308b'), ['admin' => false, 'plugin' => null, 'controller' => 'users', 'action' => 'back_agent']) ?></li>\n\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t<?php if (in_array('admin', $currentUserAuthPrefixes)): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30a2\u30ab\u30a6\u30f3\u30c8\u8a2d\u5b9a'), ['admin' => true, 'plugin' => null, 'controller' => 'users', 'action' => 'edit', $user['id']]) ?></li>\n\t\t\t\t\t\t\t<?php else: ?>\n                                <?php if ($currentPrefix != 'front'): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30a2\u30ab\u30a6\u30f3\u30c8\u8a2d\u5b9a'), [$currentPrefix => true, 'plugin' => null, 'controller' => 'users', 'action' => 'edit', $user['id']]) ?></li>\n\t\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a2\u30a6\u30c8'), $logoutAction) ?></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t<?php elseif ($this->name != 'Installations' && $this->request->url != $loginUrl && !Configure::read('BcRequest.isUpdater')): ?>\n\t\t\t\t\t\t<?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u307e\u305b\u3093 ') . $this->BcBaser->getImg('admin/btn_dropdown.png', ['width' => 8, 'height' => 11, 'class' => 'bc-btn']), 'javascript:void(0)', ['class' => 'title']) ?>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<?php if ($currentPrefix == 'front'): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a4\u30f3'), ['plugin' => null, 'controller' => 'users', 'action' => 'login']) ?></li>\n\t\t\t\t\t\t\t<?php else: ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a4\u30f3'), [$currentPrefix => true, 'plugin' => null, 'controller' => 'users', 'action' => 'login']) ?></li>\n\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t<?php endif ?>\n\t\t\t\t</li>\n\t\t\t\t<?php if (!empty($user) && in_array('admin', $currentUserAuthPrefixes)): ?>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<?php $this->BcBaser->link(__d('baser', '\u30ad\u30e3\u30c3\u30b7\u30e5\u30af\u30ea\u30a2'), ['admin' => true, 'plugin'=> false, 'controller' => 'site_configs', 'action' => 'del_cache'], ['confirm' => __d('baser', '\u30ad\u30e3\u30c3\u30b7\u30e5\u30af\u30ea\u30a2\u3057\u307e\u3059\u3002\u3044\u3044\u3067\u3059\u304b\uff1f')]) ?>\u3000\n\t\t\t\t\t</li>\n\t\t\t\t<?php endif ?>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n</div>\n", "<?php\n/**\n * baserCMS :  Based Website Development Project <http://basercms.net>\n * Copyright (c) baserCMS Users Community <http://basercms.net/community/>\n *\n * @copyright\t\tCopyright (c) baserCMS Users Community\n * @link\t\t\thttp://basercms.net baserCMS Project\n * @package\t\t\tBaser.View\n * @since\t\t\tbaserCMS v 2.0.0\n * @license\t\t\thttp://basercms.net/license/index.html\n */\n\n/**\n * [ADMIN] \u30c4\u30fc\u30eb\u30d0\u30fc\n * \n * @var BcAppView $this\n */\n// JS\u306e\u51fa\u529b\u306b\u3064\u3044\u3066\u3001\u30c4\u30fc\u30eb\u30d0\u30fc\u306f\u30d5\u30ed\u30f3\u30c8\u30a8\u30f3\u30c9\u3067\u3082\u5229\u7528\u3059\u308b\u305f\u3081\u3001inline\u306b\u51fa\u529b\u3059\u308b\n$this->BcBaser->js(['admin/vendors/outerClick', 'admin/vendors/jquery.fixedMenu', 'admin/toolbar']);\nApp::uses('AuthComponent', 'Controller/Component');\n$loginUrl = '';\n$currentAuthPrefix = Configure::read('BcAuthPrefix.' . $currentPrefix);\nif (!empty($currentAuthPrefix['loginAction'])) {\n\t$loginUrl = preg_replace('/^\\//', '', $currentAuthPrefix['loginAction']);\n}\nif (in_array('admin', $currentUserAuthPrefixes)) {\n\t$logoutAction = Configure::read('BcAuthPrefix.admin.logoutAction');\n} else {\n\t$logoutAction = $currentAuthPrefix['logoutAction'];\n}\nif (!empty($currentAuthPrefix['name']) && $currentPrefix != 'front') {\n\t$authName = $currentAuthPrefix['name'];\n} elseif (isset($this->BcBaser->siteConfig['formal_name'])) {\n\t$authName = $this->BcBaser->siteConfig['formal_name'];\n} else {\n\t$authName = '';\n}\n?>\n\n\n<div id=\"ToolBar\">\n\t<div id=\"ToolbarInner\" class=\"clearfix\">\n\t\t<div id=\"ToolMenu\">\n\t\t\t<ul>\n\t\t\t\t<?php if ($this->name == 'Installations'): ?>\n\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30de\u30cb\u30e5\u30a2\u30eb'), 'http://wiki.basercms.net/%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%82%AC%E3%82%A4%E3%83%89', ['target' => '_blank', 'class' => 'tool-menu']) ?></li>\n\t\t\t\t<?php elseif (Configure::read('BcRequest.isUpdater')): ?>\n\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30a2\u30c3\u30d7\u30c7\u30fc\u30c8\u30de\u30cb\u30e5\u30a2\u30eb'), 'http://wiki.basercms.net/%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3%E3%82%A2%E3%83%83%E3%83%97%E3%82%AC%E3%82%A4%E3%83%89', ['target' => '_blank', 'class' => 'tool-menu']) ?></li>\n\t\t\t\t<?php elseif (!empty($this->request->params['admin']) || ('/' . $this->request->url) == $loginUrl): ?>\t\n\t\t\t\t\t<li><?php $this->BcBaser->link($this->BcBaser->siteConfig['formal_name'], '/', ['escape' => true]) ?></li>\n\t\t\t\t<?php else: ?>\n\t\t\t\t\t<?php if (in_array('admin', $currentUserAuthPrefixes)): ?>\n\t\t\t\t\t\t<li><?php $this->BcBaser->link($this->BcBaser->getImg('admin/btn_logo.png', ['alt' => __d('baser', 'baserCMS\u7ba1\u7406\u30b7\u30b9\u30c6\u30e0'), 'class' => 'bc-btn']), ['plugin' => null, 'admin' => true, 'controller' => 'dashboard', 'action' => 'index'], ['title' => __d('baser', 'baserCMS\u7ba1\u7406\u30b7\u30b9\u30c6\u30e0')]) ?></li>\n\t\t\t\t\t<?php else: ?>\n\t\t\t\t\t\t<li><?php $this->BcBaser->link($authName, Configure::read('BcAuthPrefix.' . $currentPrefix . '.loginRedirect'), ['title' => $authName, 'escape' => ture]) ?></li>\n\t\t\t\t\t<?php endif ?>\n\t\t\t\t<?php endif ?>\n\t\t\t\t<?php if ($this->BcBaser->existsEditLink() && !isset($this->request->query['preview'])): ?>\n\t\t\t\t\t<li><?php $this->BcBaser->editLink() ?></li>\n\t\t\t\t<?php endif ?>\n\t\t\t\t<?php if ($this->BcBaser->existsPublishLink()): ?>\n\t\t\t\t\t<li><?php $this->BcBaser->publishLink() ?></li>\n\t\t\t\t<?php endif ?>\n\t\t\t\t<?php if (!$loginUrl || $this->request->url != $loginUrl): ?>\n\t\t\t\t\t<?php if (Configure::read('debug') == -1 && $this->name != \"Installations\"): ?>\n\t\t\t\t\t\t<li>&nbsp;&nbsp;<span id=\"DebugMode\" title=\"<?php echo __d('baser', '\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30e2\u30fc\u30c9\u3067\u3059\u3002\u904b\u55b6\u3092\u958b\u59cb\u3059\u308b\u524d\u306b\u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u3088\u308a\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u3057\u307e\u3057\u3087\u3046\u3002') ?>\"><?php echo __d('baser', '\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30e2\u30fc\u30c9') ?></span>&nbsp;&nbsp;</li>\n\t\t\t\t\t<?php elseif (Configure::read('debug') > 0): ?>\n\t\t\t\t\t\t<li>&nbsp;&nbsp;<span id=\"DebugMode\" title=\"<?php echo __d('baser', '\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9\u3067\u3059\u3002\u904b\u55b6\u3092\u958b\u59cb\u3059\u308b\u524d\u306b\u30b7\u30b9\u30c6\u30e0\u8a2d\u5b9a\u3088\u308a\u30ce\u30fc\u30de\u30eb\u30e2\u30fc\u30c9\u306b\u623b\u3057\u307e\u3057\u3087\u3046\u3002') ?>\"><?php echo __d('baser', '\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9') ?> <?php echo mb_convert_kana(Configure::read('debug'), 'N') ?></span>&nbsp;&nbsp;</li>\n\t\t\t\t\t<?php endif; ?>\n\t\t\t\t<?php endif ?>\n\t\t\t</ul>\n\t\t</div>\n\t\t<div id=\"UserMenu\">\n\t\t\t<ul class=\"clearfix\">\n\t\t\t\t<li>\n\t\t\t\t\t<?php if (!empty($user)): ?>\n\t\t\t\t\t\t<?php $this->BcBaser->link(h($this->BcBaser->getUserName($user)) . ' ' . $this->BcBaser->getImg('admin/btn_dropdown.png', ['width' => 8, 'height' => 11, 'class' => 'bc-btn']), 'javascript:void(0)', ['class' => 'title']) ?>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<?php if ($this->Session->check('AuthAgent')): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u5143\u306e\u30e6\u30fc\u30b6\u30fc\u306b\u623b\u308b'), '/users/back_agent') ?></li>\n\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t<?php if (in_array('admin', $currentUserAuthPrefixes)): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30a2\u30ab\u30a6\u30f3\u30c8\u8a2d\u5b9a'), ['admin' => true, 'plugin' => null, 'controller' => 'users', 'action' => 'edit', $user['id']]) ?></li>\n\t\t\t\t\t\t\t<?php else: ?>\n\t\t\t\t\t\t\t\t<?php if ($currentPrefix != 'front'): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30a2\u30ab\u30a6\u30f3\u30c8\u8a2d\u5b9a'), [$currentPrefix => true, 'plugin' => null, 'controller' => 'users', 'action' => 'edit', $user['id']]) ?></li>\n\t\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a2\u30a6\u30c8'), $logoutAction) ?></li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t<?php elseif ($this->name != 'Installations' && $this->request->url != $loginUrl && !Configure::read('BcRequest.isUpdater')): ?>\n\t\t\t\t\t\t<?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a4\u30f3\u3057\u3066\u3044\u307e\u305b\u3093 ') . $this->BcBaser->getImg('admin/btn_dropdown.png', ['width' => 8, 'height' => 11, 'class' => 'bc-btn']), 'javascript:void(0)', ['class' => 'title']) ?>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t<?php if ($currentPrefix == 'front'): ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a4\u30f3'), ['plugin' => null, 'controller' => 'users', 'action' => 'login']) ?></li>\n\t\t\t\t\t\t\t<?php else: ?>\n\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link(__d('baser', '\u30ed\u30b0\u30a4\u30f3'), [$currentPrefix => true, 'plugin' => null, 'controller' => 'users', 'action' => 'login']) ?></li>\n\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t<?php endif ?>\n\t\t\t\t</li>\n\t\t\t\t<?php if (!empty($user) && in_array('admin', $currentUserAuthPrefixes) && Configure::read('BcApp.adminNavi')): ?>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<?php $this->BcBaser->link(__d('baser', '\u30b7\u30b9\u30c6\u30e0\u30ca\u30d3') . ' ' . $this->BcBaser->getImg('admin/btn_dropdown.png', ['width' => 8, 'height' => 11, 'class' => 'bc-btn']), 'javascript:void(0)', ['class' => 'title']) ?>\n\t\t\t\t\t\t<div id=\"SystemMenu\"><div>\n\t\t\t\t\t\t\t\t<?php \n\t\t\t\t\t\t\t\t$adminSitemap = Configure::read('BcApp.adminNavi');\n\t\t\t\t\t\t\t\t$isAdminGlobalmenuUsed = $this->BcAdmin->isAdminGlobalmenuUsed();\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t<?php foreach ($adminSitemap as $key => $package): ?>\n\t\t\t\t\t\t\t\t\t<?php \n\t\t\t\t\t\t\t\t\tif(!$isAdminGlobalmenuUsed && $key == 'core') {\n\t\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<?php if (empty($package['name'])): ?>\n\t\t\t\t\t\t\t\t\t\t<?php $package['name'] = $key ?>\n\t\t\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t\t\t<h2><?php echo $package['name'] ?></h2>\n\t\t\t\t\t\t\t\t\t<?php if (!empty($package['contents'])): ?>\n\t\t\t\t\t\t\t\t\t\t<ul class=\"clearfix\">\n\t\t\t\t\t\t\t\t\t\t\t<?php foreach ($package['contents'] as $contents): ?>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\t\t$options =  ['title' => $contents['name']];\n\t\t\t\t\t\t\t\t\t\t\t\tif(!empty($contents['options'])){\n\t\t\t\t\t\t\t\t\t\t\t\t\t$options = array_merge($options, $contents['options']);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t\t<li><?php $this->BcBaser->link($contents['name'], $contents['url'], $options) ?></li>\n\t\t\t\t\t\t\t\t\t\t\t<?php endforeach ?>\n\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t<?php endif ?>\n\t\t\t\t\t\t\t\t<?php endforeach ?>\n\t\t\t\t\t\t\t</div></div>\n\t\t\t\t\t</li>\n\t\t\t\t<?php endif ?>\n\t\t\t</ul>\n\t\t</div>\n\t</div>\n</div>\n"], "filenames": ["app/webroot/theme/admin-third/Elements/admin/toolbar.php", "lib/Baser/View/Elements/admin/toolbar.php"], "buggy_code_start_loc": [42, 50], "buggy_code_end_loc": [123, 56], "fixing_code_start_loc": [42, 50], "fixing_code_end_loc": [127, 56], "type": "CWE-79", "message": "baserCMS 4.3.6 and earlier is affected by Cross Site Scripting (XSS) via arbitrary script execution. Admin access is required to exploit this vulnerability. The affected components is toolbar.php. The issue is fixed in version 4.3.7.", "other": {"cve": {"id": "CVE-2020-15155", "sourceIdentifier": "security-advisories@github.com", "published": "2020-08-28T22:15:10.563", "lastModified": "2020-09-03T14:22:12.027", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "baserCMS 4.3.6 and earlier is affected by Cross Site Scripting (XSS) via arbitrary script execution. Admin access is required to exploit this vulnerability. The affected components is toolbar.php. The issue is fixed in version 4.3.7."}, {"lang": "es", "value": "baserCMS versiones 4.3.6 y anteriores, esta afectado por una vulnerabilidad de tipo Cross Site Scripting (XSS) por medio de la ejecuci\u00f3n de un script arbitrario. Se requiere acceso de administrador para explotar esta vulnerabilidad. El componente afectado es el archivo toolbar.php. El problema es corregido en la versi\u00f3n 4.3.7"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.0, "impactScore": 5.8}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.0, "impactScore": 5.8}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:H/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "HIGH", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 2.1}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:basercms:basercms:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.3.6", "matchCriteriaId": "3D8C0605-796C-4AA8-ACD8-1444D95A121B"}]}]}], "references": [{"url": "https://basercms.net/security/20200827", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/baserproject/basercms/commit/94cbfab74c9fd6d04492597a1a684674c3c0e30f", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/baserproject/basercms/security/advisories/GHSA-4r3m-j6x5-48m3", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/baserproject/basercms/commit/94cbfab74c9fd6d04492597a1a684674c3c0e30f"}}