{"buggy_code": ["<% if helpers.asset_available?(\"spina/view_template_previews/#{@page.view_template}.png\") %>\n  <div class=\"relative\" data-controller=\"reveal\" data-reveal-away-value>\n    <button type=\"button\" class=\"btn text-gray-400 border-none hover:text-gray-700\" data-action=\"reveal#toggle\">\n      <%= helpers.heroicon('eye', style: :solid, class: 'w-4 h-4 mr-2') %>\n      <%=t 'spina.pages.preview' %>\n    </button>\n    \n    <div class=\"absolute left-1/2 transform -translate-x-1/2\">\n      <div hidden data-reveal data-transition class=\"w-60 bg-white shadow-lg rounded-md\">\n        <%= image_tag \"spina/view_template_previews/#{@page.view_template}.png\", class: \"block w-full rounded-md\" %>\n      </div>\n    </div>\n  </div>\n<% end %>\n\n<!-- Advanced actions -->\n<div class=\"relative w-1/2 md:w-auto\" data-controller=\"reveal\" data-reveal-away-value>\n  <button type=\"button\" class=\"btn btn-default px-3 w-full\" data-action=\"reveal#toggle\">\n    <svg class=\"w-5 h-5 text-gray-600\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n      <path d=\"M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z\" />\n    </svg>\n  </button>\n\n  <div hidden data-reveal data-transition class=\"origin-top-left md:origin-top-right absolute md:right-0 mt-2 w-56 rounded-md shadow-lg border border-gray-200\">\n    <div class=\"rounded-md bg-white shadow-xs\">\n      <div class=\"py-1\">\n        \n        <% unless @page.homepage? %>\n          <%= link_to t('spina.pages.move_page') + \"...\", helpers.spina.new_admin_page_move_path(@page), class: \"block px-4 py-2 text-sm font-medium leading-5 text-gray-700 hover:bg-gray-100 hover:text-gray-900 focus:outline-none focus:bg-gray-100 focus:text-gray-900\", data: {turbo_frame: \"modal\", action: \"reveal#hide\"} %>\n        <% end %>\n        \n        <% if !@page.custom_page? %>\n          <%= link_to t('spina.pages.change_view_template') + \"...\", helpers.spina.edit_template_admin_page_path(@page), class: \"block px-4 py-2 text-sm font-medium leading-5 text-gray-700 hover:bg-gray-100 hover:text-gray-900 focus:outline-none focus:bg-gray-100 focus:text-gray-900\", data: {turbo_frame: \"modal\", action: \"reveal#hide\"} %>\n        <% end %>\n        \n        <% if @locale.to_sym != I18n.locale.to_sym %>\n          <% @page.translations.where(locale: @locale).each do |translation| %>\n            <%= button_to t(\"spina.page_translations.delete\", translation: @locale.upcase), helpers.spina.admin_page_translation_path(translation), method: :delete, class: \"block w-full text-left px-4 py-2 text-sm leading-5 font-medium text-red-500 cursor-pointer bg-white hover:bg-red-100 hover:bg-opacity-50 hover:text-red-500 focus:outline-none focus:bg-gray-100 focus:text-gray-900\", form: {data: {controller: \"confirm\", confirm_message: t('spina.page_translations.delete_confirmation', subject: @locale.upcase)}} %>\n          <% end %>\n        <% end %>\n        \n        <% if @page.deletable? %>\n          <%= button_to t('spina.pages.delete'), helpers.spina.admin_page_path(@page), method: :delete, class: \"block w-full text-left px-4 py-2 text-sm leading-5 font-medium text-red-500 cursor-pointer bg-white hover:bg-red-100 hover:bg-opacity-50 hover:text-red-500 focus:outline-none focus:bg-gray-100 focus:text-gray-900\", form: {data: {controller: \"confirm\", confirm_message: t('spina.pages.delete_confirmation', subject: @page.title)}} %>\n        <% else %>\n          <span class=\"block px-4 py-2 text-sm leading-5 text-gray-400\"><%=t 'spina.pages.cannot_be_deleted' %></span>\n        <% end %>\n      </div>\n    </div>\n  </div>\n</div>\n\n<!-- Translations -->\n<%= render Spina::Pages::TranslationsComponent.new(@page, label: @locale.upcase) %>\n\n<button type=\"submit\" form=\"<%= dom_id(@page) %>\" class=\"btn btn-primary w-1/2 md:w-auto\" data-controller=\"button hotkeys\" data-hotkeys=\"command+s, ctrl+s\" data-hotkeys-target=\"button\" data-action=\"button#loading\" data-loading-message=\"Saving...\">\n  <%= helpers.heroicon('check', style: :mini, class: 'w-5 h-5 -ml-1 mr-1') %>\n  <% if @page.draft? %>\n    <%=t 'spina.pages.save_draft' %>\n  <% else %>\n    <%=t 'spina.pages.save_changes' %>\n  <% end %>\n</button>\n\n<!-- Saving -->\n<% if @page.persisted? && @page.draft? %>\n  <button type=\"submit\" form=\"<%= dom_id(@page) %>\" name=\"page[draft]\" value=\"false\" class=\"btn bg-emerald-500 hover:bg-emerald-600 border-emerald-600 text-white flex items-center\" data-controller=\"hotkeys\" data-hotkeys=\"control+command+s\" data-hotkeys-target=\"button\">\n    <%= helpers.heroicon('cursor-arrow-rays', style: :solid, class: \"w-5 h-5 -ml-1 mr-1\") %>\n    <%=t 'spina.pages.publish' %>\n  </button>\n<% end %>\n"], "fixing_code": ["<% if helpers.asset_available?(\"spina/view_template_previews/#{@page.view_template}.png\") %>\n  <div class=\"relative\" data-controller=\"reveal\" data-reveal-away-value>\n    <button type=\"button\" class=\"btn text-gray-400 border-none hover:text-gray-700\" data-action=\"reveal#toggle\">\n      <%= helpers.heroicon('eye', style: :solid, class: 'w-4 h-4 mr-2') %>\n      <%=t 'spina.pages.preview' %>\n    </button>\n    \n    <div class=\"absolute left-1/2 transform -translate-x-1/2\">\n      <div hidden data-reveal data-transition class=\"w-60 bg-white shadow-lg rounded-md\">\n        <%= image_tag \"spina/view_template_previews/#{@page.view_template}.png\", class: \"block w-full rounded-md\" %>\n      </div>\n    </div>\n  </div>\n<% end %>\n\n<!-- Advanced actions -->\n<div class=\"relative w-1/2 md:w-auto\" data-controller=\"reveal\" data-reveal-away-value>\n  <button type=\"button\" class=\"btn btn-default px-3 w-full\" data-action=\"reveal#toggle\">\n    <svg class=\"w-5 h-5 text-gray-600\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n      <path d=\"M6 10a2 2 0 11-4 0 2 2 0 014 0zM12 10a2 2 0 11-4 0 2 2 0 014 0zM16 12a2 2 0 100-4 2 2 0 000 4z\" />\n    </svg>\n  </button>\n\n  <div hidden data-reveal data-transition class=\"origin-top-left md:origin-top-right absolute md:right-0 mt-2 w-56 rounded-md shadow-lg border border-gray-200\">\n    <div class=\"rounded-md bg-white shadow-xs\">\n      <div class=\"py-1\">\n        \n        <% unless @page.homepage? %>\n          <%= link_to t('spina.pages.move_page') + \"...\", helpers.spina.new_admin_page_move_path(@page), class: \"block px-4 py-2 text-sm font-medium leading-5 text-gray-700 hover:bg-gray-100 hover:text-gray-900 focus:outline-none focus:bg-gray-100 focus:text-gray-900\", data: {turbo_frame: \"modal\", action: \"reveal#hide\"} %>\n        <% end %>\n        \n        <% if !@page.custom_page? %>\n          <%= link_to t('spina.pages.change_view_template') + \"...\", helpers.spina.edit_template_admin_page_path(@page), class: \"block px-4 py-2 text-sm font-medium leading-5 text-gray-700 hover:bg-gray-100 hover:text-gray-900 focus:outline-none focus:bg-gray-100 focus:text-gray-900\", data: {turbo_frame: \"modal\", action: \"reveal#hide\"} %>\n        <% end %>\n        \n        <% if @locale.to_sym != I18n.locale.to_sym %>\n          <% @page.translations.where(locale: @locale).each do |translation| %>\n            <%= button_to t(\"spina.page_translations.delete\", translation: @locale.upcase), helpers.spina.admin_page_translation_path(translation), method: :delete, class: \"block w-full text-left px-4 py-2 text-sm leading-5 font-medium text-red-500 cursor-pointer bg-white hover:bg-red-100 hover:bg-opacity-50 hover:text-red-500 focus:outline-none focus:bg-gray-100 focus:text-gray-900\", form: {data: {controller: \"confirm\", confirm_message: t('spina.page_translations.delete_confirmation', subject: @locale.upcase)}} %>\n          <% end %>\n        <% end %>\n        \n        <% if @page.deletable? %>\n          <%= button_to t('spina.pages.delete'), helpers.spina.admin_page_path(@page), method: :delete, class: \"block w-full text-left px-4 py-2 text-sm leading-5 font-medium text-red-500 cursor-pointer bg-white hover:bg-red-100 hover:bg-opacity-50 hover:text-red-500 focus:outline-none focus:bg-gray-100 focus:text-gray-900\", form: {data: {controller: \"confirm\", confirm_message: t('spina.pages.delete_confirmation', subject: sanitize(@page.title))}} %>\n        <% else %>\n          <span class=\"block px-4 py-2 text-sm leading-5 text-gray-400\"><%=t 'spina.pages.cannot_be_deleted' %></span>\n        <% end %>\n      </div>\n    </div>\n  </div>\n</div>\n\n<!-- Translations -->\n<%= render Spina::Pages::TranslationsComponent.new(@page, label: @locale.upcase) %>\n\n<button type=\"submit\" form=\"<%= dom_id(@page) %>\" class=\"btn btn-primary w-1/2 md:w-auto\" data-controller=\"button hotkeys\" data-hotkeys=\"command+s, ctrl+s\" data-hotkeys-target=\"button\" data-action=\"button#loading\" data-loading-message=\"Saving...\">\n  <%= helpers.heroicon('check', style: :mini, class: 'w-5 h-5 -ml-1 mr-1') %>\n  <% if @page.draft? %>\n    <%=t 'spina.pages.save_draft' %>\n  <% else %>\n    <%=t 'spina.pages.save_changes' %>\n  <% end %>\n</button>\n\n<!-- Saving -->\n<% if @page.persisted? && @page.draft? %>\n  <button type=\"submit\" form=\"<%= dom_id(@page) %>\" name=\"page[draft]\" value=\"false\" class=\"btn bg-emerald-500 hover:bg-emerald-600 border-emerald-600 text-white flex items-center\" data-controller=\"hotkeys\" data-hotkeys=\"control+command+s\" data-hotkeys-target=\"button\">\n    <%= helpers.heroicon('cursor-arrow-rays', style: :solid, class: \"w-5 h-5 -ml-1 mr-1\") %>\n    <%=t 'spina.pages.publish' %>\n  </button>\n<% end %>\n"], "filenames": ["app/components/spina/pages/actions_component.html.erb"], "buggy_code_start_loc": [43], "buggy_code_end_loc": [44], "fixing_code_start_loc": [43], "fixing_code_end_loc": [44], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Stored in GitHub repository spinacms/spina prior to 2.15.1.", "other": {"cve": {"id": "CVE-2023-3445", "sourceIdentifier": "security@huntr.dev", "published": "2023-06-28T14:15:10.117", "lastModified": "2023-07-05T18:52:26.923", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Stored in GitHub repository spinacms/spina prior to 2.15.1."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 0.9, "impactScore": 2.5}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:denkgroot:spina:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.15.1", "matchCriteriaId": "CA56A37D-3579-48FE-AA0E-B3BD80E73D74"}]}]}], "references": [{"url": "https://github.com/spinacms/spina/commit/9adfe7b4807b3cc10dbb7351a26cc32f5d8c14a3", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.dev/bounties/18a74a9d-4a2d-4bf8-ae62-56a909427070", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/spinacms/spina/commit/9adfe7b4807b3cc10dbb7351a26cc32f5d8c14a3"}}