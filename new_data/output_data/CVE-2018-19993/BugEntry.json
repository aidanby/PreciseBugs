{"buggy_code": ["<?php\n/* Copyright (C) 2016\tLaurent Destailleur\t\t<eldy@users.sourceforge.net>\n *\n * This program is free software; you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation; either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n *\t\\file       htdocs/public/notice.php\n *\t\\brief      Dolibarr page to show a notice.\n *              Default notice is a message to say network connection is off.\n *              You can also call this page with URL: \n *                /public/notice.php?lang=xx_XX&transkey=translation_key  (key must be inside file main.lang, error.lang or other.lang)\n *                /public/notice.php?transphrase=url_encoded_sentence_to_show\n */\n\ndefine('NOCSRFCHECK',1);\ndefine('NOLOGIN',1);\t\t\n\nrequire '../main.inc.php';\n\n\n/**\n * View\n */\n\nif (! GETPOST('transkey') && ! GETPOST('transphrase'))\n{\n    print 'Sorry, it seems your internet connexion is off.<br>';\n    print 'You need to be connected to network to use this software.<br>';\n}\nelse\n{\n    $langs->load(\"error\");\n    $langs->load(\"other\");\n    \n    if (GETPOST('transphrase')) print GETPOST('transphrase'); \n    if (GETPOST('transkey')) print $langs->trans(GETPOST('transkey'));\n}\n\n"], "fixing_code": ["<?php\n/* Copyright (C) 2016-2018\tLaurent Destailleur\t\t<eldy@users.sourceforge.net>\n *\n * This program is free software; you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation; either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n */\n\n/**\n *\t\\file       htdocs/public/notice.php\n *\t\\brief      Dolibarr page to show a notice.\n *              Default notice is a message to say network connection is off.\n *              You can also call this page with URL:\n *                /public/notice.php?lang=xx_XX&transkey=translation_key  (key must be inside file main.lang, error.lang or other.lang)\n *                /public/notice.php?transphrase=url_encoded_sentence_to_show\n */\n\ndefine('NOCSRFCHECK',1);\ndefine('NOLOGIN',1);\n\nrequire '../main.inc.php';\n\n\n/**\n * View\n */\n\nif (! GETPOST('transkey','alphanohtml') && ! GETPOST('transphrase','alphanohtml'))\n{\n    print 'Sorry, it seems your internet connexion is off.<br>';\n    print 'You need to be connected to network to use this software.<br>';\n}\nelse\n{\n    $langs->load(\"error\");\n    $langs->load(\"other\");\n\n    if (GETPOST('transphrase','alphanohtml')) print GETPOST('transphrase','alphanohtml');\n    if (GETPOST('transkey','alphanohtml')) print $langs->trans(GETPOST('transkey','alphanohtml'));\n}\n\n"], "filenames": ["htdocs/public/notice.php"], "buggy_code_start_loc": [2], "buggy_code_end_loc": [49], "fixing_code_start_loc": [2], "fixing_code_end_loc": [49], "type": "CWE-79", "message": "A reflected cross-site scripting (XSS) vulnerability in Dolibarr 8.0.2 allows remote attackers to inject arbitrary web script or HTML via the transphrase parameter to public/notice.php.", "other": {"cve": {"id": "CVE-2018-19993", "sourceIdentifier": "cve@mitre.org", "published": "2019-01-03T19:29:01.007", "lastModified": "2022-11-17T17:21:59.260", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A reflected cross-site scripting (XSS) vulnerability in Dolibarr 8.0.2 allows remote attackers to inject arbitrary web script or HTML via the transphrase parameter to public/notice.php."}, {"lang": "es", "value": "Una vulnerabilidad de Cross-Site Scripting (XSS) reflejado en la versi\u00f3n 8.0.2 de Dolibarr permite que los atacantes remotos inyecten scripts web o HTML arbitrarios mediante el par\u00e1metro transphrase en public/notice.php."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:dolibarr:dolibarr_erp\\/crm:8.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "30608213-F99C-4D9E-B848-794532E85267"}]}]}], "references": [{"url": "https://github.com/Dolibarr/dolibarr/commit/fc3fcc5455d9a610b85723e89e8be43a41ad1378", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/Dolibarr/dolibarr/commit/fc3fcc5455d9a610b85723e89e8be43a41ad1378"}}