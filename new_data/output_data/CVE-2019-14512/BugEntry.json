{"buggy_code": ["<script type='text/javascript'>\n    var duplicatelabelcode='<?php eT('Error: You are trying to use duplicate label codes.','js'); ?>';\n    var otherisreserved='<?php eT(\"Error: 'other' is a reserved keyword.\",'js'); ?>';\n</script>\n\n<!-- quick add popup -->\n<?php $this->renderPartial(\"./labels/_labelviewquickadd_view\", array()); ?>\n\n<div class=\"col-sm-12 labels\">\n    <div class=\"pagetitle h3\">\n        <?php eT(\"Labels\") ?>\n        <?php if(isset($model->label_name)): ?> \n            - <?=$model->label_name;?>\n        <?php endif; ?>\n    </div>\n    <div class=\"container\">\n        <div class=\"row\">\n\n            <!-- Left content -->\n            <div class=\"col-sm-12 content-right text-center\">\n\n                <!-- tabs -->\n                <ul class=\"nav nav-tabs\">\n                    <?php  foreach ($lslanguages as $i => $language): ?>\n                        <li role=\"presentation\" <?php if($i==0){ echo 'class=\"active\"';}?>>\n                            <a data-toggle=\"tab\" href='#neweditlblset<?php echo $i; ?>' >\n                                <?php echo getLanguageNameFromCode($language, false); ?>\n                            </a>\n                        </li>\n                    <?php endforeach;?>\n                </ul>\n\n                <!-- FORM -->\n                <?php echo CHtml::form(array(\"admin/labels/sa/process\"), 'post', array('id'=>'mainform')); ?>\n                    <input type='hidden' name='lid' value='<?php echo $lid ?>' />\n                    <input type='hidden' name='action' value='modlabelsetanswers' />\n\n                    <!-- tab content -->\n                    <?php $this->renderPartial(\"./labels/_labelviewtabcontent_view\", array('lslanguages'=>$lslanguages, 'results'=>$results, 'action' => $action)); ?>\n                </form>\n            </div>\n\n            <!-- Right content -->\n            <div class=\"col-sm-4\">\n            <?php if(Permission::model()->hasGlobalPermission('labelsets','edit'))\n            { ?>\n                <?php $this->renderPartial(\"./labels/_labelviewrightcontent_view\", array('lid'=>$lid)); ?>\n            <?php }; ?>\n            </div>\n        </div>\n    </div>\n</div>\n"], "fixing_code": ["<script type='text/javascript'>\n    var duplicatelabelcode='<?php eT('Error: You are trying to use duplicate label codes.','js'); ?>';\n    var otherisreserved='<?php eT(\"Error: 'other' is a reserved keyword.\",'js'); ?>';\n</script>\n\n<!-- quick add popup -->\n<?php $this->renderPartial(\"./labels/_labelviewquickadd_view\", array()); ?>\n\n<div class=\"col-sm-12 labels\">\n    <div class=\"pagetitle h3\">\n        <?php eT(\"Labels\") ?>\n        <?php if(isset($model->label_name)): ?> \n            - <?php echo CHtml::encode($model->label_name); ?>\n        <?php endif; ?>\n    </div>\n    <div class=\"container\">\n        <div class=\"row\">\n\n            <!-- Left content -->\n            <div class=\"col-sm-12 content-right text-center\">\n\n                <!-- tabs -->\n                <ul class=\"nav nav-tabs\">\n                    <?php  foreach ($lslanguages as $i => $language): ?>\n                        <li role=\"presentation\" <?php if($i==0){ echo 'class=\"active\"';}?>>\n                            <a data-toggle=\"tab\" href='#neweditlblset<?php echo $i; ?>' >\n                                <?php echo getLanguageNameFromCode($language, false); ?>\n                            </a>\n                        </li>\n                    <?php endforeach;?>\n                </ul>\n\n                <!-- FORM -->\n                <?php echo CHtml::form(array(\"admin/labels/sa/process\"), 'post', array('id'=>'mainform')); ?>\n                    <input type='hidden' name='lid' value='<?php echo $lid ?>' />\n                    <input type='hidden' name='action' value='modlabelsetanswers' />\n\n                    <!-- tab content -->\n                    <?php $this->renderPartial(\"./labels/_labelviewtabcontent_view\", array('lslanguages'=>$lslanguages, 'results'=>$results, 'action' => $action)); ?>\n                </form>\n            </div>\n\n            <!-- Right content -->\n            <div class=\"col-sm-4\">\n            <?php if(Permission::model()->hasGlobalPermission('labelsets','edit'))\n            { ?>\n                <?php $this->renderPartial(\"./labels/_labelviewrightcontent_view\", array('lid'=>$lid)); ?>\n            <?php }; ?>\n            </div>\n        </div>\n    </div>\n</div>\n"], "filenames": ["application/views/admin/labels/labelview_view.php"], "buggy_code_start_loc": [13], "buggy_code_end_loc": [14], "fixing_code_start_loc": [13], "fixing_code_end_loc": [14], "type": "CWE-79", "message": "LimeSurvey 3.17.7+190627 has XSS via Boxes in application/extensions/PanelBoxWidget/views/box.php or a label title in application/views/admin/labels/labelview_view.php.", "other": {"cve": {"id": "CVE-2019-14512", "sourceIdentifier": "cve@mitre.org", "published": "2020-03-16T15:15:12.037", "lastModified": "2020-03-18T19:00:00.863", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "LimeSurvey 3.17.7+190627 has XSS via Boxes in application/extensions/PanelBoxWidget/views/box.php or a label title in application/views/admin/labels/labelview_view.php."}, {"lang": "es", "value": "LimeSurvey versiones 3.17.7+190627, presenta una vulnerabilidad de tipo XSS por medio de Boxes en el archivo application/extensions/PanelBoxWidget/views/box.php o un t\u00edtulo de etiqueta en el archivo application/views/admin/labels/labelview_view.php."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:limesurvey:limesurvey:3.17.7\\+190627:*:*:*:*:*:*:*", "matchCriteriaId": "A54CA843-3C43-42C7-932C-36C472DD19F0"}]}]}], "references": [{"url": "https://github.com/LimeSurvey/LimeSurvey/commit/0b7391dff91b326284ca3fc5188b768b5d522d88", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/LimeSurvey/LimeSurvey/commit/f2566f6978a77e3f0870079c45cda1c065a58a73", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://www.limesurvey.org/", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "https://www.linkedin.com/in/michelecisternino/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/LimeSurvey/LimeSurvey/commit/0b7391dff91b326284ca3fc5188b768b5d522d88"}}