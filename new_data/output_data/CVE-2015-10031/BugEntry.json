{"buggy_code": ["<?php\n\t$name = $_GET[\"name\"];\n\t$score = $_GET[\"score\"];\n\t\n\t$username = \"alpertmd\";\n\t$password = \"yofer`\";\n\t$hostname = \"repos.insttech.washington.edu\";\n\n\t$dbhandle = mysql_connect($hostname, $username, $password) or die(\"Unable to connect to MySQL\");\n\n\t$selected = mysql_select_db(\"alpertmd\", $dbhandle) or die(\"Could not select high score db\");\n\t\n\t$result = mysql_query(\"SELECT MAX(idHighscores) FROM Highscores\");\n\t$id = mysql_result($result, 0) + 1;\n\t\n\t$query = \"INSERT INTO Highscores VALUES ($id, '$name', $score)\";\n\t$result = mysql_query($query);\n\t\t\n\t$query = \"SELECT idHighscores FROM Highscores WHERE score = (SELECT Min(score) FROM Highscores)\";\n\t$result = mysql_query($query);\n\t$minID = mysql_result($result, 0);\n\n\n\t$query = \"DELETE FROM Highscores WHERE idHighscores = $minID\";\n\t$result = mysql_query($query);\n\t\n\tmysql_close($dbhandle);\n?>"], "fixing_code": ["<?php\n\t\n\tif ($_SERVER['HTTP_X_REQUESTED_WITH'] == 'XMLHttpRequest'){\n\t\t$username = \"alpertmd\";\n\t\t$password = \"yofer`\";\n\t\t$hostname = \"repos.insttech.washington.edu\";\n\n\t\t$dbhandle = mysqli_connect($hostname, $username, $password) or die(\"Unable to connect to MySQL\");\n\t\n\t\t$selected = mysqli_select_db($dbhandle,$username) or die(\"Could not select high score db\");\n\t\n\t\t$result = mysqli_query($dbhandle, \"SELECT MAX(idHighscores) FROM Highscores\");\n\t\n\t\t$id = mysqli_fetch_row($result)[0] + 1;\n\t\t$name = $_POST[\"name\"];\n\t\t$score = $_POST[\"score\"];\n\n\t\t$query =  mysqli_prepare($dbhandle, \"INSERT INTO Highscores Values (?, ?, ?)\");\n\t\n\t\tmysqli_stmt_bind_param($query, 'isi', $id, $name, $score);\n\t\tmysqli_stmt_execute($query);\n\t\tmysqli_stmt_close($query);\n\t\t\n\t\t$query = \"SELECT idHighscores FROM Highscores WHERE score = (SELECT Min(score) FROM Highscores)\";\n\t\t$result = mysqli_query($dbhandle, $query);\n\t\t$minID = mysqli_fetch_row($result)[0];\n\n\t\t$query = \"DELETE FROM Highscores WHERE idHighscores = $minID\";\n\t\t$result = mysqli_query($dbhandle, $query);\n\t\n\t\tmysqli_close($dbhandle);\n\t}\n?>"], "filenames": ["update.php"], "buggy_code_start_loc": [2], "buggy_code_end_loc": [28], "fixing_code_start_loc": [1], "fixing_code_end_loc": [33], "type": "CWE-89", "message": "A vulnerability classified as critical was found in purpleparrots 491-Project. This vulnerability affects unknown code of the file update.php of the component Highscore Handler. The manipulation leads to sql injection. The name of the patch is a812a5e4cf72f2a635a716086fe1ee2b8fa0b1ab. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-217648.", "other": {"cve": {"id": "CVE-2015-10031", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-08T17:15:17.763", "lastModified": "2023-01-12T22:24:54.403", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability classified as critical was found in purpleparrots 491-Project. This vulnerability affects unknown code of the file update.php of the component Highscore Handler. The manipulation leads to sql injection. The name of the patch is a812a5e4cf72f2a635a716086fe1ee2b8fa0b1ab. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-217648."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.2}, "baseSeverity": "MEDIUM", "exploitabilityScore": 5.1, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:github:491-project:*:*:*:*:*:*:*:*", "versionEndExcluding": "2015-03-11", "matchCriteriaId": "0B9628C1-EA20-4AC4-B5A7-DA7DEC6F5A61"}]}]}], "references": [{"url": "https://github.com/purpleparrots/491-Project/commit/a812a5e4cf72f2a635a716086fe1ee2b8fa0b1ab", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.217648", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.217648", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/purpleparrots/491-Project/commit/a812a5e4cf72f2a635a716086fe1ee2b8fa0b1ab"}}