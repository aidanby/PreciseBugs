{"buggy_code": ["<%= drop_down_for('Classify Event(s)', 'icons/actions.png', 'incident') do %>\n\t\n\t<% @classifications.each do |cls| %>\n\t\t<% if cls.locked && cls.hotkey %>\n\t\t\t<%= drop_down_item \"#{cls.name}<span class='shortcut'>#{cls.shortcut}</span>\", '#', nil, { :class => 'classification', :\"data-classification-id\" => cls.id.to_i } %>\n\t\t<% else %>\n\t\t\t<%= drop_down_item \"#{cls.name}\", '#', nil, { :class => 'classification', :\"data-classification-id\" => cls.id.to_i } %>\n\t\t<% end %>\n\t<% end %>\n\t\n\t<%= drop_down_item \"Unclassified<span class='shortcut'>ctrl+shift+u</span>\", '#', nil, { :class => 'classification', :\"data-classification-id\" => 0 } %>\n\t\n<% end %>\n"], "fixing_code": ["<%= drop_down_for('Classify Event(s)', 'icons/actions.png', 'incident') do %>\n\t\n\t<% @classifications.each do |cls| %>\n\t\t<% if cls.locked && cls.hotkey %>\n\t\t\t<%= drop_down_item \"#{sanitize cls.name}<span class='shortcut'>#{cls.shortcut}</span>\", '#', nil, { :class => 'classification', :\"data-classification-id\" => cls.id.to_i } %>\n\t\t<% else %>\n\t\t\t<%= drop_down_item \"#{sanitize cls.name}\", '#', nil, { :class => 'classification', :\"data-classification-id\" => cls.id.to_i } %>\n\t\t<% end %>\n\t<% end %>\n\t\n\t<%= drop_down_item \"Unclassified<span class='shortcut'>ctrl+shift+u</span>\", '#', nil, { :class => 'classification', :\"data-classification-id\" => 0 } %>\n\t\n<% end %>\n"], "filenames": ["app/views/events/_menu.html.erb"], "buggy_code_start_loc": [5], "buggy_code_end_loc": [8], "fixing_code_start_loc": [5], "fixing_code_end_loc": [8], "type": "CWE-79", "message": "Cross-site scripting (XSS) vulnerability in app/views/events/_menu.html.erb in Snorby 2.6.2 allows remote attackers to inject arbitrary web script or HTML via the title (cls.name variable) when creating a classification.", "other": {"cve": {"id": "CVE-2015-5460", "sourceIdentifier": "cve@mitre.org", "published": "2015-07-08T16:59:03.270", "lastModified": "2019-06-25T15:21:40.100", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in app/views/events/_menu.html.erb in Snorby 2.6.2 allows remote attackers to inject arbitrary web script or HTML via the title (cls.name variable) when creating a classification."}, {"lang": "es", "value": "Vulnerabilidad de XSS en app/views/events/_menu.html.erb en Snorby 2.6.2 permite a atacantes remotos inyectar secuencias de comandos web arbitrarios o HTML a trav\u00e9s del t\u00edtulo (la variable cls.name) cuando crea una clasificaci\u00f3n."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:snorby_project:snorby:2.6.2:*:*:*:*:ruby:*:*", "matchCriteriaId": "088E8582-2B05-4160-97D3-9250CF2D6A3E"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/132552/Snorby-2.6.2-Cross-Site-Scripting.html", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "http://seclists.org/fulldisclosure/2015/Jul/15", "source": "cve@mitre.org", "tags": ["Exploit", "Mailing List", "Third Party Advisory"]}, {"url": "http://www.securityfocus.com/archive/1/535930/100/0/threaded", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securityfocus.com/bid/75561", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/Snorby/snorby/commit/89d7cbcd3697c8a842f1a61b99e9a78f295798fb", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/Snorby/snorby/issues/377", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/Snorby/snorby/commit/89d7cbcd3697c8a842f1a61b99e9a78f295798fb"}}