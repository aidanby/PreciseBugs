{"buggy_code": ["## 0.1.1 (2020-03-19)\n\n- Fixed load error\n\n## 0.1.0 (2019-10-28)\n\n- Added `on_job_update` hook\n\n## 0.0.5 (2015-05-13)\n\n- Added `running_threshold` option\n\n## 0.0.4 (2015-03-15)\n\n- Better monitoring for multiple processes\n", "module ClockworkWeb\n  class HomeController < ActionController::Base\n    layout false\n    helper ClockworkWeb::HomeHelper\n\n    http_basic_authenticate_with name: ENV[\"CLOCKWORK_USERNAME\"], password: ENV[\"CLOCKWORK_PASSWORD\"] if ENV[\"CLOCKWORK_PASSWORD\"]\n\n    def index\n      @events =\n        Clockwork.manager.instance_variable_get(:@events).sort_by do |e|\n          at = e.instance_variable_get(:@at)\n          [\n            e.instance_variable_get(:@period),\n            (at && at.instance_variable_get(:@hour)) || -1,\n            (at && at.instance_variable_get(:@min)) || -1,\n            e.job.to_s\n          ]\n        end\n\n      @last_runs = ClockworkWeb.last_runs\n      @disabled = ClockworkWeb.disabled_jobs\n      @last_heartbeat = ClockworkWeb.last_heartbeat\n    end\n\n    def job\n      job = params[:job]\n      enable = params[:enable] == \"true\"\n      if enable\n        ClockworkWeb.enable(job)\n      else\n        ClockworkWeb.disable(job)\n      end\n      ClockworkWeb.on_job_update.call(job: job, enable: enable, user: try(:current_user)) if ClockworkWeb.on_job_update\n      redirect_to root_path\n    end\n  end\nend\n"], "fixing_code": ["## 0.1.2 (unreleased)\n\n- Fixed CSRF vulnerability with Rails < 5.2 - [more info](https://github.com/ankane/clockwork_web/issues/4)\n\n## 0.1.1 (2020-03-19)\n\n- Fixed load error\n\n## 0.1.0 (2019-10-28)\n\n- Added `on_job_update` hook\n\n## 0.0.5 (2015-05-13)\n\n- Added `running_threshold` option\n\n## 0.0.4 (2015-03-15)\n\n- Better monitoring for multiple processes\n", "module ClockworkWeb\n  class HomeController < ActionController::Base\n    layout false\n    helper ClockworkWeb::HomeHelper\n\n    protect_from_forgery with: :exception\n\n    http_basic_authenticate_with name: ENV[\"CLOCKWORK_USERNAME\"], password: ENV[\"CLOCKWORK_PASSWORD\"] if ENV[\"CLOCKWORK_PASSWORD\"]\n\n    def index\n      @events =\n        Clockwork.manager.instance_variable_get(:@events).sort_by do |e|\n          at = e.instance_variable_get(:@at)\n          [\n            e.instance_variable_get(:@period),\n            (at && at.instance_variable_get(:@hour)) || -1,\n            (at && at.instance_variable_get(:@min)) || -1,\n            e.job.to_s\n          ]\n        end\n\n      @last_runs = ClockworkWeb.last_runs\n      @disabled = ClockworkWeb.disabled_jobs\n      @last_heartbeat = ClockworkWeb.last_heartbeat\n    end\n\n    def job\n      job = params[:job]\n      enable = params[:enable] == \"true\"\n      if enable\n        ClockworkWeb.enable(job)\n      else\n        ClockworkWeb.disable(job)\n      end\n      ClockworkWeb.on_job_update.call(job: job, enable: enable, user: try(:current_user)) if ClockworkWeb.on_job_update\n      redirect_to root_path\n    end\n  end\nend\n"], "filenames": ["CHANGELOG.md", "app/controllers/clockwork_web/home_controller.rb"], "buggy_code_start_loc": [0, 4], "buggy_code_end_loc": [0, 4], "fixing_code_start_loc": [1, 5], "fixing_code_end_loc": [5, 7], "type": "CWE-352", "message": "Clockwork Web before 0.1.2, when Rails before 5.2 is used, allows CSRF.", "other": {"cve": {"id": "CVE-2023-25015", "sourceIdentifier": "cve@mitre.org", "published": "2023-02-02T04:15:08.107", "lastModified": "2023-02-09T18:48:02.897", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Clockwork Web before 0.1.2, when Rails before 5.2 is used, allows CSRF."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:clockwork_web_project:clockwork_web:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.1.2", "matchCriteriaId": "2D66182B-0020-4436-8C14-B3EE1F9B82A3"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:a:rubyonrails:rails:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.2.0", "matchCriteriaId": "8C9163AF-6EEA-4C22-BA5D-74CB55208C9B"}]}]}], "references": [{"url": "https://github.com/ankane/clockwork_web/commit/ec2896503ee231588547c2fad4cb93a94e78f857", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/ankane/clockwork_web/compare/v0.1.1...v0.1.2", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/ankane/clockwork_web/issues/4", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/ankane/clockwork_web/commit/ec2896503ee231588547c2fad4cb93a94e78f857"}}