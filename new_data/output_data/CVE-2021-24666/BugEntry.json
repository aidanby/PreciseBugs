{"buggy_code": ["<?php\n\nnamespace Podlove\\Modules\\Social\\Model;\n\nuse Podlove\\Model\\Base;\n\n/**\n * A contributor contributes to a podcast/show.\n */\nclass ContributorService extends Base\n{\n    use \\Podlove\\Model\\KeepsBlogReferenceTrait;\n\n    public function __construct()\n    {\n        $this->set_blog_id();\n    }\n\n    public function save()\n    {\n        global $wpdb;\n\n        if (!$this->position) {\n            $pos = $wpdb->get_var(\n                sprintf(\n                    'SELECT MAX(position)+1 FROM %s WHERE contributor_id = %d',\n                    self::table_name(),\n                    $this->contributor_id\n                )\n            );\n\n            $this->position = $pos ? $pos : 1;\n        }\n\n        parent::save();\n    }\n\n    public function get_service()\n    {\n        return $this->with_blog_scope(function () {\n            return Service::find_one_by_id($this->service_id);\n        });\n    }\n\n    public function get_service_url()\n    {\n        $service = $this->get_service();\n\n        return str_replace('%account-placeholder%', $this->value, $service->url_scheme);\n    }\n\n    public static function find_by_contributor_id_and_category($contributor_id, $category = 'social')\n    {\n        return self::all('WHERE service_id IN (SELECT id FROM '.Service::table_name().\" WHERE `category` = '\".$category.\"' ) AND `contributor_id` = \".$contributor_id);\n    }\n}\n\nContributorService::property('id', 'INT NOT NULL AUTO_INCREMENT PRIMARY KEY');\nContributorService::property('contributor_id', 'INT');\nContributorService::property('service_id', 'INT');\nContributorService::property('value', 'TEXT');\nContributorService::property('title', 'TEXT');\nContributorService::property('position', 'FLOAT');\n", "<?php\n\nnamespace Podlove\\Modules\\Social\\Model;\n\nuse Podlove\\Model\\Base;\n\n/**\n * A contributor contributes to a podcast/show.\n */\nclass ShowService extends Base\n{\n    use \\Podlove\\Model\\KeepsBlogReferenceTrait;\n\n    public function __construct()\n    {\n        $this->set_blog_id();\n    }\n\n    public function get_service()\n    {\n        return $this->with_blog_scope(function () {\n            return Service::find_one_by_id($this->service_id);\n        });\n    }\n\n    public function get_service_url()\n    {\n        $service = $this->get_service();\n\n        return str_replace('%account-placeholder%', $this->value, $service->url_scheme);\n    }\n\n    public static function find_by_category($category = 'social')\n    {\n        return self::all('WHERE service_id IN (SELECT id FROM '.Service::table_name().\" WHERE `category` = '\".$category.\"' ) ORDER BY position ASC\");\n    }\n}\n\nShowService::property('id', 'INT NOT NULL AUTO_INCREMENT PRIMARY KEY');\nShowService::property('service_id', 'INT');\nShowService::property('value', 'TEXT');\nShowService::property('title', 'TEXT');\nShowService::property('position', 'FLOAT');\n", "=== Podlove Podcast Publisher ===\nContributors: eteubert, chemiker\nDonate link: http://podlove.org/donations/\nTags: podlove, podcast, publishing, rss, feed, audio, mp3, m4a, player, webplayer, iTunes, radio, ClassicPress\nRequires at least: 4.9.6\nTested up to: 5.7.1\nRequires PHP: 7.0\nStable tag: 3.2.0-beta1\nLicense: MIT\n\nThe one and only next generation podcast publishing system. Seriously. It's magical and sparkles a lot.\n\n== Description ==\n\nWe built the Podlove Podcast Publisher because existing solutions are stuck in the past, complex and unwieldy. The Publisher helps you save time, worry less and provides a cutting edge listening experience for your audience.\n\nOfficial Site: [publisher.podlove.org](http://publisher.podlove.org/)\n\n= Video Tutorial: Getting started with Podlove Publisher =\n\n[youtube http://www.youtube.com/watch?v=Hmrm-jUe6u4]\n\n= Compatible Feeds =\n\nThe Publisher makes it easy to create highly expressive, efficient and super compatible podcast feeds with fine grained control over client behavior (e.g. GUID control to replace faulty episodes and for clients to reload) supporting all important meta data.\n\n= Multi-Format Publishing =\n\nThe Publisher also makes multi-format publishing - embracing all modern and legacy audio and video codecs - a snap. By adopting simple file name conventions, the plugin allows the podcaster to provide individual feeds for certain use cases or audiences without adding work for the podcaster during the publishing process.\n\n= Optimized Web Player =\n\nThe Publisher also comes with integrated with the Podlove Web Player plugin (which you do not need to install separately) and fully support its advanced options including multiple audio (MP4 AAC, MP3, Vorbis, Opus) and video (MP4 H.264, WebM, Theora) format support for web browsers. This Web Player is fully HTML5 compatible (but provides Flash fallback for ancient environments) and is ready for all touch based clients too.\n\n= Chapter Support =\n\nThe Publisher also makes it easy to publish chapter information in the player to make access to structured episodes even easier. Full support for linking directly to any part of your podcast on the web with instant playback included.\n\n= Flexible Templates =\n\nTo round it all up, a flexible template system enables you to published Podcasts in a defined fashion and change the style at any time without having to touch your individual postings later on.\n\nAnd this is just the beginning. We have a rich roadmap that will bring even more interesting features: integration with helpful services, much improved timeline metadata support (show notes) and much more.\n\n= Further Reading =\n\n* [Podlove Publisher](http://publisher.podlove.org/)\n* [Podlove Project](http://podlove.org/)\n* [Podlove Community](https://community.podlove.org/)\n* [Documentation](http://docs.podlove.org/)\n* [Bug Tracker](https://github.com/podlove/podlove-publisher/issues)\n* [Donate](http://podlove.org/donations/)\n\nDevelopment of the plugin is an open process. The current version is available [on GitHub](https://github.com/podlove/podlove-publisher) Feel free to contribute and to fix errors or send improvements via GitHub.\n\nRequires PHP 5.4+\n\n== Frequently Asked Questions ==\n\n### Is Podlove Podcast Publisher free?\n\nYes! The core features of Podlove Podcast Publisher are and always will be free. [Paid Professional Support](https://publisher.podlove.org/support/) is available but not necessary to run the plugin.\n\n### Are there Download Statistics?\n\nYes! Podcast Downloads can be tracked and analyzed. You can easily see how many people downloaded you podcast episodes, which clients they used, if they prefer to subscribe to the feed or listen on your website using the web player\u2014and much more.\n\n### Are there Privacy / GDPR considerations?\n\nPodlove Publisher is GDPR compliant and provides prewritten text snippets for your privacy page. See https://docs.podlove.org/podlove-publisher/guides/dsgvo-gdpr.html\n\n### Where can I host my podcast files?\n\nAny storage where you have control over the file naming is compatible with Podlove Podcast Publisher. You can manage files using a simple FTP/sFTP or use services like Amazon S3.\n\n### Where can I ask questions and get support?\n\nFree support where questions are answered by the community is available in the [Podlove Community Forum](http://community.podlove.org/). There is a German community in the [Sendegate](https://sendegate.de/).\n\n### How can I help the project?\n\nThe continued success of Open Source project relies on the community. There are many ways you can help:\n\n- If you enjoy the plugin, please [leave a review](https://wordpress.org/support/plugin/podlove-podcasting-plugin-for-wordpress/reviews/#new-post).\n- You can answer questions of other fellow podcasters in the [Podlove Community](https://community.podlove.org/).\n\n---\n\nThis product includes GeoLite2 data created by MaxMind, available from http://www.maxmind.com.\n\n== Installation ==\n\n1. Download the Podlove Publisher Plugin to your desktop.\n1. If downloaded as a zip archive, extract the Plugin folder to your desktop.\n1. With your FTP program, upload the Plugin folder to the wp-content/plugins folder in your WordPress directory online.\n1. Go to Plugins screen and find the newly uploaded Plugin in the list.\n1. Click Activate Plugin to activate it.\n\n== Screenshots ==\n1. Custom episode post type separates media from your blog content.\n2. Download analytics provide you with all the data you ever wanted.\n3. The Publisher automatically checks the health of your media files.\n4. The mighty template engine gives you full control over the episode presentation.\n5. Includes the Podlove Subscribe Button, the easiest way for listeners to subscribe to your podcast.\n6. Includes the Podlove Web Player. One more thing: you can manage and present all contributors easily.\n\n== Changelog ==\n\n= 2021-05-02 =\n\n* fix: transcript API returns list again\n\n= 2021-05-01 =\n\n* fix: PLUS open graph images (use new API)\n\n= 2021-04-27 =\n\n* fix: handle webvtt voice, missing Contributors\n* transcript voices / contributors:\n  * you can now select \"none\" in the voice assignment\n  * only voices with an assigned contributor (and not \"none\") appear in public transcripts\n\n\n= 2021-04-26 =\n\n* webvtt transcripts use public contributor name\n\n= 2021-04-24 =\n\n* generate default copyright claim if it is not explcitly set\n* fix(related episodes): remove whitespace in shortcode HTML to fix rendering in Spotify\n\n----\n\nChanges for previous versions can be found in the [`changelog.txt`](https://github.com/podlove/podlove-publisher/blob/master/changelog.txt).\n"], "fixing_code": ["<?php\n\nnamespace Podlove\\Modules\\Social\\Model;\n\nuse Podlove\\Model\\Base;\n\n/**\n * A contributor contributes to a podcast/show.\n */\nclass ContributorService extends Base\n{\n    use \\Podlove\\Model\\KeepsBlogReferenceTrait;\n\n    public function __construct()\n    {\n        $this->set_blog_id();\n    }\n\n    public function save()\n    {\n        global $wpdb;\n\n        if (!$this->position) {\n            $pos = $wpdb->get_var(\n                sprintf(\n                    'SELECT MAX(position)+1 FROM %s WHERE contributor_id = %d',\n                    self::table_name(),\n                    $this->contributor_id\n                )\n            );\n\n            $this->position = $pos ? $pos : 1;\n        }\n\n        parent::save();\n    }\n\n    public function get_service()\n    {\n        return $this->with_blog_scope(function () {\n            return Service::find_one_by_id($this->service_id);\n        });\n    }\n\n    public function get_service_url()\n    {\n        $service = $this->get_service();\n\n        return str_replace('%account-placeholder%', $this->value, $service->url_scheme);\n    }\n\n    public static function find_by_contributor_id_and_category($contributor_id, $category = 'social')\n    {\n        $contributor_id = (int) $contributor_id;\n        $category = $category == 'social' ? 'social' : 'donation';\n\n        return self::all('WHERE service_id IN (SELECT id FROM '.Service::table_name().\" WHERE `category` = '\".$category.\"' ) AND `contributor_id` = \".$contributor_id);\n    }\n}\n\nContributorService::property('id', 'INT NOT NULL AUTO_INCREMENT PRIMARY KEY');\nContributorService::property('contributor_id', 'INT');\nContributorService::property('service_id', 'INT');\nContributorService::property('value', 'TEXT');\nContributorService::property('title', 'TEXT');\nContributorService::property('position', 'FLOAT');\n", "<?php\n\nnamespace Podlove\\Modules\\Social\\Model;\n\nuse Podlove\\Model\\Base;\n\n/**\n * A contributor contributes to a podcast/show.\n */\nclass ShowService extends Base\n{\n    use \\Podlove\\Model\\KeepsBlogReferenceTrait;\n\n    public function __construct()\n    {\n        $this->set_blog_id();\n    }\n\n    public function get_service()\n    {\n        return $this->with_blog_scope(function () {\n            return Service::find_one_by_id($this->service_id);\n        });\n    }\n\n    public function get_service_url()\n    {\n        $service = $this->get_service();\n\n        return str_replace('%account-placeholder%', $this->value, $service->url_scheme);\n    }\n\n    public static function find_by_category($category = 'social')\n    {\n        $category = $category == 'social' ? 'social' : 'donation';\n\n        return self::all('WHERE service_id IN (SELECT id FROM '.Service::table_name().\" WHERE `category` = '\".$category.\"' ) ORDER BY position ASC\");\n    }\n}\n\nShowService::property('id', 'INT NOT NULL AUTO_INCREMENT PRIMARY KEY');\nShowService::property('service_id', 'INT');\nShowService::property('value', 'TEXT');\nShowService::property('title', 'TEXT');\nShowService::property('position', 'FLOAT');\n", "=== Podlove Podcast Publisher ===\nContributors: eteubert, chemiker\nDonate link: http://podlove.org/donations/\nTags: podlove, podcast, publishing, rss, feed, audio, mp3, m4a, player, webplayer, iTunes, radio, ClassicPress\nRequires at least: 4.9.6\nTested up to: 5.7.1\nRequires PHP: 7.0\nStable tag: 3.2.0-beta1\nLicense: MIT\n\nThe one and only next generation podcast publishing system. Seriously. It's magical and sparkles a lot.\n\n== Description ==\n\nWe built the Podlove Podcast Publisher because existing solutions are stuck in the past, complex and unwieldy. The Publisher helps you save time, worry less and provides a cutting edge listening experience for your audience.\n\nOfficial Site: [publisher.podlove.org](http://publisher.podlove.org/)\n\n= Video Tutorial: Getting started with Podlove Publisher =\n\n[youtube http://www.youtube.com/watch?v=Hmrm-jUe6u4]\n\n= Compatible Feeds =\n\nThe Publisher makes it easy to create highly expressive, efficient and super compatible podcast feeds with fine grained control over client behavior (e.g. GUID control to replace faulty episodes and for clients to reload) supporting all important meta data.\n\n= Multi-Format Publishing =\n\nThe Publisher also makes multi-format publishing - embracing all modern and legacy audio and video codecs - a snap. By adopting simple file name conventions, the plugin allows the podcaster to provide individual feeds for certain use cases or audiences without adding work for the podcaster during the publishing process.\n\n= Optimized Web Player =\n\nThe Publisher also comes with integrated with the Podlove Web Player plugin (which you do not need to install separately) and fully support its advanced options including multiple audio (MP4 AAC, MP3, Vorbis, Opus) and video (MP4 H.264, WebM, Theora) format support for web browsers. This Web Player is fully HTML5 compatible (but provides Flash fallback for ancient environments) and is ready for all touch based clients too.\n\n= Chapter Support =\n\nThe Publisher also makes it easy to publish chapter information in the player to make access to structured episodes even easier. Full support for linking directly to any part of your podcast on the web with instant playback included.\n\n= Flexible Templates =\n\nTo round it all up, a flexible template system enables you to published Podcasts in a defined fashion and change the style at any time without having to touch your individual postings later on.\n\nAnd this is just the beginning. We have a rich roadmap that will bring even more interesting features: integration with helpful services, much improved timeline metadata support (show notes) and much more.\n\n= Further Reading =\n\n* [Podlove Publisher](http://publisher.podlove.org/)\n* [Podlove Project](http://podlove.org/)\n* [Podlove Community](https://community.podlove.org/)\n* [Documentation](http://docs.podlove.org/)\n* [Bug Tracker](https://github.com/podlove/podlove-publisher/issues)\n* [Donate](http://podlove.org/donations/)\n\nDevelopment of the plugin is an open process. The current version is available [on GitHub](https://github.com/podlove/podlove-publisher) Feel free to contribute and to fix errors or send improvements via GitHub.\n\nRequires PHP 5.4+\n\n== Frequently Asked Questions ==\n\n### Is Podlove Podcast Publisher free?\n\nYes! The core features of Podlove Podcast Publisher are and always will be free. [Paid Professional Support](https://publisher.podlove.org/support/) is available but not necessary to run the plugin.\n\n### Are there Download Statistics?\n\nYes! Podcast Downloads can be tracked and analyzed. You can easily see how many people downloaded you podcast episodes, which clients they used, if they prefer to subscribe to the feed or listen on your website using the web player\u2014and much more.\n\n### Are there Privacy / GDPR considerations?\n\nPodlove Publisher is GDPR compliant and provides prewritten text snippets for your privacy page. See https://docs.podlove.org/podlove-publisher/guides/dsgvo-gdpr.html\n\n### Where can I host my podcast files?\n\nAny storage where you have control over the file naming is compatible with Podlove Podcast Publisher. You can manage files using a simple FTP/sFTP or use services like Amazon S3.\n\n### Where can I ask questions and get support?\n\nFree support where questions are answered by the community is available in the [Podlove Community Forum](http://community.podlove.org/). There is a German community in the [Sendegate](https://sendegate.de/).\n\n### How can I help the project?\n\nThe continued success of Open Source project relies on the community. There are many ways you can help:\n\n- If you enjoy the plugin, please [leave a review](https://wordpress.org/support/plugin/podlove-podcasting-plugin-for-wordpress/reviews/#new-post).\n- You can answer questions of other fellow podcasters in the [Podlove Community](https://community.podlove.org/).\n\n---\n\nThis product includes GeoLite2 data created by MaxMind, available from http://www.maxmind.com.\n\n== Installation ==\n\n1. Download the Podlove Publisher Plugin to your desktop.\n1. If downloaded as a zip archive, extract the Plugin folder to your desktop.\n1. With your FTP program, upload the Plugin folder to the wp-content/plugins folder in your WordPress directory online.\n1. Go to Plugins screen and find the newly uploaded Plugin in the list.\n1. Click Activate Plugin to activate it.\n\n== Screenshots ==\n1. Custom episode post type separates media from your blog content.\n2. Download analytics provide you with all the data you ever wanted.\n3. The Publisher automatically checks the health of your media files.\n4. The mighty template engine gives you full control over the episode presentation.\n5. Includes the Podlove Subscribe Button, the easiest way for listeners to subscribe to your podcast.\n6. Includes the Podlove Web Player. One more thing: you can manage and present all contributors easily.\n\n== Changelog ==\n\n= 2021-08-22 =\n\n* fix(security): sql injection in \"Social & Donations\" module\n\n= 2021-05-02 =\n\n* fix: transcript API returns list again\n\n= 2021-05-01 =\n\n* fix: PLUS open graph images (use new API)\n\n= 2021-04-27 =\n\n* fix: handle webvtt voice, missing Contributors\n* transcript voices / contributors:\n  * you can now select \"none\" in the voice assignment\n  * only voices with an assigned contributor (and not \"none\") appear in public transcripts\n\n\n= 2021-04-26 =\n\n* webvtt transcripts use public contributor name\n\n= 2021-04-24 =\n\n* generate default copyright claim if it is not explcitly set\n* fix(related episodes): remove whitespace in shortcode HTML to fix rendering in Spotify\n\n----\n\nChanges for previous versions can be found in the [`changelog.txt`](https://github.com/podlove/podlove-publisher/blob/master/changelog.txt).\n"], "filenames": ["lib/modules/social/model/contributor_service.php", "lib/modules/social/model/show_service.php", "readme.txt"], "buggy_code_start_loc": [53, 34, 108], "buggy_code_end_loc": [53, 34, 108], "fixing_code_start_loc": [54, 35, 109], "fixing_code_end_loc": [57, 37, 113], "type": "CWE-89", "message": "The Podlove Podcast Publisher WordPress plugin before 3.5.6 contains a 'Social & Donations' module (not activated by default), which adds the rest route '/services/contributor/(?P<id>[\\d]+), takes an 'id' and 'category' parameters as arguments. Both parameters can be used for the SQLi.", "other": {"cve": {"id": "CVE-2021-24666", "sourceIdentifier": "contact@wpscan.com", "published": "2021-09-27T16:15:09.107", "lastModified": "2021-10-05T17:55:32.357", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "The Podlove Podcast Publisher WordPress plugin before 3.5.6 contains a 'Social & Donations' module (not activated by default), which adds the rest route '/services/contributor/(?P<id>[\\d]+), takes an 'id' and 'category' parameters as arguments. Both parameters can be used for the SQLi."}, {"lang": "es", "value": "El plugin Podlove Podcast Publisher de WordPress versiones anteriores a 3.5.6, contiene un m\u00f3dulo \"Social &amp; Donations\" (no activado por defecto), que a\u00f1ade la ruta de descanso \"/services/contributor/(?P[\\d]+), toma los par\u00e1metros \"id\" y \"category\" como argumentos. Ambos par\u00e1metros pueden ser usados para el SQLi"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "contact@wpscan.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:podlove:podlove_podcast_publisher:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "3.5.6", "matchCriteriaId": "D3AD2097-B474-4FBF-999A-B85509713604"}]}]}], "references": [{"url": "https://github.com/podlove/podlove-publisher/commit/aa8a343a2e2333b34a422f801adee09b020c6d76", "source": "contact@wpscan.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://wpscan.com/vulnerability/fb4d7988-60ff-4862-96a1-80b1866336fe", "source": "contact@wpscan.com", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/podlove/podlove-publisher/commit/aa8a343a2e2333b34a422f801adee09b020c6d76"}}