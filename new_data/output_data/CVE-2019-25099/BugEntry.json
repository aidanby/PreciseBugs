{"buggy_code": ["QSF Portal Changes\n------------------\n\nChanges for 2.0:\n\n   New Features:\n\n* Added security header options to the site settings.\n* Added support for mobile icon metatags.\n* Added support to report spambot registrations to Akismet.\n* Added support for Gravatars. See: https://en.gravatar.com/\n* Added Akismet filter protection to signature edits. Eat shit spambots.\n* Added Akismet filter protection to forum posts. Eat shit again spambots.\n* Added Akismet filter protection to user profiles.\n* Added the ability to toggle file approvals on and off (global only).\n* Added a file version to the file data.\n* Added a new setting to block new user registration.\n* Added Facebook page to user profile data.\n* Added the ability to put extra links on the sidebar box to reduce the need for editing the base templates.\n* Friendly URL support has been added for much of the forum code. Requires the use of an .htaccess file.\n\n   Changes:\n\n* Replaced the skinning system with zTemplate. Skins are no longer stored in the database.\n* HTTP server data submitted with user registrations is now shown on the member control editing screen.\n* Emojis are now handled independently of skins and can be added on the fly as desired.\n* All references to \"Emoticon\" have been changed to \"Emoji\" to reflect what they're actually called now.\n* Changed all usage of serialize and unserialize to json_encode and json_decode to address potential PHP related vulnerabilities.\n* Default skin is now served as HTML5 instead of XHTML 1.1.\n* Password security has been updated to stronger hashing standards.\n* CSRF security tokens have been upgraded to use a cryptographically secure method. This support raises the minimum PHP requirement to 7.0.0.\n* Replaced the Akismet library with my own hand rolled version.\n* Updated Google Analytics support so you can just input the code snippet directly instead of altering source code.\n* The \"Add Setting\" function can now properly set up a new array.\n* Updated avatar handling.\n* Updated timezone handling to use more modern methods.\n* Updated the upgrade system so that a bunch of little files full of stuff aren't needed anymore. One file is sufficient with all the changes listed in sequence going forward.\n* The forum for news posts is now settable in the ACP instead of being hardcoded in the PHP files.\n* The AdminCP has new icons for decoration.\n* The custom logo section of the CSS has been separated into its own file which should not need to be updated during upgrades.\n\n   Removed:\n\n* Conversion from other ancient forum packages has been removed as they're all woefully obsolete and writing new ones would be a huge time sink for little gain.\n* Removed GTalk/Skype profile fields and replaced them with Twitter ID.\n* Eliminated Debug Mode as it was only truly useful for the old template system.\n* The unused HELP module has been removed.\n* Removed ICQ, MSN, AIM, and Yahoo from user profile data as those platforms are essentially all dead now.\n* Removed the defaultutils.php module as it seems unrealistic to have ever expected custom overrides of basic functions anyway.\n* Removed pgsql support as it became apparent nobody ever used it.\n* Removed the old mysql library as mysqli is the only thing officially supported in PHP 7.0 and above.\n* Removed the obsolete JSON libraries from the code.\n* Removed the rss folder as it no longer serves a purpose.\n* Removed server load checking as there is no real use for it anymore.\n* Removed the unused addons folder support.\n\n   Bugs addressed:\n\n* File updates were not unlinking the old files after replacing them with new ones, leading to large scale space waste.\n* Bare URLs entered into posts were getting stray single quotes placed around them.\n* News post retreival was not correctly handling time stamps. Posts were being displayed in random order.\n* When changing emails, passwords were not being verified using the proper secure hashing.\n* Corrected a number of long standing issues with selecting an avatar.\n\nChanges for 1.5.1:\n\n* Fixed IP address handling so that future IPv6 addresses will be displayed properly.\n* Extended the size of filenames in the files module to 50 chars from 32.\n* Updated the file rating pop-up to appear in the screen center instead of the corner.\n* Profile display will now show last visited date for that member.\n* Modified file size display formatting.\n* Added secondary captcha system that takes admin supplied questions and answers to challenge bots with since the math system has been defeated.\n* Slight rearranging of the forum topics display to save a bit of vertical space.\n* Groundwork laid for creating better file comments.\n* Updated the file details screen with a better layout.\n* Updated Google Analytics code.\n* It is now possible to upload to an otherwise hidden category to allow for one-way submissions.\n* Default number of members displayed per members page raised from 10 to 25.\n* Visual update to individual news posts.\n* Moved query stats to the board statistics box on the left side.\n* Dropped the messagelink and codelink modlets in favor of inline styling for new PMs and files pending approval.\n* Massive overhaul of the installer system. Dropped unsupported converters. Will bring back if the need arises.\n* Added MySQLi support.\n\n   Bugs addressed:\n\n* SECURITY: It was possible to view a category the user did not have permission to see using a direct link.\n* File permissions module was not setting the security token.\n* Fixed BBCode size tags messing up formatting of other tags.\n* Issue #3: Help articles don't format correctly.\n* Fixed database support to work on PHP 5.2 if a site is already installed there.\n* Fixed uncaught deprecated use of the split() function.\n* IP banning code did not work because IPs are stored with slashes.\n* Could not use multiple spoiler tags in one post.\n* Email and registration IP in member editing was being handled wrong.\n* Corrected the post box's inability to focus on the cursor position when using bbcode buttons.\n\nChanges for 1.5:\n\n* Implementation of a math based captcha to replace the image based system that was filled with deprecated PHP function calls.\n* General cleanup of the default skin.\n* Dropped Brightcove and Google Video BBCode controls.\n* Fatal errors will no longer report the details to the browser.\n* Replaced BBCode parser with the code used in Sandbox 2.x due to numerous PHP 5.3 deprecations in the old code.\n* Emoticons are now handled on a per-skin basis properly as they should have been.\n* Replacements table holding censored words trimmed of unneeded columns only used by emoticons.\n* Emoticon management module in the AdminCP has been removed.\n* Ashlander 3 has been formally adopted as the official skin.\n* Previous news listings at the bottom of the front page moved into a selector box.\n* Long awaited preview mode when editing posts.\n\n   Bugs addressed:\n\n* SECURITY: Secunia Advisory SA38783 fixed.\n* Security token for permissions update was not provided, causing form submission to fail.\n* Category display broken by split() deprecation.\n* Language fix for Akismet registration filtering.\n* Fixes for broken user lists and corrupted downloads.\n* Missing language for required registration cookies.\n* A few functions got missed in the cross-site request forgery sweep.\n\nChanges for 1.4.6:\n\n* Removed support for the IE6 pngfix. If you're still using IE6, upgrade.\n* Duplicate content discovered by Google Webmasters removed from the skin.\n* General optimization of the default skin. Removal of unused files.\n* Applied Kiasyn's patch to declutter the forum group permissions menu.\n\n   Bugs addressed:\n\n* SECURITY: Added protection against cross-site request forgery attacks.\n* Bug #192: Clicking on the search link in the files menu led to an infinite nesting loop that would exhaust the PHP memory limit.\n* Bug #168: Subscription check causes crash when editing group perms.\n* Bug #193: Youtube BBCode tag is not XHTML compliant. Also raised the size of the video preview box to 640x400.\n* Bug #194: Forumjump.js uses the wrong URL target.\n* Corrected more XHTML validation issues.\n\nChanges for 1.4.5:\n\n* Removed all non-English language files from the base package.\n* Changed the stats directory name to rss to avoid problems with how some web hosts handle the stats directory name.\n* Merged the \"users visited\" function into the users_online module so it can now be called through a MODLET statement.\n* User IP will be added to mail headers delivered through the email form.\n* Copyright footers updated for 2010. Non-essential skin change.\n* Google Analytics code updated.\n* Top of page will now display where a new post, poll, or reply is being made to.\n* Akismet filter support has been added to user registration and the email form.\n\n   Bugs addressed:\n\n* SECURITY: Secunia Advisory SA32823 fixed. \n* Bug #169: External http links are not setting _blank targets as needed. [Fixed by Detruire]\n* Bug #178: BBCode parser crashes on bad multibyte characters. [Fix by Kiasyn]\n* Topic locks and pins were not tracked if the action was done using the post reply form.\n* Registration process errors out when bots submit unset forms that are missing data.\n* Bug #183: The nofollow link attribute is being used improperly.\n* Missing avatars generate errors in the HTTP logs even though they shouldn't have.\n* Bug #180: Editing a root level file category added an extra forward slash to the long path name.\n* ACP Member controls crashed due to missing language elements.\n* Bug #184: Unread post links are not loading the correct posts.\n* Bug #186: Times on posts not displaying correctly.\n* HTML error in the TOPIC_MAIN template for the locked topic icon.\n* 7zip files should now identify properly in the files module.\n* Bad language text in the error message for a non-empty category.\n* Potential security exploit fixed in URL processing for the files module.\n\nChanges for 1.4.4:\n\n* Copyright footers updated for 2008. [Non-essential skin change]\n* Updated Google Analytics code to the new version.\n* Query field order needs to change for mysql 5.0.54 in the user library.\n* Removed unused portions of the error reporting.\n\n   Bugs addressed:\n\n* Bad array value in installer queries.\n* Missing language setting for existing files.\n* Missing member title icon in user query.\n* Page creation does not maintain checked flags.\n* Timezone shift bug solved by Davion.\n\nChanges for 1.4.3:\n\n* Close the DB connection once we're done with it.\n* Added an RSS feed for recent uploads.\n* Turned the root file category into a real one.\n* Added permissions to block editing or deleting posts older than a set time.\n* Added the ability to see what IPs a user has posted from.\n* Added TOS text setting for uploads.\n* Created generic TOS links on file and forum menus.\n* Able to mark PM's as unread. - Jon\n* All copyright headers updatd for 2008.\n\n   Bugs addressed:\n\n* Error library crashes when called from the AdminCP.\n* Mark forum as read link is not working.\n* A connection with a blank IP address will crash the site.\n* Poll icon is missing from the recent posts display.\n* File stats fix had an incorrect database field called.\n* Removing all member titles causes everyone to logout, as well as post problems. - Jon\n\nChanges for 1.4.2:\n\n  Bugs addressed:\n\n* SECURITY: The error reporting library will reveal database security info when an error connecting to the database is displayed.\n* The RSS reader needs to define a user agent due to restrictions in place at qsfportal.com\n\nChanges for 1.4.1:\n\n* Installer changed to use ENGINE instead of TYPE in table creation queries.\n* Made topic moderation links available at the top and bottom of a topic.\n* Added formatting flags to custom pages. [Fix hardcoded English]\n* Force quickreply box open when quote button is clicked.\n\n  Bugs addressed:\n\n* The quickreply icon is missing from the skin.\n* Topic titles had incorrect styling.\n* Quickreply button still appears even if a topic is locked.\n* Unset username or password during login triggers QSFP crash message instead of a graceful rejection message.\n* Censor bypass on RSS Feed.\n* E_STRICT warning in news module resolved.\n* E_STRICT warnings in image decoder library fixed.\n* Invisible text inside [center] tags fixed.\n* Return 404 errors for invalid modules.\n\nChanges for 1.4.0:\n\n* New default skin based on Syridium HForum v3 skin \ufffd 2006-2007 Syridium SC.\n* Fixed the 0.png to be a single transparent pixel.\n* Changed template color change can be difficult or impossible to see on LCD monitors.\n* Limit the maximum size of fonts in posts.\n* Unnecessary password restrictions removed.\n* Added \"Last Updated\" field to the file displays.\n* Added file category select box for navigation aid.\n* Safety checks to prevent blocking access to the portal.\n* Added code to adjust parent category counts when needed.\n\n  Bugs addressed:\n\n* Proper bbcode fix for the [root] tags which was only band-aided before.\n* Upgrade installer did not add new templates to skins.\n* Banning a user does not cancel subscriptions.\n* No HTML formatting on category/forum names.\n* Undefined offset in error handler.\n* Subscriptions still active if moved into a private forum. - Jon\n* IIS does not use $_SERVER['QUERY_STRING'] the same way Apache does. - Jon\n* Attachments to news posts do not produce a link in the text.\n* File description is not formatted properly when editing a file entry.\n* Recent posts listing did not check board_view permissions.\n\nChanges for 1.3.5:\n\n* Cleaned up member profile HTML.\n* Redirect after marking forums/board as read will use the URL from the AdminCP settings.\n* Added the ability to comment on news posts, and the use of a \"more\" link.\n* Overall code pruning and cleanup.\n* Better robots.txt handling by default. Inclusion of more restrictive optional robots file.\n* Support for Youtube, Google, and Brightcove video embedding in posts.\n* Removed detailed DST support. PHP date() function has sufficient support for general DST accuracy.\n\n  Bugs addressed:\n\n* Links to mark forums as read don't actually work.\n* BBcode crash if an invalid tag is only one character. Such as [1].\n\nChanges for 1.3.4:\n\n* Cosmetic improvements to the file module templates.\n* Added gzip detection at install.\n* Don't use zlib if the php extension isn't loaded.\n* Added support for Google Analytics tracking.\n* Timezone library outputs additional error information.\n* Added registration IP to user data.\n* Added logging for file related functions.\n\n  Bugs addressed:\n\n* Called wrong language field for non-existing custom page.\n* Crash if show_file gets called with an invalid file ID.\n* Crash in subforums with unread posts.\n* BBCode parsing fails on PHP 4 systems.\n* Conversion scripts had mismatches in database fields.\n* Post reply status checkboxes had no affect. (pin/lock after reply)\n\nChanges for 1.3.3:\n\n* Added language support for files module.\n* Added language support for file ratings module.\n* Added language support for custom pages module.\n* Move rsscache to the stats directory.\n* Added support for Internet Explorer HttpOnly cookies.\n* Added \"quick quote\" feature.\n* Post box area has been enlarged slightly.\n* Added lock and pin options to posting menu.\n* UI completion for cookie options.\n* URL redirection forum support added.\n* Links to jump to \"oldest unread post\".\n\n  Bugs addressed:\n\n* Adding file comments is not possible.\n* File ratings modlet was using wrong permission check.\n* RSS Feed exposes unpublished topics.\n* RSS feed email addresses were not RFC 2822 compliant.\n* New version of the bbcode parser included to address bugs in the old one.\n* Bad language pointer in the news modlet.\n* SQL backup now calls on mysqldump to address serious issues with the old backup code.\n* Board stats need to be recounted when a forum is deleted.\n* Users with over 1000 posts don't format the numbers in search results.\n* BBCode access key support was not working.\n* Fixed some queries which were using the wrong argument types.\n* File related tables need to be updated when users are deleted.\n\nChanges for 1.3.2:\n\n* Portal admins no longer require file uploads to be approved.\n* Removed several direct email address references to keep websvn from revealing them.\n* cms.php file was a stray and has been deleted.\n* Error messages should specify QSF Portal.\n* File categories now have an optional description field.\n* PM notification by mail option added.\n* Hovering over a topic title shows original post date.\n* Active users link shows activity in new modules now.\n* File system permissions upgraded to behave like forum permissions.\n* Fix member stats link in AdminCP will correct user post and upload counts now.\n\n  Bugs addressed:\n\n* Installer could not perform full upgrade from Mercuryboard 1.0.0\n* Calculation for uploads per day is wrong if less than one day has passed since the user joined.\n* Fatal error during installer for PHP < 5.1.\n* Missing 0.png image added to skin.\n* Fatal error renaming file categories.\n* Pass by reference error in avatar controls.\n* Syntax error in files.php, nestedSelect() for PHP < 5.1.\n* File category counters don't update when files are deleted.\n* XML backup data corrupts settings_data field when used in a restore.\n\nForum core changes prior to QSF Portal release\n----------------------------------------------\n\nChanges for 1.3.1:\n\n* Updated German translation - Jens\n* Updated Norwegian translation - Ingvild\n* Updated Swedish tranlsation - ladyanna\n* Added a warning on install if folders are not writable\n* Quick reply bbcode and smileys load on focus\n* New backup tool uses XML\n* Added new anti-troll permissions for avatars, profiles, and sigs.\n\n  Bugs addressed:\n\n* Renamed zip class to avoid conflict (#952)\n* Jump to newest post on recent posts was using old urls\n* Made sure textarea boxes are readable on usual windows themes - Matt\n* User posts can go negative (#957)\n* Censor words was not processing properly - harakiro\n* Converted most languages to utf-8 for JSON compatibility\n* Fixing icons in recent posts page (#888)\n* Not all backups and skins were showing in restore/install lists\n* Validation error in CP_PREFS template\n* Undefined string variable during board upgrade. Not fatal.\n* Topic marker crash for subforums.\n* Forum recount only needs to send the display when used from the AdminCP.\n\nChanges for 1.3.0:\n\n* Uploaded avatars now save using original extention\n* Can detect the size of uploaded avatars\n* Skin exporter/importer now uses XML and tar.gz files\n* Major rework on how addquotes is handled (now database end)\n* Installs now possible without making settings.php writable\n* Install now loads templates via XML\n* Avatars can now be grouped into sub-folders\n* Can now mark forums as read\n* Navigation links capitalised\n* Template position no longer exists\n* Debug mode can be toggled from admin cp\n* Can now add custom board settings via admin cp\n* BB Code buttons are now loaded via javascript\n* Added more strings to language files\n* Added date formats to language files\n\n  Bugs addressed:\n\n* Fix to ensure parent categories pick up changed post+reply count when topics are moved\n* Board admins can see users marked as 'hidden'\n* BBcode tags not working if split across lines\n* Fixed error in handing name/email display in RSS feeds\n* Maxlength added to topic title and description when editing topic\n* Fixed security hole in lib/activeutil.php\n* Fixing potential security hole in mailer subject\n\nChanges for 1.2.1:\n\n  Bugs addressed:\n\n* Addons directory was not present.\n* Post editing not handling reference properly in PHP4.\n* Board crash when timezone update was required.\n* Birthdays modlet referencing URL value incorrectly.\n* Upload patch to make safe mode attachments a little easier.\n* AdminCP not accessible if RSS feed is down.\n* Timezone autoincrement value in the installer bumped up to 387.\n* UserCP timezone selectors did not work in IE6 with javascript enabled.\n\nChanges for 1.2.0:\n\n  General Changes and Additions:\n* Spoilers now display an icon (like quotes and code blocks)\n* Recent posts includes all topics since last visit as well as all unread topics\n* Added db_pgsql class as a step towards future PostgreSQL support\n* Added html version of Docs\n* Removed old (mercuryboard) install guide\n* Can now download a backup directly without saving to the server\n* Minor change to chmod the created backup file\n* Added javascript to assist timezone selection\n* Logins now support PHP sessions if cookies fail to set. Session is fixed to IP\n* Updated timezones including three new timezones\n* Topic icons no longer hasn it's own column\n* Removed no-cache settings for admin cp\n* Speed information now supressed when not in debug mode\n* Topics can now be marked as published or unpublished - Jon\n* Birthday display is now handled as a modlet\n* ini_set only used if a mailserver is selected\n* Message Icons now use an unordered list rather than a table\n* RSS feeds now use templates\n* RSS feeds now include guid\n* New permission now marks if a post contributes to that user's postcount\n* Upgrades can now introduce new permissions that default to ON\n* Quickreply now available as a native feature\n* All new hander for tracking read and unread posts\n* Upgrade now informs user of what skins have been modified\n* Registration and stats images are now created in the stats folder\n* Moved to a more modular system with many new classes in lib\n* Clickable smilies now use an unorded list instead of a table\n* Moved timezone styling out to CSS file\n* BB code formatting now users em and strong instead of i and b\n* Removed printer module\n* Dropped any support for PHP versions older than 4.3.0\n\n  Bugs Addressed:\n* [security] Registration now uses sessions to stop spamming registration form\n* Split topics would not pick up new topic start author\n* Coundn't access PM outbox without javascript\n* Couldn't add a template with position 0\n* Spider agents are now set correctly and no longer require 2 arrays\n* Timezone class to handle timezone files with only one entry - Matt\n* Split topics did not count post replies properly\n* Could create a group without a name\n* Stopped moved topic leftovers showing in recent topics\n* Suckerfish menu was not working in IE for RTL languages\n* PNGs now render much better in IE\n* Unpinning a topic no longer marks it as new\n* No longer show users as online who wish to hide board activity\n* Very long user_agent string was causing errors\n* Was counting 1 too many replies when deleting a topic\n* Backup was providing an incorrect link to the backup file\n* User title not validated in admin cp - Matt\n* Extra slashes were appearing when editing attachments \n\n  Translation Updates:\n* Updated Swedish translation - LadyAnna\n* Big update to German translation - Ibus\n* Significant update to Hebrew translation - David (ddady)\n* Big update to Italian translation - Giuseppe\n* Norwegian translation completely rewritten - Ingvild\n* Big update to French translation - Brinick\n\nChanges for 1.1.9:\n\n* Separated out some more javascript files\n* Fixed bug in profile editing after signature editor was moved\n* Extra <br /> tag removed from AdminCP menu\n* Validation error in RECENT_MAIN template\n* XMB Forum convertor script added.\n* RSS Feed can now generate feeds for individual forums and topics.\n* Removed the defunct javascript files from the default skin.\n* New forum installation seeds itself with a default category, forum, and topic.\n* View next/prev topic links added.\n* IP address stored with PM.\n* Significant update to Italian translation\n* New template BOARD_CATEGORY_END\n* Ability to edit(add/delete) Attachments on posts\n* More PHP 5 and MySQL 5 bugfixes.\n* BUG: Modlets could not be used inside <IF> tags.\n* BUG: Search spiders were counting toward guest user total.\n* BUG: Code tags contained leadng spaces.\n* BUG: Error when editing profile\n\nChanges for 1.1.8:\n\n* New BB code for superscript, subscript and indent\n* Fixed bug in upgrading with non-default skins\n* Fixed bug in renaming a skin without permission to rename folder\n* Fixed anti-robot registration to no longer be case sensitive\n* Added handheld css to improve readability for handheld devices\n* Fix to xhtml validation error on posting\n* Updated French Translation - xboxrulz (still incomplete)\n* Pulled out attachment code into separate module\n* Fixed bug in restoring backups\n\nChanges for 1.1.7:\n\n* Fixed various bugs in the upgrade process\n\nChanges for 1.1.6:\n\n* Lots of cleanups to templates\n* Fixes to templates to improve IE rendering\n* Fixes to images not rendering transparency in IE\n* Many additional templates for Admin CP display\n* Improved forum install/conversion/upgrade system\n* Added Moderators core group\n* Changes to queries for MySQL 5.0.12 support\n* Fixed bug where non-admins could not have a custom title\n* Fixed error in Dutch language file\n* Tweaked handling of code tags to avoid making the last line invisible when code is very wide\n* Fixed handling of img tags inside url tags\n* Fixed bug where reminder message was not displaying\n* Changed quotes to use div tags instead of complex table\n* Added left (align) BB code tag\n* Fixed javascript for setting Avatar creating an endless loop if noavatar.png did not exist\n* Added vBulletin 3.5.1 convertor\n* Added MyBB converter\n* Added Invision Power Board 2.1.x convertor\n* General improvements and bugfixes to all forum convertors\n* Added spoiler BB code tag\n* Merged two queries in forum display\n* Fixed color tag to allow use of RGB as a color\n* Fixed guest posts displaying as duplicates when 2 or more guests logged in\n* Improved topic counting now recounts topic replies too - NiteShdw\n* Hack to stop rssfeed marking topics as read\n* Removed modlet:init()\n* Fixed RSS reader so it checks for templates correctly\n* Made statistics center more check for png support\n* Added row_format=fixed to speed up some tables\n* Added display of Forum name in Recent posts\n* robots.txt file to keep spiders from accessing things they don't need to\n* Plugged an XSS injection point\n* Poll options now use BB code\n* Added enhanced editor for user signatures - Jon\n* Pulled out BB code buttons into seperate template\n\nBugfixes for 1.1.4:\n\n* [font] and [color] code is not being sanitized properly.\n* BUG #2799: Fixed attachment bug where the index page was appended to the file output.\n* BUG #3053: SQL injection vulnerability in HTTP_USER_AGENT\n* BUG #2644: P3P Compact privacy header added - hopefully to solve IE6 login issues.\n* BUG #1210: Navigation tree for moved subforums does not reflect move.\n\nBugfixes in official 1.1.5 CVS branch:\n\n* New members are unable to register.\n* Removed the hardcoded styling from the $botformat variable.\n* Guest account must have a level > 0 to view the board.\n* Editing a post redirects to the first page of the topic, despite position of post edited.\n* Post icon is not changeable when editing a post.\n* Fixed skinning permission problems, well mostly anyway.\n* Better checking of email addresses (was too strict previously)\n* Administrators email not visible by default\n* New registrations get bad email link\n* No more endless \"Re: Re: Re: Re: ....\" in private message replies.\n* Database connection error check in index.php is called too late if not working.\n\nNew features and modifications for 1.1.5:\n\n* Added CubaLibre's \"Add HTML Template\" mod.\n* Added a \"Delete HTML Template\" mod.\n* Language support for AdminCP. Translations needed.\n* AdminCP is fully skinnable. Addition of several new templates for the AdminCP.\n* Added Ragnarok's \"spider display\" modification.\n* Added Geoff's \"recent topics\" modification.\n* Added ibarcode's adminbar modification.\n* AdminCP timezone selection from list instead of obscure number.\n* Added RSS Feed module.\n* Board admins can pick their own custom title now via the member controls.\n* Skins now exported and imported from within the skins directory.\n* Database backups are now saved in and restored from the databases directory.\n* Forum convertors have been mostly integrated into the installer.\n* Installer broken up into smaller chunks due to memory limit boundaries(!)\n* All images the skins/images directory converted to PNG format. Javascript included for IE5+ correction.\n* Links inside posts use rel=\"nofollow\" to discourage spamming\n* Subforums count towards parent category/forum topic and reply counts\n* Subforums considered in showing parent category/forum last post\n* Subforums can be created that behave like subcategories.\n* General input validation code added.\n* Board location URL calculated during installation.\n* Support for optional modules which can be enabled/disabled in the AdminCP.\n* More CSS control over quote box style.\n* ISO822 Date formatting added to mbdate() function. Used by RSS feeds.\n* <ELSE> now allowed in templates in addition to <IF>\n* Private message preview\n* Show ToS for newly registering users\n* FAQ added - Jonathan West <jon@quicksilverforums.com>\n* Can selectively delete private messages\n* <MODLET> tag now available to templates to allow including code on any template\n* Guests and new registrations have their language detected from the browser\n* Suckerfish style menu used in admin CP\n* Full Dutch translation\n* Full Swedish translation\n* improved speed in calculating dates 'today' and 'yesterday' - Matt\n* Registration prompts to agree to Terms of service\n* IP addresses stored as integer rather than varchar (save space)\n* debug link hidden from non-admins\n* FAQ added to documents\n* Automatic detection of guest language \n* Rss reader in Admin CP to alert of new releases or other important annoucements\n* Full timezone handling including daylight savings\n* New skin by http://www.misterpink.com.au/\n* Skin icons by http://www.famfamfam.com/\n* Fixes to handling of [patch] [code] and [php] tags\n* Fixed error where permissions were defaulting to full\n* Fixed error where you could not export a skin that included zero byte files\n* Sets skin to 'default' for administrators up upgrading\n* Full Slovak translation\n", "<?php\n/**\n * QSF Portal\n * Copyright (c) 2006-2019 The QSF Portal Development Team\n * https://github.com/Arthmoor/QSF-Portal\n *\n * Based on:\n *\n * Quicksilver Forums\n * Copyright (c) 2005-2011 The Quicksilver Forums Development Team\n * https://github.com/Arthmoor/Quicksilver-Forums\n *\n * MercuryBoard\n * Copyright (c) 2001-2006 The Mercury Development Team\n * https://github.com/markelliot/MercuryBoard\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n **/\n\nif( version_compare( PHP_VERSION, \"7.0.0\", \"<\" ) ) {\n\tdie( 'PHP version does not meet minimum requirements. Contact your system administrator.' );\n}\n\ndefine( 'QUICKSILVERFORUMS', true );\n\ndate_default_timezone_set( 'UTC' );\n\n$time_now   = explode( ' ', microtime() );\n$time_start = $time_now[1] + $time_now[0];\n\nsrand( (double)microtime() * 1234567 );\n\n$_REQUEST = array();\n\nrequire './settings.php';\n$set['include_path'] = '.';\nrequire_once $set['include_path'] . '/lib/' . $set['dbtype'] . '.php';\n$database = 'db_' . $set['dbtype'];\nrequire_once $set['include_path'] . '/lib/globalfunctions.php';\nrequire_once $set['include_path'] . '/lib/perms.php';\nrequire_once $set['include_path'] . '/lib/file_perms.php';\nrequire_once $set['include_path'] . '/lib/user.php';\nrequire_once $set['include_path'] . '/lib/mailer.php';\nrequire_once $set['include_path'] . '/lib/attachutil.php';\nrequire_once $set['include_path'] . '/lib/htmlwidgets.php';\nrequire_once $set['include_path'] . '/lib/bbcode.php';\nrequire_once $set['include_path'] . '/lib/tool.php';\nrequire_once $set['include_path'] . '/lib/readmarker.php';\nrequire_once $set['include_path'] . '/lib/activeutil.php';\nrequire_once $set['include_path'] . '/lib/modlet.php';\nrequire_once $set['include_path'] . '/lib/zTemplate.php';\n\nif( !$set['installed'] ) {\n\theader( 'Location: ./install/index.php' );\n}\n\nset_error_handler( 'error' );\n\nerror_reporting( E_ALL );\n\n// Open connection to database\n$db = new $database( $set['db_host'], $set['db_user'], $set['db_pass'], $set['db_name'], $set['db_port'], $set['db_socket'], $set['prefix'] );\nif( !$db->connection ) {\n\terror( QUICKSILVER_ERROR, 'A connection to the database could not be established and/or the specified database could not be found.', __FILE__, __LINE__ );\n}\n\n/*\n * Logic here:\n * If 'a' is not set, but some other query is, it's a bogus request for this software.\n * If 'a' is set, but the module doesn't exist, it's either a malformed URL or a bogus request.\n * Otherwise $missing remains false and no error is generated later.\n */\n$module = null;\n$qstring = null;\n$missing = false;\n$terms_module = '';\n\nif( !isset( $_GET['a'] ) ) {\n\t$module = 'main';\n\n\tif( isset( $_SERVER['QUERY_STRING'] ) && !empty( $_SERVER['QUERY_STRING'] ) ) {\n\t\t$qstring = $_SERVER['QUERY_STRING'];\n\n\t\t$missing = true;\n\t}\n} elseif( !file_exists( 'func/' . $_GET['a'] . '.php' ) ) {\n\t$module = 'main';\n\n\tif( $_GET['a'] != 'forum_rules' && $_GET['a'] != 'upload_rules' ) {\n\t\t$qstring = $_SERVER['REQUEST_URI'];\n\n\t\t$missing = true;\n\t} else {\n\t\t$terms_module = $_GET['a'];\n\t}\n} else {\n\t$module = $_GET['a'];\n}\n\nif( strstr( $module, '/' ) || strstr( $module, '\\\\' ) ) {\n\theader( 'HTTP/1.0 403 Forbidden' );\n\texit( 'You have been banned from this site.' );\n}\n\n// I know this looks corny and all but it mimics the output from a real 404 page.\nif( $missing ) {\n\theader( 'HTTP/1.0 404 Not Found' );\n\n\techo( \"<!DOCTYPE HTML PUBLIC \\\"-//IETF//DTD HTML 2.0//EN\\\">\n\t<html><head>\n\t<title>404 Not Found</title>\n\t</head><body>\n\t<h1>Not Found</h1>\n\t<p>The requested URL $qstring was not found on this server.</p>\n\t<hr>\n\t{$_SERVER['SERVER_SIGNATURE']}\t</body></html>\" );\n\n\texit( );\n}\n\nrequire './func/' . $module . '.php';\n\n$qsf = new $module( $db );\n$qsf->pre = $set['prefix'];\n\n$qsf->get['a'] = $module;\n$qsf->sets     = $qsf->get_settings( $set );\n$qsf->site     = $qsf->sets['loc_of_board']; // Will eventually replace $qsf->self once the SEO URL changes are done.\n\nsession_start();\n\n$qsf->user_cl = new user( $qsf );\n$qsf->user    = $qsf->user_cl->login();\n$qsf->lang    = $qsf->get_lang( $qsf->user['user_language'], $qsf->get['a'] );\n\nif( !isset( $qsf->get['skin'] ) ) {\n\t$skin = $qsf->db->fetch( 'SELECT skin_dir FROM %pskins WHERE skin_id=%d', $qsf->user['user_skin'] );\n\n\t$qsf->skin = $skin['skin_dir'];\n} elseif( $qsf->perms->auth( 'is_admin' ) ) {\n\t// Allow admins to specify a skin manually for development purposes.\n\t$skin = intval( $qsf->get['skin'] );\n\n\t$dev_skin = $qsf->db->fetch( 'SELECT skin_dir FROM %pskins WHERE skin_id=%d', $skin );\n\n\t$qsf->skin = $dev_skin['skin_dir'];\n}\n\n$qsf->init();\n\n// Security header options\nif( $qsf->sets['htts_enabled'] && $qsf->sets['htts_max_age'] > -1 ) {\n\theader( \"Strict-Transport-Security: max-age={$qsf->sets['htts_max_age']}\" );\n}\n\nif( $qsf->sets['xss_enabled'] ) {\n\tif( $qsf->sets['xss_policy'] == 0 ) {\n\t\theader( 'X-XSS-Protection: 0' );\n\t}\n\n\tif( $qsf->sets['xss_policy'] == 1 ) {\n\t\theader( 'X-XSS-Protection: 1' );\n\t}\n\n\tif( $qsf->sets['xss_policy'] == 2 ) {\n\t\theader( 'X-XSS-Protection: 1; mode=block' );\n\t}\n}\n\nif( $qsf->sets['xfo_enabled'] ) {\n\tif( $qsf->sets['xfo_policy'] == 0 ) {\n\t\theader( 'X-Frame-Options: deny' );\n\t}\n\n\tif( $qsf->sets['xfo_policy'] == 1 ) {\n\t\theader( 'X-Frame-Options: sameorigin' );\n\t}\n\n\tif( $qsf->sets['xfo_policy'] == 2 ) {\n\t\theader( \"X-Frame-Options: allow-from {$qsf->sets['xfo_allowed_origin']}\" );\n\t}\n}\n\nif( $qsf->sets['xcto_enabled'] ) {\n\theader( 'X-Content-Type-Options: nosniff' );\n}\n\nif( $qsf->sets['ect_enabled'] ) {\n\theader( \"Expect-CT: max-age={$qsf->sets['ect_max_age']}\" );\n}\n\nif( $qsf->sets['csp_enabled'] ) {\n\theader( \"Content-Security-Policy: {$qsf->sets['csp_details']}\" );\n}\n\nif( $qsf->is_banned() ) {\n\terror( QUICKSILVER_NOTICE, $qsf->lang->main_banned );\n}\n\n$qsf->tree( $qsf->sets['forum_name'], \"{$qsf->site}/board/\" );\n\n$qsf->add_feed( $qsf->site . '/index.php?a=rssfeed' );\n\nif( ( $qsf->get['a'] == 'forum' ) && isset( $qsf->get['f'] ) ) {\n\t$searchlink = '&amp;f=' . intval( $qsf->get['f'] );\n} else {\n\t$searchlink = null;\n}\n\n$spam_style = null;\nif( $qsf->sets['spam_pending'] > 0 )\n\t$spam_style = ' class=\"attention\"';\n$can_spam = false;\nif( $qsf->perms->auth( 'is_admin' ) || $qsf->user['user_group'] == USER_MODS )\n\t$can_spam = true;\n\n$new_pm = null;\nif( $qsf->get_messages() > 0 )\n\t$new_pm = ' class=\"attention\"';\n\n$new_files = null;\nif( $qsf->get_files() > 0 )\n\t$new_files = ' class=\"attention\"';\n\n$title = isset( $qsf->title ) ? $qsf->title : $qsf->sets['forum_name'];\n\n$time_now  = explode( ' ', microtime() );\n$qsf->time_exec = round( $time_now[1] + $time_now[0] - $time_start, 4 );\n\n$xtpl = new XTemplate( './skins/' . $qsf->skin . '/index.xtpl' );\n$qsf->xtpl = $xtpl;\n\nif( $terms_module == 'forum_rules' ) {\n\t$tos = $qsf->db->fetch( 'SELECT settings_tos FROM %psettings' );\n\n\t$message = $qsf->format( $tos['settings_tos'], FORMAT_HTMLCHARS | FORMAT_BREAKS | FORMAT_BBCODE );\n\t$output = $qsf->message( $qsf->lang->main_tos_forums, $message );\n} elseif ( $terms_module == 'upload_rules' ) {\n\t$tos = $qsf->db->fetch( 'SELECT settings_tos_files FROM %psettings' );\n\n\t$message = $qsf->format( $tos['settings_tos_files'], FORMAT_HTMLCHARS | FORMAT_BREAKS | FORMAT_BBCODE );\n\t$output = $qsf->message( $qsf->lang->main_tos_files, $message );\n} else {\n\t$output = $qsf->execute();\n}\n\nif( $qsf->nohtml ) {\n\tob_start( 'ob_gzhandler' );\n\n\techo $output;\n\n\t@ob_end_flush();\n\t@flush();\n} else {\n\t// Page headers and container wrapper.\n\t$xtpl->assign( 'user_language', $qsf->user['user_language'] );\n\t$xtpl->assign( 'charset', $qsf->lang->charset );\n\t$xtpl->assign( 'meta_keywords', $qsf->sets['meta_keywords'] );\n\t$xtpl->assign( 'meta_desc', $qsf->sets['meta_description'] );\n\t$xtpl->assign( 'mobile_icons', $qsf->sets['mobile_icons'] );\n\t$xtpl->assign( 'title', $title );\n\t$xtpl->assign( 'loc_of_board', $qsf->sets['loc_of_board'] );\n\t$xtpl->assign( 'skin', $qsf->skin );\n\t$xtpl->assign( 'feed_links', $qsf->feed_links );\n\n\t$left_links = null;\n\tforeach( $qsf->sets['left_sidebar_links'] as $link ) {\n\t\t$link = trim( $link );\n\n\t\t$left_links .= $link;\n\t}\n\n\t$xtpl->assign( 'index_left_links', $left_links );\n\n\t$right_links = null;\n\tforeach( $qsf->sets['right_sidebar_links'] as $link ) {\n\t\t$link = trim( $link );\n\n\t\t$right_links .= $link;\n\t}\n\n\t$xtpl->assign( 'index_right_links', $right_links );\n\n\t// Blocks on left side of front page.\n\tif( $qsf->perms->is_guest ) {\n\t\t$qsf->lang->login(); // For login words\n\t\t$qsf->lang->register(); // For registration word\n\n\t\t$xtpl->assign( 'qsf_site', $qsf->site );\n\t\t$xtpl->assign( 'forum_name', $qsf->sets['forum_name'] );\n\t\t$xtpl->assign( 'main_files', $qsf->lang->main_files );\n\t\t$xtpl->assign( 'main_forum', $qsf->lang->main_forum );\n\t\t$xtpl->assign( 'main_members', $qsf->lang->main_members );\n\t\t$xtpl->assign( 'searchlink', $searchlink );\n\t\t$xtpl->assign( 'main_search', $qsf->lang->main_search );\n\n\t\t$xtpl->assign( 'login', $qsf->lang->login );\n\n\t\t$request_uri = $qsf->get_uri();\n\t\tif( substr( $request_uri, -8 ) == 'register') {\n\t\t\t$request_uri = $qsf->self;\n\t\t}\n\t\t$xtpl->assign( 'request_uri', $request_uri );\n\n\t\t$xtpl->assign( 'login_user', $qsf->lang->login_user );\n\t\t$xtpl->assign( 'login_pass', $qsf->lang->login_pass );\n\t\t$xtpl->assign( 'submit', $qsf->lang->submit );\n\t\t$xtpl->assign( 'register_reg', $qsf->lang->register_reg );\n\t\t$xtpl->assign( 'login_forgot_pass', $qsf->lang->login_forgot_pass );\n\n\t\t$xtpl->parse( 'Index.GuestHeader' );\n\t} else {\n\t\t$xtpl->assign( 'qsf_site', $qsf->site );\n\t\t$xtpl->assign( 'forum_name', $qsf->sets['forum_name'] );\n\t\t$xtpl->assign( 'main_welcome', $qsf->lang->main_welcome );\n\t\t$xtpl->assign( 'user_id', $qsf->user['user_id'] );\n\t\t$xtpl->assign( 'user_name', $qsf->user['user_name'] );\n\t\t$xtpl->assign( 'link_name', $qsf->htmlwidgets->clean_url( $qsf->user['user_name'] ) );\n\t\t$xtpl->assign( 'new_files', $new_files );\n\t\t$xtpl->assign( 'main_files', $qsf->lang->main_files );\n\t\t$xtpl->assign( 'main_forum', $qsf->lang->main_forum );\n\n\t\tif( $qsf->perms->auth( 'page_create' ) || $qsf->perms->auth( 'page_edit' ) || $qsf->perms->auth( 'page_delete' ) ) {\n\t\t\t$xtpl->assign( 'main_pages', $qsf->lang->main_pages );\n\n\t\t\t$xtpl->parse( 'Index.MemberHeader.PagesLink' );\n\t\t}\n\n\t\t$xtpl->assign( 'main_members', $qsf->lang->main_members );\n\t\t$xtpl->assign( 'searchlink', $searchlink );\n\t\t$xtpl->assign( 'main_search', $qsf->lang->main_search );\n\n\t\tif( $can_spam ) {\n\t\t\t$xtpl->assign( 'spam_style', $spam_style );\n\t\t\t$xtpl->assign( 'main_spam_controls', $qsf->lang->main_spam_controls );\n\n\t\t\t$xtpl->parse( 'Index.MemberHeader.SpamLink' );\n\t\t}\n\n\t\t$xtpl->assign( 'new_pm', $new_pm );\n\t\t$xtpl->assign( 'main_messenger', $qsf->lang->main_messenger );\n\t\t$xtpl->assign( 'main_cp', $qsf->lang->main_cp );\n\n\t\tif( $qsf->perms->auth( 'is_admin' ) ) {\n\t\t\t$xtpl->assign( 'main_admincp', $qsf->lang->main_admincp );\n\n\t\t\t$xtpl->parse( 'Index.MemberHeader.AdminCPLink' );\n\t\t}\n\n\t\t$xtpl->assign( 'main_logout', $qsf->lang->main_logout );\n\n\t\t$xtpl->parse( 'Index.MemberHeader' );\n\t}\n\n\t// FIXME: All this 0 == 0 stuff should be settable as front page features.\n\t// Recent Posts\n\t$recent_posts = null;\n\tif( 0 == 0 ) {\n\t\trequire_once $set['include_path'] . '/modlets/recent_posts.php';\n\n\t\t$modlet = new recent_posts( $qsf );\n\n\t\t$recent_posts = $modlet->execute( false );\n\n\t\t$xtpl->assign( 'recent_posts', $recent_posts );\n\t}\n\n\t// Recent Uploads\n\t$recent_uploads = null;\n\tif( 0 == 0 ) {\n\t\trequire_once $set['include_path'] . '/modlets/recent_uploads.php';\n\n\t\t$modlet = new recent_uploads( $qsf );\n\n\t\t$recent_uploads = $modlet->execute( false );\n\n\t\t$xtpl->assign( 'recent_uploads', $recent_uploads );\n\t}\n\n\t// Top Posters\n\t$top_posters = null;\n\tif( 0 == 0 ) {\n\t\trequire_once $set['include_path'] . '/modlets/top_posters.php';\n\n\t\t$modlet = new top_posters( $qsf );\n\n\t\t$top_posters = $modlet->execute( false );\n\n\t\t$xtpl->assign( 'top_posters', $top_posters );\n\t}\n\n\t// Top Uploaders\n\t$top_uploaders = null;\n\tif( 0 == 0 ) {\n\t\trequire_once $set['include_path'] . '/modlets/top_uploaders.php';\n\n\t\t$modlet = new top_uploaders( $qsf );\n\n\t\t$top_uploaders = $modlet->execute( false );\n\n\t\t$xtpl->assign( 'top_uploaders', $top_uploaders );\n\t}\n\n\t// Users Online\n\t$users_online = null;\n\tif( 0 == 0 ) {\n\t\trequire_once $set['include_path'] . '/modlets/users_online.php';\n\n\t\t$modlet = new users_online( $qsf );\n\n\t\t$users_online = $modlet->execute( false );\n\n\t\t$xtpl->assign( 'users_online_block', $users_online );\n\t}\n\n\t// Board Stats\n\t$board_stats = null;\n\tif( 0 == 0 ) {\n\t\trequire_once $set['include_path'] . '/modlets/board_stats.php';\n\n\t\t$modlet = new board_stats( $qsf );\n\n\t\t$board_stats = $modlet->execute( true ); // FIXME: Birthdays should be optional display.\n\n\t\t$xtpl->assign( 'board_stats', $board_stats );\n\t}\n\n\t// Main section on right side of front page.\n\t$reminder = null;\n\t$reminder_text = null;\n\n\tif( $qsf->sets['closed'] ) {\n\t\tif( !$qsf->perms->auth( 'board_view_closed' ) ) {\n\t\t\tif( $qsf->get['a'] != 'login' ) {\n\t\t\t\terror( QUICKSILVER_NOTICE, $qsf->sets['closedtext'] . \"<br /><hr />If you are an administrator, <a href='{$qsf->site}/index.php?a=login&amp;s=on'>click here</a> to login.\" );\n\t\t\t}\n\t\t} else {\n\t\t\t$reminder_text = $qsf->lang->main_reminder_closed . '<br />&quot;' . $qsf->sets['closedtext'] . '&quot;';\n\t\t}\n\t}\n\n\tif( $qsf->user['user_group'] == USER_AWAIT ) {\n\t\t$reminder_text = \"{$qsf->lang->main_activate}<br /><a href='{$qsf->site}/register/&amp;s=resend'>{$qsf->lang->main_activate_resend}</a>\";\n\t}\n\tif( $reminder_text ) {\n\t\t$xtpl->assign( 'main_reminder', $qsf->lang->main_reminder );\n\t\t$xtpl->assign( 'reminder_text', $reminder_text );\n\n\t\t$xtpl->parse( 'Index.Reminder' );\n\t}\n\n\t// Generated by the specific module being accessed.\n\t$xtpl->assign( 'module_output', $output );\n\n\t// Footer section.\n\t$xtpl->assign( 'powered_by', $qsf->lang->powered );\n\t$xtpl->assign( 'qsf_name', $qsf->name );\n\t$xtpl->assign( 'based_on', $qsf->lang->based_on );\n\t$xtpl->assign( 'servertime', $qsf->mbdate( DATE_LONG, $qsf->time, false ) );\n\n\t$google = null;\n\tif( isset( $qsf->sets['analytics_code'] ) && !empty( $qsf->sets['analytics_code'] ) ) {\n\t\t$google = $qsf->sets['analytics_code'];\n\t}\n\t$xtpl->assign( 'google', $google );\n\n\t$xtpl->parse( 'Index' );\n\n\tob_start( 'ob_gzhandler' );\n\n\t$xtpl->out( 'Index' );\n\n\t@ob_end_flush();\n\t@flush();\n}\n\n// Do post output stuff\n$qsf->cleanup();\n\n// Close the DB connection.\n$qsf->db->close();\n?>"], "fixing_code": ["QSF Portal Changes\n------------------\n\nChanges for 2.0:\n\n   New Features:\n\n* Added security header options to the site settings.\n* Added support for mobile icon metatags.\n* Added support to report spambot registrations to Akismet.\n* Added support for Gravatars. See: https://en.gravatar.com/\n* Added Akismet filter protection to signature edits. Eat shit spambots.\n* Added Akismet filter protection to forum posts. Eat shit again spambots.\n* Added Akismet filter protection to user profiles.\n* Added the ability to toggle file approvals on and off (global only).\n* Added a file version to the file data.\n* Added a new setting to block new user registration.\n* Added Facebook page to user profile data.\n* Added the ability to put extra links on the sidebar box to reduce the need for editing the base templates.\n* Friendly URL support has been added for much of the forum code. Requires the use of an .htaccess file.\n\n   Changes:\n\n* Replaced the skinning system with zTemplate. Skins are no longer stored in the database.\n* HTTP server data submitted with user registrations is now shown on the member control editing screen.\n* Emojis are now handled independently of skins and can be added on the fly as desired.\n* All references to \"Emoticon\" have been changed to \"Emoji\" to reflect what they're actually called now.\n* Changed all usage of serialize and unserialize to json_encode and json_decode to address potential PHP related vulnerabilities.\n* Default skin is now served as HTML5 instead of XHTML 1.1.\n* Password security has been updated to stronger hashing standards.\n* CSRF security tokens have been upgraded to use a cryptographically secure method. This support raises the minimum PHP requirement to 7.0.0.\n* Replaced the Akismet library with my own hand rolled version.\n* Updated Google Analytics support so you can just input the code snippet directly instead of altering source code.\n* The \"Add Setting\" function can now properly set up a new array.\n* Updated avatar handling.\n* Updated timezone handling to use more modern methods.\n* Updated the upgrade system so that a bunch of little files full of stuff aren't needed anymore. One file is sufficient with all the changes listed in sequence going forward.\n* The forum for news posts is now settable in the ACP instead of being hardcoded in the PHP files.\n* The AdminCP has new icons for decoration.\n* The custom logo section of the CSS has been separated into its own file which should not need to be updated during upgrades.\n* Tweaked the initial module selection code to block out potential attacks and notify administrators when this happens.\n\n   Removed:\n\n* Conversion from other ancient forum packages has been removed as they're all woefully obsolete and writing new ones would be a huge time sink for little gain.\n* Removed GTalk/Skype profile fields and replaced them with Twitter ID.\n* Eliminated Debug Mode as it was only truly useful for the old template system.\n* The unused HELP module has been removed.\n* Removed ICQ, MSN, AIM, and Yahoo from user profile data as those platforms are essentially all dead now.\n* Removed the defaultutils.php module as it seems unrealistic to have ever expected custom overrides of basic functions anyway.\n* Removed pgsql support as it became apparent nobody ever used it.\n* Removed the old mysql library as mysqli is the only thing officially supported in PHP 7.0 and above.\n* Removed the obsolete JSON libraries from the code.\n* Removed the rss folder as it no longer serves a purpose.\n* Removed server load checking as there is no real use for it anymore.\n* Removed the unused addons folder support.\n\n   Bugs addressed:\n\n* File updates were not unlinking the old files after replacing them with new ones, leading to large scale space waste.\n* Bare URLs entered into posts were getting stray single quotes placed around them.\n* News post retreival was not correctly handling time stamps. Posts were being displayed in random order.\n* When changing emails, passwords were not being verified using the proper secure hashing.\n* Corrected a number of long standing issues with selecting an avatar.\n\nChanges for 1.5.1:\n\n* Fixed IP address handling so that future IPv6 addresses will be displayed properly.\n* Extended the size of filenames in the files module to 50 chars from 32.\n* Updated the file rating pop-up to appear in the screen center instead of the corner.\n* Profile display will now show last visited date for that member.\n* Modified file size display formatting.\n* Added secondary captcha system that takes admin supplied questions and answers to challenge bots with since the math system has been defeated.\n* Slight rearranging of the forum topics display to save a bit of vertical space.\n* Groundwork laid for creating better file comments.\n* Updated the file details screen with a better layout.\n* Updated Google Analytics code.\n* It is now possible to upload to an otherwise hidden category to allow for one-way submissions.\n* Default number of members displayed per members page raised from 10 to 25.\n* Visual update to individual news posts.\n* Moved query stats to the board statistics box on the left side.\n* Dropped the messagelink and codelink modlets in favor of inline styling for new PMs and files pending approval.\n* Massive overhaul of the installer system. Dropped unsupported converters. Will bring back if the need arises.\n* Added MySQLi support.\n\n   Bugs addressed:\n\n* SECURITY: It was possible to view a category the user did not have permission to see using a direct link.\n* File permissions module was not setting the security token.\n* Fixed BBCode size tags messing up formatting of other tags.\n* Issue #3: Help articles don't format correctly.\n* Fixed database support to work on PHP 5.2 if a site is already installed there.\n* Fixed uncaught deprecated use of the split() function.\n* IP banning code did not work because IPs are stored with slashes.\n* Could not use multiple spoiler tags in one post.\n* Email and registration IP in member editing was being handled wrong.\n* Corrected the post box's inability to focus on the cursor position when using bbcode buttons.\n\nChanges for 1.5:\n\n* Implementation of a math based captcha to replace the image based system that was filled with deprecated PHP function calls.\n* General cleanup of the default skin.\n* Dropped Brightcove and Google Video BBCode controls.\n* Fatal errors will no longer report the details to the browser.\n* Replaced BBCode parser with the code used in Sandbox 2.x due to numerous PHP 5.3 deprecations in the old code.\n* Emoticons are now handled on a per-skin basis properly as they should have been.\n* Replacements table holding censored words trimmed of unneeded columns only used by emoticons.\n* Emoticon management module in the AdminCP has been removed.\n* Ashlander 3 has been formally adopted as the official skin.\n* Previous news listings at the bottom of the front page moved into a selector box.\n* Long awaited preview mode when editing posts.\n\n   Bugs addressed:\n\n* SECURITY: Secunia Advisory SA38783 fixed.\n* Security token for permissions update was not provided, causing form submission to fail.\n* Category display broken by split() deprecation.\n* Language fix for Akismet registration filtering.\n* Fixes for broken user lists and corrupted downloads.\n* Missing language for required registration cookies.\n* A few functions got missed in the cross-site request forgery sweep.\n\nChanges for 1.4.6:\n\n* Removed support for the IE6 pngfix. If you're still using IE6, upgrade.\n* Duplicate content discovered by Google Webmasters removed from the skin.\n* General optimization of the default skin. Removal of unused files.\n* Applied Kiasyn's patch to declutter the forum group permissions menu.\n\n   Bugs addressed:\n\n* SECURITY: Added protection against cross-site request forgery attacks.\n* Bug #192: Clicking on the search link in the files menu led to an infinite nesting loop that would exhaust the PHP memory limit.\n* Bug #168: Subscription check causes crash when editing group perms.\n* Bug #193: Youtube BBCode tag is not XHTML compliant. Also raised the size of the video preview box to 640x400.\n* Bug #194: Forumjump.js uses the wrong URL target.\n* Corrected more XHTML validation issues.\n\nChanges for 1.4.5:\n\n* Removed all non-English language files from the base package.\n* Changed the stats directory name to rss to avoid problems with how some web hosts handle the stats directory name.\n* Merged the \"users visited\" function into the users_online module so it can now be called through a MODLET statement.\n* User IP will be added to mail headers delivered through the email form.\n* Copyright footers updated for 2010. Non-essential skin change.\n* Google Analytics code updated.\n* Top of page will now display where a new post, poll, or reply is being made to.\n* Akismet filter support has been added to user registration and the email form.\n\n   Bugs addressed:\n\n* SECURITY: Secunia Advisory SA32823 fixed. \n* Bug #169: External http links are not setting _blank targets as needed. [Fixed by Detruire]\n* Bug #178: BBCode parser crashes on bad multibyte characters. [Fix by Kiasyn]\n* Topic locks and pins were not tracked if the action was done using the post reply form.\n* Registration process errors out when bots submit unset forms that are missing data.\n* Bug #183: The nofollow link attribute is being used improperly.\n* Missing avatars generate errors in the HTTP logs even though they shouldn't have.\n* Bug #180: Editing a root level file category added an extra forward slash to the long path name.\n* ACP Member controls crashed due to missing language elements.\n* Bug #184: Unread post links are not loading the correct posts.\n* Bug #186: Times on posts not displaying correctly.\n* HTML error in the TOPIC_MAIN template for the locked topic icon.\n* 7zip files should now identify properly in the files module.\n* Bad language text in the error message for a non-empty category.\n* Potential security exploit fixed in URL processing for the files module.\n\nChanges for 1.4.4:\n\n* Copyright footers updated for 2008. [Non-essential skin change]\n* Updated Google Analytics code to the new version.\n* Query field order needs to change for mysql 5.0.54 in the user library.\n* Removed unused portions of the error reporting.\n\n   Bugs addressed:\n\n* Bad array value in installer queries.\n* Missing language setting for existing files.\n* Missing member title icon in user query.\n* Page creation does not maintain checked flags.\n* Timezone shift bug solved by Davion.\n\nChanges for 1.4.3:\n\n* Close the DB connection once we're done with it.\n* Added an RSS feed for recent uploads.\n* Turned the root file category into a real one.\n* Added permissions to block editing or deleting posts older than a set time.\n* Added the ability to see what IPs a user has posted from.\n* Added TOS text setting for uploads.\n* Created generic TOS links on file and forum menus.\n* Able to mark PM's as unread. - Jon\n* All copyright headers updatd for 2008.\n\n   Bugs addressed:\n\n* Error library crashes when called from the AdminCP.\n* Mark forum as read link is not working.\n* A connection with a blank IP address will crash the site.\n* Poll icon is missing from the recent posts display.\n* File stats fix had an incorrect database field called.\n* Removing all member titles causes everyone to logout, as well as post problems. - Jon\n\nChanges for 1.4.2:\n\n  Bugs addressed:\n\n* SECURITY: The error reporting library will reveal database security info when an error connecting to the database is displayed.\n* The RSS reader needs to define a user agent due to restrictions in place at qsfportal.com\n\nChanges for 1.4.1:\n\n* Installer changed to use ENGINE instead of TYPE in table creation queries.\n* Made topic moderation links available at the top and bottom of a topic.\n* Added formatting flags to custom pages. [Fix hardcoded English]\n* Force quickreply box open when quote button is clicked.\n\n  Bugs addressed:\n\n* The quickreply icon is missing from the skin.\n* Topic titles had incorrect styling.\n* Quickreply button still appears even if a topic is locked.\n* Unset username or password during login triggers QSFP crash message instead of a graceful rejection message.\n* Censor bypass on RSS Feed.\n* E_STRICT warning in news module resolved.\n* E_STRICT warnings in image decoder library fixed.\n* Invisible text inside [center] tags fixed.\n* Return 404 errors for invalid modules.\n\nChanges for 1.4.0:\n\n* New default skin based on Syridium HForum v3 skin \ufffd 2006-2007 Syridium SC.\n* Fixed the 0.png to be a single transparent pixel.\n* Changed template color change can be difficult or impossible to see on LCD monitors.\n* Limit the maximum size of fonts in posts.\n* Unnecessary password restrictions removed.\n* Added \"Last Updated\" field to the file displays.\n* Added file category select box for navigation aid.\n* Safety checks to prevent blocking access to the portal.\n* Added code to adjust parent category counts when needed.\n\n  Bugs addressed:\n\n* Proper bbcode fix for the [root] tags which was only band-aided before.\n* Upgrade installer did not add new templates to skins.\n* Banning a user does not cancel subscriptions.\n* No HTML formatting on category/forum names.\n* Undefined offset in error handler.\n* Subscriptions still active if moved into a private forum. - Jon\n* IIS does not use $_SERVER['QUERY_STRING'] the same way Apache does. - Jon\n* Attachments to news posts do not produce a link in the text.\n* File description is not formatted properly when editing a file entry.\n* Recent posts listing did not check board_view permissions.\n\nChanges for 1.3.5:\n\n* Cleaned up member profile HTML.\n* Redirect after marking forums/board as read will use the URL from the AdminCP settings.\n* Added the ability to comment on news posts, and the use of a \"more\" link.\n* Overall code pruning and cleanup.\n* Better robots.txt handling by default. Inclusion of more restrictive optional robots file.\n* Support for Youtube, Google, and Brightcove video embedding in posts.\n* Removed detailed DST support. PHP date() function has sufficient support for general DST accuracy.\n\n  Bugs addressed:\n\n* Links to mark forums as read don't actually work.\n* BBcode crash if an invalid tag is only one character. Such as [1].\n\nChanges for 1.3.4:\n\n* Cosmetic improvements to the file module templates.\n* Added gzip detection at install.\n* Don't use zlib if the php extension isn't loaded.\n* Added support for Google Analytics tracking.\n* Timezone library outputs additional error information.\n* Added registration IP to user data.\n* Added logging for file related functions.\n\n  Bugs addressed:\n\n* Called wrong language field for non-existing custom page.\n* Crash if show_file gets called with an invalid file ID.\n* Crash in subforums with unread posts.\n* BBCode parsing fails on PHP 4 systems.\n* Conversion scripts had mismatches in database fields.\n* Post reply status checkboxes had no affect. (pin/lock after reply)\n\nChanges for 1.3.3:\n\n* Added language support for files module.\n* Added language support for file ratings module.\n* Added language support for custom pages module.\n* Move rsscache to the stats directory.\n* Added support for Internet Explorer HttpOnly cookies.\n* Added \"quick quote\" feature.\n* Post box area has been enlarged slightly.\n* Added lock and pin options to posting menu.\n* UI completion for cookie options.\n* URL redirection forum support added.\n* Links to jump to \"oldest unread post\".\n\n  Bugs addressed:\n\n* Adding file comments is not possible.\n* File ratings modlet was using wrong permission check.\n* RSS Feed exposes unpublished topics.\n* RSS feed email addresses were not RFC 2822 compliant.\n* New version of the bbcode parser included to address bugs in the old one.\n* Bad language pointer in the news modlet.\n* SQL backup now calls on mysqldump to address serious issues with the old backup code.\n* Board stats need to be recounted when a forum is deleted.\n* Users with over 1000 posts don't format the numbers in search results.\n* BBCode access key support was not working.\n* Fixed some queries which were using the wrong argument types.\n* File related tables need to be updated when users are deleted.\n\nChanges for 1.3.2:\n\n* Portal admins no longer require file uploads to be approved.\n* Removed several direct email address references to keep websvn from revealing them.\n* cms.php file was a stray and has been deleted.\n* Error messages should specify QSF Portal.\n* File categories now have an optional description field.\n* PM notification by mail option added.\n* Hovering over a topic title shows original post date.\n* Active users link shows activity in new modules now.\n* File system permissions upgraded to behave like forum permissions.\n* Fix member stats link in AdminCP will correct user post and upload counts now.\n\n  Bugs addressed:\n\n* Installer could not perform full upgrade from Mercuryboard 1.0.0\n* Calculation for uploads per day is wrong if less than one day has passed since the user joined.\n* Fatal error during installer for PHP < 5.1.\n* Missing 0.png image added to skin.\n* Fatal error renaming file categories.\n* Pass by reference error in avatar controls.\n* Syntax error in files.php, nestedSelect() for PHP < 5.1.\n* File category counters don't update when files are deleted.\n* XML backup data corrupts settings_data field when used in a restore.\n\nForum core changes prior to QSF Portal release\n----------------------------------------------\n\nChanges for 1.3.1:\n\n* Updated German translation - Jens\n* Updated Norwegian translation - Ingvild\n* Updated Swedish tranlsation - ladyanna\n* Added a warning on install if folders are not writable\n* Quick reply bbcode and smileys load on focus\n* New backup tool uses XML\n* Added new anti-troll permissions for avatars, profiles, and sigs.\n\n  Bugs addressed:\n\n* Renamed zip class to avoid conflict (#952)\n* Jump to newest post on recent posts was using old urls\n* Made sure textarea boxes are readable on usual windows themes - Matt\n* User posts can go negative (#957)\n* Censor words was not processing properly - harakiro\n* Converted most languages to utf-8 for JSON compatibility\n* Fixing icons in recent posts page (#888)\n* Not all backups and skins were showing in restore/install lists\n* Validation error in CP_PREFS template\n* Undefined string variable during board upgrade. Not fatal.\n* Topic marker crash for subforums.\n* Forum recount only needs to send the display when used from the AdminCP.\n\nChanges for 1.3.0:\n\n* Uploaded avatars now save using original extention\n* Can detect the size of uploaded avatars\n* Skin exporter/importer now uses XML and tar.gz files\n* Major rework on how addquotes is handled (now database end)\n* Installs now possible without making settings.php writable\n* Install now loads templates via XML\n* Avatars can now be grouped into sub-folders\n* Can now mark forums as read\n* Navigation links capitalised\n* Template position no longer exists\n* Debug mode can be toggled from admin cp\n* Can now add custom board settings via admin cp\n* BB Code buttons are now loaded via javascript\n* Added more strings to language files\n* Added date formats to language files\n\n  Bugs addressed:\n\n* Fix to ensure parent categories pick up changed post+reply count when topics are moved\n* Board admins can see users marked as 'hidden'\n* BBcode tags not working if split across lines\n* Fixed error in handing name/email display in RSS feeds\n* Maxlength added to topic title and description when editing topic\n* Fixed security hole in lib/activeutil.php\n* Fixing potential security hole in mailer subject\n\nChanges for 1.2.1:\n\n  Bugs addressed:\n\n* Addons directory was not present.\n* Post editing not handling reference properly in PHP4.\n* Board crash when timezone update was required.\n* Birthdays modlet referencing URL value incorrectly.\n* Upload patch to make safe mode attachments a little easier.\n* AdminCP not accessible if RSS feed is down.\n* Timezone autoincrement value in the installer bumped up to 387.\n* UserCP timezone selectors did not work in IE6 with javascript enabled.\n\nChanges for 1.2.0:\n\n  General Changes and Additions:\n* Spoilers now display an icon (like quotes and code blocks)\n* Recent posts includes all topics since last visit as well as all unread topics\n* Added db_pgsql class as a step towards future PostgreSQL support\n* Added html version of Docs\n* Removed old (mercuryboard) install guide\n* Can now download a backup directly without saving to the server\n* Minor change to chmod the created backup file\n* Added javascript to assist timezone selection\n* Logins now support PHP sessions if cookies fail to set. Session is fixed to IP\n* Updated timezones including three new timezones\n* Topic icons no longer hasn it's own column\n* Removed no-cache settings for admin cp\n* Speed information now supressed when not in debug mode\n* Topics can now be marked as published or unpublished - Jon\n* Birthday display is now handled as a modlet\n* ini_set only used if a mailserver is selected\n* Message Icons now use an unordered list rather than a table\n* RSS feeds now use templates\n* RSS feeds now include guid\n* New permission now marks if a post contributes to that user's postcount\n* Upgrades can now introduce new permissions that default to ON\n* Quickreply now available as a native feature\n* All new hander for tracking read and unread posts\n* Upgrade now informs user of what skins have been modified\n* Registration and stats images are now created in the stats folder\n* Moved to a more modular system with many new classes in lib\n* Clickable smilies now use an unorded list instead of a table\n* Moved timezone styling out to CSS file\n* BB code formatting now users em and strong instead of i and b\n* Removed printer module\n* Dropped any support for PHP versions older than 4.3.0\n\n  Bugs Addressed:\n* [security] Registration now uses sessions to stop spamming registration form\n* Split topics would not pick up new topic start author\n* Coundn't access PM outbox without javascript\n* Couldn't add a template with position 0\n* Spider agents are now set correctly and no longer require 2 arrays\n* Timezone class to handle timezone files with only one entry - Matt\n* Split topics did not count post replies properly\n* Could create a group without a name\n* Stopped moved topic leftovers showing in recent topics\n* Suckerfish menu was not working in IE for RTL languages\n* PNGs now render much better in IE\n* Unpinning a topic no longer marks it as new\n* No longer show users as online who wish to hide board activity\n* Very long user_agent string was causing errors\n* Was counting 1 too many replies when deleting a topic\n* Backup was providing an incorrect link to the backup file\n* User title not validated in admin cp - Matt\n* Extra slashes were appearing when editing attachments \n\n  Translation Updates:\n* Updated Swedish translation - LadyAnna\n* Big update to German translation - Ibus\n* Significant update to Hebrew translation - David (ddady)\n* Big update to Italian translation - Giuseppe\n* Norwegian translation completely rewritten - Ingvild\n* Big update to French translation - Brinick\n\nChanges for 1.1.9:\n\n* Separated out some more javascript files\n* Fixed bug in profile editing after signature editor was moved\n* Extra <br /> tag removed from AdminCP menu\n* Validation error in RECENT_MAIN template\n* XMB Forum convertor script added.\n* RSS Feed can now generate feeds for individual forums and topics.\n* Removed the defunct javascript files from the default skin.\n* New forum installation seeds itself with a default category, forum, and topic.\n* View next/prev topic links added.\n* IP address stored with PM.\n* Significant update to Italian translation\n* New template BOARD_CATEGORY_END\n* Ability to edit(add/delete) Attachments on posts\n* More PHP 5 and MySQL 5 bugfixes.\n* BUG: Modlets could not be used inside <IF> tags.\n* BUG: Search spiders were counting toward guest user total.\n* BUG: Code tags contained leadng spaces.\n* BUG: Error when editing profile\n\nChanges for 1.1.8:\n\n* New BB code for superscript, subscript and indent\n* Fixed bug in upgrading with non-default skins\n* Fixed bug in renaming a skin without permission to rename folder\n* Fixed anti-robot registration to no longer be case sensitive\n* Added handheld css to improve readability for handheld devices\n* Fix to xhtml validation error on posting\n* Updated French Translation - xboxrulz (still incomplete)\n* Pulled out attachment code into separate module\n* Fixed bug in restoring backups\n\nChanges for 1.1.7:\n\n* Fixed various bugs in the upgrade process\n\nChanges for 1.1.6:\n\n* Lots of cleanups to templates\n* Fixes to templates to improve IE rendering\n* Fixes to images not rendering transparency in IE\n* Many additional templates for Admin CP display\n* Improved forum install/conversion/upgrade system\n* Added Moderators core group\n* Changes to queries for MySQL 5.0.12 support\n* Fixed bug where non-admins could not have a custom title\n* Fixed error in Dutch language file\n* Tweaked handling of code tags to avoid making the last line invisible when code is very wide\n* Fixed handling of img tags inside url tags\n* Fixed bug where reminder message was not displaying\n* Changed quotes to use div tags instead of complex table\n* Added left (align) BB code tag\n* Fixed javascript for setting Avatar creating an endless loop if noavatar.png did not exist\n* Added vBulletin 3.5.1 convertor\n* Added MyBB converter\n* Added Invision Power Board 2.1.x convertor\n* General improvements and bugfixes to all forum convertors\n* Added spoiler BB code tag\n* Merged two queries in forum display\n* Fixed color tag to allow use of RGB as a color\n* Fixed guest posts displaying as duplicates when 2 or more guests logged in\n* Improved topic counting now recounts topic replies too - NiteShdw\n* Hack to stop rssfeed marking topics as read\n* Removed modlet:init()\n* Fixed RSS reader so it checks for templates correctly\n* Made statistics center more check for png support\n* Added row_format=fixed to speed up some tables\n* Added display of Forum name in Recent posts\n* robots.txt file to keep spiders from accessing things they don't need to\n* Plugged an XSS injection point\n* Poll options now use BB code\n* Added enhanced editor for user signatures - Jon\n* Pulled out BB code buttons into seperate template\n\nBugfixes for 1.1.4:\n\n* [font] and [color] code is not being sanitized properly.\n* BUG #2799: Fixed attachment bug where the index page was appended to the file output.\n* BUG #3053: SQL injection vulnerability in HTTP_USER_AGENT\n* BUG #2644: P3P Compact privacy header added - hopefully to solve IE6 login issues.\n* BUG #1210: Navigation tree for moved subforums does not reflect move.\n\nBugfixes in official 1.1.5 CVS branch:\n\n* New members are unable to register.\n* Removed the hardcoded styling from the $botformat variable.\n* Guest account must have a level > 0 to view the board.\n* Editing a post redirects to the first page of the topic, despite position of post edited.\n* Post icon is not changeable when editing a post.\n* Fixed skinning permission problems, well mostly anyway.\n* Better checking of email addresses (was too strict previously)\n* Administrators email not visible by default\n* New registrations get bad email link\n* No more endless \"Re: Re: Re: Re: ....\" in private message replies.\n* Database connection error check in index.php is called too late if not working.\n\nNew features and modifications for 1.1.5:\n\n* Added CubaLibre's \"Add HTML Template\" mod.\n* Added a \"Delete HTML Template\" mod.\n* Language support for AdminCP. Translations needed.\n* AdminCP is fully skinnable. Addition of several new templates for the AdminCP.\n* Added Ragnarok's \"spider display\" modification.\n* Added Geoff's \"recent topics\" modification.\n* Added ibarcode's adminbar modification.\n* AdminCP timezone selection from list instead of obscure number.\n* Added RSS Feed module.\n* Board admins can pick their own custom title now via the member controls.\n* Skins now exported and imported from within the skins directory.\n* Database backups are now saved in and restored from the databases directory.\n* Forum convertors have been mostly integrated into the installer.\n* Installer broken up into smaller chunks due to memory limit boundaries(!)\n* All images the skins/images directory converted to PNG format. Javascript included for IE5+ correction.\n* Links inside posts use rel=\"nofollow\" to discourage spamming\n* Subforums count towards parent category/forum topic and reply counts\n* Subforums considered in showing parent category/forum last post\n* Subforums can be created that behave like subcategories.\n* General input validation code added.\n* Board location URL calculated during installation.\n* Support for optional modules which can be enabled/disabled in the AdminCP.\n* More CSS control over quote box style.\n* ISO822 Date formatting added to mbdate() function. Used by RSS feeds.\n* <ELSE> now allowed in templates in addition to <IF>\n* Private message preview\n* Show ToS for newly registering users\n* FAQ added - Jonathan West <jon@quicksilverforums.com>\n* Can selectively delete private messages\n* <MODLET> tag now available to templates to allow including code on any template\n* Guests and new registrations have their language detected from the browser\n* Suckerfish style menu used in admin CP\n* Full Dutch translation\n* Full Swedish translation\n* improved speed in calculating dates 'today' and 'yesterday' - Matt\n* Registration prompts to agree to Terms of service\n* IP addresses stored as integer rather than varchar (save space)\n* debug link hidden from non-admins\n* FAQ added to documents\n* Automatic detection of guest language \n* Rss reader in Admin CP to alert of new releases or other important annoucements\n* Full timezone handling including daylight savings\n* New skin by http://www.misterpink.com.au/\n* Skin icons by http://www.famfamfam.com/\n* Fixes to handling of [patch] [code] and [php] tags\n* Fixed error where permissions were defaulting to full\n* Fixed error where you could not export a skin that included zero byte files\n* Sets skin to 'default' for administrators up upgrading\n* Full Slovak translation\n", "<?php\n/**\n * QSF Portal\n * Copyright (c) 2006-2019 The QSF Portal Development Team\n * https://github.com/Arthmoor/QSF-Portal\n *\n * Based on:\n *\n * Quicksilver Forums\n * Copyright (c) 2005-2011 The Quicksilver Forums Development Team\n * https://github.com/Arthmoor/Quicksilver-Forums\n *\n * MercuryBoard\n * Copyright (c) 2001-2006 The Mercury Development Team\n * https://github.com/markelliot/MercuryBoard\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n **/\n\nif( version_compare( PHP_VERSION, \"7.0.0\", \"<\" ) ) {\n\tdie( 'PHP version does not meet minimum requirements. Contact your system administrator.' );\n}\n\nfunction log_hostile_action( $set, $qstring )\n{\n\tif( isset( $set['admin_email'] ) ) {\n\t\t$https = isset( $_SERVER['HTTPS'] ) ? 'https://' : 'http://';\n\n\t\t$headers = \"From: Your QSF Portal Site <{$set['admin_email']}>\\r\\n\" . \"X-Mailer: PHP/\" . phpversion();\n\n\t\t$agent = isset( $_SERVER['HTTP_USER_AGENT'] ) ? $_SERVER['HTTP_USER_AGENT'] : 'N/A';\n\t\t$ip = isset( $_SERVER['REMOTE_ADDR'] ) ? $_SERVER['REMOTE_ADDR'] : '127.0.0.1';\n\n\t\t$error_report = \"QSF Portal has intercepted a possible attack!\\n\";\n\t\t$error_report .= \"The details are as follows:\\n\\nURL: $https\" . $_SERVER['SERVER_NAME'] . $_SERVER['PHP_SELF'] . \"?\" . $qstring . \"\\n\";\n\t\t$error_report .= \"Querying user agent: \" . $agent . \"\\n\";\n\t\t$error_report .= \"Querying IP: \" . $ip . \"\\n\\n\";\n\t\t$error_report = str_replace( \"&nbsp;\", \" \", html_entity_decode( $error_report ) );\n\n\t\t@mail( $set['admin_email'], \"[QSF Portal] Potential Attack Intercepted\", $error_report, $headers );\n\t}\n}\n\ndefine( 'QUICKSILVERFORUMS', true );\n\ndate_default_timezone_set( 'UTC' );\n\nsession_start();\n\n$time_now   = explode( ' ', microtime() );\n$time_start = $time_now[1] + $time_now[0];\n\nsrand( (double)microtime() * 1234567 );\n\n$_REQUEST = array();\n\nrequire './settings.php';\n$set['include_path'] = '.';\nrequire_once $set['include_path'] . '/lib/' . $set['dbtype'] . '.php';\n$database = 'db_' . $set['dbtype'];\nrequire_once $set['include_path'] . '/lib/globalfunctions.php';\nrequire_once $set['include_path'] . '/lib/perms.php';\nrequire_once $set['include_path'] . '/lib/file_perms.php';\nrequire_once $set['include_path'] . '/lib/user.php';\nrequire_once $set['include_path'] . '/lib/mailer.php';\nrequire_once $set['include_path'] . '/lib/attachutil.php';\nrequire_once $set['include_path'] . '/lib/htmlwidgets.php';\nrequire_once $set['include_path'] . '/lib/bbcode.php';\nrequire_once $set['include_path'] . '/lib/tool.php';\nrequire_once $set['include_path'] . '/lib/readmarker.php';\nrequire_once $set['include_path'] . '/lib/activeutil.php';\nrequire_once $set['include_path'] . '/lib/modlet.php';\nrequire_once $set['include_path'] . '/lib/zTemplate.php';\n\nif( !$set['installed'] ) {\n\theader( 'Location: ./install/index.php' );\n}\n\nset_error_handler( 'error' );\n\nerror_reporting( E_ALL );\n\n// Open connection to database\n$db = new $database( $set['db_host'], $set['db_user'], $set['db_pass'], $set['db_name'], $set['db_port'], $set['db_socket'], $set['prefix'] );\nif( !$db->connection ) {\n\terror( QUICKSILVER_ERROR, 'A connection to the database could not be established and/or the specified database could not be found.', __FILE__, __LINE__ );\n}\n\n/*\n * Logic here:\n * If 'a' is not set, but some other query is, it's a bogus request for this software.\n * If 'a' is set, but the module doesn't exist, it's either a malformed URL or a bogus request.\n * Otherwise $missing remains false and no error is generated later.\n */\n$module = null;\n$qstring = null;\n$missing = false;\n$terms_module = '';\n\nif( !isset( $_GET['a'] ) ) {\n\t$module = 'main';\n\n\tif( isset( $_SERVER['QUERY_STRING'] ) && !empty( $_SERVER['QUERY_STRING'] ) ) {\n\t\t$qstring = $_SERVER['QUERY_STRING'];\n\n\t\t$missing = true;\n\t}\n} elseif( !empty( $_GET['a'] ) ) {\n\tif( strstr( $_GET['a'], '/' ) || strstr( $_GET['a'], '\\\\' ) || strstr( $_GET['a'], '.' ) ) {\n\t\tif( isset( $_SERVER['QUERY_STRING'] ) && !empty( $_SERVER['QUERY_STRING'] ) ) {\n\t\t\t$qstring = $_SERVER['QUERY_STRING'];\n\t\t}\n\n\t\t$missing = true;\n\n\t\t$_SESSION = array();\n\n\t\tsession_destroy();\n\n\t\tlog_hostile_action( $set, $qstring );\n\n\t\theader( 'Clear-Site-Data: \"*\"' );\n\t} elseif( !file_exists( 'func/' . $_GET['a'] . '.php' ) ) {\n\t\t$module = 'main';\n\n\t\tif( $_GET['a'] != 'forum_rules' && $_GET['a'] != 'upload_rules' ) {\n\t\t\t$qstring = $_SERVER['REQUEST_URI'];\n\n\t\t\t$missing = true;\n\t\t} else {\n\t\t\t$terms_module = $_GET['a'];\n\t\t}\n\t} else {\n\t\t$module = $_GET['a'];\n\t}\n} else {\n\tif( isset( $_SERVER['QUERY_STRING'] ) && !empty( $_SERVER['QUERY_STRING'] ) ) {\n\t\t$qstring = $_SERVER['QUERY_STRING'];\n\n\t\t$missing = true;\n\t}\n}\n\n// I know this looks corny and all but it mimics the output from a real 404 page.\nif( $missing ) {\n\theader( 'HTTP/1.0 404 Not Found' );\n\n\techo( \"<!DOCTYPE HTML PUBLIC \\\"-//IETF//DTD HTML 2.0//EN\\\">\n\t<html><head>\n\t<title>404 Not Found</title>\n\t</head><body>\n\t<h1>Not Found</h1>\n\t<p>The requested URL $qstring was not found on this server.</p>\n\t<hr>\n\t{$_SERVER['SERVER_SIGNATURE']}\t</body></html>\" );\n\n\texit( );\n}\n\nrequire './func/' . $module . '.php';\n\n$qsf = new $module( $db );\n$qsf->pre = $set['prefix'];\n\n$qsf->get['a'] = $module;\n$qsf->sets     = $qsf->get_settings( $set );\n$qsf->site     = $qsf->sets['loc_of_board']; // Will eventually replace $qsf->self once the SEO URL changes are done.\n\n$qsf->user_cl = new user( $qsf );\n$qsf->user    = $qsf->user_cl->login();\n$qsf->lang    = $qsf->get_lang( $qsf->user['user_language'], $qsf->get['a'] );\n\nif( !isset( $qsf->get['skin'] ) ) {\n\t$skin = $qsf->db->fetch( 'SELECT skin_dir FROM %pskins WHERE skin_id=%d', $qsf->user['user_skin'] );\n\n\t$qsf->skin = $skin['skin_dir'];\n} elseif( $qsf->perms->auth( 'is_admin' ) ) {\n\t// Allow admins to specify a skin manually for development purposes.\n\t$skin = intval( $qsf->get['skin'] );\n\n\t$dev_skin = $qsf->db->fetch( 'SELECT skin_dir FROM %pskins WHERE skin_id=%d', $skin );\n\n\t$qsf->skin = $dev_skin['skin_dir'];\n}\n\n$qsf->init();\n\n// Security header options\nif( $qsf->sets['htts_enabled'] && $qsf->sets['htts_max_age'] > -1 ) {\n\theader( \"Strict-Transport-Security: max-age={$qsf->sets['htts_max_age']}\" );\n}\n\nif( $qsf->sets['xss_enabled'] ) {\n\tif( $qsf->sets['xss_policy'] == 0 ) {\n\t\theader( 'X-XSS-Protection: 0' );\n\t}\n\n\tif( $qsf->sets['xss_policy'] == 1 ) {\n\t\theader( 'X-XSS-Protection: 1' );\n\t}\n\n\tif( $qsf->sets['xss_policy'] == 2 ) {\n\t\theader( 'X-XSS-Protection: 1; mode=block' );\n\t}\n}\n\nif( $qsf->sets['xfo_enabled'] ) {\n\tif( $qsf->sets['xfo_policy'] == 0 ) {\n\t\theader( 'X-Frame-Options: deny' );\n\t}\n\n\tif( $qsf->sets['xfo_policy'] == 1 ) {\n\t\theader( 'X-Frame-Options: sameorigin' );\n\t}\n\n\tif( $qsf->sets['xfo_policy'] == 2 ) {\n\t\theader( \"X-Frame-Options: allow-from {$qsf->sets['xfo_allowed_origin']}\" );\n\t}\n}\n\nif( $qsf->sets['xcto_enabled'] ) {\n\theader( 'X-Content-Type-Options: nosniff' );\n}\n\nif( $qsf->sets['ect_enabled'] ) {\n\theader( \"Expect-CT: max-age={$qsf->sets['ect_max_age']}\" );\n}\n\nif( $qsf->sets['csp_enabled'] ) {\n\theader( \"Content-Security-Policy: {$qsf->sets['csp_details']}\" );\n}\n\nif( $qsf->is_banned() ) {\n\terror( QUICKSILVER_NOTICE, $qsf->lang->main_banned );\n}\n\n$qsf->tree( $qsf->sets['forum_name'], \"{$qsf->site}/board/\" );\n\n$qsf->add_feed( $qsf->site . '/index.php?a=rssfeed' );\n\nif( ( $qsf->get['a'] == 'forum' ) && isset( $qsf->get['f'] ) ) {\n\t$searchlink = '&amp;f=' . intval( $qsf->get['f'] );\n} else {\n\t$searchlink = null;\n}\n\n$spam_style = null;\nif( $qsf->sets['spam_pending'] > 0 )\n\t$spam_style = ' class=\"attention\"';\n$can_spam = false;\nif( $qsf->perms->auth( 'is_admin' ) || $qsf->user['user_group'] == USER_MODS )\n\t$can_spam = true;\n\n$new_pm = null;\nif( $qsf->get_messages() > 0 )\n\t$new_pm = ' class=\"attention\"';\n\n$new_files = null;\nif( $qsf->get_files() > 0 )\n\t$new_files = ' class=\"attention\"';\n\n$title = isset( $qsf->title ) ? $qsf->title : $qsf->sets['forum_name'];\n\n$time_now  = explode( ' ', microtime() );\n$qsf->time_exec = round( $time_now[1] + $time_now[0] - $time_start, 4 );\n\n$xtpl = new XTemplate( './skins/' . $qsf->skin . '/index.xtpl' );\n$qsf->xtpl = $xtpl;\n\nif( $terms_module == 'forum_rules' ) {\n\t$tos = $qsf->db->fetch( 'SELECT settings_tos FROM %psettings' );\n\n\t$message = $qsf->format( $tos['settings_tos'], FORMAT_HTMLCHARS | FORMAT_BREAKS | FORMAT_BBCODE );\n\t$output = $qsf->message( $qsf->lang->main_tos_forums, $message );\n} elseif ( $terms_module == 'upload_rules' ) {\n\t$tos = $qsf->db->fetch( 'SELECT settings_tos_files FROM %psettings' );\n\n\t$message = $qsf->format( $tos['settings_tos_files'], FORMAT_HTMLCHARS | FORMAT_BREAKS | FORMAT_BBCODE );\n\t$output = $qsf->message( $qsf->lang->main_tos_files, $message );\n} else {\n\t$output = $qsf->execute();\n}\n\nif( $qsf->nohtml ) {\n\tob_start( 'ob_gzhandler' );\n\n\techo $output;\n\n\t@ob_end_flush();\n\t@flush();\n} else {\n\t// Page headers and container wrapper.\n\t$xtpl->assign( 'user_language', $qsf->user['user_language'] );\n\t$xtpl->assign( 'charset', $qsf->lang->charset );\n\t$xtpl->assign( 'meta_keywords', $qsf->sets['meta_keywords'] );\n\t$xtpl->assign( 'meta_desc', $qsf->sets['meta_description'] );\n\t$xtpl->assign( 'mobile_icons', $qsf->sets['mobile_icons'] );\n\t$xtpl->assign( 'title', $title );\n\t$xtpl->assign( 'loc_of_board', $qsf->sets['loc_of_board'] );\n\t$xtpl->assign( 'skin', $qsf->skin );\n\t$xtpl->assign( 'feed_links', $qsf->feed_links );\n\n\t$left_links = null;\n\tforeach( $qsf->sets['left_sidebar_links'] as $link ) {\n\t\t$link = trim( $link );\n\n\t\t$left_links .= $link;\n\t}\n\n\t$xtpl->assign( 'index_left_links', $left_links );\n\n\t$right_links = null;\n\tforeach( $qsf->sets['right_sidebar_links'] as $link ) {\n\t\t$link = trim( $link );\n\n\t\t$right_links .= $link;\n\t}\n\n\t$xtpl->assign( 'index_right_links', $right_links );\n\n\t// Blocks on left side of front page.\n\tif( $qsf->perms->is_guest ) {\n\t\t$qsf->lang->login(); // For login words\n\t\t$qsf->lang->register(); // For registration word\n\n\t\t$xtpl->assign( 'qsf_site', $qsf->site );\n\t\t$xtpl->assign( 'forum_name', $qsf->sets['forum_name'] );\n\t\t$xtpl->assign( 'main_files', $qsf->lang->main_files );\n\t\t$xtpl->assign( 'main_forum', $qsf->lang->main_forum );\n\t\t$xtpl->assign( 'main_members', $qsf->lang->main_members );\n\t\t$xtpl->assign( 'searchlink', $searchlink );\n\t\t$xtpl->assign( 'main_search', $qsf->lang->main_search );\n\n\t\t$xtpl->assign( 'login', $qsf->lang->login );\n\n\t\t$request_uri = $qsf->get_uri();\n\t\tif( substr( $request_uri, -8 ) == 'register') {\n\t\t\t$request_uri = $qsf->self;\n\t\t}\n\t\t$xtpl->assign( 'request_uri', $request_uri );\n\n\t\t$xtpl->assign( 'login_user', $qsf->lang->login_user );\n\t\t$xtpl->assign( 'login_pass', $qsf->lang->login_pass );\n\t\t$xtpl->assign( 'submit', $qsf->lang->submit );\n\t\t$xtpl->assign( 'register_reg', $qsf->lang->register_reg );\n\t\t$xtpl->assign( 'login_forgot_pass', $qsf->lang->login_forgot_pass );\n\n\t\t$xtpl->parse( 'Index.GuestHeader' );\n\t} else {\n\t\t$xtpl->assign( 'qsf_site', $qsf->site );\n\t\t$xtpl->assign( 'forum_name', $qsf->sets['forum_name'] );\n\t\t$xtpl->assign( 'main_welcome', $qsf->lang->main_welcome );\n\t\t$xtpl->assign( 'user_id', $qsf->user['user_id'] );\n\t\t$xtpl->assign( 'user_name', $qsf->user['user_name'] );\n\t\t$xtpl->assign( 'link_name', $qsf->htmlwidgets->clean_url( $qsf->user['user_name'] ) );\n\t\t$xtpl->assign( 'new_files', $new_files );\n\t\t$xtpl->assign( 'main_files', $qsf->lang->main_files );\n\t\t$xtpl->assign( 'main_forum', $qsf->lang->main_forum );\n\n\t\tif( $qsf->perms->auth( 'page_create' ) || $qsf->perms->auth( 'page_edit' ) || $qsf->perms->auth( 'page_delete' ) ) {\n\t\t\t$xtpl->assign( 'main_pages', $qsf->lang->main_pages );\n\n\t\t\t$xtpl->parse( 'Index.MemberHeader.PagesLink' );\n\t\t}\n\n\t\t$xtpl->assign( 'main_members', $qsf->lang->main_members );\n\t\t$xtpl->assign( 'searchlink', $searchlink );\n\t\t$xtpl->assign( 'main_search', $qsf->lang->main_search );\n\n\t\tif( $can_spam ) {\n\t\t\t$xtpl->assign( 'spam_style', $spam_style );\n\t\t\t$xtpl->assign( 'main_spam_controls', $qsf->lang->main_spam_controls );\n\n\t\t\t$xtpl->parse( 'Index.MemberHeader.SpamLink' );\n\t\t}\n\n\t\t$xtpl->assign( 'new_pm', $new_pm );\n\t\t$xtpl->assign( 'main_messenger', $qsf->lang->main_messenger );\n\t\t$xtpl->assign( 'main_cp', $qsf->lang->main_cp );\n\n\t\tif( $qsf->perms->auth( 'is_admin' ) ) {\n\t\t\t$xtpl->assign( 'main_admincp', $qsf->lang->main_admincp );\n\n\t\t\t$xtpl->parse( 'Index.MemberHeader.AdminCPLink' );\n\t\t}\n\n\t\t$xtpl->assign( 'main_logout', $qsf->lang->main_logout );\n\n\t\t$xtpl->parse( 'Index.MemberHeader' );\n\t}\n\n\t// FIXME: All this 0 == 0 stuff should be settable as front page features.\n\t// Recent Posts\n\t$recent_posts = null;\n\tif( 0 == 0 ) {\n\t\trequire_once $set['include_path'] . '/modlets/recent_posts.php';\n\n\t\t$modlet = new recent_posts( $qsf );\n\n\t\t$recent_posts = $modlet->execute( false );\n\n\t\t$xtpl->assign( 'recent_posts', $recent_posts );\n\t}\n\n\t// Recent Uploads\n\t$recent_uploads = null;\n\tif( 0 == 0 ) {\n\t\trequire_once $set['include_path'] . '/modlets/recent_uploads.php';\n\n\t\t$modlet = new recent_uploads( $qsf );\n\n\t\t$recent_uploads = $modlet->execute( false );\n\n\t\t$xtpl->assign( 'recent_uploads', $recent_uploads );\n\t}\n\n\t// Top Posters\n\t$top_posters = null;\n\tif( 0 == 0 ) {\n\t\trequire_once $set['include_path'] . '/modlets/top_posters.php';\n\n\t\t$modlet = new top_posters( $qsf );\n\n\t\t$top_posters = $modlet->execute( false );\n\n\t\t$xtpl->assign( 'top_posters', $top_posters );\n\t}\n\n\t// Top Uploaders\n\t$top_uploaders = null;\n\tif( 0 == 0 ) {\n\t\trequire_once $set['include_path'] . '/modlets/top_uploaders.php';\n\n\t\t$modlet = new top_uploaders( $qsf );\n\n\t\t$top_uploaders = $modlet->execute( false );\n\n\t\t$xtpl->assign( 'top_uploaders', $top_uploaders );\n\t}\n\n\t// Users Online\n\t$users_online = null;\n\tif( 0 == 0 ) {\n\t\trequire_once $set['include_path'] . '/modlets/users_online.php';\n\n\t\t$modlet = new users_online( $qsf );\n\n\t\t$users_online = $modlet->execute( false );\n\n\t\t$xtpl->assign( 'users_online_block', $users_online );\n\t}\n\n\t// Board Stats\n\t$board_stats = null;\n\tif( 0 == 0 ) {\n\t\trequire_once $set['include_path'] . '/modlets/board_stats.php';\n\n\t\t$modlet = new board_stats( $qsf );\n\n\t\t$board_stats = $modlet->execute( true ); // FIXME: Birthdays should be optional display.\n\n\t\t$xtpl->assign( 'board_stats', $board_stats );\n\t}\n\n\t// Main section on right side of front page.\n\t$reminder = null;\n\t$reminder_text = null;\n\n\tif( $qsf->sets['closed'] ) {\n\t\tif( !$qsf->perms->auth( 'board_view_closed' ) ) {\n\t\t\tif( $qsf->get['a'] != 'login' ) {\n\t\t\t\terror( QUICKSILVER_NOTICE, $qsf->sets['closedtext'] . \"<br /><hr />If you are an administrator, <a href='{$qsf->site}/index.php?a=login&amp;s=on'>click here</a> to login.\" );\n\t\t\t}\n\t\t} else {\n\t\t\t$reminder_text = $qsf->lang->main_reminder_closed . '<br />&quot;' . $qsf->sets['closedtext'] . '&quot;';\n\t\t}\n\t}\n\n\tif( $qsf->user['user_group'] == USER_AWAIT ) {\n\t\t$reminder_text = \"{$qsf->lang->main_activate}<br /><a href='{$qsf->site}/register/&amp;s=resend'>{$qsf->lang->main_activate_resend}</a>\";\n\t}\n\tif( $reminder_text ) {\n\t\t$xtpl->assign( 'main_reminder', $qsf->lang->main_reminder );\n\t\t$xtpl->assign( 'reminder_text', $reminder_text );\n\n\t\t$xtpl->parse( 'Index.Reminder' );\n\t}\n\n\t// Generated by the specific module being accessed.\n\t$xtpl->assign( 'module_output', $output );\n\n\t// Footer section.\n\t$xtpl->assign( 'powered_by', $qsf->lang->powered );\n\t$xtpl->assign( 'qsf_name', $qsf->name );\n\t$xtpl->assign( 'based_on', $qsf->lang->based_on );\n\t$xtpl->assign( 'servertime', $qsf->mbdate( DATE_LONG, $qsf->time, false ) );\n\n\t$google = null;\n\tif( isset( $qsf->sets['analytics_code'] ) && !empty( $qsf->sets['analytics_code'] ) ) {\n\t\t$google = $qsf->sets['analytics_code'];\n\t}\n\t$xtpl->assign( 'google', $google );\n\n\t$xtpl->parse( 'Index' );\n\n\tob_start( 'ob_gzhandler' );\n\n\t$xtpl->out( 'Index' );\n\n\t@ob_end_flush();\n\t@flush();\n}\n\n// Do post output stuff\n$qsf->cleanup();\n\n// Close the DB connection.\n$qsf->db->close();\n?>"], "filenames": ["docs/ChangeLog.txt", "index.php"], "buggy_code_start_loc": [40, 32], "buggy_code_end_loc": [40, 140], "fixing_code_start_loc": [41, 33], "fixing_code_end_loc": [42, 176], "type": "CWE-22", "message": "A vulnerability classified as critical was found in Arthmoor QSF-Portal. This vulnerability affects unknown code of the file index.php. The manipulation of the argument a leads to path traversal. The name of the patch is ea4f61e23ecb83247d174bc2e2cbab521c751a7d. It is recommended to apply a patch to fix this issue. VDB-217558 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2019-25099", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-06T13:15:09.927", "lastModified": "2023-01-12T15:32:54.390", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability classified as critical was found in Arthmoor QSF-Portal. This vulnerability affects unknown code of the file index.php. The manipulation of the argument a leads to path traversal. The name of the patch is ea4f61e23ecb83247d174bc2e2cbab521c751a7d. It is recommended to apply a patch to fix this issue. VDB-217558 is the identifier assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.2}, "baseSeverity": "MEDIUM", "exploitabilityScore": 5.1, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:afkmods:qsf-portal:*:*:*:*:*:*:*:*", "versionEndExcluding": "2019-04-29", "matchCriteriaId": "9FEFC10A-29F9-44E9-90B0-F4FD4BC70549"}]}]}], "references": [{"url": "https://github.com/Arthmoor/QSF-Portal/commit/ea4f61e23ecb83247d174bc2e2cbab521c751a7d", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.217558", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.217558", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/Arthmoor/QSF-Portal/commit/ea4f61e23ecb83247d174bc2e2cbab521c751a7d"}}