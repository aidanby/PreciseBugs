{"buggy_code": ["<div class=\"tooltip-large\">\n    <table class=\"table-small\">\n        <tr>\n            <th class=\"column-20\"><?= t('Type') ?></th>\n            <th class=\"column-70\"><?= t('Title') ?></th>\n            <th class=\"column-10\"><?= t('Dependency') ?></th>\n        </tr>\n        <?php foreach ($links as $link): ?>\n            <tr>\n                <td>\n                    <?= $link['type'] ?>\n                </td>\n                <td>\n                    <a href=\"<?= $link['url'] ?>\" title=\"<?= $this->text->e($link['url']) ?>\" target=\"_blank\"><?= $this->text->e($link['title']) ?></a>\n                </td>\n                <td>\n                    <?= $this->text->e($link['dependency_label']) ?>\n                </td>\n            </tr>\n        <?php endforeach ?>\n    </table>\n</div>\n", "<?php if (! empty($links)): ?>\n<table class=\"table-striped table-scrolling\">\n    <thead>\n        <tr>\n            <th class=\"column-15\"><?= t('Type') ?></th>\n            <th><?= t('Title') ?></th>\n            <th class=\"column-15\"><?= t('Dependency') ?></th>\n            <th class=\"column-15\"><?= t('Creator') ?></th>\n            <th class=\"column-10\"><?= t('Date') ?></th>\n        </tr>\n    </thead>\n    <tbody>\n    <?php foreach ($links as $link): ?>\n        <tr>\n            <td>\n                <?php if ($this->user->hasProjectAccess('TaskExternalLinkController', 'edit', $task['project_id'])): ?>\n                <div class=\"dropdown\">\n                    <a href=\"#\" class=\"dropdown-menu dropdown-menu-link-icon\"><i class=\"fa fa-cog\"></i><i class=\"fa fa-caret-down\"></i></a>\n                    <ul>\n                        <li>\n                            <?= $this->modal->medium('edit', t('Edit'), 'TaskExternalLinkController', 'edit', array('link_id' => $link['id'], 'task_id' => $task['id'])) ?>\n                        </li>\n                        <li>\n                            <?= $this->modal->confirm('trash-o', t('Remove'), 'TaskExternalLinkController', 'confirm', array('link_id' => $link['id'], 'task_id' => $task['id'])) ?>\n                        </li>\n                    </ul>\n                </div>\n                <?php endif ?>\n                <?= $this->text->e($link['type']) ?>\n            </td>\n            <td>\n                <a href=\"<?= $link['url'] ?>\" title=\"<?= $this->text->e($link['url']) ?>\" target=\"_blank\"><?= $this->text->e($link['title']) ?><span class=\"ui-helper-hidden-accessible\"> (<?= $this->text->e($link['url']) ?>)</span></a>\n            </td>\n            <td>\n                <?= $this->text->e($link['dependency_label']) ?>\n            </td>\n            <td>\n                <?= $this->text->e($link['creator_name'] ?: $link['creator_username']) ?>\n            </td>\n            <td>\n                <?= $this->dt->date($link['date_creation']) ?>\n            </td>\n        </tr>\n    <?php endforeach ?>\n    </tbody>\n</table>\n<?php endif ?>\n"], "fixing_code": ["<div class=\"tooltip-large\">\n    <table class=\"table-small\">\n        <tr>\n            <th class=\"column-20\"><?= t('Type') ?></th>\n            <th class=\"column-70\"><?= t('Title') ?></th>\n            <th class=\"column-10\"><?= t('Dependency') ?></th>\n        </tr>\n        <?php foreach ($links as $link): ?>\n            <tr>\n                <td>\n                    <?= $link['type'] ?>\n                </td>\n                <td>\n                    <a href=\"<?= $this->text->e($link['url']) ?>\" title=\"<?= $this->text->e($link['url']) ?>\" target=\"_blank\"><?= $this->text->e($link['title']) ?></a>\n                </td>\n                <td>\n                    <?= $this->text->e($link['dependency_label']) ?>\n                </td>\n            </tr>\n        <?php endforeach ?>\n    </table>\n</div>\n", "<?php if (! empty($links)): ?>\n<table class=\"table-striped table-scrolling\">\n    <thead>\n        <tr>\n            <th class=\"column-15\"><?= t('Type') ?></th>\n            <th><?= t('Title') ?></th>\n            <th class=\"column-15\"><?= t('Dependency') ?></th>\n            <th class=\"column-15\"><?= t('Creator') ?></th>\n            <th class=\"column-10\"><?= t('Date') ?></th>\n        </tr>\n    </thead>\n    <tbody>\n    <?php foreach ($links as $link): ?>\n        <tr>\n            <td>\n                <?php if ($this->user->hasProjectAccess('TaskExternalLinkController', 'edit', $task['project_id'])): ?>\n                <div class=\"dropdown\">\n                    <a href=\"#\" class=\"dropdown-menu dropdown-menu-link-icon\"><i class=\"fa fa-cog\"></i><i class=\"fa fa-caret-down\"></i></a>\n                    <ul>\n                        <li>\n                            <?= $this->modal->medium('edit', t('Edit'), 'TaskExternalLinkController', 'edit', array('link_id' => $link['id'], 'task_id' => $task['id'])) ?>\n                        </li>\n                        <li>\n                            <?= $this->modal->confirm('trash-o', t('Remove'), 'TaskExternalLinkController', 'confirm', array('link_id' => $link['id'], 'task_id' => $task['id'])) ?>\n                        </li>\n                    </ul>\n                </div>\n                <?php endif ?>\n                <?= $this->text->e($link['type']) ?>\n            </td>\n            <td>\n                <a href=\"<?= $this->text->e($link['url']) ?>\" title=\"<?= $this->text->e($link['url']) ?>\" target=\"_blank\"><?= $this->text->e($link['title']) ?><span class=\"ui-helper-hidden-accessible\"> (<?= $this->text->e($link['url']) ?>)</span></a>\n            </td>\n            <td>\n                <?= $this->text->e($link['dependency_label']) ?>\n            </td>\n            <td>\n                <?= $this->text->e($link['creator_name'] ?: $link['creator_username']) ?>\n            </td>\n            <td>\n                <?= $this->dt->date($link['date_creation']) ?>\n            </td>\n        </tr>\n    <?php endforeach ?>\n    </tbody>\n</table>\n<?php endif ?>\n"], "filenames": ["app/Template/board/tooltip_external_links.php", "app/Template/task_external_link/table.php"], "buggy_code_start_loc": [14, 32], "buggy_code_end_loc": [15, 33], "fixing_code_start_loc": [14, 32], "fixing_code_end_loc": [15, 33], "type": "CWE-79", "message": "Kanboard is open source project management software that focuses on the Kanban methodology. A stored Cross site scripting (XSS) allows an attacker to execute arbitrary Javascript and any user who views the task containing the malicious code will be exposed to the XSS attack. Note: The default CSP header configuration blocks this javascript attack. This issue has been addressed in version 1.2.30. Users are advised to upgrade. Users unable to upgrade should ensure that they have a restrictive CSP header config.\n\n", "other": {"cve": {"id": "CVE-2023-33969", "sourceIdentifier": "security-advisories@github.com", "published": "2023-06-05T20:15:09.867", "lastModified": "2023-06-12T17:57:57.837", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Kanboard is open source project management software that focuses on the Kanban methodology. A stored Cross site scripting (XSS) allows an attacker to execute arbitrary Javascript and any user who views the task containing the malicious code will be exposed to the XSS attack. Note: The default CSP header configuration blocks this javascript attack. This issue has been addressed in version 1.2.30. Users are advised to upgrade. Users unable to upgrade should ensure that they have a restrictive CSP header config.\n\n"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.1, "impactScore": 2.7}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kanboard:kanboard:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.2.30", "matchCriteriaId": "082DAE98-80F0-4423-8581-AB8D0051EAA1"}]}]}], "references": [{"url": "https://github.com/kanboard/kanboard/commit/05f1d23d821152cd61536d3b09e522c0f7573e3c", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/kanboard/kanboard/security/advisories/GHSA-8qvf-9847-gpc9", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/kanboard/kanboard/commit/05f1d23d821152cd61536d3b09e522c0f7573e3c"}}