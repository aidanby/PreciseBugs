{"buggy_code": ["<?php\r\n\r\n/**\r\n * @package Wordpress Exit Strategy\r\n * @author Bouzid Nazim Zitouni\r\n * @version 1.55\r\n */\r\n/*\r\nPlugin Name: Wordpress Exit Strategy\r\nPlugin URI: http://angrybyte.com/wordpress-plugins/wordpress-exit-strategy/\r\nDescription: Exit Strategy will pass all outgoing links from your site through a nofollow link to an exit page before finally being redirected to the external link. You may place anything in your exit page: Ads, Subscribtion buttons, etc. Using Wordpress Exit Strategy you improve your SEO score by not linking directly to external pages, you get more subscribers & more revenues if you use Ads.\r\nAuthor: Bouzid Nazim Zitouni\r\nVersion: 1.55\r\nAuthor URI: http://angrybyte.com\r\n*/\r\n\r\n\r\nadd_option(\"exitpagecontents\",\r\n    'Thank you for your visit, You`ll be redirected in %n% seconds <br> <a href=\"%link%\">Click here if you are not redirected automatically</a>',\r\n    'Contents of the Exit page', 'yes');\r\nadd_option(\"exitpagedelay\", '10', 'yes');\r\nadd_option(\"autoredirect\", '1', 'yes');\r\nadd_option(\"countmessage\", '', 'yes');\r\nadd_option(\"redirecttoparent\", '1', 'yes');\r\n//\r\nadd_filter('the_content', 'replacelinks');\r\nadd_action('wp_head', 'autoredirect');\r\nadd_action('admin_menu', 'exitpageadmin');\r\nfunction exitpageadmin()\r\n{\r\n\r\n    add_options_page('Exit page admin', 'Exit Strategy', 8, __file__,\r\n        'exit_page_admin');\r\n}\r\nfunction exit_page_admin()\r\n{\r\n\r\n    if ($_POST['xx'])\r\n    {\r\n        update_option('exitpagecontents', $_POST['xx']);\r\n        update_option('redirecttoparent', $_POST['redirectpar']);\r\n\r\n    }\r\n    $oldtemp = stripcslashes(get_option(\"exitpagecontents\"));\r\n    $chkd = 1;\r\n    $chkd2 = get_option(\"redirecttoparent\");\r\n    if ($chkd)\r\n    {\r\n        $chkd = \"checked='checked'\";\r\n\r\n    } else\r\n    {\r\n        $chkd = \"\";\r\n    }\r\n    if ($chkd2)\r\n    {\r\n        $chkd2 = \"checked='checked'\";\r\n\r\n    } else\r\n    {\r\n        $chkd2 = \"\";\r\n    }\r\n    echo <<< EOFT\r\n    <h1> Wordpress Exit Strategy</h1>\r\n    <table><tr><td width=\"70%\">\r\n    <div class=\"metabox-holder\" />\r\n    <div  class=\"postbox gdrgrid frontleft\">\r\n<h3 class=\"hndle\">\r\n<span>Exit Page Options</span>\r\n</h3>\r\n<div class=\"inside\">\r\n<div class=\"table\">\r\n<table>\r\n<tbody>\r\n<tr class=\"first\">\r\n<td class=\"first b\">Exit Page Contents</td>\r\n<td class=\"t options\"><Form method ='post' action='$serv' ><input type='hidden' value='fit' name='fit' id='fit' />\r\nEOFT;\r\n    if (function_exists(wp_editor))\r\n    {\r\n        wp_editor($oldtemp, \"xx\");\r\n    } else\r\n    {\r\n        echo \"<textarea name='xx' cols='150' rows='20'>$oldtemp</textarea>\";\r\n    }\r\n\r\n    echo <<< EOFT\r\n\r\n  <br/>\r\n  <ul>\r\n  <li>%n% will be replaced by the redirect delay<br /></li>\r\n <li>%link% will be replaced by the redirection URL<br /></li>\r\n<li><p style=\"color: gray;\">%count% will be replaced by a redirection count down (Pro! Feature)</p></li>\r\n<li><p style=\"color: gray;\">%site+1% will be replaced by a Google +1 button for your site. (Pro! Feature)</p></li>\r\n<li><p style=\"color: gray;\">%post+1% will be replaced by a Google +1 button for your post. (Pro! Feature)</p></li>\r\n<li><p style=\"color: gray;\">%sitelike% will be replaced by a Facebook Like button for your site. (Pro! Feature)</p></li>\r\n<li><p style=\"color: gray;\">%postlike% will be replaced by a Facebook Like button for your post. (Pro! Feature)</p></li>\r\n<li><p style=\"color: gray;\"><b>%sitetweet%</b> will be replaced by a Twitter button for your site. (Pro! Feature)</p></li>\r\n<li><p style=\"color: gray;\"><b>%posttweet%</b> will be replaced by a Twitter button for your post. (Pro! Feature)</p></li>\r\n<li>HTML and javascript are allowed<br /></li>\r\n \r\n</tr>\r\n<tr>\r\n<td class=\"first b\">Redirect delay in seconds</td><td class=\"t options\"><input disabled=\"disabled\" type=\"text\" name='delay' value='10 (Editable in Pro!)' /></td></tr><tr>\r\n<td>  Auto redirection.</td><td class=\"t options\"><input disabled=\"disabled\" type='checkbox' value='1' $chkd name='autoredirect' /> Enable auto redirection after the end of the delay (Can be disabled in Pro!)</td></tr><tr><td>\r\n redirect external</td><td class=\"t options\"><input type='checkbox' value='1' $chkd2 name='redirectpar' /> Redirect external links to exit pages to their parent post</td></tr>\r\n <tr><td>\r\n Process entire pages</td><td class=\"t options\"><input type='checkbox' disabled=\"disabled\" value='0'   />  redirect links in the entire page including widgets and footer, or just the post contents (Pro! Feature)</td></tr>\r\n \r\n <tr><td>\r\nEnd of count Message.</td><td class=\"t options\"><input type=\"text\" size='150' name='eoc' disabled=\"disabled\" value='(Pro! Feature)' /><br /> Display this message when the %count% counter runs out (HTML allowed , can include %link%)</td></tr>\r\n<tr><td>Excluded pages.</td><td class=\"t options\"><input type=\"text\" size='150' name='excl' disabled=\"disabled\" value='(Pro! Feature)' /><br /> enter to post IDs to be excluded from your exit page, useful for your sales or affiliate pages. Separate by commas ex: 3,55,153\r\n</td></tr>\r\n<tr><td>\r\nExcluded Links.</td><td class=\"t options\"><textarea disabled=\"disabled\" cols='100' rows='20'>(Pro! Feature)</textarea><br /> Enter the links you wish to exclude from your exit strategy. each link is a separate line. Excluding a website will exclude all pages within it, and excluding a page will not exclude the rest of the website.</td></tr>\r\n<tr><td><input type='submit' value='save' /></form></td></tr>\r\n</tbody>\r\n</table>\r\n</div></div>\r\n</div></td><td VALIGN=\"TOP\">\r\n<div class=\"metabox-holder\" />\r\n    <div  class=\"postbox gdrgrid frontleft\">\r\n<h3 class=\"hndle\">\r\n<span>Wordpress Exit Strategy Pro!</span>\r\n</h3>\r\n<div class=\"inside\">\r\n<div class=\"table\">\r\n<table >\r\n<tbody>\r\n<tr class=\"first\" VALIGN=\"TOP\">\r\n<td class=\"first b\">Get <a href=\"http://angrybyte.com/wordpress-plugins/wordpress-exit-strategy/\">Wordpress Exit Strategy Pro!</a> and unlock the full potential of your exit pages.\r\n<ul>\r\n<li ><b style=\"color: red; \">Optional auto-redirection:</b> Auto redirect, or just make the link appear after the count down.</li>\r\n<li><b style=\"color: red;\">Count down timer:</b> Show a java count down timer. Redirect or show the link when the timer runs out.</li>\r\n<li><b style=\"color: red;\">Customizable redirection delay:</b> Plan your exit strategy! easily change how long your visitors will wait before they leave your site.</li>\r\n<li><b style=\"color: red;\">Make your exceptions:</b> Select the posts to exclude from your Exit Strategy. Make it easier for your visitors to exit from selected posts, like product sale pages</li>\r\n</ul>\r\n<h2><a href=\"http://codecanyon.net/item/wordpress-exit-strategy-pro/1573775?ref=AngryByte\">Get Exit Strategy Pro! Now</a></h2>\r\n<a href=\"http://codecanyon.net/item/wordpress-exit-strategy-pro/1573775?ref=AngryByte\"><img src=\"http://0.s3.envato.com/files/19325524/screenshot2.png\" style=\"width:100%\" alt=\"An exit page\"/></a>\r\n</td></tr></tbody></table></div></div></div>\r\n\r\n<div class=\"metabox-holder\" />\r\n    <div  class=\"postbox gdrgrid frontleft\">\r\n<h3 class=\"hndle\">\r\n<span>Feeling Lucky? Get Pro! for Free!</span>\r\n</h3>\r\n<div class=\"inside\">\r\n<div class=\"table\">\r\n<table>\r\n<tbody>\r\n<tr class=\"first\">\r\n<td class=\"first b\"><div id=\"fb-root\"></div>\r\n<p><script type=\"text/javascript\">// <![CDATA[\r\n    (function(d, s, id) {   var js, fjs = d.getElementsByTagName(s)[0];   if (d.getElementById(id)) return;   js = d.createElement(s); js.id = id;   js.src = \"//connect.facebook.net/en_US/all.js#xfbml=1&#038;appId=173688705979189\";   fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk'));\r\n// ]]></script>Now And for a limited time, You can get Wordpress Exit Strategy Pro for free! all you need to do is:<br />\r\n                           <ol >\r\n                           <li> <table style=\"display:inline\";><tr><td>Give us a   <!-- Place this tag where you want the +1 button to render --><div class=\"g-plusone\" data-size=\"medium\" data-href=\"http://angrybyte.com\"></div><!-- Place this render call where appropriate --><br /><script type=\"text/javascript\">// <![CDATA[\r\n      (function() {     var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;     po.src = 'https://apis.google.com/js/plusone.js';     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);   })();// ]]></script></td><td> And a </td><td><div class=\"fb-like\" data-href=\"http://angrybyte.com\" data-send=\"false\" data-layout=\"button_count\" data-width=\"10\" data-show-faces=\"false\"></div></li></td></tr></table>\r\n\t                       <li><a href='http://www.facebook.com/pages/AngryBytecom/262969757073611?sk=wall'>Join our facebook page</a>, and comment on the Exit Strategy update!</li>\r\n\t                       <li><a href=\"http://wordpress.org/extend/plugins/exit-strategy/\"> Rate Wordpress Exit Strategy on wordpress.org </a>, 5 starts would be great!</li>\r\n                        \t\r\n                            </ol>\r\n                          <br />\r\n                           <br /> \r\n                           For each 100 ratings on wordpress.org, we`ll randomly pick 3 lucky winners from Facebook!</td></tr></tbody></table>\r\n\r\n\r\n\r\n</td></tr></table>\r\nEOFT;\r\n}\r\nfunction autoredirect()\r\n{\r\n    global $post;\r\n    if ($_GET['xurl'])\r\n    {\r\n        $referer = $_SERVER['HTTP_REFERER'];\r\n        $myurl = get_option('siteurl');\r\n        $redirecting = get_option('autoredirect');\r\n        //Just a security measure\r\n        $m1 = strpos(strtolower(\" \" . $referer), strtolower($myurl));\r\n        if ($referer == '')\r\n        {\r\n            $m1 = 1;\r\n        }\r\n        $url = $_GET['xurl'];\r\n        $url = urldecode($url);\r\n        $m2 = strpos(\" \" . $url, \"<\");\r\n        $m3 = strpos(\" \" . $url, \"$\");\r\n        $m4 = strpos(\" \" . $url, \"'\");\r\n        $m5 = strpos(\" \" . $url, '\"');\r\n        if (!(($m2 || $m3 || $m4 || $m5)) && $m1 == 1 && $redirecting)\r\n        {\r\n\r\n            echo \"<META HTTP-EQUIV='refresh' \r\nCONTENT='10;URL=$url'>\";\r\n        } elseif ($m1 != 1)\r\n        {\r\n            $chkd2 = get_option(\"redirecttoparent\");\r\n            //redirect external links to exit pages to their parent posts\r\n            if ($chkd2)\r\n            {\r\n                $pageurl = get_permalink($post->ID);\r\n                echo \"<META HTTP-EQUIV='refresh' \r\nCONTENT='0;URL=$pageurl'>\";\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n\r\n}\r\n\r\nfunction replacelinks($content)\r\n{\r\n    if ($_GET['xurl'])\r\n    {\r\n        $referer = $_SERVER['HTTP_REFERER'];\r\n        $myurl = get_option('siteurl');\r\n        //Just a security measure\r\n        $m1 = strpos(strtolower(\" \" . $referer), strtolower($myurl));\r\n        if ($referer == '')\r\n        {\r\n            $m1 = 1;\r\n        }\r\n        $url = $_GET['xurl'];\r\n        $url = urldecode($url);\r\n        //block possible code injection attenpts\r\n        $m2 = strpos(\" \" . $url, \"<\");\r\n        $m3 = strpos(\" \" . $url, \"$\");\r\n        $m4 = strpos(\" \" . $url, \"'\");\r\n        $m5 = strpos(\" \" . $url, '\"');\r\n        global $post;\r\n        $pageurl = get_permalink($post->ID);\r\n        if ($m2 || $m3 || $m4 || $m5)\r\n        {\r\n            return $content;\r\n            //someone is trying to inject a code, return contents without modifications\r\n        }\r\n        if ($m1 == 1)\r\n        {\r\n            $d = get_option(\"exitpagecontents\");\r\n            $c = 10;\r\n\r\n            $mypath = get_option('siteurl') . '/wp-content/plugins/' . plugin_basename(dirname\r\n                (__file__));\r\n\r\n\r\n            $d = str_ireplace(\"%n%\", $c, $d);\r\n            $d = str_ireplace(\"%link%\", $url, $d);\r\n\r\n            $content = stripcslashes($d);\r\n            $content .= \"<br / ><br / ><p style ='color: red;text-align: center;'><b>Exit page powered by <a href='http://codecanyon.net/item/wordpress-exit-strategy-pro/1573775?ref=AngryByte'> Wordpress Exit Strategy. </a></b></p>\";\r\n            return $content;\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    preg_match_all('/<a\\s[^>]*href\\s*=\\s*([\\\"\\']??)([^\\\" >]*?)\\\\1[^>]*>(.*)<\\/a>/siU',\r\n        $content, $matches);\r\n    $matches = $matches[0];\r\n    global $post;\r\n    $pageurl = get_permalink($post->ID);\r\n    $myurl = get_option('siteurl');\r\n    $serv = $_SERVER['PHP_SELF'];\r\n    foreach ($matches as $match)\r\n    {\r\n        $qref = strpos($match, $myurl);\r\n        $qref2 = strpos($match, \"http\");\r\n\r\n        if (($qref == '') && ($qref2 != ''))\r\n        {\r\n        \r\n            preg_match_all('#\\bhttps?://[^\\s()<>]+(?:\\([\\w\\d]+\\)|([^[:punct:]\\s]|/))#', $match,\r\n                $xurl);\r\n            $xurl = $xurl[0][0];\r\n            if (strpos($pageurl, \"?\"))\r\n            {\r\n                $xurl2 = $pageurl . \"&xurl=\" . urlencode($xurl);\r\n\r\n            } else\r\n            {\r\n                $xurl2 = $pageurl . \"?xurl=\" . urlencode($xurl);\r\n\r\n            }\r\n            $newlink = str_replace($xurl, $xurl2, $match);\r\n            if (!strpos($newlink, \"nofollow\"))\r\n            {\r\n                $newlink = str_replace(\"<a \", '<a rel=\"nofollow\" ', $newlink);\r\n            }\r\n            $content = str_ireplace($match, $newlink, $content);\r\n        }\r\n    }\r\n\r\n    return $content;\r\n}\r\n\r\n?>"], "fixing_code": ["<?php\r\n\r\n/**\r\n * @package Wordpress Exit Strategy\r\n * @author Bouzid Nazim Zitouni\r\n * @version 1.59\r\n */\r\n/*\r\nPlugin Name: Wordpress Exit Strategy\r\nPlugin URI: http://angrybyte.com/wordpress-plugins/wordpress-exit-strategy/\r\nDescription: Exit Strategy will pass all outgoing links from your site through a nofollow link to an exit page before finally being redirected to the external link. You may place anything in your exit page: Ads, Subscribtion buttons, etc. Using Wordpress Exit Strategy you improve your SEO score by not linking directly to external pages, you get more subscribers & more revenues if you use Ads.\r\nAuthor: Bouzid Nazim Zitouni\r\nVersion: 1.59\r\nAuthor URI: http://angrybyte.com\r\n*/\r\n\r\nif(!function_exists('add_action')){\r\n    echo \"\"; // someone is trying to run the plugin directly, added to avoid full path disclosure.\r\n    die;\r\n}\r\nadd_option(\"exitpagecontents\",\r\n    'Thank you for your visit, You`ll be redirected in %n% seconds <br> <a href=\"%link%\">Click here if you are not redirected automatically</a>',\r\n    'Contents of the Exit page', 'yes');\r\nadd_option(\"exitpagedelay\", '10', 'yes');\r\nadd_option(\"autoredirect\", '1', 'yes');\r\nadd_option(\"countmessage\", '', 'yes');\r\nadd_option(\"redirecttoparent\", '1', 'yes');\r\n//\r\nadd_filter('the_content', 'replacelinks');\r\nadd_action('wp_head', 'autoredirect');\r\nadd_action('admin_menu', 'exitpageadmin');\r\nfunction exitpageadmin()\r\n{\r\n\r\n    add_options_page('Exit page admin', 'Exit Strategy', 8, __file__,\r\n        'exit_page_admin');\r\n}\r\nfunction exit_page_admin()\r\n{\r\n\r\n    if (($_POST[\"xx\"])&& (is_admin())&& check_admin_referer( 'exit_strategy_save', 'exit_strategy_nonce' ))\r\n    {\r\n        update_option('exitpagecontents', $_POST['xx']);\r\n        update_option('redirecttoparent', $_POST['redirectpar']);\r\n\r\n    }\r\n    $oldtemp = stripcslashes(get_option(\"exitpagecontents\"));\r\n    $chkd = 1;\r\n    $chkd2 = get_option(\"redirecttoparent\");\r\n    if ($chkd)\r\n    {\r\n        $chkd = \"checked='checked'\";\r\n\r\n    } else\r\n    {\r\n        $chkd = \"\";\r\n    }\r\n    if ($chkd2)\r\n    {\r\n        $chkd2 = \"checked='checked'\";\r\n\r\n    } else\r\n    {\r\n        $chkd2 = \"\";\r\n    }\r\n    echo <<< EOFT\r\n    <h1> Wordpress Exit Strategy</h1>\r\n    <table><tr><td width=\"70%\">\r\n    <div class=\"metabox-holder\" />\r\n    <div  class=\"postbox gdrgrid frontleft\">\r\n<h3 class=\"hndle\">\r\n<span>Exit Page Options</span>\r\n</h3>\r\n<div class=\"inside\">\r\n<div class=\"table\">\r\n<table>\r\n<tbody>\r\n<tr class=\"first\">\r\n<td class=\"first b\">Exit Page Contents</td>\r\n<td class=\"t options\"><Form method ='post' action='$serv' ><input type='hidden' value='fit' name='fit' id='fit' />\r\nEOFT;\r\n    if (function_exists(wp_editor))\r\n    {\r\n        wp_editor($oldtemp, \"xx\");\r\n    } else\r\n    {\r\n        echo \"<textarea name='xx' cols='150' rows='20'>$oldtemp</textarea>\";\r\n    }\r\n     wp_nonce_field( 'exit_strategy_save','exit_strategy_nonce' ); \r\n    echo <<< EOFT\r\n\r\n  <br/>\r\n  <ul>\r\n  <li>%n% will be replaced by the redirect delay<br /></li>\r\n <li>%link% will be replaced by the redirection URL<br /></li>\r\n<li><p style=\"color: gray;\">%count% will be replaced by a redirection count down (Pro! Feature)</p></li>\r\n<li><p style=\"color: gray;\">%site+1% will be replaced by a Google +1 button for your site. (Pro! Feature)</p></li>\r\n<li><p style=\"color: gray;\">%post+1% will be replaced by a Google +1 button for your post. (Pro! Feature)</p></li>\r\n<li><p style=\"color: gray;\">%sitelike% will be replaced by a Facebook Like button for your site. (Pro! Feature)</p></li>\r\n<li><p style=\"color: gray;\">%postlike% will be replaced by a Facebook Like button for your post. (Pro! Feature)</p></li>\r\n<li><p style=\"color: gray;\"><b>%sitetweet%</b> will be replaced by a Twitter button for your site. (Pro! Feature)</p></li>\r\n<li><p style=\"color: gray;\"><b>%posttweet%</b> will be replaced by a Twitter button for your post. (Pro! Feature)</p></li>\r\n<li>HTML and javascript are allowed<br /></li>\r\n \r\n</tr>\r\n<tr>\r\n<td class=\"first b\">Redirect delay in seconds</td><td class=\"t options\"><input disabled=\"disabled\" type=\"text\" name='delay' value='10 (Editable in Pro!)' /></td></tr><tr>\r\n<td>  Auto redirection.</td><td class=\"t options\"><input disabled=\"disabled\" type='checkbox' value='1' $chkd name='autoredirect' /> Enable auto redirection after the end of the delay (Can be disabled in Pro!)</td></tr><tr><td>\r\n redirect external</td><td class=\"t options\"><input type='checkbox' value='1' $chkd2 name='redirectpar' /> Redirect external links to exit pages to their parent post</td></tr>\r\n <tr><td>\r\n Process entire pages</td><td class=\"t options\"><input type='checkbox' disabled=\"disabled\" value='0'   />  redirect links in the entire page including widgets and footer, or just the post contents (Pro! Feature)</td></tr>\r\n \r\n <tr><td>\r\nEnd of count Message.</td><td class=\"t options\"><input type=\"text\" size='150' name='eoc' disabled=\"disabled\" value='(Pro! Feature)' /><br /> Display this message when the %count% counter runs out (HTML allowed , can include %link%)</td></tr>\r\n<tr><td>Excluded pages.</td><td class=\"t options\"><input type=\"text\" size='150' name='excl' disabled=\"disabled\" value='(Pro! Feature)' /><br /> enter to post IDs to be excluded from your exit page, useful for your sales or affiliate pages. Separate by commas ex: 3,55,153\r\n</td></tr>\r\n<tr><td>\r\nExcluded Links.</td><td class=\"t options\"><textarea disabled=\"disabled\" cols='100' rows='20'>(Pro! Feature)</textarea><br /> Enter the links you wish to exclude from your exit strategy. each link is a separate line. Excluding a website will exclude all pages within it, and excluding a page will not exclude the rest of the website.</td></tr>\r\n<tr><td><input type='submit' value='save' /></form></td></tr>\r\n</tbody>\r\n</table>\r\n</div></div>\r\n</div></td><td VALIGN=\"TOP\">\r\n<div class=\"metabox-holder\" />\r\n    <div  class=\"postbox gdrgrid frontleft\">\r\n<h3 class=\"hndle\">\r\n<span>Wordpress Exit Strategy Pro!</span>\r\n</h3>\r\n<div class=\"inside\">\r\n<div class=\"table\">\r\n<table >\r\n<tbody>\r\n<tr class=\"first\" VALIGN=\"TOP\">\r\n<td class=\"first b\">Get <a href=\"http://angrybyte.com/wordpress-plugins/wordpress-exit-strategy/\">Wordpress Exit Strategy Pro!</a> and unlock the full potential of your exit pages.\r\n<ul>\r\n<li ><b style=\"color: red; \">Optional auto-redirection:</b> Auto redirect, or just make the link appear after the count down.</li>\r\n<li><b style=\"color: red;\">Count down timer:</b> Show a java count down timer. Redirect or show the link when the timer runs out.</li>\r\n<li><b style=\"color: red;\">Customizable redirection delay:</b> Plan your exit strategy! easily change how long your visitors will wait before they leave your site.</li>\r\n<li><b style=\"color: red;\">Make your exceptions:</b> Select the posts to exclude from your Exit Strategy. Make it easier for your visitors to exit from selected posts, like product sale pages</li>\r\n</ul>\r\n<h2><a href=\"http://codecanyon.net/item/wordpress-exit-strategy-pro/1573775?ref=AngryByte\">Get Exit Strategy Pro! Now</a></h2>\r\n<a href=\"http://codecanyon.net/item/wordpress-exit-strategy-pro/1573775?ref=AngryByte\"><img src=\"http://0.s3.envato.com/files/19325524/screenshot2.png\" style=\"width:100%\" alt=\"An exit page\"/></a>\r\n</td></tr></tbody></table></div></div></div>\r\n\r\n<div class=\"metabox-holder\" />\r\n    <div  class=\"postbox gdrgrid frontleft\">\r\n<h3 class=\"hndle\">\r\n<span>Feeling Lucky? Get Pro! for Free!</span>\r\n</h3>\r\n<div class=\"inside\">\r\n<div class=\"table\">\r\n<table>\r\n<tbody>\r\n<tr class=\"first\">\r\n<td class=\"first b\"><div id=\"fb-root\"></div>\r\n<p><script type=\"text/javascript\">// <![CDATA[\r\n    (function(d, s, id) {   var js, fjs = d.getElementsByTagName(s)[0];   if (d.getElementById(id)) return;   js = d.createElement(s); js.id = id;   js.src = \"//connect.facebook.net/en_US/all.js#xfbml=1&#038;appId=173688705979189\";   fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk'));\r\n// ]]></script>Now And for a limited time, You can get Wordpress Exit Strategy Pro for free! all you need to do is:<br />\r\n                           <ol >\r\n                           <li> <table style=\"display:inline\";><tr><td>Give us a   <!-- Place this tag where you want the +1 button to render --><div class=\"g-plusone\" data-size=\"medium\" data-href=\"http://angrybyte.com\"></div><!-- Place this render call where appropriate --><br /><script type=\"text/javascript\">// <![CDATA[\r\n      (function() {     var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;     po.src = 'https://apis.google.com/js/plusone.js';     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);   })();// ]]></script></td><td> And a </td><td><div class=\"fb-like\" data-href=\"http://angrybyte.com\" data-send=\"false\" data-layout=\"button_count\" data-width=\"10\" data-show-faces=\"false\"></div></li></td></tr></table>\r\n\t                       <li><a href='http://www.facebook.com/pages/AngryBytecom/262969757073611?sk=wall'>Join our facebook page</a>, and comment on the Exit Strategy update!</li>\r\n\t                       <li><a href=\"http://wordpress.org/extend/plugins/exit-strategy/\"> Rate Wordpress Exit Strategy on wordpress.org </a>, 5 starts would be great!</li>\r\n                        \t\r\n                            </ol>\r\n                          <br />\r\n                           <br /> \r\n                           For each 100 ratings on wordpress.org, we`ll randomly pick 3 lucky winners from Facebook!</td></tr></tbody></table>\r\n\r\n\r\n\r\n</td></tr></table>\r\nEOFT;\r\n}\r\nfunction autoredirect()\r\n{\r\n    global $post;\r\n    if ($_GET['xurl'])\r\n    {\r\n        $referer = $_SERVER['HTTP_REFERER'];\r\n        $myurl = get_option('siteurl');\r\n        $redirecting = get_option('autoredirect');\r\n        //Just a security measure\r\n        $m1 = strpos(strtolower(\" \" . $referer), strtolower($myurl));\r\n        if ($referer == '')\r\n        {\r\n            $m1 = 1;\r\n        }\r\n        $url = $_GET['xurl'];\r\n        $url = urldecode($url);\r\n        $m2 = strpos(\" \" . $url, \"<\");\r\n        $m3 = strpos(\" \" . $url, \"$\");\r\n        $m4 = strpos(\" \" . $url, \"'\");\r\n        $m5 = strpos(\" \" . $url, '\"');\r\n        if (!(($m2 || $m3 || $m4 || $m5)) && $m1 == 1 && $redirecting)\r\n        {\r\n\r\n            echo \"<META HTTP-EQUIV='refresh' \r\nCONTENT='10;URL=$url'>\";\r\n        } elseif ($m1 != 1)\r\n        {\r\n            $chkd2 = get_option(\"redirecttoparent\");\r\n            //redirect external links to exit pages to their parent posts\r\n            if ($chkd2)\r\n            {\r\n                $pageurl = get_permalink($post->ID);\r\n                echo \"<META HTTP-EQUIV='refresh' \r\nCONTENT='0;URL=$pageurl'>\";\r\n            }\r\n        }\r\n\r\n\r\n    }\r\n\r\n}\r\n\r\nfunction replacelinks($content)\r\n{\r\n    if ($_GET['xurl'])\r\n    {\r\n        $referer = $_SERVER['HTTP_REFERER'];\r\n        $myurl = get_option('siteurl');\r\n        //Just a security measure\r\n        $m1 = strpos(strtolower(\" \" . $referer), strtolower($myurl));\r\n        if ($referer == '')\r\n        {\r\n            $m1 = 1;\r\n        }\r\n        $url = $_GET['xurl'];\r\n        $url = urldecode($url);\r\n        //block possible code injection attenpts\r\n        $m2 = strpos(\" \" . $url, \"<\");\r\n        $m3 = strpos(\" \" . $url, \"$\");\r\n        $m4 = strpos(\" \" . $url, \"'\");\r\n        $m5 = strpos(\" \" . $url, '\"');\r\n        global $post;\r\n        $pageurl = get_permalink($post->ID);\r\n        if ($m2 || $m3 || $m4 || $m5)\r\n        {\r\n            return $content;\r\n            //someone is trying to inject a code, return contents without modifications\r\n        }\r\n        if ($m1 == 1)\r\n        {\r\n            $d = get_option(\"exitpagecontents\");\r\n            $c = 10;\r\n\r\n            $mypath = get_option('siteurl') . '/wp-content/plugins/' . plugin_basename(dirname\r\n                (__file__));\r\n\r\n\r\n            $d = str_ireplace(\"%n%\", $c, $d);\r\n            $d = str_ireplace(\"%link%\", $url, $d);\r\n\r\n            $content = stripcslashes($d);\r\n            $content .= \"<br / ><br / ><p style ='color: red;text-align: center;'><b>Exit page powered by <a href='http://codecanyon.net/item/wordpress-exit-strategy-pro/1573775?ref=AngryByte'> Wordpress Exit Strategy. </a></b></p>\";\r\n            return $content;\r\n        }\r\n\r\n\r\n    }\r\n\r\n\r\n    preg_match_all('/<a\\s[^>]*href\\s*=\\s*([\\\"\\']??)([^\\\" >]*?)\\\\1[^>]*>(.*)<\\/a>/siU',\r\n        $content, $matches);\r\n    $matches = $matches[0];\r\n    global $post;\r\n    $pageurl = get_permalink($post->ID);\r\n    $myurl = get_option('siteurl');\r\n    $serv = $_SERVER['PHP_SELF'];\r\n    foreach ($matches as $match)\r\n    {\r\n        $qref = strpos($match, $myurl);\r\n        $qref2 = strpos($match, \"http\");\r\n\r\n        if (($qref == '') && ($qref2 != ''))\r\n        {\r\n        \r\n            preg_match_all('#\\bhttps?://[^\\s()<>]+(?:\\([\\w\\d]+\\)|([^[:punct:]\\s]|/))#', $match,\r\n                $xurl);\r\n            $xurl = $xurl[0][0];\r\n            if (strpos($pageurl, \"?\"))\r\n            {\r\n                $xurl2 = $pageurl . \"&xurl=\" . urlencode($xurl);\r\n\r\n            } else\r\n            {\r\n                $xurl2 = $pageurl . \"?xurl=\" . urlencode($xurl);\r\n\r\n            }\r\n            $newlink = str_replace($xurl, $xurl2, $match);\r\n            if (!strpos($newlink, \"nofollow\"))\r\n            {\r\n                $newlink = str_replace(\"<a \", '<a rel=\"nofollow\" ', $newlink);\r\n            }\r\n            $content = str_ireplace($match, $newlink, $content);\r\n        }\r\n    }\r\n\r\n    return $content;\r\n}\r\n\r\n?>"], "filenames": ["exitpage.php"], "buggy_code_start_loc": [6], "buggy_code_end_loc": [87], "fixing_code_start_loc": [6], "fixing_code_end_loc": [90], "type": "CWE-352", "message": "A vulnerability was found in Exit Strategy Plugin 1.55 and classified as problematic. Affected by this issue is the function exitpageadmin of the file exitpage.php. The manipulation leads to cross-site request forgery. The attack may be launched remotely. Upgrading to version 1.59 is able to address this issue. The name of the patch is d964b8e961b2634158719f3328f16eda16ce93ac. It is recommended to upgrade the affected component. VDB-225266 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2013-10025", "sourceIdentifier": "cna@vuldb.com", "published": "2023-04-08T17:15:06.987", "lastModified": "2023-04-17T13:59:28.013", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in Exit Strategy Plugin 1.55 and classified as problematic. Affected by this issue is the function exitpageadmin of the file exitpage.php. The manipulation leads to cross-site request forgery. The attack may be launched remotely. Upgrading to version 1.59 is able to address this issue. The name of the patch is d964b8e961b2634158719f3328f16eda16ce93ac. It is recommended to upgrade the affected component. VDB-225266 is the identifier assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:exit_strategy_project:exit_strategy:1.55:*:*:*:*:wordpress:*:*", "matchCriteriaId": "DABDEB56-9B7A-4212-8654-29970E94F5C3"}]}]}], "references": [{"url": "https://github.com/wp-plugins/exit-strategy/commit/d964b8e961b2634158719f3328f16eda16ce93ac", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.225266", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.225266", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/wp-plugins/exit-strategy/commit/d964b8e961b2634158719f3328f16eda16ce93ac"}}