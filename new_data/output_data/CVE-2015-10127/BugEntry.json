{"buggy_code": ["<?php\r\n/*\r\nPlugin Name: PlusCaptcha\r\nPlugin URI: http://www.pluscaptcha.com/\r\nDescription: The Easiest Captcha to Setup and Execute, with Auto-Setup Feature! Forget ugly and complicated captchas! Unique! <strong>TRUSTED BY +27 THOUSAND OF WEBSITES, BLOGS, E-COMMERCE AND GOVERNMENT SITES AROUND WORLD WIDE!</strong> Free Full Service with <strong>24/7 emergency support</strong> ( <a href=\"mailto:emergency@pluscaptcha.com\">emergency@pluscaptcha.com</a> ) plus, with continuously updates and support! Questions? <a href=\"http://www.pluscaptcha.com/contacto\">contact us!</a>\r\nVersion: 2.0.6\r\nAuthor: PlusCaptcha\r\nAuthor URI: http://www.pluscaptcha.com/\r\nLicense: GNU GPL2\r\n*/\r\n/*\r\nCopyright (c) 2014 PlusCaptcha. (www.pluscaptcha.com). All rights reserved.\r\n\r\nThis program is free software; you can redistribute it and/or\r\nmodify it under the terms of the GNU General Public License,\r\nversion 2, as published by the Free Software Foundation.\r\n\r\nThis program is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\n\r\nYou should have received a copy of the GNU General Public License\r\nalong with this program; if not, write to the Free Software\r\nFoundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n*/\r\n/*\r\n\tFor Irina Luchinetz & Igor Borovskoy. I'm not sure about if I could finish this project without their support. My infinite thanks to them! Thanks for make this dream possible, I know about you couldn't help to me like you would like, but this untidy house with infinite love is all I need, all everyone needs...\r\n\t\t- Denis, CEO PlusCaptcha\r\n*/\r\n\r\n/* Ocultar errores */\r\nrequire_once(ABSPATH . 'wp-settings.php');\r\nerror_reporting(0);\r\n/* *************** */\r\n\r\ndefine('PlusCaptcha_SITE_URL', 'http://www.pluscaptcha.com/');\r\n// for backward compatibility - 2.0\r\ndefined('WP_PLUGIN_DIR') or define('WP_PLUGIN_DIR', ABSPATH . '/wp-content/plugins');\r\n\r\n// define absolute path to plugin\r\ndefine('PlusCaptcha_DIR_NAME', basename( dirname(__FILE__) ));\r\ndefine('PlusCaptcha_ROOT', WP_PLUGIN_DIR . '/' . PlusCaptcha_DIR_NAME);\r\ndefine('PlusCaptcha_URL', WP_PLUGIN_URL . '/' . PlusCaptcha_DIR_NAME);\r\n// define absolute path to plugin  PlusCaptcha.php\r\ndefine('PlusCaptcha_PHP_PATH', PlusCaptcha_URL . '/library/PlusCaptcha.php');\r\n// define absolute path to plugin library\r\ndefine('PlusCaptcha_LIBRARY', PlusCaptcha_ROOT . '/library');\r\n// define absolute path to plugin templates\r\ndefine('PlusCaptcha_TEMPLATE', PlusCaptcha_ROOT . '/template');\r\ndefine('PlusCaptcha_ERROR_MESSAGE', 'The solution of task you submitted was incorrect. Please read the instruction and try again.');\r\ndefine('PlusCaptcha_ERROR_MESSAGE_BR', 'The solution of task you submitted was incorrect.<br>Please read the instruction and try again.');\r\n\r\n\r\n/*\r\n********************** External Plugin Used ***********************\r\n*/\r\n\r\n\t/*\r\n\t Thanks to Sweetcaptcha project to help to us with EcoPlus! Fight for the nature!\r\n\t Basecode Was Used.\r\n\t*/\r\n\t/*\r\n\t Thanks to Comment Form Inline Errors @ latorante! (Edited Code)\r\n\t*/\r\n\tinclude dirname(__FILE__) . '/external/comment-form-inline-errors.php';\r\n\t/*\r\n\t Thanks to Simple Session Support @ Peter Wooster! (Editen Code)\r\n\t*/\r\n\tinclude dirname(__FILE__) . '/external/simple-session-support.php';\r\n\t\r\n\t\r\n/*\r\n********************** ******************** ***********************\r\n*/\r\n\r\n\r\n// prepare wordpress version for check\r\n$wp_versions = explode( '.', $wp_version );\r\n\r\nadd_action('init', 'PlusCaptcha_init', 10);\r\nfunction PlusCaptcha_init() {\r\n  //global $wpdb;\r\n  wp_enqueue_script('jquery');\r\n   wp_enqueue_script('jquery-ui-core', false, array('jquery'));\r\n  wp_enqueue_script('jquery-ui-draggable', false, array('jquery'));\r\n  wp_enqueue_script('jquery-ui-droppable', false, array('jquery'));\r\n  wp_enqueue_script( 'plscptf', plugins_url( 'js/plscptf.js', __FILE__ ) );\r\n}\r\n\r\n\t// No more PlusCaptcha.php, directly code:\r\n\t\r\n\t// in case this is called like standalone script - we need wordpress functions available\r\n\tif ( ! function_exists( 'get_option' ) ) {\r\n\t\t// absolute path to wp installation root\r\n\t\t$wordpress_path = realpath ( dirname ( __FILE__ ) . '/../../../' );\r\n\t\trequire_once $wordpress_path . '/wp-load.php';\r\n\t}\r\n\t\r\n\tsession_start();\r\n\t\r\n\t\r\nwp_enqueue_style( 'PlusCaptcha_Stylesheet', plugins_url( 'css/style.css', __FILE__ ) ); // TODO\r\n// split action to admin and public part\r\nif (is_admin()) {\r\n\trequire_once PlusCaptcha_LIBRARY . '/admin.php';\r\n\t// Add admin notices.\r\n\tadd_action('admin_menu', 'PlusCaptcha_admin_menu');\r\n\t\r\n\t// because various problems with register activation hook trough Wordpress versions - check if Sweet Captcha is installed, otherwise set default values\r\n\tadd_action('admin_menu', 'PlusCaptcha_activate');\r\n\tadd_action('admin_menu', 'Generate_New_Account');\r\n\t\r\n\t// add uninstall hook -> remove option values - only for wordpress version >= 2.7\r\n\tif ( ( $wp_versions[ 0 ] >=2 ) && ( $wp_versions[ 1 ] >= 7 ) ) {\r\n\t\tregister_uninstall_hook( __FILE__, 'PlusCaptcha_uninstall' );\r\n\t}\r\n  \r\n} else {\r\n\trequire_once PlusCaptcha_LIBRARY . '/public.php';\r\n\t// add jquery to all public pages\r\n\t//add_action( 'login_head' , 'PlusCaptcha_login_head' );\r\n  //wp_enqueue_script( 'jquery' );\r\n\r\n  // add Sweet Captcha to comment form\r\n\tif ( get_option( 'PlusCaptcha_form_comment' ) ) {\r\n\t\tadd_action( 'comment_form', 'PlusCaptcha_comment_form', 1 );\r\n\t\tadd_filter( 'preprocess_comment', 'PlusCaptcha_comment_form_check', 1 );\r\n\t}\r\n\t\r\n\t// add Sweet Captcha to login form\r\n\tif ( get_option( 'PlusCaptcha_form_login' ) ) {\r\n    // only for version >= 2.8\r\n\t\tif ( ( ( $wp_versions[ 0 ] >= 2 ) || ( $wp_versions[ 1 ] > 7 ) ) ) {\r\n\t\t\tadd_action( 'login_form', 'PlusCaptcha_login_form', 1 );\r\n\t\t\tadd_filter( 'authenticate', 'PlusCaptcha_authenticate', 40, 3 );\r\n\t\t}\r\n    // add PlusCaptcha to BuddyPress login form\r\n    add_action( 'bp_sidebar_login_form', 'PlusCaptcha_login_form' );\r\n\t}\r\n\t\r\n\t// add Sweet Captcha to lost password form\r\n\tif ( get_option( 'PlusCaptcha_form_lost' ) ) {\r\n\t\tadd_action( 'lostpassword_form', 'PlusCaptcha_login_form', 1 );\r\n\t\tadd_filter( 'allow_password_reset', 'PlusCaptcha_lost_password_check', 1 );\r\n\t}\r\n\t\r\n}\r\n\r\n// PlusCaptcha Contact Form \r\nif ( get_option( 'PlusCaptcha_form_contact' ) ) {\r\n  require_once 'library/shortcode-and-others.php';\r\n}", "<?php\r\n\r\nif (!defined('ABSPATH')) { exit; }\r\n\r\nif (!class_exists('wpCommentFormInlineErrors')){\r\n    class wpCommentFormInlineErrors\r\n    {\r\n\r\n        public function __construct() { add_action('init', array($this, 'init')); }\r\n\r\n        /**\r\n         * Hook me up, buttercup\r\n         */\r\n\r\n        public function init()\r\n        {\r\n            session_start();\r\n            /* all these hooks are in wp since version 3.0, that's where we aim. */\r\n            add_filter('wp_die_handler', array($this, 'getWpDieHandler'));\r\n            add_action('comment_form_before_fields', array($this, 'displayFormError'));\r\n            add_action('comment_form_logged_in_after', array($this, 'displayFormError'));\r\n            add_filter('comment_form_default_fields',array($this, 'formDefaults'));\r\n            add_filter('comment_form_field_comment',array($this, 'formCommentDefault'));\r\n        }\r\n\r\n        /**\r\n         * Admin error helper\r\n         *\r\n         * @param $error\r\n         */\r\n\r\n        private function displayAdminError($error) { echo '<div id=\"message\" class=\"error\"><p><strong>' . $error . '</strong></p></div>';  }\r\n\r\n\r\n        function getWpDieHandler($handler){ return array($this, 'handleWpError'); }\r\n\r\n\r\n        /**\r\n         * Now this sounds great does it not? :) After refresh, we can\r\n         * display that message. Easy peasy my man. Of course, only if\r\n         * it's not admin error.\r\n         *\r\n         * @param $message\r\n         * @param string $title\r\n         * @param array $args\r\n         */\r\n\r\n        function handleWpError($message, $title='', $args=array())\r\n        {\r\n            if(!is_admin() && !empty($_POST['comment_post_ID']) && is_numeric($_POST['comment_post_ID'])){\r\n                $_SESSION['formError'] = $message;\r\n                $denied = array('submit', 'comment_post_ID', 'comment_parent');\r\n                foreach($_POST as $key => $value){\r\n                    if(!in_array($key, $denied)){\r\n                        $_SESSION['formFields'][$key] = stripslashes($value);\r\n                    }\r\n                }\r\n                session_write_close();\r\n                wp_safe_redirect(get_permalink($_POST['comment_post_ID']) . '#formError', 302);\r\n                exit;\r\n            } else {\r\n                _default_wp_die_handler($message, $title, $args);\r\n            }\r\n        }\r\n\r\n\r\n        /**\r\n         * Display inline form error.\r\n         */\r\n\r\n        public function displayFormError()\r\n        {\r\n            $formError = $_SESSION['formError'];\r\n            unset($_SESSION['formError']);\r\n            if(!empty($formError)){\r\n                echo '<div id=\"formError\" class=\"formError\" style=\"color:red;\">';\r\n                echo '<p>'. $formError .'</p>';\r\n                echo '</div><div class=\"clear clearfix\"></div>';\r\n            }\r\n        }\r\n\r\n\r\n        /**\r\n         * Reset form defaults to value sent, it's nice when form remebers\r\n         * stuff and doesn't force you to fill in shit again and again.\r\n         *\r\n         * @param $fields\r\n         * @return mixed\r\n         */\r\n\r\n        function formDefaults($fields)\r\n        {\r\n            $formFields = $_SESSION['formFields'];\r\n            foreach($fields as $key => $field){\r\n                if($this->stringContains('input', $field)){\r\n                    if($this->stringContains('type=\"text\"', $field)){\r\n                        $fields[$key] = str_replace('value=\"\"', 'value=\"'. stripslashes($formFields[$key]) .'\"', $field);\r\n                    }\r\n                } elseif ($this->stringContains('</textarea>', $field)){\r\n                    $fields[$key] = str_replace('</textarea>', stripslashes($formFields[$key]) .'</textarea>', $field);\r\n                }\r\n            }\r\n            return $fields;\r\n        }\r\n\r\n\r\n        /**\r\n         * Of course comment field is special :) needs special\r\n         * hook for defaults.\r\n         *\r\n         * @param $comment_field\r\n         * @return mixed\r\n         */\r\n\r\n        function formCommentDefault($comment_field)\r\n        {\r\n            $formFields = $_SESSION['formFields'];\r\n            unset($_SESSION['formFields']);\r\n            return str_replace('</textarea>', $formFields['comment'] . '</textarea>', $comment_field);\r\n        }\r\n\r\n\r\n        /**\r\n         * Just little helper for filling the form again.\r\n         *\r\n         * @param $haystack\r\n         * @param $needle\r\n         * @return bool\r\n         */\r\n\r\n        public function stringContains($needle, $haystack){ return strpos($haystack, $needle) !== FALSE; }\r\n\r\n    }\r\n\r\n}\r\n\r\nnew wpCommentFormInlineErrors();", "<?php\r\n\r\n# Clean\r\n# Limpiar data\r\nfunction tags($tags){  \r\n\t$tags = strip_tags($tags);  \r\n\t$tags = stripslashes($tags);  \r\n\t$tags = htmlentities($tags);\r\n\t$tags = addslashes($tags);\r\n\treturn trim($tags);  \r\n} \r\n\r\ntags($_REQUEST);\r\ntags($_POST);\r\ntags($_GET);\r\n\r\n// settings definiiton\r\n$PlusCaptcha_options = array(\r\n    'uuid_key_speci_to_generate_captchas' => array(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'title' => __('ID of 9 Characters', 'PlusCaptcha'), \r\n\t\t\t\t\t\t\t\t\t\t\t\t'description' => __('Get ID (UUID) registering on www.pluscaptcha.com and customizing your captcha!', 'PlusCaptcha'),\r\n\t\t\t\t\t\t\t\t\t\t\t\t'maxchars' => __('maxlength=\"9\"')\r\n\t\t\t\t\t\t\t\t\t\t\t),\r\n    'background_color_inside_iframe' => array(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'title' => __('Background Color Inside Iframe', 'PlusCaptcha'), \r\n\t\t\t\t\t\t\t\t\t\t\t\t'description' => __('Set none or the color code without hashtag, ex: ffa3c8, ffd5a3'),\r\n\t\t\t\t\t\t\t\t\t\t\t\t'maxchars' => __('maxlength=\"6\"')\r\n\t\t\t\t\t\t\t\t\t\t\t),\r\n    //'PlusCaptcha_key' => array('title' => __('PlusCaptcha Key', 'PlusCaptcha'), 'description' => __('Insert PlusCaptcha Key', 'PlusCaptcha')),\r\n    //'PlusCaptcha_secret' => array('title' => __('PlusCaptcha Secret', 'PlusCaptcha'), 'description' => __('Insert PlusCaptcha Secret', 'PlusCaptcha')),\r\n//    'PlusCaptcha_public_url'\t\t\t=> array('title' => __('PlusCaptcha Public URL', 'PlusCaptcha'), 'description' => __('Default values is \"/wp-content/plugins/PlusCaptcha/library/PlusCaptcha.php\" - don\\'t change it unless you know what are you doing.', 'PlusCaptcha')),\r\n    'PlusCaptcha_form_comment' => array('title' => __('Captcha in Comment Form', 'PlusCaptcha')),\r\n    //'PlusCaptcha_form_registration' => array('title' => __('Captcha in Register Form', 'PlusCaptcha')),\r\n    'PlusCaptcha_form_lost' => array('title' => __('Captcha in Password Recovery of Login', 'PlusCaptcha')),\r\n    'PlusCaptcha_form_login' => array('title' => __('Captcha in Login Form', 'PlusCaptcha')),\r\n\t    'PlusCaptcha_form_omit_users' => array('title' => __('Hide Captcha to Logged Users', 'PlusCaptcha')),\r\n\t    //'PlusCaptcha_form_omit_backlink' => array('title' => __('Hide Backlink', 'PlusCaptcha'), 'description' => __('If you hide the backlink you will not Collaborate More with EcoPlus mission.', 'PlusCaptcha')),\r\n\t\t//'PlusCaptcha_form_feedback' => array('title' => __('Feedback Program', 'PlusCaptcha'), 'description' => __('The \"Feedback Program\" help to us make the service better every day. <a href=\"#\">Read More.</a>', 'PlusCaptcha'), 'disabled' => true),\r\n\t\t//'PlusCaptcha_feedback_quemejoraria' => array('title' => __('What do you love of PlusCaptcha and what do you think we can amend?', 'PlusCaptcha'),'maxchars' => __('maxlength=\"299\"')),\r\n    'PlusCaptcha_form_contact' => array('title' => __('<b>Contact Form</b>', 'PlusCaptcha'), 'description' => __('Insert a contact form where you wanna. In one page, post, or everywhere with a simple code. Just copy this code: [im_helping_with_ecoplus] in the description of your page, post, etc.', 'PlusCaptcha')),\r\n);\r\n\r\n/**\r\n * @return true if PlusCaptcha is properly registered.\r\n */\r\nfunction PlusCaptcha_is_registered() {\r\n  return (\r\n  \t\t\t(get_option('uuid_key_speci_to_generate_captchas', '')) \r\n\t\t\t&& (get_option('PlusCaptcha_feedback_quemejoraria', '')) \r\n\t\t\t//&& (get_option('PlusCaptcha_key', '')) \r\n\t\t\t//&& (get_option('PlusCaptcha_secret', ''))\r\n \t\t );\r\n}\r\n\r\n/**\r\n * Display admin notices.\r\n * @return void\r\n */\r\nfunction PlusCaptcha_admin_notices() {\r\n  // If the plugin is not configured yet.\r\n  if (!PlusCaptcha_is_registered()) {\r\n    echo '<div class=\"error PlusCaptcha\" style=\"text-align: center; float:left;width:99%;\">\r\n      <p style=\"color: red; font-size: 14px; font-weight: bold;\">' . __('Your PlusCaptcha plugin is not setup yet') \r\n      . '</p><p>' . __('Click ') . '<a href=\"options-general.php?page=PlusCaptcha\">' . __('here') . '</a> ' \r\n      . __('to finish setup.') . '</p></div>'\r\n    ;\r\n  }\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha settings link to admin menu\r\n * @return void\r\n */\r\nfunction PlusCaptcha_admin_menu() {\r\n  //$menu_item = \"<div class='admin-menu-item'>PlusCaptcha</div>\";\r\n  //add_options_page(__('PlusCaptcha', 'PlusCaptcha'), __($menu_item, 'PlusCaptcha'), 'manage_options', 'PlusCaptcha', 'PlusCaptcha_options_page');\r\n  add_menu_page(__('PlusCaptcha', 'PlusCaptcha'), __('PlusCaptcha', 'PlusCaptcha'), 'manage_options', 'PlusCaptcha', 'PlusCaptcha_options_page', \r\n          PlusCaptcha_URL.'/images/menu-icon.png');\r\n}\r\n\r\n/**\r\n * PlusCaptcha options page logic\r\n * @return void\r\n */\r\nfunction PlusCaptcha_options_page() {\r\n  //must check that the user has the required capability \r\n  if (!current_user_can('manage_options')) {\r\n    wp_die(__('You do not have sufficient permissions to access this page.'));\r\n  }\r\n\r\n  //$skip_register = ((isset($_REQUEST['skip_register'])) && ($_REQUEST['skip_register'] == 1));\r\n  //if (true) {\r\n    sweetcatpcha_main_settings();\r\n  //} else {\r\n    PlusCaptcha_register_form();\r\n  //}\r\n}\r\n\r\n/**\r\n * Displays the PlusCaptcha register form.\r\n * @return void\r\n */\r\nfunction PlusCaptcha_register_form() {\r\n  global $PlusCaptcha_instance;\r\n\r\n  $hidden_field_name = 'mt_submit_hidden';\r\n  $form_html = 'Could not load registration form.';\r\n  //var_export($_POST);\r\n  // See if the user has posted us some information\r\n  // If they did, this hidden field will be set to 'Y'\r\n  if ((isset($_POST[$hidden_field_name])) && ($_POST[$hidden_field_name] == 'Y')) {\r\n    $result = json_decode(submit_register_form($_POST), true);\r\n    if ($result['error']) {\r\n      if (!empty($result['html'])) {\r\n        $form_html = $result['html'];\r\n      }\r\n    } else {\r\n      update_option('uuid_key_speci_to_generate_captchas', $result['app_id']);\r\n\t  update_option('PlusCaptcha_feedback_quemejoraria', $_POST[\"PlusCaptcha_feedback_quemejoraria\"]);\r\n      //update_option('PlusCaptcha_key', $result['key']);\r\n      //update_option('PlusCaptcha_secret', $result['secret']);\r\n\r\n      // Load the main options page, and ignore the post data (since it's missing all the options!).\r\n      sweetcatpcha_main_settings(true);\r\n\r\n      // Hide the \"your plugin is not set up yet\" message.\r\n      echo \"\r\n\t\t\t\t<script type=\\\"text/javascript\\\" language=\\\"javascript\\\">\r\n\t\t\t\t\tjQuery('div.error.PlusCaptcha').hide();\r\n\t\t\t\t</script>\r\n\t\t\t\";\r\n      return;\r\n    }\r\n  } else {\r\n    //$form_html = $PlusCaptcha_instance->get_register_form();\r\n\t$form_html = \"NONE\";\r\n  }\r\n  // Fill Register Form fields\r\n  $website = json_encode(empty($_POST['website']) ? \"http://{$_SERVER['SERVER_NAME']}/\" : $_POST['website']);\r\n  $email = json_encode($_POST['email']);\r\n  \r\n  //jQuery('<div><input type=\"text\" class=\"field\" name=\"dynamic[]\" value=\"' + i + '\" /></div>').fadeIn('slow').appendTo('.inputs');\r\n  $form_html .= \"<script type=\\\"text/javascript\\\" language=\\\"javascript\\\">\\n\";\r\n  $form_html .= \"    jQuery('input[name=website]').addClass('requiredField');\\n\";\r\n  $form_html .= \"    jQuery('input[name=email]').addClass('requiredField');\\n\";\r\n  $form_html .= \"    jQuery('select[name=site_category]').addClass('requiredField');\\n\";\r\n    \r\n  $form_html .= \"    jQuery('input[name=website]').val($website);\\n\";\r\n  $form_html .= \"    jQuery('input[name=email]').val($email);\\n\";\r\n\r\n  if (isset($_POST['language'])) {\r\n    $language = (int) $_POST['language'];\r\n    $form_html .= \"    jQuery('select[name=language]').val($language);\\n\";\r\n  }\r\n  if (isset($_POST['category'])) {\r\n    $category = (int) $_POST['category'];\r\n    $form_html .= \"    jQuery('select[name=category]').val($category);\\n\";\r\n  }\r\n  if (isset($_POST['site_category'])) {\r\n    $site_category = (int) $_POST['site_category'];\r\n    $form_html .= \"    jQuery('select[name=site_category]').val($site_category);\\n\";\r\n  }\r\n  if (isset($_POST['gender'])) {\r\n    $gender = (int) $_POST['gender'];\r\n    $form_html .= \"    jQuery('select[name=gender]').val($gender);\\n\";\r\n  }\r\n  $form_html .= \"</script>\\n\";\r\n  \r\n  $form_html = preg_replace('/category:/', 'PlusCaptcha design:', $form_html);\r\n  //$form_html = preg_replace('/Please fill in your site details/', 'Fill in your PlusCaptcha details to activate:', $form_html);\r\n  $form_html = preg_replace('/language:/', 'PlusCaptcha language:', $form_html);\r\n  //$form_html = preg_replace('/PlusCaptcha theme:/', 'PlusCaptcha design:', $form_html);\r\n  //$form_html = str_lreplace(\"</tr>\", '</tr><tr><td class=\"left\">Website category:</td><td class=\"right\"><select name=\"site_category\">'.$select_html.'</select></td></tr>',$form_html);\r\n  \r\n  $form_html .= \"<script type=\\\"text/javascript\\\">\\n jQuery('input[name=email_verify]').val(jQuery('input[name=email]').val()); jQuery('input[name=email_verify]').parent().parent().hide(); </script>\\n\";\r\n  $form_html .= \"<script type=\\\"text/javascript\\\">\\n jQuery('input[name=email]').change(function() {jQuery('input[name=email_verify]').val(jQuery(this).val());}); </script>\\n\";\r\n  \r\n  /*\r\n  $cats = file(PlusCaptcha_ROOT.'/site-categories.txt');\r\n  $select_html = '';\r\n  foreach ($cats as $cat) {\r\n    $cat =  trim ( $cat);\r\n    $select_html .= \"<option value='$cat'>$cat</option>\";\r\n  }\r\n  //$form_html = preg_replace(strrev(\"|</tr>|\"),'</tr><tr><td></td><td></td></tr>',$form_html,1);\r\n  $form_html = str_lreplace(\"</tr>\", '</tr><tr><td class=\"left\">Website category:</td><td class=\"right\"><select name=\"site_category\">'.$select_html.'</select></td></tr>',$form_html);\r\n  */\r\n\r\n\r\n}\r\n\r\nfunction str_lreplace($search, $replace, $subject) {\r\n  return substr_replace($subject, $replace, strrpos($subject, $search), strlen($search));\r\n}\r\n\r\n/**\r\n * Displays the main PlusCaptcha settings.\r\n * @return void\r\n */\r\nfunction sweetcatpcha_main_settings($ignore_post = false) {\r\n  global $PlusCaptcha_options, $plscptf_options;\r\n\r\n  // variables for the field and option names \r\n  $opt_name = 'mt_favorite_color';\r\n  $hidden_field_name = 'mt_submit_hidden';\r\n  $data_field_name = 'mt_favorite_color';\r\n\r\n  PlusCaptcha_contactform_settings();\r\n\r\n  // See if the user has posted us some information\r\n  // If they did, this hidden field will be set to 'Y'\r\n  if ((!$ignore_post) && (isset($_POST[$hidden_field_name])) && ($_POST[$hidden_field_name] == 'Y')) {\r\n    $rs = TRUE;\r\n\r\n    // Read their posted value\r\n    foreach ($PlusCaptcha_options as $opt_name => $v) {\r\n      $opt_val = isset($_POST[$opt_name]) ? $_POST[$opt_name] : null;\r\n\r\n      // Save the posted value in the database\r\n      update_option($opt_name, $opt_val);\r\n    }\r\n\r\n    if ( plscptf_settings_save() ) {\r\n      // Put an settings updated message on the screen\r\n      $saved_html = 'Settings saved.';\r\n      if (PlusCaptcha_is_registered()) {\r\n        $saved_html .= \"\r\n\t\t\t\t<script type=\\\"text/javascript\\\" language=\\\"javascript\\\">\r\n\t\t\t\t\tjQuery( 'div.error.PlusCaptcha' ).hide();\r\n\t\t\t\t</script>\r\n      \t\";\r\n      }\r\n    }\r\n\r\n    $message = $rs ? __($saved_html, 'PlusCaptcha') : __('settings cannot be saved.', 'PlusCaptcha');\r\n  }\r\n\r\n  // Read in existing option value from database\r\n  $options_values = PlusCaptcha_options();\r\n\r\n  //echo 'plscptf_options='; var_export($plscptf_options);\r\n  require_once PlusCaptcha_TEMPLATE . '/admin-options.php';\r\n\r\n}\r\n\r\n// Sweet Captcha Contact Form settings \r\nfunction PlusCaptcha_contactform_settings() {\r\n  global $plscptf_options;\r\n\r\n  $plscptf_option_defaults = array(\r\n      'plscptf_user_email' => 'admin',\r\n      'plscptf_custom_email' => '',\r\n      'plscptf_select_email' => 'user',\r\n      'plscptf_additions_options' => 0,\r\n      'plscptf_send_copy' => 0,\r\n      'plscptf_from_field' => get_bloginfo('name'),\r\n      'plscptf_display_add_info' => 1,\r\n      'plscptf_display_sent_from' => 1,\r\n      'plscptf_display_date_time' => 1,\r\n      'plscptf_mail_method' => 'wp-mail',\r\n      'plscptf_display_coming_from' => 1,\r\n      'plscptf_display_user_agent' => 1,\r\n      'plscptf_change_label' => 0,\r\n      'plscptf_name_label' => __(\"Name:\", 'PlusCaptcha'),\r\n      'plscptf_email_label' => __(\"E-Mail Address:\", 'PlusCaptcha'),\r\n      'plscptf_subject_label' => __(\"Subject:\", 'PlusCaptcha'),\r\n      'plscptf_message_label' => __(\"Message:\", 'PlusCaptcha'),\r\n      'plscptf_action_after_send' => 1,\r\n      'plscptf_thank_text' => __(\"Thank you for contacting us.\", 'PlusCaptcha'),\r\n      'plscptf_redirect_url' => ''\r\n  );\r\n  if (!get_option('PlusCaptcha_form_contact_options'))\r\n    add_option('PlusCaptcha_form_contact_options', $plscptf_option_defaults);\r\n\r\n  $plscptf_options = get_option('PlusCaptcha_form_contact_options');\r\n  if (is_array($plscptf_options) ) {\r\n    $plscptf_options = array_merge($plscptf_option_defaults, $plscptf_options);\r\n  } else {\r\n    $plscptf_options = $plscptf_option_defaults;\r\n  }\r\n  update_option('PlusCaptcha_form_contact_options', $plscptf_options);\r\n}\r\n\r\nfunction plscptf_settings_save() {\r\n  global $plscptf_options, $wpdb, $error;\r\n  $userslogin = $wpdb->get_col(\"SELECT user_login FROM  $wpdb->users \", 0);\r\n  $plscptf_options_submit = array();\r\n  // Save data for settings page\r\n  $plscptf_options_submit['plscptf_user_email'] = $_REQUEST['plscptf_user_email'];\r\n  $plscptf_options_submit['plscptf_custom_email'] = $_REQUEST['plscptf_custom_email'];\r\n  $plscptf_options_submit['plscptf_select_email'] = $_REQUEST['plscptf_select_email'];\r\n  $plscptf_options_submit['plscptf_additions_options'] = isset($_REQUEST['plscptf_additions_options']) ? $_REQUEST['plscptf_additions_options'] : 0;\r\n  if ($plscptf_options_submit['plscptf_additions_options'] == 0) {\r\n    $plscptf_options_submit['plscptf_send_copy'] = 0;\r\n    $plscptf_options_submit['plscptf_from_field'] = get_bloginfo('name');\r\n    $plscptf_options_submit['plscptf_display_add_info'] = 1;\r\n    $plscptf_options_submit['plscptf_display_sent_from'] = 1;\r\n    $plscptf_options_submit['plscptf_display_date_time'] = 1;\r\n    $plscptf_options_submit['plscptf_mail_method'] = 'wp-mail';\r\n    $plscptf_options_submit['plscptf_display_coming_from'] = 1;\r\n    $plscptf_options_submit['plscptf_display_user_agent'] = 1;\r\n    $plscptf_options_submit['plscptf_change_label'] = 0;\r\n    $plscptf_options_submit['plscptf_name_label'] = __(\"Name:\", 'PlusCaptcha');\r\n    $plscptf_options_submit['plscptf_email_label'] = __(\"E-Mail Address:\", 'PlusCaptcha');\r\n    $plscptf_options_submit['plscptf_subject_label'] = __(\"Subject:\", 'PlusCaptcha');\r\n    $plscptf_options_submit['plscptf_message_label'] = __(\"Message:\", 'PlusCaptcha');\r\n    $plscptf_options_submit['plscptf_action_after_send'] = 1;\r\n    $plscptf_options_submit['plscptf_thank_text'] = __(\"Thank you for contacting us.\", 'PlusCaptcha');\r\n    $plscptf_options_submit['plscptf_redirect_url'] = '';\r\n  } else {\r\n    $plscptf_options_submit['plscptf_send_copy'] = isset($_REQUEST['plscptf_send_copy']) ? $_REQUEST['plscptf_send_copy'] : 0;\r\n    $plscptf_options_submit['plscptf_mail_method'] = $_REQUEST['plscptf_mail_method'];\r\n    $plscptf_options_submit['plscptf_from_field'] = $_REQUEST['plscptf_from_field'];\r\n    $plscptf_options_submit['plscptf_display_add_info'] = isset($_REQUEST['plscptf_display_add_info']) ? 1 : 0;\r\n    $plscptf_options_submit['plscptf_change_label'] = isset($_REQUEST['plscptf_change_label']) ? 1 : 0;\r\n    if ($plscptf_options_submit['plscptf_display_add_info'] == 1) {\r\n      $plscptf_options_submit['plscptf_display_sent_from'] = isset($_REQUEST['plscptf_display_sent_from']) ? 1 : 0;\r\n      $plscptf_options_submit['plscptf_display_date_time'] = isset($_REQUEST['plscptf_display_date_time']) ? 1 : 0;\r\n      $plscptf_options_submit['plscptf_display_coming_from'] = isset($_REQUEST['plscptf_display_coming_from']) ? 1 : 0;\r\n      $plscptf_options_submit['plscptf_display_user_agent'] = isset($_REQUEST['plscptf_display_user_agent']) ? 1 : 0;\r\n    } else {\r\n      $plscptf_options_submit['plscptf_display_sent_from'] = 1;\r\n      $plscptf_options_submit['plscptf_display_date_time'] = 1;\r\n      $plscptf_options_submit['plscptf_display_coming_from'] = 1;\r\n      $plscptf_options_submit['plscptf_display_user_agent'] = 1;\r\n    }\r\n    if ($plscptf_options_submit['plscptf_change_label'] == 1) {\r\n      $plscptf_options_submit['plscptf_name_label'] = isset($_REQUEST['plscptf_name_label']) ? $_REQUEST['plscptf_name_label'] : $plscptf_options_submit['plscptf_name_label'];\r\n      $plscptf_options_submit['plscptf_email_label'] = isset($_REQUEST['plscptf_email_label']) ? $_REQUEST['plscptf_email_label'] : $plscptf_options_submit['plscptf_email_label'];\r\n      $plscptf_options_submit['plscptf_subject_label'] = isset($_REQUEST['plscptf_subject_label']) ? $_REQUEST['plscptf_subject_label'] : $plscptf_options_submit['plscptf_subject_label'];\r\n      $plscptf_options_submit['plscptf_message_label'] = isset($_REQUEST['plscptf_message_label']) ? $_REQUEST['plscptf_message_label'] : $plscptf_options_submit['plscptf_message_label'];\r\n    } else {\r\n      $plscptf_options_submit['plscptf_name_label'] = __(\"Name:\", 'PlusCaptcha');\r\n      $plscptf_options_submit['plscptf_email_label'] = __(\"E-Mail Address:\", 'PlusCaptcha');\r\n      $plscptf_options_submit['plscptf_subject_label'] = __(\"Subject:\", 'PlusCaptcha');\r\n      $plscptf_options_submit['plscptf_message_label'] = __(\"Message:\", 'PlusCaptcha');\r\n    }\r\n    $plscptf_options_submit['plscptf_action_after_send'] = $_REQUEST['plscptf_action_after_send'];\r\n    $plscptf_options_submit['plscptf_thank_text'] = $_REQUEST['plscptf_thank_text'];\r\n    $plscptf_options_submit['plscptf_redirect_url'] = $_REQUEST['plscptf_redirect_url'];\r\n  }\r\n  $plscptf_options = array_merge($plscptf_options, $plscptf_options_submit);\r\n  if ($plscptf_options_submit['plscptf_action_after_send'] == 0\r\n          && ( trim($plscptf_options_submit['plscptf_redirect_url']) == \"\"\r\n          || !preg_match('@^(?:http://)?([^/]+)@i', trim($plscptf_options_submit['plscptf_redirect_url'])) )) {\r\n    $error .=__(\"If the option 'Redirect to page' is selected then url field should be fillied in the following format\", 'PlusCaptcha') . \" <code>http://your_site/your_page</code>\";\r\n    $plscptf_options['plscptf_action_after_send'] = 1;\r\n  }\r\n  if ('user' == $plscptf_options_submit['plscptf_select_email']) {\r\n    if (function_exists('get_userdatabylogin') && false !== get_userdatabylogin($plscptf_options_submit['plscptf_user_email'])) {\r\n      update_option('PlusCaptcha_form_contact_options', $plscptf_options, '', 'yes');\r\n      $message = __(\"Options saved.\", 'PlusCaptcha');\r\n    } else if (false !== get_user_by('login', $plscptf_options_submit['plscptf_user_email'])) {\r\n      update_option('PlusCaptcha_form_contact_options', $plscptf_options, '', 'yes');\r\n      $message = __(\"Options saved.\", 'PlusCaptcha');\r\n    } else {\r\n      $error .=__(\"Such user does not exist. Settings not saved.\", 'PlusCaptcha');\r\n    }\r\n  } else {\r\n    if ( isset($_REQUEST['PlusCaptcha_form_contact']) ) {\r\n      if ($plscptf_options_submit['plscptf_custom_email'] != \"\" && preg_match(\"/^((?:[a-z0-9]+(?:[a-z0-9\\-_\\.]+)?@[a-z0-9]+(?:[a-z0-9\\-\\.]+)?\\.[a-z]{2,5})[, ]*)+$/i\", trim($plscptf_options_submit['plscptf_custom_email']))) {\r\n        update_option('PlusCaptcha_form_contact_options', $plscptf_options, '', 'yes');\r\n      $message = __(\"Options saved.\", 'PlusCaptcha');\r\n      } else {\r\n        $error .= __(\"Please input correct email. Settings not saved.\", 'PlusCaptcha');\r\n      }\r\n    } else {\r\n      $message = __(\"Options saved.\", 'PlusCaptcha');\r\n    }\r\n  }\r\n  return empty($error);\r\n}\r\n\r\n/**\r\n * Get all PlusCaptcha options values as asociative array\r\n * @return array\r\n */\r\nfunction PlusCaptcha_options() {\r\n  global $PlusCaptcha_options;\r\n  $options_values = array();\r\n  foreach ($PlusCaptcha_options as $opt_name => $opt_title) {\r\n    $options_values[$opt_name] = get_option($opt_name);\r\n  }\r\n  return $options_values;\r\n}\r\n\r\n/**\r\n * PlusCaptcha plug-in activation hook\r\n * @return void\r\n */\r\nfunction PlusCaptcha_activate() {\r\n  $PlusCaptcha_defaults = array(\r\n      'uuid_key_speci_to_generate_captchas' => '',\r\n\t  'background_color_inside_iframe' => 'none',\r\n      //'PlusCaptcha_key' => '',\r\n      //'PlusCaptcha_secret' => '',\r\n      //'PlusCaptcha_public_url' => '/wp-content/plugins/PlusCaptcha/library/PlusCaptcha.php',\r\n      'PlusCaptcha_form_omit_users' => '1',\r\n\t  'PlusCaptcha_form_omit_backlink' => '1',\r\n\t  'PlusCaptcha_form_feedback' => '1',\r\n\t  'PlusCaptcha_form_feedback' => '1',\r\n      'PlusCaptcha_form_registration' => '0',\r\n      'PlusCaptcha_form_comment' => '1',\r\n      'PlusCaptcha_form_login' => '0',\r\n      'PlusCaptcha_form_lost' => '1',\r\n      'PlusCaptcha_form_contact' => '0',\r\n\t  'PlusCaptcha_ocultar_backlink' => '0',\r\n      'PlusCaptcha_installed' => '1',\r\n  );\r\n  if (!get_option('PlusCaptcha_installed')) {\r\n    foreach ($PlusCaptcha_defaults as $opt_name => $opt_val) {\r\n      $opt_curr_val = get_option($opt_name);\r\n      if (empty($opt_curr_val)) {\r\n        update_option($opt_name, $opt_val);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction Generate_New_Account() \r\n{\r\n\r\n\tif( strlen(get_option( 'uuid_api_wp_feedback' )) < 4 )\r\n\t{\r\n\t\t$url = 'http://www.pluscaptcha.com/api/wp_log/install?'\r\n\t\t\t\t.'name='.urlencode(get_bloginfo('name')).\r\n\t\t\t\t'&url='.str_replace(\".\",\"[dot]\",urlencode(get_bloginfo('url'))).\r\n\t\t\t\t'&description='.urlencode(get_bloginfo('description')).\r\n\t\t\t\t'&wpurl='.str_replace(\".\",\"[dot]\",urlencode(get_bloginfo('wpurl'))).\r\n\t\t\t\t'&admin_email='.urlencode(get_bloginfo('admin_email')).\r\n\t\t\t\t'&charset='.urlencode(get_bloginfo('charset')).\r\n\t\t\t\t'&version='.urlencode(get_bloginfo('version')).\r\n\t\t\t\t'&language='.urlencode(get_bloginfo('language')).\r\n\t\t\t\t'&registrarse=1'.''; // Sistema para registrar cuenta activado.\r\n\t\t\t\t\r\n\t\t$result = @fgets(@fopen($url, 'r'), 4096);\r\n\t\t\r\n\t\t// Guardar que ya fu\u00e9 subido\r\n\t\t$exploded = explode(\"#\",$result);\r\n\t\tupdate_option('uuid_api_wp_feedback', $exploded[0]); // Guardar UUID\r\n\t\r\n\t\tif($exploded[1] != \"\") // Ver si devolvi\u00f3 la password\r\n\t\t{\t\r\n\t\t\tupdate_option('pluscaptcha_account_user', get_bloginfo('admin_email')); // Guardar usuario (admin mail)\r\n\t\t\tupdate_option('pluscaptcha_account_password', $exploded[1]); // Guardar contrase\u0144a (devuelta por fgets)\r\n\t\t\tupdate_option('registered_account_from_api', true);\r\n\t\t}\r\n\t\t\r\n\t\tif($exploded[2] != \"\" && $exploded[3] != \"\" && $exploded[4] != \"\") // Ver si devolvi\u00f3 UUID cuenta generada\r\n\t\t{\r\n\t\t\t$compuesto = $exploded[3].\"#\".$exploded[2].\"#\".$exploded[4];\r\n\t\t\tupdate_option('uuid_key_speci_to_generate_captchas', $compuesto); // Guardar UUID cuenta generada\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * Delete PlusCaptcha options from database\r\n * @return void\r\n */\r\nfunction PlusCaptcha_uninstall() {\r\n  global $PlusCaptcha_options;\r\n\r\n  foreach ($PlusCaptcha_options as $opt_name => $opt_title) {\r\n    delete_option($opt_name);\r\n  }\r\n  // These do not appear in the global .\r\n  delete_option('PlusCaptcha_installed');\r\n}\r\n\r\n?>\r\n", "<?php\r\n\r\n/**\r\n * Get PlusCaptcha values from POST data\r\n * @return array\r\n */\r\nfunction PlusCaptcha_get_values() {\r\n\treturn array(\r\n\t\t'sckey'\t\t=> ( isset( $_POST[ 'sckey' ] ) ? $_POST[ 'sckey' ] : '' ),\r\n\t\t'scvalue'\t=> ( isset( $_POST[ 'scvalue' ] ) ? $_POST[ 'scvalue' ] : '' )\r\n\t);\r\n}\r\n\r\nfunction get_result($entrada,$shortcode=false) {\r\n\r\n\t$limpiado = strip_tags(stripslashes(htmlentities(addslashes(trim($entrada)))));  \r\n\t$datosent = explode(\"///\",$limpiado);  \r\n\t\r\n\tif($datosent[0] != ''){ \r\n\t\tif($datosent[1] == 'c'){ \r\n\t\t\t$host = 'syshtml5.pluscaptcha.com'; \r\n\t\t}else{ \r\n\t\t\t$HostReg = array('syshtml5.agartha.us','syshtml5.loquees.biz','syshtml5.ispect.ws');  \r\n\t\t\t$host = $HostReg[$datosent[1]]; \r\n\t\t} \r\n\t\r\n\t\t//$_SESSION[\"contacto\"] = '';\r\n\t\tif(!$shortcode)\r\n\t\t{\r\n\t\t\tsimpleSessionSet(\"contacto\", \"\");\r\n\t\t}else{\r\n\t\t\tsimpleSessionSet(\"contacto_shortcode\", \"\");\r\n\t\t}\r\n\t\t\r\n\t\t$resultado_ejecucion = @fgets(@fopen('http://'.$host.'/r?iduso='.$datosent[0]. '', 'r'), 4096);\r\n\r\n\t\t// Acertar si acert\u00f3 con el captcha\r\n\t\tif($resultado_ejecucion)\r\n\t\t{\r\n\t\t\t// Acert\u00f3\r\n\t\t\t// Crear \"pasaporte\" por si no acierta los otros campos. SOLO SI NO FU\u00c9 CREADO \u00c1NTES\r\n\t\t\t//$_SESSION[\"passport\"] = true;\r\n\t\t\t// poner true luego\r\n\t\t\treturn true;\r\n\t\t\t\r\n\t\t}else{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\r\n\t// No vino con d\u00e1tos (debe estar muerta la sessi\u00f3n), ver si tiene pasaporte\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * Move submit button under PlusCaptcha field.\r\n * @return string\r\n */\r\nfunction PlusCaptcha_move_submit_button() {\r\n\treturn '<div id=\"PlusCaptcha-submit-button\" class=\"form-submit\" style=\"display: table; margin-top: 20px;\"></div>'.\r\n\t\t'<script type=\"text/javascript\">'.\r\n\t\t\t'var sub = document.getElementById(\"submit\");'.\r\n\t\t\t'if (sub!=undefined){'.\r\n\t\t\t'sub.parentNode.removeChild(sub);'.\r\n\t\t\t'document.getElementById(\"PlusCaptcha-submit-button\").appendChild (sub);'.\r\n\t\t\t'document.getElementById(\"submit\").tabIndex = 6;}'.\r\n\t\t'</script>\r\n\t\t<br />';\r\n}\r\n\r\nfunction captcha_call($shortcode=false){\r\n\t\tif(get_option('uuid_key_speci_to_generate_captchas', '') != \"\")\r\n\t\t{\r\n\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t$keyC = @fgets(@fopen('http://captchakey.biz/', 'r'), 4096);\r\n\r\n\t\t\t\t\t\t\t\t\tif ($keyC == '1'){  \r\n\t\t\t\t\t\t\t\t\t    $Hostausar = 'syshtml5.pluscaptcha.com';  \r\n\t\t\t\t\t\t\t\t\t    $h = 'c'; \r\n\t\t\t\t\t\t\t\t\t}else{ \r\n\t\t\t\t\t\t\t\t\t    $Hostausar = array('syshtml5.agartha.us','syshtml5.loquees.biz','syshtml5.ispect.ws');  \r\n\t\t\t\t\t\t\t\t\t    $Aleatorio = array_rand($Hostausar,1); \r\n\t\t\t\t\t\t\t\t\t    $Hostausar = $Hostausar[$Aleatorio];  \r\n\t\t\t\t\t\t\t\t\t    $h = $Aleatorio; \r\n\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// Obtener especificaciones para el captcha\r\n\t\t\t\t\t\t\t\t\t$value_exploded = explode(\"#\",get_option('uuid_key_speci_to_generate_captchas', ''));\r\n\t\t\t\t\t\t\t\t\t// Obtener tama\u0144o a inyectar al iframe\r\n\t\t\t\t\t\t\t\t\t\t// Obtener Ancho\r\n\t\t\t\t\t\t\t\t\t\tswitch ($value_exploded[0]) {\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'C':\r\n\t\t\t\t\t\t\t\t\t\t\t\t$width = 205;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'M':\r\n\t\t\t\t\t\t\t\t\t\t\t\t$width = 205;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'G':\r\n\t\t\t\t\t\t\t\t\t\t\t\t$width = 235;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t// Obtener Alto\r\n\t\t\t\t\t\t\t\t\t\tswitch ($value_exploded[0]) {\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'C':\r\n\t\t\t\t\t\t\t\t\t\t\t\t$height = 115;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'M':\r\n\t\t\t\t\t\t\t\t\t\t\t\t$height = 125;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'G':\r\n\t\t\t\t\t\t\t\t\t\t\t\t$height = 145;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t// Obtener backlink\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\t\t\tif(get_option('ecoplus_url_backlink', '') == \"\")\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t// Generar backlink y almacenarlo\r\n\t\t\t\t\t\t\t\t\t\t$data = \"\";\r\n\t\t\t\t\t\t\t\t\t\t// Obtener un key externo\r\n\t\t\t\t\t\t\t\t\t\t$key_uuid_externo = @fgets(@fopen('http://www.pluscaptcha.com/api/avaliable.php', 'r'), 4096);\r\n\t\t\t\t\t\t\t\t\t\t// Obtener un backlink\r\n\t\t\t\t\t\t\t\t\t\t$gestor = @fopen(\"http://www.pluscaptcha.com/api/anchor?lang=\".$value_exploded[2].\"&identnumber=\".$key_uuid_externo, \"r\");\r\n\t\t\t\t\t\t\t\t\t\t// Tomar la data\r\n\t\t\t\t\t\t\t\t\t\tif ($gestor) {\r\n\t\t\t\t\t\t\t\t\t\t\twhile (($buffer = fgets($gestor, 4096)) !== false) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t$data .= $buffer;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tfclose($gestor);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t// Ver si devolvi\u00f3 un backlink buscando <p (notese que falta el corchete, est\u00e1 bien...)\r\n\t\t\t\t\t\t\t\t\t\tif( substr_count(html_entity_decode($data), \"</p>\") > 0 )\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t// Guardar\r\n\t\t\t\t\t\t\t\t\t\t\tupdate_option('ecoplus_url_backlink', $data);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t$c = 'none';\r\n\t\t\t\t\t\t\t\t\t$uidus = @fgets(@fopen('http://'.$Hostausar.'/g?id='.$value_exploded[1].'&c='.$c, 'r'), 4096);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t$value_to_set = $uidus.'///'.$h;\r\n\t\t\t\t\t\t\t\t\tif(!$shortcode)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tsimpleSessionSet(\"contacto\", $value_to_set);\r\n\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\tsimpleSessionSet(\"contacto_shortcode\", $value_to_set);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t'<div style=\"width:'.$width.'px; height: auto;\"> \r\n\r\n\t\t\t\t\t\t\t\t\t    <iframe src=\"http://'.$Hostausar.'/i?iduso='.$uidus.'\"  \r\n\t\t\t\t\t\t\t\t\t    width=\"'.$width.'\" height=\"'.$height.'\" scrolling=\"no\" frameborder=\"0\"></iframe>  \r\n\r\n\t\t\t\t\t\t\t\t\t</div>';\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t}else{\r\n\t\t\treturn '<div>Please make the setup of PlusCaptcha in your Wordpress Panel</div>';\r\n\t\t}\t\t\t\t\t\t\r\n}\r\n \r\n \r\n/**\r\n * Add PlusCaptcha to comment form\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_comment_form() {\r\n\tglobal $PlusCaptcha_instance, $user_ID, $wp_version;\r\n\t$wp_versions = explode( '.', $wp_version );\r\n\tif ( get_option( 'PlusCaptcha_form_ommit_users' ) && isset($user_ID) && (int)$user_ID > 0 ) {\r\n\t\treturn true;\r\n\t}\r\n\t//echo $PlusCaptcha_instance->get_html();\r\n\techo captcha_call();\r\n\techo PlusCaptcha_move_submit_button();\r\n\tif ( $wp_versions[ 0 ] >= 3 && $wp_versions[ 1 ] >= 0 ) { \r\n\t\techo '<script type=\"text/javascript\">document.getElementById(\"respond\").style.overflow=\"visible\";</script>';\r\n\t}\r\n\tremove_action( 'comment_form', 'PlusCaptcha_comment_form' );\r\n\treturn true;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha check submitted comment form\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_comment_form_check($comment) {\r\n\tglobal $PlusCaptcha_instance, $user_ID;\r\n\tif ( get_option( 'PlusCaptcha_form_ommit_users' ) && isset($user_ID) && (int)$user_ID > 0  ) {\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t\treturn $comment;\r\n\t}\r\n\tif ( !empty( $comment[ 'comment_type' ] ) && ( $comment[ 'comment_type' ] != 'comment' )  ) {\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t\treturn $comment;\r\n\t}\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif ( get_result(simpleSessionGet(\"contacto\", \"\"),true) != false ) {\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n        return $comment;\r\n\t} else {\r\n\t\t// since 2.0.4\r\n\t\tif (function_exists('wp_die')) {\r\n\t\t\twp_die('<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __( PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ) );\r\n\t\t} else {\r\n\t\t\tdie('<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __( PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ));\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * PlusCaptcha adjustments for login, registration, lost password,... form\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_adjust_form() {\r\n\treturn '';\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha to login form\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_login_form() {\r\n\tglobal $PlusCaptcha_instance;\r\n\t//echo $PlusCaptcha_instance->get_html();\r\n\techo captcha_call();\r\n\treturn true;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha to registration form\r\n * @return boolean\r\n */\r\n /*\r\nfunction PlusCaptcha_registration_form() {\r\n\tglobal $PlusCaptcha_instance;\r\n\tif (!get_option('PlusCaptcha_form_registration')) {\r\n\t\treturn true;\r\n\t}\r\n\t//echo $PlusCaptcha_instance->get_html();\r\n  //echo PlusCaptcha_adjust_form();\r\n  \techo captcha_call();\r\n\treturn true;\r\n}\r\n*/\r\n\r\n/**\r\n * Add PlusCaptcha authetificate check\r\n * @param $user\r\n * @return WP_Error\r\n */\r\nfunction PlusCaptcha_authenticate($user) {\r\n\tglobal $PlusCaptcha_instance;\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif ( !empty( $_POST ) && get_result(simpleSessionGet(\"contacto\", \"\")) == false ) {\r\n\t\t$user = new WP_Error( 'captcha_wrong', '<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __( PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ) );\r\n\t}else{\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t}\r\n\treturn $user;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha lost password check\r\n * @param $user\r\n * @return mixed WP_Error or boolean\r\n */\r\nfunction PlusCaptcha_lost_password_check($user) {\r\n\tglobal $PlusCaptcha_instance;\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif ( get_result(simpleSessionGet(\"contacto\", \"\")) == false ) {\r\n\t\t$user = new WP_Error( 'captcha_wrong', '<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __(PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ) );\r\n\t\treturn $user;\r\n\t}else{\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t}\r\n\treturn TRUE;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha registration form check\r\n * @param $errors\r\n * @return WP_Errors\r\n */\r\n /*\r\nfunction PlusCaptcha_register_form_check($errors) {\r\n\tglobal $PlusCaptcha_instance;\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif ( get_result(simpleSessionGet(\"contacto\", \"\")) == false ) {\r\n\t\t$errors->add( 'captcha_wrong', '<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __(PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ) );\t\t\t\r\n\t}\r\n\treturn $errors;\r\n}\r\n*/\r\n\r\n/**\r\n * Add PlusCaptcha to BuddyPress registration form\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_before_registration_submit_buttons() {\r\n\tglobal $PlusCaptcha_instance;\r\n\techo \r\n    '<div id=\"PlusCaptcha-wrapper\">' \r\n    .( ( function_exists('PlusCaptcha_header') ) ? PlusCaptcha_header() : '' )\r\n    //. $PlusCaptcha_instance->get_html() \r\n\t. captcha_call()\r\n    . '</div>';\r\n\treturn TRUE;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha to BuddyPress registration form validation\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_signup_validate() {\r\n\tglobal $bp, $PlusCaptcha_instance;\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif ( get_result(simpleSessionGet(\"contacto\", \"\")) == false ) {\r\n\t\t$bp->signup->errors['signup_username'] = __(PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' );\r\n\t}else{\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t}\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha to Wordpress Network sign-up form \r\n * @param $errors\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_signup_extra_fields($errors) {\r\n\tglobal $PlusCaptcha_instance;\r\n\t$error = $errors->get_error_message( 'captcha_wrong' );\r\n\t//echo $PlusCaptcha_instance->get_html();\r\n\techo captcha_call();\r\n\tif ( isset($error) && !empty( $error ) ) {\r\n\t\techo '<p class=\"error\">' . $error . '</p>';\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha validation to Wordpress Network sign-up form\r\n * @param $errors\r\n * @return mixed\r\n */\r\nfunction PlusCaptcha_wpmu_validate_user_signup($errors) {\r\n\tglobal $PlusCaptcha_instance;\r\n\tif ( $_POST['stage'] == 'validate-user-signup' ) {\r\n\t\t//$scValues = PlusCaptcha_get_values();\r\n\t\tif ( get_result(simpleSessionGet(\"contacto\", \"\")) == false ) {\r\n\t\t\t$errors['errors']->add( 'captcha_wrong', '<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __(PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ) );\r\n\t\t}else{\r\n\t\t\t//$_SESSION[\"passport\"] = false;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\treturn $errors;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha short code\r\n * @param $atts\r\n * @return string\r\n */\r\nfunction PlusCaptcha_shortcode( $atts = array() ) {\r\n\tglobal $PlusCaptcha_instance;\r\n\treturn ( ( function_exists('PlusCaptcha_header') ) ? PlusCaptcha_header() : '' ).captcha_call(true);\r\n}\r\n\r\n/**\r\n * Validate PlusCaptcha form\r\n * @param $errors\r\n * @param $tag\r\n * @return mixed array\r\n */\r\nfunction PlusCaptcha_validate($errors, $tag = NULL) {\r\n\tglobal $PlusCaptcha_instance;\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif ( get_result(simpleSessionGet(\"contacto\", \"\")) != true ) \r\n\t{\r\n\t\tif ( !empty( $tag ) ) { // if Contact Form 7\r\n\t\t\t$errors['valid'] = false;\r\n\t\t\t$errors['reason']['your-message'] = __(PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' );\r\n\t\t} else {\r\n\t\t\t$errors['errors']->add( 'PlusCaptcha', '<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __(PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ) );\r\n\t\t}\r\n\t}else{\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t}\r\n\treturn $errors;\r\n}\r\n", "<?php\r\n\r\n# Clean\r\n# Limpiar data\r\nfunction tags($tags){  \r\n\t$tags = strip_tags($tags);  \r\n\t$tags = stripslashes($tags);  \r\n\t$tags = htmlentities($tags);\r\n\t$tags = addslashes($tags);\r\n\treturn trim($tags);  \r\n} \r\n\r\ntags($_REQUEST);\r\ntags($_POST);\r\ntags($_GET);\r\n\r\n// Display PlusCaptcha Contact Form in front end - page or post\r\nif (!function_exists('plscptf_display_form')) {\r\n\r\n  function plscptf_display_form() {\r\n    global $error_message, $plscptf_options, $result;\r\n    $plscptf_options = get_option('PlusCaptcha_form_contact_options');\r\n    $content = \"\";\r\n\r\n    $page_url = ( isset($_SERVER[\"HTTPS\"]) && $_SERVER[\"HTTPS\"] == \"on\" ? \"https://\" : \"http://\" ) . $_SERVER[\"SERVER_NAME\"] . $_SERVER[\"REQUEST_URI\"];\r\n    // If contact form submited\r\n    $name = isset($_REQUEST['plscptf_contact_name']) ? $_REQUEST['plscptf_contact_name'] : \"\";\r\n    $email = isset($_REQUEST['plscptf_contact_email']) ? $_REQUEST['plscptf_contact_email'] : \"\";\r\n    $subject = isset($_REQUEST['plscptf_contact_subject']) ? $_REQUEST['plscptf_contact_subject'] : \"\";\r\n    $message = isset($_REQUEST['plscptf_contact_message']) ? $_REQUEST['plscptf_contact_message'] : \"\";\r\n    $send_copy = isset($_REQUEST['plscptf_contact_send_copy']) ? $_REQUEST['plscptf_contact_send_copy'] : \"\";\r\n    // If it is good\r\n    if (true === $result) {\r\n      $_SESSION['plscptf_send_mail'] = true;\r\n      if ($plscptf_options['plscptf_action_after_send'] == 1)\r\n        $content .= $plscptf_options['plscptf_thank_text'];\r\n      else\r\n        $content .= \"<script type='text/javascript'>window.location.href = '\" . $plscptf_options['plscptf_redirect_url'] . \"';</script>\";\r\n    }\r\n    else if (false === $result) {\r\n      // If email not be delivered\r\n      $error_message['error_form'] = __(\"Sorry, your e-mail could not be delivered.\", 'PlusCaptcha');\r\n    } else {\r\n      $_SESSION['plscptf_send_mail'] = false;\r\n      // Output form\r\n      $content .= '<form method=\"post\" id=\"plscptf_contact_form\" action=\"' . $page_url . '\" enctype=\"multipart/form-data\">';\r\n      if (isset($error_message['error_form'])) {\r\n        $content .= '<div class=\"error-form\">' . $error_message['error_form'] . '</div>';\r\n      }\r\n      $content .= '<div class=\"input-label\">\r\n\t\t\t\t\t<label for=\"plscptf_contact_name\">' . $plscptf_options['plscptf_name_label'] . '<span class=\"required\"> *</span></label>\r\n\t\t\t\t</div>';\r\n      if (isset($error_message['error_name'])) {\r\n        $content .= '<div class=\"error-form\">' . $error_message['error_name'] . '</div>';\r\n      }\r\n      $content .= '<div class=\"input\">\r\n\t\t\t\t\t<input class=\"text\" type=\"text\" size=\"40\" value=\"' . $name . '\" name=\"plscptf_contact_name\" id=\"plscptf_contact_name\" />\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"input-label\">\r\n\t\t\t\t\t<label for=\"plscptf_contact_email\">' . $plscptf_options['plscptf_email_label'] . '<span class=\"required\"> *</span></label>\r\n\t\t\t\t</div>';\r\n      if (isset($error_message['error_email'])) {\r\n        $content .= '<div class=\"error-form\">' . $error_message['error_email'] . '</div>';\r\n      }\r\n      $content .= '<div class=\"input\">\r\n\t\t\t\t\t<input class=\"text\" type=\"text\" size=\"40\" value=\"' . $email . '\" name=\"plscptf_contact_email\" id=\"plscptf_contact_email\" />\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"input-label\">\r\n\t\t\t\t\t<label for=\"plscptf_contact_subject\">' . $plscptf_options['plscptf_subject_label'] . '<span class=\"required\"> *</span></label>\r\n\t\t\t\t</div>';\r\n      if (isset($error_message['error_subject'])) {\r\n        $content .= '<div class=\"error-form\">' . $error_message['error_subject'] . '</div>';\r\n      }\r\n      $content .= '<div class=\"input\">\r\n\t\t\t\t\t<input class=\"text\" type=\"text\" size=\"40\" value=\"' . $subject . '\" name=\"plscptf_contact_subject\" id=\"plscptf_contact_subject\" />\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"input-label\">\r\n\t\t\t\t\t<label for=\"plscptf_contact_message\">' . $plscptf_options['plscptf_message_label'] . '<span class=\"required\"> *</span></label>\r\n\t\t\t\t</div>';\r\n      if (isset($error_message['error_message'])) {\r\n        $content .= '<div class=\"error-form\">' . $error_message['error_message'] . '</div>';\r\n      }\r\n      $content .= '<div class=\"input\">\r\n\t\t\t\t\t<textarea rows=\"5\" cols=\"30\" name=\"plscptf_contact_message\" id=\"plscptf_contact_message\">' . $message . '</textarea>\r\n\t\t\t\t</div>';\r\n      if (isset($error_message['error_captcha'])) {\r\n        $content .= '<div class=\"error-form\">' . $error_message['error_captcha'] . '</div>';\r\n      }\r\n\r\n      $content .= PlusCaptcha_shortcode();\r\n\r\n      if ($plscptf_options['plscptf_send_copy'] == 1) {\r\n        $content .= '<div style=\"text-align: left;\">\r\n\t\t\t\t\t\t<input type=\"checkbox\" value=\"1\" name=\"plscptf_contact_send_copy\" id=\"plscptf_contact_send_copy\" style=\"text-align: left; margin: 0;\" ' . ( $send_copy == '1' ? \" checked=\\\"checked\\\" \" : \"\" ) . ' />\r\n\t\t\t\t\t\t<label for=\"plscptf_contact_send_copy\">' . __(\"Send me a copy\", 'PlusCaptcha') . '</label>\r\n\t\t\t\t\t</div>';\r\n      }\r\n\r\n      $content .= '<div style=\"text-align: left; padding-top: 8px;\">\r\n\t\t\t\t\t<input type=\"hidden\" value=\"send\" name=\"plscptf_contact_action\"><input type=\"hidden\" value=\"Version: 3.13\" />\r\n\t\t\t\t\t<input type=\"submit\" value=\"' . __(\"Submit\", 'PlusCaptcha') . '\" style=\"cursor: pointer; margin: 0pt; text-align: center;margin-bottom:10px;\" /> \r\n\t\t\t\t</div>\r\n\t\t\t\t</form>';\r\n    }\r\n    return $content;\r\n  }\r\n\r\n}\r\n//**********************************************************************************************************************\r\nif (!function_exists('plscptf_check_and_send')) {\r\n\r\n  function plscptf_check_and_send() {\r\n    //die ('plscptf_check_and_send'); \r\n    global $result;\r\n    $plscptf_options = get_option('PlusCaptcha_form_contact_options');\r\n    if (isset($_REQUEST['plscptf_contact_action'])) {\r\n      // Check all input data\r\n      $result = plscptf_check_form();\r\n    }\r\n    if (true === $result) { // OK\r\n      $_SESSION['plscptf_send_mail'] = true;\r\n      if ($plscptf_options['plscptf_action_after_send'] == 0) {\r\n        wp_redirect($plscptf_options['plscptf_redirect_url']);\r\n        exit;\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n// Check PlusCaptcha Contact Form input data\r\nif (!function_exists('plscptf_check_form')) {\r\n\r\n  function plscptf_check_form() {\r\n    global $error_message;\r\n    global $plscptf_options;\r\n    if (empty($plscptf_options))\r\n      $plscptf_options = get_option('PlusCaptcha_form_contact_options');\r\n    $result = \"\";\r\n    // Error messages array\r\n    $error_message = array();\r\n    $error_message['error_name'] = __(\"Please input your name.\", 'PlusCaptcha');\r\n    $error_message['error_email'] = __(\"Please input your e-mail address.\", 'PlusCaptcha');\r\n    $error_message['error_subject'] = __(\"Subject required.\", 'PlusCaptcha');\r\n    $error_message['error_message'] = __(\"Message text required.\", 'PlusCaptcha');\r\n    $error_message['error_form'] = __(\"Please correct your input data below and try again.\", 'PlusCaptcha');\r\n    // Check information\r\n    if (\"\" != $_REQUEST['plscptf_contact_name'])\r\n      unset($error_message['error_name']);\r\n    if (\"\" != $_REQUEST['plscptf_contact_email'] && preg_match(\"/^(?:[a-z0-9]+(?:[a-z0-9\\-_\\.]+)?@[a-z0-9]+(?:[a-z0-9\\-\\.]+)?\\.[a-z]{2,5})$/i\", trim($_REQUEST['plscptf_contact_email'])))\r\n      unset($error_message['error_email']);\r\n    if (\"\" != $_REQUEST['plscptf_contact_subject'])\r\n      unset($error_message['error_subject']);\r\n    if (\"\" != $_REQUEST['plscptf_contact_message'])\r\n      unset($error_message['error_message']);\r\n    \r\n    PlusCaptcha_validate_contact_form($error_message);\r\n\r\n    if (1 == count($error_message)) { // OK\r\n      unset($error_message['error_form']);\r\n      $result = plscptf_send_mail();\r\n    }\r\n\r\n    return $result;\r\n  }\r\n\r\n}\r\n\r\n// Send mail function\r\nif (!function_exists('plscptf_send_mail')) {\r\n\r\n  function plscptf_send_mail() {\r\n    global $plscptf_options, $path_of_uploaded_file;\r\n    $to = \"\";\r\n    if (isset($_SESSION['plscptf_send_mail']) && $_SESSION['plscptf_send_mail'] == true)\r\n      return true;\r\n    if ($plscptf_options['plscptf_select_email'] == 'user') {\r\n      if (function_exists('get_userdatabylogin') && false !== $user = get_userdatabylogin($plscptf_options['plscptf_user_email'])) {\r\n        $to = $user->user_email;\r\n      } else if (false !== $user = get_user_by('login', $plscptf_options_submit['plscptf_user_email']))\r\n        $to = $user->user_email;\r\n    }\r\n    else {\r\n      $to = $plscptf_options['plscptf_custom_email'];\r\n    }\r\n    if (\"\" == $to) {\r\n      // If email options are not certain choose admin email\r\n      $to = get_option(\"admin_email\");\r\n    }\r\n    if (\"\" != $to) {\r\n      // subject\r\n      $subject = $_REQUEST['plscptf_contact_subject'];\r\n      $user_info_string = '';\r\n      $userdomain = '';\r\n      $form_action_url = '';\r\n      $attachments = array();\r\n      $headers = \"\";\r\n\r\n      if (getenv('HTTPS') == 'on') {\r\n        $form_action_url = 'https://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];\r\n      } else {\r\n        $form_action_url = 'http://' . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];\r\n      }\r\n\r\n      if ($plscptf_options['plscptf_display_add_info'] == 1) {\r\n        $userdomain = gethostbyaddr($_SERVER['REMOTE_ADDR']);\r\n        if ($plscptf_options['plscptf_display_add_info'] == 1 ||\r\n                $plscptf_options['plscptf_display_sent_from'] == 1 ||\r\n                $plscptf_options['plscptf_display_coming_from'] == 1 ||\r\n                $plscptf_options['plscptf_display_user_agent'] == 1) {\r\n          $user_info_string .= '<tr>\r\n\t\t\t\t\t\t\t<td><br /></td><td><br /></td>\r\n\t\t\t\t\t\t</tr>';\r\n        }\r\n        if ($plscptf_options['plscptf_display_sent_from'] == 1) {\r\n          $user_info_string .= '<tr>\r\n\t\t\t\t\t\t\t<td>' . __('Sent from (ip address)', 'PlusCaptcha') . ':</td><td>' . $_SERVER['REMOTE_ADDR'] . \" ( \" . $userdomain . \" )\" . '</td>\r\n\t\t\t\t\t\t</tr>';\r\n        }\r\n        if ($plscptf_options['plscptf_display_date_time'] == 1) {\r\n          $user_info_string .= '<tr>\r\n\t\t\t\t\t\t\t<td>' . __('Date/Time', 'PlusCaptcha') . ':</td><td>' . date_i18n(get_option('date_format') . ' ' . get_option('time_format'), strtotime(current_time('mysql'))) . '</td>\r\n\t\t\t\t\t\t</tr>';\r\n        }\r\n        if ($plscptf_options['plscptf_display_coming_from'] == 1) {\r\n          $user_info_string .= '<tr>\r\n\t\t\t\t\t\t\t<td>' . __('Coming from (referer)', 'PlusCaptcha') . ':</td><td>' . $form_action_url . '</td>\r\n\t\t\t\t\t\t</tr>';\r\n        }\r\n        if ($plscptf_options['plscptf_display_user_agent'] == 1) {\r\n          $user_info_string .= '<tr>\r\n\t\t\t\t\t\t\t<td>' . __('Using (user agent)', 'PlusCaptcha') . ':</td><td>' . plscptf_clean_input($_SERVER['HTTP_USER_AGENT']) . '</td>\r\n\t\t\t\t\t\t</tr>';\r\n        }\r\n      }\r\n      // message\r\n      $message = '\r\n\t\t\t<html>\r\n\t\t\t<head>\r\n\t\t\t\t<title>' . __(\"Contact from\", 'PlusCaptcha') . get_bloginfo('name') . '</title>\r\n\t\t\t</head>\r\n\t\t\t<body>\r\n\t\t\t\t<table>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td width=\"160\">' . __(\"Name\", 'PlusCaptcha') . '</td><td>' . $_REQUEST['plscptf_contact_name'] . '</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>' . __(\"Email\", 'PlusCaptcha') . '</td><td>' . $_REQUEST['plscptf_contact_email'] . '</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>' . __(\"Subject\", 'PlusCaptcha') . '</td><td>' . $_REQUEST['plscptf_contact_subject'] . '</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>' . __(\"Message\", 'PlusCaptcha') . '</td><td>' . $_REQUEST['plscptf_contact_message'] . '</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>' . __(\"Site\", 'PlusCaptcha') . '</td><td>' . get_bloginfo(\"url\") . '</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td><br /></td><td><br /></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t' . $user_info_string . '\r\n\t\t\t\t</table>\r\n\t\t\t</body>\r\n\t\t\t</html>\r\n\t\t\t';\r\n      if ($plscptf_options['plscptf_mail_method'] == 'wp-mail') {\r\n        // To send HTML mail, the Content-type header must be set\r\n        $headers = 'MIME-Version: 1.0' . \"\\r\\n\";\r\n        $headers .= 'Content-type: text/html; charset=utf-8' . \"\\r\\n\";\r\n\r\n        // Additional headers\r\n        $headers .= 'From: ' . $_REQUEST['plscptf_contact_email'] . \"\\r\\n\";\r\n        if (isset($_REQUEST['plscptf_contact_send_copy']) && $_REQUEST['plscptf_contact_send_copy'] == 1)\r\n          wp_mail($_REQUEST['plscptf_contact_email'], stripslashes($subject), stripslashes($message), $headers, $attachments);\r\n\r\n        // Mail it\r\n        return wp_mail($to, stripslashes($subject), stripslashes($message), $headers, $attachments);\r\n      }\r\n      else {\r\n        // HTML e-mail, we should set Content-type header\r\n        $headers = 'MIME-Version: 1.0' . \"\\r\\n\";\r\n        $headers .= 'Content-type: text/html; charset=utf-8' . \"\\r\\n\";\r\n\r\n        // Additional headers\r\n        $headers .= 'From: ' . $_REQUEST['plscptf_contact_email'] . \"\\r\\n\";\r\n        if (isset($_REQUEST['plscptf_contact_send_copy']) && $_REQUEST['plscptf_contact_send_copy'] == 1)\r\n          @mail($_REQUEST['plscptf_contact_email'], stripslashes($subject), stripslashes($message), $headers);\r\n\r\n        return @mail($to, stripslashes($subject), stripslashes($message), $headers);\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n}\r\n\r\nfunction plscptf_clean_input($string, $preserve_space = 0) {\r\n  if (is_string($string)) {\r\n    if ($preserve_space) {\r\n      return plscptf_sanitize_string(strip_tags(stripslashes($string)), $preserve_space);\r\n    }\r\n    return trim(plscptf_sanitize_string(strip_tags(stripslashes($string))));\r\n  } else if (is_array($string)) {\r\n    reset($string);\r\n    while (list($key, $value ) = each($string)) {\r\n      $string[$key] = plscptf_clean_input($value, $preserve_space);\r\n    }\r\n    return $string;\r\n  } else {\r\n    return $string;\r\n  }\r\n}\r\n\r\n// protect and validate form vars\r\n\r\nfunction plscptf_sanitize_string($string, $preserve_space = 0) {\r\n  if (!$preserve_space)\r\n    $string = preg_replace(\"/ +/\", ' ', trim($string));\r\n\r\n  return preg_replace(\"/[<>]/\", '_', $string);\r\n}\r\n\r\nfunction plscptf_email_name_filter($data) {\r\n  global $plscptf_options;\r\n  if (isset($plscptf_options['plscptf_from_field']) && trim($plscptf_options['plscptf_from_field']) != \"\")\r\n    return stripslashes($plscptf_options['plscptf_from_field']);\r\n  else\r\n    return $data;\r\n}\r\n\r\nfunction PlusCaptcha_validate_contact_form(&$errors) {\r\n\tglobal $PlusCaptcha_instance;\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif (get_result(simpleSessionGet(\"contacto_shortcode\", \"\"),true) != true ) {\r\n   \t\t$errors['error_captcha'] = '<strong>'.__( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __(PlusCaptcha_ERROR_MESSAGE_BR, 'PlusCaptcha' );\r\n\t}else{\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t}\r\n\treturn $errors;\r\n}\r\n\r\nadd_shortcode('im_helping_with_ecoplus', 'plscptf_display_form');\r\nadd_action('init', 'plscptf_check_and_send');\r\nadd_filter('wp_mail_from_name', 'plscptf_email_name_filter', 10, 1);\r\n\r\n?>", "=== PlusCaptcha ===\r\nContributors: PlusCaptcha\r\nVersion: 2.0.6\r\nTags: pluscaptcha, captcha, antispam, comment, catcha, registration, match captcha, lost password, login, spam, images captcha, capcha, captha, ecology, ecoplus, plus, buddypress, contact form 7, sweetcaptcha, text captcha, multilingual, register, admin, ajax, image, images, keycaptcha, plugin, post, akismet, wpmu, re captcha, recaptcha, wordpress captcha, picture captcha\r\nRequires at least: 3.0.0\r\nTested up to: 4.0.0\r\nStable tag: trunk\r\n\r\nPlusCaptcha - Forget the spam, ugly and complicated captchas! The Easiest Captcha to Setup and Execute, with Auto-Setup Feature! TRUSTED BY +27 THOUSAND OF WEBSITES, BLOGS, E-COMMERCE AND GOVERNMENT SITES AROUND WORLD WIDE! Free Full Service with 24/7 emergency support (emergency@pluscaptcha.com) with continuously updates!\r\n\r\n== Description ==\r\n\r\nThe first dinamic captcha provider. **Art to your visitors, simple tool to you!**\r\n\r\nAn evolution of the protection from bots and people without good intentions. Simple to install, simple to use, security at a click distance!\r\n\r\n= Features =\r\n\r\n**Mega Update!**:\r\n* New Easy to Read Dashboard!\r\n* Meet and Discover other Bloggers (and promote your)\r\n* Cleanest Interface\r\n* Cleanest Captcha\r\n\r\n* Simple to setup.\r\n* **NO MORE** maths, read words, colors, etc!\r\n* Automatic account generation **(NEW!)**.\r\n* Size, color, difficulty personalization.\r\n* No instructions needed to setup and operate **(NEW!)**.\r\n* Low bounce percentage.\r\n* Weekly upgrades.\r\n\r\n= Popular Browsers Support =\r\n\r\n* **IE** - IE6+\r\n* **Firefox** - All versions\r\n* **Chrome** - All versions\r\n* **Safari** - All versions\r\n* **Opera** - All versions\r\n* **Android (NEW!)** - All versions\r\n* **Mobile Safari (NEW!)** - All versions\r\n\r\n= Other Browsers Support (NEW!) =\r\n\r\n* AOL\r\n* **BlackBerry (NEW!)**\r\n* Camino\r\n* Dillo\r\n* Konqueror\r\n* Lynx\r\n* Mozilla\r\n* Netscape\r\n* Seamonkey\r\n* Shiira\r\n\r\n= Contact Options =\r\n\r\n* **General Info / Questions** - info[at]pluscaptcha.com\r\n* **Support / Bug** - support[at]pluscaptcha.com\r\n* **Emergency (24/7)** - emergency[at]pluscaptcha.com\r\n\r\n= Now you be part of Thousand Webmasters and Bloggers who Promote Ecology! =\r\n\r\nPlusCaptcha apart of be a CAPTCHA provider it's an conscientization tool. It's the biggest tool of concientization of the world. Imagine this: every webmaster when setup PlusCaptcha is helping with **EcoPlus** (name of the ecology project), every person who see the nature image becomes aware about the little and fragile world where we live.\r\n\r\n**Now, do you can see the Powerfull Tool what is PlusCaptcha?**\r\n\r\n= Because it's Simple from Every Point of View =\r\n\r\nSimple to install and use, and the most simple way to help the ecology.\r\n**Just download, activate and it's ready to use** but, if you wanna you can too personalize your account with: **color, size, difficulty and other options!**\r\n\r\n= Because is One Solution For All Devices =\r\n\r\n1. HTML5, to devices who support it.\r\n2. JQuery (Javascript), for a little percent of old browsers.\r\n3. Mail Validation, to all other browsers like of low-cost phones.\r\n\r\n= Because is Fully Integrated with WordPress =\r\n\r\n1. Integrated Form (with shortcode)\r\n2. Comment form\r\n3. Login form\r\n4. Lost password form\r\n\r\n= Because is the Evolution of the old and insecure CAPTCHAS. =\r\n\r\nThe **\"blind strip\" (unique technology from PlusCaptcha)** able us to provide the unique CAPTCHA immunity from bots.\r\n\r\n= Because is Free by 10 Years =\r\n\r\nWhen your free period expire in 10 years you will able to pay as you want, like a donation. **If not, no problem!** We will provide the same amazing service to you like the first day.\r\n\r\n= Because we have two big targets =\r\n\r\n1. Work together with your help to **save the ecology**.\r\n2. Be the most secure and armony CAPTCHA provider of the world.\r\n\r\n= Hey! You can help too! =\r\n\r\nHelp to us translating our website and able to share the oportunity to setup PlusCaptcha in another countries and thats will help to us with our ecology project and meet new developers and communities. Just contact us to: support[at]pluscaptcha.com\r\n\r\n== Installation ==\r\n\r\n1. Download the PlusCaptcha plugin or install it directly from your dashboard (just search \"PlusCaptcha\").\r\n\r\n2. Install and activate the plugin.\r\n\r\n3. Go to PlusCaptcha settings (under \"Settings\").\r\n\r\nAt this point, **your account was created automatically (NEW FEATURE!) and you don't need to do more!**, if not, you can do it with next steps:\r\n\r\n4. Create a New Account at www.pluscaptcha.com\r\n\r\n5. Paste the UUID (code by 9 characters).\r\n\r\n6. Save the Settings and Enjoy!\r\n\r\n**Remember (NEW FEATURE!): if your account was created automatically, you can personalize it with the user and password provided in the PlusCaptcha Settings Control Panel.**\r\n\r\n== Screenshots ==\r\n\r\n1. PlusCaptcha Dashboard Settings.\r\n2. PlusCaptcha in action!\r\n3. Customize your captcha!\r\n4. UUID Code Page!\r\n5. Advance Contact Form Setup\r\n\r\n== Requirements ==\r\n\r\n* Wordpress more than 2.8\r\n* Outside connection hosting by fopen().\r\n\r\n== Changelog ==\r\n\r\n= 2.0.6 =\r\n* Fixed security things reported by security.szurek.pl, Thanks!\r\n\r\n= 2.0.5 =\r\n* Padding footer fixed.\r\n* Padding form fixed.\r\n* Multiply themes audit.\r\nCredits: Mistakes reported to emergency@pluscaptcha.com (Thank to Claude @ NorwoodTeaParty.com)\r\n\r\n= 2.0.4 =\r\n* .Wrap and .W contextual style fixed.\r\n\r\n= 2.0.3 =\r\n* .Wrap color fixed.\r\n\r\n= 2.0.2 =\r\n* Provided more margin and change structure of comment form.\r\n* Fixed color letters in comment form.\r\n\r\n= 2.0.1 =\r\n* Fixed mistake provided by feedback to emergency@pluscaptcha.com (Thank to Claude @ NorwoodTeaParty.com)\r\n\r\n= 2.0.0 =\r\n* New Easy to Read Dashboard!\r\n* Meet and Discover other Bloggers (and promote your)\r\n* Cleanest Interface\r\n* Cleanest Captcha\r\n\r\n= 1.2.1 =\r\n* Default Hided Link\r\n\r\n= 1.2.0 =\r\n* Little Plugin Size Reduction.\r\n\r\n= 1.1.2 =\r\n* New: News section was added.\r\n\r\n= 1.1.1 =\r\n* New: List of Browsers Supported and New Features.\r\n* Edited information about the plugin.\r\n\r\n= 1.1 =\r\n* New: System to automatically PlusCaptcha account creation.\r\n* Fix: UTF-8 bug.\r\n\r\n= 1.0 =\r\n* Release version.\r\n* Do not forget feedback to support[at]pluscaptcha.com.\r\n\r\n== Upgrade Notice ==\r\n\r\n= 2.0.6 =\r\n* Fixed security things reported by security.szurek.pl, Thanks!\r\n\r\n= 1.2.1 =\r\nDefault Hide Backlin to Maintaining Good Aesthetics\r\n\r\n= 1.2.0 =\r\nLittle Plugin Size Reduction.\r\n\r\n= 1.1.2 =\r\nNews section was added.\r\n\r\n= 1.1.1 =\r\nList of browsers supported and new features.\r\n\r\n= 1.1 =\r\nImportant bug fixed.", "<!-- Additional options in admin PlusCaptcha Settings -->\r\n<?php \r\nglobal $error, $wpdb; \r\n$userslogin = $wpdb->get_col(\"SELECT user_login FROM  $wpdb->users \", 0);\r\n?>\r\n<script type=\"text/javascript\">\r\n\tjQuery(document).ready(function(){\r\n\t\tjQuery('#plscptf_additions_options').change( function() {\r\n\t\t\tif(jQuery(this).is(':checked') )\r\n\t\t\t\tjQuery('.plscptf_additions_block').removeClass('plscptf_hidden');\r\n\t\t\telse\r\n\t\t\t\tjQuery('.plscptf_additions_block').addClass('plscptf_hidden');\r\n\t\t});\r\n\t\tjQuery('#plscptf_change_label').change( function() {\r\n\t\t\tif(jQuery(this).is(':checked') )\r\n\t\t\t\tjQuery('.plscptf_change_label_block').removeClass('plscptf_hidden');\r\n\t\t\telse\r\n\t\t\t\tjQuery('.plscptf_change_label_block').addClass('plscptf_hidden');\r\n\t\t});\r\n\t\tjQuery('#plscptf_display_add_info').change( function() {\r\n\t\t\tif(jQuery(this).is(':checked') )\r\n\t\t\t\tjQuery('.plscptf_display_add_info_block').removeClass('plscptf_hidden');\r\n\t\t\telse\r\n\t\t\t\tjQuery('.plscptf_display_add_info_block').addClass('plscptf_hidden');\r\n\t\t});\r\n\t});\r\n</script>\r\n<div class=\"wrap\" style=\"padding-top: none;\" id=\"PlusCaptcha_form_contact_options\" style=\"<?php echo $display_cfoptions;?>\">\r\n  <div class=\"error\" style=\"width:99%; float: left; <?php if (empty($error)) echo 'display:none'; ?>\" ><p><strong><?php echo $error; ?></strong></p></div>\r\n  <br>\r\n  <table class=\"form-table\">\r\n    <tr valign=\"top\">\r\n      <th scope=\"row\" style=\"width:195px; color: white; text-shadow: none;\"><?php _e(\"Use email of wordpress user:\", 'PlusCaptcha'); ?> </th>\r\n      <td style=\"width:15px;\">\r\n        <input type=\"radio\" id=\"plscptf_select_email_user\" name=\"plscptf_select_email\" value=\"user\" <?php if ($plscptf_options['plscptf_select_email'] == 'user') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n      <td>\r\n        <select name=\"plscptf_user_email\" style=\"width:130px;\">\r\n          <option disabled><?php _e(\"Select user name\", 'PlusCaptcha'); ?></option>\r\n          <?php while (list( $key, $value ) = each($userslogin)) { ?>\r\n            <option value=\"<?php echo $value; ?>\" \r\n              <?php if ($plscptf_options['plscptf_user_email'] == $value) echo \"selected=\\\"selected\\\" \"; ?>><?php echo $value; ?>\r\n            </option>\r\n          <?php } ?>\r\n        </select>\r\n        <span class=\"plscptf_info\" style=\"font-family: sans-serif; font-size: 12px; font-style: italic; color: white; display: table; padding-left: 20px;\"><?php _e(\"Set a name of user who will get messages from a contact form.\", 'PlusCaptcha'); ?></span>\r\n      </td>\r\n    </tr>\r\n    <tr valign=\"top\">\r\n      <th scope=\"row\" style=\"color: white; text-shadow: none;\"><?php _e(\"Use this email:\", 'PlusCaptcha'); ?> </th>\r\n      <td>\r\n        <input type=\"radio\" id=\"plscptf_select_email_custom\" name=\"plscptf_select_email\" value=\"custom\" <?php if ($plscptf_options['plscptf_select_email'] == 'custom') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n      <td>\r\n        <input type=\"text\" name=\"plscptf_custom_email\" value=\"<?php echo $plscptf_options['plscptf_custom_email']; ?>\" onfocus=\"document.getElementById('plscptf_select_email_custom').checked = true;\" />\r\n        <span class=\"plscptf_info\" style=\"font-family: sans-serif; font-size: 12px; font-style: italic; color: white; display: table; padding-left: 20px;\"><?php _e(\"Set an email address which will be used for messages receiving.\", 'PlusCaptcha'); ?></span>\r\n      </td>\r\n    </tr>\r\n    <tr valign=\"top\">\r\n      <th colspan=\"3\" scope=\"row\" style=\"background-color: #DFDFE0; margin-top: 20px; display: block;\"><input type=\"checkbox\" id=\"plscptf_additions_options\" name=\"plscptf_additions_options\" style=\"margin-right: 30px;\"  value=\"1\" <?php if ($plscptf_options['plscptf_additions_options'] == '1') echo \"checked=\\\"checked\\\" \"; ?> /> <?php _e(\"Additional options\", 'PlusCaptcha'); ?></th>\r\n    </tr>\r\n\t\r\n</table> \r\n\r\n<table style=\"background-color: white; width: 100%; margin-top: 10px; color: #666666;\" class=\"plscptf_additions_block plscptf_hidden\"> \r\n\r\n\t\r\n\r\n    <tr valign=\"top\" class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <th scope=\"row\"><?php _e(\"Display Send me a copy block\", 'PlusCaptcha'); ?></th>\r\n      <td colspan=\"2\">\r\n        <input type=\"checkbox\" id=\"plscptf_send_copy\" name=\"plscptf_send_copy\" value=\"1\" <?php if ($plscptf_options['plscptf_send_copy'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n    </tr>\r\n    <tr class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <th rowspan=\"2\"><?php _e('What use?', 'PlusCaptcha'); ?></th>\r\n      <td>\r\n        <input type='radio' name='plscptf_mail_method' value='wp-mail' <?php if ($plscptf_options['plscptf_mail_method'] == 'wp-mail') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n      <td>\r\n        <?php _e('Wp-mail', 'mail-send'); ?> \r\n        <span  class=\"plscptf_info\">(<?php _e('To send mail you can use the wordpress wp_mail function', 'mail_send'); ?>)</span>\r\n      </td>\r\n    </tr>\r\n    <tr class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <td>\r\n        <input type='radio' name='plscptf_mail_method' value='mail' <?php if ($plscptf_options['plscptf_mail_method'] == 'mail') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n      <td>\r\n        <?php _e('Mail', 'mail-send'); ?> \r\n        <span  class=\"plscptf_info\">(<?php _e('To send mail you can use the php mail function', 'mail_send'); ?>)</span>\r\n      </td>\r\n    </tr>\r\n    <tr valign=\"top\" class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <th scope=\"row\"><?php _e(\"Change FROM fields of the contact form\", 'PlusCaptcha'); ?></th>\r\n      <td colspan=\"2\">\r\n        <input type=\"text\" style=\"width:200px;\" name=\"plscptf_from_field\" value=\"<?php echo stripslashes($plscptf_options['plscptf_from_field']); ?>\" /><br />\r\n      </td>\r\n    </tr>\r\n    <tr valign=\"top\" class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <th scope=\"row\"><?php _e(\"Display additional info in email\", 'PlusCaptcha'); ?></th>\r\n      <td>\r\n        <input type=\"checkbox\" id=\"plscptf_display_add_info\" name=\"plscptf_display_add_info\" value=\"1\" <?php if ($plscptf_options['plscptf_display_add_info'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n      <td class=\"plscptf_display_add_info_block <?php if ($plscptf_options['plscptf_display_add_info'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n        <input type=\"checkbox\" id=\"plscptf_display_sent_from\" name=\"plscptf_display_sent_from\" value=\"1\" <?php if ($plscptf_options['plscptf_display_sent_from'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/> <span style=\"margin-left: 10px;\" class=\"plscptf_info\"><?php _e(\"Sent from (ip address)\", 'PlusCaptcha'); ?></span><br />\r\n        <input type=\"checkbox\" id=\"plscptf_display_date_time\" name=\"plscptf_display_date_time\" value=\"1\" <?php if ($plscptf_options['plscptf_display_date_time'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/> <span style=\"margin-left: 10px;\" class=\"plscptf_info\"><?php _e(\"Date/Time\", 'PlusCaptcha'); ?></span><br />\r\n        <input type=\"checkbox\" id=\"plscptf_display_coming_from\" name=\"plscptf_display_coming_from\" value=\"1\" <?php if ($plscptf_options['plscptf_display_coming_from'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/> <span style=\"margin-left: 10px;\" class=\"plscptf_info\"><?php _e(\"Coming from (referer)\", 'PlusCaptcha'); ?></span><br />\r\n        <input type=\"checkbox\" id=\"plscptf_display_user_agent\" name=\"plscptf_display_user_agent\" value=\"1\" <?php if ($plscptf_options['plscptf_display_user_agent'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/> <span style=\"margin-left: 10px;\" class=\"plscptf_info\"><?php _e(\"Using (user agent)\", 'PlusCaptcha'); ?></span><br />\r\n      </td>\r\n    </tr>\r\n    <tr valign=\"top\" class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <th scope=\"row\"><?php _e(\"Change label for fields of the contact form\", 'PlusCaptcha'); ?></th>\r\n      <td>\r\n        <input type=\"checkbox\" id=\"plscptf_change_label\" name=\"plscptf_change_label\" value=\"1\" <?php if ($plscptf_options['plscptf_change_label'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n      <td class=\"plscptf_change_label_block <?php if ($plscptf_options['plscptf_change_label'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n        <div style=\"width: 200px;\">\r\n\t\t\t<input type=\"text\" name=\"plscptf_name_label\" value=\"<?php echo $plscptf_options['plscptf_name_label']; ?>\" style=\"float: right;\" /> <span class=\"plscptf_info\"><?php _e(\"Name:\", 'PlusCaptcha'); ?></span>\r\n\t\t</div>\r\n\t\t<br />\r\n        <div style=\"width: 200px;\">\r\n\t\t\t<input type=\"text\" name=\"plscptf_email_label\" value=\"<?php echo $plscptf_options['plscptf_email_label']; ?>\" style=\"float: right;\" /> <span class=\"plscptf_info\"><?php _e(\"E-Mail Address:\", 'PlusCaptcha'); ?></span>\r\n\t\t</div>\r\n\t\t<br />\r\n        <div style=\"width: 200px;\">\r\n\t\t<input type=\"text\" name=\"plscptf_subject_label\" value=\"<?php echo $plscptf_options['plscptf_subject_label']; ?>\" style=\"float: right;\" /> <span class=\"plscptf_info\"><?php _e(\"Subject:\", 'PlusCaptcha'); ?></span>\r\n\t\t</div>\r\n\t\t<br />\r\n        <div style=\"width: 200px;\">\r\n\t\t<input type=\"text\" name=\"plscptf_message_label\" value=\"<?php echo $plscptf_options['plscptf_message_label']; ?>\" style=\"float: right;\" /> <span class=\"plscptf_info\"><?php _e(\"Message:\", 'PlusCaptcha'); ?></span>\r\n\t\t</div>\r\n      </td>\r\n    </tr>\r\n    <tr valign=\"top\" class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <th scope=\"row\"><?php _e(\"Action after the send mail\", 'PlusCaptcha'); ?></th>\r\n      <td colspan=\"2\" class=\"plscptf_action_after_send_block\">\r\n\t  \r\n\t  \t<div>\r\n        <input style=\"float: left;\" type=\"radio\" id=\"plscptf_action_after_send\" name=\"plscptf_action_after_send\" value=\"1\" <?php if ($plscptf_options['plscptf_action_after_send'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/> <span class=\"plscptf_info\"><?php _e(\"Display text\", 'PlusCaptcha'); ?></span>\r\n        <input style=\"margin-left: 20px; margin-right: 10px;\" type=\"text\" name=\"plscptf_thank_text\" value=\"<?php echo $plscptf_options['plscptf_thank_text']; ?>\" /> <span class=\"plscptf_info\"><?php _e(\"Text\", 'PlusCaptcha'); ?></span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<br />\r\n\t\t\r\n\t\t<div>\r\n        <input style=\"float: left;\"  type=\"radio\" id=\"plscptf_action_after_send\" name=\"plscptf_action_after_send\" value=\"0\" <?php if ($plscptf_options['plscptf_action_after_send'] == '0') echo \"checked=\\\"checked\\\" \"; ?>/> <span class=\"plscptf_info\"><?php _e(\"Redirect to page\", 'PlusCaptcha'); ?></span>\r\n        <input style=\"margin-left: 20px; margin-right: 10px;\" type=\"text\" name=\"plscptf_redirect_url\" value=\"<?php echo $plscptf_options['plscptf_redirect_url']; ?>\" /> <span class=\"plscptf_info\"><?php _e(\"Url\", 'PlusCaptcha'); ?></span><br />\r\n\t\t</div>\r\n\t\t\r\n      </td>\r\n\t  \r\n\t  \r\n\t  \r\n  </table>    \r\n</div>\r\n", "<?php\r\n\r\n$status = @fgets(@fopen(\"http://www.pluscaptcha.com/status/\", 'r'), 4096);\r\n\r\n/**\r\n* Guardar data del blog para mejorar la experiencia\r\n**/\r\n\r\nif( get_option('PlusCaptcha_feedback_quemejoraria', '') != get_option('actual_PlusCaptcha_feedback_quemejoraria', '') )\r\n{\r\n\t// Enviar feedback\r\n\t$url = 'http://www.pluscaptcha.com/api/wp_log/feedback?'\r\n\t\t.'quemejorar='.substr(str_replace(\".\",\"[dot]\",urlencode($_POST[\"PlusCaptcha_feedback_quemejoraria\"])),0,299).\r\n\t\t'&uuid='.get_option( 'uuid_api_wp_feedback' ).'';\r\n\t\t@fgets(@fopen($url, 'r'), 4096);\r\n\t// Guardar Feedback en forma local\r\n\tupdate_option('actual_PlusCaptcha_feedback_quemejoraria', get_option('PlusCaptcha_feedback_quemejoraria', ''));\r\n}\r\n\r\n\r\n?>\r\n\r\n<?php\r\nif( $message != \"\" && $status || strlen(get_option('uuid_key_speci_to_generate_captchas', '')) < 9 && $status ) \r\n{\r\n?>\r\n\t<script  type=\"text/javascript\">\r\n\t  jQuery(document).ready(function($) {\r\n\t\t$('#ShortData').hide('fast');\r\n\t  });\r\n\t</script>\r\n<?php\r\n}else{\r\n?>\r\n\t<script  type=\"text/javascript\">\r\n\t  jQuery(document).ready(function($) {\r\n\t\t$('#Advance').hide();\r\n\t  });\r\n\t</script>\r\n<?php\r\n}\r\n?>\r\n\r\n<div class=\"w_private\">\r\n\t<div class=\"wrap_private\" style=\"padding-top: 30px; margin-top: 20px;\">\r\n\t\t\r\n\t\t<style type=\"text/css\">\r\n\t\t.ShortData .Data {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 431px;\r\n\t\t\t/**/\r\n\t\t\toverflow: display;\r\n\t\t}\r\n\t\t.ShortData .Data h1 {\r\n\t\t\tfont-family: Arial;\r\n\t\t\tfont-size: 44px;\r\n\t\t\tfont-weight: bold;\r\n\t\t\t/**/\r\n\t\t\twidth: 100%;\r\n\t\t\ttext-align: center;\r\n\t\t\t/**/\r\n\t\t\theight: 50px;\r\n\t\t\tline-height: 50px;\r\n\t\t\t/**/\r\n\t\t\tcolor: white;\r\n\t\t\t/**/\r\n\t\t\tmargin: 0px;\r\n\t\t\tmargin-top: 10px; /*rewrite*/\r\n\t\t}\r\n\t\t.ShortData .Data h3 {\r\n\t\t\tfont-family: Arial;\r\n\t\t\tfont-size: 14px;\r\n\t\t\tfont-weight: bold;\r\n\t\t\t/**/\r\n\t\t\twidth: 100%;\r\n\t\t\ttext-align: center;\r\n\t\t\t/**/\r\n\t\t\theight: 20px;\r\n\t\t\tline-height: 20px;\r\n\t\t\t/**/\r\n\t\t\tcolor: white;\r\n\t\t\t/**/\r\n\t\t\tmargin: 0px;\r\n\t\t}\r\n\t\t.ShortData .BoxSites{\r\n\t\t\twidth: 90%;\r\n\t\t\tmargin-left: 5%;\r\n\t\t\tmargin-right: 5%;\r\n\t\t\t/**/\r\n\t\t\theight: 200px;\r\n\t\t\t/**/\r\n\t\t\tmargin-top: 40px;\r\n\t\t\tmargin-bottom: 20px;\r\n\t\t\t/**/\r\n\t\t\tborder-top: 1px solid white;\r\n\t\t\tborder-bottom: 1px solid white;\r\n\t\t\t/**/\r\n\t\t\toverflow: display;\r\n\t\t}\r\n\t\t.ShortData .BoxSites a{\r\n\t\t\tcolor: #5AD1F3;\r\n\t\t\r\n\t\t}\r\n\t\t.ShortData .BoxSites a:hover{\r\n\t\t\ttext-decoration: underline;\r\n\t\t\tcolor: #0f9ec7;\r\n\t\t}\r\n\t\t.300 {\r\n\t\t\twidth: 300px; \r\n\t\t\tmargin: auto; \r\n\t\t}\r\n\t\t.ShortData .BoxMore{\r\n\t\t\twidth: 90%;\r\n\t\t\tmargin-left: 5%;\r\n\t\t\tmargin-right: 5%;\r\n\t\t\t/**/\r\n\t\t\theight: 110px;\r\n\t\t\t/**/\r\n\t\t\tmargin-top: 20px;\r\n\t\t\tmargin-bottom: 20px;\r\n\t\t\t/**/\r\n\t\t}\r\n\t\t.ShortData .BoxMore .BoxBtn{\r\n\t\t\twidth: 50%;\r\n\t\t\theight: 110px;\r\n\t\t\t/**/\r\n\t\t\tfloat: left;\r\n\t\t}\r\n\t\t.ShortData .BoxMore .BoxBtn a{\r\n\t\t\twidth: 80%;\r\n\t\t\tmargin: 30px 10% 30px 10%;\r\n\t\t\t/**/\r\n\t\t\theight: 60px;\r\n\t\t\tline-height: 60px;\r\n\t\t\t/**/\r\n\t\t\tbackground: #009cff;\r\n\t\t\t/**/\r\n\t\t\tfont-family: Arial;\r\n\t\t\tfont-size: 18px;\r\n\t\t\tfont-weight: bold;\r\n\t\t\tcolor: white;\r\n\t\t\ttext-decoration: none;\r\n\t\t\t/**/\r\n\t\t\ttext-align: center;\r\n\t\t\t/**/\r\n\t\t\tdisplay: block;\r\n\t\t\t/**/\r\n\t\t\tcursor: pointer;\r\n\t\t}\r\n\t\t.ShortData .BoxMore .BoxBtn a:hover{\r\n\t\t\tbackground: #008ce5;\r\n\t\t}\r\n\t\t</style>\r\n\t\t\r\n\t\t<div id=\"ShortData\" class=\"ShortData\">\r\n\t\t\t<?php\r\n\t\t\tif($status) {\r\n\t\t\t?>\r\n\t\t\t\t<div class=\"LogoRun\"></div>\r\n\t\t\t<?php }else{ ?>\r\n\t\t\t\t<div class=\"LogoPaused\"></div>\r\n\t\t\t<?php } ?>\r\n\t\t\t<div class=\"Data\">\r\n\t\t\t\t<h1><?php echo ($status) ? 'SERVICE IS RUNNING' : 'IN BRIEF MAINTENANCE'; ?></h1>\r\n\t\t\t\t<h3><?php echo ($status) ? 'CHECK YOUR COMMENT FORM' : 'PLEASE COME BACK IN 30 MINUTES'; ?></h3>\r\n\t\t\t\t<div class=\"BoxSites\" style=\"text-align: center;\">\r\n\t\t\t\t\t<h3 class=\"300\" style=\"width: 370px; margin: auto; margin-top: -10px; background: #00609b; display: table;\">WHO TRUST IN PLUSCAPTCHA TOO? (BY RANDOM)</h3>\r\n\t\t\t\t\t<?php\r\n\t\t\t\t\t\techo @fgets(@fopen(\"http://www.pluscaptcha.com/api/wp_log/who_use_plugin.php\", 'r'), 4096);\t\t\t\t\t\r\n\t\t\t\t\t?>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"BoxMore\">\r\n\t\t\t\t\t<div class=\"BoxBtn\">\r\n\t\t\t\t\t\t<?php if($status) { ?>\r\n\t\t\t\t\t\t\t<a onclick=\"jQuery(document).ready(function($) { \r\n\t\t\t\t\t\t\t\t$('#ShortData').hide('fast'); \r\n\t\t\t\t\t\t\t\t$('#Advance').show('slow');\r\n\t\t\t\t\t\t\t});\">Advance Options</a>\r\n\t\t\t\t\t\t<?php }else{ ?>\r\n\t\t\t\t\t\t\t<a style=\"background-color:#999999; cursor: auto;\">In Mantenience</a>\r\n\t\t\t\t\t\t<?php } ?>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"BoxBtn\" style=\"text-align: right;\">\r\n\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t<strong>Information</strong> - info@pluscaptcha.com<br />\r\n\t\t\t\t\t\t\t<strong>Support</strong> - support@pluscaptcha.com<br />\r\n\t\t\t\t\t\t\t<strong>In case of Emergency (24/7)</strong><br />\r\n\t\t\t\t\t\t\temergency@pluscaptcha.com\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\r\n\t\t<div id=\"Advance\">\r\n\t\t\r\n\t\t\t<!--\r\n\t\t\t<div style=\"margin-bottom: 30px;\">\r\n\t\t\t\t<div class=\"icon32 icon32-bws\" id=\"icon-options-PlusCaptcha\"></div>\r\n\t\t\t\t<h2 style=\"height: 100%; padding-left: 200px; padding-top: 20px; line-height: 40px; text-shadow: none; color: white;\"><?php _e('At a turn of the best security.', 'PlusCaptcha'); ?></h2>\r\n\t\t\t</div>\r\n\t\t\t-->\r\n\t\t\t\r\n\t\t  <?php if (!empty($message)): ?>\r\n\t\t\t<div class=\"updated\" style=\"width:91%; float: left; background-color: #FFFF99; padding-top: 30px; padding-bottom: 30px; color: #393939; border: none; padding-left: 10%; margin-left: 0px; margin-bottom: 20px; display: table;\">\r\n\t\t\t  <p><strong><?php echo $message; ?></strong></p>\r\n\t\t\t</div>\r\n\t\t\t<br />\r\n\t\t  <?php endif; ?>\r\n\t\t\t\r\n\t\t\t<div class=\"informacion\">\r\n\t\t\t\t<p style=\"margin-top: 5px; \"><?php _e('Congratulations on your new PlusCaptcha!', 'PlusCaptcha'); ?></p>\r\n\t\t\t\t<p>Translate this panel to other languajes: <a>Not available in other languages by this moment!</a></p>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t\r\n\t\t<?php\r\n\t\tif(\r\n\t\t\tget_option( 'uuid_api_wp_feedback' ) != \"\" && \r\n\t\t\tget_option( 'registered_account_from_api' ) == true && \r\n\t\t\tget_option( 'pluscaptcha_account_user' ) != \"\" && \r\n\t\t\tget_option( 'pluscaptcha_account_password' ) != \"\"\r\n\t\t)\r\n\t\t{\r\n\t\t?>\r\n\t\t  <!-- Box Personalice -->\r\n\t\t  <div id=\"personalizacion\">\r\n\t\t\t<div id=\"right-content-pers\">\r\n\t\t\t\t<span>\r\n\t\t\t\t\tPersonalize your account logging to \r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<a href=\"http://en.pluscaptcha.com/login\" target=\"_blank\"><strong style=\"border: 0px;\">en.pluscaptcha.com/login</strong></a> with this mail:\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<strong><?php echo get_option( 'pluscaptcha_account_user' ); ?></strong>\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\tand this password:\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<strong><?php echo get_option( 'pluscaptcha_account_password' ); ?></strong> \r\n\t\t\t\t</span>\r\n\t\t\t\t<br />\r\n\t\t\t\t<span style=\"font-size: 12px; line-height: normal; margin-top: 10px; display: table;\">\r\n\t\t\t\t\t(this account was generated automatically for you!,\r\n\t\t\t\t\t<br>\r\n\t\t\t\t\twhen you finish, just update your ID of 9 Characters and it's ready!)\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t  </div>\t  \r\n\t\t  <!-- --->\t \r\n\t\t  \r\n\t\t  <?php }elseif( get_option( 'registered_account_from_api' ) != true && get_option('uuid_key_speci_to_generate_captchas', '') == \"\" ){ ?> \r\n\t\t  \r\n\t\t  <!-- Box Instrucciones -->\r\n\t\t  <div id=\"boxinstructions\">\r\n\t\t\t<div style=\"width: 960px; height: 115px; display: table;\">\r\n\t\t\t\t<div style=\"float: left; font-family: Arial; color: #666666; font-size: 14px; margin-left: 238px; margin-top: 47px;\">\r\n\t\t\t\t\ten\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style=\"float: left; font-family: Arial; color: white; font-size: 14px; margin-left: 435px; margin-top: 45px;\">\r\n\t\t\t\t\tNew Account\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<style type=\"text/css\">\r\n\t\t\t\t.ecoplus {\r\n\t\t\t\t\tcolor: #82c7ff;\r\n\t\t\t\t\ttext-decoration: none;\r\n\t\t\t\t}\r\n\t\t\t\t.ecoplus:hover {\r\n\t\t\t\t\tcolor: #249dff;\r\n\t\t\t\t}\r\n\t\t\t</style>\r\n\t\t\t<div style=\"width: 960px; height: 115px;\">\r\n\t\t\t\t<div style=\"float: left; font-family: Arial; color: white; font-size: 35px; font-weight: bold; margin-left: 600px; margin-top: 45px;\">\r\n\t\t\t\t\tEnjoy of <a class=\"ecoplus\" href=\"http://blog.pluscaptcha.com/un-plus-humano/\" target=\"_blank\">EcoPlus</a>!\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t  </div>\r\n\t\t  <!-- --->\r\n\t\t  \r\n\t\t  <?php } ?>\r\n\t\t\r\n\t\t  <form name=\"form1\" method=\"post\" action=\"\">\r\n\t\t\t<input type=\"hidden\" name=\"<?php echo $hidden_field_name; ?>\" value=\"Y\">\r\n\t\t\t<table class=\"form-table\">\r\n\t\t\t  <tbody>\r\n\t\t\t\t<?php\r\n\t\t\t\tif (!empty($PlusCaptcha_options) && is_array($PlusCaptcha_options)):\r\n\t\t\t\t  foreach ($PlusCaptcha_options as $opt_name => $opt):\r\n\t\t\t\t?>\r\n\t\t\t\t<tr valign=\"top\">\r\n\t\t\t\t  <th scope=\"row\" style=\"min-width: 15%\"><label style=\"color: white;\" for=\"<?php echo $opt_name ?>\"><?php echo $opt['title'] . ':'; ?></label></th>\r\n\t\t\t\t  <?php\r\n\t\t\t\t\tif (!substr_count($opt_name, '_form_')) {\r\n\t\t\t\t\t  $type = 'text';\r\n\t\t\t\t\t  $checked = null;\r\n\t\t\t\t\t  $class = ' class=\"regular-text\"';\r\n\t\t\t\t\t  $value = isset($options_values[$opt_name]) ? $options_values[$opt_name] : null;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t  $type = 'checkbox';\r\n\t\t\t\t\t  $checked = isset($options_values[$opt_name]) && !empty($options_values[$opt_name]) ? ' checked=\"checked\"' : null;\r\n\t\t\t\t\t  $class = null;\r\n\t\t\t\t\t  $value = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t  ?>\r\n\t\t\t\t  <td>\r\n\t\t\t\t\t<input<?php echo $class ?> id=\"<?php echo $opt_name ?>\" type=\"<?php echo $type ?>\" name=\"<?php echo $opt_name ?>\" value=\"<?php echo $value ?>\" size=\"50\"<?php echo $checked ?>  \r\n\t\t\t\t\t<?php echo $opt['maxchars']; ?> <? \r\n\t\t\t\t\tif($opt['disabled']){ \r\n\t\t\t\t\t\techo 'checked=\"checked\" disabled'; \r\n\t\t\t\t\t}else{ \r\n\t\t\t\t\t\techo '/'; // Noquitar\r\n\t\t\t\t\t}\r\n\t\t\t\t\t?>>\r\n\t\t\t\t\t<?php if (isset($PlusCaptcha_options[$opt_name]['description'])): ?>\r\n\t\t\t\t\t<span class=\"description\">\r\n\t\t\t\t\t<?php echo $PlusCaptcha_options[$opt_name]['description']; ?>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<?php endif; ?>\r\n\t\t\t\t  </td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t\r\n\t\t\t\t<?php if ($opt_name == 'PlusCaptcha_form_contact') { ?>\r\n\t\t\t\t<tr>\r\n\t\t\t\t  <td colspan=\"2\" style=\"padding-top: 0px; padding-left: 20px;\">\r\n\t\t\t\t  <?php\r\n\t\t\t\t  $display_cfoptions = ''; //( $checked ) ? '' : 'display:none;';\r\n\t\t\t\t  include 'admin-options-contactform.php';\r\n\t\t\t\t  ?>\r\n\t\t\t\t  </td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<?php } ?>\r\n\t\t\t\t\r\n\t\t\t\t<?php\r\n\t\t\t\t  endforeach;\r\n\t\t\t\tendif;\r\n\t\t\t\t?>\r\n\t\t\t  </tbody>\r\n\t\t\t</table>\r\n\t\t\t\r\n\t\t\t<style type=\"text/css\">\r\n\t\t\t\ta {\r\n\t\t\t\t\ttext-decoration: none;\r\n\t\t\t\t}\r\n\t\t\t\ta:focus {\r\n\t\t\t\t\ttext-decoration: none;\r\n\t\t\t\t\tcolor: #2980c7;\r\n\t\t\t\t}\r\n\t\t\t\ta:hover, a:active {\r\n\t\t\t\t\ttext-decoration: none;\r\n\t\t\t\t\tcolor: #005da8;\r\n\t\t\t\t}\r\n\t\t\t</style>\r\n\t\t\r\n\t\t\t<p class=\"submit\" style=\"margin-top: 10px;\">\r\n\t\t\t  <input type=\"submit\" name=\"Submit\" class=\"button-primary\" value=\"<?php esc_attr_e('Save Changes') ?>\" />\r\n\t\t\t</p>\r\n\t\t\t<p style=\"margin-top: 30px; padding-top: 10px; border-top: 1px dashed white; display: block;\">\r\n\t\t\t  <strong>If you have a translate suggestion or another, please <a href=\"http://en.pluscaptcha.com/contacto\" target=\"_blank\">contact us.</a></strong>\r\n\t\t\t</p>\r\n\t\t  </form>\r\n\t\t  </div>\r\n\t</div>\r\n</div>", "<style type=\"text/css\">\r\n#register_message {\r\n\tmargin-bottom: 10px;\r\n}\r\n\r\n#register_explanation {\r\n\tmargin-top: 10px;\r\n}\r\n\r\n#register table {\r\n\tborder-collapse: collapse;\r\n\twidth: 100%;\r\n}\r\n\r\n#register table td.left {\r\n\ttext-transform: capitalize;\r\n\tpadding-left: 10px;\r\n\ttext-align: left;\r\n\twidth: 160px;\r\n\t/*min-width: 25%;*/\r\n}\r\n\r\n#register table td.right {\r\n\ttext-align: left;\r\n\tpadding: 8px 10px;\r\n}\r\n\r\n#register input[type=text] {\r\n\twidth: 300px;\r\n}\r\n\r\n#register select {\r\n\twidth: 300px;\r\n}\r\n\r\n</style>\r\n<script type=\"text/javascript\">\r\njQuery(document).ready(function() {\r\n  jQuery('#register_submit').click(function () {\r\n  \t\tjQuery(\"form#register .error\").remove();\r\n    \tvar hasError = false;\r\n      jQuery(\".requiredField\").each(function() {\r\n  \t\t\tif(jQuery.trim(jQuery(this).val()) == '') {\r\n          if ( jQuery(this).attr('name') == 'site_category' ) {\r\n            jQuery(this).after('<span class=\"error\">Please choose something and then press `Continue`</span>');\r\n          } else {\r\n            jQuery(this).after('<span class=\"error\">*</span>');\r\n          }\r\n        \thasError = true;\r\n  \t\t\t} else \r\n        if ( jQuery(this).attr('name') == 'email' ) {\r\n    \t\t\tvar emailReg = /^([\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4})?$/;\r\n      \t\tif ( ! emailReg.test(jQuery.trim(jQuery(this).val())) ) {\r\n        \t\tjQuery(this).after('<span class=\"error\">You entered an invalid email</span>');\r\n  \t\t\t\t\thasError = true;\r\n    \t\t\t}\r\n      \t}\r\n      });\r\n      if ( ! hasError ) {\r\n        jQuery('form#register').submit();\r\n      }\r\n  });\r\n});\r\n\r\n</script>\r\n<div class=\"wrap\">\r\n\t<h2><?php _e( 'Register to PlusCaptcha', 'PlusCaptcha' ); ?></h2>\r\n\r\n\t<?php echo $form_html; ?>\r\n\r\n\t<p class=\"submit\">\r\n\t\t<input type=\"button\" id=\"register_submit\" name=\"Submit\" class=\"button-primary\" value=\"<?php esc_attr_e('Continue') ?>\" />\r\n\t\t&nbsp;or <a href=\"options-general.php?page=PlusCaptcha&skip_register=1\">skip</a> if you are already registered.\r\n\t</p>\r\n</div>\r\n"], "fixing_code": ["<?php\r\n/*\r\nPlugin Name: PlusCaptcha\r\nPlugin URI: http://www.pluscaptcha.com/\r\nDescription: The Easiest Captcha to Setup and Execute, with Auto-Setup Feature! Forget ugly and complicated captchas! Unique! <strong>TRUSTED BY +27 THOUSAND OF WEBSITES, BLOGS, E-COMMERCE AND GOVERNMENT SITES AROUND WORLD WIDE!</strong> Free Full Service with <strong>24/7 emergency support</strong> ( <a href=\"mailto:emergency@pluscaptcha.com\">emergency@pluscaptcha.com</a> ) plus, with continuously updates and support! Questions? <a href=\"http://www.pluscaptcha.com/contacto\">contact us!</a>\r\nVersion: 2.0.14\r\nAuthor: PlusCaptcha\r\nAuthor URI: http://www.pluscaptcha.com/\r\nLicense: GNU GPL2\r\n*/\r\n/*\r\nCopyright (c) 2014 PlusCaptcha. (www.pluscaptcha.com). All rights reserved.\r\n\r\nThis program is free software; you can redistribute it and/or\r\nmodify it under the terms of the GNU General Public License,\r\nversion 2, as published by the Free Software Foundation.\r\n\r\nThis program is distributed in the hope that it will be useful,\r\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\r\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\nGNU General Public License for more details.\r\n\r\nYou should have received a copy of the GNU General Public License\r\nalong with this program; if not, write to the Free Software\r\nFoundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\r\n*/\r\n/*\r\n\tFor Irina Luchinetz & Igor Borovskoy. I'm not sure about if I could finish this project without their support. My infinite thanks to them! Thanks for make this dream possible, I know about you couldn't help to me like you would like, but this untidy house with infinite love is all I need, all everyone needs...\r\n\t\t- Denis, CEO PlusCaptcha\r\n*/\r\n\r\nif (!function_exists('tags')) {\r\n\t# Clean\r\n\t# Limpiar data\r\n\tfunction tags($tags){  \r\n\t\t$tags = strip_tags($tags);  \r\n\t\t$tags = stripslashes($tags);  \r\n\t\t$tags = htmlentities($tags);\r\n\t\t$tags = addslashes($tags);\r\n\t\treturn trim($tags);  \r\n\t}\r\n}\r\n\r\n/* Ocultar errores */\r\nrequire_once(ABSPATH . 'wp-settings.php');\r\nerror_reporting(0);\r\n/* *************** */\r\n\r\ndefine('PlusCaptcha_SITE_URL', 'http://www.pluscaptcha.com/');\r\n// for backward compatibility - 2.0\r\ndefined('WP_PLUGIN_DIR') or define('WP_PLUGIN_DIR', ABSPATH . '/wp-content/plugins');\r\n\r\n// define absolute path to plugin\r\ndefine('PlusCaptcha_DIR_NAME', basename( dirname(__FILE__) ));\r\ndefine('PlusCaptcha_ROOT', WP_PLUGIN_DIR . '/' . PlusCaptcha_DIR_NAME);\r\ndefine('PlusCaptcha_URL', WP_PLUGIN_URL . '/' . PlusCaptcha_DIR_NAME);\r\n// define absolute path to plugin  PlusCaptcha.php\r\ndefine('PlusCaptcha_PHP_PATH', PlusCaptcha_URL . '/library/PlusCaptcha.php');\r\n// define absolute path to plugin library\r\ndefine('PlusCaptcha_LIBRARY', PlusCaptcha_ROOT . '/library');\r\n// define absolute path to plugin templates\r\ndefine('PlusCaptcha_TEMPLATE', PlusCaptcha_ROOT . '/template');\r\ndefine('PlusCaptcha_ERROR_MESSAGE', 'The solution of task you submitted was incorrect. Please read the instruction and try again.');\r\ndefine('PlusCaptcha_ERROR_MESSAGE_BR', 'The solution of task you submitted was incorrect.<br>Please read the instruction and try again.');\r\n\r\n\r\n/*\r\n********************** External Plugin Used ***********************\r\n*/\r\n\r\n\t/*\r\n\t Thanks to Sweetcaptcha project to help to us with EcoPlus! Fight for the nature!\r\n\t Basecode Was Used.\r\n\t*/\r\n\t/*\r\n\t Thanks to Comment Form Inline Errors @ latorante! (Edited Code)\r\n\t*/\r\n\tinclude dirname(__FILE__) . '/external/comment-form-inline-errors.php';\r\n\t/*\r\n\t Thanks to Simple Session Support @ Peter Wooster! (Editen Code)\r\n\t*/\r\n\tinclude dirname(__FILE__) . '/external/simple-session-support.php';\r\n\t\r\n\t\r\n/*\r\n********************** ******************** ***********************\r\n*/\r\n\r\n\r\n// prepare wordpress version for check\r\n$wp_versions = explode( '.', $wp_version );\r\n\r\nadd_action('init', 'PlusCaptcha_init', 10);\r\nfunction PlusCaptcha_init() {\r\n  //global $wpdb;\r\n  wp_enqueue_script('jquery');\r\n   wp_enqueue_script('jquery-ui-core', false, array('jquery'));\r\n  wp_enqueue_script('jquery-ui-draggable', false, array('jquery'));\r\n  wp_enqueue_script('jquery-ui-droppable', false, array('jquery'));\r\n  wp_enqueue_script( 'plscptf', plugins_url( 'js/plscptf.js', __FILE__ ) );\r\n}\r\n\r\n\t// No more PlusCaptcha.php, directly code:\r\n\t\r\n\t// in case this is called like standalone script - we need wordpress functions available\r\n\tif ( ! function_exists( 'get_option' ) ) {\r\n\t\t// absolute path to wp installation root\r\n\t\t$wordpress_path = realpath ( dirname ( __FILE__ ) . '/../../../' );\r\n\t\trequire_once $wordpress_path . '/wp-load.php';\r\n\t}\r\n\t\r\n\tsession_start();\r\n\t\r\n\t\r\nwp_enqueue_style( 'PlusCaptcha_Stylesheet', plugins_url( 'css/style.css', __FILE__ ) ); // TODO\r\n// split action to admin and public part\r\nif (is_admin()) {\r\n\trequire_once PlusCaptcha_LIBRARY . '/admin.php';\r\n\t// Add admin notices.\r\n\tadd_action('admin_menu', 'PlusCaptcha_admin_menu');\r\n\t\r\n\t// because various problems with register activation hook trough Wordpress versions - check if Sweet Captcha is installed, otherwise set default values\r\n\tadd_action('admin_menu', 'PlusCaptcha_activate');\r\n\tadd_action('admin_menu', 'Generate_New_Account');\r\n\t\r\n\t// add uninstall hook -> remove option values - only for wordpress version >= 2.7\r\n\tif ( ( $wp_versions[ 0 ] >=2 ) && ( $wp_versions[ 1 ] >= 7 ) ) {\r\n\t\tregister_uninstall_hook( __FILE__, 'PlusCaptcha_uninstall' );\r\n\t}\r\n  \r\n} else {\r\n\trequire_once PlusCaptcha_LIBRARY . '/public.php';\r\n\t// add jquery to all public pages\r\n\t//add_action( 'login_head' , 'PlusCaptcha_login_head' );\r\n  //wp_enqueue_script( 'jquery' );\r\n\r\n  // add Sweet Captcha to comment form\r\n\tif ( get_option( 'PlusCaptcha_form_comment' ) ) {\r\n\t\tadd_action( 'comment_form', 'PlusCaptcha_comment_form', 1 );\r\n\t\tadd_filter( 'preprocess_comment', 'PlusCaptcha_comment_form_check', 1 );\r\n\t}\r\n\t\r\n\t// add Sweet Captcha to login form\r\n\tif ( get_option( 'PlusCaptcha_form_login' ) ) {\r\n    // only for version >= 2.8\r\n\t\tif ( ( ( $wp_versions[ 0 ] >= 2 ) || ( $wp_versions[ 1 ] > 7 ) ) ) {\r\n\t\t\tadd_action( 'login_form', 'PlusCaptcha_login_form', 1 );\r\n\t\t\tadd_filter( 'authenticate', 'PlusCaptcha_authenticate', 40, 3 );\r\n\t\t}\r\n    // add PlusCaptcha to BuddyPress login form\r\n    add_action( 'bp_sidebar_login_form', 'PlusCaptcha_login_form' );\r\n\t}\r\n\t\r\n\t// add Sweet Captcha to lost password form\r\n\tif ( get_option( 'PlusCaptcha_form_lost' ) ) {\r\n\t\tadd_action( 'lostpassword_form', 'PlusCaptcha_login_form', 1 );\r\n\t\tadd_filter( 'allow_password_reset', 'PlusCaptcha_lost_password_check', 1 );\r\n\t}\r\n\t\r\n}\r\n\r\n// PlusCaptcha Contact Form \r\nif ( get_option( 'PlusCaptcha_form_contact' ) ) {\r\n  require_once 'library/shortcode-and-others.php';\r\n}", "<?php\r\n\r\nif (!defined('ABSPATH')) { exit; }\r\n\r\nif (!class_exists('wpCommentFormInlineErrors')){\r\n    class wpCommentFormInlineErrors\r\n    {\r\n\r\n        public function __construct() { add_action('init', array($this, 'init')); }\r\n\r\n        /**\r\n         * Hook me up, buttercup\r\n         */\r\n\r\n        public function init()\r\n        {\r\n            session_start();\r\n            /* all these hooks are in wp since version 3.0, that's where we aim. */\r\n            add_filter('wp_die_handler', array($this, 'getWpDieHandler'));\r\n            add_action('comment_form_before_fields', array($this, 'displayFormError'));\r\n            add_action('comment_form_logged_in_after', array($this, 'displayFormError'));\r\n            add_filter('comment_form_default_fields',array($this, 'formDefaults'));\r\n            add_filter('comment_form_field_comment',array($this, 'formCommentDefault'));\r\n        }\r\n\r\n        /**\r\n         * Admin error helper\r\n         *\r\n         * @param $error\r\n         */\r\n\r\n        private function displayAdminError($error) { echo '<div id=\"message\" class=\"error\"><p><strong>' . $error . '</strong></p></div>';  }\r\n\r\n\r\n        function getWpDieHandler($handler){ return array($this, 'handleWpError'); }\r\n\r\n\r\n        /**\r\n         * Now this sounds great does it not? :) After refresh, we can\r\n         * display that message. Easy peasy my man. Of course, only if\r\n         * it's not admin error.\r\n         *\r\n         * @param $message\r\n         * @param string $title\r\n         * @param array $args\r\n         */\r\n\r\n        function handleWpError($message, $title='', $args=array())\r\n        {\r\n            if(!is_admin() && tags(!empty($_POST['comment_post_ID'])) && tags(is_numeric($_POST['comment_post_ID']))){\r\n                $_SESSION['formError'] = $message;\r\n                $denied = array('submit', 'comment_post_ID', 'comment_parent');\r\n                foreach($_POST as $key => $value){\r\n                    if(!in_array($key, $denied)){\r\n                        $_SESSION['formFields'][$key] = stripslashes($value);\r\n                    }\r\n                }\r\n                session_write_close();\r\n                wp_safe_redirect(get_permalink(tags($_POST['comment_post_ID'])) . '#formError', 302);\r\n                exit;\r\n            } else {\r\n                _default_wp_die_handler($message, $title, $args);\r\n            }\r\n        }\r\n\r\n\r\n        /**\r\n         * Display inline form error.\r\n         */\r\n\r\n        public function displayFormError()\r\n        {\r\n            $formError = $_SESSION['formError'];\r\n            unset($_SESSION['formError']);\r\n            if(!empty($formError)){\r\n                echo '<div id=\"formError\" class=\"formError\" style=\"color:red;\">';\r\n                echo '<p>'. $formError .'</p>';\r\n                echo '</div><div class=\"clear clearfix\"></div>';\r\n            }\r\n        }\r\n\r\n\r\n        /**\r\n         * Reset form defaults to value sent, it's nice when form remebers\r\n         * stuff and doesn't force you to fill in shit again and again.\r\n         *\r\n         * @param $fields\r\n         * @return mixed\r\n         */\r\n\r\n        function formDefaults($fields)\r\n        {\r\n            $formFields = $_SESSION['formFields'];\r\n            foreach($fields as $key => $field){\r\n                if($this->stringContains('input', $field)){\r\n                    if($this->stringContains('type=\"text\"', $field)){\r\n                        $fields[$key] = str_replace('value=\"\"', 'value=\"'. stripslashes($formFields[$key]) .'\"', $field);\r\n                    }\r\n                } elseif ($this->stringContains('</textarea>', $field)){\r\n                    $fields[$key] = str_replace('</textarea>', stripslashes($formFields[$key]) .'</textarea>', $field);\r\n                }\r\n            }\r\n            return $fields;\r\n        }\r\n\r\n\r\n        /**\r\n         * Of course comment field is special :) needs special\r\n         * hook for defaults.\r\n         *\r\n         * @param $comment_field\r\n         * @return mixed\r\n         */\r\n\r\n        function formCommentDefault($comment_field)\r\n        {\r\n            $formFields = $_SESSION['formFields'];\r\n            unset($_SESSION['formFields']);\r\n            return str_replace('</textarea>', $formFields['comment'] . '</textarea>', $comment_field);\r\n        }\r\n\r\n\r\n        /**\r\n         * Just little helper for filling the form again.\r\n         *\r\n         * @param $haystack\r\n         * @param $needle\r\n         * @return bool\r\n         */\r\n\r\n        public function stringContains($needle, $haystack){ return strpos($haystack, $needle) !== FALSE; }\r\n\r\n    }\r\n\r\n}\r\n\r\nnew wpCommentFormInlineErrors();", "<?php\r\n\r\nif (!function_exists('tags')) {\r\n\t# Clean\r\n\t# Limpiar data\r\n\tfunction tags($tags){  \r\n\t\t$tags = strip_tags($tags);  \r\n\t\t$tags = stripslashes($tags);  \r\n\t\t$tags = htmlentities($tags);\r\n\t\t$tags = addslashes($tags);\r\n\t\treturn trim($tags);  \r\n\t}\r\n}\r\n\r\ntags($_REQUEST);\r\ntags($_POST);\r\ntags($_GET);\r\n\r\n// settings definiiton\r\n$PlusCaptcha_options = array(\r\n    'uuid_key_speci_to_generate_captchas' => array(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'title' => __('ID of 9 Characters', 'PlusCaptcha'), \r\n\t\t\t\t\t\t\t\t\t\t\t\t'description' => __('Get ID (UUID) registering on www.pluscaptcha.com and customizing your captcha!', 'PlusCaptcha'),\r\n\t\t\t\t\t\t\t\t\t\t\t\t'maxchars' => __('maxlength=\"9\"')\r\n\t\t\t\t\t\t\t\t\t\t\t),\r\n    'background_color_inside_iframe' => array(\r\n\t\t\t\t\t\t\t\t\t\t\t\t'title' => __('Background Color Inside Iframe', 'PlusCaptcha'), \r\n\t\t\t\t\t\t\t\t\t\t\t\t'description' => __('Set none or the color code without hashtag, ex: ffa3c8, ffd5a3'),\r\n\t\t\t\t\t\t\t\t\t\t\t\t'maxchars' => __('maxlength=\"6\"')\r\n\t\t\t\t\t\t\t\t\t\t\t),\r\n    //'PlusCaptcha_key' => array('title' => __('PlusCaptcha Key', 'PlusCaptcha'), 'description' => __('Insert PlusCaptcha Key', 'PlusCaptcha')),\r\n    //'PlusCaptcha_secret' => array('title' => __('PlusCaptcha Secret', 'PlusCaptcha'), 'description' => __('Insert PlusCaptcha Secret', 'PlusCaptcha')),\r\n//    'PlusCaptcha_public_url'\t\t\t=> array('title' => __('PlusCaptcha Public URL', 'PlusCaptcha'), 'description' => __('Default values is \"/wp-content/plugins/PlusCaptcha/library/PlusCaptcha.php\" - don\\'t change it unless you know what are you doing.', 'PlusCaptcha')),\r\n    'PlusCaptcha_form_comment' => array('title' => __('Captcha in Comment Form', 'PlusCaptcha')),\r\n    //'PlusCaptcha_form_registration' => array('title' => __('Captcha in Register Form', 'PlusCaptcha')),\r\n    'PlusCaptcha_form_lost' => array('title' => __('Captcha in Password Recovery of Login', 'PlusCaptcha')),\r\n    'PlusCaptcha_form_login' => array('title' => __('Captcha in Login Form', 'PlusCaptcha')),\r\n\t    'PlusCaptcha_form_omit_users' => array('title' => __('Hide Captcha to Logged Users', 'PlusCaptcha')),\r\n\t    //'PlusCaptcha_form_omit_backlink' => array('title' => __('Hide Backlink', 'PlusCaptcha'), 'description' => __('If you hide the backlink you will not Collaborate More with EcoPlus mission.', 'PlusCaptcha')),\r\n\t\t//'PlusCaptcha_form_feedback' => array('title' => __('Feedback Program', 'PlusCaptcha'), 'description' => __('The \"Feedback Program\" help to us make the service better every day. <a href=\"#\">Read More.</a>', 'PlusCaptcha'), 'disabled' => true),\r\n\t\t//'PlusCaptcha_feedback_quemejoraria' => array('title' => __('What do you love of PlusCaptcha and what do you think we can amend?', 'PlusCaptcha'),'maxchars' => __('maxlength=\"299\"')),\r\n    'PlusCaptcha_form_contact' => array('title' => __('<b>Contact Form</b>', 'PlusCaptcha'), 'description' => __('Insert a contact form where you wanna. In one page, post, or everywhere with a simple code. Just copy this code: [im_helping_with_ecoplus] in the description of your page, post, etc.', 'PlusCaptcha')),\r\n);\r\n\r\n/**\r\n * @return true if PlusCaptcha is properly registered.\r\n */\r\nfunction PlusCaptcha_is_registered() {\r\n  return (\r\n  \t\t\t(get_option('uuid_key_speci_to_generate_captchas', '')) \r\n\t\t\t&& (get_option('PlusCaptcha_feedback_quemejoraria', '')) \r\n\t\t\t//&& (get_option('PlusCaptcha_key', '')) \r\n\t\t\t//&& (get_option('PlusCaptcha_secret', ''))\r\n \t\t );\r\n}\r\n\r\n/**\r\n * Display admin notices.\r\n * @return void\r\n */\r\nfunction PlusCaptcha_admin_notices() {\r\n  // If the plugin is not configured yet.\r\n  if (!PlusCaptcha_is_registered()) {\r\n    echo '<div class=\"error PlusCaptcha\" style=\"text-align: center; float:left;width:99%;\">\r\n      <p style=\"color: red; font-size: 14px; font-weight: bold;\">' . __('Your PlusCaptcha plugin is not setup yet') \r\n      . '</p><p>' . __('Click ') . '<a href=\"options-general.php?page=PlusCaptcha\">' . __('here') . '</a> ' \r\n      . __('to finish setup.') . '</p></div>'\r\n    ;\r\n  }\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha settings link to admin menu\r\n * @return void\r\n */\r\nfunction PlusCaptcha_admin_menu() {\r\n  //$menu_item = \"<div class='admin-menu-item'>PlusCaptcha</div>\";\r\n  //add_options_page(__('PlusCaptcha', 'PlusCaptcha'), __($menu_item, 'PlusCaptcha'), 'manage_options', 'PlusCaptcha', 'PlusCaptcha_options_page');\r\n  add_menu_page(__('PlusCaptcha', 'PlusCaptcha'), __('PlusCaptcha', 'PlusCaptcha'), 'manage_options', 'PlusCaptcha', 'PlusCaptcha_options_page', \r\n          PlusCaptcha_URL.'/images/menu-icon.png');\r\n}\r\n\r\n/**\r\n * PlusCaptcha options page logic\r\n * @return void\r\n */\r\nfunction PlusCaptcha_options_page() {\r\n  //must check that the user has the required capability \r\n  if (!current_user_can('manage_options')) {\r\n    wp_die(__('You do not have sufficient permissions to access this page.'));\r\n  }\r\n\r\n  //$skip_register = ((isset($_REQUEST['skip_register'])) && ($_REQUEST['skip_register'] == 1));\r\n  //if (true) {\r\n    sweetcatpcha_main_settings();\r\n  //} else {\r\n    PlusCaptcha_register_form();\r\n  //}\r\n}\r\n\r\n/**\r\n * Displays the PlusCaptcha register form.\r\n * @return void\r\n */\r\nfunction PlusCaptcha_register_form() {\r\n  global $PlusCaptcha_instance;\r\n\r\n  $hidden_field_name = 'mt_submit_hidden';\r\n  $form_html = 'Could not load registration form.';\r\n  //var_export($_POST);\r\n  // See if the user has posted us some information\r\n  // If they did, this hidden field will be set to 'Y'\r\n  if ((tags(isset($_POST[$hidden_field_name]))) && (tags($_POST[$hidden_field_name]) == 'Y')) {\r\n    $result = json_decode(submit_register_form($_POST), true);\r\n    if ($result['error']) {\r\n      if (!empty($result['html'])) {\r\n        $form_html = $result['html'];\r\n      }\r\n    } else {\r\n      update_option('uuid_key_speci_to_generate_captchas', $result['app_id']);\r\n\t  update_option('PlusCaptcha_feedback_quemejoraria', tags($_POST[\"PlusCaptcha_feedback_quemejoraria\"]));\r\n      //update_option('PlusCaptcha_key', $result['key']);\r\n      //update_option('PlusCaptcha_secret', $result['secret']);\r\n\r\n      // Load the main options page, and ignore the post data (since it's missing all the options!).\r\n      sweetcatpcha_main_settings(true);\r\n\r\n      // Hide the \"your plugin is not set up yet\" message.\r\n      echo \"\r\n\t\t\t\t<script type=\\\"text/javascript\\\" language=\\\"javascript\\\">\r\n\t\t\t\t\tjQuery('div.error.PlusCaptcha').hide();\r\n\t\t\t\t</script>\r\n\t\t\t\";\r\n      return;\r\n    }\r\n  } else {\r\n    //$form_html = $PlusCaptcha_instance->get_register_form();\r\n\t$form_html = \"NONE\";\r\n  }\r\n  // Fill Register Form fields\r\n  $website = json_encode(tags(empty($_POST['website'])) ? \"http://{\".tags($_SERVER['SERVER_NAME']).\"}/\" : tags($_POST['website']));\r\n  $email = json_encode(tags($_POST['email']));\r\n  \r\n  //jQuery('<div><input type=\"text\" class=\"field\" name=\"dynamic[]\" value=\"' + i + '\" /></div>').fadeIn('slow').appendTo('.inputs');\r\n  $form_html .= \"<script type=\\\"text/javascript\\\" language=\\\"javascript\\\">\\n\";\r\n  $form_html .= \"    jQuery('input[name=website]').addClass('requiredField');\\n\";\r\n  $form_html .= \"    jQuery('input[name=email]').addClass('requiredField');\\n\";\r\n  $form_html .= \"    jQuery('select[name=site_category]').addClass('requiredField');\\n\";\r\n    \r\n  $form_html .= \"    jQuery('input[name=website]').val($website);\\n\";\r\n  $form_html .= \"    jQuery('input[name=email]').val($email);\\n\";\r\n\r\n  if (tags(isset($_POST['language']))) {\r\n    $language = (int) tags($_POST['language']);\r\n    $form_html .= \"    jQuery('select[name=language]').val($language);\\n\";\r\n  }\r\n  if (tags(isset($_POST['category']))) {\r\n    $category = (int) tags($_POST['category']);\r\n    $form_html .= \"    jQuery('select[name=category]').val($category);\\n\";\r\n  }\r\n  if (tags(isset($_POST['site_category']))) {\r\n    $site_category = (int) tags($_POST['site_category']);\r\n    $form_html .= \"    jQuery('select[name=site_category]').val($site_category);\\n\";\r\n  }\r\n  if (tags(isset($_POST['gender']))) {\r\n    $gender = (int) tags($_POST['gender']);\r\n    $form_html .= \"    jQuery('select[name=gender]').val($gender);\\n\";\r\n  }\r\n  $form_html .= \"</script>\\n\";\r\n  \r\n  $form_html = preg_replace('/category:/', 'PlusCaptcha design:', $form_html);\r\n  //$form_html = preg_replace('/Please fill in your site details/', 'Fill in your PlusCaptcha details to activate:', $form_html);\r\n  $form_html = preg_replace('/language:/', 'PlusCaptcha language:', $form_html);\r\n  //$form_html = preg_replace('/PlusCaptcha theme:/', 'PlusCaptcha design:', $form_html);\r\n  //$form_html = str_lreplace(\"</tr>\", '</tr><tr><td class=\"left\">Website category:</td><td class=\"right\"><select name=\"site_category\">'.$select_html.'</select></td></tr>',$form_html);\r\n  \r\n  $form_html .= \"<script type=\\\"text/javascript\\\">\\n jQuery('input[name=email_verify]').val(jQuery('input[name=email]').val()); jQuery('input[name=email_verify]').parent().parent().hide(); </script>\\n\";\r\n  $form_html .= \"<script type=\\\"text/javascript\\\">\\n jQuery('input[name=email]').change(function() {jQuery('input[name=email_verify]').val(jQuery(this).val());}); </script>\\n\";\r\n  \r\n  /*\r\n  $cats = file(PlusCaptcha_ROOT.'/site-categories.txt');\r\n  $select_html = '';\r\n  foreach ($cats as $cat) {\r\n    $cat =  trim ( $cat);\r\n    $select_html .= \"<option value='$cat'>$cat</option>\";\r\n  }\r\n  //$form_html = preg_replace(strrev(\"|</tr>|\"),'</tr><tr><td></td><td></td></tr>',$form_html,1);\r\n  $form_html = str_lreplace(\"</tr>\", '</tr><tr><td class=\"left\">Website category:</td><td class=\"right\"><select name=\"site_category\">'.$select_html.'</select></td></tr>',$form_html);\r\n  */\r\n\r\n\r\n}\r\n\r\nfunction str_lreplace($search, $replace, $subject) {\r\n  return substr_replace($subject, $replace, strrpos($subject, $search), strlen($search));\r\n}\r\n\r\n/**\r\n * Displays the main PlusCaptcha settings.\r\n * @return void\r\n */\r\nfunction sweetcatpcha_main_settings($ignore_post = false) {\r\n  global $PlusCaptcha_options, $plscptf_options;\r\n\r\n  // variables for the field and option names \r\n  $opt_name = 'mt_favorite_color';\r\n  $hidden_field_name = 'mt_submit_hidden';\r\n  $data_field_name = 'mt_favorite_color';\r\n\r\n  PlusCaptcha_contactform_settings();\r\n\r\n  // See if the user has posted us some information\r\n  // If they did, this hidden field will be set to 'Y'\r\n  if ((!$ignore_post) && (tags(isset($_POST[$hidden_field_name]))) && (tags($_POST[$hidden_field_name]) == 'Y')) {\r\n    $rs = TRUE;\r\n\r\n    // Read their posted value\r\n    foreach ($PlusCaptcha_options as $opt_name => $v) {\r\n      $opt_val = tags(isset($_POST[$opt_name])) ? tags($_POST[$opt_name]) : null;\r\n\r\n      // Save the posted value in the database\r\n      update_option($opt_name, $opt_val);\r\n    }\r\n\r\n    if ( plscptf_settings_save() ) {\r\n      // Put an settings updated message on the screen\r\n      $saved_html = 'Settings saved.';\r\n      if (PlusCaptcha_is_registered()) {\r\n        $saved_html .= \"\r\n\t\t\t\t<script type=\\\"text/javascript\\\" language=\\\"javascript\\\">\r\n\t\t\t\t\tjQuery( 'div.error.PlusCaptcha' ).hide();\r\n\t\t\t\t</script>\r\n      \t\";\r\n      }\r\n    }\r\n\r\n    $message = $rs ? __($saved_html, 'PlusCaptcha') : __('settings cannot be saved.', 'PlusCaptcha');\r\n  }\r\n\r\n  // Read in existing option value from database\r\n  $options_values = PlusCaptcha_options();\r\n\r\n  //echo 'plscptf_options='; var_export($plscptf_options);\r\n  require_once PlusCaptcha_TEMPLATE . '/admin-options.php';\r\n\r\n}\r\n\r\n// Sweet Captcha Contact Form settings \r\nfunction PlusCaptcha_contactform_settings() {\r\n  global $plscptf_options;\r\n\r\n  $plscptf_option_defaults = array(\r\n      'plscptf_user_email' => 'admin',\r\n      'plscptf_custom_email' => '',\r\n      'plscptf_select_email' => 'user',\r\n      'plscptf_additions_options' => 0,\r\n      'plscptf_send_copy' => 0,\r\n      'plscptf_from_field' => get_bloginfo('name'),\r\n      'plscptf_display_add_info' => 1,\r\n      'plscptf_display_sent_from' => 1,\r\n      'plscptf_display_date_time' => 1,\r\n      'plscptf_mail_method' => 'wp-mail',\r\n      'plscptf_display_coming_from' => 1,\r\n      'plscptf_display_user_agent' => 1,\r\n      'plscptf_change_label' => 0,\r\n      'plscptf_name_label' => __(\"Name:\", 'PlusCaptcha'),\r\n      'plscptf_email_label' => __(\"E-Mail Address:\", 'PlusCaptcha'),\r\n      'plscptf_subject_label' => __(\"Subject:\", 'PlusCaptcha'),\r\n      'plscptf_message_label' => __(\"Message:\", 'PlusCaptcha'),\r\n      'plscptf_action_after_send' => 1,\r\n      'plscptf_thank_text' => __(\"Thank you for contacting us.\", 'PlusCaptcha'),\r\n      'plscptf_redirect_url' => ''\r\n  );\r\n  if (!get_option('PlusCaptcha_form_contact_options'))\r\n    add_option('PlusCaptcha_form_contact_options', $plscptf_option_defaults);\r\n\r\n  $plscptf_options = get_option('PlusCaptcha_form_contact_options');\r\n  if (is_array($plscptf_options) ) {\r\n    $plscptf_options = array_merge($plscptf_option_defaults, $plscptf_options);\r\n  } else {\r\n    $plscptf_options = $plscptf_option_defaults;\r\n  }\r\n  update_option('PlusCaptcha_form_contact_options', $plscptf_options);\r\n}\r\n\r\nfunction plscptf_settings_save() {\r\n  global $plscptf_options, $wpdb, $error;\r\n  $userslogin = $wpdb->get_col(\"SELECT user_login FROM  $wpdb->users \", 0);\r\n  $plscptf_options_submit = array();\r\n  // Save data for settings page\r\n  $plscptf_options_submit['plscptf_user_email'] = tags($_REQUEST['plscptf_user_email']);\r\n  $plscptf_options_submit['plscptf_custom_email'] = tags($_REQUEST['plscptf_custom_email']);\r\n  $plscptf_options_submit['plscptf_select_email'] = tags($_REQUEST['plscptf_select_email']);\r\n  $plscptf_options_submit['plscptf_additions_options'] = tags(isset($_REQUEST['plscptf_additions_options'])) ? tags($_REQUEST['plscptf_additions_options']) : 0;\r\n  if ($plscptf_options_submit['plscptf_additions_options'] == 0) {\r\n    $plscptf_options_submit['plscptf_send_copy'] = 0;\r\n    $plscptf_options_submit['plscptf_from_field'] = get_bloginfo('name');\r\n    $plscptf_options_submit['plscptf_display_add_info'] = 1;\r\n    $plscptf_options_submit['plscptf_display_sent_from'] = 1;\r\n    $plscptf_options_submit['plscptf_display_date_time'] = 1;\r\n    $plscptf_options_submit['plscptf_mail_method'] = 'wp-mail';\r\n    $plscptf_options_submit['plscptf_display_coming_from'] = 1;\r\n    $plscptf_options_submit['plscptf_display_user_agent'] = 1;\r\n    $plscptf_options_submit['plscptf_change_label'] = 0;\r\n    $plscptf_options_submit['plscptf_name_label'] = __(\"Name:\", 'PlusCaptcha');\r\n    $plscptf_options_submit['plscptf_email_label'] = __(\"E-Mail Address:\", 'PlusCaptcha');\r\n    $plscptf_options_submit['plscptf_subject_label'] = __(\"Subject:\", 'PlusCaptcha');\r\n    $plscptf_options_submit['plscptf_message_label'] = __(\"Message:\", 'PlusCaptcha');\r\n    $plscptf_options_submit['plscptf_action_after_send'] = 1;\r\n    $plscptf_options_submit['plscptf_thank_text'] = __(\"Thank you for contacting us.\", 'PlusCaptcha');\r\n    $plscptf_options_submit['plscptf_redirect_url'] = '';\r\n  } else {\r\n    $plscptf_options_submit['plscptf_send_copy'] = tags(isset($_REQUEST['plscptf_send_copy'])) ? tags($_REQUEST['plscptf_send_copy']) : 0;\r\n    $plscptf_options_submit['plscptf_mail_method'] = tags($_REQUEST['plscptf_mail_method']);\r\n    $plscptf_options_submit['plscptf_from_field'] = tags($_REQUEST['plscptf_from_field']);\r\n    $plscptf_options_submit['plscptf_display_add_info'] = tags(isset($_REQUEST['plscptf_display_add_info'])) ? 1 : 0;\r\n    $plscptf_options_submit['plscptf_change_label'] = tags(isset($_REQUEST['plscptf_change_label'])) ? 1 : 0;\r\n    if ($plscptf_options_submit['plscptf_display_add_info'] == 1) {\r\n      $plscptf_options_submit['plscptf_display_sent_from'] = tags(isset($_REQUEST['plscptf_display_sent_from'])) ? 1 : 0;\r\n      $plscptf_options_submit['plscptf_display_date_time'] = tags(isset($_REQUEST['plscptf_display_date_time'])) ? 1 : 0;\r\n      $plscptf_options_submit['plscptf_display_coming_from'] = tags(isset($_REQUEST['plscptf_display_coming_from'])) ? 1 : 0;\r\n      $plscptf_options_submit['plscptf_display_user_agent'] = tags(isset($_REQUEST['plscptf_display_user_agent'])) ? 1 : 0;\r\n    } else {\r\n      $plscptf_options_submit['plscptf_display_sent_from'] = 1;\r\n      $plscptf_options_submit['plscptf_display_date_time'] = 1;\r\n      $plscptf_options_submit['plscptf_display_coming_from'] = 1;\r\n      $plscptf_options_submit['plscptf_display_user_agent'] = 1;\r\n    }\r\n    if ($plscptf_options_submit['plscptf_change_label'] == 1) {\r\n      $plscptf_options_submit['plscptf_name_label'] = tags(isset($_REQUEST['plscptf_name_label'])) ? tags($_REQUEST['plscptf_name_label']) : $plscptf_options_submit['plscptf_name_label'];\r\n      $plscptf_options_submit['plscptf_email_label'] = tags(isset($_REQUEST['plscptf_email_label'])) ? tags($_REQUEST['plscptf_email_label']) : $plscptf_options_submit['plscptf_email_label'];\r\n      $plscptf_options_submit['plscptf_subject_label'] = tags(isset($_REQUEST['plscptf_subject_label'])) ? tags($_REQUEST['plscptf_subject_label']) : $plscptf_options_submit['plscptf_subject_label'];\r\n      $plscptf_options_submit['plscptf_message_label'] = tags(isset($_REQUEST['plscptf_message_label'])) ? tags($_REQUEST['plscptf_message_label']) : $plscptf_options_submit['plscptf_message_label'];\r\n    } else {\r\n      $plscptf_options_submit['plscptf_name_label'] = __(\"Name:\", 'PlusCaptcha');\r\n      $plscptf_options_submit['plscptf_email_label'] = __(\"E-Mail Address:\", 'PlusCaptcha');\r\n      $plscptf_options_submit['plscptf_subject_label'] = __(\"Subject:\", 'PlusCaptcha');\r\n      $plscptf_options_submit['plscptf_message_label'] = __(\"Message:\", 'PlusCaptcha');\r\n    }\r\n    $plscptf_options_submit['plscptf_action_after_send'] = tags($_REQUEST['plscptf_action_after_send']);\r\n    $plscptf_options_submit['plscptf_thank_text'] = tags($_REQUEST['plscptf_thank_text']);\r\n    $plscptf_options_submit['plscptf_redirect_url'] = tags($_REQUEST['plscptf_redirect_url']);\r\n  }\r\n  $plscptf_options = array_merge($plscptf_options, $plscptf_options_submit);\r\n  if ($plscptf_options_submit['plscptf_action_after_send'] == 0\r\n          && ( trim($plscptf_options_submit['plscptf_redirect_url']) == \"\"\r\n          || !preg_match('@^(?:http://)?([^/]+)@i', trim($plscptf_options_submit['plscptf_redirect_url'])) )) {\r\n    $error .=__(\"If the option 'Redirect to page' is selected then url field should be fillied in the following format\", 'PlusCaptcha') . \" <code>http://your_site/your_page</code>\";\r\n    $plscptf_options['plscptf_action_after_send'] = 1;\r\n  }\r\n  if ('user' == $plscptf_options_submit['plscptf_select_email']) {\r\n    if (function_exists('get_userdatabylogin') && false !== get_userdatabylogin($plscptf_options_submit['plscptf_user_email'])) {\r\n      update_option('PlusCaptcha_form_contact_options', $plscptf_options, '', 'yes');\r\n      $message = __(\"Options saved.\", 'PlusCaptcha');\r\n    } else if (false !== get_user_by('login', $plscptf_options_submit['plscptf_user_email'])) {\r\n      update_option('PlusCaptcha_form_contact_options', $plscptf_options, '', 'yes');\r\n      $message = __(\"Options saved.\", 'PlusCaptcha');\r\n    } else {\r\n      $error .=__(\"Such user does not exist. Settings not saved.\", 'PlusCaptcha');\r\n    }\r\n  } else {\r\n    if ( tags(isset($_REQUEST['PlusCaptcha_form_contact'])) ) {\r\n      if ($plscptf_options_submit['plscptf_custom_email'] != \"\" && preg_match(\"/^((?:[a-z0-9]+(?:[a-z0-9\\-_\\.]+)?@[a-z0-9]+(?:[a-z0-9\\-\\.]+)?\\.[a-z]{2,5})[, ]*)+$/i\", trim($plscptf_options_submit['plscptf_custom_email']))) {\r\n        update_option('PlusCaptcha_form_contact_options', $plscptf_options, '', 'yes');\r\n      $message = __(\"Options saved.\", 'PlusCaptcha');\r\n      } else {\r\n        $error .= __(\"Please input correct email. Settings not saved.\", 'PlusCaptcha');\r\n      }\r\n    } else {\r\n      $message = __(\"Options saved.\", 'PlusCaptcha');\r\n    }\r\n  }\r\n  return empty($error);\r\n}\r\n\r\n/**\r\n * Get all PlusCaptcha options values as asociative array\r\n * @return array\r\n */\r\nfunction PlusCaptcha_options() {\r\n  global $PlusCaptcha_options;\r\n  $options_values = array();\r\n  foreach ($PlusCaptcha_options as $opt_name => $opt_title) {\r\n    $options_values[$opt_name] = get_option($opt_name);\r\n  }\r\n  return $options_values;\r\n}\r\n\r\n/**\r\n * PlusCaptcha plug-in activation hook\r\n * @return void\r\n */\r\nfunction PlusCaptcha_activate() {\r\n  $PlusCaptcha_defaults = array(\r\n      'uuid_key_speci_to_generate_captchas' => '',\r\n\t  'background_color_inside_iframe' => 'none',\r\n      //'PlusCaptcha_key' => '',\r\n      //'PlusCaptcha_secret' => '',\r\n      //'PlusCaptcha_public_url' => '/wp-content/plugins/PlusCaptcha/library/PlusCaptcha.php',\r\n      'PlusCaptcha_form_omit_users' => '1',\r\n\t  'PlusCaptcha_form_omit_backlink' => '1',\r\n\t  'PlusCaptcha_form_feedback' => '1',\r\n\t  'PlusCaptcha_form_feedback' => '1',\r\n      'PlusCaptcha_form_registration' => '0',\r\n      'PlusCaptcha_form_comment' => '1',\r\n      'PlusCaptcha_form_login' => '0',\r\n      'PlusCaptcha_form_lost' => '1',\r\n      'PlusCaptcha_form_contact' => '0',\r\n\t  'PlusCaptcha_ocultar_backlink' => '0',\r\n      'PlusCaptcha_installed' => '1',\r\n  );\r\n  if (!get_option('PlusCaptcha_installed')) {\r\n    foreach ($PlusCaptcha_defaults as $opt_name => $opt_val) {\r\n      $opt_curr_val = get_option($opt_name);\r\n      if (empty($opt_curr_val)) {\r\n        update_option($opt_name, $opt_val);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction Generate_New_Account() \r\n{\r\n\r\n\tif( strlen(get_option( 'uuid_api_wp_feedback' )) < 4 )\r\n\t{\r\n\t\t$url = 'http://www.pluscaptcha.com/api/wp_log/install?'\r\n\t\t\t\t.'name='.urlencode(get_bloginfo('name')).\r\n\t\t\t\t'&url='.str_replace(\".\",\"[dot]\",urlencode(get_bloginfo('url'))).\r\n\t\t\t\t'&description='.urlencode(get_bloginfo('description')).\r\n\t\t\t\t'&wpurl='.str_replace(\".\",\"[dot]\",urlencode(get_bloginfo('wpurl'))).\r\n\t\t\t\t'&admin_email='.urlencode(get_bloginfo('admin_email')).\r\n\t\t\t\t'&charset='.urlencode(get_bloginfo('charset')).\r\n\t\t\t\t'&version='.urlencode(get_bloginfo('version')).\r\n\t\t\t\t'&language='.urlencode(get_bloginfo('language')).\r\n\t\t\t\t'&registrarse=1'.''; // Sistema para registrar cuenta activado.\r\n\t\t\t\t\r\n\t\t$result = @fgets(@fopen($url, 'r'), 4096);\r\n\t\t\r\n\t\t// Guardar que ya fu\u00e9 subido\r\n\t\t$exploded = explode(\"#\",$result);\r\n\t\tupdate_option('uuid_api_wp_feedback', $exploded[0]); // Guardar UUID\r\n\t\r\n\t\tif($exploded[1] != \"\") // Ver si devolvi\u00f3 la password\r\n\t\t{\t\r\n\t\t\tupdate_option('pluscaptcha_account_user', get_bloginfo('admin_email')); // Guardar usuario (admin mail)\r\n\t\t\tupdate_option('pluscaptcha_account_password', $exploded[1]); // Guardar contrase\u0144a (devuelta por fgets)\r\n\t\t\tupdate_option('registered_account_from_api', true);\r\n\t\t}\r\n\t\t\r\n\t\tif($exploded[2] != \"\" && $exploded[3] != \"\" && $exploded[4] != \"\") // Ver si devolvi\u00f3 UUID cuenta generada\r\n\t\t{\r\n\t\t\t$compuesto = $exploded[3].\"#\".$exploded[2].\"#\".$exploded[4];\r\n\t\t\tupdate_option('uuid_key_speci_to_generate_captchas', $compuesto); // Guardar UUID cuenta generada\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * Delete PlusCaptcha options from database\r\n * @return void\r\n */\r\nfunction PlusCaptcha_uninstall() {\r\n  global $PlusCaptcha_options;\r\n\r\n  foreach ($PlusCaptcha_options as $opt_name => $opt_title) {\r\n    delete_option($opt_name);\r\n  }\r\n  // These do not appear in the global .\r\n  delete_option('PlusCaptcha_installed');\r\n}\r\n\r\n?>\r\n", "<?php\r\n\r\nif (!function_exists('tags')) {\r\n\t# Clean\r\n\t# Limpiar data\r\n\tfunction tags($tags){  \r\n\t\t$tags = strip_tags($tags);  \r\n\t\t$tags = stripslashes($tags);  \r\n\t\t$tags = htmlentities($tags);\r\n\t\t$tags = addslashes($tags);\r\n\t\treturn trim($tags);  \r\n\t}\r\n}\r\n\r\n/**\r\n * Get PlusCaptcha values from POST data\r\n * @return array\r\n */\r\nfunction PlusCaptcha_get_values() {\r\n\treturn array(\r\n\t\t'sckey'\t\t=> ( tags( isset( $_POST[ 'sckey' ]) ) ? tags($_POST[ 'sckey' ]) : '' ),\r\n\t\t'scvalue'\t=> ( tags( isset( $_POST[ 'scvalue' ]) ) ? tags($_POST[ 'scvalue' ]) : '' )\r\n\t);\r\n}\r\n\r\nfunction get_result($entrada,$shortcode=false) {\r\n\r\n\t$limpiado = strip_tags(stripslashes(htmlentities(addslashes(trim($entrada)))));  \r\n\t$datosent = explode(\"///\",$limpiado);  \r\n\t\r\n\tif($datosent[0] != ''){ \r\n\t\tif($datosent[1] == 'c'){ \r\n\t\t\t$host = 'syshtml5.pluscaptcha.com'; \r\n\t\t}else{ \r\n\t\t\t$HostReg = array('syshtml5.agartha.us','syshtml5.loquees.biz','syshtml5.ispect.ws');  \r\n\t\t\t$host = $HostReg[$datosent[1]]; \r\n\t\t} \r\n\t\r\n\t\t//$_SESSION[\"contacto\"] = '';\r\n\t\tif(!$shortcode)\r\n\t\t{\r\n\t\t\tsimpleSessionSet(\"contacto\", \"\");\r\n\t\t}else{\r\n\t\t\tsimpleSessionSet(\"contacto_shortcode\", \"\");\r\n\t\t}\r\n\t\t\r\n\t\t$resultado_ejecucion = @fgets(@fopen('http://'.$host.'/r?iduso='.$datosent[0]. '', 'r'), 4096);\r\n\r\n\t\t// Acertar si acert\u00f3 con el captcha\r\n\t\tif($resultado_ejecucion)\r\n\t\t{\r\n\t\t\t// Acert\u00f3\r\n\t\t\t// Crear \"pasaporte\" por si no acierta los otros campos. SOLO SI NO FU\u00c9 CREADO \u00c1NTES\r\n\t\t\t//$_SESSION[\"passport\"] = true;\r\n\t\t\t// poner true luego\r\n\t\t\treturn true;\r\n\t\t\t\r\n\t\t}else{\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\r\n\t// No vino con d\u00e1tos (debe estar muerta la sessi\u00f3n), ver si tiene pasaporte\r\n\t}\r\n\r\n}\r\n\r\n/**\r\n * Move submit button under PlusCaptcha field.\r\n * @return string\r\n */\r\nfunction PlusCaptcha_move_submit_button() {\r\n\treturn '<div id=\"PlusCaptcha-submit-button\" class=\"form-submit\" style=\"display: table; margin-top: 20px;\"></div>'.\r\n\t\t'<script type=\"text/javascript\">'.\r\n\t\t\t'var sub = document.getElementById(\"submit\");'.\r\n\t\t\t'if (sub!=undefined){'.\r\n\t\t\t'sub.parentNode.removeChild(sub);'.\r\n\t\t\t'document.getElementById(\"PlusCaptcha-submit-button\").appendChild (sub);'.\r\n\t\t\t'document.getElementById(\"submit\").tabIndex = 6;}'.\r\n\t\t'</script>\r\n\t\t<br />';\r\n}\r\n\r\nfunction captcha_call($shortcode=false){\r\n\t\tif(get_option('uuid_key_speci_to_generate_captchas', '') != \"\")\r\n\t\t{\r\n\t\t\r\n\r\n\t\t\t\t\t\t\t\t\t$keyC = @fgets(@fopen('http://captchakey.biz/', 'r'), 4096);\r\n\r\n\t\t\t\t\t\t\t\t\tif ($keyC == '1'){  \r\n\t\t\t\t\t\t\t\t\t    $Hostausar = 'syshtml5.pluscaptcha.com';  \r\n\t\t\t\t\t\t\t\t\t    $h = 'c'; \r\n\t\t\t\t\t\t\t\t\t}else{ \r\n\t\t\t\t\t\t\t\t\t    $Hostausar = array('syshtml5.agartha.us','syshtml5.loquees.biz','syshtml5.ispect.ws');  \r\n\t\t\t\t\t\t\t\t\t    $Aleatorio = array_rand($Hostausar,1); \r\n\t\t\t\t\t\t\t\t\t    $Hostausar = $Hostausar[$Aleatorio];  \r\n\t\t\t\t\t\t\t\t\t    $h = $Aleatorio; \r\n\t\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t// Obtener especificaciones para el captcha\r\n\t\t\t\t\t\t\t\t\t$value_exploded = explode(\"#\",get_option('uuid_key_speci_to_generate_captchas', ''));\r\n\t\t\t\t\t\t\t\t\t// Obtener tama\u0144o a inyectar al iframe\r\n\t\t\t\t\t\t\t\t\t\t// Obtener Ancho\r\n\t\t\t\t\t\t\t\t\t\tswitch ($value_exploded[0]) {\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'C':\r\n\t\t\t\t\t\t\t\t\t\t\t\t$width = 205;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'M':\r\n\t\t\t\t\t\t\t\t\t\t\t\t$width = 205;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'G':\r\n\t\t\t\t\t\t\t\t\t\t\t\t$width = 235;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t// Obtener Alto\r\n\t\t\t\t\t\t\t\t\t\tswitch ($value_exploded[0]) {\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'C':\r\n\t\t\t\t\t\t\t\t\t\t\t\t$height = 115;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'M':\r\n\t\t\t\t\t\t\t\t\t\t\t\t$height = 125;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\tcase 'G':\r\n\t\t\t\t\t\t\t\t\t\t\t\t$height = 145;\r\n\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t// Obtener backlink\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t/*\r\n\t\t\t\t\t\t\t\t\tif(get_option('ecoplus_url_backlink', '') == \"\")\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t// Generar backlink y almacenarlo\r\n\t\t\t\t\t\t\t\t\t\t$data = \"\";\r\n\t\t\t\t\t\t\t\t\t\t// Obtener un key externo\r\n\t\t\t\t\t\t\t\t\t\t$key_uuid_externo = @fgets(@fopen('http://www.pluscaptcha.com/api/avaliable.php', 'r'), 4096);\r\n\t\t\t\t\t\t\t\t\t\t// Obtener un backlink\r\n\t\t\t\t\t\t\t\t\t\t$gestor = @fopen(\"http://www.pluscaptcha.com/api/anchor?lang=\".$value_exploded[2].\"&identnumber=\".$key_uuid_externo, \"r\");\r\n\t\t\t\t\t\t\t\t\t\t// Tomar la data\r\n\t\t\t\t\t\t\t\t\t\tif ($gestor) {\r\n\t\t\t\t\t\t\t\t\t\t\twhile (($buffer = fgets($gestor, 4096)) !== false) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t$data .= $buffer;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tfclose($gestor);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t// Ver si devolvi\u00f3 un backlink buscando <p (notese que falta el corchete, est\u00e1 bien...)\r\n\t\t\t\t\t\t\t\t\t\tif( substr_count(html_entity_decode($data), \"</p>\") > 0 )\r\n\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t// Guardar\r\n\t\t\t\t\t\t\t\t\t\t\tupdate_option('ecoplus_url_backlink', $data);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t*/\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t$c = 'none';\r\n\t\t\t\t\t\t\t\t\t$uidus = @fgets(@fopen('http://'.$Hostausar.'/g?id='.$value_exploded[1].'&c='.$c, 'r'), 4096);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t$value_to_set = $uidus.'///'.$h;\r\n\t\t\t\t\t\t\t\t\tif(!$shortcode)\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\tsimpleSessionSet(\"contacto\", $value_to_set);\r\n\t\t\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t\t\tsimpleSessionSet(\"contacto_shortcode\", $value_to_set);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t'<div style=\"width:'.$width.'px; height: auto;\"> \r\n\r\n\t\t\t\t\t\t\t\t\t    <iframe src=\"http://'.$Hostausar.'/i?iduso='.$uidus.'\"  \r\n\t\t\t\t\t\t\t\t\t    width=\"'.$width.'\" height=\"'.$height.'\" scrolling=\"no\" frameborder=\"0\"></iframe>  \r\n\r\n\t\t\t\t\t\t\t\t\t</div>';\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t}else{\r\n\t\t\treturn '<div>Please make the setup of PlusCaptcha in your Wordpress Panel</div>';\r\n\t\t}\t\t\t\t\t\t\r\n}\r\n \r\n \r\n/**\r\n * Add PlusCaptcha to comment form\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_comment_form() {\r\n\tglobal $PlusCaptcha_instance, $user_ID, $wp_version;\r\n\t$wp_versions = explode( '.', $wp_version );\r\n\tif ( get_option( 'PlusCaptcha_form_ommit_users' ) && isset($user_ID) && (int)$user_ID > 0 ) {\r\n\t\treturn true;\r\n\t}\r\n\t//echo $PlusCaptcha_instance->get_html();\r\n\techo captcha_call();\r\n\techo PlusCaptcha_move_submit_button();\r\n\tif ( $wp_versions[ 0 ] >= 3 && $wp_versions[ 1 ] >= 0 ) { \r\n\t\techo '<script type=\"text/javascript\">document.getElementById(\"respond\").style.overflow=\"visible\";</script>';\r\n\t}\r\n\tremove_action( 'comment_form', 'PlusCaptcha_comment_form' );\r\n\treturn true;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha check submitted comment form\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_comment_form_check($comment) {\r\n\tglobal $PlusCaptcha_instance, $user_ID;\r\n\tif ( get_option( 'PlusCaptcha_form_ommit_users' ) && isset($user_ID) && (int)$user_ID > 0  ) {\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t\treturn $comment;\r\n\t}\r\n\tif ( !empty( $comment[ 'comment_type' ] ) && ( $comment[ 'comment_type' ] != 'comment' )  ) {\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t\treturn $comment;\r\n\t}\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif ( get_result(simpleSessionGet(\"contacto\", \"\"),true) != false ) {\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n        return $comment;\r\n\t} else {\r\n\t\t// since 2.0.4\r\n\t\tif (function_exists('wp_die')) {\r\n\t\t\twp_die('<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __( PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ) );\r\n\t\t} else {\r\n\t\t\tdie('<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __( PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ));\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/**\r\n * PlusCaptcha adjustments for login, registration, lost password,... form\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_adjust_form() {\r\n\treturn '';\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha to login form\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_login_form() {\r\n\tglobal $PlusCaptcha_instance;\r\n\t//echo $PlusCaptcha_instance->get_html();\r\n\techo captcha_call();\r\n\treturn true;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha to registration form\r\n * @return boolean\r\n */\r\n /*\r\nfunction PlusCaptcha_registration_form() {\r\n\tglobal $PlusCaptcha_instance;\r\n\tif (!get_option('PlusCaptcha_form_registration')) {\r\n\t\treturn true;\r\n\t}\r\n\t//echo $PlusCaptcha_instance->get_html();\r\n  //echo PlusCaptcha_adjust_form();\r\n  \techo captcha_call();\r\n\treturn true;\r\n}\r\n*/\r\n\r\n/**\r\n * Add PlusCaptcha authetificate check\r\n * @param $user\r\n * @return WP_Error\r\n */\r\nfunction PlusCaptcha_authenticate($user) {\r\n\tglobal $PlusCaptcha_instance;\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif (  tags( !empty( $_POST ) ) && get_result(simpleSessionGet(\"contacto\", \"\")) == false ) {\r\n\t\t$user = new WP_Error( 'captcha_wrong', '<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __( PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ) );\r\n\t}else{\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t}\r\n\treturn $user;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha lost password check\r\n * @param $user\r\n * @return mixed WP_Error or boolean\r\n */\r\nfunction PlusCaptcha_lost_password_check($user) {\r\n\tglobal $PlusCaptcha_instance;\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif ( get_result(simpleSessionGet(\"contacto\", \"\")) == false ) {\r\n\t\t$user = new WP_Error( 'captcha_wrong', '<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __(PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ) );\r\n\t\treturn $user;\r\n\t}else{\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t}\r\n\treturn TRUE;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha registration form check\r\n * @param $errors\r\n * @return WP_Errors\r\n */\r\n /*\r\nfunction PlusCaptcha_register_form_check($errors) {\r\n\tglobal $PlusCaptcha_instance;\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif ( get_result(simpleSessionGet(\"contacto\", \"\")) == false ) {\r\n\t\t$errors->add( 'captcha_wrong', '<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __(PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ) );\t\t\t\r\n\t}\r\n\treturn $errors;\r\n}\r\n*/\r\n\r\n/**\r\n * Add PlusCaptcha to BuddyPress registration form\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_before_registration_submit_buttons() {\r\n\tglobal $PlusCaptcha_instance;\r\n\techo \r\n    '<div id=\"PlusCaptcha-wrapper\">' \r\n    .( ( function_exists('PlusCaptcha_header') ) ? PlusCaptcha_header() : '' )\r\n    //. $PlusCaptcha_instance->get_html() \r\n\t. captcha_call()\r\n    . '</div>';\r\n\treturn TRUE;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha to BuddyPress registration form validation\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_signup_validate() {\r\n\tglobal $bp, $PlusCaptcha_instance;\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif ( get_result(simpleSessionGet(\"contacto\", \"\")) == false ) {\r\n\t\t$bp->signup->errors['signup_username'] = __(PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' );\r\n\t}else{\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t}\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha to Wordpress Network sign-up form \r\n * @param $errors\r\n * @return boolean\r\n */\r\nfunction PlusCaptcha_signup_extra_fields($errors) {\r\n\tglobal $PlusCaptcha_instance;\r\n\t$error = $errors->get_error_message( 'captcha_wrong' );\r\n\t//echo $PlusCaptcha_instance->get_html();\r\n\techo captcha_call();\r\n\tif ( isset($error) && !empty( $error ) ) {\r\n\t\techo '<p class=\"error\">' . $error . '</p>';\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha validation to Wordpress Network sign-up form\r\n * @param $errors\r\n * @return mixed\r\n */\r\nfunction PlusCaptcha_wpmu_validate_user_signup($errors) {\r\n\tglobal $PlusCaptcha_instance;\r\n\tif ( tags($_POST['stage']) == 'validate-user-signup' ) {\r\n\t\t//$scValues = PlusCaptcha_get_values();\r\n\t\tif ( get_result(simpleSessionGet(\"contacto\", \"\")) == false ) {\r\n\t\t\t$errors['errors']->add( 'captcha_wrong', '<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __(PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ) );\r\n\t\t}else{\r\n\t\t\t//$_SESSION[\"passport\"] = false;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\treturn $errors;\r\n}\r\n\r\n/**\r\n * Add PlusCaptcha short code\r\n * @param $atts\r\n * @return string\r\n */\r\nfunction PlusCaptcha_shortcode( $atts = array() ) {\r\n\tglobal $PlusCaptcha_instance;\r\n\treturn ( ( function_exists('PlusCaptcha_header') ) ? PlusCaptcha_header() : '' ).captcha_call(true);\r\n}\r\n\r\n/**\r\n * Validate PlusCaptcha form\r\n * @param $errors\r\n * @param $tag\r\n * @return mixed array\r\n */\r\nfunction PlusCaptcha_validate($errors, $tag = NULL) {\r\n\tglobal $PlusCaptcha_instance;\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif ( get_result(simpleSessionGet(\"contacto\", \"\")) != true ) \r\n\t{\r\n\t\tif ( !empty( $tag ) ) { // if Contact Form 7\r\n\t\t\t$errors['valid'] = false;\r\n\t\t\t$errors['reason']['your-message'] = __(PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' );\r\n\t\t} else {\r\n\t\t\t$errors['errors']->add( 'PlusCaptcha', '<strong>' . __( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __(PlusCaptcha_ERROR_MESSAGE, 'PlusCaptcha' ) );\r\n\t\t}\r\n\t}else{\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t}\r\n\treturn $errors;\r\n}\r\n", "<?php\r\n\r\nif (!function_exists('tags')) {\r\n\t# Clean\r\n\t# Limpiar data\r\n\tfunction tags($tags){  \r\n\t\t$tags = strip_tags($tags);  \r\n\t\t$tags = stripslashes($tags);  \r\n\t\t$tags = htmlentities($tags);\r\n\t\t$tags = addslashes($tags);\r\n\t\treturn trim($tags);  \r\n\t}\r\n}\r\n\r\ntags($_REQUEST);\r\ntags($_POST);\r\ntags($_GET);\r\n\r\n// Display PlusCaptcha Contact Form in front end - page or post\r\nif (!function_exists('plscptf_display_form')) {\r\n\r\n  function plscptf_display_form() {\r\n    global $error_message, $plscptf_options, $result;\r\n    $plscptf_options = get_option('PlusCaptcha_form_contact_options');\r\n    $content = \"\";\r\n\r\n    $page_url = ( tags(isset($_SERVER[\"HTTPS\"])) && tags($_SERVER[\"HTTPS\"]) == \"on\" ? \"https://\" : \"http://\" ) . tags($_SERVER[\"SERVER_NAME\"]) . tags($_SERVER[\"REQUEST_URI\"]);\r\n    // If contact form submited\r\n    $name = tags(isset($_REQUEST['plscptf_contact_name'])) ? tags($_REQUEST['plscptf_contact_name']) : \"\";\r\n    $email = tags(isset($_REQUEST['plscptf_contact_email'])) ? tags($_REQUEST['plscptf_contact_email']) : \"\";\r\n    $subject = tags(isset($_REQUEST['plscptf_contact_subject'])) ? tags($_REQUEST['plscptf_contact_subject']) : \"\";\r\n    $message = tags(isset($_REQUEST['plscptf_contact_message'])) ? tags($_REQUEST['plscptf_contact_message']) : \"\";\r\n    $send_copy = tags(isset($_REQUEST['plscptf_contact_send_copy'])) ? tags($_REQUEST['plscptf_contact_send_copy']) : \"\";\r\n    // If it is good\r\n    if (true === $result) {\r\n      $_SESSION['plscptf_send_mail'] = true;\r\n      if ($plscptf_options['plscptf_action_after_send'] == 1)\r\n        $content .= $plscptf_options['plscptf_thank_text'];\r\n      else\r\n        $content .= \"<script type='text/javascript'>window.location.href = '\" . $plscptf_options['plscptf_redirect_url'] . \"';</script>\";\r\n    }\r\n    else if (false === $result) {\r\n      // If email not be delivered\r\n      $error_message['error_form'] = __(\"Sorry, your e-mail could not be delivered.\", 'PlusCaptcha');\r\n    } else {\r\n      $_SESSION['plscptf_send_mail'] = false;\r\n      // Output form\r\n      $content .= '<form method=\"post\" id=\"plscptf_contact_form\" action=\"' . $page_url . '\" enctype=\"multipart/form-data\">';\r\n      if (isset($error_message['error_form'])) {\r\n        $content .= '<div class=\"error-form\">' . $error_message['error_form'] . '</div>';\r\n      }\r\n      $content .= '<div class=\"input-label\">\r\n\t\t\t\t\t<label for=\"plscptf_contact_name\">' . $plscptf_options['plscptf_name_label'] . '<span class=\"required\"> *</span></label>\r\n\t\t\t\t</div>';\r\n      if (isset($error_message['error_name'])) {\r\n        $content .= '<div class=\"error-form\">' . $error_message['error_name'] . '</div>';\r\n      }\r\n      $content .= '<div class=\"input\">\r\n\t\t\t\t\t<input class=\"text\" type=\"text\" size=\"40\" value=\"' . $name . '\" name=\"plscptf_contact_name\" id=\"plscptf_contact_name\" />\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"input-label\">\r\n\t\t\t\t\t<label for=\"plscptf_contact_email\">' . $plscptf_options['plscptf_email_label'] . '<span class=\"required\"> *</span></label>\r\n\t\t\t\t</div>';\r\n      if (isset($error_message['error_email'])) {\r\n        $content .= '<div class=\"error-form\">' . $error_message['error_email'] . '</div>';\r\n      }\r\n      $content .= '<div class=\"input\">\r\n\t\t\t\t\t<input class=\"text\" type=\"text\" size=\"40\" value=\"' . $email . '\" name=\"plscptf_contact_email\" id=\"plscptf_contact_email\" />\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"input-label\">\r\n\t\t\t\t\t<label for=\"plscptf_contact_subject\">' . $plscptf_options['plscptf_subject_label'] . '<span class=\"required\"> *</span></label>\r\n\t\t\t\t</div>';\r\n      if (isset($error_message['error_subject'])) {\r\n        $content .= '<div class=\"error-form\">' . $error_message['error_subject'] . '</div>';\r\n      }\r\n      $content .= '<div class=\"input\">\r\n\t\t\t\t\t<input class=\"text\" type=\"text\" size=\"40\" value=\"' . $subject . '\" name=\"plscptf_contact_subject\" id=\"plscptf_contact_subject\" />\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class=\"input-label\">\r\n\t\t\t\t\t<label for=\"plscptf_contact_message\">' . $plscptf_options['plscptf_message_label'] . '<span class=\"required\"> *</span></label>\r\n\t\t\t\t</div>';\r\n      if (isset($error_message['error_message'])) {\r\n        $content .= '<div class=\"error-form\">' . $error_message['error_message'] . '</div>';\r\n      }\r\n      $content .= '<div class=\"input\">\r\n\t\t\t\t\t<textarea rows=\"5\" cols=\"30\" name=\"plscptf_contact_message\" id=\"plscptf_contact_message\">' . $message . '</textarea>\r\n\t\t\t\t</div>';\r\n      if (isset($error_message['error_captcha'])) {\r\n        $content .= '<div class=\"error-form\">' . $error_message['error_captcha'] . '</div>';\r\n      }\r\n\r\n      $content .= PlusCaptcha_shortcode();\r\n\r\n      if ($plscptf_options['plscptf_send_copy'] == 1) {\r\n        $content .= '<div style=\"text-align: left;\">\r\n\t\t\t\t\t\t<input type=\"checkbox\" value=\"1\" name=\"plscptf_contact_send_copy\" id=\"plscptf_contact_send_copy\" style=\"text-align: left; margin: 0;\" ' . ( $send_copy == '1' ? \" checked=\\\"checked\\\" \" : \"\" ) . ' />\r\n\t\t\t\t\t\t<label for=\"plscptf_contact_send_copy\">' . __(\"Send me a copy\", 'PlusCaptcha') . '</label>\r\n\t\t\t\t\t</div>';\r\n      }\r\n\r\n      $content .= '<div style=\"text-align: left; padding-top: 8px;\">\r\n\t\t\t\t\t<input type=\"hidden\" value=\"send\" name=\"plscptf_contact_action\"><input type=\"hidden\" value=\"Version: 3.13\" />\r\n\t\t\t\t\t<input type=\"submit\" value=\"' . __(\"Submit\", 'PlusCaptcha') . '\" style=\"cursor: pointer; margin: 0pt; text-align: center;margin-bottom:10px;\" /> \r\n\t\t\t\t</div>\r\n\t\t\t\t</form>';\r\n    }\r\n    return $content;\r\n  }\r\n\r\n}\r\n//**********************************************************************************************************************\r\nif (!function_exists('plscptf_check_and_send')) {\r\n\r\n  function plscptf_check_and_send() {\r\n    //die ('plscptf_check_and_send'); \r\n    global $result;\r\n    $plscptf_options = get_option('PlusCaptcha_form_contact_options');\r\n    if (tags(isset($_REQUEST['plscptf_contact_action']))) {\r\n      // Check all input data\r\n      $result = plscptf_check_form();\r\n    }\r\n    if (true === $result) { // OK\r\n      $_SESSION['plscptf_send_mail'] = true;\r\n      if ($plscptf_options['plscptf_action_after_send'] == 0) {\r\n        wp_redirect($plscptf_options['plscptf_redirect_url']);\r\n        exit;\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n// Check PlusCaptcha Contact Form input data\r\nif (!function_exists('plscptf_check_form')) {\r\n\r\n  function plscptf_check_form() {\r\n    global $error_message;\r\n    global $plscptf_options;\r\n    if (empty($plscptf_options))\r\n      $plscptf_options = get_option('PlusCaptcha_form_contact_options');\r\n    $result = \"\";\r\n    // Error messages array\r\n    $error_message = array();\r\n    $error_message['error_name'] = __(\"Please input your name.\", 'PlusCaptcha');\r\n    $error_message['error_email'] = __(\"Please input your e-mail address.\", 'PlusCaptcha');\r\n    $error_message['error_subject'] = __(\"Subject required.\", 'PlusCaptcha');\r\n    $error_message['error_message'] = __(\"Message text required.\", 'PlusCaptcha');\r\n    $error_message['error_form'] = __(\"Please correct your input data below and try again.\", 'PlusCaptcha');\r\n    // Check information\r\n    if (\"\" != tags($_REQUEST['plscptf_contact_name']))\r\n      unset($error_message['error_name']);\r\n    if (\"\" != tags($_REQUEST['plscptf_contact_email']) && preg_match(\"/^(?:[a-z0-9]+(?:[a-z0-9\\-_\\.]+)?@[a-z0-9]+(?:[a-z0-9\\-\\.]+)?\\.[a-z]{2,5})$/i\", tags(trim($_REQUEST['plscptf_contact_email']))))\r\n      unset($error_message['error_email']);\r\n    if (\"\" != tags($_REQUEST['plscptf_contact_subject']))\r\n      unset($error_message['error_subject']);\r\n    if (\"\" != tags($_REQUEST['plscptf_contact_message']))\r\n      unset($error_message['error_message']);\r\n    \r\n    PlusCaptcha_validate_contact_form($error_message);\r\n\r\n    if (1 == count($error_message)) { // OK\r\n      unset($error_message['error_form']);\r\n      $result = plscptf_send_mail();\r\n    }\r\n\r\n    return $result;\r\n  }\r\n\r\n}\r\n\r\n// Send mail function\r\nif (!function_exists('plscptf_send_mail')) {\r\n\r\n  function plscptf_send_mail() {\r\n    global $plscptf_options, $path_of_uploaded_file;\r\n    $to = \"\";\r\n    if (isset($_SESSION['plscptf_send_mail']) && $_SESSION['plscptf_send_mail'] == true)\r\n      return true;\r\n    if ($plscptf_options['plscptf_select_email'] == 'user') {\r\n      if (function_exists('get_userdatabylogin') && false !== $user = get_userdatabylogin($plscptf_options['plscptf_user_email'])) {\r\n        $to = $user->user_email;\r\n      } else if (false !== $user = get_user_by('login', $plscptf_options_submit['plscptf_user_email']))\r\n        $to = $user->user_email;\r\n    }\r\n    else {\r\n      $to = $plscptf_options['plscptf_custom_email'];\r\n    }\r\n    if (\"\" == $to) {\r\n      // If email options are not certain choose admin email\r\n      $to = get_option(\"admin_email\");\r\n    }\r\n    if (\"\" != $to) {\r\n      // subject\r\n      $subject = tags($_REQUEST['plscptf_contact_subject']);\r\n      $user_info_string = '';\r\n      $userdomain = '';\r\n      $form_action_url = '';\r\n      $attachments = array();\r\n      $headers = \"\";\r\n\r\n      if (getenv('HTTPS') == 'on') {\r\n        $form_action_url = 'https://' . tags($_SERVER['HTTP_HOST']) . tags($_SERVER['REQUEST_URI']);\r\n      } else {\r\n        $form_action_url = 'http://' . tags($_SERVER['HTTP_HOST']) . tags($_SERVER['REQUEST_URI']);\r\n      }\r\n\r\n      if ($plscptf_options['plscptf_display_add_info'] == 1) {\r\n        $userdomain = gethostbyaddr(tags($_SERVER['REMOTE_ADDR']));\r\n        if ($plscptf_options['plscptf_display_add_info'] == 1 ||\r\n                $plscptf_options['plscptf_display_sent_from'] == 1 ||\r\n                $plscptf_options['plscptf_display_coming_from'] == 1 ||\r\n                $plscptf_options['plscptf_display_user_agent'] == 1) {\r\n          $user_info_string .= '<tr>\r\n\t\t\t\t\t\t\t<td><br /></td><td><br /></td>\r\n\t\t\t\t\t\t</tr>';\r\n        }\r\n        if ($plscptf_options['plscptf_display_sent_from'] == 1) {\r\n          $user_info_string .= '<tr>\r\n\t\t\t\t\t\t\t<td>' . __('Sent from (ip address)', 'PlusCaptcha') . ':</td><td>' . tags($_SERVER['REMOTE_ADDR']) . \" ( \" . $userdomain . \" )\" . '</td>\r\n\t\t\t\t\t\t</tr>';\r\n        }\r\n        if ($plscptf_options['plscptf_display_date_time'] == 1) {\r\n          $user_info_string .= '<tr>\r\n\t\t\t\t\t\t\t<td>' . __('Date/Time', 'PlusCaptcha') . ':</td><td>' . date_i18n(get_option('date_format') . ' ' . get_option('time_format'), strtotime(current_time('mysql'))) . '</td>\r\n\t\t\t\t\t\t</tr>';\r\n        }\r\n        if ($plscptf_options['plscptf_display_coming_from'] == 1) {\r\n          $user_info_string .= '<tr>\r\n\t\t\t\t\t\t\t<td>' . __('Coming from (referer)', 'PlusCaptcha') . ':</td><td>' . $form_action_url . '</td>\r\n\t\t\t\t\t\t</tr>';\r\n        }\r\n        if ($plscptf_options['plscptf_display_user_agent'] == 1) {\r\n          $user_info_string .= '<tr>\r\n\t\t\t\t\t\t\t<td>' . __('Using (user agent)', 'PlusCaptcha') . ':</td><td>' . plscptf_clean_input(tags($_SERVER['HTTP_USER_AGENT'])) . '</td>\r\n\t\t\t\t\t\t</tr>';\r\n        }\r\n      }\r\n      // message\r\n      $message = '\r\n\t\t\t<html>\r\n\t\t\t<head>\r\n\t\t\t\t<title>' . __(\"Contact from\", 'PlusCaptcha') . get_bloginfo('name') . '</title>\r\n\t\t\t</head>\r\n\t\t\t<body>\r\n\t\t\t\t<table>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td width=\"160\">' . __(\"Name\", 'PlusCaptcha') . '</td><td>' . tags($_REQUEST['plscptf_contact_name']) . '</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>' . __(\"Email\", 'PlusCaptcha') . '</td><td>' . tags($_REQUEST['plscptf_contact_email']) . '</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>' . __(\"Subject\", 'PlusCaptcha') . '</td><td>' . tags($_REQUEST['plscptf_contact_subject']) . '</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>' . __(\"Message\", 'PlusCaptcha') . '</td><td>' . tags($_REQUEST['plscptf_contact_message']) . '</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td>' . __(\"Site\", 'PlusCaptcha') . '</td><td>' . get_bloginfo(\"url\") . '</td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t<td><br /></td><td><br /></td>\r\n\t\t\t\t\t</tr>\r\n\t\t\t\t\t' . $user_info_string . '\r\n\t\t\t\t</table>\r\n\t\t\t</body>\r\n\t\t\t</html>\r\n\t\t\t';\r\n      if ($plscptf_options['plscptf_mail_method'] == 'wp-mail') {\r\n        // To send HTML mail, the Content-type header must be set\r\n        $headers = 'MIME-Version: 1.0' . \"\\r\\n\";\r\n        $headers .= 'Content-type: text/html; charset=utf-8' . \"\\r\\n\";\r\n\r\n        // Additional headers\r\n        $headers .= 'From: ' . tags($_REQUEST['plscptf_contact_email']) . \"\\r\\n\";\r\n        if (tags(isset($_REQUEST['plscptf_contact_send_copy'])) && tags($_REQUEST['plscptf_contact_send_copy']) == 1)\r\n          wp_mail(tags($_REQUEST['plscptf_contact_email']), stripslashes($subject), stripslashes($message), $headers, $attachments);\r\n\r\n        // Mail it\r\n        return wp_mail($to, stripslashes($subject), stripslashes($message), $headers, $attachments);\r\n      }\r\n      else {\r\n        // HTML e-mail, we should set Content-type header\r\n        $headers = 'MIME-Version: 1.0' . \"\\r\\n\";\r\n        $headers .= 'Content-type: text/html; charset=utf-8' . \"\\r\\n\";\r\n\r\n        // Additional headers\r\n        $headers .= 'From: ' . tags($_REQUEST['plscptf_contact_email']) . \"\\r\\n\";\r\n        if (tags(isset($_REQUEST['plscptf_contact_send_copy'])) && tags($_REQUEST['plscptf_contact_send_copy']) == 1)\r\n          @mail(tags($_REQUEST['plscptf_contact_email']), stripslashes($subject), stripslashes($message), $headers);\r\n\r\n        return @mail($to, stripslashes($subject), stripslashes($message), $headers);\r\n      }\r\n    }\r\n    return false;\r\n  }\r\n\r\n}\r\n\r\nfunction plscptf_clean_input($string, $preserve_space = 0) {\r\n  if (is_string($string)) {\r\n    if ($preserve_space) {\r\n      return plscptf_sanitize_string(strip_tags(stripslashes($string)), $preserve_space);\r\n    }\r\n    return trim(plscptf_sanitize_string(strip_tags(stripslashes($string))));\r\n  } else if (is_array($string)) {\r\n    reset($string);\r\n    while (list($key, $value ) = each($string)) {\r\n      $string[$key] = plscptf_clean_input($value, $preserve_space);\r\n    }\r\n    return $string;\r\n  } else {\r\n    return $string;\r\n  }\r\n}\r\n\r\n// protect and validate form vars\r\n\r\nfunction plscptf_sanitize_string($string, $preserve_space = 0) {\r\n  if (!$preserve_space)\r\n    $string = preg_replace(\"/ +/\", ' ', trim($string));\r\n\r\n  return preg_replace(\"/[<>]/\", '_', $string);\r\n}\r\n\r\nfunction plscptf_email_name_filter($data) {\r\n  global $plscptf_options;\r\n  if (isset($plscptf_options['plscptf_from_field']) && trim($plscptf_options['plscptf_from_field']) != \"\")\r\n    return stripslashes($plscptf_options['plscptf_from_field']);\r\n  else\r\n    return $data;\r\n}\r\n\r\nfunction PlusCaptcha_validate_contact_form(&$errors) {\r\n\tglobal $PlusCaptcha_instance;\r\n\t//$scValues = PlusCaptcha_get_values();\r\n\tif (get_result(simpleSessionGet(\"contacto_shortcode\", \"\"),true) != true ) {\r\n   \t\t$errors['error_captcha'] = '<strong>'.__( 'ERROR', 'PlusCaptcha' ) . '</strong>: ' . __(PlusCaptcha_ERROR_MESSAGE_BR, 'PlusCaptcha' );\r\n\t}else{\r\n\t\t//$_SESSION[\"passport\"] = false;\r\n\t}\r\n\treturn $errors;\r\n}\r\n\r\nadd_shortcode('im_helping_with_ecoplus', 'plscptf_display_form');\r\nadd_action('init', 'plscptf_check_and_send');\r\nadd_filter('wp_mail_from_name', 'plscptf_email_name_filter', 10, 1);\r\n\r\n?>", "=== PlusCaptcha ===\r\nContributors: PlusCaptcha\r\nVersion: 2.0.14\r\nTags: pluscaptcha, captcha, antispam, comment, catcha, registration, match captcha, lost password, login, spam, images captcha, capcha, captha, ecology, ecoplus, plus, buddypress, contact form 7, sweetcaptcha, text captcha, multilingual, register, admin, ajax, image, images, keycaptcha, plugin, post, akismet, wpmu, re captcha, recaptcha, wordpress captcha, picture captcha\r\nRequires at least: 3.0.0\r\nTested up to: 4.0.0\r\nStable tag: trunk\r\n\r\nPlusCaptcha - Forget the spam, ugly and complicated captchas! The Easiest Captcha to Setup and Execute, with Auto-Setup Feature! TRUSTED BY +27 THOUSAND OF WEBSITES, BLOGS, E-COMMERCE AND GOVERNMENT SITES AROUND WORLD WIDE! Free Full Service with 24/7 emergency support (emergency@pluscaptcha.com) with continuously updates!\r\n\r\n== Description ==\r\n\r\nThe first dinamic captcha provider. **Art to your visitors, simple tool to you!**\r\n\r\nAn evolution of the protection from bots and people without good intentions. Simple to install, simple to use, security at a click distance!\r\n\r\n= Features =\r\n\r\n**Mega Update!**:\r\n* New Easy to Read Dashboard!\r\n* Meet and Discover other Bloggers (and promote your)\r\n* Cleanest Interface\r\n* Cleanest Captcha\r\n\r\n* Simple to setup.\r\n* **NO MORE** maths, read words, colors, etc!\r\n* Automatic account generation **(NEW!)**.\r\n* Size, color, difficulty personalization.\r\n* No instructions needed to setup and operate **(NEW!)**.\r\n* Low bounce percentage.\r\n* Weekly upgrades.\r\n\r\n= Popular Browsers Support =\r\n\r\n* **IE** - IE6+\r\n* **Firefox** - All versions\r\n* **Chrome** - All versions\r\n* **Safari** - All versions\r\n* **Opera** - All versions\r\n* **Android (NEW!)** - All versions\r\n* **Mobile Safari (NEW!)** - All versions\r\n\r\n= Other Browsers Support (NEW!) =\r\n\r\n* AOL\r\n* **BlackBerry (NEW!)**\r\n* Camino\r\n* Dillo\r\n* Konqueror\r\n* Lynx\r\n* Mozilla\r\n* Netscape\r\n* Seamonkey\r\n* Shiira\r\n\r\n= Contact Options =\r\n\r\n* **General Info / Questions** - info[at]pluscaptcha.com\r\n* **Support / Bug** - support[at]pluscaptcha.com\r\n* **Emergency (24/7)** - emergency[at]pluscaptcha.com\r\n\r\n= Now you be part of Thousand Webmasters and Bloggers who Promote Ecology! =\r\n\r\nPlusCaptcha apart of be a CAPTCHA provider it's an conscientization tool. It's the biggest tool of concientization of the world. Imagine this: every webmaster when setup PlusCaptcha is helping with **EcoPlus** (name of the ecology project), every person who see the nature image becomes aware about the little and fragile world where we live.\r\n\r\n**Now, do you can see the Powerfull Tool what is PlusCaptcha?**\r\n\r\n= Because it's Simple from Every Point of View =\r\n\r\nSimple to install and use, and the most simple way to help the ecology.\r\n**Just download, activate and it's ready to use** but, if you wanna you can too personalize your account with: **color, size, difficulty and other options!**\r\n\r\n= Because is One Solution For All Devices =\r\n\r\n1. HTML5, to devices who support it.\r\n2. JQuery (Javascript), for a little percent of old browsers.\r\n3. Mail Validation, to all other browsers like of low-cost phones.\r\n\r\n= Because is Fully Integrated with WordPress =\r\n\r\n1. Integrated Form (with shortcode)\r\n2. Comment form\r\n3. Login form\r\n4. Lost password form\r\n\r\n= Because is the Evolution of the old and insecure CAPTCHAS. =\r\n\r\nThe **\"blind strip\" (unique technology from PlusCaptcha)** able us to provide the unique CAPTCHA immunity from bots.\r\n\r\n= Because is Free by 10 Years =\r\n\r\nWhen your free period expire in 10 years you will able to pay as you want, like a donation. **If not, no problem!** We will provide the same amazing service to you like the first day.\r\n\r\n= Because we have two big targets =\r\n\r\n1. Work together with your help to **save the ecology**.\r\n2. Be the most secure and armony CAPTCHA provider of the world.\r\n\r\n= Hey! You can help too! =\r\n\r\nHelp to us translating our website and able to share the oportunity to setup PlusCaptcha in another countries and thats will help to us with our ecology project and meet new developers and communities. Just contact us to: support[at]pluscaptcha.com\r\n\r\n== Installation ==\r\n\r\n1. Download the PlusCaptcha plugin or install it directly from your dashboard (just search \"PlusCaptcha\").\r\n\r\n2. Install and activate the plugin.\r\n\r\n3. Go to PlusCaptcha settings (under \"Settings\").\r\n\r\nAt this point, **your account was created automatically (NEW FEATURE!) and you don't need to do more!**, if not, you can do it with next steps:\r\n\r\n4. Create a New Account at www.pluscaptcha.com\r\n\r\n5. Paste the UUID (code by 9 characters).\r\n\r\n6. Save the Settings and Enjoy!\r\n\r\n**Remember (NEW FEATURE!): if your account was created automatically, you can personalize it with the user and password provided in the PlusCaptcha Settings Control Panel.**\r\n\r\n== Screenshots ==\r\n\r\n1. PlusCaptcha Dashboard Settings.\r\n2. PlusCaptcha in action!\r\n3. Customize your captcha!\r\n4. UUID Code Page!\r\n5. Advance Contact Form Setup\r\n\r\n== Requirements ==\r\n\r\n* Wordpress more than 2.8\r\n* Outside connection hosting by fopen().\r\n\r\n== Changelog ==\r\n\r\n= 2.0.10 =\r\n* Cross-site scripting (XSS) loged user side fixed. Thanks to Carlo Pelliccioni @ Hacktive Security\r\n\r\n= 2.0.6 =\r\n* Fixed security things reported by security.szurek.pl, Thanks!\r\n\r\n= 2.0.5 =\r\n* Padding footer fixed.\r\n* Padding form fixed.\r\n* Multiply themes audit.\r\nCredits: Mistakes reported to emergency@pluscaptcha.com (Thank to Claude @ NorwoodTeaParty.com)\r\n\r\n= 2.0.4 =\r\n* .Wrap and .W contextual style fixed.\r\n\r\n= 2.0.3 =\r\n* .Wrap color fixed.\r\n\r\n= 2.0.2 =\r\n* Provided more margin and change structure of comment form.\r\n* Fixed color letters in comment form.\r\n\r\n= 2.0.1 =\r\n* Fixed mistake provided by feedback to emergency@pluscaptcha.com (Thank to Claude @ NorwoodTeaParty.com)\r\n\r\n= 2.0.0 =\r\n* New Easy to Read Dashboard!\r\n* Meet and Discover other Bloggers (and promote your)\r\n* Cleanest Interface\r\n* Cleanest Captcha\r\n\r\n= 1.2.1 =\r\n* Default Hided Link\r\n\r\n= 1.2.0 =\r\n* Little Plugin Size Reduction.\r\n\r\n= 1.1.2 =\r\n* New: News section was added.\r\n\r\n= 1.1.1 =\r\n* New: List of Browsers Supported and New Features.\r\n* Edited information about the plugin.\r\n\r\n= 1.1 =\r\n* New: System to automatically PlusCaptcha account creation.\r\n* Fix: UTF-8 bug.\r\n\r\n= 1.0 =\r\n* Release version.\r\n* Do not forget feedback to support[at]pluscaptcha.com.\r\n\r\n== Upgrade Notice ==\r\n\r\n= 2.0.10 =\r\n* Cross-site scripting (XSS) loged user side fixed. Thanks to Carlo Pelliccioni @ Hacktive Security\r\n\r\n= 2.0.6 =\r\n* Fixed security things reported by security.szurek.pl, Thanks!\r\n\r\n= 1.2.1 =\r\nDefault Hide Backlin to Maintaining Good Aesthetics\r\n\r\n= 1.2.0 =\r\nLittle Plugin Size Reduction.\r\n\r\n= 1.1.2 =\r\nNews section was added.\r\n\r\n= 1.1.1 =\r\nList of browsers supported and new features.\r\n\r\n= 1.1 =\r\nImportant bug fixed.", "<!-- Additional options in admin PlusCaptcha Settings -->\r\n<?php\r\nglobal $error, $wpdb; \r\n$userslogin = $wpdb->get_col(\"SELECT user_login FROM  $wpdb->users \", 0);\r\n?>\r\n<script type=\"text/javascript\">\r\n\tjQuery(document).ready(function(){\r\n\t\tjQuery('#plscptf_additions_options').change( function() {\r\n\t\t\tif(jQuery(this).is(':checked') )\r\n\t\t\t\tjQuery('.plscptf_additions_block').removeClass('plscptf_hidden');\r\n\t\t\telse\r\n\t\t\t\tjQuery('.plscptf_additions_block').addClass('plscptf_hidden');\r\n\t\t});\r\n\t\tjQuery('#plscptf_change_label').change( function() {\r\n\t\t\tif(jQuery(this).is(':checked') )\r\n\t\t\t\tjQuery('.plscptf_change_label_block').removeClass('plscptf_hidden');\r\n\t\t\telse\r\n\t\t\t\tjQuery('.plscptf_change_label_block').addClass('plscptf_hidden');\r\n\t\t});\r\n\t\tjQuery('#plscptf_display_add_info').change( function() {\r\n\t\t\tif(jQuery(this).is(':checked') )\r\n\t\t\t\tjQuery('.plscptf_display_add_info_block').removeClass('plscptf_hidden');\r\n\t\t\telse\r\n\t\t\t\tjQuery('.plscptf_display_add_info_block').addClass('plscptf_hidden');\r\n\t\t});\r\n\t});\r\n</script>\r\n<div class=\"wrap\" style=\"padding-top: none;\" id=\"PlusCaptcha_form_contact_options\" style=\"<?php echo $display_cfoptions;?>\">\r\n  <div class=\"error\" style=\"width:99%; float: left; <?php if (empty($error)) echo 'display:none'; ?>\" ><p><strong><?php echo $error; ?></strong></p></div>\r\n  <br>\r\n  <table class=\"form-table\">\r\n    <tr valign=\"top\">\r\n      <th scope=\"row\" style=\"width:195px; color: white; text-shadow: none;\"><?php _e(\"Use email of wordpress user:\", 'PlusCaptcha'); ?> </th>\r\n      <td style=\"width:15px;\">\r\n        <input type=\"radio\" id=\"plscptf_select_email_user\" name=\"plscptf_select_email\" value=\"user\" <?php if ($plscptf_options['plscptf_select_email'] == 'user') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n      <td>\r\n        <select name=\"plscptf_user_email\" style=\"width:130px;\">\r\n          <option disabled><?php _e(\"Select user name\", 'PlusCaptcha'); ?></option>\r\n          <?php while (list( $key, $value ) = each($userslogin)) { ?>\r\n            <option value=\"<?php echo $value; ?>\" \r\n              <?php if ($plscptf_options['plscptf_user_email'] == $value) echo \"selected=\\\"selected\\\" \"; ?>><?php echo $value; ?>\r\n            </option>\r\n          <?php } ?>\r\n        </select>\r\n        <span class=\"plscptf_info\" style=\"font-family: sans-serif; font-size: 12px; font-style: italic; color: white; display: table; padding-left: 20px;\"><?php _e(\"Set a name of user who will get messages from a contact form.\", 'PlusCaptcha'); ?></span>\r\n      </td>\r\n    </tr>\r\n    <tr valign=\"top\">\r\n      <th scope=\"row\" style=\"color: white; text-shadow: none;\"><?php _e(\"Use this email:\", 'PlusCaptcha'); ?> </th>\r\n      <td>\r\n        <input type=\"radio\" id=\"plscptf_select_email_custom\" name=\"plscptf_select_email\" value=\"custom\" <?php if ($plscptf_options['plscptf_select_email'] == 'custom') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n      <td>\r\n        <input type=\"text\" name=\"plscptf_custom_email\" value=\"<?php echo $plscptf_options['plscptf_custom_email']; ?>\" onfocus=\"document.getElementById('plscptf_select_email_custom').checked = true;\" />\r\n        <span class=\"plscptf_info\" style=\"font-family: sans-serif; font-size: 12px; font-style: italic; color: white; display: table; padding-left: 20px;\"><?php _e(\"Set an email address which will be used for messages receiving.\", 'PlusCaptcha'); ?></span>\r\n      </td>\r\n    </tr>\r\n    <tr valign=\"top\">\r\n      <th colspan=\"3\" scope=\"row\" style=\"background-color: #DFDFE0; margin-top: 20px; display: block;\"><input type=\"checkbox\" id=\"plscptf_additions_options\" name=\"plscptf_additions_options\" style=\"margin-right: 30px;\"  value=\"1\" <?php if ($plscptf_options['plscptf_additions_options'] == '1') echo \"checked=\\\"checked\\\" \"; ?> /> <?php _e(\"Additional options\", 'PlusCaptcha'); ?></th>\r\n    </tr>\r\n\t\r\n</table> \r\n\r\n<table style=\"background-color: white; width: 100%; margin-top: 10px; color: #666666;\" class=\"plscptf_additions_block plscptf_hidden\"> \r\n\r\n\t\r\n\r\n    <tr valign=\"top\" class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <th scope=\"row\"><?php _e(\"Display Send me a copy block\", 'PlusCaptcha'); ?></th>\r\n      <td colspan=\"2\">\r\n        <input type=\"checkbox\" id=\"plscptf_send_copy\" name=\"plscptf_send_copy\" value=\"1\" <?php if ($plscptf_options['plscptf_send_copy'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n    </tr>\r\n    <tr class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <th rowspan=\"2\"><?php _e('What use?', 'PlusCaptcha'); ?></th>\r\n      <td>\r\n        <input type='radio' name='plscptf_mail_method' value='wp-mail' <?php if ($plscptf_options['plscptf_mail_method'] == 'wp-mail') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n      <td>\r\n        <?php _e('Wp-mail', 'mail-send'); ?> \r\n        <span  class=\"plscptf_info\">(<?php _e('To send mail you can use the wordpress wp_mail function', 'mail_send'); ?>)</span>\r\n      </td>\r\n    </tr>\r\n    <tr class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <td>\r\n        <input type='radio' name='plscptf_mail_method' value='mail' <?php if ($plscptf_options['plscptf_mail_method'] == 'mail') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n      <td>\r\n        <?php _e('Mail', 'mail-send'); ?> \r\n        <span  class=\"plscptf_info\">(<?php _e('To send mail you can use the php mail function', 'mail_send'); ?>)</span>\r\n      </td>\r\n    </tr>\r\n    <tr valign=\"top\" class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <th scope=\"row\"><?php _e(\"Change FROM fields of the contact form\", 'PlusCaptcha'); ?></th>\r\n      <td colspan=\"2\">\r\n        <input type=\"text\" style=\"width:200px;\" name=\"plscptf_from_field\" value=\"<?php echo stripslashes($plscptf_options['plscptf_from_field']); ?>\" /><br />\r\n      </td>\r\n    </tr>\r\n    <tr valign=\"top\" class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <th scope=\"row\"><?php _e(\"Display additional info in email\", 'PlusCaptcha'); ?></th>\r\n      <td>\r\n        <input type=\"checkbox\" id=\"plscptf_display_add_info\" name=\"plscptf_display_add_info\" value=\"1\" <?php if ($plscptf_options['plscptf_display_add_info'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n      <td class=\"plscptf_display_add_info_block <?php if ($plscptf_options['plscptf_display_add_info'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n        <input type=\"checkbox\" id=\"plscptf_display_sent_from\" name=\"plscptf_display_sent_from\" value=\"1\" <?php if ($plscptf_options['plscptf_display_sent_from'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/> <span style=\"margin-left: 10px;\" class=\"plscptf_info\"><?php _e(\"Sent from (ip address)\", 'PlusCaptcha'); ?></span><br />\r\n        <input type=\"checkbox\" id=\"plscptf_display_date_time\" name=\"plscptf_display_date_time\" value=\"1\" <?php if ($plscptf_options['plscptf_display_date_time'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/> <span style=\"margin-left: 10px;\" class=\"plscptf_info\"><?php _e(\"Date/Time\", 'PlusCaptcha'); ?></span><br />\r\n        <input type=\"checkbox\" id=\"plscptf_display_coming_from\" name=\"plscptf_display_coming_from\" value=\"1\" <?php if ($plscptf_options['plscptf_display_coming_from'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/> <span style=\"margin-left: 10px;\" class=\"plscptf_info\"><?php _e(\"Coming from (referer)\", 'PlusCaptcha'); ?></span><br />\r\n        <input type=\"checkbox\" id=\"plscptf_display_user_agent\" name=\"plscptf_display_user_agent\" value=\"1\" <?php if ($plscptf_options['plscptf_display_user_agent'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/> <span style=\"margin-left: 10px;\" class=\"plscptf_info\"><?php _e(\"Using (user agent)\", 'PlusCaptcha'); ?></span><br />\r\n      </td>\r\n    </tr>\r\n    <tr valign=\"top\" class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <th scope=\"row\"><?php _e(\"Change label for fields of the contact form\", 'PlusCaptcha'); ?></th>\r\n      <td>\r\n        <input type=\"checkbox\" id=\"plscptf_change_label\" name=\"plscptf_change_label\" value=\"1\" <?php if ($plscptf_options['plscptf_change_label'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/>\r\n      </td>\r\n      <td class=\"plscptf_change_label_block <?php if ($plscptf_options['plscptf_change_label'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n        <div style=\"width: 200px;\">\r\n\t\t\t<input type=\"text\" name=\"plscptf_name_label\" value=\"<?php echo $plscptf_options['plscptf_name_label']; ?>\" style=\"float: right;\" /> <span class=\"plscptf_info\"><?php _e(\"Name:\", 'PlusCaptcha'); ?></span>\r\n\t\t</div>\r\n\t\t<br />\r\n        <div style=\"width: 200px;\">\r\n\t\t\t<input type=\"text\" name=\"plscptf_email_label\" value=\"<?php echo $plscptf_options['plscptf_email_label']; ?>\" style=\"float: right;\" /> <span class=\"plscptf_info\"><?php _e(\"E-Mail Address:\", 'PlusCaptcha'); ?></span>\r\n\t\t</div>\r\n\t\t<br />\r\n        <div style=\"width: 200px;\">\r\n\t\t<input type=\"text\" name=\"plscptf_subject_label\" value=\"<?php echo $plscptf_options['plscptf_subject_label']; ?>\" style=\"float: right;\" /> <span class=\"plscptf_info\"><?php _e(\"Subject:\", 'PlusCaptcha'); ?></span>\r\n\t\t</div>\r\n\t\t<br />\r\n        <div style=\"width: 200px;\">\r\n\t\t<input type=\"text\" name=\"plscptf_message_label\" value=\"<?php echo $plscptf_options['plscptf_message_label']; ?>\" style=\"float: right;\" /> <span class=\"plscptf_info\"><?php _e(\"Message:\", 'PlusCaptcha'); ?></span>\r\n\t\t</div>\r\n      </td>\r\n    </tr>\r\n    <tr valign=\"top\" class=\"plscptf_additions_block <?php if ($plscptf_options['plscptf_additions_options'] == '0') echo \"plscptf_hidden\"; ?>\">\r\n      <th scope=\"row\"><?php _e(\"Action after the send mail\", 'PlusCaptcha'); ?></th>\r\n      <td colspan=\"2\" class=\"plscptf_action_after_send_block\">\r\n\t  \r\n\t  \t<div>\r\n        <input style=\"float: left;\" type=\"radio\" id=\"plscptf_action_after_send\" name=\"plscptf_action_after_send\" value=\"1\" <?php if ($plscptf_options['plscptf_action_after_send'] == '1') echo \"checked=\\\"checked\\\" \"; ?>/> <span class=\"plscptf_info\"><?php _e(\"Display text\", 'PlusCaptcha'); ?></span>\r\n        <input style=\"margin-left: 20px; margin-right: 10px;\" type=\"text\" name=\"plscptf_thank_text\" value=\"<?php echo $plscptf_options['plscptf_thank_text']; ?>\" /> <span class=\"plscptf_info\"><?php _e(\"Text\", 'PlusCaptcha'); ?></span>\r\n\t\t</div>\r\n\t\t\r\n\t\t<br />\r\n\t\t\r\n\t\t<div>\r\n        <input style=\"float: left;\"  type=\"radio\" id=\"plscptf_action_after_send\" name=\"plscptf_action_after_send\" value=\"0\" <?php if ($plscptf_options['plscptf_action_after_send'] == '0') echo \"checked=\\\"checked\\\" \"; ?>/> <span class=\"plscptf_info\"><?php _e(\"Redirect to page\", 'PlusCaptcha'); ?></span>\r\n        <input style=\"margin-left: 20px; margin-right: 10px;\" type=\"text\" name=\"plscptf_redirect_url\" value=\"<?php echo $plscptf_options['plscptf_redirect_url']; ?>\" /> <span class=\"plscptf_info\"><?php _e(\"Url\", 'PlusCaptcha'); ?></span><br />\r\n\t\t</div>\r\n\t\t\r\n      </td>\r\n\t  \r\n\t  \r\n\t  \r\n  </table>    \r\n</div>\r\n", "<?php\r\n\r\nif (!function_exists('tags')) {\r\n\t# Clean\r\n\t# Limpiar data\r\n\tfunction tags($tags){  \r\n\t\t$tags = strip_tags($tags);  \r\n\t\t$tags = stripslashes($tags);  \r\n\t\t$tags = htmlentities($tags);\r\n\t\t$tags = addslashes($tags);\r\n\t\treturn trim($tags);  \r\n\t}\r\n}\r\n\r\n$status = @fgets(@fopen(\"http://www.pluscaptcha.com/status/\", 'r'), 4096);\r\n\r\n/**\r\n* Guardar data del blog para mejorar la experiencia\r\n**/\r\n\r\nif( get_option('PlusCaptcha_feedback_quemejoraria', '') != get_option('actual_PlusCaptcha_feedback_quemejoraria', '') )\r\n{\r\n\t// Enviar feedback\r\n\t$url = 'http://www.pluscaptcha.com/api/wp_log/feedback?'\r\n\t\t.'quemejorar='.substr(str_replace(\".\",\"[dot]\",urlencode(tags($_POST[\"PlusCaptcha_feedback_quemejoraria\"]))),0,299).\r\n\t\t'&uuid='.get_option( 'uuid_api_wp_feedback' ).'';\r\n\t\t@fgets(@fopen($url, 'r'), 4096);\r\n\t// Guardar Feedback en forma local\r\n\tupdate_option('actual_PlusCaptcha_feedback_quemejoraria', get_option('PlusCaptcha_feedback_quemejoraria', ''));\r\n}\r\n\r\n\r\n?>\r\n\r\n<?php\r\nif( $message != \"\" && $status || strlen(get_option('uuid_key_speci_to_generate_captchas', '')) < 9 && $status ) \r\n{\r\n?>\r\n\t<script  type=\"text/javascript\">\r\n\t  jQuery(document).ready(function($) {\r\n\t\t$('#ShortData').hide('fast');\r\n\t  });\r\n\t</script>\r\n<?php\r\n}else{\r\n?>\r\n\t<script  type=\"text/javascript\">\r\n\t  jQuery(document).ready(function($) {\r\n\t\t$('#Advance').hide();\r\n\t  });\r\n\t</script>\r\n<?php\r\n}\r\n?>\r\n\r\n<div class=\"w_private\">\r\n\t<div class=\"wrap_private\" style=\"padding-top: 30px; margin-top: 20px;\">\r\n\t\t\r\n\t\t<style type=\"text/css\">\r\n\t\t.ShortData .Data {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 431px;\r\n\t\t\t/**/\r\n\t\t\toverflow: display;\r\n\t\t}\r\n\t\t.ShortData .Data h1 {\r\n\t\t\tfont-family: Arial;\r\n\t\t\tfont-size: 44px;\r\n\t\t\tfont-weight: bold;\r\n\t\t\t/**/\r\n\t\t\twidth: 100%;\r\n\t\t\ttext-align: center;\r\n\t\t\t/**/\r\n\t\t\theight: 50px;\r\n\t\t\tline-height: 50px;\r\n\t\t\t/**/\r\n\t\t\tcolor: white;\r\n\t\t\t/**/\r\n\t\t\tmargin: 0px;\r\n\t\t\tmargin-top: 10px; /*rewrite*/\r\n\t\t}\r\n\t\t.ShortData .Data h3 {\r\n\t\t\tfont-family: Arial;\r\n\t\t\tfont-size: 14px;\r\n\t\t\tfont-weight: bold;\r\n\t\t\t/**/\r\n\t\t\twidth: 100%;\r\n\t\t\ttext-align: center;\r\n\t\t\t/**/\r\n\t\t\theight: 20px;\r\n\t\t\tline-height: 20px;\r\n\t\t\t/**/\r\n\t\t\tcolor: white;\r\n\t\t\t/**/\r\n\t\t\tmargin: 0px;\r\n\t\t}\r\n\t\t.ShortData .BoxSites{\r\n\t\t\twidth: 90%;\r\n\t\t\tmargin-left: 5%;\r\n\t\t\tmargin-right: 5%;\r\n\t\t\t/**/\r\n\t\t\theight: 200px;\r\n\t\t\t/**/\r\n\t\t\tmargin-top: 40px;\r\n\t\t\tmargin-bottom: 20px;\r\n\t\t\t/**/\r\n\t\t\tborder-top: 1px solid white;\r\n\t\t\tborder-bottom: 1px solid white;\r\n\t\t\t/**/\r\n\t\t\toverflow: display;\r\n\t\t}\r\n\t\t.ShortData .BoxSites a{\r\n\t\t\tcolor: #5AD1F3;\r\n\t\t\r\n\t\t}\r\n\t\t.ShortData .BoxSites a:hover{\r\n\t\t\ttext-decoration: underline;\r\n\t\t\tcolor: #0f9ec7;\r\n\t\t}\r\n\t\t.300 {\r\n\t\t\twidth: 300px; \r\n\t\t\tmargin: auto; \r\n\t\t}\r\n\t\t.ShortData .BoxMore{\r\n\t\t\twidth: 90%;\r\n\t\t\tmargin-left: 5%;\r\n\t\t\tmargin-right: 5%;\r\n\t\t\t/**/\r\n\t\t\theight: 110px;\r\n\t\t\t/**/\r\n\t\t\tmargin-top: 20px;\r\n\t\t\tmargin-bottom: 20px;\r\n\t\t\t/**/\r\n\t\t}\r\n\t\t.ShortData .BoxMore .BoxBtn{\r\n\t\t\twidth: 50%;\r\n\t\t\theight: 110px;\r\n\t\t\t/**/\r\n\t\t\tfloat: left;\r\n\t\t}\r\n\t\t.ShortData .BoxMore .BoxBtn a{\r\n\t\t\twidth: 80%;\r\n\t\t\tmargin: 30px 10% 30px 10%;\r\n\t\t\t/**/\r\n\t\t\theight: 60px;\r\n\t\t\tline-height: 60px;\r\n\t\t\t/**/\r\n\t\t\tbackground: #009cff;\r\n\t\t\t/**/\r\n\t\t\tfont-family: Arial;\r\n\t\t\tfont-size: 18px;\r\n\t\t\tfont-weight: bold;\r\n\t\t\tcolor: white;\r\n\t\t\ttext-decoration: none;\r\n\t\t\t/**/\r\n\t\t\ttext-align: center;\r\n\t\t\t/**/\r\n\t\t\tdisplay: block;\r\n\t\t\t/**/\r\n\t\t\tcursor: pointer;\r\n\t\t}\r\n\t\t.ShortData .BoxMore .BoxBtn a:hover{\r\n\t\t\tbackground: #008ce5;\r\n\t\t}\r\n\t\t</style>\r\n\t\t\r\n\t\t<div id=\"ShortData\" class=\"ShortData\">\r\n\t\t\t<?php\r\n\t\t\tif($status) {\r\n\t\t\t?>\r\n\t\t\t\t<div class=\"LogoRun\"></div>\r\n\t\t\t<?php }else{ ?>\r\n\t\t\t\t<div class=\"LogoPaused\"></div>\r\n\t\t\t<?php } ?>\r\n\t\t\t<div class=\"Data\">\r\n\t\t\t\t<h1><?php echo ($status) ? 'SERVICE IS RUNNING' : 'IN BRIEF MAINTENANCE'; ?></h1>\r\n\t\t\t\t<h3><?php echo ($status) ? 'CHECK YOUR COMMENT FORM' : 'PLEASE COME BACK IN 30 MINUTES'; ?></h3>\r\n\t\t\t\t<div class=\"BoxSites\" style=\"text-align: center;\">\r\n\t\t\t\t\t<h3 class=\"300\" style=\"width: 370px; margin: auto; margin-top: -10px; background: #00609b; display: table;\">WHO TRUST IN PLUSCAPTCHA TOO? (BY RANDOM)</h3>\r\n\t\t\t\t\t<?php\r\n\t\t\t\t\t\techo @fgets(@fopen(\"http://www.pluscaptcha.com/api/wp_log/who_use_plugin.php\", 'r'), 4096);\t\t\t\t\t\r\n\t\t\t\t\t?>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"BoxMore\">\r\n\t\t\t\t\t<div class=\"BoxBtn\">\r\n\t\t\t\t\t\t<?php if($status) { ?>\r\n\t\t\t\t\t\t\t<a onclick=\"jQuery(document).ready(function($) { \r\n\t\t\t\t\t\t\t\t$('#ShortData').hide('fast'); \r\n\t\t\t\t\t\t\t\t$('#Advance').show('slow');\r\n\t\t\t\t\t\t\t});\">Advance Options</a>\r\n\t\t\t\t\t\t<?php }else{ ?>\r\n\t\t\t\t\t\t\t<a style=\"background-color:#999999; cursor: auto;\">In Mantenience</a>\r\n\t\t\t\t\t\t<?php } ?>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"BoxBtn\" style=\"text-align: right;\">\r\n\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t<strong>Information</strong> - info@pluscaptcha.com<br />\r\n\t\t\t\t\t\t\t<strong>Support</strong> - support@pluscaptcha.com<br />\r\n\t\t\t\t\t\t\t<strong>In case of Emergency (24/7)</strong><br />\r\n\t\t\t\t\t\t\temergency@pluscaptcha.com\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\r\n\t\t<div id=\"Advance\">\r\n\t\t\r\n\t\t\t<!--\r\n\t\t\t<div style=\"margin-bottom: 30px;\">\r\n\t\t\t\t<div class=\"icon32 icon32-bws\" id=\"icon-options-PlusCaptcha\"></div>\r\n\t\t\t\t<h2 style=\"height: 100%; padding-left: 200px; padding-top: 20px; line-height: 40px; text-shadow: none; color: white;\"><?php _e('At a turn of the best security.', 'PlusCaptcha'); ?></h2>\r\n\t\t\t</div>\r\n\t\t\t-->\r\n\t\t\t\r\n\t\t  <?php if (!empty($message)): ?>\r\n\t\t\t<div class=\"updated\" style=\"width:91%; float: left; background-color: #FFFF99; padding-top: 30px; padding-bottom: 30px; color: #393939; border: none; padding-left: 10%; margin-left: 0px; margin-bottom: 20px; display: table;\">\r\n\t\t\t  <p><strong><?php echo $message; ?></strong></p>\r\n\t\t\t</div>\r\n\t\t\t<br />\r\n\t\t  <?php endif; ?>\r\n\t\t\t\r\n\t\t\t<div class=\"informacion\">\r\n\t\t\t\t<p style=\"margin-top: 5px; \"><?php _e('Congratulations on your new PlusCaptcha!', 'PlusCaptcha'); ?></p>\r\n\t\t\t\t<p>Translate this panel to other languajes: <a>Not available in other languages by this moment!</a></p>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t\r\n\t\t<?php\r\n\t\tif(\r\n\t\t\tget_option( 'uuid_api_wp_feedback' ) != \"\" && \r\n\t\t\tget_option( 'registered_account_from_api' ) == true && \r\n\t\t\tget_option( 'pluscaptcha_account_user' ) != \"\" && \r\n\t\t\tget_option( 'pluscaptcha_account_password' ) != \"\"\r\n\t\t)\r\n\t\t{\r\n\t\t?>\r\n\t\t  <!-- Box Personalice -->\r\n\t\t  <div id=\"personalizacion\">\r\n\t\t\t<div id=\"right-content-pers\">\r\n\t\t\t\t<span>\r\n\t\t\t\t\tPersonalize your account logging to \r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<a href=\"http://en.pluscaptcha.com/login\" target=\"_blank\"><strong style=\"border: 0px;\">en.pluscaptcha.com/login</strong></a> with this mail:\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<strong><?php echo get_option( 'pluscaptcha_account_user' ); ?></strong>\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\tand this password:\r\n\t\t\t\t\t<br />\r\n\t\t\t\t\t<strong><?php echo get_option( 'pluscaptcha_account_password' ); ?></strong> \r\n\t\t\t\t</span>\r\n\t\t\t\t<br />\r\n\t\t\t\t<span style=\"font-size: 12px; line-height: normal; margin-top: 10px; display: table;\">\r\n\t\t\t\t\t(this account was generated automatically for you!,\r\n\t\t\t\t\t<br>\r\n\t\t\t\t\twhen you finish, just update your ID of 9 Characters and it's ready!)\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t  </div>\t  \r\n\t\t  <!-- --->\t \r\n\t\t  \r\n\t\t  <?php }elseif( get_option( 'registered_account_from_api' ) != true && get_option('uuid_key_speci_to_generate_captchas', '') == \"\" ){ ?> \r\n\t\t  \r\n\t\t  <!-- Box Instrucciones -->\r\n\t\t  <div id=\"boxinstructions\">\r\n\t\t\t<div style=\"width: 960px; height: 115px; display: table;\">\r\n\t\t\t\t<div style=\"float: left; font-family: Arial; color: #666666; font-size: 14px; margin-left: 238px; margin-top: 47px;\">\r\n\t\t\t\t\ten\r\n\t\t\t\t</div>\r\n\t\t\t\t<div style=\"float: left; font-family: Arial; color: white; font-size: 14px; margin-left: 435px; margin-top: 45px;\">\r\n\t\t\t\t\tNew Account\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<style type=\"text/css\">\r\n\t\t\t\t.ecoplus {\r\n\t\t\t\t\tcolor: #82c7ff;\r\n\t\t\t\t\ttext-decoration: none;\r\n\t\t\t\t}\r\n\t\t\t\t.ecoplus:hover {\r\n\t\t\t\t\tcolor: #249dff;\r\n\t\t\t\t}\r\n\t\t\t</style>\r\n\t\t\t<div style=\"width: 960px; height: 115px;\">\r\n\t\t\t\t<div style=\"float: left; font-family: Arial; color: white; font-size: 35px; font-weight: bold; margin-left: 600px; margin-top: 45px;\">\r\n\t\t\t\t\tEnjoy of <a class=\"ecoplus\" href=\"http://blog.pluscaptcha.com/un-plus-humano/\" target=\"_blank\">EcoPlus</a>!\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t  </div>\r\n\t\t  <!-- --->\r\n\t\t  \r\n\t\t  <?php } ?>\r\n\t\t\r\n\t\t  <form name=\"form1\" method=\"post\" action=\"\">\r\n\t\t\t<input type=\"hidden\" name=\"<?php echo $hidden_field_name; ?>\" value=\"Y\">\r\n\t\t\t<table class=\"form-table\">\r\n\t\t\t  <tbody>\r\n\t\t\t\t<?php\r\n\t\t\t\tif (!empty($PlusCaptcha_options) && is_array($PlusCaptcha_options)):\r\n\t\t\t\t  foreach ($PlusCaptcha_options as $opt_name => $opt):\r\n\t\t\t\t?>\r\n\t\t\t\t<tr valign=\"top\">\r\n\t\t\t\t  <th scope=\"row\" style=\"min-width: 15%\"><label style=\"color: white;\" for=\"<?php echo $opt_name ?>\"><?php echo $opt['title'] . ':'; ?></label></th>\r\n\t\t\t\t  <?php\r\n\t\t\t\t\tif (!substr_count($opt_name, '_form_')) {\r\n\t\t\t\t\t  $type = 'text';\r\n\t\t\t\t\t  $checked = null;\r\n\t\t\t\t\t  $class = ' class=\"regular-text\"';\r\n\t\t\t\t\t  $value = isset($options_values[$opt_name]) ? $options_values[$opt_name] : null;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t  $type = 'checkbox';\r\n\t\t\t\t\t  $checked = isset($options_values[$opt_name]) && !empty($options_values[$opt_name]) ? ' checked=\"checked\"' : null;\r\n\t\t\t\t\t  $class = null;\r\n\t\t\t\t\t  $value = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t  ?>\r\n\t\t\t\t  <td>\r\n\t\t\t\t\t<input<?php echo $class ?> id=\"<?php echo $opt_name ?>\" type=\"<?php echo $type ?>\" name=\"<?php echo $opt_name ?>\" value=\"<?php echo $value ?>\" size=\"50\"<?php echo $checked ?>  \r\n\t\t\t\t\t<?php echo $opt['maxchars']; ?> <? \r\n\t\t\t\t\tif($opt['disabled']){ \r\n\t\t\t\t\t\techo 'checked=\"checked\" disabled'; \r\n\t\t\t\t\t}else{ \r\n\t\t\t\t\t\techo '/'; // Noquitar\r\n\t\t\t\t\t}\r\n\t\t\t\t\t?>>\r\n\t\t\t\t\t<?php if (isset($PlusCaptcha_options[$opt_name]['description'])): ?>\r\n\t\t\t\t\t<span class=\"description\">\r\n\t\t\t\t\t<?php echo $PlusCaptcha_options[$opt_name]['description']; ?>\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<?php endif; ?>\r\n\t\t\t\t  </td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t\r\n\t\t\t\t<?php if ($opt_name == 'PlusCaptcha_form_contact') { ?>\r\n\t\t\t\t<tr>\r\n\t\t\t\t  <td colspan=\"2\" style=\"padding-top: 0px; padding-left: 20px;\">\r\n\t\t\t\t  <?php\r\n\t\t\t\t  $display_cfoptions = ''; //( $checked ) ? '' : 'display:none;';\r\n\t\t\t\t  include 'admin-options-contactform.php';\r\n\t\t\t\t  ?>\r\n\t\t\t\t  </td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<?php } ?>\r\n\t\t\t\t\r\n\t\t\t\t<?php\r\n\t\t\t\t  endforeach;\r\n\t\t\t\tendif;\r\n\t\t\t\t?>\r\n\t\t\t  </tbody>\r\n\t\t\t</table>\r\n\t\t\t\r\n\t\t\t<style type=\"text/css\">\r\n\t\t\t\ta {\r\n\t\t\t\t\ttext-decoration: none;\r\n\t\t\t\t}\r\n\t\t\t\ta:focus {\r\n\t\t\t\t\ttext-decoration: none;\r\n\t\t\t\t\tcolor: #2980c7;\r\n\t\t\t\t}\r\n\t\t\t\ta:hover, a:active {\r\n\t\t\t\t\ttext-decoration: none;\r\n\t\t\t\t\tcolor: #005da8;\r\n\t\t\t\t}\r\n\t\t\t</style>\r\n\t\t\r\n\t\t\t<p class=\"submit\" style=\"margin-top: 10px;\">\r\n\t\t\t  <input type=\"submit\" name=\"Submit\" class=\"button-primary\" value=\"<?php esc_attr_e('Save Changes') ?>\" />\r\n\t\t\t</p>\r\n\t\t\t<p style=\"margin-top: 30px; padding-top: 10px; border-top: 1px dashed white; display: block;\">\r\n\t\t\t  <strong>If you have a translate suggestion or another, please <a href=\"http://en.pluscaptcha.com/contacto\" target=\"_blank\">contact us.</a></strong>\r\n\t\t\t</p>\r\n\t\t  </form>\r\n\t\t  </div>\r\n\t</div>\r\n</div>", "<?php\r\n\r\nif (!function_exists('tags')) {\r\n\t# Clean\r\n\t# Limpiar data\r\n\tfunction tags($tags){  \r\n\t\t$tags = strip_tags($tags);  \r\n\t\t$tags = stripslashes($tags);  \r\n\t\t$tags = htmlentities($tags);\r\n\t\t$tags = addslashes($tags);\r\n\t\treturn trim($tags);  \r\n\t}\r\n}\r\n\r\n?>\r\n<style type=\"text/css\">\r\n#register_message {\r\n\tmargin-bottom: 10px;\r\n}\r\n\r\n#register_explanation {\r\n\tmargin-top: 10px;\r\n}\r\n\r\n#register table {\r\n\tborder-collapse: collapse;\r\n\twidth: 100%;\r\n}\r\n\r\n#register table td.left {\r\n\ttext-transform: capitalize;\r\n\tpadding-left: 10px;\r\n\ttext-align: left;\r\n\twidth: 160px;\r\n\t/*min-width: 25%;*/\r\n}\r\n\r\n#register table td.right {\r\n\ttext-align: left;\r\n\tpadding: 8px 10px;\r\n}\r\n\r\n#register input[type=text] {\r\n\twidth: 300px;\r\n}\r\n\r\n#register select {\r\n\twidth: 300px;\r\n}\r\n\r\n</style>\r\n<script type=\"text/javascript\">\r\njQuery(document).ready(function() {\r\n  jQuery('#register_submit').click(function () {\r\n  \t\tjQuery(\"form#register .error\").remove();\r\n    \tvar hasError = false;\r\n      jQuery(\".requiredField\").each(function() {\r\n  \t\t\tif(jQuery.trim(jQuery(this).val()) == '') {\r\n          if ( jQuery(this).attr('name') == 'site_category' ) {\r\n            jQuery(this).after('<span class=\"error\">Please choose something and then press `Continue`</span>');\r\n          } else {\r\n            jQuery(this).after('<span class=\"error\">*</span>');\r\n          }\r\n        \thasError = true;\r\n  \t\t\t} else \r\n        if ( jQuery(this).attr('name') == 'email' ) {\r\n    \t\t\tvar emailReg = /^([\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4})?$/;\r\n      \t\tif ( ! emailReg.test(jQuery.trim(jQuery(this).val())) ) {\r\n        \t\tjQuery(this).after('<span class=\"error\">You entered an invalid email</span>');\r\n  \t\t\t\t\thasError = true;\r\n    \t\t\t}\r\n      \t}\r\n      });\r\n      if ( ! hasError ) {\r\n        jQuery('form#register').submit();\r\n      }\r\n  });\r\n});\r\n\r\n</script>\r\n<div class=\"wrap\">\r\n\t<h2><?php _e( 'Register to PlusCaptcha', 'PlusCaptcha' ); ?></h2>\r\n\r\n\t<?php echo $form_html; ?>\r\n\r\n\t<p class=\"submit\">\r\n\t\t<input type=\"button\" id=\"register_submit\" name=\"Submit\" class=\"button-primary\" value=\"<?php esc_attr_e('Continue') ?>\" />\r\n\t\t&nbsp;or <a href=\"options-general.php?page=PlusCaptcha&skip_register=1\">skip</a> if you are already registered.\r\n\t</p>\r\n</div>\r\n"], "filenames": ["PlusCaptcha.php", "external/comment-form-inline-errors.php", "library/admin.php", "library/public.php", "library/shortcode-and-others.php", "readme.txt", "template/admin-options-contactform.php", "template/admin-options.php", "template/admin-register.php"], "buggy_code_start_loc": [6, 50, 3, 1, 3, 3, 2, 1, 0], "buggy_code_end_loc": [30, 60, 361, 357, 291, 186, 3, 14, 0], "fixing_code_start_loc": [6, 50, 3, 2, 3, 3, 2, 2, 1], "fixing_code_end_loc": [43, 60, 363, 369, 293, 193, 3, 26, 16], "type": "CWE-79", "message": "A vulnerability was found in PlusCaptcha Plugin up to 2.0.6 on WordPress and classified as problematic. Affected by this issue is some unknown functionality. The manipulation leads to cross site scripting. The attack may be launched remotely. Upgrading to version 2.0.14 is able to address this issue. The patch is identified as 1274afc635170daafd38306487b6bb8a01f78ecd. It is recommended to upgrade the affected component. VDB-248954 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2015-10127", "sourceIdentifier": "cna@vuldb.com", "published": "2023-12-26T17:15:07.923", "lastModified": "2024-02-29T01:16:12.707", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "A vulnerability was found in PlusCaptcha Plugin up to 2.0.6 on WordPress and classified as problematic. Affected by this issue is some unknown functionality. The manipulation leads to cross site scripting. The attack may be launched remotely. Upgrading to version 2.0.14 is able to address this issue. The patch is identified as 1274afc635170daafd38306487b6bb8a01f78ecd. It is recommended to upgrade the affected component. VDB-248954 is the identifier assigned to this vulnerability."}, {"lang": "es", "value": "Se encontr\u00f3 una vulnerabilidad en PlusCaptcha Plugin hasta 2.0.6 en WordPress y se clasific\u00f3 como problem\u00e1tica. Una funci\u00f3n desconocida es afectada por este problema. La manipulaci\u00f3n conduce a cross site scripting. El ataque puede lanzarse de forma remota. La actualizaci\u00f3n a la versi\u00f3n 2.0.14 puede solucionar este problema. El parche se identifica como 1274afc635170daafd38306487b6bb8a01f78ecd. Se recomienda actualizar el componente afectado. VDB-248954 es el identificador asignado a esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:bestwebsoft:pluscaptcha:*:*:*:*:*:wordpress:*:*", "versionEndIncluding": "2.0.6", "matchCriteriaId": "025F3EF5-30CF-4A2F-A5C8-CD24C5E641C7"}]}]}], "references": [{"url": "https://github.com/wp-plugins/pluscaptcha/commit/1274afc635170daafd38306487b6bb8a01f78ecd", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.248954", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.248954", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/wp-plugins/pluscaptcha/commit/1274afc635170daafd38306487b6bb8a01f78ecd"}}