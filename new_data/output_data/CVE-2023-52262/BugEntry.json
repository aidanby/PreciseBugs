{"buggy_code": ["<!doctype html>\n\n<!-- Author: Dmitri Popov, dmpop@linux.com; Stefan Saam, github@saams.de\n         License: GPLv3 https://www.gnu.org/licenses/gpl-3.0.txt -->\n\n<?php\n\t$WORKING_DIR=dirname(__FILE__);\n\t$config = parse_ini_file(\"$WORKING_DIR/config.cfg\", false);\n\t$config_standard = parse_ini_file(\"$WORKING_DIR/config-standards.cfg\", false);\n\t$constants = parse_ini_file(\"constants.sh\", false);\n\n\t$theme = $config[\"conf_THEME\"];\n\t$background = $config[\"conf_BACKGROUND_IMAGE\"] == \"\"?\"\":\"background='\" . $constants[\"const_MEDIA_DIR\"] .'/' . $constants[\"const_BACKGROUND_IMAGES_DIR\"] . \"/\" . $config[\"conf_BACKGROUND_IMAGE\"] . \"'\";\n\n\tinclude(\"sub-popup.php\");\n\n\tinclude(\"get-cloudservices.php\");\n\n\t$TIME_ZONE_old\t= $config[\"conf_TIME_ZONE\"];\n\n\t$WIFI_COUNTRY\t= trim(shell_exec(\"raspi-config nonint get_wifi_country\"));\n\n\t$vpn_types\t\t= array('OpenVPN','WireGuard');\n?>\n\n<html lang=\"<?php echo $config[\"conf_LANGUAGE\"]; ?>\" data-theme=\"<?php echo $theme; ?>\">\n\n<head>\n\t<?php include \"${WORKING_DIR}/sub-standards-header-loader.php\"; ?>\n</head>\n\n<body <?php echo $background; ?>>\n\t<?php include \"${WORKING_DIR}/sub-standards-body-loader.php\"; ?>\n\t<?php include \"${WORKING_DIR}/sub-menu.php\"; ?>\n\n\t<?php\n\t\t// write new config\n\t\tif (isset($_POST['save'])) {\n\t\t\twrite_config();\n\n\t\t\tif (isset($_POST['send_testmail'])) {\n\t\t\t\tshell_exec(\"sudo python3 $WORKING_DIR/lib_mail.py '\" . L::config_mail_testmail_subject . \"' '\" . L::config_mail_testmail_content . \"'\");\n\t\t\t\techo '<div class=\"card\" style=\"margin-top: 2em;\">' . L::config_mail_testmail_sent . '</div>';\n\t\t\t}\n\n\t\t\tif (isset($_POST['restart_rclone_gui'])) {\n\t\t\t\texec(\"sudo python3 $WORKING_DIR/start-rclone-gui.py True > /dev/null 2>/dev/null &\");\n\t\t\t\techo '<div class=\"card\" style=\"margin-top: 2em;\">' . L::config_rclone_gui_restarted . '</div>';\n\t\t\t}\n\n\t\t\texec(\"sudo pkill -f ${WORKING_DIR}/display.py\");\n\t\t\texec(\"sudo python3 $WORKING_DIR/lib_display.py '\" . L::config_display_message_settings_saved_1 . \"' '\" . L::config_display_message_settings_saved_2 . \"' > /dev/null 2>&1 &\");\n\t\t}\n\n\t\t// Upload settings\n\t\tif (isset($_POST['upload_settings'])) {\n\t\t\tupload_settings();\n\t\t};\n\n\t\t// read (new) config\n\t\t$config = parse_ini_file(\"$WORKING_DIR/config.cfg\", false);\n\n\t\t# set timezone\n\t\tif ($TIME_ZONE_old !== $config[\"conf_TIME_ZONE\"]) {\n\t\t\tshell_exec(\"sudo raspi-config nonint do_change_timezone \".$config[\"conf_TIME_ZONE\"]);\n\t\t}\n\n\t\t# write wifi country-code from config.cfg\n\t\tif (($WIFI_COUNTRY !== $config[\"conf_WIFI_COUNTRY\"]) and ($config[\"conf_WIFI_COUNTRY\"] !== \"\")) {\n\t\t\tshell_exec(\"sudo raspi-config nonint do_wifi_country \".$config[\"conf_WIFI_COUNTRY\"]);\n\t\t\t$WIFI_COUNTRY\t= trim(shell_exec(\"raspi-config nonint get_wifi_country\"));\n\t\t}\n\n\t?>\n\n\t<h1 class=\"text-center\" style=\"margin-bottom: 1em; letter-spacing: 3px;\"><?php echo L::config_config; ?></h1>\n\t<?php\n\nfunction get_wifi_country_selector($ID,$NAME) {\n\tglobal $WIFI_COUNTRY;\n\n\t$wifi_contry_selector\t= '<select id=\"'.$ID.'\" name=\"'.$NAME.'\">';\n\n\t\texec(\"sed '/^#/d' /usr/share/zoneinfo/iso3166.tab\",$COUNTRIES);\n\t\tforeach($COUNTRIES as $COUNTRY) {\n\t\t\t$COUNTRY_ARRAY\t= explode(\"\\t\",$COUNTRY,2);\n\t\t\t$COUNTRYCODE\t= trim($COUNTRY_ARRAY[0]);\n\t\t\t$COUNTRYNAME\t= trim($COUNTRY_ARRAY[1]);\n\t\t\t$selected\t\t= $WIFI_COUNTRY==$COUNTRYCODE ? \" selected\" : \"\";\n\n\t\t\t$wifi_contry_selector\t.= '<option value=\"'.$COUNTRYCODE.'\"'.$selected.'>'.$COUNTRYCODE.' '.$COUNTRYNAME.'</option>';\n\t\t}\n\t$wifi_contry_selector\t.= '</select>';\n\treturn ($wifi_contry_selector);\n}\n\nfunction check_new_password($title, $pwd_1, $pwd_2) {\n\t$pwd_valid = false;\n\t\tif ($pwd_1 !== $pwd_2) {\n\t\t\tpopup($title . \"\\n\" . L::config_alert_password_not_identical, true);\n\t\t} elseif (strlen($pwd_1) < 5) {\n\t\t\tpopup($title . \"\\n\" . L::config_alert_password_too_short, true);\n\t\t} elseif (\n\t\t\t\tstrpos(\"_\" . $pwd_1,\"\\\\\") or\n\t\t\t\tstrpos(\"_\" . $pwd_1,\"'\") or\n\t\t\t\tstrpos(\"_\" . $pwd_1,\" \")\n\t\t\t\t  ) {\n\t\t\tpopup($title . \"\\n\" . L::config_alert_password_characters_not_allowed, true);\n\t\t} else {\n\t\t\t$pwd_valid=true;\n\t\t}\n\n\treturn($pwd_valid);\n}\n\nfunction write_config() {\n\t# write config.cfg\n\textract ($_POST);\n\n\tglobal $WORKING_DIR;\n\tglobal $WIFI_COUNTRY;\n\tglobal $constants;\n\tglobal $vpn_types;\n\n\tlist($conf_BACKUP_DEFAULT_SOURCE,$conf_BACKUP_DEFAULT_TARGET)=explode(\" \",$BACKUP_MODE,2);\n\tlist($conf_BACKUP_DEFAULT_SOURCE2,$conf_BACKUP_DEFAULT_TARGET2)=explode(\" \",$BACKUP_MODE_2,2);\n\n\t$conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS\t= isset($conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS)?\"true\":\"false\";\n\t$conf_BACKUP_DEFAULT_UPDATE_EXIF\t\t\t= isset($conf_BACKUP_DEFAULT_UPDATE_EXIF)?\"true\":\"false\";\n\t$conf_POWER_OFF\t\t\t\t\t\t\t\t= isset($conf_POWER_OFF)?\"true\":\"false\";\n\t$conf_MAIL_NOTIFICATIONS\t\t\t\t\t= isset($conf_MAIL_NOTIFICATIONS)?\"true\":\"false\";\n\t$conf_MAIL_HTML\t\t\t\t\t\t\t\t= isset($conf_MAIL_HTML)?\"true\":\"false\";\n\t$conf_DISP\t\t\t\t\t\t\t\t\t= isset($conf_DISP)?\"true\":\"false\";\n\t$conf_DISP_BLACK_ON_POWER_OFF\t\t\t\t= isset($conf_DISP_BLACK_ON_POWER_OFF)?\"true\":\"false\";\n\t$conf_DISP_IP_REPEAT\t\t\t\t\t\t= isset($conf_DISP_IP_REPEAT)?\"true\":\"false\";\n\t$conf_MENU_ENABLED\t\t\t\t\t\t\t= isset($conf_MENU_ENABLED)?\"true\":\"false\";\n\t$conf_LOG_SYNC\t\t\t\t\t\t\t\t= isset($conf_LOG_SYNC)?\"true\":\"false\";\n\t$conf_POPUP_MESSAGES\t\t\t\t\t\t= isset($conf_POPUP_MESSAGES)?\"true\":\"false\";\n\t$conf_BACKUP_GENERATE_THUMBNAILS\t\t\t= isset($conf_BACKUP_GENERATE_THUMBNAILS)?\"true\":\"false\";\n\t$conf_BACKUP_UPDATE_EXIF\t\t\t\t\t= isset($conf_BACKUP_UPDATE_EXIF)?\"true\":\"false\";\n\t$conf_VIEW_CONVERT_HEIC\t\t\t\t\t\t= isset($conf_VIEW_CONVERT_HEIC)?\"true\":\"false\";\n\t$conf_VIEW_WRITE_RATING_EXIF\t\t\t\t= isset($conf_VIEW_WRITE_RATING_EXIF)?\"true\":\"false\";\n\n\t$conf_PASSWORD_LINE=\"conf_PASSWORD=\\\"$conf_PASSWORD_OLD\\\"\";\n\n\tif ($conf_MAIL_PASSWORD != '') {\n\t\tif (! check_new_password (L::config_alert_password_mail_header, $conf_MAIL_PASSWORD, $conf_MAIL_PASSWORD)) {\n\t\t\t$conf_MAIL_PASSWORD\t= \"\";\n\t\t}\n\t}\n\n\tif ($conf_RSYNC_PASSWORD != '') {\n\t\tif (! check_new_password (L::config_alert_password_rsync_header, $conf_RSYNC_PASSWORD, $conf_RSYNC_PASSWORD)) {\n\t\t\t$conf_RSYNC_PASSWORD\t= \"\";\n\t\t}\n\t}\n\n\tif (isset($conf_PASSWORD_REMOVE)) {\n\t\t$conf_PASSWORD_LINE=\"conf_PASSWORD=''\";\n\n\t\texec(\"sudo python3 \" . $_SERVER['CONTEXT_DOCUMENT_ROOT'] . \"/lib_password.py\"); # remove password\n\n\t\tpopup(L::config_alert_password_change_after_reboot_remove,true);\n\t} elseif ($conf_PASSWORD_1 != '') {\n\t\tif (check_new_password (L::config_alert_password_global, $conf_PASSWORD_1, $conf_PASSWORD_2)) {\n\t\t\t$conf_PASSWORD_LINE=\"conf_PASSWORD='$conf_PASSWORD_1'\";\n\n\t\t\texec(\"sudo python3 \" . $_SERVER['CONTEXT_DOCUMENT_ROOT'] . \"/lib_password.py '\" . $conf_PASSWORD_1 . \"'\");\n\n\t\t\tif ((strlen($conf_PASSWORD_1) < 8) or (strlen($conf_PASSWORD_1) > 63)) {\n\t\t\t\tpopup(L::config_alert_password_wifi_size_error,true);\n\t\t\t}\n\t\t\tpopup(L::config_alert_password_change_after_reboot_set,true);\n\t\t}\n\t}\n\n\t$CONFIGFILE = \"$WORKING_DIR/config.cfg\";\n\t$config_file_handle = fopen($CONFIGFILE, \"w\");\n\n\t$config_file_content = <<<CONFIGDATA\nconf_LANGUAGE='$conf_LANGUAGE'\nconf_TIME_ZONE='$conf_TIME_ZONE'\nconf_BACKUP_DEFAULT_SOURCE='$conf_BACKUP_DEFAULT_SOURCE'\nconf_BACKUP_DEFAULT_TARGET='$conf_BACKUP_DEFAULT_TARGET'\nconf_BACKUP_DEFAULT_GENERATE_THUMBNAILS=$conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS\nconf_BACKUP_DEFAULT_UPDATE_EXIF=$conf_BACKUP_DEFAULT_UPDATE_EXIF\nconf_BACKUP_DEFAULT_SOURCE2='$conf_BACKUP_DEFAULT_SOURCE2'\nconf_BACKUP_DEFAULT_TARGET2='$conf_BACKUP_DEFAULT_TARGET2'\nconf_BACKUP_CAMERA_FOLDER_MASK='$conf_BACKUP_CAMERA_FOLDER_MASK'\nconf_BACKUP_TARGET_BASEDIR_CLOUD='$conf_BACKUP_TARGET_BASEDIR_CLOUD'\nconf_POWER_OFF=$conf_POWER_OFF\nconf_DISP=$conf_DISP\nconf_DISP_CONNECTION='$conf_DISP_CONNECTION'\nconf_DISP_DRIVER='$conf_DISP_DRIVER'\nconf_DISP_I2C_ADDRESS='$conf_DISP_I2C_ADDRESS'\nconf_DISP_SPI_PORT='$conf_DISP_SPI_PORT'\nconf_DISP_RESOLUTION_X=$conf_DISP_RESOLUTION_X\nconf_DISP_RESOLUTION_Y=$conf_DISP_RESOLUTION_Y\nconf_DISP_ROTATE='$conf_DISP_ROTATE'\nconf_DISP_CONTRAST=$conf_DISP_CONTRAST\nconf_DISP_COLOR_MODEL='$conf_DISP_COLOR_MODEL'\nconf_DISP_COLOR_TEXT='$conf_DISP_COLOR_TEXT'\nconf_DISP_COLOR_HIGH='$conf_DISP_COLOR_HIGH'\nconf_DISP_COLOR_ALERT='$conf_DISP_COLOR_ALERT'\nconf_DISP_FONT_SIZE=$conf_DISP_FONT_SIZE\nconf_DISP_FRAME_TIME=$conf_DISP_FRAME_TIME\nconf_DISP_BLACK_ON_POWER_OFF=$conf_DISP_BLACK_ON_POWER_OFF\nconf_DISP_IP_REPEAT=$conf_DISP_IP_REPEAT\nconf_MENU_ENABLED=$conf_MENU_ENABLED\nconf_MENU_BUTTON_COMBINATION='$conf_MENU_BUTTON_COMBINATION'\nconf_MENU_BUTTON_ROTATE='$conf_MENU_BUTTON_ROTATE'\nconf_MENU_BUTTON_BOUNCETIME=$conf_MENU_BUTTON_BOUNCETIME\nconf_MENU_BUTTON_EDGE_DETECTION='$conf_MENU_BUTTON_EDGE_DETECTION'\nconf_MENU_BUTTON_RESISTOR_PULL='$conf_MENU_BUTTON_RESISTOR_PULL'\nconf_FAN_PWM_TEMP_C=$conf_FAN_PWM_TEMP_C\nconf_FAN_PWM_GPIO=$conf_FAN_PWM_GPIO\nconf_THEME=$conf_THEME\nconf_BACKGROUND_IMAGE=$conf_BACKGROUND_IMAGE\nconf_POPUP_MESSAGES=$conf_POPUP_MESSAGES\nconf_LOGLEVEL=$conf_LOGLEVEL\nconf_LOG_SYNC=$conf_LOG_SYNC\nconf_POWER_OFF_IDLE_TIME=$conf_POWER_OFF_IDLE_TIME\nconf_BACKUP_GENERATE_THUMBNAILS=$conf_BACKUP_GENERATE_THUMBNAILS\nconf_BACKUP_UPDATE_EXIF=$conf_BACKUP_UPDATE_EXIF\nconf_VIEW_CONVERT_HEIC=$conf_VIEW_CONVERT_HEIC\nconf_VIEW_WRITE_RATING_EXIF=$conf_VIEW_WRITE_RATING_EXIF\nconf_MAIL_NOTIFICATIONS=$conf_MAIL_NOTIFICATIONS\nconf_MAIL_HTML=$conf_MAIL_HTML\nconf_SMTP_SERVER='$conf_SMTP_SERVER'\nconf_SMTP_PORT='$conf_SMTP_PORT'\nconf_MAIL_SECURITY='$conf_MAIL_SECURITY'\nconf_MAIL_USER='$conf_MAIL_USER'\nconf_MAIL_PASSWORD='$conf_MAIL_PASSWORD'\nconf_MAIL_FROM='$conf_MAIL_FROM'\nconf_MAIL_TO='$conf_MAIL_TO'\nconf_RSYNC_SERVER='$conf_RSYNC_SERVER'\nconf_RSYNC_PORT='$conf_RSYNC_PORT'\nconf_RSYNC_USER='$conf_RSYNC_USER'\nconf_RSYNC_PASSWORD='$conf_RSYNC_PASSWORD'\nconf_RSYNC_SERVER_MODULE='$conf_RSYNC_SERVER_MODULE'\nconf_WIFI_COUNTRY='$conf_WIFI_COUNTRY'\nconf_VPN_TYPE_RSYNC='$conf_VPN_TYPE_RSYNC'\nconf_VPN_TYPE_CLOUD='$conf_VPN_TYPE_CLOUD'\nconf_VPN_TIMEOUT=$conf_VPN_TIMEOUT\n$conf_PASSWORD_LINE\n\nCONFIGDATA;\n\n\tfwrite($config_file_handle, $config_file_content);\n\tfclose($config_file_handle);\n\texec (\"dos2unix './\" . $CONFIGFILE . \"'\");\n\n\t# remove vpn config file\n\tforeach($vpn_types as $vpn_type) {\n\t\tif (isset($_POST['vpn_remove_' . $vpn_type])) {\n\t\t\texec ('sudo rm \"' . $constants['const_VPN_DIR_' . $vpn_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_type] . '\"');\n\t\t}\n\t}\n\n\t# save vpn config file\n\tif ($vpn_upload_type !== 'none') {\n\t\tif(file_exists($_FILES[\"vpn_conf_file\"][\"tmp_name\"])) {\n\t\t\texec ('sudo mkdir -p \"' . $constants['const_VPN_DIR_' . $vpn_upload_type] . '\"');\n\t\t\texec ('sudo mv \"' . $_FILES[\"vpn_conf_file\"][\"tmp_name\"] . '\" \"' . $constants['const_VPN_DIR_' . $vpn_upload_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_upload_type] . '\"');\n\t\t\texec ('sudo chown root:root \"' . $constants['const_VPN_DIR_' . $vpn_upload_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_upload_type] . '\"');\n\t\t\texec ('sudo chmod 700 \"' . $constants['const_VPN_DIR_' . $vpn_upload_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_upload_type] . '\"');\n\t\t}\n\t}\n\n\t# write hardware-settings\n\texec(\"sudo \" . $_SERVER['CONTEXT_DOCUMENT_ROOT'] . \"/set_hardware.sh\");\n\n\t# response\n\techo '<div class=\"card\" style=\"margin-top: 2em;\">' . L::config_message_settings_saved . '</div>';\n}\n\nfunction upload_settings() {\n\tglobal $WORKING_DIR, $config, $constants, $vpn_types;\n\n\tif($_FILES[\"settings_file\"][\"name\"]) {\n\t\t$filename = $_FILES[\"settings_file\"][\"name\"];\n\t\t$source = $_FILES[\"settings_file\"][\"tmp_name\"];\n\t\t$type = $_FILES[\"settings_file\"][\"type\"];\n\t\t$name = explode(\".\", $filename);\n\t\t$accepted_types = array('application/zip', 'application/x-zip-compressed', 'multipart/x-zip', 'application/x-compressed');\n\n\t\t$FILETYPE_ZIP\t= false;\n\t\tforeach($accepted_types as $mime_type) {\n\t\t\tif($mime_type == $type) {\n\t\t\t\t$FILETYPE_ZIP = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t$continue = ((strtolower($name[1]) == 'zip') and $FILETYPE_ZIP) ? true : false;\n\t\tif(!$continue) {\n\t\t\tpopup(L::config_alert_settings_upload_not_zip,true);\n\t\t} else {\n\t\t\t/* PHP current path */\n\n\t\t\t$targetdir = $constants[\"const_WEB_ROOT_LBB\"].'/tmp/unzip';\n\t\t\t$targetzip = $targetdir . '/' . $filename;\n\t\t\t/* create directory if not exists' */\n\t\t\t@mkdir($targetdir, 0777);\n\n\t\t\t/* here it is really happening */\n\n\t\t\tif(move_uploaded_file($source, $targetzip)) {\n\t\t\t\t$zip = new ZipArchive();\n\t\t\t\t$file_opened = $zip->open($targetzip);  // open the zip file to extract\n\t\t\t\tif ($file_opened === true) {\n\t\t\t\t\t$zip->extractTo($targetdir); // place in the directory with same name\n\t\t\t\t\t$zip->close();\n\n\t\t\t\t\tunlink($targetzip);\n\t\t\t\t\t$Files_Copied=\"\";\n\n\t\t\t\t\tif (file_exists($targetdir.\"/config.cfg\")) {\n\t\t\t\t\t\t@unlink($constants[\"const_WEB_ROOT_LBB\"]/config.cfg);\n\t\t\t\t\t\tif (rename($targetdir.\"/config.cfg\",$constants[\"const_WEB_ROOT_LBB\"].\"/config.cfg\")) {$Files_Copied=\"\\n* 'config.cfg'\";}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif (file_exists($targetdir.\"/\".$constants[\"const_RCLONE_CONFIG_FILE\"])) {\n\t\t\t\t\t\tif (rename($targetdir.\"/\".$constants[\"const_RCLONE_CONFIG_FILE\"],$constants[\"const_MEDIA_DIR\"] . '/' . $constants[\"const_RCLONE_CONFIG_FILE\"])) {$Files_Copied=$Files_Copied.\"\\n* '\".$constants[\"const_RCLONE_CONFIG_FILE\"].\"'\";}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (file_exists($targetdir.\"/\".$constants[\"const_BUTTONS_PRIVATE_CONFIG_FILE\"])) {\n\t\t\t\t\t\tif (rename($targetdir.\"/\".$constants[\"const_BUTTONS_PRIVATE_CONFIG_FILE\"],$constants[\"const_MEDIA_DIR\"] . '/' . $constants[\"const_BUTTONS_PRIVATE_CONFIG_FILE\"])) {$Files_Copied=$Files_Copied.\"\\n* '\".$constants[\"const_BUTTONS_PRIVATE_CONFIG_FILE\"].\"'\";}\n\t\t\t\t\t}\n\n\t\t\t\t\tforeach($vpn_types as $vpn_type) {\n\t\t\t\t\t\tif (file_exists($targetdir.'/'.$constants['const_VPN_FILENAME_' . $vpn_type])) {\n\t\t\t\t\t\t\texec ('sudo rm \"' . $constants['const_VPN_DIR_' . $vpn_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_type] . '\"');\n\t\t\t\t\t\t\texec ('sudo mv \"' . $targetdir.'/'.$constants['const_VPN_FILENAME_' . $vpn_type] . '\" \"' . $constants['const_VPN_DIR_' . $vpn_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_type] . '\"');\n\t\t\t\t\t\t\t$Files_Copied=$Files_Copied.\"\\n* '\" . $constants['const_VPN_FILENAME_' . $vpn_type] . \"'\";\n\n\t\t\t\t\t\t\t## secure VPN config files\n\t\t\t\t\t\t\texec ('sudo chmod 700 \"' . $constants['const_VPN_DIR_' . $vpn_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_type] . '\" -R');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t#Background images\n\t\t\t\t\tif (is_dir($targetdir.'/bg-images')){\n\n\t\t\t\t\t\texec (\"sudo mkdir -p '\" . $constants[\"const_MEDIA_DIR\"] . '/' . $constants['const_BACKGROUND_IMAGES_DIR'] . \"'\");\n\t\t\t\t\t\texec (\"sudo chown www-data:www-data '\" . $constants[\"const_MEDIA_DIR\"] . '/' . $constants['const_BACKGROUND_IMAGES_DIR'] .\"' -R\");\n\n\t\t\t\t\t\t$background_images\t= scandir($targetdir.'/bg-images');\n\t\t\t\t\t\tforeach ($background_images as $BACKGROUND_IMAGE) {\n\t\t\t\t\t\t\tif (is_file($targetdir . '/bg-images/' . $BACKGROUND_IMAGE)) {\n\t\t\t\t\t\t\t\t$Files_Copied=$Files_Copied.\"\\n* '\" . $BACKGROUND_IMAGE . \"'\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\texec (\"sudo mv '\" . $targetdir . \"/bg-images/'* '\" . $constants[\"const_MEDIA_DIR\"] . '/' . $constants['const_BACKGROUND_IMAGES_DIR'] . \"/'\");\n\t\t\t\t\t\texec (\"sudo chown www-data:www-data '\" . $constants[\"const_MEDIA_DIR\"] . '/' . $constants['const_BACKGROUND_IMAGES_DIR'] .\"/'*\");\n\t\t\t\t\t}\n\n\t\t\t\t\t# Feedback files in place\n\t\t\t\t\tpopup(L::config_alert_settings_upload_success. \" \". $Files_Copied,true);\n\n\t\t\t\t\t# reload config\n\t\t\t\t\t$config = parse_ini_file(\"$WORKING_DIR/config.cfg\", false);\n\n\t\t\t\t\t# set new password\n\t\t\t\t\tif (isset ($config[\"conf_PASSWORD\"]) and check_new_password(L::config_alert_password_global,$config[\"conf_PASSWORD\"],$config[\"conf_PASSWORD\"])) {\n\t\t\t\t\t\texec(\"sudo python3 \" . $_SERVER['CONTEXT_DOCUMENT_ROOT'] . \"/lib_password.py '\" . $config[\"conf_PASSWORD\"] . \"'\");\n\t\t\t\t\t\tpopup(L::config_alert_password_change_after_reboot_set,true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\texec(\"sudo python3 \" . $_SERVER['CONTEXT_DOCUMENT_ROOT'] . \"/lib_password.py\");\n\t\t\t\t\t\tpopup(L::config_alert_password_change_after_reboot_remove,true);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tpopup(L::config_alert_settings_upload_problem,$config[\"conf_POPUP_MESSAGES\"]);\n\t\t\t}\n\n\t\t}\n\t\texec(\"sudo rm -R \".$targetdir);\n\t}\n}\n?>\n\n\n\t<form action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST\" enctype=\"multipart/form-data\">\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<?php echo '<button style=\"margin-top: 2em;\" type=\"submit\" name=\"save\">' . L::config_save_button . '</button>'; ?>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_lang_time_section; ?></summary>\n\n\t\t\t\t<div>\n\t\t\t\t\t<h3><?php echo L::config_lang_header; ?></h3>\n\t\t\t\t\t\t<label for=\"conf_LANGUAGE\"><?php echo L::config_lang_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_LANGUAGE\" id=\"conf_LANGUAGE\">\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\techo \"<option value='' \" . ($config[\"conf_LANGUAGE\"] == \"\"?\" selected\":\"\") . \">\" . L::config_lang_browser_detect . \"</option>\";\n\t\t\t\t\t\t\t\t$languages=array();\n\t\t\t\t\t\t\t\texec (\"find 'lang'/*.json -type f \",$languages);\n\t\t\t\t\t\t\t\tforeach($languages as $language) {\n\t\t\t\t\t\t\t\t\t$language = basename($language, \".json\");\n\t\t\t\t\t\t\t\t\techo \"<option value='\" . $language . \"' \" . ($config[\"conf_LANGUAGE\"] == $language?\" selected\":\"\") . \">\" . $language . \"</option>\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</select>\n\t\t\t\t</div>\n\n\t\t\t\t<div>\n\t\t\t\t\t<h3><?php echo L::config_time_zone_header; ?></h3>\n\t\t\t\t\t\t<label for=\"conf_TIME_ZONE\"><?php echo L::config_time_zone_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_TIME_ZONE\" id=\"conf_TIME_ZONE\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$time_zones=array();\n\t\t\t\t\t\t\t\t\texec (\"timedatectl list-timezones\",$time_zones);\n\t\t\t\t\t\t\t\t\tforeach($time_zones as $time_zone) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $time_zone . \"' \" . ($config[\"conf_TIME_ZONE\"] == $time_zone?\" selected\":\"\") . \">\" . $time_zone . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_backup_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_backup_header; ?></h3>\n\t\t\t\t\t<label for=\"BACKUP_MODE\"><?php echo L::config_backup_label; ?></label><br>\n\n\t\t\t\t\t<select name=\"BACKUP_MODE\" id=\"BACKUP_MODE\">\n\t\t\t\t\t\t<option value=\"none none\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"none none\"?\" selected\":\"\"; ?>><?php echo L::config_backup_none; ?></option>\n\t\t\t\t\t\t<option value=\"usb usb\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"usb usb\"?\" selected\":\"\"; ?>><?php echo L::config_backup_usb_usb; ?></option>\n\t\t\t\t\t\t<option value=\"usb internal\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"usb internal\"?\" selected\":\"\"; ?>><?php echo L::config_backup_usb_internal; ?></option>\n\t\t\t\t\t\t<option value=\"camera usb\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"camera usb\"?\" selected\":\"\"; ?>><?php echo L::config_backup_camera_usb; ?></option>\n\t\t\t\t\t\t<option value=\"camera internal\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"camera internal\"?\" selected\":\"\"; ?>><?php echo L::config_backup_camera_internal; ?></option>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\tif (! ($config[\"conf_RSYNC_SERVER\"]==\"\" or $config[\"conf_RSYNC_PORT\"]==\"\" or $config[\"conf_RSYNC_USER\"]==\"\" or $config[\"conf_RSYNC_PASSWORD\"]==\"\" or $config[\"conf_RSYNC_SERVER_MODULE\"]==\"\")) {\n\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t<option value=\"internal cloud_rsync\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"internal cloud_rsync\"?\" selected\":\"\"; ?>><?php echo L::main_internal_button . L::right_arrow . L::main_rsync_button; ?></option>\n\t\t\t\t\t\t\t\t<option value=\"usb cloud_rsync\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"usb cloud_rsync\"?\" selected\":\"\"; ?>><?php echo L::main_usb_button . L::right_arrow . L::main_rsync_button; ?></option>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tforeach($CloudServices as $CloudService) {\n\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t<option value=\"internal cloud:<?php print $CloudService; ?>\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"internal cloud:${CloudService}\"?\" selected\":\"\"; ?>><?php echo L::main_internal_button . L::right_arrow . $CloudService; ?></option>\n\t\t\t\t\t\t\t\t<option value=\"usb cloud:<?php print $CloudService; ?>\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"usb cloud:${CloudService}\"?\" selected\":\"\"; ?>><?php echo L::main_usb_button . L::right_arrow . $CloudService; ?></option>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</select>\n\n\t\t\t\t<h4><?php echo L::config_backup_default_settings_header; ?></h4>\n\t\t\t\t\t<h5><?php echo L::config_backup_generate_thumbnails_header; ?></h5>\n\t\t\t\t\t\t<label for=\"conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS\"><?php echo L::config_backup_generate_thumbnails_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"checkbox\" id=\"conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS\" name=\"conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS\" <?php echo $config['conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t\t<h5><?php echo L::config_backup_update_exif_header; ?></h5>\n\t\t\t\t\t\t<label for=\"conf_BACKUP_DEFAULT_UPDATE_EXIF\"><?php echo L::config_backup_update_exif_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"checkbox\" id=\"conf_BACKUP_DEFAULT_UPDATE_EXIF\" name=\"conf_BACKUP_DEFAULT_UPDATE_EXIF\" <?php echo $config['conf_BACKUP_DEFAULT_UPDATE_EXIF']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_backup_header2; ?></h3>\n\t\t\t\t\t<label for=\"BACKUP_MODE_2\"><?php echo L::config_backup_label2; ?></label><br>\n\n\t\t\t\t\t<select name=\"BACKUP_MODE_2\" id=\"BACKUP_MODE_2\">\n\t\t\t\t\t\t<option value=\"none none\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE2\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET2\"]==\"none none\"?\" selected\":\"\"; ?>><?php echo L::config_backup_none; ?></option>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\tif (! ($config[\"conf_RSYNC_SERVER\"]==\"\" or $config[\"conf_RSYNC_PORT\"]==\"\" or $config[\"conf_RSYNC_USER\"]==\"\" or $config[\"conf_RSYNC_PASSWORD\"]==\"\" or $config[\"conf_RSYNC_SERVER_MODULE\"]==\"\")) {\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<option value=\"internal cloud_rsync\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE2\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET2\"]==\"internal cloud_rsync\"?\" selected\":\"\"; ?>><?php echo L::main_internal_button . L::right_arrow . L::main_rsync_button; ?></option>\n\t\t\t\t\t\t\t\t\t<option value=\"usb cloud_rsync\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE2\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET2\"]==\"usb cloud_rsync\"?\" selected\":\"\"; ?>><?php echo L::main_usb_button . L::right_arrow . L::main_rsync_button; ?></option>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tforeach($CloudServices as $CloudService) {\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<option value=\"internal cloud:<?php print $CloudService; ?>\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE2\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET2\"]==\"internal cloud:${CloudService}\"?\" selected\":\"\"; ?>><?php echo L::main_internal_button . L::right_arrow . $CloudService; ?></option>\n\t\t\t\t\t\t\t\t\t<option value=\"usb cloud:<?php print $CloudService; ?>\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE2\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET2\"]==\"usb cloud:${CloudService}\"?\" selected\":\"\"; ?>><?php echo L::main_usb_button . L::right_arrow . $CloudService; ?></option>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t</select>\n\n\t\t\t\t<h3><?php echo L::config_backup_camera_folder_mask_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_BACKUP_CAMERA_FOLDER_MASK\"><?php echo L::config_backup_camera_folder_mask_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_BACKUP_CAMERA_FOLDER_MASK\" name=\"conf_BACKUP_CAMERA_FOLDER_MASK\" size=\"6\" value=\"<?php echo $config['conf_BACKUP_CAMERA_FOLDER_MASK']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_backup_power_off_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_POWER_OFF\"><?php echo L::config_backup_power_off_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_POWER_OFF\" name=\"conf_POWER_OFF\" <?php echo $config['conf_POWER_OFF']==\"1\"?\"checked\":\"\"; ?>>\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_behavior_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_behavior_loglevel_header; ?></h3>\n\t\t\t\t\t<p><?php echo L::config_behavior_loglevel_text . \" \" . $constants[\"const_LOGFILE\"]; ?>)</p>\n\t\t\t\t\t<label for=\"conf_LOGLEVEL\"><?php echo L::config_behavior_loglevel_label; ?></label><br>\n\t\t\t\t\t<select name=\"conf_LOGLEVEL\" id=\"conf_LOGLEVEL\">\n\t\t\t\t\t\t<option value=\"1\" <?php echo $config[\"conf_LOGLEVEL\"]==\"1\"?\" selected\":\"\"; ?>>1, <?php echo L::config_behavior_loglevel_minimum; ?></option>\n\t\t\t\t\t\t<option value=\"2\" <?php echo $config[\"conf_LOGLEVEL\"]==\"2\"?\" selected\":\"\"; ?>>2, <?php echo L::config_behavior_loglevel_medium; ?></option>\n\t\t\t\t\t\t<option value=\"3\" <?php echo $config[\"conf_LOGLEVEL\"]==\"3\"?\" selected\":\"\"; ?>>3, <?php echo L::config_behavior_loglevel_maximum; ?></option>\n\t\t\t\t\t</select>\n\n\t\t\t\t<h3><?php echo L::config_behavior_log_sync_protokoll_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_LOG_SYNC\"><?php echo L::config_behavior_log_sync_protokoll_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_LOG_SYNC\" name=\"conf_LOG_SYNC\"<?php echo $config['conf_LOG_SYNC']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_behavior_power_off_idle_time_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_POWER_OFF_IDLE_TIME\"><?php echo L::config_behavior_power_off_idle_time_label; ?></label><br>\n\t\t\t\t\t<select name=\"conf_POWER_OFF_IDLE_TIME\" id=\"conf_POWER_OFF_IDLE_TIME\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t$IDLE_TIME_OPTIONS=array(0,2,5,10,15,20,30);\n\t\t\t\t\t\t\tforeach($IDLE_TIME_OPTIONS as $IDLE_TIME_OPTION) {\n\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $IDLE_TIME_OPTION .\"\\\"\". ($config[\"conf_POWER_OFF_IDLE_TIME\"]==$IDLE_TIME_OPTION?\" selected\":\"\") . \">\" . ($IDLE_TIME_OPTION==\"0\"?L::config_behavior_power_off_idle_time_none:$IDLE_TIME_OPTION . \" \" . L::units_minutes_long) .\"</option>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\n\t\t\t\t\t</select>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_view_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_view_theme_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_THEME\"><?php echo L::config_view_theme_label; ?></label><br>\n\t\t\t\t\t\t<select name=\"conf_THEME\" id=\"conf_THEME\">\n\t\t\t\t\t\t<option value=\"light\" <?php echo $config[\"conf_THEME\"] == \"light\"?\" selected\":\"\"; ?>><?php echo L::config_view_theme_light; ?></option>\n\t\t\t\t\t\t<option value=\"dark\" <?php echo $config[\"conf_THEME\"] == \"dark\"?\" selected\":\"\"; ?>><?php echo L::config_view_theme_dark; ?></option>\n\t\t\t\t\t\t<option value=\"sepia\" <?php echo $config[\"conf_THEME\"] == \"sepia\"?\" selected\":\"\"; ?>><?php echo L::config_view_theme_sepia; ?></option>\n\t\t\t\t\t</select>\n\n\t\t\t\t<h3><?php echo L::config_view_bg_image_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_BACKGROUND_IMAGE\"><?php echo L::config_view_bg_image_label; ?> &quot;<?php echo $constants[\"const_MEDIA_DIR\"] . '/' . $constants['const_BACKGROUND_IMAGES_DIR'] ;?>&quot;.</label><br>\n\t\t\t\t\t\t<select name=\"conf_BACKGROUND_IMAGE\" id=\"conf_BACKGROUND_IMAGE\">\n\t\t\t\t\t\t\t<option value=\"\" <?php echo $config[\"conf_BACKGROUND_IMAGE\"] ==\"\"?\" selected\":\"\"; ?>>none</option>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t$bg_images=array();\n\t\t\t\t\t\t\t\texec (\"find '\" . $constants[\"const_MEDIA_DIR\"] . '/' . $constants[\"const_BACKGROUND_IMAGES_DIR\"] . \"' -type f -exec file --mime-type {} \\+ | awk -F: '{if ($2 ~/image\\//) print $1}'\",$bg_images);\n\t\t\t\t\t\t\t\tforeach($bg_images as $bg_image) {\n\t\t\t\t\t\t\t\t\t$bg_image = str_replace($constants[\"const_MEDIA_DIR\"] . '/' . $constants[\"const_BACKGROUND_IMAGES_DIR\"] . '/','',$bg_image);\n\t\t\t\t\t\t\t\t\techo \"<option value='\" . $bg_image . \"' \" . ($config[\"conf_BACKGROUND_IMAGE\"] == $bg_image?\" selected\":\"\") . \">\" . $bg_image . \"</option>\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</select>\n\n\t\t\t\t<h3><?php echo L::config_view_popup_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_POPUP_MESSAGES\"><?php echo L::config_view_popup_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_POPUP_MESSAGES\" name=\"conf_POPUP_MESSAGES\" <?php echo $config['conf_POPUP_MESSAGES']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_display_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_display_behavior_header; ?></h3>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP\"><?php echo L::config_display_activate_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"checkbox\" id=\"conf_DISP\" name=\"conf_DISP\" <?php echo $config['conf_DISP']==\"1\"?\"checked\":\"\"; ?>>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_FONT_SIZE\"><?php echo L::config_display_font_size_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_FONT_SIZE\" id=\"conf_DISP_FONT_SIZE\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_font_sizes_array=array(10,12,14,16);\n\t\t\t\t\t\t\t\t\tforeach($display_font_sizes_array as $display_font_size) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_font_size . \"' \" . ($config[\"conf_DISP_FONT_SIZE\"] == $display_font_size?\" selected\":\"\") . \">\" . $display_font_size . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_FRAME_TIME\"><?php echo L::config_display_frame_time_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_FRAME_TIME\" id=\"conf_DISP_FRAME_TIME\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_frame_times_array=array(\"0.5\",\"1\",\"2\",\"3\");\n\t\t\t\t\t\t\t\t\tforeach($display_frame_times_array as $display_frame_time) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_frame_time . \"' \" . ($config[\"conf_DISP_FRAME_TIME\"] == $display_frame_time?\" selected\":\"\") . \">\" . $display_frame_time . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_CONTRAST\"><?php echo L::config_display_contrast_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"range\" id=\"conf_DISP_CONTRAST\" name=\"conf_DISP_CONTRAST\" style=\"width: 50%;\" min=\"1\" max=\"255\" step=\"1\" value=\"<?php echo $config['conf_DISP_CONTRAST']; ?>\">\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_IP_REPEAT\"><?php echo L::config_display_ip_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"checkbox\" id=\"conf_DISP_IP_REPEAT\" name=\"conf_DISP_IP_REPEAT\" <?php echo $config['conf_DISP_IP_REPEAT']==\"1\"?\"checked\":\"\"; ?>>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_BLACK_ON_POWER_OFF\"><?php echo L::config_display_black_on_power_off_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"checkbox\" id=\"conf_DISP_BLACK_ON_POWER_OFF\" name=\"conf_DISP_BLACK_ON_POWER_OFF\" <?php echo $config['conf_DISP_BLACK_ON_POWER_OFF']==\"1\"?\"checked\":\"\"; ?>>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h4><?php echo L::config_display_colors_header; ?></h4>\n\n\t\t\t\t\t\t<?php $display_colors_array=array('blue','green','red','white','yellow','orange','lightgrey','grey'); ?>\n\n\t\t\t\t\t\t\t<label for=\"conf_DISP_COLOR_TEXT\"><?php echo L::config_display_color_text_label; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"conf_DISP_COLOR_TEXT\" id=\"conf_DISP_COLOR_TEXT\">\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\tforeach($display_colors_array as $display_color) {\n\t\t\t\t\t\t\t\t\t\t\t$display_color_entity=\"config_display_color_\" . $display_color;\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_color . \"' \" . ($config[\"conf_DISP_COLOR_TEXT\"] == $display_color?\" selected\":\"\") . \">\" . L::{\"$display_color_entity\"}() . \"</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_COLOR_HIGH\"><?php echo L::config_display_color_high_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_COLOR_HIGH\" id=\"conf_DISP_COLOR_HIGH\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\tforeach($display_colors_array as $display_color) {\n\t\t\t\t\t\t\t\t\t\t$display_color_entity=\"config_display_color_\" . $display_color;\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_color . \"' \" . ($config[\"conf_DISP_COLOR_HIGH\"] == $display_color?\" selected\":\"\") . \">\" . L::{\"$display_color_entity\"}() . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_COLOR_ALERT\"><?php echo L::config_display_color_alert_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_COLOR_ALERT\" id=\"conf_DISP_COLOR_ALERT\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\tforeach($display_colors_array as $display_color) {\n\t\t\t\t\t\t\t\t\t\t$display_color_entity=\"config_display_color_\" . $display_color;\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_color . \"' \" . ($config[\"conf_DISP_COLOR_ALERT\"] == $display_color?\" selected\":\"\") . \">\" . L::{\"$display_color_entity\"}() . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h4><?php echo L::config_display_rotate_header; ?></h4>\n\n\t\t\t\t\t\t<label for=\"conf_DISP_ROTATE\"><?php echo L::config_display_rotate_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_ROTATE\" id=\"conf_DISP_ROTATE\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_rotate_array=array(\n\t\t\t\t\t\t\t\t\t\t'0' => '0\u00b0',\n\t\t\t\t\t\t\t\t\t\t'2' => '180\u00b0',\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tforeach($display_rotate_array as $display_rotate_code => $display_rotate_text) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_rotate_code . \"' \" . ($config[\"conf_DISP_ROTATE\"] == $display_rotate_code?\" selected\":\"\") . \">\" . $display_rotate_text . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_menu_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_menu_enable_header; ?></h3>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_MENU_ENABLED\"><?php echo L::config_menu_enable_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"checkbox\" id=\"conf_MENU_ENABLED\" name=\"conf_MENU_ENABLED\" <?php echo $config['conf_MENU_ENABLED']==\"1\"?\"checked\":\"\"; ?>>\n\t\t\t\t\t</div>\n\n\t\t\t\t<h3><?php echo L::config_menu_rotate_header; ?></h3>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_MENU_BUTTON_ROTATE\"><?php echo L::config_menu_button_rotate_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_MENU_BUTTON_ROTATE\" id=\"conf_MENU_BUTTON_ROTATE\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$button_rotate_array=array(\n\t\t\t\t\t\t\t\t\t\t'2' => '0\u00b0',\n\t\t\t\t\t\t\t\t\t\t'0' => '180\u00b0',\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tforeach($button_rotate_array as $button_rotate_code => $button_rotate_text) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $button_rotate_code . \"' \" . ($config[\"conf_MENU_BUTTON_ROTATE\"] == $button_rotate_code?\" selected\":\"\") . \">\" . $button_rotate_text . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_imageviewer_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_backup_generate_thumbnails_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_BACKUP_GENERATE_THUMBNAILS\"><?php echo L::config_backup_generate_thumbnails_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_BACKUP_GENERATE_THUMBNAILS\" name=\"conf_BACKUP_GENERATE_THUMBNAILS\" <?php echo $config['conf_BACKUP_GENERATE_THUMBNAILS']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_imageviewer_convert_heic_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_VIEW_CONVERT_HEIC\"><?php echo L::config_imageviewer_convert_heic_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_VIEW_CONVERT_HEIC\" name=\"conf_VIEW_CONVERT_HEIC\" <?php echo $config['conf_VIEW_CONVERT_HEIC']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_backup_update_exif_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_BACKUP_UPDATE_EXIF\"><?php echo L::config_backup_update_exif_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_BACKUP_UPDATE_EXIF\" name=\"conf_BACKUP_UPDATE_EXIF\" <?php echo $config['conf_BACKUP_UPDATE_EXIF']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_imageviewer_write_rating_exif_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_VIEW_WRITE_RATING_EXIF\"><?php echo L::config_imageviewer_write_rating_exif_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_VIEW_WRITE_RATING_EXIF\" name=\"conf_VIEW_WRITE_RATING_EXIF\" <?php echo $config['conf_VIEW_WRITE_RATING_EXIF']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_mail_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_behavior_notify_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_MAIL_NOTIFICATIONS\"><?php echo L::config_behavior_notify_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_MAIL_NOTIFICATIONS\" name=\"conf_MAIL_NOTIFICATIONS\"<?php echo $config['conf_MAIL_NOTIFICATIONS']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_behavior_mail_html_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_MAIL_HTML\"><?php echo L::config_behavior_mail_html_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_MAIL_HTML\" name=\"conf_MAIL_HTML\"<?php echo $config['conf_MAIL_HTML']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_mail_smtp_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_SMTP_SERVER\"><?php echo L::config_mail_smtp_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_SMTP_SERVER\" name=\"conf_SMTP_SERVER\" size=\"6\" value=\"<?php echo $config['conf_SMTP_SERVER']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_mail_port_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_SMTP_PORT\"><?php echo L::config_mail_port_label . \" \" . $config_standard[\"conf_SMTP_PORT\"]; ?>)</label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_SMTP_PORT\" name=\"conf_SMTP_PORT\" size=\"20\" value=\"<?php echo $config['conf_SMTP_PORT']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_mail_security_header; ?></h3>\n\t\t\t\t\t<input type=\"radio\" id=\"conf_MAIL_SECURITY_STARTTLS\" name=\"conf_MAIL_SECURITY\" value=\"STARTTLS\" <?php echo $config['conf_MAIL_SECURITY']!==\"SSL\"?\"checked\":\"\"; ?>>\n\t\t\t\t\t<label for=\"conf_MAIL_SECURITY_STARTTLS\">STARTTLS</label><br>\n\t\t\t\t\t<input type=\"radio\" id=\"conf_MAIL_SECURITY_SSL\" name=\"conf_MAIL_SECURITY\" value=\"SSL\" <?php echo $config['conf_MAIL_SECURITY']==\"SSL\"?\"checked\":\"\"; ?>>\n\t\t\t\t\t<label for=\"conf_MAIL_SECURITY_SSL\">SSL</label><br>\n\n\t\t\t\t<h3><?php echo L::config_mail_user_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_MAIL_USER\"><?php echo L::config_mail_user_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_MAIL_USER\" name=\"conf_MAIL_USER\" size=\"20\" value=\"<?php echo $config['conf_MAIL_USER']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_mail_password_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_MAIL_PASSWORD\"><?php echo L::config_mail_password_label; ?></label><br>\n\t\t\t\t\t<input type=\"password\" id=\"conf_MAIL_PASSWORD\" name=\"conf_MAIL_PASSWORD\" size=\"20\" value=\"<?php echo $config['conf_MAIL_PASSWORD']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_mail_sender_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_MAIL_FROM\"><?php echo L::config_mail_sender_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_MAIL_FROM\" name=\"conf_MAIL_FROM\" size=\"20\" value=\"<?php echo $config['conf_MAIL_FROM']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_mail_recipient_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_MAIL_TO\"><?php echo L::config_mail_recipient_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_MAIL_TO\" name=\"conf_MAIL_TO\" size=\"20\" value=\"<?php echo $config['conf_MAIL_TO']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_mail_testmail_header; ?></h3>\n\t\t\t\t\t<label for=\"send_testmail\"><?php echo L::config_mail_testmail_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"send_testmail\" name=\"send_testmail\">\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_rsync_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_rsync_server_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_RSYNC_SERVER\"><?php echo L::config_rsync_server_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_RSYNC_SERVER\" name=\"conf_RSYNC_SERVER\" size=\"6\" value=\"<?php echo $config['conf_RSYNC_SERVER']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_rsync_port_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_RSYNC_PORT\"><?php echo L::config_rsync_port_label . \" \" . $config_standard['conf_RSYNC_PORT']; ?>)</label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_RSYNC_PORT\" name=\"conf_RSYNC_PORT\" size=\"20\" value=\"<?php echo $config['conf_RSYNC_PORT']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_rsync_user_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_RSYNC_USER\"><?php echo L::config_rsync_user_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_RSYNC_USER\" name=\"conf_RSYNC_USER\" size=\"20\" value=\"<?php echo $config['conf_RSYNC_USER']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_rsync_password_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_RSYNC_PASSWORD\"><?php echo L::config_rsync_password_label; ?></label><br>\n\t\t\t\t\t<input type=\"password\" id=\"conf_RSYNC_PASSWORD\" name=\"conf_RSYNC_PASSWORD\" size=\"20\" value=\"<?php echo $config['conf_RSYNC_PASSWORD']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_rsync_module_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_RSYNC_SERVER_MODULE\"><?php echo L::config_rsync_module_label1 .  $config_standard['conf_RSYNC_SERVER_MODULE'] . L::config_rsync_module_label2; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_RSYNC_SERVER_MODULE\" name=\"conf_RSYNC_SERVER_MODULE\" size=\"20\" value=\"<?php echo $config['conf_RSYNC_SERVER_MODULE']; ?>\">\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_cloud_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_backup_target_basedir_cloud_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_BACKUP_TARGET_BASEDIR_CLOUD\"><?php echo L::config_backup_target_basedir_cloud_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_BACKUP_TARGET_BASEDIR_CLOUD\" name=\"conf_BACKUP_TARGET_BASEDIR_CLOUD\" size=\"6\" value=\"<?php echo $config['conf_BACKUP_TARGET_BASEDIR_CLOUD']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_cloud_header; ?></h3>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t<?php echo L::config_cloud_rclone_description ; ?><br>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\tif (empty($config['conf_PASSWORD'])) {\n\t\t\t\t\t\t\t\techo L::config_username . \": 'lbb', \" . L::config_password . \": 'lbb'\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\techo L::config_username . \": 'lbb', \" . L::config_password_as_set_in . \" '\" . L::config_password_section . \"'\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\n\t\t\t\t\t</p>\n\t\t\t\t\t<?php\n\t\t\t\t\t\tif (strpos($_SERVER['SERVER_PORT'], \"443\") !== false) {\n\t\t\t\t\t\t\t$rclone_link=\"https://\" . $_SERVER['SERVER_ADDR'] . \":8443\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$rclone_link=\"http://\" . $_SERVER['SERVER_ADDR'] . \":81\";\n\t\t\t\t\t\t}\n\t\t\t\t\t?>\n\t\t\t\t\t<a href=\"<?php echo $rclone_link; ?>\" target=\"_blank\"><?php echo L::config_cloud_rclone_gui; ?></a>\n\n\t\t\t\t<h3><?php echo L::config_cloud_restart_header; ?></h3>\n\t\t\t\t\t<label for=\"restart_rclone_gui\"><?php echo L::config_cloud_restart_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"restart_rclone_gui\" name=\"restart_rclone_gui\">\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_vpn_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_vpn_type_header; ?></h3>\n\n\t\t\t\t\t<div><?php echo L::config_vpn_type_desc; ?></div>\n\t\t\t\t\t<br>\n\t\t\t\t\t<label for=\"conf_VPN_TYPE_RSYNC\"><?php echo L::config_vpn_type_rsync_label; ?></label><br>\n\t\t\t\t\t<select name=\"conf_VPN_TYPE_RSYNC\" id=\"conf_VPN_TYPE_RSYNC\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\techo \"<option value='none'  \" . ($config[\"conf_VPN_TYPE_RSYNC\"] == \"none\"?\" selected\":\"\") . \">\" . L::config_vpn_type_none . \"</option>\";\n\t\t\t\t\t\t\tforeach($vpn_types as $vpn_type) {\n\t\t\t\t\t\t\t\techo \"<option value='\" . $vpn_type . \"' \" . ($config[\"conf_VPN_TYPE_RSYNC\"] == $vpn_type?\" selected\":\"\") . \">\" . $vpn_type . \"</option>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</select><br>\n\n\t\t\t\t\t<label for=\"conf_VPN_TYPE_CLOUD\"><?php echo L::config_vpn_type_cloud_label; ?></label><br>\n\t\t\t\t\t<select name=\"conf_VPN_TYPE_CLOUD\" id=\"conf_VPN_TYPE_CLOUD\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\techo \"<option value='none'  \" . ($config[\"conf_VPN_TYPE_CLOUD\"] == \"none\"?\" selected\":\"\") . \">\" . L::config_vpn_type_none . \"</option>\";\n\t\t\t\t\t\t\tforeach($vpn_types as $vpn_type) {\n\t\t\t\t\t\t\t\techo \"<option value='\" . $vpn_type . \"' \" . ($config[\"conf_VPN_TYPE_CLOUD\"] == $vpn_type?\" selected\":\"\") . \">\" . $vpn_type . \"</option>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</select>\n\n\t\t\t\t<h3><?php echo L::config_vpn_timeout_header; ?></h3>\n\n\t\t\t\t\t<label for=\"conf_VPN_TIMEOUT\"><?php echo L::config_vpn_timeout_label; ?></label><br>\n\t\t\t\t\t<select name=\"conf_VPN_TIMEOUT\" id=\"conf_VPN_TIMEOUT\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t$vpn_timeouts\t= array(5,10,20,30,40,50,60,90,120,300,600);\n\t\t\t\t\t\t\tforeach($vpn_timeouts as $vpn_timeout) {\n\t\t\t\t\t\t\t\techo \"<option value='\" . $vpn_timeout . \"' \" . ($config[\"conf_VPN_TIMEOUT\"] == $vpn_timeout?\" selected\":\"\") . \">\" . $vpn_timeout . ' ' . L::seconds_short . \"</option>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</select>\n\n\t\t\t\t<h3><?php echo L::config_vpn_upload_header; ?></h3>\n\n\t\t\t\t\t<label for=\"vpn_upload_type\"><?php echo L::config_vpn_upload_type_label; ?></label>\n\t\t\t\t\t<select name=\"vpn_upload_type\" id=\"vpn_upload_type\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\techo \"<option value='none' selected>\" . L::config_vpn_upload_type_none . \"</option>\";\n\t\t\t\t\t\t\tforeach($vpn_types as $vpn_type) {\n\t\t\t\t\t\t\t\techo \"<option value='\" . $vpn_type . \"'>\" . $vpn_type . \"</option>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</select>\n\n\t\t\t\t\t<label for=\"vpn_conf_file\"><?php echo L::config_vpn_upload_file_label; ?></label>\n\t\t\t\t\t<input type=\"file\" name=\"vpn_conf_file\" id=\"vpn_conf_file\">\n\n\t\t\t\t\t<?php\n\t\t\t\t\t\t$vpn_remove_section\t= False;\n\t\t\t\t\t\tforeach($vpn_types as $vpn_type) {\n\t\t\t\t\t\t\t$vpn_file_exists[$vpn_type]\t= exec('sudo -- bash -c \"if [ -f \\\"' . $constants['const_VPN_DIR_' . $vpn_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_type] . '\\\" ]; then echo \\\"true\\\"; fi\"')==\"true\";\n\t\t\t\t\t\t\tif ($vpn_file_exists[$vpn_type]) {$vpn_remove_section = True;}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ($vpn_remove_section) {\n\t\t\t\t\t\t\t\techo ('<h3>' . L::config_vpn_remove_header .'</h3>');\n\n\t\t\t\t\t\t\t\t\tforeach($vpn_types as $vpn_type) {\n\t\t\t\t\t\t\t\t\t\tif ($vpn_file_exists[$vpn_type]) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<p>\";\n\t\t\t\t\t\t\t\t\t\t\techo ('<label for=\"vpn_remove_' . $vpn_type . '\">' . $vpn_type . '</label><br>');\n\t\t\t\t\t\t\t\t\t\t\techo ('<input type=\"checkbox\" id=\"vpn_remove_' . $vpn_type . '\" name=\"vpn_remove_' . $vpn_type . '\">');\n\t\t\t\t\t\t\t\t\t\t\techo \"</p>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t?>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_wifi_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_wifi_country_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_WIFI_COUNTRY\"><?php echo L::config_wifi_country_label; ?></label><br>\n\t\t\t\t\t<?php echo get_wifi_country_selector(\"conf_WIFI_COUNTRY\",\"conf_WIFI_COUNTRY\"); ?>\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_hardware_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_display_hardware_header; ?></h3>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_DRIVER\"><?php echo L::config_display_driver_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_DRIVER\" id=\"conf_DISP_DRIVER\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_drivers_array=array(\n\t\t\t\t\t\t\t\t\t\t\"SSD1306\",\n\t\t\t\t\t\t\t\t\t\t\"SSD1309\",\n\t\t\t\t\t\t\t\t\t\t\"SSD1322\",\n\t\t\t\t\t\t\t\t\t\t\"SSD1331\",\n\t\t\t\t\t\t\t\t\t\t\"SH1106\"\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tforeach($display_drivers_array as $display_driver) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_driver . \"' \" . ($config[\"conf_DISP_DRIVER\"] == $display_driver?\" selected\":\"\") . \">\" . $display_driver . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n<div>\n\t\t\t\t\t\t<h4><?php echo L::config_display_connection_header; ?></h4>\n\t\t\t\t\t\t\t<label for=\"conf_DISP_CONNECTION\"><?php echo L::config_display_connection_label; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"conf_DISP_CONNECTION\" id=\"conf_DISP_CONNECTION\">\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t$display_connections_array=array(\"I2C\",\"SPI\");\n\t\t\t\t\t\t\t\t\t\tforeach($display_connections_array as $display_connection) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_connection . \"' \" . ($config[\"conf_DISP_CONNECTION\"] == $display_connection?\" selected\":\"\") . \">\" . $display_connection . \"</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h4><?php echo L::config_display_i2c_header; ?></h4>\n\t\t\t\t\t\t\t<label for=\"conf_DISP_I2C_ADDRESS\"><?php echo L::config_display_i2c_address_label; ?></label><br>\n\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t$I2C_DETECT=shell_exec(\"sudo i2cdetect -y 1\");\n\n\t\t\t\t\t\t\t\t$I2C_LIST=array(\"0x3c\",\"0x3d\");\n\t\t\t\t\t\t\t\tforeach($I2C_LIST as $I2C) {\n\t\t\t\t\t\t\t\t\tif (! in_array($config['conf_DISP_I2C_ADDRESS'], $I2C_LIST)) {\n\t\t\t\t\t\t\t\t\t\t$config['conf_DISP_I2C_ADDRESS']\t= $I2C;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"conf_DISP_I2C_ADDRESS_<?php echo $I2C; ?>\" name=\"conf_DISP_I2C_ADDRESS\" value=\"<?php echo $I2C; ?>\" <?php echo strcasecmp($config['conf_DISP_I2C_ADDRESS'],$I2C)==0?\"checked\":\"\"; ?>>\n\t\t\t\t\t\t\t\t\t<label for=\"conf_DISP_I2C_ADDRESS_<?php echo $I2C; ?>\"><?php echo $I2C; ?> <?php echo strpos($I2C_DETECT,\" \" . $I2C)?\" - \" . L::config_display_device_available:\"\"; ?></label><br>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h4><?php echo L::config_display_spi_header; ?></h4>\n\t\t\t\t\t\t\t<label for=\"conf_DISP_SPI_PORT\"><?php echo L::config_display_spi_port_label; ?></label><br>\n\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t$spi_ports_array=array(\"0\",\"1\");\n\t\t\t\t\t\t\t\t\t\tforeach($spi_ports_array as $spi_port) {\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"conf_DISP_SPI_PORT_<?php echo $spi_port; ?>\" name=\"conf_DISP_SPI_PORT\" value=\"<?php echo $spi_port; ?>\" <?php echo strcasecmp($config['conf_DISP_SPI_PORT'],$spi_port)==0?\"checked\":\"\"; ?>>\n\t\t\t\t\t\t\t\t\t<label for=\"conf_DISP_SPI_PORT_<?php echo $spi_port; ?>\"><?php echo $spi_port; ?></label><br>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_RESOLUTION_X\"><?php echo L::config_display_resolution_x_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_RESOLUTION_X\" id=\"conf_DISP_RESOLUTION_X\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_resolutions_array=array(96,128);\n\t\t\t\t\t\t\t\t\tforeach($display_resolutions_array as $display_resolution) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_resolution . \"' \" . ($config[\"conf_DISP_RESOLUTION_X\"] == $display_resolution?\" selected\":\"\") . \">\" . $display_resolution . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_RESOLUTION_Y\"><?php echo L::config_display_resolution_y_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_RESOLUTION_Y\" id=\"conf_DISP_RESOLUTION_Y\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_resolutions_array=array(\"64\",\"32\");\n\t\t\t\t\t\t\t\t\tforeach($display_resolutions_array as $display_resolution) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_resolution . \"' \" . ($config[\"conf_DISP_RESOLUTION_Y\"] == $display_resolution?\" selected\":\"\") . \">\" . $display_resolution . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_COLOR_MODEL\"><?php echo L::config_display_color_model_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_COLOR_MODEL\" id=\"conf_DISP_COLOR_MODEL\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_color_models_array=array(\"1\",\"RGB\",\"RGBA\");\n\t\t\t\t\t\t\t\t\tforeach($display_color_models_array as $display_color_model) {\n\t\t\t\t\t\t\t\t\t\t$display_color_model_entity=\"config_display_color_model_\" . $display_color_model;\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_color_model . \"' \" . ($config[\"conf_DISP_COLOR_MODEL\"] == $display_color_model?\" selected\":\"\") . \">\" . L::{\"$display_color_model_entity\"}() . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t<h3><?php echo L::config_menu_button_header; ?></h3>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_MENU_BUTTON_COMBINATION\"><?php echo L::config_menu_button_combination_label; ?></label><br>\n\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t$button_combinations\t= array();\n\n\t\t\t\t\t\t\t\t$button_config_files\t= array(\n\t\t\t\t\t\t\t\t\t$WORKING_DIR.'/'.$constants['const_BUTTONS_CONFIG_FILE'],\n\t\t\t\t\t\t\t\t\t$constants['const_MEDIA_DIR'].'/'.$constants['const_BUTTONS_PRIVATE_CONFIG_FILE']\n\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t$BasicLines\t= 0;\n\t\t\t\t\t\t\t\tforeach ($button_config_files as $button_config_file) {\n\n\t\t\t\t\t\t\t\t\tif ($f = fopen($button_config_file, \"r\")) {\n\t\t\t\t\t\t\t\t\t\twhile(!feof($f)) {\n\t\t\t\t\t\t\t\t\t\t\t$Line = trim(fgets($f));\n\t\t\t\t\t\t\t\t\t\t\tif (! empty($Line)) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (substr($Line,0,1) != '#') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t$CombinationArray\t= array(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'up' \t\t=> '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'down'\t\t=> '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'left' \t\t=> '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'right'\t\t=> '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'comment'\t=> ''\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t$explodeLine\t= explode(':',$Line,2);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (count($explodeLine) > 1) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$CombinationArray['comment']\t= $explodeLine[1];\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t$PIN_Defs\t\t= explode(',',$explodeLine[0]);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tforeach($PIN_Defs as $PIN_Def) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$explodePinDef\t= explode('=', $PIN_Def);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (count($explodePinDef) == 2) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (in_array($explodePinDef[1],array('up','down','left','right','comment'))) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (! empty($CombinationArray[$explodePinDef[1]])) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$CombinationArray[$explodePinDef[1]]\t.= ', ';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$CombinationArray[$explodePinDef[1]]\t.= $explodePinDef[0];\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tarray_push($button_combinations,$CombinationArray);\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ($button_config_file == $button_config_files[0]) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$BasicLines\t+= 1;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tfclose($f);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t<select name=\"conf_MENU_BUTTON_COMBINATION\" id=\"conf_MENU_BUTTON_COMBINATION\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\tforeach($button_combinations as $variant => $button_combination) {\n\t\t\t\t\t\t\t\t\t\tif ($variant < $BasicLines) {\n\t\t\t\t\t\t\t\t\t\t\t$VariantOption\t= $variant + 1;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t$VariantOption\t= 'c' . ($variant - $BasicLines + 1);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\techo (\"<option value='\" . $VariantOption . \"' \" . ($config[\"conf_MENU_BUTTON_COMBINATION\"] == $VariantOption?\" selected\":\"\") . \">\" . $VariantOption . \"</option>\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\n\t\t\t\t\t\t\t<table style=\"width: 100%;\">\n\t\t\t\t\t\t\t\t<tr style=\"border: thin solid;\">\n\t\t\t\t\t\t\t\t\t<th style=\"width: 20%;\">\n\t\t\t\t\t\t\t\t\t\t<?php echo L::config_menu_button_combination_variant; ?>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th style=\"width: 20%;\">\n\t\t\t\t\t\t\t\t\t\t<?php echo L::config_menu_button_up; ?>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th>\n\t\t\t\t\t\t\t\t\t\t<?php echo L::config_menu_button_down; ?>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th style=\"width: 20%;\">\n\t\t\t\t\t\t\t\t\t\t<?php echo L::config_menu_button_left; ?>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th style=\"width: 20%;\">\n\t\t\t\t\t\t\t\t\t\t<?php echo L::config_menu_button_right; ?>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th style=\"width: 20%;\">\n\t\t\t\t\t\t\t\t\t\t<?php echo L::config_menu_button_comment; ?>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\tforeach($button_combinations as $variant => $button_combination) {\n\t\t\t\t\t\t\t\t\t\tif ($variant < $BasicLines) {\n\t\t\t\t\t\t\t\t\t\t\t$openerTAG\t\t= '';\n\t\t\t\t\t\t\t\t\t\t\t$closerTAG\t\t= '';\n\t\t\t\t\t\t\t\t\t\t\t$VariantOption\t= $variant + 1;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t$openerTAG\t\t= '<b><i>';\n\t\t\t\t\t\t\t\t\t\t\t$closerTAG\t\t= '</i></b>';\n\t\t\t\t\t\t\t\t\t\t\t$VariantOption\t= 'c' . ($variant - $BasicLines + 1);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\techo(\"<tr style=\\\"border: thin solid; vertical-align: top;\\\"><td>\".$openerTAG.$VariantOption.$closerTAG.\"</td>\");\n\t\t\t\t\t\t\t\t\t\tforeach($button_combination as $column => $FIELD) {\n\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t\t<td style=\"border: thin solid; vertical-align: top;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php echo ($openerTAG.$FIELD.$closerTAG); ?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\techo(\"</tr>\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t<a href=\"/files/index.php?p=&edit=buttons.private.cfg\"><?php echo L::config_menu_button_edit_custom_configfile; ?></a>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_MENU_BUTTON_BOUNCETIME\"><?php echo L::config_menu_button_bouncetime_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_MENU_BUTTON_BOUNCETIME\" id=\"conf_MENU_BUTTON_BOUNCETIME\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$button_bouncetimes_array=array(25,50,100,200,300,400,500);\n\t\t\t\t\t\t\t\t\tforeach($button_bouncetimes_array as $button_bouncetime) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $button_bouncetime . \"' \" . ($config[\"conf_MENU_BUTTON_BOUNCETIME\"] == $button_bouncetime?\" selected\":\"\") . \">\" . $button_bouncetime . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select><br>\n\n\t\t\t\t\t\t<label for=\"conf_MENU_BUTTON_EDGE_DETECTION\"><?php echo L::config_menu_button_edge_detection_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_MENU_BUTTON_EDGE_DETECTION\" id=\"conf_MENU_BUTTON_EDGE_DETECTION\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$button_edge_detections_array=array('RISING','FALLING');\n\t\t\t\t\t\t\t\t\tforeach($button_edge_detections_array as $button_edge_detection) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $button_edge_detection . \"' \" . ($config[\"conf_MENU_BUTTON_EDGE_DETECTION\"] == $button_edge_detection?\" selected\":\"\") . \">\" . $button_edge_detection . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select><br>\n\n\t\t\t\t\t\t<label for=\"conf_MENU_BUTTON_RESISTOR_PULL\"><?php echo L::config_menu_button_resitor_pull_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_MENU_BUTTON_RESISTOR_PULL\" id=\"conf_MENU_BUTTON_RESISTOR_PULL\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$button_resitor_pulls_array=array('DOWN','UP');\n\t\t\t\t\t\t\t\t\tforeach($button_resitor_pulls_array as $button_resitor_pull) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $button_resitor_pull . \"' \" . ($config[\"conf_MENU_BUTTON_RESISTOR_PULL\"] == $button_resitor_pull?\" selected\":\"\") . \">\" . $button_resitor_pull . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t<h3><?php echo L::config_hardware_fan_header; ?></h3>\n\t\t\t\t\t<div>\n\t\t\t\t\t<label for=\"conf_FAN_PWM_TEMP_C\"><?php echo L::config_hardware_fan_temp_label; ?></label><br>\n\t\t\t\t\t\t<select name=\"conf_FAN_PWM_TEMP_C\" id=\"conf_FAN_PWM_TEMP_C\">\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t$conf_FAN_PWM_TEMP_Cs=array(0,60,65,70,75,80);# allowed 60..120 \u00b0C\n\t\t\t\t\t\t\t\tforeach($conf_FAN_PWM_TEMP_Cs as $conf_FAN_PWM_TEMP_C) {\n\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $conf_FAN_PWM_TEMP_C .\"\\\"\". ($config[\"conf_FAN_PWM_TEMP_C\"]==$conf_FAN_PWM_TEMP_C?\" selected\":\"\") . \">\" . ($conf_FAN_PWM_TEMP_C==\"0\"?L::config_hardware_fan_always_on:$conf_FAN_PWM_TEMP_C . \" \" . L::units_celsius) . \"</option>\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_FAN_PWM_GPIO\"><?php echo L::config_hardware_fan_gpio_label; ?></label><br>\n\t\t\t\t\t\t<select name=\"conf_FAN_PWM_GPIO\" id=\"conf_FAN_PWM_GPIO\">\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t$conf_FAN_PWM_GPIOs=array('-','14','15','18','23','24'); # allowed 2..27\n\t\t\t\t\t\t\t\tforeach($conf_FAN_PWM_GPIOs as $conf_FAN_PWM_GPIO) {\n\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $conf_FAN_PWM_GPIO .\"\\\"\". ($config[\"conf_FAN_PWM_GPIO\"]==$conf_FAN_PWM_GPIO?\" selected\":\"\") . \">\" . $conf_FAN_PWM_GPIO . \"</option>\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_password_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_password_header; ?></h3>\n\t\t\t\t\t<input type=\"hidden\" id=\"conf_PASSWORD_OLD\" name=\"conf_PASSWORD_OLD\" value=\"<?php echo $config['conf_PASSWORD']; ?>\">\n\t\t\t\t\t<label for=\"conf_PASSWORD_1\"><p><?php echo L::config_password_global_lbb_label . '</p><p style=\"text-decoration: underline;\">' . L::config_password_global_wifi_label . '</p><p><b>' . L::config_alert_password_characters_not_allowed . '</b>'; ?></label></p>\n\t\t\t\t\t<input type=\"password\" id=\"conf_PASSWORD_1\" name=\"conf_PASSWORD_1\" size=\"20\" value=\"\">\n\t\t\t\t\t<label for=\"conf_PASSWORD_2\"><?php echo L::config_password_repeat_label; ?></label><br>\n\t\t\t\t\t<input type=\"password\" id=\"conf_PASSWORD_2\" name=\"conf_PASSWORD_2\" size=\"20\" value=\"\">\n\n\t\t\t\t\t<?php\n\t\t\t\t\t\tif ($config['conf_PASSWORD'] != \"\") {\n\t\t\t\t\t\t\techo \"<h3>\" . L::config_password_remove_header . \"</h3>\";\n\t\t\t\t\t\t\techo \"<p>\";\n\t\t\t\t\t\t\techo \"<label for=\\\"conf_PASSWORD_REMOVE\\\">\" . L::config_password_remove_label .\"</label><br>\";\n\t\t\t\t\t\t\techo \"<input type=\\\"checkbox\\\" id=\\\"conf_PASSWORD_REMOVE\\\" name=\\\"conf_PASSWORD_REMOVE\\\">&nbsp;\";\n\t\t\t\t\t\t\techo \"</p>\";\n\t\t\t\t\t\t}\n\t\t\t\t\t?>\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<?php echo '<button style=\"margin-top: 2em;\" type=\"submit\" name=\"save\">' . L::config_save_button . '</button>'; ?>\n\t\t</div>\n\n\t</form>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_save_settings_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_save_settings_download_header; ?></h3>\n\t\t\t\t\t<p><?php echo L::config_save_settings_download_text; ?></p>\n\t\t\t\t\t<a href=\"download-settings.php\"><?php echo L::config_save_settings_download_link_text; ?></a>\n\n\t\t\t\t<h3><?php echo L::config_save_settings_upload_header; ?></h3>\n\t\t\t\t\t<form action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST\" enctype=\"multipart/form-data\">\n\t\t\t\t\t\t<label for=\"settings_file\"><?php echo L::config_save_settings_upload_label; ?></label>\n\t\t\t\t\t\t<input type=\"file\" name=\"settings_file\" id=\"settings_file\">\n\t\t\t\t\t\t<button style=\"margin-top: 2em;\" type=\"submit\" name=\"upload_settings\"><?php echo L::config_save_settings_upload_button; ?></button>\n\t\t\t\t\t</form>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<?php if (shell_exec('which comitup-cli') != '') { ?>\n\t\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t\t<details>\n\t\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_comitup_section; ?></summary>\n\t\t\t\t\t<?php echo L::config_comitup_text; ?><br>\n\t\t\t\t\t<br>\n\t\t\t\t\t<a href='/cmd.php?CMD=comitup_reset'><?php echo L::config_comitup_linktext ?></a>\n\t\t\t\t</details>\n\t\t\t</div>\n\t\t<?php } ?>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_update_section; ?></summary>\n\t\t\t\t<?php echo L::config_update_text; ?>\n\t\t\t\t<ul>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<?php echo ($constants['const_SOFTWARE_VERSION'] == 'main' ? '<b>' : ''); ?>\n\t\t\t\t\t\t\t<a href='/cmd.php?CMD=update'><?php echo L::config_update_linktext ?></a>\n\t\t\t\t\t\t<?php echo ($constants['const_SOFTWARE_VERSION'] == 'main' ? '</b>' : ''); ?>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<?php echo ($constants['const_SOFTWARE_VERSION'] == 'development' ? '<b>' : ''); ?>\n\t\t\t\t\t\t\t<a href='/cmd.php?CMD=update_development'><?php echo L::config_update_development_linktext ?></a>\n\t\t\t\t\t\t<?php echo ($constants['const_SOFTWARE_VERSION'] == 'development' ? '<b>' : ''); ?>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</details>\n\t\t</div>\n\n\t\t<?php include \"sub-footer.php\"; ?>\n\n</body>\n\n</html>\n", "<!doctype html>\n\n<!-- Author: Stefan Saam, github@saams.de\n         License: GPLv3 https://www.gnu.org/licenses/gpl-3.0.txt -->\n\n<?php\n\t$WORKING_DIR=dirname(__FILE__);\n\t$config = parse_ini_file(\"config.cfg\", false);\n\t$constants = parse_ini_file(\"constants.sh\", false);\n\t$theme = $config[\"conf_THEME\"];\n\t$background = $config[\"conf_BACKGROUND_IMAGE\"] == \"\"?\"\":\"background='\" . $constants[\"const_MEDIA_DIR\"] . '/' . $constants[\"const_BACKGROUND_IMAGES_DIR\"] . \"/\" . $config[\"conf_BACKGROUND_IMAGE\"] . \"'\";\n\n\tinclude(\"sub-popup.php\");\n\n\tinclude(\"get-cloudservices.php\");\n\n\t# symlink to media-folder\n\tif (! file_exists(\"./media\")) {\n\t\tsymlink(\"/media\", \"./media\");\n\t}\n\n\n\tfunction urlencode_keep_slashes($href) {\n\t\treturn(\n\t\t\tstr_replace('//','/',\n\t\t\t\tstr_replace('%2F','/',rawurlencode($href))\n\t\t\t)\n\t\t);\n\t}\n\n\tfunction navigator($view_mode,$imagecount,$filter_images_per_page,$select_offset,$filter_rating,$IMAGE_ID_PRE,$IMAGE_ID,$IMAGE_ID_POST,$IMAGE_ID_FIRST,$IMAGE_ID_LAST,$GET_PARAMETER,$order_by,$order_dir,$label_filename,$label_creationdate,$label_id) {\n\t\tif ($view_mode == \"grid\") {\n\t\t\t?>\n\t\t\t<div class=\"card\" style=\"margin-top: 2em;display: inline-block;width: 100%\">\n\t\t\t\t<div style=\"float:left;width: 50%;padding: 5px;\">\n\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . \"&ID=\" . $IMAGE_ID_FIRST; ?>\">&lt;&lt;</a>\n\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . \"&ID=\" . $IMAGE_ID_PRE; ?>\">&lt;</a>\n\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t\t<?php\n\n\t\t\t\t\t\t$link_order_text\t= $label_creationdate;\n\t\t\t\t\t\t$link_order\t\t\t= $GET_PARAMETER . \"&order_by=Create_Date&order_dir=\";\n\t\t\t\t\t\tif ($order_by==\"Create_Date\") {\n\t\t\t\t\t\t\t$link_order_text\t.= $order_dir == \"ASC\"?\"&darr;\":\"&uarr;\"; #symbol reversed because of print-direction up to down\n\t\t\t\t\t\t\t$link_order_text\t= \"<b>\" . $link_order_text . \"</b>\";\n\t\t\t\t\t\t\t$link_order\t\t\t.= $order_dir == \"ASC\"?\"DESC\":\"ASC\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$link_order\t\t\t.= \"ASC\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\techo \"<a href='\" . $link_order . \"'>\" . $link_order_text . \"</a>\";\n\n\t\t\t\t\t\t$page\t= intval(($select_offset + 2) / $filter_images_per_page) + 1;\n\t\t\t\t\t\t$pages\t= intval($imagecount / $filter_images_per_page) + 1;\n\t\t\t\t\t\techo \"&nbsp;&nbsp;&nbsp;&nbsp;\" . L::view_images_page . ' ' . $page . '/' . $pages;\n\t\t\t\t\t?>\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"float:right;width: 50%;padding: 5px;text-align: right\">\n\t\t\t\t\t<?php\n\t\t\t\t\t\t$link_order_text\t= $label_filename;\n\t\t\t\t\t\t$link_order\t\t\t= $GET_PARAMETER . \"&order_by=File_Name&order_dir=\";\n\t\t\t\t\t\tif ($order_by==\"File_Name\") {\n\t\t\t\t\t\t\t$link_order_text\t.= $order_dir == \"ASC\"?\"&darr;\":\"&uarr;\"; #symbol reversed because of print-direction up to down\n\t\t\t\t\t\t\t$link_order_text\t= \"<b>\" . $link_order_text . \"</b>\";\n\t\t\t\t\t\t\t$link_order\t\t\t.= $order_dir == \"ASC\"?\"DESC\":\"ASC\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$link_order\t\t\t.= \"ASC\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\techo $imagecount . ' ' . L::view_images_images . \"&nbsp;&nbsp;&nbsp;&nbsp;\";\n\n\t\t\t\t\t\techo \"<a href='\" . $link_order . \"'>\" . $link_order_text . \"</a>&nbsp;&nbsp;&nbsp;&nbsp;\";\n\n\t\t\t\t\t\t$link_order_text\t= $label_id;\n\t\t\t\t\t\t$link_order\t\t\t= $GET_PARAMETER . \"&order_by=ID&order_dir=\";\n\t\t\t\t\t\tif ($order_by==\"ID\") {\n\t\t\t\t\t\t\t$link_order_text\t.= $order_dir == \"ASC\"?\"&darr;\":\"&uarr;\"; #symbol reversed because of print-direction up to down\n\t\t\t\t\t\t\t$link_order_text\t= \"<b>\" . $link_order_text . \"</b>\";\n\t\t\t\t\t\t\t$link_order\t\t\t.= $order_dir == \"ASC\"?\"DESC\":\"ASC\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$link_order\t\t\t.= \"ASC\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\techo \"<a href='\" . $link_order . \"'>\" . $link_order_text . \"</a>\";\n\t\t\t\t\t?>\n\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . \"&ID=\" . $IMAGE_ID_POST; ?>\">&gt;</a>\n\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . \"&ID=\" . $IMAGE_ID_LAST; ?>\">&gt;&gt;</a>\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"display: flow-root;width: 100%\">\n\n\t\t\t\t\t<div style=\"float:left;width: 50%;padding: 5px\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\tif ($filter_rating == 1) {\n\t\t\t\t\t\t\t\techo \"<button style=\\\"margin-top: 2em;\\\" type=\\\"submit\\\" name=\\\"delete_ratings_1\\\" class=\\\"danger\\\">\" . L::view_ratings_1_delete_button . \"</button>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div style=\"float:right;width: 50%;padding: 5px;text-align: right;\">\n\t\t\t\t\t\t<button style=\"margin-top: 2em;\" type=\"submit\" name=\"save_ratings\"><?php echo L::view_ratings_save_button; ?></button>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<?php\n\t\t} else {\n// \t\t\t$view_mode=\"single\"\n\t\t\t?>\n\t\t\t<div class=\"card\" style=\"margin-top: 2em;display: inline-block;width: 100%\">\n\t\t\t\t<div style=\"float:left;width: 50%;padding: 5px;\">\n\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . '&view_mode=grid&ID=' . $IMAGE_ID; ?>\">\n\t\t\t\t\t\t<?php echo L::view_images_back_to_grid; ?>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"float:left;width: 100%;padding: 5px;text-align: right;\">\n\t\t\t\t\t<div style=\"float:left;width: 33%;text-align: left;padding: 0;\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\tif ($IMAGE_ID_PRE > 0) {\n\t\t\t\t\t\t\t\techo \"<button style=\\\"margin-top: 2em;\\\" type=\\\"submit\\\" name=\\\"ID\\\" value=\\\"\" . $IMAGE_ID_PRE . \"\\\">&lt; \" . L::view_ratings_save_button . \"</button>\";\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\techo \"&nbsp;\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div style=\"float:left;width: 34%;text-align: center;padding: 0;\">\n\t\t\t\t\t\t<button style=\"margin-top: 2em;\" type=\"submit\" name=\"ID\" value=\"<?php echo $IMAGE_ID; ?>\"><?php echo L::view_ratings_save_button ?></button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div style=\"float:left;width: 33%;text-align: right;padding: 0;\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\tif ($IMAGE_ID_POST > 0) {\n\t\t\t\t\t\t\t\techo \"<button style=\\\"margin-top: 2em;\\\" type=\\\"submit\\\" name=\\\"ID\\\" value=\\\"\" . $IMAGE_ID_POST . \"\\\">\" . L::view_ratings_save_button . \" &gt;</button>\";\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\techo \"&nbsp;\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<?php\n\t\t}\n\t}\n\n\tfunction rating_radio($IMAGE_ID, $IMAGE_RATING) {\n\t\t?>\n\t\t\t<div style=\"float:left;padding: 2px;\" class=\"rating\">\n\t\t\t\t<input id=\"rating_1_<?php echo $IMAGE_ID; ?>\" type=\"radio\" name=\"rating_<?php echo $IMAGE_ID; ?>\" value=\"1\" <?php echo $IMAGE_RATING>=1?\"checked\":\"\"; ?>>\n\t\t\t\t<label for=\"rating_1_<?php echo $IMAGE_ID; ?>\"></label>\n\t\t\t\t<input id=\"rating_2_<?php echo $IMAGE_ID; ?>\" type=\"radio\" name=\"rating_<?php echo $IMAGE_ID; ?>\" value=\"2\" <?php echo $IMAGE_RATING>=2?\"checked\":\"\"; ?>>\n\t\t\t\t<label for=\"rating_2_<?php echo $IMAGE_ID; ?>\"></label>\n\t\t\t\t<input id=\"rating_3_<?php echo $IMAGE_ID; ?>\" type=\"radio\" name=\"rating_<?php echo $IMAGE_ID; ?>\" value=\"3\" <?php echo $IMAGE_RATING>=3?\"checked\":\"\"; ?>>\n\t\t\t\t<label for=\"rating_3_<?php echo $IMAGE_ID; ?>\"></label>\n\t\t\t\t<input id=\"rating_4_<?php echo $IMAGE_ID; ?>\" type=\"radio\" name=\"rating_<?php echo $IMAGE_ID; ?>\" value=\"4\" <?php echo $IMAGE_RATING>=4?\"checked\":\"\"; ?>>\n\t\t\t\t<label for=\"rating_4_<?php echo $IMAGE_ID; ?>\"></label>\n\t\t\t\t<input id=\"rating_5_<?php echo $IMAGE_ID; ?>\" type=\"radio\" name=\"rating_<?php echo $IMAGE_ID; ?>\" value=\"5\" <?php echo $IMAGE_RATING>=5?\"checked\":\"\"; ?>>\n\t\t\t\t<label for=\"rating_5_<?php echo $IMAGE_ID; ?>\"></label>\n\t\t\t</div>\n\t\t<?php\n\t}\n\n\tfunction add_to_where($new_where,$target_array) {\n\t\tglobal $WHERE;\n\n\t\tforeach ($target_array as $target) {\n\t\t\tif ($WHERE[$target] != \"\") {\n\t\t\t\t$WHERE[$target]\t.= \" and \";\n\t\t\t} else {\n\t\t\t\t$WHERE[$target]\t= \"where \";\n\t\t\t}\n\n\t\t\t$WHERE[$target]\t.= \"($new_where)\";\n\t\t}\n\t}\n\n\t# setup\n\t$IMAGES_PER_PAGE_OPTIONS\t= array ($constants['const_VIEW_GRID_COLUMNS']*5,$constants['const_VIEW_GRID_COLUMNS']*10,$constants['const_VIEW_GRID_COLUMNS']*20,$constants['const_VIEW_GRID_COLUMNS']*50);\n\n\t# standard values\n\t$filter_medium\t\t\t\t\t= \"-\";\n\t$view_mode\t\t\t\t\t\t= \"grid\";\n\t$filter_images_per_page\t\t\t= $IMAGES_PER_PAGE_OPTIONS[1];\n\t$filter_directory\t\t\t\t= \"\";\n\t$filter_date\t\t\t\t\t= \"all\";\n\t$filter_rating\t\t\t\t\t= \"all\";\n\t$filter_file_type\t\t\t\t= \"all\";\n\t$filter_file_type_extension\t\t= \"all\";\n\t$filter_camera_model_name\t\t= \"all\";\n\t$filter_variable_field\t\t\t= \"\";\n\t$filter_variable_value\t\t\t= \"\";\n\t$ID\t\t\t\t\t\t\t\t= 0;\n\t$IMAGE_ID\t\t\t\t\t\t= 0;\n\t$IMAGE_ID_PRE\t\t\t\t\t= 0;\n\t$IMAGE_ID_POST\t\t\t\t\t= 0;\n\t$IMAGE_ID_FIRST\t\t\t\t\t= 0;\n\t$IMAGE_ID_LAST\t\t\t\t\t= 0;\n\t$imagecount\t\t\t\t\t\t= 0;\n\t$order_by          \t\t\t\t= \"Create_Date\";\n\t$order_dir\t\t\t\t\t\t= \"DESC\";\n\t$select_offset\t\t\t\t\t= 0;\n\n\t$FIELDS_BLOCKED_ARRAY\t= array(\n\t\t\"ID\",\n\t\t\"ExifTool_Version_Number\"\n\t);\n\n\t# read parameters\n\textract ($_POST);\n\textract ($_GET);\n\n\t## security-checks\n\tif (! in_array($filter_images_per_page,$IMAGES_PER_PAGE_OPTIONS)) {\n\t\t$filter_images_per_page\t= $IMAGES_PER_PAGE_OPTIONS[0];\n\t}\n\n\t$ID\t\t\t= intval($ID);\n\n\tif (! in_array($order_by,array('File_Name','Create_Date','ID'))) {$order_by='Create_Date';}\n\n\tif (! in_array($order_dir,array('ASC','DESC'))) {$order_dir='DESC';}\n\n\tif ($filter_rating != \"all\") {\n\t\t$filter_rating\t= intval($filter_rating);\n\t\tif (($filter_rating < 1) or ($filter_rating > 5)) {\n\t\t\t$filter_rating\t= \"all\";\n\t\t}\n\t}\n\n\n\t# ratings-preparation\n\t$RATINGS_ARRAY=array();\n\tforeach ($_POST as $key=>$val) {\n\t\tif (substr($key, 0, 6 )==\"rating\") {\n\t\t\t$ID_RATING\t= explode(\"_\",$key)[1];\n \t\t\t$RATINGS_ARRAY[$ID_RATING]=$val;\n\t\t}\n\t}\n\n\t#auto-set filter_medium\n\tif ($filter_medium == \"-\") {\n\t\t$mounted_devices_array\t= array();\n\t\texec(\"df -h\", $mounted_devices_array);\n\n\t\t$mounted_devices\t= implode(\"|\",$mounted_devices_array);\n\t\tif (strpos($mounted_devices,$constants['const_MEDIA_DIR'] . '/' . $constants['const_MOUNTPOINT_SUBPATH_LOCAL_TARGET'])) {$filter_medium=\"target_local\";}\n\t\telseif (strpos($mounted_devices,$constants['const_MEDIA_DIR'] . '/' . $constants['const_MOUNTPOINT_SUBPATH_LOCAL_SOURCE'])) {$filter_medium=\"source_local\";}\n\t\telse {$filter_medium=\"internal\";}\n\t}\n\n\t#generate WHERE\n\t$WHERE['images']\t\t\t\t= \"\";\n\t$WHERE['directories']\t\t\t= \"\";\n\t$WHERE['dates']\t\t\t\t\t= \"\";\n\t$WHERE['ratings']\t\t\t\t= \"\";\n\t$WHERE['file_types']\t\t\t= \"\";\n\t$WHERE['file_type_extensions']\t= \"\";\n\t$WHERE['camera_model_name']\t\t= \"\";\n\t$WHERE['variable']\t\t\t\t= \"\";\n\n\tif ($filter_directory != \"\") {\n\t\t$filter_directory\t= str_replace(\"+\",\"=\",$filter_directory);\n\t\t$filter_directory\t= base64_decode($filter_directory);\n\n\t\tadd_to_where(\"Directory='\" . $filter_directory . \"'\",array('images','dates','ratings','file_types','file_type_extensions','camera_model_name','variable'));\n\t}\n\n\tif ($filter_date != \"all\") {add_to_where(\"substr(Create_Date,1,10) like '\" . str_replace(\"-\",\"_\",$filter_date) . \"'\",array('images','directories','ratings','file_types','file_type_extensions','camera_model_name','variable'));}\n\n\tif (isset($delete_ratings_1)) {$filter_rating=\"all\";} # after delete remove rating-filter\n\n\tif ($filter_rating != \"all\") {add_to_where(\"LbbRating = \" . $filter_rating,array('images','dates','file_types','file_type_extensions','camera_model_name','directories'));}\n\n\tif ($filter_file_type != \"all\") {add_to_where(\"File_Type = '\" . $filter_file_type . \"'\",array('images','dates','ratings','file_type_extensions','camera_model_name','directories'));}\n\n\tif ($filter_file_type_extension != \"all\") {add_to_where(\"File_Type_Extension = '\" . $filter_file_type_extension . \"'\",array('images','dates','ratings','file_types','camera_model_name','directories'));}\n\n\tif ($filter_camera_model_name != \"all\") {add_to_where(\"Camera_Model_Name = '\" . $filter_camera_model_name . \"'\",array('images','dates','ratings','file_types','file_type_extensions','directories'));}\n\n\tif ($filter_variable_value != \"\") {\n\t\t$filter_variable_value\t= str_replace(\"+\",\"=\",$filter_variable_value);\n\t\t$filter_variable_value\t= base64_decode($filter_variable_value);\n\n\t\tif (($filter_variable_field != \"\") and ($filter_variable_value != \"\")) {add_to_where($filter_variable_field . \"='\" . $filter_variable_value . \"'\",array('images','directories','dates','ratings','file_type_extensions','camera_model_name'));}\n\t}\n\n\t# generate select_limit\n\t$select_limit\t=  $filter_images_per_page + 3;\n\n\t# define path of the database-file\n\t$STORAGE_PATH\t= \"\";\n\tif ($filter_medium == \"target_local\") {\n\t\t$STORAGE_PATH\t= $constants['const_MEDIA_DIR'] . '/' . $constants['const_MOUNTPOINT_SUBPATH_LOCAL_TARGET'];\n\t}\n\telseif ($filter_medium == \"source_local\") {\n\t\t$STORAGE_PATH\t= $constants['const_MEDIA_DIR'] . '/' . $constants['const_MOUNTPOINT_SUBPATH_LOCAL_SOURCE'];\n\t}\n\telseif ($filter_medium == \"internal\") {\n\t\t$STORAGE_PATH\t= $constants['const_MEDIA_DIR'] . '/' . $constants['const_INTERNAL_BACKUP_DIR'];\n\t}\n\n\t# Database-query\n\t$DATABASE_CONNECTED=true;\n\t$DATABASE_FILE\t= \"\";\n\tif ($STORAGE_PATH != \"\") {\n\t\t$DATABASE_FILE\t= $STORAGE_PATH . '/' . $constants['const_IMAGE_DATABASE_FILENAME'];\n\n\t\tif (file_exists($DATABASE_FILE)) {\n\t\t\ttry {\n\n\t\t\t\tshell_exec(\"sudo chown www-data:www-data '\" . $DATABASE_FILE .\"'\");\n\t\t\t\t$db = new SQLite3($DATABASE_FILE);\n\t\t\t} catch (Exception $e) {\n\t\t\t\t$DATABASE_CONNECTED=false;\n\t\t\t}\n\t\t} else {\n\t\t\t$DATABASE_CONNECTED=false;\n\t\t}\n\n\t\tif ($DATABASE_CONNECTED) {\n\t\t\t# save ratings\n\t\t\tforeach($RATINGS_ARRAY as $key=>$val) {\n\t\t\t\t$key\t= intval($key);\n\t\t\t\t$val\t= intval($val);\n\n\t\t\t\tif ($config['conf_VIEW_WRITE_RATING_EXIF'] == true) {\n\t\t\t\t\t# get database-values before update\n\t\t\t\t\t$statement\t\t\t= $db->prepare(\"SELECT Directory, File_Name, Rating FROM EXIF_DATA where ID=\" . $key . \";\");\n\t\t\t\t\t$RATING_IMAGES\t\t= $statement->execute();\n\t\t\t\t\t$RATING_IMAGE\t\t= $RATING_IMAGES->fetchArray(SQLITE3_ASSOC);\n\n\t\t\t\t\t# define update-command\n\t\t\t\t\t$SQL_UPDATE\t= \"update EXIF_DATA set LbbRating=\". $val . \", Rating=\". $val . \" where ID=\" . $key . \";\";\n\t\t\t\t} else {\n\t\t\t\t\t# define update-command\n\t\t\t\t\t$SQL_UPDATE\t= \"update EXIF_DATA set LbbRating=\". $val . \" where ID=\" . $key . \";\";\n\t\t\t\t}\n\n\t\t\t\t$db->exec($SQL_UPDATE);\n\n\t\t\t\tif (($config['conf_VIEW_WRITE_RATING_EXIF'] == true) and ((int)$RATING_IMAGE['Rating'] !== (int)$val)) {\n\t\t\t\t\t#update exif-data of original file\n\t\t\t\t\tshell_exec (\"sudo exiftool -overwrite_original -Rating=\" . (int)$val . \" '\".$STORAGE_PATH . '/' . $RATING_IMAGE['Directory']. '/' .$RATING_IMAGE['File_Name'] . \"'\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t# delete media-files\n\t\t\tif (isset($delete_ratings_1)) {\n\t\t\t\tforeach($RATINGS_ARRAY as $key=>$val) {\n\t\t\t\t\t$key\t= intval($key);\n\n\t\t\t\t\t$statement\t\t= $db->prepare(\"SELECT File_Name, Directory FROM EXIF_DATA WHERE ID=\" . $key . \";\");\n\t\t\t\t\t$IMAGES\t\t\t= $statement->execute();\n\t\t\t\t\tif ($IMAGE = $IMAGES->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t$DELETE_FILE\t= $STORAGE_PATH . '/' . $IMAGE['Directory'] . '/' . $IMAGE['File_Name'];\n\t\t\t\t\t\t$DELETE_TIMS\t= $STORAGE_PATH . '/' . $IMAGE['Directory'] . '/tims/' . $IMAGE['File_Name'] . '.JPG';\n\t\t\t\t\t\tshell_exec (\"sudo rm '\" . $DELETE_FILE . \"'\");\n\t\t\t\t\t\tshell_exec (\"sudo rm '\" . $DELETE_TIMS . \"'\");\n\t\t\t\t\t\t$db->exec(\"delete from EXIF_DATA where ID=\" . $key . \" and LbbRating=1;\");\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t# database-queries\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT ID FROM EXIF_DATA \" . $WHERE['images'] . \" order by \" . $order_by . \" \" . $order_dir . \";\");\n\t\t\t$IMAGES_ALL\t\t\t= $statement->execute();\n\n\t\t\t#get first and last ID, define offset\n\t\t\t$n = 0;\n\t\t\twhile ($FETCH_IMAGE = $IMAGES_ALL->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t$n += 1;\n\t\t\t\tif ($n == 1) {\n\t\t\t\t\t$IMAGE_ID_FIRST = $FETCH_IMAGE['ID'];\n\t\t\t\t}\n\t\t\t\tif ($FETCH_IMAGE['ID'] == $ID) {\n\t\t\t\t\t$select_offset = intdiv($n,$filter_images_per_page) * $filter_images_per_page - 2;\n\t\t\t\t}\n\t\t\t\t$IMAGE_ID_LAST = $FETCH_IMAGE['ID'];\n\t\t\t}\n\n\t\t\t$imagecount = $n;\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT * FROM EXIF_DATA \" . $WHERE['images'] . \" order by \" . $order_by . \" \" . $order_dir . \" limit \" . $select_limit . \" offset \" . $select_offset . \";\");\n\t\t\t$IMAGES_PAGE\t\t\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT Directory, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['directories'] . \" group by Directory order by Directory;\");\n\t\t\t$DIRECTORIES\t\t\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT LbbRating, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['ratings'] . \" group by LbbRating order by LbbRating;\");\n\t\t\t$RATINGS\t\t\t\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT substr(replace(Create_Date,':','-'),1,10) as Create_Day, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['dates'] . \" group by Create_Day order by Create_Day desc;\");\n\t\t\t$DATES\t\t\t\t\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT File_Type, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['file_types'] . \" group by File_Type order by File_Type;\");\n\t\t\t$FILE_TYPES\t\t\t\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT File_Type_Extension, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['file_type_extensions'] . \" group by File_Type_Extension order by File_Type_Extension;\");\n\t\t\t$FILE_TYPE_EXTENSIONS\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT Camera_Model_Name, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['camera_model_name'] . \" group by Camera_Model_Name order by Camera_Model_Name;\");\n\t\t\t$CAMERA_MODEL_NAMES\t\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"PRAGMA table_info(EXIF_DATA);\");\n\t\t\t$VAR_FIELDS\t\t\t\t= $statement->execute();\n\n\t\t\tif ($filter_variable_field != \"\") {\n\t\t\t\t$statement\t\t\t= $db->prepare(\"SELECT \" . $filter_variable_field . \" as var_filter_value, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['variable'] . \" group by \" . $filter_variable_field . \" order by \" . $filter_variable_field . \";\");\n\t\t\t\t$VAR_VALUES\t= $statement->execute();\n\t\t\t}\n\n\t\t\t\t\t\t$IMAGES_ARRAY_ALL\t= array();\n\t\t\twhile ($FETCH_IMAGE = $IMAGES_PAGE->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t$IMAGES_ARRAY_ALL[]\t= $FETCH_IMAGE;\n\t\t\t}\n\n\t\t\t#manage images\n\t\t\t$IMAGES_ARRAY = array();\n\t\t\tif ($view_mode == \"grid\") {\n\t\t\t\t$n = 0;\n\t\t\t\tforeach ($IMAGES_ARRAY_ALL as $IMAGE) {\n\t\t\t\t\t$n += 1;\n\t\t\t\t\tif (($n == 1) and ($select_offset > 0)) {\n\t\t\t\t\t\t$IMAGE_ID_PRE = $IMAGE['ID'];\n\t\t\t\t\t} elseif ($n == ($select_offset <= 0 ? 1 : 3)) {\n\t\t\t\t\t\t$IMAGE_ID = $IMAGE['ID'];\n\t\t\t\t\t} elseif ($n == $filter_images_per_page + ($select_offset <= 0 ? 1 : 3)) {\n\t\t\t\t\t\t$IMAGE_ID_POST = $IMAGE['ID'];\n\t\t\t\t\t}\n\n\t\t\t\t\tif ((($n > 2) or ($select_offset <= 0)) and ($n <= $filter_images_per_page + ($select_offset <= 0 ? 0 : 2))) {\n\t\t\t\t\t\t$IMAGES_ARRAY[] = $IMAGE;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} elseif ($view_mode == \"single\") {\n\t\t\t\t$IMAGE_ID\t= $ID;\n\t\t\t\t$ID_OLD = 0;\n\n\t\t\t\t$n = 0;\n\t\t\t\tforeach ($IMAGES_ARRAY_ALL as $IMAGE) {\n\t\t\t\t\t$n += 1;\n\t\t\t\t\tif ($IMAGE['ID'] == $IMAGE_ID) {\n\t\t\t\t\t\t$IMAGE_ID_PRE = $ID_OLD;\n\t\t\t\t\t\t$IMAGES_ARRAY[] = $IMAGE;\n\t\t\t\t\t} elseif ($ID_OLD == $IMAGE_ID) {\n\t\t\t\t\t\t$IMAGE_ID_POST = $IMAGE['ID'];\n\t\t\t\t\t}\n\t\t\t\t\t$ID_OLD = $IMAGE['ID'];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t# define GET_PARAMETER\n\t$GET_PARAMETER\t= \"?filter_medium=$filter_medium\";\n\t$GET_PARAMETER\t.= \"&view_mode=$view_mode\";\n\t$GET_PARAMETER\t.= \"&order_by=$order_by\";\n\t$GET_PARAMETER\t.= \"&order_dir=$order_dir\";\n\t$GET_PARAMETER\t.= \"&filter_images_per_page=$filter_images_per_page\";\n\tif ($filter_directory != \"\") {$GET_PARAMETER\t.= \"&filter_directory=\" . str_replace(\"=\",\"+\",base64_encode($filter_directory));}\n\tif ($filter_date != \"\") {$GET_PARAMETER\t.= \"&filter_date=\" . $filter_date;}\n\tif ($filter_rating != \"\") {$GET_PARAMETER\t.= \"&filter_rating=$filter_rating\";}\n\tif ($filter_file_type_extension != \"\") {$GET_PARAMETER\t.= \"&filter_file_type_extension=$filter_file_type_extension\";}\n\tif ($filter_camera_model_name != \"\") {$GET_PARAMETER\t.= \"&filter_camera_model_name=$filter_camera_model_name\";}\n\tif ($filter_variable_field != \"\") {$GET_PARAMETER\t.= \"&filter_variable_field=$filter_variable_field\";}\n\tif ($filter_variable_value != \"\") {$GET_PARAMETER\t.= \"&filter_variable_value=\" . str_replace(\"=\",\"+\",base64_encode($filter_variable_value));}\n\n\t# define hidden HIDDEN_INPUTS\n\t$HIDDEN_INPUTS\t=\"<input type=\\\"hidden\\\" name=\\\"filter_medium\\\" value=\\\"\" . $filter_medium . \"\\\">\";\n\t$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"view_mode\\\" value=\\\"\" . $view_mode . \"\\\">\";\n\t$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"order_by\\\" value=\\\"\" . $order_by . \"\\\">\";\n\t$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"order_dir\\\" value=\\\"\" . $order_dir . \"\\\">\";\n\t$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_images_per_page\\\" value=\\\"\" . $filter_images_per_page . \"\\\">\";\n\tif ($filter_directory != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_directory\\\" value=\\\"\" . str_replace(\"=\",\"+\",base64_encode($filter_directory)) . \"\\\">\";}\n\tif ($filter_date != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_date\\\" value=\\\"\" . $filter_date . \"\\\">\";}\n\tif ($filter_rating != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_rating\\\" value=\\\"\" . $filter_rating . \"\\\">\";}\n\tif ($filter_file_type_extension != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_file_type_extension\\\" value=\\\"\" . $filter_file_type_extension . \"\\\">\";}\n\tif ($filter_camera_model_name != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_camera_model_name\\\" value=\\\"\" . $filter_camera_model_name . \"\\\">\";}\n\tif ($filter_variable_field != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_variable_field\\\" value=\\\"\" . $filter_variable_field . \"\\\">\";}\n\tif ($filter_variable_value != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_variable_value\\\" value=\\\"\" . str_replace(\"=\",\"+\",base64_encode($filter_variable_value)) . \"\\\">\";}\n?>\n\n<html lang=\"<?php echo $config[\"conf_LANGUAGE\"]; ?>\" data-theme=\"<?php echo $theme; ?>\">\n\n<head>\n\t<?php include \"${WORKING_DIR}/sub-standards-header-loader.php\"; ?>\n\t<link rel=\"stylesheet\" href=\"css/mglass.css\">\n\t<script src=\"js/mglass.js\"></script>\n</head>\n\n<body <?php echo $background; ?>>\n\t<?php include \"${WORKING_DIR}/sub-standards-body-loader.php\"; ?>\n\t<?php include \"${WORKING_DIR}/sub-menu.php\"; ?>\n\n\t<h1 class=\"text-center\" style=\"margin-bottom: 1em; letter-spacing: 3px;\"><?php echo L::view_view; ?></h1>\n\n<!-- FILTER -->\n\t<div class=\"card\" style=\"margin-top: 2em\">\n\t\t<details>\n\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::view_filter_section; ?></summary>\n\t\t\t<form action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST\">\n\t\t\t\t<input type=\"hidden\" name=\"order_by\" value=\"<?php echo $order_by; ?>\">\n\t\t\t\t<input type=\"hidden\" name=\"order_dir\" value=\"<?php echo $order_dir; ?>\">\n\n\t\t\t\t<div style=\"display: flow-root\">\n\t\t\t\t\t<div style=\"float:left;padding: 5px;\">\n\t\t\t\t\t\t<label for=\"filter_medium\"><?php echo L::view_filter_medium; ?></label><br>\n\n\t\t\t\t\t\t\t<select name=\"filter_medium\" id=\"filter_medium\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t<option value=\"target_local\" <?php echo ($filter_medium == \"target_local\"?\" selected\":\"\"); ?>><?php echo L::view_filter_medium_target_local; ?></option>\";\n\t\t\t\t\t\t\t\t<option value=\"source_local\" <?php echo ($filter_medium == \"source_local\"?\" selected\":\"\"); ?>><?php echo L::view_filter_medium_source_local; ?></option>\";\n\t\t\t\t\t\t\t\t<option value=\"internal\" <?php echo ($filter_medium == \"internal\"?\" selected\":\"\"); ?>><?php echo L::view_filter_medium_internal; ?></option>\";\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div style=\"float:right;padding: 5px;\">\n\t\t\t\t\t\t<label for=\"filter_images_per_page\"><?php echo L::view_filter_images_per_page; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"filter_images_per_page\" id=\"filter_images_per_page\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\tforeach ($IMAGES_PER_PAGE_OPTIONS as $IMAGES_PER_PAGE_OPTION) {\n\t\t\t\t\t\t\t\t\techo \"<option value=\\\"$IMAGES_PER_PAGE_OPTION\\\" \" . ($filter_images_per_page == $IMAGES_PER_PAGE_OPTION?\" selected\":\"\") . \">$IMAGES_PER_PAGE_OPTION</option>\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"display: flow-root\">\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:left;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_date\"><?php echo L::view_filter_date; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_date\" id=\"filter_date\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<option value=\"all\" <?php echo ($filter_date == \"\"?\" selected\":\"\"); ?>>-</option>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\twhile ($DATE = $DATES->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $DATE['Create_Day'] . \"\\\" \" . ($filter_date == $DATE['Create_Day']?\" selected\":\"\") . \">\" . $DATE['Create_Day'] . \" (\" . $DATE['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:right;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_rating\"><?php echo L::view_filter_rating; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_rating\" id=\"filter_rating\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"all\\\">\" . L::view_filter_rating_all . \"</option>\";\n\t\t\t\t\t\t\t\t\t\twhile ($RATING = $RATINGS->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $RATING['LbbRating'] . \"\\\" \" . ($filter_rating == $RATING['LbbRating']?\" selected\":\"\") . \">\" . $RATING['LbbRating'] . \" \" . L::view_filter_rating_stars . \" (\" . $RATING['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"display: flow-root\">\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:left;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_file_type\"><?php echo L::view_filter_file_type; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_file_type\" id=\"filter_file_type\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<option value=\"all\" <?php echo ($filter_file_type == \"\"?\" selected\":\"\"); ?>>-</option>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\twhile ($FILE_TYPE = $FILE_TYPES->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $FILE_TYPE['File_Type'] . \"\\\" \" . ($filter_file_type == $FILE_TYPE['File_Type']?\" selected\":\"\") . \">\" . $FILE_TYPE['File_Type'] . \" (\" . $FILE_TYPE['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:left;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_file_type_extension\"><?php echo L::view_filter_file_type_extension; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_file_type_extension\" id=\"filter_file_type_extension\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<option value=\"all\" <?php echo ($filter_file_type_extension == \"\"?\" selected\":\"\"); ?>>-</option>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\twhile ($FILE_TYPE_EXTENSION = $FILE_TYPE_EXTENSIONS->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $FILE_TYPE_EXTENSION['File_Type_Extension'] . \"\\\" \" . ($filter_file_type_extension == $FILE_TYPE_EXTENSION['File_Type_Extension']?\" selected\":\"\") . \">\" . $FILE_TYPE_EXTENSION['File_Type_Extension'] . \" (\" . $FILE_TYPE_EXTENSION['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:right;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_rating\"><?php echo L::view_filter_camera_model_name; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_camera_model_name\" id=\"filter_camera_model_name\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"all\\\">-</option>\";\n\t\t\t\t\t\t\t\t\t\twhile ($CAMERA_MODEL_NAME = $CAMERA_MODEL_NAMES->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $CAMERA_MODEL_NAME['Camera_Model_Name'] . \"\\\" \" . ($filter_camera_model_name == $CAMERA_MODEL_NAME['Camera_Model_Name']?\" selected\":\"\") . \">\" . $CAMERA_MODEL_NAME['Camera_Model_Name'] . \" (\" . $CAMERA_MODEL_NAME['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"display: flow-root\">\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:left;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_directory\"><?php echo L::view_filter_directory; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_directory\" id=\"filter_directory\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<option value=\"\" <?php echo ($filter_directory == \"\"?\" selected\":\"\"); ?>>/</option>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\twhile ($DIRECTORY = $DIRECTORIES->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . str_replace(\"=\",\"+\",base64_encode($DIRECTORY['Directory'])) . \"\\\" \" . ($filter_directory == $DIRECTORY['Directory']?\" selected\":\"\") . \">\" . str_replace($STORAGE_PATH,\"\",$DIRECTORY['Directory']) . \" (\" . $DIRECTORY['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"display: flow-root\">\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:left;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_variable_field\"><?php echo L::view_filter_variable; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_variable_field\" id=\"filter_variable_field\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<option value=\"\" <?php echo ($filter_variable_field == \"\"?\" selected\":\"\"); ?>>-</option>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t$FIELDS_ARRAY=array();\n\t\t\t\t\t\t\t\t\t\twhile ($FIELD = $VAR_FIELDS->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\t$FIELDS_ARRAY[]=$FIELD['name'];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tasort($FIELDS_ARRAY);\n\t\t\t\t\t\t\t\t\t\tforeach($FIELDS_ARRAY as $FIELD) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $FIELD . \"\\\" \" . ($filter_variable_field == $FIELD?\" selected\":\"\") . \">\" . $FIELD . \"</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\tif (isset($VAR_VALUES)) {\n\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t<select name=\"filter_variable_value\" id=\"filter_variable_value\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t\t\t<option value=\"\">-</option>\n\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\t\twhile ($VALUE = $VAR_VALUES->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . str_replace(\"=\",\"+\",base64_encode($VALUE['var_filter_value'])) . \"\\\" \" . ($filter_variable_value == $VALUE['var_filter_value']?\" selected\":\"\") . \">\" . $VALUE['var_filter_value'] . \"(\" . $VALUE['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\t\t\t\t</div>\n\n\t\t\t</form>\n\t\t</details>\n\t</div>\n\n<!-- IMAGES -->\n\t<?php if ($DATABASE_CONNECTED) { ?>\n\t<form action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST\">\n\n\t\t<?php\n\t\t\techo $HIDDEN_INPUTS;\n\t\t\tnavigator($view_mode,$imagecount,$filter_images_per_page,$select_offset,$filter_rating,$IMAGE_ID_PRE,$IMAGE_ID,$IMAGE_ID_POST,$IMAGE_ID_FIRST,$IMAGE_ID_LAST,$GET_PARAMETER,$order_by,$order_dir,L::view_filter_order_by_filename,L::view_filter_order_by_creationdate,L::view_filter_order_by_id);\n\t\t?>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;display: inline-block\">\n\n\t\t\t<?php\n\n\t\t\t\tif ($imagecount >= 1) {\n\t\t\t\t\tif ($view_mode == \"grid\") {\n// GRID\n\t\t\t\t\t\t?>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t$i\t= 0;\n\t\t\t\t\t\t$LAST_DATE\t= \"\";\n\t\t\t\t\t\tforeach ($IMAGES_ARRAY as $IMAGE) {\n\n\t\t\t\t\t\t\t$i\t+= 1;\n\t\t\t\t\t\t\t$interpretedDate\t= date_create($IMAGE['Create_Date']);\n\t\t\t\t\t\t\tif ($interpretedDate == false) {\n\t\t\t\t\t\t\t\t$DateExplode\t= explode('_',$IMAGE['Create_Date']);\n\t\t\t\t\t\t\t\t$interpretedDate=date_create($DateExplode[0] . '-' . $DateExplode[1] . '-' . $DateExplode[2] . ' ' . $DateExplode[3] . ':' .  $DateExplode[4] . ':' . $DateExplode[5]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$IMAGE_DATE\t= date_format($interpretedDate,L::view_date_format);\n\n\t\t\t\t\t\t\t$Directory\t\t\t\t= $STORAGE_PATH . $IMAGE['Directory'];\n\t\t\t\t\t\t\t$IMAGE_ID\t\t\t\t= $IMAGE['ID'];\n\t\t\t\t\t\t\t$IMAGE_FILENAME_TIMS\t= $Directory . '/tims/' . $IMAGE['File_Name'] . '.JPG';\n\t\t\t\t\t\t\t?>\n\n\n\t\t\t\t\t\t\t\t<div style=\"width: <?php echo 100/$constants['const_VIEW_GRID_COLUMNS']-1; ?>%;\" class=\"floating\">\n\t\t\t\t\t\t\t\t\t<div style=\"width: 100%\" title=\"<?php echo $IMAGE['File_Name']; ?>\">\n\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\tif (($order_by == 'Create_Date') and ($LAST_DATE !== $IMAGE_DATE)) {\n\t\t\t\t\t\t\t\t\t\t\t\techo '<b>' . $IMAGE_DATE . '</b>';\n\t\t\t\t\t\t\t\t\t\t\t\t$LAST_DATE\t= $IMAGE_DATE;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . '&view_mode=single&ID=' . ($IMAGE['ID']); ?>\">\n\t\t\t\t\t\t\t\t\t\t\t<img style=\"max-width: 100%; border-radius: 5px;\" class=\"rating<?php echo $IMAGE['LbbRating']; ?>\" src=\"<?php echo urlencode_keep_slashes($IMAGE_FILENAME_TIMS); ?>\">\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div style=\"width: 100%; display: inline-block; padding-left: 2px;padding-right: 2px; padding-top: 2px; padding-bottom: 6px;\">\n\n\t\t\t\t\t\t\t\t\t\t<?php echo rating_radio($IMAGE['ID'],$IMAGE['LbbRating']); ?>\n\n\t\t\t\t\t\t\t\t\t\t<div style=\"float:right;padding: 2px;font-size:0.8em;\" class=\"hidden-mobile\">\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . '&view_mode=single&ID=' . $IMAGE_ID; ?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php echo $IMAGE['File_Name']; ?>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telseif ($view_mode == \"single\") {\n// SINGLE\n\t\t\t\t\t\t$IMAGE = $IMAGES_ARRAY[0];\n\t\t\t\t\t\t$Directory\t\t\t\t= $STORAGE_PATH . $IMAGE['Directory'];\n\t\t\t\t\t\t$IMAGE_ID\t\t\t\t= $IMAGE['ID'];\n\t\t\t\t\t\t$IMAGE_FILENAME\t\t\t= $Directory . '/' . $IMAGE['File_Name'];\n\t\t\t\t\t\t$IMAGE_FILENAME_TIMS\t= $Directory . '/tims/' . $IMAGE['File_Name'] . '.JPG';\n\t\t\t\t\t\t$IMAGE_TYPE\t\t\t\t= $IMAGE['File_Type'] !== \"\"?strtolower($IMAGE['File_Type']):strtolower($IMAGE_FILENAME_PARTS['extension']);\n\t\t\t\t\t\t$IMAGE_FILENAME_PARTS\t= pathinfo($IMAGE_FILENAME);\n\t\t\t\t\t\t?>\n\n\t\t\t\t\t\t<div style=\"float:left;width: 100%;padding: 5px;\">\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\tif (strpos(\";\" . $constants['const_FILE_EXTENSIONS_LIST_WEB_IMAGES'] . \";\" . $constants['const_FILE_EXTENSIONS_LIST_HEIC'] . \";\" . $constants['const_FILE_EXTENSIONS_LIST_RAW'] . \";\" . $constants['const_FILE_EXTENSIONS_LIST_TIF'] . \";\",\";\" . strtolower($IMAGE_FILENAME_PARTS['extension']) . \";\") !== false ) {\n// \t\t\t\t\t\t\t\t\t\timage-file\n\n\t\t\t\t\t\t\t\t\tif (strpos(\";\" . $constants['const_FILE_EXTENSIONS_LIST_WEB_IMAGES'] . \";\",\";\" . strtolower($IMAGE_FILENAME_PARTS['extension']) . \";\") !== false ) {\n\t\t\t\t\t\t\t\t\t\t$FILENAME_DISPLAY\t= $IMAGE_FILENAME;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t$FILENAME_DISPLAY\t= $IMAGE_FILENAME_TIMS;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<div style=\"width: 100%;text-align:center;\" title=\"<?php echo $IMAGE['File_Name']; ?>\">\n\n\t\t\t\t\t\t\t\t\t\t<div class=\"img-magnifier-container\">\n\t\t\t\t\t\t\t\t\t\t\t<img id=\"fullsizeimage\" onClick=\"magnify('fullsizeimage', <?php echo $constants['const_VIEW_MAGNIFYING_GLASS_ZOOM']; ?>)\" style=\"max-width: 100%;border-radius: 5px;\" class=\"rating<?php echo $IMAGE['LbbRating']; ?>\" src=\"<?php echo urlencode_keep_slashes($FILENAME_DISPLAY); ?>\">\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\tif (strpos(\";\" . $constants['const_FILE_EXTENSIONS_LIST_RAW'] . \";\" . $constants['const_FILE_EXTENSIONS_LIST_TIF'] . \";\",\";\" . strtolower($IMAGE_FILENAME_PARTS['extension']) . \";\") !== false ) {\n// \t\t\t\t\t\t\t\t\t\t\tRAW-image or TIF image\n\t\t\t\t\t\t\t\t\t\t\techo \"<div style=\\\"width: 100%\\\">\";\n\t\t\t\t\t\t\t\t\t\t\t\techo \"<p style=\\\"text-align: center;font-weight: bold;\\\">\" . L::view_images_preview_low_resolution_image . \"</p>\";\n\t\t\t\t\t\t\t\t\t\t\techo \"</div>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\n\t\t\t\t\t\t\t\t\t<div style=\"width=100%;padding: 30px;font-size:0.8em;\">\n\t\t\t\t\t\t\t\t\t\t<div style=\"float:left;width: 33%;text-align: left;padding: 0;padding-top: 0.5em;\">\n\t\t\t\t\t\t\t\t\t\t\t<?php echo rating_radio($IMAGE['ID'],$IMAGE['LbbRating']); ?>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div style=\"float:left;width: 34%;text-align: center;padding: 0;\">\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?php echo urlencode_keep_slashes($IMAGE_FILENAME); ?>\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php echo L::view_images_download; ?>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div style=\"float:left;width: 33%;text-align: right;padding: 0;\">\n\t\t\t\t\t\t\t\t\t\t\t<?php echo L::view_images_magnifying_glass; ?>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t} elseif (strpos(\";\" . $constants['const_FILE_EXTENSIONS_LIST_VIDEO'] . \";\",\";\" . strtolower($IMAGE_FILENAME_PARTS['extension']) . \";\") !== false ) {\n// \t\t\t\t\t\t\t\t\t\tvideo-file\n\t\t\t\t\t\t\t\t\t$IMAGE_FILENAME_PREVIEW\t= $IMAGE_FILENAME;\n\t\t\t\t\t\t\t\t\t$LOW_RES\t= false;\n\t\t\t\t\t\t\t\t\tif (isset($IMAGE['Compressor_Name']) and (strpos($IMAGE['Compressor_Name'],\"GoPro H.265 encoder\") !== false)) {\n\t\t\t\t\t\t\t\t\t\t#GoPro: GoPro H.265 encoder not supported by most browsers\n\t\t\t\t\t\t\t\t\t\t$IMAGE_FILENAME_PREVIEW_CANDIDATE\t= $IMAGE_FILENAME_PARTS['dirname'] . DIRECTORY_SEPARATOR . substr_replace($IMAGE_FILENAME_PARTS['filename'],'L',1,1) . \".LRV\";\n\t\t\t\t\t\t\t\t\t\tif (file_exists($IMAGE_FILENAME_PREVIEW_CANDIDATE)) {\n\t\t\t\t\t\t\t\t\t\t\t$IMAGE_FILENAME_PREVIEW\t= $IMAGE_FILENAME_PREVIEW_CANDIDATE;\n\t\t\t\t\t\t\t\t\t\t\t$LOW_RES\t= true;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t<div style=\"width: 100%;text-align:center;\" title=\"<?php echo $IMAGE['File_Name']; ?>\">\n\t\t\t\t\t\t\t\t\t\t\t<video width=\"100%\" class=\"rating<?php echo $IMAGE['LbbRating']; ?>\" controls autoplay>\n\t\t\t\t\t\t\t\t\t\t\t\t<source src=\"<?php echo urlencode_keep_slashes($IMAGE_FILENAME_PREVIEW); ?>\" type=\"video/<?php echo $IMAGE_TYPE; ?>\"></source>\n\t\t\t\t\t\t\t\t\t\t\t</video>\n\n\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\tif ($LOW_RES) {\n\t// \t\t\t\t\t\t\t\t\t\t\tRAW-image\n\t\t\t\t\t\t\t\t\t\t\t\techo \"<p style=\\\"text-align: center;font-weight: bold;\\\">\" . L::view_images_preview_low_resolution_video . \"</p>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div padding: 5px;font-size:0.8em;\">\n\t\t\t\t\t\t\t\t\t\t\t<?php echo rating_radio($IMAGE['ID'],$IMAGE['LbbRating']); ?>\n\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?php echo urlencode_keep_slashes($IMAGE_FILENAME); ?>\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php echo L::view_images_download; ?>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t} elseif (strpos(\";\" . $constants['const_FILE_EXTENSIONS_LIST_AUDIO'] . \";\",\";\" . strtolower($IMAGE_FILENAME_PARTS['extension']) . \";\") !== false ) {\n// \t\t\t\t\t\t\t\t\t\taudio-file\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t<div style=\"width: 100%;text-align:center;\" title=\"<?php echo $IMAGE['File_Name']; ?>\">\n\t\t\t\t\t\t\t\t\t\t\t<audio width=\"100%\" class=\"rating<?php echo $IMAGE['LbbRating']; ?>\" controls autoplay>\n\t\t\t\t\t\t\t\t\t\t\t\t<source src=\"<?php echo urlencode_keep_slashes($IMAGE_FILENAME); ?>\" type=\"audio/<?php echo $IMAGE_FILENAME_PARTS['extension']; ?>\">\">\n\t\t\t\t\t\t\t\t\t\t\t</audio>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div padding: 5px;font-size:0.8em;\">\n\t\t\t\t\t\t\t\t\t\t\t<?php echo rating_radio($IMAGE['ID'],$IMAGE['LbbRating']); ?>\n\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?php echo urlencode_keep_slashes($IMAGE_FILENAME); ?>\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php echo L::view_images_download; ?>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div style=\"float:left;width: 100%;padding: 5px;\">\n\t\t\t\t\t\t\t<table style=\"table-layout: fixed;max-width: 100%;\">\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\tforeach ($IMAGE as $FIELD => $VALUE) {\n\t\t\t\t\t\t\t\t\tif (($VALUE != \"\") and (! in_array($FIELD,$FIELDS_BLOCKED_ARRAY))) {\n\t\t\t\t\t\t\t\t\t\t$FIELD\t= str_replace('_',' ',$FIELD);\n\t\t\t\t\t\t\t\t\t\techo \"<tr><td style='word-break: break-all;width: 40%;vertical-align: top;'><u>$FIELD:</u></td><td style='word-break: break-all;width: 60%;vertical-align: top;'><b>$VALUE</b></td></tr>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<?php\n\n\t\t\t\t\t}\n\t\t\t\t} else {\n// \t\t\t\t\timagecount=0\n\t\t\t\t\t?>\n\t\t\t\t\t\t<?php echo L::view_images_empty; ?>\n\t\t\t\t\t<?php\n\t\t\t\t}\n\t\t\t?>\n\n\t\t</div>\n\n\t\t<?php navigator($view_mode,$imagecount,$filter_images_per_page,$select_offset,$filter_rating,$IMAGE_ID_PRE,$IMAGE_ID,$IMAGE_ID_POST,$IMAGE_ID_FIRST,$IMAGE_ID_LAST,$GET_PARAMETER,$order_by,$order_dir,L::view_filter_order_by_filename,L::view_filter_order_by_creationdate,L::view_filter_order_by_id); ?>\n\n\t</form>\n\n\t<?php } else { ?>\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<?php echo L::view_filter_no_medium; ?>\n\t\t</div>\n\t<?php } ?>\n\n\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t<?php echo L::view_footer_footer; ?>\n\t</div>\n\n\t<?php\n\t\tinclude \"sub-footer.php\";\n\t?>\n\n</body>\n\n</html>\n"], "fixing_code": ["<!doctype html>\n\n<!-- Author: Dmitri Popov, dmpop@linux.com; Stefan Saam, github@saams.de\n         License: GPLv3 https://www.gnu.org/licenses/gpl-3.0.txt -->\n\n<?php\n\t$WORKING_DIR=dirname(__FILE__);\n\t$config = parse_ini_file(\"$WORKING_DIR/config.cfg\", false);\n\t$config_standard = parse_ini_file(\"$WORKING_DIR/config-standards.cfg\", false);\n\t$constants = parse_ini_file(\"constants.sh\", false);\n\n\t$theme = $config[\"conf_THEME\"];\n\t$background = $config[\"conf_BACKGROUND_IMAGE\"] == \"\"?\"\":\"background='\" . $constants[\"const_MEDIA_DIR\"] .'/' . $constants[\"const_BACKGROUND_IMAGES_DIR\"] . \"/\" . $config[\"conf_BACKGROUND_IMAGE\"] . \"'\";\n\n\tinclude(\"sub-popup.php\");\n\n\tinclude(\"get-cloudservices.php\");\n\n\t$TIME_ZONE_old\t= $config[\"conf_TIME_ZONE\"];\n\n\t$WIFI_COUNTRY\t= trim(shell_exec(\"raspi-config nonint get_wifi_country\"));\n\n\t$vpn_types\t\t= array('OpenVPN','WireGuard');\n?>\n\n<html lang=\"<?php echo $config[\"conf_LANGUAGE\"]; ?>\" data-theme=\"<?php echo $theme; ?>\">\n\n<head>\n\t<?php include \"${WORKING_DIR}/sub-standards-header-loader.php\"; ?>\n</head>\n\n<body <?php echo $background; ?>>\n\t<?php include \"${WORKING_DIR}/sub-standards-body-loader.php\"; ?>\n\t<?php include \"${WORKING_DIR}/sub-menu.php\"; ?>\n\n\t<?php\n\t\t// write new config\n\t\tif (isset($_POST['save'])) {\n\t\t\twrite_config();\n\n\t\t\tif (isset($_POST['send_testmail'])) {\n\t\t\t\tshell_exec(\"sudo python3 $WORKING_DIR/lib_mail.py '\" . L::config_mail_testmail_subject . \"' '\" . L::config_mail_testmail_content . \"'\");\n\t\t\t\techo '<div class=\"card\" style=\"margin-top: 2em;\">' . L::config_mail_testmail_sent . '</div>';\n\t\t\t}\n\n\t\t\tif (isset($_POST['restart_rclone_gui'])) {\n\t\t\t\texec(\"sudo python3 $WORKING_DIR/start-rclone-gui.py True > /dev/null 2>/dev/null &\");\n\t\t\t\techo '<div class=\"card\" style=\"margin-top: 2em;\">' . L::config_rclone_gui_restarted . '</div>';\n\t\t\t}\n\n\t\t\texec(\"sudo pkill -f ${WORKING_DIR}/display.py\");\n\t\t\texec(\"sudo python3 $WORKING_DIR/lib_display.py '\" . L::config_display_message_settings_saved_1 . \"' '\" . L::config_display_message_settings_saved_2 . \"' > /dev/null 2>&1 &\");\n\t\t}\n\n\t\t// Upload settings\n\t\tif (isset($_POST['upload_settings'])) {\n\t\t\tupload_settings();\n\t\t};\n\n\t\t// read (new) config\n\t\t$config = parse_ini_file(\"$WORKING_DIR/config.cfg\", false);\n\n\t\t# set timezone\n\t\tif ($TIME_ZONE_old !== $config[\"conf_TIME_ZONE\"]) {\n\t\t\tshell_exec(\"sudo raspi-config nonint do_change_timezone \".$config[\"conf_TIME_ZONE\"]);\n\t\t}\n\n\t\t# write wifi country-code from config.cfg\n\t\tif (($WIFI_COUNTRY !== $config[\"conf_WIFI_COUNTRY\"]) and ($config[\"conf_WIFI_COUNTRY\"] !== \"\")) {\n\t\t\tshell_exec(\"sudo raspi-config nonint do_wifi_country \".$config[\"conf_WIFI_COUNTRY\"]);\n\t\t\t$WIFI_COUNTRY\t= trim(shell_exec(\"raspi-config nonint get_wifi_country\"));\n\t\t}\n\n\t?>\n\n\t<h1 class=\"text-center\" style=\"margin-bottom: 1em; letter-spacing: 3px;\"><?php echo L::config_config; ?></h1>\n\t<?php\n\nfunction get_wifi_country_selector($ID,$NAME) {\n\tglobal $WIFI_COUNTRY;\n\n\t$wifi_contry_selector\t= '<select id=\"'.$ID.'\" name=\"'.$NAME.'\">';\n\n\t\texec(\"sed '/^#/d' /usr/share/zoneinfo/iso3166.tab\",$COUNTRIES);\n\t\tforeach($COUNTRIES as $COUNTRY) {\n\t\t\t$COUNTRY_ARRAY\t= explode(\"\\t\",$COUNTRY,2);\n\t\t\t$COUNTRYCODE\t= trim($COUNTRY_ARRAY[0]);\n\t\t\t$COUNTRYNAME\t= trim($COUNTRY_ARRAY[1]);\n\t\t\t$selected\t\t= $WIFI_COUNTRY==$COUNTRYCODE ? \" selected\" : \"\";\n\n\t\t\t$wifi_contry_selector\t.= '<option value=\"'.$COUNTRYCODE.'\"'.$selected.'>'.$COUNTRYCODE.' '.$COUNTRYNAME.'</option>';\n\t\t}\n\t$wifi_contry_selector\t.= '</select>';\n\treturn ($wifi_contry_selector);\n}\n\nfunction check_new_password($title, $pwd_1, $pwd_2) {\n\t$pwd_valid = false;\n\t\tif ($pwd_1 !== $pwd_2) {\n\t\t\tpopup($title . \"\\n\" . L::config_alert_password_not_identical, true);\n\t\t} elseif (strlen($pwd_1) < 5) {\n\t\t\tpopup($title . \"\\n\" . L::config_alert_password_too_short, true);\n\t\t} elseif (\n\t\t\t\tstrpos(\"_\" . $pwd_1,\"\\\\\") or\n\t\t\t\tstrpos(\"_\" . $pwd_1,\"'\") or\n\t\t\t\tstrpos(\"_\" . $pwd_1,\" \")\n\t\t\t\t  ) {\n\t\t\tpopup($title . \"\\n\" . L::config_alert_password_characters_not_allowed, true);\n\t\t} else {\n\t\t\t$pwd_valid=true;\n\t\t}\n\n\treturn($pwd_valid);\n}\n\nfunction write_config() {\n\t# write config.cfg\n\n\tglobal $WORKING_DIR;\n\tglobal $WIFI_COUNTRY;\n\tglobal $constants;\n\tglobal $vpn_types;\n\n\textract ($_POST,EXTR_SKIP);\n\n\tlist($conf_BACKUP_DEFAULT_SOURCE,$conf_BACKUP_DEFAULT_TARGET)=explode(\" \",$BACKUP_MODE,2);\n\tlist($conf_BACKUP_DEFAULT_SOURCE2,$conf_BACKUP_DEFAULT_TARGET2)=explode(\" \",$BACKUP_MODE_2,2);\n\n\t$conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS\t= isset($conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS)?\"true\":\"false\";\n\t$conf_BACKUP_DEFAULT_UPDATE_EXIF\t\t\t= isset($conf_BACKUP_DEFAULT_UPDATE_EXIF)?\"true\":\"false\";\n\t$conf_POWER_OFF\t\t\t\t\t\t\t\t= isset($conf_POWER_OFF)?\"true\":\"false\";\n\t$conf_MAIL_NOTIFICATIONS\t\t\t\t\t= isset($conf_MAIL_NOTIFICATIONS)?\"true\":\"false\";\n\t$conf_MAIL_HTML\t\t\t\t\t\t\t\t= isset($conf_MAIL_HTML)?\"true\":\"false\";\n\t$conf_DISP\t\t\t\t\t\t\t\t\t= isset($conf_DISP)?\"true\":\"false\";\n\t$conf_DISP_BLACK_ON_POWER_OFF\t\t\t\t= isset($conf_DISP_BLACK_ON_POWER_OFF)?\"true\":\"false\";\n\t$conf_DISP_IP_REPEAT\t\t\t\t\t\t= isset($conf_DISP_IP_REPEAT)?\"true\":\"false\";\n\t$conf_MENU_ENABLED\t\t\t\t\t\t\t= isset($conf_MENU_ENABLED)?\"true\":\"false\";\n\t$conf_LOG_SYNC\t\t\t\t\t\t\t\t= isset($conf_LOG_SYNC)?\"true\":\"false\";\n\t$conf_POPUP_MESSAGES\t\t\t\t\t\t= isset($conf_POPUP_MESSAGES)?\"true\":\"false\";\n\t$conf_BACKUP_GENERATE_THUMBNAILS\t\t\t= isset($conf_BACKUP_GENERATE_THUMBNAILS)?\"true\":\"false\";\n\t$conf_BACKUP_UPDATE_EXIF\t\t\t\t\t= isset($conf_BACKUP_UPDATE_EXIF)?\"true\":\"false\";\n\t$conf_VIEW_CONVERT_HEIC\t\t\t\t\t\t= isset($conf_VIEW_CONVERT_HEIC)?\"true\":\"false\";\n\t$conf_VIEW_WRITE_RATING_EXIF\t\t\t\t= isset($conf_VIEW_WRITE_RATING_EXIF)?\"true\":\"false\";\n\n\t$conf_PASSWORD_LINE=\"conf_PASSWORD=\\\"$conf_PASSWORD_OLD\\\"\";\n\n\tif ($conf_MAIL_PASSWORD != '') {\n\t\tif (! check_new_password (L::config_alert_password_mail_header, $conf_MAIL_PASSWORD, $conf_MAIL_PASSWORD)) {\n\t\t\t$conf_MAIL_PASSWORD\t= \"\";\n\t\t}\n\t}\n\n\tif ($conf_RSYNC_PASSWORD != '') {\n\t\tif (! check_new_password (L::config_alert_password_rsync_header, $conf_RSYNC_PASSWORD, $conf_RSYNC_PASSWORD)) {\n\t\t\t$conf_RSYNC_PASSWORD\t= \"\";\n\t\t}\n\t}\n\n\tif (isset($conf_PASSWORD_REMOVE)) {\n\t\t$conf_PASSWORD_LINE=\"conf_PASSWORD=''\";\n\n\t\texec(\"sudo python3 \" . $_SERVER['CONTEXT_DOCUMENT_ROOT'] . \"/lib_password.py\"); # remove password\n\n\t\tpopup(L::config_alert_password_change_after_reboot_remove,true);\n\t} elseif ($conf_PASSWORD_1 != '') {\n\t\tif (check_new_password (L::config_alert_password_global, $conf_PASSWORD_1, $conf_PASSWORD_2)) {\n\t\t\t$conf_PASSWORD_LINE=\"conf_PASSWORD='$conf_PASSWORD_1'\";\n\n\t\t\texec(\"sudo python3 \" . $_SERVER['CONTEXT_DOCUMENT_ROOT'] . \"/lib_password.py '\" . $conf_PASSWORD_1 . \"'\");\n\n\t\t\tif ((strlen($conf_PASSWORD_1) < 8) or (strlen($conf_PASSWORD_1) > 63)) {\n\t\t\t\tpopup(L::config_alert_password_wifi_size_error,true);\n\t\t\t}\n\t\t\tpopup(L::config_alert_password_change_after_reboot_set,true);\n\t\t}\n\t}\n\n\t$CONFIGFILE = \"$WORKING_DIR/config.cfg\";\n\t$config_file_handle = fopen($CONFIGFILE, \"w\");\n\n\t$config_file_content = <<<CONFIGDATA\nconf_LANGUAGE='$conf_LANGUAGE'\nconf_TIME_ZONE='$conf_TIME_ZONE'\nconf_BACKUP_DEFAULT_SOURCE='$conf_BACKUP_DEFAULT_SOURCE'\nconf_BACKUP_DEFAULT_TARGET='$conf_BACKUP_DEFAULT_TARGET'\nconf_BACKUP_DEFAULT_GENERATE_THUMBNAILS=$conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS\nconf_BACKUP_DEFAULT_UPDATE_EXIF=$conf_BACKUP_DEFAULT_UPDATE_EXIF\nconf_BACKUP_DEFAULT_SOURCE2='$conf_BACKUP_DEFAULT_SOURCE2'\nconf_BACKUP_DEFAULT_TARGET2='$conf_BACKUP_DEFAULT_TARGET2'\nconf_BACKUP_CAMERA_FOLDER_MASK='$conf_BACKUP_CAMERA_FOLDER_MASK'\nconf_BACKUP_TARGET_BASEDIR_CLOUD='$conf_BACKUP_TARGET_BASEDIR_CLOUD'\nconf_POWER_OFF=$conf_POWER_OFF\nconf_DISP=$conf_DISP\nconf_DISP_CONNECTION='$conf_DISP_CONNECTION'\nconf_DISP_DRIVER='$conf_DISP_DRIVER'\nconf_DISP_I2C_ADDRESS='$conf_DISP_I2C_ADDRESS'\nconf_DISP_SPI_PORT='$conf_DISP_SPI_PORT'\nconf_DISP_RESOLUTION_X=$conf_DISP_RESOLUTION_X\nconf_DISP_RESOLUTION_Y=$conf_DISP_RESOLUTION_Y\nconf_DISP_ROTATE='$conf_DISP_ROTATE'\nconf_DISP_CONTRAST=$conf_DISP_CONTRAST\nconf_DISP_COLOR_MODEL='$conf_DISP_COLOR_MODEL'\nconf_DISP_COLOR_TEXT='$conf_DISP_COLOR_TEXT'\nconf_DISP_COLOR_HIGH='$conf_DISP_COLOR_HIGH'\nconf_DISP_COLOR_ALERT='$conf_DISP_COLOR_ALERT'\nconf_DISP_FONT_SIZE=$conf_DISP_FONT_SIZE\nconf_DISP_FRAME_TIME=$conf_DISP_FRAME_TIME\nconf_DISP_BLACK_ON_POWER_OFF=$conf_DISP_BLACK_ON_POWER_OFF\nconf_DISP_IP_REPEAT=$conf_DISP_IP_REPEAT\nconf_MENU_ENABLED=$conf_MENU_ENABLED\nconf_MENU_BUTTON_COMBINATION='$conf_MENU_BUTTON_COMBINATION'\nconf_MENU_BUTTON_ROTATE='$conf_MENU_BUTTON_ROTATE'\nconf_MENU_BUTTON_BOUNCETIME=$conf_MENU_BUTTON_BOUNCETIME\nconf_MENU_BUTTON_EDGE_DETECTION='$conf_MENU_BUTTON_EDGE_DETECTION'\nconf_MENU_BUTTON_RESISTOR_PULL='$conf_MENU_BUTTON_RESISTOR_PULL'\nconf_FAN_PWM_TEMP_C=$conf_FAN_PWM_TEMP_C\nconf_FAN_PWM_GPIO=$conf_FAN_PWM_GPIO\nconf_THEME=$conf_THEME\nconf_BACKGROUND_IMAGE=$conf_BACKGROUND_IMAGE\nconf_POPUP_MESSAGES=$conf_POPUP_MESSAGES\nconf_LOGLEVEL=$conf_LOGLEVEL\nconf_LOG_SYNC=$conf_LOG_SYNC\nconf_POWER_OFF_IDLE_TIME=$conf_POWER_OFF_IDLE_TIME\nconf_BACKUP_GENERATE_THUMBNAILS=$conf_BACKUP_GENERATE_THUMBNAILS\nconf_BACKUP_UPDATE_EXIF=$conf_BACKUP_UPDATE_EXIF\nconf_VIEW_CONVERT_HEIC=$conf_VIEW_CONVERT_HEIC\nconf_VIEW_WRITE_RATING_EXIF=$conf_VIEW_WRITE_RATING_EXIF\nconf_MAIL_NOTIFICATIONS=$conf_MAIL_NOTIFICATIONS\nconf_MAIL_HTML=$conf_MAIL_HTML\nconf_SMTP_SERVER='$conf_SMTP_SERVER'\nconf_SMTP_PORT='$conf_SMTP_PORT'\nconf_MAIL_SECURITY='$conf_MAIL_SECURITY'\nconf_MAIL_USER='$conf_MAIL_USER'\nconf_MAIL_PASSWORD='$conf_MAIL_PASSWORD'\nconf_MAIL_FROM='$conf_MAIL_FROM'\nconf_MAIL_TO='$conf_MAIL_TO'\nconf_RSYNC_SERVER='$conf_RSYNC_SERVER'\nconf_RSYNC_PORT='$conf_RSYNC_PORT'\nconf_RSYNC_USER='$conf_RSYNC_USER'\nconf_RSYNC_PASSWORD='$conf_RSYNC_PASSWORD'\nconf_RSYNC_SERVER_MODULE='$conf_RSYNC_SERVER_MODULE'\nconf_WIFI_COUNTRY='$conf_WIFI_COUNTRY'\nconf_VPN_TYPE_RSYNC='$conf_VPN_TYPE_RSYNC'\nconf_VPN_TYPE_CLOUD='$conf_VPN_TYPE_CLOUD'\nconf_VPN_TIMEOUT=$conf_VPN_TIMEOUT\n$conf_PASSWORD_LINE\n\nCONFIGDATA;\n\n\tfwrite($config_file_handle, $config_file_content);\n\tfclose($config_file_handle);\n\texec (\"dos2unix './\" . $CONFIGFILE . \"'\");\n\n\t# remove vpn config file\n\tforeach($vpn_types as $vpn_type) {\n\t\tif (isset($_POST['vpn_remove_' . $vpn_type])) {\n\t\t\texec ('sudo rm \"' . $constants['const_VPN_DIR_' . $vpn_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_type] . '\"');\n\t\t}\n\t}\n\n\t# save vpn config file\n\tif ($vpn_upload_type !== 'none') {\n\t\tif(file_exists($_FILES[\"vpn_conf_file\"][\"tmp_name\"])) {\n\t\t\texec ('sudo mkdir -p \"' . $constants['const_VPN_DIR_' . $vpn_upload_type] . '\"');\n\t\t\texec ('sudo mv \"' . $_FILES[\"vpn_conf_file\"][\"tmp_name\"] . '\" \"' . $constants['const_VPN_DIR_' . $vpn_upload_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_upload_type] . '\"');\n\t\t\texec ('sudo chown root:root \"' . $constants['const_VPN_DIR_' . $vpn_upload_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_upload_type] . '\"');\n\t\t\texec ('sudo chmod 700 \"' . $constants['const_VPN_DIR_' . $vpn_upload_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_upload_type] . '\"');\n\t\t}\n\t}\n\n\t# write hardware-settings\n\texec(\"sudo \" . $_SERVER['CONTEXT_DOCUMENT_ROOT'] . \"/set_hardware.sh\");\n\n\t# response\n\techo '<div class=\"card\" style=\"margin-top: 2em;\">' . L::config_message_settings_saved . '</div>';\n}\n\nfunction upload_settings() {\n\tglobal $WORKING_DIR, $config, $constants, $vpn_types;\n\n\tif($_FILES[\"settings_file\"][\"name\"]) {\n\t\t$filename = $_FILES[\"settings_file\"][\"name\"];\n\t\t$source = $_FILES[\"settings_file\"][\"tmp_name\"];\n\t\t$type = $_FILES[\"settings_file\"][\"type\"];\n\t\t$name = explode(\".\", $filename);\n\t\t$accepted_types = array('application/zip', 'application/x-zip-compressed', 'multipart/x-zip', 'application/x-compressed');\n\n\t\t$FILETYPE_ZIP\t= false;\n\t\tforeach($accepted_types as $mime_type) {\n\t\t\tif($mime_type == $type) {\n\t\t\t\t$FILETYPE_ZIP = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t$continue = ((strtolower($name[1]) == 'zip') and $FILETYPE_ZIP) ? true : false;\n\t\tif(!$continue) {\n\t\t\tpopup(L::config_alert_settings_upload_not_zip,true);\n\t\t} else {\n\t\t\t/* PHP current path */\n\n\t\t\t$targetdir = $constants[\"const_WEB_ROOT_LBB\"].'/tmp/unzip';\n\t\t\t$targetzip = $targetdir . '/' . $filename;\n\t\t\t/* create directory if not exists' */\n\t\t\t@mkdir($targetdir, 0777);\n\n\t\t\t/* here it is really happening */\n\n\t\t\tif(move_uploaded_file($source, $targetzip)) {\n\t\t\t\t$zip = new ZipArchive();\n\t\t\t\t$file_opened = $zip->open($targetzip);  // open the zip file to extract\n\t\t\t\tif ($file_opened === true) {\n\t\t\t\t\t$zip->extractTo($targetdir); // place in the directory with same name\n\t\t\t\t\t$zip->close();\n\n\t\t\t\t\tunlink($targetzip);\n\t\t\t\t\t$Files_Copied=\"\";\n\n\t\t\t\t\tif (file_exists($targetdir.\"/config.cfg\")) {\n\t\t\t\t\t\t@unlink($constants[\"const_WEB_ROOT_LBB\"]/config.cfg);\n\t\t\t\t\t\tif (rename($targetdir.\"/config.cfg\",$constants[\"const_WEB_ROOT_LBB\"].\"/config.cfg\")) {$Files_Copied=\"\\n* 'config.cfg'\";}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif (file_exists($targetdir.\"/\".$constants[\"const_RCLONE_CONFIG_FILE\"])) {\n\t\t\t\t\t\tif (rename($targetdir.\"/\".$constants[\"const_RCLONE_CONFIG_FILE\"],$constants[\"const_MEDIA_DIR\"] . '/' . $constants[\"const_RCLONE_CONFIG_FILE\"])) {$Files_Copied=$Files_Copied.\"\\n* '\".$constants[\"const_RCLONE_CONFIG_FILE\"].\"'\";}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (file_exists($targetdir.\"/\".$constants[\"const_BUTTONS_PRIVATE_CONFIG_FILE\"])) {\n\t\t\t\t\t\tif (rename($targetdir.\"/\".$constants[\"const_BUTTONS_PRIVATE_CONFIG_FILE\"],$constants[\"const_MEDIA_DIR\"] . '/' . $constants[\"const_BUTTONS_PRIVATE_CONFIG_FILE\"])) {$Files_Copied=$Files_Copied.\"\\n* '\".$constants[\"const_BUTTONS_PRIVATE_CONFIG_FILE\"].\"'\";}\n\t\t\t\t\t}\n\n\t\t\t\t\tforeach($vpn_types as $vpn_type) {\n\t\t\t\t\t\tif (file_exists($targetdir.'/'.$constants['const_VPN_FILENAME_' . $vpn_type])) {\n\t\t\t\t\t\t\texec ('sudo rm \"' . $constants['const_VPN_DIR_' . $vpn_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_type] . '\"');\n\t\t\t\t\t\t\texec ('sudo mv \"' . $targetdir.'/'.$constants['const_VPN_FILENAME_' . $vpn_type] . '\" \"' . $constants['const_VPN_DIR_' . $vpn_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_type] . '\"');\n\t\t\t\t\t\t\t$Files_Copied=$Files_Copied.\"\\n* '\" . $constants['const_VPN_FILENAME_' . $vpn_type] . \"'\";\n\n\t\t\t\t\t\t\t## secure VPN config files\n\t\t\t\t\t\t\texec ('sudo chmod 700 \"' . $constants['const_VPN_DIR_' . $vpn_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_type] . '\" -R');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t#Background images\n\t\t\t\t\tif (is_dir($targetdir.'/bg-images')){\n\n\t\t\t\t\t\texec (\"sudo mkdir -p '\" . $constants[\"const_MEDIA_DIR\"] . '/' . $constants['const_BACKGROUND_IMAGES_DIR'] . \"'\");\n\t\t\t\t\t\texec (\"sudo chown www-data:www-data '\" . $constants[\"const_MEDIA_DIR\"] . '/' . $constants['const_BACKGROUND_IMAGES_DIR'] .\"' -R\");\n\n\t\t\t\t\t\t$background_images\t= scandir($targetdir.'/bg-images');\n\t\t\t\t\t\tforeach ($background_images as $BACKGROUND_IMAGE) {\n\t\t\t\t\t\t\tif (is_file($targetdir . '/bg-images/' . $BACKGROUND_IMAGE)) {\n\t\t\t\t\t\t\t\t$Files_Copied=$Files_Copied.\"\\n* '\" . $BACKGROUND_IMAGE . \"'\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\texec (\"sudo mv '\" . $targetdir . \"/bg-images/'* '\" . $constants[\"const_MEDIA_DIR\"] . '/' . $constants['const_BACKGROUND_IMAGES_DIR'] . \"/'\");\n\t\t\t\t\t\texec (\"sudo chown www-data:www-data '\" . $constants[\"const_MEDIA_DIR\"] . '/' . $constants['const_BACKGROUND_IMAGES_DIR'] .\"/'*\");\n\t\t\t\t\t}\n\n\t\t\t\t\t# Feedback files in place\n\t\t\t\t\tpopup(L::config_alert_settings_upload_success. \" \". $Files_Copied,true);\n\n\t\t\t\t\t# reload config\n\t\t\t\t\t$config = parse_ini_file(\"$WORKING_DIR/config.cfg\", false);\n\n\t\t\t\t\t# set new password\n\t\t\t\t\tif (isset ($config[\"conf_PASSWORD\"]) and check_new_password(L::config_alert_password_global,$config[\"conf_PASSWORD\"],$config[\"conf_PASSWORD\"])) {\n\t\t\t\t\t\texec(\"sudo python3 \" . $_SERVER['CONTEXT_DOCUMENT_ROOT'] . \"/lib_password.py '\" . $config[\"conf_PASSWORD\"] . \"'\");\n\t\t\t\t\t\tpopup(L::config_alert_password_change_after_reboot_set,true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\texec(\"sudo python3 \" . $_SERVER['CONTEXT_DOCUMENT_ROOT'] . \"/lib_password.py\");\n\t\t\t\t\t\tpopup(L::config_alert_password_change_after_reboot_remove,true);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\tpopup(L::config_alert_settings_upload_problem,$config[\"conf_POPUP_MESSAGES\"]);\n\t\t\t}\n\n\t\t}\n\t\texec(\"sudo rm -R \".$targetdir);\n\t}\n}\n?>\n\n\n\t<form action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST\" enctype=\"multipart/form-data\">\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<?php echo '<button style=\"margin-top: 2em;\" type=\"submit\" name=\"save\">' . L::config_save_button . '</button>'; ?>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_lang_time_section; ?></summary>\n\n\t\t\t\t<div>\n\t\t\t\t\t<h3><?php echo L::config_lang_header; ?></h3>\n\t\t\t\t\t\t<label for=\"conf_LANGUAGE\"><?php echo L::config_lang_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_LANGUAGE\" id=\"conf_LANGUAGE\">\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\techo \"<option value='' \" . ($config[\"conf_LANGUAGE\"] == \"\"?\" selected\":\"\") . \">\" . L::config_lang_browser_detect . \"</option>\";\n\t\t\t\t\t\t\t\t$languages=array();\n\t\t\t\t\t\t\t\texec (\"find 'lang'/*.json -type f \",$languages);\n\t\t\t\t\t\t\t\tforeach($languages as $language) {\n\t\t\t\t\t\t\t\t\t$language = basename($language, \".json\");\n\t\t\t\t\t\t\t\t\techo \"<option value='\" . $language . \"' \" . ($config[\"conf_LANGUAGE\"] == $language?\" selected\":\"\") . \">\" . $language . \"</option>\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</select>\n\t\t\t\t</div>\n\n\t\t\t\t<div>\n\t\t\t\t\t<h3><?php echo L::config_time_zone_header; ?></h3>\n\t\t\t\t\t\t<label for=\"conf_TIME_ZONE\"><?php echo L::config_time_zone_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_TIME_ZONE\" id=\"conf_TIME_ZONE\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$time_zones=array();\n\t\t\t\t\t\t\t\t\texec (\"timedatectl list-timezones\",$time_zones);\n\t\t\t\t\t\t\t\t\tforeach($time_zones as $time_zone) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $time_zone . \"' \" . ($config[\"conf_TIME_ZONE\"] == $time_zone?\" selected\":\"\") . \">\" . $time_zone . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_backup_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_backup_header; ?></h3>\n\t\t\t\t\t<label for=\"BACKUP_MODE\"><?php echo L::config_backup_label; ?></label><br>\n\n\t\t\t\t\t<select name=\"BACKUP_MODE\" id=\"BACKUP_MODE\">\n\t\t\t\t\t\t<option value=\"none none\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"none none\"?\" selected\":\"\"; ?>><?php echo L::config_backup_none; ?></option>\n\t\t\t\t\t\t<option value=\"usb usb\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"usb usb\"?\" selected\":\"\"; ?>><?php echo L::config_backup_usb_usb; ?></option>\n\t\t\t\t\t\t<option value=\"usb internal\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"usb internal\"?\" selected\":\"\"; ?>><?php echo L::config_backup_usb_internal; ?></option>\n\t\t\t\t\t\t<option value=\"camera usb\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"camera usb\"?\" selected\":\"\"; ?>><?php echo L::config_backup_camera_usb; ?></option>\n\t\t\t\t\t\t<option value=\"camera internal\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"camera internal\"?\" selected\":\"\"; ?>><?php echo L::config_backup_camera_internal; ?></option>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\tif (! ($config[\"conf_RSYNC_SERVER\"]==\"\" or $config[\"conf_RSYNC_PORT\"]==\"\" or $config[\"conf_RSYNC_USER\"]==\"\" or $config[\"conf_RSYNC_PASSWORD\"]==\"\" or $config[\"conf_RSYNC_SERVER_MODULE\"]==\"\")) {\n\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t<option value=\"internal cloud_rsync\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"internal cloud_rsync\"?\" selected\":\"\"; ?>><?php echo L::main_internal_button . L::right_arrow . L::main_rsync_button; ?></option>\n\t\t\t\t\t\t\t\t<option value=\"usb cloud_rsync\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"usb cloud_rsync\"?\" selected\":\"\"; ?>><?php echo L::main_usb_button . L::right_arrow . L::main_rsync_button; ?></option>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tforeach($CloudServices as $CloudService) {\n\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t<option value=\"internal cloud:<?php print $CloudService; ?>\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"internal cloud:${CloudService}\"?\" selected\":\"\"; ?>><?php echo L::main_internal_button . L::right_arrow . $CloudService; ?></option>\n\t\t\t\t\t\t\t\t<option value=\"usb cloud:<?php print $CloudService; ?>\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET\"]==\"usb cloud:${CloudService}\"?\" selected\":\"\"; ?>><?php echo L::main_usb_button . L::right_arrow . $CloudService; ?></option>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</select>\n\n\t\t\t\t<h4><?php echo L::config_backup_default_settings_header; ?></h4>\n\t\t\t\t\t<h5><?php echo L::config_backup_generate_thumbnails_header; ?></h5>\n\t\t\t\t\t\t<label for=\"conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS\"><?php echo L::config_backup_generate_thumbnails_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"checkbox\" id=\"conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS\" name=\"conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS\" <?php echo $config['conf_BACKUP_DEFAULT_GENERATE_THUMBNAILS']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t\t<h5><?php echo L::config_backup_update_exif_header; ?></h5>\n\t\t\t\t\t\t<label for=\"conf_BACKUP_DEFAULT_UPDATE_EXIF\"><?php echo L::config_backup_update_exif_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"checkbox\" id=\"conf_BACKUP_DEFAULT_UPDATE_EXIF\" name=\"conf_BACKUP_DEFAULT_UPDATE_EXIF\" <?php echo $config['conf_BACKUP_DEFAULT_UPDATE_EXIF']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_backup_header2; ?></h3>\n\t\t\t\t\t<label for=\"BACKUP_MODE_2\"><?php echo L::config_backup_label2; ?></label><br>\n\n\t\t\t\t\t<select name=\"BACKUP_MODE_2\" id=\"BACKUP_MODE_2\">\n\t\t\t\t\t\t<option value=\"none none\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE2\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET2\"]==\"none none\"?\" selected\":\"\"; ?>><?php echo L::config_backup_none; ?></option>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\tif (! ($config[\"conf_RSYNC_SERVER\"]==\"\" or $config[\"conf_RSYNC_PORT\"]==\"\" or $config[\"conf_RSYNC_USER\"]==\"\" or $config[\"conf_RSYNC_PASSWORD\"]==\"\" or $config[\"conf_RSYNC_SERVER_MODULE\"]==\"\")) {\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<option value=\"internal cloud_rsync\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE2\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET2\"]==\"internal cloud_rsync\"?\" selected\":\"\"; ?>><?php echo L::main_internal_button . L::right_arrow . L::main_rsync_button; ?></option>\n\t\t\t\t\t\t\t\t\t<option value=\"usb cloud_rsync\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE2\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET2\"]==\"usb cloud_rsync\"?\" selected\":\"\"; ?>><?php echo L::main_usb_button . L::right_arrow . L::main_rsync_button; ?></option>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tforeach($CloudServices as $CloudService) {\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<option value=\"internal cloud:<?php print $CloudService; ?>\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE2\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET2\"]==\"internal cloud:${CloudService}\"?\" selected\":\"\"; ?>><?php echo L::main_internal_button . L::right_arrow . $CloudService; ?></option>\n\t\t\t\t\t\t\t\t\t<option value=\"usb cloud:<?php print $CloudService; ?>\" <?php echo $config[\"conf_BACKUP_DEFAULT_SOURCE2\"] . \" \" . $config[\"conf_BACKUP_DEFAULT_TARGET2\"]==\"usb cloud:${CloudService}\"?\" selected\":\"\"; ?>><?php echo L::main_usb_button . L::right_arrow . $CloudService; ?></option>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t</select>\n\n\t\t\t\t<h3><?php echo L::config_backup_camera_folder_mask_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_BACKUP_CAMERA_FOLDER_MASK\"><?php echo L::config_backup_camera_folder_mask_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_BACKUP_CAMERA_FOLDER_MASK\" name=\"conf_BACKUP_CAMERA_FOLDER_MASK\" size=\"6\" value=\"<?php echo $config['conf_BACKUP_CAMERA_FOLDER_MASK']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_backup_power_off_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_POWER_OFF\"><?php echo L::config_backup_power_off_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_POWER_OFF\" name=\"conf_POWER_OFF\" <?php echo $config['conf_POWER_OFF']==\"1\"?\"checked\":\"\"; ?>>\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_behavior_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_behavior_loglevel_header; ?></h3>\n\t\t\t\t\t<p><?php echo L::config_behavior_loglevel_text . \" \" . $constants[\"const_LOGFILE\"]; ?>)</p>\n\t\t\t\t\t<label for=\"conf_LOGLEVEL\"><?php echo L::config_behavior_loglevel_label; ?></label><br>\n\t\t\t\t\t<select name=\"conf_LOGLEVEL\" id=\"conf_LOGLEVEL\">\n\t\t\t\t\t\t<option value=\"1\" <?php echo $config[\"conf_LOGLEVEL\"]==\"1\"?\" selected\":\"\"; ?>>1, <?php echo L::config_behavior_loglevel_minimum; ?></option>\n\t\t\t\t\t\t<option value=\"2\" <?php echo $config[\"conf_LOGLEVEL\"]==\"2\"?\" selected\":\"\"; ?>>2, <?php echo L::config_behavior_loglevel_medium; ?></option>\n\t\t\t\t\t\t<option value=\"3\" <?php echo $config[\"conf_LOGLEVEL\"]==\"3\"?\" selected\":\"\"; ?>>3, <?php echo L::config_behavior_loglevel_maximum; ?></option>\n\t\t\t\t\t</select>\n\n\t\t\t\t<h3><?php echo L::config_behavior_log_sync_protokoll_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_LOG_SYNC\"><?php echo L::config_behavior_log_sync_protokoll_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_LOG_SYNC\" name=\"conf_LOG_SYNC\"<?php echo $config['conf_LOG_SYNC']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_behavior_power_off_idle_time_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_POWER_OFF_IDLE_TIME\"><?php echo L::config_behavior_power_off_idle_time_label; ?></label><br>\n\t\t\t\t\t<select name=\"conf_POWER_OFF_IDLE_TIME\" id=\"conf_POWER_OFF_IDLE_TIME\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t$IDLE_TIME_OPTIONS=array(0,2,5,10,15,20,30);\n\t\t\t\t\t\t\tforeach($IDLE_TIME_OPTIONS as $IDLE_TIME_OPTION) {\n\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $IDLE_TIME_OPTION .\"\\\"\". ($config[\"conf_POWER_OFF_IDLE_TIME\"]==$IDLE_TIME_OPTION?\" selected\":\"\") . \">\" . ($IDLE_TIME_OPTION==\"0\"?L::config_behavior_power_off_idle_time_none:$IDLE_TIME_OPTION . \" \" . L::units_minutes_long) .\"</option>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\n\t\t\t\t\t</select>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_view_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_view_theme_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_THEME\"><?php echo L::config_view_theme_label; ?></label><br>\n\t\t\t\t\t\t<select name=\"conf_THEME\" id=\"conf_THEME\">\n\t\t\t\t\t\t<option value=\"light\" <?php echo $config[\"conf_THEME\"] == \"light\"?\" selected\":\"\"; ?>><?php echo L::config_view_theme_light; ?></option>\n\t\t\t\t\t\t<option value=\"dark\" <?php echo $config[\"conf_THEME\"] == \"dark\"?\" selected\":\"\"; ?>><?php echo L::config_view_theme_dark; ?></option>\n\t\t\t\t\t\t<option value=\"sepia\" <?php echo $config[\"conf_THEME\"] == \"sepia\"?\" selected\":\"\"; ?>><?php echo L::config_view_theme_sepia; ?></option>\n\t\t\t\t\t</select>\n\n\t\t\t\t<h3><?php echo L::config_view_bg_image_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_BACKGROUND_IMAGE\"><?php echo L::config_view_bg_image_label; ?> &quot;<?php echo $constants[\"const_MEDIA_DIR\"] . '/' . $constants['const_BACKGROUND_IMAGES_DIR'] ;?>&quot;.</label><br>\n\t\t\t\t\t\t<select name=\"conf_BACKGROUND_IMAGE\" id=\"conf_BACKGROUND_IMAGE\">\n\t\t\t\t\t\t\t<option value=\"\" <?php echo $config[\"conf_BACKGROUND_IMAGE\"] ==\"\"?\" selected\":\"\"; ?>>none</option>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t$bg_images=array();\n\t\t\t\t\t\t\t\texec (\"find '\" . $constants[\"const_MEDIA_DIR\"] . '/' . $constants[\"const_BACKGROUND_IMAGES_DIR\"] . \"' -type f -exec file --mime-type {} \\+ | awk -F: '{if ($2 ~/image\\//) print $1}'\",$bg_images);\n\t\t\t\t\t\t\t\tforeach($bg_images as $bg_image) {\n\t\t\t\t\t\t\t\t\t$bg_image = str_replace($constants[\"const_MEDIA_DIR\"] . '/' . $constants[\"const_BACKGROUND_IMAGES_DIR\"] . '/','',$bg_image);\n\t\t\t\t\t\t\t\t\techo \"<option value='\" . $bg_image . \"' \" . ($config[\"conf_BACKGROUND_IMAGE\"] == $bg_image?\" selected\":\"\") . \">\" . $bg_image . \"</option>\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</select>\n\n\t\t\t\t<h3><?php echo L::config_view_popup_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_POPUP_MESSAGES\"><?php echo L::config_view_popup_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_POPUP_MESSAGES\" name=\"conf_POPUP_MESSAGES\" <?php echo $config['conf_POPUP_MESSAGES']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_display_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_display_behavior_header; ?></h3>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP\"><?php echo L::config_display_activate_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"checkbox\" id=\"conf_DISP\" name=\"conf_DISP\" <?php echo $config['conf_DISP']==\"1\"?\"checked\":\"\"; ?>>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_FONT_SIZE\"><?php echo L::config_display_font_size_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_FONT_SIZE\" id=\"conf_DISP_FONT_SIZE\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_font_sizes_array=array(10,12,14,16);\n\t\t\t\t\t\t\t\t\tforeach($display_font_sizes_array as $display_font_size) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_font_size . \"' \" . ($config[\"conf_DISP_FONT_SIZE\"] == $display_font_size?\" selected\":\"\") . \">\" . $display_font_size . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_FRAME_TIME\"><?php echo L::config_display_frame_time_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_FRAME_TIME\" id=\"conf_DISP_FRAME_TIME\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_frame_times_array=array(\"0.5\",\"1\",\"2\",\"3\");\n\t\t\t\t\t\t\t\t\tforeach($display_frame_times_array as $display_frame_time) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_frame_time . \"' \" . ($config[\"conf_DISP_FRAME_TIME\"] == $display_frame_time?\" selected\":\"\") . \">\" . $display_frame_time . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_CONTRAST\"><?php echo L::config_display_contrast_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"range\" id=\"conf_DISP_CONTRAST\" name=\"conf_DISP_CONTRAST\" style=\"width: 50%;\" min=\"1\" max=\"255\" step=\"1\" value=\"<?php echo $config['conf_DISP_CONTRAST']; ?>\">\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_IP_REPEAT\"><?php echo L::config_display_ip_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"checkbox\" id=\"conf_DISP_IP_REPEAT\" name=\"conf_DISP_IP_REPEAT\" <?php echo $config['conf_DISP_IP_REPEAT']==\"1\"?\"checked\":\"\"; ?>>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_BLACK_ON_POWER_OFF\"><?php echo L::config_display_black_on_power_off_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"checkbox\" id=\"conf_DISP_BLACK_ON_POWER_OFF\" name=\"conf_DISP_BLACK_ON_POWER_OFF\" <?php echo $config['conf_DISP_BLACK_ON_POWER_OFF']==\"1\"?\"checked\":\"\"; ?>>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h4><?php echo L::config_display_colors_header; ?></h4>\n\n\t\t\t\t\t\t<?php $display_colors_array=array('blue','green','red','white','yellow','orange','lightgrey','grey'); ?>\n\n\t\t\t\t\t\t\t<label for=\"conf_DISP_COLOR_TEXT\"><?php echo L::config_display_color_text_label; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"conf_DISP_COLOR_TEXT\" id=\"conf_DISP_COLOR_TEXT\">\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\tforeach($display_colors_array as $display_color) {\n\t\t\t\t\t\t\t\t\t\t\t$display_color_entity=\"config_display_color_\" . $display_color;\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_color . \"' \" . ($config[\"conf_DISP_COLOR_TEXT\"] == $display_color?\" selected\":\"\") . \">\" . L::{\"$display_color_entity\"}() . \"</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_COLOR_HIGH\"><?php echo L::config_display_color_high_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_COLOR_HIGH\" id=\"conf_DISP_COLOR_HIGH\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\tforeach($display_colors_array as $display_color) {\n\t\t\t\t\t\t\t\t\t\t$display_color_entity=\"config_display_color_\" . $display_color;\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_color . \"' \" . ($config[\"conf_DISP_COLOR_HIGH\"] == $display_color?\" selected\":\"\") . \">\" . L::{\"$display_color_entity\"}() . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_COLOR_ALERT\"><?php echo L::config_display_color_alert_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_COLOR_ALERT\" id=\"conf_DISP_COLOR_ALERT\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\tforeach($display_colors_array as $display_color) {\n\t\t\t\t\t\t\t\t\t\t$display_color_entity=\"config_display_color_\" . $display_color;\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_color . \"' \" . ($config[\"conf_DISP_COLOR_ALERT\"] == $display_color?\" selected\":\"\") . \">\" . L::{\"$display_color_entity\"}() . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h4><?php echo L::config_display_rotate_header; ?></h4>\n\n\t\t\t\t\t\t<label for=\"conf_DISP_ROTATE\"><?php echo L::config_display_rotate_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_ROTATE\" id=\"conf_DISP_ROTATE\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_rotate_array=array(\n\t\t\t\t\t\t\t\t\t\t'0' => '0\u00b0',\n\t\t\t\t\t\t\t\t\t\t'2' => '180\u00b0',\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tforeach($display_rotate_array as $display_rotate_code => $display_rotate_text) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_rotate_code . \"' \" . ($config[\"conf_DISP_ROTATE\"] == $display_rotate_code?\" selected\":\"\") . \">\" . $display_rotate_text . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_menu_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_menu_enable_header; ?></h3>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_MENU_ENABLED\"><?php echo L::config_menu_enable_label; ?></label><br>\n\t\t\t\t\t\t<input type=\"checkbox\" id=\"conf_MENU_ENABLED\" name=\"conf_MENU_ENABLED\" <?php echo $config['conf_MENU_ENABLED']==\"1\"?\"checked\":\"\"; ?>>\n\t\t\t\t\t</div>\n\n\t\t\t\t<h3><?php echo L::config_menu_rotate_header; ?></h3>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_MENU_BUTTON_ROTATE\"><?php echo L::config_menu_button_rotate_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_MENU_BUTTON_ROTATE\" id=\"conf_MENU_BUTTON_ROTATE\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$button_rotate_array=array(\n\t\t\t\t\t\t\t\t\t\t'2' => '0\u00b0',\n\t\t\t\t\t\t\t\t\t\t'0' => '180\u00b0',\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tforeach($button_rotate_array as $button_rotate_code => $button_rotate_text) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $button_rotate_code . \"' \" . ($config[\"conf_MENU_BUTTON_ROTATE\"] == $button_rotate_code?\" selected\":\"\") . \">\" . $button_rotate_text . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_imageviewer_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_backup_generate_thumbnails_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_BACKUP_GENERATE_THUMBNAILS\"><?php echo L::config_backup_generate_thumbnails_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_BACKUP_GENERATE_THUMBNAILS\" name=\"conf_BACKUP_GENERATE_THUMBNAILS\" <?php echo $config['conf_BACKUP_GENERATE_THUMBNAILS']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_imageviewer_convert_heic_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_VIEW_CONVERT_HEIC\"><?php echo L::config_imageviewer_convert_heic_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_VIEW_CONVERT_HEIC\" name=\"conf_VIEW_CONVERT_HEIC\" <?php echo $config['conf_VIEW_CONVERT_HEIC']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_backup_update_exif_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_BACKUP_UPDATE_EXIF\"><?php echo L::config_backup_update_exif_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_BACKUP_UPDATE_EXIF\" name=\"conf_BACKUP_UPDATE_EXIF\" <?php echo $config['conf_BACKUP_UPDATE_EXIF']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_imageviewer_write_rating_exif_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_VIEW_WRITE_RATING_EXIF\"><?php echo L::config_imageviewer_write_rating_exif_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_VIEW_WRITE_RATING_EXIF\" name=\"conf_VIEW_WRITE_RATING_EXIF\" <?php echo $config['conf_VIEW_WRITE_RATING_EXIF']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_mail_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_behavior_notify_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_MAIL_NOTIFICATIONS\"><?php echo L::config_behavior_notify_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_MAIL_NOTIFICATIONS\" name=\"conf_MAIL_NOTIFICATIONS\"<?php echo $config['conf_MAIL_NOTIFICATIONS']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_behavior_mail_html_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_MAIL_HTML\"><?php echo L::config_behavior_mail_html_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"conf_MAIL_HTML\" name=\"conf_MAIL_HTML\"<?php echo $config['conf_MAIL_HTML']==\"1\"?\"checked\":\"\"; ?>>\n\n\t\t\t\t<h3><?php echo L::config_mail_smtp_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_SMTP_SERVER\"><?php echo L::config_mail_smtp_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_SMTP_SERVER\" name=\"conf_SMTP_SERVER\" size=\"6\" value=\"<?php echo $config['conf_SMTP_SERVER']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_mail_port_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_SMTP_PORT\"><?php echo L::config_mail_port_label . \" \" . $config_standard[\"conf_SMTP_PORT\"]; ?>)</label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_SMTP_PORT\" name=\"conf_SMTP_PORT\" size=\"20\" value=\"<?php echo $config['conf_SMTP_PORT']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_mail_security_header; ?></h3>\n\t\t\t\t\t<input type=\"radio\" id=\"conf_MAIL_SECURITY_STARTTLS\" name=\"conf_MAIL_SECURITY\" value=\"STARTTLS\" <?php echo $config['conf_MAIL_SECURITY']!==\"SSL\"?\"checked\":\"\"; ?>>\n\t\t\t\t\t<label for=\"conf_MAIL_SECURITY_STARTTLS\">STARTTLS</label><br>\n\t\t\t\t\t<input type=\"radio\" id=\"conf_MAIL_SECURITY_SSL\" name=\"conf_MAIL_SECURITY\" value=\"SSL\" <?php echo $config['conf_MAIL_SECURITY']==\"SSL\"?\"checked\":\"\"; ?>>\n\t\t\t\t\t<label for=\"conf_MAIL_SECURITY_SSL\">SSL</label><br>\n\n\t\t\t\t<h3><?php echo L::config_mail_user_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_MAIL_USER\"><?php echo L::config_mail_user_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_MAIL_USER\" name=\"conf_MAIL_USER\" size=\"20\" value=\"<?php echo $config['conf_MAIL_USER']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_mail_password_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_MAIL_PASSWORD\"><?php echo L::config_mail_password_label; ?></label><br>\n\t\t\t\t\t<input type=\"password\" id=\"conf_MAIL_PASSWORD\" name=\"conf_MAIL_PASSWORD\" size=\"20\" value=\"<?php echo $config['conf_MAIL_PASSWORD']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_mail_sender_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_MAIL_FROM\"><?php echo L::config_mail_sender_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_MAIL_FROM\" name=\"conf_MAIL_FROM\" size=\"20\" value=\"<?php echo $config['conf_MAIL_FROM']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_mail_recipient_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_MAIL_TO\"><?php echo L::config_mail_recipient_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_MAIL_TO\" name=\"conf_MAIL_TO\" size=\"20\" value=\"<?php echo $config['conf_MAIL_TO']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_mail_testmail_header; ?></h3>\n\t\t\t\t\t<label for=\"send_testmail\"><?php echo L::config_mail_testmail_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"send_testmail\" name=\"send_testmail\">\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_rsync_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_rsync_server_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_RSYNC_SERVER\"><?php echo L::config_rsync_server_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_RSYNC_SERVER\" name=\"conf_RSYNC_SERVER\" size=\"6\" value=\"<?php echo $config['conf_RSYNC_SERVER']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_rsync_port_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_RSYNC_PORT\"><?php echo L::config_rsync_port_label . \" \" . $config_standard['conf_RSYNC_PORT']; ?>)</label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_RSYNC_PORT\" name=\"conf_RSYNC_PORT\" size=\"20\" value=\"<?php echo $config['conf_RSYNC_PORT']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_rsync_user_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_RSYNC_USER\"><?php echo L::config_rsync_user_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_RSYNC_USER\" name=\"conf_RSYNC_USER\" size=\"20\" value=\"<?php echo $config['conf_RSYNC_USER']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_rsync_password_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_RSYNC_PASSWORD\"><?php echo L::config_rsync_password_label; ?></label><br>\n\t\t\t\t\t<input type=\"password\" id=\"conf_RSYNC_PASSWORD\" name=\"conf_RSYNC_PASSWORD\" size=\"20\" value=\"<?php echo $config['conf_RSYNC_PASSWORD']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_rsync_module_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_RSYNC_SERVER_MODULE\"><?php echo L::config_rsync_module_label1 .  $config_standard['conf_RSYNC_SERVER_MODULE'] . L::config_rsync_module_label2; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_RSYNC_SERVER_MODULE\" name=\"conf_RSYNC_SERVER_MODULE\" size=\"20\" value=\"<?php echo $config['conf_RSYNC_SERVER_MODULE']; ?>\">\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_cloud_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_backup_target_basedir_cloud_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_BACKUP_TARGET_BASEDIR_CLOUD\"><?php echo L::config_backup_target_basedir_cloud_label; ?></label><br>\n\t\t\t\t\t<input type=\"text\" id=\"conf_BACKUP_TARGET_BASEDIR_CLOUD\" name=\"conf_BACKUP_TARGET_BASEDIR_CLOUD\" size=\"6\" value=\"<?php echo $config['conf_BACKUP_TARGET_BASEDIR_CLOUD']; ?>\">\n\n\t\t\t\t<h3><?php echo L::config_cloud_header; ?></h3>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t<?php echo L::config_cloud_rclone_description ; ?><br>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\tif (empty($config['conf_PASSWORD'])) {\n\t\t\t\t\t\t\t\techo L::config_username . \": 'lbb', \" . L::config_password . \": 'lbb'\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\techo L::config_username . \": 'lbb', \" . L::config_password_as_set_in . \" '\" . L::config_password_section . \"'\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\n\t\t\t\t\t</p>\n\t\t\t\t\t<?php\n\t\t\t\t\t\tif (strpos($_SERVER['SERVER_PORT'], \"443\") !== false) {\n\t\t\t\t\t\t\t$rclone_link=\"https://\" . $_SERVER['SERVER_ADDR'] . \":8443\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$rclone_link=\"http://\" . $_SERVER['SERVER_ADDR'] . \":81\";\n\t\t\t\t\t\t}\n\t\t\t\t\t?>\n\t\t\t\t\t<a href=\"<?php echo $rclone_link; ?>\" target=\"_blank\"><?php echo L::config_cloud_rclone_gui; ?></a>\n\n\t\t\t\t<h3><?php echo L::config_cloud_restart_header; ?></h3>\n\t\t\t\t\t<label for=\"restart_rclone_gui\"><?php echo L::config_cloud_restart_label; ?></label><br>\n\t\t\t\t\t<input type=\"checkbox\" id=\"restart_rclone_gui\" name=\"restart_rclone_gui\">\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_vpn_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_vpn_type_header; ?></h3>\n\n\t\t\t\t\t<div><?php echo L::config_vpn_type_desc; ?></div>\n\t\t\t\t\t<br>\n\t\t\t\t\t<label for=\"conf_VPN_TYPE_RSYNC\"><?php echo L::config_vpn_type_rsync_label; ?></label><br>\n\t\t\t\t\t<select name=\"conf_VPN_TYPE_RSYNC\" id=\"conf_VPN_TYPE_RSYNC\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\techo \"<option value='none'  \" . ($config[\"conf_VPN_TYPE_RSYNC\"] == \"none\"?\" selected\":\"\") . \">\" . L::config_vpn_type_none . \"</option>\";\n\t\t\t\t\t\t\tforeach($vpn_types as $vpn_type) {\n\t\t\t\t\t\t\t\techo \"<option value='\" . $vpn_type . \"' \" . ($config[\"conf_VPN_TYPE_RSYNC\"] == $vpn_type?\" selected\":\"\") . \">\" . $vpn_type . \"</option>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</select><br>\n\n\t\t\t\t\t<label for=\"conf_VPN_TYPE_CLOUD\"><?php echo L::config_vpn_type_cloud_label; ?></label><br>\n\t\t\t\t\t<select name=\"conf_VPN_TYPE_CLOUD\" id=\"conf_VPN_TYPE_CLOUD\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\techo \"<option value='none'  \" . ($config[\"conf_VPN_TYPE_CLOUD\"] == \"none\"?\" selected\":\"\") . \">\" . L::config_vpn_type_none . \"</option>\";\n\t\t\t\t\t\t\tforeach($vpn_types as $vpn_type) {\n\t\t\t\t\t\t\t\techo \"<option value='\" . $vpn_type . \"' \" . ($config[\"conf_VPN_TYPE_CLOUD\"] == $vpn_type?\" selected\":\"\") . \">\" . $vpn_type . \"</option>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</select>\n\n\t\t\t\t<h3><?php echo L::config_vpn_timeout_header; ?></h3>\n\n\t\t\t\t\t<label for=\"conf_VPN_TIMEOUT\"><?php echo L::config_vpn_timeout_label; ?></label><br>\n\t\t\t\t\t<select name=\"conf_VPN_TIMEOUT\" id=\"conf_VPN_TIMEOUT\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t$vpn_timeouts\t= array(5,10,20,30,40,50,60,90,120,300,600);\n\t\t\t\t\t\t\tforeach($vpn_timeouts as $vpn_timeout) {\n\t\t\t\t\t\t\t\techo \"<option value='\" . $vpn_timeout . \"' \" . ($config[\"conf_VPN_TIMEOUT\"] == $vpn_timeout?\" selected\":\"\") . \">\" . $vpn_timeout . ' ' . L::seconds_short . \"</option>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</select>\n\n\t\t\t\t<h3><?php echo L::config_vpn_upload_header; ?></h3>\n\n\t\t\t\t\t<label for=\"vpn_upload_type\"><?php echo L::config_vpn_upload_type_label; ?></label>\n\t\t\t\t\t<select name=\"vpn_upload_type\" id=\"vpn_upload_type\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\techo \"<option value='none' selected>\" . L::config_vpn_upload_type_none . \"</option>\";\n\t\t\t\t\t\t\tforeach($vpn_types as $vpn_type) {\n\t\t\t\t\t\t\t\techo \"<option value='\" . $vpn_type . \"'>\" . $vpn_type . \"</option>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</select>\n\n\t\t\t\t\t<label for=\"vpn_conf_file\"><?php echo L::config_vpn_upload_file_label; ?></label>\n\t\t\t\t\t<input type=\"file\" name=\"vpn_conf_file\" id=\"vpn_conf_file\">\n\n\t\t\t\t\t<?php\n\t\t\t\t\t\t$vpn_remove_section\t= False;\n\t\t\t\t\t\tforeach($vpn_types as $vpn_type) {\n\t\t\t\t\t\t\t$vpn_file_exists[$vpn_type]\t= exec('sudo -- bash -c \"if [ -f \\\"' . $constants['const_VPN_DIR_' . $vpn_type] . '/' . $constants['const_VPN_FILENAME_' . $vpn_type] . '\\\" ]; then echo \\\"true\\\"; fi\"')==\"true\";\n\t\t\t\t\t\t\tif ($vpn_file_exists[$vpn_type]) {$vpn_remove_section = True;}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ($vpn_remove_section) {\n\t\t\t\t\t\t\t\techo ('<h3>' . L::config_vpn_remove_header .'</h3>');\n\n\t\t\t\t\t\t\t\t\tforeach($vpn_types as $vpn_type) {\n\t\t\t\t\t\t\t\t\t\tif ($vpn_file_exists[$vpn_type]) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<p>\";\n\t\t\t\t\t\t\t\t\t\t\techo ('<label for=\"vpn_remove_' . $vpn_type . '\">' . $vpn_type . '</label><br>');\n\t\t\t\t\t\t\t\t\t\t\techo ('<input type=\"checkbox\" id=\"vpn_remove_' . $vpn_type . '\" name=\"vpn_remove_' . $vpn_type . '\">');\n\t\t\t\t\t\t\t\t\t\t\techo \"</p>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t?>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_wifi_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_wifi_country_header; ?></h3>\n\t\t\t\t\t<label for=\"conf_WIFI_COUNTRY\"><?php echo L::config_wifi_country_label; ?></label><br>\n\t\t\t\t\t<?php echo get_wifi_country_selector(\"conf_WIFI_COUNTRY\",\"conf_WIFI_COUNTRY\"); ?>\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_hardware_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_display_hardware_header; ?></h3>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_DRIVER\"><?php echo L::config_display_driver_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_DRIVER\" id=\"conf_DISP_DRIVER\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_drivers_array=array(\n\t\t\t\t\t\t\t\t\t\t\"SSD1306\",\n\t\t\t\t\t\t\t\t\t\t\"SSD1309\",\n\t\t\t\t\t\t\t\t\t\t\"SSD1322\",\n\t\t\t\t\t\t\t\t\t\t\"SSD1331\",\n\t\t\t\t\t\t\t\t\t\t\"SH1106\"\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tforeach($display_drivers_array as $display_driver) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_driver . \"' \" . ($config[\"conf_DISP_DRIVER\"] == $display_driver?\" selected\":\"\") . \">\" . $display_driver . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n<div>\n\t\t\t\t\t\t<h4><?php echo L::config_display_connection_header; ?></h4>\n\t\t\t\t\t\t\t<label for=\"conf_DISP_CONNECTION\"><?php echo L::config_display_connection_label; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"conf_DISP_CONNECTION\" id=\"conf_DISP_CONNECTION\">\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t$display_connections_array=array(\"I2C\",\"SPI\");\n\t\t\t\t\t\t\t\t\t\tforeach($display_connections_array as $display_connection) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_connection . \"' \" . ($config[\"conf_DISP_CONNECTION\"] == $display_connection?\" selected\":\"\") . \">\" . $display_connection . \"</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h4><?php echo L::config_display_i2c_header; ?></h4>\n\t\t\t\t\t\t\t<label for=\"conf_DISP_I2C_ADDRESS\"><?php echo L::config_display_i2c_address_label; ?></label><br>\n\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t$I2C_DETECT=shell_exec(\"sudo i2cdetect -y 1\");\n\n\t\t\t\t\t\t\t\t$I2C_LIST=array(\"0x3c\",\"0x3d\");\n\t\t\t\t\t\t\t\tforeach($I2C_LIST as $I2C) {\n\t\t\t\t\t\t\t\t\tif (! in_array($config['conf_DISP_I2C_ADDRESS'], $I2C_LIST)) {\n\t\t\t\t\t\t\t\t\t\t$config['conf_DISP_I2C_ADDRESS']\t= $I2C;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"conf_DISP_I2C_ADDRESS_<?php echo $I2C; ?>\" name=\"conf_DISP_I2C_ADDRESS\" value=\"<?php echo $I2C; ?>\" <?php echo strcasecmp($config['conf_DISP_I2C_ADDRESS'],$I2C)==0?\"checked\":\"\"; ?>>\n\t\t\t\t\t\t\t\t\t<label for=\"conf_DISP_I2C_ADDRESS_<?php echo $I2C; ?>\"><?php echo $I2C; ?> <?php echo strpos($I2C_DETECT,\" \" . $I2C)?\" - \" . L::config_display_device_available:\"\"; ?></label><br>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<h4><?php echo L::config_display_spi_header; ?></h4>\n\t\t\t\t\t\t\t<label for=\"conf_DISP_SPI_PORT\"><?php echo L::config_display_spi_port_label; ?></label><br>\n\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t$spi_ports_array=array(\"0\",\"1\");\n\t\t\t\t\t\t\t\t\t\tforeach($spi_ports_array as $spi_port) {\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<input type=\"radio\" id=\"conf_DISP_SPI_PORT_<?php echo $spi_port; ?>\" name=\"conf_DISP_SPI_PORT\" value=\"<?php echo $spi_port; ?>\" <?php echo strcasecmp($config['conf_DISP_SPI_PORT'],$spi_port)==0?\"checked\":\"\"; ?>>\n\t\t\t\t\t\t\t\t\t<label for=\"conf_DISP_SPI_PORT_<?php echo $spi_port; ?>\"><?php echo $spi_port; ?></label><br>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_RESOLUTION_X\"><?php echo L::config_display_resolution_x_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_RESOLUTION_X\" id=\"conf_DISP_RESOLUTION_X\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_resolutions_array=array(96,128);\n\t\t\t\t\t\t\t\t\tforeach($display_resolutions_array as $display_resolution) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_resolution . \"' \" . ($config[\"conf_DISP_RESOLUTION_X\"] == $display_resolution?\" selected\":\"\") . \">\" . $display_resolution . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_RESOLUTION_Y\"><?php echo L::config_display_resolution_y_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_RESOLUTION_Y\" id=\"conf_DISP_RESOLUTION_Y\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_resolutions_array=array(\"64\",\"32\");\n\t\t\t\t\t\t\t\t\tforeach($display_resolutions_array as $display_resolution) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_resolution . \"' \" . ($config[\"conf_DISP_RESOLUTION_Y\"] == $display_resolution?\" selected\":\"\") . \">\" . $display_resolution . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_DISP_COLOR_MODEL\"><?php echo L::config_display_color_model_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_DISP_COLOR_MODEL\" id=\"conf_DISP_COLOR_MODEL\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$display_color_models_array=array(\"1\",\"RGB\",\"RGBA\");\n\t\t\t\t\t\t\t\t\tforeach($display_color_models_array as $display_color_model) {\n\t\t\t\t\t\t\t\t\t\t$display_color_model_entity=\"config_display_color_model_\" . $display_color_model;\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $display_color_model . \"' \" . ($config[\"conf_DISP_COLOR_MODEL\"] == $display_color_model?\" selected\":\"\") . \">\" . L::{\"$display_color_model_entity\"}() . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t<h3><?php echo L::config_menu_button_header; ?></h3>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_MENU_BUTTON_COMBINATION\"><?php echo L::config_menu_button_combination_label; ?></label><br>\n\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t$button_combinations\t= array();\n\n\t\t\t\t\t\t\t\t$button_config_files\t= array(\n\t\t\t\t\t\t\t\t\t$WORKING_DIR.'/'.$constants['const_BUTTONS_CONFIG_FILE'],\n\t\t\t\t\t\t\t\t\t$constants['const_MEDIA_DIR'].'/'.$constants['const_BUTTONS_PRIVATE_CONFIG_FILE']\n\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t$BasicLines\t= 0;\n\t\t\t\t\t\t\t\tforeach ($button_config_files as $button_config_file) {\n\n\t\t\t\t\t\t\t\t\tif ($f = fopen($button_config_file, \"r\")) {\n\t\t\t\t\t\t\t\t\t\twhile(!feof($f)) {\n\t\t\t\t\t\t\t\t\t\t\t$Line = trim(fgets($f));\n\t\t\t\t\t\t\t\t\t\t\tif (! empty($Line)) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (substr($Line,0,1) != '#') {\n\t\t\t\t\t\t\t\t\t\t\t\t\t$CombinationArray\t= array(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'up' \t\t=> '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'down'\t\t=> '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'left' \t\t=> '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'right'\t\t=> '',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t'comment'\t=> ''\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t$explodeLine\t= explode(':',$Line,2);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (count($explodeLine) > 1) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$CombinationArray['comment']\t= $explodeLine[1];\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t$PIN_Defs\t\t= explode(',',$explodeLine[0]);\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tforeach($PIN_Defs as $PIN_Def) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$explodePinDef\t= explode('=', $PIN_Def);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (count($explodePinDef) == 2) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (in_array($explodePinDef[1],array('up','down','left','right','comment'))) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (! empty($CombinationArray[$explodePinDef[1]])) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$CombinationArray[$explodePinDef[1]]\t.= ', ';\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$CombinationArray[$explodePinDef[1]]\t.= $explodePinDef[0];\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\t\tarray_push($button_combinations,$CombinationArray);\n\t\t\t\t\t\t\t\t\t\t\t\t\tif ($button_config_file == $button_config_files[0]) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$BasicLines\t+= 1;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tfclose($f);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t<select name=\"conf_MENU_BUTTON_COMBINATION\" id=\"conf_MENU_BUTTON_COMBINATION\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\tforeach($button_combinations as $variant => $button_combination) {\n\t\t\t\t\t\t\t\t\t\tif ($variant < $BasicLines) {\n\t\t\t\t\t\t\t\t\t\t\t$VariantOption\t= $variant + 1;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t$VariantOption\t= 'c' . ($variant - $BasicLines + 1);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\techo (\"<option value='\" . $VariantOption . \"' \" . ($config[\"conf_MENU_BUTTON_COMBINATION\"] == $VariantOption?\" selected\":\"\") . \">\" . $VariantOption . \"</option>\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\n\t\t\t\t\t\t\t<table style=\"width: 100%;\">\n\t\t\t\t\t\t\t\t<tr style=\"border: thin solid;\">\n\t\t\t\t\t\t\t\t\t<th style=\"width: 20%;\">\n\t\t\t\t\t\t\t\t\t\t<?php echo L::config_menu_button_combination_variant; ?>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th style=\"width: 20%;\">\n\t\t\t\t\t\t\t\t\t\t<?php echo L::config_menu_button_up; ?>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th>\n\t\t\t\t\t\t\t\t\t\t<?php echo L::config_menu_button_down; ?>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th style=\"width: 20%;\">\n\t\t\t\t\t\t\t\t\t\t<?php echo L::config_menu_button_left; ?>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th style=\"width: 20%;\">\n\t\t\t\t\t\t\t\t\t\t<?php echo L::config_menu_button_right; ?>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t<th style=\"width: 20%;\">\n\t\t\t\t\t\t\t\t\t\t<?php echo L::config_menu_button_comment; ?>\n\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\tforeach($button_combinations as $variant => $button_combination) {\n\t\t\t\t\t\t\t\t\t\tif ($variant < $BasicLines) {\n\t\t\t\t\t\t\t\t\t\t\t$openerTAG\t\t= '';\n\t\t\t\t\t\t\t\t\t\t\t$closerTAG\t\t= '';\n\t\t\t\t\t\t\t\t\t\t\t$VariantOption\t= $variant + 1;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t$openerTAG\t\t= '<b><i>';\n\t\t\t\t\t\t\t\t\t\t\t$closerTAG\t\t= '</i></b>';\n\t\t\t\t\t\t\t\t\t\t\t$VariantOption\t= 'c' . ($variant - $BasicLines + 1);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\techo(\"<tr style=\\\"border: thin solid; vertical-align: top;\\\"><td>\".$openerTAG.$VariantOption.$closerTAG.\"</td>\");\n\t\t\t\t\t\t\t\t\t\tforeach($button_combination as $column => $FIELD) {\n\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t\t<td style=\"border: thin solid; vertical-align: top;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?php echo ($openerTAG.$FIELD.$closerTAG); ?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\techo(\"</tr>\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t<a href=\"/files/index.php?p=&edit=buttons.private.cfg\"><?php echo L::config_menu_button_edit_custom_configfile; ?></a>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_MENU_BUTTON_BOUNCETIME\"><?php echo L::config_menu_button_bouncetime_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_MENU_BUTTON_BOUNCETIME\" id=\"conf_MENU_BUTTON_BOUNCETIME\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$button_bouncetimes_array=array(25,50,100,200,300,400,500);\n\t\t\t\t\t\t\t\t\tforeach($button_bouncetimes_array as $button_bouncetime) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $button_bouncetime . \"' \" . ($config[\"conf_MENU_BUTTON_BOUNCETIME\"] == $button_bouncetime?\" selected\":\"\") . \">\" . $button_bouncetime . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select><br>\n\n\t\t\t\t\t\t<label for=\"conf_MENU_BUTTON_EDGE_DETECTION\"><?php echo L::config_menu_button_edge_detection_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_MENU_BUTTON_EDGE_DETECTION\" id=\"conf_MENU_BUTTON_EDGE_DETECTION\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$button_edge_detections_array=array('RISING','FALLING');\n\t\t\t\t\t\t\t\t\tforeach($button_edge_detections_array as $button_edge_detection) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $button_edge_detection . \"' \" . ($config[\"conf_MENU_BUTTON_EDGE_DETECTION\"] == $button_edge_detection?\" selected\":\"\") . \">\" . $button_edge_detection . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select><br>\n\n\t\t\t\t\t\t<label for=\"conf_MENU_BUTTON_RESISTOR_PULL\"><?php echo L::config_menu_button_resitor_pull_label; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"conf_MENU_BUTTON_RESISTOR_PULL\" id=\"conf_MENU_BUTTON_RESISTOR_PULL\">\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t$button_resitor_pulls_array=array('DOWN','UP');\n\t\t\t\t\t\t\t\t\tforeach($button_resitor_pulls_array as $button_resitor_pull) {\n\t\t\t\t\t\t\t\t\t\techo \"<option value='\" . $button_resitor_pull . \"' \" . ($config[\"conf_MENU_BUTTON_RESISTOR_PULL\"] == $button_resitor_pull?\" selected\":\"\") . \">\" . $button_resitor_pull . \"</option>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t<h3><?php echo L::config_hardware_fan_header; ?></h3>\n\t\t\t\t\t<div>\n\t\t\t\t\t<label for=\"conf_FAN_PWM_TEMP_C\"><?php echo L::config_hardware_fan_temp_label; ?></label><br>\n\t\t\t\t\t\t<select name=\"conf_FAN_PWM_TEMP_C\" id=\"conf_FAN_PWM_TEMP_C\">\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t$conf_FAN_PWM_TEMP_Cs=array(0,60,65,70,75,80);# allowed 60..120 \u00b0C\n\t\t\t\t\t\t\t\tforeach($conf_FAN_PWM_TEMP_Cs as $conf_FAN_PWM_TEMP_C) {\n\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $conf_FAN_PWM_TEMP_C .\"\\\"\". ($config[\"conf_FAN_PWM_TEMP_C\"]==$conf_FAN_PWM_TEMP_C?\" selected\":\"\") . \">\" . ($conf_FAN_PWM_TEMP_C==\"0\"?L::config_hardware_fan_always_on:$conf_FAN_PWM_TEMP_C . \" \" . L::units_celsius) . \"</option>\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<label for=\"conf_FAN_PWM_GPIO\"><?php echo L::config_hardware_fan_gpio_label; ?></label><br>\n\t\t\t\t\t\t<select name=\"conf_FAN_PWM_GPIO\" id=\"conf_FAN_PWM_GPIO\">\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t$conf_FAN_PWM_GPIOs=array('-','14','15','18','23','24'); # allowed 2..27\n\t\t\t\t\t\t\t\tforeach($conf_FAN_PWM_GPIOs as $conf_FAN_PWM_GPIO) {\n\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $conf_FAN_PWM_GPIO .\"\\\"\". ($config[\"conf_FAN_PWM_GPIO\"]==$conf_FAN_PWM_GPIO?\" selected\":\"\") . \">\" . $conf_FAN_PWM_GPIO . \"</option>\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_password_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_password_header; ?></h3>\n\t\t\t\t\t<input type=\"hidden\" id=\"conf_PASSWORD_OLD\" name=\"conf_PASSWORD_OLD\" value=\"<?php echo $config['conf_PASSWORD']; ?>\">\n\t\t\t\t\t<label for=\"conf_PASSWORD_1\"><p><?php echo L::config_password_global_lbb_label . '</p><p style=\"text-decoration: underline;\">' . L::config_password_global_wifi_label . '</p><p><b>' . L::config_alert_password_characters_not_allowed . '</b>'; ?></label></p>\n\t\t\t\t\t<input type=\"password\" id=\"conf_PASSWORD_1\" name=\"conf_PASSWORD_1\" size=\"20\" value=\"\">\n\t\t\t\t\t<label for=\"conf_PASSWORD_2\"><?php echo L::config_password_repeat_label; ?></label><br>\n\t\t\t\t\t<input type=\"password\" id=\"conf_PASSWORD_2\" name=\"conf_PASSWORD_2\" size=\"20\" value=\"\">\n\n\t\t\t\t\t<?php\n\t\t\t\t\t\tif ($config['conf_PASSWORD'] != \"\") {\n\t\t\t\t\t\t\techo \"<h3>\" . L::config_password_remove_header . \"</h3>\";\n\t\t\t\t\t\t\techo \"<p>\";\n\t\t\t\t\t\t\techo \"<label for=\\\"conf_PASSWORD_REMOVE\\\">\" . L::config_password_remove_label .\"</label><br>\";\n\t\t\t\t\t\t\techo \"<input type=\\\"checkbox\\\" id=\\\"conf_PASSWORD_REMOVE\\\" name=\\\"conf_PASSWORD_REMOVE\\\">&nbsp;\";\n\t\t\t\t\t\t\techo \"</p>\";\n\t\t\t\t\t\t}\n\t\t\t\t\t?>\n\t\t\t</details>\n\t\t</div>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<?php echo '<button style=\"margin-top: 2em;\" type=\"submit\" name=\"save\">' . L::config_save_button . '</button>'; ?>\n\t\t</div>\n\n\t</form>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_save_settings_section; ?></summary>\n\n\t\t\t\t<h3><?php echo L::config_save_settings_download_header; ?></h3>\n\t\t\t\t\t<p><?php echo L::config_save_settings_download_text; ?></p>\n\t\t\t\t\t<a href=\"download-settings.php\"><?php echo L::config_save_settings_download_link_text; ?></a>\n\n\t\t\t\t<h3><?php echo L::config_save_settings_upload_header; ?></h3>\n\t\t\t\t\t<form action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST\" enctype=\"multipart/form-data\">\n\t\t\t\t\t\t<label for=\"settings_file\"><?php echo L::config_save_settings_upload_label; ?></label>\n\t\t\t\t\t\t<input type=\"file\" name=\"settings_file\" id=\"settings_file\">\n\t\t\t\t\t\t<button style=\"margin-top: 2em;\" type=\"submit\" name=\"upload_settings\"><?php echo L::config_save_settings_upload_button; ?></button>\n\t\t\t\t\t</form>\n\n\t\t\t</details>\n\t\t</div>\n\n\t\t<?php if (shell_exec('which comitup-cli') != '') { ?>\n\t\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t\t<details>\n\t\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_comitup_section; ?></summary>\n\t\t\t\t\t<?php echo L::config_comitup_text; ?><br>\n\t\t\t\t\t<br>\n\t\t\t\t\t<a href='/cmd.php?CMD=comitup_reset'><?php echo L::config_comitup_linktext ?></a>\n\t\t\t\t</details>\n\t\t\t</div>\n\t\t<?php } ?>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<details>\n\t\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::config_update_section; ?></summary>\n\t\t\t\t<?php echo L::config_update_text; ?>\n\t\t\t\t<ul>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<?php echo ($constants['const_SOFTWARE_VERSION'] == 'main' ? '<b>' : ''); ?>\n\t\t\t\t\t\t\t<a href='/cmd.php?CMD=update'><?php echo L::config_update_linktext ?></a>\n\t\t\t\t\t\t<?php echo ($constants['const_SOFTWARE_VERSION'] == 'main' ? '</b>' : ''); ?>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li>\n\t\t\t\t\t\t<?php echo ($constants['const_SOFTWARE_VERSION'] == 'development' ? '<b>' : ''); ?>\n\t\t\t\t\t\t\t<a href='/cmd.php?CMD=update_development'><?php echo L::config_update_development_linktext ?></a>\n\t\t\t\t\t\t<?php echo ($constants['const_SOFTWARE_VERSION'] == 'development' ? '<b>' : ''); ?>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</details>\n\t\t</div>\n\n\t\t<?php include \"sub-footer.php\"; ?>\n\n</body>\n\n</html>\n", "<!doctype html>\n\n<!-- Author: Stefan Saam, github@saams.de\n         License: GPLv3 https://www.gnu.org/licenses/gpl-3.0.txt -->\n\n<?php\n\t$WORKING_DIR=dirname(__FILE__);\n\t$config = parse_ini_file(\"config.cfg\", false);\n\t$constants = parse_ini_file(\"constants.sh\", false);\n\t$theme = $config[\"conf_THEME\"];\n\t$background = $config[\"conf_BACKGROUND_IMAGE\"] == \"\"?\"\":\"background='\" . $constants[\"const_MEDIA_DIR\"] . '/' . $constants[\"const_BACKGROUND_IMAGES_DIR\"] . \"/\" . $config[\"conf_BACKGROUND_IMAGE\"] . \"'\";\n\n\t# read parameters\n\textract ($_POST,EXTR_SKIP);\n\textract ($_GET,EXTR_SKIP);\n\n\tinclude(\"sub-popup.php\");\n\n\tinclude(\"get-cloudservices.php\");\n\n\t# symlink to media-folder\n\tif (! file_exists(\"./media\")) {\n\t\tsymlink(\"/media\", \"./media\");\n\t}\n\n\n\tfunction urlencode_keep_slashes($href) {\n\t\treturn(\n\t\t\tstr_replace('//','/',\n\t\t\t\tstr_replace('%2F','/',rawurlencode($href))\n\t\t\t)\n\t\t);\n\t}\n\n\tfunction navigator($view_mode,$imagecount,$filter_images_per_page,$select_offset,$filter_rating,$IMAGE_ID_PRE,$IMAGE_ID,$IMAGE_ID_POST,$IMAGE_ID_FIRST,$IMAGE_ID_LAST,$GET_PARAMETER,$order_by,$order_dir,$label_filename,$label_creationdate,$label_id) {\n\t\tif ($view_mode == \"grid\") {\n\t\t\t?>\n\t\t\t<div class=\"card\" style=\"margin-top: 2em;display: inline-block;width: 100%\">\n\t\t\t\t<div style=\"float:left;width: 50%;padding: 5px;\">\n\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . \"&ID=\" . $IMAGE_ID_FIRST; ?>\">&lt;&lt;</a>\n\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . \"&ID=\" . $IMAGE_ID_PRE; ?>\">&lt;</a>\n\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t\t<?php\n\n\t\t\t\t\t\t$link_order_text\t= $label_creationdate;\n\t\t\t\t\t\t$link_order\t\t\t= $GET_PARAMETER . \"&order_by=Create_Date&order_dir=\";\n\t\t\t\t\t\tif ($order_by==\"Create_Date\") {\n\t\t\t\t\t\t\t$link_order_text\t.= $order_dir == \"ASC\"?\"&darr;\":\"&uarr;\"; #symbol reversed because of print-direction up to down\n\t\t\t\t\t\t\t$link_order_text\t= \"<b>\" . $link_order_text . \"</b>\";\n\t\t\t\t\t\t\t$link_order\t\t\t.= $order_dir == \"ASC\"?\"DESC\":\"ASC\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$link_order\t\t\t.= \"ASC\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\techo \"<a href='\" . $link_order . \"'>\" . $link_order_text . \"</a>\";\n\n\t\t\t\t\t\t$page\t= intval(($select_offset + 2) / $filter_images_per_page) + 1;\n\t\t\t\t\t\t$pages\t= intval($imagecount / $filter_images_per_page) + 1;\n\t\t\t\t\t\techo \"&nbsp;&nbsp;&nbsp;&nbsp;\" . L::view_images_page . ' ' . $page . '/' . $pages;\n\t\t\t\t\t?>\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"float:right;width: 50%;padding: 5px;text-align: right\">\n\t\t\t\t\t<?php\n\t\t\t\t\t\t$link_order_text\t= $label_filename;\n\t\t\t\t\t\t$link_order\t\t\t= $GET_PARAMETER . \"&order_by=File_Name&order_dir=\";\n\t\t\t\t\t\tif ($order_by==\"File_Name\") {\n\t\t\t\t\t\t\t$link_order_text\t.= $order_dir == \"ASC\"?\"&darr;\":\"&uarr;\"; #symbol reversed because of print-direction up to down\n\t\t\t\t\t\t\t$link_order_text\t= \"<b>\" . $link_order_text . \"</b>\";\n\t\t\t\t\t\t\t$link_order\t\t\t.= $order_dir == \"ASC\"?\"DESC\":\"ASC\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$link_order\t\t\t.= \"ASC\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\techo $imagecount . ' ' . L::view_images_images . \"&nbsp;&nbsp;&nbsp;&nbsp;\";\n\n\t\t\t\t\t\techo \"<a href='\" . $link_order . \"'>\" . $link_order_text . \"</a>&nbsp;&nbsp;&nbsp;&nbsp;\";\n\n\t\t\t\t\t\t$link_order_text\t= $label_id;\n\t\t\t\t\t\t$link_order\t\t\t= $GET_PARAMETER . \"&order_by=ID&order_dir=\";\n\t\t\t\t\t\tif ($order_by==\"ID\") {\n\t\t\t\t\t\t\t$link_order_text\t.= $order_dir == \"ASC\"?\"&darr;\":\"&uarr;\"; #symbol reversed because of print-direction up to down\n\t\t\t\t\t\t\t$link_order_text\t= \"<b>\" . $link_order_text . \"</b>\";\n\t\t\t\t\t\t\t$link_order\t\t\t.= $order_dir == \"ASC\"?\"DESC\":\"ASC\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$link_order\t\t\t.= \"ASC\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\techo \"<a href='\" . $link_order . \"'>\" . $link_order_text . \"</a>\";\n\t\t\t\t\t?>\n\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . \"&ID=\" . $IMAGE_ID_POST; ?>\">&gt;</a>\n\t\t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . \"&ID=\" . $IMAGE_ID_LAST; ?>\">&gt;&gt;</a>\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"display: flow-root;width: 100%\">\n\n\t\t\t\t\t<div style=\"float:left;width: 50%;padding: 5px\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\tif ($filter_rating == 1) {\n\t\t\t\t\t\t\t\techo \"<button style=\\\"margin-top: 2em;\\\" type=\\\"submit\\\" name=\\\"delete_ratings_1\\\" class=\\\"danger\\\">\" . L::view_ratings_1_delete_button . \"</button>\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div style=\"float:right;width: 50%;padding: 5px;text-align: right;\">\n\t\t\t\t\t\t<button style=\"margin-top: 2em;\" type=\"submit\" name=\"save_ratings\"><?php echo L::view_ratings_save_button; ?></button>\n\t\t\t\t\t</div>\n\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<?php\n\t\t} else {\n// \t\t\t$view_mode=\"single\"\n\t\t\t?>\n\t\t\t<div class=\"card\" style=\"margin-top: 2em;display: inline-block;width: 100%\">\n\t\t\t\t<div style=\"float:left;width: 50%;padding: 5px;\">\n\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . '&view_mode=grid&ID=' . $IMAGE_ID; ?>\">\n\t\t\t\t\t\t<?php echo L::view_images_back_to_grid; ?>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"float:left;width: 100%;padding: 5px;text-align: right;\">\n\t\t\t\t\t<div style=\"float:left;width: 33%;text-align: left;padding: 0;\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\tif ($IMAGE_ID_PRE > 0) {\n\t\t\t\t\t\t\t\techo \"<button style=\\\"margin-top: 2em;\\\" type=\\\"submit\\\" name=\\\"ID\\\" value=\\\"\" . $IMAGE_ID_PRE . \"\\\">&lt; \" . L::view_ratings_save_button . \"</button>\";\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\techo \"&nbsp;\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div style=\"float:left;width: 34%;text-align: center;padding: 0;\">\n\t\t\t\t\t\t<button style=\"margin-top: 2em;\" type=\"submit\" name=\"ID\" value=\"<?php echo $IMAGE_ID; ?>\"><?php echo L::view_ratings_save_button ?></button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div style=\"float:left;width: 33%;text-align: right;padding: 0;\">\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\tif ($IMAGE_ID_POST > 0) {\n\t\t\t\t\t\t\t\techo \"<button style=\\\"margin-top: 2em;\\\" type=\\\"submit\\\" name=\\\"ID\\\" value=\\\"\" . $IMAGE_ID_POST . \"\\\">\" . L::view_ratings_save_button . \" &gt;</button>\";\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\techo \"&nbsp;\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<?php\n\t\t}\n\t}\n\n\tfunction rating_radio($IMAGE_ID, $IMAGE_RATING) {\n\t\t?>\n\t\t\t<div style=\"float:left;padding: 2px;\" class=\"rating\">\n\t\t\t\t<input id=\"rating_1_<?php echo $IMAGE_ID; ?>\" type=\"radio\" name=\"rating_<?php echo $IMAGE_ID; ?>\" value=\"1\" <?php echo $IMAGE_RATING>=1?\"checked\":\"\"; ?>>\n\t\t\t\t<label for=\"rating_1_<?php echo $IMAGE_ID; ?>\"></label>\n\t\t\t\t<input id=\"rating_2_<?php echo $IMAGE_ID; ?>\" type=\"radio\" name=\"rating_<?php echo $IMAGE_ID; ?>\" value=\"2\" <?php echo $IMAGE_RATING>=2?\"checked\":\"\"; ?>>\n\t\t\t\t<label for=\"rating_2_<?php echo $IMAGE_ID; ?>\"></label>\n\t\t\t\t<input id=\"rating_3_<?php echo $IMAGE_ID; ?>\" type=\"radio\" name=\"rating_<?php echo $IMAGE_ID; ?>\" value=\"3\" <?php echo $IMAGE_RATING>=3?\"checked\":\"\"; ?>>\n\t\t\t\t<label for=\"rating_3_<?php echo $IMAGE_ID; ?>\"></label>\n\t\t\t\t<input id=\"rating_4_<?php echo $IMAGE_ID; ?>\" type=\"radio\" name=\"rating_<?php echo $IMAGE_ID; ?>\" value=\"4\" <?php echo $IMAGE_RATING>=4?\"checked\":\"\"; ?>>\n\t\t\t\t<label for=\"rating_4_<?php echo $IMAGE_ID; ?>\"></label>\n\t\t\t\t<input id=\"rating_5_<?php echo $IMAGE_ID; ?>\" type=\"radio\" name=\"rating_<?php echo $IMAGE_ID; ?>\" value=\"5\" <?php echo $IMAGE_RATING>=5?\"checked\":\"\"; ?>>\n\t\t\t\t<label for=\"rating_5_<?php echo $IMAGE_ID; ?>\"></label>\n\t\t\t</div>\n\t\t<?php\n\t}\n\n\tfunction add_to_where($new_where,$target_array) {\n\t\tglobal $WHERE;\n\n\t\tforeach ($target_array as $target) {\n\t\t\tif ($WHERE[$target] != \"\") {\n\t\t\t\t$WHERE[$target]\t.= \" and \";\n\t\t\t} else {\n\t\t\t\t$WHERE[$target]\t= \"where \";\n\t\t\t}\n\n\t\t\t$WHERE[$target]\t.= \"($new_where)\";\n\t\t}\n\t}\n\n\t# setup\n\t$IMAGES_PER_PAGE_OPTIONS\t= array ($constants['const_VIEW_GRID_COLUMNS']*5,$constants['const_VIEW_GRID_COLUMNS']*10,$constants['const_VIEW_GRID_COLUMNS']*20,$constants['const_VIEW_GRID_COLUMNS']*50);\n\n\t# standard values\n\t$filter_medium\t\t\t\t\t= isset($filter_medium) ? $filter_medium : \"-\";\n\t$view_mode\t\t\t\t\t\t= isset($view_mode) ? $view_mode :  \"grid\";\n\t$filter_images_per_page\t\t\t= isset($filter_images_per_page) ? $filter_images_per_page :  $IMAGES_PER_PAGE_OPTIONS[1];\n\t$filter_directory\t\t\t\t= isset($filter_directory) ? $filter_directory :  \"\";\n\t$filter_date\t\t\t\t\t= isset($filter_date) ? $filter_date :  \"all\";\n\t$filter_rating\t\t\t\t\t= isset($filter_rating) ? $filter_rating :  \"all\";\n\t$filter_file_type\t\t\t\t= isset($filter_file_type) ? $filter_file_type :  \"all\";\n\t$filter_file_type_extension\t\t= isset($filter_file_type_extension) ? $filter_file_type_extension :  \"all\";\n\t$filter_camera_model_name\t\t= isset($filter_camera_model_name) ? $filter_camera_model_name :  \"all\";\n\t$filter_variable_field\t\t\t= isset($filter_variable_field) ? $filter_variable_field :  \"\";\n\t$filter_variable_value\t\t\t= isset($filter_variable_value) ? $filter_variable_value :  \"\";\n\t$ID\t\t\t\t\t\t\t\t= isset($ID) ? $ID :  0;\n\t$IMAGE_ID\t\t\t\t\t\t= isset($IMAGE_ID) ? $IMAGE_ID :  0;\n\t$IMAGE_ID_PRE\t\t\t\t\t= isset($IMAGE_ID_PRE) ? $IMAGE_ID_PRE :  0;\n\t$IMAGE_ID_POST\t\t\t\t\t= isset($IMAGE_ID_POST) ? $IMAGE_ID_POST :  0;\n\t$IMAGE_ID_FIRST\t\t\t\t\t= isset($IMAGE_ID_FIRST) ? $IMAGE_ID_FIRST :  0;\n\t$IMAGE_ID_LAST\t\t\t\t\t= isset($IMAGE_ID_LAST) ? $IMAGE_ID_LAST :  0;\n\t$imagecount\t\t\t\t\t\t= isset($imagecount) ? $imagecount :  0;\n\t$order_by          \t\t\t\t= isset($order_by) ? $order_by :  \"Create_Date\";\n\t$order_dir\t\t\t\t\t\t= isset($order_dir) ? $order_dir :  \"DESC\";\n\t$select_offset\t\t\t\t\t= isset($select_offset) ? $select_offset :  0;\n\n\t$FIELDS_BLOCKED_ARRAY\t= array(\n\t\t\"ID\",\n\t\t\"ExifTool_Version_Number\"\n\t);\n\n\t## security-checks\n\tif (! in_array($filter_images_per_page,$IMAGES_PER_PAGE_OPTIONS)) {\n\t\t$filter_images_per_page\t= $IMAGES_PER_PAGE_OPTIONS[0];\n\t}\n\n\t$ID\t\t\t= intval($ID);\n\n\tif (! in_array($order_by,array('File_Name','Create_Date','ID'))) {$order_by='Create_Date';}\n\n\tif (! in_array($order_dir,array('ASC','DESC'))) {$order_dir='DESC';}\n\n\tif ($filter_rating != \"all\") {\n\t\t$filter_rating\t= intval($filter_rating);\n\t\tif (($filter_rating < 1) or ($filter_rating > 5)) {\n\t\t\t$filter_rating\t= \"all\";\n\t\t}\n\t}\n\n\n\t# ratings-preparation\n\t$RATINGS_ARRAY=array();\n\tforeach ($_POST as $key=>$val) {\n\t\tif (substr($key, 0, 6 )==\"rating\") {\n\t\t\t$ID_RATING\t= explode(\"_\",$key)[1];\n \t\t\t$RATINGS_ARRAY[$ID_RATING]=$val;\n\t\t}\n\t}\n\n\t#auto-set filter_medium\n\tif ($filter_medium == \"-\") {\n\t\t$mounted_devices_array\t= array();\n\t\texec(\"df -h\", $mounted_devices_array);\n\n\t\t$mounted_devices\t= implode(\"|\",$mounted_devices_array);\n\t\tif (strpos($mounted_devices,$constants['const_MEDIA_DIR'] . '/' . $constants['const_MOUNTPOINT_SUBPATH_LOCAL_TARGET'])) {$filter_medium=\"target_local\";}\n\t\telseif (strpos($mounted_devices,$constants['const_MEDIA_DIR'] . '/' . $constants['const_MOUNTPOINT_SUBPATH_LOCAL_SOURCE'])) {$filter_medium=\"source_local\";}\n\t\telse {$filter_medium=\"internal\";}\n\t}\n\n\t#generate WHERE\n\t$WHERE['images']\t\t\t\t= \"\";\n\t$WHERE['directories']\t\t\t= \"\";\n\t$WHERE['dates']\t\t\t\t\t= \"\";\n\t$WHERE['ratings']\t\t\t\t= \"\";\n\t$WHERE['file_types']\t\t\t= \"\";\n\t$WHERE['file_type_extensions']\t= \"\";\n\t$WHERE['camera_model_name']\t\t= \"\";\n\t$WHERE['variable']\t\t\t\t= \"\";\n\n\tif ($filter_directory != \"\") {\n\t\t$filter_directory\t= str_replace(\"+\",\"=\",$filter_directory);\n\t\t$filter_directory\t= base64_decode($filter_directory);\n\n\t\tadd_to_where(\"Directory='\" . $filter_directory . \"'\",array('images','dates','ratings','file_types','file_type_extensions','camera_model_name','variable'));\n\t}\n\n\tif ($filter_date != \"all\") {add_to_where(\"substr(Create_Date,1,10) like '\" . str_replace(\"-\",\"_\",$filter_date) . \"'\",array('images','directories','ratings','file_types','file_type_extensions','camera_model_name','variable'));}\n\n\tif (isset($delete_ratings_1)) {$filter_rating=\"all\";} # after delete remove rating-filter\n\n\tif ($filter_rating != \"all\") {add_to_where(\"LbbRating = \" . $filter_rating,array('images','dates','file_types','file_type_extensions','camera_model_name','directories'));}\n\n\tif ($filter_file_type != \"all\") {add_to_where(\"File_Type = '\" . $filter_file_type . \"'\",array('images','dates','ratings','file_type_extensions','camera_model_name','directories'));}\n\n\tif ($filter_file_type_extension != \"all\") {add_to_where(\"File_Type_Extension = '\" . $filter_file_type_extension . \"'\",array('images','dates','ratings','file_types','camera_model_name','directories'));}\n\n\tif ($filter_camera_model_name != \"all\") {add_to_where(\"Camera_Model_Name = '\" . $filter_camera_model_name . \"'\",array('images','dates','ratings','file_types','file_type_extensions','directories'));}\n\n\tif ($filter_variable_value != \"\") {\n\t\t$filter_variable_value\t= str_replace(\"+\",\"=\",$filter_variable_value);\n\t\t$filter_variable_value\t= base64_decode($filter_variable_value);\n\n\t\tif (($filter_variable_field != \"\") and ($filter_variable_value != \"\")) {add_to_where($filter_variable_field . \"='\" . $filter_variable_value . \"'\",array('images','directories','dates','ratings','file_type_extensions','camera_model_name'));}\n\t}\n\n\t# generate select_limit\n\t$select_limit\t=  $filter_images_per_page + 3;\n\n\t# define path of the database-file\n\t$STORAGE_PATH\t= \"\";\n\tif ($filter_medium == \"target_local\") {\n\t\t$STORAGE_PATH\t= $constants['const_MEDIA_DIR'] . '/' . $constants['const_MOUNTPOINT_SUBPATH_LOCAL_TARGET'];\n\t}\n\telseif ($filter_medium == \"source_local\") {\n\t\t$STORAGE_PATH\t= $constants['const_MEDIA_DIR'] . '/' . $constants['const_MOUNTPOINT_SUBPATH_LOCAL_SOURCE'];\n\t}\n\telseif ($filter_medium == \"internal\") {\n\t\t$STORAGE_PATH\t= $constants['const_MEDIA_DIR'] . '/' . $constants['const_INTERNAL_BACKUP_DIR'];\n\t}\n\n\t# Database-query\n\t$DATABASE_CONNECTED=true;\n\t$DATABASE_FILE\t= \"\";\n\tif ($STORAGE_PATH != \"\") {\n\t\t$DATABASE_FILE\t= $STORAGE_PATH . '/' . $constants['const_IMAGE_DATABASE_FILENAME'];\n\n\t\tif (file_exists($DATABASE_FILE)) {\n\t\t\ttry {\n\n\t\t\t\tshell_exec(\"sudo chown www-data:www-data '\" . $DATABASE_FILE .\"'\");\n\t\t\t\t$db = new SQLite3($DATABASE_FILE);\n\t\t\t} catch (Exception $e) {\n\t\t\t\t$DATABASE_CONNECTED=false;\n\t\t\t}\n\t\t} else {\n\t\t\t$DATABASE_CONNECTED=false;\n\t\t}\n\n\t\tif ($DATABASE_CONNECTED) {\n\t\t\t# save ratings\n\t\t\tforeach($RATINGS_ARRAY as $key=>$val) {\n\t\t\t\t$key\t= intval($key);\n\t\t\t\t$val\t= intval($val);\n\n\t\t\t\tif ($config['conf_VIEW_WRITE_RATING_EXIF'] == true) {\n\t\t\t\t\t# get database-values before update\n\t\t\t\t\t$statement\t\t\t= $db->prepare(\"SELECT Directory, File_Name, Rating FROM EXIF_DATA where ID=\" . $key . \";\");\n\t\t\t\t\t$RATING_IMAGES\t\t= $statement->execute();\n\t\t\t\t\t$RATING_IMAGE\t\t= $RATING_IMAGES->fetchArray(SQLITE3_ASSOC);\n\n\t\t\t\t\t# define update-command\n\t\t\t\t\t$SQL_UPDATE\t= \"update EXIF_DATA set LbbRating=\". $val . \", Rating=\". $val . \" where ID=\" . $key . \";\";\n\t\t\t\t} else {\n\t\t\t\t\t# define update-command\n\t\t\t\t\t$SQL_UPDATE\t= \"update EXIF_DATA set LbbRating=\". $val . \" where ID=\" . $key . \";\";\n\t\t\t\t}\n\n\t\t\t\t$db->exec($SQL_UPDATE);\n\n\t\t\t\tif (($config['conf_VIEW_WRITE_RATING_EXIF'] == true) and ((int)$RATING_IMAGE['Rating'] !== (int)$val)) {\n\t\t\t\t\t#update exif-data of original file\n\t\t\t\t\tshell_exec (\"sudo exiftool -overwrite_original -Rating=\" . (int)$val . \" '\".$STORAGE_PATH . '/' . $RATING_IMAGE['Directory']. '/' .$RATING_IMAGE['File_Name'] . \"'\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t# delete media-files\n\t\t\tif (isset($delete_ratings_1)) {\n\t\t\t\tforeach($RATINGS_ARRAY as $key=>$val) {\n\t\t\t\t\t$key\t= intval($key);\n\n\t\t\t\t\t$statement\t\t= $db->prepare(\"SELECT File_Name, Directory FROM EXIF_DATA WHERE ID=\" . $key . \";\");\n\t\t\t\t\t$IMAGES\t\t\t= $statement->execute();\n\t\t\t\t\tif ($IMAGE = $IMAGES->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t$DELETE_FILE\t= $STORAGE_PATH . '/' . $IMAGE['Directory'] . '/' . $IMAGE['File_Name'];\n\t\t\t\t\t\t$DELETE_TIMS\t= $STORAGE_PATH . '/' . $IMAGE['Directory'] . '/tims/' . $IMAGE['File_Name'] . '.JPG';\n\t\t\t\t\t\tshell_exec (\"sudo rm '\" . $DELETE_FILE . \"'\");\n\t\t\t\t\t\tshell_exec (\"sudo rm '\" . $DELETE_TIMS . \"'\");\n\t\t\t\t\t\t$db->exec(\"delete from EXIF_DATA where ID=\" . $key . \" and LbbRating=1;\");\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t# database-queries\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT ID FROM EXIF_DATA \" . $WHERE['images'] . \" order by \" . $order_by . \" \" . $order_dir . \";\");\n\t\t\t$IMAGES_ALL\t\t\t= $statement->execute();\n\n\t\t\t#get first and last ID, define offset\n\t\t\t$n = 0;\n\t\t\twhile ($FETCH_IMAGE = $IMAGES_ALL->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t$n += 1;\n\t\t\t\tif ($n == 1) {\n\t\t\t\t\t$IMAGE_ID_FIRST = $FETCH_IMAGE['ID'];\n\t\t\t\t}\n\t\t\t\tif ($FETCH_IMAGE['ID'] == $ID) {\n\t\t\t\t\t$select_offset = intdiv($n,$filter_images_per_page) * $filter_images_per_page - 2;\n\t\t\t\t}\n\t\t\t\t$IMAGE_ID_LAST = $FETCH_IMAGE['ID'];\n\t\t\t}\n\n\t\t\t$imagecount = $n;\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT * FROM EXIF_DATA \" . $WHERE['images'] . \" order by \" . $order_by . \" \" . $order_dir . \" limit \" . $select_limit . \" offset \" . $select_offset . \";\");\n\t\t\t$IMAGES_PAGE\t\t\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT Directory, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['directories'] . \" group by Directory order by Directory;\");\n\t\t\t$DIRECTORIES\t\t\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT LbbRating, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['ratings'] . \" group by LbbRating order by LbbRating;\");\n\t\t\t$RATINGS\t\t\t\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT substr(replace(Create_Date,':','-'),1,10) as Create_Day, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['dates'] . \" group by Create_Day order by Create_Day desc;\");\n\t\t\t$DATES\t\t\t\t\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT File_Type, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['file_types'] . \" group by File_Type order by File_Type;\");\n\t\t\t$FILE_TYPES\t\t\t\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT File_Type_Extension, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['file_type_extensions'] . \" group by File_Type_Extension order by File_Type_Extension;\");\n\t\t\t$FILE_TYPE_EXTENSIONS\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"SELECT Camera_Model_Name, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['camera_model_name'] . \" group by Camera_Model_Name order by Camera_Model_Name;\");\n\t\t\t$CAMERA_MODEL_NAMES\t\t= $statement->execute();\n\n\t\t\t$statement\t\t\t\t= $db->prepare(\"PRAGMA table_info(EXIF_DATA);\");\n\t\t\t$VAR_FIELDS\t\t\t\t= $statement->execute();\n\n\t\t\tif ($filter_variable_field != \"\") {\n\t\t\t\t$statement\t\t\t= $db->prepare(\"SELECT \" . $filter_variable_field . \" as var_filter_value, count (ID) as FILECOUNT FROM EXIF_DATA \" . $WHERE['variable'] . \" group by \" . $filter_variable_field . \" order by \" . $filter_variable_field . \";\");\n\t\t\t\t$VAR_VALUES\t= $statement->execute();\n\t\t\t}\n\n\t\t\t\t\t\t$IMAGES_ARRAY_ALL\t= array();\n\t\t\twhile ($FETCH_IMAGE = $IMAGES_PAGE->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t$IMAGES_ARRAY_ALL[]\t= $FETCH_IMAGE;\n\t\t\t}\n\n\t\t\t#manage images\n\t\t\t$IMAGES_ARRAY = array();\n\t\t\tif ($view_mode == \"grid\") {\n\t\t\t\t$n = 0;\n\t\t\t\tforeach ($IMAGES_ARRAY_ALL as $IMAGE) {\n\t\t\t\t\t$n += 1;\n\t\t\t\t\tif (($n == 1) and ($select_offset > 0)) {\n\t\t\t\t\t\t$IMAGE_ID_PRE = $IMAGE['ID'];\n\t\t\t\t\t} elseif ($n == ($select_offset <= 0 ? 1 : 3)) {\n\t\t\t\t\t\t$IMAGE_ID = $IMAGE['ID'];\n\t\t\t\t\t} elseif ($n == $filter_images_per_page + ($select_offset <= 0 ? 1 : 3)) {\n\t\t\t\t\t\t$IMAGE_ID_POST = $IMAGE['ID'];\n\t\t\t\t\t}\n\n\t\t\t\t\tif ((($n > 2) or ($select_offset <= 0)) and ($n <= $filter_images_per_page + ($select_offset <= 0 ? 0 : 2))) {\n\t\t\t\t\t\t$IMAGES_ARRAY[] = $IMAGE;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} elseif ($view_mode == \"single\") {\n\t\t\t\t$IMAGE_ID\t= $ID;\n\t\t\t\t$ID_OLD = 0;\n\n\t\t\t\t$n = 0;\n\t\t\t\tforeach ($IMAGES_ARRAY_ALL as $IMAGE) {\n\t\t\t\t\t$n += 1;\n\t\t\t\t\tif ($IMAGE['ID'] == $IMAGE_ID) {\n\t\t\t\t\t\t$IMAGE_ID_PRE = $ID_OLD;\n\t\t\t\t\t\t$IMAGES_ARRAY[] = $IMAGE;\n\t\t\t\t\t} elseif ($ID_OLD == $IMAGE_ID) {\n\t\t\t\t\t\t$IMAGE_ID_POST = $IMAGE['ID'];\n\t\t\t\t\t}\n\t\t\t\t\t$ID_OLD = $IMAGE['ID'];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t# define GET_PARAMETER\n\t$GET_PARAMETER\t= \"?filter_medium=$filter_medium\";\n\t$GET_PARAMETER\t.= \"&view_mode=$view_mode\";\n\t$GET_PARAMETER\t.= \"&order_by=$order_by\";\n\t$GET_PARAMETER\t.= \"&order_dir=$order_dir\";\n\t$GET_PARAMETER\t.= \"&filter_images_per_page=$filter_images_per_page\";\n\tif ($filter_directory != \"\") {$GET_PARAMETER\t.= \"&filter_directory=\" . str_replace(\"=\",\"+\",base64_encode($filter_directory));}\n\tif ($filter_date != \"\") {$GET_PARAMETER\t.= \"&filter_date=\" . $filter_date;}\n\tif ($filter_rating != \"\") {$GET_PARAMETER\t.= \"&filter_rating=$filter_rating\";}\n\tif ($filter_file_type_extension != \"\") {$GET_PARAMETER\t.= \"&filter_file_type_extension=$filter_file_type_extension\";}\n\tif ($filter_camera_model_name != \"\") {$GET_PARAMETER\t.= \"&filter_camera_model_name=$filter_camera_model_name\";}\n\tif ($filter_variable_field != \"\") {$GET_PARAMETER\t.= \"&filter_variable_field=$filter_variable_field\";}\n\tif ($filter_variable_value != \"\") {$GET_PARAMETER\t.= \"&filter_variable_value=\" . str_replace(\"=\",\"+\",base64_encode($filter_variable_value));}\n\n\t# define hidden HIDDEN_INPUTS\n\t$HIDDEN_INPUTS\t=\"<input type=\\\"hidden\\\" name=\\\"filter_medium\\\" value=\\\"\" . $filter_medium . \"\\\">\";\n\t$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"view_mode\\\" value=\\\"\" . $view_mode . \"\\\">\";\n\t$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"order_by\\\" value=\\\"\" . $order_by . \"\\\">\";\n\t$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"order_dir\\\" value=\\\"\" . $order_dir . \"\\\">\";\n\t$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_images_per_page\\\" value=\\\"\" . $filter_images_per_page . \"\\\">\";\n\tif ($filter_directory != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_directory\\\" value=\\\"\" . str_replace(\"=\",\"+\",base64_encode($filter_directory)) . \"\\\">\";}\n\tif ($filter_date != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_date\\\" value=\\\"\" . $filter_date . \"\\\">\";}\n\tif ($filter_rating != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_rating\\\" value=\\\"\" . $filter_rating . \"\\\">\";}\n\tif ($filter_file_type_extension != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_file_type_extension\\\" value=\\\"\" . $filter_file_type_extension . \"\\\">\";}\n\tif ($filter_camera_model_name != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_camera_model_name\\\" value=\\\"\" . $filter_camera_model_name . \"\\\">\";}\n\tif ($filter_variable_field != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_variable_field\\\" value=\\\"\" . $filter_variable_field . \"\\\">\";}\n\tif ($filter_variable_value != \"\") {$HIDDEN_INPUTS\t.=\"<input type=\\\"hidden\\\" name=\\\"filter_variable_value\\\" value=\\\"\" . str_replace(\"=\",\"+\",base64_encode($filter_variable_value)) . \"\\\">\";}\n?>\n\n<html lang=\"<?php echo $config[\"conf_LANGUAGE\"]; ?>\" data-theme=\"<?php echo $theme; ?>\">\n\n<head>\n\t<?php include \"${WORKING_DIR}/sub-standards-header-loader.php\"; ?>\n\t<link rel=\"stylesheet\" href=\"css/mglass.css\">\n\t<script src=\"js/mglass.js\"></script>\n</head>\n\n<body <?php echo $background; ?>>\n\t<?php include \"${WORKING_DIR}/sub-standards-body-loader.php\"; ?>\n\t<?php include \"${WORKING_DIR}/sub-menu.php\"; ?>\n\n\t<h1 class=\"text-center\" style=\"margin-bottom: 1em; letter-spacing: 3px;\"><?php echo L::view_view; ?></h1>\n\n<!-- FILTER -->\n\t<div class=\"card\" style=\"margin-top: 2em\">\n\t\t<details>\n\t\t\t<summary style=\"letter-spacing: 1px; text-transform: uppercase;\"><?php echo L::view_filter_section; ?></summary>\n\t\t\t<form action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST\">\n\t\t\t\t<input type=\"hidden\" name=\"order_by\" value=\"<?php echo $order_by; ?>\">\n\t\t\t\t<input type=\"hidden\" name=\"order_dir\" value=\"<?php echo $order_dir; ?>\">\n\n\t\t\t\t<div style=\"display: flow-root\">\n\t\t\t\t\t<div style=\"float:left;padding: 5px;\">\n\t\t\t\t\t\t<label for=\"filter_medium\"><?php echo L::view_filter_medium; ?></label><br>\n\n\t\t\t\t\t\t\t<select name=\"filter_medium\" id=\"filter_medium\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t<option value=\"target_local\" <?php echo ($filter_medium == \"target_local\"?\" selected\":\"\"); ?>><?php echo L::view_filter_medium_target_local; ?></option>\";\n\t\t\t\t\t\t\t\t<option value=\"source_local\" <?php echo ($filter_medium == \"source_local\"?\" selected\":\"\"); ?>><?php echo L::view_filter_medium_source_local; ?></option>\";\n\t\t\t\t\t\t\t\t<option value=\"internal\" <?php echo ($filter_medium == \"internal\"?\" selected\":\"\"); ?>><?php echo L::view_filter_medium_internal; ?></option>\";\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div style=\"float:right;padding: 5px;\">\n\t\t\t\t\t\t<label for=\"filter_images_per_page\"><?php echo L::view_filter_images_per_page; ?></label><br>\n\t\t\t\t\t\t\t<select name=\"filter_images_per_page\" id=\"filter_images_per_page\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\tforeach ($IMAGES_PER_PAGE_OPTIONS as $IMAGES_PER_PAGE_OPTION) {\n\t\t\t\t\t\t\t\t\techo \"<option value=\\\"$IMAGES_PER_PAGE_OPTION\\\" \" . ($filter_images_per_page == $IMAGES_PER_PAGE_OPTION?\" selected\":\"\") . \">$IMAGES_PER_PAGE_OPTION</option>\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"display: flow-root\">\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:left;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_date\"><?php echo L::view_filter_date; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_date\" id=\"filter_date\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<option value=\"all\" <?php echo ($filter_date == \"\"?\" selected\":\"\"); ?>>-</option>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\twhile ($DATE = $DATES->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $DATE['Create_Day'] . \"\\\" \" . ($filter_date == $DATE['Create_Day']?\" selected\":\"\") . \">\" . $DATE['Create_Day'] . \" (\" . $DATE['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:right;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_rating\"><?php echo L::view_filter_rating; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_rating\" id=\"filter_rating\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"all\\\">\" . L::view_filter_rating_all . \"</option>\";\n\t\t\t\t\t\t\t\t\t\twhile ($RATING = $RATINGS->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $RATING['LbbRating'] . \"\\\" \" . ($filter_rating == $RATING['LbbRating']?\" selected\":\"\") . \">\" . $RATING['LbbRating'] . \" \" . L::view_filter_rating_stars . \" (\" . $RATING['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"display: flow-root\">\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:left;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_file_type\"><?php echo L::view_filter_file_type; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_file_type\" id=\"filter_file_type\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<option value=\"all\" <?php echo ($filter_file_type == \"\"?\" selected\":\"\"); ?>>-</option>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\twhile ($FILE_TYPE = $FILE_TYPES->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $FILE_TYPE['File_Type'] . \"\\\" \" . ($filter_file_type == $FILE_TYPE['File_Type']?\" selected\":\"\") . \">\" . $FILE_TYPE['File_Type'] . \" (\" . $FILE_TYPE['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:left;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_file_type_extension\"><?php echo L::view_filter_file_type_extension; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_file_type_extension\" id=\"filter_file_type_extension\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<option value=\"all\" <?php echo ($filter_file_type_extension == \"\"?\" selected\":\"\"); ?>>-</option>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\twhile ($FILE_TYPE_EXTENSION = $FILE_TYPE_EXTENSIONS->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $FILE_TYPE_EXTENSION['File_Type_Extension'] . \"\\\" \" . ($filter_file_type_extension == $FILE_TYPE_EXTENSION['File_Type_Extension']?\" selected\":\"\") . \">\" . $FILE_TYPE_EXTENSION['File_Type_Extension'] . \" (\" . $FILE_TYPE_EXTENSION['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:right;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_rating\"><?php echo L::view_filter_camera_model_name; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_camera_model_name\" id=\"filter_camera_model_name\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"all\\\">-</option>\";\n\t\t\t\t\t\t\t\t\t\twhile ($CAMERA_MODEL_NAME = $CAMERA_MODEL_NAMES->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $CAMERA_MODEL_NAME['Camera_Model_Name'] . \"\\\" \" . ($filter_camera_model_name == $CAMERA_MODEL_NAME['Camera_Model_Name']?\" selected\":\"\") . \">\" . $CAMERA_MODEL_NAME['Camera_Model_Name'] . \" (\" . $CAMERA_MODEL_NAME['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"display: flow-root\">\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:left;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_directory\"><?php echo L::view_filter_directory; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_directory\" id=\"filter_directory\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<option value=\"\" <?php echo ($filter_directory == \"\"?\" selected\":\"\"); ?>>/</option>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\twhile ($DIRECTORY = $DIRECTORIES->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . str_replace(\"=\",\"+\",base64_encode($DIRECTORY['Directory'])) . \"\\\" \" . ($filter_directory == $DIRECTORY['Directory']?\" selected\":\"\") . \">\" . str_replace($STORAGE_PATH,\"\",$DIRECTORY['Directory']) . \" (\" . $DIRECTORY['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\t\t\t\t</div>\n\n\t\t\t\t<div style=\"display: flow-root\">\n\t\t\t\t\t<?php if ($DATABASE_CONNECTED) { ?>\n\t\t\t\t\t\t<div style=\"float:left;padding: 5px;\">\n\t\t\t\t\t\t\t<label for=\"filter_variable_field\"><?php echo L::view_filter_variable; ?></label><br>\n\t\t\t\t\t\t\t\t<select name=\"filter_variable_field\" id=\"filter_variable_field\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t<option value=\"\" <?php echo ($filter_variable_field == \"\"?\" selected\":\"\"); ?>>-</option>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t$FIELDS_ARRAY=array();\n\t\t\t\t\t\t\t\t\t\twhile ($FIELD = $VAR_FIELDS->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\t$FIELDS_ARRAY[]=$FIELD['name'];\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tasort($FIELDS_ARRAY);\n\t\t\t\t\t\t\t\t\t\tforeach($FIELDS_ARRAY as $FIELD) {\n\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . $FIELD . \"\\\" \" . ($filter_variable_field == $FIELD?\" selected\":\"\") . \">\" . $FIELD . \"</option>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\tif (isset($VAR_VALUES)) {\n\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t<select name=\"filter_variable_value\" id=\"filter_variable_value\" onchange=\"this.form.submit()\">\n\t\t\t\t\t\t\t\t\t\t\t<option value=\"\">-</option>\n\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\t\twhile ($VALUE = $VAR_VALUES->fetchArray(SQLITE3_ASSOC)) {\n\t\t\t\t\t\t\t\t\t\t\t\t\techo \"<option value=\\\"\" . str_replace(\"=\",\"+\",base64_encode($VALUE['var_filter_value'])) . \"\\\" \" . ($filter_variable_value == $VALUE['var_filter_value']?\" selected\":\"\") . \">\" . $VALUE['var_filter_value'] . \"(\" . $VALUE['FILECOUNT'] . \")</option>\";\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<?php } ?>\n\t\t\t\t</div>\n\n\t\t\t</form>\n\t\t</details>\n\t</div>\n\n<!-- IMAGES -->\n\t<?php if ($DATABASE_CONNECTED) { ?>\n\t<form action=\"<?php echo $_SERVER['PHP_SELF'] ?>\" method=\"POST\">\n\n\t\t<?php\n\t\t\techo $HIDDEN_INPUTS;\n\t\t\tnavigator($view_mode,$imagecount,$filter_images_per_page,$select_offset,$filter_rating,$IMAGE_ID_PRE,$IMAGE_ID,$IMAGE_ID_POST,$IMAGE_ID_FIRST,$IMAGE_ID_LAST,$GET_PARAMETER,$order_by,$order_dir,L::view_filter_order_by_filename,L::view_filter_order_by_creationdate,L::view_filter_order_by_id);\n\t\t?>\n\n\t\t<div class=\"card\" style=\"margin-top: 2em;display: inline-block\">\n\n\t\t\t<?php\n\n\t\t\t\tif ($imagecount >= 1) {\n\t\t\t\t\tif ($view_mode == \"grid\") {\n// GRID\n\t\t\t\t\t\t?>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t$i\t= 0;\n\t\t\t\t\t\t$LAST_DATE\t= \"\";\n\t\t\t\t\t\tforeach ($IMAGES_ARRAY as $IMAGE) {\n\n\t\t\t\t\t\t\t$i\t+= 1;\n\t\t\t\t\t\t\t$interpretedDate\t= date_create($IMAGE['Create_Date']);\n\t\t\t\t\t\t\tif ($interpretedDate == false) {\n\t\t\t\t\t\t\t\t$DateExplode\t= explode('_',$IMAGE['Create_Date']);\n\t\t\t\t\t\t\t\t$interpretedDate=date_create($DateExplode[0] . '-' . $DateExplode[1] . '-' . $DateExplode[2] . ' ' . $DateExplode[3] . ':' .  $DateExplode[4] . ':' . $DateExplode[5]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t$IMAGE_DATE\t= date_format($interpretedDate,L::view_date_format);\n\n\t\t\t\t\t\t\t$Directory\t\t\t\t= $STORAGE_PATH . $IMAGE['Directory'];\n\t\t\t\t\t\t\t$IMAGE_ID\t\t\t\t= $IMAGE['ID'];\n\t\t\t\t\t\t\t$IMAGE_FILENAME_TIMS\t= $Directory . '/tims/' . $IMAGE['File_Name'] . '.JPG';\n\t\t\t\t\t\t\t?>\n\n\n\t\t\t\t\t\t\t\t<div style=\"width: <?php echo 100/$constants['const_VIEW_GRID_COLUMNS']-1; ?>%;\" class=\"floating\">\n\t\t\t\t\t\t\t\t\t<div style=\"width: 100%\" title=\"<?php echo $IMAGE['File_Name']; ?>\">\n\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\tif (($order_by == 'Create_Date') and ($LAST_DATE !== $IMAGE_DATE)) {\n\t\t\t\t\t\t\t\t\t\t\t\techo '<b>' . $IMAGE_DATE . '</b>';\n\t\t\t\t\t\t\t\t\t\t\t\t$LAST_DATE\t= $IMAGE_DATE;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . '&view_mode=single&ID=' . ($IMAGE['ID']); ?>\">\n\t\t\t\t\t\t\t\t\t\t\t<img style=\"max-width: 100%; border-radius: 5px;\" class=\"rating<?php echo $IMAGE['LbbRating']; ?>\" src=\"<?php echo urlencode_keep_slashes($IMAGE_FILENAME_TIMS); ?>\">\n\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<div style=\"width: 100%; display: inline-block; padding-left: 2px;padding-right: 2px; padding-top: 2px; padding-bottom: 6px;\">\n\n\t\t\t\t\t\t\t\t\t\t<?php echo rating_radio($IMAGE['ID'],$IMAGE['LbbRating']); ?>\n\n\t\t\t\t\t\t\t\t\t\t<div style=\"float:right;padding: 2px;font-size:0.8em;\" class=\"hidden-mobile\">\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?php echo $GET_PARAMETER . '&view_mode=single&ID=' . $IMAGE_ID; ?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php echo $IMAGE['File_Name']; ?>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telseif ($view_mode == \"single\") {\n// SINGLE\n\t\t\t\t\t\t$IMAGE = $IMAGES_ARRAY[0];\n\t\t\t\t\t\t$Directory\t\t\t\t= $STORAGE_PATH . $IMAGE['Directory'];\n\t\t\t\t\t\t$IMAGE_ID\t\t\t\t= $IMAGE['ID'];\n\t\t\t\t\t\t$IMAGE_FILENAME\t\t\t= $Directory . '/' . $IMAGE['File_Name'];\n\t\t\t\t\t\t$IMAGE_FILENAME_TIMS\t= $Directory . '/tims/' . $IMAGE['File_Name'] . '.JPG';\n\t\t\t\t\t\t$IMAGE_TYPE\t\t\t\t= $IMAGE['File_Type'] !== \"\"?strtolower($IMAGE['File_Type']):strtolower($IMAGE_FILENAME_PARTS['extension']);\n\t\t\t\t\t\t$IMAGE_FILENAME_PARTS\t= pathinfo($IMAGE_FILENAME);\n\t\t\t\t\t\t?>\n\n\t\t\t\t\t\t<div style=\"float:left;width: 100%;padding: 5px;\">\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\tif (strpos(\";\" . $constants['const_FILE_EXTENSIONS_LIST_WEB_IMAGES'] . \";\" . $constants['const_FILE_EXTENSIONS_LIST_HEIC'] . \";\" . $constants['const_FILE_EXTENSIONS_LIST_RAW'] . \";\" . $constants['const_FILE_EXTENSIONS_LIST_TIF'] . \";\",\";\" . strtolower($IMAGE_FILENAME_PARTS['extension']) . \";\") !== false ) {\n// \t\t\t\t\t\t\t\t\t\timage-file\n\n\t\t\t\t\t\t\t\t\tif (strpos(\";\" . $constants['const_FILE_EXTENSIONS_LIST_WEB_IMAGES'] . \";\",\";\" . strtolower($IMAGE_FILENAME_PARTS['extension']) . \";\") !== false ) {\n\t\t\t\t\t\t\t\t\t\t$FILENAME_DISPLAY\t= $IMAGE_FILENAME;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t$FILENAME_DISPLAY\t= $IMAGE_FILENAME_TIMS;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<div style=\"width: 100%;text-align:center;\" title=\"<?php echo $IMAGE['File_Name']; ?>\">\n\n\t\t\t\t\t\t\t\t\t\t<div class=\"img-magnifier-container\">\n\t\t\t\t\t\t\t\t\t\t\t<img id=\"fullsizeimage\" onClick=\"magnify('fullsizeimage', <?php echo $constants['const_VIEW_MAGNIFYING_GLASS_ZOOM']; ?>)\" style=\"max-width: 100%;border-radius: 5px;\" class=\"rating<?php echo $IMAGE['LbbRating']; ?>\" src=\"<?php echo urlencode_keep_slashes($FILENAME_DISPLAY); ?>\">\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\tif (strpos(\";\" . $constants['const_FILE_EXTENSIONS_LIST_RAW'] . \";\" . $constants['const_FILE_EXTENSIONS_LIST_TIF'] . \";\",\";\" . strtolower($IMAGE_FILENAME_PARTS['extension']) . \";\") !== false ) {\n// \t\t\t\t\t\t\t\t\t\t\tRAW-image or TIF image\n\t\t\t\t\t\t\t\t\t\t\techo \"<div style=\\\"width: 100%\\\">\";\n\t\t\t\t\t\t\t\t\t\t\t\techo \"<p style=\\\"text-align: center;font-weight: bold;\\\">\" . L::view_images_preview_low_resolution_image . \"</p>\";\n\t\t\t\t\t\t\t\t\t\t\techo \"</div>\";\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\n\t\t\t\t\t\t\t\t\t<div style=\"width=100%;padding: 30px;font-size:0.8em;\">\n\t\t\t\t\t\t\t\t\t\t<div style=\"float:left;width: 33%;text-align: left;padding: 0;padding-top: 0.5em;\">\n\t\t\t\t\t\t\t\t\t\t\t<?php echo rating_radio($IMAGE['ID'],$IMAGE['LbbRating']); ?>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div style=\"float:left;width: 34%;text-align: center;padding: 0;\">\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?php echo urlencode_keep_slashes($IMAGE_FILENAME); ?>\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php echo L::view_images_download; ?>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div style=\"float:left;width: 33%;text-align: right;padding: 0;\">\n\t\t\t\t\t\t\t\t\t\t\t<?php echo L::view_images_magnifying_glass; ?>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t} elseif (strpos(\";\" . $constants['const_FILE_EXTENSIONS_LIST_VIDEO'] . \";\",\";\" . strtolower($IMAGE_FILENAME_PARTS['extension']) . \";\") !== false ) {\n// \t\t\t\t\t\t\t\t\t\tvideo-file\n\t\t\t\t\t\t\t\t\t$IMAGE_FILENAME_PREVIEW\t= $IMAGE_FILENAME;\n\t\t\t\t\t\t\t\t\t$LOW_RES\t= false;\n\t\t\t\t\t\t\t\t\tif (isset($IMAGE['Compressor_Name']) and (strpos($IMAGE['Compressor_Name'],\"GoPro H.265 encoder\") !== false)) {\n\t\t\t\t\t\t\t\t\t\t#GoPro: GoPro H.265 encoder not supported by most browsers\n\t\t\t\t\t\t\t\t\t\t$IMAGE_FILENAME_PREVIEW_CANDIDATE\t= $IMAGE_FILENAME_PARTS['dirname'] . DIRECTORY_SEPARATOR . substr_replace($IMAGE_FILENAME_PARTS['filename'],'L',1,1) . \".LRV\";\n\t\t\t\t\t\t\t\t\t\tif (file_exists($IMAGE_FILENAME_PREVIEW_CANDIDATE)) {\n\t\t\t\t\t\t\t\t\t\t\t$IMAGE_FILENAME_PREVIEW\t= $IMAGE_FILENAME_PREVIEW_CANDIDATE;\n\t\t\t\t\t\t\t\t\t\t\t$LOW_RES\t= true;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t<div style=\"width: 100%;text-align:center;\" title=\"<?php echo $IMAGE['File_Name']; ?>\">\n\t\t\t\t\t\t\t\t\t\t\t<video width=\"100%\" class=\"rating<?php echo $IMAGE['LbbRating']; ?>\" controls autoplay>\n\t\t\t\t\t\t\t\t\t\t\t\t<source src=\"<?php echo urlencode_keep_slashes($IMAGE_FILENAME_PREVIEW); ?>\" type=\"video/<?php echo $IMAGE_TYPE; ?>\"></source>\n\t\t\t\t\t\t\t\t\t\t\t</video>\n\n\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\tif ($LOW_RES) {\n\t// \t\t\t\t\t\t\t\t\t\t\tRAW-image\n\t\t\t\t\t\t\t\t\t\t\t\techo \"<p style=\\\"text-align: center;font-weight: bold;\\\">\" . L::view_images_preview_low_resolution_video . \"</p>\";\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div padding: 5px;font-size:0.8em;\">\n\t\t\t\t\t\t\t\t\t\t\t<?php echo rating_radio($IMAGE['ID'],$IMAGE['LbbRating']); ?>\n\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?php echo urlencode_keep_slashes($IMAGE_FILENAME); ?>\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php echo L::view_images_download; ?>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t} elseif (strpos(\";\" . $constants['const_FILE_EXTENSIONS_LIST_AUDIO'] . \";\",\";\" . strtolower($IMAGE_FILENAME_PARTS['extension']) . \";\") !== false ) {\n// \t\t\t\t\t\t\t\t\t\taudio-file\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t<div style=\"width: 100%;text-align:center;\" title=\"<?php echo $IMAGE['File_Name']; ?>\">\n\t\t\t\t\t\t\t\t\t\t\t<audio width=\"100%\" class=\"rating<?php echo $IMAGE['LbbRating']; ?>\" controls autoplay>\n\t\t\t\t\t\t\t\t\t\t\t\t<source src=\"<?php echo urlencode_keep_slashes($IMAGE_FILENAME); ?>\" type=\"audio/<?php echo $IMAGE_FILENAME_PARTS['extension']; ?>\">\">\n\t\t\t\t\t\t\t\t\t\t\t</audio>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t<div padding: 5px;font-size:0.8em;\">\n\t\t\t\t\t\t\t\t\t\t\t<?php echo rating_radio($IMAGE['ID'],$IMAGE['LbbRating']); ?>\n\n\t\t\t\t\t\t\t\t\t\t\t<a href=\"<?php echo urlencode_keep_slashes($IMAGE_FILENAME); ?>\" target=\"_blank\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php echo L::view_images_download; ?>\n\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div style=\"float:left;width: 100%;padding: 5px;\">\n\t\t\t\t\t\t\t<table style=\"table-layout: fixed;max-width: 100%;\">\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\tforeach ($IMAGE as $FIELD => $VALUE) {\n\t\t\t\t\t\t\t\t\tif (($VALUE != \"\") and (! in_array($FIELD,$FIELDS_BLOCKED_ARRAY))) {\n\t\t\t\t\t\t\t\t\t\t$FIELD\t= str_replace('_',' ',$FIELD);\n\t\t\t\t\t\t\t\t\t\techo \"<tr><td style='word-break: break-all;width: 40%;vertical-align: top;'><u>$FIELD:</u></td><td style='word-break: break-all;width: 60%;vertical-align: top;'><b>$VALUE</b></td></tr>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<?php\n\n\t\t\t\t\t}\n\t\t\t\t} else {\n// \t\t\t\t\timagecount=0\n\t\t\t\t\t?>\n\t\t\t\t\t\t<?php echo L::view_images_empty; ?>\n\t\t\t\t\t<?php\n\t\t\t\t}\n\t\t\t?>\n\n\t\t</div>\n\n\t\t<?php navigator($view_mode,$imagecount,$filter_images_per_page,$select_offset,$filter_rating,$IMAGE_ID_PRE,$IMAGE_ID,$IMAGE_ID_POST,$IMAGE_ID_FIRST,$IMAGE_ID_LAST,$GET_PARAMETER,$order_by,$order_dir,L::view_filter_order_by_filename,L::view_filter_order_by_creationdate,L::view_filter_order_by_id); ?>\n\n\t</form>\n\n\t<?php } else { ?>\n\t\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t\t<?php echo L::view_filter_no_medium; ?>\n\t\t</div>\n\t<?php } ?>\n\n\t<div class=\"card\" style=\"margin-top: 2em;\">\n\t\t<?php echo L::view_footer_footer; ?>\n\t</div>\n\n\t<?php\n\t\tinclude \"sub-footer.php\";\n\t?>\n\n</body>\n\n</html>\n"], "filenames": ["scripts/config.php", "scripts/view.php"], "buggy_code_start_loc": [118, 11], "buggy_code_end_loc": [123, 214], "fixing_code_start_loc": [117, 12], "fixing_code_end_loc": [125, 213], "type": "NVD-CWE-noinfo", "message": "outdoorbits little-backup-box (aka Little Backup Box) before f39f91c allows remote attackers to execute arbitrary code because the PHP extract function is used for untrusted input.", "other": {"cve": {"id": "CVE-2023-52262", "sourceIdentifier": "cve@mitre.org", "published": "2023-12-30T19:15:08.197", "lastModified": "2024-01-09T21:20:26.513", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "outdoorbits little-backup-box (aka Little Backup Box) before f39f91c allows remote attackers to execute arbitrary code because the PHP extract function is used for untrusted input."}, {"lang": "es", "value": "outdoorbits little-backup-box (taka Little Backup Box) anterior a f39f91c permite a atacantes remotos ejecutar c\u00f3digo arbitrario porque la funci\u00f3n de extracci\u00f3n de PHP se utiliza para entradas que no son de confianza."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:outdoorbits:little_backup_box:*:*:*:*:*:*:*:*", "versionEndExcluding": "2023-10-03", "matchCriteriaId": "61306599-9B02-48D7-B115-65C4B34E4D03"}]}]}], "references": [{"url": "https://github.com/outdoorbits/little-backup-box/commit/f39f91cd05544b3eb18b59897c765d6ba9313faa", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://www.php.net/manual/en/function.extract", "source": "cve@mitre.org", "tags": ["Product"]}]}, "github_commit_url": "https://github.com/outdoorbits/little-backup-box/commit/f39f91cd05544b3eb18b59897c765d6ba9313faa"}}