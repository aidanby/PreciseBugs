{"buggy_code": ["### [1.10.22] 2021-04-27\n\n  * Security: Fixed command injection vulnerability in HgDriver/HgDownloader and hardened other VCS drivers and downloaders (GHSA-h5h8-pc6h-jvvx / CVE-2021-29472)\n\n### [1.10.21] 2021-04-01\n\n  * Fixed support for new GitHub OAuth token format\n  * Fixed processes silently ignoring the CWD when it does not exist\n\n### [1.10.20] 2021-01-27\n\n  * Fixed exclude-from-classmap causing regex issues when having too many paths\n  * Fixed compatibility issue with Symfony 4/5\n\n### [1.10.19] 2020-12-04\n\n  * Fixed regression on PHP 8.0\n\n### [1.10.18] 2020-12-03\n\n  * Allow installation on PHP 8.0\n\n### [1.10.17] 2020-10-30\n\n  * Fixed Bitbucket API authentication issue\n  * Fixed parsing of Composer 2 lock files breaking in some rare conditions\n\n### [1.10.16] 2020-10-24\n\n  * Added warning to `validate` command for cases where packages provide/replace a package that they also require\n  * Fixed JSON schema validation issue with PHPStorm\n  * Fixed symlink handling in `archive` command\n\n### [1.10.15] 2020-10-13\n\n  * Fixed path repo version guessing issue\n\n### [1.10.14] 2020-10-13\n\n  * Fixed version guesser to look at remote branches as well as local ones\n  * Fixed path repositories version guessing to handle edge cases where version is different from the VCS-guessed version\n  * Fixed COMPOSER env var causing issues when combined with the `global ` command\n  * Fixed a few issues dealing with PHP without openssl extension (not recommended at all but sometimes needed for testing)\n\n### [1.10.13] 2020-09-09\n\n  * Fixed regressions with old version validation\n  * Fixed invalid root aliases not being reported\n\n### [1.10.12] 2020-09-08\n\n  * Fixed regressions with old version validation\n\n### [1.10.11] 2020-09-08\n\n  * Fixed more PHP 8 compatibility issues\n  * Fixed regression in handling of CTRL-C when xdebug is loaded\n  * Fixed `status` handling of broken symlinks\n\n### [1.10.10] 2020-08-03\n\n  * Fixed `create-project` not triggering events while installing the root package\n  * Fixed PHP 8 compatibility issue\n  * Fixed `self-update` to avoid automatically upgrading to the next major version once it becomes stable\n\n### [1.10.9] 2020-07-16\n\n  * Fixed Bitbucket redirect loop when credentials are outdated\n  * Fixed GitLab auth prompt wording\n  * Fixed `self-update` handling of files requiring admin permissions to write to on Windows (it now does a UAC prompt)\n  * Fixed parsing issues in funding.yml files\n\n### [1.10.8] 2020-06-24\n\n  * Fixed compatibility issue with git being configured to show signatures by default\n  * Fixed discarding of local changes when updating packages to include untracked files\n  * Several minor fixes\n\n### [1.10.7] 2020-06-03\n\n  * Fixed PHP 8 deprecations\n  * Fixed detection of pcntl_signal being in disabled_functions when pcntl_async_signal is allowed\n\n### [1.10.6] 2020-05-06\n\n  * Fixed version guessing to take composer-runtime-api and composer-plugin-api requirements into account to avoid selecting packages which require Composer 2\n  * Fixed package name validation to allow several dashes following each other\n  * Fixed post-status-cmd script not firing when there were no changes to be displayed\n  * Fixed composer-runtime-api support on Composer 1.x, the package is now present as 1.0.0\n  * Fixed support for composer show --name-only --self\n  * Fixed detection of GitLab URLs when handling authentication in some cases\n\n### [1.10.5] 2020-04-10\n\n  * Fixed self-update on PHP <5.6, seriously please upgrade people, it's time\n  * Fixed 1.10.2 regression with PATH resolution in scripts\n\n### [1.10.4] 2020-04-09\n\n  * Fixed 1.10.2 regression in path symlinking with absolute path repos\n\n### [1.10.3] 2020-04-09\n\n  * Fixed invalid --2 flag warning in `self-update` when no channel is requested\n\n### [1.10.2] 2020-04-09\n\n  * Added --1 flag to `self-update` command which can be added to automated self-update runs to make sure it won't automatically jump to 2.0 once that is released\n  * Fixed path repository symlinks being made relative when the repo url is defined as absolute paths\n  * Fixed potential issues when using \"composer ...\" in scripts and composer/composer was also required in the project\n  * Fixed 1.10.0 regression when downloading GitHub archives from non-API URLs\n  * Fixed handling of malformed info in fund command\n  * Fixed Symfony5 compatibility issues in a few commands\n\n### [1.10.1] 2020-03-13\n\n  * Fixed path repository warning on empty path when using wildcards\n  * Fixed superfluous warnings when generating optimized autoloaders\n\n### [1.10.0] 2020-03-10\n\n  * Added `bearer` auth config to authenticate using `Authorization: Bearer <token>` headers\n  * Added `plugin-api-version` in composer.lock so third-party tools can know which Composer version was used to generate a lock file\n  * Fixed composer fund command and funding info parsing to be more useful\n  * Fixed issue where --no-dev autoload generation was excluding some packages which should not have been excluded\n  * Fixed 1.10-RC regression in create project's handling of absolute paths\n\n### [1.10.0-RC] 2020-02-14\n\n  * Breaking: `composer global exec ...` now executes the process in the current working directory instead of executing it in the global directory.\n  * Warning: Added a warning when class names are being loaded by a PSR-4 or PSR-0 rule only due to classmap optimization, but would not otherwise be autoloadable. Composer 2.0 will stop autoloading these classes so make sure you fix your autoload configs.\n  * Added new funding key to composer.json to describe ways your package's maintenance can be funded. This reads info from GitHub's FUNDING.yml by default so better configure it there so it shows on GitHub and Composer/Packagist\n  * Added `composer fund` command to show funding info of your dependencies\n  * Added support for --format=json output for show command when showing a single package\n  * Added support for configuring suggestions using config command, e.g. `composer config suggest.foo/bar some text`\n  * Added support for configuring fine-grained preferred-install using config command, e.g. `composer config preferred-install.foo/* dist`\n  * Added `@putenv` script handler to set environment variables from composer.json for following scripts\n  * Added `lock` option that can be set to false, in which case no composer.lock file will be generated\n  * Added --add-repository flag to create-project command which will persist the repo given in --repository into the composer.json of the package being installed\n  * Added support for IPv6 addresses in NO_PROXY\n  * Added package homepage display in the show command\n  * Added debug info about HTTP authentications\n  * Added Symfony 5 compatibility\n  * Added --fixed flag to require command to make it use a fixed constraint instead of a ^x.y constraint when adding the requirement\n  * Fixed exclude-from-classmap matching subsets of directories e.g. foo/ was excluding foobar/\n  * Fixed archive command to persist file permissions inside the zip files\n  * Fixed init/require command to avoid suggesting packages which are already selected in the search results\n  * Fixed create-project UX issues\n  * Fixed filemtime for vendor/composer/* files is now only changing when the files actually change\n  * Fixed issues detecting docker environment with an active open_basedir\n\n### [1.9.3] 2020-02-04\n\n  * Fixed GitHub deprecation of access_token query parameter, now using Authorization header\n\n### [1.9.2] 2020-01-14\n\n  * Fixed minor git driver bugs\n  * Fixed schema validation for version field to allow dev-* versions too\n  * Fixed external processes' output being formatted even though it should not\n  * Fixed issue with path repositories when trying to install feature branches\n\n### [1.9.1] 2019-11-01\n\n  * Fixed various credential handling issues with gitlab and github\n  * Fixed credentials being present in git remotes in Composer cache and vendor directory when not using SSH keys\n  * Fixed `composer why` not listing replacers as a reason something is present\n  * Fixed various PHP 7.4 compatibility issues\n  * Fixed root warnings always present in Docker containers, setting COMPOSER_ALLOW_SUPERUSER is not necessary anymore\n  * Fixed GitHub access tokens leaking into debug-verbosity output\n  * Fixed several edge case issues detecting GitHub, Bitbucket and GitLab repository types\n  * Fixed Composer asking if you want to use a composer.json in a parent directory when ran in non-interactive mode\n  * Fixed classmap autoloading issue finding classes located within a few non-PHP context blocks (?>...<?php)\n\n### [1.9.0] 2019-08-02\n\n  * Breaking: artifact repositories with URLs containing port numbers and requiring authentication now require you to configure http-basic auth for the `host:port` pair explicitly\n  * Added a `--no-cache` flag available on all commands to run with the cache disabled\n  * Added PHP_BINARY as env var pointing to the PHP process when executing Composer scripts as shell scripts\n  * Added a `use-github-api` config option which can set the `no-api` flag on all GitHub VCS repositories declared\n  * Added a static helper you can preprend to a script to avoid process timeouts, `\"Composer\\\\Config::disableProcessTimeout\"`\n  * Added Event::getOriginatingEvent to retrieve an event's original event when a script handler forwards to another one\n  * Added support for autoloading directly from a phar file\n  * Fixed loading order of plugins to always initialize them in order of dependencies\n  * Fixed various network-mount related issues\n  * Fixed --ignore-platform-reqs not ignoring conflict rules against platform packages\n\n### [1.8.6] 2019-06-11\n\n  * Fixed handling of backslash-escapes handling in composer.json when using the require command\n  * Fixed create-project not following classmap-authoritative and apcu-autoloader config values\n  * Fixed HHVM version warning showing up in some cases when it was not in use\n\n### [1.8.5] 2019-04-09\n\n  * HHVM 4.0 is no longer compatible with Composer. Please use PHP instead going forward.\n  * Added forward compatibility with upcoming 2.0 changes\n  * Fixed support for PHP 7.3-style heredoc/nowdoc syntax changes in autoload generation\n  * Fixed require command usage when combined with --ignore-platform-reqs\n  * Fixed and cleaned up various Windows junctions handling issues\n\n### [1.8.4] 2019-02-11\n\n  * Fixed long standing solver bug leading to odd solving issues in edge cases, see #7946\n  * Fixed HHVM support for upcoming releases\n  * Fixed unix proxy for binaries to be POSIX compatible instead of breaking some shells\n  * Fixed invalid deprecation warning for composer-plugin-api\n  * Fixed edge case issues with Windows junctions when working with path repositories\n\n### [1.8.3] 2019-01-30\n\n  * Fixed regression when executing partial updates\n\n### [1.8.2] 2019-01-29\n\n  * Fixed invalid deprecation warning for ext-pdo_mysql and similar\n  * Updated to latest xdebug-handler\n\n### [1.8.1] 2019-01-29\n\n  * Deprecated support for non-standard package names (anything with uppercase, or no / in it). Make sure to follow the warnings if you see any to avoid problems in 2.0.\n  * Fixed some packages missing from the autoloader config when installing with --no-dev\n  * Fixed support for cloning GitLab repos using OAuth tokens instead of SSH keys\n  * Fixed metapackage installs/updates missing from output\n  * Fixed --with-dependencies / --with-all-dependencies not updating some packages in some edge cases\n  * Fixed compatibility with Symfony 4.2 deprecations\n  * Fixed temp dir not being cleaned up on download error while archiving packages\n  * Updated to latest ca-bundle\n\n### [1.8.0] 2018-12-03\n\n  * Changed `post-package-install` / `post-package-update` event to be fired *after* the lock file has been updated as opposed to before\n  * Added support for removing packages using a wildcard with the `remove` command, e.g. `composer remove foo/*`\n  * Added `chat` to the list of `support` channels you can list in composer.json\n  * Added signal handling on require command to restore the composer.json in case of abort\n  * Added `--ignore` to `outdated` command to pass one or more packages that you do not want to be listed\n  * Added `--no-dev` to `check-platform-reqs` command to skip dev requirements even if they are installed\n  * Added support for running plugin commands from sub-directories within a project much like other Composer commands\n  * Added support for running Composer via phpdbg\n  * Added `lib-imagick` platform package\n  * Fixed validate command always checking for disabled checks when used with `--strict`\n\n### [1.7.3] 2018-11-01\n\n  * Fixed handling of replace/conflict rules. This may affect dependency resolution in some edge cases.\n  * Fixed Bitbucket API support and migrated all calls to API v2 as v1 is deprecated\n  * Fixed support for lib-openssl 1.1.1 having only lowercase algorithm names\n  * Fixed escaping of URLs in Perforce and Svn drivers\n  * Fixed `show` command not respecting `--path` when a single package name was given\n  * Fixed regression in 1.7.2's handling of metapackages\n\n### [1.7.2] 2018-08-16\n\n  * Fixed reporting of authentication/rate limiting issues for GitHub API access\n  * Fixed `create-project` not checking the checking the latest commit out when a cache was already present\n  * Fixed reporting of errors when `global` command can not switch the working directory\n  * Fixed PHP 5.3 JSON encoding issues with complex unicode character sequences\n  * Updated to latest ca-bundle and xdebug-handler projects, see related changelogs\n\n### [1.7.1] 2018-08-07\n\n  * Fixed issue autoloading plugins in require-dev in some conditions\n  * Fixed handling of SSL to repo.packagist.org on very old PHP versions\n\n### [1.7.0] 2018-08-03\n\n  * Added the overridden platform config's PHP version in the `diagnose` command output\n  * Fixed --no-plugins not being respected in a few commands\n  * Fixed 1.7.0-RC regression in output showing <warn> instead of proper colors\n  * Fixed 1.7.0-RC regression in output missing \"Loading from cache\" output on package install\n\n### [1.7.0-RC] 2018-07-24\n\n  * Changed default repository URL from packagist.org to repo.packagist.org, this might affect people with strict firewall rules\n  * Changed output from Updating to Downgrading when performing package downgrades, this might affect anything parsing output\n  * Several minor performance improvements\n  * Added basic authentication support for mercurial repos\n  * Added explicit `i` and `u` aliases for the `install` and `update` commands\n  * Added support for `show` command to output json format with --tree\n  * Added support for {glob,braces} support in the path repository's path argument\n  * Added support in `status` command for showing diffs in vendor dir even for packages installed as dist/zip archives\n  * Added `--remove-vcs` flag to `create-project` command to avoid prompting for keeping VCS files\n  * Added `--no-secure-http` flag to `create-project` command to bypass https (use at your own risk)\n  * Added `pre-command-run` event that lets plugins modify arguments\n  * Added RemoteFilesystem::getRemoteContents extension point\n  * Fixed setting scripts via `config` command\n\n### [1.6.5] 2018-05-04\n\n  * Fixed regression in 1.6.4 causing strange update behaviors with dev packages\n  * Fixed regression in 1.6.4 color support detection for Windows\n  * Fixed issues dealing with broken symlinks when switching branches and using path repositories\n  * Fixed JSON schema for package repositories\n  * Fixed issues on computers set to Turkish locale\n  * Fixed classmap parsing of files using short-open-tags when they are disabled in php\n\n### [1.6.4] 2018-04-13\n\n  * Security fixes in some edge case scenarios, recommended update for all users\n  * Fixed regression in version guessing of path repositories\n  * Fixed removing aliased packages from the repository, which might resolve some odd update bugs\n  * Fixed updating of package URLs for GitLab\n  * Fixed run-script --list failing when script handlers were defined\n  * Fixed init command not respecting the current php version when selecting package versions\n  * Fixed handling of uppercase package names in why/why-not commands\n  * Fixed exclude-from-classmap symlink handling\n  * Fixed filesystem permissions of PEAR binaries\n  * Improved performance of subversion repos\n  * Other minor fixes\n\n### [1.6.3] 2018-01-31\n\n  * Fixed GitLab downloads failing in some edge cases\n  * Fixed ctrl-C handling during create-project\n  * Fixed GitHub VCS repositories not prompting for a token in some conditions\n  * Fixed SPDX license identifiers being case sensitive\n  * Fixed and clarified a few dependency resolution error reporting strings\n  * Fixed SVN commit log fetching in verbose mode when using private repositories\n\n### [1.6.2] 2018-01-05\n\n  * Fixed more autoloader regressions\n  * Fixed support for updating dist refs in gitlab URLs\n\n### [1.6.1] 2018-01-04\n\n  * Fixed upgrade regression due to some autoloader cleanups\n  * Fixed some overly loose version constraints\n\n### [1.6.0] 2018-01-04\n\n  * Added support for SPDX license identifiers v3.0, deprecates GPL/LGPL/AGPL identifiers, which should now have a `-only` or `-or-later` suffix added.\n  * Added support for COMPOSER_MEMORY_LIMIT env var to make Composer set the PHP memory limit explicitly\n  * Added support for simple strings for the `bin`\n  * Fixed `check-platform-reqs` bug in version checking\n\n### [1.6.0-RC] 2017-12-19\n\n  * Improved performance of installs and updates from git clones when checking out known commits\n  * Added `check-platform-reqs` command that checks that your PHP and extensions versions match the platform requirements of the installed packages\n  * Added `--with-all-dependencies` to the `update` and `require` commands which updates all dependencies of the listed packages, including those that are direct root requirements\n  * Added `scripts-descriptions` key to composer.json to customize the description and document your custom commands\n  * Added support for the uppercase NO_PROXY env var\n  * Added support for COMPOSER_DEFAULT_{AUTHOR,LICENSE,EMAIL,VENDOR} env vars to pre-populate init command values\n  * Added support for local fossil repositories\n  * Added suggestions for alternative spellings when entering packages in `init` and `require` commands and nothing can be found\n  * Fixed installed.json data to be sorted alphabetically by package name\n  * Fixed compatibility with Symfony 4.x components that Composer uses\n\n### [1.5.6] - 2017-12-18\n\n  * Fixed root package version guessed when a tag is checked out\n  * Fixed support for GitLab repos hosted on non-standard ports\n  * Fixed regression in require command when requiring unstable packages, part 3\n\n### [1.5.5] - 2017-12-01\n\n  * Fixed regression in require command when requiring unstable packages, part 2\n\n### [1.5.4] - 2017-12-01\n\n  * Fixed regression in require command when requiring unstable packages\n\n### [1.5.3] - 2017-11-30\n\n  * Fixed require/remove commands reverting the composer.json change when a non-solver-related error occurs\n  * Fixed GitLabDriver to support installations of GitLab not at the root of the domain\n  * Fixed create-project not following the optimize-autoloader flag of the root package\n  * Fixed Authorization header being forwarded across domains after a redirect\n  * Improved some error messages for clarity\n\n### [1.5.2] - 2017-09-11\n\n  * Fixed GitLabDriver looping endlessly in some conditions\n  * Fixed GitLabDriver support for unauthenticated requests\n  * Fixed GitLab zip downloads not triggering credentials prompt if unauthenticated\n  * Fixed path repository support of COMPOSER_ROOT_VERSION, it now applies to all path repos within the same git repository\n  * Fixed path repository handling of copies to avoid copying VCS files and others\n  * Fixed sub-directory call to ignore list and create-project commands as well as calls to Composer using --working-dir\n  * Fixed invalid warning appearing when calling `remove` on an non-stable package\n\n### [1.5.1] - 2017-08-09\n\n  * Fixed regression in GitLabDriver with repos containing >100 branches or tags\n  * Fixed sub-directory call support to respect the COMPOSER env var\n\n### [1.5.0] - 2017-08-08\n\n  * Changed the package install order to ensure that plugins are always installed as soon as possible\n  * Added ability to call composer from within sub-directories of a project\n  * Added support for GitLab API v4\n  * Added support for GitLab sub-groups\n  * Added some more rules to composer validate\n  * Added support for reading the `USER` env when guessing the username in `composer init`\n  * Added warning when uncompressing files with the same name but difference cases on case insensitive filesystems\n  * Added `htaccess-protect` option / `COMPOSER_HTACCESS_PROTECT` env var to disable the .htaccess creation in home dir (defaults to true)\n  * Improved `clear-cache` command\n  * Minor improvements/fixes and many documentation updates\n\n### [1.4.3] - 2017-08-06\n\n  * Fixed GitLab URLs\n  * Fixed root package version detection using latest git versions\n  * Fixed inconsistencies in date format in composer.lock when installing from source\n  * Fixed Mercurial support regression\n  * Fixed exclude-from-classmap not being applied when autoloading files for Composer plugins\n  * Fixed exclude-from-classmap being ignored when cwd has the wrong case on case insensitive filesystems\n  * Fixed several other minor issues\n\n### [1.4.2] - 2017-05-17\n\n  * Fixed Bitbucket API handler parsing old deleted branches in hg repos\n  * Fixed regression in gitlab downloads\n  * Fixed output inconsistencies\n  * Fixed unicode handling in `init` command for author names\n  * Fixed useless warning when doing partial updates/removes on packages that are not currently installed\n  * Fixed Xdebug disabling issue when combined with disable_functions and allow_url_fopen CLI overrides\n\n### [1.4.1] - 2017-03-10\n\n  * Fixed `apcu-autoloader` config option being ignored in `dump-autoload` command\n  * Fixed json validation not allowing boolean for trunk-path, branches-path and tags-path in svn repos\n  * Fixed json validation not allowing repository URLs without scheme\n\n### [1.4.0] - 2017-03-08\n\n  * Improved memory usage of dependency solver\n  * Added `--format json` option to the `outdated` and `show` command to get machine readable package listings\n  * Added `--ignore-filters` flag to `archive` command to bypass the .gitignore and co\n  * Added support for `outdated` output without ansi colors\n  * Added support for Bitbucket API v2\n  * Changed the require command to follow minimum-stability / prefer-stable values when picking a version\n  * Fixed regression when using composer in a Mercurial repository\n\n### [1.3.3] - 2017-03-08\n\n  * **Capifony users beware**: This release has output format tweaks that mess up capifony interactive mode, see #6233\n  * Improved baseline psr-4 autoloader performance for projects with many nested namespaces configured\n  * Fixed issues with gitlab API access when the token had insufficient permissions\n  * Fixed some HHVM strict type issues\n  * Fixed version guessing of headless git checkouts in some conditions\n  * Fixed compatibility with subversion 1.8\n  * Fixed version guessing not working with svn/hg\n  * Fixed script/exec errors not being output correctly\n  * Fixed PEAR repository bug with pear.php.net\n\n### [1.3.2] - 2017-01-27\n\n  * Added `COMPOSER_BINARY` env var that is defined within the scope of a Composer run automatically with the path to the phar file\n  * Fixed create-project ending in a detached HEAD when installing aliased packages\n  * Fixed composer show not returning non-zero exit code when the package does not exist\n  * Fixed `@composer` handling in scripts when --working-dir is used together with it\n  * Fixed private-GitLab handling of repos with dashes in them\n\n### [1.3.1] - 2017-01-07\n\n  * Fixed dist downloads from Bitbucket\n  * Fixed some regressions related to xdebug disabling\n  * Fixed `--minor-only` flag in `outdated` command\n  * Fixed handling of config.platform.php which did not replace other php-* package's versions\n\n### [1.3.0] - 2016-12-24\n\n  * Fixed handling of annotated git tags vs lightweight tags leading to useless updates sometimes\n  * Fixed ext-xdebug not being require-able anymore due to automatic xdebug disabling\n  * Fixed case insensitivity of remove command\n\n### [1.3.0-RC] - 2016-12-11\n\n  * Added workaround for xdebug performance impact by restarting PHP without xdebug automatically in case it is enabled\n  * Added `--minor-only` to the `outdated` command to only show updates to minor versions and ignore new major versions\n  * Added `--apcu-autoloader` to the `update`/`install` commands and `--apcu` to `dump-autoload` to enable an APCu-caching autoloader, which can be more efficient than --classmap-authoritative if you attempt to autoload many classes that do not exist, or if you can not use authoritative classmaps for some reason\n  * Added summary of operations to be executed before they run, and made execution output more compact\n  * Added `php-debug` and `php-zts` virtual platform packages\n  * Added `gitlab-token` auth config for GitLab private tokens\n  * Added `--strict` to the `outdated` command to return a non-zero exit code when there are outdated packages\n  * Added ability to call php scripts using the current php interpreter (instead of finding php in PATH by default) in script handlers via `@php ...`\n  * Added `COMPOSER_ALLOW_XDEBUG` env var to circumvent the Xdebug-disabling behavior\n  * Added `COMPOSER_MIRROR_PATH_REPOS` env var to force mirroring of path repositories vs symlinking\n  * Added `COMPOSER_DEV_MODE` env var that is set by Composer to forward the dev mode to script handlers\n  * Fixed support for git 2.11\n  * Fixed output from zip and rar leaking out when an error occurred\n  * Removed `hash` from composer.lock, only `content-hash` is now used which should reduce conflicts\n  * Minor fixes and performance improvements\n\n### [1.2.4] - 2016-12-06\n\n  * Fixed regression in output handling of scripts from 1.2.3\n  * Fixed support for LibreSSL detection as lib-openssl\n  * Fixed issue with Zend Guard in the autoloader bootstrapping\n  * Fixed support for loading partial provider repositories\n\n### [1.2.3] - 2016-12-01\n\n  * Fixed bug in HgDriver failing to identify BitBucket repositories\n  * Fixed support for loading partial provider repositories\n\n### [1.2.2] - 2016-11-03\n\n  * Fixed selection of packages based on stability to be independent from package repository order\n  * Fixed POST_DEPENDENCIES_SOLVING not containing some operations in edge cases\n  * Fixed issue handling GitLab URLs containing dots and other special characters\n  * Fixed issue on Windows when running composer at the root of a drive\n  * Minor fixes\n\n### [1.2.1] - 2016-09-12\n\n  * Fixed edge case issues with the static autoloader\n  * Minor fixes\n\n### [1.2.0] - 2016-07-19\n\n  * Security: Fixed [httpoxy](https://httpoxy.org/) vulnerability\n  * Fixed `home` command to avoid rogue output on unix\n  * Fixed output of git clones to clearly state when clones are from cache\n  * (from 1.2 RC) Fixed ext-network-ipv6 to be php-ipv6\n\n### [1.2.0-RC] - 2016-07-04\n\n  * Added caching of git repositories if you have git 2.3+ installed. Repositories will now be cached once and then cloned from local cache so subsequent installs should be faster\n  * Added detection of HEAD changes to the `status` command. If you `git checkout X` in a vendor directory for example it will tell you that it is not at the version that was installed\n  * Added a virtual `php-ipv6` extension to require PHP compiled with IPv6 support\n  * Added `--no-suggest` to `install` and `update` commands to skip output of suggestions at the end\n  * Added `--type` to the `search` command to restrict to a given package type\n  * Added fossil support as alternative to git/svn/.. for package downloads\n  * Improved BitBucket OAuth support\n  * Added support for blocking cache operations using COMPOSER_CACHE_DIR=/dev/null (or NUL on windows)\n  * Added support for using declare(strict_types=1) in plugins\n  * Added `--prefer-stable` and `--prefer-lowest` to the `require` command\n  * Added `--no-scripts` to the `require` and `remove` commands\n  * Added `_comment` top level key to the schema to endorse using it as a place to store comments (it can be a string or array of strings)\n  * Added support for justinrainbow/json-schema 2.0\n  * Fixed binaries not being re-installed if deleted by users or the bin-dir changes. `update` and `install` will now re-install them\n  * Many minor UX and docs improvements\n\n### [1.1.3] - 2016-06-26\n\n  * Fixed bitbucket oauth instructions\n  * Fixed version parsing issue\n  * Fixed handling of bad proxies that modify JSON content on the fly\n\n### [1.1.2] - 2016-05-31\n\n  * Fixed degraded mode issue when accessing packagist.org\n  * Fixed GitHub access_token being added on subsequent requests in case of redirections\n  * Fixed exclude-from-classmap not working in some circumstances\n  * Fixed openssl warning preventing the use of config command for disabling tls\n\n### [1.1.1] - 2016-05-17\n\n  * Fixed regression in handling of #reference which made it update every time\n  * Fixed dev platform requirements being required even in --no-dev install from a lock file\n  * Fixed parsing of extension versions that do not follow valid numbers, we now try to parse x.y.z and ignore the rest\n  * Fixed exact constraints warnings appearing for 0.x versions\n  * Fixed regression in the `remove` command\n\n### [1.1.0] - 2016-05-10\n\n  * Added fallback to SSH for https bitbucket URLs\n  * Added BaseCommand::isProxyCommand that can be overridden to mark a command as being a mere proxy, which helps avoid duplicate warnings etc on composer startup\n  * Fixed archiving generating long paths in zip files on Windows\n\n### [1.1.0-RC] - 2016-04-29\n\n  * Added ability for plugins to register their own composer commands\n  * Optimized the autoloader initialization using static loading on PHP 5.6 and above, this reduces the load time for large classmaps to almost nothing\n  * Added `--latest` to `show` command to show the latest version available of your dependencies\n  * Added `--outdated` to `show` command an `composer outdated` alias for it, to show only packages in need of update\n  * Added `--direct` to `show` and `outdated` commands to show only your direct dependencies in the listing\n  * Added support for editing all top-level properties (name, minimum-stability, ...) as well as extra values via the `config` command\n  * Added abandoned state warning to the `show` and `outdated` commands when listing latest packages\n  * Added support for `~/` and `$HOME/` in the path repository paths\n  * Added support for wildcards in the `show` command package filter, e.g. `composer show seld/*`\n  * Added ability to call composer itself from scripts via `@composer ...`\n  * Added untracked files detection to the `status` command\n  * Added warning to `validate` command when using exact-version requires\n  * Added warning once per domain when accessing insecure URLs with secure-http disabled\n  * Added a dependency on composer/ca-bundle (extracted CA bundle management to a standalone lib)\n  * Added support for empty directories when archiving to tar\n  * Added an `init` event for plugins to react to, which occurs right after a Composer instance is fully initialized\n  * Added many new detections of problems in the `why-not`/`prohibits` command to figure out why something does not get installed in the expected version\n  * Added a deprecation notice for script event listeners that use legacy script classes\n  * Fixed abandoned state not showing up if you had a package installed before it was marked abandoned\n  * Fixed --no-dev updates creating an incomplete lock file, everything is now always resolved on update\n  * Fixed partial updates in case the vendor dir was not up to date with the lock file\n\n### [1.0.3] - 2016-04-29\n\n  * Security: Fixed possible command injection from the env vars into our sudo detection\n  * Fixed interactive authentication with gitlab\n  * Fixed class name replacement in plugins\n  * Fixed classmap generation mistakenly detecting anonymous classes\n  * Fixed auto-detection of stability flags in complex constraints like `2.0-dev || ^1.5`\n  * Fixed content-length handling when redirecting to very small responses\n\n### [1.0.2] - 2016-04-21\n\n  * Fixed regression in 1.0.1 on systems with mbstring.func_overload enabled\n  * Fixed regression in 1.0.1 that made dev packages update to the latest reference even if not whitelisted in a partial update\n  * Fixed init command ignoring the COMPOSER env var for choosing the json file name\n  * Fixed error reporting bug when the dependency resolution fails\n  * Fixed handling of `$` sign in composer config command in some cases it could corrupt the json file\n\n### [1.0.1] - 2016-04-18\n\n  * Fixed URL updating when a package's URL changes, composer.lock now contains the right URL including correct reference\n  * Fixed URL updating of the origin git remote as well for packages installed as git clone\n  * Fixed binary .bat files generated from linux being incompatible with windows cmd\n  * Fixed handling of paths with trailing slashes in path repository\n  * Fixed create-project not using platform config when selecting a package\n  * Fixed self-update not showing the channel it uses to perform the update\n  * Fixed file downloads not failing loudly when the content does not match the Content-Length header\n  * Fixed secure-http detecting some malformed URLs as insecure\n  * Updated CA bundle\n\n### [1.0.0] - 2016-04-05\n\n  * Added support for bitbucket-oauth configuration\n  * Added warning when running composer as super user, set COMPOSER_ALLOW_SUPERUSER=1 to hide the warning if you really must\n  * Added PluginManager::getGlobalComposer getter to retrieve the global instance (which can be null!)\n  * Fixed dependency solver error reporting in many cases it now shows you proper errors instead of just saying a package does not exist\n  * Fixed output of failed downloads appearing as 100% done instead of Failed\n  * Fixed handling of empty directories when archiving, they are not skipped anymore\n  * Fixed installation of broken plugins corrupting the vendor state when combined with symlinked path repositories\n\n### [1.0.0-beta2] - 2016-03-27\n\n  * Break: The `install` command now turns into an `update` command automatically if you have no composer.lock. This was done only half-way before which caused inconsistencies\n  * Break: By default the `remove` command now removes dependencies as well, and --update-with-dependencies is deprecated. Use --no-update-with-dependencies to get old behavior\n  * Added support for update channels in `self-update`. All users will now update to stable builds by default. Run `self-update` with `--snapshot`, `--preview` or `--stable` to switch between update channels.\n  * Added support for SSL_CERT_DIR env var and openssl.capath ini value\n  * Added some conflict detection in `why-not` command\n  * Added suggestion of root package's suggests in `create-project` command\n  * Fixed `create-project` ignoring --ignore-platform-reqs when choosing a version of the package\n  * Fixed `search` command in a directory without composer.json\n  * Fixed path repository handling of symlinks on windows\n  * Fixed PEAR repo handling to prefer HTTPS mirrors over HTTP ones\n  * Fixed handling of Path env var on Windows, only PATH was accepted before\n  * Small error reporting and docs improvements\n\n### [1.0.0-beta1] - 2016-03-03\n\n  * Break: By default we now disable any non-secure protocols (http, git, svn). This may lead to issues if you rely on those. See `secure-http` config option.\n  * Break: `show` / `list` command now only show installed packages by default. An `--all` option is added to show all packages.\n  * Added VCS repo support for the GitLab API, see also `gitlab-oauth` and `gitlab-domains` config options\n  * Added `prohibits` / `why-not` command to show what blocks an upgrade to a given package:version pair\n  * Added --tree / -t to the `show` command to see all your installed packages in a tree view\n  * Added --interactive / -i to the `update` command, which lets you pick packages to update interactively\n  * Added `exec` command to run binaries while having bin-dir in the PATH for convenience\n  * Added --root-reqs to the `update` command to update only your direct, first degree dependencies\n  * Added `cafile` and `capath` config options to control HTTPS certificate authority\n  * Added pubkey verification of composer.phar when running self-update\n  * Added possibility to configure per-package `preferred-install` types for more flexibility between prefer-source and prefer-dist\n  * Added unpushed-changes detection when updating dependencies and in the `status` command\n  * Added COMPOSER_AUTH env var that lets you pass a json configuration like the auth.json file\n  * Added `secure-http` and `disable-tls` config options to control HTTPS/HTTP\n  * Added warning when Xdebug is enabled as it reduces performance quite a bit, hide it with COMPOSER_DISABLE_XDEBUG_WARN=1 if you must\n  * Added duplicate key detection when loading composer.json\n  * Added `sort-packages` config option to force sorting of the requirements when using the `require` command\n  * Added support for the XDG Base Directory spec on linux\n  * Added XzDownloader for xz file support\n  * Fixed SSL support to fully verify peers in all PHP versions, unsecure HTTP is also disabled by default\n  * Fixed stashing and cleaning up of untracked files when updating packages\n  * Fixed plugins being enabled after installation even when --no-plugins\n  * Many small bug fixes and additions\n\n### [1.0.0-alpha11] - 2015-11-14\n\n  * Added config.platform to let you specify what your target environment looks like and make sure you do not inadvertently install dependencies that would break it\n  * Added `exclude-from-classmap` in the autoload config that lets you ignore sub-paths of classmapped directories, or psr-0/4 directories when building optimized autoloaders\n  * Added `path` repository type to install/symlink packages from local paths\n  * Added possibility to reference script handlers from within other handlers using @script-name to reduce duplication\n  * Added `suggests` command to show what packages are suggested, use -v to see more details\n  * Added `content-hash` inside the composer.lock to restrict the warnings about outdated lock file to some specific changes in the composer.json file\n  * Added `archive-format` and `archive-dir` config options to specify default values for the archive command\n  * Added --classmap-authoritative to `install`, `update`, `require`, `remove` and `dump-autoload` commands, forcing the optimized classmap to be authoritative\n  * Added -A / --with-dependencies to the `validate` command to allow validating all your dependencies recursively\n  * Added --strict to the `validate` command to treat any warning as an error that then returns a non-zero exit code\n  * Added a dependency on composer/semver, which is the externalized lib for all the version constraints parsing and handling\n  * Added support for classmap autoloading to load plugin classes and script handlers\n  * Added `bin-compat` config option that if set to `full` will create .bat proxy for binaries even if Composer runs in a linux VM\n  * Added SPDX 2.0 support, and externalized that in a composer/spdx-licenses lib\n  * Added warnings when the classmap autoloader finds duplicate classes\n  * Added --file to the `archive` command to choose the filename\n  * Added Ctrl+C handling in create-project to cancel the operation cleanly\n  * Fixed version guessing to use ^ always, default to stable versions, and avoid versions that require a higher php version than you have\n  * Fixed the lock file switching back and forth between old and new URL when a package URL is changed and many people run updates\n  * Fixed partial updates updating things they shouldn't when the current vendor dir was out of date with the lock file\n  * Fixed PHAR file creation to be more reproducible and always generate the exact same phar file from a given source\n  * Fixed issue when checking out git branches or tags that are also the name of a file in the repo\n  * Many minor fixes and documentation additions and UX improvements\n\n### [1.0.0-alpha10] - 2015-04-14\n\n  * Break: The following event classes are deprecated and you should update your script handlers to use the new ones in type hints:\n    - `Composer\\Script\\CommandEvent` is deprecated, use `Composer\\Script\\Event`\n    - `Composer\\Script\\PackageEvent` is deprecated, use `Composer\\Installer\\PackageEvent`\n  * Break: Output is now split between stdout and stderr. Any irrelevant output to each command is on stderr as per unix best practices.\n  * Added support for npm-style semver operators (`^` and `-` ranges, ` ` = AND, `||` = OR)\n  * Added --prefer-lowest to `update` command to allow testing a package with the lowest declared dependencies\n  * Added support for parsing semver build metadata `+anything` at the end of versions\n  * Added --sort-packages option to `require` command for sorting dependencies\n  * Added --no-autoloader to `install` and `update` commands to skip autoload generation\n  * Added --list to `run-script` command to see available scripts\n  * Added --absolute to `config` command to get back absolute paths\n  * Added `classmap-authoritative` config option, if enabled only the classmap info will be used by the composer autoloader\n  * Added support for branch-alias on numeric branches\n  * Added support for the `https_proxy`/`HTTPS_PROXY` env vars used only for https URLs\n  * Added support for using real composer repos as local paths in `create-project` command\n  * Added --no-dev to `licenses` command\n  * Added support for PHP 7.0 nightly builds\n  * Fixed detection of stability when parsing multiple constraints\n  * Fixed installs from lock file containing updated composer.json requirement\n  * Fixed the autoloader suffix in vendor/autoload.php changing in every build\n  * Many minor fixes, documentation additions and UX improvements\n\n### [1.0.0-alpha9] - 2014-12-07\n\n  * Added `remove` command to do the reverse of `require`\n  * Added --ignore-platform-reqs to `install`/`update` commands to install even if you are missing a php extension or have an invalid php version\n  * Added a warning when abandoned packages are being installed\n  * Added auto-selection of the version constraint in the `require` command, which can now be used simply as `composer require foo/bar`\n  * Added ability to define custom composer commands using scripts\n  * Added `browse` command to open a browser to the given package's repo URL (or homepage with `-H`)\n  * Added an `autoload-dev` section to declare dev-only autoload rules + a --no-dev flag to dump-autoload\n  * Added an `auth.json` file, with `store-auths` config option\n  * Added a `http-basic` config option to store login/pwds to hosts\n  * Added failover to source/dist and vice-versa in case a download method fails\n  * Added --path (-P) flag to the show command to see the install path of packages\n  * Added --update-with-dependencies and --update-no-dev flags to the require command\n  * Added `optimize-autoloader` config option to force the `-o` flag from the config\n  * Added `clear-cache` command\n  * Added a GzipDownloader to download single gzipped files\n  * Added `ssh` support in the `github-protocols` config option\n  * Added `pre-dependencies-solving` and `post-dependencies-solving` events\n  * Added `pre-archive-cmd` and `post-archive-cmd` script events to the `archive` command\n  * Added a `no-api` flag to GitHub VCS repos to skip the API but still get zip downloads\n  * Added http-basic auth support for private git repos not on github\n  * Added support for autoloading `.hh` files when running HHVM\n  * Added support for PHP 5.6\n  * Added support for OTP auth when retrieving a GitHub API key\n  * Fixed isolation of `files` autoloaded scripts to ensure they can not affect anything\n  * Improved performance of solving dependencies\n  * Improved SVN and Perforce support\n  * A boatload of minor fixes, documentation additions and UX improvements\n\n### [1.0.0-alpha8] - 2014-01-06\n\n  * Break: The `install` command now has --dev enabled by default. --no-dev can be used to install without dev requirements\n  * Added `composer-plugin` package type to allow extensibility, and deprecated `composer-installer`\n  * Added `psr-4` autoloading support and deprecated `target-dir` since it is a better alternative\n  * Added --no-plugins flag to replace --no-custom-installers where available\n  * Added `global` command to operate Composer in a user-global directory\n  * Added `licenses` command to list the license of all your dependencies\n  * Added `pre-status-cmd` and `post-status-cmd` script events to the `status` command\n  * Added `post-root-package-install` and `post-create-project-cmd` script events to the `create-project` command\n  * Added `pre-autoload-dump` script event\n  * Added --rollback flag to self-update\n  * Added --no-install flag to create-project to skip installing the dependencies\n  * Added a `hhvm` platform package to require Facebook's HHVM implementation of PHP\n  * Added `github-domains` config option to allow using GitHub Enterprise with Composer's GitHub support\n  * Added `prepend-autoloader` config option to allow appending Composer's autoloader instead of the default prepend behavior\n  * Added Perforce support to the VCS repository\n  * Added a vendor/composer/autoload_files.php file that lists all files being included by the files autoloader\n  * Added support for the `no_proxy` env var and other proxy support improvements\n  * Added many robustness tweaks to make sure zip downloads work more consistently and corrupted caches are invalidated\n  * Added the release date to `composer -V` output\n  * Added `autoloader-suffix` config option to allow overriding the randomly generated autoloader class suffix\n  * Fixed BitBucket API usage\n  * Fixed parsing of inferred stability flags that are more stable than the minimum stability\n  * Fixed installation order of plugins/custom installers\n  * Fixed tilde and wildcard version constraints to be more intuitive regarding stabilities\n  * Fixed handling of target-dir changes when updating packages\n  * Improved performance of the class loader\n  * Improved memory usage and performance of solving dependencies\n  * Tons of minor bug fixes and improvements\n\n### [1.0.0-alpha7] - 2013-05-04\n\n  * Break: For forward compatibility, you should change your deployment scripts to run `composer install --no-dev`. The install command will install dev dependencies by default starting in the next release\n  * Break: The `update` command now has --dev enabled by default. --no-dev can be used to update without dev requirements, but it will create an incomplete lock file and is discouraged\n  * Break: Removed support for lock files created before 2012-09-15 due to their outdated unusable format\n  * Added `prefer-stable` flag to pick stable packages over unstable ones when possible\n  * Added `preferred-install` config option to always enable --prefer-source or --prefer-dist\n  * Added `diagnose` command to to system/network checks and find common problems\n  * Added wildcard support in the update whitelist, e.g. to update all packages of a vendor do `composer update vendor/*`\n  * Added `archive` command to archive the current directory or a given package\n  * Added `run-script` command to manually trigger scripts\n  * Added `proprietary` as valid license identifier for non-free code\n  * Added a `php-64bit` platform package that you can require to force a 64bit php\n  * Added a `lib-ICU` platform package\n  * Added a new official package type `project` for project-bootstrapping packages\n  * Added zip/dist local cache to speed up repetitive installations\n  * Added `post-autoload-dump` script event\n  * Added `Event::getDevMode` to let script handlers know if dev requirements are being installed\n  * Added `discard-changes` config option to control the default behavior when updating \"dirty\" dependencies\n  * Added `use-include-path` config option to make the autoloader look for files in the include path too\n  * Added `cache-ttl`, `cache-files-ttl` and `cache-files-maxsize` config option\n  * Added `cache-dir`, `cache-files-dir`, `cache-repo-dir` and `cache-vcs-dir` config option\n  * Added support for using http(s) authentication to non-github repos\n  * Added support for using multiple autoloaders at once (e.g. PHPUnit + application both using Composer autoloader)\n  * Added support for .inc files for classmap autoloading (legacy support, do not do this on new projects!)\n  * Added support for version constraints in show command, e.g. `composer show monolog/monolog 1.4.*`\n  * Added support for svn repositories containing packages in a deeper path (see package-path option)\n  * Added an `artifact` repository to scan a directory containing zipped packages\n  * Added --no-dev flag to `install` and `update` commands\n  * Added --stability (-s) flag to create-project to lower the required stability\n  * Added --no-progress to `install` and `update` to hide the progress indicators\n  * Added --available (-a) flag to the `show` command to display only available packages\n  * Added --name-only (-N) flag to the `show` command to show only package names (one per line, no formatting)\n  * Added --optimize-autoloader (-o) flag to optimize the autoloader from the `install` and `update` commands\n  * Added -vv and -vvv flags to get more verbose output, can be useful to debug some issues\n  * Added COMPOSER_NO_INTERACTION env var to do the equivalent of --no-interaction (should be set on build boxes, CI, PaaS)\n  * Added PHP 5.2 compatibility to the autoloader configuration files so they can be used to configure another autoloader\n  * Fixed handling of platform requirements of the root package when installing from lock\n  * Fixed handling of require-dev dependencies\n  * Fixed handling of unstable packages that should be downgraded to stable packages when updating to new version constraints\n  * Fixed parsing of the `~` operator combined with unstable versions\n  * Fixed the `require` command corrupting the json if the new requirement was invalid\n  * Fixed support of aliases used together with `<version>#<reference>` constraints\n  * Improved output of dependency solver problems by grouping versions of a package together\n  * Improved performance of classmap generation\n  * Improved mercurial support in various places\n  * Improved lock file format to minimize unnecessary diffs\n  * Improved the `config` command to support all options\n  * Improved the coverage of the `validate` command\n  * Tons of minor bug fixes and improvements\n\n### [1.0.0-alpha6] - 2012-10-23\n\n  * Schema: Added ability to pass additional options to repositories (i.e. ssh keys/client certificates to secure private repos)\n  * Schema: Added a new `~` operator that should be preferred over `>=`, see http://getcomposer.org/doc/01-basic-usage.md#package-versions\n  * Schema: Version constraints `<x.y` are assumed to be `<x.y-dev` unless specified as `<x.y-stable` to reduce confusion\n  * Added `config` command to edit/list config values, including --global switch for system config\n  * Added OAuth token support for the GitHub API\n  * Added ability to specify CLI commands as scripts in addition to PHP callbacks\n  * Added --prefer-dist flag to force installs of dev packages from zip archives instead of clones\n  * Added --working-dir (-d) flag to change the working directory\n  * Added --profile flag to all commands to display execution time and memory usage\n  * Added `github-protocols` config key to define the order of preferred protocols for github.com clones\n  * Added ability to interactively reset changes to vendor dirs while updating\n  * Added support for hg bookmarks in the hg driver\n  * Added support for svn repositories not following the standard trunk/branch/tags scheme\n  * Fixed git clones of dev versions so that you end up on a branch and not in detached HEAD\n  * Fixed \"Package not installed\" issues with --dev installs\n  * Fixed the lock file format to be a snapshot of all the package info at the time of update\n  * Fixed order of autoload requires to follow package dependencies\n  * Fixed rename() failures with \"Access denied\" on windows\n  * Improved memory usage to be more reasonable and not grow with the repository size\n  * Improved performance and memory usage of installs from composer.lock\n  * Improved performance of a few essential code paths\n  * Many bug small fixes and docs improvements\n\n### [1.0.0-alpha5] - 2012-08-18\n\n  * Added `dump-autoload` command to only regenerate the autoloader\n  * Added --optimize to `dump-autoload` to generate a more performant classmap-based autoloader for production\n  * Added `status` command to show if any source-installed dependency has local changes, use --verbose to see changed files\n  * Added --verbose flag to `install` and `update` that shows the new commits when updating source-installed dependencies\n  * Added --no-update flag to `require` to only modify the composer.json file but skip the update\n  * Added --no-custom-installers and --no-scripts to `install`, `update` and `create-project` to prevent all automatic code execution\n  * Added support for installing archives that contain only a single file\n  * Fixed APC related issues in the autoload script on high load websites\n  * Fixed installation of branches containing capital letters\n  * Fixed installation of custom dev versions/branches\n  * Improved the coverage of the `validate` command\n  * Improved PEAR scripts/binaries support\n  * Improved and fixed the output of various commands\n  * Improved error reporting on network failures and some other edge cases\n  * Various minor bug fixes and docs improvements\n\n### [1.0.0-alpha4] - 2012-07-04\n\n  * Break: The default `minimum-stability` is now `stable`, [read more](https://groups.google.com/d/topic/composer-dev/_g3ASeIFlrc/discussion)\n  * Break: Custom installers now receive the IO instance and a Composer instance in their constructor\n  * Schema: Added references for dev versions, requiring `dev-master#abcdef` for example will force the abcdef commit\n  * Schema: Added `support` key with some more metadata (email, issues, forum, wiki, irc, source)\n  * Schema: Added `!=` operator for version constraints in `require`/`require-dev`\n  * Added a recommendation for package names to be `lower-cased/with-dashes`, it will be enforced for new packages on Pacakgist\n  * Added `require` command to add a package to your requirements and install it\n  * Added a whitelist to `update`. Calling `composer update foo/bar foo/baz` allows you to update only those packages\n  * Added support for overriding repositories in the system config (define repositories in ~/.composer/config.json)\n  * Added `lib-*` packages to the platform repository, e.g. `lib-pcre` contains the pcre version\n  * Added caching of GitHub metadata (faster startup time with custom GitHub VCS repos)\n  * Added caching of SVN metadata (faster startup time with custom SVN VCS repos)\n  * Added support for file:// URLs to GitDriver\n  * Added --self flag to the `show` command to display the infos of the root package\n  * Added --dev flag to `create-project` command\n  * Added --no-scripts to `install` and `update` commands to avoid triggering the scripts\n  * Added `COMPOSER_ROOT_VERSION` env var to specify the version of the root package (fixes some edge cases)\n  * Added support for multiple custom installers in one package\n  * Added files autoloading method which requires files on every request, e.g. to load functional code\n  * Added automatic recovery for lock files that contain references to rewritten (force pushed) commits\n  * Improved PEAR repositories support and package.xml extraction\n  * Improved and fixed the output of various commands\n  * Fixed the order of installation of requirements (they are always installed before the packages requiring them)\n  * Cleaned up / refactored the dependency solver code as well as the output for unsolvable requirements\n  * Various bug fixes and docs improvements\n\n### [1.0.0-alpha3] - 2012-05-13\n\n  * Schema: Added `require-dev` for development-time requirements (tests, etc), install with --dev\n  * Schema: Added author.role to list the author's role in the project\n  * Schema: Added `minimum-stability` + `@<stability>` flags in require for restricting packages to a certain stability\n  * Schema: Removed `recommend`\n  * Schema: `suggest` is now informational and can use any description for a package, not only a constraint\n  * Break: vendor/.composer/autoload.php has been moved to vendor/autoload.php, other files are now in vendor/composer/\n  * Added caching of repository metadata (faster startup times & failover if packagist is down)\n  * Added removal of packages that are not needed anymore\n  * Added include_path support for legacy projects that are full of require_once statements\n  * Added installation notifications API to allow better statistics on Composer repositories\n  * Added support for proxies that require authentication\n  * Added support for private github repositories over https\n  * Added autoloading support for root packages that use target-dir\n  * Added awareness of the root package presence and support for it's provide/replace/conflict keys\n  * Added IOInterface::isDecorated to test for colored output support\n  * Added validation of licenses based on the [SPDX registry](https://spdx.org/licenses/)\n  * Improved repository protocol to have large cacheable parts\n  * Fixed various bugs relating to package aliasing, proxy configuration, binaries\n  * Various bug fixes and docs improvements\n\n### [1.0.0-alpha2] - 2012-04-03\n\n  * Added `create-project` command to install a project from scratch with composer\n  * Added automated `classmap` autoloading support for non-PSR-0 compliant projects\n  * Added human readable error reporting when deps can not be solved\n  * Added support for private GitHub and SVN repositories (use --no-interaction for CI)\n  * Added \"file\" downloader type to download plain files\n  * Added support for authentication with svn repositories\n  * Added autoload support for PEAR repositories\n  * Improved clones from GitHub which now automatically select between git/https/http protocols\n  * Improved `validate` command to give more feedback\n  * Improved the `search` & `show` commands output\n  * Removed dependency on filter_var\n  * Various robustness & error handling improvements, docs fixes and more bug fixes\n\n### 1.0.0-alpha1 - 2012-03-01\n\n  * Initial release\n\n[1.10.22]: https://github.com/composer/composer/compare/1.10.21...1.10.22\n[1.10.21]: https://github.com/composer/composer/compare/1.10.20...1.10.21\n[1.10.20]: https://github.com/composer/composer/compare/1.10.19...1.10.20\n[1.10.19]: https://github.com/composer/composer/compare/1.10.18...1.10.19\n[1.10.18]: https://github.com/composer/composer/compare/1.10.17...1.10.18\n[1.10.17]: https://github.com/composer/composer/compare/1.10.16...1.10.17\n[1.10.16]: https://github.com/composer/composer/compare/1.10.15...1.10.16\n[1.10.15]: https://github.com/composer/composer/compare/1.10.14...1.10.15\n[1.10.14]: https://github.com/composer/composer/compare/1.10.13...1.10.14\n[1.10.13]: https://github.com/composer/composer/compare/1.10.12...1.10.13\n[1.10.12]: https://github.com/composer/composer/compare/1.10.11...1.10.12\n[1.10.11]: https://github.com/composer/composer/compare/1.10.10...1.10.11\n[1.10.10]: https://github.com/composer/composer/compare/1.10.9...1.10.10\n[1.10.9]: https://github.com/composer/composer/compare/1.10.8...1.10.9\n[1.10.8]: https://github.com/composer/composer/compare/1.10.7...1.10.8\n[1.10.7]: https://github.com/composer/composer/compare/1.10.6...1.10.7\n[1.10.6]: https://github.com/composer/composer/compare/1.10.5...1.10.6\n[1.10.5]: https://github.com/composer/composer/compare/1.10.4...1.10.5\n[1.10.4]: https://github.com/composer/composer/compare/1.10.3...1.10.4\n[1.10.3]: https://github.com/composer/composer/compare/1.10.2...1.10.3\n[1.10.2]: https://github.com/composer/composer/compare/1.10.1...1.10.2\n[1.10.1]: https://github.com/composer/composer/compare/1.10.0...1.10.1\n[1.10.0]: https://github.com/composer/composer/compare/1.10.0-RC...1.10.0\n[1.10.0-RC]: https://github.com/composer/composer/compare/1.9.3...1.10.0-RC\n[1.9.3]: https://github.com/composer/composer/compare/1.9.2...1.9.3\n[1.9.2]: https://github.com/composer/composer/compare/1.9.1...1.9.2\n[1.9.1]: https://github.com/composer/composer/compare/1.9.0...1.9.1\n[1.9.0]: https://github.com/composer/composer/compare/1.8.6...1.9.0\n[1.8.6]: https://github.com/composer/composer/compare/1.8.5...1.8.6\n[1.8.5]: https://github.com/composer/composer/compare/1.8.4...1.8.5\n[1.8.4]: https://github.com/composer/composer/compare/1.8.3...1.8.4\n[1.8.3]: https://github.com/composer/composer/compare/1.8.2...1.8.3\n[1.8.2]: https://github.com/composer/composer/compare/1.8.1...1.8.2\n[1.8.1]: https://github.com/composer/composer/compare/1.8.0...1.8.1\n[1.8.0]: https://github.com/composer/composer/compare/1.7.3...1.8.0\n[1.7.3]: https://github.com/composer/composer/compare/1.7.2...1.7.3\n[1.7.2]: https://github.com/composer/composer/compare/1.7.1...1.7.2\n[1.7.1]: https://github.com/composer/composer/compare/1.7.0...1.7.1\n[1.7.0]: https://github.com/composer/composer/compare/1.7.0-RC...1.7.0\n[1.7.0-RC]: https://github.com/composer/composer/compare/1.6.5...1.7.0-RC\n[1.6.5]: https://github.com/composer/composer/compare/1.6.4...1.6.5\n[1.6.4]: https://github.com/composer/composer/compare/1.6.3...1.6.4\n[1.6.3]: https://github.com/composer/composer/compare/1.6.2...1.6.3\n[1.6.2]: https://github.com/composer/composer/compare/1.6.1...1.6.2\n[1.6.1]: https://github.com/composer/composer/compare/1.6.0...1.6.1\n[1.6.0]: https://github.com/composer/composer/compare/1.6.0-RC...1.6.0\n[1.6.0-RC]: https://github.com/composer/composer/compare/1.5.6...1.6.0-RC\n[1.5.6]: https://github.com/composer/composer/compare/1.5.5...1.5.6\n[1.5.5]: https://github.com/composer/composer/compare/1.5.4...1.5.5\n[1.5.4]: https://github.com/composer/composer/compare/1.5.3...1.5.4\n[1.5.3]: https://github.com/composer/composer/compare/1.5.2...1.5.3\n[1.5.2]: https://github.com/composer/composer/compare/1.5.1...1.5.2\n[1.5.1]: https://github.com/composer/composer/compare/1.5.0...1.5.1\n[1.5.0]: https://github.com/composer/composer/compare/1.4.3...1.5.0\n[1.4.3]: https://github.com/composer/composer/compare/1.4.2...1.4.3\n[1.4.2]: https://github.com/composer/composer/compare/1.4.1...1.4.2\n[1.4.1]: https://github.com/composer/composer/compare/1.4.0...1.4.1\n[1.4.0]: https://github.com/composer/composer/compare/1.3.3...1.4.0\n[1.3.3]: https://github.com/composer/composer/compare/1.3.2...1.3.3\n[1.3.2]: https://github.com/composer/composer/compare/1.3.1...1.3.2\n[1.3.1]: https://github.com/composer/composer/compare/1.3.0...1.3.1\n[1.3.0]: https://github.com/composer/composer/compare/1.3.0-RC...1.3.0\n[1.3.0-RC]: https://github.com/composer/composer/compare/1.2.4...1.3.0-RC\n[1.2.4]: https://github.com/composer/composer/compare/1.2.3...1.2.4\n[1.2.3]: https://github.com/composer/composer/compare/1.2.2...1.2.3\n[1.2.2]: https://github.com/composer/composer/compare/1.2.1...1.2.2\n[1.2.1]: https://github.com/composer/composer/compare/1.2.0...1.2.1\n[1.2.0]: https://github.com/composer/composer/compare/1.2.0-RC...1.2.0\n[1.2.0-RC]: https://github.com/composer/composer/compare/1.1.3...1.2.0-RC\n[1.1.3]: https://github.com/composer/composer/compare/1.1.2...1.1.3\n[1.1.2]: https://github.com/composer/composer/compare/1.1.1...1.1.2\n[1.1.1]: https://github.com/composer/composer/compare/1.1.0...1.1.1\n[1.1.0]: https://github.com/composer/composer/compare/1.0.3...1.1.0\n[1.1.0-RC]: https://github.com/composer/composer/compare/1.0.3...1.1.0-RC\n[1.0.3]: https://github.com/composer/composer/compare/1.0.2...1.0.3\n[1.0.2]: https://github.com/composer/composer/compare/1.0.1...1.0.2\n[1.0.1]: https://github.com/composer/composer/compare/1.0.0...1.0.1\n[1.0.0]: https://github.com/composer/composer/compare/1.0.0-beta2...1.0.0\n[1.0.0-beta2]: https://github.com/composer/composer/compare/1.0.0-beta1...1.0.0-beta2\n[1.0.0-beta1]: https://github.com/composer/composer/compare/1.0.0-alpha11...1.0.0-beta1\n[1.0.0-alpha11]: https://github.com/composer/composer/compare/1.0.0-alpha10...1.0.0-alpha11\n[1.0.0-alpha10]: https://github.com/composer/composer/compare/1.0.0-alpha9...1.0.0-alpha10\n[1.0.0-alpha9]: https://github.com/composer/composer/compare/1.0.0-alpha8...1.0.0-alpha9\n[1.0.0-alpha8]: https://github.com/composer/composer/compare/1.0.0-alpha7...1.0.0-alpha8\n[1.0.0-alpha7]: https://github.com/composer/composer/compare/1.0.0-alpha6...1.0.0-alpha7\n[1.0.0-alpha6]: https://github.com/composer/composer/compare/1.0.0-alpha5...1.0.0-alpha6\n[1.0.0-alpha5]: https://github.com/composer/composer/compare/1.0.0-alpha4...1.0.0-alpha5\n[1.0.0-alpha4]: https://github.com/composer/composer/compare/1.0.0-alpha3...1.0.0-alpha4\n[1.0.0-alpha3]: https://github.com/composer/composer/compare/1.0.0-alpha2...1.0.0-alpha3\n[1.0.0-alpha2]: https://github.com/composer/composer/compare/1.0.0-alpha1...1.0.0-alpha2\n", "<?php\n\n/*\n * This file is part of Composer.\n *\n * (c) Nils Adermann <naderman@naderman.de>\n *     Jordi Boggiano <j.boggiano@seld.be>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nnamespace Composer\\Command;\n\nuse Composer\\Package\\CompletePackageInterface;\nuse Composer\\Repository\\RepositoryInterface;\nuse Composer\\Repository\\ArrayRepository;\nuse Composer\\Repository\\RepositoryFactory;\nuse Composer\\Util\\Platform;\nuse Composer\\Util\\ProcessExecutor;\nuse Symfony\\Component\\Console\\Input\\InputArgument;\nuse Symfony\\Component\\Console\\Input\\InputOption;\nuse Symfony\\Component\\Console\\Input\\InputInterface;\nuse Symfony\\Component\\Console\\Output\\OutputInterface;\n\n/**\n * @author Robert Sch\u00f6nthal <seroscho@googlemail.com>\n */\nclass HomeCommand extends BaseCommand\n{\n    /**\n     * {@inheritDoc}\n     */\n    protected function configure()\n    {\n        $this\n            ->setName('browse')\n            ->setAliases(array('home'))\n            ->setDescription('Opens the package\\'s repository URL or homepage in your browser.')\n            ->setDefinition(array(\n                new InputArgument('packages', InputArgument::IS_ARRAY, 'Package(s) to browse to.'),\n                new InputOption('homepage', 'H', InputOption::VALUE_NONE, 'Open the homepage instead of the repository URL.'),\n                new InputOption('show', 's', InputOption::VALUE_NONE, 'Only show the homepage or repository URL.'),\n            ))\n            ->setHelp(\n                <<<EOT\nThe home command opens or shows a package's repository URL or\nhomepage in your default browser.\n\nTo open the homepage by default, use -H or --homepage.\nTo show instead of open the repository or homepage URL, use -s or --show.\n\nRead more at https://getcomposer.org/doc/03-cli.md#browse-home\nEOT\n            );\n    }\n\n    /**\n     * {@inheritDoc}\n     */\n    protected function execute(InputInterface $input, OutputInterface $output)\n    {\n        $repos = $this->initializeRepos();\n        $io = $this->getIO();\n        $return = 0;\n\n        $packages = $input->getArgument('packages');\n        if (!$packages) {\n            $io->writeError('No package specified, opening homepage for the root package');\n            $packages = array($this->getComposer()->getPackage()->getName());\n        }\n\n        foreach ($packages as $packageName) {\n            $handled = false;\n            $packageExists = false;\n            foreach ($repos as $repo) {\n                foreach ($repo->findPackages($packageName) as $package) {\n                    $packageExists = true;\n                    if ($package instanceof CompletePackageInterface && $this->handlePackage($package, $input->getOption('homepage'), $input->getOption('show'))) {\n                        $handled = true;\n                        break 2;\n                    }\n                }\n            }\n\n            if (!$packageExists) {\n                $return = 1;\n                $io->writeError('<warning>Package '.$packageName.' not found</warning>');\n            }\n\n            if (!$handled) {\n                $return = 1;\n                $io->writeError('<warning>'.($input->getOption('homepage') ? 'Invalid or missing homepage' : 'Invalid or missing repository URL').' for '.$packageName.'</warning>');\n            }\n        }\n\n        return $return;\n    }\n\n    private function handlePackage(CompletePackageInterface $package, $showHomepage, $showOnly)\n    {\n        $support = $package->getSupport();\n        $url = isset($support['source']) ? $support['source'] : $package->getSourceUrl();\n        if (!$url || $showHomepage) {\n            $url = $package->getHomepage();\n        }\n\n        if (!$url || !filter_var($url, FILTER_VALIDATE_URL)) {\n            return false;\n        }\n\n        if ($showOnly) {\n            $this->getIO()->write(sprintf('<info>%s</info>', $url));\n        } else {\n            $this->openBrowser($url);\n        }\n\n        return true;\n    }\n\n    /**\n     * opens a url in your system default browser\n     *\n     * @param string $url\n     */\n    private function openBrowser($url)\n    {\n        $url = ProcessExecutor::escape($url);\n\n        $process = new ProcessExecutor($this->getIO());\n        if (Platform::isWindows()) {\n            return $process->execute('start \"web\" explorer \"' . $url . '\"', $output);\n        }\n\n        $linux = $process->execute('which xdg-open', $output);\n        $osx = $process->execute('which open', $output);\n\n        if (0 === $linux) {\n            $process->execute('xdg-open ' . $url, $output);\n        } elseif (0 === $osx) {\n            $process->execute('open ' . $url, $output);\n        } else {\n            $this->getIO()->writeError('No suitable browser opening command found, open yourself: ' . $url);\n        }\n    }\n\n    /**\n     * Initializes repositories\n     *\n     * Returns an array of repos in order they should be checked in\n     *\n     * @return RepositoryInterface[]\n     */\n    private function initializeRepos()\n    {\n        $composer = $this->getComposer(false);\n\n        if ($composer) {\n            return array_merge(\n                array(new ArrayRepository(array($composer->getPackage()))), // root package\n                array($composer->getRepositoryManager()->getLocalRepository()), // installed packages\n                $composer->getRepositoryManager()->getRepositories() // remotes\n            );\n        }\n\n        return RepositoryFactory::defaultRepos($this->getIO());\n    }\n}\n", "<?php\n\n/*\n * This file is part of Composer.\n *\n * (c) Nils Adermann <naderman@naderman.de>\n *     Jordi Boggiano <j.boggiano@seld.be>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nnamespace Composer\\Util;\n\nuse Composer\\IO\\IOInterface;\nuse Symfony\\Component\\Process\\Process;\nuse Symfony\\Component\\Process\\ProcessUtils;\n\n/**\n * @author Robert Sch\u00f6nthal <seroscho@googlemail.com>\n */\nclass ProcessExecutor\n{\n    protected static $timeout = 300;\n\n    protected $captureOutput;\n    protected $errorOutput;\n    protected $io;\n\n    public function __construct(IOInterface $io = null)\n    {\n        $this->io = $io;\n    }\n\n    /**\n     * runs a process on the commandline\n     *\n     * @param  string $command the command to execute\n     * @param  mixed  $output  the output will be written into this var if passed by ref\n     *                         if a callable is passed it will be used as output handler\n     * @param  string $cwd     the working directory\n     * @return int    statuscode\n     */\n    public function execute($command, &$output = null, $cwd = null)\n    {\n        if ($this->io && $this->io->isDebug()) {\n            $safeCommand = preg_replace_callback('{://(?P<user>[^:/\\s]+):(?P<password>[^@\\s/]+)@}i', function ($m) {\n                // if the username looks like a long (12char+) hex string, or a modern github token (e.g. ghp_xxx) we obfuscate that\n                if (preg_match('{^([a-f0-9]{12,}|gh[a-z]_[a-zA-Z0-9_]+)$}', $m['user'])) {\n                    return '://***:***@';\n                }\n\n                return '://'.$m['user'].':***@';\n            }, $command);\n            $safeCommand = preg_replace(\"{--password (.*[^\\\\\\\\]\\') }\", '--password \\'***\\' ', $safeCommand);\n            $this->io->writeError('Executing command ('.($cwd ?: 'CWD').'): '.$safeCommand);\n        }\n\n        // make sure that null translate to the proper directory in case the dir is a symlink\n        // and we call a git command, because msysgit does not handle symlinks properly\n        if (null === $cwd && Platform::isWindows() && false !== strpos($command, 'git') && getcwd()) {\n            $cwd = realpath(getcwd());\n        }\n\n        if (null !== $cwd && !is_dir($cwd)) {\n            throw new \\RuntimeException('The given CWD for the process does not exist: '.$cwd);\n        }\n\n        $this->captureOutput = func_num_args() > 1;\n        $this->errorOutput = null;\n\n        // TODO in v3, commands should be passed in as arrays of cmd + args\n        if (method_exists('Symfony\\Component\\Process\\Process', 'fromShellCommandline')) {\n            $process = Process::fromShellCommandline($command, $cwd, null, null, static::getTimeout());\n        } else {\n            $process = new Process($command, $cwd, null, null, static::getTimeout());\n        }\n\n        $callback = is_callable($output) ? $output : array($this, 'outputHandler');\n        $process->run($callback);\n\n        if ($this->captureOutput && !is_callable($output)) {\n            $output = $process->getOutput();\n        }\n\n        $this->errorOutput = $process->getErrorOutput();\n\n        return $process->getExitCode();\n    }\n\n    public function splitLines($output)\n    {\n        $output = trim($output);\n\n        return ((string) $output === '') ? array() : preg_split('{\\r?\\n}', $output);\n    }\n\n    /**\n     * Get any error output from the last command\n     *\n     * @return string\n     */\n    public function getErrorOutput()\n    {\n        return $this->errorOutput;\n    }\n\n    public function outputHandler($type, $buffer)\n    {\n        if ($this->captureOutput) {\n            return;\n        }\n\n        if (null === $this->io) {\n            echo $buffer;\n\n            return;\n        }\n\n        if (method_exists($this->io, 'writeRaw')) {\n            if (Process::ERR === $type) {\n                $this->io->writeErrorRaw($buffer, false);\n            } else {\n                $this->io->writeRaw($buffer, false);\n            }\n        } else {\n            if (Process::ERR === $type) {\n                $this->io->writeError($buffer, false);\n            } else {\n                $this->io->write($buffer, false);\n            }\n        }\n    }\n\n    public static function getTimeout()\n    {\n        return static::$timeout;\n    }\n\n    public static function setTimeout($timeout)\n    {\n        static::$timeout = $timeout;\n    }\n\n    /**\n     * Escapes a string to be used as a shell argument.\n     *\n     * @param string $argument The argument that will be escaped\n     *\n     * @return string The escaped argument\n     */\n    public static function escape($argument)\n    {\n        return self::escapeArgument($argument);\n    }\n\n    /**\n     * Copy of ProcessUtils::escapeArgument() that is deprecated in Symfony 3.3 and removed in Symfony 4.\n     *\n     * @param string $argument\n     *\n     * @return string\n     */\n    private static function escapeArgument($argument)\n    {\n        //Fix for PHP bug #43784 escapeshellarg removes % from given string\n        //Fix for PHP bug #49446 escapeshellarg doesn't work on Windows\n        //@see https://bugs.php.net/bug.php?id=43784\n        //@see https://bugs.php.net/bug.php?id=49446\n        if ('\\\\' === DIRECTORY_SEPARATOR) {\n            if ((string) $argument === '') {\n                return escapeshellarg($argument);\n            }\n\n            $escapedArgument = '';\n            $quote = false;\n            foreach (preg_split('/(\")/', $argument, -1, PREG_SPLIT_NO_EMPTY | PREG_SPLIT_DELIM_CAPTURE) as $part) {\n                if ('\"' === $part) {\n                    $escapedArgument .= '\\\\\"';\n                } elseif (self::isSurroundedBy($part, '%')) {\n                    // Avoid environment variable expansion\n                    $escapedArgument .= '^%\"'.substr($part, 1, -1).'\"^%';\n                } else {\n                    // escape trailing backslash\n                    if ('\\\\' === substr($part, -1)) {\n                        $part .= '\\\\';\n                    }\n                    $quote = true;\n                    $escapedArgument .= $part;\n                }\n            }\n            if ($quote) {\n                $escapedArgument = '\"'.$escapedArgument.'\"';\n            }\n\n            return $escapedArgument;\n        }\n\n        return \"'\".str_replace(\"'\", \"'\\\\''\", $argument).\"'\";\n    }\n\n    private static function isSurroundedBy($arg, $char)\n    {\n        return 2 < strlen($arg) && $char === $arg[0] && $char === $arg[strlen($arg) - 1];\n    }\n}\n", "<?php\n\n/*\n * This file is part of Composer.\n *\n * (c) Nils Adermann <naderman@naderman.de>\n *     Jordi Boggiano <j.boggiano@seld.be>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nnamespace Composer\\Test\\Downloader;\n\nuse Composer\\Downloader\\GitDownloader;\nuse Composer\\Config;\nuse Composer\\Test\\TestCase;\nuse Composer\\Util\\Filesystem;\nuse Composer\\Util\\Platform;\nuse Composer\\Util\\ProcessExecutor;\nuse Composer\\Util\\Git as GitUtil;\n\nclass GitDownloaderTest extends TestCase\n{\n    /** @var Filesystem */\n    private $fs;\n    /** @var string */\n    private $workingDir;\n\n    protected function setUp()\n    {\n        $this->skipIfNotExecutable('git');\n\n        $this->initGitVersion('1.0.0');\n\n        $this->fs = new Filesystem;\n        $this->workingDir = $this->getUniqueTmpDirectory();\n    }\n\n    protected function tearDown()\n    {\n        if (is_dir($this->workingDir)) {\n            $this->fs->removeDirectory($this->workingDir);\n        }\n\n        $this->initGitVersion(false);\n    }\n\n    private function initGitVersion($version)\n    {\n        // reset the static version cache\n        $refl = new \\ReflectionProperty('Composer\\Util\\Git', 'version');\n        $refl->setAccessible(true);\n        $refl->setValue(null, $version);\n    }\n\n    protected function setupConfig($config = null)\n    {\n        if (!$config) {\n            $config = new Config();\n        }\n        if (!$config->has('home')) {\n            $tmpDir = realpath(sys_get_temp_dir()).DIRECTORY_SEPARATOR.'cmptest-'.md5(uniqid('', true));\n            $config->merge(array('config' => array('home' => $tmpDir)));\n        }\n\n        return $config;\n    }\n\n    protected function getDownloaderMock($io = null, $config = null, $executor = null, $filesystem = null)\n    {\n        $io = $io ?: $this->getMockBuilder('Composer\\IO\\IOInterface')->getMock();\n        $executor = $executor ?: $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $filesystem = $filesystem ?: $this->getMockBuilder('Composer\\Util\\Filesystem')->getMock();\n        $config = $this->setupConfig($config);\n\n        return new GitDownloader($io, $config, $executor, $filesystem);\n    }\n\n    /**\n     * @expectedException \\InvalidArgumentException\n     */\n    public function testDownloadForPackageWithoutSourceReference()\n    {\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->once())\n            ->method('getSourceReference')\n            ->will($this->returnValue(null));\n\n        $downloader = $this->getDownloaderMock();\n        $downloader->download($packageMock, '/path');\n    }\n\n    public function testDownload()\n    {\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('1234567890123456789012345678901234567890'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://example.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrl')\n            ->will($this->returnValue('https://example.com/composer/composer'));\n        $packageMock->expects($this->any())\n            ->method('getPrettyVersion')\n            ->will($this->returnValue('dev-master'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n\n        $expectedGitCommand = $this->winCompat(\"git clone --no-checkout -- 'https://example.com/composer/composer' 'composerPath' && cd 'composerPath' && git remote add composer -- 'https://example.com/composer/composer' && git fetch composer && git remote set-url origin -- 'https://example.com/composer/composer' && git remote set-url composer -- 'https://example.com/composer/composer'\");\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git branch -r\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(2))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git checkout 'master' --\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(3))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git reset --hard '1234567890123456789012345678901234567890' --\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $downloader = $this->getDownloaderMock(null, null, $processExecutor);\n        $downloader->download($packageMock, 'composerPath');\n    }\n\n    public function testDownloadWithCache()\n    {\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('1234567890123456789012345678901234567890'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://example.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrl')\n            ->will($this->returnValue('https://example.com/composer/composer'));\n        $packageMock->expects($this->any())\n            ->method('getPrettyVersion')\n            ->will($this->returnValue('dev-master'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n\n        $this->initGitVersion('2.17.0');\n\n        $config = new Config;\n        $this->setupConfig($config);\n        $cachePath = $config->get('cache-vcs-dir').'/'.preg_replace('{[^a-z0-9.]}i', '-', 'https://example.com/composer/composer').'/';\n\n        $filesystem = new \\Composer\\Util\\Filesystem;\n        $filesystem->removeDirectory($cachePath);\n\n        $expectedGitCommand = $this->winCompat(sprintf(\"git clone --mirror -- 'https://example.com/composer/composer' '%s'\", $cachePath));\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnCallback(function () use ($cachePath) {\n                @mkdir($cachePath, 0777, true);\n\n                return 0;\n            }));\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo('git rev-parse --git-dir'), $this->anything(), $this->equalTo($this->winCompat($cachePath)))\n            ->will($this->returnCallback(function ($command, &$output = null) {\n                $output = '.';\n\n                return 0;\n            }));\n        $processExecutor->expects($this->at(2))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat('git rev-parse --quiet --verify \\'1234567890123456789012345678901234567890^{commit}\\'')), $this->equalTo(null), $this->equalTo($this->winCompat($cachePath)))\n            ->will($this->returnValue(0));\n\n        $expectedGitCommand = $this->winCompat(sprintf(\"git clone --no-checkout '%1\\$s' 'composerPath' --dissociate --reference '%1\\$s' && cd 'composerPath' && git remote set-url origin -- 'https://example.com/composer/composer' && git remote add composer -- 'https://example.com/composer/composer'\", $cachePath));\n        $processExecutor->expects($this->at(3))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(4))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git branch -r\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(5))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git checkout 'master' --\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(6))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git reset --hard '1234567890123456789012345678901234567890' --\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $downloader = $this->getDownloaderMock(null, $config, $processExecutor);\n        $downloader->download($packageMock, 'composerPath');\n        @rmdir($cachePath);\n    }\n\n    public function testDownloadUsesVariousProtocolsAndSetsPushUrlForGithub()\n    {\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/mirrors/composer', 'https://github.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrl')\n            ->will($this->returnValue('https://github.com/composer/composer'));\n        $packageMock->expects($this->any())\n            ->method('getPrettyVersion')\n            ->will($this->returnValue('1.0.0'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n\n        $expectedGitCommand = $this->winCompat(\"git clone --no-checkout -- 'https://github.com/mirrors/composer' 'composerPath' && cd 'composerPath' && git remote add composer -- 'https://github.com/mirrors/composer' && git fetch composer && git remote set-url origin -- 'https://github.com/mirrors/composer' && git remote set-url composer -- 'https://github.com/mirrors/composer'\");\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnValue(1));\n\n        $processExecutor->expects($this->at(1))\n            ->method('getErrorOutput')\n            ->with()\n            ->will($this->returnValue('Error1'));\n\n        $expectedGitCommand = $this->winCompat(\"git clone --no-checkout -- 'git@github.com:mirrors/composer' 'composerPath' && cd 'composerPath' && git remote add composer -- 'git@github.com:mirrors/composer' && git fetch composer && git remote set-url origin -- 'git@github.com:mirrors/composer' && git remote set-url composer -- 'git@github.com:mirrors/composer'\");\n        $processExecutor->expects($this->at(2))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnValue(0));\n\n        $expectedGitCommand = $this->winCompat(\"git remote set-url origin -- 'https://github.com/composer/composer'\");\n        $processExecutor->expects($this->at(3))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $expectedGitCommand = $this->winCompat(\"git remote set-url --push origin -- 'git@github.com:composer/composer.git'\");\n        $processExecutor->expects($this->at(4))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(5))\n            ->method('execute')\n            ->with($this->equalTo('git branch -r'))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(6))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git checkout 'ref' -- && git reset --hard 'ref' --\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $downloader = $this->getDownloaderMock(null, new Config(), $processExecutor);\n        $downloader->download($packageMock, 'composerPath');\n    }\n\n    public function pushUrlProvider()\n    {\n        return array(\n            // ssh proto should use git@ all along\n            array(array('ssh'),                 'git@github.com:composer/composer',     'git@github.com:composer/composer.git'),\n            // auto-proto uses git@ by default for push url, but not fetch\n            array(array('https', 'ssh', 'git'), 'https://github.com/composer/composer', 'git@github.com:composer/composer.git'),\n            // if restricted to https then push url is not overwritten to git@\n            array(array('https'),               'https://github.com/composer/composer', 'https://github.com/composer/composer.git'),\n        );\n    }\n\n    /**\n     * @dataProvider pushUrlProvider\n     */\n    public function testDownloadAndSetPushUrlUseCustomVariousProtocolsForGithub($protocols, $url, $pushUrl)\n    {\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrl')\n            ->will($this->returnValue('https://github.com/composer/composer'));\n        $packageMock->expects($this->any())\n            ->method('getPrettyVersion')\n            ->will($this->returnValue('1.0.0'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n\n        $expectedGitCommand = $this->winCompat(\"git clone --no-checkout -- '{$url}' 'composerPath' && cd 'composerPath' && git remote add composer -- '{$url}' && git fetch composer && git remote set-url origin -- '{$url}' && git remote set-url composer -- '{$url}'\");\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnValue(0));\n\n        $expectedGitCommand = $this->winCompat(\"git remote set-url --push origin -- '{$pushUrl}'\");\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->exactly(4))\n            ->method('execute')\n            ->will($this->returnValue(0));\n\n        $config = new Config();\n        $config->merge(array('config' => array('github-protocols' => $protocols)));\n\n        $downloader = $this->getDownloaderMock(null, $config, $processExecutor);\n        $downloader->download($packageMock, 'composerPath');\n    }\n\n    /**\n     * @expectedException \\RuntimeException\n     */\n    public function testDownloadThrowsRuntimeExceptionIfGitCommandFails()\n    {\n        $expectedGitCommand = $this->winCompat(\"git clone --no-checkout -- 'https://example.com/composer/composer' 'composerPath' && cd 'composerPath' && git remote add composer -- 'https://example.com/composer/composer' && git fetch composer && git remote set-url origin -- 'https://example.com/composer/composer' && git remote set-url composer -- 'https://example.com/composer/composer'\");\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://example.com/composer/composer')));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnValue(1));\n\n        $downloader = $this->getDownloaderMock(null, null, $processExecutor);\n        $downloader->download($packageMock, 'composerPath');\n    }\n\n    /**\n     * @expectedException \\InvalidArgumentException\n     */\n    public function testUpdateforPackageWithoutSourceReference()\n    {\n        $initialPackageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $sourcePackageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $sourcePackageMock->expects($this->once())\n            ->method('getSourceReference')\n            ->will($this->returnValue(null));\n\n        $downloader = $this->getDownloaderMock();\n        $downloader->update($initialPackageMock, $sourcePackageMock, '/path');\n    }\n\n    public function testUpdate()\n    {\n        $expectedGitUpdateCommand = $this->winCompat(\"(git remote set-url composer -- 'https://github.com/composer/composer' && git rev-parse --quiet --verify 'ref^{commit}' || (git fetch composer && git fetch --tags composer)) && git remote set-url composer -- 'https://github.com/composer/composer'\");\n\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('1.0.0.0'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git show-ref --head -d\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git status --porcelain --untracked-files=no\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(2))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(3))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(4))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat($expectedGitUpdateCommand)), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(5))\n            ->method('execute')\n            ->with($this->equalTo('git branch -r'))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(6))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git checkout 'ref' -- && git reset --hard 'ref' --\")), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n\n        $this->fs->ensureDirectoryExists($this->workingDir.'/.git');\n        $downloader = $this->getDownloaderMock(null, new Config(), $processExecutor);\n        $downloader->update($packageMock, $packageMock, $this->workingDir);\n    }\n\n    public function testUpdateWithNewRepoUrl()\n    {\n        $expectedGitUpdateCommand = $this->winCompat(\"(git remote set-url composer -- 'https://github.com/composer/composer' && git rev-parse --quiet --verify 'ref^{commit}' || (git fetch composer && git fetch --tags composer)) && git remote set-url composer -- 'https://github.com/composer/composer'\");\n\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrl')\n            ->will($this->returnValue('https://github.com/composer/composer'));\n        $packageMock->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('1.0.0.0'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git show-ref --head -d\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git status --porcelain --untracked-files=no\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(2))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnCallback(function ($cmd, &$output, $cwd) {\n                $output = 'origin https://github.com/old/url (fetch)\norigin https://github.com/old/url (push)\ncomposer https://github.com/old/url (fetch)\ncomposer https://github.com/old/url (push)\n';\n\n                return 0;\n            }));\n        $processExecutor->expects($this->at(3))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(4))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat($expectedGitUpdateCommand)), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(5))\n            ->method('execute')\n            ->with($this->equalTo('git branch -r'))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(6))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git checkout 'ref' -- && git reset --hard 'ref' --\")), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(7))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote set-url origin -- 'https://github.com/composer/composer'\")), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(8))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote set-url --push origin -- 'git@github.com:composer/composer.git'\")), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n\n        $this->fs->ensureDirectoryExists($this->workingDir.'/.git');\n        $downloader = $this->getDownloaderMock(null, new Config(), $processExecutor);\n        $downloader->update($packageMock, $packageMock, $this->workingDir);\n    }\n\n    /**\n     * @group failing\n     * @expectedException \\RuntimeException\n     */\n    public function testUpdateThrowsRuntimeExceptionIfGitCommandFails()\n    {\n        $expectedGitUpdateCommand = $this->winCompat(\"(git remote set-url composer -- 'https://github.com/composer/composer' && git rev-parse --quiet --verify 'ref^{commit}' || (git fetch composer && git fetch --tags composer)) && git remote set-url composer -- 'https://github.com/composer/composer'\");\n\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('1.0.0.0'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git show-ref --head -d\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git status --porcelain --untracked-files=no\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(2))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(3))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(4))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitUpdateCommand))\n            ->will($this->returnValue(1));\n\n        $this->fs->ensureDirectoryExists($this->workingDir.'/.git');\n        $downloader = $this->getDownloaderMock(null, new Config(), $processExecutor);\n        $downloader->update($packageMock, $packageMock, $this->workingDir);\n    }\n\n    public function testUpdateDoesntThrowsRuntimeExceptionIfGitCommandFailsAtFirstButIsAbleToRecover()\n    {\n        $expectedFirstGitUpdateCommand = $this->winCompat(\"(git remote set-url composer -- '' && git rev-parse --quiet --verify 'ref^{commit}' || (git fetch composer && git fetch --tags composer)) && git remote set-url composer -- ''\");\n        $expectedSecondGitUpdateCommand = $this->winCompat(\"(git remote set-url composer -- 'https://github.com/composer/composer' && git rev-parse --quiet --verify 'ref^{commit}' || (git fetch composer && git fetch --tags composer)) && git remote set-url composer -- 'https://github.com/composer/composer'\");\n\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('1.0.0.0'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('/foo/bar', 'https://github.com/composer/composer')));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git show-ref --head -d\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git status --porcelain --untracked-files=no\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(2))\n           ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(3))\n           ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(4))\n            ->method('execute')\n            ->with($this->equalTo($expectedFirstGitUpdateCommand))\n            ->will($this->returnValue(1));\n        $processExecutor->expects($this->at(6))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git --version\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(7))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(8))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(9))\n            ->method('execute')\n            ->with($this->equalTo($expectedSecondGitUpdateCommand))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(11))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git checkout 'ref' -- && git reset --hard 'ref' --\")), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n\n        $this->fs->ensureDirectoryExists($this->workingDir.'/.git');\n        $downloader = $this->getDownloaderMock(null, new Config(), $processExecutor);\n        $downloader->update($packageMock, $packageMock, $this->workingDir);\n    }\n\n    public function testDowngradeShowsAppropriateMessage()\n    {\n        $oldPackage = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $oldPackage->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('1.2.0.0'));\n        $oldPackage->expects($this->any())\n            ->method('getFullPrettyVersion')\n            ->will($this->returnValue('1.2.0'));\n        $oldPackage->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $oldPackage->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('/foo/bar', 'https://github.com/composer/composer')));\n\n        $newPackage = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $newPackage->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $newPackage->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/composer/composer')));\n        $newPackage->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('1.0.0.0'));\n        $newPackage->expects($this->any())\n            ->method('getFullPrettyVersion')\n            ->will($this->returnValue('1.0.0'));\n\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->any())\n            ->method('execute')\n            ->will($this->returnValue(0));\n\n        $ioMock = $this->getMockBuilder('Composer\\IO\\IOInterface')->getMock();\n        $ioMock->expects($this->at(0))\n            ->method('writeError')\n            ->with($this->stringContains('Downgrading'));\n\n        $this->fs->ensureDirectoryExists($this->workingDir.'/.git');\n        $downloader = $this->getDownloaderMock($ioMock, null, $processExecutor);\n        $downloader->update($oldPackage, $newPackage, $this->workingDir);\n    }\n\n    public function testNotUsingDowngradingWithReferences()\n    {\n        $oldPackage = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $oldPackage->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('dev-ref'));\n        $oldPackage->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $oldPackage->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('/foo/bar', 'https://github.com/composer/composer')));\n\n        $newPackage = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $newPackage->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $newPackage->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/composer/composer')));\n        $newPackage->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('dev-ref2'));\n\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->any())\n            ->method('execute')\n            ->will($this->returnValue(0));\n\n        $ioMock = $this->getMockBuilder('Composer\\IO\\IOInterface')->getMock();\n        $ioMock->expects($this->at(0))\n            ->method('writeError')\n            ->with($this->stringContains('updating'));\n\n        $this->fs->ensureDirectoryExists($this->workingDir.'/.git');\n        $downloader = $this->getDownloaderMock($ioMock, null, $processExecutor);\n        $downloader->update($oldPackage, $newPackage, $this->workingDir);\n    }\n\n    public function testRemove()\n    {\n        $expectedGitResetCommand = $this->winCompat(\"cd 'composerPath' && git status --porcelain --untracked-files=no\");\n\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->any())\n            ->method('execute')\n            ->with($this->equalTo($expectedGitResetCommand))\n            ->will($this->returnValue(0));\n        $filesystem = $this->getMockBuilder('Composer\\Util\\Filesystem')->getMock();\n        $filesystem->expects($this->once())\n            ->method('removeDirectory')\n            ->with($this->equalTo('composerPath'))\n            ->will($this->returnValue(true));\n\n        $downloader = $this->getDownloaderMock(null, null, $processExecutor, $filesystem);\n        $downloader->remove($packageMock, 'composerPath');\n    }\n\n    public function testGetInstallationSource()\n    {\n        $downloader = $this->getDownloaderMock();\n\n        $this->assertEquals('source', $downloader->getInstallationSource());\n    }\n\n    private function winCompat($cmd)\n    {\n        if (Platform::isWindows()) {\n            $cmd = str_replace('cd ', 'cd /D ', $cmd);\n            $cmd = str_replace('composerPath', getcwd().'/composerPath', $cmd);\n\n            return strtr($cmd, \"'\", '\"');\n        }\n\n        return $cmd;\n    }\n}\n", "<?php\n\n/*\n * This file is part of Composer.\n *\n * (c) Nils Adermann <naderman@naderman.de>\n *     Jordi Boggiano <j.boggiano@seld.be>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nnamespace Composer\\Test\\Util;\n\nuse Composer\\Config;\nuse Composer\\IO\\NullIO;\nuse Composer\\Util\\Platform;\nuse Composer\\Util\\Svn;\nuse Composer\\Test\\TestCase;\n\nclass SvnTest extends TestCase\n{\n    /**\n     * Test the credential string.\n     *\n     * @param string $url    The SVN url.\n     * @param string $expect The expectation for the test.\n     *\n     * @dataProvider urlProvider\n     */\n    public function testCredentials($url, $expect)\n    {\n        $svn = new Svn($url, new NullIO, new Config());\n        $reflMethod = new \\ReflectionMethod('Composer\\\\Util\\\\Svn', 'getCredentialString');\n        $reflMethod->setAccessible(true);\n\n        $this->assertEquals($expect, $reflMethod->invoke($svn));\n    }\n\n    /**\n     * Provide some examples for {@self::testCredentials()}.\n     *\n     * @return array\n     */\n    public function urlProvider()\n    {\n        return array(\n            array('http://till:test@svn.example.org/', $this->getCmd(\" --username 'till' --password 'test' \")),\n            array('http://svn.apache.org/', ''),\n            array('svn://johndoe@example.org', $this->getCmd(\" --username 'johndoe' --password '' \")),\n        );\n    }\n\n    public function testInteractiveString()\n    {\n        $url = 'http://svn.example.org';\n\n        $svn = new Svn($url, new NullIO(), new Config());\n        $reflMethod = new \\ReflectionMethod('Composer\\\\Util\\\\Svn', 'getCommand');\n        $reflMethod->setAccessible(true);\n\n        $this->assertEquals(\n            $this->getCmd(\"svn ls --non-interactive  -- 'http://svn.example.org'\"),\n            $reflMethod->invokeArgs($svn, array('svn ls', $url))\n        );\n    }\n\n    public function testCredentialsFromConfig()\n    {\n        $url = 'http://svn.apache.org';\n\n        $config = new Config();\n        $config->merge(array(\n            'config' => array(\n                'http-basic' => array(\n                    'svn.apache.org' => array('username' => 'foo', 'password' => 'bar'),\n                ),\n            ),\n        ));\n\n        $svn = new Svn($url, new NullIO, $config);\n        $reflMethod = new \\ReflectionMethod('Composer\\\\Util\\\\Svn', 'getCredentialString');\n        $reflMethod->setAccessible(true);\n\n        $this->assertEquals($this->getCmd(\" --username 'foo' --password 'bar' \"), $reflMethod->invoke($svn));\n    }\n\n    public function testCredentialsFromConfigWithCacheCredentialsTrue()\n    {\n        $url = 'http://svn.apache.org';\n\n        $config = new Config();\n        $config->merge(\n            array(\n                'config' => array(\n                    'http-basic' => array(\n                        'svn.apache.org' => array('username' => 'foo', 'password' => 'bar'),\n                    ),\n                ),\n            )\n        );\n\n        $svn = new Svn($url, new NullIO, $config);\n        $svn->setCacheCredentials(true);\n        $reflMethod = new \\ReflectionMethod('Composer\\\\Util\\\\Svn', 'getCredentialString');\n        $reflMethod->setAccessible(true);\n\n        $this->assertEquals($this->getCmd(\" --username 'foo' --password 'bar' \"), $reflMethod->invoke($svn));\n    }\n\n    public function testCredentialsFromConfigWithCacheCredentialsFalse()\n    {\n        $url = 'http://svn.apache.org';\n\n        $config = new Config();\n        $config->merge(\n            array(\n                'config' => array(\n                    'http-basic' => array(\n                        'svn.apache.org' => array('username' => 'foo', 'password' => 'bar'),\n                    ),\n                ),\n            )\n        );\n\n        $svn = new Svn($url, new NullIO, $config);\n        $svn->setCacheCredentials(false);\n        $reflMethod = new \\ReflectionMethod('Composer\\\\Util\\\\Svn', 'getCredentialString');\n        $reflMethod->setAccessible(true);\n\n        $this->assertEquals($this->getCmd(\" --no-auth-cache --username 'foo' --password 'bar' \"), $reflMethod->invoke($svn));\n    }\n\n    private function getCmd($cmd)\n    {\n        return Platform::isWindows() ? strtr($cmd, \"'\", '\"') : $cmd;\n    }\n}\n"], "fixing_code": ["### [1.10.23] 2021-10-05\n\n  * Security: Fixed command injection vulnerability on Windows (GHSA-frqg-7g38-6gcf / CVE-2021-41116)\n\n### [1.10.22] 2021-04-27\n\n  * Security: Fixed command injection vulnerability in HgDriver/HgDownloader and hardened other VCS drivers and downloaders (GHSA-h5h8-pc6h-jvvx / CVE-2021-29472)\n\n### [1.10.21] 2021-04-01\n\n  * Fixed support for new GitHub OAuth token format\n  * Fixed processes silently ignoring the CWD when it does not exist\n\n### [1.10.20] 2021-01-27\n\n  * Fixed exclude-from-classmap causing regex issues when having too many paths\n  * Fixed compatibility issue with Symfony 4/5\n\n### [1.10.19] 2020-12-04\n\n  * Fixed regression on PHP 8.0\n\n### [1.10.18] 2020-12-03\n\n  * Allow installation on PHP 8.0\n\n### [1.10.17] 2020-10-30\n\n  * Fixed Bitbucket API authentication issue\n  * Fixed parsing of Composer 2 lock files breaking in some rare conditions\n\n### [1.10.16] 2020-10-24\n\n  * Added warning to `validate` command for cases where packages provide/replace a package that they also require\n  * Fixed JSON schema validation issue with PHPStorm\n  * Fixed symlink handling in `archive` command\n\n### [1.10.15] 2020-10-13\n\n  * Fixed path repo version guessing issue\n\n### [1.10.14] 2020-10-13\n\n  * Fixed version guesser to look at remote branches as well as local ones\n  * Fixed path repositories version guessing to handle edge cases where version is different from the VCS-guessed version\n  * Fixed COMPOSER env var causing issues when combined with the `global ` command\n  * Fixed a few issues dealing with PHP without openssl extension (not recommended at all but sometimes needed for testing)\n\n### [1.10.13] 2020-09-09\n\n  * Fixed regressions with old version validation\n  * Fixed invalid root aliases not being reported\n\n### [1.10.12] 2020-09-08\n\n  * Fixed regressions with old version validation\n\n### [1.10.11] 2020-09-08\n\n  * Fixed more PHP 8 compatibility issues\n  * Fixed regression in handling of CTRL-C when xdebug is loaded\n  * Fixed `status` handling of broken symlinks\n\n### [1.10.10] 2020-08-03\n\n  * Fixed `create-project` not triggering events while installing the root package\n  * Fixed PHP 8 compatibility issue\n  * Fixed `self-update` to avoid automatically upgrading to the next major version once it becomes stable\n\n### [1.10.9] 2020-07-16\n\n  * Fixed Bitbucket redirect loop when credentials are outdated\n  * Fixed GitLab auth prompt wording\n  * Fixed `self-update` handling of files requiring admin permissions to write to on Windows (it now does a UAC prompt)\n  * Fixed parsing issues in funding.yml files\n\n### [1.10.8] 2020-06-24\n\n  * Fixed compatibility issue with git being configured to show signatures by default\n  * Fixed discarding of local changes when updating packages to include untracked files\n  * Several minor fixes\n\n### [1.10.7] 2020-06-03\n\n  * Fixed PHP 8 deprecations\n  * Fixed detection of pcntl_signal being in disabled_functions when pcntl_async_signal is allowed\n\n### [1.10.6] 2020-05-06\n\n  * Fixed version guessing to take composer-runtime-api and composer-plugin-api requirements into account to avoid selecting packages which require Composer 2\n  * Fixed package name validation to allow several dashes following each other\n  * Fixed post-status-cmd script not firing when there were no changes to be displayed\n  * Fixed composer-runtime-api support on Composer 1.x, the package is now present as 1.0.0\n  * Fixed support for composer show --name-only --self\n  * Fixed detection of GitLab URLs when handling authentication in some cases\n\n### [1.10.5] 2020-04-10\n\n  * Fixed self-update on PHP <5.6, seriously please upgrade people, it's time\n  * Fixed 1.10.2 regression with PATH resolution in scripts\n\n### [1.10.4] 2020-04-09\n\n  * Fixed 1.10.2 regression in path symlinking with absolute path repos\n\n### [1.10.3] 2020-04-09\n\n  * Fixed invalid --2 flag warning in `self-update` when no channel is requested\n\n### [1.10.2] 2020-04-09\n\n  * Added --1 flag to `self-update` command which can be added to automated self-update runs to make sure it won't automatically jump to 2.0 once that is released\n  * Fixed path repository symlinks being made relative when the repo url is defined as absolute paths\n  * Fixed potential issues when using \"composer ...\" in scripts and composer/composer was also required in the project\n  * Fixed 1.10.0 regression when downloading GitHub archives from non-API URLs\n  * Fixed handling of malformed info in fund command\n  * Fixed Symfony5 compatibility issues in a few commands\n\n### [1.10.1] 2020-03-13\n\n  * Fixed path repository warning on empty path when using wildcards\n  * Fixed superfluous warnings when generating optimized autoloaders\n\n### [1.10.0] 2020-03-10\n\n  * Added `bearer` auth config to authenticate using `Authorization: Bearer <token>` headers\n  * Added `plugin-api-version` in composer.lock so third-party tools can know which Composer version was used to generate a lock file\n  * Fixed composer fund command and funding info parsing to be more useful\n  * Fixed issue where --no-dev autoload generation was excluding some packages which should not have been excluded\n  * Fixed 1.10-RC regression in create project's handling of absolute paths\n\n### [1.10.0-RC] 2020-02-14\n\n  * Breaking: `composer global exec ...` now executes the process in the current working directory instead of executing it in the global directory.\n  * Warning: Added a warning when class names are being loaded by a PSR-4 or PSR-0 rule only due to classmap optimization, but would not otherwise be autoloadable. Composer 2.0 will stop autoloading these classes so make sure you fix your autoload configs.\n  * Added new funding key to composer.json to describe ways your package's maintenance can be funded. This reads info from GitHub's FUNDING.yml by default so better configure it there so it shows on GitHub and Composer/Packagist\n  * Added `composer fund` command to show funding info of your dependencies\n  * Added support for --format=json output for show command when showing a single package\n  * Added support for configuring suggestions using config command, e.g. `composer config suggest.foo/bar some text`\n  * Added support for configuring fine-grained preferred-install using config command, e.g. `composer config preferred-install.foo/* dist`\n  * Added `@putenv` script handler to set environment variables from composer.json for following scripts\n  * Added `lock` option that can be set to false, in which case no composer.lock file will be generated\n  * Added --add-repository flag to create-project command which will persist the repo given in --repository into the composer.json of the package being installed\n  * Added support for IPv6 addresses in NO_PROXY\n  * Added package homepage display in the show command\n  * Added debug info about HTTP authentications\n  * Added Symfony 5 compatibility\n  * Added --fixed flag to require command to make it use a fixed constraint instead of a ^x.y constraint when adding the requirement\n  * Fixed exclude-from-classmap matching subsets of directories e.g. foo/ was excluding foobar/\n  * Fixed archive command to persist file permissions inside the zip files\n  * Fixed init/require command to avoid suggesting packages which are already selected in the search results\n  * Fixed create-project UX issues\n  * Fixed filemtime for vendor/composer/* files is now only changing when the files actually change\n  * Fixed issues detecting docker environment with an active open_basedir\n\n### [1.9.3] 2020-02-04\n\n  * Fixed GitHub deprecation of access_token query parameter, now using Authorization header\n\n### [1.9.2] 2020-01-14\n\n  * Fixed minor git driver bugs\n  * Fixed schema validation for version field to allow dev-* versions too\n  * Fixed external processes' output being formatted even though it should not\n  * Fixed issue with path repositories when trying to install feature branches\n\n### [1.9.1] 2019-11-01\n\n  * Fixed various credential handling issues with gitlab and github\n  * Fixed credentials being present in git remotes in Composer cache and vendor directory when not using SSH keys\n  * Fixed `composer why` not listing replacers as a reason something is present\n  * Fixed various PHP 7.4 compatibility issues\n  * Fixed root warnings always present in Docker containers, setting COMPOSER_ALLOW_SUPERUSER is not necessary anymore\n  * Fixed GitHub access tokens leaking into debug-verbosity output\n  * Fixed several edge case issues detecting GitHub, Bitbucket and GitLab repository types\n  * Fixed Composer asking if you want to use a composer.json in a parent directory when ran in non-interactive mode\n  * Fixed classmap autoloading issue finding classes located within a few non-PHP context blocks (?>...<?php)\n\n### [1.9.0] 2019-08-02\n\n  * Breaking: artifact repositories with URLs containing port numbers and requiring authentication now require you to configure http-basic auth for the `host:port` pair explicitly\n  * Added a `--no-cache` flag available on all commands to run with the cache disabled\n  * Added PHP_BINARY as env var pointing to the PHP process when executing Composer scripts as shell scripts\n  * Added a `use-github-api` config option which can set the `no-api` flag on all GitHub VCS repositories declared\n  * Added a static helper you can preprend to a script to avoid process timeouts, `\"Composer\\\\Config::disableProcessTimeout\"`\n  * Added Event::getOriginatingEvent to retrieve an event's original event when a script handler forwards to another one\n  * Added support for autoloading directly from a phar file\n  * Fixed loading order of plugins to always initialize them in order of dependencies\n  * Fixed various network-mount related issues\n  * Fixed --ignore-platform-reqs not ignoring conflict rules against platform packages\n\n### [1.8.6] 2019-06-11\n\n  * Fixed handling of backslash-escapes handling in composer.json when using the require command\n  * Fixed create-project not following classmap-authoritative and apcu-autoloader config values\n  * Fixed HHVM version warning showing up in some cases when it was not in use\n\n### [1.8.5] 2019-04-09\n\n  * HHVM 4.0 is no longer compatible with Composer. Please use PHP instead going forward.\n  * Added forward compatibility with upcoming 2.0 changes\n  * Fixed support for PHP 7.3-style heredoc/nowdoc syntax changes in autoload generation\n  * Fixed require command usage when combined with --ignore-platform-reqs\n  * Fixed and cleaned up various Windows junctions handling issues\n\n### [1.8.4] 2019-02-11\n\n  * Fixed long standing solver bug leading to odd solving issues in edge cases, see #7946\n  * Fixed HHVM support for upcoming releases\n  * Fixed unix proxy for binaries to be POSIX compatible instead of breaking some shells\n  * Fixed invalid deprecation warning for composer-plugin-api\n  * Fixed edge case issues with Windows junctions when working with path repositories\n\n### [1.8.3] 2019-01-30\n\n  * Fixed regression when executing partial updates\n\n### [1.8.2] 2019-01-29\n\n  * Fixed invalid deprecation warning for ext-pdo_mysql and similar\n  * Updated to latest xdebug-handler\n\n### [1.8.1] 2019-01-29\n\n  * Deprecated support for non-standard package names (anything with uppercase, or no / in it). Make sure to follow the warnings if you see any to avoid problems in 2.0.\n  * Fixed some packages missing from the autoloader config when installing with --no-dev\n  * Fixed support for cloning GitLab repos using OAuth tokens instead of SSH keys\n  * Fixed metapackage installs/updates missing from output\n  * Fixed --with-dependencies / --with-all-dependencies not updating some packages in some edge cases\n  * Fixed compatibility with Symfony 4.2 deprecations\n  * Fixed temp dir not being cleaned up on download error while archiving packages\n  * Updated to latest ca-bundle\n\n### [1.8.0] 2018-12-03\n\n  * Changed `post-package-install` / `post-package-update` event to be fired *after* the lock file has been updated as opposed to before\n  * Added support for removing packages using a wildcard with the `remove` command, e.g. `composer remove foo/*`\n  * Added `chat` to the list of `support` channels you can list in composer.json\n  * Added signal handling on require command to restore the composer.json in case of abort\n  * Added `--ignore` to `outdated` command to pass one or more packages that you do not want to be listed\n  * Added `--no-dev` to `check-platform-reqs` command to skip dev requirements even if they are installed\n  * Added support for running plugin commands from sub-directories within a project much like other Composer commands\n  * Added support for running Composer via phpdbg\n  * Added `lib-imagick` platform package\n  * Fixed validate command always checking for disabled checks when used with `--strict`\n\n### [1.7.3] 2018-11-01\n\n  * Fixed handling of replace/conflict rules. This may affect dependency resolution in some edge cases.\n  * Fixed Bitbucket API support and migrated all calls to API v2 as v1 is deprecated\n  * Fixed support for lib-openssl 1.1.1 having only lowercase algorithm names\n  * Fixed escaping of URLs in Perforce and Svn drivers\n  * Fixed `show` command not respecting `--path` when a single package name was given\n  * Fixed regression in 1.7.2's handling of metapackages\n\n### [1.7.2] 2018-08-16\n\n  * Fixed reporting of authentication/rate limiting issues for GitHub API access\n  * Fixed `create-project` not checking the checking the latest commit out when a cache was already present\n  * Fixed reporting of errors when `global` command can not switch the working directory\n  * Fixed PHP 5.3 JSON encoding issues with complex unicode character sequences\n  * Updated to latest ca-bundle and xdebug-handler projects, see related changelogs\n\n### [1.7.1] 2018-08-07\n\n  * Fixed issue autoloading plugins in require-dev in some conditions\n  * Fixed handling of SSL to repo.packagist.org on very old PHP versions\n\n### [1.7.0] 2018-08-03\n\n  * Added the overridden platform config's PHP version in the `diagnose` command output\n  * Fixed --no-plugins not being respected in a few commands\n  * Fixed 1.7.0-RC regression in output showing <warn> instead of proper colors\n  * Fixed 1.7.0-RC regression in output missing \"Loading from cache\" output on package install\n\n### [1.7.0-RC] 2018-07-24\n\n  * Changed default repository URL from packagist.org to repo.packagist.org, this might affect people with strict firewall rules\n  * Changed output from Updating to Downgrading when performing package downgrades, this might affect anything parsing output\n  * Several minor performance improvements\n  * Added basic authentication support for mercurial repos\n  * Added explicit `i` and `u` aliases for the `install` and `update` commands\n  * Added support for `show` command to output json format with --tree\n  * Added support for {glob,braces} support in the path repository's path argument\n  * Added support in `status` command for showing diffs in vendor dir even for packages installed as dist/zip archives\n  * Added `--remove-vcs` flag to `create-project` command to avoid prompting for keeping VCS files\n  * Added `--no-secure-http` flag to `create-project` command to bypass https (use at your own risk)\n  * Added `pre-command-run` event that lets plugins modify arguments\n  * Added RemoteFilesystem::getRemoteContents extension point\n  * Fixed setting scripts via `config` command\n\n### [1.6.5] 2018-05-04\n\n  * Fixed regression in 1.6.4 causing strange update behaviors with dev packages\n  * Fixed regression in 1.6.4 color support detection for Windows\n  * Fixed issues dealing with broken symlinks when switching branches and using path repositories\n  * Fixed JSON schema for package repositories\n  * Fixed issues on computers set to Turkish locale\n  * Fixed classmap parsing of files using short-open-tags when they are disabled in php\n\n### [1.6.4] 2018-04-13\n\n  * Security fixes in some edge case scenarios, recommended update for all users\n  * Fixed regression in version guessing of path repositories\n  * Fixed removing aliased packages from the repository, which might resolve some odd update bugs\n  * Fixed updating of package URLs for GitLab\n  * Fixed run-script --list failing when script handlers were defined\n  * Fixed init command not respecting the current php version when selecting package versions\n  * Fixed handling of uppercase package names in why/why-not commands\n  * Fixed exclude-from-classmap symlink handling\n  * Fixed filesystem permissions of PEAR binaries\n  * Improved performance of subversion repos\n  * Other minor fixes\n\n### [1.6.3] 2018-01-31\n\n  * Fixed GitLab downloads failing in some edge cases\n  * Fixed ctrl-C handling during create-project\n  * Fixed GitHub VCS repositories not prompting for a token in some conditions\n  * Fixed SPDX license identifiers being case sensitive\n  * Fixed and clarified a few dependency resolution error reporting strings\n  * Fixed SVN commit log fetching in verbose mode when using private repositories\n\n### [1.6.2] 2018-01-05\n\n  * Fixed more autoloader regressions\n  * Fixed support for updating dist refs in gitlab URLs\n\n### [1.6.1] 2018-01-04\n\n  * Fixed upgrade regression due to some autoloader cleanups\n  * Fixed some overly loose version constraints\n\n### [1.6.0] 2018-01-04\n\n  * Added support for SPDX license identifiers v3.0, deprecates GPL/LGPL/AGPL identifiers, which should now have a `-only` or `-or-later` suffix added.\n  * Added support for COMPOSER_MEMORY_LIMIT env var to make Composer set the PHP memory limit explicitly\n  * Added support for simple strings for the `bin`\n  * Fixed `check-platform-reqs` bug in version checking\n\n### [1.6.0-RC] 2017-12-19\n\n  * Improved performance of installs and updates from git clones when checking out known commits\n  * Added `check-platform-reqs` command that checks that your PHP and extensions versions match the platform requirements of the installed packages\n  * Added `--with-all-dependencies` to the `update` and `require` commands which updates all dependencies of the listed packages, including those that are direct root requirements\n  * Added `scripts-descriptions` key to composer.json to customize the description and document your custom commands\n  * Added support for the uppercase NO_PROXY env var\n  * Added support for COMPOSER_DEFAULT_{AUTHOR,LICENSE,EMAIL,VENDOR} env vars to pre-populate init command values\n  * Added support for local fossil repositories\n  * Added suggestions for alternative spellings when entering packages in `init` and `require` commands and nothing can be found\n  * Fixed installed.json data to be sorted alphabetically by package name\n  * Fixed compatibility with Symfony 4.x components that Composer uses\n\n### [1.5.6] - 2017-12-18\n\n  * Fixed root package version guessed when a tag is checked out\n  * Fixed support for GitLab repos hosted on non-standard ports\n  * Fixed regression in require command when requiring unstable packages, part 3\n\n### [1.5.5] - 2017-12-01\n\n  * Fixed regression in require command when requiring unstable packages, part 2\n\n### [1.5.4] - 2017-12-01\n\n  * Fixed regression in require command when requiring unstable packages\n\n### [1.5.3] - 2017-11-30\n\n  * Fixed require/remove commands reverting the composer.json change when a non-solver-related error occurs\n  * Fixed GitLabDriver to support installations of GitLab not at the root of the domain\n  * Fixed create-project not following the optimize-autoloader flag of the root package\n  * Fixed Authorization header being forwarded across domains after a redirect\n  * Improved some error messages for clarity\n\n### [1.5.2] - 2017-09-11\n\n  * Fixed GitLabDriver looping endlessly in some conditions\n  * Fixed GitLabDriver support for unauthenticated requests\n  * Fixed GitLab zip downloads not triggering credentials prompt if unauthenticated\n  * Fixed path repository support of COMPOSER_ROOT_VERSION, it now applies to all path repos within the same git repository\n  * Fixed path repository handling of copies to avoid copying VCS files and others\n  * Fixed sub-directory call to ignore list and create-project commands as well as calls to Composer using --working-dir\n  * Fixed invalid warning appearing when calling `remove` on an non-stable package\n\n### [1.5.1] - 2017-08-09\n\n  * Fixed regression in GitLabDriver with repos containing >100 branches or tags\n  * Fixed sub-directory call support to respect the COMPOSER env var\n\n### [1.5.0] - 2017-08-08\n\n  * Changed the package install order to ensure that plugins are always installed as soon as possible\n  * Added ability to call composer from within sub-directories of a project\n  * Added support for GitLab API v4\n  * Added support for GitLab sub-groups\n  * Added some more rules to composer validate\n  * Added support for reading the `USER` env when guessing the username in `composer init`\n  * Added warning when uncompressing files with the same name but difference cases on case insensitive filesystems\n  * Added `htaccess-protect` option / `COMPOSER_HTACCESS_PROTECT` env var to disable the .htaccess creation in home dir (defaults to true)\n  * Improved `clear-cache` command\n  * Minor improvements/fixes and many documentation updates\n\n### [1.4.3] - 2017-08-06\n\n  * Fixed GitLab URLs\n  * Fixed root package version detection using latest git versions\n  * Fixed inconsistencies in date format in composer.lock when installing from source\n  * Fixed Mercurial support regression\n  * Fixed exclude-from-classmap not being applied when autoloading files for Composer plugins\n  * Fixed exclude-from-classmap being ignored when cwd has the wrong case on case insensitive filesystems\n  * Fixed several other minor issues\n\n### [1.4.2] - 2017-05-17\n\n  * Fixed Bitbucket API handler parsing old deleted branches in hg repos\n  * Fixed regression in gitlab downloads\n  * Fixed output inconsistencies\n  * Fixed unicode handling in `init` command for author names\n  * Fixed useless warning when doing partial updates/removes on packages that are not currently installed\n  * Fixed Xdebug disabling issue when combined with disable_functions and allow_url_fopen CLI overrides\n\n### [1.4.1] - 2017-03-10\n\n  * Fixed `apcu-autoloader` config option being ignored in `dump-autoload` command\n  * Fixed json validation not allowing boolean for trunk-path, branches-path and tags-path in svn repos\n  * Fixed json validation not allowing repository URLs without scheme\n\n### [1.4.0] - 2017-03-08\n\n  * Improved memory usage of dependency solver\n  * Added `--format json` option to the `outdated` and `show` command to get machine readable package listings\n  * Added `--ignore-filters` flag to `archive` command to bypass the .gitignore and co\n  * Added support for `outdated` output without ansi colors\n  * Added support for Bitbucket API v2\n  * Changed the require command to follow minimum-stability / prefer-stable values when picking a version\n  * Fixed regression when using composer in a Mercurial repository\n\n### [1.3.3] - 2017-03-08\n\n  * **Capifony users beware**: This release has output format tweaks that mess up capifony interactive mode, see #6233\n  * Improved baseline psr-4 autoloader performance for projects with many nested namespaces configured\n  * Fixed issues with gitlab API access when the token had insufficient permissions\n  * Fixed some HHVM strict type issues\n  * Fixed version guessing of headless git checkouts in some conditions\n  * Fixed compatibility with subversion 1.8\n  * Fixed version guessing not working with svn/hg\n  * Fixed script/exec errors not being output correctly\n  * Fixed PEAR repository bug with pear.php.net\n\n### [1.3.2] - 2017-01-27\n\n  * Added `COMPOSER_BINARY` env var that is defined within the scope of a Composer run automatically with the path to the phar file\n  * Fixed create-project ending in a detached HEAD when installing aliased packages\n  * Fixed composer show not returning non-zero exit code when the package does not exist\n  * Fixed `@composer` handling in scripts when --working-dir is used together with it\n  * Fixed private-GitLab handling of repos with dashes in them\n\n### [1.3.1] - 2017-01-07\n\n  * Fixed dist downloads from Bitbucket\n  * Fixed some regressions related to xdebug disabling\n  * Fixed `--minor-only` flag in `outdated` command\n  * Fixed handling of config.platform.php which did not replace other php-* package's versions\n\n### [1.3.0] - 2016-12-24\n\n  * Fixed handling of annotated git tags vs lightweight tags leading to useless updates sometimes\n  * Fixed ext-xdebug not being require-able anymore due to automatic xdebug disabling\n  * Fixed case insensitivity of remove command\n\n### [1.3.0-RC] - 2016-12-11\n\n  * Added workaround for xdebug performance impact by restarting PHP without xdebug automatically in case it is enabled\n  * Added `--minor-only` to the `outdated` command to only show updates to minor versions and ignore new major versions\n  * Added `--apcu-autoloader` to the `update`/`install` commands and `--apcu` to `dump-autoload` to enable an APCu-caching autoloader, which can be more efficient than --classmap-authoritative if you attempt to autoload many classes that do not exist, or if you can not use authoritative classmaps for some reason\n  * Added summary of operations to be executed before they run, and made execution output more compact\n  * Added `php-debug` and `php-zts` virtual platform packages\n  * Added `gitlab-token` auth config for GitLab private tokens\n  * Added `--strict` to the `outdated` command to return a non-zero exit code when there are outdated packages\n  * Added ability to call php scripts using the current php interpreter (instead of finding php in PATH by default) in script handlers via `@php ...`\n  * Added `COMPOSER_ALLOW_XDEBUG` env var to circumvent the Xdebug-disabling behavior\n  * Added `COMPOSER_MIRROR_PATH_REPOS` env var to force mirroring of path repositories vs symlinking\n  * Added `COMPOSER_DEV_MODE` env var that is set by Composer to forward the dev mode to script handlers\n  * Fixed support for git 2.11\n  * Fixed output from zip and rar leaking out when an error occurred\n  * Removed `hash` from composer.lock, only `content-hash` is now used which should reduce conflicts\n  * Minor fixes and performance improvements\n\n### [1.2.4] - 2016-12-06\n\n  * Fixed regression in output handling of scripts from 1.2.3\n  * Fixed support for LibreSSL detection as lib-openssl\n  * Fixed issue with Zend Guard in the autoloader bootstrapping\n  * Fixed support for loading partial provider repositories\n\n### [1.2.3] - 2016-12-01\n\n  * Fixed bug in HgDriver failing to identify BitBucket repositories\n  * Fixed support for loading partial provider repositories\n\n### [1.2.2] - 2016-11-03\n\n  * Fixed selection of packages based on stability to be independent from package repository order\n  * Fixed POST_DEPENDENCIES_SOLVING not containing some operations in edge cases\n  * Fixed issue handling GitLab URLs containing dots and other special characters\n  * Fixed issue on Windows when running composer at the root of a drive\n  * Minor fixes\n\n### [1.2.1] - 2016-09-12\n\n  * Fixed edge case issues with the static autoloader\n  * Minor fixes\n\n### [1.2.0] - 2016-07-19\n\n  * Security: Fixed [httpoxy](https://httpoxy.org/) vulnerability\n  * Fixed `home` command to avoid rogue output on unix\n  * Fixed output of git clones to clearly state when clones are from cache\n  * (from 1.2 RC) Fixed ext-network-ipv6 to be php-ipv6\n\n### [1.2.0-RC] - 2016-07-04\n\n  * Added caching of git repositories if you have git 2.3+ installed. Repositories will now be cached once and then cloned from local cache so subsequent installs should be faster\n  * Added detection of HEAD changes to the `status` command. If you `git checkout X` in a vendor directory for example it will tell you that it is not at the version that was installed\n  * Added a virtual `php-ipv6` extension to require PHP compiled with IPv6 support\n  * Added `--no-suggest` to `install` and `update` commands to skip output of suggestions at the end\n  * Added `--type` to the `search` command to restrict to a given package type\n  * Added fossil support as alternative to git/svn/.. for package downloads\n  * Improved BitBucket OAuth support\n  * Added support for blocking cache operations using COMPOSER_CACHE_DIR=/dev/null (or NUL on windows)\n  * Added support for using declare(strict_types=1) in plugins\n  * Added `--prefer-stable` and `--prefer-lowest` to the `require` command\n  * Added `--no-scripts` to the `require` and `remove` commands\n  * Added `_comment` top level key to the schema to endorse using it as a place to store comments (it can be a string or array of strings)\n  * Added support for justinrainbow/json-schema 2.0\n  * Fixed binaries not being re-installed if deleted by users or the bin-dir changes. `update` and `install` will now re-install them\n  * Many minor UX and docs improvements\n\n### [1.1.3] - 2016-06-26\n\n  * Fixed bitbucket oauth instructions\n  * Fixed version parsing issue\n  * Fixed handling of bad proxies that modify JSON content on the fly\n\n### [1.1.2] - 2016-05-31\n\n  * Fixed degraded mode issue when accessing packagist.org\n  * Fixed GitHub access_token being added on subsequent requests in case of redirections\n  * Fixed exclude-from-classmap not working in some circumstances\n  * Fixed openssl warning preventing the use of config command for disabling tls\n\n### [1.1.1] - 2016-05-17\n\n  * Fixed regression in handling of #reference which made it update every time\n  * Fixed dev platform requirements being required even in --no-dev install from a lock file\n  * Fixed parsing of extension versions that do not follow valid numbers, we now try to parse x.y.z and ignore the rest\n  * Fixed exact constraints warnings appearing for 0.x versions\n  * Fixed regression in the `remove` command\n\n### [1.1.0] - 2016-05-10\n\n  * Added fallback to SSH for https bitbucket URLs\n  * Added BaseCommand::isProxyCommand that can be overridden to mark a command as being a mere proxy, which helps avoid duplicate warnings etc on composer startup\n  * Fixed archiving generating long paths in zip files on Windows\n\n### [1.1.0-RC] - 2016-04-29\n\n  * Added ability for plugins to register their own composer commands\n  * Optimized the autoloader initialization using static loading on PHP 5.6 and above, this reduces the load time for large classmaps to almost nothing\n  * Added `--latest` to `show` command to show the latest version available of your dependencies\n  * Added `--outdated` to `show` command an `composer outdated` alias for it, to show only packages in need of update\n  * Added `--direct` to `show` and `outdated` commands to show only your direct dependencies in the listing\n  * Added support for editing all top-level properties (name, minimum-stability, ...) as well as extra values via the `config` command\n  * Added abandoned state warning to the `show` and `outdated` commands when listing latest packages\n  * Added support for `~/` and `$HOME/` in the path repository paths\n  * Added support for wildcards in the `show` command package filter, e.g. `composer show seld/*`\n  * Added ability to call composer itself from scripts via `@composer ...`\n  * Added untracked files detection to the `status` command\n  * Added warning to `validate` command when using exact-version requires\n  * Added warning once per domain when accessing insecure URLs with secure-http disabled\n  * Added a dependency on composer/ca-bundle (extracted CA bundle management to a standalone lib)\n  * Added support for empty directories when archiving to tar\n  * Added an `init` event for plugins to react to, which occurs right after a Composer instance is fully initialized\n  * Added many new detections of problems in the `why-not`/`prohibits` command to figure out why something does not get installed in the expected version\n  * Added a deprecation notice for script event listeners that use legacy script classes\n  * Fixed abandoned state not showing up if you had a package installed before it was marked abandoned\n  * Fixed --no-dev updates creating an incomplete lock file, everything is now always resolved on update\n  * Fixed partial updates in case the vendor dir was not up to date with the lock file\n\n### [1.0.3] - 2016-04-29\n\n  * Security: Fixed possible command injection from the env vars into our sudo detection\n  * Fixed interactive authentication with gitlab\n  * Fixed class name replacement in plugins\n  * Fixed classmap generation mistakenly detecting anonymous classes\n  * Fixed auto-detection of stability flags in complex constraints like `2.0-dev || ^1.5`\n  * Fixed content-length handling when redirecting to very small responses\n\n### [1.0.2] - 2016-04-21\n\n  * Fixed regression in 1.0.1 on systems with mbstring.func_overload enabled\n  * Fixed regression in 1.0.1 that made dev packages update to the latest reference even if not whitelisted in a partial update\n  * Fixed init command ignoring the COMPOSER env var for choosing the json file name\n  * Fixed error reporting bug when the dependency resolution fails\n  * Fixed handling of `$` sign in composer config command in some cases it could corrupt the json file\n\n### [1.0.1] - 2016-04-18\n\n  * Fixed URL updating when a package's URL changes, composer.lock now contains the right URL including correct reference\n  * Fixed URL updating of the origin git remote as well for packages installed as git clone\n  * Fixed binary .bat files generated from linux being incompatible with windows cmd\n  * Fixed handling of paths with trailing slashes in path repository\n  * Fixed create-project not using platform config when selecting a package\n  * Fixed self-update not showing the channel it uses to perform the update\n  * Fixed file downloads not failing loudly when the content does not match the Content-Length header\n  * Fixed secure-http detecting some malformed URLs as insecure\n  * Updated CA bundle\n\n### [1.0.0] - 2016-04-05\n\n  * Added support for bitbucket-oauth configuration\n  * Added warning when running composer as super user, set COMPOSER_ALLOW_SUPERUSER=1 to hide the warning if you really must\n  * Added PluginManager::getGlobalComposer getter to retrieve the global instance (which can be null!)\n  * Fixed dependency solver error reporting in many cases it now shows you proper errors instead of just saying a package does not exist\n  * Fixed output of failed downloads appearing as 100% done instead of Failed\n  * Fixed handling of empty directories when archiving, they are not skipped anymore\n  * Fixed installation of broken plugins corrupting the vendor state when combined with symlinked path repositories\n\n### [1.0.0-beta2] - 2016-03-27\n\n  * Break: The `install` command now turns into an `update` command automatically if you have no composer.lock. This was done only half-way before which caused inconsistencies\n  * Break: By default the `remove` command now removes dependencies as well, and --update-with-dependencies is deprecated. Use --no-update-with-dependencies to get old behavior\n  * Added support for update channels in `self-update`. All users will now update to stable builds by default. Run `self-update` with `--snapshot`, `--preview` or `--stable` to switch between update channels.\n  * Added support for SSL_CERT_DIR env var and openssl.capath ini value\n  * Added some conflict detection in `why-not` command\n  * Added suggestion of root package's suggests in `create-project` command\n  * Fixed `create-project` ignoring --ignore-platform-reqs when choosing a version of the package\n  * Fixed `search` command in a directory without composer.json\n  * Fixed path repository handling of symlinks on windows\n  * Fixed PEAR repo handling to prefer HTTPS mirrors over HTTP ones\n  * Fixed handling of Path env var on Windows, only PATH was accepted before\n  * Small error reporting and docs improvements\n\n### [1.0.0-beta1] - 2016-03-03\n\n  * Break: By default we now disable any non-secure protocols (http, git, svn). This may lead to issues if you rely on those. See `secure-http` config option.\n  * Break: `show` / `list` command now only show installed packages by default. An `--all` option is added to show all packages.\n  * Added VCS repo support for the GitLab API, see also `gitlab-oauth` and `gitlab-domains` config options\n  * Added `prohibits` / `why-not` command to show what blocks an upgrade to a given package:version pair\n  * Added --tree / -t to the `show` command to see all your installed packages in a tree view\n  * Added --interactive / -i to the `update` command, which lets you pick packages to update interactively\n  * Added `exec` command to run binaries while having bin-dir in the PATH for convenience\n  * Added --root-reqs to the `update` command to update only your direct, first degree dependencies\n  * Added `cafile` and `capath` config options to control HTTPS certificate authority\n  * Added pubkey verification of composer.phar when running self-update\n  * Added possibility to configure per-package `preferred-install` types for more flexibility between prefer-source and prefer-dist\n  * Added unpushed-changes detection when updating dependencies and in the `status` command\n  * Added COMPOSER_AUTH env var that lets you pass a json configuration like the auth.json file\n  * Added `secure-http` and `disable-tls` config options to control HTTPS/HTTP\n  * Added warning when Xdebug is enabled as it reduces performance quite a bit, hide it with COMPOSER_DISABLE_XDEBUG_WARN=1 if you must\n  * Added duplicate key detection when loading composer.json\n  * Added `sort-packages` config option to force sorting of the requirements when using the `require` command\n  * Added support for the XDG Base Directory spec on linux\n  * Added XzDownloader for xz file support\n  * Fixed SSL support to fully verify peers in all PHP versions, unsecure HTTP is also disabled by default\n  * Fixed stashing and cleaning up of untracked files when updating packages\n  * Fixed plugins being enabled after installation even when --no-plugins\n  * Many small bug fixes and additions\n\n### [1.0.0-alpha11] - 2015-11-14\n\n  * Added config.platform to let you specify what your target environment looks like and make sure you do not inadvertently install dependencies that would break it\n  * Added `exclude-from-classmap` in the autoload config that lets you ignore sub-paths of classmapped directories, or psr-0/4 directories when building optimized autoloaders\n  * Added `path` repository type to install/symlink packages from local paths\n  * Added possibility to reference script handlers from within other handlers using @script-name to reduce duplication\n  * Added `suggests` command to show what packages are suggested, use -v to see more details\n  * Added `content-hash` inside the composer.lock to restrict the warnings about outdated lock file to some specific changes in the composer.json file\n  * Added `archive-format` and `archive-dir` config options to specify default values for the archive command\n  * Added --classmap-authoritative to `install`, `update`, `require`, `remove` and `dump-autoload` commands, forcing the optimized classmap to be authoritative\n  * Added -A / --with-dependencies to the `validate` command to allow validating all your dependencies recursively\n  * Added --strict to the `validate` command to treat any warning as an error that then returns a non-zero exit code\n  * Added a dependency on composer/semver, which is the externalized lib for all the version constraints parsing and handling\n  * Added support for classmap autoloading to load plugin classes and script handlers\n  * Added `bin-compat` config option that if set to `full` will create .bat proxy for binaries even if Composer runs in a linux VM\n  * Added SPDX 2.0 support, and externalized that in a composer/spdx-licenses lib\n  * Added warnings when the classmap autoloader finds duplicate classes\n  * Added --file to the `archive` command to choose the filename\n  * Added Ctrl+C handling in create-project to cancel the operation cleanly\n  * Fixed version guessing to use ^ always, default to stable versions, and avoid versions that require a higher php version than you have\n  * Fixed the lock file switching back and forth between old and new URL when a package URL is changed and many people run updates\n  * Fixed partial updates updating things they shouldn't when the current vendor dir was out of date with the lock file\n  * Fixed PHAR file creation to be more reproducible and always generate the exact same phar file from a given source\n  * Fixed issue when checking out git branches or tags that are also the name of a file in the repo\n  * Many minor fixes and documentation additions and UX improvements\n\n### [1.0.0-alpha10] - 2015-04-14\n\n  * Break: The following event classes are deprecated and you should update your script handlers to use the new ones in type hints:\n    - `Composer\\Script\\CommandEvent` is deprecated, use `Composer\\Script\\Event`\n    - `Composer\\Script\\PackageEvent` is deprecated, use `Composer\\Installer\\PackageEvent`\n  * Break: Output is now split between stdout and stderr. Any irrelevant output to each command is on stderr as per unix best practices.\n  * Added support for npm-style semver operators (`^` and `-` ranges, ` ` = AND, `||` = OR)\n  * Added --prefer-lowest to `update` command to allow testing a package with the lowest declared dependencies\n  * Added support for parsing semver build metadata `+anything` at the end of versions\n  * Added --sort-packages option to `require` command for sorting dependencies\n  * Added --no-autoloader to `install` and `update` commands to skip autoload generation\n  * Added --list to `run-script` command to see available scripts\n  * Added --absolute to `config` command to get back absolute paths\n  * Added `classmap-authoritative` config option, if enabled only the classmap info will be used by the composer autoloader\n  * Added support for branch-alias on numeric branches\n  * Added support for the `https_proxy`/`HTTPS_PROXY` env vars used only for https URLs\n  * Added support for using real composer repos as local paths in `create-project` command\n  * Added --no-dev to `licenses` command\n  * Added support for PHP 7.0 nightly builds\n  * Fixed detection of stability when parsing multiple constraints\n  * Fixed installs from lock file containing updated composer.json requirement\n  * Fixed the autoloader suffix in vendor/autoload.php changing in every build\n  * Many minor fixes, documentation additions and UX improvements\n\n### [1.0.0-alpha9] - 2014-12-07\n\n  * Added `remove` command to do the reverse of `require`\n  * Added --ignore-platform-reqs to `install`/`update` commands to install even if you are missing a php extension or have an invalid php version\n  * Added a warning when abandoned packages are being installed\n  * Added auto-selection of the version constraint in the `require` command, which can now be used simply as `composer require foo/bar`\n  * Added ability to define custom composer commands using scripts\n  * Added `browse` command to open a browser to the given package's repo URL (or homepage with `-H`)\n  * Added an `autoload-dev` section to declare dev-only autoload rules + a --no-dev flag to dump-autoload\n  * Added an `auth.json` file, with `store-auths` config option\n  * Added a `http-basic` config option to store login/pwds to hosts\n  * Added failover to source/dist and vice-versa in case a download method fails\n  * Added --path (-P) flag to the show command to see the install path of packages\n  * Added --update-with-dependencies and --update-no-dev flags to the require command\n  * Added `optimize-autoloader` config option to force the `-o` flag from the config\n  * Added `clear-cache` command\n  * Added a GzipDownloader to download single gzipped files\n  * Added `ssh` support in the `github-protocols` config option\n  * Added `pre-dependencies-solving` and `post-dependencies-solving` events\n  * Added `pre-archive-cmd` and `post-archive-cmd` script events to the `archive` command\n  * Added a `no-api` flag to GitHub VCS repos to skip the API but still get zip downloads\n  * Added http-basic auth support for private git repos not on github\n  * Added support for autoloading `.hh` files when running HHVM\n  * Added support for PHP 5.6\n  * Added support for OTP auth when retrieving a GitHub API key\n  * Fixed isolation of `files` autoloaded scripts to ensure they can not affect anything\n  * Improved performance of solving dependencies\n  * Improved SVN and Perforce support\n  * A boatload of minor fixes, documentation additions and UX improvements\n\n### [1.0.0-alpha8] - 2014-01-06\n\n  * Break: The `install` command now has --dev enabled by default. --no-dev can be used to install without dev requirements\n  * Added `composer-plugin` package type to allow extensibility, and deprecated `composer-installer`\n  * Added `psr-4` autoloading support and deprecated `target-dir` since it is a better alternative\n  * Added --no-plugins flag to replace --no-custom-installers where available\n  * Added `global` command to operate Composer in a user-global directory\n  * Added `licenses` command to list the license of all your dependencies\n  * Added `pre-status-cmd` and `post-status-cmd` script events to the `status` command\n  * Added `post-root-package-install` and `post-create-project-cmd` script events to the `create-project` command\n  * Added `pre-autoload-dump` script event\n  * Added --rollback flag to self-update\n  * Added --no-install flag to create-project to skip installing the dependencies\n  * Added a `hhvm` platform package to require Facebook's HHVM implementation of PHP\n  * Added `github-domains` config option to allow using GitHub Enterprise with Composer's GitHub support\n  * Added `prepend-autoloader` config option to allow appending Composer's autoloader instead of the default prepend behavior\n  * Added Perforce support to the VCS repository\n  * Added a vendor/composer/autoload_files.php file that lists all files being included by the files autoloader\n  * Added support for the `no_proxy` env var and other proxy support improvements\n  * Added many robustness tweaks to make sure zip downloads work more consistently and corrupted caches are invalidated\n  * Added the release date to `composer -V` output\n  * Added `autoloader-suffix` config option to allow overriding the randomly generated autoloader class suffix\n  * Fixed BitBucket API usage\n  * Fixed parsing of inferred stability flags that are more stable than the minimum stability\n  * Fixed installation order of plugins/custom installers\n  * Fixed tilde and wildcard version constraints to be more intuitive regarding stabilities\n  * Fixed handling of target-dir changes when updating packages\n  * Improved performance of the class loader\n  * Improved memory usage and performance of solving dependencies\n  * Tons of minor bug fixes and improvements\n\n### [1.0.0-alpha7] - 2013-05-04\n\n  * Break: For forward compatibility, you should change your deployment scripts to run `composer install --no-dev`. The install command will install dev dependencies by default starting in the next release\n  * Break: The `update` command now has --dev enabled by default. --no-dev can be used to update without dev requirements, but it will create an incomplete lock file and is discouraged\n  * Break: Removed support for lock files created before 2012-09-15 due to their outdated unusable format\n  * Added `prefer-stable` flag to pick stable packages over unstable ones when possible\n  * Added `preferred-install` config option to always enable --prefer-source or --prefer-dist\n  * Added `diagnose` command to to system/network checks and find common problems\n  * Added wildcard support in the update whitelist, e.g. to update all packages of a vendor do `composer update vendor/*`\n  * Added `archive` command to archive the current directory or a given package\n  * Added `run-script` command to manually trigger scripts\n  * Added `proprietary` as valid license identifier for non-free code\n  * Added a `php-64bit` platform package that you can require to force a 64bit php\n  * Added a `lib-ICU` platform package\n  * Added a new official package type `project` for project-bootstrapping packages\n  * Added zip/dist local cache to speed up repetitive installations\n  * Added `post-autoload-dump` script event\n  * Added `Event::getDevMode` to let script handlers know if dev requirements are being installed\n  * Added `discard-changes` config option to control the default behavior when updating \"dirty\" dependencies\n  * Added `use-include-path` config option to make the autoloader look for files in the include path too\n  * Added `cache-ttl`, `cache-files-ttl` and `cache-files-maxsize` config option\n  * Added `cache-dir`, `cache-files-dir`, `cache-repo-dir` and `cache-vcs-dir` config option\n  * Added support for using http(s) authentication to non-github repos\n  * Added support for using multiple autoloaders at once (e.g. PHPUnit + application both using Composer autoloader)\n  * Added support for .inc files for classmap autoloading (legacy support, do not do this on new projects!)\n  * Added support for version constraints in show command, e.g. `composer show monolog/monolog 1.4.*`\n  * Added support for svn repositories containing packages in a deeper path (see package-path option)\n  * Added an `artifact` repository to scan a directory containing zipped packages\n  * Added --no-dev flag to `install` and `update` commands\n  * Added --stability (-s) flag to create-project to lower the required stability\n  * Added --no-progress to `install` and `update` to hide the progress indicators\n  * Added --available (-a) flag to the `show` command to display only available packages\n  * Added --name-only (-N) flag to the `show` command to show only package names (one per line, no formatting)\n  * Added --optimize-autoloader (-o) flag to optimize the autoloader from the `install` and `update` commands\n  * Added -vv and -vvv flags to get more verbose output, can be useful to debug some issues\n  * Added COMPOSER_NO_INTERACTION env var to do the equivalent of --no-interaction (should be set on build boxes, CI, PaaS)\n  * Added PHP 5.2 compatibility to the autoloader configuration files so they can be used to configure another autoloader\n  * Fixed handling of platform requirements of the root package when installing from lock\n  * Fixed handling of require-dev dependencies\n  * Fixed handling of unstable packages that should be downgraded to stable packages when updating to new version constraints\n  * Fixed parsing of the `~` operator combined with unstable versions\n  * Fixed the `require` command corrupting the json if the new requirement was invalid\n  * Fixed support of aliases used together with `<version>#<reference>` constraints\n  * Improved output of dependency solver problems by grouping versions of a package together\n  * Improved performance of classmap generation\n  * Improved mercurial support in various places\n  * Improved lock file format to minimize unnecessary diffs\n  * Improved the `config` command to support all options\n  * Improved the coverage of the `validate` command\n  * Tons of minor bug fixes and improvements\n\n### [1.0.0-alpha6] - 2012-10-23\n\n  * Schema: Added ability to pass additional options to repositories (i.e. ssh keys/client certificates to secure private repos)\n  * Schema: Added a new `~` operator that should be preferred over `>=`, see http://getcomposer.org/doc/01-basic-usage.md#package-versions\n  * Schema: Version constraints `<x.y` are assumed to be `<x.y-dev` unless specified as `<x.y-stable` to reduce confusion\n  * Added `config` command to edit/list config values, including --global switch for system config\n  * Added OAuth token support for the GitHub API\n  * Added ability to specify CLI commands as scripts in addition to PHP callbacks\n  * Added --prefer-dist flag to force installs of dev packages from zip archives instead of clones\n  * Added --working-dir (-d) flag to change the working directory\n  * Added --profile flag to all commands to display execution time and memory usage\n  * Added `github-protocols` config key to define the order of preferred protocols for github.com clones\n  * Added ability to interactively reset changes to vendor dirs while updating\n  * Added support for hg bookmarks in the hg driver\n  * Added support for svn repositories not following the standard trunk/branch/tags scheme\n  * Fixed git clones of dev versions so that you end up on a branch and not in detached HEAD\n  * Fixed \"Package not installed\" issues with --dev installs\n  * Fixed the lock file format to be a snapshot of all the package info at the time of update\n  * Fixed order of autoload requires to follow package dependencies\n  * Fixed rename() failures with \"Access denied\" on windows\n  * Improved memory usage to be more reasonable and not grow with the repository size\n  * Improved performance and memory usage of installs from composer.lock\n  * Improved performance of a few essential code paths\n  * Many bug small fixes and docs improvements\n\n### [1.0.0-alpha5] - 2012-08-18\n\n  * Added `dump-autoload` command to only regenerate the autoloader\n  * Added --optimize to `dump-autoload` to generate a more performant classmap-based autoloader for production\n  * Added `status` command to show if any source-installed dependency has local changes, use --verbose to see changed files\n  * Added --verbose flag to `install` and `update` that shows the new commits when updating source-installed dependencies\n  * Added --no-update flag to `require` to only modify the composer.json file but skip the update\n  * Added --no-custom-installers and --no-scripts to `install`, `update` and `create-project` to prevent all automatic code execution\n  * Added support for installing archives that contain only a single file\n  * Fixed APC related issues in the autoload script on high load websites\n  * Fixed installation of branches containing capital letters\n  * Fixed installation of custom dev versions/branches\n  * Improved the coverage of the `validate` command\n  * Improved PEAR scripts/binaries support\n  * Improved and fixed the output of various commands\n  * Improved error reporting on network failures and some other edge cases\n  * Various minor bug fixes and docs improvements\n\n### [1.0.0-alpha4] - 2012-07-04\n\n  * Break: The default `minimum-stability` is now `stable`, [read more](https://groups.google.com/d/topic/composer-dev/_g3ASeIFlrc/discussion)\n  * Break: Custom installers now receive the IO instance and a Composer instance in their constructor\n  * Schema: Added references for dev versions, requiring `dev-master#abcdef` for example will force the abcdef commit\n  * Schema: Added `support` key with some more metadata (email, issues, forum, wiki, irc, source)\n  * Schema: Added `!=` operator for version constraints in `require`/`require-dev`\n  * Added a recommendation for package names to be `lower-cased/with-dashes`, it will be enforced for new packages on Pacakgist\n  * Added `require` command to add a package to your requirements and install it\n  * Added a whitelist to `update`. Calling `composer update foo/bar foo/baz` allows you to update only those packages\n  * Added support for overriding repositories in the system config (define repositories in ~/.composer/config.json)\n  * Added `lib-*` packages to the platform repository, e.g. `lib-pcre` contains the pcre version\n  * Added caching of GitHub metadata (faster startup time with custom GitHub VCS repos)\n  * Added caching of SVN metadata (faster startup time with custom SVN VCS repos)\n  * Added support for file:// URLs to GitDriver\n  * Added --self flag to the `show` command to display the infos of the root package\n  * Added --dev flag to `create-project` command\n  * Added --no-scripts to `install` and `update` commands to avoid triggering the scripts\n  * Added `COMPOSER_ROOT_VERSION` env var to specify the version of the root package (fixes some edge cases)\n  * Added support for multiple custom installers in one package\n  * Added files autoloading method which requires files on every request, e.g. to load functional code\n  * Added automatic recovery for lock files that contain references to rewritten (force pushed) commits\n  * Improved PEAR repositories support and package.xml extraction\n  * Improved and fixed the output of various commands\n  * Fixed the order of installation of requirements (they are always installed before the packages requiring them)\n  * Cleaned up / refactored the dependency solver code as well as the output for unsolvable requirements\n  * Various bug fixes and docs improvements\n\n### [1.0.0-alpha3] - 2012-05-13\n\n  * Schema: Added `require-dev` for development-time requirements (tests, etc), install with --dev\n  * Schema: Added author.role to list the author's role in the project\n  * Schema: Added `minimum-stability` + `@<stability>` flags in require for restricting packages to a certain stability\n  * Schema: Removed `recommend`\n  * Schema: `suggest` is now informational and can use any description for a package, not only a constraint\n  * Break: vendor/.composer/autoload.php has been moved to vendor/autoload.php, other files are now in vendor/composer/\n  * Added caching of repository metadata (faster startup times & failover if packagist is down)\n  * Added removal of packages that are not needed anymore\n  * Added include_path support for legacy projects that are full of require_once statements\n  * Added installation notifications API to allow better statistics on Composer repositories\n  * Added support for proxies that require authentication\n  * Added support for private github repositories over https\n  * Added autoloading support for root packages that use target-dir\n  * Added awareness of the root package presence and support for it's provide/replace/conflict keys\n  * Added IOInterface::isDecorated to test for colored output support\n  * Added validation of licenses based on the [SPDX registry](https://spdx.org/licenses/)\n  * Improved repository protocol to have large cacheable parts\n  * Fixed various bugs relating to package aliasing, proxy configuration, binaries\n  * Various bug fixes and docs improvements\n\n### [1.0.0-alpha2] - 2012-04-03\n\n  * Added `create-project` command to install a project from scratch with composer\n  * Added automated `classmap` autoloading support for non-PSR-0 compliant projects\n  * Added human readable error reporting when deps can not be solved\n  * Added support for private GitHub and SVN repositories (use --no-interaction for CI)\n  * Added \"file\" downloader type to download plain files\n  * Added support for authentication with svn repositories\n  * Added autoload support for PEAR repositories\n  * Improved clones from GitHub which now automatically select between git/https/http protocols\n  * Improved `validate` command to give more feedback\n  * Improved the `search` & `show` commands output\n  * Removed dependency on filter_var\n  * Various robustness & error handling improvements, docs fixes and more bug fixes\n\n### 1.0.0-alpha1 - 2012-03-01\n\n  * Initial release\n\n[1.10.23]: https://github.com/composer/composer/compare/1.10.22...1.10.23\n[1.10.22]: https://github.com/composer/composer/compare/1.10.21...1.10.22\n[1.10.21]: https://github.com/composer/composer/compare/1.10.20...1.10.21\n[1.10.20]: https://github.com/composer/composer/compare/1.10.19...1.10.20\n[1.10.19]: https://github.com/composer/composer/compare/1.10.18...1.10.19\n[1.10.18]: https://github.com/composer/composer/compare/1.10.17...1.10.18\n[1.10.17]: https://github.com/composer/composer/compare/1.10.16...1.10.17\n[1.10.16]: https://github.com/composer/composer/compare/1.10.15...1.10.16\n[1.10.15]: https://github.com/composer/composer/compare/1.10.14...1.10.15\n[1.10.14]: https://github.com/composer/composer/compare/1.10.13...1.10.14\n[1.10.13]: https://github.com/composer/composer/compare/1.10.12...1.10.13\n[1.10.12]: https://github.com/composer/composer/compare/1.10.11...1.10.12\n[1.10.11]: https://github.com/composer/composer/compare/1.10.10...1.10.11\n[1.10.10]: https://github.com/composer/composer/compare/1.10.9...1.10.10\n[1.10.9]: https://github.com/composer/composer/compare/1.10.8...1.10.9\n[1.10.8]: https://github.com/composer/composer/compare/1.10.7...1.10.8\n[1.10.7]: https://github.com/composer/composer/compare/1.10.6...1.10.7\n[1.10.6]: https://github.com/composer/composer/compare/1.10.5...1.10.6\n[1.10.5]: https://github.com/composer/composer/compare/1.10.4...1.10.5\n[1.10.4]: https://github.com/composer/composer/compare/1.10.3...1.10.4\n[1.10.3]: https://github.com/composer/composer/compare/1.10.2...1.10.3\n[1.10.2]: https://github.com/composer/composer/compare/1.10.1...1.10.2\n[1.10.1]: https://github.com/composer/composer/compare/1.10.0...1.10.1\n[1.10.0]: https://github.com/composer/composer/compare/1.10.0-RC...1.10.0\n[1.10.0-RC]: https://github.com/composer/composer/compare/1.9.3...1.10.0-RC\n[1.9.3]: https://github.com/composer/composer/compare/1.9.2...1.9.3\n[1.9.2]: https://github.com/composer/composer/compare/1.9.1...1.9.2\n[1.9.1]: https://github.com/composer/composer/compare/1.9.0...1.9.1\n[1.9.0]: https://github.com/composer/composer/compare/1.8.6...1.9.0\n[1.8.6]: https://github.com/composer/composer/compare/1.8.5...1.8.6\n[1.8.5]: https://github.com/composer/composer/compare/1.8.4...1.8.5\n[1.8.4]: https://github.com/composer/composer/compare/1.8.3...1.8.4\n[1.8.3]: https://github.com/composer/composer/compare/1.8.2...1.8.3\n[1.8.2]: https://github.com/composer/composer/compare/1.8.1...1.8.2\n[1.8.1]: https://github.com/composer/composer/compare/1.8.0...1.8.1\n[1.8.0]: https://github.com/composer/composer/compare/1.7.3...1.8.0\n[1.7.3]: https://github.com/composer/composer/compare/1.7.2...1.7.3\n[1.7.2]: https://github.com/composer/composer/compare/1.7.1...1.7.2\n[1.7.1]: https://github.com/composer/composer/compare/1.7.0...1.7.1\n[1.7.0]: https://github.com/composer/composer/compare/1.7.0-RC...1.7.0\n[1.7.0-RC]: https://github.com/composer/composer/compare/1.6.5...1.7.0-RC\n[1.6.5]: https://github.com/composer/composer/compare/1.6.4...1.6.5\n[1.6.4]: https://github.com/composer/composer/compare/1.6.3...1.6.4\n[1.6.3]: https://github.com/composer/composer/compare/1.6.2...1.6.3\n[1.6.2]: https://github.com/composer/composer/compare/1.6.1...1.6.2\n[1.6.1]: https://github.com/composer/composer/compare/1.6.0...1.6.1\n[1.6.0]: https://github.com/composer/composer/compare/1.6.0-RC...1.6.0\n[1.6.0-RC]: https://github.com/composer/composer/compare/1.5.6...1.6.0-RC\n[1.5.6]: https://github.com/composer/composer/compare/1.5.5...1.5.6\n[1.5.5]: https://github.com/composer/composer/compare/1.5.4...1.5.5\n[1.5.4]: https://github.com/composer/composer/compare/1.5.3...1.5.4\n[1.5.3]: https://github.com/composer/composer/compare/1.5.2...1.5.3\n[1.5.2]: https://github.com/composer/composer/compare/1.5.1...1.5.2\n[1.5.1]: https://github.com/composer/composer/compare/1.5.0...1.5.1\n[1.5.0]: https://github.com/composer/composer/compare/1.4.3...1.5.0\n[1.4.3]: https://github.com/composer/composer/compare/1.4.2...1.4.3\n[1.4.2]: https://github.com/composer/composer/compare/1.4.1...1.4.2\n[1.4.1]: https://github.com/composer/composer/compare/1.4.0...1.4.1\n[1.4.0]: https://github.com/composer/composer/compare/1.3.3...1.4.0\n[1.3.3]: https://github.com/composer/composer/compare/1.3.2...1.3.3\n[1.3.2]: https://github.com/composer/composer/compare/1.3.1...1.3.2\n[1.3.1]: https://github.com/composer/composer/compare/1.3.0...1.3.1\n[1.3.0]: https://github.com/composer/composer/compare/1.3.0-RC...1.3.0\n[1.3.0-RC]: https://github.com/composer/composer/compare/1.2.4...1.3.0-RC\n[1.2.4]: https://github.com/composer/composer/compare/1.2.3...1.2.4\n[1.2.3]: https://github.com/composer/composer/compare/1.2.2...1.2.3\n[1.2.2]: https://github.com/composer/composer/compare/1.2.1...1.2.2\n[1.2.1]: https://github.com/composer/composer/compare/1.2.0...1.2.1\n[1.2.0]: https://github.com/composer/composer/compare/1.2.0-RC...1.2.0\n[1.2.0-RC]: https://github.com/composer/composer/compare/1.1.3...1.2.0-RC\n[1.1.3]: https://github.com/composer/composer/compare/1.1.2...1.1.3\n[1.1.2]: https://github.com/composer/composer/compare/1.1.1...1.1.2\n[1.1.1]: https://github.com/composer/composer/compare/1.1.0...1.1.1\n[1.1.0]: https://github.com/composer/composer/compare/1.0.3...1.1.0\n[1.1.0-RC]: https://github.com/composer/composer/compare/1.0.3...1.1.0-RC\n[1.0.3]: https://github.com/composer/composer/compare/1.0.2...1.0.3\n[1.0.2]: https://github.com/composer/composer/compare/1.0.1...1.0.2\n[1.0.1]: https://github.com/composer/composer/compare/1.0.0...1.0.1\n[1.0.0]: https://github.com/composer/composer/compare/1.0.0-beta2...1.0.0\n[1.0.0-beta2]: https://github.com/composer/composer/compare/1.0.0-beta1...1.0.0-beta2\n[1.0.0-beta1]: https://github.com/composer/composer/compare/1.0.0-alpha11...1.0.0-beta1\n[1.0.0-alpha11]: https://github.com/composer/composer/compare/1.0.0-alpha10...1.0.0-alpha11\n[1.0.0-alpha10]: https://github.com/composer/composer/compare/1.0.0-alpha9...1.0.0-alpha10\n[1.0.0-alpha9]: https://github.com/composer/composer/compare/1.0.0-alpha8...1.0.0-alpha9\n[1.0.0-alpha8]: https://github.com/composer/composer/compare/1.0.0-alpha7...1.0.0-alpha8\n[1.0.0-alpha7]: https://github.com/composer/composer/compare/1.0.0-alpha6...1.0.0-alpha7\n[1.0.0-alpha6]: https://github.com/composer/composer/compare/1.0.0-alpha5...1.0.0-alpha6\n[1.0.0-alpha5]: https://github.com/composer/composer/compare/1.0.0-alpha4...1.0.0-alpha5\n[1.0.0-alpha4]: https://github.com/composer/composer/compare/1.0.0-alpha3...1.0.0-alpha4\n[1.0.0-alpha3]: https://github.com/composer/composer/compare/1.0.0-alpha2...1.0.0-alpha3\n[1.0.0-alpha2]: https://github.com/composer/composer/compare/1.0.0-alpha1...1.0.0-alpha2\n", "<?php\n\n/*\n * This file is part of Composer.\n *\n * (c) Nils Adermann <naderman@naderman.de>\n *     Jordi Boggiano <j.boggiano@seld.be>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nnamespace Composer\\Command;\n\nuse Composer\\Package\\CompletePackageInterface;\nuse Composer\\Repository\\RepositoryInterface;\nuse Composer\\Repository\\ArrayRepository;\nuse Composer\\Repository\\RepositoryFactory;\nuse Composer\\Util\\Platform;\nuse Composer\\Util\\ProcessExecutor;\nuse Symfony\\Component\\Console\\Input\\InputArgument;\nuse Symfony\\Component\\Console\\Input\\InputOption;\nuse Symfony\\Component\\Console\\Input\\InputInterface;\nuse Symfony\\Component\\Console\\Output\\OutputInterface;\n\n/**\n * @author Robert Sch\u00f6nthal <seroscho@googlemail.com>\n */\nclass HomeCommand extends BaseCommand\n{\n    /**\n     * {@inheritDoc}\n     */\n    protected function configure()\n    {\n        $this\n            ->setName('browse')\n            ->setAliases(array('home'))\n            ->setDescription('Opens the package\\'s repository URL or homepage in your browser.')\n            ->setDefinition(array(\n                new InputArgument('packages', InputArgument::IS_ARRAY, 'Package(s) to browse to.'),\n                new InputOption('homepage', 'H', InputOption::VALUE_NONE, 'Open the homepage instead of the repository URL.'),\n                new InputOption('show', 's', InputOption::VALUE_NONE, 'Only show the homepage or repository URL.'),\n            ))\n            ->setHelp(\n                <<<EOT\nThe home command opens or shows a package's repository URL or\nhomepage in your default browser.\n\nTo open the homepage by default, use -H or --homepage.\nTo show instead of open the repository or homepage URL, use -s or --show.\n\nRead more at https://getcomposer.org/doc/03-cli.md#browse-home\nEOT\n            );\n    }\n\n    /**\n     * {@inheritDoc}\n     */\n    protected function execute(InputInterface $input, OutputInterface $output)\n    {\n        $repos = $this->initializeRepos();\n        $io = $this->getIO();\n        $return = 0;\n\n        $packages = $input->getArgument('packages');\n        if (!$packages) {\n            $io->writeError('No package specified, opening homepage for the root package');\n            $packages = array($this->getComposer()->getPackage()->getName());\n        }\n\n        foreach ($packages as $packageName) {\n            $handled = false;\n            $packageExists = false;\n            foreach ($repos as $repo) {\n                foreach ($repo->findPackages($packageName) as $package) {\n                    $packageExists = true;\n                    if ($package instanceof CompletePackageInterface && $this->handlePackage($package, $input->getOption('homepage'), $input->getOption('show'))) {\n                        $handled = true;\n                        break 2;\n                    }\n                }\n            }\n\n            if (!$packageExists) {\n                $return = 1;\n                $io->writeError('<warning>Package '.$packageName.' not found</warning>');\n            }\n\n            if (!$handled) {\n                $return = 1;\n                $io->writeError('<warning>'.($input->getOption('homepage') ? 'Invalid or missing homepage' : 'Invalid or missing repository URL').' for '.$packageName.'</warning>');\n            }\n        }\n\n        return $return;\n    }\n\n    private function handlePackage(CompletePackageInterface $package, $showHomepage, $showOnly)\n    {\n        $support = $package->getSupport();\n        $url = isset($support['source']) ? $support['source'] : $package->getSourceUrl();\n        if (!$url || $showHomepage) {\n            $url = $package->getHomepage();\n        }\n\n        if (!$url || !filter_var($url, FILTER_VALIDATE_URL)) {\n            return false;\n        }\n\n        if ($showOnly) {\n            $this->getIO()->write(sprintf('<info>%s</info>', $url));\n        } else {\n            $this->openBrowser($url);\n        }\n\n        return true;\n    }\n\n    /**\n     * opens a url in your system default browser\n     *\n     * @param string $url\n     */\n    private function openBrowser($url)\n    {\n        $url = ProcessExecutor::escape($url);\n\n        $process = new ProcessExecutor($this->getIO());\n        if (Platform::isWindows()) {\n            return $process->execute('start \"web\" explorer ' . $url, $output);\n        }\n\n        $linux = $process->execute('which xdg-open', $output);\n        $osx = $process->execute('which open', $output);\n\n        if (0 === $linux) {\n            $process->execute('xdg-open ' . $url, $output);\n        } elseif (0 === $osx) {\n            $process->execute('open ' . $url, $output);\n        } else {\n            $this->getIO()->writeError('No suitable browser opening command found, open yourself: ' . $url);\n        }\n    }\n\n    /**\n     * Initializes repositories\n     *\n     * Returns an array of repos in order they should be checked in\n     *\n     * @return RepositoryInterface[]\n     */\n    private function initializeRepos()\n    {\n        $composer = $this->getComposer(false);\n\n        if ($composer) {\n            return array_merge(\n                array(new ArrayRepository(array($composer->getPackage()))), // root package\n                array($composer->getRepositoryManager()->getLocalRepository()), // installed packages\n                $composer->getRepositoryManager()->getRepositories() // remotes\n            );\n        }\n\n        return RepositoryFactory::defaultRepos($this->getIO());\n    }\n}\n", "<?php\n\n/*\n * This file is part of Composer.\n *\n * (c) Nils Adermann <naderman@naderman.de>\n *     Jordi Boggiano <j.boggiano@seld.be>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nnamespace Composer\\Util;\n\nuse Composer\\IO\\IOInterface;\nuse Symfony\\Component\\Process\\Process;\nuse Symfony\\Component\\Process\\ProcessUtils;\n\n/**\n * @author Robert Sch\u00f6nthal <seroscho@googlemail.com>\n */\nclass ProcessExecutor\n{\n    protected static $timeout = 300;\n\n    protected $captureOutput;\n    protected $errorOutput;\n    protected $io;\n\n    public function __construct(IOInterface $io = null)\n    {\n        $this->io = $io;\n    }\n\n    /**\n     * runs a process on the commandline\n     *\n     * @param  string $command the command to execute\n     * @param  mixed  $output  the output will be written into this var if passed by ref\n     *                         if a callable is passed it will be used as output handler\n     * @param  string $cwd     the working directory\n     * @return int    statuscode\n     */\n    public function execute($command, &$output = null, $cwd = null)\n    {\n        if ($this->io && $this->io->isDebug()) {\n            $safeCommand = preg_replace_callback('{://(?P<user>[^:/\\s]+):(?P<password>[^@\\s/]+)@}i', function ($m) {\n                // if the username looks like a long (12char+) hex string, or a modern github token (e.g. ghp_xxx) we obfuscate that\n                if (preg_match('{^([a-f0-9]{12,}|gh[a-z]_[a-zA-Z0-9_]+)$}', $m['user'])) {\n                    return '://***:***@';\n                }\n\n                return '://'.$m['user'].':***@';\n            }, $command);\n            $safeCommand = preg_replace(\"{--password (.*[^\\\\\\\\]\\') }\", '--password \\'***\\' ', $safeCommand);\n            $this->io->writeError('Executing command ('.($cwd ?: 'CWD').'): '.$safeCommand);\n        }\n\n        // make sure that null translate to the proper directory in case the dir is a symlink\n        // and we call a git command, because msysgit does not handle symlinks properly\n        if (null === $cwd && Platform::isWindows() && false !== strpos($command, 'git') && getcwd()) {\n            $cwd = realpath(getcwd());\n        }\n\n        if (null !== $cwd && !is_dir($cwd)) {\n            throw new \\RuntimeException('The given CWD for the process does not exist: '.$cwd);\n        }\n\n        $this->captureOutput = func_num_args() > 1;\n        $this->errorOutput = null;\n\n        // TODO in v3, commands should be passed in as arrays of cmd + args\n        if (method_exists('Symfony\\Component\\Process\\Process', 'fromShellCommandline')) {\n            $process = Process::fromShellCommandline($command, $cwd, null, null, static::getTimeout());\n        } else {\n            $process = new Process($command, $cwd, null, null, static::getTimeout());\n        }\n\n        $callback = is_callable($output) ? $output : array($this, 'outputHandler');\n        $process->run($callback);\n\n        if ($this->captureOutput && !is_callable($output)) {\n            $output = $process->getOutput();\n        }\n\n        $this->errorOutput = $process->getErrorOutput();\n\n        return $process->getExitCode();\n    }\n\n    public function splitLines($output)\n    {\n        $output = trim($output);\n\n        return ((string) $output === '') ? array() : preg_split('{\\r?\\n}', $output);\n    }\n\n    /**\n     * Get any error output from the last command\n     *\n     * @return string\n     */\n    public function getErrorOutput()\n    {\n        return $this->errorOutput;\n    }\n\n    public function outputHandler($type, $buffer)\n    {\n        if ($this->captureOutput) {\n            return;\n        }\n\n        if (null === $this->io) {\n            echo $buffer;\n\n            return;\n        }\n\n        if (method_exists($this->io, 'writeRaw')) {\n            if (Process::ERR === $type) {\n                $this->io->writeErrorRaw($buffer, false);\n            } else {\n                $this->io->writeRaw($buffer, false);\n            }\n        } else {\n            if (Process::ERR === $type) {\n                $this->io->writeError($buffer, false);\n            } else {\n                $this->io->write($buffer, false);\n            }\n        }\n    }\n\n    public static function getTimeout()\n    {\n        return static::$timeout;\n    }\n\n    public static function setTimeout($timeout)\n    {\n        static::$timeout = $timeout;\n    }\n\n    /**\n     * Escapes a string to be used as a shell argument.\n     *\n     * @param string $argument The argument that will be escaped\n     *\n     * @return string The escaped argument\n     */\n    public static function escape($argument)\n    {\n        return self::escapeArgument($argument);\n    }\n\n    /**\n     * Copy of Symfony's Process::escapeArgument() which is private\n     *\n     * @param string $argument\n     *\n     * @return string\n     */\n    private static function escapeArgument($argument)\n    {\n        if ('' === $argument || null === $argument) {\n            return '\"\"';\n        }\n        if ('\\\\' !== \\DIRECTORY_SEPARATOR) {\n            return \"'\".str_replace(\"'\", \"'\\\\''\", $argument).\"'\";\n        }\n        if (false !== strpos($argument, \"\\0\")) {\n            $argument = str_replace(\"\\0\", '?', $argument);\n        }\n        if (!preg_match('/[\\/()%!^\"<>&|\\s]/', $argument)) {\n            return $argument;\n        }\n        $argument = preg_replace('/(\\\\\\\\+)$/', '$1$1', $argument);\n\n        return '\"'.str_replace(array('\"', '^', '%', '!', \"\\n\"), array('\"\"', '\"^^\"', '\"^%\"', '\"^!\"', '!LF!'), $argument).'\"';\n    }\n\n    private static function isSurroundedBy($arg, $char)\n    {\n        return 2 < strlen($arg) && $char === $arg[0] && $char === $arg[strlen($arg) - 1];\n    }\n}\n", "<?php\n\n/*\n * This file is part of Composer.\n *\n * (c) Nils Adermann <naderman@naderman.de>\n *     Jordi Boggiano <j.boggiano@seld.be>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nnamespace Composer\\Test\\Downloader;\n\nuse Composer\\Downloader\\GitDownloader;\nuse Composer\\Config;\nuse Composer\\Test\\TestCase;\nuse Composer\\Util\\Filesystem;\nuse Composer\\Util\\Platform;\nuse Composer\\Util\\ProcessExecutor;\nuse Composer\\Util\\Git as GitUtil;\n\nclass GitDownloaderTest extends TestCase\n{\n    /** @var Filesystem */\n    private $fs;\n    /** @var string */\n    private $workingDir;\n\n    protected function setUp()\n    {\n        $this->skipIfNotExecutable('git');\n\n        $this->initGitVersion('1.0.0');\n\n        $this->fs = new Filesystem;\n        $this->workingDir = $this->getUniqueTmpDirectory();\n    }\n\n    protected function tearDown()\n    {\n        if (is_dir($this->workingDir)) {\n            $this->fs->removeDirectory($this->workingDir);\n        }\n\n        $this->initGitVersion(false);\n    }\n\n    private function initGitVersion($version)\n    {\n        // reset the static version cache\n        $refl = new \\ReflectionProperty('Composer\\Util\\Git', 'version');\n        $refl->setAccessible(true);\n        $refl->setValue(null, $version);\n    }\n\n    protected function setupConfig($config = null)\n    {\n        if (!$config) {\n            $config = new Config();\n        }\n        if (!$config->has('home')) {\n            $tmpDir = realpath(sys_get_temp_dir()).DIRECTORY_SEPARATOR.'cmptest-'.md5(uniqid('', true));\n            $config->merge(array('config' => array('home' => $tmpDir)));\n        }\n\n        return $config;\n    }\n\n    protected function getDownloaderMock($io = null, $config = null, $executor = null, $filesystem = null)\n    {\n        $io = $io ?: $this->getMockBuilder('Composer\\IO\\IOInterface')->getMock();\n        $executor = $executor ?: $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $filesystem = $filesystem ?: $this->getMockBuilder('Composer\\Util\\Filesystem')->getMock();\n        $config = $this->setupConfig($config);\n\n        return new GitDownloader($io, $config, $executor, $filesystem);\n    }\n\n    /**\n     * @expectedException \\InvalidArgumentException\n     */\n    public function testDownloadForPackageWithoutSourceReference()\n    {\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->once())\n            ->method('getSourceReference')\n            ->will($this->returnValue(null));\n\n        $downloader = $this->getDownloaderMock();\n        $downloader->download($packageMock, '/path');\n    }\n\n    public function testDownload()\n    {\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('1234567890123456789012345678901234567890'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://example.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrl')\n            ->will($this->returnValue('https://example.com/composer/composer'));\n        $packageMock->expects($this->any())\n            ->method('getPrettyVersion')\n            ->will($this->returnValue('dev-master'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n\n        $expectedGitCommand = $this->winCompat(\"git clone --no-checkout -- 'https://example.com/composer/composer' 'composerPath' && cd 'composerPath' && git remote add composer -- 'https://example.com/composer/composer' && git fetch composer && git remote set-url origin -- 'https://example.com/composer/composer' && git remote set-url composer -- 'https://example.com/composer/composer'\");\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git branch -r\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(2))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git checkout 'master' --\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(3))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git reset --hard '1234567890123456789012345678901234567890' --\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $downloader = $this->getDownloaderMock(null, null, $processExecutor);\n        $downloader->download($packageMock, 'composerPath');\n    }\n\n    public function testDownloadWithCache()\n    {\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('1234567890123456789012345678901234567890'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://example.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrl')\n            ->will($this->returnValue('https://example.com/composer/composer'));\n        $packageMock->expects($this->any())\n            ->method('getPrettyVersion')\n            ->will($this->returnValue('dev-master'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n\n        $this->initGitVersion('2.17.0');\n\n        $config = new Config;\n        $this->setupConfig($config);\n        $cachePath = $config->get('cache-vcs-dir').'/'.preg_replace('{[^a-z0-9.]}i', '-', 'https://example.com/composer/composer').'/';\n\n        $filesystem = new \\Composer\\Util\\Filesystem;\n        $filesystem->removeDirectory($cachePath);\n\n        $expectedGitCommand = $this->winCompat(sprintf(\"git clone --mirror -- 'https://example.com/composer/composer' '%s'\", $cachePath));\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnCallback(function () use ($cachePath) {\n                @mkdir($cachePath, 0777, true);\n\n                return 0;\n            }));\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo('git rev-parse --git-dir'), $this->anything(), $this->equalTo($this->winCompat($cachePath)))\n            ->will($this->returnCallback(function ($command, &$output = null) {\n                $output = '.';\n\n                return 0;\n            }));\n        $processExecutor->expects($this->at(2))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat('git rev-parse --quiet --verify \\'1234567890123456789012345678901234567890^{commit}\\'')), $this->equalTo(null), $this->equalTo($this->winCompat($cachePath)))\n            ->will($this->returnValue(0));\n\n        $expectedGitCommand = $this->winCompat(sprintf(\"git clone --no-checkout '%1\\$s' 'composerPath' --dissociate --reference '%1\\$s' && cd 'composerPath' && git remote set-url origin -- 'https://example.com/composer/composer' && git remote add composer -- 'https://example.com/composer/composer'\", $cachePath));\n        $processExecutor->expects($this->at(3))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(4))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git branch -r\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(5))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git checkout 'master' --\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(6))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git reset --hard '1234567890123456789012345678901234567890' --\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $downloader = $this->getDownloaderMock(null, $config, $processExecutor);\n        $downloader->download($packageMock, 'composerPath');\n        @rmdir($cachePath);\n    }\n\n    public function testDownloadUsesVariousProtocolsAndSetsPushUrlForGithub()\n    {\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/mirrors/composer', 'https://github.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrl')\n            ->will($this->returnValue('https://github.com/composer/composer'));\n        $packageMock->expects($this->any())\n            ->method('getPrettyVersion')\n            ->will($this->returnValue('1.0.0'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n\n        $expectedGitCommand = $this->winCompat(\"git clone --no-checkout -- 'https://github.com/mirrors/composer' 'composerPath' && cd 'composerPath' && git remote add composer -- 'https://github.com/mirrors/composer' && git fetch composer && git remote set-url origin -- 'https://github.com/mirrors/composer' && git remote set-url composer -- 'https://github.com/mirrors/composer'\");\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnValue(1));\n\n        $processExecutor->expects($this->at(1))\n            ->method('getErrorOutput')\n            ->with()\n            ->will($this->returnValue('Error1'));\n\n        $expectedGitCommand = $this->winCompat(\"git clone --no-checkout -- 'git@github.com:mirrors/composer' 'composerPath' && cd 'composerPath' && git remote add composer -- 'git@github.com:mirrors/composer' && git fetch composer && git remote set-url origin -- 'git@github.com:mirrors/composer' && git remote set-url composer -- 'git@github.com:mirrors/composer'\");\n        $processExecutor->expects($this->at(2))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnValue(0));\n\n        $expectedGitCommand = $this->winCompat(\"git remote set-url origin -- 'https://github.com/composer/composer'\");\n        $processExecutor->expects($this->at(3))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $expectedGitCommand = $this->winCompat(\"git remote set-url --push origin -- 'git@github.com:composer/composer.git'\");\n        $processExecutor->expects($this->at(4))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(5))\n            ->method('execute')\n            ->with($this->equalTo('git branch -r'))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->at(6))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git checkout 'ref' -- && git reset --hard 'ref' --\")), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $downloader = $this->getDownloaderMock(null, new Config(), $processExecutor);\n        $downloader->download($packageMock, 'composerPath');\n    }\n\n    public function pushUrlProvider()\n    {\n        return array(\n            // ssh proto should use git@ all along\n            array(array('ssh'),                 'git@github.com:composer/composer',     'git@github.com:composer/composer.git'),\n            // auto-proto uses git@ by default for push url, but not fetch\n            array(array('https', 'ssh', 'git'), 'https://github.com/composer/composer', 'git@github.com:composer/composer.git'),\n            // if restricted to https then push url is not overwritten to git@\n            array(array('https'),               'https://github.com/composer/composer', 'https://github.com/composer/composer.git'),\n        );\n    }\n\n    /**\n     * @dataProvider pushUrlProvider\n     */\n    public function testDownloadAndSetPushUrlUseCustomVariousProtocolsForGithub($protocols, $url, $pushUrl)\n    {\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrl')\n            ->will($this->returnValue('https://github.com/composer/composer'));\n        $packageMock->expects($this->any())\n            ->method('getPrettyVersion')\n            ->will($this->returnValue('1.0.0'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n\n        $expectedGitCommand = $this->winCompat(\"git clone --no-checkout -- '{$url}' 'composerPath' && cd 'composerPath' && git remote add composer -- '{$url}' && git fetch composer && git remote set-url origin -- '{$url}' && git remote set-url composer -- '{$url}'\");\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnValue(0));\n\n        $expectedGitCommand = $this->winCompat(\"git remote set-url --push origin -- '{$pushUrl}'\");\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand), $this->equalTo(null), $this->equalTo($this->winCompat('composerPath')))\n            ->will($this->returnValue(0));\n\n        $processExecutor->expects($this->exactly(4))\n            ->method('execute')\n            ->will($this->returnValue(0));\n\n        $config = new Config();\n        $config->merge(array('config' => array('github-protocols' => $protocols)));\n\n        $downloader = $this->getDownloaderMock(null, $config, $processExecutor);\n        $downloader->download($packageMock, 'composerPath');\n    }\n\n    /**\n     * @expectedException \\RuntimeException\n     */\n    public function testDownloadThrowsRuntimeExceptionIfGitCommandFails()\n    {\n        $expectedGitCommand = $this->winCompat(\"git clone --no-checkout -- 'https://example.com/composer/composer' 'composerPath' && cd 'composerPath' && git remote add composer -- 'https://example.com/composer/composer' && git fetch composer && git remote set-url origin -- 'https://example.com/composer/composer' && git remote set-url composer -- 'https://example.com/composer/composer'\");\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://example.com/composer/composer')));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitCommand))\n            ->will($this->returnValue(1));\n\n        $downloader = $this->getDownloaderMock(null, null, $processExecutor);\n        $downloader->download($packageMock, 'composerPath');\n    }\n\n    /**\n     * @expectedException \\InvalidArgumentException\n     */\n    public function testUpdateforPackageWithoutSourceReference()\n    {\n        $initialPackageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $sourcePackageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $sourcePackageMock->expects($this->once())\n            ->method('getSourceReference')\n            ->will($this->returnValue(null));\n\n        $downloader = $this->getDownloaderMock();\n        $downloader->update($initialPackageMock, $sourcePackageMock, '/path');\n    }\n\n    public function testUpdate()\n    {\n        $expectedGitUpdateCommand = $this->winCompat(\"(git remote set-url composer -- 'https://github.com/composer/composer' && git rev-parse --quiet --verify 'ref^{commit}' || (git fetch composer && git fetch --tags composer)) && git remote set-url composer -- 'https://github.com/composer/composer'\");\n\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('1.0.0.0'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git show-ref --head -d\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git status --porcelain --untracked-files=no\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(2))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(3))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(4))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat($expectedGitUpdateCommand)), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(5))\n            ->method('execute')\n            ->with($this->equalTo('git branch -r'))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(6))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git checkout 'ref' -- && git reset --hard 'ref' --\")), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n\n        $this->fs->ensureDirectoryExists($this->workingDir.'/.git');\n        $downloader = $this->getDownloaderMock(null, new Config(), $processExecutor);\n        $downloader->update($packageMock, $packageMock, $this->workingDir);\n    }\n\n    public function testUpdateWithNewRepoUrl()\n    {\n        $expectedGitUpdateCommand = $this->winCompat(\"(git remote set-url composer -- 'https://github.com/composer/composer' && git rev-parse --quiet --verify 'ref^{commit}' || (git fetch composer && git fetch --tags composer)) && git remote set-url composer -- 'https://github.com/composer/composer'\");\n\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrl')\n            ->will($this->returnValue('https://github.com/composer/composer'));\n        $packageMock->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('1.0.0.0'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git show-ref --head -d\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git status --porcelain --untracked-files=no\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(2))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnCallback(function ($cmd, &$output, $cwd) {\n                $output = 'origin https://github.com/old/url (fetch)\norigin https://github.com/old/url (push)\ncomposer https://github.com/old/url (fetch)\ncomposer https://github.com/old/url (push)\n';\n\n                return 0;\n            }));\n        $processExecutor->expects($this->at(3))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(4))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat($expectedGitUpdateCommand)), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(5))\n            ->method('execute')\n            ->with($this->equalTo('git branch -r'))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(6))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git checkout 'ref' -- && git reset --hard 'ref' --\")), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(7))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote set-url origin -- 'https://github.com/composer/composer'\")), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(8))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote set-url --push origin -- 'git@github.com:composer/composer.git'\")), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n\n        $this->fs->ensureDirectoryExists($this->workingDir.'/.git');\n        $downloader = $this->getDownloaderMock(null, new Config(), $processExecutor);\n        $downloader->update($packageMock, $packageMock, $this->workingDir);\n    }\n\n    /**\n     * @group failing\n     * @expectedException \\RuntimeException\n     */\n    public function testUpdateThrowsRuntimeExceptionIfGitCommandFails()\n    {\n        $expectedGitUpdateCommand = $this->winCompat(\"(git remote set-url composer -- 'https://github.com/composer/composer' && git rev-parse --quiet --verify 'ref^{commit}' || (git fetch composer && git fetch --tags composer)) && git remote set-url composer -- 'https://github.com/composer/composer'\");\n\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/composer/composer')));\n        $packageMock->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('1.0.0.0'));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git show-ref --head -d\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git status --porcelain --untracked-files=no\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(2))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(3))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(4))\n            ->method('execute')\n            ->with($this->equalTo($expectedGitUpdateCommand))\n            ->will($this->returnValue(1));\n\n        $this->fs->ensureDirectoryExists($this->workingDir.'/.git');\n        $downloader = $this->getDownloaderMock(null, new Config(), $processExecutor);\n        $downloader->update($packageMock, $packageMock, $this->workingDir);\n    }\n\n    public function testUpdateDoesntThrowsRuntimeExceptionIfGitCommandFailsAtFirstButIsAbleToRecover()\n    {\n        $expectedFirstGitUpdateCommand = $this->winCompat(\"(git remote set-url composer -- \\\"\\\" && git rev-parse --quiet --verify 'ref^{commit}' || (git fetch composer && git fetch --tags composer)) && git remote set-url composer -- \\\"\\\"\");\n        $expectedSecondGitUpdateCommand = $this->winCompat(\"(git remote set-url composer -- 'https://github.com/composer/composer' && git rev-parse --quiet --verify 'ref^{commit}' || (git fetch composer && git fetch --tags composer)) && git remote set-url composer -- 'https://github.com/composer/composer'\");\n\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $packageMock->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $packageMock->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('1.0.0.0'));\n        $packageMock->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('/foo/bar', 'https://github.com/composer/composer')));\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->at(0))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git show-ref --head -d\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(1))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git status --porcelain --untracked-files=no\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(2))\n           ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(3))\n           ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(4))\n            ->method('execute')\n            ->with($this->equalTo($expectedFirstGitUpdateCommand))\n            ->will($this->returnValue(1));\n        $processExecutor->expects($this->at(6))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git --version\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(7))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(8))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git remote -v\")))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(9))\n            ->method('execute')\n            ->with($this->equalTo($expectedSecondGitUpdateCommand))\n            ->will($this->returnValue(0));\n        $processExecutor->expects($this->at(11))\n            ->method('execute')\n            ->with($this->equalTo($this->winCompat(\"git checkout 'ref' -- && git reset --hard 'ref' --\")), $this->equalTo(null), $this->equalTo($this->winCompat($this->workingDir)))\n            ->will($this->returnValue(0));\n\n        $this->fs->ensureDirectoryExists($this->workingDir.'/.git');\n        $downloader = $this->getDownloaderMock(null, new Config(), $processExecutor);\n        $downloader->update($packageMock, $packageMock, $this->workingDir);\n    }\n\n    public function testDowngradeShowsAppropriateMessage()\n    {\n        $oldPackage = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $oldPackage->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('1.2.0.0'));\n        $oldPackage->expects($this->any())\n            ->method('getFullPrettyVersion')\n            ->will($this->returnValue('1.2.0'));\n        $oldPackage->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $oldPackage->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('/foo/bar', 'https://github.com/composer/composer')));\n\n        $newPackage = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $newPackage->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $newPackage->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/composer/composer')));\n        $newPackage->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('1.0.0.0'));\n        $newPackage->expects($this->any())\n            ->method('getFullPrettyVersion')\n            ->will($this->returnValue('1.0.0'));\n\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->any())\n            ->method('execute')\n            ->will($this->returnValue(0));\n\n        $ioMock = $this->getMockBuilder('Composer\\IO\\IOInterface')->getMock();\n        $ioMock->expects($this->at(0))\n            ->method('writeError')\n            ->with($this->stringContains('Downgrading'));\n\n        $this->fs->ensureDirectoryExists($this->workingDir.'/.git');\n        $downloader = $this->getDownloaderMock($ioMock, null, $processExecutor);\n        $downloader->update($oldPackage, $newPackage, $this->workingDir);\n    }\n\n    public function testNotUsingDowngradingWithReferences()\n    {\n        $oldPackage = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $oldPackage->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('dev-ref'));\n        $oldPackage->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $oldPackage->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('/foo/bar', 'https://github.com/composer/composer')));\n\n        $newPackage = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $newPackage->expects($this->any())\n            ->method('getSourceReference')\n            ->will($this->returnValue('ref'));\n        $newPackage->expects($this->any())\n            ->method('getSourceUrls')\n            ->will($this->returnValue(array('https://github.com/composer/composer')));\n        $newPackage->expects($this->any())\n            ->method('getVersion')\n            ->will($this->returnValue('dev-ref2'));\n\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->any())\n            ->method('execute')\n            ->will($this->returnValue(0));\n\n        $ioMock = $this->getMockBuilder('Composer\\IO\\IOInterface')->getMock();\n        $ioMock->expects($this->at(0))\n            ->method('writeError')\n            ->with($this->stringContains('updating'));\n\n        $this->fs->ensureDirectoryExists($this->workingDir.'/.git');\n        $downloader = $this->getDownloaderMock($ioMock, null, $processExecutor);\n        $downloader->update($oldPackage, $newPackage, $this->workingDir);\n    }\n\n    public function testRemove()\n    {\n        $expectedGitResetCommand = $this->winCompat(\"cd 'composerPath' && git status --porcelain --untracked-files=no\");\n\n        $packageMock = $this->getMockBuilder('Composer\\Package\\PackageInterface')->getMock();\n        $processExecutor = $this->getMockBuilder('Composer\\Util\\ProcessExecutor')->getMock();\n        $processExecutor->expects($this->any())\n            ->method('execute')\n            ->with($this->equalTo($expectedGitResetCommand))\n            ->will($this->returnValue(0));\n        $filesystem = $this->getMockBuilder('Composer\\Util\\Filesystem')->getMock();\n        $filesystem->expects($this->once())\n            ->method('removeDirectory')\n            ->with($this->equalTo('composerPath'))\n            ->will($this->returnValue(true));\n\n        $downloader = $this->getDownloaderMock(null, null, $processExecutor, $filesystem);\n        $downloader->remove($packageMock, 'composerPath');\n    }\n\n    public function testGetInstallationSource()\n    {\n        $downloader = $this->getDownloaderMock();\n\n        $this->assertEquals('source', $downloader->getInstallationSource());\n    }\n\n    private function winCompat($cmd)\n    {\n        if (Platform::isWindows()) {\n            $cmd = str_replace('cd ', 'cd /D ', $cmd);\n            $cmd = str_replace('composerPath', getcwd().'/composerPath', $cmd);\n\n            return strtr($cmd, \"'\", '\"');\n        }\n\n        return $cmd;\n    }\n}\n", "<?php\n\n/*\n * This file is part of Composer.\n *\n * (c) Nils Adermann <naderman@naderman.de>\n *     Jordi Boggiano <j.boggiano@seld.be>\n *\n * For the full copyright and license information, please view the LICENSE\n * file that was distributed with this source code.\n */\n\nnamespace Composer\\Test\\Util;\n\nuse Composer\\Config;\nuse Composer\\IO\\NullIO;\nuse Composer\\Util\\Platform;\nuse Composer\\Util\\Svn;\nuse Composer\\Test\\TestCase;\n\nclass SvnTest extends TestCase\n{\n    /**\n     * Test the credential string.\n     *\n     * @param string $url    The SVN url.\n     * @param string $expect The expectation for the test.\n     *\n     * @dataProvider urlProvider\n     */\n    public function testCredentials($url, $expect)\n    {\n        $svn = new Svn($url, new NullIO, new Config());\n        $reflMethod = new \\ReflectionMethod('Composer\\\\Util\\\\Svn', 'getCredentialString');\n        $reflMethod->setAccessible(true);\n\n        $this->assertEquals($expect, $reflMethod->invoke($svn));\n    }\n\n    /**\n     * Provide some examples for {@self::testCredentials()}.\n     *\n     * @return array\n     */\n    public function urlProvider()\n    {\n        return array(\n            array('http://till:test@svn.example.org/', $this->getCmd(\" --username 'till' --password 'test' \")),\n            array('http://svn.apache.org/', ''),\n            array('svn://johndoe@example.org', $this->getCmd(\" --username 'johndoe' --password \\\"\\\" \")),\n        );\n    }\n\n    public function testInteractiveString()\n    {\n        $url = 'http://svn.example.org';\n\n        $svn = new Svn($url, new NullIO(), new Config());\n        $reflMethod = new \\ReflectionMethod('Composer\\\\Util\\\\Svn', 'getCommand');\n        $reflMethod->setAccessible(true);\n\n        $this->assertEquals(\n            $this->getCmd(\"svn ls --non-interactive  -- 'http://svn.example.org'\"),\n            $reflMethod->invokeArgs($svn, array('svn ls', $url))\n        );\n    }\n\n    public function testCredentialsFromConfig()\n    {\n        $url = 'http://svn.apache.org';\n\n        $config = new Config();\n        $config->merge(array(\n            'config' => array(\n                'http-basic' => array(\n                    'svn.apache.org' => array('username' => 'foo', 'password' => 'bar'),\n                ),\n            ),\n        ));\n\n        $svn = new Svn($url, new NullIO, $config);\n        $reflMethod = new \\ReflectionMethod('Composer\\\\Util\\\\Svn', 'getCredentialString');\n        $reflMethod->setAccessible(true);\n\n        $this->assertEquals($this->getCmd(\" --username 'foo' --password 'bar' \"), $reflMethod->invoke($svn));\n    }\n\n    public function testCredentialsFromConfigWithCacheCredentialsTrue()\n    {\n        $url = 'http://svn.apache.org';\n\n        $config = new Config();\n        $config->merge(\n            array(\n                'config' => array(\n                    'http-basic' => array(\n                        'svn.apache.org' => array('username' => 'foo', 'password' => 'bar'),\n                    ),\n                ),\n            )\n        );\n\n        $svn = new Svn($url, new NullIO, $config);\n        $svn->setCacheCredentials(true);\n        $reflMethod = new \\ReflectionMethod('Composer\\\\Util\\\\Svn', 'getCredentialString');\n        $reflMethod->setAccessible(true);\n\n        $this->assertEquals($this->getCmd(\" --username 'foo' --password 'bar' \"), $reflMethod->invoke($svn));\n    }\n\n    public function testCredentialsFromConfigWithCacheCredentialsFalse()\n    {\n        $url = 'http://svn.apache.org';\n\n        $config = new Config();\n        $config->merge(\n            array(\n                'config' => array(\n                    'http-basic' => array(\n                        'svn.apache.org' => array('username' => 'foo', 'password' => 'bar'),\n                    ),\n                ),\n            )\n        );\n\n        $svn = new Svn($url, new NullIO, $config);\n        $svn->setCacheCredentials(false);\n        $reflMethod = new \\ReflectionMethod('Composer\\\\Util\\\\Svn', 'getCredentialString');\n        $reflMethod->setAccessible(true);\n\n        $this->assertEquals($this->getCmd(\" --no-auth-cache --username 'foo' --password 'bar' \"), $reflMethod->invoke($svn));\n    }\n\n    private function getCmd($cmd)\n    {\n        return Platform::isWindows() ? strtr($cmd, \"'\", '\"') : $cmd;\n    }\n}\n"], "filenames": ["CHANGELOG.md", "src/Composer/Command/HomeCommand.php", "src/Composer/Util/ProcessExecutor.php", "tests/Composer/Test/Downloader/GitDownloaderTest.php", "tests/Composer/Test/Util/SvnTest.php"], "buggy_code_start_loc": [0, 132, 158, 527, 50], "buggy_code_end_loc": [940, 133, 200, 528, 51], "fixing_code_start_loc": [1, 132, 158, 527, 50], "fixing_code_end_loc": [946, 133, 181, 528, 51], "type": "CWE-77", "message": "Composer is an open source dependency manager for the PHP language. In affected versions windows users running Composer to install untrusted dependencies are subject to command injection and should upgrade their composer version. Other OSs and WSL are not affected. The issue has been resolved in composer versions 1.10.23 and 2.1.9. There are no workarounds for this issue.", "other": {"cve": {"id": "CVE-2021-41116", "sourceIdentifier": "security-advisories@github.com", "published": "2021-10-05T18:15:08.407", "lastModified": "2022-09-10T02:38:23.860", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Composer is an open source dependency manager for the PHP language. In affected versions windows users running Composer to install untrusted dependencies are subject to command injection and should upgrade their composer version. Other OSs and WSL are not affected. The issue has been resolved in composer versions 1.10.23 and 2.1.9. There are no workarounds for this issue."}, {"lang": "es", "value": "Composer es un administrador de dependencias de c\u00f3digo abierto para el lenguaje PHP. En las versiones afectadas, unos usuarios de Windows que ejecutan Composer para instalar dependencias no confiables est\u00e1n sujetos a una inyecci\u00f3n de comandos y deben actualizar su versi\u00f3n de Composer. Otros Sistemas Operativos y WSL no est\u00e1n afectados. El problema ha sido resuelto en Composer versiones 1.10.23 y 2.1.9. No se presentan soluciones para este problema"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 8.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-77"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-77"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:getcomposer:composer:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.10.23", "matchCriteriaId": "9C5AC58B-D753-4639-B1FA-6267EE5EC280"}, {"vulnerable": true, "criteria": "cpe:2.3:a:getcomposer:composer:*:*:*:*:*:*:*:*", "versionStartIncluding": "2.0.0", "versionEndExcluding": "2.1.9", "matchCriteriaId": "24022E9F-FD26-4F38-8CAA-17B5DA3AB005"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:tenable:tenable.sc:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.21.0", "matchCriteriaId": "CAB9A41F-91F1-40DF-BF12-6ADA7229A84C"}]}]}], "references": [{"url": "https://github.com/composer/composer/commit/ca5e2f8d505fd3bfac6f7c85b82f2740becbc0aa", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/composer/composer/security/advisories/GHSA-frqg-7g38-6gcf", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://www.tenable.com/security/tns-2022-09", "source": "security-advisories@github.com", "tags": ["Patch", "Release Notes", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/composer/composer/commit/ca5e2f8d505fd3bfac6f7c85b82f2740becbc0aa"}}