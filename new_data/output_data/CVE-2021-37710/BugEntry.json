{"buggy_code": ["# BEGIN Shopware\n# The directives (lines) between \"# BEGIN Shopware\" and \"# END Shopware\" are dynamically generated. Any changes to the directives between these markers will be overwritten.\n\nDirectoryIndex index.php\n\n<IfModule mod_negotiation.c>\n    Options -MultiViews\n</IfModule>\n\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n\n    RewriteCond %{REQUEST_URI}::$1 ^(/.+)/(.*)::\\2$\n    RewriteRule ^(.*) - [E=BASE:%1]\n\n    # Sets the HTTP_AUTHORIZATION header removed by Apache\n    RewriteCond %{HTTP:Authorization} .\n    RewriteRule ^ - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\n\n    RewriteCond %{ENV:REDIRECT_STATUS} ^$\n    RewriteRule ^index\\.php(?:/(.*)|$) %{ENV:BASE}/$1 [R=301,L]\n\n    # If the requested filename exists, simply serve it.\n    # We only want to let Apache serve files and not directories.\n    RewriteCond %{REQUEST_FILENAME} -f\n    RewriteRule ^ - [L]\n\n    # Rewrite all other queries to the front controller.\n    RewriteRule ^ %{ENV:BASE}/index.php [L]\n</IfModule>\n\n<IfModule !mod_rewrite.c>\n    <IfModule mod_alias.c>\n        RedirectMatch 302 ^/$ /index.php/\n    </IfModule>\n</IfModule>\n\n<IfModule mod_headers.c>\n    <FilesMatch \"\\.svg$\">\n        Header set Content-Security-Policy \"script-src 'none'\"\n    </FilesMatch>\n</IfModule>\n\n# END Shopware\n"], "fixing_code": ["# BEGIN Shopware\n# The directives (lines) between \"# BEGIN Shopware\" and \"# END Shopware\" are dynamically generated. Any changes to the directives between these markers will be overwritten.\n\nDirectoryIndex index.php\n\n<IfModule mod_negotiation.c>\n    Options -MultiViews\n</IfModule>\n\n<IfModule mod_rewrite.c>\n    RewriteEngine On\n\n    RewriteCond %{REQUEST_URI}::$1 ^(/.+)/(.*)::\\2$\n    RewriteRule ^(.*) - [E=BASE:%1]\n\n    # Sets the HTTP_AUTHORIZATION header removed by Apache\n    RewriteCond %{HTTP:Authorization} .\n    RewriteRule ^ - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]\n\n    RewriteCond %{ENV:REDIRECT_STATUS} ^$\n    RewriteRule ^index\\.php(?:/(.*)|$) %{ENV:BASE}/$1 [R=301,L]\n\n    # If the requested filename exists, simply serve it.\n    # We only want to let Apache serve files and not directories.\n    RewriteCond %{REQUEST_FILENAME} -f\n    RewriteRule ^ - [L]\n\n    # Rewrite all other queries to the front controller.\n    RewriteRule ^ %{ENV:BASE}/index.php [L]\n</IfModule>\n\n<IfModule !mod_rewrite.c>\n    <IfModule mod_alias.c>\n        RedirectMatch 302 ^/$ /index.php/\n    </IfModule>\n</IfModule>\n\n<IfModule mod_headers.c>\n    <FilesMatch \"\\.(?i:svg)$\">\n        Header set Content-Security-Policy \"script-src 'none'\"\n    </FilesMatch>\n</IfModule>\n\n# END Shopware\n"], "filenames": ["public/.htaccess.dist"], "buggy_code_start_loc": [39], "buggy_code_end_loc": [40], "fixing_code_start_loc": [39], "fixing_code_end_loc": [40], "type": "CWE-79", "message": "Shopware is an open source eCommerce platform. Versions prior to 6.4.3.1 contain a Cross-Site Scripting vulnerability via SVG media files. Version 6.4.3.1 contains a patch. As workarounds for older versions of 6.1, 6.2, and 6.3, corresponding security measures are also available via a plugin.", "other": {"cve": {"id": "CVE-2021-37710", "sourceIdentifier": "security-advisories@github.com", "published": "2021-08-16T23:15:07.923", "lastModified": "2021-08-25T00:52:14.023", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Shopware is an open source eCommerce platform. Versions prior to 6.4.3.1 contain a Cross-Site Scripting vulnerability via SVG media files. Version 6.4.3.1 contains a patch. As workarounds for older versions of 6.1, 6.2, and 6.3, corresponding security measures are also available via a plugin."}, {"lang": "es", "value": "Shopware es una plataforma de comercio electr\u00f3nico de c\u00f3digo abierto. Las versiones anteriores a la 6.4.3.1 contienen una vulnerabilidad de Cross-Site Scripting por medio de los archivos multimedia SVG. La versi\u00f3n 6.4.3.1 contiene un parche. Como soluci\u00f3n para las versiones anteriores de 6.1, 6.2 y 6.3, las medidas de seguridad correspondientes tambi\u00e9n est\u00e1n disponibles por medio de un plugin."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.0, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:shopware:shopware:*:*:*:*:*:*:*:*", "versionEndExcluding": "6.4.3.1", "matchCriteriaId": "481D4300-1FB4-4307-8E13-EF6A0BB1BA46"}]}]}], "references": [{"url": "https://github.com/shopware/platform/commit/abe9f69e1f667800f974acccd3047b4930e4b423", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/shopware/platform/security/advisories/GHSA-fc38-mxwr-pfhx", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/shopware/platform/commit/abe9f69e1f667800f974acccd3047b4930e4b423"}}