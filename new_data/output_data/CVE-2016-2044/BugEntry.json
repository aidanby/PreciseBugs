{"buggy_code": ["<?php\n\n/**\n * The autoloader used for loading sql-parser's components.\n *\n * This file is based on Composer's autoloader.\n *\n * (c) Nils Adermann <naderman@naderman.de>\n *     Jordi Boggiano <j.boggiano@seld.be>\n *\n * @package     SqlParser\n * @subpackage  Autoload\n */\nnamespace SqlParser\\Autoload;\n\nif (!class_exists('SqlParser\\\\Autoload\\\\ClassLoader')) {\n    include_once './libraries/sql-parser/ClassLoader.php';\n}\n\nuse SqlParser\\Autoload\\ClassLoader;\n\n/**\n * Initializes the autoloader.\n *\n * @package     SqlParser\n * @subpackage  Autoload\n */\nclass AutoloaderInit\n{\n\n    /**\n     * The loader instance.\n     *\n     * @var ClassLoader\n     */\n    public static $loader;\n\n    /**\n     * Constructs and returns the class loader.\n     *\n     * @param  array $map Array containing path to each namespace.\n     *\n     * @return ClassLoader\n     */\n    public static function getLoader(array $map)\n    {\n        if (null !== self::$loader) {\n            return self::$loader;\n        }\n\n        self::$loader = $loader = new ClassLoader();\n\n        foreach ($map as $namespace => $path) {\n            $loader->set($namespace, $path);\n        }\n\n        $loader->register(true);\n\n        return $loader;\n    }\n}\n\n// Initializing the autoloader.\nreturn AutoloaderInit::getLoader(\n    array(\n        'SqlParser\\\\' => array(dirname(__FILE__) . '/src'),\n    )\n);\n"], "fixing_code": ["<?php\n\n/**\n * The autoloader used for loading sql-parser's components.\n *\n * This file is based on Composer's autoloader.\n *\n * (c) Nils Adermann <naderman@naderman.de>\n *     Jordi Boggiano <j.boggiano@seld.be>\n *\n * @package     SqlParser\n * @subpackage  Autoload\n */\nnamespace SqlParser\\Autoload;\n\nif (!class_exists('SqlParser\\\\Autoload\\\\ClassLoader')) {\n    if (! file_exists('./libraries/sql-parser/ClassLoader.php')) {\n        die('Invalid invocation');\n    }\n    include_once './libraries/sql-parser/ClassLoader.php';\n}\n\nuse SqlParser\\Autoload\\ClassLoader;\n\n/**\n * Initializes the autoloader.\n *\n * @package     SqlParser\n * @subpackage  Autoload\n */\nclass AutoloaderInit\n{\n\n    /**\n     * The loader instance.\n     *\n     * @var ClassLoader\n     */\n    public static $loader;\n\n    /**\n     * Constructs and returns the class loader.\n     *\n     * @param  array $map Array containing path to each namespace.\n     *\n     * @return ClassLoader\n     */\n    public static function getLoader(array $map)\n    {\n        if (null !== self::$loader) {\n            return self::$loader;\n        }\n\n        self::$loader = $loader = new ClassLoader();\n\n        foreach ($map as $namespace => $path) {\n            $loader->set($namespace, $path);\n        }\n\n        $loader->register(true);\n\n        return $loader;\n    }\n}\n\n// Initializing the autoloader.\nreturn AutoloaderInit::getLoader(\n    array(\n        'SqlParser\\\\' => array(dirname(__FILE__) . '/src'),\n    )\n);\n"], "filenames": ["libraries/sql-parser/autoload.php"], "buggy_code_start_loc": [16], "buggy_code_end_loc": [16], "fixing_code_start_loc": [17], "fixing_code_end_loc": [20], "type": "CWE-200", "message": "libraries/sql-parser/autoload.php in the SQL parser in phpMyAdmin 4.5.x before 4.5.4 allows remote attackers to obtain sensitive information via a crafted request, which reveals the full path in an error message.", "other": {"cve": {"id": "CVE-2016-2044", "sourceIdentifier": "cve@mitre.org", "published": "2016-02-20T01:59:07.563", "lastModified": "2016-08-17T19:37:35.727", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "libraries/sql-parser/autoload.php in the SQL parser in phpMyAdmin 4.5.x before 4.5.4 allows remote attackers to obtain sensitive information via a crafted request, which reveals the full path in an error message."}, {"lang": "es", "value": "libraries/sql-parser/autoload.php en analizador SQL en phpMyAdmin 4.5.x en versiones anteriores a 4.5.4 permite a atacantes remotos obtener informaci\u00f3n sensible a trav\u00e9s de una petici\u00f3n manipulada, lo cual revela la ruta completa en un mensaje de error."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:22:*:*:*:*:*:*:*", "matchCriteriaId": "253C303A-E577-4488-93E6-68A8DD942C38"}, {"vulnerable": true, "criteria": "cpe:2.3:o:fedoraproject:fedora:23:*:*:*:*:*:*:*", "matchCriteriaId": "E79AB8DD-C907-4038-A931-1A5A4CFB6A5B"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.5.0:*:*:*:*:*:*:*", "matchCriteriaId": "A4D7AAF1-64FF-40C9-90B2-DEC814157372"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.5.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "96D529F5-8870-4934-BCD8-E49095D21224"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.5.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "296EB2FA-FCAD-4BD5-A015-62765407AFE5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.5.1:*:*:*:*:*:*:*", "matchCriteriaId": "4DBD0DC7-64D0-42B1-8EEE-73A0214680F5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.5.2:*:*:*:*:*:*:*", "matchCriteriaId": "A6A15D1E-83ED-47EC-B17C-E6BCC49DE83D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.5.3:*:*:*:*:*:*:*", "matchCriteriaId": "4112ACFF-D40E-45BE-9307-F710E7B41ECD"}]}]}], "references": [{"url": "http://lists.fedoraproject.org/pipermail/package-announce/2016-February/176483.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://lists.fedoraproject.org/pipermail/package-announce/2016-February/176739.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.phpmyadmin.net/home_page/security/PMASA-2016-8.php", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/phpmyadmin/phpmyadmin/commit/c57d3cc7b97b5f32801032f7bb222297aa97dfea", "source": "cve@mitre.org", "tags": ["Patch"]}]}, "github_commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/c57d3cc7b97b5f32801032f7bb222297aa97dfea"}}