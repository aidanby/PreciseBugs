{"buggy_code": ["<?php\n# config, objects\nrequire_once( dirname(__FILE__).'/../../../functions/functions.php' );\n\n# initialize objects\n$Database\t= new Database_PDO;\n$Result\t\t= new Result;\n$User\t\t= new User ($Database);\n# verify that user is logged in\n$User->check_user_session();\n\n// process input values\n$tcp   = $_POST['wsize'];\n$delay = $_POST['delay'];\n$fsize = $_POST['fsize'];\n\n// get mbps values from config\n$mbps = round($tcp/($delay/1000)/(1024*1024),2);\n\n// Calculate transfer time\n$time = round(($fsize / $mbps), 2);\n\n// set network type\nif($delay<1)\t\t{ $type = \"LAN\"; }\nelseif($delay<20)\t{ $type = \"MAN\"; }\nelse \t\t\t\t{ $type = \"WAN\"; }\n?>\n\n<hr>\n<p>\n\n<strong><?php print _(\"Transfer time (h:m:s)\"); ?>:</strong>\n<div class='res_val'><?php print $User->sec2hms($time); ?></div>\n\n<?php if(!isset($_POST['widget'])) { ?>\n<div class=\"clearfix\"></div>\n\n<br><br>\n<strong><?php print _(\"Calculation parameters\"); ?>:</strong>\n<ul>\n\t<li> <?php print _(\"TCP window size\").\": $tcp\"; ?></li>\n\t<li> <?php print _(\"Delay\").\": $delay\".\" \"._(\"ms\"); ?></li>\n\t<li> <?php print _(\"Speed\").\": $mbps\".\" \"._(\"MBps\"); ?></li>\n\t<li> <?php print _(\"Newtork type\").\": $type\"; ?></li>\n\t<li> <?php print _(\"File size\").\": $fsize\".\" \".\"MB\"; ?></li>\n</ul>\n</p>\n<br>\n<?php } ?>", "== 1.6.0\n\n    Enhancements, changes:\n    ----------------------------\n    + php8.1 compatibility (php8.x support is work-in-progress);\n\n== 1.5.0\n\n    New features:\n    ------------\n    + Mark subnet as isPool to allocate network and broadcast addresses;\n    + Optionally hide section subnet menus;\n    + L2 Domains user permissions;\n    + Add scanPingType==\"none\" option to disable scanning;\n    + Custom fields on IP request forms (#2956);\n    + Added subnet free space map for each possible subnet mask;\n    + Added Vaults (Certificate andf password storing);\n    + Added Tools->Duplicate subnets & IP page;\n    + Added config.php offline_mode to disable server-side Internet lookups (#3462);\n    + Added MAC vendor lookup widget;\n\n    Enhancements, changes:\n    ----------------------------\n    + php7.4 compatibility;\n    + SameSite attribute enabled for site cookies;\n    + SAML2\n        + php-saml updated to 3.4.1 (#3055);\n        + Removal of php-mcrypt dependancy;\n        + Drop support for idpcertfingerprint;\n        + MAP_SAML_USER and SAML_USERNAME config.php configuration moved to db;\n        + php-saml protocol debugging;\n        + Support for signed assertions;\n        + SAML usernames can be extracted from assertion attributes (#2948);\n        + JIT auto-provisioning of accounts (#3389);\n    + Selectable mask for number of subnets/hosts in subnet masks;\n    + Switch from Google Maps to OpenStreeMap and Nominatim;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed upgrade queries issues from 1.3.x to 1.4+ (#3130);\n    + Fixed boolean printout in footer (#2625);\n    + Fixed BGP Admin isn't working (#2631);\n    + do not show statistics in dashboard widget for disabled modules (#2602);\n    + MySQL 8.0 compatibility. (#2646,#2239,#3036);\n    + MariaDB Galera Cluster compatibility (#2498,#3413);\n    + Permit non-numeric postcodes for customers (#2393);\n    + Bandwidth calculator - 400 Bad Request (#1807,#2648);\n    + Table layout not aligned (#2656,#3105,#3113);\n    + Improve scanning requirement checks (#1183);\n    + Date picker hidden (#2673);\n    + PDNS Add/Edit DNS record not working for normal users (#2686);\n    + Unable to save settings with link addresses = text custom field (#2702);\n    + Kea MAC address display issue (#2704);\n    + Returned custom fields to devices table (#2572);\n    + Invalid scan agent key warning;\n    + Subnet filter issue when IP contains 0 octet. (#2748);\n    + Add VLAN button not working (#2741);\n    + Incorrect subnet links in /tools/vrf/ view. (#2774);\n    + Location data missing in exports. (#2833);\n    + Check mysqldump path when exporting database;\n    + Current rack position missing when editing a device. (#2545);\n    + Permit colon in firewall zone interface names (#2737);\n    + Fixed PowerDNS txt SPF editing (#1641);\n    + Blank 'MAC' on SNMP-ARP and SNMP-MAC scans (#2911);\n    + Incorrect network/broadcast calculation for IPv6 (#2879);\n    + Increase allowed email and password lengths (#3021);\n    + Wrong unit location for dual-sided racks (#3086);\n    + Linked ip_addr shows integer notation (#3100);\n    + Invalid scan type () error (#2785);\n    + Invalid CSRF cookie editing rack items (#2556);\n    + FPing discovery marks all addresses as alive (#2888);\n    + Subnet usage calculation updated for nested subnets;\n    + SNMP, number of discovered hosts exceed maximum warning (#3279);\n    + Exclude IPv6 from Ping and Discovery scans (#3354);\n    + Fix for SAML/2FA/login redirections (#3492, #3435, #3517);\n    + php_sessions table doesn't exist error when upgrading (#3417);\n    + Changelog data too long for column errors (#3376,#3398);\n    + RFC 6265 compliant cookies (#3452);\n    + Require unique subnets not working as intended (#3529);\n    + API:\n        + Fixed /user/ calls for SSL with app code (static app code);\n        + Address IP field not displayed when using filter_by (#2934);\n        + Addresses first_free & Subnets first/last_subnet thread safety (#2960);\n\n    Security Fixes:\n    ----------------------------\n    + SQL injections processing `tableName` (#2738);\n    + SQL injections processing `ftype` (#2751);\n    + All circuits map, PHP object injection (#2937);\n    + Upgraded jQuery to 3.5.1 (#3119);\n    + Stored XSS in instructions widgets (#3025, #3360);\n    + PHP session ID fixation (#3342);\n    + XSS (reflected) in IP calculator (#3351);\n    + XSS in pass-change/result.php (#3373);\n    + SQL injection in edit-bgp-mapping-search.php;\n    + Stored XSS in the \"Site title\" parameter;\n    + XSS while uploading CVS files;\n    + XSS (reflected) in 'find subnets';\n    + Incorrect privilege assignments (#3506);\n    + XXS (reflected) in ripe-arin-query;\n    + XSS (reflected) in import previews;\n\n    Translations:\n    ----------------------------\n    + Update Traditional Chinese support to version 1.5 (#2658);\n    + Update Simplified Chinese Translation (#2725);\n    + Italian (it_IT) translation added (#2813);\n    + Updated German translation (#2970, #3065);\n    + Updated Russian translation (#3028, #3367);\n\n== 1.4.0\n\n    New features:\n    ------------\n    + Configurable password policy;\n    + Sessions can be now stored in database (#516);\n    + Two-factor authentication - otp (Google Authenticator);\n    + Customers module (#694);\n    + Routing module (BGP) (#2135);\n    + Search for free subnet inside whole section;\n\n    Enhancements, changes:\n    ----------------------------\n    + Circuits enhancements (Virtual Circuits);\n    + Dropped support for 32bit systems;\n    + PHP 5.4 is now required;\n    + Added compressed actions dropdown;\n    + SNMP module no longer requires MIB files;\n    + Performance enhancements running under Azure/Amazon;\n    + Added option to disable user (#1327);\n    + Added policy NAT option;\n    + Added custom NAT fields;\n    + Rack module enhancements (#1325):\n        + Dynamic rack sizes;\n        + Top-down / Bottom-up racks;\n        + Custom rack devices independent of devices (power, patch panel);\n    + Customized user permissions for modules:\n        + VLAN module;\n        + VRF module;\n        + PowerDNS module;\n        + Circuits module;\n        + Customers module;\n        + Devices module;\n        + Rack module;\n        + NAT module;\n        + PSTN module;\n        + Locations module;\n    + API:\n        + New API security type - SSL with app code (static app code);\n        + New config.php option $api_allow_unsafe to allow non-SSL API queries;\n        + Added last access field to api;\n        + Add Mac Search for Addresses controller (#2005);\n        + New overlapping API call;\n        + New global API parameter filter_match = full,partial,regex;\n        + Add Tools API customers submodule;\n        + Fix filtered results to always return data as array (#2558);\n    + Widgets:\n        + New user instruction widget (#2383);\n\n    Translations:\n    ----------------------------\n    + Japanese (ja_JP) translation added;\n    + Traditional Chinese (zh_TW) translation added;\n\n    Bugfixes:\n    ----------------------------\n    + Fix appended \" U\" in Rack description (#2046);\n    + Fix Bandwidth calculator - 400 Bad Request. (#1807);\n    + Fix bad DNS reverse zone for /23 subnet (#666);\n    + Fix Add missing standard field (#2153);\n    + Fix Consistency of VARCHAR Size on 'owner' column across tables (#2136);\n    + Fix Subnet details - Filter button missing when compressed range is used (#2353);\n    + Fix slow page load times with linked addresses (#2324);\n    + Fix \" - is required\" error when adding IPs with an empty IP filter set (#2334);\n    + Fix column 'masterSubnetId' cannot be null error when adding subnets (#1977);\n    + Fix logical circuits add/delete errors (#2381);\n    + Fix adding new VLANs to an empty L2Domain (#2400);\n    + Fix Nested child subnets with \"na\" permissions visible (#2223);\n    + Fix translations containing apostrophes break functionality (#2504);\n    + Set requestedAuthnContext to false for SAML (#2457);\n    + API:\n        + Fix inconsistent API success value returned (#2045);\n        + Fix filter_by functionality (#2392);\n        + Fix PATCH functionality (#2470, #2481);\n\n    Security Fixes:\n    ----------------------------\n    + Hide SNMP community (#2197);\n    + Hide LDAP/AD/Radius username / password and secret from logs and syslog (#2006);\n    + XSS in phpipamredirect cookie (#2338);\n    + XSS in print-user.php, CSRF in user-edit.php (#2326);\n    + Possible SQL injection in nat/item-add-submit.php (#2344);\n    + Fixed possible file inclusion in editing authentication methods;\n    + XSS in subnet-scan-telnet.php, CSRF in subnet-scan-execute.php (#2327);\n\n== 1.3.2\n\n    Enhancements, changes:\n    ----------------------------\n    + Dark theme added;\n    + Full php7.2 compatibility;\n    + url_rewrite has changed, please use new rewrite scheme (https://phpipam.net/news/new_rewrite_scheme/);\n    + Search for matching subnet in all VRFs feature enabled when importing addresses;\n    + Added new config option to show custom fields separated from standard fields when editing IP address;\n    + Added Required fields subpage to define IP address fields that must be filled in;\n    + Performance + bug fixes (#1660, #1657);\n    + MasterSubnet dropdown list is dynamically generated via AJAX call;\n    + Bandwidth calculator;\n    + Support 8U rack sizes. (#1891);\n    + API:\n        + New last_subnet API calls (#1655);\n\n    Translations:\n    ----------------------------\n    + German translation updated to verson 1.3.1;\n    + French translations updated. (#1881);\n\n    Bugfixes:\n    ----------------------------\n    + Fixed uncaught error if vlan number exceeds max permitted (#1455);\n    + Fixed Illegal string offset 'dns_name' in pingCheck.php errors (#1461);\n    + Performance fix for subnet_dropdown_print_available (#1562);\n    + Fixed logo updater for apache v2.4 (#1582);\n    + Fixed section names containing spaces are not included in exports (#1566);\n    + Allow DNS wildcard records (#1571);\n    + Fixed slow mac address vendor decoding for subnet detail view (#1658);\n    + Performance fix for detecting overlapping subnets. (#1052, #1426, #1533);\n    + Performance fix for slow mac address vendor decoding (#1658);\n    + Performance fix for subnet API first_subnet & all_subnets calls;\n    + Performance fix for delegating subnet permissions;\n    + Convert to UTF-8 encoding on import/export to preserve dialectics (#1659, #1700, #1728);\n    + Importing IPs loose Mac Addresses (#1607);\n    + Section names containing spaces are not included in exports. (#1566);\n    + Bug with section and dashboard (#1593);\n    + Fixed improper contents in plain text part of notification e-mails (#1707);\n    + Reduce size of email notifications (#1643);\n    + PHP 5.3 compatibility fixes (#1594, #1730);\n    + PHP 7.2 compatibility fixes (#1683, #1714);\n    + Fixed notification e-mails contain a broken link. (#1708);\n    + Allow dots to be used in domain names. (#1747);\n    + Use multi-byte compatible functions when shortening text. (#1753);\n    + Scan subnet reports/selects invalid php path. (#1757);\n    + Small code refactoring (#1699);\n    + Rack device start position overwritten. (#1545);\n    + Sections with folders returns no subnets using API. (#1883);\n    + Add custom_ prefix to Prefix controller custom fields. (#1836);\n    + Non-Admins missing the button to Add circuit. (#1902);\n    + Wrong field name of deviceTypes table when checking device type. (#1910);\n    + SNMPv3 improvements;\n    + Misc IPv6 fixes;\n\n    Security Fixes:\n    ----------------------------\n    + Code injection in Name field. (#1667);\n    + XSS (reflected) in SubnetID param. (#1702);\n    + CSRF enables open mail relay. (#1703);\n    + Reflected XSS requiring user interaction on search. (#1705);\n    + XSS reflected via CSRF in preview.php. (#1706);\n    + Reflected XSS via CSV upload. (#1742);\n    + Reflected XSS on 'mac' parameter. (#1903);\n\n== 1.3.1\n\n    New features:\n    ------------\n    + Circuits module (circuits, providers, map, ...) (#731);\n\n    Enhancements, changes:\n    ----------------------------\n    + Racks:\n        + Automatic location assignment when device added to rack (#1230);\n        + Rack map showing map of all racks in location;\n        + Rack back side;\n    + Compact menu layout (per-user setting, showing only icons);\n    + Network to network static nat;\n    + Selectable logo size (from config.php) (#952);\n    + Added default option for permissions propagations (#1351);\n    + API:\n        + Added Circuits controller;\n        + Encrypyted requests can now also be form-encoded (#1191);\n        + Introduce mcrypt AES compatibility (#1516);\n        + Fixed field ip not displayed when filters applied (#1529);\n    + New resolve hostnames option for subnet (#1222):\n        + Updates hostnames via pingCheck.php script (if parameter set for subnet);\n        + Updates hostnames via resolveIPaddresses.php script (if parameter set for subnet);\n        + On-the-fly empty hostname update if resolved (if parameter set for subnet and enabled globally);\n        + Added this infor to tools > scanned networks;\n    + Added custom_ prefix to custom field names to avoid duplication with custom fields (#1387);\n    + Added option to hide IP requests for unauthenticated users on login page (#1394);\n    + Performance optimizations for locations and subnet usage calculation;\n    + Added user groups custom fields;\n\n    Translations:\n    ----------------------------\n    + French translation updated to verson 1.3;\n    + German translation updated to verson 1.3;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed RACK images not displayed if not root location (#1204);\n    + Fixed import gateway ip (#1240);\n    + Fixed JSON_UNESCAPED_UNICODE for PHP 5.3 (#1135, #1245);\n    + Rename class Thread to PingThread to avoid naming conflict with pthreads Thread class (#1254);\n    + Fixed custom fields integer on subnet (#1266);\n    + Fixed Import Ip-adress doesnt update location (#1284);\n    + Fixed json_error for logo upload (#1256);\n    + Fixed CSRF error when moving orphaned addresses (#1303);\n    + Fixed VRF fetching via API by Id;\n    + Fixed map issues when quotes are in name/description (#1384);\n    + Fixed item not removed from NAT when deleted (#1378);\n    + Fixed Error when error_reporting = E_ALL about strict standards when importing IP addresses (#1372);\n    + Fixed Apostrophe errors in text custom fields (#1375);\n    + Fixed API error when creating address under folder (#1507);\n    + Fixed SNMPv3 (#1119);\n\n    Security Fixes:\n    ----------------------------\n    + Fixed XSS issues (#1403, #1521, #1500);\n\n== 1.3.0\n\n    New features:\n    ------------\n    + Multicast module (RFC1112, RFC2464) with IP to MAC mapping and multicast networks overview;\n    + Threshold module for subnets;\n    + Racks module (Rack drawing) for devices;\n    + Address linking by selected field;\n    + Custom logo for site and mails;\n    + PSTN number management module;\n    + SNMP module:\n        + Subnets discovery from route table (all subnets, nested subnets, add new subnet);\n        + Hosts discovery scans via ARP check/interface check;\n        + Hosts discovery scans via ARP + MAC address check (detects interface);\n        + VLAN discovery;\n        + VRF discovery;\n        + Status update scans via ARP check;\n    + NAT module\n        + Source / static / destination NAT;\n        + Linking subnet to NAT\n        + Show bindings under tools and next to IP address / subnet\n    + Locations module\n        + Map devices / racks / subnets to location;\n        + Google maps integration;\n    + SAML2 authentication (SSO)\n\n    Enhancements, changes:\n    ----------------------------\n    + Folders can now contain addresses;\n    + API:\n        - Api v1 removed;\n        + If subnet gateway defined gatewayId is returned in subnet details;\n        + Automatically added nameservers to subnet results;\n        + Added subnet usage result for each subnet in section;\n        + Added custom fields for all controllers;\n        + New subnets automatically get parent permissions;\n        + Added IP calculation to subnet;\n        + Changed all not_found when searching objects to 404 and all invalid parameters to 409 (conflict);\n        + If new item is created id will be available in response field \u201cid\u201d;\n        + New parameter $time_response in api/index.php that will return execution time in field \u201ctime\";\n        + Extensive first_free subnet calls search speedup;\n        + POST transaction locking;\n        + All first_free and first_address responses are now \"data\" instead of \"ip\" and \"subnet\" for consistency;\n        + Subnet splitting now copies over custom fields values by default (user custom_fields=no to revert);\n        + Added API option to nest custom_fields to assure correct structure;\n        + Added option to show/hide links in api by default for each app;\n        + Changed API http response codes;\n        + New methods:\n            + users:\n                GET    /user/expires/                         // returns token expiration date\n                GET    /user/token-expires/                   // returns token expiration date\n                GET    /user/users/                           // returns all users (rwa app permissions required)\n                GET    /user/admins/                          // returns all admin users (rwa app permissions required)\n            + addresses:\n                GET    /addresses/first_free/{subnetId}/      // returns first available address (subnetId can be provided with parameters)\n                GET    /addresses/{ip}/{subnetId}/            // returns IP address from subnet\n                GET    /addresses/search/{hostname}/          // Will search addresses by hostname\n                DELETE /addresses/{ip}/{subnetId}/            // deletes IP address from subnet\n                POST   /addresses/first_free/{subnetId}/      // will search for first free address in subnet, creating new address\n            + subnets:\n                GET    /subnets/{id}/addresses/{ip}/          // returns IP address from subnet\n                GET    /subnets/{id}/first_free/              // returns first free address in subnet\n                GET    /subnets/{id}/first_subnet/{mask}/     // returns first available subnets with specified mask\n                GET    /subnets/{id}/all_subnets/{mask}/      // returns all available subnets with specified mask\n                POST   /subnets/{id}/first_subnet/{mask}/     // creates first free subnet under master with specified mask\n                DELETE /subnets/{id}/permissions/             // removes permissions\n                PATCH  /subnets/{id}/permissions/             // sets subnet permissions (?grouname1=ro&groupname2=3&43=1)\n        + New controller Prefix;\n        + New controller Devices;\n        + New subcontrollers:\n            + /tools/nat/\n            + /tools/racks/\n            + /tools/locations/\n    + Widgets:\n        + New threshold widget;\n        + New inactive hosts widget;\n        + New Locations widget;\n    + PowerDNS:\n        + Default domain for PTR records (if hostname is not set);\n        + When removing IP address additional option that removes all associated PDNS records (ip and hostname);\n    + Permit normal users to manage VLANs / VRFs;\n    + Inactive (offline) hosts tools page;\n    + MAC address normalization;\n    + jQuery tables;\n    + Permission delegation now only delegates changes not whole permission set;\n    + Users with RWA permission can manage IP requests and receive IP request mails + changelog mails for subnet;\n    + IPv4 subnet link to IPv6 for dual-stack info;\n    + Removed inacessible DNS servers if timeout to prevent page load timeouts;\n    + Added option to only show supernets to limit pageload [#844 #816 #736];\n    + Added last scan info to subnet details;\n    + Added option to update address tags when address state change occurs (pingCheck) [#840];\n    + Added mantaneance mode;\n    + Added inactive addresses removal script;\n    + Subnet overlapping now checked also inside folders to prevernt duplicates;\n    + Subnet overlapping now checked also between sections if VRF defined;\n    + Added new settings directive that requires unique subnets accross sections;\n    + Added index check in verify database to detect and fix possible missing DB indexes;\n    + Added MAC address vendor display option;\n\n    Bugfixes:\n    ----------------------------\n    + PowerDNS regenerate PTR records now only updates current subnet (before whole zone);\n    + Fixed visual bug on 32-bit systems;\n    + Normal users with RWA permissions can scan subnets;\n    + Changed default timestamp from 0000-00-00 00:00:00 to 1970-01-01 00:00:01 to avoid SQL install errors if strict mode;\n    + Fixed https access on non-standard ports;\n    + Extended username to 255 chars for LDAP logins;\n    + Fixed search export invalid encoding and data may have been lost XLS file error;\n    + Fixed invalid character encoding in API responses;\n    + PowerDNS records cannot be created on slave zone;\n    + Fixed subnet resizing bug if subnet contained slaves;\n    + Added separate CSRF cookies for each address/subnet/pstn object;\n    + Deleted items are now shown and searchable from changelog;\n\n== 1.20.1\n\n    Translations:\n    ----------------------------\n    + French translation updated to verson 1.2;\n    + German translation updated to verson 1.2;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed upgrade bug that selected invalid auth method for AD/LDAP users;\n    + Fixed LDAP problems after 1.2 upgrade;\n    + Fixed PowerDNS Slave with multiple masters delimiter error;\n    + Fixed PowerDNS PTR records not being updated automatically;\n    + Fixed csrf cookie bug when editing folder;\n    + Fixed csrf cookie bug when truncationg subnet;\n    + Fixed invalid code for API crypt method;\n    + Fixed strange headings font display in Firefox;\n    + Fixed invalid proxy settings in config.dist.php;\n    + Fixed search same hostnames in db link form address table;\n    + Fixed import subnet bug caused by fw object;\n    + Fixed Subnet Import (Preview button > no action);\n\n== 1.20\n\n    New features:\n    ------------\n    + Added multiple simultaneous authentication methods (Apache, AD, LDAP, Radius, NetIQ);\n    + Added fping scanning support;\n    + Added selectable scanning type (ping/pear/fping);\n    + Added L2 domains;\n    + Added option to define address as default GW for subnet;\n    + Added customizable address tags with compressed option;\n    + Added temporary subnet / address shares;\n    + Added quick subnet masks;\n    + Added nameserver sets per subnets (jonashauge);\n    + Added optional syslog as log location;\n    + REST API:\n        + documentation: http://phpipam.net/api-documentation/\n        + API v2, old v1 support added\n        + Complete rewrite of all API calls;\n        + New security models (crypt, ssl, none);\n        + Support for custom fields;\n        + JSON / XML output\n        + Full read/write controllers (Sections, Subnets/Folders, Addresses, Vlans, Vrfs);\n    + PowerDNS integration:\n        + Automatic reverse records creation (PTR) - IPv4 and IPv6;\n        + Automatic SOA, NS record creation;\n        + DNS domain management;\n    + Added Scan agents to scan subnets remotely;\n    + Added firewall zone mappings and module;\n    + Added per-subnet DNS resolvers;\n    + Added option to mark subnet as utilized (full);\n\n    Enhancements:\n    ----------------------------\n    + All tables are now InnoDB by default;\n    + Upgraded jQuery to 2.1.3;\n    + All functions rewritten to classes/methods;\n    + Parametized all SQL queries, moved from MySQLI to PDO;\n    + Added VLAN/VRF to search and to search results export;\n    + Redesigned admin and tools menu;\n    + Added scanned/discovered subnets to tools for faster overview;\n    + Per-user display settings;\n    + New widget - tools shortcuts;\n    + New widget - IP calculator;\n    + New widget - request IP address;\n    + Clickable links for subnet fields;\n    + Custom VRF fields;\n    + Subnets can be now linked to devices;\n    + Import/export enhancements;\n    + Fast user switching for admins to impersonate user;\n    + Opened folders and subnets in tree menu are saved on page reload;\n    + RWA users can now process IP requests;\n    + Added auto-suggest for possible slave subnets;\n    + SSL option for MySQL connections;\n    + Enum custom field support;\n    + Added password reset script;\n    + Set sections to display VRF in;\n\n    Security Fixes:\n    ----------------------------\n    + Parametized all MySQL querries;\n    + Fixed plainpass being logged on user update;\n    + Fixed XSS exploit on /error/;\n    + Added CSRF protection to forms;\n\n    Translations:\n    ----------------------------\n    + Added Czech translation;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed bug with SSL/TLS smtp servers;\n    + Fixed visual subnet display issues on 32bit systems;\n    + Fixed IPv6 split subnets bug;\n    + Fixed /31 ping bug scanning out of boundaries;\n    + Fixed nested broadcast not counted to used percentage;\n    + Fixed invalid redirect after timeout;\n    + Fixed discovery script index overridden;\n    + Fixed dashboard graphs links to subnets;\n    + Fixed Invalid ID on subnet scan of large subnets;\n\n== 1.1.010\n\n    Bugfixes:\n    ----------------------------\n    + Fixed login fails with LDAP when escape characters are in password;\n    + Fixed login not working with spaces in password for AD login;\n    + Fixed Ivalid action when adding vlans from subnet popup menu;\n    + Fixed custom fields not appearing properly on IP request editing;\n    + Fixed Invalid ID error for IP address details on sorting;\n    + Fixed warnings if no VLAN search results are present;\n    + Fixed test mail not sending;\n    + Fixed unable to login if $phpsessname not defined;\n    + Fixed unable to login after upgrade;\n\n== 1.1\n\n    Enhancements:\n    ----------------------------\n    + Caching of SQL results to avoid multiple queries;\n    + Reduced number of DB queries;\n    + Added selected mail notifications to admins to be notified on IP/subnet change;\n    + Added new subnetId index to ipaddresses table that significantly improves network loading;\n    + Now using only 1 network connection towards MySQL server;\n    + Updated pagination;\n    + mod_rewrite no longer required, selectable URL structure under settings;\n    + Added option not to display free ranges;\n    + Added option to set maximum VLAN number;\n    + Selectable custom fields to be visible/hidden in tables view and updated device/VLAN view;\n    + Added additional confirmation before section, subnet, folder and IP address deletion;\n    + New script added for cron checks that discovers new hosts for selected networks;\n    + Added inactivity timeout to settings;\n    + Changed install procedure and updated install scripts;\n    + Added PEAR check for installation;\n    + Added free range disaply for VLANs;\n    + Addes SSL/TLS option for SMTP mail;\n    + API:\n        + Bugfixes;\n        + Added API admin permissions;\n        + read/delete actions for IP addresses;\n        + read/delete actions for Vlans;\n        + read/delete actions for VRFs;\n\n    Security Fixes:\n    ----------------------------\n    + Fixed known command injection vulnerabilities in the scan functions;\n    + Fixed known SQL injection vulnerabilities;\n    + Fixed known XSS vulnerabilities;\n    + Fixed known action XSS events;\n    + Moved to crypt method for storing password in database with salting;\n    + Added option to force user to change pass after first login;\n    + Admin password must be changed after installation;\n    + Added captcha code request after 5x unsuccesfull login to prevent brute-force attacks;\n\n    Translations:\n    ----------------------------\n    + Added es_ES translation;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed top 10 widgets not escaping strings;\n    + Fixed section parent can be set to self that caused section to disapear;\n    + Fixed username instead of password being sent to smtp server;\n    + Fixed IE search bug with workaround;\n    + Fixed subnet and bcast not showing on strict mode disabled;\n    + Fixed top subnets missing on dashboard for non-admin users;\n    + Fixed bug when installation was silently failing bacause pf missing _() function (missing gettext extension)\n    + Fixed device custom field not populated on adding device;\n    + Fixed XLS export silently failed when description longer than 31 characters;\n    + Fixed overlapping check not working;\n    + Fixed subnet free space calcultation;\n    + Fixed visual subnet display not showing on /31 and /32 networks;\n    + Fixed custom fields display on folder edit;\n    + Fixed unable to edit IP addresses when fields are sorted;\n    + Fixde ordering of custom fields defaults to varchar 256;\n    + Fixed IPv6 subnet / broadcast calculation bug and next subnet suggestion;\n\n== 1.0\n\n    New features:\n    ----------------------------\n    + IP address page with IP address details and IP history (Changelog);\n    + IP address changelog, subnet and section changelogs with full changelog under tools;\n    + Favourite subnets for quick access;\n    + Adding subnets from free space with automatic mask provided;\n    + Automatic database validity check after upgrading and automatic field/table fix under administration;\n    + Automatic weekly check for new phpipam version;\n\n    Enhancements:\n    ----------------------------\n    + Bootstrap 3;\n    + UI enhancements;\n    + Improved views based on browser width;\n    + Widget order can now be set;\n    + Widgets can be reordered (dragged) directly on dashboard;\n    + Subnet can now be splitted to max 256 new subnets (16 before);\n    + Scan settings are moved to Administration;\n    + Widget management has moved to administration, which allows creation of new widgets;\n    + Improved ICMP error detection;\n    + Mail settings can now be set on gui (localhost / smtp);\n    + Popup windows are now draggable;\n    + VLAN adding in the fly enhancements;\n    + Master section now shows all subnets in subsections;\n    + Tools > devices redone;\n    + DeviceTypes can now be edited/set/added;\n    + Ping subnet enhancements;\n    + Custom field types are now defineable (int/varchar/date/datetime/text/bool/set);\n    + Date and timepicker popups if type = date/datetime;\n    + For `set` and boolean custom fields dropdown is presented that users can pick;\n\n    + Favourite subnets widget;\n    + IP requests widget;\n    + Changelog widget;\n\n    Translations:\n    ----------------------------\n    + Added Brazil translation (Michel Braga Guimar\u00e3es);\n\n    Bugfixes:\n    --------\n    + UI fixes;\n    + Fixed bug where last page of IP addresses was inaccessible;\n    + IP address state change is now sent to all admins;\n    + Fixed subnet displaying as 0.0.0.0/0 in details;\n    + Fixed links to subnets form vlans and vrfs;\n    + Fixed search result showing all folders if searched item is not IP address;\n    + Fixed disapearing section when L2 section was selected as master section;\n    + Fixed device ID showing in mail notification instead of hostname;\n    + Fixed device ID showing in search results and export instead of hostname;\n    + Fixed search for subnet name returned no results;\n    + Fixed apostophe in IP address description throws SQL error for scan results and XLS import;\n    + Fixed requester email gets cut if longer than 32 chars;\n    + Fixed admin folder edit appearing as subnet;\n    + Fixed missing device/port in import;\n    + Fixed master section delete did not delete subsections and belonging subnets/ips;\n    + Fixed online status was not updated when running Ping status scans;\n    + Fixed Folder name not appearing when deleting folder;\n\n== 0.9\n\n    New features:\n    ----------------------------\n    + Support for ICMP network discovery;\n    + Cron script to check status for selected subnets/hosts with threading suport (pcntl php extension required);\n    + ICMP check IP status in demand;\n    + Compressed (grouped) DHCP IP ranges;\n    + API server version 0.1;\n    + Option to show and group subnets by VLAN in subnets list;\n    + Option to show and group subnets by VRF in subnets list;\n    + Added subsections;\n    + Added AD username search;\n    + Added folders;\n\n    Enhancements:\n    ----------------------------\n    + Added error catching/displaying for ajax-loaded php scripts;\n    + Added default language for login/requests display and new users;\n    + Added direct links to different pages in IP address table;\n    + Subnets can now be edited directly from nested subnets list;\n    + When adding nested subnets default vlan/vrf is selected from parent;\n    + Added Section ordering;\n    + Added per/section subnet ordering (overrides dafault form settings);\n    + Clicking on section now shows all subnets and belonging details;\n    + If session timeouts after re-login last requested page will be opened;\n    + Searh for IP address now returns also subnet, even if IP is not existing;\n    + Per-user selection of widgets to display;\n    + Added description and required field checkbox for custom IP/Subnet Fields;\n    + Added custom device fields;\n    + Mails are now sent through phpmailer;\n    + Admin user cannot be deleted;\n\n    Translations:\n    ----------------------------\n    + Added French translation (Denis Darr\u00e9);\n    + Added Dutch translation (Michiel Visser);\n    + Added German translation (Carsten Br\u00fcckner);\n\n    Bugfixes:\n    ----------------------------\n    + Fixed wrong VLAN display in tools;\n    + Fixed subnet/section links from VLANS if base not /;\n    + Fixed warning in apache log on subnet editing if no VRFs are configured;\n    + Fixed admin menu off-screen overflow;\n    + Fixed firefox error when selectiong rights for section/subnets was not possible;\n    + Fixed subnet description in Cyrillic problem;\n    + Fixed errors on no permissions for user;\n    + Fixed Inaccurate Free Space Calculation (and Chart);\n    + Fixed VLAN permissions where VLAN was not displayed;\n\n== 0.8\n\n    New features:\n    ----------------------------\n    + New group and permission management;\n    + Support for translations;\n    + Subnet resizing;\n    + Subnet splitting into smaller subnets;\n    + Added free space display for nested subnets;\n    + Added visual display of subnet usage per IP address;\n    + Added truncate network option that deletes all IP addresses in subnet;\n    + Added button the updates subnet with RIPE information;\n\n    Enhancements:\n    ----------------------------\n    + Added add nested subnet under subnet details to simplify master subnet selection in hierarchy;\n    + Added edit subnet link from search results;\n    + Added reverse IPv6 DNS entries to IPCalc (Vincent Boisard);\n    + Added option for plain-text emails;\n    + Added ckEditor to write instructions;\n    + StrictMode is not set globally anymore but set per section;\n    + Added custom user fields;\n    + Added option to verify that hostname is unique;\n    + Improved MySQL exception handling;\n    + Added mod_rewrite error detection on installation and upgrade;\n    + Added hostname validation;\n    + Added Hostfile dump of IP addresses;\n    + Search also searches in custom fields;\n    + jQuery updated to v 1.9.1;\n\n    Bugfixes:\n    ------------------------\n    + Fixed overlay on second popup;\n    + Fixed IE search bug;\n    + Fixed support for non-standard ports;\n    + Fixed permitting overlapping subnets if vrfs are different;\n    + Fixed dates in logging appearing in 12h format;\n    + Fixed broken subnets link in tools > subnets if installation is not at document root;\n    + Fixed error when adding new subnet if checkboxes are not selected in newer MySQL servers;\n    + Fixed bad display of multilined navigation bar;\n    + Fixed wrong output of tools > VLAN list when using Duplicate VLANs;\n    + Fixed wrong link for upgrade script;\n    + On VRF change all child subnets are updated also;\n    + Fixed wrong maximum on dashboard top10 percentage;\n    + Fixed Adding a vlan while editing a subnet resets the edit subnet form;\n    + Fixed wrong free space calculation for nested subnets;\n    + Fixed IP use statistics not cumulative up the hierarchy if subnes has slaves;\n\n== 0.7\n\n    New features:\n    ----------------------------\n    + Completely rewritten UI using twitter's bootstrap as base;\n    + Using mod_rewrite apache module to handle GET requests (new install requitements!);\n    + Unlimited number of subnetting levels;\n    + OpenLDAP authentication support;\n    + New URL structure;\n    + Sorting of IP addresses;\n    + Custom subnet fields;\n    + Custom VLAN fields and admin option to allow duplicate VLAN names (metro area VLANs);\n    + Script to automatically update IP <-> hostname, run via cron (functions/scripts/resolveIPaddresses.php);\n    + Show Subnet name instead of subnet IP address option;\n    + Strict mode option in config files that controlls overlapping checks;\n    + New subnet menu;\n    + Added printLimit feature to break IP addresses into pages;\n\n    Enhancements:\n    ----------------------------\n    + Lots of UI changes;\n    + Less Ajax usage to display websites and details;\n    + Hierarchy display under subnet details (breadcrumbs);\n    + Search results covering VLANs;\n    + Custom IP fields ordering;\n    + VLAN creation from adding/editing subnets;\n    + IP addresses can now be edited;\n    + Collapsed switch list;\n    + Removing VLANs also removes references from subnet list;\n    + Removing VRFs also removes references from subnet list;\n    + Logs for admin on dashboard;\n    + Search via GET;\n    + Support for range networks (allows use of subnet and broadcast as IP);\n    + Import of custom IP fields;\n    + Abiility to move subnets between sections;\n    + Improved display of nested subnets now shows all IP addresses from nested subnets and orphaned IPs;\n    + Hides display of custom fields in subnet if none is filled in whole subnet;\n    + Replaced Highcharts with Flot because of licencing issues;\n\n    Bugfixes:\n    ------------------------\n    + Fixed error with missing custom IP fields when adding new IP address;\n    + Fixed bug when deleteing root subnet only deleted directly nested subnets (now whole tree);\n    + Fixed checkboxes not working in various browsers;\n    + Fixed change in switch details causing IP address associations to switch to be lost;\n    + Fixed subnet description display in under subnet administration;\n    + Fixed depricated error when showing XLS files;\n    + Fixed error when custom fields were not updated on adding IP address;\n    + Fixed error when custom fields were with spaces in name were not updated;\n    + Fixed error when providing already requested IP address;\n    + Search available also to viewer user types;\n    + Fixed /127 and /128 IPv6 subnets;\n    + Fixed /31 and /32 IPv4 subnets;\n    + Significally reduced php processing for dashboard statistics;\n    + Fixed importing of if quote is present;\n\n== 0.6\n\n    New features:\n    ----------------------------\n    + Selectable IP address list display fields;\n    + Custom IP address fields;\n    + Search and replace IP fields function;\n    + Full page width theme;\n\n    Enhancements:\n    ----------------------------\n    + Independant VLAN management;\n    + Added additional level of subnet nesting;\n    + Added option to clear and export log files;\n    + Export of search results to XLS;\n    + Clickable search results;\n    + Selectable export fields when exporting subnet;\n    + Subnet can be deleted from ip address edit subnet;\n    + IP Requests for locked subnets and viewer users can be placed from ip address list;\n    + jQuery updated to v 1.7.1;\n    + HighCharts updated to v 2.2.0;\n\n    Bugfixes:\n    ------------------------\n    + Upgrade is supported only for versions 0.4 and higher;\n    + Fixed broken UTF-8 support;\n    + Fixed wrong logging when authenticating via AD;\n    + Fixed issues where external attacker might get information about internal hosts through resolvedns script;\n    + Fixed wrong subnet nesting under administration/manage subnets;\n    + Fixed editing subnet can be outside of its own root subnet;\n    + Fixed errors when adding new switch auto-adds itselt to all hosts without no switch defined;\n    + Fixed removing switch not removed in ip address list;\n    + Vlan1 can now be used;\n    + Fixed mail sending settings with missing information;\n    + Fixed errors on adding switch with no sections;\n    + Fixed version check;\n    + Removed masterSubnets from subnets available for IP requests;\n    + Fixed error when non-admin user could not open dashboard;\n    + Added how subnet list switch when list hidden;\n\n== 0.5\n\n    New features:\n    -------------\n    + Importing subnets from RIPE by AS in admin section;\n    + Added switch management and changed switch logic;\n    + Added VRF support;\n    + Added AD domain authentication;\n    + Added MAC address field to ip address;\n    + Added database table and belonging fields check under admin;\n\n    Bugfixes / enhancements:\n    ------------------------\n    + Added DNS resolving when editing/adding IP address;\n    + Added IE compatibility meta tag and IE UI improvements for IE >= 8;\n    + Search returns also subnets and MAC searches;\n    + Added mac address and IP status to XLS import/export scripts;\n    + jQuery update from 1.6.2 to 1.7;\n    + Highcharts update from 2.1.2 to 2.1.8;\n\n    + Fixed dashboard errors if no IPv4/IPv6 subnets configured;\n    + Fixed errors with viewing / modifying IP addresses for Operator users;\n    + Fixed session cookie error on hosts;\n    + Fixed error when saving settings;\n    + Fixed instructions errors when inserting html code;\n    + Fixed first free IP address not displaying in IP request;\n\n\n== 0.4\n\n    New features:\n    -------------\n    + Massive add / edit / delete by specifying IP range (e.g. 10.10.0.1 - 10.10.0.254);\n    + Database upgrade / install from browser -> simplified installation/update procedure;\n    + New usertype viewer - can only view IP address list;\n    + Subnets can now be edited directly from IP address list;\n    + Option to lock subnet for writing to no-admin users;\n    + Device and Host list;\n    + Option to specify which subnet can have IP requests when editing / adding subnet if module is enabled;\n    + Latest version check on admin page;\n\n    Bugfixes / enhancements:\n    ------------------------\n    + Fixed overspanning of multiple sections;\n    + Admin menu and add subnet now shown only to admins;\n    + Fixed VLAN table to show nesting and IP request option and statistics;\n    + Fixed subnet table to show nesting and IP request option;\n    + Subnet Adding shows only master subnets in section not in all sections;\n    + Tooltips and button hovers are now in separate javascript file;\n    + Graphs show only subnets with non-0 ip addresses;\n    + Various code enhancements + improved error handling;\n    + Fixed URL links not updating after few clicks;\n    + If loading slave subnet directly the subnet menu drops down and shows active slave subnet;\n    + Clicking on master shubnet shows all nested subnets and statistics;\n    + Redesigned log table;\n    + Fixed search;\n\n== 0.3\n\n    New features:\n    -------------\n    + Subnet nesting - you can now have master subnet and normal subnets belonging to it;\n    + Server settings are now moved to database and can be set under admin menu (database settings & debugging remain in config.php);\n    + Request IP module on login page with email notification;\n    + Confirm/reject IP address request from admin page with mail notification;\n    + Admin dashboard notification of new requests;\n    + Autocomplete of owner and Switch name from all available when adding/editing IP address;\n    + New settings quick access on button hover;\n    + Option to export each subnet indivudually;\n\n    Bugfixes / enhancements:\n    ------------------------\n    + jQuery update from 1.6 to 1.6.2;\n    + VLANs are now grouped by section;\n    + Direct access to subnet from vlan table;\n    + UI enhancements;\n    + Fixed user editing bug where user update broke password;\n    + Fixed password in new account notification;\n    + Fixed percentage display on Dashboard;\n    + IPv6 calculator /64 limit fixed;\n    + Changed tooltip effect to appear instantly for smoother display;\n    + Login functions are now separate file;\n\n\n== 0.2 (First public version)\n\n    Bugfixes / enhancements:\n    ------------------------\n    + now also works with php 5.2;\n    + fixed empty fields in xls import;\n    + passwords are now stored in md5 hash;\n    + high numbers for free/used IP addresses (mainly IPv6) are now represented in k/m/G values to improve readibility;\n    + fixed log search bug;\n    + cursor not displayed as link on images and non-href links;\n    + same add image on all pages;\n    + fixed IP mail notification apperance;\n    + UI enhancements and bugfixes;\n    + Fixed some javascript bugs;\n    + Minified javascript to make loading faster;\n    + adding new ip address now automatically provides first available IP address in subnet;\n\n    New features:\n    -------------\n    + added switch / port fields to IP addresses;\n    + hide subets on request to get better view;\n    + Informational tooltips added + option to disable them in config file if someone finds them annoying;\n    + export whole IP address database to XLS file from admin menu;\n    + create MySQL database dump from admin menu;\n    + added IP instructions for users, that can be edited from admin menu;\n\n\n== 0.1 (First test version)\n"], "fixing_code": ["<?php\n# config, objects\nrequire_once( dirname(__FILE__).'/../../../functions/functions.php' );\n\n# initialize objects\n$Database\t= new Database_PDO;\n$Result\t\t= new Result;\n$User\t\t= new User ($Database);\n# verify that user is logged in\n$User->check_user_session();\n\n// process input values\n$tcp   = filter_var($_POST['wsize'], FILTER_VALIDATE_INT,   [\"options\" => [\"min_range\"=>1024, \"max_range\"=>65536]]) ?: die(_(\"Invalid input\"));\n$delay = filter_var($_POST['delay'], FILTER_VALIDATE_FLOAT, [\"options\" => [\"min_range\"=>0.1,  \"max_range\"=>1000]])  ?: die(_(\"Invalid input\"));\n$fsize = filter_var($_POST['fsize'], FILTER_VALIDATE_FLOAT, [\"options\" => [\"min_range\"=>100,  \"max_range\"=>4096]])  ?: die(_(\"Invalid input\"));\n\n// get mbps values from config\n$mbps = round($tcp/($delay/1000)/(1024*1024), 4);\n\n// Calculate transfer time\n$time = round(($fsize / $mbps), 2);\n\n// set network type\nif($delay<1)\t\t{ $type = \"LAN\"; }\nelseif($delay<20)\t{ $type = \"MAN\"; }\nelse \t\t\t\t{ $type = \"WAN\"; }\n?>\n\n<hr>\n<p>\n\n<strong><?php print _(\"Transfer time (h:m:s)\"); ?>:</strong>\n<div class='res_val'><?php print $User->sec2hms($time); ?></div>\n\n<?php if(!isset($_POST['widget'])) { ?>\n<div class=\"clearfix\"></div>\n\n<br><br>\n<strong><?php print _(\"Calculation parameters\"); ?>:</strong>\n<ul>\n\t<li> <?php print _(\"TCP window size\").\": $tcp\"; ?></li>\n\t<li> <?php print _(\"Delay\").\": $delay\".\" \"._(\"ms\"); ?></li>\n\t<li> <?php print _(\"Speed\").\": $mbps\".\" \"._(\"MBps\"); ?></li>\n\t<li> <?php print _(\"Newtork type\").\": $type\"; ?></li>\n\t<li> <?php print _(\"File size\").\": $fsize\".\" \".\"MB\"; ?></li>\n</ul>\n</p>\n<br>\n<?php } ?>", "== 1.6.0\n\n    Enhancements, changes:\n    ----------------------------\n    + php8.1 compatibility (php8.x support is work-in-progress);\n\n    Security Fixes:\n    ----------------------------\n    + XSS (reflected) in 'bw-calulator-result.php';\n\n== 1.5.0\n\n    New features:\n    ------------\n    + Mark subnet as isPool to allocate network and broadcast addresses;\n    + Optionally hide section subnet menus;\n    + L2 Domains user permissions;\n    + Add scanPingType==\"none\" option to disable scanning;\n    + Custom fields on IP request forms (#2956);\n    + Added subnet free space map for each possible subnet mask;\n    + Added Vaults (Certificate andf password storing);\n    + Added Tools->Duplicate subnets & IP page;\n    + Added config.php offline_mode to disable server-side Internet lookups (#3462);\n    + Added MAC vendor lookup widget;\n\n    Enhancements, changes:\n    ----------------------------\n    + php7.4 compatibility;\n    + SameSite attribute enabled for site cookies;\n    + SAML2\n        + php-saml updated to 3.4.1 (#3055);\n        + Removal of php-mcrypt dependancy;\n        + Drop support for idpcertfingerprint;\n        + MAP_SAML_USER and SAML_USERNAME config.php configuration moved to db;\n        + php-saml protocol debugging;\n        + Support for signed assertions;\n        + SAML usernames can be extracted from assertion attributes (#2948);\n        + JIT auto-provisioning of accounts (#3389);\n    + Selectable mask for number of subnets/hosts in subnet masks;\n    + Switch from Google Maps to OpenStreeMap and Nominatim;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed upgrade queries issues from 1.3.x to 1.4+ (#3130);\n    + Fixed boolean printout in footer (#2625);\n    + Fixed BGP Admin isn't working (#2631);\n    + do not show statistics in dashboard widget for disabled modules (#2602);\n    + MySQL 8.0 compatibility. (#2646,#2239,#3036);\n    + MariaDB Galera Cluster compatibility (#2498,#3413);\n    + Permit non-numeric postcodes for customers (#2393);\n    + Bandwidth calculator - 400 Bad Request (#1807,#2648);\n    + Table layout not aligned (#2656,#3105,#3113);\n    + Improve scanning requirement checks (#1183);\n    + Date picker hidden (#2673);\n    + PDNS Add/Edit DNS record not working for normal users (#2686);\n    + Unable to save settings with link addresses = text custom field (#2702);\n    + Kea MAC address display issue (#2704);\n    + Returned custom fields to devices table (#2572);\n    + Invalid scan agent key warning;\n    + Subnet filter issue when IP contains 0 octet. (#2748);\n    + Add VLAN button not working (#2741);\n    + Incorrect subnet links in /tools/vrf/ view. (#2774);\n    + Location data missing in exports. (#2833);\n    + Check mysqldump path when exporting database;\n    + Current rack position missing when editing a device. (#2545);\n    + Permit colon in firewall zone interface names (#2737);\n    + Fixed PowerDNS txt SPF editing (#1641);\n    + Blank 'MAC' on SNMP-ARP and SNMP-MAC scans (#2911);\n    + Incorrect network/broadcast calculation for IPv6 (#2879);\n    + Increase allowed email and password lengths (#3021);\n    + Wrong unit location for dual-sided racks (#3086);\n    + Linked ip_addr shows integer notation (#3100);\n    + Invalid scan type () error (#2785);\n    + Invalid CSRF cookie editing rack items (#2556);\n    + FPing discovery marks all addresses as alive (#2888);\n    + Subnet usage calculation updated for nested subnets;\n    + SNMP, number of discovered hosts exceed maximum warning (#3279);\n    + Exclude IPv6 from Ping and Discovery scans (#3354);\n    + Fix for SAML/2FA/login redirections (#3492, #3435, #3517);\n    + php_sessions table doesn't exist error when upgrading (#3417);\n    + Changelog data too long for column errors (#3376,#3398);\n    + RFC 6265 compliant cookies (#3452);\n    + Require unique subnets not working as intended (#3529);\n    + API:\n        + Fixed /user/ calls for SSL with app code (static app code);\n        + Address IP field not displayed when using filter_by (#2934);\n        + Addresses first_free & Subnets first/last_subnet thread safety (#2960);\n\n    Security Fixes:\n    ----------------------------\n    + SQL injections processing `tableName` (#2738);\n    + SQL injections processing `ftype` (#2751);\n    + All circuits map, PHP object injection (#2937);\n    + Upgraded jQuery to 3.5.1 (#3119);\n    + Stored XSS in instructions widgets (#3025, #3360);\n    + PHP session ID fixation (#3342);\n    + XSS (reflected) in IP calculator (#3351);\n    + XSS in pass-change/result.php (#3373);\n    + SQL injection in edit-bgp-mapping-search.php;\n    + Stored XSS in the \"Site title\" parameter;\n    + XSS while uploading CVS files;\n    + XSS (reflected) in 'find subnets';\n    + Incorrect privilege assignments (#3506);\n    + XXS (reflected) in ripe-arin-query;\n    + XSS (reflected) in import previews;\n\n    Translations:\n    ----------------------------\n    + Update Traditional Chinese support to version 1.5 (#2658);\n    + Update Simplified Chinese Translation (#2725);\n    + Italian (it_IT) translation added (#2813);\n    + Updated German translation (#2970, #3065);\n    + Updated Russian translation (#3028, #3367);\n\n== 1.4.0\n\n    New features:\n    ------------\n    + Configurable password policy;\n    + Sessions can be now stored in database (#516);\n    + Two-factor authentication - otp (Google Authenticator);\n    + Customers module (#694);\n    + Routing module (BGP) (#2135);\n    + Search for free subnet inside whole section;\n\n    Enhancements, changes:\n    ----------------------------\n    + Circuits enhancements (Virtual Circuits);\n    + Dropped support for 32bit systems;\n    + PHP 5.4 is now required;\n    + Added compressed actions dropdown;\n    + SNMP module no longer requires MIB files;\n    + Performance enhancements running under Azure/Amazon;\n    + Added option to disable user (#1327);\n    + Added policy NAT option;\n    + Added custom NAT fields;\n    + Rack module enhancements (#1325):\n        + Dynamic rack sizes;\n        + Top-down / Bottom-up racks;\n        + Custom rack devices independent of devices (power, patch panel);\n    + Customized user permissions for modules:\n        + VLAN module;\n        + VRF module;\n        + PowerDNS module;\n        + Circuits module;\n        + Customers module;\n        + Devices module;\n        + Rack module;\n        + NAT module;\n        + PSTN module;\n        + Locations module;\n    + API:\n        + New API security type - SSL with app code (static app code);\n        + New config.php option $api_allow_unsafe to allow non-SSL API queries;\n        + Added last access field to api;\n        + Add Mac Search for Addresses controller (#2005);\n        + New overlapping API call;\n        + New global API parameter filter_match = full,partial,regex;\n        + Add Tools API customers submodule;\n        + Fix filtered results to always return data as array (#2558);\n    + Widgets:\n        + New user instruction widget (#2383);\n\n    Translations:\n    ----------------------------\n    + Japanese (ja_JP) translation added;\n    + Traditional Chinese (zh_TW) translation added;\n\n    Bugfixes:\n    ----------------------------\n    + Fix appended \" U\" in Rack description (#2046);\n    + Fix Bandwidth calculator - 400 Bad Request. (#1807);\n    + Fix bad DNS reverse zone for /23 subnet (#666);\n    + Fix Add missing standard field (#2153);\n    + Fix Consistency of VARCHAR Size on 'owner' column across tables (#2136);\n    + Fix Subnet details - Filter button missing when compressed range is used (#2353);\n    + Fix slow page load times with linked addresses (#2324);\n    + Fix \" - is required\" error when adding IPs with an empty IP filter set (#2334);\n    + Fix column 'masterSubnetId' cannot be null error when adding subnets (#1977);\n    + Fix logical circuits add/delete errors (#2381);\n    + Fix adding new VLANs to an empty L2Domain (#2400);\n    + Fix Nested child subnets with \"na\" permissions visible (#2223);\n    + Fix translations containing apostrophes break functionality (#2504);\n    + Set requestedAuthnContext to false for SAML (#2457);\n    + API:\n        + Fix inconsistent API success value returned (#2045);\n        + Fix filter_by functionality (#2392);\n        + Fix PATCH functionality (#2470, #2481);\n\n    Security Fixes:\n    ----------------------------\n    + Hide SNMP community (#2197);\n    + Hide LDAP/AD/Radius username / password and secret from logs and syslog (#2006);\n    + XSS in phpipamredirect cookie (#2338);\n    + XSS in print-user.php, CSRF in user-edit.php (#2326);\n    + Possible SQL injection in nat/item-add-submit.php (#2344);\n    + Fixed possible file inclusion in editing authentication methods;\n    + XSS in subnet-scan-telnet.php, CSRF in subnet-scan-execute.php (#2327);\n\n== 1.3.2\n\n    Enhancements, changes:\n    ----------------------------\n    + Dark theme added;\n    + Full php7.2 compatibility;\n    + url_rewrite has changed, please use new rewrite scheme (https://phpipam.net/news/new_rewrite_scheme/);\n    + Search for matching subnet in all VRFs feature enabled when importing addresses;\n    + Added new config option to show custom fields separated from standard fields when editing IP address;\n    + Added Required fields subpage to define IP address fields that must be filled in;\n    + Performance + bug fixes (#1660, #1657);\n    + MasterSubnet dropdown list is dynamically generated via AJAX call;\n    + Bandwidth calculator;\n    + Support 8U rack sizes. (#1891);\n    + API:\n        + New last_subnet API calls (#1655);\n\n    Translations:\n    ----------------------------\n    + German translation updated to verson 1.3.1;\n    + French translations updated. (#1881);\n\n    Bugfixes:\n    ----------------------------\n    + Fixed uncaught error if vlan number exceeds max permitted (#1455);\n    + Fixed Illegal string offset 'dns_name' in pingCheck.php errors (#1461);\n    + Performance fix for subnet_dropdown_print_available (#1562);\n    + Fixed logo updater for apache v2.4 (#1582);\n    + Fixed section names containing spaces are not included in exports (#1566);\n    + Allow DNS wildcard records (#1571);\n    + Fixed slow mac address vendor decoding for subnet detail view (#1658);\n    + Performance fix for detecting overlapping subnets. (#1052, #1426, #1533);\n    + Performance fix for slow mac address vendor decoding (#1658);\n    + Performance fix for subnet API first_subnet & all_subnets calls;\n    + Performance fix for delegating subnet permissions;\n    + Convert to UTF-8 encoding on import/export to preserve dialectics (#1659, #1700, #1728);\n    + Importing IPs loose Mac Addresses (#1607);\n    + Section names containing spaces are not included in exports. (#1566);\n    + Bug with section and dashboard (#1593);\n    + Fixed improper contents in plain text part of notification e-mails (#1707);\n    + Reduce size of email notifications (#1643);\n    + PHP 5.3 compatibility fixes (#1594, #1730);\n    + PHP 7.2 compatibility fixes (#1683, #1714);\n    + Fixed notification e-mails contain a broken link. (#1708);\n    + Allow dots to be used in domain names. (#1747);\n    + Use multi-byte compatible functions when shortening text. (#1753);\n    + Scan subnet reports/selects invalid php path. (#1757);\n    + Small code refactoring (#1699);\n    + Rack device start position overwritten. (#1545);\n    + Sections with folders returns no subnets using API. (#1883);\n    + Add custom_ prefix to Prefix controller custom fields. (#1836);\n    + Non-Admins missing the button to Add circuit. (#1902);\n    + Wrong field name of deviceTypes table when checking device type. (#1910);\n    + SNMPv3 improvements;\n    + Misc IPv6 fixes;\n\n    Security Fixes:\n    ----------------------------\n    + Code injection in Name field. (#1667);\n    + XSS (reflected) in SubnetID param. (#1702);\n    + CSRF enables open mail relay. (#1703);\n    + Reflected XSS requiring user interaction on search. (#1705);\n    + XSS reflected via CSRF in preview.php. (#1706);\n    + Reflected XSS via CSV upload. (#1742);\n    + Reflected XSS on 'mac' parameter. (#1903);\n\n== 1.3.1\n\n    New features:\n    ------------\n    + Circuits module (circuits, providers, map, ...) (#731);\n\n    Enhancements, changes:\n    ----------------------------\n    + Racks:\n        + Automatic location assignment when device added to rack (#1230);\n        + Rack map showing map of all racks in location;\n        + Rack back side;\n    + Compact menu layout (per-user setting, showing only icons);\n    + Network to network static nat;\n    + Selectable logo size (from config.php) (#952);\n    + Added default option for permissions propagations (#1351);\n    + API:\n        + Added Circuits controller;\n        + Encrypyted requests can now also be form-encoded (#1191);\n        + Introduce mcrypt AES compatibility (#1516);\n        + Fixed field ip not displayed when filters applied (#1529);\n    + New resolve hostnames option for subnet (#1222):\n        + Updates hostnames via pingCheck.php script (if parameter set for subnet);\n        + Updates hostnames via resolveIPaddresses.php script (if parameter set for subnet);\n        + On-the-fly empty hostname update if resolved (if parameter set for subnet and enabled globally);\n        + Added this infor to tools > scanned networks;\n    + Added custom_ prefix to custom field names to avoid duplication with custom fields (#1387);\n    + Added option to hide IP requests for unauthenticated users on login page (#1394);\n    + Performance optimizations for locations and subnet usage calculation;\n    + Added user groups custom fields;\n\n    Translations:\n    ----------------------------\n    + French translation updated to verson 1.3;\n    + German translation updated to verson 1.3;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed RACK images not displayed if not root location (#1204);\n    + Fixed import gateway ip (#1240);\n    + Fixed JSON_UNESCAPED_UNICODE for PHP 5.3 (#1135, #1245);\n    + Rename class Thread to PingThread to avoid naming conflict with pthreads Thread class (#1254);\n    + Fixed custom fields integer on subnet (#1266);\n    + Fixed Import Ip-adress doesnt update location (#1284);\n    + Fixed json_error for logo upload (#1256);\n    + Fixed CSRF error when moving orphaned addresses (#1303);\n    + Fixed VRF fetching via API by Id;\n    + Fixed map issues when quotes are in name/description (#1384);\n    + Fixed item not removed from NAT when deleted (#1378);\n    + Fixed Error when error_reporting = E_ALL about strict standards when importing IP addresses (#1372);\n    + Fixed Apostrophe errors in text custom fields (#1375);\n    + Fixed API error when creating address under folder (#1507);\n    + Fixed SNMPv3 (#1119);\n\n    Security Fixes:\n    ----------------------------\n    + Fixed XSS issues (#1403, #1521, #1500);\n\n== 1.3.0\n\n    New features:\n    ------------\n    + Multicast module (RFC1112, RFC2464) with IP to MAC mapping and multicast networks overview;\n    + Threshold module for subnets;\n    + Racks module (Rack drawing) for devices;\n    + Address linking by selected field;\n    + Custom logo for site and mails;\n    + PSTN number management module;\n    + SNMP module:\n        + Subnets discovery from route table (all subnets, nested subnets, add new subnet);\n        + Hosts discovery scans via ARP check/interface check;\n        + Hosts discovery scans via ARP + MAC address check (detects interface);\n        + VLAN discovery;\n        + VRF discovery;\n        + Status update scans via ARP check;\n    + NAT module\n        + Source / static / destination NAT;\n        + Linking subnet to NAT\n        + Show bindings under tools and next to IP address / subnet\n    + Locations module\n        + Map devices / racks / subnets to location;\n        + Google maps integration;\n    + SAML2 authentication (SSO)\n\n    Enhancements, changes:\n    ----------------------------\n    + Folders can now contain addresses;\n    + API:\n        - Api v1 removed;\n        + If subnet gateway defined gatewayId is returned in subnet details;\n        + Automatically added nameservers to subnet results;\n        + Added subnet usage result for each subnet in section;\n        + Added custom fields for all controllers;\n        + New subnets automatically get parent permissions;\n        + Added IP calculation to subnet;\n        + Changed all not_found when searching objects to 404 and all invalid parameters to 409 (conflict);\n        + If new item is created id will be available in response field \u201cid\u201d;\n        + New parameter $time_response in api/index.php that will return execution time in field \u201ctime\";\n        + Extensive first_free subnet calls search speedup;\n        + POST transaction locking;\n        + All first_free and first_address responses are now \"data\" instead of \"ip\" and \"subnet\" for consistency;\n        + Subnet splitting now copies over custom fields values by default (user custom_fields=no to revert);\n        + Added API option to nest custom_fields to assure correct structure;\n        + Added option to show/hide links in api by default for each app;\n        + Changed API http response codes;\n        + New methods:\n            + users:\n                GET    /user/expires/                         // returns token expiration date\n                GET    /user/token-expires/                   // returns token expiration date\n                GET    /user/users/                           // returns all users (rwa app permissions required)\n                GET    /user/admins/                          // returns all admin users (rwa app permissions required)\n            + addresses:\n                GET    /addresses/first_free/{subnetId}/      // returns first available address (subnetId can be provided with parameters)\n                GET    /addresses/{ip}/{subnetId}/            // returns IP address from subnet\n                GET    /addresses/search/{hostname}/          // Will search addresses by hostname\n                DELETE /addresses/{ip}/{subnetId}/            // deletes IP address from subnet\n                POST   /addresses/first_free/{subnetId}/      // will search for first free address in subnet, creating new address\n            + subnets:\n                GET    /subnets/{id}/addresses/{ip}/          // returns IP address from subnet\n                GET    /subnets/{id}/first_free/              // returns first free address in subnet\n                GET    /subnets/{id}/first_subnet/{mask}/     // returns first available subnets with specified mask\n                GET    /subnets/{id}/all_subnets/{mask}/      // returns all available subnets with specified mask\n                POST   /subnets/{id}/first_subnet/{mask}/     // creates first free subnet under master with specified mask\n                DELETE /subnets/{id}/permissions/             // removes permissions\n                PATCH  /subnets/{id}/permissions/             // sets subnet permissions (?grouname1=ro&groupname2=3&43=1)\n        + New controller Prefix;\n        + New controller Devices;\n        + New subcontrollers:\n            + /tools/nat/\n            + /tools/racks/\n            + /tools/locations/\n    + Widgets:\n        + New threshold widget;\n        + New inactive hosts widget;\n        + New Locations widget;\n    + PowerDNS:\n        + Default domain for PTR records (if hostname is not set);\n        + When removing IP address additional option that removes all associated PDNS records (ip and hostname);\n    + Permit normal users to manage VLANs / VRFs;\n    + Inactive (offline) hosts tools page;\n    + MAC address normalization;\n    + jQuery tables;\n    + Permission delegation now only delegates changes not whole permission set;\n    + Users with RWA permission can manage IP requests and receive IP request mails + changelog mails for subnet;\n    + IPv4 subnet link to IPv6 for dual-stack info;\n    + Removed inacessible DNS servers if timeout to prevent page load timeouts;\n    + Added option to only show supernets to limit pageload [#844 #816 #736];\n    + Added last scan info to subnet details;\n    + Added option to update address tags when address state change occurs (pingCheck) [#840];\n    + Added mantaneance mode;\n    + Added inactive addresses removal script;\n    + Subnet overlapping now checked also inside folders to prevernt duplicates;\n    + Subnet overlapping now checked also between sections if VRF defined;\n    + Added new settings directive that requires unique subnets accross sections;\n    + Added index check in verify database to detect and fix possible missing DB indexes;\n    + Added MAC address vendor display option;\n\n    Bugfixes:\n    ----------------------------\n    + PowerDNS regenerate PTR records now only updates current subnet (before whole zone);\n    + Fixed visual bug on 32-bit systems;\n    + Normal users with RWA permissions can scan subnets;\n    + Changed default timestamp from 0000-00-00 00:00:00 to 1970-01-01 00:00:01 to avoid SQL install errors if strict mode;\n    + Fixed https access on non-standard ports;\n    + Extended username to 255 chars for LDAP logins;\n    + Fixed search export invalid encoding and data may have been lost XLS file error;\n    + Fixed invalid character encoding in API responses;\n    + PowerDNS records cannot be created on slave zone;\n    + Fixed subnet resizing bug if subnet contained slaves;\n    + Added separate CSRF cookies for each address/subnet/pstn object;\n    + Deleted items are now shown and searchable from changelog;\n\n== 1.20.1\n\n    Translations:\n    ----------------------------\n    + French translation updated to verson 1.2;\n    + German translation updated to verson 1.2;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed upgrade bug that selected invalid auth method for AD/LDAP users;\n    + Fixed LDAP problems after 1.2 upgrade;\n    + Fixed PowerDNS Slave with multiple masters delimiter error;\n    + Fixed PowerDNS PTR records not being updated automatically;\n    + Fixed csrf cookie bug when editing folder;\n    + Fixed csrf cookie bug when truncationg subnet;\n    + Fixed invalid code for API crypt method;\n    + Fixed strange headings font display in Firefox;\n    + Fixed invalid proxy settings in config.dist.php;\n    + Fixed search same hostnames in db link form address table;\n    + Fixed import subnet bug caused by fw object;\n    + Fixed Subnet Import (Preview button > no action);\n\n== 1.20\n\n    New features:\n    ------------\n    + Added multiple simultaneous authentication methods (Apache, AD, LDAP, Radius, NetIQ);\n    + Added fping scanning support;\n    + Added selectable scanning type (ping/pear/fping);\n    + Added L2 domains;\n    + Added option to define address as default GW for subnet;\n    + Added customizable address tags with compressed option;\n    + Added temporary subnet / address shares;\n    + Added quick subnet masks;\n    + Added nameserver sets per subnets (jonashauge);\n    + Added optional syslog as log location;\n    + REST API:\n        + documentation: http://phpipam.net/api-documentation/\n        + API v2, old v1 support added\n        + Complete rewrite of all API calls;\n        + New security models (crypt, ssl, none);\n        + Support for custom fields;\n        + JSON / XML output\n        + Full read/write controllers (Sections, Subnets/Folders, Addresses, Vlans, Vrfs);\n    + PowerDNS integration:\n        + Automatic reverse records creation (PTR) - IPv4 and IPv6;\n        + Automatic SOA, NS record creation;\n        + DNS domain management;\n    + Added Scan agents to scan subnets remotely;\n    + Added firewall zone mappings and module;\n    + Added per-subnet DNS resolvers;\n    + Added option to mark subnet as utilized (full);\n\n    Enhancements:\n    ----------------------------\n    + All tables are now InnoDB by default;\n    + Upgraded jQuery to 2.1.3;\n    + All functions rewritten to classes/methods;\n    + Parametized all SQL queries, moved from MySQLI to PDO;\n    + Added VLAN/VRF to search and to search results export;\n    + Redesigned admin and tools menu;\n    + Added scanned/discovered subnets to tools for faster overview;\n    + Per-user display settings;\n    + New widget - tools shortcuts;\n    + New widget - IP calculator;\n    + New widget - request IP address;\n    + Clickable links for subnet fields;\n    + Custom VRF fields;\n    + Subnets can be now linked to devices;\n    + Import/export enhancements;\n    + Fast user switching for admins to impersonate user;\n    + Opened folders and subnets in tree menu are saved on page reload;\n    + RWA users can now process IP requests;\n    + Added auto-suggest for possible slave subnets;\n    + SSL option for MySQL connections;\n    + Enum custom field support;\n    + Added password reset script;\n    + Set sections to display VRF in;\n\n    Security Fixes:\n    ----------------------------\n    + Parametized all MySQL querries;\n    + Fixed plainpass being logged on user update;\n    + Fixed XSS exploit on /error/;\n    + Added CSRF protection to forms;\n\n    Translations:\n    ----------------------------\n    + Added Czech translation;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed bug with SSL/TLS smtp servers;\n    + Fixed visual subnet display issues on 32bit systems;\n    + Fixed IPv6 split subnets bug;\n    + Fixed /31 ping bug scanning out of boundaries;\n    + Fixed nested broadcast not counted to used percentage;\n    + Fixed invalid redirect after timeout;\n    + Fixed discovery script index overridden;\n    + Fixed dashboard graphs links to subnets;\n    + Fixed Invalid ID on subnet scan of large subnets;\n\n== 1.1.010\n\n    Bugfixes:\n    ----------------------------\n    + Fixed login fails with LDAP when escape characters are in password;\n    + Fixed login not working with spaces in password for AD login;\n    + Fixed Ivalid action when adding vlans from subnet popup menu;\n    + Fixed custom fields not appearing properly on IP request editing;\n    + Fixed Invalid ID error for IP address details on sorting;\n    + Fixed warnings if no VLAN search results are present;\n    + Fixed test mail not sending;\n    + Fixed unable to login if $phpsessname not defined;\n    + Fixed unable to login after upgrade;\n\n== 1.1\n\n    Enhancements:\n    ----------------------------\n    + Caching of SQL results to avoid multiple queries;\n    + Reduced number of DB queries;\n    + Added selected mail notifications to admins to be notified on IP/subnet change;\n    + Added new subnetId index to ipaddresses table that significantly improves network loading;\n    + Now using only 1 network connection towards MySQL server;\n    + Updated pagination;\n    + mod_rewrite no longer required, selectable URL structure under settings;\n    + Added option not to display free ranges;\n    + Added option to set maximum VLAN number;\n    + Selectable custom fields to be visible/hidden in tables view and updated device/VLAN view;\n    + Added additional confirmation before section, subnet, folder and IP address deletion;\n    + New script added for cron checks that discovers new hosts for selected networks;\n    + Added inactivity timeout to settings;\n    + Changed install procedure and updated install scripts;\n    + Added PEAR check for installation;\n    + Added free range disaply for VLANs;\n    + Addes SSL/TLS option for SMTP mail;\n    + API:\n        + Bugfixes;\n        + Added API admin permissions;\n        + read/delete actions for IP addresses;\n        + read/delete actions for Vlans;\n        + read/delete actions for VRFs;\n\n    Security Fixes:\n    ----------------------------\n    + Fixed known command injection vulnerabilities in the scan functions;\n    + Fixed known SQL injection vulnerabilities;\n    + Fixed known XSS vulnerabilities;\n    + Fixed known action XSS events;\n    + Moved to crypt method for storing password in database with salting;\n    + Added option to force user to change pass after first login;\n    + Admin password must be changed after installation;\n    + Added captcha code request after 5x unsuccesfull login to prevent brute-force attacks;\n\n    Translations:\n    ----------------------------\n    + Added es_ES translation;\n\n    Bugfixes:\n    ----------------------------\n    + Fixed top 10 widgets not escaping strings;\n    + Fixed section parent can be set to self that caused section to disapear;\n    + Fixed username instead of password being sent to smtp server;\n    + Fixed IE search bug with workaround;\n    + Fixed subnet and bcast not showing on strict mode disabled;\n    + Fixed top subnets missing on dashboard for non-admin users;\n    + Fixed bug when installation was silently failing bacause pf missing _() function (missing gettext extension)\n    + Fixed device custom field not populated on adding device;\n    + Fixed XLS export silently failed when description longer than 31 characters;\n    + Fixed overlapping check not working;\n    + Fixed subnet free space calcultation;\n    + Fixed visual subnet display not showing on /31 and /32 networks;\n    + Fixed custom fields display on folder edit;\n    + Fixed unable to edit IP addresses when fields are sorted;\n    + Fixde ordering of custom fields defaults to varchar 256;\n    + Fixed IPv6 subnet / broadcast calculation bug and next subnet suggestion;\n\n== 1.0\n\n    New features:\n    ----------------------------\n    + IP address page with IP address details and IP history (Changelog);\n    + IP address changelog, subnet and section changelogs with full changelog under tools;\n    + Favourite subnets for quick access;\n    + Adding subnets from free space with automatic mask provided;\n    + Automatic database validity check after upgrading and automatic field/table fix under administration;\n    + Automatic weekly check for new phpipam version;\n\n    Enhancements:\n    ----------------------------\n    + Bootstrap 3;\n    + UI enhancements;\n    + Improved views based on browser width;\n    + Widget order can now be set;\n    + Widgets can be reordered (dragged) directly on dashboard;\n    + Subnet can now be splitted to max 256 new subnets (16 before);\n    + Scan settings are moved to Administration;\n    + Widget management has moved to administration, which allows creation of new widgets;\n    + Improved ICMP error detection;\n    + Mail settings can now be set on gui (localhost / smtp);\n    + Popup windows are now draggable;\n    + VLAN adding in the fly enhancements;\n    + Master section now shows all subnets in subsections;\n    + Tools > devices redone;\n    + DeviceTypes can now be edited/set/added;\n    + Ping subnet enhancements;\n    + Custom field types are now defineable (int/varchar/date/datetime/text/bool/set);\n    + Date and timepicker popups if type = date/datetime;\n    + For `set` and boolean custom fields dropdown is presented that users can pick;\n\n    + Favourite subnets widget;\n    + IP requests widget;\n    + Changelog widget;\n\n    Translations:\n    ----------------------------\n    + Added Brazil translation (Michel Braga Guimar\u00e3es);\n\n    Bugfixes:\n    --------\n    + UI fixes;\n    + Fixed bug where last page of IP addresses was inaccessible;\n    + IP address state change is now sent to all admins;\n    + Fixed subnet displaying as 0.0.0.0/0 in details;\n    + Fixed links to subnets form vlans and vrfs;\n    + Fixed search result showing all folders if searched item is not IP address;\n    + Fixed disapearing section when L2 section was selected as master section;\n    + Fixed device ID showing in mail notification instead of hostname;\n    + Fixed device ID showing in search results and export instead of hostname;\n    + Fixed search for subnet name returned no results;\n    + Fixed apostophe in IP address description throws SQL error for scan results and XLS import;\n    + Fixed requester email gets cut if longer than 32 chars;\n    + Fixed admin folder edit appearing as subnet;\n    + Fixed missing device/port in import;\n    + Fixed master section delete did not delete subsections and belonging subnets/ips;\n    + Fixed online status was not updated when running Ping status scans;\n    + Fixed Folder name not appearing when deleting folder;\n\n== 0.9\n\n    New features:\n    ----------------------------\n    + Support for ICMP network discovery;\n    + Cron script to check status for selected subnets/hosts with threading suport (pcntl php extension required);\n    + ICMP check IP status in demand;\n    + Compressed (grouped) DHCP IP ranges;\n    + API server version 0.1;\n    + Option to show and group subnets by VLAN in subnets list;\n    + Option to show and group subnets by VRF in subnets list;\n    + Added subsections;\n    + Added AD username search;\n    + Added folders;\n\n    Enhancements:\n    ----------------------------\n    + Added error catching/displaying for ajax-loaded php scripts;\n    + Added default language for login/requests display and new users;\n    + Added direct links to different pages in IP address table;\n    + Subnets can now be edited directly from nested subnets list;\n    + When adding nested subnets default vlan/vrf is selected from parent;\n    + Added Section ordering;\n    + Added per/section subnet ordering (overrides dafault form settings);\n    + Clicking on section now shows all subnets and belonging details;\n    + If session timeouts after re-login last requested page will be opened;\n    + Searh for IP address now returns also subnet, even if IP is not existing;\n    + Per-user selection of widgets to display;\n    + Added description and required field checkbox for custom IP/Subnet Fields;\n    + Added custom device fields;\n    + Mails are now sent through phpmailer;\n    + Admin user cannot be deleted;\n\n    Translations:\n    ----------------------------\n    + Added French translation (Denis Darr\u00e9);\n    + Added Dutch translation (Michiel Visser);\n    + Added German translation (Carsten Br\u00fcckner);\n\n    Bugfixes:\n    ----------------------------\n    + Fixed wrong VLAN display in tools;\n    + Fixed subnet/section links from VLANS if base not /;\n    + Fixed warning in apache log on subnet editing if no VRFs are configured;\n    + Fixed admin menu off-screen overflow;\n    + Fixed firefox error when selectiong rights for section/subnets was not possible;\n    + Fixed subnet description in Cyrillic problem;\n    + Fixed errors on no permissions for user;\n    + Fixed Inaccurate Free Space Calculation (and Chart);\n    + Fixed VLAN permissions where VLAN was not displayed;\n\n== 0.8\n\n    New features:\n    ----------------------------\n    + New group and permission management;\n    + Support for translations;\n    + Subnet resizing;\n    + Subnet splitting into smaller subnets;\n    + Added free space display for nested subnets;\n    + Added visual display of subnet usage per IP address;\n    + Added truncate network option that deletes all IP addresses in subnet;\n    + Added button the updates subnet with RIPE information;\n\n    Enhancements:\n    ----------------------------\n    + Added add nested subnet under subnet details to simplify master subnet selection in hierarchy;\n    + Added edit subnet link from search results;\n    + Added reverse IPv6 DNS entries to IPCalc (Vincent Boisard);\n    + Added option for plain-text emails;\n    + Added ckEditor to write instructions;\n    + StrictMode is not set globally anymore but set per section;\n    + Added custom user fields;\n    + Added option to verify that hostname is unique;\n    + Improved MySQL exception handling;\n    + Added mod_rewrite error detection on installation and upgrade;\n    + Added hostname validation;\n    + Added Hostfile dump of IP addresses;\n    + Search also searches in custom fields;\n    + jQuery updated to v 1.9.1;\n\n    Bugfixes:\n    ------------------------\n    + Fixed overlay on second popup;\n    + Fixed IE search bug;\n    + Fixed support for non-standard ports;\n    + Fixed permitting overlapping subnets if vrfs are different;\n    + Fixed dates in logging appearing in 12h format;\n    + Fixed broken subnets link in tools > subnets if installation is not at document root;\n    + Fixed error when adding new subnet if checkboxes are not selected in newer MySQL servers;\n    + Fixed bad display of multilined navigation bar;\n    + Fixed wrong output of tools > VLAN list when using Duplicate VLANs;\n    + Fixed wrong link for upgrade script;\n    + On VRF change all child subnets are updated also;\n    + Fixed wrong maximum on dashboard top10 percentage;\n    + Fixed Adding a vlan while editing a subnet resets the edit subnet form;\n    + Fixed wrong free space calculation for nested subnets;\n    + Fixed IP use statistics not cumulative up the hierarchy if subnes has slaves;\n\n== 0.7\n\n    New features:\n    ----------------------------\n    + Completely rewritten UI using twitter's bootstrap as base;\n    + Using mod_rewrite apache module to handle GET requests (new install requitements!);\n    + Unlimited number of subnetting levels;\n    + OpenLDAP authentication support;\n    + New URL structure;\n    + Sorting of IP addresses;\n    + Custom subnet fields;\n    + Custom VLAN fields and admin option to allow duplicate VLAN names (metro area VLANs);\n    + Script to automatically update IP <-> hostname, run via cron (functions/scripts/resolveIPaddresses.php);\n    + Show Subnet name instead of subnet IP address option;\n    + Strict mode option in config files that controlls overlapping checks;\n    + New subnet menu;\n    + Added printLimit feature to break IP addresses into pages;\n\n    Enhancements:\n    ----------------------------\n    + Lots of UI changes;\n    + Less Ajax usage to display websites and details;\n    + Hierarchy display under subnet details (breadcrumbs);\n    + Search results covering VLANs;\n    + Custom IP fields ordering;\n    + VLAN creation from adding/editing subnets;\n    + IP addresses can now be edited;\n    + Collapsed switch list;\n    + Removing VLANs also removes references from subnet list;\n    + Removing VRFs also removes references from subnet list;\n    + Logs for admin on dashboard;\n    + Search via GET;\n    + Support for range networks (allows use of subnet and broadcast as IP);\n    + Import of custom IP fields;\n    + Abiility to move subnets between sections;\n    + Improved display of nested subnets now shows all IP addresses from nested subnets and orphaned IPs;\n    + Hides display of custom fields in subnet if none is filled in whole subnet;\n    + Replaced Highcharts with Flot because of licencing issues;\n\n    Bugfixes:\n    ------------------------\n    + Fixed error with missing custom IP fields when adding new IP address;\n    + Fixed bug when deleteing root subnet only deleted directly nested subnets (now whole tree);\n    + Fixed checkboxes not working in various browsers;\n    + Fixed change in switch details causing IP address associations to switch to be lost;\n    + Fixed subnet description display in under subnet administration;\n    + Fixed depricated error when showing XLS files;\n    + Fixed error when custom fields were not updated on adding IP address;\n    + Fixed error when custom fields were with spaces in name were not updated;\n    + Fixed error when providing already requested IP address;\n    + Search available also to viewer user types;\n    + Fixed /127 and /128 IPv6 subnets;\n    + Fixed /31 and /32 IPv4 subnets;\n    + Significally reduced php processing for dashboard statistics;\n    + Fixed importing of if quote is present;\n\n== 0.6\n\n    New features:\n    ----------------------------\n    + Selectable IP address list display fields;\n    + Custom IP address fields;\n    + Search and replace IP fields function;\n    + Full page width theme;\n\n    Enhancements:\n    ----------------------------\n    + Independant VLAN management;\n    + Added additional level of subnet nesting;\n    + Added option to clear and export log files;\n    + Export of search results to XLS;\n    + Clickable search results;\n    + Selectable export fields when exporting subnet;\n    + Subnet can be deleted from ip address edit subnet;\n    + IP Requests for locked subnets and viewer users can be placed from ip address list;\n    + jQuery updated to v 1.7.1;\n    + HighCharts updated to v 2.2.0;\n\n    Bugfixes:\n    ------------------------\n    + Upgrade is supported only for versions 0.4 and higher;\n    + Fixed broken UTF-8 support;\n    + Fixed wrong logging when authenticating via AD;\n    + Fixed issues where external attacker might get information about internal hosts through resolvedns script;\n    + Fixed wrong subnet nesting under administration/manage subnets;\n    + Fixed editing subnet can be outside of its own root subnet;\n    + Fixed errors when adding new switch auto-adds itselt to all hosts without no switch defined;\n    + Fixed removing switch not removed in ip address list;\n    + Vlan1 can now be used;\n    + Fixed mail sending settings with missing information;\n    + Fixed errors on adding switch with no sections;\n    + Fixed version check;\n    + Removed masterSubnets from subnets available for IP requests;\n    + Fixed error when non-admin user could not open dashboard;\n    + Added how subnet list switch when list hidden;\n\n== 0.5\n\n    New features:\n    -------------\n    + Importing subnets from RIPE by AS in admin section;\n    + Added switch management and changed switch logic;\n    + Added VRF support;\n    + Added AD domain authentication;\n    + Added MAC address field to ip address;\n    + Added database table and belonging fields check under admin;\n\n    Bugfixes / enhancements:\n    ------------------------\n    + Added DNS resolving when editing/adding IP address;\n    + Added IE compatibility meta tag and IE UI improvements for IE >= 8;\n    + Search returns also subnets and MAC searches;\n    + Added mac address and IP status to XLS import/export scripts;\n    + jQuery update from 1.6.2 to 1.7;\n    + Highcharts update from 2.1.2 to 2.1.8;\n\n    + Fixed dashboard errors if no IPv4/IPv6 subnets configured;\n    + Fixed errors with viewing / modifying IP addresses for Operator users;\n    + Fixed session cookie error on hosts;\n    + Fixed error when saving settings;\n    + Fixed instructions errors when inserting html code;\n    + Fixed first free IP address not displaying in IP request;\n\n\n== 0.4\n\n    New features:\n    -------------\n    + Massive add / edit / delete by specifying IP range (e.g. 10.10.0.1 - 10.10.0.254);\n    + Database upgrade / install from browser -> simplified installation/update procedure;\n    + New usertype viewer - can only view IP address list;\n    + Subnets can now be edited directly from IP address list;\n    + Option to lock subnet for writing to no-admin users;\n    + Device and Host list;\n    + Option to specify which subnet can have IP requests when editing / adding subnet if module is enabled;\n    + Latest version check on admin page;\n\n    Bugfixes / enhancements:\n    ------------------------\n    + Fixed overspanning of multiple sections;\n    + Admin menu and add subnet now shown only to admins;\n    + Fixed VLAN table to show nesting and IP request option and statistics;\n    + Fixed subnet table to show nesting and IP request option;\n    + Subnet Adding shows only master subnets in section not in all sections;\n    + Tooltips and button hovers are now in separate javascript file;\n    + Graphs show only subnets with non-0 ip addresses;\n    + Various code enhancements + improved error handling;\n    + Fixed URL links not updating after few clicks;\n    + If loading slave subnet directly the subnet menu drops down and shows active slave subnet;\n    + Clicking on master shubnet shows all nested subnets and statistics;\n    + Redesigned log table;\n    + Fixed search;\n\n== 0.3\n\n    New features:\n    -------------\n    + Subnet nesting - you can now have master subnet and normal subnets belonging to it;\n    + Server settings are now moved to database and can be set under admin menu (database settings & debugging remain in config.php);\n    + Request IP module on login page with email notification;\n    + Confirm/reject IP address request from admin page with mail notification;\n    + Admin dashboard notification of new requests;\n    + Autocomplete of owner and Switch name from all available when adding/editing IP address;\n    + New settings quick access on button hover;\n    + Option to export each subnet indivudually;\n\n    Bugfixes / enhancements:\n    ------------------------\n    + jQuery update from 1.6 to 1.6.2;\n    + VLANs are now grouped by section;\n    + Direct access to subnet from vlan table;\n    + UI enhancements;\n    + Fixed user editing bug where user update broke password;\n    + Fixed password in new account notification;\n    + Fixed percentage display on Dashboard;\n    + IPv6 calculator /64 limit fixed;\n    + Changed tooltip effect to appear instantly for smoother display;\n    + Login functions are now separate file;\n\n\n== 0.2 (First public version)\n\n    Bugfixes / enhancements:\n    ------------------------\n    + now also works with php 5.2;\n    + fixed empty fields in xls import;\n    + passwords are now stored in md5 hash;\n    + high numbers for free/used IP addresses (mainly IPv6) are now represented in k/m/G values to improve readibility;\n    + fixed log search bug;\n    + cursor not displayed as link on images and non-href links;\n    + same add image on all pages;\n    + fixed IP mail notification apperance;\n    + UI enhancements and bugfixes;\n    + Fixed some javascript bugs;\n    + Minified javascript to make loading faster;\n    + adding new ip address now automatically provides first available IP address in subnet;\n\n    New features:\n    -------------\n    + added switch / port fields to IP addresses;\n    + hide subets on request to get better view;\n    + Informational tooltips added + option to disable them in config file if someone finds them annoying;\n    + export whole IP address database to XLS file from admin menu;\n    + create MySQL database dump from admin menu;\n    + added IP instructions for users, that can be edited from admin menu;\n\n\n== 0.1 (First test version)\n"], "filenames": ["app/tools/ip-calculator/bw-calculator-result.php", "misc/CHANGELOG"], "buggy_code_start_loc": [13, 5], "buggy_code_end_loc": [19, 5], "fixing_code_start_loc": [13, 6], "fixing_code_end_loc": [19, 10], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Reflected in GitHub repository phpipam/phpipam prior to 1.5.1.", "other": {"cve": {"id": "CVE-2023-0676", "sourceIdentifier": "security@huntr.dev", "published": "2023-02-04T13:15:12.147", "lastModified": "2023-02-12T04:48:34.303", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Reflected in GitHub repository phpipam/phpipam prior to 1.5.1."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 2.4, "baseSeverity": "LOW"}, "exploitabilityScore": 0.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpipam:phpipam:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.5.1", "matchCriteriaId": "6E6C6452-C85E-4BF3-B06C-1F81BB54FC5C"}]}]}], "references": [{"url": "https://github.com/phpipam/phpipam/commit/94ec73ff1d33926b75b811ded6f0b4a46088a7ec", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/b72d4f0c-8a96-4b40-a031-7d469c6ab93b", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/phpipam/phpipam/commit/94ec73ff1d33926b75b811ded6f0b4a46088a7ec"}}