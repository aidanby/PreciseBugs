{"buggy_code": ["define([\n\t'exports',\n\t'../errors/RequestError',\n\t'../errors/CancelError',\n\t'../Deferred',\n\t'../io-query',\n\t'../_base/array',\n\t'../_base/lang',\n\t'../promise/Promise',\n\t'../has'\n], function(exports, RequestError, CancelError, Deferred, ioQuery, array, lang, Promise, has){\n\n\tfunction isArrayBuffer(value) {\n\t\treturn has('native-arraybuffer') && value instanceof ArrayBuffer\n\t}\n\n\tfunction isBlob(value) {\n\t\treturn has('native-blob') && value instanceof Blob\n\t}\n\t\n\tfunction isElement(value) {\n\t\tif(typeof Element !== 'undefined') { //all other\n\t\t\treturn value instanceof Element;\n\t\t}\n\n\t\t//IE<=7\n\t\treturn value.nodeType === 1;\n\t}\n\n\tfunction isFormData(value) {\n\t\treturn has('native-formdata') && value instanceof FormData;\n\t}\n\n\tfunction shouldDeepCopy(value) {\n\t\treturn value &&\n\t\t\ttypeof value === 'object' &&\n\t\t\t!isFormData(value) &&\n\t\t\t!isElement(value) &&\n\t\t\t!isBlob(value) &&\n\t\t\t!isArrayBuffer(value)\n\t}\n\n\texports.deepCopy = function(target, source) {\n\t\tfor (var name in source) {\n\t\t\tvar tval = target[name],\n  \t\t\t    sval = source[name];\n\t\t\tif (tval !== sval) {\n\t\t\t\tif (shouldDeepCopy(sval)) {\n\t\t\t\t\tif (Object.prototype.toString.call(sval) === '[object Date]') { // use this date test to handle crossing frame boundaries\n\t\t\t\t\t\ttarget[name] = new Date(sval);\n\t\t\t\t\t} else if (lang.isArray(sval)) {\n \t\t\t\t\t\t  target[name] = exports.deepCopyArray(sval);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (tval && typeof tval === 'object') {\n\t\t\t\t\t\t\texports.deepCopy(tval, sval);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttarget[name] = exports.deepCopy({}, sval);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttarget[name] = sval;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn target;\n\t};\n\n\texports.deepCopyArray = function(source) {\n\t\tvar clonedArray = [];\n\t\tfor (var i = 0, l = source.length; i < l; i++) {\n\t\t\tvar svalItem = source[i];\n\t\t\tif (typeof svalItem === 'object') {\n\t\t\t\tclonedArray.push(exports.deepCopy({}, svalItem));\n\t\t\t} else {\n\t\t\t\tclonedArray.push(svalItem);\n\t\t\t}\n\t\t}\n\n\t\treturn clonedArray;\n\t};\n\n\texports.deepCreate = function deepCreate(source, properties){\n\t\tproperties = properties || {};\n\t\tvar target = lang.delegate(source),\n\t\t\tname, value;\n\n\t\tfor(name in source){\n\t\t\tvalue = source[name];\n\n\t\t\tif(value && typeof value === 'object'){\n\t\t\t\ttarget[name] = exports.deepCreate(value, properties[name]);\n\t\t\t}\n\t\t}\n\t\treturn exports.deepCopy(target, properties);\n\t};\n\n\tvar freeze = Object.freeze || function(obj){ return obj; };\n\tfunction okHandler(response){\n\t\treturn freeze(response);\n\t}\n\tfunction dataHandler (response) {\n\t\treturn response.data !== undefined ? response.data : response.text;\n\t}\n\n\texports.deferred = function deferred(response, cancel, isValid, isReady, handleResponse, last){\n\t\tvar def = new Deferred(function(reason){\n\t\t\tcancel && cancel(def, response);\n\n\t\t\tif(!reason || !(reason instanceof RequestError) && !(reason instanceof CancelError)){\n\t\t\t\treturn new CancelError('Request canceled', response);\n\t\t\t}\n\t\t\treturn reason;\n\t\t});\n\n\t\tdef.response = response;\n\t\tdef.isValid = isValid;\n\t\tdef.isReady = isReady;\n\t\tdef.handleResponse = handleResponse;\n\n\t\tfunction errHandler(error){\n\t\t\terror.response = response;\n\t\t\tthrow error;\n\t\t}\n\t\tvar responsePromise = def.then(okHandler).otherwise(errHandler);\n\n\t\tif(exports.notify){\n\t\t\tresponsePromise.then(\n\t\t\t\tlang.hitch(exports.notify, 'emit', 'load'),\n\t\t\t\tlang.hitch(exports.notify, 'emit', 'error')\n\t\t\t);\n\t\t}\n\n\t\tvar dataPromise = responsePromise.then(dataHandler);\n\n\t\t// http://bugs.dojotoolkit.org/ticket/16794\n\t\t// The following works around a leak in IE9 through the\n\t\t// prototype using lang.delegate on dataPromise and\n\t\t// assigning the result a property with a reference to\n\t\t// responsePromise.\n\t\tvar promise = new Promise();\n\t\tfor (var prop in dataPromise) {\n\t\t\tif (dataPromise.hasOwnProperty(prop)) {\n\t\t\t\tpromise[prop] = dataPromise[prop];\n\t\t\t}\n\t\t}\n\t\tpromise.response = responsePromise;\n\t\tfreeze(promise);\n\t\t// End leak fix\n\n\n\t\tif(last){\n\t\t\tdef.then(function(response){\n\t\t\t\tlast.call(def, response);\n\t\t\t}, function(error){\n\t\t\t\tlast.call(def, response, error);\n\t\t\t});\n\t\t}\n\n\t\tdef.promise = promise;\n\t\tdef.then = promise.then;\n\n\t\treturn def;\n\t};\n\n\texports.addCommonMethods = function addCommonMethods(provider, methods){\n\t\tarray.forEach(methods||['GET', 'POST', 'PUT', 'DELETE'], function(method){\n\t\t\tprovider[(method === 'DELETE' ? 'DEL' : method).toLowerCase()] = function(url, options){\n\t\t\t\toptions = lang.delegate(options||{});\n\t\t\t\toptions.method = method;\n\t\t\t\treturn provider(url, options);\n\t\t\t};\n\t\t});\n\t};\n\n\texports.parseArgs = function parseArgs(url, options, skipData){\n\t\tvar data = options.data,\n\t\t\tquery = options.query;\n\n\t\tif(data && !skipData){\n\t\t\tif(typeof data === 'object' && (!(has('native-xhr2')) || !(isArrayBuffer(data) || isBlob(data) ))){\n\t\t\t\toptions.data = ioQuery.objectToQuery(data);\n\t\t\t}\n\t\t}\n\n\t\tif(query){\n\t\t\tif(typeof query === 'object'){\n\t\t\t\tquery = ioQuery.objectToQuery(query);\n\t\t\t}\n\t\t\tif(options.preventCache){\n\t\t\t\tquery += (query ? '&' : '') + 'request.preventCache=' + (+(new Date));\n\t\t\t}\n\t\t}else if(options.preventCache){\n\t\t\tquery = 'request.preventCache=' + (+(new Date));\n\t\t}\n\n\t\tif(url && query){\n\t\t\turl += (~url.indexOf('?') ? '&' : '?') + query;\n\t\t}\n\n\t\treturn {\n\t\t\turl: url,\n\t\t\toptions: options,\n\t\t\tgetHeader: function(headerName){ return null; }\n\t\t};\n\t};\n\n\texports.checkStatus = function(stat){\n\t\tstat = stat || 0;\n\t\treturn (stat >= 200 && stat < 300) || // allow any 2XX response code\n\t\t\tstat === 304 ||                 // or, get it out of the cache\n\t\t\tstat === 1223 ||                // or, Internet Explorer mangled the status code\n\t\t\t!stat;                         // or, we're Titanium/browser chrome/chrome extension requesting a local file\n\t};\n});\n", "define([\n\t'intern!object',\n\t'intern/chai!assert',\n\t'../../../request/util',\n\t'../../../has',\n\t'../../../request/xhr'\n], function(registerSuite, assert, util, has){\n\tregisterSuite({\n\t\tname: 'dojo/request/util',\n\n\t\t'deepCopy': function(){\n\t\t\tvar object1 = {\n\t\t\t\tapple: 0,\n\t\t\t\tbanana: {\n\t\t\t\t\tweight: 52,\n\t\t\t\t\tprice: 100,\n\t\t\t\t\tcode: \"B12345\",\n\t\t\t\t\tpurchased: new Date(2016, 0, 1)\n\t\t\t\t},\n\t\t\t\tcherry: 97\n\t\t\t};\n\t\t\tvar object2 = {\n\t\t\t\tbanana: {\n\t\t\t\t\tprice: 200,\n\t\t\t\t\tcode: \"B98765\",\n\t\t\t\t\tpurchased: new Date(2017, 0, 1)\n\t\t\t\t},\n\t\t\t\tdurian: 100\n\t\t\t};\n\t\t\tutil.deepCopy(object1, object2);\n\t\t\tassert.strictEqual(object1.banana.weight, 52);\n\t\t\tassert.strictEqual(object1.banana.price, 200);\n\t\t\tassert.strictEqual(object1.banana.code, \"B98765\");\n\t\t\tassert.equal(object1.banana.purchased.getTime(), new Date(2017, 0, 1).getTime());\n\t\t},\n\n\t\t'deepCopy with FormData': function(){\n\t\t\tif (has('native-formdata')) {\n\t\t\t\tvar formData = new FormData();\n\t\t\t\tvar object1 = {\n\t\t\t\t\tapple: 0,\n\t\t\t\t\tbanana: {\n\t\t\t\t\t\tweight: 52,\n\t\t\t\t\t\tprice: 100,\n\t\t\t\t\t\tcode: \"B12345\",\n\t\t\t\t\t\tpurchased: new Date(2016, 0, 1)\n\t\t\t\t\t},\n\t\t\t\t\tcherry: 97\n\t\t\t\t};\n\t\t\t\tvar object2 = {\n\t\t\t\t\tbanana: {\n\t\t\t\t\t\tprice: 200,\n\t\t\t\t\t\tcode: \"B98765\",\n\t\t\t\t\t\tpurchased: new Date(2017, 0, 1)\n\t\t\t\t\t},\n\t\t\t\t\tformData: formData,\n\t\t\t\t\tdurian: 100\n\t\t\t\t};\n\t\t\t\tutil.deepCopy(object1, object2);\n\t\t\t\tassert.strictEqual(object1.banana.weight, 52);\n\t\t\t\tassert.strictEqual(object1.banana.price, 200);\n\t\t\t\tassert.strictEqual(object1.banana.code, \"B98765\");\n\t\t\t\tassert.strictEqual(object1.formData, formData);\n\t\t\t\tassert.equal(object1.banana.purchased.getTime(), new Date(2017, 0, 1).getTime());\n\t\t\t} else {\n\t\t\t\tthis.skip('Do not run test if FormData not available.');\n\t\t\t}\n\t\t},\n\n\t\t'deepCopy with Blob': function(){\n\t\t\tif (has('native-blob')) {\n\t\t\t\tvar blob = new Blob([JSON.stringify({test: \"data\"})], {type: 'application/json'});\n\t\t\t\tvar object1 = {\n\t\t\t\t\tapple: 0,\n\t\t\t\t\tbanana: {\n\t\t\t\t\t\tweight: 52,\n\t\t\t\t\t\tprice: 100,\n\t\t\t\t\t\tcode: \"B12345\",\n\t\t\t\t\t\tpurchased: new Date(2016, 0, 1)\n\t\t\t\t\t},\n\t\t\t\t\tcherry: 97\n\t\t\t\t};\n\t\t\t\tvar object2 = {\n\t\t\t\t\tbanana: {\n\t\t\t\t\t\tprice: 200,\n\t\t\t\t\t\tcode: \"B98765\",\n\t\t\t\t\t\tpurchased: new Date(2017, 0, 1)\n\t\t\t\t\t},\n\t\t\t\t\tblob: blob,\n\t\t\t\t\tdurian: 100\n\t\t\t\t};\n\t\t\t\tutil.deepCopy(object1, object2);\n\t\t\t\tassert.strictEqual(object1.banana.weight, 52);\n\t\t\t\tassert.strictEqual(object1.banana.price, 200);\n\t\t\t\tassert.strictEqual(object1.banana.code, \"B98765\");\n\t\t\t\tassert.strictEqual(object1.blob, blob);\n\t\t\t\tassert.equal(object1.banana.purchased.getTime(), new Date(2017, 0, 1).getTime());\n\t\t\t} else {\n\t\t\t\tthis.skip('Do not run test if Blob not available.');\n\t\t\t}\n\t\t},\n\n\t\t'deepCopy with Element, given Element is defined': function(){\n\t\t\tif (typeof Element !== 'undefined') {\n\t\t\t\tvar element = document.createElement('span');\n\t\t\t\tvar object1 = {\n\t\t\t\t\tapple: 0,\n\t\t\t\t\tbanana: {\n\t\t\t\t\t\tweight: 52,\n\t\t\t\t\t\tprice: 100,\n\t\t\t\t\t\tcode: \"B12345\",\n\t\t\t\t\t\tpurchased: new Date(2016, 0, 1)\n\t\t\t\t\t},\n\t\t\t\t\tcherry: 97\n\t\t\t\t};\n\t\t\t\tvar object2 = {\n\t\t\t\t\tbanana: {\n\t\t\t\t\t\tprice: 200,\n\t\t\t\t\t\tcode: \"B98765\",\n\t\t\t\t\t\tpurchased: new Date(2017, 0, 1)\n\t\t\t\t\t},\n\t\t\t\t\telement: element,\n\t\t\t\t\tdurian: 100\n\t\t\t\t};\n\t\t\t\tutil.deepCopy(object1, object2);\n\t\t\t\tassert.strictEqual(object1.banana.weight, 52);\n\t\t\t\tassert.strictEqual(object1.banana.price, 200);\n\t\t\t\tassert.strictEqual(object1.banana.code, \"B98765\");\n\t\t\t\tassert.strictEqual(object1.element, element);\n\t\t\t\tassert.equal(object1.banana.purchased.getTime(), new Date(2017, 0, 1).getTime());\n\t\t\t} else {\n\t\t\t\tthis.skip('Do not run test if Element not available.');\n\t\t\t}\n\t\t},\n\n\t\t'deepCopy with Element, given Element is not defined': function(){\n\t\t\tif (typeof Element !== 'undefined') {\n\t\t\t\tthis.skip('Do not run test if Element is available.');\n\t\t\t}\n\n\t\t\tvar element = {nodeType: 1, value: 'Orange'};\n\t\t\tvar object1 = {\n\t\t\t\tapple: 0,\n\t\t\t\tbanana: {\n\t\t\t\t\tweight: 52,\n\t\t\t\t\tprice: 100,\n\t\t\t\t\tcode: \"B12345\",\n\t\t\t\t\tpurchased: new Date(2016, 0, 1)\n\t\t\t\t},\n\t\t\t\tcherry: 97\n\t\t\t};\n\t\t\tvar object2 = {\n\t\t\t\tbanana: {\n\t\t\t\t\tprice: 200,\n\t\t\t\t\tcode: \"B98765\",\n\t\t\t\t\tpurchased: new Date(2017, 0, 1)\n\t\t\t\t},\n\t\t\t\telement: element,\n\t\t\t\tdurian: 100\n\t\t\t};\n\t\t\tutil.deepCopy(object1, object2);\n\t\t\tassert.strictEqual(object1.banana.weight, 52);\n\t\t\tassert.strictEqual(object1.banana.price, 200);\n\t\t\tassert.strictEqual(object1.banana.code, \"B98765\");\n\t\t\tassert.strictEqual(object1.element, element);\n\t\t\tassert.equal(object1.banana.purchased.getTime(), new Date(2017, 0, 1).getTime());\n\t\t}\n\t});\n});\n"], "fixing_code": ["define([\n\t'exports',\n\t'../errors/RequestError',\n\t'../errors/CancelError',\n\t'../Deferred',\n\t'../io-query',\n\t'../_base/array',\n\t'../_base/lang',\n\t'../promise/Promise',\n\t'../has'\n], function(exports, RequestError, CancelError, Deferred, ioQuery, array, lang, Promise, has){\n\n\tfunction isArrayBuffer(value) {\n\t\treturn has('native-arraybuffer') && value instanceof ArrayBuffer\n\t}\n\n\tfunction isBlob(value) {\n\t\treturn has('native-blob') && value instanceof Blob\n\t}\n\t\n\tfunction isElement(value) {\n\t\tif(typeof Element !== 'undefined') { //all other\n\t\t\treturn value instanceof Element;\n\t\t}\n\n\t\t//IE<=7\n\t\treturn value.nodeType === 1;\n\t}\n\n\tfunction isFormData(value) {\n\t\treturn has('native-formdata') && value instanceof FormData;\n\t}\n\n\tfunction shouldDeepCopy(value) {\n\t\treturn value &&\n\t\t\ttypeof value === 'object' &&\n\t\t\t!isFormData(value) &&\n\t\t\t!isElement(value) &&\n\t\t\t!isBlob(value) &&\n\t\t\t!isArrayBuffer(value)\n\t}\n\n\texports.deepCopy = function(target, source) {\n\t\tfor (var name in source) {\n\t\t\tvar tval = target[name],\n  \t\t\t    sval = source[name];\n\t\t\tif (name !== '__proto__' && tval !== sval) {\n\t\t\t\tif (shouldDeepCopy(sval)) {\n\t\t\t\t\tif (Object.prototype.toString.call(sval) === '[object Date]') { // use this date test to handle crossing frame boundaries\n\t\t\t\t\t\ttarget[name] = new Date(sval);\n\t\t\t\t\t} else if (lang.isArray(sval)) {\n \t\t\t\t\t\t  target[name] = exports.deepCopyArray(sval);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (tval && typeof tval === 'object') {\n\t\t\t\t\t\t\texports.deepCopy(tval, sval);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttarget[name] = exports.deepCopy({}, sval);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttarget[name] = sval;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn target;\n\t};\n\n\texports.deepCopyArray = function(source) {\n\t\tvar clonedArray = [];\n\t\tfor (var i = 0, l = source.length; i < l; i++) {\n\t\t\tvar svalItem = source[i];\n\t\t\tif (typeof svalItem === 'object') {\n\t\t\t\tclonedArray.push(exports.deepCopy({}, svalItem));\n\t\t\t} else {\n\t\t\t\tclonedArray.push(svalItem);\n\t\t\t}\n\t\t}\n\n\t\treturn clonedArray;\n\t};\n\n\texports.deepCreate = function deepCreate(source, properties){\n\t\tproperties = properties || {};\n\t\tvar target = lang.delegate(source),\n\t\t\tname, value;\n\n\t\tfor(name in source){\n\t\t\tvalue = source[name];\n\n\t\t\tif(value && typeof value === 'object'){\n\t\t\t\ttarget[name] = exports.deepCreate(value, properties[name]);\n\t\t\t}\n\t\t}\n\t\treturn exports.deepCopy(target, properties);\n\t};\n\n\tvar freeze = Object.freeze || function(obj){ return obj; };\n\tfunction okHandler(response){\n\t\treturn freeze(response);\n\t}\n\tfunction dataHandler (response) {\n\t\treturn response.data !== undefined ? response.data : response.text;\n\t}\n\n\texports.deferred = function deferred(response, cancel, isValid, isReady, handleResponse, last){\n\t\tvar def = new Deferred(function(reason){\n\t\t\tcancel && cancel(def, response);\n\n\t\t\tif(!reason || !(reason instanceof RequestError) && !(reason instanceof CancelError)){\n\t\t\t\treturn new CancelError('Request canceled', response);\n\t\t\t}\n\t\t\treturn reason;\n\t\t});\n\n\t\tdef.response = response;\n\t\tdef.isValid = isValid;\n\t\tdef.isReady = isReady;\n\t\tdef.handleResponse = handleResponse;\n\n\t\tfunction errHandler(error){\n\t\t\terror.response = response;\n\t\t\tthrow error;\n\t\t}\n\t\tvar responsePromise = def.then(okHandler).otherwise(errHandler);\n\n\t\tif(exports.notify){\n\t\t\tresponsePromise.then(\n\t\t\t\tlang.hitch(exports.notify, 'emit', 'load'),\n\t\t\t\tlang.hitch(exports.notify, 'emit', 'error')\n\t\t\t);\n\t\t}\n\n\t\tvar dataPromise = responsePromise.then(dataHandler);\n\n\t\t// http://bugs.dojotoolkit.org/ticket/16794\n\t\t// The following works around a leak in IE9 through the\n\t\t// prototype using lang.delegate on dataPromise and\n\t\t// assigning the result a property with a reference to\n\t\t// responsePromise.\n\t\tvar promise = new Promise();\n\t\tfor (var prop in dataPromise) {\n\t\t\tif (dataPromise.hasOwnProperty(prop)) {\n\t\t\t\tpromise[prop] = dataPromise[prop];\n\t\t\t}\n\t\t}\n\t\tpromise.response = responsePromise;\n\t\tfreeze(promise);\n\t\t// End leak fix\n\n\n\t\tif(last){\n\t\t\tdef.then(function(response){\n\t\t\t\tlast.call(def, response);\n\t\t\t}, function(error){\n\t\t\t\tlast.call(def, response, error);\n\t\t\t});\n\t\t}\n\n\t\tdef.promise = promise;\n\t\tdef.then = promise.then;\n\n\t\treturn def;\n\t};\n\n\texports.addCommonMethods = function addCommonMethods(provider, methods){\n\t\tarray.forEach(methods||['GET', 'POST', 'PUT', 'DELETE'], function(method){\n\t\t\tprovider[(method === 'DELETE' ? 'DEL' : method).toLowerCase()] = function(url, options){\n\t\t\t\toptions = lang.delegate(options||{});\n\t\t\t\toptions.method = method;\n\t\t\t\treturn provider(url, options);\n\t\t\t};\n\t\t});\n\t};\n\n\texports.parseArgs = function parseArgs(url, options, skipData){\n\t\tvar data = options.data,\n\t\t\tquery = options.query;\n\n\t\tif(data && !skipData){\n\t\t\tif(typeof data === 'object' && (!(has('native-xhr2')) || !(isArrayBuffer(data) || isBlob(data) ))){\n\t\t\t\toptions.data = ioQuery.objectToQuery(data);\n\t\t\t}\n\t\t}\n\n\t\tif(query){\n\t\t\tif(typeof query === 'object'){\n\t\t\t\tquery = ioQuery.objectToQuery(query);\n\t\t\t}\n\t\t\tif(options.preventCache){\n\t\t\t\tquery += (query ? '&' : '') + 'request.preventCache=' + (+(new Date));\n\t\t\t}\n\t\t}else if(options.preventCache){\n\t\t\tquery = 'request.preventCache=' + (+(new Date));\n\t\t}\n\n\t\tif(url && query){\n\t\t\turl += (~url.indexOf('?') ? '&' : '?') + query;\n\t\t}\n\n\t\treturn {\n\t\t\turl: url,\n\t\t\toptions: options,\n\t\t\tgetHeader: function(headerName){ return null; }\n\t\t};\n\t};\n\n\texports.checkStatus = function(stat){\n\t\tstat = stat || 0;\n\t\treturn (stat >= 200 && stat < 300) || // allow any 2XX response code\n\t\t\tstat === 304 ||                 // or, get it out of the cache\n\t\t\tstat === 1223 ||                // or, Internet Explorer mangled the status code\n\t\t\t!stat;                         // or, we're Titanium/browser chrome/chrome extension requesting a local file\n\t};\n});\n", "define([\n\t'intern!object',\n\t'intern/chai!assert',\n\t'../../../request/util',\n\t'../../../has',\n\t'../../../request/xhr'\n], function(registerSuite, assert, util, has){\n\tregisterSuite({\n\t\tname: 'dojo/request/util',\n\n\t\t'deepCopy': function(){\n\t\t\tvar object1 = {\n\t\t\t\tapple: 0,\n\t\t\t\tbanana: {\n\t\t\t\t\tweight: 52,\n\t\t\t\t\tprice: 100,\n\t\t\t\t\tcode: \"B12345\",\n\t\t\t\t\tpurchased: new Date(2016, 0, 1)\n\t\t\t\t},\n\t\t\t\tcherry: 97\n\t\t\t};\n\t\t\tvar object2 = {\n\t\t\t\tbanana: {\n\t\t\t\t\tprice: 200,\n\t\t\t\t\tcode: \"B98765\",\n\t\t\t\t\tpurchased: new Date(2017, 0, 1)\n\t\t\t\t},\n\t\t\t\tdurian: 100\n\t\t\t};\n\t\t\tutil.deepCopy(object1, object2);\n\t\t\tassert.strictEqual(object1.banana.weight, 52);\n\t\t\tassert.strictEqual(object1.banana.price, 200);\n\t\t\tassert.strictEqual(object1.banana.code, \"B98765\");\n\t\t\tassert.equal(object1.banana.purchased.getTime(), new Date(2017, 0, 1).getTime());\n\t\t},\n\n\t\t'.deepCopy should ignore the __proto__ property': function() {\n\t\t\tvar payload = JSON.parse('{ \"__proto__\": { \"protoPollution\": true }}');\n\t\t\tutil.deepCopy({}, payload);\n\t\t\tassert.isUndefined(({}).protoPollution);\n\t\t},\n\n\t\t'deepCopy with FormData': function(){\n\t\t\tif (has('native-formdata')) {\n\t\t\t\tvar formData = new FormData();\n\t\t\t\tvar object1 = {\n\t\t\t\t\tapple: 0,\n\t\t\t\t\tbanana: {\n\t\t\t\t\t\tweight: 52,\n\t\t\t\t\t\tprice: 100,\n\t\t\t\t\t\tcode: \"B12345\",\n\t\t\t\t\t\tpurchased: new Date(2016, 0, 1)\n\t\t\t\t\t},\n\t\t\t\t\tcherry: 97\n\t\t\t\t};\n\t\t\t\tvar object2 = {\n\t\t\t\t\tbanana: {\n\t\t\t\t\t\tprice: 200,\n\t\t\t\t\t\tcode: \"B98765\",\n\t\t\t\t\t\tpurchased: new Date(2017, 0, 1)\n\t\t\t\t\t},\n\t\t\t\t\tformData: formData,\n\t\t\t\t\tdurian: 100\n\t\t\t\t};\n\t\t\t\tutil.deepCopy(object1, object2);\n\t\t\t\tassert.strictEqual(object1.banana.weight, 52);\n\t\t\t\tassert.strictEqual(object1.banana.price, 200);\n\t\t\t\tassert.strictEqual(object1.banana.code, \"B98765\");\n\t\t\t\tassert.strictEqual(object1.formData, formData);\n\t\t\t\tassert.equal(object1.banana.purchased.getTime(), new Date(2017, 0, 1).getTime());\n\t\t\t} else {\n\t\t\t\tthis.skip('Do not run test if FormData not available.');\n\t\t\t}\n\t\t},\n\n\t\t'deepCopy with Blob': function(){\n\t\t\tif (has('native-blob')) {\n\t\t\t\tvar blob = new Blob([JSON.stringify({test: \"data\"})], {type: 'application/json'});\n\t\t\t\tvar object1 = {\n\t\t\t\t\tapple: 0,\n\t\t\t\t\tbanana: {\n\t\t\t\t\t\tweight: 52,\n\t\t\t\t\t\tprice: 100,\n\t\t\t\t\t\tcode: \"B12345\",\n\t\t\t\t\t\tpurchased: new Date(2016, 0, 1)\n\t\t\t\t\t},\n\t\t\t\t\tcherry: 97\n\t\t\t\t};\n\t\t\t\tvar object2 = {\n\t\t\t\t\tbanana: {\n\t\t\t\t\t\tprice: 200,\n\t\t\t\t\t\tcode: \"B98765\",\n\t\t\t\t\t\tpurchased: new Date(2017, 0, 1)\n\t\t\t\t\t},\n\t\t\t\t\tblob: blob,\n\t\t\t\t\tdurian: 100\n\t\t\t\t};\n\t\t\t\tutil.deepCopy(object1, object2);\n\t\t\t\tassert.strictEqual(object1.banana.weight, 52);\n\t\t\t\tassert.strictEqual(object1.banana.price, 200);\n\t\t\t\tassert.strictEqual(object1.banana.code, \"B98765\");\n\t\t\t\tassert.strictEqual(object1.blob, blob);\n\t\t\t\tassert.equal(object1.banana.purchased.getTime(), new Date(2017, 0, 1).getTime());\n\t\t\t} else {\n\t\t\t\tthis.skip('Do not run test if Blob not available.');\n\t\t\t}\n\t\t},\n\n\t\t'deepCopy with Element, given Element is defined': function(){\n\t\t\tif (typeof Element !== 'undefined') {\n\t\t\t\tvar element = document.createElement('span');\n\t\t\t\tvar object1 = {\n\t\t\t\t\tapple: 0,\n\t\t\t\t\tbanana: {\n\t\t\t\t\t\tweight: 52,\n\t\t\t\t\t\tprice: 100,\n\t\t\t\t\t\tcode: \"B12345\",\n\t\t\t\t\t\tpurchased: new Date(2016, 0, 1)\n\t\t\t\t\t},\n\t\t\t\t\tcherry: 97\n\t\t\t\t};\n\t\t\t\tvar object2 = {\n\t\t\t\t\tbanana: {\n\t\t\t\t\t\tprice: 200,\n\t\t\t\t\t\tcode: \"B98765\",\n\t\t\t\t\t\tpurchased: new Date(2017, 0, 1)\n\t\t\t\t\t},\n\t\t\t\t\telement: element,\n\t\t\t\t\tdurian: 100\n\t\t\t\t};\n\t\t\t\tutil.deepCopy(object1, object2);\n\t\t\t\tassert.strictEqual(object1.banana.weight, 52);\n\t\t\t\tassert.strictEqual(object1.banana.price, 200);\n\t\t\t\tassert.strictEqual(object1.banana.code, \"B98765\");\n\t\t\t\tassert.strictEqual(object1.element, element);\n\t\t\t\tassert.equal(object1.banana.purchased.getTime(), new Date(2017, 0, 1).getTime());\n\t\t\t} else {\n\t\t\t\tthis.skip('Do not run test if Element not available.');\n\t\t\t}\n\t\t},\n\n\t\t'deepCopy with Element, given Element is not defined': function(){\n\t\t\tif (typeof Element !== 'undefined') {\n\t\t\t\tthis.skip('Do not run test if Element is available.');\n\t\t\t}\n\n\t\t\tvar element = {nodeType: 1, value: 'Orange'};\n\t\t\tvar object1 = {\n\t\t\t\tapple: 0,\n\t\t\t\tbanana: {\n\t\t\t\t\tweight: 52,\n\t\t\t\t\tprice: 100,\n\t\t\t\t\tcode: \"B12345\",\n\t\t\t\t\tpurchased: new Date(2016, 0, 1)\n\t\t\t\t},\n\t\t\t\tcherry: 97\n\t\t\t};\n\t\t\tvar object2 = {\n\t\t\t\tbanana: {\n\t\t\t\t\tprice: 200,\n\t\t\t\t\tcode: \"B98765\",\n\t\t\t\t\tpurchased: new Date(2017, 0, 1)\n\t\t\t\t},\n\t\t\t\telement: element,\n\t\t\t\tdurian: 100\n\t\t\t};\n\t\t\tutil.deepCopy(object1, object2);\n\t\t\tassert.strictEqual(object1.banana.weight, 52);\n\t\t\tassert.strictEqual(object1.banana.price, 200);\n\t\t\tassert.strictEqual(object1.banana.code, \"B98765\");\n\t\t\tassert.strictEqual(object1.element, element);\n\t\t\tassert.equal(object1.banana.purchased.getTime(), new Date(2017, 0, 1).getTime());\n\t\t}\n\t});\n});\n"], "filenames": ["request/util.js", "tests/unit/request/util.js"], "buggy_code_start_loc": [47, 34], "buggy_code_end_loc": [48, 34], "fixing_code_start_loc": [47, 35], "fixing_code_end_loc": [48, 41], "type": "CWE-94", "message": "In affected versions of dojo (NPM package), the deepCopy method is vulnerable to Prototype Pollution. Prototype Pollution refers to the ability to inject properties into existing JavaScript language construct prototypes, such as objects. An attacker manipulates these attributes to overwrite, or pollute, a JavaScript application object prototype of the base object by injecting other values. This has been patched in versions 1.12.8, 1.13.7, 1.14.6, 1.15.3 and 1.16.2", "other": {"cve": {"id": "CVE-2020-5258", "sourceIdentifier": "security-advisories@github.com", "published": "2020-03-10T18:15:12.123", "lastModified": "2022-07-25T18:15:30.403", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "In affected versions of dojo (NPM package), the deepCopy method is vulnerable to Prototype Pollution. Prototype Pollution refers to the ability to inject properties into existing JavaScript language construct prototypes, such as objects. An attacker manipulates these attributes to overwrite, or pollute, a JavaScript application object prototype of the base object by injecting other values. This has been patched in versions 1.12.8, 1.13.7, 1.14.6, 1.15.3 and 1.16.2"}, {"lang": "es", "value": "En las versiones afectadas de dojo (paquete NPM), el m\u00e9todo deepCopy es vulnerable a una Contaminaci\u00f3n de Prototipo. La Contaminaci\u00f3n de Prototipo se refiere a la capacidad de inyectar propiedades en prototipos de construcciones de lenguaje JavaScript existentes, tales como objetos. Un atacante manipula estos atributos para sobrescribir o contaminar un prototipo de objeto de la aplicaci\u00f3n JavaScript del objeto base mediante la inyecci\u00f3n de otros valores. Esto ha sido parcheado en las versiones 1.12.8, 1.13.7, 1.14.6, 1.15.3 y 1.16.2"}], "metrics": {"cvssMetricV31": [{"source": "security-advisories@github.com", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.3, "impactScore": 5.8}, {"source": "nvd@nist.gov", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}, {"source": "nvd@nist.gov", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1321"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:linuxfoundation:dojo:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "1.11.10", "matchCriteriaId": "89DAC674-74C9-4386-AFD3-2176D0C7EFE8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:linuxfoundation:dojo:*:*:*:*:*:node.js:*:*", "versionStartIncluding": "1.12.0", "versionEndExcluding": "1.12.8", "matchCriteriaId": "48F3E53A-48A6-43A9-B7D5-2EFD771171E1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:linuxfoundation:dojo:*:*:*:*:*:node.js:*:*", "versionStartIncluding": "1.13.0", "versionEndExcluding": "1.13.7", "matchCriteriaId": "21446BEC-45A6-4517-B58D-E0597E5B76A6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:linuxfoundation:dojo:*:*:*:*:*:node.js:*:*", "versionStartIncluding": "1.14.0", "versionEndExcluding": "1.14.6", "matchCriteriaId": "4C083E22-8F0E-47CB-9567-105B12BB8102"}, {"vulnerable": true, "criteria": "cpe:2.3:a:linuxfoundation:dojo:*:*:*:*:*:node.js:*:*", "versionStartIncluding": "1.15.0", "versionEndExcluding": "1.15.3", "matchCriteriaId": "CD870D7B-AFF7-4A88-90C1-68828672557D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:linuxfoundation:dojo:*:*:*:*:*:node.js:*:*", "versionStartIncluding": "1.16.0", "versionEndExcluding": "1.16.2", "matchCriteriaId": "84C08ACB-03A1-4DC5-A37A-DEC707BE905D"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:oracle:communications_application_session_controller:3.9.0:*:*:*:*:*:*:*", "matchCriteriaId": "787E2C1B-9BAD-4018-8495-E9BE75628BB8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:communications_policy_management:12.5.0:*:*:*:*:*:*:*", "matchCriteriaId": "5312AC7A-3C16-4967-ACA6-317289A749D0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:communications_pricing_design_center:12.0.0.3.0:*:*:*:*:*:*:*", "matchCriteriaId": "D7B49D71-6A31-497A-B6A9-06E84F086E7A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:documaker:*:*:*:*:*:*:*:*", "versionStartIncluding": "12.6.0", "versionEndIncluding": "12.6.4", "matchCriteriaId": "135D531C-A692-4BE3-AB8C-37BB0D35559A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.3.0", "versionEndIncluding": "7.3.29", "matchCriteriaId": "5FA170A0-A410-418D-90E4-F6A3FB4760A4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.4.0", "versionEndIncluding": "7.4.28", "matchCriteriaId": "CD3477A7-2F1F-40A3-893A-9E4B20937CBD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.5.0", "versionEndIncluding": "7.5.18", "matchCriteriaId": "9FD21E94-2C49-4DA4-A081-6B1724CFA550"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.6.0", "versionEndIncluding": "7.6.14", "matchCriteriaId": "1D7A5C03-D134-4FCB-8512-78AEF249C077"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:mysql:*:*:*:*:*:*:*:*", "versionStartIncluding": "8.0.0", "versionEndIncluding": "8.0.20", "matchCriteriaId": "0E1A3769-E443-4511-B349-B5304F5E6EBD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:primavera_unifier:*:*:*:*:*:*:*:*", "versionStartIncluding": "17.7", "versionEndIncluding": "17.12", "matchCriteriaId": "08FA59A8-6A62-4B33-8952-D6E658F8DAC9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:primavera_unifier:18.8:*:*:*:*:*:*:*", "matchCriteriaId": "202AD518-2E9B-4062-B063-9858AE1F9CE2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:primavera_unifier:19.12:*:*:*:*:*:*:*", "matchCriteriaId": "10864586-270E-4ACF-BDCC-ECFCD299305F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:primavera_unifier:20.12:*:*:*:*:*:*:*", "matchCriteriaId": "38340E3C-C452-4370-86D4-355B6B4E0A06"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:webcenter_sites:12.2.1.3.0:*:*:*:*:*:*:*", "matchCriteriaId": "D551CAB1-4312-44AA-BDA8-A030817E153A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:webcenter_sites:12.2.1.4.0:*:*:*:*:*:*:*", "matchCriteriaId": "174A6D2E-E42E-4C92-A194-C6A820CD7EF4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:weblogic_server:12.2.1.4.0:*:*:*:*:*:*:*", "matchCriteriaId": "4A5BB153-68E0-4DDA-87D1-0D9AB7F0A418"}, {"vulnerable": true, "criteria": "cpe:2.3:a:oracle:weblogic_server:14.1.1.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "04BCDC24-4A21-473C-8733-0D9CFB38A752"}]}]}], "references": [{"url": "https://github.com/dojo/dojo/commit/20a00afb68f5587946dc76fbeaa68c39bda2171d", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/dojo/dojo/security/advisories/GHSA-jxfh-8wgv-vfr2", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://lists.apache.org/thread.html/r3638722360d7ae95f874280518b8d987d799a76df7a9cd78eac33a1b@%3Cusers.qpid.apache.org%3E", "source": "security-advisories@github.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.apache.org/thread.html/r665fcc152bd0fec9f71511a6c2435ff24d3a71386b01b1a6df326fd3@%3Cusers.qpid.apache.org%3E", "source": "security-advisories@github.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.apache.org/thread.html/rf481b3f25f05c52ba4e24991a941c1a6e88d281c6c9360a806554d00@%3Cusers.qpid.apache.org%3E", "source": "security-advisories@github.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://lists.debian.org/debian-lts-announce/2020/03/msg00012.html", "source": "security-advisories@github.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://www.oracle.com//security-alerts/cpujul2021.html", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://www.oracle.com/security-alerts/cpujan2022.html", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://www.oracle.com/security-alerts/cpujul2020.html", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://www.oracle.com/security-alerts/cpujul2022.html", "source": "security-advisories@github.com"}, {"url": "https://www.oracle.com/security-alerts/cpuoct2021.html", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/dojo/dojo/commit/20a00afb68f5587946dc76fbeaa68c39bda2171d"}}