{"buggy_code": ["/* radare - LGPL - Copyright 2018 - xvilka */\n\n#include <r_types.h>\n#include <r_util.h>\n#include <r_asm.h>\n#include <r_anal.h>\n#include <r_lib.h>\n#include \"hexagon.h\"\n#include \"hexagon_insn.h\"\n#include \"hexagon_anal.h\"\n\nstatic int hexagon_v6_op(RAnal *anal, RAnalOp *op, ut64 addr, const ut8 *buf, int len, RAnalOpMask mask) {\n\tHexInsn hi = {0};;\n\tut32 data = 0;\n\tdata = r_read_le32 (buf);\n\tint size = hexagon_disasm_instruction (data, &hi, (ut32) addr);\n\top->size = size;\n\tif (size <= 0) {\n\t\treturn size;\n\t}\n\n\top->addr = addr;\n\treturn hexagon_anal_instruction (&hi, op);\n}\n\nstatic bool set_reg_profile(RAnal *anal) {\n\t// TODO: Add missing registers\n\tconst char *p =\n\t\t\"=PC\tpc\\n\"\n\t\t\"=SP\tr29\\n\"\n\t\t\"=A0\tr0\\n\"\n\t\t\"=A1\tr1\\n\"\n\t\t\"=A2\tr2\\n\"\n\t\t\"=A3\tr3\\n\"\n\t\t\"=A4\tr4\\n\"\n\t\t\"=A5\tr5\\n\"\n\t\t\"=BP\tr30\\n\"\n\t\t\"=LR\tr31\\n\"\n\t\t\"=SN\tr6\\n\"\n\t\t\"=ZF\tz\\n\"\n\t\t\"=SF\ts\\n\"\n\t\t\"=OF\tov\\n\"\n\t\t\"=CF\tcy\\n\"\n\n\t\t\"gpr\tr0\t.32\t0   0\\n\"\n\t\t\"gpr\tr1\t.32\t4   0\\n\"\n\t\t\"gpr\tr2\t.32\t8   0\\n\"\n\t\t\"gpr\tr3\t.32\t12  0\\n\"\n\t\t\"gpr\tr4\t.32\t16  0\\n\"\n\t\t\"gpr\tr5\t.32\t20  0\\n\"\n\t\t\"gpr\tr6\t.32\t24  0\\n\"\n\t\t\"gpr\tr7\t.32\t28  0\\n\"\n\t\t\"gpr\tr8\t.32\t32  0\\n\"\n\t\t\"gpr\tr9\t.32\t36  0\\n\"\n\t\t\"gpr\tr10\t.32\t40  0\\n\"\n\t\t\"gpr\tr11\t.32\t44  0\\n\"\n\t\t\"gpr\tr12\t.32\t48  0\\n\"\n\t\t\"gpr\tr13\t.32\t52  0\\n\"\n\t\t\"gpr\tr14\t.32\t56  0\\n\"\n\t\t\"gpr\tr15\t.32\t60  0\\n\"\n\t\t\"gpr\tr16\t.32\t64  0\\n\"\n\t\t\"gpr\tr17\t.32\t68  0\\n\"\n\t\t\"gpr\tr18\t.32\t72  0\\n\"\n\t\t\"gpr\tr19\t.32\t76  0\\n\"\n\t\t\"gpr\tr20\t.32\t80  0\\n\"\n\t\t\"gpr\tr21\t.32\t84  0\\n\"\n\t\t\"gpr\tr22\t.32\t88  0\\n\"\n\t\t\"gpr\tr23\t.32\t92  0\\n\"\n\t\t\"gpr\tr24\t.32\t96  0\\n\"\n\t\t\"gpr\tr25\t.32\t100 0\\n\"\n\t\t\"gpr\tr26\t.32\t104 0\\n\"\n\t\t\"gpr\tr27\t.32\t108 0\\n\"\n\t\t\"gpr\tr28\t.32\t112 0\\n\"\n\t\t\"gpr\tr29\t.32\t116 0\\n\"\n\t\t\"gpr\tr30\t.32\t120 0\\n\"\n\t\t\"gpr\tr31\t.32\t124 0\\n\"\n\t\t\"gpr\tpc\t.32\t128 0\\n\"\n\n\t\t\"gpr\tpsw .32 132 0\\n\"\n\t\t\"gpr\tnp  .1 132.16 0\\n\"\n\t\t\"gpr\tep  .1 132.17 0\\n\"\n\t\t\"gpr\tae  .1 132.18 0\\n\"\n\t\t\"gpr\tid  .1 132.19 0\\n\"\n\t\t\"flg\tcy  .1 132.28 0\\n\"\n\t\t\"flg\tov  .1 132.29 0\\n\"\n\t\t\"flg\ts   .1 132.30 0\\n\"\n\t\t\"flg\tz   .1 132.31 0\\n\";\n\n\treturn r_reg_set_profile_string (anal->reg, p);\n}\n\nRAnalPlugin r_anal_plugin_hexagon = {\n\t.name = \"hexagon\",\n\t.desc = \"Qualcomm Hexagon (QDSP6) V6\",\n\t.license = \"LGPL3\",\n\t.arch = \"hexagon\",\n\t.bits = 32,\n\t.op = hexagon_v6_op,\n\t.esil = true,\n\t.set_reg_profile = set_reg_profile,\n};\n\n#ifndef R2_PLUGIN_INCORE\nR_API RLibStruct radare_plugin = {\n\t.type = R_LIB_TYPE_ANAL,\n\t.data = &r_anal_plugin_hexagon_v6,\n\t.version = R2_VERSION\n};\n#endif\n"], "fixing_code": ["/* radare - LGPL - Copyright 2018 - xvilka */\n\n#include <r_types.h>\n#include <r_util.h>\n#include <r_asm.h>\n#include <r_anal.h>\n#include <r_lib.h>\n#include \"hexagon.h\"\n#include \"hexagon_insn.h\"\n#include \"hexagon_anal.h\"\n\nstatic int hexagon_v6_op(RAnal *anal, RAnalOp *op, ut64 addr, const ut8 *buf, int len, RAnalOpMask mask) {\n\tHexInsn hi = {0};\n\tut32 data = 0;\n\tif (len < 4) {\n\t\treturn 0;\n\t}\n\tdata = r_read_le32 (buf);\n\tint size = hexagon_disasm_instruction (data, &hi, (ut32) addr);\n\top->size = size;\n\tif (size <= 0) {\n\t\treturn size;\n\t}\n\n\top->addr = addr;\n\treturn hexagon_anal_instruction (&hi, op);\n}\n\nstatic bool set_reg_profile(RAnal *anal) {\n\t// TODO: Add missing registers\n\tconst char *p =\n\t\t\"=PC\tpc\\n\"\n\t\t\"=SP\tr29\\n\"\n\t\t\"=A0\tr0\\n\"\n\t\t\"=A1\tr1\\n\"\n\t\t\"=A2\tr2\\n\"\n\t\t\"=A3\tr3\\n\"\n\t\t\"=A4\tr4\\n\"\n\t\t\"=A5\tr5\\n\"\n\t\t\"=BP\tr30\\n\"\n\t\t\"=LR\tr31\\n\"\n\t\t\"=SN\tr6\\n\"\n\t\t\"=ZF\tz\\n\"\n\t\t\"=SF\ts\\n\"\n\t\t\"=OF\tov\\n\"\n\t\t\"=CF\tcy\\n\"\n\n\t\t\"gpr\tr0\t.32\t0   0\\n\"\n\t\t\"gpr\tr1\t.32\t4   0\\n\"\n\t\t\"gpr\tr2\t.32\t8   0\\n\"\n\t\t\"gpr\tr3\t.32\t12  0\\n\"\n\t\t\"gpr\tr4\t.32\t16  0\\n\"\n\t\t\"gpr\tr5\t.32\t20  0\\n\"\n\t\t\"gpr\tr6\t.32\t24  0\\n\"\n\t\t\"gpr\tr7\t.32\t28  0\\n\"\n\t\t\"gpr\tr8\t.32\t32  0\\n\"\n\t\t\"gpr\tr9\t.32\t36  0\\n\"\n\t\t\"gpr\tr10\t.32\t40  0\\n\"\n\t\t\"gpr\tr11\t.32\t44  0\\n\"\n\t\t\"gpr\tr12\t.32\t48  0\\n\"\n\t\t\"gpr\tr13\t.32\t52  0\\n\"\n\t\t\"gpr\tr14\t.32\t56  0\\n\"\n\t\t\"gpr\tr15\t.32\t60  0\\n\"\n\t\t\"gpr\tr16\t.32\t64  0\\n\"\n\t\t\"gpr\tr17\t.32\t68  0\\n\"\n\t\t\"gpr\tr18\t.32\t72  0\\n\"\n\t\t\"gpr\tr19\t.32\t76  0\\n\"\n\t\t\"gpr\tr20\t.32\t80  0\\n\"\n\t\t\"gpr\tr21\t.32\t84  0\\n\"\n\t\t\"gpr\tr22\t.32\t88  0\\n\"\n\t\t\"gpr\tr23\t.32\t92  0\\n\"\n\t\t\"gpr\tr24\t.32\t96  0\\n\"\n\t\t\"gpr\tr25\t.32\t100 0\\n\"\n\t\t\"gpr\tr26\t.32\t104 0\\n\"\n\t\t\"gpr\tr27\t.32\t108 0\\n\"\n\t\t\"gpr\tr28\t.32\t112 0\\n\"\n\t\t\"gpr\tr29\t.32\t116 0\\n\"\n\t\t\"gpr\tr30\t.32\t120 0\\n\"\n\t\t\"gpr\tr31\t.32\t124 0\\n\"\n\t\t\"gpr\tpc\t.32\t128 0\\n\"\n\n\t\t\"gpr\tpsw .32 132 0\\n\"\n\t\t\"gpr\tnp  .1 132.16 0\\n\"\n\t\t\"gpr\tep  .1 132.17 0\\n\"\n\t\t\"gpr\tae  .1 132.18 0\\n\"\n\t\t\"gpr\tid  .1 132.19 0\\n\"\n\t\t\"flg\tcy  .1 132.28 0\\n\"\n\t\t\"flg\tov  .1 132.29 0\\n\"\n\t\t\"flg\ts   .1 132.30 0\\n\"\n\t\t\"flg\tz   .1 132.31 0\\n\";\n\n\treturn r_reg_set_profile_string (anal->reg, p);\n}\n\nRAnalPlugin r_anal_plugin_hexagon = {\n\t.name = \"hexagon\",\n\t.desc = \"Qualcomm Hexagon (QDSP6) V6\",\n\t.license = \"LGPL3\",\n\t.arch = \"hexagon\",\n\t.bits = 32,\n\t.op = hexagon_v6_op,\n\t.esil = true,\n\t.set_reg_profile = set_reg_profile,\n};\n\n#ifndef R2_PLUGIN_INCORE\nR_API RLibStruct radare_plugin = {\n\t.type = R_LIB_TYPE_ANAL,\n\t.data = &r_anal_plugin_hexagon_v6,\n\t.version = R2_VERSION\n};\n#endif\n"], "filenames": ["libr/anal/p/anal_hexagon.c"], "buggy_code_start_loc": [13], "buggy_code_end_loc": [14], "fixing_code_start_loc": [13], "fixing_code_end_loc": [18], "type": "CWE-787", "message": "A heap buffer overflow in r_read_le32 function in radare25.4.2 and 5.4.0.", "other": {"cve": {"id": "CVE-2022-28072", "sourceIdentifier": "cve@mitre.org", "published": "2023-08-22T19:16:22.740", "lastModified": "2023-08-24T22:04:59.273", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A heap buffer overflow in r_read_le32 function in radare25.4.2 and 5.4.0."}, {"lang": "es", "value": "Un desbordamiento del b\u00fafer del mont\u00edculo en la funci\u00f3n r_read_le32 en radare2 5.4.2 y 5.4.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-787"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:radare:radare2:5.4.0:*:*:*:*:*:*:*", "matchCriteriaId": "834B6EB8-099A-469F-ADA3-183E51E43717"}, {"vulnerable": true, "criteria": "cpe:2.3:a:radare:radare2:5.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "C9DEDA4E-172C-482D-8527-D9AEF8A1D7CC"}]}]}], "references": [{"url": "https://github.com/radareorg/radare2/commit/027cd9b7274988bb1af866539ba6c2fa2ff63e45", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/radareorg/radare2/commit/027cd9b7274988bb1af866539ba6c2fa2ff63e45"}}