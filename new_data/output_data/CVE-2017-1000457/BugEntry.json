{"buggy_code": ["using System;\nusing System.Web.UI;\nusing mojoPortal.Business.WebHelpers;\nusing mojoPortal.Web.Framework;\nusing Resources;\n\nnamespace mojoPortal.Web.UI.Pages\n{\n\tpublic partial class Help : Page\n\t{\n\t\tprivate string helpKey = String.Empty;\n\n\n\t\tprotected override void OnInit(EventArgs e)\n\t\t{\n\t\t\tbase.OnInit(e);\n\t\t\tLoad += new EventHandler(Page_Load);\n\t\t}\n\n\n\t\tprotected void Page_Load(object sender, EventArgs e)\n\t\t{\n\t\t\tif (Request.Params.Get(\"helpkey\") != null)\n\t\t\t{\n\t\t\t\thelpKey = Request.Params.Get(\"helpkey\");\n\t\t\t}\n\n\t\t\t// if we pass this param suppress edit link doesn't work in cluetip\n\t\t\tif (Request.Params.Get(\"e\") == null)\n\t\t\t{\n\t\t\t\tif (WebUser.IsAdminOrContentAdmin)\n\t\t\t\t{\n\t\t\t\t\tif (helpKey != String.Empty)\n\t\t\t\t\t{\n\t\t\t\t\t\tlitEditLink.Text =\n\t\t\t\t\t\t\t\"<a href='\" +\n\t\t\t\t\t\t\tSiteUtils.GetNavigationSiteRoot() + \"/HelpEdit.aspx?helpkey=\" +\n\t\t\t\t\t\t\tSecurityHelper.RemoveMarkup(helpKey) + \"'>\" +\n\t\t\t\t\t\t\tResource.HelpEditLink +\n\t\t\t\t\t\t\t\"</a><br />\"\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (helpKey != String.Empty)\n\t\t\t{\n\t\t\t\tShowHelp();\n\t\t\t}\n\t\t}\n\n\n\t\tprotected void ShowHelp()\n\t\t{\n\t\t\tString helpText = ResourceHelper.GetHelpFileText(helpKey);\n\n\t\t\tif (helpText == String.Empty)\n\t\t\t{\n\t\t\t\thelpText = WebUser.IsAdminOrContentAdmin ?\n\t\t\t\t\tString.Format(Resource.HelpNoHelpAvailableAdminUser, helpKey) :\n\t\t\t\t\tResource.HelpNoHelpAvailable;\n\t\t\t}\n\n\t\t\tlitHelp.Text = helpText;\n\t\t}\n\t}\n}\n"], "fixing_code": ["using mojoPortal.Business.WebHelpers;\nusing mojoPortal.Web.Framework;\nusing Resources;\nusing System;\nusing System.Web;\nusing System.Web.UI;\n\nnamespace mojoPortal.Web.UI.Pages\n{\n\tpublic partial class Help : Page\n\t{\n\t\tprivate string helpKey = String.Empty;\n\n\n\t\tprotected override void OnInit(EventArgs e)\n\t\t{\n\t\t\tbase.OnInit(e);\n\t\t\tLoad += new EventHandler(Page_Load);\n\t\t}\n\n\n\t\tprotected void Page_Load(object sender, EventArgs e)\n\t\t{\n\t\t\tif (Request.Params.Get(\"helpkey\") != null)\n\t\t\t{\n\t\t\t\thelpKey = Request.Params.Get(\"helpkey\");\n\t\t\t}\n\n\t\t\t// if we pass this param suppress edit link doesn't work in cluetip\n\t\t\tif (Request.Params.Get(\"e\") == null)\n\t\t\t{\n\t\t\t\tif (WebUser.IsAdminOrContentAdmin)\n\t\t\t\t{\n\t\t\t\t\tif (helpKey != String.Empty)\n\t\t\t\t\t{\n\t\t\t\t\t\tlitEditLink.Text =\n\t\t\t\t\t\t\t\"<a href='\" +\n\t\t\t\t\t\t\tSiteUtils.GetNavigationSiteRoot() + \"/HelpEdit.aspx?helpkey=\" +\n\t\t\t\t\t\t\tSecurityHelper.RemoveMarkup(helpKey) + \"'>\" +\n\t\t\t\t\t\t\tResource.HelpEditLink +\n\t\t\t\t\t\t\t\"</a><br />\"\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (helpKey != String.Empty)\n\t\t\t{\n\t\t\t\tShowHelp();\n\t\t\t}\n\t\t}\n\n\n\t\tprotected void ShowHelp()\n\t\t{\n\t\t\tString helpText = ResourceHelper.GetHelpFileText(helpKey);\n\n\t\t\tif (helpText == String.Empty)\n\t\t\t{\n\t\t\t\thelpText = WebUser.IsAdminOrContentAdmin ?\n\t\t\t\t\tString.Format(Resource.HelpNoHelpAvailableAdminUser, helpKey) :\n\t\t\t\t\tResource.HelpNoHelpAvailable;\n\t\t\t}\n\n\t\t\tlitHelp.Text = HttpUtility.HtmlDecode(SecurityHelper.RemoveMarkup(helpText));\n\t\t}\n\t}\n}"], "filenames": ["Web/Help.aspx.cs"], "buggy_code_start_loc": [1], "buggy_code_end_loc": [68], "fixing_code_start_loc": [0], "fixing_code_end_loc": [69], "type": "CWE-79", "message": "Cross-site scripting (XSS) vulnerability in Help.aspx in mojoPortal version 2.5.0.0 allows remote attackers to inject arbitrary web script or HTML via the helpkey parameter. Exploitation requires authenticated reflected cross-site scripting for user accounts assigned either the \"Administrators\" or \"Content Administrators\" role.", "other": {"cve": {"id": "CVE-2017-1000457", "sourceIdentifier": "cve@mitre.org", "published": "2018-01-02T18:29:00.293", "lastModified": "2018-01-17T17:39:20.963", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in Help.aspx in mojoPortal version 2.5.0.0 allows remote attackers to inject arbitrary web script or HTML via the helpkey parameter. Exploitation requires authenticated reflected cross-site scripting for user accounts assigned either the \"Administrators\" or \"Content Administrators\" role."}, {"lang": "es", "value": "Vulnerabilidad de Cross-Site Scripting (XSS) en Help.aspx en mojoPortal en su versi\u00f3n 2.5.0.0 permite que atacantes remotos inyecten scripts web o HTML arbitrarios mediante el par\u00e1metro helpkey. La explotaci\u00f3n requiere de Cross-Site Scripting (XSS) reflejado autenticado para cuentas de usuario que tengan asignadas los roles de \"Administrators\" o \"Content Administrators\"."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mojoportal:mojoportal:2.5.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "2F6499B1-E927-44AE-BCE6-A9D4637F57BC"}]}]}], "references": [{"url": "https://github.com/i7MEDIA/mojoportal/commit/5ea8129f74c80cbf1f68b9083c745cc8a685485d", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://www.mojoportal.com/mojoportal-2-6", "source": "cve@mitre.org", "tags": ["Release Notes"]}]}, "github_commit_url": "https://github.com/i7MEDIA/mojoportal/commit/5ea8129f74c80cbf1f68b9083c745cc8a685485d"}}