{"buggy_code": ["<?php\n/* Copyright (C) 2015 Daniel Preussker, QuxLabs UG <preussker@quxlabs.com>\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>. */\n\n/**\n * Notification Page\n *\n * @author Daniel Preussker\n * @copyright 2015 Daniel Preussker, QuxLabs UG\n * @license GPL\n */\n\nuse App\\Models\\User;\nuse LibreNMS\\ObjectCache;\n\n$notifications = new ObjectCache('notifications');\n?>\n<div class=\"container\">\n  <div class=\"row\">\n    <div class=\"col-md-12\">\n      <h1><a href=\"/notifications\">Notifications</a></h1>\n      <h4>\n<?php\necho '<strong class=\"count-notif\">' . $notifications['count'] . '</strong> Unread Notifications ';\n\nif (Auth::user()->hasGlobalAdmin()) {\n    echo '<button class=\"btn btn-success pull-right fa fa-plus new-notif\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Create new notification\" style=\"margin-top:-10px;\"></button>';\n}\n\nif ($notifications['count'] > 0 && ! isset($vars['archive'])) {\n    echo '<button class=\"btn btn-success pull-right fa fa-eye read-all-notif\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Mark all as Read\" style=\"margin-top:-10px;\"></button>';\n}\n?>\n      </h4>\n      <hr/>\n    </div>\n  </div>\n</div>\n<div class=\"container new-notif-collapse\">\n  <div class=\"row\">\n    <div class=\"col-md-12\">\n      <form class=\"form-horizontal new-notif-form\">\n        <?php echo csrf_field() ?>\n        <div class=\"form-group\">\n          <label for=\"notif_title\" class=\"col-sm-2 control-label\">Title</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"notif_title\" name=\"notif_title\" placeholder=\"\">\n          </div>\n        </div>\n        <div class=\"form-group\">\n          <label for=\"notif_body\" class=\"col-sm-2 control-label\">Message</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"notif_body\" name=\"notif_body\"></textarea>\n          </div>\n        </div>\n        <div class=\"form-group\">\n          <div class=\"col-sm-offset-2 col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-success\">Add Notification</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n<?php if (! isset($vars['archive'])) { ?>\n<div class=\"container\">\n    <?php\n    foreach ($notifications['sticky'] as $notif) {\n        if (is_numeric($notif['source'])) {\n            $notif['source'] = dbFetchCell('select username from users where user_id =?', [$notif['source']]);\n        }\n        echo '<div class=\"well\"><div class=\"row\"> <div class=\"col-md-12\">';\n\n        $class = $notif['severity'] == 2 ? 'text-danger' : 'text-warning';\n        echo \"<h4 class='$class' id='${notif['notifications_id']}'>\";\n        echo \"<strong><i class='fa fa-bell-o'></i>&nbsp;${notif['title']}</strong>\";\n        echo \"<span class='pull-right'>\";\n\n        if ($notif['user_id'] != Auth::id()) {\n            $sticky_user = User::find($notif['user_id']);\n            echo \"<code>Sticky by {$sticky_user->username}</code>\";\n        } else {\n            echo '<button class=\"btn btn-primary fa fa-bell-slash-o unstick-notif\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Remove Sticky\" style=\"margin-top:-10px;\"></button>';\n        }\n\n        echo '</span></h4>'; ?>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <blockquote<?php echo $notif['severity'] == 2 ? ' style=\"border-color: darkred;\"' : '' ?>>\n          <p><?php echo \\LibreNMS\\Util\\Clean::html($notif['body'], ['HTML.Allowed' => 'br']); ?></p>\n          <footer><?php echo $notif['datetime']; ?> | Source: <code><?php echo $notif['source']; ?></code></footer>\n        </blockquote>\n      </div>\n    </div>\n  </div>\n    <?php\n    } ?>\n    <?php    if ($notifications['sticky_count'] != 0) { ?>\n<hr/>\n    <?php    } ?>\n    <?php\n    foreach ($notifications['unread'] as $notif) {\n        if (is_numeric($notif['source'])) {\n            $source_user = User::find($notif['source']);\n            $notif['source'] = $source_user->username;\n        }\n        echo '<div class=\"well\"><div class=\"row\"> <div class=\"col-md-12\">';\n        d_echo($notif);\n        $class = 'text-success';\n        if ($notif['severity'] == 1) {\n            $class = 'text-warning';\n        } elseif ($notif['severity'] == 2) {\n            $class = 'text-danger';\n        }\n        echo \"<h4 class='$class' id='${notif['notifications_id']}'>${notif['title']}<span class='pull-right'>\";\n\n        if (Auth::user()->hasGlobalAdmin()) {\n            echo '<button class=\"btn btn-primary fa fa-bell-o stick-notif\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Mark as Sticky\" style=\"margin-top:-10px;\"></button>';\n        } ?>\n\n<button class=\"btn btn-primary fa fa-eye read-notif\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Mark as Read\" style=\"margin-top:-10px;\"></button>\n</span>\n</h4>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n          <blockquote<?php echo $notif['severity'] == 2 ? ' style=\"border-color: darkred;\"' : '' ?>>\n          <p><?php echo \\LibreNMS\\Util\\Clean::html($notif['body'], ['HTML.Allowed' => 'br']); ?></p>\n          <footer><?php echo $notif['datetime']; ?> | Source: <code><?php echo $notif['source']; ?></code></footer>\n        </blockquote>\n      </div>\n    </div>\n  </div>\n    <?php\n    } ?>\n  <div class=\"row\">\n    <div class=\"col-md-12\">\n      <h3><a class=\"btn btn-default\" href=\"notifications/archive/\">Show Archive</a></h3>\n    </div>\n  </div>\n</div>\n<?php } elseif (isset($vars['archive'])) { ?>\n<div class=\"container\">\n  <div class=\"row\">\n    <div class=\"col-md-12\">\n      <h2>Archive</h2>\n    </div>\n  </div>\n    <?php\n    foreach ($notifications['read'] as $notif) {\n        echo '<div class=\"well\"><div class=\"row\"> <div class=\"col-md-12\"><h4';\n        if ($notif['severity'] == 1) {\n            echo ' class=\"text-warning\"';\n        } elseif ($notif['severity'] == 2) {\n            echo ' class=\"text-danger\"';\n        }\n        echo  \" id='${notif['notifications_id']}'>${notif['title']}\";\n\n        if (Auth::user()->isAdmin()) {\n            echo '<span class=\"pull-right\"><button class=\"btn btn-primary fa fa-bell-o stick-notif\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Mark as Sticky\" style=\"margin-top:-10px;\"></button></span>';\n        } ?>\n        </h4>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n          <blockquote<?php echo $notif['severity'] == 2 ? ' style=\"border-color: darkred;\"' : '' ?>>\n          <p><?php echo \\LibreNMS\\Util\\Clean::html($notif['body'], ['HTML.Allowed' => 'br']); ?></p>\n          <footer><?php echo $notif['datetime']; ?> | Source: <code><?php echo $notif['source']; ?></code></footer>\n        </blockquote>\n      </div>\n    </div>\n  </div>\n    <?php\n    } ?>\n</div>\n<?php } ?>\n<script>\n$(function() {\n  $('[data-toggle=\"tooltip\"]').tooltip();\n  $('.new-notif-collapse').fadeOut(0);\n  $(document).on( \"click\", \".new-notif\", function() {\n      $('.new-notif-collapse').fadeToggle();\n  });\n\n  $(document).on( \"submit\", \".new-notif-form\", function() {\n    var notif = {};\n    data = $(this).serializeArray();\n    for( var field in data ) {\n      notif[data[field].name] = data[field].value;\n    }\n    $.ajax({\n      type: 'POST',\n      url: 'ajax_form.php',\n      data: {type: 'notifications', title: notif.notif_title, body: notif.notif_body, action: 'create'},\n      dataType: \"json\",\n      success: function (data) {\n        if( data.status == \"ok\" ) {\n          window.location.href=\"notifications\";\n        } else {\n          toastr.error(data.message);\n        }\n      }\n    });\n    return false;\n  });\n\n  $(document).on( \"click\", \".read-notif\", function() {\n    $(this).attr(\"disabled\", true);\n    var notif = $(this).parent().parent().attr('id');\n    $.ajax({\n      type: 'POST',\n      url: 'ajax_form.php',\n      data: {type: 'notifications', notification_id: notif, action: 'read'},\n      dataType: \"json\",\n      success: function (data) {\n        if( data.status == \"ok\" ) {\n          $(\"#message\").html('<div class=\"alert alert-info\">' + data.message + '</div>');\n          $(\"#\"+notif).parent().parent().parent().fadeOut();\n          $(\".count-notif\").each(function(){\n              var new_count = this.innerHTML-1;\n              this.innerHTML = new_count;\n              if (new_count == 0) {\n                  $this = $(this);\n                  if ($this.hasClass('badge-danger')) {\n                      $this.removeClass('badge-danger');\n                  }\n              }\n          });\n        }\n        else {\n          $(this).attr(\"disabled\", false);\n          $(\"#message\").html('<div class=\"alert alert-info\">' + data.message + '</div>');\n        }\n      }\n    });\n  });\n\n  $(document).on( \"click\", \".read-all-notif\", function() {\n    $(this).attr(\"disabled\", true);\n    $.ajax({\n      type: 'POST',\n      url: 'ajax_form.php',\n      data: {type: 'notifications', action: 'read-all-notif'},\n      dataType: \"json\",\n      success: function (data) {\n        if( data.status == \"ok\" ) {\n          window.location.reload()\n        }\n        else {\n          $(this).attr(\"disabled\", false);\n        }\n      }\n    });\n  });\n\n  $(document).on( \"click\", \".stick-notif\", function() {\n    var notif = $(this).parent().parent().attr('id');\n    $.ajax({\n      type: 'POST',\n      url: 'ajax_form.php',\n      data: {type: 'notifications', notification_id: notif, action: 'stick'},\n      dataType: \"json\",\n      success: function (data) {\n        if( data.status == \"ok\" ) {\n          $(\"#message\").html('<div class=\"alert alert-info\">' + data.message + '</div>');\n          window.location.href=\"notifications\";\n        }\n        else {\n          $(\"#message\").html('<div class=\"alert alert-info\">' + data.message + '</div>');\n        }\n      }\n    });\n  });\n\n  $(document).on( \"click\", \".unstick-notif\", function() {\n    var notif = $(this).parent().parent().attr('id');\n    $.ajax({\n      type: 'POST',\n      url: 'ajax_form.php',\n      data: {type: 'notifications', notification_id: notif, action: 'unstick'},\n      dataType: \"json\",\n      success: function (data) {\n        if( data.status == \"ok\" ) {\n          $(\"#message\").html('<div class=\"alert alert-info\">' + data.message + '</div>');\n          window.location.href=\"notifications\";\n        }\n        else {\n          $(\"#message\").html('<div class=\"alert alert-info\">' + data.message + '</div>');\n        }\n      }\n    });\n  });\n\n});\n</script>\n"], "fixing_code": ["<?php\n/* Copyright (C) 2015 Daniel Preussker, QuxLabs UG <preussker@quxlabs.com>\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <https://www.gnu.org/licenses/>. */\n\n/**\n * Notification Page\n *\n * @author Daniel Preussker\n * @copyright 2015 Daniel Preussker, QuxLabs UG\n * @license GPL\n */\n\nuse App\\Models\\User;\nuse LibreNMS\\ObjectCache;\n\n$notifications = new ObjectCache('notifications');\n?>\n<div class=\"container\">\n  <div class=\"row\">\n    <div class=\"col-md-12\">\n      <h1><a href=\"/notifications\">Notifications</a></h1>\n      <h4>\n<?php\necho '<strong class=\"count-notif\">' . $notifications['count'] . '</strong> Unread Notifications ';\n\nif (Auth::user()->hasGlobalAdmin()) {\n    echo '<button class=\"btn btn-success pull-right fa fa-plus new-notif\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Create new notification\" style=\"margin-top:-10px;\"></button>';\n}\n\nif ($notifications['count'] > 0 && ! isset($vars['archive'])) {\n    echo '<button class=\"btn btn-success pull-right fa fa-eye read-all-notif\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Mark all as Read\" style=\"margin-top:-10px;\"></button>';\n}\n?>\n      </h4>\n      <hr/>\n    </div>\n  </div>\n</div>\n<div class=\"container new-notif-collapse\">\n  <div class=\"row\">\n    <div class=\"col-md-12\">\n      <form class=\"form-horizontal new-notif-form\">\n        <?php echo csrf_field() ?>\n        <div class=\"form-group\">\n          <label for=\"notif_title\" class=\"col-sm-2 control-label\">Title</label>\n          <div class=\"col-sm-10\">\n            <input type=\"text\" class=\"form-control\" id=\"notif_title\" name=\"notif_title\" placeholder=\"\">\n          </div>\n        </div>\n        <div class=\"form-group\">\n          <label for=\"notif_body\" class=\"col-sm-2 control-label\">Message</label>\n          <div class=\"col-sm-10\">\n            <textarea class=\"form-control\" id=\"notif_body\" name=\"notif_body\"></textarea>\n          </div>\n        </div>\n        <div class=\"form-group\">\n          <div class=\"col-sm-offset-2 col-sm-10\">\n            <button type=\"submit\" class=\"btn btn-success\">Add Notification</button>\n          </div>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n<?php if (! isset($vars['archive'])) { ?>\n<div class=\"container\">\n    <?php\n    foreach ($notifications['sticky'] as $notif) {\n        if (is_numeric($notif['source'])) {\n            $notif['source'] = dbFetchCell('select username from users where user_id =?', [$notif['source']]);\n        }\n        echo '<div class=\"well\"><div class=\"row\"> <div class=\"col-md-12\">';\n\n        $class = $notif['severity'] == 2 ? 'text-danger' : 'text-warning';\n        echo \"<h4 class='$class' id='${notif['notifications_id']}'>\";\n        echo \"<strong><i class='fa fa-bell-o'></i>&nbsp;\" . htmlentities($notif['title']) . '</strong>';\n        echo \"<span class='pull-right'>\";\n\n        if ($notif['user_id'] != Auth::id()) {\n            $sticky_user = User::find($notif['user_id']);\n            echo \"<code>Sticky by {$sticky_user->username}</code>\";\n        } else {\n            echo '<button class=\"btn btn-primary fa fa-bell-slash-o unstick-notif\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Remove Sticky\" style=\"margin-top:-10px;\"></button>';\n        }\n\n        echo '</span></h4>'; ?>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n        <blockquote<?php echo $notif['severity'] == 2 ? ' style=\"border-color: darkred;\"' : '' ?>>\n          <p><?php echo \\LibreNMS\\Util\\Clean::html($notif['body'], ['HTML.Allowed' => 'br']); ?></p>\n          <footer><?php echo $notif['datetime']; ?> | Source: <code><?php echo $notif['source']; ?></code></footer>\n        </blockquote>\n      </div>\n    </div>\n  </div>\n    <?php\n    } ?>\n    <?php    if ($notifications['sticky_count'] != 0) { ?>\n<hr/>\n    <?php    } ?>\n    <?php\n    foreach ($notifications['unread'] as $notif) {\n        if (is_numeric($notif['source'])) {\n            $source_user = User::find($notif['source']);\n            $notif['source'] = $source_user->username;\n        }\n        echo '<div class=\"well\"><div class=\"row\"> <div class=\"col-md-12\">';\n        d_echo($notif);\n        $class = 'text-success';\n        if ($notif['severity'] == 1) {\n            $class = 'text-warning';\n        } elseif ($notif['severity'] == 2) {\n            $class = 'text-danger';\n        }\n        echo \"<h4 class='$class' id='${notif['notifications_id']}'>\" . htmlentities($notif['title']) . \"<span class='pull-right'>\";\n\n        if (Auth::user()->hasGlobalAdmin()) {\n            echo '<button class=\"btn btn-primary fa fa-bell-o stick-notif\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Mark as Sticky\" style=\"margin-top:-10px;\"></button>';\n        } ?>\n\n<button class=\"btn btn-primary fa fa-eye read-notif\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Mark as Read\" style=\"margin-top:-10px;\"></button>\n</span>\n</h4>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n          <blockquote<?php echo $notif['severity'] == 2 ? ' style=\"border-color: darkred;\"' : '' ?>>\n          <p><?php echo \\LibreNMS\\Util\\Clean::html($notif['body'], ['HTML.Allowed' => 'br']); ?></p>\n          <footer><?php echo $notif['datetime']; ?> | Source: <code><?php echo $notif['source']; ?></code></footer>\n        </blockquote>\n      </div>\n    </div>\n  </div>\n    <?php\n    } ?>\n  <div class=\"row\">\n    <div class=\"col-md-12\">\n      <h3><a class=\"btn btn-default\" href=\"notifications/archive/\">Show Archive</a></h3>\n    </div>\n  </div>\n</div>\n<?php } elseif (isset($vars['archive'])) { ?>\n<div class=\"container\">\n  <div class=\"row\">\n    <div class=\"col-md-12\">\n      <h2>Archive</h2>\n    </div>\n  </div>\n    <?php\n    foreach ($notifications['read'] as $notif) {\n        echo '<div class=\"well\"><div class=\"row\"> <div class=\"col-md-12\"><h4';\n        if ($notif['severity'] == 1) {\n            echo ' class=\"text-warning\"';\n        } elseif ($notif['severity'] == 2) {\n            echo ' class=\"text-danger\"';\n        }\n        echo  \" id='${notif['notifications_id']}'>\" . htmlentities($notif['title']);\n\n        if (Auth::user()->isAdmin()) {\n            echo '<span class=\"pull-right\"><button class=\"btn btn-primary fa fa-bell-o stick-notif\" data-toggle=\"tooltip\" data-placement=\"bottom\" title=\"Mark as Sticky\" style=\"margin-top:-10px;\"></button></span>';\n        } ?>\n        </h4>\n      </div>\n    </div>\n    <div class=\"row\">\n      <div class=\"col-md-12\">\n          <blockquote<?php echo $notif['severity'] == 2 ? ' style=\"border-color: darkred;\"' : '' ?>>\n          <p><?php echo \\LibreNMS\\Util\\Clean::html($notif['body'], ['HTML.Allowed' => 'br']); ?></p>\n          <footer><?php echo $notif['datetime']; ?> | Source: <code><?php echo $notif['source']; ?></code></footer>\n        </blockquote>\n      </div>\n    </div>\n  </div>\n    <?php\n    } ?>\n</div>\n<?php } ?>\n<script>\n$(function() {\n  $('[data-toggle=\"tooltip\"]').tooltip();\n  $('.new-notif-collapse').fadeOut(0);\n  $(document).on( \"click\", \".new-notif\", function() {\n      $('.new-notif-collapse').fadeToggle();\n  });\n\n  $(document).on( \"submit\", \".new-notif-form\", function() {\n    var notif = {};\n    data = $(this).serializeArray();\n    for( var field in data ) {\n      notif[data[field].name] = data[field].value;\n    }\n    $.ajax({\n      type: 'POST',\n      url: 'ajax_form.php',\n      data: {type: 'notifications', title: notif.notif_title, body: notif.notif_body, action: 'create'},\n      dataType: \"json\",\n      success: function (data) {\n        if( data.status == \"ok\" ) {\n          window.location.href=\"notifications\";\n        } else {\n          toastr.error(data.message);\n        }\n      }\n    });\n    return false;\n  });\n\n  $(document).on( \"click\", \".read-notif\", function() {\n    $(this).attr(\"disabled\", true);\n    var notif = $(this).parent().parent().attr('id');\n    $.ajax({\n      type: 'POST',\n      url: 'ajax_form.php',\n      data: {type: 'notifications', notification_id: notif, action: 'read'},\n      dataType: \"json\",\n      success: function (data) {\n        if( data.status == \"ok\" ) {\n          $(\"#message\").html('<div class=\"alert alert-info\">' + data.message + '</div>');\n          $(\"#\"+notif).parent().parent().parent().fadeOut();\n          $(\".count-notif\").each(function(){\n              var new_count = this.innerHTML-1;\n              this.innerHTML = new_count;\n              if (new_count == 0) {\n                  $this = $(this);\n                  if ($this.hasClass('badge-danger')) {\n                      $this.removeClass('badge-danger');\n                  }\n              }\n          });\n        }\n        else {\n          $(this).attr(\"disabled\", false);\n          $(\"#message\").html('<div class=\"alert alert-info\">' + data.message + '</div>');\n        }\n      }\n    });\n  });\n\n  $(document).on( \"click\", \".read-all-notif\", function() {\n    $(this).attr(\"disabled\", true);\n    $.ajax({\n      type: 'POST',\n      url: 'ajax_form.php',\n      data: {type: 'notifications', action: 'read-all-notif'},\n      dataType: \"json\",\n      success: function (data) {\n        if( data.status == \"ok\" ) {\n          window.location.reload()\n        }\n        else {\n          $(this).attr(\"disabled\", false);\n        }\n      }\n    });\n  });\n\n  $(document).on( \"click\", \".stick-notif\", function() {\n    var notif = $(this).parent().parent().attr('id');\n    $.ajax({\n      type: 'POST',\n      url: 'ajax_form.php',\n      data: {type: 'notifications', notification_id: notif, action: 'stick'},\n      dataType: \"json\",\n      success: function (data) {\n        if( data.status == \"ok\" ) {\n          $(\"#message\").html('<div class=\"alert alert-info\">' + data.message + '</div>');\n          window.location.href=\"notifications\";\n        }\n        else {\n          $(\"#message\").html('<div class=\"alert alert-info\">' + data.message + '</div>');\n        }\n      }\n    });\n  });\n\n  $(document).on( \"click\", \".unstick-notif\", function() {\n    var notif = $(this).parent().parent().attr('id');\n    $.ajax({\n      type: 'POST',\n      url: 'ajax_form.php',\n      data: {type: 'notifications', notification_id: notif, action: 'unstick'},\n      dataType: \"json\",\n      success: function (data) {\n        if( data.status == \"ok\" ) {\n          $(\"#message\").html('<div class=\"alert alert-info\">' + data.message + '</div>');\n          window.location.href=\"notifications\";\n        }\n        else {\n          $(\"#message\").html('<div class=\"alert alert-info\">' + data.message + '</div>');\n        }\n      }\n    });\n  });\n\n});\n</script>\n"], "filenames": ["includes/html/pages/notifications.inc.php"], "buggy_code_start_loc": [87], "buggy_code_end_loc": [172], "fixing_code_start_loc": [87], "fixing_code_end_loc": [172], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Stored in GitHub repository librenms/librenms prior to 22.10.0.", "other": {"cve": {"id": "CVE-2022-3516", "sourceIdentifier": "security@huntr.dev", "published": "2022-11-20T05:15:10.600", "lastModified": "2022-11-21T12:42:47.807", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Stored in GitHub repository librenms/librenms prior to 22.10.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "HIGH", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.9, "impactScore": 4.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:librenms:librenms:*:*:*:*:*:*:*:*", "versionEndExcluding": "22.10.0", "matchCriteriaId": "99D1C2AF-9BBB-4F7D-9FC3-4A645F7C284D"}]}]}], "references": [{"url": "https://github.com/librenms/librenms/commit/8e85698aa3aa4884c2f3d6c987542477eb64f07c", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/734bb5eb-715c-4b64-bd33-280300a63748", "source": "security@huntr.dev", "tags": ["Permissions Required", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/librenms/librenms/commit/8e85698aa3aa4884c2f3d6c987542477eb64f07c"}}