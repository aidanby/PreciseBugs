{"buggy_code": ["# Security Policy\n\n## Reporting a Vulnerability\n\nPlease share privately the details of your security vulnerability by email to:\n[Contact Info](support@notrinos.com)  \nOr open an issue at [our forum](https://forums.notrinos.com/t/bugs-problems)\n\nMake sure to include as much information as possible, with the detailed steps to reproduce the problem,\nthe versions that are affected, the expected results and actual results, and any other information that\nmight help us react faster and more efficiently.\n\n## Vulnerability disclosure policy\n\nDue to the nature of open source, security vulnerability fixes are public. Patches for minor issues are committed directly to stable repository branch, to be published with next planned minor release. Confirmed serious vulnerabilities are fixed and published as soon as possible, together with new emergency minor release.\n", "/**********************************************************************\n\tCopyright (C) NotrinosERP.\n\tReleased under the terms of the GNU General Public License, GPL, \n\tas published by the Free Software Foundation, either version 3 \n\tof the License, or (at your option) any later version.\n\tThis program is distributed in the hope that it will be useful,\n\tbut WITHOUT ANY WARRANTY; without even the implied warranty of\n\tMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  \n\tSee the License here <http://www.gnu.org/licenses/gpl-3.0.html>.\n***********************************************************************/\n\nvar loadSelect2 = {\n\t'select': function(e) {\n\n\t\tif((e.hasAttribute('multiple') === false) && $(e).hasClass('nosearch') === false) {\n\t\t\t$(e).select2({\n\t\t\t\tdropdownAutoWidth : true,\n\t\t\t\t// break a select option item into multi lines\n\t\t\t\ttemplateResult: function(item) {\n\t\t\t\t\tvar selectionText = item.text.split('\\n');\n\t\t\t\t\tvar returnString = $('<span></span>');\n\t\t\t\t\t$.each(selectionText, function(index, value){\n\t\t\t\t\t\tline = value === undefined ? '' : value;\n\t\t\t\t\t\treturnString.append(line + '</br>');\n\t\t\t\t\t})\n\t\t\t\t\t\t\n\t\t\t\t\treturn returnString;\n\t\t\t\t}\n\t\t\t});\n\t\t\t$(e).on('select2:close', function() {\n\t\t\t\t$(this).focus();\n\t\t\t});\n\t\t\t$(e).on('select2:open', function(e2){\n\n\t\t\t\t$('.dynamic_combo_btn').remove();\n\n\t\t\t\tvar target_id = $(e2.target).attr('id');\n\t\t\t\tvar search_btn = $('#_'+target_id+'_search').clone();\n\t\t\t\tvar add_btn = $('#_'+target_id+'_add').clone();\n\t\t\t\t$(search_btn).addClass('dynamic_combo_btn');\n\t\t\t\t$(add_btn).addClass('dynamic_combo_btn');\n\t\t\t\t$(search_btn).removeAttr('id hidden');\n\t\t\t\t$(add_btn).removeAttr('id hidden');\n\n\t\t\t\t$('.select2-dropdown').append(search_btn);\n\t\t\t\tif($(add_btn) !== 'undefined')\n\t\t\t\t\t$('.select2-dropdown').append(add_btn);\n\t\t\t\t$(search_btn).add(add_btn).click(function(){\n\t\t\t\t\t$('select').select2('close');\n\t\t\t\t});\n\t\t\t\t\n\t\t\t});\n\t\t}\n\t}\n}\nBehaviour.register(loadSelect2);"], "fixing_code": ["# Security Policy\n\n## Reporting a Vulnerability\n\nPlease share privately the details of your security vulnerability by email to: support@notrinos.com  \nOr open an issue at [our forum](https://forums.notrinos.com/t/bugs-problems)\n\nMake sure to include as much information as possible, with the detailed steps to reproduce the problem,\nthe versions that are affected, the expected results and actual results, and any other information that\nmight help us react faster and more efficiently.\n\n## Vulnerability disclosure policy\n\nDue to the nature of open source, security vulnerability fixes are public. Patches for minor issues are committed directly to stable repository branch, to be published with next planned minor release. Confirmed serious vulnerabilities are fixed and published as soon as possible, together with new emergency minor release.\n", "/**********************************************************************\n\tCopyright (C) NotrinosERP.\n\tReleased under the terms of the GNU General Public License, GPL, \n\tas published by the Free Software Foundation, either version 3 \n\tof the License, or (at your option) any later version.\n\tThis program is distributed in the hope that it will be useful,\n\tbut WITHOUT ANY WARRANTY; without even the implied warranty of\n\tMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  \n\tSee the License here <http://www.gnu.org/licenses/gpl-3.0.html>.\n***********************************************************************/\n\nvar loadSelect2 = {\n\t'select': function(e) {\n\n\t\tif((e.hasAttribute('multiple') === false) && $(e).hasClass('nosearch') === false) {\n\t\t\t$(e).select2({\n\t\t\t\tdropdownAutoWidth : true,\n\t\t\t\ttemplateResult: function(item) {\n\t\t\t\t\t// replace(/</g, '&lt;') : prevent the code in the option\u2019s value from being executed by the browser.\n\t\t\t\t\t// split('\\n') : break a select option item into multi lines\n\t\t\t\t\tvar selectionText = item.text.replace(/</g, '&lt;').split('\\n');\n\t\t\t\t\tvar returnString = $('<span></span>');\n\t\t\t\t\t$.each(selectionText, function(index, value){\n\t\t\t\t\t\tline = value === undefined ? '' : value;\n\t\t\t\t\t\treturnString.append(line + '</br>');\n\t\t\t\t\t})\n\t\t\t\t\t\t\n\t\t\t\t\treturn returnString;\n\t\t\t\t}\n\t\t\t});\n\t\t\t$(e).on('select2:close', function() {\n\t\t\t\t$(this).focus();\n\t\t\t});\n\t\t\t$(e).on('select2:open', function(e2){\n\n\t\t\t\t$('.dynamic_combo_btn').remove();\n\n\t\t\t\tvar target_id = $(e2.target).attr('id');\n\t\t\t\tvar search_btn = $('#_'+target_id+'_search').clone();\n\t\t\t\tvar add_btn = $('#_'+target_id+'_add').clone();\n\t\t\t\t$(search_btn).addClass('dynamic_combo_btn');\n\t\t\t\t$(add_btn).addClass('dynamic_combo_btn');\n\t\t\t\t$(search_btn).removeAttr('id hidden');\n\t\t\t\t$(add_btn).removeAttr('id hidden');\n\n\t\t\t\t$('.select2-dropdown').append(search_btn);\n\t\t\t\tif($(add_btn) !== 'undefined')\n\t\t\t\t\t$('.select2-dropdown').append(add_btn);\n\t\t\t\t$(search_btn).add(add_btn).click(function(){\n\t\t\t\t\t$('select').select2('close');\n\t\t\t\t});\n\t\t\t\t\n\t\t\t});\n\t\t}\n\t}\n}\nBehaviour.register(loadSelect2);"], "filenames": ["SECURITY.md", "libraries/select.js"], "buggy_code_start_loc": [5, 18], "buggy_code_end_loc": [7, 21], "fixing_code_start_loc": [5, 17], "fixing_code_end_loc": [6, 22], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Stored in GitHub repository notrinos/notrinoserp prior to 0.7.", "other": {"cve": {"id": "CVE-2022-2871", "sourceIdentifier": "security@huntr.dev", "published": "2022-08-17T09:15:13.743", "lastModified": "2022-08-18T19:25:06.563", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Stored in GitHub repository notrinos/notrinoserp prior to 0.7."}, {"lang": "es", "value": "Una vulnerabilidad de tipo Cross-site Scripting (XSS) - Almacenado en el repositorio GitHub notrinos/notrinoserp versiones anteriores a 0.7."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.6, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 2.5}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:notrinos:notrinoserp:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.7", "matchCriteriaId": "1DA2C016-D055-4DB8-AE79-4E8247EAD917"}]}]}], "references": [{"url": "https://github.com/notrinos/notrinoserp/commit/0362778f4f678156c22a009094225823df8a4760", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/61126c07-22ac-4961-a198-1aa33060b373", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/notrinos/notrinoserp/commit/0362778f4f678156c22a009094225823df8a4760"}}