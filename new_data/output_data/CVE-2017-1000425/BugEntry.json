{"buggy_code": ["<%--\n/**\n * Copyright (c) 2000-present Liferay, Inc. All rights reserved.\n *\n * This library is free software; you can redistribute it and/or modify it under\n * the terms of the GNU Lesser General Public License as published by the Free\n * Software Foundation; either version 2.1 of the License, or (at your option)\n * any later version.\n *\n * This library is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\n * FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more\n * details.\n */\n--%>\n\n<%@ include file=\"/html/portal/init.jsp\" %>\n\n<%\nString title = ParamUtil.getString(request, \"title\");\n\nint height = ParamUtil.getInteger(request, \"height\", 768);\nint width = ParamUtil.getInteger(request, \"width\", 1024);\n\nString movie = ParamUtil.getString(request, \"movie\");\n%>\n\n<html>\n\t<head>\n\t\t<title><%= HtmlUtil.escape(title) %></title>\n\t\t<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\" />\n\n\t\t<script src=\"<%= themeDisplay.getCDNHost() + themeDisplay.getPathJavaScript() %>/misc/swfobject.js\" type=\"text/javascript\"></script>\n\t</head>\n\n\t<body leftmargin=\"0\" marginheight=\"0\" marginwidth=\"0\" rightmargin=\"0\" topmargin=\"0\">\n\t\t<center>\n\t\t\t<c:if test=\"<%= Validator.isNotNull(movie) %>\">\n\t\t\t\t<div id=\"flashMovie\"></div>\n\n\t\t\t\t<script type=\"text/javascript\">\n\t\t\t\t\tvar so = new SWFObject('<%= HtmlUtil.escapeJS(movie) %>', 'flashMovie', '<%= width %>', '<%= height %>', '6', '#FFFFFF');\n\n\t\t\t\t\tso.write('flashMovie');\n\t\t\t\t</script>\n\t\t\t</c:if>\n\t\t</center>\n\t</body>\n</html>"], "fixing_code": ["<%--\n/**\n * Copyright (c) 2000-present Liferay, Inc. All rights reserved.\n *\n * This library is free software; you can redistribute it and/or modify it under\n * the terms of the GNU Lesser General Public License as published by the Free\n * Software Foundation; either version 2.1 of the License, or (at your option)\n * any later version.\n *\n * This library is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\n * FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more\n * details.\n */\n--%>\n\n<%@ include file=\"/html/portal/init.jsp\" %>\n\n<%\nString title = ParamUtil.getString(request, \"title\");\n\nint height = ParamUtil.getInteger(request, \"height\", 768);\nint width = ParamUtil.getInteger(request, \"width\", 1024);\n\nString movie = ParamUtil.getString(request, \"movie\");\n\n// LPS-72916\n\nmovie = HtmlUtil.escapeHREF(movie);\n%>\n\n<html>\n\t<head>\n\t\t<title><%= HtmlUtil.escape(title) %></title>\n\t\t<meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\" />\n\n\t\t<script src=\"<%= themeDisplay.getCDNHost() + themeDisplay.getPathJavaScript() %>/misc/swfobject.js\" type=\"text/javascript\"></script>\n\t</head>\n\n\t<body leftmargin=\"0\" marginheight=\"0\" marginwidth=\"0\" rightmargin=\"0\" topmargin=\"0\">\n\t\t<center>\n\t\t\t<c:if test=\"<%= Validator.isNotNull(movie) %>\">\n\t\t\t\t<div id=\"flashMovie\"></div>\n\n\t\t\t\t<script type=\"text/javascript\">\n\t\t\t\t\tvar so = new SWFObject('<%= HtmlUtil.escapeJS(movie) %>', 'flashMovie', '<%= width %>', '<%= height %>', '6', '#FFFFFF');\n\n\t\t\t\t\tso.write('flashMovie');\n\t\t\t\t</script>\n\t\t\t</c:if>\n\t\t</center>\n\t</body>\n</html>"], "filenames": ["portal-web/docroot/html/portal/flash.jsp"], "buggy_code_start_loc": [25], "buggy_code_end_loc": [25], "fixing_code_start_loc": [26], "fixing_code_end_loc": [30], "type": "CWE-79", "message": "Cross-site scripting (XSS) vulnerability in the /html/portal/flash.jsp page in Liferay Portal CE 7.0 GA4 and older allows remote attackers to inject arbitrary web script or HTML via a javascript: URI in the \"movie\" parameter.", "other": {"cve": {"id": "CVE-2017-1000425", "sourceIdentifier": "cve@mitre.org", "published": "2018-01-02T23:29:00.210", "lastModified": "2018-03-29T14:21:44.320", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in the /html/portal/flash.jsp page in Liferay Portal CE 7.0 GA4 and older allows remote attackers to inject arbitrary web script or HTML via a javascript: URI in the \"movie\" parameter."}, {"lang": "es", "value": "Vulnerabilidad de Cross-Site Scripting (XSS) en la p\u00e1gina /html/portal/flash.jsp en Liferay Portal CE 7.0 GA4 y anteriores permite que atacantes remotos inyecten scripts web o HTML arbitrarios mediante un URI javascript: en el par\u00e1metro \"movie\"."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:liferay:liferay_portal:*:*:*:*:community:*:*:*", "versionEndExcluding": "7.0.3_ga4", "matchCriteriaId": "C731DAF9-91B5-4C31-B12A-87CB6A688051"}]}]}], "references": [{"url": "https://dev.liferay.com/web/community-security-team/known-vulnerabilities/-/asset_publisher/4AHAYapUm8Xc/content/cst-7030-multiple-xss-vulnerabilities-in-7-0-ce-ga4", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/liferay/liferay-portal/commit/9435af4ef8a90b5333da925a5ec860a43d18c031", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/liferay/liferay-portal/commit/9435af4ef8a90b5333da925a5ec860a43d18c031"}}