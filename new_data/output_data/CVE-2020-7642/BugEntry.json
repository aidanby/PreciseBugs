{"buggy_code": ["(function(window, factory) {\n\tif(!window) {return;}\n\tvar globalInstall = function(){\n\t\tfactory(window.lazySizes);\n\t\twindow.removeEventListener('lazyunveilread', globalInstall, true);\n\t};\n\n\tfactory = factory.bind(null, window, window.document);\n\n\tif(typeof module == 'object' && module.exports){\n\t\tfactory(require('lazysizes'));\n\t} else if(window.lazySizes) {\n\t\tglobalInstall();\n\t} else {\n\t\twindow.addEventListener('lazyunveilread', globalInstall, true);\n\t}\n}(typeof window != 'undefined' ?\n\twindow : 0, function(window, document, lazySizes) {\n\t/*jshint eqnull:true */\n\t'use strict';\n\tif(!document.getElementsByClassName){return;}\n\tvar protocol = location.protocol == 'https:' ?\n\t\t'https:' :\n\t\t'http:'\n\t;\n\tvar idIndex = Date.now();\n\tvar regId = /\\{\\{id}}/;\n\tvar regYtImg = /\\{\\{hqdefault}}/;\n\tvar regAmp = /^&/;\n\tvar youtubeImg = protocol + '//img.youtube.com/vi/{{id}}/{{hqdefault}}.jpg';\n\tvar youtubeIframe = protocol + '//www.youtube.com/embed/{{id}}?autoplay=1';\n\tvar vimeoApi = protocol + '//vimeo.com/api/oembed.json?url=https%3A//vimeo.com/{{id}}';\n\tvar vimeoIframe = protocol + '//player.vimeo.com/video/{{id}}?autoplay=1';\n\n\tfunction getJSON(url, callback){\n\t\tvar id = 'vimeoCallback' + idIndex;\n\t\tvar script = document.createElement('script');\n\t\turl += '&callback='+id;\n\n\t\tidIndex++;\n\n\t\twindow[id] = function(data){\n\t\t\tscript.parentNode.removeChild(script);\n\t\t\tdelete window[id];\n\t\t\tcallback(data);\n\t\t};\n\n\t\tscript.src = url;\n\n\t\tdocument.head.appendChild(script);\n\t}\n\n\tfunction embedVimeoImg(id, elem){\n\t\tgetJSON(vimeoApi.replace(regId, id), function(data){\n\t\t\tif(data && data.thumbnail_url){\n\t\t\t\telem.style.backgroundImage = 'url('+ data.thumbnail_url +')';\n\t\t\t}\n\t\t});\n\t\telem.addEventListener('click', embedVimeoIframe);\n\t}\n\n\tfunction embedVimeoIframe(e){\n\t\tvar elem = e.currentTarget;\n\t\tvar id = elem.getAttribute('data-vimeo');\n\t\tvar vimeoParams = elem.getAttribute('data-vimeoparams') || '';\n\n\t\tif(vimeoParams && !regAmp.test(vimeoParams)){\n\t\t\tvimeoParams = '&'+ vimeoParams;\n\t\t}\n\n\t\te.preventDefault();\n\n\t\telem.innerHTML = '<iframe src=\"' + (vimeoIframe.replace(regId, id)) + vimeoParams +'\" ' +\n\t\t\t'frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>'\n\t\t;\n\n\t\telem.removeEventListener('click', embedVimeoIframe);\n\t}\n\n\tfunction embedYoutubeImg(id, elem){\n\t\tvar ytImg = elem.getAttribute('data-thumb-size') || lazySizes.cfg.ytThumb || 'hqdefault';\n\n\t\telem.style.backgroundImage = 'url('+ youtubeImg.replace(regId, id).replace(regYtImg, ytImg) +')';\n\t\telem.addEventListener('click', embedYoutubeIframe);\n\t}\n\n\tfunction embedYoutubeIframe(e){\n\t\tvar elem = e.currentTarget;\n\t\tvar id = elem.getAttribute('data-youtube');\n\t\tvar youtubeParams = elem.getAttribute('data-ytparams') || '';\n\n\t\tif(youtubeParams && !regAmp.test(youtubeParams)){\n\t\t\tyoutubeParams = '&'+ youtubeParams;\n\t\t}\n\n\t\te.preventDefault();\n\n\t\telem.innerHTML = '<iframe src=\"' + (youtubeIframe.replace(regId, id)) + youtubeParams +'\" ' +\n\t\t\t'frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>'\n\t\t;\n\n\t\telem.removeEventListener('click', embedYoutubeIframe);\n\t}\n\n\tdocument.addEventListener('lazybeforeunveil', function(e){\n\t\tif(e.detail.instance != lazySizes){return;}\n\n\t\tvar elem = e.target;\n\t\tvar youtube = elem.getAttribute('data-youtube');\n\t\tvar vimeo = elem.getAttribute('data-vimeo');\n\n\t\tif(youtube && elem){\n\t\t\tembedYoutubeImg(youtube, elem);\n\t\t}\n\t\tif(vimeo && elem){\n\t\t\tembedVimeoImg(vimeo, elem);\n\t\t}\n\t});\n}));\n", "/*! lazysizes - v5.2.0 */\n!function(a,b){if(a){var c=function(){b(a.lazySizes),a.removeEventListener(\"lazyunveilread\",c,!0)};b=b.bind(null,a,a.document),\"object\"==typeof module&&module.exports?b(require(\"lazysizes\")):a.lazySizes?c():a.addEventListener(\"lazyunveilread\",c,!0)}}(\"undefined\"!=typeof window?window:0,function(a,b,c){\"use strict\";function d(c,d){var e=\"vimeoCallback\"+j,f=b.createElement(\"script\");c+=\"&callback=\"+e,j++,a[e]=function(b){f.parentNode.removeChild(f),delete a[e],d(b)},f.src=c,b.head.appendChild(f)}function e(a,b){d(p.replace(k,a),function(a){a&&a.thumbnail_url&&(b.style.backgroundImage=\"url(\"+a.thumbnail_url+\")\")}),b.addEventListener(\"click\",f)}function f(a){var b=a.currentTarget,c=b.getAttribute(\"data-vimeo\"),d=b.getAttribute(\"data-vimeoparams\")||\"\";d&&!m.test(d)&&(d=\"&\"+d),a.preventDefault(),b.innerHTML='<iframe src=\"'+q.replace(k,c)+d+'\" frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>',b.removeEventListener(\"click\",f)}function g(a,b){var d=b.getAttribute(\"data-thumb-size\")||c.cfg.ytThumb||\"hqdefault\";b.style.backgroundImage=\"url(\"+n.replace(k,a).replace(l,d)+\")\",b.addEventListener(\"click\",h)}function h(a){var b=a.currentTarget,c=b.getAttribute(\"data-youtube\"),d=b.getAttribute(\"data-ytparams\")||\"\";d&&!m.test(d)&&(d=\"&\"+d),a.preventDefault(),b.innerHTML='<iframe src=\"'+o.replace(k,c)+d+'\" frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>',b.removeEventListener(\"click\",h)}if(b.getElementsByClassName){var i=\"https:\"==location.protocol?\"https:\":\"http:\",j=Date.now(),k=/\\{\\{id}}/,l=/\\{\\{hqdefault}}/,m=/^&/,n=i+\"//img.youtube.com/vi/{{id}}/{{hqdefault}}.jpg\",o=i+\"//www.youtube.com/embed/{{id}}?autoplay=1\",p=i+\"//vimeo.com/api/oembed.json?url=https%3A//vimeo.com/{{id}}\",q=i+\"//player.vimeo.com/video/{{id}}?autoplay=1\";b.addEventListener(\"lazybeforeunveil\",function(a){if(a.detail.instance==c){var b=a.target,d=b.getAttribute(\"data-youtube\"),f=b.getAttribute(\"data-vimeo\");d&&b&&g(d,b),f&&b&&e(f,b)}})}});"], "fixing_code": ["(function(window, factory) {\n\tif(!window) {return;}\n\tvar globalInstall = function(){\n\t\tfactory(window.lazySizes);\n\t\twindow.removeEventListener('lazyunveilread', globalInstall, true);\n\t};\n\n\tfactory = factory.bind(null, window, window.document);\n\n\tif(typeof module == 'object' && module.exports){\n\t\tfactory(require('lazysizes'));\n\t} else if(window.lazySizes) {\n\t\tglobalInstall();\n\t} else {\n\t\twindow.addEventListener('lazyunveilread', globalInstall, true);\n\t}\n}(typeof window != 'undefined' ?\n\twindow : 0, function(window, document, lazySizes) {\n\t/*jshint eqnull:true */\n\t'use strict';\n\tif(!document.getElementsByClassName){return;}\n\tvar protocol = location.protocol == 'https:' ?\n\t\t'https:' :\n\t\t'http:'\n\t;\n\tvar idIndex = Date.now();\n\tvar regId = /\\{\\{id}}/;\n\tvar regYtImg = /\\{\\{hqdefault}}/;\n\tvar regAmp = /^&/;\n\tvar regValidParam = /^[a-z0-9-_&=]+$/i;\n\tvar youtubeImg = protocol + '//img.youtube.com/vi/{{id}}/{{hqdefault}}.jpg';\n\tvar youtubeIframe = protocol + '//www.youtube.com/embed/{{id}}?autoplay=1';\n\tvar vimeoApi = protocol + '//vimeo.com/api/oembed.json?url=https%3A//vimeo.com/{{id}}';\n\tvar vimeoIframe = protocol + '//player.vimeo.com/video/{{id}}?autoplay=1';\n\n\tfunction getJSON(url, callback){\n\t\tvar id = 'vimeoCallback' + idIndex;\n\t\tvar script = document.createElement('script');\n\t\turl += '&callback='+id;\n\n\t\tidIndex++;\n\n\t\twindow[id] = function(data){\n\t\t\tscript.parentNode.removeChild(script);\n\t\t\tdelete window[id];\n\t\t\tcallback(data);\n\t\t};\n\n\t\tscript.src = url;\n\n\t\tdocument.head.appendChild(script);\n\t}\n\n\tfunction embedVimeoImg(id, elem){\n\t\tgetJSON(vimeoApi.replace(regId, id), function(data){\n\t\t\tif(data && data.thumbnail_url){\n\t\t\t\telem.style.backgroundImage = 'url('+ data.thumbnail_url +')';\n\t\t\t}\n\t\t});\n\t\telem.addEventListener('click', embedVimeoIframe);\n\t}\n\n\tfunction embedVimeoIframe(e){\n\t\tvar elem = e.currentTarget;\n\t\tvar id = elem.getAttribute('data-vimeo');\n\t\tvar vimeoParams = elem.getAttribute('data-vimeoparams') || '';\n\n\t\telem.removeEventListener('click', embedVimeoIframe);\n\n\t\tif (!id || !regValidParam.test(id) || (vimeoParams && !regValidParam.test(vimeoParams))) {\n\t\t\treturn;\n\t\t}\n\n\t\tif(vimeoParams && !regAmp.test(vimeoParams)){\n\t\t\tvimeoParams = '&'+ vimeoParams;\n\t\t}\n\n\t\te.preventDefault();\n\n\t\telem.innerHTML = '<iframe src=\"' + (vimeoIframe.replace(regId, id)) + vimeoParams +'\" ' +\n\t\t\t'frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>'\n\t\t;\n\n\t}\n\n\tfunction embedYoutubeImg(id, elem){\n\t\tvar ytImg = elem.getAttribute('data-thumb-size') || lazySizes.cfg.ytThumb || 'hqdefault';\n\n\t\telem.style.backgroundImage = 'url('+ youtubeImg.replace(regId, id).replace(regYtImg, ytImg) +')';\n\t\telem.addEventListener('click', embedYoutubeIframe);\n\t}\n\n\tfunction embedYoutubeIframe(e){\n\t\tvar elem = e.currentTarget;\n\t\tvar id = elem.getAttribute('data-youtube');\n\t\tvar youtubeParams = elem.getAttribute('data-ytparams') || '';\n\n\t\telem.removeEventListener('click', embedYoutubeIframe);\n\n\t\tif (!id || !regValidParam.test(id) || (youtubeParams && !regValidParam.test(youtubeParams))) {\n\t\t\treturn;\n\t\t}\n\n\t\tif(youtubeParams && !regAmp.test(youtubeParams)){\n\t\t\tyoutubeParams = '&'+ youtubeParams;\n\t\t}\n\n\t\te.preventDefault();\n\n\t\telem.innerHTML = '<iframe src=\"' + (youtubeIframe.replace(regId, id)) + youtubeParams +'\" ' +\n\t\t\t'frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>'\n\t\t;\n\t}\n\n\tdocument.addEventListener('lazybeforeunveil', function(e){\n\t\tif(e.detail.instance != lazySizes){return;}\n\n\t\tvar elem = e.target;\n\t\tvar youtube = elem.getAttribute('data-youtube');\n\t\tvar vimeo = elem.getAttribute('data-vimeo');\n\n\t\tif(youtube && elem){\n\t\t\tembedYoutubeImg(youtube, elem);\n\t\t}\n\t\tif(vimeo && elem){\n\t\t\tembedVimeoImg(vimeo, elem);\n\t\t}\n\t});\n}));\n", "/*! lazysizes - v5.2.0 */\n!function(a,b){if(a){var c=function(){b(a.lazySizes),a.removeEventListener(\"lazyunveilread\",c,!0)};b=b.bind(null,a,a.document),\"object\"==typeof module&&module.exports?b(require(\"lazysizes\")):a.lazySizes?c():a.addEventListener(\"lazyunveilread\",c,!0)}}(\"undefined\"!=typeof window?window:0,function(a,b,c){\"use strict\";function d(c,d){var e=\"vimeoCallback\"+j,f=b.createElement(\"script\");c+=\"&callback=\"+e,j++,a[e]=function(b){f.parentNode.removeChild(f),delete a[e],d(b)},f.src=c,b.head.appendChild(f)}function e(a,b){d(q.replace(k,a),function(a){a&&a.thumbnail_url&&(b.style.backgroundImage=\"url(\"+a.thumbnail_url+\")\")}),b.addEventListener(\"click\",f)}function f(a){var b=a.currentTarget,c=b.getAttribute(\"data-vimeo\"),d=b.getAttribute(\"data-vimeoparams\")||\"\";b.removeEventListener(\"click\",f),c&&n.test(c)&&(!d||n.test(d))&&(d&&!m.test(d)&&(d=\"&\"+d),a.preventDefault(),b.innerHTML='<iframe src=\"'+r.replace(k,c)+d+'\" frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>')}function g(a,b){var d=b.getAttribute(\"data-thumb-size\")||c.cfg.ytThumb||\"hqdefault\";b.style.backgroundImage=\"url(\"+o.replace(k,a).replace(l,d)+\")\",b.addEventListener(\"click\",h)}function h(a){var b=a.currentTarget,c=b.getAttribute(\"data-youtube\"),d=b.getAttribute(\"data-ytparams\")||\"\";b.removeEventListener(\"click\",h),c&&n.test(c)&&(!d||n.test(d))&&(d&&!m.test(d)&&(d=\"&\"+d),a.preventDefault(),b.innerHTML='<iframe src=\"'+p.replace(k,c)+d+'\" frameborder=\"0\" allowfullscreen=\"\" width=\"640\" height=\"390\"></iframe>')}if(b.getElementsByClassName){var i=\"https:\"==location.protocol?\"https:\":\"http:\",j=Date.now(),k=/\\{\\{id}}/,l=/\\{\\{hqdefault}}/,m=/^&/,n=/^[a-z0-9-_&=]+$/i,o=i+\"//img.youtube.com/vi/{{id}}/{{hqdefault}}.jpg\",p=i+\"//www.youtube.com/embed/{{id}}?autoplay=1\",q=i+\"//vimeo.com/api/oembed.json?url=https%3A//vimeo.com/{{id}}\",r=i+\"//player.vimeo.com/video/{{id}}?autoplay=1\";b.addEventListener(\"lazybeforeunveil\",function(a){if(a.detail.instance==c){var b=a.target,d=b.getAttribute(\"data-youtube\"),f=b.getAttribute(\"data-vimeo\");d&&b&&g(d,b),f&&b&&e(f,b)}})}});"], "filenames": ["plugins/video-embed/ls.video-embed.js", "plugins/video-embed/ls.video-embed.min.js"], "buggy_code_start_loc": [29, 2], "buggy_code_end_loc": [103, 3], "fixing_code_start_loc": [30, 2], "fixing_code_end_loc": [112, 3], "type": "CWE-79", "message": "lazysizes through 5.2.0 allows execution of malicious JavaScript. The following attributes are not sanitized by the video-embed plugin: data-vimeo, data-vimeoparams, data-youtube and data-ytparams which can be abused to inject malicious JavaScript.", "other": {"cve": {"id": "CVE-2020-7642", "sourceIdentifier": "report@snyk.io", "published": "2020-04-22T16:15:13.077", "lastModified": "2020-05-01T12:58:20.700", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "lazysizes through 5.2.0 allows execution of malicious JavaScript. The following attributes are not sanitized by the video-embed plugin: data-vimeo, data-vimeoparams, data-youtube and data-ytparams which can be abused to inject malicious JavaScript."}, {"lang": "es", "value": "lazysizes versiones hasta la versi\u00f3n 5.2.0, permite una ejecuci\u00f3n de JavaScript malicioso. Los siguientes atributos no son saneados por el plugin video-embed: data-vimeo, data-vimeoparams, data-youtube y data-ytparams que pueden ser utilizados para inyectar JavaScript malicioso."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:lazysizes_project:lazysizes:*:*:*:*:*:*:*:*", "versionEndIncluding": "5.2.0", "matchCriteriaId": "41979441-60CB-49C7-BF87-D87FE02734EB"}]}]}], "references": [{"url": "https://github.com/aFarkas/lazysizes/commit/3720ab8262552d4e063a38d8492f9490a231fd48", "source": "report@snyk.io", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://snyk.io/vuln/SNYK-JS-LAZYSIZES-567144", "source": "report@snyk.io", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/aFarkas/lazysizes/commit/3720ab8262552d4e063a38d8492f9490a231fd48"}}