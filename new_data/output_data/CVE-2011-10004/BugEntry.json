{"buggy_code": ["function reciply() {\t\r\n\tvar reciplyURL = \"http://www.recip.ly\";\t\r\n\tif(choix_option==\"custom\") {\r\n\t\tif ((image_option == \"undefined\") || (image_option == \"\") || (image_option == \"false\")) \r\n\t\t{ \r\n\t\tcolor_option = \"red\";\r\n\t\timage_option=reciplyURL +\"/static/images/widget-add-\"+color_option+\".png\";\r\n\t\t}\r\n\t}\r\n\tif(choix_option==\"reciply\") {\r\n\t\t\t\t\t\tif((color_option==\"\") || (color_option==null)) color_option = \"red\";\r\n\t\t\t\t\t\timage_option=reciplyURL +\"/static/images/widget-add-\"+color_option+\".png\";\r\n\t\t\t\t\t\t}\r\n    return '<script src='+reciplyURL +'/static/js/jquery-reciply.js\" type=\"text/javascript\"></script><div class=\"reciply-addtobasket-widget\"><img src='+image_option+'\"></div>';\r\n}\r\n\r\n(function() {\r\n    tinymce.create('tinymce.plugins.reciply', {\r\n\r\n        init : function(ed, url){\r\n            ed.addButton('reciply', {\r\n                title : 'Insert Reciply Button',\r\n                onclick : function() {\r\n                    ed.execCommand(\r\n                        'mceInsertContent',\r\n                        false,\r\n                        reciply()\r\n                        );\r\n                },\r\n                image: url + \"/images/reciply.png\"\r\n            });\t\t\t\r\n        },\r\n\r\n        getInfo : function() {\r\n            return {\r\n                longname : 'Reciply plugin',\r\n                author : 'The Recip.ly Integration team',\r\n                authorurl : 'http://integration.recip.ly',\r\n                infourl : '',\r\n                version : \"1.1.7\"\r\n            };\r\n        }\r\n    });\r\n\r\n    tinymce.PluginManager.add('reciply', tinymce.plugins.reciply);\r\n    \r\n})();", "<?php\r\n/*\r\nPlugin Name: Recip.ly Plugin\r\nPlugin URI: \r\nDescription: The recip.ly plugin allows you to easily add the recip.ly checkout process to your recipes.\r\nAuthor: The Recip.ly Integration team\r\nVersion: 1.1.7\r\nAuthor URI: http://integration.recip.ly\r\n*/\r\n\r\nfunction reciply_addbuttons() \r\n{\r\nadd_filter('mce_external_plugins', \"reciply_register\");\r\nadd_filter('mce_buttons', 'reciply_add_button', 0);\r\nadd_filter( \"the_content\", \"url_post\" );\r\nadd_filter( \"the_content\", \"url_img\" );\r\n}\r\n\r\nfunction url_post($content) {\r\n$permalink = get_permalink();\r\n\r\n$post_url = '\r\n\t\t\t<div class=\"reciply-addtobasket-widget\" href=\"'.$permalink.'\">\r\n\t\t\t'; \t\r\nreturn str_replace('<div class=\"reciply-addtobasket-widget\">', $post_url, $content);\r\n}\r\n\r\nfunction url_img($content) {\r\n$img_url = '\r\n\t\t\t<img src=\"./wp-content/plugins/reciply/\r\n\t\t\t'; \t\r\nreturn str_replace('<img src=\"../wp-content/plugins/reciply/', $img_url, $content);\r\n}\r\n\r\nfunction reciply_add_button($buttons)\r\n{\r\n    array_push($buttons, \"separator\", \"reciply\");\r\n    return $buttons;\r\n}\r\n\r\nfunction reciply_register($plugin_array)\r\n{\r\n    $url = trim(get_bloginfo('url'), \"/\").\"/wp-content/plugins/reciply/editor_plugin.js\";\r\n    $plugin_array['reciply'] = $url;\r\n    return $plugin_array;\r\n}\r\n\r\nadd_action('init', 'reciply_addbuttons');\r\n\r\n// create custom plugin settings menu\r\nadd_action('admin_menu', 'reciply_create_menu');\r\n\r\nfunction reciply_create_menu() {\r\n\r\n\t//create new top-level menu\r\n\tadd_menu_page('Recip.ly Plugin Settings', 'Recip.ly Settings', 'administrator', __FILE__, 'reciply_settings_page',plugins_url('images/icon.png', __FILE__));\r\n\r\n\t//call register settings function\r\n\tadd_action( 'admin_init', 'register_mysettings' );\r\n}\r\n\r\nfunction register_mysettings() {\r\n\t//register our settings\r\n\tregister_setting( 'reciply-settings-group', 'color' );\r\n\tregister_setting( 'reciply-settings-group', 'image' );\r\n\tregister_setting( 'reciply-settings-group', 'choix' );\t\r\n\tregister_setting( 'reciply-settings-group', 'fichier' );\t\r\n}\r\n\r\nfunction reciply_settings_page() {\r\n?>\r\n<script type=\"text/javascript\">\r\nfunction valider() {\r\n// for save button\r\nvar b = false;\r\nvar picture = \"<?php echo $_GET['img'] ?>\";\r\nvar choice = document.getElementById(\"custom\").checked;\r\nif (choice==true){\r\n\tif (picture == \"\"){ \r\n\t\t\t\t\t\talert(\"You must Upload a selected image\");\r\n\t\t\t\t\t\t}\r\n\telse { \r\n\t\tb = true;\r\n\t\t}\r\n\t}\r\nelse { \r\n\tb = true;\r\n\t}\r\nreturn b;\r\n}\r\n\r\n//<![CDATA[\r\nonload=function stateColor(){\r\nvar choix_option= \"<?php if ($_GET['img']!=\"\") echo \"custom\"; \r\n\t\t\t\t\t\telse \r\n\t\t\t\t\t\t\techo get_option('choix'); ?>\";\r\n\r\nif (choix_option==\"reciply\") {\r\n\tdocument.getElementById(\"reciply\").checked = true;\r\n\tdocument.getElementById(\"color\").disabled = false;\r\n\tdocument.getElementById(\"custom\").checked = false;\r\n\tdocument.optionform.image.disabled = true;\r\n\tdocument.optionform.upload.disabled = true;\r\n\tdocument.getElementById(\"upload\").disabled = true;\r\n\tvar color_option= \"<?php echo get_option('color'); ?>\";\r\n\tfor(i = 0;i < document.getElementById(\"color\").options.length;i++) {\r\n    if(document.getElementById(\"color\").options[i].value == color_option){\r\n\t\tdocument.getElementById(\"color\").options[i].selected = \"selected\";\r\n\t\tbreak;\r\n\t\t}\r\n\t}\t\r\n}\r\nif (choix_option==\"custom\") {\r\n\tdocument.getElementById(\"custom\").checked = true;\r\n\tdocument.getElementById(\"reciply\").checked = false;\t\r\n\tdocument.getElementById(\"color\").disabled = true;\r\n\tdocument.getElementById(\"upload\").disabled = false;\r\n\t}\r\n}\r\n//]]>\r\n\r\nfunction activer(i) {\r\nif (i==0) { \r\n\tdocument.getElementById(\"color\").disabled = false;\r\n\tdocument.optionform.image.disabled = true;\r\n\tdocument.optionform.upload.disabled = true;\r\n\tdocument.getElementById(\"upload\").disabled = true;\r\n\t}\r\nif (i==1) { \r\n\tdocument.optionform.image.disabled = false;\r\n\tdocument.optionform.upload.disabled = false;\r\n\tdocument.getElementById(\"upload\").disabled = false;\r\n\tdocument.getElementById(\"color\").disabled = true;\r\n\t}\r\n}\r\n\r\n</script>\r\n<div class=\"wrap\">\r\n<h2>Recip.ly Plugin</h2>\r\n<form name=\"optionform\" enctype=\"multipart/form-data\" method=\"post\" action=\"options.php\" />\r\n    <?php settings_fields('reciply-settings-group'); ?>\r\n    <table class=\"form-table\">\r\n        <tr valign=\"top\">\r\n        <th scope=\"row\"><input type=\"radio\" name=\"choix\" id=\"reciply\" value=\"reciply\" onclick=\"javascript:activer(0);\" /><b>Recip.ly Button :</b></th>\r\n        </tr>\t\r\n        <tr valign=\"top\">\r\n        <th scope=\"row\">Color</th>\r\n        <td>\r\n\t\t<SELECT NAME=\"color\" id=\"color\">\r\n\t\t<option value=\"orange\">Orange</option>\r\n\t\t<option value=\"red\">Red</option>\r\n\t\t<option value=\"green\">Green</option>\r\n\t\t</SELECT>\r\n\t\t</td>\r\n        </tr> \r\n        <tr valign=\"top\">\r\n        <th scope=\"row\"><input type=\"radio\" name=\"choix\" id=\"custom\" value=\"custom\" onclick=\"javascript:activer(1);\" /><b>Custom Image Button :</b></th>\r\n        </tr>\t\t\r\n        <tr valign=\"top\">\t\r\n         <th scope=\"row\">Image</th>\r\n        <td>\r\n\t\t<label name=\"l\"><?php echo get_option('fichier'); ?></label><br/>\r\n\t\t<input name=\"image\" type=\"file\" id=\"image\" value=\"<?php echo get_option('image'); ?>\" /><br>\r\n\t\t<input id=\"upload\" name=\"upload\" type=\"submit\" value=\"Upload\" onclick=\"optionform.action='../wp-content/plugins/reciply/uploadImage.php'; return true;\"/>\r\n\t\t</td>\r\n        </tr>\r\n        </tr>\t\t\r\n    </table>    \r\n    <p class=\"submit\">\r\n    <input type=\"submit\" name=\"save\" id=\"save\" class=\"button-primary\" value=\"<?php _e('Save Changes') ?>\" onclick=\"javascript:valider();\"/>\r\n    </p>\r\n</form>\r\n</div>\r\n<?php }\r\nadd_action('wp_print_scripts','myscript');\r\nif(($_GET['img'])!=\"\")\r\n\t{\r\n\t$image_selected = '../wp-content/plugins/reciply/'.$_GET['img']; \t\r\n\tupdate_option('image',$image_selected);\t\t\r\n\t}\r\nif(($_GET['f'])!=\"\")\r\n\t{\r\n\t$fichier = $_GET['f']; \r\n\tupdate_option('fichier',$fichier);\r\n\t}\t\r\nfunction myscript() {\r\n?>\r\n<script type=\"text/javascript\">\r\nvar image_option= <?php echo json_encode(get_option('image')); ?>;\r\nvar color_option= <?php echo json_encode(get_option('color')); ?>;\r\nvar choix_option= <?php echo json_encode(get_option('choix')); ?>;\r\n</script>\r\n<?php\r\n}\r\nwp_enqueue_script('myscript','/wp-content/plugins/reciply/editor_plugin.js','');\r\n?>", "<?php\r\n\r\n// File version 1.1.7\r\n$ref = $_SERVER['HTTP_REFERER'];\r\n\r\n// Taille maximum \r\n$MAX_FILE_SIZE = 400000;\r\n\r\n// Dossier de destination du fichier\r\n$serverpath = \"images/\";// Path to where images should be uploaded to on the server.\r\n\r\nforeach ($_FILES as $file) {\r\n$allowed_types = array(\"image/bmp\", \"image/gif\", \"image/pjpeg\", \"image/jpeg\", \"image/jpg\", \"image/png\");\r\n$fname = $file['name'];\r\n$ftype = $file['type'];\r\n$fsize = $file['size'];\r\n$ftmp =$file['tmp_name'];\r\n$path = \"$serverpath$fname\";\r\n}\r\n\r\n// Diverses test afin de savoir si :\r\n// Le format de fichier correspond \u0105 notre tableau array\r\nif(!in_array($ftype, $allowed_types)){$error = 1;}\r\n\r\n// La taille du fichier n'est pas d\u00e9pass\u00e9e\r\nif($fize > $MAX_FILE_SIZE){$error = 2;}\r\n\r\n// Le fichier n'existe pas d\u00e9j\u0105\r\nif(file_exists($serverpath.\"m_\".$fname)){$error = 3;}\r\n\r\n// Si tout va bien, c'est bien d\u00e9roul\u00e9\r\nif(move_uploaded_file($ftmp,''.$serverpath.''.$fname.'')) {$error = 0;}\r\n\r\nif($fname!=\"\") {\r\n\t\t\t\theader('refresh: 0; url='.$ref.'&img='.$path.'&f='.$fname.'&target=\"_blank\"');\r\n\t\t\t\t}\r\nelse {\r\n\t\theader('refresh: 0; url='.$ref);\r\n\t}\r\n\r\n?>"], "fixing_code": ["function reciply() {\t\r\n\tvar reciplyURL = \"http://www.recip.ly\";\t\r\n\tif(choix_option==\"custom\") {\r\n\t\tif ((image_option == \"undefined\") || (image_option == \"\") || (image_option == \"false\")) \r\n\t\t{ \r\n\t\tcolor_option = \"red\";\r\n\t\timage_option=reciplyURL +\"/static/images/widget-add-\"+color_option+\".png\";\r\n\t\t}\r\n\t}\r\n\tif(choix_option==\"reciply\") {\r\n\t\t\t\t\t\tif((color_option==\"\") || (color_option==null)) color_option = \"red\";\r\n\t\t\t\t\t\timage_option=reciplyURL +\"/static/images/widget-add-\"+color_option+\".png\";\r\n\t\t\t\t\t\t}\r\n    return '<script src='+reciplyURL +'/static/js/jquery-reciply.js\" type=\"text/javascript\"></script><div class=\"reciply-addtobasket-widget\"><img src='+image_option+'\"></div>';\r\n}\r\n\r\n(function() {\r\n    tinymce.create('tinymce.plugins.reciply', {\r\n\r\n        init : function(ed, url){\r\n            ed.addButton('reciply', {\r\n                title : 'Insert Reciply Button',\r\n                onclick : function() {\r\n                    ed.execCommand(\r\n                        'mceInsertContent',\r\n                        false,\r\n                        reciply()\r\n                        );\r\n                },\r\n                image: url + \"/images/reciply.png\"\r\n            });\t\t\t\r\n        },\r\n\r\n        getInfo : function() {\r\n            return {\r\n                longname : 'Reciply plugin',\r\n                author : 'The Recip.ly Integration team',\r\n                authorurl : 'http://integration.recip.ly',\r\n                infourl : '',\r\n                version : \"1.1.8\"\r\n            };\r\n        }\r\n    });\r\n\r\n    tinymce.PluginManager.add('reciply', tinymce.plugins.reciply);\r\n    \r\n})();", "<?php\r\n/*\r\nPlugin Name: Recip.ly Plugin\r\nPlugin URI: \r\nDescription: The recip.ly plugin allows you to easily add the recip.ly checkout process to your recipes.\r\nAuthor: The Recip.ly Integration team\r\nVersion: 1.1.8\r\nAuthor URI: http://integration.recip.ly\r\n*/\r\n\r\nfunction reciply_addbuttons() \r\n{\r\nadd_filter('mce_external_plugins', \"reciply_register\");\r\nadd_filter('mce_buttons', 'reciply_add_button', 0);\r\nadd_filter( \"the_content\", \"url_post\" );\r\nadd_filter( \"the_content\", \"url_img\" );\r\n}\r\n\r\nfunction url_post($content) {\r\n$permalink = get_permalink();\r\n\r\n$post_url = '\r\n\t\t\t<div class=\"reciply-addtobasket-widget\" href=\"'.$permalink.'\">\r\n\t\t\t'; \t\r\nreturn str_replace('<div class=\"reciply-addtobasket-widget\">', $post_url, $content);\r\n}\r\n\r\nfunction url_img($content) {\r\n$img_url = '\r\n\t\t\t<img src=\"./wp-content/plugins/reciply/\r\n\t\t\t'; \t\r\nreturn str_replace('<img src=\"../wp-content/plugins/reciply/', $img_url, $content);\r\n}\r\n\r\nfunction reciply_add_button($buttons)\r\n{\r\n    array_push($buttons, \"separator\", \"reciply\");\r\n    return $buttons;\r\n}\r\n\r\nfunction reciply_register($plugin_array)\r\n{\r\n    $url = trim(get_bloginfo('url'), \"/\").\"/wp-content/plugins/reciply/editor_plugin.js\";\r\n    $plugin_array['reciply'] = $url;\r\n    return $plugin_array;\r\n}\r\n\r\nadd_action('init', 'reciply_addbuttons');\r\n\r\n// create custom plugin settings menu\r\nadd_action('admin_menu', 'reciply_create_menu');\r\n\r\nfunction reciply_create_menu() {\r\n\r\n\t//create new top-level menu\r\n\tadd_menu_page('Recip.ly Plugin Settings', 'Recip.ly Settings', 'administrator', __FILE__, 'reciply_settings_page',plugins_url('images/icon.png', __FILE__));\r\n\r\n\t//call register settings function\r\n\tadd_action( 'admin_init', 'register_mysettings' );\r\n}\r\n\r\nfunction register_mysettings() {\r\n\t//register our settings\r\n\tregister_setting( 'reciply-settings-group', 'color' );\r\n\tregister_setting( 'reciply-settings-group', 'image' );\r\n\tregister_setting( 'reciply-settings-group', 'choix' );\t\r\n\tregister_setting( 'reciply-settings-group', 'fichier' );\t\r\n}\r\n\r\nfunction reciply_settings_page() {\r\n?>\r\n<script type=\"text/javascript\">\r\nfunction valider() {\r\n// for save button\r\nvar b = false;\r\nvar picture = \"<?php echo $_GET['img'] ?>\";\r\nvar choice = document.getElementById(\"custom\").checked;\r\nif (choice==true){\r\n\tif (picture == \"\"){ \r\n\t\t\t\t\t\talert(\"You must Upload a selected image\");\r\n\t\t\t\t\t\t}\r\n\telse { \r\n\t\tb = true;\r\n\t\t}\r\n\t}\r\nelse { \r\n\tb = true;\r\n\t}\r\nreturn b;\r\n}\r\n\r\n//<![CDATA[\r\nonload=function stateColor(){\r\nvar choix_option= \"<?php if ($_GET['img']!=\"\") echo \"custom\"; \r\n\t\t\t\t\t\telse \r\n\t\t\t\t\t\t\techo get_option('choix'); ?>\";\r\n\r\nif (choix_option==\"reciply\") {\r\n\tdocument.getElementById(\"reciply\").checked = true;\r\n\tdocument.getElementById(\"color\").disabled = false;\r\n\tdocument.getElementById(\"custom\").checked = false;\r\n\tdocument.optionform.image.disabled = true;\r\n\tdocument.optionform.upload.disabled = true;\r\n\tdocument.getElementById(\"upload\").disabled = true;\r\n\tvar color_option= \"<?php echo get_option('color'); ?>\";\r\n\tfor(i = 0;i < document.getElementById(\"color\").options.length;i++) {\r\n    if(document.getElementById(\"color\").options[i].value == color_option){\r\n\t\tdocument.getElementById(\"color\").options[i].selected = \"selected\";\r\n\t\tbreak;\r\n\t\t}\r\n\t}\t\r\n}\r\nif (choix_option==\"custom\") {\r\n\tdocument.getElementById(\"custom\").checked = true;\r\n\tdocument.getElementById(\"reciply\").checked = false;\t\r\n\tdocument.getElementById(\"color\").disabled = true;\r\n\tdocument.getElementById(\"upload\").disabled = false;\r\n\t}\r\n}\r\n//]]>\r\n\r\nfunction activer(i) {\r\nif (i==0) { \r\n\tdocument.getElementById(\"color\").disabled = false;\r\n\tdocument.optionform.image.disabled = true;\r\n\tdocument.optionform.upload.disabled = true;\r\n\tdocument.getElementById(\"upload\").disabled = true;\r\n\t}\r\nif (i==1) { \r\n\tdocument.optionform.image.disabled = false;\r\n\tdocument.optionform.upload.disabled = false;\r\n\tdocument.getElementById(\"upload\").disabled = false;\r\n\tdocument.getElementById(\"color\").disabled = true;\r\n\t}\r\n}\r\n\r\n</script>\r\n<div class=\"wrap\">\r\n<h2>Recip.ly Plugin</h2>\r\n<form name=\"optionform\" enctype=\"multipart/form-data\" method=\"post\" action=\"options.php\" />\r\n    <?php settings_fields('reciply-settings-group'); ?>\r\n    <table class=\"form-table\">\r\n        <tr valign=\"top\">\r\n        <th scope=\"row\"><input type=\"radio\" name=\"choix\" id=\"reciply\" value=\"reciply\" onclick=\"javascript:activer(0);\" /><b>Recip.ly Button :</b></th>\r\n        </tr>\t\r\n        <tr valign=\"top\">\r\n        <th scope=\"row\">Color</th>\r\n        <td>\r\n\t\t<SELECT NAME=\"color\" id=\"color\">\r\n\t\t<option value=\"orange\">Orange</option>\r\n\t\t<option value=\"red\">Red</option>\r\n\t\t<option value=\"green\">Green</option>\r\n\t\t</SELECT>\r\n\t\t</td>\r\n        </tr> \r\n        <tr valign=\"top\">\r\n        <th scope=\"row\"><input type=\"radio\" name=\"choix\" id=\"custom\" value=\"custom\" onclick=\"javascript:activer(1);\" /><b>Custom Image Button :</b></th>\r\n        </tr>\t\t\r\n        <tr valign=\"top\">\t\r\n         <th scope=\"row\">Image</th>\r\n        <td>\r\n\t\t<label name=\"l\"><?php echo get_option('fichier'); ?></label><br/>\r\n\t\t<input name=\"image\" type=\"file\" id=\"image\" value=\"<?php echo get_option('image'); ?>\" /><br>\r\n\t\t<input id=\"upload\" name=\"upload\" type=\"submit\" value=\"Upload\" onclick=\"optionform.action='../wp-content/plugins/reciply/uploadImage.php'; return true;\"/>\r\n\t\t</td>\r\n        </tr>\r\n        </tr>\t\t\r\n    </table>    \r\n    <p class=\"submit\">\r\n    <input type=\"submit\" name=\"save\" id=\"save\" class=\"button-primary\" value=\"<?php _e('Save Changes') ?>\" onclick=\"javascript:valider();\"/>\r\n    </p>\r\n</form>\r\n</div>\r\n<?php }\r\nadd_action('wp_print_scripts','myscript');\r\nif(($_GET['img'])!=\"\")\r\n\t{\r\n\t$image_selected = '../wp-content/plugins/reciply/'.$_GET['img']; \t\r\n\tupdate_option('image',$image_selected);\t\t\r\n\t}\r\nif(($_GET['f'])!=\"\")\r\n\t{\r\n\t$fichier = $_GET['f']; \r\n\tupdate_option('fichier',$fichier);\r\n\t}\t\r\nfunction myscript() {\r\n?>\r\n<script type=\"text/javascript\">\r\nvar image_option= <?php echo json_encode(get_option('image')); ?>;\r\nvar color_option= <?php echo json_encode(get_option('color')); ?>;\r\nvar choix_option= <?php echo json_encode(get_option('choix')); ?>;\r\n</script>\r\n<?php\r\n}\r\nwp_enqueue_script('myscript','/wp-content/plugins/reciply/editor_plugin.js','');\r\n?>", "<?php\r\n//add_action('plugins_loaded','pluginInit');\r\n\r\nif ( !function_exists( 'add_action' ) ) {\r\n\techo \"<strong>404.1 Error</strong>\";\r\n\texit;\r\n}\r\npluginInit();\r\nfunction pluginInit()\r\n{\r\n\t// File version 1.1.7\r\n\t$ref = $_SERVER['HTTP_REFERER'];\r\n\t\r\n\t// Taille maximum \r\n\t$MAX_FILE_SIZE = 400000;\r\n\t$error = 0;\r\n\t\r\n\t// Dossier de destination du fichier\r\n\t$serverpath = ABSPATH . 'wp-content/plugins/reciply/images/';\r\n\t//$serverpath = \"images/\";// Path to where images should be uploaded to on the server.\r\n\t\r\n\tforeach ($_FILES as $file) {\r\n\t$allowed_types = array(\"image/bmp\", \"image/gif\", \"image/pjpeg\", \"image/jpeg\", \"image/jpg\", \"image/png\");\r\n\t$fname = $file['name'];\r\n\t$ftype = $file['type'];\r\n\t$fsize = $file['size'];\r\n\t$ftmp =$file['tmp_name'];\r\n\t$path = \"$serverpath$fname\";\r\n\t}\r\n\t\r\n\t// Diverses test afin de savoir si :\r\n\t// Le format de fichier correspond \u0105 notre tableau array\r\n\tif(!in_array($ftype, $allowed_types)){$error = 1;}\r\n\t\r\n\t// La taille du fichier n'est pas d\u00e9pass\u00e9e\r\n\tif($fize > $MAX_FILE_SIZE){$error = 2;}\r\n\t\r\n\t\r\n\t// Le fichier n'existe pas d\u00e9j\u0105\r\n\tif(file_exists($serverpath.\"m_\".$fname)){$error = 3;}\r\n\tif ( $error != 0 ) {\r\n\t\techo \"<strong>404.2 Error Code = \".$error.\"</strong>\";\r\n\t\texit(0);\r\n\t}\r\n\t\r\n\t\r\n\t// Si tout va bien, c'est bien d\u00e9roul\u00e9\r\n\tif(move_uploaded_file($ftmp,''.$serverpath.''.$fname.'')) {$error = 4;}\r\n\t\r\n\tif($fname!=\"\") {\r\n\t\t\t\t\theader('refresh: 0; url='.$ref.'&img='.$path.'&f='.$fname.'&target=\"_blank\"');\r\n\t\t\t\t\t}\r\n\telse {\r\n\t\t\theader('refresh: 0; url='.$ref);\r\n\t\t}\r\n}\r\n\r\n?>"], "filenames": ["editor_plugin.js", "index.php", "uploadImage.php"], "buggy_code_start_loc": [40, 7, 1], "buggy_code_end_loc": [41, 8, 41], "fixing_code_start_loc": [40, 7, 2], "fixing_code_end_loc": [41, 8, 57], "type": "CWE-434", "message": "A vulnerability was found in reciply Plugin up to 1.1.7 on WordPress. It has been rated as critical. This issue affects some unknown processing of the file uploadImage.php. The manipulation leads to unrestricted upload. The attack may be initiated remotely. Upgrading to version 1.1.8 is able to address this issue. The identifier of the patch is e3ff616dc08d3aadff9253f1085e13f677d0c676. It is recommended to upgrade the affected component. The identifier VDB-242189 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2011-10004", "sourceIdentifier": "cna@vuldb.com", "published": "2023-10-17T00:15:10.500", "lastModified": "2024-02-29T01:11:40.540", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "A vulnerability was found in reciply Plugin up to 1.1.7 on WordPress. It has been rated as critical. This issue affects some unknown processing of the file uploadImage.php. The manipulation leads to unrestricted upload. The attack may be initiated remotely. Upgrading to version 1.1.8 is able to address this issue. The identifier of the patch is e3ff616dc08d3aadff9253f1085e13f677d0c676. It is recommended to upgrade the affected component. The identifier VDB-242189 was assigned to this vulnerability."}, {"lang": "es", "value": "Se encontr\u00f3 una vulnerabilidad en reciply Plugin en WordPress  hasta 1.1.7. Ha sido calificada como cr\u00edtica. Este problema afecta un procesamiento desconocido del archivo uploadImage.php. La manipulaci\u00f3n conduce a una carga sin restricciones. El ataque puede iniciarse de forma remota. La actualizaci\u00f3n a la versi\u00f3n 1.1.8 puede solucionar este problema. El identificador del parche es e3ff616dc08d3aadff9253f1085e13f677d0c676. Se recomienda actualizar el componente afectado. A esta vulnerabilidad se le asign\u00f3 el identificador VDB-242189."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-434"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:reciply_project:reciply:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "1.1.8", "matchCriteriaId": "83349496-D86A-43A2-9BFF-EE1395007AA0"}]}]}], "references": [{"url": "https://github.com/wp-plugins/reciply/commit/e3ff616dc08d3aadff9253f1085e13f677d0c676", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.242189", "source": "cna@vuldb.com", "tags": ["Permissions Required"]}, {"url": "https://vuldb.com/?id.242189", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/wp-plugins/reciply/commit/e3ff616dc08d3aadff9253f1085e13f677d0c676"}}