{"buggy_code": ["# This is an action to close asana tasks that were generated by Github issues\n\nname: Zapier web hook\n\n# Controls when the workflow will run\non:\n  # Triggers the workflow on push or pull request events but only for the \"main\" branch\n  issues:\n    types: [closed]\n\n# A workflow run is made up of one or more jobs that can run sequentially or in parallel\njobs:\n  # This workflow contains a single job called \"build\"\n  build:\n    # The type of runner that the job will run on\n    runs-on: ubuntu-latest\n\n    # Steps represent a sequence of tasks that will be executed as part of the job\n    steps:\n      # Runs a set of commands using the runners shell\n      - name: Call Zapier web hook to close Asana task\n        if: ${{ !github.event.issue.pull_request }}\n        run: |\n          curl --location --request POST 'https://hooks.zapier.com/hooks/catch/12728683/b7009qc/' \\\n          --header 'Content-Type: application/json' \\\n          --header 'Accept: application/json' \\\n          --data-raw '{\n            \"task_name\" : \"${{ github.event.issue.title }}\"\n          }'\n"], "fixing_code": ["# This is an action to close asana tasks that were generated by Github issues\n\nname: Zapier web hook\n\n# Controls when the workflow will run\non:\n  # Triggers the workflow on push or pull request events but only for the \"main\" branch\n  issues:\n    types: [closed]\n    \npermissions:\n  issues: read\n\n# A workflow run is made up of one or more jobs that can run sequentially or in parallel\njobs:\n  # This workflow contains a single job called \"build\"\n  build:\n    # The type of runner that the job will run on\n    runs-on: ubuntu-latest\n\n    # Steps represent a sequence of tasks that will be executed as part of the job\n    steps:\n      # Runs a set of commands using the runners shell\n      - name: Call Zapier web hook to close Asana task\n        if: ${{ !github.event.issue.pull_request }}\n        env:\n          ISSUE_TITLE: ${{ github.event.issue.title }}\n        run: |\n          curl --location --request POST 'https://hooks.zapier.com/hooks/catch/12728683/b7009qc/' \\\n          --header 'Content-Type: application/json' \\\n          --header 'Accept: application/json' \\\n          --data-raw '{\n            \"task_name\" : \"$ISSUE_TITLE\"\n          }'\n"], "filenames": [".github/workflows/Zapier.yml"], "buggy_code_start_loc": [9], "buggy_code_end_loc": [29], "fixing_code_start_loc": [10], "fixing_code_end_loc": [34], "type": "CWE-77", "message": "OneSignal is an email, sms, push notification, and in-app message service for mobile apps.The Zapier.yml workflow is triggered on issues (types: [closed]) (i.e., when an Issue is closed). The workflow starts with full write-permissions GitHub repository token since the default workflow permissions on Organization/Repository level are set to read-write. This workflow runs the following step with data controlled by the comment `(${{ github.event.issue.title }} \u2013 the full title of the Issue)`, allowing an attacker to take over the GitHub Runner and run custom commands, potentially stealing any secret (if used), or altering the repository. This issue was found with CodeQL using javascript\u2019s Expression injection in Actions query. This issue has been addressed in the repositories github action. No actions are required by users. This issue is also tracked as `GHSL-2023-051`.", "other": {"cve": {"id": "CVE-2023-28430", "sourceIdentifier": "security-advisories@github.com", "published": "2023-03-27T22:15:22.130", "lastModified": "2023-04-03T18:38:13.673", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "OneSignal is an email, sms, push notification, and in-app message service for mobile apps.The Zapier.yml workflow is triggered on issues (types: [closed]) (i.e., when an Issue is closed). The workflow starts with full write-permissions GitHub repository token since the default workflow permissions on Organization/Repository level are set to read-write. This workflow runs the following step with data controlled by the comment `(${{ github.event.issue.title }} \u2013 the full title of the Issue)`, allowing an attacker to take over the GitHub Runner and run custom commands, potentially stealing any secret (if used), or altering the repository. This issue was found with CodeQL using javascript\u2019s Expression injection in Actions query. This issue has been addressed in the repositories github action. No actions are required by users. This issue is also tracked as `GHSL-2023-051`."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.1, "impactScore": 5.2}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-77"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:onesignal:react-native-onesignal:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.5.1", "matchCriteriaId": "78D30C1F-E0B0-48A2-8436-AA54D28A3830"}]}]}], "references": [{"url": "https://github.com/OneSignal/react-native-onesignal/commit/4a66f4237fb51dcc2236889038d488cd49b0f433", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/OneSignal/react-native-onesignal/commit/4e43bda4ce1eb395f36bb8a5640002523c051085", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://securitylab.github.com/advisories/GHSL-2023-051_React_Native_OneSignal_SDK/", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/OneSignal/react-native-onesignal/commit/4a66f4237fb51dcc2236889038d488cd49b0f433"}}