{"buggy_code": ["<?php\n/* Copyright (C) 2016-2018\tLaurent Destailleur\t\t<eldy@users.sourceforge.net>\n *\n * This program is free software; you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation; either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see <https://www.gnu.org/licenses/>.\n */\n\n/**\n *\t\\file       htdocs/public/notice.php\n *\t\\brief      Dolibarr page to show a notice.\n *              Default notice is a message to say network connection is off.\n *              You can also call this page with URL:\n *                /public/notice.php?lang=xx_XX&transkey=translation_key  (key must be inside file main.lang, error.lang or other.lang)\n *                /public/notice.php?transphrase=url_encoded_sentence_to_show\n */\n\ndefine('NOCSRFCHECK', 1);\ndefine('NOLOGIN', 1);\n\nrequire '../main.inc.php';\n\n\n/**\n * View\n */\n\nif (! GETPOST('transkey', 'alphanohtml') && ! GETPOST('transphrase', 'alphanohtml'))\n{\n    print 'Sorry, it seems your internet connexion is off.<br>';\n    print 'You need to be connected to network to use this software.<br>';\n}\nelse\n{\n    $langs->load(\"error\");\n    $langs->load(\"other\");\n\n    if (GETPOST('transphrase', 'alphanohtml')) print GETPOST('transphrase', 'alphanohtml');\n    if (GETPOST('transkey', 'alphanohtml')) print $langs->trans(GETPOST('transkey', 'alphanohtml'));\n}\n"], "fixing_code": ["<?php\n/* Copyright (C) 2016-2018\tLaurent Destailleur\t\t<eldy@users.sourceforge.net>\n *\n * This program is free software; you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation; either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program. If not, see <https://www.gnu.org/licenses/>.\n */\n\n/**\n *\t\\file       htdocs/public/notice.php\n *\t\\brief      Dolibarr page to show a notice.\n *              Default notice is a message to say network connection is off.\n *              You can also call this page with URL:\n *                /public/notice.php?lang=xx_XX&transkey=translation_key  (key must be inside file main.lang, error.lang or other.lang)\n *                /public/notice.php?transphrase=url_encoded_sentence_to_show\n */\n\ndefine('NOCSRFCHECK', 1);\ndefine('NOLOGIN', 1);\n\nrequire '../main.inc.php';\n\n\n/**\n * View\n */\n\nif (! GETPOST('transkey', 'alphanohtml') && ! GETPOST('transphrase', 'alphanohtml'))\n{\n    print 'Sorry, it seems your internet connexion is off.<br>';\n    print 'You need to be connected to network to use this software.<br>';\n}\nelse\n{\n    $langs->loadLangs(array(\"error\", \"other\"));\n\n    if (GETPOST('transphrase', 'alphanohtml')) print dol_escape_htmltag(GETPOST('transphrase', 'alphanohtml'));\n    elseif (GETPOST('transkey', 'alphanohtml')) print dol_escape_htmltag($langs->trans(GETPOST('transkey', 'alphanohtml')));\n}\n"], "filenames": ["htdocs/public/notice.php"], "buggy_code_start_loc": [44], "buggy_code_end_loc": [49], "fixing_code_start_loc": [44], "fixing_code_end_loc": [48], "type": "CWE-79", "message": "A reflected cross-site scripting (XSS) vulnerability in Dolibarr 11.0.3 allows remote attackers to inject arbitrary web script or HTML into public/notice.php (related to transphrase and transkey).", "other": {"cve": {"id": "CVE-2020-14475", "sourceIdentifier": "cve@mitre.org", "published": "2020-06-19T17:15:14.223", "lastModified": "2022-11-17T17:21:59.260", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A reflected cross-site scripting (XSS) vulnerability in Dolibarr 11.0.3 allows remote attackers to inject arbitrary web script or HTML into public/notice.php (related to transphrase and transkey)."}, {"lang": "es", "value": "Una vulnerabilidad de tipo cross-site scripting (XSS) reflejado en Dolibarr versi\u00f3n 11.0.3, permite a atacantes remotos inyectar script web o HTML arbitrario en el archivo public/notice.php (relacionado con transphrase y transkey)"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:dolibarr:dolibarr_erp\\/crm:11.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "FB4862AA-5FF4-463E-A783-E52ADE633926"}]}]}], "references": [{"url": "https://github.com/Dolibarr/dolibarr/commit/22ca5e067189bffe8066df26df923a386f044c08", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/Dolibarr/dolibarr/commit/22ca5e067189bffe8066df26df923a386f044c08"}}