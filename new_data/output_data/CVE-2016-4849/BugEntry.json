{"buggy_code": ["{# begin {templatelocation} #}\n\n    <ul class=\"uk-subnav uk-flex-right uk-margin-remove\">\n      <li><g:plusone href=\"{site_url}/article.php/{story_id}\"></g:plusone></li>\n      <li><a class=\"twitter-share-button\" data-url=\"<?php echo COM_getCurrentURL(); ?>\" href=\"https://twitter.com/intent/tweet?text={story_title}\" data-lang=\"ja\">Tweet</a></li>\n      <li><iframe src=\"//www.facebook.com/plugins/like.php?href=<?php echo urlencode(COM_getCurrentURL()); ?>&amp;width=150&amp;height=20&amp;colorscheme=light&amp;layout=button_count&amp;action=like&amp;show_faces=true&amp;send=true&amp;appId={!!autotag conf:facebook_consumer_key !!}\" scrolling=\"no\" frameborder=\"0\" style=\"border:none; overflow:hidden; width:150px; height:20px;\" allowTransparency=\"true\"></iframe></li>\n    </ul>\n\n<div class=\"article\">\n{formatted_article}\n</div>\n\n<div class=\"uk-grid uk-margin-large-top\">\n    <div class=\"uk-width-medium-1-2\">\n        {whats_related}\n    </div>\n    <div class=\"uk-width-medium-1-2\">\n        {story_options}\n    </div>\n</div>\n<div class=\"uk-margin-large-top\">\n{trackback}\n</div>\n<div class=\"uk-margin-large-top\">\n{commentbar}\n</div>\n\n{# end {templatelocation} #}\n"], "fixing_code": ["{# begin {templatelocation} #}\n\n    <ul class=\"uk-subnav uk-flex-right uk-margin-remove\">\n      <li><g:plusone href=\"{site_url}/article.php/{story_id}\"></g:plusone></li>\n      <li><a class=\"twitter-share-button\" data-url=\"{site_url}/article.php/{story_id}\" href=\"https://twitter.com/intent/tweet?text={story_title}\" data-lang=\"ja\">Tweet</a></li>\n      <li><iframe src=\"//www.facebook.com/plugins/like.php?href={site_url}/article.php/{story_id}&amp;width=150&amp;height=20&amp;colorscheme=light&amp;layout=button_count&amp;action=like&amp;show_faces=true&amp;send=true&amp;appId={!!autotag conf:facebook_consumer_key !!}\" scrolling=\"no\" frameborder=\"0\" style=\"border:none; overflow:hidden; width:150px; height:20px;\" allowTransparency=\"true\"></iframe></li>\n    </ul>\n\n<div class=\"article\">\n{formatted_article}\n</div>\n\n<div class=\"uk-grid uk-margin-large-top\">\n    <div class=\"uk-width-medium-1-2\">\n        {whats_related}\n    </div>\n    <div class=\"uk-width-medium-1-2\">\n        {story_options}\n    </div>\n</div>\n<div class=\"uk-margin-large-top\">\n{trackback}\n</div>\n<div class=\"uk-margin-large-top\">\n{commentbar}\n</div>\n\n{# end {templatelocation} #}\n"], "filenames": ["public_html/layout/default/article/article.thtml"], "buggy_code_start_loc": [5], "buggy_code_end_loc": [7], "fixing_code_start_loc": [5], "fixing_code_end_loc": [7], "type": "CWE-79", "message": "Multiple cross-site scripting (XSS) vulnerabilities in Geeklog IVYWE edition 2.1.1 allow remote attackers to inject arbitrary web script or HTML by leveraging use of the COM_getCurrentURL function in (1) public_html/layout/default/header.thtml, (2) public_html/layout/bento/header.thtml, (3) public_html/layout/fotos/header.thtml, or (4) public_html/layout/default/article/article.thtml.", "other": {"cve": {"id": "CVE-2016-4849", "sourceIdentifier": "vultures@jpcert.or.jp", "published": "2017-04-20T17:59:00.337", "lastModified": "2017-04-25T18:42:55.897", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Multiple cross-site scripting (XSS) vulnerabilities in Geeklog IVYWE edition 2.1.1 allow remote attackers to inject arbitrary web script or HTML by leveraging use of the COM_getCurrentURL function in (1) public_html/layout/default/header.thtml, (2) public_html/layout/bento/header.thtml, (3) public_html/layout/fotos/header.thtml, or (4) public_html/layout/default/article/article.thtml."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades XSS en Geeklog IVYWE edici\u00f3n 2.1.1 permite a atacantes remotos inyectar c\u00f3digo web o HTML arbitrario mediante el uso de la funci\u00f3n COM_getCurrentURL en (1) public_html/layout/default/header.thtml, (2) public_html/layout/bento/header.thtml, (3) public_html/layout/fotos/header.thtml, o (4) public_html/layout/default/article/article.thtml."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:geeklog_project:geeklog:2.1.1:*:*:*:ivywe:*:*:*", "matchCriteriaId": "988E4308-9187-4508-B8C5-FD41739DF63B"}]}]}], "references": [{"url": "http://jvn.jp/en/jp/JVN09836883/index.html", "source": "vultures@jpcert.or.jp", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://jvndb.jvn.jp/en/contents/2016/JVNDB-2016-000150.html", "source": "vultures@jpcert.or.jp", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "http://www.securityfocus.com/bid/92545", "source": "vultures@jpcert.or.jp", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/ivywe/geeklog-ivywe/commit/41f4677e2eaa587b80eb9801150c1b402344c43d", "source": "vultures@jpcert.or.jp", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/ivywe/geeklog-ivywe/commit/beba390fd86bd991414ebf73e3482966d7115654", "source": "vultures@jpcert.or.jp", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://www.ivywe.co.jp/article.php/xss-ivywe-distribution", "source": "vultures@jpcert.or.jp", "tags": ["Vendor Advisory"]}]}, "github_commit_url": "https://github.com/ivywe/geeklog-ivywe/commit/41f4677e2eaa587b80eb9801150c1b402344c43d"}}