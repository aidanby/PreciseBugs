{"buggy_code": ["C.P.Sub \u516c\u544a\u7cfb\u7d71\n=======\n<h4>\u524d\u8a00</h4>\n\nPHP \u516c\u544a\u7cfb\u7d71\uff0c\u7528 CSV \u683c\u5f0f\u5efa\u69cb\u51fa\u4f86\u7684\u5c0f\u578b PHP \u7a0b\u5f0f\u3002\n\n\u57fa\u672c\u4e0a\u5c31\u662f\u5f37\u5316\u820a\u7248\u7684\u529f\u80fd\uff0c\u6539\u5beb\u4e00\u4e0b\u5167\u90e8\u67b6\u69cb\uff0c\u4e26\u5957\u7528\u4e86 Bootstrap \uff0c\u6240\u4ee5\u81ea\u884c\u66f4\u63db\u6a23\u5f0f\uff01\n\n\u5982\u679c\u4f7f\u7528\u4e0a\u6709\u9047\u5230\u4ec0\u9ebc\u554f\u984c\uff0c\u6216\u662f\u6709\u7a0b\u5f0f\u4e0a\u7684\u5efa\u8b70\u3001\u67b6\u69cb\u4e0a\u7684\u5efa\u8b70\u3001\u751a\u81f3\u662f\u529f\u80fd\u4e0a\u7684\u5efa\u8b70\uff0c\u90fd\u6b61\u8fce\u4f86\u4fe1\u544a\u77e5\u3002\n\n\u7576\u7136\uff0c\u6700\u91cd\u8981\u7684\u662f\u8981\u8a18\u5f97 Bug \u56de\u5831\uff5e\n\n=======\n\n<h4>\u5b89\u88dd\u65b9\u5f0f</h4>\n\n<h3>1. Server \u5065\u5eb7\u6aa2\u67e5</h3>\n<ul>\n  <li>\u74b0\u5883\uff1aPHP 5.3 \u4ee5\u4e0a (\u5efa\u8b70)</li>\n  <li>PHP.ini \u8a2d\u5b9a\uff1a\n    <ul>\n      <ol>short_open_tag = on;</ol>\n      <ol>file_uploads = on;</ol>\n      <ol>allow_url_fopen = on;</ol>\n    </ul>\n  </li>\n</ul>\n<h3>2. \u4e0a\u50b3\u81f3 FTP \u76ee\u9304</h3>\n<h3>3. \u4fee\u6539\u8cc7\u6599\u593e/\u76ee\u9304\u6b0a\u9650\uff0c\u6539\u6210 777</h3>\n<ul> \n <li>cpsub/upload/</li>\n <li>cpsub/db/article.txt</li>\n <li>cpsub/db/settings.txt</li>\n</ul>\n<h3>4. \u4fee\u6539\u5e33\u865f\u5bc6\u78bc</h3>\n<ul>\n <li>\u958b\u555f cpsub/config/config.php</li>\n <li>\u4fee\u6539\u9663\u5217\u6578\u503c</li>\n <code>\n          $add_user\t= array(\"username\" => \"admin\", // \u5e33\u865f\n\t\t\t\t\t\"password\" => \"admin\", // \u5bc6\u78bc\n\t\t\t\t\t\"nickname\" => \"\u7ba1\u7406\u54e1\" // \u7ba1\u7406\u54e1\n\t\t\t\t\t); \n </code>\n</ul>\n<h3>5. \u5927\u529f\u544a\u6210\uff0c\u958b\u555f\u700f\u89bd\u5668\u89c0\u770b\uff01</h3>\n\n=======\n\n<h4>\u7248\u672c\u66f4\u65b0</h4>\n\n<b>2016-11-30: v5.1</b><br>\n<li>1.\u52a0\u5165\u6700\u5f8c\u700f\u89bd\u6642\u9593\uff0c\u4ee5\u963b\u64cb\u904e\u5ea6\u700f\u89bd\u800c\u5c0e\u81f4\u6587\u7ae0\u6d88\u5931\u7684\u554f\u984c</li>\n<li>2.\u4fee\u6539\u4e00\u4e9b\u5c0f Bug</li>\n<li>3.\u52a0\u5165 IP Checker \uff0c\u4f46\u597d\u50cf\u6c92\u4ec0\u9ebc\u7528</li>\n\n\n\n=======\n\nThis is a PHP bulletin project that made with CSV file system (which is not using SQL as the database)\n\nIf you have any question or suggestion about this project, please contact with me by using E-mail, Facebook message, or Twitter.\n\n<h4>Installation</h4>\n\n<h3>1. Server Configuration</h3>\n<ul>\n  <li>Environment\uff1aPHP 5.3 or higher</li>\n  <li>PHP.ini config\uff1a\n    <ul>\n      <ol>short_open_tag = on;</ol>\n      <ol>file_uploads = on;</ol>\n      <ol>allow_url_fopen = on;</ol>\n    </ul>\n  </li>\n</ul>\n<h3>2. Upload the whole \"cpsub\" folder to your server</h3>\n<h3>3. Update the folder/files's permissions to 777</h3>\n<ul> \n <li>cpsub/upload/</li>\n <li>cpsub/db/article.txt</li>\n <li>cpsub/db/settings.txt</li>\n</ul>\n<h3>4. Update the user name and user password</h3>\n<ul>\n <li>Open cpsub/config/config.php</li>\n <li>Edit the array values</li>\n <code>\n          $add_user\t= array(\"username\" => \"admin\", // account\n\t\t\t\t\t\"password\" => \"admin\", // password\n\t\t\t\t\t\"nickname\" => \"Admin\" // Nickname\n\t\t\t\t\t); \n </code>\n</ul>\n<h3>5. Finish!!</h3>\n\n\n=======\n\n<h4>Relsease Logs</h4>\n\n<b>2017-4-6: v5.21</b><br>\n<li>1. Filter Update</li>\n\n<b>2017-3-27: v5.2</b><br>\n<li>1. XSS issues resolved</li>\n\n<b>2016-11-30: v5.1</b><br>\n<li>1. Added a last-time-viewed date column to prevent the data format loses</li>\n<li>2. Remove some bugs</li>\n<li>2. Added an IP Checker</li>\n\n\n\n=======\n=======\n\nDemo \u7db2\u5740\uff1ahttp://cooltey.org/cpsub/\n\n\u76ee\u524d\u7a0b\u5f0f\u7248\u672c Current Version\uff1av5.21\n\n\u4f5c\u8005 Author\uff1aCooltey Feng\n\nE-mail\uff1acoolteygame@gmail.com\n\nFacebook\uff1ahttp://www.facebook.com/cooltey\n\nTwitter\uff1ahttp://twitter.com/cooltey\n\n\u7db2\u7ad9 My Website\uff1ahttp://www.cooltey.org\n\n\u82e5\u6709\u554f\u984c\uff0c\u6b61\u8fce\u4ea4\u6d41\uff01\n\nContact me if you have any question!\n\n=======\n"], "fixing_code": ["C.P.Sub \u516c\u544a\u7cfb\u7d71\n=======\n<h4>\u524d\u8a00</h4>\n\nPHP \u516c\u544a\u7cfb\u7d71\uff0c\u7528 CSV \u683c\u5f0f\u5efa\u69cb\u51fa\u4f86\u7684\u5c0f\u578b PHP \u7a0b\u5f0f\u3002\n\n\u57fa\u672c\u4e0a\u5c31\u662f\u5f37\u5316\u820a\u7248\u7684\u529f\u80fd\uff0c\u6539\u5beb\u4e00\u4e0b\u5167\u90e8\u67b6\u69cb\uff0c\u4e26\u5957\u7528\u4e86 Bootstrap \uff0c\u6240\u4ee5\u81ea\u884c\u66f4\u63db\u6a23\u5f0f\uff01\n\n\u5982\u679c\u4f7f\u7528\u4e0a\u6709\u9047\u5230\u4ec0\u9ebc\u554f\u984c\uff0c\u6216\u662f\u6709\u7a0b\u5f0f\u4e0a\u7684\u5efa\u8b70\u3001\u67b6\u69cb\u4e0a\u7684\u5efa\u8b70\u3001\u751a\u81f3\u662f\u529f\u80fd\u4e0a\u7684\u5efa\u8b70\uff0c\u90fd\u6b61\u8fce\u4f86\u4fe1\u544a\u77e5\u3002\n\n\u7576\u7136\uff0c\u6700\u91cd\u8981\u7684\u662f\u8981\u8a18\u5f97 Bug \u56de\u5831\uff5e\n\n=======\n\n<h4>\u5b89\u88dd\u65b9\u5f0f</h4>\n\n<h3>1. Server \u5065\u5eb7\u6aa2\u67e5</h3>\n<ul>\n  <li>\u74b0\u5883\uff1aPHP 5.3 \u4ee5\u4e0a (\u5efa\u8b70)</li>\n  <li>PHP.ini \u8a2d\u5b9a\uff1a\n    <ul>\n      <ol>short_open_tag = on;</ol>\n      <ol>file_uploads = on;</ol>\n      <ol>allow_url_fopen = on;</ol>\n    </ul>\n  </li>\n</ul>\n<h3>2. \u4e0a\u50b3\u81f3 FTP \u76ee\u9304</h3>\n<h3>3. \u4fee\u6539\u8cc7\u6599\u593e/\u76ee\u9304\u6b0a\u9650\uff0c\u6539\u6210 777</h3>\n<ul> \n <li>cpsub/upload/</li>\n <li>cpsub/db/article.txt</li>\n <li>cpsub/db/settings.txt</li>\n</ul>\n<h3>4. \u4fee\u6539\u5e33\u865f\u5bc6\u78bc</h3>\n<ul>\n <li>\u958b\u555f cpsub/config/config.php</li>\n <li>\u4fee\u6539\u9663\u5217\u6578\u503c</li>\n <code>\n          $add_user\t= array(\"username\" => \"admin\", // \u5e33\u865f\n\t\t\t\t\t\"password\" => \"admin\", // \u5bc6\u78bc\n\t\t\t\t\t\"nickname\" => \"\u7ba1\u7406\u54e1\" // \u7ba1\u7406\u54e1\n\t\t\t\t\t); \n </code>\n</ul>\n<h3>5. \u5927\u529f\u544a\u6210\uff0c\u958b\u555f\u700f\u89bd\u5668\u89c0\u770b\uff01</h3>\n\n=======\n\n<h4>\u7248\u672c\u66f4\u65b0</h4>\n\n<b>2019-02-10: v5.3</b><br>\n<li>1.\u4fee\u6b63 CSRF \u554f\u984c\u4e26\u65b0\u589e\u958b\u95dc CSRF \u9632\u8b77\u7684\u529f\u80fd</li>\n\n\n\n=======\n\nThis is a PHP bulletin project that made with CSV file system (which is not using SQL as the database)\n\nIf you have any question or suggestion about this project, please contact with me by using E-mail, Facebook message, or Twitter.\n\n<h4>Installation</h4>\n\n<h3>1. Server Configuration</h3>\n<ul>\n  <li>Environment\uff1aPHP 5.3 or higher</li>\n  <li>PHP.ini config\uff1a\n    <ul>\n      <ol>short_open_tag = on;</ol>\n      <ol>file_uploads = on;</ol>\n      <ol>allow_url_fopen = on;</ol>\n    </ul>\n  </li>\n</ul>\n<h3>2. Upload the whole \"cpsub\" folder to your server</h3>\n<h3>3. Update the folder/files's permissions to 777</h3>\n<ul> \n <li>cpsub/upload/</li>\n <li>cpsub/db/article.txt</li>\n <li>cpsub/db/settings.txt</li>\n</ul>\n<h3>4. Update the user name and user password</h3>\n<ul>\n <li>Open cpsub/config/config.php</li>\n <li>Edit the array values</li>\n <code>\n          $add_user\t= array(\"username\" => \"admin\", // account\n\t\t\t\t\t\"password\" => \"admin\", // password\n\t\t\t\t\t\"nickname\" => \"Admin\" // Nickname\n\t\t\t\t\t); \n </code>\n</ul>\n<h3>5. Finish!!</h3>\n\n\n=======\n\n<h4>Relsease Logs</h4>\n\n<b>2019-2-10: v5.3</b><br>\n<li>1. Added CSRF protection</li>\n\n<b>2017-4-6: v5.21</b><br>\n<li>1. Filter Update</li>\n\n<b>2017-3-27: v5.2</b><br>\n<li>1. XSS issues resolved</li>\n\n<b>2016-11-30: v5.1</b><br>\n<li>1. Added a last-time-viewed date column to prevent the data format loses</li>\n<li>2. Remove some bugs</li>\n<li>2. Added an IP Checker</li>\n\n\n\n=======\n=======\n\nDemo \u7db2\u5740\uff1ahttp://cooltey.org/cpsub/\n\n\u76ee\u524d\u7a0b\u5f0f\u7248\u672c Current Version\uff1av5.3\n\n\u4f5c\u8005 Author\uff1aCooltey Feng\n\nE-mail\uff1acoolteygame@gmail.com\n\nFacebook\uff1ahttp://www.facebook.com/cooltey\n\nTwitter\uff1ahttp://twitter.com/cooltey\n\n\u7db2\u7ad9 My Website\uff1ahttp://www.cooltey.org\n\n\u82e5\u6709\u554f\u984c\uff0c\u6b61\u8fce\u4ea4\u6d41\uff01\n\nContact me if you have any question!\n\n=======\n"], "filenames": ["README.md"], "buggy_code_start_loc": [52], "buggy_code_end_loc": [122], "fixing_code_start_loc": [52], "fixing_code_end_loc": [123], "type": "CWE-352", "message": "C.P.Sub before 5.3 allows CSRF via a manage.php?p=article_del&id= URI.", "other": {"cve": {"id": "CVE-2019-7738", "sourceIdentifier": "cve@mitre.org", "published": "2019-02-11T21:29:00.413", "lastModified": "2019-02-13T12:31:45.517", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "C.P.Sub before 5.3 allows CSRF via a manage.php?p=article_del&id= URI."}, {"lang": "es", "value": "C.P.Sub, en versiones anteriores a la 5.3, permite Cross-Site Request Forgery (CSRF) mediante un URI manage.php?p=article_delid=."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:c.p.sub_project:c.p.sub:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.3", "matchCriteriaId": "514B6779-FA33-4B6D-BCBD-D9CB49E2ED17"}]}]}], "references": [{"url": "https://github.com/cooltey/C.P.Sub/commit/b2be52fd89b6fd4d69d63d504bc11742cd679ebe", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/cooltey/C.P.Sub/issues/3", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/cooltey/C.P.Sub/commit/b2be52fd89b6fd4d69d63d504bc11742cd679ebe"}}