{"buggy_code": ["<?php\n$timeNow = time();\n?>\n<script src=\"<?= base_url('assets/ckeditor/ckeditor.js') ?>\"></script>\n<link rel=\"stylesheet\" href=\"<?= base_url('assets/bootstrap-select-1.12.1/bootstrap-select.min.css') ?>\">\n<div class=\"row\">\n    <div class=\"col-md-6 col-md-offset-3\">\n        <?php\n        if ($this->session->flashdata('result_publish')) {\n            ?> \n            <div class=\"alert alert-success\"><?= $this->session->flashdata('result_publish') ?></div> \n            <?php\n        }\n        ?>\n        <div class=\"content\">\n            <form class=\"form-box\" action=\"\" method=\"POST\" enctype=\"multipart/form-data\">\n                <input type=\"hidden\" value=\"<?= isset($_POST['folder']) ? htmlspecialchars($_POST['folder']) : $timeNow ?>\" name=\"folder\">\n                <div class=\"form-group available-translations\">\n                    <b>Languages</b>\n                    <?php foreach ($languages as $language) { ?>\n                        <button type=\"button\" data-locale-change=\"<?= $language->abbr ?>\" class=\"btn btn-default locale-change text-uppercase <?= $language->abbr == MY_DEFAULT_LANGUAGE_ABBR ? 'active' : '' ?>\">\n                            <img src=\"<?= base_url('attachments/lang_flags/' . $language->flag) ?>\" alt=\"\">\n                            <?= $language->abbr ?>\n                        </button>\n                    <?php } ?>\n                </div>\n                <?php\n                $i = 0;\n                foreach ($languages as $language) {\n                    ?>\n                    <div class=\"locale-container locale-container-<?= $language->abbr ?>\" <?= $language->abbr == MY_DEFAULT_LANGUAGE_ABBR ? 'style=\"display:block;\"' : '' ?>>\n                        <input type=\"hidden\" name=\"translations[]\" value=\"<?= $language->abbr ?>\">\n                        <div class=\"form-group\">\n                            <img src=\"<?= base_url('attachments/lang_flags/' . $language->flag) ?>\" alt=\"<?= $language->name ?>\" class=\"language\">\n                            <input type=\"text\" name=\"title[]\" placeholder=\"<?= lang('vendor_product_name') ?>\" value=\"<?= $trans_load != null && isset($trans_load[$language->abbr]['title']) ? $trans_load[$language->abbr]['title'] : '' ?>\" class=\"form-control\">\n                        </div> \n                        <label><?= lang('vendor_product_description') ?> <img src=\"<?= base_url('attachments/lang_flags/' . $language->flag) ?>\" alt=\"<?= $language->name ?>\"></label>\n                        <div class=\"form-group\">\n                            <textarea class=\"form-control\" name=\"description[]\" id=\"description<?= $i ?>\"><?= $trans_load != null && isset($trans_load[$language->abbr]['description']) ? $trans_load[$language->abbr]['description'] : '' ?></textarea>\n                        </div>\n                        <script>\n                            CKEDITOR.replace('description<?= $i ?>');\n                            CKEDITOR.config.entities = false;\n                        </script>\n                        <div class=\"form-group\">\n                            <img src=\"<?= base_url('attachments/lang_flags/' . $language->flag) ?>\" alt=\"\" class=\"language\">\n                            <input type=\"text\" name=\"price[]\" value=\"<?= $trans_load != null && isset($trans_load[$language->abbr]['price']) ? $trans_load[$language->abbr]['price'] : '' ?>\" placeholder=\"<?= lang('vendor_price') ?>\" class=\"form-control\">\n                        </div>\n                        <div class=\"form-group\">\n                            <img src=\"<?= base_url('attachments/lang_flags/' . $language->flag) ?>\" alt=\"\" class=\"language\">\n                            <input type=\"text\" name=\"old_price[]\" value=\"<?= $trans_load != null && isset($trans_load[$language->abbr]['old_price']) ? $trans_load[$language->abbr]['old_price'] : '' ?>\" placeholder=\"<?= lang('vendor_old_price') ?>\" class=\"form-control\">\n                        </div>\n                    </div>\n                    <?php\n                    $i++;\n                }\n                ?>\n                <div class=\"form-group bordered-group\">\n                    <?php\n                    if (isset($_POST['image']) && $_POST['image'] != null) {\n                        $image = 'attachments/shop_images/' . htmlspecialchars($_POST['image']);\n                        if (!file_exists($image)) {\n                            $image = 'attachments/no-image.png';\n                        }\n                        ?>\n                        <p><?= lang('vendor_current_image') ?></p>\n                        <div>\n                            <img src=\"<?= base_url($image) ?>\" class=\"img-responsive img-thumbnail\" style=\"max-width:300px; margin-bottom: 5px;\">\n                        </div>\n                        <input type=\"hidden\" name=\"old_image\" value=\"<?= htmlspecialchars($_POST['image']) ?>\">\n                        <?php if (isset($_GET['to_lang'])) { ?>\n                            <input type=\"hidden\" name=\"image\" value=\"<?= htmlspecialchars($_POST['image']) ?>\">\n                            <?php\n                        }\n                    }\n                    ?>\n                    <label><?= lang('vendor_cover_image') ?></label>\n                    <input type=\"file\" name=\"userfile\">\n                </div>\n                <div class=\"form-group bordered-group\">\n                    <div class=\"others-images-container\">\n                        <?= $otherImgs ?>\n                    </div>\n                    <a href=\"javascript:void(0);\" data-toggle=\"modal\" data-target=\"#modalMoreImages\" class=\"btn btn-default\"><?= lang('vendor_up_more_imgs') ?></a>\n                </div>\n                <div class=\"form-group\">\n                    <label><?= lang('vendor_select_category') ?></label>\n                    <select class=\"selectpicker form-control show-tick show-menu-arrow\" name=\"shop_categorie\">\n                        <?php foreach ($shop_categories as $key_cat => $shop_categorie) { ?>\n                            <option <?= isset($_POST['shop_categorie']) && $_POST['shop_categorie'] == $key_cat ? 'selected=\"\"' : '' ?> value=\"<?= $key_cat ?>\">\n                                <?php\n                                foreach ($shop_categorie['info'] as $nameAbbr) {\n                                    if ($nameAbbr['abbr'] == $this->config->item('language_abbr')) {\n                                        echo $nameAbbr['name'];\n                                    }\n                                }\n                                ?>\n                            </option>\n                        <?php } ?>\n                    </select>\n                </div> \n                <?php if ($showBrands == 1) { ?>\n                    <div class=\"form-group for-shop\">\n                        <label>Brand</label>\n                        <select class=\"selectpicker\" name=\"brand_id\">\n                            <?php foreach ($brands as $brand) { ?>\n                                <option <?= isset($_POST['brand_id']) && $_POST['brand_id'] == $brand['id'] ? 'selected' : '' ?> value=\"<?= $brand['id'] ?>\"><?= $brand['name'] ?></option>\n                            <?php } ?>\n                        </select>\n                    </div>\n                <?php } ?>\n                <div class=\"form-group\">\n                    <input type=\"text\" placeholder=\"<?= lang('vendor_quantity') ?>\" name=\"quantity\" value=\"<?= isset($_POST['quantity']) ? htmlspecialchars($_POST['quantity']) : '' ?>\" class=\"form-control\">\n                </div>\n                <div class=\"form-group\">\n                    <input type=\"text\" placeholder=\"<?= lang('vendor_position') ?>\" name=\"position\" value=\"<?= isset($_POST['quantity']) ? htmlspecialchars($_POST['position']) : '' ?>\" class=\"form-control\">\n                </div>\n                <button type=\"submit\" name=\"setProduct\" class=\"btn btn-green\"><?= lang('vendor_submit_product') ?></button>\n            </form> \n        </div>\n    </div>\n</div>\n<!-- Modal Upload More Images -->\n<div class=\"modal fade\" id=\"modalMoreImages\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\">\n    <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n                <h4 class=\"modal-title\" id=\"myModalLabel\"><?= lang('vendor_up_more_imgs') ?></h4>\n            </div>\n            <div class=\"modal-body\">\n                <form id=\"uploadImagesForm\">\n                    <input type=\"hidden\" value=\"<?= isset($_POST['folder']) ? htmlspecialchars($_POST['folder']) : $timeNow ?>\" name=\"folder\">\n                    <label for=\"others\"><?= lang('vendor_select_images') ?></label>\n                    <input type=\"file\" name=\"others[]\" id=\"others\" multiple />\n                </form>\n            </div>\n            <div class=\"modal-footer\">\n                <button type=\"button\" class=\"btn btn-default finish-upload\">\n                    <span class=\"finish-text\"><?= lang('finish') ?></span>\n                    <img src=\"<?= base_url('assets/imgs/load.gif') ?>\" class=\"loadUploadOthers\" alt=\"\">\n                </button>\n            </div>\n        </div>\n    </div>\n</div>\n<script src=\"<?= base_url('assets/bootstrap-select-1.12.1/js/bootstrap-select.min.js') ?>\"></script>\n"], "fixing_code": ["<?php\n$timeNow = time();\n?>\n<script src=\"<?= base_url('assets/ckeditor/ckeditor.js') ?>\"></script>\n<link rel=\"stylesheet\" href=\"<?= base_url('assets/bootstrap-select-1.12.1/bootstrap-select.min.css') ?>\">\n<div class=\"row\">\n    <div class=\"col-md-6 col-md-offset-3\">\n        <?php\n        if ($this->session->flashdata('result_publish')) {\n            ?> \n            <div class=\"alert alert-success\"><?= $this->session->flashdata('result_publish') ?></div> \n            <?php\n        }\n        ?>\n        <div class=\"content\">\n            <form class=\"form-box\" action=\"\" method=\"POST\" enctype=\"multipart/form-data\">\n                <input type=\"hidden\" value=\"<?= isset($_POST['folder']) ? htmlspecialchars($_POST['folder']) : $timeNow ?>\" name=\"folder\">\n                <div class=\"form-group available-translations\">\n                    <b>Languages</b>\n                    <?php foreach ($languages as $language) { ?>\n                        <button type=\"button\" data-locale-change=\"<?= htmlspecialchars($language->abbr) ?>\" class=\"btn btn-default locale-change text-uppercase <?= $language->abbr == MY_DEFAULT_LANGUAGE_ABBR ? 'active' : '' ?>\">\n                            <img src=\"<?= base_url('attachments/lang_flags/' . htmlspecialchars($language->flag)) ?>\" alt=\"\">\n                            <?= htmlspecialchars($language->abbr) ?>\n                        </button>\n                    <?php } ?>\n                </div>\n                <?php\n                $i = 0;\n                foreach ($languages as $language) {\n                    ?>\n                    <div class=\"locale-container locale-container-<?= htmlspecialchars($language->abbr) ?>\" <?= $language->abbr == MY_DEFAULT_LANGUAGE_ABBR ? 'style=\"display:block;\"' : '' ?>>\n                        <input type=\"hidden\" name=\"translations[]\" value=\"<?= htmlspecialchars($language->abbr) ?>\">\n                        <div class=\"form-group\">\n                            <img src=\"<?= base_url('attachments/lang_flags/' . htmlspecialchars($language->flag)) ?>\" alt=\"<?= htmlspecialchars($language->name) ?>\" class=\"language\">\n                            <input type=\"text\" name=\"title[]\" placeholder=\"<?= lang('vendor_product_name') ?>\" value=\"<?= $trans_load != null && isset($trans_load[$language->abbr]['title']) ? htmlentities($trans_load[$language->abbr]['title'], ENT_QUOTES, 'UTF-8') : '' ?>\" class=\"form-control\">\n                        </div> \n                        <label><?= lang('vendor_product_description') ?> <img src=\"<?= base_url('attachments/lang_flags/' . htmlspecialchars($language->flag)) ?>\" alt=\"<?= htmlspecialchars($language->name) ?>\"></label>\n                        <div class=\"form-group\">\n                            <textarea class=\"form-control\" name=\"description[]\" id=\"description<?= $i ?>\"><?= $trans_load != null && isset($trans_load[$language->abbr]['description']) ? htmlentities($trans_load[$language->abbr]['description'], ENT_QUOTES, 'UTF-8') : '' ?></textarea>\n                        </div>\n                        <script>\n                            CKEDITOR.replace('description<?= $i ?>');\n                            CKEDITOR.config.entities = false;\n                        </script>\n                        <div class=\"form-group\">\n                            <img src=\"<?= base_url('attachments/lang_flags/' . htmlspecialchars($language->flag)) ?>\" alt=\"\" class=\"language\">\n                            <input type=\"text\" name=\"price[]\" value=\"<?= $trans_load != null && isset($trans_load[$language->abbr]['price']) ? htmlentities($trans_load[$language->abbr]['price'], ENT_QUOTES, 'UTF-8') : '' ?>\" placeholder=\"<?= lang('vendor_price') ?>\" class=\"form-control\">\n                        </div>\n                        <div class=\"form-group\">\n                            <img src=\"<?= base_url('attachments/lang_flags/' . htmlspecialchars($language->flag)) ?>\" alt=\"\" class=\"language\">\n                            <input type=\"text\" name=\"old_price[]\" value=\"<?= $trans_load != null && isset($trans_load[$language->abbr]['old_price']) ? htmlentities($trans_load[$language->abbr]['old_price'], ENT_QUOTES, 'UTF-8') : '' ?>\" placeholder=\"<?= lang('vendor_old_price') ?>\" class=\"form-control\">\n                        </div>\n                    </div>\n                    <?php\n                    $i++;\n                }\n                ?>\n                <div class=\"form-group bordered-group\">\n                    <?php\n                    if (isset($_POST['image']) && $_POST['image'] != null) {\n                        $image = 'attachments/shop_images/' . htmlspecialchars($_POST['image']);\n                        if (!file_exists($image)) {\n                            $image = 'attachments/no-image.png';\n                        }\n                        ?>\n                        <p><?= lang('vendor_current_image') ?></p>\n                        <div>\n                            <img src=\"<?= base_url($image) ?>\" class=\"img-responsive img-thumbnail\" style=\"max-width:300px; margin-bottom: 5px;\">\n                        </div>\n                        <input type=\"hidden\" name=\"old_image\" value=\"<?= htmlspecialchars($_POST['image']) ?>\">\n                        <?php if (isset($_GET['to_lang'])) { ?>\n                            <input type=\"hidden\" name=\"image\" value=\"<?= htmlspecialchars($_POST['image']) ?>\">\n                            <?php\n                        }\n                    }\n                    ?>\n                    <label><?= lang('vendor_cover_image') ?></label>\n                    <input type=\"file\" name=\"userfile\">\n                </div>\n                <div class=\"form-group bordered-group\">\n                    <div class=\"others-images-container\">\n                        <?= $otherImgs ?>\n                    </div>\n                    <a href=\"javascript:void(0);\" data-toggle=\"modal\" data-target=\"#modalMoreImages\" class=\"btn btn-default\"><?= lang('vendor_up_more_imgs') ?></a>\n                </div>\n                <div class=\"form-group\">\n                    <label><?= lang('vendor_select_category') ?></label>\n                    <select class=\"selectpicker form-control show-tick show-menu-arrow\" name=\"shop_categorie\">\n                        <?php foreach ($shop_categories as $key_cat => $shop_categorie) { ?>\n                            <option <?= isset($_POST['shop_categorie']) && $_POST['shop_categorie'] == $key_cat ? 'selected=\"\"' : '' ?> value=\"<?= $key_cat ?>\">\n                                <?php\n                                foreach ($shop_categorie['info'] as $nameAbbr) {\n                                    if ($nameAbbr['abbr'] == $this->config->item('language_abbr')) {\n                                        echo $nameAbbr['name'];\n                                    }\n                                }\n                                ?>\n                            </option>\n                        <?php } ?>\n                    </select>\n                </div> \n                <?php if ($showBrands == 1) { ?>\n                    <div class=\"form-group for-shop\">\n                        <label>Brand</label>\n                        <select class=\"selectpicker\" name=\"brand_id\">\n                            <?php foreach ($brands as $brand) { ?>\n                                <option <?= isset($_POST['brand_id']) && $_POST['brand_id'] == $brand['id'] ? 'selected' : '' ?> value=\"<?= $brand['id'] ?>\"><?= $brand['name'] ?></option>\n                            <?php } ?>\n                        </select>\n                    </div>\n                <?php } ?>\n                <div class=\"form-group\">\n                    <input type=\"text\" placeholder=\"<?= lang('vendor_quantity') ?>\" name=\"quantity\" value=\"<?= isset($_POST['quantity']) ? htmlspecialchars($_POST['quantity']) : '' ?>\" class=\"form-control\">\n                </div>\n                <div class=\"form-group\">\n                    <input type=\"text\" placeholder=\"<?= lang('vendor_position') ?>\" name=\"position\" value=\"<?= isset($_POST['quantity']) ? htmlspecialchars($_POST['position']) : '' ?>\" class=\"form-control\">\n                </div>\n                <button type=\"submit\" name=\"setProduct\" class=\"btn btn-green\"><?= lang('vendor_submit_product') ?></button>\n            </form> \n        </div>\n    </div>\n</div>\n<!-- Modal Upload More Images -->\n<div class=\"modal fade\" id=\"modalMoreImages\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\">\n    <div class=\"modal-dialog\" role=\"document\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n                <h4 class=\"modal-title\" id=\"myModalLabel\"><?= lang('vendor_up_more_imgs') ?></h4>\n            </div>\n            <div class=\"modal-body\">\n                <form id=\"uploadImagesForm\">\n                    <input type=\"hidden\" value=\"<?= isset($_POST['folder']) ? htmlspecialchars($_POST['folder']) : $timeNow ?>\" name=\"folder\">\n                    <label for=\"others\"><?= lang('vendor_select_images') ?></label>\n                    <input type=\"file\" name=\"others[]\" id=\"others\" multiple />\n                </form>\n            </div>\n            <div class=\"modal-footer\">\n                <button type=\"button\" class=\"btn btn-default finish-upload\">\n                    <span class=\"finish-text\"><?= lang('finish') ?></span>\n                    <img src=\"<?= base_url('assets/imgs/load.gif') ?>\" class=\"loadUploadOthers\" alt=\"\">\n                </button>\n            </div>\n        </div>\n    </div>\n</div>\n<script src=\"<?= base_url('assets/bootstrap-select-1.12.1/js/bootstrap-select.min.js') ?>\"></script>\n"], "filenames": ["application/modules/vendor/views/add_product.php"], "buggy_code_start_loc": [21], "buggy_code_end_loc": [52], "fixing_code_start_loc": [21], "fixing_code_end_loc": [52], "type": "CWE-79", "message": "Cross Site Scripting (XSS) vulnerability in Ecommerce-CodeIgniter-Bootstrap thru commit d5904379ca55014c5df34c67deda982c73dc7fe5 (on Dec 27, 2022), allows attackers to execute arbitrary code via the languages and trans_load parameters in file add_product.php.", "other": {"cve": {"id": "CVE-2023-23010", "sourceIdentifier": "cve@mitre.org", "published": "2023-01-20T19:15:18.010", "lastModified": "2023-01-28T02:48:33.200", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross Site Scripting (XSS) vulnerability in Ecommerce-CodeIgniter-Bootstrap thru commit d5904379ca55014c5df34c67deda982c73dc7fe5 (on Dec 27, 2022), allows attackers to execute arbitrary code via the languages and trans_load parameters in file add_product.php."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ecommerce-codeigniter-bootstrap_project:ecommerce-codeigniter-bootstrap:*:*:*:*:*:*:*:*", "versionEndExcluding": "2022-12-27", "matchCriteriaId": "2C7A0851-121A-4464-817A-B7AB149D48A2"}]}]}], "references": [{"url": "https://gist.github.com/enferas/8a836008e9f635a2f80d09c9a8b5a533", "source": "cve@mitre.org", "tags": ["Exploit", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/commit/d5904379ca55014c5df34c67deda982c73dc7fe5", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/issues/242", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/kirilkirkov/Ecommerce-CodeIgniter-Bootstrap/commit/d5904379ca55014c5df34c67deda982c73dc7fe5"}}