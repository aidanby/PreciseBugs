{"buggy_code": ["<?php\n/**\n * KobeBeauty PHP Contact Form\n * http://www.kobe-beauty.co.jp/\n *\n * Copyright (c) 2014 Kobe Beauty Co., Ltd.\n * Released under the MIT license\n */\n\n// \u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f\nrequire_once('common/init.php');\n\nglobal $param;\n\n// \u30da\u30fc\u30b8\u30bf\u30a4\u30c8\u30eb\n$param['title'] = '\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9\u306e\u78ba\u8a8d | \u7121\u6599\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9';\n// \u30d1\u30b9\n$param['root_url'] = '';\n\n// \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u53d6\u5f97\n$contact_data = isset($_SESSION[\"contact_data\"]) ? $_SESSION[\"contact_data\"] : array();\n// \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u306e\u6709\u7121\u3092\u30c1\u30a7\u30c3\u30af\nif (count($contact_data) == 0) {\n\theader(\"Location: error.php\"); // \u30c7\u30fc\u30bf\u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u30a8\u30e9\u30fc\u753b\u9762\u3078\u9077\u79fb\n\texit;\n}\n\n$name = isset($contact_data[\"name\"]) ? $contact_data[\"name\"] : \"\";\n$email = isset($contact_data[\"email\"]) ? $contact_data[\"email\"] : \"\";\n$message = isset($contact_data[\"message\"]) ? $contact_data[\"message\"] : \"\";\n\n//\u64cd\u4f5c\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u53d6\u5f97\n$act = isset($_POST[\"act\"]) ? intval($_POST[\"act\"]) : 1;\n\n// \u9001\u4fe1\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3055\u308c\u305f\u5834\u5408\nif ($act == 3) {\n\t// \u30e1\u30fc\u30eb\u9001\u4fe1\n\t$result_to_admin = sendMailtoAdmin($contact_data);\n\t$result_to_customer = sendMailtoCustomer($contact_data);\n\n\n\tif ($result_to_admin && $result_to_customer) { // \u9001\u4fe1\u6210\u529f\n\t\t$_SESSION = array();  // \u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u683c\u7d0d\u3055\u308c\u305f\u60c5\u5831\u3092\u30ab\u30e9\u306b\u3057\u307e\u3059\u3002\n\t\theader(\"Location: done.php\");\n\t\texit;\n\t} else { // \u9001\u4fe1\u5931\u6557\n\t\t$_SESSION = array();  // \u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u683c\u7d0d\u3055\u308c\u305f\u60c5\u5831\u3092\u30ab\u30e9\u306b\u3057\u307e\u3059\u3002\n\t\theader(\"Location: error.php\");\n\t\texit;\n\t}\n}\n\n// \u30d8\u30c3\u30c0\u30fc\u8868\u793a\ngetHeader();\n?>\n\n<h1 class=\"page-header\">\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9\u306e\u78ba\u8a8d</h1>\n\n<div class=\"page-content\">\n\t<p class=\"mb30\">\n\t\t\u3053\u306e\u5185\u5bb9\u3067\u3088\u308d\u3057\u3051\u308c\u3070\u9001\u4fe1\u3059\u308b\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002<br>\n\t\t\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u9593\u9055\u3044\u304c\u3042\u308b\u3068\u56de\u7b54\u306e\u8fd4\u4fe1\u304c\u3067\u304d\u307e\u305b\u3093\u306e\u3067\u5341\u5206\u306b\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002\n\t</p>\n\n\t<form class=\"form-horizontal\" name=\"contactform\" role=\"form\" method=\"post\" action=\"<?php echo $_SERVER[\"PHP_SELF\"]; ?>\">\n\t\t<table class=\"table table-bordered confirm\">\n\t\t\t<tr>\n\t\t\t\t<th>\u304a\u540d\u524d</th>\n\t\t\t\t<td><?php echo htmlspchar($name); ?></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<th>\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9</th>\n\t\t\t\t<td><?php echo htmlspchar($email); ?></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<th>\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9</th>\n\t\t\t\t<td><?php echo nl2br(htmlspchar($message)); ?></td>\n\t\t\t</tr>\n\t\t</table>\n\n\t\t<div class=\"btn-area\">\n\t\t\t<button type=\"button\" class=\"btn btn-default\" onclick=\"contactform.action='index.php';contactform.submit();\">\u623b\u308b<i class=\"fa fa-reply\"></i></button>\n\t\t\t<button type=\"submit\" class=\"btn btn-success\">\u9001\u4fe1\u3059\u308b<i class=\"fa fa-envelope-o\"></i></button>\n\t\t\t<input type=\"hidden\" name=\"act\" value=\"3\">\n\t\t</div>\n\t</form>\n\n</div>\n\n<?php\n// \u30d5\u30c3\u30bf\u30fc\u8868\u793a\ngetFooter();\n", "<?php\n/**\n * KobeBeauty PHP Contact Form\n * http://www.kobe-beauty.co.jp/\n *\n * Copyright (c) 2014 Kobe Beauty Co., Ltd.\n * Released under the MIT license\n */\n\n// \u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f\nrequire_once('common/init.php');\nrequire_once('common/validate.php');\n\nglobal $param;\n\n// \u30da\u30fc\u30b8\u30bf\u30a4\u30c8\u30eb\n$param['title'] = '\u304a\u554f\u3044\u5408\u308f\u305b | \u7121\u6599\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9';\n// \u30d1\u30b9\n$param['root_url'] = '';\n\n//\u64cd\u4f5c\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u53d6\u5f97\n$act = isset($_POST[\"act\"]) ? intval($_POST[\"act\"]) : 1;\n\n\nif ($act == 1) {\n\t// \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u30af\u30ea\u30a2\n\t$contact_data = array();\n\t// \u521d\u671f\u5024\u30bb\u30c3\u30c8\n\t$err_msg = array();\n\t$name = '';\n\t$email = '';\n\t$message = '';\n\n} elseif ($act == 2) { // \u78ba\u8a8d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3055\u308c\u305f\u5834\u5408\n\t// POST\u30c7\u30fc\u30bf\u3092\u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u683c\u7d0d\n\t$_SESSION[\"contact_data\"] = isset($_POST[\"contact_data\"]) ? $_POST[\"contact_data\"] : array();\n\t// \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u3092\u914d\u5217\u306b\u30bb\u30c3\u30c8\n\t$contact_data = $_SESSION[\"contact_data\"];\n\t// \u5404\u9805\u76ee\u30c7\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\n\t$name = isset($contact_data[\"name\"]) ? $contact_data[\"name\"] : \"\";\n\t$email = isset($contact_data[\"email\"]) ? $contact_data[\"email\"] : \"\";\n\t$message = isset($contact_data[\"message\"]) ? $contact_data[\"message\"] : \"\";\n\t// \u5165\u529b\u30c1\u30a7\u30c3\u30af\n\t$err_msg = checkInputData($contact_data);\n\tif(!$err_msg){\n\t\theader(\"Location: confirm.php\");\n\t\texit();\n\t}\n\n} else {\n\t// \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u53d6\u5f97\n\t$contact_data = isset($_SESSION[\"contact_data\"]) ? $_SESSION[\"contact_data\"] : array();\n\t// \u5404\u9805\u76ee\u30c7\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\n\t$name = isset($contact_data[\"name\"]) ? $contact_data[\"name\"] : \"\";\n\t$email = isset($contact_data[\"email\"]) ? $contact_data[\"email\"] : \"\";\n\t$message = isset($contact_data[\"message\"]) ? $contact_data[\"message\"] : \"\";\n}\n\n// \u30d8\u30c3\u30c0\u30fc\u8868\u793a\ngetHeader();\n?>\n\n<h1 class=\"page-header\">\u304a\u554f\u3044\u5408\u308f\u305b</h1>\n\n<?php if (count($err_msg) > 0) { ?>\n<div>\n\t<ul class=\"error\">\n\t\t<?php foreach ($err_msg as $msg) { ?>\n\t\t<li><?php echo $msg; ?></li>\n\t\t<?php } ?>\n\t</ul>\n</div>\n<?php } ?>\n\n<div class=\"page-content\">\n\t<p class=\"mb30\">\u4ee5\u4e0b\u3092\u5165\u529b\u3057\u78ba\u8a8d\u3059\u308b\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002<span class=\"red\">*</span>\u306f\u5165\u529b\u5fc5\u9808\u3067\u3059\u3002</p>\n\n\t<form class=\"form-horizontal\" name=\"contactform\" role=\"form\" method=\"post\" action=\"<?php echo $_SERVER[\"PHP_SELF\"]; ?>\" novalidate>\n\t\t<div class=\"form-group\">\n\t\t\t<label for=\"inputName\" class=\"col-sm-3 control-label\">\u304a\u540d\u524d<span class=\"red\">*</span></label>\n\t\t\t<div class=\"col-sm-9\">\n\t\t\t\t<input type=\"text\" class=\"form-control\" name=\"contact_data[name]\" placeholder=\"\u304a\u540d\u524d\" value=\"<?php echo htmlspchar($name); ?>\">\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"form-group\">\n\t\t\t<label for=\"inputEmail\" class=\"col-sm-3 control-label\">\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9<span class=\"red\">*</span></label>\n\t\t\t<div class=\"col-sm-9\">\n\t\t\t\t<input type=\"email\" class=\"form-control\" name=\"contact_data[email]\" placeholder=\"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\" value=\"<?php echo htmlspchar($email); ?>\">\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"form-group\">\n\t\t\t<label for=\"inputMessage\" class=\"col-sm-3 control-label\">\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9<span class=\"red\">*</span></label>\n\t\t\t<div class=\"col-sm-9\">\n\t\t\t\t<textarea class=\"form-control\" name=\"contact_data[message]\" rows=\"5\"><?php echo htmlspchar($message); ?></textarea>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"btn-area\">\n\t\t\t<button type=\"submit\" name=\"btnSubmit\" class=\"btn btn-success\">\u78ba\u8a8d\u3059\u308b<i class=\"fa fa-arrow-circle-right\"></i></button>\n\t\t\t<input type=\"hidden\" name=\"act\" value=\"2\">\n\t\t</div>\n\t</form>\n\n</div>\n\n<?php\n// \u30d5\u30c3\u30bf\u30fc\u8868\u793a\ngetFooter();\n"], "fixing_code": ["<?php\n/**\n * KobeBeauty PHP Contact Form\n * http://www.kobe-beauty.co.jp/\n *\n * Copyright (c) 2014 Kobe Beauty Co., Ltd.\n * Released under the MIT license\n */\n\n// \u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f\nrequire_once('common/init.php');\n\nglobal $param;\n\n// \u30da\u30fc\u30b8\u30bf\u30a4\u30c8\u30eb\n$param['title'] = '\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9\u306e\u78ba\u8a8d | \u7121\u6599\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9';\n// \u30d1\u30b9\n$param['root_url'] = '';\n\n// \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u53d6\u5f97\n$contact_data = isset($_SESSION[\"contact_data\"]) ? $_SESSION[\"contact_data\"] : array();\n// \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u306e\u6709\u7121\u3092\u30c1\u30a7\u30c3\u30af\nif (count($contact_data) == 0) {\n\theader(\"Location: error.php\"); // \u30c7\u30fc\u30bf\u53d6\u5f97\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u30a8\u30e9\u30fc\u753b\u9762\u3078\u9077\u79fb\n\texit;\n}\n\n$name = isset($contact_data[\"name\"]) ? $contact_data[\"name\"] : \"\";\n$email = isset($contact_data[\"email\"]) ? $contact_data[\"email\"] : \"\";\n$message = isset($contact_data[\"message\"]) ? $contact_data[\"message\"] : \"\";\n\n//\u64cd\u4f5c\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u53d6\u5f97\n$act = isset($_POST[\"act\"]) ? intval($_POST[\"act\"]) : 1;\n\n// \u9001\u4fe1\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3055\u308c\u305f\u5834\u5408\nif ($act == 3) {\n\t// \u30e1\u30fc\u30eb\u9001\u4fe1\n\t$result_to_admin = sendMailtoAdmin($contact_data);\n\t$result_to_customer = sendMailtoCustomer($contact_data);\n\n\n\tif ($result_to_admin && $result_to_customer) { // \u9001\u4fe1\u6210\u529f\n\t\t$_SESSION = array();  // \u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u683c\u7d0d\u3055\u308c\u305f\u60c5\u5831\u3092\u30ab\u30e9\u306b\u3057\u307e\u3059\u3002\n\t\theader(\"Location: done.php\");\n\t\texit;\n\t} else { // \u9001\u4fe1\u5931\u6557\n\t\t$_SESSION = array();  // \u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u683c\u7d0d\u3055\u308c\u305f\u60c5\u5831\u3092\u30ab\u30e9\u306b\u3057\u307e\u3059\u3002\n\t\theader(\"Location: error.php\");\n\t\texit;\n\t}\n}\n\n// \u30d8\u30c3\u30c0\u30fc\u8868\u793a\ngetHeader();\n?>\n\n<h1 class=\"page-header\">\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9\u306e\u78ba\u8a8d</h1>\n\n<div class=\"page-content\">\n\t<p class=\"mb30\">\n\t\t\u3053\u306e\u5185\u5bb9\u3067\u3088\u308d\u3057\u3051\u308c\u3070\u9001\u4fe1\u3059\u308b\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002<br>\n\t\t\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\u306b\u9593\u9055\u3044\u304c\u3042\u308b\u3068\u56de\u7b54\u306e\u8fd4\u4fe1\u304c\u3067\u304d\u307e\u305b\u3093\u306e\u3067\u5341\u5206\u306b\u3054\u78ba\u8a8d\u304f\u3060\u3055\u3044\u3002\n\t</p>\n\n\t<form class=\"form-horizontal\" name=\"contactform\" role=\"form\" method=\"post\" action=\"<?php echo htmlspchar($_SERVER['PHP_SELF']); ?>\">\n\t\t<table class=\"table table-bordered confirm\">\n\t\t\t<tr>\n\t\t\t\t<th>\u304a\u540d\u524d</th>\n\t\t\t\t<td><?php echo htmlspchar($name); ?></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<th>\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9</th>\n\t\t\t\t<td><?php echo htmlspchar($email); ?></td>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<th>\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9</th>\n\t\t\t\t<td><?php echo nl2br(htmlspchar($message)); ?></td>\n\t\t\t</tr>\n\t\t</table>\n\n\t\t<div class=\"btn-area\">\n\t\t\t<button type=\"button\" class=\"btn btn-default\" onclick=\"contactform.action='index.php';contactform.submit();\">\u623b\u308b<i class=\"fa fa-reply\"></i></button>\n\t\t\t<button type=\"submit\" class=\"btn btn-success\">\u9001\u4fe1\u3059\u308b<i class=\"fa fa-envelope-o\"></i></button>\n\t\t\t<input type=\"hidden\" name=\"act\" value=\"3\">\n\t\t</div>\n\t</form>\n\n</div>\n\n<?php\n// \u30d5\u30c3\u30bf\u30fc\u8868\u793a\ngetFooter();\n", "<?php\n/**\n * KobeBeauty PHP Contact Form\n * http://www.kobe-beauty.co.jp/\n *\n * Copyright (c) 2014 Kobe Beauty Co., Ltd.\n * Released under the MIT license\n */\n\n// \u30d5\u30a1\u30a4\u30eb\u8aad\u307f\u8fbc\u307f\nrequire_once('common/init.php');\nrequire_once('common/validate.php');\n\nglobal $param;\n\n// \u30da\u30fc\u30b8\u30bf\u30a4\u30c8\u30eb\n$param['title'] = '\u304a\u554f\u3044\u5408\u308f\u305b | \u7121\u6599\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9';\n// \u30d1\u30b9\n$param['root_url'] = '';\n\n//\u64cd\u4f5c\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u53d6\u5f97\n$act = isset($_POST[\"act\"]) ? intval($_POST[\"act\"]) : 1;\n\n\nif ($act == 1) {\n\t// \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u30af\u30ea\u30a2\n\t$contact_data = array();\n\t// \u521d\u671f\u5024\u30bb\u30c3\u30c8\n\t$err_msg = array();\n\t$name = '';\n\t$email = '';\n\t$message = '';\n\n} elseif ($act == 2) { // \u78ba\u8a8d\u30dc\u30bf\u30f3\u3092\u62bc\u4e0b\u3055\u308c\u305f\u5834\u5408\n\t// POST\u30c7\u30fc\u30bf\u3092\u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u683c\u7d0d\n\t$_SESSION[\"contact_data\"] = isset($_POST[\"contact_data\"]) ? $_POST[\"contact_data\"] : array();\n\t// \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u3092\u914d\u5217\u306b\u30bb\u30c3\u30c8\n\t$contact_data = $_SESSION[\"contact_data\"];\n\t// \u5404\u9805\u76ee\u30c7\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\n\t$name = isset($contact_data[\"name\"]) ? $contact_data[\"name\"] : \"\";\n\t$email = isset($contact_data[\"email\"]) ? $contact_data[\"email\"] : \"\";\n\t$message = isset($contact_data[\"message\"]) ? $contact_data[\"message\"] : \"\";\n\t// \u5165\u529b\u30c1\u30a7\u30c3\u30af\n\t$err_msg = checkInputData($contact_data);\n\tif(!$err_msg){\n\t\theader(\"Location: confirm.php\");\n\t\texit();\n\t}\n\n} else {\n\t// \u30bb\u30c3\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u53d6\u5f97\n\t$contact_data = isset($_SESSION[\"contact_data\"]) ? $_SESSION[\"contact_data\"] : array();\n\t// \u5404\u9805\u76ee\u30c7\u30fc\u30bf\u3092\u30bb\u30c3\u30c8\n\t$name = isset($contact_data[\"name\"]) ? $contact_data[\"name\"] : \"\";\n\t$email = isset($contact_data[\"email\"]) ? $contact_data[\"email\"] : \"\";\n\t$message = isset($contact_data[\"message\"]) ? $contact_data[\"message\"] : \"\";\n}\n\n// \u30d8\u30c3\u30c0\u30fc\u8868\u793a\ngetHeader();\n?>\n\n<h1 class=\"page-header\">\u304a\u554f\u3044\u5408\u308f\u305b</h1>\n\n<?php if (count($err_msg) > 0) { ?>\n<div>\n\t<ul class=\"error\">\n\t\t<?php foreach ($err_msg as $msg) { ?>\n\t\t<li><?php echo $msg; ?></li>\n\t\t<?php } ?>\n\t</ul>\n</div>\n<?php } ?>\n\n<div class=\"page-content\">\n\t<p class=\"mb30\">\u4ee5\u4e0b\u3092\u5165\u529b\u3057\u78ba\u8a8d\u3059\u308b\u30dc\u30bf\u30f3\u3092\u62bc\u3057\u3066\u304f\u3060\u3055\u3044\u3002<span class=\"red\">*</span>\u306f\u5165\u529b\u5fc5\u9808\u3067\u3059\u3002</p>\n\n\t<form class=\"form-horizontal\" name=\"contactform\" role=\"form\" method=\"post\" action=\"<?php echo htmlspchar($_SERVER['PHP_SELF']); ?>\" novalidate>\n\t\t<div class=\"form-group\">\n\t\t\t<label for=\"inputName\" class=\"col-sm-3 control-label\">\u304a\u540d\u524d<span class=\"red\">*</span></label>\n\t\t\t<div class=\"col-sm-9\">\n\t\t\t\t<input type=\"text\" class=\"form-control\" name=\"contact_data[name]\" placeholder=\"\u304a\u540d\u524d\" value=\"<?php echo htmlspchar($name); ?>\">\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"form-group\">\n\t\t\t<label for=\"inputEmail\" class=\"col-sm-3 control-label\">\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9<span class=\"red\">*</span></label>\n\t\t\t<div class=\"col-sm-9\">\n\t\t\t\t<input type=\"email\" class=\"form-control\" name=\"contact_data[email]\" placeholder=\"\u30e1\u30fc\u30eb\u30a2\u30c9\u30ec\u30b9\" value=\"<?php echo htmlspchar($email); ?>\">\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"form-group\">\n\t\t\t<label for=\"inputMessage\" class=\"col-sm-3 control-label\">\u304a\u554f\u3044\u5408\u308f\u305b\u5185\u5bb9<span class=\"red\">*</span></label>\n\t\t\t<div class=\"col-sm-9\">\n\t\t\t\t<textarea class=\"form-control\" name=\"contact_data[message]\" rows=\"5\"><?php echo htmlspchar($message); ?></textarea>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"btn-area\">\n\t\t\t<button type=\"submit\" name=\"btnSubmit\" class=\"btn btn-success\">\u78ba\u8a8d\u3059\u308b<i class=\"fa fa-arrow-circle-right\"></i></button>\n\t\t\t<input type=\"hidden\" name=\"act\" value=\"2\">\n\t\t</div>\n\t</form>\n\n</div>\n\n<?php\n// \u30d5\u30c3\u30bf\u30fc\u8868\u793a\ngetFooter();\n"], "filenames": ["contact/confirm.php", "contact/index.php"], "buggy_code_start_loc": [65, 78], "buggy_code_end_loc": [66, 79], "fixing_code_start_loc": [65, 78], "fixing_code_end_loc": [66, 79], "type": "CWE-79", "message": "Cross-site scripting (XSS) vulnerability in Kobe Beauty php-contact-form before 2016-05-18 allows remote attackers to inject arbitrary web script or HTML via a crafted URI.", "other": {"cve": {"id": "CVE-2016-1222", "sourceIdentifier": "vultures@jpcert.or.jp", "published": "2016-06-05T01:59:01.967", "lastModified": "2020-05-12T12:43:13.063", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in Kobe Beauty php-contact-form before 2016-05-18 allows remote attackers to inject arbitrary web script or HTML via a crafted URI."}, {"lang": "es", "value": "Vulnerabilidad de XSS en Kobe Beauty php-contact-form en versiones anteriores a 2016-05-18 permite a atacantes remotos inyectar secuencias de comandos web o HTML arbitrarios a trav\u00e9s de un URI manipulado."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kobe-beauty:php-contact-form:*:*:*:*:*:*:*:*", "versionEndExcluding": "2016-05-18", "matchCriteriaId": "78B6F544-0283-4B79-BD6A-1C6E0BFEE2F4"}]}]}], "references": [{"url": "http://jvn.jp/en/jp/JVN85112513/index.html", "source": "vultures@jpcert.or.jp", "tags": ["Vendor Advisory"]}, {"url": "http://jvndb.jvn.jp/jvndb/JVNDB-2016-000070", "source": "vultures@jpcert.or.jp", "tags": ["Third Party Advisory", "VDB Entry", "Vendor Advisory"]}, {"url": "http://www.kobe-beauty.co.jp/php-contact-form/", "source": "vultures@jpcert.or.jp", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/kobebeauty/php-contact-form/commit/e7d094ca8ab15215c32d6fa04d17e8519c8d21cf", "source": "vultures@jpcert.or.jp", "tags": ["Patch"]}]}, "github_commit_url": "https://github.com/kobebeauty/php-contact-form/commit/e7d094ca8ab15215c32d6fa04d17e8519c8d21cf"}}