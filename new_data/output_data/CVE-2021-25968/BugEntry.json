{"buggy_code": ["<%@page\n    pageEncoding=\"UTF-8\"\n    buffer=\"none\"\n    session=\"false\"\n    trimDirectiveWhitespaces=\"true\"%>\n\n<%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\" %>\n<%@ taglib prefix=\"cms\" uri=\"http://www.opencms.org/taglib/cms\"%>\n<%@ taglib prefix=\"fn\" uri=\"http://java.sun.com/jsp/jstl/functions\"%>\n<%@ taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\"%>\n<%@ taglib prefix=\"mercury\" tagdir=\"/WEB-INF/tags/mercury\" %>\n\n<mercury:init-messages>\n\n<cms:formatter var=\"content\" val=\"value\">\n\n<c:set var=\"setting\"                    value=\"${cms.element.setting}\" />\n<c:set var=\"cssWrapper\"                 value=\"${setting.cssWrapper}\" />\n<c:set var=\"cssVisibility\"              value=\"${setting.cssVisibility.toString != 'always' ? setting.cssVisibility.toString : ''}\" />\n<c:set var=\"breadcrumbsIncludeHidden\"   value=\"${setting.breadcrumbsIncludeHidden.toBoolean}\" />\n<c:set var=\"breadcrumbsFullPath\"        value=\"${setting.breadcrumbsFullPath.toBoolean}\" />\n<c:set var=\"breadcrumbsFromRoot\"        value=\"${setting.breadcrumbsFromRoot.toBoolean}\" />\n\n<mercury:nl />\n<div class=\"element type-nav-breadcrumbs ${cssWrapper}${' '}${cssVisibility}\"><%----%>\n<mercury:nl />\n\n    <mercury:nav-vars params=\"${param}\">\n        <mercury:nav-items\n            type=\"${breadcrumbsFromRoot ? 'rootBreadCrumb' : 'breadCrumb'}\"\n            content=\"${content}\"\n            currentPageFolder=\"${currentPageFolder}\"\n            currentPageUri=\"${currentPageUri}\" >\n\n            <ul class=\"nav-breadcrumbs\"><%----%>\n                <mercury:nl />\n                <c:set var=\"currNavPos\" value=\"1\" />\n\n                <cms:jsonarray var=\"breadCrumbJson\">\n\n                    <c:forEach var=\"navElem\" items=\"${navItems}\" varStatus=\"status\">\n                        <c:if test=\"${\n                            ((breadcrumbsIncludeHidden or (status.last and not cms.detailRequest)) and (navElem.navPosition > 0))\n                            or (navElem.info ne 'ignoreInDefaultNav')}\">\n                            <c:set var=\"navText\" value=\"${(empty navElem.navText or fn:startsWith(navElem.navText, '???'))\n                                ? navElem.title : navElem.navText}\" />\n                            <c:if test=\"${!empty navText}\">\n                                <c:set var=\"navLink\"><cms:link>${navElem.resourceName}</cms:link></c:set>\n                                <c:if test=\"${breadcrumbsFullPath or (navLink ne lastNavLink)}\">\n                                    <c:set var=\"lastNavLink\" value=\"${navLink}\" />\n                                    <c:out value='<li><a href=\"${navLink}\">' escapeXml=\"false\" />\n                                    <c:out value='${navText}' escapeXml=\"true\" />\n                                    <c:out value='</a></li>' escapeXml=\"false\" />\n                                    <mercury:nl />\n\n                                    <cms:jsonobject>\n                                        <cms:jsonvalue key=\"@type\" value=\"ListItem\" />\n                                        <cms:jsonvalue key=\"position\" value=\"${currNavPos}\" />\n                                        <cms:jsonvalue key=\"name\" value=\"${navText}\" />\n                                        <cms:jsonvalue key=\"item\" value=\"${cms.site.url}${navLink}\" />\n                                    </cms:jsonobject>\n\n                                    <c:set var=\"currNavPos\" value=\"${currNavPos + 1}\" />\n                                </c:if>\n                            </c:if>\n                        </c:if>\n                    </c:forEach>\n\n                    <c:if test=\"${cms.detailRequest}\">\n                        <c:set var=\"navLink\"><cms:link>${cms.detailContent.sitePath}?${pageContext.request.queryString}</cms:link></c:set>\n                        <c:set var=\"navText\"><mercury:meta-title addIntro=\"${true}\" /></c:set>\n\n                        <c:out value='<li><a href=\"${navLink}\">' escapeXml=\"false\" />\n                        <c:out value='${navText}' escapeXml=\"true\" />\n                        <c:out value='</a></li>' escapeXml=\"false\" />\n\n                        <cms:jsonobject>\n                            <cms:jsonvalue key=\"@type\" value=\"ListItem\" />\n                            <cms:jsonvalue key=\"position\" value=\"${currNavPos}\" />\n                            <cms:jsonobject key=\"item\">\n                                <cms:jsonvalue key=\"@id\" value=\"${cms.site.url}${navLink}\" />\n                                <cms:jsonvalue key=\"name\" value=\"${navText}\" />\n                            </cms:jsonobject>\n                        </cms:jsonobject>\n\n                    </c:if>\n\n                </cms:jsonarray>\n\n                <c:if test=\"${(empty breadCrumbJson) or cms.modelGroupPage}\">\n                    <li><mercury:meta-title addIntro=\"${true}\" /></li><%----%>\n                </c:if>\n            </ul><%----%>\n            <mercury:nl />\n\n            <c:if test=\"${not empty breadCrumbJson}\">\n                <cms:jsonobject var=\"jsonLd\">\n                    <cms:jsonvalue key=\"@context\" value=\"http://schema.org\" />\n                    <cms:jsonvalue key=\"@type\" value=\"BreadcrumbList\" />\n                    <cms:jsonvalue key=\"itemListElement\" value=\"${breadCrumbJson.json}\" />\n                </cms:jsonobject>\n                <script type=\"application/ld+json\">${jsonLd.compact}</script><%----%>\n                <mercury:nl />\n            </c:if>\n\n        </mercury:nav-items>\n    </mercury:nav-vars>\n\n</div><%----%>\n<mercury:nl />\n\n</cms:formatter>\n</mercury:init-messages>", "<%@page\n    pageEncoding=\"UTF-8\"\n    buffer=\"none\"\n    session=\"false\"\n    trimDirectiveWhitespaces=\"true\"%>\n\n<%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\" %>\n<%@ taglib prefix=\"cms\" uri=\"http://www.opencms.org/taglib/cms\"%>\n<%@ taglib prefix=\"fn\" uri=\"http://java.sun.com/jsp/jstl/functions\"%>\n<%@ taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\"%>\n<%@ taglib prefix=\"mercury\" tagdir=\"/WEB-INF/tags/mercury\" %>\n\n<mercury:init-messages>\n\n<fmt:setLocale value=\"${cms.locale}\" />\n<cms:bundle basename=\"alkacon.mercury.template.messages\">\n\n<cms:formatter var=\"content\" val=\"value\">\n\n<c:set var=\"setting\"                    value=\"${cms.element.setting}\" />\n<c:set var=\"cssWrapper\"                 value=\"${setting.cssWrapper}\" />\n<c:set var=\"showSearch\"                 value=\"${setting.showSearch.useDefault(true).toBoolean}\" />\n<c:set var=\"textDisplay\"                value=\"${setting.textDisplay.useDefault('cap-css').toString}\" />\n<c:set var=\"metaLinks\"                  value=\"${setting.metaLinks.useDefault('top').toString}\" />\n<c:set var=\"showImageLink\"              value=\"${setting.showImageLink.useDefault(false).toBoolean}\" />\n\n<c:set var=\"temlateVariant\"             value=\"${cms.sitemapConfig.attribute['template.variant'].useDefault('default').toString}\" />\n\n<c:set var=\"searchPageUrl\" value=\"${cms.functionDetail['Search page']}\" />\n<c:set var=\"showSearch\" value=\"${showSearch and not fn:startsWith(searchPageUrl,'[')}\" />\n\n<c:set var=\"logoElements\" value=\"${cms.elementsInContainers['header-image']}\" />\n<c:if test=\"${not empty logoElements}\">\n    <c:set var=\"logoContent\" value=\"${logoElements.get(0).toXml}\" />\n    <c:set var=\"logoImage\" value=\"${logoContent.value.Image}\" />\n</c:if>\n\n<nav class=\"nav-main-group ${logoImage.value.Image.isSet ? 'has-sidelogo ' : ''}${cssWrapper}\"><%----%>\n\n    <mercury:nav-vars params=\"${param}\">\n    <mercury:nav-items\n        type=\"forSite\"\n        content=\"${content}\"\n        currentPageFolder=\"${currentPageFolder}\"\n        currentPageUri=\"${currentPageUri}\">\n\n        <c:choose>\n            <c:when test=\"${empty logoImage}\">\n                <%-- Do not generate markup if there is no image --%>\n            </c:when>\n            <c:when test=\"${temlateVariant eq 'burger'}\">\n                <div class=\"nav-menu-header\"><%----%>\n                    <div class=\"nav-menu-toggle\"><%----%>\n                        <label for=\"nav-toggle-check\" id=\"nav-toggle-label-close\" class=\"nav-toggle-label\"><%----%>\n                            <span class=\"nav-toggle\"><%----%>\n                                <span><fmt:message key=\"msg.page.navigation.toggle\" /></span><%----%>\n                            </span><%----%>\n                        </label><%----%>\n                    </div><%----%>\n                    <div class=\"nav-menu-logo\"><%----%>\n                        <mercury:link\n                            link=\"${logoContent.value.Link}\"\n                            test=\"${showImageLink}\"\n                            testFailTag=\"div\"\n                            setTitle=\"${true}\"\n                            css=\"mobile-logolink\" >\n                            <mercury:image-simple\n                                image=\"${logoImage}\"\n                                sizes=\"200,350,400,700,800\"\n                                cssWrapper=\"img-responsive\"\n                                title=\"${imageTitleCopyright}\"\n                            />\n                        </mercury:link>\n                    </div><%----%>\n                </div>\n            </c:when>\n            <c:otherwise>\n                <div class=\"nav-main-mobile-logo\"><%----%>\n                    <mercury:link\n                        link=\"${logoContent.value.Link}\"\n                        test=\"${showImageLink}\"\n                        testFailTag=\"div\"\n                        setTitle=\"${true}\"\n                        css=\"mobile-logolink\" >\n                        <mercury:image-simple\n                            image=\"${logoImage}\"\n                            sizes=\"100,200,400,800\"\n                            cssWrapper=\"img-responsive\"\n                            title=\"${imageTitleCopyright}\"\n                        />\n\n                    </mercury:link>\n                </div><%----%>\n            </c:otherwise>\n        </c:choose>\n\n        <mercury:nl />\n        <ul class=\"nav-main-items ${textDisplay}${' '}${not empty sidelogohtml ? 'hassidelogo ' : ''}${showSearch ? 'has-search' : 'no-search'}\"><%----%>\n        <mercury:nl />\n\n        <c:if test=\"${metaLinks ne 'none'}\">\n            <c:set var=\"metaLinkElements\" value=\"${cms.elementsInContainers['header-linksequence']}\" />\n            <c:if test=\"${not empty metaLinkElements}\">\n                <c:set var=\"metaLinksHtml\">\n                    <c:set var=\"metaLinksequence\" value=\"${metaLinkElements.get(0).toXml}\" />\n                    <li id=\"nav-main-addition\" aria-expanded=\"false\" class=\"hidden-lg hidden-xl\"><%----%>\n                        <a href=\"#\" title=\"Search\" aria-controls=\"nav_nav-main-addition\" id=\"label_nav-main-addition\">${metaLinksequence.value.Title}</a><%----%>\n                        <ul class=\"nav-menu\" id=\"nav_nav-main-addition\" aria-labelledby=\"label_nav-main-addition\"><%----%>\n                            <mercury:nl />\n                            <c:forEach var=\"link\" items=\"${metaLinksequence.valueList.LinkEntry}\" varStatus=\"status\">\n                                <c:set var=\"linkText\" value=\"${link.value.Text}\" />\n                                <c:if test=\"${fn:startsWith(linkText, 'icon:')}\">\n                                    <c:set var=\"linkText\"><span class=\"fa fa-${fn:substringAfter(linkText, 'icon:')}\"></span></c:set>\n                                </c:if>\n                                <li><mercury:link link=\"${link}\">${linkText}</mercury:link></li><mercury:nl />\n                            </c:forEach>\n                        </ul><%----%>\n                    </li><%----%>\n                </c:set>\n            </c:if>\n        </c:if>\n        <c:if test=\"${not empty metaLinksHtml and metaLinks ne 'bottom'}\">\n            ${metaLinksHtml}\n        </c:if>\n\n        <c:set var=\"navLength\" value=\"${empty navItems ? 0 : fn:length(navItems) - 1}\" />\n        <c:forEach var=\"i\" begin=\"0\" end=\"${navLength}\" >\n\n            <c:set var=\"navElem\" value=\"${navItems[i]}\" />\n            <c:set var=\"nextLevel\" value=\"${i < navLength ? navItems[i+1].navTreeLevel : navStartLevel}\" />\n            <c:set var=\"startSubMenu\" value=\"${nextLevel > navElem.navTreeLevel}\" />\n            <c:set var=\"isTopLevel\" value=\"${navElem.navTreeLevel eq navStartLevel}\" />\n            <c:set var=\"nextIsTopLevel\" value=\"${nextLevel eq navStartLevel}\" />\n            <c:set var=\"navTarget\" value=\"${fn:trim(navElem.info)eq 'extern' ? ' target=\\\"_blank\\\"' : ''}\" />\n\n            <c:set var=\"isCurrentPage\" value=\"${fn:startsWith(currentPageUri, cms.sitePath[navElem.resource.rootPath])}\" />\n            <c:set var=\"isFinalCurrentPage\" value=\"${isCurrentPage and currentPageFolder eq cms.sitePath[navElem.resource.rootPath]}\" />\n\n            <c:set var=\"menuType\" value=\"${isCurrentPage ? 'active ' : ''}\" />\n            <c:set var=\"menuType\" value=\"${isFinalCurrentPage ? menuType.concat('final ') : menuType}\" />\n            <c:set var=\"menuType\" value=\"${i == 0 ? menuType.concat('nav-first ') : menuType}\" />\n            <c:set var=\"menuType\" value=\"${i == navLength ? menuType.concat('nav-last ') : menuType}\" />\n\n            <%-- ###### Check for mega menu ######--%>\n            <c:set var=\"megaMenu\" value=\"\" />\n            <c:if test=\"${isTopLevel}\">\n                <c:set var=\"megaMenuVfsPath\" value=\"${navElem.resourceName}mega.menu\" />\n                <c:if test=\"${navElem.navigationLevel}\">\n                    <%-- ###### Path correction needed if navLevel ###### --%>\n                    <c:set var=\"megaMenuVfsPath\" value=\"${fn:replace(megaMenuVfsPath, navElem.fileName, '')}\" />\n                </c:if>\n                <c:set var=\"megaMenuRes\" value=\"${cms.vfs.xml[megaMenuVfsPath]}\" />\n                <c:if test=\"${not empty megaMenuRes}\">\n                    <c:set var=\"megaMenu\" value=' data-megamenu=\"${megaMenuRes.resource.link}\"' />\n                    <c:set var=\"menuType\" value=\"${menuType.concat('mega')}\" />\n                    <c:choose>\n                        <c:when test=\"${megaMenuRes.resource.property['mercury.mega.display'] eq 'mobile'}\">\n                            <c:set var=\"menuType\" value=\"${menuType.concat(' mega-mobile')}\" />\n                        </c:when>\n                        <c:when test=\"${not startSubMenu}\">\n                            <c:set var=\"menuType\" value=\"${menuType.concat(' mega-only')}\" />\n                        </c:when>\n                    </c:choose>\n                </c:if>\n            </c:if>\n            <c:set var=\"hasMegaMenu\" value=\"${not empty megaMenu}\" />\n\n            <c:if test=\"${startSubMenu or hasMegaMenu}\">\n                <c:set var=\"instanceId\"><mercury:idgen prefix=\"\" uuid=\"${cms.element.instanceId}\" /></c:set>\n                <c:set var=\"parentLabelId\">label${instanceId}_${i}</c:set>\n                <c:set var=\"targetMenuId\">nav${instanceId}_${i}</c:set>\n                <c:if test=\"${startSubMenu}\">\n                    <c:set var=\"lastNavLevel\" value=\"${navElem}\" />\n                </c:if>\n            </c:if>\n\n            <c:choose>\n                <c:when test=\"${(not empty lastNavLevel) and fn:startsWith(navElem.info, '#')}\">\n                    <c:set var=\"navLink\"><cms:link>${lastNavLevel.resourceName}${navElem.info}</cms:link></c:set>\n                </c:when>\n                <c:otherwise>\n                    <c:set var=\"navLink\"><cms:link>${navElem.resourceName}</cms:link></c:set>\n                </c:otherwise>\n            </c:choose>\n\n            <c:set var=\"menuType\" value=\"${empty menuType ? '' : ' class=\\\"'.concat(menuType).concat('\\\"')}\" />\n            <c:set var=\"menuType\" value=\"${startSubMenu or hasMegaMenu ? menuType.concat(' aria-expanded=\\\"false\\\"') : menuType}\" />\n\n            <c:out value='<li${menuType}${megaMenu}>${empty menuType ? \"\" : nl}' escapeXml=\"false\" />\n\n            <c:set var=\"navText\" value=\"${(empty navElem.navText or fn:startsWith(navElem.navText, '???'))\n                ? navElem.title : navElem.navText}\" />\n\n            <c:choose>\n\n                <c:when test=\"${startSubMenu and not navElem.navigationLevel}\">\n                    <%-- Navigation item with sub-menu and direct child pages --%>\n                    <a href=\"${navLink}\"${navTarget} class=\"nav-label\" id=\"${parentLabelId}\">${navText}</a><%----%>\n                    <a href=\"${navLink}\"${navTarget} aria-controls=\"${targetMenuId}\" aria-label=\"<fmt:message key=\"msg.page.navigation.sublevel\" />\">&nbsp;</a><%----%>\n                </c:when>\n\n                <c:when test=\"${startSubMenu}\">\n                    <%-- Navigation item with sub-menu but without direct child pages --%>\n                    <a href=\"${navLink}\"${navTarget}${' '}<%--\n                    --%>id=\"${parentLabelId}\"${' '}<%--\n                    --%>aria-controls=\"${targetMenuId}\">${navText}</a><%----%>\n                </c:when>\n\n                <c:otherwise>\n                    <%--Navigation item without sub-menu --%>\n                    <a href=\"${navLink}\"${navTarget}<%----%>\n                    <c:if test=\"${hasMegaMenu}\">\n                        <%-- mega menu requires aria-controls - will be removed by JavaScript if mega menu is not displayed in mobile --%>\n                        ${' '}aria-controls=\"${targetMenuId}\"<%----%>\n                    </c:if>\n                    ${'>'}${navText}</a><%----%>\n                </c:otherwise>\n            </c:choose>\n\n            <c:choose>\n                <c:when test=\"${startSubMenu}\">\n                   <c:out value='${nl}<ul class=\"nav-menu\" id=\"${targetMenuId}\" aria-labelledby=\"${parentLabelId}\">${nl}' escapeXml=\"false\" />\n                </c:when>\n                <c:when test=\"${hasMegaMenu}\">\n                   <c:out value='${nl}<ul class=\"nav-menu\" id=\"${targetMenuId}\" aria-labelledby=\"${parentLabelId}\"></ul>' escapeXml=\"false\" />\n                </c:when>\n            </c:choose>\n\n            <c:if test=\"${nextLevel < navElem.navTreeLevel}\">\n                <c:forEach begin=\"1\" end=\"${navElem.navTreeLevel - nextLevel}\" >\n                    <c:out value='</li>${nl}</ul>${nl}' escapeXml=\"false\" />\n                </c:forEach>\n            </c:if>\n\n            <c:if test=\"${not startSubMenu}\"><c:out value='</li>${nl}' escapeXml=\"false\" /></c:if>\n\n        </c:forEach>\n\n        <c:if test=\"${not empty metaLinksHtml and metaLinks eq 'bottom'}\">\n            ${metaLinksHtml}\n        </c:if>\n\n        <c:if test=\"${showSearch}\">\n            <li id=\"nav-main-search\" aria-expanded=\"false\"><%----%>\n                <a href=\"#\" title=\"Search\" aria-controls=\"nav_nav-main-search\" id=\"label_nav-main-search\"><%----%>\n                    <span class=\"search search-btn fa fa-search\"></span><%----%>\n                </a><%----%>\n                <ul class=\"nav-menu\" id=\"nav_nav-main-search\" aria-labelledby=\"label_nav-main-search\"><%----%>\n                    <li><%----%>\n                        <div class=\"styled-form search-form\"><%----%>\n                            <form action=\"${searchPageUrl}\" method=\"post\"><%----%>\n                                <div class=\"input button\"><%----%>\n                                    <label for=\"searchNavQuery\" class=\"sr-only\">Search</label><%----%>\n                                    <input id=\"searchNavQuery\" name=\"q\" type=\"text\" class=\"blur-focus\" autocomplete=\"off\" placeholder='<fmt:message key=\"msg.page.search.enterquery\" />' /><%----%>\n                                    <button class=\"btn\" type=\"button\" onclick=\"this.form.submit(); return false;\"><fmt:message key=\"msg.page.search.submit\" /></button><%----%>\n                                </div><%----%>\n                            </form><%----%>\n                        </div><%----%>\n                    </li><%----%>\n                </ul><%----%>\n            </li><%----%>\n        </c:if>\n\n        <mercury:nl />\n        </ul><%----%>\n        <mercury:nl />\n\n    </mercury:nav-items>\n    </mercury:nav-vars>\n\n</nav><%----%>\n\n</cms:formatter>\n</cms:bundle>\n</mercury:init-messages>", "<%@page\n    pageEncoding=\"UTF-8\"\n    buffer=\"none\"\n    session=\"false\"\n    trimDirectiveWhitespaces=\"true\"%>\n\n<%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\" %>\n<%@ taglib prefix=\"cms\" uri=\"http://www.opencms.org/taglib/cms\"%>\n<%@ taglib prefix=\"fn\" uri=\"http://java.sun.com/jsp/jstl/functions\"%>\n<%@ taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\"%>\n<%@ taglib prefix=\"mercury\" tagdir=\"/WEB-INF/tags/mercury\" %>\n\n<mercury:init-messages>\n\n<fmt:setLocale value=\"${cms.locale}\" />\n<cms:bundle basename=\"alkacon.mercury.template.messages\">\n\n<cms:formatter var=\"content\" val=\"value\">\n\n<c:set var=\"setting\"                value=\"${cms.element.setting}\" />\n<c:set var=\"cssWrapper\"             value=\"${setting.cssWrapper}\" />\n<c:set var=\"hsize\"                  value=\"${setting.hsize.toInteger}\" />\n<c:set var=\"cssVisibility\"          value=\"${setting.cssVisibility.toString != 'always' ? setting.cssVisibility.toString : ''}\" />\n<c:set var=\"ade\"                    value=\"${cms.isEditMode}\" />\n\n<mercury:nl />\n\n<mercury:nav-vars params=\"${param}\">\n<mercury:nav-items\n    type=\"forSite\"\n    content=\"${content}\"\n    currentPageFolder=\"${currentPageFolder}\"\n    currentPageUri=\"${currentPageUri}\" >\n\n    <%-- If no navigation items are found, no output must be generated online --%>\n\n    <div class=\"element type-nav-side ${cssWrapper}${' '}${cssVisibility}\"><%----%>\n    <mercury:nl />\n\n        <mercury:heading level=\"${hsize}\" text=\"${value.Title}\" css=\"heading\" ade=\"${ade}\" />\n\n        <c:set var=\"navLength\" value=\"${empty navItems ? 0 : fn:length(navItems) - 1}\" />\n        <ul class=\"nav-side\"><%----%>\n            <mercury:nl />\n            <c:forEach var=\"i\" begin=\"0\" end=\"${navLength}\" >\n\n                <c:set var=\"navElem\" value=\"${navItems[i]}\" />\n                <c:set var=\"nextLevel\" value=\"${i < navLength ? navItems[i+1].navTreeLevel : navStartLevel}\" />\n                <c:set var=\"startSubMenu\" value=\"${nextLevel > navElem.navTreeLevel}\" />\n                <c:set var=\"isCurrentPage\" value=\"${fn:startsWith(currentPageUri, cms.sitePath[navElem.resource.rootPath])}\" />\n                <c:set var=\"isFinalCurrentPage\" value=\"${isCurrentPage and currentPageFolder eq cms.sitePath[navElem.resource.rootPath]}\" />\n                <c:set var=\"navTarget\" value=\"${fn:trim(navElem.info) eq 'extern' ? ' target=\\\"_blank\\\"' : ''}\" />\n\n                <c:if test=\"${startSubMenu}\">\n                    <c:set var=\"instanceId\"><mercury:idgen prefix=\"\" uuid=\"${cms.element.instanceId}\" /></c:set>\n                    <c:set var=\"parentLabelId\">label${instanceId}_${i}</c:set>\n                    <c:set var=\"targetMenuId\">nav${instanceId}_${i}</c:set>\n                    <c:set var=\"lastNavLevel\" value=\"${navElem}\" />\n                </c:if>\n\n                <c:choose>\n                    <c:when test=\"${(not empty lastNavLevel) and fn:startsWith(navElem.info, '#')}\">\n                        <c:set var=\"navLink\"><cms:link>${lastNavLevel.resourceName}${navElem.info}</cms:link></c:set>\n                    </c:when>\n                    <c:otherwise>\n                        <c:set var=\"navLink\"><cms:link>${navElem.resourceName}</cms:link></c:set>\n                    </c:otherwise>\n                </c:choose>\n\n                <c:set var=\"navText\" value=\"${(empty navElem.navText or fn:startsWith(navElem.navText, '???')) ? navElem.title : navElem.navText}\" />\n\n                <c:set var=\"menuType\" value=\"${startSubMenu ? menuType.concat(' aria-expanded=\\\"false\\\"') : menuType}\" />\n\n                <c:out value=\"<li${isCurrentPage ? ' class=\\\"currentpage'.concat(isFinalCurrentPage ? ' final\\\"' : '\\\"') : ''}>\" escapeXml=\"false\" />\n\n                <c:choose>\n                    <c:when test=\"${startSubMenu and navElem.navigationLevel}\">\n                        <%-- Navigation item with sub-menu but without direct child pages --%>\n                        <a href=\"${navLink}\"${navTarget}${' '}<%--\n                        --%>id=\"${parentLabelId}\"${' '}<%--\n                        --%>${isCurrentPage ? 'aria-expanded=\\\"true\\\" class=\\\"collapse show\\\"' : 'aria-expanded=\\\"false\\\"'}${' '}<%--\n                        --%>data-toggle=\"collapse\" data-target=\"#${targetMenuId}\"${' '}<%--\n                        --%>aria-controls=\"${targetMenuId}\">${navText}</a><%--\n                --%></c:when>\n\n                    <c:when test=\"${startSubMenu}\">\n                        <%-- Navigation item with sub-menu and direct child pages --%>\n                        <a href=\"${navLink}\"${navTarget} class=\"nav-label\" id=\"${parentLabelId}\">${navText}</a><%--\n                        --%><a href=\"${navLink}\"${navTarget} data-toggle=\"collapse\" data-target=\"#${targetMenuId}\"${' '}<%--\n                        --%>${isCurrentPage ? 'aria-expanded=\\\"true\\\" class=\\\"collapse show\\\"' : 'aria-expanded=\\\"false\\\"'}${' '}<%--\n                        --%>aria-controls=\"${targetMenuId}\" aria-label=\"<fmt:message key=\"msg.page.navigation.sublevel\" />\">&nbsp;</a><%--\n                --%></c:when>\n\n                    <c:otherwise>\n                        <%--Navigation item without sub-menu --%>\n                        <a href=\"${navLink}\"${navTarget}>${navText}</a><%--\n                --%></c:otherwise>\n                </c:choose>\n\n                <c:if test=\"${startSubMenu}\">\n                   <c:set var=\"collapseIn\" value=\"${isCurrentPage ? ' show' : ''}\" />\n                   <mercury:nl />\n                   <c:out value='<ul class=\"collapse${collapseIn}\" id=\"${targetMenuId}\">' escapeXml=\"false\" />\n                </c:if>\n\n                <c:if test=\"${nextLevel < navElem.navTreeLevel}\">\n                    <c:forEach begin=\"1\" end=\"${navElem.navTreeLevel - nextLevel}\" >\n                        <c:out value='</li></ul>' escapeXml=\"false\" />\n                        <mercury:nl />\n                    </c:forEach>\n                </c:if>\n\n                <c:if test=\"${not startSubMenu}\">\n                    <c:out value='</li>' escapeXml=\"false\" />\n                    <mercury:nl />\n                </c:if>\n\n            </c:forEach>\n        </ul><%----%>\n        <mercury:nl />\n\n    </div><%----%>\n\n</mercury:nav-items>\n</mercury:nav-vars>\n\n<mercury:nl />\n\n</cms:formatter>\n</cms:bundle>\n</mercury:init-messages>"], "fixing_code": ["<%@page\n    pageEncoding=\"UTF-8\"\n    buffer=\"none\"\n    session=\"false\"\n    trimDirectiveWhitespaces=\"true\"%>\n\n<%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\" %>\n<%@ taglib prefix=\"cms\" uri=\"http://www.opencms.org/taglib/cms\"%>\n<%@ taglib prefix=\"fn\" uri=\"http://java.sun.com/jsp/jstl/functions\"%>\n<%@ taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\"%>\n<%@ taglib prefix=\"mercury\" tagdir=\"/WEB-INF/tags/mercury\" %>\n\n<mercury:init-messages>\n\n<cms:formatter var=\"content\" val=\"value\">\n\n<c:set var=\"setting\"                    value=\"${cms.element.setting}\" />\n<c:set var=\"cssWrapper\"                 value=\"${setting.cssWrapper}\" />\n<c:set var=\"cssVisibility\"              value=\"${setting.cssVisibility.toString != 'always' ? setting.cssVisibility.toString : ''}\" />\n<c:set var=\"breadcrumbsIncludeHidden\"   value=\"${setting.breadcrumbsIncludeHidden.toBoolean}\" />\n<c:set var=\"breadcrumbsFullPath\"        value=\"${setting.breadcrumbsFullPath.toBoolean}\" />\n<c:set var=\"breadcrumbsFromRoot\"        value=\"${setting.breadcrumbsFromRoot.toBoolean}\" />\n\n<mercury:nl />\n<div class=\"element type-nav-breadcrumbs ${cssWrapper}${' '}${cssVisibility}\"><%----%>\n<mercury:nl />\n\n    <mercury:nav-vars params=\"${param}\">\n        <mercury:nav-items\n            type=\"${breadcrumbsFromRoot ? 'rootBreadCrumb' : 'breadCrumb'}\"\n            content=\"${content}\"\n            currentPageFolder=\"${currentPageFolder}\"\n            currentPageUri=\"${currentPageUri}\" >\n\n            <ul class=\"nav-breadcrumbs\"><%----%>\n                <mercury:nl />\n                <c:set var=\"currNavPos\" value=\"1\" />\n\n                <cms:jsonarray var=\"breadCrumbJson\">\n\n                    <c:forEach var=\"navElem\" items=\"${navItems}\" varStatus=\"status\">\n                        <c:if test=\"${\n                            ((breadcrumbsIncludeHidden or (status.last and not cms.detailRequest)) and (navElem.navPosition > 0))\n                            or (navElem.info ne 'ignoreInDefaultNav')}\">\n                            <c:set var=\"navText\"><c:out value=\"${(empty navElem.navText or fn:startsWith(navElem.navText, '???'))\n                                ? navElem.title : navElem.navText}\" /></c:set>\n                            <c:if test=\"${!empty navText}\">\n                                <c:set var=\"navLink\"><cms:link>${navElem.resourceName}</cms:link></c:set>\n                                <c:if test=\"${breadcrumbsFullPath or (navLink ne lastNavLink)}\">\n                                    <c:set var=\"lastNavLink\" value=\"${navLink}\" />\n                                    <c:out value='<li><a href=\"${navLink}\">' escapeXml=\"false\" />\n                                    <c:out value='${navText}' escapeXml=\"true\" />\n                                    <c:out value='</a></li>' escapeXml=\"false\" />\n                                    <mercury:nl />\n\n                                    <cms:jsonobject>\n                                        <cms:jsonvalue key=\"@type\" value=\"ListItem\" />\n                                        <cms:jsonvalue key=\"position\" value=\"${currNavPos}\" />\n                                        <cms:jsonvalue key=\"name\" value=\"${navText}\" />\n                                        <cms:jsonvalue key=\"item\" value=\"${cms.site.url}${navLink}\" />\n                                    </cms:jsonobject>\n\n                                    <c:set var=\"currNavPos\" value=\"${currNavPos + 1}\" />\n                                </c:if>\n                            </c:if>\n                        </c:if>\n                    </c:forEach>\n\n                    <c:if test=\"${cms.detailRequest}\">\n                        <c:set var=\"navLink\"><cms:link>${cms.detailContent.sitePath}?${pageContext.request.queryString}</cms:link></c:set>\n                        <c:set var=\"navText\"><mercury:meta-title addIntro=\"${true}\" /></c:set>\n\n                        <c:out value='<li><a href=\"${navLink}\">' escapeXml=\"false\" />\n                        <c:out value='${navText}' escapeXml=\"true\" />\n                        <c:out value='</a></li>' escapeXml=\"false\" />\n\n                        <cms:jsonobject>\n                            <cms:jsonvalue key=\"@type\" value=\"ListItem\" />\n                            <cms:jsonvalue key=\"position\" value=\"${currNavPos}\" />\n                            <cms:jsonobject key=\"item\">\n                                <cms:jsonvalue key=\"@id\" value=\"${cms.site.url}${navLink}\" />\n                                <cms:jsonvalue key=\"name\" value=\"${navText}\" />\n                            </cms:jsonobject>\n                        </cms:jsonobject>\n\n                    </c:if>\n\n                </cms:jsonarray>\n\n                <c:if test=\"${(empty breadCrumbJson) or cms.modelGroupPage}\">\n                    <li><mercury:meta-title addIntro=\"${true}\" /></li><%----%>\n                </c:if>\n            </ul><%----%>\n            <mercury:nl />\n\n            <c:if test=\"${not empty breadCrumbJson}\">\n                <cms:jsonobject var=\"jsonLd\">\n                    <cms:jsonvalue key=\"@context\" value=\"http://schema.org\" />\n                    <cms:jsonvalue key=\"@type\" value=\"BreadcrumbList\" />\n                    <cms:jsonvalue key=\"itemListElement\" value=\"${breadCrumbJson.json}\" />\n                </cms:jsonobject>\n                <script type=\"application/ld+json\">${jsonLd.compact}</script><%----%>\n                <mercury:nl />\n            </c:if>\n\n        </mercury:nav-items>\n    </mercury:nav-vars>\n\n</div><%----%>\n<mercury:nl />\n\n</cms:formatter>\n</mercury:init-messages>", "<%@page\n    pageEncoding=\"UTF-8\"\n    buffer=\"none\"\n    session=\"false\"\n    trimDirectiveWhitespaces=\"true\"%>\n\n<%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\" %>\n<%@ taglib prefix=\"cms\" uri=\"http://www.opencms.org/taglib/cms\"%>\n<%@ taglib prefix=\"fn\" uri=\"http://java.sun.com/jsp/jstl/functions\"%>\n<%@ taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\"%>\n<%@ taglib prefix=\"mercury\" tagdir=\"/WEB-INF/tags/mercury\" %>\n\n<mercury:init-messages>\n\n<fmt:setLocale value=\"${cms.locale}\" />\n<cms:bundle basename=\"alkacon.mercury.template.messages\">\n\n<cms:formatter var=\"content\" val=\"value\">\n\n<c:set var=\"setting\"                    value=\"${cms.element.setting}\" />\n<c:set var=\"cssWrapper\"                 value=\"${setting.cssWrapper}\" />\n<c:set var=\"showSearch\"                 value=\"${setting.showSearch.useDefault(true).toBoolean}\" />\n<c:set var=\"textDisplay\"                value=\"${setting.textDisplay.useDefault('cap-css').toString}\" />\n<c:set var=\"metaLinks\"                  value=\"${setting.metaLinks.useDefault('top').toString}\" />\n<c:set var=\"showImageLink\"              value=\"${setting.showImageLink.useDefault(false).toBoolean}\" />\n\n<c:set var=\"temlateVariant\"             value=\"${cms.sitemapConfig.attribute['template.variant'].useDefault('default').toString}\" />\n\n<c:set var=\"searchPageUrl\" value=\"${cms.functionDetail['Search page']}\" />\n<c:set var=\"showSearch\" value=\"${showSearch and not fn:startsWith(searchPageUrl,'[')}\" />\n\n<c:set var=\"logoElements\" value=\"${cms.elementsInContainers['header-image']}\" />\n<c:if test=\"${not empty logoElements}\">\n    <c:set var=\"logoContent\" value=\"${logoElements.get(0).toXml}\" />\n    <c:set var=\"logoImage\" value=\"${logoContent.value.Image}\" />\n</c:if>\n\n<nav class=\"nav-main-group ${logoImage.value.Image.isSet ? 'has-sidelogo ' : ''}${cssWrapper}\"><%----%>\n\n    <mercury:nav-vars params=\"${param}\">\n    <mercury:nav-items\n        type=\"forSite\"\n        content=\"${content}\"\n        currentPageFolder=\"${currentPageFolder}\"\n        currentPageUri=\"${currentPageUri}\">\n\n        <c:choose>\n            <c:when test=\"${empty logoImage}\">\n                <%-- Do not generate markup if there is no image --%>\n            </c:when>\n            <c:when test=\"${temlateVariant eq 'burger'}\">\n                <div class=\"nav-menu-header\"><%----%>\n                    <div class=\"nav-menu-toggle\"><%----%>\n                        <label for=\"nav-toggle-check\" id=\"nav-toggle-label-close\" class=\"nav-toggle-label\"><%----%>\n                            <span class=\"nav-toggle\"><%----%>\n                                <span><fmt:message key=\"msg.page.navigation.toggle\" /></span><%----%>\n                            </span><%----%>\n                        </label><%----%>\n                    </div><%----%>\n                    <div class=\"nav-menu-logo\"><%----%>\n                        <mercury:link\n                            link=\"${logoContent.value.Link}\"\n                            test=\"${showImageLink}\"\n                            testFailTag=\"div\"\n                            setTitle=\"${true}\"\n                            css=\"mobile-logolink\" >\n                            <mercury:image-simple\n                                image=\"${logoImage}\"\n                                sizes=\"200,350,400,700,800\"\n                                cssWrapper=\"img-responsive\"\n                                title=\"${imageTitleCopyright}\"\n                            />\n                        </mercury:link>\n                    </div><%----%>\n                </div>\n            </c:when>\n            <c:otherwise>\n                <div class=\"nav-main-mobile-logo\"><%----%>\n                    <mercury:link\n                        link=\"${logoContent.value.Link}\"\n                        test=\"${showImageLink}\"\n                        testFailTag=\"div\"\n                        setTitle=\"${true}\"\n                        css=\"mobile-logolink\" >\n                        <mercury:image-simple\n                            image=\"${logoImage}\"\n                            sizes=\"100,200,400,800\"\n                            cssWrapper=\"img-responsive\"\n                            title=\"${imageTitleCopyright}\"\n                        />\n\n                    </mercury:link>\n                </div><%----%>\n            </c:otherwise>\n        </c:choose>\n\n        <mercury:nl />\n        <ul class=\"nav-main-items ${textDisplay}${' '}${not empty sidelogohtml ? 'hassidelogo ' : ''}${showSearch ? 'has-search' : 'no-search'}\"><%----%>\n        <mercury:nl />\n\n        <c:if test=\"${metaLinks ne 'none'}\">\n            <c:set var=\"metaLinkElements\" value=\"${cms.elementsInContainers['header-linksequence']}\" />\n            <c:if test=\"${not empty metaLinkElements}\">\n                <c:set var=\"metaLinksHtml\">\n                    <c:set var=\"metaLinksequence\" value=\"${metaLinkElements.get(0).toXml}\" />\n                    <li id=\"nav-main-addition\" aria-expanded=\"false\" class=\"hidden-lg hidden-xl\"><%----%>\n                        <a href=\"#\" title=\"Search\" aria-controls=\"nav_nav-main-addition\" id=\"label_nav-main-addition\">${metaLinksequence.value.Title}</a><%----%>\n                        <ul class=\"nav-menu\" id=\"nav_nav-main-addition\" aria-labelledby=\"label_nav-main-addition\"><%----%>\n                            <mercury:nl />\n                            <c:forEach var=\"link\" items=\"${metaLinksequence.valueList.LinkEntry}\" varStatus=\"status\">\n                                <c:set var=\"linkText\" value=\"${link.value.Text}\" />\n                                <c:if test=\"${fn:startsWith(linkText, 'icon:')}\">\n                                    <c:set var=\"linkText\"><span class=\"fa fa-${fn:substringAfter(linkText, 'icon:')}\"></span></c:set>\n                                </c:if>\n                                <li><mercury:link link=\"${link}\">${linkText}</mercury:link></li><mercury:nl />\n                            </c:forEach>\n                        </ul><%----%>\n                    </li><%----%>\n                </c:set>\n            </c:if>\n        </c:if>\n        <c:if test=\"${not empty metaLinksHtml and metaLinks ne 'bottom'}\">\n            ${metaLinksHtml}\n        </c:if>\n\n        <c:set var=\"navLength\" value=\"${empty navItems ? 0 : fn:length(navItems) - 1}\" />\n        <c:forEach var=\"i\" begin=\"0\" end=\"${navLength}\" >\n\n            <c:set var=\"navElem\" value=\"${navItems[i]}\" />\n            <c:set var=\"nextLevel\" value=\"${i < navLength ? navItems[i+1].navTreeLevel : navStartLevel}\" />\n            <c:set var=\"startSubMenu\" value=\"${nextLevel > navElem.navTreeLevel}\" />\n            <c:set var=\"isTopLevel\" value=\"${navElem.navTreeLevel eq navStartLevel}\" />\n            <c:set var=\"nextIsTopLevel\" value=\"${nextLevel eq navStartLevel}\" />\n            <c:set var=\"navTarget\" value=\"${fn:trim(navElem.info)eq 'extern' ? ' target=\\\"_blank\\\"' : ''}\" />\n\n            <c:set var=\"isCurrentPage\" value=\"${fn:startsWith(currentPageUri, cms.sitePath[navElem.resource.rootPath])}\" />\n            <c:set var=\"isFinalCurrentPage\" value=\"${isCurrentPage and currentPageFolder eq cms.sitePath[navElem.resource.rootPath]}\" />\n\n            <c:set var=\"menuType\" value=\"${isCurrentPage ? 'active ' : ''}\" />\n            <c:set var=\"menuType\" value=\"${isFinalCurrentPage ? menuType.concat('final ') : menuType}\" />\n            <c:set var=\"menuType\" value=\"${i == 0 ? menuType.concat('nav-first ') : menuType}\" />\n            <c:set var=\"menuType\" value=\"${i == navLength ? menuType.concat('nav-last ') : menuType}\" />\n\n            <%-- ###### Check for mega menu ######--%>\n            <c:set var=\"megaMenu\" value=\"\" />\n            <c:if test=\"${isTopLevel}\">\n                <c:set var=\"megaMenuVfsPath\" value=\"${navElem.resourceName}mega.menu\" />\n                <c:if test=\"${navElem.navigationLevel}\">\n                    <%-- ###### Path correction needed if navLevel ###### --%>\n                    <c:set var=\"megaMenuVfsPath\" value=\"${fn:replace(megaMenuVfsPath, navElem.fileName, '')}\" />\n                </c:if>\n                <c:set var=\"megaMenuRes\" value=\"${cms.vfs.xml[megaMenuVfsPath]}\" />\n                <c:if test=\"${not empty megaMenuRes}\">\n                    <c:set var=\"megaMenu\" value=' data-megamenu=\"${megaMenuRes.resource.link}\"' />\n                    <c:set var=\"menuType\" value=\"${menuType.concat('mega')}\" />\n                    <c:choose>\n                        <c:when test=\"${megaMenuRes.resource.property['mercury.mega.display'] eq 'mobile'}\">\n                            <c:set var=\"menuType\" value=\"${menuType.concat(' mega-mobile')}\" />\n                        </c:when>\n                        <c:when test=\"${not startSubMenu}\">\n                            <c:set var=\"menuType\" value=\"${menuType.concat(' mega-only')}\" />\n                        </c:when>\n                    </c:choose>\n                </c:if>\n            </c:if>\n            <c:set var=\"hasMegaMenu\" value=\"${not empty megaMenu}\" />\n\n            <c:if test=\"${startSubMenu or hasMegaMenu}\">\n                <c:set var=\"instanceId\"><mercury:idgen prefix=\"\" uuid=\"${cms.element.instanceId}\" /></c:set>\n                <c:set var=\"parentLabelId\">label${instanceId}_${i}</c:set>\n                <c:set var=\"targetMenuId\">nav${instanceId}_${i}</c:set>\n                <c:if test=\"${startSubMenu}\">\n                    <c:set var=\"lastNavLevel\" value=\"${navElem}\" />\n                </c:if>\n            </c:if>\n\n            <c:choose>\n                <c:when test=\"${(not empty lastNavLevel) and fn:startsWith(navElem.info, '#')}\">\n                    <c:set var=\"navLink\"><cms:link>${lastNavLevel.resourceName}${navElem.info}</cms:link></c:set>\n                </c:when>\n                <c:otherwise>\n                    <c:set var=\"navLink\"><cms:link>${navElem.resourceName}</cms:link></c:set>\n                </c:otherwise>\n            </c:choose>\n\n            <c:set var=\"menuType\" value=\"${empty menuType ? '' : ' class=\\\"'.concat(menuType).concat('\\\"')}\" />\n            <c:set var=\"menuType\" value=\"${startSubMenu or hasMegaMenu ? menuType.concat(' aria-expanded=\\\"false\\\"') : menuType}\" />\n\n            <c:out value='<li${menuType}${megaMenu}>${empty menuType ? \"\" : nl}' escapeXml=\"false\" />\n\n            <c:set var=\"navText\"><c:out value=\"${(empty navElem.navText or fn:startsWith(navElem.navText, '???'))\n                ? navElem.title : navElem.navText}\" /></c:set>\n\n\n            <c:choose>\n\n                <c:when test=\"${startSubMenu and not navElem.navigationLevel}\">\n                    <%-- Navigation item with sub-menu and direct child pages --%>\n                    <a href=\"${navLink}\"${navTarget} class=\"nav-label\" id=\"${parentLabelId}\">${navText}</a><%----%>\n                    <a href=\"${navLink}\"${navTarget} aria-controls=\"${targetMenuId}\" aria-label=\"<fmt:message key=\"msg.page.navigation.sublevel\" />\">&nbsp;</a><%----%>\n                </c:when>\n\n                <c:when test=\"${startSubMenu}\">\n                    <%-- Navigation item with sub-menu but without direct child pages --%>\n                    <a href=\"${navLink}\"${navTarget}${' '}<%--\n                    --%>id=\"${parentLabelId}\"${' '}<%--\n                    --%>aria-controls=\"${targetMenuId}\">${navText}</a><%----%>\n                </c:when>\n\n                <c:otherwise>\n                    <%--Navigation item without sub-menu --%>\n                    <a href=\"${navLink}\"${navTarget}<%----%>\n                    <c:if test=\"${hasMegaMenu}\">\n                        <%-- mega menu requires aria-controls - will be removed by JavaScript if mega menu is not displayed in mobile --%>\n                        ${' '}aria-controls=\"${targetMenuId}\"<%----%>\n                    </c:if>\n                    ${'>'}${navText}</a><%----%>\n                </c:otherwise>\n            </c:choose>\n\n            <c:choose>\n                <c:when test=\"${startSubMenu}\">\n                   <c:out value='${nl}<ul class=\"nav-menu\" id=\"${targetMenuId}\" aria-labelledby=\"${parentLabelId}\">${nl}' escapeXml=\"false\" />\n                </c:when>\n                <c:when test=\"${hasMegaMenu}\">\n                   <c:out value='${nl}<ul class=\"nav-menu\" id=\"${targetMenuId}\" aria-labelledby=\"${parentLabelId}\"></ul>' escapeXml=\"false\" />\n                </c:when>\n            </c:choose>\n\n            <c:if test=\"${nextLevel < navElem.navTreeLevel}\">\n                <c:forEach begin=\"1\" end=\"${navElem.navTreeLevel - nextLevel}\" >\n                    <c:out value='</li>${nl}</ul>${nl}' escapeXml=\"false\" />\n                </c:forEach>\n            </c:if>\n\n            <c:if test=\"${not startSubMenu}\"><c:out value='</li>${nl}' escapeXml=\"false\" /></c:if>\n\n        </c:forEach>\n\n        <c:if test=\"${not empty metaLinksHtml and metaLinks eq 'bottom'}\">\n            ${metaLinksHtml}\n        </c:if>\n\n        <c:if test=\"${showSearch}\">\n            <li id=\"nav-main-search\" aria-expanded=\"false\"><%----%>\n                <a href=\"#\" title=\"Search\" aria-controls=\"nav_nav-main-search\" id=\"label_nav-main-search\"><%----%>\n                    <span class=\"search search-btn fa fa-search\"></span><%----%>\n                </a><%----%>\n                <ul class=\"nav-menu\" id=\"nav_nav-main-search\" aria-labelledby=\"label_nav-main-search\"><%----%>\n                    <li><%----%>\n                        <div class=\"styled-form search-form\"><%----%>\n                            <form action=\"${searchPageUrl}\" method=\"post\"><%----%>\n                                <div class=\"input button\"><%----%>\n                                    <label for=\"searchNavQuery\" class=\"sr-only\">Search</label><%----%>\n                                    <input id=\"searchNavQuery\" name=\"q\" type=\"text\" class=\"blur-focus\" autocomplete=\"off\" placeholder='<fmt:message key=\"msg.page.search.enterquery\" />' /><%----%>\n                                    <button class=\"btn\" type=\"button\" onclick=\"this.form.submit(); return false;\"><fmt:message key=\"msg.page.search.submit\" /></button><%----%>\n                                </div><%----%>\n                            </form><%----%>\n                        </div><%----%>\n                    </li><%----%>\n                </ul><%----%>\n            </li><%----%>\n        </c:if>\n\n        <mercury:nl />\n        </ul><%----%>\n        <mercury:nl />\n\n    </mercury:nav-items>\n    </mercury:nav-vars>\n\n</nav><%----%>\n\n</cms:formatter>\n</cms:bundle>\n</mercury:init-messages>", "<%@page\n    pageEncoding=\"UTF-8\"\n    buffer=\"none\"\n    session=\"false\"\n    trimDirectiveWhitespaces=\"true\"%>\n\n<%@ taglib prefix=\"c\" uri=\"http://java.sun.com/jsp/jstl/core\" %>\n<%@ taglib prefix=\"cms\" uri=\"http://www.opencms.org/taglib/cms\"%>\n<%@ taglib prefix=\"fn\" uri=\"http://java.sun.com/jsp/jstl/functions\"%>\n<%@ taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\"%>\n<%@ taglib prefix=\"mercury\" tagdir=\"/WEB-INF/tags/mercury\" %>\n\n<mercury:init-messages>\n\n<fmt:setLocale value=\"${cms.locale}\" />\n<cms:bundle basename=\"alkacon.mercury.template.messages\">\n\n<cms:formatter var=\"content\" val=\"value\">\n\n<c:set var=\"setting\"                value=\"${cms.element.setting}\" />\n<c:set var=\"cssWrapper\"             value=\"${setting.cssWrapper}\" />\n<c:set var=\"hsize\"                  value=\"${setting.hsize.toInteger}\" />\n<c:set var=\"cssVisibility\"          value=\"${setting.cssVisibility.toString != 'always' ? setting.cssVisibility.toString : ''}\" />\n<c:set var=\"ade\"                    value=\"${cms.isEditMode}\" />\n\n<mercury:nl />\n\n<mercury:nav-vars params=\"${param}\">\n<mercury:nav-items\n    type=\"forSite\"\n    content=\"${content}\"\n    currentPageFolder=\"${currentPageFolder}\"\n    currentPageUri=\"${currentPageUri}\" >\n\n    <%-- If no navigation items are found, no output must be generated online --%>\n\n    <div class=\"element type-nav-side ${cssWrapper}${' '}${cssVisibility}\"><%----%>\n    <mercury:nl />\n\n        <mercury:heading level=\"${hsize}\" text=\"${value.Title}\" css=\"heading\" ade=\"${ade}\" />\n\n        <c:set var=\"navLength\" value=\"${empty navItems ? 0 : fn:length(navItems) - 1}\" />\n        <ul class=\"nav-side\"><%----%>\n            <mercury:nl />\n            <c:forEach var=\"i\" begin=\"0\" end=\"${navLength}\" >\n\n                <c:set var=\"navElem\" value=\"${navItems[i]}\" />\n                <c:set var=\"nextLevel\" value=\"${i < navLength ? navItems[i+1].navTreeLevel : navStartLevel}\" />\n                <c:set var=\"startSubMenu\" value=\"${nextLevel > navElem.navTreeLevel}\" />\n                <c:set var=\"isCurrentPage\" value=\"${fn:startsWith(currentPageUri, cms.sitePath[navElem.resource.rootPath])}\" />\n                <c:set var=\"isFinalCurrentPage\" value=\"${isCurrentPage and currentPageFolder eq cms.sitePath[navElem.resource.rootPath]}\" />\n                <c:set var=\"navTarget\" value=\"${fn:trim(navElem.info) eq 'extern' ? ' target=\\\"_blank\\\"' : ''}\" />\n\n                <c:if test=\"${startSubMenu}\">\n                    <c:set var=\"instanceId\"><mercury:idgen prefix=\"\" uuid=\"${cms.element.instanceId}\" /></c:set>\n                    <c:set var=\"parentLabelId\">label${instanceId}_${i}</c:set>\n                    <c:set var=\"targetMenuId\">nav${instanceId}_${i}</c:set>\n                    <c:set var=\"lastNavLevel\" value=\"${navElem}\" />\n                </c:if>\n\n                <c:choose>\n                    <c:when test=\"${(not empty lastNavLevel) and fn:startsWith(navElem.info, '#')}\">\n                        <c:set var=\"navLink\"><cms:link>${lastNavLevel.resourceName}${navElem.info}</cms:link></c:set>\n                    </c:when>\n                    <c:otherwise>\n                        <c:set var=\"navLink\"><cms:link>${navElem.resourceName}</cms:link></c:set>\n                    </c:otherwise>\n                </c:choose>\n\n                <c:set var=\"navText\"><c:out value=\"${(empty navElem.navText or fn:startsWith(navElem.navText, '???')) ? navElem.title : navElem.navText}\" /></c:set>\n\n                <c:set var=\"menuType\" value=\"${startSubMenu ? menuType.concat(' aria-expanded=\\\"false\\\"') : menuType}\" />\n\n                <c:out value=\"<li${isCurrentPage ? ' class=\\\"currentpage'.concat(isFinalCurrentPage ? ' final\\\"' : '\\\"') : ''}>\" escapeXml=\"false\" />\n\n                <c:choose>\n                    <c:when test=\"${startSubMenu and navElem.navigationLevel}\">\n                        <%-- Navigation item with sub-menu but without direct child pages --%>\n                        <a href=\"${navLink}\"${navTarget}${' '}<%--\n                        --%>id=\"${parentLabelId}\"${' '}<%--\n                        --%>${isCurrentPage ? 'aria-expanded=\\\"true\\\" class=\\\"collapse show\\\"' : 'aria-expanded=\\\"false\\\"'}${' '}<%--\n                        --%>data-toggle=\"collapse\" data-target=\"#${targetMenuId}\"${' '}<%--\n                        --%>aria-controls=\"${targetMenuId}\">${navText}</a><%--\n                --%></c:when>\n\n                    <c:when test=\"${startSubMenu}\">\n                        <%-- Navigation item with sub-menu and direct child pages --%>\n                        <a href=\"${navLink}\"${navTarget} class=\"nav-label\" id=\"${parentLabelId}\">${navText}</a><%--\n                        --%><a href=\"${navLink}\"${navTarget} data-toggle=\"collapse\" data-target=\"#${targetMenuId}\"${' '}<%--\n                        --%>${isCurrentPage ? 'aria-expanded=\\\"true\\\" class=\\\"collapse show\\\"' : 'aria-expanded=\\\"false\\\"'}${' '}<%--\n                        --%>aria-controls=\"${targetMenuId}\" aria-label=\"<fmt:message key=\"msg.page.navigation.sublevel\" />\">&nbsp;</a><%--\n                --%></c:when>\n\n                    <c:otherwise>\n                        <%--Navigation item without sub-menu --%>\n                        <a href=\"${navLink}\"${navTarget}>${navText}</a><%--\n                --%></c:otherwise>\n                </c:choose>\n\n                <c:if test=\"${startSubMenu}\">\n                   <c:set var=\"collapseIn\" value=\"${isCurrentPage ? ' show' : ''}\" />\n                   <mercury:nl />\n                   <c:out value='<ul class=\"collapse${collapseIn}\" id=\"${targetMenuId}\">' escapeXml=\"false\" />\n                </c:if>\n\n                <c:if test=\"${nextLevel < navElem.navTreeLevel}\">\n                    <c:forEach begin=\"1\" end=\"${navElem.navTreeLevel - nextLevel}\" >\n                        <c:out value='</li></ul>' escapeXml=\"false\" />\n                        <mercury:nl />\n                    </c:forEach>\n                </c:if>\n\n                <c:if test=\"${not startSubMenu}\">\n                    <c:out value='</li>' escapeXml=\"false\" />\n                    <mercury:nl />\n                </c:if>\n\n            </c:forEach>\n        </ul><%----%>\n        <mercury:nl />\n\n    </div><%----%>\n\n</mercury:nav-items>\n</mercury:nav-vars>\n\n<mercury:nl />\n\n</cms:formatter>\n</cms:bundle>\n</mercury:init-messages>"], "filenames": ["alkacon.mercury.template/resources/system/modules/alkacon.mercury.template/formatters/navigation/breadcrumbs.jsp", "alkacon.mercury.template/resources/system/modules/alkacon.mercury.template/formatters/navigation/main.jsp", "alkacon.mercury.template/resources/system/modules/alkacon.mercury.template/formatters/navigation/side.jsp"], "buggy_code_start_loc": [45, 191, 70], "buggy_code_end_loc": [47, 193, 71], "fixing_code_start_loc": [45, 191, 70], "fixing_code_end_loc": [47, 194, 71], "type": "CWE-79", "message": "In \u201cOpenCMS\u201d, versions 10.5.0 to 11.0.2 are affected by a stored XSS vulnerability that allows low privileged application users to store malicious scripts in the Sitemap functionality. These scripts are executed in a victim\u2019s browser when they open the page containing the vulnerable field.", "other": {"cve": {"id": "CVE-2021-25968", "sourceIdentifier": "vulnerabilitylab@mend.io", "published": "2021-10-19T09:15:07.853", "lastModified": "2021-10-21T23:39:03.337", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "In \u201cOpenCMS\u201d, versions 10.5.0 to 11.0.2 are affected by a stored XSS vulnerability that allows low privileged application users to store malicious scripts in the Sitemap functionality. These scripts are executed in a victim\u2019s browser when they open the page containing the vulnerable field."}, {"lang": "es", "value": "En \"OpenCMS\", versiones 10.5.0 a 11.0.2, est\u00e1n afectadas por una vulnerabilidad de tipo XSS almacenado que permite a usuarios de aplicaciones poco privilegiado almacenar scripts maliciosos en la funcionalidad Sitemap. Estos scripts se ejecutan en el navegador de la v\u00edctima cuando \u00e9sta abre la p\u00e1gina que contiene el campo vulnerable"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "vulnerabilitylab@mend.io", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "vulnerabilitylab@mend.io", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:alkacon:opencms:*:*:*:*:*:*:*:*", "versionStartIncluding": "10.5.0", "versionEndExcluding": "11.0.2", "matchCriteriaId": "37423D9C-E622-4232-8262-4E23011B42E5"}]}]}], "references": [{"url": "https://github.com/alkacon/mercury-template/commit/800945f5d02346c633c7aef9f5d596d7dedc8fb5", "source": "vulnerabilitylab@mend.io", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://www.whitesourcesoftware.com/vulnerability-database/CVE-2021-25968", "source": "vulnerabilitylab@mend.io", "tags": ["Broken Link"]}]}, "github_commit_url": "https://github.com/alkacon/mercury-template/commit/800945f5d02346c633c7aef9f5d596d7dedc8fb5"}}