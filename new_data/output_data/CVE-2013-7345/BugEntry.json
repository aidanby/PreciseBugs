{"buggy_code": ["\n#------------------------------------------------------------------------------\n# $File: commands,v 1.44 2013/02/05 15:20:47 christos Exp $\n# commands:  file(1) magic for various shells and interpreters\n#\n#0\tstring/w\t:\t\t\tshell archive or script for antique kernel text\n0\tstring/wt\t#!\\ /bin/sh\t\tPOSIX shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /bin/csh\t\tC shell script text executable\n!:mime\ttext/x-shellscript\n# korn shell magic, sent by George Wu, gwu@clyde.att.com\n0\tstring/wt\t#!\\ /bin/ksh\t\tKorn shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt \t#!\\ /bin/tcsh\t\tTenex C shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/bin/tcsh\tTenex C shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt \t#!\\ /usr/local/tcsh\tTenex C shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/local/bin/tcsh\tTenex C shell script text executable\n!:mime\ttext/x-shellscript\n\n#\n# zsh/ash/ae/nawk/gawk magic from cameron@cs.unsw.oz.au (Cameron Simpson)\n0\tstring/wt\t#!\\ /bin/zsh\t\tPaul Falstad's zsh script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/bin/zsh\tPaul Falstad's zsh script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/local/bin/zsh\tPaul Falstad's zsh script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/local/bin/ash\tNeil Brown's ash script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/local/bin/ae\tNeil Brown's ae script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /bin/nawk\t\tnew awk script text executable\n!:mime\ttext/x-nawk\n0\tstring/wt\t#!\\ /usr/bin/nawk\tnew awk script text executable\n!:mime\ttext/x-nawk\n0\tstring/wt\t#!\\ /usr/local/bin/nawk\tnew awk script text executable\n!:mime\ttext/x-nawk\n0\tstring/wt\t#!\\ /bin/gawk\t\tGNU awk script text executable\n!:mime\ttext/x-gawk\n0\tstring/wt\t#!\\ /usr/bin/gawk\tGNU awk script text executable\n!:mime\ttext/x-gawk\n0\tstring/wt\t#!\\ /usr/local/bin/gawk\tGNU awk script text executable\n!:mime\ttext/x-gawk\n#\n0\tstring/wt\t#!\\ /bin/awk\t\tawk script text executable\n!:mime\ttext/x-awk\n0\tstring/wt\t#!\\ /usr/bin/awk\tawk script text executable\n!:mime\ttext/x-awk\n0\tregex\t\t=^\\\\s*BEGIN\\\\s*[{]\tawk script text\n\n# AT&T Bell Labs' Plan 9 shell\n0\tstring/wt\t#!\\ /bin/rc\tPlan 9 rc shell script text executable\n\n# bash shell magic, from Peter Tobias (tobias@server.et-inf.fho-emden.de)\n0\tstring/wt\t#!\\ /bin/bash\tBourne-Again shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/bin/bash\tBourne-Again shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/local/bash\tBourne-Again shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/local/bin/bash\tBourne-Again shell script text executable\n!:mime\ttext/x-shellscript\n\n# PHP scripts\n# Ulf Harnhammar <ulfh@update.uu.se>\n0\tsearch/1/c\t=<?php\t\t\tPHP script text\n!:strength + 10\n!:mime\ttext/x-php\n0\tsearch/1\t=<?\\n\t\t\tPHP script text\n!:mime\ttext/x-php\n0\tsearch/1\t=<?\\r\t\t\tPHP script text\n!:mime\ttext/x-php\n0\tsearch/1/w\t#!\\ /usr/local/bin/php\tPHP script text executable\n!:strength + 10\n!:mime\ttext/x-php\n0\tsearch/1/w\t#!\\ /usr/bin/php\tPHP script text executable\n!:strength + 10\n!:mime\ttext/x-php\n# Smarty compiled template, http://www.smarty.net/\n# Elan Ruusamae <glen@delfi.ee>\n0\tstring\t=<?php\\ /*\\ Smarty\\ version\tSmarty compiled template\n>24\tregex\t[0-9.]+\t\t\t\t\\b, version %s\n!:mime\ttext/x-php\n\n0\tstring\t\tZend\\x00\t\tPHP script Zend Optimizer data\n\n0\tstring/t\t$!\t\t\tDCL command file\n\n# Type: Pdmenu\n# URL:  http://packages.debian.org/pdmenu\n# From: Edward Betts <edward@debian.org>\n0\tstring\t\t#!/usr/bin/pdmenu\tPdmenu configuration file text\n"], "fixing_code": ["\n#------------------------------------------------------------------------------\n# $File: commands,v 1.45 2013/02/06 14:18:52 christos Exp $\n# commands:  file(1) magic for various shells and interpreters\n#\n#0\tstring/w\t:\t\t\tshell archive or script for antique kernel text\n0\tstring/wt\t#!\\ /bin/sh\t\tPOSIX shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /bin/csh\t\tC shell script text executable\n!:mime\ttext/x-shellscript\n# korn shell magic, sent by George Wu, gwu@clyde.att.com\n0\tstring/wt\t#!\\ /bin/ksh\t\tKorn shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt \t#!\\ /bin/tcsh\t\tTenex C shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/bin/tcsh\tTenex C shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt \t#!\\ /usr/local/tcsh\tTenex C shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/local/bin/tcsh\tTenex C shell script text executable\n!:mime\ttext/x-shellscript\n\n#\n# zsh/ash/ae/nawk/gawk magic from cameron@cs.unsw.oz.au (Cameron Simpson)\n0\tstring/wt\t#!\\ /bin/zsh\t\tPaul Falstad's zsh script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/bin/zsh\tPaul Falstad's zsh script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/local/bin/zsh\tPaul Falstad's zsh script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/local/bin/ash\tNeil Brown's ash script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/local/bin/ae\tNeil Brown's ae script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /bin/nawk\t\tnew awk script text executable\n!:mime\ttext/x-nawk\n0\tstring/wt\t#!\\ /usr/bin/nawk\tnew awk script text executable\n!:mime\ttext/x-nawk\n0\tstring/wt\t#!\\ /usr/local/bin/nawk\tnew awk script text executable\n!:mime\ttext/x-nawk\n0\tstring/wt\t#!\\ /bin/gawk\t\tGNU awk script text executable\n!:mime\ttext/x-gawk\n0\tstring/wt\t#!\\ /usr/bin/gawk\tGNU awk script text executable\n!:mime\ttext/x-gawk\n0\tstring/wt\t#!\\ /usr/local/bin/gawk\tGNU awk script text executable\n!:mime\ttext/x-gawk\n#\n0\tstring/wt\t#!\\ /bin/awk\t\tawk script text executable\n!:mime\ttext/x-awk\n0\tstring/wt\t#!\\ /usr/bin/awk\tawk script text executable\n!:mime\ttext/x-awk\n0\tregex\t\t=^\\\\s{0,100}BEGIN\\\\s{0,100}[{]\tawk script text\n\n# AT&T Bell Labs' Plan 9 shell\n0\tstring/wt\t#!\\ /bin/rc\tPlan 9 rc shell script text executable\n\n# bash shell magic, from Peter Tobias (tobias@server.et-inf.fho-emden.de)\n0\tstring/wt\t#!\\ /bin/bash\tBourne-Again shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/bin/bash\tBourne-Again shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/local/bash\tBourne-Again shell script text executable\n!:mime\ttext/x-shellscript\n0\tstring/wt\t#!\\ /usr/local/bin/bash\tBourne-Again shell script text executable\n!:mime\ttext/x-shellscript\n\n# PHP scripts\n# Ulf Harnhammar <ulfh@update.uu.se>\n0\tsearch/1/c\t=<?php\t\t\tPHP script text\n!:strength + 10\n!:mime\ttext/x-php\n0\tsearch/1\t=<?\\n\t\t\tPHP script text\n!:mime\ttext/x-php\n0\tsearch/1\t=<?\\r\t\t\tPHP script text\n!:mime\ttext/x-php\n0\tsearch/1/w\t#!\\ /usr/local/bin/php\tPHP script text executable\n!:strength + 10\n!:mime\ttext/x-php\n0\tsearch/1/w\t#!\\ /usr/bin/php\tPHP script text executable\n!:strength + 10\n!:mime\ttext/x-php\n# Smarty compiled template, http://www.smarty.net/\n# Elan Ruusamae <glen@delfi.ee>\n0\tstring\t=<?php\\ /*\\ Smarty\\ version\tSmarty compiled template\n>24\tregex\t[0-9.]+\t\t\t\t\\b, version %s\n!:mime\ttext/x-php\n\n0\tstring\t\tZend\\x00\t\tPHP script Zend Optimizer data\n\n0\tstring/t\t$!\t\t\tDCL command file\n\n# Type: Pdmenu\n# URL:  http://packages.debian.org/pdmenu\n# From: Edward Betts <edward@debian.org>\n0\tstring\t\t#!/usr/bin/pdmenu\tPdmenu configuration file text\n"], "filenames": ["magic/Magdir/commands"], "buggy_code_start_loc": [3], "buggy_code_end_loc": [53], "fixing_code_start_loc": [3], "fixing_code_end_loc": [53], "type": "NVD-CWE-noinfo", "message": "The BEGIN regular expression in the awk script detector in magic/Magdir/commands in file before 5.15 uses multiple wildcards with unlimited repetitions, which allows context-dependent attackers to cause a denial of service (CPU consumption) via a crafted ASCII file that triggers a large amount of backtracking, as demonstrated via a file with many newline characters.", "other": {"cve": {"id": "CVE-2013-7345", "sourceIdentifier": "cve@mitre.org", "published": "2014-03-24T16:31:08.167", "lastModified": "2022-10-31T14:56:14.563", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "The BEGIN regular expression in the awk script detector in magic/Magdir/commands in file before 5.15 uses multiple wildcards with unlimited repetitions, which allows context-dependent attackers to cause a denial of service (CPU consumption) via a crafted ASCII file that triggers a large amount of backtracking, as demonstrated via a file with many newline characters."}, {"lang": "es", "value": "La expresi\u00f3n regular BEGIN en el detector de script de awk en el archivo magic/Magdir/commands anterior a 5.15 utiliza m\u00faltiples comodines con repeticiones ilimitadas, lo que permite a atacantes dependientes de contexto causar una denegaci\u00f3n de servicio (consumo de CPU) a trav\u00e9s de un archivo ASCII manipulado que provoca una gran cantidad de retroceso, como se demostr\u00f3 a trav\u00e9s de un archivo con muchos caracteres de nueva l\u00ednea."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:christos_zoulas:file:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.15", "matchCriteriaId": "68332B19-F2A7-4677-A4D4-F2DD319817EC"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.4.0", "versionEndExcluding": "5.4.27", "matchCriteriaId": "BF0A4D68-12AA-43A0-B18C-41D09BE7A4B9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.5.0", "versionEndExcluding": "5.5.11", "matchCriteriaId": "6E368DFE-D18B-4B1B-BB33-7C0C41DE6474"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:6.0:*:*:*:*:*:*:*", "matchCriteriaId": "036E8A89-7A16-411F-9D31-676313BB7244"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "16F59A04-14CF-49E2-9973-645477EA09DA"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43"}]}]}], "references": [{"url": "http://bugs.gw.com/view.php?id=164", "source": "cve@mitre.org", "tags": ["Broken Link", "Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "http://rhn.redhat.com/errata/RHSA-2014-1765.html", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://support.apple.com/kb/HT6443", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "http://www.debian.org/security/2014/dsa-2873", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}, {"url": "https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=703993", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/file/file/commit/ef2329cf71acb59204dd981e2c6cce6c81fe467c", "source": "cve@mitre.org", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/file/file/commit/ef2329cf71acb59204dd981e2c6cce6c81fe467c"}}