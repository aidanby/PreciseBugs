{"buggy_code": ["class Curupira::PasswordsController < ApplicationController\n  before_filter :redirect_to_root_with_errors, if: :current_user\n\n  def new\n    @user = User.new\n  end\n\n  def create\n    @user = User.find_by(params[:user])\n    if @user.present?\n      @user.deliver_reset_password_instructions!\n      redirect_to new_session_path, notice: \"Verifique seu email para receber instru\u00e7\u00f5es de recupera\u00e7\u00e3o de senha\"\n    else\n      @user = User.new email: params[:user][:email]\n      flash[:alert] = \"Email n\u00e3o encontrado\"\n      render :new\n    end\n  end\n\n  def edit\n    @user = User.load_from_reset_password_token(params[:id])\n    if @user.present?\n      render :edit\n    else\n      redirect_to new_session_path, alert: \"Token para resetar senha expirado ou inv\u00e1lido\"\n    end\n  end\n\n  def update\n    @user = User.load_from_reset_password_token(params[:id])\n\n    if @user\n      @user.change_password!(params[:user][:password])\n      Curupira::ResetPasswordMailer.reseted(@user).deliver_now\n      redirect_to new_session_path, notice: \"Senha atualizada com sucesso. Entre com sua nova senha\"\n    else\n      redirect_to new_session_path, alert: \"Token para resetar senha expirado ou inv\u00e1lido\"\n    end\n  end\n\n  private\n\n  def redirect_to_root_with_errors\n    redirect_to root_path, alert: \"Voc\u00ea j\u00e1 est\u00e1 logado\"\n  end\nend\n"], "fixing_code": ["class Curupira::PasswordsController < ApplicationController\n  before_filter :redirect_to_root_with_errors, if: :current_user\n\n  def new\n    @user = User.new\n  end\n\n  def create\n    @user = User.find_by(email: params[:user][:email])\n    if @user.present?\n      @user.deliver_reset_password_instructions!\n      redirect_to new_session_path, notice: \"Verifique seu email para receber instru\u00e7\u00f5es de recupera\u00e7\u00e3o de senha\"\n    else\n      @user = User.new email: params[:user][:email]\n      flash[:alert] = \"Email n\u00e3o encontrado\"\n      render :new\n    end\n  end\n\n  def edit\n    @user = User.load_from_reset_password_token(params[:id])\n    if @user.present?\n      render :edit\n    else\n      redirect_to new_session_path, alert: \"Token para resetar senha expirado ou inv\u00e1lido\"\n    end\n  end\n\n  def update\n    @user = User.load_from_reset_password_token(params[:id])\n\n    if @user\n      @user.change_password!(params[:user][:password])\n      Curupira::ResetPasswordMailer.reseted(@user).deliver_now\n      redirect_to new_session_path, notice: \"Senha atualizada com sucesso. Entre com sua nova senha\"\n    else\n      redirect_to new_session_path, alert: \"Token para resetar senha expirado ou inv\u00e1lido\"\n    end\n  end\n\n  private\n\n  def redirect_to_root_with_errors\n    redirect_to root_path, alert: \"Voc\u00ea j\u00e1 est\u00e1 logado\"\n  end\nend\n"], "filenames": ["app/controllers/curupira/passwords_controller.rb"], "buggy_code_start_loc": [9], "buggy_code_end_loc": [10], "fixing_code_start_loc": [9], "fixing_code_end_loc": [10], "type": "CWE-89", "message": "A vulnerability classified as critical has been found in prodigasistemas curupira up to 0.1.3. Affected is an unknown function of the file app/controllers/curupira/passwords_controller.rb. The manipulation leads to sql injection. Upgrading to version 0.1.4 is able to address this issue. The name of the patch is 93a9a77896bb66c949acb8e64bceafc74bc8c271. It is recommended to upgrade the affected component. VDB-218394 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2015-10053", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-16T12:15:16.227", "lastModified": "2023-01-24T16:09:00.443", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability classified as critical has been found in prodigasistemas curupira up to 0.1.3. Affected is an unknown function of the file app/controllers/curupira/passwords_controller.rb. The manipulation leads to sql injection. Upgrading to version 0.1.4 is able to address this issue. The name of the patch is 93a9a77896bb66c949acb8e64bceafc74bc8c271. It is recommended to upgrade the affected component. VDB-218394 is the identifier assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.2}, "baseSeverity": "MEDIUM", "exploitabilityScore": 5.1, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:prodigasistemas:curupira:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.1.4", "matchCriteriaId": "8BAE1FE4-5520-45AB-8C85-BB3AC035BF7F"}]}]}], "references": [{"url": "https://github.com/prodigasistemas/curupira/commit/93a9a77896bb66c949acb8e64bceafc74bc8c271", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/prodigasistemas/curupira/releases/tag/v0.1.4", "source": "cna@vuldb.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.218394", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.218394", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/prodigasistemas/curupira/commit/93a9a77896bb66c949acb8e64bceafc74bc8c271"}}