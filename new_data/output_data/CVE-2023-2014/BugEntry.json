{"buggy_code": ["<?php must_have_access(); ?>\n\n<script type=\"text/javascript\">\n    mw.require('options.js');\n    mw.require('forms.js');\n</script>\n\n<script type=\"text/javascript\">\n    $(document).ready(function () {\n        mw.options.form('.<?php print $config['module_class'] ?>', function () {\n            mw.notification.success(\"<?php _ejs(\"All changes are saved\"); ?>.\");\n        });\n    });\n</script>\n\n<div class=\"<?php print $config['module_class'] ?>\">\n    <?php $data = get_option('current_template', 'template', 1); ?>\n    <?php\n    if (!isset($data['id'])) {\n        $data['id'] = 0;\n    }\n    if (!isset($data['option_value'])) {\n        $data['option_value'] = 'default';\n    }\n    if (!isset($data['option_key'])) {\n        $data['option_key'] = 'current_template';\n    }\n    ?>\n\n\n    <script type=\"text/javascript\">\n        function mw_set_default_template() {\n            changeTemplateDialog = mw.dialog({\n                content: '<div id=\"mw_admin_change_template_modal_content\"></div>',\n                title: 'Change Template',\n                width: 700,\n                id: 'mw_admin_change_template_modal'\n            });\n            var params = {};\n            mw.load_module('settings/group/template_install_modal', '#mw_admin_change_template_modal_content', function() {\n                changeTemplateDialog.center();\n            }, params);\n        }\n\n        $(document).ready(function () {\n            $(window).on('templateSelected', function () {\n                $(\".mw-site-theme-selector\").find(\"[name='active_site_template'] option:selected\").each(function (index) {\n                    $(\"#mw_curr_theme_val\").val($(this).val());\n                });\n            });\n        });\n    </script>\n\n    <?php\n\n    $selected_template =  $data['option_value'];\n\n    $change_template = false;\n    if(isset($_GET['template'])){\n        $change_template = true;\n        $selected_template = $_GET['template'];\n    }\n    $selected_template = xss_clean($selected_template);\n    ?>\n<?php if($change_template){ ?>\n    <div class=\"alert alert-dismissible alert-primary\">\n        <?php _e(\"You must click the apply template button to change your template\"); ?>\n\n    </div>\n\n    <?php } ?>\n\n\n    <div class=\"mw-site-theme-selector\">\n        <input id=\"mw_curr_theme_val\" name=\"current_template\" class=\"mw_option_field mw-ui-field\" type=\"hidden\" option-group=\"template\" value=\"<?php print  $selected_template; ?>\" data-id=\"<?php print  $data['id']; ?>\"/>\n        <module type=\"content/views/layout_selector\" show_allow_multiple_template=\"true\" show_save_changes_buttons=\"true\" show_full=\"true\" data-active-site-template=\"<?php print $selected_template ?>\" autoload=\"1\" xxlive_edit_styles_check=\"1\" no-default-name=\"true\"/>\n    </div>\n</div>\n"], "fixing_code": ["<?php must_have_access(); ?>\n\n<script type=\"text/javascript\">\n    mw.require('options.js');\n    mw.require('forms.js');\n</script>\n\n<script type=\"text/javascript\">\n    $(document).ready(function () {\n        mw.options.form('.<?php print $config['module_class'] ?>', function () {\n            mw.notification.success(\"<?php _ejs(\"All changes are saved\"); ?>.\");\n        });\n    });\n</script>\n\n<div class=\"<?php print $config['module_class'] ?>\">\n    <?php $data = get_option('current_template', 'template', 1); ?>\n    <?php\n    if (!isset($data['id'])) {\n        $data['id'] = 0;\n    }\n    if (!isset($data['option_value'])) {\n        $data['option_value'] = 'default';\n    }\n    if (!isset($data['option_key'])) {\n        $data['option_key'] = 'current_template';\n    }\n    ?>\n\n\n    <script type=\"text/javascript\">\n        function mw_set_default_template() {\n            changeTemplateDialog = mw.dialog({\n                content: '<div id=\"mw_admin_change_template_modal_content\"></div>',\n                title: 'Change Template',\n                width: 700,\n                id: 'mw_admin_change_template_modal'\n            });\n            var params = {};\n            mw.load_module('settings/group/template_install_modal', '#mw_admin_change_template_modal_content', function() {\n                changeTemplateDialog.center();\n            }, params);\n        }\n\n        $(document).ready(function () {\n            $(window).on('templateSelected', function () {\n                $(\".mw-site-theme-selector\").find(\"[name='active_site_template'] option:selected\").each(function (index) {\n                    $(\"#mw_curr_theme_val\").val($(this).val());\n                });\n            });\n        });\n    </script>\n\n    <?php\n\n    $selected_template =  $data['option_value'];\n\n    $change_template = false;\n    if(isset($_GET['template'])){\n        $change_template = true;\n        $selected_template = e($_GET['template']);\n    }\n    $selected_template = xss_clean($selected_template);\n    ?>\n<?php if($change_template){ ?>\n    <div class=\"alert alert-dismissible alert-primary\">\n        <?php _e(\"You must click the apply template button to change your template\"); ?>\n\n    </div>\n\n    <?php } ?>\n\n\n    <div class=\"mw-site-theme-selector\">\n        <input id=\"mw_curr_theme_val\" name=\"current_template\" class=\"mw_option_field mw-ui-field\" type=\"hidden\" option-group=\"template\" value=\"<?php print  $selected_template; ?>\" data-id=\"<?php print  $data['id']; ?>\"/>\n        <module type=\"content/views/layout_selector\" show_allow_multiple_template=\"true\" show_save_changes_buttons=\"true\" show_full=\"true\" data-active-site-template=\"<?php print $selected_template ?>\" autoload=\"1\" xxlive_edit_styles_check=\"1\" no-default-name=\"true\"/>\n    </div>\n</div>\n"], "filenames": ["userfiles/modules/settings/group/template.php"], "buggy_code_start_loc": [61], "buggy_code_end_loc": [62], "fixing_code_start_loc": [61], "fixing_code_end_loc": [62], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Generic in GitHub repository microweber/microweber prior to 1.3.3.", "other": {"cve": {"id": "CVE-2023-2014", "sourceIdentifier": "security@huntr.dev", "published": "2023-04-13T02:15:07.193", "lastModified": "2023-04-21T18:09:24.843", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Generic in GitHub repository microweber/microweber prior to 1.3.3."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.5, "impactScore": 4.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:microweber:microweber:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.3.3", "matchCriteriaId": "846F2D65-6C3F-4D7E-902B-774E7890DCC1"}]}]}], "references": [{"url": "https://github.com/microweber/microweber/commit/1a9b904722b35b00653c6ae72dca2969149159b3", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.dev/bounties/a77bf7ed-6b61-452e-b5ee-e20017e28d1a", "source": "security@huntr.dev", "tags": ["Exploit", "Patch"]}]}, "github_commit_url": "https://github.com/microweber/microweber/commit/1a9b904722b35b00653c6ae72dca2969149159b3"}}