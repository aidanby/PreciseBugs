{"buggy_code": ["<?php\n/**\n * Local variables.\n *\n * @var array $available_services\n * @var array $appointment_status_options\n * @var array $timezones\n * @var array $require_first_name\n * @var array $require_last_name\n * @var array $require_email\n * @var array $require_phone_number\n * @var array $require_address\n * @var array $require_city\n * @var array $require_zip_code\n */\n?>\n<div id=\"appointments-modal\" class=\"modal fade\">\n    <div class=\"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h3 class=\"modal-title\"><?= lang('edit_appointment_title') ?></h3>\n                <button class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n            </div>\n\n            <div class=\"modal-body\">\n                <div class=\"modal-message alert d-none\"></div>\n\n                <form>\n                    <fieldset>\n                        <h5 class=\"text-black-50 mb-3 fw-light\"><?= lang('appointment_details_title') ?></h5>\n\n                        <input id=\"appointment-id\" type=\"hidden\">\n\n                        <div class=\"row\">\n                            <div class=\"col-12 col-sm-6\">\n                                <div class=\"mb-3\">\n                                    <label for=\"select-service\" class=\"form-label\">\n                                        <?= lang('service') ?>\n                                        <span class=\"text-danger\">*</span>\n                                    </label>\n                                    <select id=\"select-service\" class=\"required form-control\">\n                                        <?php\n                                        // Group services by category, only if there is at least one service\n                                        // with a parent category.\n                                        $has_category = FALSE;\n                                        foreach ($available_services as $service)\n                                        {\n                                            if ( ! empty($service['category_id']))\n                                            {\n                                                $has_category = TRUE;\n                                                break;\n                                            }\n                                        }\n\n                                        if ($has_category)\n                                        {\n                                            $grouped_services = [];\n\n                                            foreach ($available_services as $service)\n                                            {\n                                                if ( ! empty($service['category_id']))\n                                                {\n                                                    if ( ! isset($grouped_services[$service['category_name']]))\n                                                    {\n                                                        $grouped_services[$service['category_name']] = [];\n                                                    }\n\n                                                    $grouped_services[$service['category_name']][] = $service;\n                                                }\n                                            }\n\n                                            // We need the uncategorized services at the end of the list, so we will use\n                                            // another iteration only for the uncategorized services.\n                                            $grouped_services['uncategorized'] = [];\n                                            foreach ($available_services as $service)\n                                            {\n                                                if ($service['category_id'] == NULL)\n                                                {\n                                                    $grouped_services['uncategorized'][] = $service;\n                                                }\n                                            }\n\n                                            foreach ($grouped_services as $key => $group)\n                                            {\n                                                $group_label = $key !== 'uncategorized'\n                                                    ? $group[0]['category_name']\n                                                    : 'Uncategorized';\n\n                                                if (count($group) > 0)\n                                                {\n                                                    echo '<optgroup label=\"' . $group_label . '\">';\n\n                                                    foreach ($group as $service)\n                                                    {\n                                                        echo '<option value=\"' . $service['id'] . '\">'\n                                                            . $service['name'] . '</option>';\n                                                    }\n\n                                                    echo '</optgroup>';\n                                                }\n                                            }\n                                        }\n                                        else\n                                        {\n                                            foreach ($available_services as $service)\n                                            {\n                                                echo '<option value=\"' . $service['id'] . '\">'\n                                                    . $service['name'] . '</option>';\n                                            }\n                                        }\n                                        ?>\n                                    </select>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"select-provider\" class=\"form-label\">\n                                        <?= lang('provider') ?>\n                                        <span class=\"text-danger\">*</span>\n                                    </label>\n                                    <select id=\"select-provider\" class=\"required form-control\"></select>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <?php component('color_selection', ['attributes' => 'id=\"appointment-color\"']) ?>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"appointment-location\" class=\"form-label\">\n                                        <?= lang('location') ?>\n                                    </label>\n                                    <input id=\"appointment-location\" class=\"form-control\">\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"appointment-status\" class=\"form-label\">\n                                        <?= lang('status') ?>\n                                    </label>\n                                    <select id=\"appointment-status\" class=\"form-control\">\n                                        <?php foreach ($appointment_status_options as $appointment_status_option): ?>\n                                            <option value=\"<?= $appointment_status_option ?>\">\n                                                <?= $appointment_status_option ?>\n                                            </option>\n                                        <?php endforeach ?>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div class=\"col-12 col-sm-6\">\n                                <div class=\"mb-3\">\n                                    <label for=\"start-datetime\"\n                                           class=\"form-label\"><?= lang('start_date_time') ?></label>\n                                    <input id=\"start-datetime\" class=\"required form-control\">\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"end-datetime\" class=\"form-label\"><?= lang('end_date_time') ?></label>\n                                    <input id=\"end-datetime\" class=\"required form-control\">\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label class=\"form-label\">\n                                        <?= lang('timezone') ?>\n                                    </label>\n\n                                    <div\n                                        class=\"border rounded d-flex justify-content-between align-items-center bg-light timezone-info\">\n                                        <div class=\"border-end w-50 p-1 text-center\">\n                                            <?= lang('provider') ?>:\n                                            <span class=\"provider-timezone\">\n                                                -\n                                            </span>\n                                        </div>\n                                        <div class=\"w-50 p-1 text-center\">\n                                            <?= lang('current_user') ?>:\n                                            <span>\n                                                <?= $timezones[session('timezone', 'UTC')] ?>\n                                            </span>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"appointment-notes\" class=\"form-label\"><?= lang('notes') ?></label>\n                                    <textarea id=\"appointment-notes\" class=\"form-control\" rows=\"3\"></textarea>\n                                </div>\n                            </div>\n                        </div>\n                    </fieldset>\n\n                    <br>\n\n                    <fieldset>\n                        <h5 class=\"text-black-50 mb-3 fw-light\">\n                            <?= lang('customer_details_title') ?>\n                            <button id=\"new-customer\" class=\"btn btn-outline-secondary btn-sm\" type=\"button\"\n                                    data-tippy-content=\"<?= lang('clear_fields_add_existing_customer_hint') ?>\">\n                                <i class=\"fas fa-plus-square me-2\"></i>\n                                <?= lang('new') ?>\n                            </button>\n                            <button id=\"select-customer\" class=\"btn btn-outline-secondary btn-sm\" type=\"button\"\n                                    data-tippy-content=\"<?= lang('pick_existing_customer_hint') ?>\">\n                                <i class=\"fas fa-hand-pointer me-2\"></i>\n                                <span>\n                                    <?= lang('select') ?>\n                                </span>\n                            </button>\n\n                            <input id=\"filter-existing-customers\"\n                                   placeholder=\"<?= lang('type_to_filter_customers') ?>\"\n                                   style=\"display: none;\" class=\"input-sm form-control\">\n                        </h5>\n\n                        <div id=\"existing-customers-list\" style=\"display: none;\"></div>\n\n                        <input id=\"customer-id\" type=\"hidden\">\n\n                        <div class=\"row\">\n                            <div class=\"col-12 col-sm-6\">\n                                <div class=\"mb-3\">\n                                    <label for=\"first-name\" class=\"form-label\">\n                                        <?= lang('first_name') ?>\n                                        <?php if ($require_first_name): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"first-name\"\n                                           class=\"<?= $require_first_name ? 'required' : '' ?> form-control\"\n                                           maxlength=\"100\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"last-name\" class=\"form-label\">\n                                        <?= lang('last_name') ?>\n                                        <?php if ($require_last_name): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"last-name\"\n                                           class=\"<?= $require_last_name ? 'required' : '' ?> form-control\"\n                                           maxlength=\"120\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"email\" class=\"form-label\">\n                                        <?= lang('email') ?>\n                                        <?php if ($require_email): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"email\"\n                                           class=\"<?= $require_email ? 'required' : '' ?> form-control\"\n                                           maxlength=\"120\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"phone-number\" class=\"form-label\">\n                                        <?= lang('phone_number') ?>\n                                        <?php if ($require_phone_number): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"phone-number\" maxlength=\"60\"\n                                           class=\"<?= $require_phone_number ? 'required' : '' ?> form-control\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label class=\"form-label\" for=\"language\">\n                                        <?= lang('language') ?>\n                                        <span class=\"text-danger\" hidden>*</span>\n                                    </label>\n                                    <select id=\"language\" class=\"form-control required\">\n                                        <?php foreach (vars('available_languages') as $available_language): ?>\n                                            <option value=\"<?= $available_language ?>\">\n                                                <?= ucfirst($available_language) ?>\n                                            </option>\n                                        <?php endforeach ?>\n                                    </select>\n                                </div>\n                            </div>\n                            <div class=\"col-12 col-sm-6\">\n                                <div class=\"mb-3\">\n                                    <label for=\"address\" class=\"form-label\">\n                                        <?= lang('address') ?>\n                                        <?php if ($require_address): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"address\"\n                                           class=\"<?= $require_address ? 'required' : '' ?> form-control\"\n                                           maxlength=\"120\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"city\" class=\"form-label\">\n                                        <?= lang('city') ?>\n                                        <?php if ($require_city): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"city\"\n                                           class=\"<?= $require_city ? 'required' : '' ?> form-control\"\n                                           maxlength=\"120\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"zip-code\" class=\"form-label\">\n                                        <?= lang('zip_code') ?>\n                                        <?php if ($require_zip_code): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"zip-code\"\n                                           class=\"<?= $require_zip_code ? 'required' : '' ?> form-control\"\n                                           maxlength=\"120\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label class=\"form-label\" for=\"timezone\">\n                                        <?= lang('timezone') ?>\n                                        <span class=\"text-danger\" hidden>*</span>\n                                    </label>\n                                    <?php component('timezone_dropdown', [\n                                        'attributes' => 'id=\"timezone\" class=\"form-control required\"',\n                                        'grouped_timezones' => vars('grouped_timezones')\n                                    ]) ?>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"customer-notes\" class=\"form-label\">\n                                        <?= lang('notes') ?>\n                                        <?php if ($require_zip_code): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <textarea id=\"customer-notes\" rows=\"2\"\n                                              class=\"<?= $require_zip_code ? 'required' : '' ?> form-control\"></textarea>\n                                </div>\n                            </div>\n                        </div>\n                    </fieldset>\n                </form>\n            </div>\n\n            <div class=\"modal-footer\">\n                <button class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\n                    <?= lang('cancel') ?>\n                </button>\n                <button id=\"save-appointment\" class=\"btn btn-primary\">\n                    <i class=\"fas fa-check-square me-2\"></i>\n                    <?= lang('save') ?>\n                </button>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php section('scripts') ?>\n\n<script src=\"<?= asset_url('assets/js/components/appointments_modal.js') ?>\"></script>\n\n<?php section('scripts') ?>\n", "<?php\n/**\n * Local variables.\n * \n * @var string $user_display_name\n */\n?>\n<div id=\"footer\" class=\"d-lg-flex justify-content-lg-start align-items-lg-center p-2 text-center text-lg-left mt-auto\">\n    <div class=\"mb-3 me-lg-5 mb-lg-0\">\n        <img class=\"me-1\" src=\"<?= base_url('assets/img/logo-16x16.png') ?>\" alt=\"Easy!Appointments Logo\">\n        \n        <a href=\"https://easyappointments.org\">Easy!Appointments</a>\n\n        <span>v<?= config('version') ?></span>\n    </div>\n    \n    <div class=\"mb-3 me-lg-5 mb-lg-0\">\n        <img class=\"me-1\" src=\"<?= base_url('assets/img/alextselegidis-logo-16x16.png') ?>\" alt=\"Alex Tselegidis Logo\">\n        \n        <a href=\"https://alextselegidis.com\">Alex Tselegidis</a>\n        \n        &copy; <?= date('Y') ?> - Software Development\n    </div>\n\n    <div class=\"mb-3 me-lg-5 mb-lg-0\">\n        <?= lang('licensed_under') ?>\n        <a href=\"https://www.gnu.org/licenses/gpl-3.0.en.html\">\n            GPL-3.0\n        </a>\n    </div>\n\n    <div class=\"mb-3 me-lg-5 mb-lg-0\">\n        <span id=\"select-language\" class=\"badge bg-dark\">\n            <i class=\"fas fa-language me-2\"></i>\n        \t<?= ucfirst(config('language')) ?>\n        </span>\n    </div>\n\n    <div class=\"mb-3 me-lg-5 mb-lg-0\">\n        <a href=\"<?= site_url('appointments') ?>\">\n            <?= lang('go_to_booking_page') ?>\n        </a>\n    </div>\n\n    <div class=\"ms-lg-auto\">\n        <strong id=\"footer-user-display-name\">\n            <?= lang('hello') . ', ' . $user_display_name ?>!\n        </strong>\n    </div>\n</div>\n\n\n", "<?php\n/**\n * @var string $google_analytics_code\n */\n?>\n\n<?php if (substr($google_analytics_code ?? '', 0, 2) === 'UA'): ?>\n    <script>\n        (function(i,s,o,g,r,a,m){i[\"GoogleAnalyticsObject\"]=r;i[r]=i[r]||function(){\n            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n        })(window,document,\"script\",\"//www.google-analytics.com/analytics.js\",\"ga\");\n        ga(\"create\", \"<?= $google_analytics_code ?>\", \"auto\");\n        ga(\"send\", \"pageview\");\n    </script>\n<?php endif ?>\n\n<?php if (substr($google_analytics_code ?? '', 0, 2) === 'G-'): ?>\n    <script async src=\"https://www.googletagmanager.com/gtag/js?id=' . $google_analytics_code . '\"></script>\n    <script>\n        window.dataLayer = window.dataLayer || [];\n        function gtag(){dataLayer.push(arguments);}\n        gtag(\"js\", new Date());\n        gtag(\"config\", \"<?= $google_analytics_code ?>\");\n    </script>\n<?php endif ?>\n\n", "<?php\n/**\n * @var string $matomo_analytics_url\n */\n?>\n\n<?php if ( ! empty($matomo_analytics_url)): ?>\n\n    <script>\n        var _paq = window._paq = window._paq || [];\n        /* tracker methods like \"setCustomDimension\" should be called before \"trackPageView\" */\n        _paq.push([\"setDocumentTitle\", document.domain + \"/\" + document.title]);\n        _paq.push(['trackPageView']);\n        _paq.push(['enableLinkTracking']);\n        (function () {\n            var u = \"<?= $matomo_analytics_url ?>\";\n            _paq.push(['setTrackerUrl', u + 'matomo.php']);\n            _paq.push(['setSiteId', '1']);\n            var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];\n            g.async = true;\n            g.src = u + 'matomo.js';\n            s.parentNode.insertBefore(g, s);\n        })();\n    </script>\n\n    <noscript>\n        <p><img src=\"<?= $matomo_analytics_url ?>matomo.php?idsite=1&amp;rec=1\" style=\"border:0;\" alt=\"\"/></p>\n    </noscript>\n\n<?php endif ?>\n", "<?php\n/**\n * Local variables.\n *\n * @var string $subject\n * @var string $message\n * @var array $settings\n */\n?>\n<html lang=\"en\">\n<head>\n    <title><?= $subject ?> | Easy!Appointments</title>\n</head>\n<body style=\"font: 13px arial, helvetica, tahoma;\">\n\n<div class=\"email-container\" style=\"width: 650px; border: 1px solid #eee;\">\n    <div id=\"header\" style=\"background-color: #429a82; height: 45px; padding: 10px 15px;\">\n        <strong id=\"logo\" style=\"color: white; font-size: 20px; margin-top: 10px; display: inline-block\">\n            <?= $settings['company_name'] ?>\n        </strong>\n    </div>\n\n    <div id=\"content\" style=\"padding: 10px 15px;\">\n        <h2>\n            <?= $subject ?>\n        </h2>\n        <p>\n            <?= $message ?>\n        </p>\n    </div>\n\n    <div id=\"footer\" style=\"padding: 10px; text-align: center; margin-top: 10px;\n                border-top: 1px solid #EEE; background: #FAFAFA;\">\n        Powered by\n        <a href=\"https://easyappointments.org\" style=\"text-decoration: none;\">\n            Easy!Appointments\n        </a>\n        |\n        <a href=\"<?= $settings['company_link'] ?>\" style=\"text-decoration: none;\">\n            <?= $settings['company_name'] ?>\n        </a>\n    </div>\n</div>\n\n</body>\n</html>\n", "<?php\n/**\n * Local variables.\n *\n * @var array $appointment\n * @var array $service\n * @var array $provider\n * @var array $customer\n * @var array $settings\n * @var array $timezone\n * @var string $reason\n */\n?>\n\n<html lang=\"en\">\n<head>\n    <title><?= lang('appointment_cancelled_title') ?> | Easy!Appointments</title>\n</head>\n<body style=\"font: 13px arial, helvetica, tahoma;\">\n\n<div class=\"email-container\" style=\"width: 650px; border: 1px solid #eee;\">\n    <div id=\"header\" style=\"background-color: #429a82; height: 45px; padding: 10px 15px;\">\n        <strong id=\"logo\" style=\"color: white; font-size: 20px; margin-top: 10px; display: inline-block\">\n            <?= $settings['company_name'] ?>\n        </strong>\n    </div>\n\n    <div id=\"content\" style=\"padding: 10px 15px;\">\n        <h2>\n            <?= lang('appointment_cancelled_title') ?>\n        </h2>\n        \n        <p>\n            <?= lang('appointment_removed_from_schedule') ?>\n        </p>\n\n        <h2>\n            <?= lang('appointment_details_title') ?>\n        </h2>\n\n        <table id=\"appointment-details\">\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('service') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= $service['name'] ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('provider') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= $provider['first_name'] . ' ' . $provider['last_name'] ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('start') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= format_date_time($appointment['start_datetime']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('end') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= format_date_time($appointment['end_datetime']) ?>\n\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('timezone') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= format_timezone($timezone) ?>\n                </td>\n            </tr>\n\n            <?php if ( ! empty($appointment['location'])): ?>\n                <tr>\n                    <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                        <?= lang('location') ?>\n                    </td>\n                    <td style=\"padding: 3px;\">\n                        <?= $appointment['location'] ?>\n                    </td>\n                </tr>\n            <?php endif ?>\n\n            <?php if ( ! empty($appointment['notes'])): ?>\n                <tr>\n                    <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                        <?= lang('notes') ?>\n                    </td>\n                    <td style=\"padding: 3px;\">\n                        <?= $appointment['notes'] ?>\n                    </td>\n                </tr>\n            <?php endif ?>\n        </table>\n\n        <h2>\n            <?= lang('customer_details_title') ?>\n        </h2>\n\n        <table id=\"customer-details\">\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('name') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= $customer['first_name'] . ' ' . $customer['last_name'] ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('email') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= $customer['email'] ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('phone_number') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= $customer['phone_number'] ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('address') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= $customer['address'] ?>\n                </td>\n            </tr>\n        </table>\n\n        <h2>\n            <?= lang('reason') ?>\n        </h2>\n        \n        <p>\n            <?= $reason ?>\n        </p>\n    </div>\n\n    <div id=\"footer\" style=\"padding: 10px; text-align: center; margin-top: 10px;\n                border-top: 1px solid #EEE; background: #FAFAFA;\">\n        Powered by\n        <a href=\"https://easyappointments.org\" style=\"text-decoration: none;\">\n            Easy!Appointments\n        </a>\n        |\n        <a href=\"<?= $settings['company_link'] ?>\" style=\"text-decoration: none;\">\n            <?= $settings['company_name'] ?>\n        </a>\n    </div>\n</div>\n\n</body>\n</html>\n", "<?php\n/**\n * Local variables.\n *\n * @var string $subject\n * @var string $message\n * @var array $appointment\n * @var array $service\n * @var array $provider\n * @var array $customer\n * @var array $settings\n * @var array $timezone\n * @var string $appointment_link\n */\n?>\n\n<html lang=\"en\">\n<head>\n    <title>\n        <?= lang('appointment_details_title') ?> | Easy!Appointments\n    </title>\n</head>\n<body style=\"font: 13px arial, helvetica, tahoma;\">\n\n<div class=\"email-container\" style=\"width: 650px; border: 1px solid #eee;\">\n    <div id=\"header\" style=\"background-color: #429a82; height: 45px; padding: 10px 15px;\">\n        <strong id=\"logo\" style=\"color: white; font-size: 20px; margin-top: 10px; display: inline-block\">\n            <?= $settings['company_name'] ?>\n        </strong>\n    </div>\n\n    <div id=\"content\" style=\"padding: 10px 15px;\">\n        <h2>\n            <?= $subject ?>\n        </h2>\n\n        <p>\n            <?= $message ?>\n        </p>\n\n        <h2>\n            <?= lang('appointment_details_title') ?>\n        </h2>\n\n        <table id=\"appointment-details\">\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('service') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= $service['name'] ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('provider') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= $provider['first_name'] . ' ' . $provider['last_name'] ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('start') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= format_date_time($appointment['start_datetime']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('end') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= format_date_time($appointment['end_datetime']) ?>\n\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('timezone') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= format_timezone($timezone) ?>\n                </td>\n            </tr>\n\n            <?php if ( ! empty($appointment['location'])): ?>\n                <tr>\n                    <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                        <?= lang('location') ?>\n                    </td>\n                    <td style=\"padding: 3px;\">\n                        <?= $appointment['location'] ?>\n                    </td>\n                </tr>\n            <?php endif ?>\n\n            <?php if ( ! empty($appointment['notes'])): ?>\n                <tr>\n                    <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                        <?= lang('notes') ?>\n                    </td>\n                    <td style=\"padding: 3px;\">\n                        <?= $appointment['notes'] ?>\n                    </td>\n                </tr>\n            <?php endif ?>\n        </table>\n\n        <h2>\n            <?= lang('customer_details_title') ?>\n        </h2>\n\n        <table id=\"customer-details\">\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('name') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= $customer['first_name'] . ' ' . $customer['last_name'] ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('email') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= $customer['email'] ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('phone_number') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= $customer['phone_number'] ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('address') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= $customer['address'] ?>\n                </td>\n            </tr>\n        </table>\n\n        <h2>\n            <?= lang('appointment_link_title') ?>\n        </h2>\n\n        <a href=\"<?= $appointment_link ?>\" style=\"width: 600px;\">\n            <?= $appointment_link ?>\n        </a>\n    </div>\n\n    <div id=\"footer\" style=\"padding: 10px; text-align: center; margin-top: 10px;\n                border-top: 1px solid #EEE; background: #FAFAFA;\">\n        Powered by\n        <a href=\"https://easyappointments.org\" style=\"text-decoration: none;\">\n            Easy!Appointments\n        </a>\n        |\n        <a href=\"<?= $settings['company_link'] ?>\" style=\"text-decoration: none;\">\n            <?= $settings['company_name'] ?>\n        </a>\n    </div>\n</div>\n\n</body>\n</html>\n"], "fixing_code": ["<?php\n/**\n * Local variables.\n *\n * @var array $available_services\n * @var array $appointment_status_options\n * @var array $timezones\n * @var array $require_first_name\n * @var array $require_last_name\n * @var array $require_email\n * @var array $require_phone_number\n * @var array $require_address\n * @var array $require_city\n * @var array $require_zip_code\n */\n?>\n<div id=\"appointments-modal\" class=\"modal fade\">\n    <div class=\"modal-dialog modal-dialog-centered modal-dialog-scrollable modal-lg\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h3 class=\"modal-title\"><?= lang('edit_appointment_title') ?></h3>\n                <button class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n            </div>\n\n            <div class=\"modal-body\">\n                <div class=\"modal-message alert d-none\"></div>\n\n                <form>\n                    <fieldset>\n                        <h5 class=\"text-black-50 mb-3 fw-light\"><?= lang('appointment_details_title') ?></h5>\n\n                        <input id=\"appointment-id\" type=\"hidden\">\n\n                        <div class=\"row\">\n                            <div class=\"col-12 col-sm-6\">\n                                <div class=\"mb-3\">\n                                    <label for=\"select-service\" class=\"form-label\">\n                                        <?= lang('service') ?>\n                                        <span class=\"text-danger\">*</span>\n                                    </label>\n                                    <select id=\"select-service\" class=\"required form-control\">\n                                        <?php\n                                        // Group services by category, only if there is at least one service\n                                        // with a parent category.\n                                        $has_category = FALSE;\n                                        \n                                        foreach ($available_services as $service)\n                                        {\n                                            if ( ! empty($service['category_id']))\n                                            {\n                                                $has_category = TRUE;\n                                                break;\n                                            }\n                                        }\n\n                                        if ($has_category)\n                                        {\n                                            $grouped_services = [];\n\n                                            foreach ($available_services as $service)\n                                            {\n                                                if ( ! empty($service['category_id']))\n                                                {\n                                                    if ( ! isset($grouped_services[$service['category_name']]))\n                                                    {\n                                                        $grouped_services[$service['category_name']] = [];\n                                                    }\n\n                                                    $grouped_services[$service['category_name']][] = $service;\n                                                }\n                                            }\n\n                                            // We need the uncategorized services at the end of the list, so we will use\n                                            // another iteration only for the uncategorized services.\n                                            $grouped_services['uncategorized'] = [];\n                                            \n                                            foreach ($available_services as $service)\n                                            {\n                                                if ($service['category_id'] == NULL)\n                                                {\n                                                    $grouped_services['uncategorized'][] = $service;\n                                                }\n                                            }\n\n                                            foreach ($grouped_services as $key => $group)\n                                            {\n                                                $group_label = $key !== 'uncategorized'\n                                                    ? e($group[0]['category_name'])\n                                                    : 'Uncategorized';\n\n                                                if (count($group) > 0)\n                                                {\n                                                    echo '<optgroup label=\"' . $group_label . '\">';\n\n                                                    foreach ($group as $service)\n                                                    {\n                                                        echo '<option value=\"' . $service['id'] . '\">'\n                                                            . e($service['name']) . '</option>';\n                                                    }\n\n                                                    echo '</optgroup>';\n                                                }\n                                            }\n                                        }\n                                        else\n                                        {\n                                            foreach ($available_services as $service)\n                                            {\n                                                echo '<option value=\"' . $service['id'] . '\">'\n                                                    . e($service['name']) . '</option>';\n                                            }\n                                        }\n                                        ?>\n                                    </select>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"select-provider\" class=\"form-label\">\n                                        <?= lang('provider') ?>\n                                        <span class=\"text-danger\">*</span>\n                                    </label>\n                                    <select id=\"select-provider\" class=\"required form-control\"></select>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <?php component('color_selection', ['attributes' => 'id=\"appointment-color\"']) ?>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"appointment-location\" class=\"form-label\">\n                                        <?= lang('location') ?>\n                                    </label>\n                                    <input id=\"appointment-location\" class=\"form-control\">\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"appointment-status\" class=\"form-label\">\n                                        <?= lang('status') ?>\n                                    </label>\n                                    <select id=\"appointment-status\" class=\"form-control\">\n                                        <?php foreach ($appointment_status_options as $appointment_status_option): ?>\n                                            <option value=\"<?= e($appointment_status_option) ?>\">\n                                                <?= e($appointment_status_option) ?>\n                                            </option>\n                                        <?php endforeach ?>\n                                    </select>\n                                </div>\n                            </div>\n\n                            <div class=\"col-12 col-sm-6\">\n                                <div class=\"mb-3\">\n                                    <label for=\"start-datetime\"\n                                           class=\"form-label\"><?= lang('start_date_time') ?></label>\n                                    <input id=\"start-datetime\" class=\"required form-control\">\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"end-datetime\" class=\"form-label\"><?= lang('end_date_time') ?></label>\n                                    <input id=\"end-datetime\" class=\"required form-control\">\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label class=\"form-label\">\n                                        <?= lang('timezone') ?>\n                                    </label>\n\n                                    <div\n                                        class=\"border rounded d-flex justify-content-between align-items-center bg-light timezone-info\">\n                                        <div class=\"border-end w-50 p-1 text-center\">\n                                            <?= lang('provider') ?>:\n                                            <span class=\"provider-timezone\">\n                                                -\n                                            </span>\n                                        </div>\n                                        <div class=\"w-50 p-1 text-center\">\n                                            <?= lang('current_user') ?>:\n                                            <span>\n                                                <?= $timezones[session('timezone', 'UTC')] ?>\n                                            </span>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"appointment-notes\" class=\"form-label\"><?= lang('notes') ?></label>\n                                    <textarea id=\"appointment-notes\" class=\"form-control\" rows=\"3\"></textarea>\n                                </div>\n                            </div>\n                        </div>\n                    </fieldset>\n\n                    <br>\n\n                    <fieldset>\n                        <h5 class=\"text-black-50 mb-3 fw-light\">\n                            <?= lang('customer_details_title') ?>\n                            <button id=\"new-customer\" class=\"btn btn-outline-secondary btn-sm\" type=\"button\"\n                                    data-tippy-content=\"<?= lang('clear_fields_add_existing_customer_hint') ?>\">\n                                <i class=\"fas fa-plus-square me-2\"></i>\n                                <?= lang('new') ?>\n                            </button>\n                            <button id=\"select-customer\" class=\"btn btn-outline-secondary btn-sm\" type=\"button\"\n                                    data-tippy-content=\"<?= lang('pick_existing_customer_hint') ?>\">\n                                <i class=\"fas fa-hand-pointer me-2\"></i>\n                                <span>\n                                    <?= lang('select') ?>\n                                </span>\n                            </button>\n\n                            <input id=\"filter-existing-customers\"\n                                   placeholder=\"<?= lang('type_to_filter_customers') ?>\"\n                                   style=\"display: none;\" class=\"input-sm form-control\">\n                        </h5>\n\n                        <div id=\"existing-customers-list\" style=\"display: none;\"></div>\n\n                        <input id=\"customer-id\" type=\"hidden\">\n\n                        <div class=\"row\">\n                            <div class=\"col-12 col-sm-6\">\n                                <div class=\"mb-3\">\n                                    <label for=\"first-name\" class=\"form-label\">\n                                        <?= lang('first_name') ?>\n                                        <?php if ($require_first_name): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"first-name\"\n                                           class=\"<?= $require_first_name ? 'required' : '' ?> form-control\"\n                                           maxlength=\"100\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"last-name\" class=\"form-label\">\n                                        <?= lang('last_name') ?>\n                                        <?php if ($require_last_name): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"last-name\"\n                                           class=\"<?= $require_last_name ? 'required' : '' ?> form-control\"\n                                           maxlength=\"120\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"email\" class=\"form-label\">\n                                        <?= lang('email') ?>\n                                        <?php if ($require_email): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"email\"\n                                           class=\"<?= $require_email ? 'required' : '' ?> form-control\"\n                                           maxlength=\"120\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"phone-number\" class=\"form-label\">\n                                        <?= lang('phone_number') ?>\n                                        <?php if ($require_phone_number): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"phone-number\" maxlength=\"60\"\n                                           class=\"<?= $require_phone_number ? 'required' : '' ?> form-control\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label class=\"form-label\" for=\"language\">\n                                        <?= lang('language') ?>\n                                        <span class=\"text-danger\" hidden>*</span>\n                                    </label>\n                                    <select id=\"language\" class=\"form-control required\">\n                                        <?php foreach (vars('available_languages') as $available_language): ?>\n                                            <option value=\"<?= $available_language ?>\">\n                                                <?= ucfirst($available_language) ?>\n                                            </option>\n                                        <?php endforeach ?>\n                                    </select>\n                                </div>\n                            </div>\n                            <div class=\"col-12 col-sm-6\">\n                                <div class=\"mb-3\">\n                                    <label for=\"address\" class=\"form-label\">\n                                        <?= lang('address') ?>\n                                        <?php if ($require_address): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"address\"\n                                           class=\"<?= $require_address ? 'required' : '' ?> form-control\"\n                                           maxlength=\"120\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"city\" class=\"form-label\">\n                                        <?= lang('city') ?>\n                                        <?php if ($require_city): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"city\"\n                                           class=\"<?= $require_city ? 'required' : '' ?> form-control\"\n                                           maxlength=\"120\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"zip-code\" class=\"form-label\">\n                                        <?= lang('zip_code') ?>\n                                        <?php if ($require_zip_code): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <input type=\"text\" id=\"zip-code\"\n                                           class=\"<?= $require_zip_code ? 'required' : '' ?> form-control\"\n                                           maxlength=\"120\"/>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label class=\"form-label\" for=\"timezone\">\n                                        <?= lang('timezone') ?>\n                                        <span class=\"text-danger\" hidden>*</span>\n                                    </label>\n                                    <?php component('timezone_dropdown', [\n                                        'attributes' => 'id=\"timezone\" class=\"form-control required\"',\n                                        'grouped_timezones' => vars('grouped_timezones')\n                                    ]) ?>\n                                </div>\n\n                                <div class=\"mb-3\">\n                                    <label for=\"customer-notes\" class=\"form-label\">\n                                        <?= lang('notes') ?>\n                                        <?php if ($require_zip_code): ?>\n                                            <span class=\"text-danger\">*</span>\n                                        <?php endif ?>\n                                    </label>\n                                    <textarea id=\"customer-notes\" rows=\"2\"\n                                              class=\"<?= $require_zip_code ? 'required' : '' ?> form-control\"></textarea>\n                                </div>\n                            </div>\n                        </div>\n                    </fieldset>\n                </form>\n            </div>\n\n            <div class=\"modal-footer\">\n                <button class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">\n                    <?= lang('cancel') ?>\n                </button>\n                <button id=\"save-appointment\" class=\"btn btn-primary\">\n                    <i class=\"fas fa-check-square me-2\"></i>\n                    <?= lang('save') ?>\n                </button>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php section('scripts') ?>\n\n<script src=\"<?= asset_url('assets/js/components/appointments_modal.js') ?>\"></script>\n\n<?php section('scripts') ?>\n", "<?php\n/**\n * Local variables.\n * \n * @var string $user_display_name\n */\n?>\n<div id=\"footer\" class=\"d-lg-flex justify-content-lg-start align-items-lg-center p-2 text-center text-lg-left mt-auto\">\n    <div class=\"mb-3 me-lg-5 mb-lg-0\">\n        <img class=\"me-1\" src=\"<?= base_url('assets/img/logo-16x16.png') ?>\" alt=\"Easy!Appointments Logo\">\n        \n        <a href=\"https://easyappointments.org\">Easy!Appointments</a>\n\n        <span>v<?= config('version') ?></span>\n    </div>\n    \n    <div class=\"mb-3 me-lg-5 mb-lg-0\">\n        <img class=\"me-1\" src=\"<?= base_url('assets/img/alextselegidis-logo-16x16.png') ?>\" alt=\"Alex Tselegidis Logo\">\n        \n        <a href=\"https://alextselegidis.com\">Alex Tselegidis</a>\n        \n        &copy; <?= date('Y') ?> - Software Development\n    </div>\n\n    <div class=\"mb-3 me-lg-5 mb-lg-0\">\n        <?= lang('licensed_under') ?>\n        <a href=\"https://www.gnu.org/licenses/gpl-3.0.en.html\">\n            GPL-3.0\n        </a>\n    </div>\n\n    <div class=\"mb-3 me-lg-5 mb-lg-0\">\n        <span id=\"select-language\" class=\"badge bg-dark\">\n            <i class=\"fas fa-language me-2\"></i>\n        \t<?= ucfirst(config('language')) ?>\n        </span>\n    </div>\n\n    <div class=\"mb-3 me-lg-5 mb-lg-0\">\n        <a href=\"<?= site_url('appointments') ?>\">\n            <?= lang('go_to_booking_page') ?>\n        </a>\n    </div>\n\n    <div class=\"ms-lg-auto\">\n        <strong id=\"footer-user-display-name\">\n            <?= lang('hello') . ', ' . e($user_display_name) ?>!\n        </strong>\n    </div>\n</div>\n\n\n", "<?php\n/**\n * @var string $google_analytics_code\n */\n?>\n\n<?php if (substr($google_analytics_code ?? '', 0, 2) === 'UA'): ?>\n    <script>\n        (function(i,s,o,g,r,a,m){i[\"GoogleAnalyticsObject\"]=r;i[r]=i[r]||function(){\n            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),\n            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)\n        })(window,document,\"script\",\"//www.google-analytics.com/analytics.js\",\"ga\");\n        ga(\"create\", \"<?= e($google_analytics_code) ?>\", \"auto\");\n        ga(\"send\", \"pageview\");\n    </script>\n<?php endif ?>\n\n<?php if (substr($google_analytics_code ?? '', 0, 2) === 'G-'): ?>\n    <script async src=\"https://www.googletagmanager.com/gtag/js?id=' . $google_analytics_code . '\"></script>\n    <script>\n        window.dataLayer = window.dataLayer || [];\n        function gtag(){dataLayer.push(arguments);}\n        gtag(\"js\", new Date());\n        gtag(\"config\", \"<?= e($google_analytics_code) ?>\");\n    </script>\n<?php endif ?>\n\n", "<?php\n/**\n * @var string $matomo_analytics_url\n */\n?>\n\n<?php if ( ! empty($matomo_analytics_url)): ?>\n\n    <script>\n        var _paq = window._paq = window._paq || [];\n        /* tracker methods like \"setCustomDimension\" should be called before \"trackPageView\" */\n        _paq.push([\"setDocumentTitle\", document.domain + \"/\" + document.title]);\n        _paq.push(['trackPageView']);\n        _paq.push(['enableLinkTracking']);\n        (function () {\n            var u = \"<?= e($matomo_analytics_url) ?>\";\n            _paq.push(['setTrackerUrl', u + 'matomo.php']);\n            _paq.push(['setSiteId', '1']);\n            var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];\n            g.async = true;\n            g.src = u + 'matomo.js';\n            s.parentNode.insertBefore(g, s);\n        })();\n    </script>\n\n    <noscript>\n        <p><img src=\"<?= e($matomo_analytics_url) ?>matomo.php?idsite=1&amp;rec=1\" style=\"border:0;\" alt=\"\"/></p>\n    </noscript>\n\n<?php endif ?>\n", "<?php\n/**\n * Local variables.\n *\n * @var string $subject\n * @var string $message\n * @var array $settings\n */\n?>\n<html lang=\"en\">\n<head>\n    <title><?= $subject ?> | Easy!Appointments</title>\n</head>\n<body style=\"font: 13px arial, helvetica, tahoma;\">\n\n<div class=\"email-container\" style=\"width: 650px; border: 1px solid #eee;\">\n    <div id=\"header\" style=\"background-color: #429a82; height: 45px; padding: 10px 15px;\">\n        <strong id=\"logo\" style=\"color: white; font-size: 20px; margin-top: 10px; display: inline-block\">\n            <?= e($settings['company_name']) ?>\n        </strong>\n    </div>\n\n    <div id=\"content\" style=\"padding: 10px 15px;\">\n        <h2>\n            <?= $subject ?>\n        </h2>\n        <p>\n            <?= $message ?>\n        </p>\n    </div>\n\n    <div id=\"footer\" style=\"padding: 10px; text-align: center; margin-top: 10px;\n                border-top: 1px solid #EEE; background: #FAFAFA;\">\n        Powered by\n        <a href=\"https://easyappointments.org\" style=\"text-decoration: none;\">\n            Easy!Appointments\n        </a>\n        |\n        <a href=\"<?= $settings['company_link'] ?>\" style=\"text-decoration: none;\">\n            <?= e($settings['company_name']) ?>\n        </a>\n    </div>\n</div>\n\n</body>\n</html>\n", "<?php\n/**\n * Local variables.\n *\n * @var array $appointment\n * @var array $service\n * @var array $provider\n * @var array $customer\n * @var array $settings\n * @var array $timezone\n * @var string $reason\n */\n?>\n\n<html lang=\"en\">\n<head>\n    <title><?= lang('appointment_cancelled_title') ?> | Easy!Appointments</title>\n</head>\n<body style=\"font: 13px arial, helvetica, tahoma;\">\n\n<div class=\"email-container\" style=\"width: 650px; border: 1px solid #eee;\">\n    <div id=\"header\" style=\"background-color: #429a82; height: 45px; padding: 10px 15px;\">\n        <strong id=\"logo\" style=\"color: white; font-size: 20px; margin-top: 10px; display: inline-block\">\n            <?= e($settings['company_name']) ?>\n        </strong>\n    </div>\n\n    <div id=\"content\" style=\"padding: 10px 15px;\">\n        <h2>\n            <?= lang('appointment_cancelled_title') ?>\n        </h2>\n        \n        <p>\n            <?= lang('appointment_removed_from_schedule') ?>\n        </p>\n\n        <h2>\n            <?= lang('appointment_details_title') ?>\n        </h2>\n\n        <table id=\"appointment-details\">\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('service') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= e($service['name']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('provider') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= e($provider['first_name'] . ' ' . $provider['last_name']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('start') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= format_date_time($appointment['start_datetime']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('end') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= format_date_time($appointment['end_datetime']) ?>\n\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('timezone') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= format_timezone($timezone) ?>\n                </td>\n            </tr>\n\n            <?php if ( ! empty($appointment['location'])): ?>\n                <tr>\n                    <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                        <?= lang('location') ?>\n                    </td>\n                    <td style=\"padding: 3px;\">\n                        <?= e($appointment['location']) ?>\n                    </td>\n                </tr>\n            <?php endif ?>\n\n            <?php if ( ! empty($appointment['notes'])): ?>\n                <tr>\n                    <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                        <?= lang('notes') ?>\n                    </td>\n                    <td style=\"padding: 3px;\">\n                        <?= e($appointment['notes']) ?>\n                    </td>\n                </tr>\n            <?php endif ?>\n        </table>\n\n        <h2>\n            <?= lang('customer_details_title') ?>\n        </h2>\n\n        <table id=\"customer-details\">\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('name') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= e($customer['first_name'] . ' ' . $customer['last_name']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('email') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= e($customer['email']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('phone_number') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= e($customer['phone_number']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('address') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= e($customer['address']) ?>\n                </td>\n            </tr>\n        </table>\n\n        <h2>\n            <?= lang('reason') ?>\n        </h2>\n        \n        <p>\n            <?= e($reason) ?>\n        </p>\n    </div>\n\n    <div id=\"footer\" style=\"padding: 10px; text-align: center; margin-top: 10px;\n                border-top: 1px solid #EEE; background: #FAFAFA;\">\n        Powered by\n        <a href=\"https://easyappointments.org\" style=\"text-decoration: none;\">\n            Easy!Appointments\n        </a>\n        |\n        <a href=\"<?= e($settings['company_link']) ?>\" style=\"text-decoration: none;\">\n            <?= e($settings['company_name']) ?>\n        </a>\n    </div>\n</div>\n\n</body>\n</html>\n", "<?php\n/**\n * Local variables.\n *\n * @var string $subject\n * @var string $message\n * @var array $appointment\n * @var array $service\n * @var array $provider\n * @var array $customer\n * @var array $settings\n * @var array $timezone\n * @var string $appointment_link\n */\n?>\n\n<html lang=\"en\">\n<head>\n    <title>\n        <?= lang('appointment_details_title') ?> | Easy!Appointments\n    </title>\n</head>\n<body style=\"font: 13px arial, helvetica, tahoma;\">\n\n<div class=\"email-container\" style=\"width: 650px; border: 1px solid #eee;\">\n    <div id=\"header\" style=\"background-color: #429a82; height: 45px; padding: 10px 15px;\">\n        <strong id=\"logo\" style=\"color: white; font-size: 20px; margin-top: 10px; display: inline-block\">\n            <?= e($settings['company_name']) ?>\n        </strong>\n    </div>\n\n    <div id=\"content\" style=\"padding: 10px 15px;\">\n        <h2>\n            <?= $subject ?>\n        </h2>\n\n        <p>\n            <?= $message ?>\n        </p>\n\n        <h2>\n            <?= lang('appointment_details_title') ?>\n        </h2>\n\n        <table id=\"appointment-details\">\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('service') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= e($service['name']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('provider') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= e($provider['first_name'] . ' ' . $provider['last_name']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('start') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= format_date_time($appointment['start_datetime']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('end') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= format_date_time($appointment['end_datetime']) ?>\n\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('timezone') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= format_timezone($timezone) ?>\n                </td>\n            </tr>\n\n            <?php if ( ! empty($appointment['location'])): ?>\n                <tr>\n                    <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                        <?= lang('location') ?>\n                    </td>\n                    <td style=\"padding: 3px;\">\n                        <?= e($appointment['location']) ?>\n                    </td>\n                </tr>\n            <?php endif ?>\n\n            <?php if ( ! empty($appointment['notes'])): ?>\n                <tr>\n                    <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                        <?= lang('notes') ?>\n                    </td>\n                    <td style=\"padding: 3px;\">\n                        <?= e($appointment['notes']) ?>\n                    </td>\n                </tr>\n            <?php endif ?>\n        </table>\n\n        <h2>\n            <?= lang('customer_details_title') ?>\n        </h2>\n\n        <table id=\"customer-details\">\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('name') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= e($customer['first_name'] . ' ' . $customer['last_name']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('email') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= e($customer['email']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('phone_number') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= e($customer['phone_number']) ?>\n                </td>\n            </tr>\n            <tr>\n                <td class=\"label\" style=\"padding: 3px;font-weight: bold;\">\n                    <?= lang('address') ?>\n                </td>\n                <td style=\"padding: 3px;\">\n                    <?= e($customer['address']) ?>\n                </td>\n            </tr>\n        </table>\n\n        <h2>\n            <?= lang('appointment_link_title') ?>\n        </h2>\n\n        <a href=\"<?= e($appointment_link) ?>\" style=\"width: 600px;\">\n            <?= e($appointment_link) ?>\n        </a>\n    </div>\n\n    <div id=\"footer\" style=\"padding: 10px; text-align: center; margin-top: 10px;\n                border-top: 1px solid #EEE; background: #FAFAFA;\">\n        Powered by\n        <a href=\"https://easyappointments.org\" style=\"text-decoration: none;\">\n            Easy!Appointments\n        </a>\n        |\n        <a href=\"<?= e($settings['company_link']) ?>\" style=\"text-decoration: none;\">\n            <?= e($settings['company_name']) ?>\n        </a>\n    </div>\n</div>\n\n</body>\n</html>\n"], "filenames": ["application/views/components/appointments_modal.php", "application/views/components/backend_footer.php", "application/views/components/google_analytics_script.php", "application/views/components/matomo_analytics_script.php", "application/views/emails/account_recovery_email.php", "application/views/emails/appointment_deleted_email.php", "application/views/emails/appointment_saved_email.php"], "buggy_code_start_loc": [45, 47, 13, 16, 19, 24, 28], "buggy_code_end_loc": [142, 48, 25, 28, 41, 164, 168], "fixing_code_start_loc": [46, 47, 13, 16, 19, 24, 28], "fixing_code_end_loc": [144, 48, 25, 28, 41, 164, 168], "type": "CWE-94", "message": "Code Injection in GitHub repository alextselegidis/easyappointments prior to 1.5.0.", "other": {"cve": {"id": "CVE-2023-1367", "sourceIdentifier": "security@huntr.dev", "published": "2023-03-13T09:15:10.717", "lastModified": "2023-03-17T13:19:25.527", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Code Injection in GitHub repository alextselegidis/easyappointments prior to 1.5.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.8, "baseSeverity": "LOW"}, "exploitabilityScore": 1.2, "impactScore": 2.5}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 6.0, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 4.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:easyappointments:easyappointments:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.5.0", "matchCriteriaId": "063BC3E9-AA71-49D6-9CEE-F2E7E7B9D687"}]}]}], "references": [{"url": "https://github.com/alextselegidis/easyappointments/commit/453c6e130229718680c91bef450db643a0f263e4", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.dev/bounties/16bc74e2-1825-451f-bff7-bfdc1ea75cc2", "source": "security@huntr.dev", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/alextselegidis/easyappointments/commit/453c6e130229718680c91bef450db643a0f263e4"}}