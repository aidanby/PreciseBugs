{"buggy_code": ["<!DOCTYPE html>\n<html>\n\n<head>\n\t<meta http-equiv=\"Content-type\" content=\"text/html; charset=utf-8;\">\n\t<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n\n\t<title>Paella Auth</title>\n\n\t<script type=\"text/javascript\">\n\t\tfunction onLoad() {\n\n\t\t\tvar search = {};\n\t\t\twindow.location.search.slice(1).split(\"&\").forEach(function (x) {\n\t\t\t\tvar p = x.split(/=(.*)/);\n\t\t\t\tsearch[p[0]] = p[1];\n\t\t\t});\n\n\t\t\tvar redirect = search['redirect'];\n\t\t\tvar id = search['id'];\n\t\t\tvar series = search['series'] || search['sid'] || search['epFrom'];\n\t\t\tif (redirect != undefined) {\n\t\t\t\twindow.location.href = decodeURIComponent(redirect);\n\t\t\t}\n\t\t\telse if (id != undefined) {\n\t\t\t\twindow.location.href = \"watch.html?id=\" + id;\n\t\t\t}\n\t\t\telse if (series != undefined) {\n\t\t\t\twindow.location.href = \"/engage/ui/index.html?epFrom=\" + series;\n\t\t\t}\n\t\t\telse {\n\t\t\t\twindow.location.href = \"/engage/ui/index.html\";\n\t\t\t}\n\t\t}\n\t</script>\n</head>\n\n<body id=\"body\" onload=\"onLoad();\">\n</body>\n\n</html>"], "fixing_code": ["<!DOCTYPE html>\n<html>\n\n<head>\n\t<meta http-equiv=\"Content-type\" content=\"text/html; charset=utf-8;\">\n\t<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n\n\t<title>Paella Auth</title>\n\n\t<script type=\"text/javascript\">\n\t\tfunction onLoad() {\n\n\t\t\tvar search = {};\n\t\t\twindow.location.search.slice(1).split(\"&\").forEach(function (x) {\n\t\t\t\tvar p = x.split(/=(.*)/);\n\t\t\t\tsearch[p[0]] = p[1];\n\t\t\t});\n\n\t\t\tvar redirect = search['redirect'];\n\t\t\tvar id = search['id'];\n\t\t\tvar series = search['series'] || search['sid'] || search['epFrom'];\n\t\t\tif (redirect !== undefined) {\n\t\t\t\tlet redirectDomain = new URL(redirect);\n\t\t\t\tif (window.location.hostname.toUpperCase() === redirectDomain.hostname.toUpperCase()) {\n\t\t\t\t\twindow.location.href = decodeURIComponent(redirect);\n\t\t\t\t} else {\n\t\t\t\t\twindow.location.href = \"/engage/ui/index.html\";\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (id !== undefined) {\n\t\t\t\twindow.location.href = \"watch.html?id=\" + id;\n\t\t\t}\n\t\t\telse if (series !== undefined) {\n\t\t\t\twindow.location.href = \"/engage/ui/index.html?epFrom=\" + series;\n\t\t\t}\n\t\t\telse {\n\t\t\t\twindow.location.href = \"/engage/ui/index.html\";\n\t\t\t}\n\t\t}\n\t</script>\n</head>\n\n<body id=\"body\" onload=\"onLoad();\">\n</body>\n\n</html>"], "filenames": ["modules/engage-paella-player/src/main/paella-opencast/ui/auth.html"], "buggy_code_start_loc": [22], "buggy_code_end_loc": [29], "fixing_code_start_loc": [22], "fixing_code_end_loc": [34], "type": "CWE-601", "message": "Opencast is a free, open-source platform to support the management of educational audio and video content. Prior to Opencast 12.5, Opencast's Paella authentication page could be used to redirect to an arbitrary URL for authenticated users. The vulnerability allows attackers to redirect users to sites outside of one's Opencast install, potentially facilitating phishing attacks or other security issues. This issue is fixed in Opencast 12.5 and newer.", "other": {"cve": {"id": "CVE-2022-41965", "sourceIdentifier": "security-advisories@github.com", "published": "2022-11-28T21:15:10.510", "lastModified": "2022-12-01T23:14:22.927", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Opencast is a free, open-source platform to support the management of educational audio and video content. Prior to Opencast 12.5, Opencast's Paella authentication page could be used to redirect to an arbitrary URL for authenticated users. The vulnerability allows attackers to redirect users to sites outside of one's Opencast install, potentially facilitating phishing attacks or other security issues. This issue is fixed in Opencast 12.5 and newer."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 5.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-601"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apereo:opencast:*:*:*:*:*:*:*:*", "versionEndExcluding": "12.5", "matchCriteriaId": "99C1FC32-BA9D-47F7-9047-B117F9A697EC"}]}]}], "references": [{"url": "https://github.com/opencast/opencast/commit/d2ce2321590f86b066a67e8c231cf68219aea017", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/opencast/opencast/security/advisories/GHSA-r3qr-vwvg-43f7", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/opencast/opencast/commit/d2ce2321590f86b066a67e8c231cf68219aea017"}}