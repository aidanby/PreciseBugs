{"buggy_code": ["<?xml version=\"1.0\" encoding=\"utf-8\"?><!--\n  Nextcloud Android client application\n\n  Copyright (C) 2012  Bartek Przybylski\n  Copyright (C) 2012-2016 ownCloud Inc.\n  Copyright (C) 2016 Nextcloud\n\n  This program is free software: you can redistribute it and/or modify\n  it under the terms of the GNU General Public License version 2,\n  as published by the Free Software Foundation.\n\n  This program is distributed in the hope that it will be useful,\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  GNU General Public License for more details.\n\n  You should have received a copy of the GNU General Public License\n  along with this program.  If not, see <http://www.gnu.org/licenses/>.\n-->\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    package=\"com.owncloud.android\">\n\n    <!-- GET_ACCOUNTS is needed for API <= 22.\n        For API >= 23 results in the addition of CONTACTS group to the list of permissions that may be\n        dynamically disabled or enabled by the user after installation; but it is not important,\n        since GET_ACCOUNTS is an special case, the permission is not really needed to access accounts\n        owned by the app, our use case.\n        See note in http://developer.android.com/intl/es/reference/android/Manifest.permission.html#GET_ACCOUNTS -->\n    <uses-permission\n        android:name=\"android.permission.GET_ACCOUNTS\"\n        android:maxSdkVersion=\"22\" />\n\n    <uses-permission android:name=\"android.permission.READ_CONTACTS\" />\n    <uses-permission android:name=\"android.permission.WRITE_CONTACTS\" />\n\n    <!-- USE_CREDENTIALS, MANAGE_ACCOUNTS and AUTHENTICATE_ACCOUNTS are needed for API <= 22.\n        In API >= 23 they do not exist anymore -->\n    <uses-permission\n        android:name=\"android.permission.USE_CREDENTIALS\"\n        android:maxSdkVersion=\"22\" />\n    <uses-permission\n        android:name=\"android.permission.MANAGE_ACCOUNTS\"\n        android:maxSdkVersion=\"22\" />\n    <uses-permission\n        android:name=\"android.permission.AUTHENTICATE_ACCOUNTS\"\n        android:maxSdkVersion=\"22\" />\n\n    <!-- WRITE_EXTERNAL_STORAGE may be enabled or disabled by the user after installation in\n        API >= 23; the app needs to handle this -->\n    <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\" />\n    <uses-permission android:name=\"android.permission.CAMERA\" />\n    <uses-permission android:name=\"android.permission.VIBRATE\" />\n\n    <!-- Next permissions are always approved in installation time, the apps needs to do nothing special in runtime -->\n    <uses-permission android:name=\"android.permission.INTERNET\" />\n    <uses-permission android:name=\"android.permission.READ_SYNC_STATS\" />\n    <uses-permission android:name=\"android.permission.READ_SYNC_SETTINGS\" />\n    <uses-permission android:name=\"android.permission.WRITE_SYNC_SETTINGS\" />\n    <uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\" />\n    <uses-permission android:name=\"android.permission.RECEIVE_BOOT_COMPLETED\" />\n    <uses-permission android:name=\"android.permission.WAKE_LOCK\" />\n    <uses-permission android:name=\"android.permission.USE_FINGERPRINT\" />\n    <uses-permission android:name=\"android.permission.REQUEST_INSTALL_PACKAGES\" />\n    <uses-permission android:name=\"android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS\" />\n\n    <!-- Apps that target Android 9 (API level 28) or higher and use foreground services\n    must request the FOREGROUND_SERVICE permission -->\n    <uses-permission android:name=\"android.permission.FOREGROUND_SERVICE\" />\n\n    <!-- Some Chromebooks don't support touch. Although not essential,\n         it's a good idea to explicitly include this declaration. -->\n    <uses-feature\n        android:name=\"android.hardware.touchscreen\"\n        android:required=\"false\" />\n\n    <uses-feature\n        android:name=\"android.hardware.camera\"\n        android:required=\"false\" />\n\n    <application\n        android:name=\".MainApp\"\n        android:fullBackupContent=\"@xml/backup_config\"\n        android:icon=\"@mipmap/ic_launcher\"\n        android:installLocation=\"internalOnly\"\n        android:label=\"@string/app_name\"\n        android:manageSpaceActivity=\"com.owncloud.android.ui.activity.ManageSpaceActivity\"\n        android:networkSecurityConfig=\"@xml/network_security_config\"\n        android:requestLegacyExternalStorage=\"true\"\n        android:roundIcon=\"@mipmap/ic_launcher\"\n        android:supportsRtl=\"true\"\n        android:theme=\"@style/Theme.ownCloud.Toolbar\"\n        android:usesCleartextTraffic=\"true\"\n        tools:ignore=\"UnusedAttribute\">\n\n        <uses-library\n            android:name=\"org.apache.http.legacy\"\n            android:required=\"false\" />\n\n        <activity\n            android:name=\".ui.activity.FileDisplayActivity\"\n            android:configChanges=\"orientation|screenSize\"\n            android:exported=\"true\"\n            android:label=\"@string/app_name\"\n            android:launchMode=\"singleTop\"\n            android:theme=\"@style/Theme.ownCloud.Launcher\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.MAIN\" />\n\n                <category android:name=\"android.intent.category.LAUNCHER\" />\n            </intent-filter>\n            <intent-filter>\n                <action android:name=\"android.intent.action.SEARCH\" />\n            </intent-filter>\n            <intent-filter>\n                <action android:name=\"android.intent.action.VIEW\" />\n\n                <category android:name=\"android.intent.category.DEFAULT\" />\n                <category android:name=\"android.intent.category.BROWSABLE\" />\n\n                <data android:scheme=\"http\" />\n                <data android:scheme=\"https\" />\n                <data android:host=\"*\" />\n                <data android:pathPattern=\"/f/..*\" />\n                <data android:pathPattern=\"/..*/f/..*\" />\n                <data android:pathPattern=\"/..*/..*/f/..*\" />\n                <data android:pathPattern=\"/..*/..*/..*/f/..*\" />\n            </intent-filter>\n\n            <meta-data\n                android:name=\"android.app.searchable\"\n                android:resource=\"@xml/users_and_groups_searchable\" />\n        </activity>\n        <activity\n            android:name=\".ui.activity.ManageAccountsActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.UserInfoActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.NotificationsActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.CommunityActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activities.ActivitiesActivity\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.SyncedFoldersActivity\"\n            android:exported=\"false\" />\n\n        <receiver\n            android:name=\"com.nextcloud.client.jobs.MediaFoldersDetectionWork$NotificationReceiver\"\n            android:exported=\"false\" />\n        <receiver\n            android:name=\"com.nextcloud.client.jobs.NotificationWork$NotificationReceiver\"\n            android:exported=\"false\" />\n\n        <activity\n            android:name=\".ui.activity.UploadFilesActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.ExternalSiteWebView\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.RichDocumentsEditorWebView\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.TextEditorWebView\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.ContactsPreferenceActivity\"\n            android:exported=\"false\"\n            android:launchMode=\"singleInstance\" />\n        <activity\n            android:name=\".ui.activity.ReceiveExternalFilesActivity\"\n            android:excludeFromRecents=\"true\"\n            android:exported=\"true\"\n            android:taskAffinity=\"\"\n            android:theme=\"@style/Theme.ownCloud.NoActionBar\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.SEND\" />\n                <category android:name=\"android.intent.category.DEFAULT\" />\n                <data android:mimeType=\"*/*\" />\n            </intent-filter>\n            <intent-filter>\n                <action android:name=\"android.intent.action.SEND_MULTIPLE\" />\n                <category android:name=\"android.intent.category.DEFAULT\" />\n                <data android:mimeType=\"*/*\" />\n            </intent-filter>\n        </activity>\n        <activity\n            android:name=\".ui.activity.SettingsActivity\"\n            android:exported=\"false\"\n            android:theme=\"@style/Theme.ownCloud\" />\n        <activity\n            android:name=\".ui.preview.PreviewImageActivity\"\n            android:exported=\"false\"\n            android:theme=\"@style/Theme.ownCloud.Overlay\" />\n        <activity\n            android:name=\".ui.preview.PreviewVideoActivity\"\n            android:exported=\"false\"\n            android:label=\"@string/app_name\"\n            android:theme=\"@style/Theme.ownCloud.Fullscreen\" />\n\n        <service\n            android:name=\".authentication.AccountAuthenticatorService\"\n            android:exported=\"false\">\n            <intent-filter android:priority=\"100\">\n                <action android:name=\"android.accounts.AccountAuthenticator\" />\n            </intent-filter>\n\n            <meta-data\n                android:name=\"android.accounts.AccountAuthenticator\"\n                android:resource=\"@xml/authenticator\" />\n        </service>\n\n        <service\n            android:name=\".syncadapter.FileSyncService\"\n            android:exported=\"true\">\n            <intent-filter>\n                <action android:name=\"android.content.SyncAdapter\" />\n            </intent-filter>\n\n            <meta-data\n                android:name=\"android.content.SyncAdapter\"\n                android:resource=\"@xml/syncadapter_files\" />\n        </service>\n\n        <provider\n            android:name=\".providers.FileContentProvider\"\n            android:authorities=\"@string/authority\"\n            android:enabled=\"true\"\n            android:exported=\"true\"\n            android:label=\"@string/sync_string_files\"\n            android:syncable=\"true\">\n            <path-permission\n                android:pathPrefix=\"/shares\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/capabilities\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/uploads\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/synced_folders\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/external_links\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/arbitrary_data\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/virtual\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/filesystem\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n        </provider>\n\n        <provider\n            android:name=\".providers.UsersAndGroupsSearchProvider\"\n            android:authorities=\"@string/users_and_groups_search_authority\"\n            android:enabled=\"true\"\n            android:exported=\"false\"\n            android:label=\"@string/share_search\" />\n\n        <provider\n            android:name=\".providers.DocumentsStorageProvider\"\n            android:authorities=\"@string/document_provider_authority\"\n            android:enabled=\"true\"\n            android:exported=\"true\"\n            android:grantUriPermissions=\"true\"\n            android:permission=\"android.permission.MANAGE_DOCUMENTS\">\n            <intent-filter>\n                <action android:name=\"android.content.action.DOCUMENTS_PROVIDER\" />\n            </intent-filter>\n        </provider>\n\n        <!-- new provider used to generate URIs without file:// scheme (forbidden from Android 7) -->\n        <provider\n            android:name=\"androidx.core.content.FileProvider\"\n            android:authorities=\"@string/file_provider_authority\"\n            android:exported=\"false\"\n            android:grantUriPermissions=\"true\">\n            <meta-data\n                android:name=\"android.support.FILE_PROVIDER_PATHS\"\n                android:resource=\"@xml/exposed_filepaths\" />\n        </provider>\n\n        <provider\n            android:name=\".providers.DiskLruImageCacheFileProvider\"\n            android:authorities=\"@string/image_cache_provider_authority\"\n            android:exported=\"true\"\n            android:grantUriPermissions=\"true\"\n            android:readPermission=\"android.permission.MANAGE_DOCUMENTS\" />\n\n        <!-- Disable WorkManager initialization. Whoever designed this, should pay closer attention -->\n        <!-- to \"best before\" dates in his fridge. -->\n        <provider\n            android:name=\"androidx.work.impl.WorkManagerInitializer\"\n            android:authorities=\".workmanager-init\"\n            android:exported=\"false\"\n            tools:node=\"remove\" />\n\n        <activity\n            android:name=\".authentication.AuthenticatorActivity\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"true\"\n            android:launchMode=\"singleTask\"\n            android:theme=\"@style/Theme.ownCloud.noActionBar.Login\">\n            <intent-filter>\n                <action android:name=\"com.owncloud.android.workaround.accounts.CREATE\" />\n\n                <category android:name=\"android.intent.category.DEFAULT\" />\n            </intent-filter>\n        </activity>\n\n        <activity\n            android:name=\".authentication.DeepLinkLoginActivity\"\n            android:clearTaskOnLaunch=\"true\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"true\"\n            android:launchMode=\"singleTask\"\n            android:theme=\"@style/Theme.ownCloud.noActionBar.Login\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.VIEW\" />\n\n                <category android:name=\"android.intent.category.DEFAULT\" />\n                <category android:name=\"android.intent.category.BROWSABLE\" />\n\n                <data\n                    android:host=\"login\"\n                    android:scheme=\"@string/login_data_own_scheme\" />\n            </intent-filter>\n        </activity>\n\n        <service\n            android:name=\".services.OperationsService\"\n            android:exported=\"false\" />\n        <service\n            android:name=\".files.services.FileDownloader\"\n            android:exported=\"false\" />\n        <service\n            android:name=\"com.nextcloud.client.files.downloader.FileTransferService\"\n            android:exported=\"false\" />\n        <service\n            android:name=\".files.services.FileUploader\"\n            android:exported=\"false\" />\n        <service\n            android:name=\"com.nextcloud.client.media.PlayerService\"\n            android:exported=\"false\" />\n\n        <activity\n            android:name=\".ui.activity.PassCodeActivity\"\n            android:exported=\"false\"\n            android:launchMode=\"singleTask\" />\n        <activity\n            android:name=\".ui.activity.RequestCredentialsActivity\"\n            android:exported=\"false\"\n            android:launchMode=\"singleTask\" />\n        <activity\n            android:name=\".ui.activity.ConflictsResolveActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.ErrorsWhileCopyingHandlerActivity\"\n            android:exported=\"false\" />\n\n        <activity\n            android:name=\"com.nextcloud.client.logger.ui.LogsActivity\"\n            android:exported=\"false\" />\n\n        <activity\n            android:name=\"com.nextcloud.client.errorhandling.ShowErrorActivity\"\n            android:excludeFromRecents=\"true\"\n            android:exported=\"false\"\n            android:finishOnTaskLaunch=\"true\"\n            android:launchMode=\"singleInstance\"\n            android:process=\":crash\"\n            android:theme=\"@style/Theme.ownCloud.Toolbar\" />\n        <activity\n            android:name=\".ui.activity.UploadListActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.trashbin.TrashbinActivity\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"true\" />\n        <activity\n            android:name=\"com.nextcloud.client.onboarding.WhatsNewActivity\"\n            android:theme=\"@style/Theme.ownCloud.noActionBar.Login\" />\n        <activity\n            android:name=\"com.nextcloud.client.onboarding.FirstRunActivity\"\n            android:configChanges=\"orientation|screenSize\"\n            android:exported=\"false\"\n            android:theme=\"@style/Theme.ownCloud.noActionBar.Login\" />\n\n        <receiver\n            android:name=\".files.BootupBroadcastReceiver\"\n            android:exported=\"true\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.BOOT_COMPLETED\" />\n                <action android:name=\"android.intent.action.QUICKBOOT_POWERON\" />\n                <action android:name=\"com.htc.intent.action.QUICKBOOT_POWERON\" />\n                <action android:name=\"android.intent.action.MY_PACKAGE_REPLACED\" />\n            </intent-filter>\n        </receiver>\n\n        <activity\n            android:name=\".ui.activity.CopyToClipboardActivity\"\n            android:exported=\"false\"\n            android:icon=\"@drawable/shared_via_link\"\n            android:label=\"@string/copy_link\" />\n        <activity\n            android:name=\".ui.activity.FolderPickerActivity\"\n            android:exported=\"false\"\n            android:label=\"@string/app_name\" />\n        <activity\n            android:name=\".ui.activity.FilePickerActivity\"\n            android:exported=\"false\"\n            android:label=\"@string/app_name\"\n            android:launchMode=\"singleTop\"\n            android:theme=\"@style/Theme.ownCloud.Dialog.NoTitle\"\n            android:windowSoftInputMode=\"adjustResize\" />\n        <activity\n            android:name=\".ui.activity.ShareActivity\"\n            android:exported=\"false\"\n            android:label=\"@string/share_dialog_title\"\n            android:launchMode=\"singleTop\"\n            android:theme=\"@style/Theme.ownCloud.Dialog.NoTitle\"\n            android:windowSoftInputMode=\"adjustResize\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.SEARCH\" />\n            </intent-filter>\n            <meta-data\n                android:name=\"android.app.searchable\"\n                android:resource=\"@xml/users_and_groups_searchable\" />\n        </activity>\n        <activity\n            android:name=\".ui.activity.ManageSpaceActivity\"\n            android:exported=\"false\"\n            android:label=\"@string/manage_space_title\"\n            android:theme=\"@style/Theme.ownCloud\" />\n\n\n        <service\n            android:name=\".services.AccountManagerService\"\n            android:enabled=\"true\"\n            android:exported=\"false\" />\n\n        <activity\n            android:name=\".ui.activity.SsoGrantPermissionActivity\"\n            android:exported=\"true\"\n            android:theme=\"@style/Theme.ownCloud.Dialog.NoTitle\" />\n\n        <activity\n            android:name=\"com.nextcloud.client.etm.EtmActivity\"\n            android:exported=\"false\"\n            android:theme=\"@style/Theme.ownCloud.Toolbar\" />\n    </application>\n\n    <queries>\n        <package android:name=\"it.niedermann.nextcloud.deck\" />\n        <package android:name=\"it.niedermann.nextcloud.deck.play\" />\n        <package android:name=\"it.niedermann.nextcloud.deck.dev\" />\n    </queries>\n</manifest>\n"], "fixing_code": ["<?xml version=\"1.0\" encoding=\"utf-8\"?><!--\n  Nextcloud Android client application\n\n  Copyright (C) 2012  Bartek Przybylski\n  Copyright (C) 2012-2016 ownCloud Inc.\n  Copyright (C) 2016 Nextcloud\n\n  This program is free software: you can redistribute it and/or modify\n  it under the terms of the GNU General Public License version 2,\n  as published by the Free Software Foundation.\n\n  This program is distributed in the hope that it will be useful,\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n  GNU General Public License for more details.\n\n  You should have received a copy of the GNU General Public License\n  along with this program.  If not, see <http://www.gnu.org/licenses/>.\n-->\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    package=\"com.owncloud.android\">\n\n    <!-- GET_ACCOUNTS is needed for API <= 22.\n        For API >= 23 results in the addition of CONTACTS group to the list of permissions that may be\n        dynamically disabled or enabled by the user after installation; but it is not important,\n        since GET_ACCOUNTS is an special case, the permission is not really needed to access accounts\n        owned by the app, our use case.\n        See note in http://developer.android.com/intl/es/reference/android/Manifest.permission.html#GET_ACCOUNTS -->\n    <uses-permission\n        android:name=\"android.permission.GET_ACCOUNTS\"\n        android:maxSdkVersion=\"22\" />\n\n    <uses-permission android:name=\"android.permission.READ_CONTACTS\" />\n    <uses-permission android:name=\"android.permission.WRITE_CONTACTS\" />\n\n    <!-- USE_CREDENTIALS, MANAGE_ACCOUNTS and AUTHENTICATE_ACCOUNTS are needed for API <= 22.\n        In API >= 23 they do not exist anymore -->\n    <uses-permission\n        android:name=\"android.permission.USE_CREDENTIALS\"\n        android:maxSdkVersion=\"22\" />\n    <uses-permission\n        android:name=\"android.permission.MANAGE_ACCOUNTS\"\n        android:maxSdkVersion=\"22\" />\n    <uses-permission\n        android:name=\"android.permission.AUTHENTICATE_ACCOUNTS\"\n        android:maxSdkVersion=\"22\" />\n\n    <!-- WRITE_EXTERNAL_STORAGE may be enabled or disabled by the user after installation in\n        API >= 23; the app needs to handle this -->\n    <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\" />\n    <uses-permission android:name=\"android.permission.CAMERA\" />\n    <uses-permission android:name=\"android.permission.VIBRATE\" />\n\n    <!-- Next permissions are always approved in installation time, the apps needs to do nothing special in runtime -->\n    <uses-permission android:name=\"android.permission.INTERNET\" />\n    <uses-permission android:name=\"android.permission.READ_SYNC_STATS\" />\n    <uses-permission android:name=\"android.permission.READ_SYNC_SETTINGS\" />\n    <uses-permission android:name=\"android.permission.WRITE_SYNC_SETTINGS\" />\n    <uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\" />\n    <uses-permission android:name=\"android.permission.RECEIVE_BOOT_COMPLETED\" />\n    <uses-permission android:name=\"android.permission.WAKE_LOCK\" />\n    <uses-permission android:name=\"android.permission.USE_FINGERPRINT\" />\n    <uses-permission android:name=\"android.permission.REQUEST_INSTALL_PACKAGES\" />\n    <uses-permission android:name=\"android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS\" />\n\n    <!-- Apps that target Android 9 (API level 28) or higher and use foreground services\n    must request the FOREGROUND_SERVICE permission -->\n    <uses-permission android:name=\"android.permission.FOREGROUND_SERVICE\" />\n\n    <!-- Some Chromebooks don't support touch. Although not essential,\n         it's a good idea to explicitly include this declaration. -->\n    <uses-feature\n        android:name=\"android.hardware.touchscreen\"\n        android:required=\"false\" />\n\n    <uses-feature\n        android:name=\"android.hardware.camera\"\n        android:required=\"false\" />\n\n    <application\n        android:name=\".MainApp\"\n        android:fullBackupContent=\"@xml/backup_config\"\n        android:icon=\"@mipmap/ic_launcher\"\n        android:installLocation=\"internalOnly\"\n        android:label=\"@string/app_name\"\n        android:manageSpaceActivity=\"com.owncloud.android.ui.activity.ManageSpaceActivity\"\n        android:networkSecurityConfig=\"@xml/network_security_config\"\n        android:requestLegacyExternalStorage=\"true\"\n        android:roundIcon=\"@mipmap/ic_launcher\"\n        android:supportsRtl=\"true\"\n        android:theme=\"@style/Theme.ownCloud.Toolbar\"\n        android:usesCleartextTraffic=\"true\"\n        tools:ignore=\"UnusedAttribute\">\n\n        <uses-library\n            android:name=\"org.apache.http.legacy\"\n            android:required=\"false\" />\n\n        <activity\n            android:name=\".ui.activity.FileDisplayActivity\"\n            android:configChanges=\"orientation|screenSize\"\n            android:exported=\"true\"\n            android:label=\"@string/app_name\"\n            android:launchMode=\"singleTop\"\n            android:theme=\"@style/Theme.ownCloud.Launcher\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.MAIN\" />\n\n                <category android:name=\"android.intent.category.LAUNCHER\" />\n            </intent-filter>\n            <intent-filter>\n                <action android:name=\"android.intent.action.SEARCH\" />\n            </intent-filter>\n            <intent-filter>\n                <action android:name=\"android.intent.action.VIEW\" />\n\n                <category android:name=\"android.intent.category.DEFAULT\" />\n                <category android:name=\"android.intent.category.BROWSABLE\" />\n\n                <data android:scheme=\"http\" />\n                <data android:scheme=\"https\" />\n                <data android:host=\"*\" />\n                <data android:pathPattern=\"/f/..*\" />\n                <data android:pathPattern=\"/..*/f/..*\" />\n                <data android:pathPattern=\"/..*/..*/f/..*\" />\n                <data android:pathPattern=\"/..*/..*/..*/f/..*\" />\n            </intent-filter>\n\n            <meta-data\n                android:name=\"android.app.searchable\"\n                android:resource=\"@xml/users_and_groups_searchable\" />\n        </activity>\n        <activity\n            android:name=\".ui.activity.ManageAccountsActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.UserInfoActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.NotificationsActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.CommunityActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activities.ActivitiesActivity\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.SyncedFoldersActivity\"\n            android:exported=\"false\" />\n\n        <receiver\n            android:name=\"com.nextcloud.client.jobs.MediaFoldersDetectionWork$NotificationReceiver\"\n            android:exported=\"false\" />\n        <receiver\n            android:name=\"com.nextcloud.client.jobs.NotificationWork$NotificationReceiver\"\n            android:exported=\"false\" />\n\n        <activity\n            android:name=\".ui.activity.UploadFilesActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.ExternalSiteWebView\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.RichDocumentsEditorWebView\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.TextEditorWebView\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.ContactsPreferenceActivity\"\n            android:exported=\"false\"\n            android:launchMode=\"singleInstance\" />\n        <activity\n            android:name=\".ui.activity.ReceiveExternalFilesActivity\"\n            android:excludeFromRecents=\"true\"\n            android:exported=\"true\"\n            android:taskAffinity=\"\"\n            android:theme=\"@style/Theme.ownCloud.NoActionBar\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.SEND\" />\n                <category android:name=\"android.intent.category.DEFAULT\" />\n                <data android:mimeType=\"*/*\" />\n            </intent-filter>\n            <intent-filter>\n                <action android:name=\"android.intent.action.SEND_MULTIPLE\" />\n                <category android:name=\"android.intent.category.DEFAULT\" />\n                <data android:mimeType=\"*/*\" />\n            </intent-filter>\n        </activity>\n        <activity\n            android:name=\".ui.activity.SettingsActivity\"\n            android:exported=\"false\"\n            android:theme=\"@style/Theme.ownCloud\" />\n        <activity\n            android:name=\".ui.preview.PreviewImageActivity\"\n            android:exported=\"false\"\n            android:theme=\"@style/Theme.ownCloud.Overlay\" />\n        <activity\n            android:name=\".ui.preview.PreviewVideoActivity\"\n            android:exported=\"false\"\n            android:label=\"@string/app_name\"\n            android:theme=\"@style/Theme.ownCloud.Fullscreen\" />\n\n        <service\n            android:name=\".authentication.AccountAuthenticatorService\"\n            android:exported=\"false\">\n            <intent-filter android:priority=\"100\">\n                <action android:name=\"android.accounts.AccountAuthenticator\" />\n            </intent-filter>\n\n            <meta-data\n                android:name=\"android.accounts.AccountAuthenticator\"\n                android:resource=\"@xml/authenticator\" />\n        </service>\n\n        <service\n            android:name=\".syncadapter.FileSyncService\"\n            android:exported=\"true\">\n            <intent-filter>\n                <action android:name=\"android.content.SyncAdapter\" />\n            </intent-filter>\n\n            <meta-data\n                android:name=\"android.content.SyncAdapter\"\n                android:resource=\"@xml/syncadapter_files\" />\n        </service>\n\n        <provider\n            android:name=\".providers.FileContentProvider\"\n            android:authorities=\"@string/authority\"\n            android:enabled=\"true\"\n            android:exported=\"true\"\n            android:label=\"@string/sync_string_files\"\n            android:syncable=\"true\">\n            <path-permission\n                android:pathPrefix=\"/shares\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/capabilities\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/uploads\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/synced_folders\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/external_links\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/arbitrary_data\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/virtual\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n            <path-permission\n                android:pathPrefix=\"/filesystem\"\n                android:readPermission=\"false\"\n                android:writePermission=\"false\" />\n        </provider>\n\n        <provider\n            android:name=\".providers.UsersAndGroupsSearchProvider\"\n            android:authorities=\"@string/users_and_groups_search_authority\"\n            android:enabled=\"true\"\n            android:exported=\"false\"\n            android:label=\"@string/share_search\" />\n\n        <provider\n            android:name=\".providers.DocumentsStorageProvider\"\n            android:authorities=\"@string/document_provider_authority\"\n            android:enabled=\"true\"\n            android:exported=\"true\"\n            android:grantUriPermissions=\"true\"\n            android:permission=\"android.permission.MANAGE_DOCUMENTS\">\n            <intent-filter>\n                <action android:name=\"android.content.action.DOCUMENTS_PROVIDER\" />\n            </intent-filter>\n        </provider>\n\n        <!-- new provider used to generate URIs without file:// scheme (forbidden from Android 7) -->\n        <provider\n            android:name=\"androidx.core.content.FileProvider\"\n            android:authorities=\"@string/file_provider_authority\"\n            android:exported=\"false\"\n            android:grantUriPermissions=\"true\">\n            <meta-data\n                android:name=\"android.support.FILE_PROVIDER_PATHS\"\n                android:resource=\"@xml/exposed_filepaths\" />\n        </provider>\n\n        <provider\n            android:name=\".providers.DiskLruImageCacheFileProvider\"\n            android:authorities=\"@string/image_cache_provider_authority\"\n            android:grantUriPermissions=\"true\"\n            android:permission=\"android.permission.MANAGE_DOCUMENTS\"\n            android:exported=\"true\">\n        </provider>\n\n        <!-- Disable WorkManager initialization. Whoever designed this, should pay closer attention -->\n        <!-- to \"best before\" dates in his fridge. -->\n        <provider\n            android:name=\"androidx.work.impl.WorkManagerInitializer\"\n            android:authorities=\".workmanager-init\"\n            android:exported=\"false\"\n            tools:node=\"remove\" />\n\n        <activity\n            android:name=\".authentication.AuthenticatorActivity\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"true\"\n            android:launchMode=\"singleTask\"\n            android:theme=\"@style/Theme.ownCloud.noActionBar.Login\">\n            <intent-filter>\n                <action android:name=\"com.owncloud.android.workaround.accounts.CREATE\" />\n\n                <category android:name=\"android.intent.category.DEFAULT\" />\n            </intent-filter>\n        </activity>\n\n        <activity\n            android:name=\".authentication.DeepLinkLoginActivity\"\n            android:clearTaskOnLaunch=\"true\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"true\"\n            android:launchMode=\"singleTask\"\n            android:theme=\"@style/Theme.ownCloud.noActionBar.Login\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.VIEW\" />\n\n                <category android:name=\"android.intent.category.DEFAULT\" />\n                <category android:name=\"android.intent.category.BROWSABLE\" />\n\n                <data\n                    android:host=\"login\"\n                    android:scheme=\"@string/login_data_own_scheme\" />\n            </intent-filter>\n        </activity>\n\n        <service\n            android:name=\".services.OperationsService\"\n            android:exported=\"false\" />\n        <service\n            android:name=\".files.services.FileDownloader\"\n            android:exported=\"false\" />\n        <service\n            android:name=\"com.nextcloud.client.files.downloader.FileTransferService\"\n            android:exported=\"false\" />\n        <service\n            android:name=\".files.services.FileUploader\"\n            android:exported=\"false\" />\n        <service\n            android:name=\"com.nextcloud.client.media.PlayerService\"\n            android:exported=\"false\" />\n\n        <activity\n            android:name=\".ui.activity.PassCodeActivity\"\n            android:exported=\"false\"\n            android:launchMode=\"singleTask\" />\n        <activity\n            android:name=\".ui.activity.RequestCredentialsActivity\"\n            android:exported=\"false\"\n            android:launchMode=\"singleTask\" />\n        <activity\n            android:name=\".ui.activity.ConflictsResolveActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.activity.ErrorsWhileCopyingHandlerActivity\"\n            android:exported=\"false\" />\n\n        <activity\n            android:name=\"com.nextcloud.client.logger.ui.LogsActivity\"\n            android:exported=\"false\" />\n\n        <activity\n            android:name=\"com.nextcloud.client.errorhandling.ShowErrorActivity\"\n            android:excludeFromRecents=\"true\"\n            android:exported=\"false\"\n            android:finishOnTaskLaunch=\"true\"\n            android:launchMode=\"singleInstance\"\n            android:process=\":crash\"\n            android:theme=\"@style/Theme.ownCloud.Toolbar\" />\n        <activity\n            android:name=\".ui.activity.UploadListActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".ui.trashbin.TrashbinActivity\"\n            android:configChanges=\"orientation|screenSize|keyboardHidden\"\n            android:exported=\"true\" />\n        <activity\n            android:name=\"com.nextcloud.client.onboarding.WhatsNewActivity\"\n            android:theme=\"@style/Theme.ownCloud.noActionBar.Login\" />\n        <activity\n            android:name=\"com.nextcloud.client.onboarding.FirstRunActivity\"\n            android:configChanges=\"orientation|screenSize\"\n            android:exported=\"false\"\n            android:theme=\"@style/Theme.ownCloud.noActionBar.Login\" />\n\n        <receiver\n            android:name=\".files.BootupBroadcastReceiver\"\n            android:exported=\"true\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.BOOT_COMPLETED\" />\n                <action android:name=\"android.intent.action.QUICKBOOT_POWERON\" />\n                <action android:name=\"com.htc.intent.action.QUICKBOOT_POWERON\" />\n                <action android:name=\"android.intent.action.MY_PACKAGE_REPLACED\" />\n            </intent-filter>\n        </receiver>\n\n        <activity\n            android:name=\".ui.activity.CopyToClipboardActivity\"\n            android:exported=\"false\"\n            android:icon=\"@drawable/shared_via_link\"\n            android:label=\"@string/copy_link\" />\n        <activity\n            android:name=\".ui.activity.FolderPickerActivity\"\n            android:exported=\"false\"\n            android:label=\"@string/app_name\" />\n        <activity\n            android:name=\".ui.activity.FilePickerActivity\"\n            android:exported=\"false\"\n            android:label=\"@string/app_name\"\n            android:launchMode=\"singleTop\"\n            android:theme=\"@style/Theme.ownCloud.Dialog.NoTitle\"\n            android:windowSoftInputMode=\"adjustResize\" />\n        <activity\n            android:name=\".ui.activity.ShareActivity\"\n            android:exported=\"false\"\n            android:label=\"@string/share_dialog_title\"\n            android:launchMode=\"singleTop\"\n            android:theme=\"@style/Theme.ownCloud.Dialog.NoTitle\"\n            android:windowSoftInputMode=\"adjustResize\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.SEARCH\" />\n            </intent-filter>\n            <meta-data\n                android:name=\"android.app.searchable\"\n                android:resource=\"@xml/users_and_groups_searchable\" />\n        </activity>\n        <activity\n            android:name=\".ui.activity.ManageSpaceActivity\"\n            android:exported=\"false\"\n            android:label=\"@string/manage_space_title\"\n            android:theme=\"@style/Theme.ownCloud\" />\n\n\n        <service\n            android:name=\".services.AccountManagerService\"\n            android:enabled=\"true\"\n            android:exported=\"false\" />\n\n        <activity\n            android:name=\".ui.activity.SsoGrantPermissionActivity\"\n            android:exported=\"true\"\n            android:theme=\"@style/Theme.ownCloud.Dialog.NoTitle\" />\n\n        <activity\n            android:name=\"com.nextcloud.client.etm.EtmActivity\"\n            android:exported=\"false\"\n            android:theme=\"@style/Theme.ownCloud.Toolbar\" />\n    </application>\n\n    <queries>\n        <package android:name=\"it.niedermann.nextcloud.deck\" />\n        <package android:name=\"it.niedermann.nextcloud.deck.play\" />\n        <package android:name=\"it.niedermann.nextcloud.deck.dev\" />\n    </queries>\n</manifest>\n"], "filenames": ["src/main/AndroidManifest.xml"], "buggy_code_start_loc": [309], "buggy_code_end_loc": [312], "fixing_code_start_loc": [308], "fixing_code_end_loc": [313], "type": "CWE-276", "message": "The Nextcloud Android app is the Android client for Nextcloud, a self-hosted productivity platform. An issue in versions prior to 3.17.1 may lead to sensitive information disclosure. An unauthorized app that does not have the otherwise required `MANAGE_DOCUMENTS` permission may view image thumbnails for images it does not have permission to view. Version 3.17.1 contains a patch. There are no known workarounds.", "other": {"cve": {"id": "CVE-2021-41166", "sourceIdentifier": "security-advisories@github.com", "published": "2022-01-26T23:15:08.217", "lastModified": "2022-02-02T19:29:16.787", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "The Nextcloud Android app is the Android client for Nextcloud, a self-hosted productivity platform. An issue in versions prior to 3.17.1 may lead to sensitive information disclosure. An unauthorized app that does not have the otherwise required `MANAGE_DOCUMENTS` permission may view image thumbnails for images it does not have permission to view. Version 3.17.1 contains a patch. There are no known workarounds."}, {"lang": "es", "value": "La aplicaci\u00f3n Android de Nextcloud es el cliente Android para Nextcloud, una plataforma de productividad auto-alojada. Un problema en las versiones anteriores a 3.17.1 puede conllevar a una divulgaci\u00f3n de informaci\u00f3n confidencial. Una aplicaci\u00f3n no autorizada que no tenga el permiso \"MANAGE_DOCUMENTS\" requerido puede visualizar las miniaturas de las im\u00e1genes que no presenta permiso para visualizar. La versi\u00f3n 3.17.1 contiene un parche. No se presentan medidas de mitigaci\u00f3n conocidas"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-276"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-276"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:nextcloud:nextcloud:*:*:*:*:*:android:*:*", "versionEndExcluding": "3.17.1", "matchCriteriaId": "946BAD69-A288-4980-8BFC-5AFA1E321B44"}]}]}], "references": [{"url": "https://github.com/nextcloud/android/commit/aa47197109970b8449c4e44601eba36e3481b086", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/nextcloud/android/commit/b6ecf515b38c2d82d32743f27236534f3e03ee0c", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-wrwg-jwpg-r3c4", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://hackerone.com/reports/1358597", "source": "security-advisories@github.com", "tags": ["Permissions Required"]}]}, "github_commit_url": "https://github.com/nextcloud/android/commit/aa47197109970b8449c4e44601eba36e3481b086"}}