{"buggy_code": ["<?php\n\n/**\n * Header of the admin area.\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at http://mozilla.org/MPL/2.0/.\n *\n * @package phpMyFAQ\n * @author Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright 2003-2022 phpMyFAQ Team\n * @license http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n * @link https://www.phpmyfaq.de\n * @since 2003-02-26\n */\n\nuse phpMyFAQ\\Helper\\AdministrationHelper;\nuse phpMyFAQ\\Helper\\HttpHelper;\nuse phpMyFAQ\\Helper\\LanguageHelper;\nuse phpMyFAQ\\Services\\Gravatar;\nuse phpMyFAQ\\Strings;\nuse phpMyFAQ\\System;\nuse phpMyFAQ\\Template;\n\nif (!defined('IS_VALID_PHPMYFAQ')) {\n    http_response_code(400);\n    exit();\n}\n\n$httpHeader = new HttpHelper();\n$httpHeader->setContentType('text/html');\n$httpHeader->addHeader();\n\n$secLevelEntries = [\n    'user' => '',\n    'content' => '',\n    'statistics' => '',\n    'exports' => '',\n    'backup' => '',\n    'config' => '',\n];\n$dashboardPage = true;\n$contentPage = false;\n$userPage = false;\n$statisticsPage = false;\n$exportsPage = false;\n$backupPage = false;\n$configurationPage = false;\n\n$adminHelper = new AdministrationHelper();\n$adminHelper->setUser($user);\n\n$secLevelEntries['user'] = $adminHelper->addMenuEntry(\n    'add_user+edit_user+delete_user',\n    'user',\n    'ad_menu_user_administration',\n    $action\n);\nif ($faqConfig->get('security.permLevel') !== 'basic') {\n    $secLevelEntries['user'] .= $adminHelper->addMenuEntry(\n        'addgroup+editgroup+delgroup',\n        'group',\n        'ad_menu_group_administration',\n        $action\n    );\n}\nif ($faqConfig->get('security.permLevel') === 'large') {\n    $secLevelEntries['user'] .= $adminHelper->addMenuEntry(\n        'add_section+edit_section+del_section',\n        'section',\n        'ad_menu_section_administration',\n        $action\n    );\n}\n$secLevelEntries['content'] = $adminHelper->addMenuEntry(\n    'addcateg+editcateg+delcateg',\n    'category',\n    'ad_menu_categ_edit',\n    $action\n);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry('add_faq', 'editentry', 'ad_entry_add', $action);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry('edit_faq+delete_faq', 'view', 'ad_menu_entry_edit', $action);\nif (DEBUG) {\n    $secLevelEntries['content'] .= $adminHelper->addMenuEntry(\n        'edit_faq+delete_faq',\n        'faqs-overview',\n        'ad_menu_entry_edit',\n        $action\n    );\n}\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry(\n    'edit_faq+delete_faq',\n    'searchfaqs',\n    'ad_menu_searchfaqs',\n    $action\n);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry('delcomment', 'comments', 'ad_menu_comments', $action);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry('delquestion', 'question', 'ad_menu_open', $action);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry(\n    'addglossary+editglossary+delglossary',\n    'glossary',\n    'ad_menu_glossary',\n    $action\n);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry(\n    'addnews+editnews+delnews',\n    'news',\n    'ad_menu_news_edit',\n    $action\n);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry(\n    'addattachment+editattachment+delattachment',\n    'attachments',\n    'ad_menu_attachments',\n    $action\n);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry('edit_faq', 'tags', 'ad_entry_tags', $action);\n\n$secLevelEntries['statistics'] = $adminHelper->addMenuEntry('viewlog', 'statistics', 'ad_menu_stat', $action);\n$secLevelEntries['statistics'] .= $adminHelper->addMenuEntry('viewlog', 'viewsessions', 'ad_menu_session', $action);\n$secLevelEntries['statistics'] .= $adminHelper->addMenuEntry('adminlog', 'adminlog', 'ad_menu_adminlog', $action);\n$secLevelEntries['statistics'] .= $adminHelper->addMenuEntry('viewlog', 'searchstats', 'ad_menu_searchstats', $action);\n$secLevelEntries['statistics'] .= $adminHelper->addMenuEntry('reports', 'reports', 'ad_menu_reports', $action);\n\n$secLevelEntries['exports'] = $adminHelper->addMenuEntry('export', 'export', 'ad_menu_export', $action);\n\n$secLevelEntries['backup'] = $adminHelper->addMenuEntry('editconfig', 'backup', 'ad_menu_backup', $action);\n\n$secLevelEntries['config'] .= $adminHelper->addMenuEntry('editconfig', 'config', 'ad_menu_editconfig', $action);\n$secLevelEntries['config'] .= $adminHelper->addMenuEntry('editconfig', 'system', 'ad_system_info', $action, false);\n$secLevelEntries['config'] .= $adminHelper->addMenuEntry(\n    'editinstances+addinstances+delinstances',\n    'instances',\n    'ad_menu_instances',\n    $action\n);\n$secLevelEntries['config'] .= $adminHelper->addMenuEntry(\n    'editconfig',\n    'stopwordsconfig',\n    'ad_menu_stopwordsconfig',\n    $action\n);\n$secLevelEntries['config'] .= $adminHelper->addMenuEntry('editconfig', 'meta', 'ad_menu_meta', $action);\nif ($faqConfig->get('search.enableElasticsearch')) {\n    $secLevelEntries['config'] .= $adminHelper->addMenuEntry(\n        'editconfig',\n        'elasticsearch',\n        'ad_menu_elasticsearch',\n        $action\n    );\n}\n\nswitch ($action) {\n    case 'user':\n    case 'group':\n    case 'section':\n    case 'passwd':\n    case 'cookies':\n        $userPage = true;\n        break;\n    case 'content':\n    case 'category':\n    case 'addcategory':\n    case 'savecategory':\n    case 'editcategory':\n    case 'translatecategory':\n    case 'updatecategory':\n    case 'deletecategory':\n    case 'removecategory':\n    case 'cutcategory':\n    case 'pastecategory':\n    case 'movecategory':\n    case 'changecategory':\n    case 'showcategory':\n    case 'editentry':\n    case 'insertentry':\n    case 'saveentry':\n    case 'view':\n    case 'searchfaqs':\n    case 'glossary':\n    case 'saveglossary':\n    case 'updateglossary':\n    case 'deleteglossary':\n    case 'addglossary':\n    case 'editglossary':\n    case 'news':\n    case 'add-news':\n    case 'edit-news':\n    case 'save-news':\n    case 'update-news':\n    case 'delete-news':\n    case 'question':\n    case 'takequestion':\n    case 'comments':\n    case 'attachments':\n    case 'tags':\n        $contentPage = true;\n        break;\n    case 'statistics':\n    case 'viewsessions':\n    case 'sessionbrowse':\n    case 'sessionsuche':\n    case 'adminlog':\n    case 'searchstats':\n    case 'reports':\n    case 'reportview':\n        $statisticsPage = true;\n        break;\n    case 'export':\n        $exportsPage = true;\n        break;\n    case 'backup':\n        $backupPage = true;\n        break;\n    case 'config':\n    case 'stopwordsconfig':\n    case 'upgrade':\n    case 'instances':\n    case 'system':\n    case 'elasticsearch':\n    case 'meta':\n        $configurationPage = true;\n        break;\n    default:\n        $dashboardPage = true;\n        break;\n}\n?>\n<!DOCTYPE html>\n<html lang=\"<?= $PMF_LANG['metaLanguage']; ?>\">\n<head>\n  <meta charset=\"utf-8\">\n\n  <title>\n    <?= Strings::htmlentities($faqConfig->getTitle(), ENT_QUOTES) ?> - powered by phpMyFAQ <?= System::getVersion() ?>\n  </title>\n  <base href=\"<?= $faqSystem->getSystemUri($faqConfig) ?>admin/\">\n\n  <meta name=\"description\" content=\"Only Chuck Norris can divide by zero.\">\n  <meta name=\"author\" content=\"phpMyFAQ Team\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\n  <meta name=\"application-name\" content=\"phpMyFAQ <?= System::getVersion() ?>\">\n  <meta name=\"copyright\" content=\"\u00a9 2001-<?= date('Y') ?> phpMyFAQ Team\">\n  <meta name=\"publisher\" content=\"phpMyFAQ Team\">\n  <meta name=\"robots\" content=\"<?= $faqConfig->get('seo.metaTagsAdmin') ?>\">\n\n  <link href=\"https://fonts.googleapis.com/css?family=Roboto\" rel=\"stylesheet\" type=\"text/css\">\n  <link rel=\"stylesheet\" href=\"../assets/dist/admin-styles.css\">\n\n  <script src=\"../assets/dist/vendors.js\"></script>\n  <script src=\"../assets/dist/phpmyfaq.js\"></script>\n  <script src=\"../assets/dist/backend.js\"></script>\n  <script src=\"assets/js/sidebar.js\"></script>\n  <script src=\"assets/js/editor/tinymce.min.js?<?= time(); ?>\"></script>\n  <link rel=\"shortcut icon\" href=\"../assets/themes/<?= Template::getTplSetName(); ?>/img/favicon.ico\">\n</head>\n<body dir=\"<?= $PMF_LANG['dir']; ?>\" id=\"page-top\">\n\n<!-- Page Wrapper -->\n<div id=\"wrapper\">\n\n  <!-- Sidebar -->\n  <ul class=\"navbar-nav bg-gradient-primary sidebar sidebar-dark accordion\" id=\"accordionSidebar\">\n\n    <li>\n      <a class=\"sidebar-brand d-flex align-items-center justify-content-center\" href=\"../\">\n        <div class=\"sidebar-brand-icon rotate-n-15\">\n          <i class=\"fas fa-laugh-wink\"></i>\n        </div>\n        <div class=\"sidebar-brand-text mx-4\">phpMyFAQ <?= System::getVersion() ?></div>\n      </a>\n    </li>\n\n    <li>\n      <hr class=\"sidebar-divider my-0\">\n    </li>\n      <?php if (\n        isset($auth) && (count($user->perm->getAllUserRights($user->getUserId())) > 0 || $user->isSuperAdmin(\n        ))\n) : ?>\n        <li class=\"nav-item active\">\n          <a class=\"nav-link\" href=\"index.php\">\n            <i class=\"fa fa-tachometer\"></i>\n            <span>Dashboard</span></a>\n        </li>\n\n        <li>\n          <hr class=\"sidebar-divider\">\n        </li>\n\n        <li class=\"nav-item\">\n          <a class=\"nav-link <?= ($userPage) ? '' : 'collapsed' ?>\"\n             href=\"#\" data-toggle=\"collapse\" data-target=\"#collapseUserAdmin\" aria-expanded=\"true\"\n             aria-controls=\"collapseUserAdmin\">\n            <i aria-hidden=\"true\" class=\"fa fa-user\"></i>\n            <span><?= $PMF_LANG['admin_mainmenu_users']; ?></span>\n          </a>\n          <div id=\"collapseUserAdmin\" class=\"collapse <?= ($userPage) ? 'show' : '' ?>\" data-parent=\"#accordionSidebar\">\n            <div class=\"bg-white py-2 collapse-inner rounded\">\n                <?= $secLevelEntries['user']; ?>\n            </div>\n          </div>\n        </li>\n\n        <li class=\"nav-item\">\n          <a class=\"nav-link <?= ($contentPage) ? '' : 'collapsed' ?>\"\n             href=\"#\" data-toggle=\"collapse\" data-target=\"#collapseContentAdmin\" aria-expanded=\"true\"\n             aria-controls=\"collapseContentAdmin\">\n            <i aria-hidden=\"true\" class=\"fa fa-edit\"></i>\n            <span><?= $PMF_LANG['admin_mainmenu_content']; ?></span>\n          </a>\n          <div id=\"collapseContentAdmin\" class=\"collapse <?= ($contentPage) ? 'show' : '' ?>\"\n               data-parent=\"#accordionSidebar\">\n            <div class=\"bg-white py-2 collapse-inner rounded\">\n                <?= $secLevelEntries['content']; ?>\n            </div>\n          </div>\n        </li>\n\n        <li class=\"nav-item\">\n          <a class=\"nav-link <?= ($statisticsPage) ? '' : 'collapsed' ?>\"\n             href=\"#\" data-toggle=\"collapse\" data-target=\"#collapseStatisticsAdmin\" aria-expanded=\"true\"\n             aria-controls=\"collapseStatisticsAdmin\">\n            <i aria-hidden=\"true\" class=\"fa fa-tasks\"></i>\n            <span><?= $PMF_LANG['admin_mainmenu_statistics']; ?></span>\n          </a>\n          <div id=\"collapseStatisticsAdmin\" class=\"collapse <?= ($statisticsPage) ? 'show' : '' ?>\"\n               data-parent=\"#accordionSidebar\">\n            <div class=\"bg-white py-2 collapse-inner rounded\">\n                <?= $secLevelEntries['statistics']; ?>\n            </div>\n          </div>\n        </li>\n\n        <li class=\"nav-item\">\n          <a class=\"nav-link  <?= ($exportsPage) ? '' : 'collapsed' ?>\" href=\"#\" data-toggle=\"collapse\"\n             data-target=\"#collapseExportsAdmin\" aria-expanded=\"true\"\n             aria-controls=\"collapseExportsAdmin\">\n            <i aria-hidden=\"true\" class=\"fa fa-file\"></i>\n            <span><?= $PMF_LANG['admin_mainmenu_exports']; ?></span>\n          </a>\n          <div id=\"collapseExportsAdmin\" class=\"collapse <?= ($exportsPage) ? 'show' : '' ?>\"\n               data-parent=\"#accordionSidebar\">\n            <div class=\"bg-white py-2 collapse-inner rounded\">\n                <?= $secLevelEntries['exports']; ?>\n            </div>\n          </div>\n        </li>\n\n        <li class=\"nav-item\">\n          <a class=\"nav-link  <?= ($backupPage) ? '' : 'collapsed' ?>\" href=\"#\" data-toggle=\"collapse\"\n             data-target=\"#collapseBackupAdmin\" aria-expanded=\"true\"\n             aria-controls=\"collapseBackupAdmin\">\n            <i aria-hidden=\"true\" class=\"fa fa-download\"></i>\n            <span><?= $PMF_LANG['admin_mainmenu_backup']; ?></span>\n          </a>\n          <div id=\"collapseBackupAdmin\" class=\"collapse <?= ($backupPage) ? 'show' : '' ?>\"\n               data-parent=\"#accordionSidebar\">\n            <div class=\"bg-white py-2 collapse-inner rounded\">\n                <?= $secLevelEntries['backup']; ?>\n            </div>\n          </div>\n        </li>\n\n        <li class=\"nav-item\">\n          <a class=\"nav-link  <?= ($configurationPage) ? '' : 'collapsed' ?>\" href=\"#\" data-toggle=\"collapse\"\n             data-target=\"#collapseConfigAdmin\" aria-expanded=\"true\"\n             aria-controls=\"collapseConfigAdmin\">\n            <i aria-hidden=\"true\" class=\"fa fa-wrench\"></i>\n            <span><?= $PMF_LANG['admin_mainmenu_configuration']; ?></span>\n          </a>\n          <div id=\"collapseConfigAdmin\" class=\"collapse <?= ($configurationPage) ? 'show' : '' ?>\"\n               data-parent=\"#accordionSidebar\">\n            <div class=\"bg-white py-2 collapse-inner rounded\">\n                <?= $secLevelEntries['config']; ?>\n            </div>\n          </div>\n        </li>\n\n        <li>\n          <hr class=\"sidebar-divider d-none d-md-block\">\n        </li>\n\n        <li>\n          <div class=\"text-center small\" id=\"pmf-admin-saving-data-indicator\"></div>\n        </li>\n\n      <?php endif; ?>\n  </ul>\n  <!-- End of Sidebar -->\n\n  <!-- Content Wrapper -->\n  <div id=\"content-wrapper\" class=\"d-flex flex-column\">\n\n    <!-- Main Content -->\n    <div id=\"content\">\n\n      <!-- Topbar -->\n      <nav class=\"navbar navbar-expand navbar-dark bg-primary topbar mb-4 static-top\">\n\n        <!-- Topbar Language Switcher -->\n        <form class=\"d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search\"\n              action=\"index.php<?= (isset($action) ? '?action=' . $action : ''); ?>\" method=\"post\">\n            <?= LanguageHelper::renderSelectLanguage($faqLangCode, true); ?>\n        </form>\n\n        <!-- Topbar Navbar -->\n        <ul class=\"navbar-nav ml-auto\">\n\n          <!-- Nav Item - Mobile Language Switcher -->\n          <li class=\"nav-item dropdown no-arrow d-sm-none\">\n            <a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"searchDropdown\" role=\"button\" data-toggle=\"dropdown\"\n               aria-haspopup=\"true\" aria-expanded=\"false\">\n              <i class=\"fa fa-language fa-fw\"></i>\n            </a>\n            <!-- Dropdown - Messages -->\n            <div class=\"dropdown-menu dropdown-menu-right p-3 animated--grow-in\"\n                 aria-labelledby=\"searchDropdown\">\n              <form class=\"form-inline mr-auto w-100 navbar-search\"\n                    action=\"index.php<?= (isset($action) ? '?action=' . $action : ''); ?>\" method=\"post\">\n                  <?= LanguageHelper::renderSelectLanguage($faqLangCode, true); ?>\n              </form>\n            </div>\n          </li>\n\n            <?php if (\n            isset($auth) && (count(\n                $user->perm->getAllUserRights($user->getUserId())\n            ) > 0 || $user->isSuperAdmin())\n) : ?>\n              <li class=\"nav-item\">\n                <div class=\"navbar-text text-gray-600 small\">\n                  <i class=\"fa fa-clock-o fa-fw\"></i> <?= $PMF_LANG['ad_session_expiration']; ?>:\n                  <span id=\"sessioncounter\" class=\"pl-2\"><i aria-hidden=\"true\" class=\"fa fa-spinner fa-spin\"></i> Loading...</span>\n                </div>\n              </li>\n\n              <div class=\"topbar-divider d-none d-sm-block\"></div>\n\n              <li class=\"nav-item dropdown no-arrow\">\n                <a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"userDropdown\" role=\"button\" data-toggle=\"dropdown\"\n                   aria-haspopup=\"true\" aria-expanded=\"false\">\n                  <span class=\"mr-2 d-none d-lg-inline text-gray-600 small\">\n                      <?= $user->getUserData('display_name'); ?>\n                  </span>\n                    <?php\n                    if ($faqConfig->get('main.enableGravatarSupport')) {\n                        $avatar = new Gravatar();\n                        echo $avatar->getImage(\n                            $user->getUserData('email'),\n                            ['size' => 24, 'class' => 'img-profile rounded-circle']\n                        );\n                    } else {\n                        echo '<i aria-hidden=\"true\" class=\"fa fa-user\"></i>';\n                    }\n                    ?>\n                </a>\n                <!-- Dropdown - User Information -->\n                <div class=\"dropdown-menu dropdown-menu-right animated--grow-in\" aria-labelledby=\"userDropdown\">\n                  <a class=\"dropdown-item\" href=\"index.php?action=passwd\">\n                    <i class=\"fa fa-key-modern mr-2 text-gray-400\"></i>\n                      <?= $PMF_LANG['ad_menu_passwd'] ?>\n                  </a>\n                  <div class=\"dropdown-divider\"></div>\n                  <a class=\"dropdown-item\" href=\"index.php?action=logout&csrf=<?= $user->getCsrfTokenFromSession() ?>\">\n                    <i class=\"fa fa-sign-out mr-2 text-gray-400\"></i>\n                      <?= $PMF_LANG['admin_mainmenu_logout']; ?>\n                  </a>\n                </div>\n              </li>\n            <?php endif; ?>\n\n        </ul>\n\n      </nav>\n      <!-- End of Topbar -->\n\n      <!-- Begin Page Content -->\n      <div class=\"container-fluid\">\n"], "fixing_code": ["<?php\n\n/**\n * Header of the admin area.\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at http://mozilla.org/MPL/2.0/.\n *\n * @package phpMyFAQ\n * @author Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright 2003-2022 phpMyFAQ Team\n * @license http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n * @link https://www.phpmyfaq.de\n * @since 2003-02-26\n */\n\nuse phpMyFAQ\\Helper\\AdministrationHelper;\nuse phpMyFAQ\\Helper\\HttpHelper;\nuse phpMyFAQ\\Helper\\LanguageHelper;\nuse phpMyFAQ\\Services\\Gravatar;\nuse phpMyFAQ\\Strings;\nuse phpMyFAQ\\System;\nuse phpMyFAQ\\Template;\n\nif (!defined('IS_VALID_PHPMYFAQ')) {\n    http_response_code(400);\n    exit();\n}\n\n$httpHeader = new HttpHelper();\n$httpHeader->setContentType('text/html');\n$httpHeader->addHeader();\n\n$secLevelEntries = [\n    'user' => '',\n    'content' => '',\n    'statistics' => '',\n    'exports' => '',\n    'backup' => '',\n    'config' => '',\n];\n$dashboardPage = true;\n$contentPage = false;\n$userPage = false;\n$statisticsPage = false;\n$exportsPage = false;\n$backupPage = false;\n$configurationPage = false;\n\n$adminHelper = new AdministrationHelper();\n$adminHelper->setUser($user);\n\n$secLevelEntries['user'] = $adminHelper->addMenuEntry(\n    'add_user+edit_user+delete_user',\n    'user',\n    'ad_menu_user_administration',\n    $action\n);\nif ($faqConfig->get('security.permLevel') !== 'basic') {\n    $secLevelEntries['user'] .= $adminHelper->addMenuEntry(\n        'addgroup+editgroup+delgroup',\n        'group',\n        'ad_menu_group_administration',\n        $action\n    );\n}\nif ($faqConfig->get('security.permLevel') === 'large') {\n    $secLevelEntries['user'] .= $adminHelper->addMenuEntry(\n        'add_section+edit_section+del_section',\n        'section',\n        'ad_menu_section_administration',\n        $action\n    );\n}\n$secLevelEntries['content'] = $adminHelper->addMenuEntry(\n    'addcateg+editcateg+delcateg',\n    'category',\n    'ad_menu_categ_edit',\n    $action\n);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry('add_faq', 'editentry', 'ad_entry_add', $action);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry('edit_faq+delete_faq', 'view', 'ad_menu_entry_edit', $action);\nif (DEBUG) {\n    $secLevelEntries['content'] .= $adminHelper->addMenuEntry(\n        'edit_faq+delete_faq',\n        'faqs-overview',\n        'ad_menu_entry_edit',\n        $action\n    );\n}\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry(\n    'edit_faq+delete_faq',\n    'searchfaqs',\n    'ad_menu_searchfaqs',\n    $action\n);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry('delcomment', 'comments', 'ad_menu_comments', $action);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry('delquestion', 'question', 'ad_menu_open', $action);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry(\n    'addglossary+editglossary+delglossary',\n    'glossary',\n    'ad_menu_glossary',\n    $action\n);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry(\n    'addnews+editnews+delnews',\n    'news',\n    'ad_menu_news_edit',\n    $action\n);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry(\n    'addattachment+editattachment+delattachment',\n    'attachments',\n    'ad_menu_attachments',\n    $action\n);\n$secLevelEntries['content'] .= $adminHelper->addMenuEntry('edit_faq', 'tags', 'ad_entry_tags', $action);\n\n$secLevelEntries['statistics'] = $adminHelper->addMenuEntry('viewlog', 'statistics', 'ad_menu_stat', $action);\n$secLevelEntries['statistics'] .= $adminHelper->addMenuEntry('viewlog', 'viewsessions', 'ad_menu_session', $action);\n$secLevelEntries['statistics'] .= $adminHelper->addMenuEntry('adminlog', 'adminlog', 'ad_menu_adminlog', $action);\n$secLevelEntries['statistics'] .= $adminHelper->addMenuEntry('viewlog', 'searchstats', 'ad_menu_searchstats', $action);\n$secLevelEntries['statistics'] .= $adminHelper->addMenuEntry('reports', 'reports', 'ad_menu_reports', $action);\n\n$secLevelEntries['exports'] = $adminHelper->addMenuEntry('export', 'export', 'ad_menu_export', $action);\n\n$secLevelEntries['backup'] = $adminHelper->addMenuEntry('editconfig', 'backup', 'ad_menu_backup', $action);\n\n$secLevelEntries['config'] .= $adminHelper->addMenuEntry('editconfig', 'config', 'ad_menu_editconfig', $action);\n$secLevelEntries['config'] .= $adminHelper->addMenuEntry('editconfig', 'system', 'ad_system_info', $action, false);\n$secLevelEntries['config'] .= $adminHelper->addMenuEntry(\n    'editinstances+addinstances+delinstances',\n    'instances',\n    'ad_menu_instances',\n    $action\n);\n$secLevelEntries['config'] .= $adminHelper->addMenuEntry(\n    'editconfig',\n    'stopwordsconfig',\n    'ad_menu_stopwordsconfig',\n    $action\n);\n$secLevelEntries['config'] .= $adminHelper->addMenuEntry('editconfig', 'meta', 'ad_menu_meta', $action);\nif ($faqConfig->get('search.enableElasticsearch')) {\n    $secLevelEntries['config'] .= $adminHelper->addMenuEntry(\n        'editconfig',\n        'elasticsearch',\n        'ad_menu_elasticsearch',\n        $action\n    );\n}\n\nswitch ($action) {\n    case 'user':\n    case 'group':\n    case 'section':\n    case 'passwd':\n    case 'cookies':\n        $userPage = true;\n        break;\n    case 'content':\n    case 'category':\n    case 'addcategory':\n    case 'savecategory':\n    case 'editcategory':\n    case 'translatecategory':\n    case 'updatecategory':\n    case 'deletecategory':\n    case 'removecategory':\n    case 'cutcategory':\n    case 'pastecategory':\n    case 'movecategory':\n    case 'changecategory':\n    case 'showcategory':\n    case 'editentry':\n    case 'insertentry':\n    case 'saveentry':\n    case 'view':\n    case 'searchfaqs':\n    case 'glossary':\n    case 'saveglossary':\n    case 'updateglossary':\n    case 'deleteglossary':\n    case 'addglossary':\n    case 'editglossary':\n    case 'news':\n    case 'add-news':\n    case 'edit-news':\n    case 'save-news':\n    case 'update-news':\n    case 'delete-news':\n    case 'question':\n    case 'takequestion':\n    case 'comments':\n    case 'attachments':\n    case 'tags':\n        $contentPage = true;\n        break;\n    case 'statistics':\n    case 'viewsessions':\n    case 'sessionbrowse':\n    case 'sessionsuche':\n    case 'adminlog':\n    case 'searchstats':\n    case 'reports':\n    case 'reportview':\n        $statisticsPage = true;\n        break;\n    case 'export':\n        $exportsPage = true;\n        break;\n    case 'backup':\n        $backupPage = true;\n        break;\n    case 'config':\n    case 'stopwordsconfig':\n    case 'upgrade':\n    case 'instances':\n    case 'system':\n    case 'elasticsearch':\n    case 'meta':\n        $configurationPage = true;\n        break;\n    default:\n        $dashboardPage = true;\n        break;\n}\n?>\n<!DOCTYPE html>\n<html lang=\"<?= $PMF_LANG['metaLanguage']; ?>\">\n<head>\n  <meta charset=\"utf-8\">\n\n  <title>\n    <?= Strings::htmlentities($faqConfig->getTitle(), ENT_QUOTES) ?> - powered by phpMyFAQ <?= System::getVersion() ?>\n  </title>\n  <base href=\"<?= Strings::htmlentities($faqConfig->getDefaultUrl()) ?>admin/\">\n\n  <meta name=\"description\" content=\"Only Chuck Norris can divide by zero.\">\n  <meta name=\"author\" content=\"phpMyFAQ Team\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\">\n  <meta name=\"application-name\" content=\"phpMyFAQ <?= System::getVersion() ?>\">\n  <meta name=\"copyright\" content=\"\u00a9 2001-<?= date('Y') ?> phpMyFAQ Team\">\n  <meta name=\"publisher\" content=\"phpMyFAQ Team\">\n  <meta name=\"robots\" content=\"<?= $faqConfig->get('seo.metaTagsAdmin') ?>\">\n\n  <link href=\"https://fonts.googleapis.com/css?family=Roboto\" rel=\"stylesheet\" type=\"text/css\">\n  <link rel=\"stylesheet\" href=\"../assets/dist/admin-styles.css\">\n\n  <script src=\"../assets/dist/vendors.js\"></script>\n  <script src=\"../assets/dist/phpmyfaq.js\"></script>\n  <script src=\"../assets/dist/backend.js\"></script>\n  <script src=\"assets/js/sidebar.js\"></script>\n  <script src=\"assets/js/editor/tinymce.min.js?<?= time(); ?>\"></script>\n  <link rel=\"shortcut icon\" href=\"../assets/themes/<?= Template::getTplSetName(); ?>/img/favicon.ico\">\n</head>\n<body dir=\"<?= $PMF_LANG['dir']; ?>\" id=\"page-top\">\n\n<!-- Page Wrapper -->\n<div id=\"wrapper\">\n\n  <!-- Sidebar -->\n  <ul class=\"navbar-nav bg-gradient-primary sidebar sidebar-dark accordion\" id=\"accordionSidebar\">\n\n    <li>\n      <a class=\"sidebar-brand d-flex align-items-center justify-content-center\" href=\"../\">\n        <div class=\"sidebar-brand-icon rotate-n-15\">\n          <i class=\"fas fa-laugh-wink\"></i>\n        </div>\n        <div class=\"sidebar-brand-text mx-4\">phpMyFAQ <?= System::getVersion() ?></div>\n      </a>\n    </li>\n\n    <li>\n      <hr class=\"sidebar-divider my-0\">\n    </li>\n      <?php if (\n        isset($auth) && (count($user->perm->getAllUserRights($user->getUserId())) > 0 || $user->isSuperAdmin(\n        ))\n) : ?>\n        <li class=\"nav-item active\">\n          <a class=\"nav-link\" href=\"index.php\">\n            <i class=\"fa fa-tachometer\"></i>\n            <span>Dashboard</span></a>\n        </li>\n\n        <li>\n          <hr class=\"sidebar-divider\">\n        </li>\n\n        <li class=\"nav-item\">\n          <a class=\"nav-link <?= ($userPage) ? '' : 'collapsed' ?>\"\n             href=\"#\" data-toggle=\"collapse\" data-target=\"#collapseUserAdmin\" aria-expanded=\"true\"\n             aria-controls=\"collapseUserAdmin\">\n            <i aria-hidden=\"true\" class=\"fa fa-user\"></i>\n            <span><?= $PMF_LANG['admin_mainmenu_users']; ?></span>\n          </a>\n          <div id=\"collapseUserAdmin\" class=\"collapse <?= ($userPage) ? 'show' : '' ?>\" data-parent=\"#accordionSidebar\">\n            <div class=\"bg-white py-2 collapse-inner rounded\">\n                <?= $secLevelEntries['user']; ?>\n            </div>\n          </div>\n        </li>\n\n        <li class=\"nav-item\">\n          <a class=\"nav-link <?= ($contentPage) ? '' : 'collapsed' ?>\"\n             href=\"#\" data-toggle=\"collapse\" data-target=\"#collapseContentAdmin\" aria-expanded=\"true\"\n             aria-controls=\"collapseContentAdmin\">\n            <i aria-hidden=\"true\" class=\"fa fa-edit\"></i>\n            <span><?= $PMF_LANG['admin_mainmenu_content']; ?></span>\n          </a>\n          <div id=\"collapseContentAdmin\" class=\"collapse <?= ($contentPage) ? 'show' : '' ?>\"\n               data-parent=\"#accordionSidebar\">\n            <div class=\"bg-white py-2 collapse-inner rounded\">\n                <?= $secLevelEntries['content']; ?>\n            </div>\n          </div>\n        </li>\n\n        <li class=\"nav-item\">\n          <a class=\"nav-link <?= ($statisticsPage) ? '' : 'collapsed' ?>\"\n             href=\"#\" data-toggle=\"collapse\" data-target=\"#collapseStatisticsAdmin\" aria-expanded=\"true\"\n             aria-controls=\"collapseStatisticsAdmin\">\n            <i aria-hidden=\"true\" class=\"fa fa-tasks\"></i>\n            <span><?= $PMF_LANG['admin_mainmenu_statistics']; ?></span>\n          </a>\n          <div id=\"collapseStatisticsAdmin\" class=\"collapse <?= ($statisticsPage) ? 'show' : '' ?>\"\n               data-parent=\"#accordionSidebar\">\n            <div class=\"bg-white py-2 collapse-inner rounded\">\n                <?= $secLevelEntries['statistics']; ?>\n            </div>\n          </div>\n        </li>\n\n        <li class=\"nav-item\">\n          <a class=\"nav-link  <?= ($exportsPage) ? '' : 'collapsed' ?>\" href=\"#\" data-toggle=\"collapse\"\n             data-target=\"#collapseExportsAdmin\" aria-expanded=\"true\"\n             aria-controls=\"collapseExportsAdmin\">\n            <i aria-hidden=\"true\" class=\"fa fa-file\"></i>\n            <span><?= $PMF_LANG['admin_mainmenu_exports']; ?></span>\n          </a>\n          <div id=\"collapseExportsAdmin\" class=\"collapse <?= ($exportsPage) ? 'show' : '' ?>\"\n               data-parent=\"#accordionSidebar\">\n            <div class=\"bg-white py-2 collapse-inner rounded\">\n                <?= $secLevelEntries['exports']; ?>\n            </div>\n          </div>\n        </li>\n\n        <li class=\"nav-item\">\n          <a class=\"nav-link  <?= ($backupPage) ? '' : 'collapsed' ?>\" href=\"#\" data-toggle=\"collapse\"\n             data-target=\"#collapseBackupAdmin\" aria-expanded=\"true\"\n             aria-controls=\"collapseBackupAdmin\">\n            <i aria-hidden=\"true\" class=\"fa fa-download\"></i>\n            <span><?= $PMF_LANG['admin_mainmenu_backup']; ?></span>\n          </a>\n          <div id=\"collapseBackupAdmin\" class=\"collapse <?= ($backupPage) ? 'show' : '' ?>\"\n               data-parent=\"#accordionSidebar\">\n            <div class=\"bg-white py-2 collapse-inner rounded\">\n                <?= $secLevelEntries['backup']; ?>\n            </div>\n          </div>\n        </li>\n\n        <li class=\"nav-item\">\n          <a class=\"nav-link  <?= ($configurationPage) ? '' : 'collapsed' ?>\" href=\"#\" data-toggle=\"collapse\"\n             data-target=\"#collapseConfigAdmin\" aria-expanded=\"true\"\n             aria-controls=\"collapseConfigAdmin\">\n            <i aria-hidden=\"true\" class=\"fa fa-wrench\"></i>\n            <span><?= $PMF_LANG['admin_mainmenu_configuration']; ?></span>\n          </a>\n          <div id=\"collapseConfigAdmin\" class=\"collapse <?= ($configurationPage) ? 'show' : '' ?>\"\n               data-parent=\"#accordionSidebar\">\n            <div class=\"bg-white py-2 collapse-inner rounded\">\n                <?= $secLevelEntries['config']; ?>\n            </div>\n          </div>\n        </li>\n\n        <li>\n          <hr class=\"sidebar-divider d-none d-md-block\">\n        </li>\n\n        <li>\n          <div class=\"text-center small\" id=\"pmf-admin-saving-data-indicator\"></div>\n        </li>\n\n      <?php endif; ?>\n  </ul>\n  <!-- End of Sidebar -->\n\n  <!-- Content Wrapper -->\n  <div id=\"content-wrapper\" class=\"d-flex flex-column\">\n\n    <!-- Main Content -->\n    <div id=\"content\">\n\n      <!-- Topbar -->\n      <nav class=\"navbar navbar-expand navbar-dark bg-primary topbar mb-4 static-top\">\n\n        <!-- Topbar Language Switcher -->\n        <form class=\"d-none d-sm-inline-block form-inline mr-auto ml-md-3 my-2 my-md-0 mw-100 navbar-search\"\n              action=\"index.php<?= (isset($action) ? '?action=' . $action : ''); ?>\" method=\"post\">\n            <?= LanguageHelper::renderSelectLanguage($faqLangCode, true); ?>\n        </form>\n\n        <!-- Topbar Navbar -->\n        <ul class=\"navbar-nav ml-auto\">\n\n          <!-- Nav Item - Mobile Language Switcher -->\n          <li class=\"nav-item dropdown no-arrow d-sm-none\">\n            <a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"searchDropdown\" role=\"button\" data-toggle=\"dropdown\"\n               aria-haspopup=\"true\" aria-expanded=\"false\">\n              <i class=\"fa fa-language fa-fw\"></i>\n            </a>\n            <!-- Dropdown - Messages -->\n            <div class=\"dropdown-menu dropdown-menu-right p-3 animated--grow-in\"\n                 aria-labelledby=\"searchDropdown\">\n              <form class=\"form-inline mr-auto w-100 navbar-search\"\n                    action=\"index.php<?= (isset($action) ? '?action=' . $action : ''); ?>\" method=\"post\">\n                  <?= LanguageHelper::renderSelectLanguage($faqLangCode, true); ?>\n              </form>\n            </div>\n          </li>\n\n            <?php if (\n            isset($auth) && (count(\n                $user->perm->getAllUserRights($user->getUserId())\n            ) > 0 || $user->isSuperAdmin())\n) : ?>\n              <li class=\"nav-item\">\n                <div class=\"navbar-text text-gray-600 small\">\n                  <i class=\"fa fa-clock-o fa-fw\"></i> <?= $PMF_LANG['ad_session_expiration']; ?>:\n                  <span id=\"sessioncounter\" class=\"pl-2\"><i aria-hidden=\"true\" class=\"fa fa-spinner fa-spin\"></i> Loading...</span>\n                </div>\n              </li>\n\n              <div class=\"topbar-divider d-none d-sm-block\"></div>\n\n              <li class=\"nav-item dropdown no-arrow\">\n                <a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"userDropdown\" role=\"button\" data-toggle=\"dropdown\"\n                   aria-haspopup=\"true\" aria-expanded=\"false\">\n                  <span class=\"mr-2 d-none d-lg-inline text-gray-600 small\">\n                      <?= $user->getUserData('display_name'); ?>\n                  </span>\n                    <?php\n                    if ($faqConfig->get('main.enableGravatarSupport')) {\n                        $avatar = new Gravatar();\n                        echo $avatar->getImage(\n                            $user->getUserData('email'),\n                            ['size' => 24, 'class' => 'img-profile rounded-circle']\n                        );\n                    } else {\n                        echo '<i aria-hidden=\"true\" class=\"fa fa-user\"></i>';\n                    }\n                    ?>\n                </a>\n                <!-- Dropdown - User Information -->\n                <div class=\"dropdown-menu dropdown-menu-right animated--grow-in\" aria-labelledby=\"userDropdown\">\n                  <a class=\"dropdown-item\" href=\"index.php?action=passwd\">\n                    <i class=\"fa fa-key-modern mr-2 text-gray-400\"></i>\n                      <?= $PMF_LANG['ad_menu_passwd'] ?>\n                  </a>\n                  <div class=\"dropdown-divider\"></div>\n                  <a class=\"dropdown-item\" href=\"index.php?action=logout&csrf=<?= $user->getCsrfTokenFromSession() ?>\">\n                    <i class=\"fa fa-sign-out mr-2 text-gray-400\"></i>\n                      <?= $PMF_LANG['admin_mainmenu_logout']; ?>\n                  </a>\n                </div>\n              </li>\n            <?php endif; ?>\n\n        </ul>\n\n      </nav>\n      <!-- End of Topbar -->\n\n      <!-- Begin Page Content -->\n      <div class=\"container-fluid\">\n"], "filenames": ["phpmyfaq/admin/header.php"], "buggy_code_start_loc": [238], "buggy_code_end_loc": [239], "fixing_code_start_loc": [238], "fixing_code_end_loc": [239], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Stored in GitHub repository thorsten/phpmyfaq prior to 3.1.10.", "other": {"cve": {"id": "CVE-2023-0309", "sourceIdentifier": "security@huntr.dev", "published": "2023-01-15T22:15:10.657", "lastModified": "2023-01-23T14:48:41.217", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Stored in GitHub repository thorsten/phpmyfaq prior to 3.1.10."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "HIGH", "baseScore": 8.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 4.7}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpmyfaq:phpmyfaq:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.1.10", "matchCriteriaId": "184FE56D-4BA2-499C-9F30-C0B5A2EE2C36"}]}]}], "references": [{"url": "https://github.com/thorsten/phpmyfaq/commit/376d1d3e5a42edf07260e98461d2fddbee74419b", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/c03c5925-43ff-450d-9827-2b65a3307ed6", "source": "security@huntr.dev", "tags": ["Permissions Required", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/thorsten/phpmyfaq/commit/376d1d3e5a42edf07260e98461d2fddbee74419b"}}