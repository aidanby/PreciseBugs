{"buggy_code": ["<?php\n\n/**\n * Helper class for phpMyFAQ user.\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at http://mozilla.org/MPL/2.0/.\n *\n * @package    phpMyFAQ\\Helper\n * @author     Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright  2021-2022 phpMyFAQ Team\n * @license    http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n * @link       https://www.phpmyfaq.de\n * @since      2021-03-14\n */\n\nnamespace phpMyFAQ\\Helper;\n\nuse phpMyFAQ\\User;\n\n/**\n * Class UserHelper\n *\n * @package phpMyFAQ\\Helper\n */\nclass UserHelper\n{\n    /** @var User */\n    private User $user;\n\n    /**\n     * UserHelper constructor.\n     *\n     * @param User $user\n     */\n    public function __construct(User $user)\n    {\n        $this->user = $user;\n    }\n\n    /**\n     * Get all users in <option> tags.\n     *\n     * @param int  $id Selected user ID\n     * @param bool $allowBlockedUsers Allow blocked users as well, e.g. in admin\n     * @return string\n     */\n    public function getAllUserOptions(int $id = 1, bool $allowBlockedUsers = false): string\n    {\n        $options = '';\n        $allUsers = $this->user->getAllUsers(true, $allowBlockedUsers);\n\n        foreach ($allUsers as $userId) {\n            if (-1 !== $userId) {\n                $this->user->getUserById($userId);\n                $options .= sprintf(\n                    '<option value=\"%d\" %s>%s (%s)</option>',\n                    $userId,\n                    (($userId === $id) ? 'selected' : ''),\n                    $this->user->getUserData('display_name'),\n                    $this->user->getLogin()\n                );\n            }\n        }\n\n        return $options;\n    }\n}\n"], "fixing_code": ["<?php\n\n/**\n * Helper class for phpMyFAQ user.\n *\n * This Source Code Form is subject to the terms of the Mozilla Public License,\n * v. 2.0. If a copy of the MPL was not distributed with this file, You can\n * obtain one at http://mozilla.org/MPL/2.0/.\n *\n * @package    phpMyFAQ\\Helper\n * @author     Thorsten Rinne <thorsten@phpmyfaq.de>\n * @copyright  2021-2022 phpMyFAQ Team\n * @license    http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0\n * @link       https://www.phpmyfaq.de\n * @since      2021-03-14\n */\n\nnamespace phpMyFAQ\\Helper;\n\nuse phpMyFAQ\\Strings;\nuse phpMyFAQ\\User;\n\n/**\n * Class UserHelper\n *\n * @package phpMyFAQ\\Helper\n */\nclass UserHelper\n{\n    /** @var User */\n    private User $user;\n\n    /**\n     * UserHelper constructor.\n     *\n     * @param User $user\n     */\n    public function __construct(User $user)\n    {\n        $this->user = $user;\n    }\n\n    /**\n     * Get all users in <option> tags.\n     *\n     * @param int  $id Selected user ID\n     * @param bool $allowBlockedUsers Allow blocked users as well, e.g. in admin\n     * @return string\n     */\n    public function getAllUserOptions(int $id = 1, bool $allowBlockedUsers = false): string\n    {\n        $options = '';\n        $allUsers = $this->user->getAllUsers(true, $allowBlockedUsers);\n\n        foreach ($allUsers as $userId) {\n            if (-1 !== $userId) {\n                $this->user->getUserById($userId);\n                $options .= sprintf(\n                    '<option value=\"%d\" %s>%s (%s)</option>',\n                    $userId,\n                    (($userId === $id) ? 'selected' : ''),\n                    Strings::htmlentities($this->user->getUserData('display_name')),\n                    $this->user->getLogin()\n                );\n            }\n        }\n\n        return $options;\n    }\n}\n"], "filenames": ["phpmyfaq/src/phpMyFAQ/Helper/UserHelper.php"], "buggy_code_start_loc": [19], "buggy_code_end_loc": [62], "fixing_code_start_loc": [20], "fixing_code_end_loc": [63], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Stored in GitHub repository thorsten/phpmyfaq prior to 3.1.12.", "other": {"cve": {"id": "CVE-2023-1760", "sourceIdentifier": "security@huntr.dev", "published": "2023-03-31T02:15:06.643", "lastModified": "2023-04-06T17:15:58.773", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Stored in GitHub repository thorsten/phpmyfaq prior to 3.1.12."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.7, "impactScore": 5.8}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpmyfaq:phpmyfaq:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.1.12", "matchCriteriaId": "653EC167-06FC-4D30-AAF8-B75F596519AE"}]}]}], "references": [{"url": "https://github.com/thorsten/phpmyfaq/commit/56295b54062a284020fccce12a5044f9fa7d2770", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.dev/bounties/2d0ac48a-490d-4548-8d98-7447042dd1b5", "source": "security@huntr.dev", "tags": ["Exploit", "Patch"]}]}, "github_commit_url": "https://github.com/thorsten/phpmyfaq/commit/56295b54062a284020fccce12a5044f9fa7d2770"}}