{"buggy_code": ["phpMyAdmin - ChangeLog\n======================\n\n4.2.12.0 (not yet released)\n- bug #4574 Blank/white page when JavaScript disabled\n- bug #4577 Multi row actions cause full page reloads\n- bug       ReferenceError: targeurl is not defined\n- bug       Incorrect text/icon display in Tracking report\n- bug #4404 Recordset return from procedure display nothing\n- bug #4584 Edit dialog for routines is too long for smaller displays\n- bug #4586 Javascript error after moving a column\n- bug #4576 Issue with long comments on table columns\n- bug #4599 Input field unnecessarily selected on focus\n- bug #4602 Exporting selected rows exports all rows of the query\n- bug #4444 No insert statement produced in SQL export for queries with alias\n- bug #4596 [security] XSS through exception stack\n- bug #4595 [security] Path traversal can lead to leakage of line count\n- bug #4578 [security] XSS vulnerability in table print view\n\n4.2.11.0 (2014-10-31)\n- bug       ReferenceError: Table_onover is not defined\n- bug #4552 Incorrect routines display for database due to case insensitive checks\n- bug #4259 reCaptcha sound session expired problem\n- bug #4557 PHP fatal error, undefined function __()\n- bug #4568 Date displayed incorrectly when charting a timeline\n- bug #4571 Database Privileges link does not work\n- bug       makegrid.js: where_clause is undefined\n- bug #4572 missing trailing slash (import and open_basedir)\n\n4.2.10.1 (2014-10-21)\n- bug #4562 [security] XSS in debug SQL output\n- bug #4563 [security] XSS in monitor query analyzer\n\n4.2.10.0 (2014-10-11)\n- bug #4361 Can't change font size (when config.inc.php not present)\n- bug #4542 Tab key in column name not shown\n- bug       PDF export: title not present in PDF\n- bug #4543 Changing column name can break saved \"order by\" clause\n- bug #4545 trying to favorite table while browser localStorage is disabled throws JS error\n- bug #4548 Inline editing a field converts tab to spaces\n- bug #4252 Database-level permission bug for db names containing underscores\n- bug #3120 Events are not exported when using xml\n- bug #4554 Grid-editing timestamp column forces datepicker\n- bug #4556 Fast filters for tables, views etc. should be governed by NavigationTreeDisplayItemFilterMinimum\n\n4.2.9.1 (2014-10-01)\n- bug #4544 [security] XSS vulnerabilities in table search and table structure pages\n\n4.2.9.0 (2014-09-20)\n- bug       ajax.js responseHandler: cannot read property of null\n- bug       sql.js: str is undefined\n- bug #4524 Allow for direct selection of \"0\" on the \"user overview\" page\n- bug #4529 Undefined index: pos\n- bug #4523 tbl_change.js: insert as new row submit type on multiple selected records does not set all AUTO_INCREMENTs to 0 value\n- bug       ajax.js responseHandler: another \"cannot read property\"\n- bug       tbl_structure.js \"cannot read property\"\n\n4.2.8.1 (2014-09-13)\n- bug #4530 [security] DOM based XSS that results to a CSRF that creates a\n            ROOT account in certain conditions\n\n4.2.8.0 (2014-08-31)\n- bug #4516 Odd export behavior\n- bug #4519 Uncaught TypeError: Cannot read property 'success' of null\n- bug #4520 sql.js: cannot read property\n- bug #4521 Initially allowed chart types do not match selected data\n- bug #4518 Export to SQL: CREATE TABLE option AUTO_INCREMENT ignored\n- bug #4522 Duplicate column names while assigning index\n- bug #4487 Export of partitioned table does not import\n- bug       server_privileges.js: cannot read property\n- bug #4527 Importing ODS files with column names having trailing spaces fails\n- bug #4413 Navigation Error in Nav Tree for Search Results Past the First Page\n- bug       functions.js: Cannot read property 'replace' of undefined\n\n4.2.7.1 (2014-08-17)\n- bug #4501 [security] XSS in table browse page\n- bug #4502 [security] Self-XSS in enum value editor\n- bug #4503 [security] Self-XSSes in monitor\n- bug #4504 [security] Self-XSS in query charts\n- bug #4505 [security] XSS in view operations page\n- bug #4517 [security] XSS in relation view\n\n4.2.7.0 (2014-07-31)\n- bug       Broken links on home page\n- bug #4494 Overlap in navigation panel\n- bug #4427 Action icons not in horizontal order\n- bug #4493 s_attention.png is missing\n- bug #4499 Uncaught TypeError: Cannot call method 'substr' of undefined\n- bug #4498 PMA 4.2.x and HHVM\n- bug #4500 mysql_doc_template is not defined\n\n4.2.6.0 (2014-07-17)\n- bug #4471 Undefined index warning with referenced column.\n- bug #4027 $cfg['MaxExactCount'] is ignored when BROWSING is back\n- bug #4482 Multi Column sorting (improved user experience)\n- bug #4478 Server validation does not work while in setup/mysqli\n- bug       Undefined variable when grid editing a foreign key column\n- bug #4481 mult_submits.inc.php Undefined variable Error\n- bug #4485 Sorting breaks the copy column feature\n- bug #4440 Javascript error when renaming table\n- bug #4483 'New window' link (selflink) disappears, causing Javascript error\n- bug #4489 Incorrect detection of privileges for routine creation\n- bug #4459 First few characters of database name aren't clickable when expanded\n- bug #4486 [security] XSS injection due to unescaped table comment\n- bug #4488 [security] XSS injection due to unescaped table name (triggers)\n- bug #4492 [security] XSS in AJAX confirmation messages\n- bug #4491 [security] Missing validation for accessing User groups feature\n\n4.2.5.0 (2014-06-26)\n- bug #4467 shell_exec() has been disabled for security reasons\n- bug #4470 Error while submitting empty query\n- bug #4463 Fatal error: Class 'PMA_DatabaseInterface' not found\n- bug #4469 Fixed cookie based login for installations without mcrypt\n- bug #4473 incorrect result count when having clause is used\n-           mcrypt: remove the requirement (64-bit) and the related warning\n\n4.2.4.0 (2014-06-20)\n- bug #4449 Mediawiki export does not produce table header row; also fix related PHP warnings\n- bug #4442 New lines are added to query every time\n- bug #4445 Fatal error on SQL Export of join query\n- bug #4448 Dump binary columns in hexadecimal notation not working\n- Regenerate cookie encryption IV for every session\n- bug #4405 Cannot import (open_basedir): fix another case\n- bug #4457 SQL tab - Insert queries not showing affected row count\n- bug       Missing warning about existing account, on multi-server config\n- bug #4435 WHERE clause can be undefined\n- bug       SQL export views as tables option getting ignored\n- bug #4464 [security] XSS injection due to unescaped db/table name in navigation hiding\n- bug #4465 [security] XSS injection due to unescaped db/table name in recent/favorite tables\n\n4.2.3.0 (2014-06-08)\n- bug #4423 Moving fields not working\n- bug #4424 Table indexes disappear after altering field\n- bug #4432 Error while displaying chart at server level\n- bug #4405 Cannot import (open_basedir)\n- bug #4396 Problem copying constraints (such as Sakila)\n- bug #4433 Missing privileges submenu\n- bug #4394 Drop db confirmation message when dropping a user\n- bug #4436 Insert form numeric field with function drop-down list\n- bug #4437 Problems due to missing enforcement of the minimum supported MySQL version\n+ Add enforcement of the minimum supported PHP version (5.3.0)\n- bug       Query error on submitting a column change form containing a disabled input field\n- bug       Incorrect menu tab generation from usergroups\n- bug       Missing space in index creation/edit generated query\n- bug #4434 Unchecking 'Show SQL queries' results NaN\n\n4.2.2.0 (2014-05-20)\n- bug #4388 Disable database expansion when enabled throws Error 500 when database name is clicked in navigation tree\n- bug #4414 table display of performance_schema DB structure\n- bug #4411 Protect Binary Columns: many problems\n- bug #4395 BLOB link transformation is broken\n- bug       Respect ['ShowCreateDb'] in the navi panel\n- bug #4392 Cannot see databases in nav panel on databases grouping when disabled database expansion\n- bug #4419 No more calendar into search tab\n- bug #4398 Monitor should fit into screen width\n- bug #4418 When copying databases, primary key attributes get lost\n- bug #4421 empty maxInputVars on js/messages.php\n\n4.2.1.0 (2014-05-13)\n- bug #4380 Cannot display table structure with enums containing special characters\n- bug #4381 Cannot remove the last remembered sorted column\n- bug       Correctly fetch length of user and host fields in MySQL tables\n- bug #4364 examples/signon.php does not support the SessionSavePath directive\n- bug #4382 Missing source for OpenLayers library\n- bug       Incorrect attributes for number fields\n- bug #4383 Cannot update values in Zoom search\n- bug #4313 GIS Visualization Extension does not work with PointFromText() function\n- bug #4384 Incorrect \"Rows\" total shown when truncating or dropping a table on DB Structure page\n- bug #4385 Grid edit on sorted columns fails\n- bug #4389 Null checkbox covering data input when editing\n- bug #4390 Data type changing by itself (no size but attribute present)\n\n4.2.0.0 (2014-05-08)\n+ rfe #1403 Export only triggers\n+ rfe #1483 Export Server/Database/Table without triggers\n+ rfe #1662 Add table comment tool tip in database structure page\n+ rfe #1447 Single table for display Character Sets and Collations\n+ rfe #1455 Display icons/text/both for the table row actions\n+ rfe #1473 Transformation to convert Boolean value to text\n- bug #4157 Changing users password will delete it\n+ rfe #1474 Text transformation combines Append and Prepend\n+ Added warning about the mysql extension being deprecated\n  and removed the extension directive\n+ Added support for scatter charts\n+ rfe #1478 Make Column Headings Sticky\n+ rfe #1480 Enhance privileges initials table\n+ rfe #1472 [interface] Break \"Edit privileges\" with sub-menus\n+ rfe #1466 Minor refactoring required\n+ rfe #1004 Create indexes at the end in SQL export\n+ rfe #1479 Relations edit form for larger monitors\n+ rfe #1475 Inline query box vertical resize\n+ rfe #1500 [interface] Add bottom border to top menu container\n+ rfe #1498 Add datepicker for 'TIME' type\n- bug #4237 HTTP Referer disclosure in SQL links\n+ rfe       Show full names on navigation hover\n+ rfe #1505 Behaviour on click on a routine in nav panel\n+ rfe #1418 Support more than one separating character on CSV import\n+ rfe #569  Load/Save Query By Example\n- bug #4281 Grid edit ENUM field, dialog disappears when trying to select\n- bug #4304 DB export using zip compression generates an empty archive\n+ rfe #1508 confirmation message at the top\n- bug #4306 breadcrubs wrong on table create\n+ rfe #1511 better validate database name for copying\n+ rfe #1510 Database tab \"Drop\" button should be a link\n+ rfe #1513 Highlight required form fields after failed submission\n+ rfe #1460 Redirect to login page after session has expired\n- bug #4316 Grid edit: can't change month on date fields\n+ rfe #1501 add maxlength by field with length-spec\n+ rfe #1512 Import happily doesn't do anything with no file name provided\n+ rfe #1514 Add function to all the insert boxes automatically\n+ rfe #1515 Option to skip tables larger than n\n+ rfe #1486 Possibility of disabling database expansion\n+ rfe #1476 Favourite tables select box\n+ rfe #420  $cfg['CharEditing']='textarea' for structure edit\n+ rfe #1329 Avoid editing of fields which are part of relation\n+ rfe       [interface] Highlight active left menu item in setup\n+ rfe       Filter on-screen rows during Browse\n  Removed support for SQL Validator (SOAP service no longer offered)\n- bug #4352 Settings > Manage: incorrect messages\n- bug #4337 \"More\" in Actions area doesn't collapse to fit available space\n- bug #4375 Group two DB, one's name is the prefix of the other one\n- bug #4070 Confusing database/table grouping\n- bug #4366 Creating Index doesn't update index-list\n+ rfe #1507 Sort by multiple columns\n\n4.1.14.1 (2014-06-21)\n- bug #4464 [security] XSS injection due to unescaped db/table name in navigation hiding\n\n4.1.14.0 (2014-04-26)\n- bug #4365 Creating bookmark with multiple queries not working\n- bug #4375 Group two DB, one's name is the prefix of the other one\n- bug #4376 [interface] Login fields show in separate line\n- bug #4372 Changing browser transformation results in unnecessary table rebuild\n\n4.1.13.0 (2014-04-13)\n- bug #4279 CTRL + up or down moves 2 fields\n- bug #4336 List server css style wrong\n- bug       Missing value on the Status > Server page\n- bug #4347 Fixed PHP Parse error in Advisor\n- bug #4350 Deleting the DB if it is renamed by the same name\n- bug #4353 makeProfilingChart is not defined\n- bug #4355 Precision specifier for DOUBLE type is truncated\n- bug #4346 Incorrect \"Export incomplete\" message\n- bug #4359 Notices on create table page\n- bug #4356 GROUPed selects show number of rows as if not grouped\n- bug #4357 JS Form submitted on \"enter\" even if focus is inside a select field\n\n4.1.12.0 (2014-03-27)\n- bug #4334 Add event : datepicker won't open\n- bug #4338 Fix missing value error while executing SQL query\n- TCPDF library is now optional dependency\n- bug #4326 Cannot find the import plugins which start with uppercase 'I'\n\n4.1.11.0 (2014-03-23)\n- bug #4335 reCaptcha problem (4.1.10 regression)\n\n4.1.10.0 (2014-03-22)\n- bug #4301 Grid edit: \"SELECT\" query is replaced by \"UPDATE\" query after edit\n- bug #4278 reCaptcha re-login requires double effort\n- bug #4324 Datepicker not showing up on insert page\n- bug #3991 Problem selecting item in select boxes with the ENTER keystroke in some browsers\n- bug #4323 QueryWindow ignores CodeMirror\n- bug       None of the live charts shown on \"Status -> Monitor\" (Chrome)\n\n4.1.9.0 (2014-03-06)\n- bug #4279 CTRL + up or down moves two fields (part one)\n- bug #4294 output as text radio clickable for \"OpenDocument Text\" export\n- bug #4297 DROP DATABASE tick box in export no longer works\n- bug #4291 Unable to export comments in OpenDocument text format\n- bug #4299 Deletion even when the user says \"No\" to the confirmation message\n- bug #4303 \"New\" link in navi panel is shown even if no privileges\n- bug #4302 Some params are being omitted from microhistory\n- bug #4298 Missing validation on Import CSV: \"Columns enclosed with\" and \"Columns escaped with\"\n- bug #4040 Fatal error while resetting settings\n- bug #4305 JS error when editing procedure from nav panel\n- bug #4308 Edit routine form submitting when pressing enter\n- bug #4307 Nav: \"Columns\" won't expand with specific schema\n\n4.1.8.0 (2014-02-22)\n- bug #4276 Login loop on session expiry\n- bug #4249 Incorrect number of result rows for SQL with subqueries\n- bug #4275 Broken Link to php extension manual\n- bug #4053 List of procedures is not displayed after executing with Enter\n- bug #4081 Setup page content shifted to the right edge of its tabs\n- bug #4284 Reordering a column erases comments for other columns\n- bug #4286 Open \"Browse\" in a new tab\n- bug #4287 Printview - Always one column too much\n- bug #4288 Expand database (+ icon) after timeout doesn't do anything\n- bug #4285 Fixed CSS for setup\n- Fixed altering table to DOUBLE/FLOAT field\n- bug #4292 Success message and failure message being shown together\n- bug #4293 opening new tab (using selflink) for import.php based actions\n            results in error and logout\n\n4.1.7.0 (2014-02-09)\n- bug #4245 initial Browse query does not match sorting order\n- bug #4250 Notice on export page\n- bug #4253 \"New\" text in navigation frame acts like a database\n- bug #4262 Cannot define a column with fractional seconds\n- bug #4265 Missing datepicker icon for DATETIME(length)\n- bug #4257 Hide fractional seconds when applicable\n- bug #4264 Uncheck \"Ignore\" while inserting, upon leaving a textarea\n- bug #4260 reCaptcha is ignoring language settings\n- bug #4263 Japanese character encoding not working properly when exporting\n- bug #4269 Notice on table relation page\n- bug #4270 Bad text-color for table comments\n- bug #4272 Incorrect tabindex\n- bug #4271 Query by example and the second criteria line\n- bug #4242 Wildcard-containing only_db failure in sidebar\n\n4.1.6.0 (2014-01-26)\n- bug #4232 User not found after creating the user\n- bug #4241 Confusing dialog when trying to create an already existing user\n- bug #4239 Missing LIMIT clause for some queries\n- rfe #1489 Do not show create icon when user has no privileges\n- bug #4218 Chrome behavior with date fields\n- bug #3579 NOW() function incorrectly selected (regression)\n- bug #4244 Advisor complaints about MariaDB 10.x is version less than 5.1\n- bug #3889 When login fails and error display is active, login data is\ndisplayed (regression)\n- bug #4247 open_basedir warnings on export page\n- bug #4013 AJAX request waiting until version info is retrieved\n- bug #4248 js error when changing number of columns in status monitor\n\n4.1.5.0 (2014-01-17)\n- bug #3780 Allow aborting loading pages\n- bug #4223 Database list: Create database misses collation column\n- bug #4224 Empty table names when a table is \"inuse\"\n- bug #4225 Partition maintenance broken\n- bug #4219 Table list (left panel) does not reload when table renamed\n- bug #4230 \"in use\" displayed for all views in database print view\n- bug #4226 Notice: Undefined index: pma_config_loading\n- bug #4221 Bzip2 export cannot be directly imported (so withdraw bz2 export)\n- bug #4204 Reloading user privileges hides user groups submenu\n- bug #4231 DATE columns quick edit decrement by one day\n\n4.1.4.0 (2014-01-07)\n- bug #3840 (additional fix) When exporting to gzip format, the data is compressed 2 times\n- bug #4209 Missing compression in one case\n- bug #4208 Can't browse tables after sorting on columns with fieldnames that have a '-'\n- bug #4184 Switch to wrong page after adding an index\n- bug #3885 Additional fix for this bug\n- bug #4212 Table \"disappears\" if it has the same name as its tablegroup\n- bug #4213 Datetime Quick Edit decrements by one day\n- bug #4217 Current value not highlighted when browsing foreign values\n- bug #4220 Incorrect key values in foreign key browser\n- bug #4215 MariaDB 5.5: error in Drizzle detection\n\n         --- Older ChangeLogs can be found on our project website ---\n                     http://www.phpmyadmin.net/old-stuff/ChangeLogs/\n\n# vim: et ts=4 sw=4 sts=4\n# vim: ft=changelog fenc=utf-8\n# vim: fde=getline(v\\:lnum-1)=~'^\\\\s*$'&&getline(v\\:lnum)=~'\\\\S'?'>1'\\:1&&v\\:lnum>4&&getline(v\\:lnum)!~'^#'\n# vim: fdn=1 fdm=expr\n", "<?php\n/* vim: set expandtab sw=4 ts=4 sts=4: */\n/**\n * Handles table zoom search tab\n *\n * display table zoom search form, create SQL queries from form data\n *\n * @package PhpMyAdmin\n */\n\n/**\n * Gets some core libraries\n */\nrequire_once './libraries/common.inc.php';\nrequire_once './libraries/mysql_charsets.inc.php';\nrequire_once './libraries/TableSearch.class.php';\nrequire_once './libraries/tbl_info.inc.php';\n\n$response = PMA_Response::getInstance();\n$header   = $response->getHeader();\n$scripts  = $header->getScripts();\n$scripts->addFile('makegrid.js');\n$scripts->addFile('sql.js');\n$scripts->addFile('jqplot/jquery.jqplot.js');\n$scripts->addFile('jqplot/plugins/jqplot.canvasTextRenderer.js');\n$scripts->addFile('jqplot/plugins/jqplot.canvasAxisLabelRenderer.js');\n$scripts->addFile('jqplot/plugins/jqplot.dateAxisRenderer.js');\n$scripts->addFile('jqplot/plugins/jqplot.highlighter.js');\n$scripts->addFile('jqplot/plugins/jqplot.cursor.js');\n$scripts->addFile('canvg/canvg.js');\n$scripts->addFile('jquery/jquery-ui-timepicker-addon.js');\n$scripts->addFile('tbl_zoom_plot_jqplot.js');\n\n$table_search = new PMA_TableSearch($db, $table, \"zoom\");\n\n/**\n * Handle AJAX request for data row on point select\n * @var post_params Object containing parameters for the POST request\n */\n\nif (isset($_REQUEST['get_data_row']) && $_REQUEST['get_data_row'] == true) {\n    $extra_data = array();\n    $row_info_query = 'SELECT * FROM `' . $_REQUEST['db'] . '`.`'\n        . $_REQUEST['table'] . '` WHERE ' .  $_REQUEST['where_clause'];\n    $result = $GLOBALS['dbi']->query(\n        $row_info_query . \";\", null, PMA_DatabaseInterface::QUERY_STORE\n    );\n    $fields_meta = $GLOBALS['dbi']->getFieldsMeta($result);\n    while ($row = $GLOBALS['dbi']->fetchAssoc($result)) {\n        // for bit fields we need to convert them to printable form\n        $i = 0;\n        foreach ($row as $col => $val) {\n            if ($fields_meta[$i]->type == 'bit') {\n                $row[$col] = PMA_Util::printableBitValue(\n                    $val, $fields_meta[$i]->length\n                );\n            }\n            $i++;\n        }\n        $extra_data['row_info'] = $row;\n    }\n    PMA_Response::getInstance()->addJSON($extra_data);\n    exit;\n}\n\n/**\n * Handle AJAX request for changing field information\n * (value,collation,operators,field values) in input form\n * @var post_params Object containing parameters for the POST request\n */\n\nif (isset($_REQUEST['change_tbl_info']) && $_REQUEST['change_tbl_info'] == true) {\n    $response = PMA_Response::getInstance();\n    $field = $_REQUEST['field'];\n    if ($field == 'pma_null') {\n        $response->addJSON('field_type', '');\n        $response->addJSON('field_collation', '');\n        $response->addJSON('field_operators', '');\n        $response->addJSON('field_value', '');\n        exit;\n    }\n    $key = array_search($field, $table_search->getColumnNames());\n    $properties = $table_search->getColumnProperties($_REQUEST['it'], $key);\n    $response->addJSON('field_type', $properties['type']);\n    $response->addJSON('field_collation', $properties['collation']);\n    $response->addJSON('field_operators', $properties['func']);\n    $response->addJSON('field_value', $properties['value']);\n    exit;\n}\n\n// Gets some core libraries\nrequire_once './libraries/tbl_common.inc.php';\n$url_query .= '&amp;goto=tbl_select.php&amp;back=tbl_select.php';\n\n// Gets tables informations\nrequire_once './libraries/tbl_info.inc.php';\n\nif (! isset($goto)) {\n    $goto = $GLOBALS['cfg']['DefaultTabTable'];\n}\n// Defines the url to return to in case of error in the next sql statement\n$err_url   = $goto . '?' . PMA_URL_getCommon($db, $table);\n\n//Set default datalabel if not selected\nif ( !isset($_POST['zoom_submit']) || $_POST['dataLabel'] == '') {\n    $dataLabel = PMA_getDisplayField($db, $table);\n} else {\n    $dataLabel = $_POST['dataLabel'];\n}\n\n// Displays the zoom search form\n$response->addHTML($table_search->getSecondaryTabs());\n$response->addHTML($table_search->getSelectionForm($goto, $dataLabel));\n\n/*\n * Handle the input criteria and generate the query result\n * Form for displaying query results\n */\nif (isset($_POST['zoom_submit'])\n    && $_POST['criteriaColumnNames'][0] != 'pma_null'\n    && $_POST['criteriaColumnNames'][1] != 'pma_null'\n    && $_POST['criteriaColumnNames'][0] != $_POST['criteriaColumnNames'][1]\n) {\n    //Query generation part\n    $sql_query = $table_search->buildSqlQuery();\n    $sql_query .= ' LIMIT ' . $_POST['maxPlotLimit'];\n\n    //Query execution part\n    $result = $GLOBALS['dbi']->query(\n        $sql_query . \";\", null, PMA_DatabaseInterface::QUERY_STORE\n    );\n    $fields_meta = $GLOBALS['dbi']->getFieldsMeta($result);\n    while ($row = $GLOBALS['dbi']->fetchAssoc($result)) {\n        //Need a row with indexes as 0,1,2 for the getUniqueCondition\n        // hence using a temporary array\n        $tmpRow = array();\n        foreach ($row as $val) {\n            $tmpRow[] = $val;\n        }\n        //Get unique conditon on each row (will be needed for row update)\n        $uniqueCondition = PMA_Util::getUniqueCondition(\n            $result, count($table_search->getColumnNames()), $fields_meta, $tmpRow,\n            true\n        );\n        //Append it to row array as where_clause\n        $row['where_clause'] = $uniqueCondition[0];\n\n        $tmpData = array(\n            $_POST['criteriaColumnNames'][0] =>\n                $row[$_POST['criteriaColumnNames'][0]],\n            $_POST['criteriaColumnNames'][1] =>\n                $row[$_POST['criteriaColumnNames'][1]],\n            'where_clause' => $uniqueCondition[0]\n        );\n        $tmpData[$dataLabel] = ($dataLabel) ? $row[$dataLabel] : '';\n        $data[] = $tmpData;\n    }\n    unset($tmpData);\n\n    //Displays form for point data and scatter plot\n    $response->addHTML($table_search->getZoomResultsForm($goto, $data));\n}\n?>\n"], "fixing_code": ["phpMyAdmin - ChangeLog\n======================\n\n4.2.12.0 (not yet released)\n- bug #4574 Blank/white page when JavaScript disabled\n- bug #4577 Multi row actions cause full page reloads\n- bug       ReferenceError: targeurl is not defined\n- bug       Incorrect text/icon display in Tracking report\n- bug #4404 Recordset return from procedure display nothing\n- bug #4584 Edit dialog for routines is too long for smaller displays\n- bug #4586 Javascript error after moving a column\n- bug #4576 Issue with long comments on table columns\n- bug #4599 Input field unnecessarily selected on focus\n- bug #4602 Exporting selected rows exports all rows of the query\n- bug #4444 No insert statement produced in SQL export for queries with alias\n- bug #4596 [security] XSS through exception stack\n- bug #4595 [security] Path traversal can lead to leakage of line count\n- bug #4578 [security] XSS vulnerability in table print view\n- bug #4579 [security] XSS vulnerability in zoom search page\n\n4.2.11.0 (2014-10-31)\n- bug       ReferenceError: Table_onover is not defined\n- bug #4552 Incorrect routines display for database due to case insensitive checks\n- bug #4259 reCaptcha sound session expired problem\n- bug #4557 PHP fatal error, undefined function __()\n- bug #4568 Date displayed incorrectly when charting a timeline\n- bug #4571 Database Privileges link does not work\n- bug       makegrid.js: where_clause is undefined\n- bug #4572 missing trailing slash (import and open_basedir)\n\n4.2.10.1 (2014-10-21)\n- bug #4562 [security] XSS in debug SQL output\n- bug #4563 [security] XSS in monitor query analyzer\n\n4.2.10.0 (2014-10-11)\n- bug #4361 Can't change font size (when config.inc.php not present)\n- bug #4542 Tab key in column name not shown\n- bug       PDF export: title not present in PDF\n- bug #4543 Changing column name can break saved \"order by\" clause\n- bug #4545 trying to favorite table while browser localStorage is disabled throws JS error\n- bug #4548 Inline editing a field converts tab to spaces\n- bug #4252 Database-level permission bug for db names containing underscores\n- bug #3120 Events are not exported when using xml\n- bug #4554 Grid-editing timestamp column forces datepicker\n- bug #4556 Fast filters for tables, views etc. should be governed by NavigationTreeDisplayItemFilterMinimum\n\n4.2.9.1 (2014-10-01)\n- bug #4544 [security] XSS vulnerabilities in table search and table structure pages\n\n4.2.9.0 (2014-09-20)\n- bug       ajax.js responseHandler: cannot read property of null\n- bug       sql.js: str is undefined\n- bug #4524 Allow for direct selection of \"0\" on the \"user overview\" page\n- bug #4529 Undefined index: pos\n- bug #4523 tbl_change.js: insert as new row submit type on multiple selected records does not set all AUTO_INCREMENTs to 0 value\n- bug       ajax.js responseHandler: another \"cannot read property\"\n- bug       tbl_structure.js \"cannot read property\"\n\n4.2.8.1 (2014-09-13)\n- bug #4530 [security] DOM based XSS that results to a CSRF that creates a\n            ROOT account in certain conditions\n\n4.2.8.0 (2014-08-31)\n- bug #4516 Odd export behavior\n- bug #4519 Uncaught TypeError: Cannot read property 'success' of null\n- bug #4520 sql.js: cannot read property\n- bug #4521 Initially allowed chart types do not match selected data\n- bug #4518 Export to SQL: CREATE TABLE option AUTO_INCREMENT ignored\n- bug #4522 Duplicate column names while assigning index\n- bug #4487 Export of partitioned table does not import\n- bug       server_privileges.js: cannot read property\n- bug #4527 Importing ODS files with column names having trailing spaces fails\n- bug #4413 Navigation Error in Nav Tree for Search Results Past the First Page\n- bug       functions.js: Cannot read property 'replace' of undefined\n\n4.2.7.1 (2014-08-17)\n- bug #4501 [security] XSS in table browse page\n- bug #4502 [security] Self-XSS in enum value editor\n- bug #4503 [security] Self-XSSes in monitor\n- bug #4504 [security] Self-XSS in query charts\n- bug #4505 [security] XSS in view operations page\n- bug #4517 [security] XSS in relation view\n\n4.2.7.0 (2014-07-31)\n- bug       Broken links on home page\n- bug #4494 Overlap in navigation panel\n- bug #4427 Action icons not in horizontal order\n- bug #4493 s_attention.png is missing\n- bug #4499 Uncaught TypeError: Cannot call method 'substr' of undefined\n- bug #4498 PMA 4.2.x and HHVM\n- bug #4500 mysql_doc_template is not defined\n\n4.2.6.0 (2014-07-17)\n- bug #4471 Undefined index warning with referenced column.\n- bug #4027 $cfg['MaxExactCount'] is ignored when BROWSING is back\n- bug #4482 Multi Column sorting (improved user experience)\n- bug #4478 Server validation does not work while in setup/mysqli\n- bug       Undefined variable when grid editing a foreign key column\n- bug #4481 mult_submits.inc.php Undefined variable Error\n- bug #4485 Sorting breaks the copy column feature\n- bug #4440 Javascript error when renaming table\n- bug #4483 'New window' link (selflink) disappears, causing Javascript error\n- bug #4489 Incorrect detection of privileges for routine creation\n- bug #4459 First few characters of database name aren't clickable when expanded\n- bug #4486 [security] XSS injection due to unescaped table comment\n- bug #4488 [security] XSS injection due to unescaped table name (triggers)\n- bug #4492 [security] XSS in AJAX confirmation messages\n- bug #4491 [security] Missing validation for accessing User groups feature\n\n4.2.5.0 (2014-06-26)\n- bug #4467 shell_exec() has been disabled for security reasons\n- bug #4470 Error while submitting empty query\n- bug #4463 Fatal error: Class 'PMA_DatabaseInterface' not found\n- bug #4469 Fixed cookie based login for installations without mcrypt\n- bug #4473 incorrect result count when having clause is used\n-           mcrypt: remove the requirement (64-bit) and the related warning\n\n4.2.4.0 (2014-06-20)\n- bug #4449 Mediawiki export does not produce table header row; also fix related PHP warnings\n- bug #4442 New lines are added to query every time\n- bug #4445 Fatal error on SQL Export of join query\n- bug #4448 Dump binary columns in hexadecimal notation not working\n- Regenerate cookie encryption IV for every session\n- bug #4405 Cannot import (open_basedir): fix another case\n- bug #4457 SQL tab - Insert queries not showing affected row count\n- bug       Missing warning about existing account, on multi-server config\n- bug #4435 WHERE clause can be undefined\n- bug       SQL export views as tables option getting ignored\n- bug #4464 [security] XSS injection due to unescaped db/table name in navigation hiding\n- bug #4465 [security] XSS injection due to unescaped db/table name in recent/favorite tables\n\n4.2.3.0 (2014-06-08)\n- bug #4423 Moving fields not working\n- bug #4424 Table indexes disappear after altering field\n- bug #4432 Error while displaying chart at server level\n- bug #4405 Cannot import (open_basedir)\n- bug #4396 Problem copying constraints (such as Sakila)\n- bug #4433 Missing privileges submenu\n- bug #4394 Drop db confirmation message when dropping a user\n- bug #4436 Insert form numeric field with function drop-down list\n- bug #4437 Problems due to missing enforcement of the minimum supported MySQL version\n+ Add enforcement of the minimum supported PHP version (5.3.0)\n- bug       Query error on submitting a column change form containing a disabled input field\n- bug       Incorrect menu tab generation from usergroups\n- bug       Missing space in index creation/edit generated query\n- bug #4434 Unchecking 'Show SQL queries' results NaN\n\n4.2.2.0 (2014-05-20)\n- bug #4388 Disable database expansion when enabled throws Error 500 when database name is clicked in navigation tree\n- bug #4414 table display of performance_schema DB structure\n- bug #4411 Protect Binary Columns: many problems\n- bug #4395 BLOB link transformation is broken\n- bug       Respect ['ShowCreateDb'] in the navi panel\n- bug #4392 Cannot see databases in nav panel on databases grouping when disabled database expansion\n- bug #4419 No more calendar into search tab\n- bug #4398 Monitor should fit into screen width\n- bug #4418 When copying databases, primary key attributes get lost\n- bug #4421 empty maxInputVars on js/messages.php\n\n4.2.1.0 (2014-05-13)\n- bug #4380 Cannot display table structure with enums containing special characters\n- bug #4381 Cannot remove the last remembered sorted column\n- bug       Correctly fetch length of user and host fields in MySQL tables\n- bug #4364 examples/signon.php does not support the SessionSavePath directive\n- bug #4382 Missing source for OpenLayers library\n- bug       Incorrect attributes for number fields\n- bug #4383 Cannot update values in Zoom search\n- bug #4313 GIS Visualization Extension does not work with PointFromText() function\n- bug #4384 Incorrect \"Rows\" total shown when truncating or dropping a table on DB Structure page\n- bug #4385 Grid edit on sorted columns fails\n- bug #4389 Null checkbox covering data input when editing\n- bug #4390 Data type changing by itself (no size but attribute present)\n\n4.2.0.0 (2014-05-08)\n+ rfe #1403 Export only triggers\n+ rfe #1483 Export Server/Database/Table without triggers\n+ rfe #1662 Add table comment tool tip in database structure page\n+ rfe #1447 Single table for display Character Sets and Collations\n+ rfe #1455 Display icons/text/both for the table row actions\n+ rfe #1473 Transformation to convert Boolean value to text\n- bug #4157 Changing users password will delete it\n+ rfe #1474 Text transformation combines Append and Prepend\n+ Added warning about the mysql extension being deprecated\n  and removed the extension directive\n+ Added support for scatter charts\n+ rfe #1478 Make Column Headings Sticky\n+ rfe #1480 Enhance privileges initials table\n+ rfe #1472 [interface] Break \"Edit privileges\" with sub-menus\n+ rfe #1466 Minor refactoring required\n+ rfe #1004 Create indexes at the end in SQL export\n+ rfe #1479 Relations edit form for larger monitors\n+ rfe #1475 Inline query box vertical resize\n+ rfe #1500 [interface] Add bottom border to top menu container\n+ rfe #1498 Add datepicker for 'TIME' type\n- bug #4237 HTTP Referer disclosure in SQL links\n+ rfe       Show full names on navigation hover\n+ rfe #1505 Behaviour on click on a routine in nav panel\n+ rfe #1418 Support more than one separating character on CSV import\n+ rfe #569  Load/Save Query By Example\n- bug #4281 Grid edit ENUM field, dialog disappears when trying to select\n- bug #4304 DB export using zip compression generates an empty archive\n+ rfe #1508 confirmation message at the top\n- bug #4306 breadcrubs wrong on table create\n+ rfe #1511 better validate database name for copying\n+ rfe #1510 Database tab \"Drop\" button should be a link\n+ rfe #1513 Highlight required form fields after failed submission\n+ rfe #1460 Redirect to login page after session has expired\n- bug #4316 Grid edit: can't change month on date fields\n+ rfe #1501 add maxlength by field with length-spec\n+ rfe #1512 Import happily doesn't do anything with no file name provided\n+ rfe #1514 Add function to all the insert boxes automatically\n+ rfe #1515 Option to skip tables larger than n\n+ rfe #1486 Possibility of disabling database expansion\n+ rfe #1476 Favourite tables select box\n+ rfe #420  $cfg['CharEditing']='textarea' for structure edit\n+ rfe #1329 Avoid editing of fields which are part of relation\n+ rfe       [interface] Highlight active left menu item in setup\n+ rfe       Filter on-screen rows during Browse\n  Removed support for SQL Validator (SOAP service no longer offered)\n- bug #4352 Settings > Manage: incorrect messages\n- bug #4337 \"More\" in Actions area doesn't collapse to fit available space\n- bug #4375 Group two DB, one's name is the prefix of the other one\n- bug #4070 Confusing database/table grouping\n- bug #4366 Creating Index doesn't update index-list\n+ rfe #1507 Sort by multiple columns\n\n4.1.14.1 (2014-06-21)\n- bug #4464 [security] XSS injection due to unescaped db/table name in navigation hiding\n\n4.1.14.0 (2014-04-26)\n- bug #4365 Creating bookmark with multiple queries not working\n- bug #4375 Group two DB, one's name is the prefix of the other one\n- bug #4376 [interface] Login fields show in separate line\n- bug #4372 Changing browser transformation results in unnecessary table rebuild\n\n4.1.13.0 (2014-04-13)\n- bug #4279 CTRL + up or down moves 2 fields\n- bug #4336 List server css style wrong\n- bug       Missing value on the Status > Server page\n- bug #4347 Fixed PHP Parse error in Advisor\n- bug #4350 Deleting the DB if it is renamed by the same name\n- bug #4353 makeProfilingChart is not defined\n- bug #4355 Precision specifier for DOUBLE type is truncated\n- bug #4346 Incorrect \"Export incomplete\" message\n- bug #4359 Notices on create table page\n- bug #4356 GROUPed selects show number of rows as if not grouped\n- bug #4357 JS Form submitted on \"enter\" even if focus is inside a select field\n\n4.1.12.0 (2014-03-27)\n- bug #4334 Add event : datepicker won't open\n- bug #4338 Fix missing value error while executing SQL query\n- TCPDF library is now optional dependency\n- bug #4326 Cannot find the import plugins which start with uppercase 'I'\n\n4.1.11.0 (2014-03-23)\n- bug #4335 reCaptcha problem (4.1.10 regression)\n\n4.1.10.0 (2014-03-22)\n- bug #4301 Grid edit: \"SELECT\" query is replaced by \"UPDATE\" query after edit\n- bug #4278 reCaptcha re-login requires double effort\n- bug #4324 Datepicker not showing up on insert page\n- bug #3991 Problem selecting item in select boxes with the ENTER keystroke in some browsers\n- bug #4323 QueryWindow ignores CodeMirror\n- bug       None of the live charts shown on \"Status -> Monitor\" (Chrome)\n\n4.1.9.0 (2014-03-06)\n- bug #4279 CTRL + up or down moves two fields (part one)\n- bug #4294 output as text radio clickable for \"OpenDocument Text\" export\n- bug #4297 DROP DATABASE tick box in export no longer works\n- bug #4291 Unable to export comments in OpenDocument text format\n- bug #4299 Deletion even when the user says \"No\" to the confirmation message\n- bug #4303 \"New\" link in navi panel is shown even if no privileges\n- bug #4302 Some params are being omitted from microhistory\n- bug #4298 Missing validation on Import CSV: \"Columns enclosed with\" and \"Columns escaped with\"\n- bug #4040 Fatal error while resetting settings\n- bug #4305 JS error when editing procedure from nav panel\n- bug #4308 Edit routine form submitting when pressing enter\n- bug #4307 Nav: \"Columns\" won't expand with specific schema\n\n4.1.8.0 (2014-02-22)\n- bug #4276 Login loop on session expiry\n- bug #4249 Incorrect number of result rows for SQL with subqueries\n- bug #4275 Broken Link to php extension manual\n- bug #4053 List of procedures is not displayed after executing with Enter\n- bug #4081 Setup page content shifted to the right edge of its tabs\n- bug #4284 Reordering a column erases comments for other columns\n- bug #4286 Open \"Browse\" in a new tab\n- bug #4287 Printview - Always one column too much\n- bug #4288 Expand database (+ icon) after timeout doesn't do anything\n- bug #4285 Fixed CSS for setup\n- Fixed altering table to DOUBLE/FLOAT field\n- bug #4292 Success message and failure message being shown together\n- bug #4293 opening new tab (using selflink) for import.php based actions\n            results in error and logout\n\n4.1.7.0 (2014-02-09)\n- bug #4245 initial Browse query does not match sorting order\n- bug #4250 Notice on export page\n- bug #4253 \"New\" text in navigation frame acts like a database\n- bug #4262 Cannot define a column with fractional seconds\n- bug #4265 Missing datepicker icon for DATETIME(length)\n- bug #4257 Hide fractional seconds when applicable\n- bug #4264 Uncheck \"Ignore\" while inserting, upon leaving a textarea\n- bug #4260 reCaptcha is ignoring language settings\n- bug #4263 Japanese character encoding not working properly when exporting\n- bug #4269 Notice on table relation page\n- bug #4270 Bad text-color for table comments\n- bug #4272 Incorrect tabindex\n- bug #4271 Query by example and the second criteria line\n- bug #4242 Wildcard-containing only_db failure in sidebar\n\n4.1.6.0 (2014-01-26)\n- bug #4232 User not found after creating the user\n- bug #4241 Confusing dialog when trying to create an already existing user\n- bug #4239 Missing LIMIT clause for some queries\n- rfe #1489 Do not show create icon when user has no privileges\n- bug #4218 Chrome behavior with date fields\n- bug #3579 NOW() function incorrectly selected (regression)\n- bug #4244 Advisor complaints about MariaDB 10.x is version less than 5.1\n- bug #3889 When login fails and error display is active, login data is\ndisplayed (regression)\n- bug #4247 open_basedir warnings on export page\n- bug #4013 AJAX request waiting until version info is retrieved\n- bug #4248 js error when changing number of columns in status monitor\n\n4.1.5.0 (2014-01-17)\n- bug #3780 Allow aborting loading pages\n- bug #4223 Database list: Create database misses collation column\n- bug #4224 Empty table names when a table is \"inuse\"\n- bug #4225 Partition maintenance broken\n- bug #4219 Table list (left panel) does not reload when table renamed\n- bug #4230 \"in use\" displayed for all views in database print view\n- bug #4226 Notice: Undefined index: pma_config_loading\n- bug #4221 Bzip2 export cannot be directly imported (so withdraw bz2 export)\n- bug #4204 Reloading user privileges hides user groups submenu\n- bug #4231 DATE columns quick edit decrement by one day\n\n4.1.4.0 (2014-01-07)\n- bug #3840 (additional fix) When exporting to gzip format, the data is compressed 2 times\n- bug #4209 Missing compression in one case\n- bug #4208 Can't browse tables after sorting on columns with fieldnames that have a '-'\n- bug #4184 Switch to wrong page after adding an index\n- bug #3885 Additional fix for this bug\n- bug #4212 Table \"disappears\" if it has the same name as its tablegroup\n- bug #4213 Datetime Quick Edit decrements by one day\n- bug #4217 Current value not highlighted when browsing foreign values\n- bug #4220 Incorrect key values in foreign key browser\n- bug #4215 MariaDB 5.5: error in Drizzle detection\n\n         --- Older ChangeLogs can be found on our project website ---\n                     http://www.phpmyadmin.net/old-stuff/ChangeLogs/\n\n# vim: et ts=4 sw=4 sts=4\n# vim: ft=changelog fenc=utf-8\n# vim: fde=getline(v\\:lnum-1)=~'^\\\\s*$'&&getline(v\\:lnum)=~'\\\\S'?'>1'\\:1&&v\\:lnum>4&&getline(v\\:lnum)!~'^#'\n# vim: fdn=1 fdm=expr\n", "<?php\n/* vim: set expandtab sw=4 ts=4 sts=4: */\n/**\n * Handles table zoom search tab\n *\n * display table zoom search form, create SQL queries from form data\n *\n * @package PhpMyAdmin\n */\n\n/**\n * Gets some core libraries\n */\nrequire_once './libraries/common.inc.php';\nrequire_once './libraries/mysql_charsets.inc.php';\nrequire_once './libraries/TableSearch.class.php';\nrequire_once './libraries/tbl_info.inc.php';\n\n$response = PMA_Response::getInstance();\n$header   = $response->getHeader();\n$scripts  = $header->getScripts();\n$scripts->addFile('makegrid.js');\n$scripts->addFile('sql.js');\n$scripts->addFile('jqplot/jquery.jqplot.js');\n$scripts->addFile('jqplot/plugins/jqplot.canvasTextRenderer.js');\n$scripts->addFile('jqplot/plugins/jqplot.canvasAxisLabelRenderer.js');\n$scripts->addFile('jqplot/plugins/jqplot.dateAxisRenderer.js');\n$scripts->addFile('jqplot/plugins/jqplot.highlighter.js');\n$scripts->addFile('jqplot/plugins/jqplot.cursor.js');\n$scripts->addFile('canvg/canvg.js');\n$scripts->addFile('jquery/jquery-ui-timepicker-addon.js');\n$scripts->addFile('tbl_zoom_plot_jqplot.js');\n\n$table_search = new PMA_TableSearch($db, $table, \"zoom\");\n\n/**\n * Handle AJAX request for data row on point select\n * @var post_params Object containing parameters for the POST request\n */\n\nif (isset($_REQUEST['get_data_row']) && $_REQUEST['get_data_row'] == true) {\n    $extra_data = array();\n    $row_info_query = 'SELECT * FROM `' . $_REQUEST['db'] . '`.`'\n        . $_REQUEST['table'] . '` WHERE ' .  $_REQUEST['where_clause'];\n    $result = $GLOBALS['dbi']->query(\n        $row_info_query . \";\", null, PMA_DatabaseInterface::QUERY_STORE\n    );\n    $fields_meta = $GLOBALS['dbi']->getFieldsMeta($result);\n    while ($row = $GLOBALS['dbi']->fetchAssoc($result)) {\n        // for bit fields we need to convert them to printable form\n        $i = 0;\n        foreach ($row as $col => $val) {\n            if ($fields_meta[$i]->type == 'bit') {\n                $row[$col] = PMA_Util::printableBitValue(\n                    $val, $fields_meta[$i]->length\n                );\n            }\n            $i++;\n        }\n        $extra_data['row_info'] = $row;\n    }\n    PMA_Response::getInstance()->addJSON($extra_data);\n    exit;\n}\n\n/**\n * Handle AJAX request for changing field information\n * (value,collation,operators,field values) in input form\n * @var post_params Object containing parameters for the POST request\n */\n\nif (isset($_REQUEST['change_tbl_info']) && $_REQUEST['change_tbl_info'] == true) {\n    $response = PMA_Response::getInstance();\n    $field = $_REQUEST['field'];\n    if ($field == 'pma_null') {\n        $response->addJSON('field_type', '');\n        $response->addJSON('field_collation', '');\n        $response->addJSON('field_operators', '');\n        $response->addJSON('field_value', '');\n        exit;\n    }\n    $key = array_search($field, $table_search->getColumnNames());\n    $properties = $table_search->getColumnProperties($_REQUEST['it'], $key);\n    $response->addJSON('field_type', htmlspecialchars($properties['type']));\n    $response->addJSON('field_collation', $properties['collation']);\n    $response->addJSON('field_operators', $properties['func']);\n    $response->addJSON('field_value', $properties['value']);\n    exit;\n}\n\n// Gets some core libraries\nrequire_once './libraries/tbl_common.inc.php';\n$url_query .= '&amp;goto=tbl_select.php&amp;back=tbl_select.php';\n\n// Gets tables informations\nrequire_once './libraries/tbl_info.inc.php';\n\nif (! isset($goto)) {\n    $goto = $GLOBALS['cfg']['DefaultTabTable'];\n}\n// Defines the url to return to in case of error in the next sql statement\n$err_url   = $goto . '?' . PMA_URL_getCommon($db, $table);\n\n//Set default datalabel if not selected\nif ( !isset($_POST['zoom_submit']) || $_POST['dataLabel'] == '') {\n    $dataLabel = PMA_getDisplayField($db, $table);\n} else {\n    $dataLabel = $_POST['dataLabel'];\n}\n\n// Displays the zoom search form\n$response->addHTML($table_search->getSecondaryTabs());\n$response->addHTML($table_search->getSelectionForm($goto, $dataLabel));\n\n/*\n * Handle the input criteria and generate the query result\n * Form for displaying query results\n */\nif (isset($_POST['zoom_submit'])\n    && $_POST['criteriaColumnNames'][0] != 'pma_null'\n    && $_POST['criteriaColumnNames'][1] != 'pma_null'\n    && $_POST['criteriaColumnNames'][0] != $_POST['criteriaColumnNames'][1]\n) {\n    //Query generation part\n    $sql_query = $table_search->buildSqlQuery();\n    $sql_query .= ' LIMIT ' . $_POST['maxPlotLimit'];\n\n    //Query execution part\n    $result = $GLOBALS['dbi']->query(\n        $sql_query . \";\", null, PMA_DatabaseInterface::QUERY_STORE\n    );\n    $fields_meta = $GLOBALS['dbi']->getFieldsMeta($result);\n    while ($row = $GLOBALS['dbi']->fetchAssoc($result)) {\n        //Need a row with indexes as 0,1,2 for the getUniqueCondition\n        // hence using a temporary array\n        $tmpRow = array();\n        foreach ($row as $val) {\n            $tmpRow[] = $val;\n        }\n        //Get unique conditon on each row (will be needed for row update)\n        $uniqueCondition = PMA_Util::getUniqueCondition(\n            $result, count($table_search->getColumnNames()), $fields_meta, $tmpRow,\n            true\n        );\n        //Append it to row array as where_clause\n        $row['where_clause'] = $uniqueCondition[0];\n\n        $tmpData = array(\n            $_POST['criteriaColumnNames'][0] =>\n                $row[$_POST['criteriaColumnNames'][0]],\n            $_POST['criteriaColumnNames'][1] =>\n                $row[$_POST['criteriaColumnNames'][1]],\n            'where_clause' => $uniqueCondition[0]\n        );\n        $tmpData[$dataLabel] = ($dataLabel) ? $row[$dataLabel] : '';\n        $data[] = $tmpData;\n    }\n    unset($tmpData);\n\n    //Displays form for point data and scatter plot\n    $response->addHTML($table_search->getZoomResultsForm($goto, $data));\n}\n?>\n"], "filenames": ["ChangeLog", "tbl_zoom_select.php"], "buggy_code_start_loc": [18, 84], "buggy_code_end_loc": [18, 85], "fixing_code_start_loc": [19, 84], "fixing_code_end_loc": [20, 85], "type": "CWE-79", "message": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.6, 4.1.x before 4.1.14.7, and 4.2.x before 4.2.12 allow remote authenticated users to inject arbitrary web script or HTML via a crafted (1) database, (2) table, or (3) column name that is improperly handled during rendering of the table browse page; a crafted ENUM value that is improperly handled during rendering of the (4) table print view or (5) zoom search page; or (6) a crafted pma_fontsize cookie that is improperly handled during rendering of the home page.", "other": {"cve": {"id": "CVE-2014-8958", "sourceIdentifier": "cve@mitre.org", "published": "2014-11-30T11:59:00.087", "lastModified": "2016-12-22T02:59:20.783", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "Multiple cross-site scripting (XSS) vulnerabilities in phpMyAdmin 4.0.x before 4.0.10.6, 4.1.x before 4.1.14.7, and 4.2.x before 4.2.12 allow remote authenticated users to inject arbitrary web script or HTML via a crafted (1) database, (2) table, or (3) column name that is improperly handled during rendering of the table browse page; a crafted ENUM value that is improperly handled during rendering of the (4) table print view or (5) zoom search page; or (6) a crafted pma_fontsize cookie that is improperly handled during rendering of the home page."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de XSS en phpMyAdmin 4.0.x anterior a 4.0.10.6, 4.1.x anterior a 4.1.14.7, y 4.2.x anterior a 4.2.12 permiten a usuarios remotos autenticados inyectar secuencias de comandos web o HTML arbitrarios a trav\u00e9s de (1) una base de datos manipulada, (2) una tabla manipulada o (3) un nombre de columna manipulado que se maneja indebidamente durante el renderazaci\u00f3n de la p\u00e1gina del navegador de tablas; un valor ENUM manipulado que se maneja indebidamente durante la renderizaci\u00f3n de (4) la visualizaci\u00f3n de la impresi\u00f3n de tablas o (5) la p\u00e1gina de b\u00fasqueda del zoom; o (6) una cookie pma_fontsize manipulada que se maneja indebidamente durante la renderizaci\u00f3n de la p\u00e1gina de inicio."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "2F06DC95-76B1-4E24-A55F-1358A25ED0E5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "2CA76CB4-6167-446A-8D4F-6D5B38046334"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "B8D28655-7F37-474D-A4E2-772AF24B94E7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "1FA1951E-BD85-42BF-BF7F-79A14D165914"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.4:*:*:*:*:*:*:*", "matchCriteriaId": "0D08BEE8-5ACF-438D-9F06-86C6227C9A5F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "58DD0910-DBBA-4858-B9B1-FA93D08323D0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "50DA8EBE-52AA-45A5-A5FB-75AF84E415E4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.5:*:*:*:*:*:*:*", "matchCriteriaId": "DC8D93A3-8997-4EB9-A411-74B296D1341F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.6:*:*:*:*:*:*:*", "matchCriteriaId": "6E5A81B2-E16F-4AE2-9691-92D3E8A25CCB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.7:*:*:*:*:*:*:*", "matchCriteriaId": "0245AF2D-F856-4CAA-A830-36D43026D1E4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.8:*:*:*:*:*:*:*", "matchCriteriaId": "00BD9E52-A6BB-48BB-9FEE-D0272AD9B6DA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.9:*:*:*:*:*:*:*", "matchCriteriaId": "C69E253E-157D-45BA-A977-079A49F74A72"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.10:*:*:*:*:*:*:*", "matchCriteriaId": "6325E2AE-BB86-4953-AA9E-0433C00B096E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.10.1:*:*:*:*:*:*:*", "matchCriteriaId": "3C54B828-8B23-4C62-907E-8EE7E757B721"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.10.2:*:*:*:*:*:*:*", "matchCriteriaId": "02DD18C8-172B-41CD-87DD-58BDEC0D9418"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.10.3:*:*:*:*:*:*:*", "matchCriteriaId": "10666E30-D98A-47A9-881A-B281066F0EC8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.10.4:*:*:*:*:*:*:*", "matchCriteriaId": "3993826B-CA66-4BC2-8E1B-06CF9230B214"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.0.10.5:*:*:*:*:*:*:*", "matchCriteriaId": "14928F51-761E-4FCA-B13C-A11530C7FC46"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "8F0A53D6-E68D-417E-9B72-55F603EBDFD5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "2B45FC64-ECDF-474A-9151-30667543760E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "12D9ACD9-BA79-4AC0-800D-A66519799DBE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.3:*:*:*:*:*:*:*", "matchCriteriaId": "2E5DD938-C9C2-4542-8AD5-4C11FBFA43CE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.4:*:*:*:*:*:*:*", "matchCriteriaId": "0150F164-B7C2-4E5C-886C-49D651CF307F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.5:*:*:*:*:*:*:*", "matchCriteriaId": "FB765223-DB56-4327-B150-1D633E4AB41C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.6:*:*:*:*:*:*:*", "matchCriteriaId": "58102B9D-C071-43C0-B412-7733E302A944"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.7:*:*:*:*:*:*:*", "matchCriteriaId": "45CDE76C-38B3-41F1-83E7-34F00A4E009A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.8:*:*:*:*:*:*:*", "matchCriteriaId": "EA6AE567-72BB-4B5C-A9B3-AF406691491F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.9:*:*:*:*:*:*:*", "matchCriteriaId": "A13760E1-EA18-434E-8075-D330AEE05D21"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.10:*:*:*:*:*:*:*", "matchCriteriaId": "8A6A3056-B853-4880-BECF-799791B5C660"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.11:*:*:*:*:*:*:*", "matchCriteriaId": "09FA5A47-CEF2-4525-BBE4-D1205172300B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.12:*:*:*:*:*:*:*", "matchCriteriaId": "4D228D62-3E19-4005-A995-39AFF30A978B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.13:*:*:*:*:*:*:*", "matchCriteriaId": "C4FF2BA7-F240-4A5B-AC22-62F07D26BB29"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.14:*:*:*:*:*:*:*", "matchCriteriaId": "8AC849CA-2056-491C-B6B1-3D3A4825BF63"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.14.1:*:*:*:*:*:*:*", "matchCriteriaId": "109C5928-FA6D-4835-B538-B235083AF38F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.14.2:*:*:*:*:*:*:*", "matchCriteriaId": "F9DF4655-0731-4C3D-A6D9-E4FFFC63AE08"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.14.3:*:*:*:*:*:*:*", "matchCriteriaId": "69C6393B-C682-4FD2-8ACF-CBBFC9E54286"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.14.4:*:*:*:*:*:*:*", "matchCriteriaId": "A68B7DB5-66E6-4E8B-8760-4B3535838641"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.14.5:*:*:*:*:*:*:*", "matchCriteriaId": "EC60DE84-575A-4031-8B78-AD67C60595AB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.1.14.6:*:*:*:*:*:*:*", "matchCriteriaId": "58D3F904-8C3C-46A5-A7A6-8EFA49648687"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEC525D5-EA90-4F01-B1D3-64F4BFBFC4DE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "8ACC297E-A54A-4C92-9BCB-CDDA0C7E56C1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.2:*:*:*:*:*:*:*", "matchCriteriaId": "4FA4B695-DD00-45FE-8A74-A34E9920EE23"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.3:*:*:*:*:*:*:*", "matchCriteriaId": "BC38B8F8-DB1C-4A7D-A15B-390754687F18"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.4:*:*:*:*:*:*:*", "matchCriteriaId": "CFA5B74C-F0E8-46D0-AF53-A25145DA3E9B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.5:*:*:*:*:*:*:*", "matchCriteriaId": "A6DD88B5-9F4D-4B1C-8A36-CA9727514B42"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.6:*:*:*:*:*:*:*", "matchCriteriaId": "E8645867-C499-41C6-8AA4-B5CB0DB4BB6D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.7.1:*:*:*:*:*:*:*", "matchCriteriaId": "708FC2C9-6038-4FDF-9B41-EFBBEA23F114"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.8:*:*:*:*:*:*:*", "matchCriteriaId": "79B0DE12-E756-44B3-8C2F-8C9246F36BC5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.8.1:*:*:*:*:*:*:*", "matchCriteriaId": "50E07E05-60B4-4427-81B0-F44C3089E1F3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.9:*:*:*:*:*:*:*", "matchCriteriaId": "887DAFF7-7344-4A1C-9DC0-C41BA3E7C092"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.9.1:*:*:*:*:*:*:*", "matchCriteriaId": "E5BF910D-87F7-4FF5-ACA0-1FCEEF4DD741"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.10.1:*:*:*:*:*:*:*", "matchCriteriaId": "C10AFF14-5C5A-4858-97A2-1208278D916E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.2.11:*:*:*:*:*:*:*", "matchCriteriaId": "E0716B60-E8C7-40EA-8A96-9EC0D868D11A"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-updates/2014-12/msg00017.html", "source": "cve@mitre.org"}, {"url": "http://www.debian.org/security/2015/dsa-3382", "source": "cve@mitre.org"}, {"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2014:228", "source": "cve@mitre.org"}, {"url": "http://www.phpmyadmin.net/home_page/security/PMASA-2014-13.php", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "http://www.securityfocus.com/bid/71243", "source": "cve@mitre.org"}, {"url": "https://github.com/phpmyadmin/phpmyadmin/commit/1bc04ec95038f2356ad33752090001bf1c047208", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/phpmyadmin/phpmyadmin/commit/2a3b7393d1d5a8ba0543699df94a08a0f5728fe0", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/phpmyadmin/phpmyadmin/commit/2ffdbf2d7daa0b92541d8b754e2afac555d3ed21", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/phpmyadmin/phpmyadmin/commit/d32da348c4de2379482a48661ce968a55eebe5c4", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://security.gentoo.org/glsa/201505-03", "source": "cve@mitre.org"}]}, "github_commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/1bc04ec95038f2356ad33752090001bf1c047208"}}