{"buggy_code": ["# Fail2Ban configuration file\n#\n# Author: Cyril Jaquier\n#\n#\n\n[Definition]\n\n# Option:  failregex\n# Notes.:  regex to match the password failures messages in the logfile. The\n#          host must be matched by a group named \"host\". The tag \"<HOST>\" can\n#          be used for standard IP/hostname matching and is only an alias for\n#          (?:::f{4,6}:)?(?P<host>[\\w\\-.^_]+)\n# Values:  TEXT\n#\nfailregex = reject: RCPT from (.*)\\[<HOST>\\]: 554\n            reject: RCPT from (.*)\\[<HOST>\\]: 450 4\\.7\\.1 : Helo command rejected: Host not found; from=<> to=<> proto=ESMTP helo= *$\n\n# Option:  ignoreregex\n# Notes.:  regex to ignore. If this regex matches, the line is ignored.\n# Values:  TEXT\n#\nignoreregex = \n", "# per https://github.com/fail2ban/fail2ban/issues/125\n# and https://github.com/fail2ban/fail2ban/issues/126\n# failJSON: { \"time\": \"2005-02-21T09:21:54\", \"match\": true , \"host\": \"192.0.43.10\" }\nFeb 21 09:21:54 xxx postfix/smtpd[14398]: NOQUEUE: reject: RCPT from example.com[192.0.43.10]: 450 4.7.1 : Helo command rejected: Host not found; from=<> to=<> proto=ESMTP helo=\n# failJSON: { \"time\": \"2005-07-12T07:47:48\", \"match\": true , \"host\": \"1.2.3.4\" }\nJul 12 07:47:48 saturn postfix/smtpd[8738]: NOQUEUE: reject: RCPT from 1-2-3-4-example.com[1.2.3.4]: 554 5.7.1 <smtp@example.com>: Relay access denied; from=<john@example.com> to=<smtp@example.org> proto=SMTP helo=<198.51.100.17>\n"], "fixing_code": ["# Fail2Ban configuration file\n#\n# Author: Cyril Jaquier\n#\n#\n\n[INCLUDES]\n\n# Read common prefixes. If any customizations available -- read them from\n# common.local\nbefore = common.conf\n\n\n[Definition]\n\n_daemon = postfix/smtpd\n\n# Option:  failregex\n# Notes.:  regex to match the password failures messages in the logfile. The\n#          host must be matched by a group named \"host\". The tag \"<HOST>\" can\n#          be used for standard IP/hostname matching and is only an alias for\n#          (?:::f{4,6}:)?(?P<host>[\\w\\-.^_]+)\n# Values:  TEXT\n#\nfailregex = ^%(__prefix_line)sNOQUEUE: reject: RCPT from \\S+\\[<HOST>\\]: 554 5\\.7\\.1 .*$\n            ^%(__prefix_line)sNOQUEUE: reject: RCPT from \\S+\\[<HOST>\\]: 450 4\\.7\\.1 : Helo command rejected: Host not found; from=<> to=<> proto=ESMTP helo= *$\n\n# Option:  ignoreregex\n# Notes.:  regex to ignore. If this regex matches, the line is ignored.\n# Values:  TEXT\n#\nignoreregex = \n", "# per https://github.com/fail2ban/fail2ban/issues/125\n# and https://github.com/fail2ban/fail2ban/issues/126\n# failJSON: { \"time\": \"2005-02-21T09:21:54\", \"match\": true , \"host\": \"192.0.43.10\" }\nFeb 21 09:21:54 xxx postfix/smtpd[14398]: NOQUEUE: reject: RCPT from example.com[192.0.43.10]: 450 4.7.1 : Helo command rejected: Host not found; from=<> to=<> proto=ESMTP helo=\n# failJSON: { \"time\": \"2005-07-12T07:47:48\", \"match\": true , \"host\": \"1.2.3.4\" }\nJul 12 07:47:48 saturn postfix/smtpd[8738]: NOQUEUE: reject: RCPT from 1-2-3-4-example.com[1.2.3.4]: 554 5.7.1 <smtp@example.com>: Relay access denied; from=<john@example.com> to=<smtp@example.org> proto=SMTP helo=<198.51.100.17>\n# failJSON: { \"time\": \"2005-07-18T23:12:56\", \"match\": true , \"host\": \"192.51.100.65\" }\nJul 18 23:12:56 xxx postfix/smtpd[8738]: NOQUEUE: reject: RCPT from foo[192.51.100.65]: 554 5.7.1 <bad.domain>: Helo command rejected: match bad.domain; from=<foo@good.domain> to=<foo@porcupine.org> proto=SMTP helo=<bad.domain>\n# failJSON: { \"time\": \"2005-07-18T23:12:56\", \"match\": true , \"host\": \"192.51.100.43\" }\nJul 18 23:12:56 xxx postfix/smtpd[8738]: NOQUEUE: reject: RCPT from foo[192.51.100.43]: 554 5.7.1 <foo@bad.domain>: Sender address rejected: match bad.domain; from=<foo@bad.domain> to=<foo@porcupine.org> proto=SMTP helo=<192.51.100.43>\n"], "filenames": ["config/filter.d/postfix.conf", "testcases/files/logs/postfix"], "buggy_code_start_loc": [6, 6], "buggy_code_end_loc": [18, 6], "fixing_code_start_loc": [7, 7], "fixing_code_end_loc": [27, 11], "type": "CWE-20", "message": "config/filter.d/postfix.conf in the postfix filter in Fail2ban before 0.8.11 allows remote attackers to trigger the blocking of an arbitrary IP address via a crafted e-mail address that matches an improperly designed regular expression.", "other": {"cve": {"id": "CVE-2013-7176", "sourceIdentifier": "cret@cert.org", "published": "2014-02-01T15:55:04.120", "lastModified": "2014-11-19T02:59:08.210", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "config/filter.d/postfix.conf in the postfix filter in Fail2ban before 0.8.11 allows remote attackers to trigger the blocking of an arbitrary IP address via a crafted e-mail address that matches an improperly designed regular expression."}, {"lang": "es", "value": "El fichero config/filter.d/postfix.conf del filtro de Postfix en Fail2Ban anterior a 0.8.11 permite a atacantes remotos activar el bloqueo de direcciones IP arbitrarias a trav\u00e9s de una direcci\u00f3n de e-mail manipulada que coincida con una expresi\u00f3n regular dise\u00f1ada incorrectamente."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:*:*:*:*:*:*:*:*", "versionEndIncluding": "0.8.10", "matchCriteriaId": "838C1143-CD41-4A2E-954A-7085F9B423A5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "7750E527-5A05-4716-BF4A-B40EA9E34394"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "FA9C7EF4-DA9B-4ADF-A044-2AC8A2FC270F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "0FCFD263-E347-43DD-80A6-D222FCEF23D4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.3.0:*:*:*:*:*:*:*", "matchCriteriaId": "64A0FEBA-647F-41F4-8590-7E8C7A49A36D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.3.1:*:*:*:*:*:*:*", "matchCriteriaId": "40BBF7B9-57DB-4479-B2C3-8EB466185E94"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.4.0:*:*:*:*:*:*:*", "matchCriteriaId": "D7847766-CF03-4BF1-BE69-09C50AEC3DFC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "E004A754-3CCB-409D-B13A-DF735ED63971"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.5.0:*:*:*:*:*:*:*", "matchCriteriaId": "ADF9F5C0-7E85-40AC-A7AA-7442749E48D6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.5.1:*:*:*:*:*:*:*", "matchCriteriaId": "2331299E-1834-4853-B38B-9E24A364EC62"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.5.2:*:*:*:*:*:*:*", "matchCriteriaId": "AA9B27B6-418F-4101-A4A1-6E887BF0BB39"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.5.3:*:*:*:*:*:*:*", "matchCriteriaId": "2B6C2141-12A6-428A-9223-A0CA743BC020"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.5.4:*:*:*:*:*:*:*", "matchCriteriaId": "A0468228-10A0-4F72-BE85-D50ED3AA10B4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.5.5:*:*:*:*:*:*:*", "matchCriteriaId": "B73E5BBF-3755-4DC8-840F-2466BB2B280D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.6.0:*:*:*:*:*:*:*", "matchCriteriaId": "880958EA-3BE3-4F16-B323-3CA878BEB3A6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.6.1:*:*:*:*:*:*:*", "matchCriteriaId": "DB79FF61-80D6-4AB8-BC6F-6924AF9A0969"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.7.0:*:*:*:*:*:*:*", "matchCriteriaId": "66BAD83B-AACD-4BCE-8900-8558C6F82D7C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.7.1:*:*:*:*:*:*:*", "matchCriteriaId": "719BA249-7B47-488E-86BA-C08286FF8772"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.7.2:*:*:*:*:*:*:*", "matchCriteriaId": "A88DA08A-A1C6-4BC1-9BC1-BE823207BFA5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.7.3:*:*:*:*:*:*:*", "matchCriteriaId": "CD346590-84C5-473E-9672-2E920C71B7FD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.7.4:*:*:*:*:*:*:*", "matchCriteriaId": "F288E708-A212-4007-A32A-3608C56C5F7B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.7.5:*:*:*:*:*:*:*", "matchCriteriaId": "CF7EEF2A-DC72-4F51-B168-237EFA637988"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.7.6:*:*:*:*:*:*:*", "matchCriteriaId": "0D366BB8-A4FB-44CC-94BE-3C3BA3861C91"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.7.7:*:*:*:*:*:*:*", "matchCriteriaId": "114BC59D-4035-4BC6-B697-9D10415CBDD9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.7.8:*:*:*:*:*:*:*", "matchCriteriaId": "CB94274B-C1AF-4F87-B244-7BA4526F5D1E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.7.9:*:*:*:*:*:*:*", "matchCriteriaId": "98844A94-ABB6-41B4-A5B0-3101F54A3652"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.8.0:*:*:*:*:*:*:*", "matchCriteriaId": "3F522ECF-7F87-4A25-9CF3-0BCD99B4CAEB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.8.1:*:*:*:*:*:*:*", "matchCriteriaId": "AFEB99EB-DA51-48BB-96BD-4D47D8839C75"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.8.2:*:*:*:*:*:*:*", "matchCriteriaId": "E29B3199-71BB-4EED-9D91-B6F941AD7BAC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.8.3:*:*:*:*:*:*:*", "matchCriteriaId": "BE8CF239-5E91-4708-B594-FA825C69DFE9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.8.4:*:*:*:*:*:*:*", "matchCriteriaId": "2DB5D2A5-78E3-49C0-9A8D-397B21E03E26"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.8.5:*:*:*:*:*:*:*", "matchCriteriaId": "FFFCA848-72E8-4E33-A636-3D9009AAF870"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.8.6:*:*:*:*:*:*:*", "matchCriteriaId": "A97A9988-C973-4ACF-BD37-570004F1AD38"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.8.7:*:*:*:*:*:*:*", "matchCriteriaId": "BF73708F-4237-47BA-83B8-5999EED0EC28"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.8.7.1:*:*:*:*:*:*:*", "matchCriteriaId": "B343D0B4-9A4C-4F33-AC91-7CF1E1CC7708"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.8.8:*:*:*:*:*:*:*", "matchCriteriaId": "BDE0D31A-A9C2-48FF-B8FA-E65DDF6A9F7A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:fail2ban:fail2ban:0.8.9:*:*:*:*:*:*:*", "matchCriteriaId": "2FA5FB9D-53F2-47FA-865F-0A8225BBC64F"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-updates/2014-03/msg00021.html", "source": "cret@cert.org"}, {"url": "http://www.debian.org/security/2014/dsa-2979", "source": "cret@cert.org"}, {"url": "http://www.kb.cert.org/vuls/id/686662", "source": "cret@cert.org", "tags": ["US Government Resource"]}, {"url": "https://github.com/fail2ban/fail2ban/commit/eb2f0c927257120dfc32d2450fd63f1962f38821", "source": "cret@cert.org", "tags": ["Exploit", "Patch"]}]}, "github_commit_url": "https://github.com/fail2ban/fail2ban/commit/eb2f0c927257120dfc32d2450fd63f1962f38821"}}