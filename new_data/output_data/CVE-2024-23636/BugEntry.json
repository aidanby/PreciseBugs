{"buggy_code": ["aj.org.objectweb.asm.\nbr.com.anteros.\nbsh.\nch.qos.logback.\nclojure.\ncom.alibaba.citrus.springext.support.parser.\ncom.alibaba.citrus.springext.util.SpringExtUtil.\ncom.alibaba.druid.pool.\ncom.alibaba.druid.stat.JdbcDataSourceStat\ncom.alibaba.fastjson.annotation.\ncom.alibaba.hotcode.internal.org.apache.commons.collections.functors.\ncom.alipay.custrelation.service.model.redress.\ncom.alipay.oceanbase.obproxy.druid.pool.\ncom.caucho.\ncom.ibatis.\ncom.ibm.jtc.jax.xml.bind.v2.runtime.unmarshaller.\ncom.ibm.xltxe.rnm1.xtq.bcel.util.\ncom.mchange.\ncom.mysql.cj.jdbc.admin.\ncom.mysql.cj.jdbc.MysqlConnectionPoolDataSource\ncom.mysql.cj.jdbc.MysqlDataSource\ncom.mysql.cj.jdbc.MysqlXADataSource\ncom.mysql.cj.log.\ncom.mysql.jdbc.util.\ncom.p6spy.engine.\ncom.rometools.rome.feed.\ncom.sun.\ncom.taobao.eagleeye.wrapper.\ncom.taobao.vipserver.commons.collections.functors.\ncom.zaxxer.hikari.\nflex.messaging.util.concurrent.\ngroovy.lang.\njava.awt.\njava.beans.\njava.io.Closeable\njava.io.Serializable\njava.lang.AutoCloseable\njava.lang.Class\njava.lang.Cloneable\njava.lang.Iterable\njava.lang.ProcessBuilder\njava.lang.Readable\njava.lang.Runnable\njava.lang.Runtime\njava.lang.Thread\njava.lang.UNIXProcess\njava.net.InetAddress\njava.net.Socket\njava.net.URL\njava.rmi.\njava.security.\njava.util.EventListener\njava.util.jar.\njava.util.logging.\njava.util.prefs.\njava.util.ServiceLoader\njava.util.StringTokenizer\njavassist.\njavax.activation.\njavax.imageio.\njavax.management.\njavax.media.jai.remote.\njavax.naming.\njavax.net.\njavax.print.\njavax.script.\njavax.sound.\njavax.swing.\njavax.tools.\njavax.xml\njdk.internal.\njodd.db.connection.\njunit.\nnet.bytebuddy.dynamic.loading.\nnet.sf.cglib.\nnet.sf.ehcache.hibernate.\nnet.sf.ehcache.transaction.manager.\nognl.\noracle.jdbc.\noracle.jms.aq.\noracle.net.\norg.aoju.bus.proxy.provider.\norg.apache.activemq.ActiveMQConnectionFactory\norg.apache.activemq.ActiveMQXAConnectionFactory\norg.apache.activemq.jms.pool.\norg.apache.activemq.pool.\norg.apache.activemq.spring.\norg.apache.aries.transaction.\norg.apache.axis2.jaxws.spi.handler.\norg.apache.axis2.transport.jms.\norg.apache.bcel.\norg.apache.carbondata.core.scan.expression.\norg.apache.catalina.\norg.apache.cocoon.\norg.apache.commons.beanutils.\norg.apache.commons.codec.\norg.apache.commons.collections.comparators.\norg.apache.commons.collections.functors.\norg.apache.commons.collections.Transformer\norg.apache.commons.collections4.comparators.\norg.apache.commons.collections4.functors.\norg.apache.commons.collections4.Transformer\norg.apache.commons.configuration.\norg.apache.commons.configuration2.\norg.apache.commons.dbcp.\norg.apache.commons.fileupload.\norg.apache.commons.jelly.\norg.apache.commons.logging.\norg.apache.commons.proxy.\norg.apache.cxf.jaxrs.provider.\norg.apache.hadoop.shaded.com.zaxxer.hikari.\norg.apache.http.auth.\norg.apache.http.conn.\norg.apache.http.cookie.\norg.apache.http.impl.\norg.apache.ibatis.datasource.\norg.apache.ibatis.executor.\norg.apache.ibatis.javassist.\norg.apache.ibatis.ognl.\norg.apache.ibatis.parsing.\norg.apache.ibatis.reflection.\norg.apache.ibatis.scripting.\norg.apache.ignite.cache.\norg.apache.ignite.cache.jta.\norg.apache.log.output.db.\norg.apache.log4j.\norg.apache.logging.\norg.apache.myfaces.context.servlet.\norg.apache.myfaces.view.facelets.el.\norg.apache.openjpa.ee.\norg.apache.shiro.\norg.apache.tomcat.\norg.apache.velocity.\norg.apache.wicket.util.\norg.apache.xalan.\norg.apache.xbean.\norg.apache.xpath.\norg.apache.zookeeper.\norg.aspectj.\norg.codehaus.groovy.runtime.\norg.codehaus.jackson.\norg.datanucleus.store.rdbms.datasource.dbcp.datasources.\norg.dom4j.\norg.eclipse.jetty.\norg.geotools.filter.\norg.h2.jdbcx.\norg.h2.server.\norg.h2.value.\norg.hibernate.\norg.javasimon.\norg.jaxen.\norg.jboss.\norg.jdom.\norg.jdom2.transform.\norg.junit.\norg.logicalcobwebs.\norg.mockito.\norg.mortbay.jetty.\norg.mortbay.log.\norg.mozilla.javascript.\norg.objectweb.asm.\norg.osjava.sj.\norg.python.core.\norg.quartz.\norg.slf4j.\norg.springframework.\norg.thymeleaf.\norg.yaml.snakeyaml.tokens.\npstore.shaded.org.apache.commons.collections.\nsun.print.\nsun.rmi.server.\nsun.rmi.transport.\nweblogic.ejb20.internal.\nweblogic.jms.common."], "fixing_code": ["aj.org.objectweb.asm.\nbr.com.anteros.\nbsh.\nch.qos.logback.\nclojure.\ncom.alibaba.citrus.springext.support.parser.\ncom.alibaba.citrus.springext.util.SpringExtUtil.\ncom.alibaba.druid.pool.\ncom.alibaba.druid.stat.JdbcDataSourceStat\ncom.alibaba.fastjson.annotation.\ncom.alibaba.hotcode.internal.org.apache.commons.collections.functors.\ncom.alipay.custrelation.service.model.redress.\ncom.alipay.oceanbase.obproxy.druid.pool.\ncom.caucho.\ncom.ibatis.\ncom.ibm.jtc.jax.xml.bind.v2.runtime.unmarshaller.\ncom.ibm.xltxe.rnm1.xtq.bcel.util.\ncom.mchange.\ncom.mysql.cj.jdbc.admin.\ncom.mysql.cj.jdbc.MysqlConnectionPoolDataSource\ncom.mysql.cj.jdbc.MysqlDataSource\ncom.mysql.cj.jdbc.MysqlXADataSource\ncom.mysql.cj.log.\ncom.mysql.jdbc.util.\ncom.p6spy.engine.\ncom.rometools.rome.feed.\ncom.sun.\ncom.taobao.eagleeye.wrapper.\ncom.taobao.vipserver.commons.collections.functors.\ncom.zaxxer.hikari.\nflex.messaging.util.concurrent.\ngroovy.lang.\njava.awt.\njava.beans.\njava.io.Closeable\njava.io.Serializable\njava.lang.AutoCloseable\njava.lang.Cloneable\njava.lang.Iterable\njava.lang.ProcessBuilder\njava.lang.Readable\njava.lang.Runnable\njava.lang.Thread\njava.lang.UNIXProcess\njava.net.InetAddress\njava.net.Socket\njava.net.URL\njava.rmi.\njava.security.\njava.util.EventListener\njava.util.jar.\njava.util.logging.\njava.util.prefs.\njava.util.ServiceLoader\njava.util.StringTokenizer\njavassist.\njavax.activation.\njavax.imageio.\njavax.management.\njavax.media.jai.remote.\njavax.naming.\njavax.net.\njavax.print.\njavax.script.\njavax.sound.\njavax.swing.\njavax.tools.\njavax.xml\njdk.internal.\njodd.db.connection.\njunit.\nnet.bytebuddy.dynamic.loading.\nnet.sf.cglib.\nnet.sf.ehcache.hibernate.\nnet.sf.ehcache.transaction.manager.\nognl.\noracle.jdbc.\noracle.jms.aq.\noracle.net.\norg.aoju.bus.proxy.provider.\norg.apache.activemq.ActiveMQConnectionFactory\norg.apache.activemq.ActiveMQXAConnectionFactory\norg.apache.activemq.jms.pool.\norg.apache.activemq.pool.\norg.apache.activemq.spring.\norg.apache.aries.transaction.\norg.apache.axis2.jaxws.spi.handler.\norg.apache.axis2.transport.jms.\norg.apache.bcel.\norg.apache.carbondata.core.scan.expression.\norg.apache.catalina.\norg.apache.cocoon.\norg.apache.commons.beanutils.\norg.apache.commons.codec.\norg.apache.commons.collections.comparators.\norg.apache.commons.collections.functors.\norg.apache.commons.collections.Transformer\norg.apache.commons.collections4.comparators.\norg.apache.commons.collections4.functors.\norg.apache.commons.collections4.Transformer\norg.apache.commons.configuration.\norg.apache.commons.configuration2.\norg.apache.commons.dbcp.\norg.apache.commons.fileupload.\norg.apache.commons.jelly.\norg.apache.commons.logging.\norg.apache.commons.proxy.\norg.apache.cxf.jaxrs.provider.\norg.apache.hadoop.shaded.com.zaxxer.hikari.\norg.apache.http.auth.\norg.apache.http.conn.\norg.apache.http.cookie.\norg.apache.http.impl.\norg.apache.ibatis.datasource.\norg.apache.ibatis.executor.\norg.apache.ibatis.javassist.\norg.apache.ibatis.ognl.\norg.apache.ibatis.parsing.\norg.apache.ibatis.reflection.\norg.apache.ibatis.scripting.\norg.apache.ignite.cache.\norg.apache.ignite.cache.jta.\norg.apache.log.output.db.\norg.apache.log4j.\norg.apache.logging.\norg.apache.myfaces.context.servlet.\norg.apache.myfaces.view.facelets.el.\norg.apache.openjpa.ee.\norg.apache.shiro.\norg.apache.tomcat.\norg.apache.velocity.\norg.apache.wicket.util.\norg.apache.xalan.\norg.apache.xbean.\norg.apache.xpath.\norg.apache.zookeeper.\norg.aspectj.\norg.codehaus.groovy.runtime.\norg.codehaus.jackson.\norg.datanucleus.store.rdbms.datasource.dbcp.datasources.\norg.dom4j.\norg.eclipse.jetty.\norg.geotools.filter.\norg.h2.jdbcx.\norg.h2.server.\norg.h2.value.\norg.hibernate.\norg.javasimon.\norg.jaxen.\norg.jboss.\norg.jdom.\norg.jdom2.transform.\norg.junit.\norg.logicalcobwebs.\norg.mockito.\norg.mortbay.jetty.\norg.mortbay.log.\norg.mozilla.javascript.\norg.objectweb.asm.\norg.osjava.sj.\norg.python.core.\norg.quartz.\norg.slf4j.\norg.springframework.\norg.thymeleaf.\norg.yaml.snakeyaml.tokens.\npstore.shaded.org.apache.commons.collections.\nsun.print.\nsun.rmi.server.\nsun.rmi.transport.\nweblogic.ejb20.internal.\nweblogic.jms.common."], "filenames": ["codec/codec-api/src/main/resources/sofa-rpc/serialize_blacklist.txt"], "buggy_code_start_loc": [38], "buggy_code_end_loc": [45], "fixing_code_start_loc": [37], "fixing_code_end_loc": [42], "type": "CWE-502", "message": "SOFARPC is a Java RPC framework. SOFARPC defaults to using the SOFA Hessian protocol to deserialize received data, while the SOFA Hessian protocol uses a blacklist mechanism to restrict deserialization of potentially dangerous classes for security protection. But, prior to version 5.12.0, there is a gadget chain that can bypass the SOFA Hessian blacklist protection mechanism, and this gadget chain only relies on JDK and does not rely on any third-party components. Version 5.12.0 fixed this issue by adding a blacklist. SOFARPC also provides a way to add additional blacklists. Users can add a class like `-Drpc_serialize_blacklist_override=org.apache.xpath.` to avoid this issue.", "other": {"cve": {"id": "CVE-2024-23636", "sourceIdentifier": "security-advisories@github.com", "published": "2024-01-23T18:15:19.433", "lastModified": "2024-02-01T20:17:34.393", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "SOFARPC is a Java RPC framework. SOFARPC defaults to using the SOFA Hessian protocol to deserialize received data, while the SOFA Hessian protocol uses a blacklist mechanism to restrict deserialization of potentially dangerous classes for security protection. But, prior to version 5.12.0, there is a gadget chain that can bypass the SOFA Hessian blacklist protection mechanism, and this gadget chain only relies on JDK and does not rely on any third-party components. Version 5.12.0 fixed this issue by adding a blacklist. SOFARPC also provides a way to add additional blacklists. Users can add a class like `-Drpc_serialize_blacklist_override=org.apache.xpath.` to avoid this issue."}, {"lang": "es", "value": "SOFARPC es un framework Java RPC. SOFARPC utiliza de forma predeterminada el protocolo SOFA Hessian para deserializar los datos recibidos, mientras que el protocolo SOFA Hessian utiliza un mecanismo de lista negra para restringir la deserializaci\u00f3n de clases potencialmente peligrosas para la protecci\u00f3n de la seguridad. Pero, antes de la versi\u00f3n 5.12.0, exist\u00eda una cadena de dispositivos que pod\u00eda eludir el mecanismo de protecci\u00f3n de la lista negra de SOFA Hessian, y esta cadena de dispositivos solo se basa en JDK y no depende de ning\u00fan componente de terceros. La versi\u00f3n 5.12.0 solucion\u00f3 este problema agregando una lista negra. SOFARPC tambi\u00e9n proporciona una forma de agregar listas negras adicionales. Los usuarios pueden agregar una clase como `-Drpc_serialize_blacklist_override=org.apache.xpath.` para evitar este problema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-502"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sofastack:sofarpc:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.12.0", "matchCriteriaId": "5B157065-0631-4FFB-8A18-D8BA348F3166"}]}]}], "references": [{"url": "https://github.com/sofastack/sofa-rpc/commit/42d19b1b1d14a25aafd9ef7c219c04a19f90fc76", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/sofastack/sofa-rpc/security/advisories/GHSA-7q8p-9953-pxvr", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}]}, "github_commit_url": "https://github.com/sofastack/sofa-rpc/commit/42d19b1b1d14a25aafd9ef7c219c04a19f90fc76"}}