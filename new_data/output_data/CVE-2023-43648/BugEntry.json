{"buggy_code": ["<?php\n/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) baserCMS Users Community <https://basercms.net/community/>\n *\n * @copyright       Copyright (c) baserCMS Users Community\n * @link            https://basercms.net baserCMS Project\n * @package         Mail.Controller\n * @since           baserCMS v 0.1.0\n * @license         https://basercms.net/license/index.html\n */\n\n/**\n * \u53d7\u4fe1\u30e1\u30fc\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\n *\n * @package Mail.Controller\n */\nclass MailMessagesController extends MailAppController\n{\n\n\t/**\n\t * \u30af\u30e9\u30b9\u540d\n\t *\n\t * @var string\n\t */\n\tpublic $name = 'MailMessages';\n\n\t/**\n\t * \u30e2\u30c7\u30eb\n\t *\n\t * @var array\n\t */\n\tpublic $uses = ['Mail.MailContent', 'Mail.MailField', 'Mail.MailMessage'];\n\n\t/**\n\t * \u30d8\u30eb\u30d1\u30fc\n\t *\n\t * @var array\n\t */\n\tpublic $helpers = ['Mail.Maildata', 'Mail.Mailfield', 'BcText', 'BcArray'];\n\n\t/**\n\t * \u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\n\t *\n\t * @var array\n\t */\n\tpublic $components = ['BcAuth', 'Cookie', 'BcAuthConfigure', 'BcContents'];\n\n\t/**\n\t * \u30e1\u30fc\u30eb\u30b3\u30f3\u30c6\u30f3\u30c4\u30c7\u30fc\u30bf\n\t *\n\t * @var array\n\t */\n\tpublic $mailContent;\n\n\t/**\n\t * \u30b5\u30d6\u30e1\u30cb\u30e5\u30fc\n\t *\n\t * @var array\n\t */\n\tpublic $subMenuElements = ['mail_fields'];\n\n\t/**\n\t * beforeFilter\n\t *\n\t * @return void\n\t */\n\tpublic function beforeFilter()\n\t{\n\t\tparent::beforeFilter();\n\t\t$content = $this->BcContents->getContent($this->request->param('pass.0'));\n\t\tif (!$content) {\n\t\t\t$this->notFound();\n\t\t}\n\t\t$this->mailContent = $this->MailContent->read(null, $this->request->param('pass.0'));\n\t\tApp::uses('MailMessage', 'Mail.Model');\n\t\t$this->MailMessage = new MailMessage();\n\t\t$this->MailMessage->setup($this->mailContent['MailContent']['id']);\n\t\t$mailContentId = $this->request->param('pass.0');\n\t\t$content = $this->BcContents->getContent($mailContentId);\n\t\t$this->request->param('Content', $content['Content']);\n\t\t$this->crumbs[] = [\n\t\t\t'name' => sprintf(\n\t\t\t\t__d('baser', '%s \u7ba1\u7406'),\n\t\t\t\t$this->request->param('Content.title')\n\t\t\t),\n\t\t\t'url' => [\n\t\t\t\t'plugin' => 'mail',\n\t\t\t\t'controller' => 'mail_fields',\n\t\t\t\t'action' => 'index',\n\t\t\t\t$this->request->param('pass.0')\n\t\t\t]\n\t\t];\n\t}\n\n\t/**\n\t * beforeRender\n\t *\n\t * @return void\n\t */\n\tpublic function beforeRender()\n\t{\n\t\tparent::beforeRender();\n\t\t$this->set('mailContent', $this->mailContent);\n\t}\n\n\t/**\n\t * [ADMIN] \u53d7\u4fe1\u30e1\u30fc\u30eb\u4e00\u89a7\n\t *\n\t * @param int $mailContentId\n\t * @return void\n\t */\n\tpublic function admin_index($mailContentId)\n\t{\n\t\t$default = ['named' => ['num' => $this->siteConfigs['admin_list_num']]];\n\t\t$this->setViewConditions('MailMessage', ['default' => $default]);\n\t\t$this->paginate = [\n\t\t\t'fields' => [],\n\t\t\t'order' => 'MailMessage.created DESC',\n\t\t\t'limit' => $this->passedArgs['num']\n\t\t];\n\t\t$messages = $this->paginate('MailMessage');\n\t\t$mailFields = $this->MailMessage->mailFields;\n\n\t\t$this->set(compact('messages', 'mailFields'));\n\n\t\tif ($this->RequestHandler->isAjax() || !empty($this->request->query['ajax'])) {\n\t\t\t$this->render('ajax_index');\n\t\t\treturn;\n\t\t}\n\n\t\t$this->pageTitle = sprintf(\n\t\t\t__d('baser', '%s\uff5c\u53d7\u4fe1\u30e1\u30fc\u30eb\u4e00\u89a7'),\n\t\t\t$this->request->param('Content.title')\n\t\t);\n\t\t$this->help = 'mail_messages_index';\n\t}\n\n\t/**\n\t * [ADMIN] \u53d7\u4fe1\u30e1\u30fc\u30eb\u8a73\u7d30\n\t *\n\t * @param int $mailContentId\n\t * @param int $messageId\n\t * @return void\n\t */\n\tpublic function admin_view($mailContentId, $messageId)\n\t{\n\t\tif (!$mailContentId || !$messageId) {\n\t\t\t$this->BcMessage->setError(__d('baser', '\u7121\u52b9\u306a\u51e6\u7406\u3067\u3059\u3002'));\n\t\t\t$this->notFound();\n\t\t}\n\t\t$message = $this->MailMessage->find('first', [\n\t\t\t'conditions' => ['MailMessage.id' => $messageId],\n\t\t\t'order' => 'created DESC'\n\t\t]);\n\t\t$mailFields = $this->MailMessage->mailFields;\n\n\t\t$this->crumbs[] = [\n\t\t\t'name' => __d('baser', '\u53d7\u4fe1\u30e1\u30fc\u30eb\u4e00\u89a7'),\n\t\t\t'url' => [\n\t\t\t\t'controller' => 'mail_messages',\n\t\t\t\t'action' => 'index',\n\t\t\t\t$this->params['pass'][0]\n\t\t\t]\n\t\t];\n\t\t$this->set(compact('message', 'mailFields'));\n\t\t$this->pageTitle = sprintf(\n\t\t\t__d('baser', '%s\uff5c\u53d7\u4fe1\u30e1\u30fc\u30eb\u8a73\u7d30'),\n\t\t\t$this->request->param('Content.title')\n\t\t);\n\t}\n\n\t/**\n\t * [ADMIN] \u53d7\u4fe1\u30e1\u30fc\u30eb\u4e00\u62ec\u524a\u9664\n\t *\n\t * @param int $mailContentId\n\t * @param int $messageId\n\t * @return bool\n\t */\n\tprotected function _batch_del($ids)\n\t{\n\t\tif ($ids) {\n\t\t\tforeach($ids as $id) {\n\t\t\t\t$this->_del($id);\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\t/**\n\t * [ADMIN] \u53d7\u4fe1\u30e1\u30fc\u30eb\u524a\u9664\u3000(ajax)\n\t *\n\t * @param int $mailContentId\n\t * @param int $messageId\n\t * @return void\n\t */\n\tpublic function admin_ajax_delete($mailContentId, $messageId)\n\t{\n\t\t$this->_checkSubmitToken();\n\t\tif (!$messageId) {\n\t\t\t$this->ajaxError(500, __d('baser', '\u7121\u52b9\u306a\u51e6\u7406\u3067\u3059\u3002'));\n\t\t}\n\t\tif (!$this->_del($messageId)) {\n\t\t\texit;\n\t\t}\n\n\t\texit(true);\n\t}\n\n\t/**\n\t * \u53d7\u4fe1\u30e1\u30fc\u30eb\u524a\u9664\u3000\n\t *\n\t * @param int $mailContentId\n\t * @param int $messageId\n\t * @return bool\n\t */\n\tprotected function _del($id = null)\n\t{\n\t\tif (!$this->MailMessage->delete($id)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t$message = sprintf(__d('baser', '\u53d7\u4fe1\u30c7\u30fc\u30bf NO\u300c%s\u300d \u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002'), $id);\n\t\t$this->MailMessage->saveDbLog($message);\n\t\treturn true;\n\t}\n\n\t/**\n\t * [ADMIN] \u53d7\u4fe1\u30e1\u30fc\u30eb\u524a\u9664\n\t *\n\t * @param int $mailContentId\n\t * @param int $messageId\n\t * @return void\n\t */\n\tpublic function admin_delete($mailContentId, $messageId)\n\t{\n\t\t$this->_checkSubmitToken();\n\t\tif (!$mailContentId || !$messageId) {\n\t\t\t$this->BcMessage->setError(__d('baser', '\u7121\u52b9\u306a\u51e6\u7406\u3067\u3059\u3002'));\n\t\t\t$this->notFound();\n\t\t}\n\t\tif (!$this->MailMessage->delete($messageId)) {\n\t\t\t$this->BcMessage->setError(\n\t\t\t\t__d('baser', '\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u51e6\u7406\u4e2d\u306b\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002')\n\t\t\t);\n\t\t} else {\n\t\t\t$this->BcMessage->setSuccess(\n\t\t\t\tsprintf(\n\t\t\t\t\t__d('baser', '%s \u3078\u306e\u53d7\u4fe1\u30c7\u30fc\u30bf NO\u300c%s\u300d \u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002'),\n\t\t\t\t\t$this->mailContent['Content']['title'],\n\t\t\t\t\t$messageId\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\t$this->redirect(['action' => 'index', $mailContentId]);\n\t}\n\n\t/**\n\t * \u30e1\u30fc\u30eb\u30d5\u30a9\u30fc\u30e0\u306b\u6dfb\u4ed8\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n\t */\n\tpublic function admin_attachment()\n\t{\n\t\t$args = func_get_args();\n\t\tunset($args[0]);\n\t\t$file = implode('/', $args);\n\t\t$settings = $this->MailMessage->Behaviors->BcUpload->BcFileUploader['MailMessage']->settings;\n\t\t$filePath = WWW_ROOT . 'files' . DS . $settings['saveDir'] . DS . $file;\n\t\t$ext = decodeContent(null, $file);\n\t\t$mineType = 'application/octet-stream';\n\t\tif ($ext !== 'gif' && $ext !== 'jpg' && $ext !== 'png') {\n\t\t\tHeader(\"Content-disposition: attachment; filename=\" . $file);\n\t\t} else {\n\t\t\t$mineType = 'image/' . $ext;\n\t\t}\n\t\tHeader(sprintf('Content-type: %s; name=%s', $mineType, $file));\n\t\techo file_get_contents($filePath);\n\t\texit();\n\t}\n\n}\n"], "fixing_code": ["<?php\n/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) baserCMS Users Community <https://basercms.net/community/>\n *\n * @copyright       Copyright (c) baserCMS Users Community\n * @link            https://basercms.net baserCMS Project\n * @package         Mail.Controller\n * @since           baserCMS v 0.1.0\n * @license         https://basercms.net/license/index.html\n */\n\n/**\n * \u53d7\u4fe1\u30e1\u30fc\u30eb\u30b3\u30f3\u30c8\u30ed\u30fc\u30e9\u30fc\n *\n * @package Mail.Controller\n */\nclass MailMessagesController extends MailAppController\n{\n\n\t/**\n\t * \u30af\u30e9\u30b9\u540d\n\t *\n\t * @var string\n\t */\n\tpublic $name = 'MailMessages';\n\n\t/**\n\t * \u30e2\u30c7\u30eb\n\t *\n\t * @var array\n\t */\n\tpublic $uses = ['Mail.MailContent', 'Mail.MailField', 'Mail.MailMessage'];\n\n\t/**\n\t * \u30d8\u30eb\u30d1\u30fc\n\t *\n\t * @var array\n\t */\n\tpublic $helpers = ['Mail.Maildata', 'Mail.Mailfield', 'BcText', 'BcArray'];\n\n\t/**\n\t * \u30b3\u30f3\u30dd\u30fc\u30cd\u30f3\u30c8\n\t *\n\t * @var array\n\t */\n\tpublic $components = ['BcAuth', 'Cookie', 'BcAuthConfigure', 'BcContents'];\n\n\t/**\n\t * \u30e1\u30fc\u30eb\u30b3\u30f3\u30c6\u30f3\u30c4\u30c7\u30fc\u30bf\n\t *\n\t * @var array\n\t */\n\tpublic $mailContent;\n\n\t/**\n\t * \u30b5\u30d6\u30e1\u30cb\u30e5\u30fc\n\t *\n\t * @var array\n\t */\n\tpublic $subMenuElements = ['mail_fields'];\n\n\t/**\n\t * beforeFilter\n\t *\n\t * @return void\n\t */\n\tpublic function beforeFilter()\n\t{\n\t\tparent::beforeFilter();\n\t\t$content = $this->BcContents->getContent($this->request->param('pass.0'));\n\t\tif (!$content) {\n\t\t\t$this->notFound();\n\t\t}\n\t\t$this->mailContent = $this->MailContent->read(null, $this->request->param('pass.0'));\n\t\tApp::uses('MailMessage', 'Mail.Model');\n\t\t$this->MailMessage = new MailMessage();\n\t\t$this->MailMessage->setup($this->mailContent['MailContent']['id']);\n\t\t$mailContentId = $this->request->param('pass.0');\n\t\t$content = $this->BcContents->getContent($mailContentId);\n\t\t$this->request->param('Content', $content['Content']);\n\t\t$this->crumbs[] = [\n\t\t\t'name' => sprintf(\n\t\t\t\t__d('baser', '%s \u7ba1\u7406'),\n\t\t\t\t$this->request->param('Content.title')\n\t\t\t),\n\t\t\t'url' => [\n\t\t\t\t'plugin' => 'mail',\n\t\t\t\t'controller' => 'mail_fields',\n\t\t\t\t'action' => 'index',\n\t\t\t\t$this->request->param('pass.0')\n\t\t\t]\n\t\t];\n\t}\n\n\t/**\n\t * beforeRender\n\t *\n\t * @return void\n\t */\n\tpublic function beforeRender()\n\t{\n\t\tparent::beforeRender();\n\t\t$this->set('mailContent', $this->mailContent);\n\t}\n\n\t/**\n\t * [ADMIN] \u53d7\u4fe1\u30e1\u30fc\u30eb\u4e00\u89a7\n\t *\n\t * @param int $mailContentId\n\t * @return void\n\t */\n\tpublic function admin_index($mailContentId)\n\t{\n\t\t$default = ['named' => ['num' => $this->siteConfigs['admin_list_num']]];\n\t\t$this->setViewConditions('MailMessage', ['default' => $default]);\n\t\t$this->paginate = [\n\t\t\t'fields' => [],\n\t\t\t'order' => 'MailMessage.created DESC',\n\t\t\t'limit' => $this->passedArgs['num']\n\t\t];\n\t\t$messages = $this->paginate('MailMessage');\n\t\t$mailFields = $this->MailMessage->mailFields;\n\n\t\t$this->set(compact('messages', 'mailFields'));\n\n\t\tif ($this->RequestHandler->isAjax() || !empty($this->request->query['ajax'])) {\n\t\t\t$this->render('ajax_index');\n\t\t\treturn;\n\t\t}\n\n\t\t$this->pageTitle = sprintf(\n\t\t\t__d('baser', '%s\uff5c\u53d7\u4fe1\u30e1\u30fc\u30eb\u4e00\u89a7'),\n\t\t\t$this->request->param('Content.title')\n\t\t);\n\t\t$this->help = 'mail_messages_index';\n\t}\n\n\t/**\n\t * [ADMIN] \u53d7\u4fe1\u30e1\u30fc\u30eb\u8a73\u7d30\n\t *\n\t * @param int $mailContentId\n\t * @param int $messageId\n\t * @return void\n\t */\n\tpublic function admin_view($mailContentId, $messageId)\n\t{\n\t\tif (!$mailContentId || !$messageId) {\n\t\t\t$this->BcMessage->setError(__d('baser', '\u7121\u52b9\u306a\u51e6\u7406\u3067\u3059\u3002'));\n\t\t\t$this->notFound();\n\t\t}\n\t\t$message = $this->MailMessage->find('first', [\n\t\t\t'conditions' => ['MailMessage.id' => $messageId],\n\t\t\t'order' => 'created DESC'\n\t\t]);\n\t\t$mailFields = $this->MailMessage->mailFields;\n\n\t\t$this->crumbs[] = [\n\t\t\t'name' => __d('baser', '\u53d7\u4fe1\u30e1\u30fc\u30eb\u4e00\u89a7'),\n\t\t\t'url' => [\n\t\t\t\t'controller' => 'mail_messages',\n\t\t\t\t'action' => 'index',\n\t\t\t\t$this->params['pass'][0]\n\t\t\t]\n\t\t];\n\t\t$this->set(compact('message', 'mailFields'));\n\t\t$this->pageTitle = sprintf(\n\t\t\t__d('baser', '%s\uff5c\u53d7\u4fe1\u30e1\u30fc\u30eb\u8a73\u7d30'),\n\t\t\t$this->request->param('Content.title')\n\t\t);\n\t}\n\n\t/**\n\t * [ADMIN] \u53d7\u4fe1\u30e1\u30fc\u30eb\u4e00\u62ec\u524a\u9664\n\t *\n\t * @param int $mailContentId\n\t * @param int $messageId\n\t * @return bool\n\t */\n\tprotected function _batch_del($ids)\n\t{\n\t\tif ($ids) {\n\t\t\tforeach($ids as $id) {\n\t\t\t\t$this->_del($id);\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\t/**\n\t * [ADMIN] \u53d7\u4fe1\u30e1\u30fc\u30eb\u524a\u9664\u3000(ajax)\n\t *\n\t * @param int $mailContentId\n\t * @param int $messageId\n\t * @return void\n\t */\n\tpublic function admin_ajax_delete($mailContentId, $messageId)\n\t{\n\t\t$this->_checkSubmitToken();\n\t\tif (!$messageId) {\n\t\t\t$this->ajaxError(500, __d('baser', '\u7121\u52b9\u306a\u51e6\u7406\u3067\u3059\u3002'));\n\t\t}\n\t\tif (!$this->_del($messageId)) {\n\t\t\texit;\n\t\t}\n\n\t\texit(true);\n\t}\n\n\t/**\n\t * \u53d7\u4fe1\u30e1\u30fc\u30eb\u524a\u9664\u3000\n\t *\n\t * @param int $mailContentId\n\t * @param int $messageId\n\t * @return bool\n\t */\n\tprotected function _del($id = null)\n\t{\n\t\tif (!$this->MailMessage->delete($id)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t$message = sprintf(__d('baser', '\u53d7\u4fe1\u30c7\u30fc\u30bf NO\u300c%s\u300d \u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002'), $id);\n\t\t$this->MailMessage->saveDbLog($message);\n\t\treturn true;\n\t}\n\n\t/**\n\t * [ADMIN] \u53d7\u4fe1\u30e1\u30fc\u30eb\u524a\u9664\n\t *\n\t * @param int $mailContentId\n\t * @param int $messageId\n\t * @return void\n\t */\n\tpublic function admin_delete($mailContentId, $messageId)\n\t{\n\t\t$this->_checkSubmitToken();\n\t\tif (!$mailContentId || !$messageId) {\n\t\t\t$this->BcMessage->setError(__d('baser', '\u7121\u52b9\u306a\u51e6\u7406\u3067\u3059\u3002'));\n\t\t\t$this->notFound();\n\t\t}\n\t\tif (!$this->MailMessage->delete($messageId)) {\n\t\t\t$this->BcMessage->setError(\n\t\t\t\t__d('baser', '\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u51e6\u7406\u4e2d\u306b\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002')\n\t\t\t);\n\t\t} else {\n\t\t\t$this->BcMessage->setSuccess(\n\t\t\t\tsprintf(\n\t\t\t\t\t__d('baser', '%s \u3078\u306e\u53d7\u4fe1\u30c7\u30fc\u30bf NO\u300c%s\u300d \u3092\u524a\u9664\u3057\u307e\u3057\u305f\u3002'),\n\t\t\t\t\t$this->mailContent['Content']['title'],\n\t\t\t\t\t$messageId\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\t$this->redirect(['action' => 'index', $mailContentId]);\n\t}\n\n\t/**\n\t * \u30e1\u30fc\u30eb\u30d5\u30a9\u30fc\u30e0\u306b\u6dfb\u4ed8\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u304f\n\t */\n\tpublic function admin_attachment()\n\t{\n\t\t$args = func_get_args();\n\t\tunset($args[0]);\n\t\t$file = implode('/', $args);\n\t\t$settings = $this->MailMessage->Behaviors->BcUpload->BcFileUploader['MailMessage']->settings;\n\t\t$basePath = realpath(WWW_ROOT . 'files' . DS . $settings['saveDir']);\n\t\t$filePath = realpath($basePath . DS . $file);\n\n\t\t// basePath\u914d\u4e0b\u51fa\u306a\u3044\u5834\u5408\u306f\u8868\u793a\u3057\u306a\u3044\n\t\tif (strpos($filePath, $basePath) !== 0) {\n\t\t\t$this->notFound();\n\t\t}\n\n\t\t$ext = decodeContent(null, $file);\n\t\t$mineType = 'application/octet-stream';\n\t\tif ($ext !== 'gif' && $ext !== 'jpg' && $ext !== 'png') {\n\t\t\tHeader(\"Content-disposition: attachment; filename=\" . $file);\n\t\t} else {\n\t\t\t$mineType = 'image/' . $ext;\n\t\t}\n\t\tHeader(sprintf('Content-type: %s; name=%s', $mineType, $file));\n\t\techo file_get_contents($filePath);\n\t\texit();\n\t}\n\n}\n"], "filenames": ["lib/Baser/Plugin/Mail/Controller/MailMessagesController.php"], "buggy_code_start_loc": [267], "buggy_code_end_loc": [268], "fixing_code_start_loc": [267], "fixing_code_end_loc": [275], "type": "CWE-22", "message": "baserCMS is a website development framework. Prior to version 4.8.0, there is a Directory Traversal Vulnerability in the form submission data management feature of baserCMS. Version 4.8.0 contains a patch for this issue.", "other": {"cve": {"id": "CVE-2023-43648", "sourceIdentifier": "security-advisories@github.com", "published": "2023-10-30T19:15:08.183", "lastModified": "2023-11-06T19:39:02.777", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "baserCMS is a website development framework. Prior to version 4.8.0, there is a Directory Traversal Vulnerability in the form submission data management feature of baserCMS. Version 4.8.0 contains a patch for this issue."}, {"lang": "es", "value": "baserCMS es un framework de desarrollo de sitios web. Antes de la versi\u00f3n 4.8.0, hab\u00eda una vulnerabilidad de Directory Traversal en la funci\u00f3n de administraci\u00f3n de datos de env\u00edo de formularios de baserCMS. La versi\u00f3n 4.8.0 contiene un parche para este problema."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.9, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.2, "impactScore": 3.6}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:basercms:basercms:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.8.0", "matchCriteriaId": "3B92C5C4-A119-435E-95BF-F6595C49737C"}]}]}], "references": [{"url": "https://basercms.net/security/JVN_81174674", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/baserproject/basercms/commit/7555a5cf0006755dc0223fffc2d882b50a97758b", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/baserproject/basercms/security/advisories/GHSA-hmqj-gv2m-hq55", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/baserproject/basercms/commit/7555a5cf0006755dc0223fffc2d882b50a97758b"}}