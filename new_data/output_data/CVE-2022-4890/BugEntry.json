{"buggy_code": ["# Be sure to restart your server when you modify this file.\n#\n# This file eases your Rails 7.0 framework defaults upgrade.\n#\n# Uncomment each configuration one by one to switch to the new default.\n# Once your application is ready to run with all new defaults, you can remove\n# this file and set the `config.load_defaults` to `7.0`.\n#\n# Read the Guide for Upgrading Ruby on Rails for more info on each option.\n# https://guides.rubyonrails.org/upgrading_ruby_on_rails.html\n\n# `button_to` view helper will render `<button>` element, regardless of whether\n# or not the content is passed as the first argument or as a block.\n# Rails.application.config.action_view.button_to_generates_button_tag = true\n\n# `stylesheet_link_tag` view helper will not render the media attribute by default.\n# Rails.application.config.action_view.apply_stylesheet_media_default = false\n\n# Change the digest class for the key generators to `OpenSSL::Digest::SHA256`.\n# Changing this default means invalidate all encrypted messages generated by\n# your application and, all the encrypted cookies. Only change this after you\n# rotated all the messages using the key rotator.\n#\n# See upgrading guide for more information on how to build a rotator.\n# https://guides.rubyonrails.org/v7.0/upgrading_ruby_on_rails.html\n# Rails.application.config.active_support.key_generator_hash_digest_class = OpenSSL::Digest::SHA256\n\n# Change the digest class for ActiveSupport::Digest.\n# Changing this default means that for example Etags change and\n# various cache keys leading to cache invalidation.\n# Rails.application.config.active_support.hash_digest_class = OpenSSL::Digest::SHA256\n\n# Don't override ActiveSupport::TimeWithZone.name and use the default Ruby\n# implementation.\n# Rails.application.config.active_support.remove_deprecated_time_with_zone_name = true\n\n# Change the format of the cache entry.\n# Changing this default means that all new cache entries added to the cache\n# will have a different format that is not supported by Rails 6.1 applications.\n# Only change this value after your application is fully deployed to Rails 7.0\n# and you have no plans to rollback.\n# Rails.application.config.active_support.cache_format_version = 7.0\n\n# Calls `Rails.application.executor.wrap` around test cases.\n# This makes test cases behave closer to an actual request or job.\n# Several features that are normally disabled in test, such as Active Record query cache\n# and asynchronous queries will then be enabled.\n# Rails.application.config.active_support.executor_around_test_case = true\n\n# Define the isolation level of most of Rails internal state.\n# If you use a fiber based server or job processor, you should set it to `:fiber`.\n# Otherwise the default of `:thread` if preferable.\n# Rails.application.config.active_support.isolation_level = :thread\n\n# Set both the `:open_timeout` and `:read_timeout` values for `:smtp` delivery method.\n# Rails.application.config.action_mailer.smtp_timeout = 5\n\n# The ActiveStorage video previewer will now use scene change detection to generate\n# better preview images (rather than the previous default of using the first frame\n# of the video).\n# Rails.application.config.active_storage.video_preview_arguments =\n#   \"-vf 'select=eq(n\\\\,0)+eq(key\\\\,1)+gt(scene\\\\,0.015),loop=loop=-1:size=2,trim=start_frame=1' -frames:v 1 -f image2\"\n\n# Automatically infer `inverse_of` for associations with a scope.\n# Rails.application.config.active_record.automatic_scope_inversing = true\n\n# Raise when running tests if fixtures contained foreign key violations\n# Rails.application.config.active_record.verify_foreign_keys_for_fixtures = true\n\n# Disable partial inserts.\n# This default means that all columns will be referenced in INSERT queries\n# regardless of whether they have a default or not.\n# Rails.application.config.active_record.partial_inserts = false\n#\n# Protect from open redirect attacks in `redirect_back_or_to` and `redirect_to`.\n# Rails.application.config.action_controller.raise_on_open_redirects = true\n\n# Change the variant processor for Active Storage.\n# Changing this default means updating all places in your code that\n# generate variants to use image processing macros and ruby-vips\n# operations. See the upgrading guide for detail on the changes required.\n# The `:mini_magick` option is not deprecated; it's fine to keep using it.\n# Rails.application.config.active_storage.variant_processor = :vips\n\n# If you're upgrading and haven't set `cookies_serializer` previously, your cookie serializer\n# was `:marshal`. Convert all cookies to JSON, using the `:hybrid` formatter.\n#\n# If you're confident all your cookies are JSON formatted, you can switch to the `:json` formatter.\n#\n# Continue to use `:marshal` for backward-compatibility with old cookies.\n#\n# If you have configured the serializer elsewhere, you can remove this.\n#\n# See https://guides.rubyonrails.org/action_controller_overview.html#cookies for more information.\nRails.application.config.action_dispatch.cookies_serializer = :hybrid\n\n# Enable parameter wrapping for JSON.\n# Previously this was set in an initializer. It's fine to keep using that initializer if you've customized it.\n# To disable parameter wrapping entirely, set this config to `false`.\n# Rails.application.config.action_controller.wrap_parameters_by_default = true\n\n# Specifies whether generated namespaced UUIDs follow the RFC 4122 standard for namespace IDs provided as a\n# `String` to `Digest::UUID.uuid_v3` or `Digest::UUID.uuid_v5` method calls.\n#\n# See https://guides.rubyonrails.org/configuring.html#config-active-support-use-rfc4122-namespaced-uuids for\n# more information.\n# Rails.application.config.active_support.use_rfc4122_namespaced_uuids = true\n\n# Change the default headers to disable browsers' flawed legacy XSS protection.\n# Rails.application.config.action_dispatch.default_headers = {\n#   \"X-Frame-Options\" => \"SAMEORIGIN\",\n#   \"X-XSS-Protection\" => \"0\",\n#   \"X-Content-Type-Options\" => \"nosniff\",\n#   \"X-Download-Options\" => \"noopen\",\n#   \"X-Permitted-Cross-Domain-Policies\" => \"none\",\n#   \"Referrer-Policy\" => \"strict-origin-when-cross-origin\"\n# }\n"], "fixing_code": ["# Be sure to restart your server when you modify this file.\n#\n# This file eases your Rails 7.0 framework defaults upgrade.\n#\n# Uncomment each configuration one by one to switch to the new default.\n# Once your application is ready to run with all new defaults, you can remove\n# this file and set the `config.load_defaults` to `7.0`.\n#\n# Read the Guide for Upgrading Ruby on Rails for more info on each option.\n# https://guides.rubyonrails.org/upgrading_ruby_on_rails.html\n\n# `button_to` view helper will render `<button>` element, regardless of whether\n# or not the content is passed as the first argument or as a block.\n# Rails.application.config.action_view.button_to_generates_button_tag = true\n\n# `stylesheet_link_tag` view helper will not render the media attribute by default.\n# Rails.application.config.action_view.apply_stylesheet_media_default = false\n\n# Change the digest class for the key generators to `OpenSSL::Digest::SHA256`.\n# Changing this default means invalidate all encrypted messages generated by\n# your application and, all the encrypted cookies. Only change this after you\n# rotated all the messages using the key rotator.\n#\n# See upgrading guide for more information on how to build a rotator.\n# https://guides.rubyonrails.org/v7.0/upgrading_ruby_on_rails.html\n# Rails.application.config.active_support.key_generator_hash_digest_class = OpenSSL::Digest::SHA256\n\n# Change the digest class for ActiveSupport::Digest.\n# Changing this default means that for example Etags change and\n# various cache keys leading to cache invalidation.\n# Rails.application.config.active_support.hash_digest_class = OpenSSL::Digest::SHA256\n\n# Don't override ActiveSupport::TimeWithZone.name and use the default Ruby\n# implementation.\n# Rails.application.config.active_support.remove_deprecated_time_with_zone_name = true\n\n# Change the format of the cache entry.\n# Changing this default means that all new cache entries added to the cache\n# will have a different format that is not supported by Rails 6.1 applications.\n# Only change this value after your application is fully deployed to Rails 7.0\n# and you have no plans to rollback.\n# Rails.application.config.active_support.cache_format_version = 7.0\n\n# Calls `Rails.application.executor.wrap` around test cases.\n# This makes test cases behave closer to an actual request or job.\n# Several features that are normally disabled in test, such as Active Record query cache\n# and asynchronous queries will then be enabled.\n# Rails.application.config.active_support.executor_around_test_case = true\n\n# Define the isolation level of most of Rails internal state.\n# If you use a fiber based server or job processor, you should set it to `:fiber`.\n# Otherwise the default of `:thread` if preferable.\n# Rails.application.config.active_support.isolation_level = :thread\n\n# Set both the `:open_timeout` and `:read_timeout` values for `:smtp` delivery method.\n# Rails.application.config.action_mailer.smtp_timeout = 5\n\n# The ActiveStorage video previewer will now use scene change detection to generate\n# better preview images (rather than the previous default of using the first frame\n# of the video).\n# Rails.application.config.active_storage.video_preview_arguments =\n#   \"-vf 'select=eq(n\\\\,0)+eq(key\\\\,1)+gt(scene\\\\,0.015),loop=loop=-1:size=2,trim=start_frame=1' -frames:v 1 -f image2\"\n\n# Automatically infer `inverse_of` for associations with a scope.\n# Rails.application.config.active_record.automatic_scope_inversing = true\n\n# Raise when running tests if fixtures contained foreign key violations\n# Rails.application.config.active_record.verify_foreign_keys_for_fixtures = true\n\n# Disable partial inserts.\n# This default means that all columns will be referenced in INSERT queries\n# regardless of whether they have a default or not.\n# Rails.application.config.active_record.partial_inserts = false\n#\n# Protect from open redirect attacks in `redirect_back_or_to` and `redirect_to`.\n# Rails.application.config.action_controller.raise_on_open_redirects = true\n\n# Change the variant processor for Active Storage.\n# Changing this default means updating all places in your code that\n# generate variants to use image processing macros and ruby-vips\n# operations. See the upgrading guide for detail on the changes required.\n# The `:mini_magick` option is not deprecated; it's fine to keep using it.\n# Rails.application.config.active_storage.variant_processor = :vips\n\n# If you're upgrading and haven't set `cookies_serializer` previously, your cookie serializer\n# was `:marshal`. Convert all cookies to JSON, using the `:hybrid` formatter.\n#\n# If you're confident all your cookies are JSON formatted, you can switch to the `:json` formatter.\n#\n# Continue to use `:marshal` for backward-compatibility with old cookies.\n#\n# If you have configured the serializer elsewhere, you can remove this.\n#\n# See https://guides.rubyonrails.org/action_controller_overview.html#cookies for more information.\nRails.application.config.action_dispatch.cookies_serializer = :json\n\n# Enable parameter wrapping for JSON.\n# Previously this was set in an initializer. It's fine to keep using that initializer if you've customized it.\n# To disable parameter wrapping entirely, set this config to `false`.\n# Rails.application.config.action_controller.wrap_parameters_by_default = true\n\n# Specifies whether generated namespaced UUIDs follow the RFC 4122 standard for namespace IDs provided as a\n# `String` to `Digest::UUID.uuid_v3` or `Digest::UUID.uuid_v5` method calls.\n#\n# See https://guides.rubyonrails.org/configuring.html#config-active-support-use-rfc4122-namespaced-uuids for\n# more information.\n# Rails.application.config.active_support.use_rfc4122_namespaced_uuids = true\n\n# Change the default headers to disable browsers' flawed legacy XSS protection.\n# Rails.application.config.action_dispatch.default_headers = {\n#   \"X-Frame-Options\" => \"SAMEORIGIN\",\n#   \"X-XSS-Protection\" => \"0\",\n#   \"X-Content-Type-Options\" => \"nosniff\",\n#   \"X-Download-Options\" => \"noopen\",\n#   \"X-Permitted-Cross-Domain-Policies\" => \"none\",\n#   \"Referrer-Policy\" => \"strict-origin-when-cross-origin\"\n# }\n"], "filenames": ["config/initializers/new_framework_defaults_7_0.rb"], "buggy_code_start_loc": [95], "buggy_code_end_loc": [96], "fixing_code_start_loc": [95], "fixing_code_end_loc": [96], "type": "CWE-502", "message": "A vulnerability, which was classified as critical, has been found in abhilash1985 PredictApp. This issue affects some unknown processing of the file config/initializers/new_framework_defaults_7_0.rb of the component Cookie Handler. The manipulation leads to deserialization. The attack may be initiated remotely. The name of the patch is b067372f3ee26fe1b657121f0f41883ff4461a06. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-218387.", "other": {"cve": {"id": "CVE-2022-4890", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-16T13:15:10.137", "lastModified": "2023-01-24T16:19:48.380", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability, which was classified as critical, has been found in abhilash1985 PredictApp. This issue affects some unknown processing of the file config/initializers/new_framework_defaults_7_0.rb of the component Cookie Handler. The manipulation leads to deserialization. The attack may be initiated remotely. The name of the patch is b067372f3ee26fe1b657121f0f41883ff4461a06. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-218387."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-502"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:predictapp_project:predictapp:*:*:*:*:*:*:*:*", "versionEndExcluding": "2022-03-20", "matchCriteriaId": "B2D869E2-CF91-454B-845E-221EF4F92CF1"}]}]}], "references": [{"url": "https://github.com/abhilash1985/PredictApp/commit/b067372f3ee26fe1b657121f0f41883ff4461a06", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/abhilash1985/PredictApp/pull/73", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.218387", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.218387", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/abhilash1985/PredictApp/commit/b067372f3ee26fe1b657121f0f41883ff4461a06"}}