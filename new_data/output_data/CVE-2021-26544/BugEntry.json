{"buggy_code": ["/*\n * Licensed to the Apache Software Foundation (ASF) under one or more\n * contributor license agreements.  See the NOTICE file distributed with\n * this work for additional information regarding copyright ownership.\n * The ASF licenses this file to You under the Apache License, Version 2.0\n * (the \"License\"); you may not use this file except in compliance with\n * the License.  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nfunction loadSessionsTable(sessions) {\n  $.each(sessions, function(index, session) {\n    $(\"#interactive-sessions .sessions-table-body\").append(\n      \"<tr>\" +\n        tdWrap(uiLink(\"session/\" + session.id, session.id)) +\n        tdWrap(appIdLink(session)) +\n        tdWrap(session.name) +\n        tdWrap(session.owner) +\n        tdWrap(session.proxyUser) +\n        tdWrap(session.kind) +\n        tdWrap(session.state) +\n        tdWrap(logLinks(session, \"session\")) +\n        \"</tr>\"\n    );\n  });\n}\n\nfunction loadBatchesTable(sessions) {\n  $.each(sessions, function(index, session) {\n    $(\"#batches .sessions-table-body\").append(\n      \"<tr>\" +\n        tdWrap(session.id) +\n        tdWrap(appIdLink(session)) +\n        tdWrap(session.name) +\n        tdWrap(session.owner) +\n        tdWrap(session.proxyUser) +\n        tdWrap(session.state) +\n        tdWrap(logLinks(session, \"batch\")) +\n        \"</tr>\"\n    );\n  });\n}\n\nvar numSessions = 0;\nvar numBatches = 0;\n\n$(document).ready(function () {\n  var sessionsReq = $.getJSON(location.origin + prependBasePath(\"/sessions\"), function(response) {\n    if (response && response.total > 0) {\n      $(\"#interactive-sessions\").load(prependBasePath(\"/static/html/sessions-table.html .sessions-template\"), function() {\n        loadSessionsTable(response.sessions);\n        $(\"#interactive-sessions-table\").DataTable();\n        $('#interactive-sessions [data-toggle=\"tooltip\"]').tooltip();\n      });\n    }\n    numSessions = response.total;\n  });\n\n  var batchesReq = $.getJSON(location.origin + prependBasePath(\"/batches\"), function(response) {\n    if (response && response.total > 0) {\n      $(\"#batches\").load(prependBasePath(\"/static/html/batches-table.html .sessions-template\"), function() {\n        loadBatchesTable(response.sessions);\n        $(\"#batches-table\").DataTable();\n        $('#batches [data-toggle=\"tooltip\"]').tooltip();\n      });\n    }\n    numBatches = response.total;\n  });\n\n  $.when(sessionsReq, batchesReq).done(function () {\n    if (numSessions + numBatches == 0) {\n      $(\"#all-sessions\").append('<h4>No Sessions or Batches have been created yet.</h4>');\n    }\n  });\n});"], "fixing_code": ["/*\n * Licensed to the Apache Software Foundation (ASF) under one or more\n * contributor license agreements.  See the NOTICE file distributed with\n * this work for additional information regarding copyright ownership.\n * The ASF licenses this file to You under the Apache License, Version 2.0\n * (the \"License\"); you may not use this file except in compliance with\n * the License.  You may obtain a copy of the License at\n *\n *    http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nfunction escapeHtml(unescapedText) {\n  return $(\"<div>\").text(unescapedText).html()\n}\n\nfunction loadSessionsTable(sessions) {\n  $.each(sessions, function(index, session) {\n    $(\"#interactive-sessions .sessions-table-body\").append(\n      \"<tr>\" +\n        tdWrap(uiLink(\"session/\" + session.id, session.id)) +\n        tdWrap(appIdLink(session)) +\n        tdWrap(escapeHtml(session.name)) +\n        tdWrap(session.owner) +\n        tdWrap(session.proxyUser) +\n        tdWrap(session.kind) +\n        tdWrap(session.state) +\n        tdWrap(logLinks(session, \"session\")) +\n        \"</tr>\"\n    );\n  });\n}\n\nfunction loadBatchesTable(sessions) {\n  $.each(sessions, function(index, session) {\n    $(\"#batches .sessions-table-body\").append(\n      \"<tr>\" +\n        tdWrap(session.id) +\n        tdWrap(appIdLink(session)) +\n        tdWrap(escapeHtml(session.name)) +\n        tdWrap(session.owner) +\n        tdWrap(session.proxyUser) +\n        tdWrap(session.state) +\n        tdWrap(logLinks(session, \"batch\")) +\n        \"</tr>\"\n    );\n  });\n}\n\nvar numSessions = 0;\nvar numBatches = 0;\n\n$(document).ready(function () {\n  var sessionsReq = $.getJSON(location.origin + prependBasePath(\"/sessions\"), function(response) {\n    if (response && response.total > 0) {\n      $(\"#interactive-sessions\").load(prependBasePath(\"/static/html/sessions-table.html .sessions-template\"), function() {\n        loadSessionsTable(response.sessions);\n        $(\"#interactive-sessions-table\").DataTable();\n        $('#interactive-sessions [data-toggle=\"tooltip\"]').tooltip();\n      });\n    }\n    numSessions = response.total;\n  });\n\n  var batchesReq = $.getJSON(location.origin + prependBasePath(\"/batches\"), function(response) {\n    if (response && response.total > 0) {\n      $(\"#batches\").load(prependBasePath(\"/static/html/batches-table.html .sessions-template\"), function() {\n        loadBatchesTable(response.sessions);\n        $(\"#batches-table\").DataTable();\n        $('#batches [data-toggle=\"tooltip\"]').tooltip();\n      });\n    }\n    numBatches = response.total;\n  });\n\n  $.when(sessionsReq, batchesReq).done(function () {\n    if (numSessions + numBatches == 0) {\n      $(\"#all-sessions\").append('<h4>No Sessions or Batches have been created yet.</h4>');\n    }\n  });\n});\n"], "filenames": ["server/src/main/resources/org/apache/livy/server/ui/static/js/all-sessions.js"], "buggy_code_start_loc": [17], "buggy_code_end_loc": [83], "fixing_code_start_loc": [18], "fixing_code_end_loc": [87], "type": "CWE-79", "message": "Livy server version 0.7.0-incubating (only) is vulnerable to a cross site scripting issue in the session name. A malicious user could use this flaw to access logs and results of other users' sessions and run jobs with their privileges. This issue is fixed in Livy 0.7.1-incubating.", "other": {"cve": {"id": "CVE-2021-26544", "sourceIdentifier": "security@apache.org", "published": "2021-02-20T09:15:12.377", "lastModified": "2021-02-26T14:18:56.573", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Livy server version 0.7.0-incubating (only) is vulnerable to a cross site scripting issue in the session name. A malicious user could use this flaw to access logs and results of other users' sessions and run jobs with their privileges. This issue is fixed in Livy 0.7.1-incubating."}, {"lang": "es", "value": "Livy Server versi\u00f3n 0.7.0-incubating (solamente) es vulnerable a un problema de tipo cross site scripting en el nombre de la sesi\u00f3n.&#xa0;Un usuario malicioso podr\u00eda usar este fallo para acceder a los registros y resultados de las sesiones de otros usuarios y ejecutar trabajos con sus privilegios.&#xa0;Este problema es corregido en Livy versi\u00f3n 0.7.1-incubating"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security@apache.org", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apache:livy:0.7.0-incubating:*:*:*:*:*:*:*", "matchCriteriaId": "0153E9AC-2495-40AD-8ECF-C242E8416CED"}]}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2021/02/20/1", "source": "security@apache.org", "tags": ["Mailing List", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/apache/incubator-livy/commit/4d8a912699683b973eee76d4e91447d769a0cb0d", "source": "security@apache.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://lists.apache.org/thread.html/r2db14e7fd1e5ec2519e8828d43529bad623d75698cc7918af3a3f3ed%40%3Cuser.livy.apache.org%3E", "source": "security@apache.org", "tags": ["Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/apache/incubator-livy/commit/4d8a912699683b973eee76d4e91447d769a0cb0d"}}