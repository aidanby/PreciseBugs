{"buggy_code": ["<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\">\n  <modelVersion>4.0.0</modelVersion>\n  <parent>\n    <groupId>org.xwiki.platform</groupId>\n    <artifactId>xwiki-platform-flamingo-theme</artifactId>\n    <version>14.10-SNAPSHOT</version>\n  </parent>\n  <artifactId>xwiki-platform-flamingo-theme-ui</artifactId>\n  <packaging>xar</packaging>\n  <name>XWiki Platform - Flamingo - Theme - UI</name>\n  <description>Visually customize any Flamingo-based skin and preview the results live + Default Themes</description>\n  <properties>\n    <!-- Name to display by the Extension Manager -->\n    <xwiki.extension.name>Flamingo Theme Application</xwiki.extension.name>\n    <!-- Old names of this module used for retro compatibility when resolving dependencies of old extensions -->\n    <xwiki.extension.features>org.xwiki.platform:xwiki-platform-flamingo-theme</xwiki.extension.features>\n  </properties>\n  <dependencies>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-icon-script</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-webjars-api</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.webjars</groupId>\n      <artifactId>requirejs</artifactId>\n    </dependency>\n    <dependency>\n      <groupId>org.webjars</groupId>\n      <artifactId>jquery</artifactId>\n    </dependency>\n    <dependency>\n      <groupId>org.webjars.npm</groupId>\n      <artifactId>less</artifactId>\n      <version>4.1.2</version>\n      <scope>runtime</scope>\n      <!-- Exclude transitive dependencies because they are needed only for developing less.js .\n        See my comment on https://github.com/webjars/less/issues/19#issuecomment-1040328541 -->\n      <exclusions>\n        <exclusion>\n          <groupId>*</groupId>\n          <artifactId>*</artifactId>\n        </exclusion>\n      </exclusions>\n    </dependency>\n    <dependency>\n      <groupId>org.webjars</groupId>\n      <artifactId>colpick</artifactId>\n      <version>2.0.2</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-attachment-ui</artifactId>\n      <version>${project.version}</version>\n      <type>xar</type>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-attachment-validation-ui</artifactId>\n      <version>${project.version}</version>\n      <type>xar</type>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.rendering</groupId>\n      <artifactId>xwiki-rendering-macro-message</artifactId>\n      <version>${rendering.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-localization-macro</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-rendering-xwiki</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <!-- Test dependencies. -->\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-test-page</artifactId>\n      <version>${project.version}</version>\n      <scope>test</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-web-templates</artifactId>\n      <version>${project.version}</version>\n      <scope>test</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-rendering-xwiki</artifactId>\n      <version>${project.version}</version>\n      <type>test-jar</type>\n      <scope>test</scope>\n    </dependency>\n  </dependencies>\n\n  <build>\n    <plugins>\n      <plugin>\n        <groupId>org.xwiki.commons</groupId>\n        <artifactId>xwiki-commons-tool-xar-plugin</artifactId>\n        <configuration>\n          <entries>\n            <entry>\n              <document>FlamingoThemes.Charcoal</document>\n              <type>demo</type>\n            </entry>\n            <entry>\n              <document>FlamingoThemes.Garden</document>\n              <type>demo</type>\n            </entry>\n            <entry>\n              <document>FlamingoThemes.Iceberg</document>\n              <type>demo</type>\n            </entry>\n            <entry>\n              <document>FlamingoThemes.Kitty</document>\n              <type>demo</type>\n            </entry>\n            <entry>\n              <document>FlamingoThemes.Marina</document>\n              <type>demo</type>\n            </entry>\n          </entries>\n        </configuration>\n      </plugin>\n    </plugins>\n  </build>\n</project>", "<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.3\" reference=\"FlamingoThemesCode.WebHome\" locale=\"\">\n  <web>FlamingoThemesCode</web>\n  <name>WebHome</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>FlamingoThemes.WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>Flamingo Themes Code</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{velocity}}\n{{documentTree showTranslations=\"false\" showAttachments=\"false\" root=\"document:$doc.documentReference\" /}}\n{{/velocity}}</content>\n</xwikidoc>\n"], "fixing_code": ["<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd\">\n  <modelVersion>4.0.0</modelVersion>\n  <parent>\n    <groupId>org.xwiki.platform</groupId>\n    <artifactId>xwiki-platform-flamingo-theme</artifactId>\n    <version>14.10-SNAPSHOT</version>\n  </parent>\n  <artifactId>xwiki-platform-flamingo-theme-ui</artifactId>\n  <packaging>xar</packaging>\n  <name>XWiki Platform - Flamingo - Theme - UI</name>\n  <description>Visually customize any Flamingo-based skin and preview the results live + Default Themes</description>\n  <properties>\n    <!-- Name to display by the Extension Manager -->\n    <xwiki.extension.name>Flamingo Theme Application</xwiki.extension.name>\n    <!-- Old names of this module used for retro compatibility when resolving dependencies of old extensions -->\n    <xwiki.extension.features>org.xwiki.platform:xwiki-platform-flamingo-theme</xwiki.extension.features>\n  </properties>\n  <dependencies>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-icon-script</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-webjars-api</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.webjars</groupId>\n      <artifactId>requirejs</artifactId>\n    </dependency>\n    <dependency>\n      <groupId>org.webjars</groupId>\n      <artifactId>jquery</artifactId>\n    </dependency>\n    <dependency>\n      <groupId>org.webjars.npm</groupId>\n      <artifactId>less</artifactId>\n      <version>4.1.2</version>\n      <scope>runtime</scope>\n      <!-- Exclude transitive dependencies because they are needed only for developing less.js .\n        See my comment on https://github.com/webjars/less/issues/19#issuecomment-1040328541 -->\n      <exclusions>\n        <exclusion>\n          <groupId>*</groupId>\n          <artifactId>*</artifactId>\n        </exclusion>\n      </exclusions>\n    </dependency>\n    <dependency>\n      <groupId>org.webjars</groupId>\n      <artifactId>colpick</artifactId>\n      <version>2.0.2</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-attachment-ui</artifactId>\n      <version>${project.version}</version>\n      <type>xar</type>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-attachment-validation-ui</artifactId>\n      <version>${project.version}</version>\n      <type>xar</type>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.rendering</groupId>\n      <artifactId>xwiki-rendering-macro-message</artifactId>\n      <version>${rendering.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-localization-macro</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-rendering-xwiki</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n    </dependency>\n    <!-- Required for the documentTree macro. -->\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-index-tree-macro</artifactId>\n      <version>${project.version}</version>\n      <scope>runtime</scope>\n      <type>xar</type>\n    </dependency>\n    <!-- Test dependencies. -->\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-test-page</artifactId>\n      <version>${project.version}</version>\n      <scope>test</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-web-templates</artifactId>\n      <version>${project.version}</version>\n      <scope>test</scope>\n    </dependency>\n    <dependency>\n      <groupId>org.xwiki.platform</groupId>\n      <artifactId>xwiki-platform-rendering-xwiki</artifactId>\n      <version>${project.version}</version>\n      <type>test-jar</type>\n      <scope>test</scope>\n    </dependency>\n  </dependencies>\n\n  <build>\n    <plugins>\n      <plugin>\n        <groupId>org.xwiki.commons</groupId>\n        <artifactId>xwiki-commons-tool-xar-plugin</artifactId>\n        <configuration>\n          <entries>\n            <entry>\n              <document>FlamingoThemes.Charcoal</document>\n              <type>demo</type>\n            </entry>\n            <entry>\n              <document>FlamingoThemes.Garden</document>\n              <type>demo</type>\n            </entry>\n            <entry>\n              <document>FlamingoThemes.Iceberg</document>\n              <type>demo</type>\n            </entry>\n            <entry>\n              <document>FlamingoThemes.Kitty</document>\n              <type>demo</type>\n            </entry>\n            <entry>\n              <document>FlamingoThemes.Marina</document>\n              <type>demo</type>\n            </entry>\n          </entries>\n        </configuration>\n      </plugin>\n    </plugins>\n  </build>\n</project>", "<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.3\" reference=\"FlamingoThemesCode.WebHome\" locale=\"\">\n  <web>FlamingoThemesCode</web>\n  <name>WebHome</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>FlamingoThemes.WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>Flamingo Themes Code</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{velocity}}\n#set ($documentReference = $services.rendering.escape(\"document:$doc.documentReference\", 'xwiki/2.1'))\n{{documentTree\n  showTranslations=\"false\"\n  showAttachments=\"false\"\n  root=\"$documentReference\"\n/}}\n{{/velocity}}</content>\n</xwikidoc>\n"], "filenames": ["xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-theme/xwiki-platform-flamingo-theme-ui/pom.xml", "xwiki-platform-core/xwiki-platform-flamingo/xwiki-platform-flamingo-theme/xwiki-platform-flamingo-theme-ui/src/main/resources/FlamingoThemesCode/WebHome.xml"], "buggy_code_start_loc": [112, 40], "buggy_code_end_loc": [112, 41], "fixing_code_start_loc": [113, 40], "fixing_code_end_loc": [121, 46], "type": "CWE-94", "message": "XWiki Commons are technical libraries common to several other top level XWiki projects. Any user with view rights on commonly accessible documents can execute arbitrary Groovy, Python or Velocity code in XWiki leading to full access to the XWiki installation. The root cause is improper escaping of the `documentTree` macro parameters in  This macro is installed by default in `FlamingoThemesCode.WebHome`. This page is installed by default. The vulnerability has been patched in XWiki 13.10.11, 14.4.7 and 14.10.", "other": {"cve": {"id": "CVE-2023-29509", "sourceIdentifier": "security-advisories@github.com", "published": "2023-04-16T08:15:07.577", "lastModified": "2023-04-24T13:56:02.153", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "XWiki Commons are technical libraries common to several other top level XWiki projects. Any user with view rights on commonly accessible documents can execute arbitrary Groovy, Python or Velocity code in XWiki leading to full access to the XWiki installation. The root cause is improper escaping of the `documentTree` macro parameters in  This macro is installed by default in `FlamingoThemesCode.WebHome`. This page is installed by default. The vulnerability has been patched in XWiki 13.10.11, 14.4.7 and 14.10."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.9, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-94"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-95"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionEndExcluding": "13.10.11", "matchCriteriaId": "A3CD7FFB-D491-4B7D-839D-D567B0C00E59"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "14.4.0", "versionEndExcluding": "14.4.7", "matchCriteriaId": "FC782E27-0FE5-48CE-B1E6-896F47ACB5BD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:14.10:rc1:*:*:*:*:*:*", "matchCriteriaId": "0EC7DC4E-E9FD-407B-B95F-6CBD1B5E08E0"}]}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/80d5be36f700adcd56b6c8eb3ed8b973f62ec0ae", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-f4v8-58f6-mwj4", "source": "security-advisories@github.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://jira.xwiki.org/browse/XWIKI-20279", "source": "security-advisories@github.com", "tags": ["Exploit", "Issue Tracking", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/xwiki/xwiki-platform/commit/80d5be36f700adcd56b6c8eb3ed8b973f62ec0ae"}}