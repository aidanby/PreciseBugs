{"buggy_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.5\" reference=\"ChangeRequest.Code.ChangeRequestSheet\" locale=\"\">\n  <web>ChangeRequest.Code</web>\n  <name>ChangeRequestSheet</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>ChangeRequest.WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>#if($doc.getObject('ChangeRequest.Code.ChangeRequestClass'))$doc.title#{else}Change Request Sheet#end</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{include reference=\"ChangeRequest.Code.ChangeRequestMacros\"/}}\n\n{{velocity}}\n#set ($discard = $doc.use('ChangeRequest.Code.ChangeRequestClass'))\n#set ($changeRequestId = $doc.documentReference.lastSpaceReference.name)\n#set ($changeRequestOpt = $services.changerequest.getChangeRequest($changeRequestId))\n#if ($changeRequestOpt.isPresent())\n#set ($changeRequest = $changeRequestOpt.get())\n#set ($modifiedFiles = $changeRequest.modifiedDocuments)\n#set ($discard = $xwiki.jsx.use('ChangeRequest.Code.ChangeRequestSheet'))\n#set ($discard = $xwiki.ssx.use('ChangeRequest.Code.ChangeRequestSheet'))\n#set ($isNotMerged = $changeRequest.status != \"MERGED\")\n#set ($checkIconSuccess = $services.icon.renderHTML('check'))\n#set ($checkIconProblem = $services.icon.renderHTML('warning'))\n#set ($allDiscussions = $services.changerequest.discussion.getDiscussionsFromChangeRequest($changeRequest))\n#set ($canBeEdited = $services.changerequest.authorization.isAuthorizedToEdit($changeRequest))\n## We don't want to see comments and attachments tabs\n#set ($showcomments = false)\n#set ($showannotations = false)\n#set ($showattachments = false)\n## The history tab can be confusing for new users so better not display it by default.\n#set ($showhistory = false)\n## We don't want to see the tab for change requests in change requests\n#set ($showChangeRequestTab = false)\n#set ($changeRequestSheetJSXConfig = {\n  'hasCommentRight': $services.changerequest.authorization.isAuthorizedToComment($changeRequest),\n  'hasValidReviews': $services.changerequest.review.hasValidReviews($changeRequest),\n  'confirmRefreshTranslation': $services.localization.render('changerequest.sheet.rebase.confirm'),\n  'confirmSplitTranslation': $services.localization.render('changerequest.moreactions.splitcr.confirm')\n})\n\n{{html clean=\"false\"}}\n &lt;script id=\"changerequest-sheet-jsx-config\" type=\"application/json\"&gt;$jsontool.serialize($changeRequestSheetJSXConfig).replace('&lt;', '\\u003C')&lt;/script&gt;\n#if ($canBeEdited)\n&lt;div class=\"edit-title\"&gt;\n#set ($saveTitleUrl = $services.changerequest.getChangeRequestURL('save', $changeRequestId))\n#set ($saveTitleUrl = \"${saveTitleUrl}?form_token=$services.csrf.token\")\n  &lt;form id=\"crTitleForm\" method=\"post\" action=\"$escapetool.xml($saveTitleUrl)\"&gt;\n    &lt;input type=\"hidden\" name=\"changeType\" value=\"settitle\" /&gt;\n    &lt;h1 class=\"editable\"&gt;\n      &lt;span class=\"edit-title-icon\"&gt;$services.icon.renderHTML('pencil')&lt;/span&gt;\n      &lt;label class=\"sr-only\" for=\"edit-title-input\"&gt;$doc.title&lt;/label&gt;\n      &lt;input type=\"text\" id=\"edit-title-input\" name=\"new-title\" value=\"$escapetool.xml($doc.title)\" /&gt;\n    &lt;/h1&gt;\n    &lt;div class=\"title-button-wrapper hidden\"&gt;\n      &lt;input type=\"button\" id=\"cancel-title\" data-original-title=\"$escapetool.xml($doc.title)\" class=\"btn btn-default\" value=\"Cancel\" /&gt;\n      &lt;input type=\"submit\" id=\"save-title\" class=\"btn btn-primary\" value=\"Save\" /&gt;\n    &lt;/div&gt;\n  &lt;/form&gt;\n&lt;/div&gt;\n#end\n&lt;div class=\"cr-main-div\" data-changerequest-id=\"$escapetool.xml($changeRequestId)\"&gt;\n  &lt;div id=\"discussions\" class=\"hidden\"&gt;\n  #foreach ($changeRequestDiscussion in $allDiscussions)\n    #set ($reference = $changeRequestDiscussion.reference)\n    ## TODO: handle pagination\n    #set ($messages = $services.discussions.getMessagesByDiscussion($changeRequestDiscussion.discussion, 0, 100))\n    #set ($dataAttributes = $NULL)\n    #set ($discard = \"#getDiscussionDataAttributes($changeRequestDiscussion.discussion, $dataAttributes)\")\n    #set ($diffBlockMetadata = $services.changerequest.discussion.getDiffBlockMetadata($changeRequestDiscussion.discussion))\n    &lt;div class=\"discussion\" ${dataAttributes} &gt;\n      #if ($diffBlockMetadata)\n        #displayDiffBlockMetadata($diffBlockMetadata)\n      #end\n      #foreach ($message in $messages)\n        #displayMessage($message $changeRequest)\n      #end\n    &lt;/div&gt;\n  #end\n  &lt;/div&gt;&lt;!-- End discussions --&gt;\n  &lt;div id=\"timeline-loading\" class=\"loading hidden\"&gt;&lt;/div&gt;\n  &lt;!-- Nav tabs --&gt;\n  &lt;ul class=\"nav nav-tabs\" role=\"tablist\" id=\"changeRequestTabs\"&gt;\n    &lt;li role=\"presentation\" class=\"active\"&gt;&lt;a href=\"#home\" aria-controls=\"home\" role=\"tab\" data-toggle=\"tab\"&gt;\n      $services.localization.render('changerequest.sheet.tab.description.title')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    &lt;li role=\"presentation\"&gt;&lt;a href=\"#filechanges\" aria-controls=\"filechanges\" role=\"tab\" data-toggle=\"tab\"&gt;\n      &lt;span class=\"label label-default\"&gt;$modifiedFiles.size()&lt;/span&gt;\n      $services.localization.render('changerequest.sheet.tab.filechanges.title')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    &lt;li role=\"presentation\"&gt;&lt;a href=\"#reviews\" aria-controls=\"reviews\" role=\"tab\" data-toggle=\"tab\"&gt;\n      &lt;span class=\"label label-default\"&gt;$changeRequest.reviews.size()&lt;/span&gt;\n      $services.localization.render('changerequest.sheet.tab.reviews.title')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    #if ($isNotMerged)\n    &lt;li role=\"presentation\"&gt;&lt;a href=\"#checks\" aria-controls=\"checks\" role=\"tab\" data-toggle=\"tab\"&gt;\n      #set ($canBeMerged = $services.changerequest.canBeMerged($changeRequest))\n      #if ($canBeMerged)\n        &lt;span class=\"label label-success\"&gt;$checkIconSuccess&lt;/span&gt;\n      #else\n        &lt;span class=\"label label-danger\"&gt;$checkIconProblem&lt;/span&gt;\n      #end\n      $services.localization.render('changerequest.sheet.tab.checks.title')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    #end\n  &lt;/ul&gt;\n  &lt;!-- Tab panes --&gt;\n  &lt;div class=\"tab-content change-request-sheet\"&gt;\n    &lt;div role=\"tabpanel\" class=\"tab-pane active\" id=\"home\"&gt;\n      &lt;div class=\"cr-description well\"&gt;\n        #displayDescription()\n      &lt;/div&gt;&lt;!-- End description --&gt;\n      &lt;div id=\"timeline-content\"&gt;\n        &lt;ul class=\"timeline\"&gt;\n        #set ($eventSearchResult = $services.changerequest.notifications.getChangeRequestEvents($changeRequestId, 0, 100))\n        #foreach ($event in $eventSearchResult.stream().iterator())\n          #displayEvent($event $changeRequest)\n        #end\n        &lt;/ul&gt;\n      &lt;/div&gt;&lt;!-- End timeline --&gt;\n      &lt;div id=\"discussion-comments\"&gt;\n        #if ($xcontext.action == 'view' &amp;&amp; $services.changerequest.authorization.isAuthorizedToComment($changeRequest))\n        &lt;div class=\"add-comment\"&gt;\n          &lt;button type=\"button\" class=\"btn btn-default open-editor\"&gt;\n          $services.icon.renderHTML('comment') Comment\n          &lt;/button&gt;\n        &lt;/div&gt;\n        #end\n      &lt;/div&gt;\n    &lt;/div&gt;&lt;!-- End home --&gt;\n    &lt;div role=\"tabpanel\" class=\"tab-pane\" id=\"filechanges\"&gt;\n&lt;div&gt;\n{{/html}}\n\n{{liveData\n  id=\"changerequest-filechanges\"\n  properties=\"changerequest,filechange_type,doc.title,doc.location,filechange_author,filechange_version,filechange_documentVersion,_actions\"\n  source=\"liveTable\"\n  sourceParameters=\"resultPage=ChangeRequest.Code.FileChangeLiveTable&amp;translationPrefix=changerequest.livetable.filechange.\"\n  filters=\"changerequest=$changeRequest.id\"\n  sort=\"doc.location:asc\"\n  limit=\"10\"}}{\n  \"meta\": {\n    \"propertyDescriptors\": [\n      { \"id\": \"_actions\", \"displayer\": { \"id\": \"actions\", \"actions\": [\"edit\", \"fixconflict\", \"rebase\", \"editapprovers\"] } },\n      {\n        \"id\": \"changerequest\",\n        \"visible\": false\n      },\n      {\n        \"id\": \"filechange_author\",\n        \"displayer\": \"html\",\n        \"editable\": false\n      },\n      {\n        \"id\": \"doc.location\",\n        \"editable\": false\n      },\n      {\n        \"id\": \"doc.title\",\n        \"displayer\": \"text\",\n        \"editable\": false\n      },\n      {\n        \"id\": \"filechange_type\",\n        \"editable\": false\n      },\n      {\n        \"id\": \"filechange_version\",\n        \"editable\": false\n      },\n      {\n        \"id\": \"filechange_documentVersion\",\n        \"editable\": false\n      }\n    ],\n    \"actions\": [\n      {\n        \"id\": \"fixconflict\",\n        \"allowProperty\": \"doc.hasfixconflict\",\n        \"urlProperty\": \"doc.fixconflict_url\",\n        \"icon\": \"wrench\",\n        \"name\": \"$services.localization.render('changerequest.sheet.fixconflict.button')\"\n      },\n      {\n        \"id\": \"rebase\",\n        \"allowProperty\": \"doc.hasrebase\",\n        \"urlProperty\": \"doc.rebase_url\",\n        \"icon\": \"refresh\",\n        \"name\": \"$services.localization.render('changerequest.sheet.rebase.button')\"\n      },\n      {\n        \"id\": \"editapprovers\",\n        \"allowProperty\": \"doc.haseditapprovers\",\n        \"urlProperty\": \"doc.editapprovers_url\",\n        \"icon\": \"wrench\",\n        \"name\": \"$services.localization.render('changerequest.sheet.editapprovers.button')\"\n      }\n    ]\n  }\n}\n{{/liveData}}\n\n{{html clean=\"false\"}}\n#set ($createURL = $services.changerequest.getChangeRequestURL('create', ''))\n#set ($addChangesURL = $services.changerequest.getChangeRequestURL('addchanges', '__CR__'))\n#set ($changeRequestSaveConfig = {\n      'hasEditRight': $hasEditRight,\n      'createURL': $createURL,\n      'addChangesURL': $addChangesURL,\n      'isApproversEdition': true\n})\n&lt;script id=\"changerequest-edit-approvers-config\" type=\"application/json\"&gt;$jsontool.serialize($changeRequestSaveConfig).replace('&lt;', '\\u003C')&lt;/script&gt;\n#set ($discard = $xwiki.jsx.use('ChangeRequest.Code.SaveChangeRequestModal'))\n&lt;/div&gt;\n#set ($conflictingFiles = {})\n&lt;h3&gt;$services.localization.render('changerequest.sheet.alldifftitle')&lt;/h3&gt;\n&lt;div class=\"panel-group\" id=\"accordion\" role=\"tablist\" aria-multiselectable=\"true\"&gt;\n#set ($firstFileChange = true)\n#foreach ($ref in $modifiedFiles)\n  #set ($crMergeDocumentResultOpt = $services.changerequest.merge.getMergeDocumentResult($changeRequest, $ref))\n  #if ($crMergeDocumentResultOpt.isPresent())\n  &lt;div class=\"panel panel-default\"&gt;\n    #set ($crMergeDocumentResult = $crMergeDocumentResultOpt.get())\n    #if ($crMergeDocumentResult.hasConflicts())\n      #set ($discard = $conflictingFiles.put($ref, $crMergeDocumentResult))\n    #end\n    #set ($isFileChangeOutdated = $services.changerequest.isFileChangeOutdated($crMergeDocumentResult.fileChange))\n    #set ($renderedTitle = $crMergeDocumentResult.documentTitle)\n    #set ($diffKey = $crMergeDocumentResult.identifier)\n    #set ($filechangeId = $crMergeDocumentResult.fileChange.id)\n    #set ($mergeDocumentResult = $crMergeDocumentResult.wrappedResult)\n    #if ($crMergeDocumentResult.type == 'NO_CHANGE')\n      #set ($diffContent = $services.localization.render('changerequest.sheet.diff.nochange'))\n    #elseif ($crMergeDocumentResult.type == 'DELETION')\n      #set ($currentDoc = $mergeDocumentResult.currentDocument)\n      ## We wrap the XWikiDocument in Document so that the diff macros behave correctly\n      #set ($wrappedDocs = $xwiki.wrapDocs([$currentDoc]))\n      #define ($diffContent)\n        #displayDocumentRawChanges($wrappedDocs.get(0), $NULL)\n      #end\n    #elseif ($crMergeDocumentResult.type == 'CREATION')\n      #set ($modifiedDoc = $crMergeDocumentResult.fileChange.modifiedDocument)\n      ## We wrap the XWikiDocument in Document so that the diff macros behave correctly\n      #set ($wrappedDocs = $xwiki.wrapDocs([$modifiedDoc]))\n      #define ($diffContent)\n        #displayDocumentRawChanges($NULL, $wrappedDocs.get(0))\n      #end\n    #else\n      #set ($modifiedDoc = $mergeDocumentResult.nextDocument)\n      #set ($previousDoc = $mergeDocumentResult.previousDocument)\n      ## We wrap the XWikiDocument in Document so that the diff macros behave correctly\n      #set ($wrappedDocs = $xwiki.wrapDocs([$previousDoc, $modifiedDoc]))\n      #define ($diffContent)\n        #displayDocumentRawChanges($wrappedDocs.get(0), $wrappedDocs.get(1))\n      #end\n    #end\n    &lt;div class=\"panel-heading\" role=\"tab\" id=\"heading-$diffKey\" data-documentReference=\"$escapetool.xml($services.model.serialize($ref))\"&gt;\n      &lt;h4 class=\"panel-title\"&gt;\n        &lt;a role=\"button\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#diff-$diffKey\" aria-expanded=\"true\" aria-controls=\"diff-$diffKey\"&gt;\n          &lt;span class=\"diff-labels\"&gt;\n            &lt;span class=\"label label-default commentcounter hidden\"&gt;\n              $services.icon.renderHTML('envelope') &lt;span class=\"counter\" data-documentReference=\"$escapetool.xml($services.model.serialize($ref))\"&gt;0&lt;/span&gt;\n            &lt;/span&gt;\n            #if ($isNotMerged &amp;&amp; $crMergeDocumentResult.hasConflicts())\n              &lt;span class=\"label label-warning label-diff-conflict\" title=\"$escapetool.xml($services.localization.render('changerequest.sheet.diff.conflictLabel.title'))\"&gt;\n                $services.icon.renderHTML('wrench') $services.localization.render('changerequest.sheet.diff.conflictLabel')\n              &lt;/span&gt;\n            #end\n            #if ($isNotMerged &amp;&amp; $isFileChangeOutdated)\n              &lt;span class=\"label label-warning label-diff-outdated\" title=\"$escapetool.xml($services.localization.render('changerequest.sheet.diff.outdated.title'))\"&gt;\n                $services.icon.renderHTML('clock') $services.localization.render('changerequest.sheet.diff.outdated')\n              &lt;/span&gt;\n            #end\n            ## We only display approvers badges for CR with more than a single document change.\n            #if ($modifiedFiles.size() &gt; 1)\n              #if ($services.changerequest.isApproverOf($crMergeDocumentResult.fileChange))\n              &lt;span class=\"label label-success label-approver\" title=\"$escapetool.xml($services.localization.render('changerequest.sheet.diff.approverLabel.title'))\"&gt;\n                $services.icon.renderHTML('certificate') $services.localization.render('changerequest.sheet.diff.approverLabel')\n              &lt;/span&gt;\n              #elseif ($services.changerequest.isDelegateApproverOf($crMergeDocumentResult.fileChange))\n              &lt;span class=\"label label-success label-delegate-approver\" title=\"$escapetool.xml($services.localization.render('changerequest.sheet.diff.approverLabel.title'))\"&gt;\n                $services.icon.renderHTML('certificate') $services.localization.render('changerequest.sheet.diff.approverLabel')\n              &lt;/span&gt;\n              #end\n            #end\n          &lt;/span&gt;\n          &lt;span class=\"badge button-collapse #if(!$firstFileChange)hidden#end\" title=\"$escapetool.xml($services.localization.render('changerequest.sheet.hide'))\"&gt;\n            $services.icon.renderHTML('caret-up')\n          &lt;/span&gt;\n          &lt;span class=\"badge button-expand #if($firstFileChange)hidden#end\" title=\"$escapetool.xml($services.localization.render('changerequest.sheet.view'))\"&gt;\n            $services.icon.renderHTML('caret-down')\n          &lt;/span&gt;\n          #set ($diffTitleTranslationKey = \"changerequest.sheet.difftitle.$crMergeDocumentResult.type\")\n          $services.localization.render($diffTitleTranslationKey, [\"$escapetool.xml($renderedTitle)\"])\n        &lt;/a&gt;\n      &lt;/h4&gt;\n    &lt;/div&gt;\n    &lt;div id=\"diff-$diffKey\" class=\"panel-collapse collapse diff-panel #if($firstFileChange)in#end\" role=\"tabpanel\" aria-labelledby=\"heading-$diffKey\"&gt;\n      &lt;div class=\"panel-body diff-body\" data-diffId=\"$escapetool.xml($diffKey)\" data-documentReference=\"$escapetool.xml($services.model.serialize($ref))\"&gt;\n        #set ($renderedDiffEnabled = $services.changerequest.isRenderedDiffEnabled())\n        &lt;div class=\"changes-body\" data-filechangeid=\"$escapetool.xml($filechangeId)\"&gt;\n          &lt;div class=\"changes-body-header\"&gt;\n            &lt;div class=\"row\"&gt;\n              &lt;div class=\"col-xs-12 col-sm-6\"&gt;\n                &lt;ul class=\"nav nav-pills\" role=\"tablist\"&gt;\n                  &lt;li role=\"presentation\" class=\"active\"&gt;\n                    &lt;a href=\"#rawChanges-$diffKey\" aria-controls=\"rawChanges-$diffKey\" role=\"tab\" data-toggle=\"pill\" data-hint=\"raw\"&gt;\n                      $escapetool.xml($services.localization.render('web.history.changes.raw'))\n                    &lt;/a&gt;\n                  &lt;/li&gt;\n                  &lt;li role=\"presentation\" #if (!$renderedDiffEnabled)class=\"hidden\"#end&gt;\n                    &lt;a href=\"#renderedChanges-$diffKey\" aria-controls=\"renderedChanges-$diffKey\" role=\"tab\" data-toggle=\"pill\" data-hint=\"rendered\"&gt;\n                      $escapetool.xml($services.localization.render('web.history.changes.rendered'))\n                    &lt;/a&gt;\n                  &lt;/li&gt;\n                &lt;/ul&gt;\n              &lt;/div&gt;\n              &lt;div class=\"col-xs-12 col-md-6\"&gt;\n                &lt;div class=\"changes-actions raw active\"&gt;&lt;/div&gt;\n                &lt;div class=\"changes-actions rendered\"&gt;\n                  &lt;a href=\"#toggleRenderedDiffContext\" class=\"html-diff-context-toggle html-diff-context-toggle-show hidden\"&gt;\n                    &lt;span class=\"html-diff-context-show\"&gt;\n                      $services.icon.renderHTML('plus-square')\n                      $escapetool.xml($services.localization.render('web.history.changes.showContext'))\n                    &lt;/span&gt;\n                    &lt;span class=\"html-diff-context-hide\"&gt;\n                      $services.icon.renderHTML('minus-square')\n                      $escapetool.xml($services.localization.render('web.history.changes.hideContext'))\n                    &lt;/span&gt;\n                  &lt;/a&gt;\n                &lt;/div&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n          &lt;div class=\"tab-content\"&gt;\n            &lt;div role=\"tabpanel\" class=\"tab-pane active\" id=\"rawChanges-$diffKey\"&gt;\n                $diffContent\n            &lt;/div&gt;\n            &lt;div role=\"tabpanel\" class=\"tab-pane html-diff\" id=\"renderedChanges-$diffKey\"&gt;\n            &lt;!-- This is filled with an ajax request to avoid expensive rendering --&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  #set ($firstFileChange = false)\n  #end\n#end\n&lt;/div&gt;\n    &lt;/div&gt;&lt;!-- End file changes --&gt;\n    &lt;div role=\"tabpanel\" class=\"tab-pane\" id=\"reviews\"&gt;\n    &lt;div id=\"addReviewContainer\" class=\"panel panel-primary hidden\"&gt;\n      &lt;div class=\"panel-heading\"&gt;\n        &lt;h3 class=\"panel-title\"&gt;$escapetool.xml($services.localization.render('changerequest.review.modal.title'))&lt;/h3&gt;\n      &lt;/div&gt;\n      &lt;div class=\"panel-body\"&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div id=\"reviewsContainer\"&gt;\n    #foreach ($review in $changeRequest.reviews)\n      #set ($reviewAuthor = $xwiki.getUserName($review.author.reference))\n      #if ($review.originalApprover &amp;&amp; $review.originalApprover != $review.author)\n        #set ($originalApprover = $xwiki.getUserName($review.originalApprover.reference))\n        #if ($review.approved)\n          #set ($reviewPanelTitle = $services.localization.render('changerequest.sheet.tab.review.title.approved.onbehalf', [\"$reviewAuthor\", \"$originalApprover\"]))\n        #else\n          #set ($reviewPanelTitle = $services.localization.render('changerequest.sheet.tab.review.title.notapproved.onbehalf', [\"$reviewAuthor\", \"$originalApprover\"]))\n        #end\n      #else\n        #set ($originalApprover = $NULL)\n        #if ($review.approved)\n          #set ($reviewPanelTitle = $services.localization.render('changerequest.sheet.tab.review.title.approved', [\"$reviewAuthor\"]))\n        #else\n          #set ($reviewPanelTitle = $services.localization.render('changerequest.sheet.tab.review.title.notapproved', [\"$reviewAuthor\"]))\n        #end\n      #end\n      #if ($review.valid &amp;&amp; $review.approved)\n        #set ($reviewPanelClass = \"panel-success\")\n      #elseif ($review.valid &amp;&amp; !$review.approved)\n        #set ($reviewPanelClass = \"panel-warning\")\n      #else\n        #set ($reviewPanelClass = \"panel-default\")\n      #end\n      #set ($canEditReview = $services.changerequest.review.canEditReview($review))\n      &lt;div class=\"panel $reviewPanelClass review panel-review\" data-reviewid=\"$review.id\" data-approved=\"$review.approved\" data-valid=\"$review.valid\" data-date=\"$review.reviewDate.time\" data-author=\"$escapetool.xml($services.user.serialize($review.author))\" #if($originalApprover)data-original-approver=\"$escapetool.xml($services.user.serialize($review.originalApprover))\"#end&gt;\n        &lt;div class=\"panel-heading\"&gt;\n           #if ($canEditReview)\n            #if ($review.valid)\n              #set ($buttonTitle = $services.localization.render('changerequest.sheet.tab.review.button.markinvalid.title'))\n              #set($buttonValue = \"$services.icon.renderHTML('remove') $services.localization.render('changerequest.sheet.tab.review.button.markinvalid')\")\n              #set ($buttonClass = \"btn-danger\")\n            #else\n              #set ($buttonTitle = $services.localization.render('changerequest.sheet.tab.review.button.markvalid.title') )\n              #set($buttonValue = \"$services.icon.renderHTML('check') $services.localization.render('changerequest.sheet.tab.review.button.markvalid')\")\n              #set ($buttonClass = \"btn-success\")\n            #end\n            &lt;button class=\"btn $buttonClass badge outdated review-toggle-valid\" data-review-id=\"$review.id\" title=\"$buttonTitle\"&gt;$buttonValue&lt;/button&gt;\n          #elseif (!$review.valid)\n            &lt;span class=\"label label-danger outdated\" title=\"$services.localization.render('changerequest.sheet.tab.review.title.outdated.title')\"&gt;$services.localization.render('changerequest.sheet.tab.review.title.outdated')&lt;/span&gt;\n          #end\n          &lt;span class=\"review-date\"&gt;$datetool.format($review.reviewDate)&lt;/span&gt;\n          &lt;h3 class=\"panel-title\"&gt;$reviewPanelTitle&lt;/h3&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    #end\n    &lt;/div&gt;\n    &lt;div class=\"approvers panel panel-default\"&gt;\n      &lt;div class=\"panel-heading\"&gt;\n        &lt;h3 class=\"panel-title\"&gt;$escapetool.xml($services.localization.render('changerequest.sheet.tab.review.approvers.title'))&lt;/h3&gt;\n      &lt;/div&gt;\n      &lt;div class=\"panel-body\"&gt;\n    #set ($approversList = $services.changerequest.getApprovers($changeRequest))\n    #if ($approversList.isEmpty())\n      &lt;span class=\"empty-approvers\"&gt;$escapetool.xml($services.localization.render('changerequest.sheet.tab.review.approvers.noapprover'))&lt;/span&gt;\n    #else\n      $escapetool.xml($services.localization.render('changerequest.sheet.tab.review.approvers.approverslist'))\n      &lt;ul class=\"approvers-list\"&gt;\n      #foreach ($userReference in $approversList)\n        #set ($userDocReference = $userReference.reference)\n        &lt;li&gt;&lt;a href='$xwiki.getURL($userDocReference)'&gt;$xwiki.getPlainUserName($userDocReference)&lt;/a&gt;&lt;/li&gt;\n      #end\n      &lt;/ul&gt;\n    #end\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;/div&gt;&lt;!-- End reviews --&gt;\n    #if ($isNotMerged)\n    &lt;div role=\"tabpanel\" class=\"tab-pane\" id=\"checks\"&gt;\n    &lt;div class=\"panel-group\" id=\"accordion\" role=\"tablist\" aria-multiselectable=\"true\"&gt;\n    #set ($otherChangeRequestsWithSamePages = $services.changerequest.getOpenChangeRequestsTargetingSame($changeRequest))\n    #if (!$otherChangeRequestsWithSamePages.isEmpty())\n      &lt;div class=\"panel panel-info check-panel-other-cr\"&gt;\n        &lt;div class=\"panel-heading\" role=\"tab\" id=\"headingOtherCRPanel\"&gt;\n          &lt;h4 class=\"panel-title\"&gt;\n            &lt;a role=\"button\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#otherCRPanel\" aria-expanded=\"true\" aria-controls=\"otherCRPanel\"&gt;\n              $services.icon.renderHTML('info') $services.localization.render('changerequest.sheet.checks.otherCR.title')\n            &lt;/a&gt;\n          &lt;/h4&gt;\n        &lt;/div&gt; &lt;!-- End heading other CR panel --&gt;\n        &lt;div id=\"otherCRPanel\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"headingOtherCRPanel\"&gt;\n          &lt;div class=\"panel-body\"&gt;\n            $services.localization.render('changerequest.sheet.existingChangeRequestSameChanges')\n            #set ($id = \"changerequests-samechanges\")\n            #set ($columns = [\"doc.title\", \"authors\", \"status\", \"changedDocuments\"])\n            #set($columnsProperties = {\n               \"doc.title\" : { \"type\" : \"text\", \"link\": \"auto\" },\n               \"authors\": { \"type\": \"suggest\", \"html\": \"true\" },\n               \"status\" : { \"type\" : \"suggest\" },\n               \"changedDocuments\" : { \"type\": \"suggest\", \"html\": \"true\"}\n            })\n            #set ($changedDocumentFilters = [])\n            #foreach ($changedDocument in $changeRequest.modifiedDocuments)\n              #set ($discard = $changedDocumentFilters.add(\"&amp;changedDocuments=$services.model.serialize($changedDocument)\"))\n            #end\n            #set($options = {\n               \"className\":\"ChangeRequest.Code.ChangeRequestClass\",\n               \"rowCount\": 5,\n               \"translationPrefix\": \"changerequest.livetable.\",\n               \"extraParams\": \"&amp;status/join_mode=OR&amp;status=draft&amp;status=ready_for_review&amp;status=ready_for_merging&amp;changedDocuments/join_mode=OR$stringtool.join($changedDocumentFilters, '')\",\n               \"outputOnlyHtml\": true\n            })\n            #livetable($id $columns $columnsProperties $options)\n        &lt;/div&gt;\n      &lt;/div&gt;&lt;!-- End otherCR panel body --&gt;\n     &lt;/div&gt;&lt;!-- End otherCR panel --&gt;\n      #end\n       #if ($changeRequest.status == \"READY_FOR_REVIEW\")\n         #set ($statusPanelClass = \"panel-info\")\n         #set ($statusIcon = $checkIconSuccess)\n       #elseif ($changeRequest.status == \"DRAFT\")\n         #set ($statusPanelClass = \"panel-warning\")\n         #set ($statusIcon = $checkIconProblem)\n       #elseif ($changeRequest.status == \"READY_FOR_MERGING\")\n         #set ($statusPanelClass = \"panel-success\")\n         #set ($statusIcon = $checkIconSuccess)\n       #elseif ($changeRequest.status == \"CLOSED\")\n         #set ($statusPanelClass = \"panel-danger\")\n         #set ($statusIcon = $checkIconProblem)\n       #end\n       &lt;div class=\"panel check-panel-status $statusPanelClass\"&gt;\n        &lt;div class=\"panel-heading\" role=\"tab\" id=\"headingStatusPanel\"&gt;\n          &lt;h4 class=\"panel-title\"&gt;\n            &lt;a role=\"button\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#statusPanel\" aria-expanded=\"true\" aria-controls=\"statusPanel\"&gt;\n              $statusIcon $doc.display('status')\n            &lt;/a&gt;\n          &lt;/h4&gt;\n        &lt;/div&gt; &lt;!-- End heading status panel --&gt;\n        &lt;div id=\"statusPanel\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"headingStatusPanel\"&gt;\n          &lt;div class=\"panel-body\"&gt;\n            &lt;div class=\"explanation\"&gt;\n            #if ($changeRequest.status == \"READY_FOR_REVIEW\" || $changeRequest.status == \"READY_FOR_MERGING\")\n              $services.localization.render('changerequest.sheet.checks.status.ready.explanation')\n            #elseif ($changeRequest.status == \"DRAFT\")\n              &lt;div class=\"explanation\"&gt;$services.localization.render('changerequest.sheet.checks.status.draft.explanation')\n            #elseif ($changeRequest.status == \"CLOSED\")\n              &lt;div class=\"explanation\"&gt;$services.localization.render('changerequest.sheet.checks.status.closed.explanation')\n            #end\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;&lt;!-- End body status panel --&gt;\n      &lt;/div&gt;&lt;!-- End status panel --&gt;\n       #set ($hasConflict = $services.changerequest.merge.hasConflict($changeRequest))\n       #if (!$hasConflict)\n         #set ($conflictPanelClass = \"panel-success\")\n         #set ($conflictPanelTitle = $services.localization.render('changerequest.sheet.tab.checks.conflicts.noconflict.title'))\n         #set ($statusIcon = $checkIconSuccess)\n         #set ($conflictPanelBody = $services.localization.render('changerequest.sheet.tab.checks.conflicts.noconflict.body'))\n       #elseif (!$conflictingFiles.isEmpty())\n         #set ($conflictPanelClass = \"panel-warning\")\n         #set ($conflictPanelTitle = $services.localization.render('changerequest.sheet.tab.checks.conflicts.title', \"$conflictingFiles.size()\"))\n         #set ($statusIcon = $checkIconProblem)\n         #set ($conflictPanelBody = $services.localization.render('changerequest.sheet.tab.checks.conflicts.body', [\"$conflictingFiles.size()\", '&lt;a href=\"#filechanges\" class=\"check-conflict-link\"&gt;', '&lt;/a&gt;']))\n       #else\n         #set ($conflictPanelClass = \"panel-warning\")\n         #set ($conflictPanelTitle = $services.localization.render('changerequest.sheet.tab.checks.conflicts.needsrefresh.title'))\n         #set ($statusIcon = $checkIconProblem)\n         #set ($conflictPanelBody = $services.localization.render('changerequest.sheet.tab.checks.conflicts.needsrefresh.body', ['&lt;a href=\"#filechanges\" class=\"check-conflict-link\"&gt;', '&lt;/a&gt;']))\n       #end\n       &lt;div class=\"panel check-panel-conflict $conflictPanelClass\"&gt;\n        &lt;div class=\"panel-heading\" role=\"tab\" id=\"headingConflictPanel\"&gt;\n          &lt;h4 class=\"panel-title\"&gt;\n            &lt;a role=\"button\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#conflictPanel\" aria-expanded=\"true\" aria-controls=\"conflictPanel\"&gt;\n              $statusIcon $conflictPanelTitle\n            &lt;/a&gt;\n          &lt;/h4&gt;\n        &lt;/div&gt; &lt;!-- End heading conflict --&gt;\n        &lt;div id=\"conflictPanel\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"headingConflictPanel\"&gt;\n          &lt;div class=\"panel-body\"&gt;\n            $conflictPanelBody\n          &lt;/div&gt;\n        &lt;/div&gt;&lt;!-- End body conflict --&gt;\n      &lt;/div&gt;&lt;!-- End panel conflict --&gt;\n      #set ($approvalStrategy = $services.changerequest.mergeApprovalStrategy)\n      #set ($canBeMerged = $approvalStrategy.canBeMerged($changeRequest))\n      #if ($canBeMerged)\n        #set ($strategyPanelClass = \"panel-success\")\n        #set ($statusIcon = $checkIconSuccess)\n      #else\n        #set ($strategyPanelClass = \"panel-warning\")\n        #set ($statusIcon = $checkIconProblem)\n      #end\n      #set ($strategyPanelText = $approvalStrategy.getStatus($changeRequest))\n      &lt;div class=\"panel check-panel-strategy $strategyPanelClass\"&gt;\n        &lt;div class=\"panel-heading\" role=\"tab\" id=\"headingApprovalStrategyPanel\"&gt;\n          &lt;h4 class=\"panel-title\"&gt;\n            &lt;a class=\"collapsed\" role=\"button\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#approvalStrategyPanel\" aria-expanded=\"false\" aria-controls=\"approvalStrategyPanel\"&gt;\n              $statusIcon $services.localization.render('changerequest.sheet.tab.checks.approvalStrategy.title')\n            &lt;/a&gt;\n          &lt;/h4&gt;\n        &lt;/div&gt; &lt;!-- End heading approval strategy --&gt;\n        &lt;div id=\"approvalStrategyPanel\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"headingApprovalStrategyPanel\"&gt;\n          &lt;div class=\"panel-body\"&gt;\n           $strategyPanelText\n          &lt;/div&gt;\n        &lt;/div&gt;&lt;!-- End body approval strategy --&gt;\n      &lt;/div&gt;&lt;!-- End panel approval strategy --&gt;\n    &lt;/div&gt;&lt;!-- End panel accordion --&gt;\n    &lt;/div&gt;&lt;!-- End merge tab --&gt;\n    #end\n  &lt;/div&gt;\n\n&lt;/div&gt;\n{{/html}}\n#else\n    No change request corresponding to the current id.\n#end\n{{/velocity}}</content>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>0</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>8c39e9a2-e2ec-4e39-a32f-259c8e8d4446</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery'], function ($) {\n  var removeCreateButton = function () {\n    $('#tmCreate').remove();\n  }\n  \n  $(document).on('xwiki:dom:updated', removeCreateButton);\n  (XWiki.isInitialized &amp;&amp; removeCreateButton()) || $(document).on('xwiki:dom:loading', removeCreateButton);\n});</code>\n    </property>\n    <property>\n      <name>remove create</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>1</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>ca32fb8c-d27c-4c25-9116-7d6ddf5b0cd0</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'bootstrap'], function ($) {\n  var checkMergeButton = function() {\n    $('#checkMerge').on('click', function() {\n      $('#changeRequestTabs a[href=\"#merge\"]').tab('show');\n    })\n  };\n\n  $(document).on('xwiki:dom:updated', checkMergeButton);\n  (XWiki.isInitialized &amp;&amp; checkMergeButton()) || $(document).on('xwiki:dom:loading', checkMergeButton);\n})</code>\n    </property>\n    <property>\n      <name>Check merge action </name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>2</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>fb3f6f6b-7a15-41ae-9adb-a717fa54d05f</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>define('ChangeRequestConflictModal', ['jquery', 'xwiki-meta', 'bootstrap'], function ($, xm) {\n  \n  var conflictModal = function (changeRequestId, fileChangeReference, fileChangeLocale) {\n    var self = this;\n    self.changeRequestId = changeRequestId;\n    self.fileChangeReference = fileChangeReference;\n    self.fileChangeLocale = fileChangeLocale;\n    var currentReference = xm.documentReference;\n    var changeRequestConflictRef = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestConflict\");\n    self.postUrl = new XWiki.Document(changeRequestConflictRef).getURL('get');\n    \n    self.requestModal = function(previousVersion, nextVersion) {\n      var warningConflictAction = $('#changeRequestConflictModal input[name=warningConflictAction]:checked').val();\n      \n      if (previousVersion &amp;&amp; nextVersion) {\n        var original = previousVersion;\n        var revised = nextVersion;\n      } else if ($('select[name=original]').length &gt; 0 &amp;&amp; $('select[name=revised]').length &gt; 0) {\n        var original = $('#modalConflictSelectVersion select[name=original]').val();\n        var revised = $('#modalConflictSelectVersion select[name=revised]').val();\n      }\n      if ($('#changeRequestConflictModal')) {\n        $('#changeRequestConflictModal').remove();\n      }\n      \n      var params = {\n        'form_token': xm.form_token,\n        'filechange': self.fileChangeReference,\n        'filechangeLocale': self.fileChangeLocale,\n        'changerequest': self.changeRequestId,\n        'original': original,\n        'revised': revised,\n        'warningConflictAction': warningConflictAction\n      };\n      \n      var notification = new XWiki.widgets.Notification('Requesting conflict modal...','inprogress');\n      $.post(self.postUrl, params).done(function (data) {\n        notification.hide();\n        // Hide previous modal if it exists.\n        $('#changeRequestConflictModal').modal('hide');\n        $('div.modal-backdrop').remove();\n        $('body').append(data);\n        $(document).trigger('xwiki:dom:updated', {'elements': $('#changeRequestConflictModal').toArray()});\n        self.initModal();\n      }).fail(function (data) {\n        notification.replace(new XWiki.widgets.Notification('Error while getting conflict information.','error'));\n      });\n    };\n    \n    // Change the diff based on the action chosen.\n    self.radioSelect = function () {\n      var selectedValue = $('#changeRequestConflictModal input[name=warningConflictAction]:checked').val();\n      if (selectedValue == \"keepChangeRequest\") {\n        self.requestModal(\"NEXT\", \"MERGED\");\n        // It's the next and current value which will be used for the merge, so better use them in case of custom\n        // conflicts resolution.\n      } else if (selectedValue == \"keepPublished\" || selectedValue == \"custom\") {\n        self.requestModal(\"CURRENT\", \"NEXT\");\n      }\n    };\n    \n    self.submitAction = function () {\n      var warningConflictAction = $('#changeRequestConflictModal input[name=warningConflictAction]:checked').val();\n      \n      var params = {\n        'form_token': xm.form_token,\n        'filechange': self.fileChangeReference,\n        'filechangeLocale': self.fileChangeLocale,\n        'changerequest': self.changeRequestId,\n        'decision': warningConflictAction\n      };\n      \n      if (warningConflictAction == 'custom') {\n        var conflictReferences = [];\n        \n        $('#changeRequestConflictModal input[name=conflict_id]').each(function () {\n          var conflictId = $(this).val();\n          var selectValue = $('#conflict_decision_select_' + conflictId).val();\n          var customValue = $('#conflict_decision_value_custom_' + conflictId).val();\n          conflictReferences.push(conflictId);\n          params[\"customDecision_\" + conflictId] = selectValue;\n          \n          if (selectValue == 'custom') {\n            params[\"customInput_\" + conflictId] = customValue;\n          }\n        });\n        params[\"conflictReferences\"] = conflictReferences;\n      }\n      var notification = new XWiki.widgets.Notification('Applying conflict resolution...','inprogress');\n      $.post(self.postUrl, params).done(function (data) {\n        if (data.success) {\n          notification.replace(new XWiki.widgets.Notification('Resolution applied successfully, the page will reload.','done'));\n          window.location.reload();\n        } else {\n          notification.replace(new XWiki.widgets.Notification('An error happened when applying the conflict resolution.','error'));\n        }\n      }).fail(function () {\n        notification.replace(new XWiki.widgets.Notification('Request error when applying the conflict resolution.','error'));\n      });\n    };\n    \n    self.initModal = function() {\n      var modal = $('#changeRequestConflictModal');\n\n      if (modal) {\n        modal.on('hidden.bs.modal', function (e) {\n          $('div.modal-backdrop').remove();\n          modal.remove();\n        });\n\n        $('#changeRequestConflictModalChoices .panel').on('click', self.selectChoice);\n        $('#changeRequestConflictModal input[name=warningConflictAction]').on('change', self.radioSelect);\n        $('#changeRequestConflictChangeDiff').on('click', self.requestModal);\n        $('#changeRequestConflictSubmitButton').on('click', self.submitAction);\n        modal.modal('show');\n      }\n    };\n  }\n  \n  return conflictModal;\n});</code>\n    </property>\n    <property>\n      <name>handle conflict modal</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>3</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>d36ff964-4454-4e7c-a928-f29636110a96</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta', 'ChangeRequestConflictModal'], function ($, xm, ConflictModal) {\n  var initialize = function () {\n    $(\".conflictFixing\").on('click', function () {\n      var button = $(this);\n      var reference = button.attr('data-reference');\n      var locale = button.attr('data-locale');\n      var currentReference = xm.documentReference;\n      var changeRequestId = currentReference.extractReference(XWiki.EntityType.SPACE).getName();\n      var modal = new ConflictModal(changeRequestId, reference, locale);\n      modal.requestModal('', '');\n    });\n    \n    $(document).on('click', '.action_fixconflict', function (event) {\n      event.preventDefault();\n      var currentReference = xm.documentReference;\n      var changeRequestId = currentReference.extractReference(XWiki.EntityType.SPACE).getName();\n      var button = $(this);\n      var link = button.attr('href');\n      var urlParams = new URLSearchParams(link);\n      var reference = urlParams.get('reference');\n      var locale = urlParams.get('locale');\n      var modal = new ConflictModal(changeRequestId, reference, locale);\n      modal.requestModal('', '');\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loaded', initialize);\n});</code>\n    </property>\n    <property>\n      <name>Handle conflict button</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>4</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>5e6a11b2-96d9-4f13-9d20-484cd485d3a1</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta'], function ($, xm) {\n  var reviewContainer = function (changeRequestId) {\n    var self = this;\n    self.changeRequestId = changeRequestId;\n    var currentReference = xm.documentReference;\n    var changeRequestReviewRef = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestReview\");\n    self.postUrl = new XWiki.Document(changeRequestReviewRef).getURL('get');\n    \n    self.requestModal = function () {\n      var reviewContainer = $('#addReviewContainer');\n      if (reviewContainer.hasClass('hidden')) {\n        var params = {\n          'form_token': xm.form_token,\n          'action': 'create',\n          'changerequest': self.changeRequestId\n        };\n        self.notification = new XWiki.widgets.Notification('Requesting review modal...','inprogress');\n\n        $.post(self.postUrl, params).done(function (data) {\n          self.notification.hide();\n          reviewContainer.find('.panel-body').append(data);\n          reviewContainer.removeClass('hidden');\n          $(document).trigger('xwiki:dom:updated', {'elements': reviewContainer.find('.panel-body').toArray()});\n          self.initModal();\n        }).fail(function (data) {\n          self.notification.replace(new XWiki.widgets.Notification('Error while getting review information.','error'));\n        });\n      } else {\n        self.initModal();\n      }\n    };\n\n    var isEditorEmpty = function () {\n      var textarea = $('#addReviewContainer textarea').first();\n      var textareaContent = textarea.val();\n      // regex and logic taken\n      // from https://github.com/ckeditor/ckeditor4/blob/master/plugins/editorplaceholder/plugin.js#L67\n      var fullPageRegex = /&lt;body.*?&gt;((?:.|[\\n\\r])*?)&lt;\\/body&gt;/i;\n      var bodyDataMatched = textareaContent.match(fullPageRegex);\n      if (bodyDataMatched &amp;&amp; (bodyDataMatched.length &gt; 1)) {\n        textareaContent = bodyDataMatched[ 1 ];\n      }\n      return textareaContent.length === 0;\n    };\n    \n    self.submitAction = function () {\n      var reviewForm = $('#reviewForm');\n      var reviewActionUrl = reviewForm.attr('action');\n\n      // We need to call beforeSave first to put the data in the actual content field.\n      $(document).trigger('xwiki:actions:beforeSave');\n      if (!isEditorEmpty()) {\n        reviewForm.find('input[name=\"withComment\"]').val('1');\n      }\n      var reviewData =  reviewForm.serialize();\n      self.notification = new XWiki.widgets.Notification('Posting review...','inprogress');\n      $.post(reviewActionUrl, reviewData).done(function (data) {\n        self.notification.replace(new XWiki.widgets.Notification('Review posted','done'));\n        // Needed to avoid getting a prompt about leaving the window.\n        $(document).trigger('xwiki:actions:cancel');\n        // TODO: this could be improve to only reload reviews\n        window.location.reload();\n      }).fail(function (data) {\n        self.notification.replace(new XWiki.widgets.Notification('Request error while posting review.','error'));\n        console.error(data);\n      });\n    };\n    \n    self.cancel = function () {\n      var modal = $('#addReviewContainer');\n      modal.addClass('hidden');\n      $(document).trigger('xwiki:actions:cancel');\n      modal.find('.panel-body').empty();\n    };\n    \n    self.initModal = function () {\n      var modal = $('#addReviewContainer');\n\n      if (!modal.hasClass('hidden')) {\n        modal.find('.submit-review').on('click', self.submitAction);\n        modal.find('.cancel-review').on('click', self.cancel);\n        modal.find('input[name=\"reviewChoice\"]').on('click', function () {\n          var originalApprover = modal.find('select[name=originalApprover]');\n          if (originalApprover.length == 0 || originalApprover.val() != '-') {\n            modal.find('.submit-review').prop('disabled', false);\n          }\n        });\n        modal.find('select[name=originalApprover]').on('change', function () {\n          var reviewChoice = modal.find('input[name=\"reviewChoice\"]:checked');\n          $('.warning-review').addClass('hidden');\n          $('.warning-review[data-user=\"'+$(this).val()+'\"]').removeClass('hidden');\n          if ($(this).val() != '-' &amp;&amp; reviewChoice.length &gt; 0) {\n            modal.find('.submit-review').prop('disabled', false);\n          } else {\n            modal.find('.submit-review').prop('disabled', true);\n          }\n        });\n      }\n      $('#changeRequestTabs a[aria-controls=\"reviews\"]').tab('show');\n    };\n  }\n  \n  var initialize = function () {\n    $(\"#addReview:not(.disabled)\").on('click', function () {\n      var currentReference = xm.documentReference;\n      var changeRequestId = currentReference.extractReference(XWiki.EntityType.SPACE).getName();\n      var modal = new reviewContainer(changeRequestId);\n      modal.requestModal();\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n});</code>\n    </property>\n    <property>\n      <name>Review modal</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>5</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>1966a41f-f230-4160-8f15-61b681b47304</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta'], function ($, xm) {\n  var initialize = function () {\n    $(\".btn.outdated\").on('click', function () {\n      var button = $(this);\n      var currentReference = xm.documentReference;\n      var changeRequestId = currentReference.extractReference(XWiki.EntityType.SPACE).getName();\n      var currentReference = xm.documentReference;\n      var changeRequestReviewRef = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestReview\");\n      var postUrl = new XWiki.Document(changeRequestReviewRef).getURL('get');\n      var setValid;\n      if (button.hasClass('btn-danger')) {\n        setValid = '0';\n      } else {\n        setValid = '1';\n      }\n      var reviewId = button.attr('data-review-id');\n      var params = {\n        'form_token': xm.form_token,\n        'action': 'setstatus',\n        'changerequest': changeRequestId,\n        'reviewid': reviewId,\n        'isvalid': setValid\n      }\n      var notification = new XWiki.widgets.Notification('Changing review status...','inprogress');\n      $.post(postUrl, params).done(function (data) {\n        if (data.success) {\n          notification.replace(new XWiki.widgets.Notification('Review status edited','done'));\n          window.location.reload();\n        } else {\n          notification.replace(new XWiki.widgets.Notification('Error while changing status.','error'));\n        }\n      }).fail(function (data) {\n        notification.replace(new XWiki.widgets.Notification('Request error while changing status.','error'));\n        console.error(data);\n      });\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n})</code>\n    </property>\n    <property>\n      <name>Review outdated button</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>6</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>ea5056ef-4799-4d88-9265-df9cd9c48978</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>define('ChangeRequestDiscussionHandler', ['jquery', 'xwiki-meta', 'bootstrap'], function ($, xm) {\n  var currentReference = xm.documentReference;\n  var discussionPageReference = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestDiscussion\");\n  var discussionPageUrl = new XWiki.Document(discussionPageReference).getURL('get');\n  var changeRequestId = $('.cr-main-div').attr('data-changerequest-id');\n  \n  var retrieveMessage = function (data) {\n    var messageReference = data.messageReference;\n    $.get(discussionPageUrl, {\n      messageReference: messageReference,\n      form_token: xm.form_token,\n      outputSyntax: 'plain',\n      changeRequestId: changeRequestId\n    }).done(function (data) {\n      var discussionContent = $(data);\n      $('#discussions').append(discussionContent);\n      $(document).trigger('xwiki:dom:updated', {elements: $('#discussions').toArray()});\n    }).fail(function (data) {\n       console.error(\"Error while trying to retrieve message: \" + messageReference);\n       console.log(data);\n    });\n  };\n  \n  return {\n    retrieveMessage\n  };\n});</code>\n    </property>\n    <property>\n      <name>Discussion handler</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>7</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>b7c6493f-b4dd-4a49-ad84-0ea565d588ea</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\ndefine('CommentEditor', ['jquery', 'xwiki-meta', 'ChangeRequestDiscussionHandler', 'bootstrap', 'xwiki-events-bridge'], function ($, xm, DiscussionHandler) {\n  var commentEditor = function (element, requestData) {\n    var self = this;\n    self.element = element;\n    self.requestData = requestData;\n    var currentReference = xm.documentReference;\n    var changeRequestDiscussionRef = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestDiscussion\");\n    self.postUrl = new XWiki.Document(changeRequestDiscussionRef).getURL('get');\n    \n    self.requestEditor = function(originButton) {\n      var notification = new XWiki.widgets.Notification('Requesting discussion modal...','inprogress');\n      var params = {\n        'action': 'displayEditor',\n        'form_token': xm.form_token\n      };\n      $.extend(params, self.requestData)\n      $.post(self.postUrl, params).done(function (data) {\n        notification.hide();\n        self.initEditor(data, originButton);\n      }).fail(function (data) {\n        notification.replace(new XWiki.widgets.Notification('Error while getting discussion information.','error'));\n      });\n    };\n    \n    self.submitAction = function () {\n      var button = $(this);\n      var form = button.parent('form');\n      var url = form.attr('action');\n      var notification = new XWiki.widgets.Notification('Submitting message...','inprogress');\n      // We need to call beforeSave first to put the data in the actual content field.\n      $(document).trigger('xwiki:actions:beforeSave');\n      var data = form.serialize();\n      $(document).trigger('xwiki:actions:cancel');\n      $.post(url, data).done(function (data) {\n        notification.replace(new XWiki.widgets.Notification('Message submitted with success.','success'));\n        $(document).trigger('xwiki:changerequest:refreshTimeline');\n        DiscussionHandler.retrieveMessage(data);\n        self.editorDiv.remove();\n      }).fail(function (data) {\n        console.error(data);\n        notification.replace(new XWiki.widgets.Notification('Error while submitting message.','error'));\n      });\n    };\n    \n    self.cancelAction = function () {\n      $(document).trigger('xwiki:actions:cancel');\n      self.editorDiv.remove();\n    };\n    \n    var getLine = function (element) {\n      var parent;\n      if (element.prop('tagName') === 'TR') {\n        parent = element;\n      } else {\n        parent = element.parents('tr');\n      }\n      return parent;\n    }\n    \n    self.initEditor = function (data, originButton) {\n      if (self.requestData.type == 'diffLine') {\n        var currentLine = getLine(self.element);\n        if (currentLine.next('.discussion-line').length) {\n          currentLine = currentLine.next();\n        }\n        var newLine = $('&lt;tr class=\"discussion-line discussion-editor\"&gt;&lt;td colspan=\"3\"&gt;&lt;/td&gt;&lt;/tr&gt;');\n        newLine.insertAfter(currentLine);\n        newLine.find('td').append($(data));\n        self.editorDiv = newLine;\n      } else if (self.requestData.type == 'comment') {\n        self.editorDiv = $('&lt;div&gt;');\n        self.editorDiv.append($(data));\n        $('.add-comment').prepend(self.editorDiv);\n      } else if (self.requestData.type == 'replyTo') {\n        var originalMessageReference = self.requestData.originalMessage;\n        var originalMessage = $(originButton).parents('.message').first();\n        self.editorDiv = $('&lt;div&gt;');\n        self.editorDiv.append($(data));\n        self.editorDiv.insertAfter(originalMessage);\n      }\n      $(document).trigger('xwiki:dom:updated', {'elements': self.editorDiv.toArray()});\n      self.editorDiv.find('.comment-button').on('click', self.submitAction);\n      self.editorDiv.find('.cancel-button').on('click', self.cancelAction);\n    }\n  }\n  return commentEditor;\n})</code>\n    </property>\n    <property>\n      <name>Comment editor</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>8</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>7fa8865f-d219-44cf-b53b-4751e6b4701d</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['CommentEditor', 'DiffSnippet', 'jquery', 'xwiki-meta'], function (CommentEditor, DiffSnippet, $, xm) {\n  var sheetConfig = JSON.parse($('#changerequest-sheet-jsx-config').text());\n  var hasLineNumber = function (element) {\n    return (element.hasClass('diff-line-number') &amp;&amp; element.text() !== \"\");\n  }\n  var getLine = function (element) {\n    var parent;\n    if (element.prop('tagName') === 'TR') {\n      parent = element;\n    } else {\n      parent = element.parents('tr');\n    }\n    return parent;\n  }\n  var getLineNumber = function (element) {\n    var siblings = getLine(element).find('.diff-line-number');\n    for (var i = 0; i &lt; siblings.length; i++) {\n      var sibling = $(siblings[i]);\n      if (hasLineNumber(sibling)) {\n        return sibling.text();\n      }\n    }\n  }\n  var getChangeType = function (element) {\n    var diffLine = getLine(element).find('.diff-line');\n    if (diffLine.hasClass('diff-line-deleted')) {\n      return \"REMOVED\";\n    } else if (diffLine.hasClass('diff-line-added')) {\n      return \"ADDED\";\n    } else if (diffLine.hasClass('diff-line-context')) {\n      return \"UNCHANGED\";\n    }\n  }\n  \n  // this function returns an array of two element:\n  // first element is the entity reference,\n  // second element is the diffBlockId\n  var getEntityReferenceAndDiffBlock = function (element) {\n    var diffBlockId = element.parents('.diff-container').parent().prev('.diff-header').attr('data-property-name');\n    var entityReference = element.parents('.diff-group').children('dt').first().attr('data-reference');\n    return [entityReference, diffBlockId];\n  }\n  \n  var initialize = function() {\n    if (sheetConfig.hasCommentRight) {\n      $('.diff-container td.diff-line-number').addClass('changerequest-commentable');\n      $('.diff-container td.diff-line-number').on('click', function () {\n        var diffBody = $(this).parents('.diff-body');\n        var diffId = diffBody.attr('data-diffid');\n        var targetReference = diffBody.attr('data-documentreference');\n        var documentParts = getEntityReferenceAndDiffBlock($(this));\n        var lineNumber = getLineNumber($(this));\n        var changeType = getChangeType($(this));\n        var changeRequestId = $(this).parents('.cr-main-div').attr('data-changerequest-id');\n        var lineElement = $(this).parent('tr');\n        var unifiedDiffBlock = new DiffSnippet(lineElement);\n        var editor = new CommentEditor($(this), {\n          'type': 'diffLine',\n          'changeRequestId': changeRequestId,\n          'diffId': diffId,\n          'lineNumber': lineNumber,\n          'changeType': changeType,\n          'targetReference': targetReference,\n          'entityReference': documentParts[0],\n          'diffBlockId': documentParts[1],\n          'diffBlockContext': JSON.stringify(unifiedDiffBlock)\n        });\n        editor.requestEditor();\n      });\n    }\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n});</code>\n    </property>\n    <property>\n      <name>Diff comment</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>9</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>9d738b95-e0e7-4882-a98e-1da0cefa97b0</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta'], function ($, xm) {\n  var placeDiscussions = function (index, element) {\n    var discussion = $(element).clone();\n    if (discussion.find('.message').length &gt; 0) {\n      var entityType = discussion.attr('data-type');\n      if (entityType === 'LINE_DIFF') {\n        placeLineDiffDiscussion(discussion);\n      } else if (entityType === 'CHANGE_REQUEST_COMMENT') {\n        placeCommentDiscussion(discussion);\n      } else if (entityType == 'REVIEW') {\n        placeReviewDiscussion(discussion);\n      }\n    }\n  };\n  \n  var placeReviewDiscussion = function (discussion) {\n    var reviewId = discussion.attr('data-reference');\n    var reviewPanelElement = $('.panel.review[data-reviewid=' + reviewId +']');\n    if (reviewPanelElement &amp;&amp; reviewPanelElement.find('.discussion').length == 0) {\n      var clone = discussion.clone();\n      clone.wrap('&lt;div class=\"panel-body\"&gt;&lt;/div&gt;');\n      clone.addClass('review');\n      reviewPanelElement.append(clone.parent());\n    }\n    var reviewTimelineElement = $('.discussion-holder.review[data-reviewid=' + reviewId +']');\n    if (reviewTimelineElement &amp;&amp; reviewTimelineElement.find('.discussion').length == 0) {\n      var clone = discussion.clone();\n      clone.addClass('review');\n      reviewTimelineElement.append(clone);\n    }\n    discussion.clone().find('.message').each(function (index, message) {\n      placeMessage('review', reviewId, message);\n    });\n  };\n  \n  var placeCommentDiscussion = function (discussion) {\n    discussion.find('.message').each(placeCommentMessage);\n  };\n  \n  var placeCommentMessage = function (index, message) {\n    placeMessage('global-comment', '', message);\n  };\n  \n  var placeMessage = function (cssClass, otherId, message) {\n    var messageId = $(message).attr('data-reference');\n    if (cssClass == 'review') {\n      var discussionElement = $('.discussion.review[data-reference=' + otherId +']');\n    } else {\n      var discussionElement = $('.discussion.'+cssClass+'[data-message-reference=\"'+messageId+'\"]');\n    }\n    var diffBlock = $(message).parent('.discussion').find('.diff-block-metadata');\n    if (discussionElement &amp;&amp; discussionElement.find('.message[data-reference=\"' + messageId+ '\"]').length == 0) {\n      if (diffBlock.length &gt; 0) {\n        newBlock = diffBlock.clone();\n        discussionElement.append(newBlock);\n        newBlock.removeClass('hidden');\n      }\n      discussionElement.append($(message));\n    }\n  };\n  \n  var incrementCounter = function (reference) {\n    var currentCounterSpan = $('.counter[data-documentReference=\"' + reference +'\"]');\n    var counter = parseInt(currentCounterSpan.text()) + 1;\n    currentCounterSpan.text(counter);\n    currentCounterSpan.parent().removeClass('hidden');\n  };\n  \n  var findLineContainer = function (discussion) {\n    var targetReference = discussion.attr('data-targetreference');\n    var diffId = discussion.attr('data-diffid');\n    \n    // try first to find the diff file with same exact id\n    var mainContainer = $('.diff-body[data-diffid=\"' + diffId + '\"]');\n    var outdated = false;\n    var line;\n    \n    // if we did not find it, it means the diff might be outdated, we fallback on the diff concerning same document\n    if (mainContainer.length == 0) {\n      mainContainer = $('.diff-body[data-documentreference=\"' + targetReference + '\"]');\n    }\n    \n    // if we did not find the diff about same document, then it's another issue, we log an error.\n    if (mainContainer.length == 0) {\n      console.error(\"Cannot attach the discussion {0} to the window since there's no diff about {1}. The discussion will remain hidden.\", discussion, targetReference);\n      return;\n    }\n    \n    // Now we have the main container, we need to find if it's about the main document metadata, its xclass or one of its xobject metadata.\n    var entityReference = discussion.attr('data-entityreference');\n    // FIXME: this is a hack to use uppercase characters for entity type, because right now the diff macros\n    // do not use the converter for serializing their references.\n    entityReference = getUpperCaseTypeReference(entityReference);\n    var diffRefContainer = mainContainer.find('.diff-group &gt; dt[data-reference=\"' + entityReference +'\"]');\n    // if we did not find the part of the diff related to the entity reference,\n    // it means that we need to attach the comment to the whole diff.\n    if (diffRefContainer.length == 0) {\n      line = mainContainer;\n      outdated = true;\n    } else {\n      // we have the entity reference diff container, now we can look for the specific property change\n      var diffBlockId = discussion.attr('data-diffblockid');\n      var diffBlockContainer = diffRefContainer.next().find('.diff-header[data-property-name=\"' + diffBlockId + '\"]').next().find('.diff-container');\n      if (diffBlockContainer.length == 0) {\n        line = diffRefContainer;\n        outdated = true;\n      } else {\n        var lineChange = discussion.attr('data-linechange');\n        var lineNumber = discussion.attr('data-linenumber');\n        var searchingClass;\n        if (lineChange === \"ADDED\") {\n          searchingClass = \"diff-line-added\";\n        } else if (lineChange === \"REMOVED\") {\n          searchingClass = \"diff-line-deleted\";\n        } else {\n          searchingClass = \"diff-line-context\";\n        }\n        var filterLine = function () {\n          var node = $(this);\n          return node.text() === lineNumber &amp;&amp; node.parent().find('.diff-line').hasClass(searchingClass);\n        }\n\n        line = diffBlockContainer.find('.diff-line-number:contains(\"' + lineNumber + '\")').filter(filterLine).first().parent();\n\n        // if we did not find the line, then it's outdated and we should attach the discussion to the entity reference container.\n        if (line.length == 0) {\n          line = diffRefContainer;\n          outdated = true;\n        } else {\n          var diffBlockMetadata = discussion.find('.diff-block-metadata');\n          if (diffBlockMetadata.length &gt; 0) {\n            var lastLineContent = diffBlockMetadata.find('.diff-container').find('tr').last().find('td.diff-line').html();\n            var lineContent = line.find('td.diff-line').html();\n            if (lastLineContent != lineContent) {\n              outdated = true;\n            }\n          }\n        }\n      }\n    }\n    return {'line': line, 'outdated': outdated};\n  }\n  \n  var getUpperCaseTypeReference = function (entityReference) {\n    var firstSemicolonIndex = entityReference.indexOf(':');\n    var type = entityReference.substr(0, firstSemicolonIndex);\n    var reference = entityReference.substr(firstSemicolonIndex+1);\n    return type.toUpperCase() + \":\" + reference;\n  };\n  \n  var insertLineDiffDiscussion = function (discussion) {\n    var lineResult = findLineContainer(discussion);\n    if (lineResult &amp;&amp; !lineResult.outdated) {\n      var targetReference = discussion.attr('data-targetreference');\n      var reference = discussion.attr('data-reference');\n      discussion.insertAfter(lineResult.line);\n      if (lineResult.line.parents('table').length &gt; 0) {\n        discussion.wrap('&lt;tr class=\"discussion-line\" data-reference=\"'+reference+'\"&gt;&lt;td colspan=\"3\"&gt;&lt;/td&gt;&lt;/tr&gt;');\n      } else {\n        discussion.wrap('&lt;div class=\"discussion-line\" data-reference=\"'+reference+'\"&gt;&lt;/div&gt;');\n      }\n      discussion.find('.diff-block-metadata').addClass('hidden');\n      incrementCounter(targetReference);\n    } else if (lineResult.outdated) {\n      discussion.addClass('discussion-outdated');\n      discussion.find('.outdated-message').removeClass('hidden');\n    }\n  };\n  \n  var placeLineDiffDiscussion = function (discussion) {\n    var reference = discussion.attr('data-reference');\n    var existingLine = $('.discussion-line[data-reference=\"'+reference+'\"]');\n    if (!existingLine.length) {\n      insertLineDiffDiscussion(discussion);\n    }\n    \n    discussion.clone().find('.message').each(function (index, message) {\n      placeMessage('diff', '', message);\n    });\n  }\n  \n  var placeAllDiscussions = function () {\n    $('#discussions .discussion').each(placeDiscussions);\n    $('#timeline-loading').addClass('hidden');\n    $(document).trigger('xwiki:dom:updated', {'elements': $('#discussions .discussion').toArray()});\n  };\n  \n  var initialize = function () {\n    placeAllDiscussions();\n    $(document).on('xwiki:changerequest:refreshComments', placeAllDiscussions);\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n});</code>\n    </property>\n    <property>\n      <name>Comment placement</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>10</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>18a7666e-e031-4751-aff2-053b23280ec0</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta', 'ChangeRequestDiscussionHandler', 'CommentEditor'], function ($, xm, DiscussionHandler, CommentEditor) {\n\n  var initialize = function () {\n    $('.add-comment .open-editor').on('click', function (event) {\n      var changeRequestId = $(this).parents('.cr-main-div').attr('data-changerequest-id');\n        var editor = new CommentEditor($(this), {\n          'type': 'comment',\n          'changeRequestId': changeRequestId\n        });\n        editor.requestEditor();\n        $(this).addClass('hidden');\n    });\n    $(document).on('xwiki:actions:cancel', function () {\n      $('.add-comment .open-editor').removeClass('hidden');\n    });\n  };\n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n});</code>\n    </property>\n    <property>\n      <name>Comment button</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>11</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>e8669304-a294-423d-bf0f-b2308119fb5e</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta'], function ($, xm) {\n  var cancelled = false;\n  var saveDescription = function (event) {\n    if (cancelled) {\n      return;\n    }\n    event.preventDefault();\n    $(document).trigger('xwiki:actions:cancel');\n    cancelled = true;\n    $(this).trigger('click');\n  };\n  \n  var cancelDescription = function () {\n    $(document).trigger('xwiki:actions:cancel');\n    window.location.href = new XWiki.Document(xm.documentReference).getURL('view');\n  };\n  \n  var initialize = function () {\n    $(\"#save-description\").on('click', saveDescription);\n    $(\"#cancel-description\").on('click', cancelDescription);\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n})</code>\n    </property>\n    <property>\n      <name>description edit</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>12</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>72336573-1eb6-4f44-a970-79e082343d76</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery'], function ($) {\n  var toggleReply = function () {\n    var element = $(this);\n    var originalMessageReference = element.attr('data-message-reference');\n    var selector = '.message[data-reference=\"' + originalMessageReference +'\"]';\n    $('.showMessage').removeClass('showMessage');\n    if ($(selector).parents('.collapse:not(.in)').length &gt; 0) {\n      $(selector).parents('.collapse:not(.in)').addClass('in');\n    }\n    $(selector).addClass('showMessage');\n    $(selector).one('click', function() {\n      $(this).removeClass('showMessage');\n    });\n    $(selector).each(function() {\n      if ($(this).is(':visible')) {\n        $(this).get(0).scrollIntoView();\n      }\n    });\n  };\n  \n  var initReplyNav = function () {\n    $('a[data-message-reference]').on('click', toggleReply);\n  };\n  \n  initReplyNav() || $(document).on('xwiki:dom:updated', initReplyNav);\n});</code>\n    </property>\n    <property>\n      <name>Message navigation</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>13</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>9654e466-9022-4b29-bd2e-28500a41cba9</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta'], function ($, xm) {\n  var editTitle = function () {\n    console.log(\"Edit title\");\n  };\n  \n  var displayButtons = function () {\n    $('.title-button-wrapper').removeClass('hidden');\n  };\n  \n  var cancelTitle = function () {\n    var initValue = $('#cancel-title').attr('data-original-title');\n    $('input#edit-title-input').val(initValue);\n    $('.title-button-wrapper').addClass('hidden');\n  };\n  \n  var initialize = function () {\n    var editTitleForm = $('#crTitleForm');\n    if (editTitleForm.length &gt; 0) {\n      $('#document-title').empty().append(editTitleForm);\n      $('input#edit-title-input').on('focus', displayButtons);\n      $('#cancel-title').on('click', cancelTitle);\n    }\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n});</code>\n    </property>\n    <property>\n      <name>title edit</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>14</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>438daf61-7738-41ef-b6f1-0f95844e539a</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta', 'ChangeRequestDiscussionHandler', 'CommentEditor'], function ($, xm, DiscussionHandler, CommentEditor) {\n  var initReply = function () {\n    $('.message .reply-button:visible').not('.reply-initialized').one('click', function (event) {\n      var changeRequestId = $(this).parents('.cr-main-div').attr('data-changerequest-id');\n      var message = $(this).parents('.message');\n      var discussion = message.parents('.discussion');\n      var discussionType = discussion.attr('data-type');\n      var discussionReference = discussion.attr('data-reference');\n      var messageReference = message.attr('data-reference');\n\n      var editor = new CommentEditor($(this), {\n        'type': 'replyTo',\n        'changeRequestId': changeRequestId,\n        'originalMessage': messageReference,\n        'originalDiscussionType': discussionType,\n        'originalDiscussionReference': discussionReference\n      });\n      editor.requestEditor(event.target);\n    });\n    $('.message .reply-button:visible').not('.reply-initialized').addClass('reply-initialized');\n  };\n  \n  var initialize = function () {\n    initReply();\n    $(document).on('xwiki:dom:updated', initReply);\n    $('a[data-toggle=\"tab\"][href=\"#reviews\"]').on('shown.bs.tab', initReply);\n    $('.diff-panel').on('shown.bs.collapse', initReply);\n  };\n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n});</code>\n    </property>\n    <property>\n      <name>Reply button</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>15</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>3235c726-bceb-4295-b6ef-bda8793f2b16</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'bootstrap'], function ($) {\n  var initTabNavigation = function () {\n    $('a[data-tab]').on('click', function() {\n      var tabName = $(this).attr('data-tab');\n      var selector = '#changeRequestTabs a[href=\"#' + tabName + '\"]';\n      $(selector).tab('show');\n    })\n  };\n  \n  initTabNavigation() &amp;&amp; $(document).on('xwiki:dom:updated', initTabNavigation);\n});</code>\n    </property>\n    <property>\n      <name>tab navigation</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>16</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>089266bd-a2ff-49a5-a696-fd00a644a881</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta'], function ($, xm) {\n  var currentReference = xm.documentReference;\n  var timelinePageRef = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestTimeline\");\n  var timelinePageUrl = new XWiki.Document(timelinePageRef).getURL('get');\n  var changeRequestId = $('.cr-main-div').attr('data-changerequest-id');\n  \n  var refreshTimeline = function() {\n    $('#timeline-loading').removeClass('hidden');\n    var data = {\n      form_token: xm.form_token,\n      changerequest: changeRequestId,\n      outputSyntax: 'plain'\n    };\n    $.get(timelinePageUrl, data).done(function (data) {\n      var timelineHolder = $('#timeline-content');\n      timelineHolder.empty();\n      timelineHolder.append(data);\n      $(document).trigger('xwiki:changerequest:refreshComments');\n      $(document).trigger('xwiki:dom:updated', {'elements': timelineHolder.toArray()});\n    }).fail(function (data) {\n       console.error(\"Error while trying to refresh the timeline: \" + data);\n       console.log(data);\n    });\n  }\n  \n  $(document).on('xwiki:changerequest:refreshTimeline', function () {\n    setTimeout(refreshTimeline, 1000);\n  });\n});</code>\n    </property>\n    <property>\n      <name>Timeline refresh</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>17</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>7b5b0265-f7db-47d5-b65a-cb376331b111</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery', 'SaveChangeRequestModal'], function ($, SaveChangeRequestModal) {\n  var initializeEditApprovers = function () {\n    var saveChangeRequestModal = new SaveChangeRequestModal('changerequest-edit-approvers-config');\n    var editApproversLinks = $('a.action_editapprovers').not('.js-augmented');\n    editApproversLinks.on('click', function(event) {\n      event.preventDefault();\n      // FIXME: this is clearly fragile and would need to be based on a proper data-attribute in the future.\n      var targetReference = $(event.target).parents('td.cell').siblings().find('ol.breadcrumb').attr('data-entity');\n      var changeRequest = $(event.target).parents('div.cr-main-div').attr('data-changerequest-id');\n      var data = {\n        'changerequest': changeRequest,\n        'docChange': targetReference,\n        'explicitDocInfo': 1\n      };\n      saveChangeRequestModal.openModal(data);\n    });\n    editApproversLinks.addClass('js-augmented');\n  };\n  \n  // We use a timeout because this is initialized after the afterEntryFetch is sent and before the LD is displayed\n  setTimeout(initializeEditApprovers, 500);\n  $(document).on('xwiki:livedata:entriesUpdated', initializeEditApprovers);\n  // The new livedata entriesUpdated event has been introduced in XWiki 14.8,\n  // we still keep the old event listener for backward compatibility.\n  $(document).on('xwiki:livedata:afterEntryFetch', function() {\n    setTimeout(initializeEditApprovers, 500);\n  });\n});</code>\n    </property>\n    <property>\n      <name>Edit approvers</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>18</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>c0ff9796-7c57-418a-a3ad-bbcbd9d3b045</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery', 'xwiki-meta'], function ($, xm) {\n  var currentReference = xm.documentReference;\n  var renderedDiffPageRef = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestRenderedDiff\");\n  var renderedDiffPageUrl = new XWiki.Document(renderedDiffPageRef).getURL('get');\n  var changeRequestId = $('.cr-main-div').attr('data-changerequest-id');\n  \n  var loadRenderedDiff = function (container) {\n    var filechangeId = container.attr('data-filechangeid');\n    var data = {\n      form_token: xm.form_token,\n      changerequest: changeRequestId,\n      outputSyntax: 'plain',\n      filechangeId: filechangeId,\n      action: 'htmlDiff'\n    };\n    var tabPanel = container.find('.tab-pane.html-diff');\n    tabPanel.addClass('loading').load(renderedDiffPageUrl, data, function() {\n      tabPanel.removeClass('loading');\n      $(document).trigger('xwiki:dom:updated', {'elements': tabPanel.toArray()});\n    });\n  };\n  \n  var initializeRenderedDiff = function () {\n    $('.changes-body a[data-hint=\"rendered\"]').on('click', function (event) {\n      var container = $(event.target).parents('.changes-body');\n      if (!container.hasClass('rendered-loaded')) {\n        loadRenderedDiff(container);\n      }\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initializeRenderedDiff()) || $(document).on('xwiki:dom:loading', initializeRenderedDiff);\n});</code>\n    </property>\n    <property>\n      <name>Load rendered diff</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>19</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>19e9c5a1-c6f3-4218-9419-41e9f8d9dbed</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\ndefine('DiffSnippet', ['jquery', 'xwiki-meta'], function ($, xm) {\n  const TYPE_ADDED = 'ADDED';\n  const TYPE_DELETED = 'DELETED';\n  const TYPE_CONTEXT = 'CONTEXT'; // used for diff element only\n  const TYPE_UNMODIFIED = 'UNMODIFIED'; // used for chunks only\n  const ADD_BEGIN = '&lt;ins&gt;';\n  const ADD_END = '&lt;/ins&gt;';\n  const DEL_BEGIN = '&lt;del&gt;';\n  const DEL_END = '&lt;/del&gt;';\n  const CONTEXT_SIZE = 3;\n  \n  var getChunk = function (type, elements) {\n    var deleted = type == TYPE_DELETED;\n    var added = type == TYPE_ADDED;\n    var unmodified = type == TYPE_UNMODIFIED;\n    return {\n      'type': type,\n      'elements': elements.split(\"\"),\n      'added': added,\n      'deleted': deleted,\n      'unmodified': unmodified\n    }\n  };\n  \n  var getDiffElement = function (index, type, value, chunks) {\n    var deleted = type == TYPE_DELETED;\n    var added = type == TYPE_ADDED;\n    return {\n      'index': index,\n      'type': type,\n      'value': value,\n      'chunks': chunks,\n      'added': added,\n      'deleted': deleted\n    }\n  };\n  \n  var getDiffElementType = function (tdLine) {\n    if (tdLine.hasClass('diff-line-added')) {\n      return TYPE_ADDED;\n    } else if (tdLine.hasClass('diff-line-deleted')) {\n      return TYPE_DELETED;\n    } else {\n      return TYPE_CONTEXT;\n    }\n  };\n  \n  var getIndex = function (trLineElement, type) {\n    var tdIndexElement;\n    if (type == TYPE_CONTEXT || type == TYPE_DELETED) {\n      tdIndexElement = $(trLineElement).find('td.diff-line-number').first();\n    } else {\n      tdIndexElement = $(trLineElement).find('td.diff-line-number').last();\n    }\n    return parseInt(tdIndexElement.text(), 10) - 1;\n  };\n  \n  var buildChunks = function (htmlValue) {\n    return consumeChunk(htmlValue, []);\n  };\n  \n  var consumeChunk = function (htmlString, chunkArray) {\n    var nextAddition = htmlString.indexOf(ADD_BEGIN);\n    var nextDeletion = htmlString.indexOf(DEL_BEGIN);\n    if (nextAddition == -1 &amp;&amp; nextDeletion == -1) {\n      if (chunkArray.length &gt; 0) {\n        chunkArray.push(getChunk(TYPE_UNMODIFIED, htmlString));\n        return chunkArray;\n      } else {\n        return null;\n      }\n    } else if (nextAddition == -1 || (nextDeletion != -1 &amp;&amp; nextDeletion &lt; nextAddition)) {\n      var indexBegin = nextDeletion;\n      var newHtmlString = consumeSingleChunk(htmlString, indexBegin, TYPE_DELETED, chunkArray);\n      if (newHtmlString.length &gt; 0) {\n        return consumeChunk(newHtmlString, chunkArray);\n      } else {\n        return chunkArray;\n      }\n    } else {\n      var indexBegin = nextAddition;\n      var newHtmlString = consumeSingleChunk(htmlString, indexBegin, TYPE_ADDED, chunkArray);\n      if (newHtmlString.length &gt; 0) {\n        return consumeChunk(newHtmlString, chunkArray);\n      } else {\n        return chunkArray;\n      }\n    }\n  }\n  \n  var consumeSingleChunk = function (htmlElement, indexBegin, type, chunkArray) {\n    if (indexBegin != 0) {\n      var contextValue = htmlElement.substring(0, indexBegin);\n      chunkArray.push(getChunk(TYPE_UNMODIFIED, contextValue));\n    }\n    var beginValueIndex;\n    var endValueIndex;\n    var indexEnd;\n    if (type == TYPE_ADDED) {\n      beginValueIndex = indexBegin + ADD_BEGIN.length;\n      endValueIndex = htmlElement.indexOf(ADD_END);\n      indexEnd = endValueIndex + ADD_END.length;\n    } else {\n      beginValueIndex = indexBegin + DEL_BEGIN.length;\n      endValueIndex = htmlElement.indexOf(DEL_END);\n      indexEnd = endValueIndex + DEL_END.length;\n    }\n    chunkArray.push(getChunk(type, htmlElement.substring(beginValueIndex, endValueIndex)));\n    return htmlElement.substring(indexEnd);\n  }\n  \n  var buildDiffElement = function (trLineElement) {\n    var tdLine = $(trLineElement).find('td.diff-line');\n    var type = getDiffElementType(tdLine);\n    var index = getIndex(trLineElement, type);\n    // We need to remove first character because it's added to display +/-\n    // or space in case of context line\n    var value = tdLine.text().substring(1);\n    var htmlValue = tdLine.html().substring(1);\n    var chunks = buildChunks(htmlValue);\n    return getDiffElement(index, type, value, chunks);\n  }\n\n  var diffSnippet = function (trLineElement) {\n    var diffElements = [buildDiffElement(trLineElement)];\n    var currentElement = trLineElement;\n    for (i = CONTEXT_SIZE; i &gt; 0; i--) {\n      var prevElement = currentElement.prev('tr');\n      // If the line contains \"diff-line-meta\" then it's the first one and we should ignore it.\n      if (prevElement.length &gt; 0 &amp;&amp; prevElement.has('td.diff-line-meta').length == 0) {\n        diffElements.unshift(buildDiffElement(prevElement));\n        currentElement = prevElement;\n      } else {\n        break;\n      }\n    }\n    return diffElements;\n  };\n  return diffSnippet;\n})</code>\n    </property>\n    <property>\n      <name>Unified diff block</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>20</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>75e167fb-d8b5-4c51-8043-eab838c50546</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery', 'xwiki-meta'], function ($, xm) {\n  var confirmRefresh = function (event, sheetConfig) {\n    if (sheetConfig.hasValidReviews) {\n      if (!confirm(sheetConfig.confirmRefreshTranslation)) {\n        event.preventDefault();\n      }\n    }\n  };\n  \n  var initializeListeners = function () {\n    var sheetConfig = JSON.parse($('#changerequest-sheet-jsx-config').text());\n    $('a.action_rebase').on('click', function(event) {\n      return confirmRefresh(event, sheetConfig);\n    });\n    $('li.cr-rebase a').on('click', function(event) {\n      return confirmRefresh(event, sheetConfig);\n    });\n  };\n  \n  var initializeConfirmRefresh = function() {\n    initializeListeners();\n    $(document).on('xwiki:dom:updated', initializeListeners);\n    $(document).on('xwiki:livedata:entriesUpdated', initializeListeners);\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initializeConfirmRefresh()) || $(document).on('xwiki:dom:loading', initializeConfirmRefresh);\n});</code>\n    </property>\n    <property>\n      <name>confirm refresh</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>21</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>53cf8408-f5fb-4914-9b03-7b79f67a1633</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery'], function ($) {\n  var switchButton = function (element, isExpanded) {\n    var heading = $(element).siblings('.panel-heading');\n    if (isExpanded) {\n      $(heading).find('.button-expand').addClass('hidden');\n      $(heading).find('.button-collapse').removeClass('hidden');\n    } else {\n      $(heading).find('.button-collapse').addClass('hidden');\n      $(heading).find('.button-expand').removeClass('hidden');\n    }\n  };\n  \n  var initializeSwitchCollapse = function() {\n    $('.diff-panel').on('show.bs.collapse', function () {\n      switchButton($(this), true);\n    });\n    $('.diff-panel').on('hide.bs.collapse', function () {\n      switchButton($(this), false);\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initializeSwitchCollapse()) || $(document).on('xwiki:dom:loading', initializeSwitchCollapse);\n});</code>\n    </property>\n    <property>\n      <name>collapse filechange</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>22</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>9d035854-bc03-44b8-8ef3-a4ceac4a2b34</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery', 'bootstrap'], function ($) {\n  var initializeCheckConflictLink = function() {\n    $('.check-conflict-link').on('click', function() {\n      $('#changeRequestTabs a[href=\"#filechanges\"]').tab('show');\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initializeCheckConflictLink()) || $(document).on('xwiki:dom:loading', initializeCheckConflictLink);\n});</code>\n    </property>\n    <property>\n      <name>check conflict link</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>23</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>c92dfe04-dfa6-4db4-9814-1cd44764c23f</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery'], function ($) {\n  var initializeDiffReferenceDetailsSwitch = function() {\n    $('.diff-reference-details-switch').on('click', function () {\n      $(this).siblings('.diff-reference-details').toggleClass('hidden');\n    });\n  };\n  \n  $(document).on('xwiki:dom:updated', initializeDiffReferenceDetailsSwitch);\n});</code>\n    </property>\n    <property>\n      <name>collapse diff reference details</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>currentPage</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>24</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>fb94aba1-40d8-4a65-9fd7-a6e5e6aefdc3</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery', 'xwiki-meta'], function ($, xm) {\n  var confirmSplit = function (event, sheetConfig) {\n    event.preventDefault();\n    if (confirm(sheetConfig.confirmSplitTranslation)) {\n      var query = \"?form_token=\" + xm.form_token + \"&amp;confirm=1\";\n      window.location = event.target.href + query;\n    }\n  };\n  \n  var initializeConfirmSplit = function() {\n    var sheetConfig = JSON.parse($('#changerequest-sheet-jsx-config').text());\n    $('#splitcr').on('click', function(event) {\n      return confirmSplit(event, sheetConfig);\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initializeConfirmSplit()) || $(document).on('xwiki:dom:loading', initializeConfirmSplit);\n});</code>\n    </property>\n    <property>\n      <name>confirm split</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>currentPage</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>0</number>\n    <className>XWiki.StyleSheetExtension</className>\n    <guid>573c678e-d12c-4ef9-a8ed-f8be4e011d1a</guid>\n    <class>\n      <name>XWiki.StyleSheetExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>6</number>\n        <prettyName>Content Type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>CSS|LESS</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>.review-date {\n  float: right;\n}\n.outdated {\n  float: right;\n  margin-left: 10px;\n}\n.tab-content.change-request-sheet &gt; .tab-pane.active {\n  margin-top: 1em;\n}\n#discussion-comments {\n  border: 1px dashed #dbdbdb;\n  padding: 1em;\n}\n.edit-description, .edit-title {\n  float: right;\n}\n.description-placeholder {\n  color: #7b7b7b;\n}\nh1.editable {\n  /* Move the title heading a bit to the top and to the left in order to accomodate the input border and padding. */\n  margin-top: -@line-height-computed / 4;\n  margin-left: -(ceil(@grid-gutter-width / 2));\n  /* Reduce the bottom margin in order to accomodate the input border and bottom padding. */\n  margin-bottom: @line-height-computed / 4;\n}\n\n@edit-title-input-padding-vertical: @line-height-computed / 4 - 1;\ninput#edit-title-input {\n  /* Preserve the heading styles. */\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  box-shadow: none;\n  color: inherit;\n  font-size: inherit;\n  /* It seems it's not enough to set the line height for the text input. We also need to set its height. */\n  height: @font-size-document-title * @headings-line-height + 2 * (1 + @edit-title-input-padding-vertical);\n  line-height: @headings-line-height;\n  padding: @edit-title-input-padding-vertical (ceil(@grid-gutter-width / 2) - 1);\n  width: 97%;\n  display: inline;\n}\n\n.edit-title-icon {\n  position: absolute;\n  left: 90%;\n  font-size: 0.5em;\n  line-height: 3em;\n}\n\ninput#edit-title-input:hover {\n  border-color: @input-border;\n}\n\ninput#edit-title-input:focus, .edit-title-icon:hover {\n  .form-control-focus();\n}\n.title-button-wrapper {\n  float: right;\n}\n.panel-default.disabled &gt; .panel-heading {\n  color: #8e8e8e;\n}\n#timeline-loading {\n  float: right;\n  width: 25px;\n}</code>\n    </property>\n    <property>\n      <contentType>LESS</contentType>\n    </property>\n    <property>\n      <name>sheet</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>currentPage</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>1</number>\n    <className>XWiki.StyleSheetExtension</className>\n    <guid>14ca3d0f-4ea2-4e87-9096-c36a3dad7f3a</guid>\n    <class>\n      <name>XWiki.StyleSheetExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>6</number>\n        <prettyName>Content Type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>CSS|LESS</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>/* Variables */\n\n@background: white;\n@color-primary: grey;\n@color-light: #d7d6d6;\n@color-dim: #6c6d6d;\n@color-success: green;\n@color-warning: orange;\n@spacing: 35px;\n@radius: 4px;\n\n@icon-height: 14px;\n@avatar: 80px;\n@dotborder: 2px;\n@dot: 32px;\n@line: 1px;\n\n#timeline-content {\n  margin-top: @spacing;\n  text-align: center;  \n}\n\n/* Timeline */\n\n.timeline {\n  border-left: @line solid @color-light;\n  border-bottom-right-radius: @radius;\n  border-top-right-radius: @radius;\n  margin: @spacing auto;  \n  position: relative;\n  line-height: 1.4em;\n  padding: @spacing;   \n  list-style: none;\n  text-align: left;  \n  max-width: 70%;\n  \n  .event {\n    border-bottom: 1px dashed @color-light;\n    margin-bottom: @spacing;  \n    position: relative;\n    min-height: 50px;\n\n    &amp;:last-of-type { \n      padding-bottom: 0;\n      margin-bottom: 0; \n      border: none;      \n    }\n\n    .event-icon {\n      position: absolute;\n      display: flex;\n      top: 0;\n      box-shadow: 0 0 0 @dotborder fade(@color-light,100%);\n      left: (@spacing + @line + (@dot * 0.5)) * -1;\n      background: lighten(@background,5%);\n      border-radius: 50%;\n      height: @dot;\n      width: @dot;\n      color: @color-primary;\n      \n      span {\n        margin: auto;\n      }\n    }\n    \n    .icon-success {\n      color: @color-success;\n    }\n      \n    .icon-warning {\n      color: @color-warning;\n    }\n\n    .content, .date {\n      position: relative;\n      left: (@avatar * 0.4) * -1;\n    }\n\n    .user-event.user-avatar {\n      left: ((@avatar * 0.6) + @spacing + @line + @dot + (@dotborder * 2)) * -1;\n      color: fade(@color-light, 40%);\n      text-align: right;\n      position: relative;\n      top: -0.5em;\n      float: left;\n\n      img {\n        width: @avatar * 0.5;\n      }\n    }\n    \n    .discussion .diff-container {\n      width: 100%;\n    }\n  }\n}</code>\n    </property>\n    <property>\n      <contentType>LESS</contentType>\n    </property>\n    <property>\n      <name>timeline</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>2</number>\n    <className>XWiki.StyleSheetExtension</className>\n    <guid>12f95fb8-3061-431f-9f40-5a038fb099b7</guid>\n    <class>\n      <name>XWiki.StyleSheetExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>6</number>\n        <prettyName>Content Type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>CSS|LESS</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>@highlighted: rgba(255, 255, 0, 0.2);\n@dotborder: 2px;\n@dot: 32px;\n\n.diff-container td.changerequest-commentable {\n  cursor: pointer;\n}\n.diff-container tr:hover td.changerequest-commentable {\n  background: @highlighted;\n}\n.diff-labels {\n  float: right;\n\n  .label {\n    margin: 5px;\n  }\n}\n.diff-reference-details-switch {\n  float: right;\n  cursor: pointer;\n}\n.diff-reference-details {\n  margin-top: 5px;\n  padding-top: 5px;\n  border-top: 1px dashed lightgrey;\n  font-weight: normal;\n}</code>\n    </property>\n    <property>\n      <contentType>LESS</contentType>\n    </property>\n    <property>\n      <name>diff</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>3</number>\n    <className>XWiki.StyleSheetExtension</className>\n    <guid>d7e2c257-896a-49ce-9575-4f08ee3986fa</guid>\n    <class>\n      <name>XWiki.StyleSheetExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>6</number>\n        <prettyName>Content Type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>CSS|LESS</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>.discussion {\n  width: 75%;\n}\n.message {\n  border: 1px solid lightgrey;\n  margin: 1em;\n  border-top-left-radius: 1em;\n  border-top-right-radius: 1em;\n  border-bottom-left-radius: 1em;\n  border-bottom-right-radius: 1em;\n}\n.message-metadata {\n  border-top-left-radius: 1em;\n  border-top-right-radius: 1em;\n  padding: 1em;\n  border-bottom: 1px dotted lightgrey;\n}\n.showMessage &gt; .message-metadata {\n  background-color: #fffbc3;\n}\n.message-content {\n  padding: 1em;\n  border-bottom-left-radius: 1em;\n  border-bottom-right-radius: 1em;\n}\n.message-badges {\n  float: right;\n}\n.reply-to-header {\n  padding: 1em;\n  border-bottom: 1px dotted lightgrey;\n  \n  .reply-to-navigation {\n    float: right;\n  }\n}</code>\n    </property>\n    <property>\n      <contentType>LESS</contentType>\n    </property>\n    <property>\n      <name>Discussions</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>0</number>\n    <className>XWiki.UIExtensionClass</className>\n    <guid>ad7486e2-242f-4f22-8875-2b93ad9852b9</guid>\n    <class>\n      <name>XWiki.UIExtensionClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <async_cached>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_cached</name>\n        <number>3</number>\n        <prettyName>Cached</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_cached>\n      <async_context>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>1</multiSelect>\n        <name>async_context</name>\n        <number>4</number>\n        <prettyName>Context elements</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>, </separator>\n        <separators>|, </separators>\n        <size>5</size>\n        <unmodifiable>0</unmodifiable>\n        <values>action=Action|doc.reference=Document|icon.theme=Icon theme|locale=Language|rendering.defaultsyntax=Default syntax|rendering.restricted=Restricted|rendering.targetsyntax=Target syntax|request.base=Request base URL|request.cookies|request.headers|request.parameters=Request parameters|request.remoteAddr|request.url=Request URL|request.wiki=Request wiki|user=User|wiki=Wiki</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </async_context>\n      <async_enabled>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_enabled</name>\n        <number>2</number>\n        <prettyName>Asynchronous rendering</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_enabled>\n      <content>\n        <disabled>0</disabled>\n        <editor>Text</editor>\n        <name>content</name>\n        <number>1</number>\n        <prettyName>Executed Content</prettyName>\n        <restricted>0</restricted>\n        <rows>25</rows>\n        <size>120</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </content>\n      <extensionPointId>\n        <disabled>0</disabled>\n        <name>extensionPointId</name>\n        <number>5</number>\n        <prettyName>Extension Point ID</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </extensionPointId>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>6</number>\n        <prettyName>Extension ID</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parameters>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>parameters</name>\n        <number>7</number>\n        <prettyName>Extension Parameters</prettyName>\n        <restricted>0</restricted>\n        <rows>10</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </parameters>\n      <scope>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>scope</name>\n        <number>8</number>\n        <prettyName>Extension Scope</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>wiki=Current Wiki|user=Current User|global=Global</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </scope>\n    </class>\n    <property>\n      <async_cached>0</async_cached>\n    </property>\n    <property>\n      <async_context/>\n    </property>\n    <property>\n      <async_enabled>0</async_enabled>\n    </property>\n    <property>\n      <content>{{velocity}}\n#set ($changeRequestId = $doc.documentReference.lastSpaceReference.name)\n#set ($changeRequestOpt = $services.changerequest.getChangeRequest($changeRequestId))\n#if ($changeRequestOpt.isPresent())\n#set ($status = $doc.getValue('status'))\n#if ($status == 'draft')\n  #set ($statusClass = \"default\")\n#elseif ($status == 'merged')\n  #set ($statusClass = \"success\")\n#elseif ($status == 'ready_for_review')\n  #set ($statusClass = \"info\")\n#elseif ($status == 'ready_for_merging')\n  #set ($statusClass = \"primary\")\n#elseif ($status == 'closed' || $status == 'stale')\n  #set ($statusClass = \"danger\")\n#end\n\n{{html}}\n&lt;span class=\"label label-$statusClass\"&gt;$doc.display('status')&lt;/span&gt;\n{{/html}}\n#end\n{{/velocity}}</content>\n    </property>\n    <property>\n      <extensionPointId>org.xwiki.platform.template.title.before</extensionPointId>\n    </property>\n    <property>\n      <name>org.xwiki.contrib.changerequest.title.status</name>\n    </property>\n    <property>\n      <parameters/>\n    </property>\n    <property>\n      <scope>wiki</scope>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>1</number>\n    <className>XWiki.UIExtensionClass</className>\n    <guid>e6d567c6-41f3-4059-992c-9bc02306bbab</guid>\n    <class>\n      <name>XWiki.UIExtensionClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <async_cached>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_cached</name>\n        <number>3</number>\n        <prettyName>Cached</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_cached>\n      <async_context>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>1</multiSelect>\n        <name>async_context</name>\n        <number>4</number>\n        <prettyName>Context elements</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>, </separator>\n        <separators>|, </separators>\n        <size>5</size>\n        <unmodifiable>0</unmodifiable>\n        <values>action=Action|doc.reference=Document|icon.theme=Icon theme|locale=Language|rendering.defaultsyntax=Default syntax|rendering.restricted=Restricted|rendering.targetsyntax=Target syntax|request.base=Request base URL|request.cookies|request.headers|request.parameters=Request parameters|request.remoteAddr|request.url=Request URL|request.wiki=Request wiki|user=User|wiki=Wiki</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </async_context>\n      <async_enabled>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_enabled</name>\n        <number>2</number>\n        <prettyName>Asynchronous rendering</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_enabled>\n      <content>\n        <disabled>0</disabled>\n        <editor>Text</editor>\n        <name>content</name>\n        <number>1</number>\n        <prettyName>Executed Content</prettyName>\n        <restricted>0</restricted>\n        <rows>25</rows>\n        <size>120</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </content>\n      <extensionPointId>\n        <disabled>0</disabled>\n        <name>extensionPointId</name>\n        <number>5</number>\n        <prettyName>Extension Point ID</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </extensionPointId>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>6</number>\n        <prettyName>Extension ID</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parameters>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>parameters</name>\n        <number>7</number>\n        <prettyName>Extension Parameters</prettyName>\n        <restricted>0</restricted>\n        <rows>10</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </parameters>\n      <scope>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>scope</name>\n        <number>8</number>\n        <prettyName>Extension Scope</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>wiki=Current Wiki|user=Current User|global=Global</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </scope>\n    </class>\n    <property>\n      <async_cached>0</async_cached>\n    </property>\n    <property>\n      <async_context/>\n    </property>\n    <property>\n      <async_enabled>0</async_enabled>\n    </property>\n    <property>\n      <content>{{velocity}}\n#set ($changeRequestId = $doc.documentReference.lastSpaceReference.name)\n#set ($changeRequestOpt = $services.changerequest.getChangeRequest($changeRequestId))\n#if ($changeRequestOpt.isPresent())\n#set ($changeRequest = $changeRequestOpt.get())\n#set ($isAuthorizedToMerge = $services.changerequest.authorization.isAuthorizedToMerge($changeRequest))\n#set ($closeUrl = \"$services.changerequest.getChangeRequestURL('save', $changeRequestId)?status=closed&amp;form_token=$services.csrf.token\")\n#set ($readyForReviewUrl = \"$services.changerequest.getChangeRequestURL('save', $changeRequestId)?status=ready_for_review&amp;form_token=$services.csrf.token\")\n#set ($draftUrl = \"$services.changerequest.getChangeRequestURL('save', $changeRequestId)?status=draft&amp;form_token=$services.csrf.token\")\n#set ($rebaseUrl = \"$services.changerequest.getChangeRequestURL('rebase', $changeRequestId)?form_token=$services.csrf.token\")\n#set ($mergeUrl = $services.changerequest.getChangeRequestURL('merge', $changeRequestId))\n#set ($status = $changeRequest.status)\n#set ($canBeMerged = $services.changerequest.canBeMerged($changeRequest))\n#set ($canBeReviewed = ($services.changerequest.authorization.isAuthorizedToReview($changeRequest) || $services.changerequest.authorization.isAuthorizedToReviewAsDelegate($changeRequest)))\n#set ($canBeEdited = $services.changerequest.authorization.isAuthorizedToEdit($changeRequest))\n#set ($hasConflict = $services.changerequest.merge.hasConflict($changeRequest))\n#set ($isAlreadyReviewed = $services.changerequest.review.alreadyReviewed($changeRequest))\n#if ($isAlreadyReviewed || $hasConflict)\n  #set ($reviewClassName = 'btn-default')\n#else\n  #set ($reviewClassName = 'btn-primary')\n#end\n#if ($status == 'DRAFT' &amp;&amp; $canBeEdited)\n{{html}}\n&lt;div class=\"btn-group\" id=\"changeRequestButtons\"&gt;\n  &lt;a href=\"$readyForReviewUrl\" title=\"$services.localization.render('changerequest.sheet.ready.button.title')\" rel=\"nofollow\" class=\"btn btn-primary cr-ready-for-review\"&gt;\n    $services.localization.render('changerequest.sheet.ready.button')\n  &lt;/a&gt;\n  &lt;button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\"&gt;\n    &lt;span class=\"caret\"&gt;&lt;/span&gt;\n    &lt;span class=\"sr-only\"&gt;Toggle dropdown&lt;/span&gt;\n  &lt;/button&gt;\n  &lt;ul class=\"dropdown-menu\"&gt;\n    #if (!$hasConflict)\n    &lt;li class=\"cr-rebase\"&gt;\n      &lt;a href=\"$rebaseUrl\" title=\"$services.localization.render('changerequest.sheet.rebase.button.title')\" rel=\"nofollow\"&gt;\n        $services.icon.renderHTML('refresh') $services.localization.render('changerequest.sheet.rebase.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    #end\n    &lt;li class=\"cr-close\"&gt;\n      &lt;a href=\"$closeUrl\" title=\"$services.localization.render('changerequest.sheet.close.button.title')\" rel=\"nofollow\"&gt;\n        $services.icon.renderHTML('lock') $services.localization.render('changerequest.sheet.close.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n  &lt;/ul&gt;\n&lt;/div&gt;\n{{/html}}\n#elseif ($status == 'READY_FOR_REVIEW' || $status == 'READY_FOR_MERGING')\n{{html}}\n&lt;div class=\"btn-group\" id=\"changeRequestButtons\"&gt;\n  #if (!$canBeMerged)\n    &lt;button title=\"$services.localization.render('changerequest.sheet.review.button.title')\" class=\"btn $reviewClassName #if(!$canBeReviewed)disabled#end\" id=\"addReview\"&gt;\n      $services.icon.renderHTML('eye') $services.localization.render('changerequest.sheet.review.button')\n    &lt;/button&gt;\n  #else\n    &lt;a href=\"$mergeUrl\" role=\"button\" title=\"$services.localization.render('changerequest.sheet.merge.button.title')\" class=\"btn btn-primary cr-merge #if(!$isAuthorizedToMerge)disabled#end\"&gt;\n      $services.icon.renderHTML('download') $services.localization.render('changerequest.sheet.merge.button')\n    &lt;/a&gt;\n  #end\n  #if ($canBeEdited || ($canBeMerged &amp;&amp; $canBeReviewed))\n  &lt;button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\"&gt;\n    &lt;span class=\"caret\"&gt;&lt;/span&gt;\n    &lt;span class=\"sr-only\"&gt;Toggle dropdown&lt;/span&gt;\n  &lt;/button&gt;\n  &lt;ul class=\"dropdown-menu\"&gt;\n    #if ($canBeMerged &amp;&amp; $canBeReviewed)\n      &lt;li class=\"\"&gt;\n      &lt;a href=\"#\" id=\"addReview\" title=\"$services.localization.render('changerequest.sheet.review.button.title')\" rel=\"nofollow\"&gt;\n        $services.icon.renderHTML('eye') $services.localization.render('changerequest.sheet.review.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    #end\n    #if ($canBeEdited)\n    #if (!$hasConflict)\n    &lt;li class=\"cr-rebase\"&gt;\n      &lt;a href=\"$services.changerequest.getChangeRequestURL('rebase', $changeRequestId)?form_token=$services.csrf.token\" title=\"$services.localization.render('changerequest.sheet.rebase.button.title')\" rel=\"nofollow\"&gt;\n        $services.icon.renderHTML('refresh') $services.localization.render('changerequest.sheet.rebase.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    #end\n    &lt;li class=\"cr-convert-to-draft\"&gt;\n      &lt;a href=\"$draftUrl\" title=\"$services.localization.render('changerequest.sheet.markdraft.button.title')\" rel=\"nofollow\"&gt;\n        $services.icon.renderHTML('coffee') $services.localization.render('changerequest.sheet.markdraft.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    &lt;li class=\"cr-close\"&gt;\n      &lt;a href=\"$closeUrl\" title=\"$services.localization.render('changerequest.sheet.close.button.title')\" rel=\"nofollow\"&gt;\n        $services.icon.renderHTML('lock') $services.localization.render('changerequest.sheet.close.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    #end\n  &lt;/ul&gt;\n  #end\n&lt;/div&gt;\n{{/html}}\n#elseif ($changeRequest.status == 'CLOSED' || $changeRequest.status == 'STALE')\n#set ($canBeOpened = $services.changerequest.authorization.isAuthorizedToOpen($changeRequest))\n{{html}}\n&lt;div class=\"btn-group\" id=\"changeRequestButtons\"&gt;\n  &lt;a href=\"$services.changerequest.getChangeRequestURL('save', $changeRequestId)?status=ready_for_review&amp;form_token=$services.csrf.token\" title=\"$services.localization.render('changerequest.sheet.open.button.title')\" class=\"btn btn-primary cr-open #if(!$canBeOpened)disabled#end\"&gt;\n      $services.icon.renderHTML('unlock') $services.localization.render('changerequest.sheet.open.button')\n  &lt;/a&gt;\n  #if ($canBeOpened)\n  &lt;button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\"&gt;\n    &lt;span class=\"caret\"&gt;&lt;/span&gt;\n    &lt;span class=\"sr-only\"&gt;Toggle dropdown&lt;/span&gt;\n  &lt;/button&gt;\n  &lt;ul class=\"dropdown-menu\"&gt;\n    &lt;li class=\"cr-open-as-draft\"&gt;\n      &lt;a href=\"$services.changerequest.getChangeRequestURL('save', $changeRequestId)?status=draft&amp;form_token=$services.csrf.token\" title=\"$services.localization.render('changerequest.sheet.open_draft.button.title')\"&gt;\n      $services.localization.render('changerequest.sheet.open_draft.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n  &lt;/ul&gt;\n  #end\n&lt;/div&gt;\n{{/html}}\n#end\n#end\n{{/velocity}}\n\n</content>\n    </property>\n    <property>\n      <extensionPointId>org.xwiki.plaftorm.menu.content</extensionPointId>\n    </property>\n    <property>\n      <name>org.xwiki.contrib.changerequest.menu.mergebutton</name>\n    </property>\n    <property>\n      <parameters/>\n    </property>\n    <property>\n      <scope/>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>2</number>\n    <className>XWiki.UIExtensionClass</className>\n    <guid>3d21a0ac-9e85-4e5b-8c1c-13fd9dfc6830</guid>\n    <class>\n      <name>XWiki.UIExtensionClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <async_cached>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_cached</name>\n        <number>3</number>\n        <prettyName>Cached</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_cached>\n      <async_context>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>1</multiSelect>\n        <name>async_context</name>\n        <number>4</number>\n        <prettyName>Context elements</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>, </separator>\n        <separators>|, </separators>\n        <size>5</size>\n        <unmodifiable>0</unmodifiable>\n        <values>action=Action|doc.reference=Document|icon.theme=Icon theme|locale=Language|rendering.defaultsyntax=Default syntax|rendering.restricted=Restricted|rendering.targetsyntax=Target syntax|request.base=Request base URL|request.cookies|request.headers|request.parameters=Request parameters|request.remoteAddr|request.url=Request URL|request.wiki=Request wiki|user=User|wiki=Wiki</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </async_context>\n      <async_enabled>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_enabled</name>\n        <number>2</number>\n        <prettyName>Asynchronous rendering</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_enabled>\n      <content>\n        <disabled>0</disabled>\n        <editor>Text</editor>\n        <name>content</name>\n        <number>1</number>\n        <prettyName>Executed Content</prettyName>\n        <restricted>0</restricted>\n        <rows>25</rows>\n        <size>120</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </content>\n      <extensionPointId>\n        <disabled>0</disabled>\n        <name>extensionPointId</name>\n        <number>5</number>\n        <prettyName>Extension Point ID</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </extensionPointId>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>6</number>\n        <prettyName>Extension ID</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parameters>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>parameters</name>\n        <number>7</number>\n        <prettyName>Extension Parameters</prettyName>\n        <restricted>0</restricted>\n        <rows>10</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </parameters>\n      <scope>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>scope</name>\n        <number>8</number>\n        <prettyName>Extension Scope</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>wiki=Current Wiki|user=Current User|global=Global</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </scope>\n    </class>\n    <property>\n      <async_cached>1</async_cached>\n    </property>\n    <property>\n      <async_context>\n        <value>doc.reference</value>\n        <value>locale</value>\n        <value>user</value>\n        <value>wiki</value>\n      </async_context>\n    </property>\n    <property>\n      <async_enabled>0</async_enabled>\n    </property>\n    <property>\n      <content>{{velocity}}\n##\u00a0Check if the page is a CR and contains 2 docs\n#if ($doc.getObject('ChangeRequest.Code.ChangeRequestClass'))\n  #set ($changeRequestId = $doc.documentReference.lastSpaceReference.name)\n  #set ($changeRequestOpt = $services.changerequest.getChangeRequest($changeRequestId))\n  #if ($changeRequestOpt.isPresent() &amp;&amp; $changeRequestOpt.get().getModifiedDocuments().size() &gt; 1 &amp;&amp; $services.changerequest.authorization.isAuthorizedToSplit($changeRequestOpt.get()))\n    {{html clean=\"false\"}} ## we need clean=\"false\" because we want to display the raw content of #submenuitem()\n     #template('menus_macros.vm')\n     #set ($splitUrl = $services.changerequest.getChangeRequestURL('split', \"$changeRequestId\"))\n     #submenuitem($splitUrl, $services.localization.render('changerequest.moreactions.splitcr'), 'splitcr', '', 'unlink')\n    {{/html}}\n  #end\n#end\n{{/velocity}}</content>\n    </property>\n    <property>\n      <extensionPointId>org.xwiki.plaftorm.adminactions</extensionPointId>\n    </property>\n    <property>\n      <name>org.xwiki.contrib.changerequest.adminactions.splitcr</name>\n    </property>\n    <property>\n      <parameters>order=10000</parameters>\n    </property>\n    <property>\n      <scope>wiki</scope>\n    </property>\n  </object>\n</xwikidoc>\n"], "fixing_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.5\" reference=\"ChangeRequest.Code.ChangeRequestSheet\" locale=\"\">\n  <web>ChangeRequest.Code</web>\n  <name>ChangeRequestSheet</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>ChangeRequest.WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>#if($doc.getObject('ChangeRequest.Code.ChangeRequestClass'))$doc.title#{else}Change Request Sheet#end</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{include reference=\"ChangeRequest.Code.ChangeRequestMacros\"/}}\n\n{{velocity}}\n#set ($discard = $doc.use('ChangeRequest.Code.ChangeRequestClass'))\n#set ($changeRequestId = $doc.documentReference.lastSpaceReference.name)\n#set ($changeRequestOpt = $services.changerequest.getChangeRequest($changeRequestId))\n#if ($changeRequestOpt.isPresent())\n#set ($changeRequest = $changeRequestOpt.get())\n#set ($modifiedFiles = $changeRequest.modifiedDocuments)\n#set ($discard = $xwiki.jsx.use('ChangeRequest.Code.ChangeRequestSheet'))\n#set ($discard = $xwiki.ssx.use('ChangeRequest.Code.ChangeRequestSheet'))\n#set ($isNotMerged = $changeRequest.status != \"MERGED\")\n#set ($checkIconSuccess = $services.icon.renderHTML('check'))\n#set ($checkIconProblem = $services.icon.renderHTML('warning'))\n#set ($allDiscussions = $services.changerequest.discussion.getDiscussionsFromChangeRequest($changeRequest))\n#set ($canBeEdited = $services.changerequest.authorization.isAuthorizedToEdit($changeRequest))\n## We don't want to see comments and attachments tabs\n#set ($showcomments = false)\n#set ($showannotations = false)\n#set ($showattachments = false)\n## The history tab can be confusing for new users so better not display it by default.\n#set ($showhistory = false)\n## We don't want to see the tab for change requests in change requests\n#set ($showChangeRequestTab = false)\n#set ($changeRequestSheetJSXConfig = {\n  'hasCommentRight': $services.changerequest.authorization.isAuthorizedToComment($changeRequest),\n  'hasValidReviews': $services.changerequest.review.hasValidReviews($changeRequest),\n  'confirmRefreshTranslation': $services.localization.render('changerequest.sheet.rebase.confirm'),\n  'confirmSplitTranslation': $services.localization.render('changerequest.moreactions.splitcr.confirm')\n})\n\n{{html clean=\"false\"}}\n &lt;script id=\"changerequest-sheet-jsx-config\" type=\"application/json\"&gt;$jsontool.serialize($changeRequestSheetJSXConfig).replace('&lt;', '\\u003C')&lt;/script&gt;\n#if ($canBeEdited)\n&lt;div class=\"edit-title\"&gt;\n#set ($saveTitleUrl = $services.changerequest.getChangeRequestURL('save', $changeRequestId))\n#set ($saveTitleUrl = \"${saveTitleUrl}?form_token=$services.csrf.token\")\n  &lt;form id=\"crTitleForm\" method=\"post\" action=\"$escapetool.xml($saveTitleUrl)\"&gt;\n    &lt;input type=\"hidden\" name=\"changeType\" value=\"settitle\" /&gt;\n    &lt;h1 class=\"editable\"&gt;\n      &lt;span class=\"edit-title-icon\"&gt;$services.icon.renderHTML('pencil')&lt;/span&gt;\n      &lt;label class=\"sr-only\" for=\"edit-title-input\"&gt;$services.rendering.escape($doc.title, 'xwiki/2.1')&lt;/label&gt;\n      &lt;input type=\"text\" id=\"edit-title-input\" name=\"new-title\" value=\"$escapetool.xml($doc.title)\" /&gt;\n    &lt;/h1&gt;\n    &lt;div class=\"title-button-wrapper hidden\"&gt;\n      &lt;input type=\"button\" id=\"cancel-title\" data-original-title=\"$escapetool.xml($doc.title)\" class=\"btn btn-default\" value=\"Cancel\" /&gt;\n      &lt;input type=\"submit\" id=\"save-title\" class=\"btn btn-primary\" value=\"Save\" /&gt;\n    &lt;/div&gt;\n  &lt;/form&gt;\n&lt;/div&gt;\n#end\n&lt;div class=\"cr-main-div\" data-changerequest-id=\"$escapetool.xml($changeRequestId)\"&gt;\n  &lt;div id=\"discussions\" class=\"hidden\"&gt;\n  #foreach ($changeRequestDiscussion in $allDiscussions)\n    #set ($reference = $changeRequestDiscussion.reference)\n    ## TODO: handle pagination\n    #set ($messages = $services.discussions.getMessagesByDiscussion($changeRequestDiscussion.discussion, 0, 100))\n    #set ($dataAttributes = $NULL)\n    #set ($discard = \"#getDiscussionDataAttributes($changeRequestDiscussion.discussion, $dataAttributes)\")\n    #set ($diffBlockMetadata = $services.changerequest.discussion.getDiffBlockMetadata($changeRequestDiscussion.discussion))\n    &lt;div class=\"discussion\" ${dataAttributes} &gt;\n      #if ($diffBlockMetadata)\n        #displayDiffBlockMetadata($diffBlockMetadata)\n      #end\n      #foreach ($message in $messages)\n        #displayMessage($message $changeRequest)\n      #end\n    &lt;/div&gt;\n  #end\n  &lt;/div&gt;&lt;!-- End discussions --&gt;\n  &lt;div id=\"timeline-loading\" class=\"loading hidden\"&gt;&lt;/div&gt;\n  &lt;!-- Nav tabs --&gt;\n  &lt;ul class=\"nav nav-tabs\" role=\"tablist\" id=\"changeRequestTabs\"&gt;\n    &lt;li role=\"presentation\" class=\"active\"&gt;&lt;a href=\"#home\" aria-controls=\"home\" role=\"tab\" data-toggle=\"tab\"&gt;\n      $services.localization.render('changerequest.sheet.tab.description.title')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    &lt;li role=\"presentation\"&gt;&lt;a href=\"#filechanges\" aria-controls=\"filechanges\" role=\"tab\" data-toggle=\"tab\"&gt;\n      &lt;span class=\"label label-default\"&gt;$modifiedFiles.size()&lt;/span&gt;\n      $services.localization.render('changerequest.sheet.tab.filechanges.title')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    &lt;li role=\"presentation\"&gt;&lt;a href=\"#reviews\" aria-controls=\"reviews\" role=\"tab\" data-toggle=\"tab\"&gt;\n      &lt;span class=\"label label-default\"&gt;$changeRequest.reviews.size()&lt;/span&gt;\n      $services.localization.render('changerequest.sheet.tab.reviews.title')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    #if ($isNotMerged)\n    &lt;li role=\"presentation\"&gt;&lt;a href=\"#checks\" aria-controls=\"checks\" role=\"tab\" data-toggle=\"tab\"&gt;\n      #set ($canBeMerged = $services.changerequest.canBeMerged($changeRequest))\n      #if ($canBeMerged)\n        &lt;span class=\"label label-success\"&gt;$checkIconSuccess&lt;/span&gt;\n      #else\n        &lt;span class=\"label label-danger\"&gt;$checkIconProblem&lt;/span&gt;\n      #end\n      $services.localization.render('changerequest.sheet.tab.checks.title')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    #end\n  &lt;/ul&gt;\n  &lt;!-- Tab panes --&gt;\n  &lt;div class=\"tab-content change-request-sheet\"&gt;\n    &lt;div role=\"tabpanel\" class=\"tab-pane active\" id=\"home\"&gt;\n      &lt;div class=\"cr-description well\"&gt;\n        #displayDescription()\n      &lt;/div&gt;&lt;!-- End description --&gt;\n      &lt;div id=\"timeline-content\"&gt;\n        &lt;ul class=\"timeline\"&gt;\n        #set ($eventSearchResult = $services.changerequest.notifications.getChangeRequestEvents($changeRequestId, 0, 100))\n        #foreach ($event in $eventSearchResult.stream().iterator())\n          #displayEvent($event $changeRequest)\n        #end\n        &lt;/ul&gt;\n      &lt;/div&gt;&lt;!-- End timeline --&gt;\n      &lt;div id=\"discussion-comments\"&gt;\n        #if ($xcontext.action == 'view' &amp;&amp; $services.changerequest.authorization.isAuthorizedToComment($changeRequest))\n        &lt;div class=\"add-comment\"&gt;\n          &lt;button type=\"button\" class=\"btn btn-default open-editor\"&gt;\n          $services.icon.renderHTML('comment') Comment\n          &lt;/button&gt;\n        &lt;/div&gt;\n        #end\n      &lt;/div&gt;\n    &lt;/div&gt;&lt;!-- End home --&gt;\n    &lt;div role=\"tabpanel\" class=\"tab-pane\" id=\"filechanges\"&gt;\n&lt;div&gt;\n{{/html}}\n\n{{liveData\n  id=\"changerequest-filechanges\"\n  properties=\"changerequest,filechange_type,doc.title,doc.location,filechange_author,filechange_version,filechange_documentVersion,_actions\"\n  source=\"liveTable\"\n  sourceParameters=\"resultPage=ChangeRequest.Code.FileChangeLiveTable&amp;translationPrefix=changerequest.livetable.filechange.\"\n  filters=\"changerequest=$changeRequest.id\"\n  sort=\"doc.location:asc\"\n  limit=\"10\"}}{\n  \"meta\": {\n    \"propertyDescriptors\": [\n      { \"id\": \"_actions\", \"displayer\": { \"id\": \"actions\", \"actions\": [\"edit\", \"fixconflict\", \"rebase\", \"editapprovers\"] } },\n      {\n        \"id\": \"changerequest\",\n        \"visible\": false\n      },\n      {\n        \"id\": \"filechange_author\",\n        \"displayer\": \"html\",\n        \"editable\": false\n      },\n      {\n        \"id\": \"doc.location\",\n        \"editable\": false\n      },\n      {\n        \"id\": \"doc.title\",\n        \"displayer\": \"text\",\n        \"editable\": false\n      },\n      {\n        \"id\": \"filechange_type\",\n        \"editable\": false\n      },\n      {\n        \"id\": \"filechange_version\",\n        \"editable\": false\n      },\n      {\n        \"id\": \"filechange_documentVersion\",\n        \"editable\": false\n      }\n    ],\n    \"actions\": [\n      {\n        \"id\": \"fixconflict\",\n        \"allowProperty\": \"doc.hasfixconflict\",\n        \"urlProperty\": \"doc.fixconflict_url\",\n        \"icon\": \"wrench\",\n        \"name\": \"$services.localization.render('changerequest.sheet.fixconflict.button')\"\n      },\n      {\n        \"id\": \"rebase\",\n        \"allowProperty\": \"doc.hasrebase\",\n        \"urlProperty\": \"doc.rebase_url\",\n        \"icon\": \"refresh\",\n        \"name\": \"$services.localization.render('changerequest.sheet.rebase.button')\"\n      },\n      {\n        \"id\": \"editapprovers\",\n        \"allowProperty\": \"doc.haseditapprovers\",\n        \"urlProperty\": \"doc.editapprovers_url\",\n        \"icon\": \"wrench\",\n        \"name\": \"$services.localization.render('changerequest.sheet.editapprovers.button')\"\n      }\n    ]\n  }\n}\n{{/liveData}}\n\n{{html clean=\"false\"}}\n#set ($createURL = $services.changerequest.getChangeRequestURL('create', ''))\n#set ($addChangesURL = $services.changerequest.getChangeRequestURL('addchanges', '__CR__'))\n#set ($changeRequestSaveConfig = {\n      'hasEditRight': $hasEditRight,\n      'createURL': $createURL,\n      'addChangesURL': $addChangesURL,\n      'isApproversEdition': true\n})\n&lt;script id=\"changerequest-edit-approvers-config\" type=\"application/json\"&gt;$jsontool.serialize($changeRequestSaveConfig).replace('&lt;', '\\u003C')&lt;/script&gt;\n#set ($discard = $xwiki.jsx.use('ChangeRequest.Code.SaveChangeRequestModal'))\n&lt;/div&gt;\n#set ($conflictingFiles = {})\n&lt;h3&gt;$services.localization.render('changerequest.sheet.alldifftitle')&lt;/h3&gt;\n&lt;div class=\"panel-group\" id=\"accordion\" role=\"tablist\" aria-multiselectable=\"true\"&gt;\n#set ($firstFileChange = true)\n#foreach ($ref in $modifiedFiles)\n  #set ($crMergeDocumentResultOpt = $services.changerequest.merge.getMergeDocumentResult($changeRequest, $ref))\n  #if ($crMergeDocumentResultOpt.isPresent())\n  &lt;div class=\"panel panel-default\"&gt;\n    #set ($crMergeDocumentResult = $crMergeDocumentResultOpt.get())\n    #if ($crMergeDocumentResult.hasConflicts())\n      #set ($discard = $conflictingFiles.put($ref, $crMergeDocumentResult))\n    #end\n    #set ($isFileChangeOutdated = $services.changerequest.isFileChangeOutdated($crMergeDocumentResult.fileChange))\n    #set ($renderedTitle = $crMergeDocumentResult.documentTitle)\n    #set ($diffKey = $crMergeDocumentResult.identifier)\n    #set ($filechangeId = $crMergeDocumentResult.fileChange.id)\n    #set ($mergeDocumentResult = $crMergeDocumentResult.wrappedResult)\n    #if ($crMergeDocumentResult.type == 'NO_CHANGE')\n      #set ($diffContent = $services.localization.render('changerequest.sheet.diff.nochange'))\n    #elseif ($crMergeDocumentResult.type == 'DELETION')\n      #set ($currentDoc = $mergeDocumentResult.currentDocument)\n      ## We wrap the XWikiDocument in Document so that the diff macros behave correctly\n      #set ($wrappedDocs = $xwiki.wrapDocs([$currentDoc]))\n      #define ($diffContent)\n        #displayDocumentRawChanges($wrappedDocs.get(0), $NULL)\n      #end\n    #elseif ($crMergeDocumentResult.type == 'CREATION')\n      #set ($modifiedDoc = $crMergeDocumentResult.fileChange.modifiedDocument)\n      ## We wrap the XWikiDocument in Document so that the diff macros behave correctly\n      #set ($wrappedDocs = $xwiki.wrapDocs([$modifiedDoc]))\n      #define ($diffContent)\n        #displayDocumentRawChanges($NULL, $wrappedDocs.get(0))\n      #end\n    #else\n      #set ($modifiedDoc = $mergeDocumentResult.nextDocument)\n      #set ($previousDoc = $mergeDocumentResult.previousDocument)\n      ## We wrap the XWikiDocument in Document so that the diff macros behave correctly\n      #set ($wrappedDocs = $xwiki.wrapDocs([$previousDoc, $modifiedDoc]))\n      #define ($diffContent)\n        #displayDocumentRawChanges($wrappedDocs.get(0), $wrappedDocs.get(1))\n      #end\n    #end\n    &lt;div class=\"panel-heading\" role=\"tab\" id=\"heading-$diffKey\" data-documentReference=\"$escapetool.xml($services.model.serialize($ref))\"&gt;\n      &lt;h4 class=\"panel-title\"&gt;\n        &lt;a role=\"button\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#diff-$diffKey\" aria-expanded=\"true\" aria-controls=\"diff-$diffKey\"&gt;\n          &lt;span class=\"diff-labels\"&gt;\n            &lt;span class=\"label label-default commentcounter hidden\"&gt;\n              $services.icon.renderHTML('envelope') &lt;span class=\"counter\" data-documentReference=\"$escapetool.xml($services.model.serialize($ref))\"&gt;0&lt;/span&gt;\n            &lt;/span&gt;\n            #if ($isNotMerged &amp;&amp; $crMergeDocumentResult.hasConflicts())\n              &lt;span class=\"label label-warning label-diff-conflict\" title=\"$escapetool.xml($services.localization.render('changerequest.sheet.diff.conflictLabel.title'))\"&gt;\n                $services.icon.renderHTML('wrench') $services.localization.render('changerequest.sheet.diff.conflictLabel')\n              &lt;/span&gt;\n            #end\n            #if ($isNotMerged &amp;&amp; $isFileChangeOutdated)\n              &lt;span class=\"label label-warning label-diff-outdated\" title=\"$escapetool.xml($services.localization.render('changerequest.sheet.diff.outdated.title'))\"&gt;\n                $services.icon.renderHTML('clock') $services.localization.render('changerequest.sheet.diff.outdated')\n              &lt;/span&gt;\n            #end\n            ## We only display approvers badges for CR with more than a single document change.\n            #if ($modifiedFiles.size() &gt; 1)\n              #if ($services.changerequest.isApproverOf($crMergeDocumentResult.fileChange))\n              &lt;span class=\"label label-success label-approver\" title=\"$escapetool.xml($services.localization.render('changerequest.sheet.diff.approverLabel.title'))\"&gt;\n                $services.icon.renderHTML('certificate') $services.localization.render('changerequest.sheet.diff.approverLabel')\n              &lt;/span&gt;\n              #elseif ($services.changerequest.isDelegateApproverOf($crMergeDocumentResult.fileChange))\n              &lt;span class=\"label label-success label-delegate-approver\" title=\"$escapetool.xml($services.localization.render('changerequest.sheet.diff.approverLabel.title'))\"&gt;\n                $services.icon.renderHTML('certificate') $services.localization.render('changerequest.sheet.diff.approverLabel')\n              &lt;/span&gt;\n              #end\n            #end\n          &lt;/span&gt;\n          &lt;span class=\"badge button-collapse #if(!$firstFileChange)hidden#end\" title=\"$escapetool.xml($services.localization.render('changerequest.sheet.hide'))\"&gt;\n            $services.icon.renderHTML('caret-up')\n          &lt;/span&gt;\n          &lt;span class=\"badge button-expand #if($firstFileChange)hidden#end\" title=\"$escapetool.xml($services.localization.render('changerequest.sheet.view'))\"&gt;\n            $services.icon.renderHTML('caret-down')\n          &lt;/span&gt;\n          #set ($diffTitleTranslationKey = \"changerequest.sheet.difftitle.$crMergeDocumentResult.type\")\n          $services.localization.render($diffTitleTranslationKey, [\"$escapetool.xml($renderedTitle)\"])\n        &lt;/a&gt;\n      &lt;/h4&gt;\n    &lt;/div&gt;\n    &lt;div id=\"diff-$diffKey\" class=\"panel-collapse collapse diff-panel #if($firstFileChange)in#end\" role=\"tabpanel\" aria-labelledby=\"heading-$diffKey\"&gt;\n      &lt;div class=\"panel-body diff-body\" data-diffId=\"$escapetool.xml($diffKey)\" data-documentReference=\"$escapetool.xml($services.model.serialize($ref))\"&gt;\n        #set ($renderedDiffEnabled = $services.changerequest.isRenderedDiffEnabled())\n        &lt;div class=\"changes-body\" data-filechangeid=\"$escapetool.xml($filechangeId)\"&gt;\n          &lt;div class=\"changes-body-header\"&gt;\n            &lt;div class=\"row\"&gt;\n              &lt;div class=\"col-xs-12 col-sm-6\"&gt;\n                &lt;ul class=\"nav nav-pills\" role=\"tablist\"&gt;\n                  &lt;li role=\"presentation\" class=\"active\"&gt;\n                    &lt;a href=\"#rawChanges-$diffKey\" aria-controls=\"rawChanges-$diffKey\" role=\"tab\" data-toggle=\"pill\" data-hint=\"raw\"&gt;\n                      $escapetool.xml($services.localization.render('web.history.changes.raw'))\n                    &lt;/a&gt;\n                  &lt;/li&gt;\n                  &lt;li role=\"presentation\" #if (!$renderedDiffEnabled)class=\"hidden\"#end&gt;\n                    &lt;a href=\"#renderedChanges-$diffKey\" aria-controls=\"renderedChanges-$diffKey\" role=\"tab\" data-toggle=\"pill\" data-hint=\"rendered\"&gt;\n                      $escapetool.xml($services.localization.render('web.history.changes.rendered'))\n                    &lt;/a&gt;\n                  &lt;/li&gt;\n                &lt;/ul&gt;\n              &lt;/div&gt;\n              &lt;div class=\"col-xs-12 col-md-6\"&gt;\n                &lt;div class=\"changes-actions raw active\"&gt;&lt;/div&gt;\n                &lt;div class=\"changes-actions rendered\"&gt;\n                  &lt;a href=\"#toggleRenderedDiffContext\" class=\"html-diff-context-toggle html-diff-context-toggle-show hidden\"&gt;\n                    &lt;span class=\"html-diff-context-show\"&gt;\n                      $services.icon.renderHTML('plus-square')\n                      $escapetool.xml($services.localization.render('web.history.changes.showContext'))\n                    &lt;/span&gt;\n                    &lt;span class=\"html-diff-context-hide\"&gt;\n                      $services.icon.renderHTML('minus-square')\n                      $escapetool.xml($services.localization.render('web.history.changes.hideContext'))\n                    &lt;/span&gt;\n                  &lt;/a&gt;\n                &lt;/div&gt;\n              &lt;/div&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n          &lt;div class=\"tab-content\"&gt;\n            &lt;div role=\"tabpanel\" class=\"tab-pane active\" id=\"rawChanges-$diffKey\"&gt;\n                $diffContent\n            &lt;/div&gt;\n            &lt;div role=\"tabpanel\" class=\"tab-pane html-diff\" id=\"renderedChanges-$diffKey\"&gt;\n            &lt;!-- This is filled with an ajax request to avoid expensive rendering --&gt;\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n  #set ($firstFileChange = false)\n  #end\n#end\n&lt;/div&gt;\n    &lt;/div&gt;&lt;!-- End file changes --&gt;\n    &lt;div role=\"tabpanel\" class=\"tab-pane\" id=\"reviews\"&gt;\n    &lt;div id=\"addReviewContainer\" class=\"panel panel-primary hidden\"&gt;\n      &lt;div class=\"panel-heading\"&gt;\n        &lt;h3 class=\"panel-title\"&gt;$escapetool.xml($services.localization.render('changerequest.review.modal.title'))&lt;/h3&gt;\n      &lt;/div&gt;\n      &lt;div class=\"panel-body\"&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;div id=\"reviewsContainer\"&gt;\n    #foreach ($review in $changeRequest.reviews)\n      #set ($reviewAuthor = $xwiki.getUserName($review.author.reference))\n      #if ($review.originalApprover &amp;&amp; $review.originalApprover != $review.author)\n        #set ($originalApprover = $xwiki.getUserName($review.originalApprover.reference))\n        #if ($review.approved)\n          #set ($reviewPanelTitle = $services.localization.render('changerequest.sheet.tab.review.title.approved.onbehalf', [\"$reviewAuthor\", \"$originalApprover\"]))\n        #else\n          #set ($reviewPanelTitle = $services.localization.render('changerequest.sheet.tab.review.title.notapproved.onbehalf', [\"$reviewAuthor\", \"$originalApprover\"]))\n        #end\n      #else\n        #set ($originalApprover = $NULL)\n        #if ($review.approved)\n          #set ($reviewPanelTitle = $services.localization.render('changerequest.sheet.tab.review.title.approved', [\"$reviewAuthor\"]))\n        #else\n          #set ($reviewPanelTitle = $services.localization.render('changerequest.sheet.tab.review.title.notapproved', [\"$reviewAuthor\"]))\n        #end\n      #end\n      #if ($review.valid &amp;&amp; $review.approved)\n        #set ($reviewPanelClass = \"panel-success\")\n      #elseif ($review.valid &amp;&amp; !$review.approved)\n        #set ($reviewPanelClass = \"panel-warning\")\n      #else\n        #set ($reviewPanelClass = \"panel-default\")\n      #end\n      #set ($canEditReview = $services.changerequest.review.canEditReview($review))\n      &lt;div class=\"panel $reviewPanelClass review panel-review\" data-reviewid=\"$review.id\" data-approved=\"$review.approved\" data-valid=\"$review.valid\" data-date=\"$review.reviewDate.time\" data-author=\"$escapetool.xml($services.user.serialize($review.author))\" #if($originalApprover)data-original-approver=\"$escapetool.xml($services.user.serialize($review.originalApprover))\"#end&gt;\n        &lt;div class=\"panel-heading\"&gt;\n           #if ($canEditReview)\n            #if ($review.valid)\n              #set ($buttonTitle = $services.localization.render('changerequest.sheet.tab.review.button.markinvalid.title'))\n              #set($buttonValue = \"$services.icon.renderHTML('remove') $services.localization.render('changerequest.sheet.tab.review.button.markinvalid')\")\n              #set ($buttonClass = \"btn-danger\")\n            #else\n              #set ($buttonTitle = $services.localization.render('changerequest.sheet.tab.review.button.markvalid.title') )\n              #set($buttonValue = \"$services.icon.renderHTML('check') $services.localization.render('changerequest.sheet.tab.review.button.markvalid')\")\n              #set ($buttonClass = \"btn-success\")\n            #end\n            &lt;button class=\"btn $buttonClass badge outdated review-toggle-valid\" data-review-id=\"$review.id\" title=\"$buttonTitle\"&gt;$buttonValue&lt;/button&gt;\n          #elseif (!$review.valid)\n            &lt;span class=\"label label-danger outdated\" title=\"$services.localization.render('changerequest.sheet.tab.review.title.outdated.title')\"&gt;$services.localization.render('changerequest.sheet.tab.review.title.outdated')&lt;/span&gt;\n          #end\n          &lt;span class=\"review-date\"&gt;$datetool.format($review.reviewDate)&lt;/span&gt;\n          &lt;h3 class=\"panel-title\"&gt;$reviewPanelTitle&lt;/h3&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    #end\n    &lt;/div&gt;\n    &lt;div class=\"approvers panel panel-default\"&gt;\n      &lt;div class=\"panel-heading\"&gt;\n        &lt;h3 class=\"panel-title\"&gt;$escapetool.xml($services.localization.render('changerequest.sheet.tab.review.approvers.title'))&lt;/h3&gt;\n      &lt;/div&gt;\n      &lt;div class=\"panel-body\"&gt;\n    #set ($approversList = $services.changerequest.getApprovers($changeRequest))\n    #if ($approversList.isEmpty())\n      &lt;span class=\"empty-approvers\"&gt;$escapetool.xml($services.localization.render('changerequest.sheet.tab.review.approvers.noapprover'))&lt;/span&gt;\n    #else\n      $escapetool.xml($services.localization.render('changerequest.sheet.tab.review.approvers.approverslist'))\n      &lt;ul class=\"approvers-list\"&gt;\n      #foreach ($userReference in $approversList)\n        #set ($userDocReference = $userReference.reference)\n        &lt;li&gt;&lt;a href='$xwiki.getURL($userDocReference)'&gt;$xwiki.getPlainUserName($userDocReference)&lt;/a&gt;&lt;/li&gt;\n      #end\n      &lt;/ul&gt;\n    #end\n      &lt;/div&gt;\n    &lt;/div&gt;\n    &lt;/div&gt;&lt;!-- End reviews --&gt;\n    #if ($isNotMerged)\n    &lt;div role=\"tabpanel\" class=\"tab-pane\" id=\"checks\"&gt;\n    &lt;div class=\"panel-group\" id=\"accordion\" role=\"tablist\" aria-multiselectable=\"true\"&gt;\n    #set ($otherChangeRequestsWithSamePages = $services.changerequest.getOpenChangeRequestsTargetingSame($changeRequest))\n    #if (!$otherChangeRequestsWithSamePages.isEmpty())\n      &lt;div class=\"panel panel-info check-panel-other-cr\"&gt;\n        &lt;div class=\"panel-heading\" role=\"tab\" id=\"headingOtherCRPanel\"&gt;\n          &lt;h4 class=\"panel-title\"&gt;\n            &lt;a role=\"button\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#otherCRPanel\" aria-expanded=\"true\" aria-controls=\"otherCRPanel\"&gt;\n              $services.icon.renderHTML('info') $services.localization.render('changerequest.sheet.checks.otherCR.title')\n            &lt;/a&gt;\n          &lt;/h4&gt;\n        &lt;/div&gt; &lt;!-- End heading other CR panel --&gt;\n        &lt;div id=\"otherCRPanel\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"headingOtherCRPanel\"&gt;\n          &lt;div class=\"panel-body\"&gt;\n            $services.localization.render('changerequest.sheet.existingChangeRequestSameChanges')\n            #set ($id = \"changerequests-samechanges\")\n            #set ($columns = [\"doc.title\", \"authors\", \"status\", \"changedDocuments\"])\n            #set($columnsProperties = {\n               \"doc.title\" : { \"type\" : \"text\", \"link\": \"auto\" },\n               \"authors\": { \"type\": \"suggest\", \"html\": \"true\" },\n               \"status\" : { \"type\" : \"suggest\" },\n               \"changedDocuments\" : { \"type\": \"suggest\", \"html\": \"true\"}\n            })\n            #set ($changedDocumentFilters = [])\n            #foreach ($changedDocument in $changeRequest.modifiedDocuments)\n              #set ($discard = $changedDocumentFilters.add(\"&amp;changedDocuments=$services.model.serialize($changedDocument)\"))\n            #end\n            #set($options = {\n               \"className\":\"ChangeRequest.Code.ChangeRequestClass\",\n               \"rowCount\": 5,\n               \"translationPrefix\": \"changerequest.livetable.\",\n               \"extraParams\": \"&amp;status/join_mode=OR&amp;status=draft&amp;status=ready_for_review&amp;status=ready_for_merging&amp;changedDocuments/join_mode=OR$stringtool.join($changedDocumentFilters, '')\",\n               \"outputOnlyHtml\": true\n            })\n            #livetable($id $columns $columnsProperties $options)\n        &lt;/div&gt;\n      &lt;/div&gt;&lt;!-- End otherCR panel body --&gt;\n     &lt;/div&gt;&lt;!-- End otherCR panel --&gt;\n      #end\n       #if ($changeRequest.status == \"READY_FOR_REVIEW\")\n         #set ($statusPanelClass = \"panel-info\")\n         #set ($statusIcon = $checkIconSuccess)\n       #elseif ($changeRequest.status == \"DRAFT\")\n         #set ($statusPanelClass = \"panel-warning\")\n         #set ($statusIcon = $checkIconProblem)\n       #elseif ($changeRequest.status == \"READY_FOR_MERGING\")\n         #set ($statusPanelClass = \"panel-success\")\n         #set ($statusIcon = $checkIconSuccess)\n       #elseif ($changeRequest.status == \"CLOSED\")\n         #set ($statusPanelClass = \"panel-danger\")\n         #set ($statusIcon = $checkIconProblem)\n       #end\n       &lt;div class=\"panel check-panel-status $statusPanelClass\"&gt;\n        &lt;div class=\"panel-heading\" role=\"tab\" id=\"headingStatusPanel\"&gt;\n          &lt;h4 class=\"panel-title\"&gt;\n            &lt;a role=\"button\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#statusPanel\" aria-expanded=\"true\" aria-controls=\"statusPanel\"&gt;\n              $statusIcon $doc.display('status')\n            &lt;/a&gt;\n          &lt;/h4&gt;\n        &lt;/div&gt; &lt;!-- End heading status panel --&gt;\n        &lt;div id=\"statusPanel\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"headingStatusPanel\"&gt;\n          &lt;div class=\"panel-body\"&gt;\n            &lt;div class=\"explanation\"&gt;\n            #if ($changeRequest.status == \"READY_FOR_REVIEW\" || $changeRequest.status == \"READY_FOR_MERGING\")\n              $services.localization.render('changerequest.sheet.checks.status.ready.explanation')\n            #elseif ($changeRequest.status == \"DRAFT\")\n              &lt;div class=\"explanation\"&gt;$services.localization.render('changerequest.sheet.checks.status.draft.explanation')\n            #elseif ($changeRequest.status == \"CLOSED\")\n              &lt;div class=\"explanation\"&gt;$services.localization.render('changerequest.sheet.checks.status.closed.explanation')\n            #end\n            &lt;/div&gt;\n          &lt;/div&gt;\n        &lt;/div&gt;&lt;!-- End body status panel --&gt;\n      &lt;/div&gt;&lt;!-- End status panel --&gt;\n       #set ($hasConflict = $services.changerequest.merge.hasConflict($changeRequest))\n       #if (!$hasConflict)\n         #set ($conflictPanelClass = \"panel-success\")\n         #set ($conflictPanelTitle = $services.localization.render('changerequest.sheet.tab.checks.conflicts.noconflict.title'))\n         #set ($statusIcon = $checkIconSuccess)\n         #set ($conflictPanelBody = $services.localization.render('changerequest.sheet.tab.checks.conflicts.noconflict.body'))\n       #elseif (!$conflictingFiles.isEmpty())\n         #set ($conflictPanelClass = \"panel-warning\")\n         #set ($conflictPanelTitle = $services.localization.render('changerequest.sheet.tab.checks.conflicts.title', \"$conflictingFiles.size()\"))\n         #set ($statusIcon = $checkIconProblem)\n         #set ($conflictPanelBody = $services.localization.render('changerequest.sheet.tab.checks.conflicts.body', [\"$conflictingFiles.size()\", '&lt;a href=\"#filechanges\" class=\"check-conflict-link\"&gt;', '&lt;/a&gt;']))\n       #else\n         #set ($conflictPanelClass = \"panel-warning\")\n         #set ($conflictPanelTitle = $services.localization.render('changerequest.sheet.tab.checks.conflicts.needsrefresh.title'))\n         #set ($statusIcon = $checkIconProblem)\n         #set ($conflictPanelBody = $services.localization.render('changerequest.sheet.tab.checks.conflicts.needsrefresh.body', ['&lt;a href=\"#filechanges\" class=\"check-conflict-link\"&gt;', '&lt;/a&gt;']))\n       #end\n       &lt;div class=\"panel check-panel-conflict $conflictPanelClass\"&gt;\n        &lt;div class=\"panel-heading\" role=\"tab\" id=\"headingConflictPanel\"&gt;\n          &lt;h4 class=\"panel-title\"&gt;\n            &lt;a role=\"button\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#conflictPanel\" aria-expanded=\"true\" aria-controls=\"conflictPanel\"&gt;\n              $statusIcon $conflictPanelTitle\n            &lt;/a&gt;\n          &lt;/h4&gt;\n        &lt;/div&gt; &lt;!-- End heading conflict --&gt;\n        &lt;div id=\"conflictPanel\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"headingConflictPanel\"&gt;\n          &lt;div class=\"panel-body\"&gt;\n            $conflictPanelBody\n          &lt;/div&gt;\n        &lt;/div&gt;&lt;!-- End body conflict --&gt;\n      &lt;/div&gt;&lt;!-- End panel conflict --&gt;\n      #set ($approvalStrategy = $services.changerequest.mergeApprovalStrategy)\n      #set ($canBeMerged = $approvalStrategy.canBeMerged($changeRequest))\n      #if ($canBeMerged)\n        #set ($strategyPanelClass = \"panel-success\")\n        #set ($statusIcon = $checkIconSuccess)\n      #else\n        #set ($strategyPanelClass = \"panel-warning\")\n        #set ($statusIcon = $checkIconProblem)\n      #end\n      #set ($strategyPanelText = $approvalStrategy.getStatus($changeRequest))\n      &lt;div class=\"panel check-panel-strategy $strategyPanelClass\"&gt;\n        &lt;div class=\"panel-heading\" role=\"tab\" id=\"headingApprovalStrategyPanel\"&gt;\n          &lt;h4 class=\"panel-title\"&gt;\n            &lt;a class=\"collapsed\" role=\"button\" data-toggle=\"collapse\" data-parent=\"#accordion\" href=\"#approvalStrategyPanel\" aria-expanded=\"false\" aria-controls=\"approvalStrategyPanel\"&gt;\n              $statusIcon $services.localization.render('changerequest.sheet.tab.checks.approvalStrategy.title')\n            &lt;/a&gt;\n          &lt;/h4&gt;\n        &lt;/div&gt; &lt;!-- End heading approval strategy --&gt;\n        &lt;div id=\"approvalStrategyPanel\" class=\"panel-collapse collapse\" role=\"tabpanel\" aria-labelledby=\"headingApprovalStrategyPanel\"&gt;\n          &lt;div class=\"panel-body\"&gt;\n           $strategyPanelText\n          &lt;/div&gt;\n        &lt;/div&gt;&lt;!-- End body approval strategy --&gt;\n      &lt;/div&gt;&lt;!-- End panel approval strategy --&gt;\n    &lt;/div&gt;&lt;!-- End panel accordion --&gt;\n    &lt;/div&gt;&lt;!-- End merge tab --&gt;\n    #end\n  &lt;/div&gt;\n\n&lt;/div&gt;\n{{/html}}\n#else\n    No change request corresponding to the current id.\n#end\n{{/velocity}}</content>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>0</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>8c39e9a2-e2ec-4e39-a32f-259c8e8d4446</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery'], function ($) {\n  var removeCreateButton = function () {\n    $('#tmCreate').remove();\n  }\n  \n  $(document).on('xwiki:dom:updated', removeCreateButton);\n  (XWiki.isInitialized &amp;&amp; removeCreateButton()) || $(document).on('xwiki:dom:loading', removeCreateButton);\n});</code>\n    </property>\n    <property>\n      <name>remove create</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>1</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>ca32fb8c-d27c-4c25-9116-7d6ddf5b0cd0</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'bootstrap'], function ($) {\n  var checkMergeButton = function() {\n    $('#checkMerge').on('click', function() {\n      $('#changeRequestTabs a[href=\"#merge\"]').tab('show');\n    })\n  };\n\n  $(document).on('xwiki:dom:updated', checkMergeButton);\n  (XWiki.isInitialized &amp;&amp; checkMergeButton()) || $(document).on('xwiki:dom:loading', checkMergeButton);\n})</code>\n    </property>\n    <property>\n      <name>Check merge action </name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>2</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>fb3f6f6b-7a15-41ae-9adb-a717fa54d05f</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>define('ChangeRequestConflictModal', ['jquery', 'xwiki-meta', 'bootstrap'], function ($, xm) {\n  \n  var conflictModal = function (changeRequestId, fileChangeReference, fileChangeLocale) {\n    var self = this;\n    self.changeRequestId = changeRequestId;\n    self.fileChangeReference = fileChangeReference;\n    self.fileChangeLocale = fileChangeLocale;\n    var currentReference = xm.documentReference;\n    var changeRequestConflictRef = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestConflict\");\n    self.postUrl = new XWiki.Document(changeRequestConflictRef).getURL('get');\n    \n    self.requestModal = function(previousVersion, nextVersion) {\n      var warningConflictAction = $('#changeRequestConflictModal input[name=warningConflictAction]:checked').val();\n      \n      if (previousVersion &amp;&amp; nextVersion) {\n        var original = previousVersion;\n        var revised = nextVersion;\n      } else if ($('select[name=original]').length &gt; 0 &amp;&amp; $('select[name=revised]').length &gt; 0) {\n        var original = $('#modalConflictSelectVersion select[name=original]').val();\n        var revised = $('#modalConflictSelectVersion select[name=revised]').val();\n      }\n      if ($('#changeRequestConflictModal')) {\n        $('#changeRequestConflictModal').remove();\n      }\n      \n      var params = {\n        'form_token': xm.form_token,\n        'filechange': self.fileChangeReference,\n        'filechangeLocale': self.fileChangeLocale,\n        'changerequest': self.changeRequestId,\n        'original': original,\n        'revised': revised,\n        'warningConflictAction': warningConflictAction\n      };\n      \n      var notification = new XWiki.widgets.Notification('Requesting conflict modal...','inprogress');\n      $.post(self.postUrl, params).done(function (data) {\n        notification.hide();\n        // Hide previous modal if it exists.\n        $('#changeRequestConflictModal').modal('hide');\n        $('div.modal-backdrop').remove();\n        $('body').append(data);\n        $(document).trigger('xwiki:dom:updated', {'elements': $('#changeRequestConflictModal').toArray()});\n        self.initModal();\n      }).fail(function (data) {\n        notification.replace(new XWiki.widgets.Notification('Error while getting conflict information.','error'));\n      });\n    };\n    \n    // Change the diff based on the action chosen.\n    self.radioSelect = function () {\n      var selectedValue = $('#changeRequestConflictModal input[name=warningConflictAction]:checked').val();\n      if (selectedValue == \"keepChangeRequest\") {\n        self.requestModal(\"NEXT\", \"MERGED\");\n        // It's the next and current value which will be used for the merge, so better use them in case of custom\n        // conflicts resolution.\n      } else if (selectedValue == \"keepPublished\" || selectedValue == \"custom\") {\n        self.requestModal(\"CURRENT\", \"NEXT\");\n      }\n    };\n    \n    self.submitAction = function () {\n      var warningConflictAction = $('#changeRequestConflictModal input[name=warningConflictAction]:checked').val();\n      \n      var params = {\n        'form_token': xm.form_token,\n        'filechange': self.fileChangeReference,\n        'filechangeLocale': self.fileChangeLocale,\n        'changerequest': self.changeRequestId,\n        'decision': warningConflictAction\n      };\n      \n      if (warningConflictAction == 'custom') {\n        var conflictReferences = [];\n        \n        $('#changeRequestConflictModal input[name=conflict_id]').each(function () {\n          var conflictId = $(this).val();\n          var selectValue = $('#conflict_decision_select_' + conflictId).val();\n          var customValue = $('#conflict_decision_value_custom_' + conflictId).val();\n          conflictReferences.push(conflictId);\n          params[\"customDecision_\" + conflictId] = selectValue;\n          \n          if (selectValue == 'custom') {\n            params[\"customInput_\" + conflictId] = customValue;\n          }\n        });\n        params[\"conflictReferences\"] = conflictReferences;\n      }\n      var notification = new XWiki.widgets.Notification('Applying conflict resolution...','inprogress');\n      $.post(self.postUrl, params).done(function (data) {\n        if (data.success) {\n          notification.replace(new XWiki.widgets.Notification('Resolution applied successfully, the page will reload.','done'));\n          window.location.reload();\n        } else {\n          notification.replace(new XWiki.widgets.Notification('An error happened when applying the conflict resolution.','error'));\n        }\n      }).fail(function () {\n        notification.replace(new XWiki.widgets.Notification('Request error when applying the conflict resolution.','error'));\n      });\n    };\n    \n    self.initModal = function() {\n      var modal = $('#changeRequestConflictModal');\n\n      if (modal) {\n        modal.on('hidden.bs.modal', function (e) {\n          $('div.modal-backdrop').remove();\n          modal.remove();\n        });\n\n        $('#changeRequestConflictModalChoices .panel').on('click', self.selectChoice);\n        $('#changeRequestConflictModal input[name=warningConflictAction]').on('change', self.radioSelect);\n        $('#changeRequestConflictChangeDiff').on('click', self.requestModal);\n        $('#changeRequestConflictSubmitButton').on('click', self.submitAction);\n        modal.modal('show');\n      }\n    };\n  }\n  \n  return conflictModal;\n});</code>\n    </property>\n    <property>\n      <name>handle conflict modal</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>3</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>d36ff964-4454-4e7c-a928-f29636110a96</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta', 'ChangeRequestConflictModal'], function ($, xm, ConflictModal) {\n  var initialize = function () {\n    $(\".conflictFixing\").on('click', function () {\n      var button = $(this);\n      var reference = button.attr('data-reference');\n      var locale = button.attr('data-locale');\n      var currentReference = xm.documentReference;\n      var changeRequestId = currentReference.extractReference(XWiki.EntityType.SPACE).getName();\n      var modal = new ConflictModal(changeRequestId, reference, locale);\n      modal.requestModal('', '');\n    });\n    \n    $(document).on('click', '.action_fixconflict', function (event) {\n      event.preventDefault();\n      var currentReference = xm.documentReference;\n      var changeRequestId = currentReference.extractReference(XWiki.EntityType.SPACE).getName();\n      var button = $(this);\n      var link = button.attr('href');\n      var urlParams = new URLSearchParams(link);\n      var reference = urlParams.get('reference');\n      var locale = urlParams.get('locale');\n      var modal = new ConflictModal(changeRequestId, reference, locale);\n      modal.requestModal('', '');\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loaded', initialize);\n});</code>\n    </property>\n    <property>\n      <name>Handle conflict button</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>4</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>5e6a11b2-96d9-4f13-9d20-484cd485d3a1</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta'], function ($, xm) {\n  var reviewContainer = function (changeRequestId) {\n    var self = this;\n    self.changeRequestId = changeRequestId;\n    var currentReference = xm.documentReference;\n    var changeRequestReviewRef = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestReview\");\n    self.postUrl = new XWiki.Document(changeRequestReviewRef).getURL('get');\n    \n    self.requestModal = function () {\n      var reviewContainer = $('#addReviewContainer');\n      if (reviewContainer.hasClass('hidden')) {\n        var params = {\n          'form_token': xm.form_token,\n          'action': 'create',\n          'changerequest': self.changeRequestId\n        };\n        self.notification = new XWiki.widgets.Notification('Requesting review modal...','inprogress');\n\n        $.post(self.postUrl, params).done(function (data) {\n          self.notification.hide();\n          reviewContainer.find('.panel-body').append(data);\n          reviewContainer.removeClass('hidden');\n          $(document).trigger('xwiki:dom:updated', {'elements': reviewContainer.find('.panel-body').toArray()});\n          self.initModal();\n        }).fail(function (data) {\n          self.notification.replace(new XWiki.widgets.Notification('Error while getting review information.','error'));\n        });\n      } else {\n        self.initModal();\n      }\n    };\n\n    var isEditorEmpty = function () {\n      var textarea = $('#addReviewContainer textarea').first();\n      var textareaContent = textarea.val();\n      // regex and logic taken\n      // from https://github.com/ckeditor/ckeditor4/blob/master/plugins/editorplaceholder/plugin.js#L67\n      var fullPageRegex = /&lt;body.*?&gt;((?:.|[\\n\\r])*?)&lt;\\/body&gt;/i;\n      var bodyDataMatched = textareaContent.match(fullPageRegex);\n      if (bodyDataMatched &amp;&amp; (bodyDataMatched.length &gt; 1)) {\n        textareaContent = bodyDataMatched[ 1 ];\n      }\n      return textareaContent.length === 0;\n    };\n    \n    self.submitAction = function () {\n      var reviewForm = $('#reviewForm');\n      var reviewActionUrl = reviewForm.attr('action');\n\n      // We need to call beforeSave first to put the data in the actual content field.\n      $(document).trigger('xwiki:actions:beforeSave');\n      if (!isEditorEmpty()) {\n        reviewForm.find('input[name=\"withComment\"]').val('1');\n      }\n      var reviewData =  reviewForm.serialize();\n      self.notification = new XWiki.widgets.Notification('Posting review...','inprogress');\n      $.post(reviewActionUrl, reviewData).done(function (data) {\n        self.notification.replace(new XWiki.widgets.Notification('Review posted','done'));\n        // Needed to avoid getting a prompt about leaving the window.\n        $(document).trigger('xwiki:actions:cancel');\n        // TODO: this could be improve to only reload reviews\n        window.location.reload();\n      }).fail(function (data) {\n        self.notification.replace(new XWiki.widgets.Notification('Request error while posting review.','error'));\n        console.error(data);\n      });\n    };\n    \n    self.cancel = function () {\n      var modal = $('#addReviewContainer');\n      modal.addClass('hidden');\n      $(document).trigger('xwiki:actions:cancel');\n      modal.find('.panel-body').empty();\n    };\n    \n    self.initModal = function () {\n      var modal = $('#addReviewContainer');\n\n      if (!modal.hasClass('hidden')) {\n        modal.find('.submit-review').on('click', self.submitAction);\n        modal.find('.cancel-review').on('click', self.cancel);\n        modal.find('input[name=\"reviewChoice\"]').on('click', function () {\n          var originalApprover = modal.find('select[name=originalApprover]');\n          if (originalApprover.length == 0 || originalApprover.val() != '-') {\n            modal.find('.submit-review').prop('disabled', false);\n          }\n        });\n        modal.find('select[name=originalApprover]').on('change', function () {\n          var reviewChoice = modal.find('input[name=\"reviewChoice\"]:checked');\n          $('.warning-review').addClass('hidden');\n          $('.warning-review[data-user=\"'+$(this).val()+'\"]').removeClass('hidden');\n          if ($(this).val() != '-' &amp;&amp; reviewChoice.length &gt; 0) {\n            modal.find('.submit-review').prop('disabled', false);\n          } else {\n            modal.find('.submit-review').prop('disabled', true);\n          }\n        });\n      }\n      $('#changeRequestTabs a[aria-controls=\"reviews\"]').tab('show');\n    };\n  }\n  \n  var initialize = function () {\n    $(\"#addReview:not(.disabled)\").on('click', function () {\n      var currentReference = xm.documentReference;\n      var changeRequestId = currentReference.extractReference(XWiki.EntityType.SPACE).getName();\n      var modal = new reviewContainer(changeRequestId);\n      modal.requestModal();\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n});</code>\n    </property>\n    <property>\n      <name>Review modal</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>5</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>1966a41f-f230-4160-8f15-61b681b47304</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta'], function ($, xm) {\n  var initialize = function () {\n    $(\".btn.outdated\").on('click', function () {\n      var button = $(this);\n      var currentReference = xm.documentReference;\n      var changeRequestId = currentReference.extractReference(XWiki.EntityType.SPACE).getName();\n      var currentReference = xm.documentReference;\n      var changeRequestReviewRef = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestReview\");\n      var postUrl = new XWiki.Document(changeRequestReviewRef).getURL('get');\n      var setValid;\n      if (button.hasClass('btn-danger')) {\n        setValid = '0';\n      } else {\n        setValid = '1';\n      }\n      var reviewId = button.attr('data-review-id');\n      var params = {\n        'form_token': xm.form_token,\n        'action': 'setstatus',\n        'changerequest': changeRequestId,\n        'reviewid': reviewId,\n        'isvalid': setValid\n      }\n      var notification = new XWiki.widgets.Notification('Changing review status...','inprogress');\n      $.post(postUrl, params).done(function (data) {\n        if (data.success) {\n          notification.replace(new XWiki.widgets.Notification('Review status edited','done'));\n          window.location.reload();\n        } else {\n          notification.replace(new XWiki.widgets.Notification('Error while changing status.','error'));\n        }\n      }).fail(function (data) {\n        notification.replace(new XWiki.widgets.Notification('Request error while changing status.','error'));\n        console.error(data);\n      });\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n})</code>\n    </property>\n    <property>\n      <name>Review outdated button</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>6</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>ea5056ef-4799-4d88-9265-df9cd9c48978</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>define('ChangeRequestDiscussionHandler', ['jquery', 'xwiki-meta', 'bootstrap'], function ($, xm) {\n  var currentReference = xm.documentReference;\n  var discussionPageReference = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestDiscussion\");\n  var discussionPageUrl = new XWiki.Document(discussionPageReference).getURL('get');\n  var changeRequestId = $('.cr-main-div').attr('data-changerequest-id');\n  \n  var retrieveMessage = function (data) {\n    var messageReference = data.messageReference;\n    $.get(discussionPageUrl, {\n      messageReference: messageReference,\n      form_token: xm.form_token,\n      outputSyntax: 'plain',\n      changeRequestId: changeRequestId\n    }).done(function (data) {\n      var discussionContent = $(data);\n      $('#discussions').append(discussionContent);\n      $(document).trigger('xwiki:dom:updated', {elements: $('#discussions').toArray()});\n    }).fail(function (data) {\n       console.error(\"Error while trying to retrieve message: \" + messageReference);\n       console.log(data);\n    });\n  };\n  \n  return {\n    retrieveMessage\n  };\n});</code>\n    </property>\n    <property>\n      <name>Discussion handler</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>7</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>b7c6493f-b4dd-4a49-ad84-0ea565d588ea</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\ndefine('CommentEditor', ['jquery', 'xwiki-meta', 'ChangeRequestDiscussionHandler', 'bootstrap', 'xwiki-events-bridge'], function ($, xm, DiscussionHandler) {\n  var commentEditor = function (element, requestData) {\n    var self = this;\n    self.element = element;\n    self.requestData = requestData;\n    var currentReference = xm.documentReference;\n    var changeRequestDiscussionRef = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestDiscussion\");\n    self.postUrl = new XWiki.Document(changeRequestDiscussionRef).getURL('get');\n    \n    self.requestEditor = function(originButton) {\n      var notification = new XWiki.widgets.Notification('Requesting discussion modal...','inprogress');\n      var params = {\n        'action': 'displayEditor',\n        'form_token': xm.form_token\n      };\n      $.extend(params, self.requestData)\n      $.post(self.postUrl, params).done(function (data) {\n        notification.hide();\n        self.initEditor(data, originButton);\n      }).fail(function (data) {\n        notification.replace(new XWiki.widgets.Notification('Error while getting discussion information.','error'));\n      });\n    };\n    \n    self.submitAction = function () {\n      var button = $(this);\n      var form = button.parent('form');\n      var url = form.attr('action');\n      var notification = new XWiki.widgets.Notification('Submitting message...','inprogress');\n      // We need to call beforeSave first to put the data in the actual content field.\n      $(document).trigger('xwiki:actions:beforeSave');\n      var data = form.serialize();\n      $(document).trigger('xwiki:actions:cancel');\n      $.post(url, data).done(function (data) {\n        notification.replace(new XWiki.widgets.Notification('Message submitted with success.','success'));\n        $(document).trigger('xwiki:changerequest:refreshTimeline');\n        DiscussionHandler.retrieveMessage(data);\n        self.editorDiv.remove();\n      }).fail(function (data) {\n        console.error(data);\n        notification.replace(new XWiki.widgets.Notification('Error while submitting message.','error'));\n      });\n    };\n    \n    self.cancelAction = function () {\n      $(document).trigger('xwiki:actions:cancel');\n      self.editorDiv.remove();\n    };\n    \n    var getLine = function (element) {\n      var parent;\n      if (element.prop('tagName') === 'TR') {\n        parent = element;\n      } else {\n        parent = element.parents('tr');\n      }\n      return parent;\n    }\n    \n    self.initEditor = function (data, originButton) {\n      if (self.requestData.type == 'diffLine') {\n        var currentLine = getLine(self.element);\n        if (currentLine.next('.discussion-line').length) {\n          currentLine = currentLine.next();\n        }\n        var newLine = $('&lt;tr class=\"discussion-line discussion-editor\"&gt;&lt;td colspan=\"3\"&gt;&lt;/td&gt;&lt;/tr&gt;');\n        newLine.insertAfter(currentLine);\n        newLine.find('td').append($(data));\n        self.editorDiv = newLine;\n      } else if (self.requestData.type == 'comment') {\n        self.editorDiv = $('&lt;div&gt;');\n        self.editorDiv.append($(data));\n        $('.add-comment').prepend(self.editorDiv);\n      } else if (self.requestData.type == 'replyTo') {\n        var originalMessageReference = self.requestData.originalMessage;\n        var originalMessage = $(originButton).parents('.message').first();\n        self.editorDiv = $('&lt;div&gt;');\n        self.editorDiv.append($(data));\n        self.editorDiv.insertAfter(originalMessage);\n      }\n      $(document).trigger('xwiki:dom:updated', {'elements': self.editorDiv.toArray()});\n      self.editorDiv.find('.comment-button').on('click', self.submitAction);\n      self.editorDiv.find('.cancel-button').on('click', self.cancelAction);\n    }\n  }\n  return commentEditor;\n})</code>\n    </property>\n    <property>\n      <name>Comment editor</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>8</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>7fa8865f-d219-44cf-b53b-4751e6b4701d</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['CommentEditor', 'DiffSnippet', 'jquery', 'xwiki-meta'], function (CommentEditor, DiffSnippet, $, xm) {\n  var sheetConfig = JSON.parse($('#changerequest-sheet-jsx-config').text());\n  var hasLineNumber = function (element) {\n    return (element.hasClass('diff-line-number') &amp;&amp; element.text() !== \"\");\n  }\n  var getLine = function (element) {\n    var parent;\n    if (element.prop('tagName') === 'TR') {\n      parent = element;\n    } else {\n      parent = element.parents('tr');\n    }\n    return parent;\n  }\n  var getLineNumber = function (element) {\n    var siblings = getLine(element).find('.diff-line-number');\n    for (var i = 0; i &lt; siblings.length; i++) {\n      var sibling = $(siblings[i]);\n      if (hasLineNumber(sibling)) {\n        return sibling.text();\n      }\n    }\n  }\n  var getChangeType = function (element) {\n    var diffLine = getLine(element).find('.diff-line');\n    if (diffLine.hasClass('diff-line-deleted')) {\n      return \"REMOVED\";\n    } else if (diffLine.hasClass('diff-line-added')) {\n      return \"ADDED\";\n    } else if (diffLine.hasClass('diff-line-context')) {\n      return \"UNCHANGED\";\n    }\n  }\n  \n  // this function returns an array of two element:\n  // first element is the entity reference,\n  // second element is the diffBlockId\n  var getEntityReferenceAndDiffBlock = function (element) {\n    var diffBlockId = element.parents('.diff-container').parent().prev('.diff-header').attr('data-property-name');\n    var entityReference = element.parents('.diff-group').children('dt').first().attr('data-reference');\n    return [entityReference, diffBlockId];\n  }\n  \n  var initialize = function() {\n    if (sheetConfig.hasCommentRight) {\n      $('.diff-container td.diff-line-number').addClass('changerequest-commentable');\n      $('.diff-container td.diff-line-number').on('click', function () {\n        var diffBody = $(this).parents('.diff-body');\n        var diffId = diffBody.attr('data-diffid');\n        var targetReference = diffBody.attr('data-documentreference');\n        var documentParts = getEntityReferenceAndDiffBlock($(this));\n        var lineNumber = getLineNumber($(this));\n        var changeType = getChangeType($(this));\n        var changeRequestId = $(this).parents('.cr-main-div').attr('data-changerequest-id');\n        var lineElement = $(this).parent('tr');\n        var unifiedDiffBlock = new DiffSnippet(lineElement);\n        var editor = new CommentEditor($(this), {\n          'type': 'diffLine',\n          'changeRequestId': changeRequestId,\n          'diffId': diffId,\n          'lineNumber': lineNumber,\n          'changeType': changeType,\n          'targetReference': targetReference,\n          'entityReference': documentParts[0],\n          'diffBlockId': documentParts[1],\n          'diffBlockContext': JSON.stringify(unifiedDiffBlock)\n        });\n        editor.requestEditor();\n      });\n    }\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n});</code>\n    </property>\n    <property>\n      <name>Diff comment</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>9</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>9d738b95-e0e7-4882-a98e-1da0cefa97b0</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta'], function ($, xm) {\n  var placeDiscussions = function (index, element) {\n    var discussion = $(element).clone();\n    if (discussion.find('.message').length &gt; 0) {\n      var entityType = discussion.attr('data-type');\n      if (entityType === 'LINE_DIFF') {\n        placeLineDiffDiscussion(discussion);\n      } else if (entityType === 'CHANGE_REQUEST_COMMENT') {\n        placeCommentDiscussion(discussion);\n      } else if (entityType == 'REVIEW') {\n        placeReviewDiscussion(discussion);\n      }\n    }\n  };\n  \n  var placeReviewDiscussion = function (discussion) {\n    var reviewId = discussion.attr('data-reference');\n    var reviewPanelElement = $('.panel.review[data-reviewid=' + reviewId +']');\n    if (reviewPanelElement &amp;&amp; reviewPanelElement.find('.discussion').length == 0) {\n      var clone = discussion.clone();\n      clone.wrap('&lt;div class=\"panel-body\"&gt;&lt;/div&gt;');\n      clone.addClass('review');\n      reviewPanelElement.append(clone.parent());\n    }\n    var reviewTimelineElement = $('.discussion-holder.review[data-reviewid=' + reviewId +']');\n    if (reviewTimelineElement &amp;&amp; reviewTimelineElement.find('.discussion').length == 0) {\n      var clone = discussion.clone();\n      clone.addClass('review');\n      reviewTimelineElement.append(clone);\n    }\n    discussion.clone().find('.message').each(function (index, message) {\n      placeMessage('review', reviewId, message);\n    });\n  };\n  \n  var placeCommentDiscussion = function (discussion) {\n    discussion.find('.message').each(placeCommentMessage);\n  };\n  \n  var placeCommentMessage = function (index, message) {\n    placeMessage('global-comment', '', message);\n  };\n  \n  var placeMessage = function (cssClass, otherId, message) {\n    var messageId = $(message).attr('data-reference');\n    if (cssClass == 'review') {\n      var discussionElement = $('.discussion.review[data-reference=' + otherId +']');\n    } else {\n      var discussionElement = $('.discussion.'+cssClass+'[data-message-reference=\"'+messageId+'\"]');\n    }\n    var diffBlock = $(message).parent('.discussion').find('.diff-block-metadata');\n    if (discussionElement &amp;&amp; discussionElement.find('.message[data-reference=\"' + messageId+ '\"]').length == 0) {\n      if (diffBlock.length &gt; 0) {\n        newBlock = diffBlock.clone();\n        discussionElement.append(newBlock);\n        newBlock.removeClass('hidden');\n      }\n      discussionElement.append($(message));\n    }\n  };\n  \n  var incrementCounter = function (reference) {\n    var currentCounterSpan = $('.counter[data-documentReference=\"' + reference +'\"]');\n    var counter = parseInt(currentCounterSpan.text()) + 1;\n    currentCounterSpan.text(counter);\n    currentCounterSpan.parent().removeClass('hidden');\n  };\n  \n  var findLineContainer = function (discussion) {\n    var targetReference = discussion.attr('data-targetreference');\n    var diffId = discussion.attr('data-diffid');\n    \n    // try first to find the diff file with same exact id\n    var mainContainer = $('.diff-body[data-diffid=\"' + diffId + '\"]');\n    var outdated = false;\n    var line;\n    \n    // if we did not find it, it means the diff might be outdated, we fallback on the diff concerning same document\n    if (mainContainer.length == 0) {\n      mainContainer = $('.diff-body[data-documentreference=\"' + targetReference + '\"]');\n    }\n    \n    // if we did not find the diff about same document, then it's another issue, we log an error.\n    if (mainContainer.length == 0) {\n      console.error(\"Cannot attach the discussion {0} to the window since there's no diff about {1}. The discussion will remain hidden.\", discussion, targetReference);\n      return;\n    }\n    \n    // Now we have the main container, we need to find if it's about the main document metadata, its xclass or one of its xobject metadata.\n    var entityReference = discussion.attr('data-entityreference');\n    // FIXME: this is a hack to use uppercase characters for entity type, because right now the diff macros\n    // do not use the converter for serializing their references.\n    entityReference = getUpperCaseTypeReference(entityReference);\n    var diffRefContainer = mainContainer.find('.diff-group &gt; dt[data-reference=\"' + entityReference +'\"]');\n    // if we did not find the part of the diff related to the entity reference,\n    // it means that we need to attach the comment to the whole diff.\n    if (diffRefContainer.length == 0) {\n      line = mainContainer;\n      outdated = true;\n    } else {\n      // we have the entity reference diff container, now we can look for the specific property change\n      var diffBlockId = discussion.attr('data-diffblockid');\n      var diffBlockContainer = diffRefContainer.next().find('.diff-header[data-property-name=\"' + diffBlockId + '\"]').next().find('.diff-container');\n      if (diffBlockContainer.length == 0) {\n        line = diffRefContainer;\n        outdated = true;\n      } else {\n        var lineChange = discussion.attr('data-linechange');\n        var lineNumber = discussion.attr('data-linenumber');\n        var searchingClass;\n        if (lineChange === \"ADDED\") {\n          searchingClass = \"diff-line-added\";\n        } else if (lineChange === \"REMOVED\") {\n          searchingClass = \"diff-line-deleted\";\n        } else {\n          searchingClass = \"diff-line-context\";\n        }\n        var filterLine = function () {\n          var node = $(this);\n          return node.text() === lineNumber &amp;&amp; node.parent().find('.diff-line').hasClass(searchingClass);\n        }\n\n        line = diffBlockContainer.find('.diff-line-number:contains(\"' + lineNumber + '\")').filter(filterLine).first().parent();\n\n        // if we did not find the line, then it's outdated and we should attach the discussion to the entity reference container.\n        if (line.length == 0) {\n          line = diffRefContainer;\n          outdated = true;\n        } else {\n          var diffBlockMetadata = discussion.find('.diff-block-metadata');\n          if (diffBlockMetadata.length &gt; 0) {\n            var lastLineContent = diffBlockMetadata.find('.diff-container').find('tr').last().find('td.diff-line').html();\n            var lineContent = line.find('td.diff-line').html();\n            if (lastLineContent != lineContent) {\n              outdated = true;\n            }\n          }\n        }\n      }\n    }\n    return {'line': line, 'outdated': outdated};\n  }\n  \n  var getUpperCaseTypeReference = function (entityReference) {\n    var firstSemicolonIndex = entityReference.indexOf(':');\n    var type = entityReference.substr(0, firstSemicolonIndex);\n    var reference = entityReference.substr(firstSemicolonIndex+1);\n    return type.toUpperCase() + \":\" + reference;\n  };\n  \n  var insertLineDiffDiscussion = function (discussion) {\n    var lineResult = findLineContainer(discussion);\n    if (lineResult &amp;&amp; !lineResult.outdated) {\n      var targetReference = discussion.attr('data-targetreference');\n      var reference = discussion.attr('data-reference');\n      discussion.insertAfter(lineResult.line);\n      if (lineResult.line.parents('table').length &gt; 0) {\n        discussion.wrap('&lt;tr class=\"discussion-line\" data-reference=\"'+reference+'\"&gt;&lt;td colspan=\"3\"&gt;&lt;/td&gt;&lt;/tr&gt;');\n      } else {\n        discussion.wrap('&lt;div class=\"discussion-line\" data-reference=\"'+reference+'\"&gt;&lt;/div&gt;');\n      }\n      discussion.find('.diff-block-metadata').addClass('hidden');\n      incrementCounter(targetReference);\n    } else if (lineResult.outdated) {\n      discussion.addClass('discussion-outdated');\n      discussion.find('.outdated-message').removeClass('hidden');\n    }\n  };\n  \n  var placeLineDiffDiscussion = function (discussion) {\n    var reference = discussion.attr('data-reference');\n    var existingLine = $('.discussion-line[data-reference=\"'+reference+'\"]');\n    if (!existingLine.length) {\n      insertLineDiffDiscussion(discussion);\n    }\n    \n    discussion.clone().find('.message').each(function (index, message) {\n      placeMessage('diff', '', message);\n    });\n  }\n  \n  var placeAllDiscussions = function () {\n    $('#discussions .discussion').each(placeDiscussions);\n    $('#timeline-loading').addClass('hidden');\n    $(document).trigger('xwiki:dom:updated', {'elements': $('#discussions .discussion').toArray()});\n  };\n  \n  var initialize = function () {\n    placeAllDiscussions();\n    $(document).on('xwiki:changerequest:refreshComments', placeAllDiscussions);\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n});</code>\n    </property>\n    <property>\n      <name>Comment placement</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>10</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>18a7666e-e031-4751-aff2-053b23280ec0</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta', 'ChangeRequestDiscussionHandler', 'CommentEditor'], function ($, xm, DiscussionHandler, CommentEditor) {\n\n  var initialize = function () {\n    $('.add-comment .open-editor').on('click', function (event) {\n      var changeRequestId = $(this).parents('.cr-main-div').attr('data-changerequest-id');\n        var editor = new CommentEditor($(this), {\n          'type': 'comment',\n          'changeRequestId': changeRequestId\n        });\n        editor.requestEditor();\n        $(this).addClass('hidden');\n    });\n    $(document).on('xwiki:actions:cancel', function () {\n      $('.add-comment .open-editor').removeClass('hidden');\n    });\n  };\n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n});</code>\n    </property>\n    <property>\n      <name>Comment button</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>11</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>e8669304-a294-423d-bf0f-b2308119fb5e</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta'], function ($, xm) {\n  var cancelled = false;\n  var saveDescription = function (event) {\n    if (cancelled) {\n      return;\n    }\n    event.preventDefault();\n    $(document).trigger('xwiki:actions:cancel');\n    cancelled = true;\n    $(this).trigger('click');\n  };\n  \n  var cancelDescription = function () {\n    $(document).trigger('xwiki:actions:cancel');\n    window.location.href = new XWiki.Document(xm.documentReference).getURL('view');\n  };\n  \n  var initialize = function () {\n    $(\"#save-description\").on('click', saveDescription);\n    $(\"#cancel-description\").on('click', cancelDescription);\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n})</code>\n    </property>\n    <property>\n      <name>description edit</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>12</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>72336573-1eb6-4f44-a970-79e082343d76</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery'], function ($) {\n  var toggleReply = function () {\n    var element = $(this);\n    var originalMessageReference = element.attr('data-message-reference');\n    var selector = '.message[data-reference=\"' + originalMessageReference +'\"]';\n    $('.showMessage').removeClass('showMessage');\n    if ($(selector).parents('.collapse:not(.in)').length &gt; 0) {\n      $(selector).parents('.collapse:not(.in)').addClass('in');\n    }\n    $(selector).addClass('showMessage');\n    $(selector).one('click', function() {\n      $(this).removeClass('showMessage');\n    });\n    $(selector).each(function() {\n      if ($(this).is(':visible')) {\n        $(this).get(0).scrollIntoView();\n      }\n    });\n  };\n  \n  var initReplyNav = function () {\n    $('a[data-message-reference]').on('click', toggleReply);\n  };\n  \n  initReplyNav() || $(document).on('xwiki:dom:updated', initReplyNav);\n});</code>\n    </property>\n    <property>\n      <name>Message navigation</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>13</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>9654e466-9022-4b29-bd2e-28500a41cba9</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta'], function ($, xm) {\n  var editTitle = function () {\n    console.log(\"Edit title\");\n  };\n  \n  var displayButtons = function () {\n    $('.title-button-wrapper').removeClass('hidden');\n  };\n  \n  var cancelTitle = function () {\n    var initValue = $('#cancel-title').attr('data-original-title');\n    $('input#edit-title-input').val(initValue);\n    $('.title-button-wrapper').addClass('hidden');\n  };\n  \n  var initialize = function () {\n    var editTitleForm = $('#crTitleForm');\n    if (editTitleForm.length &gt; 0) {\n      $('#document-title').empty().append(editTitleForm);\n      $('input#edit-title-input').on('focus', displayButtons);\n      $('#cancel-title').on('click', cancelTitle);\n    }\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n});</code>\n    </property>\n    <property>\n      <name>title edit</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>14</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>438daf61-7738-41ef-b6f1-0f95844e539a</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta', 'ChangeRequestDiscussionHandler', 'CommentEditor'], function ($, xm, DiscussionHandler, CommentEditor) {\n  var initReply = function () {\n    $('.message .reply-button:visible').not('.reply-initialized').one('click', function (event) {\n      var changeRequestId = $(this).parents('.cr-main-div').attr('data-changerequest-id');\n      var message = $(this).parents('.message');\n      var discussion = message.parents('.discussion');\n      var discussionType = discussion.attr('data-type');\n      var discussionReference = discussion.attr('data-reference');\n      var messageReference = message.attr('data-reference');\n\n      var editor = new CommentEditor($(this), {\n        'type': 'replyTo',\n        'changeRequestId': changeRequestId,\n        'originalMessage': messageReference,\n        'originalDiscussionType': discussionType,\n        'originalDiscussionReference': discussionReference\n      });\n      editor.requestEditor(event.target);\n    });\n    $('.message .reply-button:visible').not('.reply-initialized').addClass('reply-initialized');\n  };\n  \n  var initialize = function () {\n    initReply();\n    $(document).on('xwiki:dom:updated', initReply);\n    $('a[data-toggle=\"tab\"][href=\"#reviews\"]').on('shown.bs.tab', initReply);\n    $('.diff-panel').on('shown.bs.collapse', initReply);\n  };\n  (XWiki.isInitialized &amp;&amp; initialize()) || $(document).on('xwiki:dom:loading', initialize);\n});</code>\n    </property>\n    <property>\n      <name>Reply button</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>15</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>3235c726-bceb-4295-b6ef-bda8793f2b16</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'bootstrap'], function ($) {\n  var initTabNavigation = function () {\n    $('a[data-tab]').on('click', function() {\n      var tabName = $(this).attr('data-tab');\n      var selector = '#changeRequestTabs a[href=\"#' + tabName + '\"]';\n      $(selector).tab('show');\n    })\n  };\n  \n  initTabNavigation() &amp;&amp; $(document).on('xwiki:dom:updated', initTabNavigation);\n});</code>\n    </property>\n    <property>\n      <name>tab navigation</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>16</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>089266bd-a2ff-49a5-a696-fd00a644a881</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\nrequire(['jquery', 'xwiki-meta'], function ($, xm) {\n  var currentReference = xm.documentReference;\n  var timelinePageRef = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestTimeline\");\n  var timelinePageUrl = new XWiki.Document(timelinePageRef).getURL('get');\n  var changeRequestId = $('.cr-main-div').attr('data-changerequest-id');\n  \n  var refreshTimeline = function() {\n    $('#timeline-loading').removeClass('hidden');\n    var data = {\n      form_token: xm.form_token,\n      changerequest: changeRequestId,\n      outputSyntax: 'plain'\n    };\n    $.get(timelinePageUrl, data).done(function (data) {\n      var timelineHolder = $('#timeline-content');\n      timelineHolder.empty();\n      timelineHolder.append(data);\n      $(document).trigger('xwiki:changerequest:refreshComments');\n      $(document).trigger('xwiki:dom:updated', {'elements': timelineHolder.toArray()});\n    }).fail(function (data) {\n       console.error(\"Error while trying to refresh the timeline: \" + data);\n       console.log(data);\n    });\n  }\n  \n  $(document).on('xwiki:changerequest:refreshTimeline', function () {\n    setTimeout(refreshTimeline, 1000);\n  });\n});</code>\n    </property>\n    <property>\n      <name>Timeline refresh</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>17</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>7b5b0265-f7db-47d5-b65a-cb376331b111</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery', 'SaveChangeRequestModal'], function ($, SaveChangeRequestModal) {\n  var initializeEditApprovers = function () {\n    var saveChangeRequestModal = new SaveChangeRequestModal('changerequest-edit-approvers-config');\n    var editApproversLinks = $('a.action_editapprovers').not('.js-augmented');\n    editApproversLinks.on('click', function(event) {\n      event.preventDefault();\n      // FIXME: this is clearly fragile and would need to be based on a proper data-attribute in the future.\n      var targetReference = $(event.target).parents('td.cell').siblings().find('ol.breadcrumb').attr('data-entity');\n      var changeRequest = $(event.target).parents('div.cr-main-div').attr('data-changerequest-id');\n      var data = {\n        'changerequest': changeRequest,\n        'docChange': targetReference,\n        'explicitDocInfo': 1\n      };\n      saveChangeRequestModal.openModal(data);\n    });\n    editApproversLinks.addClass('js-augmented');\n  };\n  \n  // We use a timeout because this is initialized after the afterEntryFetch is sent and before the LD is displayed\n  setTimeout(initializeEditApprovers, 500);\n  $(document).on('xwiki:livedata:entriesUpdated', initializeEditApprovers);\n  // The new livedata entriesUpdated event has been introduced in XWiki 14.8,\n  // we still keep the old event listener for backward compatibility.\n  $(document).on('xwiki:livedata:afterEntryFetch', function() {\n    setTimeout(initializeEditApprovers, 500);\n  });\n});</code>\n    </property>\n    <property>\n      <name>Edit approvers</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>18</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>c0ff9796-7c57-418a-a3ad-bbcbd9d3b045</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery', 'xwiki-meta'], function ($, xm) {\n  var currentReference = xm.documentReference;\n  var renderedDiffPageRef = new XWiki.DocumentReference(currentReference.extractReference(XWiki.EntityType.WIKI).getName(), [\"ChangeRequest\", \"Code\"], \"ChangeRequestRenderedDiff\");\n  var renderedDiffPageUrl = new XWiki.Document(renderedDiffPageRef).getURL('get');\n  var changeRequestId = $('.cr-main-div').attr('data-changerequest-id');\n  \n  var loadRenderedDiff = function (container) {\n    var filechangeId = container.attr('data-filechangeid');\n    var data = {\n      form_token: xm.form_token,\n      changerequest: changeRequestId,\n      outputSyntax: 'plain',\n      filechangeId: filechangeId,\n      action: 'htmlDiff'\n    };\n    var tabPanel = container.find('.tab-pane.html-diff');\n    tabPanel.addClass('loading').load(renderedDiffPageUrl, data, function() {\n      tabPanel.removeClass('loading');\n      $(document).trigger('xwiki:dom:updated', {'elements': tabPanel.toArray()});\n    });\n  };\n  \n  var initializeRenderedDiff = function () {\n    $('.changes-body a[data-hint=\"rendered\"]').on('click', function (event) {\n      var container = $(event.target).parents('.changes-body');\n      if (!container.hasClass('rendered-loaded')) {\n        loadRenderedDiff(container);\n      }\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initializeRenderedDiff()) || $(document).on('xwiki:dom:loading', initializeRenderedDiff);\n});</code>\n    </property>\n    <property>\n      <name>Load rendered diff</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>19</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>19e9c5a1-c6f3-4218-9419-41e9f8d9dbed</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>'use strict';\ndefine('DiffSnippet', ['jquery', 'xwiki-meta'], function ($, xm) {\n  const TYPE_ADDED = 'ADDED';\n  const TYPE_DELETED = 'DELETED';\n  const TYPE_CONTEXT = 'CONTEXT'; // used for diff element only\n  const TYPE_UNMODIFIED = 'UNMODIFIED'; // used for chunks only\n  const ADD_BEGIN = '&lt;ins&gt;';\n  const ADD_END = '&lt;/ins&gt;';\n  const DEL_BEGIN = '&lt;del&gt;';\n  const DEL_END = '&lt;/del&gt;';\n  const CONTEXT_SIZE = 3;\n  \n  var getChunk = function (type, elements) {\n    var deleted = type == TYPE_DELETED;\n    var added = type == TYPE_ADDED;\n    var unmodified = type == TYPE_UNMODIFIED;\n    return {\n      'type': type,\n      'elements': elements.split(\"\"),\n      'added': added,\n      'deleted': deleted,\n      'unmodified': unmodified\n    }\n  };\n  \n  var getDiffElement = function (index, type, value, chunks) {\n    var deleted = type == TYPE_DELETED;\n    var added = type == TYPE_ADDED;\n    return {\n      'index': index,\n      'type': type,\n      'value': value,\n      'chunks': chunks,\n      'added': added,\n      'deleted': deleted\n    }\n  };\n  \n  var getDiffElementType = function (tdLine) {\n    if (tdLine.hasClass('diff-line-added')) {\n      return TYPE_ADDED;\n    } else if (tdLine.hasClass('diff-line-deleted')) {\n      return TYPE_DELETED;\n    } else {\n      return TYPE_CONTEXT;\n    }\n  };\n  \n  var getIndex = function (trLineElement, type) {\n    var tdIndexElement;\n    if (type == TYPE_CONTEXT || type == TYPE_DELETED) {\n      tdIndexElement = $(trLineElement).find('td.diff-line-number').first();\n    } else {\n      tdIndexElement = $(trLineElement).find('td.diff-line-number').last();\n    }\n    return parseInt(tdIndexElement.text(), 10) - 1;\n  };\n  \n  var buildChunks = function (htmlValue) {\n    return consumeChunk(htmlValue, []);\n  };\n  \n  var consumeChunk = function (htmlString, chunkArray) {\n    var nextAddition = htmlString.indexOf(ADD_BEGIN);\n    var nextDeletion = htmlString.indexOf(DEL_BEGIN);\n    if (nextAddition == -1 &amp;&amp; nextDeletion == -1) {\n      if (chunkArray.length &gt; 0) {\n        chunkArray.push(getChunk(TYPE_UNMODIFIED, htmlString));\n        return chunkArray;\n      } else {\n        return null;\n      }\n    } else if (nextAddition == -1 || (nextDeletion != -1 &amp;&amp; nextDeletion &lt; nextAddition)) {\n      var indexBegin = nextDeletion;\n      var newHtmlString = consumeSingleChunk(htmlString, indexBegin, TYPE_DELETED, chunkArray);\n      if (newHtmlString.length &gt; 0) {\n        return consumeChunk(newHtmlString, chunkArray);\n      } else {\n        return chunkArray;\n      }\n    } else {\n      var indexBegin = nextAddition;\n      var newHtmlString = consumeSingleChunk(htmlString, indexBegin, TYPE_ADDED, chunkArray);\n      if (newHtmlString.length &gt; 0) {\n        return consumeChunk(newHtmlString, chunkArray);\n      } else {\n        return chunkArray;\n      }\n    }\n  }\n  \n  var consumeSingleChunk = function (htmlElement, indexBegin, type, chunkArray) {\n    if (indexBegin != 0) {\n      var contextValue = htmlElement.substring(0, indexBegin);\n      chunkArray.push(getChunk(TYPE_UNMODIFIED, contextValue));\n    }\n    var beginValueIndex;\n    var endValueIndex;\n    var indexEnd;\n    if (type == TYPE_ADDED) {\n      beginValueIndex = indexBegin + ADD_BEGIN.length;\n      endValueIndex = htmlElement.indexOf(ADD_END);\n      indexEnd = endValueIndex + ADD_END.length;\n    } else {\n      beginValueIndex = indexBegin + DEL_BEGIN.length;\n      endValueIndex = htmlElement.indexOf(DEL_END);\n      indexEnd = endValueIndex + DEL_END.length;\n    }\n    chunkArray.push(getChunk(type, htmlElement.substring(beginValueIndex, endValueIndex)));\n    return htmlElement.substring(indexEnd);\n  }\n  \n  var buildDiffElement = function (trLineElement) {\n    var tdLine = $(trLineElement).find('td.diff-line');\n    var type = getDiffElementType(tdLine);\n    var index = getIndex(trLineElement, type);\n    // We need to remove first character because it's added to display +/-\n    // or space in case of context line\n    var value = tdLine.text().substring(1);\n    var htmlValue = tdLine.html().substring(1);\n    var chunks = buildChunks(htmlValue);\n    return getDiffElement(index, type, value, chunks);\n  }\n\n  var diffSnippet = function (trLineElement) {\n    var diffElements = [buildDiffElement(trLineElement)];\n    var currentElement = trLineElement;\n    for (i = CONTEXT_SIZE; i &gt; 0; i--) {\n      var prevElement = currentElement.prev('tr');\n      // If the line contains \"diff-line-meta\" then it's the first one and we should ignore it.\n      if (prevElement.length &gt; 0 &amp;&amp; prevElement.has('td.diff-line-meta').length == 0) {\n        diffElements.unshift(buildDiffElement(prevElement));\n        currentElement = prevElement;\n      } else {\n        break;\n      }\n    }\n    return diffElements;\n  };\n  return diffSnippet;\n})</code>\n    </property>\n    <property>\n      <name>Unified diff block</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>20</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>75e167fb-d8b5-4c51-8043-eab838c50546</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery', 'xwiki-meta'], function ($, xm) {\n  var confirmRefresh = function (event, sheetConfig) {\n    if (sheetConfig.hasValidReviews) {\n      if (!confirm(sheetConfig.confirmRefreshTranslation)) {\n        event.preventDefault();\n      }\n    }\n  };\n  \n  var initializeListeners = function () {\n    var sheetConfig = JSON.parse($('#changerequest-sheet-jsx-config').text());\n    $('a.action_rebase').on('click', function(event) {\n      return confirmRefresh(event, sheetConfig);\n    });\n    $('li.cr-rebase a').on('click', function(event) {\n      return confirmRefresh(event, sheetConfig);\n    });\n  };\n  \n  var initializeConfirmRefresh = function() {\n    initializeListeners();\n    $(document).on('xwiki:dom:updated', initializeListeners);\n    $(document).on('xwiki:livedata:entriesUpdated', initializeListeners);\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initializeConfirmRefresh()) || $(document).on('xwiki:dom:loading', initializeConfirmRefresh);\n});</code>\n    </property>\n    <property>\n      <name>confirm refresh</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>21</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>53cf8408-f5fb-4914-9b03-7b79f67a1633</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery'], function ($) {\n  var switchButton = function (element, isExpanded) {\n    var heading = $(element).siblings('.panel-heading');\n    if (isExpanded) {\n      $(heading).find('.button-expand').addClass('hidden');\n      $(heading).find('.button-collapse').removeClass('hidden');\n    } else {\n      $(heading).find('.button-collapse').addClass('hidden');\n      $(heading).find('.button-expand').removeClass('hidden');\n    }\n  };\n  \n  var initializeSwitchCollapse = function() {\n    $('.diff-panel').on('show.bs.collapse', function () {\n      switchButton($(this), true);\n    });\n    $('.diff-panel').on('hide.bs.collapse', function () {\n      switchButton($(this), false);\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initializeSwitchCollapse()) || $(document).on('xwiki:dom:loading', initializeSwitchCollapse);\n});</code>\n    </property>\n    <property>\n      <name>collapse filechange</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>22</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>9d035854-bc03-44b8-8ef3-a4ceac4a2b34</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery', 'bootstrap'], function ($) {\n  var initializeCheckConflictLink = function() {\n    $('.check-conflict-link').on('click', function() {\n      $('#changeRequestTabs a[href=\"#filechanges\"]').tab('show');\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initializeCheckConflictLink()) || $(document).on('xwiki:dom:loading', initializeCheckConflictLink);\n});</code>\n    </property>\n    <property>\n      <name>check conflict link</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>23</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>c92dfe04-dfa6-4db4-9814-1cd44764c23f</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery'], function ($) {\n  var initializeDiffReferenceDetailsSwitch = function() {\n    $('.diff-reference-details-switch').on('click', function () {\n      $(this).siblings('.diff-reference-details').toggleClass('hidden');\n    });\n  };\n  \n  $(document).on('xwiki:dom:updated', initializeDiffReferenceDetailsSwitch);\n});</code>\n    </property>\n    <property>\n      <name>collapse diff reference details</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>currentPage</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>24</number>\n    <className>XWiki.JavaScriptExtension</className>\n    <guid>fb94aba1-40d8-4a65-9fd7-a6e5e6aefdc3</guid>\n    <class>\n      <name>XWiki.JavaScriptExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>require(['jquery', 'xwiki-meta'], function ($, xm) {\n  var confirmSplit = function (event, sheetConfig) {\n    event.preventDefault();\n    if (confirm(sheetConfig.confirmSplitTranslation)) {\n      var query = \"?form_token=\" + xm.form_token + \"&amp;confirm=1\";\n      window.location = event.target.href + query;\n    }\n  };\n  \n  var initializeConfirmSplit = function() {\n    var sheetConfig = JSON.parse($('#changerequest-sheet-jsx-config').text());\n    $('#splitcr').on('click', function(event) {\n      return confirmSplit(event, sheetConfig);\n    });\n  };\n  \n  (XWiki.isInitialized &amp;&amp; initializeConfirmSplit()) || $(document).on('xwiki:dom:loading', initializeConfirmSplit);\n});</code>\n    </property>\n    <property>\n      <name>confirm split</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>currentPage</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>0</number>\n    <className>XWiki.StyleSheetExtension</className>\n    <guid>573c678e-d12c-4ef9-a8ed-f8be4e011d1a</guid>\n    <class>\n      <name>XWiki.StyleSheetExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>6</number>\n        <prettyName>Content Type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>CSS|LESS</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>.review-date {\n  float: right;\n}\n.outdated {\n  float: right;\n  margin-left: 10px;\n}\n.tab-content.change-request-sheet &gt; .tab-pane.active {\n  margin-top: 1em;\n}\n#discussion-comments {\n  border: 1px dashed #dbdbdb;\n  padding: 1em;\n}\n.edit-description, .edit-title {\n  float: right;\n}\n.description-placeholder {\n  color: #7b7b7b;\n}\nh1.editable {\n  /* Move the title heading a bit to the top and to the left in order to accomodate the input border and padding. */\n  margin-top: -@line-height-computed / 4;\n  margin-left: -(ceil(@grid-gutter-width / 2));\n  /* Reduce the bottom margin in order to accomodate the input border and bottom padding. */\n  margin-bottom: @line-height-computed / 4;\n}\n\n@edit-title-input-padding-vertical: @line-height-computed / 4 - 1;\ninput#edit-title-input {\n  /* Preserve the heading styles. */\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  box-shadow: none;\n  color: inherit;\n  font-size: inherit;\n  /* It seems it's not enough to set the line height for the text input. We also need to set its height. */\n  height: @font-size-document-title * @headings-line-height + 2 * (1 + @edit-title-input-padding-vertical);\n  line-height: @headings-line-height;\n  padding: @edit-title-input-padding-vertical (ceil(@grid-gutter-width / 2) - 1);\n  width: 97%;\n  display: inline;\n}\n\n.edit-title-icon {\n  position: absolute;\n  left: 90%;\n  font-size: 0.5em;\n  line-height: 3em;\n}\n\ninput#edit-title-input:hover {\n  border-color: @input-border;\n}\n\ninput#edit-title-input:focus, .edit-title-icon:hover {\n  .form-control-focus();\n}\n.title-button-wrapper {\n  float: right;\n}\n.panel-default.disabled &gt; .panel-heading {\n  color: #8e8e8e;\n}\n#timeline-loading {\n  float: right;\n  width: 25px;\n}</code>\n    </property>\n    <property>\n      <contentType>LESS</contentType>\n    </property>\n    <property>\n      <name>sheet</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>currentPage</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>1</number>\n    <className>XWiki.StyleSheetExtension</className>\n    <guid>14ca3d0f-4ea2-4e87-9096-c36a3dad7f3a</guid>\n    <class>\n      <name>XWiki.StyleSheetExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>6</number>\n        <prettyName>Content Type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>CSS|LESS</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>/* Variables */\n\n@background: white;\n@color-primary: grey;\n@color-light: #d7d6d6;\n@color-dim: #6c6d6d;\n@color-success: green;\n@color-warning: orange;\n@spacing: 35px;\n@radius: 4px;\n\n@icon-height: 14px;\n@avatar: 80px;\n@dotborder: 2px;\n@dot: 32px;\n@line: 1px;\n\n#timeline-content {\n  margin-top: @spacing;\n  text-align: center;  \n}\n\n/* Timeline */\n\n.timeline {\n  border-left: @line solid @color-light;\n  border-bottom-right-radius: @radius;\n  border-top-right-radius: @radius;\n  margin: @spacing auto;  \n  position: relative;\n  line-height: 1.4em;\n  padding: @spacing;   \n  list-style: none;\n  text-align: left;  \n  max-width: 70%;\n  \n  .event {\n    border-bottom: 1px dashed @color-light;\n    margin-bottom: @spacing;  \n    position: relative;\n    min-height: 50px;\n\n    &amp;:last-of-type { \n      padding-bottom: 0;\n      margin-bottom: 0; \n      border: none;      \n    }\n\n    .event-icon {\n      position: absolute;\n      display: flex;\n      top: 0;\n      box-shadow: 0 0 0 @dotborder fade(@color-light,100%);\n      left: (@spacing + @line + (@dot * 0.5)) * -1;\n      background: lighten(@background,5%);\n      border-radius: 50%;\n      height: @dot;\n      width: @dot;\n      color: @color-primary;\n      \n      span {\n        margin: auto;\n      }\n    }\n    \n    .icon-success {\n      color: @color-success;\n    }\n      \n    .icon-warning {\n      color: @color-warning;\n    }\n\n    .content, .date {\n      position: relative;\n      left: (@avatar * 0.4) * -1;\n    }\n\n    .user-event.user-avatar {\n      left: ((@avatar * 0.6) + @spacing + @line + @dot + (@dotborder * 2)) * -1;\n      color: fade(@color-light, 40%);\n      text-align: right;\n      position: relative;\n      top: -0.5em;\n      float: left;\n\n      img {\n        width: @avatar * 0.5;\n      }\n    }\n    \n    .discussion .diff-container {\n      width: 100%;\n    }\n  }\n}</code>\n    </property>\n    <property>\n      <contentType>LESS</contentType>\n    </property>\n    <property>\n      <name>timeline</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>2</number>\n    <className>XWiki.StyleSheetExtension</className>\n    <guid>12f95fb8-3061-431f-9f40-5a038fb099b7</guid>\n    <class>\n      <name>XWiki.StyleSheetExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>6</number>\n        <prettyName>Content Type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>CSS|LESS</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>@highlighted: rgba(255, 255, 0, 0.2);\n@dotborder: 2px;\n@dot: 32px;\n\n.diff-container td.changerequest-commentable {\n  cursor: pointer;\n}\n.diff-container tr:hover td.changerequest-commentable {\n  background: @highlighted;\n}\n.diff-labels {\n  float: right;\n\n  .label {\n    margin: 5px;\n  }\n}\n.diff-reference-details-switch {\n  float: right;\n  cursor: pointer;\n}\n.diff-reference-details {\n  margin-top: 5px;\n  padding-top: 5px;\n  border-top: 1px dashed lightgrey;\n  font-weight: normal;\n}</code>\n    </property>\n    <property>\n      <contentType>LESS</contentType>\n    </property>\n    <property>\n      <name>diff</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>3</number>\n    <className>XWiki.StyleSheetExtension</className>\n    <guid>d7e2c257-896a-49ce-9575-4f08ee3986fa</guid>\n    <class>\n      <name>XWiki.StyleSheetExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <defaultValue>long</defaultValue>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>5</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>code</name>\n        <number>2</number>\n        <prettyName>Code</prettyName>\n        <restricted>0</restricted>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>6</number>\n        <prettyName>Content Type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>CSS|LESS</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>4</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>3</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>.discussion {\n  width: 75%;\n}\n.message {\n  border: 1px solid lightgrey;\n  margin: 1em;\n  border-top-left-radius: 1em;\n  border-top-right-radius: 1em;\n  border-bottom-left-radius: 1em;\n  border-bottom-right-radius: 1em;\n}\n.message-metadata {\n  border-top-left-radius: 1em;\n  border-top-right-radius: 1em;\n  padding: 1em;\n  border-bottom: 1px dotted lightgrey;\n}\n.showMessage &gt; .message-metadata {\n  background-color: #fffbc3;\n}\n.message-content {\n  padding: 1em;\n  border-bottom-left-radius: 1em;\n  border-bottom-right-radius: 1em;\n}\n.message-badges {\n  float: right;\n}\n.reply-to-header {\n  padding: 1em;\n  border-bottom: 1px dotted lightgrey;\n  \n  .reply-to-navigation {\n    float: right;\n  }\n}</code>\n    </property>\n    <property>\n      <contentType>LESS</contentType>\n    </property>\n    <property>\n      <name>Discussions</name>\n    </property>\n    <property>\n      <parse>0</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>0</number>\n    <className>XWiki.UIExtensionClass</className>\n    <guid>ad7486e2-242f-4f22-8875-2b93ad9852b9</guid>\n    <class>\n      <name>XWiki.UIExtensionClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <async_cached>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_cached</name>\n        <number>3</number>\n        <prettyName>Cached</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_cached>\n      <async_context>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>1</multiSelect>\n        <name>async_context</name>\n        <number>4</number>\n        <prettyName>Context elements</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>, </separator>\n        <separators>|, </separators>\n        <size>5</size>\n        <unmodifiable>0</unmodifiable>\n        <values>action=Action|doc.reference=Document|icon.theme=Icon theme|locale=Language|rendering.defaultsyntax=Default syntax|rendering.restricted=Restricted|rendering.targetsyntax=Target syntax|request.base=Request base URL|request.cookies|request.headers|request.parameters=Request parameters|request.remoteAddr|request.url=Request URL|request.wiki=Request wiki|user=User|wiki=Wiki</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </async_context>\n      <async_enabled>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_enabled</name>\n        <number>2</number>\n        <prettyName>Asynchronous rendering</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_enabled>\n      <content>\n        <disabled>0</disabled>\n        <editor>Text</editor>\n        <name>content</name>\n        <number>1</number>\n        <prettyName>Executed Content</prettyName>\n        <restricted>0</restricted>\n        <rows>25</rows>\n        <size>120</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </content>\n      <extensionPointId>\n        <disabled>0</disabled>\n        <name>extensionPointId</name>\n        <number>5</number>\n        <prettyName>Extension Point ID</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </extensionPointId>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>6</number>\n        <prettyName>Extension ID</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parameters>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>parameters</name>\n        <number>7</number>\n        <prettyName>Extension Parameters</prettyName>\n        <restricted>0</restricted>\n        <rows>10</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </parameters>\n      <scope>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>scope</name>\n        <number>8</number>\n        <prettyName>Extension Scope</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>wiki=Current Wiki|user=Current User|global=Global</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </scope>\n    </class>\n    <property>\n      <async_cached>0</async_cached>\n    </property>\n    <property>\n      <async_context/>\n    </property>\n    <property>\n      <async_enabled>0</async_enabled>\n    </property>\n    <property>\n      <content>{{velocity}}\n#set ($changeRequestId = $doc.documentReference.lastSpaceReference.name)\n#set ($changeRequestOpt = $services.changerequest.getChangeRequest($changeRequestId))\n#if ($changeRequestOpt.isPresent())\n#set ($status = $doc.getValue('status'))\n#if ($status == 'draft')\n  #set ($statusClass = \"default\")\n#elseif ($status == 'merged')\n  #set ($statusClass = \"success\")\n#elseif ($status == 'ready_for_review')\n  #set ($statusClass = \"info\")\n#elseif ($status == 'ready_for_merging')\n  #set ($statusClass = \"primary\")\n#elseif ($status == 'closed' || $status == 'stale')\n  #set ($statusClass = \"danger\")\n#end\n\n{{html}}\n&lt;span class=\"label label-$statusClass\"&gt;$doc.display('status')&lt;/span&gt;\n{{/html}}\n#end\n{{/velocity}}</content>\n    </property>\n    <property>\n      <extensionPointId>org.xwiki.platform.template.title.before</extensionPointId>\n    </property>\n    <property>\n      <name>org.xwiki.contrib.changerequest.title.status</name>\n    </property>\n    <property>\n      <parameters/>\n    </property>\n    <property>\n      <scope>wiki</scope>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>1</number>\n    <className>XWiki.UIExtensionClass</className>\n    <guid>e6d567c6-41f3-4059-992c-9bc02306bbab</guid>\n    <class>\n      <name>XWiki.UIExtensionClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <async_cached>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_cached</name>\n        <number>3</number>\n        <prettyName>Cached</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_cached>\n      <async_context>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>1</multiSelect>\n        <name>async_context</name>\n        <number>4</number>\n        <prettyName>Context elements</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>, </separator>\n        <separators>|, </separators>\n        <size>5</size>\n        <unmodifiable>0</unmodifiable>\n        <values>action=Action|doc.reference=Document|icon.theme=Icon theme|locale=Language|rendering.defaultsyntax=Default syntax|rendering.restricted=Restricted|rendering.targetsyntax=Target syntax|request.base=Request base URL|request.cookies|request.headers|request.parameters=Request parameters|request.remoteAddr|request.url=Request URL|request.wiki=Request wiki|user=User|wiki=Wiki</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </async_context>\n      <async_enabled>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_enabled</name>\n        <number>2</number>\n        <prettyName>Asynchronous rendering</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_enabled>\n      <content>\n        <disabled>0</disabled>\n        <editor>Text</editor>\n        <name>content</name>\n        <number>1</number>\n        <prettyName>Executed Content</prettyName>\n        <restricted>0</restricted>\n        <rows>25</rows>\n        <size>120</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </content>\n      <extensionPointId>\n        <disabled>0</disabled>\n        <name>extensionPointId</name>\n        <number>5</number>\n        <prettyName>Extension Point ID</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </extensionPointId>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>6</number>\n        <prettyName>Extension ID</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parameters>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>parameters</name>\n        <number>7</number>\n        <prettyName>Extension Parameters</prettyName>\n        <restricted>0</restricted>\n        <rows>10</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </parameters>\n      <scope>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>scope</name>\n        <number>8</number>\n        <prettyName>Extension Scope</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>wiki=Current Wiki|user=Current User|global=Global</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </scope>\n    </class>\n    <property>\n      <async_cached>0</async_cached>\n    </property>\n    <property>\n      <async_context/>\n    </property>\n    <property>\n      <async_enabled>0</async_enabled>\n    </property>\n    <property>\n      <content>{{velocity}}\n#set ($changeRequestId = $doc.documentReference.lastSpaceReference.name)\n#set ($changeRequestOpt = $services.changerequest.getChangeRequest($changeRequestId))\n#if ($changeRequestOpt.isPresent())\n#set ($changeRequest = $changeRequestOpt.get())\n#set ($isAuthorizedToMerge = $services.changerequest.authorization.isAuthorizedToMerge($changeRequest))\n#set ($closeUrl = \"$services.changerequest.getChangeRequestURL('save', $changeRequestId)?status=closed&amp;form_token=$services.csrf.token\")\n#set ($readyForReviewUrl = \"$services.changerequest.getChangeRequestURL('save', $changeRequestId)?status=ready_for_review&amp;form_token=$services.csrf.token\")\n#set ($draftUrl = \"$services.changerequest.getChangeRequestURL('save', $changeRequestId)?status=draft&amp;form_token=$services.csrf.token\")\n#set ($rebaseUrl = \"$services.changerequest.getChangeRequestURL('rebase', $changeRequestId)?form_token=$services.csrf.token\")\n#set ($mergeUrl = $services.changerequest.getChangeRequestURL('merge', $changeRequestId))\n#set ($status = $changeRequest.status)\n#set ($canBeMerged = $services.changerequest.canBeMerged($changeRequest))\n#set ($canBeReviewed = ($services.changerequest.authorization.isAuthorizedToReview($changeRequest) || $services.changerequest.authorization.isAuthorizedToReviewAsDelegate($changeRequest)))\n#set ($canBeEdited = $services.changerequest.authorization.isAuthorizedToEdit($changeRequest))\n#set ($hasConflict = $services.changerequest.merge.hasConflict($changeRequest))\n#set ($isAlreadyReviewed = $services.changerequest.review.alreadyReviewed($changeRequest))\n#if ($isAlreadyReviewed || $hasConflict)\n  #set ($reviewClassName = 'btn-default')\n#else\n  #set ($reviewClassName = 'btn-primary')\n#end\n#if ($status == 'DRAFT' &amp;&amp; $canBeEdited)\n{{html}}\n&lt;div class=\"btn-group\" id=\"changeRequestButtons\"&gt;\n  &lt;a href=\"$readyForReviewUrl\" title=\"$services.localization.render('changerequest.sheet.ready.button.title')\" rel=\"nofollow\" class=\"btn btn-primary cr-ready-for-review\"&gt;\n    $services.localization.render('changerequest.sheet.ready.button')\n  &lt;/a&gt;\n  &lt;button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\"&gt;\n    &lt;span class=\"caret\"&gt;&lt;/span&gt;\n    &lt;span class=\"sr-only\"&gt;Toggle dropdown&lt;/span&gt;\n  &lt;/button&gt;\n  &lt;ul class=\"dropdown-menu\"&gt;\n    #if (!$hasConflict)\n    &lt;li class=\"cr-rebase\"&gt;\n      &lt;a href=\"$rebaseUrl\" title=\"$services.localization.render('changerequest.sheet.rebase.button.title')\" rel=\"nofollow\"&gt;\n        $services.icon.renderHTML('refresh') $services.localization.render('changerequest.sheet.rebase.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    #end\n    &lt;li class=\"cr-close\"&gt;\n      &lt;a href=\"$closeUrl\" title=\"$services.localization.render('changerequest.sheet.close.button.title')\" rel=\"nofollow\"&gt;\n        $services.icon.renderHTML('lock') $services.localization.render('changerequest.sheet.close.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n  &lt;/ul&gt;\n&lt;/div&gt;\n{{/html}}\n#elseif ($status == 'READY_FOR_REVIEW' || $status == 'READY_FOR_MERGING')\n{{html}}\n&lt;div class=\"btn-group\" id=\"changeRequestButtons\"&gt;\n  #if (!$canBeMerged)\n    &lt;button title=\"$services.localization.render('changerequest.sheet.review.button.title')\" class=\"btn $reviewClassName #if(!$canBeReviewed)disabled#end\" id=\"addReview\"&gt;\n      $services.icon.renderHTML('eye') $services.localization.render('changerequest.sheet.review.button')\n    &lt;/button&gt;\n  #else\n    &lt;a href=\"$mergeUrl\" role=\"button\" title=\"$services.localization.render('changerequest.sheet.merge.button.title')\" class=\"btn btn-primary cr-merge #if(!$isAuthorizedToMerge)disabled#end\"&gt;\n      $services.icon.renderHTML('download') $services.localization.render('changerequest.sheet.merge.button')\n    &lt;/a&gt;\n  #end\n  #if ($canBeEdited || ($canBeMerged &amp;&amp; $canBeReviewed))\n  &lt;button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\"&gt;\n    &lt;span class=\"caret\"&gt;&lt;/span&gt;\n    &lt;span class=\"sr-only\"&gt;Toggle dropdown&lt;/span&gt;\n  &lt;/button&gt;\n  &lt;ul class=\"dropdown-menu\"&gt;\n    #if ($canBeMerged &amp;&amp; $canBeReviewed)\n      &lt;li class=\"\"&gt;\n      &lt;a href=\"#\" id=\"addReview\" title=\"$services.localization.render('changerequest.sheet.review.button.title')\" rel=\"nofollow\"&gt;\n        $services.icon.renderHTML('eye') $services.localization.render('changerequest.sheet.review.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    #end\n    #if ($canBeEdited)\n    #if (!$hasConflict)\n    &lt;li class=\"cr-rebase\"&gt;\n      &lt;a href=\"$services.changerequest.getChangeRequestURL('rebase', $changeRequestId)?form_token=$services.csrf.token\" title=\"$services.localization.render('changerequest.sheet.rebase.button.title')\" rel=\"nofollow\"&gt;\n        $services.icon.renderHTML('refresh') $services.localization.render('changerequest.sheet.rebase.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    #end\n    &lt;li class=\"cr-convert-to-draft\"&gt;\n      &lt;a href=\"$draftUrl\" title=\"$services.localization.render('changerequest.sheet.markdraft.button.title')\" rel=\"nofollow\"&gt;\n        $services.icon.renderHTML('coffee') $services.localization.render('changerequest.sheet.markdraft.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    &lt;li class=\"cr-close\"&gt;\n      &lt;a href=\"$closeUrl\" title=\"$services.localization.render('changerequest.sheet.close.button.title')\" rel=\"nofollow\"&gt;\n        $services.icon.renderHTML('lock') $services.localization.render('changerequest.sheet.close.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n    #end\n  &lt;/ul&gt;\n  #end\n&lt;/div&gt;\n{{/html}}\n#elseif ($changeRequest.status == 'CLOSED' || $changeRequest.status == 'STALE')\n#set ($canBeOpened = $services.changerequest.authorization.isAuthorizedToOpen($changeRequest))\n{{html}}\n&lt;div class=\"btn-group\" id=\"changeRequestButtons\"&gt;\n  &lt;a href=\"$services.changerequest.getChangeRequestURL('save', $changeRequestId)?status=ready_for_review&amp;form_token=$services.csrf.token\" title=\"$services.localization.render('changerequest.sheet.open.button.title')\" class=\"btn btn-primary cr-open #if(!$canBeOpened)disabled#end\"&gt;\n      $services.icon.renderHTML('unlock') $services.localization.render('changerequest.sheet.open.button')\n  &lt;/a&gt;\n  #if ($canBeOpened)\n  &lt;button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\"&gt;\n    &lt;span class=\"caret\"&gt;&lt;/span&gt;\n    &lt;span class=\"sr-only\"&gt;Toggle dropdown&lt;/span&gt;\n  &lt;/button&gt;\n  &lt;ul class=\"dropdown-menu\"&gt;\n    &lt;li class=\"cr-open-as-draft\"&gt;\n      &lt;a href=\"$services.changerequest.getChangeRequestURL('save', $changeRequestId)?status=draft&amp;form_token=$services.csrf.token\" title=\"$services.localization.render('changerequest.sheet.open_draft.button.title')\"&gt;\n      $services.localization.render('changerequest.sheet.open_draft.button')\n      &lt;/a&gt;\n    &lt;/li&gt;\n  &lt;/ul&gt;\n  #end\n&lt;/div&gt;\n{{/html}}\n#end\n#end\n{{/velocity}}\n\n</content>\n    </property>\n    <property>\n      <extensionPointId>org.xwiki.plaftorm.menu.content</extensionPointId>\n    </property>\n    <property>\n      <name>org.xwiki.contrib.changerequest.menu.mergebutton</name>\n    </property>\n    <property>\n      <parameters/>\n    </property>\n    <property>\n      <scope/>\n    </property>\n  </object>\n  <object>\n    <name>ChangeRequest.Code.ChangeRequestSheet</name>\n    <number>2</number>\n    <className>XWiki.UIExtensionClass</className>\n    <guid>3d21a0ac-9e85-4e5b-8c1c-13fd9dfc6830</guid>\n    <class>\n      <name>XWiki.UIExtensionClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <async_cached>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_cached</name>\n        <number>3</number>\n        <prettyName>Cached</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_cached>\n      <async_context>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>1</multiSelect>\n        <name>async_context</name>\n        <number>4</number>\n        <prettyName>Context elements</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>, </separator>\n        <separators>|, </separators>\n        <size>5</size>\n        <unmodifiable>0</unmodifiable>\n        <values>action=Action|doc.reference=Document|icon.theme=Icon theme|locale=Language|rendering.defaultsyntax=Default syntax|rendering.restricted=Restricted|rendering.targetsyntax=Target syntax|request.base=Request base URL|request.cookies|request.headers|request.parameters=Request parameters|request.remoteAddr|request.url=Request URL|request.wiki=Request wiki|user=User|wiki=Wiki</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </async_context>\n      <async_enabled>\n        <defaultValue>0</defaultValue>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType/>\n        <name>async_enabled</name>\n        <number>2</number>\n        <prettyName>Asynchronous rendering</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </async_enabled>\n      <content>\n        <disabled>0</disabled>\n        <editor>Text</editor>\n        <name>content</name>\n        <number>1</number>\n        <prettyName>Executed Content</prettyName>\n        <restricted>0</restricted>\n        <rows>25</rows>\n        <size>120</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </content>\n      <extensionPointId>\n        <disabled>0</disabled>\n        <name>extensionPointId</name>\n        <number>5</number>\n        <prettyName>Extension Point ID</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </extensionPointId>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>6</number>\n        <prettyName>Extension ID</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parameters>\n        <contenttype>PureText</contenttype>\n        <disabled>0</disabled>\n        <editor>PureText</editor>\n        <name>parameters</name>\n        <number>7</number>\n        <prettyName>Extension Parameters</prettyName>\n        <restricted>0</restricted>\n        <rows>10</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </parameters>\n      <scope>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <freeText>forbidden</freeText>\n        <largeStorage>0</largeStorage>\n        <multiSelect>0</multiSelect>\n        <name>scope</name>\n        <number>8</number>\n        <prettyName>Extension Scope</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>wiki=Current Wiki|user=Current User|global=Global</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </scope>\n    </class>\n    <property>\n      <async_cached>1</async_cached>\n    </property>\n    <property>\n      <async_context>\n        <value>doc.reference</value>\n        <value>locale</value>\n        <value>user</value>\n        <value>wiki</value>\n      </async_context>\n    </property>\n    <property>\n      <async_enabled>0</async_enabled>\n    </property>\n    <property>\n      <content>{{velocity}}\n##\u00a0Check if the page is a CR and contains 2 docs\n#if ($doc.getObject('ChangeRequest.Code.ChangeRequestClass'))\n  #set ($changeRequestId = $doc.documentReference.lastSpaceReference.name)\n  #set ($changeRequestOpt = $services.changerequest.getChangeRequest($changeRequestId))\n  #if ($changeRequestOpt.isPresent() &amp;&amp; $changeRequestOpt.get().getModifiedDocuments().size() &gt; 1 &amp;&amp; $services.changerequest.authorization.isAuthorizedToSplit($changeRequestOpt.get()))\n    {{html clean=\"false\"}} ## we need clean=\"false\" because we want to display the raw content of #submenuitem()\n     #template('menus_macros.vm')\n     #set ($splitUrl = $services.changerequest.getChangeRequestURL('split', \"$changeRequestId\"))\n     #submenuitem($splitUrl, $services.localization.render('changerequest.moreactions.splitcr'), 'splitcr', '', 'unlink')\n    {{/html}}\n  #end\n#end\n{{/velocity}}</content>\n    </property>\n    <property>\n      <extensionPointId>org.xwiki.plaftorm.adminactions</extensionPointId>\n    </property>\n    <property>\n      <name>org.xwiki.contrib.changerequest.adminactions.splitcr</name>\n    </property>\n    <property>\n      <parameters>order=10000</parameters>\n    </property>\n    <property>\n      <scope>wiki</scope>\n    </property>\n  </object>\n</xwikidoc>\n"], "filenames": ["application-changerequest-ui/src/main/resources/ChangeRequest/Code/ChangeRequestSheet.xml"], "buggy_code_start_loc": [80], "buggy_code_end_loc": [81], "fixing_code_start_loc": [80], "fixing_code_end_loc": [81], "type": "CWE-79", "message": "Change Request is an pplication allowing users to request changes on a wiki without publishing the changes directly. Starting in version 0.11 and prior to version 1.9.2, it's possible for a user without any specific right to perform script injection and remote code execution just by inserting an appropriate title when creating a new Change Request. This vulnerability is particularly critical as Change Request aims at being created by user without any particular rights. The vulnerability has been fixed in Change Request 1.9.2. It's possible to workaround the issue without upgrading by editing the document `ChangeRequest.Code.ChangeRequestSheet` and by performing the same change as in the fix commit.", "other": {"cve": {"id": "CVE-2023-45138", "sourceIdentifier": "security-advisories@github.com", "published": "2023-10-12T17:15:09.900", "lastModified": "2023-10-18T18:51:35.237", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Change Request is an pplication allowing users to request changes on a wiki without publishing the changes directly. Starting in version 0.11 and prior to version 1.9.2, it's possible for a user without any specific right to perform script injection and remote code execution just by inserting an appropriate title when creating a new Change Request. This vulnerability is particularly critical as Change Request aims at being created by user without any particular rights. The vulnerability has been fixed in Change Request 1.9.2. It's possible to workaround the issue without upgrading by editing the document `ChangeRequest.Code.ChangeRequestSheet` and by performing the same change as in the fix commit."}, {"lang": "es", "value": "Change Request es una aplicaci\u00f3n que permite a los usuarios solicitar cambios en una wiki sin publicar los cambios directamente. A partir de la versi\u00f3n 0.11 y antes de la versi\u00f3n 1.9.2, es posible que un usuario sin ning\u00fan derecho espec\u00edfico realice inyecci\u00f3n de script y ejecuci\u00f3n remota de c\u00f3digo simplemente insertando un t\u00edtulo apropiado al crear una nueva Change Request. Esta vulnerabilidad es particularmente cr\u00edtica ya que Change Request pretende ser creada por un usuario sin ning\u00fan derecho particular. La vulnerabilidad se ha solucionado en Change Request 1.9.2. Es posible workaround en el problema sin actualizar editando el documento `ChangeRequest.Code.ChangeRequestSheet` y realizando el mismo cambio que en el commit de correcci\u00f3n."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.6, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 2.8, "impactScore": 6.0}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 10.0, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:change_request:*:*:*:*:*:*:*:*", "versionStartIncluding": "0.11", "versionEndExcluding": "1.9.2", "matchCriteriaId": "14ADED81-A7CA-41B2-A0A4-8A382D7377AC"}]}]}], "references": [{"url": "https://github.com/xwiki-contrib/application-changerequest/commit/7565e720117f73102f5a276239eabfe85e15cff4", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/xwiki-contrib/application-changerequest/security/advisories/GHSA-f776-w9v2-7vfj", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://jira.xwiki.org/browse/CRAPP-298", "source": "security-advisories@github.com", "tags": ["Issue Tracking", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/xwiki-contrib/application-changerequest/commit/7565e720117f73102f5a276239eabfe85e15cff4"}}