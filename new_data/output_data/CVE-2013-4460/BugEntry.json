{"buggy_code": ["<?php\n# MantisBT - A PHP based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * CALLERS\n *\tThis page is called from:\n *\t- print_menu()\n *\t- print_account_menu()\n *\n * EXPECTED BEHAVIOUR\n *\t- Display the user's current sponsorships\n *\t- Allow the user to edit the payment flag\n *\n * CALLS\n *\tThis page calls the following pages:\n *\t- account_sponsor_update.php  (to save changes)\n *\n * RESTRICTIONS & PERMISSIONS\n *\t- User must be authenticated, and not anonymous\n *   - sponsorship must be enabled\n *\n * @package MantisBT\n * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org\n * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n * @link http://www.mantisbt.org\n *\n * @uses core.php\n * @uses access_api.php\n * @uses authentication_api.php\n * @uses bug_api.php\n * @uses config_api.php\n * @uses constant_inc.php\n * @uses current_user_api.php\n * @uses database_api.php\n * @uses form_api.php\n * @uses gpc_api.php\n * @uses helper_api.php\n * @uses html_api.php\n * @uses lang_api.php\n * @uses print_api.php\n * @uses project_api.php\n * @uses sponsorship_api.php\n * @uses string_api.php\n * @uses version_api.php\n */\n\nrequire_once( 'core.php' );\nrequire_api( 'access_api.php' );\nrequire_api( 'authentication_api.php' );\nrequire_api( 'bug_api.php' );\nrequire_api( 'config_api.php' );\nrequire_api( 'constant_inc.php' );\nrequire_api( 'current_user_api.php' );\nrequire_api( 'database_api.php' );\nrequire_api( 'form_api.php' );\nrequire_api( 'gpc_api.php' );\nrequire_api( 'helper_api.php' );\nrequire_api( 'html_api.php' );\nrequire_api( 'lang_api.php' );\nrequire_api( 'print_api.php' );\nrequire_api( 'project_api.php' );\nrequire_api( 'sponsorship_api.php' );\nrequire_api( 'string_api.php' );\nrequire_api( 'version_api.php' );\n\nrequire_css( 'status_config.php' );\n\nif ( !config_get( 'enable_sponsorship' ) ) {\n\ttrigger_error( ERROR_SPONSORSHIP_NOT_ENABLED, ERROR );\n}\n\n# anonymous users are not allowed to sponsor issues\nif ( current_user_is_anonymous() ) {\n\taccess_denied();\n}\n\n$t_show_all = gpc_get_bool( 'show_all', false );\n\n# start the page\nhtml_page_top( lang_get( 'my_sponsorship' ) );\n\n$t_project = helper_get_current_project();\n?>\n<br />\n<table class=\"width100\" cellspacing=\"1\">\n<tr>\n\t<td class=\"form-title\">\n\t\t<?php echo lang_get( 'my_sponsorship' ) ?>\n\t</td>\n\t<td class=\"right\">\n\t\t<?php print_account_menu( 'account_sponsor_page.php' ) ?>\n\t</td>\n</tr>\n</table>\n<?php\n# get issues user has sponsored\n$t_user = auth_get_current_user_id();\n$t_resolved = config_get( 'bug_resolved_status_threshold' );\n$t_bug_table = db_get_table( 'bug' );\n$t_sponsor_table = db_get_table( 'sponsorship' );\n$t_payment = config_get( 'payment_enable', 0 );\n\n$t_project_clause = helper_project_specific_where( $t_project );\n\n$t_query = \"SELECT b.id as bug, s.id as sponsor, s.paid, b.project_id, b.fixed_in_version, b.status\n\tFROM $t_bug_table b, $t_sponsor_table s\n\tWHERE s.user_id=\" . db_param() . \" AND s.bug_id = b.id \" .\n\t( $t_show_all ? '' : 'AND ( b.status < ' . db_param() . ' OR s.paid < ' . SPONSORSHIP_PAID . ')' ) . \"\n\tAND $t_project_clause\n\tORDER BY s.paid ASC, b.project_id ASC, b.fixed_in_version ASC, b.status ASC, b.id DESC\";\n\n$t_result = db_query_bound( $t_query, $t_show_all ? array( $t_user ) : array( $t_user , $t_resolved ) );\n\n$t_sponsors = array();\nwhile ( $t_row = db_fetch_array( $t_result ) ) {\n\t$t_sponsors[] = $t_row;\n}\n\n$t_sponsor_count = count( $t_sponsors );\nif ( $t_sponsor_count === 0 ) {\n\techo '<p>' . lang_get( 'no_own_sponsored' ) . '</p>';\n} else {\n?>\n\n<!-- # Edit own sponsorship Form BEGIN -->\n<br />\n<div>\n<table class=\"width100\" cellspacing=\"1\">\n\n\t<!-- Headings -->\n\t<tr>\n\t\t<td class=\"form-title\" colspan=\"9\">\n\t\t\t<?php echo lang_get( 'own_sponsored' ) ?>\n\t\t</td>\n\t</tr>\n\t<tr>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'email_bug' ) ?></td>\n\t\t<td class=\"form-title\" width=\"8%\"><?php echo lang_get( 'email_project' ) ?></td>\n\t\t<td class=\"form-title\" width=\"7%\"><?php echo lang_get( 'fixed_in_version' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'email_status' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'email_handler' ) ?></td>\n\t\t<td class=\"form-title\" width=\"30%\"><?php echo lang_get( 'email_summary' ) ?></td>\n\t\t<td class=\"form-title\" width=\"8%\"><?php echo lang_get( 'amount' ) ?></td>\n\t\t<td class=\"form-title\" width=\"7%\"><?php echo lang_get( 'status' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\">&#160;</td>\n\t</tr>\n<?php\n\t$t_total_owing = 0;\n\t$t_total_paid = 0;\n\tfor ( $i = 0; $i < $t_sponsor_count; ++$i ) {\n\t\t$t_sponsor_row = $t_sponsors[$i];\n\t\t$t_bug = bug_get( $t_sponsor_row['bug'] );\n\t\t$t_sponsor = sponsorship_get( $t_sponsor_row['sponsor'] );\n\n\t\t# describe bug\n\t\t$t_status = string_attribute( get_enum_element( 'status', $t_bug->status, auth_get_current_user_id(), $t_bug->project_id ) );\n\t\t$t_resolution = string_attribute( get_enum_element( 'resolution', $t_bug->resolution, auth_get_current_user_id(), $t_bug->project_id ) );\n\t\t$t_version_id = version_get_id( $t_bug->fixed_in_version, $t_project );\n\t\tif ( ( false !== $t_version_id ) && ( VERSION_RELEASED == version_get_field( $t_version_id, 'released' ) ) ) {\n\t\t\t$t_released_label = '<a title=\"' . lang_get( 'released' ) . '\">' . $t_bug->fixed_in_version . '</a>';\n\t\t} else {\n\t\t\t$t_released_label = $t_bug->fixed_in_version;\n\t\t}\n\n\t\t# choose color based on status\n\t\t$status_label = html_get_status_css_class( $t_bug->status, auth_get_current_user_id(), $t_bug->project_id );\n\n\t\techo '<tr class=\"' . $status_label .  '\">';\n\t\techo '<td><a href=\"' . string_get_bug_view_url( $row['bug'] ) . '\">' . bug_format_id( $row['bug'] ) . '</a></td>';\n\t\techo '<td>' . project_get_field( $t_bug->project_id, 'name' ) . '&#160;</td>';\n\t\techo '<td class=\"right\">' . $t_released_label . '&#160;</td>';\n\t\techo '<td><span class=\"issue-status\" title=\"' . $t_resolution . '\">' . $t_status . '</span></td>';\n\t\techo '<td>';\n\t\tprint_user( $t_bug->handler_id );\n\t\techo '</td>';\n\n\t\t# summary\n\t\techo '<td>' . string_display_line( $t_bug->summary );\n\t\tif ( VS_PRIVATE == $t_bug->view_state ) {\n\t\t\tprintf( ' <img src=\"%s\" alt=\"(%s)\" title=\"%s\" />', $t_icon_path . 'protected.gif', lang_get( 'private' ), lang_get( 'private' ) );\n\t\t}\n\t\techo '</td>';\n\n\t\t# describe sponsorship amount\n\t\techo '<td class=\"right\">' . sponsorship_format_amount( $t_sponsor->amount ) . '</td>';\n\t\techo '<td>' . get_enum_element( 'sponsorship', $t_sponsor->paid ) . '</td>';\n\n\t\tif ( SPONSORSHIP_PAID == $t_sponsor->paid ) {\n\t\t\t$t_total_paid += $t_sponsor->amount;\n\t\t} else {\n\t\t\t$t_total_owing += $t_sponsor->amount;\n\t\t}\n\n\t\techo '<td>';\n\t\tif ( $t_payment ) {\n\t\t\techo '(paypal button)';\n\t\t} else {\n\t\t\techo '&#160;';\n\t\t}\n\t\techo '</td>';\n\t\techo '</tr>';\n\t}\n?>\n<!-- Totals -->\n<tr>\n\t<td colspan=\"5\"></td>\n\t<td><?php echo lang_get( 'total_owing' ) ?></td>\n\t<td class=\"right\"><?php echo sponsorship_format_amount( $t_total_owing ) ?></td>\n\t<td colspan=\"2\"></td>\n</tr>\n<tr>\n\t<td colspan=\"5\"></td>\n\t<td><?php echo lang_get( 'total_paid' ) ?></td>\n\t<td class=\"right\"><?php echo sponsorship_format_amount( $t_total_paid ) ?></td>\n\t<td colspan=\"2\"></td>\n</tr>\n</table>\n</div>\n<?php } # end sponsored issues\n\n$t_query = \"SELECT b.id as bug, s.id as sponsor, s.paid, b.project_id, b.fixed_in_version, b.status\n\tFROM $t_bug_table b, $t_sponsor_table s\n\tWHERE b.handler_id=\" . db_param() . \" AND s.bug_id = b.id \" .\n\t( $t_show_all ? '' : 'AND ( b.status < ' . db_param() . ' OR s.paid < ' . SPONSORSHIP_PAID . ')' ) . \"\n\tAND $t_project_clause\n\tORDER BY s.paid ASC, b.project_id ASC, b.fixed_in_version ASC, b.status ASC, b.id DESC\";\n\n$t_result = db_query_bound( $t_query, $t_show_all ? array( $t_user ) : array( $t_user , $t_resolved ) );\n\n$t_sponsors = array();\nwhile ( $t_row = db_fetch_array( $t_result ) ) {\n\t$t_sponsors[] = $t_row;\n}\n\n$t_sponsor_count = count( $t_sponsors );\nif ( $t_sponsor_count === 0 ) {\n\techo '<p>' . lang_get( 'no_sponsored' ) . '</p>';\n} else {\n?>\n\n<!-- # Edit sponsorship Form BEGIN -->\n<br />\n<div>\n<form method=\"post\" action=\"account_sponsor_update.php\">\n<?php echo form_security_field( 'account_sponsor_update' ) ?>\n<table class=\"width100\" cellspacing=\"1\">\n\n\t<!-- Headings -->\n\t<tr>\n\t\t<td class=\"form-title\" colspan=\"8\">\n\t\t\t<?php echo lang_get( 'issues_handled' ) ?>\n\t\t</td>\n\t</tr>\n\t<tr>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'email_bug' ) ?></td>\n\t\t<td class=\"form-title\" width=\"8%\"><?php echo lang_get( 'email_project' ) ?></td>\n\t\t<td class=\"form-title\" width=\"7%\"><?php echo lang_get( 'fixed_in_version' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'email_status' ) ?></td>\n\t\t<td class=\"form-title\" width=\"35%\"><?php echo lang_get( 'email_summary' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'sponsor' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'amount' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'status' ) ?></td>\n\t</tr>\n<?php\n\t$t_bug_list = array();\n\t$t_total_owing = 0;\n\t$t_total_paid = 0;\n\tfor ( $i = 0; $i < $t_sponsor_count; ++$i ) {\n\t\t$t_sponsor_row = $t_sponsors[$i];\n\t\t$t_bug = bug_get( $t_sponsor_row['bug'] );\n\t\t$t_sponsor = sponsorship_get( $t_sponsor_row['sponsor'] );\n\t\t$t_buglist[] = $t_sponsor_row['bug'] . ':' . $t_sponsor_row['sponsor'];\n\n\t\t# describe bug\n\t\t$t_status = string_attribute( get_enum_element( 'status', $t_bug->status, auth_get_current_user_id(), $t_bug->project_id ) );\n\t\t$t_resolution = string_attribute( get_enum_element( 'resolution', $t_bug->resolution, auth_get_current_user_id(), $t_bug->project_id ) );\n\t\t$t_version_id = version_get_id( $t_bug->fixed_in_version, $t_project );\n\t\tif ( ( false !== $t_version_id ) && ( VERSION_RELEASED == version_get_field( $t_version_id, 'released' ) ) ) {\n\t\t\t$t_released_label = '<a title=\"' . lang_get( 'released' ) . '\">' . $t_bug->fixed_in_version . '</a>';\n\t\t} else {\n\t\t\t$t_released_label = $t_bug->fixed_in_version;\n\t\t}\n\n\t\t# choose color based on status\n\t\t$status_label = html_get_status_css_class( $t_bug->status, auth_get_current_user_id(), $t_bug->project_id );\n\n\t\techo '<tr class=\"' . $status_label .  '\">';\n\t\techo '<td><a href=\"' . string_get_bug_view_url( $row['bug'] ) . '\">' . bug_format_id( $row['bug'] ) . '</a></td>';\n\t\techo '<td>' . project_get_field( $t_bug->project_id, 'name' ) . '&#160;</td>';\n\t\techo '<td class=\"right\">' . $t_released_label . '&#160;</td>';\n\t\techo '<td><a title=\"' . $t_resolution . '\"><span class=\"underline\">' . $t_status . '</span>&#160;</a></td>';\n\n\t\t# summary\n\t\techo '<td>' . string_display_line( $t_bug->summary );\n\t\tif ( VS_PRIVATE == $t_bug->view_state ) {\n\t\t\tprintf( ' <img src=\"%s\" alt=\"(%s)\" title=\"%s\" />', $t_icon_path . 'protected.gif', lang_get( 'private' ), lang_get( 'private' ) );\n\t\t}\n\t\techo '</td>';\n\n\t\t# describe sponsorship amount\n\t\techo '<td>';\n\t\tprint_user( $t_sponsor->user_id );\n\t\techo '</td>';\n\t\techo '<td class=\"right\">' . sponsorship_format_amount( $t_sponsor->amount ) . '</td>';\n\t\techo '<td><select name=\"sponsor_' . $row['bug'] . '_' . $t_sponsor->id . '\">';\n\t\tprint_enum_string_option_list( 'sponsorship', $t_sponsor->paid );\n\t\techo '</select></td>';\n\n\t\techo '</tr>';\n\t\tif ( SPONSORSHIP_PAID == $t_sponsor->paid ) {\n\t\t\t$t_total_paid += $t_sponsor->amount;\n\t\t} else {\n\t\t\t$t_total_owing += $t_sponsor->amount;\n\t\t}\n\n\t}\n\t$t_hidden_bug_list = implode( ',', $t_buglist );\n?>\n<!-- Totals -->\n<tr>\n\t<td colspan=\"5\"></td>\n\t<td><?php echo lang_get( 'total_owing' ) ?></td>\n\t<td class=\"right\"><?php echo sponsorship_format_amount( $t_total_owing ) ?></td>\n\t<td></td>\n</tr>\n<tr>\n\t<td colspan=\"5\"></td>\n\t<td><?php echo lang_get( 'total_paid' ) ?></td>\n\t<td class=\"right\"><?php echo sponsorship_format_amount( $t_total_paid ) ?></td>\n\t<td></td>\n</tr>\n\t<input type=\"hidden\" name=\"buglist\" value=\"<?php echo $t_hidden_bug_list ?>\" />\n\t<!-- BUTTONS -->\n\t<tr>\n\t\t<td colspan=\"5\">&#160;</td>\n\t\t<!-- Update Button -->\n\t\t<td colspan=\"2\">\n\t\t\t<input type=\"submit\" class=\"button\" value=\"<?php echo lang_get( 'update_sponsorship_button' ) ?>\" />\n\t\t</td>\n\t</tr>\n</table>\n</form>\n</div>\n<?php } # end sponsored issues ?>\n\n<br />\n<div>\n<?php\nhtml_button ( 'account_sponsor_page.php',\n\tlang_get( ( $t_show_all ? 'sponsor_hide' : 'sponsor_show' ) ),\n\tarray( 'show_all' => ( $t_show_all ? 0 : 1 ) ) );\n?>\n</div>\n\n<?php\nhtml_page_bottom();\n"], "fixing_code": ["<?php\n# MantisBT - A PHP based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * CALLERS\n *\tThis page is called from:\n *\t- print_menu()\n *\t- print_account_menu()\n *\n * EXPECTED BEHAVIOUR\n *\t- Display the user's current sponsorships\n *\t- Allow the user to edit the payment flag\n *\n * CALLS\n *\tThis page calls the following pages:\n *\t- account_sponsor_update.php  (to save changes)\n *\n * RESTRICTIONS & PERMISSIONS\n *\t- User must be authenticated, and not anonymous\n *   - sponsorship must be enabled\n *\n * @package MantisBT\n * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org\n * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n * @link http://www.mantisbt.org\n *\n * @uses core.php\n * @uses access_api.php\n * @uses authentication_api.php\n * @uses bug_api.php\n * @uses config_api.php\n * @uses constant_inc.php\n * @uses current_user_api.php\n * @uses database_api.php\n * @uses form_api.php\n * @uses gpc_api.php\n * @uses helper_api.php\n * @uses html_api.php\n * @uses lang_api.php\n * @uses print_api.php\n * @uses project_api.php\n * @uses sponsorship_api.php\n * @uses string_api.php\n * @uses version_api.php\n */\n\nrequire_once( 'core.php' );\nrequire_api( 'access_api.php' );\nrequire_api( 'authentication_api.php' );\nrequire_api( 'bug_api.php' );\nrequire_api( 'config_api.php' );\nrequire_api( 'constant_inc.php' );\nrequire_api( 'current_user_api.php' );\nrequire_api( 'database_api.php' );\nrequire_api( 'form_api.php' );\nrequire_api( 'gpc_api.php' );\nrequire_api( 'helper_api.php' );\nrequire_api( 'html_api.php' );\nrequire_api( 'lang_api.php' );\nrequire_api( 'print_api.php' );\nrequire_api( 'project_api.php' );\nrequire_api( 'sponsorship_api.php' );\nrequire_api( 'string_api.php' );\nrequire_api( 'version_api.php' );\n\nrequire_css( 'status_config.php' );\n\nif ( !config_get( 'enable_sponsorship' ) ) {\n\ttrigger_error( ERROR_SPONSORSHIP_NOT_ENABLED, ERROR );\n}\n\n# anonymous users are not allowed to sponsor issues\nif ( current_user_is_anonymous() ) {\n\taccess_denied();\n}\n\n$t_show_all = gpc_get_bool( 'show_all', false );\n\n# start the page\nhtml_page_top( lang_get( 'my_sponsorship' ) );\n\n$t_project = helper_get_current_project();\n?>\n<br />\n<table class=\"width100\" cellspacing=\"1\">\n<tr>\n\t<td class=\"form-title\">\n\t\t<?php echo lang_get( 'my_sponsorship' ) ?>\n\t</td>\n\t<td class=\"right\">\n\t\t<?php print_account_menu( 'account_sponsor_page.php' ) ?>\n\t</td>\n</tr>\n</table>\n<?php\n# get issues user has sponsored\n$t_user = auth_get_current_user_id();\n$t_resolved = config_get( 'bug_resolved_status_threshold' );\n$t_bug_table = db_get_table( 'bug' );\n$t_sponsor_table = db_get_table( 'sponsorship' );\n$t_payment = config_get( 'payment_enable', 0 );\n\n$t_project_clause = helper_project_specific_where( $t_project );\n\n$t_query = \"SELECT b.id as bug, s.id as sponsor, s.paid, b.project_id, b.fixed_in_version, b.status\n\tFROM $t_bug_table b, $t_sponsor_table s\n\tWHERE s.user_id=\" . db_param() . \" AND s.bug_id = b.id \" .\n\t( $t_show_all ? '' : 'AND ( b.status < ' . db_param() . ' OR s.paid < ' . SPONSORSHIP_PAID . ')' ) . \"\n\tAND $t_project_clause\n\tORDER BY s.paid ASC, b.project_id ASC, b.fixed_in_version ASC, b.status ASC, b.id DESC\";\n\n$t_result = db_query_bound( $t_query, $t_show_all ? array( $t_user ) : array( $t_user , $t_resolved ) );\n\n$t_sponsors = array();\nwhile ( $t_row = db_fetch_array( $t_result ) ) {\n\t$t_sponsors[] = $t_row;\n}\n\n$t_sponsor_count = count( $t_sponsors );\nif ( $t_sponsor_count === 0 ) {\n\techo '<p>' . lang_get( 'no_own_sponsored' ) . '</p>';\n} else {\n?>\n\n<!-- # Edit own sponsorship Form BEGIN -->\n<br />\n<div>\n<table class=\"width100\" cellspacing=\"1\">\n\n\t<!-- Headings -->\n\t<tr>\n\t\t<td class=\"form-title\" colspan=\"9\">\n\t\t\t<?php echo lang_get( 'own_sponsored' ) ?>\n\t\t</td>\n\t</tr>\n\t<tr>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'email_bug' ) ?></td>\n\t\t<td class=\"form-title\" width=\"8%\"><?php echo lang_get( 'email_project' ) ?></td>\n\t\t<td class=\"form-title\" width=\"7%\"><?php echo lang_get( 'fixed_in_version' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'email_status' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'email_handler' ) ?></td>\n\t\t<td class=\"form-title\" width=\"30%\"><?php echo lang_get( 'email_summary' ) ?></td>\n\t\t<td class=\"form-title\" width=\"8%\"><?php echo lang_get( 'amount' ) ?></td>\n\t\t<td class=\"form-title\" width=\"7%\"><?php echo lang_get( 'status' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\">&#160;</td>\n\t</tr>\n<?php\n\t$t_total_owing = 0;\n\t$t_total_paid = 0;\n\tfor ( $i = 0; $i < $t_sponsor_count; ++$i ) {\n\t\t$t_sponsor_row = $t_sponsors[$i];\n\t\t$t_bug = bug_get( $t_sponsor_row['bug'] );\n\t\t$t_sponsor = sponsorship_get( $t_sponsor_row['sponsor'] );\n\n\t\t# describe bug\n\t\t$t_status = string_attribute( get_enum_element( 'status', $t_bug->status, auth_get_current_user_id(), $t_bug->project_id ) );\n\t\t$t_resolution = string_attribute( get_enum_element( 'resolution', $t_bug->resolution, auth_get_current_user_id(), $t_bug->project_id ) );\n\t\t$t_version_id = version_get_id( $t_bug->fixed_in_version, $t_project );\n\t\tif ( ( false !== $t_version_id ) && ( VERSION_RELEASED == version_get_field( $t_version_id, 'released' ) ) ) {\n\t\t\t$t_released_label = '<a title=\"' . lang_get( 'released' ) . '\">' . $t_bug->fixed_in_version . '</a>';\n\t\t} else {\n\t\t\t$t_released_label = $t_bug->fixed_in_version;\n\t\t}\n\n\t\t# choose color based on status\n\t\t$status_label = html_get_status_css_class( $t_bug->status, auth_get_current_user_id(), $t_bug->project_id );\n\n\t\techo '<tr class=\"' . $status_label .  '\">';\n\t\techo '<td><a href=\"' . string_get_bug_view_url( $row['bug'] ) . '\">' . bug_format_id( $row['bug'] ) . '</a></td>';\n\t\techo '<td>' . string_display_line( project_get_field( $t_bug->project_id, 'name' ) ) . '&#160;</td>';\n\t\techo '<td class=\"right\">' . $t_released_label . '&#160;</td>';\n\t\techo '<td><span class=\"issue-status\" title=\"' . $t_resolution . '\">' . $t_status . '</span></td>';\n\t\techo '<td>';\n\t\tprint_user( $t_bug->handler_id );\n\t\techo '</td>';\n\n\t\t# summary\n\t\techo '<td>' . string_display_line( $t_bug->summary );\n\t\tif ( VS_PRIVATE == $t_bug->view_state ) {\n\t\t\tprintf( ' <img src=\"%s\" alt=\"(%s)\" title=\"%s\" />', $t_icon_path . 'protected.gif', lang_get( 'private' ), lang_get( 'private' ) );\n\t\t}\n\t\techo '</td>';\n\n\t\t# describe sponsorship amount\n\t\techo '<td class=\"right\">' . sponsorship_format_amount( $t_sponsor->amount ) . '</td>';\n\t\techo '<td>' . get_enum_element( 'sponsorship', $t_sponsor->paid ) . '</td>';\n\n\t\tif ( SPONSORSHIP_PAID == $t_sponsor->paid ) {\n\t\t\t$t_total_paid += $t_sponsor->amount;\n\t\t} else {\n\t\t\t$t_total_owing += $t_sponsor->amount;\n\t\t}\n\n\t\techo '<td>';\n\t\tif ( $t_payment ) {\n\t\t\techo '(paypal button)';\n\t\t} else {\n\t\t\techo '&#160;';\n\t\t}\n\t\techo '</td>';\n\t\techo '</tr>';\n\t}\n?>\n<!-- Totals -->\n<tr>\n\t<td colspan=\"5\"></td>\n\t<td><?php echo lang_get( 'total_owing' ) ?></td>\n\t<td class=\"right\"><?php echo sponsorship_format_amount( $t_total_owing ) ?></td>\n\t<td colspan=\"2\"></td>\n</tr>\n<tr>\n\t<td colspan=\"5\"></td>\n\t<td><?php echo lang_get( 'total_paid' ) ?></td>\n\t<td class=\"right\"><?php echo sponsorship_format_amount( $t_total_paid ) ?></td>\n\t<td colspan=\"2\"></td>\n</tr>\n</table>\n</div>\n<?php } # end sponsored issues\n\n$t_query = \"SELECT b.id as bug, s.id as sponsor, s.paid, b.project_id, b.fixed_in_version, b.status\n\tFROM $t_bug_table b, $t_sponsor_table s\n\tWHERE b.handler_id=\" . db_param() . \" AND s.bug_id = b.id \" .\n\t( $t_show_all ? '' : 'AND ( b.status < ' . db_param() . ' OR s.paid < ' . SPONSORSHIP_PAID . ')' ) . \"\n\tAND $t_project_clause\n\tORDER BY s.paid ASC, b.project_id ASC, b.fixed_in_version ASC, b.status ASC, b.id DESC\";\n\n$t_result = db_query_bound( $t_query, $t_show_all ? array( $t_user ) : array( $t_user , $t_resolved ) );\n\n$t_sponsors = array();\nwhile ( $t_row = db_fetch_array( $t_result ) ) {\n\t$t_sponsors[] = $t_row;\n}\n\n$t_sponsor_count = count( $t_sponsors );\nif ( $t_sponsor_count === 0 ) {\n\techo '<p>' . lang_get( 'no_sponsored' ) . '</p>';\n} else {\n?>\n\n<!-- # Edit sponsorship Form BEGIN -->\n<br />\n<div>\n<form method=\"post\" action=\"account_sponsor_update.php\">\n<?php echo form_security_field( 'account_sponsor_update' ) ?>\n<table class=\"width100\" cellspacing=\"1\">\n\n\t<!-- Headings -->\n\t<tr>\n\t\t<td class=\"form-title\" colspan=\"8\">\n\t\t\t<?php echo lang_get( 'issues_handled' ) ?>\n\t\t</td>\n\t</tr>\n\t<tr>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'email_bug' ) ?></td>\n\t\t<td class=\"form-title\" width=\"8%\"><?php echo lang_get( 'email_project' ) ?></td>\n\t\t<td class=\"form-title\" width=\"7%\"><?php echo lang_get( 'fixed_in_version' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'email_status' ) ?></td>\n\t\t<td class=\"form-title\" width=\"35%\"><?php echo lang_get( 'email_summary' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'sponsor' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'amount' ) ?></td>\n\t\t<td class=\"form-title\" width=\"10%\"><?php echo lang_get( 'status' ) ?></td>\n\t</tr>\n<?php\n\t$t_bug_list = array();\n\t$t_total_owing = 0;\n\t$t_total_paid = 0;\n\tfor ( $i = 0; $i < $t_sponsor_count; ++$i ) {\n\t\t$t_sponsor_row = $t_sponsors[$i];\n\t\t$t_bug = bug_get( $t_sponsor_row['bug'] );\n\t\t$t_sponsor = sponsorship_get( $t_sponsor_row['sponsor'] );\n\t\t$t_buglist[] = $t_sponsor_row['bug'] . ':' . $t_sponsor_row['sponsor'];\n\n\t\t# describe bug\n\t\t$t_status = string_attribute( get_enum_element( 'status', $t_bug->status, auth_get_current_user_id(), $t_bug->project_id ) );\n\t\t$t_resolution = string_attribute( get_enum_element( 'resolution', $t_bug->resolution, auth_get_current_user_id(), $t_bug->project_id ) );\n\t\t$t_version_id = version_get_id( $t_bug->fixed_in_version, $t_project );\n\t\tif ( ( false !== $t_version_id ) && ( VERSION_RELEASED == version_get_field( $t_version_id, 'released' ) ) ) {\n\t\t\t$t_released_label = '<a title=\"' . lang_get( 'released' ) . '\">' . $t_bug->fixed_in_version . '</a>';\n\t\t} else {\n\t\t\t$t_released_label = $t_bug->fixed_in_version;\n\t\t}\n\n\t\t# choose color based on status\n\t\t$status_label = html_get_status_css_class( $t_bug->status, auth_get_current_user_id(), $t_bug->project_id );\n\n\t\techo '<tr class=\"' . $status_label .  '\">';\n\t\techo '<td><a href=\"' . string_get_bug_view_url( $row['bug'] ) . '\">' . bug_format_id( $row['bug'] ) . '</a></td>';\n\t\techo '<td>' . string_display_line( project_get_field( $t_bug->project_id, 'name' ) ) . '&#160;</td>';\n\t\techo '<td class=\"right\">' . $t_released_label . '&#160;</td>';\n\t\techo '<td><a title=\"' . $t_resolution . '\"><span class=\"underline\">' . $t_status . '</span>&#160;</a></td>';\n\n\t\t# summary\n\t\techo '<td>' . string_display_line( $t_bug->summary );\n\t\tif ( VS_PRIVATE == $t_bug->view_state ) {\n\t\t\tprintf( ' <img src=\"%s\" alt=\"(%s)\" title=\"%s\" />', $t_icon_path . 'protected.gif', lang_get( 'private' ), lang_get( 'private' ) );\n\t\t}\n\t\techo '</td>';\n\n\t\t# describe sponsorship amount\n\t\techo '<td>';\n\t\tprint_user( $t_sponsor->user_id );\n\t\techo '</td>';\n\t\techo '<td class=\"right\">' . sponsorship_format_amount( $t_sponsor->amount ) . '</td>';\n\t\techo '<td><select name=\"sponsor_' . $row['bug'] . '_' . $t_sponsor->id . '\">';\n\t\tprint_enum_string_option_list( 'sponsorship', $t_sponsor->paid );\n\t\techo '</select></td>';\n\n\t\techo '</tr>';\n\t\tif ( SPONSORSHIP_PAID == $t_sponsor->paid ) {\n\t\t\t$t_total_paid += $t_sponsor->amount;\n\t\t} else {\n\t\t\t$t_total_owing += $t_sponsor->amount;\n\t\t}\n\n\t}\n\t$t_hidden_bug_list = implode( ',', $t_buglist );\n?>\n<!-- Totals -->\n<tr>\n\t<td colspan=\"5\"></td>\n\t<td><?php echo lang_get( 'total_owing' ) ?></td>\n\t<td class=\"right\"><?php echo sponsorship_format_amount( $t_total_owing ) ?></td>\n\t<td></td>\n</tr>\n<tr>\n\t<td colspan=\"5\"></td>\n\t<td><?php echo lang_get( 'total_paid' ) ?></td>\n\t<td class=\"right\"><?php echo sponsorship_format_amount( $t_total_paid ) ?></td>\n\t<td></td>\n</tr>\n\t<input type=\"hidden\" name=\"buglist\" value=\"<?php echo $t_hidden_bug_list ?>\" />\n\t<!-- BUTTONS -->\n\t<tr>\n\t\t<td colspan=\"5\">&#160;</td>\n\t\t<!-- Update Button -->\n\t\t<td colspan=\"2\">\n\t\t\t<input type=\"submit\" class=\"button\" value=\"<?php echo lang_get( 'update_sponsorship_button' ) ?>\" />\n\t\t</td>\n\t</tr>\n</table>\n</form>\n</div>\n<?php } # end sponsored issues ?>\n\n<br />\n<div>\n<?php\nhtml_button ( 'account_sponsor_page.php',\n\tlang_get( ( $t_show_all ? 'sponsor_hide' : 'sponsor_show' ) ),\n\tarray( 'show_all' => ( $t_show_all ? 0 : 1 ) ) );\n?>\n</div>\n\n<?php\nhtml_page_bottom();\n"], "filenames": ["account_sponsor_page.php"], "buggy_code_start_loc": [183], "buggy_code_end_loc": [303], "fixing_code_start_loc": [183], "fixing_code_end_loc": [303], "type": "CWE-79", "message": "Cross-site scripting (XSS) vulnerability in account_sponsor_page.php in MantisBT 1.0.0 through 1.2.15 allows remote authenticated users to inject arbitrary web script or HTML via a project name.", "other": {"cve": {"id": "CVE-2013-4460", "sourceIdentifier": "secalert@redhat.com", "published": "2014-01-10T15:55:03.773", "lastModified": "2021-01-12T18:05:59.507", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in account_sponsor_page.php in MantisBT 1.0.0 through 1.2.15 allows remote authenticated users to inject arbitrary web script or HTML via a project name."}, {"lang": "es", "value": "Vulnerabilidad cross-site scripting (XSS) en account_sponsor_page.php de MantisBT 1.0.0 hasta 1.2.15 permite a usuarios remotos autenticados inyectar script web o HTML de forma arbitraria a trav\u00e9s de un nombre de proyecto."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "6B2602F7-2D93-4E1E-9425-4EDD23752029"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.0:a1:*:*:*:*:*:*", "matchCriteriaId": "482256A6-B213-4226-AF03-9F93164AA337"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.0:a2:*:*:*:*:*:*", "matchCriteriaId": "1F005474-CEBD-48FC-9C7F-861AFF771081"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.0:a3:*:*:*:*:*:*", "matchCriteriaId": "BEF461E5-24D2-4540-A2FC-E0D4C3488B8F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "62F6B391-DDE3-4E8E-8582-85EA7287E591"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.0:rc2:*:*:*:*:*:*", "matchCriteriaId": "80DBD667-1FB9-4354-9150-A190D4D817A2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.0:rc3:*:*:*:*:*:*", "matchCriteriaId": "F27E40C0-263F-452B-8C91-E621A02EFC28"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.0:rc4:*:*:*:*:*:*", "matchCriteriaId": "CB888B14-EA67-4EDB-A3AF-ACD3F0A6227E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.0:rc5:*:*:*:*:*:*", "matchCriteriaId": "1DB45A02-2522-4E10-BC81-48750ACB42DD"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "86DE3BE3-D6C9-4905-9E61-B70776460604"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "F128A2E2-D509-4B50-95C2-1A31C5B3B31F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "140D5F68-1CAB-458C-BC8B-4F726D657FE8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.4:*:*:*:*:*:*:*", "matchCriteriaId": "0D25F4F5-7678-41C1-93CB-305883A08527"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.5:*:*:*:*:*:*:*", "matchCriteriaId": "D1A1316D-314B-4740-A836-D5E6319F4B28"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.6:*:*:*:*:*:*:*", "matchCriteriaId": "DBD27CCE-28C4-43CC-8CBD-D7FFB46171AC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.7:*:*:*:*:*:*:*", "matchCriteriaId": "97298C43-B881-4C11-ADB6-17A8E43EB84E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.8:*:*:*:*:*:*:*", "matchCriteriaId": "7257ADD7-C9B7-4F85-AA13-615DD033FD5C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.9:*:*:*:*:*:*:*", "matchCriteriaId": "DE6A94C0-48A1-4D42-AC43-7B4E959C4E21"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "02FE950B-5E29-4FAA-9BE5-79F38B4C38F7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.0:a1:*:*:*:*:*:*", "matchCriteriaId": "45FF2B45-AA64-4428-8F6E-65C5171990CB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.0:a2:*:*:*:*:*:*", "matchCriteriaId": "CC868663-1E48-4F9A-B687-5B48D016611B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.0:a3:*:*:*:*:*:*", "matchCriteriaId": "4F04ED02-4D99-45CF-9BEC-AC0F648748EA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.0:a4:*:*:*:*:*:*", "matchCriteriaId": "0AC08731-C4BB-4D84-ADBE-80054149BF33"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "35AAF0B4-31B5-4849-813F-63D9546C2E16"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.0:rc2:*:*:*:*:*:*", "matchCriteriaId": "FB98EF06-7D6E-4D5F-819D-21B437E91B58"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.0:rc3:*:*:*:*:*:*", "matchCriteriaId": "66AB409E-5A5B-4455-8B68-22C32152681B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "D6F2BA78-D054-4E49-ABCA-637922898BF7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "4595B1E3-25AB-489E-A847-FDBF2554DD6D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.3:*:*:*:*:*:*:*", "matchCriteriaId": "E6A13A38-E149-42A7-9309-BC991521320B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.4:*:*:*:*:*:*:*", "matchCriteriaId": "C11A8F17-5253-475B-89FF-A26EA7531E13"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.5:*:*:*:*:*:*:*", "matchCriteriaId": "4A88B09D-CDCF-45FD-B004-13B597DA4F48"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.6:*:*:*:*:*:*:*", "matchCriteriaId": "49583BE8-B832-4E9F-B154-47A26C72489D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.7:*:*:*:*:*:*:*", "matchCriteriaId": "E2501F40-3630-4528-BE0A-61D4BB6EC7FE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.8:*:*:*:*:*:*:*", "matchCriteriaId": "9223DAF7-D03E-4A4E-8AB5-5CEB87DFF2C3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.9:*:*:*:*:*:*:*", "matchCriteriaId": "078C0943-C27C-44A9-B00D-5A261C58D6CF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "CFF77ABF-0A03-437A-B241-1EF2BBB83D24"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.0:alpha1:*:*:*:*:*:*", "matchCriteriaId": "9DA2615A-CD65-4765-AB0A-D72C2BEB00F5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.0:alpha2:*:*:*:*:*:*", "matchCriteriaId": "7D09CC46-DFA2-408D-8720-05C23E73C859"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.0:alpha3:*:*:*:*:*:*", "matchCriteriaId": "3461212B-A96B-4D38-A722-84E7418C2A7A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "7B6DEE14-744B-4DE4-BDCF-E4E4D37F70A0"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.0:rc2:*:*:*:*:*:*", "matchCriteriaId": "D4462BEE-39B6-47BD-B08F-5BE1FD918221"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "5F096CD6-534E-4ABF-B2DF-D4B55B8C5F6A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.2:*:*:*:*:*:*:*", "matchCriteriaId": "A66AB537-6FBA-4A51-B10C-BF61F54BC01B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.3:*:*:*:*:*:*:*", "matchCriteriaId": "A50835BF-D28B-47FF-81F0-C34D95D6F2E9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.4:*:*:*:*:*:*:*", "matchCriteriaId": "BA0EB9A6-1DFD-4C17-A002-0899DA252A56"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.5:*:*:*:*:*:*:*", "matchCriteriaId": "BBA33285-3EE7-43FD-8347-E7D9A18DC134"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.6:*:*:*:*:*:*:*", "matchCriteriaId": "8827C2B4-EBEC-4D64-9AC8-07A048467F40"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.7:*:*:*:*:*:*:*", "matchCriteriaId": "1F32DFF4-6448-46FD-9358-4FB1C310EC2E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.8:*:*:*:*:*:*:*", "matchCriteriaId": "20328CE4-0488-43B8-AA64-A6CB2230C74C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.9:*:*:*:*:*:*:*", "matchCriteriaId": "0BDEB950-D3F4-4B96-B456-B8441DC403D9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.10:*:*:*:*:*:*:*", "matchCriteriaId": "FE69E6A6-8CD2-4C8A-A30A-CB0A04AC539F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.11:*:*:*:*:*:*:*", "matchCriteriaId": "D464F7CF-A156-4EE5-BB59-6C759448EB23"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.13:*:*:*:*:*:*:*", "matchCriteriaId": "5F1BFB72-CDD6-466E-ACAD-EA442D11C22F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.14:*:*:*:*:*:*:*", "matchCriteriaId": "DD11DD1B-EC1C-48F4-B4C6-1CF6A0F80970"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.15:*:*:*:*:*:*:*", "matchCriteriaId": "5899A557-AC72-4CB0-984F-F274AE5932BB"}]}]}], "references": [{"url": "http://seclists.org/oss-sec/2013/q4/168", "source": "secalert@redhat.com"}, {"url": "http://www.mantisbt.org/bugs/view.php?id=16513", "source": "secalert@redhat.com"}, {"url": "https://github.com/mantisbt/mantisbt/commit/0002d106a6cd35cb0a6fe03246531a4e3f32c9d0#diff-4122320b011a3291cd45da074a867076", "source": "secalert@redhat.com", "tags": ["Exploit", "Patch"]}]}, "github_commit_url": "https://github.com/mantisbt/mantisbt/commit/0002d106a6cd35cb0a6fe03246531a4e3f32c9d0#diff-4122320b011a3291cd45da074a867076"}}