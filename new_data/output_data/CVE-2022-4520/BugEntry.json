{"buggy_code": ["<%--\n~ Copyright (c) 2005-2010, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n~\n~ WSO2 Inc. licenses this file to you under the Apache License,\n~ Version 2.0 (the \"License\"); you may not use this file except\n~ in compliance with the License.\n~ You may obtain a copy of the License at\n~\n~ http://www.apache.org/licenses/LICENSE-2.0\n~\n~ Unless required by applicable law or agreed to in writing,\n~ software distributed under the License is distributed on an\n~ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n~ KIND, either express or implied. See the License for the\n~ specific language governing permissions and limitations\n~ under the License.\n--%>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n<%@ page import=\"org.owasp.encoder.Encode\" %>\n<%@ page import=\"org.wso2.carbon.utils.ServerConstants\" %>\n<%@ page import=\"org.wso2.carbon.registry.search.ui.clients.SearchServiceClient\" %>\n<%@ page import=\"org.wso2.carbon.registry.search.stub.beans.xsd.CustomSearchParameterBean\" %>\n<%@ page import=\"org.wso2.carbon.registry.search.stub.beans.xsd.ArrayOfString\" %>\n<%@ page import=\"org.wso2.carbon.utils.CarbonUtils\" %>\n\n<%@ taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\" %>\n<%@ taglib uri=\"http://wso2.org/projects/carbon/taglibs/carbontags.jar\" prefix=\"carbon\" %>\n\n\n<jsp:include page=\"../registry_common/registry_common-i18n-ajaxprocessor.jsp\"/>\n<script type=\"text/javascript\" src=\"../registry_common/js/registry_validation.js\"></script>\n<script type=\"text/javascript\" src=\"../registry_common/js/registry_common.js\"></script>\n<carbon:jsi18n\n        resourceBundle=\"org.wso2.carbon.registry.search.ui.i18n.JSResources\"\n        request=\"<%=request%>\" namespace=\"org.wso2.carbon.registry.search.ui\"/>\n<script type=\"text/javascript\" src=\"../search/js/search.js\"></script>\n<script type=\"text/javascript\" src=\"../ajax/js/prototype.js\"></script>\n<link rel=\"stylesheet\" type=\"text/css\"\n      href=\"../resources/css/registry.css\"/>\n<style type=\"text/css\">\n    table tbody tr td {\n        border: 0 none;\n        padding: 0;\n        text-align: left;\n        vertical-align: top;\n    }\n\n</style>\n\n<fmt:bundle basename=\"org.wso2.carbon.registry.search.ui.i18n.Resources\">\n\n<%\n    String createdAfter = null, createdBefore = null, updatedAfter = null, updatedBefore = null,\n            resourcePath = null, author = null, updater = null, tags = null, content = null, commentWords = null,\n            propertyName = null, rightPropertyValue = null, leftPropertyValue = null, mediaType = null, associationType = null, associationDest = null,\n            createdRangeNegate = null, updatedRangeNegate = null, authorNameNegate = null, updaterNameNegate = null,\n            rightOp = null, leftOp = null, mediaTypeNegate = null, lblPropName = null;\n\n    String filterName = request.getParameter(\"filterName\");\n    boolean hasParameters = false;\n    StringBuilder sb = new StringBuilder();\n\n    if (filterName != null) {\n        String cookie = (String) session.getAttribute(ServerConstants.ADMIN_SERVICE_COOKIE);\n        try {\n            SearchServiceClient client = new SearchServiceClient(cookie, config, session);\n            CustomSearchParameterBean bean = client.getAdvancedSearchFilter(filterName);\n            if (bean.getParameterValues() != null) {\n                ArrayOfString[] arrayOfStrings = bean.getParameterValues();\n                for (ArrayOfString arrayOfString : arrayOfStrings) {\n                    String[] array = arrayOfString.getArray();\n                    if (array != null && array.length == 2) {\n                        sb.append(array[0]).append(\"=\").append(array[1]).append(\"&\");\n                        if (\"createdAfter\".equals(array[0])) {\n                            createdAfter = array[1];\n                            if(createdAfter==null){\n                                createdAfter = \"\";\n                            }\n                        } else if (\"createdBefore\".equals(array[0])) {\n                            createdBefore = array[1];\n                            if(createdBefore==null){\n                                createdBefore = \"\";\n                            }\n                        } else if (\"updatedAfter\".equals(array[0])) {\n                            updatedAfter = array[1];\n                            if(updatedAfter==null){\n                                updatedAfter = \"\";\n                            }\n                        } else if (\"updatedBefore\".equals(array[0])) {\n                            updatedBefore = array[1];\n                            if(updatedBefore==null){\n                                updatedBefore = \"\";\n                            }\n                        } else if (\"resourcePath\".equals(array[0])) {\n                            resourcePath = array[1];\n                            if(resourcePath==null){\n                                resourcePath = \"\";\n                            }\n                        } else if (\"author\".equals(array[0])) {\n                            author = array[1];\n                            if(author==null){\n                                author = \"\";\n                            }\n                        } else if (\"updater\".equals(array[0])) {\n                            updater = array[1];\n                            if(updater==null){\n                                updater = \"\";\n                            }\n                        } else if (\"tags\".equals(array[0])) {\n                            tags = array[1];\n                            if(tags==null){\n                                tags = \"\";\n                            }\n                        } else if (\"content\".equals(array[0])) {\n                            content = array[1];\n                            if(content==null){\n                                content = \"\";\n                            }\n                        } else if (\"commentWords\".equals(array[0])) {\n                            commentWords = array[1];\n                            if(commentWords==null){\n                                commentWords = \"\";\n                            }\n                        } else if (\"associationType\".equals(array[0])) {\n                            associationType = array[1];\n                            if(associationType==null){\n                                associationType = \"\";\n                            }\n                        } else if (\"associationDest\".equals(array[0])) {\n                            associationDest = array[1];\n                            if(associationDest==null){\n                                associationDest = \"\";\n                            }\n                        } else if (\"propertyName\".equals(array[0])) {\n                            propertyName = array[1];\n                            lblPropName = array[1];\n                            if(propertyName==null){\n                                propertyName = \"\";\n                                lblPropName = \"-\";\n                            }\n                            propertyName = Encode.forHtml(propertyName);\n                            lblPropName = Encode.forHtml(lblPropName);\n                        } else if (\"leftPropertyValue\".equals(array[0])) {\n                            leftPropertyValue = array[1];\n                            if(leftPropertyValue==null){\n                                leftPropertyValue = \"\";\n                            }\n                        } else if (\"rightPropertyValue\".equals(array[0])) {\n                            rightPropertyValue = array[1];\n                            if(rightPropertyValue==null){\n                                rightPropertyValue = \"\";\n                            }\n                        } else if (\"mediaType\".equals(array[0])) {\n                            mediaType = array[1];\n                            if(mediaType==null){\n                                mediaType = \"\";\n                            }\n                        } else if (\"createdRangeNegate\".equals(array[0])) {\n                        \tcreatedRangeNegate = array[1];\n                            if(createdRangeNegate==null){\n                                createdRangeNegate = \"\";\n                            }\n                        } else if (\"updatedRangeNegate\".equals(array[0])) {\n                        \tupdatedRangeNegate = array[1];\n                            if(updatedRangeNegate==null){\n                                updatedRangeNegate = \"\";\n                            }\n                        } else if (\"authorNameNegate\".equals(array[0])) {\n                        \tauthorNameNegate = array[1];\n                            if(authorNameNegate==null){\n                                authorNameNegate = \"\";\n                            }\n                        } else if (\"updaterNameNegate\".equals(array[0])) {\n                        \tupdaterNameNegate = array[1];\n                            if(updaterNameNegate==null){\n                                updaterNameNegate = \"\";\n                            }\n                        } else if (\"rightOp\".equals(array[0])) {\n                            rightOp = array[1];\n                            if(rightOp == null) {\n                                rightOp = \"\";\n                            }\n                        } else if (\"leftOp\".equals(array[0])) {\n                            leftOp = array[1];\n                        \tif (leftOp == null) {\n                                leftOp = \"\";\n                            }\n                        } else if (\"mediaTypeNegate\".equals(array[0])) {\n                        \tmediaTypeNegate = array[1];\n                            if(mediaTypeNegate==null){\n                                mediaTypeNegate = \"\";\n                            }\n                        }\n                    }\n                }\n            }\n        } catch (Exception e) {\n            response.setStatus(500);\n%>\n<script type=\"text/javascript\">\n    CARBON.showErrorDialog(\"<%=Encode.forHtml(e.getMessage())%>\");\n</script>\n<%\n            return;\n        }\n    } else {\n\n        createdAfter = request.getParameter(\"createdAfter\");\n        if (createdAfter == null) {\n            createdAfter = \"\";\n        } else {\n            hasParameters = true;\n        }\n        createdBefore = request.getParameter(\"createdBefore\");\n        if (createdBefore == null) {\n            createdBefore = \"\";\n        } else {\n            hasParameters = true;\n        }\n        updatedAfter = request.getParameter(\"updatedAfter\");\n        if (updatedAfter == null) {\n            updatedAfter = \"\";\n        } else {\n            hasParameters = true;\n        }\n        updatedBefore = request.getParameter(\"updatedBefore\");\n        if (updatedBefore == null) {\n            updatedBefore = \"\";\n        } else {\n            hasParameters = true;\n        }\n        resourcePath = request.getParameter(\"resourcePath\");\n        if (resourcePath == null) {\n            resourcePath = \"\";\n        } else {\n            hasParameters = true;\n        }\n        author = request.getParameter(\"author\");\n        if (author == null) {\n            author = \"\";\n        } else {\n            hasParameters = true;\n        }\n        updater = request.getParameter(\"updater\");\n        if (updater == null) {\n            updater = \"\";\n        } else {\n            hasParameters = true;\n        }\n        tags = request.getParameter(\"tags\");\n        if (tags == null) {\n            tags = \"\";\n        } else {\n            hasParameters = true;\n        }\n        content = request.getParameter(\"content\");\n        if (content == null) {\n            content = \"\";\n        } else {\n        hasParameters = true;\n        }\n        commentWords = request.getParameter(\"commentWords\");\n        if (commentWords == null) {\n            commentWords = \"\";\n        } else {\n            hasParameters = true;\n        }\n        associationType = request.getParameter(\"associationType\");\n        if (associationType == null) {\n            associationType = \"\";\n        } else {\n            hasParameters = true;\n        }\n        associationDest = request.getParameter(\"associationDest\");\n        if (associationDest == null) {\n            associationDest = \"\";\n        } else {\n            hasParameters = true;\n        }\n        propertyName = request.getParameter(\"propertyName\");\n        if (propertyName == null) {\n            propertyName = \"\";\n            lblPropName = \"-\";\n        } else {\n            propertyName = Encode.forHtml(propertyName);\n            hasParameters = true;\n            lblPropName = propertyName;\n        }\n        leftPropertyValue = request.getParameter(\"leftPropertyValue\");\n        rightPropertyValue = request.getParameter(\"rightPropertyValue\");\n        if (leftPropertyValue == null) {\n            leftPropertyValue = \"\";\n        }\n        if (rightPropertyValue == null) {\n            rightPropertyValue = \"\";\n        }\n        \n        authorNameNegate = request.getParameter(\"authorNameNegate\"); \n        updaterNameNegate = request.getParameter(\"updaterNameNegate\"); \n        \n        if(authorNameNegate == null)\n        \tauthorNameNegate = \"\";\n        \n        if(updaterNameNegate == null)\n        \tupdaterNameNegate = \"\";\n        \n        mediaType = request.getParameter(\"mediaType\");        \n        if (mediaType == null) {\n            mediaType = \"\";\n        } else {\n            hasParameters = true;\n        }\n        \n        mediaTypeNegate = request.getParameter(\"mediaTypeNegate\");\n        if(mediaTypeNegate == null)\n        \tmediaTypeNegate = \"\";\n        \n        leftOp = request.getParameter(\"leftOp\");\n        rightOp = request.getParameter(\"rightOp\");\n        if(rightOp == null) rightOp = \"\";\n        if(leftOp == null) leftOp = \"\";\n    }\n%>\n\n<form id=\"advancedSearchForm\" name=\"advancedSearch\" onsubmit=\"return submitAdvSearchForm()\"\n      action=\"advancedSearch-ajaxprocessor.jsp\" method=\"get\"\n        <%=hasParameters ? \"style=\\\"display:none\\\"\" : \"\"%>>\n         <input type=\"hidden\" value=\"<%=leftOp%>\" id=\"hiddenOpLeft\"/>\n         <input type=\"hidden\" value=\"<%=rightOp%>\" id=\"hiddenOpRight\"/>\n\n            <div class=\"search-subtitle\" style=\"padding-left:10px;\"><fmt:message key=\"search.for.resources\"/></div>\n            <table class=\"normal\" id=\"customTable\" style=\"width:100%;\">\n                <tr>\n                    <td class=\"leftCol-small\"><fmt:message key=\"resource.name\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"resourcePath\" value=\"<%=resourcePath%>\" id=\"#_resourceName\"\n                               onkeypress=\"handletextBoxKeyPress(event)\"/>\n                    </td>\n                </tr>\n                <% for(String serverRole : CarbonUtils.getServerConfiguration().getProperties(\"ServerRoles.Role\")){\n                    if(serverRole.equalsIgnoreCase(\"GovernanceRegistry\")){%>\n                        <tr>\n                            <td class=\"leftCol-small\"><fmt:message key=\"content.name\"/></td>\n                            <td>\n                                <input type=\"text\" name=\"content\" value=\"<%=content%>\" id=\"#_content\"\n                                       onkeypress=\"handletextBoxKeyPress(event)\"/>\n                            </td>\n                        </tr>\n                    <%}%>\n                <%}%>\t\t\t\t\n                <tr>\n                    <td valign=\"top\"><fmt:message key=\"created\"/></td>\n                    <td>\n                        <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                            <tr>\n                                <td>\n                                    <fmt:message key=\"from\"/> :\n                                </td>\n                                <td>\n                                    <a class=\"icon-link\" style=\"background-image: url( ../admin/images/calendar.gif);\" onclick=\"jQuery('#cfromDate').datepicker( 'show' );\" href=\"javascript:void(0)\"></a>\n\n                                    <input type=\"text\" name=\"createdAfter\" value=\"<%=createdAfter%>\"\n                                           id=\"cfromDate\"\n                                           style=\"width:140px;\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n                                </td>\n                                <td>\n                                    <fmt:message key=\"to\"/> :\n                                </td>\n                                <td>\n                                    <a class=\"icon-link\" style=\"background-image: url( ../admin/images/calendar.gif);\" onclick=\"jQuery('#ctoDate').datepicker( 'show' );\" href=\"javascript:void(0)\"></a>\n                                    <input type=\"text\" name=\"createdBefore\" value=\"<%=createdBefore%>\"\n                                           id=\"ctoDate\"\n                                           style=\"width:140px;\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n\n                                    <% if (filterName != null && !createdRangeNegate.equals(\"\")) { %>\n                                        <input type=\"checkbox\" name=\"createdRangeNegate\" checked=\"checked\" /> not\n                                    <% } else {%>\n                                        <input type=\"checkbox\" name=\"createdRangeNegate\" /> not\n                                    <% } %>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td></td>\n                                <td class=\"helpTextTop\" style=\"margin:0px;padding:0px;\">\n                                    <fmt:message key=\"mm.dd.yyyy\"/>\n                                </td>\n                                <td></td>\n                                <td class=\"helpTextTop\" style=\"margin:0px;padding:0px;\">\n                                    <fmt:message key=\"mm.dd.yyyy\"/>\n                                </td>\n                            </tr>\n                        </table>\n                    </td>\n\n                </tr>\n                <tr>\n                    <td valign=\"top\"><fmt:message key=\"updated\"/></td>\n                    <td>\n                        <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                            <tr>\n                                <td>\n                                    <fmt:message key=\"from\"/> :\n                                </td>\n                                <td>\n                                     <a class=\"icon-link\" style=\"background-image: url( ../admin/images/calendar.gif);\" onclick=\"jQuery('#ufromDate').datepicker( 'show' );\" href=\"javascript:void(0)\"></a>\n                                    <input type=\"text\" name=\"updatedAfter\" value=\"<%=updatedAfter%>\"\n                                           id=\"ufromDate\"\n                                           style=\"width:140px;\" onkeypress=\"handletextBoxKeyPress(event)\"/>                                         \n                                </td>\n                                <td>\n                                    <fmt:message key=\"to\"/> :\n                                </td>\n                                <td>\n                                    <a class=\"icon-link\" style=\"background-image: url( ../admin/images/calendar.gif);\" onclick=\"jQuery('#utoDate').datepicker( 'show' );\" href=\"javascript:void(0)\"></a>\n                                    <input type=\"text\" name=\"updatedBefore\" value=\"<%=updatedBefore%>\"\n                                           id=\"utoDate\"\n                                           style=\"width:140px;\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n\n                                    <% if (filterName != null && !updatedRangeNegate.equals(\"\")) { %>\n                                        <input type=\"checkbox\" name=\"updatedRangeNegate\" checked=\"checked\" /> not\n                                    <% } else { %>\n                                        <input type=\"checkbox\" name=\"updatedRangeNegate\" /> not\n                                    <% } %>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td></td>\n                                <td class=\"helpTextTop\" style=\"margin:0px;padding:0px;\">\n                                    <fmt:message key=\"mm.dd.yyyy\"/>\n                                </td>\n                                <td></td>\n                                <td class=\"helpTextTop\" style=\"margin:0px;padding:0px;\">\n                                    <fmt:message key=\"mm.dd.yyyy\"/>\n                                </td>\n                            </tr>\n                        </table>\n                    </td>\n\n                </tr>\n                <tr>\n                    <td><fmt:message key=\"created.by\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"author\" value=\"<%=author%>\" id=\"#_author\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n\n                        <% if (filterName != null && !authorNameNegate.equals(\"\")) { %>\n                            <input type=\"checkbox\" name=\"authorNameNegate\" checked=\"checked\" /> not\n                        <% } else { %>\n                            <input type=\"checkbox\" name=\"authorNameNegate\" /> not\n                        <% } %>\n\n                    </td>\n\n                </tr>\n                <tr>\n                    <td><fmt:message key=\"updated.by\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"updater\" value=\"<%=updater%>\" id=\"#_updater\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n\n                        <% if (filterName != null && !updaterNameNegate.equals(\"\")) { %>\n                            <input type=\"checkbox\" name=\"updaterNameNegate\" checked=\"checked\" /> not\n                        <% } else { %>\n                            <input type=\"checkbox\" name=\"updaterNameNegate\" /> not\n                        <% } %>\n                    </td>\n\n                </tr>\n                <tr>\n                    <td><fmt:message key=\"tags\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"tags\" value=\"<%=tags%>\" id=\"#_tags\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n                    </td>\n                </tr>\n                <tr>\n\n                    <td><fmt:message key=\"comments\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"commentWords\" value=\"<%=commentWords%>\" id=\"#_comments\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n                    </td>\n                </tr>\n                <tr>\n\n                    <td><fmt:message key=\"associationType\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"associationType\" value=\"<%=associationType%>\" id=\"#_associationType\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n                    </td>\n                </tr>\n                <tr>\n\n                    <td><fmt:message key=\"associationDest\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"associationDest\" value=\"<%=associationDest%>\" id=\"#_associationDest\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n                    </td>\n                </tr>\n                <tr>\n                    <td><fmt:message key=\"property.name\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"propertyName\" value=\"<%=propertyName%>\"\n                               id=\"#_propertyName\" onkeypress=\"handletextBoxKeyPress(event)\" onblur=\"setPropertyName()\"/>\n                    </td>\n                </tr>\n                <tr>\n                    <td><fmt:message key=\"property.value\"/></td>\n                    <td>\n                       <%-- <input type=\"text\" name=\"propertyValue\" value=\"<%=propertyValue%>\"\n                               id=\"#_propertyValue\" onkeypress=\"handletextBoxKeyPress(event)\"/> --%>\n\t\t\t\t\t\t<input type=\"text\" onkeypress=\"return isNumberKey(event)\" id=\"valueLeft\" name=\"leftPropertyValue\" value=\"<%=leftPropertyValue%>\"/>\n\n\t\t\t\t\t\t<select id=\"opLeft\" name=\"leftOp\" >\n\t\t\t\t\t\t    <option value=\"na\"></option>\n                          \t<option value=\"gt\">&#60;</option>\n                          \t<option value=\"ge\">&#8804;</option>\n                        </select>\n\n                        <label>&#123;</label>\n                        <label id=\"lblPropName\"><%=lblPropName%></label>\n                        <label>&#125;</label>\n\n\t\t\t\t\t\t<select onChange=\"adjustAllOpInput();\" id=\"opRight\" name=\"rightOp\">\n\t\t\t\t\t\t    <option value=\"na\"></option>\n  \t\t\t\t\t\t\t<option value=\"lt\">&#60;</option>\n  \t\t\t\t\t\t\t<option value=\"le\">&#8804;</option>\n  \t\t\t\t\t\t\t<option value=\"eq\">&#61;</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t<input type=\"text\" onkeypress=\"return isNumberKey(event)\" id=\"valueRight\" name=\"rightPropertyValue\" value=\"<%=rightPropertyValue%>\"/>\n\n                        <% if (filterName == null) { %>\n\n                        <script type=\"text/javascript\">\n                            setIndexForOp(\"opLeft\", \"<%=leftOp%>\");\n                            setIndexForOp(\"opRight\", \"<%=rightOp%>\");\n                            adjustPropertyInput();\n                        </script>\n                        <% } %>\n                    </td>\n                </tr>\n               <%-- <tr>\n                    <td><fmt:message key=\"including.content\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"content\" value=\"\" id=\"#_content\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n                    </td>\n                </tr>--%>\n\n                <%\n                    String isFilter = \"0\";\n                    String filterMediaType = \"\";\n                    if (request.getParameter(\"filterName\") != null && mediaType != null && mediaType.length() != 0) {\n                        isFilter = \"1\";\n                        filterMediaType = mediaType;\n                    }\n                %>\n\n                <tr>\n                    <td style=\"vertical-align:center !important\"><fmt:message key=\"media.type\"/></td>\n                    <td style=\"vertical-align:top !important\">\n                        <div class=\"yui-skin-sam\" style=\"width:200px;margin-left:0px;float:left\">\n\n\n                            <div id=\"mediaTypeAutoComplete\">\n                                <input id=\"#_mediaType\" name=\"mediaType\" type=\"text\" value=\"<%=mediaType%>\" style=\"width:auto\" onblur='adjustMediaTypeNegate(\"<%=isFilter%>\", \"<%=filterMediaType%>\")' />\n\n\n                                                                                                                         \n                                <div id=\"customUIButtonDiv\">\n                                    <%\n                                        if (isFilter.equals(\"1\")) {\n                                    %><a href=\"javascript:collapseCustomUI()\" class=\"loadMediaTypeButton\"><fmt:message key=\"fewer\"/> <img src=\"../search/images/arrow-up.png\" /></a><%\n                                        }\n                                    %>\n                                </div>\n                                <div id=\"mediaTypeContainer\"></div>\n\n                            </div>\n\n                        </div>\n\n                        <div id=\"mediaTypeNegateDiv\" style=\"float:left;margin-left:20px\" >\n                            <script type=\"text/javascript\">\n\n                                   var mediaTypeNegateObj = document.getElementById('mediaTypeNegateDiv');\n\n                                   if(isCustomUIDivEmpty()) {\n                                          mediaTypeNegateObj.style.marginLeft = \"160px\";\n                                   }\n                            </script>\n\n                            <% if (filterName != null && !mediaTypeNegate.equals(\"\")) { %>\n                                <input name=\"mediaTypeNegate\" id=\"mediaTypeNegate\" type=\"checkbox\" checked=\"checked\" /> not\n                            <% } else { %>\n                                <input name=\"mediaTypeNegate\" id=\"mediaTypeNegate\" type=\"checkbox\" /> not\n                            <% } %>\n                        </div>\n\t\t\t\t\t</td>\n\n                        <%--<input type=\"text\" name=\"mediaType\" value=\"<%= mediaType%>\" id=\"#_mediaType\" onkeypress=\"handleMediaTypeKeypress(event)\"></td>\n                        --%>\n                </tr>\n                <tr>\n                    <td colspan=\"2\" style=\"padding:0px !important;margin:0px !important\" id=\"customDiv\">\n                        <%\n                            if (request.getParameter(\"filterName\") != null && mediaType != null &&\n                                    mediaType.length() > 0) {\n                                String includePath = \"customSearch-ajaxprocessor.jsp?mediaType=\" + mediaType +\n                                                     \"&\" + sb.toString().trim();\n                        %>\n                                <jsp:include page=\"<%=includePath%>\"/>\n                        <%\n                            }\n                        %>\n                    </td>\n                </tr>\n\n                <tr>\n                    <td class=\"buttonRow\" colspan=\"2\">\n                        <input type=\"button\" id=\"#_0\" value=\"<fmt:message key=\"search\"/>\" class=\"button\"\n                               onclick=\"submitAdvSearchForm()\"/>\n                         <input type=\"button\" id=\"#_1\" value=\"<fmt:message key=\"clear\"/>\" class=\"button\"\n                               onclick=\"clearAll()\"/>\n                    </td>\n                </tr>\n            </table>\n\n\n\n<div id=\"commentsForm\" style=\"display:none;\">\n    <table cellpadding=\"0\" cellspacing=10 border=\"0\" style=\"width:100%\" class=\"form-table\">\n        <tr>\n            <td class=\"leftCol-small\"><fmt:message key=\"commented.user\"/></td>\n            <td>\n                <input type=\"text\" name=\"commentedUser\" value=\"\" id=\"#_commentedUser\"\n                       style=\"width:100px;\"/>\n            </td>\n        </tr>\n        <tr>\n            <td valign=\"top\"><fmt:message key=\"date\"/></td>\n            <td>\n                <div style=\"width:200px;font-style:italic;\"><fmt:message\n                        key=\"only.find.results.updated\"/></div>\n                <fmt:message key=\"from\"/>: <input type=\"text\" name=\"fromDate\" value=\"\"\n                                                  id=\"#_fromDate\"\n                                                  style=\"width:100px;\"/>\n                <fmt:message key=\"to\"/>: <input type=\"text\" name=\"toDate\" value=\"\" id=\"#_toDate\"\n                                                style=\"width:100px;\"/>\n            </td>\n        </tr>\n        <tr>\n            <td valign=\"top\"><fmt:message key=\"resource.name\"/></td>\n            <td>\n                <input type=\"text\" name=\"resourceName\" value=\"\" id=\"#_resourceName2\"/>\n            </td>\n        </tr>\n        <tr>\n            <td><fmt:message key=\"commented.text\"/></td>\n            <td>\n                <input type=\"text\" name=\"commentedText\" value=\"\" id=\"#_commentedText\"/>\n            </td>\n        </tr>\n        <tr>\n            <td><fmt:message key=\"created.by1\"/></td>\n            <td>\n                <input type=\"text\" name=\"createdBy\" value=\"\" id=\"#_createdBy\"/>\n            </td>\n        </tr>\n    </table>\n</div>\n\n\n</form>\n</fmt:bundle>\n"], "fixing_code": ["<%--\n~ Copyright (c) 2005-2010, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.\n~\n~ WSO2 Inc. licenses this file to you under the Apache License,\n~ Version 2.0 (the \"License\"); you may not use this file except\n~ in compliance with the License.\n~ You may obtain a copy of the License at\n~\n~ http://www.apache.org/licenses/LICENSE-2.0\n~\n~ Unless required by applicable law or agreed to in writing,\n~ software distributed under the License is distributed on an\n~ \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n~ KIND, either express or implied. See the License for the\n~ specific language governing permissions and limitations\n~ under the License.\n--%>\n<%@ page contentType=\"text/html;charset=UTF-8\" language=\"java\" %>\n<%@ page import=\"org.owasp.encoder.Encode\" %>\n<%@ page import=\"org.wso2.carbon.utils.ServerConstants\" %>\n<%@ page import=\"org.wso2.carbon.registry.search.ui.clients.SearchServiceClient\" %>\n<%@ page import=\"org.wso2.carbon.registry.search.stub.beans.xsd.CustomSearchParameterBean\" %>\n<%@ page import=\"org.wso2.carbon.registry.search.stub.beans.xsd.ArrayOfString\" %>\n<%@ page import=\"org.wso2.carbon.utils.CarbonUtils\" %>\n\n<%@ taglib prefix=\"fmt\" uri=\"http://java.sun.com/jsp/jstl/fmt\" %>\n<%@ taglib uri=\"http://wso2.org/projects/carbon/taglibs/carbontags.jar\" prefix=\"carbon\" %>\n\n\n<jsp:include page=\"../registry_common/registry_common-i18n-ajaxprocessor.jsp\"/>\n<script type=\"text/javascript\" src=\"../registry_common/js/registry_validation.js\"></script>\n<script type=\"text/javascript\" src=\"../registry_common/js/registry_common.js\"></script>\n<carbon:jsi18n\n        resourceBundle=\"org.wso2.carbon.registry.search.ui.i18n.JSResources\"\n        request=\"<%=request%>\" namespace=\"org.wso2.carbon.registry.search.ui\"/>\n<script type=\"text/javascript\" src=\"../search/js/search.js\"></script>\n<script type=\"text/javascript\" src=\"../ajax/js/prototype.js\"></script>\n<link rel=\"stylesheet\" type=\"text/css\"\n      href=\"../resources/css/registry.css\"/>\n<style type=\"text/css\">\n    table tbody tr td {\n        border: 0 none;\n        padding: 0;\n        text-align: left;\n        vertical-align: top;\n    }\n\n</style>\n\n<fmt:bundle basename=\"org.wso2.carbon.registry.search.ui.i18n.Resources\">\n\n<%\n    String createdAfter = null, createdBefore = null, updatedAfter = null, updatedBefore = null,\n            resourcePath = null, author = null, updater = null, tags = null, content = null, commentWords = null,\n            propertyName = null, rightPropertyValue = null, leftPropertyValue = null, mediaType = null, associationType = null, associationDest = null,\n            createdRangeNegate = null, updatedRangeNegate = null, authorNameNegate = null, updaterNameNegate = null,\n            rightOp = null, leftOp = null, mediaTypeNegate = null, lblPropName = null;\n\n    String filterName = request.getParameter(\"filterName\");\n    boolean hasParameters = false;\n    StringBuilder sb = new StringBuilder();\n\n    if (filterName != null) {\n        String cookie = (String) session.getAttribute(ServerConstants.ADMIN_SERVICE_COOKIE);\n        try {\n            SearchServiceClient client = new SearchServiceClient(cookie, config, session);\n            CustomSearchParameterBean bean = client.getAdvancedSearchFilter(filterName);\n            if (bean.getParameterValues() != null) {\n                ArrayOfString[] arrayOfStrings = bean.getParameterValues();\n                for (ArrayOfString arrayOfString : arrayOfStrings) {\n                    String[] array = arrayOfString.getArray();\n                    if (array != null && array.length == 2) {\n                        sb.append(array[0]).append(\"=\").append(array[1]).append(\"&\");\n                        if (\"createdAfter\".equals(array[0])) {\n                            createdAfter = array[1];\n                            if(createdAfter==null){\n                                createdAfter = \"\";\n                            }\n                        } else if (\"createdBefore\".equals(array[0])) {\n                            createdBefore = array[1];\n                            if(createdBefore==null){\n                                createdBefore = \"\";\n                            }\n                        } else if (\"updatedAfter\".equals(array[0])) {\n                            updatedAfter = array[1];\n                            if(updatedAfter==null){\n                                updatedAfter = \"\";\n                            }\n                        } else if (\"updatedBefore\".equals(array[0])) {\n                            updatedBefore = array[1];\n                            if(updatedBefore==null){\n                                updatedBefore = \"\";\n                            }\n                        } else if (\"resourcePath\".equals(array[0])) {\n                            resourcePath = array[1];\n                            if(resourcePath==null){\n                                resourcePath = \"\";\n                            }\n                        } else if (\"author\".equals(array[0])) {\n                            author = array[1];\n                            if(author==null){\n                                author = \"\";\n                            }\n                        } else if (\"updater\".equals(array[0])) {\n                            updater = array[1];\n                            if(updater==null){\n                                updater = \"\";\n                            }\n                        } else if (\"tags\".equals(array[0])) {\n                            tags = array[1];\n                            if(tags==null){\n                                tags = \"\";\n                            }\n                        } else if (\"content\".equals(array[0])) {\n                            content = array[1];\n                            if(content==null){\n                                content = \"\";\n                            }\n                        } else if (\"commentWords\".equals(array[0])) {\n                            commentWords = array[1];\n                            if(commentWords==null){\n                                commentWords = \"\";\n                            }\n                        } else if (\"associationType\".equals(array[0])) {\n                            associationType = array[1];\n                            if(associationType==null){\n                                associationType = \"\";\n                            }\n                        } else if (\"associationDest\".equals(array[0])) {\n                            associationDest = array[1];\n                            if(associationDest==null){\n                                associationDest = \"\";\n                            }\n                        } else if (\"propertyName\".equals(array[0])) {\n                            propertyName = array[1];\n                            lblPropName = array[1];\n                            if(propertyName==null){\n                                propertyName = \"\";\n                                lblPropName = \"-\";\n                            }\n                            propertyName = Encode.forHtml(propertyName);\n                            lblPropName = Encode.forHtml(lblPropName);\n                        } else if (\"leftPropertyValue\".equals(array[0])) {\n                            leftPropertyValue = array[1];\n                            if(leftPropertyValue==null){\n                                leftPropertyValue = \"\";\n                            }\n                        } else if (\"rightPropertyValue\".equals(array[0])) {\n                            rightPropertyValue = array[1];\n                            if(rightPropertyValue==null){\n                                rightPropertyValue = \"\";\n                            }\n                        } else if (\"mediaType\".equals(array[0])) {\n                            mediaType = array[1];\n                            if(mediaType==null){\n                                mediaType = \"\";\n                            }\n                        } else if (\"createdRangeNegate\".equals(array[0])) {\n                        \tcreatedRangeNegate = array[1];\n                            if(createdRangeNegate==null){\n                                createdRangeNegate = \"\";\n                            }\n                        } else if (\"updatedRangeNegate\".equals(array[0])) {\n                        \tupdatedRangeNegate = array[1];\n                            if(updatedRangeNegate==null){\n                                updatedRangeNegate = \"\";\n                            }\n                        } else if (\"authorNameNegate\".equals(array[0])) {\n                        \tauthorNameNegate = array[1];\n                            if(authorNameNegate==null){\n                                authorNameNegate = \"\";\n                            }\n                        } else if (\"updaterNameNegate\".equals(array[0])) {\n                        \tupdaterNameNegate = array[1];\n                            if(updaterNameNegate==null){\n                                updaterNameNegate = \"\";\n                            }\n                        } else if (\"rightOp\".equals(array[0])) {\n                            rightOp = array[1];\n                            if(rightOp == null) {\n                                rightOp = \"\";\n                            }\n                        } else if (\"leftOp\".equals(array[0])) {\n                            leftOp = array[1];\n                        \tif (leftOp == null) {\n                                leftOp = \"\";\n                            }\n                        } else if (\"mediaTypeNegate\".equals(array[0])) {\n                        \tmediaTypeNegate = array[1];\n                            if(mediaTypeNegate==null){\n                                mediaTypeNegate = \"\";\n                            }\n                        }\n                    }\n                }\n            }\n        } catch (Exception e) {\n            response.setStatus(500);\n%>\n<script type=\"text/javascript\">\n    CARBON.showErrorDialog(\"<%=Encode.forHtml(e.getMessage())%>\");\n</script>\n<%\n            return;\n        }\n    } else {\n\n        createdAfter = request.getParameter(\"createdAfter\");\n        if (createdAfter == null) {\n            createdAfter = \"\";\n        } else {\n            hasParameters = true;\n        }\n        createdBefore = request.getParameter(\"createdBefore\");\n        if (createdBefore == null) {\n            createdBefore = \"\";\n        } else {\n            hasParameters = true;\n        }\n        updatedAfter = request.getParameter(\"updatedAfter\");\n        if (updatedAfter == null) {\n            updatedAfter = \"\";\n        } else {\n            hasParameters = true;\n        }\n        updatedBefore = request.getParameter(\"updatedBefore\");\n        if (updatedBefore == null) {\n            updatedBefore = \"\";\n        } else {\n            hasParameters = true;\n        }\n        resourcePath = request.getParameter(\"resourcePath\");\n        if (resourcePath == null) {\n            resourcePath = \"\";\n        } else {\n            hasParameters = true;\n        }\n        author = request.getParameter(\"author\");\n        if (author == null) {\n            author = \"\";\n        } else {\n            hasParameters = true;\n        }\n        updater = request.getParameter(\"updater\");\n        if (updater == null) {\n            updater = \"\";\n        } else {\n            hasParameters = true;\n        }\n        tags = request.getParameter(\"tags\");\n        if (tags == null) {\n            tags = \"\";\n        } else {\n            hasParameters = true;\n        }\n        content = request.getParameter(\"content\");\n        if (content == null) {\n            content = \"\";\n        } else {\n        hasParameters = true;\n        }\n        commentWords = request.getParameter(\"commentWords\");\n        if (commentWords == null) {\n            commentWords = \"\";\n        } else {\n            hasParameters = true;\n        }\n        associationType = request.getParameter(\"associationType\");\n        if (associationType == null) {\n            associationType = \"\";\n        } else {\n            hasParameters = true;\n        }\n        associationDest = request.getParameter(\"associationDest\");\n        if (associationDest == null) {\n            associationDest = \"\";\n        } else {\n            hasParameters = true;\n        }\n        propertyName = request.getParameter(\"propertyName\");\n        if (propertyName == null) {\n            propertyName = \"\";\n            lblPropName = \"-\";\n        } else {\n            propertyName = Encode.forHtml(propertyName);\n            hasParameters = true;\n            lblPropName = propertyName;\n        }\n        leftPropertyValue = request.getParameter(\"leftPropertyValue\");\n        rightPropertyValue = request.getParameter(\"rightPropertyValue\");\n        if (leftPropertyValue == null) {\n            leftPropertyValue = \"\";\n        } else {\n            leftPropertyValue = Encode.forHtml(leftPropertyValue);\n        }\n\n        if (rightPropertyValue == null) {\n            rightPropertyValue = \"\";\n        } else {\n            rightPropertyValue = Encode.forHtml(rightPropertyValue);\n        }\n        \n        authorNameNegate = request.getParameter(\"authorNameNegate\"); \n        updaterNameNegate = request.getParameter(\"updaterNameNegate\"); \n        \n        if(authorNameNegate == null)\n        \tauthorNameNegate = \"\";\n        \n        if(updaterNameNegate == null)\n        \tupdaterNameNegate = \"\";\n        \n        mediaType = request.getParameter(\"mediaType\");        \n        if (mediaType == null) {\n            mediaType = \"\";\n        } else {\n            mediaType = Encode.forHtml(mediaType);\n            hasParameters = true;\n        }\n        \n        mediaTypeNegate = request.getParameter(\"mediaTypeNegate\");\n        if(mediaTypeNegate == null)\n        \tmediaTypeNegate = \"\";\n        \n        leftOp = request.getParameter(\"leftOp\");\n        rightOp = request.getParameter(\"rightOp\");\n\n        if (rightOp == null) {\n            rightOp = \"\";\n        } else {\n            rightOp = Encode.forHtml(rightOp);\n        }\n\n        if (leftOp == null) {\n            leftOp = \"\";\n        } else {\n            leftOp = Encode.forHtml(leftOp);\n        }\n    }\n%>\n\n<form id=\"advancedSearchForm\" name=\"advancedSearch\" onsubmit=\"return submitAdvSearchForm()\"\n      action=\"advancedSearch-ajaxprocessor.jsp\" method=\"get\"\n        <%=hasParameters ? \"style=\\\"display:none\\\"\" : \"\"%>>\n         <input type=\"hidden\" value=\"<%=leftOp%>\" id=\"hiddenOpLeft\"/>\n         <input type=\"hidden\" value=\"<%=rightOp%>\" id=\"hiddenOpRight\"/>\n\n            <div class=\"search-subtitle\" style=\"padding-left:10px;\"><fmt:message key=\"search.for.resources\"/></div>\n            <table class=\"normal\" id=\"customTable\" style=\"width:100%;\">\n                <tr>\n                    <td class=\"leftCol-small\"><fmt:message key=\"resource.name\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"resourcePath\" value=\"<%=resourcePath%>\" id=\"#_resourceName\"\n                               onkeypress=\"handletextBoxKeyPress(event)\"/>\n                    </td>\n                </tr>\n                <% for(String serverRole : CarbonUtils.getServerConfiguration().getProperties(\"ServerRoles.Role\")){\n                    if(serverRole.equalsIgnoreCase(\"GovernanceRegistry\")){%>\n                        <tr>\n                            <td class=\"leftCol-small\"><fmt:message key=\"content.name\"/></td>\n                            <td>\n                                <input type=\"text\" name=\"content\" value=\"<%=content%>\" id=\"#_content\"\n                                       onkeypress=\"handletextBoxKeyPress(event)\"/>\n                            </td>\n                        </tr>\n                    <%}%>\n                <%}%>\t\t\t\t\n                <tr>\n                    <td valign=\"top\"><fmt:message key=\"created\"/></td>\n                    <td>\n                        <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                            <tr>\n                                <td>\n                                    <fmt:message key=\"from\"/> :\n                                </td>\n                                <td>\n                                    <a class=\"icon-link\" style=\"background-image: url( ../admin/images/calendar.gif);\" onclick=\"jQuery('#cfromDate').datepicker( 'show' );\" href=\"javascript:void(0)\"></a>\n\n                                    <input type=\"text\" name=\"createdAfter\" value=\"<%=createdAfter%>\"\n                                           id=\"cfromDate\"\n                                           style=\"width:140px;\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n                                </td>\n                                <td>\n                                    <fmt:message key=\"to\"/> :\n                                </td>\n                                <td>\n                                    <a class=\"icon-link\" style=\"background-image: url( ../admin/images/calendar.gif);\" onclick=\"jQuery('#ctoDate').datepicker( 'show' );\" href=\"javascript:void(0)\"></a>\n                                    <input type=\"text\" name=\"createdBefore\" value=\"<%=createdBefore%>\"\n                                           id=\"ctoDate\"\n                                           style=\"width:140px;\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n\n                                    <% if (filterName != null && !createdRangeNegate.equals(\"\")) { %>\n                                        <input type=\"checkbox\" name=\"createdRangeNegate\" checked=\"checked\" /> not\n                                    <% } else {%>\n                                        <input type=\"checkbox\" name=\"createdRangeNegate\" /> not\n                                    <% } %>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td></td>\n                                <td class=\"helpTextTop\" style=\"margin:0px;padding:0px;\">\n                                    <fmt:message key=\"mm.dd.yyyy\"/>\n                                </td>\n                                <td></td>\n                                <td class=\"helpTextTop\" style=\"margin:0px;padding:0px;\">\n                                    <fmt:message key=\"mm.dd.yyyy\"/>\n                                </td>\n                            </tr>\n                        </table>\n                    </td>\n\n                </tr>\n                <tr>\n                    <td valign=\"top\"><fmt:message key=\"updated\"/></td>\n                    <td>\n                        <table cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\n                            <tr>\n                                <td>\n                                    <fmt:message key=\"from\"/> :\n                                </td>\n                                <td>\n                                     <a class=\"icon-link\" style=\"background-image: url( ../admin/images/calendar.gif);\" onclick=\"jQuery('#ufromDate').datepicker( 'show' );\" href=\"javascript:void(0)\"></a>\n                                    <input type=\"text\" name=\"updatedAfter\" value=\"<%=updatedAfter%>\"\n                                           id=\"ufromDate\"\n                                           style=\"width:140px;\" onkeypress=\"handletextBoxKeyPress(event)\"/>                                         \n                                </td>\n                                <td>\n                                    <fmt:message key=\"to\"/> :\n                                </td>\n                                <td>\n                                    <a class=\"icon-link\" style=\"background-image: url( ../admin/images/calendar.gif);\" onclick=\"jQuery('#utoDate').datepicker( 'show' );\" href=\"javascript:void(0)\"></a>\n                                    <input type=\"text\" name=\"updatedBefore\" value=\"<%=updatedBefore%>\"\n                                           id=\"utoDate\"\n                                           style=\"width:140px;\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n\n                                    <% if (filterName != null && !updatedRangeNegate.equals(\"\")) { %>\n                                        <input type=\"checkbox\" name=\"updatedRangeNegate\" checked=\"checked\" /> not\n                                    <% } else { %>\n                                        <input type=\"checkbox\" name=\"updatedRangeNegate\" /> not\n                                    <% } %>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td></td>\n                                <td class=\"helpTextTop\" style=\"margin:0px;padding:0px;\">\n                                    <fmt:message key=\"mm.dd.yyyy\"/>\n                                </td>\n                                <td></td>\n                                <td class=\"helpTextTop\" style=\"margin:0px;padding:0px;\">\n                                    <fmt:message key=\"mm.dd.yyyy\"/>\n                                </td>\n                            </tr>\n                        </table>\n                    </td>\n\n                </tr>\n                <tr>\n                    <td><fmt:message key=\"created.by\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"author\" value=\"<%=author%>\" id=\"#_author\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n\n                        <% if (filterName != null && !authorNameNegate.equals(\"\")) { %>\n                            <input type=\"checkbox\" name=\"authorNameNegate\" checked=\"checked\" /> not\n                        <% } else { %>\n                            <input type=\"checkbox\" name=\"authorNameNegate\" /> not\n                        <% } %>\n\n                    </td>\n\n                </tr>\n                <tr>\n                    <td><fmt:message key=\"updated.by\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"updater\" value=\"<%=updater%>\" id=\"#_updater\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n\n                        <% if (filterName != null && !updaterNameNegate.equals(\"\")) { %>\n                            <input type=\"checkbox\" name=\"updaterNameNegate\" checked=\"checked\" /> not\n                        <% } else { %>\n                            <input type=\"checkbox\" name=\"updaterNameNegate\" /> not\n                        <% } %>\n                    </td>\n\n                </tr>\n                <tr>\n                    <td><fmt:message key=\"tags\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"tags\" value=\"<%=tags%>\" id=\"#_tags\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n                    </td>\n                </tr>\n                <tr>\n\n                    <td><fmt:message key=\"comments\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"commentWords\" value=\"<%=commentWords%>\" id=\"#_comments\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n                    </td>\n                </tr>\n                <tr>\n\n                    <td><fmt:message key=\"associationType\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"associationType\" value=\"<%=associationType%>\" id=\"#_associationType\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n                    </td>\n                </tr>\n                <tr>\n\n                    <td><fmt:message key=\"associationDest\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"associationDest\" value=\"<%=associationDest%>\" id=\"#_associationDest\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n                    </td>\n                </tr>\n                <tr>\n                    <td><fmt:message key=\"property.name\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"propertyName\" value=\"<%=propertyName%>\"\n                               id=\"#_propertyName\" onkeypress=\"handletextBoxKeyPress(event)\" onblur=\"setPropertyName()\"/>\n                    </td>\n                </tr>\n                <tr>\n                    <td><fmt:message key=\"property.value\"/></td>\n                    <td>\n                       <%-- <input type=\"text\" name=\"propertyValue\" value=\"<%=propertyValue%>\"\n                               id=\"#_propertyValue\" onkeypress=\"handletextBoxKeyPress(event)\"/> --%>\n\t\t\t\t\t\t<input type=\"text\" onkeypress=\"return isNumberKey(event)\" id=\"valueLeft\" name=\"leftPropertyValue\" value=\"<%=leftPropertyValue%>\"/>\n\n\t\t\t\t\t\t<select id=\"opLeft\" name=\"leftOp\" >\n\t\t\t\t\t\t    <option value=\"na\"></option>\n                          \t<option value=\"gt\">&#60;</option>\n                          \t<option value=\"ge\">&#8804;</option>\n                        </select>\n\n                        <label>&#123;</label>\n                        <label id=\"lblPropName\"><%=lblPropName%></label>\n                        <label>&#125;</label>\n\n\t\t\t\t\t\t<select onChange=\"adjustAllOpInput();\" id=\"opRight\" name=\"rightOp\">\n\t\t\t\t\t\t    <option value=\"na\"></option>\n  \t\t\t\t\t\t\t<option value=\"lt\">&#60;</option>\n  \t\t\t\t\t\t\t<option value=\"le\">&#8804;</option>\n  \t\t\t\t\t\t\t<option value=\"eq\">&#61;</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t<input type=\"text\" onkeypress=\"return isNumberKey(event)\" id=\"valueRight\" name=\"rightPropertyValue\" value=\"<%=rightPropertyValue%>\"/>\n\n                        <% if (filterName == null) { %>\n\n                        <script type=\"text/javascript\">\n                            setIndexForOp(\"opLeft\", \"<%=leftOp%>\");\n                            setIndexForOp(\"opRight\", \"<%=rightOp%>\");\n                            adjustPropertyInput();\n                        </script>\n                        <% } %>\n                    </td>\n                </tr>\n               <%-- <tr>\n                    <td><fmt:message key=\"including.content\"/></td>\n                    <td>\n                        <input type=\"text\" name=\"content\" value=\"\" id=\"#_content\" onkeypress=\"handletextBoxKeyPress(event)\"/>\n                    </td>\n                </tr>--%>\n\n                <%\n                    String isFilter = \"0\";\n                    String filterMediaType = \"\";\n                    if (request.getParameter(\"filterName\") != null && mediaType != null && mediaType.length() != 0) {\n                        isFilter = \"1\";\n                        filterMediaType = mediaType;\n                    }\n                %>\n\n                <tr>\n                    <td style=\"vertical-align:center !important\"><fmt:message key=\"media.type\"/></td>\n                    <td style=\"vertical-align:top !important\">\n                        <div class=\"yui-skin-sam\" style=\"width:200px;margin-left:0px;float:left\">\n\n\n                            <div id=\"mediaTypeAutoComplete\">\n                                <input id=\"#_mediaType\" name=\"mediaType\" type=\"text\" value=\"<%=mediaType%>\" style=\"width:auto\" onblur='adjustMediaTypeNegate(\"<%=isFilter%>\", \"<%=filterMediaType%>\")' />\n\n\n                                                                                                                         \n                                <div id=\"customUIButtonDiv\">\n                                    <%\n                                        if (isFilter.equals(\"1\")) {\n                                    %><a href=\"javascript:collapseCustomUI()\" class=\"loadMediaTypeButton\"><fmt:message key=\"fewer\"/> <img src=\"../search/images/arrow-up.png\" /></a><%\n                                        }\n                                    %>\n                                </div>\n                                <div id=\"mediaTypeContainer\"></div>\n\n                            </div>\n\n                        </div>\n\n                        <div id=\"mediaTypeNegateDiv\" style=\"float:left;margin-left:20px\" >\n                            <script type=\"text/javascript\">\n\n                                   var mediaTypeNegateObj = document.getElementById('mediaTypeNegateDiv');\n\n                                   if(isCustomUIDivEmpty()) {\n                                          mediaTypeNegateObj.style.marginLeft = \"160px\";\n                                   }\n                            </script>\n\n                            <% if (filterName != null && !mediaTypeNegate.equals(\"\")) { %>\n                                <input name=\"mediaTypeNegate\" id=\"mediaTypeNegate\" type=\"checkbox\" checked=\"checked\" /> not\n                            <% } else { %>\n                                <input name=\"mediaTypeNegate\" id=\"mediaTypeNegate\" type=\"checkbox\" /> not\n                            <% } %>\n                        </div>\n\t\t\t\t\t</td>\n\n                        <%--<input type=\"text\" name=\"mediaType\" value=\"<%= mediaType%>\" id=\"#_mediaType\" onkeypress=\"handleMediaTypeKeypress(event)\"></td>\n                        --%>\n                </tr>\n                <tr>\n                    <td colspan=\"2\" style=\"padding:0px !important;margin:0px !important\" id=\"customDiv\">\n                        <%\n                            if (request.getParameter(\"filterName\") != null && mediaType != null &&\n                                    mediaType.length() > 0) {\n                                String includePath = \"customSearch-ajaxprocessor.jsp?mediaType=\" + mediaType +\n                                                     \"&\" + sb.toString().trim();\n                        %>\n                                <jsp:include page=\"<%=includePath%>\"/>\n                        <%\n                            }\n                        %>\n                    </td>\n                </tr>\n\n                <tr>\n                    <td class=\"buttonRow\" colspan=\"2\">\n                        <input type=\"button\" id=\"#_0\" value=\"<fmt:message key=\"search\"/>\" class=\"button\"\n                               onclick=\"submitAdvSearchForm()\"/>\n                         <input type=\"button\" id=\"#_1\" value=\"<fmt:message key=\"clear\"/>\" class=\"button\"\n                               onclick=\"clearAll()\"/>\n                    </td>\n                </tr>\n            </table>\n\n\n\n<div id=\"commentsForm\" style=\"display:none;\">\n    <table cellpadding=\"0\" cellspacing=10 border=\"0\" style=\"width:100%\" class=\"form-table\">\n        <tr>\n            <td class=\"leftCol-small\"><fmt:message key=\"commented.user\"/></td>\n            <td>\n                <input type=\"text\" name=\"commentedUser\" value=\"\" id=\"#_commentedUser\"\n                       style=\"width:100px;\"/>\n            </td>\n        </tr>\n        <tr>\n            <td valign=\"top\"><fmt:message key=\"date\"/></td>\n            <td>\n                <div style=\"width:200px;font-style:italic;\"><fmt:message\n                        key=\"only.find.results.updated\"/></div>\n                <fmt:message key=\"from\"/>: <input type=\"text\" name=\"fromDate\" value=\"\"\n                                                  id=\"#_fromDate\"\n                                                  style=\"width:100px;\"/>\n                <fmt:message key=\"to\"/>: <input type=\"text\" name=\"toDate\" value=\"\" id=\"#_toDate\"\n                                                style=\"width:100px;\"/>\n            </td>\n        </tr>\n        <tr>\n            <td valign=\"top\"><fmt:message key=\"resource.name\"/></td>\n            <td>\n                <input type=\"text\" name=\"resourceName\" value=\"\" id=\"#_resourceName2\"/>\n            </td>\n        </tr>\n        <tr>\n            <td><fmt:message key=\"commented.text\"/></td>\n            <td>\n                <input type=\"text\" name=\"commentedText\" value=\"\" id=\"#_commentedText\"/>\n            </td>\n        </tr>\n        <tr>\n            <td><fmt:message key=\"created.by1\"/></td>\n            <td>\n                <input type=\"text\" name=\"createdBy\" value=\"\" id=\"#_createdBy\"/>\n            </td>\n        </tr>\n    </table>\n</div>\n\n\n</form>\n</fmt:bundle>\n"], "filenames": ["components/registry/org.wso2.carbon.registry.search.ui/src/main/resources/web/search/advancedSearchForm-ajaxprocessor.jsp"], "buggy_code_start_loc": [293], "buggy_code_end_loc": [322], "fixing_code_start_loc": [293], "fixing_code_end_loc": [338], "type": "CWE-79", "message": "A vulnerability was found in WSO2 carbon-registry up to 4.8.11. It has been rated as problematic. Affected by this issue is some unknown functionality of the file components/registry/org.wso2.carbon.registry.search.ui/src/main/resources/web/search/advancedSearchForm-ajaxprocessor.jsp of the component Advanced Search. The manipulation of the argument mediaType/rightOp/leftOp/rightPropertyValue/leftPropertyValue leads to cross site scripting. The attack may be launched remotely. Upgrading to version 4.8.12 is able to address this issue. The name of the patch is 0c827cc1b14b82d8eb86117ab2e43c34bb91ddb4. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-215900.", "other": {"cve": {"id": "CVE-2022-4520", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-15T21:15:12.683", "lastModified": "2022-12-20T21:20:24.147", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in WSO2 carbon-registry up to 4.8.11. It has been rated as problematic. Affected by this issue is some unknown functionality of the file components/registry/org.wso2.carbon.registry.search.ui/src/main/resources/web/search/advancedSearchForm-ajaxprocessor.jsp of the component Advanced Search. The manipulation of the argument mediaType/rightOp/leftOp/rightPropertyValue/leftPropertyValue leads to cross site scripting. The attack may be launched remotely. Upgrading to version 4.8.12 is able to address this issue. The name of the patch is 0c827cc1b14b82d8eb86117ab2e43c34bb91ddb4. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-215900."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-707"}, {"lang": "en", "value": "CWE-74"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:wso2:carbon-registry:*:*:*:*:*:*:*:*", "versionEndExcluding": "4.8.12", "matchCriteriaId": "6649B89F-89CB-4E13-A5AC-A05C4680EDF6"}]}]}], "references": [{"url": "https://github.com/wso2/carbon-registry/commit/0c827cc1b14b82d8eb86117ab2e43c34bb91ddb4", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/wso2/carbon-registry/pull/404", "source": "cna@vuldb.com", "tags": ["Exploit", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/wso2/carbon-registry/releases/tag/v4.8.12", "source": "cna@vuldb.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.215900", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/wso2/carbon-registry/commit/0c827cc1b14b82d8eb86117ab2e43c34bb91ddb4"}}