{"buggy_code": ["<?\n\t$id = $_GET[\"module\"];\n\t$table = isset($_GET[\"table\"]) ? $_GET[\"table\"] : \"\";\n\t$title = isset($_GET[\"title\"]) ? htmlspecialchars($_GET[\"title\"]) : \"\";\n\t\n\t$module = $admin->getModule($id);\n\t$landing_exists = $admin->doesModuleLandingActionExist($id);\n\n\tif (isset($_SESSION[\"bigtree_admin\"][\"developer\"][\"saved_view\"])) {\n\t\tBigTree::globalizeArray($_SESSION[\"bigtree_admin\"][\"developer\"][\"saved_view\"],array(\"htmlspecialchars\"));\n\t\tunset($_SESSION[\"bigtree_admin\"][\"developer\"][\"saved_view\"]);\n\t} else {\n\t\t// Stop notices\n\t\t$description = $type = $preview_url = \"\";\n\t}\n?>\n<div class=\"container\">\n\n\t<form method=\"post\" action=\"<?=$developer_root?>modules/views/create/<?=$id?>/\" class=\"module\">\n\t\t<section>\n\t\t\t<? if ($landing_exists) { ?>\n\t\t\t<div class=\"alert\">\n\t\t\t\t<span></span>\n\t\t\t\t<p><strong>Default View Taken:</strong> If this view is for a different edit action, please specify the suffix below (i.e. edit-group's suffix is \"group\").</p>\n\t\t\t</div>\n\t\t\t<fieldset>\n\t\t\t\t<label>Add/Edit Suffix</label>\n\t\t\t\t<input type=\"text\" name=\"suffix\" />\n\t\t\t</fieldset>\n\t\t\t<? } ?>\n\t\t\t\n\t\t\t<div class=\"left\">\n\t\t\t\t<fieldset>\n\t\t\t\t\t<label class=\"required\">Item Title <small>(for example, \"Questions\" to make the title \"Viewing Questions\")</small></label>\n\t\t\t\t\t<input type=\"text\" class=\"required\" name=\"title\" value=\"<?=$title?>\" />\n\t\t\t\t</fieldset>\n\t\t\t\t\n\t\t\t\t<fieldset>\n\t\t\t\t\t<label class=\"required\">Data Table</label>\n\t\t\t\t\t<select name=\"table\" id=\"view_table\" class=\"required\" >\n\t\t\t\t\t\t<option></option>\n\t\t\t\t\t\t<? BigTree::getTableSelectOptions($table); ?>\n\t\t\t\t\t</select>\n\t\t\t\t</fieldset>\n\t\t\t\t\n\t\t\t\t<fieldset>\n\t\t\t\t\t<label>View Type</label>\n\t\t\t\t\t<select name=\"type\" id=\"view_type\" class=\"left\" >\n\t\t\t\t\t\t<? foreach ($admin->ViewTypes as $key => $t) { ?>\n\t\t\t\t\t\t<option value=\"<?=$key?>\"<? if ($key == $type) { ?> selected=\"selected\"<? } ?>><?=$t?></option>\n\t\t\t\t\t\t<? } ?>\n\t\t\t\t\t</select>\n\t\t\t\t\t&nbsp; <a href=\"#\" class=\"options icon_settings\"></a>\n\t\t\t\t\t<input type=\"hidden\" name=\"options\" id=\"view_options\" value=\"<?=$options?>\" />\n\t\t\t\t</fieldset>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div class=\"right\">\n\t\t\t\t<fieldset>\n\t\t\t\t\t<label>Description <small>(instructions for the user)</small></label>\n\t\t\t\t\t<textarea name=\"description\" ><?=$description?></textarea>\n\t\t\t\t</fieldset>\n\t\t\t</div>\n\t\t\t\n\t\t\t<fieldset>\n\t\t\t\t<label>Preview URL <small>(optional, i.e. http://www.website.com/news/preview/ &mdash; the item's id will be entered as the final route)</small></label>\n\t\t\t\t<input type=\"text\" name=\"preview_url\" value=\"<?=$preview_url?>\" />\n\t\t\t</fieldset>\n\t\t</section>\n\t\t<section class=\"sub\" id=\"field_area\">\n\t\t\t<? if (!$table) { ?>\n\t\t\t<p>Please choose a table to populate this area.</p>\n\t\t\t<? } else { ?>\n\t\t\t<? include BigTree::path(\"admin/ajax/developer/load-view-fields.php\") ?>\n\t\t\t<? } ?>\n\t\t</section>\n\t\t<footer>\n\t\t\t<input type=\"submit\" class=\"button blue\" value=\"Create\" />\n\t\t</footer>\n\t</form>\n</div>\n\n<? include BigTree::path(\"admin/modules/developer/modules/views/_js.php\") ?>"], "fixing_code": ["<?\n\t$id = htmlspecialchars($_GET[\"module\"]);\n\t$table = isset($_GET[\"table\"]) ? $_GET[\"table\"] : \"\";\n\t$title = isset($_GET[\"title\"]) ? htmlspecialchars($_GET[\"title\"]) : \"\";\n\t\n\t$module = $admin->getModule($id);\n\t$landing_exists = $admin->doesModuleLandingActionExist($id);\n\n\tif (isset($_SESSION[\"bigtree_admin\"][\"developer\"][\"saved_view\"])) {\n\t\tBigTree::globalizeArray($_SESSION[\"bigtree_admin\"][\"developer\"][\"saved_view\"],array(\"htmlspecialchars\"));\n\t\tunset($_SESSION[\"bigtree_admin\"][\"developer\"][\"saved_view\"]);\n\t} else {\n\t\t// Stop notices\n\t\t$description = $type = $preview_url = \"\";\n\t}\n?>\n<div class=\"container\">\n\n\t<form method=\"post\" action=\"<?=$developer_root?>modules/views/create/<?=$id?>/\" class=\"module\">\n\t\t<section>\n\t\t\t<? if ($landing_exists) { ?>\n\t\t\t<div class=\"alert\">\n\t\t\t\t<span></span>\n\t\t\t\t<p><strong>Default View Taken:</strong> If this view is for a different edit action, please specify the suffix below (i.e. edit-group's suffix is \"group\").</p>\n\t\t\t</div>\n\t\t\t<fieldset>\n\t\t\t\t<label>Add/Edit Suffix</label>\n\t\t\t\t<input type=\"text\" name=\"suffix\" />\n\t\t\t</fieldset>\n\t\t\t<? } ?>\n\t\t\t\n\t\t\t<div class=\"left\">\n\t\t\t\t<fieldset>\n\t\t\t\t\t<label class=\"required\">Item Title <small>(for example, \"Questions\" to make the title \"Viewing Questions\")</small></label>\n\t\t\t\t\t<input type=\"text\" class=\"required\" name=\"title\" value=\"<?=$title?>\" />\n\t\t\t\t</fieldset>\n\t\t\t\t\n\t\t\t\t<fieldset>\n\t\t\t\t\t<label class=\"required\">Data Table</label>\n\t\t\t\t\t<select name=\"table\" id=\"view_table\" class=\"required\" >\n\t\t\t\t\t\t<option></option>\n\t\t\t\t\t\t<? BigTree::getTableSelectOptions($table); ?>\n\t\t\t\t\t</select>\n\t\t\t\t</fieldset>\n\t\t\t\t\n\t\t\t\t<fieldset>\n\t\t\t\t\t<label>View Type</label>\n\t\t\t\t\t<select name=\"type\" id=\"view_type\" class=\"left\" >\n\t\t\t\t\t\t<? foreach ($admin->ViewTypes as $key => $t) { ?>\n\t\t\t\t\t\t<option value=\"<?=$key?>\"<? if ($key == $type) { ?> selected=\"selected\"<? } ?>><?=$t?></option>\n\t\t\t\t\t\t<? } ?>\n\t\t\t\t\t</select>\n\t\t\t\t\t&nbsp; <a href=\"#\" class=\"options icon_settings\"></a>\n\t\t\t\t\t<input type=\"hidden\" name=\"options\" id=\"view_options\" value=\"<?=$options?>\" />\n\t\t\t\t</fieldset>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div class=\"right\">\n\t\t\t\t<fieldset>\n\t\t\t\t\t<label>Description <small>(instructions for the user)</small></label>\n\t\t\t\t\t<textarea name=\"description\" ><?=$description?></textarea>\n\t\t\t\t</fieldset>\n\t\t\t</div>\n\t\t\t\n\t\t\t<fieldset>\n\t\t\t\t<label>Preview URL <small>(optional, i.e. http://www.website.com/news/preview/ &mdash; the item's id will be entered as the final route)</small></label>\n\t\t\t\t<input type=\"text\" name=\"preview_url\" value=\"<?=$preview_url?>\" />\n\t\t\t</fieldset>\n\t\t</section>\n\t\t<section class=\"sub\" id=\"field_area\">\n\t\t\t<? if (!$table) { ?>\n\t\t\t<p>Please choose a table to populate this area.</p>\n\t\t\t<? } else { ?>\n\t\t\t<? include BigTree::path(\"admin/ajax/developer/load-view-fields.php\") ?>\n\t\t\t<? } ?>\n\t\t</section>\n\t\t<footer>\n\t\t\t<input type=\"submit\" class=\"button blue\" value=\"Create\" />\n\t\t</footer>\n\t</form>\n</div>\n\n<? include BigTree::path(\"admin/modules/developer/modules/views/_js.php\") ?>"], "filenames": ["core/admin/modules/developer/modules/views/add.php"], "buggy_code_start_loc": [2], "buggy_code_end_loc": [3], "fixing_code_start_loc": [2], "fixing_code_end_loc": [3], "type": "CWE-79", "message": "Cross-site scripting (XSS) vulnerability in core/admin/modules/developer/modules/views/add.php in BigTree CMS 4.0 RC2 and earlier allows remote attackers to inject arbitrary web script or HTML via the module parameter.", "other": {"cve": {"id": "CVE-2013-4880", "sourceIdentifier": "cve@mitre.org", "published": "2013-08-14T13:50:00.610", "lastModified": "2017-08-29T01:33:40.967", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in core/admin/modules/developer/modules/views/add.php in BigTree CMS 4.0 RC2 and earlier allows remote attackers to inject arbitrary web script or HTML via the module parameter."}, {"lang": "es", "value": "Vulnerabilidad Cross-site scripting (XSS) en core/admin/modules/developer/modules/views/add.php en BigTree CMS v4.0 RC2 y anteriores, permite a atacantes remotos inyectar web script o HTML a trav\u00e9s del par\u00e1metro \"module\"."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:bigtreecms:bigtree_cms:*:rc2:*:*:*:*:*:*", "versionEndIncluding": "4.0", "matchCriteriaId": "C6BFF3D3-DE9A-4D38-AA46-81C80C291C6C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:bigtreecms:bigtree_cms:4.0:b1:*:*:*:*:*:*", "matchCriteriaId": "C2FE7AD4-680F-46AB-B781-19F7E4B95593"}, {"vulnerable": true, "criteria": "cpe:2.3:a:bigtreecms:bigtree_cms:4.0:b2:*:*:*:*:*:*", "matchCriteriaId": "5EB20F45-4FD0-4BDF-926B-83A7178A16E7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:bigtreecms:bigtree_cms:4.0:b3:*:*:*:*:*:*", "matchCriteriaId": "5A8E73F4-6BB4-4BA7-B7DF-DC2C3DB96D3C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:bigtreecms:bigtree_cms:4.0:b4:*:*:*:*:*:*", "matchCriteriaId": "EB85F2AE-F5C8-4975-A668-3F19A16611EE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:bigtreecms:bigtree_cms:4.0:b5:*:*:*:*:*:*", "matchCriteriaId": "67AB2377-6B06-4962-BD58-9C33225F17BB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:bigtreecms:bigtree_cms:4.0:b6:*:*:*:*:*:*", "matchCriteriaId": "94F5DCD4-1538-47E2-9D74-89FCB120FB84"}, {"vulnerable": true, "criteria": "cpe:2.3:a:bigtreecms:bigtree_cms:4.0:b7:*:*:*:*:*:*", "matchCriteriaId": "FC4B947C-3C45-424E-BEE8-F56CCBEBF384"}, {"vulnerable": true, "criteria": "cpe:2.3:a:bigtreecms:bigtree_cms:4.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "EBA1EB0F-5860-4642-8CD6-5A871ADBDAA9"}]}]}], "references": [{"url": "http://archives.neohapsis.com/archives/bugtraq/2013-08/0039.html", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/86287", "source": "cve@mitre.org"}, {"url": "https://github.com/bigtreecms/BigTree-CMS/commit/8a59c2e13f8e151b6a9e98f73e641e1ec8d928df", "source": "cve@mitre.org", "tags": ["Exploit", "Patch"]}, {"url": "https://www.htbridge.com/advisory/HTB23165", "source": "cve@mitre.org", "tags": ["Exploit"]}]}, "github_commit_url": "https://github.com/bigtreecms/BigTree-CMS/commit/8a59c2e13f8e151b6a9e98f73e641e1ec8d928df"}}