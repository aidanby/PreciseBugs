{"buggy_code": ["<?php\n# MantisBT - a php based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n\t/**\n\t * This file POSTs data to report_bug.php\n\t *\n\t * @package MantisBT\n\t * @copyright Copyright (C) 2000 - 2002  Kenzaburo Ito - kenito@300baud.org\n\t * @copyright Copyright (C) 2002 - 2011  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n\t * @link http://www.mantisbt.org\n\t */\n\n\t $g_allow_browser_cache = 1;\n\n\t /**\n\t  * MantisBT Core API's\n\t  */\n\trequire_once( 'core.php' );\n\n\trequire_once( 'file_api.php' );\n\trequire_once( 'custom_field_api.php' );\n\trequire_once( 'last_visited_api.php' );\n\trequire_once( 'projax_api.php' );\n\trequire_once( 'collapse_api.php' );\n\n\t$f_master_bug_id = gpc_get_int( 'm_id', 0 );\n\n\t# this page is invalid for the 'All Project' selection except if this is a clone\n\tif ( ( ALL_PROJECTS == helper_get_current_project() ) && ( 0 == $f_master_bug_id ) ) {\n\t\tprint_header_redirect( 'login_select_proj_page.php?ref=bug_report_page.php' );\n\t}\n\n\tif ( $f_master_bug_id > 0 ) {\n\t\t# master bug exists...\n\t\tbug_ensure_exists( $f_master_bug_id );\n\n\t\t# master bug is not read-only...\n\t\tif ( bug_is_readonly( $f_master_bug_id ) ) {\n\t\t\terror_parameters( $f_master_bug_id );\n\t\t\ttrigger_error( ERROR_BUG_READ_ONLY_ACTION_DENIED, ERROR );\n\t\t}\n\n\t\t$t_bug = bug_get( $f_master_bug_id, true );\n\n\t\t# the user can at least update the master bug (needed to add the relationship)...\n\t\taccess_ensure_bug_level( config_get( 'update_bug_threshold', null, $t_bug->project_id ), $f_master_bug_id );\n\n\t\t#@@@ (thraxisp) Note that the master bug is cloned into the same project as the master, independent of\n\t\t#       what the current project is set to.\n\t\tif( $t_bug->project_id != helper_get_current_project() ) {\n            # in case the current project is not the same project of the bug we are viewing...\n            # ... override the current project. This to avoid problems with categories and handlers lists etc.\n            $g_project_override = $t_bug->project_id;\n            $t_changed_project = true;\n        } else {\n            $t_changed_project = false;\n        }\n\n\t    access_ensure_project_level( config_get( 'report_bug_threshold' ) );\n\n\t\t$f_build\t\t\t\t= $t_bug->build;\n\t\t$f_platform\t\t\t\t= $t_bug->platform;\n\t\t$f_os\t\t\t\t\t= $t_bug->os;\n\t\t$f_os_build\t\t\t\t= $t_bug->os_build;\n\t\t$f_product_version\t\t= $t_bug->version;\n\t\t$f_target_version\t\t= $t_bug->target_version;\n\t\t$f_profile_id\t\t\t= 0;\n\t\t$f_handler_id\t\t\t= $t_bug->handler_id;\n\n\t\t$f_category_id\t\t\t= $t_bug->category_id;\n\t\t$f_reproducibility\t\t= $t_bug->reproducibility;\n\t\t$f_severity\t\t\t\t= $t_bug->severity;\n\t\t$f_priority\t\t\t\t= $t_bug->priority;\n\t\t$f_summary\t\t\t\t= $t_bug->summary;\n\t\t$f_description\t\t\t= $t_bug->description;\n\t\t$f_steps_to_reproduce\t= $t_bug->steps_to_reproduce;\n\t\t$f_additional_info\t\t= $t_bug->additional_information;\n\t\t$f_view_state\t\t\t= $t_bug->view_state;\n\t\t$f_due_date\t\t\t\t= $t_bug->due_date;\n\n\t\t$t_project_id\t\t\t= $t_bug->project_id;\n\t} else {\n\t    access_ensure_project_level( config_get( 'report_bug_threshold' ) );\n\n\t\t$f_build\t\t\t\t= gpc_get_string( 'build', '' );\n\t\t$f_platform\t\t\t\t= gpc_get_string( 'platform', '' );\n\t\t$f_os\t\t\t\t\t= gpc_get_string( 'os', '' );\n\t\t$f_os_build\t\t\t\t= gpc_get_string( 'os_build', '' );\n\t\t$f_product_version\t\t= gpc_get_string( 'product_version', '' );\n\t\t$f_target_version\t\t= gpc_get_string( 'target_version', '' );\n\t\t$f_profile_id\t\t\t= gpc_get_int( 'profile_id', 0 );\n\t\t$f_handler_id\t\t\t= gpc_get_int( 'handler_id', 0 );\n\n\t\t$f_category_id\t\t\t= gpc_get_int( 'category_id', 0 );\n\t\t$f_reproducibility\t\t= gpc_get_int( 'reproducibility', config_get( 'default_bug_reproducibility' ) );\n\t\t$f_severity\t\t\t\t= gpc_get_int( 'severity', config_get( 'default_bug_severity' ) );\n\t\t$f_priority\t\t\t\t= gpc_get_int( 'priority', config_get( 'default_bug_priority' ) );\n\t\t$f_summary\t\t\t\t= gpc_get_string( 'summary', '' );\n\t\t$f_description\t\t\t= gpc_get_string( 'description', '' );\n\t\t$f_steps_to_reproduce\t= gpc_get_string( 'steps_to_reproduce', config_get( 'default_bug_steps_to_reproduce' ) );\n\t\t$f_additional_info\t\t= gpc_get_string( 'additional_info', config_get ( 'default_bug_additional_info' ) );\n\t\t$f_view_state\t\t\t= gpc_get_int( 'view_state', config_get( 'default_bug_view_status' ) );\n\t\t$f_due_date\t\t\t\t= gpc_get_string( 'due_date', '');\n\n\t\tif ( $f_due_date == '' ) {\n\t\t\t$f_due_date = date_get_null();\n\t\t}\n\n\t\t$t_project_id\t\t\t= helper_get_current_project();\n\n\t\t$t_changed_project\t\t= false;\n\t}\n\n\t$f_report_stay\t\t\t          = gpc_get_bool( 'report_stay', false );\n\t$f_copy_notes_from_parent         = gpc_get_bool( 'copy_notes_from_parent', false);\n\t$f_copy_attachments_from_parent   = gpc_get_bool( 'copy_attachments_from_parent', false);\n\n\t$t_fields = config_get( 'bug_report_page_fields' );\n\t$t_fields = columns_filter_disabled( $t_fields );\n\n\t$tpl_show_category = in_array( 'category_id', $t_fields );\n\t$tpl_show_reproducibility = in_array( 'reproducibility', $t_fields );\n\t$tpl_show_severity = in_array( 'severity', $t_fields );\n\t$tpl_show_priority = in_array( 'priority', $t_fields );\n\t$tpl_show_steps_to_reproduce = in_array( 'steps_to_reproduce', $t_fields );\n\t$tpl_show_handler = in_array( 'handler', $t_fields ) && access_has_project_level( config_get( 'update_bug_assign_threshold' ) );\n\t$tpl_show_profiles = config_get( 'enable_profiles' );\n\t$tpl_show_platform = $tpl_show_profiles && in_array( 'platform', $t_fields );\n\t$tpl_show_os = $tpl_show_profiles && in_array( 'os', $t_fields );\n\t$tpl_show_os_version = $tpl_show_profiles && in_array( 'os_version', $t_fields );\n\n\t$tpl_show_versions = version_should_show_product_version( $t_project_id );\n\t$tpl_show_product_version = $tpl_show_versions && in_array( 'product_version', $t_fields );\n\t$tpl_show_product_build = $tpl_show_versions && in_array( 'product_build', $t_fields ) && config_get( 'enable_product_build' ) == ON;\n\t$tpl_show_target_version = $tpl_show_versions && in_array( 'target_version', $t_fields ) && access_has_project_level( config_get( 'roadmap_update_threshold' ) );\n\t$tpl_show_additional_info = in_array( 'additional_info', $t_fields );\n\t$tpl_show_due_date = in_array( 'due_date', $t_fields ) && access_has_project_level( config_get( 'due_date_update_threshold' ), helper_get_current_project(), auth_get_current_user_id() );\n\t$tpl_show_attachments = in_array( 'attachments', $t_fields ) && file_allow_bug_upload();\n\t$tpl_show_view_state = in_array( 'view_state', $t_fields ) && access_has_project_level( config_get( 'set_view_status_threshold' ) );\n\n\t# don't index bug report page\n\thtml_robots_noindex();\n\n\thtml_page_top( lang_get( 'report_bug_link' ) );\n\n\tprint_recently_visited();\n?>\n<br />\n<div align=\"center\">\n<form name=\"report_bug_form\" method=\"post\" <?php if ( $tpl_show_attachments ) { echo 'enctype=\"multipart/form-data\"'; } ?> action=\"bug_report.php\">\n<?php echo form_security_field( 'bug_report' ) ?>\n<table class=\"width90\" cellspacing=\"1\">\n\t<tr>\n\t\t<td class=\"form-title\" colspan=\"2\">\n\t\t\t<input type=\"hidden\" name=\"m_id\" value=\"<?php echo $f_master_bug_id ?>\" />\n\t\t\t<input type=\"hidden\" name=\"project_id\" value=\"<?php echo $t_project_id ?>\" />\n\t\t\t<?php echo lang_get( 'enter_report_details_title' ) ?>\n\t\t</td>\n\t</tr>\n<?php\n\tevent_signal( 'EVENT_REPORT_BUG_FORM_TOP', array( $t_project_id ) );\n\n\tif ( $tpl_show_category ) {\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\" width=\"30%\">\n\t\t\t<?php echo config_get( 'allow_no_category' ) ? '' : '<span class=\"required\">*</span>'; print_documentation_link( 'category' ) ?>\n\t\t</td>\n\t\t<td width=\"70%\">\n\t\t\t<?php if ( $t_changed_project ) {\n\t\t\t\techo \"[\" . project_get_field( $t_bug->project_id, 'name' ) . \"] \";\n\t\t\t} ?>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"category_id\">\n\t\t\t\t<?php\n\t\t\t\t\tprint_category_option_list( $f_category_id );\n\t\t\t\t?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php }\n\n\tif ( $tpl_show_reproducibility ) {\n?>\n\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php print_documentation_link( 'reproducibility' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"reproducibility\">\n\t\t\t\t<?php print_enum_string_option_list( 'reproducibility', $f_reproducibility ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif ( $tpl_show_severity ) {\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php print_documentation_link( 'severity' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"severity\">\n\t\t\t\t<?php print_enum_string_option_list( 'severity', $f_severity ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif ( $tpl_show_priority ) {\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php print_documentation_link( 'priority' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"priority\">\n\t\t\t\t<?php print_enum_string_option_list( 'priority', $f_priority ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif ( $tpl_show_due_date ) {\n\t\t$t_date_to_display = '';\n\n\t\tif ( !date_is_null( $f_due_date ) ) {\n\t\t\t$t_date_to_display = date( config_get( 'calendar_date_format' ), $f_due_date );\n\t\t}\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php print_documentation_link( 'due_date' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t<?php\n\t\t    print \"<input \".helper_get_tab_index().\" type=\\\"text\\\" id=\\\"due_date\\\" name=\\\"due_date\\\" size=\\\"20\\\" maxlength=\\\"16\\\" value=\\\"\".$t_date_to_display.\"\\\" />\";\n\t\t\tdate_print_calendar();\n\t\t?>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php if ( $tpl_show_platform || $tpl_show_os || $tpl_show_os_version ) { ?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'select_profile' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<?php if (count(profile_get_all_for_user( auth_get_current_user_id() )) > 0) { ?>\n\t\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"profile_id\">\n\t\t\t\t\t<?php print_profile_option_list( auth_get_current_user_id(), $f_profile_id ) ?>\n\t\t\t\t</select>\n\t\t\t<?php } ?>\n\t\t</td>\n\t</tr>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td colspan=\"2\" class=\"none\">\n\t\t\t<?php if( ON == config_get( 'use_javascript' ) ) { ?>\n\t\t\t\t<?php collapse_open( 'profile' ); collapse_icon('profile'); ?>\n\t\t\t\t<?php echo lang_get( 'or_fill_in' ); ?>\n\t\t\t<table class=\"width90\" cellspacing=\"0\">\n\t\t\t\t\t<?php } else { ?>\n\t\t\t\t\t\t<?php echo lang_get( 'or_fill_in' ); ?>\n\t\t\t\t\t<?php } ?>\n\t\t\t\t\t<tr <?php echo helper_alternate_class() ?>>\n\t\t\t\t\t\t<td class=\"category\">\n\t\t\t\t\t\t\t<?php echo lang_get( 'platform' ) ?>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<?php if ( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) { ?>\n\t\t\t\t\t\t\t<select name=\"platform\">\n\t\t\t\t\t\t\t\t<option value=\"\"></option>\n\t\t\t\t\t\t\t\t<?php print_platform_option_list( $f_platform ); ?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tprojax_autocomplete( 'platform_get_with_prefix', 'platform', array( 'value' => $f_platform, 'size' => '32', 'maxlength' => '32', 'tabindex' => helper_get_tab_index_value() ) );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr <?php echo helper_alternate_class() ?>>\n\t\t\t\t\t\t<td class=\"category\">\n\t\t\t\t\t\t\t<?php echo lang_get( 'os' ) ?>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<?php if ( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) { ?>\n\t\t\t\t\t\t\t<select name=\"os\">\n\t\t\t\t\t\t\t\t<option value=\"\"></option>\n\t\t\t\t\t\t\t\t<?php print_os_option_list( $f_os ); ?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tprojax_autocomplete( 'os_get_with_prefix', 'os', array( 'value' => $f_os, 'size' => '32', 'maxlength' => '32', 'tabindex' => helper_get_tab_index_value() ) );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr <?php echo helper_alternate_class() ?>>\n\t\t\t\t\t\t<td class=\"category\">\n\t\t\t\t\t\t\t<?php echo lang_get( 'os_version' ) ?>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\tif ( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) {\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t<select name=\"os_build\">\n\t\t\t\t\t\t\t\t<option value=\"\"></option>\n\t\t\t\t\t\t\t\t\t<?php print_os_build_option_list( $f_os_build ); ?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tprojax_autocomplete( 'os_build_get_with_prefix', 'os_build', array( 'value' => $f_os_build, 'size' => '16', 'maxlength' => '16', 'tabindex' => helper_get_tab_index_value() ) );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t<?php if( ON == config_get( 'use_javascript' ) ) { ?>\n\t\t\t</table>\n\t\t\t<?php collapse_closed( 'profile' ); collapse_icon('profile'); echo lang_get( 'or_fill_in' );?>\n\t\t\t<?php collapse_end( 'profile' ); ?>\n\t\t<?php } ?>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php\n\tif ( $tpl_show_product_version ) {\n\t\t$t_product_version_released_mask = VERSION_RELEASED;\n\n\t\tif (access_has_project_level( config_get( 'report_issues_for_unreleased_versions_threshold' ) ) ) {\n\t\t\t$t_product_version_released_mask = VERSION_ALL;\n\t\t}\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'product_version' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"product_version\">\n\t\t\t\t<?php print_version_option_list( $f_product_version, $t_project_id, $t_product_version_released_mask ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n?>\n<?php if ( $tpl_show_product_build ) { ?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'product_build' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"text\" name=\"build\" size=\"32\" maxlength=\"32\" value=\"<?php echo string_attribute( $f_build ) ?>\" />\n\t\t</td>\n\t</tr>\n<?php } ?>\n\n<?php if ( $tpl_show_handler ) { ?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'assign_to' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"handler_id\">\n\t\t\t\t<option value=\"0\" selected=\"selected\"></option>\n\t\t\t\t<?php print_assign_to_option_list( $f_handler_id ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php } ?>\n\n<?php // Target Version (if permissions allow)\n\tif ( $tpl_show_target_version ) { ?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'target_version' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"target_version\">\n\t\t\t\t<?php print_version_option_list() ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php event_signal( 'EVENT_REPORT_BUG_FORM', array( $t_project_id ) ) ?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<span class=\"required\">*</span><?php print_documentation_link( 'summary' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"text\" name=\"summary\" size=\"105\" maxlength=\"128\" value=\"<?php echo string_attribute( $f_summary ) ?>\" />\n\t\t</td>\n\t</tr>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<span class=\"required\">*</span><?php print_documentation_link( 'description' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<textarea <?php echo helper_get_tab_index() ?> name=\"description\" cols=\"80\" rows=\"10\"><?php echo string_textarea( $f_description ) ?></textarea>\n\t\t</td>\n\t</tr>\n\n<?php if ( $tpl_show_steps_to_reproduce ) { ?>\n\t\t<tr <?php echo helper_alternate_class() ?>>\n\t\t\t<td class=\"category\">\n\t\t\t\t<?php print_documentation_link( 'steps_to_reproduce' ) ?>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t\t<textarea <?php echo helper_get_tab_index() ?> name=\"steps_to_reproduce\" cols=\"80\" rows=\"10\"><?php echo string_textarea( $f_steps_to_reproduce ) ?></textarea>\n\t\t\t</td>\n\t\t</tr>\n<?php } ?>\n\n<?php if ( $tpl_show_additional_info ) { ?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php print_documentation_link( 'additional_information' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<textarea <?php echo helper_get_tab_index() ?> name=\"additional_info\" cols=\"80\" rows=\"10\"><?php echo string_textarea( $f_additional_info ) ?></textarea>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\t$t_custom_fields_found = false;\n\t$t_related_custom_field_ids = custom_field_get_linked_ids( $t_project_id );\n\n\tforeach( $t_related_custom_field_ids as $t_id ) {\n\t\t$t_def = custom_field_get_definition( $t_id );\n\t\tif( ( $t_def['display_report'] || $t_def['require_report']) && custom_field_has_write_access_to_project( $t_id, $t_project_id ) ) {\n\t\t\t$t_custom_fields_found = true;\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php if($t_def['require_report']) {?><span class=\"required\">*</span><?php } echo string_display( lang_get_defaulted( $t_def['name'] ) ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<?php print_custom_field_input( $t_def, ( $f_master_bug_id === 0 ) ? null : $f_master_bug_id ) ?>\n\t\t</td>\n\t</tr>\n<?php\n\t\t}\n\t} # foreach( $t_related_custom_field_ids as $t_id )\n?>\n<?php if ( $tpl_show_attachments ) { // File Upload (if enabled)\n\t$t_max_file_size = (int)min( ini_get_number( 'upload_max_filesize' ), ini_get_number( 'post_max_size' ), config_get( 'max_file_size' ) );\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'upload_file' ) ?>\n\t\t\t<?php echo '<span class=\"small\">(' . lang_get( 'max_file_size' ) . ': ' . number_format( $t_max_file_size/1000 ) . 'k)</span>'?>\n\t\t</td>\n\t\t<td>\n\t\t\t<input type=\"hidden\" name=\"max_file_size\" value=\"<?php echo $t_max_file_size ?>\" />\n\t\t\t<input <?php echo helper_get_tab_index() ?> name=\"file\" type=\"file\" size=\"60\" />\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif ( $tpl_show_view_state ) {\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'view_status' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<label><input <?php echo helper_get_tab_index() ?> type=\"radio\" name=\"view_state\" value=\"<?php echo VS_PUBLIC ?>\" <?php check_checked( $f_view_state, VS_PUBLIC ) ?> /> <?php echo lang_get( 'public' ) ?></label>\n\t\t\t<label><input <?php echo helper_get_tab_index() ?> type=\"radio\" name=\"view_state\" value=\"<?php echo VS_PRIVATE ?>\" <?php check_checked( $f_view_state, VS_PRIVATE ) ?> /> <?php echo lang_get( 'private' ) ?></label>\n\t<?php\n\t\t}\n\t?>\n\t\t</td>\n\t</tr>\n<?php //Relationship (in case of cloned bug creation...)\n\tif( $f_master_bug_id > 0 ) {\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'relationship_with_parent' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<?php relationship_list_box( /* none */ -2, \"rel_type\", false, true ) ?>\n\t\t\t<?php echo '<b>' . lang_get( 'bug' ) . ' ' . bug_format_id( $f_master_bug_id ) . '</b>' ?>\n\t\t</td>\n\t</tr>\n\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'copy_from_parent' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<label><input <?php echo helper_get_tab_index() ?> type=\"checkbox\" id=\"copy_notes_from_parent\" name=\"copy_notes_from_parent\" <?php check_checked( $f_copy_notes_from_parent ) ?> /> <?php echo lang_get( 'copy_notes_from_parent' ) ?></label>\n\t\t\t<label><input <?php echo helper_get_tab_index() ?> type=\"checkbox\" id=\"copy_attachments_from_parent\" name=\"copy_attachments_from_parent\" <?php check_checked( $f_copy_attachments_from_parent ) ?> /> <?php echo lang_get( 'copy_attachments_from_parent' ) ?></label>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php print_documentation_link( 'report_stay' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<label><input <?php echo helper_get_tab_index() ?> type=\"checkbox\" id=\"report_stay\" name=\"report_stay\" <?php check_checked( $f_report_stay ) ?> /> <?php echo lang_get( 'check_report_more_bugs' ) ?></label>\n\t\t</td>\n\t</tr>\n\t<tr>\n\t\t<td class=\"left\">\n\t\t\t<span class=\"required\"> * <?php echo lang_get( 'required' ) ?></span>\n\t\t</td>\n\t\t<td class=\"center\">\n\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"submit\" class=\"button\" value=\"<?php echo lang_get( 'submit_report_button' ) ?>\" />\n\t\t</td>\n\t</tr>\n</table>\n</form>\n</div>\n\n<!-- Autofocus JS -->\n<?php if ( ON == config_get( 'use_javascript' ) ) { ?>\n<script type=\"text/javascript\" language=\"JavaScript\">\n<!--\n\twindow.document.report_bug_form.category_id.focus();\n-->\n</script>\n<?php  }\nif ( $tpl_show_due_date ) {\n\tdate_finish_calendar( 'due_date', 'trigger' );\n}\n\nhtml_page_bottom();\n", "<?php\n# MantisBT - a php based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package MantisBT\n * @copyright Copyright (C) 2000 - 2002  Kenzaburo Ito - kenito@300baud.org\n * @copyright Copyright (C) 2002 - 2011  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n * @link http://www.mantisbt.org\n */\n\n$g_allow_browser_cache = 1;\nrequire_once( 'core.php' );\n\nrequire_once( 'ajax_api.php' );\nrequire_once( 'bug_api.php' );\nrequire_once( 'custom_field_api.php' );\nrequire_once( 'date_api.php' );\nrequire_once( 'last_visited_api.php' );\nrequire_once( 'projax_api.php' );\n\n$f_bug_id = gpc_get_int( 'bug_id' );\n\n$tpl_bug = bug_get( $f_bug_id, true );\n\nif ( $tpl_bug->project_id != helper_get_current_project() ) {\n\t# in case the current project is not the same project of the bug we are viewing...\n\t# ... override the current project. This to avoid problems with categories and handlers lists etc.\n\t$g_project_override = $tpl_bug->project_id;\n\t$tpl_changed_project = true;\n} else {\n\t$tpl_changed_project = false;\n}\n\nif ( bug_is_readonly( $f_bug_id ) ) {\n\terror_parameters( $f_bug_id );\n\ttrigger_error( ERROR_BUG_READ_ONLY_ACTION_DENIED, ERROR );\n}\n\naccess_ensure_bug_level( config_get( 'update_bug_threshold' ), $f_bug_id );\n\nhtml_page_top( bug_format_summary( $f_bug_id, SUMMARY_CAPTION ) );\n\nprint_recently_visited();\n\n$t_fields = config_get( 'bug_update_page_fields' );\n$t_fields = columns_filter_disabled( $t_fields );\n\n$tpl_bug_id = $f_bug_id;\n\n$t_action_button_position = config_get( 'action_button_position' );\n\n$tpl_top_buttons_enabled = $t_action_button_position == POSITION_TOP || $t_action_button_position == POSITION_BOTH;\n$tpl_bottom_buttons_enabled = $t_action_button_position == POSITION_BOTTOM || $t_action_button_position == POSITION_BOTH;\n\n$tpl_show_id = in_array( 'id', $t_fields );\n$tpl_show_project = in_array( 'project', $t_fields );\n$tpl_show_category = in_array( 'category_id', $t_fields );\n$tpl_show_view_state = in_array( 'view_state', $t_fields );\n$tpl_view_state = $tpl_show_view_state ? string_display_line( get_enum_element( 'view_state', $tpl_bug->view_state ) ) : '';\n$tpl_show_date_submitted = in_array( 'date_submitted', $t_fields );\n$tpl_show_last_updated = in_array( 'last_updated', $t_fields );\n$tpl_show_reporter = in_array( 'reporter', $t_fields );\n$tpl_show_handler = in_array( 'handler', $t_fields );\n$tpl_show_priority = in_array( 'priority', $t_fields );\n$tpl_show_severity = in_array( 'severity', $t_fields );\n$tpl_show_reproducibility = in_array( 'reproducibility', $t_fields );\n$tpl_show_status = in_array( 'status', $t_fields );\n$tpl_show_resolution = in_array( 'resolution', $t_fields );\n$tpl_show_projection = in_array( 'projection', $t_fields ) && config_get( 'enable_projection' ) == ON;\n$tpl_show_eta = in_array( 'eta', $t_fields ) && config_get( 'enable_eta' ) == ON;\n$t_show_profiles = config_get( 'enable_profiles' ) == ON;\n$tpl_show_platform = $t_show_profiles && in_array( 'platform', $t_fields );\n$tpl_show_os = $t_show_profiles && in_array( 'os', $t_fields );\n$tpl_show_os_version = $t_show_profiles && in_array( 'os_version', $t_fields );\n$tpl_show_versions = version_should_show_product_version( $tpl_bug->project_id );\n$tpl_show_product_version = $tpl_show_versions && in_array( 'product_version', $t_fields );\n$tpl_show_product_build = $tpl_show_versions && in_array( 'product_build', $t_fields ) && ( config_get( 'enable_product_build' ) == ON );\n$tpl_product_build_attribute = $tpl_show_product_build ? string_attribute( $tpl_bug->build ) : '';\n$tpl_show_target_version = $tpl_show_versions && in_array( 'target_version', $t_fields ) && access_has_bug_level( config_get( 'roadmap_update_threshold' ), $tpl_bug_id );\n$tpl_show_fixed_in_version = $tpl_show_versions && in_array( 'fixed_in_version', $t_fields );\n$tpl_show_due_date = in_array( 'due_date', $t_fields ) && access_has_bug_level( config_get( 'due_date_view_threshold' ), $tpl_bug_id );\n$tpl_show_summary = in_array( 'summary', $t_fields );\n$tpl_summary_attribute = $tpl_show_summary ? string_attribute( $tpl_bug->summary ) : '';\n$tpl_show_description = in_array( 'description', $t_fields );\n$tpl_description_textarea = $tpl_show_description ? string_textarea( $tpl_bug->description ) : '';\n$tpl_show_additional_information = in_array( 'additional_info', $t_fields );\n$tpl_additional_information_textarea = $tpl_show_additional_information ? string_textarea( $tpl_bug->additional_information ) : '';\n$tpl_show_steps_to_reproduce = in_array( 'steps_to_reproduce', $t_fields );\n$tpl_steps_to_reproduce_textarea = $tpl_show_steps_to_reproduce ? string_textarea( $tpl_bug->steps_to_reproduce ) : '';\n$tpl_handler_name = string_display_line( user_get_name( $tpl_bug->handler_id ) );\n\n$tpl_can_change_view_state = $tpl_show_view_state && access_has_project_level( config_get( 'change_view_status_threshold' ) );\n\nif ( $tpl_show_product_version ) {\n\t$tpl_product_version_released_mask = VERSION_RELEASED;\n\n\tif ( access_has_project_level( config_get( 'report_issues_for_unreleased_versions_threshold' ) ) ) {\n\t\t$tpl_product_version_released_mask = VERSION_ALL;\n\t}\n}\n\n$tpl_formatted_bug_id = $tpl_show_id ? bug_format_id( $f_bug_id ) : '';\n$tpl_project_name = $tpl_show_project ? string_display_line( project_get_name( $tpl_bug->project_id ) ) : '';\n\necho '<br />';\necho '<form name=\"update_bug_form\" method=\"post\" action=\"bug_update.php\">';\necho form_security_field( 'bug_update' );\necho '<table class=\"width100\" cellspacing=\"1\">';\necho '<tr>';\necho '<td class=\"form-title\" colspan=\"3\">';\necho '<input type=\"hidden\" name=\"bug_id\" value=\"', $tpl_bug_id, '\" />';\necho '<input type=\"hidden\" name=\"update_mode\" value=\"1\" />';\necho lang_get( 'updating_bug_advanced_title' );\necho '</td><td class=\"right\" colspan=\"3\">';\nprint_bracket_link( string_get_bug_view_url( $tpl_bug_id ), lang_get( 'back_to_bug_link' ) );\necho '</td></tr>';\n\n# Submit Button\nif ( $tpl_top_buttons_enabled ) {\n        echo '<tr><td class=\"center\" colspan=\"6\">';\n        echo '<input ', helper_get_tab_index(), ' type=\"submit\" class=\"button\" value=\"', lang_get( 'update_information_button' ), '\" />';\n        echo '</td></tr>';\n}\n\n\nevent_signal( 'EVENT_UPDATE_BUG_FORM_TOP', array( $tpl_bug_id, true ) );\n\nif ( $tpl_show_id || $tpl_show_project || $tpl_show_category || $tpl_show_view_state || $tpl_show_date_submitted | $tpl_show_last_updated ) {\n\t#\n\t# Titles for Bug Id, Project Name, Category, View State, Date Submitted, Last Updated\n\t#\n\n\techo '<tr>';\n\techo '<td width=\"15%\" class=\"category\">', $tpl_show_id ? lang_get( 'id' ) : '', '</td>';\n\techo '<td width=\"20%\" class=\"category\">', $tpl_show_project ? lang_get( 'email_project' ) : '', '</td>';\n\techo '<td width=\"15%\" class=\"category\">', $tpl_show_category ? lang_get( 'category' ) : '', '</td>';\n\techo '<td width=\"20%\" class=\"category\">', $tpl_show_view_state ? lang_get( 'view_status' ) : '', '</td>';\n\techo '<td width=\"15%\" class=\"category\">', $tpl_show_date_submitted ? lang_get( 'date_submitted' ) : '', '</td>';\n\techo '<td width=\"15%\" class=\"category\">', $tpl_show_last_updated ? lang_get( 'last_update' ) : '', '</td>';\n\techo '</tr>';\n\n\t#\n\t# Values for Bug Id, Project Name, Category, View State, Date Submitted, Last Updated\n\t#\n\n\techo '<tr ', helper_alternate_class(), '>';\n\n\t# Bug ID\n\techo '<td>', $tpl_formatted_bug_id, '</td>';\n\n\t# Project Name\n\techo '<td>', $tpl_project_name, '</td>';\n\n\t# Category\n\techo '<td>';\n\n\tif ( $tpl_show_category ) {\n\t\techo '<select ', helper_get_tab_index(), ' name=\"category_id\">';\n\t\tprint_category_option_list( $tpl_bug->category_id, $tpl_bug->project_id );\n\t\techo '</select>';\n\t}\n\n\techo '</td>';\n\n\t# View State\n\techo '<td>';\n\n\tif ( $tpl_can_change_view_state ) {\n\t\techo '<select ', helper_get_tab_index(), ' name=\"view_state\">';\n\t\tprint_enum_string_option_list( 'view_state', $tpl_bug->view_state);\n\t\techo '</select>';\n\t} else if ( $tpl_show_view_state ) {\n\t\techo $tpl_view_state;\n\t}\n\n\techo '</td>';\n\n\t# Date Submitted\n\techo '<td>', $tpl_show_date_submitted ? date( config_get( 'normal_date_format' ), $tpl_bug->date_submitted ) : '', '</td>';\n\n\t# Date Updated\n\techo '<td>', $tpl_show_last_updated ? date( config_get( 'normal_date_format' ), $tpl_bug->last_updated ) : '', '</td>';\n\n\techo '</tr>';\n\n\t# spacer\n\techo '<tr class=\"spacer\"><td colspan=\"6\"></td></tr>';\n}\n\n#\n# Reporter\n#\n\nif ( $tpl_show_reporter ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\t\n\t$t_spacer = 4;\n\n\tif ( $tpl_show_reporter ) {\n\t\t# Reporter\n\t\techo '<td class=\"category\">', lang_get( 'reporter' ), '</td>';\n\t\techo '<td>';\n\n\t\tif ( ON == config_get( 'use_javascript' ) ) {\n\t\t\t$t_username = prepare_user_name( $tpl_bug->reporter_id );\n\t\t\techo ajax_click_to_edit( $t_username, 'reporter_id', 'entrypoint=issue_reporter_combobox&issue_id=' . $tpl_bug_id );\n\t\t} else {\n\t\t\techo '<select ', helper_get_tab_index(), ' name=\"reporter_id\">';\n\t\t\tprint_reporter_option_list( $tpl_bug->reporter_id, $tpl_bug->project_id );\n\t\t\techo '</select>';\n\t\t}\n\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\n\techo '</tr>';\n}\n\n#\n# Assigned To, Due Date\n#\n\nif ( $tpl_show_handler || $tpl_show_due_date ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\t\n\t$t_spacer = 2;\n\n\t# Assigned To\n\techo '<td class=\"category\">', lang_get( 'assigned_to' ), '</td>';\n\techo '<td>';\n\n\tif ( access_has_project_level( config_get( 'update_bug_assign_threshold', config_get( 'update_bug_threshold' ) ) ) ) {\n\t\techo '<select ', helper_get_tab_index(), ' name=\"handler_id\">';\n\t\techo '<option value=\"0\"></option>';\n\t\tprint_assign_to_option_list( $tpl_bug->handler_id, $tpl_bug->project_id );\n\t\techo '</select>';\n\t} else {\n\t\techo $tpl_handler_name;\n\t}\n\n\techo '</td>';\n\n\tif ( $tpl_show_due_date ) {\n\t\t# Due Date\n\t\techo '<td class=\"category\">', lang_get( 'due_date' ), '</td>';\n\n\t\tif ( bug_is_overdue( $tpl_bug_id ) ) {\n\t\t\techo '<td class=\"overdue\">';\n\t\t} else {\n\t\t\techo '<td>';\n\t\t}\n\n\t\tif ( access_has_bug_level( config_get( 'due_date_update_threshold' ), $tpl_bug_id ) ) {\n\t\t\t$t_date_to_display = '';\n\n\t\t\tif ( !date_is_null( $tpl_bug->due_date ) ) {\n\t\t\t\t$t_date_to_display = date( config_get( 'calendar_date_format' ), $tpl_bug->due_date );\n\t\t\t}\n\n\t\t\techo '<input ', helper_get_tab_index(), ' type=\"text\" id=\"due_date\" name=\"due_date\" size=\"20\" maxlength=\"16\" value=\"', $t_date_to_display, '\">';\n\t\t\tdate_print_calendar();\n\t\t\tdate_finish_calendar( 'due_date', 'trigger');\n\t\t} else {\n\t\t\tif ( !date_is_null( $tpl_bug->due_date ) ) {\n\t\t\t\techo date( config_get( 'short_date_format' ), $tpl_bug->due_date  );\n\t\t\t}\n\t\t}\n\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\t\n\t# spacer\n\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\n\techo '</tr>';\n}\n\n#\n# Priority, Severity, Reproducibility\n#\n\nif ( $tpl_show_priority || $tpl_show_severity || $tpl_show_reproducibility ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\t\n\t$t_spacer = 0;\n\n\tif ( $tpl_show_priority ) {\n\t\t# Priority\n\t\techo '<td class=\"category\">', lang_get( 'priority' ), '</td>';\n\t\techo '<td align=\"left\">', '<select ', helper_get_tab_index(), ' name=\"priority\">';\n\t\tprint_enum_string_option_list( 'priority', $tpl_bug->priority );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\tif ( $tpl_show_severity ) {\n\t\t# Severity\n\t\techo '<td class=\"category\">', lang_get( 'severity' ), '</td>';\n\t\techo '<td>', '<select ', helper_get_tab_index(), ' name=\"severity\">';\n\t\tprint_enum_string_option_list( 'severity', $tpl_bug->severity );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\tif ( $tpl_show_reproducibility ) {\n\t\t# Reproducibility\n\t\techo '<td class=\"category\">', lang_get( 'reproducibility' ), '</td>';\n\t\techo '<td><select ', helper_get_tab_index(), ' name=\"reproducibility\">';\n\t\tprint_enum_string_option_list( 'reproducibility', $tpl_bug->reproducibility );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\tif ( $t_spacer > 0 ) {\n\t\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\t}\n\n\techo '</tr>';\n}\n\n#\n# Status, Resolution\n#\n\nif ( $tpl_show_status || $tpl_show_resolution ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\n\t$t_spacer = 2;\n\n\tif ( $tpl_show_status ) {\n\t\t# Status\n\t\techo '<td class=\"category\">', lang_get( 'status' ), '</td>';\n\t\techo '<td bgcolor=\"', get_status_color( $tpl_bug->status ), '\">';\n\t\tprint_status_option_list( 'status', $tpl_bug->status,\n\t\t\t\t\t\t\t( $tpl_bug->reporter_id == auth_get_current_user_id() &&\n\t\t\t\t\t\t\t\t\t( ON == config_get( 'allow_reporter_close' ) ) ), $tpl_bug->project_id );\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\tif ( $tpl_show_resolution ) {\n\t\t# Resolution\n\t\techo '<td class=\"category\">', lang_get( 'resolution' ), '</td>';\n\t\techo '<td><select ', helper_get_tab_index(), ' name=\"resolution\">';\n\t\tprint_enum_string_option_list( \"resolution\", $tpl_bug->resolution );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\tif ( $t_spacer > 0 ) {\n\t\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\t}\n\n\techo '</tr>';\n}\n\n#\n# Projection, ETA\n#\n\nif ( $tpl_show_projection || $tpl_show_eta ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\n\t$t_spacer = 2;\n\n\tif ( $tpl_show_projection ) {\n\t\t# Projection\n\t\techo '<td class=\"category\">';\n\t\techo lang_get( 'projection' );\n\t\techo '</td>';\n\t\techo '<td><select name=\"projection\">';\n\t\tprint_enum_string_option_list( 'projection', $tpl_bug->projection );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# ETA\n\tif ( $tpl_show_eta ) {\n\t\techo '<td class=\"category\">', lang_get( 'eta' ), '</td>';\n\n\t\techo '<td>', '<select ', helper_get_tab_index(), ' name=\"eta\">';\n\t\tprint_enum_string_option_list( 'eta', $tpl_bug->eta );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\n\techo '</tr>';\n}\n\n#\n# Platform, OS, OS Version\n#\n\nif ( $tpl_show_platform || $tpl_show_os || $tpl_show_os_version ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\n\t$t_spacer = 0;\n\n\tif ( $tpl_show_platform ) {\n\t\t# Platform\n\t\techo '<td class=\"category\">', lang_get( 'platform' ), '</td>';\n\t\techo '<td>';\n\n\t\tif ( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) {\n\t\t\techo '<select name=\"platform\"><option value=\"\"></option>';\n\t\t\tprint_platform_option_list( $tpl_bug->platform );\n\t\t\techo '</select>';\n\t\t} else {\n\t\t\tprojax_autocomplete( 'platform_get_with_prefix', 'platform', array( 'value' => $tpl_bug->platform, 'size' => '16', 'maxlength' => '32', 'tabindex' => helper_get_tab_index_value() ) );\n\t\t}\n\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\tif ( $tpl_show_os ) {\n\t\t# Operating System\n\t\techo '<td class=\"category\">', lang_get( 'os' ), '</td>';\n\t\techo '<td>';\n\n\t\tif ( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) {\n\t\t\techo '<select name=\"os\"><option value=\"\"></option>';\n\t\t\tprint_os_option_list( $tpl_bug->os );\n\t\t\techo '</select>';\n\t\t} else {\n\t\t\tprojax_autocomplete( 'os_get_with_prefix', 'os', array( 'value' => $tpl_bug->os, 'size' => '16', 'maxlength' => '32', 'tabindex' => helper_get_tab_index_value() ) );\n\t\t}\n\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\tif ( $tpl_show_os_version ) {\n\t\t# OS Version\n\t\techo '<td class=\"category\">', lang_get( 'os_version' ), '</td>';\n\t\techo '<td>';\n\n\t\tif ( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) {\n\t\t\techo '<select name=\"os_build\"><option value=\"\"></option>';\n\t\t\tprint_os_build_option_list( $tpl_bug->os_build );\n\t\t\techo '</select>';\n\t\t} else {\n\t\t\tprojax_autocomplete( 'os_build_get_with_prefix', 'os_build', array( 'value' => $tpl_bug->os_build, 'size' => '16', 'maxlength' => '16', 'tabindex' => helper_get_tab_index_value() ) );\n\t\t}\n\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\tif ( $t_spacer > 0 ) {\n\t\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\t}\n\n\techo '</tr>';\n}\n\n#\n# Product Version, Product Build\n#\n\nif ( $tpl_show_product_version || $tpl_show_product_build ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\n\t$t_spacer = 2;\n\n\t# Product Version  or Product Build, if version is suppressed\n\tif ( $tpl_show_product_version ) {\n\t\techo '<td class=\"category\">', lang_get( 'product_version' ), '</td>';\n\t\techo '<td>', '<select ', helper_get_tab_index(), ' name=\"version\">';\n\t\tprint_version_option_list( $tpl_bug->version, $tpl_bug->project_id, $tpl_product_version_released_mask );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\tif ( $tpl_show_product_build ) {\n\t\techo '<td class=\"category\">', lang_get( 'product_build' ), '</td>';\n\t\techo '<td>';\n\t\techo '<input type=\"text\" name=\"build\" size=\"16\" maxlength=\"32\" value=\"', $tpl_product_build_attribute, '\" />';\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\n\techo '</tr>';\n}\n\n#\n# Target Versiom, Fixed in Version\n#\n\nif ( $tpl_show_target_version || $tpl_show_fixed_in_version ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\n\t$t_spacer = 2;\n\n\t# Target Version\n\tif ( $tpl_show_target_version ) {\n\t\techo '<td class=\"category\">', lang_get( 'target_version' ), '</td>';\n\t\techo '<td><select ', helper_get_tab_index(), ' name=\"target_version\">';\n\t\tprint_version_option_list( $tpl_bug->target_version, $tpl_bug->project_id, VERSION_ALL );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# Fixed in Version\n\tif ( $tpl_show_fixed_in_version ) {\n\t\techo '<td class=\"category\">';\n\t\techo lang_get( 'fixed_in_version' );\n\t\techo '</td>';\n\n\t\techo '<td>';\n\t\techo '<select ', helper_get_tab_index(), ' name=\"fixed_in_version\">';\n\t\tprint_version_option_list( $tpl_bug->fixed_in_version, $tpl_bug->project_id, VERSION_ALL );\n\t\techo '</select>';\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\n\techo '</tr>';\n}\n\nevent_signal( 'EVENT_UPDATE_BUG_FORM', array( $tpl_bug_id, true ) );\n\n# spacer\necho '<tr class=\"spacer\"><td colspan=\"6\"></td></tr>';\n\n# Summary\nif ( $tpl_show_summary ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\techo '<td class=\"category\">', lang_get( 'summary' ), '</td>';\n\techo '<td colspan=\"5\">', '<input ', helper_get_tab_index(), ' type=\"text\" name=\"summary\" size=\"105\" maxlength=\"128\" value=\"', $tpl_summary_attribute, '\" />';\n\techo '</td></tr>';\n}\n\n# Description\nif ( $tpl_show_description ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\techo '<td class=\"category\">', lang_get( 'description' ), '</td>';\n\techo '<td colspan=\"5\">';\n\techo '<textarea ', helper_get_tab_index(), ' cols=\"80\" rows=\"10\" name=\"description\">', $tpl_description_textarea, '</textarea>';\n\techo '</td></tr>';\n}\n\n# Steps to Reproduce\nif ( $tpl_show_steps_to_reproduce ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\techo '<td class=\"category\">', lang_get( 'steps_to_reproduce' ), '</td>';\n\techo '<td colspan=\"5\">';\n\techo '<textarea ', helper_get_tab_index(), ' cols=\"80\" rows=\"10\" name=\"steps_to_reproduce\">', $tpl_steps_to_reproduce_textarea, '</textarea>';\n\techo '</td></tr>';\n}\n\n# Additional Information\nif ( $tpl_show_additional_information ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\techo '<td class=\"category\">', lang_get( 'additional_information' ), '</td>';\n\techo '<td colspan=\"5\">';\n\techo '<textarea ', helper_get_tab_index(), ' cols=\"80\" rows=\"10\" name=\"additional_information\">', $tpl_additional_information_textarea, '</textarea>';\n\techo '</td></tr>';\n}\n\necho '<tr class=\"spacer\"><td colspan=\"6\"></td></tr>';\n\n# Custom Fields\n$t_custom_fields_found = false;\n$t_related_custom_field_ids = custom_field_get_linked_ids( $tpl_bug->project_id );\n\nforeach ( $t_related_custom_field_ids as $t_id ) {\n\t$t_def = custom_field_get_definition( $t_id );\n\tif ( ( $t_def['display_update'] || $t_def['require_update'] ) && custom_field_has_write_access( $t_id, $tpl_bug_id ) ) {\n\t\t$t_custom_fields_found = true;\n\n\t\techo '<tr ', helper_alternate_class(), '>';\n\t\techo '<td class=\"category\">';\n\t\tif ( $t_def['require_update'] ) {\n\t\t\techo '<span class=\"required\">*</span>';\n\t\t}\n\n\t\techo string_display( lang_get_defaulted( $t_def['name'] ) );\n\t\techo '</td><td colspan=\"5\">';\n\t\tprint_custom_field_input( $t_def, $tpl_bug_id );\n\t\techo '</td></tr>';\n\t}\n} # foreach( $t_related_custom_field_ids as $t_id )\n\nif ( $t_custom_fields_found ) {\n\t# spacer\n\techo '<tr class=\"spacer\"><td colspan=\"6\"></td></tr>';\n} # custom fields found\n\n# Bugnote Text Box\necho '<tr ', helper_alternate_class(), '>';\necho '<td class=\"category\">', lang_get( 'add_bugnote_title' ), '</td>';\necho '<td colspan=\"5\"><textarea ', helper_get_tab_index(), ' name=\"bugnote_text\" cols=\"80\" rows=\"10\"></textarea></td></tr>';\n\n# Bugnote Private Checkbox (if permitted)\nif ( access_has_bug_level( config_get( 'private_bugnote_threshold' ), $tpl_bug_id ) ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\techo '<td class=\"category\">', lang_get( 'private' ), '</td>';\n\techo '<td colspan=\"5\">';\n\n\t$t_default_bugnote_view_status = config_get( 'default_bugnote_view_status' );\n\tif ( access_has_bug_level( config_get( 'set_view_status_threshold' ), $tpl_bug_id ) ) {\n\t\techo '<input ', helper_get_tab_index(), ' type=\"checkbox\" name=\"private\" ', check_checked( config_get( 'default_bugnote_view_status' ), VS_PRIVATE ), ' />';\n\t\techo lang_get( 'private' );\n\t} else {\n\t\techo get_enum_element( 'view_state', $t_default_bugnote_view_status );\n\t}\n\n\techo '</td></tr>';\n}\n\n# Time Tracking (if permitted)\nif ( config_get('time_tracking_enabled') ) {\n\tif ( access_has_bug_level( config_get( 'time_tracking_edit_threshold' ), $tpl_bug_id ) ) {\n\t\techo '<tr ', helper_alternate_class(), '>';\n\t\techo '<td class=\"category\">', lang_get( 'time_tracking' ), ' (HH:MM)</td>';\n\t\techo '<td colspan=\"5\"><input type=\"text\" name=\"time_tracking\" size=\"5\" value=\"0:00\" /></td></tr>';\n\t}\n}\n\nevent_signal( 'EVENT_BUGNOTE_ADD_FORM', array( $tpl_bug_id ) );\n\n# Submit Button\nif ( $tpl_bottom_buttons_enabled ) {\n       echo '<tr><td class=\"center\" colspan=\"6\">';\n       echo '<input ', helper_get_tab_index(), ' type=\"submit\" class=\"button\" value=\"', lang_get( 'update_information_button' ), '\" />';\n       echo '</td></tr>';\n}\n\necho '</table></form>';\n\ninclude( dirname( __FILE__ ) . DIRECTORY_SEPARATOR . 'bugnote_view_inc.php' );\nhtml_page_bottom();\n\nlast_visited_issue( $tpl_bug_id );\n"], "fixing_code": ["<?php\n# MantisBT - a php based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n\t/**\n\t * This file POSTs data to report_bug.php\n\t *\n\t * @package MantisBT\n\t * @copyright Copyright (C) 2000 - 2002  Kenzaburo Ito - kenito@300baud.org\n\t * @copyright Copyright (C) 2002 - 2011  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n\t * @link http://www.mantisbt.org\n\t */\n\n\t $g_allow_browser_cache = 1;\n\n\t /**\n\t  * MantisBT Core API's\n\t  */\n\trequire_once( 'core.php' );\n\n\trequire_once( 'file_api.php' );\n\trequire_once( 'custom_field_api.php' );\n\trequire_once( 'last_visited_api.php' );\n\trequire_once( 'projax_api.php' );\n\trequire_once( 'collapse_api.php' );\n\n\t$f_master_bug_id = gpc_get_int( 'm_id', 0 );\n\n\t# this page is invalid for the 'All Project' selection except if this is a clone\n\tif ( ( ALL_PROJECTS == helper_get_current_project() ) && ( 0 == $f_master_bug_id ) ) {\n\t\tprint_header_redirect( 'login_select_proj_page.php?ref=bug_report_page.php' );\n\t}\n\n\tif ( $f_master_bug_id > 0 ) {\n\t\t# master bug exists...\n\t\tbug_ensure_exists( $f_master_bug_id );\n\n\t\t# master bug is not read-only...\n\t\tif ( bug_is_readonly( $f_master_bug_id ) ) {\n\t\t\terror_parameters( $f_master_bug_id );\n\t\t\ttrigger_error( ERROR_BUG_READ_ONLY_ACTION_DENIED, ERROR );\n\t\t}\n\n\t\t$t_bug = bug_get( $f_master_bug_id, true );\n\n\t\t# the user can at least update the master bug (needed to add the relationship)...\n\t\taccess_ensure_bug_level( config_get( 'update_bug_threshold', null, $t_bug->project_id ), $f_master_bug_id );\n\n\t\t#@@@ (thraxisp) Note that the master bug is cloned into the same project as the master, independent of\n\t\t#       what the current project is set to.\n\t\tif( $t_bug->project_id != helper_get_current_project() ) {\n            # in case the current project is not the same project of the bug we are viewing...\n            # ... override the current project. This to avoid problems with categories and handlers lists etc.\n            $g_project_override = $t_bug->project_id;\n            $t_changed_project = true;\n        } else {\n            $t_changed_project = false;\n        }\n\n\t    access_ensure_project_level( config_get( 'report_bug_threshold' ) );\n\n\t\t$f_build\t\t\t\t= $t_bug->build;\n\t\t$f_platform\t\t\t\t= $t_bug->platform;\n\t\t$f_os\t\t\t\t\t= $t_bug->os;\n\t\t$f_os_build\t\t\t\t= $t_bug->os_build;\n\t\t$f_product_version\t\t= $t_bug->version;\n\t\t$f_target_version\t\t= $t_bug->target_version;\n\t\t$f_profile_id\t\t\t= 0;\n\t\t$f_handler_id\t\t\t= $t_bug->handler_id;\n\n\t\t$f_category_id\t\t\t= $t_bug->category_id;\n\t\t$f_reproducibility\t\t= $t_bug->reproducibility;\n\t\t$f_severity\t\t\t\t= $t_bug->severity;\n\t\t$f_priority\t\t\t\t= $t_bug->priority;\n\t\t$f_summary\t\t\t\t= $t_bug->summary;\n\t\t$f_description\t\t\t= $t_bug->description;\n\t\t$f_steps_to_reproduce\t= $t_bug->steps_to_reproduce;\n\t\t$f_additional_info\t\t= $t_bug->additional_information;\n\t\t$f_view_state\t\t\t= $t_bug->view_state;\n\t\t$f_due_date\t\t\t\t= $t_bug->due_date;\n\n\t\t$t_project_id\t\t\t= $t_bug->project_id;\n\t} else {\n\t    access_ensure_project_level( config_get( 'report_bug_threshold' ) );\n\n\t\t$f_build\t\t\t\t= gpc_get_string( 'build', '' );\n\t\t$f_platform\t\t\t\t= gpc_get_string( 'platform', '' );\n\t\t$f_os\t\t\t\t\t= gpc_get_string( 'os', '' );\n\t\t$f_os_build\t\t\t\t= gpc_get_string( 'os_build', '' );\n\t\t$f_product_version\t\t= gpc_get_string( 'product_version', '' );\n\t\t$f_target_version\t\t= gpc_get_string( 'target_version', '' );\n\t\t$f_profile_id\t\t\t= gpc_get_int( 'profile_id', 0 );\n\t\t$f_handler_id\t\t\t= gpc_get_int( 'handler_id', 0 );\n\n\t\t$f_category_id\t\t\t= gpc_get_int( 'category_id', 0 );\n\t\t$f_reproducibility\t\t= gpc_get_int( 'reproducibility', config_get( 'default_bug_reproducibility' ) );\n\t\t$f_severity\t\t\t\t= gpc_get_int( 'severity', config_get( 'default_bug_severity' ) );\n\t\t$f_priority\t\t\t\t= gpc_get_int( 'priority', config_get( 'default_bug_priority' ) );\n\t\t$f_summary\t\t\t\t= gpc_get_string( 'summary', '' );\n\t\t$f_description\t\t\t= gpc_get_string( 'description', '' );\n\t\t$f_steps_to_reproduce\t= gpc_get_string( 'steps_to_reproduce', config_get( 'default_bug_steps_to_reproduce' ) );\n\t\t$f_additional_info\t\t= gpc_get_string( 'additional_info', config_get ( 'default_bug_additional_info' ) );\n\t\t$f_view_state\t\t\t= gpc_get_int( 'view_state', config_get( 'default_bug_view_status' ) );\n\t\t$f_due_date\t\t\t\t= gpc_get_string( 'due_date', '');\n\n\t\tif ( $f_due_date == '' ) {\n\t\t\t$f_due_date = date_get_null();\n\t\t}\n\n\t\t$t_project_id\t\t\t= helper_get_current_project();\n\n\t\t$t_changed_project\t\t= false;\n\t}\n\n\t$f_report_stay\t\t\t          = gpc_get_bool( 'report_stay', false );\n\t$f_copy_notes_from_parent         = gpc_get_bool( 'copy_notes_from_parent', false);\n\t$f_copy_attachments_from_parent   = gpc_get_bool( 'copy_attachments_from_parent', false);\n\n\t$t_fields = config_get( 'bug_report_page_fields' );\n\t$t_fields = columns_filter_disabled( $t_fields );\n\n\t$tpl_show_category = in_array( 'category_id', $t_fields );\n\t$tpl_show_reproducibility = in_array( 'reproducibility', $t_fields );\n\t$tpl_show_severity = in_array( 'severity', $t_fields );\n\t$tpl_show_priority = in_array( 'priority', $t_fields );\n\t$tpl_show_steps_to_reproduce = in_array( 'steps_to_reproduce', $t_fields );\n\t$tpl_show_handler = in_array( 'handler', $t_fields ) && access_has_project_level( config_get( 'update_bug_assign_threshold' ) );\n\t$tpl_show_profiles = config_get( 'enable_profiles' );\n\t$tpl_show_platform = $tpl_show_profiles && in_array( 'platform', $t_fields );\n\t$tpl_show_os = $tpl_show_profiles && in_array( 'os', $t_fields );\n\t$tpl_show_os_version = $tpl_show_profiles && in_array( 'os_version', $t_fields );\n\n\t$tpl_show_versions = version_should_show_product_version( $t_project_id );\n\t$tpl_show_product_version = $tpl_show_versions && in_array( 'product_version', $t_fields );\n\t$tpl_show_product_build = $tpl_show_versions && in_array( 'product_build', $t_fields ) && config_get( 'enable_product_build' ) == ON;\n\t$tpl_show_target_version = $tpl_show_versions && in_array( 'target_version', $t_fields ) && access_has_project_level( config_get( 'roadmap_update_threshold' ) );\n\t$tpl_show_additional_info = in_array( 'additional_info', $t_fields );\n\t$tpl_show_due_date = in_array( 'due_date', $t_fields ) && access_has_project_level( config_get( 'due_date_update_threshold' ), helper_get_current_project(), auth_get_current_user_id() );\n\t$tpl_show_attachments = in_array( 'attachments', $t_fields ) && file_allow_bug_upload();\n\t$tpl_show_view_state = in_array( 'view_state', $t_fields ) && access_has_project_level( config_get( 'set_view_status_threshold' ) );\n\n\t# don't index bug report page\n\thtml_robots_noindex();\n\n\thtml_page_top( lang_get( 'report_bug_link' ) );\n\n\tprint_recently_visited();\n?>\n<br />\n<div align=\"center\">\n<form name=\"report_bug_form\" method=\"post\" <?php if ( $tpl_show_attachments ) { echo 'enctype=\"multipart/form-data\"'; } ?> action=\"bug_report.php\">\n<?php echo form_security_field( 'bug_report' ) ?>\n<table class=\"width90\" cellspacing=\"1\">\n\t<tr>\n\t\t<td class=\"form-title\" colspan=\"2\">\n\t\t\t<input type=\"hidden\" name=\"m_id\" value=\"<?php echo $f_master_bug_id ?>\" />\n\t\t\t<input type=\"hidden\" name=\"project_id\" value=\"<?php echo $t_project_id ?>\" />\n\t\t\t<?php echo lang_get( 'enter_report_details_title' ) ?>\n\t\t</td>\n\t</tr>\n<?php\n\tevent_signal( 'EVENT_REPORT_BUG_FORM_TOP', array( $t_project_id ) );\n\n\tif ( $tpl_show_category ) {\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\" width=\"30%\">\n\t\t\t<?php echo config_get( 'allow_no_category' ) ? '' : '<span class=\"required\">*</span>'; print_documentation_link( 'category' ) ?>\n\t\t</td>\n\t\t<td width=\"70%\">\n\t\t\t<?php if ( $t_changed_project ) {\n\t\t\t\techo \"[\" . project_get_field( $t_bug->project_id, 'name' ) . \"] \";\n\t\t\t} ?>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"category_id\">\n\t\t\t\t<?php\n\t\t\t\t\tprint_category_option_list( $f_category_id );\n\t\t\t\t?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php }\n\n\tif ( $tpl_show_reproducibility ) {\n?>\n\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php print_documentation_link( 'reproducibility' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"reproducibility\">\n\t\t\t\t<?php print_enum_string_option_list( 'reproducibility', $f_reproducibility ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif ( $tpl_show_severity ) {\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php print_documentation_link( 'severity' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"severity\">\n\t\t\t\t<?php print_enum_string_option_list( 'severity', $f_severity ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif ( $tpl_show_priority ) {\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php print_documentation_link( 'priority' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"priority\">\n\t\t\t\t<?php print_enum_string_option_list( 'priority', $f_priority ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif ( $tpl_show_due_date ) {\n\t\t$t_date_to_display = '';\n\n\t\tif ( !date_is_null( $f_due_date ) ) {\n\t\t\t$t_date_to_display = date( config_get( 'calendar_date_format' ), $f_due_date );\n\t\t}\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php print_documentation_link( 'due_date' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t<?php\n\t\t    print \"<input \".helper_get_tab_index().\" type=\\\"text\\\" id=\\\"due_date\\\" name=\\\"due_date\\\" size=\\\"20\\\" maxlength=\\\"16\\\" value=\\\"\".$t_date_to_display.\"\\\" />\";\n\t\t\tdate_print_calendar();\n\t\t?>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php if ( $tpl_show_platform || $tpl_show_os || $tpl_show_os_version ) { ?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'select_profile' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<?php if (count(profile_get_all_for_user( auth_get_current_user_id() )) > 0) { ?>\n\t\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"profile_id\">\n\t\t\t\t\t<?php print_profile_option_list( auth_get_current_user_id(), $f_profile_id ) ?>\n\t\t\t\t</select>\n\t\t\t<?php } ?>\n\t\t</td>\n\t</tr>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td colspan=\"2\" class=\"none\">\n\t\t\t<?php if( ON == config_get( 'use_javascript' ) ) { ?>\n\t\t\t\t<?php collapse_open( 'profile' ); collapse_icon('profile'); ?>\n\t\t\t\t<?php echo lang_get( 'or_fill_in' ); ?>\n\t\t\t<table class=\"width90\" cellspacing=\"0\">\n\t\t\t\t\t<?php } else { ?>\n\t\t\t\t\t\t<?php echo lang_get( 'or_fill_in' ); ?>\n\t\t\t\t\t<?php } ?>\n\t\t\t\t\t<tr <?php echo helper_alternate_class() ?>>\n\t\t\t\t\t\t<td class=\"category\">\n\t\t\t\t\t\t\t<?php echo lang_get( 'platform' ) ?>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<?php if ( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) { ?>\n\t\t\t\t\t\t\t<select name=\"platform\">\n\t\t\t\t\t\t\t\t<option value=\"\"></option>\n\t\t\t\t\t\t\t\t<?php print_platform_option_list( $f_platform ); ?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tprojax_autocomplete( 'platform_get_with_prefix', 'platform', array( 'value' => string_attribute( $f_platform ), 'size' => '32', 'maxlength' => '32', 'tabindex' => helper_get_tab_index_value() ) );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr <?php echo helper_alternate_class() ?>>\n\t\t\t\t\t\t<td class=\"category\">\n\t\t\t\t\t\t\t<?php echo lang_get( 'os' ) ?>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<?php if ( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) { ?>\n\t\t\t\t\t\t\t<select name=\"os\">\n\t\t\t\t\t\t\t\t<option value=\"\"></option>\n\t\t\t\t\t\t\t\t<?php print_os_option_list( $f_os ); ?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tprojax_autocomplete( 'os_get_with_prefix', 'os', array( 'value' => string_attribute( $f_os ), 'size' => '32', 'maxlength' => '32', 'tabindex' => helper_get_tab_index_value() ) );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr <?php echo helper_alternate_class() ?>>\n\t\t\t\t\t\t<td class=\"category\">\n\t\t\t\t\t\t\t<?php echo lang_get( 'os_version' ) ?>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\tif ( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) {\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t<select name=\"os_build\">\n\t\t\t\t\t\t\t\t<option value=\"\"></option>\n\t\t\t\t\t\t\t\t\t<?php print_os_build_option_list( $f_os_build ); ?>\n\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tprojax_autocomplete( 'os_build_get_with_prefix', 'os_build', array( 'value' => string_attribute( $f_os_build ), 'size' => '16', 'maxlength' => '16', 'tabindex' => helper_get_tab_index_value() ) );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t<?php if( ON == config_get( 'use_javascript' ) ) { ?>\n\t\t\t</table>\n\t\t\t<?php collapse_closed( 'profile' ); collapse_icon('profile'); echo lang_get( 'or_fill_in' );?>\n\t\t\t<?php collapse_end( 'profile' ); ?>\n\t\t<?php } ?>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php\n\tif ( $tpl_show_product_version ) {\n\t\t$t_product_version_released_mask = VERSION_RELEASED;\n\n\t\tif (access_has_project_level( config_get( 'report_issues_for_unreleased_versions_threshold' ) ) ) {\n\t\t\t$t_product_version_released_mask = VERSION_ALL;\n\t\t}\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'product_version' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"product_version\">\n\t\t\t\t<?php print_version_option_list( $f_product_version, $t_project_id, $t_product_version_released_mask ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n?>\n<?php if ( $tpl_show_product_build ) { ?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'product_build' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"text\" name=\"build\" size=\"32\" maxlength=\"32\" value=\"<?php echo string_attribute( $f_build ) ?>\" />\n\t\t</td>\n\t</tr>\n<?php } ?>\n\n<?php if ( $tpl_show_handler ) { ?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'assign_to' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"handler_id\">\n\t\t\t\t<option value=\"0\" selected=\"selected\"></option>\n\t\t\t\t<?php print_assign_to_option_list( $f_handler_id ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php } ?>\n\n<?php // Target Version (if permissions allow)\n\tif ( $tpl_show_target_version ) { ?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'target_version' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"target_version\">\n\t\t\t\t<?php print_version_option_list() ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php event_signal( 'EVENT_REPORT_BUG_FORM', array( $t_project_id ) ) ?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<span class=\"required\">*</span><?php print_documentation_link( 'summary' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"text\" name=\"summary\" size=\"105\" maxlength=\"128\" value=\"<?php echo string_attribute( $f_summary ) ?>\" />\n\t\t</td>\n\t</tr>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<span class=\"required\">*</span><?php print_documentation_link( 'description' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<textarea <?php echo helper_get_tab_index() ?> name=\"description\" cols=\"80\" rows=\"10\"><?php echo string_textarea( $f_description ) ?></textarea>\n\t\t</td>\n\t</tr>\n\n<?php if ( $tpl_show_steps_to_reproduce ) { ?>\n\t\t<tr <?php echo helper_alternate_class() ?>>\n\t\t\t<td class=\"category\">\n\t\t\t\t<?php print_documentation_link( 'steps_to_reproduce' ) ?>\n\t\t\t</td>\n\t\t\t<td>\n\t\t\t\t<textarea <?php echo helper_get_tab_index() ?> name=\"steps_to_reproduce\" cols=\"80\" rows=\"10\"><?php echo string_textarea( $f_steps_to_reproduce ) ?></textarea>\n\t\t\t</td>\n\t\t</tr>\n<?php } ?>\n\n<?php if ( $tpl_show_additional_info ) { ?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php print_documentation_link( 'additional_information' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<textarea <?php echo helper_get_tab_index() ?> name=\"additional_info\" cols=\"80\" rows=\"10\"><?php echo string_textarea( $f_additional_info ) ?></textarea>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\t$t_custom_fields_found = false;\n\t$t_related_custom_field_ids = custom_field_get_linked_ids( $t_project_id );\n\n\tforeach( $t_related_custom_field_ids as $t_id ) {\n\t\t$t_def = custom_field_get_definition( $t_id );\n\t\tif( ( $t_def['display_report'] || $t_def['require_report']) && custom_field_has_write_access_to_project( $t_id, $t_project_id ) ) {\n\t\t\t$t_custom_fields_found = true;\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php if($t_def['require_report']) {?><span class=\"required\">*</span><?php } echo string_display( lang_get_defaulted( $t_def['name'] ) ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<?php print_custom_field_input( $t_def, ( $f_master_bug_id === 0 ) ? null : $f_master_bug_id ) ?>\n\t\t</td>\n\t</tr>\n<?php\n\t\t}\n\t} # foreach( $t_related_custom_field_ids as $t_id )\n?>\n<?php if ( $tpl_show_attachments ) { // File Upload (if enabled)\n\t$t_max_file_size = (int)min( ini_get_number( 'upload_max_filesize' ), ini_get_number( 'post_max_size' ), config_get( 'max_file_size' ) );\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'upload_file' ) ?>\n\t\t\t<?php echo '<span class=\"small\">(' . lang_get( 'max_file_size' ) . ': ' . number_format( $t_max_file_size/1000 ) . 'k)</span>'?>\n\t\t</td>\n\t\t<td>\n\t\t\t<input type=\"hidden\" name=\"max_file_size\" value=\"<?php echo $t_max_file_size ?>\" />\n\t\t\t<input <?php echo helper_get_tab_index() ?> name=\"file\" type=\"file\" size=\"60\" />\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif ( $tpl_show_view_state ) {\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'view_status' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<label><input <?php echo helper_get_tab_index() ?> type=\"radio\" name=\"view_state\" value=\"<?php echo VS_PUBLIC ?>\" <?php check_checked( $f_view_state, VS_PUBLIC ) ?> /> <?php echo lang_get( 'public' ) ?></label>\n\t\t\t<label><input <?php echo helper_get_tab_index() ?> type=\"radio\" name=\"view_state\" value=\"<?php echo VS_PRIVATE ?>\" <?php check_checked( $f_view_state, VS_PRIVATE ) ?> /> <?php echo lang_get( 'private' ) ?></label>\n\t<?php\n\t\t}\n\t?>\n\t\t</td>\n\t</tr>\n<?php //Relationship (in case of cloned bug creation...)\n\tif( $f_master_bug_id > 0 ) {\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'relationship_with_parent' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<?php relationship_list_box( /* none */ -2, \"rel_type\", false, true ) ?>\n\t\t\t<?php echo '<b>' . lang_get( 'bug' ) . ' ' . bug_format_id( $f_master_bug_id ) . '</b>' ?>\n\t\t</td>\n\t</tr>\n\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'copy_from_parent' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<label><input <?php echo helper_get_tab_index() ?> type=\"checkbox\" id=\"copy_notes_from_parent\" name=\"copy_notes_from_parent\" <?php check_checked( $f_copy_notes_from_parent ) ?> /> <?php echo lang_get( 'copy_notes_from_parent' ) ?></label>\n\t\t\t<label><input <?php echo helper_get_tab_index() ?> type=\"checkbox\" id=\"copy_attachments_from_parent\" name=\"copy_attachments_from_parent\" <?php check_checked( $f_copy_attachments_from_parent ) ?> /> <?php echo lang_get( 'copy_attachments_from_parent' ) ?></label>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n?>\n\t<tr <?php echo helper_alternate_class() ?>>\n\t\t<td class=\"category\">\n\t\t\t<?php print_documentation_link( 'report_stay' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<label><input <?php echo helper_get_tab_index() ?> type=\"checkbox\" id=\"report_stay\" name=\"report_stay\" <?php check_checked( $f_report_stay ) ?> /> <?php echo lang_get( 'check_report_more_bugs' ) ?></label>\n\t\t</td>\n\t</tr>\n\t<tr>\n\t\t<td class=\"left\">\n\t\t\t<span class=\"required\"> * <?php echo lang_get( 'required' ) ?></span>\n\t\t</td>\n\t\t<td class=\"center\">\n\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"submit\" class=\"button\" value=\"<?php echo lang_get( 'submit_report_button' ) ?>\" />\n\t\t</td>\n\t</tr>\n</table>\n</form>\n</div>\n\n<!-- Autofocus JS -->\n<?php if ( ON == config_get( 'use_javascript' ) ) { ?>\n<script type=\"text/javascript\" language=\"JavaScript\">\n<!--\n\twindow.document.report_bug_form.category_id.focus();\n-->\n</script>\n<?php  }\nif ( $tpl_show_due_date ) {\n\tdate_finish_calendar( 'due_date', 'trigger' );\n}\n\nhtml_page_bottom();\n", "<?php\n# MantisBT - a php based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @package MantisBT\n * @copyright Copyright (C) 2000 - 2002  Kenzaburo Ito - kenito@300baud.org\n * @copyright Copyright (C) 2002 - 2011  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n * @link http://www.mantisbt.org\n */\n\n$g_allow_browser_cache = 1;\nrequire_once( 'core.php' );\n\nrequire_once( 'ajax_api.php' );\nrequire_once( 'bug_api.php' );\nrequire_once( 'custom_field_api.php' );\nrequire_once( 'date_api.php' );\nrequire_once( 'last_visited_api.php' );\nrequire_once( 'projax_api.php' );\n\n$f_bug_id = gpc_get_int( 'bug_id' );\n\n$tpl_bug = bug_get( $f_bug_id, true );\n\nif ( $tpl_bug->project_id != helper_get_current_project() ) {\n\t# in case the current project is not the same project of the bug we are viewing...\n\t# ... override the current project. This to avoid problems with categories and handlers lists etc.\n\t$g_project_override = $tpl_bug->project_id;\n\t$tpl_changed_project = true;\n} else {\n\t$tpl_changed_project = false;\n}\n\nif ( bug_is_readonly( $f_bug_id ) ) {\n\terror_parameters( $f_bug_id );\n\ttrigger_error( ERROR_BUG_READ_ONLY_ACTION_DENIED, ERROR );\n}\n\naccess_ensure_bug_level( config_get( 'update_bug_threshold' ), $f_bug_id );\n\nhtml_page_top( bug_format_summary( $f_bug_id, SUMMARY_CAPTION ) );\n\nprint_recently_visited();\n\n$t_fields = config_get( 'bug_update_page_fields' );\n$t_fields = columns_filter_disabled( $t_fields );\n\n$tpl_bug_id = $f_bug_id;\n\n$t_action_button_position = config_get( 'action_button_position' );\n\n$tpl_top_buttons_enabled = $t_action_button_position == POSITION_TOP || $t_action_button_position == POSITION_BOTH;\n$tpl_bottom_buttons_enabled = $t_action_button_position == POSITION_BOTTOM || $t_action_button_position == POSITION_BOTH;\n\n$tpl_show_id = in_array( 'id', $t_fields );\n$tpl_show_project = in_array( 'project', $t_fields );\n$tpl_show_category = in_array( 'category_id', $t_fields );\n$tpl_show_view_state = in_array( 'view_state', $t_fields );\n$tpl_view_state = $tpl_show_view_state ? string_display_line( get_enum_element( 'view_state', $tpl_bug->view_state ) ) : '';\n$tpl_show_date_submitted = in_array( 'date_submitted', $t_fields );\n$tpl_show_last_updated = in_array( 'last_updated', $t_fields );\n$tpl_show_reporter = in_array( 'reporter', $t_fields );\n$tpl_show_handler = in_array( 'handler', $t_fields );\n$tpl_show_priority = in_array( 'priority', $t_fields );\n$tpl_show_severity = in_array( 'severity', $t_fields );\n$tpl_show_reproducibility = in_array( 'reproducibility', $t_fields );\n$tpl_show_status = in_array( 'status', $t_fields );\n$tpl_show_resolution = in_array( 'resolution', $t_fields );\n$tpl_show_projection = in_array( 'projection', $t_fields ) && config_get( 'enable_projection' ) == ON;\n$tpl_show_eta = in_array( 'eta', $t_fields ) && config_get( 'enable_eta' ) == ON;\n$t_show_profiles = config_get( 'enable_profiles' ) == ON;\n$tpl_show_platform = $t_show_profiles && in_array( 'platform', $t_fields );\n$tpl_show_os = $t_show_profiles && in_array( 'os', $t_fields );\n$tpl_show_os_version = $t_show_profiles && in_array( 'os_version', $t_fields );\n$tpl_show_versions = version_should_show_product_version( $tpl_bug->project_id );\n$tpl_show_product_version = $tpl_show_versions && in_array( 'product_version', $t_fields );\n$tpl_show_product_build = $tpl_show_versions && in_array( 'product_build', $t_fields ) && ( config_get( 'enable_product_build' ) == ON );\n$tpl_product_build_attribute = $tpl_show_product_build ? string_attribute( $tpl_bug->build ) : '';\n$tpl_show_target_version = $tpl_show_versions && in_array( 'target_version', $t_fields ) && access_has_bug_level( config_get( 'roadmap_update_threshold' ), $tpl_bug_id );\n$tpl_show_fixed_in_version = $tpl_show_versions && in_array( 'fixed_in_version', $t_fields );\n$tpl_show_due_date = in_array( 'due_date', $t_fields ) && access_has_bug_level( config_get( 'due_date_view_threshold' ), $tpl_bug_id );\n$tpl_show_summary = in_array( 'summary', $t_fields );\n$tpl_summary_attribute = $tpl_show_summary ? string_attribute( $tpl_bug->summary ) : '';\n$tpl_show_description = in_array( 'description', $t_fields );\n$tpl_description_textarea = $tpl_show_description ? string_textarea( $tpl_bug->description ) : '';\n$tpl_show_additional_information = in_array( 'additional_info', $t_fields );\n$tpl_additional_information_textarea = $tpl_show_additional_information ? string_textarea( $tpl_bug->additional_information ) : '';\n$tpl_show_steps_to_reproduce = in_array( 'steps_to_reproduce', $t_fields );\n$tpl_steps_to_reproduce_textarea = $tpl_show_steps_to_reproduce ? string_textarea( $tpl_bug->steps_to_reproduce ) : '';\n$tpl_handler_name = string_display_line( user_get_name( $tpl_bug->handler_id ) );\n\n$tpl_can_change_view_state = $tpl_show_view_state && access_has_project_level( config_get( 'change_view_status_threshold' ) );\n\nif ( $tpl_show_product_version ) {\n\t$tpl_product_version_released_mask = VERSION_RELEASED;\n\n\tif ( access_has_project_level( config_get( 'report_issues_for_unreleased_versions_threshold' ) ) ) {\n\t\t$tpl_product_version_released_mask = VERSION_ALL;\n\t}\n}\n\n$tpl_formatted_bug_id = $tpl_show_id ? bug_format_id( $f_bug_id ) : '';\n$tpl_project_name = $tpl_show_project ? string_display_line( project_get_name( $tpl_bug->project_id ) ) : '';\n\necho '<br />';\necho '<form name=\"update_bug_form\" method=\"post\" action=\"bug_update.php\">';\necho form_security_field( 'bug_update' );\necho '<table class=\"width100\" cellspacing=\"1\">';\necho '<tr>';\necho '<td class=\"form-title\" colspan=\"3\">';\necho '<input type=\"hidden\" name=\"bug_id\" value=\"', $tpl_bug_id, '\" />';\necho '<input type=\"hidden\" name=\"update_mode\" value=\"1\" />';\necho lang_get( 'updating_bug_advanced_title' );\necho '</td><td class=\"right\" colspan=\"3\">';\nprint_bracket_link( string_get_bug_view_url( $tpl_bug_id ), lang_get( 'back_to_bug_link' ) );\necho '</td></tr>';\n\n# Submit Button\nif ( $tpl_top_buttons_enabled ) {\n        echo '<tr><td class=\"center\" colspan=\"6\">';\n        echo '<input ', helper_get_tab_index(), ' type=\"submit\" class=\"button\" value=\"', lang_get( 'update_information_button' ), '\" />';\n        echo '</td></tr>';\n}\n\n\nevent_signal( 'EVENT_UPDATE_BUG_FORM_TOP', array( $tpl_bug_id, true ) );\n\nif ( $tpl_show_id || $tpl_show_project || $tpl_show_category || $tpl_show_view_state || $tpl_show_date_submitted | $tpl_show_last_updated ) {\n\t#\n\t# Titles for Bug Id, Project Name, Category, View State, Date Submitted, Last Updated\n\t#\n\n\techo '<tr>';\n\techo '<td width=\"15%\" class=\"category\">', $tpl_show_id ? lang_get( 'id' ) : '', '</td>';\n\techo '<td width=\"20%\" class=\"category\">', $tpl_show_project ? lang_get( 'email_project' ) : '', '</td>';\n\techo '<td width=\"15%\" class=\"category\">', $tpl_show_category ? lang_get( 'category' ) : '', '</td>';\n\techo '<td width=\"20%\" class=\"category\">', $tpl_show_view_state ? lang_get( 'view_status' ) : '', '</td>';\n\techo '<td width=\"15%\" class=\"category\">', $tpl_show_date_submitted ? lang_get( 'date_submitted' ) : '', '</td>';\n\techo '<td width=\"15%\" class=\"category\">', $tpl_show_last_updated ? lang_get( 'last_update' ) : '', '</td>';\n\techo '</tr>';\n\n\t#\n\t# Values for Bug Id, Project Name, Category, View State, Date Submitted, Last Updated\n\t#\n\n\techo '<tr ', helper_alternate_class(), '>';\n\n\t# Bug ID\n\techo '<td>', $tpl_formatted_bug_id, '</td>';\n\n\t# Project Name\n\techo '<td>', $tpl_project_name, '</td>';\n\n\t# Category\n\techo '<td>';\n\n\tif ( $tpl_show_category ) {\n\t\techo '<select ', helper_get_tab_index(), ' name=\"category_id\">';\n\t\tprint_category_option_list( $tpl_bug->category_id, $tpl_bug->project_id );\n\t\techo '</select>';\n\t}\n\n\techo '</td>';\n\n\t# View State\n\techo '<td>';\n\n\tif ( $tpl_can_change_view_state ) {\n\t\techo '<select ', helper_get_tab_index(), ' name=\"view_state\">';\n\t\tprint_enum_string_option_list( 'view_state', $tpl_bug->view_state);\n\t\techo '</select>';\n\t} else if ( $tpl_show_view_state ) {\n\t\techo $tpl_view_state;\n\t}\n\n\techo '</td>';\n\n\t# Date Submitted\n\techo '<td>', $tpl_show_date_submitted ? date( config_get( 'normal_date_format' ), $tpl_bug->date_submitted ) : '', '</td>';\n\n\t# Date Updated\n\techo '<td>', $tpl_show_last_updated ? date( config_get( 'normal_date_format' ), $tpl_bug->last_updated ) : '', '</td>';\n\n\techo '</tr>';\n\n\t# spacer\n\techo '<tr class=\"spacer\"><td colspan=\"6\"></td></tr>';\n}\n\n#\n# Reporter\n#\n\nif ( $tpl_show_reporter ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\t\n\t$t_spacer = 4;\n\n\tif ( $tpl_show_reporter ) {\n\t\t# Reporter\n\t\techo '<td class=\"category\">', lang_get( 'reporter' ), '</td>';\n\t\techo '<td>';\n\n\t\tif ( ON == config_get( 'use_javascript' ) ) {\n\t\t\t$t_username = prepare_user_name( $tpl_bug->reporter_id );\n\t\t\techo ajax_click_to_edit( $t_username, 'reporter_id', 'entrypoint=issue_reporter_combobox&issue_id=' . $tpl_bug_id );\n\t\t} else {\n\t\t\techo '<select ', helper_get_tab_index(), ' name=\"reporter_id\">';\n\t\t\tprint_reporter_option_list( $tpl_bug->reporter_id, $tpl_bug->project_id );\n\t\t\techo '</select>';\n\t\t}\n\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\n\techo '</tr>';\n}\n\n#\n# Assigned To, Due Date\n#\n\nif ( $tpl_show_handler || $tpl_show_due_date ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\t\n\t$t_spacer = 2;\n\n\t# Assigned To\n\techo '<td class=\"category\">', lang_get( 'assigned_to' ), '</td>';\n\techo '<td>';\n\n\tif ( access_has_project_level( config_get( 'update_bug_assign_threshold', config_get( 'update_bug_threshold' ) ) ) ) {\n\t\techo '<select ', helper_get_tab_index(), ' name=\"handler_id\">';\n\t\techo '<option value=\"0\"></option>';\n\t\tprint_assign_to_option_list( $tpl_bug->handler_id, $tpl_bug->project_id );\n\t\techo '</select>';\n\t} else {\n\t\techo $tpl_handler_name;\n\t}\n\n\techo '</td>';\n\n\tif ( $tpl_show_due_date ) {\n\t\t# Due Date\n\t\techo '<td class=\"category\">', lang_get( 'due_date' ), '</td>';\n\n\t\tif ( bug_is_overdue( $tpl_bug_id ) ) {\n\t\t\techo '<td class=\"overdue\">';\n\t\t} else {\n\t\t\techo '<td>';\n\t\t}\n\n\t\tif ( access_has_bug_level( config_get( 'due_date_update_threshold' ), $tpl_bug_id ) ) {\n\t\t\t$t_date_to_display = '';\n\n\t\t\tif ( !date_is_null( $tpl_bug->due_date ) ) {\n\t\t\t\t$t_date_to_display = date( config_get( 'calendar_date_format' ), $tpl_bug->due_date );\n\t\t\t}\n\n\t\t\techo '<input ', helper_get_tab_index(), ' type=\"text\" id=\"due_date\" name=\"due_date\" size=\"20\" maxlength=\"16\" value=\"', $t_date_to_display, '\">';\n\t\t\tdate_print_calendar();\n\t\t\tdate_finish_calendar( 'due_date', 'trigger');\n\t\t} else {\n\t\t\tif ( !date_is_null( $tpl_bug->due_date ) ) {\n\t\t\t\techo date( config_get( 'short_date_format' ), $tpl_bug->due_date  );\n\t\t\t}\n\t\t}\n\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\t\n\t# spacer\n\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\n\techo '</tr>';\n}\n\n#\n# Priority, Severity, Reproducibility\n#\n\nif ( $tpl_show_priority || $tpl_show_severity || $tpl_show_reproducibility ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\t\n\t$t_spacer = 0;\n\n\tif ( $tpl_show_priority ) {\n\t\t# Priority\n\t\techo '<td class=\"category\">', lang_get( 'priority' ), '</td>';\n\t\techo '<td align=\"left\">', '<select ', helper_get_tab_index(), ' name=\"priority\">';\n\t\tprint_enum_string_option_list( 'priority', $tpl_bug->priority );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\tif ( $tpl_show_severity ) {\n\t\t# Severity\n\t\techo '<td class=\"category\">', lang_get( 'severity' ), '</td>';\n\t\techo '<td>', '<select ', helper_get_tab_index(), ' name=\"severity\">';\n\t\tprint_enum_string_option_list( 'severity', $tpl_bug->severity );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\tif ( $tpl_show_reproducibility ) {\n\t\t# Reproducibility\n\t\techo '<td class=\"category\">', lang_get( 'reproducibility' ), '</td>';\n\t\techo '<td><select ', helper_get_tab_index(), ' name=\"reproducibility\">';\n\t\tprint_enum_string_option_list( 'reproducibility', $tpl_bug->reproducibility );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\tif ( $t_spacer > 0 ) {\n\t\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\t}\n\n\techo '</tr>';\n}\n\n#\n# Status, Resolution\n#\n\nif ( $tpl_show_status || $tpl_show_resolution ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\n\t$t_spacer = 2;\n\n\tif ( $tpl_show_status ) {\n\t\t# Status\n\t\techo '<td class=\"category\">', lang_get( 'status' ), '</td>';\n\t\techo '<td bgcolor=\"', get_status_color( $tpl_bug->status ), '\">';\n\t\tprint_status_option_list( 'status', $tpl_bug->status,\n\t\t\t\t\t\t\t( $tpl_bug->reporter_id == auth_get_current_user_id() &&\n\t\t\t\t\t\t\t\t\t( ON == config_get( 'allow_reporter_close' ) ) ), $tpl_bug->project_id );\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\tif ( $tpl_show_resolution ) {\n\t\t# Resolution\n\t\techo '<td class=\"category\">', lang_get( 'resolution' ), '</td>';\n\t\techo '<td><select ', helper_get_tab_index(), ' name=\"resolution\">';\n\t\tprint_enum_string_option_list( \"resolution\", $tpl_bug->resolution );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\tif ( $t_spacer > 0 ) {\n\t\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\t}\n\n\techo '</tr>';\n}\n\n#\n# Projection, ETA\n#\n\nif ( $tpl_show_projection || $tpl_show_eta ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\n\t$t_spacer = 2;\n\n\tif ( $tpl_show_projection ) {\n\t\t# Projection\n\t\techo '<td class=\"category\">';\n\t\techo lang_get( 'projection' );\n\t\techo '</td>';\n\t\techo '<td><select name=\"projection\">';\n\t\tprint_enum_string_option_list( 'projection', $tpl_bug->projection );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# ETA\n\tif ( $tpl_show_eta ) {\n\t\techo '<td class=\"category\">', lang_get( 'eta' ), '</td>';\n\n\t\techo '<td>', '<select ', helper_get_tab_index(), ' name=\"eta\">';\n\t\tprint_enum_string_option_list( 'eta', $tpl_bug->eta );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\n\techo '</tr>';\n}\n\n#\n# Platform, OS, OS Version\n#\n\nif ( $tpl_show_platform || $tpl_show_os || $tpl_show_os_version ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\n\t$t_spacer = 0;\n\n\tif ( $tpl_show_platform ) {\n\t\t# Platform\n\t\techo '<td class=\"category\">', lang_get( 'platform' ), '</td>';\n\t\techo '<td>';\n\n\t\tif ( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) {\n\t\t\techo '<select name=\"platform\"><option value=\"\"></option>';\n\t\t\tprint_platform_option_list( $tpl_bug->platform );\n\t\t\techo '</select>';\n\t\t} else {\n\t\t\tprojax_autocomplete( 'platform_get_with_prefix', 'platform', array( 'value' => string_attribute( $tpl_bug->platform ), 'size' => '16', 'maxlength' => '32', 'tabindex' => helper_get_tab_index_value() ) );\n\t\t}\n\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\tif ( $tpl_show_os ) {\n\t\t# Operating System\n\t\techo '<td class=\"category\">', lang_get( 'os' ), '</td>';\n\t\techo '<td>';\n\n\t\tif ( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) {\n\t\t\techo '<select name=\"os\"><option value=\"\"></option>';\n\t\t\tprint_os_option_list( $tpl_bug->os );\n\t\t\techo '</select>';\n\t\t} else {\n\t\t\tprojax_autocomplete( 'os_get_with_prefix', 'os', array( 'value' => string_attribute( $tpl_bug->os ), 'size' => '16', 'maxlength' => '32', 'tabindex' => helper_get_tab_index_value() ) );\n\t\t}\n\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\tif ( $tpl_show_os_version ) {\n\t\t# OS Version\n\t\techo '<td class=\"category\">', lang_get( 'os_version' ), '</td>';\n\t\techo '<td>';\n\n\t\tif ( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) {\n\t\t\techo '<select name=\"os_build\"><option value=\"\"></option>';\n\t\t\tprint_os_build_option_list( $tpl_bug->os_build );\n\t\t\techo '</select>';\n\t\t} else {\n\t\t\tprojax_autocomplete( 'os_build_get_with_prefix', 'os_build', array( 'value' => string_attribute( $tpl_bug->os_build ), 'size' => '16', 'maxlength' => '16', 'tabindex' => helper_get_tab_index_value() ) );\n\t\t}\n\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\tif ( $t_spacer > 0 ) {\n\t\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\t}\n\n\techo '</tr>';\n}\n\n#\n# Product Version, Product Build\n#\n\nif ( $tpl_show_product_version || $tpl_show_product_build ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\n\t$t_spacer = 2;\n\n\t# Product Version  or Product Build, if version is suppressed\n\tif ( $tpl_show_product_version ) {\n\t\techo '<td class=\"category\">', lang_get( 'product_version' ), '</td>';\n\t\techo '<td>', '<select ', helper_get_tab_index(), ' name=\"version\">';\n\t\tprint_version_option_list( $tpl_bug->version, $tpl_bug->project_id, $tpl_product_version_released_mask );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\tif ( $tpl_show_product_build ) {\n\t\techo '<td class=\"category\">', lang_get( 'product_build' ), '</td>';\n\t\techo '<td>';\n\t\techo '<input type=\"text\" name=\"build\" size=\"16\" maxlength=\"32\" value=\"', $tpl_product_build_attribute, '\" />';\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\n\techo '</tr>';\n}\n\n#\n# Target Versiom, Fixed in Version\n#\n\nif ( $tpl_show_target_version || $tpl_show_fixed_in_version ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\n\t$t_spacer = 2;\n\n\t# Target Version\n\tif ( $tpl_show_target_version ) {\n\t\techo '<td class=\"category\">', lang_get( 'target_version' ), '</td>';\n\t\techo '<td><select ', helper_get_tab_index(), ' name=\"target_version\">';\n\t\tprint_version_option_list( $tpl_bug->target_version, $tpl_bug->project_id, VERSION_ALL );\n\t\techo '</select></td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# Fixed in Version\n\tif ( $tpl_show_fixed_in_version ) {\n\t\techo '<td class=\"category\">';\n\t\techo lang_get( 'fixed_in_version' );\n\t\techo '</td>';\n\n\t\techo '<td>';\n\t\techo '<select ', helper_get_tab_index(), ' name=\"fixed_in_version\">';\n\t\tprint_version_option_list( $tpl_bug->fixed_in_version, $tpl_bug->project_id, VERSION_ALL );\n\t\techo '</select>';\n\t\techo '</td>';\n\t} else {\n\t\t$t_spacer += 2;\n\t}\n\n\t# spacer\n\techo '<td colspan=\"', $t_spacer, '\">&#160;</td>';\n\n\techo '</tr>';\n}\n\nevent_signal( 'EVENT_UPDATE_BUG_FORM', array( $tpl_bug_id, true ) );\n\n# spacer\necho '<tr class=\"spacer\"><td colspan=\"6\"></td></tr>';\n\n# Summary\nif ( $tpl_show_summary ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\techo '<td class=\"category\">', lang_get( 'summary' ), '</td>';\n\techo '<td colspan=\"5\">', '<input ', helper_get_tab_index(), ' type=\"text\" name=\"summary\" size=\"105\" maxlength=\"128\" value=\"', $tpl_summary_attribute, '\" />';\n\techo '</td></tr>';\n}\n\n# Description\nif ( $tpl_show_description ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\techo '<td class=\"category\">', lang_get( 'description' ), '</td>';\n\techo '<td colspan=\"5\">';\n\techo '<textarea ', helper_get_tab_index(), ' cols=\"80\" rows=\"10\" name=\"description\">', $tpl_description_textarea, '</textarea>';\n\techo '</td></tr>';\n}\n\n# Steps to Reproduce\nif ( $tpl_show_steps_to_reproduce ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\techo '<td class=\"category\">', lang_get( 'steps_to_reproduce' ), '</td>';\n\techo '<td colspan=\"5\">';\n\techo '<textarea ', helper_get_tab_index(), ' cols=\"80\" rows=\"10\" name=\"steps_to_reproduce\">', $tpl_steps_to_reproduce_textarea, '</textarea>';\n\techo '</td></tr>';\n}\n\n# Additional Information\nif ( $tpl_show_additional_information ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\techo '<td class=\"category\">', lang_get( 'additional_information' ), '</td>';\n\techo '<td colspan=\"5\">';\n\techo '<textarea ', helper_get_tab_index(), ' cols=\"80\" rows=\"10\" name=\"additional_information\">', $tpl_additional_information_textarea, '</textarea>';\n\techo '</td></tr>';\n}\n\necho '<tr class=\"spacer\"><td colspan=\"6\"></td></tr>';\n\n# Custom Fields\n$t_custom_fields_found = false;\n$t_related_custom_field_ids = custom_field_get_linked_ids( $tpl_bug->project_id );\n\nforeach ( $t_related_custom_field_ids as $t_id ) {\n\t$t_def = custom_field_get_definition( $t_id );\n\tif ( ( $t_def['display_update'] || $t_def['require_update'] ) && custom_field_has_write_access( $t_id, $tpl_bug_id ) ) {\n\t\t$t_custom_fields_found = true;\n\n\t\techo '<tr ', helper_alternate_class(), '>';\n\t\techo '<td class=\"category\">';\n\t\tif ( $t_def['require_update'] ) {\n\t\t\techo '<span class=\"required\">*</span>';\n\t\t}\n\n\t\techo string_display( lang_get_defaulted( $t_def['name'] ) );\n\t\techo '</td><td colspan=\"5\">';\n\t\tprint_custom_field_input( $t_def, $tpl_bug_id );\n\t\techo '</td></tr>';\n\t}\n} # foreach( $t_related_custom_field_ids as $t_id )\n\nif ( $t_custom_fields_found ) {\n\t# spacer\n\techo '<tr class=\"spacer\"><td colspan=\"6\"></td></tr>';\n} # custom fields found\n\n# Bugnote Text Box\necho '<tr ', helper_alternate_class(), '>';\necho '<td class=\"category\">', lang_get( 'add_bugnote_title' ), '</td>';\necho '<td colspan=\"5\"><textarea ', helper_get_tab_index(), ' name=\"bugnote_text\" cols=\"80\" rows=\"10\"></textarea></td></tr>';\n\n# Bugnote Private Checkbox (if permitted)\nif ( access_has_bug_level( config_get( 'private_bugnote_threshold' ), $tpl_bug_id ) ) {\n\techo '<tr ', helper_alternate_class(), '>';\n\techo '<td class=\"category\">', lang_get( 'private' ), '</td>';\n\techo '<td colspan=\"5\">';\n\n\t$t_default_bugnote_view_status = config_get( 'default_bugnote_view_status' );\n\tif ( access_has_bug_level( config_get( 'set_view_status_threshold' ), $tpl_bug_id ) ) {\n\t\techo '<input ', helper_get_tab_index(), ' type=\"checkbox\" name=\"private\" ', check_checked( config_get( 'default_bugnote_view_status' ), VS_PRIVATE ), ' />';\n\t\techo lang_get( 'private' );\n\t} else {\n\t\techo get_enum_element( 'view_state', $t_default_bugnote_view_status );\n\t}\n\n\techo '</td></tr>';\n}\n\n# Time Tracking (if permitted)\nif ( config_get('time_tracking_enabled') ) {\n\tif ( access_has_bug_level( config_get( 'time_tracking_edit_threshold' ), $tpl_bug_id ) ) {\n\t\techo '<tr ', helper_alternate_class(), '>';\n\t\techo '<td class=\"category\">', lang_get( 'time_tracking' ), ' (HH:MM)</td>';\n\t\techo '<td colspan=\"5\"><input type=\"text\" name=\"time_tracking\" size=\"5\" value=\"0:00\" /></td></tr>';\n\t}\n}\n\nevent_signal( 'EVENT_BUGNOTE_ADD_FORM', array( $tpl_bug_id ) );\n\n# Submit Button\nif ( $tpl_bottom_buttons_enabled ) {\n       echo '<tr><td class=\"center\" colspan=\"6\">';\n       echo '<input ', helper_get_tab_index(), ' type=\"submit\" class=\"button\" value=\"', lang_get( 'update_information_button' ), '\" />';\n       echo '</td></tr>';\n}\n\necho '</table></form>';\n\ninclude( dirname( __FILE__ ) . DIRECTORY_SEPARATOR . 'bugnote_view_inc.php' );\nhtml_page_bottom();\n\nlast_visited_issue( $tpl_bug_id );\n"], "filenames": ["bug_report_page.php", "bug_update_advanced_page.php"], "buggy_code_start_loc": [294, 441], "buggy_code_end_loc": [331, 478], "fixing_code_start_loc": [294, 441], "fixing_code_end_loc": [331, 478], "type": "CWE-79", "message": "Multiple cross-site scripting (XSS) vulnerabilities in MantisBT before 1.2.8 allow remote attackers to inject arbitrary web script or HTML via the (1) os, (2) os_build, or (3) platform parameter to (a) bug_report_page.php or (b) bug_update_advanced_page.php, related to use of the Projax library.", "other": {"cve": {"id": "CVE-2011-3358", "sourceIdentifier": "secalert@redhat.com", "published": "2011-09-21T16:55:05.180", "lastModified": "2018-10-09T19:33:20.433", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "Multiple cross-site scripting (XSS) vulnerabilities in MantisBT before 1.2.8 allow remote attackers to inject arbitrary web script or HTML via the (1) os, (2) os_build, or (3) platform parameter to (a) bug_report_page.php or (b) bug_update_advanced_page.php, related to use of the Projax library."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de ejecuci\u00f3n de secuencias de comandos en sitios cruzados (XSS) en MantisBT antes de v1.2.8, permite a atacantes remotos inyectar secuencias de comandos web o HTML a trav\u00e9s del par\u00e1metro (1) os, (2) os_build, (3) platform de (a) bug_report_page.php o (b) bug_update_advanced_page.php, relacionado con el uso de la librer\u00eda Projax"}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.2.7", "matchCriteriaId": "E421063A-47DD-4307-AB38-331301A1DC6C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:0.19.3:*:*:*:*:*:*:*", "matchCriteriaId": "85A3FBD5-163C-4990-B809-A5C9C81A3C6C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:0.19.4:*:*:*:*:*:*:*", "matchCriteriaId": "D3FDF456-9648-4A7C-B15A-2828A32D4962"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "6B2602F7-2D93-4E1E-9425-4EDD23752029"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "86DE3BE3-D6C9-4905-9E61-B70776460604"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "F128A2E2-D509-4B50-95C2-1A31C5B3B31F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "140D5F68-1CAB-458C-BC8B-4F726D657FE8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.4:*:*:*:*:*:*:*", "matchCriteriaId": "0D25F4F5-7678-41C1-93CB-305883A08527"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.5:*:*:*:*:*:*:*", "matchCriteriaId": "D1A1316D-314B-4740-A836-D5E6319F4B28"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.6:*:*:*:*:*:*:*", "matchCriteriaId": "DBD27CCE-28C4-43CC-8CBD-D7FFB46171AC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.7:*:*:*:*:*:*:*", "matchCriteriaId": "97298C43-B881-4C11-ADB6-17A8E43EB84E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.0.8:*:*:*:*:*:*:*", "matchCriteriaId": "7257ADD7-C9B7-4F85-AA13-615DD033FD5C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "02FE950B-5E29-4FAA-9BE5-79F38B4C38F7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "D6F2BA78-D054-4E49-ABCA-637922898BF7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.2:*:*:*:*:*:*:*", "matchCriteriaId": "4595B1E3-25AB-489E-A847-FDBF2554DD6D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.4:*:*:*:*:*:*:*", "matchCriteriaId": "C11A8F17-5253-475B-89FF-A26EA7531E13"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.5:*:*:*:*:*:*:*", "matchCriteriaId": "4A88B09D-CDCF-45FD-B004-13B597DA4F48"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.6:*:*:*:*:*:*:*", "matchCriteriaId": "49583BE8-B832-4E9F-B154-47A26C72489D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.7:*:*:*:*:*:*:*", "matchCriteriaId": "E2501F40-3630-4528-BE0A-61D4BB6EC7FE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.1.8:*:*:*:*:*:*:*", "matchCriteriaId": "9223DAF7-D03E-4A4E-8AB5-5CEB87DFF2C3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "CFF77ABF-0A03-437A-B241-1EF2BBB83D24"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "5F096CD6-534E-4ABF-B2DF-D4B55B8C5F6A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.2:*:*:*:*:*:*:*", "matchCriteriaId": "A66AB537-6FBA-4A51-B10C-BF61F54BC01B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.3:*:*:*:*:*:*:*", "matchCriteriaId": "A50835BF-D28B-47FF-81F0-C34D95D6F2E9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.4:*:*:*:*:*:*:*", "matchCriteriaId": "BA0EB9A6-1DFD-4C17-A002-0899DA252A56"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.5:*:*:*:*:*:*:*", "matchCriteriaId": "BBA33285-3EE7-43FD-8347-E7D9A18DC134"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:1.2.6:*:*:*:*:*:*:*", "matchCriteriaId": "8827C2B4-EBEC-4D64-9AC8-07A048467F40"}]}]}], "references": [{"url": "http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=640297", "source": "secalert@redhat.com", "tags": ["Exploit", "Patch"]}, {"url": "http://lists.debian.org/debian-security-tracker/2011/09/msg00012.html", "source": "secalert@redhat.com"}, {"url": "http://lists.fedoraproject.org/pipermail/package-announce/2011-September/066061.html", "source": "secalert@redhat.com", "tags": ["Exploit"]}, {"url": "http://security.gentoo.org/glsa/glsa-201211-01.xml", "source": "secalert@redhat.com"}, {"url": "http://securityreason.com/securityalert/8392", "source": "secalert@redhat.com"}, {"url": "http://www.debian.org/security/2011/dsa-2308", "source": "secalert@redhat.com", "tags": ["Exploit", "Patch"]}, {"url": "http://www.openwall.com/lists/oss-security/2011/09/04/1", "source": "secalert@redhat.com", "tags": ["Exploit"]}, {"url": "http://www.openwall.com/lists/oss-security/2011/09/09/9", "source": "secalert@redhat.com", "tags": ["Exploit"]}, {"url": "http://www.securityfocus.com/archive/1/519547/100/0/threaded", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/bid/49448", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=735514", "source": "secalert@redhat.com", "tags": ["Exploit", "Patch"]}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/69589", "source": "secalert@redhat.com"}, {"url": "https://github.com/mantisbt/mantisbt/commit/0a636b37d3425aea7b781e7f25eaeb164ac54a3d", "source": "secalert@redhat.com", "tags": ["Patch"]}, {"url": "https://www.htbridge.ch/advisory/multiple_vulnerabilities_in_mantisbt.html", "source": "secalert@redhat.com", "tags": ["Exploit"]}]}, "github_commit_url": "https://github.com/mantisbt/mantisbt/commit/0a636b37d3425aea7b781e7f25eaeb164ac54a3d"}}