{"buggy_code": ["<?php\r\ninclude_once('./_common.php');\r\n\r\n//dbconfig\ud30c\uc77c\uc5d0 $g5['faq_table'] , $g5['faq_master_table'] \ubc30\uc5f4\ubcc0\uc218\uac00 \uc788\ub294\uc9c0 \uccb4\ud06c\r\nif( !isset($g5['faq_table']) || !isset($g5['faq_master_table']) ){\r\n    die('<meta charset=\"utf-8\">\uad00\ub9ac\uc790 \ubaa8\ub4dc\uc5d0\uc11c \uac8c\uc2dc\ud310\uad00\ub9ac->FAQ\uad00\ub9ac\ub97c \uba3c\uc800 \ud655\uc778\ud574 \uc8fc\uc138\uc694.');\r\n}\r\n\r\n// FAQ MASTER\r\n$faq_master_list = array();\r\n$sql = \" select * from {$g5['faq_master_table']} order by fm_order,fm_id \";\r\n$result = sql_query($sql);\r\nwhile ($row=sql_fetch_array($result))\r\n{\r\n    $key = $row['fm_id'];\r\n    if (!isset($fm_id)) $fm_id = $key;\r\n    $faq_master_list[$key] = $row;\r\n}\r\n\r\nif (isset($fm_id) && $fm_id){\r\n    $qstr .= '&amp;fm_id=' . $fm_id; // \ub9c8\uc2a4\ud130faq key_id\r\n}\r\n\r\n$fm = $faq_master_list[$fm_id];\r\nif (!$fm['fm_id'])\r\n    alert('\ub4f1\ub85d\ub41c \ub0b4\uc6a9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.');\r\n\r\n$g5['title'] = $fm['fm_subject'];\r\n\r\n$skin_file = $faq_skin_path.'/list.skin.php';\r\n\r\ninclude_once('./_head.php');\r\n\r\nif(is_file($skin_file)) {\r\n    $admin_href = '';\r\n    $himg_src = '';\r\n    $timg_src = '';\r\n    if($is_admin)\r\n        $admin_href = G5_ADMIN_URL.'/faqmasterform.php?w=u&amp;fm_id='.$fm_id;\r\n\r\n    if(!G5_IS_MOBILE) {\r\n        $himg = G5_DATA_PATH.'/faq/'.$fm_id.'_h';\r\n        if (is_file($himg)){\r\n            $himg_src = G5_DATA_URL.'/faq/'.$fm_id.'_h';\r\n        }\r\n\r\n        $timg = G5_DATA_PATH.'/faq/'.$fm_id.'_t';\r\n        if (is_file($timg)){\r\n            $timg_src = G5_DATA_URL.'/faq/'.$fm_id.'_t';\r\n        }\r\n    }\r\n\r\n    $category_href = G5_BBS_URL.'/faq.php';\r\n    $category_stx = '';\r\n    $faq_list = array();\r\n\r\n    $stx = trim($stx);\r\n    $sql_search = '';\r\n\r\n    if($stx) {\r\n       $sql_search = \" and ( INSTR(fa_subject, '$stx') > 0 or INSTR(fa_content, '$stx') > 0 ) \";\r\n    }\r\n\r\n    if ($page < 1) { $page = 1; } // \ud398\uc774\uc9c0\uac00 \uc5c6\uc73c\uba74 \uccab \ud398\uc774\uc9c0 (1 \ud398\uc774\uc9c0)\r\n\r\n    $page_rows = G5_IS_MOBILE ? $config['cf_mobile_page_rows'] : $config['cf_page_rows'];\r\n\r\n    $sql = \" select count(*) as cnt\r\n                from {$g5['faq_table']}\r\n                where fm_id = '$fm_id'\r\n                  $sql_search \";\r\n    $total = sql_fetch($sql);\r\n    $total_count = $total['cnt'];\r\n\r\n    $total_page  = ceil($total_count / $page_rows);  // \uc804\uccb4 \ud398\uc774\uc9c0 \uacc4\uc0b0\r\n    $from_record = ($page - 1) * $page_rows; // \uc2dc\uc791 \uc5f4\uc744 \uad6c\ud568\r\n\r\n    $sql = \" select *\r\n                from {$g5['faq_table']}\r\n                where fm_id = '$fm_id'\r\n                  $sql_search\r\n                order by fa_order , fa_id\r\n                limit $from_record, $page_rows \";\r\n    $result = sql_query($sql);\r\n    for ($i=0;$row=sql_fetch_array($result);$i++){\r\n        $faq_list[] = $row;\r\n        if($stx) {\r\n            $faq_list[$i]['fa_subject'] = search_font($stx, conv_content($faq_list[$i]['fa_subject'], 1));\r\n            $faq_list[$i]['fa_content'] = search_font($stx, conv_content($faq_list[$i]['fa_content'], 1));\r\n        }\r\n    }\r\n    include_once($skin_file);\r\n} else {\r\n    echo '<p>'.str_replace(G5_PATH.'/', '', $skin_file).'\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.</p>';\r\n}\r\n\r\ninclude_once('./_tail.php');"], "fixing_code": ["<?php\r\ninclude_once('./_common.php');\r\n\r\n//dbconfig\ud30c\uc77c\uc5d0 $g5['faq_table'] , $g5['faq_master_table'] \ubc30\uc5f4\ubcc0\uc218\uac00 \uc788\ub294\uc9c0 \uccb4\ud06c\r\nif( !isset($g5['faq_table']) || !isset($g5['faq_master_table']) ){\r\n    die('<meta charset=\"utf-8\">\uad00\ub9ac\uc790 \ubaa8\ub4dc\uc5d0\uc11c \uac8c\uc2dc\ud310\uad00\ub9ac->FAQ\uad00\ub9ac\ub97c \uba3c\uc800 \ud655\uc778\ud574 \uc8fc\uc138\uc694.');\r\n}\r\n\r\n// FAQ MASTER\r\n$faq_master_list = array();\r\n$sql = \" select * from {$g5['faq_master_table']} order by fm_order,fm_id \";\r\n$result = sql_query($sql);\r\nwhile ($row=sql_fetch_array($result))\r\n{\r\n    $key = $row['fm_id'];\r\n    if (!isset($fm_id)) $fm_id = $key;\r\n    $faq_master_list[$key] = $row;\r\n}\r\n\r\nif (isset($fm_id) && $fm_id){\r\n    $fm_id = (int) $fm_id;\r\n    $qstr .= '&amp;fm_id=' . $fm_id; // \ub9c8\uc2a4\ud130faq key_id\r\n}\r\n\r\n$fm = $faq_master_list[$fm_id];\r\nif (!$fm['fm_id'])\r\n    alert('\ub4f1\ub85d\ub41c \ub0b4\uc6a9\uc774 \uc5c6\uc2b5\ub2c8\ub2e4.');\r\n\r\n$g5['title'] = $fm['fm_subject'];\r\n\r\n$skin_file = $faq_skin_path.'/list.skin.php';\r\n\r\ninclude_once('./_head.php');\r\n\r\nif(is_file($skin_file)) {\r\n    $admin_href = '';\r\n    $himg_src = '';\r\n    $timg_src = '';\r\n    if($is_admin)\r\n        $admin_href = G5_ADMIN_URL.'/faqmasterform.php?w=u&amp;fm_id='.$fm_id;\r\n\r\n    if(!G5_IS_MOBILE) {\r\n        $himg = G5_DATA_PATH.'/faq/'.$fm_id.'_h';\r\n        if (is_file($himg)){\r\n            $himg_src = G5_DATA_URL.'/faq/'.$fm_id.'_h';\r\n        }\r\n\r\n        $timg = G5_DATA_PATH.'/faq/'.$fm_id.'_t';\r\n        if (is_file($timg)){\r\n            $timg_src = G5_DATA_URL.'/faq/'.$fm_id.'_t';\r\n        }\r\n    }\r\n\r\n    $category_href = G5_BBS_URL.'/faq.php';\r\n    $category_stx = '';\r\n    $faq_list = array();\r\n\r\n    $stx = trim($stx);\r\n    $sql_search = '';\r\n\r\n    if($stx) {\r\n       $sql_search = \" and ( INSTR(fa_subject, '$stx') > 0 or INSTR(fa_content, '$stx') > 0 ) \";\r\n    }\r\n\r\n    if ($page < 1) { $page = 1; } // \ud398\uc774\uc9c0\uac00 \uc5c6\uc73c\uba74 \uccab \ud398\uc774\uc9c0 (1 \ud398\uc774\uc9c0)\r\n\r\n    $page_rows = G5_IS_MOBILE ? $config['cf_mobile_page_rows'] : $config['cf_page_rows'];\r\n\r\n    $sql = \" select count(*) as cnt\r\n                from {$g5['faq_table']}\r\n                where fm_id = '$fm_id'\r\n                  $sql_search \";\r\n    $total = sql_fetch($sql);\r\n    $total_count = $total['cnt'];\r\n\r\n    $total_page  = ceil($total_count / $page_rows);  // \uc804\uccb4 \ud398\uc774\uc9c0 \uacc4\uc0b0\r\n    $from_record = ($page - 1) * $page_rows; // \uc2dc\uc791 \uc5f4\uc744 \uad6c\ud568\r\n\r\n    $sql = \" select *\r\n                from {$g5['faq_table']}\r\n                where fm_id = '$fm_id'\r\n                  $sql_search\r\n                order by fa_order , fa_id\r\n                limit $from_record, $page_rows \";\r\n    $result = sql_query($sql);\r\n    for ($i=0;$row=sql_fetch_array($result);$i++){\r\n        $faq_list[] = $row;\r\n        if($stx) {\r\n            $faq_list[$i]['fa_subject'] = search_font($stx, conv_content($faq_list[$i]['fa_subject'], 1));\r\n            $faq_list[$i]['fa_content'] = search_font($stx, conv_content($faq_list[$i]['fa_content'], 1));\r\n        }\r\n    }\r\n    include_once($skin_file);\r\n} else {\r\n    echo '<p>'.str_replace(G5_PATH.'/', '', $skin_file).'\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.</p>';\r\n}\r\n\r\ninclude_once('./_tail.php');"], "filenames": ["bbs/faq.php"], "buggy_code_start_loc": [20], "buggy_code_end_loc": [20], "fixing_code_start_loc": [21], "fixing_code_end_loc": [22], "type": "CWE-79", "message": "A vulnerability was found in gnuboard5. It has been classified as problematic. Affected is an unknown function of the file bbs/faq.php of the component FAQ Key ID Handler. The manipulation of the argument fm_id leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 5.5.8.2.1 is able to address this issue. The name of the patch is ba062ca5b62809106d5a2f7df942ffcb44ecb5a9. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-213540.", "other": {"cve": {"id": "CVE-2022-3963", "sourceIdentifier": "cna@vuldb.com", "published": "2022-11-12T22:15:09.373", "lastModified": "2022-11-17T17:31:23.477", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in gnuboard5. It has been classified as problematic. Affected is an unknown function of the file bbs/faq.php of the component FAQ Key ID Handler. The manipulation of the argument fm_id leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 5.5.8.2.1 is able to address this issue. The name of the patch is ba062ca5b62809106d5a2f7df942ffcb44ecb5a9. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-213540."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-707"}, {"lang": "en", "value": "CWE-74"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:gnuboard:gnuboard5:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.5.8.2.1", "matchCriteriaId": "436FB1E5-1251-4973-ABFC-08A68AB29009"}]}]}], "references": [{"url": "https://github.com/gnuboard/gnuboard5/commit/ba062ca5b62809106d5a2f7df942ffcb44ecb5a9", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.213540", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/gnuboard/gnuboard5/commit/ba062ca5b62809106d5a2f7df942ffcb44ecb5a9"}}