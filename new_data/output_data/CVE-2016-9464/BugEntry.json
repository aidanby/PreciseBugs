{"buggy_code": ["Feature: sharing\n  Background:\n    Given using api version \"1\"\n    Given using dav path \"remote.php/webdav\"\n\n  Scenario: Creating a new share with user\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And As an \"user0\"\n    When sending \"POST\" to \"/apps/files_sharing/api/v1/shares\" with\n      | path | welcome.txt |\n      | shareWith | user1 |\n      | shareType | 0 |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n\n  Scenario: Creating a share with a group\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And group \"sharing-group\" exists\n    And As an \"user0\"\n    When sending \"POST\" to \"/apps/files_sharing/api/v1/shares\" with\n      | path | welcome.txt |\n      | shareWith | sharing-group |\n      | shareType | 1 |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n\n  Scenario: Creating a new share with user who already received a share through their group\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And group \"sharing-group\" exists\n    And user \"user1\" belongs to group \"sharing-group\"\n    And file \"welcome.txt\" of user \"user0\" is shared with group \"sharing-group\"\n    And As an \"user0\"\n    Then sending \"POST\" to \"/apps/files_sharing/api/v1/shares\" with\n      | path | welcome.txt |\n      | shareWith | user1 |\n      | shareType | 0 |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n\n  Scenario: Creating a new public share\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | welcome.txt |\n      | shareType | 3 |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Public shared file \"welcome.txt\" can be downloaded\n\n  Scenario: Creating a new public share with password\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | welcome.txt |\n      | shareType | 3 |\n      | password | publicpw |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Public shared file \"welcome.txt\" with password \"publicpw\" can be downloaded\n\n  Scenario: Creating a new public share of a folder\n   Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | FOLDER |\n      | shareType | 3 |\n      | password | publicpw |\n      | expireDate | +3 days |\n      | publicUpload | true |\n      | permissions | 7 |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | permissions | 7 |\n      | expiration | +3 days |\n      | url | AN_URL |\n      | token | A_TOKEN |\n      | mimetype | httpd/unix-directory |\n\n  Scenario: Creating a new public share with password and adding an expiration date\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | welcome.txt |\n      | shareType | 3 |\n      | password | publicpw |\n    And Updating last share with\n      | expireDate | +3 days |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Public shared file \"welcome.txt\" with password \"publicpw\" can be downloaded\n\n  Scenario: Creating a new public share, updating its expiration date and getting its info\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | FOLDER |\n      | shareType | 3 |\n    And Updating last share with\n      | expireDate | +3 days |\n    And Getting info of last share \n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | item_type | folder |\n      | item_source | A_NUMBER |\n      | share_type | 3 |\n      | file_source | A_NUMBER |\n      | file_target | /FOLDER |\n      | permissions | 1 |\n      | stime | A_NUMBER |\n      | expiration | +3 days |\n      | token | A_TOKEN |\n      | storage | A_NUMBER |\n      | mail_send | 0 |\n      | uid_owner | user0 |\n      | storage_id | home::user0 |\n      | file_parent | A_NUMBER |\n      | displayname_owner | user0 |\n      | url | AN_URL |\n      | mimetype | httpd/unix-directory |\n\n  Scenario: Creating a new public share, updating its password and getting its info\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | FOLDER |\n      | shareType | 3 |\n    And Updating last share with \n      | password | publicpw |\n    And Getting info of last share \n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | item_type | folder |\n      | item_source | A_NUMBER |\n      | share_type | 3 |\n      | file_source | A_NUMBER |\n      | file_target | /FOLDER |\n      | permissions | 1 |\n      | stime | A_NUMBER |\n      | token | A_TOKEN |\n      | storage | A_NUMBER |\n      | mail_send | 0 |\n      | uid_owner | user0 |\n      | storage_id | home::user0 |\n      | file_parent | A_NUMBER |\n      | displayname_owner | user0 |\n      | url | AN_URL |\n      | mimetype | httpd/unix-directory |\n\n  Scenario: Creating a new public share, updating its permissions and getting its info\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | FOLDER |\n      | shareType | 3 |\n    And Updating last share with\n      | permissions | 7 |\n    And Getting info of last share \n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | item_type | folder |\n      | item_source | A_NUMBER |\n      | share_type | 3 |\n      | file_source | A_NUMBER |\n      | file_target | /FOLDER |\n      | permissions | 7 |\n      | stime | A_NUMBER |\n      | token | A_TOKEN |\n      | storage | A_NUMBER |\n      | mail_send | 0 |\n      | uid_owner | user0 |\n      | storage_id | home::user0 |\n      | file_parent | A_NUMBER |\n      | displayname_owner | user0 |\n      | url | AN_URL |\n      | mimetype | httpd/unix-directory |\n\n  Scenario: Creating a new public share, updating publicUpload option and getting its info\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | FOLDER |\n      | shareType | 3 |\n    And Updating last share with\n      | publicUpload | true |\n    And Getting info of last share \n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | item_type | folder |\n      | item_source | A_NUMBER |\n      | share_type | 3 |\n      | file_source | A_NUMBER |\n      | file_target | /FOLDER |\n      | permissions | 7 |\n      | stime | A_NUMBER |\n      | token | A_TOKEN |\n      | storage | A_NUMBER |\n      | mail_send | 0 |\n      | uid_owner | user0 |\n      | storage_id | home::user0 |\n      | file_parent | A_NUMBER |\n      | displayname_owner | user0 |\n      | url | AN_URL |\n      | mimetype | httpd/unix-directory |\n\n  Scenario: getting all shares of a user using that user\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user0\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And File \"textfile0 (2).txt\" should be included in the response\n\n  Scenario: getting all shares of a user using another user\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"admin\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And File \"textfile0.txt\" should not be included in the response\n\n  Scenario: getting all shares of a file\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And user \"user3\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user2\"\n    And As an \"user0\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?path=textfile0.txt\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And User \"user1\" should be included in the response\n    And User \"user2\" should be included in the response\n    And User \"user3\" should not be included in the response\n\n  Scenario: getting all shares of a file with reshares\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And user \"user3\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And file \"textfile0 (2).txt\" of user \"user1\" is shared with user \"user2\"\n    And As an \"user0\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?reshares=true&path=textfile0.txt\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And User \"user1\" should be included in the response\n    And User \"user2\" should be included in the response\n    And User \"user3\" should not be included in the response\n\n  Scenario: getting share info of a share\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user0\"\n    When Getting info of last share\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | item_type | file |\n      | item_source | A_NUMBER |\n      | share_type | 0 |\n      | share_with | user1 |\n      | file_source | A_NUMBER |\n      | file_target | /textfile0 (2).txt |\n      | path | /textfile0.txt |\n      | permissions | 19 |\n      | stime | A_NUMBER |\n      | storage | A_NUMBER |\n      | mail_send | 0 |\n      | uid_owner | user0 |\n      | storage_id | home::user0 |\n      | file_parent | A_NUMBER |\n      | share_with_displayname | user1 |\n      | displayname_owner | user0 |\n      | mimetype          | text/plain |\n\n  Scenario: keep group permissions in sync\n    Given As an \"admin\"\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And group \"group1\" exists\n    And user \"user1\" belongs to group \"group1\"\n    And file \"textfile0.txt\" of user \"user0\" is shared with group \"group1\"\n    And User \"user1\" moved file \"/textfile0.txt\" to \"/FOLDER/textfile0.txt\"\n    And As an \"user0\"\n    When Updating last share with\n      | permissions | 1 |\n    And Getting info of last share\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | item_type | file |\n      | item_source | A_NUMBER |\n      | share_type | 1 |\n      | file_source | A_NUMBER |\n      | file_target | /textfile0.txt |\n      | permissions | 1 |\n      | stime | A_NUMBER |\n      | storage | A_NUMBER |\n      | mail_send | 0 |\n      | uid_owner | user0 |\n      | storage_id | home::user0 |\n      | file_parent | A_NUMBER |\n      | displayname_owner | user0 |\n      | mimetype          | text/plain |\n\n  Scenario: Sharee can see the share\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user1\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?shared_with_me=true\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And last share_id is included in the answer\n\n  Scenario: Sharee can see the filtered share\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And file \"textfile1.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user1\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?shared_with_me=true&path=textfile1 (2).txt\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And last share_id is included in the answer\n\n  Scenario: Sharee can't see the share that is filtered out\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And file \"textfile1.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user1\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?shared_with_me=true&path=textfile0 (2).txt\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And last share_id is not included in the answer\n\n  Scenario: Sharee can see the group share\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And group \"group0\" exists\n    And user \"user1\" belongs to group \"group0\"\n    And file \"textfile0.txt\" of user \"user0\" is shared with group \"group0\"\n    And As an \"user1\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?shared_with_me=true\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And last share_id is included in the answer\n\n  Scenario: User is not allowed to reshare file\n    As an \"admin\"\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And As an \"user0\"\n    And creating a share with\n      | path | /textfile0.txt |\n      | shareType | 0 |\n      | shareWith | user1 |\n      | permissions | 8 |\n    And As an \"user1\"\n    When creating a share with\n      | path | /textfile0 (2).txt |\n      | shareType | 0 |\n      | shareWith | user2 |\n      | permissions | 31 |\n    Then the OCS status code should be \"404\"\n    And the HTTP status code should be \"200\"\n\n  Scenario: User is not allowed to reshare file with more permissions\n    As an \"admin\"\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And As an \"user0\"\n    And creating a share with\n      | path | /textfile0.txt |\n      | shareType | 0 |\n      | shareWith | user1 |\n      | permissions | 16 |\n    And As an \"user1\"\n    When creating a share with\n      | path | /textfile0 (2).txt |\n      | shareType | 0 |\n      | shareWith | user2 |\n      | permissions | 31 |\n    Then the OCS status code should be \"404\"\n    And the HTTP status code should be \"200\"\n\n  Scenario: Get a share with a user which didn't received the share \n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user2\"\n    When Getting info of last share \n    Then the OCS status code should be \"404\" \n    And the HTTP status code should be \"200\"\n\n  Scenario: Share of folder and sub-folder to same user - core#20645\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And group \"group0\" exists\n    And user \"user1\" belongs to group \"group0\"\n    And file \"/PARENT\" of user \"user0\" is shared with user \"user1\"\n    When file \"/PARENT/CHILD\" of user \"user0\" is shared with group \"group0\"\n    Then user \"user1\" should see following elements\n      | /FOLDER/ |\n      | /PARENT/ |\n      | /CHILD/ |\n      | /PARENT/parent.txt |\n      | /CHILD/child.txt |\n    And the HTTP status code should be \"200\"\n\n  Scenario: Share a file by multiple channels \n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And group \"group0\" exists\n    And user \"user1\" belongs to group \"group0\"\n    And user \"user2\" belongs to group \"group0\"\n    And user \"user0\" created a folder \"/common\"\n    And user \"user0\" created a folder \"/common/sub\"\n    And file \"common\" of user \"user0\" is shared with group \"group0\"\n    And file \"textfile0.txt\" of user \"user1\" is shared with user \"user2\"\n    And User \"user1\" moved file \"/textfile0.txt\" to \"/common/textfile0.txt\"\n    And User \"user1\" moved file \"/common/textfile0.txt\" to \"/common/sub/textfile0.txt\"\n    And As an \"user2\"\n    When Downloading file \"/common/sub/textfile0.txt\" with range \"bytes=9-17\"\n    Then Downloaded content should be \"test text\"\n    And Downloaded content when downloading file \"/textfile0.txt\" with range \"bytes=9-17\" should be \"test text\"\n    And user \"user2\" should see following elements\n      | /common/sub/textfile0.txt |\n\n  Scenario: Share a file by multiple channels\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And group \"group0\" exists\n    And user \"user1\" belongs to group \"group0\"\n    And user \"user2\" belongs to group \"group0\"\n    And user \"user0\" created a folder \"/common\"\n    And user \"user0\" created a folder \"/common/sub\"\n    And file \"common\" of user \"user0\" is shared with group \"group0\"\n    And file \"textfile0.txt\" of user \"user1\" is shared with user \"user2\"\n    And User \"user1\" moved file \"/textfile0.txt\" to \"/common/textfile0.txt\"\n    And User \"user1\" moved file \"/common/textfile0.txt\" to \"/common/sub/textfile0.txt\"\n    And As an \"user2\"\n    When Downloading file \"/textfile0.txt\" with range \"bytes=9-17\"\n    Then Downloaded content should be \"test text\"\n    And user \"user2\" should see following elements\n      | /common/sub/textfile0.txt |\n\n  Scenario: Delete all group shares\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And group \"group1\" exists\n    And user \"user1\" belongs to group \"group1\"\n    And file \"textfile0.txt\" of user \"user0\" is shared with group \"group1\"\n    And User \"user1\" moved file \"/textfile0.txt\" to \"/FOLDER/textfile0.txt\"\n    And As an \"user0\"\n    And Deleting last share\n    And As an \"user1\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?shared_with_me=true\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And last share_id is not included in the answer\n\n  Scenario: delete a share\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user0\"\n    When Deleting last share\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n\n  Scenario: Keep usergroup shares (#22143)\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And group \"group\" exists\n    And user \"user1\" belongs to group \"group\"\n    And user \"user2\" belongs to group \"group\"\n    And user \"user0\" created a folder \"/TMP\"\n    And file \"TMP\" of user \"user0\" is shared with group \"group\"\n    And user \"user1\" created a folder \"/myFOLDER\"\n    And User \"user1\" moves file \"/TMP\" to \"/myFOLDER/myTMP\"\n    And user \"user2\" does not exist\n    And user \"user1\" should see following elements\n      | /myFOLDER/myTMP/ |\n\n  Scenario: Check quota of owners parent directory of a shared file\n    Given using dav path \"remote.php/webdav\"\n    And As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user1\" has a quota of \"0\"\n    And User \"user0\" moved file \"/welcome.txt\" to \"/myfile.txt\"\n    And file \"myfile.txt\" of user \"user0\" is shared with user \"user1\"\n    When User \"user1\" uploads file \"data/textfile.txt\" to \"/myfile.txt\"\n    Then the HTTP status code should be \"204\"\n\n  Scenario: Don't allow sharing of the root\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | / |\n      | shareType | 3 |\n    Then the OCS status code should be \"403\"\n\n  Scenario: Allow modification of reshare\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And user \"user0\" created a folder \"/TMP\"\n    And file \"TMP\" of user \"user0\" is shared with user \"user1\"\n    And file \"TMP\" of user \"user1\" is shared with user \"user2\"\n    And As an \"user1\"\n    When Updating last share with\n      | permissions | 1 |\n    Then the OCS status code should be \"100\"\n\n  Scenario: Do not allow reshare to exceed permissions\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And user \"user0\" created a folder \"/TMP\"\n    And As an \"user0\"\n    And creating a share with\n      | path | /TMP |\n      | shareType | 0 |\n      | shareWith | user1 |\n      | permissions | 21 |\n    And As an \"user1\"\n    And creating a share with\n      | path | /TMP |\n      | shareType | 0 |\n      | shareWith | user2 |\n      | permissions | 21 |\n    When Updating last share with\n      | permissions | 31 |\n    Then the OCS status code should be \"404\"\n\n  Scenario: Only allow 1 link share per file/folder\n    Given user \"user0\" exists\n    And As an \"user0\"\n    And creating a share with\n      | path | welcome.txt |\n      | shareType | 3 |\n    When save last share id\n    And creating a share with\n      | path | welcome.txt |\n      | shareType | 3      |\n    Then share ids should match\n\n  Scenario: unique target names for incomming shares\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And user \"user0\" created a folder \"/foo\"\n    And user \"user1\" created a folder \"/foo\"\n    When file \"/foo\" of user \"user0\" is shared with user \"user2\"\n    And file \"/foo\" of user \"user1\" is shared with user \"user2\"\n    Then user \"user2\" should see following elements\n      | /foo/       |\n      | /foo%20(2)/ |\n\n"], "fixing_code": ["Feature: sharing\n  Background:\n    Given using api version \"1\"\n    Given using dav path \"remote.php/webdav\"\n\n  Scenario: Creating a new share with user\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And As an \"user0\"\n    When sending \"POST\" to \"/apps/files_sharing/api/v1/shares\" with\n      | path | welcome.txt |\n      | shareWith | user1 |\n      | shareType | 0 |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n\n  Scenario: Creating a share with a group\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And group \"sharing-group\" exists\n    And As an \"user0\"\n    When sending \"POST\" to \"/apps/files_sharing/api/v1/shares\" with\n      | path | welcome.txt |\n      | shareWith | sharing-group |\n      | shareType | 1 |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n\n  Scenario: Creating a new share with user who already received a share through their group\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And group \"sharing-group\" exists\n    And user \"user1\" belongs to group \"sharing-group\"\n    And file \"welcome.txt\" of user \"user0\" is shared with group \"sharing-group\"\n    And As an \"user0\"\n    Then sending \"POST\" to \"/apps/files_sharing/api/v1/shares\" with\n      | path | welcome.txt |\n      | shareWith | user1 |\n      | shareType | 0 |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n\n  Scenario: Creating a new public share\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | welcome.txt |\n      | shareType | 3 |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Public shared file \"welcome.txt\" can be downloaded\n\n  Scenario: Creating a new public share with password\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | welcome.txt |\n      | shareType | 3 |\n      | password | publicpw |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Public shared file \"welcome.txt\" with password \"publicpw\" can be downloaded\n\n  Scenario: Creating a new public share of a folder\n   Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | FOLDER |\n      | shareType | 3 |\n      | password | publicpw |\n      | expireDate | +3 days |\n      | publicUpload | true |\n      | permissions | 7 |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | permissions | 7 |\n      | expiration | +3 days |\n      | url | AN_URL |\n      | token | A_TOKEN |\n      | mimetype | httpd/unix-directory |\n\n  Scenario: Creating a new public share with password and adding an expiration date\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | welcome.txt |\n      | shareType | 3 |\n      | password | publicpw |\n    And Updating last share with\n      | expireDate | +3 days |\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Public shared file \"welcome.txt\" with password \"publicpw\" can be downloaded\n\n  Scenario: Creating a new public share, updating its expiration date and getting its info\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | FOLDER |\n      | shareType | 3 |\n    And Updating last share with\n      | expireDate | +3 days |\n    And Getting info of last share \n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | item_type | folder |\n      | item_source | A_NUMBER |\n      | share_type | 3 |\n      | file_source | A_NUMBER |\n      | file_target | /FOLDER |\n      | permissions | 1 |\n      | stime | A_NUMBER |\n      | expiration | +3 days |\n      | token | A_TOKEN |\n      | storage | A_NUMBER |\n      | mail_send | 0 |\n      | uid_owner | user0 |\n      | storage_id | home::user0 |\n      | file_parent | A_NUMBER |\n      | displayname_owner | user0 |\n      | url | AN_URL |\n      | mimetype | httpd/unix-directory |\n\n  Scenario: Creating a new public share, updating its password and getting its info\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | FOLDER |\n      | shareType | 3 |\n    And Updating last share with \n      | password | publicpw |\n    And Getting info of last share \n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | item_type | folder |\n      | item_source | A_NUMBER |\n      | share_type | 3 |\n      | file_source | A_NUMBER |\n      | file_target | /FOLDER |\n      | permissions | 1 |\n      | stime | A_NUMBER |\n      | token | A_TOKEN |\n      | storage | A_NUMBER |\n      | mail_send | 0 |\n      | uid_owner | user0 |\n      | storage_id | home::user0 |\n      | file_parent | A_NUMBER |\n      | displayname_owner | user0 |\n      | url | AN_URL |\n      | mimetype | httpd/unix-directory |\n\n  Scenario: Creating a new public share, updating its permissions and getting its info\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | FOLDER |\n      | shareType | 3 |\n    And Updating last share with\n      | permissions | 7 |\n    And Getting info of last share \n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | item_type | folder |\n      | item_source | A_NUMBER |\n      | share_type | 3 |\n      | file_source | A_NUMBER |\n      | file_target | /FOLDER |\n      | permissions | 7 |\n      | stime | A_NUMBER |\n      | token | A_TOKEN |\n      | storage | A_NUMBER |\n      | mail_send | 0 |\n      | uid_owner | user0 |\n      | storage_id | home::user0 |\n      | file_parent | A_NUMBER |\n      | displayname_owner | user0 |\n      | url | AN_URL |\n      | mimetype | httpd/unix-directory |\n\n  Scenario: Creating a new public share, updating publicUpload option and getting its info\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | FOLDER |\n      | shareType | 3 |\n    And Updating last share with\n      | publicUpload | true |\n    And Getting info of last share \n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | item_type | folder |\n      | item_source | A_NUMBER |\n      | share_type | 3 |\n      | file_source | A_NUMBER |\n      | file_target | /FOLDER |\n      | permissions | 7 |\n      | stime | A_NUMBER |\n      | token | A_TOKEN |\n      | storage | A_NUMBER |\n      | mail_send | 0 |\n      | uid_owner | user0 |\n      | storage_id | home::user0 |\n      | file_parent | A_NUMBER |\n      | displayname_owner | user0 |\n      | url | AN_URL |\n      | mimetype | httpd/unix-directory |\n\n  Scenario: getting all shares of a user using that user\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user0\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And File \"textfile0 (2).txt\" should be included in the response\n\n  Scenario: getting all shares of a user using another user\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"admin\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And File \"textfile0.txt\" should not be included in the response\n\n  Scenario: getting all shares of a file\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And user \"user3\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user2\"\n    And As an \"user0\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?path=textfile0.txt\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And User \"user1\" should be included in the response\n    And User \"user2\" should be included in the response\n    And User \"user3\" should not be included in the response\n\n  Scenario: getting all shares of a file with reshares\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And user \"user3\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And file \"textfile0 (2).txt\" of user \"user1\" is shared with user \"user2\"\n    And As an \"user0\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?reshares=true&path=textfile0.txt\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And User \"user1\" should be included in the response\n    And User \"user2\" should be included in the response\n    And User \"user3\" should not be included in the response\n\n  Scenario: getting share info of a share\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user0\"\n    When Getting info of last share\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | item_type | file |\n      | item_source | A_NUMBER |\n      | share_type | 0 |\n      | share_with | user1 |\n      | file_source | A_NUMBER |\n      | file_target | /textfile0 (2).txt |\n      | path | /textfile0.txt |\n      | permissions | 19 |\n      | stime | A_NUMBER |\n      | storage | A_NUMBER |\n      | mail_send | 0 |\n      | uid_owner | user0 |\n      | storage_id | home::user0 |\n      | file_parent | A_NUMBER |\n      | share_with_displayname | user1 |\n      | displayname_owner | user0 |\n      | mimetype          | text/plain |\n\n  Scenario: keep group permissions in sync\n    Given As an \"admin\"\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And group \"group1\" exists\n    And user \"user1\" belongs to group \"group1\"\n    And file \"textfile0.txt\" of user \"user0\" is shared with group \"group1\"\n    And User \"user1\" moved file \"/textfile0.txt\" to \"/FOLDER/textfile0.txt\"\n    And As an \"user0\"\n    When Updating last share with\n      | permissions | 1 |\n    And Getting info of last share\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And Share fields of last share match with\n      | id | A_NUMBER |\n      | item_type | file |\n      | item_source | A_NUMBER |\n      | share_type | 1 |\n      | file_source | A_NUMBER |\n      | file_target | /textfile0.txt |\n      | permissions | 1 |\n      | stime | A_NUMBER |\n      | storage | A_NUMBER |\n      | mail_send | 0 |\n      | uid_owner | user0 |\n      | storage_id | home::user0 |\n      | file_parent | A_NUMBER |\n      | displayname_owner | user0 |\n      | mimetype          | text/plain |\n\n  Scenario: Sharee can see the share\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user1\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?shared_with_me=true\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And last share_id is included in the answer\n\n  Scenario: Sharee can see the filtered share\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And file \"textfile1.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user1\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?shared_with_me=true&path=textfile1 (2).txt\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And last share_id is included in the answer\n\n  Scenario: Sharee can't see the share that is filtered out\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And file \"textfile1.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user1\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?shared_with_me=true&path=textfile0 (2).txt\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And last share_id is not included in the answer\n\n  Scenario: Sharee can see the group share\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And group \"group0\" exists\n    And user \"user1\" belongs to group \"group0\"\n    And file \"textfile0.txt\" of user \"user0\" is shared with group \"group0\"\n    And As an \"user1\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?shared_with_me=true\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And last share_id is included in the answer\n\n  Scenario: User is not allowed to reshare file\n    As an \"admin\"\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And As an \"user0\"\n    And creating a share with\n      | path | /textfile0.txt |\n      | shareType | 0 |\n      | shareWith | user1 |\n      | permissions | 8 |\n    And As an \"user1\"\n    When creating a share with\n      | path | /textfile0 (2).txt |\n      | shareType | 0 |\n      | shareWith | user2 |\n      | permissions | 31 |\n    Then the OCS status code should be \"404\"\n    And the HTTP status code should be \"200\"\n\n  Scenario: User is not allowed to reshare file with more permissions\n    As an \"admin\"\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And As an \"user0\"\n    And creating a share with\n      | path | /textfile0.txt |\n      | shareType | 0 |\n      | shareWith | user1 |\n      | permissions | 16 |\n    And As an \"user1\"\n    When creating a share with\n      | path | /textfile0 (2).txt |\n      | shareType | 0 |\n      | shareWith | user2 |\n      | permissions | 31 |\n    Then the OCS status code should be \"404\"\n    And the HTTP status code should be \"200\"\n\n  Scenario: Get a share with a user which didn't received the share \n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user2\"\n    When Getting info of last share \n    Then the OCS status code should be \"404\" \n    And the HTTP status code should be \"200\"\n\n  Scenario: Share of folder and sub-folder to same user - core#20645\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And group \"group0\" exists\n    And user \"user1\" belongs to group \"group0\"\n    And file \"/PARENT\" of user \"user0\" is shared with user \"user1\"\n    When file \"/PARENT/CHILD\" of user \"user0\" is shared with group \"group0\"\n    Then user \"user1\" should see following elements\n      | /FOLDER/ |\n      | /PARENT/ |\n      | /CHILD/ |\n      | /PARENT/parent.txt |\n      | /CHILD/child.txt |\n    And the HTTP status code should be \"200\"\n\n  Scenario: Share a file by multiple channels \n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And group \"group0\" exists\n    And user \"user1\" belongs to group \"group0\"\n    And user \"user2\" belongs to group \"group0\"\n    And user \"user0\" created a folder \"/common\"\n    And user \"user0\" created a folder \"/common/sub\"\n    And file \"common\" of user \"user0\" is shared with group \"group0\"\n    And file \"textfile0.txt\" of user \"user1\" is shared with user \"user2\"\n    And User \"user1\" moved file \"/textfile0.txt\" to \"/common/textfile0.txt\"\n    And User \"user1\" moved file \"/common/textfile0.txt\" to \"/common/sub/textfile0.txt\"\n    And As an \"user2\"\n    When Downloading file \"/common/sub/textfile0.txt\" with range \"bytes=9-17\"\n    Then Downloaded content should be \"test text\"\n    And Downloaded content when downloading file \"/textfile0.txt\" with range \"bytes=9-17\" should be \"test text\"\n    And user \"user2\" should see following elements\n      | /common/sub/textfile0.txt |\n\n  Scenario: Share a file by multiple channels\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And group \"group0\" exists\n    And user \"user1\" belongs to group \"group0\"\n    And user \"user2\" belongs to group \"group0\"\n    And user \"user0\" created a folder \"/common\"\n    And user \"user0\" created a folder \"/common/sub\"\n    And file \"common\" of user \"user0\" is shared with group \"group0\"\n    And file \"textfile0.txt\" of user \"user1\" is shared with user \"user2\"\n    And User \"user1\" moved file \"/textfile0.txt\" to \"/common/textfile0.txt\"\n    And User \"user1\" moved file \"/common/textfile0.txt\" to \"/common/sub/textfile0.txt\"\n    And As an \"user2\"\n    When Downloading file \"/textfile0.txt\" with range \"bytes=9-17\"\n    Then Downloaded content should be \"test text\"\n    And user \"user2\" should see following elements\n      | /common/sub/textfile0.txt |\n\n  Scenario: Delete all group shares\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And group \"group1\" exists\n    And user \"user1\" belongs to group \"group1\"\n    And file \"textfile0.txt\" of user \"user0\" is shared with group \"group1\"\n    And User \"user1\" moved file \"/textfile0.txt\" to \"/FOLDER/textfile0.txt\"\n    And As an \"user0\"\n    And Deleting last share\n    And As an \"user1\"\n    When sending \"GET\" to \"/apps/files_sharing/api/v1/shares?shared_with_me=true\"\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n    And last share_id is not included in the answer\n\n  Scenario: delete a share\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And file \"textfile0.txt\" of user \"user0\" is shared with user \"user1\"\n    And As an \"user0\"\n    When Deleting last share\n    Then the OCS status code should be \"100\"\n    And the HTTP status code should be \"200\"\n\n  Scenario: Keep usergroup shares (#22143)\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And group \"group\" exists\n    And user \"user1\" belongs to group \"group\"\n    And user \"user2\" belongs to group \"group\"\n    And user \"user0\" created a folder \"/TMP\"\n    And file \"TMP\" of user \"user0\" is shared with group \"group\"\n    And user \"user1\" created a folder \"/myFOLDER\"\n    And User \"user1\" moves file \"/TMP\" to \"/myFOLDER/myTMP\"\n    And user \"user2\" does not exist\n    And user \"user1\" should see following elements\n      | /myFOLDER/myTMP/ |\n\n  Scenario: Check quota of owners parent directory of a shared file\n    Given using dav path \"remote.php/webdav\"\n    And As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user1\" has a quota of \"0\"\n    And User \"user0\" moved file \"/welcome.txt\" to \"/myfile.txt\"\n    And file \"myfile.txt\" of user \"user0\" is shared with user \"user1\"\n    When User \"user1\" uploads file \"data/textfile.txt\" to \"/myfile.txt\"\n    Then the HTTP status code should be \"204\"\n\n  Scenario: Don't allow sharing of the root\n    Given user \"user0\" exists\n    And As an \"user0\"\n    When creating a share with\n      | path | / |\n      | shareType | 3 |\n    Then the OCS status code should be \"403\"\n\n  Scenario: Allow modification of reshare\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And user \"user0\" created a folder \"/TMP\"\n    And file \"TMP\" of user \"user0\" is shared with user \"user1\"\n    And file \"TMP\" of user \"user1\" is shared with user \"user2\"\n    And As an \"user1\"\n    When Updating last share with\n      | permissions | 1 |\n    Then the OCS status code should be \"100\"\n\n  Scenario: Do not allow reshare to exceed permissions\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And user \"user0\" created a folder \"/TMP\"\n    And As an \"user0\"\n    And creating a share with\n      | path | /TMP |\n      | shareType | 0 |\n      | shareWith | user1 |\n      | permissions | 21 |\n    And As an \"user1\"\n    And creating a share with\n      | path | /TMP |\n      | shareType | 0 |\n      | shareWith | user2 |\n      | permissions | 21 |\n    When Updating last share with\n      | permissions | 31 |\n    Then the OCS status code should be \"404\"\n\n  Scenario: Only allow 1 link share per file/folder\n    Given user \"user0\" exists\n    And As an \"user0\"\n    And creating a share with\n      | path | welcome.txt |\n      | shareType | 3 |\n    When save last share id\n    And creating a share with\n      | path | welcome.txt |\n      | shareType | 3      |\n    Then share ids should match\n\n  Scenario: unique target names for incomming shares\n    Given user \"user0\" exists\n    And user \"user1\" exists\n    And user \"user2\" exists\n    And user \"user0\" created a folder \"/foo\"\n    And user \"user1\" created a folder \"/foo\"\n    When file \"/foo\" of user \"user0\" is shared with user \"user2\"\n    And file \"/foo\" of user \"user1\" is shared with user \"user2\"\n    Then user \"user2\" should see following elements\n      | /foo/       |\n      | /foo%20(2)/ |\n\n  Scenario: Deleting a group share as user\n    Given As an \"admin\"\n    And user \"user0\" exists\n    And user \"user1\" exists\n    And group \"group1\" exists\n    And user \"user1\" belongs to group \"group1\"\n    And As an \"user0\"\n    And creating a share with\n      | path | welcome.txt |\n      | shareType | 1 |\n      | shareWith | group1 |\n    When As an \"user1\"\n    And Deleting last share\n    Then the OCS status code should be \"404\"\n    And the HTTP status code should be \"200\"\n"], "filenames": ["build/integration/features/sharing-v1.feature"], "buggy_code_start_loc": [596], "buggy_code_end_loc": [596], "fixing_code_start_loc": [597], "fixing_code_end_loc": [612], "type": "CWE-285", "message": "Nextcloud Server before 9.0.54 and 10.0.0 suffers from an improper authorization check on removing shares. The Sharing Backend as implemented in Nextcloud does differentiate between shares to users and groups. In case of a received group share, users should be able to unshare the file to themselves but not to the whole group. The previous API implementation simply unshared the file to all users in the group.", "other": {"cve": {"id": "CVE-2016-9464", "sourceIdentifier": "support@hackerone.com", "published": "2017-03-28T02:59:00.997", "lastModified": "2019-10-09T23:20:29.133", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "Nextcloud Server before 9.0.54 and 10.0.0 suffers from an improper authorization check on removing shares. The Sharing Backend as implemented in Nextcloud does differentiate between shares to users and groups. In case of a received group share, users should be able to unshare the file to themselves but not to the whole group. The previous API implementation simply unshared the file to all users in the group."}, {"lang": "es", "value": "Nextcloud Server en versiones anteriores a 9.0.54 y 10.0.0 sufre de una verificaci\u00f3n de autorizaci\u00f3n incorrecta de los recursos eliminados. El Sharing Backend tal como se implemento en Nextcloud diferencia los compartidos entre usuarios y grupos. En caso de una couta de grupo recibida, los usuarios deben ser capaces de no compartir los archivos con ellos mismos pero no a todo el grupo. La implementaci\u00f3n anterior de la API simplemente no comparti\u00f3 el archivo a todos los uusarios en el grupo."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-285"}]}, {"source": "support@hackerone.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-285"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:*:*:*:*", "versionEndExcluding": "9.0.54", "matchCriteriaId": "D6E3F368-B854-430E-AB8F-496675C4E210"}, {"vulnerable": true, "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:10.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "A11A2099-3AEC-4622-9ADE-085740EE67C7"}]}]}], "references": [{"url": "http://www.securityfocus.com/bid/97287", "source": "support@hackerone.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://github.com/nextcloud/server/commit/3387e5d00fcf6b2ea6b285a091e5743f545e7202", "source": "support@hackerone.com", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/nextcloud/server/commit/7289cb5ec0b812992ab0dfb889744b94bc0994f0", "source": "support@hackerone.com", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/nextcloud/server/commit/a5471b4a3e3f30e99e4de39c97c0c3b3c2f1618f", "source": "support@hackerone.com", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/nextcloud/server/commit/e2c4f4f9aa11bc92e8f2212cce73841b922187e8", "source": "support@hackerone.com", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://hackerone.com/reports/153905", "source": "support@hackerone.com", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://nextcloud.com/security/advisory/?id=nc-sa-2016-007", "source": "support@hackerone.com", "tags": ["Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/nextcloud/server/commit/3387e5d00fcf6b2ea6b285a091e5743f545e7202"}}