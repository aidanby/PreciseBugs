{"buggy_code": ["# Changelog\n\n## v0.30 - *dresser*\n\nRequires libvips v8.12.2\n\n### v0.30.5 - TBD\n\n* Allow installation of prebuilt libvips binaries from filesystem.\n  [#3196](https://github.com/lovell/sharp/pull/3196)\n  [@ankurparihar](https://github.com/ankurparihar)\n\n* Fix rotate-then-extract for EXIF orientation 2.\n  [#3218](https://github.com/lovell/sharp/pull/3218)\n  [@jakob0fischl](https://github.com/jakob0fischl)\n\n### v0.30.4 - 18th April 2022\n\n* Increase control over sensitivity to invalid images via `failOn`, deprecate `failOnError` (equivalent to `failOn: 'warning'`).\n\n* Ensure `create` input image has correct bit depth and colour space.\n  [#3139](https://github.com/lovell/sharp/issues/3139)\n\n* Add support for `TypedArray` input with `byteOffset` and `length`.\n  [#3146](https://github.com/lovell/sharp/pull/3146)\n  [@codepage949](https://github.com/codepage949)\n\n* Improve error message when attempting to render SVG input greater than 32767x32767.\n  [#3167](https://github.com/lovell/sharp/issues/3167)\n\n* Add missing file name to 'Input file is missing' error message.\n  [#3178](https://github.com/lovell/sharp/pull/3178)\n  [@Brodan](https://github.com/Brodan)\n\n### v0.30.3 - 14th March 2022\n\n* Allow `sharpen` options to be provided more consistently as an Object.\n  [#2561](https://github.com/lovell/sharp/issues/2561)\n\n* Expose `x1`, `y2` and `y3` parameters of `sharpen` operation.\n  [#2935](https://github.com/lovell/sharp/issues/2935)\n\n* Prevent double unpremultiply with some composite blend modes (regression in 0.30.2).\n  [#3118](https://github.com/lovell/sharp/issues/3118)\n\n### v0.30.2 - 2nd March 2022\n\n* Improve performance and accuracy when compositing multiple images.\n  [#2286](https://github.com/lovell/sharp/issues/2286)\n\n* Expand pkgconfig search path for wider BSD support.\n  [#3106](https://github.com/lovell/sharp/issues/3106)\n\n* Ensure Windows C++ runtime is linked statically (regression in 0.30.0).\n  [#3110](https://github.com/lovell/sharp/pull/3110)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Temporarily ignore greyscale ICC profiles to workaround lcms bug.\n  [#3112](https://github.com/lovell/sharp/issues/3112)\n\n### v0.30.1 - 9th February 2022\n\n* Allow use of `toBuffer` and `toFile` on the same instance.\n  [#3044](https://github.com/lovell/sharp/issues/3044)\n\n* Skip shrink-on-load for known libjpeg rounding errors.\n  [#3066](https://github.com/lovell/sharp/issues/3066)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Ensure withoutReduction does not interfere with contain/crop/embed.\n  [#3081](https://github.com/lovell/sharp/pull/3081)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Ensure affine interpolator is correctly finalised.\n  [#3083](https://github.com/lovell/sharp/pull/3083)\n  [@kleisauke](https://github.com/kleisauke)\n\n### v0.30.0 - 1st February 2022\n\n* Add support for GIF output to prebuilt binaries.\n\n* Reduce minimum Linux ARM64v8 glibc requirement to 2.17.\n\n* Verify prebuilt binaries with a Subresource Integrity check.\n\n* Standardise WebP `effort` option name, deprecate `reductionEffort`.\n\n* Standardise HEIF `effort` option name, deprecate `speed`.\n\n* Add support for IIIF v3 tile-based output.\n\n* Expose control over CPU effort for palette-based PNG output.\n  [#2541](https://github.com/lovell/sharp/issues/2541)\n\n* Improve animated (multi-page) image resize and extract.\n  [#2789](https://github.com/lovell/sharp/pull/2789)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Expose platform and architecture of vendored binaries as `sharp.vendor`.\n  [#2928](https://github.com/lovell/sharp/issues/2928)\n\n* Ensure 16-bit PNG output uses correct bitdepth.\n  [#2958](https://github.com/lovell/sharp/pull/2958)\n  [@gforge](https://github.com/gforge)\n\n* Properly emit close events for duplex streams.\n  [#2976](https://github.com/lovell/sharp/pull/2976)\n  [@driannaude](https://github.com/driannaude)\n\n* Expose `unlimited` option for SVG and PNG input, switches off safety features.\n  [#2984](https://github.com/lovell/sharp/issues/2984)\n\n* Add `withoutReduction` option to resize operation.\n  [#3006](https://github.com/lovell/sharp/pull/3006)\n  [@christopherbradleybanks](https://github.com/christopherbradleybanks)\n\n* Add `resolutionUnit` as `tiff` option and expose in metadata.\n  [#3023](https://github.com/lovell/sharp/pull/3023)\n  [@ompal-sisodiya](https://github.com/ompal-sisodiya)\n\n* Ensure rotate-then-extract works with EXIF mirroring.\n  [#3024](https://github.com/lovell/sharp/issues/3024)\n\n## v0.29 - *circle*\n\nRequires libvips v8.11.3\n\n### v0.29.3 - 14th November 2021\n\n* Ensure correct dimensions when containing image resized to 1px.\n  [#2951](https://github.com/lovell/sharp/issues/2951)\n\n* Impute TIFF `xres`/`yres` from `density` provided to `withMetadata`.\n  [#2952](https://github.com/lovell/sharp/pull/2952)\n  [@mbklein](https://github.com/mbklein)\n\n### v0.29.2 - 21st October 2021\n\n* Add `timeout` function to limit processing time.\n\n* Ensure `sharp.versions` is populated from vendored libvips.\n\n* Remove animation properties from single page images.\n  [#2890](https://github.com/lovell/sharp/issues/2890)\n\n* Allow use of 'tif' to select TIFF output.\n  [#2893](https://github.com/lovell/sharp/pull/2893)\n  [@erf](https://github.com/erf)\n\n* Improve error message on Windows for version conflict.\n  [#2918](https://github.com/lovell/sharp/pull/2918)\n  [@dkrnl](https://github.com/dkrnl)\n\n* Throw error rather than exit when invalid binaries detected.\n  [#2931](https://github.com/lovell/sharp/issues/2931)\n\n### v0.29.1 - 7th September 2021\n\n* Add `lightness` option to `modulate` operation.\n  [#2846](https://github.com/lovell/sharp/pull/2846)\n\n* Ensure correct PNG bitdepth is set based on number of colours.\n  [#2855](https://github.com/lovell/sharp/issues/2855)\n\n* Ensure background is always premultiplied when compositing.\n  [#2858](https://github.com/lovell/sharp/issues/2858)\n\n* Ensure images with P3 profiles retain full gamut.\n  [#2862](https://github.com/lovell/sharp/issues/2862)\n\n* Add support for libvips compiled with OpenJPEG.\n  [#2868](https://github.com/lovell/sharp/pull/2868)\n\n* Remove unsupported animation properties from AVIF output.\n  [#2870](https://github.com/lovell/sharp/issues/2870)\n\n* Resolve paths before comparing input/output filenames.\n  [#2878](https://github.com/lovell/sharp/pull/2878)\n  [@rexxars](https://github.com/rexxars)\n\n* Allow use of speed 9 (fastest) for HEIF encoding.\n  [#2879](https://github.com/lovell/sharp/pull/2879)\n  [@rexxars](https://github.com/rexxars)\n\n### v0.29.0 - 17th August 2021\n\n* Drop support for Node.js 10, now requires Node.js >= 12.13.0.\n\n* Add `background` property to PNG and GIF image metadata.\n\n* Add `compression` property to HEIF image metadata.\n  [#2504](https://github.com/lovell/sharp/issues/2504)\n\n* AVIF encoding now defaults to `4:4:4` chroma subsampling.\n  [#2562](https://github.com/lovell/sharp/issues/2562)\n\n* Allow multiple platform-arch binaries in same `node_modules` installation tree.\n  [#2575](https://github.com/lovell/sharp/issues/2575)\n\n* Default to single-channel `b-w` space when `extractChannel` is used.\n  [#2658](https://github.com/lovell/sharp/issues/2658)\n\n* Allow installation directory to contain spaces (regression in v0.26.0).\n  [#2777](https://github.com/lovell/sharp/issues/2777)\n\n* Add `pipelineColourspace` operator to set the processing space.\n  [#2704](https://github.com/lovell/sharp/pull/2704)\n  [@Daiz](https://github.com/Daiz)\n\n* Allow bit depth to be set when using raw input and output.\n  [#2762](https://github.com/lovell/sharp/pull/2762)\n  [@mart-jansink](https://github.com/mart-jansink)\n\n* Allow `negate` to act only on non-alpha channels.\n  [#2808](https://github.com/lovell/sharp/pull/2808)\n  [@rexxars](https://github.com/rexxars)\n\n## v0.28 - *bijou*\n\nRequires libvips v8.10.6\n\n### v0.28.3 - 24th May 2021\n\n* Ensure presence of libvips, vendored or global, before invoking node-gyp.\n\n* Skip shrink-on-load for multi-page WebP.\n  [#2714](https://github.com/lovell/sharp/issues/2714)\n\n* Add contrast limiting adaptive histogram equalization (CLAHE) operator.\n  [#2726](https://github.com/lovell/sharp/pull/2726)\n  [@baparham](https://github.com/baparham)\n\n### v0.28.2 - 10th May 2021\n\n* Allow `withMetadata` to set `density`.\n  [#967](https://github.com/lovell/sharp/issues/967)\n\n* Skip shrink-on-load where one dimension <4px.\n  [#2653](https://github.com/lovell/sharp/issues/2653)\n\n* Allow escaped proxy credentials.\n  [#2664](https://github.com/lovell/sharp/pull/2664)\n  [@msalettes](https://github.com/msalettes)\n\n* Add `premultiplied` flag for raw pixel data input.\n  [#2685](https://github.com/lovell/sharp/pull/2685)\n  [@mnutt](https://github.com/mnutt)\n\n* Detect empty input and throw a helpful error.\n  [#2687](https://github.com/lovell/sharp/pull/2687)\n  [@JakobJingleheimer](https://github.com/JakobJingleheimer)\n\n* Add install-time flag to skip version compatibility checks.\n  [#2692](https://github.com/lovell/sharp/pull/2692)\n  [@xemle](https://github.com/xemle)\n\n### v0.28.1 - 5th April 2021\n\n* Ensure all installation errors are logged with a more obvious prefix.\n\n* Allow `withMetadata` to set and update EXIF metadata.\n  [#650](https://github.com/lovell/sharp/issues/650)\n\n* Add support for OME-TIFF Sub Image File Directories (subIFD).\n  [#2557](https://github.com/lovell/sharp/issues/2557)\n\n* Allow `ensureAlpha` to set the alpha transparency level.\n  [#2634](https://github.com/lovell/sharp/issues/2634)\n\n### v0.28.0 - 29th March 2021\n\n* Prebuilt binaries now include mozjpeg and libimagequant (BSD 2-Clause).\n\n* Prebuilt binaries limit AVIF support to the most common 8-bit depth.\n\n* Add `mozjpeg` option to `jpeg` method, sets mozjpeg defaults.\n\n* Reduce the default PNG `compressionLevel` to the more commonly used 6.\n\n* Reduce concurrency on glibc-based Linux when using the default memory allocator to help prevent fragmentation.\n\n* Default missing edge properties of extend operation to zero.\n  [#2578](https://github.com/lovell/sharp/issues/2578)\n\n* Ensure composite does not clip top and left offsets.\n  [#2594](https://github.com/lovell/sharp/pull/2594)\n  [@SHG42](https://github.com/SHG42)\n\n* Improve error handling of network failure at install time.\n  [#2608](https://github.com/lovell/sharp/pull/2608)\n  [@abradley](https://github.com/abradley)\n\n* Ensure `@id` attribute can be set for IIIF tile-based output.\n  [#2612](https://github.com/lovell/sharp/issues/2612)\n  [@edsilv](https://github.com/edsilv)\n\n* Ensure composite replicates the correct number of tiles for centred gravities.\n  [#2626](https://github.com/lovell/sharp/issues/2626)\n\n## v0.27 - *avif*\n\nRequires libvips v8.10.5\n\n### v0.27.2 - 22nd February 2021\n\n* macOS: Prevent use of globally-installed ARM64 libvips with Rosetta x64 emulation.\n  [#2460](https://github.com/lovell/sharp/issues/2460)\n\n* Linux (musl): Prevent use of prebuilt linuxmusl-x64 binaries with musl >= 1.2.0.\n  [#2570](https://github.com/lovell/sharp/issues/2570)\n\n* Improve 16-bit grey+alpha support by using libvips' `has_alpha` detection.\n  [#2569](https://github.com/lovell/sharp/issues/2569)\n\n* Allow the use of non lower case extensions with `toFormat`.\n  [#2581](https://github.com/lovell/sharp/pull/2581)\n  [@florian-busch](https://github.com/florian-busch)\n\n* Allow use of `recomb` operation with single channel input.\n  [#2584](https://github.com/lovell/sharp/issues/2584)\n\n### v0.27.1 - 27th January 2021\n\n* Ensure TIFF is cast when using float predictor.\n  [#2502](https://github.com/lovell/sharp/pull/2502)\n  [@randyridge](https://github.com/randyridge)\n\n* Add support for Uint8Array and Uint8ClampedArray input.\n  [#2511](https://github.com/lovell/sharp/pull/2511)\n  [@leon](https://github.com/leon)\n\n* Revert: ensure all platforms use fontconfig for font rendering.\n  [#2515](https://github.com/lovell/sharp/issues/2515)\n\n* Expose libvips gaussnoise operation to allow creation of Gaussian noise.\n  [#2527](https://github.com/lovell/sharp/pull/2527)\n  [@alza54](https://github.com/alza54)\n\n### v0.27.0 - 22nd December 2020\n\n* Add support for AVIF to prebuilt binaries.\n\n* Remove experimental status from `heif` output, defaults are now AVIF-centric.\n\n* Allow negative top/left offsets for composite operation.\n  [#2391](https://github.com/lovell/sharp/pull/2391)\n  [@CurosMJ](https://github.com/CurosMJ)\n\n* Ensure all platforms use fontconfig for font rendering.\n  [#2399](https://github.com/lovell/sharp/issues/2399)\n\n## v0.26 - *zoom*\n\nRequires libvips v8.10.0\n\n### v0.26.3 - 16th November 2020\n\n* Expose libvips' affine operation.\n  [#2336](https://github.com/lovell/sharp/pull/2336)\n  [@guillevc](https://github.com/guillevc)\n\n* Fallback to tar.gz for prebuilt libvips when Brotli not available.\n  [#2412](https://github.com/lovell/sharp/pull/2412)\n  [@ascorbic](https://github.com/ascorbic)\n\n### v0.26.2 - 14th October 2020\n\n* Add support for EXR input. Requires libvips compiled with OpenEXR.\n  [#698](https://github.com/lovell/sharp/issues/698)\n\n* Ensure support for yarn v2.\n  [#2379](https://github.com/lovell/sharp/pull/2379)\n  [@jalovatt](https://github.com/jalovatt)\n\n* Add centre/center option to tile-based output.\n  [#2397](https://github.com/lovell/sharp/pull/2397)\n  [@beig](https://github.com/beig)\n\n### v0.26.1 - 20th September 2020\n\n* Ensure correct pageHeight when verifying multi-page image dimensions.\n  [#2343](https://github.com/lovell/sharp/pull/2343)\n  [@derom](https://github.com/derom)\n\n* Allow input density range up to 100000 DPI.\n  [#2348](https://github.com/lovell/sharp/pull/2348)\n  [@stefanprobst](https://github.com/stefanprobst)\n\n* Ensure animation-related properties can be set for Stream-based input.\n  [#2369](https://github.com/lovell/sharp/pull/2369)\n  [@AcrylicShrimp](https://github.com/AcrylicShrimp)\n\n* Ensure `stats` can be calculated for 1x1 input.\n  [#2372](https://github.com/lovell/sharp/issues/2372)\n\n* Ensure animated GIF output is optimised.\n  [#2376](https://github.com/lovell/sharp/issues/2376)\n\n### v0.26.0 - 25th August 2020\n\n* Prebuilt libvips binaries are now statically-linked and Brotli-compressed, requiring Node.js 10.16.0+.\n\n* TIFF output `squash` is replaced by `bitdepth` to reduce to 1, 2 or 4 bit.\n\n* JPEG output `quality` >= 90 no longer automatically sets `chromaSubsampling` to `4:4:4`.\n\n* Add most `dominant` colour to image `stats`.\n  [#640](https://github.com/lovell/sharp/issues/640)\n\n* Add support for animated GIF (requires \\*magick) and WebP output.\n  [#2012](https://github.com/lovell/sharp/pull/2012)\n  [@deftomat](https://github.com/deftomat)\n\n* Add support for libvips ImageMagick v7 loaders.\n  [#2258](https://github.com/lovell/sharp/pull/2258)\n  [@vouillon](https://github.com/vouillon)\n\n* Allow multi-page input via \\*magick.\n  [#2259](https://github.com/lovell/sharp/pull/2259)\n  [@vouillon](https://github.com/vouillon)\n\n* Add support to `withMetadata` for custom ICC profile.\n  [#2271](https://github.com/lovell/sharp/pull/2271)\n  [@roborourke](https://github.com/roborourke)\n\n* Ensure prebuilt binaries for ARM default to v7 when using Electron.\n  [#2292](https://github.com/lovell/sharp/pull/2292)\n  [@diegodev3](https://github.com/diegodev3)\n\n## v0.25 - *yield*\n\nRequires libvips v8.9.1\n\n### v0.25.4 - 12th June 2020\n\n* Allow libvips binary location override where version is appended.\n  [#2217](https://github.com/lovell/sharp/pull/2217)\n  [@malice00](https://github.com/malice00)\n\n* Enable PNG palette when setting quality, colours, colors or dither.\n  [#2226](https://github.com/lovell/sharp/pull/2226)\n  [@romaleev](https://github.com/romaleev)\n\n* Add `level` constructor option to use a specific level of a multi-level image.\n  Expose `levels` metadata for multi-level images.\n  [#2222](https://github.com/lovell/sharp/issues/2222)\n\n* Add support for named `alpha` channel to `extractChannel` operation.\n  [#2138](https://github.com/lovell/sharp/issues/2138)\n\n* Add experimental `sharpness` calculation to `stats()` response.\n  [#2251](https://github.com/lovell/sharp/issues/2251)\n\n* Emit `warning` event for non-critical processing problems.\n  [#2032](https://github.com/lovell/sharp/issues/2032)\n\n### v0.25.3 - 17th May 2020\n\n* Ensure libvips is initialised only once, improves worker thread safety.\n  [#2143](https://github.com/lovell/sharp/issues/2143)\n\n* Ensure npm platform flag is respected when copying DLLs.\n  [#2188](https://github.com/lovell/sharp/pull/2188)\n  [@dimadeveatii](https://github.com/dimadeveatii)\n\n* Allow SVG input with large inline images to be parsed.\n  [#2195](https://github.com/lovell/sharp/issues/2195)\n\n### v0.25.2 - 20th March 2020\n\n* Provide prebuilt binaries for Linux ARM64v8.\n\n* Add IIIF layout support to tile-based output.\n  [#2098](https://github.com/lovell/sharp/pull/2098)\n  [@edsilv](https://github.com/edsilv)\n\n* Ensure input options are consistently and correctly detected.\n  [#2118](https://github.com/lovell/sharp/issues/2118)\n\n* Ensure N-API prebuilt binaries work on RHEL7 and its derivatives.\n  [#2119](https://github.com/lovell/sharp/issues/2119)\n\n* Ensure AsyncWorker options are persisted.\n  [#2130](https://github.com/lovell/sharp/issues/2130)\n\n### v0.25.1 - 7th March 2020\n\n* Ensure prebuilt binaries are fetched based on N-API version.\n  [#2117](https://github.com/lovell/sharp/issues/2117)\n\n### v0.25.0 - 7th March 2020\n\n* Remove `limitInputPixels` and `sequentialRead` previously deprecated in v0.24.0.\n\n* Migrate internals to N-API.\n  [#1282](https://github.com/lovell/sharp/issues/1282)\n\n* Add support for 32-bit Windows.\n  [#2088](https://github.com/lovell/sharp/issues/2088)\n\n* Ensure correct ordering of rotate-then-trim operations.\n  [#2087](https://github.com/lovell/sharp/issues/2087)\n\n* Ensure composite accepts `limitInputPixels` and `sequentialRead` input options.\n  [#2099](https://github.com/lovell/sharp/issues/2099)\n\n## v0.24 - \"*wit*\"\n\nRequires libvips v8.9.0.\n\n### v0.24.1 - 15<sup>th</sup> February 2020\n\n* Prevent use of sequentialRead for EXIF-based rotate operation.\n  [#2042](https://github.com/lovell/sharp/issues/2042)\n\n* Ensure RGBA LZW TIFF returns correct channel count.\n  [#2064](https://github.com/lovell/sharp/issues/2064)\n\n### v0.24.0 - 16<sup>th</sup> January 2020\n\n* Drop support for Node.js 8.\n  [#1910](https://github.com/lovell/sharp/issues/1910)\n\n* Drop support for undefined input where options also provided.\n  [#1768](https://github.com/lovell/sharp/issues/1768)\n\n* Move `limitInputPixels` and `sequentialRead` to input options, deprecating functions of the same name.\n\n* Expose `delay` and `loop` metadata for animated images.\n  [#1905](https://github.com/lovell/sharp/issues/1905)\n\n* Ensure correct colour output for 16-bit, 2-channel PNG input with ICC profile.\n  [#2013](https://github.com/lovell/sharp/issues/2013)\n\n* Prevent use of sequentialRead for rotate operations.\n  [#2016](https://github.com/lovell/sharp/issues/2016)\n\n* Correctly bind max width and height values when using withoutEnlargement.\n  [#2024](https://github.com/lovell/sharp/pull/2024)\n  [@BrychanOdlum](https://github.com/BrychanOdlum)\n\n* Add support for input with 16-bit RGB profile.\n  [#2037](https://github.com/lovell/sharp/issues/2037)\n\n## v0.23 - \"*vision*\"\n\nRequires libvips v8.8.1.\n\n### v0.23.4 - 5<sup>th</sup> December 2019\n\n* Handle zero-length Buffer objects when using Node.js v13.2.0+.\n\n* Expose raw TIFFTAG_PHOTOSHOP metadata.\n  [#1600](https://github.com/lovell/sharp/issues/1600)\n\n* Improve thread safety by using copy-on-write when updating metadata.\n  [#1986](https://github.com/lovell/sharp/issues/1986)\n\n### v0.23.3 - 17<sup>th</sup> November 2019\n\n* Ensure `trim` operation supports images contained in the alpha channel.\n  [#1597](https://github.com/lovell/sharp/issues/1597)\n\n* Ensure tile `overlap` option works as expected.\n  [#1921](https://github.com/lovell/sharp/pull/1921)\n  [@rustyguts](https://github.com/rustyguts)\n\n* Allow compilation on FreeBSD and variants (broken since v0.23.0)\n  [#1952](https://github.com/lovell/sharp/pull/1952)\n  [@pouya-eghbali](https://github.com/pouya-eghbali)\n\n* Ensure `modulate` and other colour-based operations can co-exist.\n  [#1958](https://github.com/lovell/sharp/issues/1958)\n\n### v0.23.2 - 28<sup>th</sup> October 2019\n\n* Add `background` option to tile output operation.\n  [#1924](https://github.com/lovell/sharp/pull/1924)\n  [@neave](https://github.com/neave)\n\n* Add support for Node.js 13.\n  [#1932](https://github.com/lovell/sharp/pull/1932)\n  [@MayhemYDG](https://github.com/MayhemYDG)\n\n### v0.23.1 - 26<sup>th</sup> September 2019\n\n* Ensure `sharp.format.vips` is present and correct (filesystem only).\n  [#1813](https://github.com/lovell/sharp/issues/1813)\n\n* Ensure invalid `width` and `height` provided as options to `resize` throw.\n  [#1817](https://github.com/lovell/sharp/issues/1817)\n\n* Allow use of 'heic' and 'heif' identifiers with `toFormat`.\n  [#1834](https://github.com/lovell/sharp/pull/1834)\n  [@jaubourg](https://github.com/jaubourg)\n\n* Add `premultiplied` option to `composite` operation.\n  [#1835](https://github.com/lovell/sharp/pull/1835)\n  [@Andargor](https://github.com/Andargor)\n\n* Allow instance reuse with differing `toBuffer` options.\n  [#1860](https://github.com/lovell/sharp/pull/1860)\n  [@RaboliotTheGrey](https://github.com/RaboliotTheGrey)\n\n* Ensure image is at least 3x3 pixels before attempting trim operation.\n\n### v0.23.0 - 29<sup>th</sup> July 2019\n\n* Remove `overlayWith` previously deprecated in v0.22.0.\n\n* Add experimental support for HEIF images. Requires libvips compiled with libheif.\n  [#1105](https://github.com/lovell/sharp/issues/1105)\n\n* Expose libwebp `smartSubsample` and `reductionEffort` options.\n  [#1545](https://github.com/lovell/sharp/issues/1545)\n\n* Add experimental support for Worker Threads.\n  [#1558](https://github.com/lovell/sharp/issues/1558)\n\n* Use libvips' built-in CMYK and sRGB profiles when required.\n  [#1619](https://github.com/lovell/sharp/issues/1619)\n\n* Drop support for Node.js versions 6 and 11.\n  [#1674](https://github.com/lovell/sharp/issues/1674)\n\n* Expose `skipBlanks` option for tile-based output.\n  [#1687](https://github.com/lovell/sharp/pull/1687)\n  [@RaboliotTheGrey](https://github.com/RaboliotTheGrey)\n\n* Allow use of `failOnError` option with Stream-based input.\n  [#1691](https://github.com/lovell/sharp/issues/1691)\n\n* Fix rotate/extract ordering for non-90 angles.\n  [#1755](https://github.com/lovell/sharp/pull/1755)\n  [@iovdin](https://github.com/iovdin)\n\n## v0.22 - \"*uptake*\"\n\nRequires libvips v8.7.4.\n\n### v0.22.1 - 25<sup>th</sup> April 2019\n\n* Add `modulate` operation for brightness, saturation and hue.\n  [#1601](https://github.com/lovell/sharp/pull/1601)\n  [@Goues](https://github.com/Goues)\n\n* Improve help messaging should `require(\"sharp\")` fail.\n  [#1638](https://github.com/lovell/sharp/pull/1638)\n  [@sidharthachatterjee](https://github.com/sidharthachatterjee)\n\n* Add support for Node 12.\n  [#1668](https://github.com/lovell/sharp/issues/1668)\n\n### v0.22.0 - 18<sup>th</sup> March 2019\n\n* Remove functions previously deprecated in v0.21.0:\n    `background`, `crop`, `embed`, `ignoreAspectRatio`, `max`, `min` and `withoutEnlargement`.\n\n* Add `composite` operation supporting multiple images and blend modes; deprecate `overlayWith`.\n  [#728](https://github.com/lovell/sharp/issues/728)\n\n* Add support for `pages` input option for multi-page input.\n  [#1566](https://github.com/lovell/sharp/issues/1566)\n\n* Allow Stream-based input of raw pixel data.\n  [#1579](https://github.com/lovell/sharp/issues/1579)\n\n* Add support for `page` input option to GIF and PDF.\n  [#1595](https://github.com/lovell/sharp/pull/1595)\n  [@ramiel](https://github.com/ramiel)\n\n## v0.21 - \"*teeth*\"\n\nRequires libvips v8.7.0.\n\n### v0.21.3 - 19<sup>th</sup> January 2019\n\n* Input image decoding now fails fast, set `failOnError` to change this behaviour.\n\n* Failed filesystem-based input now separates missing file and invalid format errors.\n  [#1542](https://github.com/lovell/sharp/issues/1542)\n\n### v0.21.2 - 13<sup>th</sup> January 2019\n\n* Ensure all metadata is removed from PNG output unless `withMetadata` used.\n\n* Ensure shortest edge is at least one pixel after resizing.\n  [#1003](https://github.com/lovell/sharp/issues/1003)\n\n* Add `ensureAlpha` operation to add an alpha channel, if missing.\n  [#1153](https://github.com/lovell/sharp/issues/1153)\n\n* Expose `pages` and `pageHeight` metadata for multi-page input images.\n  [#1205](https://github.com/lovell/sharp/issues/1205)\n\n* Expose PNG output options requiring libimagequant.\n  [#1484](https://github.com/lovell/sharp/issues/1484)\n\n* Expose underlying error message for invalid input.\n  [#1505](https://github.com/lovell/sharp/issues/1505)\n\n* Prevent mutatation of options passed to `jpeg`.\n  [#1516](https://github.com/lovell/sharp/issues/1516)\n\n* Ensure forced output format applied correctly when output chaining.\n  [#1528](https://github.com/lovell/sharp/issues/1528)\n\n### v0.21.1 - 7<sup>th</sup> December 2018\n\n* Install: support `sharp_dist_base_url` npm config, like existing `SHARP_DIST_BASE_URL`.\n  [#1422](https://github.com/lovell/sharp/pull/1422)\n  [@SethWen](https://github.com/SethWen)\n\n* Ensure `channel` metadata is correct for raw, greyscale output.\n  [#1425](https://github.com/lovell/sharp/issues/1425)\n\n* Add support for the \"mitchell\" kernel for image reductions.\n  [#1438](https://github.com/lovell/sharp/pull/1438)\n  [@Daiz](https://github.com/Daiz)\n\n* Allow separate parameters for gamma encoding and decoding.\n  [#1439](https://github.com/lovell/sharp/pull/1439)\n  [@Daiz](https://github.com/Daiz)\n\n* Build prototype with `Object.assign` to allow minification.\n  [#1475](https://github.com/lovell/sharp/pull/1475)\n  [@jaubourg](https://github.com/jaubourg)\n\n* Expose libvips' recombination matrix operation.\n  [#1477](https://github.com/lovell/sharp/pull/1477)\n  [@fromkeith](https://github.com/fromkeith)\n\n* Expose libvips' pyramid/tile options for TIFF output.\n  [#1483](https://github.com/lovell/sharp/pull/1483)\n  [@mbklein](https://github.com/mbklein)\n\n### v0.21.0 - 4<sup>th</sup> October 2018\n\n* Deprecate the following resize-related functions:\n    `crop`, `embed`, `ignoreAspectRatio`, `max`, `min` and `withoutEnlargement`.\n  Access to these is now via options passed to the `resize` function.\n  For example:\n    `embed('north')` is now `resize(width, height, { fit: 'contain', position: 'north' })`,\n    `crop('attention')` is now `resize(width, height, { fit: 'cover', position: 'attention' })`,\n    `max().withoutEnlargement()` is now `resize(width, height, { fit: 'inside', withoutEnlargement: true })`.\n  [#1135](https://github.com/lovell/sharp/issues/1135)\n\n* Deprecate the `background` function.\n    Per-operation `background` options added to `resize`, `extend` and `flatten` operations.\n  [#1392](https://github.com/lovell/sharp/issues/1392)\n\n* Add `size` to `metadata` response (Stream and Buffer input only).\n  [#695](https://github.com/lovell/sharp/issues/695)\n\n* Switch from custom trim operation to `vips_find_trim`.\n  [#914](https://github.com/lovell/sharp/issues/914)\n\n* Add `chromaSubsampling` and `isProgressive` properties to `metadata` response.\n  [#1186](https://github.com/lovell/sharp/issues/1186)\n\n* Drop Node 4 support.\n  [#1212](https://github.com/lovell/sharp/issues/1212)\n\n* Enable SIMD convolution by default.\n  [#1213](https://github.com/lovell/sharp/issues/1213)\n\n* Add experimental prebuilt binaries for musl-based Linux.\n  [#1379](https://github.com/lovell/sharp/issues/1379)\n\n* Add support for arbitrary rotation angle via vips_rotate.\n  [#1385](https://github.com/lovell/sharp/pull/1385)\n  [@freezy](https://github.com/freezy)\n\n## v0.20 - \"*prebuild*\"\n\nRequires libvips v8.6.1.\n\n### v0.20.8 - 5<sup>th</sup> September 2018\n\n* Avoid race conditions when creating directories during installation.\n  [#1358](https://github.com/lovell/sharp/pull/1358)\n  [@ajhool](https://github.com/ajhool)\n\n* Accept floating point values for input density parameter.\n  [#1362](https://github.com/lovell/sharp/pull/1362)\n  [@aeirola](https://github.com/aeirola)\n\n### v0.20.7 - 21<sup>st</sup> August 2018\n\n* Use copy+unlink if rename operation fails during installation.\n  [#1345](https://github.com/lovell/sharp/issues/1345)\n\n### v0.20.6 - 20<sup>th</sup> August 2018\n\n* Add removeAlpha operation to remove alpha channel, if any.\n  [#1248](https://github.com/lovell/sharp/issues/1248)\n\n* Expose mozjpeg quant_table flag.\n  [#1285](https://github.com/lovell/sharp/pull/1285)\n  [@rexxars](https://github.com/rexxars)\n\n* Allow full WebP alphaQuality range of 0-100.\n  [#1290](https://github.com/lovell/sharp/pull/1290)\n  [@sylvaindumont](https://github.com/sylvaindumont)\n\n* Cache libvips binaries to reduce re-install time.\n  [#1301](https://github.com/lovell/sharp/issues/1301)\n\n* Ensure vendor platform mismatch throws error at install time.\n  [#1303](https://github.com/lovell/sharp/issues/1303)\n\n* Improve install time error messages for FreeBSD users.\n  [#1310](https://github.com/lovell/sharp/issues/1310)\n\n* Ensure extractChannel works with 16-bit images.\n  [#1330](https://github.com/lovell/sharp/issues/1330)\n\n* Expose depth option for tile-based output.\n  [#1342](https://github.com/lovell/sharp/pull/1342)\n  [@alundavies](https://github.com/alundavies)\n\n* Add experimental entropy field to stats response.\n\n### v0.20.5 - 27<sup>th</sup> June 2018\n\n* Expose libjpeg optimize_coding flag.\n  [#1265](https://github.com/lovell/sharp/pull/1265)\n  [@tomlokhorst](https://github.com/tomlokhorst)\n\n### v0.20.4 - 20<sup>th</sup> June 2018\n\n* Prevent possible rounding error when using shrink-on-load and 90/270 degree rotation.\n  [#1241](https://github.com/lovell/sharp/issues/1241)\n  [@anahit42](https://github.com/anahit42)\n\n* Ensure extractChannel sets correct single-channel colour space interpretation.\n  [#1257](https://github.com/lovell/sharp/issues/1257)\n  [@jeremychone](https://github.com/jeremychone)\n\n### v0.20.3 - 29<sup>th</sup> May 2018\n\n* Fix tint operation by ensuring LAB interpretation and allowing negative values.\n  [#1235](https://github.com/lovell/sharp/issues/1235)\n  [@wezside](https://github.com/wezside)\n\n### v0.20.2 - 28<sup>th</sup> April 2018\n\n* Add tint operation to set image chroma.\n  [#825](https://github.com/lovell/sharp/pull/825)\n  [@rikh42](https://github.com/rikh42)\n\n* Add environment variable to ignore globally-installed libvips.\n  [#1165](https://github.com/lovell/sharp/pull/1165)\n  [@oncletom](https://github.com/oncletom)\n\n* Add support for page selection with multi-page input (GIF/TIFF).\n  [#1204](https://github.com/lovell/sharp/pull/1204)\n  [@woolite64](https://github.com/woolite64)\n\n* Add support for Group4 (CCITTFAX4) compression with TIFF output.\n  [#1208](https://github.com/lovell/sharp/pull/1208)\n  [@woolite64](https://github.com/woolite64)\n\n### v0.20.1 - 17<sup>th</sup> March 2018\n\n* Improve installation experience when a globally-installed libvips below the minimum required version is found.\n  [#1148](https://github.com/lovell/sharp/issues/1148)\n\n* Prevent smartcrop error when cumulative rounding is below target size.\n  [#1154](https://github.com/lovell/sharp/issues/1154)\n  [@ralrom](https://github.com/ralrom)\n\n* Expose libvips' median filter operation.\n  [#1161](https://github.com/lovell/sharp/pull/1161)\n  [@BiancoA](https://github.com/BiancoA)\n\n### v0.20.0 - 5<sup>th</sup> March 2018\n\n* Add support for prebuilt sharp binaries on common platforms.\n  [#186](https://github.com/lovell/sharp/issues/186)\n\n## v0.19 - \"*suit*\"\n\nRequires libvips v8.6.1.\n\n### v0.19.1 - 24<sup>th</sup> February 2018\n\n* Expose libvips' linear transform feature.\n  [#1024](https://github.com/lovell/sharp/pull/1024)\n  [@3epnm](https://github.com/3epnm)\n\n* Expose angle option for tile-based output.\n  [#1121](https://github.com/lovell/sharp/pull/1121)\n  [@BiancoA](https://github.com/BiancoA)\n\n* Prevent crop operation when image already at or below target dimensions.\n  [#1134](https://github.com/lovell/sharp/issues/1134)\n  [@pieh](https://github.com/pieh)\n\n### v0.19.0 - 11<sup>th</sup> January 2018\n\n* Expose offset coordinates of strategy-based crop.\n  [#868](https://github.com/lovell/sharp/issues/868)\n  [@mirohristov-com](https://github.com/mirohristov-com)\n\n* PNG output now defaults to adaptiveFiltering=false, compressionLevel=9\n  [#872](https://github.com/lovell/sharp/issues/872)\n  [@wmertens](https://github.com/wmertens)\n\n* Add stats feature for pixel-derived image statistics.\n  [#915](https://github.com/lovell/sharp/pull/915)\n  [@rnanwani](https://github.com/rnanwani)\n\n* Add failOnError option to fail-fast on bad input image data.\n  [#976](https://github.com/lovell/sharp/pull/976)\n  [@mceachen](https://github.com/mceachen)\n\n* Resize: switch to libvips' implementation, make fastShrinkOnLoad optional, remove interpolator and centreSampling options.\n  [#977](https://github.com/lovell/sharp/pull/977)\n  [@jardakotesovec](https://github.com/jardakotesovec)\n\n* Attach finish event listener to a clone only for Stream-based input.\n  [#995](https://github.com/lovell/sharp/issues/995)\n  [@whmountains](https://github.com/whmountains)\n\n* Add tilecache before smartcrop to avoid over-computation of previous operations.\n  [#1028](https://github.com/lovell/sharp/issues/1028)\n  [@coffeebite](https://github.com/coffeebite)\n\n* Prevent toFile extension taking precedence over requested format.\n  [#1037](https://github.com/lovell/sharp/issues/1037)\n  [@tomgallagher](https://github.com/tomgallagher)\n\n* Add support for gravity option to existing embed feature.\n  [#1038](https://github.com/lovell/sharp/pull/1038)\n  [@AzureByte](https://github.com/AzureByte)\n\n* Expose IPTC and XMP metadata when available.\n  [#1079](https://github.com/lovell/sharp/pull/1079)\n  [@oaleynik](https://github.com/oaleynik)\n\n* TIFF output: switch default predictor from 'none' to 'horizontal' to match libvips' behaviour.\n\n## v0.18 - \"*ridge*\"\n\nRequires libvips v8.5.5.\n\n### v0.18.4 - 18<sup>th</sup> September 2017\n\n* Ensure input Buffer really is marked as Persistent, prevents mark-sweep GC.\n  [#950](https://github.com/lovell/sharp/issues/950)\n  [@lfdoherty](https://github.com/lfdoherty)\n\n### v0.18.3 - 13<sup>th</sup> September 2017\n\n* Skip shrink-on-load when trimming.\n  [#888](https://github.com/lovell/sharp/pull/888)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Migrate from got to simple-get for basic auth support.\n  [#945](https://github.com/lovell/sharp/pull/945)\n  [@pbomb](https://github.com/pbomb)\n\n### v0.18.2 - 1<sup>st</sup> July 2017\n\n* Expose libvips' xres and yres properties for TIFF output.\n  [#828](https://github.com/lovell/sharp/pull/828)\n  [@YvesBos](https://github.com/YvesBos)\n\n* Ensure flip and flop operations work with auto-rotate.\n  [#837](https://github.com/lovell/sharp/issues/837)\n  [@rexxars](https://github.com/rexxars)\n\n* Allow binary download URL override via SHARP_DIST_BASE_URL env variable.\n  [#841](https://github.com/lovell/sharp/issues/841)\n\n* Add support for Solus Linux.\n  [#857](https://github.com/lovell/sharp/pull/857)\n  [@ekremkaraca](https://github.com/ekremkaraca)\n\n### v0.18.1 - 30<sup>th</sup> May 2017\n\n* Remove regression from #781 that could cause incorrect shrink calculation.\n  [#831](https://github.com/lovell/sharp/issues/831)\n  [@suprMax](https://github.com/suprMax)\n\n### v0.18.0 - 30<sup>th</sup> May 2017\n\n* Remove the previously-deprecated output format \"option\" functions:\n    quality, progressive, compressionLevel, withoutAdaptiveFiltering,\n    withoutChromaSubsampling, trellisQuantisation, trellisQuantization,\n    overshootDeringing, optimiseScans and optimizeScans.\n\n* Ensure maximum output dimensions are based on the format to be used.\n  [#176](https://github.com/lovell/sharp/issues/176)\n  [@stephanebachelier](https://github.com/stephanebachelier)\n\n* Avoid costly (un)premultiply when using overlayWith without alpha channel.\n  [#573](https://github.com/lovell/sharp/issues/573)\n  [@strarsis](https://github.com/strarsis)\n\n* Include pixel depth (e.g. \"uchar\") when reading metadata.\n  [#577](https://github.com/lovell/sharp/issues/577)\n  [@moedusa](https://github.com/moedusa)\n\n* Add support for Buffer and Stream-based TIFF output.\n  [#587](https://github.com/lovell/sharp/issues/587)\n  [@strarsis](https://github.com/strarsis)\n\n* Expose warnings from libvips via NODE_DEBUG=sharp environment variable.\n  [#607](https://github.com/lovell/sharp/issues/607)\n  [@puzrin](https://github.com/puzrin)\n\n* Switch to the libvips implementation of \"attention\" and \"entropy\" crop strategies.\n  [#727](https://github.com/lovell/sharp/issues/727)\n\n* Improve performance and accuracy of nearest neighbour integral upsampling.\n  [#752](https://github.com/lovell/sharp/issues/752)\n  [@MrIbby](https://github.com/MrIbby)\n\n* Constructor single argument API: allow plain object, reject null/undefined.\n  [#768](https://github.com/lovell/sharp/issues/768)\n  [@kub1x](https://github.com/kub1x)\n\n* Ensure ARM64 pre-built binaries use correct C++11 ABI version.\n  [#772](https://github.com/lovell/sharp/issues/772)\n  [@ajiratech2](https://github.com/ajiratech2)\n\n* Prevent aliasing by using dynamic values for shrink(-on-load).\n  [#781](https://github.com/lovell/sharp/issues/781)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Expose libvips' \"squash\" parameter to enable 1-bit TIFF output.\n  [#783](https://github.com/lovell/sharp/pull/783)\n  [@YvesBos](https://github.com/YvesBos)\n\n* Add support for rotation using any multiple of +/-90 degrees.\n  [#791](https://github.com/lovell/sharp/pull/791)\n  [@ncoden](https://github.com/ncoden)\n\n* Add \"jpg\" alias to toFormat as shortened form of \"jpeg\".\n  [#814](https://github.com/lovell/sharp/pull/814)\n  [@jingsam](https://github.com/jingsam)\n\n## v0.17 - \"*quill*\"\n\nRequires libvips v8.4.2.\n\n### v0.17.3 - 1<sup>st</sup> April 2017\n\n* Allow toBuffer to optionally resolve a Promise with both info and data.\n  [#143](https://github.com/lovell/sharp/issues/143)\n  [@salzhrani](https://github.com/salzhrani)\n\n* Create blank image of given width, height, channels and background.\n  [#470](https://github.com/lovell/sharp/issues/470)\n  [@pjarts](https://github.com/pjarts)\n\n* Add support for the \"nearest\" kernel for image reductions.\n  [#732](https://github.com/lovell/sharp/pull/732)\n  [@alice0meta](https://github.com/alice0meta)\n\n* Add support for TIFF compression and predictor options.\n  [#738](https://github.com/lovell/sharp/pull/738)\n  [@kristojorg](https://github.com/kristojorg)\n\n### v0.17.2 - 11<sup>th</sup> February 2017\n\n* Ensure Readable side of Stream can start flowing after Writable side has finished.\n  [#671](https://github.com/lovell/sharp/issues/671)\n  [@danhaller](https://github.com/danhaller)\n\n* Expose WebP alpha quality, lossless and near-lossless output options.\n  [#685](https://github.com/lovell/sharp/pull/685)\n  [@rnanwani](https://github.com/rnanwani)\n\n### v0.17.1 - 15<sup>th</sup> January 2017\n\n* Improve error messages for invalid parameters.\n  [@spikeon](https://github.com/spikeon)\n  [#644](https://github.com/lovell/sharp/pull/644)\n\n* Simplify expression for finding vips-cpp libdir.\n  [#656](https://github.com/lovell/sharp/pull/656)\n\n* Allow HTTPS-over-HTTP proxy when downloading pre-compiled dependencies.\n  [@wangzhiwei1888](https://github.com/wangzhiwei1888)\n  [#679](https://github.com/lovell/sharp/issues/679)\n\n### v0.17.0 - 11<sup>th</sup> December 2016\n\n* Drop support for versions of Node prior to v4.\n\n* Deprecate the following output format \"option\" functions:\n    quality, progressive, compressionLevel, withoutAdaptiveFiltering,\n    withoutChromaSubsampling, trellisQuantisation, trellisQuantization,\n    overshootDeringing, optimiseScans and optimizeScans.\n  Access to these is now via output format functions, for example `quality(n)`\n    is now `jpeg({quality: n})` and/or `webp({quality: n})`.\n\n* Autoconvert GIF and SVG input to PNG output if no other format is specified.\n\n* Expose libvips' \"centre\" resize option to mimic \\*magick's +0.5px convention.\n  [#568](https://github.com/lovell/sharp/issues/568)\n\n* Ensure support for embedded base64 PNG and JPEG images within an SVG.\n  [#601](https://github.com/lovell/sharp/issues/601)\n  [@dynamite-ready](https://github.com/dynamite-ready)\n\n* Ensure premultiply operation occurs before box filter shrink.\n  [#605](https://github.com/lovell/sharp/issues/605)\n  [@CmdrShepardsPie](https://github.com/CmdrShepardsPie)\n  [@teroparvinen](https://github.com/teroparvinen)\n\n* Add support for PNG and WebP tile-based output formats (in addition to JPEG).\n  [#622](https://github.com/lovell/sharp/pull/622)\n  [@ppaskaris](https://github.com/ppaskaris)\n\n* Allow use of extend with greyscale input.\n  [#623](https://github.com/lovell/sharp/pull/623)\n  [@ppaskaris](https://github.com/ppaskaris)\n\n* Allow non-RGB input to embed/extend onto background with an alpha channel.\n  [#646](https://github.com/lovell/sharp/issues/646)\n  [@DaGaMs](https://github.com/DaGaMs)\n\n## v0.16 - \"*pencil*\"\n\nRequires libvips v8.3.3\n\n### v0.16.2 - 22<sup>nd</sup> October 2016\n\n* Restrict readelf usage to Linux only when detecting global libvips version.\n  [#602](https://github.com/lovell/sharp/issues/602)\n  [@caoko](https://github.com/caoko)\n\n### v0.16.1 - 13<sup>th</sup> October 2016\n\n* C++11 ABI version is now auto-detected, remove sharp-cxx11 installation flag.\n\n* Add experimental 'attention' crop strategy.\n  [#295](https://github.com/lovell/sharp/issues/295)\n\n* Include .node extension for Meteor's require() implementation.\n  [#537](https://github.com/lovell/sharp/issues/537)\n  [@isjackwild](https://github.com/isjackwild)\n\n* Ensure convolution kernel scale is clamped to a minimum value of 1.\n  [#561](https://github.com/lovell/sharp/issues/561)\n  [@abagshaw](https://github.com/abagshaw)\n\n* Correct calculation of y-axis placement when overlaying image at a fixed point.\n  [#566](https://github.com/lovell/sharp/issues/566)\n  [@Nateowami](https://github.com/Nateowami)\n\n### v0.16.0 - 18<sup>th</sup> August 2016\n\n* Add pre-compiled libvips for OS X, ARMv7 and ARMv8.\n  [#312](https://github.com/lovell/sharp/issues/312)\n\n* Ensure boolean, bandbool, extractChannel ops occur before sRGB conversion.\n  [#504](https://github.com/lovell/sharp/pull/504)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Recalculate factors after WebP shrink-on-load to avoid round-to-zero errors.\n  [#508](https://github.com/lovell/sharp/issues/508)\n  [@asilvas](https://github.com/asilvas)\n\n* Prevent boolean errors during extract operation.\n  [#511](https://github.com/lovell/sharp/pull/511)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Add joinChannel and toColourspace/toColorspace operations.\n  [#513](https://github.com/lovell/sharp/pull/513)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Add support for raw pixel data with boolean and withOverlay operations.\n  [#516](https://github.com/lovell/sharp/pull/516)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Prevent bandbool creating a single channel sRGB image.\n  [#519](https://github.com/lovell/sharp/pull/519)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Ensure ICC profiles are removed from PNG output unless withMetadata used.\n  [#521](https://github.com/lovell/sharp/issues/521)\n  [@ChrisPinewood](https://github.com/ChrisPinewood)\n\n* Add alpha channels, if missing, to overlayWith images.\n  [#540](https://github.com/lovell/sharp/pull/540)\n  [@cmtt](https://github.com/cmtt)\n\n* Remove deprecated interpolateWith method - use resize(w, h, { interpolator: ... })\n  [#310](https://github.com/lovell/sharp/issues/310)\n\n## v0.15 - \"*outfit*\"\n\nRequires libvips v8.3.1\n\n### v0.15.1 - 12<sup>th</sup> July 2016\n\n* Concat Stream-based input in single operation for ~+3% perf and less GC.\n  [#429](https://github.com/lovell/sharp/issues/429)\n  [@papandreou](https://github.com/papandreou)\n\n* Add alpha channel, if required, before extend operation.\n  [#439](https://github.com/lovell/sharp/pull/439)\n  [@frulo](https://github.com/frulo)\n\n* Allow overlay image to be repeated across entire image via tile option.\n  [#443](https://github.com/lovell/sharp/pull/443)\n  [@lemnisk8](https://github.com/lemnisk8)\n\n* Add cutout option to overlayWith feature, applies only the alpha channel of the overlay image.\n  [#448](https://github.com/lovell/sharp/pull/448)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Ensure scaling factors are calculated independently to prevent rounding errors.\n  [#452](https://github.com/lovell/sharp/issues/452)\n  [@puzrin](https://github.com/puzrin)\n\n* Add --sharp-cxx11 flag to compile with gcc's new C++11 ABI.\n  [#456](https://github.com/lovell/sharp/pull/456)\n  [@kapouer](https://github.com/kapouer)\n\n* Add top/left offset support to overlayWith operation.\n  [#473](https://github.com/lovell/sharp/pull/473)\n  [@rnanwani](https://github.com/rnanwani)\n\n* Add convolve operation for kernel-based convolution.\n  [#479](https://github.com/lovell/sharp/pull/479)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Add greyscale option to threshold operation for colourspace conversion control.\n  [#480](https://github.com/lovell/sharp/pull/480)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Ensure ICC profiles are licenced for distribution.\n  [#486](https://github.com/lovell/sharp/issues/486)\n  [@kapouer](https://github.com/kapouer)\n\n* Allow images with an alpha channel to work with LAB-colourspace based sharpen.\n  [#490](https://github.com/lovell/sharp/issues/490)\n  [@jwagner](https://github.com/jwagner)\n\n* Add trim operation to remove \"boring\" edges.\n  [#492](https://github.com/lovell/sharp/pull/492)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Add bandbool feature for channel-wise boolean operations.\n  [#496](https://github.com/lovell/sharp/pull/496)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Add extractChannel operation to extract a channel from an image.\n  [#497](https://github.com/lovell/sharp/pull/497)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Add ability to read and write native libvips .v files.\n  [#500](https://github.com/lovell/sharp/pull/500)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Add boolean feature for bitwise image operations.\n  [#501](https://github.com/lovell/sharp/pull/501)\n  [@mhirsch](https://github.com/mhirsch)\n\n### v0.15.0 - 21<sup>st</sup> May 2016\n\n* Use libvips' new Lanczos 3 kernel as default for image reduction.\n  Deprecate interpolateWith method, now provided as a resize option.\n  [#310](https://github.com/lovell/sharp/issues/310)\n  [@jcupitt](https://github.com/jcupitt)\n\n* Take advantage of libvips v8.3 features.\n  Add support for libvips' new GIF and SVG loaders.\n  Pre-built binaries now include giflib and librsvg, exclude *magick.\n  Use shrink-on-load for WebP input.\n  Break existing sharpen API to accept sigma and improve precision.\n  [#369](https://github.com/lovell/sharp/issues/369)\n\n* Remove unnecessary (un)premultiply operations when not resizing/compositing.\n  [#413](https://github.com/lovell/sharp/issues/413)\n  [@jardakotesovec](https://github.com/jardakotesovec)\n\n## v0.14 - \"*needle*\"\n\nRequires libvips v8.2.3\n\n### v0.14.1 - 16<sup>th</sup> April 2016\n\n* Allow removal of limitation on input pixel count via limitInputPixels. Use with care.\n  [#250](https://github.com/lovell/sharp/issues/250)\n  [#316](https://github.com/lovell/sharp/pull/316)\n  [@anandthakker](https://github.com/anandthakker)\n  [@kentongray](https://github.com/kentongray)\n\n* Use final output image for metadata passed to callback.\n  [#399](https://github.com/lovell/sharp/pull/399)\n  [@salzhrani](https://github.com/salzhrani)\n\n* Add support for writing tiled images to a zip container.\n  [#402](https://github.com/lovell/sharp/pull/402)\n  [@felixbuenemann](https://github.com/felixbuenemann)\n\n* Allow use of embed with 1 and 2 channel images.\n  [#411](https://github.com/lovell/sharp/issues/411)\n  [@janaz](https://github.com/janaz)\n\n* Improve Electron compatibility by allowing node-gyp rebuilds without npm.\n  [#412](https://github.com/lovell/sharp/issues/412)\n  [@nouh](https://github.com/nouh)\n\n### v0.14.0 - 2<sup>nd</sup> April 2016\n\n* Add ability to extend (pad) the edges of an image.\n  [#128](https://github.com/lovell/sharp/issues/128)\n  [@blowsie](https://github.com/blowsie)\n\n* Add support for Zoomify and Google tile layouts. Breaks existing tile API.\n  [#223](https://github.com/lovell/sharp/issues/223)\n  [@bdunnette](https://github.com/bdunnette)\n\n* Improvements to overlayWith: differing sizes/formats, gravity, buffer input.\n  [#239](https://github.com/lovell/sharp/issues/239)\n  [@chrisriley](https://github.com/chrisriley)\n\n* Add entropy-based crop strategy to remove least interesting edges.\n  [#295](https://github.com/lovell/sharp/issues/295)\n  [@rightaway](https://github.com/rightaway)\n\n* Expose density metadata; set density of images from vector input.\n  [#338](https://github.com/lovell/sharp/issues/338)\n  [@lookfirst](https://github.com/lookfirst)\n\n* Emit post-processing 'info' event for Stream output.\n  [#367](https://github.com/lovell/sharp/issues/367)\n  [@salzhrani](https://github.com/salzhrani)\n\n* Ensure output image EXIF Orientation values are within 1-8 range.\n  [#385](https://github.com/lovell/sharp/pull/385)\n  [@jtobinisaniceguy](https://github.com/jtobinisaniceguy)\n\n* Ensure ratios are not swapped when rotating 90/270 and ignoring aspect.\n  [#387](https://github.com/lovell/sharp/issues/387)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Remove deprecated style of calling extract API. Breaks calls using positional arguments.\n  [#276](https://github.com/lovell/sharp/issues/276)\n\n## v0.13 - \"*mind*\"\n\nRequires libvips v8.2.2\n\n### v0.13.1 - 27<sup>th</sup> February 2016\n\n* Fix embedding onto transparent backgrounds; regression introduced in v0.13.0.\n  [#366](https://github.com/lovell/sharp/issues/366)\n  [@diegocsandrim](https://github.com/diegocsandrim)\n\n### v0.13.0 - 15<sup>th</sup> February 2016\n\n* Improve vector image support by allowing control of density/DPI.\n  Switch pre-built libs from Imagemagick to Graphicsmagick.\n  [#110](https://github.com/lovell/sharp/issues/110)\n  [@bradisbell](https://github.com/bradisbell)\n\n* Add support for raw, uncompressed pixel Buffer/Stream input.\n  [#220](https://github.com/lovell/sharp/issues/220)\n  [@mikemorris](https://github.com/mikemorris)\n\n* Switch from libvips' C to C++ bindings, requires upgrade to v8.2.2.\n  [#299](https://github.com/lovell/sharp/issues/299)\n\n* Control number of open files in libvips' cache; breaks existing `cache` behaviour.\n  [#315](https://github.com/lovell/sharp/issues/315)\n  [@impomezia](https://github.com/impomezia)\n\n* Ensure 16-bit input images can be normalised and embedded onto transparent backgrounds.\n  [#339](https://github.com/lovell/sharp/issues/339)\n  [#340](https://github.com/lovell/sharp/issues/340)\n  [@janaz](https://github.com/janaz)\n\n* Ensure selected format takes precedence over any unknown output filename extension.\n  [#344](https://github.com/lovell/sharp/issues/344)\n  [@ubaltaci](https://github.com/ubaltaci)\n\n* Add support for libvips' PBM, PGM, PPM and FITS image format loaders.\n  [#347](https://github.com/lovell/sharp/issues/347)\n  [@oaleynik](https://github.com/oaleynik)\n\n* Ensure default crop gravity is center/centre.\n  [#351](https://github.com/lovell/sharp/pull/351)\n  [@joelmukuthu](https://github.com/joelmukuthu)\n\n* Improve support for musl libc systems e.g. Alpine Linux.\n  [#354](https://github.com/lovell/sharp/issues/354)\n  [#359](https://github.com/lovell/sharp/pull/359)\n  [@download13](https://github.com/download13)\n  [@wjordan](https://github.com/wjordan)\n\n* Small optimisation when reducing by an integral factor to favour shrink over affine.\n\n* Add support for gamma correction of images with an alpha channel.\n\n## v0.12 - \"*look*\"\n\nRequires libvips v8.2.0\n\n### v0.12.2 - 16<sup>th</sup> January 2016\n\n* Upgrade libvips to v8.2.0 for improved vips_shrink.\n\n* Add pre-compiled libvips for ARMv6+ CPUs.\n\n* Ensure 16-bit input images work with embed option.\n  [#325](https://github.com/lovell/sharp/issues/325)\n  [@janaz](https://github.com/janaz)\n\n* Allow compilation with gmake to provide FreeBSD support.\n  [#326](https://github.com/lovell/sharp/issues/326)\n  [@c0decafe](https://github.com/c0decafe)\n\n* Attempt to remove temporary file after installation.\n  [#331](https://github.com/lovell/sharp/issues/331)\n  [@dtoubelis](https://github.com/dtoubelis)\n\n### v0.12.1 - 12<sup>th</sup> December 2015\n\n* Allow use of SIMD vector instructions (via liborc) to be toggled on/off.\n  [#172](https://github.com/lovell/sharp/issues/172)\n  [@bkw](https://github.com/bkw)\n  [@puzrin](https://github.com/puzrin)\n\n* Ensure embedded ICC profiles output with perceptual intent.\n  [#321](https://github.com/lovell/sharp/issues/321)\n  [@vlapo](https://github.com/vlapo)\n\n* Use the NPM-configured HTTPS proxy, if any, for binary downloads.\n\n### v0.12.0 - 23<sup>rd</sup> November 2015\n\n* Bundle pre-compiled libvips and its dependencies for 64-bit Linux and Windows.\n  [#42](https://github.com/lovell/sharp/issues/42)\n\n* Take advantage of libvips v8.1.0+ features.\n  [#152](https://github.com/lovell/sharp/issues/152)\n\n* Add support for 64-bit Windows. Drop support for 32-bit Windows.\n  [#224](https://github.com/lovell/sharp/issues/224)\n  [@sabrehagen](https://github.com/sabrehagen)\n\n* Switch default interpolator to bicubic.\n  [#289](https://github.com/lovell/sharp/issues/289)\n  [@mahnunchik](https://github.com/mahnunchik)\n\n* Pre-extract rotatation should not swap width/height.\n  [#296](https://github.com/lovell/sharp/issues/296)\n  [@asilvas](https://github.com/asilvas)\n\n* Ensure 16-bit+alpha input images are (un)premultiplied correctly.\n  [#301](https://github.com/lovell/sharp/issues/301)\n  [@izaakschroeder](https://github.com/izaakschroeder)\n\n* Add `threshold` operation.\n  [#303](https://github.com/lovell/sharp/pull/303)\n  [@dacarley](https://github.com/dacarley)\n\n* Add `negate` operation.\n  [#306](https://github.com/lovell/sharp/pull/306)\n  [@dacarley](https://github.com/dacarley)\n\n* Support `options` Object with existing `extract` operation.\n  [#309](https://github.com/lovell/sharp/pull/309)\n  [@papandreou](https://github.com/papandreou)\n\n## v0.11 - \"*knife*\"\n\n### v0.11.4 - 5<sup>th</sup> November 2015\n\n* Add corners, e.g. `northeast`, to existing `gravity` option.\n  [#291](https://github.com/lovell/sharp/pull/291)\n  [@brandonaaron](https://github.com/brandonaaron)\n\n* Ensure correct auto-rotation for EXIF Orientation values 2 and 4.\n  [#288](https://github.com/lovell/sharp/pull/288)\n  [@brandonaaron](https://github.com/brandonaaron)\n\n* Make static linking possible via `--runtime_link` install option.\n  [#287](https://github.com/lovell/sharp/pull/287)\n  [@vlapo](https://github.com/vlapo)\n\n### v0.11.3 - 8<sup>th</sup> September 2015\n\n* Intrepret blurSigma, sharpenFlat, and sharpenJagged as double precision.\n  [#263](https://github.com/lovell/sharp/pull/263)\n  [@chrisriley](https://github.com/chrisriley)\n\n### v0.11.2 - 28<sup>th</sup> August 2015\n\n* Allow crop gravity to be provided as a String.\n  [#255](https://github.com/lovell/sharp/pull/255)\n  [@papandreou](https://github.com/papandreou)\n* Add support for io.js v3 and Node v4.\n  [#246](https://github.com/lovell/sharp/issues/246)\n\n### v0.11.1 - 12<sup>th</sup> August 2015\n\n* Silence MSVC warning: \"C4530: C++ exception handler used, but unwind semantics are not enabled\".\n  [#244](https://github.com/lovell/sharp/pull/244)\n  [@TheThing](https://github.com/TheThing)\n\n* Suppress gamma correction for input image with alpha transparency.\n  [#249](https://github.com/lovell/sharp/issues/249)\n  [@compeak](https://github.com/compeak)\n\n### v0.11.0 - 15<sup>th</sup> July 2015\n\n* Allow alpha transparency compositing via new `overlayWith` method.\n  [#97](https://github.com/lovell/sharp/issues/97)\n  [@gasi](https://github.com/gasi)\n\n* Expose raw ICC profile data as a Buffer when using `metadata`.\n  [#129](https://github.com/lovell/sharp/issues/129)\n  [@homerjam](https://github.com/homerjam)\n\n* Allow image header updates via a parameter passed to existing `withMetadata` method.\n  Provide initial support for EXIF `Orientation` tag,\n  which if present is now removed when using `rotate`, `flip` or `flop`.\n  [#189](https://github.com/lovell/sharp/issues/189)\n  [@h2non](https://github.com/h2non)\n\n* Tighten constructor parameter checks.\n  [#221](https://github.com/lovell/sharp/issues/221)\n  [@mikemorris](https://github.com/mikemorris)\n\n* Allow one input Stream to be shared with two or more output Streams via new `clone` method.\n  [#235](https://github.com/lovell/sharp/issues/235)\n  [@jaubourg](https://github.com/jaubourg)\n\n* Use `round` instead of `floor` when auto-scaling dimensions to avoid floating-point rounding errors.\n  [#238](https://github.com/lovell/sharp/issues/238)\n  [@richardadjogah](https://github.com/richardadjogah)\n\n## v0.10 - \"*judgment*\"\n\n### v0.10.1 - 1<sup>st</sup> June 2015\n\n* Allow embed of image with alpha transparency onto non-transparent background.\n  [#204](https://github.com/lovell/sharp/issues/204)\n  [@mikemliu](https://github.com/mikemliu)\n\n* Include C standard library for `atoi` as Xcode 6.3 appears to no longer do this.\n  [#228](https://github.com/lovell/sharp/issues/228)\n  [@doggan](https://github.com/doggan)\n\n### v0.10.0 - 23<sup>rd</sup> April 2015\n\n* Add support for Windows (x86).\n  [#19](https://github.com/lovell/sharp/issues/19)\n  [@DullReferenceException](https://github.com/DullReferenceException)\n  [@itsananderson](https://github.com/itsananderson)\n\n* Add support for Openslide input and DeepZoom output.\n  [#146](https://github.com/lovell/sharp/issues/146)\n  [@mvictoras](https://github.com/mvictoras)\n\n* Allow arbitrary aspect ratios when resizing images via new `ignoreAspectRatio` method.\n  [#192](https://github.com/lovell/sharp/issues/192)\n  [@skedastik](https://github.com/skedastik)\n\n* Enhance output image contrast by stretching its luminance to cover the full dynamic range via new `normalize` method.\n  [#194](https://github.com/lovell/sharp/issues/194)\n  [@bkw](https://github.com/bkw)\n  [@codingforce](https://github.com/codingforce)\n", "'use strict';\n\nconst fs = require('fs');\nconst os = require('os');\nconst path = require('path');\nconst spawnSync = require('child_process').spawnSync;\nconst semverCoerce = require('semver/functions/coerce');\nconst semverGreaterThanOrEqualTo = require('semver/functions/gte');\n\nconst platform = require('./platform');\nconst { config } = require('../package.json');\n\nconst env = process.env;\nconst minimumLibvipsVersionLabelled = env.npm_package_config_libvips || /* istanbul ignore next */\n  config.libvips;\nconst minimumLibvipsVersion = semverCoerce(minimumLibvipsVersionLabelled).version;\n\nconst spawnSyncOptions = {\n  encoding: 'utf8',\n  shell: true\n};\n\nconst vendorPath = path.join(__dirname, '..', 'vendor', minimumLibvipsVersion, platform());\n\nconst mkdirSync = function (dirPath) {\n  try {\n    fs.mkdirSync(dirPath, { recursive: true });\n  } catch (err) {\n    /* istanbul ignore next */\n    if (err.code !== 'EEXIST') {\n      throw err;\n    }\n  }\n};\n\nconst cachePath = function () {\n  const npmCachePath = env.npm_config_cache || /* istanbul ignore next */\n    (env.APPDATA ? path.join(env.APPDATA, 'npm-cache') : path.join(os.homedir(), '.npm'));\n  mkdirSync(npmCachePath);\n  const libvipsCachePath = path.join(npmCachePath, '_libvips');\n  mkdirSync(libvipsCachePath);\n  return libvipsCachePath;\n};\n\nconst integrity = function (platformAndArch) {\n  return env[`npm_package_config_integrity_${platformAndArch.replace('-', '_')}`] || config.integrity[platformAndArch];\n};\n\nconst log = function (item) {\n  if (item instanceof Error) {\n    console.error(`sharp: Installation error: ${item.message}`);\n  } else {\n    console.log(`sharp: ${item}`);\n  }\n};\n\nconst isRosetta = function () {\n  /* istanbul ignore next */\n  if (process.platform === 'darwin' && process.arch === 'x64') {\n    const translated = spawnSync('sysctl sysctl.proc_translated', spawnSyncOptions).stdout;\n    return (translated || '').trim() === 'sysctl.proc_translated: 1';\n  }\n  return false;\n};\n\nconst globalLibvipsVersion = function () {\n  if (process.platform !== 'win32') {\n    const globalLibvipsVersion = spawnSync(`PKG_CONFIG_PATH=\"${pkgConfigPath()}\" pkg-config --modversion vips-cpp`, spawnSyncOptions).stdout;\n    /* istanbul ignore next */\n    return (globalLibvipsVersion || '').trim();\n  } else {\n    return '';\n  }\n};\n\nconst hasVendoredLibvips = function () {\n  return fs.existsSync(vendorPath);\n};\n\n/* istanbul ignore next */\nconst removeVendoredLibvips = function () {\n  const rm = fs.rmSync ? fs.rmSync : fs.rmdirSync;\n  rm(vendorPath, { recursive: true, maxRetries: 3, force: true });\n};\n\nconst pkgConfigPath = function () {\n  if (process.platform !== 'win32') {\n    const brewPkgConfigPath = spawnSync('which brew >/dev/null 2>&1 && eval $(brew --env) && echo $PKG_CONFIG_LIBDIR', spawnSyncOptions).stdout || '';\n    return [\n      brewPkgConfigPath.trim(),\n      env.PKG_CONFIG_PATH,\n      '/usr/local/lib/pkgconfig',\n      '/usr/lib/pkgconfig',\n      '/usr/local/libdata/pkgconfig',\n      '/usr/libdata/pkgconfig'\n    ].filter(Boolean).join(':');\n  } else {\n    return '';\n  }\n};\n\nconst useGlobalLibvips = function () {\n  if (Boolean(env.SHARP_IGNORE_GLOBAL_LIBVIPS) === true) {\n    return false;\n  }\n  /* istanbul ignore next */\n  if (isRosetta()) {\n    return false;\n  }\n  const globalVipsVersion = globalLibvipsVersion();\n  return !!globalVipsVersion && /* istanbul ignore next */\n    semverGreaterThanOrEqualTo(globalVipsVersion, minimumLibvipsVersion);\n};\n\nmodule.exports = {\n  minimumLibvipsVersion,\n  minimumLibvipsVersionLabelled,\n  cachePath,\n  integrity,\n  log,\n  globalLibvipsVersion,\n  hasVendoredLibvips,\n  removeVendoredLibvips,\n  pkgConfigPath,\n  useGlobalLibvips,\n  mkdirSync\n};\n"], "fixing_code": ["# Changelog\n\n## v0.30 - *dresser*\n\nRequires libvips v8.12.2\n\n### v0.30.5 - TBD\n\n* Install: pass `PKG_CONFIG_PATH` via env rather than substitution.\n  [@dwisiswant0](https://github.com/dwisiswant0)\n\n* Allow installation of prebuilt libvips binaries from filesystem.\n  [#3196](https://github.com/lovell/sharp/pull/3196)\n  [@ankurparihar](https://github.com/ankurparihar)\n\n* Fix rotate-then-extract for EXIF orientation 2.\n  [#3218](https://github.com/lovell/sharp/pull/3218)\n  [@jakob0fischl](https://github.com/jakob0fischl)\n\n### v0.30.4 - 18th April 2022\n\n* Increase control over sensitivity to invalid images via `failOn`, deprecate `failOnError` (equivalent to `failOn: 'warning'`).\n\n* Ensure `create` input image has correct bit depth and colour space.\n  [#3139](https://github.com/lovell/sharp/issues/3139)\n\n* Add support for `TypedArray` input with `byteOffset` and `length`.\n  [#3146](https://github.com/lovell/sharp/pull/3146)\n  [@codepage949](https://github.com/codepage949)\n\n* Improve error message when attempting to render SVG input greater than 32767x32767.\n  [#3167](https://github.com/lovell/sharp/issues/3167)\n\n* Add missing file name to 'Input file is missing' error message.\n  [#3178](https://github.com/lovell/sharp/pull/3178)\n  [@Brodan](https://github.com/Brodan)\n\n### v0.30.3 - 14th March 2022\n\n* Allow `sharpen` options to be provided more consistently as an Object.\n  [#2561](https://github.com/lovell/sharp/issues/2561)\n\n* Expose `x1`, `y2` and `y3` parameters of `sharpen` operation.\n  [#2935](https://github.com/lovell/sharp/issues/2935)\n\n* Prevent double unpremultiply with some composite blend modes (regression in 0.30.2).\n  [#3118](https://github.com/lovell/sharp/issues/3118)\n\n### v0.30.2 - 2nd March 2022\n\n* Improve performance and accuracy when compositing multiple images.\n  [#2286](https://github.com/lovell/sharp/issues/2286)\n\n* Expand pkgconfig search path for wider BSD support.\n  [#3106](https://github.com/lovell/sharp/issues/3106)\n\n* Ensure Windows C++ runtime is linked statically (regression in 0.30.0).\n  [#3110](https://github.com/lovell/sharp/pull/3110)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Temporarily ignore greyscale ICC profiles to workaround lcms bug.\n  [#3112](https://github.com/lovell/sharp/issues/3112)\n\n### v0.30.1 - 9th February 2022\n\n* Allow use of `toBuffer` and `toFile` on the same instance.\n  [#3044](https://github.com/lovell/sharp/issues/3044)\n\n* Skip shrink-on-load for known libjpeg rounding errors.\n  [#3066](https://github.com/lovell/sharp/issues/3066)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Ensure withoutReduction does not interfere with contain/crop/embed.\n  [#3081](https://github.com/lovell/sharp/pull/3081)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Ensure affine interpolator is correctly finalised.\n  [#3083](https://github.com/lovell/sharp/pull/3083)\n  [@kleisauke](https://github.com/kleisauke)\n\n### v0.30.0 - 1st February 2022\n\n* Add support for GIF output to prebuilt binaries.\n\n* Reduce minimum Linux ARM64v8 glibc requirement to 2.17.\n\n* Verify prebuilt binaries with a Subresource Integrity check.\n\n* Standardise WebP `effort` option name, deprecate `reductionEffort`.\n\n* Standardise HEIF `effort` option name, deprecate `speed`.\n\n* Add support for IIIF v3 tile-based output.\n\n* Expose control over CPU effort for palette-based PNG output.\n  [#2541](https://github.com/lovell/sharp/issues/2541)\n\n* Improve animated (multi-page) image resize and extract.\n  [#2789](https://github.com/lovell/sharp/pull/2789)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Expose platform and architecture of vendored binaries as `sharp.vendor`.\n  [#2928](https://github.com/lovell/sharp/issues/2928)\n\n* Ensure 16-bit PNG output uses correct bitdepth.\n  [#2958](https://github.com/lovell/sharp/pull/2958)\n  [@gforge](https://github.com/gforge)\n\n* Properly emit close events for duplex streams.\n  [#2976](https://github.com/lovell/sharp/pull/2976)\n  [@driannaude](https://github.com/driannaude)\n\n* Expose `unlimited` option for SVG and PNG input, switches off safety features.\n  [#2984](https://github.com/lovell/sharp/issues/2984)\n\n* Add `withoutReduction` option to resize operation.\n  [#3006](https://github.com/lovell/sharp/pull/3006)\n  [@christopherbradleybanks](https://github.com/christopherbradleybanks)\n\n* Add `resolutionUnit` as `tiff` option and expose in metadata.\n  [#3023](https://github.com/lovell/sharp/pull/3023)\n  [@ompal-sisodiya](https://github.com/ompal-sisodiya)\n\n* Ensure rotate-then-extract works with EXIF mirroring.\n  [#3024](https://github.com/lovell/sharp/issues/3024)\n\n## v0.29 - *circle*\n\nRequires libvips v8.11.3\n\n### v0.29.3 - 14th November 2021\n\n* Ensure correct dimensions when containing image resized to 1px.\n  [#2951](https://github.com/lovell/sharp/issues/2951)\n\n* Impute TIFF `xres`/`yres` from `density` provided to `withMetadata`.\n  [#2952](https://github.com/lovell/sharp/pull/2952)\n  [@mbklein](https://github.com/mbklein)\n\n### v0.29.2 - 21st October 2021\n\n* Add `timeout` function to limit processing time.\n\n* Ensure `sharp.versions` is populated from vendored libvips.\n\n* Remove animation properties from single page images.\n  [#2890](https://github.com/lovell/sharp/issues/2890)\n\n* Allow use of 'tif' to select TIFF output.\n  [#2893](https://github.com/lovell/sharp/pull/2893)\n  [@erf](https://github.com/erf)\n\n* Improve error message on Windows for version conflict.\n  [#2918](https://github.com/lovell/sharp/pull/2918)\n  [@dkrnl](https://github.com/dkrnl)\n\n* Throw error rather than exit when invalid binaries detected.\n  [#2931](https://github.com/lovell/sharp/issues/2931)\n\n### v0.29.1 - 7th September 2021\n\n* Add `lightness` option to `modulate` operation.\n  [#2846](https://github.com/lovell/sharp/pull/2846)\n\n* Ensure correct PNG bitdepth is set based on number of colours.\n  [#2855](https://github.com/lovell/sharp/issues/2855)\n\n* Ensure background is always premultiplied when compositing.\n  [#2858](https://github.com/lovell/sharp/issues/2858)\n\n* Ensure images with P3 profiles retain full gamut.\n  [#2862](https://github.com/lovell/sharp/issues/2862)\n\n* Add support for libvips compiled with OpenJPEG.\n  [#2868](https://github.com/lovell/sharp/pull/2868)\n\n* Remove unsupported animation properties from AVIF output.\n  [#2870](https://github.com/lovell/sharp/issues/2870)\n\n* Resolve paths before comparing input/output filenames.\n  [#2878](https://github.com/lovell/sharp/pull/2878)\n  [@rexxars](https://github.com/rexxars)\n\n* Allow use of speed 9 (fastest) for HEIF encoding.\n  [#2879](https://github.com/lovell/sharp/pull/2879)\n  [@rexxars](https://github.com/rexxars)\n\n### v0.29.0 - 17th August 2021\n\n* Drop support for Node.js 10, now requires Node.js >= 12.13.0.\n\n* Add `background` property to PNG and GIF image metadata.\n\n* Add `compression` property to HEIF image metadata.\n  [#2504](https://github.com/lovell/sharp/issues/2504)\n\n* AVIF encoding now defaults to `4:4:4` chroma subsampling.\n  [#2562](https://github.com/lovell/sharp/issues/2562)\n\n* Allow multiple platform-arch binaries in same `node_modules` installation tree.\n  [#2575](https://github.com/lovell/sharp/issues/2575)\n\n* Default to single-channel `b-w` space when `extractChannel` is used.\n  [#2658](https://github.com/lovell/sharp/issues/2658)\n\n* Allow installation directory to contain spaces (regression in v0.26.0).\n  [#2777](https://github.com/lovell/sharp/issues/2777)\n\n* Add `pipelineColourspace` operator to set the processing space.\n  [#2704](https://github.com/lovell/sharp/pull/2704)\n  [@Daiz](https://github.com/Daiz)\n\n* Allow bit depth to be set when using raw input and output.\n  [#2762](https://github.com/lovell/sharp/pull/2762)\n  [@mart-jansink](https://github.com/mart-jansink)\n\n* Allow `negate` to act only on non-alpha channels.\n  [#2808](https://github.com/lovell/sharp/pull/2808)\n  [@rexxars](https://github.com/rexxars)\n\n## v0.28 - *bijou*\n\nRequires libvips v8.10.6\n\n### v0.28.3 - 24th May 2021\n\n* Ensure presence of libvips, vendored or global, before invoking node-gyp.\n\n* Skip shrink-on-load for multi-page WebP.\n  [#2714](https://github.com/lovell/sharp/issues/2714)\n\n* Add contrast limiting adaptive histogram equalization (CLAHE) operator.\n  [#2726](https://github.com/lovell/sharp/pull/2726)\n  [@baparham](https://github.com/baparham)\n\n### v0.28.2 - 10th May 2021\n\n* Allow `withMetadata` to set `density`.\n  [#967](https://github.com/lovell/sharp/issues/967)\n\n* Skip shrink-on-load where one dimension <4px.\n  [#2653](https://github.com/lovell/sharp/issues/2653)\n\n* Allow escaped proxy credentials.\n  [#2664](https://github.com/lovell/sharp/pull/2664)\n  [@msalettes](https://github.com/msalettes)\n\n* Add `premultiplied` flag for raw pixel data input.\n  [#2685](https://github.com/lovell/sharp/pull/2685)\n  [@mnutt](https://github.com/mnutt)\n\n* Detect empty input and throw a helpful error.\n  [#2687](https://github.com/lovell/sharp/pull/2687)\n  [@JakobJingleheimer](https://github.com/JakobJingleheimer)\n\n* Add install-time flag to skip version compatibility checks.\n  [#2692](https://github.com/lovell/sharp/pull/2692)\n  [@xemle](https://github.com/xemle)\n\n### v0.28.1 - 5th April 2021\n\n* Ensure all installation errors are logged with a more obvious prefix.\n\n* Allow `withMetadata` to set and update EXIF metadata.\n  [#650](https://github.com/lovell/sharp/issues/650)\n\n* Add support for OME-TIFF Sub Image File Directories (subIFD).\n  [#2557](https://github.com/lovell/sharp/issues/2557)\n\n* Allow `ensureAlpha` to set the alpha transparency level.\n  [#2634](https://github.com/lovell/sharp/issues/2634)\n\n### v0.28.0 - 29th March 2021\n\n* Prebuilt binaries now include mozjpeg and libimagequant (BSD 2-Clause).\n\n* Prebuilt binaries limit AVIF support to the most common 8-bit depth.\n\n* Add `mozjpeg` option to `jpeg` method, sets mozjpeg defaults.\n\n* Reduce the default PNG `compressionLevel` to the more commonly used 6.\n\n* Reduce concurrency on glibc-based Linux when using the default memory allocator to help prevent fragmentation.\n\n* Default missing edge properties of extend operation to zero.\n  [#2578](https://github.com/lovell/sharp/issues/2578)\n\n* Ensure composite does not clip top and left offsets.\n  [#2594](https://github.com/lovell/sharp/pull/2594)\n  [@SHG42](https://github.com/SHG42)\n\n* Improve error handling of network failure at install time.\n  [#2608](https://github.com/lovell/sharp/pull/2608)\n  [@abradley](https://github.com/abradley)\n\n* Ensure `@id` attribute can be set for IIIF tile-based output.\n  [#2612](https://github.com/lovell/sharp/issues/2612)\n  [@edsilv](https://github.com/edsilv)\n\n* Ensure composite replicates the correct number of tiles for centred gravities.\n  [#2626](https://github.com/lovell/sharp/issues/2626)\n\n## v0.27 - *avif*\n\nRequires libvips v8.10.5\n\n### v0.27.2 - 22nd February 2021\n\n* macOS: Prevent use of globally-installed ARM64 libvips with Rosetta x64 emulation.\n  [#2460](https://github.com/lovell/sharp/issues/2460)\n\n* Linux (musl): Prevent use of prebuilt linuxmusl-x64 binaries with musl >= 1.2.0.\n  [#2570](https://github.com/lovell/sharp/issues/2570)\n\n* Improve 16-bit grey+alpha support by using libvips' `has_alpha` detection.\n  [#2569](https://github.com/lovell/sharp/issues/2569)\n\n* Allow the use of non lower case extensions with `toFormat`.\n  [#2581](https://github.com/lovell/sharp/pull/2581)\n  [@florian-busch](https://github.com/florian-busch)\n\n* Allow use of `recomb` operation with single channel input.\n  [#2584](https://github.com/lovell/sharp/issues/2584)\n\n### v0.27.1 - 27th January 2021\n\n* Ensure TIFF is cast when using float predictor.\n  [#2502](https://github.com/lovell/sharp/pull/2502)\n  [@randyridge](https://github.com/randyridge)\n\n* Add support for Uint8Array and Uint8ClampedArray input.\n  [#2511](https://github.com/lovell/sharp/pull/2511)\n  [@leon](https://github.com/leon)\n\n* Revert: ensure all platforms use fontconfig for font rendering.\n  [#2515](https://github.com/lovell/sharp/issues/2515)\n\n* Expose libvips gaussnoise operation to allow creation of Gaussian noise.\n  [#2527](https://github.com/lovell/sharp/pull/2527)\n  [@alza54](https://github.com/alza54)\n\n### v0.27.0 - 22nd December 2020\n\n* Add support for AVIF to prebuilt binaries.\n\n* Remove experimental status from `heif` output, defaults are now AVIF-centric.\n\n* Allow negative top/left offsets for composite operation.\n  [#2391](https://github.com/lovell/sharp/pull/2391)\n  [@CurosMJ](https://github.com/CurosMJ)\n\n* Ensure all platforms use fontconfig for font rendering.\n  [#2399](https://github.com/lovell/sharp/issues/2399)\n\n## v0.26 - *zoom*\n\nRequires libvips v8.10.0\n\n### v0.26.3 - 16th November 2020\n\n* Expose libvips' affine operation.\n  [#2336](https://github.com/lovell/sharp/pull/2336)\n  [@guillevc](https://github.com/guillevc)\n\n* Fallback to tar.gz for prebuilt libvips when Brotli not available.\n  [#2412](https://github.com/lovell/sharp/pull/2412)\n  [@ascorbic](https://github.com/ascorbic)\n\n### v0.26.2 - 14th October 2020\n\n* Add support for EXR input. Requires libvips compiled with OpenEXR.\n  [#698](https://github.com/lovell/sharp/issues/698)\n\n* Ensure support for yarn v2.\n  [#2379](https://github.com/lovell/sharp/pull/2379)\n  [@jalovatt](https://github.com/jalovatt)\n\n* Add centre/center option to tile-based output.\n  [#2397](https://github.com/lovell/sharp/pull/2397)\n  [@beig](https://github.com/beig)\n\n### v0.26.1 - 20th September 2020\n\n* Ensure correct pageHeight when verifying multi-page image dimensions.\n  [#2343](https://github.com/lovell/sharp/pull/2343)\n  [@derom](https://github.com/derom)\n\n* Allow input density range up to 100000 DPI.\n  [#2348](https://github.com/lovell/sharp/pull/2348)\n  [@stefanprobst](https://github.com/stefanprobst)\n\n* Ensure animation-related properties can be set for Stream-based input.\n  [#2369](https://github.com/lovell/sharp/pull/2369)\n  [@AcrylicShrimp](https://github.com/AcrylicShrimp)\n\n* Ensure `stats` can be calculated for 1x1 input.\n  [#2372](https://github.com/lovell/sharp/issues/2372)\n\n* Ensure animated GIF output is optimised.\n  [#2376](https://github.com/lovell/sharp/issues/2376)\n\n### v0.26.0 - 25th August 2020\n\n* Prebuilt libvips binaries are now statically-linked and Brotli-compressed, requiring Node.js 10.16.0+.\n\n* TIFF output `squash` is replaced by `bitdepth` to reduce to 1, 2 or 4 bit.\n\n* JPEG output `quality` >= 90 no longer automatically sets `chromaSubsampling` to `4:4:4`.\n\n* Add most `dominant` colour to image `stats`.\n  [#640](https://github.com/lovell/sharp/issues/640)\n\n* Add support for animated GIF (requires \\*magick) and WebP output.\n  [#2012](https://github.com/lovell/sharp/pull/2012)\n  [@deftomat](https://github.com/deftomat)\n\n* Add support for libvips ImageMagick v7 loaders.\n  [#2258](https://github.com/lovell/sharp/pull/2258)\n  [@vouillon](https://github.com/vouillon)\n\n* Allow multi-page input via \\*magick.\n  [#2259](https://github.com/lovell/sharp/pull/2259)\n  [@vouillon](https://github.com/vouillon)\n\n* Add support to `withMetadata` for custom ICC profile.\n  [#2271](https://github.com/lovell/sharp/pull/2271)\n  [@roborourke](https://github.com/roborourke)\n\n* Ensure prebuilt binaries for ARM default to v7 when using Electron.\n  [#2292](https://github.com/lovell/sharp/pull/2292)\n  [@diegodev3](https://github.com/diegodev3)\n\n## v0.25 - *yield*\n\nRequires libvips v8.9.1\n\n### v0.25.4 - 12th June 2020\n\n* Allow libvips binary location override where version is appended.\n  [#2217](https://github.com/lovell/sharp/pull/2217)\n  [@malice00](https://github.com/malice00)\n\n* Enable PNG palette when setting quality, colours, colors or dither.\n  [#2226](https://github.com/lovell/sharp/pull/2226)\n  [@romaleev](https://github.com/romaleev)\n\n* Add `level` constructor option to use a specific level of a multi-level image.\n  Expose `levels` metadata for multi-level images.\n  [#2222](https://github.com/lovell/sharp/issues/2222)\n\n* Add support for named `alpha` channel to `extractChannel` operation.\n  [#2138](https://github.com/lovell/sharp/issues/2138)\n\n* Add experimental `sharpness` calculation to `stats()` response.\n  [#2251](https://github.com/lovell/sharp/issues/2251)\n\n* Emit `warning` event for non-critical processing problems.\n  [#2032](https://github.com/lovell/sharp/issues/2032)\n\n### v0.25.3 - 17th May 2020\n\n* Ensure libvips is initialised only once, improves worker thread safety.\n  [#2143](https://github.com/lovell/sharp/issues/2143)\n\n* Ensure npm platform flag is respected when copying DLLs.\n  [#2188](https://github.com/lovell/sharp/pull/2188)\n  [@dimadeveatii](https://github.com/dimadeveatii)\n\n* Allow SVG input with large inline images to be parsed.\n  [#2195](https://github.com/lovell/sharp/issues/2195)\n\n### v0.25.2 - 20th March 2020\n\n* Provide prebuilt binaries for Linux ARM64v8.\n\n* Add IIIF layout support to tile-based output.\n  [#2098](https://github.com/lovell/sharp/pull/2098)\n  [@edsilv](https://github.com/edsilv)\n\n* Ensure input options are consistently and correctly detected.\n  [#2118](https://github.com/lovell/sharp/issues/2118)\n\n* Ensure N-API prebuilt binaries work on RHEL7 and its derivatives.\n  [#2119](https://github.com/lovell/sharp/issues/2119)\n\n* Ensure AsyncWorker options are persisted.\n  [#2130](https://github.com/lovell/sharp/issues/2130)\n\n### v0.25.1 - 7th March 2020\n\n* Ensure prebuilt binaries are fetched based on N-API version.\n  [#2117](https://github.com/lovell/sharp/issues/2117)\n\n### v0.25.0 - 7th March 2020\n\n* Remove `limitInputPixels` and `sequentialRead` previously deprecated in v0.24.0.\n\n* Migrate internals to N-API.\n  [#1282](https://github.com/lovell/sharp/issues/1282)\n\n* Add support for 32-bit Windows.\n  [#2088](https://github.com/lovell/sharp/issues/2088)\n\n* Ensure correct ordering of rotate-then-trim operations.\n  [#2087](https://github.com/lovell/sharp/issues/2087)\n\n* Ensure composite accepts `limitInputPixels` and `sequentialRead` input options.\n  [#2099](https://github.com/lovell/sharp/issues/2099)\n\n## v0.24 - \"*wit*\"\n\nRequires libvips v8.9.0.\n\n### v0.24.1 - 15<sup>th</sup> February 2020\n\n* Prevent use of sequentialRead for EXIF-based rotate operation.\n  [#2042](https://github.com/lovell/sharp/issues/2042)\n\n* Ensure RGBA LZW TIFF returns correct channel count.\n  [#2064](https://github.com/lovell/sharp/issues/2064)\n\n### v0.24.0 - 16<sup>th</sup> January 2020\n\n* Drop support for Node.js 8.\n  [#1910](https://github.com/lovell/sharp/issues/1910)\n\n* Drop support for undefined input where options also provided.\n  [#1768](https://github.com/lovell/sharp/issues/1768)\n\n* Move `limitInputPixels` and `sequentialRead` to input options, deprecating functions of the same name.\n\n* Expose `delay` and `loop` metadata for animated images.\n  [#1905](https://github.com/lovell/sharp/issues/1905)\n\n* Ensure correct colour output for 16-bit, 2-channel PNG input with ICC profile.\n  [#2013](https://github.com/lovell/sharp/issues/2013)\n\n* Prevent use of sequentialRead for rotate operations.\n  [#2016](https://github.com/lovell/sharp/issues/2016)\n\n* Correctly bind max width and height values when using withoutEnlargement.\n  [#2024](https://github.com/lovell/sharp/pull/2024)\n  [@BrychanOdlum](https://github.com/BrychanOdlum)\n\n* Add support for input with 16-bit RGB profile.\n  [#2037](https://github.com/lovell/sharp/issues/2037)\n\n## v0.23 - \"*vision*\"\n\nRequires libvips v8.8.1.\n\n### v0.23.4 - 5<sup>th</sup> December 2019\n\n* Handle zero-length Buffer objects when using Node.js v13.2.0+.\n\n* Expose raw TIFFTAG_PHOTOSHOP metadata.\n  [#1600](https://github.com/lovell/sharp/issues/1600)\n\n* Improve thread safety by using copy-on-write when updating metadata.\n  [#1986](https://github.com/lovell/sharp/issues/1986)\n\n### v0.23.3 - 17<sup>th</sup> November 2019\n\n* Ensure `trim` operation supports images contained in the alpha channel.\n  [#1597](https://github.com/lovell/sharp/issues/1597)\n\n* Ensure tile `overlap` option works as expected.\n  [#1921](https://github.com/lovell/sharp/pull/1921)\n  [@rustyguts](https://github.com/rustyguts)\n\n* Allow compilation on FreeBSD and variants (broken since v0.23.0)\n  [#1952](https://github.com/lovell/sharp/pull/1952)\n  [@pouya-eghbali](https://github.com/pouya-eghbali)\n\n* Ensure `modulate` and other colour-based operations can co-exist.\n  [#1958](https://github.com/lovell/sharp/issues/1958)\n\n### v0.23.2 - 28<sup>th</sup> October 2019\n\n* Add `background` option to tile output operation.\n  [#1924](https://github.com/lovell/sharp/pull/1924)\n  [@neave](https://github.com/neave)\n\n* Add support for Node.js 13.\n  [#1932](https://github.com/lovell/sharp/pull/1932)\n  [@MayhemYDG](https://github.com/MayhemYDG)\n\n### v0.23.1 - 26<sup>th</sup> September 2019\n\n* Ensure `sharp.format.vips` is present and correct (filesystem only).\n  [#1813](https://github.com/lovell/sharp/issues/1813)\n\n* Ensure invalid `width` and `height` provided as options to `resize` throw.\n  [#1817](https://github.com/lovell/sharp/issues/1817)\n\n* Allow use of 'heic' and 'heif' identifiers with `toFormat`.\n  [#1834](https://github.com/lovell/sharp/pull/1834)\n  [@jaubourg](https://github.com/jaubourg)\n\n* Add `premultiplied` option to `composite` operation.\n  [#1835](https://github.com/lovell/sharp/pull/1835)\n  [@Andargor](https://github.com/Andargor)\n\n* Allow instance reuse with differing `toBuffer` options.\n  [#1860](https://github.com/lovell/sharp/pull/1860)\n  [@RaboliotTheGrey](https://github.com/RaboliotTheGrey)\n\n* Ensure image is at least 3x3 pixels before attempting trim operation.\n\n### v0.23.0 - 29<sup>th</sup> July 2019\n\n* Remove `overlayWith` previously deprecated in v0.22.0.\n\n* Add experimental support for HEIF images. Requires libvips compiled with libheif.\n  [#1105](https://github.com/lovell/sharp/issues/1105)\n\n* Expose libwebp `smartSubsample` and `reductionEffort` options.\n  [#1545](https://github.com/lovell/sharp/issues/1545)\n\n* Add experimental support for Worker Threads.\n  [#1558](https://github.com/lovell/sharp/issues/1558)\n\n* Use libvips' built-in CMYK and sRGB profiles when required.\n  [#1619](https://github.com/lovell/sharp/issues/1619)\n\n* Drop support for Node.js versions 6 and 11.\n  [#1674](https://github.com/lovell/sharp/issues/1674)\n\n* Expose `skipBlanks` option for tile-based output.\n  [#1687](https://github.com/lovell/sharp/pull/1687)\n  [@RaboliotTheGrey](https://github.com/RaboliotTheGrey)\n\n* Allow use of `failOnError` option with Stream-based input.\n  [#1691](https://github.com/lovell/sharp/issues/1691)\n\n* Fix rotate/extract ordering for non-90 angles.\n  [#1755](https://github.com/lovell/sharp/pull/1755)\n  [@iovdin](https://github.com/iovdin)\n\n## v0.22 - \"*uptake*\"\n\nRequires libvips v8.7.4.\n\n### v0.22.1 - 25<sup>th</sup> April 2019\n\n* Add `modulate` operation for brightness, saturation and hue.\n  [#1601](https://github.com/lovell/sharp/pull/1601)\n  [@Goues](https://github.com/Goues)\n\n* Improve help messaging should `require(\"sharp\")` fail.\n  [#1638](https://github.com/lovell/sharp/pull/1638)\n  [@sidharthachatterjee](https://github.com/sidharthachatterjee)\n\n* Add support for Node 12.\n  [#1668](https://github.com/lovell/sharp/issues/1668)\n\n### v0.22.0 - 18<sup>th</sup> March 2019\n\n* Remove functions previously deprecated in v0.21.0:\n    `background`, `crop`, `embed`, `ignoreAspectRatio`, `max`, `min` and `withoutEnlargement`.\n\n* Add `composite` operation supporting multiple images and blend modes; deprecate `overlayWith`.\n  [#728](https://github.com/lovell/sharp/issues/728)\n\n* Add support for `pages` input option for multi-page input.\n  [#1566](https://github.com/lovell/sharp/issues/1566)\n\n* Allow Stream-based input of raw pixel data.\n  [#1579](https://github.com/lovell/sharp/issues/1579)\n\n* Add support for `page` input option to GIF and PDF.\n  [#1595](https://github.com/lovell/sharp/pull/1595)\n  [@ramiel](https://github.com/ramiel)\n\n## v0.21 - \"*teeth*\"\n\nRequires libvips v8.7.0.\n\n### v0.21.3 - 19<sup>th</sup> January 2019\n\n* Input image decoding now fails fast, set `failOnError` to change this behaviour.\n\n* Failed filesystem-based input now separates missing file and invalid format errors.\n  [#1542](https://github.com/lovell/sharp/issues/1542)\n\n### v0.21.2 - 13<sup>th</sup> January 2019\n\n* Ensure all metadata is removed from PNG output unless `withMetadata` used.\n\n* Ensure shortest edge is at least one pixel after resizing.\n  [#1003](https://github.com/lovell/sharp/issues/1003)\n\n* Add `ensureAlpha` operation to add an alpha channel, if missing.\n  [#1153](https://github.com/lovell/sharp/issues/1153)\n\n* Expose `pages` and `pageHeight` metadata for multi-page input images.\n  [#1205](https://github.com/lovell/sharp/issues/1205)\n\n* Expose PNG output options requiring libimagequant.\n  [#1484](https://github.com/lovell/sharp/issues/1484)\n\n* Expose underlying error message for invalid input.\n  [#1505](https://github.com/lovell/sharp/issues/1505)\n\n* Prevent mutatation of options passed to `jpeg`.\n  [#1516](https://github.com/lovell/sharp/issues/1516)\n\n* Ensure forced output format applied correctly when output chaining.\n  [#1528](https://github.com/lovell/sharp/issues/1528)\n\n### v0.21.1 - 7<sup>th</sup> December 2018\n\n* Install: support `sharp_dist_base_url` npm config, like existing `SHARP_DIST_BASE_URL`.\n  [#1422](https://github.com/lovell/sharp/pull/1422)\n  [@SethWen](https://github.com/SethWen)\n\n* Ensure `channel` metadata is correct for raw, greyscale output.\n  [#1425](https://github.com/lovell/sharp/issues/1425)\n\n* Add support for the \"mitchell\" kernel for image reductions.\n  [#1438](https://github.com/lovell/sharp/pull/1438)\n  [@Daiz](https://github.com/Daiz)\n\n* Allow separate parameters for gamma encoding and decoding.\n  [#1439](https://github.com/lovell/sharp/pull/1439)\n  [@Daiz](https://github.com/Daiz)\n\n* Build prototype with `Object.assign` to allow minification.\n  [#1475](https://github.com/lovell/sharp/pull/1475)\n  [@jaubourg](https://github.com/jaubourg)\n\n* Expose libvips' recombination matrix operation.\n  [#1477](https://github.com/lovell/sharp/pull/1477)\n  [@fromkeith](https://github.com/fromkeith)\n\n* Expose libvips' pyramid/tile options for TIFF output.\n  [#1483](https://github.com/lovell/sharp/pull/1483)\n  [@mbklein](https://github.com/mbklein)\n\n### v0.21.0 - 4<sup>th</sup> October 2018\n\n* Deprecate the following resize-related functions:\n    `crop`, `embed`, `ignoreAspectRatio`, `max`, `min` and `withoutEnlargement`.\n  Access to these is now via options passed to the `resize` function.\n  For example:\n    `embed('north')` is now `resize(width, height, { fit: 'contain', position: 'north' })`,\n    `crop('attention')` is now `resize(width, height, { fit: 'cover', position: 'attention' })`,\n    `max().withoutEnlargement()` is now `resize(width, height, { fit: 'inside', withoutEnlargement: true })`.\n  [#1135](https://github.com/lovell/sharp/issues/1135)\n\n* Deprecate the `background` function.\n    Per-operation `background` options added to `resize`, `extend` and `flatten` operations.\n  [#1392](https://github.com/lovell/sharp/issues/1392)\n\n* Add `size` to `metadata` response (Stream and Buffer input only).\n  [#695](https://github.com/lovell/sharp/issues/695)\n\n* Switch from custom trim operation to `vips_find_trim`.\n  [#914](https://github.com/lovell/sharp/issues/914)\n\n* Add `chromaSubsampling` and `isProgressive` properties to `metadata` response.\n  [#1186](https://github.com/lovell/sharp/issues/1186)\n\n* Drop Node 4 support.\n  [#1212](https://github.com/lovell/sharp/issues/1212)\n\n* Enable SIMD convolution by default.\n  [#1213](https://github.com/lovell/sharp/issues/1213)\n\n* Add experimental prebuilt binaries for musl-based Linux.\n  [#1379](https://github.com/lovell/sharp/issues/1379)\n\n* Add support for arbitrary rotation angle via vips_rotate.\n  [#1385](https://github.com/lovell/sharp/pull/1385)\n  [@freezy](https://github.com/freezy)\n\n## v0.20 - \"*prebuild*\"\n\nRequires libvips v8.6.1.\n\n### v0.20.8 - 5<sup>th</sup> September 2018\n\n* Avoid race conditions when creating directories during installation.\n  [#1358](https://github.com/lovell/sharp/pull/1358)\n  [@ajhool](https://github.com/ajhool)\n\n* Accept floating point values for input density parameter.\n  [#1362](https://github.com/lovell/sharp/pull/1362)\n  [@aeirola](https://github.com/aeirola)\n\n### v0.20.7 - 21<sup>st</sup> August 2018\n\n* Use copy+unlink if rename operation fails during installation.\n  [#1345](https://github.com/lovell/sharp/issues/1345)\n\n### v0.20.6 - 20<sup>th</sup> August 2018\n\n* Add removeAlpha operation to remove alpha channel, if any.\n  [#1248](https://github.com/lovell/sharp/issues/1248)\n\n* Expose mozjpeg quant_table flag.\n  [#1285](https://github.com/lovell/sharp/pull/1285)\n  [@rexxars](https://github.com/rexxars)\n\n* Allow full WebP alphaQuality range of 0-100.\n  [#1290](https://github.com/lovell/sharp/pull/1290)\n  [@sylvaindumont](https://github.com/sylvaindumont)\n\n* Cache libvips binaries to reduce re-install time.\n  [#1301](https://github.com/lovell/sharp/issues/1301)\n\n* Ensure vendor platform mismatch throws error at install time.\n  [#1303](https://github.com/lovell/sharp/issues/1303)\n\n* Improve install time error messages for FreeBSD users.\n  [#1310](https://github.com/lovell/sharp/issues/1310)\n\n* Ensure extractChannel works with 16-bit images.\n  [#1330](https://github.com/lovell/sharp/issues/1330)\n\n* Expose depth option for tile-based output.\n  [#1342](https://github.com/lovell/sharp/pull/1342)\n  [@alundavies](https://github.com/alundavies)\n\n* Add experimental entropy field to stats response.\n\n### v0.20.5 - 27<sup>th</sup> June 2018\n\n* Expose libjpeg optimize_coding flag.\n  [#1265](https://github.com/lovell/sharp/pull/1265)\n  [@tomlokhorst](https://github.com/tomlokhorst)\n\n### v0.20.4 - 20<sup>th</sup> June 2018\n\n* Prevent possible rounding error when using shrink-on-load and 90/270 degree rotation.\n  [#1241](https://github.com/lovell/sharp/issues/1241)\n  [@anahit42](https://github.com/anahit42)\n\n* Ensure extractChannel sets correct single-channel colour space interpretation.\n  [#1257](https://github.com/lovell/sharp/issues/1257)\n  [@jeremychone](https://github.com/jeremychone)\n\n### v0.20.3 - 29<sup>th</sup> May 2018\n\n* Fix tint operation by ensuring LAB interpretation and allowing negative values.\n  [#1235](https://github.com/lovell/sharp/issues/1235)\n  [@wezside](https://github.com/wezside)\n\n### v0.20.2 - 28<sup>th</sup> April 2018\n\n* Add tint operation to set image chroma.\n  [#825](https://github.com/lovell/sharp/pull/825)\n  [@rikh42](https://github.com/rikh42)\n\n* Add environment variable to ignore globally-installed libvips.\n  [#1165](https://github.com/lovell/sharp/pull/1165)\n  [@oncletom](https://github.com/oncletom)\n\n* Add support for page selection with multi-page input (GIF/TIFF).\n  [#1204](https://github.com/lovell/sharp/pull/1204)\n  [@woolite64](https://github.com/woolite64)\n\n* Add support for Group4 (CCITTFAX4) compression with TIFF output.\n  [#1208](https://github.com/lovell/sharp/pull/1208)\n  [@woolite64](https://github.com/woolite64)\n\n### v0.20.1 - 17<sup>th</sup> March 2018\n\n* Improve installation experience when a globally-installed libvips below the minimum required version is found.\n  [#1148](https://github.com/lovell/sharp/issues/1148)\n\n* Prevent smartcrop error when cumulative rounding is below target size.\n  [#1154](https://github.com/lovell/sharp/issues/1154)\n  [@ralrom](https://github.com/ralrom)\n\n* Expose libvips' median filter operation.\n  [#1161](https://github.com/lovell/sharp/pull/1161)\n  [@BiancoA](https://github.com/BiancoA)\n\n### v0.20.0 - 5<sup>th</sup> March 2018\n\n* Add support for prebuilt sharp binaries on common platforms.\n  [#186](https://github.com/lovell/sharp/issues/186)\n\n## v0.19 - \"*suit*\"\n\nRequires libvips v8.6.1.\n\n### v0.19.1 - 24<sup>th</sup> February 2018\n\n* Expose libvips' linear transform feature.\n  [#1024](https://github.com/lovell/sharp/pull/1024)\n  [@3epnm](https://github.com/3epnm)\n\n* Expose angle option for tile-based output.\n  [#1121](https://github.com/lovell/sharp/pull/1121)\n  [@BiancoA](https://github.com/BiancoA)\n\n* Prevent crop operation when image already at or below target dimensions.\n  [#1134](https://github.com/lovell/sharp/issues/1134)\n  [@pieh](https://github.com/pieh)\n\n### v0.19.0 - 11<sup>th</sup> January 2018\n\n* Expose offset coordinates of strategy-based crop.\n  [#868](https://github.com/lovell/sharp/issues/868)\n  [@mirohristov-com](https://github.com/mirohristov-com)\n\n* PNG output now defaults to adaptiveFiltering=false, compressionLevel=9\n  [#872](https://github.com/lovell/sharp/issues/872)\n  [@wmertens](https://github.com/wmertens)\n\n* Add stats feature for pixel-derived image statistics.\n  [#915](https://github.com/lovell/sharp/pull/915)\n  [@rnanwani](https://github.com/rnanwani)\n\n* Add failOnError option to fail-fast on bad input image data.\n  [#976](https://github.com/lovell/sharp/pull/976)\n  [@mceachen](https://github.com/mceachen)\n\n* Resize: switch to libvips' implementation, make fastShrinkOnLoad optional, remove interpolator and centreSampling options.\n  [#977](https://github.com/lovell/sharp/pull/977)\n  [@jardakotesovec](https://github.com/jardakotesovec)\n\n* Attach finish event listener to a clone only for Stream-based input.\n  [#995](https://github.com/lovell/sharp/issues/995)\n  [@whmountains](https://github.com/whmountains)\n\n* Add tilecache before smartcrop to avoid over-computation of previous operations.\n  [#1028](https://github.com/lovell/sharp/issues/1028)\n  [@coffeebite](https://github.com/coffeebite)\n\n* Prevent toFile extension taking precedence over requested format.\n  [#1037](https://github.com/lovell/sharp/issues/1037)\n  [@tomgallagher](https://github.com/tomgallagher)\n\n* Add support for gravity option to existing embed feature.\n  [#1038](https://github.com/lovell/sharp/pull/1038)\n  [@AzureByte](https://github.com/AzureByte)\n\n* Expose IPTC and XMP metadata when available.\n  [#1079](https://github.com/lovell/sharp/pull/1079)\n  [@oaleynik](https://github.com/oaleynik)\n\n* TIFF output: switch default predictor from 'none' to 'horizontal' to match libvips' behaviour.\n\n## v0.18 - \"*ridge*\"\n\nRequires libvips v8.5.5.\n\n### v0.18.4 - 18<sup>th</sup> September 2017\n\n* Ensure input Buffer really is marked as Persistent, prevents mark-sweep GC.\n  [#950](https://github.com/lovell/sharp/issues/950)\n  [@lfdoherty](https://github.com/lfdoherty)\n\n### v0.18.3 - 13<sup>th</sup> September 2017\n\n* Skip shrink-on-load when trimming.\n  [#888](https://github.com/lovell/sharp/pull/888)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Migrate from got to simple-get for basic auth support.\n  [#945](https://github.com/lovell/sharp/pull/945)\n  [@pbomb](https://github.com/pbomb)\n\n### v0.18.2 - 1<sup>st</sup> July 2017\n\n* Expose libvips' xres and yres properties for TIFF output.\n  [#828](https://github.com/lovell/sharp/pull/828)\n  [@YvesBos](https://github.com/YvesBos)\n\n* Ensure flip and flop operations work with auto-rotate.\n  [#837](https://github.com/lovell/sharp/issues/837)\n  [@rexxars](https://github.com/rexxars)\n\n* Allow binary download URL override via SHARP_DIST_BASE_URL env variable.\n  [#841](https://github.com/lovell/sharp/issues/841)\n\n* Add support for Solus Linux.\n  [#857](https://github.com/lovell/sharp/pull/857)\n  [@ekremkaraca](https://github.com/ekremkaraca)\n\n### v0.18.1 - 30<sup>th</sup> May 2017\n\n* Remove regression from #781 that could cause incorrect shrink calculation.\n  [#831](https://github.com/lovell/sharp/issues/831)\n  [@suprMax](https://github.com/suprMax)\n\n### v0.18.0 - 30<sup>th</sup> May 2017\n\n* Remove the previously-deprecated output format \"option\" functions:\n    quality, progressive, compressionLevel, withoutAdaptiveFiltering,\n    withoutChromaSubsampling, trellisQuantisation, trellisQuantization,\n    overshootDeringing, optimiseScans and optimizeScans.\n\n* Ensure maximum output dimensions are based on the format to be used.\n  [#176](https://github.com/lovell/sharp/issues/176)\n  [@stephanebachelier](https://github.com/stephanebachelier)\n\n* Avoid costly (un)premultiply when using overlayWith without alpha channel.\n  [#573](https://github.com/lovell/sharp/issues/573)\n  [@strarsis](https://github.com/strarsis)\n\n* Include pixel depth (e.g. \"uchar\") when reading metadata.\n  [#577](https://github.com/lovell/sharp/issues/577)\n  [@moedusa](https://github.com/moedusa)\n\n* Add support for Buffer and Stream-based TIFF output.\n  [#587](https://github.com/lovell/sharp/issues/587)\n  [@strarsis](https://github.com/strarsis)\n\n* Expose warnings from libvips via NODE_DEBUG=sharp environment variable.\n  [#607](https://github.com/lovell/sharp/issues/607)\n  [@puzrin](https://github.com/puzrin)\n\n* Switch to the libvips implementation of \"attention\" and \"entropy\" crop strategies.\n  [#727](https://github.com/lovell/sharp/issues/727)\n\n* Improve performance and accuracy of nearest neighbour integral upsampling.\n  [#752](https://github.com/lovell/sharp/issues/752)\n  [@MrIbby](https://github.com/MrIbby)\n\n* Constructor single argument API: allow plain object, reject null/undefined.\n  [#768](https://github.com/lovell/sharp/issues/768)\n  [@kub1x](https://github.com/kub1x)\n\n* Ensure ARM64 pre-built binaries use correct C++11 ABI version.\n  [#772](https://github.com/lovell/sharp/issues/772)\n  [@ajiratech2](https://github.com/ajiratech2)\n\n* Prevent aliasing by using dynamic values for shrink(-on-load).\n  [#781](https://github.com/lovell/sharp/issues/781)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Expose libvips' \"squash\" parameter to enable 1-bit TIFF output.\n  [#783](https://github.com/lovell/sharp/pull/783)\n  [@YvesBos](https://github.com/YvesBos)\n\n* Add support for rotation using any multiple of +/-90 degrees.\n  [#791](https://github.com/lovell/sharp/pull/791)\n  [@ncoden](https://github.com/ncoden)\n\n* Add \"jpg\" alias to toFormat as shortened form of \"jpeg\".\n  [#814](https://github.com/lovell/sharp/pull/814)\n  [@jingsam](https://github.com/jingsam)\n\n## v0.17 - \"*quill*\"\n\nRequires libvips v8.4.2.\n\n### v0.17.3 - 1<sup>st</sup> April 2017\n\n* Allow toBuffer to optionally resolve a Promise with both info and data.\n  [#143](https://github.com/lovell/sharp/issues/143)\n  [@salzhrani](https://github.com/salzhrani)\n\n* Create blank image of given width, height, channels and background.\n  [#470](https://github.com/lovell/sharp/issues/470)\n  [@pjarts](https://github.com/pjarts)\n\n* Add support for the \"nearest\" kernel for image reductions.\n  [#732](https://github.com/lovell/sharp/pull/732)\n  [@alice0meta](https://github.com/alice0meta)\n\n* Add support for TIFF compression and predictor options.\n  [#738](https://github.com/lovell/sharp/pull/738)\n  [@kristojorg](https://github.com/kristojorg)\n\n### v0.17.2 - 11<sup>th</sup> February 2017\n\n* Ensure Readable side of Stream can start flowing after Writable side has finished.\n  [#671](https://github.com/lovell/sharp/issues/671)\n  [@danhaller](https://github.com/danhaller)\n\n* Expose WebP alpha quality, lossless and near-lossless output options.\n  [#685](https://github.com/lovell/sharp/pull/685)\n  [@rnanwani](https://github.com/rnanwani)\n\n### v0.17.1 - 15<sup>th</sup> January 2017\n\n* Improve error messages for invalid parameters.\n  [@spikeon](https://github.com/spikeon)\n  [#644](https://github.com/lovell/sharp/pull/644)\n\n* Simplify expression for finding vips-cpp libdir.\n  [#656](https://github.com/lovell/sharp/pull/656)\n\n* Allow HTTPS-over-HTTP proxy when downloading pre-compiled dependencies.\n  [@wangzhiwei1888](https://github.com/wangzhiwei1888)\n  [#679](https://github.com/lovell/sharp/issues/679)\n\n### v0.17.0 - 11<sup>th</sup> December 2016\n\n* Drop support for versions of Node prior to v4.\n\n* Deprecate the following output format \"option\" functions:\n    quality, progressive, compressionLevel, withoutAdaptiveFiltering,\n    withoutChromaSubsampling, trellisQuantisation, trellisQuantization,\n    overshootDeringing, optimiseScans and optimizeScans.\n  Access to these is now via output format functions, for example `quality(n)`\n    is now `jpeg({quality: n})` and/or `webp({quality: n})`.\n\n* Autoconvert GIF and SVG input to PNG output if no other format is specified.\n\n* Expose libvips' \"centre\" resize option to mimic \\*magick's +0.5px convention.\n  [#568](https://github.com/lovell/sharp/issues/568)\n\n* Ensure support for embedded base64 PNG and JPEG images within an SVG.\n  [#601](https://github.com/lovell/sharp/issues/601)\n  [@dynamite-ready](https://github.com/dynamite-ready)\n\n* Ensure premultiply operation occurs before box filter shrink.\n  [#605](https://github.com/lovell/sharp/issues/605)\n  [@CmdrShepardsPie](https://github.com/CmdrShepardsPie)\n  [@teroparvinen](https://github.com/teroparvinen)\n\n* Add support for PNG and WebP tile-based output formats (in addition to JPEG).\n  [#622](https://github.com/lovell/sharp/pull/622)\n  [@ppaskaris](https://github.com/ppaskaris)\n\n* Allow use of extend with greyscale input.\n  [#623](https://github.com/lovell/sharp/pull/623)\n  [@ppaskaris](https://github.com/ppaskaris)\n\n* Allow non-RGB input to embed/extend onto background with an alpha channel.\n  [#646](https://github.com/lovell/sharp/issues/646)\n  [@DaGaMs](https://github.com/DaGaMs)\n\n## v0.16 - \"*pencil*\"\n\nRequires libvips v8.3.3\n\n### v0.16.2 - 22<sup>nd</sup> October 2016\n\n* Restrict readelf usage to Linux only when detecting global libvips version.\n  [#602](https://github.com/lovell/sharp/issues/602)\n  [@caoko](https://github.com/caoko)\n\n### v0.16.1 - 13<sup>th</sup> October 2016\n\n* C++11 ABI version is now auto-detected, remove sharp-cxx11 installation flag.\n\n* Add experimental 'attention' crop strategy.\n  [#295](https://github.com/lovell/sharp/issues/295)\n\n* Include .node extension for Meteor's require() implementation.\n  [#537](https://github.com/lovell/sharp/issues/537)\n  [@isjackwild](https://github.com/isjackwild)\n\n* Ensure convolution kernel scale is clamped to a minimum value of 1.\n  [#561](https://github.com/lovell/sharp/issues/561)\n  [@abagshaw](https://github.com/abagshaw)\n\n* Correct calculation of y-axis placement when overlaying image at a fixed point.\n  [#566](https://github.com/lovell/sharp/issues/566)\n  [@Nateowami](https://github.com/Nateowami)\n\n### v0.16.0 - 18<sup>th</sup> August 2016\n\n* Add pre-compiled libvips for OS X, ARMv7 and ARMv8.\n  [#312](https://github.com/lovell/sharp/issues/312)\n\n* Ensure boolean, bandbool, extractChannel ops occur before sRGB conversion.\n  [#504](https://github.com/lovell/sharp/pull/504)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Recalculate factors after WebP shrink-on-load to avoid round-to-zero errors.\n  [#508](https://github.com/lovell/sharp/issues/508)\n  [@asilvas](https://github.com/asilvas)\n\n* Prevent boolean errors during extract operation.\n  [#511](https://github.com/lovell/sharp/pull/511)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Add joinChannel and toColourspace/toColorspace operations.\n  [#513](https://github.com/lovell/sharp/pull/513)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Add support for raw pixel data with boolean and withOverlay operations.\n  [#516](https://github.com/lovell/sharp/pull/516)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Prevent bandbool creating a single channel sRGB image.\n  [#519](https://github.com/lovell/sharp/pull/519)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Ensure ICC profiles are removed from PNG output unless withMetadata used.\n  [#521](https://github.com/lovell/sharp/issues/521)\n  [@ChrisPinewood](https://github.com/ChrisPinewood)\n\n* Add alpha channels, if missing, to overlayWith images.\n  [#540](https://github.com/lovell/sharp/pull/540)\n  [@cmtt](https://github.com/cmtt)\n\n* Remove deprecated interpolateWith method - use resize(w, h, { interpolator: ... })\n  [#310](https://github.com/lovell/sharp/issues/310)\n\n## v0.15 - \"*outfit*\"\n\nRequires libvips v8.3.1\n\n### v0.15.1 - 12<sup>th</sup> July 2016\n\n* Concat Stream-based input in single operation for ~+3% perf and less GC.\n  [#429](https://github.com/lovell/sharp/issues/429)\n  [@papandreou](https://github.com/papandreou)\n\n* Add alpha channel, if required, before extend operation.\n  [#439](https://github.com/lovell/sharp/pull/439)\n  [@frulo](https://github.com/frulo)\n\n* Allow overlay image to be repeated across entire image via tile option.\n  [#443](https://github.com/lovell/sharp/pull/443)\n  [@lemnisk8](https://github.com/lemnisk8)\n\n* Add cutout option to overlayWith feature, applies only the alpha channel of the overlay image.\n  [#448](https://github.com/lovell/sharp/pull/448)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Ensure scaling factors are calculated independently to prevent rounding errors.\n  [#452](https://github.com/lovell/sharp/issues/452)\n  [@puzrin](https://github.com/puzrin)\n\n* Add --sharp-cxx11 flag to compile with gcc's new C++11 ABI.\n  [#456](https://github.com/lovell/sharp/pull/456)\n  [@kapouer](https://github.com/kapouer)\n\n* Add top/left offset support to overlayWith operation.\n  [#473](https://github.com/lovell/sharp/pull/473)\n  [@rnanwani](https://github.com/rnanwani)\n\n* Add convolve operation for kernel-based convolution.\n  [#479](https://github.com/lovell/sharp/pull/479)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Add greyscale option to threshold operation for colourspace conversion control.\n  [#480](https://github.com/lovell/sharp/pull/480)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Ensure ICC profiles are licenced for distribution.\n  [#486](https://github.com/lovell/sharp/issues/486)\n  [@kapouer](https://github.com/kapouer)\n\n* Allow images with an alpha channel to work with LAB-colourspace based sharpen.\n  [#490](https://github.com/lovell/sharp/issues/490)\n  [@jwagner](https://github.com/jwagner)\n\n* Add trim operation to remove \"boring\" edges.\n  [#492](https://github.com/lovell/sharp/pull/492)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Add bandbool feature for channel-wise boolean operations.\n  [#496](https://github.com/lovell/sharp/pull/496)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Add extractChannel operation to extract a channel from an image.\n  [#497](https://github.com/lovell/sharp/pull/497)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Add ability to read and write native libvips .v files.\n  [#500](https://github.com/lovell/sharp/pull/500)\n  [@mhirsch](https://github.com/mhirsch)\n\n* Add boolean feature for bitwise image operations.\n  [#501](https://github.com/lovell/sharp/pull/501)\n  [@mhirsch](https://github.com/mhirsch)\n\n### v0.15.0 - 21<sup>st</sup> May 2016\n\n* Use libvips' new Lanczos 3 kernel as default for image reduction.\n  Deprecate interpolateWith method, now provided as a resize option.\n  [#310](https://github.com/lovell/sharp/issues/310)\n  [@jcupitt](https://github.com/jcupitt)\n\n* Take advantage of libvips v8.3 features.\n  Add support for libvips' new GIF and SVG loaders.\n  Pre-built binaries now include giflib and librsvg, exclude *magick.\n  Use shrink-on-load for WebP input.\n  Break existing sharpen API to accept sigma and improve precision.\n  [#369](https://github.com/lovell/sharp/issues/369)\n\n* Remove unnecessary (un)premultiply operations when not resizing/compositing.\n  [#413](https://github.com/lovell/sharp/issues/413)\n  [@jardakotesovec](https://github.com/jardakotesovec)\n\n## v0.14 - \"*needle*\"\n\nRequires libvips v8.2.3\n\n### v0.14.1 - 16<sup>th</sup> April 2016\n\n* Allow removal of limitation on input pixel count via limitInputPixels. Use with care.\n  [#250](https://github.com/lovell/sharp/issues/250)\n  [#316](https://github.com/lovell/sharp/pull/316)\n  [@anandthakker](https://github.com/anandthakker)\n  [@kentongray](https://github.com/kentongray)\n\n* Use final output image for metadata passed to callback.\n  [#399](https://github.com/lovell/sharp/pull/399)\n  [@salzhrani](https://github.com/salzhrani)\n\n* Add support for writing tiled images to a zip container.\n  [#402](https://github.com/lovell/sharp/pull/402)\n  [@felixbuenemann](https://github.com/felixbuenemann)\n\n* Allow use of embed with 1 and 2 channel images.\n  [#411](https://github.com/lovell/sharp/issues/411)\n  [@janaz](https://github.com/janaz)\n\n* Improve Electron compatibility by allowing node-gyp rebuilds without npm.\n  [#412](https://github.com/lovell/sharp/issues/412)\n  [@nouh](https://github.com/nouh)\n\n### v0.14.0 - 2<sup>nd</sup> April 2016\n\n* Add ability to extend (pad) the edges of an image.\n  [#128](https://github.com/lovell/sharp/issues/128)\n  [@blowsie](https://github.com/blowsie)\n\n* Add support for Zoomify and Google tile layouts. Breaks existing tile API.\n  [#223](https://github.com/lovell/sharp/issues/223)\n  [@bdunnette](https://github.com/bdunnette)\n\n* Improvements to overlayWith: differing sizes/formats, gravity, buffer input.\n  [#239](https://github.com/lovell/sharp/issues/239)\n  [@chrisriley](https://github.com/chrisriley)\n\n* Add entropy-based crop strategy to remove least interesting edges.\n  [#295](https://github.com/lovell/sharp/issues/295)\n  [@rightaway](https://github.com/rightaway)\n\n* Expose density metadata; set density of images from vector input.\n  [#338](https://github.com/lovell/sharp/issues/338)\n  [@lookfirst](https://github.com/lookfirst)\n\n* Emit post-processing 'info' event for Stream output.\n  [#367](https://github.com/lovell/sharp/issues/367)\n  [@salzhrani](https://github.com/salzhrani)\n\n* Ensure output image EXIF Orientation values are within 1-8 range.\n  [#385](https://github.com/lovell/sharp/pull/385)\n  [@jtobinisaniceguy](https://github.com/jtobinisaniceguy)\n\n* Ensure ratios are not swapped when rotating 90/270 and ignoring aspect.\n  [#387](https://github.com/lovell/sharp/issues/387)\n  [@kleisauke](https://github.com/kleisauke)\n\n* Remove deprecated style of calling extract API. Breaks calls using positional arguments.\n  [#276](https://github.com/lovell/sharp/issues/276)\n\n## v0.13 - \"*mind*\"\n\nRequires libvips v8.2.2\n\n### v0.13.1 - 27<sup>th</sup> February 2016\n\n* Fix embedding onto transparent backgrounds; regression introduced in v0.13.0.\n  [#366](https://github.com/lovell/sharp/issues/366)\n  [@diegocsandrim](https://github.com/diegocsandrim)\n\n### v0.13.0 - 15<sup>th</sup> February 2016\n\n* Improve vector image support by allowing control of density/DPI.\n  Switch pre-built libs from Imagemagick to Graphicsmagick.\n  [#110](https://github.com/lovell/sharp/issues/110)\n  [@bradisbell](https://github.com/bradisbell)\n\n* Add support for raw, uncompressed pixel Buffer/Stream input.\n  [#220](https://github.com/lovell/sharp/issues/220)\n  [@mikemorris](https://github.com/mikemorris)\n\n* Switch from libvips' C to C++ bindings, requires upgrade to v8.2.2.\n  [#299](https://github.com/lovell/sharp/issues/299)\n\n* Control number of open files in libvips' cache; breaks existing `cache` behaviour.\n  [#315](https://github.com/lovell/sharp/issues/315)\n  [@impomezia](https://github.com/impomezia)\n\n* Ensure 16-bit input images can be normalised and embedded onto transparent backgrounds.\n  [#339](https://github.com/lovell/sharp/issues/339)\n  [#340](https://github.com/lovell/sharp/issues/340)\n  [@janaz](https://github.com/janaz)\n\n* Ensure selected format takes precedence over any unknown output filename extension.\n  [#344](https://github.com/lovell/sharp/issues/344)\n  [@ubaltaci](https://github.com/ubaltaci)\n\n* Add support for libvips' PBM, PGM, PPM and FITS image format loaders.\n  [#347](https://github.com/lovell/sharp/issues/347)\n  [@oaleynik](https://github.com/oaleynik)\n\n* Ensure default crop gravity is center/centre.\n  [#351](https://github.com/lovell/sharp/pull/351)\n  [@joelmukuthu](https://github.com/joelmukuthu)\n\n* Improve support for musl libc systems e.g. Alpine Linux.\n  [#354](https://github.com/lovell/sharp/issues/354)\n  [#359](https://github.com/lovell/sharp/pull/359)\n  [@download13](https://github.com/download13)\n  [@wjordan](https://github.com/wjordan)\n\n* Small optimisation when reducing by an integral factor to favour shrink over affine.\n\n* Add support for gamma correction of images with an alpha channel.\n\n## v0.12 - \"*look*\"\n\nRequires libvips v8.2.0\n\n### v0.12.2 - 16<sup>th</sup> January 2016\n\n* Upgrade libvips to v8.2.0 for improved vips_shrink.\n\n* Add pre-compiled libvips for ARMv6+ CPUs.\n\n* Ensure 16-bit input images work with embed option.\n  [#325](https://github.com/lovell/sharp/issues/325)\n  [@janaz](https://github.com/janaz)\n\n* Allow compilation with gmake to provide FreeBSD support.\n  [#326](https://github.com/lovell/sharp/issues/326)\n  [@c0decafe](https://github.com/c0decafe)\n\n* Attempt to remove temporary file after installation.\n  [#331](https://github.com/lovell/sharp/issues/331)\n  [@dtoubelis](https://github.com/dtoubelis)\n\n### v0.12.1 - 12<sup>th</sup> December 2015\n\n* Allow use of SIMD vector instructions (via liborc) to be toggled on/off.\n  [#172](https://github.com/lovell/sharp/issues/172)\n  [@bkw](https://github.com/bkw)\n  [@puzrin](https://github.com/puzrin)\n\n* Ensure embedded ICC profiles output with perceptual intent.\n  [#321](https://github.com/lovell/sharp/issues/321)\n  [@vlapo](https://github.com/vlapo)\n\n* Use the NPM-configured HTTPS proxy, if any, for binary downloads.\n\n### v0.12.0 - 23<sup>rd</sup> November 2015\n\n* Bundle pre-compiled libvips and its dependencies for 64-bit Linux and Windows.\n  [#42](https://github.com/lovell/sharp/issues/42)\n\n* Take advantage of libvips v8.1.0+ features.\n  [#152](https://github.com/lovell/sharp/issues/152)\n\n* Add support for 64-bit Windows. Drop support for 32-bit Windows.\n  [#224](https://github.com/lovell/sharp/issues/224)\n  [@sabrehagen](https://github.com/sabrehagen)\n\n* Switch default interpolator to bicubic.\n  [#289](https://github.com/lovell/sharp/issues/289)\n  [@mahnunchik](https://github.com/mahnunchik)\n\n* Pre-extract rotatation should not swap width/height.\n  [#296](https://github.com/lovell/sharp/issues/296)\n  [@asilvas](https://github.com/asilvas)\n\n* Ensure 16-bit+alpha input images are (un)premultiplied correctly.\n  [#301](https://github.com/lovell/sharp/issues/301)\n  [@izaakschroeder](https://github.com/izaakschroeder)\n\n* Add `threshold` operation.\n  [#303](https://github.com/lovell/sharp/pull/303)\n  [@dacarley](https://github.com/dacarley)\n\n* Add `negate` operation.\n  [#306](https://github.com/lovell/sharp/pull/306)\n  [@dacarley](https://github.com/dacarley)\n\n* Support `options` Object with existing `extract` operation.\n  [#309](https://github.com/lovell/sharp/pull/309)\n  [@papandreou](https://github.com/papandreou)\n\n## v0.11 - \"*knife*\"\n\n### v0.11.4 - 5<sup>th</sup> November 2015\n\n* Add corners, e.g. `northeast`, to existing `gravity` option.\n  [#291](https://github.com/lovell/sharp/pull/291)\n  [@brandonaaron](https://github.com/brandonaaron)\n\n* Ensure correct auto-rotation for EXIF Orientation values 2 and 4.\n  [#288](https://github.com/lovell/sharp/pull/288)\n  [@brandonaaron](https://github.com/brandonaaron)\n\n* Make static linking possible via `--runtime_link` install option.\n  [#287](https://github.com/lovell/sharp/pull/287)\n  [@vlapo](https://github.com/vlapo)\n\n### v0.11.3 - 8<sup>th</sup> September 2015\n\n* Intrepret blurSigma, sharpenFlat, and sharpenJagged as double precision.\n  [#263](https://github.com/lovell/sharp/pull/263)\n  [@chrisriley](https://github.com/chrisriley)\n\n### v0.11.2 - 28<sup>th</sup> August 2015\n\n* Allow crop gravity to be provided as a String.\n  [#255](https://github.com/lovell/sharp/pull/255)\n  [@papandreou](https://github.com/papandreou)\n* Add support for io.js v3 and Node v4.\n  [#246](https://github.com/lovell/sharp/issues/246)\n\n### v0.11.1 - 12<sup>th</sup> August 2015\n\n* Silence MSVC warning: \"C4530: C++ exception handler used, but unwind semantics are not enabled\".\n  [#244](https://github.com/lovell/sharp/pull/244)\n  [@TheThing](https://github.com/TheThing)\n\n* Suppress gamma correction for input image with alpha transparency.\n  [#249](https://github.com/lovell/sharp/issues/249)\n  [@compeak](https://github.com/compeak)\n\n### v0.11.0 - 15<sup>th</sup> July 2015\n\n* Allow alpha transparency compositing via new `overlayWith` method.\n  [#97](https://github.com/lovell/sharp/issues/97)\n  [@gasi](https://github.com/gasi)\n\n* Expose raw ICC profile data as a Buffer when using `metadata`.\n  [#129](https://github.com/lovell/sharp/issues/129)\n  [@homerjam](https://github.com/homerjam)\n\n* Allow image header updates via a parameter passed to existing `withMetadata` method.\n  Provide initial support for EXIF `Orientation` tag,\n  which if present is now removed when using `rotate`, `flip` or `flop`.\n  [#189](https://github.com/lovell/sharp/issues/189)\n  [@h2non](https://github.com/h2non)\n\n* Tighten constructor parameter checks.\n  [#221](https://github.com/lovell/sharp/issues/221)\n  [@mikemorris](https://github.com/mikemorris)\n\n* Allow one input Stream to be shared with two or more output Streams via new `clone` method.\n  [#235](https://github.com/lovell/sharp/issues/235)\n  [@jaubourg](https://github.com/jaubourg)\n\n* Use `round` instead of `floor` when auto-scaling dimensions to avoid floating-point rounding errors.\n  [#238](https://github.com/lovell/sharp/issues/238)\n  [@richardadjogah](https://github.com/richardadjogah)\n\n## v0.10 - \"*judgment*\"\n\n### v0.10.1 - 1<sup>st</sup> June 2015\n\n* Allow embed of image with alpha transparency onto non-transparent background.\n  [#204](https://github.com/lovell/sharp/issues/204)\n  [@mikemliu](https://github.com/mikemliu)\n\n* Include C standard library for `atoi` as Xcode 6.3 appears to no longer do this.\n  [#228](https://github.com/lovell/sharp/issues/228)\n  [@doggan](https://github.com/doggan)\n\n### v0.10.0 - 23<sup>rd</sup> April 2015\n\n* Add support for Windows (x86).\n  [#19](https://github.com/lovell/sharp/issues/19)\n  [@DullReferenceException](https://github.com/DullReferenceException)\n  [@itsananderson](https://github.com/itsananderson)\n\n* Add support for Openslide input and DeepZoom output.\n  [#146](https://github.com/lovell/sharp/issues/146)\n  [@mvictoras](https://github.com/mvictoras)\n\n* Allow arbitrary aspect ratios when resizing images via new `ignoreAspectRatio` method.\n  [#192](https://github.com/lovell/sharp/issues/192)\n  [@skedastik](https://github.com/skedastik)\n\n* Enhance output image contrast by stretching its luminance to cover the full dynamic range via new `normalize` method.\n  [#194](https://github.com/lovell/sharp/issues/194)\n  [@bkw](https://github.com/bkw)\n  [@codingforce](https://github.com/codingforce)\n", "'use strict';\n\nconst fs = require('fs');\nconst os = require('os');\nconst path = require('path');\nconst spawnSync = require('child_process').spawnSync;\nconst semverCoerce = require('semver/functions/coerce');\nconst semverGreaterThanOrEqualTo = require('semver/functions/gte');\n\nconst platform = require('./platform');\nconst { config } = require('../package.json');\n\nconst env = process.env;\nconst minimumLibvipsVersionLabelled = env.npm_package_config_libvips || /* istanbul ignore next */\n  config.libvips;\nconst minimumLibvipsVersion = semverCoerce(minimumLibvipsVersionLabelled).version;\n\nconst spawnSyncOptions = {\n  encoding: 'utf8',\n  shell: true\n};\n\nconst vendorPath = path.join(__dirname, '..', 'vendor', minimumLibvipsVersion, platform());\n\nconst mkdirSync = function (dirPath) {\n  try {\n    fs.mkdirSync(dirPath, { recursive: true });\n  } catch (err) {\n    /* istanbul ignore next */\n    if (err.code !== 'EEXIST') {\n      throw err;\n    }\n  }\n};\n\nconst cachePath = function () {\n  const npmCachePath = env.npm_config_cache || /* istanbul ignore next */\n    (env.APPDATA ? path.join(env.APPDATA, 'npm-cache') : path.join(os.homedir(), '.npm'));\n  mkdirSync(npmCachePath);\n  const libvipsCachePath = path.join(npmCachePath, '_libvips');\n  mkdirSync(libvipsCachePath);\n  return libvipsCachePath;\n};\n\nconst integrity = function (platformAndArch) {\n  return env[`npm_package_config_integrity_${platformAndArch.replace('-', '_')}`] || config.integrity[platformAndArch];\n};\n\nconst log = function (item) {\n  if (item instanceof Error) {\n    console.error(`sharp: Installation error: ${item.message}`);\n  } else {\n    console.log(`sharp: ${item}`);\n  }\n};\n\nconst isRosetta = function () {\n  /* istanbul ignore next */\n  if (process.platform === 'darwin' && process.arch === 'x64') {\n    const translated = spawnSync('sysctl sysctl.proc_translated', spawnSyncOptions).stdout;\n    return (translated || '').trim() === 'sysctl.proc_translated: 1';\n  }\n  return false;\n};\n\nconst globalLibvipsVersion = function () {\n  if (process.platform !== 'win32') {\n    const globalLibvipsVersion = spawnSync('pkg-config --modversion vips-cpp', {\n      ...spawnSyncOptions,\n      env: {\n        PKG_CONFIG_PATH: pkgConfigPath()\n      }\n    }).stdout;\n    /* istanbul ignore next */\n    return (globalLibvipsVersion || '').trim();\n  } else {\n    return '';\n  }\n};\n\nconst hasVendoredLibvips = function () {\n  return fs.existsSync(vendorPath);\n};\n\n/* istanbul ignore next */\nconst removeVendoredLibvips = function () {\n  const rm = fs.rmSync ? fs.rmSync : fs.rmdirSync;\n  rm(vendorPath, { recursive: true, maxRetries: 3, force: true });\n};\n\nconst pkgConfigPath = function () {\n  if (process.platform !== 'win32') {\n    const brewPkgConfigPath = spawnSync(\n      'which brew >/dev/null 2>&1 && brew environment --plain | grep PKG_CONFIG_LIBDIR | cut -d\" \" -f2',\n      spawnSyncOptions\n    ).stdout || '';\n    return [\n      brewPkgConfigPath.trim(),\n      env.PKG_CONFIG_PATH,\n      '/usr/local/lib/pkgconfig',\n      '/usr/lib/pkgconfig',\n      '/usr/local/libdata/pkgconfig',\n      '/usr/libdata/pkgconfig'\n    ].filter(Boolean).join(':');\n  } else {\n    return '';\n  }\n};\n\nconst useGlobalLibvips = function () {\n  if (Boolean(env.SHARP_IGNORE_GLOBAL_LIBVIPS) === true) {\n    return false;\n  }\n  /* istanbul ignore next */\n  if (isRosetta()) {\n    return false;\n  }\n  const globalVipsVersion = globalLibvipsVersion();\n  return !!globalVipsVersion && /* istanbul ignore next */\n    semverGreaterThanOrEqualTo(globalVipsVersion, minimumLibvipsVersion);\n};\n\nmodule.exports = {\n  minimumLibvipsVersion,\n  minimumLibvipsVersionLabelled,\n  cachePath,\n  integrity,\n  log,\n  globalLibvipsVersion,\n  hasVendoredLibvips,\n  removeVendoredLibvips,\n  pkgConfigPath,\n  useGlobalLibvips,\n  mkdirSync\n};\n"], "filenames": ["docs/changelog.md", "lib/libvips.js"], "buggy_code_start_loc": [7, 68], "buggy_code_end_loc": [7, 89], "fixing_code_start_loc": [8, 68], "fixing_code_end_loc": [11, 97], "type": "CWE-77", "message": "sharp is an application for Node.js image processing. Prior to version 0.30.5, there is a possible vulnerability in logic that is run only at `npm install` time when installing versions of `sharp` prior to the latest v0.30.5. If an attacker has the ability to set the value of the `PKG_CONFIG_PATH` environment variable in a build environment then they might be able to use this to inject an arbitrary command at `npm install` time. This is not part of any runtime code, does not affect Windows users at all, and is unlikely to affect anyone that already cares about the security of their build environment. This problem is fixed in version 0.30.5.", "other": {"cve": {"id": "CVE-2022-29256", "sourceIdentifier": "security-advisories@github.com", "published": "2022-05-25T22:15:08.307", "lastModified": "2022-06-07T15:28:22.820", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "sharp is an application for Node.js image processing. Prior to version 0.30.5, there is a possible vulnerability in logic that is run only at `npm install` time when installing versions of `sharp` prior to the latest v0.30.5. If an attacker has the ability to set the value of the `PKG_CONFIG_PATH` environment variable in a build environment then they might be able to use this to inject an arbitrary command at `npm install` time. This is not part of any runtime code, does not affect Windows users at all, and is unlikely to affect anyone that already cares about the security of their build environment. This problem is fixed in version 0.30.5."}, {"lang": "es", "value": "sharp es una aplicaci\u00f3n para el procesamiento de im\u00e1genes en Node.js. En versiones anteriores a 0.30.5, se presenta una posible vulnerabilidad en la l\u00f3gica que es ejecutada s\u00f3lo en el momento de \"npm install\" cuando son instaladas versiones de \"sharp\" anteriores a la \u00faltima v0.30.5. Si un atacante presenta la capacidad de establecer el valor de la variable de entorno \"PKG_CONFIG_PATH\" en un entorno de construcci\u00f3n, entonces podr\u00eda ser capaz de usar esto para inyectar un comando arbitrario en el momento de \"npm install\". Esto no es parte de ning\u00fan c\u00f3digo en tiempo de ejecuci\u00f3n, no afecta a usuarios de Windows en absoluto, y es poco probable que afecte a cualquier persona que ya se preocupa por la seguridad de su entorno de construcci\u00f3n. Este problema ha sido corregido en versi\u00f3n 0.30.5"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:H/UI:R/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.6, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 4.6}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.9, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-77"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-77"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sharp_project:sharp:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "0.30.5", "matchCriteriaId": "9BE0607B-F1FD-445C-A1BB-447B38FF35EB"}]}]}], "references": [{"url": "https://github.com/lovell/sharp/commit/a6aeef612be50f5868a77481848b1de674216f0c", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/lovell/sharp/security/advisories/GHSA-gp95-ppv5-3jc5", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/lovell/sharp/commit/a6aeef612be50f5868a77481848b1de674216f0c"}}