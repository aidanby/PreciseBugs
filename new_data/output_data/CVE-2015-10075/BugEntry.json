{"buggy_code": ["<?php\n/*\n * Plugin Name: Custom Content Width\n * Plugin URI: http://wordpress.org/plugins/custom-content-width/\n * Description: Adds a 'Custom Content Width' setting to the Settings > Media screen, to let users override their theme's content width.\n * Author: George Stephanis\n * Version: 1.0\n * Author URI: http://stephanis.info/\n */\n\nclass Stephanis_Custom_Content_Width {\n\tstatic $instance;\n\n\tfunction __construct() {\n\t\tself::$instance = $this;\n\t\tadd_action( 'init', array( $this, 'override_content_width' ) );\n\t\tadd_action( 'admin_init', array( $this, 'register_settings' ) );\n\t}\n\n\tfunction override_content_width() {\n\t\tglobal $content_width;\n\n\t\tif( ! empty( $content_width ) )\n\t\t\t$this->original_content_width = $content_width;\n\n\t\tif( $custom_content_width = get_option( 'custom_content_width' ) )\n\t\t\t$content_width = $custom_content_width;\n\t}\n\n\tfunction register_settings() {\n\t\tregister_setting( 'media', 'custom_content_width', 'intval' );\n\t\t$label = __('Custom Content Width', 'custom_content_width' );\n\t\tadd_settings_field( 'custom_content_width', \"<label for='custom_content_width'>{$label}</label>\" , array( $this, 'custom_content_width_cb' ) , 'media' );\n\t}\n\n\tfunction custom_content_width_cb() {\n\t\t$value = get_option( 'custom_content_width' );\n\t\t?>\n\t\t<input type=\"number\" class=\"small-text\" min=\"0\" id=\"custom_content_width\" name=\"custom_content_width\" value=\"<?php echo $value ? $value : ''; ?>\" />\n\t\t<label for=\"custom_content_width\">px</label>\n\t\t<?php if( ! empty( $this->original_content_width ) ): ?>\n\t\t\t<?php if( $value ): ?>\n\t\t\t\t<small><a href=\"javascript:;\" onclick=\"jQuery('#custom_content_width').val('');\"><?php _e('clear custom value', 'custom_content_width'); ?></a></small>\n\t\t\t<?php endif; ?>\n\t\t\t<br /><em><?php printf( __('Your theme&rsquo;s default content width is %s pixels.', 'custom_content_width'), $this->original_content_width ); ?></em>\n\t\t<?php endif;\n\t}\n}\nnew Stephanis_Custom_Content_Width;\n", "=== Custom Content Width ===\nContributors: georgestephanis\nDonate link: https://www.charitywater.org/donate\nTags: Theme, Content Width\nRequires at least: 2.7\nTested up to: 3.6\nStable tag: 1.0\nLicense: GPLv2 or later\nLicense URI: http://www.gnu.org/licenses/gpl-2.0.html\n\nAdds a 'Custom Content Width' setting to the Settings > Media screen, to let users override their theme's content width.\n\n== Description ==\n\nOccasionally, themes forget to set the `$content_width` variable in functions.php.  If they forgot, or if you'd like to change the value that they've set, this will let you in your Settings > Media screen.\n\n== Installation ==\n\n1. Install and activate the plugin via the WordPress Plugin Installer.\n2. Go to the Settings > Media screen, and set the Content Width!\n3. There is no step three!\n\n== Changelog ==\n\n= 1.0 =\n* Initial release.\n"], "fixing_code": ["<?php\n/*\n * Plugin Name: Custom Content Width\n * Plugin URI: http://wordpress.org/plugins/custom-content-width/\n * Description: Adds a 'Custom Content Width' setting to the Settings > Media screen, to let users override their theme's content width.\n * Author: George Stephanis\n * Version: 1.0.1\n * Author URI: http://stephanis.info/\n */\n\nclass Stephanis_Custom_Content_Width {\n\tstatic $instance;\n\n\tfunction __construct() {\n\t\tself::$instance = $this;\n\t\tadd_action( 'init', array( $this, 'override_content_width' ) );\n\t\tadd_action( 'admin_init', array( $this, 'register_settings' ) );\n\t}\n\n\tfunction override_content_width() {\n\t\tglobal $content_width;\n\n\t\tif( ! empty( $content_width ) )\n\t\t\t$this->original_content_width = $content_width;\n\n\t\tif( $custom_content_width = get_option( 'custom_content_width' ) )\n\t\t\t$content_width = absint( $custom_content_width );\n\t}\n\n\tfunction register_settings() {\n\t\tregister_setting( 'media', 'custom_content_width', 'intval' );\n\t\t$label = __('Custom Content Width', 'custom_content_width' );\n\t\tadd_settings_field( 'custom_content_width', \"<label for='custom_content_width'>{$label}</label>\" , array( $this, 'custom_content_width_cb' ) , 'media' );\n\t}\n\n\tfunction custom_content_width_cb() {\n\t\t$value = get_option( 'custom_content_width' );\n\t\t?>\n\t\t<input type=\"number\" class=\"small-text\" min=\"0\" id=\"custom_content_width\" name=\"custom_content_width\" value=\"<?php echo $value ? absint( $value ) : ''; ?>\" />\n\t\t<label for=\"custom_content_width\">px</label>\n\t\t<?php if( ! empty( $this->original_content_width ) ): ?>\n\t\t\t<?php if( $value ): ?>\n\t\t\t\t<small><a href=\"javascript:;\" onclick=\"jQuery('#custom_content_width').val('');\"><?php _e('clear custom value', 'custom_content_width'); ?></a></small>\n\t\t\t<?php endif; ?>\n\t\t\t<br /><em><?php printf( __('Your theme&rsquo;s default content width is %s pixels.', 'custom_content_width'), absint( $this->original_content_width ) ); ?></em>\n\t\t<?php endif;\n\t}\n}\nnew Stephanis_Custom_Content_Width;\n", "=== Custom Content Width ===\nContributors: georgestephanis\nDonate link: https://www.charitywater.org/donate\nTags: Theme, Content Width\nRequires at least: 2.7\nTested up to: 4.1\nStable tag: 1.0.1\nLicense: GPLv2 or later\nLicense URI: http://www.gnu.org/licenses/gpl-2.0.html\n\nAdds a 'Custom Content Width' setting to the Settings > Media screen, to let users override their theme's content width.\n\n== Description ==\n\nOccasionally, themes forget to set the `$content_width` variable in functions.php.  If they forgot, or if you'd like to change the value that they've set, this will let you in your Settings > Media screen.\n\n== Installation ==\n\n1. Install and activate the plugin via the WordPress Plugin Installer.\n2. Go to the Settings > Media screen, and set the Content Width!\n3. There is no step three!\n\n== Changelog ==\n\n= 1.0.1 =\n* Validate width values to avoid unlikely security vulnerabilities.\n\n= 1.0 =\n* Initial release.\n"], "filenames": ["custom-content-width.php", "readme.txt"], "buggy_code_start_loc": [7, 6], "buggy_code_end_loc": [46, 24], "fixing_code_start_loc": [7, 6], "fixing_code_end_loc": [46, 28], "type": "CWE-79", "message": "A vulnerability was found in Custom-Content-Width 1.0. It has been declared as problematic. Affected by this vulnerability is the function override_content_width/register_settings of the file custom-content-width.php. The manipulation leads to cross site scripting. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 1.0.1 is able to address this issue. The name of the patch is e05e0104fc42ad13b57e2b2cb2d1857432624d39. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-220219. NOTE: This attack is not very likely.", "other": {"cve": {"id": "CVE-2015-10075", "sourceIdentifier": "cna@vuldb.com", "published": "2023-02-07T12:15:08.653", "lastModified": "2023-02-14T23:31:14.650", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in Custom-Content-Width 1.0. It has been declared as problematic. Affected by this vulnerability is the function override_content_width/register_settings of the file custom-content-width.php. The manipulation leads to cross site scripting. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 1.0.1 is able to address this issue. The name of the patch is e05e0104fc42ad13b57e2b2cb2d1857432624d39. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-220219. NOTE: This attack is not very likely."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 2.6, "baseSeverity": "LOW"}, "exploitabilityScore": 1.2, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:H/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "HIGH", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 2.1}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:custom-content-width_project:custom-content-width:1.0:*:*:*:*:wordpress:*:*", "matchCriteriaId": "F61D7C4C-ABC1-41BD-8B7D-2E75733A7785"}]}]}], "references": [{"url": "https://github.com/georgestephanis/Custom-Content-Width/commit/e05e0104fc42ad13b57e2b2cb2d1857432624d39", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.220219", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.220219", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/georgestephanis/Custom-Content-Width/commit/e05e0104fc42ad13b57e2b2cb2d1857432624d39"}}