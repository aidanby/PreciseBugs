{"buggy_code": ["---------------------------------------------------------------------------\nVersion 5.7.6  [V5-BETA] (rgerhards), 2011-02-??\n- bugfix: memory leak when $RepeatedMsgReduction on was used\n  bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=225\n---------------------------------------------------------------------------\nVersion 5.7.5  [V5-BETA] (rgerhards), 2011-02-23\n- enhance: imfile did not yet support multiple rulesets, now added\n  we do this directly in the beta because a) it does not affect existing\n  functionality and b) one may argue that this missing functionality is\n  close to a bug.\n- improved testbench, added tests for imuxsock\n- bugfix: imuxsock did no longer sanitize received messages\n  This was a regression from the imuxsock partial rewrite. Happened\n  because the message is no longer run through the standard parsers. \n  bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=224\n- bugfix: minor race condition in action.c - considered cosmetic\n  This is considered cosmetic as multiple threads tried to write exactly\n  the same value into the same memory location without sync. The method\n  has been changed so this can no longer happen.\n---------------------------------------------------------------------------\nVersion 5.7.4  [V5-BETA] (rgerhards), 2011-02-17\n- added pmsnare parser module (written by David Lang)\n- enhanced imfile to support non-cancel input termination\n- improved systemd socket activation thanks to Marius Tomaschweski\n- improved error reporting for $WorkDirectory\n  non-existance and other detectable problems are now reported,\n  and the work directory is NOT set in this case\n- bugfix: pmsnare causded abort under some conditions\n- bugfix: abort if imfile reads file line of more than 64KiB\n  Thanks to Peter Eisentraut for reporting and analysing this problem.\n  bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=221\n- bugfix: queue engine did not properly slow down inputs in FULL_DELAY mode\n  when in disk-assisted mode. This especially affected imfile, which\n  created unnecessarily queue files if a large set of input file data was\n  to process.\n- bugfix: very long running actions could prevent shutdown under some\n  circumstances. This has now been solved, at least for common\n  situations.\n- bugfix: fixed compile problem due to empty structs\n  this occured only on some platforms/compilers. thanks to Dra\u017een Ka\u010dar \n  for the fix\n---------------------------------------------------------------------------\nVersion 5.7.3  [V5-BETA] (rgerhards), 2011-02-07\n- added support for processing multi-line messages in imfile\n- added $IMUDPSchedulingPolicy and $IMUDPSchedulingPriority config settings\n- added $LocalHostName config directive\n- bugfix: fixed build problems on some platforms\n  namely those that have 32bit atomic operations but not 64 bit ones\n- bugfix: local hostname was pulled too-early, so that some config \n  directives (namely FQDN settings) did not have any effect\n- bugfix: imfile did duplicate messages under some circumstances\n- added $OMMySQLConfigFile config directive\n- added $OMMySQLConfigSection config directive\n---------------------------------------------------------------------------\nVersion 5.7.2  [V5-DEVEL] (rgerhards), 2010-11-26\n- bugfix(important): problem in TLS handling could cause rsyslog to loop\n  in a tight loop, effectively disabling functionality and bearing the\n  risk of unresponsiveness of the whole system.\n  Bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=194\n- bugfix: imfile state file was not written when relative file name\n  for it was specified\n- bugfix: compile failed on systems without epoll_create1()\n  Thanks to David Hill for providing a fix.\n- bugfix: atomic increment for msg object may not work correct on all\n  platforms. Thanks to Chris Metcalf for the patch\n- bugfix: replacements for atomic operations for non-int sized types had\n  problems. At least one instance of that problem could potentially lead\n  to abort (inside omfile).\n---------------------------------------------------------------------------\nVersion 5.7.1  [V5-DEVEL] (rgerhards), 2010-10-05\n- support for Hadoop's HDFS added (via omhdfs)\n- imuxsock now optionally use SCM_CREDENTIALS to pull the pid from the log\n  socket itself\n  (thanks to Lennart Poettering for the suggesting this feature)\n- imuxsock now optionally uses per-process input rate limiting, guarding the\n  user against processes spamming the system log\n  (thanks to Lennart Poettering for suggesting this feature)\n- added new config statements\n  * $InputUnixListenSocketUsePIDFromSystem \n  * $SystemLogUsePIDFromSystem \n  * $SystemLogRateLimitInterval\n  * $SystemLogRateLimitBurst\n  * $SystemLogRateLimitSeverity\n  * $IMUxSockRateLimitInterval\n  * $IMUxSockRateLimitBurst\n  * $IMUxSockRateLimitSeverity\n- imuxsock now supports up to 50 different sockets for input\n- some code cleanup in imuxsock (consider this a release a major\n  modification, especially if problems show up)\n- bugfix: /dev/log was unlinked even when passed in from systemd\n  in which case it should be preserved as systemd owns it\n---------------------------------------------------------------------------\nVersion 5.7.0  [V5-DEVEL] (rgerhards), 2010-09-16\n- added module impstat to emit periodic statistics on rsyslog counters\n- support for systemd officially added\n  * acquire /dev/log socket optionally from systemd\n    thanks to Lennart Poettering for this patch\n  * sd-systemd API added as part of rsyslog runtime library\n---------------------------------------------------------------------------\nVersion 5.6.4  [V5-STABLE] (rgerhards), 2011-02-25\n- bugfix: memory leak when $RepeatedMsgReduction on was used\n  bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=225\n---------------------------------------------------------------------------\nVersion 5.6.3  [V5-STABLE] (rgerhards), 2011-01-26\n- bugfix: action processor released memory too early, resulting in\n  potential issue in retry cases (but very unlikely due to another\n  bug, which I also fixed -- only after the fix this problem here\n  became actually visible).\n- bugfix: batch processing flagged invalid message as \"bad\" under some\n  circumstances\n- bugfix: unitialized variable could cause issues under extreme conditions\n  plus some minor nits. This was found after a clang static code analyzer\n  analysis (great tool, and special thanks to Marcin for telling me about\n  it!)\n- bugfix: batches which had actions in error were not properly retried in\n  all cases\n- bugfix: imfile did duplicate messages under some circumstances\n- bugfix: testbench was not activated if no Java was present on system\n  ... what actually was a left-over. Java is no longer required.\n---------------------------------------------------------------------------\nVersion 5.6.2  [V5-STABLE] (rgerhards), 2010-11-30\n- bugfix: compile failed on systems without epoll_create1()\n  Thanks to David Hill for providing a fix.\n- bugfix: atomic increment for msg object may not work correct on all\n  platforms. Thanks to Chris Metcalf for the patch\n- bugfix: replacements for atomic operations for non-int sized types had\n  problems. At least one instance of that problem could potentially lead\n  to abort (inside omfile).\n- added the $InputFilePersistStateInterval config directive to imfile\n- changed imfile so that the state file is never deleted (makes imfile\n  more robust in regard to fatal failures)\n---------------------------------------------------------------------------\nVersion 5.6.1  [V5-STABLE] (rgerhards), 2010-11-24\n- bugfix(important): problem in TLS handling could cause rsyslog to loop\n  in a tight loop, effectively disabling functionality and bearing the\n  risk of unresponsiveness of the whole system.\n  Bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=194\n- permitted imptcp to work on systems which support epoll(), but not\n  epoll_create().\n  Bug: http://bugzilla.adiscon.com/show_bug.cgi?id=204\n  Thanks to Nicholas Brink for reporting this problem.\n- bugfix: testbench failed if imptcp was not enabled\n- bugfix: segfault when an *empty* template was used\n  Bug: http://bugzilla.adiscon.com/show_bug.cgi?id=206\n  Thanks to David Hill for alerting us.\n- bugfix: compile failed with --enable-unlimited-select\n  thanks varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 5.6.0  [V5-STABLE] (rgerhards), 2010-10-19\n\nThis release brings all changes and enhancements of the 5.5.x series\nto the v5-stable branch.\n\n- bugfix: a couple of problems that imfile had on some platforms, namely\n  Ubuntu (not their fault, but occured there)\n- bugfix: imfile utilizes 32 bit to track offset. Most importantly,\n  this problem can not experienced on Fedora 64 bit OS (which has\n  64 bit long's!)\n---------------------------------------------------------------------------\nVersion 5.5.7  [V5-BETA] (rgerhards), 2010-08-09\n- changed omudpspoof default spoof address to simplify typical use case\n  thanks to David Lang for suggesting this\n- doc bugfix: pmlastmsg doc samples had errors\n- bugfix[minor]: pmrfc3164sd had invalid name (resided in rsyslog name \n  space, what should not be the case for a contributed module)\n- added omuxsock, which permits to write message to local Unix sockets\n  this is the counterpart to imuxsock, enabling fast local forwarding\n---------------------------------------------------------------------------\nVersion 5.5.6  [DEVEL] (rgerhards), 2010-07-21\n- added parser modules\n  * pmlastmsg, which supports the notoriously malformed \"last message\n    repeated n times\" messages from some syslogd's (namely sysklogd)\n  * pmrfc3164sd (contributed), supports RFC5424 structured data in \n    RFC3164 messages [untested]\n- added new module type \"string generator\", used to speed up output\n  processing. Expected speedup for (typical) rsyslog processing is\n  roughly 5 to 6 percent compared to using string-based templates.\n  They may also be used to do more complex formatting with custom\n  C code, what provided greater flexibility and probably far higher\n  speed, for example if using multiple regular expressions within a \n  template.\n- added 4 string generators for\n  * RSYSLOG_FileFormat\n  * RSYSLOG_TraditionalFileFormat\n  * RSYSLOG_ForwardFormat\n  * RSYSLOG_TraditionalForwardFormat\n- bugfix: mutexes used to simulate atomic instructions were not destructed\n- bugfix: regression caused more locking action in msg.c than necessary\n- bugfix: \"$ActionExecOnlyWhenPreviousIsSuspended on\" was broken\n- bugfix: segfault on HUP when \"HUPIsRestart\" was set to \"on\"\n  thanks varmojfekoj for the patch\n- bugfix: default for $OMFileFlushOnTXEnd was wrong (\"off\").\n  This, in default mode, caused buffered writing to be used, what\n  means that it looked like no output were written or partial\n  lines. Thanks to Michael Biebl for pointing out this bug.\n- bugfix: programname filter in ! configuration can not be reset\n  Thanks to Kiss Gabor for the patch.\n---------------------------------------------------------------------------\nVersion 5.5.5  [DEVEL] (rgerhards), 2010-05-20\n- added new cancel-reduced action thread termination method\n  We now manage to cancel threads that block inside a retry loop to\n  terminate without the need to cancel the thread. Avoiding cancellation\n  helps keep the system complexity minimal and thus provides for better\n  stability. This also solves some issues with improper shutdown when\n  inside an action retry loop.\n---------------------------------------------------------------------------\nVersion 5.5.4  [DEVEL] (rgerhards), 2010-05-03\n- This version offers full support for Solaris on Intel and Sparc\n- bugfix: problems with atomic operations emulation\n  replaced atomic operation emulation with new code. The previous code\n  seemed to have some issue and also limited concurrency severely. The\n  whole atomic operation emulation has been rewritten.\n- bugfix: netstream ptcp support class was not correctly build on systems\n  without epoll() support\n- bugfix: segfault on Solaris/Sparc\n---------------------------------------------------------------------------\nVersion 5.5.3  [DEVEL] (rgerhards), 2010-04-09\n- added basic but functional support for Solaris\n- imported many bugfixes from 3.6.2/4.6.1 (see ChangeLog below!)\n- added new property replacer option \"date-rfc3164-buggyday\" primarily\n  to ease migration from syslog-ng. See property replacer doc for\n  details.\n- added capability to turn off standard LF delimiter in TCP server\n  via new directive \"$InputTCPServerDisableLFDelimiter on\"\n- bugfix: failed to compile on systems without epoll support\n- bugfix: comment char ('#') in literal terminated script parsing\n  and thus could not be used.\n  but tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=119\n  [merged in from v3.22.2]\n- imported patches from 4.6.0:\n  * improved testbench to contain samples for totally malformed messages\n    which miss parts of the message content\n  * bugfix: some malformed messages could lead to a missing LF inside files\n    or some other missing parts of the template content.\n  * bugfix: if a message ended immediately with a hostname, the hostname\n    was mistakenly interpreted as TAG, and localhost be used as hostname\n---------------------------------------------------------------------------\nVersion 5.5.2  [DEVEL] (rgerhards), 2010-02-05\n- applied patches that make rsyslog compile under Apple OS X.\n  Thanks to trey for providing these.\n- replaced data type \"bool\" by \"sbool\" because this created some\n  portability issues.\n- added $Escape8BitCharactersOnReceive directive\n  Thanks to David Lang for suggesting it.\n- worked around an issue where omfile failed to compile on 32 bit platforms\n  under some circumstances (this smells like a gcc problem, but a simple\n  solution was available). Thanks to Kenneth Marshall for some advice.\n- extended testbench\n---------------------------------------------------------------------------\nVersion 5.5.1  [DEVEL] (rgerhards), 2009-11-27\n- introduced the ablity for netstream drivers to utilize an epoll interface\n  This offers increased performance and removes the select() FDSET size\n  limit from imtcp. Note that we fall back to select() if there is no\n  epoll netstream drivers. So far, an epoll driver has only been\n  implemented for plain tcp syslog, the rest will follow once the code\n  proves well in practice AND there is demand.\n- re-implemented $EscapeControlCharacterTab config directive\n  Based on Jonathan Bond-Caron's patch for v4. This now also includes some\n  automatted tests.\n- bugfix: enabling GSSServer crashes rsyslog startup\n  Thanks to Tomas Kubina for the patch [imgssapi]\n- bugfix (kind of): check if TCP connection is still alive if using TLS\n  Thanks to Jonathan Bond-Caron for the patch.\n---------------------------------------------------------------------------\nVersion 5.5.0  [DEVEL] (rgerhards), 2009-11-18\n- moved DNS resolution code out of imudp and into the backend processing\n  Most importantly, DNS resolution now never happens if the resolved name\n  is not required. Note that this applies to imudp - for the other inputs,\n  DNS resolution almost comes for free, so we do not do it there. However,\n  the new method has been implemented in a generic way and as such may \n  also be used by other modules in the future.\n- added option to use unlimited-size select() calls\n  Thanks to varmjofekoj for the patch\n  This is not done in imudp, as it natively supports epoll().\n- doc: improved description of what loadable modules can do\n---------------------------------------------------------------------------\nVersion 5.4.2  [v5-stable] (rgerhards), 2010-03-??\n- bugfix(kind of): output plugin retry behaviour could cause engine to loop\n  The rsyslog engine did not guard itself against output modules that do\n  not properly convey back the tryResume() behaviour. This then leads to\n  what looks like an endless loop. I consider this to be a bug of the \n  engine not only because it should be hardened against plugin misbehaviour,\n  but also because plugins may not be totally able to avoid this situation\n  (depending on the type of and processing done by the plugin).\n- bugfix: testbench failed when not executed in UTC+1 timezone\n  accidently, the time zone information was kept inside some\n  to-be-checked-for responses\n- temporary bugfix replaced by permanent one for\n  message-induced off-by-one error (potential segfault) (see 4.6.2)\n  The analysis has been completed and a better fix been crafted and \n  integrated.\n- bugfix(minor): status variable was uninitialized\n  However, this would have caused harm only if NO parser modules at\n  all were loaded, which would lead to a defunctional configuration\n  at all. And, even more important, this is impossible as two parser\n  modules are built-in and thus can not be \"not loaded\", so we always\n  have a minimum of two.\n---------------------------------------------------------------------------\nVersion 5.4.1  [v5-stable] (rgerhards), 2010-03-??\n- added new property replacer option \"date-rfc3164-buggyday\" primarily\n  to ease migration from syslog-ng. See property replacer doc for\n  details. [backport from 5.5.3 because urgently needed by some]\n- imported all bugfixes vom 4.6.2 (see below)\n---------------------------------------------------------------------------\nVersion 5.4.0  [v5-stable] (rgerhards), 2010-03-08\n***************************************************************************\n* This is a new stable v5 version. It contains all fixes and enhancements *\n* made during the 5.3.x phase as well as those listed below.              *\n* Note that the 5.2.x series was quite buggy and as such all users are    *\n* strongly advised to upgrade to 5.4.0.                                   *\n***************************************************************************\n- bugfix: omruleset failed to work in many cases\n  bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=179\n  Thanks to Ryan B. Lynch for reporting this issue.\n- bugfix: comment char ('#') in literal terminated script parsing\n  and thus could not be used.\n  but tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=119\n  [merged in from v3.22.2]\n---------------------------------------------------------------------------\nVersion 5.3.7  [BETA] (rgerhards), 2010-01-27\n- bugfix: queues in direct mode could case a segfault, especially if an\n  action failed for action queues. The issue was an invalid increment of\n  a stack-based pointer which lead to destruction of the stack frame and\n  thus a segfault on function return.\n  Thanks to Michael Biebl for alerting us on this problem.\n- bugfix: hostname accidently set to IP address for some message sources,\n  for example imudp. Thanks to Anton for reporting this bug. [imported v4]\n- bugfix: ompgsql had problems with transaction support, what actually \n  rendered it unsuable. Thanks to forum user \"horhe\" for alerting me\n  on this bug and helping to debug/fix it! [imported from 5.3.6]\n- bugfix: $CreateDirs variable not properly initialized, default thus\n  was random (but most often \"on\") [imported from v3]\n- bugfix: potential segfaults during queue shutdown\n  (bugs require certain non-standard settings to appear)\n  Thanks to varmojfekoj for the patch [imported from 4.5.8]\n  [backport from 5.5.2]\n- bugfix: wrong memory assignment for a config variable (probably\n  without causing any harm) [backport from 5.2.2]\n- bugfix: rsyslog hangs when writing to a named pipe which nobody was\n  reading. Thanks to Michael Biebl for reporting this bug.\n  Bugzilla entry: http://bugzilla.adiscon.com/show_bug.cgi?id=169\n  [imported from 4.5.8]\n---------------------------------------------------------------------------\nVersion 5.3.6  [BETA] (rgerhards), 2010-01-13\n- bugfix: ompgsql did not properly check the server connection in\n  tryResume(), which could lead to rsyslog running in a thight loop\n- bugfix: suspension during beginTransaction() was not properly handled\n  by rsyslog core\n- bugfix: omfile output was only written when buffer was full, not at\n  end of transaction\n- bugfix: commit transaction was not properly conveyed to message layer,\n  potentially resulting in non-message destruction and thus hangs\n- bugfix: enabling GSSServer crashes rsyslog startup\n  Thanks to Tomas Kubina for the patch [imgssapi]\n- bugfix (kind of): check if TCP connection is still alive if using TLS\n  Thanks to Jonathan Bond-Caron for the patch.\n- bugfix: $CreateDirs variable not properly initialized, default thus\n  was random (but most often \"on\") [imported from v3]\n- bugfix: ompgsql had problems with transaction support, what actually \n  rendered it unsuable. Thanks to forum user \"horhe\" for alerting me\n  on this bug and helping to debug/fix it!\n- bugfix: memory leak when sending messages in zip-compressed format\n  Thanks to Naoya Nakazawa for analyzing this issue and providing a patch.\n- worked around an issue where omfile failed to compile on 32 bit platforms\n  under some circumstances (this smells like a gcc problem, but a simple\n  solution was available). Thanks to Kenneth Marshall for some advice.\n  [backported from 5.5.x branch]\n---------------------------------------------------------------------------\nVersion 5.3.5  [BETA] (rgerhards), 2009-11-13\n- some light performance enhancement by replacing time() call with much\n  faster (at least under linux) gettimeofday() calls.\n- some improvement of omfile performance with dynafiles\n  saved costly time() calls by employing a logical clock, which is \n  sufficient for the use case\n- bugfix: omudpspoof miscalculated source and destination ports\n  while this was probably not noticed for source ports, it resulted in\n  almost all destination ports being wrong, except for the default port\n  of 514, which by virtue of its binary representation was calculated \n  correct (and probably thus the bug not earlier detected).\n- bugfixes imported from earlier releases\n  * bugfix: named pipes did no longer work (they always got an open error)\n    this was a regression from the omfile rewrite in 4.5.0\n  * bugfix(testbench): sequence check was not always performed correctly,\n    that could result in tests reporting success when they actually failed\n- improved testbench: added tests for UDP forwarding and omudpspoof\n- doc bugfix: omudpspoof had wrong config command names (\"om\" missing)\n- bugfix [imported from 4.4.3]: $ActionExecOnlyOnceEveryInterval did\n  not work.\n- [inport v4] improved testbench, contains now tcp and gzip test cases\n- [import v4] added a so-called \"On Demand Debug\" mode, in which debug\n  output can be generated only after the process has started, but not right\n  from the beginning. This is assumed to be useful for hard-to-find bugs.\n  Also improved the doc on the debug system.\n- bugfix: segfault on startup when -q or -Q option was given\n  [imported from v3-stable]\n---------------------------------------------------------------------------\nVersion 5.3.4  [DEVEL] (rgerhards), 2009-11-04\n- added the ability to create custom message parsers\n- added $RulesetParser config directive that permits to bind specific\n  parsers to specific rulesets\n- added omruleset output module, which provides great flexibility in \n  action processing. THIS IS A VERY IMPORTANT ADDITION, see its doc\n  for why.\n- added the capability to have ruleset-specific main message queues\n  This offers considerable additional flexibility AND superior performance\n  (in cases where multiple inputs now can avoid lock contention)\n- bugfix: correct default for escape ('#') character restored\n  This was accidently changed to '\\\\', thanks to David Lang for reporting\n- bugfix(testbench): testcase did not properly wait for rsyslogd shutdown\n  thus some unpredictable behavior and a false negative test result\n  could occur.\n---------------------------------------------------------------------------\nVersion 5.3.3  [DEVEL] (rgerhards), 2009-10-27\n- simplified and thus speeded up the queue engine, also fixed some\n  potential race conditions (in very unusual shutdown conditions)\n  along the way. The threading model has seriously changes, so there may\n  be some regressions.\n- enhanced test environment (inlcuding testbench): support for enhancing\n  probability of memory addressing failure by using non-NULL default\n  value for malloced memory (optional, only if requested by configure\n  option). This helps to track down some otherwise undetected issues\n  within the testbench.\n- bugfix: potential abort if inputname property was not set \n  primarily a problem of imdiag\n- bugfix: message processing states were not set correctly in all cases\n  however, this had no negative effect, as the message processing state\n  was not evaluated when a batch was deleted, and that was the only case\n  where the state could be wrong.\n---------------------------------------------------------------------------\nVersion 5.3.2  [DEVEL] (rgerhards), 2009-10-21\n- enhanced omfile to support transactional interface. This will increase\n  performance in many cases.\n- added multi-ruleset support to imudp\n- re-enabled input thread termination handling that does avoid thread\n  cancellation where possible. This provides a more reliable mode of\n  rsyslogd termination (canceling threads my result in not properly\n  freed resouces and potential later hangs, even though we perform\n  proper cancel handling in our code). This is part of an effort to\n  reduce thread cancellation as much as possible in rsyslog.\n  NOTE: the code previously written code for this functionality had a\n  subtle race condition. The new code solves that.\n- enhanced immark to support non-cancel input module termination\n- improved imudp so that epoll can be used in more environments,\n  fixed potential compile time problem if EPOLL_CLOEXEC is not available.\n- some cleanup/slight improvement:\n  * changed imuxsock to no longer use deprecated submitAndParseMsg() IF\n  * changed submitAndParseMsg() interface to be a wrapper around the new\n    way of message creation/submission. This enables older plugins to be\n    used together with the new interface. The removal also enables us to\n    drop a lot of duplicate code, reducing complexity and increasing\n    maintainability.\n- bugfix: segfault when starting up with an invalid .qi file for a disk queue\n  Failed for both pure disk as well as DA queues. Now, we emit an error\n  message and disable disk queueing facility.\n- bugfix: potential segfault on messages with empty MSG part. This was a\n  recently introduced regression.\n- bugfix: debug string larger than 1K were improperly displayed. Max size\n  is now 32K, and if a string is even longer it is meaningfully truncated.\n---------------------------------------------------------------------------\nVersion 5.3.1  [DEVEL] (rgerhards), 2009-10-05\n- added $AbortOnUncleanConfig directive - permits to prevent startup when\n  there are problems with the configuration file. See it's doc for\n  details.\n- included some important fixes from v4-stable:\n  * bugfix: invalid handling of zero-sized messages\n  * bugfix: zero-sized UDP messages are no longer processed\n  * bugfix: random data could be appended to message\n  * bugfix: reverse lookup reduction logic in imudp do DNS queries too often\n- bugfixes imported from 4.5.4:\n  * bugfix: potential segfault in stream writer on destruction\n  * bugfix: potential race in object loader (obj.c) during use/release\n  * bugfixes: potential problems in out file zip writer\n---------------------------------------------------------------------------\nVersion 5.3.0  [DEVEL] (rgerhards), 2009-09-14\n- begun to add simple GUI programs to gain insight into running rsyslogd\n  instances and help setup and troubleshooting (active via the\n  --enable-gui ./configure switch)\n- changed imudp to utilize epoll(), where available. This shall provide\n  slightly better performance (just slightly because we called select()\n  rather infrequently on a busy system)\n---------------------------------------------------------------------------\nVersion 5.2.2  [v5-stable] (rgerhards), 2009-11-??\n- bugfix: enabling GSSServer crashes rsyslog startup\n  Thanks to Tomas Kubina for the patch [imgssapi]\n---------------------------------------------------------------------------\nVersion 5.2.1  [v5-stable] (rgerhards), 2009-11-02\n- bugfix [imported from 4.4.3]: $ActionExecOnlyOnceEveryInterval did\n  not work.\n- bugfix: segfault on startup when -q or -Q option was given\n  [imported from v3-stable]\n---------------------------------------------------------------------------\nVersion 5.2.0  [v5-stable] (rgerhards), 2009-11-02\nThis is a re-release of version 5.1.6 as stable after we did not get any bug \nreports during the whole beta phase. Still, this first v5-stable may not be \nas stable as one hopes for, I am not sure if we did not get bug reports\njust because nobody tried it. Anyhow, we need to go forward and so we\nhave the initial v5-stable.\n---------------------------------------------------------------------------\nVersion 5.1.6  [v5-beta] (rgerhards), 2009-10-15\n- feature imports from v4.5.6\n- bugfix: potential race condition when queue worker threads were\n  terminated\n- bugfix: solved potential (temporary) stall of messages when the queue was\n  almost empty and few new data added (caused testbench to sometimes hang!)\n- fixed some race condition in testbench\n- added more elaborate diagnostics to parts of the testbench\n- bugfixes imported from 4.5.4:\n  * bugfix: potential segfault in stream writer on destruction\n  * bugfix: potential race in object loader (obj.c) during use/release\n  * bugfixes: potential problems in out file zip writer\n- included some important fixes from 4.4.2:\n  * bugfix: invalid handling of zero-sized messages\n  * bugfix: zero-sized UDP messages are no longer processed\n  * bugfix: random data could be appended to message\n  * bugfix: reverse lookup reduction logic in imudp do DNS queries too often\n---------------------------------------------------------------------------\nVersion 5.1.5  [v5-beta] (rgerhards), 2009-09-11\n- added new config option $ActionWriteAllMarkMessages\n  this option permites to process mark messages under all circumstances,\n  even if an action was recently called. This can be useful to use mark\n  messages as a kind of heartbeat.\n- added new config option $InputUnixListenSocketCreatePath\n  to permit the auto-creation of pathes to additional log sockets. This\n  turns out to be useful if they reside on temporary file systems and\n  rsyslogd starts up before the daemons that create these sockets\n  (rsyslogd always creates the socket itself if it does not exist).\n- added $LogRSyslogStatusMessages configuration directive\n  permitting to turn off rsyslog start/stop/HUP messages. See Debian\n  ticket http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=463793\n- bugfix: hostnames with dashes in them were incorrectly treated as\n  malformed, thus causing them to be treated as TAG (this was a regression\n  introduced from the \"rfc3164 strict\" change in 4.5.0). Testbench has been\n  updated to include a smaple message with a hostname containing a dash.\n- bugfix: strings improperly reused, resulting in some message properties\n  be populated with strings from previous messages. This was caused by\n  an improper predicate check.\n- added new config directive $omfileForceChown [import from 4.7.0]\n---------------------------------------------------------------------------\nVersion 5.1.4  [DEVEL] (rgerhards), 2009-08-20\n- legacy syslog parser changed so that it now accepts date stamps in\n  wrong case. Some devices seem to create them and I do not see any harm\n  in supporting that.\n- added $InputTCPMaxListeners directive - permits to specify how many \n  TCP servers shall be possible (default is 20).\n- bugfix: memory leak with some input modules. Those inputs that\n  use parseAndSubmitMsg() leak two small memory blocks with every message.\n  Typically, those process only relatively few messages, so the issue \n  does most probably not have any effect in practice.\n- bugfix: if tcp listen port could not be created, no error message was\n  emitted\n- bugfix: discard action did not work (did not discard messages)\n- bugfix: discard action caused segfault\n- bugfix: potential segfault in output file writer (omfile)\n  In async write mode, we use modular arithmetic to index the output\n  buffer array. However, the counter variables accidently were signed,\n  thus resulting in negative indizes after integer overflow. That in turn\n  could lead to segfaults, but was depending on the memory layout of \n  the instance in question (which in turn depended on a number of\n  variables, like compile settings but also configuration). The counters\n  are now unsigned (as they always should have been) and so the dangling\n  mis-indexing does no longer happen. This bug potentially affected all\n  installations, even if only some may actually have seen a segfault.\n---------------------------------------------------------------------------\nVersion 5.1.3  [DEVEL] (rgerhards), 2009-07-28\n- architecture change: queue now always has at least one worker thread\n  if not running in direct mode. Previous versions could run without \n  any active workers. This simplifies the code at a very small expense.\n  See v5 compatibility note document for more in-depth discussion.\n- enhance: UDP spoofing supported via new output module omudpspoof\n  See the omudpspoof documentation for details and samples\n- bugfix: message could be truncated after TAG, often when forwarding\n  This was a result of an internal processing error if maximum field\n  sizes had been specified in the property replacer.\n- bugfix: minor static memory leak while reading configuration\n  did NOT leak based on message volume\n- internal: added ability to terminate input modules not via pthread_cancel\n  but an alternate approach via pthread_kill. This is somewhat safer as we\n  do not need to think about the cancel-safeness of all libraries we use.\n  However, not all inputs can easily supported, so this now is a feature\n  that can be requested by the input module (the most important ones\n  request it).\n---------------------------------------------------------------------------\nVersion 5.1.2  [DEVEL] (rgerhards), 2009-07-08\n- bugfix: properties inputname, fromhost, fromhost-ip, msg were lost when\n  working with disk queues\n- some performance enhancements\n- bugfix: abort condition when RecvFrom was not set and message reduction\n  was on. Happend e.g. with imuxsock.\n- added $klogConsoleLogLevel directive which permits to set a new\n  console log level while rsyslog is active\n- some internal code cleanup\n---------------------------------------------------------------------------\nVersion 5.1.1  [DEVEL] (rgerhards), 2009-07-03\n- bugfix: huge memory leak in queue engine (made rsyslogd unusable in\n  production). Occured if at least one queue was in direct mode \n  (the default for action queues)\n- imported many performance optimizations from v4-devel (4.5.0)\n- bugfix: subtle (and usually irrelevant) issue in timout processing\n  timeout could be one second too early if nanoseconds wrapped\n- set a more sensible timeout for shutdow, now 1.5 seconds to complete\n  processing (this also removes those cases where the shutdown message\n  was not written because the termination happened before it)\n---------------------------------------------------------------------------\nVersion 5.1.0  [DEVEL] (rgerhards), 2009-05-29\n\n*********************************** NOTE **********************************\nThe v5 versions of rsyslog feature a greatly redesigned queue engine. The\nmajor theme for the v5 release is twofold:\n\na) greatly improved performance\nb) enable audit-grade processing\n\nHere, audit-grade processing means that rsyslog, if used together with\naudit-grade transports and configured correctly, will never lose messages\nthat already have been acknowledged, not even in fatal failure cases like\nsudden loss of power.\n\nNote that large parts of rsyslog's important core components have been\nrestructured to support these design goals. As such, early versions of\nthe engine will probably be less stable than the v3/v4 engine.\n\nAlso note that the initial versions do not cover all and everything. As\nusual, the code will evolve toward the final goal as version numbers\nincrease.\n*********************************** NOTE **********************************\n\n- redesigned queue engine so that it supports ultra-reliable operations\n  This resulted in a rewrite of large parts. The new capability can be\n  used to build audit-grade systems on the basis of rsyslog.\n- added $MainMsgQueueDequeueBatchSize and $ActionQueueDequeueBatchSize \n  configuration directives\n- implemented a new transactional output module interface which provides\n  superior performance (for databases potentially far superior performance)\n- increased ompgsql performance by adapting to new transactional\n  output module interface\n---------------------------------------------------------------------------\nVersion 4.7.3  [v4-devel] (rgerhards), 2010-11-25\n- added omuxsock, which permits to write message to local Unix sockets\n  this is the counterpart to imuxsock, enabling fast local forwarding\n- added imptcp, a simplified, Linux-specific and potentielly fast\n  syslog plain tcp input plugin (NOT supporting TLS!)\n- bugfix: a couple of problems that imfile had on some platforms, namely\n  Ubuntu (not their fault, but occured there)\n- bugfix: imfile utilizes 32 bit to track offset. Most importantly,\n  this problem can not experienced on Fedora 64 bit OS (which has\n  64 bit long's!)\n- added the $InputFilePersistStateInterval config directive to imfile\n- changed imfile so that the state file is never deleted (makes imfile\n  more robust in regard to fatal failures)\n---------------------------------------------------------------------------\nVersion 4.7.2  [v4-devel] (rgerhards), 2010-05-03\n- bugfix: problems with atomic operations emulaton\n  replaced atomic operation emulation with new code. The previous code\n  seemed to have some issue and also limited concurrency severely. The\n  whole atomic operation emulation has been rewritten.\n- added new $Sleep directive to hold processing for a couple of seconds\n  during startup\n- bugfix: programname filter in ! configuration can not be reset\n  Thanks to Kiss Gabor for the patch.\n---------------------------------------------------------------------------\nVersion 4.7.1  [v4-devel] (rgerhards), 2010-04-22\n- Solaris support much improved -- was not truely usable in 4.7.0\n  Solaris is no longer supported in imklog, but rather there is a new\n  plugin imsolaris, which is used to pull local log sources on a Solaris\n  machine.\n- testbench improvement: Java is no longer needed for testing tool creation\n---------------------------------------------------------------------------\nVersion 4.7.0  [v4-devel] (rgerhards), 2010-04-14\n- new: support for Solaris added (but not yet the Solaris door API)\n- added function getenv() to RainerScript\n- added new config option $InputUnixListenSocketCreatePath\n  to permit the auto-creation of pathes to additional log sockets. This\n  turns out to be useful if they reside on temporary file systems and\n  rsyslogd starts up before the daemons that create these sockets\n  (rsyslogd always creates the socket itself if it does not exist).\n- added $LogRSyslogStatusMessages configuration directive\n  permitting to turn off rsyslog start/stop/HUP messages. See Debian\n  ticket http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=463793\n- added new config directive $omfileForceChown to (try to) fix some broken\n  system configs.\n  See ticket for details: http://bugzilla.adiscon.com/show_bug.cgi?id=150\n- added $EscapeControlCharacterTab config directive\n  Thanks to Jonathan Bond-Caron for the patch.\n- added option to use unlimited-size select() calls\n  Thanks to varmjofekoj for the patch\n- debugondemand mode caused backgrounding to fail - close to a bug, but I'd\n  consider the ability to background in this mode a new feature...\n- bugfix (kind of): check if TCP connection is still alive if using TLS\n  Thanks to Jonathan Bond-Caron for the patch.\n- imported changes from 4.5.7 and below\n- bugfix: potential segfault when -p command line option was used\n  Thanks for varmojfekoj for pointing me at this bug.\n- imported changes from 4.5.6 and below\n---------------------------------------------------------------------------\nVersion 4.6.6  [v4-stable] (rgerhards), 2010-11-??\n- bugfix: imfile potentially duplicates lines\n  This can happen when 0 bytes are read from the input file, and some\n  writer appends data to the file BEFORE we check if a rollover happens.\n  The check for rollover uses the inode and size as a criterion. So far,\n  we checked for equality of sizes, which is not given in this scenario,\n  but that does not indicate a rollover. From the source code comments:\n     Note that when we check the size, we MUST NOT check for equality.\n     The reason is that the file may have been written right after we\n     did try to read (so the file size has increased). That is NOT in\n     indicator of a rollover (this is an actual bug scenario we \n     experienced). So we need to check if the new size is smaller than\n     what we already have seen!\n  Also, under some circumstances an invalid truncation was detected. This\n  code has now been removed, a file change (and thus resent) is only\n  detected if the inode number changes.\n- bugfix: a couple of problems that imfile had on some platforms, namely\n  Ubuntu (not their fault, but occured there)\n- bugfix: imfile utilizes 32 bit to track offset. Most importantly,\n  this problem can not experienced on Fedora 64 bit OS (which has\n  64 bit long's!)\n- some improvements thanks to clang's static code analyzer\n  o overall cleanup (mostly unnecessary writes and otherwise unused stuff)\n  o bugfix: fixed a very remote problem in msg.c which could occur when\n    running under extremely low memory conditions\n---------------------------------------------------------------------------\nVersion 4.6.5  [v4-stable] (rgerhards), 2010-11-24\n- bugfix(important): problem in TLS handling could cause rsyslog to loop\n  in a tight loop, effectively disabling functionality and bearing the\n  risk of unresponsiveness of the whole system.\n  Bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=194\n---------------------------------------------------------------------------\nVersion 4.6.4  [v4-stable] (rgerhards), 2010-08-05\n- bugfix: zero-sized (empty) messages were processed by imtcp\n  they are now dropped as they always should have been\n- bugfix: programname filter in ! configuration can not be reset\n  Thanks to Kiss Gabor for the patch.\n---------------------------------------------------------------------------\nVersion 4.6.3  [v4-stable] (rgerhards), 2010-07-07\n- improvded testbench\n  - added test with truly random data received via syslog to test\n    robustness\n  - added new configure option that permits to disable and enable an\n    extended testbench\n- bugfix: segfault on HUP when \"HUPIsRestart\" was set to \"on\"\n  thanks varmojfekoj for the patch\n- bugfix: default for $OMFileFlushOnTXEnd was wrong (\"off\").\n  This, in default mode, caused buffered writing to be used, what\n  means that it looked like no output were written or partial\n  lines. Thanks to Michael Biebl for pointing out this bug.\n- bugfix: testbench failed when not executed in UTC+1 timezone\n  accidently, the time zone information was kept inside some\n  to-be-checked-for responses\n- temporary bugfix replaced by permanent one for\n  message-induced off-by-one error (potential segfault) (see 4.6.2)\n  The analysis has been completed and a better fix been crafted and \n  integrated.\n- bugfix: the T/P/E config size specifiers did not work properly under\n  all 32-bit platforms\n- bugfix: local unix system log socket was deleted even when it was\n  not configured\n- some doc fixes; incorrect config samples could cause confusion\n  thanks to Anthony Edwards for pointing the problems out\n---------------------------------------------------------------------------\nVersion 4.6.2  [v4-stable] (rgerhards), 2010-03-26\n- new feature: \".\" action type added to support writing files to relative\n  pathes (this is primarily meant as a debug aid)\n- added replacements for atomic instructions on systems that do not\n  support them. [backport of Stefen Sledz' patch for v5)\n- new feature: $OMFileAsyncWriting directive added\n  it permits to specifiy if asynchronous writing should be done or not\n- bugfix(temporary): message-induced off-by-one error (potential segfault)\n  Some types of malformed messages could trigger an off-by-one error\n  (for example, \\0 or \\n as the last character, and generally control\n  character escaption is questionable). This is due to not strictly\n  following a the \\0 or string counted string paradigm (during the last\n  optimization on the cstring class). As a temporary fix, we have \n  introduced a proper recalculation of the size. However, a final\n  patch is expected in the future. See bug tracker for further details\n  and when the final patch will be available:\n  http://bugzilla.adiscon.com/show_bug.cgi?id=184\n  Note that the current patch is considered sufficient to solve the\n  situation, but it requires a bit more runtime than desirable.\n- bugfix: potential segfault in dynafile cache\n  This bug was triggered by an open failure. The the cache was full and\n  a new entry needed to be placed inside it, a victim for eviction was\n  selected. That victim was freed, then the open of the new file tried. If\n  the open failed, the victim entry was still freed, and the function\n  exited. However, on next invocation and cache search, the victim entry\n  was used as if it were populated, most probably resulting in a segfault.\n- bugfix: race condition during directory creation\n  If multiple files try to create a directory at (almost) the same time,\n  some of them may fail. This is a data race and also exists with other\n  processes that may create the same directory. We do now check for this\n  condition and gracefully handle it.\n- bugfix: potential re-use of free()ed file stream object in omfile\n  when dynaCache is enabled, the cache is full, a new entry needs to\n  be allocated, thus the LRU discarded, then a new entry is opend and that\n  fails. In that case, it looks like the discarded stream may be reused\n  improperly (based on code analysis, test case and confirmation pending)\n- added new property replacer option \"date-rfc3164-buggyday\" primarily\n  to ease migration from syslog-ng. See property replacer doc for\n  details. [backport from 5.5.3 because urgently needed by some]\n- improved testbench\n- bugfix: invalid buffer write in (file) stream class\n  currently being accessed buffer could be overwritten with new data.\n  While this probably did not cause access violations, it could case loss\n  and/or duplication of some data (definitely a race with no deterministic\n  outcome)\n- bugfix: potential hang condition during filestream close\n  predicate was not properly checked when waiting for the background file\n  writer\n- bugfix: improper synchronization when \"$OMFileFlushOnTXEnd on\" was used\n  Internal data structures were not properly protected due to missing\n  mutex calls.\n- bugfix: potential data loss during file stream shutdown\n- bugfix: potential problems during file stream shutdown\n  The shutdown/close sequence was not clean, what potentially (but\n  unlikely) could lead to some issues. We have not been able to describe\n  any fatal cases, but there was some bug potential. Sequence has now\n  been straighted out.\n- bugfix: potential problem (loop, abort) when file write error occured\n  When a write error occured in stream.c, variable iWritten had the error\n  code but this was handled as if it were the actual number of bytes\n  written. That was used in pointer arithmetic later on, and thus could\n  lead to all sorts of problems. However, this could only happen if the\n  error was EINTR or the file in question was a tty. All other cases were\n  handled properly. Now, iWritten is reset to zero in such cases, resulting\n  in proper retries.\n- bugfix: $omfileFlushOnTXEnd was turned on when set to off and vice\n  versa due to an invalid check\n- bugfix: recent patch to fix small memory leak could cause invalid free.\n  This could only happen during config file parsing.\n- bugfix(minor): handling of extremely large strings in dbgprintf() fixed\n  Previously, it could lead to garbagge output and, in extreme cases, also\n  to segfaults. Note: this was a problem only when debug output was \n  actually enabled, so it caused no problem in production use.\n- bugfix(minor): BSD_SO_COMPAT query function had some global vars not\n  properly initialized. However, in practice the loader initializes them \n  with zero, the desired value, so there were no actual issue in almost \n  all cases.\n---------------------------------------------------------------------------\nVersion 4.6.1  [v4-stable] (rgerhards), 2010-03-04\n- re-enabled old pipe output (using new module ompipe, built-in) after\n  some problems with pipes (and especially in regard to xconsole) were\n  discovered. Thanks to Michael Biebl for reporting the issues.\n- bugfix: potential problems with large file support could cause segfault\n  ... and other weird problems. This seemed to affect 32bit-platforms\n  only, but I can not totally outrule there were issues on other\n  platforms as well. The previous code could cause system data types\n  to be defined inconsistently, and that could lead to various \n  troubles. Special thanks go to the Mandriva team for identifying\n  an initial problem, help discussing it and ultimately a fix they\n  contributed.\n- bugfix: fixed problem that caused compilation on FreeBSD 9.0 to fail.\n  bugtracker: http://bugzilla.adiscon.com/show_bug.cgi?id=181\n  Thanks to Christiano for reporting.\n- bugfix: potential segfault in omfile when a dynafile open failed\n  In that case, a partial cache entry was written, and some internal\n  pointers (iCurrElt) not correctly updated. In the next iteration, that\n  could lead to a segfault, especially if iCurrElt then points to the\n  then-partial record. Not very likely, but could happen in practice.\n- bugfix (theoretical): potential segfault in omfile under low memory\n  condition. This is only a theoretical bug, because it would only \n  happen when strdup() fails to allocate memory - which is highly \n  unlikely and will probably lead to all other sorts of errors.\n- bugfix: comment char ('#') in literal terminated script parsing\n  and thus could not be used.\n  but tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=119\n  [merged in from v3.22.2]\n---------------------------------------------------------------------------\nVersion 4.6.0  [v4-stable] (rgerhards), 2010-02-24\n***************************************************************************\n* This is a new stable v4 version. It contains all fixes and enhancements *\n* made during the 4.5.x phase as well as those listed below.              *\n* Note: this version is scheduled to conclude the v4 development process. *\n*       Do not expect any more new developments in v4. The focus is now   *\n*       on v5 (what also means we have a single devel branch again).      *\n*       (\"development\" means new feature development, bug fixes are of    *\n*       course provided for v4-stable)                                    *\n***************************************************************************\n- improved testbench to contain samples for totally malformed messages\n  which miss parts of the message content\n- bugfix: some malformed messages could lead to a missing LF inside files\n  or some other missing parts of the template content.\n- bugfix: if a message ended immediately with a hostname, the hostname\n  was mistakenly interpreted as TAG, and localhost be used as hostname\n- bugfix: message without MSG part could case a segfault\n  [backported from v5 commit 98d1ed504ec001728955a5bcd7916f64cd85f39f]\n  This actually was a \"recent\" regression, but I did not realize that it\n  was introduced by the performance optimization in v4-devel. Shame on\n  me for having two devel versions at the same time...\n---------------------------------------------------------------------------\nVersion 4.5.8  [v4-beta] (rgerhards), 2010-02-10\n- enhanced doc for using PostgreSQL\n  Thanks to Marc Schiffbauer for the new/updated doc\n- bugfix: property replacer returned invalid parameters under some (unusual)\n  conditions. In extreme cases, this could lead to garbled logs and/or\n  a system failure.\n- bugfix: invalid length returned (often) when using regular expressions\n  inside the property replacer\n- bugfix: submatch regex in property replacer did not honor \"return 0 on\n  no match\" config case\n- bugfix: imuxsock incorrectly stated inputname \"imudp\"\n  Thanks to Ryan Lynch for reporting this.\n- (slightly) enhanced support for FreeBSD by setting _PATH_MODDIR to\n  the correct value on FreeBSD.\n  Thanks to Cristiano for the patch.\n- bugfix: -d did not enable display of debug messages\n  regression from introduction of \"debug on demand\" mode\n  Thanks to Michael Biebl for reporting this bug\n- bugfix: blanks inside file names did not terminate file name parsing.\n  This could reslult in the whole rest of a line (including comments)\n  to be treated as file name in \"write to file\" actions.\n  Thanks to Jack for reporting this issue.\n- bugfix: rsyslog hang when writing to a named pipe which nobody was\n  reading. Thanks to Michael Biebl for reporting this bug.\n  Bugzilla entry: http://bugzilla.adiscon.com/show_bug.cgi?id=169\n- bugfix: potential segfaults during queue shutdown\n  (bugs require certain non-standard settings to appear)\n  Thanks to varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 4.5.7  [v4-beta] (rgerhards), 2009-11-18\n- added a so-called \"On Demand Debug\" mode, in which debug output can\n  be generated only after the process has started, but not right from\n  the beginning. This is assumed to be useful for hard-to-find bugs.\n  Also improved the doc on the debug system.\n- bugfix (kind of): check if TCP connection is still alive if using TLS\n  Thanks to Jonathan Bond-Caron for the patch.\n- bugfix: hostname accidently set to IP address for some message sources,\n  for example imudp. Thanks to Anton for reporting this bug.\n- bugfix [imported from 4.4.3]: $ActionExecOnlyOnceEveryInterval did\n  not work.\n---------------------------------------------------------------------------\nVersion 4.5.6  [v4-beta] (rgerhards), 2009-11-05\n- bugfix: named pipes did no longer work (they always got an open error)\n  this was a regression from the omfile rewrite in 4.5.0\n- bugfix(minor): diag function returned wrong queue memeber count\n  for the main queue if an active DA queue existed. This had no relevance\n  to real deployments (assuming they are not running the debug/diagnostic\n  module...), but sometimes caused grief and false alerts in the \n  testbench.\n- included some important fixes from v4-stable:\n  * bugfix: invalid handling of zero-sized messages\n  * bugfix: zero-sized UDP messages are no longer processed\n  * bugfix: random data could be appended to message\n  * bugfix: reverse lookup reduction logic in imudp do DNS queries too often\n- bugfix(testbench): testcase did not properly wait for rsyslod shutdown\n  thus some unpredictable behavior and a false negative test result\n  could occur. [BACKPORTED from v5]\n- bugfix(testbench): sequence check was not always performed correctly,\n  that could result in tests reporting success when they actually failed\n---------------------------------------------------------------------------\nVersion 4.5.5  [v4-beta] (rgerhards), 2009-10-21\n- added $InputTCPServerNotifyOnConnectionClose config directive\n  see doc for details\n- bugfix: debug string larger than 1K were improperly displayed. Max size\n  is now 32K\n- bugfix: invalid storage class selected for some size config parameters.\n  This resulted in wrong values. The most prominent victim was the\n  directory creation mode, which was set to zero in some cases. For \n  details, see related blog post:\n  http://blog.gerhards.net/2009/10/another-note-on-hard-to-find-bugs.html\n---------------------------------------------------------------------------\nVersion 4.5.4  [v4-beta] (rgerhards), 2009-09-29\n- bugfix: potential segfault in stream writer on destruction\n  Most severely affected omfile. The problem was that some buffers were\n  freed before the asynchronous writer thread was shut down. So the\n  writer thread accessed invalid data, which may even already be\n  overwritten. Symptoms (with omfile) were segfaults, grabled data\n  and files with random names placed around the file system (most\n  prominently into the root directory). Special thanks to Aaron for\n  helping to track this down.\n- bugfix: potential race in object loader (obj.c) during use/release\n  of object interface\n- bugfixes: potential problems in out file zip writer. Problems could\n  lead to abort and/or memory leak. The module is now hardened in a very\n  conservative way, which is sub-optimal from a performance point of view.\n  This should be improved if it has proven reliable in practice.\n---------------------------------------------------------------------------\nVersion 4.5.3  [v4-beta] (rgerhards), 2009-09-17\n- bugfix: repeated messages were incorrectly processed\n  this could lead to loss of the repeated message content. As a side-\n  effect, it could probably also be possible that some segfault occurs\n  (quite unlikely). The root cause was that some counters introduced\n  during the malloc optimizations were not properly duplicated in\n  MsgDup(). Note that repeated message processing is not enabled\n  by default.\n- bugfix: message sanitation had some issues:\n  - control character DEL was not properly escaped\n  - NUL and LF characters were not properly stripped if no control\n    character replacement was to be done\n  - NUL characters in the message body were silently dropped (this was\n    a regeression introduced by some of the recent optimizations)\n- bugfix: strings improperly reused, resulting in some message properties\n  be populated with strings from previous messages. This was caused by\n  an improper predicate check. [backported from v5]\n- fixed some minor portability issues\n- bugfix: reverse lookup reduction logic in imudp do DNS queries too often\n  [imported from 4.4.2]\n---------------------------------------------------------------------------\nVersion 4.5.2  [v4-beta] (rgerhards), 2009-08-21\n- legacy syslog parser changed so that it now accepts date stamps in\n  wrong case. Some devices seem to create them and I do not see any harm\n  in supporting that.\n- added $InputTCPMaxListeners directive - permits to specify how many \n  TCP servers shall be possible (default is 20).\n- bugfix: memory leak with some input modules. Those inputs that\n  use parseAndSubmitMsg() leak two small memory blocks with every message.\n  Typically, those process only relatively few messages, so the issue \n  does most probably not have any effect in practice.\n- bugfix: if tcp listen port could not be created, no error message was\n  emitted\n- bugfix: potential segfault in output file writer (omfile)\n  In async write mode, we use modular arithmetic to index the output\n  buffer array. However, the counter variables accidently were signed,\n  thus resulting in negative indizes after integer overflow. That in turn\n  could lead to segfaults, but was depending on the memory layout of \n  the instance in question (which in turn depended on a number of\n  variables, like compile settings but also configuration). The counters\n  are now unsigned (as they always should have been) and so the dangling\n  mis-indexing does no longer happen. This bug potentially affected all\n  installations, even if only some may actually have seen a segfault.\n- bugfix: hostnames with dashes in them were incorrectly treated as\n  malformed, thus causing them to be treated as TAG (this was a regression\n  introduced from the \"rfc3164 strict\" change in 4.5.0).\n---------------------------------------------------------------------------\nVersion 4.5.1  [DEVEL] (rgerhards), 2009-07-15\n- CONFIG CHANGE: $HUPisRestart default is now \"off\". We are doing this\n  to support removal of restart-type HUP in v5.\n- bugfix: fromhost-ip was sometimes truncated\n- bugfix: potential segfault when zip-compressed syslog records were\n  received (double free)\n- bugfix: properties inputname, fromhost, fromhost-ip, msg were lost when\n  working with disk queues\n- performance enhancement: much faster, up to twice as fast (depending\n  on configuration)\n- bugfix: abort condition when RecvFrom was not set and message reduction\n  was on. Happend e.g. with imuxsock.\n- added $klogConsoleLogLevel directive which permits to set a new\n  console log level while rsyslog is active\n- bugfix: message could be truncated after TAG, often when forwarding\n  This was a result of an internal processing error if maximum field\n  sizes had been specified in the property replacer.\n- added ability for the TCP output action to \"rebind\" its send socket after\n  sending n messages (actually, it re-opens the connection, the name is \n  used because this is a concept very similiar to $ActionUDPRebindInterval).\n  New config directive $ActionSendTCPRebindInterval added for the purpose.\n  By default, rebinding is disabled. This is considered useful for load\n  balancers.\n- testbench improvements\n---------------------------------------------------------------------------\nVersion 4.5.0  [DEVEL] (rgerhards), 2009-07-02\n- activation order of inputs changed, they are now activated only after\n  privileges are dropped. Thanks to Michael Terry for the patch.\n- greatly improved performance\n- greatly reduced memory requirements of msg object\n  to around half of the previous demand. This means that more messages can\n  be stored in core! Due to fewer cache misses, this also means some\n  performance improvement.\n- improved config error messages: now contain a copy of the config line\n  that (most likely) caused the error\n- reduced max value for $DynaFileCacheSize to 1,000 (the former maximum\n  of 10,000 really made no sense, even 1,000 is very high, but we like\n  to keep the user in control ;)).\n- added capability to fsync() queue disk files for enhanced reliability\n  (also add's speed, because you do no longer need to run the whole file\n  system in sync mode)\n- more strict parsing of the hostname in rfc3164 mode, hopefully\n  removes false positives (but may cause some trouble with hostname\n  parsing). For details, see this bug tracker:\n  http://bugzilla.adiscon.com/show_bug.cgi?id=126\n- omfile rewrite to natively support zip files (includes large extension\n  of the stream class)\n- added configuration commands (see doc for explanations)\n  * $OMFileZipLevel\n  * $OMFileIOBufferSize\n  * $OMFileFlushOnTXEnd\n  * $MainMsgQueueSyncQueueFiles\n  * $ActionQueueSyncQueueFiles\n- done some memory accesses explicitely atomic\n- bugfix: subtle (and usually irrelevant) issue in timout processing\n  timeout could be one second too early if nanoseconds wrapped\n- set a more sensible timeout for shutdow, now 1.5 seconds to complete\n  processing (this also removes those cases where the shutdown message\n  was not written because the termination happened before it)\n- internal bugfix: object pointer was only reset to NULL when an object\n  was actually destructed. This most likely had no effect to existing code,\n  but it may also have caused trouble in remote cases. Similarly, the fix\n  may also cause trouble...\n- bugfix: missing initialization during timestamp creation\n  This could lead to timestamps written in the wrong format, but not to\n  an abort\n---------------------------------------------------------------------------\nVersion 4.4.3  [v4-stable] (rgerhards), 2009-10-??\n- bugfix: several smaller bugs resolved after flexelint review\n  Thanks to varmojfekoj for the patch.\n- bugfix: $ActionExecOnlyOnceEveryInterval did not work.\n  This was a regression from the time() optimizations done in v4.\n  Bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=143\n  Thanks to Klaus Tachtler for reporting this bug.\n- bugfix: potential segfault on queue shutdown\n  Thanks to varmojfekoj for the patch.\n- bugfix: potential hang condition on queue shutdown\n  [imported from v3-stable]\n- bugfix: segfault on startup when -q or -Q option was given\n  [imported from v3-stable]\n---------------------------------------------------------------------------\nVersion 4.4.2  [v4-stable] (rgerhards), 2009-10-09\n- bugfix: invalid handling of zero-sized messages, could lead to mis-\n  addressing and potential memory corruption/segfault\n- bugfix: zero-sized UDP messages are no longer processed\n  until now, they were forwarded to processing, but this makes no sense\n  Also, it looks like the system seems to provide a zero return code\n  on a UDP recvfrom() from time to time for some internal reasons. These\n  \"receives\" are now silently ignored.\n- bugfix: random data could be appended to message, possibly causing\n  segfaults\n- bugfix: reverse lookup reduction logic in imudp do DNS queries too often\n  A comparison was done between the current and the former source address.\n  However, this was done on the full sockaddr_storage structure and not\n  on the host address only. This has now been changed for IPv4 and IPv6.\n  The end result of this bug could be a higher UDP message loss rate than\n  necessary (note that UDP message loss can not totally be avoided due\n  to the UDP spec)\n---------------------------------------------------------------------------\nVersion 4.4.1  [v4-stable] (rgerhards), 2009-09-02\n- features requiring Java are automatically disabled if Java is not\n  present (thanks to Michael Biebl for his help!)\n- bugfix: invalid double-quoted PRI, among others in outgoing messages\n  This causes grief with all receivers.\n  Bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=147\n- bugfix: Java testing tools were required, even if testbench was disabled\n  This resulted in build errors if no Java was present on the build system,\n  even though none of the selected option actually required Java.\n  (I forgot to backport a similar fix to newer releases).\n- bugfix (backport): omfwd segfault\n  Note that the orginal (higher version) patch states this happens only\n  when debugging mode is turned on. That statement is wrong: if debug\n  mode is turned off, the message is not being emitted, but the division\n  by zero in the actual parameters still happens.\n---------------------------------------------------------------------------\nVersion 4.4.0  [v4-stable] (rgerhards), 2009-08-21\n- bugfix: stderr/stdout were not closed to be able to emit error messages,\n  but this caused ssh sessions to hang. Now we close them after the \n  initial initialization. See forum thread:\n  http://kb.monitorware.com/controlling-terminal-issues-t9875.html\n- bugfix: sending syslog messages with zip compression did not work\n---------------------------------------------------------------------------\nVersion 4.3.2  [v4-beta] (rgerhards), 2009-06-24\n- removed long-obsoleted property UxTradMsg\n- added a generic network stream server (in addition to rather specific\n  syslog tcp server)\n- added ability for the UDP output action to rebind its send socket after\n  sending n messages. New config directive $ActionSendUDPRebindInterval\n  added for the purpose. By default, rebinding is disabled. This is \n  considered useful for load balancers.\n- bugfix: imdiag/imtcp had a race condition\n- improved testbench (now much better code design and reuse)\n- added config switch --enable-testbench=no to turn off testbench\n---------------------------------------------------------------------------\nVersion 4.3.1  [DEVEL] (rgerhards), 2009-05-25\n- added capability to run multiple tcp listeners (on different ports)\n- performance enhancement: imtcp calls parser no longer on input thread\n  but rather inside on of the potentially many main msg queue worker\n  threads (an enhancement scheduled for all input plugins where this is\n  possible)\n- added $GenerateConfigGraph configuration command which can be used\n  to generate nice-looking (and very informative) rsyslog configuration\n  graphs.\n- added $ActionName configuration directive (currently only used for\n  graph generation, but may find other uses)\n- improved doc\n  * added (hopefully) easier to grasp queue explanation\n- improved testbench\n  * added tests for queue disk-only mode (checks disk queue logic)\n- bugfix: light and full delay watermarks had invalid values, badly\n  affecting performance for delayable inputs\n- build system improvements - thanks to Michael Biebl\n- added new testing module imdiag, which enables to talk to the \n  rsyslog core at runtime. The current implementation is only a \n  beginning, but can be expanded over time\n---------------------------------------------------------------------------\nVersion 4.3.0  [DEVEL] (rgerhards), 2009-04-17\n- new feature: new output plugin omprog, which permits to start program\n  and feed it (via its stdin) with syslog messages. If the program\n  terminates, it is restarted.\n- improved internal handling of RainerScript functions, building the\n  necessary plumbing to support more functions with decent runtime\n  performance. This is also necessary towards the long-term goal\n  of loadable library modules.\n- added new RainerScript function \"tolower\"\n- improved testbench\n  * added tests for tcp-based reception\n  * added tcp-load test (1000 connections, 20,000 messages)\n- added $MaxOpenFiles configuration directive\n- bugfix: solved potential memory leak in msg processing, could manifest\n  itself in imtcp\n- bugfix: ompgsql did not detect problems in sql command execution\n  this could cause loss of messages. The handling was correct if the\n  connection broke, but not if there was a problem with statement\n  execution. The most probable case for such a case would be invalid\n  sql inside the template, and this is now much easier to diagnose.\n---------------------------------------------------------------------------\nVersion 4.2.0  [v4-stable] (rgerhards), 2009-06-23\n- bugfix: light and full delay watermarks had invalid values, badly\n  affecting performance for delayable inputs\n- imported all patches from 3.22.1 as of today (see below)\n- bugfix: compile problems in im3195\n---------------------------------------------------------------------------\nVersion 4.1.7  [BETA] (rgerhards), 2009-04-22\n- bugfix: $InputTCPMaxSessions config directive was accepted, but not\n  honored. This resulted in a fixed upper limit of 200 connections.\n- bugfix: the default for $DirCreateMode was 0644, and as such wrong.\n  It has now been changed to 0700. For some background, please see\n  http://lists.adiscon.net/pipermail/rsyslog/2009-April/001986.html\n- bugfix: ompgsql did not detect problems in sql command execution\n  this could cause loss of messages. The handling was correct if the\n  connection broke, but not if there was a problem with statement\n  execution. The most probable case for such a case would be invalid\n  sql inside the template, and this is now much easier to diagnose.\n---------------------------------------------------------------------------\nVersion 4.1.6  [DEVEL] (rgerhards), 2009-04-07\n- added new \"csv\" property replacer options to enable simple creation\n  of CSV-formatted outputs (format from RFC4180 is used)\n- implemented function support in RainerScript. That means the engine\n  parses and compile functions, as well as executes a few build-in\n  ones. Dynamic loading and registration of functions is not yet\n  supported - but we now have a good foundation to do that later on.\n- implemented the strlen() RainerScript function\n- added a template output module\n- added -T rsyslogd command line option, enables to specify a directory\n  where to chroot() into on startup. This is NOT a security feature but\n  introduced to support testing. Thus, -T does not make sure chroot()\n  is used in a secure way. (may be removed later)\n- added omstdout module for testing purposes. Spits out all messages to\n  stdout - no config option, no other features\n- added a parser testing suite (still needs to be extended, but a good\n  start)\n- modified $ModLoad statement so that for modules whom's name starts with\n  a dot, no path is prepended (this enables relative-pathes and should\n  not break any valid current config)\n- fixed a bug that caused action retries not to work correctly\n  situation was only cleared by a restart\n- bugfix: closed dynafile was potentially never written until another\n  dynafile name was generated - potential loss of messages\n- improved omfile so that it properly suspends itself if there is an\n  i/o or file name generation error. This enables it to be used with\n  the full high availability features of rsyslog's engine\n- bugfix: fixed some segaults on Solaris, where vsprintf() does not\n  check for NULL pointers\n- improved performance of regexp-based filters\n  Thanks to Arnaud Cornet for providing the idea and initial patch.\n- added a new way how output plugins may be passed parameters. This is\n  more effcient for some outputs. They new can receive fields not only\n  as a single string but rather in an array where each string is seperated.\n- added (some) developer documentation for output plugin interface\n- bugfix: potential abort with DA queue after high watermark is reached\n  There exists a race condition that can lead to a segfault. Thanks\n  go to vbernetr, who performed the analysis and provided patch, which\n  I only tweaked a very little bit.\n- bugfix: imtcp did incorrectly parse hostname/tag\n  Thanks to Luis Fernando Mu\u00f1oz Mej\u00edas for the patch.\n---------------------------------------------------------------------------\nVersion 4.1.5  [DEVEL] (rgerhards), 2009-03-11\n- bugfix: parser did not correctly parse fields in UDP-received messages\n- added ERE support in filter conditions\n  new comparison operation \"ereregex\"\n- added new config directive $RepeatedMsgContainsOriginalMsg so that the\n  \"last message repeated n times\" messages, if generated, may\n  have an alternate format that contains the message that is being repeated\n---------------------------------------------------------------------------\nVersion 4.1.4  [DEVEL] (rgerhards), 2009-01-29\n- bugfix: inconsistent use of mutex/atomic operations could cause segfault\n  details are too many, for full analysis see blog post at:\n  http://blog.gerhards.net/2009/01/rsyslog-data-race-analysis.html\n- bugfix: unitialized mutex was used in msg.c:getPRI\n  This was subtle, because getPRI is called as part of the debugging code\n  (always executed) in syslogd.c:logmsg.\n- bufgix: $PreserveFQDN was not properly handled for locally emitted\n  messages\n---------------------------------------------------------------------------\nVersion 4.1.3  [DEVEL] (rgerhards), 2008-12-17\n- added $InputTCPServerAddtlFrameDelimiter config directive, which\n  enables to specify an additional, non-standard message delimiter\n  for processing plain tcp syslog. This is primarily a fix for the invalid\n  framing used in Juniper's NetScreen products. Credit to forum user\n  Arv for suggesting this solution.\n- added $InputTCPServerInputName property, which enables a name to be\n  specified that will be available during message processing in the\n  inputname property. This is considered useful for logic that treats\n  messages differently depending on which input received them.\n- added $PreserveFQDN config file directive\n  Enables to use FQDNs in sender names where the legacy default\n  would have stripped the domain part.\n  Thanks to BlinkMind, Inc. http://www.blinkmind.com for sponsoring this\n  development.\n- bugfix: imudp went into an endless loop under some circumstances\n  (but could also leave it under some other circumstances...)\n  Thanks to David Lang and speedfox for reporting this issue.\n---------------------------------------------------------------------------\nVersion 4.1.2  [DEVEL] (rgerhards), 2008-12-04\n- bugfix: code did not compile without zlib\n- security bugfix: $AllowedSender was not honored, all senders were\n  permitted instead (see http://www.rsyslog.com/Article322.phtml)\n- security fix: imudp emitted a message when a non-permitted sender\n  tried to send a message to it. This behaviour is operator-configurable.\n  If enabled, a message was emitted each time. That way an attacker could\n  effectively fill the disk via this facility. The message is now\n  emitted only once in a minute (this currently is a hard-coded limit,\n  if someone comes up with a good reason to make it configurable, we\n  will probably do that).\n- doc bugfix: typo in v3 compatibility document directive syntax\n  thanks to Andrej for reporting\n- imported other changes from 3.21.8 and 3.20.1 (see there)\n---------------------------------------------------------------------------\nVersion 4.1.1  [DEVEL] (rgerhards), 2008-11-26\n- added $PrivDropToGroup, $PrivDropToUser, $PrivDropToGroupID,\n  $PrivDropToUserID config directives to enable dropping privileges.\n  This is an effort to provide a security enhancement. For the limits of this\n  approach, see http://wiki.rsyslog.com/index.php/Security\n- re-enabled imklog to compile on FreeBSD (brought in from beta)\n---------------------------------------------------------------------------\nVersion 4.1.0  [DEVEL] (rgerhards), 2008-11-18\n\n********************************* WARNING *********************************\nThis version has a slightly different on-disk format for message entries.\nAs a consequence, old queue files being read by this version may have\nan invalid output timestamp, which could result to some malfunction inside\nthe output driver. It is recommended to drain queues with the previous\nversion before switching to this one.\n********************************* WARNING *********************************\n\n- greatly enhanced performance when compared to v3.\n- added configuration directive \"HUPisRestart\" which enables to configure\n  HUP to be either a full restart or \"just\" a leightweight way to\n  close open files.\n- enhanced legacy syslog parser to detect year if part of the timestamp\n  the format is based on what Cisco devices seem to emit.\n- added a setting \"$OptimizeForUniprocessor\" to enable users to turn off\n  pthread_yield calls which are counter-productive on multiprocessor \n  machines (but have been shown to be useful on uniprocessors)\n- reordered imudp processing. Message parsing is now done as part of main\n  message queue worker processing (was part of the input thread)\n  This should also improve performance, as potentially more work is\n  done in parallel.\n- bugfix: compressed syslog messages could be slightly mis-uncompressed\n  if the last byte of the compressed record was a NUL\n- added $UDPServerTimeRequery option which enables to work with\n  less acurate timestamps in favor of performance. This enables querying\n  of the time only every n-th time if imudp is running in the tight\n  receive loop (aka receiving messsages at a high rate)\n- doc bugfix: queue doc had wrong parameter name for setting controlling\n  worker thread shutdown period\n- restructured rsyslog.conf documentation\n- bugfix: memory leak in ompgsql\n  Thanks to Ken for providing the patch\n---------------------------------------------------------------------------\nVersion 3.22.4 [v3-stable] (rgerhards), 2010-??-??\n- improved some code based on clang static analyzer results\n---------------------------------------------------------------------------\nVersion 3.22.3 [v3-stable] (rgerhards), 2010-11-24\n- bugfix(important): problem in TLS handling could cause rsyslog to loop\n  in a tight loop, effectively disabling functionality and bearing the\n  risk of unresponsiveness of the whole system.\n  Bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=194\n---------------------------------------------------------------------------\nVersion 3.22.2 [v3-stable] (rgerhards), 2010-08-05\n- bugfix: comment char ('#') in literal terminated script parsing\n  and thus could not be used.\n  but tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=119\n- enhance: imrelp now also provides remote peer's IP address \n  [if librelp != 1.0.0 is used]\n- bugfix: sending syslog messages with zip compression did not work\n- bugfix: potential hang condition on queue shutdown\n- bugfix: segfault on startup when -q or -Q option was given\n  bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=157\n  Thanks to Jonas Nogueira for reporting this bug.\n- clarified use of $ActionsSendStreamDriver[AuthMode/PermittedPeers]\n  in doc set (require TLS drivers)\n- bugfix: $CreateDirs variable not properly initialized, default thus\n  was random (but most often \"on\")\n- bugfix: potential segfault when -p command line option was used\n  thanks to varmojfekoj for pointing me at this bug\n- bugfix: programname filter in ! configuration can not be reset\n  Thanks to Kiss Gabor for the patch.\n---------------------------------------------------------------------------\nVersion 3.22.1 [v3-stable] (rgerhards), 2009-07-02\n- bugfix: invalid error message issued if $inlcudeConfig was on an empty\n  set of files (e.g. *.conf, where none such files existed)\n  thanks to Michael Biebl for reporting this bug\n- bugfix: when run in foreground (but not in debug mode), a \n  debug message (\"DoDie called\") was emitted at shutdown. Removed.\n  thanks to Michael Biebl for reporting this bug\n- bugfix: some garbagge was emitted to stderr on shutdown. This\n  garbage consisted of file names, which were written during \n  startup (key point: not a pointer error)\n  thanks to Michael Biebl for reporting this bug\n- bugfix: startup and shutdown message were emitted to stdout\n  thanks to Michael Biebl for reporting this bug\n- bugfix: error messages were not emitted to stderr in forked mode\n  (stderr and stdo are now kept open across forks)\n- bugfix: internal messages were emitted to whatever file had fd2 when\n  rsyslogd ran in forked mode (as usual!)\n  Thanks to varmojfekoj for the patch\n- small enhancement: config validation run now exits with code 1 if an\n  error is detected. This change is considered important but small enough\n  to apply it directly to the stable version. [But it is a border case,\n  the change requires more code than I had hoped. Thus I have NOT tried\n  to actually catch all cases, this is left for the current devel\n  releases, if necessary]\n- bugfix: light and full delay watermarks had invalid values, badly\n  affecting performance for delayable inputs\n- bugfix: potential segfault issue when multiple $UDPServerRun directives\n  are specified. Thanks to Michael Biebl for helping to debug this one.\n- relaxed GnuTLS version requirement to 1.4.0 after confirmation from the\n  field that this version is sufficient\n- bugfix: parser did not properly handle empty structured data\n- bugfix: invalid mutex release in msg.c (detected under thread debugger,\n  seems not to have any impact on actual deployments)\n---------------------------------------------------------------------------\nVersion 3.22.0 [v3-stable] (rgerhards), 2009-04-21\nThis is the first stable release that includes the full functionality\nof the 3.21.x version tree.\n- bugfix: $InputTCPMaxSessions config directive was accepted, but not\n  honored. This resulted in a fixed upper limit of 200 connections.\n- bugfix: the default for $DirCreateMode was 0644, and as such wrong.\n  It has now been changed to 0700. For some background, please see\n  http://lists.adiscon.net/pipermail/rsyslog/2009-April/001986.html\n- bugfix: ompgsql did not detect problems in sql command execution\n  this could cause loss of messages. The handling was correct if the\n  connection broke, but not if there was a problem with statement\n  execution. The most probable case for such a case would be invalid\n  sql inside the template, and this is now much easier to diagnose.\n---------------------------------------------------------------------------\nVersion 3.21.11 [BETA] (rgerhards), 2009-04-03\n- build system improvements contributed by Michael Biebl - thx!\n- all patches from 3.20.5 incorporated (see it's ChangeLog entry)\n---------------------------------------------------------------------------\nVersion 3.21.10 [BETA] (rgerhards), 2009-02-02\n- bugfix: inconsistent use of mutex/atomic operations could cause segfault\n  details are too many, for full analysis see blog post at:\n  http://blog.gerhards.net/2009/01/rsyslog-data-race-analysis.html\n- the string \"Do Die\" was accidently emited upon exit in non-debug mode\n  This has now been corrected. Thanks to varmojfekoj for the patch.\n- some legacy options were not correctly processed.\n  Thanks to varmojfekoj for the patch.\n- doc bugfix: v3-compatiblity document had typo in config directive\n  thanks to Andrej for reporting this\n---------------------------------------------------------------------------\nVersion 3.21.9 [BETA] (rgerhards), 2008-12-04\n- re-release of 3.21.8 with an additional fix, that could also lead\n  to DoS; 3.21.8 has been removed from the official download archives\n- security fix: imudp emitted a message when a non-permitted sender\n  tried to send a message to it. This behaviour is operator-configurable.\n  If enabled, a message was emitted each time. That way an attacker could\n  effectively fill the disk via this facility. The message is now\n  emitted only once in a minute (this currently is a hard-coded limit,\n  if someone comes up with a good reason to make it configurable, we\n  will probably do that).\n---------------------------------------------------------------------------\nVersion 3.21.8  [BETA] (rgerhards), 2008-12-04\n- bugfix: imklog did not compile on FreeBSD\n- security bugfix: $AllowedSender was not honored, all senders were\n  permitted instead (see http://www.rsyslog.com/Article322.phtml)\n- merged in all other changes from 3.20.1 (see there)\n---------------------------------------------------------------------------\nVersion 3.21.7  [BETA] (rgerhards), 2008-11-11\n- this is the new beta branch, based on the former 3.21.6 devel\n- new functionality: ZERO property replacer nomatch option (from v3-stable)\n---------------------------------------------------------------------------\nVersion 3.21.6  [DEVEL] (rgerhards), 2008-10-22\n- consolidated time calls during msg object creation, improves performance\n  and consistency\n- bugfix: solved a segfault condition\n- bugfix: subsecond time properties generated by imfile, imklog and\n  internal messages could be slightly inconsistent\n- bugfix: (potentially big) memory leak on HUP if queues could not be\n  drained before timeout - thanks to David Lang for pointing this out\n- added capability to support multiple module search pathes. Thank\n  to Marius Tomaschewski for providing the patch.\n- bugfix: im3195 did no longer compile\n- improved \"make distcheck\" by ensuring everything relevant is recompiled\n---------------------------------------------------------------------------\nVersion 3.21.5  [DEVEL] (rgerhards), 2008-09-30\n- performance optimization: unnecessary time() calls during message\n  parsing removed - thanks to David Lang for his excellent performance\n  analysis\n- added new capability to property replacer: multiple immediately\n  successive field delimiters are treated as a single one.\n  Thanks to Zhuang Yuyao for the patch.\n- added message property \"inputname\", which contains the name of the\n  input (module) that generated it. Presence is depending on suport in\n  each input module (else it is blank).\n- added system property \"$myhostname\", which contains the name of the\n  local host as it knows itself.\n- imported a number of fixes and enhancements from the stable and\n  devel branches, including a fix to a potential segfault on HUP\n  when using UDP listners\n- re-enabled gcc builtin atomic operations and added a proper\n  ./configure check\n- bugfix: potential race condition when adding messages to queue\n  There was a wrong order of mutex lock operations. It is hard to\n  believe that really caused problems, but in theory it could and with\n  threading we often see that theory becomes practice if something is only\n  used long enough on a fast enough machine with enough CPUs ;)\n- cleaned up internal debug system code and made it behave better\n  in regard to multi-threading\n---------------------------------------------------------------------------\nVersion 3.21.4  [DEVEL] (rgerhards), 2008-09-04\n- removed compile time fixed message size limit (was 2K), limit can now\n  be set via $MaxMessageSize global config directive (finally gotten rid\n  of MAXLINE ;))\n- enhanced doc for $ActionExecOnlyEveryNthTimeTimeout\n- integrated a number of patches from 3.18.4, namely\n  - bugfix: order-of magnitude issue with base-10 size definitions\n    in config file parser. Could lead to invalid sizes, constraints\n    etc for e.g. queue files and any other object whose size was specified\n    in base-10 entities. Did not apply to binary entities. Thanks to\n    RB for finding this bug and providing a patch.\n  - bugfix: action was not called when system time was set backwards\n    (until the previous time was reached again). There are still some\n    side-effects when time is rolled back (A time rollback is really a bad\n    thing to do, ideally the OS should issue pseudo time (like NetWare did)\n    when the user tries to roll back time). Thanks to varmojfekoj for this\n    patch.\n  - doc bugfix: rsyslog.conf man page improved and minor nit fixed\n    thanks to Lukas Kuklinek for the patch.\n---------------------------------------------------------------------------\nVersion 3.21.3  [DEVEL] (rgerhards), 2008-08-13\n- added ability to specify flow control mode for imuxsock\n- added ability to execute actions only after the n-th call of the action\n  This also lead to the addition of two new config directives:\n  $ActionExecOnlyEveryNthTime and $ActionExecOnlyEveryNthTimeTimeout\n  This feature is useful, for example, for alerting: it permits you to\n  send an alert only after at least n occurences of a specific message\n  have been seen by rsyslogd. This protectes against false positives\n  due to waiting for additional confirmation.\n- bugfix: IPv6 addresses could not be specified in forwarding actions\n  New syntax @[addr]:port introduced to enable that. Root problem was IPv6\n  addresses contain colons.\n- somewhat enhanced debugging messages\n- imported from 3.18.3:\n  - enhanced ommysql to support custom port to connect to server\n    Port can be set via new $ActionOmmysqlServerPort config directive\n    Note: this was a very minor change and thus deemed appropriate to be\n    done in the stable release.\n  - bugfix: misspelled config directive, previously was\n    $MainMsgQueueWorkeTimeoutrThreadShutdown, is now\n    $MainMsgQueueWorkerTimeoutThreadShutdown. Note that the misspelled\n    directive is not preserved - if the misspelled directive was used\n    (which I consider highly unlikely), the config file must be changed.\n    Thanks to lperr for reporting the bug.\n---------------------------------------------------------------------------\nVersion 3.21.2  [DEVEL] (rgerhards), 2008-08-04\n- added $InputUnixListenSocketHostName config directive, which permits to\n  override the hostname being used on a local unix socket. This is useful\n  for differentiating \"hosts\" running in several jails. Feature was\n  suggested by David Darville, thanks for the suggestion.\n- enhanced ommail to support multiple email recipients. This is done by\n  specifying $ActionMailTo multiple times. Note that this introduces a\n  small incompatibility to previous config file syntax: the recipient\n  list is now reset for each action (we honestly believe that will\n  not cause any problem - apologies if it does).\n- enhanced troubleshooting documentation\n---------------------------------------------------------------------------\nVersion 3.21.1  [DEVEL] (rgerhards), 2008-07-30\n- bugfix: no error was reported if the target of a $IncludeConfig\n  could not be accessed.\n- added testbed for common config errors\n- added doc for -u option to rsyslogd man page\n- enhanced config file checking - no active actions are detected\n- added -N rsyslogd command line option for a config validation run\n  (which does not execute actual syslogd code and does not interfere\n  with a running instance)\n- somewhat improved emergency configuration. It is now also selected\n  if the config contains no active actions\n- rsyslogd error messages are now reported to stderr by default. can be\n  turned off by the new \"$ErrorMessagesToStderr off\" directive\n Thanks to HKS for suggesting the new features.\n---------------------------------------------------------------------------\nVersion 3.21.0  [DEVEL] (rgerhards), 2008-07-18\n- starts a new devel branch\n- added a generic test driver for RainerScript plus some test cases\n  to the testbench\n- added a small diagnostic tool to obtain result of gethostname() API\n- imported all changes from 3.18.1 until today (some quite important,\n  see below)\n---------------------------------------------------------------------------\nVersion 3.20.6 [v3-stable] (rgerhards), 2009-04-16\n- this is the last v3-stable for the 3.20.x series\n- bugfix: $InputTCPMaxSessions config directive was accepted, but not\n  honored. This resulted in a fixed upper limit of 200 connections.\n- bugfix: the default for $DirCreateMode was 0644, and as such wrong.\n  It has now been changed to 0700. For some background, please see\n  http://lists.adiscon.net/pipermail/rsyslog/2009-April/001986.html\n---------------------------------------------------------------------------\nVersion 3.20.5 [v3-stable] (rgerhards), 2009-04-02\n- bugfix: potential abort with DA queue after high watermark is reached\n  There exists a race condition that can lead to a segfault. Thanks\n  go to vbernetr, who performed the analysis and provided patch, which\n  I only tweaked a very little bit.\n- fixed bugs in RainerScript:\n  o when converting a number and a string to a common type, both were \n    actually converted to the other variable's type.\n  o the value of rsCStrConvertToNumber() was miscalculated.\n  Thanks to varmojfekoj for the patch\n- fixed a bug in configure.ac which resulted in problems with\n  environment detection - thanks to Michael Biebl for the patch\n- fixed a potential segfault problem in gssapi code\n  thanks to varmojfekoj for the patch\n- doc enhance: provide standard template for MySQL module and instructions\n  on how to modify schema\n---------------------------------------------------------------------------\nVersion 3.20.4 [v3-stable] (rgerhards), 2009-02-09\n- bugfix: inconsistent use of mutex/atomic operations could cause segfault\n  details are too many, for full analysis see blog post at:\n  http://blog.gerhards.net/2009/01/rsyslog-data-race-analysis.html\n- bugfix: invalid ./configure settings for RFC3195\n  thanks to Michael Biebl for the patch\n- bugfix: invalid mutex access in msg.c\n- doc bugfix: dist tarball missed 2 files, had one extra file that no\n  longer belongs into it. Thanks to Michael Biebl for pointing this out.\n---------------------------------------------------------------------------\nVersion 3.20.3 [v3-stable] (rgerhards), 2009-01-19\n- doc bugfix: v3-compatiblity document had typo in config directive\n  thanks to Andrej for reporting this\n- fixed a potential segfault condition with $AllowedSender directive\n  On HUP, the root pointers were not properly cleaned up. Thanks to\n  Michael Biebel, olgoat, and Juha Koho for reporting and analyzing\n  the bug.\n---------------------------------------------------------------------------\nVersion 3.20.2 [v3-stable] (rgerhards), 2008-12-04\n- re-release of 3.20.1 with an additional fix, that could also lead\n  to DoS; 3.20.1 has been removed from the official download archives\n- security fix: imudp emitted a message when a non-permitted sender\n  tried to send a message to it. This behaviour is operator-configurable.\n  If enabled, a message was emitted each time. That way an attacker could\n  effectively fill the disk via this facility. The message is now\n  emitted only once in a minute (this currently is a hard-coded limit,\n  if someone comes up with a good reason to make it configurable, we\n  will probably do that).\n---------------------------------------------------------------------------\nVersion 3.20.1 [v3-stable] (rgerhards), 2008-12-04\n- security bugfix: $AllowedSender was not honored, all senders were\n  permitted instead\n- enhance: regex nomatch option \"ZERO\" has been added\n  This allows to return the string 0 if a regular expression is\n  not found. This is probably useful for storing numerical values into\n  database columns.\n- bugfix: memory leak in gtls netstream driver fixed\n  memory was lost each time a TLS session was torn down. This could \n  result in a considerable memory leak if it happened quite frequently\n  (potential system crash condition)\n- doc update: documented how to specify multiple property replacer\n  options + link to new online regex generator tool added\n- minor bufgfix: very small memory leak in gtls netstream driver\n  around a handful of bytes (< 20) for each HUP\n- improved debug output for regular expressions inside property replacer\n  RE's seem to be a big trouble spot and I would like to have more\n  information inside the debug log. So I decided to add some additional\n  debug strings permanently.\n---------------------------------------------------------------------------\nVersion 3.20.0 [v3-stable] (rgerhards), 2008-11-05\n- this is the inital release of the 3.19.x branch as a stable release\n- bugfix: double-free in pctp netstream driver. Thank to varmojfeko\n  for the patch\n---------------------------------------------------------------------------\nVersion 3.19.12 [BETA] (rgerhards), 2008-10-16\n- bugfix: subseconds where not correctly extracted from a timestamp\n  if that timestamp did not contain any subsecond information (the\n  resulting string was garbagge but should have been \"0\", what it\n  now is).\n- increased maximum size of a configuration statement to 4K (was 1K)\n- imported all fixes from the stable branch (quite a lot)\n- bugfix: (potentially big) memory leak on HUP if queues could not be\n  drained before timeout - thanks to David Lang for pointing this out\n---------------------------------------------------------------------------\nVersion 3.19.11 [BETA] (rgerhards), 2008-08-25\nThis is a refresh of the beta. No beta-specific fixes have been added.\n- included fixes from v3-stable (most importantly 3.18.3)\n---------------------------------------------------------------------------\nVersion 3.19.10 [BETA] (rgerhards), 2008-07-15\n- start of a new beta branch based on former 3.19 devel branch\n- bugfix: bad memory leak in disk-based queue modes\n- bugfix: UDP syslog forwarding did not work on all platforms\n  the ai_socktype was incorrectly set to 1. On some platforms, this\n  lead to failing name resolution (e.g. FreeBSD 7). Thanks to HKS for\n  reporting the bug.\n- bugfix: priority was incorrectly calculated on FreeBSD 7,\n  because the LOG_MAKEPRI() C macro has a different meaning there (it\n  is just a simple addition of faciltity and severity). I have changed\n  this to use own, consistent, code for PRI calculation. Thank to HKS\n  for reporting this bug.\n- bugfix (cosmetical): authorization was not checked when gtls handshake\n  completed immediately. While this sounds scary, the situation can not\n  happen in practice. We use non-blocking IO only for server-based gtls\n  session setup. As TLS requires the exchange of multiple frames before\n  the handshake completes, it simply is impossible to do this in one\n  step. However, it is useful to have the code path correct even for \n  this case - otherwise, we may run into problems if the code is changed\n  some time later (e.g. to use blocking sockets). Thanks to varmojfekoj\n  for providing the patch.\n- important queue bugfix from 3.18.1 imported (see below)\n- cleanup of some debug messages\n---------------------------------------------------------------------------\nVersion 3.19.9 (rgerhards), 2008-07-07\n- added tutorial for creating a TLS-secured syslog infrastructure\n- rewritten omusrmsg to no longer fork() a new process for sending messages\n  this caused some problems with the threading model, e.g. zombies. Also,\n  it was far less optimal than it is now.\n- bugfix: machine certificate was required for client even in TLS anon mode\n  Reference: http://bugzilla.adiscon.com/show_bug.cgi?id=85\n  The fix also slightly improves performance by not storing certificates in\n  client sessions when there is no need to do so.\n- bugfix: RainerScript syntax error was not always detected\n---------------------------------------------------------------------------\nVersion 3.19.8 (rgerhards), 2008-07-01\n- bugfix: gtls module did not correctly handle EGAIN (and similar) recv()\n  states. This has been fixed by introducing a new abstraction layer inside\n  gtls.\n- added (internal) error codes to error messages; added redirector to\n  web description of error codes\n  closes bug http://bugzilla.adiscon.com/show_bug.cgi?id=20\n- disabled compile warnings caused by third-party libraries\n- reduced number of compile warnings in gcc's -pedantic mode\n- some minor documentation improvements\n- included all fixes from beta 3.17.5\n---------------------------------------------------------------------------\nVersion 3.19.7 (rgerhards), 2008-06-11\n- added new property replacer option \"date-subseconds\" that enables\n  to query just the subsecond part of a high-precision timestamp\n- somewhat improved plain tcp syslog reliability by doing a connection\n  check before sending. Credits to Martin Schuette for providing the\n  idea. Details are available at\n  http://blog.gerhards.net/2008/06/reliable-plain-tcp-syslog-once-again.html\n- made rsyslog tickless in the (usual and default) case that repeated\n  message reduction is turned off. More info:\n  http://blog.gerhards.net/2008/06/coding-to-save-environment.html\n- some build system cleanup, thanks to Michael Biebl\n- bugfix: compile under (Free)BSD failed due to some invalid library\n  definitions - this is fixed now. Thanks to Michael Biebl for the patch.\n---------------------------------------------------------------------------\nVersion 3.19.6 (rgerhards), 2008-06-06\n- enhanced property replacer to support multiple regex matches\n- bugfix: part of permittedPeer structure was not correctly initialized\n  thanks to varmojfekoj for spotting this\n- bugfix: off-by-one bug during certificate check\n- bugfix: removed some memory leaks in TLS code\n---------------------------------------------------------------------------\nVersion 3.19.5 (rgerhards), 2008-05-30\n- enabled Posix ERE expressions inside the property replacer\n  (previously BRE was permitted only)\n- provided ability to specify that a regular expression submatch shall\n  be used inside the property replacer\n- implemented in property replacer: if a regular expression does not match,\n  it can now either return \"**NO MATCH** (default, as before), a blank\n  property or the full original property text\n- enhanced property replacer to support multiple regex matches\n---------------------------------------------------------------------------\nVersion 3.19.4 (rgerhards), 2008-05-27\n- implemented x509/certvalid gtls auth mode\n- implemented x509/name gtls auth mode (including wildcards)\n- changed fingerprint gtls auth mode to new format fingerprint\n- protected gtls error string function by a mutex. Without it, we\n  could have a race condition in extreme cases. This was very remote,\n  but now can no longer happen.\n- changed config directive name to reflect different use\n  $ActionSendStreamDriverCertFingerprint is now\n  $ActionSendStreamDriverPermittedPeer and can be used both for\n  fingerprint and name authentication (similar to the input side)\n- bugfix: sender information (fromhost et al) was missing in imudp\n  thanks to sandiso for reporting this bug\n- this release fully inplements IETF's syslog-transport-tls-12 plus\n  the latest text changes Joe Salowey provided via email. Not included\n  is ipAddress subjectAltName authentication, which I think will be\n  dropped from the draft. I don't think there is any real need for it.\nThis release also includes all bug fix up to today from the beta\nand stable branches. Most importantly, this means the bugfix for\n100% CPU utilization by imklog.\n---------------------------------------------------------------------------\nVersion 3.19.3 (rgerhards), 2008-05-21\n- added ability to authenticate the server against its certificate\n  fingerprint\n- added ability for client to provide its fingerprint\n- added ability for server to obtain client cert's fingerprint\n- bugfix: small mem leak in omfwd on exit (strmdriver name was not freed)\n- bugfix: $ActionSendStreamDriver had no effect\n- bugfix: default syslog port was no longer used if none was\n  configured. Thanks to varmojfekoj for the patch\n- bugfix: missing linker options caused build to fail on some\n  systems. Thanks to Tiziano Mueller for the patch.\n---------------------------------------------------------------------------\nVersion 3.19.2 (rgerhards), 2008-05-16\n- bugfix: TCP input modules did incorrectly set fromhost property\n  (always blank)\n- bugfix: imklog did not set fromhost property\n- added \"fromhost-ip\" property\n  Note that adding this property changes the on-disk format for messages.\n  However, that should not have any bad effect on existing spool files.\n  But you will run into trouble if you create a spool file with this\n  version and then try to process it with an older one (after a downgrade).\n  Don't do that ;)\n- added \"RSYSLOG_DebugFormat\" canned template\n- bugfix: hostname and fromhost were swapped when a persisted message\n  (in queued mode) was read in\n- bugfix: lmtcpclt, lmtcpsrv and lmgssutil did all link to the static\n  runtime library, resulting in a large size increase (and potential\n  \"interesting\" effects). Thanks to Michael Biebel for reporting the size\n  issue.\n- bugfix: TLS server went into an endless loop in some situations.\n  Thanks to Michael Biebl for reporting the problem.\n- fixed potential segfault due to invalid call to cfsysline\n  thanks to varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 3.19.1 (rgerhards), 2008-05-07\n- configure help for --enable-gnutls wrong - said default is \"yes\" but\n  default actually is \"no\" - thanks to darix for pointing this out\n- file dirty.h was missing - thanks to darix for pointing this out\n- bugfix: man files were not properly distributed - thanks to\n  darix for reporting and to Michael Biebl for help with the fix\n- some minor cleanup\n---------------------------------------------------------------------------\nVersion 3.19.0 (rgerhards), 2008-05-06\n- begins new devel branch version\n- implemented TLS for plain tcp syslog (this is also the world's first\n  implementation of IETF's upcoming syslog-transport-tls draft)\n- partly rewritten and improved omfwd among others, now loads TCP\n  code only if this is actually necessary\n- split of a \"runtime library\" for rsyslog - this is not yet a clean\n  model, because some modularization is still outstanding. In theory,\n  this shall enable other utilities but rsyslogd to use the same\n  runtime\n- implemented im3195, the RFC3195 input as a plugin\n- changed directory structure, files are now better organized\n- a lot of cleanup in regard to modularization\n- -c option no longer must be the first option - thanks to varmjofekoj\n  for the patch\n---------------------------------------------------------------------------\nVersion 3.18.7 (rgerhards), 2008-12-??\n- bugfix: the default for $DirCreateMode was 0644, and as such wrong.\n  It has now been changed to 0700. For some background, please see\n  http://lists.adiscon.net/pipermail/rsyslog/2009-April/001986.html\n- fixed a potential segfault condition with $AllowedSender directive\n  On HUP, the root pointers were not properly cleaned up. Thanks to\n  Michael Biebel, olgoat, and Juha Koho for reporting and analyzing\n  the bug.\n- some legacy options were not correctly processed.\n  Thanks to varmojfekoj for the patch.\n- doc bugfix: some spelling errors in man pages corrected. Thanks to\n  Geoff Simmons for the patch.\n---------------------------------------------------------------------------\nVersion 3.18.6 (rgerhards), 2008-12-08\n- security bugfix: $AllowedSender was not honored, all senders were\n  permitted instead (see http://www.rsyslog.com/Article322.phtml)\n  (backport from v3-stable, v3.20.9)\n- minor bugfix: dual close() call on tcp session closure\n---------------------------------------------------------------------------\nVersion 3.18.5 (rgerhards), 2008-10-09\n- bugfix: imudp input module could cause segfault on HUP\n  It did not properly de-init a variable acting as a linked list head.\n  That resulted in trying to access freed memory blocks after the HUP.\n- bugfix:  rsyslogd could hang on HUP\n  because getnameinfo() is not cancel-safe, but was not guarded against\n  being cancelled. pthread_cancel() is routinely being called during\n  HUP processing.\n- bugfix[minor]: if queue size reached light_delay mark, enqueuing\n  could potentially be blocked for a longer period of time, which\n  was not the behaviour desired.\n- doc bugfix: $ActionExecOnlyWhenPreviousIsSuspended was still misspelled\n  as $...OnlyIfPrev... in some parts of the documentation. Thanks to \n  Lorenzo M. Catucci for reporting this bug.\n- added doc on malformed messages, cause and how to work-around, to the\n  doc set\n- added doc on how to build from source repository\n---------------------------------------------------------------------------\nVersion 3.18.4 (rgerhards), 2008-09-18\n- bugfix: order-of magnitude issue with base-10 size definitions\n  in config file parser. Could lead to invalid sizes, constraints\n  etc for e.g. queue files and any other object whose size was specified\n  in base-10 entities. Did not apply to binary entities. Thanks to\n  RB for finding this bug and providing a patch.\n- bugfix: action was not called when system time was set backwards\n  (until the previous time was reached again). There are still some\n  side-effects when time is rolled back (A time rollback is really a bad\n  thing to do, ideally the OS should issue pseudo time (like NetWare did)\n  when the user tries to roll back time). Thanks to varmojfekoj for this\n  patch.\n- doc bugfix: rsyslog.conf man page improved and minor nit fixed\n  thanks to Lukas Kuklinek for the patch.\n- bugfix: error code -2025 was used for two different errors. queue full\n  is now -2074 and -2025 is unique again. (did cause no real problem\n  except for troubleshooting)\n- bugfix: default discard severity was incorrectly set to 4, which lead\n  to discard-on-queue-full to be enabled by default. That could cause\n  message loss where non was expected.  The default has now been changed\n  to the correct value of 8, which disables the functionality. This\n  problem applied both to the main message queue and the action queues.\n  Thanks to Raoul Bhatia for pointing out this problem.\n- bugfix: option value for legacy -a option could not be specified,\n  resulting in strange operations. Thanks to Marius Tomaschewski\n  for the patch.\n- bugfix: colon after date should be ignored, but was not. This has\n  now been corrected. Required change to the internal ParseTIMESTAMP3164()\n  interface.\n---------------------------------------------------------------------------\nVersion 3.18.3 (rgerhards), 2008-08-18\n- bugfix: imfile could cause a segfault upon rsyslogd HUP and termination\n  Thanks to lperr for an excellent bug report that helped detect this\n  problem.\n- enhanced ommysql to support custom port to connect to server\n  Port can be set via new $ActionOmmysqlServerPort config directive\n  Note: this was a very minor change and thus deemed appropriate to be\n  done in the stable release.\n- bugfix: misspelled config directive, previously was\n  $MainMsgQueueWorkeTimeoutrThreadShutdown, is now\n  $MainMsgQueueWorkerTimeoutThreadShutdown. Note that the misspelled\n  directive is not preserved - if the misspelled directive was used\n  (which I consider highly unlikely), the config file must be changed.\n  Thanks to lperr for reporting the bug.\n- disabled flow control for imuxsock, as it could cause system hangs\n  under some circumstances. The devel (3.21.3 and above) will\n  re-enable it and provide enhanced configurability to overcome the\n  problems if they occur.\n---------------------------------------------------------------------------\nVersion 3.18.2 (rgerhards), 2008-08-08\n- merged in IPv6 forwarding address bugfix from v2-stable\n---------------------------------------------------------------------------\nVersion 3.18.1 (rgerhards), 2008-07-21\n- bugfix: potential segfault in creating message mutex in non-direct queue\n  mode. rsyslogd segfaults on freeeBSD 7.0 (an potentially other platforms)\n  if an action queue is running in any other mode than non-direct. The\n  same problem can potentially be triggered by some main message queue\n  settings. In any case, it will manifest during rsylog's startup. It is\n  unlikely to happen after a successful startup (the only window of\n  exposure may be a relatively seldom executed action running in queued\n  mode). This has been corrected. Thank to HKS for point out the problem.\n- bugfix: priority was incorrectly calculated on FreeBSD 7,\n  because the LOG_MAKEPRI() C macro has a different meaning there (it\n  is just a simple addition of faciltity and severity). I have changed\n  this to use own, consistent, code for PRI calculation. [Backport from\n  3.19.10]\n- bugfix: remove PRI part from kernel message if it is present\n  Thanks to Michael Biebl for reporting this bug\n- bugfix: mark messages were not correctly written to text log files\n  the markmessageinterval was not correctly propagated to all places\n  where it was needed. This resulted in rsyslog using the default\n  (20 minutes) in some code pathes, what looked to the user like mark\n  messages were never written.\n- added a new property replacer option \"sp-if-no-1st-sp\" to cover\n  a problem with RFC 3164 based interpreation of tag separation. While\n  it is a generic approach, it fixes a format problem introduced in\n  3.18.0, where kernel messages no longer had a space after the tag.\n  This is done by a modifcation of the default templates.\n  Please note that this may affect some messages where there intentionally\n  is no space between the tag and the first character of the message\n  content. If so, this needs to be worked around via a specific\n  template. However, we consider this scenario to be quite remote and,\n  even if it exists, it is not expected that it will actually cause\n  problems with log parsers (instead, we assume the new default template\n  behaviour may fix previous problems with log parsers due to the \n  missing space).\n- bugfix: imklog module was not correctly compiled for GNU/kFreeBSD.\n  Thanks to Petr Salinger for the patch\n- doc bugfix: property replacer options secpath-replace and\n  secpath-drop were not documented\n- doc bugfix: fixed some typos in rsyslog.conf man page\n- fixed typo in source comment  - thanks to Rio Fujita\n- some general cleanup (thanks to Michael Biebl)\n---------------------------------------------------------------------------\nVersion 3.18.0 (rgerhards), 2008-07-11\n- begun a new v3-stable based on former 3.17.4 beta plus patches to\n  previous v3-stable\n- bugfix in RainerScript: syntax error was not always detected\n---------------------------------------------------------------------------\nVersion 3.17.5 (rgerhards), 2008-06-27\n- added doc: howto set up a reliable connection to remote server via\n  queued mode (and plain tcp protocol)\n- bugfix: comments after actions were not properly treated. For some\n  actions (e.g. forwarding), this could also lead to invalid configuration\n---------------------------------------------------------------------------\nVersion 3.17.4 (rgerhards), 2008-06-16\n- changed default for $KlogSymbolLookup to \"off\". The directive is\n  also scheduled for removal in a later version. This was necessary\n  because on kernels >= 2.6, the kernel does the symbol lookup itself. The\n  imklog lookup logic then breaks the log message and makes it unusable.\n---------------------------------------------------------------------------\nVersion 3.17.3 (rgerhards), 2008-05-28\n- bugfix: imklog went into an endless loop if a PRI value was inside\n  a kernel log message (unusual case under Linux, frequent under BSD)\n---------------------------------------------------------------------------\nVersion 3.17.2 (rgerhards), 2008-05-04\n- this version is the new beta, based on 3.17.1 devel feature set\n- merged in imklog bug fix from v3-stable (3.16.1)\n---------------------------------------------------------------------------\nVersion 3.17.1 (rgerhards), 2008-04-15\n- removed dependency on MAXHOSTNAMELEN as much as it made sense.\n  GNU/Hurd does not define it (because it has no limit), and we have taken\n  care for cases where it is undefined now. However, some very few places\n  remain where IMHO it currently is not worth fixing the code. If it is\n  not defined, we have used a generous value of 1K, which is above IETF\n  RFC's on hostname length at all. The memory consumption is no issue, as\n  there are only a handful of this buffers allocated *per run* -- that's\n  also the main reason why we consider it not worth to be fixed any further.\n- enhanced legacy syslog parser to handle slightly malformed messages\n  (with a space in front of the timestamp) - at least HP procurve is\n  known to do that and I won't outrule that others also do it. The \n  change looks quite unintrusive and so we added it to the parser.\n- implemented klogd functionality for BSD\n- implemented high precision timestamps for the kernel log. Thanks to\n  Michael Biebl for pointing out that the kernel log did not have them.\n- provided ability to discard non-kernel messages if they are present\n  in the kernel log (seems to happen on BSD)\n- implemented $KLogInternalMsgFacility config directive\n- implemented $KLogPermitNonKernelFacility config directive\nPlus a number of bugfixes that were applied to v3-stable and beta\nbranches (not mentioned here in detail).\n---------------------------------------------------------------------------\nVersion 3.17.0 (rgerhards), 2008-04-08\n- added native ability to send mail messages\n- removed no longer needed file relptuil.c/.h\n- added $ActionExecOnlyOnceEveryInterval config directive\n- bugfix: memory leaks in script engine\n- bugfix: zero-length strings were not supported in object\n  deserializer\n- properties are now case-insensitive everywhere (script, filters,\n  templates)\n- added the capability to specify a processing (actually dequeue)\n  timeframe with queues - so things can be configured to be done\n  at off-peak hours\n- We have removed the 32 character size limit (from RFC3164) on the\n  tag. This had bad effects on existing envrionments, as sysklogd didn't\n  obey it either (probably another bug in RFC3164...). We now receive\n  the full size, but will modify the outputs so that only 32 characters\n  max are used by default. If you need large tags in the output, you need\n  to provide custom templates.\n- changed command line processing. -v, -M, -c options are now parsed\n  and processed before all other options. Inter-option dependencies\n  have been relieved. Among others, permits to specify intial module\n  load path via -M only (not the environment) which makes it much\n  easier to work with non-standard module library locations. Thanks\n  to varmojfekoj for suggesting this change. Matches bugzilla bug 55.\n- bugfix: some messages were emited without hostname\nPlus a number of bugfixes that were applied to v3-stable and beta\nbranches (not mentioned here in detail).\n---------------------------------------------------------------------------\nVersion 3.16.3 (rgerhards), 2008-07-11\n- updated information on rsyslog packages\n- bugfix: memory leak in disk-based queue modes\n---------------------------------------------------------------------------\nVersion 3.16.2 (rgerhards), 2008-06-25\n- fixed potential segfault due to invalid call to cfsysline\n  thanks to varmojfekoj for the patch\n- bugfix: some whitespaces where incorrectly not ignored when parsing\n  the config file. This is now corrected. Thanks to Michael Biebl for\n  pointing out the problem.\n---------------------------------------------------------------------------\nVersion 3.16.1 (rgerhards), 2008-05-02\n- fixed a bug in imklog which lead to startup problems (including\n  segfault) on some platforms under some circumsances. Thanks to\n  Vieri for reporting this bug and helping to troubleshoot it.\n---------------------------------------------------------------------------\nVersion 3.16.0 (rgerhards), 2008-04-24\n- new v3-stable (3.16.x) based on beta 3.15.x (RELP support)\n- bugfix: omsnmp had a too-small sized buffer for hostname+port. This\n  could not lead to a segfault, as snprintf() was used, but could cause\n  some trouble with extensively long hostnames.\n- applied patch from Tiziano M\u00fcller to remove some compiler warnings\n- added gssapi overview/howto thanks to Peter Vrabec\n- changed some files to grant LGPLv3 extended persmissions on top of GPLv3\n  this also is the first sign of something that will evolve into a\n  well-defined \"rsyslog runtime library\"\n---------------------------------------------------------------------------\nVersion 3.15.1 (rgerhards), 2008-04-11\n- bugfix: some messages were emited without hostname\n- disabled atomic operations for the time being because they introduce some\n  cross-platform trouble - need to see how to fix this in the best \n  possible way\n- bugfix: zero-length strings were not supported in object\n  deserializer\n- added librelp check via PKG_CHECK thanks to Michael Biebl's patch\n- file relputil.c deleted, is not actually needed\n- added more meaningful error messages to rsyslogd (when some errors\n  happens during startup)\n- bugfix: memory leaks in script engine\n- bugfix: $hostname and $fromhost in RainerScript did not work\nThis release also includes all changes applied to the stable versions\nup to today.\n---------------------------------------------------------------------------\nVersion 3.15.0 (rgerhards), 2008-04-01\n- major new feature: imrelp/omrelp support reliable delivery of syslog\n  messages via the RELP protocol and librelp (http://www.librelp.com).\n  Plain tcp syslog, so far the best reliability solution, can lose\n  messages when something goes wrong or a peer goes down. With RELP,\n  this can no longer happen. See imrelp.html for more details.\n- bugfix: rsyslogd was no longer build by default; man pages are \n  only installed if corresponding option is selected. Thanks to\n  Michael Biebl for pointing these problems out.\n---------------------------------------------------------------------------\nVersion 3.14.2 (rgerhards), 2008-04-09\n- bugfix: segfault with expression-based filters\n- bugfix: omsnmp did not deref errmsg object on exit (no bad effects caused)\n- some cleanup\n- bugfix: imklog did not work well with kernel 2.6+. Thanks to Peter\n  Vrabec for patching it based on the development in sysklogd - and thanks\n  to the sysklogd project for upgrading klogd to support the new\n  functionality\n- some cleanup in imklog\n- bugfix: potential segfault in imklog when kernel is compiled without\n  /proc/kallsyms and the file System.map is missing. Thanks to\n  Andrea Morandi for pointing it out and suggesting a fix.\n- bugfixes, credits to varmojfekoj:\n  * reset errno before printing a warning message\n  * misspelled directive name in code processing legacy options\n- bugfix: some legacy options not correctly interpreted - thanks to\n  varmojfekoj for the patch\n- improved detection of modules being loaded more than once\n  thanks to varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 3.14.1 (rgerhards), 2008-04-04\n- bugfix: some messages were emited without hostname\n- bugfix: rsyslogd was no longer build by default; man pages are \n  only installed if corresponding option is selected. Thanks to\n  Michael Biebl for pointing these problems out.\n- bugfix: zero-length strings were not supported in object\n  deserializer\n- disabled atomic operations for this stable build as it caused\n  platform problems\n- bugfix: memory leaks in script engine\n- bugfix: $hostname and $fromhost in RainerScript did not work\n- bugfix: some memory leak when queue is runing in disk mode\n- man pages improved thanks to varmofekoj and Peter Vrabec\n- We have removed the 32 character size limit (from RFC3164) on the\n  tag. This had bad effects on existing envrionments, as sysklogd didn't\n  obey it either (probably another bug in RFC3164...). We now receive\n  the full size, but will modify the outputs so that only 32 characters\n  max are used by default. If you need large tags in the output, you need\n  to provide custom templates.\n- bugfix: some memory leak when queue is runing in disk mode\n---------------------------------------------------------------------------\nVersion 3.14.0 (rgerhards), 2008-04-02\nAn interim version was accidently released to the web. It was named 3.14.0.\nTo avoid confusion, we have not assigned this version number to any\nofficial release. If you happen to use 3.14.0, please update to 3.14.1.\n---------------------------------------------------------------------------\nVersion 3.13.0-dev0 (rgerhards), 2008-03-31\n- bugfix: accidently set debug option in 3.12.5 reset to production\n  This option prevented dlclose() to be called. It had no real bad effects,\n  as the modules were otherwise correctly deinitialized and dlopen()\n  supports multiple opens of the same module without any memory footprint.\n- removed --enable-mudflap, added --enable-valgrind ./configure setting\n- bugfix: tcp receiver could segfault due to uninitialized variable\n- docfix: queue doc had a wrong directive name that prevented max worker\n  threads to be correctly set\n- worked a bit on atomic memory operations to support problem-free\n  threading (only at non-intrusive places)\n- added a --enable/disable-rsyslogd configure option so that\n  source-based packaging systems can build plugins without the need\n  to compile rsyslogd\n- some cleanup\n- test of potential new version number scheme\n---------------------------------------------------------------------------\nVersion 3.12.5 (rgerhards), 2008-03-28\n- changed default for \"last message repeated n times\", which is now\n  off by default\n- implemented backward compatibility commandline option parsing\n- automatically generated compatibility config lines are now also\n  logged so that a user can diagnose problems with them\n- added compatibility mode for -a, -o and -p options\n- compatibility mode processing finished\n- changed default file output format to include high-precision timestamps\n- added a buid-in template for previous syslogd file format\n- added new $ActionFileDefaultTemplate directive\n- added support for high-precision timestamps when receiving legacy\n  syslog messages\n- added new $ActionForwardDefaultTemplate directive\n- added new $ActionGSSForwardDefaultTemplate directive\n- added build-in templates for easier configuration\n- bugfix: fixed small memory leak in tcpclt.c\n- bugfix: fixed small memory leak in template regular expressions\n- bugfix: regular expressions inside property replacer did not work\n  properly\n- bugfix: QHOUR and HHOUR properties were wrongly calculated\n- bugfix: fixed memory leaks in stream class and imfile\n- bugfix: $ModDir did invalid bounds checking, potential overlow in\n  dbgprintf() - thanks to varmojfekoj for the patch\n- bugfix: -t and -g legacy options max number of sessions had a wrong\n  and much too high value\n---------------------------------------------------------------------------\nVersion 3.12.4 (rgerhards), 2008-03-25\n- Greatly enhanced rsyslogd's file write performance by disabling\n  file syncing capability of output modules by default. This\n  feature is usually not required, not useful and an extreme performance\n  hit (both to rsyslogd as well as the system at large). Unfortunately,\n  most users enable it by default, because it was most intuitive to enable\n  it in plain old sysklogd syslog.conf format. There is now the\n  $ActionFileEnableSync config setting which must be enabled in order to\n  support syncing. By default it is off. So even if the old-format config\n  lines request syncing, it is not done unless explicitely enabled. I am\n  sure this is a very useful change and not a risk at all. I need to think\n  if I undo it under compatibility mode, but currently this does not\n  happen (I fear a lot of lazy users will run rsyslogd in compatibility\n  mode, again bringing up this performance problem...).\n- added flow control options to other input sources\n- added $HHOUR and $QHOUR system properties - can be used for half- and\n  quarter-hour logfile rotation\n- changed queue's discard severities default value to 8 (do not discard)\n  to prevent unintentional message loss\n- removed a no-longer needed callback from the output module \n  interface. Results in reduced code complexity.\n- bugfix/doc: removed no longer supported -h option from man page\n- bugfix: imklog leaked several hundered KB on each HUP. Thanks to\n  varmojfekoj for the patch\n- bugfix: potential segfault on module unload. Thanks to varmojfekoj for\n  the patch\n- bugfix: fixed some minor memory leaks\n- bugfix: fixed some slightly invalid memory accesses\n- bugfix: internally generated messages had \"FROMHOST\" property not set\n---------------------------------------------------------------------------\nVersion 3.12.3 (rgerhards), 2008-03-18\n- added advanced flow control for congestion cases (mode depending on message\n  source and its capablity to be delayed without bad side effects)\n- bugfix: $ModDir should not be reset on $ResetConfig - this can cause a lot\n  of confusion and there is no real good reason to do so. Also conflicts with\n  the new -M option and environment setting.\n- bugfix: TCP and GSSAPI framing mode variable was uninitialized, leading to\n  wrong framing (caused, among others, interop problems)\n- bugfix: TCP (and GSSAPI) octet-counted frame did not work correctly in all\n  situations. If the header was split across two packet reads, it was invalidly\n  processed, causing loss or modification of messages.\n- bugfix: memory leak in imfile\n- bugfix: duplicate public symbol in omfwd and omgssapi could lead to\n  segfault. thanks to varmojfekoj for the patch.\n- bugfix: rsyslogd aborted on sigup - thanks to varmojfekoj for the patch\n- some more internal cleanup ;)\n- begun relp modules, but these are not functional yet\n- Greatly enhanced rsyslogd's file write performance by disabling\n  file syncing capability of output modules by default. This\n  feature is usually not required, not useful and an extreme performance\n  hit (both to rsyslogd as well as the system at large). Unfortunately,\n  most users enable it by default, because it was most intuitive to enable\n  it in plain old sysklogd syslog.conf format. There is now a new config\n  setting which must be enabled in order to support syncing. By default it\n  is off. So even if the old-format config lines request syncing, it is\n  not done unless explicitely enabled. I am sure this is a very useful\n  change and not a risk at all. I need to think if I undo it under\n  compatibility mode, but currently this does not happen (I fear a lot of\n  lazy users will run rsyslogd in compatibility mode, again bringing up\n  this performance problem...).\n---------------------------------------------------------------------------\nVersion 3.12.2 (rgerhards), 2008-03-13\n- added RSYSLOGD_MODDIR environment variable\n- added -M rsyslogd option (allows to specify module directory location)\n- converted net.c into a loadable library plugin\n- bugfix: debug module now survives unload of loadable module when\n  printing out function call data\n- bugfix: not properly initialized data could cause several segfaults if\n  there were errors in the config file - thanks to varmojfekoj for the patch\n- bugfix: rsyslogd segfaulted when imfile read an empty line - thanks\n  to Johnny Tan for an excellent bug report\n- implemented dynamic module unload capability (not visible to end user)\n- some more internal cleanup\n- bugfix: imgssapi segfaulted under some conditions; this fix is actually\n  not just a fix but a change in the object model. Thanks to varmojfekoj\n  for providing the bug report, an initial fix and lots of good discussion\n  that lead to where we finally ended up.\n- improved session recovery when outbound tcp connection breaks, reduces\n  probability of message loss at the price of a highly unlikely potential\n  (single) message duplication\n---------------------------------------------------------------------------\nVersion 3.12.1 (rgerhards), 2008-03-06\n- added library plugins, which can be automatically loaded\n- bugfix: actions were not correctly retried; caused message loss\n- changed module loader to automatically add \".so\" suffix if not\n  specified (over time, this shall also ease portability of config\n  files)\n- improved debugging support; debug runtime options can now be set via\n  an environment variable\n- bugfix: removed debugging code that I forgot to remove before releasing\n  3.12.0 (does not cause harm and happened only during startup)\n- added support for the MonitorWare syslog MIB to omsnmp\n- internal code improvements (more code converted into classes)\n- internal code reworking of the imtcp/imgssapi module\n- added capability to ignore client-provided timestamp on unix sockets and\n  made this mode the default; this was needed, as some programs (e.g. sshd)\n  log with inconsistent timezone information, what messes up the local\n  logs (which by default don't even contain time zone information). This\n  seems to be consistent with what sysklogd did for the past four years.\n  Alternate behaviour may be desirable if gateway-like processes send\n  messages via the local log slot - in this case, it can be enabled\n  via the $InputUnixListenSocketIgnoreMsgTimestamp and\n  $SystemLogSocketIgnoreMsgTimestamp config directives\n- added ability to compile on HP UX; verified that imudp worked on HP UX;\n  however, we are still in need of people trying out rsyslogd on HP UX,\n  so it can not yet be assumed it runs there\n- improved session recovery when outbound tcp connection breaks, reduces\n  probability of message loss at the price of a highly unlikely potential\n  (single) message duplication\n---------------------------------------------------------------------------\nVersion 3.12.0 (rgerhards), 2008-02-28\n- added full expression support for filters; filters can now contain\n  arbitrary complex boolean, string and arithmetic expressions\n---------------------------------------------------------------------------\nVersion 3.11.6 (rgerhards), 2008-02-27\n- bugfix: gssapi libraries were still linked to rsyslog core, what should\n  no longer be necessary. Applied fix by Michael Biebl to solve this.\n- enabled imgssapi to be loaded side-by-side with imtcp\n- added InputGSSServerPermitPlainTCP config directive\n- split imgssapi source code somewhat from imtcp\n- bugfix: queue cancel cleanup handler could be called with\n  invalid pointer if dequeue failed\n- bugfix: rsyslogd segfaulted on second SIGHUP\n  tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=38\n- improved stability of queue engine\n- bugfix: queue disk file were not properly persisted when \n  immediately after closing an output file rsyslog was stopped\n  or huped (the new output file open must NOT have happend at\n  that point) - this lead to a sparse and invalid queue file\n  which could cause several problems to the engine (unpredictable\n  results). This situation should have happened only in very\n  rare cases. tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=40\n- bugfix: during queue shutdown, an assert invalidly triggered when\n  the primary queue's DA worker was terminated while the DA queue's\n  regular worker was still executing. This could result in a segfault\n  during shutdown.\n  tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=41\n- bugfix: queue properties sizeOnDisk, bytesRead were persisted to \n  disk with wrong data type (long instead of int64) - could cause\n  problems on 32 bit machines\n- bugfix: queue aborted when it was shut down, DA-enabled, DA mode\n  was just initiated but not fully initialized (a race condition)\n- bugfix: imfile could abort under extreme stress conditions\n  (when it was terminated before it could open all of its\n  to be monitored files)\n- applied patch from varmojfekoj to fix an issue with compatibility \n  mode and default module directories (many thanks!):\n  I've also noticed a bug in the compatibility code; the problem is that \n  options are parsed before configuration file so options which need a \n  module to be loaded will currently ignore any $moddir directive. This \n  can be fixed by moving legacyOptsHook() after config file parsing. \n  (see the attached patch) This goes against the logical order of \n  processing, but the legacy options are only few and it doesn't seem to \n  be a problem.\n- bugfix: object property deserializer did not handle negative numbers\n---------------------------------------------------------------------------\nVersion 3.11.5 (rgerhards), 2008-02-25\n- new imgssapi module, changed imtcp module - this enables to load/package\n  GSSAPI support separately - thanks to varmojfekoj for the patch\n- compatibility mode (the -c option series) is now at least partly\n  completed - thanks to varmojfekoj for the patch\n- documentation for imgssapi and imtcp added\n- duplicate $ModLoad's for the same module are now detected and\n  rejected -- thanks to varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 3.11.4 (rgerhards), 2008-02-21\n- bugfix: debug.html was missing from release tarball - thanks to Michael\n  Biebl for bringing this to my attention\n- some internal cleanup on the stringbuf object calling interface\n- general code cleanup and further modularization\n- $MainMessageQueueDiscardSeverity can now also handle textual severities\n  (previously only integers)\n- bugfix: message object was not properly synchronized when the \n  main queue had a single thread and non-direct action queues were used\n- some documentation improvements\n---------------------------------------------------------------------------\nVersion 3.11.3 (rgerhards), 2008-02-18\n- fixed a bug in imklog which lead to duplicate message content in\n  kernel logs\n- added support for better plugin handling in libdbi (we contributed\n  a patch to do that, we just now need to wait for the next libdbi\n  version)\n- bugfix: fixed abort when invalid template was provided to an action\n  bug http://bugzilla.adiscon.com/show_bug.cgi?id=4\n- re-instantiated SIGUSR1 function; added SIGUSR2 to generate debug\n  status output\n- added some documentation on runtime-debug settings\n- slightly improved man pages for novice users\n---------------------------------------------------------------------------\nVersion 3.11.2 (rgerhards), 2008-02-15\n- added the capability to monitor text files and process their content\n  as syslog messages (including forwarding)\n- added support for libdbi, a database abstraction layer. rsyslog now\n  also supports the following databases via dbi drivers:\n  * Firebird/Interbase\n  * FreeTDS (access to MS SQL Server and Sybase)\n  * SQLite/SQLite3\n  * Ingres (experimental)\n  * mSQL (experimental)\n  * Oracle (experimental)\n  Additional drivers may be provided by the libdbi-drivers project, which\n  can be used by rsyslog as soon as they become available.\n- removed some left-over unnecessary dbgprintf's (cluttered screen,\n  cosmetic)\n- doc bugfix: html documentation for omsnmp was missing\n---------------------------------------------------------------------------\nVersion 3.11.1 (rgerhards), 2008-02-12\n- SNMP trap sender added thanks to Andre Lorbach (omsnmp)\n- added input-plugin interface specification in form of a (copy) template\n  input module\n- applied documentation fix by Michael Biebl -- many thanks!\n- bugfix: immark did not have MARK flags set...\n- added x-info field to rsyslogd startup/shutdown message. Hopefully\n  points users to right location for further info (many don't even know\n  they run rsyslog ;))\n- bugfix: trailing \":\" of tag was lost while parsing legacy syslog messages\n  without timestamp - thanks to Anders Blomdell for providing a patch!\n- fixed a bug in stringbuf.c related to STRINGBUF_TRIM_ALLOCSIZE, which\n  wasn't supposed to be used with rsyslog. Put a warning message up that\n  tells this feature is not tested and probably not worth the effort.\n  Thanks to Anders Blomdell fro bringing this to our attention\n- somewhat improved performance of string buffers\n- fixed bug that caused invalid treatment of tabs (HT) in rsyslog.conf\n- bugfix: setting for $EscapeCopntrolCharactersOnReceive was not \n  properly initialized\n- clarified usage of space-cc property replacer option\n- improved abort diagnostic handler\n- some initial effort for malloc/free runtime debugging support\n- bugfix: using dynafile actions caused rsyslogd abort\n- fixed minor man errors thanks to Michael Biebl\n---------------------------------------------------------------------------\nVersion 3.11.0 (rgerhards), 2008-01-31\n- implemented queued actions\n- implemented simple rate limiting for actions\n- implemented deliberate discarding of lower priority messages over higher\n  priority ones when a queue runs out of space\n- implemented disk quotas for disk queues\n- implemented the $ActionResumeRetryCount config directive\n- added $ActionQueueFilename config directive\n- added $ActionQueueSize config directive\n- added $ActionQueueHighWaterMark config directive\n- added $ActionQueueLowWaterMark config directive\n- added $ActionQueueDiscardMark config directive\n- added $ActionQueueDiscardSeverity config directive\n- added $ActionQueueCheckpointInterval config directive\n- added $ActionQueueType config directive\n- added $ActionQueueWorkerThreads config directive\n- added $ActionQueueTimeoutshutdown config directive\n- added $ActionQueueTimeoutActionCompletion config directive\n- added $ActionQueueTimeoutenQueue config directive\n- added $ActionQueueTimeoutworkerThreadShutdown config directive\n- added $ActionQueueWorkerThreadMinimumMessages config directive\n- added $ActionQueueMaxFileSize config directive\n- added $ActionQueueSaveonShutdown config directive\n- addded $ActionQueueDequeueSlowdown config directive\n- addded $MainMsgQueueDequeueSlowdown config directive\n- bugfix: added forgotten docs to package\n- improved debugging support\n- fixed a bug that caused $MainMsgQueueCheckpointInterval to work incorrectly\n- when a long-running action needs to be cancelled on shutdown, the message\n  that was processed by it is now preserved. This finishes support for\n  guaranteed delivery of messages (if the output supports it, of course)\n- fixed bug in output module interface, see\n  http://sourceforge.net/tracker/index.php?func=detail&aid=1881008&group_id=123448&atid=696552\n- changed the ommysql output plugin so that the (lengthy) connection\n  initialization now takes place in message processing. This works much\n  better with the new queued action mode (fast startup)\n- fixed a bug that caused a potential hang in file and fwd output module\n  varmojfekoj provided the patch - many thanks!\n- bugfixed stream class offset handling on 32bit platforms\n---------------------------------------------------------------------------\nVersion 3.10.3 (rgerhards), 2008-01-28\n- fixed a bug with standard template definitions (not a big deal) - thanks\n  to varmojfekoj for spotting it\n- run-time instrumentation added\n- implemented disk-assisted queue mode, which enables on-demand disk\n  spooling if the queue's in-memory queue is exhausted\n- implemented a dynamic worker thread pool for processing incoming\n  messages; workers are started and shut down as need arises\n- implemented a run-time instrumentation debug package\n- implemented the $MainMsgQueueSaveOnShutdown config directive\n- implemented the $MainMsgQueueWorkerThreadMinimumMessages config directive\n- implemented the $MainMsgQueueTimeoutWorkerThreadShutdown config directive\n---------------------------------------------------------------------------\nVersion 3.10.2 (rgerhards), 2008-01-14\n- added the ability to keep stop rsyslogd without the need to drain\n  the main message queue. In disk queue mode, rsyslog continues to\n  run from the point where it stopped. In case of a system failure, it\n  continues to process messages from the last checkpoint.\n- fixed a bug that caused a segfault on startup when no $WorkDir directive\n  was specified in rsyslog.conf\n- provided more fine-grain control over shutdown timeouts and added a\n  way to specify the enqueue timeout when the main message queue is full\n- implemented $MainMsgQueueCheckpointInterval config directive\n- implemented $MainMsgQueueTimeoutActionCompletion config directive\n- implemented $MainMsgQueueTimeoutEnqueue config directive\n- implemented $MainMsgQueueTimeoutShutdown config directive\n---------------------------------------------------------------------------\nVersion 3.10.1 (rgerhards), 2008-01-10\n- implemented the \"disk\" queue mode. However, it currently is of very\n  limited use, because it does not support persistence over rsyslogd\n  runs. So when rsyslogd is stopped, the queue is drained just as with\n  the in-memory queue modes. Persistent queues will be a feature of\n  the next release.\n- performance-optimized string class, should bring an overall improvement\n- fixed a memory leak in imudp -- thanks to varmojfekoj for the patch\n- fixed a race condition that could lead to a rsyslogd hang when during\n  HUP or termination\n- done some doc updates\n- added $WorkDirectory config directive\n- added $MainMsgQueueFileName config directive\n- added $MainMsgQueueMaxFileSize config directive\n---------------------------------------------------------------------------\nVersion 3.10.0 (rgerhards), 2008-01-07\n- implemented input module interface and initial input modules\n- enhanced threading for input modules (each on its own thread now)\n- ability to bind UDP listeners to specific local interfaces/ports and\n  ability to run multiple of them concurrently\n- added ability to specify listen IP address for UDP syslog server\n- license changed to GPLv3\n- mark messages are now provided by loadble module immark\n- rklogd is no longer provided. Its functionality has now been taken over\n  by imklog, a loadable input module. This offers a much better integration\n  into rsyslogd and makes sure that the kernel logger process is brought\n  up and down at the appropriate times\n- enhanced $IncludeConfig directive to support wildcard characters\n  (thanks to Michael Biebl)\n- all inputs are now implemented as loadable plugins\n- enhanced threading model: each input module now runs on its own thread\n- enhanced message queue which now supports different queueing methods\n  (among others, this can be used for performance fine-tuning)\n- added a large number of new configuration directives for the new\n  input modules\n- enhanced multi-threading utilizing a worker thread pool for the\n  main message queue\n- compilation without pthreads is no longer supported\n- much cleaner code due to new objects and removal of single-threading\n  mode\n---------------------------------------------------------------------------\nVersion 2.0.8 V2-STABLE (rgerhards), 2008-??-??\n- bugfix: ompgsql did not detect problems in sql command execution\n  this could cause loss of messages. The handling was correct if the\n  connection broke, but not if there was a problem with statement\n  execution. The most probable case for such a case would be invalid\n  sql inside the template, and this is now much easier to diagnose.\n- doc bugfix: default for $DirCreateMode incorrectly stated\n---------------------------------------------------------------------------\nVersion 2.0.7 V2-STABLE (rgerhards), 2008-04-14\n- bugfix: the default for $DirCreateMode was 0644, and as such wrong.\n  It has now been changed to 0700. For some background, please see\n  http://lists.adiscon.net/pipermail/rsyslog/2009-April/001986.html\n- bugfix: \"$CreateDirs off\" also disabled file creation\n  Thanks to William Tisater for analyzing this bug and providing a patch.\n  The actual code change is heavily based on William's patch.\n- bugfix: memory leak in ompgsql\n  Thanks to Ken for providing the patch\n- bugfix: potential memory leak in msg.c\n  This one did not surface yet and the issue was actually found due to\n  a problem in v4 - but better fix it here, too\n---------------------------------------------------------------------------\nVersion 2.0.6 V2-STABLE (rgerhards), 2008-08-07\n- bugfix: memory leaks in rsyslogd, primarily in singlethread mode\n  Thanks to Frederico Nunez for providing the fix\n- bugfix: copy&paste error lead to dangling if - this caused a very minor\n  issue with re-formatting a RFC3164 date when the message was invalidly\n  formatted and had a colon immediately after the date. This was in the\n  code for some years (even v1 had it) and I think it never had any\n  effect at all in practice. Though, it should be fixed - but definitely\n  nothing to worry about.\n---------------------------------------------------------------------------\nVersion 2.0.6 V2-STABLE (rgerhards), 2008-08-07\n- bugfix: IPv6 addresses could not be specified in forwarding actions\n  New syntax @[addr]:port introduced to enable that. Root problem was IPv6\n  addresses contain colons. (backport from 3.21.3)\n---------------------------------------------------------------------------\nVersion 2.0.5 STABLE (rgerhards), 2008-05-15\n- bugfix: regular expressions inside property replacer did not work\n  properly\n- adapted to liblogging 0.7.1+\n---------------------------------------------------------------------------\nVersion 2.0.4 STABLE (rgerhards), 2008-03-27\n- bugfix: internally generated messages had \"FROMHOST\" property not set\n- bugfix: continue parsing if tag is oversize (discard oversize part) - thanks\n  to mclaughlin77@gmail.com for the patch\n- added $HHOUR and $QHOUR system properties - can be used for half- and\n  quarter-hour logfile rotation\n---------------------------------------------------------------------------\nVersion 2.0.3 STABLE (rgerhards), 2008-03-12\n- bugfix: setting for $EscapeCopntrolCharactersOnReceive was not \n  properly initialized\n- bugfix: resolved potential segfault condition on HUP (extremely\n  unlikely to happen in practice), for details see tracker:\n  http://bugzilla.adiscon.com/show_bug.cgi?id=38\n- improved the man pages a bit - thanks to Michael Biebl for the patch\n- bugfix: not properly initialized data could cause several segfaults if\n  there were errors in the config file - thanks to varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 2.0.2 STABLE (rgerhards), 2008-02-12\n- fixed a bug that could cause invalid string handling via strerror_r\n  varmojfekoj provided the patch - many thanks!\n- added x-info field to rsyslogd startup/shutdown message. Hopefully\n  points users to right location for further info (many don't even know\n  they run rsyslog ;))\n- bugfix: suspended actions were not always properly resumed\n  varmojfekoj provided the patch - many thanks!\n- bugfix: errno could be changed during mark processing, leading to\n  invalid error messages when processing inputs. Thank to varmojfekoj for\n  pointing out this problem.\n- bugfix: trailing \":\" of tag was lost while parsing legacy syslog messages\n  without timestamp - thanks to Anders Blomdell for providing a patch!\n- bugfix (doc): misspelled config directive, invalid signal info\n- applied some doc fixes from Michel Biebl and cleaned up some no longer\n  needed files suggested by him\n- cleaned up stringbuf.c to fix an annoyance reported by Anders Blomdell\n- fixed bug that caused invalid treatment of tabs (HT) in rsyslog.conf\n---------------------------------------------------------------------------\nVersion 2.0.1 STABLE (rgerhards), 2008-01-24\n- fixed a bug in integer conversion - but this function was never called,\n  so it is not really a useful bug fix ;)\n- fixed a bug with standard template definitions (not a big deal) - thanks\n  to varmojfekoj for spotting it\n- fixed a bug that caused a potential hang in file and fwd output module\n  varmojfekoj provided the patch - many thanks!\n---------------------------------------------------------------------------\nVersion 2.0.0 STABLE (rgerhards), 2008-01-02\n- re-release of 1.21.2 as STABLE with no modifications except some\n  doc updates\n---------------------------------------------------------------------------\nVersion 1.21.2 (rgerhards), 2007-12-28\n- created a gss-api output module. This keeps GSS-API code and\n  TCP/UDP code separated. It is also important for forward-\n  compatibility with v3. Please note that this change breaks compatibility\n  with config files created for 1.21.0 and 1.21.1 - this was considered\n  acceptable.\n- fixed an error in forwarding retry code (could lead to message corruption\n  but surfaced very seldom)\n- increased portability for older platforms (AI_NUMERICSERV moved)\n- removed socket leak in omfwd.c\n- cross-platform patch for GSS-API compile problem on some platforms\n  thanks to darix for the patch!\n---------------------------------------------------------------------------\nVersion 1.21.1 (rgerhards), 2007-12-23\n- small doc fix for $IncludeConfig\n- fixed a bug in llDestroy()\n- bugfix: fixing memory leak when message queue is full and during\n  parsing. Thanks to varmojfekoj for the patch.\n- bugfix: when compiled without network support, unix sockets were\n  not properply closed\n- bugfix: memory leak in cfsysline.c/doGetWord() fixed\n---------------------------------------------------------------------------\nVersion 1.21.0 (rgerhards), 2007-12-19\n- GSS-API support for syslog/TCP connections was added. Thanks to\n  varmojfekoj for providing the patch with this functionality\n- code cleanup\n- enhanced $IncludeConfig directive to support wildcard filenames\n- changed some multithreading synchronization\n---------------------------------------------------------------------------\nVersion 1.20.1 (rgerhards), 2007-12-12\n- corrected a debug setting that survived release. Caused TCP connections\n  to be retried unnecessarily often.\n- When a hostname ACL was provided and DNS resolution for that name failed,\n  ACL processing was stopped at that point. Thanks to mildew for the patch.\n  Fedora Bugzilla: http://bugzilla.redhat.com/show_bug.cgi?id=395911\n- fixed a potential race condition, see link for details:\n  http://rgerhards.blogspot.com/2007/12/rsyslog-race-condition.html\n  Note that the probability of problems from this bug was very remote\n- fixed a memory leak that happend when PostgreSQL date formats were\n  used\n---------------------------------------------------------------------------\nVersion 1.20.0 (rgerhards), 2007-12-07\n- an output module for postgres databases has been added. Thanks to\n  sur5r for contributing this code\n- unloading dynamic modules has been cleaned up, we now have a\n  real implementation and not just a dummy \"good enough for the time\n  being\".\n- enhanced platform independence - thanks to Bartosz Kuzma and Michael\n  Biebl for their very useful contributions\n- some general code cleanup (including warnings on 64 platforms, only)\n---------------------------------------------------------------------------\nVersion 1.19.12 (rgerhards), 2007-12-03\n- cleaned up the build system (thanks to Michael Biebl for the patch)\n- fixed a bug where ommysql was still not compiled with -pthread option\n---------------------------------------------------------------------------\nVersion 1.19.11 (rgerhards), 2007-11-29\n- applied -pthread option to build when building for multi-threading mode\n  hopefully solves an issue with segfaulting\n---------------------------------------------------------------------------\nVersion 1.19.10 (rgerhards), 2007-10-19\n- introdcued the new \":modulename:\" syntax for calling module actions\n  in selector lines; modified ommysql to support it. This is primarily\n  an aid for further modules and a prequisite to actually allow third\n  party modules to be created.\n- minor fix in slackware startup script, \"-r 0\" is now \"-r0\"\n- updated rsyslogd doc set man page; now in html format\n- undid creation of a separate thread for the main loop -- this did not\n  turn out to be needed or useful, so reduce complexity once again.\n- added doc fixes provided by Michael Biebl - thanks\n---------------------------------------------------------------------------\nVersion 1.19.9 (rgerhards), 2007-10-12\n- now packaging system which again contains all components in a single\n  tarball\n- modularized main() a bit more, resulting in less complex code\n- experimentally added an additional thread - will see if that affects\n  the segfault bug we experience on some platforms. Note that this change\n  is scheduled to be removed again later.\n---------------------------------------------------------------------------\nVersion 1.19.8 (rgerhards), 2007-09-27\n- improved repeated message processing\n- applied patch provided by varmojfekoj to support building ommysql\n  in its own way (now also resides in a plugin subdirectory);\n  ommysql is now a separate package\n- fixed a bug in cvthname() that lead to message loss if part\n  of the source hostname would have been dropped\n- created some support for distributing ommysql together with the\n  main rsyslog package. I need to re-think it in the future, but\n  for the time being the current mode is best. I now simply include\n  one additional tarball for ommysql inside the main distribution.\n  I look forward to user feedback on how this should be done best. In the\n  long term, a separate project should be spawend for ommysql, but I'd\n  like to do that only after the plugin interface is fully stable (what\n  it is not yet).\n---------------------------------------------------------------------------\nVersion 1.19.7 (rgerhards), 2007-09-25\n- added code to handle situations where senders send us messages ending with\n  a NUL character. It is now simply removed. This also caused trailing LF\n  reduction to fail, when it was followed by such a NUL. This is now also\n  handled.\n- replaced some non-thread-safe function calls by their thread-safe\n  counterparts\n- fixed a minor memory leak that occured when the %APPNAME% property was\n  used (I think nobody used that in practice)\n- fixed a bug that caused signal handlers in cvthname() not to be restored when\n  a malicious pointer record was detected and processing of the message been\n  stopped for that reason (this should be really rare and can not be related\n  to the segfault bug we are hunting).\n- fixed a bug in cvthname that lead to passing a wrong parameter - in\n  practice, this had no impact.\n- general code cleanup (e.g. compiler warnings, comments)\n---------------------------------------------------------------------------\nVersion 1.19.6 (rgerhards), 2007-09-11\n- applied patch by varmojfekoj to change signal handling to the new\n  sigaction API set (replacing the depreciated signal() calls and its\n  friends.\n- fixed a bug that in --enable-debug mode caused an assertion when the\n  discard action was used\n- cleaned up compiler warnings\n- applied patch by varmojfekoj to FIX a bug that could cause \n  segfaults if empty properties were processed using modifying\n  options (e.g. space-cc, drop-cc)\n- fixed man bug: rsyslogd supports -l option\n---------------------------------------------------------------------------\nVersion 1.19.5 (rgerhards), 2007-09-07\n- changed part of the CStr interface so that better error tracking\n  is provided and the calling sequence is more intuitive (there were\n  invalid calls based on a too-weired interface)\n- (hopefully) fixed some remaining bugs rooted in wrong use of \n  the CStr class. These could lead to program abort.\n- applied patch by varmojfekoj two fix two potential segfault situations\n- added $ModDir config directive\n- modified $ModLoad so that an absolute path may be specified as\n  module name (e.g. /rsyslog/ommysql.so)\n---------------------------------------------------------------------------\nVersion 1.19.4 (rgerhards/varmojfekoj), 2007-09-04\n- fixed a number of small memory leaks - thanks varmojfekoj for patching\n- fixed an issue with CString class that could lead to rsyslog abort\n  in tplToString() - thanks varmojfekoj for patching\n- added a man-version of the config file documenation - thanks to Michel\n  Samia for providing the man file\n- fixed bug: a template like this causes an infinite loop:\n  $template opts,\"%programname:::a,b%\"\n  thanks varmojfekoj for the patch\n- fixed bug: case changing options crash freeing the string pointer\n  because they modify it: $template opts2,\"%programname::1:lowercase%\"\n  thanks varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 1.19.3 (mmeckelein/varmojfekoj), 2007-08-31\n- small mem leak fixed (after calling parseSelectorAct) - Thx varmojkekoj\n- documentation section \"Regular File\" und \"Blocks\" updated\n- solved an issue with dynamic file generation - Once again many thanks\n  to varmojfekoj\n- the negative selector for program name filter (Blocks) does not work as\n  expected - Thanks varmojfekoj for patching\n- added forwarding information to sysklogd (requires special template)\n  to config doc\n---------------------------------------------------------------------------\nVersion 1.19.2 (mmeckelein/varmojfekoj), 2007-08-28\n- a specifically formed message caused a segfault - Many thanks varmojfekoj\n  for providing a patch\n- a typo and a weird condition are fixed in msg.c - Thanks again\n  varmojfekoj \n- on file creation the file was always owned by root:root. This is fixed\n  now - Thanks ypsa for solving this issue\n---------------------------------------------------------------------------\nVersion 1.19.1 (mmeckelein), 2007-08-22\n- a bug that caused a high load when a TCP/UDP connection was closed is \n  fixed now - Thanks mildew for solving this issue\n- fixed a bug which caused a segfault on reinit - Thx varmojfekoj for the\n  patch\n- changed the hardcoded module path \"/lib/rsyslog\" to $(pkglibdir) in order\n  to avoid trouble e.g. on 64 bit platforms (/lib64) - many thanks Peter\n  Vrabec and darix, both provided a patch for solving this issue\n- enhanced the unloading of modules - thanks again varmojfekoj\n- applied a patch from varmojfekoj which fixes various little things in\n  MySQL output module\n---------------------------------------------------------------------------\nVersion 1.19.0 (varmojfekoj/rgerhards), 2007-08-16\n- integrated patch from varmojfekoj to make the mysql module a loadable one\n  many thanks for the patch, MUCH appreciated\n---------------------------------------------------------------------------\nVersion 1.18.2 (rgerhards), 2007-08-13\n- fixed a bug in outchannel code that caused templates to be incorrectly\n  parsed\n- fixed a bug in ommysql that caused a wrong \";template\" missing message\n- added some code for unloading modules; not yet fully complete (and we do\n  not yet have loadable modules, so this is no problem)\n- removed debian subdirectory by request of a debian packager (this is a special\n  subdir for debian and there is also no point in maintaining it when there\n  is a debian package available - so I gladly did this) in some cases\n- improved overall doc quality (some pages were quite old) and linked to\n  more of the online resources.\n- improved /contrib/delete_mysql script by adding a host option and some\n  other minor modifications\n---------------------------------------------------------------------------\nVersion 1.18.1 (rgerhards), 2007-08-08\n- applied a patch from varmojfekoj which solved a potential segfault\n  of rsyslogd on HUP\n- applied patch from Michel Samia to fix compilation when the pthreads\n  feature is disabled\n- some code cleanup (moved action object to its own file set)\n- add config directive $MainMsgQueueSize, which now allows to configure the\n  queue size dynamically\n- all compile-time settings are now shown in rsyslogd -v, not just the\n  active ones\n- enhanced performance a little bit more\n- added config file directive $ActionResumeInterval\n- fixed a bug that prevented compilation under debian sid\n- added a contrib directory for user-contributed useful things\n---------------------------------------------------------------------------\nVersion 1.18.0 (rgerhards), 2007-08-03\n- rsyslog now supports fallback actions when an action did not work. This\n  is a great feature e.g. for backup database servers or backup syslog\n  servers\n- modified rklogd to only change the console log level if -c is specified\n- added feature to use multiple actions inside a single selector\n- implemented $ActionExecOnlyWhenPreviousIsSuspended config directive\n- error messages during startup are now spit out to the configured log\n  destinations\n---------------------------------------------------------------------------\nVersion 1.17.6 (rgerhards), 2007-08-01\n- continued to work on output module modularization - basic stage of\n  this work is now FINISHED\n- fixed bug in OMSRcreate() - always returned SR_RET_OK\n- fixed a bug that caused ommysql to always complain about missing\n  templates\n- fixed a mem leak in OMSRdestruct - freeing the object itself was\n  forgotten - thanks to varmojfekoj for the patch\n- fixed a memory leak in syslogd/init() that happend when the config\n  file could not be read - thanks to varmojfekoj for the patch\n- fixed insufficient memory allocation in addAction() and its helpers.\n  The initial fix and idea was developed by mildew, I fine-tuned\n  it a bit. Thanks a lot for the fix, I'd probably had pulled out my\n  hair to find the bug...\n- added output of config file line number when a parsing error occured\n- fixed bug in objomsr.c that caused program to abort in debug mode with\n  an invalid assertion (in some cases)\n- fixed a typo that caused the default template for MySQL to be wrong.\n  thanks to mildew for catching this.\n- added configuration file command $DebugPrintModuleList and\n  $DebugPrintCfSysLineHandlerList\n- fixed an invalid value for the MARK timer - unfortunately, there was\n  a testing aid left in place. This resulted in quite frequent MARK messages\n- added $IncludeConfig config directive\n- applied a patch from mildew to prevent rsyslogd from freezing under heavy\n  load. This could happen when the queue was full. Now, we drop messages\n  but rsyslogd remains active.\n---------------------------------------------------------------------------\nVersion 1.17.5 (rgerhards), 2007-07-30\n- continued to work on output module modularization\n- fixed a missing file bug - thanks to Andrea Montanari for reporting\n  this problem\n- fixed a problem with shutting down the worker thread and freeing the\n  selector_t list - this caused messages to be lost, because the\n  message queue was not properly drained before the selectors got\n  destroyed.\n---------------------------------------------------------------------------\nVersion 1.17.4 (rgerhards), 2007-07-27\n- continued to work on output module modularization\n- fixed a situation where rsyslogd could create zombie processes\n  thanks to mildew for the patch\n- applied patch from Michel Samia to fix compilation when NOT\n  compiled for pthreads\n---------------------------------------------------------------------------\nVersion 1.17.3 (rgerhards), 2007-07-25\n- continued working on output module modularization\n- fixed a bug that caused rsyslogd to segfault on exit (and\n  probably also on HUP), when there was an unsent message in a selector\n  that required forwarding and the dns lookup failed for that selector\n  (yes, it was pretty unlikely to happen;))\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- fixed a memory leak in config file parsing and die()\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- rsyslogd now checks on startup if it is capable to performa any work\n  at all. If it cant, it complains and terminates\n  thanks to Michel Samia for providing the patch!\n- fixed a small memory leak when HUPing syslogd. The allowed sender\n  list now gets freed. thanks to mildew for the patch.\n- changed the way error messages in early startup are logged. They\n  now do no longer use the syslogd code directly but are rather\n  send to stderr.\n---------------------------------------------------------------------------\nVersion 1.17.2 (rgerhards), 2007-07-23\n- made the port part of the -r option optional. Needed for backward\n  compatibility with sysklogd\n- replaced system() calls with something more reasonable. Please note that\n  this might break compatibility with some existing configuration files.\n  We accept this in favour of the gained security.\n- removed a memory leak that could occur if timegenerated was used in\n  RFC 3164 format in templates\n- did some preparation in msg.c for advanced multithreading - placed the\n  hooks, but not yet any active code\n- worked further on modularization\n- added $ModLoad MySQL (dummy) config directive\n- added DropTrailingLFOnReception config directive\n---------------------------------------------------------------------------\nVersion 1.17.1 (rgerhards), 2007-07-20\n- fixed a bug that caused make install to install rsyslogd and rklogd under\n  the wrong names\n- fixed bug that caused $AllowedSenders to handle IPv6 scopes incorrectly;\n  also fixed but that could grabble $AllowedSender wildcards. Thanks to\n  mildew@gmail.com for the patch\n- minor code cleanup - thanks to Peter Vrabec for the patch\n- fixed minimal memory leak on HUP (caused by templates)\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- fixed another memory leak on HUPing and on exiting rsyslogd\n  again thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- code cleanup (removed compiler warnings)\n- fixed portability bug in configure.ac - thanks to Bartosz Ku\u017ama for patch\n- moved msg object into its own file set\n- added the capability to continue trying to write log files when the\n  file system is full. Functionality based on patch by Martin Schulze\n  to sysklogd package.\n---------------------------------------------------------------------------\nVersion 1.17.0 (RGer), 2007-07-17\n- added $RepeatedLineReduction config parameter\n- added $EscapeControlCharactersOnReceive config parameter\n- added $ControlCharacterEscapePrefix config parameter\n- added $DirCreateMode config parameter\n- added $CreateDirs config parameter\n- added $DebugPrintTemplateList config parameter\n- added $ResetConfigVariables config parameter\n- added $FileOwner config parameter\n- added $FileGroup config parameter\n- added $DirOwner config parameter\n- added $DirGroup config parameter\n- added $FailOnChownFailure config parameter\n- added regular expression support to the filter engine\n  thanks to Michel Samia for providing the patch!\n- enhanced $AllowedSender functionality. Credits to mildew@gmail.com for\n  the patch doing that\n  - added IPv6 support\n  - allowed DNS hostnames\n  - allowed DNS wildcard names\n- added new option $DropMsgsWithMaliciousDnsPTRRecords\n- added autoconf so that rfc3195d, rsyslogd and klogd are stored to /sbin\n- added capability to auto-create directories with dynaFiles\n---------------------------------------------------------------------------\nVersion 1.16.0 (RGer/Peter Vrabec), 2007-07-13 - The Friday, 13th Release ;)\n- build system switched to autotools\n- removed SYSV preprocessor macro use, replaced with autotools equivalents\n- fixed a bug that caused rsyslogd to segfault when TCP listening was\n  disabled and it terminated\n- added new properties \"syslogfacility-text\" and \"syslogseverity-text\"\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- added the -x option to disable hostname dns reslution\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- begun to better modularize syslogd.c - this is an ongoing project; moved\n  type definitions to a separate file\n- removed some now-unused fields from struct filed\n- move file size limit fields in struct field to the \"right spot\" (the file\n  writing part of the union - f_un.f_file)\n- subdirectories linux and solaris are no longer part of the distribution\n  package. This is not because we cease support for them, but there are no\n  longer any files in them after the move to autotools\n---------------------------------------------------------------------------\nVersion 1.15.1 (RGer), 2007-07-10\n- fixed a bug that caused a dynaFile selector to stall when there was\n  an open error with one file \n- improved template processing for dynaFiles; templates are now only\n  looked up during initialization - speeds up processing\n- optimized memory layout in struct filed when compiled with MySQL\n  support\n- fixed a bug that caused compilation without SYSLOG_INET to fail\n- re-enabled the \"last message repeated n times\" feature. This\n  feature was not taken care of while rsyslogd evolved from sysklogd\n  and it was more or less defunct. Now it is fully functional again.\n- added system properties: $NOW, $YEAR, $MONTH, $DAY, $HOUR, $MINUTE\n- fixed a bug in iovAsString() that caused a memory leak under stress\n  conditions (most probably memory shortage). This was unlikely to\n  ever happen, but it doesn't hurt doing it right\n- cosmetic: defined type \"uchar\", change all unsigned chars to uchar\n---------------------------------------------------------------------------\nVersion 1.15.0 (RGer), 2007-07-05\n- added ability to dynamically generate file names based on templates\n  and thus properties. This was a much-requested feature. It makes\n  life easy when it e.g. comes to splitting files based on the sender\n  address.\n- added $umask and $FileCreateMode config file directives\n- applied a patch from Bartosz Kuzma to compile cleanly under NetBSD\n- checks for extra (unexpected) characters in system config file lines\n  have been added\n- added IPv6 documentation - was accidently missing from CVS\n- begun to change char to unsigned char\n---------------------------------------------------------------------------\nVersion 1.14.2 (RGer), 2007-07-03\n** this release fixes all known nits with IPv6 **\n- restored capability to do /etc/service lookup for \"syslog\"\n  service when -r 0 was given\n- documented IPv6 handling of syslog messages\n- integrate patch from Bartosz Ku\u017ama to make rsyslog compile under\n  Solaris again (the patch replaced a strndup() call, which is not\n  available under Solaris\n- improved debug logging when waiting on select\n- updated rsyslogd man page with new options (-46A)\n---------------------------------------------------------------------------\nVersion 1.14.1 (RGer/Peter Vrabec), 2007-06-29\n- added Peter Vrabec's patch for IPv6 TCP\n- prefixed all messages send to stderr in rsyslogd with \"rsyslogd: \"\n---------------------------------------------------------------------------\nVersion 1.14.0 (RGer/Peter Vrabec), 2007-06-28\n- Peter Vrabec provided IPv6 for rsyslog, so we are now IPv6 enabled\n  IPv6 Support is currently for UDP only, TCP is to come soon.\n  AllowedSender configuration does not yet work for IPv6.\n- fixed code in iovCreate() that broke C's strict aliasing rules \n- fixed some char/unsigned char differences that forced the compiler\n  to spit out warning messages\n- updated the Red Hat init script to fix a known issue (thanks to\n  Peter Vrabec)\n---------------------------------------------------------------------------\nVersion 1.13.5 (RGer), 2007-06-22\n- made the TCP session limit configurable via command line switch\n  now -t <port>,<max sessions>\n- added man page for rklogd(8) (basically a copy from klogd, but now\n  there is one...)\n- fixed a bug that caused internal messages (e.g. rsyslogd startup) to\n  appear without a tag.\n- removed a minor memory leak that occurred when TAG processing requalified\n  a HOSTNAME to be a TAG (and a TAG already was set).\n- removed potential small memory leaks in MsgSet***() functions. There\n  would be a leak if a property was re-set, something that happened\n  extremely seldom.\n---------------------------------------------------------------------------\nVersion 1.13.4 (RGer), 2007-06-18\n- added a new property \"PRI-text\", which holds the PRI field in\n  textual form (e.g. \"syslog.info\")\n- added alias \"syslogseverity\" for \"syslogpriority\", which is a\n  misleading property name that needs to stay for historical\n  reasons (and backward-compatility)\n- added doc on how to record PRI value in log file\n- enhanced signal handling in klogd, including removal of an unsafe\n  call to the logging system during signal handling\n---------------------------------------------------------------------------\nVersion 1.13.3 (RGer), 2007-06-15\n- create a version of syslog.c from scratch. This is now\n  - highly optimized for rsyslog\n  - removes an incompatible license problem as the original\n    version had a BSD license with advertising clause\n  - fixed in the regard that rklogd will continue to work when\n    rsysogd has been restarted (the original version, as well\n    as sysklogd, will remain silent then)\n  - solved an issue with an extra NUL char at message end that the\n    original version had\n- applied some changes to klogd to care for the new interface\n- fixed a bug in syslogd.c which prevented compiling under debian\n---------------------------------------------------------------------------\nVersion 1.13.2 (RGer), 2007-06-13\n- lib order in makefile patched to facilitate static linking - thanks\n  to Bennett Todd for providing the patch\n- Integrated a patch from Peter Vrabec (pvrabec@redheat.com):\n  - added klogd under the name of rklogd (remove dependency on\n    original sysklogd package\n  - createDB.sql now in UTF\n  - added additional config files for use on Red Hat\n---------------------------------------------------------------------------\nVersion 1.13.1 (RGer), 2007-02-05\n- changed the listen backlog limit to a more reasonable value based on\n  the maximum number of TCP connections configurd (10% + 5) - thanks to Guy\n  Standen for the hint (actually, the limit was 5 and that was a \n  left-over from early testing).\n- fixed a bug in makefile which caused DB-support to be disabled when\n  NETZIP support was enabled\n- added the -e option to allow transmission of every message to remote\n  hosts (effectively turns off duplicate message suppression)\n- (somewhat) improved memory consumption when compiled with MySQL support\n- looks like we fixed an incompatibility with MySQL 5.x and above software\n  At least in one case, the remote server name was destroyed, leading to \n  a connection failure. The new, improved code does not have this issue and\n  so we see this as solved (the new code is generally somewhat better, so\n  there is a good chance we fixed this incompatibility).\n---------------------------------------------------------------------------\nVersion 1.13.0 (RGer), 2006-12-19\n- added '$' as ToPos proptery replacer specifier - means \"up to the\n  end of the string\"\n- property replacer option \"escape-cc\", \"drop-cc\" and \"space-cc\"  added\n- changed the handling of \\0 characters inside syslog messages. We now\n  consistently escape them to \"#000\". This is somewhat recommended in\n  the draft-ietf-syslog-protocol-19 draft. While the real recomendation\n  is to not escape any characters at all, we can not do this without\n  considerable modification of the code. So we escape it to \"#000\", which\n  is consistent with a sample found in the Internet-draft.\n- removed message glue logic (see printchopped() comment for details)\n  Also caused removal of parts table and thus some improvements in\n  memory usage.\n- changed the default MAXLINE to 2048 to take care of recent syslog\n  standardization efforts (can easily be changed in syslogd.c)\n- added support for byte-counted TCP syslog messages (much like\n  syslog-transport-tls-05 Internet Draft). This was necessary to\n  support compression over TCP.\n- added support for receiving compressed syslog messages\n- added support for sending compressed syslog messages\n- fixed a bug where the last message in a syslog/tcp stream was\n  lost if it was not properly terminated by a LF character\n---------------------------------------------------------------------------\nVersion 1.12.3 (RGer), 2006-10-04\n- implemented some changes to support Solaris (but support is not\n  yet complete)\n- commented out (via #if 0) some methods that are currently not being use\n  but should be kept for further us\n- added (interim) -u 1 option to turn off hostname and tag parsing\n- done some modifications to better support Fedora\n- made the field delimiter inside property replace configurable via\n  template\n- fixed a bug in property replacer: if fields were used, the delimitor\n  became part of the field. Up until now, this was barely noticable as \n  the delimiter as TAB only and thus invisible to a human. With other\n  delimiters available now, it quickly showed up. This bug fix might cause\n  some grief to existing installations if they used the extra TAB for\n  whatever reasons - sorry folks... Anyhow, a solution is easy: just add\n  a TAB character contstant into your template. Thus, there has no attempt\n  been made to do this in a backwards-compatible way.\n---------------------------------------------------------------------------\nVersion 1.12.2 (RGer), 2006-02-15\n- fixed a bug in the RFC 3339 date formatter. An extra space was added\n  after the actual timestamp\n- added support for providing high-precision RFC3339 timestamps for\n  (rsyslogd-)internally-generated messages\n- very (!) experimental support for syslog-protocol internet draft\n  added (the draft is experimental, the code is solid ;))\n- added support for field-extracting in the property replacer\n- enhanced the legacy-syslog parser so that it can interpret messages\n  that do not contain a TIMESTAMP\n- fixed a bug that caused the default socket (usually /dev/log) to be\n  opened even when -o command line option was given\n- fixed a bug in the Debian sample startup script - it caused rsyslogd\n  to listen to remote requests, which it shouldn't by default\n---------------------------------------------------------------------------\nVersion 1.12.1 (RGer), 2005-11-23\n- made multithreading work with BSD. Some signal-handling needed to be\n  restructured. Also, there might be a slight delay of up to 10 seconds\n  when huping and terminating rsyslogd under BSD\n- fixed a bug where a NULL-pointer was passed to printf() in logmsg().\n- fixed a bug during \"make install\" where rc3195d was not installed\n  Thanks to Bennett Todd for spotting this.\n- fixed a bug where rsyslogd dumped core when no TAG was found in the\n  received message\n- enhanced message parser so that it can deal with missing hostnames\n  in many cases (may not be totally fail-safe)\n- fixed a bug where internally-generated messages did not have the correct\n  TAG\n---------------------------------------------------------------------------\nVersion 1.12.0 (RGer), 2005-10-26\n- moved to a multi-threaded design. single-threading is still optionally\n  available. Multi-threading is experimental!\n- fixed a potential race condition. In the original code, marking was done\n  by an alarm handler, which could lead to all sorts of bad things. This\n  has been changed now. See comments in syslogd.c/domark() for details.\n- improved debug output for property-based filters\n- not a code change, but: I have checked all exit()s to make sure that\n  none occurs once rsyslogd has started up. Even in unusual conditions\n  (like low-memory conditions) rsyslogd somehow remains active. Of course,\n  it might loose a message or two, but at least it does not abort and it\n  can also recover when the condition no longer persists.\n- fixed a bug that could cause loss of the last message received\n  immediately before rsyslogd was terminated.\n- added comments on thread-safety of global variables in syslogd.c\n- fixed a small bug: spurios printf() when TCP syslog was used\n- fixed a bug that causes rsyslogd to dump core on termination when one\n  of the selector lines did not receive a message during the run (very\n  unlikely)\n- fixed an one-too-low memory allocation in the TCP sender. Could result\n  in rsyslogd dumping core.\n- fixed a bug with regular expression support (thanks to Andres Riancho)\n- a little bit of code restructuring (especially main(), which was\n  horribly large)\n---------------------------------------------------------------------------\nVersion 1.11.1 (RGer), 2005-10-19\n- support for BSD-style program name and host blocks\n- added a new property \"programname\" that can be used in templates\n- added ability to specify listen port for rfc3195d\n- fixed a bug that rendered the \"startswith\" comparison operation\n  unusable.\n- changed more functions to \"static\" storage class to help compiler\n  optimize (should have been static in the first place...)\n- fixed a potential memory leak in the string buffer class destructor.\n  As the destructur was previously never called, the leak did not actually\n  appear.\n- some internal restructuring in anticipation/preparation of minimal\n  multi-threading support\n- rsyslogd still shares some code with the sysklogd project. Some patches\n  for this shared code have been brought over from the sysklogd CVS.\n---------------------------------------------------------------------------\nVersion 1.11.0 (RGer), 2005-10-12\n- support for receiving messages via RFC 3195; added rfc3195d for that\n  purpose\n- added an additional guard to prevent rsyslogd from aborting when the\n  2gb file size limit is hit. While a user can configure rsyslogd to\n  handle such situations, it would abort if that was not done AND large\n  file support was not enabled (ok, this is hopefully an unlikely scenario)\n- fixed a bug that caused additional Unix domain sockets to be incorrectly\n  processed - could lead to message loss in extreme cases\n---------------------------------------------------------------------------\nVersion 1.10.2 (RGer), 2005-09-27\n- added comparison operations in property-based filters:\n  * isequal\n  * startswith\n- added ability to negate all property-based filter comparison operations\n  by adding a !-sign right in front of the operation name\n- added the ability to specify remote senders for UDP and TCP\n  received messages. Allows to block all but well-known hosts\n- changed the $-config line directives to be case-INsensitive\n- new command line option -w added: \"do not display warnings if messages\n  from disallowed senders are received\"\n- fixed a bug that caused rsyslogd to dump core when the compare value\n  was not quoted in property-based filters\n- fixed a bug in the new CStr compare function which lead to invalid\n  results (fortunately, this function was not yet used widely)\n- added better support for \"debugging\" rsyslog.conf property filters\n  (only if -d switch is given)\n- changed some function definitions to static, which eventually enables\n  some compiler optimizations\n- fixed a bug in MySQL code; when a SQL error occured, rsyslogd could\n  run in a tight loop. This was due to invalid sequence of error reporting\n  and is now fixed.\n---------------------------------------------------------------------------\nVersion 1.10.1 (RGer), 2005-09-23\n- added the ability to execute a shell script as an action.\n  Thanks to Bjoern Kalkbrenner for providing the code!\n- fixed a bug in the MySQL code; due to the bug the automatic one-time\n  retry after an error did not happen - this lead to error message in\n  cases where none should be seen (e.g. after a MySQL restart)\n- fixed a security issue with SQL-escaping in conjunction with\n  non-(SQL-)standard MySQL features.\n---------------------------------------------------------------------------\nVersion 1.10.0 (RGer), 2005-09-20\n  REMINDER: 1.10 is the first unstable version if the 1.x series!\n- added the capability to filter on any property in selector lines\n  (not just facility and priority)\n- changed stringbuf into a new counted string class\n- added support for a \"discard\" action. If a selector line with\n  discard (~ character) is found, no selector lines *after* that\n  line will be processed.\n- thanks to Andres Riancho, regular expression support has been\n  added to the template engine\n- added the FROMHOST property in the template processor, which could\n  previously not be obtained. Thanks to Cristian Testa for pointing\n  this out and even providing a fix.\n- added display of compile-time options to -v output\n- performance improvement for production build - made some checks\n  to happen only during debug mode\n- fixed a problem with compiling on SUSE and - while doing so - removed\n  the socket call to set SO_BSDCOMPAT in cases where it is obsolete.\n---------------------------------------------------------------------------\nVersion 1.0.4 (RGer), 2006-02-01\n- a small but important fix: the tcp receiver had two forgotten printf's\n  in it that caused a lot of unnecessary output to stdout. This was\n  important enough to justify a new release\n---------------------------------------------------------------------------\nVersion 1.0.3 (RGer), 2005-11-14\n- added an additional guard to prevent rsyslogd from aborting when the\n  2gb file size limit is hit. While a user can configure rsyslogd to\n  handle such situations, it would abort if that was not done AND large\n  file support was not enabled (ok, this is hopefully an unlikely scenario)\n- fixed a bug that caused additional Unix domain sockets to be incorrectly\n  processed - could lead to message loss in extreme cases\n- applied some patches available from the sysklogd project to code\n  shared from there\n- fixed a bug that causes rsyslogd to dump core on termination when one\n  of the selector lines did not receive a message during the run (very\n  unlikely)\n- fixed an one-too-low memory allocation in the TCP sender. Could result\n  in rsyslogd dumping core.\n- fixed a bug in the TCP sender that caused the retry logic to fail\n  after an error or receiver overrun\n- fixed a bug in init() that could lead to dumping core\n- fixed a bug that could lead to dumping core when no HOSTNAME or no TAG\n  was present in the syslog message\n---------------------------------------------------------------------------\nVersion 1.0.2 (RGer), 2005-10-05\n- fixed an issue with MySQL error reporting. When an error occured,\n  the MySQL driver went into an endless loop (at least in most cases).\n---------------------------------------------------------------------------\nVersion 1.0.1 (RGer), 2005-09-23\n- fixed a security issue with SQL-escaping in conjunction with\n  non-(SQL-)standard MySQL features.\n---------------------------------------------------------------------------\nVersion 1.0.0 (RGer), 2005-09-12\n- changed install doc to cover daily cron scripts - a trouble source\n- added rc script for slackware (provided by Chris Elvidge - thanks!) \n- fixed a really minor bug in usage() - the -r option was still\n  reported as without the port parameter\n---------------------------------------------------------------------------\nVersion 0.9.8 (RGer), 2005-09-05\n- made startup and shutdown message more consistent and included the\n  pid, so that they can be easier correlated. Used syslog-protocol\n  structured data format for this purpose.\n- improved config info in startup message, now tells not only\n  if it is listening remote on udp, but also for tcp. Also includes\n  the port numbers. The previous startup message was misleading, because\n  it did not say \"remote reception\" if rsyslogd was only listening via\n  tcp (but not via udp).\n- added a \"how can you help\" document to the doc set\n---------------------------------------------------------------------------\nVersion 0.9.7 (RGer), 2005-08-15\n- some of the previous doc files (like INSTALL) did not properly\n  reflect the changes to the build process and the new doc. Fixed\n  that.\n- changed syslogd.c so that when compiled without database support,\n  an error message is displayed when a database action is detected\n  in the config file (previously this was used as an user rule ;))\n- fixed a bug in the os-specific Makefiles which caused MySQL\n  support to not be compiled, even if selected\n---------------------------------------------------------------------------\nVersion 0.9.6 (RGer), 2005-08-09\n- greatly enhanced documentation. Now available in html format in\n  the \"doc\" folder and FreeBSD. Finally includes an install howto.\n- improved MySQL error messages a little - they now show up as log\n  messages, too (formerly only in debug mode)\n- added the ability to specify the listen port for udp syslog.\n  WARNING: This introduces an incompatibility. Formerly, udp\n  syslog was enabled by the -r command line option. Now, it is\n  \"-r [port]\", which is consistent with the tcp listener. However,\n  just -r will now return an error message.\n- added sample startup scripts for Debian and FreeBSD\n- added support for easy feature selection in the makefile. Un-\n  fortunately, this also means I needed to spilt the make file\n  for different OS and distros. There are some really bad syntax\n  differences between FreeBSD and Linux make.\n---------------------------------------------------------------------------\nVersion 0.9.5 (RGer), 2005-08-01\n- the \"semicolon bug\" was actually not (fully) solved in 0.9.4. One\n  part of the bug was solved, but another still existed. This one\n  is fixed now, too.\n- the \"semicolon bug\" actually turned out to be a more generic bug.\n  It appeared whenever an invalid template name was given. With some\n  selector actions, rsyslogd dumped core, with other it \"just\" had\n  a small ressource leak with others all worked well. These anomalies\n  are now fixed. Note that they only appeared during system initaliziation\n  once the system was running, nothing bad happened.\n- improved error reporting for template errors on startup. They are now\n  shown on the console and the start-up tty. Formerly, they were only\n  visible in debug mode.\n- support for multiple instances of rsyslogd on a single machine added\n- added new option \"-o\" --> omit local unix domain socket. This option\n  enables rsyslogd NOT to listen to the local socket. This is most\n  helpful when multiple instances of rsyslogd (or rsyslogd and another\n  syslogd) shall run on a single system.\n- added new option \"-i <pidfile>\" which allows to specify the pidfile.\n  This is needed when multiple instances of rsyslogd are to be run.\n- the new project home page is now online at www.rsyslog.com\n---------------------------------------------------------------------------\nVersion 0.9.4 (RGer), 2005-07-25\n- finally added the TCP sender. It now supports non-blocking mode, no\n  longer disabling message reception during connect. As it is now, it\n  is usable in production. The code could be more sophisticated, but\n  I've kept it short in anticipation of the move to liblogging, which\n  will lead to the removal of the code just written ;)\n- the \"exiting on signal...\" message still had the \"syslogd\" name in \n  it. Changed this to \"rsyslogd\", as we do not have a large user base\n  yet, this should pose no problem.\n- fixed \"the semiconlon\" bug. rsyslogd dumped core if a write-db action\n  was specified but no semicolon was given after the password (an empty\n  template was ok, but the semicolon needed to be present).\n- changed a default for traditional output format. During testing, it\n  was seen that the timestamp written to file in default format was\n  the time of message reception, not the time specified in the TIMESTAMP\n  field of the message itself. Traditionally, the message TIMESTAMP is\n  used and this has been changed now.\n---------------------------------------------------------------------------\nVersion 0.9.3 (RGer), 2005-07-19\n- fixed a bug in the message parser. In June, the RFC 3164 timestamp\n  was not correctly parsed (yes, only in June and some other months,\n  see the code comment to learn why...)\n- added the ability to specify the destination port when forwarding\n  syslog messages (both for TCP and UDP)\n- added an very experimental TCP sender (activated by\n  @@machine:port in config). This is not yet for production use. If\n  the receiver is not alive, rsyslogd will wait quite some time until\n  the connection request times out, which most probably leads to\n  loss of incoming messages.\n\n---------------------------------------------------------------------------\nVersion 0.9.2 (RGer), around 2005-07-06\n- I intended to change the maxsupported message size to 32k to\n  support IHE - but given the memory inefficiency in the usual use\n  cases, I have not done this. I have, however, included very\n  specific instructions on how to do this in the source code. I have\n  also done some testing with 32k messages, so you can change the\n  max size without taking too much risk.\n- added a syslog/tcp receiver; we now can receive messages via\n  plain tcp, but we can still send only via UDP. The syslog/tcp\n  receiver is the primary enhancement of this release.\n- slightly changed some error messages that contained a spurios \\n at\n  the end of the line (which gives empty lines in your log...)\n\n---------------------------------------------------------------------------\nVersion 0.9.1 (RGer)\n- fixed code so that it compiles without errors under FreeBSD\n- removed now unused function \"allocate_log()\" from syslogd.c\n- changed the make file so that it contains more defines for\n  different environments (in the long term, we need a better\n  system for disabling/enabling features...)\n- changed some printf's printing off_t types to %lld and\n  explicit (long long) casts. I tried to figure out the exact type,\n  but did not succeed in this. In the worst case, ultra-large peta-\n  byte files will now display funny informational messages on rollover,\n  something I think we can live with for the neersion 3.11.2 (rgerhards), 2008-02-??\n---------------------------------------------------------------------------\nVersion 3.11.1 (rgerhards), 2008-02-12\n- SNMP trap sender added thanks to Andre Lorbach (omsnmp)\n- added input-plugin interface specification in form of a (copy) template\n  input module\n- applied documentation fix by Michael Biebl -- many thanks!\n- bugfix: immark did not have MARK flags set...\n- added x-info field to rsyslogd startup/shutdown message. Hopefully\n  points users to right location for further info (many don't even know\n  they run rsyslog ;))\n- bugfix: trailing \":\" of tag was lost while parsing legacy syslog messages\n  without timestamp - thanks to Anders Blomdell for providing a patch!\n- fixed a bug in stringbuf.c related to STRINGBUF_TRIM_ALLOCSIZE, which\n  wasn't supposed to be used with rsyslog. Put a warning message up that\n  tells this feature is not tested and probably not worth the effort.\n  Thanks to Anders Blomdell fro bringing this to our attention\n- somewhat improved performance of string buffers\n- fixed bug that caused invalid treatment of tabs (HT) in rsyslog.conf\n- bugfix: setting for $EscapeCopntrolCharactersOnReceive was not \n  properly initialized\n- clarified usage of space-cc property replacer option\n- improved abort diagnostic handler\n- some initial effort for malloc/free runtime debugging support\n- bugfix: using dynafile actions caused rsyslogd abort\n- fixed minor man errors thanks to Michael Biebl\n---------------------------------------------------------------------------\nVersion 3.11.0 (rgerhards), 2008-01-31\n- implemented queued actions\n- implemented simple rate limiting for actions\n- implemented deliberate discarding of lower priority messages over higher\n  priority ones when a queue runs out of space\n- implemented disk quotas for disk queues\n- implemented the $ActionResumeRetryCount config directive\n- added $ActionQueueFilename config directive\n- added $ActionQueueSize config directive\n- added $ActionQueueHighWaterMark config directive\n- added $ActionQueueLowWaterMark config directive\n- added $ActionQueueDiscardMark config directive\n- added $ActionQueueDiscardSeverity config directive\n- added $ActionQueueCheckpointInterval config directive\n- added $ActionQueueType config directive\n- added $ActionQueueWorkerThreads config directive\n- added $ActionQueueTimeoutshutdown config directive\n- added $ActionQueueTimeoutActionCompletion config directive\n- added $ActionQueueTimeoutenQueue config directive\n- added $ActionQueueTimeoutworkerThreadShutdown config directive\n- added $ActionQueueWorkerThreadMinimumMessages config directive\n- added $ActionQueueMaxFileSize config directive\n- added $ActionQueueSaveonShutdown config directive\n- addded $ActionQueueDequeueSlowdown config directive\n- addded $MainMsgQueueDequeueSlowdown config directive\n- bugfix: added forgotten docs to package\n- improved debugging support\n- fixed a bug that caused $MainMsgQueueCheckpointInterval to work incorrectly\n- when a long-running action needs to be cancelled on shutdown, the message\n  that was processed by it is now preserved. This finishes support for\n  guaranteed delivery of messages (if the output supports it, of course)\n- fixed bug in output module interface, see\n  http://sourceforge.net/tracker/index.php?func=detail&aid=1881008&group_id=123448&atid=696552\n- changed the ommysql output plugin so that the (lengthy) connection\n  initialization now takes place in message processing. This works much\n  better with the new queued action mode (fast startup)\n- fixed a bug that caused a potential hang in file and fwd output module\n  varmojfekoj provided the patch - many thanks!\n- bugfixed stream class offset handling on 32bit platforms\n---------------------------------------------------------------------------\nVersion 3.10.3 (rgerhards), 2008-01-28\n- fixed a bug with standard template definitions (not a big deal) - thanks\n  to varmojfekoj for spotting it\n- run-time instrumentation added\n- implemented disk-assisted queue mode, which enables on-demand disk\n  spooling if the queue's in-memory queue is exhausted\n- implemented a dynamic worker thread pool for processing incoming\n  messages; workers are started and shut down as need arises\n- implemented a run-time instrumentation debug package\n- implemented the $MainMsgQueueSaveOnShutdown config directive\n- implemented the $MainMsgQueueWorkerThreadMinimumMessages config directive\n- implemented the $MainMsgQueueTimeoutWorkerThreadShutdown config directive\n---------------------------------------------------------------------------\nVersion 3.10.2 (rgerhards), 2008-01-14\n- added the ability to keep stop rsyslogd without the need to drain\n  the main message queue. In disk queue mode, rsyslog continues to\n  run from the point where it stopped. In case of a system failure, it\n  continues to process messages from the last checkpoint.\n- fixed a bug that caused a segfault on startup when no $WorkDir directive\n  was specified in rsyslog.conf\n- provided more fine-grain control over shutdown timeouts and added a\n  way to specify the enqueue timeout when the main message queue is full\n- implemented $MainMsgQueueCheckpointInterval config directive\n- implemented $MainMsgQueueTimeoutActionCompletion config directive\n- implemented $MainMsgQueueTimeoutEnqueue config directive\n- implemented $MainMsgQueueTimeoutShutdown config directive\n---------------------------------------------------------------------------\nVersion 3.10.1 (rgerhards), 2008-01-10\n- implemented the \"disk\" queue mode. However, it currently is of very\n  limited use, because it does not support persistence over rsyslogd\n  runs. So when rsyslogd is stopped, the queue is drained just as with\n  the in-memory queue modes. Persistent queues will be a feature of\n  the next release.\n- performance-optimized string class, should bring an overall improvement\n- fixed a memory leak in imudp -- thanks to varmojfekoj for the patch\n- fixed a race condition that could lead to a rsyslogd hang when during\n  HUP or termination\n- done some doc updates\n- added $WorkDirectory config directive\n- added $MainMsgQueueFileName config directive\n- added $MainMsgQueueMaxFileSize config directive\n---------------------------------------------------------------------------\nVersion 3.10.0 (rgerhards), 2008-01-07\n- implemented input module interface and initial input modules\n- enhanced threading for input modules (each on its own thread now)\n- ability to bind UDP listeners to specific local interfaces/ports and\n  ability to run multiple of them concurrently\n- added ability to specify listen IP address for UDP syslog server\n- license changed to GPLv3\n- mark messages are now provided by loadble module immark\n- rklogd is no longer provided. Its functionality has now been taken over\n  by imklog, a loadable input module. This offers a much better integration\n  into rsyslogd and makes sure that the kernel logger process is brought\n  up and down at the appropriate times\n- enhanced $IncludeConfig directive to support wildcard characters\n  (thanks to Michael Biebl)\n- all inputs are now implemented as loadable plugins\n- enhanced threading model: each input module now runs on its own thread\n- enhanced message queue which now supports different queueing methods\n  (among others, this can be used for performance fine-tuning)\n- added a large number of new configuration directives for the new\n  input modules\n- enhanced multi-threading utilizing a worker thread pool for the\n  main message queue\n- compilation without pthreads is no longer supported\n- much cleaner code due to new objects and removal of single-threading\n  mode\n---------------------------------------------------------------------------\nVersion 2.0.1 STABLE (rgerhards), 2008-01-24\n- fixed a bug in integer conversion - but this function was never called,\n  so it is not really a useful bug fix ;)\n- fixed a bug with standard template definitions (not a big deal) - thanks\n  to varmojfekoj for spotting it\n- fixed a bug that caused a potential hang in file and fwd output module\n  varmojfekoj provided the patch - many thanks!\n---------------------------------------------------------------------------\nVersion 2.0.0 STABLE (rgerhards), 2008-01-02\n- re-release of 1.21.2 as STABLE with no modifications except some\n  doc updates\n---------------------------------------------------------------------------\nVersion 1.21.2 (rgerhards), 2007-12-28\n- created a gss-api output module. This keeps GSS-API code and\n  TCP/UDP code separated. It is also important for forward-\n  compatibility with v3. Please note that this change breaks compatibility\n  with config files created for 1.21.0 and 1.21.1 - this was considered\n  acceptable.\n- fixed an error in forwarding retry code (could lead to message corruption\n  but surfaced very seldom)\n- increased portability for older platforms (AI_NUMERICSERV moved)\n- removed socket leak in omfwd.c\n- cross-platform patch for GSS-API compile problem on some platforms\n  thanks to darix for the patch!\n---------------------------------------------------------------------------\nVersion 1.21.1 (rgerhards), 2007-12-23\n- small doc fix for $IncludeConfig\n- fixed a bug in llDestroy()\n- bugfix: fixing memory leak when message queue is full and during\n  parsing. Thanks to varmojfekoj for the patch.\n- bugfix: when compiled without network support, unix sockets were\n  not properply closed\n- bugfix: memory leak in cfsysline.c/doGetWord() fixed\n---------------------------------------------------------------------------\nVersion 1.21.0 (rgerhards), 2007-12-19\n- GSS-API support for syslog/TCP connections was added. Thanks to\n  varmojfekoj for providing the patch with this functionality\n- code cleanup\n- enhanced $IncludeConfig directive to support wildcard filenames\n- changed some multithreading synchronization\n---------------------------------------------------------------------------\nVersion 1.20.1 (rgerhards), 2007-12-12\n- corrected a debug setting that survived release. Caused TCP connections\n  to be retried unnecessarily often.\n- When a hostname ACL was provided and DNS resolution for that name failed,\n  ACL processing was stopped at that point. Thanks to mildew for the patch.\n  Fedora Bugzilla: http://bugzilla.redhat.com/show_bug.cgi?id=395911\n- fixed a potential race condition, see link for details:\n  http://rgerhards.blogspot.com/2007/12/rsyslog-race-condition.html\n  Note that the probability of problems from this bug was very remote\n- fixed a memory leak that happend when PostgreSQL date formats were\n  used\n---------------------------------------------------------------------------\nVersion 1.20.0 (rgerhards), 2007-12-07\n- an output module for postgres databases has been added. Thanks to\n  sur5r for contributing this code\n- unloading dynamic modules has been cleaned up, we now have a\n  real implementation and not just a dummy \"good enough for the time\n  being\".\n- enhanced platform independence - thanks to Bartosz Kuzma and Michael\n  Biebl for their very useful contributions\n- some general code cleanup (including warnings on 64 platforms, only)\n---------------------------------------------------------------------------\nVersion 1.19.12 (rgerhards), 2007-12-03\n- cleaned up the build system (thanks to Michael Biebl for the patch)\n- fixed a bug where ommysql was still not compiled with -pthread option\n---------------------------------------------------------------------------\nVersion 1.19.11 (rgerhards), 2007-11-29\n- applied -pthread option to build when building for multi-threading mode\n  hopefully solves an issue with segfaulting\n---------------------------------------------------------------------------\nVersion 1.19.10 (rgerhards), 2007-10-19\n- introdcued the new \":modulename:\" syntax for calling module actions\n  in selector lines; modified ommysql to support it. This is primarily\n  an aid for further modules and a prequisite to actually allow third\n  party modules to be created.\n- minor fix in slackware startup script, \"-r 0\" is now \"-r0\"\n- updated rsyslogd doc set man page; now in html format\n- undid creation of a separate thread for the main loop -- this did not\n  turn out to be needed or useful, so reduce complexity once again.\n- added doc fixes provided by Michael Biebl - thanks\n---------------------------------------------------------------------------\nVersion 1.19.9 (rgerhards), 2007-10-12\n- now packaging system which again contains all components in a single\n  tarball\n- modularized main() a bit more, resulting in less complex code\n- experimentally added an additional thread - will see if that affects\n  the segfault bug we experience on some platforms. Note that this change\n  is scheduled to be removed again later.\n---------------------------------------------------------------------------\nVersion 1.19.8 (rgerhards), 2007-09-27\n- improved repeated message processing\n- applied patch provided by varmojfekoj to support building ommysql\n  in its own way (now also resides in a plugin subdirectory);\n  ommysql is now a separate package\n- fixed a bug in cvthname() that lead to message loss if part\n  of the source hostname would have been dropped\n- created some support for distributing ommysql together with the\n  main rsyslog package. I need to re-think it in the future, but\n  for the time being the current mode is best. I now simply include\n  one additional tarball for ommysql inside the main distribution.\n  I look forward to user feedback on how this should be done best. In the\n  long term, a separate project should be spawend for ommysql, but I'd\n  like to do that only after the plugin interface is fully stable (what\n  it is not yet).\n---------------------------------------------------------------------------\nVersion 1.19.7 (rgerhards), 2007-09-25\n- added code to handle situations where senders send us messages ending with\n  a NUL character. It is now simply removed. This also caused trailing LF\n  reduction to fail, when it was followed by such a NUL. This is now also\n  handled.\n- replaced some non-thread-safe function calls by their thread-safe\n  counterparts\n- fixed a minor memory leak that occured when the %APPNAME% property was\n  used (I think nobody used that in practice)\n- fixed a bug that caused signal handlers in cvthname() not to be restored when\n  a malicious pointer record was detected and processing of the message been\n  stopped for that reason (this should be really rare and can not be related\n  to the segfault bug we are hunting).\n- fixed a bug in cvthname that lead to passing a wrong parameter - in\n  practice, this had no impact.\n- general code cleanup (e.g. compiler warnings, comments)\n---------------------------------------------------------------------------\nVersion 1.19.6 (rgerhards), 2007-09-11\n- applied patch by varmojfekoj to change signal handling to the new\n  sigaction API set (replacing the depreciated signal() calls and its\n  friends.\n- fixed a bug that in --enable-debug mode caused an assertion when the\n  discard action was used\n- cleaned up compiler warnings\n- applied patch by varmojfekoj to FIX a bug that could cause \n  segfaults if empty properties were processed using modifying\n  options (e.g. space-cc, drop-cc)\n- fixed man bug: rsyslogd supports -l option\n---------------------------------------------------------------------------\nVersion 1.19.5 (rgerhards), 2007-09-07\n- changed part of the CStr interface so that better error tracking\n  is provided and the calling sequence is more intuitive (there were\n  invalid calls based on a too-weired interface)\n- (hopefully) fixed some remaining bugs rooted in wrong use of \n  the CStr class. These could lead to program abort.\n- applied patch by varmojfekoj two fix two potential segfault situations\n- added $ModDir config directive\n- modified $ModLoad so that an absolute path may be specified as\n  module name (e.g. /rsyslog/ommysql.so)\n---------------------------------------------------------------------------\nVersion 1.19.4 (rgerhards/varmojfekoj), 2007-09-04\n- fixed a number of small memory leaks - thanks varmojfekoj for patching\n- fixed an issue with CString class that could lead to rsyslog abort\n  in tplToString() - thanks varmojfekoj for patching\n- added a man-version of the config file documenation - thanks to Michel\n  Samia for providing the man file\n- fixed bug: a template like this causes an infinite loop:\n  $template opts,\"%programname:::a,b%\"\n  thanks varmojfekoj for the patch\n- fixed bug: case changing options crash freeing the string pointer\n  because they modify it: $template opts2,\"%programname::1:lowercase%\"\n  thanks varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 1.19.3 (mmeckelein/varmojfekoj), 2007-08-31\n- small mem leak fixed (after calling parseSelectorAct) - Thx varmojkekoj\n- documentation section \"Regular File\" und \"Blocks\" updated\n- solved an issue with dynamic file generation - Once again many thanks\n  to varmojfekoj\n- the negative selector for program name filter (Blocks) does not work as\n  expected - Thanks varmojfekoj for patching\n- added forwarding information to sysklogd (requires special template)\n  to config doc\n---------------------------------------------------------------------------\nVersion 1.19.2 (mmeckelein/varmojfekoj), 2007-08-28\n- a specifically formed message caused a segfault - Many thanks varmojfekoj\n  for providing a patch\n- a typo and a weird condition are fixed in msg.c - Thanks again\n  varmojfekoj \n- on file creation the file was always owned by root:root. This is fixed\n  now - Thanks ypsa for solving this issue\n---------------------------------------------------------------------------\nVersion 1.19.1 (mmeckelein), 2007-08-22\n- a bug that caused a high load when a TCP/UDP connection was closed is \n  fixed now - Thanks mildew for solving this issue\n- fixed a bug which caused a segfault on reinit - Thx varmojfekoj for the\n  patch\n- changed the hardcoded module path \"/lib/rsyslog\" to $(pkglibdir) in order\n  to avoid trouble e.g. on 64 bit platforms (/lib64) - many thanks Peter\n  Vrabec and darix, both provided a patch for solving this issue\n- enhanced the unloading of modules - thanks again varmojfekoj\n- applied a patch from varmojfekoj which fixes various little things in\n  MySQL output module\n---------------------------------------------------------------------------\nVersion 1.19.0 (varmojfekoj/rgerhards), 2007-08-16\n- integrated patch from varmojfekoj to make the mysql module a loadable one\n  many thanks for the patch, MUCH appreciated\n---------------------------------------------------------------------------\nVersion 1.18.2 (rgerhards), 2007-08-13\n- fixed a bug in outchannel code that caused templates to be incorrectly\n  parsed\n- fixed a bug in ommysql that caused a wrong \";template\" missing message\n- added some code for unloading modules; not yet fully complete (and we do\n  not yet have loadable modules, so this is no problem)\n- removed debian subdirectory by request of a debian packager (this is a special\n  subdir for debian and there is also no point in maintaining it when there\n  is a debian package available - so I gladly did this) in some cases\n- improved overall doc quality (some pages were quite old) and linked to\n  more of the online resources.\n- improved /contrib/delete_mysql script by adding a host option and some\n  other minor modifications\n---------------------------------------------------------------------------\nVersion 1.18.1 (rgerhards), 2007-08-08\n- applied a patch from varmojfekoj which solved a potential segfault\n  of rsyslogd on HUP\n- applied patch from Michel Samia to fix compilation when the pthreads\n  feature is disabled\n- some code cleanup (moved action object to its own file set)\n- add config directive $MainMsgQueueSize, which now allows to configure the\n  queue size dynamically\n- all compile-time settings are now shown in rsyslogd -v, not just the\n  active ones\n- enhanced performance a little bit more\n- added config file directive $ActionResumeInterval\n- fixed a bug that prevented compilation under debian sid\n- added a contrib directory for user-contributed useful things\n---------------------------------------------------------------------------\nVersion 1.18.0 (rgerhards), 2007-08-03\n- rsyslog now supports fallback actions when an action did not work. This\n  is a great feature e.g. for backup database servers or backup syslog\n  servers\n- modified rklogd to only change the console log level if -c is specified\n- added feature to use multiple actions inside a single selector\n- implemented $ActionExecOnlyWhenPreviousIsSuspended config directive\n- error messages during startup are now spit out to the configured log\n  destinations\n---------------------------------------------------------------------------\nVersion 1.17.6 (rgerhards), 2007-08-01\n- continued to work on output module modularization - basic stage of\n  this work is now FINISHED\n- fixed bug in OMSRcreate() - always returned SR_RET_OK\n- fixed a bug that caused ommysql to always complain about missing\n  templates\n- fixed a mem leak in OMSRdestruct - freeing the object itself was\n  forgotten - thanks to varmojfekoj for the patch\n- fixed a memory leak in syslogd/init() that happend when the config\n  file could not be read - thanks to varmojfekoj for the patch\n- fixed insufficient memory allocation in addAction() and its helpers.\n  The initial fix and idea was developed by mildew, I fine-tuned\n  it a bit. Thanks a lot for the fix, I'd probably had pulled out my\n  hair to find the bug...\n- added output of config file line number when a parsing error occured\n- fixed bug in objomsr.c that caused program to abort in debug mode with\n  an invalid assertion (in some cases)\n- fixed a typo that caused the default template for MySQL to be wrong.\n  thanks to mildew for catching this.\n- added configuration file command $DebugPrintModuleList and\n  $DebugPrintCfSysLineHandlerList\n- fixed an invalid value for the MARK timer - unfortunately, there was\n  a testing aid left in place. This resulted in quite frequent MARK messages\n- added $IncludeConfig config directive\n- applied a patch from mildew to prevent rsyslogd from freezing under heavy\n  load. This could happen when the queue was full. Now, we drop messages\n  but rsyslogd remains active.\n---------------------------------------------------------------------------\nVersion 1.17.5 (rgerhards), 2007-07-30\n- continued to work on output module modularization\n- fixed a missing file bug - thanks to Andrea Montanari for reporting\n  this problem\n- fixed a problem with shutting down the worker thread and freeing the\n  selector_t list - this caused messages to be lost, because the\n  message queue was not properly drained before the selectors got\n  destroyed.\n---------------------------------------------------------------------------\nVersion 1.17.4 (rgerhards), 2007-07-27\n- continued to work on output module modularization\n- fixed a situation where rsyslogd could create zombie processes\n  thanks to mildew for the patch\n- applied patch from Michel Samia to fix compilation when NOT\n  compiled for pthreads\n---------------------------------------------------------------------------\nVersion 1.17.3 (rgerhards), 2007-07-25\n- continued working on output module modularization\n- fixed a bug that caused rsyslogd to segfault on exit (and\n  probably also on HUP), when there was an unsent message in a selector\n  that required forwarding and the dns lookup failed for that selector\n  (yes, it was pretty unlikely to happen;))\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- fixed a memory leak in config file parsing and die()\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- rsyslogd now checks on startup if it is capable to performa any work\n  at all. If it cant, it complains and terminates\n  thanks to Michel Samia for providing the patch!\n- fixed a small memory leak when HUPing syslogd. The allowed sender\n  list now gets freed. thanks to mildew for the patch.\n- changed the way error messages in early startup are logged. They\n  now do no longer use the syslogd code directly but are rather\n  send to stderr.\n---------------------------------------------------------------------------\nVersion 1.17.2 (rgerhards), 2007-07-23\n- made the port part of the -r option optional. Needed for backward\n  compatibility with sysklogd\n- replaced system() calls with something more reasonable. Please note that\n  this might break compatibility with some existing configuration files.\n  We accept this in favour of the gained security.\n- removed a memory leak that could occur if timegenerated was used in\n  RFC 3164 format in templates\n- did some preparation in msg.c for advanced multithreading - placed the\n  hooks, but not yet any active code\n- worked further on modularization\n- added $ModLoad MySQL (dummy) config directive\n- added DropTrailingLFOnReception config directive\n---------------------------------------------------------------------------\nVersion 1.17.1 (rgerhards), 2007-07-20\n- fixed a bug that caused make install to install rsyslogd and rklogd under\n  the wrong names\n- fixed bug that caused $AllowedSenders to handle IPv6 scopes incorrectly;\n  also fixed but that could grabble $AllowedSender wildcards. Thanks to\n  mildew@gmail.com for the patch\n- minor code cleanup - thanks to Peter Vrabec for the patch\n- fixed minimal memory leak on HUP (caused by templates)\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- fixed another memory leak on HUPing and on exiting rsyslogd\n  again thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- code cleanup (removed compiler warnings)\n- fixed portability bug in configure.ac - thanks to Bartosz Ku\u017ama for patch\n- moved msg object into its own file set\n- added the capability to continue trying to write log files when the\n  file system is full. Functionality based on patch by Martin Schulze\n  to sysklogd package.\n---------------------------------------------------------------------------\nVersion 1.17.0 (RGer), 2007-07-17\n- added $RepeatedLineReduction config parameter\n- added $EscapeControlCharactersOnReceive config parameter\n- added $ControlCharacterEscapePrefix config parameter\n- added $DirCreateMode config parameter\n- added $CreateDirs config parameter\n- added $DebugPrintTemplateList config parameter\n- added $ResetConfigVariables config parameter\n- added $FileOwner config parameter\n- added $FileGroup config parameter\n- added $DirOwner config parameter\n- added $DirGroup config parameter\n- added $FailOnChownFailure config parameter\n- added regular expression support to the filter engine\n  thanks to Michel Samia for providing the patch!\n- enhanced $AllowedSender functionality. Credits to mildew@gmail.com for\n  the patch doing that\n  - added IPv6 support\n  - allowed DNS hostnames\n  - allowed DNS wildcard names\n- added new option $DropMsgsWithMaliciousDnsPTRRecords\n- added autoconf so that rfc3195d, rsyslogd and klogd are stored to /sbin\n- added capability to auto-create directories with dynaFiles\n---------------------------------------------------------------------------\nVersion 1.16.0 (RGer/Peter Vrabec), 2007-07-13 - The Friday, 13th Release ;)\n- build system switched to autotools\n- removed SYSV preprocessor macro use, replaced with autotools equivalents\n- fixed a bug that caused rsyslogd to segfault when TCP listening was\n  disabled and it terminated\n- added new properties \"syslogfacility-text\" and \"syslogseverity-text\"\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- added the -x option to disable hostname dns reslution\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- begun to better modularize syslogd.c - this is an ongoing project; moved\n  type definitions to a separate file\n- removed some now-unused fields from struct filed\n- move file size limit fields in struct field to the \"right spot\" (the file\n  writing part of the union - f_un.f_file)\n- subdirectories linux and solaris are no longer part of the distribution\n  package. This is not because we cease support for them, but there are no\n  longer any files in them after the move to autotools\n---------------------------------------------------------------------------\nVersion 1.15.1 (RGer), 2007-07-10\n- fixed a bug that caused a dynaFile selector to stall when there was\n  an open error with one file \n- improved template processing for dynaFiles; templates are now only\n  looked up during initialization - speeds up processing\n- optimized memory layout in struct filed when compiled with MySQL\n  support\n- fixed a bug that caused compilation without SYSLOG_INET to fail\n- re-enabled the \"last message repeated n times\" feature. This\n  feature was not taken care of while rsyslogd evolved from sysklogd\n  and it was more or less defunct. Now it is fully functional again.\n- added system properties: $NOW, $YEAR, $MONTH, $DAY, $HOUR, $MINUTE\n- fixed a bug in iovAsString() that caused a memory leak under stress\n  conditions (most probably memory shortage). This was unlikely to\n  ever happen, but it doesn't hurt doing it right\n- cosmetic: defined type \"uchar\", change all unsigned chars to uchar\n---------------------------------------------------------------------------\nVersion 1.15.0 (RGer), 2007-07-05\n- added ability to dynamically generate file names based on templates\n  and thus properties. This was a much-requested feature. It makes\n  life easy when it e.g. comes to splitting files based on the sender\n  address.\n- added $umask and $FileCreateMode config file directives\n- applied a patch from Bartosz Kuzma to compile cleanly under NetBSD\n- checks for extra (unexpected) characters in system config file lines\n  have been added\n- added IPv6 documentation - was accidently missing from CVS\n- begun to change char to unsigned char\n---------------------------------------------------------------------------\nVersion 1.14.2 (RGer), 2007-07-03\n** this release fixes all known nits with IPv6 **\n- restored capability to do /etc/service lookup for \"syslog\"\n  service when -r 0 was given\n- documented IPv6 handling of syslog messages\n- integrate patch from Bartosz Ku\u017ama to make rsyslog compile under\n  Solaris again (the patch replaced a strndup() call, which is not\n  available under Solaris\n- improved debug logging when waiting on select\n- updated rsyslogd man page with new options (-46A)\n---------------------------------------------------------------------------\nVersion 1.14.1 (RGer/Peter Vrabec), 2007-06-29\n- added Peter Vrabec's patch for IPv6 TCP\n- prefixed all messages send to stderr in rsyslogd with \"rsyslogd: \"\n---------------------------------------------------------------------------\nVersion 1.14.0 (RGer/Peter Vrabec), 2007-06-28\n- Peter Vrabec provided IPv6 for rsyslog, so we are now IPv6 enabled\n  IPv6 Support is currently for UDP only, TCP is to come soon.\n  AllowedSender configuration does not yet work for IPv6.\n- fixed code in iovCreate() that broke C's strict aliasing rules \n- fixed some char/unsigned char differences that forced the compiler\n  to spit out warning messages\n- updated the Red Hat init script to fix a known issue (thanks to\n  Peter Vrabec)\n---------------------------------------------------------------------------\nVersion 1.13.5 (RGer), 2007-06-22\n- made the TCP session limit configurable via command line switch\n  now -t <port>,<max sessions>\n- added man page for rklogd(8) (basically a copy from klogd, but now\n  there is one...)\n- fixed a bug that caused internal messages (e.g. rsyslogd startup) to\n  appear without a tag.\n- removed a minor memory leak that occurred when TAG processing requalified\n  a HOSTNAME to be a TAG (and a TAG already was set).\n- removed potential small memory leaks in MsgSet***() functions. There\n  would be a leak if a property was re-set, something that happened\n  extremely seldom.\n---------------------------------------------------------------------------\nVersion 1.13.4 (RGer), 2007-06-18\n- added a new property \"PRI-text\", which holds the PRI field in\n  textual form (e.g. \"syslog.info\")\n- added alias \"syslogseverity\" for \"syslogpriority\", which is a\n  misleading property name that needs to stay for historical\n  reasons (and backward-compatility)\n- added doc on how to record PRI value in log file\n- enhanced signal handling in klogd, including removal of an unsafe\n  call to the logging system during signal handling\n---------------------------------------------------------------------------\nVersion 1.13.3 (RGer), 2007-06-15\n- create a version of syslog.c from scratch. This is now\n  - highly optimized for rsyslog\n  - removes an incompatible license problem as the original\n    version had a BSD license with advertising clause\n  - fixed in the regard that rklogd will continue to work when\n    rsysogd has been restarted (the original version, as well\n    as sysklogd, will remain silent then)\n  - solved an issue with an extra NUL char at message end that the\n    original version had\n- applied some changes to klogd to care for the new interface\n- fixed a bug in syslogd.c which prevented compiling under debian\n---------------------------------------------------------------------------\nVersion 1.13.2 (RGer), 2007-06-13\n- lib order in makefile patched to facilitate static linking - thanks\n  to Bennett Todd for providing the patch\n- Integrated a patch from Peter Vrabec (pvrabec@redheat.com):\n  - added klogd under the name of rklogd (remove dependency on\n    original sysklogd package\n  - createDB.sql now in UTF\n  - added additional config files for use on Red Hat\n---------------------------------------------------------------------------\nVersion 1.13.1 (RGer), 2007-02-05\n- changed the listen backlog limit to a more reasonable value based on\n  the maximum number of TCP connections configurd (10% + 5) - thanks to Guy\n  Standen for the hint (actually, the limit was 5 and that was a \n  left-over from early testing).\n- fixed a bug in makefile which caused DB-support to be disabled when\n  NETZIP support was enabled\n- added the -e option to allow transmission of every message to remote\n  hosts (effectively turns off duplicate message suppression)\n- (somewhat) improved memory consumption when compiled with MySQL support\n- looks like we fixed an incompatibility with MySQL 5.x and above software\n  At least in one case, the remote server name was destroyed, leading to \n  a connection failure. The new, improved code does not have this issue and\n  so we see this as solved (the new code is generally somewhat better, so\n  there is a good chance we fixed this incompatibility).\n---------------------------------------------------------------------------\nVersion 1.13.0 (RGer), 2006-12-19\n- added '$' as ToPos proptery replacer specifier - means \"up to the\n  end of the string\"\n- property replacer option \"escape-cc\", \"drop-cc\" and \"space-cc\"  added\n- changed the handling of \\0 characters inside syslog messages. We now\n  consistently escape them to \"#000\". This is somewhat recommended in\n  the draft-ietf-syslog-protocol-19 draft. While the real recomendation\n  is to not escape any characters at all, we can not do this without\n  considerable modification of the code. So we escape it to \"#000\", which\n  is consistent with a sample found in the Internet-draft.\n- removed message glue logic (see printchopped() comment for details)\n  Also caused removal of parts table and thus some improvements in\n  memory usage.\n- changed the default MAXLINE to 2048 to take care of recent syslog\n  standardization efforts (can easily be changed in syslogd.c)\n- added support for byte-counted TCP syslog messages (much like\n  syslog-transport-tls-05 Internet Draft). This was necessary to\n  support compression over TCP.\n- added support for receiving compressed syslog messages\n- added support for sending compressed syslog messages\n- fixed a bug where the last message in a syslog/tcp stream was\n  lost if it was not properly terminated by a LF character\n---------------------------------------------------------------------------\nVersion 1.12.3 (RGer), 2006-10-04\n- implemented some changes to support Solaris (but support is not\n  yet complete)\n- commented out (via #if 0) some methods that are currently not being use\n  but should be kept for further us\n- added (interim) -u 1 option to turn off hostname and tag parsing\n- done some modifications to better support Fedora\n- made the field delimiter inside property replace configurable via\n  template\n- fixed a bug in property replacer: if fields were used, the delimitor\n  became part of the field. Up until now, this was barely noticable as \n  the delimiter as TAB only and thus invisible to a human. With other\n  delimiters available now, it quickly showed up. This bug fix might cause\n  some grief to existing installations if they used the extra TAB for\n  whatever reasons - sorry folks... Anyhow, a solution is easy: just add\n  a TAB character contstant into your template. Thus, there has no attempt\n  been made to do this in a backwards-compatible way.\n---------------------------------------------------------------------------\nVersion 1.12.2 (RGer), 2006-02-15\n- fixed a bug in the RFC 3339 date formatter. An extra space was added\n  after the actual timestamp\n- added support for providing high-precision RFC3339 timestamps for\n  (rsyslogd-)internally-generated messages\n- very (!) experimental support for syslog-protocol internet draft\n  added (the draft is experimental, the code is solid ;))\n- added support for field-extracting in the property replacer\n- enhanced the legacy-syslog parser so that it can interpret messages\n  that do not contain a TIMESTAMP\n- fixed a bug that caused the default socket (usually /dev/log) to be\n  opened even when -o command line option was given\n- fixed a bug in the Debian sample startup script - it caused rsyslogd\n  to listen to remote requests, which it shouldn't by default\n---------------------------------------------------------------------------\nVersion 1.12.1 (RGer), 2005-11-23\n- made multithreading work with BSD. Some signal-handling needed to be\n  restructured. Also, there might be a slight delay of up to 10 seconds\n  when huping and terminating rsyslogd under BSD\n- fixed a bug where a NULL-pointer was passed to printf() in logmsg().\n- fixed a bug during \"make install\" where rc3195d was not installed\n  Thanks to Bennett Todd for spotting this.\n- fixed a bug where rsyslogd dumped core when no TAG was found in the\n  received message\n- enhanced message parser so that it can deal with missing hostnames\n  in many cases (may not be totally fail-safe)\n- fixed a bug where internally-generated messages did not have the correct\n  TAG\n---------------------------------------------------------------------------\nVersion 1.12.0 (RGer), 2005-10-26\n- moved to a multi-threaded design. single-threading is still optionally\n  available. Multi-threading is experimental!\n- fixed a potential race condition. In the original code, marking was done\n  by an alarm handler, which could lead to all sorts of bad things. This\n  has been changed now. See comments in syslogd.c/domark() for details.\n- improved debug output for property-based filters\n- not a code change, but: I have checked all exit()s to make sure that\n  none occurs once rsyslogd has started up. Even in unusual conditions\n  (like low-memory conditions) rsyslogd somehow remains active. Of course,\n  it might loose a message or two, but at least it does not abort and it\n  can also recover when the condition no longer persists.\n- fixed a bug that could cause loss of the last message received\n  immediately before rsyslogd was terminated.\n- added comments on thread-safety of global variables in syslogd.c\n- fixed a small bug: spurios printf() when TCP syslog was used\n- fixed a bug that causes rsyslogd to dump core on termination when one\n  of the selector lines did not receive a message during the run (very\n  unlikely)\n- fixed an one-too-low memory allocation in the TCP sender. Could result\n  in rsyslogd dumping core.\n- fixed a bug with regular expression support (thanks to Andres Riancho)\n- a little bit of code restructuring (especially main(), which was\n  horribly large)\n---------------------------------------------------------------------------\nVersion 1.11.1 (RGer), 2005-10-19\n- support for BSD-style program name and host blocks\n- added a new property \"programname\" that can be used in templates\n- added ability to specify listen port for rfc3195d\n- fixed a bug that rendered the \"startswith\" comparison operation\n  unusable.\n- changed more functions to \"static\" storage class to help compiler\n  optimize (should have been static in the first place...)\n- fixed a potential memory leak in the string buffer class destructor.\n  As the destructur was previously never called, the leak did not actually\n  appear.\n- some internal restructuring in anticipation/preparation of minimal\n  multi-threading support\n- rsyslogd still shares some code with the sysklogd project. Some patches\n  for this shared code have been brought over from the sysklogd CVS.\n---------------------------------------------------------------------------\nVersion 1.11.0 (RGer), 2005-10-12\n- support for receiving messages via RFC 3195; added rfc3195d for that\n  purpose\n- added an additional guard to prevent rsyslogd from aborting when the\n  2gb file size limit is hit. While a user can configure rsyslogd to\n  handle such situations, it would abort if that was not done AND large\n  file support was not enabled (ok, this is hopefully an unlikely scenario)\n- fixed a bug that caused additional Unix domain sockets to be incorrectly\n  processed - could lead to message loss in extreme cases\n---------------------------------------------------------------------------\nVersion 1.10.2 (RGer), 2005-09-27\n- added comparison operations in property-based filters:\n  * isequal\n  * startswith\n- added ability to negate all property-based filter comparison operations\n  by adding a !-sign right in front of the operation name\n- added the ability to specify remote senders for UDP and TCP\n  received messages. Allows to block all but well-known hosts\n- changed the $-config line directives to be case-INsensitive\n- new command line option -w added: \"do not display warnings if messages\n  from disallowed senders are received\"\n- fixed a bug that caused rsyslogd to dump core when the compare value\n  was not quoted in property-based filters\n- fixed a bug in the new CStr compare function which lead to invalid\n  results (fortunately, this function was not yet used widely)\n- added better support for \"debugging\" rsyslog.conf property filters\n  (only if -d switch is given)\n- changed some function definitions to static, which eventually enables\n  some compiler optimizations\n- fixed a bug in MySQL code; when a SQL error occured, rsyslogd could\n  run in a tight loop. This was due to invalid sequence of error reporting\n  and is now fixed.\n---------------------------------------------------------------------------\nVersion 1.10.1 (RGer), 2005-09-23\n- added the ability to execute a shell script as an action.\n  Thanks to Bjoern Kalkbrenner for providing the code!\n- fixed a bug in the MySQL code; due to the bug the automatic one-time\n  retry after an error did not happen - this lead to error message in\n  cases where none should be seen (e.g. after a MySQL restart)\n- fixed a security issue with SQL-escaping in conjunction with\n  non-(SQL-)standard MySQL features.\n---------------------------------------------------------------------------\nVersion 1.10.0 (RGer), 2005-09-20\n  REMINDER: 1.10 is the first unstable version if the 1.x series!\n- added the capability to filter on any property in selector lines\n  (not just facility and priority)\n- changed stringbuf into a new counted string class\n- added support for a \"discard\" action. If a selector line with\n  discard (~ character) is found, no selector lines *after* that\n  line will be processed.\n- thanks to Andres Riancho, regular expression support has been\n  added to the template engine\n- added the FROMHOST property in the template processor, which could\n  previously not be obtained. Thanks to Cristian Testa for pointing\n  this out and even providing a fix.\n- added display of compile-time options to -v output\n- performance improvement for production build - made some checks\n  to happen only during debug mode\n- fixed a problem with compiling on SUSE and - while doing so - removed\n  the socket call to set SO_BSDCOMPAT in cases where it is obsolete.\n---------------------------------------------------------------------------\nVersion 1.0.4 (RGer), 2006-02-01\n- a small but important fix: the tcp receiver had two forgotten printf's\n  in it that caused a lot of unnecessary output to stdout. This was\n  important enough to justify a new release\n---------------------------------------------------------------------------\nVersion 1.0.3 (RGer), 2005-11-14\n- added an additional guard to prevent rsyslogd from aborting when the\n  2gb file size limit is hit. While a user can configure rsyslogd to\n  handle such situations, it would abort if that was not done AND large\n  file support was not enabled (ok, this is hopefully an unlikely scenario)\n- fixed a bug that caused additional Unix domain sockets to be incorrectly\n  processed - could lead to message loss in extreme cases\n- applied some patches available from the sysklogd project to code\n  shared from there\n- fixed a bug that causes rsyslogd to dump core on termination when one\n  of the selector lines did not receive a message during the run (very\n  unlikely)\n- fixed an one-too-low memory allocation in the TCP sender. Could result\n  in rsyslogd dumping core.\n- fixed a bug in the TCP sender that caused the retry logic to fail\n  after an error or receiver overrun\n- fixed a bug in init() that could lead to dumping core\n- fixed a bug that could lead to dumping core when no HOSTNAME or no TAG\n  was present in the syslog message\n---------------------------------------------------------------------------\nVersion 1.0.2 (RGer), 2005-10-05\n- fixed an issue with MySQL error reporting. When an error occured,\n  the MySQL driver went into an endless loop (at least in most cases).\n---------------------------------------------------------------------------\nVersion 1.0.1 (RGer), 2005-09-23\n- fixed a security issue with SQL-escaping in conjunction with\n  non-(SQL-)standard MySQL features.\n---------------------------------------------------------------------------\nVersion 1.0.0 (RGer), 2005-09-12\n- changed install doc to cover daily cron scripts - a trouble source\n- added rc script for slackware (provided by Chris Elvidge - thanks!) \n- fixed a really minor bug in usage() - the -r option was still\n  reported as without the port parameter\n---------------------------------------------------------------------------\nVersion 0.9.8 (RGer), 2005-09-05\n- made startup and shutdown message more consistent and included the\n  pid, so that they can be easier correlated. Used syslog-protocol\n  structured data format for this purpose.\n- improved config info in startup message, now tells not only\n  if it is listening remote on udp, but also for tcp. Also includes\n  the port numbers. The previous startup message was misleading, because\n  it did not say \"remote reception\" if rsyslogd was only listening via\n  tcp (but not via udp).\n- added a \"how can you help\" document to the doc set\n---------------------------------------------------------------------------\nVersion 0.9.7 (RGer), 2005-08-15\n- some of the previous doc files (like INSTALL) did not properly\n  reflect the changes to the build process and the new doc. Fixed\n  that.\n- changed syslogd.c so that when compiled without database support,\n  an error message is displayed when a database action is detected\n  in the config file (previously this was used as an user rule ;))\n- fixed a bug in the os-specific Makefiles which caused MySQL\n  support to not be compiled, even if selected\n---------------------------------------------------------------------------\nVersion 0.9.6 (RGer), 2005-08-09\n- greatly enhanced documentation. Now available in html format in\n  the \"doc\" folder and FreeBSD. Finally includes an install howto.\n- improved MySQL error messages a little - they now show up as log\n  messages, too (formerly only in debug mode)\n- added the ability to specify the listen port for udp syslog.\n  WARNING: This introduces an incompatibility. Formerly, udp\n  syslog was enabled by the -r command line option. Now, it is\n  \"-r [port]\", which is consistent with the tcp listener. However,\n  just -r will now return an error message.\n- added sample startup scripts for Debian and FreeBSD\n- added support for easy feature selection in the makefile. Un-\n  fortunately, this also means I needed to spilt the make file\n  for different OS and distros. There are some really bad syntax\n  differences between FreeBSD and Linux make.\n---------------------------------------------------------------------------\nVersion 0.9.5 (RGer), 2005-08-01\n- the \"semicolon bug\" was actually not (fully) solved in 0.9.4. One\n  part of the bug was solved, but another still existed. This one\n  is fixed now, too.\n- the \"semicolon bug\" actually turned out to be a more generic bug.\n  It appeared whenever an invalid template name was given. With some\n  selector actions, rsyslogd dumped core, with other it \"just\" had\n  a small ressource leak with others all worked well. These anomalies\n  are now fixed. Note that they only appeared during system initaliziation\n  once the system was running, nothing bad happened.\n- improved error reporting for template errors on startup. They are now\n  shown on the console and the start-up tty. Formerly, they were only\n  visible in debug mode.\n- support for multiple instances of rsyslogd on a single machine added\n- added new option \"-o\" --> omit local unix domain socket. This option\n  enables rsyslogd NOT to listen to the local socket. This is most\n  helpful when multiple instances of rsyslogd (or rsyslogd and another\n  syslogd) shall run on a single system.\n- added new option \"-i <pidfile>\" which allows to specify the pidfile.\n  This is needed when multiple instances of rsyslogd are to be run.\n- the new project home page is now online at www.rsyslog.com\n---------------------------------------------------------------------------\nVersion 0.9.4 (RGer), 2005-07-25\n- finally added the TCP sender. It now supports non-blocking mode, no\n  longer disabling message reception during connect. As it is now, it\n  is usable in production. The code could be more sophisticated, but\n  I've kept it short in anticipation of the move to liblogging, which\n  will lead to the removal of the code just written ;)\n- the \"exiting on signal...\" message still had the \"syslogd\" name in \n  it. Changed this to \"rsyslogd\", as we do not have a large user base\n  yet, this should pose no problem.\n- fixed \"the semiconlon\" bug. rsyslogd dumped core if a write-db action\n  was specified but no semicolon was given after the password (an empty\n  template was ok, but the semicolon needed to be present).\n- changed a default for traditional output format. During testing, it\n  was seen that the timestamp written to file in default format was\n  the time of message reception, not the time specified in the TIMESTAMP\n  field of the message itself. Traditionally, the message TIMESTAMP is\n  used and this has been changed now.\n---------------------------------------------------------------------------\nVersion 0.9.3 (RGer), 2005-07-19\n- fixed a bug in the message parser. In June, the RFC 3164 timestamp\n  was not correctly parsed (yes, only in June and some other months,\n  see the code comment to learn why...)\n- added the ability to specify the destination port when forwarding\n  syslog messages (both for TCP and UDP)\n- added an very experimental TCP sender (activated by\n  @@machine:port in config). This is not yet for production use. If\n  the receiver is not alive, rsyslogd will wait quite some time until\n  the connection request times out, which most probably leads to\n  loss of incoming messages.\n\n---------------------------------------------------------------------------\nVersion 0.9.2 (RGer), around 2005-07-06\n- I intended to change the maxsupported message size to 32k to\n  support IHE - but given the memory inefficiency in the usual use\n  cases, I have not done this. I have, however, included very\n  specific instructions on how to do this in the source code. I have\n  also done some testing with 32k messages, so you can change the\n  max size without taking too much risk.\n- added a syslog/tcp receiver; we now can receive messages via\n  plain tcp, but we can still send only via UDP. The syslog/tcp\n  receiver is the primary enhancement of this release.\n- slightly changed some error messages that contained a spurios \\n at\n  the end of the line (which gives empty lines in your log...)\n\n---------------------------------------------------------------------------\nVersion 0.9.1 (RGer)\n- fixed code so that it compiles without errors under FreeBSD\n- removed now unused function \"allocate_log()\" from syslogd.c\n- changed the make file so that it contains more defines for\n  different environments (in the long term, we need a better\n  system for disabling/enabling features...)\n- changed some printf's printing off_t types to %lld and\n  explicit (long long) casts. I tried to figure out the exact type,\n  but did not succeed in this. In the worst case, ultra-large peta-\n  byte files will now display funny informational messages on rollover,\n  something I think we can live with for the neersion 3.11.2 (rgerhards), 2008-02-??\n---------------------------------------------------------------------------\nVersion 3.11.1 (rgerhards), 2008-02-12\n- SNMP trap sender added thanks to Andre Lorbach (omsnmp)\n- added input-plugin interface specification in form of a (copy) template\n  input module\n- applied documentation fix by Michael Biebl -- many thanks!\n- bugfix: immark did not have MARK flags set...\n- added x-info field to rsyslogd startup/shutdown message. Hopefully\n  points users to right location for further info (many don't even know\n  they run rsyslog ;))\n- bugfix: trailing \":\" of tag was lost while parsing legacy syslog messages\n  without timestamp - thanks to Anders Blomdell for providing a patch!\n- fixed a bug in stringbuf.c related to STRINGBUF_TRIM_ALLOCSIZE, which\n  wasn't supposed to be used with rsyslog. Put a warning message up that\n  tells this feature is not tested and probably not worth the effort.\n  Thanks to Anders Blomdell fro bringing this to our attention\n- somewhat improved performance of string buffers\n- fixed bug that caused invalid treatment of tabs (HT) in rsyslog.conf\n- bugfix: setting for $EscapeCopntrolCharactersOnReceive was not \n  properly initialized\n- clarified usage of space-cc property replacer option\n- improved abort diagnostic handler\n- some initial effort for malloc/free runtime debugging support\n- bugfix: using dynafile actions caused rsyslogd abort\n- fixed minor man errors thanks to Michael Biebl\n---------------------------------------------------------------------------\nVersion 3.11.0 (rgerhards), 2008-01-31\n- implemented queued actions\n- implemented simple rate limiting for actions\n- implemented deliberate discarding of lower priority messages over higher\n  priority ones when a queue runs out of space\n- implemented disk quotas for disk queues\n- implemented the $ActionResumeRetryCount config directive\n- added $ActionQueueFilename config directive\n- added $ActionQueueSize config directive\n- added $ActionQueueHighWaterMark config directive\n- added $ActionQueueLowWaterMark config directive\n- added $ActionQueueDiscardMark config directive\n- added $ActionQueueDiscardSeverity config directive\n- added $ActionQueueCheckpointInterval config directive\n- added $ActionQueueType config directive\n- added $ActionQueueWorkerThreads config directive\n- added $ActionQueueTimeoutshutdown config directive\n- added $ActionQueueTimeoutActionCompletion config directive\n- added $ActionQueueTimeoutenQueue config directive\n- added $ActionQueueTimeoutworkerThreadShutdown config directive\n- added $ActionQueueWorkerThreadMinimumMessages config directive\n- added $ActionQueueMaxFileSize config directive\n- added $ActionQueueSaveonShutdown config directive\n- addded $ActionQueueDequeueSlowdown config directive\n- addded $MainMsgQueueDequeueSlowdown config directive\n- bugfix: added forgotten docs to package\n- improved debugging support\n- fixed a bug that caused $MainMsgQueueCheckpointInterval to work incorrectly\n- when a long-running action needs to be cancelled on shutdown, the message\n  that was processed by it is now preserved. This finishes support for\n  guaranteed delivery of messages (if the output supports it, of course)\n- fixed bug in output module interface, see\n  http://sourceforge.net/tracker/index.php?func=detail&aid=1881008&group_id=123448&atid=696552\n- changed the ommysql output plugin so that the (lengthy) connection\n  initialization now takes place in message processing. This works much\n  better with the new queued action mode (fast startup)\n- fixed a bug that caused a potential hang in file and fwd output module\n  varmojfekoj provided the patch - many thanks!\n- bugfixed stream class offset handling on 32bit platforms\n---------------------------------------------------------------------------\nVersion 3.10.3 (rgerhards), 2008-01-28\n- fixed a bug with standard template definitions (not a big deal) - thanks\n  to varmojfekoj for spotting it\n- run-time instrumentation added\n- implemented disk-assisted queue mode, which enables on-demand disk\n  spooling if the queue's in-memory queue is exhausted\n- implemented a dynamic worker thread pool for processing incoming\n  messages; workers are started and shut down as need arises\n- implemented a run-time instrumentation debug package\n- implemented the $MainMsgQueueSaveOnShutdown config directive\n- implemented the $MainMsgQueueWorkerThreadMinimumMessages config directive\n- implemented the $MainMsgQueueTimeoutWorkerThreadShutdown config directive\n---------------------------------------------------------------------------\nVersion 3.10.2 (rgerhards), 2008-01-14\n- added the ability to keep stop rsyslogd without the need to drain\n  the main message queue. In disk queue mode, rsyslog continues to\n  run from the point where it stopped. In case of a system failure, it\n  continues to process messages from the last checkpoint.\n- fixed a bug that caused a segfault on startup when no $WorkDir directive\n  was specified in rsyslog.conf\n- provided more fine-grain control over shutdown timeouts and added a\n  way to specify the enqueue timeout when the main message queue is full\n- implemented $MainMsgQueueCheckpointInterval config directive\n- implemented $MainMsgQueueTimeoutActionCompletion config directive\n- implemented $MainMsgQueueTimeoutEnqueue config directive\n- implemented $MainMsgQueueTimeoutShutdown config directive\n---------------------------------------------------------------------------\nVersion 3.10.1 (rgerhards), 2008-01-10\n- implemented the \"disk\" queue mode. However, it currently is of very\n  limited use, because it does not support persistence over rsyslogd\n  runs. So when rsyslogd is stopped, the queue is drained just as with\n  the in-memory queue modes. Persistent queues will be a feature of\n  the next release.\n- performance-optimized string class, should bring an overall improvement\n- fixed a memory leak in imudp -- thanks to varmojfekoj for the patch\n- fixed a race condition that could lead to a rsyslogd hang when during\n  HUP or termination\n- done some doc updates\n- added $WorkDirectory config directive\n- added $MainMsgQueueFileName config directive\n- added $MainMsgQueueMaxFileSize config directive\n---------------------------------------------------------------------------\nVersion 3.10.0 (rgerhards), 2008-01-07\n- implemented input module interface and initial input modules\n- enhanced threading for input modules (each on its own thread now)\n- ability to bind UDP listeners to specific local interfaces/ports and\n  ability to run multiple of them concurrently\n- added ability to specify listen IP address for UDP syslog server\n- license changed to GPLv3\n- mark messages are now provided by loadble module immark\n- rklogd is no longer provided. Its functionality has now been taken over\n  by imklog, a loadable input module. This offers a much better integration\n  into rsyslogd and makes sure that the kernel logger process is brought\n  up and down at the appropriate times\n- enhanced $IncludeConfig directive to support wildcard characters\n  (thanks to Michael Biebl)\n- all inputs are now implemented as loadable plugins\n- enhanced threading model: each input module now runs on its own thread\n- enhanced message queue which now supports different queueing methods\n  (among others, this can be used for performance fine-tuning)\n- added a large number of new configuration directives for the new\n  input modules\n- enhanced multi-threading utilizing a worker thread pool for the\n  main message queue\n- compilation without pthreads is no longer supported\n- much cleaner code due to new objects and removal of single-threading\n  mode\n---------------------------------------------------------------------------\nVersion 2.0.1 STABLE (rgerhards), 2008-01-24\n- fixed a bug in integer conversion - but this function was never called,\n  so it is not really a useful bug fix ;)\n- fixed a bug with standard template definitions (not a big deal) - thanks\n  to varmojfekoj for spotting it\n- fixed a bug that caused a potential hang in file and fwd output module\n  varmojfekoj provided the patch - many thanks!\n---------------------------------------------------------------------------\nVersion 2.0.0 STABLE (rgerhards), 2008-01-02\n- re-release of 1.21.2 as STABLE with no modifications except some\n  doc updates\n---------------------------------------------------------------------------\nVersion 1.21.2 (rgerhards), 2007-12-28\n- created a gss-api output module. This keeps GSS-API code and\n  TCP/UDP code separated. It is also important for forward-\n  compatibility with v3. Please note that this change breaks compatibility\n  with config files created for 1.21.0 and 1.21.1 - this was considered\n  acceptable.\n- fixed an error in forwarding retry code (could lead to message corruption\n  but surfaced very seldom)\n- increased portability for older platforms (AI_NUMERICSERV moved)\n- removed socket leak in omfwd.c\n- cross-platform patch for GSS-API compile problem on some platforms\n  thanks to darix for the patch!\n---------------------------------------------------------------------------\nVersion 1.21.1 (rgerhards), 2007-12-23\n- small doc fix for $IncludeConfig\n- fixed a bug in llDestroy()\n- bugfix: fixing memory leak when message queue is full and during\n  parsing. Thanks to varmojfekoj for the patch.\n- bugfix: when compiled without network support, unix sockets were\n  not properply closed\n- bugfix: memory leak in cfsysline.c/doGetWord() fixed\n---------------------------------------------------------------------------\nVersion 1.21.0 (rgerhards), 2007-12-19\n- GSS-API support for syslog/TCP connections was added. Thanks to\n  varmojfekoj for providing the patch with this functionality\n- code cleanup\n- enhanced $IncludeConfig directive to support wildcard filenames\n- changed some multithreading synchronization\n---------------------------------------------------------------------------\nVersion 1.20.1 (rgerhards), 2007-12-12\n- corrected a debug setting that survived release. Caused TCP connections\n  to be retried unnecessarily often.\n- When a hostname ACL was provided and DNS resolution for that name failed,\n  ACL processing was stopped at that point. Thanks to mildew for the patch.\n  Fedora Bugzilla: http://bugzilla.redhat.com/show_bug.cgi?id=395911\n- fixed a potential race condition, see link for details:\n  http://rgerhards.blogspot.com/2007/12/rsyslog-race-condition.html\n  Note that the probability of problems from this bug was very remote\n- fixed a memory leak that happend when PostgreSQL date formats were\n  used\n---------------------------------------------------------------------------\nVersion 1.20.0 (rgerhards), 2007-12-07\n- an output module for postgres databases has been added. Thanks to\n  sur5r for contributing this code\n- unloading dynamic modules has been cleaned up, we now have a\n  real implementation and not just a dummy \"good enough for the time\n  being\".\n- enhanced platform independence - thanks to Bartosz Kuzma and Michael\n  Biebl for their very useful contributions\n- some general code cleanup (including warnings on 64 platforms, only)\n---------------------------------------------------------------------------\nVersion 1.19.12 (rgerhards), 2007-12-03\n- cleaned up the build system (thanks to Michael Biebl for the patch)\n- fixed a bug where ommysql was still not compiled with -pthread option\n---------------------------------------------------------------------------\nVersion 1.19.11 (rgerhards), 2007-11-29\n- applied -pthread option to build when building for multi-threading mode\n  hopefully solves an issue with segfaulting\n---------------------------------------------------------------------------\nVersion 1.19.10 (rgerhards), 2007-10-19\n- introdcued the new \":modulename:\" syntax for calling module actions\n  in selector lines; modified ommysql to support it. This is primarily\n  an aid for further modules and a prequisite to actually allow third\n  party modules to be created.\n- minor fix in slackware startup script, \"-r 0\" is now \"-r0\"\n- updated rsyslogd doc set man page; now in html format\n- undid creation of a separate thread for the main loop -- this did not\n  turn out to be needed or useful, so reduce complexity once again.\n- added doc fixes provided by Michael Biebl - thanks\n---------------------------------------------------------------------------\nVersion 1.19.9 (rgerhards), 2007-10-12\n- now packaging system which again contains all components in a single\n  tarball\n- modularized main() a bit more, resulting in less complex code\n- experimentally added an additional thread - will see if that affects\n  the segfault bug we experience on some platforms. Note that this change\n  is scheduled to be removed again later.\n---------------------------------------------------------------------------\nVersion 1.19.8 (rgerhards), 2007-09-27\n- improved repeated message processing\n- applied patch provided by varmojfekoj to support building ommysql\n  in its own way (now also resides in a plugin subdirectory);\n  ommysql is now a separate package\n- fixed a bug in cvthname() that lead to message loss if part\n  of the source hostname would have been dropped\n- created some support for distributing ommysql together with the\n  main rsyslog package. I need to re-think it in the future, but\n  for the time being the current mode is best. I now simply include\n  one additional tarball for ommysql inside the main distribution.\n  I look forward to user feedback on how this should be done best. In the\n  long term, a separate project should be spawend for ommysql, but I'd\n  like to do that only after the plugin interface is fully stable (what\n  it is not yet).\n---------------------------------------------------------------------------\nVersion 1.19.7 (rgerhards), 2007-09-25\n- added code to handle situations where senders send us messages ending with\n  a NUL character. It is now simply removed. This also caused trailing LF\n  reduction to fail, when it was followed by such a NUL. This is now also\n  handled.\n- replaced some non-thread-safe function calls by their thread-safe\n  counterparts\n- fixed a minor memory leak that occured when the %APPNAME% property was\n  used (I think nobody used that in practice)\n- fixed a bug that caused signal handlers in cvthname() not to be restored when\n  a malicious pointer record was detected and processing of the message been\n  stopped for that reason (this should be really rare and can not be related\n  to the segfault bug we are hunting).\n- fixed a bug in cvthname that lead to passing a wrong parameter - in\n  practice, this had no impact.\n- general code cleanup (e.g. compiler warnings, comments)\n---------------------------------------------------------------------------\nVersion 1.19.6 (rgerhards), 2007-09-11\n- applied patch by varmojfekoj to change signal handling to the new\n  sigaction API set (replacing the depreciated signal() calls and its\n  friends.\n- fixed a bug that in --enable-debug mode caused an assertion when the\n  discard action was used\n- cleaned up compiler warnings\n- applied patch by varmojfekoj to FIX a bug that could cause \n  segfaults if empty properties were processed using modifying\n  options (e.g. space-cc, drop-cc)\n- fixed man bug: rsyslogd supports -l option\n---------------------------------------------------------------------------\nVersion 1.19.5 (rgerhards), 2007-09-07\n- changed part of the CStr interface so that better error tracking\n  is provided and the calling sequence is more intuitive (there were\n  invalid calls based on a too-weired interface)\n- (hopefully) fixed some remaining bugs rooted in wrong use of \n  the CStr class. These could lead to program abort.\n- applied patch by varmojfekoj two fix two potential segfault situations\n- added $ModDir config directive\n- modified $ModLoad so that an absolute path may be specified as\n  module name (e.g. /rsyslog/ommysql.so)\n---------------------------------------------------------------------------\nVersion 1.19.4 (rgerhards/varmojfekoj), 2007-09-04\n- fixed a number of small memory leaks - thanks varmojfekoj for patching\n- fixed an issue with CString class that could lead to rsyslog abort\n  in tplToString() - thanks varmojfekoj for patching\n- added a man-version of the config file documenation - thanks to Michel\n  Samia for providing the man file\n- fixed bug: a template like this causes an infinite loop:\n  $template opts,\"%programname:::a,b%\"\n  thanks varmojfekoj for the patch\n- fixed bug: case changing options crash freeing the string pointer\n  because they modify it: $template opts2,\"%programname::1:lowercase%\"\n  thanks varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 1.19.3 (mmeckelein/varmojfekoj), 2007-08-31\n- small mem leak fixed (after calling parseSelectorAct) - Thx varmojkekoj\n- documentation section \"Regular File\" und \"Blocks\" updated\n- solved an issue with dynamic file generation - Once again many thanks\n  to varmojfekoj\n- the negative selector for program name filter (Blocks) does not work as\n  expected - Thanks varmojfekoj for patching\n- added forwarding information to sysklogd (requires special template)\n  to config doc\n---------------------------------------------------------------------------\nVersion 1.19.2 (mmeckelein/varmojfekoj), 2007-08-28\n- a specifically formed message caused a segfault - Many thanks varmojfekoj\n  for providing a patch\n- a typo and a weird condition are fixed in msg.c - Thanks again\n  varmojfekoj \n- on file creation the file was always owned by root:root. This is fixed\n  now - Thanks ypsa for solving this issue\n---------------------------------------------------------------------------\nVersion 1.19.1 (mmeckelein), 2007-08-22\n- a bug that caused a high load when a TCP/UDP connection was closed is \n  fixed now - Thanks mildew for solving this issue\n- fixed a bug which caused a segfault on reinit - Thx varmojfekoj for the\n  patch\n- changed the hardcoded module path \"/lib/rsyslog\" to $(pkglibdir) in order\n  to avoid trouble e.g. on 64 bit platforms (/lib64) - many thanks Peter\n  Vrabec and darix, both provided a patch for solving this issue\n- enhanced the unloading of modules - thanks again varmojfekoj\n- applied a patch from varmojfekoj which fixes various little things in\n  MySQL output module\n---------------------------------------------------------------------------\nVersion 1.19.0 (varmojfekoj/rgerhards), 2007-08-16\n- integrated patch from varmojfekoj to make the mysql module a loadable one\n  many thanks for the patch, MUCH appreciated\n---------------------------------------------------------------------------\nVersion 1.18.2 (rgerhards), 2007-08-13\n- fixed a bug in outchannel code that caused templates to be incorrectly\n  parsed\n- fixed a bug in ommysql that caused a wrong \";template\" missing message\n- added some code for unloading modules; not yet fully complete (and we do\n  not yet have loadable modules, so this is no problem)\n- removed debian subdirectory by request of a debian packager (this is a special\n  subdir for debian and there is also no point in maintaining it when there\n  is a debian package available - so I gladly did this) in some cases\n- improved overall doc quality (some pages were quite old) and linked to\n  more of the online resources.\n- improved /contrib/delete_mysql script by adding a host option and some\n  other minor modifications\n---------------------------------------------------------------------------\nVersion 1.18.1 (rgerhards), 2007-08-08\n- applied a patch from varmojfekoj which solved a potential segfault\n  of rsyslogd on HUP\n- applied patch from Michel Samia to fix compilation when the pthreads\n  feature is disabled\n- some code cleanup (moved action object to its own file set)\n- add config directive $MainMsgQueueSize, which now allows to configure the\n  queue size dynamically\n- all compile-time settings are now shown in rsyslogd -v, not just the\n  active ones\n- enhanced performance a little bit more\n- added config file directive $ActionResumeInterval\n- fixed a bug that prevented compilation under debian sid\n- added a contrib directory for user-contributed useful things\n---------------------------------------------------------------------------\nVersion 1.18.0 (rgerhards), 2007-08-03\n- rsyslog now supports fallback actions when an action did not work. This\n  is a great feature e.g. for backup database servers or backup syslog\n  servers\n- modified rklogd to only change the console log level if -c is specified\n- added feature to use multiple actions inside a single selector\n- implemented $ActionExecOnlyWhenPreviousIsSuspended config directive\n- error messages during startup are now spit out to the configured log\n  destinations\n---------------------------------------------------------------------------\nVersion 1.17.6 (rgerhards), 2007-08-01\n- continued to work on output module modularization - basic stage of\n  this work is now FINISHED\n- fixed bug in OMSRcreate() - always returned SR_RET_OK\n- fixed a bug that caused ommysql to always complain about missing\n  templates\n- fixed a mem leak in OMSRdestruct - freeing the object itself was\n  forgotten - thanks to varmojfekoj for the patch\n- fixed a memory leak in syslogd/init() that happend when the config\n  file could not be read - thanks to varmojfekoj for the patch\n- fixed insufficient memory allocation in addAction() and its helpers.\n  The initial fix and idea was developed by mildew, I fine-tuned\n  it a bit. Thanks a lot for the fix, I'd probably had pulled out my\n  hair to find the bug...\n- added output of config file line number when a parsing error occured\n- fixed bug in objomsr.c that caused program to abort in debug mode with\n  an invalid assertion (in some cases)\n- fixed a typo that caused the default template for MySQL to be wrong.\n  thanks to mildew for catching this.\n- added configuration file command $DebugPrintModuleList and\n  $DebugPrintCfSysLineHandlerList\n- fixed an invalid value for the MARK timer - unfortunately, there was\n  a testing aid left in place. This resulted in quite frequent MARK messages\n- added $IncludeConfig config directive\n- applied a patch from mildew to prevent rsyslogd from freezing under heavy\n  load. This could happen when the queue was full. Now, we drop messages\n  but rsyslogd remains active.\n---------------------------------------------------------------------------\nVersion 1.17.5 (rgerhards), 2007-07-30\n- continued to work on output module modularization\n- fixed a missing file bug - thanks to Andrea Montanari for reporting\n  this problem\n- fixed a problem with shutting down the worker thread and freeing the\n  selector_t list - this caused messages to be lost, because the\n  message queue was not properly drained before the selectors got\n  destroyed.\n---------------------------------------------------------------------------\nVersion 1.17.4 (rgerhards), 2007-07-27\n- continued to work on output module modularization\n- fixed a situation where rsyslogd could create zombie processes\n  thanks to mildew for the patch\n- applied patch from Michel Samia to fix compilation when NOT\n  compiled for pthreads\n---------------------------------------------------------------------------\nVersion 1.17.3 (rgerhards), 2007-07-25\n- continued working on output module modularization\n- fixed a bug that caused rsyslogd to segfault on exit (and\n  probably also on HUP), when there was an unsent message in a selector\n  that required forwarding and the dns lookup failed for that selector\n  (yes, it was pretty unlikely to happen;))\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- fixed a memory leak in config file parsing and die()\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- rsyslogd now checks on startup if it is capable to performa any work\n  at all. If it cant, it complains and terminates\n  thanks to Michel Samia for providing the patch!\n- fixed a small memory leak when HUPing syslogd. The allowed sender\n  list now gets freed. thanks to mildew for the patch.\n- changed the way error messages in early startup are logged. They\n  now do no longer use the syslogd code directly but are rather\n  send to stderr.\n---------------------------------------------------------------------------\nVersion 1.17.2 (rgerhards), 2007-07-23\n- made the port part of the -r option optional. Needed for backward\n  compatibility with sysklogd\n- replaced system() calls with something more reasonable. Please note that\n  this might break compatibility with some existing configuration files.\n  We accept this in favour of the gained security.\n- removed a memory leak that could occur if timegenerated was used in\n  RFC 3164 format in templates\n- did some preparation in msg.c for advanced multithreading - placed the\n  hooks, but not yet any active code\n- worked further on modularization\n- added $ModLoad MySQL (dummy) config directive\n- added DropTrailingLFOnReception config directive\n---------------------------------------------------------------------------\nVersion 1.17.1 (rgerhards), 2007-07-20\n- fixed a bug that caused make install to install rsyslogd and rklogd under\n  the wrong names\n- fixed bug that caused $AllowedSenders to handle IPv6 scopes incorrectly;\n  also fixed but that could grabble $AllowedSender wildcards. Thanks to\n  mildew@gmail.com for the patch\n- minor code cleanup - thanks to Peter Vrabec for the patch\n- fixed minimal memory leak on HUP (caused by templates)\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- fixed another memory leak on HUPing and on exiting rsyslogd\n  again thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- code cleanup (removed compiler warnings)\n- fixed portability bug in configure.ac - thanks to Bartosz Ku\u017ama for patch\n- moved msg object into its own file set\n- added the capability to continue trying to write log files when the\n  file system is full. Functionality based on patch by Martin Schulze\n  to sysklogd package.\n---------------------------------------------------------------------------\nVersion 1.17.0 (RGer), 2007-07-17\n- added $RepeatedLineReduction config parameter\n- added $EscapeControlCharactersOnReceive config parameter\n- added $ControlCharacterEscapePrefix config parameter\n- added $DirCreateMode config parameter\n- added $CreateDirs config parameter\n- added $DebugPrintTemplateList config parameter\n- added $ResetConfigVariables config parameter\n- added $FileOwner config parameter\n- added $FileGroup config parameter\n- added $DirOwner config parameter\n- added $DirGroup config parameter\n- added $FailOnChownFailure config parameter\n- added regular expression support to the filter engine\n  thanks to Michel Samia for providing the patch!\n- enhanced $AllowedSender functionality. Credits to mildew@gmail.com for\n  the patch doing that\n  - added IPv6 support\n  - allowed DNS hostnames\n  - allowed DNS wildcard names\n- added new option $DropMsgsWithMaliciousDnsPTRRecords\n- added autoconf so that rfc3195d, rsyslogd and klogd are stored to /sbin\n- added capability to auto-create directories with dynaFiles\n---------------------------------------------------------------------------\nVersion 1.16.0 (RGer/Peter Vrabec), 2007-07-13 - The Friday, 13th Release ;)\n- build system switched to autotools\n- removed SYSV preprocessor macro use, replaced with autotools equivalents\n- fixed a bug that caused rsyslogd to segfault when TCP listening was\n  disabled and it terminated\n- added new properties \"syslogfacility-text\" and \"syslogseverity-text\"\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- added the -x option to disable hostname dns reslution\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- begun to better modularize syslogd.c - this is an ongoing project; moved\n  type definitions to a separate file\n- removed some now-unused fields from struct filed\n- move file size limit fields in struct field to the \"right spot\" (the file\n  writing part of the union - f_un.f_file)\n- subdirectories linux and solaris are no longer part of the distribution\n  package. This is not because we cease support for them, but there are no\n  longer any files in them after the move to autotools\n---------------------------------------------------------------------------\nVersion 1.15.1 (RGer), 2007-07-10\n- fixed a bug that caused a dynaFile selector to stall when there was\n  an open error with one file \n- improved template processing for dynaFiles; templates are now only\n  looked up during initialization - speeds up processing\n- optimized memory layout in struct filed when compiled with MySQL\n  support\n- fixed a bug that caused compilation without SYSLOG_INET to fail\n- re-enabled the \"last message repeated n times\" feature. This\n  feature was not taken care of while rsyslogd evolved from sysklogd\n  and it was more or less defunct. Now it is fully functional again.\n- added system properties: $NOW, $YEAR, $MONTH, $DAY, $HOUR, $MINUTE\n- fixed a bug in iovAsString() that caused a memory leak under stress\n  conditions (most probably memory shortage). This was unlikely to\n  ever happen, but it doesn't hurt doing it right\n- cosmetic: defined type \"uchar\", change all unsigned chars to uchar\n---------------------------------------------------------------------------\nVersion 1.15.0 (RGer), 2007-07-05\n- added ability to dynamically generate file names based on templates\n  and thus properties. This was a much-requested feature. It makes\n  life easy when it e.g. comes to splitting files based on the sender\n  address.\n- added $umask and $FileCreateMode config file directives\n- applied a patch from Bartosz Kuzma to compile cleanly under NetBSD\n- checks for extra (unexpected) characters in system config file lines\n  have been added\n- added IPv6 documentation - was accidently missing from CVS\n- begun to change char to unsigned char\n---------------------------------------------------------------------------\nVersion 1.14.2 (RGer), 2007-07-03\n** this release fixes all known nits with IPv6 **\n- restored capability to do /etc/service lookup for \"syslog\"\n  service when -r 0 was given\n- documented IPv6 handling of syslog messages\n- integrate patch from Bartosz Ku\u017ama to make rsyslog compile under\n  Solaris again (the patch replaced a strndup() call, which is not\n  available under Solaris\n- improved debug logging when waiting on select\n- updated rsyslogd man page with new options (-46A)\n---------------------------------------------------------------------------\nVersion 1.14.1 (RGer/Peter Vrabec), 2007-06-29\n- added Peter Vrabec's patch for IPv6 TCP\n- prefixed all messages send to stderr in rsyslogd with \"rsyslogd: \"\n---------------------------------------------------------------------------\nVersion 1.14.0 (RGer/Peter Vrabec), 2007-06-28\n- Peter Vrabec provided IPv6 for rsyslog, so we are now IPv6 enabled\n  IPv6 Support is currently for UDP only, TCP is to come soon.\n  AllowedSender configuration does not yet work for IPv6.\n- fixed code in iovCreate() that broke C's strict aliasing rules \n- fixed some char/unsigned char differences that forced the compiler\n  to spit out warning messages\n- updated the Red Hat init script to fix a known issue (thanks to\n  Peter Vrabec)\n---------------------------------------------------------------------------\nVersion 1.13.5 (RGer), 2007-06-22\n- made the TCP session limit configurable via command line switch\n  now -t <port>,<max sessions>\n- added man page for rklogd(8) (basically a copy from klogd, but now\n  there is one...)\n- fixed a bug that caused internal messages (e.g. rsyslogd startup) to\n  appear without a tag.\n- removed a minor memory leak that occurred when TAG processing requalified\n  a HOSTNAME to be a TAG (and a TAG already was set).\n- removed potential small memory leaks in MsgSet***() functions. There\n  would be a leak if a property was re-set, something that happened\n  extremely seldom.\n---------------------------------------------------------------------------\nVersion 1.13.4 (RGer), 2007-06-18\n- added a new property \"PRI-text\", which holds the PRI field in\n  textual form (e.g. \"syslog.info\")\n- added alias \"syslogseverity\" for \"syslogpriority\", which is a\n  misleading property name that needs to stay for historical\n  reasons (and backward-compatility)\n- added doc on how to record PRI value in log file\n- enhanced signal handling in klogd, including removal of an unsafe\n  call to the logging system during signal handling\n---------------------------------------------------------------------------\nVersion 1.13.3 (RGer), 2007-06-15\n- create a version of syslog.c from scratch. This is now\n  - highly optimized for rsyslog\n  - removes an incompatible license problem as the original\n    version had a BSD license with advertising clause\n  - fixed in the regard that rklogd will continue to work when\n    rsysogd has been restarted (the original version, as well\n    as sysklogd, will remain silent then)\n  - solved an issue with an extra NUL char at message end that the\n    original version had\n- applied some changes to klogd to care for the new interface\n- fixed a bug in syslogd.c which prevented compiling under debian\n---------------------------------------------------------------------------\nVersion 1.13.2 (RGer), 2007-06-13\n- lib order in makefile patched to facilitate static linking - thanks\n  to Bennett Todd for providing the patch\n- Integrated a patch from Peter Vrabec (pvrabec@redheat.com):\n  - added klogd under the name of rklogd (remove dependency on\n    original sysklogd package\n  - createDB.sql now in UTF\n  - added additional config files for use on Red Hat\n---------------------------------------------------------------------------\nVersion 1.13.1 (RGer), 2007-02-05\n- changed the listen backlog limit to a more reasonable value based on\n  the maximum number of TCP connections configurd (10% + 5) - thanks to Guy\n  Standen for the hint (actually, the limit was 5 and that was a \n  left-over from early testing).\n- fixed a bug in makefile which caused DB-support to be disabled when\n  NETZIP support was enabled\n- added the -e option to allow transmission of every message to remote\n  hosts (effectively turns off duplicate message suppression)\n- (somewhat) improved memory consumption when compiled with MySQL support\n- looks like we fixed an incompatibility with MySQL 5.x and above software\n  At least in one case, the remote server name was destroyed, leading to \n  a connection failure. The new, improved code does not have this issue and\n  so we see this as solved (the new code is generally somewhat better, so\n  there is a good chance we fixed this incompatibility).\n---------------------------------------------------------------------------\nVersion 1.13.0 (RGer), 2006-12-19\n- added '$' as ToPos proptery replacer specifier - means \"up to the\n  end of the string\"\n- property replacer option \"escape-cc\", \"drop-cc\" and \"space-cc\"  added\n- changed the handling of \\0 characters inside syslog messages. We now\n  consistently escape them to \"#000\". This is somewhat recommended in\n  the draft-ietf-syslog-protocol-19 draft. While the real recomendation\n  is to not escape any characters at all, we can not do this without\n  considerable modification of the code. So we escape it to \"#000\", which\n  is consistent with a sample found in the Internet-draft.\n- removed message glue logic (see printchopped() comment for details)\n  Also caused removal of parts table and thus some improvements in\n  memory usage.\n- changed the default MAXLINE to 2048 to take care of recent syslog\n  standardization efforts (can easily be changed in syslogd.c)\n- added support for byte-counted TCP syslog messages (much like\n  syslog-transport-tls-05 Internet Draft). This was necessary to\n  support compression over TCP.\n- added support for receiving compressed syslog messages\n- added support for sending compressed syslog messages\n- fixed a bug where the last message in a syslog/tcp stream was\n  lost if it was not properly terminated by a LF character\n---------------------------------------------------------------------------\nVersion 1.12.3 (RGer), 2006-10-04\n- implemented some changes to support Solaris (but support is not\n  yet complete)\n- commented out (via #if 0) some methods that are currently not being use\n  but should be kept for further us\n- added (interim) -u 1 option to turn off hostname and tag parsing\n- done some modifications to better support Fedora\n- made the field delimiter inside property replace configurable via\n  template\n- fixed a bug in property replacer: if fields were used, the delimitor\n  became part of the field. Up until now, this was barely noticable as \n  the delimiter as TAB only and thus invisible to a human. With other\n  delimiters available now, it quickly showed up. This bug fix might cause\n  some grief to existing installations if they used the extra TAB for\n  whatever reasons - sorry folks... Anyhow, a solution is easy: just add\n  a TAB character contstant into your template. Thus, there has no attempt\n  been made to do this in a backwards-compatible way.\n---------------------------------------------------------------------------\nVersion 1.12.2 (RGer), 2006-02-15\n- fixed a bug in the RFC 3339 date formatter. An extra space was added\n  after the actual timestamp\n- added support for providing high-precision RFC3339 timestamps for\n  (rsyslogd-)internally-generated messages\n- very (!) experimental support for syslog-protocol internet draft\n  added (the draft is experimental, the code is solid ;))\n- added support for field-extracting in the property replacer\n- enhanced the legacy-syslog parser so that it can interpret messages\n  that do not contain a TIMESTAMP\n- fixed a bug that caused the default socket (usually /dev/log) to be\n  opened even when -o command line option was given\n- fixed a bug in the Debian sample startup script - it caused rsyslogd\n  to listen to remote requests, which it shouldn't by default\n---------------------------------------------------------------------------\nVersion 1.12.1 (RGer), 2005-11-23\n- made multithreading work with BSD. Some signal-handling needed to be\n  restructured. Also, there might be a slight delay of up to 10 seconds\n  when huping and terminating rsyslogd under BSD\n- fixed a bug where a NULL-pointer was passed to printf() in logmsg().\n- fixed a bug during \"make install\" where rc3195d was not installed\n  Thanks to Bennett Todd for spotting this.\n- fixed a bug where rsyslogd dumped core when no TAG was found in the\n  received message\n- enhanced message parser so that it can deal with missing hostnames\n  in many cases (may not be totally fail-safe)\n- fixed a bug where internally-generated messages did not have the correct\n  TAG\n---------------------------------------------------------------------------\nVersion 1.12.0 (RGer), 2005-10-26\n- moved to a multi-threaded design. single-threading is still optionally\n  available. Multi-threading is experimental!\n- fixed a potential race condition. In the original code, marking was done\n  by an alarm handler, which could lead to all sorts of bad things. This\n  has been changed now. See comments in syslogd.c/domark() for details.\n- improved debug output for property-based filters\n- not a code change, but: I have checked all exit()s to make sure that\n  none occurs once rsyslogd has started up. Even in unusual conditions\n  (like low-memory conditions) rsyslogd somehow remains active. Of course,\n  it might loose a message or two, but at least it does not abort and it\n  can also recover when the condition no longer persists.\n- fixed a bug that could cause loss of the last message received\n  immediately before rsyslogd was terminated.\n- added comments on thread-safety of global variables in syslogd.c\n- fixed a small bug: spurios printf() when TCP syslog was used\n- fixed a bug that causes rsyslogd to dump core on termination when one\n  of the selector lines did not receive a message during the run (very\n  unlikely)\n- fixed an one-too-low memory allocation in the TCP sender. Could result\n  in rsyslogd dumping core.\n- fixed a bug with regular expression support (thanks to Andres Riancho)\n- a little bit of code restructuring (especially main(), which was\n  horribly large)\n---------------------------------------------------------------------------\nVersion 1.11.1 (RGer), 2005-10-19\n- support for BSD-style program name and host blocks\n- added a new property \"programname\" that can be used in templates\n- added ability to specify listen port for rfc3195d\n- fixed a bug that rendered the \"startswith\" comparison operation\n  unusable.\n- changed more functions to \"static\" storage class to help compiler\n  optimize (should have been static in the first place...)\n- fixed a potential memory leak in the string buffer class destructor.\n  As the destructur was previously never called, the leak did not actually\n  appear.\n- some internal restructuring in anticipation/preparation of minimal\n  multi-threading support\n- rsyslogd still shares some code with the sysklogd project. Some patches\n  for this shared code have been brought over from the sysklogd CVS.\n---------------------------------------------------------------------------\nVersion 1.11.0 (RGer), 2005-10-12\n- support for receiving messages via RFC 3195; added rfc3195d for that\n  purpose\n- added an additional guard to prevent rsyslogd from aborting when the\n  2gb file size limit is hit. While a user can configure rsyslogd to\n  handle such situations, it would abort if that was not done AND large\n  file support was not enabled (ok, this is hopefully an unlikely scenario)\n- fixed a bug that caused additional Unix domain sockets to be incorrectly\n  processed - could lead to message loss in extreme cases\n---------------------------------------------------------------------------\nVersion 1.10.2 (RGer), 2005-09-27\n- added comparison operations in property-based filters:\n  * isequal\n  * startswith\n- added ability to negate all property-based filter comparison operations\n  by adding a !-sign right in front of the operation name\n- added the ability to specify remote senders for UDP and TCP\n  received messages. Allows to block all but well-known hosts\n- changed the $-config line directives to be case-INsensitive\n- new command line option -w added: \"do not display warnings if messages\n  from disallowed senders are received\"\n- fixed a bug that caused rsyslogd to dump core when the compare value\n  was not quoted in property-based filters\n- fixed a bug in the new CStr compare function which lead to invalid\n  results (fortunately, this function was not yet used widely)\n- added better support for \"debugging\" rsyslog.conf property filters\n  (only if -d switch is given)\n- changed some function definitions to static, which eventually enables\n  some compiler optimizations\n- fixed a bug in MySQL code; when a SQL error occured, rsyslogd could\n  run in a tight loop. This was due to invalid sequence of error reporting\n  and is now fixed.\n---------------------------------------------------------------------------\nVersion 1.10.1 (RGer), 2005-09-23\n- added the ability to execute a shell script as an action.\n  Thanks to Bjoern Kalkbrenner for providing the code!\n- fixed a bug in the MySQL code; due to the bug the automatic one-time\n  retry after an error did not happen - this lead to error message in\n  cases where none should be seen (e.g. after a MySQL restart)\n- fixed a security issue with SQL-escaping in conjunction with\n  non-(SQL-)standard MySQL features.\n---------------------------------------------------------------------------\nVersion 1.10.0 (RGer), 2005-09-20\n  REMINDER: 1.10 is the first unstable version if the 1.x series!\n- added the capability to filter on any property in selector lines\n  (not just facility and priority)\n- changed stringbuf into a new counted string class\n- added support for a \"discard\" action. If a selector line with\n  discard (~ character) is found, no selector lines *after* that\n  line will be processed.\n- thanks to Andres Riancho, regular expression support has been\n  added to the template engine\n- added the FROMHOST property in the template processor, which could\n  previously not be obtained. Thanks to Cristian Testa for pointing\n  this out and even providing a fix.\n- added display of compile-time options to -v output\n- performance improvement for production build - made some checks\n  to happen only during debug mode\n- fixed a problem with compiling on SUSE and - while doing so - removed\n  the socket call to set SO_BSDCOMPAT in cases where it is obsolete.\n---------------------------------------------------------------------------\nVersion 1.0.4 (RGer), 2006-02-01\n- a small but important fix: the tcp receiver had two forgotten printf's\n  in it that caused a lot of unnecessary output to stdout. This was\n  important enough to justify a new release\n---------------------------------------------------------------------------\nVersion 1.0.3 (RGer), 2005-11-14\n- added an additional guard to prevent rsyslogd from aborting when the\n  2gb file size limit is hit. While a user can configure rsyslogd to\n  handle such situations, it would abort if that was not done AND large\n  file support was not enabled (ok, this is hopefully an unlikely scenario)\n- fixed a bug that caused additional Unix domain sockets to be incorrectly\n  processed - could lead to message loss in extreme cases\n- applied some patches available from the sysklogd project to code\n  shared from there\n- fixed a bug that causes rsyslogd to dump core on termination when one\n  of the selector lines did not receive a message during the run (very\n  unlikely)\n- fixed an one-too-low memory allocation in the TCP sender. Could result\n  in rsyslogd dumping core.\n- fixed a bug in the TCP sender that caused the retry logic to fail\n  after an error or receiver overrun\n- fixed a bug in init() that could lead to dumping core\n- fixed a bug that could lead to dumping core when no HOSTNAME or no TAG\n  was present in the syslog message\n---------------------------------------------------------------------------\nVersion 1.0.2 (RGer), 2005-10-05\n- fixed an issue with MySQL error reporting. When an error occured,\n  the MySQL driver went into an endless loop (at least in most cases).\n---------------------------------------------------------------------------\nVersion 1.0.1 (RGer), 2005-09-23\n- fixed a security issue with SQL-escaping in conjunction with\n  non-(SQL-)standard MySQL features.\n---------------------------------------------------------------------------\nVersion 1.0.0 (RGer), 2005-09-12\n- changed install doc to cover daily cron scripts - a trouble source\n- added rc script for slackware (provided by Chris Elvidge - thanks!) \n- fixed a really minor bug in usage() - the -r option was still\n  reported as without the port parameter\n---------------------------------------------------------------------------\nVersion 0.9.8 (RGer), 2005-09-05\n- made startup and shutdown message more consistent and included the\n  pid, so that they can be easier correlated. Used syslog-protocol\n  structured data format for this purpose.\n- improved config info in startup message, now tells not only\n  if it is listening remote on udp, but also for tcp. Also includes\n  the port numbers. The previous startup message was misleading, because\n  it did not say \"remote reception\" if rsyslogd was only listening via\n  tcp (but not via udp).\n- added a \"how can you help\" document to the doc set\n---------------------------------------------------------------------------\nVersion 0.9.7 (RGer), 2005-08-15\n- some of the previous doc files (like INSTALL) did not properly\n  reflect the changes to the build process and the new doc. Fixed\n  that.\n- changed syslogd.c so that when compiled without database support,\n  an error message is displayed when a database action is detected\n  in the config file (previously this was used as an user rule ;))\n- fixed a bug in the os-specific Makefiles which caused MySQL\n  support to not be compiled, even if selected\n---------------------------------------------------------------------------\nVersion 0.9.6 (RGer), 2005-08-09\n- greatly enhanced documentation. Now available in html format in\n  the \"doc\" folder and FreeBSD. Finally includes an install howto.\n- improved MySQL error messages a little - they now show up as log\n  messages, too (formerly only in debug mode)\n- added the ability to specify the listen port for udp syslog.\n  WARNING: This introduces an incompatibility. Formerly, udp\n  syslog was enabled by the -r command line option. Now, it is\n  \"-r [port]\", which is consistent with the tcp listener. However,\n  just -r will now return an error message.\n- added sample startup scripts for Debian and FreeBSD\n- added support for easy feature selection in the makefile. Un-\n  fortunately, this also means I needed to spilt the make file\n  for different OS and distros. There are some really bad syntax\n  differences between FreeBSD and Linux make.\n---------------------------------------------------------------------------\nVersion 0.9.5 (RGer), 2005-08-01\n- the \"semicolon bug\" was actually not (fully) solved in 0.9.4. One\n  part of the bug was solved, but another still existed. This one\n  is fixed now, too.\n- the \"semicolon bug\" actually turned out to be a more generic bug.\n  It appeared whenever an invalid template name was given. With some\n  selector actions, rsyslogd dumped core, with other it \"just\" had\n  a small ressource leak with others all worked well. These anomalies\n  are now fixed. Note that they only appeared during system initaliziation\n  once the system was running, nothing bad happened.\n- improved error reporting for template errors on startup. They are now\n  shown on the console and the start-up tty. Formerly, they were only\n  visible in debug mode.\n- support for multiple instances of rsyslogd on a single machine added\n- added new option \"-o\" --> omit local unix domain socket. This option\n  enables rsyslogd NOT to listen to the local socket. This is most\n  helpful when multiple instances of rsyslogd (or rsyslogd and another\n  syslogd) shall run on a single system.\n- added new option \"-i <pidfile>\" which allows to specify the pidfile.\n  This is needed when multiple instances of rsyslogd are to be run.\n- the new project home page is now online at www.rsyslog.com\n---------------------------------------------------------------------------\nVersion 0.9.4 (RGer), 2005-07-25\n- finally added the TCP sender. It now supports non-blocking mode, no\n  longer disabling message reception during connect. As it is now, it\n  is usable in production. The code could be more sophisticated, but\n  I've kept it short in anticipation of the move to liblogging, which\n  will lead to the removal of the code just written ;)\n- the \"exiting on signal...\" message still had the \"syslogd\" name in \n  it. Changed this to \"rsyslogd\", as we do not have a large user base\n  yet, this should pose no problem.\n- fixed \"the semiconlon\" bug. rsyslogd dumped core if a write-db action\n  was specified but no semicolon was given after the password (an empty\n  template was ok, but the semicolon needed to be present).\n- changed a default for traditional output format. During testing, it\n  was seen that the timestamp written to file in default format was\n  the time of message reception, not the time specified in the TIMESTAMP\n  field of the message itself. Traditionally, the message TIMESTAMP is\n  used and this has been changed now.\n---------------------------------------------------------------------------\nVersion 0.9.3 (RGer), 2005-07-19\n- fixed a bug in the message parser. In June, the RFC 3164 timestamp\n  was not correctly parsed (yes, only in June and some other months,\n  see the code comment to learn why...)\n- added the ability to specify the destination port when forwarding\n  syslog messages (both for TCP and UDP)\n- added an very experimental TCP sender (activated by\n  @@machine:port in config). This is not yet for production use. If\n  the receiver is not alive, rsyslogd will wait quite some time until\n  the connection request times out, which most probably leads to\n  loss of incoming messages.\n\n---------------------------------------------------------------------------\nVersion 0.9.2 (RGer), around 2005-07-06\n- I intended to change the maxsupported message size to 32k to\n  support IHE - but given the memory inefficiency in the usual use\n  cases, I have not done this. I have, however, included very\n  specific instructions on how to do this in the source code. I have\n  also done some testing with 32k messages, so you can change the\n  max size without taking too much risk.\n- added a syslog/tcp receiver; we now can receive messages via\n  plain tcp, but we can still send only via UDP. The syslog/tcp\n  receiver is the primary enhancement of this release.\n- slightly changed some error messages that contained a spurios \\n at\n  the end of the line (which gives empty lines in your log...)\n\n---------------------------------------------------------------------------\nVersion 0.9.1 (RGer)\n- fixed code so that it compiles without errors under FreeBSD\n- removed now unused function \"allocate_log()\" from syslogd.c\n- changed the make file so that it contains more defines for\n  different environments (in the long term, we need a better\n  system for disabling/enabling features...)\n- changed some printf's printing off_t types to %lld and\n  explicit (long long) casts. I tried to figure out the exact type,\n  but did not succeed in this. In the worst case, ultra-large peta-\n  byte files will now display funny informational messages on rollover,\n  something I think we can live with for the next 10 years or so...\n\n---------------------------------------------------------------------------\nVersion 0.9.0 (RGer)\n- changed the filed structure to be a linked list. Previously, it\n  was a table - well, for non-SYSV it was defined as linked list,\n  but from what I see that code did no longer work after my\n  modifications. I am now using a linked list in general because\n  that is needed for other upcoming modifications.\n- fixed a bug that caused rsyslogd not to listen to anything if\n  the configuration file could not be read\n- pervious versions disabled network logging (send/receive) if\n  syslog/udp port was not in /etc/services. Now defaulting to\n  port 514 in this case.\n- internal error messages are now supported up to 256 bytes\n- error message seen during config file read are now also displayed\n  to the attached tty and not only the console\n- changed some error messages during init to be sent to the console\n  and/or emergency log. Previously, they were only seen if the\n  -d (debug) option was present on the command line.\n- fixed the \"2gb file issue on 32bit systems\". If a file grew to\n  more than 2gb, the syslogd was aborted with \"file size exceeded\". \n  Now, defines have been added according to\n  http://www.daimi.au.dk/~kasperd/comp.os.linux.development.faq.html#LARGEFILE\n  Testing revealed that they work ;)\n  HOWEVER, if your file system, glibc, kernel, whatever does not\n  support files larger 2gb, you need to set a file size limit with\n  the new output channel mechanism.\n- updated man pages to reflect the changes\n\n---------------------------------------------------------------------------\nVersion 0.8.4\n\n- improved -d debug output (removed developer-only content)\n- now compiles under FreeBSD and NetBSD (only quick testing done on NetBSD)\n---------------------------------------------------------------------------\nVersion 0.8.3\n\n- security model in \"make install\" changed\n- minor doc updates\n---------------------------------------------------------------------------\nVersion 0.8.2\n\n- added man page for rsyslog.conf and rsyslogd\n- gave up on the concept of rsyslog being a \"drop in\" replacement\n  for syslogd. Now, the user installs rsyslogd and also needs to\n  adjust his system settings to this specifically. This also lead\n  to these changes:\n  * changed Makefile so that install now installs rsyslogd instead\n    of dealing with syslogd\n  * changed the default config file name to rsyslog.conf\n---------------------------------------------------------------------------\nVersion 0.8.1\n\n- fixed a nasty memory leak (probably not the last one with this release)\n- some enhancements to Makefile as suggested by Bennett Todd\n- syslogd-internal messages (like restart) were missing the hostname\n  this has been corrected\n---------------------------------------------------------------------------\nVersion 0.8.0\n\nInitial testing release. Based on the sysklogd package. Thanks to the\nsysklogd maintainers for all their good work!\n---------------------------------------------------------------------------\n\n----------------------------------------------------------------------\nThe following comments were left in the syslogd source. While they provide\nnot too much detail, the help to date when Rainer started work on the\nproject (which was 2003, now even surprising for Rainer himself ;)).\n * \\author Rainer Gerhards <rgerhards@adiscon.com>\n * \\date 2003-10-17\n *       Some initial modifications on the sysklogd package to support\n *       liblogging. These have actually not yet been merged to the\n *       source you see currently (but they hopefully will)\n *\n * \\date 2004-10-28\n *       Restarted the modifications of sysklogd. This time, we\n *       focus on a simpler approach first. The initial goal is to\n *       provide MySQL database support (so that syslogd can log\n *       to the database).\n----------------------------------------------------------------------\nThe following comments are from the stock syslogd.c source. They provide\nsome insight into what happened to the source before we forked\nrsyslogd. However, much of the code already has been replaced and more\nis to be replaced. So over time, these comments become less valuable.\nI have moved them out of the syslogd.c file to shrink it, especially\nas a lot of them do no longer apply. For historical reasons and\nunderstanding of how the daemon evolved, they are probably still\nhelpful.\n * Author: Eric Allman\n * extensive changes by Ralph Campbell\n * more extensive changes by Eric Allman (again)\n *\n * Steve Lord:\tFix UNIX domain socket code, added linux kernel logging\n *\t\tchange defines to\n *\t\tSYSLOG_INET\t- listen on a UDP socket\n *\t\tSYSLOG_UNIXAF\t- listen on unix domain socket\n *\t\tSYSLOG_KERNEL\t- listen to linux kernel\n *\n * Mon Feb 22 09:55:42 CST 1993:  Dr. Wettstein\n * \tAdditional modifications to the source.  Changed priority scheme\n *\tto increase the level of configurability.  In its stock configuration\n *\tsyslogd no longer logs all messages of a certain priority and above\n *\tto a log file.  The * wildcard is supported to specify all priorities.\n *\tNote that this is a departure from the BSD standard.\n *\n *\tSyslogd will now listen to both the inetd and the unixd socket.  The\n *\tstrategy is to allow all local programs to direct their output to\n *\tsyslogd through the unixd socket while the program listens to the\n *\tinetd socket to get messages forwarded from other hosts.\n *\n * Fri Mar 12 16:55:33 CST 1993:  Dr. Wettstein\n *\tThanks to Stephen Tweedie (dcs.ed.ac.uk!sct) for helpful bug-fixes\n *\tand an enlightened commentary on the prioritization problem.\n *\n *\tChanged the priority scheme so that the default behavior mimics the\n *\tstandard BSD.  In this scenario all messages of a specified priority\n *\tand above are logged.\n *\n *\tAdd the ability to specify a wildcard (=) as the first character\n *\tof the priority name.  Doing this specifies that ONLY messages with\n *\tthis level of priority are to be logged.  For example:\n *\n *\t\t*.=debug\t\t\t/usr/adm/debug\n *\n *\tWould log only messages with a priority of debug to the /usr/adm/debug\n *\tfile.\n *\n *\tProviding an * as the priority specifies that all messages are to be\n *\tlogged.  Note that this case is degenerate with specifying a priority\n *\tlevel of debug.  The wildcard * was retained because I believe that\n *\tthis is more intuitive.\n *\n * Thu Jun 24 11:34:13 CDT 1993:  Dr. Wettstein\n *\tModified sources to incorporate changes in libc4.4.  Messages from\n *\tsyslog are now null-terminated, syslogd code now parses messages\n *\tbased on this termination scheme.  Linux as of libc4.4 supports the\n *\tfsync system call.  Modified code to fsync after all writes to\n *\tlog files.\n *\n * Sat Dec 11 11:59:43 CST 1993:  Dr. Wettstein\n *\tExtensive changes to the source code to allow compilation with no\n *\tcomplaints with -Wall.\n *\n *\tReorganized the facility and priority name arrays so that they\n *\tcompatible with the syslog.h source found in /usr/include/syslog.h.\n *\tNOTE that this should really be changed.  The reason I do not\n *\tallow the use of the values defined in syslog.h is on account of\n *\tthe extensions made to allow the wildcard character in the\n *\tpriority field.  To fix this properly one should malloc an array,\n *\tcopy the contents of the array defined by syslog.h and then\n *\tmake whatever modifications that are desired.  Next round.\n *\n * Thu Jan  6 12:07:36 CST 1994:  Dr. Wettstein\n *\tAdded support for proper decomposition and re-assembly of\n *\tfragment messages on UNIX domain sockets.  Lack of this capability\n *\twas causing 'partial' messages to be output.  Since facility and\n *\tpriority information is encoded as a leader on the messages this\n *\twas causing lines to be placed in erroneous files.\n *\n *\tAlso added a patch from Shane Alderton (shane@ion.apana.org.au) to\n *\tcorrect a problem with syslogd dumping core when an attempt was made\n *\tto write log messages to a logged-on user.  Thank you.\n *\n *\tMany thanks to Juha Virtanen (jiivee@hut.fi) for a series of\n *\tinterchanges which lead to the fixing of problems with messages set\n *\tto priorities of none and emerg.  Also thanks to Juha for a patch\n *\tto exclude users with a class of LOGIN from receiving messages.\n *\n *\tShane Alderton provided an additional patch to fix zombies which\n *\twere conceived when messages were written to multiple users.\n *\n * Mon Feb  6 09:57:10 CST 1995:  Dr. Wettstein\n *\tPatch to properly reset the single priority message flag.  Thanks\n *\tto Christopher Gori for spotting this bug and forwarding a patch.\n *\n * Wed Feb 22 15:38:31 CST 1995:  Dr. Wettstein\n *\tAdded version information to startup messages.\n *\n *\tAdded defines so that paths to important files are taken from\n *\tthe definitions in paths.h.  Hopefully this will insure that\n *\teverything follows the FSSTND standards.  Thanks to Chris Metcalf\n *\tfor a set of patches to provide this functionality.  Also thanks\n *\tElias Levy for prompting me to get these into the sources.\n *\n * Wed Jul 26 18:57:23 MET DST 1995:  Martin Schulze\n *\tLinux' gethostname only returns the hostname and not the fqdn as\n *\texpected in the code. But if you call hostname with an fqdn then\n *\tgethostname will return an fqdn, so we have to mention that. This\n *\thas been changed.\n *\n *\tThe 'LocalDomain' and the hostname of a remote machine is\n *\tconverted to lower case, because the original caused some\n *\tinconsistency, because the (at least my) nameserver did respond an\n *\tfqdn containing of upper- _and_ lowercase letters while\n *\t'LocalDomain' consisted only of lowercase letters and that didn't\n *\tmatch.\n *\n * Sat Aug  5 18:59:15 MET DST 1995:  Martin Schulze\n *\tNow no messages that were received from any remote host are sent\n *\tout to another. At my domain this missing feature caused ugly\n *\tsyslog-loops, sometimes.\n *\n *\tRemember that no message is sent out. I can't figure out any\n *\tscenario where it might be useful to change this behavior and to\n *\tsend out messages to other hosts than the one from which we\n *\treceived the message, but I might be shortsighted. :-/\n *\n * Thu Aug 10 19:01:08 MET DST 1995:  Martin Schulze\n *\tAdded my pidfile.[ch] to it to perform a better handling with\n *\tpidfiles. Now both, syslogd and klogd, can only be started\n *\tonce. They check the pidfile.\n *\n * Sun Aug 13 19:01:41 MET DST 1995:  Martin Schulze\n *\tAdd an addition to syslog.conf's interpretation. If a priority\n *\tbegins with an exclamation mark ('!') the normal interpretation\n *\tof the priority is inverted: \".!*\" is the same as \".none\", \".!=info\"\n *\tdon't logs the info priority, \".!crit\" won't log any message with\n *\tthe priority crit or higher. For example:\n *\n *\t\tmail.*;mail.!=info\t\t/usr/adm/mail\n *\n *\tWould log all messages of the facility mail except those with\n *\tthe priority info to /usr/adm/mail. This makes the syslogd\n *\tmuch more flexible.\n *\n *\tDefined TABLE_ALLPRI=255 and changed some occurrences.\n *\n * Sat Aug 19 21:40:13 MET DST 1995:  Martin Schulze\n *\tMaking the table of facilities and priorities while in debug\n *\tmode more readable.\n *\n *\tIf debugging is turned on, printing the whole table of\n *\tfacilities and priorities every hexadecimal or 'X' entry is\n *\tnow 2 characters wide.\n *\n *\tThe number of the entry is prepended to each line of\n *\tfacilities and priorities, and F_UNUSED lines are not shown\n *\tanymore.\n *\n *\tCorrected some #ifdef SYSV's.\n *\n * Mon Aug 21 22:10:35 MET DST 1995:  Martin Schulze\n *\tCorrected a strange behavior during parsing of configuration\n *\tfile. The original BSD syslogd doesn't understand spaces as\n *\tseparators between specifier and action. This syslogd now\n *\tunderstands them. The old behavior caused some confusion over\n *\tthe Linux community.\n *\n * Thu Oct 19 00:02:07 MET 1995:  Martin Schulze\n *\tThe default behavior has changed for security reasons. The\n *\tsyslogd will not receive any remote message unless you turn\n *\treception on with the \"-r\" option.\n *\n *\tNot defining SYSLOG_INET will result in not doing any network\n *\tactivity, i.e. not sending or receiving messages.  I changed\n *\tthis because the old idea is implemented with the \"-r\" option\n *\tand the old thing didn't work anyway.\n *\n * Thu Oct 26 13:14:06 MET 1995:  Martin Schulze\n *\tAdded another logfile type F_FORW_UNKN.  The problem I ran into\n *\twas a name server that runs on my machine and a forwarder of\n *\tkern.crit to another host.  The hosts address can only be\n *\tfetched using the nameserver.  But named is started after\n *\tsyslogd, so syslogd complained.\n *\n *\tThis logfile type will retry to get the address of the\n *\thostname ten times and then complain.  This should be enough to\n *\tget the named up and running during boot sequence.\n *\n * Fri Oct 27 14:08:15 1995:  Dr. Wettstein\n *\tChanged static array of logfiles to a dynamic array. This\n *\tcan grow during process.\n *\n * Fri Nov 10 23:08:18 1995:  Martin Schulze\n *\tInserted a new tabular sys_h_errlist that contains plain text\n *\tfor error codes that are returned from the net subsystem and\n *\tstored in h_errno. I have also changed some wrong lookups to\n *\tsys_errlist.\n *\n * Wed Nov 22 22:32:55 1995:  Martin Schulze\n *\tAdded the fabulous strip-domain feature that allows us to\n *\tstrip off (several) domain names from the fqdn and only log\n *\tthe simple hostname. This is useful if you're in a LAN that\n *\thas a central log server and also different domains.\n *\n *\tI have also also added the -l switch do define hosts as\n *\tlocal. These will get logged with their simple hostname, too.\n *\n * Thu Nov 23 19:02:56 MET DST 1995:  Martin Schulze\n *\tAdded the possibility to omit fsyncing of logfiles after every\n *\twrite. This will give some performance back if you have\n *\tprograms that log in a very verbose manner (like innd or\n *\tsmartlist). Thanks to Stephen R. van den Berg <srb@cuci.nl>\n *\tfor the idea.\n *\n * Thu Jan 18 11:14:36 CST 1996:  Dr. Wettstein\n *\tAdded patche from beta-testers to stop compile error.  Also\n *\tadded removal of pid file as part of termination cleanup.\n *\n * Wed Feb 14 12:42:09 CST 1996:  Dr. Wettstein\n *\tAllowed forwarding of messages received from remote hosts to\n *\tbe controlled by a command-line switch.  Specifying -h allows\n *\tforwarding.  The default behavior is to disable forwarding of\n *\tmessages which were received from a remote host.\n *\n *\tParent process of syslogd does not exit until child process has\n *\tfinished initialization process.  This allows rc.* startup to\n *\tpause until syslogd facility is up and operating.\n *\n *\tRe-arranged the select code to move UNIX domain socket accepts\n *\tto be processed later.  This was a contributed change which\n *\thas been proposed to correct the delays sometimes encountered\n *\twhen syslogd starts up.\n *\n *\tMinor code cleanups.\n *\n * Thu May  2 15:15:33 CDT 1996:  Dr. Wettstein\n *\tFixed bug in init function which resulted in file descripters\n *\tbeing orphaned when syslogd process was re-initialized with SIGHUP\n *\tsignal.  Thanks to Edvard Tuinder\n *\t(Edvard.Tuinder@praseodymium.cistron.nl) for putting me on the\n *\ttrail of this bug.  I am amazed that we didn't catch this one\n *\tbefore now.\n *\n * Tue May 14 00:03:35 MET DST 1996:  Martin Schulze\n *\tCorrected a mistake that causes the syslogd to stop logging at\n *\tsome virtual consoles under Linux. This was caused by checking\n *\tthe wrong error code. Thanks to Michael Nonweiler\n *\t<mrn20@hermes.cam.ac.uk> for sending me a patch.\n *\n * Mon May 20 13:29:32 MET DST 1996:  Miquel van Smoorenburg <miquels@cistron.nl>\n *\tAdded continuation line supported and fixed a bug in\n *\tthe init() code.\n *\n * Tue May 28 00:58:45 MET DST 1996:  Martin Schulze\n *\tCorrected behaviour of blocking pipes - i.e. the whole system\n *\thung.  Michael Nonweiler <mrn20@hermes.cam.ac.uk> has sent us\n *\ta patch to correct this.  A new logfile type F_PIPE has been\n *\tintroduced.\n *\n * Mon Feb 3 10:12:15 MET DST 1997:  Martin Schulze\n *\tCorrected behaviour of logfiles if the file can't be opened.\n *\tThere was a bug that causes syslogd to try to log into non\n *\texisting files which ate cpu power.\n *\n * Sun Feb 9 03:22:12 MET DST 1997:  Martin Schulze\n *\tModified syslogd.c to not kill itself which confuses bash 2.0.\n *\n * Mon Feb 10 00:09:11 MET DST 1997:  Martin Schulze\n *\tImproved debug code to decode the numeric facility/priority\n *\tpair into textual information.\n *\n * Tue Jun 10 12:35:10 MET DST 1997:  Martin Schulze\n *\tCorrected freeing of logfiles.  Thanks to Jos Vos <jos@xos.nl>\n *\tfor reporting the bug and sending an idea to fix the problem.\n *\n * Tue Jun 10 12:51:41 MET DST 1997:  Martin Schulze\n *\tRemoved sleep(10) from parent process.  This has caused a slow\n *\tstartup in former times - and I don't see any reason for this.\n *\n * Sun Jun 15 16:23:29 MET DST 1997: Michael Alan Dorman\n *\tSome more glibc patches made by <mdorman@debian.org>.\n *\n * Thu Jan  1 16:04:52 CET 1998: Martin Schulze <joey@infodrom.north.de\n *\tApplied patch from Herbert Thielen <Herbert.Thielen@lpr.e-technik.tu-muenchen.de>.\n *\tThis included some balance parentheses for emacs and a bug in\n *\tthe exclamation mark handling.\n *\n *\tFixed small bug which caused syslogd to write messages to the\n *\twrong logfile under some very rare conditions.  Thanks to\n *\tHerbert Xu <herbert@gondor.apana.org.au> for fiddling this out.\n *\n * Thu Jan  8 22:46:35 CET 1998: Martin Schulze <joey@infodrom.north.de>\n *\tReworked one line of the above patch as it prevented syslogd\n *\tfrom binding the socket with the result that no messages were\n *\tforwarded to other hosts.\n *\n * Sat Jan 10 01:33:06 CET 1998: Martin Schulze <joey@infodrom.north.de>\n *\tFixed small bugs in F_FORW_UNKN meachanism.  Thanks to Torsten\n *\tNeumann <torsten@londo.rhein-main.de> for pointing me to it.\n *\n * Mon Jan 12 19:50:58 CET 1998: Martin Schulze <joey@infodrom.north.de>\n *\tModified debug output concerning remote receiption.\n *\n * Mon Feb 23 23:32:35 CET 1998: Topi Miettinen <Topi.Miettinen@ml.tele.fi>\n *\tRe-worked handling of Unix and UDP sockets to support closing /\n *\topening of them in order to have it open only if it is needed\n *\teither for forwarding to a remote host or by receiption from\n *\tthe network.\n *\n * Wed Feb 25 10:54:09 CET 1998: Martin Schulze <joey@infodrom.north.de>\n *\tFixed little comparison mistake that prevented the MARK\n *\tfeature to work properly.\n *\n * Wed Feb 25 13:21:44 CET 1998: Martin Schulze <joey@infodrom.north.de>\n *\tCorrected Topi's patch as it prevented forwarding during\n *\tstartup due to an unknown LogPort.\n *\n * Sat Oct 10 20:01:48 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tAdded support for TESTING define which will turn syslogd into\n *\tstdio-mode used for debugging.\n *\n * Sun Oct 11 20:16:59 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tReworked the initialization/fork code.  Now the parent\n *\tprocess activates a signal handler which the daughter process\n *\twill raise if it is initialized.  Only after that one the\n *\tparent process may exit.  Otherwise klogd might try to flush\n *\tits log cache while syslogd can't receive the messages yet.\n *\n * Mon Oct 12 13:30:35 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tRedirected some error output with regard to argument parsing to\n *\tstderr.\n *\n * Mon Oct 12 14:02:51 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tApplied patch provided vom Topi Miettinen with regard to the\n *\tpeople from OpenBSD.  This provides the additional '-a'\n *\targument used for specifying additional UNIX domain sockets to\n *\tlisten to.  This is been used with chroot()'ed named's for\n *\texample.  See for http://www.psionic.com/papers/dns.html\n *\n * Mon Oct 12 18:29:44 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tAdded `ftp' facility which was introduced in glibc version 2.\n *\tIt's #ifdef'ed so won't harm with older libraries.\n *\n * Mon Oct 12 19:59:21 MET DST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tCode cleanups with regard to bsd -> posix transition and\n *\tstronger security (buffer length checking).  Thanks to Topi\n *\tMiettinen <tom@medialab.sonera.net>\n *\t. index() --> strchr()\n *\t. sprintf() --> snprintf()\n *\t. bcopy() --> memcpy()\n *\t. bzero() --> memset()\n *\t. UNAMESZ --> UT_NAMESIZE\n *\t. sys_errlist --> strerror()\n *\n * Mon Oct 12 20:22:59 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tAdded support for setutent()/getutent()/endutend() instead of\n *\tbinary reading the UTMP file.  This is the the most portable\n *\tway.  This allows /var/run/utmp format to change, even to a\n *\treal database or utmp daemon. Also if utmp file locking is\n *\timplemented in libc, syslog will use it immediately.  Thanks\n *\tto Topi Miettinen <tom@medialab.sonera.net>.\n *\n * Mon Oct 12 20:49:18 MET DST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tAvoid logging of SIGCHLD when syslogd is in the process of\n *\texiting and closing its files.  Again thanks to Topi.\n *\n * Mon Oct 12 22:18:34 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tModified printline() to support 8bit characters - such as\n *\trussion letters.  Thanks to Vladas Lapinskas <lapinskas@mail.iae.lt>.\n *\n * Sat Nov 14 02:29:37 CET 1998: Martin Schulze <joey@infodrom.north.de>\n *\t``-m 0'' now turns of MARK logging entirely.\n *\n * Tue Jan 19 01:04:18 MET 1999: Martin Schulze <joey@infodrom.north.de>\n *\tFinally fixed an error with `-a' processing, thanks to Topi\n *\tMiettinen <tom@medialab.sonera.net>.\n *\n * Sun May 23 10:08:53 CEST 1999: Martin Schulze <joey@infodrom.north.de>\n *\tRemoved superflous call to utmpname().  The path to the utmp\n *\tfile is defined in the used libc and should not be hardcoded\n *\tinto the syslogd binary referring the system it was compiled on.\n *\n * Sun Sep 17 20:45:33 CEST 2000: Martin Schulze <joey@infodrom.ffis.de>\n *\tFixed some bugs in printline() code that did not escape\n *\tcontrol characters '\\177' through '\\237' and contained a\n *\tsingle-byte buffer overflow.  Thanks to Solar Designer\n *\t<solar@false.com>.\n *\n * Sun Sep 17 21:26:16 CEST 2000: Martin Schulze <joey@infodrom.ffis.de>\n *\tDon't close open sockets upon reload.  Thanks to Bill\n *\tNottingham.\n *\n * Mon Sep 18 09:10:47 CEST 2000: Martin Schulze <joey@infodrom.ffis.de>\n *\tFixed bug in printchopped() that caused syslogd to emit\n *\tkern.emerg messages when splitting long lines.  Thanks to\n *\tDaniel Jacobowitz <dan@debian.org> for the fix.\n *\n * Mon Sep 18 15:33:26 CEST 2000: Martin Schulze <joey@infodrom.ffis.de>\n *\tRemoved unixm/unix domain sockets and switch to Datagram Unix\n *\tSockets.  This should remove one possibility to play DoS with\n *\tsyslogd.  Thanks to Olaf Kirch <okir@caldera.de> for the patch.\n *\n * Sun Mar 11 20:23:44 CET 2001: Martin Schulze <joey@infodrom.ffis.de>\n *\tDon't return a closed fd if `-a' is called with a wrong path.\n *\tThanks to Bill Nottingham <notting@redhat.com> for providing\n *\ta patch.\n", "/* Definition of the batch_t data structure.\n * I am not sure yet if this will become a full-blown object. For now, this header just\n * includes the object definition and is not accompanied by code.\n *\n * Copyright 2009 by Rainer Gerhards and Adiscon GmbH.\n *\n * This file is part of the rsyslog runtime library.\n *\n * The rsyslog runtime library is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * The rsyslog runtime library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with the rsyslog runtime library.  If not, see <http://www.gnu.org/licenses/>.\n *\n * A copy of the GPL can be found in the file \"COPYING\" in this distribution.\n * A copy of the LGPL can be found in the file \"COPYING.LESSER\" in this distribution.\n */\n\n#ifndef BATCH_H_INCLUDED\n#define BATCH_H_INCLUDED\n\n#include <string.h>\n#include \"msg.h\"\n\n/* enum for batch states. Actually, we violate a layer here, in that we assume that a batch is used\n * for action processing. So far, this seems acceptable, the status is simply ignored inside the\n * main message queue. But over time, it could potentially be useful to split the two.\n * rgerhad, 2009-05-12\n */\ntypedef enum {\n\tBATCH_STATE_RDY  = 0,\t/* object ready for processing */\n\tBATCH_STATE_BAD  = 1,\t/* unrecoverable failure while processing, do NOT resubmit to same action */\n\tBATCH_STATE_SUB  = 2,\t/* message submitted for processing, outcome yet unknown */\n\tBATCH_STATE_COMM = 3,\t/* message successfully commited */\n\tBATCH_STATE_DISC = 4, \t/* discarded - processed OK, but do not submit to any other action */\n} batch_state_t;\n\n\n/* an object inside a batch, including any information (state!) needed for it to \"life\".\n */\nstruct batch_obj_s {\n\tobj_t *pUsrp;\t\t/* pointer to user object (most often message) */\n\tbatch_state_t state;\t/* associated state */\n\t/* work variables for action processing; these are reused for each action (or block of\n\t * actions)\n\t */\n\tsbool bFilterOK;\t/* work area for filter processing (per action, reused!) */\n\tsbool bPrevWasSuspended;\n\t/* following are caches to save allocs if not absolutely necessary */\n\tuchar *staticActStrings[CONF_OMOD_NUMSTRINGS_MAXSIZE]; /**< for strings */\n\t\t\t\t/* a cache to save malloc(), if not absolutely necessary */\n\tvoid *staticActParams[CONF_OMOD_NUMSTRINGS_MAXSIZE]; /**< for anything else */\n\tsize_t staticLenStrings[CONF_OMOD_NUMSTRINGS_MAXSIZE];\n\t\t\t\t/* and the same for the message length (if used) */\n\t/* end action work variables */\n};\n\n/* the batch\n * This object is used to dequeue multiple user pointers which are than handed over\n * to processing. The size of elements is fixed after queue creation, but may be \n * modified by config variables (better said: queue properties).\n * Note that a \"user pointer\" in rsyslog context so far always is a message \n * object. We stick to the more generic term because queues may potentially hold\n * other types of objects, too.\n * rgerhards, 2009-05-12\n * Note that nElem is not necessarily equal to nElemDeq. This is the case when we\n * discard some elements (because of configuration) during dequeue processing. As\n * all Elements are only deleted when the batch is processed, we can not immediately\n * delete them. So we need to keep their number that we can delete them when the batch\n * is completed (else, the whole process does not work correctly).\n */\nstruct batch_s {\n\tint maxElem;\t\t/* maximum number of elements that this batch supports */\n\tint nElem;\t\t/* actual number of element in this entry */\n\tint nElemDeq;\t\t/* actual number of elements dequeued (and thus to be deleted) - see comment above! */\n\tint iDoneUpTo;\t\t/* all messages below this index have state other than RDY */\n\tqDeqID\tdeqID;\t\t/* ID of dequeue operation that generated this batch */\n\tint *pbShutdownImmediate;/* end processing of this batch immediately if set to 1 */\n\tsbool bSingleRuleset;\t/* do all msgs of this batch use a single ruleset? */\n\tbatch_obj_t *pElem;\t/* batch elements */\n};\n\n\n/* some inline functions (we may move this off to an object .. or not) */\nstatic inline void\nbatchSetSingleRuleset(batch_t *pBatch, sbool val) {\n\tpBatch->bSingleRuleset = val;\n}\n\n/* get the batches ruleset (if we have a single ruleset) */\nstatic inline ruleset_t*\nbatchGetRuleset(batch_t *pBatch) {\n\treturn (pBatch->nElem > 0) ? ((msg_t*) pBatch->pElem[0].pUsrp)->pRuleset : NULL;\n}\n\n/* get the ruleset of a specifc element of the batch (index not verified!) */\nstatic inline ruleset_t*\nbatchElemGetRuleset(batch_t *pBatch, int i) {\n\treturn ((msg_t*) pBatch->pElem[i].pUsrp)->pRuleset;\n}\n\n/* get number of msgs for this batch */\nstatic inline int\nbatchNumMsgs(batch_t *pBatch) {\n\treturn pBatch->nElem;\n}\n\n\n/* set the status of the i-th batch element. Note that once the status is\n * DISC, it will never be reset. So this function can NOT be used to initialize\n * the state table. -- rgerhards, 2010-06-10\n */\nstatic inline void\nbatchSetElemState(batch_t *pBatch, int i, batch_state_t newState) {\n\tif(pBatch->pElem[i].state != BATCH_STATE_DISC)\n\t\tpBatch->pElem[i].state = newState;\n}\n\n\n/* check if an element is a valid entry. We do NOT verify if the\n * element index is valid. -- rgerhards, 2010-06-10\n */\nstatic inline int\nbatchIsValidElem(batch_t *pBatch, int i) {\n\treturn(pBatch->pElem[i].bFilterOK && pBatch->pElem[i].state != BATCH_STATE_DISC);\n}\n\n\n/* copy one batch element to another.\n * This creates a complete duplicate in those cases where\n * it is needed. Use duplication only when absolutely necessary!\n * rgerhards, 2010-06-10\n */\nstatic inline void\nbatchCopyElem(batch_obj_t *pDest, batch_obj_t *pSrc) {\n\tmemcpy(pDest, pSrc, sizeof(batch_obj_t));\n}\n\n\n/* free members of a batch \"object\". Note that we can not do the usual\n * destruction as the object typically is allocated on the stack and so the\n * object itself cannot be freed! -- rgerhards, 2010-06-15\n */\nstatic inline void\nbatchFree(batch_t *pBatch) {\n\tint i;\n\tint j;\n\tfor(i = 0 ; i < pBatch->maxElem ; ++i) {\n\t\tfor(j = 0 ; j < CONF_OMOD_NUMSTRINGS_MAXSIZE ; ++j) {\n\t\t\t/* staticActParams MUST be freed immediately (if required),\n\t\t\t * so we do not need to do that!\n\t\t\t */\n\t\t\tfree(pBatch->pElem[i].staticActStrings[j]);\n\t\t}\n\t}\n\tfree(pBatch->pElem);\n}\n\n\n/* initialiaze a batch \"object\". The record must already exist,\n * we \"just\" initialize it. The max number of elements must be\n * provided. -- rgerhards, 2010-06-15\n */\nstatic inline rsRetVal\nbatchInit(batch_t *pBatch, int maxElem) {\n\tDEFiRet;\n\tpBatch->maxElem = maxElem;\n\tCHKmalloc(pBatch->pElem = calloc((size_t)maxElem, sizeof(batch_obj_t)));\n\t// TODO: replace calloc by inidividual writes?\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* primarily a helper for debug purposes, get human-readble name of state */\nstatic inline char *\nbatchState2String(batch_state_t state) {\n\tswitch(state) {\n\tcase BATCH_STATE_RDY:\n\t\treturn \"BATCH_STATE_RDY\";\n\tcase BATCH_STATE_BAD:\n\t\treturn \"BATCH_STATE_BAD\";\n\tcase BATCH_STATE_SUB:\n\t\treturn \"BATCH_STATE_SUB\";\n\tcase BATCH_STATE_COMM:\n\t\treturn \"BATCH_STATE_COMM\";\n\tcase BATCH_STATE_DISC:\n\t\treturn \"BATCH_STATE_DISC\";\n\t}\n\treturn \"ERROR, batch state not known!\";\n}\n#endif /* #ifndef BATCH_H_INCLUDED */\n", "/* ruleset.c - rsyslog's ruleset object\n *\n * We have a two-way structure of linked lists: one global linked list\n * (llAllRulesets) hold alls rule sets that we know. Included in each\n * list is a list of rules (which contain a list of actions, but that's\n * a different story).\n *\n * Usually, only a single rule set is executed. However, there exist some\n * situations where all rules must be iterated over, for example on HUP. Thus,\n * we also provide interfaces to do that.\n *\n * Module begun 2009-06-10 by Rainer Gerhards\n *\n * Copyright 2009 Rainer Gerhards and Adiscon GmbH.\n *\n * This file is part of the rsyslog runtime library.\n *\n * The rsyslog runtime library is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * The rsyslog runtime library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with the rsyslog runtime library.  If not, see <http://www.gnu.org/licenses/>.\n *\n * A copy of the GPL can be found in the file \"COPYING\" in this distribution.\n * A copy of the LGPL can be found in the file \"COPYING.LESSER\" in this distribution.\n */\n\n#include \"config.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <assert.h>\n#include <ctype.h>\n\n#include \"rsyslog.h\"\n#include \"obj.h\"\n#include \"cfsysline.h\"\n#include \"msg.h\"\n#include \"ruleset.h\"\n#include \"rule.h\"\n#include \"errmsg.h\"\n#include \"parser.h\"\n#include \"batch.h\"\n#include \"unicode-helper.h\"\n#include \"dirty.h\" /* for main ruleset queue creation */\n\n/* static data */\nDEFobjStaticHelpers\nDEFobjCurrIf(errmsg)\nDEFobjCurrIf(rule)\nDEFobjCurrIf(parser)\n\nlinkedList_t llRulesets; /* this is NOT a pointer - no typo here ;) */\nruleset_t *pCurrRuleset = NULL; /* currently \"active\" ruleset */\nruleset_t *pDfltRuleset = NULL; /* current default ruleset, e.g. for binding to actions which have no other */\n\n/* forward definitions */\nstatic rsRetVal processBatch(batch_t *pBatch);\n\n/* ---------- linked-list key handling functions ---------- */\n\n/* destructor for linked list keys.\n */\nstatic rsRetVal keyDestruct(void __attribute__((unused)) *pData)\n{\n\tfree(pData);\n\treturn RS_RET_OK;\n}\n\n\n/* ---------- END linked-list key handling functions ---------- */\n\n\n/* driver to iterate over all of this ruleset actions */\ntypedef struct iterateAllActions_s {\n\trsRetVal (*pFunc)(void*, void*);\n\tvoid *pParam;\n} iterateAllActions_t;\nDEFFUNC_llExecFunc(doIterateRulesetActions)\n{\n\tDEFiRet;\n\trule_t* pRule = (rule_t*) pData;\n\titerateAllActions_t *pMyParam = (iterateAllActions_t*) pParam;\n\tiRet = rule.IterateAllActions(pRule, pMyParam->pFunc, pMyParam->pParam);\n\tRETiRet;\n}\n/* iterate over all actions of THIS rule set.\n */\nstatic rsRetVal\niterateRulesetAllActions(ruleset_t *pThis, rsRetVal (*pFunc)(void*, void*), void* pParam)\n{\n\titerateAllActions_t params;\n\tDEFiRet;\n\tassert(pFunc != NULL);\n\n\tparams.pFunc = pFunc;\n\tparams.pParam = pParam;\n\tCHKiRet(llExecFunc(&(pThis->llRules), doIterateRulesetActions, &params));\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* driver to iterate over all actions */\nDEFFUNC_llExecFunc(doIterateAllActions)\n{\n\tDEFiRet;\n\truleset_t* pThis = (ruleset_t*) pData;\n\titerateAllActions_t *pMyParam = (iterateAllActions_t*) pParam;\n\tiRet = iterateRulesetAllActions(pThis, pMyParam->pFunc, pMyParam->pParam);\n\tRETiRet;\n}\n/* iterate over ALL actions present in the WHOLE system.\n * this is often needed, for example when HUP processing \n * must be done or a shutdown is pending.\n */\nstatic rsRetVal\niterateAllActions(rsRetVal (*pFunc)(void*, void*), void* pParam)\n{\n\titerateAllActions_t params;\n\tDEFiRet;\n\tassert(pFunc != NULL);\n\n\tparams.pFunc = pFunc;\n\tparams.pParam = pParam;\n\tCHKiRet(llExecFunc(&llRulesets, doIterateAllActions, &params));\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n\n/* helper to processBatch(), used to call the configured actions. It is\n * executed from within llExecFunc() of the action list.\n * rgerhards, 2007-08-02\n */\nDEFFUNC_llExecFunc(processBatchDoRules)\n{\n\trsRetVal iRet;\n\tISOBJ_TYPE_assert(pData, rule);\n\tdbgprintf(\"Processing next rule\\n\");\n\tiRet = rule.ProcessBatch((rule_t*) pData, (batch_t*) pParam);\ndbgprintf(\"ruleset: get iRet %d from rule.ProcessMsg()\\n\", iRet);\n\treturn iRet;\n}\n\n\n\n/* This function is similar to processBatch(), but works on a batch that\n * contains rules from multiple rulesets. In this case, we can not push\n * the whole batch through the ruleset. Instead, we examine it and\n * partition it into sub-rulesets which we then push through the system.\n * Note that when we evaluate which message must be processed, we do NOT need\n * to look at bFilterOK, because this value is only set in a later processing\n * stage. Doing so caused a bug during development ;)\n * rgerhards, 2010-06-15\n */\nstatic inline rsRetVal\nprocessBatchMultiRuleset(batch_t *pBatch)\n{\n\truleset_t *currRuleset;\n\tbatch_t snglRuleBatch;\n\tint i;\n\tint iStart;\t/* start index of partial batch */\n\tint iNew;\t/* index for new (temporary) batch */\n\tDEFiRet;\n\n\tCHKiRet(batchInit(&snglRuleBatch, pBatch->nElem));\n\tsnglRuleBatch.pbShutdownImmediate = pBatch->pbShutdownImmediate;\n\n\twhile(1) { /* loop broken inside */\n\t\t/* search for first unprocessed element */\n\t\tfor(iStart = 0 ; iStart < pBatch->nElem && pBatch->pElem[iStart].state == BATCH_STATE_DISC ; ++iStart)\n\t\t\t/* just search, no action */;\n\n\t\tif(iStart == pBatch->nElem)\n\t\t\tFINALIZE; /* everything processed */\n\n\t\t/* prepare temporary batch */\n\t\tcurrRuleset = batchElemGetRuleset(pBatch, iStart);\n\t\tiNew = 0;\n\t\tfor(i = iStart ; i < pBatch->nElem ; ++i) {\n\t\t\tif(batchElemGetRuleset(pBatch, i) == currRuleset) {\n\t\t\t\tbatchCopyElem(&(snglRuleBatch.pElem[iNew++]), &(pBatch->pElem[i]));\n\t\t\t\t/* We indicate the element also as done, so it will not be processed again */\n\t\t\t\tpBatch->pElem[i].state = BATCH_STATE_DISC;\n\t\t\t}\n\t\t}\n\t\tsnglRuleBatch.nElem = iNew; /* was left just right by the for loop */\n\t\tbatchSetSingleRuleset(&snglRuleBatch, 1);\n\t\t/* process temp batch */\n\t\tprocessBatch(&snglRuleBatch);\n\t}\n\tbatchFree(&snglRuleBatch);\n\nfinalize_it:\n\tRETiRet;\n}\n\n/* Process (consume) a batch of messages. Calls the actions configured.\n * If the whole batch uses a singel ruleset, we can process the batch as \n * a whole. Otherwise, we need to process it slower, on a message-by-message\n * basis (what can be optimized to a per-ruleset basis)\n * rgerhards, 2005-10-13\n */\nstatic rsRetVal\nprocessBatch(batch_t *pBatch)\n{\n\truleset_t *pThis;\n\tDEFiRet;\n\tassert(pBatch != NULL);\n\ndbgprintf(\"ZZZ: processBatch: batch of %d elements must be processed\\n\", pBatch->nElem);\n\tif(pBatch->bSingleRuleset) {\n\t\tpThis = batchGetRuleset(pBatch);\n\t\tif(pThis == NULL)\n\t\t\tpThis = pDfltRuleset;\n\t\tISOBJ_TYPE_assert(pThis, ruleset);\n\t\tCHKiRet(llExecFunc(&pThis->llRules, processBatchDoRules, pBatch));\n\t} else {\n\t\tCHKiRet(processBatchMultiRuleset(pBatch));\n\t}\n\nfinalize_it:\ndbgprintf(\"ruleset.ProcessMsg() returns %d\\n\", iRet);\n\tRETiRet;\n}\n\n\n/* return the ruleset-assigned parser list. NULL means use the default\n * parser list.\n * rgerhards, 2009-11-04\n */\nstatic parserList_t*\nGetParserList(msg_t *pMsg)\n{\n\treturn (pMsg->pRuleset == NULL) ? pDfltRuleset->pParserLst : pMsg->pRuleset->pParserLst;\n}\n\n\n/* Add a new rule to the end of the current rule set. We do a number\n * of checks and ignore the rule if it does not pass them.\n */\nstatic rsRetVal\naddRule(ruleset_t *pThis, rule_t **ppRule)\n{\n\tint iActionCnt;\n\tDEFiRet;\n\n\tISOBJ_TYPE_assert(pThis, ruleset);\n\tISOBJ_TYPE_assert(*ppRule, rule);\n\n\tCHKiRet(llGetNumElts(&(*ppRule)->llActList, &iActionCnt));\n\tif(iActionCnt == 0) {\n\t\terrmsg.LogError(0, NO_ERRCODE, \"warning: selector line without actions will be discarded\");\n\t\trule.Destruct(ppRule);\n\t} else {\n\t\tCHKiRet(llAppend(&pThis->llRules, NULL, *ppRule));\n\t\tdbgprintf(\"selector line successfully processed\\n\");\n\t}\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* set name for ruleset */\nstatic rsRetVal setName(ruleset_t *pThis, uchar *pszName)\n{\n\tDEFiRet;\n\tfree(pThis->pszName);\n\tCHKmalloc(pThis->pszName = ustrdup(pszName));\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* get current ruleset\n * We use a non-standard calling interface, as nothing can go wrong and it\n * is really much more natural to return the pointer directly.\n */\nstatic ruleset_t*\nGetCurrent(void)\n{\n\treturn pCurrRuleset;\n}\n\n\n/* get main queue associated with ruleset. If no ruleset-specifc main queue\n * is set, the primary main message queue is returned.\n * We use a non-standard calling interface, as nothing can go wrong and it\n * is really much more natural to return the pointer directly.\n */\nstatic qqueue_t*\nGetRulesetQueue(ruleset_t *pThis)\n{\n\tISOBJ_TYPE_assert(pThis, ruleset);\n\treturn (pThis->pQueue == NULL) ? pMsgQueue : pThis->pQueue;\n}\n\n\n/* Find the ruleset with the given name and return a pointer to its object.\n */\nstatic rsRetVal\nGetRuleset(ruleset_t **ppRuleset, uchar *pszName)\n{\n\tDEFiRet;\n\tassert(ppRuleset != NULL);\n\tassert(pszName != NULL);\n\n\tCHKiRet(llFind(&llRulesets, pszName, (void*) ppRuleset));\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* Set a new default rule set. If the default can not be found, no change happens.\n */\nstatic rsRetVal\nSetDefaultRuleset(uchar *pszName)\n{\n\truleset_t *pRuleset;\n\tDEFiRet;\n\tassert(pszName != NULL);\n\n\tCHKiRet(GetRuleset(&pRuleset, pszName));\n\tpDfltRuleset = pRuleset;\n\tdbgprintf(\"default rule set changed to %p: '%s'\\n\", pRuleset, pszName);\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* Set a new current rule set. If the ruleset can not be found, no change happens.\n */\nstatic rsRetVal\nSetCurrRuleset(uchar *pszName)\n{\n\truleset_t *pRuleset;\n\tDEFiRet;\n\tassert(pszName != NULL);\n\n\tCHKiRet(GetRuleset(&pRuleset, pszName));\n\tpCurrRuleset = pRuleset;\n\tdbgprintf(\"current rule set changed to %p: '%s'\\n\", pRuleset, pszName);\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* destructor we need to destruct rules inside our linked list contents.\n */\nstatic rsRetVal\ndoRuleDestruct(void *pData)\n{\n\trule_t *pRule = (rule_t *) pData;\n\tDEFiRet;\n\trule.Destruct(&pRule);\n\tRETiRet;\n}\n\n\n/* Standard-Constructor\n */\nBEGINobjConstruct(ruleset) /* be sure to specify the object type also in END macro! */\n\tCHKiRet(llInit(&pThis->llRules, doRuleDestruct, NULL, NULL));\nfinalize_it:\nENDobjConstruct(ruleset)\n\n\n/* ConstructionFinalizer\n * This also adds the rule set to the list of all known rulesets.\n */\nstatic rsRetVal\nrulesetConstructFinalize(ruleset_t *pThis)\n{\n\tuchar *keyName;\n\tDEFiRet;\n\tISOBJ_TYPE_assert(pThis, ruleset);\n\n\t/* we must duplicate our name, as the key destructer would also\n\t * free it, resulting in a double-free. It's also cleaner to have\n\t * two separate copies.\n\t */\n\tCHKmalloc(keyName = ustrdup(pThis->pszName));\n\tCHKiRet(llAppend(&llRulesets, keyName, pThis));\n\n\t/* this now also is the new current ruleset */\n\tpCurrRuleset = pThis;\n\n\t/* and also the default, if so far none has been set */\n\tif(pDfltRuleset == NULL)\n\t\tpDfltRuleset = pThis;\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* destructor for the ruleset object */\nBEGINobjDestruct(ruleset) /* be sure to specify the object type also in END and CODESTART macros! */\nCODESTARTobjDestruct(ruleset)\n\tdbgprintf(\"destructing ruleset %p, name %p\\n\", pThis, pThis->pszName);\n\tif(pThis->pQueue != NULL) {\n\t\tqqueueDestruct(&pThis->pQueue);\n\t}\n\tif(pThis->pParserLst != NULL) {\n\t\tparser.DestructParserList(&pThis->pParserLst);\n\t}\n\tllDestroy(&pThis->llRules);\n\tfree(pThis->pszName);\nENDobjDestruct(ruleset)\n\n/* this is a special destructor for the linkedList class. LinkedList does NOT\n * provide a pointer to the pointer, but rather the raw pointer itself. So we \n * must map this, otherwise the destructor will abort.\n */\nstatic rsRetVal\nrulesetDestructForLinkedList(void *pData)\n{\n\truleset_t *pThis = (ruleset_t*) pData;\n\treturn rulesetDestruct(&pThis);\n}\n\n\n/* destruct ALL rule sets that reside in the system. This must\n * be callable before unloading this module as the module may\n * not be unloaded before unload of the actions is required. This is\n * kind of a left-over from previous logic and may be optimized one\n * everything runs stable again. -- rgerhards, 2009-06-10\n */\nstatic rsRetVal\ndestructAllActions(void)\n{\n\tDEFiRet;\n\n\tCHKiRet(llDestroy(&llRulesets));\n\tCHKiRet(llInit(&llRulesets, rulesetDestructForLinkedList, keyDestruct, strcasecmp));\n\tpDfltRuleset = NULL;\n\nfinalize_it:\n\tRETiRet;\n}\n\n/* helper for debugPrint(), initiates rule printing */\nDEFFUNC_llExecFunc(doDebugPrintRule)\n{\n\treturn rule.DebugPrint((rule_t*) pData);\n}\n/* debugprint for the ruleset object */\nBEGINobjDebugPrint(ruleset) /* be sure to specify the object type also in END and CODESTART macros! */\nCODESTARTobjDebugPrint(ruleset)\n\tdbgoprint((obj_t*) pThis, \"rsyslog ruleset %s:\\n\", pThis->pszName);\n\tllExecFunc(&pThis->llRules, doDebugPrintRule, NULL);\nENDobjDebugPrint(ruleset)\n\n\n/* helper for debugPrintAll(), prints a single ruleset */\nDEFFUNC_llExecFunc(doDebugPrintAll)\n{\n\treturn rulesetDebugPrint((ruleset_t*) pData);\n}\n/* debug print all rulesets\n */\nstatic rsRetVal\ndebugPrintAll(void)\n{\n\tDEFiRet;\n\tdbgprintf(\"All Rulesets:\\n\");\n\tllExecFunc(&llRulesets, doDebugPrintAll, NULL);\n\tdbgprintf(\"End of Rulesets.\\n\");\n\tRETiRet;\n}\n\n\n/* Create a ruleset-specific \"main\" queue for this ruleset. If one is already\n * defined, an error message is emitted but nothing else is done.\n * Note: we use the main message queue parameters for queue creation and access\n * syslogd.c directly to obtain these. This is far from being perfect, but\n * considered acceptable for the time being.\n * rgerhards, 2009-10-27\n */\nstatic rsRetVal\nrulesetCreateQueue(void __attribute__((unused)) *pVal, int *pNewVal)\n{\n\tDEFiRet;\n\n\tif(pCurrRuleset == NULL) {\n\t\terrmsg.LogError(0, RS_RET_NO_CURR_RULESET, \"error: currently no specific ruleset specified, thus a \"\n\t\t\t\t\"queue can not be added to it\");\n\t\tABORT_FINALIZE(RS_RET_NO_CURR_RULESET);\n\t}\n\n\tif(pCurrRuleset->pQueue != NULL) {\n\t\terrmsg.LogError(0, RS_RET_RULES_QUEUE_EXISTS, \"error: ruleset already has a main queue, can not \"\n\t\t\t\t\"add another one\");\n\t\tABORT_FINALIZE(RS_RET_RULES_QUEUE_EXISTS);\n\t}\n\n\tif(pNewVal == 0)\n\t\tFINALIZE; /* if it is turned off, we do not need to change anything ;) */\n\n\tdbgprintf(\"adding a ruleset-specific \\\"main\\\" queue\");\n\tCHKiRet(createMainQueue(&pCurrRuleset->pQueue, UCHAR_CONSTANT(\"ruleset\")));\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* Add a ruleset specific parser to the ruleset. Note that adding the first\n * parser automatically disables the default parsers. If they are needed as well,\n * the must be added via explicit config directives.\n * Note: this is the only spot in the code that requires the parser object. In order\n * to solve some class init bootstrap sequence problems, we get the object handle here\n * instead of during module initialization. Note that objUse() is capable of being \n * called multiple times.\n * rgerhards, 2009-11-04\n */\nstatic rsRetVal\nrulesetAddParser(void __attribute__((unused)) *pVal, uchar *pName)\n{\n\tparser_t *pParser;\n\tDEFiRet;\n\n\tassert(pCurrRuleset != NULL); \n\n\tCHKiRet(objUse(parser, CORE_COMPONENT));\n\tiRet = parser.FindParser(&pParser, pName);\n\tif(iRet == RS_RET_PARSER_NOT_FOUND) {\n\t\terrmsg.LogError(0, RS_RET_PARSER_NOT_FOUND, \"error: parser '%s' unknown at this time \"\n\t\t\t  \t\"(maybe defined too late in rsyslog.conf?)\", pName);\n\t\tABORT_FINALIZE(RS_RET_NO_CURR_RULESET);\n\t} else if(iRet != RS_RET_OK) {\n\t\terrmsg.LogError(0, iRet, \"error trying to find parser '%s'\\n\", pName);\n\t\tFINALIZE;\n\t}\n\n\tCHKiRet(parser.AddParserToList(&pCurrRuleset->pParserLst, pParser));\n\n\tdbgprintf(\"added parser '%s' to ruleset '%s'\\n\", pName, pCurrRuleset->pszName);\nRUNLOG_VAR(\"%p\", pCurrRuleset->pParserLst);\n\nfinalize_it:\n\td_free(pName); /* no longer needed */\n\n\tRETiRet;\n}\n\n\n/* queryInterface function\n * rgerhards, 2008-02-21\n */\nBEGINobjQueryInterface(ruleset)\nCODESTARTobjQueryInterface(ruleset)\n\tif(pIf->ifVersion != rulesetCURR_IF_VERSION) { /* check for current version, increment on each change */\n\t\tABORT_FINALIZE(RS_RET_INTERFACE_NOT_SUPPORTED);\n\t}\n\n\t/* ok, we have the right interface, so let's fill it\n\t * Please note that we may also do some backwards-compatibility\n\t * work here (if we can support an older interface version - that,\n\t * of course, also affects the \"if\" above).\n\t */\n\tpIf->Construct = rulesetConstruct;\n\tpIf->ConstructFinalize = rulesetConstructFinalize;\n\tpIf->Destruct = rulesetDestruct;\n\tpIf->DebugPrint = rulesetDebugPrint;\n\n\tpIf->IterateAllActions = iterateAllActions;\n\tpIf->DestructAllActions = destructAllActions;\n\tpIf->AddRule = addRule;\n\tpIf->ProcessBatch = processBatch;\n\tpIf->SetName = setName;\n\tpIf->DebugPrintAll = debugPrintAll;\n\tpIf->GetCurrent = GetCurrent;\n\tpIf->GetRuleset = GetRuleset;\n\tpIf->SetDefaultRuleset = SetDefaultRuleset;\n\tpIf->SetCurrRuleset = SetCurrRuleset;\n\tpIf->GetRulesetQueue = GetRulesetQueue;\n\tpIf->GetParserList = GetParserList;\nfinalize_it:\nENDobjQueryInterface(ruleset)\n\n\n/* Exit the ruleset class.\n * rgerhards, 2009-04-06\n */\nBEGINObjClassExit(ruleset, OBJ_IS_CORE_MODULE) /* class, version */\n\tllDestroy(&llRulesets);\n\tobjRelease(errmsg, CORE_COMPONENT);\n\tobjRelease(rule, CORE_COMPONENT);\n\tobjRelease(parser, CORE_COMPONENT);\nENDObjClassExit(ruleset)\n\n\n/* Initialize the ruleset class. Must be called as the very first method\n * before anything else is called inside this class.\n * rgerhards, 2008-02-19\n */\nBEGINObjClassInit(ruleset, 1, OBJ_IS_CORE_MODULE) /* class, version */\n\t/* request objects we use */\n\tCHKiRet(objUse(errmsg, CORE_COMPONENT));\n\tCHKiRet(objUse(rule, CORE_COMPONENT));\n\n\t/* set our own handlers */\n\tOBJSetMethodHandler(objMethod_DEBUGPRINT, rulesetDebugPrint);\n\tOBJSetMethodHandler(objMethod_CONSTRUCTION_FINALIZER, rulesetConstructFinalize);\n\n\t/* prepare global data */\n\tCHKiRet(llInit(&llRulesets, rulesetDestructForLinkedList, keyDestruct, strcasecmp));\n\n\t/* config file handlers */\n\tCHKiRet(regCfSysLineHdlr((uchar *)\"rulesetparser\", 0, eCmdHdlrGetWord, rulesetAddParser, NULL, NULL));\n\tCHKiRet(regCfSysLineHdlr((uchar *)\"rulesetcreatemainqueue\", 0, eCmdHdlrBinary, rulesetCreateQueue, NULL, NULL));\nENDObjClassInit(ruleset)\n\n/* vi:set ai:\n */\n"], "fixing_code": ["---------------------------------------------------------------------------\nVersion 5.7.6  [V5-BETA] (rgerhards), 2011-02-??\n- bugfix: fixed a memory leak and potential abort condition\n  this could happen if multiple rulesets were used and some output batches\n  contained messages belonging to more than one ruleset.\n  fixes: http://bugzilla.adiscon.com/show_bug.cgi?id=226\n  fixes: http://bugzilla.adiscon.com/show_bug.cgi?id=218\n- bugfix: memory leak when $RepeatedMsgReduction on was used\n  bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=225\n---------------------------------------------------------------------------\nVersion 5.7.5  [V5-BETA] (rgerhards), 2011-02-23\n- enhance: imfile did not yet support multiple rulesets, now added\n  we do this directly in the beta because a) it does not affect existing\n  functionality and b) one may argue that this missing functionality is\n  close to a bug.\n- improved testbench, added tests for imuxsock\n- bugfix: imuxsock did no longer sanitize received messages\n  This was a regression from the imuxsock partial rewrite. Happened\n  because the message is no longer run through the standard parsers. \n  bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=224\n- bugfix: minor race condition in action.c - considered cosmetic\n  This is considered cosmetic as multiple threads tried to write exactly\n  the same value into the same memory location without sync. The method\n  has been changed so this can no longer happen.\n---------------------------------------------------------------------------\nVersion 5.7.4  [V5-BETA] (rgerhards), 2011-02-17\n- added pmsnare parser module (written by David Lang)\n- enhanced imfile to support non-cancel input termination\n- improved systemd socket activation thanks to Marius Tomaschweski\n- improved error reporting for $WorkDirectory\n  non-existance and other detectable problems are now reported,\n  and the work directory is NOT set in this case\n- bugfix: pmsnare causded abort under some conditions\n- bugfix: abort if imfile reads file line of more than 64KiB\n  Thanks to Peter Eisentraut for reporting and analysing this problem.\n  bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=221\n- bugfix: queue engine did not properly slow down inputs in FULL_DELAY mode\n  when in disk-assisted mode. This especially affected imfile, which\n  created unnecessarily queue files if a large set of input file data was\n  to process.\n- bugfix: very long running actions could prevent shutdown under some\n  circumstances. This has now been solved, at least for common\n  situations.\n- bugfix: fixed compile problem due to empty structs\n  this occured only on some platforms/compilers. thanks to Dra\u017een Ka\u010dar \n  for the fix\n---------------------------------------------------------------------------\nVersion 5.7.3  [V5-BETA] (rgerhards), 2011-02-07\n- added support for processing multi-line messages in imfile\n- added $IMUDPSchedulingPolicy and $IMUDPSchedulingPriority config settings\n- added $LocalHostName config directive\n- bugfix: fixed build problems on some platforms\n  namely those that have 32bit atomic operations but not 64 bit ones\n- bugfix: local hostname was pulled too-early, so that some config \n  directives (namely FQDN settings) did not have any effect\n- bugfix: imfile did duplicate messages under some circumstances\n- added $OMMySQLConfigFile config directive\n- added $OMMySQLConfigSection config directive\n---------------------------------------------------------------------------\nVersion 5.7.2  [V5-DEVEL] (rgerhards), 2010-11-26\n- bugfix(important): problem in TLS handling could cause rsyslog to loop\n  in a tight loop, effectively disabling functionality and bearing the\n  risk of unresponsiveness of the whole system.\n  Bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=194\n- bugfix: imfile state file was not written when relative file name\n  for it was specified\n- bugfix: compile failed on systems without epoll_create1()\n  Thanks to David Hill for providing a fix.\n- bugfix: atomic increment for msg object may not work correct on all\n  platforms. Thanks to Chris Metcalf for the patch\n- bugfix: replacements for atomic operations for non-int sized types had\n  problems. At least one instance of that problem could potentially lead\n  to abort (inside omfile).\n---------------------------------------------------------------------------\nVersion 5.7.1  [V5-DEVEL] (rgerhards), 2010-10-05\n- support for Hadoop's HDFS added (via omhdfs)\n- imuxsock now optionally use SCM_CREDENTIALS to pull the pid from the log\n  socket itself\n  (thanks to Lennart Poettering for the suggesting this feature)\n- imuxsock now optionally uses per-process input rate limiting, guarding the\n  user against processes spamming the system log\n  (thanks to Lennart Poettering for suggesting this feature)\n- added new config statements\n  * $InputUnixListenSocketUsePIDFromSystem \n  * $SystemLogUsePIDFromSystem \n  * $SystemLogRateLimitInterval\n  * $SystemLogRateLimitBurst\n  * $SystemLogRateLimitSeverity\n  * $IMUxSockRateLimitInterval\n  * $IMUxSockRateLimitBurst\n  * $IMUxSockRateLimitSeverity\n- imuxsock now supports up to 50 different sockets for input\n- some code cleanup in imuxsock (consider this a release a major\n  modification, especially if problems show up)\n- bugfix: /dev/log was unlinked even when passed in from systemd\n  in which case it should be preserved as systemd owns it\n---------------------------------------------------------------------------\nVersion 5.7.0  [V5-DEVEL] (rgerhards), 2010-09-16\n- added module impstat to emit periodic statistics on rsyslog counters\n- support for systemd officially added\n  * acquire /dev/log socket optionally from systemd\n    thanks to Lennart Poettering for this patch\n  * sd-systemd API added as part of rsyslog runtime library\n---------------------------------------------------------------------------\nVersion 5.6.4  [V5-STABLE] (rgerhards), 2011-02-25\n- bugfix: memory leak when $RepeatedMsgReduction on was used\n  bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=225\n---------------------------------------------------------------------------\nVersion 5.6.3  [V5-STABLE] (rgerhards), 2011-01-26\n- bugfix: action processor released memory too early, resulting in\n  potential issue in retry cases (but very unlikely due to another\n  bug, which I also fixed -- only after the fix this problem here\n  became actually visible).\n- bugfix: batch processing flagged invalid message as \"bad\" under some\n  circumstances\n- bugfix: unitialized variable could cause issues under extreme conditions\n  plus some minor nits. This was found after a clang static code analyzer\n  analysis (great tool, and special thanks to Marcin for telling me about\n  it!)\n- bugfix: batches which had actions in error were not properly retried in\n  all cases\n- bugfix: imfile did duplicate messages under some circumstances\n- bugfix: testbench was not activated if no Java was present on system\n  ... what actually was a left-over. Java is no longer required.\n---------------------------------------------------------------------------\nVersion 5.6.2  [V5-STABLE] (rgerhards), 2010-11-30\n- bugfix: compile failed on systems without epoll_create1()\n  Thanks to David Hill for providing a fix.\n- bugfix: atomic increment for msg object may not work correct on all\n  platforms. Thanks to Chris Metcalf for the patch\n- bugfix: replacements for atomic operations for non-int sized types had\n  problems. At least one instance of that problem could potentially lead\n  to abort (inside omfile).\n- added the $InputFilePersistStateInterval config directive to imfile\n- changed imfile so that the state file is never deleted (makes imfile\n  more robust in regard to fatal failures)\n---------------------------------------------------------------------------\nVersion 5.6.1  [V5-STABLE] (rgerhards), 2010-11-24\n- bugfix(important): problem in TLS handling could cause rsyslog to loop\n  in a tight loop, effectively disabling functionality and bearing the\n  risk of unresponsiveness of the whole system.\n  Bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=194\n- permitted imptcp to work on systems which support epoll(), but not\n  epoll_create().\n  Bug: http://bugzilla.adiscon.com/show_bug.cgi?id=204\n  Thanks to Nicholas Brink for reporting this problem.\n- bugfix: testbench failed if imptcp was not enabled\n- bugfix: segfault when an *empty* template was used\n  Bug: http://bugzilla.adiscon.com/show_bug.cgi?id=206\n  Thanks to David Hill for alerting us.\n- bugfix: compile failed with --enable-unlimited-select\n  thanks varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 5.6.0  [V5-STABLE] (rgerhards), 2010-10-19\n\nThis release brings all changes and enhancements of the 5.5.x series\nto the v5-stable branch.\n\n- bugfix: a couple of problems that imfile had on some platforms, namely\n  Ubuntu (not their fault, but occured there)\n- bugfix: imfile utilizes 32 bit to track offset. Most importantly,\n  this problem can not experienced on Fedora 64 bit OS (which has\n  64 bit long's!)\n---------------------------------------------------------------------------\nVersion 5.5.7  [V5-BETA] (rgerhards), 2010-08-09\n- changed omudpspoof default spoof address to simplify typical use case\n  thanks to David Lang for suggesting this\n- doc bugfix: pmlastmsg doc samples had errors\n- bugfix[minor]: pmrfc3164sd had invalid name (resided in rsyslog name \n  space, what should not be the case for a contributed module)\n- added omuxsock, which permits to write message to local Unix sockets\n  this is the counterpart to imuxsock, enabling fast local forwarding\n---------------------------------------------------------------------------\nVersion 5.5.6  [DEVEL] (rgerhards), 2010-07-21\n- added parser modules\n  * pmlastmsg, which supports the notoriously malformed \"last message\n    repeated n times\" messages from some syslogd's (namely sysklogd)\n  * pmrfc3164sd (contributed), supports RFC5424 structured data in \n    RFC3164 messages [untested]\n- added new module type \"string generator\", used to speed up output\n  processing. Expected speedup for (typical) rsyslog processing is\n  roughly 5 to 6 percent compared to using string-based templates.\n  They may also be used to do more complex formatting with custom\n  C code, what provided greater flexibility and probably far higher\n  speed, for example if using multiple regular expressions within a \n  template.\n- added 4 string generators for\n  * RSYSLOG_FileFormat\n  * RSYSLOG_TraditionalFileFormat\n  * RSYSLOG_ForwardFormat\n  * RSYSLOG_TraditionalForwardFormat\n- bugfix: mutexes used to simulate atomic instructions were not destructed\n- bugfix: regression caused more locking action in msg.c than necessary\n- bugfix: \"$ActionExecOnlyWhenPreviousIsSuspended on\" was broken\n- bugfix: segfault on HUP when \"HUPIsRestart\" was set to \"on\"\n  thanks varmojfekoj for the patch\n- bugfix: default for $OMFileFlushOnTXEnd was wrong (\"off\").\n  This, in default mode, caused buffered writing to be used, what\n  means that it looked like no output were written or partial\n  lines. Thanks to Michael Biebl for pointing out this bug.\n- bugfix: programname filter in ! configuration can not be reset\n  Thanks to Kiss Gabor for the patch.\n---------------------------------------------------------------------------\nVersion 5.5.5  [DEVEL] (rgerhards), 2010-05-20\n- added new cancel-reduced action thread termination method\n  We now manage to cancel threads that block inside a retry loop to\n  terminate without the need to cancel the thread. Avoiding cancellation\n  helps keep the system complexity minimal and thus provides for better\n  stability. This also solves some issues with improper shutdown when\n  inside an action retry loop.\n---------------------------------------------------------------------------\nVersion 5.5.4  [DEVEL] (rgerhards), 2010-05-03\n- This version offers full support for Solaris on Intel and Sparc\n- bugfix: problems with atomic operations emulation\n  replaced atomic operation emulation with new code. The previous code\n  seemed to have some issue and also limited concurrency severely. The\n  whole atomic operation emulation has been rewritten.\n- bugfix: netstream ptcp support class was not correctly build on systems\n  without epoll() support\n- bugfix: segfault on Solaris/Sparc\n---------------------------------------------------------------------------\nVersion 5.5.3  [DEVEL] (rgerhards), 2010-04-09\n- added basic but functional support for Solaris\n- imported many bugfixes from 3.6.2/4.6.1 (see ChangeLog below!)\n- added new property replacer option \"date-rfc3164-buggyday\" primarily\n  to ease migration from syslog-ng. See property replacer doc for\n  details.\n- added capability to turn off standard LF delimiter in TCP server\n  via new directive \"$InputTCPServerDisableLFDelimiter on\"\n- bugfix: failed to compile on systems without epoll support\n- bugfix: comment char ('#') in literal terminated script parsing\n  and thus could not be used.\n  but tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=119\n  [merged in from v3.22.2]\n- imported patches from 4.6.0:\n  * improved testbench to contain samples for totally malformed messages\n    which miss parts of the message content\n  * bugfix: some malformed messages could lead to a missing LF inside files\n    or some other missing parts of the template content.\n  * bugfix: if a message ended immediately with a hostname, the hostname\n    was mistakenly interpreted as TAG, and localhost be used as hostname\n---------------------------------------------------------------------------\nVersion 5.5.2  [DEVEL] (rgerhards), 2010-02-05\n- applied patches that make rsyslog compile under Apple OS X.\n  Thanks to trey for providing these.\n- replaced data type \"bool\" by \"sbool\" because this created some\n  portability issues.\n- added $Escape8BitCharactersOnReceive directive\n  Thanks to David Lang for suggesting it.\n- worked around an issue where omfile failed to compile on 32 bit platforms\n  under some circumstances (this smells like a gcc problem, but a simple\n  solution was available). Thanks to Kenneth Marshall for some advice.\n- extended testbench\n---------------------------------------------------------------------------\nVersion 5.5.1  [DEVEL] (rgerhards), 2009-11-27\n- introduced the ablity for netstream drivers to utilize an epoll interface\n  This offers increased performance and removes the select() FDSET size\n  limit from imtcp. Note that we fall back to select() if there is no\n  epoll netstream drivers. So far, an epoll driver has only been\n  implemented for plain tcp syslog, the rest will follow once the code\n  proves well in practice AND there is demand.\n- re-implemented $EscapeControlCharacterTab config directive\n  Based on Jonathan Bond-Caron's patch for v4. This now also includes some\n  automatted tests.\n- bugfix: enabling GSSServer crashes rsyslog startup\n  Thanks to Tomas Kubina for the patch [imgssapi]\n- bugfix (kind of): check if TCP connection is still alive if using TLS\n  Thanks to Jonathan Bond-Caron for the patch.\n---------------------------------------------------------------------------\nVersion 5.5.0  [DEVEL] (rgerhards), 2009-11-18\n- moved DNS resolution code out of imudp and into the backend processing\n  Most importantly, DNS resolution now never happens if the resolved name\n  is not required. Note that this applies to imudp - for the other inputs,\n  DNS resolution almost comes for free, so we do not do it there. However,\n  the new method has been implemented in a generic way and as such may \n  also be used by other modules in the future.\n- added option to use unlimited-size select() calls\n  Thanks to varmjofekoj for the patch\n  This is not done in imudp, as it natively supports epoll().\n- doc: improved description of what loadable modules can do\n---------------------------------------------------------------------------\nVersion 5.4.2  [v5-stable] (rgerhards), 2010-03-??\n- bugfix(kind of): output plugin retry behaviour could cause engine to loop\n  The rsyslog engine did not guard itself against output modules that do\n  not properly convey back the tryResume() behaviour. This then leads to\n  what looks like an endless loop. I consider this to be a bug of the \n  engine not only because it should be hardened against plugin misbehaviour,\n  but also because plugins may not be totally able to avoid this situation\n  (depending on the type of and processing done by the plugin).\n- bugfix: testbench failed when not executed in UTC+1 timezone\n  accidently, the time zone information was kept inside some\n  to-be-checked-for responses\n- temporary bugfix replaced by permanent one for\n  message-induced off-by-one error (potential segfault) (see 4.6.2)\n  The analysis has been completed and a better fix been crafted and \n  integrated.\n- bugfix(minor): status variable was uninitialized\n  However, this would have caused harm only if NO parser modules at\n  all were loaded, which would lead to a defunctional configuration\n  at all. And, even more important, this is impossible as two parser\n  modules are built-in and thus can not be \"not loaded\", so we always\n  have a minimum of two.\n---------------------------------------------------------------------------\nVersion 5.4.1  [v5-stable] (rgerhards), 2010-03-??\n- added new property replacer option \"date-rfc3164-buggyday\" primarily\n  to ease migration from syslog-ng. See property replacer doc for\n  details. [backport from 5.5.3 because urgently needed by some]\n- imported all bugfixes vom 4.6.2 (see below)\n---------------------------------------------------------------------------\nVersion 5.4.0  [v5-stable] (rgerhards), 2010-03-08\n***************************************************************************\n* This is a new stable v5 version. It contains all fixes and enhancements *\n* made during the 5.3.x phase as well as those listed below.              *\n* Note that the 5.2.x series was quite buggy and as such all users are    *\n* strongly advised to upgrade to 5.4.0.                                   *\n***************************************************************************\n- bugfix: omruleset failed to work in many cases\n  bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=179\n  Thanks to Ryan B. Lynch for reporting this issue.\n- bugfix: comment char ('#') in literal terminated script parsing\n  and thus could not be used.\n  but tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=119\n  [merged in from v3.22.2]\n---------------------------------------------------------------------------\nVersion 5.3.7  [BETA] (rgerhards), 2010-01-27\n- bugfix: queues in direct mode could case a segfault, especially if an\n  action failed for action queues. The issue was an invalid increment of\n  a stack-based pointer which lead to destruction of the stack frame and\n  thus a segfault on function return.\n  Thanks to Michael Biebl for alerting us on this problem.\n- bugfix: hostname accidently set to IP address for some message sources,\n  for example imudp. Thanks to Anton for reporting this bug. [imported v4]\n- bugfix: ompgsql had problems with transaction support, what actually \n  rendered it unsuable. Thanks to forum user \"horhe\" for alerting me\n  on this bug and helping to debug/fix it! [imported from 5.3.6]\n- bugfix: $CreateDirs variable not properly initialized, default thus\n  was random (but most often \"on\") [imported from v3]\n- bugfix: potential segfaults during queue shutdown\n  (bugs require certain non-standard settings to appear)\n  Thanks to varmojfekoj for the patch [imported from 4.5.8]\n  [backport from 5.5.2]\n- bugfix: wrong memory assignment for a config variable (probably\n  without causing any harm) [backport from 5.2.2]\n- bugfix: rsyslog hangs when writing to a named pipe which nobody was\n  reading. Thanks to Michael Biebl for reporting this bug.\n  Bugzilla entry: http://bugzilla.adiscon.com/show_bug.cgi?id=169\n  [imported from 4.5.8]\n---------------------------------------------------------------------------\nVersion 5.3.6  [BETA] (rgerhards), 2010-01-13\n- bugfix: ompgsql did not properly check the server connection in\n  tryResume(), which could lead to rsyslog running in a thight loop\n- bugfix: suspension during beginTransaction() was not properly handled\n  by rsyslog core\n- bugfix: omfile output was only written when buffer was full, not at\n  end of transaction\n- bugfix: commit transaction was not properly conveyed to message layer,\n  potentially resulting in non-message destruction and thus hangs\n- bugfix: enabling GSSServer crashes rsyslog startup\n  Thanks to Tomas Kubina for the patch [imgssapi]\n- bugfix (kind of): check if TCP connection is still alive if using TLS\n  Thanks to Jonathan Bond-Caron for the patch.\n- bugfix: $CreateDirs variable not properly initialized, default thus\n  was random (but most often \"on\") [imported from v3]\n- bugfix: ompgsql had problems with transaction support, what actually \n  rendered it unsuable. Thanks to forum user \"horhe\" for alerting me\n  on this bug and helping to debug/fix it!\n- bugfix: memory leak when sending messages in zip-compressed format\n  Thanks to Naoya Nakazawa for analyzing this issue and providing a patch.\n- worked around an issue where omfile failed to compile on 32 bit platforms\n  under some circumstances (this smells like a gcc problem, but a simple\n  solution was available). Thanks to Kenneth Marshall for some advice.\n  [backported from 5.5.x branch]\n---------------------------------------------------------------------------\nVersion 5.3.5  [BETA] (rgerhards), 2009-11-13\n- some light performance enhancement by replacing time() call with much\n  faster (at least under linux) gettimeofday() calls.\n- some improvement of omfile performance with dynafiles\n  saved costly time() calls by employing a logical clock, which is \n  sufficient for the use case\n- bugfix: omudpspoof miscalculated source and destination ports\n  while this was probably not noticed for source ports, it resulted in\n  almost all destination ports being wrong, except for the default port\n  of 514, which by virtue of its binary representation was calculated \n  correct (and probably thus the bug not earlier detected).\n- bugfixes imported from earlier releases\n  * bugfix: named pipes did no longer work (they always got an open error)\n    this was a regression from the omfile rewrite in 4.5.0\n  * bugfix(testbench): sequence check was not always performed correctly,\n    that could result in tests reporting success when they actually failed\n- improved testbench: added tests for UDP forwarding and omudpspoof\n- doc bugfix: omudpspoof had wrong config command names (\"om\" missing)\n- bugfix [imported from 4.4.3]: $ActionExecOnlyOnceEveryInterval did\n  not work.\n- [inport v4] improved testbench, contains now tcp and gzip test cases\n- [import v4] added a so-called \"On Demand Debug\" mode, in which debug\n  output can be generated only after the process has started, but not right\n  from the beginning. This is assumed to be useful for hard-to-find bugs.\n  Also improved the doc on the debug system.\n- bugfix: segfault on startup when -q or -Q option was given\n  [imported from v3-stable]\n---------------------------------------------------------------------------\nVersion 5.3.4  [DEVEL] (rgerhards), 2009-11-04\n- added the ability to create custom message parsers\n- added $RulesetParser config directive that permits to bind specific\n  parsers to specific rulesets\n- added omruleset output module, which provides great flexibility in \n  action processing. THIS IS A VERY IMPORTANT ADDITION, see its doc\n  for why.\n- added the capability to have ruleset-specific main message queues\n  This offers considerable additional flexibility AND superior performance\n  (in cases where multiple inputs now can avoid lock contention)\n- bugfix: correct default for escape ('#') character restored\n  This was accidently changed to '\\\\', thanks to David Lang for reporting\n- bugfix(testbench): testcase did not properly wait for rsyslogd shutdown\n  thus some unpredictable behavior and a false negative test result\n  could occur.\n---------------------------------------------------------------------------\nVersion 5.3.3  [DEVEL] (rgerhards), 2009-10-27\n- simplified and thus speeded up the queue engine, also fixed some\n  potential race conditions (in very unusual shutdown conditions)\n  along the way. The threading model has seriously changes, so there may\n  be some regressions.\n- enhanced test environment (inlcuding testbench): support for enhancing\n  probability of memory addressing failure by using non-NULL default\n  value for malloced memory (optional, only if requested by configure\n  option). This helps to track down some otherwise undetected issues\n  within the testbench.\n- bugfix: potential abort if inputname property was not set \n  primarily a problem of imdiag\n- bugfix: message processing states were not set correctly in all cases\n  however, this had no negative effect, as the message processing state\n  was not evaluated when a batch was deleted, and that was the only case\n  where the state could be wrong.\n---------------------------------------------------------------------------\nVersion 5.3.2  [DEVEL] (rgerhards), 2009-10-21\n- enhanced omfile to support transactional interface. This will increase\n  performance in many cases.\n- added multi-ruleset support to imudp\n- re-enabled input thread termination handling that does avoid thread\n  cancellation where possible. This provides a more reliable mode of\n  rsyslogd termination (canceling threads my result in not properly\n  freed resouces and potential later hangs, even though we perform\n  proper cancel handling in our code). This is part of an effort to\n  reduce thread cancellation as much as possible in rsyslog.\n  NOTE: the code previously written code for this functionality had a\n  subtle race condition. The new code solves that.\n- enhanced immark to support non-cancel input module termination\n- improved imudp so that epoll can be used in more environments,\n  fixed potential compile time problem if EPOLL_CLOEXEC is not available.\n- some cleanup/slight improvement:\n  * changed imuxsock to no longer use deprecated submitAndParseMsg() IF\n  * changed submitAndParseMsg() interface to be a wrapper around the new\n    way of message creation/submission. This enables older plugins to be\n    used together with the new interface. The removal also enables us to\n    drop a lot of duplicate code, reducing complexity and increasing\n    maintainability.\n- bugfix: segfault when starting up with an invalid .qi file for a disk queue\n  Failed for both pure disk as well as DA queues. Now, we emit an error\n  message and disable disk queueing facility.\n- bugfix: potential segfault on messages with empty MSG part. This was a\n  recently introduced regression.\n- bugfix: debug string larger than 1K were improperly displayed. Max size\n  is now 32K, and if a string is even longer it is meaningfully truncated.\n---------------------------------------------------------------------------\nVersion 5.3.1  [DEVEL] (rgerhards), 2009-10-05\n- added $AbortOnUncleanConfig directive - permits to prevent startup when\n  there are problems with the configuration file. See it's doc for\n  details.\n- included some important fixes from v4-stable:\n  * bugfix: invalid handling of zero-sized messages\n  * bugfix: zero-sized UDP messages are no longer processed\n  * bugfix: random data could be appended to message\n  * bugfix: reverse lookup reduction logic in imudp do DNS queries too often\n- bugfixes imported from 4.5.4:\n  * bugfix: potential segfault in stream writer on destruction\n  * bugfix: potential race in object loader (obj.c) during use/release\n  * bugfixes: potential problems in out file zip writer\n---------------------------------------------------------------------------\nVersion 5.3.0  [DEVEL] (rgerhards), 2009-09-14\n- begun to add simple GUI programs to gain insight into running rsyslogd\n  instances and help setup and troubleshooting (active via the\n  --enable-gui ./configure switch)\n- changed imudp to utilize epoll(), where available. This shall provide\n  slightly better performance (just slightly because we called select()\n  rather infrequently on a busy system)\n---------------------------------------------------------------------------\nVersion 5.2.2  [v5-stable] (rgerhards), 2009-11-??\n- bugfix: enabling GSSServer crashes rsyslog startup\n  Thanks to Tomas Kubina for the patch [imgssapi]\n---------------------------------------------------------------------------\nVersion 5.2.1  [v5-stable] (rgerhards), 2009-11-02\n- bugfix [imported from 4.4.3]: $ActionExecOnlyOnceEveryInterval did\n  not work.\n- bugfix: segfault on startup when -q or -Q option was given\n  [imported from v3-stable]\n---------------------------------------------------------------------------\nVersion 5.2.0  [v5-stable] (rgerhards), 2009-11-02\nThis is a re-release of version 5.1.6 as stable after we did not get any bug \nreports during the whole beta phase. Still, this first v5-stable may not be \nas stable as one hopes for, I am not sure if we did not get bug reports\njust because nobody tried it. Anyhow, we need to go forward and so we\nhave the initial v5-stable.\n---------------------------------------------------------------------------\nVersion 5.1.6  [v5-beta] (rgerhards), 2009-10-15\n- feature imports from v4.5.6\n- bugfix: potential race condition when queue worker threads were\n  terminated\n- bugfix: solved potential (temporary) stall of messages when the queue was\n  almost empty and few new data added (caused testbench to sometimes hang!)\n- fixed some race condition in testbench\n- added more elaborate diagnostics to parts of the testbench\n- bugfixes imported from 4.5.4:\n  * bugfix: potential segfault in stream writer on destruction\n  * bugfix: potential race in object loader (obj.c) during use/release\n  * bugfixes: potential problems in out file zip writer\n- included some important fixes from 4.4.2:\n  * bugfix: invalid handling of zero-sized messages\n  * bugfix: zero-sized UDP messages are no longer processed\n  * bugfix: random data could be appended to message\n  * bugfix: reverse lookup reduction logic in imudp do DNS queries too often\n---------------------------------------------------------------------------\nVersion 5.1.5  [v5-beta] (rgerhards), 2009-09-11\n- added new config option $ActionWriteAllMarkMessages\n  this option permites to process mark messages under all circumstances,\n  even if an action was recently called. This can be useful to use mark\n  messages as a kind of heartbeat.\n- added new config option $InputUnixListenSocketCreatePath\n  to permit the auto-creation of pathes to additional log sockets. This\n  turns out to be useful if they reside on temporary file systems and\n  rsyslogd starts up before the daemons that create these sockets\n  (rsyslogd always creates the socket itself if it does not exist).\n- added $LogRSyslogStatusMessages configuration directive\n  permitting to turn off rsyslog start/stop/HUP messages. See Debian\n  ticket http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=463793\n- bugfix: hostnames with dashes in them were incorrectly treated as\n  malformed, thus causing them to be treated as TAG (this was a regression\n  introduced from the \"rfc3164 strict\" change in 4.5.0). Testbench has been\n  updated to include a smaple message with a hostname containing a dash.\n- bugfix: strings improperly reused, resulting in some message properties\n  be populated with strings from previous messages. This was caused by\n  an improper predicate check.\n- added new config directive $omfileForceChown [import from 4.7.0]\n---------------------------------------------------------------------------\nVersion 5.1.4  [DEVEL] (rgerhards), 2009-08-20\n- legacy syslog parser changed so that it now accepts date stamps in\n  wrong case. Some devices seem to create them and I do not see any harm\n  in supporting that.\n- added $InputTCPMaxListeners directive - permits to specify how many \n  TCP servers shall be possible (default is 20).\n- bugfix: memory leak with some input modules. Those inputs that\n  use parseAndSubmitMsg() leak two small memory blocks with every message.\n  Typically, those process only relatively few messages, so the issue \n  does most probably not have any effect in practice.\n- bugfix: if tcp listen port could not be created, no error message was\n  emitted\n- bugfix: discard action did not work (did not discard messages)\n- bugfix: discard action caused segfault\n- bugfix: potential segfault in output file writer (omfile)\n  In async write mode, we use modular arithmetic to index the output\n  buffer array. However, the counter variables accidently were signed,\n  thus resulting in negative indizes after integer overflow. That in turn\n  could lead to segfaults, but was depending on the memory layout of \n  the instance in question (which in turn depended on a number of\n  variables, like compile settings but also configuration). The counters\n  are now unsigned (as they always should have been) and so the dangling\n  mis-indexing does no longer happen. This bug potentially affected all\n  installations, even if only some may actually have seen a segfault.\n---------------------------------------------------------------------------\nVersion 5.1.3  [DEVEL] (rgerhards), 2009-07-28\n- architecture change: queue now always has at least one worker thread\n  if not running in direct mode. Previous versions could run without \n  any active workers. This simplifies the code at a very small expense.\n  See v5 compatibility note document for more in-depth discussion.\n- enhance: UDP spoofing supported via new output module omudpspoof\n  See the omudpspoof documentation for details and samples\n- bugfix: message could be truncated after TAG, often when forwarding\n  This was a result of an internal processing error if maximum field\n  sizes had been specified in the property replacer.\n- bugfix: minor static memory leak while reading configuration\n  did NOT leak based on message volume\n- internal: added ability to terminate input modules not via pthread_cancel\n  but an alternate approach via pthread_kill. This is somewhat safer as we\n  do not need to think about the cancel-safeness of all libraries we use.\n  However, not all inputs can easily supported, so this now is a feature\n  that can be requested by the input module (the most important ones\n  request it).\n---------------------------------------------------------------------------\nVersion 5.1.2  [DEVEL] (rgerhards), 2009-07-08\n- bugfix: properties inputname, fromhost, fromhost-ip, msg were lost when\n  working with disk queues\n- some performance enhancements\n- bugfix: abort condition when RecvFrom was not set and message reduction\n  was on. Happend e.g. with imuxsock.\n- added $klogConsoleLogLevel directive which permits to set a new\n  console log level while rsyslog is active\n- some internal code cleanup\n---------------------------------------------------------------------------\nVersion 5.1.1  [DEVEL] (rgerhards), 2009-07-03\n- bugfix: huge memory leak in queue engine (made rsyslogd unusable in\n  production). Occured if at least one queue was in direct mode \n  (the default for action queues)\n- imported many performance optimizations from v4-devel (4.5.0)\n- bugfix: subtle (and usually irrelevant) issue in timout processing\n  timeout could be one second too early if nanoseconds wrapped\n- set a more sensible timeout for shutdow, now 1.5 seconds to complete\n  processing (this also removes those cases where the shutdown message\n  was not written because the termination happened before it)\n---------------------------------------------------------------------------\nVersion 5.1.0  [DEVEL] (rgerhards), 2009-05-29\n\n*********************************** NOTE **********************************\nThe v5 versions of rsyslog feature a greatly redesigned queue engine. The\nmajor theme for the v5 release is twofold:\n\na) greatly improved performance\nb) enable audit-grade processing\n\nHere, audit-grade processing means that rsyslog, if used together with\naudit-grade transports and configured correctly, will never lose messages\nthat already have been acknowledged, not even in fatal failure cases like\nsudden loss of power.\n\nNote that large parts of rsyslog's important core components have been\nrestructured to support these design goals. As such, early versions of\nthe engine will probably be less stable than the v3/v4 engine.\n\nAlso note that the initial versions do not cover all and everything. As\nusual, the code will evolve toward the final goal as version numbers\nincrease.\n*********************************** NOTE **********************************\n\n- redesigned queue engine so that it supports ultra-reliable operations\n  This resulted in a rewrite of large parts. The new capability can be\n  used to build audit-grade systems on the basis of rsyslog.\n- added $MainMsgQueueDequeueBatchSize and $ActionQueueDequeueBatchSize \n  configuration directives\n- implemented a new transactional output module interface which provides\n  superior performance (for databases potentially far superior performance)\n- increased ompgsql performance by adapting to new transactional\n  output module interface\n---------------------------------------------------------------------------\nVersion 4.7.3  [v4-devel] (rgerhards), 2010-11-25\n- added omuxsock, which permits to write message to local Unix sockets\n  this is the counterpart to imuxsock, enabling fast local forwarding\n- added imptcp, a simplified, Linux-specific and potentielly fast\n  syslog plain tcp input plugin (NOT supporting TLS!)\n- bugfix: a couple of problems that imfile had on some platforms, namely\n  Ubuntu (not their fault, but occured there)\n- bugfix: imfile utilizes 32 bit to track offset. Most importantly,\n  this problem can not experienced on Fedora 64 bit OS (which has\n  64 bit long's!)\n- added the $InputFilePersistStateInterval config directive to imfile\n- changed imfile so that the state file is never deleted (makes imfile\n  more robust in regard to fatal failures)\n---------------------------------------------------------------------------\nVersion 4.7.2  [v4-devel] (rgerhards), 2010-05-03\n- bugfix: problems with atomic operations emulaton\n  replaced atomic operation emulation with new code. The previous code\n  seemed to have some issue and also limited concurrency severely. The\n  whole atomic operation emulation has been rewritten.\n- added new $Sleep directive to hold processing for a couple of seconds\n  during startup\n- bugfix: programname filter in ! configuration can not be reset\n  Thanks to Kiss Gabor for the patch.\n---------------------------------------------------------------------------\nVersion 4.7.1  [v4-devel] (rgerhards), 2010-04-22\n- Solaris support much improved -- was not truely usable in 4.7.0\n  Solaris is no longer supported in imklog, but rather there is a new\n  plugin imsolaris, which is used to pull local log sources on a Solaris\n  machine.\n- testbench improvement: Java is no longer needed for testing tool creation\n---------------------------------------------------------------------------\nVersion 4.7.0  [v4-devel] (rgerhards), 2010-04-14\n- new: support for Solaris added (but not yet the Solaris door API)\n- added function getenv() to RainerScript\n- added new config option $InputUnixListenSocketCreatePath\n  to permit the auto-creation of pathes to additional log sockets. This\n  turns out to be useful if they reside on temporary file systems and\n  rsyslogd starts up before the daemons that create these sockets\n  (rsyslogd always creates the socket itself if it does not exist).\n- added $LogRSyslogStatusMessages configuration directive\n  permitting to turn off rsyslog start/stop/HUP messages. See Debian\n  ticket http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=463793\n- added new config directive $omfileForceChown to (try to) fix some broken\n  system configs.\n  See ticket for details: http://bugzilla.adiscon.com/show_bug.cgi?id=150\n- added $EscapeControlCharacterTab config directive\n  Thanks to Jonathan Bond-Caron for the patch.\n- added option to use unlimited-size select() calls\n  Thanks to varmjofekoj for the patch\n- debugondemand mode caused backgrounding to fail - close to a bug, but I'd\n  consider the ability to background in this mode a new feature...\n- bugfix (kind of): check if TCP connection is still alive if using TLS\n  Thanks to Jonathan Bond-Caron for the patch.\n- imported changes from 4.5.7 and below\n- bugfix: potential segfault when -p command line option was used\n  Thanks for varmojfekoj for pointing me at this bug.\n- imported changes from 4.5.6 and below\n---------------------------------------------------------------------------\nVersion 4.6.6  [v4-stable] (rgerhards), 2010-11-??\n- bugfix: imfile potentially duplicates lines\n  This can happen when 0 bytes are read from the input file, and some\n  writer appends data to the file BEFORE we check if a rollover happens.\n  The check for rollover uses the inode and size as a criterion. So far,\n  we checked for equality of sizes, which is not given in this scenario,\n  but that does not indicate a rollover. From the source code comments:\n     Note that when we check the size, we MUST NOT check for equality.\n     The reason is that the file may have been written right after we\n     did try to read (so the file size has increased). That is NOT in\n     indicator of a rollover (this is an actual bug scenario we \n     experienced). So we need to check if the new size is smaller than\n     what we already have seen!\n  Also, under some circumstances an invalid truncation was detected. This\n  code has now been removed, a file change (and thus resent) is only\n  detected if the inode number changes.\n- bugfix: a couple of problems that imfile had on some platforms, namely\n  Ubuntu (not their fault, but occured there)\n- bugfix: imfile utilizes 32 bit to track offset. Most importantly,\n  this problem can not experienced on Fedora 64 bit OS (which has\n  64 bit long's!)\n- some improvements thanks to clang's static code analyzer\n  o overall cleanup (mostly unnecessary writes and otherwise unused stuff)\n  o bugfix: fixed a very remote problem in msg.c which could occur when\n    running under extremely low memory conditions\n---------------------------------------------------------------------------\nVersion 4.6.5  [v4-stable] (rgerhards), 2010-11-24\n- bugfix(important): problem in TLS handling could cause rsyslog to loop\n  in a tight loop, effectively disabling functionality and bearing the\n  risk of unresponsiveness of the whole system.\n  Bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=194\n---------------------------------------------------------------------------\nVersion 4.6.4  [v4-stable] (rgerhards), 2010-08-05\n- bugfix: zero-sized (empty) messages were processed by imtcp\n  they are now dropped as they always should have been\n- bugfix: programname filter in ! configuration can not be reset\n  Thanks to Kiss Gabor for the patch.\n---------------------------------------------------------------------------\nVersion 4.6.3  [v4-stable] (rgerhards), 2010-07-07\n- improvded testbench\n  - added test with truly random data received via syslog to test\n    robustness\n  - added new configure option that permits to disable and enable an\n    extended testbench\n- bugfix: segfault on HUP when \"HUPIsRestart\" was set to \"on\"\n  thanks varmojfekoj for the patch\n- bugfix: default for $OMFileFlushOnTXEnd was wrong (\"off\").\n  This, in default mode, caused buffered writing to be used, what\n  means that it looked like no output were written or partial\n  lines. Thanks to Michael Biebl for pointing out this bug.\n- bugfix: testbench failed when not executed in UTC+1 timezone\n  accidently, the time zone information was kept inside some\n  to-be-checked-for responses\n- temporary bugfix replaced by permanent one for\n  message-induced off-by-one error (potential segfault) (see 4.6.2)\n  The analysis has been completed and a better fix been crafted and \n  integrated.\n- bugfix: the T/P/E config size specifiers did not work properly under\n  all 32-bit platforms\n- bugfix: local unix system log socket was deleted even when it was\n  not configured\n- some doc fixes; incorrect config samples could cause confusion\n  thanks to Anthony Edwards for pointing the problems out\n---------------------------------------------------------------------------\nVersion 4.6.2  [v4-stable] (rgerhards), 2010-03-26\n- new feature: \".\" action type added to support writing files to relative\n  pathes (this is primarily meant as a debug aid)\n- added replacements for atomic instructions on systems that do not\n  support them. [backport of Stefen Sledz' patch for v5)\n- new feature: $OMFileAsyncWriting directive added\n  it permits to specifiy if asynchronous writing should be done or not\n- bugfix(temporary): message-induced off-by-one error (potential segfault)\n  Some types of malformed messages could trigger an off-by-one error\n  (for example, \\0 or \\n as the last character, and generally control\n  character escaption is questionable). This is due to not strictly\n  following a the \\0 or string counted string paradigm (during the last\n  optimization on the cstring class). As a temporary fix, we have \n  introduced a proper recalculation of the size. However, a final\n  patch is expected in the future. See bug tracker for further details\n  and when the final patch will be available:\n  http://bugzilla.adiscon.com/show_bug.cgi?id=184\n  Note that the current patch is considered sufficient to solve the\n  situation, but it requires a bit more runtime than desirable.\n- bugfix: potential segfault in dynafile cache\n  This bug was triggered by an open failure. The the cache was full and\n  a new entry needed to be placed inside it, a victim for eviction was\n  selected. That victim was freed, then the open of the new file tried. If\n  the open failed, the victim entry was still freed, and the function\n  exited. However, on next invocation and cache search, the victim entry\n  was used as if it were populated, most probably resulting in a segfault.\n- bugfix: race condition during directory creation\n  If multiple files try to create a directory at (almost) the same time,\n  some of them may fail. This is a data race and also exists with other\n  processes that may create the same directory. We do now check for this\n  condition and gracefully handle it.\n- bugfix: potential re-use of free()ed file stream object in omfile\n  when dynaCache is enabled, the cache is full, a new entry needs to\n  be allocated, thus the LRU discarded, then a new entry is opend and that\n  fails. In that case, it looks like the discarded stream may be reused\n  improperly (based on code analysis, test case and confirmation pending)\n- added new property replacer option \"date-rfc3164-buggyday\" primarily\n  to ease migration from syslog-ng. See property replacer doc for\n  details. [backport from 5.5.3 because urgently needed by some]\n- improved testbench\n- bugfix: invalid buffer write in (file) stream class\n  currently being accessed buffer could be overwritten with new data.\n  While this probably did not cause access violations, it could case loss\n  and/or duplication of some data (definitely a race with no deterministic\n  outcome)\n- bugfix: potential hang condition during filestream close\n  predicate was not properly checked when waiting for the background file\n  writer\n- bugfix: improper synchronization when \"$OMFileFlushOnTXEnd on\" was used\n  Internal data structures were not properly protected due to missing\n  mutex calls.\n- bugfix: potential data loss during file stream shutdown\n- bugfix: potential problems during file stream shutdown\n  The shutdown/close sequence was not clean, what potentially (but\n  unlikely) could lead to some issues. We have not been able to describe\n  any fatal cases, but there was some bug potential. Sequence has now\n  been straighted out.\n- bugfix: potential problem (loop, abort) when file write error occured\n  When a write error occured in stream.c, variable iWritten had the error\n  code but this was handled as if it were the actual number of bytes\n  written. That was used in pointer arithmetic later on, and thus could\n  lead to all sorts of problems. However, this could only happen if the\n  error was EINTR or the file in question was a tty. All other cases were\n  handled properly. Now, iWritten is reset to zero in such cases, resulting\n  in proper retries.\n- bugfix: $omfileFlushOnTXEnd was turned on when set to off and vice\n  versa due to an invalid check\n- bugfix: recent patch to fix small memory leak could cause invalid free.\n  This could only happen during config file parsing.\n- bugfix(minor): handling of extremely large strings in dbgprintf() fixed\n  Previously, it could lead to garbagge output and, in extreme cases, also\n  to segfaults. Note: this was a problem only when debug output was \n  actually enabled, so it caused no problem in production use.\n- bugfix(minor): BSD_SO_COMPAT query function had some global vars not\n  properly initialized. However, in practice the loader initializes them \n  with zero, the desired value, so there were no actual issue in almost \n  all cases.\n---------------------------------------------------------------------------\nVersion 4.6.1  [v4-stable] (rgerhards), 2010-03-04\n- re-enabled old pipe output (using new module ompipe, built-in) after\n  some problems with pipes (and especially in regard to xconsole) were\n  discovered. Thanks to Michael Biebl for reporting the issues.\n- bugfix: potential problems with large file support could cause segfault\n  ... and other weird problems. This seemed to affect 32bit-platforms\n  only, but I can not totally outrule there were issues on other\n  platforms as well. The previous code could cause system data types\n  to be defined inconsistently, and that could lead to various \n  troubles. Special thanks go to the Mandriva team for identifying\n  an initial problem, help discussing it and ultimately a fix they\n  contributed.\n- bugfix: fixed problem that caused compilation on FreeBSD 9.0 to fail.\n  bugtracker: http://bugzilla.adiscon.com/show_bug.cgi?id=181\n  Thanks to Christiano for reporting.\n- bugfix: potential segfault in omfile when a dynafile open failed\n  In that case, a partial cache entry was written, and some internal\n  pointers (iCurrElt) not correctly updated. In the next iteration, that\n  could lead to a segfault, especially if iCurrElt then points to the\n  then-partial record. Not very likely, but could happen in practice.\n- bugfix (theoretical): potential segfault in omfile under low memory\n  condition. This is only a theoretical bug, because it would only \n  happen when strdup() fails to allocate memory - which is highly \n  unlikely and will probably lead to all other sorts of errors.\n- bugfix: comment char ('#') in literal terminated script parsing\n  and thus could not be used.\n  but tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=119\n  [merged in from v3.22.2]\n---------------------------------------------------------------------------\nVersion 4.6.0  [v4-stable] (rgerhards), 2010-02-24\n***************************************************************************\n* This is a new stable v4 version. It contains all fixes and enhancements *\n* made during the 4.5.x phase as well as those listed below.              *\n* Note: this version is scheduled to conclude the v4 development process. *\n*       Do not expect any more new developments in v4. The focus is now   *\n*       on v5 (what also means we have a single devel branch again).      *\n*       (\"development\" means new feature development, bug fixes are of    *\n*       course provided for v4-stable)                                    *\n***************************************************************************\n- improved testbench to contain samples for totally malformed messages\n  which miss parts of the message content\n- bugfix: some malformed messages could lead to a missing LF inside files\n  or some other missing parts of the template content.\n- bugfix: if a message ended immediately with a hostname, the hostname\n  was mistakenly interpreted as TAG, and localhost be used as hostname\n- bugfix: message without MSG part could case a segfault\n  [backported from v5 commit 98d1ed504ec001728955a5bcd7916f64cd85f39f]\n  This actually was a \"recent\" regression, but I did not realize that it\n  was introduced by the performance optimization in v4-devel. Shame on\n  me for having two devel versions at the same time...\n---------------------------------------------------------------------------\nVersion 4.5.8  [v4-beta] (rgerhards), 2010-02-10\n- enhanced doc for using PostgreSQL\n  Thanks to Marc Schiffbauer for the new/updated doc\n- bugfix: property replacer returned invalid parameters under some (unusual)\n  conditions. In extreme cases, this could lead to garbled logs and/or\n  a system failure.\n- bugfix: invalid length returned (often) when using regular expressions\n  inside the property replacer\n- bugfix: submatch regex in property replacer did not honor \"return 0 on\n  no match\" config case\n- bugfix: imuxsock incorrectly stated inputname \"imudp\"\n  Thanks to Ryan Lynch for reporting this.\n- (slightly) enhanced support for FreeBSD by setting _PATH_MODDIR to\n  the correct value on FreeBSD.\n  Thanks to Cristiano for the patch.\n- bugfix: -d did not enable display of debug messages\n  regression from introduction of \"debug on demand\" mode\n  Thanks to Michael Biebl for reporting this bug\n- bugfix: blanks inside file names did not terminate file name parsing.\n  This could reslult in the whole rest of a line (including comments)\n  to be treated as file name in \"write to file\" actions.\n  Thanks to Jack for reporting this issue.\n- bugfix: rsyslog hang when writing to a named pipe which nobody was\n  reading. Thanks to Michael Biebl for reporting this bug.\n  Bugzilla entry: http://bugzilla.adiscon.com/show_bug.cgi?id=169\n- bugfix: potential segfaults during queue shutdown\n  (bugs require certain non-standard settings to appear)\n  Thanks to varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 4.5.7  [v4-beta] (rgerhards), 2009-11-18\n- added a so-called \"On Demand Debug\" mode, in which debug output can\n  be generated only after the process has started, but not right from\n  the beginning. This is assumed to be useful for hard-to-find bugs.\n  Also improved the doc on the debug system.\n- bugfix (kind of): check if TCP connection is still alive if using TLS\n  Thanks to Jonathan Bond-Caron for the patch.\n- bugfix: hostname accidently set to IP address for some message sources,\n  for example imudp. Thanks to Anton for reporting this bug.\n- bugfix [imported from 4.4.3]: $ActionExecOnlyOnceEveryInterval did\n  not work.\n---------------------------------------------------------------------------\nVersion 4.5.6  [v4-beta] (rgerhards), 2009-11-05\n- bugfix: named pipes did no longer work (they always got an open error)\n  this was a regression from the omfile rewrite in 4.5.0\n- bugfix(minor): diag function returned wrong queue memeber count\n  for the main queue if an active DA queue existed. This had no relevance\n  to real deployments (assuming they are not running the debug/diagnostic\n  module...), but sometimes caused grief and false alerts in the \n  testbench.\n- included some important fixes from v4-stable:\n  * bugfix: invalid handling of zero-sized messages\n  * bugfix: zero-sized UDP messages are no longer processed\n  * bugfix: random data could be appended to message\n  * bugfix: reverse lookup reduction logic in imudp do DNS queries too often\n- bugfix(testbench): testcase did not properly wait for rsyslod shutdown\n  thus some unpredictable behavior and a false negative test result\n  could occur. [BACKPORTED from v5]\n- bugfix(testbench): sequence check was not always performed correctly,\n  that could result in tests reporting success when they actually failed\n---------------------------------------------------------------------------\nVersion 4.5.5  [v4-beta] (rgerhards), 2009-10-21\n- added $InputTCPServerNotifyOnConnectionClose config directive\n  see doc for details\n- bugfix: debug string larger than 1K were improperly displayed. Max size\n  is now 32K\n- bugfix: invalid storage class selected for some size config parameters.\n  This resulted in wrong values. The most prominent victim was the\n  directory creation mode, which was set to zero in some cases. For \n  details, see related blog post:\n  http://blog.gerhards.net/2009/10/another-note-on-hard-to-find-bugs.html\n---------------------------------------------------------------------------\nVersion 4.5.4  [v4-beta] (rgerhards), 2009-09-29\n- bugfix: potential segfault in stream writer on destruction\n  Most severely affected omfile. The problem was that some buffers were\n  freed before the asynchronous writer thread was shut down. So the\n  writer thread accessed invalid data, which may even already be\n  overwritten. Symptoms (with omfile) were segfaults, grabled data\n  and files with random names placed around the file system (most\n  prominently into the root directory). Special thanks to Aaron for\n  helping to track this down.\n- bugfix: potential race in object loader (obj.c) during use/release\n  of object interface\n- bugfixes: potential problems in out file zip writer. Problems could\n  lead to abort and/or memory leak. The module is now hardened in a very\n  conservative way, which is sub-optimal from a performance point of view.\n  This should be improved if it has proven reliable in practice.\n---------------------------------------------------------------------------\nVersion 4.5.3  [v4-beta] (rgerhards), 2009-09-17\n- bugfix: repeated messages were incorrectly processed\n  this could lead to loss of the repeated message content. As a side-\n  effect, it could probably also be possible that some segfault occurs\n  (quite unlikely). The root cause was that some counters introduced\n  during the malloc optimizations were not properly duplicated in\n  MsgDup(). Note that repeated message processing is not enabled\n  by default.\n- bugfix: message sanitation had some issues:\n  - control character DEL was not properly escaped\n  - NUL and LF characters were not properly stripped if no control\n    character replacement was to be done\n  - NUL characters in the message body were silently dropped (this was\n    a regeression introduced by some of the recent optimizations)\n- bugfix: strings improperly reused, resulting in some message properties\n  be populated with strings from previous messages. This was caused by\n  an improper predicate check. [backported from v5]\n- fixed some minor portability issues\n- bugfix: reverse lookup reduction logic in imudp do DNS queries too often\n  [imported from 4.4.2]\n---------------------------------------------------------------------------\nVersion 4.5.2  [v4-beta] (rgerhards), 2009-08-21\n- legacy syslog parser changed so that it now accepts date stamps in\n  wrong case. Some devices seem to create them and I do not see any harm\n  in supporting that.\n- added $InputTCPMaxListeners directive - permits to specify how many \n  TCP servers shall be possible (default is 20).\n- bugfix: memory leak with some input modules. Those inputs that\n  use parseAndSubmitMsg() leak two small memory blocks with every message.\n  Typically, those process only relatively few messages, so the issue \n  does most probably not have any effect in practice.\n- bugfix: if tcp listen port could not be created, no error message was\n  emitted\n- bugfix: potential segfault in output file writer (omfile)\n  In async write mode, we use modular arithmetic to index the output\n  buffer array. However, the counter variables accidently were signed,\n  thus resulting in negative indizes after integer overflow. That in turn\n  could lead to segfaults, but was depending on the memory layout of \n  the instance in question (which in turn depended on a number of\n  variables, like compile settings but also configuration). The counters\n  are now unsigned (as they always should have been) and so the dangling\n  mis-indexing does no longer happen. This bug potentially affected all\n  installations, even if only some may actually have seen a segfault.\n- bugfix: hostnames with dashes in them were incorrectly treated as\n  malformed, thus causing them to be treated as TAG (this was a regression\n  introduced from the \"rfc3164 strict\" change in 4.5.0).\n---------------------------------------------------------------------------\nVersion 4.5.1  [DEVEL] (rgerhards), 2009-07-15\n- CONFIG CHANGE: $HUPisRestart default is now \"off\". We are doing this\n  to support removal of restart-type HUP in v5.\n- bugfix: fromhost-ip was sometimes truncated\n- bugfix: potential segfault when zip-compressed syslog records were\n  received (double free)\n- bugfix: properties inputname, fromhost, fromhost-ip, msg were lost when\n  working with disk queues\n- performance enhancement: much faster, up to twice as fast (depending\n  on configuration)\n- bugfix: abort condition when RecvFrom was not set and message reduction\n  was on. Happend e.g. with imuxsock.\n- added $klogConsoleLogLevel directive which permits to set a new\n  console log level while rsyslog is active\n- bugfix: message could be truncated after TAG, often when forwarding\n  This was a result of an internal processing error if maximum field\n  sizes had been specified in the property replacer.\n- added ability for the TCP output action to \"rebind\" its send socket after\n  sending n messages (actually, it re-opens the connection, the name is \n  used because this is a concept very similiar to $ActionUDPRebindInterval).\n  New config directive $ActionSendTCPRebindInterval added for the purpose.\n  By default, rebinding is disabled. This is considered useful for load\n  balancers.\n- testbench improvements\n---------------------------------------------------------------------------\nVersion 4.5.0  [DEVEL] (rgerhards), 2009-07-02\n- activation order of inputs changed, they are now activated only after\n  privileges are dropped. Thanks to Michael Terry for the patch.\n- greatly improved performance\n- greatly reduced memory requirements of msg object\n  to around half of the previous demand. This means that more messages can\n  be stored in core! Due to fewer cache misses, this also means some\n  performance improvement.\n- improved config error messages: now contain a copy of the config line\n  that (most likely) caused the error\n- reduced max value for $DynaFileCacheSize to 1,000 (the former maximum\n  of 10,000 really made no sense, even 1,000 is very high, but we like\n  to keep the user in control ;)).\n- added capability to fsync() queue disk files for enhanced reliability\n  (also add's speed, because you do no longer need to run the whole file\n  system in sync mode)\n- more strict parsing of the hostname in rfc3164 mode, hopefully\n  removes false positives (but may cause some trouble with hostname\n  parsing). For details, see this bug tracker:\n  http://bugzilla.adiscon.com/show_bug.cgi?id=126\n- omfile rewrite to natively support zip files (includes large extension\n  of the stream class)\n- added configuration commands (see doc for explanations)\n  * $OMFileZipLevel\n  * $OMFileIOBufferSize\n  * $OMFileFlushOnTXEnd\n  * $MainMsgQueueSyncQueueFiles\n  * $ActionQueueSyncQueueFiles\n- done some memory accesses explicitely atomic\n- bugfix: subtle (and usually irrelevant) issue in timout processing\n  timeout could be one second too early if nanoseconds wrapped\n- set a more sensible timeout for shutdow, now 1.5 seconds to complete\n  processing (this also removes those cases where the shutdown message\n  was not written because the termination happened before it)\n- internal bugfix: object pointer was only reset to NULL when an object\n  was actually destructed. This most likely had no effect to existing code,\n  but it may also have caused trouble in remote cases. Similarly, the fix\n  may also cause trouble...\n- bugfix: missing initialization during timestamp creation\n  This could lead to timestamps written in the wrong format, but not to\n  an abort\n---------------------------------------------------------------------------\nVersion 4.4.3  [v4-stable] (rgerhards), 2009-10-??\n- bugfix: several smaller bugs resolved after flexelint review\n  Thanks to varmojfekoj for the patch.\n- bugfix: $ActionExecOnlyOnceEveryInterval did not work.\n  This was a regression from the time() optimizations done in v4.\n  Bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=143\n  Thanks to Klaus Tachtler for reporting this bug.\n- bugfix: potential segfault on queue shutdown\n  Thanks to varmojfekoj for the patch.\n- bugfix: potential hang condition on queue shutdown\n  [imported from v3-stable]\n- bugfix: segfault on startup when -q or -Q option was given\n  [imported from v3-stable]\n---------------------------------------------------------------------------\nVersion 4.4.2  [v4-stable] (rgerhards), 2009-10-09\n- bugfix: invalid handling of zero-sized messages, could lead to mis-\n  addressing and potential memory corruption/segfault\n- bugfix: zero-sized UDP messages are no longer processed\n  until now, they were forwarded to processing, but this makes no sense\n  Also, it looks like the system seems to provide a zero return code\n  on a UDP recvfrom() from time to time for some internal reasons. These\n  \"receives\" are now silently ignored.\n- bugfix: random data could be appended to message, possibly causing\n  segfaults\n- bugfix: reverse lookup reduction logic in imudp do DNS queries too often\n  A comparison was done between the current and the former source address.\n  However, this was done on the full sockaddr_storage structure and not\n  on the host address only. This has now been changed for IPv4 and IPv6.\n  The end result of this bug could be a higher UDP message loss rate than\n  necessary (note that UDP message loss can not totally be avoided due\n  to the UDP spec)\n---------------------------------------------------------------------------\nVersion 4.4.1  [v4-stable] (rgerhards), 2009-09-02\n- features requiring Java are automatically disabled if Java is not\n  present (thanks to Michael Biebl for his help!)\n- bugfix: invalid double-quoted PRI, among others in outgoing messages\n  This causes grief with all receivers.\n  Bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=147\n- bugfix: Java testing tools were required, even if testbench was disabled\n  This resulted in build errors if no Java was present on the build system,\n  even though none of the selected option actually required Java.\n  (I forgot to backport a similar fix to newer releases).\n- bugfix (backport): omfwd segfault\n  Note that the orginal (higher version) patch states this happens only\n  when debugging mode is turned on. That statement is wrong: if debug\n  mode is turned off, the message is not being emitted, but the division\n  by zero in the actual parameters still happens.\n---------------------------------------------------------------------------\nVersion 4.4.0  [v4-stable] (rgerhards), 2009-08-21\n- bugfix: stderr/stdout were not closed to be able to emit error messages,\n  but this caused ssh sessions to hang. Now we close them after the \n  initial initialization. See forum thread:\n  http://kb.monitorware.com/controlling-terminal-issues-t9875.html\n- bugfix: sending syslog messages with zip compression did not work\n---------------------------------------------------------------------------\nVersion 4.3.2  [v4-beta] (rgerhards), 2009-06-24\n- removed long-obsoleted property UxTradMsg\n- added a generic network stream server (in addition to rather specific\n  syslog tcp server)\n- added ability for the UDP output action to rebind its send socket after\n  sending n messages. New config directive $ActionSendUDPRebindInterval\n  added for the purpose. By default, rebinding is disabled. This is \n  considered useful for load balancers.\n- bugfix: imdiag/imtcp had a race condition\n- improved testbench (now much better code design and reuse)\n- added config switch --enable-testbench=no to turn off testbench\n---------------------------------------------------------------------------\nVersion 4.3.1  [DEVEL] (rgerhards), 2009-05-25\n- added capability to run multiple tcp listeners (on different ports)\n- performance enhancement: imtcp calls parser no longer on input thread\n  but rather inside on of the potentially many main msg queue worker\n  threads (an enhancement scheduled for all input plugins where this is\n  possible)\n- added $GenerateConfigGraph configuration command which can be used\n  to generate nice-looking (and very informative) rsyslog configuration\n  graphs.\n- added $ActionName configuration directive (currently only used for\n  graph generation, but may find other uses)\n- improved doc\n  * added (hopefully) easier to grasp queue explanation\n- improved testbench\n  * added tests for queue disk-only mode (checks disk queue logic)\n- bugfix: light and full delay watermarks had invalid values, badly\n  affecting performance for delayable inputs\n- build system improvements - thanks to Michael Biebl\n- added new testing module imdiag, which enables to talk to the \n  rsyslog core at runtime. The current implementation is only a \n  beginning, but can be expanded over time\n---------------------------------------------------------------------------\nVersion 4.3.0  [DEVEL] (rgerhards), 2009-04-17\n- new feature: new output plugin omprog, which permits to start program\n  and feed it (via its stdin) with syslog messages. If the program\n  terminates, it is restarted.\n- improved internal handling of RainerScript functions, building the\n  necessary plumbing to support more functions with decent runtime\n  performance. This is also necessary towards the long-term goal\n  of loadable library modules.\n- added new RainerScript function \"tolower\"\n- improved testbench\n  * added tests for tcp-based reception\n  * added tcp-load test (1000 connections, 20,000 messages)\n- added $MaxOpenFiles configuration directive\n- bugfix: solved potential memory leak in msg processing, could manifest\n  itself in imtcp\n- bugfix: ompgsql did not detect problems in sql command execution\n  this could cause loss of messages. The handling was correct if the\n  connection broke, but not if there was a problem with statement\n  execution. The most probable case for such a case would be invalid\n  sql inside the template, and this is now much easier to diagnose.\n---------------------------------------------------------------------------\nVersion 4.2.0  [v4-stable] (rgerhards), 2009-06-23\n- bugfix: light and full delay watermarks had invalid values, badly\n  affecting performance for delayable inputs\n- imported all patches from 3.22.1 as of today (see below)\n- bugfix: compile problems in im3195\n---------------------------------------------------------------------------\nVersion 4.1.7  [BETA] (rgerhards), 2009-04-22\n- bugfix: $InputTCPMaxSessions config directive was accepted, but not\n  honored. This resulted in a fixed upper limit of 200 connections.\n- bugfix: the default for $DirCreateMode was 0644, and as such wrong.\n  It has now been changed to 0700. For some background, please see\n  http://lists.adiscon.net/pipermail/rsyslog/2009-April/001986.html\n- bugfix: ompgsql did not detect problems in sql command execution\n  this could cause loss of messages. The handling was correct if the\n  connection broke, but not if there was a problem with statement\n  execution. The most probable case for such a case would be invalid\n  sql inside the template, and this is now much easier to diagnose.\n---------------------------------------------------------------------------\nVersion 4.1.6  [DEVEL] (rgerhards), 2009-04-07\n- added new \"csv\" property replacer options to enable simple creation\n  of CSV-formatted outputs (format from RFC4180 is used)\n- implemented function support in RainerScript. That means the engine\n  parses and compile functions, as well as executes a few build-in\n  ones. Dynamic loading and registration of functions is not yet\n  supported - but we now have a good foundation to do that later on.\n- implemented the strlen() RainerScript function\n- added a template output module\n- added -T rsyslogd command line option, enables to specify a directory\n  where to chroot() into on startup. This is NOT a security feature but\n  introduced to support testing. Thus, -T does not make sure chroot()\n  is used in a secure way. (may be removed later)\n- added omstdout module for testing purposes. Spits out all messages to\n  stdout - no config option, no other features\n- added a parser testing suite (still needs to be extended, but a good\n  start)\n- modified $ModLoad statement so that for modules whom's name starts with\n  a dot, no path is prepended (this enables relative-pathes and should\n  not break any valid current config)\n- fixed a bug that caused action retries not to work correctly\n  situation was only cleared by a restart\n- bugfix: closed dynafile was potentially never written until another\n  dynafile name was generated - potential loss of messages\n- improved omfile so that it properly suspends itself if there is an\n  i/o or file name generation error. This enables it to be used with\n  the full high availability features of rsyslog's engine\n- bugfix: fixed some segaults on Solaris, where vsprintf() does not\n  check for NULL pointers\n- improved performance of regexp-based filters\n  Thanks to Arnaud Cornet for providing the idea and initial patch.\n- added a new way how output plugins may be passed parameters. This is\n  more effcient for some outputs. They new can receive fields not only\n  as a single string but rather in an array where each string is seperated.\n- added (some) developer documentation for output plugin interface\n- bugfix: potential abort with DA queue after high watermark is reached\n  There exists a race condition that can lead to a segfault. Thanks\n  go to vbernetr, who performed the analysis and provided patch, which\n  I only tweaked a very little bit.\n- bugfix: imtcp did incorrectly parse hostname/tag\n  Thanks to Luis Fernando Mu\u00f1oz Mej\u00edas for the patch.\n---------------------------------------------------------------------------\nVersion 4.1.5  [DEVEL] (rgerhards), 2009-03-11\n- bugfix: parser did not correctly parse fields in UDP-received messages\n- added ERE support in filter conditions\n  new comparison operation \"ereregex\"\n- added new config directive $RepeatedMsgContainsOriginalMsg so that the\n  \"last message repeated n times\" messages, if generated, may\n  have an alternate format that contains the message that is being repeated\n---------------------------------------------------------------------------\nVersion 4.1.4  [DEVEL] (rgerhards), 2009-01-29\n- bugfix: inconsistent use of mutex/atomic operations could cause segfault\n  details are too many, for full analysis see blog post at:\n  http://blog.gerhards.net/2009/01/rsyslog-data-race-analysis.html\n- bugfix: unitialized mutex was used in msg.c:getPRI\n  This was subtle, because getPRI is called as part of the debugging code\n  (always executed) in syslogd.c:logmsg.\n- bufgix: $PreserveFQDN was not properly handled for locally emitted\n  messages\n---------------------------------------------------------------------------\nVersion 4.1.3  [DEVEL] (rgerhards), 2008-12-17\n- added $InputTCPServerAddtlFrameDelimiter config directive, which\n  enables to specify an additional, non-standard message delimiter\n  for processing plain tcp syslog. This is primarily a fix for the invalid\n  framing used in Juniper's NetScreen products. Credit to forum user\n  Arv for suggesting this solution.\n- added $InputTCPServerInputName property, which enables a name to be\n  specified that will be available during message processing in the\n  inputname property. This is considered useful for logic that treats\n  messages differently depending on which input received them.\n- added $PreserveFQDN config file directive\n  Enables to use FQDNs in sender names where the legacy default\n  would have stripped the domain part.\n  Thanks to BlinkMind, Inc. http://www.blinkmind.com for sponsoring this\n  development.\n- bugfix: imudp went into an endless loop under some circumstances\n  (but could also leave it under some other circumstances...)\n  Thanks to David Lang and speedfox for reporting this issue.\n---------------------------------------------------------------------------\nVersion 4.1.2  [DEVEL] (rgerhards), 2008-12-04\n- bugfix: code did not compile without zlib\n- security bugfix: $AllowedSender was not honored, all senders were\n  permitted instead (see http://www.rsyslog.com/Article322.phtml)\n- security fix: imudp emitted a message when a non-permitted sender\n  tried to send a message to it. This behaviour is operator-configurable.\n  If enabled, a message was emitted each time. That way an attacker could\n  effectively fill the disk via this facility. The message is now\n  emitted only once in a minute (this currently is a hard-coded limit,\n  if someone comes up with a good reason to make it configurable, we\n  will probably do that).\n- doc bugfix: typo in v3 compatibility document directive syntax\n  thanks to Andrej for reporting\n- imported other changes from 3.21.8 and 3.20.1 (see there)\n---------------------------------------------------------------------------\nVersion 4.1.1  [DEVEL] (rgerhards), 2008-11-26\n- added $PrivDropToGroup, $PrivDropToUser, $PrivDropToGroupID,\n  $PrivDropToUserID config directives to enable dropping privileges.\n  This is an effort to provide a security enhancement. For the limits of this\n  approach, see http://wiki.rsyslog.com/index.php/Security\n- re-enabled imklog to compile on FreeBSD (brought in from beta)\n---------------------------------------------------------------------------\nVersion 4.1.0  [DEVEL] (rgerhards), 2008-11-18\n\n********************************* WARNING *********************************\nThis version has a slightly different on-disk format for message entries.\nAs a consequence, old queue files being read by this version may have\nan invalid output timestamp, which could result to some malfunction inside\nthe output driver. It is recommended to drain queues with the previous\nversion before switching to this one.\n********************************* WARNING *********************************\n\n- greatly enhanced performance when compared to v3.\n- added configuration directive \"HUPisRestart\" which enables to configure\n  HUP to be either a full restart or \"just\" a leightweight way to\n  close open files.\n- enhanced legacy syslog parser to detect year if part of the timestamp\n  the format is based on what Cisco devices seem to emit.\n- added a setting \"$OptimizeForUniprocessor\" to enable users to turn off\n  pthread_yield calls which are counter-productive on multiprocessor \n  machines (but have been shown to be useful on uniprocessors)\n- reordered imudp processing. Message parsing is now done as part of main\n  message queue worker processing (was part of the input thread)\n  This should also improve performance, as potentially more work is\n  done in parallel.\n- bugfix: compressed syslog messages could be slightly mis-uncompressed\n  if the last byte of the compressed record was a NUL\n- added $UDPServerTimeRequery option which enables to work with\n  less acurate timestamps in favor of performance. This enables querying\n  of the time only every n-th time if imudp is running in the tight\n  receive loop (aka receiving messsages at a high rate)\n- doc bugfix: queue doc had wrong parameter name for setting controlling\n  worker thread shutdown period\n- restructured rsyslog.conf documentation\n- bugfix: memory leak in ompgsql\n  Thanks to Ken for providing the patch\n---------------------------------------------------------------------------\nVersion 3.22.4 [v3-stable] (rgerhards), 2010-??-??\n- improved some code based on clang static analyzer results\n---------------------------------------------------------------------------\nVersion 3.22.3 [v3-stable] (rgerhards), 2010-11-24\n- bugfix(important): problem in TLS handling could cause rsyslog to loop\n  in a tight loop, effectively disabling functionality and bearing the\n  risk of unresponsiveness of the whole system.\n  Bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=194\n---------------------------------------------------------------------------\nVersion 3.22.2 [v3-stable] (rgerhards), 2010-08-05\n- bugfix: comment char ('#') in literal terminated script parsing\n  and thus could not be used.\n  but tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=119\n- enhance: imrelp now also provides remote peer's IP address \n  [if librelp != 1.0.0 is used]\n- bugfix: sending syslog messages with zip compression did not work\n- bugfix: potential hang condition on queue shutdown\n- bugfix: segfault on startup when -q or -Q option was given\n  bug tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=157\n  Thanks to Jonas Nogueira for reporting this bug.\n- clarified use of $ActionsSendStreamDriver[AuthMode/PermittedPeers]\n  in doc set (require TLS drivers)\n- bugfix: $CreateDirs variable not properly initialized, default thus\n  was random (but most often \"on\")\n- bugfix: potential segfault when -p command line option was used\n  thanks to varmojfekoj for pointing me at this bug\n- bugfix: programname filter in ! configuration can not be reset\n  Thanks to Kiss Gabor for the patch.\n---------------------------------------------------------------------------\nVersion 3.22.1 [v3-stable] (rgerhards), 2009-07-02\n- bugfix: invalid error message issued if $inlcudeConfig was on an empty\n  set of files (e.g. *.conf, where none such files existed)\n  thanks to Michael Biebl for reporting this bug\n- bugfix: when run in foreground (but not in debug mode), a \n  debug message (\"DoDie called\") was emitted at shutdown. Removed.\n  thanks to Michael Biebl for reporting this bug\n- bugfix: some garbagge was emitted to stderr on shutdown. This\n  garbage consisted of file names, which were written during \n  startup (key point: not a pointer error)\n  thanks to Michael Biebl for reporting this bug\n- bugfix: startup and shutdown message were emitted to stdout\n  thanks to Michael Biebl for reporting this bug\n- bugfix: error messages were not emitted to stderr in forked mode\n  (stderr and stdo are now kept open across forks)\n- bugfix: internal messages were emitted to whatever file had fd2 when\n  rsyslogd ran in forked mode (as usual!)\n  Thanks to varmojfekoj for the patch\n- small enhancement: config validation run now exits with code 1 if an\n  error is detected. This change is considered important but small enough\n  to apply it directly to the stable version. [But it is a border case,\n  the change requires more code than I had hoped. Thus I have NOT tried\n  to actually catch all cases, this is left for the current devel\n  releases, if necessary]\n- bugfix: light and full delay watermarks had invalid values, badly\n  affecting performance for delayable inputs\n- bugfix: potential segfault issue when multiple $UDPServerRun directives\n  are specified. Thanks to Michael Biebl for helping to debug this one.\n- relaxed GnuTLS version requirement to 1.4.0 after confirmation from the\n  field that this version is sufficient\n- bugfix: parser did not properly handle empty structured data\n- bugfix: invalid mutex release in msg.c (detected under thread debugger,\n  seems not to have any impact on actual deployments)\n---------------------------------------------------------------------------\nVersion 3.22.0 [v3-stable] (rgerhards), 2009-04-21\nThis is the first stable release that includes the full functionality\nof the 3.21.x version tree.\n- bugfix: $InputTCPMaxSessions config directive was accepted, but not\n  honored. This resulted in a fixed upper limit of 200 connections.\n- bugfix: the default for $DirCreateMode was 0644, and as such wrong.\n  It has now been changed to 0700. For some background, please see\n  http://lists.adiscon.net/pipermail/rsyslog/2009-April/001986.html\n- bugfix: ompgsql did not detect problems in sql command execution\n  this could cause loss of messages. The handling was correct if the\n  connection broke, but not if there was a problem with statement\n  execution. The most probable case for such a case would be invalid\n  sql inside the template, and this is now much easier to diagnose.\n---------------------------------------------------------------------------\nVersion 3.21.11 [BETA] (rgerhards), 2009-04-03\n- build system improvements contributed by Michael Biebl - thx!\n- all patches from 3.20.5 incorporated (see it's ChangeLog entry)\n---------------------------------------------------------------------------\nVersion 3.21.10 [BETA] (rgerhards), 2009-02-02\n- bugfix: inconsistent use of mutex/atomic operations could cause segfault\n  details are too many, for full analysis see blog post at:\n  http://blog.gerhards.net/2009/01/rsyslog-data-race-analysis.html\n- the string \"Do Die\" was accidently emited upon exit in non-debug mode\n  This has now been corrected. Thanks to varmojfekoj for the patch.\n- some legacy options were not correctly processed.\n  Thanks to varmojfekoj for the patch.\n- doc bugfix: v3-compatiblity document had typo in config directive\n  thanks to Andrej for reporting this\n---------------------------------------------------------------------------\nVersion 3.21.9 [BETA] (rgerhards), 2008-12-04\n- re-release of 3.21.8 with an additional fix, that could also lead\n  to DoS; 3.21.8 has been removed from the official download archives\n- security fix: imudp emitted a message when a non-permitted sender\n  tried to send a message to it. This behaviour is operator-configurable.\n  If enabled, a message was emitted each time. That way an attacker could\n  effectively fill the disk via this facility. The message is now\n  emitted only once in a minute (this currently is a hard-coded limit,\n  if someone comes up with a good reason to make it configurable, we\n  will probably do that).\n---------------------------------------------------------------------------\nVersion 3.21.8  [BETA] (rgerhards), 2008-12-04\n- bugfix: imklog did not compile on FreeBSD\n- security bugfix: $AllowedSender was not honored, all senders were\n  permitted instead (see http://www.rsyslog.com/Article322.phtml)\n- merged in all other changes from 3.20.1 (see there)\n---------------------------------------------------------------------------\nVersion 3.21.7  [BETA] (rgerhards), 2008-11-11\n- this is the new beta branch, based on the former 3.21.6 devel\n- new functionality: ZERO property replacer nomatch option (from v3-stable)\n---------------------------------------------------------------------------\nVersion 3.21.6  [DEVEL] (rgerhards), 2008-10-22\n- consolidated time calls during msg object creation, improves performance\n  and consistency\n- bugfix: solved a segfault condition\n- bugfix: subsecond time properties generated by imfile, imklog and\n  internal messages could be slightly inconsistent\n- bugfix: (potentially big) memory leak on HUP if queues could not be\n  drained before timeout - thanks to David Lang for pointing this out\n- added capability to support multiple module search pathes. Thank\n  to Marius Tomaschewski for providing the patch.\n- bugfix: im3195 did no longer compile\n- improved \"make distcheck\" by ensuring everything relevant is recompiled\n---------------------------------------------------------------------------\nVersion 3.21.5  [DEVEL] (rgerhards), 2008-09-30\n- performance optimization: unnecessary time() calls during message\n  parsing removed - thanks to David Lang for his excellent performance\n  analysis\n- added new capability to property replacer: multiple immediately\n  successive field delimiters are treated as a single one.\n  Thanks to Zhuang Yuyao for the patch.\n- added message property \"inputname\", which contains the name of the\n  input (module) that generated it. Presence is depending on suport in\n  each input module (else it is blank).\n- added system property \"$myhostname\", which contains the name of the\n  local host as it knows itself.\n- imported a number of fixes and enhancements from the stable and\n  devel branches, including a fix to a potential segfault on HUP\n  when using UDP listners\n- re-enabled gcc builtin atomic operations and added a proper\n  ./configure check\n- bugfix: potential race condition when adding messages to queue\n  There was a wrong order of mutex lock operations. It is hard to\n  believe that really caused problems, but in theory it could and with\n  threading we often see that theory becomes practice if something is only\n  used long enough on a fast enough machine with enough CPUs ;)\n- cleaned up internal debug system code and made it behave better\n  in regard to multi-threading\n---------------------------------------------------------------------------\nVersion 3.21.4  [DEVEL] (rgerhards), 2008-09-04\n- removed compile time fixed message size limit (was 2K), limit can now\n  be set via $MaxMessageSize global config directive (finally gotten rid\n  of MAXLINE ;))\n- enhanced doc for $ActionExecOnlyEveryNthTimeTimeout\n- integrated a number of patches from 3.18.4, namely\n  - bugfix: order-of magnitude issue with base-10 size definitions\n    in config file parser. Could lead to invalid sizes, constraints\n    etc for e.g. queue files and any other object whose size was specified\n    in base-10 entities. Did not apply to binary entities. Thanks to\n    RB for finding this bug and providing a patch.\n  - bugfix: action was not called when system time was set backwards\n    (until the previous time was reached again). There are still some\n    side-effects when time is rolled back (A time rollback is really a bad\n    thing to do, ideally the OS should issue pseudo time (like NetWare did)\n    when the user tries to roll back time). Thanks to varmojfekoj for this\n    patch.\n  - doc bugfix: rsyslog.conf man page improved and minor nit fixed\n    thanks to Lukas Kuklinek for the patch.\n---------------------------------------------------------------------------\nVersion 3.21.3  [DEVEL] (rgerhards), 2008-08-13\n- added ability to specify flow control mode for imuxsock\n- added ability to execute actions only after the n-th call of the action\n  This also lead to the addition of two new config directives:\n  $ActionExecOnlyEveryNthTime and $ActionExecOnlyEveryNthTimeTimeout\n  This feature is useful, for example, for alerting: it permits you to\n  send an alert only after at least n occurences of a specific message\n  have been seen by rsyslogd. This protectes against false positives\n  due to waiting for additional confirmation.\n- bugfix: IPv6 addresses could not be specified in forwarding actions\n  New syntax @[addr]:port introduced to enable that. Root problem was IPv6\n  addresses contain colons.\n- somewhat enhanced debugging messages\n- imported from 3.18.3:\n  - enhanced ommysql to support custom port to connect to server\n    Port can be set via new $ActionOmmysqlServerPort config directive\n    Note: this was a very minor change and thus deemed appropriate to be\n    done in the stable release.\n  - bugfix: misspelled config directive, previously was\n    $MainMsgQueueWorkeTimeoutrThreadShutdown, is now\n    $MainMsgQueueWorkerTimeoutThreadShutdown. Note that the misspelled\n    directive is not preserved - if the misspelled directive was used\n    (which I consider highly unlikely), the config file must be changed.\n    Thanks to lperr for reporting the bug.\n---------------------------------------------------------------------------\nVersion 3.21.2  [DEVEL] (rgerhards), 2008-08-04\n- added $InputUnixListenSocketHostName config directive, which permits to\n  override the hostname being used on a local unix socket. This is useful\n  for differentiating \"hosts\" running in several jails. Feature was\n  suggested by David Darville, thanks for the suggestion.\n- enhanced ommail to support multiple email recipients. This is done by\n  specifying $ActionMailTo multiple times. Note that this introduces a\n  small incompatibility to previous config file syntax: the recipient\n  list is now reset for each action (we honestly believe that will\n  not cause any problem - apologies if it does).\n- enhanced troubleshooting documentation\n---------------------------------------------------------------------------\nVersion 3.21.1  [DEVEL] (rgerhards), 2008-07-30\n- bugfix: no error was reported if the target of a $IncludeConfig\n  could not be accessed.\n- added testbed for common config errors\n- added doc for -u option to rsyslogd man page\n- enhanced config file checking - no active actions are detected\n- added -N rsyslogd command line option for a config validation run\n  (which does not execute actual syslogd code and does not interfere\n  with a running instance)\n- somewhat improved emergency configuration. It is now also selected\n  if the config contains no active actions\n- rsyslogd error messages are now reported to stderr by default. can be\n  turned off by the new \"$ErrorMessagesToStderr off\" directive\n Thanks to HKS for suggesting the new features.\n---------------------------------------------------------------------------\nVersion 3.21.0  [DEVEL] (rgerhards), 2008-07-18\n- starts a new devel branch\n- added a generic test driver for RainerScript plus some test cases\n  to the testbench\n- added a small diagnostic tool to obtain result of gethostname() API\n- imported all changes from 3.18.1 until today (some quite important,\n  see below)\n---------------------------------------------------------------------------\nVersion 3.20.6 [v3-stable] (rgerhards), 2009-04-16\n- this is the last v3-stable for the 3.20.x series\n- bugfix: $InputTCPMaxSessions config directive was accepted, but not\n  honored. This resulted in a fixed upper limit of 200 connections.\n- bugfix: the default for $DirCreateMode was 0644, and as such wrong.\n  It has now been changed to 0700. For some background, please see\n  http://lists.adiscon.net/pipermail/rsyslog/2009-April/001986.html\n---------------------------------------------------------------------------\nVersion 3.20.5 [v3-stable] (rgerhards), 2009-04-02\n- bugfix: potential abort with DA queue after high watermark is reached\n  There exists a race condition that can lead to a segfault. Thanks\n  go to vbernetr, who performed the analysis and provided patch, which\n  I only tweaked a very little bit.\n- fixed bugs in RainerScript:\n  o when converting a number and a string to a common type, both were \n    actually converted to the other variable's type.\n  o the value of rsCStrConvertToNumber() was miscalculated.\n  Thanks to varmojfekoj for the patch\n- fixed a bug in configure.ac which resulted in problems with\n  environment detection - thanks to Michael Biebl for the patch\n- fixed a potential segfault problem in gssapi code\n  thanks to varmojfekoj for the patch\n- doc enhance: provide standard template for MySQL module and instructions\n  on how to modify schema\n---------------------------------------------------------------------------\nVersion 3.20.4 [v3-stable] (rgerhards), 2009-02-09\n- bugfix: inconsistent use of mutex/atomic operations could cause segfault\n  details are too many, for full analysis see blog post at:\n  http://blog.gerhards.net/2009/01/rsyslog-data-race-analysis.html\n- bugfix: invalid ./configure settings for RFC3195\n  thanks to Michael Biebl for the patch\n- bugfix: invalid mutex access in msg.c\n- doc bugfix: dist tarball missed 2 files, had one extra file that no\n  longer belongs into it. Thanks to Michael Biebl for pointing this out.\n---------------------------------------------------------------------------\nVersion 3.20.3 [v3-stable] (rgerhards), 2009-01-19\n- doc bugfix: v3-compatiblity document had typo in config directive\n  thanks to Andrej for reporting this\n- fixed a potential segfault condition with $AllowedSender directive\n  On HUP, the root pointers were not properly cleaned up. Thanks to\n  Michael Biebel, olgoat, and Juha Koho for reporting and analyzing\n  the bug.\n---------------------------------------------------------------------------\nVersion 3.20.2 [v3-stable] (rgerhards), 2008-12-04\n- re-release of 3.20.1 with an additional fix, that could also lead\n  to DoS; 3.20.1 has been removed from the official download archives\n- security fix: imudp emitted a message when a non-permitted sender\n  tried to send a message to it. This behaviour is operator-configurable.\n  If enabled, a message was emitted each time. That way an attacker could\n  effectively fill the disk via this facility. The message is now\n  emitted only once in a minute (this currently is a hard-coded limit,\n  if someone comes up with a good reason to make it configurable, we\n  will probably do that).\n---------------------------------------------------------------------------\nVersion 3.20.1 [v3-stable] (rgerhards), 2008-12-04\n- security bugfix: $AllowedSender was not honored, all senders were\n  permitted instead\n- enhance: regex nomatch option \"ZERO\" has been added\n  This allows to return the string 0 if a regular expression is\n  not found. This is probably useful for storing numerical values into\n  database columns.\n- bugfix: memory leak in gtls netstream driver fixed\n  memory was lost each time a TLS session was torn down. This could \n  result in a considerable memory leak if it happened quite frequently\n  (potential system crash condition)\n- doc update: documented how to specify multiple property replacer\n  options + link to new online regex generator tool added\n- minor bufgfix: very small memory leak in gtls netstream driver\n  around a handful of bytes (< 20) for each HUP\n- improved debug output for regular expressions inside property replacer\n  RE's seem to be a big trouble spot and I would like to have more\n  information inside the debug log. So I decided to add some additional\n  debug strings permanently.\n---------------------------------------------------------------------------\nVersion 3.20.0 [v3-stable] (rgerhards), 2008-11-05\n- this is the inital release of the 3.19.x branch as a stable release\n- bugfix: double-free in pctp netstream driver. Thank to varmojfeko\n  for the patch\n---------------------------------------------------------------------------\nVersion 3.19.12 [BETA] (rgerhards), 2008-10-16\n- bugfix: subseconds where not correctly extracted from a timestamp\n  if that timestamp did not contain any subsecond information (the\n  resulting string was garbagge but should have been \"0\", what it\n  now is).\n- increased maximum size of a configuration statement to 4K (was 1K)\n- imported all fixes from the stable branch (quite a lot)\n- bugfix: (potentially big) memory leak on HUP if queues could not be\n  drained before timeout - thanks to David Lang for pointing this out\n---------------------------------------------------------------------------\nVersion 3.19.11 [BETA] (rgerhards), 2008-08-25\nThis is a refresh of the beta. No beta-specific fixes have been added.\n- included fixes from v3-stable (most importantly 3.18.3)\n---------------------------------------------------------------------------\nVersion 3.19.10 [BETA] (rgerhards), 2008-07-15\n- start of a new beta branch based on former 3.19 devel branch\n- bugfix: bad memory leak in disk-based queue modes\n- bugfix: UDP syslog forwarding did not work on all platforms\n  the ai_socktype was incorrectly set to 1. On some platforms, this\n  lead to failing name resolution (e.g. FreeBSD 7). Thanks to HKS for\n  reporting the bug.\n- bugfix: priority was incorrectly calculated on FreeBSD 7,\n  because the LOG_MAKEPRI() C macro has a different meaning there (it\n  is just a simple addition of faciltity and severity). I have changed\n  this to use own, consistent, code for PRI calculation. Thank to HKS\n  for reporting this bug.\n- bugfix (cosmetical): authorization was not checked when gtls handshake\n  completed immediately. While this sounds scary, the situation can not\n  happen in practice. We use non-blocking IO only for server-based gtls\n  session setup. As TLS requires the exchange of multiple frames before\n  the handshake completes, it simply is impossible to do this in one\n  step. However, it is useful to have the code path correct even for \n  this case - otherwise, we may run into problems if the code is changed\n  some time later (e.g. to use blocking sockets). Thanks to varmojfekoj\n  for providing the patch.\n- important queue bugfix from 3.18.1 imported (see below)\n- cleanup of some debug messages\n---------------------------------------------------------------------------\nVersion 3.19.9 (rgerhards), 2008-07-07\n- added tutorial for creating a TLS-secured syslog infrastructure\n- rewritten omusrmsg to no longer fork() a new process for sending messages\n  this caused some problems with the threading model, e.g. zombies. Also,\n  it was far less optimal than it is now.\n- bugfix: machine certificate was required for client even in TLS anon mode\n  Reference: http://bugzilla.adiscon.com/show_bug.cgi?id=85\n  The fix also slightly improves performance by not storing certificates in\n  client sessions when there is no need to do so.\n- bugfix: RainerScript syntax error was not always detected\n---------------------------------------------------------------------------\nVersion 3.19.8 (rgerhards), 2008-07-01\n- bugfix: gtls module did not correctly handle EGAIN (and similar) recv()\n  states. This has been fixed by introducing a new abstraction layer inside\n  gtls.\n- added (internal) error codes to error messages; added redirector to\n  web description of error codes\n  closes bug http://bugzilla.adiscon.com/show_bug.cgi?id=20\n- disabled compile warnings caused by third-party libraries\n- reduced number of compile warnings in gcc's -pedantic mode\n- some minor documentation improvements\n- included all fixes from beta 3.17.5\n---------------------------------------------------------------------------\nVersion 3.19.7 (rgerhards), 2008-06-11\n- added new property replacer option \"date-subseconds\" that enables\n  to query just the subsecond part of a high-precision timestamp\n- somewhat improved plain tcp syslog reliability by doing a connection\n  check before sending. Credits to Martin Schuette for providing the\n  idea. Details are available at\n  http://blog.gerhards.net/2008/06/reliable-plain-tcp-syslog-once-again.html\n- made rsyslog tickless in the (usual and default) case that repeated\n  message reduction is turned off. More info:\n  http://blog.gerhards.net/2008/06/coding-to-save-environment.html\n- some build system cleanup, thanks to Michael Biebl\n- bugfix: compile under (Free)BSD failed due to some invalid library\n  definitions - this is fixed now. Thanks to Michael Biebl for the patch.\n---------------------------------------------------------------------------\nVersion 3.19.6 (rgerhards), 2008-06-06\n- enhanced property replacer to support multiple regex matches\n- bugfix: part of permittedPeer structure was not correctly initialized\n  thanks to varmojfekoj for spotting this\n- bugfix: off-by-one bug during certificate check\n- bugfix: removed some memory leaks in TLS code\n---------------------------------------------------------------------------\nVersion 3.19.5 (rgerhards), 2008-05-30\n- enabled Posix ERE expressions inside the property replacer\n  (previously BRE was permitted only)\n- provided ability to specify that a regular expression submatch shall\n  be used inside the property replacer\n- implemented in property replacer: if a regular expression does not match,\n  it can now either return \"**NO MATCH** (default, as before), a blank\n  property or the full original property text\n- enhanced property replacer to support multiple regex matches\n---------------------------------------------------------------------------\nVersion 3.19.4 (rgerhards), 2008-05-27\n- implemented x509/certvalid gtls auth mode\n- implemented x509/name gtls auth mode (including wildcards)\n- changed fingerprint gtls auth mode to new format fingerprint\n- protected gtls error string function by a mutex. Without it, we\n  could have a race condition in extreme cases. This was very remote,\n  but now can no longer happen.\n- changed config directive name to reflect different use\n  $ActionSendStreamDriverCertFingerprint is now\n  $ActionSendStreamDriverPermittedPeer and can be used both for\n  fingerprint and name authentication (similar to the input side)\n- bugfix: sender information (fromhost et al) was missing in imudp\n  thanks to sandiso for reporting this bug\n- this release fully inplements IETF's syslog-transport-tls-12 plus\n  the latest text changes Joe Salowey provided via email. Not included\n  is ipAddress subjectAltName authentication, which I think will be\n  dropped from the draft. I don't think there is any real need for it.\nThis release also includes all bug fix up to today from the beta\nand stable branches. Most importantly, this means the bugfix for\n100% CPU utilization by imklog.\n---------------------------------------------------------------------------\nVersion 3.19.3 (rgerhards), 2008-05-21\n- added ability to authenticate the server against its certificate\n  fingerprint\n- added ability for client to provide its fingerprint\n- added ability for server to obtain client cert's fingerprint\n- bugfix: small mem leak in omfwd on exit (strmdriver name was not freed)\n- bugfix: $ActionSendStreamDriver had no effect\n- bugfix: default syslog port was no longer used if none was\n  configured. Thanks to varmojfekoj for the patch\n- bugfix: missing linker options caused build to fail on some\n  systems. Thanks to Tiziano Mueller for the patch.\n---------------------------------------------------------------------------\nVersion 3.19.2 (rgerhards), 2008-05-16\n- bugfix: TCP input modules did incorrectly set fromhost property\n  (always blank)\n- bugfix: imklog did not set fromhost property\n- added \"fromhost-ip\" property\n  Note that adding this property changes the on-disk format for messages.\n  However, that should not have any bad effect on existing spool files.\n  But you will run into trouble if you create a spool file with this\n  version and then try to process it with an older one (after a downgrade).\n  Don't do that ;)\n- added \"RSYSLOG_DebugFormat\" canned template\n- bugfix: hostname and fromhost were swapped when a persisted message\n  (in queued mode) was read in\n- bugfix: lmtcpclt, lmtcpsrv and lmgssutil did all link to the static\n  runtime library, resulting in a large size increase (and potential\n  \"interesting\" effects). Thanks to Michael Biebel for reporting the size\n  issue.\n- bugfix: TLS server went into an endless loop in some situations.\n  Thanks to Michael Biebl for reporting the problem.\n- fixed potential segfault due to invalid call to cfsysline\n  thanks to varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 3.19.1 (rgerhards), 2008-05-07\n- configure help for --enable-gnutls wrong - said default is \"yes\" but\n  default actually is \"no\" - thanks to darix for pointing this out\n- file dirty.h was missing - thanks to darix for pointing this out\n- bugfix: man files were not properly distributed - thanks to\n  darix for reporting and to Michael Biebl for help with the fix\n- some minor cleanup\n---------------------------------------------------------------------------\nVersion 3.19.0 (rgerhards), 2008-05-06\n- begins new devel branch version\n- implemented TLS for plain tcp syslog (this is also the world's first\n  implementation of IETF's upcoming syslog-transport-tls draft)\n- partly rewritten and improved omfwd among others, now loads TCP\n  code only if this is actually necessary\n- split of a \"runtime library\" for rsyslog - this is not yet a clean\n  model, because some modularization is still outstanding. In theory,\n  this shall enable other utilities but rsyslogd to use the same\n  runtime\n- implemented im3195, the RFC3195 input as a plugin\n- changed directory structure, files are now better organized\n- a lot of cleanup in regard to modularization\n- -c option no longer must be the first option - thanks to varmjofekoj\n  for the patch\n---------------------------------------------------------------------------\nVersion 3.18.7 (rgerhards), 2008-12-??\n- bugfix: the default for $DirCreateMode was 0644, and as such wrong.\n  It has now been changed to 0700. For some background, please see\n  http://lists.adiscon.net/pipermail/rsyslog/2009-April/001986.html\n- fixed a potential segfault condition with $AllowedSender directive\n  On HUP, the root pointers were not properly cleaned up. Thanks to\n  Michael Biebel, olgoat, and Juha Koho for reporting and analyzing\n  the bug.\n- some legacy options were not correctly processed.\n  Thanks to varmojfekoj for the patch.\n- doc bugfix: some spelling errors in man pages corrected. Thanks to\n  Geoff Simmons for the patch.\n---------------------------------------------------------------------------\nVersion 3.18.6 (rgerhards), 2008-12-08\n- security bugfix: $AllowedSender was not honored, all senders were\n  permitted instead (see http://www.rsyslog.com/Article322.phtml)\n  (backport from v3-stable, v3.20.9)\n- minor bugfix: dual close() call on tcp session closure\n---------------------------------------------------------------------------\nVersion 3.18.5 (rgerhards), 2008-10-09\n- bugfix: imudp input module could cause segfault on HUP\n  It did not properly de-init a variable acting as a linked list head.\n  That resulted in trying to access freed memory blocks after the HUP.\n- bugfix:  rsyslogd could hang on HUP\n  because getnameinfo() is not cancel-safe, but was not guarded against\n  being cancelled. pthread_cancel() is routinely being called during\n  HUP processing.\n- bugfix[minor]: if queue size reached light_delay mark, enqueuing\n  could potentially be blocked for a longer period of time, which\n  was not the behaviour desired.\n- doc bugfix: $ActionExecOnlyWhenPreviousIsSuspended was still misspelled\n  as $...OnlyIfPrev... in some parts of the documentation. Thanks to \n  Lorenzo M. Catucci for reporting this bug.\n- added doc on malformed messages, cause and how to work-around, to the\n  doc set\n- added doc on how to build from source repository\n---------------------------------------------------------------------------\nVersion 3.18.4 (rgerhards), 2008-09-18\n- bugfix: order-of magnitude issue with base-10 size definitions\n  in config file parser. Could lead to invalid sizes, constraints\n  etc for e.g. queue files and any other object whose size was specified\n  in base-10 entities. Did not apply to binary entities. Thanks to\n  RB for finding this bug and providing a patch.\n- bugfix: action was not called when system time was set backwards\n  (until the previous time was reached again). There are still some\n  side-effects when time is rolled back (A time rollback is really a bad\n  thing to do, ideally the OS should issue pseudo time (like NetWare did)\n  when the user tries to roll back time). Thanks to varmojfekoj for this\n  patch.\n- doc bugfix: rsyslog.conf man page improved and minor nit fixed\n  thanks to Lukas Kuklinek for the patch.\n- bugfix: error code -2025 was used for two different errors. queue full\n  is now -2074 and -2025 is unique again. (did cause no real problem\n  except for troubleshooting)\n- bugfix: default discard severity was incorrectly set to 4, which lead\n  to discard-on-queue-full to be enabled by default. That could cause\n  message loss where non was expected.  The default has now been changed\n  to the correct value of 8, which disables the functionality. This\n  problem applied both to the main message queue and the action queues.\n  Thanks to Raoul Bhatia for pointing out this problem.\n- bugfix: option value for legacy -a option could not be specified,\n  resulting in strange operations. Thanks to Marius Tomaschewski\n  for the patch.\n- bugfix: colon after date should be ignored, but was not. This has\n  now been corrected. Required change to the internal ParseTIMESTAMP3164()\n  interface.\n---------------------------------------------------------------------------\nVersion 3.18.3 (rgerhards), 2008-08-18\n- bugfix: imfile could cause a segfault upon rsyslogd HUP and termination\n  Thanks to lperr for an excellent bug report that helped detect this\n  problem.\n- enhanced ommysql to support custom port to connect to server\n  Port can be set via new $ActionOmmysqlServerPort config directive\n  Note: this was a very minor change and thus deemed appropriate to be\n  done in the stable release.\n- bugfix: misspelled config directive, previously was\n  $MainMsgQueueWorkeTimeoutrThreadShutdown, is now\n  $MainMsgQueueWorkerTimeoutThreadShutdown. Note that the misspelled\n  directive is not preserved - if the misspelled directive was used\n  (which I consider highly unlikely), the config file must be changed.\n  Thanks to lperr for reporting the bug.\n- disabled flow control for imuxsock, as it could cause system hangs\n  under some circumstances. The devel (3.21.3 and above) will\n  re-enable it and provide enhanced configurability to overcome the\n  problems if they occur.\n---------------------------------------------------------------------------\nVersion 3.18.2 (rgerhards), 2008-08-08\n- merged in IPv6 forwarding address bugfix from v2-stable\n---------------------------------------------------------------------------\nVersion 3.18.1 (rgerhards), 2008-07-21\n- bugfix: potential segfault in creating message mutex in non-direct queue\n  mode. rsyslogd segfaults on freeeBSD 7.0 (an potentially other platforms)\n  if an action queue is running in any other mode than non-direct. The\n  same problem can potentially be triggered by some main message queue\n  settings. In any case, it will manifest during rsylog's startup. It is\n  unlikely to happen after a successful startup (the only window of\n  exposure may be a relatively seldom executed action running in queued\n  mode). This has been corrected. Thank to HKS for point out the problem.\n- bugfix: priority was incorrectly calculated on FreeBSD 7,\n  because the LOG_MAKEPRI() C macro has a different meaning there (it\n  is just a simple addition of faciltity and severity). I have changed\n  this to use own, consistent, code for PRI calculation. [Backport from\n  3.19.10]\n- bugfix: remove PRI part from kernel message if it is present\n  Thanks to Michael Biebl for reporting this bug\n- bugfix: mark messages were not correctly written to text log files\n  the markmessageinterval was not correctly propagated to all places\n  where it was needed. This resulted in rsyslog using the default\n  (20 minutes) in some code pathes, what looked to the user like mark\n  messages were never written.\n- added a new property replacer option \"sp-if-no-1st-sp\" to cover\n  a problem with RFC 3164 based interpreation of tag separation. While\n  it is a generic approach, it fixes a format problem introduced in\n  3.18.0, where kernel messages no longer had a space after the tag.\n  This is done by a modifcation of the default templates.\n  Please note that this may affect some messages where there intentionally\n  is no space between the tag and the first character of the message\n  content. If so, this needs to be worked around via a specific\n  template. However, we consider this scenario to be quite remote and,\n  even if it exists, it is not expected that it will actually cause\n  problems with log parsers (instead, we assume the new default template\n  behaviour may fix previous problems with log parsers due to the \n  missing space).\n- bugfix: imklog module was not correctly compiled for GNU/kFreeBSD.\n  Thanks to Petr Salinger for the patch\n- doc bugfix: property replacer options secpath-replace and\n  secpath-drop were not documented\n- doc bugfix: fixed some typos in rsyslog.conf man page\n- fixed typo in source comment  - thanks to Rio Fujita\n- some general cleanup (thanks to Michael Biebl)\n---------------------------------------------------------------------------\nVersion 3.18.0 (rgerhards), 2008-07-11\n- begun a new v3-stable based on former 3.17.4 beta plus patches to\n  previous v3-stable\n- bugfix in RainerScript: syntax error was not always detected\n---------------------------------------------------------------------------\nVersion 3.17.5 (rgerhards), 2008-06-27\n- added doc: howto set up a reliable connection to remote server via\n  queued mode (and plain tcp protocol)\n- bugfix: comments after actions were not properly treated. For some\n  actions (e.g. forwarding), this could also lead to invalid configuration\n---------------------------------------------------------------------------\nVersion 3.17.4 (rgerhards), 2008-06-16\n- changed default for $KlogSymbolLookup to \"off\". The directive is\n  also scheduled for removal in a later version. This was necessary\n  because on kernels >= 2.6, the kernel does the symbol lookup itself. The\n  imklog lookup logic then breaks the log message and makes it unusable.\n---------------------------------------------------------------------------\nVersion 3.17.3 (rgerhards), 2008-05-28\n- bugfix: imklog went into an endless loop if a PRI value was inside\n  a kernel log message (unusual case under Linux, frequent under BSD)\n---------------------------------------------------------------------------\nVersion 3.17.2 (rgerhards), 2008-05-04\n- this version is the new beta, based on 3.17.1 devel feature set\n- merged in imklog bug fix from v3-stable (3.16.1)\n---------------------------------------------------------------------------\nVersion 3.17.1 (rgerhards), 2008-04-15\n- removed dependency on MAXHOSTNAMELEN as much as it made sense.\n  GNU/Hurd does not define it (because it has no limit), and we have taken\n  care for cases where it is undefined now. However, some very few places\n  remain where IMHO it currently is not worth fixing the code. If it is\n  not defined, we have used a generous value of 1K, which is above IETF\n  RFC's on hostname length at all. The memory consumption is no issue, as\n  there are only a handful of this buffers allocated *per run* -- that's\n  also the main reason why we consider it not worth to be fixed any further.\n- enhanced legacy syslog parser to handle slightly malformed messages\n  (with a space in front of the timestamp) - at least HP procurve is\n  known to do that and I won't outrule that others also do it. The \n  change looks quite unintrusive and so we added it to the parser.\n- implemented klogd functionality for BSD\n- implemented high precision timestamps for the kernel log. Thanks to\n  Michael Biebl for pointing out that the kernel log did not have them.\n- provided ability to discard non-kernel messages if they are present\n  in the kernel log (seems to happen on BSD)\n- implemented $KLogInternalMsgFacility config directive\n- implemented $KLogPermitNonKernelFacility config directive\nPlus a number of bugfixes that were applied to v3-stable and beta\nbranches (not mentioned here in detail).\n---------------------------------------------------------------------------\nVersion 3.17.0 (rgerhards), 2008-04-08\n- added native ability to send mail messages\n- removed no longer needed file relptuil.c/.h\n- added $ActionExecOnlyOnceEveryInterval config directive\n- bugfix: memory leaks in script engine\n- bugfix: zero-length strings were not supported in object\n  deserializer\n- properties are now case-insensitive everywhere (script, filters,\n  templates)\n- added the capability to specify a processing (actually dequeue)\n  timeframe with queues - so things can be configured to be done\n  at off-peak hours\n- We have removed the 32 character size limit (from RFC3164) on the\n  tag. This had bad effects on existing envrionments, as sysklogd didn't\n  obey it either (probably another bug in RFC3164...). We now receive\n  the full size, but will modify the outputs so that only 32 characters\n  max are used by default. If you need large tags in the output, you need\n  to provide custom templates.\n- changed command line processing. -v, -M, -c options are now parsed\n  and processed before all other options. Inter-option dependencies\n  have been relieved. Among others, permits to specify intial module\n  load path via -M only (not the environment) which makes it much\n  easier to work with non-standard module library locations. Thanks\n  to varmojfekoj for suggesting this change. Matches bugzilla bug 55.\n- bugfix: some messages were emited without hostname\nPlus a number of bugfixes that were applied to v3-stable and beta\nbranches (not mentioned here in detail).\n---------------------------------------------------------------------------\nVersion 3.16.3 (rgerhards), 2008-07-11\n- updated information on rsyslog packages\n- bugfix: memory leak in disk-based queue modes\n---------------------------------------------------------------------------\nVersion 3.16.2 (rgerhards), 2008-06-25\n- fixed potential segfault due to invalid call to cfsysline\n  thanks to varmojfekoj for the patch\n- bugfix: some whitespaces where incorrectly not ignored when parsing\n  the config file. This is now corrected. Thanks to Michael Biebl for\n  pointing out the problem.\n---------------------------------------------------------------------------\nVersion 3.16.1 (rgerhards), 2008-05-02\n- fixed a bug in imklog which lead to startup problems (including\n  segfault) on some platforms under some circumsances. Thanks to\n  Vieri for reporting this bug and helping to troubleshoot it.\n---------------------------------------------------------------------------\nVersion 3.16.0 (rgerhards), 2008-04-24\n- new v3-stable (3.16.x) based on beta 3.15.x (RELP support)\n- bugfix: omsnmp had a too-small sized buffer for hostname+port. This\n  could not lead to a segfault, as snprintf() was used, but could cause\n  some trouble with extensively long hostnames.\n- applied patch from Tiziano M\u00fcller to remove some compiler warnings\n- added gssapi overview/howto thanks to Peter Vrabec\n- changed some files to grant LGPLv3 extended persmissions on top of GPLv3\n  this also is the first sign of something that will evolve into a\n  well-defined \"rsyslog runtime library\"\n---------------------------------------------------------------------------\nVersion 3.15.1 (rgerhards), 2008-04-11\n- bugfix: some messages were emited without hostname\n- disabled atomic operations for the time being because they introduce some\n  cross-platform trouble - need to see how to fix this in the best \n  possible way\n- bugfix: zero-length strings were not supported in object\n  deserializer\n- added librelp check via PKG_CHECK thanks to Michael Biebl's patch\n- file relputil.c deleted, is not actually needed\n- added more meaningful error messages to rsyslogd (when some errors\n  happens during startup)\n- bugfix: memory leaks in script engine\n- bugfix: $hostname and $fromhost in RainerScript did not work\nThis release also includes all changes applied to the stable versions\nup to today.\n---------------------------------------------------------------------------\nVersion 3.15.0 (rgerhards), 2008-04-01\n- major new feature: imrelp/omrelp support reliable delivery of syslog\n  messages via the RELP protocol and librelp (http://www.librelp.com).\n  Plain tcp syslog, so far the best reliability solution, can lose\n  messages when something goes wrong or a peer goes down. With RELP,\n  this can no longer happen. See imrelp.html for more details.\n- bugfix: rsyslogd was no longer build by default; man pages are \n  only installed if corresponding option is selected. Thanks to\n  Michael Biebl for pointing these problems out.\n---------------------------------------------------------------------------\nVersion 3.14.2 (rgerhards), 2008-04-09\n- bugfix: segfault with expression-based filters\n- bugfix: omsnmp did not deref errmsg object on exit (no bad effects caused)\n- some cleanup\n- bugfix: imklog did not work well with kernel 2.6+. Thanks to Peter\n  Vrabec for patching it based on the development in sysklogd - and thanks\n  to the sysklogd project for upgrading klogd to support the new\n  functionality\n- some cleanup in imklog\n- bugfix: potential segfault in imklog when kernel is compiled without\n  /proc/kallsyms and the file System.map is missing. Thanks to\n  Andrea Morandi for pointing it out and suggesting a fix.\n- bugfixes, credits to varmojfekoj:\n  * reset errno before printing a warning message\n  * misspelled directive name in code processing legacy options\n- bugfix: some legacy options not correctly interpreted - thanks to\n  varmojfekoj for the patch\n- improved detection of modules being loaded more than once\n  thanks to varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 3.14.1 (rgerhards), 2008-04-04\n- bugfix: some messages were emited without hostname\n- bugfix: rsyslogd was no longer build by default; man pages are \n  only installed if corresponding option is selected. Thanks to\n  Michael Biebl for pointing these problems out.\n- bugfix: zero-length strings were not supported in object\n  deserializer\n- disabled atomic operations for this stable build as it caused\n  platform problems\n- bugfix: memory leaks in script engine\n- bugfix: $hostname and $fromhost in RainerScript did not work\n- bugfix: some memory leak when queue is runing in disk mode\n- man pages improved thanks to varmofekoj and Peter Vrabec\n- We have removed the 32 character size limit (from RFC3164) on the\n  tag. This had bad effects on existing envrionments, as sysklogd didn't\n  obey it either (probably another bug in RFC3164...). We now receive\n  the full size, but will modify the outputs so that only 32 characters\n  max are used by default. If you need large tags in the output, you need\n  to provide custom templates.\n- bugfix: some memory leak when queue is runing in disk mode\n---------------------------------------------------------------------------\nVersion 3.14.0 (rgerhards), 2008-04-02\nAn interim version was accidently released to the web. It was named 3.14.0.\nTo avoid confusion, we have not assigned this version number to any\nofficial release. If you happen to use 3.14.0, please update to 3.14.1.\n---------------------------------------------------------------------------\nVersion 3.13.0-dev0 (rgerhards), 2008-03-31\n- bugfix: accidently set debug option in 3.12.5 reset to production\n  This option prevented dlclose() to be called. It had no real bad effects,\n  as the modules were otherwise correctly deinitialized and dlopen()\n  supports multiple opens of the same module without any memory footprint.\n- removed --enable-mudflap, added --enable-valgrind ./configure setting\n- bugfix: tcp receiver could segfault due to uninitialized variable\n- docfix: queue doc had a wrong directive name that prevented max worker\n  threads to be correctly set\n- worked a bit on atomic memory operations to support problem-free\n  threading (only at non-intrusive places)\n- added a --enable/disable-rsyslogd configure option so that\n  source-based packaging systems can build plugins without the need\n  to compile rsyslogd\n- some cleanup\n- test of potential new version number scheme\n---------------------------------------------------------------------------\nVersion 3.12.5 (rgerhards), 2008-03-28\n- changed default for \"last message repeated n times\", which is now\n  off by default\n- implemented backward compatibility commandline option parsing\n- automatically generated compatibility config lines are now also\n  logged so that a user can diagnose problems with them\n- added compatibility mode for -a, -o and -p options\n- compatibility mode processing finished\n- changed default file output format to include high-precision timestamps\n- added a buid-in template for previous syslogd file format\n- added new $ActionFileDefaultTemplate directive\n- added support for high-precision timestamps when receiving legacy\n  syslog messages\n- added new $ActionForwardDefaultTemplate directive\n- added new $ActionGSSForwardDefaultTemplate directive\n- added build-in templates for easier configuration\n- bugfix: fixed small memory leak in tcpclt.c\n- bugfix: fixed small memory leak in template regular expressions\n- bugfix: regular expressions inside property replacer did not work\n  properly\n- bugfix: QHOUR and HHOUR properties were wrongly calculated\n- bugfix: fixed memory leaks in stream class and imfile\n- bugfix: $ModDir did invalid bounds checking, potential overlow in\n  dbgprintf() - thanks to varmojfekoj for the patch\n- bugfix: -t and -g legacy options max number of sessions had a wrong\n  and much too high value\n---------------------------------------------------------------------------\nVersion 3.12.4 (rgerhards), 2008-03-25\n- Greatly enhanced rsyslogd's file write performance by disabling\n  file syncing capability of output modules by default. This\n  feature is usually not required, not useful and an extreme performance\n  hit (both to rsyslogd as well as the system at large). Unfortunately,\n  most users enable it by default, because it was most intuitive to enable\n  it in plain old sysklogd syslog.conf format. There is now the\n  $ActionFileEnableSync config setting which must be enabled in order to\n  support syncing. By default it is off. So even if the old-format config\n  lines request syncing, it is not done unless explicitely enabled. I am\n  sure this is a very useful change and not a risk at all. I need to think\n  if I undo it under compatibility mode, but currently this does not\n  happen (I fear a lot of lazy users will run rsyslogd in compatibility\n  mode, again bringing up this performance problem...).\n- added flow control options to other input sources\n- added $HHOUR and $QHOUR system properties - can be used for half- and\n  quarter-hour logfile rotation\n- changed queue's discard severities default value to 8 (do not discard)\n  to prevent unintentional message loss\n- removed a no-longer needed callback from the output module \n  interface. Results in reduced code complexity.\n- bugfix/doc: removed no longer supported -h option from man page\n- bugfix: imklog leaked several hundered KB on each HUP. Thanks to\n  varmojfekoj for the patch\n- bugfix: potential segfault on module unload. Thanks to varmojfekoj for\n  the patch\n- bugfix: fixed some minor memory leaks\n- bugfix: fixed some slightly invalid memory accesses\n- bugfix: internally generated messages had \"FROMHOST\" property not set\n---------------------------------------------------------------------------\nVersion 3.12.3 (rgerhards), 2008-03-18\n- added advanced flow control for congestion cases (mode depending on message\n  source and its capablity to be delayed without bad side effects)\n- bugfix: $ModDir should not be reset on $ResetConfig - this can cause a lot\n  of confusion and there is no real good reason to do so. Also conflicts with\n  the new -M option and environment setting.\n- bugfix: TCP and GSSAPI framing mode variable was uninitialized, leading to\n  wrong framing (caused, among others, interop problems)\n- bugfix: TCP (and GSSAPI) octet-counted frame did not work correctly in all\n  situations. If the header was split across two packet reads, it was invalidly\n  processed, causing loss or modification of messages.\n- bugfix: memory leak in imfile\n- bugfix: duplicate public symbol in omfwd and omgssapi could lead to\n  segfault. thanks to varmojfekoj for the patch.\n- bugfix: rsyslogd aborted on sigup - thanks to varmojfekoj for the patch\n- some more internal cleanup ;)\n- begun relp modules, but these are not functional yet\n- Greatly enhanced rsyslogd's file write performance by disabling\n  file syncing capability of output modules by default. This\n  feature is usually not required, not useful and an extreme performance\n  hit (both to rsyslogd as well as the system at large). Unfortunately,\n  most users enable it by default, because it was most intuitive to enable\n  it in plain old sysklogd syslog.conf format. There is now a new config\n  setting which must be enabled in order to support syncing. By default it\n  is off. So even if the old-format config lines request syncing, it is\n  not done unless explicitely enabled. I am sure this is a very useful\n  change and not a risk at all. I need to think if I undo it under\n  compatibility mode, but currently this does not happen (I fear a lot of\n  lazy users will run rsyslogd in compatibility mode, again bringing up\n  this performance problem...).\n---------------------------------------------------------------------------\nVersion 3.12.2 (rgerhards), 2008-03-13\n- added RSYSLOGD_MODDIR environment variable\n- added -M rsyslogd option (allows to specify module directory location)\n- converted net.c into a loadable library plugin\n- bugfix: debug module now survives unload of loadable module when\n  printing out function call data\n- bugfix: not properly initialized data could cause several segfaults if\n  there were errors in the config file - thanks to varmojfekoj for the patch\n- bugfix: rsyslogd segfaulted when imfile read an empty line - thanks\n  to Johnny Tan for an excellent bug report\n- implemented dynamic module unload capability (not visible to end user)\n- some more internal cleanup\n- bugfix: imgssapi segfaulted under some conditions; this fix is actually\n  not just a fix but a change in the object model. Thanks to varmojfekoj\n  for providing the bug report, an initial fix and lots of good discussion\n  that lead to where we finally ended up.\n- improved session recovery when outbound tcp connection breaks, reduces\n  probability of message loss at the price of a highly unlikely potential\n  (single) message duplication\n---------------------------------------------------------------------------\nVersion 3.12.1 (rgerhards), 2008-03-06\n- added library plugins, which can be automatically loaded\n- bugfix: actions were not correctly retried; caused message loss\n- changed module loader to automatically add \".so\" suffix if not\n  specified (over time, this shall also ease portability of config\n  files)\n- improved debugging support; debug runtime options can now be set via\n  an environment variable\n- bugfix: removed debugging code that I forgot to remove before releasing\n  3.12.0 (does not cause harm and happened only during startup)\n- added support for the MonitorWare syslog MIB to omsnmp\n- internal code improvements (more code converted into classes)\n- internal code reworking of the imtcp/imgssapi module\n- added capability to ignore client-provided timestamp on unix sockets and\n  made this mode the default; this was needed, as some programs (e.g. sshd)\n  log with inconsistent timezone information, what messes up the local\n  logs (which by default don't even contain time zone information). This\n  seems to be consistent with what sysklogd did for the past four years.\n  Alternate behaviour may be desirable if gateway-like processes send\n  messages via the local log slot - in this case, it can be enabled\n  via the $InputUnixListenSocketIgnoreMsgTimestamp and\n  $SystemLogSocketIgnoreMsgTimestamp config directives\n- added ability to compile on HP UX; verified that imudp worked on HP UX;\n  however, we are still in need of people trying out rsyslogd on HP UX,\n  so it can not yet be assumed it runs there\n- improved session recovery when outbound tcp connection breaks, reduces\n  probability of message loss at the price of a highly unlikely potential\n  (single) message duplication\n---------------------------------------------------------------------------\nVersion 3.12.0 (rgerhards), 2008-02-28\n- added full expression support for filters; filters can now contain\n  arbitrary complex boolean, string and arithmetic expressions\n---------------------------------------------------------------------------\nVersion 3.11.6 (rgerhards), 2008-02-27\n- bugfix: gssapi libraries were still linked to rsyslog core, what should\n  no longer be necessary. Applied fix by Michael Biebl to solve this.\n- enabled imgssapi to be loaded side-by-side with imtcp\n- added InputGSSServerPermitPlainTCP config directive\n- split imgssapi source code somewhat from imtcp\n- bugfix: queue cancel cleanup handler could be called with\n  invalid pointer if dequeue failed\n- bugfix: rsyslogd segfaulted on second SIGHUP\n  tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=38\n- improved stability of queue engine\n- bugfix: queue disk file were not properly persisted when \n  immediately after closing an output file rsyslog was stopped\n  or huped (the new output file open must NOT have happend at\n  that point) - this lead to a sparse and invalid queue file\n  which could cause several problems to the engine (unpredictable\n  results). This situation should have happened only in very\n  rare cases. tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=40\n- bugfix: during queue shutdown, an assert invalidly triggered when\n  the primary queue's DA worker was terminated while the DA queue's\n  regular worker was still executing. This could result in a segfault\n  during shutdown.\n  tracker: http://bugzilla.adiscon.com/show_bug.cgi?id=41\n- bugfix: queue properties sizeOnDisk, bytesRead were persisted to \n  disk with wrong data type (long instead of int64) - could cause\n  problems on 32 bit machines\n- bugfix: queue aborted when it was shut down, DA-enabled, DA mode\n  was just initiated but not fully initialized (a race condition)\n- bugfix: imfile could abort under extreme stress conditions\n  (when it was terminated before it could open all of its\n  to be monitored files)\n- applied patch from varmojfekoj to fix an issue with compatibility \n  mode and default module directories (many thanks!):\n  I've also noticed a bug in the compatibility code; the problem is that \n  options are parsed before configuration file so options which need a \n  module to be loaded will currently ignore any $moddir directive. This \n  can be fixed by moving legacyOptsHook() after config file parsing. \n  (see the attached patch) This goes against the logical order of \n  processing, but the legacy options are only few and it doesn't seem to \n  be a problem.\n- bugfix: object property deserializer did not handle negative numbers\n---------------------------------------------------------------------------\nVersion 3.11.5 (rgerhards), 2008-02-25\n- new imgssapi module, changed imtcp module - this enables to load/package\n  GSSAPI support separately - thanks to varmojfekoj for the patch\n- compatibility mode (the -c option series) is now at least partly\n  completed - thanks to varmojfekoj for the patch\n- documentation for imgssapi and imtcp added\n- duplicate $ModLoad's for the same module are now detected and\n  rejected -- thanks to varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 3.11.4 (rgerhards), 2008-02-21\n- bugfix: debug.html was missing from release tarball - thanks to Michael\n  Biebl for bringing this to my attention\n- some internal cleanup on the stringbuf object calling interface\n- general code cleanup and further modularization\n- $MainMessageQueueDiscardSeverity can now also handle textual severities\n  (previously only integers)\n- bugfix: message object was not properly synchronized when the \n  main queue had a single thread and non-direct action queues were used\n- some documentation improvements\n---------------------------------------------------------------------------\nVersion 3.11.3 (rgerhards), 2008-02-18\n- fixed a bug in imklog which lead to duplicate message content in\n  kernel logs\n- added support for better plugin handling in libdbi (we contributed\n  a patch to do that, we just now need to wait for the next libdbi\n  version)\n- bugfix: fixed abort when invalid template was provided to an action\n  bug http://bugzilla.adiscon.com/show_bug.cgi?id=4\n- re-instantiated SIGUSR1 function; added SIGUSR2 to generate debug\n  status output\n- added some documentation on runtime-debug settings\n- slightly improved man pages for novice users\n---------------------------------------------------------------------------\nVersion 3.11.2 (rgerhards), 2008-02-15\n- added the capability to monitor text files and process their content\n  as syslog messages (including forwarding)\n- added support for libdbi, a database abstraction layer. rsyslog now\n  also supports the following databases via dbi drivers:\n  * Firebird/Interbase\n  * FreeTDS (access to MS SQL Server and Sybase)\n  * SQLite/SQLite3\n  * Ingres (experimental)\n  * mSQL (experimental)\n  * Oracle (experimental)\n  Additional drivers may be provided by the libdbi-drivers project, which\n  can be used by rsyslog as soon as they become available.\n- removed some left-over unnecessary dbgprintf's (cluttered screen,\n  cosmetic)\n- doc bugfix: html documentation for omsnmp was missing\n---------------------------------------------------------------------------\nVersion 3.11.1 (rgerhards), 2008-02-12\n- SNMP trap sender added thanks to Andre Lorbach (omsnmp)\n- added input-plugin interface specification in form of a (copy) template\n  input module\n- applied documentation fix by Michael Biebl -- many thanks!\n- bugfix: immark did not have MARK flags set...\n- added x-info field to rsyslogd startup/shutdown message. Hopefully\n  points users to right location for further info (many don't even know\n  they run rsyslog ;))\n- bugfix: trailing \":\" of tag was lost while parsing legacy syslog messages\n  without timestamp - thanks to Anders Blomdell for providing a patch!\n- fixed a bug in stringbuf.c related to STRINGBUF_TRIM_ALLOCSIZE, which\n  wasn't supposed to be used with rsyslog. Put a warning message up that\n  tells this feature is not tested and probably not worth the effort.\n  Thanks to Anders Blomdell fro bringing this to our attention\n- somewhat improved performance of string buffers\n- fixed bug that caused invalid treatment of tabs (HT) in rsyslog.conf\n- bugfix: setting for $EscapeCopntrolCharactersOnReceive was not \n  properly initialized\n- clarified usage of space-cc property replacer option\n- improved abort diagnostic handler\n- some initial effort for malloc/free runtime debugging support\n- bugfix: using dynafile actions caused rsyslogd abort\n- fixed minor man errors thanks to Michael Biebl\n---------------------------------------------------------------------------\nVersion 3.11.0 (rgerhards), 2008-01-31\n- implemented queued actions\n- implemented simple rate limiting for actions\n- implemented deliberate discarding of lower priority messages over higher\n  priority ones when a queue runs out of space\n- implemented disk quotas for disk queues\n- implemented the $ActionResumeRetryCount config directive\n- added $ActionQueueFilename config directive\n- added $ActionQueueSize config directive\n- added $ActionQueueHighWaterMark config directive\n- added $ActionQueueLowWaterMark config directive\n- added $ActionQueueDiscardMark config directive\n- added $ActionQueueDiscardSeverity config directive\n- added $ActionQueueCheckpointInterval config directive\n- added $ActionQueueType config directive\n- added $ActionQueueWorkerThreads config directive\n- added $ActionQueueTimeoutshutdown config directive\n- added $ActionQueueTimeoutActionCompletion config directive\n- added $ActionQueueTimeoutenQueue config directive\n- added $ActionQueueTimeoutworkerThreadShutdown config directive\n- added $ActionQueueWorkerThreadMinimumMessages config directive\n- added $ActionQueueMaxFileSize config directive\n- added $ActionQueueSaveonShutdown config directive\n- addded $ActionQueueDequeueSlowdown config directive\n- addded $MainMsgQueueDequeueSlowdown config directive\n- bugfix: added forgotten docs to package\n- improved debugging support\n- fixed a bug that caused $MainMsgQueueCheckpointInterval to work incorrectly\n- when a long-running action needs to be cancelled on shutdown, the message\n  that was processed by it is now preserved. This finishes support for\n  guaranteed delivery of messages (if the output supports it, of course)\n- fixed bug in output module interface, see\n  http://sourceforge.net/tracker/index.php?func=detail&aid=1881008&group_id=123448&atid=696552\n- changed the ommysql output plugin so that the (lengthy) connection\n  initialization now takes place in message processing. This works much\n  better with the new queued action mode (fast startup)\n- fixed a bug that caused a potential hang in file and fwd output module\n  varmojfekoj provided the patch - many thanks!\n- bugfixed stream class offset handling on 32bit platforms\n---------------------------------------------------------------------------\nVersion 3.10.3 (rgerhards), 2008-01-28\n- fixed a bug with standard template definitions (not a big deal) - thanks\n  to varmojfekoj for spotting it\n- run-time instrumentation added\n- implemented disk-assisted queue mode, which enables on-demand disk\n  spooling if the queue's in-memory queue is exhausted\n- implemented a dynamic worker thread pool for processing incoming\n  messages; workers are started and shut down as need arises\n- implemented a run-time instrumentation debug package\n- implemented the $MainMsgQueueSaveOnShutdown config directive\n- implemented the $MainMsgQueueWorkerThreadMinimumMessages config directive\n- implemented the $MainMsgQueueTimeoutWorkerThreadShutdown config directive\n---------------------------------------------------------------------------\nVersion 3.10.2 (rgerhards), 2008-01-14\n- added the ability to keep stop rsyslogd without the need to drain\n  the main message queue. In disk queue mode, rsyslog continues to\n  run from the point where it stopped. In case of a system failure, it\n  continues to process messages from the last checkpoint.\n- fixed a bug that caused a segfault on startup when no $WorkDir directive\n  was specified in rsyslog.conf\n- provided more fine-grain control over shutdown timeouts and added a\n  way to specify the enqueue timeout when the main message queue is full\n- implemented $MainMsgQueueCheckpointInterval config directive\n- implemented $MainMsgQueueTimeoutActionCompletion config directive\n- implemented $MainMsgQueueTimeoutEnqueue config directive\n- implemented $MainMsgQueueTimeoutShutdown config directive\n---------------------------------------------------------------------------\nVersion 3.10.1 (rgerhards), 2008-01-10\n- implemented the \"disk\" queue mode. However, it currently is of very\n  limited use, because it does not support persistence over rsyslogd\n  runs. So when rsyslogd is stopped, the queue is drained just as with\n  the in-memory queue modes. Persistent queues will be a feature of\n  the next release.\n- performance-optimized string class, should bring an overall improvement\n- fixed a memory leak in imudp -- thanks to varmojfekoj for the patch\n- fixed a race condition that could lead to a rsyslogd hang when during\n  HUP or termination\n- done some doc updates\n- added $WorkDirectory config directive\n- added $MainMsgQueueFileName config directive\n- added $MainMsgQueueMaxFileSize config directive\n---------------------------------------------------------------------------\nVersion 3.10.0 (rgerhards), 2008-01-07\n- implemented input module interface and initial input modules\n- enhanced threading for input modules (each on its own thread now)\n- ability to bind UDP listeners to specific local interfaces/ports and\n  ability to run multiple of them concurrently\n- added ability to specify listen IP address for UDP syslog server\n- license changed to GPLv3\n- mark messages are now provided by loadble module immark\n- rklogd is no longer provided. Its functionality has now been taken over\n  by imklog, a loadable input module. This offers a much better integration\n  into rsyslogd and makes sure that the kernel logger process is brought\n  up and down at the appropriate times\n- enhanced $IncludeConfig directive to support wildcard characters\n  (thanks to Michael Biebl)\n- all inputs are now implemented as loadable plugins\n- enhanced threading model: each input module now runs on its own thread\n- enhanced message queue which now supports different queueing methods\n  (among others, this can be used for performance fine-tuning)\n- added a large number of new configuration directives for the new\n  input modules\n- enhanced multi-threading utilizing a worker thread pool for the\n  main message queue\n- compilation without pthreads is no longer supported\n- much cleaner code due to new objects and removal of single-threading\n  mode\n---------------------------------------------------------------------------\nVersion 2.0.8 V2-STABLE (rgerhards), 2008-??-??\n- bugfix: ompgsql did not detect problems in sql command execution\n  this could cause loss of messages. The handling was correct if the\n  connection broke, but not if there was a problem with statement\n  execution. The most probable case for such a case would be invalid\n  sql inside the template, and this is now much easier to diagnose.\n- doc bugfix: default for $DirCreateMode incorrectly stated\n---------------------------------------------------------------------------\nVersion 2.0.7 V2-STABLE (rgerhards), 2008-04-14\n- bugfix: the default for $DirCreateMode was 0644, and as such wrong.\n  It has now been changed to 0700. For some background, please see\n  http://lists.adiscon.net/pipermail/rsyslog/2009-April/001986.html\n- bugfix: \"$CreateDirs off\" also disabled file creation\n  Thanks to William Tisater for analyzing this bug and providing a patch.\n  The actual code change is heavily based on William's patch.\n- bugfix: memory leak in ompgsql\n  Thanks to Ken for providing the patch\n- bugfix: potential memory leak in msg.c\n  This one did not surface yet and the issue was actually found due to\n  a problem in v4 - but better fix it here, too\n---------------------------------------------------------------------------\nVersion 2.0.6 V2-STABLE (rgerhards), 2008-08-07\n- bugfix: memory leaks in rsyslogd, primarily in singlethread mode\n  Thanks to Frederico Nunez for providing the fix\n- bugfix: copy&paste error lead to dangling if - this caused a very minor\n  issue with re-formatting a RFC3164 date when the message was invalidly\n  formatted and had a colon immediately after the date. This was in the\n  code for some years (even v1 had it) and I think it never had any\n  effect at all in practice. Though, it should be fixed - but definitely\n  nothing to worry about.\n---------------------------------------------------------------------------\nVersion 2.0.6 V2-STABLE (rgerhards), 2008-08-07\n- bugfix: IPv6 addresses could not be specified in forwarding actions\n  New syntax @[addr]:port introduced to enable that. Root problem was IPv6\n  addresses contain colons. (backport from 3.21.3)\n---------------------------------------------------------------------------\nVersion 2.0.5 STABLE (rgerhards), 2008-05-15\n- bugfix: regular expressions inside property replacer did not work\n  properly\n- adapted to liblogging 0.7.1+\n---------------------------------------------------------------------------\nVersion 2.0.4 STABLE (rgerhards), 2008-03-27\n- bugfix: internally generated messages had \"FROMHOST\" property not set\n- bugfix: continue parsing if tag is oversize (discard oversize part) - thanks\n  to mclaughlin77@gmail.com for the patch\n- added $HHOUR and $QHOUR system properties - can be used for half- and\n  quarter-hour logfile rotation\n---------------------------------------------------------------------------\nVersion 2.0.3 STABLE (rgerhards), 2008-03-12\n- bugfix: setting for $EscapeCopntrolCharactersOnReceive was not \n  properly initialized\n- bugfix: resolved potential segfault condition on HUP (extremely\n  unlikely to happen in practice), for details see tracker:\n  http://bugzilla.adiscon.com/show_bug.cgi?id=38\n- improved the man pages a bit - thanks to Michael Biebl for the patch\n- bugfix: not properly initialized data could cause several segfaults if\n  there were errors in the config file - thanks to varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 2.0.2 STABLE (rgerhards), 2008-02-12\n- fixed a bug that could cause invalid string handling via strerror_r\n  varmojfekoj provided the patch - many thanks!\n- added x-info field to rsyslogd startup/shutdown message. Hopefully\n  points users to right location for further info (many don't even know\n  they run rsyslog ;))\n- bugfix: suspended actions were not always properly resumed\n  varmojfekoj provided the patch - many thanks!\n- bugfix: errno could be changed during mark processing, leading to\n  invalid error messages when processing inputs. Thank to varmojfekoj for\n  pointing out this problem.\n- bugfix: trailing \":\" of tag was lost while parsing legacy syslog messages\n  without timestamp - thanks to Anders Blomdell for providing a patch!\n- bugfix (doc): misspelled config directive, invalid signal info\n- applied some doc fixes from Michel Biebl and cleaned up some no longer\n  needed files suggested by him\n- cleaned up stringbuf.c to fix an annoyance reported by Anders Blomdell\n- fixed bug that caused invalid treatment of tabs (HT) in rsyslog.conf\n---------------------------------------------------------------------------\nVersion 2.0.1 STABLE (rgerhards), 2008-01-24\n- fixed a bug in integer conversion - but this function was never called,\n  so it is not really a useful bug fix ;)\n- fixed a bug with standard template definitions (not a big deal) - thanks\n  to varmojfekoj for spotting it\n- fixed a bug that caused a potential hang in file and fwd output module\n  varmojfekoj provided the patch - many thanks!\n---------------------------------------------------------------------------\nVersion 2.0.0 STABLE (rgerhards), 2008-01-02\n- re-release of 1.21.2 as STABLE with no modifications except some\n  doc updates\n---------------------------------------------------------------------------\nVersion 1.21.2 (rgerhards), 2007-12-28\n- created a gss-api output module. This keeps GSS-API code and\n  TCP/UDP code separated. It is also important for forward-\n  compatibility with v3. Please note that this change breaks compatibility\n  with config files created for 1.21.0 and 1.21.1 - this was considered\n  acceptable.\n- fixed an error in forwarding retry code (could lead to message corruption\n  but surfaced very seldom)\n- increased portability for older platforms (AI_NUMERICSERV moved)\n- removed socket leak in omfwd.c\n- cross-platform patch for GSS-API compile problem on some platforms\n  thanks to darix for the patch!\n---------------------------------------------------------------------------\nVersion 1.21.1 (rgerhards), 2007-12-23\n- small doc fix for $IncludeConfig\n- fixed a bug in llDestroy()\n- bugfix: fixing memory leak when message queue is full and during\n  parsing. Thanks to varmojfekoj for the patch.\n- bugfix: when compiled without network support, unix sockets were\n  not properply closed\n- bugfix: memory leak in cfsysline.c/doGetWord() fixed\n---------------------------------------------------------------------------\nVersion 1.21.0 (rgerhards), 2007-12-19\n- GSS-API support for syslog/TCP connections was added. Thanks to\n  varmojfekoj for providing the patch with this functionality\n- code cleanup\n- enhanced $IncludeConfig directive to support wildcard filenames\n- changed some multithreading synchronization\n---------------------------------------------------------------------------\nVersion 1.20.1 (rgerhards), 2007-12-12\n- corrected a debug setting that survived release. Caused TCP connections\n  to be retried unnecessarily often.\n- When a hostname ACL was provided and DNS resolution for that name failed,\n  ACL processing was stopped at that point. Thanks to mildew for the patch.\n  Fedora Bugzilla: http://bugzilla.redhat.com/show_bug.cgi?id=395911\n- fixed a potential race condition, see link for details:\n  http://rgerhards.blogspot.com/2007/12/rsyslog-race-condition.html\n  Note that the probability of problems from this bug was very remote\n- fixed a memory leak that happend when PostgreSQL date formats were\n  used\n---------------------------------------------------------------------------\nVersion 1.20.0 (rgerhards), 2007-12-07\n- an output module for postgres databases has been added. Thanks to\n  sur5r for contributing this code\n- unloading dynamic modules has been cleaned up, we now have a\n  real implementation and not just a dummy \"good enough for the time\n  being\".\n- enhanced platform independence - thanks to Bartosz Kuzma and Michael\n  Biebl for their very useful contributions\n- some general code cleanup (including warnings on 64 platforms, only)\n---------------------------------------------------------------------------\nVersion 1.19.12 (rgerhards), 2007-12-03\n- cleaned up the build system (thanks to Michael Biebl for the patch)\n- fixed a bug where ommysql was still not compiled with -pthread option\n---------------------------------------------------------------------------\nVersion 1.19.11 (rgerhards), 2007-11-29\n- applied -pthread option to build when building for multi-threading mode\n  hopefully solves an issue with segfaulting\n---------------------------------------------------------------------------\nVersion 1.19.10 (rgerhards), 2007-10-19\n- introdcued the new \":modulename:\" syntax for calling module actions\n  in selector lines; modified ommysql to support it. This is primarily\n  an aid for further modules and a prequisite to actually allow third\n  party modules to be created.\n- minor fix in slackware startup script, \"-r 0\" is now \"-r0\"\n- updated rsyslogd doc set man page; now in html format\n- undid creation of a separate thread for the main loop -- this did not\n  turn out to be needed or useful, so reduce complexity once again.\n- added doc fixes provided by Michael Biebl - thanks\n---------------------------------------------------------------------------\nVersion 1.19.9 (rgerhards), 2007-10-12\n- now packaging system which again contains all components in a single\n  tarball\n- modularized main() a bit more, resulting in less complex code\n- experimentally added an additional thread - will see if that affects\n  the segfault bug we experience on some platforms. Note that this change\n  is scheduled to be removed again later.\n---------------------------------------------------------------------------\nVersion 1.19.8 (rgerhards), 2007-09-27\n- improved repeated message processing\n- applied patch provided by varmojfekoj to support building ommysql\n  in its own way (now also resides in a plugin subdirectory);\n  ommysql is now a separate package\n- fixed a bug in cvthname() that lead to message loss if part\n  of the source hostname would have been dropped\n- created some support for distributing ommysql together with the\n  main rsyslog package. I need to re-think it in the future, but\n  for the time being the current mode is best. I now simply include\n  one additional tarball for ommysql inside the main distribution.\n  I look forward to user feedback on how this should be done best. In the\n  long term, a separate project should be spawend for ommysql, but I'd\n  like to do that only after the plugin interface is fully stable (what\n  it is not yet).\n---------------------------------------------------------------------------\nVersion 1.19.7 (rgerhards), 2007-09-25\n- added code to handle situations where senders send us messages ending with\n  a NUL character. It is now simply removed. This also caused trailing LF\n  reduction to fail, when it was followed by such a NUL. This is now also\n  handled.\n- replaced some non-thread-safe function calls by their thread-safe\n  counterparts\n- fixed a minor memory leak that occured when the %APPNAME% property was\n  used (I think nobody used that in practice)\n- fixed a bug that caused signal handlers in cvthname() not to be restored when\n  a malicious pointer record was detected and processing of the message been\n  stopped for that reason (this should be really rare and can not be related\n  to the segfault bug we are hunting).\n- fixed a bug in cvthname that lead to passing a wrong parameter - in\n  practice, this had no impact.\n- general code cleanup (e.g. compiler warnings, comments)\n---------------------------------------------------------------------------\nVersion 1.19.6 (rgerhards), 2007-09-11\n- applied patch by varmojfekoj to change signal handling to the new\n  sigaction API set (replacing the depreciated signal() calls and its\n  friends.\n- fixed a bug that in --enable-debug mode caused an assertion when the\n  discard action was used\n- cleaned up compiler warnings\n- applied patch by varmojfekoj to FIX a bug that could cause \n  segfaults if empty properties were processed using modifying\n  options (e.g. space-cc, drop-cc)\n- fixed man bug: rsyslogd supports -l option\n---------------------------------------------------------------------------\nVersion 1.19.5 (rgerhards), 2007-09-07\n- changed part of the CStr interface so that better error tracking\n  is provided and the calling sequence is more intuitive (there were\n  invalid calls based on a too-weired interface)\n- (hopefully) fixed some remaining bugs rooted in wrong use of \n  the CStr class. These could lead to program abort.\n- applied patch by varmojfekoj two fix two potential segfault situations\n- added $ModDir config directive\n- modified $ModLoad so that an absolute path may be specified as\n  module name (e.g. /rsyslog/ommysql.so)\n---------------------------------------------------------------------------\nVersion 1.19.4 (rgerhards/varmojfekoj), 2007-09-04\n- fixed a number of small memory leaks - thanks varmojfekoj for patching\n- fixed an issue with CString class that could lead to rsyslog abort\n  in tplToString() - thanks varmojfekoj for patching\n- added a man-version of the config file documenation - thanks to Michel\n  Samia for providing the man file\n- fixed bug: a template like this causes an infinite loop:\n  $template opts,\"%programname:::a,b%\"\n  thanks varmojfekoj for the patch\n- fixed bug: case changing options crash freeing the string pointer\n  because they modify it: $template opts2,\"%programname::1:lowercase%\"\n  thanks varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 1.19.3 (mmeckelein/varmojfekoj), 2007-08-31\n- small mem leak fixed (after calling parseSelectorAct) - Thx varmojkekoj\n- documentation section \"Regular File\" und \"Blocks\" updated\n- solved an issue with dynamic file generation - Once again many thanks\n  to varmojfekoj\n- the negative selector for program name filter (Blocks) does not work as\n  expected - Thanks varmojfekoj for patching\n- added forwarding information to sysklogd (requires special template)\n  to config doc\n---------------------------------------------------------------------------\nVersion 1.19.2 (mmeckelein/varmojfekoj), 2007-08-28\n- a specifically formed message caused a segfault - Many thanks varmojfekoj\n  for providing a patch\n- a typo and a weird condition are fixed in msg.c - Thanks again\n  varmojfekoj \n- on file creation the file was always owned by root:root. This is fixed\n  now - Thanks ypsa for solving this issue\n---------------------------------------------------------------------------\nVersion 1.19.1 (mmeckelein), 2007-08-22\n- a bug that caused a high load when a TCP/UDP connection was closed is \n  fixed now - Thanks mildew for solving this issue\n- fixed a bug which caused a segfault on reinit - Thx varmojfekoj for the\n  patch\n- changed the hardcoded module path \"/lib/rsyslog\" to $(pkglibdir) in order\n  to avoid trouble e.g. on 64 bit platforms (/lib64) - many thanks Peter\n  Vrabec and darix, both provided a patch for solving this issue\n- enhanced the unloading of modules - thanks again varmojfekoj\n- applied a patch from varmojfekoj which fixes various little things in\n  MySQL output module\n---------------------------------------------------------------------------\nVersion 1.19.0 (varmojfekoj/rgerhards), 2007-08-16\n- integrated patch from varmojfekoj to make the mysql module a loadable one\n  many thanks for the patch, MUCH appreciated\n---------------------------------------------------------------------------\nVersion 1.18.2 (rgerhards), 2007-08-13\n- fixed a bug in outchannel code that caused templates to be incorrectly\n  parsed\n- fixed a bug in ommysql that caused a wrong \";template\" missing message\n- added some code for unloading modules; not yet fully complete (and we do\n  not yet have loadable modules, so this is no problem)\n- removed debian subdirectory by request of a debian packager (this is a special\n  subdir for debian and there is also no point in maintaining it when there\n  is a debian package available - so I gladly did this) in some cases\n- improved overall doc quality (some pages were quite old) and linked to\n  more of the online resources.\n- improved /contrib/delete_mysql script by adding a host option and some\n  other minor modifications\n---------------------------------------------------------------------------\nVersion 1.18.1 (rgerhards), 2007-08-08\n- applied a patch from varmojfekoj which solved a potential segfault\n  of rsyslogd on HUP\n- applied patch from Michel Samia to fix compilation when the pthreads\n  feature is disabled\n- some code cleanup (moved action object to its own file set)\n- add config directive $MainMsgQueueSize, which now allows to configure the\n  queue size dynamically\n- all compile-time settings are now shown in rsyslogd -v, not just the\n  active ones\n- enhanced performance a little bit more\n- added config file directive $ActionResumeInterval\n- fixed a bug that prevented compilation under debian sid\n- added a contrib directory for user-contributed useful things\n---------------------------------------------------------------------------\nVersion 1.18.0 (rgerhards), 2007-08-03\n- rsyslog now supports fallback actions when an action did not work. This\n  is a great feature e.g. for backup database servers or backup syslog\n  servers\n- modified rklogd to only change the console log level if -c is specified\n- added feature to use multiple actions inside a single selector\n- implemented $ActionExecOnlyWhenPreviousIsSuspended config directive\n- error messages during startup are now spit out to the configured log\n  destinations\n---------------------------------------------------------------------------\nVersion 1.17.6 (rgerhards), 2007-08-01\n- continued to work on output module modularization - basic stage of\n  this work is now FINISHED\n- fixed bug in OMSRcreate() - always returned SR_RET_OK\n- fixed a bug that caused ommysql to always complain about missing\n  templates\n- fixed a mem leak in OMSRdestruct - freeing the object itself was\n  forgotten - thanks to varmojfekoj for the patch\n- fixed a memory leak in syslogd/init() that happend when the config\n  file could not be read - thanks to varmojfekoj for the patch\n- fixed insufficient memory allocation in addAction() and its helpers.\n  The initial fix and idea was developed by mildew, I fine-tuned\n  it a bit. Thanks a lot for the fix, I'd probably had pulled out my\n  hair to find the bug...\n- added output of config file line number when a parsing error occured\n- fixed bug in objomsr.c that caused program to abort in debug mode with\n  an invalid assertion (in some cases)\n- fixed a typo that caused the default template for MySQL to be wrong.\n  thanks to mildew for catching this.\n- added configuration file command $DebugPrintModuleList and\n  $DebugPrintCfSysLineHandlerList\n- fixed an invalid value for the MARK timer - unfortunately, there was\n  a testing aid left in place. This resulted in quite frequent MARK messages\n- added $IncludeConfig config directive\n- applied a patch from mildew to prevent rsyslogd from freezing under heavy\n  load. This could happen when the queue was full. Now, we drop messages\n  but rsyslogd remains active.\n---------------------------------------------------------------------------\nVersion 1.17.5 (rgerhards), 2007-07-30\n- continued to work on output module modularization\n- fixed a missing file bug - thanks to Andrea Montanari for reporting\n  this problem\n- fixed a problem with shutting down the worker thread and freeing the\n  selector_t list - this caused messages to be lost, because the\n  message queue was not properly drained before the selectors got\n  destroyed.\n---------------------------------------------------------------------------\nVersion 1.17.4 (rgerhards), 2007-07-27\n- continued to work on output module modularization\n- fixed a situation where rsyslogd could create zombie processes\n  thanks to mildew for the patch\n- applied patch from Michel Samia to fix compilation when NOT\n  compiled for pthreads\n---------------------------------------------------------------------------\nVersion 1.17.3 (rgerhards), 2007-07-25\n- continued working on output module modularization\n- fixed a bug that caused rsyslogd to segfault on exit (and\n  probably also on HUP), when there was an unsent message in a selector\n  that required forwarding and the dns lookup failed for that selector\n  (yes, it was pretty unlikely to happen;))\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- fixed a memory leak in config file parsing and die()\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- rsyslogd now checks on startup if it is capable to performa any work\n  at all. If it cant, it complains and terminates\n  thanks to Michel Samia for providing the patch!\n- fixed a small memory leak when HUPing syslogd. The allowed sender\n  list now gets freed. thanks to mildew for the patch.\n- changed the way error messages in early startup are logged. They\n  now do no longer use the syslogd code directly but are rather\n  send to stderr.\n---------------------------------------------------------------------------\nVersion 1.17.2 (rgerhards), 2007-07-23\n- made the port part of the -r option optional. Needed for backward\n  compatibility with sysklogd\n- replaced system() calls with something more reasonable. Please note that\n  this might break compatibility with some existing configuration files.\n  We accept this in favour of the gained security.\n- removed a memory leak that could occur if timegenerated was used in\n  RFC 3164 format in templates\n- did some preparation in msg.c for advanced multithreading - placed the\n  hooks, but not yet any active code\n- worked further on modularization\n- added $ModLoad MySQL (dummy) config directive\n- added DropTrailingLFOnReception config directive\n---------------------------------------------------------------------------\nVersion 1.17.1 (rgerhards), 2007-07-20\n- fixed a bug that caused make install to install rsyslogd and rklogd under\n  the wrong names\n- fixed bug that caused $AllowedSenders to handle IPv6 scopes incorrectly;\n  also fixed but that could grabble $AllowedSender wildcards. Thanks to\n  mildew@gmail.com for the patch\n- minor code cleanup - thanks to Peter Vrabec for the patch\n- fixed minimal memory leak on HUP (caused by templates)\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- fixed another memory leak on HUPing and on exiting rsyslogd\n  again thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- code cleanup (removed compiler warnings)\n- fixed portability bug in configure.ac - thanks to Bartosz Ku\u017ama for patch\n- moved msg object into its own file set\n- added the capability to continue trying to write log files when the\n  file system is full. Functionality based on patch by Martin Schulze\n  to sysklogd package.\n---------------------------------------------------------------------------\nVersion 1.17.0 (RGer), 2007-07-17\n- added $RepeatedLineReduction config parameter\n- added $EscapeControlCharactersOnReceive config parameter\n- added $ControlCharacterEscapePrefix config parameter\n- added $DirCreateMode config parameter\n- added $CreateDirs config parameter\n- added $DebugPrintTemplateList config parameter\n- added $ResetConfigVariables config parameter\n- added $FileOwner config parameter\n- added $FileGroup config parameter\n- added $DirOwner config parameter\n- added $DirGroup config parameter\n- added $FailOnChownFailure config parameter\n- added regular expression support to the filter engine\n  thanks to Michel Samia for providing the patch!\n- enhanced $AllowedSender functionality. Credits to mildew@gmail.com for\n  the patch doing that\n  - added IPv6 support\n  - allowed DNS hostnames\n  - allowed DNS wildcard names\n- added new option $DropMsgsWithMaliciousDnsPTRRecords\n- added autoconf so that rfc3195d, rsyslogd and klogd are stored to /sbin\n- added capability to auto-create directories with dynaFiles\n---------------------------------------------------------------------------\nVersion 1.16.0 (RGer/Peter Vrabec), 2007-07-13 - The Friday, 13th Release ;)\n- build system switched to autotools\n- removed SYSV preprocessor macro use, replaced with autotools equivalents\n- fixed a bug that caused rsyslogd to segfault when TCP listening was\n  disabled and it terminated\n- added new properties \"syslogfacility-text\" and \"syslogseverity-text\"\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- added the -x option to disable hostname dns reslution\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- begun to better modularize syslogd.c - this is an ongoing project; moved\n  type definitions to a separate file\n- removed some now-unused fields from struct filed\n- move file size limit fields in struct field to the \"right spot\" (the file\n  writing part of the union - f_un.f_file)\n- subdirectories linux and solaris are no longer part of the distribution\n  package. This is not because we cease support for them, but there are no\n  longer any files in them after the move to autotools\n---------------------------------------------------------------------------\nVersion 1.15.1 (RGer), 2007-07-10\n- fixed a bug that caused a dynaFile selector to stall when there was\n  an open error with one file \n- improved template processing for dynaFiles; templates are now only\n  looked up during initialization - speeds up processing\n- optimized memory layout in struct filed when compiled with MySQL\n  support\n- fixed a bug that caused compilation without SYSLOG_INET to fail\n- re-enabled the \"last message repeated n times\" feature. This\n  feature was not taken care of while rsyslogd evolved from sysklogd\n  and it was more or less defunct. Now it is fully functional again.\n- added system properties: $NOW, $YEAR, $MONTH, $DAY, $HOUR, $MINUTE\n- fixed a bug in iovAsString() that caused a memory leak under stress\n  conditions (most probably memory shortage). This was unlikely to\n  ever happen, but it doesn't hurt doing it right\n- cosmetic: defined type \"uchar\", change all unsigned chars to uchar\n---------------------------------------------------------------------------\nVersion 1.15.0 (RGer), 2007-07-05\n- added ability to dynamically generate file names based on templates\n  and thus properties. This was a much-requested feature. It makes\n  life easy when it e.g. comes to splitting files based on the sender\n  address.\n- added $umask and $FileCreateMode config file directives\n- applied a patch from Bartosz Kuzma to compile cleanly under NetBSD\n- checks for extra (unexpected) characters in system config file lines\n  have been added\n- added IPv6 documentation - was accidently missing from CVS\n- begun to change char to unsigned char\n---------------------------------------------------------------------------\nVersion 1.14.2 (RGer), 2007-07-03\n** this release fixes all known nits with IPv6 **\n- restored capability to do /etc/service lookup for \"syslog\"\n  service when -r 0 was given\n- documented IPv6 handling of syslog messages\n- integrate patch from Bartosz Ku\u017ama to make rsyslog compile under\n  Solaris again (the patch replaced a strndup() call, which is not\n  available under Solaris\n- improved debug logging when waiting on select\n- updated rsyslogd man page with new options (-46A)\n---------------------------------------------------------------------------\nVersion 1.14.1 (RGer/Peter Vrabec), 2007-06-29\n- added Peter Vrabec's patch for IPv6 TCP\n- prefixed all messages send to stderr in rsyslogd with \"rsyslogd: \"\n---------------------------------------------------------------------------\nVersion 1.14.0 (RGer/Peter Vrabec), 2007-06-28\n- Peter Vrabec provided IPv6 for rsyslog, so we are now IPv6 enabled\n  IPv6 Support is currently for UDP only, TCP is to come soon.\n  AllowedSender configuration does not yet work for IPv6.\n- fixed code in iovCreate() that broke C's strict aliasing rules \n- fixed some char/unsigned char differences that forced the compiler\n  to spit out warning messages\n- updated the Red Hat init script to fix a known issue (thanks to\n  Peter Vrabec)\n---------------------------------------------------------------------------\nVersion 1.13.5 (RGer), 2007-06-22\n- made the TCP session limit configurable via command line switch\n  now -t <port>,<max sessions>\n- added man page for rklogd(8) (basically a copy from klogd, but now\n  there is one...)\n- fixed a bug that caused internal messages (e.g. rsyslogd startup) to\n  appear without a tag.\n- removed a minor memory leak that occurred when TAG processing requalified\n  a HOSTNAME to be a TAG (and a TAG already was set).\n- removed potential small memory leaks in MsgSet***() functions. There\n  would be a leak if a property was re-set, something that happened\n  extremely seldom.\n---------------------------------------------------------------------------\nVersion 1.13.4 (RGer), 2007-06-18\n- added a new property \"PRI-text\", which holds the PRI field in\n  textual form (e.g. \"syslog.info\")\n- added alias \"syslogseverity\" for \"syslogpriority\", which is a\n  misleading property name that needs to stay for historical\n  reasons (and backward-compatility)\n- added doc on how to record PRI value in log file\n- enhanced signal handling in klogd, including removal of an unsafe\n  call to the logging system during signal handling\n---------------------------------------------------------------------------\nVersion 1.13.3 (RGer), 2007-06-15\n- create a version of syslog.c from scratch. This is now\n  - highly optimized for rsyslog\n  - removes an incompatible license problem as the original\n    version had a BSD license with advertising clause\n  - fixed in the regard that rklogd will continue to work when\n    rsysogd has been restarted (the original version, as well\n    as sysklogd, will remain silent then)\n  - solved an issue with an extra NUL char at message end that the\n    original version had\n- applied some changes to klogd to care for the new interface\n- fixed a bug in syslogd.c which prevented compiling under debian\n---------------------------------------------------------------------------\nVersion 1.13.2 (RGer), 2007-06-13\n- lib order in makefile patched to facilitate static linking - thanks\n  to Bennett Todd for providing the patch\n- Integrated a patch from Peter Vrabec (pvrabec@redheat.com):\n  - added klogd under the name of rklogd (remove dependency on\n    original sysklogd package\n  - createDB.sql now in UTF\n  - added additional config files for use on Red Hat\n---------------------------------------------------------------------------\nVersion 1.13.1 (RGer), 2007-02-05\n- changed the listen backlog limit to a more reasonable value based on\n  the maximum number of TCP connections configurd (10% + 5) - thanks to Guy\n  Standen for the hint (actually, the limit was 5 and that was a \n  left-over from early testing).\n- fixed a bug in makefile which caused DB-support to be disabled when\n  NETZIP support was enabled\n- added the -e option to allow transmission of every message to remote\n  hosts (effectively turns off duplicate message suppression)\n- (somewhat) improved memory consumption when compiled with MySQL support\n- looks like we fixed an incompatibility with MySQL 5.x and above software\n  At least in one case, the remote server name was destroyed, leading to \n  a connection failure. The new, improved code does not have this issue and\n  so we see this as solved (the new code is generally somewhat better, so\n  there is a good chance we fixed this incompatibility).\n---------------------------------------------------------------------------\nVersion 1.13.0 (RGer), 2006-12-19\n- added '$' as ToPos proptery replacer specifier - means \"up to the\n  end of the string\"\n- property replacer option \"escape-cc\", \"drop-cc\" and \"space-cc\"  added\n- changed the handling of \\0 characters inside syslog messages. We now\n  consistently escape them to \"#000\". This is somewhat recommended in\n  the draft-ietf-syslog-protocol-19 draft. While the real recomendation\n  is to not escape any characters at all, we can not do this without\n  considerable modification of the code. So we escape it to \"#000\", which\n  is consistent with a sample found in the Internet-draft.\n- removed message glue logic (see printchopped() comment for details)\n  Also caused removal of parts table and thus some improvements in\n  memory usage.\n- changed the default MAXLINE to 2048 to take care of recent syslog\n  standardization efforts (can easily be changed in syslogd.c)\n- added support for byte-counted TCP syslog messages (much like\n  syslog-transport-tls-05 Internet Draft). This was necessary to\n  support compression over TCP.\n- added support for receiving compressed syslog messages\n- added support for sending compressed syslog messages\n- fixed a bug where the last message in a syslog/tcp stream was\n  lost if it was not properly terminated by a LF character\n---------------------------------------------------------------------------\nVersion 1.12.3 (RGer), 2006-10-04\n- implemented some changes to support Solaris (but support is not\n  yet complete)\n- commented out (via #if 0) some methods that are currently not being use\n  but should be kept for further us\n- added (interim) -u 1 option to turn off hostname and tag parsing\n- done some modifications to better support Fedora\n- made the field delimiter inside property replace configurable via\n  template\n- fixed a bug in property replacer: if fields were used, the delimitor\n  became part of the field. Up until now, this was barely noticable as \n  the delimiter as TAB only and thus invisible to a human. With other\n  delimiters available now, it quickly showed up. This bug fix might cause\n  some grief to existing installations if they used the extra TAB for\n  whatever reasons - sorry folks... Anyhow, a solution is easy: just add\n  a TAB character contstant into your template. Thus, there has no attempt\n  been made to do this in a backwards-compatible way.\n---------------------------------------------------------------------------\nVersion 1.12.2 (RGer), 2006-02-15\n- fixed a bug in the RFC 3339 date formatter. An extra space was added\n  after the actual timestamp\n- added support for providing high-precision RFC3339 timestamps for\n  (rsyslogd-)internally-generated messages\n- very (!) experimental support for syslog-protocol internet draft\n  added (the draft is experimental, the code is solid ;))\n- added support for field-extracting in the property replacer\n- enhanced the legacy-syslog parser so that it can interpret messages\n  that do not contain a TIMESTAMP\n- fixed a bug that caused the default socket (usually /dev/log) to be\n  opened even when -o command line option was given\n- fixed a bug in the Debian sample startup script - it caused rsyslogd\n  to listen to remote requests, which it shouldn't by default\n---------------------------------------------------------------------------\nVersion 1.12.1 (RGer), 2005-11-23\n- made multithreading work with BSD. Some signal-handling needed to be\n  restructured. Also, there might be a slight delay of up to 10 seconds\n  when huping and terminating rsyslogd under BSD\n- fixed a bug where a NULL-pointer was passed to printf() in logmsg().\n- fixed a bug during \"make install\" where rc3195d was not installed\n  Thanks to Bennett Todd for spotting this.\n- fixed a bug where rsyslogd dumped core when no TAG was found in the\n  received message\n- enhanced message parser so that it can deal with missing hostnames\n  in many cases (may not be totally fail-safe)\n- fixed a bug where internally-generated messages did not have the correct\n  TAG\n---------------------------------------------------------------------------\nVersion 1.12.0 (RGer), 2005-10-26\n- moved to a multi-threaded design. single-threading is still optionally\n  available. Multi-threading is experimental!\n- fixed a potential race condition. In the original code, marking was done\n  by an alarm handler, which could lead to all sorts of bad things. This\n  has been changed now. See comments in syslogd.c/domark() for details.\n- improved debug output for property-based filters\n- not a code change, but: I have checked all exit()s to make sure that\n  none occurs once rsyslogd has started up. Even in unusual conditions\n  (like low-memory conditions) rsyslogd somehow remains active. Of course,\n  it might loose a message or two, but at least it does not abort and it\n  can also recover when the condition no longer persists.\n- fixed a bug that could cause loss of the last message received\n  immediately before rsyslogd was terminated.\n- added comments on thread-safety of global variables in syslogd.c\n- fixed a small bug: spurios printf() when TCP syslog was used\n- fixed a bug that causes rsyslogd to dump core on termination when one\n  of the selector lines did not receive a message during the run (very\n  unlikely)\n- fixed an one-too-low memory allocation in the TCP sender. Could result\n  in rsyslogd dumping core.\n- fixed a bug with regular expression support (thanks to Andres Riancho)\n- a little bit of code restructuring (especially main(), which was\n  horribly large)\n---------------------------------------------------------------------------\nVersion 1.11.1 (RGer), 2005-10-19\n- support for BSD-style program name and host blocks\n- added a new property \"programname\" that can be used in templates\n- added ability to specify listen port for rfc3195d\n- fixed a bug that rendered the \"startswith\" comparison operation\n  unusable.\n- changed more functions to \"static\" storage class to help compiler\n  optimize (should have been static in the first place...)\n- fixed a potential memory leak in the string buffer class destructor.\n  As the destructur was previously never called, the leak did not actually\n  appear.\n- some internal restructuring in anticipation/preparation of minimal\n  multi-threading support\n- rsyslogd still shares some code with the sysklogd project. Some patches\n  for this shared code have been brought over from the sysklogd CVS.\n---------------------------------------------------------------------------\nVersion 1.11.0 (RGer), 2005-10-12\n- support for receiving messages via RFC 3195; added rfc3195d for that\n  purpose\n- added an additional guard to prevent rsyslogd from aborting when the\n  2gb file size limit is hit. While a user can configure rsyslogd to\n  handle such situations, it would abort if that was not done AND large\n  file support was not enabled (ok, this is hopefully an unlikely scenario)\n- fixed a bug that caused additional Unix domain sockets to be incorrectly\n  processed - could lead to message loss in extreme cases\n---------------------------------------------------------------------------\nVersion 1.10.2 (RGer), 2005-09-27\n- added comparison operations in property-based filters:\n  * isequal\n  * startswith\n- added ability to negate all property-based filter comparison operations\n  by adding a !-sign right in front of the operation name\n- added the ability to specify remote senders for UDP and TCP\n  received messages. Allows to block all but well-known hosts\n- changed the $-config line directives to be case-INsensitive\n- new command line option -w added: \"do not display warnings if messages\n  from disallowed senders are received\"\n- fixed a bug that caused rsyslogd to dump core when the compare value\n  was not quoted in property-based filters\n- fixed a bug in the new CStr compare function which lead to invalid\n  results (fortunately, this function was not yet used widely)\n- added better support for \"debugging\" rsyslog.conf property filters\n  (only if -d switch is given)\n- changed some function definitions to static, which eventually enables\n  some compiler optimizations\n- fixed a bug in MySQL code; when a SQL error occured, rsyslogd could\n  run in a tight loop. This was due to invalid sequence of error reporting\n  and is now fixed.\n---------------------------------------------------------------------------\nVersion 1.10.1 (RGer), 2005-09-23\n- added the ability to execute a shell script as an action.\n  Thanks to Bjoern Kalkbrenner for providing the code!\n- fixed a bug in the MySQL code; due to the bug the automatic one-time\n  retry after an error did not happen - this lead to error message in\n  cases where none should be seen (e.g. after a MySQL restart)\n- fixed a security issue with SQL-escaping in conjunction with\n  non-(SQL-)standard MySQL features.\n---------------------------------------------------------------------------\nVersion 1.10.0 (RGer), 2005-09-20\n  REMINDER: 1.10 is the first unstable version if the 1.x series!\n- added the capability to filter on any property in selector lines\n  (not just facility and priority)\n- changed stringbuf into a new counted string class\n- added support for a \"discard\" action. If a selector line with\n  discard (~ character) is found, no selector lines *after* that\n  line will be processed.\n- thanks to Andres Riancho, regular expression support has been\n  added to the template engine\n- added the FROMHOST property in the template processor, which could\n  previously not be obtained. Thanks to Cristian Testa for pointing\n  this out and even providing a fix.\n- added display of compile-time options to -v output\n- performance improvement for production build - made some checks\n  to happen only during debug mode\n- fixed a problem with compiling on SUSE and - while doing so - removed\n  the socket call to set SO_BSDCOMPAT in cases where it is obsolete.\n---------------------------------------------------------------------------\nVersion 1.0.4 (RGer), 2006-02-01\n- a small but important fix: the tcp receiver had two forgotten printf's\n  in it that caused a lot of unnecessary output to stdout. This was\n  important enough to justify a new release\n---------------------------------------------------------------------------\nVersion 1.0.3 (RGer), 2005-11-14\n- added an additional guard to prevent rsyslogd from aborting when the\n  2gb file size limit is hit. While a user can configure rsyslogd to\n  handle such situations, it would abort if that was not done AND large\n  file support was not enabled (ok, this is hopefully an unlikely scenario)\n- fixed a bug that caused additional Unix domain sockets to be incorrectly\n  processed - could lead to message loss in extreme cases\n- applied some patches available from the sysklogd project to code\n  shared from there\n- fixed a bug that causes rsyslogd to dump core on termination when one\n  of the selector lines did not receive a message during the run (very\n  unlikely)\n- fixed an one-too-low memory allocation in the TCP sender. Could result\n  in rsyslogd dumping core.\n- fixed a bug in the TCP sender that caused the retry logic to fail\n  after an error or receiver overrun\n- fixed a bug in init() that could lead to dumping core\n- fixed a bug that could lead to dumping core when no HOSTNAME or no TAG\n  was present in the syslog message\n---------------------------------------------------------------------------\nVersion 1.0.2 (RGer), 2005-10-05\n- fixed an issue with MySQL error reporting. When an error occured,\n  the MySQL driver went into an endless loop (at least in most cases).\n---------------------------------------------------------------------------\nVersion 1.0.1 (RGer), 2005-09-23\n- fixed a security issue with SQL-escaping in conjunction with\n  non-(SQL-)standard MySQL features.\n---------------------------------------------------------------------------\nVersion 1.0.0 (RGer), 2005-09-12\n- changed install doc to cover daily cron scripts - a trouble source\n- added rc script for slackware (provided by Chris Elvidge - thanks!) \n- fixed a really minor bug in usage() - the -r option was still\n  reported as without the port parameter\n---------------------------------------------------------------------------\nVersion 0.9.8 (RGer), 2005-09-05\n- made startup and shutdown message more consistent and included the\n  pid, so that they can be easier correlated. Used syslog-protocol\n  structured data format for this purpose.\n- improved config info in startup message, now tells not only\n  if it is listening remote on udp, but also for tcp. Also includes\n  the port numbers. The previous startup message was misleading, because\n  it did not say \"remote reception\" if rsyslogd was only listening via\n  tcp (but not via udp).\n- added a \"how can you help\" document to the doc set\n---------------------------------------------------------------------------\nVersion 0.9.7 (RGer), 2005-08-15\n- some of the previous doc files (like INSTALL) did not properly\n  reflect the changes to the build process and the new doc. Fixed\n  that.\n- changed syslogd.c so that when compiled without database support,\n  an error message is displayed when a database action is detected\n  in the config file (previously this was used as an user rule ;))\n- fixed a bug in the os-specific Makefiles which caused MySQL\n  support to not be compiled, even if selected\n---------------------------------------------------------------------------\nVersion 0.9.6 (RGer), 2005-08-09\n- greatly enhanced documentation. Now available in html format in\n  the \"doc\" folder and FreeBSD. Finally includes an install howto.\n- improved MySQL error messages a little - they now show up as log\n  messages, too (formerly only in debug mode)\n- added the ability to specify the listen port for udp syslog.\n  WARNING: This introduces an incompatibility. Formerly, udp\n  syslog was enabled by the -r command line option. Now, it is\n  \"-r [port]\", which is consistent with the tcp listener. However,\n  just -r will now return an error message.\n- added sample startup scripts for Debian and FreeBSD\n- added support for easy feature selection in the makefile. Un-\n  fortunately, this also means I needed to spilt the make file\n  for different OS and distros. There are some really bad syntax\n  differences between FreeBSD and Linux make.\n---------------------------------------------------------------------------\nVersion 0.9.5 (RGer), 2005-08-01\n- the \"semicolon bug\" was actually not (fully) solved in 0.9.4. One\n  part of the bug was solved, but another still existed. This one\n  is fixed now, too.\n- the \"semicolon bug\" actually turned out to be a more generic bug.\n  It appeared whenever an invalid template name was given. With some\n  selector actions, rsyslogd dumped core, with other it \"just\" had\n  a small ressource leak with others all worked well. These anomalies\n  are now fixed. Note that they only appeared during system initaliziation\n  once the system was running, nothing bad happened.\n- improved error reporting for template errors on startup. They are now\n  shown on the console and the start-up tty. Formerly, they were only\n  visible in debug mode.\n- support for multiple instances of rsyslogd on a single machine added\n- added new option \"-o\" --> omit local unix domain socket. This option\n  enables rsyslogd NOT to listen to the local socket. This is most\n  helpful when multiple instances of rsyslogd (or rsyslogd and another\n  syslogd) shall run on a single system.\n- added new option \"-i <pidfile>\" which allows to specify the pidfile.\n  This is needed when multiple instances of rsyslogd are to be run.\n- the new project home page is now online at www.rsyslog.com\n---------------------------------------------------------------------------\nVersion 0.9.4 (RGer), 2005-07-25\n- finally added the TCP sender. It now supports non-blocking mode, no\n  longer disabling message reception during connect. As it is now, it\n  is usable in production. The code could be more sophisticated, but\n  I've kept it short in anticipation of the move to liblogging, which\n  will lead to the removal of the code just written ;)\n- the \"exiting on signal...\" message still had the \"syslogd\" name in \n  it. Changed this to \"rsyslogd\", as we do not have a large user base\n  yet, this should pose no problem.\n- fixed \"the semiconlon\" bug. rsyslogd dumped core if a write-db action\n  was specified but no semicolon was given after the password (an empty\n  template was ok, but the semicolon needed to be present).\n- changed a default for traditional output format. During testing, it\n  was seen that the timestamp written to file in default format was\n  the time of message reception, not the time specified in the TIMESTAMP\n  field of the message itself. Traditionally, the message TIMESTAMP is\n  used and this has been changed now.\n---------------------------------------------------------------------------\nVersion 0.9.3 (RGer), 2005-07-19\n- fixed a bug in the message parser. In June, the RFC 3164 timestamp\n  was not correctly parsed (yes, only in June and some other months,\n  see the code comment to learn why...)\n- added the ability to specify the destination port when forwarding\n  syslog messages (both for TCP and UDP)\n- added an very experimental TCP sender (activated by\n  @@machine:port in config). This is not yet for production use. If\n  the receiver is not alive, rsyslogd will wait quite some time until\n  the connection request times out, which most probably leads to\n  loss of incoming messages.\n\n---------------------------------------------------------------------------\nVersion 0.9.2 (RGer), around 2005-07-06\n- I intended to change the maxsupported message size to 32k to\n  support IHE - but given the memory inefficiency in the usual use\n  cases, I have not done this. I have, however, included very\n  specific instructions on how to do this in the source code. I have\n  also done some testing with 32k messages, so you can change the\n  max size without taking too much risk.\n- added a syslog/tcp receiver; we now can receive messages via\n  plain tcp, but we can still send only via UDP. The syslog/tcp\n  receiver is the primary enhancement of this release.\n- slightly changed some error messages that contained a spurios \\n at\n  the end of the line (which gives empty lines in your log...)\n\n---------------------------------------------------------------------------\nVersion 0.9.1 (RGer)\n- fixed code so that it compiles without errors under FreeBSD\n- removed now unused function \"allocate_log()\" from syslogd.c\n- changed the make file so that it contains more defines for\n  different environments (in the long term, we need a better\n  system for disabling/enabling features...)\n- changed some printf's printing off_t types to %lld and\n  explicit (long long) casts. I tried to figure out the exact type,\n  but did not succeed in this. In the worst case, ultra-large peta-\n  byte files will now display funny informational messages on rollover,\n  something I think we can live with for the neersion 3.11.2 (rgerhards), 2008-02-??\n---------------------------------------------------------------------------\nVersion 3.11.1 (rgerhards), 2008-02-12\n- SNMP trap sender added thanks to Andre Lorbach (omsnmp)\n- added input-plugin interface specification in form of a (copy) template\n  input module\n- applied documentation fix by Michael Biebl -- many thanks!\n- bugfix: immark did not have MARK flags set...\n- added x-info field to rsyslogd startup/shutdown message. Hopefully\n  points users to right location for further info (many don't even know\n  they run rsyslog ;))\n- bugfix: trailing \":\" of tag was lost while parsing legacy syslog messages\n  without timestamp - thanks to Anders Blomdell for providing a patch!\n- fixed a bug in stringbuf.c related to STRINGBUF_TRIM_ALLOCSIZE, which\n  wasn't supposed to be used with rsyslog. Put a warning message up that\n  tells this feature is not tested and probably not worth the effort.\n  Thanks to Anders Blomdell fro bringing this to our attention\n- somewhat improved performance of string buffers\n- fixed bug that caused invalid treatment of tabs (HT) in rsyslog.conf\n- bugfix: setting for $EscapeCopntrolCharactersOnReceive was not \n  properly initialized\n- clarified usage of space-cc property replacer option\n- improved abort diagnostic handler\n- some initial effort for malloc/free runtime debugging support\n- bugfix: using dynafile actions caused rsyslogd abort\n- fixed minor man errors thanks to Michael Biebl\n---------------------------------------------------------------------------\nVersion 3.11.0 (rgerhards), 2008-01-31\n- implemented queued actions\n- implemented simple rate limiting for actions\n- implemented deliberate discarding of lower priority messages over higher\n  priority ones when a queue runs out of space\n- implemented disk quotas for disk queues\n- implemented the $ActionResumeRetryCount config directive\n- added $ActionQueueFilename config directive\n- added $ActionQueueSize config directive\n- added $ActionQueueHighWaterMark config directive\n- added $ActionQueueLowWaterMark config directive\n- added $ActionQueueDiscardMark config directive\n- added $ActionQueueDiscardSeverity config directive\n- added $ActionQueueCheckpointInterval config directive\n- added $ActionQueueType config directive\n- added $ActionQueueWorkerThreads config directive\n- added $ActionQueueTimeoutshutdown config directive\n- added $ActionQueueTimeoutActionCompletion config directive\n- added $ActionQueueTimeoutenQueue config directive\n- added $ActionQueueTimeoutworkerThreadShutdown config directive\n- added $ActionQueueWorkerThreadMinimumMessages config directive\n- added $ActionQueueMaxFileSize config directive\n- added $ActionQueueSaveonShutdown config directive\n- addded $ActionQueueDequeueSlowdown config directive\n- addded $MainMsgQueueDequeueSlowdown config directive\n- bugfix: added forgotten docs to package\n- improved debugging support\n- fixed a bug that caused $MainMsgQueueCheckpointInterval to work incorrectly\n- when a long-running action needs to be cancelled on shutdown, the message\n  that was processed by it is now preserved. This finishes support for\n  guaranteed delivery of messages (if the output supports it, of course)\n- fixed bug in output module interface, see\n  http://sourceforge.net/tracker/index.php?func=detail&aid=1881008&group_id=123448&atid=696552\n- changed the ommysql output plugin so that the (lengthy) connection\n  initialization now takes place in message processing. This works much\n  better with the new queued action mode (fast startup)\n- fixed a bug that caused a potential hang in file and fwd output module\n  varmojfekoj provided the patch - many thanks!\n- bugfixed stream class offset handling on 32bit platforms\n---------------------------------------------------------------------------\nVersion 3.10.3 (rgerhards), 2008-01-28\n- fixed a bug with standard template definitions (not a big deal) - thanks\n  to varmojfekoj for spotting it\n- run-time instrumentation added\n- implemented disk-assisted queue mode, which enables on-demand disk\n  spooling if the queue's in-memory queue is exhausted\n- implemented a dynamic worker thread pool for processing incoming\n  messages; workers are started and shut down as need arises\n- implemented a run-time instrumentation debug package\n- implemented the $MainMsgQueueSaveOnShutdown config directive\n- implemented the $MainMsgQueueWorkerThreadMinimumMessages config directive\n- implemented the $MainMsgQueueTimeoutWorkerThreadShutdown config directive\n---------------------------------------------------------------------------\nVersion 3.10.2 (rgerhards), 2008-01-14\n- added the ability to keep stop rsyslogd without the need to drain\n  the main message queue. In disk queue mode, rsyslog continues to\n  run from the point where it stopped. In case of a system failure, it\n  continues to process messages from the last checkpoint.\n- fixed a bug that caused a segfault on startup when no $WorkDir directive\n  was specified in rsyslog.conf\n- provided more fine-grain control over shutdown timeouts and added a\n  way to specify the enqueue timeout when the main message queue is full\n- implemented $MainMsgQueueCheckpointInterval config directive\n- implemented $MainMsgQueueTimeoutActionCompletion config directive\n- implemented $MainMsgQueueTimeoutEnqueue config directive\n- implemented $MainMsgQueueTimeoutShutdown config directive\n---------------------------------------------------------------------------\nVersion 3.10.1 (rgerhards), 2008-01-10\n- implemented the \"disk\" queue mode. However, it currently is of very\n  limited use, because it does not support persistence over rsyslogd\n  runs. So when rsyslogd is stopped, the queue is drained just as with\n  the in-memory queue modes. Persistent queues will be a feature of\n  the next release.\n- performance-optimized string class, should bring an overall improvement\n- fixed a memory leak in imudp -- thanks to varmojfekoj for the patch\n- fixed a race condition that could lead to a rsyslogd hang when during\n  HUP or termination\n- done some doc updates\n- added $WorkDirectory config directive\n- added $MainMsgQueueFileName config directive\n- added $MainMsgQueueMaxFileSize config directive\n---------------------------------------------------------------------------\nVersion 3.10.0 (rgerhards), 2008-01-07\n- implemented input module interface and initial input modules\n- enhanced threading for input modules (each on its own thread now)\n- ability to bind UDP listeners to specific local interfaces/ports and\n  ability to run multiple of them concurrently\n- added ability to specify listen IP address for UDP syslog server\n- license changed to GPLv3\n- mark messages are now provided by loadble module immark\n- rklogd is no longer provided. Its functionality has now been taken over\n  by imklog, a loadable input module. This offers a much better integration\n  into rsyslogd and makes sure that the kernel logger process is brought\n  up and down at the appropriate times\n- enhanced $IncludeConfig directive to support wildcard characters\n  (thanks to Michael Biebl)\n- all inputs are now implemented as loadable plugins\n- enhanced threading model: each input module now runs on its own thread\n- enhanced message queue which now supports different queueing methods\n  (among others, this can be used for performance fine-tuning)\n- added a large number of new configuration directives for the new\n  input modules\n- enhanced multi-threading utilizing a worker thread pool for the\n  main message queue\n- compilation without pthreads is no longer supported\n- much cleaner code due to new objects and removal of single-threading\n  mode\n---------------------------------------------------------------------------\nVersion 2.0.1 STABLE (rgerhards), 2008-01-24\n- fixed a bug in integer conversion - but this function was never called,\n  so it is not really a useful bug fix ;)\n- fixed a bug with standard template definitions (not a big deal) - thanks\n  to varmojfekoj for spotting it\n- fixed a bug that caused a potential hang in file and fwd output module\n  varmojfekoj provided the patch - many thanks!\n---------------------------------------------------------------------------\nVersion 2.0.0 STABLE (rgerhards), 2008-01-02\n- re-release of 1.21.2 as STABLE with no modifications except some\n  doc updates\n---------------------------------------------------------------------------\nVersion 1.21.2 (rgerhards), 2007-12-28\n- created a gss-api output module. This keeps GSS-API code and\n  TCP/UDP code separated. It is also important for forward-\n  compatibility with v3. Please note that this change breaks compatibility\n  with config files created for 1.21.0 and 1.21.1 - this was considered\n  acceptable.\n- fixed an error in forwarding retry code (could lead to message corruption\n  but surfaced very seldom)\n- increased portability for older platforms (AI_NUMERICSERV moved)\n- removed socket leak in omfwd.c\n- cross-platform patch for GSS-API compile problem on some platforms\n  thanks to darix for the patch!\n---------------------------------------------------------------------------\nVersion 1.21.1 (rgerhards), 2007-12-23\n- small doc fix for $IncludeConfig\n- fixed a bug in llDestroy()\n- bugfix: fixing memory leak when message queue is full and during\n  parsing. Thanks to varmojfekoj for the patch.\n- bugfix: when compiled without network support, unix sockets were\n  not properply closed\n- bugfix: memory leak in cfsysline.c/doGetWord() fixed\n---------------------------------------------------------------------------\nVersion 1.21.0 (rgerhards), 2007-12-19\n- GSS-API support for syslog/TCP connections was added. Thanks to\n  varmojfekoj for providing the patch with this functionality\n- code cleanup\n- enhanced $IncludeConfig directive to support wildcard filenames\n- changed some multithreading synchronization\n---------------------------------------------------------------------------\nVersion 1.20.1 (rgerhards), 2007-12-12\n- corrected a debug setting that survived release. Caused TCP connections\n  to be retried unnecessarily often.\n- When a hostname ACL was provided and DNS resolution for that name failed,\n  ACL processing was stopped at that point. Thanks to mildew for the patch.\n  Fedora Bugzilla: http://bugzilla.redhat.com/show_bug.cgi?id=395911\n- fixed a potential race condition, see link for details:\n  http://rgerhards.blogspot.com/2007/12/rsyslog-race-condition.html\n  Note that the probability of problems from this bug was very remote\n- fixed a memory leak that happend when PostgreSQL date formats were\n  used\n---------------------------------------------------------------------------\nVersion 1.20.0 (rgerhards), 2007-12-07\n- an output module for postgres databases has been added. Thanks to\n  sur5r for contributing this code\n- unloading dynamic modules has been cleaned up, we now have a\n  real implementation and not just a dummy \"good enough for the time\n  being\".\n- enhanced platform independence - thanks to Bartosz Kuzma and Michael\n  Biebl for their very useful contributions\n- some general code cleanup (including warnings on 64 platforms, only)\n---------------------------------------------------------------------------\nVersion 1.19.12 (rgerhards), 2007-12-03\n- cleaned up the build system (thanks to Michael Biebl for the patch)\n- fixed a bug where ommysql was still not compiled with -pthread option\n---------------------------------------------------------------------------\nVersion 1.19.11 (rgerhards), 2007-11-29\n- applied -pthread option to build when building for multi-threading mode\n  hopefully solves an issue with segfaulting\n---------------------------------------------------------------------------\nVersion 1.19.10 (rgerhards), 2007-10-19\n- introdcued the new \":modulename:\" syntax for calling module actions\n  in selector lines; modified ommysql to support it. This is primarily\n  an aid for further modules and a prequisite to actually allow third\n  party modules to be created.\n- minor fix in slackware startup script, \"-r 0\" is now \"-r0\"\n- updated rsyslogd doc set man page; now in html format\n- undid creation of a separate thread for the main loop -- this did not\n  turn out to be needed or useful, so reduce complexity once again.\n- added doc fixes provided by Michael Biebl - thanks\n---------------------------------------------------------------------------\nVersion 1.19.9 (rgerhards), 2007-10-12\n- now packaging system which again contains all components in a single\n  tarball\n- modularized main() a bit more, resulting in less complex code\n- experimentally added an additional thread - will see if that affects\n  the segfault bug we experience on some platforms. Note that this change\n  is scheduled to be removed again later.\n---------------------------------------------------------------------------\nVersion 1.19.8 (rgerhards), 2007-09-27\n- improved repeated message processing\n- applied patch provided by varmojfekoj to support building ommysql\n  in its own way (now also resides in a plugin subdirectory);\n  ommysql is now a separate package\n- fixed a bug in cvthname() that lead to message loss if part\n  of the source hostname would have been dropped\n- created some support for distributing ommysql together with the\n  main rsyslog package. I need to re-think it in the future, but\n  for the time being the current mode is best. I now simply include\n  one additional tarball for ommysql inside the main distribution.\n  I look forward to user feedback on how this should be done best. In the\n  long term, a separate project should be spawend for ommysql, but I'd\n  like to do that only after the plugin interface is fully stable (what\n  it is not yet).\n---------------------------------------------------------------------------\nVersion 1.19.7 (rgerhards), 2007-09-25\n- added code to handle situations where senders send us messages ending with\n  a NUL character. It is now simply removed. This also caused trailing LF\n  reduction to fail, when it was followed by such a NUL. This is now also\n  handled.\n- replaced some non-thread-safe function calls by their thread-safe\n  counterparts\n- fixed a minor memory leak that occured when the %APPNAME% property was\n  used (I think nobody used that in practice)\n- fixed a bug that caused signal handlers in cvthname() not to be restored when\n  a malicious pointer record was detected and processing of the message been\n  stopped for that reason (this should be really rare and can not be related\n  to the segfault bug we are hunting).\n- fixed a bug in cvthname that lead to passing a wrong parameter - in\n  practice, this had no impact.\n- general code cleanup (e.g. compiler warnings, comments)\n---------------------------------------------------------------------------\nVersion 1.19.6 (rgerhards), 2007-09-11\n- applied patch by varmojfekoj to change signal handling to the new\n  sigaction API set (replacing the depreciated signal() calls and its\n  friends.\n- fixed a bug that in --enable-debug mode caused an assertion when the\n  discard action was used\n- cleaned up compiler warnings\n- applied patch by varmojfekoj to FIX a bug that could cause \n  segfaults if empty properties were processed using modifying\n  options (e.g. space-cc, drop-cc)\n- fixed man bug: rsyslogd supports -l option\n---------------------------------------------------------------------------\nVersion 1.19.5 (rgerhards), 2007-09-07\n- changed part of the CStr interface so that better error tracking\n  is provided and the calling sequence is more intuitive (there were\n  invalid calls based on a too-weired interface)\n- (hopefully) fixed some remaining bugs rooted in wrong use of \n  the CStr class. These could lead to program abort.\n- applied patch by varmojfekoj two fix two potential segfault situations\n- added $ModDir config directive\n- modified $ModLoad so that an absolute path may be specified as\n  module name (e.g. /rsyslog/ommysql.so)\n---------------------------------------------------------------------------\nVersion 1.19.4 (rgerhards/varmojfekoj), 2007-09-04\n- fixed a number of small memory leaks - thanks varmojfekoj for patching\n- fixed an issue with CString class that could lead to rsyslog abort\n  in tplToString() - thanks varmojfekoj for patching\n- added a man-version of the config file documenation - thanks to Michel\n  Samia for providing the man file\n- fixed bug: a template like this causes an infinite loop:\n  $template opts,\"%programname:::a,b%\"\n  thanks varmojfekoj for the patch\n- fixed bug: case changing options crash freeing the string pointer\n  because they modify it: $template opts2,\"%programname::1:lowercase%\"\n  thanks varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 1.19.3 (mmeckelein/varmojfekoj), 2007-08-31\n- small mem leak fixed (after calling parseSelectorAct) - Thx varmojkekoj\n- documentation section \"Regular File\" und \"Blocks\" updated\n- solved an issue with dynamic file generation - Once again many thanks\n  to varmojfekoj\n- the negative selector for program name filter (Blocks) does not work as\n  expected - Thanks varmojfekoj for patching\n- added forwarding information to sysklogd (requires special template)\n  to config doc\n---------------------------------------------------------------------------\nVersion 1.19.2 (mmeckelein/varmojfekoj), 2007-08-28\n- a specifically formed message caused a segfault - Many thanks varmojfekoj\n  for providing a patch\n- a typo and a weird condition are fixed in msg.c - Thanks again\n  varmojfekoj \n- on file creation the file was always owned by root:root. This is fixed\n  now - Thanks ypsa for solving this issue\n---------------------------------------------------------------------------\nVersion 1.19.1 (mmeckelein), 2007-08-22\n- a bug that caused a high load when a TCP/UDP connection was closed is \n  fixed now - Thanks mildew for solving this issue\n- fixed a bug which caused a segfault on reinit - Thx varmojfekoj for the\n  patch\n- changed the hardcoded module path \"/lib/rsyslog\" to $(pkglibdir) in order\n  to avoid trouble e.g. on 64 bit platforms (/lib64) - many thanks Peter\n  Vrabec and darix, both provided a patch for solving this issue\n- enhanced the unloading of modules - thanks again varmojfekoj\n- applied a patch from varmojfekoj which fixes various little things in\n  MySQL output module\n---------------------------------------------------------------------------\nVersion 1.19.0 (varmojfekoj/rgerhards), 2007-08-16\n- integrated patch from varmojfekoj to make the mysql module a loadable one\n  many thanks for the patch, MUCH appreciated\n---------------------------------------------------------------------------\nVersion 1.18.2 (rgerhards), 2007-08-13\n- fixed a bug in outchannel code that caused templates to be incorrectly\n  parsed\n- fixed a bug in ommysql that caused a wrong \";template\" missing message\n- added some code for unloading modules; not yet fully complete (and we do\n  not yet have loadable modules, so this is no problem)\n- removed debian subdirectory by request of a debian packager (this is a special\n  subdir for debian and there is also no point in maintaining it when there\n  is a debian package available - so I gladly did this) in some cases\n- improved overall doc quality (some pages were quite old) and linked to\n  more of the online resources.\n- improved /contrib/delete_mysql script by adding a host option and some\n  other minor modifications\n---------------------------------------------------------------------------\nVersion 1.18.1 (rgerhards), 2007-08-08\n- applied a patch from varmojfekoj which solved a potential segfault\n  of rsyslogd on HUP\n- applied patch from Michel Samia to fix compilation when the pthreads\n  feature is disabled\n- some code cleanup (moved action object to its own file set)\n- add config directive $MainMsgQueueSize, which now allows to configure the\n  queue size dynamically\n- all compile-time settings are now shown in rsyslogd -v, not just the\n  active ones\n- enhanced performance a little bit more\n- added config file directive $ActionResumeInterval\n- fixed a bug that prevented compilation under debian sid\n- added a contrib directory for user-contributed useful things\n---------------------------------------------------------------------------\nVersion 1.18.0 (rgerhards), 2007-08-03\n- rsyslog now supports fallback actions when an action did not work. This\n  is a great feature e.g. for backup database servers or backup syslog\n  servers\n- modified rklogd to only change the console log level if -c is specified\n- added feature to use multiple actions inside a single selector\n- implemented $ActionExecOnlyWhenPreviousIsSuspended config directive\n- error messages during startup are now spit out to the configured log\n  destinations\n---------------------------------------------------------------------------\nVersion 1.17.6 (rgerhards), 2007-08-01\n- continued to work on output module modularization - basic stage of\n  this work is now FINISHED\n- fixed bug in OMSRcreate() - always returned SR_RET_OK\n- fixed a bug that caused ommysql to always complain about missing\n  templates\n- fixed a mem leak in OMSRdestruct - freeing the object itself was\n  forgotten - thanks to varmojfekoj for the patch\n- fixed a memory leak in syslogd/init() that happend when the config\n  file could not be read - thanks to varmojfekoj for the patch\n- fixed insufficient memory allocation in addAction() and its helpers.\n  The initial fix and idea was developed by mildew, I fine-tuned\n  it a bit. Thanks a lot for the fix, I'd probably had pulled out my\n  hair to find the bug...\n- added output of config file line number when a parsing error occured\n- fixed bug in objomsr.c that caused program to abort in debug mode with\n  an invalid assertion (in some cases)\n- fixed a typo that caused the default template for MySQL to be wrong.\n  thanks to mildew for catching this.\n- added configuration file command $DebugPrintModuleList and\n  $DebugPrintCfSysLineHandlerList\n- fixed an invalid value for the MARK timer - unfortunately, there was\n  a testing aid left in place. This resulted in quite frequent MARK messages\n- added $IncludeConfig config directive\n- applied a patch from mildew to prevent rsyslogd from freezing under heavy\n  load. This could happen when the queue was full. Now, we drop messages\n  but rsyslogd remains active.\n---------------------------------------------------------------------------\nVersion 1.17.5 (rgerhards), 2007-07-30\n- continued to work on output module modularization\n- fixed a missing file bug - thanks to Andrea Montanari for reporting\n  this problem\n- fixed a problem with shutting down the worker thread and freeing the\n  selector_t list - this caused messages to be lost, because the\n  message queue was not properly drained before the selectors got\n  destroyed.\n---------------------------------------------------------------------------\nVersion 1.17.4 (rgerhards), 2007-07-27\n- continued to work on output module modularization\n- fixed a situation where rsyslogd could create zombie processes\n  thanks to mildew for the patch\n- applied patch from Michel Samia to fix compilation when NOT\n  compiled for pthreads\n---------------------------------------------------------------------------\nVersion 1.17.3 (rgerhards), 2007-07-25\n- continued working on output module modularization\n- fixed a bug that caused rsyslogd to segfault on exit (and\n  probably also on HUP), when there was an unsent message in a selector\n  that required forwarding and the dns lookup failed for that selector\n  (yes, it was pretty unlikely to happen;))\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- fixed a memory leak in config file parsing and die()\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- rsyslogd now checks on startup if it is capable to performa any work\n  at all. If it cant, it complains and terminates\n  thanks to Michel Samia for providing the patch!\n- fixed a small memory leak when HUPing syslogd. The allowed sender\n  list now gets freed. thanks to mildew for the patch.\n- changed the way error messages in early startup are logged. They\n  now do no longer use the syslogd code directly but are rather\n  send to stderr.\n---------------------------------------------------------------------------\nVersion 1.17.2 (rgerhards), 2007-07-23\n- made the port part of the -r option optional. Needed for backward\n  compatibility with sysklogd\n- replaced system() calls with something more reasonable. Please note that\n  this might break compatibility with some existing configuration files.\n  We accept this in favour of the gained security.\n- removed a memory leak that could occur if timegenerated was used in\n  RFC 3164 format in templates\n- did some preparation in msg.c for advanced multithreading - placed the\n  hooks, but not yet any active code\n- worked further on modularization\n- added $ModLoad MySQL (dummy) config directive\n- added DropTrailingLFOnReception config directive\n---------------------------------------------------------------------------\nVersion 1.17.1 (rgerhards), 2007-07-20\n- fixed a bug that caused make install to install rsyslogd and rklogd under\n  the wrong names\n- fixed bug that caused $AllowedSenders to handle IPv6 scopes incorrectly;\n  also fixed but that could grabble $AllowedSender wildcards. Thanks to\n  mildew@gmail.com for the patch\n- minor code cleanup - thanks to Peter Vrabec for the patch\n- fixed minimal memory leak on HUP (caused by templates)\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- fixed another memory leak on HUPing and on exiting rsyslogd\n  again thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- code cleanup (removed compiler warnings)\n- fixed portability bug in configure.ac - thanks to Bartosz Ku\u017ama for patch\n- moved msg object into its own file set\n- added the capability to continue trying to write log files when the\n  file system is full. Functionality based on patch by Martin Schulze\n  to sysklogd package.\n---------------------------------------------------------------------------\nVersion 1.17.0 (RGer), 2007-07-17\n- added $RepeatedLineReduction config parameter\n- added $EscapeControlCharactersOnReceive config parameter\n- added $ControlCharacterEscapePrefix config parameter\n- added $DirCreateMode config parameter\n- added $CreateDirs config parameter\n- added $DebugPrintTemplateList config parameter\n- added $ResetConfigVariables config parameter\n- added $FileOwner config parameter\n- added $FileGroup config parameter\n- added $DirOwner config parameter\n- added $DirGroup config parameter\n- added $FailOnChownFailure config parameter\n- added regular expression support to the filter engine\n  thanks to Michel Samia for providing the patch!\n- enhanced $AllowedSender functionality. Credits to mildew@gmail.com for\n  the patch doing that\n  - added IPv6 support\n  - allowed DNS hostnames\n  - allowed DNS wildcard names\n- added new option $DropMsgsWithMaliciousDnsPTRRecords\n- added autoconf so that rfc3195d, rsyslogd and klogd are stored to /sbin\n- added capability to auto-create directories with dynaFiles\n---------------------------------------------------------------------------\nVersion 1.16.0 (RGer/Peter Vrabec), 2007-07-13 - The Friday, 13th Release ;)\n- build system switched to autotools\n- removed SYSV preprocessor macro use, replaced with autotools equivalents\n- fixed a bug that caused rsyslogd to segfault when TCP listening was\n  disabled and it terminated\n- added new properties \"syslogfacility-text\" and \"syslogseverity-text\"\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- added the -x option to disable hostname dns reslution\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- begun to better modularize syslogd.c - this is an ongoing project; moved\n  type definitions to a separate file\n- removed some now-unused fields from struct filed\n- move file size limit fields in struct field to the \"right spot\" (the file\n  writing part of the union - f_un.f_file)\n- subdirectories linux and solaris are no longer part of the distribution\n  package. This is not because we cease support for them, but there are no\n  longer any files in them after the move to autotools\n---------------------------------------------------------------------------\nVersion 1.15.1 (RGer), 2007-07-10\n- fixed a bug that caused a dynaFile selector to stall when there was\n  an open error with one file \n- improved template processing for dynaFiles; templates are now only\n  looked up during initialization - speeds up processing\n- optimized memory layout in struct filed when compiled with MySQL\n  support\n- fixed a bug that caused compilation without SYSLOG_INET to fail\n- re-enabled the \"last message repeated n times\" feature. This\n  feature was not taken care of while rsyslogd evolved from sysklogd\n  and it was more or less defunct. Now it is fully functional again.\n- added system properties: $NOW, $YEAR, $MONTH, $DAY, $HOUR, $MINUTE\n- fixed a bug in iovAsString() that caused a memory leak under stress\n  conditions (most probably memory shortage). This was unlikely to\n  ever happen, but it doesn't hurt doing it right\n- cosmetic: defined type \"uchar\", change all unsigned chars to uchar\n---------------------------------------------------------------------------\nVersion 1.15.0 (RGer), 2007-07-05\n- added ability to dynamically generate file names based on templates\n  and thus properties. This was a much-requested feature. It makes\n  life easy when it e.g. comes to splitting files based on the sender\n  address.\n- added $umask and $FileCreateMode config file directives\n- applied a patch from Bartosz Kuzma to compile cleanly under NetBSD\n- checks for extra (unexpected) characters in system config file lines\n  have been added\n- added IPv6 documentation - was accidently missing from CVS\n- begun to change char to unsigned char\n---------------------------------------------------------------------------\nVersion 1.14.2 (RGer), 2007-07-03\n** this release fixes all known nits with IPv6 **\n- restored capability to do /etc/service lookup for \"syslog\"\n  service when -r 0 was given\n- documented IPv6 handling of syslog messages\n- integrate patch from Bartosz Ku\u017ama to make rsyslog compile under\n  Solaris again (the patch replaced a strndup() call, which is not\n  available under Solaris\n- improved debug logging when waiting on select\n- updated rsyslogd man page with new options (-46A)\n---------------------------------------------------------------------------\nVersion 1.14.1 (RGer/Peter Vrabec), 2007-06-29\n- added Peter Vrabec's patch for IPv6 TCP\n- prefixed all messages send to stderr in rsyslogd with \"rsyslogd: \"\n---------------------------------------------------------------------------\nVersion 1.14.0 (RGer/Peter Vrabec), 2007-06-28\n- Peter Vrabec provided IPv6 for rsyslog, so we are now IPv6 enabled\n  IPv6 Support is currently for UDP only, TCP is to come soon.\n  AllowedSender configuration does not yet work for IPv6.\n- fixed code in iovCreate() that broke C's strict aliasing rules \n- fixed some char/unsigned char differences that forced the compiler\n  to spit out warning messages\n- updated the Red Hat init script to fix a known issue (thanks to\n  Peter Vrabec)\n---------------------------------------------------------------------------\nVersion 1.13.5 (RGer), 2007-06-22\n- made the TCP session limit configurable via command line switch\n  now -t <port>,<max sessions>\n- added man page for rklogd(8) (basically a copy from klogd, but now\n  there is one...)\n- fixed a bug that caused internal messages (e.g. rsyslogd startup) to\n  appear without a tag.\n- removed a minor memory leak that occurred when TAG processing requalified\n  a HOSTNAME to be a TAG (and a TAG already was set).\n- removed potential small memory leaks in MsgSet***() functions. There\n  would be a leak if a property was re-set, something that happened\n  extremely seldom.\n---------------------------------------------------------------------------\nVersion 1.13.4 (RGer), 2007-06-18\n- added a new property \"PRI-text\", which holds the PRI field in\n  textual form (e.g. \"syslog.info\")\n- added alias \"syslogseverity\" for \"syslogpriority\", which is a\n  misleading property name that needs to stay for historical\n  reasons (and backward-compatility)\n- added doc on how to record PRI value in log file\n- enhanced signal handling in klogd, including removal of an unsafe\n  call to the logging system during signal handling\n---------------------------------------------------------------------------\nVersion 1.13.3 (RGer), 2007-06-15\n- create a version of syslog.c from scratch. This is now\n  - highly optimized for rsyslog\n  - removes an incompatible license problem as the original\n    version had a BSD license with advertising clause\n  - fixed in the regard that rklogd will continue to work when\n    rsysogd has been restarted (the original version, as well\n    as sysklogd, will remain silent then)\n  - solved an issue with an extra NUL char at message end that the\n    original version had\n- applied some changes to klogd to care for the new interface\n- fixed a bug in syslogd.c which prevented compiling under debian\n---------------------------------------------------------------------------\nVersion 1.13.2 (RGer), 2007-06-13\n- lib order in makefile patched to facilitate static linking - thanks\n  to Bennett Todd for providing the patch\n- Integrated a patch from Peter Vrabec (pvrabec@redheat.com):\n  - added klogd under the name of rklogd (remove dependency on\n    original sysklogd package\n  - createDB.sql now in UTF\n  - added additional config files for use on Red Hat\n---------------------------------------------------------------------------\nVersion 1.13.1 (RGer), 2007-02-05\n- changed the listen backlog limit to a more reasonable value based on\n  the maximum number of TCP connections configurd (10% + 5) - thanks to Guy\n  Standen for the hint (actually, the limit was 5 and that was a \n  left-over from early testing).\n- fixed a bug in makefile which caused DB-support to be disabled when\n  NETZIP support was enabled\n- added the -e option to allow transmission of every message to remote\n  hosts (effectively turns off duplicate message suppression)\n- (somewhat) improved memory consumption when compiled with MySQL support\n- looks like we fixed an incompatibility with MySQL 5.x and above software\n  At least in one case, the remote server name was destroyed, leading to \n  a connection failure. The new, improved code does not have this issue and\n  so we see this as solved (the new code is generally somewhat better, so\n  there is a good chance we fixed this incompatibility).\n---------------------------------------------------------------------------\nVersion 1.13.0 (RGer), 2006-12-19\n- added '$' as ToPos proptery replacer specifier - means \"up to the\n  end of the string\"\n- property replacer option \"escape-cc\", \"drop-cc\" and \"space-cc\"  added\n- changed the handling of \\0 characters inside syslog messages. We now\n  consistently escape them to \"#000\". This is somewhat recommended in\n  the draft-ietf-syslog-protocol-19 draft. While the real recomendation\n  is to not escape any characters at all, we can not do this without\n  considerable modification of the code. So we escape it to \"#000\", which\n  is consistent with a sample found in the Internet-draft.\n- removed message glue logic (see printchopped() comment for details)\n  Also caused removal of parts table and thus some improvements in\n  memory usage.\n- changed the default MAXLINE to 2048 to take care of recent syslog\n  standardization efforts (can easily be changed in syslogd.c)\n- added support for byte-counted TCP syslog messages (much like\n  syslog-transport-tls-05 Internet Draft). This was necessary to\n  support compression over TCP.\n- added support for receiving compressed syslog messages\n- added support for sending compressed syslog messages\n- fixed a bug where the last message in a syslog/tcp stream was\n  lost if it was not properly terminated by a LF character\n---------------------------------------------------------------------------\nVersion 1.12.3 (RGer), 2006-10-04\n- implemented some changes to support Solaris (but support is not\n  yet complete)\n- commented out (via #if 0) some methods that are currently not being use\n  but should be kept for further us\n- added (interim) -u 1 option to turn off hostname and tag parsing\n- done some modifications to better support Fedora\n- made the field delimiter inside property replace configurable via\n  template\n- fixed a bug in property replacer: if fields were used, the delimitor\n  became part of the field. Up until now, this was barely noticable as \n  the delimiter as TAB only and thus invisible to a human. With other\n  delimiters available now, it quickly showed up. This bug fix might cause\n  some grief to existing installations if they used the extra TAB for\n  whatever reasons - sorry folks... Anyhow, a solution is easy: just add\n  a TAB character contstant into your template. Thus, there has no attempt\n  been made to do this in a backwards-compatible way.\n---------------------------------------------------------------------------\nVersion 1.12.2 (RGer), 2006-02-15\n- fixed a bug in the RFC 3339 date formatter. An extra space was added\n  after the actual timestamp\n- added support for providing high-precision RFC3339 timestamps for\n  (rsyslogd-)internally-generated messages\n- very (!) experimental support for syslog-protocol internet draft\n  added (the draft is experimental, the code is solid ;))\n- added support for field-extracting in the property replacer\n- enhanced the legacy-syslog parser so that it can interpret messages\n  that do not contain a TIMESTAMP\n- fixed a bug that caused the default socket (usually /dev/log) to be\n  opened even when -o command line option was given\n- fixed a bug in the Debian sample startup script - it caused rsyslogd\n  to listen to remote requests, which it shouldn't by default\n---------------------------------------------------------------------------\nVersion 1.12.1 (RGer), 2005-11-23\n- made multithreading work with BSD. Some signal-handling needed to be\n  restructured. Also, there might be a slight delay of up to 10 seconds\n  when huping and terminating rsyslogd under BSD\n- fixed a bug where a NULL-pointer was passed to printf() in logmsg().\n- fixed a bug during \"make install\" where rc3195d was not installed\n  Thanks to Bennett Todd for spotting this.\n- fixed a bug where rsyslogd dumped core when no TAG was found in the\n  received message\n- enhanced message parser so that it can deal with missing hostnames\n  in many cases (may not be totally fail-safe)\n- fixed a bug where internally-generated messages did not have the correct\n  TAG\n---------------------------------------------------------------------------\nVersion 1.12.0 (RGer), 2005-10-26\n- moved to a multi-threaded design. single-threading is still optionally\n  available. Multi-threading is experimental!\n- fixed a potential race condition. In the original code, marking was done\n  by an alarm handler, which could lead to all sorts of bad things. This\n  has been changed now. See comments in syslogd.c/domark() for details.\n- improved debug output for property-based filters\n- not a code change, but: I have checked all exit()s to make sure that\n  none occurs once rsyslogd has started up. Even in unusual conditions\n  (like low-memory conditions) rsyslogd somehow remains active. Of course,\n  it might loose a message or two, but at least it does not abort and it\n  can also recover when the condition no longer persists.\n- fixed a bug that could cause loss of the last message received\n  immediately before rsyslogd was terminated.\n- added comments on thread-safety of global variables in syslogd.c\n- fixed a small bug: spurios printf() when TCP syslog was used\n- fixed a bug that causes rsyslogd to dump core on termination when one\n  of the selector lines did not receive a message during the run (very\n  unlikely)\n- fixed an one-too-low memory allocation in the TCP sender. Could result\n  in rsyslogd dumping core.\n- fixed a bug with regular expression support (thanks to Andres Riancho)\n- a little bit of code restructuring (especially main(), which was\n  horribly large)\n---------------------------------------------------------------------------\nVersion 1.11.1 (RGer), 2005-10-19\n- support for BSD-style program name and host blocks\n- added a new property \"programname\" that can be used in templates\n- added ability to specify listen port for rfc3195d\n- fixed a bug that rendered the \"startswith\" comparison operation\n  unusable.\n- changed more functions to \"static\" storage class to help compiler\n  optimize (should have been static in the first place...)\n- fixed a potential memory leak in the string buffer class destructor.\n  As the destructur was previously never called, the leak did not actually\n  appear.\n- some internal restructuring in anticipation/preparation of minimal\n  multi-threading support\n- rsyslogd still shares some code with the sysklogd project. Some patches\n  for this shared code have been brought over from the sysklogd CVS.\n---------------------------------------------------------------------------\nVersion 1.11.0 (RGer), 2005-10-12\n- support for receiving messages via RFC 3195; added rfc3195d for that\n  purpose\n- added an additional guard to prevent rsyslogd from aborting when the\n  2gb file size limit is hit. While a user can configure rsyslogd to\n  handle such situations, it would abort if that was not done AND large\n  file support was not enabled (ok, this is hopefully an unlikely scenario)\n- fixed a bug that caused additional Unix domain sockets to be incorrectly\n  processed - could lead to message loss in extreme cases\n---------------------------------------------------------------------------\nVersion 1.10.2 (RGer), 2005-09-27\n- added comparison operations in property-based filters:\n  * isequal\n  * startswith\n- added ability to negate all property-based filter comparison operations\n  by adding a !-sign right in front of the operation name\n- added the ability to specify remote senders for UDP and TCP\n  received messages. Allows to block all but well-known hosts\n- changed the $-config line directives to be case-INsensitive\n- new command line option -w added: \"do not display warnings if messages\n  from disallowed senders are received\"\n- fixed a bug that caused rsyslogd to dump core when the compare value\n  was not quoted in property-based filters\n- fixed a bug in the new CStr compare function which lead to invalid\n  results (fortunately, this function was not yet used widely)\n- added better support for \"debugging\" rsyslog.conf property filters\n  (only if -d switch is given)\n- changed some function definitions to static, which eventually enables\n  some compiler optimizations\n- fixed a bug in MySQL code; when a SQL error occured, rsyslogd could\n  run in a tight loop. This was due to invalid sequence of error reporting\n  and is now fixed.\n---------------------------------------------------------------------------\nVersion 1.10.1 (RGer), 2005-09-23\n- added the ability to execute a shell script as an action.\n  Thanks to Bjoern Kalkbrenner for providing the code!\n- fixed a bug in the MySQL code; due to the bug the automatic one-time\n  retry after an error did not happen - this lead to error message in\n  cases where none should be seen (e.g. after a MySQL restart)\n- fixed a security issue with SQL-escaping in conjunction with\n  non-(SQL-)standard MySQL features.\n---------------------------------------------------------------------------\nVersion 1.10.0 (RGer), 2005-09-20\n  REMINDER: 1.10 is the first unstable version if the 1.x series!\n- added the capability to filter on any property in selector lines\n  (not just facility and priority)\n- changed stringbuf into a new counted string class\n- added support for a \"discard\" action. If a selector line with\n  discard (~ character) is found, no selector lines *after* that\n  line will be processed.\n- thanks to Andres Riancho, regular expression support has been\n  added to the template engine\n- added the FROMHOST property in the template processor, which could\n  previously not be obtained. Thanks to Cristian Testa for pointing\n  this out and even providing a fix.\n- added display of compile-time options to -v output\n- performance improvement for production build - made some checks\n  to happen only during debug mode\n- fixed a problem with compiling on SUSE and - while doing so - removed\n  the socket call to set SO_BSDCOMPAT in cases where it is obsolete.\n---------------------------------------------------------------------------\nVersion 1.0.4 (RGer), 2006-02-01\n- a small but important fix: the tcp receiver had two forgotten printf's\n  in it that caused a lot of unnecessary output to stdout. This was\n  important enough to justify a new release\n---------------------------------------------------------------------------\nVersion 1.0.3 (RGer), 2005-11-14\n- added an additional guard to prevent rsyslogd from aborting when the\n  2gb file size limit is hit. While a user can configure rsyslogd to\n  handle such situations, it would abort if that was not done AND large\n  file support was not enabled (ok, this is hopefully an unlikely scenario)\n- fixed a bug that caused additional Unix domain sockets to be incorrectly\n  processed - could lead to message loss in extreme cases\n- applied some patches available from the sysklogd project to code\n  shared from there\n- fixed a bug that causes rsyslogd to dump core on termination when one\n  of the selector lines did not receive a message during the run (very\n  unlikely)\n- fixed an one-too-low memory allocation in the TCP sender. Could result\n  in rsyslogd dumping core.\n- fixed a bug in the TCP sender that caused the retry logic to fail\n  after an error or receiver overrun\n- fixed a bug in init() that could lead to dumping core\n- fixed a bug that could lead to dumping core when no HOSTNAME or no TAG\n  was present in the syslog message\n---------------------------------------------------------------------------\nVersion 1.0.2 (RGer), 2005-10-05\n- fixed an issue with MySQL error reporting. When an error occured,\n  the MySQL driver went into an endless loop (at least in most cases).\n---------------------------------------------------------------------------\nVersion 1.0.1 (RGer), 2005-09-23\n- fixed a security issue with SQL-escaping in conjunction with\n  non-(SQL-)standard MySQL features.\n---------------------------------------------------------------------------\nVersion 1.0.0 (RGer), 2005-09-12\n- changed install doc to cover daily cron scripts - a trouble source\n- added rc script for slackware (provided by Chris Elvidge - thanks!) \n- fixed a really minor bug in usage() - the -r option was still\n  reported as without the port parameter\n---------------------------------------------------------------------------\nVersion 0.9.8 (RGer), 2005-09-05\n- made startup and shutdown message more consistent and included the\n  pid, so that they can be easier correlated. Used syslog-protocol\n  structured data format for this purpose.\n- improved config info in startup message, now tells not only\n  if it is listening remote on udp, but also for tcp. Also includes\n  the port numbers. The previous startup message was misleading, because\n  it did not say \"remote reception\" if rsyslogd was only listening via\n  tcp (but not via udp).\n- added a \"how can you help\" document to the doc set\n---------------------------------------------------------------------------\nVersion 0.9.7 (RGer), 2005-08-15\n- some of the previous doc files (like INSTALL) did not properly\n  reflect the changes to the build process and the new doc. Fixed\n  that.\n- changed syslogd.c so that when compiled without database support,\n  an error message is displayed when a database action is detected\n  in the config file (previously this was used as an user rule ;))\n- fixed a bug in the os-specific Makefiles which caused MySQL\n  support to not be compiled, even if selected\n---------------------------------------------------------------------------\nVersion 0.9.6 (RGer), 2005-08-09\n- greatly enhanced documentation. Now available in html format in\n  the \"doc\" folder and FreeBSD. Finally includes an install howto.\n- improved MySQL error messages a little - they now show up as log\n  messages, too (formerly only in debug mode)\n- added the ability to specify the listen port for udp syslog.\n  WARNING: This introduces an incompatibility. Formerly, udp\n  syslog was enabled by the -r command line option. Now, it is\n  \"-r [port]\", which is consistent with the tcp listener. However,\n  just -r will now return an error message.\n- added sample startup scripts for Debian and FreeBSD\n- added support for easy feature selection in the makefile. Un-\n  fortunately, this also means I needed to spilt the make file\n  for different OS and distros. There are some really bad syntax\n  differences between FreeBSD and Linux make.\n---------------------------------------------------------------------------\nVersion 0.9.5 (RGer), 2005-08-01\n- the \"semicolon bug\" was actually not (fully) solved in 0.9.4. One\n  part of the bug was solved, but another still existed. This one\n  is fixed now, too.\n- the \"semicolon bug\" actually turned out to be a more generic bug.\n  It appeared whenever an invalid template name was given. With some\n  selector actions, rsyslogd dumped core, with other it \"just\" had\n  a small ressource leak with others all worked well. These anomalies\n  are now fixed. Note that they only appeared during system initaliziation\n  once the system was running, nothing bad happened.\n- improved error reporting for template errors on startup. They are now\n  shown on the console and the start-up tty. Formerly, they were only\n  visible in debug mode.\n- support for multiple instances of rsyslogd on a single machine added\n- added new option \"-o\" --> omit local unix domain socket. This option\n  enables rsyslogd NOT to listen to the local socket. This is most\n  helpful when multiple instances of rsyslogd (or rsyslogd and another\n  syslogd) shall run on a single system.\n- added new option \"-i <pidfile>\" which allows to specify the pidfile.\n  This is needed when multiple instances of rsyslogd are to be run.\n- the new project home page is now online at www.rsyslog.com\n---------------------------------------------------------------------------\nVersion 0.9.4 (RGer), 2005-07-25\n- finally added the TCP sender. It now supports non-blocking mode, no\n  longer disabling message reception during connect. As it is now, it\n  is usable in production. The code could be more sophisticated, but\n  I've kept it short in anticipation of the move to liblogging, which\n  will lead to the removal of the code just written ;)\n- the \"exiting on signal...\" message still had the \"syslogd\" name in \n  it. Changed this to \"rsyslogd\", as we do not have a large user base\n  yet, this should pose no problem.\n- fixed \"the semiconlon\" bug. rsyslogd dumped core if a write-db action\n  was specified but no semicolon was given after the password (an empty\n  template was ok, but the semicolon needed to be present).\n- changed a default for traditional output format. During testing, it\n  was seen that the timestamp written to file in default format was\n  the time of message reception, not the time specified in the TIMESTAMP\n  field of the message itself. Traditionally, the message TIMESTAMP is\n  used and this has been changed now.\n---------------------------------------------------------------------------\nVersion 0.9.3 (RGer), 2005-07-19\n- fixed a bug in the message parser. In June, the RFC 3164 timestamp\n  was not correctly parsed (yes, only in June and some other months,\n  see the code comment to learn why...)\n- added the ability to specify the destination port when forwarding\n  syslog messages (both for TCP and UDP)\n- added an very experimental TCP sender (activated by\n  @@machine:port in config). This is not yet for production use. If\n  the receiver is not alive, rsyslogd will wait quite some time until\n  the connection request times out, which most probably leads to\n  loss of incoming messages.\n\n---------------------------------------------------------------------------\nVersion 0.9.2 (RGer), around 2005-07-06\n- I intended to change the maxsupported message size to 32k to\n  support IHE - but given the memory inefficiency in the usual use\n  cases, I have not done this. I have, however, included very\n  specific instructions on how to do this in the source code. I have\n  also done some testing with 32k messages, so you can change the\n  max size without taking too much risk.\n- added a syslog/tcp receiver; we now can receive messages via\n  plain tcp, but we can still send only via UDP. The syslog/tcp\n  receiver is the primary enhancement of this release.\n- slightly changed some error messages that contained a spurios \\n at\n  the end of the line (which gives empty lines in your log...)\n\n---------------------------------------------------------------------------\nVersion 0.9.1 (RGer)\n- fixed code so that it compiles without errors under FreeBSD\n- removed now unused function \"allocate_log()\" from syslogd.c\n- changed the make file so that it contains more defines for\n  different environments (in the long term, we need a better\n  system for disabling/enabling features...)\n- changed some printf's printing off_t types to %lld and\n  explicit (long long) casts. I tried to figure out the exact type,\n  but did not succeed in this. In the worst case, ultra-large peta-\n  byte files will now display funny informational messages on rollover,\n  something I think we can live with for the neersion 3.11.2 (rgerhards), 2008-02-??\n---------------------------------------------------------------------------\nVersion 3.11.1 (rgerhards), 2008-02-12\n- SNMP trap sender added thanks to Andre Lorbach (omsnmp)\n- added input-plugin interface specification in form of a (copy) template\n  input module\n- applied documentation fix by Michael Biebl -- many thanks!\n- bugfix: immark did not have MARK flags set...\n- added x-info field to rsyslogd startup/shutdown message. Hopefully\n  points users to right location for further info (many don't even know\n  they run rsyslog ;))\n- bugfix: trailing \":\" of tag was lost while parsing legacy syslog messages\n  without timestamp - thanks to Anders Blomdell for providing a patch!\n- fixed a bug in stringbuf.c related to STRINGBUF_TRIM_ALLOCSIZE, which\n  wasn't supposed to be used with rsyslog. Put a warning message up that\n  tells this feature is not tested and probably not worth the effort.\n  Thanks to Anders Blomdell fro bringing this to our attention\n- somewhat improved performance of string buffers\n- fixed bug that caused invalid treatment of tabs (HT) in rsyslog.conf\n- bugfix: setting for $EscapeCopntrolCharactersOnReceive was not \n  properly initialized\n- clarified usage of space-cc property replacer option\n- improved abort diagnostic handler\n- some initial effort for malloc/free runtime debugging support\n- bugfix: using dynafile actions caused rsyslogd abort\n- fixed minor man errors thanks to Michael Biebl\n---------------------------------------------------------------------------\nVersion 3.11.0 (rgerhards), 2008-01-31\n- implemented queued actions\n- implemented simple rate limiting for actions\n- implemented deliberate discarding of lower priority messages over higher\n  priority ones when a queue runs out of space\n- implemented disk quotas for disk queues\n- implemented the $ActionResumeRetryCount config directive\n- added $ActionQueueFilename config directive\n- added $ActionQueueSize config directive\n- added $ActionQueueHighWaterMark config directive\n- added $ActionQueueLowWaterMark config directive\n- added $ActionQueueDiscardMark config directive\n- added $ActionQueueDiscardSeverity config directive\n- added $ActionQueueCheckpointInterval config directive\n- added $ActionQueueType config directive\n- added $ActionQueueWorkerThreads config directive\n- added $ActionQueueTimeoutshutdown config directive\n- added $ActionQueueTimeoutActionCompletion config directive\n- added $ActionQueueTimeoutenQueue config directive\n- added $ActionQueueTimeoutworkerThreadShutdown config directive\n- added $ActionQueueWorkerThreadMinimumMessages config directive\n- added $ActionQueueMaxFileSize config directive\n- added $ActionQueueSaveonShutdown config directive\n- addded $ActionQueueDequeueSlowdown config directive\n- addded $MainMsgQueueDequeueSlowdown config directive\n- bugfix: added forgotten docs to package\n- improved debugging support\n- fixed a bug that caused $MainMsgQueueCheckpointInterval to work incorrectly\n- when a long-running action needs to be cancelled on shutdown, the message\n  that was processed by it is now preserved. This finishes support for\n  guaranteed delivery of messages (if the output supports it, of course)\n- fixed bug in output module interface, see\n  http://sourceforge.net/tracker/index.php?func=detail&aid=1881008&group_id=123448&atid=696552\n- changed the ommysql output plugin so that the (lengthy) connection\n  initialization now takes place in message processing. This works much\n  better with the new queued action mode (fast startup)\n- fixed a bug that caused a potential hang in file and fwd output module\n  varmojfekoj provided the patch - many thanks!\n- bugfixed stream class offset handling on 32bit platforms\n---------------------------------------------------------------------------\nVersion 3.10.3 (rgerhards), 2008-01-28\n- fixed a bug with standard template definitions (not a big deal) - thanks\n  to varmojfekoj for spotting it\n- run-time instrumentation added\n- implemented disk-assisted queue mode, which enables on-demand disk\n  spooling if the queue's in-memory queue is exhausted\n- implemented a dynamic worker thread pool for processing incoming\n  messages; workers are started and shut down as need arises\n- implemented a run-time instrumentation debug package\n- implemented the $MainMsgQueueSaveOnShutdown config directive\n- implemented the $MainMsgQueueWorkerThreadMinimumMessages config directive\n- implemented the $MainMsgQueueTimeoutWorkerThreadShutdown config directive\n---------------------------------------------------------------------------\nVersion 3.10.2 (rgerhards), 2008-01-14\n- added the ability to keep stop rsyslogd without the need to drain\n  the main message queue. In disk queue mode, rsyslog continues to\n  run from the point where it stopped. In case of a system failure, it\n  continues to process messages from the last checkpoint.\n- fixed a bug that caused a segfault on startup when no $WorkDir directive\n  was specified in rsyslog.conf\n- provided more fine-grain control over shutdown timeouts and added a\n  way to specify the enqueue timeout when the main message queue is full\n- implemented $MainMsgQueueCheckpointInterval config directive\n- implemented $MainMsgQueueTimeoutActionCompletion config directive\n- implemented $MainMsgQueueTimeoutEnqueue config directive\n- implemented $MainMsgQueueTimeoutShutdown config directive\n---------------------------------------------------------------------------\nVersion 3.10.1 (rgerhards), 2008-01-10\n- implemented the \"disk\" queue mode. However, it currently is of very\n  limited use, because it does not support persistence over rsyslogd\n  runs. So when rsyslogd is stopped, the queue is drained just as with\n  the in-memory queue modes. Persistent queues will be a feature of\n  the next release.\n- performance-optimized string class, should bring an overall improvement\n- fixed a memory leak in imudp -- thanks to varmojfekoj for the patch\n- fixed a race condition that could lead to a rsyslogd hang when during\n  HUP or termination\n- done some doc updates\n- added $WorkDirectory config directive\n- added $MainMsgQueueFileName config directive\n- added $MainMsgQueueMaxFileSize config directive\n---------------------------------------------------------------------------\nVersion 3.10.0 (rgerhards), 2008-01-07\n- implemented input module interface and initial input modules\n- enhanced threading for input modules (each on its own thread now)\n- ability to bind UDP listeners to specific local interfaces/ports and\n  ability to run multiple of them concurrently\n- added ability to specify listen IP address for UDP syslog server\n- license changed to GPLv3\n- mark messages are now provided by loadble module immark\n- rklogd is no longer provided. Its functionality has now been taken over\n  by imklog, a loadable input module. This offers a much better integration\n  into rsyslogd and makes sure that the kernel logger process is brought\n  up and down at the appropriate times\n- enhanced $IncludeConfig directive to support wildcard characters\n  (thanks to Michael Biebl)\n- all inputs are now implemented as loadable plugins\n- enhanced threading model: each input module now runs on its own thread\n- enhanced message queue which now supports different queueing methods\n  (among others, this can be used for performance fine-tuning)\n- added a large number of new configuration directives for the new\n  input modules\n- enhanced multi-threading utilizing a worker thread pool for the\n  main message queue\n- compilation without pthreads is no longer supported\n- much cleaner code due to new objects and removal of single-threading\n  mode\n---------------------------------------------------------------------------\nVersion 2.0.1 STABLE (rgerhards), 2008-01-24\n- fixed a bug in integer conversion - but this function was never called,\n  so it is not really a useful bug fix ;)\n- fixed a bug with standard template definitions (not a big deal) - thanks\n  to varmojfekoj for spotting it\n- fixed a bug that caused a potential hang in file and fwd output module\n  varmojfekoj provided the patch - many thanks!\n---------------------------------------------------------------------------\nVersion 2.0.0 STABLE (rgerhards), 2008-01-02\n- re-release of 1.21.2 as STABLE with no modifications except some\n  doc updates\n---------------------------------------------------------------------------\nVersion 1.21.2 (rgerhards), 2007-12-28\n- created a gss-api output module. This keeps GSS-API code and\n  TCP/UDP code separated. It is also important for forward-\n  compatibility with v3. Please note that this change breaks compatibility\n  with config files created for 1.21.0 and 1.21.1 - this was considered\n  acceptable.\n- fixed an error in forwarding retry code (could lead to message corruption\n  but surfaced very seldom)\n- increased portability for older platforms (AI_NUMERICSERV moved)\n- removed socket leak in omfwd.c\n- cross-platform patch for GSS-API compile problem on some platforms\n  thanks to darix for the patch!\n---------------------------------------------------------------------------\nVersion 1.21.1 (rgerhards), 2007-12-23\n- small doc fix for $IncludeConfig\n- fixed a bug in llDestroy()\n- bugfix: fixing memory leak when message queue is full and during\n  parsing. Thanks to varmojfekoj for the patch.\n- bugfix: when compiled without network support, unix sockets were\n  not properply closed\n- bugfix: memory leak in cfsysline.c/doGetWord() fixed\n---------------------------------------------------------------------------\nVersion 1.21.0 (rgerhards), 2007-12-19\n- GSS-API support for syslog/TCP connections was added. Thanks to\n  varmojfekoj for providing the patch with this functionality\n- code cleanup\n- enhanced $IncludeConfig directive to support wildcard filenames\n- changed some multithreading synchronization\n---------------------------------------------------------------------------\nVersion 1.20.1 (rgerhards), 2007-12-12\n- corrected a debug setting that survived release. Caused TCP connections\n  to be retried unnecessarily often.\n- When a hostname ACL was provided and DNS resolution for that name failed,\n  ACL processing was stopped at that point. Thanks to mildew for the patch.\n  Fedora Bugzilla: http://bugzilla.redhat.com/show_bug.cgi?id=395911\n- fixed a potential race condition, see link for details:\n  http://rgerhards.blogspot.com/2007/12/rsyslog-race-condition.html\n  Note that the probability of problems from this bug was very remote\n- fixed a memory leak that happend when PostgreSQL date formats were\n  used\n---------------------------------------------------------------------------\nVersion 1.20.0 (rgerhards), 2007-12-07\n- an output module for postgres databases has been added. Thanks to\n  sur5r for contributing this code\n- unloading dynamic modules has been cleaned up, we now have a\n  real implementation and not just a dummy \"good enough for the time\n  being\".\n- enhanced platform independence - thanks to Bartosz Kuzma and Michael\n  Biebl for their very useful contributions\n- some general code cleanup (including warnings on 64 platforms, only)\n---------------------------------------------------------------------------\nVersion 1.19.12 (rgerhards), 2007-12-03\n- cleaned up the build system (thanks to Michael Biebl for the patch)\n- fixed a bug where ommysql was still not compiled with -pthread option\n---------------------------------------------------------------------------\nVersion 1.19.11 (rgerhards), 2007-11-29\n- applied -pthread option to build when building for multi-threading mode\n  hopefully solves an issue with segfaulting\n---------------------------------------------------------------------------\nVersion 1.19.10 (rgerhards), 2007-10-19\n- introdcued the new \":modulename:\" syntax for calling module actions\n  in selector lines; modified ommysql to support it. This is primarily\n  an aid for further modules and a prequisite to actually allow third\n  party modules to be created.\n- minor fix in slackware startup script, \"-r 0\" is now \"-r0\"\n- updated rsyslogd doc set man page; now in html format\n- undid creation of a separate thread for the main loop -- this did not\n  turn out to be needed or useful, so reduce complexity once again.\n- added doc fixes provided by Michael Biebl - thanks\n---------------------------------------------------------------------------\nVersion 1.19.9 (rgerhards), 2007-10-12\n- now packaging system which again contains all components in a single\n  tarball\n- modularized main() a bit more, resulting in less complex code\n- experimentally added an additional thread - will see if that affects\n  the segfault bug we experience on some platforms. Note that this change\n  is scheduled to be removed again later.\n---------------------------------------------------------------------------\nVersion 1.19.8 (rgerhards), 2007-09-27\n- improved repeated message processing\n- applied patch provided by varmojfekoj to support building ommysql\n  in its own way (now also resides in a plugin subdirectory);\n  ommysql is now a separate package\n- fixed a bug in cvthname() that lead to message loss if part\n  of the source hostname would have been dropped\n- created some support for distributing ommysql together with the\n  main rsyslog package. I need to re-think it in the future, but\n  for the time being the current mode is best. I now simply include\n  one additional tarball for ommysql inside the main distribution.\n  I look forward to user feedback on how this should be done best. In the\n  long term, a separate project should be spawend for ommysql, but I'd\n  like to do that only after the plugin interface is fully stable (what\n  it is not yet).\n---------------------------------------------------------------------------\nVersion 1.19.7 (rgerhards), 2007-09-25\n- added code to handle situations where senders send us messages ending with\n  a NUL character. It is now simply removed. This also caused trailing LF\n  reduction to fail, when it was followed by such a NUL. This is now also\n  handled.\n- replaced some non-thread-safe function calls by their thread-safe\n  counterparts\n- fixed a minor memory leak that occured when the %APPNAME% property was\n  used (I think nobody used that in practice)\n- fixed a bug that caused signal handlers in cvthname() not to be restored when\n  a malicious pointer record was detected and processing of the message been\n  stopped for that reason (this should be really rare and can not be related\n  to the segfault bug we are hunting).\n- fixed a bug in cvthname that lead to passing a wrong parameter - in\n  practice, this had no impact.\n- general code cleanup (e.g. compiler warnings, comments)\n---------------------------------------------------------------------------\nVersion 1.19.6 (rgerhards), 2007-09-11\n- applied patch by varmojfekoj to change signal handling to the new\n  sigaction API set (replacing the depreciated signal() calls and its\n  friends.\n- fixed a bug that in --enable-debug mode caused an assertion when the\n  discard action was used\n- cleaned up compiler warnings\n- applied patch by varmojfekoj to FIX a bug that could cause \n  segfaults if empty properties were processed using modifying\n  options (e.g. space-cc, drop-cc)\n- fixed man bug: rsyslogd supports -l option\n---------------------------------------------------------------------------\nVersion 1.19.5 (rgerhards), 2007-09-07\n- changed part of the CStr interface so that better error tracking\n  is provided and the calling sequence is more intuitive (there were\n  invalid calls based on a too-weired interface)\n- (hopefully) fixed some remaining bugs rooted in wrong use of \n  the CStr class. These could lead to program abort.\n- applied patch by varmojfekoj two fix two potential segfault situations\n- added $ModDir config directive\n- modified $ModLoad so that an absolute path may be specified as\n  module name (e.g. /rsyslog/ommysql.so)\n---------------------------------------------------------------------------\nVersion 1.19.4 (rgerhards/varmojfekoj), 2007-09-04\n- fixed a number of small memory leaks - thanks varmojfekoj for patching\n- fixed an issue with CString class that could lead to rsyslog abort\n  in tplToString() - thanks varmojfekoj for patching\n- added a man-version of the config file documenation - thanks to Michel\n  Samia for providing the man file\n- fixed bug: a template like this causes an infinite loop:\n  $template opts,\"%programname:::a,b%\"\n  thanks varmojfekoj for the patch\n- fixed bug: case changing options crash freeing the string pointer\n  because they modify it: $template opts2,\"%programname::1:lowercase%\"\n  thanks varmojfekoj for the patch\n---------------------------------------------------------------------------\nVersion 1.19.3 (mmeckelein/varmojfekoj), 2007-08-31\n- small mem leak fixed (after calling parseSelectorAct) - Thx varmojkekoj\n- documentation section \"Regular File\" und \"Blocks\" updated\n- solved an issue with dynamic file generation - Once again many thanks\n  to varmojfekoj\n- the negative selector for program name filter (Blocks) does not work as\n  expected - Thanks varmojfekoj for patching\n- added forwarding information to sysklogd (requires special template)\n  to config doc\n---------------------------------------------------------------------------\nVersion 1.19.2 (mmeckelein/varmojfekoj), 2007-08-28\n- a specifically formed message caused a segfault - Many thanks varmojfekoj\n  for providing a patch\n- a typo and a weird condition are fixed in msg.c - Thanks again\n  varmojfekoj \n- on file creation the file was always owned by root:root. This is fixed\n  now - Thanks ypsa for solving this issue\n---------------------------------------------------------------------------\nVersion 1.19.1 (mmeckelein), 2007-08-22\n- a bug that caused a high load when a TCP/UDP connection was closed is \n  fixed now - Thanks mildew for solving this issue\n- fixed a bug which caused a segfault on reinit - Thx varmojfekoj for the\n  patch\n- changed the hardcoded module path \"/lib/rsyslog\" to $(pkglibdir) in order\n  to avoid trouble e.g. on 64 bit platforms (/lib64) - many thanks Peter\n  Vrabec and darix, both provided a patch for solving this issue\n- enhanced the unloading of modules - thanks again varmojfekoj\n- applied a patch from varmojfekoj which fixes various little things in\n  MySQL output module\n---------------------------------------------------------------------------\nVersion 1.19.0 (varmojfekoj/rgerhards), 2007-08-16\n- integrated patch from varmojfekoj to make the mysql module a loadable one\n  many thanks for the patch, MUCH appreciated\n---------------------------------------------------------------------------\nVersion 1.18.2 (rgerhards), 2007-08-13\n- fixed a bug in outchannel code that caused templates to be incorrectly\n  parsed\n- fixed a bug in ommysql that caused a wrong \";template\" missing message\n- added some code for unloading modules; not yet fully complete (and we do\n  not yet have loadable modules, so this is no problem)\n- removed debian subdirectory by request of a debian packager (this is a special\n  subdir for debian and there is also no point in maintaining it when there\n  is a debian package available - so I gladly did this) in some cases\n- improved overall doc quality (some pages were quite old) and linked to\n  more of the online resources.\n- improved /contrib/delete_mysql script by adding a host option and some\n  other minor modifications\n---------------------------------------------------------------------------\nVersion 1.18.1 (rgerhards), 2007-08-08\n- applied a patch from varmojfekoj which solved a potential segfault\n  of rsyslogd on HUP\n- applied patch from Michel Samia to fix compilation when the pthreads\n  feature is disabled\n- some code cleanup (moved action object to its own file set)\n- add config directive $MainMsgQueueSize, which now allows to configure the\n  queue size dynamically\n- all compile-time settings are now shown in rsyslogd -v, not just the\n  active ones\n- enhanced performance a little bit more\n- added config file directive $ActionResumeInterval\n- fixed a bug that prevented compilation under debian sid\n- added a contrib directory for user-contributed useful things\n---------------------------------------------------------------------------\nVersion 1.18.0 (rgerhards), 2007-08-03\n- rsyslog now supports fallback actions when an action did not work. This\n  is a great feature e.g. for backup database servers or backup syslog\n  servers\n- modified rklogd to only change the console log level if -c is specified\n- added feature to use multiple actions inside a single selector\n- implemented $ActionExecOnlyWhenPreviousIsSuspended config directive\n- error messages during startup are now spit out to the configured log\n  destinations\n---------------------------------------------------------------------------\nVersion 1.17.6 (rgerhards), 2007-08-01\n- continued to work on output module modularization - basic stage of\n  this work is now FINISHED\n- fixed bug in OMSRcreate() - always returned SR_RET_OK\n- fixed a bug that caused ommysql to always complain about missing\n  templates\n- fixed a mem leak in OMSRdestruct - freeing the object itself was\n  forgotten - thanks to varmojfekoj for the patch\n- fixed a memory leak in syslogd/init() that happend when the config\n  file could not be read - thanks to varmojfekoj for the patch\n- fixed insufficient memory allocation in addAction() and its helpers.\n  The initial fix and idea was developed by mildew, I fine-tuned\n  it a bit. Thanks a lot for the fix, I'd probably had pulled out my\n  hair to find the bug...\n- added output of config file line number when a parsing error occured\n- fixed bug in objomsr.c that caused program to abort in debug mode with\n  an invalid assertion (in some cases)\n- fixed a typo that caused the default template for MySQL to be wrong.\n  thanks to mildew for catching this.\n- added configuration file command $DebugPrintModuleList and\n  $DebugPrintCfSysLineHandlerList\n- fixed an invalid value for the MARK timer - unfortunately, there was\n  a testing aid left in place. This resulted in quite frequent MARK messages\n- added $IncludeConfig config directive\n- applied a patch from mildew to prevent rsyslogd from freezing under heavy\n  load. This could happen when the queue was full. Now, we drop messages\n  but rsyslogd remains active.\n---------------------------------------------------------------------------\nVersion 1.17.5 (rgerhards), 2007-07-30\n- continued to work on output module modularization\n- fixed a missing file bug - thanks to Andrea Montanari for reporting\n  this problem\n- fixed a problem with shutting down the worker thread and freeing the\n  selector_t list - this caused messages to be lost, because the\n  message queue was not properly drained before the selectors got\n  destroyed.\n---------------------------------------------------------------------------\nVersion 1.17.4 (rgerhards), 2007-07-27\n- continued to work on output module modularization\n- fixed a situation where rsyslogd could create zombie processes\n  thanks to mildew for the patch\n- applied patch from Michel Samia to fix compilation when NOT\n  compiled for pthreads\n---------------------------------------------------------------------------\nVersion 1.17.3 (rgerhards), 2007-07-25\n- continued working on output module modularization\n- fixed a bug that caused rsyslogd to segfault on exit (and\n  probably also on HUP), when there was an unsent message in a selector\n  that required forwarding and the dns lookup failed for that selector\n  (yes, it was pretty unlikely to happen;))\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- fixed a memory leak in config file parsing and die()\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- rsyslogd now checks on startup if it is capable to performa any work\n  at all. If it cant, it complains and terminates\n  thanks to Michel Samia for providing the patch!\n- fixed a small memory leak when HUPing syslogd. The allowed sender\n  list now gets freed. thanks to mildew for the patch.\n- changed the way error messages in early startup are logged. They\n  now do no longer use the syslogd code directly but are rather\n  send to stderr.\n---------------------------------------------------------------------------\nVersion 1.17.2 (rgerhards), 2007-07-23\n- made the port part of the -r option optional. Needed for backward\n  compatibility with sysklogd\n- replaced system() calls with something more reasonable. Please note that\n  this might break compatibility with some existing configuration files.\n  We accept this in favour of the gained security.\n- removed a memory leak that could occur if timegenerated was used in\n  RFC 3164 format in templates\n- did some preparation in msg.c for advanced multithreading - placed the\n  hooks, but not yet any active code\n- worked further on modularization\n- added $ModLoad MySQL (dummy) config directive\n- added DropTrailingLFOnReception config directive\n---------------------------------------------------------------------------\nVersion 1.17.1 (rgerhards), 2007-07-20\n- fixed a bug that caused make install to install rsyslogd and rklogd under\n  the wrong names\n- fixed bug that caused $AllowedSenders to handle IPv6 scopes incorrectly;\n  also fixed but that could grabble $AllowedSender wildcards. Thanks to\n  mildew@gmail.com for the patch\n- minor code cleanup - thanks to Peter Vrabec for the patch\n- fixed minimal memory leak on HUP (caused by templates)\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- fixed another memory leak on HUPing and on exiting rsyslogd\n  again thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- code cleanup (removed compiler warnings)\n- fixed portability bug in configure.ac - thanks to Bartosz Ku\u017ama for patch\n- moved msg object into its own file set\n- added the capability to continue trying to write log files when the\n  file system is full. Functionality based on patch by Martin Schulze\n  to sysklogd package.\n---------------------------------------------------------------------------\nVersion 1.17.0 (RGer), 2007-07-17\n- added $RepeatedLineReduction config parameter\n- added $EscapeControlCharactersOnReceive config parameter\n- added $ControlCharacterEscapePrefix config parameter\n- added $DirCreateMode config parameter\n- added $CreateDirs config parameter\n- added $DebugPrintTemplateList config parameter\n- added $ResetConfigVariables config parameter\n- added $FileOwner config parameter\n- added $FileGroup config parameter\n- added $DirOwner config parameter\n- added $DirGroup config parameter\n- added $FailOnChownFailure config parameter\n- added regular expression support to the filter engine\n  thanks to Michel Samia for providing the patch!\n- enhanced $AllowedSender functionality. Credits to mildew@gmail.com for\n  the patch doing that\n  - added IPv6 support\n  - allowed DNS hostnames\n  - allowed DNS wildcard names\n- added new option $DropMsgsWithMaliciousDnsPTRRecords\n- added autoconf so that rfc3195d, rsyslogd and klogd are stored to /sbin\n- added capability to auto-create directories with dynaFiles\n---------------------------------------------------------------------------\nVersion 1.16.0 (RGer/Peter Vrabec), 2007-07-13 - The Friday, 13th Release ;)\n- build system switched to autotools\n- removed SYSV preprocessor macro use, replaced with autotools equivalents\n- fixed a bug that caused rsyslogd to segfault when TCP listening was\n  disabled and it terminated\n- added new properties \"syslogfacility-text\" and \"syslogseverity-text\"\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- added the -x option to disable hostname dns reslution\n  thanks to varmojfekoj <varmojfekoj@gmail.com> for the patch\n- begun to better modularize syslogd.c - this is an ongoing project; moved\n  type definitions to a separate file\n- removed some now-unused fields from struct filed\n- move file size limit fields in struct field to the \"right spot\" (the file\n  writing part of the union - f_un.f_file)\n- subdirectories linux and solaris are no longer part of the distribution\n  package. This is not because we cease support for them, but there are no\n  longer any files in them after the move to autotools\n---------------------------------------------------------------------------\nVersion 1.15.1 (RGer), 2007-07-10\n- fixed a bug that caused a dynaFile selector to stall when there was\n  an open error with one file \n- improved template processing for dynaFiles; templates are now only\n  looked up during initialization - speeds up processing\n- optimized memory layout in struct filed when compiled with MySQL\n  support\n- fixed a bug that caused compilation without SYSLOG_INET to fail\n- re-enabled the \"last message repeated n times\" feature. This\n  feature was not taken care of while rsyslogd evolved from sysklogd\n  and it was more or less defunct. Now it is fully functional again.\n- added system properties: $NOW, $YEAR, $MONTH, $DAY, $HOUR, $MINUTE\n- fixed a bug in iovAsString() that caused a memory leak under stress\n  conditions (most probably memory shortage). This was unlikely to\n  ever happen, but it doesn't hurt doing it right\n- cosmetic: defined type \"uchar\", change all unsigned chars to uchar\n---------------------------------------------------------------------------\nVersion 1.15.0 (RGer), 2007-07-05\n- added ability to dynamically generate file names based on templates\n  and thus properties. This was a much-requested feature. It makes\n  life easy when it e.g. comes to splitting files based on the sender\n  address.\n- added $umask and $FileCreateMode config file directives\n- applied a patch from Bartosz Kuzma to compile cleanly under NetBSD\n- checks for extra (unexpected) characters in system config file lines\n  have been added\n- added IPv6 documentation - was accidently missing from CVS\n- begun to change char to unsigned char\n---------------------------------------------------------------------------\nVersion 1.14.2 (RGer), 2007-07-03\n** this release fixes all known nits with IPv6 **\n- restored capability to do /etc/service lookup for \"syslog\"\n  service when -r 0 was given\n- documented IPv6 handling of syslog messages\n- integrate patch from Bartosz Ku\u017ama to make rsyslog compile under\n  Solaris again (the patch replaced a strndup() call, which is not\n  available under Solaris\n- improved debug logging when waiting on select\n- updated rsyslogd man page with new options (-46A)\n---------------------------------------------------------------------------\nVersion 1.14.1 (RGer/Peter Vrabec), 2007-06-29\n- added Peter Vrabec's patch for IPv6 TCP\n- prefixed all messages send to stderr in rsyslogd with \"rsyslogd: \"\n---------------------------------------------------------------------------\nVersion 1.14.0 (RGer/Peter Vrabec), 2007-06-28\n- Peter Vrabec provided IPv6 for rsyslog, so we are now IPv6 enabled\n  IPv6 Support is currently for UDP only, TCP is to come soon.\n  AllowedSender configuration does not yet work for IPv6.\n- fixed code in iovCreate() that broke C's strict aliasing rules \n- fixed some char/unsigned char differences that forced the compiler\n  to spit out warning messages\n- updated the Red Hat init script to fix a known issue (thanks to\n  Peter Vrabec)\n---------------------------------------------------------------------------\nVersion 1.13.5 (RGer), 2007-06-22\n- made the TCP session limit configurable via command line switch\n  now -t <port>,<max sessions>\n- added man page for rklogd(8) (basically a copy from klogd, but now\n  there is one...)\n- fixed a bug that caused internal messages (e.g. rsyslogd startup) to\n  appear without a tag.\n- removed a minor memory leak that occurred when TAG processing requalified\n  a HOSTNAME to be a TAG (and a TAG already was set).\n- removed potential small memory leaks in MsgSet***() functions. There\n  would be a leak if a property was re-set, something that happened\n  extremely seldom.\n---------------------------------------------------------------------------\nVersion 1.13.4 (RGer), 2007-06-18\n- added a new property \"PRI-text\", which holds the PRI field in\n  textual form (e.g. \"syslog.info\")\n- added alias \"syslogseverity\" for \"syslogpriority\", which is a\n  misleading property name that needs to stay for historical\n  reasons (and backward-compatility)\n- added doc on how to record PRI value in log file\n- enhanced signal handling in klogd, including removal of an unsafe\n  call to the logging system during signal handling\n---------------------------------------------------------------------------\nVersion 1.13.3 (RGer), 2007-06-15\n- create a version of syslog.c from scratch. This is now\n  - highly optimized for rsyslog\n  - removes an incompatible license problem as the original\n    version had a BSD license with advertising clause\n  - fixed in the regard that rklogd will continue to work when\n    rsysogd has been restarted (the original version, as well\n    as sysklogd, will remain silent then)\n  - solved an issue with an extra NUL char at message end that the\n    original version had\n- applied some changes to klogd to care for the new interface\n- fixed a bug in syslogd.c which prevented compiling under debian\n---------------------------------------------------------------------------\nVersion 1.13.2 (RGer), 2007-06-13\n- lib order in makefile patched to facilitate static linking - thanks\n  to Bennett Todd for providing the patch\n- Integrated a patch from Peter Vrabec (pvrabec@redheat.com):\n  - added klogd under the name of rklogd (remove dependency on\n    original sysklogd package\n  - createDB.sql now in UTF\n  - added additional config files for use on Red Hat\n---------------------------------------------------------------------------\nVersion 1.13.1 (RGer), 2007-02-05\n- changed the listen backlog limit to a more reasonable value based on\n  the maximum number of TCP connections configurd (10% + 5) - thanks to Guy\n  Standen for the hint (actually, the limit was 5 and that was a \n  left-over from early testing).\n- fixed a bug in makefile which caused DB-support to be disabled when\n  NETZIP support was enabled\n- added the -e option to allow transmission of every message to remote\n  hosts (effectively turns off duplicate message suppression)\n- (somewhat) improved memory consumption when compiled with MySQL support\n- looks like we fixed an incompatibility with MySQL 5.x and above software\n  At least in one case, the remote server name was destroyed, leading to \n  a connection failure. The new, improved code does not have this issue and\n  so we see this as solved (the new code is generally somewhat better, so\n  there is a good chance we fixed this incompatibility).\n---------------------------------------------------------------------------\nVersion 1.13.0 (RGer), 2006-12-19\n- added '$' as ToPos proptery replacer specifier - means \"up to the\n  end of the string\"\n- property replacer option \"escape-cc\", \"drop-cc\" and \"space-cc\"  added\n- changed the handling of \\0 characters inside syslog messages. We now\n  consistently escape them to \"#000\". This is somewhat recommended in\n  the draft-ietf-syslog-protocol-19 draft. While the real recomendation\n  is to not escape any characters at all, we can not do this without\n  considerable modification of the code. So we escape it to \"#000\", which\n  is consistent with a sample found in the Internet-draft.\n- removed message glue logic (see printchopped() comment for details)\n  Also caused removal of parts table and thus some improvements in\n  memory usage.\n- changed the default MAXLINE to 2048 to take care of recent syslog\n  standardization efforts (can easily be changed in syslogd.c)\n- added support for byte-counted TCP syslog messages (much like\n  syslog-transport-tls-05 Internet Draft). This was necessary to\n  support compression over TCP.\n- added support for receiving compressed syslog messages\n- added support for sending compressed syslog messages\n- fixed a bug where the last message in a syslog/tcp stream was\n  lost if it was not properly terminated by a LF character\n---------------------------------------------------------------------------\nVersion 1.12.3 (RGer), 2006-10-04\n- implemented some changes to support Solaris (but support is not\n  yet complete)\n- commented out (via #if 0) some methods that are currently not being use\n  but should be kept for further us\n- added (interim) -u 1 option to turn off hostname and tag parsing\n- done some modifications to better support Fedora\n- made the field delimiter inside property replace configurable via\n  template\n- fixed a bug in property replacer: if fields were used, the delimitor\n  became part of the field. Up until now, this was barely noticable as \n  the delimiter as TAB only and thus invisible to a human. With other\n  delimiters available now, it quickly showed up. This bug fix might cause\n  some grief to existing installations if they used the extra TAB for\n  whatever reasons - sorry folks... Anyhow, a solution is easy: just add\n  a TAB character contstant into your template. Thus, there has no attempt\n  been made to do this in a backwards-compatible way.\n---------------------------------------------------------------------------\nVersion 1.12.2 (RGer), 2006-02-15\n- fixed a bug in the RFC 3339 date formatter. An extra space was added\n  after the actual timestamp\n- added support for providing high-precision RFC3339 timestamps for\n  (rsyslogd-)internally-generated messages\n- very (!) experimental support for syslog-protocol internet draft\n  added (the draft is experimental, the code is solid ;))\n- added support for field-extracting in the property replacer\n- enhanced the legacy-syslog parser so that it can interpret messages\n  that do not contain a TIMESTAMP\n- fixed a bug that caused the default socket (usually /dev/log) to be\n  opened even when -o command line option was given\n- fixed a bug in the Debian sample startup script - it caused rsyslogd\n  to listen to remote requests, which it shouldn't by default\n---------------------------------------------------------------------------\nVersion 1.12.1 (RGer), 2005-11-23\n- made multithreading work with BSD. Some signal-handling needed to be\n  restructured. Also, there might be a slight delay of up to 10 seconds\n  when huping and terminating rsyslogd under BSD\n- fixed a bug where a NULL-pointer was passed to printf() in logmsg().\n- fixed a bug during \"make install\" where rc3195d was not installed\n  Thanks to Bennett Todd for spotting this.\n- fixed a bug where rsyslogd dumped core when no TAG was found in the\n  received message\n- enhanced message parser so that it can deal with missing hostnames\n  in many cases (may not be totally fail-safe)\n- fixed a bug where internally-generated messages did not have the correct\n  TAG\n---------------------------------------------------------------------------\nVersion 1.12.0 (RGer), 2005-10-26\n- moved to a multi-threaded design. single-threading is still optionally\n  available. Multi-threading is experimental!\n- fixed a potential race condition. In the original code, marking was done\n  by an alarm handler, which could lead to all sorts of bad things. This\n  has been changed now. See comments in syslogd.c/domark() for details.\n- improved debug output for property-based filters\n- not a code change, but: I have checked all exit()s to make sure that\n  none occurs once rsyslogd has started up. Even in unusual conditions\n  (like low-memory conditions) rsyslogd somehow remains active. Of course,\n  it might loose a message or two, but at least it does not abort and it\n  can also recover when the condition no longer persists.\n- fixed a bug that could cause loss of the last message received\n  immediately before rsyslogd was terminated.\n- added comments on thread-safety of global variables in syslogd.c\n- fixed a small bug: spurios printf() when TCP syslog was used\n- fixed a bug that causes rsyslogd to dump core on termination when one\n  of the selector lines did not receive a message during the run (very\n  unlikely)\n- fixed an one-too-low memory allocation in the TCP sender. Could result\n  in rsyslogd dumping core.\n- fixed a bug with regular expression support (thanks to Andres Riancho)\n- a little bit of code restructuring (especially main(), which was\n  horribly large)\n---------------------------------------------------------------------------\nVersion 1.11.1 (RGer), 2005-10-19\n- support for BSD-style program name and host blocks\n- added a new property \"programname\" that can be used in templates\n- added ability to specify listen port for rfc3195d\n- fixed a bug that rendered the \"startswith\" comparison operation\n  unusable.\n- changed more functions to \"static\" storage class to help compiler\n  optimize (should have been static in the first place...)\n- fixed a potential memory leak in the string buffer class destructor.\n  As the destructur was previously never called, the leak did not actually\n  appear.\n- some internal restructuring in anticipation/preparation of minimal\n  multi-threading support\n- rsyslogd still shares some code with the sysklogd project. Some patches\n  for this shared code have been brought over from the sysklogd CVS.\n---------------------------------------------------------------------------\nVersion 1.11.0 (RGer), 2005-10-12\n- support for receiving messages via RFC 3195; added rfc3195d for that\n  purpose\n- added an additional guard to prevent rsyslogd from aborting when the\n  2gb file size limit is hit. While a user can configure rsyslogd to\n  handle such situations, it would abort if that was not done AND large\n  file support was not enabled (ok, this is hopefully an unlikely scenario)\n- fixed a bug that caused additional Unix domain sockets to be incorrectly\n  processed - could lead to message loss in extreme cases\n---------------------------------------------------------------------------\nVersion 1.10.2 (RGer), 2005-09-27\n- added comparison operations in property-based filters:\n  * isequal\n  * startswith\n- added ability to negate all property-based filter comparison operations\n  by adding a !-sign right in front of the operation name\n- added the ability to specify remote senders for UDP and TCP\n  received messages. Allows to block all but well-known hosts\n- changed the $-config line directives to be case-INsensitive\n- new command line option -w added: \"do not display warnings if messages\n  from disallowed senders are received\"\n- fixed a bug that caused rsyslogd to dump core when the compare value\n  was not quoted in property-based filters\n- fixed a bug in the new CStr compare function which lead to invalid\n  results (fortunately, this function was not yet used widely)\n- added better support for \"debugging\" rsyslog.conf property filters\n  (only if -d switch is given)\n- changed some function definitions to static, which eventually enables\n  some compiler optimizations\n- fixed a bug in MySQL code; when a SQL error occured, rsyslogd could\n  run in a tight loop. This was due to invalid sequence of error reporting\n  and is now fixed.\n---------------------------------------------------------------------------\nVersion 1.10.1 (RGer), 2005-09-23\n- added the ability to execute a shell script as an action.\n  Thanks to Bjoern Kalkbrenner for providing the code!\n- fixed a bug in the MySQL code; due to the bug the automatic one-time\n  retry after an error did not happen - this lead to error message in\n  cases where none should be seen (e.g. after a MySQL restart)\n- fixed a security issue with SQL-escaping in conjunction with\n  non-(SQL-)standard MySQL features.\n---------------------------------------------------------------------------\nVersion 1.10.0 (RGer), 2005-09-20\n  REMINDER: 1.10 is the first unstable version if the 1.x series!\n- added the capability to filter on any property in selector lines\n  (not just facility and priority)\n- changed stringbuf into a new counted string class\n- added support for a \"discard\" action. If a selector line with\n  discard (~ character) is found, no selector lines *after* that\n  line will be processed.\n- thanks to Andres Riancho, regular expression support has been\n  added to the template engine\n- added the FROMHOST property in the template processor, which could\n  previously not be obtained. Thanks to Cristian Testa for pointing\n  this out and even providing a fix.\n- added display of compile-time options to -v output\n- performance improvement for production build - made some checks\n  to happen only during debug mode\n- fixed a problem with compiling on SUSE and - while doing so - removed\n  the socket call to set SO_BSDCOMPAT in cases where it is obsolete.\n---------------------------------------------------------------------------\nVersion 1.0.4 (RGer), 2006-02-01\n- a small but important fix: the tcp receiver had two forgotten printf's\n  in it that caused a lot of unnecessary output to stdout. This was\n  important enough to justify a new release\n---------------------------------------------------------------------------\nVersion 1.0.3 (RGer), 2005-11-14\n- added an additional guard to prevent rsyslogd from aborting when the\n  2gb file size limit is hit. While a user can configure rsyslogd to\n  handle such situations, it would abort if that was not done AND large\n  file support was not enabled (ok, this is hopefully an unlikely scenario)\n- fixed a bug that caused additional Unix domain sockets to be incorrectly\n  processed - could lead to message loss in extreme cases\n- applied some patches available from the sysklogd project to code\n  shared from there\n- fixed a bug that causes rsyslogd to dump core on termination when one\n  of the selector lines did not receive a message during the run (very\n  unlikely)\n- fixed an one-too-low memory allocation in the TCP sender. Could result\n  in rsyslogd dumping core.\n- fixed a bug in the TCP sender that caused the retry logic to fail\n  after an error or receiver overrun\n- fixed a bug in init() that could lead to dumping core\n- fixed a bug that could lead to dumping core when no HOSTNAME or no TAG\n  was present in the syslog message\n---------------------------------------------------------------------------\nVersion 1.0.2 (RGer), 2005-10-05\n- fixed an issue with MySQL error reporting. When an error occured,\n  the MySQL driver went into an endless loop (at least in most cases).\n---------------------------------------------------------------------------\nVersion 1.0.1 (RGer), 2005-09-23\n- fixed a security issue with SQL-escaping in conjunction with\n  non-(SQL-)standard MySQL features.\n---------------------------------------------------------------------------\nVersion 1.0.0 (RGer), 2005-09-12\n- changed install doc to cover daily cron scripts - a trouble source\n- added rc script for slackware (provided by Chris Elvidge - thanks!) \n- fixed a really minor bug in usage() - the -r option was still\n  reported as without the port parameter\n---------------------------------------------------------------------------\nVersion 0.9.8 (RGer), 2005-09-05\n- made startup and shutdown message more consistent and included the\n  pid, so that they can be easier correlated. Used syslog-protocol\n  structured data format for this purpose.\n- improved config info in startup message, now tells not only\n  if it is listening remote on udp, but also for tcp. Also includes\n  the port numbers. The previous startup message was misleading, because\n  it did not say \"remote reception\" if rsyslogd was only listening via\n  tcp (but not via udp).\n- added a \"how can you help\" document to the doc set\n---------------------------------------------------------------------------\nVersion 0.9.7 (RGer), 2005-08-15\n- some of the previous doc files (like INSTALL) did not properly\n  reflect the changes to the build process and the new doc. Fixed\n  that.\n- changed syslogd.c so that when compiled without database support,\n  an error message is displayed when a database action is detected\n  in the config file (previously this was used as an user rule ;))\n- fixed a bug in the os-specific Makefiles which caused MySQL\n  support to not be compiled, even if selected\n---------------------------------------------------------------------------\nVersion 0.9.6 (RGer), 2005-08-09\n- greatly enhanced documentation. Now available in html format in\n  the \"doc\" folder and FreeBSD. Finally includes an install howto.\n- improved MySQL error messages a little - they now show up as log\n  messages, too (formerly only in debug mode)\n- added the ability to specify the listen port for udp syslog.\n  WARNING: This introduces an incompatibility. Formerly, udp\n  syslog was enabled by the -r command line option. Now, it is\n  \"-r [port]\", which is consistent with the tcp listener. However,\n  just -r will now return an error message.\n- added sample startup scripts for Debian and FreeBSD\n- added support for easy feature selection in the makefile. Un-\n  fortunately, this also means I needed to spilt the make file\n  for different OS and distros. There are some really bad syntax\n  differences between FreeBSD and Linux make.\n---------------------------------------------------------------------------\nVersion 0.9.5 (RGer), 2005-08-01\n- the \"semicolon bug\" was actually not (fully) solved in 0.9.4. One\n  part of the bug was solved, but another still existed. This one\n  is fixed now, too.\n- the \"semicolon bug\" actually turned out to be a more generic bug.\n  It appeared whenever an invalid template name was given. With some\n  selector actions, rsyslogd dumped core, with other it \"just\" had\n  a small ressource leak with others all worked well. These anomalies\n  are now fixed. Note that they only appeared during system initaliziation\n  once the system was running, nothing bad happened.\n- improved error reporting for template errors on startup. They are now\n  shown on the console and the start-up tty. Formerly, they were only\n  visible in debug mode.\n- support for multiple instances of rsyslogd on a single machine added\n- added new option \"-o\" --> omit local unix domain socket. This option\n  enables rsyslogd NOT to listen to the local socket. This is most\n  helpful when multiple instances of rsyslogd (or rsyslogd and another\n  syslogd) shall run on a single system.\n- added new option \"-i <pidfile>\" which allows to specify the pidfile.\n  This is needed when multiple instances of rsyslogd are to be run.\n- the new project home page is now online at www.rsyslog.com\n---------------------------------------------------------------------------\nVersion 0.9.4 (RGer), 2005-07-25\n- finally added the TCP sender. It now supports non-blocking mode, no\n  longer disabling message reception during connect. As it is now, it\n  is usable in production. The code could be more sophisticated, but\n  I've kept it short in anticipation of the move to liblogging, which\n  will lead to the removal of the code just written ;)\n- the \"exiting on signal...\" message still had the \"syslogd\" name in \n  it. Changed this to \"rsyslogd\", as we do not have a large user base\n  yet, this should pose no problem.\n- fixed \"the semiconlon\" bug. rsyslogd dumped core if a write-db action\n  was specified but no semicolon was given after the password (an empty\n  template was ok, but the semicolon needed to be present).\n- changed a default for traditional output format. During testing, it\n  was seen that the timestamp written to file in default format was\n  the time of message reception, not the time specified in the TIMESTAMP\n  field of the message itself. Traditionally, the message TIMESTAMP is\n  used and this has been changed now.\n---------------------------------------------------------------------------\nVersion 0.9.3 (RGer), 2005-07-19\n- fixed a bug in the message parser. In June, the RFC 3164 timestamp\n  was not correctly parsed (yes, only in June and some other months,\n  see the code comment to learn why...)\n- added the ability to specify the destination port when forwarding\n  syslog messages (both for TCP and UDP)\n- added an very experimental TCP sender (activated by\n  @@machine:port in config). This is not yet for production use. If\n  the receiver is not alive, rsyslogd will wait quite some time until\n  the connection request times out, which most probably leads to\n  loss of incoming messages.\n\n---------------------------------------------------------------------------\nVersion 0.9.2 (RGer), around 2005-07-06\n- I intended to change the maxsupported message size to 32k to\n  support IHE - but given the memory inefficiency in the usual use\n  cases, I have not done this. I have, however, included very\n  specific instructions on how to do this in the source code. I have\n  also done some testing with 32k messages, so you can change the\n  max size without taking too much risk.\n- added a syslog/tcp receiver; we now can receive messages via\n  plain tcp, but we can still send only via UDP. The syslog/tcp\n  receiver is the primary enhancement of this release.\n- slightly changed some error messages that contained a spurios \\n at\n  the end of the line (which gives empty lines in your log...)\n\n---------------------------------------------------------------------------\nVersion 0.9.1 (RGer)\n- fixed code so that it compiles without errors under FreeBSD\n- removed now unused function \"allocate_log()\" from syslogd.c\n- changed the make file so that it contains more defines for\n  different environments (in the long term, we need a better\n  system for disabling/enabling features...)\n- changed some printf's printing off_t types to %lld and\n  explicit (long long) casts. I tried to figure out the exact type,\n  but did not succeed in this. In the worst case, ultra-large peta-\n  byte files will now display funny informational messages on rollover,\n  something I think we can live with for the next 10 years or so...\n\n---------------------------------------------------------------------------\nVersion 0.9.0 (RGer)\n- changed the filed structure to be a linked list. Previously, it\n  was a table - well, for non-SYSV it was defined as linked list,\n  but from what I see that code did no longer work after my\n  modifications. I am now using a linked list in general because\n  that is needed for other upcoming modifications.\n- fixed a bug that caused rsyslogd not to listen to anything if\n  the configuration file could not be read\n- pervious versions disabled network logging (send/receive) if\n  syslog/udp port was not in /etc/services. Now defaulting to\n  port 514 in this case.\n- internal error messages are now supported up to 256 bytes\n- error message seen during config file read are now also displayed\n  to the attached tty and not only the console\n- changed some error messages during init to be sent to the console\n  and/or emergency log. Previously, they were only seen if the\n  -d (debug) option was present on the command line.\n- fixed the \"2gb file issue on 32bit systems\". If a file grew to\n  more than 2gb, the syslogd was aborted with \"file size exceeded\". \n  Now, defines have been added according to\n  http://www.daimi.au.dk/~kasperd/comp.os.linux.development.faq.html#LARGEFILE\n  Testing revealed that they work ;)\n  HOWEVER, if your file system, glibc, kernel, whatever does not\n  support files larger 2gb, you need to set a file size limit with\n  the new output channel mechanism.\n- updated man pages to reflect the changes\n\n---------------------------------------------------------------------------\nVersion 0.8.4\n\n- improved -d debug output (removed developer-only content)\n- now compiles under FreeBSD and NetBSD (only quick testing done on NetBSD)\n---------------------------------------------------------------------------\nVersion 0.8.3\n\n- security model in \"make install\" changed\n- minor doc updates\n---------------------------------------------------------------------------\nVersion 0.8.2\n\n- added man page for rsyslog.conf and rsyslogd\n- gave up on the concept of rsyslog being a \"drop in\" replacement\n  for syslogd. Now, the user installs rsyslogd and also needs to\n  adjust his system settings to this specifically. This also lead\n  to these changes:\n  * changed Makefile so that install now installs rsyslogd instead\n    of dealing with syslogd\n  * changed the default config file name to rsyslog.conf\n---------------------------------------------------------------------------\nVersion 0.8.1\n\n- fixed a nasty memory leak (probably not the last one with this release)\n- some enhancements to Makefile as suggested by Bennett Todd\n- syslogd-internal messages (like restart) were missing the hostname\n  this has been corrected\n---------------------------------------------------------------------------\nVersion 0.8.0\n\nInitial testing release. Based on the sysklogd package. Thanks to the\nsysklogd maintainers for all their good work!\n---------------------------------------------------------------------------\n\n----------------------------------------------------------------------\nThe following comments were left in the syslogd source. While they provide\nnot too much detail, the help to date when Rainer started work on the\nproject (which was 2003, now even surprising for Rainer himself ;)).\n * \\author Rainer Gerhards <rgerhards@adiscon.com>\n * \\date 2003-10-17\n *       Some initial modifications on the sysklogd package to support\n *       liblogging. These have actually not yet been merged to the\n *       source you see currently (but they hopefully will)\n *\n * \\date 2004-10-28\n *       Restarted the modifications of sysklogd. This time, we\n *       focus on a simpler approach first. The initial goal is to\n *       provide MySQL database support (so that syslogd can log\n *       to the database).\n----------------------------------------------------------------------\nThe following comments are from the stock syslogd.c source. They provide\nsome insight into what happened to the source before we forked\nrsyslogd. However, much of the code already has been replaced and more\nis to be replaced. So over time, these comments become less valuable.\nI have moved them out of the syslogd.c file to shrink it, especially\nas a lot of them do no longer apply. For historical reasons and\nunderstanding of how the daemon evolved, they are probably still\nhelpful.\n * Author: Eric Allman\n * extensive changes by Ralph Campbell\n * more extensive changes by Eric Allman (again)\n *\n * Steve Lord:\tFix UNIX domain socket code, added linux kernel logging\n *\t\tchange defines to\n *\t\tSYSLOG_INET\t- listen on a UDP socket\n *\t\tSYSLOG_UNIXAF\t- listen on unix domain socket\n *\t\tSYSLOG_KERNEL\t- listen to linux kernel\n *\n * Mon Feb 22 09:55:42 CST 1993:  Dr. Wettstein\n * \tAdditional modifications to the source.  Changed priority scheme\n *\tto increase the level of configurability.  In its stock configuration\n *\tsyslogd no longer logs all messages of a certain priority and above\n *\tto a log file.  The * wildcard is supported to specify all priorities.\n *\tNote that this is a departure from the BSD standard.\n *\n *\tSyslogd will now listen to both the inetd and the unixd socket.  The\n *\tstrategy is to allow all local programs to direct their output to\n *\tsyslogd through the unixd socket while the program listens to the\n *\tinetd socket to get messages forwarded from other hosts.\n *\n * Fri Mar 12 16:55:33 CST 1993:  Dr. Wettstein\n *\tThanks to Stephen Tweedie (dcs.ed.ac.uk!sct) for helpful bug-fixes\n *\tand an enlightened commentary on the prioritization problem.\n *\n *\tChanged the priority scheme so that the default behavior mimics the\n *\tstandard BSD.  In this scenario all messages of a specified priority\n *\tand above are logged.\n *\n *\tAdd the ability to specify a wildcard (=) as the first character\n *\tof the priority name.  Doing this specifies that ONLY messages with\n *\tthis level of priority are to be logged.  For example:\n *\n *\t\t*.=debug\t\t\t/usr/adm/debug\n *\n *\tWould log only messages with a priority of debug to the /usr/adm/debug\n *\tfile.\n *\n *\tProviding an * as the priority specifies that all messages are to be\n *\tlogged.  Note that this case is degenerate with specifying a priority\n *\tlevel of debug.  The wildcard * was retained because I believe that\n *\tthis is more intuitive.\n *\n * Thu Jun 24 11:34:13 CDT 1993:  Dr. Wettstein\n *\tModified sources to incorporate changes in libc4.4.  Messages from\n *\tsyslog are now null-terminated, syslogd code now parses messages\n *\tbased on this termination scheme.  Linux as of libc4.4 supports the\n *\tfsync system call.  Modified code to fsync after all writes to\n *\tlog files.\n *\n * Sat Dec 11 11:59:43 CST 1993:  Dr. Wettstein\n *\tExtensive changes to the source code to allow compilation with no\n *\tcomplaints with -Wall.\n *\n *\tReorganized the facility and priority name arrays so that they\n *\tcompatible with the syslog.h source found in /usr/include/syslog.h.\n *\tNOTE that this should really be changed.  The reason I do not\n *\tallow the use of the values defined in syslog.h is on account of\n *\tthe extensions made to allow the wildcard character in the\n *\tpriority field.  To fix this properly one should malloc an array,\n *\tcopy the contents of the array defined by syslog.h and then\n *\tmake whatever modifications that are desired.  Next round.\n *\n * Thu Jan  6 12:07:36 CST 1994:  Dr. Wettstein\n *\tAdded support for proper decomposition and re-assembly of\n *\tfragment messages on UNIX domain sockets.  Lack of this capability\n *\twas causing 'partial' messages to be output.  Since facility and\n *\tpriority information is encoded as a leader on the messages this\n *\twas causing lines to be placed in erroneous files.\n *\n *\tAlso added a patch from Shane Alderton (shane@ion.apana.org.au) to\n *\tcorrect a problem with syslogd dumping core when an attempt was made\n *\tto write log messages to a logged-on user.  Thank you.\n *\n *\tMany thanks to Juha Virtanen (jiivee@hut.fi) for a series of\n *\tinterchanges which lead to the fixing of problems with messages set\n *\tto priorities of none and emerg.  Also thanks to Juha for a patch\n *\tto exclude users with a class of LOGIN from receiving messages.\n *\n *\tShane Alderton provided an additional patch to fix zombies which\n *\twere conceived when messages were written to multiple users.\n *\n * Mon Feb  6 09:57:10 CST 1995:  Dr. Wettstein\n *\tPatch to properly reset the single priority message flag.  Thanks\n *\tto Christopher Gori for spotting this bug and forwarding a patch.\n *\n * Wed Feb 22 15:38:31 CST 1995:  Dr. Wettstein\n *\tAdded version information to startup messages.\n *\n *\tAdded defines so that paths to important files are taken from\n *\tthe definitions in paths.h.  Hopefully this will insure that\n *\teverything follows the FSSTND standards.  Thanks to Chris Metcalf\n *\tfor a set of patches to provide this functionality.  Also thanks\n *\tElias Levy for prompting me to get these into the sources.\n *\n * Wed Jul 26 18:57:23 MET DST 1995:  Martin Schulze\n *\tLinux' gethostname only returns the hostname and not the fqdn as\n *\texpected in the code. But if you call hostname with an fqdn then\n *\tgethostname will return an fqdn, so we have to mention that. This\n *\thas been changed.\n *\n *\tThe 'LocalDomain' and the hostname of a remote machine is\n *\tconverted to lower case, because the original caused some\n *\tinconsistency, because the (at least my) nameserver did respond an\n *\tfqdn containing of upper- _and_ lowercase letters while\n *\t'LocalDomain' consisted only of lowercase letters and that didn't\n *\tmatch.\n *\n * Sat Aug  5 18:59:15 MET DST 1995:  Martin Schulze\n *\tNow no messages that were received from any remote host are sent\n *\tout to another. At my domain this missing feature caused ugly\n *\tsyslog-loops, sometimes.\n *\n *\tRemember that no message is sent out. I can't figure out any\n *\tscenario where it might be useful to change this behavior and to\n *\tsend out messages to other hosts than the one from which we\n *\treceived the message, but I might be shortsighted. :-/\n *\n * Thu Aug 10 19:01:08 MET DST 1995:  Martin Schulze\n *\tAdded my pidfile.[ch] to it to perform a better handling with\n *\tpidfiles. Now both, syslogd and klogd, can only be started\n *\tonce. They check the pidfile.\n *\n * Sun Aug 13 19:01:41 MET DST 1995:  Martin Schulze\n *\tAdd an addition to syslog.conf's interpretation. If a priority\n *\tbegins with an exclamation mark ('!') the normal interpretation\n *\tof the priority is inverted: \".!*\" is the same as \".none\", \".!=info\"\n *\tdon't logs the info priority, \".!crit\" won't log any message with\n *\tthe priority crit or higher. For example:\n *\n *\t\tmail.*;mail.!=info\t\t/usr/adm/mail\n *\n *\tWould log all messages of the facility mail except those with\n *\tthe priority info to /usr/adm/mail. This makes the syslogd\n *\tmuch more flexible.\n *\n *\tDefined TABLE_ALLPRI=255 and changed some occurrences.\n *\n * Sat Aug 19 21:40:13 MET DST 1995:  Martin Schulze\n *\tMaking the table of facilities and priorities while in debug\n *\tmode more readable.\n *\n *\tIf debugging is turned on, printing the whole table of\n *\tfacilities and priorities every hexadecimal or 'X' entry is\n *\tnow 2 characters wide.\n *\n *\tThe number of the entry is prepended to each line of\n *\tfacilities and priorities, and F_UNUSED lines are not shown\n *\tanymore.\n *\n *\tCorrected some #ifdef SYSV's.\n *\n * Mon Aug 21 22:10:35 MET DST 1995:  Martin Schulze\n *\tCorrected a strange behavior during parsing of configuration\n *\tfile. The original BSD syslogd doesn't understand spaces as\n *\tseparators between specifier and action. This syslogd now\n *\tunderstands them. The old behavior caused some confusion over\n *\tthe Linux community.\n *\n * Thu Oct 19 00:02:07 MET 1995:  Martin Schulze\n *\tThe default behavior has changed for security reasons. The\n *\tsyslogd will not receive any remote message unless you turn\n *\treception on with the \"-r\" option.\n *\n *\tNot defining SYSLOG_INET will result in not doing any network\n *\tactivity, i.e. not sending or receiving messages.  I changed\n *\tthis because the old idea is implemented with the \"-r\" option\n *\tand the old thing didn't work anyway.\n *\n * Thu Oct 26 13:14:06 MET 1995:  Martin Schulze\n *\tAdded another logfile type F_FORW_UNKN.  The problem I ran into\n *\twas a name server that runs on my machine and a forwarder of\n *\tkern.crit to another host.  The hosts address can only be\n *\tfetched using the nameserver.  But named is started after\n *\tsyslogd, so syslogd complained.\n *\n *\tThis logfile type will retry to get the address of the\n *\thostname ten times and then complain.  This should be enough to\n *\tget the named up and running during boot sequence.\n *\n * Fri Oct 27 14:08:15 1995:  Dr. Wettstein\n *\tChanged static array of logfiles to a dynamic array. This\n *\tcan grow during process.\n *\n * Fri Nov 10 23:08:18 1995:  Martin Schulze\n *\tInserted a new tabular sys_h_errlist that contains plain text\n *\tfor error codes that are returned from the net subsystem and\n *\tstored in h_errno. I have also changed some wrong lookups to\n *\tsys_errlist.\n *\n * Wed Nov 22 22:32:55 1995:  Martin Schulze\n *\tAdded the fabulous strip-domain feature that allows us to\n *\tstrip off (several) domain names from the fqdn and only log\n *\tthe simple hostname. This is useful if you're in a LAN that\n *\thas a central log server and also different domains.\n *\n *\tI have also also added the -l switch do define hosts as\n *\tlocal. These will get logged with their simple hostname, too.\n *\n * Thu Nov 23 19:02:56 MET DST 1995:  Martin Schulze\n *\tAdded the possibility to omit fsyncing of logfiles after every\n *\twrite. This will give some performance back if you have\n *\tprograms that log in a very verbose manner (like innd or\n *\tsmartlist). Thanks to Stephen R. van den Berg <srb@cuci.nl>\n *\tfor the idea.\n *\n * Thu Jan 18 11:14:36 CST 1996:  Dr. Wettstein\n *\tAdded patche from beta-testers to stop compile error.  Also\n *\tadded removal of pid file as part of termination cleanup.\n *\n * Wed Feb 14 12:42:09 CST 1996:  Dr. Wettstein\n *\tAllowed forwarding of messages received from remote hosts to\n *\tbe controlled by a command-line switch.  Specifying -h allows\n *\tforwarding.  The default behavior is to disable forwarding of\n *\tmessages which were received from a remote host.\n *\n *\tParent process of syslogd does not exit until child process has\n *\tfinished initialization process.  This allows rc.* startup to\n *\tpause until syslogd facility is up and operating.\n *\n *\tRe-arranged the select code to move UNIX domain socket accepts\n *\tto be processed later.  This was a contributed change which\n *\thas been proposed to correct the delays sometimes encountered\n *\twhen syslogd starts up.\n *\n *\tMinor code cleanups.\n *\n * Thu May  2 15:15:33 CDT 1996:  Dr. Wettstein\n *\tFixed bug in init function which resulted in file descripters\n *\tbeing orphaned when syslogd process was re-initialized with SIGHUP\n *\tsignal.  Thanks to Edvard Tuinder\n *\t(Edvard.Tuinder@praseodymium.cistron.nl) for putting me on the\n *\ttrail of this bug.  I am amazed that we didn't catch this one\n *\tbefore now.\n *\n * Tue May 14 00:03:35 MET DST 1996:  Martin Schulze\n *\tCorrected a mistake that causes the syslogd to stop logging at\n *\tsome virtual consoles under Linux. This was caused by checking\n *\tthe wrong error code. Thanks to Michael Nonweiler\n *\t<mrn20@hermes.cam.ac.uk> for sending me a patch.\n *\n * Mon May 20 13:29:32 MET DST 1996:  Miquel van Smoorenburg <miquels@cistron.nl>\n *\tAdded continuation line supported and fixed a bug in\n *\tthe init() code.\n *\n * Tue May 28 00:58:45 MET DST 1996:  Martin Schulze\n *\tCorrected behaviour of blocking pipes - i.e. the whole system\n *\thung.  Michael Nonweiler <mrn20@hermes.cam.ac.uk> has sent us\n *\ta patch to correct this.  A new logfile type F_PIPE has been\n *\tintroduced.\n *\n * Mon Feb 3 10:12:15 MET DST 1997:  Martin Schulze\n *\tCorrected behaviour of logfiles if the file can't be opened.\n *\tThere was a bug that causes syslogd to try to log into non\n *\texisting files which ate cpu power.\n *\n * Sun Feb 9 03:22:12 MET DST 1997:  Martin Schulze\n *\tModified syslogd.c to not kill itself which confuses bash 2.0.\n *\n * Mon Feb 10 00:09:11 MET DST 1997:  Martin Schulze\n *\tImproved debug code to decode the numeric facility/priority\n *\tpair into textual information.\n *\n * Tue Jun 10 12:35:10 MET DST 1997:  Martin Schulze\n *\tCorrected freeing of logfiles.  Thanks to Jos Vos <jos@xos.nl>\n *\tfor reporting the bug and sending an idea to fix the problem.\n *\n * Tue Jun 10 12:51:41 MET DST 1997:  Martin Schulze\n *\tRemoved sleep(10) from parent process.  This has caused a slow\n *\tstartup in former times - and I don't see any reason for this.\n *\n * Sun Jun 15 16:23:29 MET DST 1997: Michael Alan Dorman\n *\tSome more glibc patches made by <mdorman@debian.org>.\n *\n * Thu Jan  1 16:04:52 CET 1998: Martin Schulze <joey@infodrom.north.de\n *\tApplied patch from Herbert Thielen <Herbert.Thielen@lpr.e-technik.tu-muenchen.de>.\n *\tThis included some balance parentheses for emacs and a bug in\n *\tthe exclamation mark handling.\n *\n *\tFixed small bug which caused syslogd to write messages to the\n *\twrong logfile under some very rare conditions.  Thanks to\n *\tHerbert Xu <herbert@gondor.apana.org.au> for fiddling this out.\n *\n * Thu Jan  8 22:46:35 CET 1998: Martin Schulze <joey@infodrom.north.de>\n *\tReworked one line of the above patch as it prevented syslogd\n *\tfrom binding the socket with the result that no messages were\n *\tforwarded to other hosts.\n *\n * Sat Jan 10 01:33:06 CET 1998: Martin Schulze <joey@infodrom.north.de>\n *\tFixed small bugs in F_FORW_UNKN meachanism.  Thanks to Torsten\n *\tNeumann <torsten@londo.rhein-main.de> for pointing me to it.\n *\n * Mon Jan 12 19:50:58 CET 1998: Martin Schulze <joey@infodrom.north.de>\n *\tModified debug output concerning remote receiption.\n *\n * Mon Feb 23 23:32:35 CET 1998: Topi Miettinen <Topi.Miettinen@ml.tele.fi>\n *\tRe-worked handling of Unix and UDP sockets to support closing /\n *\topening of them in order to have it open only if it is needed\n *\teither for forwarding to a remote host or by receiption from\n *\tthe network.\n *\n * Wed Feb 25 10:54:09 CET 1998: Martin Schulze <joey@infodrom.north.de>\n *\tFixed little comparison mistake that prevented the MARK\n *\tfeature to work properly.\n *\n * Wed Feb 25 13:21:44 CET 1998: Martin Schulze <joey@infodrom.north.de>\n *\tCorrected Topi's patch as it prevented forwarding during\n *\tstartup due to an unknown LogPort.\n *\n * Sat Oct 10 20:01:48 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tAdded support for TESTING define which will turn syslogd into\n *\tstdio-mode used for debugging.\n *\n * Sun Oct 11 20:16:59 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tReworked the initialization/fork code.  Now the parent\n *\tprocess activates a signal handler which the daughter process\n *\twill raise if it is initialized.  Only after that one the\n *\tparent process may exit.  Otherwise klogd might try to flush\n *\tits log cache while syslogd can't receive the messages yet.\n *\n * Mon Oct 12 13:30:35 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tRedirected some error output with regard to argument parsing to\n *\tstderr.\n *\n * Mon Oct 12 14:02:51 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tApplied patch provided vom Topi Miettinen with regard to the\n *\tpeople from OpenBSD.  This provides the additional '-a'\n *\targument used for specifying additional UNIX domain sockets to\n *\tlisten to.  This is been used with chroot()'ed named's for\n *\texample.  See for http://www.psionic.com/papers/dns.html\n *\n * Mon Oct 12 18:29:44 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tAdded `ftp' facility which was introduced in glibc version 2.\n *\tIt's #ifdef'ed so won't harm with older libraries.\n *\n * Mon Oct 12 19:59:21 MET DST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tCode cleanups with regard to bsd -> posix transition and\n *\tstronger security (buffer length checking).  Thanks to Topi\n *\tMiettinen <tom@medialab.sonera.net>\n *\t. index() --> strchr()\n *\t. sprintf() --> snprintf()\n *\t. bcopy() --> memcpy()\n *\t. bzero() --> memset()\n *\t. UNAMESZ --> UT_NAMESIZE\n *\t. sys_errlist --> strerror()\n *\n * Mon Oct 12 20:22:59 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tAdded support for setutent()/getutent()/endutend() instead of\n *\tbinary reading the UTMP file.  This is the the most portable\n *\tway.  This allows /var/run/utmp format to change, even to a\n *\treal database or utmp daemon. Also if utmp file locking is\n *\timplemented in libc, syslog will use it immediately.  Thanks\n *\tto Topi Miettinen <tom@medialab.sonera.net>.\n *\n * Mon Oct 12 20:49:18 MET DST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tAvoid logging of SIGCHLD when syslogd is in the process of\n *\texiting and closing its files.  Again thanks to Topi.\n *\n * Mon Oct 12 22:18:34 CEST 1998: Martin Schulze <joey@infodrom.north.de>\n *\tModified printline() to support 8bit characters - such as\n *\trussion letters.  Thanks to Vladas Lapinskas <lapinskas@mail.iae.lt>.\n *\n * Sat Nov 14 02:29:37 CET 1998: Martin Schulze <joey@infodrom.north.de>\n *\t``-m 0'' now turns of MARK logging entirely.\n *\n * Tue Jan 19 01:04:18 MET 1999: Martin Schulze <joey@infodrom.north.de>\n *\tFinally fixed an error with `-a' processing, thanks to Topi\n *\tMiettinen <tom@medialab.sonera.net>.\n *\n * Sun May 23 10:08:53 CEST 1999: Martin Schulze <joey@infodrom.north.de>\n *\tRemoved superflous call to utmpname().  The path to the utmp\n *\tfile is defined in the used libc and should not be hardcoded\n *\tinto the syslogd binary referring the system it was compiled on.\n *\n * Sun Sep 17 20:45:33 CEST 2000: Martin Schulze <joey@infodrom.ffis.de>\n *\tFixed some bugs in printline() code that did not escape\n *\tcontrol characters '\\177' through '\\237' and contained a\n *\tsingle-byte buffer overflow.  Thanks to Solar Designer\n *\t<solar@false.com>.\n *\n * Sun Sep 17 21:26:16 CEST 2000: Martin Schulze <joey@infodrom.ffis.de>\n *\tDon't close open sockets upon reload.  Thanks to Bill\n *\tNottingham.\n *\n * Mon Sep 18 09:10:47 CEST 2000: Martin Schulze <joey@infodrom.ffis.de>\n *\tFixed bug in printchopped() that caused syslogd to emit\n *\tkern.emerg messages when splitting long lines.  Thanks to\n *\tDaniel Jacobowitz <dan@debian.org> for the fix.\n *\n * Mon Sep 18 15:33:26 CEST 2000: Martin Schulze <joey@infodrom.ffis.de>\n *\tRemoved unixm/unix domain sockets and switch to Datagram Unix\n *\tSockets.  This should remove one possibility to play DoS with\n *\tsyslogd.  Thanks to Olaf Kirch <okir@caldera.de> for the patch.\n *\n * Sun Mar 11 20:23:44 CET 2001: Martin Schulze <joey@infodrom.ffis.de>\n *\tDon't return a closed fd if `-a' is called with a wrong path.\n *\tThanks to Bill Nottingham <notting@redhat.com> for providing\n *\ta patch.\n", "/* Definition of the batch_t data structure.\n * I am not sure yet if this will become a full-blown object. For now, this header just\n * includes the object definition and is not accompanied by code.\n *\n * Copyright 2009 by Rainer Gerhards and Adiscon GmbH.\n *\n * This file is part of the rsyslog runtime library.\n *\n * The rsyslog runtime library is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * The rsyslog runtime library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with the rsyslog runtime library.  If not, see <http://www.gnu.org/licenses/>.\n *\n * A copy of the GPL can be found in the file \"COPYING\" in this distribution.\n * A copy of the LGPL can be found in the file \"COPYING.LESSER\" in this distribution.\n */\n\n#ifndef BATCH_H_INCLUDED\n#define BATCH_H_INCLUDED\n\n#include <string.h>\n#include \"msg.h\"\n\n/* enum for batch states. Actually, we violate a layer here, in that we assume that a batch is used\n * for action processing. So far, this seems acceptable, the status is simply ignored inside the\n * main message queue. But over time, it could potentially be useful to split the two.\n * rgerhad, 2009-05-12\n */\ntypedef enum {\n\tBATCH_STATE_RDY  = 0,\t/* object ready for processing */\n\tBATCH_STATE_BAD  = 1,\t/* unrecoverable failure while processing, do NOT resubmit to same action */\n\tBATCH_STATE_SUB  = 2,\t/* message submitted for processing, outcome yet unknown */\n\tBATCH_STATE_COMM = 3,\t/* message successfully commited */\n\tBATCH_STATE_DISC = 4, \t/* discarded - processed OK, but do not submit to any other action */\n} batch_state_t;\n\n\n/* an object inside a batch, including any information (state!) needed for it to \"life\".\n */\nstruct batch_obj_s {\n\tobj_t *pUsrp;\t\t/* pointer to user object (most often message) */\n\tbatch_state_t state;\t/* associated state */\n\t/* work variables for action processing; these are reused for each action (or block of\n\t * actions)\n\t */\n\tsbool bFilterOK;\t/* work area for filter processing (per action, reused!) */\n\tsbool bPrevWasSuspended;\n\t/* following are caches to save allocs if not absolutely necessary */\n\tuchar *staticActStrings[CONF_OMOD_NUMSTRINGS_MAXSIZE]; /**< for strings */\n\t\t\t\t/* a cache to save malloc(), if not absolutely necessary */\n\tvoid *staticActParams[CONF_OMOD_NUMSTRINGS_MAXSIZE]; /**< for anything else */\n\tsize_t staticLenStrings[CONF_OMOD_NUMSTRINGS_MAXSIZE];\n\t\t\t\t/* and the same for the message length (if used) */\n\t/* end action work variables */\n};\n\n/* the batch\n * This object is used to dequeue multiple user pointers which are than handed over\n * to processing. The size of elements is fixed after queue creation, but may be \n * modified by config variables (better said: queue properties).\n * Note that a \"user pointer\" in rsyslog context so far always is a message \n * object. We stick to the more generic term because queues may potentially hold\n * other types of objects, too.\n * rgerhards, 2009-05-12\n * Note that nElem is not necessarily equal to nElemDeq. This is the case when we\n * discard some elements (because of configuration) during dequeue processing. As\n * all Elements are only deleted when the batch is processed, we can not immediately\n * delete them. So we need to keep their number that we can delete them when the batch\n * is completed (else, the whole process does not work correctly).\n */\nstruct batch_s {\n\tint maxElem;\t\t/* maximum number of elements that this batch supports */\n\tint nElem;\t\t/* actual number of element in this entry */\n\tint nElemDeq;\t\t/* actual number of elements dequeued (and thus to be deleted) - see comment above! */\n\tint iDoneUpTo;\t\t/* all messages below this index have state other than RDY */\n\tqDeqID\tdeqID;\t\t/* ID of dequeue operation that generated this batch */\n\tint *pbShutdownImmediate;/* end processing of this batch immediately if set to 1 */\n\tsbool bSingleRuleset;\t/* do all msgs of this batch use a single ruleset? */\n\tbatch_obj_t *pElem;\t/* batch elements */\n};\n\n\n/* some inline functions (we may move this off to an object .. or not) */\nstatic inline void\nbatchSetSingleRuleset(batch_t *pBatch, sbool val) {\n\tpBatch->bSingleRuleset = val;\n}\n\n/* get the batches ruleset (if we have a single ruleset) */\nstatic inline ruleset_t*\nbatchGetRuleset(batch_t *pBatch) {\n\treturn (pBatch->nElem > 0) ? ((msg_t*) pBatch->pElem[0].pUsrp)->pRuleset : NULL;\n}\n\n/* get the ruleset of a specifc element of the batch (index not verified!) */\nstatic inline ruleset_t*\nbatchElemGetRuleset(batch_t *pBatch, int i) {\n\treturn ((msg_t*) pBatch->pElem[i].pUsrp)->pRuleset;\n}\n\n/* get number of msgs for this batch */\nstatic inline int\nbatchNumMsgs(batch_t *pBatch) {\n\treturn pBatch->nElem;\n}\n\n\n/* set the status of the i-th batch element. Note that once the status is\n * DISC, it will never be reset. So this function can NOT be used to initialize\n * the state table. -- rgerhards, 2010-06-10\n */\nstatic inline void\nbatchSetElemState(batch_t *pBatch, int i, batch_state_t newState) {\n\tif(pBatch->pElem[i].state != BATCH_STATE_DISC)\n\t\tpBatch->pElem[i].state = newState;\n}\n\n\n/* check if an element is a valid entry. We do NOT verify if the\n * element index is valid. -- rgerhards, 2010-06-10\n */\nstatic inline int\nbatchIsValidElem(batch_t *pBatch, int i) {\n\treturn(pBatch->pElem[i].bFilterOK && pBatch->pElem[i].state != BATCH_STATE_DISC);\n}\n\n\n/* copy one batch element to another.\n * This creates a complete duplicate in those cases where\n * it is needed. Use duplication only when absolutely necessary!\n * Note that all working fields are reset to zeros. If that were \n * not done, we would have potential problems with invalid\n * or double pointer frees.\n * rgerhards, 2010-06-10\n */\nstatic inline void\nbatchCopyElem(batch_obj_t *pDest, batch_obj_t *pSrc) {\n\tmemset(pDest, 0, sizeof(batch_obj_t));\n\tpDest->pUsrp = pSrc->pUsrp;\n\tpDest->state = pSrc->state;\n}\n\n\n/* free members of a batch \"object\". Note that we can not do the usual\n * destruction as the object typically is allocated on the stack and so the\n * object itself cannot be freed! -- rgerhards, 2010-06-15\n */\nstatic inline void\nbatchFree(batch_t *pBatch) {\n\tint i;\n\tint j;\n\tfor(i = 0 ; i < pBatch->maxElem ; ++i) {\n\t\tfor(j = 0 ; j < CONF_OMOD_NUMSTRINGS_MAXSIZE ; ++j) {\n\t\t\t/* staticActParams MUST be freed immediately (if required),\n\t\t\t * so we do not need to do that!\n\t\t\t */\n\t\t\tfree(pBatch->pElem[i].staticActStrings[j]);\n\t\t}\n\t}\n\tfree(pBatch->pElem);\n}\n\n\n/* initialiaze a batch \"object\". The record must already exist,\n * we \"just\" initialize it. The max number of elements must be\n * provided. -- rgerhards, 2010-06-15\n */\nstatic inline rsRetVal\nbatchInit(batch_t *pBatch, int maxElem) {\n\tDEFiRet;\n\tpBatch->iDoneUpTo = 0;\n\tpBatch->maxElem = maxElem;\n\tCHKmalloc(pBatch->pElem = calloc((size_t)maxElem, sizeof(batch_obj_t)));\n\t// TODO: replace calloc by inidividual writes?\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* primarily a helper for debug purposes, get human-readble name of state */\nstatic inline char *\nbatchState2String(batch_state_t state) {\n\tswitch(state) {\n\tcase BATCH_STATE_RDY:\n\t\treturn \"BATCH_STATE_RDY\";\n\tcase BATCH_STATE_BAD:\n\t\treturn \"BATCH_STATE_BAD\";\n\tcase BATCH_STATE_SUB:\n\t\treturn \"BATCH_STATE_SUB\";\n\tcase BATCH_STATE_COMM:\n\t\treturn \"BATCH_STATE_COMM\";\n\tcase BATCH_STATE_DISC:\n\t\treturn \"BATCH_STATE_DISC\";\n\t}\n\treturn \"ERROR, batch state not known!\";\n}\n#endif /* #ifndef BATCH_H_INCLUDED */\n", "/* ruleset.c - rsyslog's ruleset object\n *\n * We have a two-way structure of linked lists: one global linked list\n * (llAllRulesets) hold alls rule sets that we know. Included in each\n * list is a list of rules (which contain a list of actions, but that's\n * a different story).\n *\n * Usually, only a single rule set is executed. However, there exist some\n * situations where all rules must be iterated over, for example on HUP. Thus,\n * we also provide interfaces to do that.\n *\n * Module begun 2009-06-10 by Rainer Gerhards\n *\n * Copyright 2009 Rainer Gerhards and Adiscon GmbH.\n *\n * This file is part of the rsyslog runtime library.\n *\n * The rsyslog runtime library is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * The rsyslog runtime library is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with the rsyslog runtime library.  If not, see <http://www.gnu.org/licenses/>.\n *\n * A copy of the GPL can be found in the file \"COPYING\" in this distribution.\n * A copy of the LGPL can be found in the file \"COPYING.LESSER\" in this distribution.\n */\n\n#include \"config.h\"\n#include <stdlib.h>\n#include <string.h>\n#include <assert.h>\n#include <ctype.h>\n\n#include \"rsyslog.h\"\n#include \"obj.h\"\n#include \"cfsysline.h\"\n#include \"msg.h\"\n#include \"ruleset.h\"\n#include \"rule.h\"\n#include \"errmsg.h\"\n#include \"parser.h\"\n#include \"batch.h\"\n#include \"unicode-helper.h\"\n#include \"dirty.h\" /* for main ruleset queue creation */\n\n/* static data */\nDEFobjStaticHelpers\nDEFobjCurrIf(errmsg)\nDEFobjCurrIf(rule)\nDEFobjCurrIf(parser)\n\nlinkedList_t llRulesets; /* this is NOT a pointer - no typo here ;) */\nruleset_t *pCurrRuleset = NULL; /* currently \"active\" ruleset */\nruleset_t *pDfltRuleset = NULL; /* current default ruleset, e.g. for binding to actions which have no other */\n\n/* forward definitions */\nstatic rsRetVal processBatch(batch_t *pBatch);\n\n/* ---------- linked-list key handling functions ---------- */\n\n/* destructor for linked list keys.\n */\nstatic rsRetVal keyDestruct(void __attribute__((unused)) *pData)\n{\n\tfree(pData);\n\treturn RS_RET_OK;\n}\n\n\n/* ---------- END linked-list key handling functions ---------- */\n\n\n/* driver to iterate over all of this ruleset actions */\ntypedef struct iterateAllActions_s {\n\trsRetVal (*pFunc)(void*, void*);\n\tvoid *pParam;\n} iterateAllActions_t;\nDEFFUNC_llExecFunc(doIterateRulesetActions)\n{\n\tDEFiRet;\n\trule_t* pRule = (rule_t*) pData;\n\titerateAllActions_t *pMyParam = (iterateAllActions_t*) pParam;\n\tiRet = rule.IterateAllActions(pRule, pMyParam->pFunc, pMyParam->pParam);\n\tRETiRet;\n}\n/* iterate over all actions of THIS rule set.\n */\nstatic rsRetVal\niterateRulesetAllActions(ruleset_t *pThis, rsRetVal (*pFunc)(void*, void*), void* pParam)\n{\n\titerateAllActions_t params;\n\tDEFiRet;\n\tassert(pFunc != NULL);\n\n\tparams.pFunc = pFunc;\n\tparams.pParam = pParam;\n\tCHKiRet(llExecFunc(&(pThis->llRules), doIterateRulesetActions, &params));\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* driver to iterate over all actions */\nDEFFUNC_llExecFunc(doIterateAllActions)\n{\n\tDEFiRet;\n\truleset_t* pThis = (ruleset_t*) pData;\n\titerateAllActions_t *pMyParam = (iterateAllActions_t*) pParam;\n\tiRet = iterateRulesetAllActions(pThis, pMyParam->pFunc, pMyParam->pParam);\n\tRETiRet;\n}\n/* iterate over ALL actions present in the WHOLE system.\n * this is often needed, for example when HUP processing \n * must be done or a shutdown is pending.\n */\nstatic rsRetVal\niterateAllActions(rsRetVal (*pFunc)(void*, void*), void* pParam)\n{\n\titerateAllActions_t params;\n\tDEFiRet;\n\tassert(pFunc != NULL);\n\n\tparams.pFunc = pFunc;\n\tparams.pParam = pParam;\n\tCHKiRet(llExecFunc(&llRulesets, doIterateAllActions, &params));\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n\n/* helper to processBatch(), used to call the configured actions. It is\n * executed from within llExecFunc() of the action list.\n * rgerhards, 2007-08-02\n */\nDEFFUNC_llExecFunc(processBatchDoRules)\n{\n\trsRetVal iRet;\n\tISOBJ_TYPE_assert(pData, rule);\n\tdbgprintf(\"Processing next rule\\n\");\n\tiRet = rule.ProcessBatch((rule_t*) pData, (batch_t*) pParam);\ndbgprintf(\"ruleset: get iRet %d from rule.ProcessMsg()\\n\", iRet);\n\treturn iRet;\n}\n\n\n\n/* This function is similar to processBatch(), but works on a batch that\n * contains rules from multiple rulesets. In this case, we can not push\n * the whole batch through the ruleset. Instead, we examine it and\n * partition it into sub-rulesets which we then push through the system.\n * Note that when we evaluate which message must be processed, we do NOT need\n * to look at bFilterOK, because this value is only set in a later processing\n * stage. Doing so caused a bug during development ;)\n * rgerhards, 2010-06-15\n */\nstatic inline rsRetVal\nprocessBatchMultiRuleset(batch_t *pBatch)\n{\n\truleset_t *currRuleset;\n\tbatch_t snglRuleBatch;\n\tint i;\n\tint iStart;\t/* start index of partial batch */\n\tint iNew;\t/* index for new (temporary) batch */\n\tint bHaveUnprocessed;\t/* do we (still) have unprocessed entries? (loop term predicate) */\n\tDEFiRet;\n\n\tdo {\n\t\tbHaveUnprocessed = 0;\n\t\t/* search for first unprocessed element */\n\t\tfor(iStart = 0 ; iStart < pBatch->nElem && pBatch->pElem[iStart].state == BATCH_STATE_DISC ; ++iStart)\n\t\t\t/* just search, no action */;\n\t\tif(iStart == pBatch->nElem)\n\t\t\tbreak; /* everything processed */\n\n\t\t/* prepare temporary batch */\n\t\tCHKiRet(batchInit(&snglRuleBatch, pBatch->nElem));\n\t\tsnglRuleBatch.pbShutdownImmediate = pBatch->pbShutdownImmediate;\n\t\tcurrRuleset = batchElemGetRuleset(pBatch, iStart);\n\t\tiNew = 0;\n\t\tfor(i = iStart ; i < pBatch->nElem ; ++i) {\n\t\t\tif(batchElemGetRuleset(pBatch, i) == currRuleset) {\n\t\t\t\t/* for performance reasons, we copy only those members that we actually need */\n\t\t\t\tsnglRuleBatch.pElem[iNew].pUsrp = pBatch->pElem[i].pUsrp;\n\t\t\t\tsnglRuleBatch.pElem[iNew].state = pBatch->pElem[i].state;\n\t\t\t\t++iNew;\n\t\t\t\t/* We indicate the element also as done, so it will not be processed again */\n\t\t\t\tpBatch->pElem[i].state = BATCH_STATE_DISC;\n\t\t\t} else {\n\t\t\t\tbHaveUnprocessed = 1;\n\t\t\t}\n\t\t}\n\t\tsnglRuleBatch.nElem = iNew; /* was left just right by the for loop */\n\t\tbatchSetSingleRuleset(&snglRuleBatch, 1);\n\t\t/* process temp batch */\n\t\tprocessBatch(&snglRuleBatch);\n\t\tbatchFree(&snglRuleBatch);\n\t} while(bHaveUnprocessed == 1);\n\nfinalize_it:\n\tRETiRet;\n}\n\n/* Process (consume) a batch of messages. Calls the actions configured.\n * If the whole batch uses a singel ruleset, we can process the batch as \n * a whole. Otherwise, we need to process it slower, on a message-by-message\n * basis (what can be optimized to a per-ruleset basis)\n * rgerhards, 2005-10-13\n */\nstatic rsRetVal\nprocessBatch(batch_t *pBatch)\n{\n\truleset_t *pThis;\n\tDEFiRet;\n\tassert(pBatch != NULL);\n\ndbgprintf(\"ZZZ: processBatch: batch of %d elements must be processed\\n\", pBatch->nElem);\n\tif(pBatch->bSingleRuleset) {\n\t\tpThis = batchGetRuleset(pBatch);\n\t\tif(pThis == NULL)\n\t\t\tpThis = pDfltRuleset;\n\t\tISOBJ_TYPE_assert(pThis, ruleset);\n\t\tCHKiRet(llExecFunc(&pThis->llRules, processBatchDoRules, pBatch));\n\t} else {\n\t\tCHKiRet(processBatchMultiRuleset(pBatch));\n\t}\n\nfinalize_it:\ndbgprintf(\"ruleset.ProcessMsg() returns %d\\n\", iRet);\n\tRETiRet;\n}\n\n\n/* return the ruleset-assigned parser list. NULL means use the default\n * parser list.\n * rgerhards, 2009-11-04\n */\nstatic parserList_t*\nGetParserList(msg_t *pMsg)\n{\n\treturn (pMsg->pRuleset == NULL) ? pDfltRuleset->pParserLst : pMsg->pRuleset->pParserLst;\n}\n\n\n/* Add a new rule to the end of the current rule set. We do a number\n * of checks and ignore the rule if it does not pass them.\n */\nstatic rsRetVal\naddRule(ruleset_t *pThis, rule_t **ppRule)\n{\n\tint iActionCnt;\n\tDEFiRet;\n\n\tISOBJ_TYPE_assert(pThis, ruleset);\n\tISOBJ_TYPE_assert(*ppRule, rule);\n\n\tCHKiRet(llGetNumElts(&(*ppRule)->llActList, &iActionCnt));\n\tif(iActionCnt == 0) {\n\t\terrmsg.LogError(0, NO_ERRCODE, \"warning: selector line without actions will be discarded\");\n\t\trule.Destruct(ppRule);\n\t} else {\n\t\tCHKiRet(llAppend(&pThis->llRules, NULL, *ppRule));\n\t\tdbgprintf(\"selector line successfully processed\\n\");\n\t}\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* set name for ruleset */\nstatic rsRetVal setName(ruleset_t *pThis, uchar *pszName)\n{\n\tDEFiRet;\n\tfree(pThis->pszName);\n\tCHKmalloc(pThis->pszName = ustrdup(pszName));\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* get current ruleset\n * We use a non-standard calling interface, as nothing can go wrong and it\n * is really much more natural to return the pointer directly.\n */\nstatic ruleset_t*\nGetCurrent(void)\n{\n\treturn pCurrRuleset;\n}\n\n\n/* get main queue associated with ruleset. If no ruleset-specifc main queue\n * is set, the primary main message queue is returned.\n * We use a non-standard calling interface, as nothing can go wrong and it\n * is really much more natural to return the pointer directly.\n */\nstatic qqueue_t*\nGetRulesetQueue(ruleset_t *pThis)\n{\n\tISOBJ_TYPE_assert(pThis, ruleset);\n\treturn (pThis->pQueue == NULL) ? pMsgQueue : pThis->pQueue;\n}\n\n\n/* Find the ruleset with the given name and return a pointer to its object.\n */\nstatic rsRetVal\nGetRuleset(ruleset_t **ppRuleset, uchar *pszName)\n{\n\tDEFiRet;\n\tassert(ppRuleset != NULL);\n\tassert(pszName != NULL);\n\n\tCHKiRet(llFind(&llRulesets, pszName, (void*) ppRuleset));\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* Set a new default rule set. If the default can not be found, no change happens.\n */\nstatic rsRetVal\nSetDefaultRuleset(uchar *pszName)\n{\n\truleset_t *pRuleset;\n\tDEFiRet;\n\tassert(pszName != NULL);\n\n\tCHKiRet(GetRuleset(&pRuleset, pszName));\n\tpDfltRuleset = pRuleset;\n\tdbgprintf(\"default rule set changed to %p: '%s'\\n\", pRuleset, pszName);\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* Set a new current rule set. If the ruleset can not be found, no change happens.\n */\nstatic rsRetVal\nSetCurrRuleset(uchar *pszName)\n{\n\truleset_t *pRuleset;\n\tDEFiRet;\n\tassert(pszName != NULL);\n\n\tCHKiRet(GetRuleset(&pRuleset, pszName));\n\tpCurrRuleset = pRuleset;\n\tdbgprintf(\"current rule set changed to %p: '%s'\\n\", pRuleset, pszName);\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* destructor we need to destruct rules inside our linked list contents.\n */\nstatic rsRetVal\ndoRuleDestruct(void *pData)\n{\n\trule_t *pRule = (rule_t *) pData;\n\tDEFiRet;\n\trule.Destruct(&pRule);\n\tRETiRet;\n}\n\n\n/* Standard-Constructor\n */\nBEGINobjConstruct(ruleset) /* be sure to specify the object type also in END macro! */\n\tCHKiRet(llInit(&pThis->llRules, doRuleDestruct, NULL, NULL));\nfinalize_it:\nENDobjConstruct(ruleset)\n\n\n/* ConstructionFinalizer\n * This also adds the rule set to the list of all known rulesets.\n */\nstatic rsRetVal\nrulesetConstructFinalize(ruleset_t *pThis)\n{\n\tuchar *keyName;\n\tDEFiRet;\n\tISOBJ_TYPE_assert(pThis, ruleset);\n\n\t/* we must duplicate our name, as the key destructer would also\n\t * free it, resulting in a double-free. It's also cleaner to have\n\t * two separate copies.\n\t */\n\tCHKmalloc(keyName = ustrdup(pThis->pszName));\n\tCHKiRet(llAppend(&llRulesets, keyName, pThis));\n\n\t/* this now also is the new current ruleset */\n\tpCurrRuleset = pThis;\n\n\t/* and also the default, if so far none has been set */\n\tif(pDfltRuleset == NULL)\n\t\tpDfltRuleset = pThis;\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* destructor for the ruleset object */\nBEGINobjDestruct(ruleset) /* be sure to specify the object type also in END and CODESTART macros! */\nCODESTARTobjDestruct(ruleset)\n\tdbgprintf(\"destructing ruleset %p, name %p\\n\", pThis, pThis->pszName);\n\tif(pThis->pQueue != NULL) {\n\t\tqqueueDestruct(&pThis->pQueue);\n\t}\n\tif(pThis->pParserLst != NULL) {\n\t\tparser.DestructParserList(&pThis->pParserLst);\n\t}\n\tllDestroy(&pThis->llRules);\n\tfree(pThis->pszName);\nENDobjDestruct(ruleset)\n\n/* this is a special destructor for the linkedList class. LinkedList does NOT\n * provide a pointer to the pointer, but rather the raw pointer itself. So we \n * must map this, otherwise the destructor will abort.\n */\nstatic rsRetVal\nrulesetDestructForLinkedList(void *pData)\n{\n\truleset_t *pThis = (ruleset_t*) pData;\n\treturn rulesetDestruct(&pThis);\n}\n\n\n/* destruct ALL rule sets that reside in the system. This must\n * be callable before unloading this module as the module may\n * not be unloaded before unload of the actions is required. This is\n * kind of a left-over from previous logic and may be optimized one\n * everything runs stable again. -- rgerhards, 2009-06-10\n */\nstatic rsRetVal\ndestructAllActions(void)\n{\n\tDEFiRet;\n\n\tCHKiRet(llDestroy(&llRulesets));\n\tCHKiRet(llInit(&llRulesets, rulesetDestructForLinkedList, keyDestruct, strcasecmp));\n\tpDfltRuleset = NULL;\n\nfinalize_it:\n\tRETiRet;\n}\n\n/* helper for debugPrint(), initiates rule printing */\nDEFFUNC_llExecFunc(doDebugPrintRule)\n{\n\treturn rule.DebugPrint((rule_t*) pData);\n}\n/* debugprint for the ruleset object */\nBEGINobjDebugPrint(ruleset) /* be sure to specify the object type also in END and CODESTART macros! */\nCODESTARTobjDebugPrint(ruleset)\n\tdbgoprint((obj_t*) pThis, \"rsyslog ruleset %s:\\n\", pThis->pszName);\n\tllExecFunc(&pThis->llRules, doDebugPrintRule, NULL);\nENDobjDebugPrint(ruleset)\n\n\n/* helper for debugPrintAll(), prints a single ruleset */\nDEFFUNC_llExecFunc(doDebugPrintAll)\n{\n\treturn rulesetDebugPrint((ruleset_t*) pData);\n}\n/* debug print all rulesets\n */\nstatic rsRetVal\ndebugPrintAll(void)\n{\n\tDEFiRet;\n\tdbgprintf(\"All Rulesets:\\n\");\n\tllExecFunc(&llRulesets, doDebugPrintAll, NULL);\n\tdbgprintf(\"End of Rulesets.\\n\");\n\tRETiRet;\n}\n\n\n/* Create a ruleset-specific \"main\" queue for this ruleset. If one is already\n * defined, an error message is emitted but nothing else is done.\n * Note: we use the main message queue parameters for queue creation and access\n * syslogd.c directly to obtain these. This is far from being perfect, but\n * considered acceptable for the time being.\n * rgerhards, 2009-10-27\n */\nstatic rsRetVal\nrulesetCreateQueue(void __attribute__((unused)) *pVal, int *pNewVal)\n{\n\tDEFiRet;\n\n\tif(pCurrRuleset == NULL) {\n\t\terrmsg.LogError(0, RS_RET_NO_CURR_RULESET, \"error: currently no specific ruleset specified, thus a \"\n\t\t\t\t\"queue can not be added to it\");\n\t\tABORT_FINALIZE(RS_RET_NO_CURR_RULESET);\n\t}\n\n\tif(pCurrRuleset->pQueue != NULL) {\n\t\terrmsg.LogError(0, RS_RET_RULES_QUEUE_EXISTS, \"error: ruleset already has a main queue, can not \"\n\t\t\t\t\"add another one\");\n\t\tABORT_FINALIZE(RS_RET_RULES_QUEUE_EXISTS);\n\t}\n\n\tif(pNewVal == 0)\n\t\tFINALIZE; /* if it is turned off, we do not need to change anything ;) */\n\n\tdbgprintf(\"adding a ruleset-specific \\\"main\\\" queue\");\n\tCHKiRet(createMainQueue(&pCurrRuleset->pQueue, UCHAR_CONSTANT(\"ruleset\")));\n\nfinalize_it:\n\tRETiRet;\n}\n\n\n/* Add a ruleset specific parser to the ruleset. Note that adding the first\n * parser automatically disables the default parsers. If they are needed as well,\n * the must be added via explicit config directives.\n * Note: this is the only spot in the code that requires the parser object. In order\n * to solve some class init bootstrap sequence problems, we get the object handle here\n * instead of during module initialization. Note that objUse() is capable of being \n * called multiple times.\n * rgerhards, 2009-11-04\n */\nstatic rsRetVal\nrulesetAddParser(void __attribute__((unused)) *pVal, uchar *pName)\n{\n\tparser_t *pParser;\n\tDEFiRet;\n\n\tassert(pCurrRuleset != NULL); \n\n\tCHKiRet(objUse(parser, CORE_COMPONENT));\n\tiRet = parser.FindParser(&pParser, pName);\n\tif(iRet == RS_RET_PARSER_NOT_FOUND) {\n\t\terrmsg.LogError(0, RS_RET_PARSER_NOT_FOUND, \"error: parser '%s' unknown at this time \"\n\t\t\t  \t\"(maybe defined too late in rsyslog.conf?)\", pName);\n\t\tABORT_FINALIZE(RS_RET_NO_CURR_RULESET);\n\t} else if(iRet != RS_RET_OK) {\n\t\terrmsg.LogError(0, iRet, \"error trying to find parser '%s'\\n\", pName);\n\t\tFINALIZE;\n\t}\n\n\tCHKiRet(parser.AddParserToList(&pCurrRuleset->pParserLst, pParser));\n\n\tdbgprintf(\"added parser '%s' to ruleset '%s'\\n\", pName, pCurrRuleset->pszName);\nRUNLOG_VAR(\"%p\", pCurrRuleset->pParserLst);\n\nfinalize_it:\n\td_free(pName); /* no longer needed */\n\n\tRETiRet;\n}\n\n\n/* queryInterface function\n * rgerhards, 2008-02-21\n */\nBEGINobjQueryInterface(ruleset)\nCODESTARTobjQueryInterface(ruleset)\n\tif(pIf->ifVersion != rulesetCURR_IF_VERSION) { /* check for current version, increment on each change */\n\t\tABORT_FINALIZE(RS_RET_INTERFACE_NOT_SUPPORTED);\n\t}\n\n\t/* ok, we have the right interface, so let's fill it\n\t * Please note that we may also do some backwards-compatibility\n\t * work here (if we can support an older interface version - that,\n\t * of course, also affects the \"if\" above).\n\t */\n\tpIf->Construct = rulesetConstruct;\n\tpIf->ConstructFinalize = rulesetConstructFinalize;\n\tpIf->Destruct = rulesetDestruct;\n\tpIf->DebugPrint = rulesetDebugPrint;\n\n\tpIf->IterateAllActions = iterateAllActions;\n\tpIf->DestructAllActions = destructAllActions;\n\tpIf->AddRule = addRule;\n\tpIf->ProcessBatch = processBatch;\n\tpIf->SetName = setName;\n\tpIf->DebugPrintAll = debugPrintAll;\n\tpIf->GetCurrent = GetCurrent;\n\tpIf->GetRuleset = GetRuleset;\n\tpIf->SetDefaultRuleset = SetDefaultRuleset;\n\tpIf->SetCurrRuleset = SetCurrRuleset;\n\tpIf->GetRulesetQueue = GetRulesetQueue;\n\tpIf->GetParserList = GetParserList;\nfinalize_it:\nENDobjQueryInterface(ruleset)\n\n\n/* Exit the ruleset class.\n * rgerhards, 2009-04-06\n */\nBEGINObjClassExit(ruleset, OBJ_IS_CORE_MODULE) /* class, version */\n\tllDestroy(&llRulesets);\n\tobjRelease(errmsg, CORE_COMPONENT);\n\tobjRelease(rule, CORE_COMPONENT);\n\tobjRelease(parser, CORE_COMPONENT);\nENDObjClassExit(ruleset)\n\n\n/* Initialize the ruleset class. Must be called as the very first method\n * before anything else is called inside this class.\n * rgerhards, 2008-02-19\n */\nBEGINObjClassInit(ruleset, 1, OBJ_IS_CORE_MODULE) /* class, version */\n\t/* request objects we use */\n\tCHKiRet(objUse(errmsg, CORE_COMPONENT));\n\tCHKiRet(objUse(rule, CORE_COMPONENT));\n\n\t/* set our own handlers */\n\tOBJSetMethodHandler(objMethod_DEBUGPRINT, rulesetDebugPrint);\n\tOBJSetMethodHandler(objMethod_CONSTRUCTION_FINALIZER, rulesetConstructFinalize);\n\n\t/* prepare global data */\n\tCHKiRet(llInit(&llRulesets, rulesetDestructForLinkedList, keyDestruct, strcasecmp));\n\n\t/* config file handlers */\n\tCHKiRet(regCfSysLineHdlr((uchar *)\"rulesetparser\", 0, eCmdHdlrGetWord, rulesetAddParser, NULL, NULL));\n\tCHKiRet(regCfSysLineHdlr((uchar *)\"rulesetcreatemainqueue\", 0, eCmdHdlrBinary, rulesetCreateQueue, NULL, NULL));\nENDObjClassInit(ruleset)\n\n/* vi:set ai:\n */\n"], "filenames": ["ChangeLog", "runtime/batch.h", "runtime/ruleset.c"], "buggy_code_start_loc": [2, 138, 174], "buggy_code_end_loc": [2, 173, 203], "fixing_code_start_loc": [3, 139, 174], "fixing_code_end_loc": [8, 180, 208], "type": "CWE-772", "message": "A memory leak in rsyslog before 5.7.6 was found in the way deamon processed log messages were logged when multiple rulesets were used and some output batches contained messages belonging to more than one ruleset. A local attacker could cause denial of the rsyslogd daemon service via a log message belonging to more than one ruleset.", "other": {"cve": {"id": "CVE-2011-1489", "sourceIdentifier": "secalert@redhat.com", "published": "2019-11-14T02:15:10.797", "lastModified": "2020-08-18T15:05:57.813", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A memory leak in rsyslog before 5.7.6 was found in the way deamon processed log messages were logged when multiple rulesets were used and some output batches contained messages belonging to more than one ruleset. A local attacker could cause denial of the rsyslogd daemon service via a log message belonging to more than one ruleset."}, {"lang": "es", "value": "Se encontr\u00f3 una p\u00e9rdida de memoria en rsyslog versiones anteriores a la versi\u00f3n  5.7.6, en la manera en que son registrados los mensajes de log procesados ??en el demonio cuando m\u00faltiples conjuntos de reglas fueron usadas y algunos lotes de salida conten\u00edan mensajes que pertenec\u00edan a m\u00e1s de un conjunto de reglas. Un atacante local podr\u00eda causar una denegaci\u00f3n de servicio del demonio de rsyslogd mediante un mensaje de registro que pertenece a m\u00e1s de un conjunto de reglas."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 2.1}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-772"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:rsyslog:rsyslog:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.7.6", "matchCriteriaId": "22CBAD75-300B-4E25-B694-292C911A02E8"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:opensuse:opensuse:11.4:*:*:*:*:*:*:*", "matchCriteriaId": "DE554781-1EB9-446E-911F-6C11970C47F4"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "C11E6FB0-C8C0-4527-9AA0-CB9B316F8F43"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*", "matchCriteriaId": "DEECE5FC-CACF-4496-A3E7-164736409252"}, {"vulnerable": true, "criteria": "cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*", "matchCriteriaId": "07B237A9-69A3-4A9C-9DA0-4E06BD37AE73"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-security-announce/2011-04/msg00005.html", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://access.redhat.com/security/cve/cve-2011-1489", "source": "secalert@redhat.com", "tags": ["Exploit", "Patch", "Third Party Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2011-1489", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/rsyslog/rsyslog/commit/1ef709cc97d54f74d3fdeb83788cc4b01f4c6a2a", "source": "secalert@redhat.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://security-tracker.debian.org/tracker/CVE-2011-1489", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/rsyslog/rsyslog/commit/1ef709cc97d54f74d3fdeb83788cc4b01f4c6a2a"}}