{"buggy_code": ["version: \"2.1\"\nservices:\n  chrome:\n    image: ${MS_IMAGE_PREFIX}/node-chromium:4.8.3\n    container_name: selenium-chrome\n    shm_size: 2gb\n    ports:\n      - \"5900:5900\" # password: secret\n    depends_on:\n      - selenium-hub\n    entrypoint: bash -c '[ ! -f /home/seluser/language ] && sudo sed -i -e \"s/# $$LANG.*/$$LANG UTF-8/\" /etc/locale.gen && sudo dpkg-reconfigure --frontend=noninteractive locales && sudo update-locale LANG=$$LANG && touch /home/seluser/language; /opt/bin/entry_point.sh'\n    environment:\n      - SE_EVENT_BUS_HOST=selenium-hub\n      - SE_EVENT_BUS_PUBLISH_PORT=4442\n      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443\n      - TZ=Asia/Shanghai\n      - SE_NODE_MAX_SESSIONS=6\n      - SE_NODE_OVERRIDE_MAX_SESSIONS=true\n      - JAVA_OPTS=-Xmx400m -Dfile.encoding=utf-8\n      - SCREEN_WIDTH=1920\n      - SCREEN_HEIGHT=1080\n      - LANGUAGE=zh_CN.UTF-8\n      - LANG=zh_CN.UTF-8\n    restart: always\n    healthcheck:\n      test: [\"CMD\", \"bash\", \"-c\", \"< /dev/tcp/localhost/5900\"]\n      interval: 6s\n      timeout: 5s\n      retries: 50\n    networks:\n      - ms-network\n  firefox:\n    image: ${MS_IMAGE_PREFIX}/node-firefox:4.8.3\n    container_name: selenium-firefox\n    shm_size: 2gb\n    ports:\n      - \"5901:5900\" # password: secret\n    depends_on:\n      - selenium-hub\n    entrypoint: bash -c '[ ! -f /home/seluser/language ] && sudo sed -i -e \"s/# $$LANG.*/$$LANG UTF-8/\" /etc/locale.gen && sudo dpkg-reconfigure --frontend=noninteractive locales && sudo update-locale LANG=$$LANG && touch /home/seluser/language; /opt/bin/entry_point.sh'\n    environment:\n      - SE_EVENT_BUS_HOST=selenium-hub\n      - SE_EVENT_BUS_PUBLISH_PORT=4442\n      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443\n      - TZ=Asia/Shanghai\n      - SE_NODE_MAX_SESSIONS=6\n      - SE_NODE_OVERRIDE_MAX_SESSIONS=true\n      - JAVA_OPTS=-Xmx400m -Dfile.encoding=utf-8\n      - SCREEN_WIDTH=1920\n      - SCREEN_HEIGHT=1080\n      - LANGUAGE=zh_CN.UTF-8\n      - LANG=zh_CN.UTF-8\n    restart: always\n    healthcheck:\n      test: [ \"CMD\", \"bash\", \"-c\", \"< /dev/tcp/localhost/5900\" ]\n      interval: 6s\n      timeout: 5s\n      retries: 50\n    networks:\n      - ms-network\n\n  selenium-hub:\n    image: ${MS_IMAGE_PREFIX}/selenium-hub:4.8.3\n    container_name: selenium-hub\n    ports:\n      - \"4442:4442\"\n      - \"4443:4443\"\n      - \"4444:4444\"\n    restart: always\n    healthcheck:\n      test: [ \"CMD\", \"curl\", \"-f\", \"http://localhost:4444\" ]\n      interval: 6s\n      timeout: 5s\n      retries: 50\n    networks:\n      - ms-network"], "fixing_code": ["version: \"2.1\"\nservices:\n  chrome:\n    image: ${MS_IMAGE_PREFIX}/node-chromium:4.8.3\n    container_name: selenium-chrome\n    shm_size: 2gb\n    ports:\n      - \"5900:5900\"\n    depends_on:\n      - selenium-hub\n    entrypoint: bash -c '[ ! -f /home/seluser/language ] && sudo sed -i -e \"s/# $$LANG.*/$$LANG UTF-8/\" /etc/locale.gen && sudo dpkg-reconfigure --frontend=noninteractive locales && sudo update-locale LANG=$$LANG && touch /home/seluser/language; /opt/bin/entry_point.sh'\n    environment:\n      - SE_EVENT_BUS_HOST=selenium-hub\n      - SE_EVENT_BUS_PUBLISH_PORT=4442\n      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443\n      - TZ=Asia/Shanghai\n      - SE_NODE_MAX_SESSIONS=6\n      - SE_NODE_OVERRIDE_MAX_SESSIONS=true\n      - JAVA_OPTS=-Xmx400m -Dfile.encoding=utf-8\n      - SCREEN_WIDTH=1920\n      - SCREEN_HEIGHT=1080\n      - LANGUAGE=zh_CN.UTF-8\n      - LANG=zh_CN.UTF-8\n      - SE_START_VNC=false\n      - SE_VNC_VIEW_ONLY=1\n      - SE_VNC_PASSWORD=Password123@selenium\n    restart: always\n    healthcheck:\n      test: [\"CMD\", \"bash\", \"-c\", \"< /dev/tcp/localhost/5900\"]\n      interval: 6s\n      timeout: 5s\n      retries: 50\n    networks:\n      - ms-network\n  firefox:\n    image: ${MS_IMAGE_PREFIX}/node-firefox:4.8.3\n    container_name: selenium-firefox\n    shm_size: 2gb\n    ports:\n      - \"5901:5900\"\n    depends_on:\n      - selenium-hub\n    entrypoint: bash -c '[ ! -f /home/seluser/language ] && sudo sed -i -e \"s/# $$LANG.*/$$LANG UTF-8/\" /etc/locale.gen && sudo dpkg-reconfigure --frontend=noninteractive locales && sudo update-locale LANG=$$LANG && touch /home/seluser/language; /opt/bin/entry_point.sh'\n    environment:\n      - SE_EVENT_BUS_HOST=selenium-hub\n      - SE_EVENT_BUS_PUBLISH_PORT=4442\n      - SE_EVENT_BUS_SUBSCRIBE_PORT=4443\n      - TZ=Asia/Shanghai\n      - SE_NODE_MAX_SESSIONS=6\n      - SE_NODE_OVERRIDE_MAX_SESSIONS=true\n      - JAVA_OPTS=-Xmx400m -Dfile.encoding=utf-8\n      - SCREEN_WIDTH=1920\n      - SCREEN_HEIGHT=1080\n      - LANGUAGE=zh_CN.UTF-8\n      - LANG=zh_CN.UTF-8\n      - SE_START_VNC=false\n      - SE_VNC_VIEW_ONLY=1\n      - SE_VNC_PASSWORD=Password123@selenium\n    restart: always\n    healthcheck:\n      test: [ \"CMD\", \"bash\", \"-c\", \"< /dev/tcp/localhost/5900\" ]\n      interval: 6s\n      timeout: 5s\n      retries: 50\n    networks:\n      - ms-network\n\n  selenium-hub:\n    image: ${MS_IMAGE_PREFIX}/selenium-hub:4.8.3\n    container_name: selenium-hub\n    ports:\n      - \"4442:4442\"\n      - \"4443:4443\"\n      - \"4444:4444\"\n    restart: always\n    healthcheck:\n      test: [ \"CMD\", \"curl\", \"-f\", \"http://localhost:4444\" ]\n      interval: 6s\n      timeout: 5s\n      retries: 50\n    networks:\n      - ms-network"], "filenames": ["metersphere/docker-compose-seleniarm.yml"], "buggy_code_start_loc": [8], "buggy_code_end_loc": [52], "fixing_code_start_loc": [8], "fixing_code_end_loc": [59], "type": "CWE-798", "message": "MeterSphere is a one-stop open source continuous testing platform, covering functions such as test tracking, interface testing, UI testing and performance testing. The Selenium VNC config used in Metersphere is using a weak password by default, attackers can login to vnc and obtain high permissions. This issue has been addressed in version 2.10.7 LTS. Users are advised to upgrade. There are no known workarounds for this vulnerability.", "other": {"cve": {"id": "CVE-2023-41878", "sourceIdentifier": "security-advisories@github.com", "published": "2023-09-27T15:19:30.860", "lastModified": "2023-09-30T02:03:50.350", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "MeterSphere is a one-stop open source continuous testing platform, covering functions such as test tracking, interface testing, UI testing and performance testing. The Selenium VNC config used in Metersphere is using a weak password by default, attackers can login to vnc and obtain high permissions. This issue has been addressed in version 2.10.7 LTS. Users are advised to upgrade. There are no known workarounds for this vulnerability."}, {"lang": "es", "value": "MeterSphere es una plataforma integral de pruebas continuas de c\u00f3digo abierto que cubre funciones como seguimiento de pruebas, pruebas de interfaz, pruebas de UI y pruebas de rendimiento. La configuraci\u00f3n de Selenium VNC utilizada en Metersphere utiliza una contrase\u00f1a d\u00e9bil de forma predeterminada, los atacantes pueden iniciar sesi\u00f3n en vnc y obtener permisos elevados. Este problema se solucion\u00f3 en la versi\u00f3n 2.10.7 LTS. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.6, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 2.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-798"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:metersphere:metersphere:*:*:*:*:lts:*:*:*", "versionEndExcluding": "2.10.7", "matchCriteriaId": "AC0CC671-BD17-418A-B9A2-14F967CEBE50"}]}]}], "references": [{"url": "https://github.com/metersphere/installer/commit/02dd31c0951a225eaad99eda560e3eb91ba3001d", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/metersphere/metersphere/security/advisories/GHSA-88vv-6rm4-59h9", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/metersphere/installer/commit/02dd31c0951a225eaad99eda560e3eb91ba3001d"}}