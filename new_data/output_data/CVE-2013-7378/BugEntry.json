{"buggy_code": ["# Description:\n#   Email from hubot to any address\n#\n# Dependencies:\n#   None\n#\n# Configuration:\n#   None\n#\n# Commands:\n#   hubot email <user@email.com> -s <subject> -m <message> - Sends email with the <subject> <message> to address <user@email.com>\n#\n# Author:\n#   earlonrails\n#\n# Additional Requirements\n#   unix mail client installed on the system\n\nutil = require 'util'\nchild_process = require 'child_process'\nexec = child_process.exec\n\nmodule.exports = (robot) ->\n  emailTime = null\n  sendEmail = (recipients, subject, msg, from) ->\n    mailCommand = \"\"\"echo '#{msg}' | mail -s '#{subject}' -r '#{from}' '#{recipients}'\"\"\"\n    exec mailCommand, (error, stdout, stderr) ->\n      util.print 'stdout: ' + stdout\n      util.print 'stderr: ' + stderr\n\n  robot.respond /email (.*) -s (.*) -m (.*)/i, (msg) ->\n    sendEmail msg.match[1], msg.match[2], msg.match[3], msg.message.user.id\n    msg.send \"email sent\"\n"], "fixing_code": ["# Description:\n#   Email from hubot to any address\n#\n# Dependencies:\n#   None\n#\n# Configuration:\n#   None\n#\n# Commands:\n#   hubot email <user@email.com> -s <subject> -m <message> - Sends email with the <subject> <message> to address <user@email.com>\n#\n# Author:\n#   earlonrails\n#\n# Additional Requirements\n#   unix mail client installed on the system\n\nutil = require 'util'\nchild_process = require 'child_process'\n\nmodule.exports = (robot) ->\n  emailTime = null\n  sendEmail = (recipients, subject, msg, from) ->\n    mailArgs = ['-s', subject, '-a', \"From: #{from}\", '--']\n    mailArgs = mailArgs.concat recipients\n    p = child_process.execFile 'mail', mailArgs, {}, (error, stdout, stderr) ->\n      util.print 'stdout: ' + stdout\n      util.print 'stderr: ' + stderr\n    p.stdin.write \"#{msg}\\n\"\n    p.stdin.end()\n\n  robot.respond /email (.*) -s (.*) -m (.*)/i, (msg) ->\n    sendEmail msg.match[1].split(\" \"), msg.match[2], msg.match[3], msg.message.user.id\n    msg.send \"email sent\"\n"], "filenames": ["src/scripts/email.coffee"], "buggy_code_start_loc": [21], "buggy_code_end_loc": [33], "fixing_code_start_loc": [20], "fixing_code_end_loc": [35], "type": "CWE-74", "message": "scripts/email.coffee in the Hubot Scripts module before 2.4.4 for Node.js allows remote attackers to execute arbitrary commands.", "other": {"cve": {"id": "CVE-2013-7378", "sourceIdentifier": "cve@mitre.org", "published": "2020-02-12T14:15:10.840", "lastModified": "2020-02-14T16:42:25.070", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "scripts/email.coffee in the Hubot Scripts module before 2.4.4 for Node.js allows remote attackers to execute arbitrary commands."}, {"lang": "es", "value": "scripts/email.coffee en el m\u00f3dulo Hubot Scripts versiones anteriores a 3.4.4 para Node.js, permite a atacantes remotos ejecutar comandos arbitrarios."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-74"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hubot_scripts_project:hubot_scripts:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "2.4.4", "matchCriteriaId": "0B3A1B79-0D6E-47A7-8C24-ADC5B92436D8"}]}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2014/05/13/1", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2014/05/15/2", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "https://github.com/github/hubot-scripts/commit/feee5abdb038a229a98969ae443cdb8a61747782", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://web.archive.org/web/20140731222413/https://nodesecurity.io/advisories/Hubot_Potential_command_injection_in_email.coffee", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/github/hubot-scripts/commit/feee5abdb038a229a98969ae443cdb8a61747782"}}