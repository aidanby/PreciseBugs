{"buggy_code": ["name: \"GitHub Slug Action\"\ndescription: \"GitHub Action to expose slug value of environment variables inside your GitHub workflow\"\nauthor: \"Romain Lespinasse\"\nbranding:\n  icon: \"minimize\"\n  color: \"blue\"\ninputs:\n  prefix:\n    description: \"Value to prepend to each generated variable\"\n    default: \"\"\n    required: false\n  slug-maxlength:\n    description: \"Max length of the slugified values\"\n    default: \"63\"\n    required: true\n  short-length:\n    description: \"Length of the shortify values (git default if empty)\"\n    required: false\nruns:\n  using: \"composite\"\n  steps:\n    - run: $GITHUB_ACTION_PATH/preflight.sh\n      id: prefligth\n      shell: bash\n      env:\n        INPUT_SLUG_MAXLENGTH: ${{ inputs.slug-maxlength }}\n        INPUT_SHORT_LENGTH: ${{ inputs.short-length }}\n\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_REPOSITORY\n        value: ${{ github.repository }}\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_REF\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_HEAD_REF\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_BASE_REF\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n\n    # Specific values\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_EVENT_REF\n        value: ${{ github.event.ref }}\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n\n    # Calculated values\n    - id: get-github-ref-name\n      run: |\n        refname=\"${{ github.head_ref || github.ref_name }}\"\n        if [ -f \"$GITHUB_OUTPUT\" ]; then\n          echo \"github-ref-name=${refname}\" >> \"$GITHUB_OUTPUT\"\n        else\n          echo \"::set-output name=github-ref-name::${refname}\"\n        fi\n      shell: bash\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_REF_NAME\n        value: ${{ steps.get-github-ref-name.outputs.github-ref-name }}\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n    - id: get-github-repository-owner-part\n      run: |\n        ownerpart=$(echo $GITHUB_REPOSITORY | cut -d/ -f1)\n        if [ -f \"$GITHUB_OUTPUT\" ]; then\n          echo \"github-repository-owner-part=${ownerpart}\" >> \"$GITHUB_OUTPUT\"\n        else\n          echo \"::set-output name=github-repository-owner-part::${ownerpart}\"\n        fi\n      shell: bash\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_REPOSITORY_OWNER_PART\n        value: ${{ steps.get-github-repository-owner-part.outputs.github-repository-owner-part }}\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n    - id: get-github-repository-name-part\n      run: |\n        namepart=$(echo $GITHUB_REPOSITORY | cut -d/ -f2)\n        if [ -f \"$GITHUB_OUTPUT\" ]; then\n          echo \"github-repository-name-part=${namepart}\" >> \"$GITHUB_OUTPUT\"\n        else\n          echo \"::set-output name=github-repository-name-part::${namepart}\"\n        fi\n      shell: bash\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_REPOSITORY_NAME_PART\n        value: ${{ steps.get-github-repository-name-part.outputs.github-repository-name-part }}\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n\n    # Short\n    - uses: rlespinasse/shortify-git-revision@v1.6.0\n      with:\n        name: GITHUB_SHA\n        short-on-error: true\n        length: ${{ steps.prefligth.outputs.PREFLIGHT_SHORT_LENGTH }}\n        prefix: ${{ inputs.prefix }}\n    - uses: rlespinasse/shortify-git-revision@v1.6.0\n      with:\n        name: GITHUB_EVENT_PULL_REQUEST_HEAD_SHA\n        revision: ${{ github.event.pull_request.head.sha }}\n        short-on-error: true\n        length: ${{ steps.prefligth.outputs.PREFLIGHT_SHORT_LENGTH }}\n        prefix: ${{ inputs.prefix }}\n"], "fixing_code": ["name: \"GitHub Slug Action\"\ndescription: \"GitHub Action to expose slug value of environment variables inside your GitHub workflow\"\nauthor: \"Romain Lespinasse\"\nbranding:\n  icon: \"minimize\"\n  color: \"blue\"\ninputs:\n  prefix:\n    description: \"Value to prepend to each generated variable\"\n    default: \"\"\n    required: false\n  slug-maxlength:\n    description: \"Max length of the slugified values\"\n    default: \"63\"\n    required: true\n  short-length:\n    description: \"Length of the shortify values (git default if empty)\"\n    required: false\nruns:\n  using: \"composite\"\n  steps:\n    - run: $GITHUB_ACTION_PATH/preflight.sh\n      id: prefligth\n      shell: bash\n      env:\n        INPUT_SLUG_MAXLENGTH: ${{ inputs.slug-maxlength }}\n        INPUT_SHORT_LENGTH: ${{ inputs.short-length }}\n\n    # From Environment Variables\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_REPOSITORY\n        value: ${{ github.repository }}\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_REF\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_HEAD_REF\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_BASE_REF\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n\n    # From Specific values\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_EVENT_REF\n        value: ${{ github.event.ref }}\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_REF_NAME\n        # Related to https://github.com/rlespinasse/github-slug-action/issues/104\n        value: ${{ env.GITHUB_HEAD_REF_RAW || env.GITHUB_REF_NAME_RAW }}\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n      env:\n        GITHUB_HEAD_REF_RAW: ${{ github.head_ref }}\n        GITHUB_REF_NAME_RAW: ${{ github.ref_name }}\n\n    # From Calculated values\n    - id: get-github-repository-owner-part\n      run: |\n        ownerpart=$(echo $GITHUB_REPOSITORY | cut -d/ -f1)\n        if [ -f \"$GITHUB_OUTPUT\" ]; then\n          echo \"github-repository-owner-part=${ownerpart}\" >> \"$GITHUB_OUTPUT\"\n        else\n          echo \"::set-output name=github-repository-owner-part::${ownerpart}\"\n        fi\n      shell: bash\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_REPOSITORY_OWNER_PART\n        value: ${{ steps.get-github-repository-owner-part.outputs.github-repository-owner-part }}\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n    - id: get-github-repository-name-part\n      run: |\n        namepart=$(echo $GITHUB_REPOSITORY | cut -d/ -f2)\n        if [ -f \"$GITHUB_OUTPUT\" ]; then\n          echo \"github-repository-name-part=${namepart}\" >> \"$GITHUB_OUTPUT\"\n        else\n          echo \"::set-output name=github-repository-name-part::${namepart}\"\n        fi\n      shell: bash\n    - uses: rlespinasse/slugify-value@v1.4.0\n      with:\n        key: GITHUB_REPOSITORY_NAME_PART\n        value: ${{ steps.get-github-repository-name-part.outputs.github-repository-name-part }}\n        prefix: ${{ inputs.prefix }}\n        slug-maxlength: ${{ inputs.slug-maxlength }}\n\n    # From sha\n    - uses: rlespinasse/shortify-git-revision@v1.6.0\n      with:\n        name: GITHUB_SHA\n        short-on-error: true\n        length: ${{ steps.prefligth.outputs.PREFLIGHT_SHORT_LENGTH }}\n        prefix: ${{ inputs.prefix }}\n    - uses: rlespinasse/shortify-git-revision@v1.6.0\n      with:\n        name: GITHUB_EVENT_PULL_REQUEST_HEAD_SHA\n        revision: ${{ github.event.pull_request.head.sha }}\n        short-on-error: true\n        length: ${{ steps.prefligth.outputs.PREFLIGHT_SHORT_LENGTH }}\n        prefix: ${{ inputs.prefix }}\n"], "filenames": ["action.yml"], "buggy_code_start_loc": [28], "buggy_code_end_loc": [107], "fixing_code_start_loc": [29], "fixing_code_end_loc": [103], "type": "CWE-77", "message": "github-slug-action is a GitHub Action to expose slug value of GitHub environment variables inside of one's GitHub workflow. Starting in version 4.0.0` and prior to version 4.4.1, this action uses the `github.head_ref` parameter in an insecure way. This vulnerability can be triggered by any user on GitHub on any workflow using the action on pull requests. They just need to create a pull request with a branch name, which can contain the attack payload. This can be used to execute code on the GitHub runners and to exfiltrate any secrets one uses in the CI pipeline. A patched action is available in version 4.4.1. No workaround is available.", "other": {"cve": {"id": "CVE-2023-27581", "sourceIdentifier": "security-advisories@github.com", "published": "2023-03-13T21:15:14.037", "lastModified": "2023-03-17T16:05:39.477", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "github-slug-action is a GitHub Action to expose slug value of GitHub environment variables inside of one's GitHub workflow. Starting in version 4.0.0` and prior to version 4.4.1, this action uses the `github.head_ref` parameter in an insecure way. This vulnerability can be triggered by any user on GitHub on any workflow using the action on pull requests. They just need to create a pull request with a branch name, which can contain the attack payload. This can be used to execute code on the GitHub runners and to exfiltrate any secrets one uses in the CI pipeline. A patched action is available in version 4.4.1. No workaround is available."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-77"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:github-slug-action_project:github-slug-action:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.4.1", "matchCriteriaId": "3A0A3629-2003-4230-8082-FD1FB2E171BF"}]}]}], "references": [{"url": "https://github.com/rlespinasse/github-slug-action/commit/102b1a064a9b145e56556e22b18b19c624538d94", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/rlespinasse/github-slug-action/releases/tag/v4.4.1", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/rlespinasse/github-slug-action/security/advisories/GHSA-6q4m-7476-932w", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://securitylab.github.com/research/github-actions-untrusted-input/", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/rlespinasse/github-slug-action/commit/102b1a064a9b145e56556e22b18b19c624538d94"}}