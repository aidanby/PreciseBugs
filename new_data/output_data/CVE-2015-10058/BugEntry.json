{"buggy_code": ["<?php\nrequire 'config.php';\n\n$lang = (isset($_GET['lang'])) ? $_GET['lang'] : 'en';\nif ( !array_key_exists($lang, $dbs)) {\n    $err = \"The language '$lang' has not yet been included. Please lodge an issue.\";\n}\n$suffix = $lang=='en' ? '' : '_'.$lang;\n\n?><!doctype html>\n<html class=\"no-js\" lang=\"en\">\n    <head>\n        <meta charset=\"utf-8\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n        <title>Wikisource (All Validated Works)</title>\n        <link rel=\"stylesheet\" href=\"//tools-static.wmflabs.org/cdnjs/ajax/libs/foundation/5.4.7/css/foundation.min.css\" />\n        <link rel=\"stylesheet\" href=\"css/style.css\" />\n        <script src=\"//tools-static.wmflabs.org/cdnjs/ajax/libs/modernizr/2.8.3/modernizr.min.js\"></script>\n    </head>\n    <body>\n\n        <div class=\"row\">\n            <div class=\"large-12 columns\">\n\n                <ul class=\"inline-list\">\n                    <li>Languages:</li>\n                    <?php foreach ($dbs as $l => $info): ?>\n                    <li>\n                    <?php if ($lang == $l): ?>\n                        <strong><?php echo $l ?></strong>\n                    <?php else: ?>\n                        <a href=\"?lang=<?php echo $l ?>\"><?php echo $l ?></a>\n                    <?php endif ?>\n                    </li>\n                    <?php endforeach ?>\n                </ul>\n\n                <h1>Wikisource <small>(All Validated Works)</small></h1>\n\n                <?php if (isset($err)): ?>\n                <p class=\"alert-box alert\"><?php echo $err ?></p>\n                <?php endif ?>\n\n                <p>\n                    This page presents the categorisation of the <span id=\"total-works\">x</span> works\n                    on the <a href=\"https://<?php echo $lang ?>.wikisource.org/\"><?php echo strtoupper($lang) ?> Wikisource</a>\n                    that are categorised, backed by scans,\n                    and have been validated (i.e. proofread by at least two contributors).\n                </p>\n                <p class=\"loading\"><img src=\"img/loading.gif\" /> Categories loading, please wait...</p>\n                <ol class=\"c hide\" id=\"catlist\"></ol>\n                <p>\n                    This list was last updated at:\n                    <span id=\"last-mod\">y</span> <a href=\"http://time.is/UTC\">UTC</a>.\n                </p>\n                <p>\n                    For more information please see\n                    <a href=\"https://github.com/samwilson/wikisource-cat-browser\">the code</a> on Github\n                    or contact <a href=\"https://en.wikisource.org/wiki/User:Samwilson\">User:Samwilson</a>.\n                    The above data is available in\n                    <a href=\"works<?php echo $suffix ?>.json\"><tt>works<?php echo $suffix ?>.json</tt></a>\n                    and <a href=\"categories<?php echo $suffix ?>.json\"><tt>categories<?php echo $suffix ?>.json</tt></a>.\n                </p>\n            </div>\n        </div>\n\n        <div class=\"hide\">\n            <img src='https://upload.wikimedia.org/wikipedia/commons/thumb/d/d5/EPUB_silk_icon.svg/15px-EPUB_silk_icon.svg.png' />\n        </div>\n        <script src=\"//tools-static.wmflabs.org/cdnjs/ajax/libs/jquery/2.1.1/jquery.min.js\"></script>\n        <script src=\"//tools-static.wmflabs.org/cdnjs/ajax/libs/foundation/5.4.7/js/foundation.min.js\"></script>\n        <script src=\"js/app.js\"></script>\n        <script>\n            var lang = '<?php echo $lang ?>';\n        </script>\n    </body>\n</html>\n"], "fixing_code": ["<?php\nrequire 'config.php';\n\n$lang = (isset($_GET['lang'])) ? htmlspecialchars($_GET['lang']) : 'en';\nif ( !array_key_exists($lang, $dbs)) {\n    $err = \"The language '$lang' has not yet been included. Please lodge an issue.\";\n}\n$suffix = $lang=='en' ? '' : '_'.$lang;\n\n?><!doctype html>\n<html class=\"no-js\" lang=\"en\">\n    <head>\n        <meta charset=\"utf-8\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n        <title>Wikisource (All Validated Works)</title>\n        <link rel=\"stylesheet\" href=\"//tools-static.wmflabs.org/cdnjs/ajax/libs/foundation/5.4.7/css/foundation.min.css\" />\n        <link rel=\"stylesheet\" href=\"css/style.css\" />\n        <script src=\"//tools-static.wmflabs.org/cdnjs/ajax/libs/modernizr/2.8.3/modernizr.min.js\"></script>\n    </head>\n    <body>\n\n        <div class=\"row\">\n            <div class=\"large-12 columns\">\n\n                <ul class=\"inline-list\">\n                    <li>Languages:</li>\n                    <?php foreach ($dbs as $l => $info): ?>\n                    <li>\n                    <?php if ($lang == $l): ?>\n                        <strong><?php echo $l ?></strong>\n                    <?php else: ?>\n                        <a href=\"?lang=<?php echo $l ?>\"><?php echo $l ?></a>\n                    <?php endif ?>\n                    </li>\n                    <?php endforeach ?>\n                </ul>\n\n                <h1>Wikisource <small>(All Validated Works)</small></h1>\n\n                <?php if (isset($err)): ?>\n                <p class=\"alert-box alert\"><?php echo $err ?></p>\n                <?php endif ?>\n\n                <p>\n                    This page presents the categorisation of the <span id=\"total-works\">x</span> works\n                    on the <a href=\"https://<?php echo $lang ?>.wikisource.org/\"><?php echo strtoupper($lang) ?> Wikisource</a>\n                    that are categorised, backed by scans,\n                    and have been validated (i.e. proofread by at least two contributors).\n                </p>\n                <p class=\"loading\"><img src=\"img/loading.gif\" /> Categories loading, please wait...</p>\n                <ol class=\"c hide\" id=\"catlist\"></ol>\n                <p>\n                    This list was last updated at:\n                    <span id=\"last-mod\">y</span> <a href=\"http://time.is/UTC\">UTC</a>.\n                </p>\n                <p>\n                    For more information please see\n                    <a href=\"https://github.com/samwilson/wikisource-cat-browser\">the code</a> on Github\n                    or contact <a href=\"https://en.wikisource.org/wiki/User:Samwilson\">User:Samwilson</a>.\n                    The above data is available in\n                    <a href=\"works<?php echo $suffix ?>.json\"><tt>works<?php echo $suffix ?>.json</tt></a>\n                    and <a href=\"categories<?php echo $suffix ?>.json\"><tt>categories<?php echo $suffix ?>.json</tt></a>.\n                </p>\n            </div>\n        </div>\n\n        <div class=\"hide\">\n            <img src='https://upload.wikimedia.org/wikipedia/commons/thumb/d/d5/EPUB_silk_icon.svg/15px-EPUB_silk_icon.svg.png' />\n        </div>\n        <script src=\"//tools-static.wmflabs.org/cdnjs/ajax/libs/jquery/2.1.1/jquery.min.js\"></script>\n        <script src=\"//tools-static.wmflabs.org/cdnjs/ajax/libs/foundation/5.4.7/js/foundation.min.js\"></script>\n        <script src=\"js/app.js\"></script>\n        <script>\n            var lang = '<?php echo $lang ?>';\n        </script>\n    </body>\n</html>\n"], "filenames": ["index.php"], "buggy_code_start_loc": [4], "buggy_code_end_loc": [5], "fixing_code_start_loc": [4], "fixing_code_end_loc": [5], "type": "CWE-79", "message": "A vulnerability, which was classified as problematic, was found in Wikisource Category Browser. This affects an unknown part of the file index.php. The manipulation of the argument lang leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is 764f4e8ce3f9242637df77530c70ae8a2ec4b6a1. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-218415.", "other": {"cve": {"id": "CVE-2015-10058", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-17T13:15:10.217", "lastModified": "2023-01-24T19:15:07.913", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability, which was classified as problematic, was found in Wikisource Category Browser. This affects an unknown part of the file index.php. The manipulation of the argument lang leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is 764f4e8ce3f9242637df77530c70ae8a2ec4b6a1. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-218415."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mediawiki:wikisource_category_browser:*:*:*:*:*:*:*:*", "versionEndExcluding": "2015-07-10", "matchCriteriaId": "6043F2BA-E41B-4A1E-835A-BD831EA4C409"}]}]}], "references": [{"url": "https://github.com/wikisource/ws-cat-browser/commit/764f4e8ce3f9242637df77530c70ae8a2ec4b6a1", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.218415", "source": "cna@vuldb.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://vuldb.com/?id.218415", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory", "VDB Entry"]}]}, "github_commit_url": "https://github.com/wikisource/ws-cat-browser/commit/764f4e8ce3f9242637df77530c70ae8a2ec4b6a1"}}