{"buggy_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.2\" reference=\"Main.Tags\" locale=\"\">\n  <web>Main</web>\n  <name>Tags</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>Main.WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>$services.localization.render(\"xe.tag.tags\")</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{velocity}}\n##\n## Tag application.\n##\n## - See a Tag Cloud of all tags within the wiki.\n## - See all the pages tagged with the given tag.\n## - Rename a tag.\n## - Delete a tag.\n##\n$xwiki.ssx.use('Main.Tags')##\n##\n## Set application variables (action and tag) from URL parameters.\n##\n#set ($do = \"$!{request.get('do')}\")\n#set ($tag = \"$!{request.get('tag')}\")\n#set ($wikiEscapedTag = $services.rendering.escape($tag, 'xwiki/2.1'))\n#set ($urlEscapedTag = $escapetool.url($tag))\n#set ($htmlEscapedTag = $escapetool.xml($tag))\n##\n## Macro displayTagAppTitle. Display level1 title of this app.\n##\n#macro (displayTagAppTitle $urlEscapedTag $htmlEscapedTag $displayButtons)\n  (% class=\"xapp\" %)\n  = (% class=\"highlight tag\" %)${wikiEscapedTag}##\n      #if ($xwiki.hasAdminRights() &amp;&amp; $displayButtons) ##\n        [[$services.localization.render('xe.tag.rename.link')&gt;&gt;||queryString=\"do=prepareRename&amp;tag=${urlEscapedTag}\" class=\"button rename\" rel=\"nofollow\"]] [[$services.localization.render('xe.tag.delete.link')&gt;&gt;||queryString=\"do=prepareDelete&amp;tag=${urlEscapedTag}\" class=\"button delete\" rel=\"nofollow\"]]##\n      #end\n    (%%) =\n#end\n##\n## Switch between all possible actions:\n## viewTag, prepareRename, rename, prepareDelete, delete, default (Tag cloud)\n##\n#if ($do == 'viewTag')\n  ##\n  ## View tag\n  ##\n  #displayTagAppTitle($urlEscapedTag $htmlEscapedTag true)\n  #if (\"$!{request.get('renamedTag')}\" != '')\n    {{info}}$services.localization.render('xe.tag.rename.success', [\"//${services.rendering.escape(${request.get('renamedTag')}, 'xwiki/2.1')}//\"]){{/info}}\n\n  #end\n  #set ($list = $xwiki.tag.getDocumentsWithTag($tag))\n  {{container layoutStyle=\"columns\"}}\n    (((\n      (% class=\"xapp\" %)\n      === $services.localization.render('xe.tag.alldocs', [\"//${wikiEscapedTag}//\"]) ===\n\n      #if ($list.size()&gt; 0)\n        {{html}}#displayDocumentList($list false $blacklistedSpaces){{/html}}\n      #else\n        (% class='noitems' %)$services.localization.render('xe.tag.notags')\n      #end\n    )))\n    (((\n      (% class=\"xapp\" %)\n      === $services.localization.render('xe.tag.activity', [\"//${wikiEscapedTag}//\"]) ===\n      {{notifications useUserPreferences=\"false\" displayOwnEvents=\"true\" tags=\"$wikiEscapedTag\" displayRSSLink=\"true\" /}}\n    )))\n  {{/container}}\n#elseif ($do == 'prepareRename')\n  ##\n  ## Prepare rename tag\n  ##\n  #displayTagAppTitle($urlEscapedTag $htmlEscapedTag false)\n{{html}}\n  &lt;form id=\"renameForm\" action=\"$doc.getURL()\" method=\"post\"&gt;\n   &lt;div&gt;\n    &lt;input type=\"hidden\" name=\"form_token\" value=\"$!{services.csrf.getToken()}\" /&gt;\n    &lt;input name=\"do\" type=\"hidden\" value=\"renameTag\" /&gt;\n    &lt;input name=\"tag\" type=\"hidden\" value=\"$htmlEscapedTag\" /&gt;\n    $services.localization.render('xe.tag.rename.renameto', [$htmlEscapedTag]) &lt;input type=\"text\" name=\"renameTo\" /&gt; &lt;span class=\"buttonwrapper\"&gt;&lt;input type=\"submit\" value=\"$services.localization.render('xe.tag.rename')\" class=\"button\"/&gt;&lt;/span&gt;&lt;span class=\"buttonwrapper\"&gt;&lt;a href=\"$doc.getURL('view', \"do=viewTag&amp;tag=${urlEscapedTag}\")\" class=\"secondary button\"&gt;$services.localization.render('cancel')&lt;/a&gt;&lt;/span&gt;\n   &lt;/div&gt;\n  &lt;/form&gt;\n{{/html}}\n#elseif ($do == 'renameTag')\n  ##\n  ## Rename tag\n  ##\n  #set ($renameTo = \"$!{request.get('renameTo')}\")\n  #set ($success = false)\n  #if ($renameTo != '')\n    #set ($success = $xwiki.tag.renameTag($tag, $renameTo))\n  #end\n  #if ($success == true || $success == 'OK')\n   #set ($urlEscapedRenameTo = $escapetool.url($renameTo))\n   $response.sendRedirect($doc.getURL('view', \"do=viewTag&amp;tag=${urlEscapedRenameTo}&amp;renamedTag=${urlEscapedTag}\"))\n  #else\n    {{error}}$services.localization.render('xe.tag.rename.failure', [\"//${wikiEscapedTag}//\", \"//${services.rendering.escape($renameTo, 'xwiki/2.1')}//\"]){{/error}}\n  #end\n#elseif ($do == 'prepareDelete')\n  ##\n  ## Prepare delete tag\n  ##\n  #displayTagAppTitle($urlEscapedTag $htmlEscapedTag false)\n{{html}}\n  &lt;form id=\"deleteForm\" action=\"$doc.getURL()\" method=\"post\"&gt;\n   &lt;div&gt;\n    &lt;input type=\"hidden\" name=\"form_token\" value=\"$!{services.csrf.getToken()}\" /&gt;\n    &lt;input name=\"do\" type=\"hidden\" value=\"deleteTag\" /&gt;\n    &lt;input name=\"tag\" type=\"hidden\" value=\"$htmlEscapedTag\" /&gt;\n    &lt;span class=\"buttonwrapper\"&gt;&lt;input type=\"submit\" value=\"$services.localization.render('xe.tag.delete', [$htmlEscapedTag])\" class=\"button\"/&gt;&lt;/span&gt;&lt;span class=\"buttonwrapper\"&gt;&lt;a href=\"$doc.getURL('view', \"do=viewTag&amp;tag=${urlEscapedTag}\")\" class=\"secondary button\"&gt;$services.localization.render('cancel')&lt;/a&gt;&lt;/span&gt;\n   &lt;/div&gt;\n  &lt;/form&gt;\n{{/html}}\n#elseif ($do == 'deleteTag')\n  ##\n  ## Delete tag\n  ##\n  #set ($success = $xwiki.tag.deleteTag($tag))\n  #if ($success == true || $success == 'OK')\n    $response.sendRedirect($doc.getURL('view', \"deletedTag=${urlEscapedTag}\"))\n  #else\n    {{error}}$services.localization.render('xe.tag.delete.failure', [\"//${wikiEscapedTag}//\"]){{/error}}\n  #end\n#else\n  ##\n  ## View all tags (Tag Cloud)\n  ##\n  #set ($title = 'All Tags')\n  #if (\"$!{request.get('deletedTag')}\" != '')\n    {{info}}$services.localization.render('xe.tag.delete.success', [\"//${services.rendering.escape($request.get('deletedTag'), 'xwiki/2.1')}//\"]){{/info}}\n\n  #end\n  {{tagcloud/}}\n#end\n#set ($displayDocExtra = false)\n{{/velocity}}</content>\n  <object>\n    <name>Main.Tags</name>\n    <number>0</number>\n    <className>XWiki.StyleSheetExtension</className>\n    <guid>842b2aaf-cc25-4c1d-b0de-c23318aa9cbe</guid>\n    <class>\n      <name>XWiki.StyleSheetExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>6</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <disabled>0</disabled>\n        <name>code</name>\n        <number>3</number>\n        <prettyName>Code</prettyName>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>1</number>\n        <prettyName>Content Type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>CSS|LESS</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>2</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>5</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>4</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>#template('colorThemeInit.vm')\n\nh1.xapp {\n  border-bottom: 0 none;\n  margin: 0;\n}\n\nh1.xapp + form {\n  margin: 1.5em 0 1em;\n}\n\nh1.xapp * {\n  vertical-align: middle;\n}\n\nh1.xapp .highlight {\n  background: url(\"$xwiki.getSkinFile('icons/silk/tag_blue.png')\") no-repeat 5px 50% $theme.backgroundSecondaryColor;\n  border: solid 1px $theme.borderColor;\n  border-radius: 10px;\n  display: inline-block;\n  font-weight: bold;\n  padding: 2px 8px 2px 25px;\n  white-space: nowrap;\n}\n\nh1.xapp .button {\n  background: no-repeat 3px 50% $theme.pageContentBackgroundColor;\n  border: solid 1px $theme.borderColor;\n  border-radius: 7px;\n  color: $theme.linkColor;\n  display : inline-block;\n  font-size: 50%;\n  font-weight: normal;\n  line-height: 1.5em;\n  padding: 2px 5px 2px 20px;\n}\n\nh1.xapp .delete {\n  background-image: url(\"$xwiki.getSkinFile('icons/silk/cross.png')\");\n}\n\nh1.xapp .rename {\n  background-image: url(\"$xwiki.getSkinFile('icons/silk/textfield_rename.png')\");\n}\n\nh1.xapp .button:hover {\n  background-color: $theme.highlightColor;\n  text-decoration: none;\n}\n</code>\n    </property>\n    <property>\n      <name/>\n    </property>\n    <property>\n      <parse>1</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n</xwikidoc>\n"], "fixing_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.2\" reference=\"Main.Tags\" locale=\"\">\n  <web>Main</web>\n  <name>Tags</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>Main.WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>$services.localization.render(\"xe.tag.tags\")</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{velocity}}\n##\n## Tag application.\n##\n## - See a Tag Cloud of all tags within the wiki.\n## - See all the pages tagged with the given tag.\n## - Rename a tag.\n## - Delete a tag.\n##\n$xwiki.ssx.use('Main.Tags')##\n##\n## Set application variables (action and tag) from URL parameters.\n##\n#set ($do = \"$!{request.get('do')}\")\n#set ($tag = \"$!{request.get('tag')}\")\n#set ($wikiEscapedTag = $services.rendering.escape($tag, 'xwiki/2.1'))\n#set ($urlEscapedTag = $escapetool.url($tag))\n#set ($htmlEscapedTag = $escapetool.xml($tag))\n##\n## Macro displayTagAppTitle. Display level1 title of this app.\n##\n#macro (displayTagAppTitle $urlEscapedTag $htmlEscapedTag $displayButtons)\n  (% class=\"xapp\" %)\n  = (% class=\"highlight tag\" %)${wikiEscapedTag}##\n      #if ($xwiki.hasAdminRights() &amp;&amp; $displayButtons) ##\n        [[$services.localization.render('xe.tag.rename.link')&gt;&gt;||queryString=\"do=prepareRename&amp;tag=${urlEscapedTag}\" class=\"button rename\" rel=\"nofollow\"]] [[$services.localization.render('xe.tag.delete.link')&gt;&gt;||queryString=\"do=prepareDelete&amp;tag=${urlEscapedTag}\" class=\"button delete\" rel=\"nofollow\"]]##\n      #end\n    (%%) =\n#end\n##\n## Switch between all possible actions:\n## viewTag, prepareRename, rename, prepareDelete, delete, default (Tag cloud)\n##\n#if ($do == 'viewTag')\n  ##\n  ## View tag\n  ##\n  #displayTagAppTitle($urlEscapedTag $htmlEscapedTag true)\n  #if (\"$!{request.get('renamedTag')}\" != '')\n    {{info}}$services.localization.render('xe.tag.rename.success', [\"//${services.rendering.escape(${request.get('renamedTag')}, 'xwiki/2.1')}//\"]){{/info}}\n\n  #end\n  #set ($list = $xwiki.tag.getDocumentsWithTag($tag))\n  {{container layoutStyle=\"columns\"}}\n    (((\n      (% class=\"xapp\" %)\n      === $services.localization.render('xe.tag.alldocs', [\"//${wikiEscapedTag}//\"]) ===\n\n      #if ($list.size()&gt; 0)\n        {{html}}#displayDocumentList($list false $blacklistedSpaces){{/html}}\n      #else\n        (% class='noitems' %)$services.localization.render('xe.tag.notags')\n      #end\n    )))\n    (((\n      (% class=\"xapp\" %)\n      === $services.localization.render('xe.tag.activity', [\"//${wikiEscapedTag}//\"]) ===\n      {{notifications useUserPreferences=\"false\" displayOwnEvents=\"true\" tags=\"$wikiEscapedTag\" displayRSSLink=\"true\" /}}\n    )))\n  {{/container}}\n#elseif ($do == 'prepareRename')\n  ##\n  ## Prepare rename tag\n  ##\n  #displayTagAppTitle($urlEscapedTag $htmlEscapedTag false)\n{{html}}\n  &lt;form id=\"renameForm\" action=\"$doc.getURL()\" method=\"post\"&gt;\n   &lt;div&gt;\n    &lt;input type=\"hidden\" name=\"form_token\" value=\"$!{services.csrf.getToken()}\" /&gt;\n    &lt;input name=\"do\" type=\"hidden\" value=\"renameTag\" /&gt;\n    &lt;input name=\"tag\" type=\"hidden\" value=\"$htmlEscapedTag\" /&gt;\n    $services.localization.render('xe.tag.rename.renameto', [$htmlEscapedTag]) &lt;input type=\"text\" name=\"renameTo\" /&gt; &lt;span class=\"buttonwrapper\"&gt;&lt;input type=\"submit\" value=\"$services.localization.render('xe.tag.rename')\" class=\"button\"/&gt;&lt;/span&gt;&lt;span class=\"buttonwrapper\"&gt;&lt;a href=\"$doc.getURL('view', \"do=viewTag&amp;tag=${urlEscapedTag}\")\" class=\"secondary button\"&gt;$services.localization.render('cancel')&lt;/a&gt;&lt;/span&gt;\n   &lt;/div&gt;\n  &lt;/form&gt;\n{{/html}}\n#elseif ($do == 'renameTag')\n  #if (!$services.csrf.isTokenValid($request.get('form_token')))\n    #set ($discard = $response.sendError(401, \"Wrong CSRF token\"))\n  #else\n    ##\n    ## Rename tag\n    ##\n    #set ($renameTo = \"$!{request.get('renameTo')}\")\n    #set ($success = false)\n    #if ($renameTo != '')\n      #set ($success = $xwiki.tag.renameTag($tag, $renameTo))\n    #end\n    #if ($success == true || $success == 'OK')\n     #set ($urlEscapedRenameTo = $escapetool.url($renameTo))\n     $response.sendRedirect($doc.getURL('view', \"do=viewTag&amp;tag=${urlEscapedRenameTo}&amp;renamedTag=${urlEscapedTag}\"))\n    #else\n      {{error}}$services.localization.render('xe.tag.rename.failure', [\"//${wikiEscapedTag}//\", \"//${services.rendering.escape($renameTo, 'xwiki/2.1')}//\"]){{/error}}\n    #end\n  #end\n#elseif ($do == 'prepareDelete')\n  ##\n  ## Prepare delete tag\n  ##\n  #displayTagAppTitle($urlEscapedTag $htmlEscapedTag false)\n{{html}}\n  &lt;form id=\"deleteForm\" action=\"$doc.getURL()\" method=\"post\"&gt;\n   &lt;div&gt;\n    &lt;input type=\"hidden\" name=\"form_token\" value=\"$!{services.csrf.getToken()}\" /&gt;\n    &lt;input name=\"do\" type=\"hidden\" value=\"deleteTag\" /&gt;\n    &lt;input name=\"tag\" type=\"hidden\" value=\"$htmlEscapedTag\" /&gt;\n    &lt;span class=\"buttonwrapper\"&gt;&lt;input type=\"submit\" value=\"$services.localization.render('xe.tag.delete', [$htmlEscapedTag])\" class=\"button\"/&gt;&lt;/span&gt;&lt;span class=\"buttonwrapper\"&gt;&lt;a href=\"$doc.getURL('view', \"do=viewTag&amp;tag=${urlEscapedTag}\")\" class=\"secondary button\"&gt;$services.localization.render('cancel')&lt;/a&gt;&lt;/span&gt;\n   &lt;/div&gt;\n  &lt;/form&gt;\n{{/html}}\n#elseif ($do == 'deleteTag')\n  #if (!$services.csrf.isTokenValid($request.get('form_token')))\n    #set ($discard = $response.sendError(401, \"Wrong CSRF token\"))\n  #else\n    ##\n    ## Delete tag\n    ##\n    #set ($success = $xwiki.tag.deleteTag($tag))\n    #if ($success == true || $success == 'OK')\n      $response.sendRedirect($doc.getURL('view', \"deletedTag=${urlEscapedTag}\"))\n    #else\n      {{error}}$services.localization.render('xe.tag.delete.failure', [\"//${wikiEscapedTag}//\"]){{/error}}\n    #end\n  #end\n#else\n  ##\n  ## View all tags (Tag Cloud)\n  ##\n  #set ($title = 'All Tags')\n  #if (\"$!{request.get('deletedTag')}\" != '')\n    {{info}}$services.localization.render('xe.tag.delete.success', [\"//${services.rendering.escape($request.get('deletedTag'), 'xwiki/2.1')}//\"]){{/info}}\n\n  #end\n  {{tagcloud/}}\n#end\n#set ($displayDocExtra = false)\n{{/velocity}}</content>\n  <object>\n    <name>Main.Tags</name>\n    <number>0</number>\n    <className>XWiki.StyleSheetExtension</className>\n    <guid>842b2aaf-cc25-4c1d-b0de-c23318aa9cbe</guid>\n    <class>\n      <name>XWiki.StyleSheetExtension</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <cache>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>cache</name>\n        <number>6</number>\n        <prettyName>Caching policy</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>long|short|default|forbid</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </cache>\n      <code>\n        <disabled>0</disabled>\n        <name>code</name>\n        <number>3</number>\n        <prettyName>Code</prettyName>\n        <rows>20</rows>\n        <size>50</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>1</number>\n        <prettyName>Content Type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>CSS|LESS</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>2</number>\n        <prettyName>Name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <parse>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>parse</name>\n        <number>5</number>\n        <prettyName>Parse content</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </parse>\n      <use>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>use</name>\n        <number>4</number>\n        <prettyName>Use this extension</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator> </separator>\n        <separators>|, </separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>currentPage|onDemand|always</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </use>\n    </class>\n    <property>\n      <cache>long</cache>\n    </property>\n    <property>\n      <code>#template('colorThemeInit.vm')\n\nh1.xapp {\n  border-bottom: 0 none;\n  margin: 0;\n}\n\nh1.xapp + form {\n  margin: 1.5em 0 1em;\n}\n\nh1.xapp * {\n  vertical-align: middle;\n}\n\nh1.xapp .highlight {\n  background: url(\"$xwiki.getSkinFile('icons/silk/tag_blue.png')\") no-repeat 5px 50% $theme.backgroundSecondaryColor;\n  border: solid 1px $theme.borderColor;\n  border-radius: 10px;\n  display: inline-block;\n  font-weight: bold;\n  padding: 2px 8px 2px 25px;\n  white-space: nowrap;\n}\n\nh1.xapp .button {\n  background: no-repeat 3px 50% $theme.pageContentBackgroundColor;\n  border: solid 1px $theme.borderColor;\n  border-radius: 7px;\n  color: $theme.linkColor;\n  display : inline-block;\n  font-size: 50%;\n  font-weight: normal;\n  line-height: 1.5em;\n  padding: 2px 5px 2px 20px;\n}\n\nh1.xapp .delete {\n  background-image: url(\"$xwiki.getSkinFile('icons/silk/cross.png')\");\n}\n\nh1.xapp .rename {\n  background-image: url(\"$xwiki.getSkinFile('icons/silk/textfield_rename.png')\");\n}\n\nh1.xapp .button:hover {\n  background-color: $theme.highlightColor;\n  text-decoration: none;\n}\n</code>\n    </property>\n    <property>\n      <name/>\n    </property>\n    <property>\n      <parse>1</parse>\n    </property>\n    <property>\n      <use>onDemand</use>\n    </property>\n  </object>\n</xwikidoc>\n"], "filenames": ["xwiki-platform-core/xwiki-platform-tag/xwiki-platform-tag-ui/src/main/resources/Main/Tags.xml"], "buggy_code_start_loc": [115], "buggy_code_end_loc": [153], "fixing_code_start_loc": [115], "fixing_code_end_loc": [161], "type": "CWE-352", "message": "XWiki Platform is vulnerable to Cross-Site Request Forgery (CSRF) that may allow attackers to delete or rename tags without needing any confirmation. The problem has been patched in XWiki 13.10.7, 14.4.1 and 14.5RC1. Workarounds: It's possible to patch existing instances directly by editing the page Main.Tags and add this kind of check, in the code for renaming and for deleting: ``` #if (!$services.csrf.isTokenValid($request.get('form_token'))) #set ($discard = $response.sendError(401, \"Wrong CSRF token\")) #end ```", "other": {"cve": {"id": "CVE-2022-41927", "sourceIdentifier": "security-advisories@github.com", "published": "2022-11-23T19:15:12.563", "lastModified": "2022-11-30T16:22:03.337", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "XWiki Platform is vulnerable to Cross-Site Request Forgery (CSRF) that may allow attackers to delete or rename tags without needing any confirmation. The problem has been patched in XWiki 13.10.7, 14.4.1 and 14.5RC1. Workarounds: It's possible to patch existing instances directly by editing the page Main.Tags and add this kind of check, in the code for renaming and for deleting: ``` #if (!$services.csrf.isTokenValid($request.get('form_token'))) #set ($discard = $response.sendError(401, \"Wrong CSRF token\")) #end ```"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.0}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartExcluding": "3.2", "versionEndExcluding": "13.10.7", "matchCriteriaId": "EAFB9FDB-DCD2-40D6-9190-BC8136D4B402"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:3.2:milestone2:*:*:*:*:*:*", "matchCriteriaId": "902E7F43-561F-4B89-B902-CDEB6E6C938B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:3.2:milestone3:*:*:*:*:*:*", "matchCriteriaId": "CB7202B8-E057-446D-A56A-30ED1D5D350F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:14.4:*:*:*:*:*:*:*", "matchCriteriaId": "26C528CB-800E-4D9E-9C90-CEE3D335B0FE"}]}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/7fd4cda0590180c4d34f557597e9e10e263def9e", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-mq7h-5574-hw9f", "source": "security-advisories@github.com", "tags": ["Mitigation", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/xwiki/xwiki-platform/commit/7fd4cda0590180c4d34f557597e9e10e263def9e"}}