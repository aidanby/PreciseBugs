{"buggy_code": ["<?php\n# MantisBT - A PHP based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This page stores the reported bug\n *\n * @package MantisBT\n * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org\n * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n * @link http://www.mantisbt.org\n *\n * @uses core.php\n * @uses authentication_api.php\n * @uses constant_inc.php\n * @uses custom_field_api.php\n * @uses error_api.php\n * @uses file_api.php\n * @uses form_api.php\n * @uses gpc_api.php\n * @uses helper_api.php\n * @uses html_api.php\n * @uses lang_api.php\n * @uses print_api.php\n * @uses string_api.php\n * @uses utility_api.php\n */\n\nrequire_once( 'core.php' );\nrequire_api( 'constant_inc.php' );\nrequire_api( 'custom_field_api.php' );\nrequire_api( 'error_api.php' );\nrequire_api( 'file_api.php' );\nrequire_api( 'form_api.php' );\nrequire_api( 'gpc_api.php' );\nrequire_api( 'helper_api.php' );\nrequire_api( 'html_api.php' );\nrequire_api( 'lang_api.php' );\nrequire_api( 'print_api.php' );\nrequire_api( 'string_api.php' );\nrequire_api( 'utility_api.php' );\n\nform_security_validate( 'bug_report' );\n\n$f_master_bug_id = gpc_get_int( 'm_id', 0 );\n$f_rel_type = gpc_get_int( 'rel_type', BUG_REL_NONE );\n$f_copy_notes_from_parent = gpc_get_bool( 'copy_notes_from_parent', false );\n$f_copy_attachments_from_parent = gpc_get_bool( 'copy_attachments_from_parent', false );\n$f_report_stay = gpc_get_bool( 'report_stay', false );\n\n$t_clone_info = array(\n\t'master_issue_id' => $f_master_bug_id,\n\t'relationship_type' => $f_rel_type,\n\t'copy_notes' => $f_copy_notes_from_parent,\n\t'copy_files' => $f_copy_attachments_from_parent\n);\n\nif( $f_master_bug_id > 0 ) {\n\tbug_ensure_exists( $f_master_bug_id );\n\tif( bug_is_readonly( $f_master_bug_id ) ) {\n\t\terror_parameters( $f_master_bug_id );\n\t\ttrigger_error( ERROR_BUG_READ_ONLY_ACTION_DENIED, ERROR );\n\t}\n\t$t_master_bug = bug_get( $f_master_bug_id, true );\n\t$t_project_id = $t_master_bug->project_id;\n} else {\n\t$f_project_id = gpc_get_int( 'project_id' );\n\t$t_project_id = $f_project_id;\n}\n\n$t_issue = array(\n\t'project' => array( 'id' => $t_project_id ),\n\t'reporter' => array( 'id' => auth_get_current_user_id() ),\n\t'summary' => gpc_get_string( 'summary' ),\n\t'description' => gpc_get_string( 'description' ),\n);\n\n$t_tag_string = '';\n$f_tag_select = gpc_get_int( 'tag_select', 0 );\nif( $f_tag_select != 0 ) {\n\t$t_tag_string = tag_get_name( $f_tag_select );\n}\n\n$f_tag_string = gpc_get_string( 'tag_string', '' );\nif( !is_blank( $f_tag_string ) ) {\n\t$t_tag_string = is_blank( $t_tag_string ) ? $f_tag_string : ',' . $f_tag_string;\n}\n\n$t_tags = tag_parse_string( $t_tag_string );\nif( !empty( $t_tags ) ) {\n\t$t_issue['tags'] = array();\n\tforeach( $t_tags as $t_tag ) {\n\t\t$t_issue['tags'][] = array( 'id' => $t_tag['id'] );\n\t}\n}\n\n$f_files = gpc_get_file( 'ufile', null );\nif( $f_files !== null && !empty( $f_files ) ) {\n\t$t_issue['files'] = helper_array_transpose( $f_files );\n}\n\n$t_build = gpc_get_string( 'build', '' );\nif( !is_blank( $t_build ) ) {\n\t$t_issue['build'] = $t_build;\n}\n\n$t_platform = gpc_get_string( 'platform', '' );\nif( !is_blank( $t_platform ) ) {\n\t$t_issue['platform'] = $t_platform;\n}\n\n$t_os = gpc_get_string( 'os', '' );\nif( !is_blank( $t_os ) ) {\n\t$t_issue['os'] = $t_os;\n}\n\n$t_os_build = gpc_get_string( 'os_build', '' );\nif( !is_blank( $t_os_build ) ) {\n\t$t_issue['os_build'] = $t_os_build;\n}\n\n$t_version = gpc_get_string( 'product_version', '' );\nif( !is_blank( $t_version ) ) {\n\t$t_issue['version'] = array( 'name' => $t_version );\n}\n\n$t_target_version = gpc_get_string( 'target_version', '' );\nif( !is_blank( $t_target_version ) ) {\n\t$t_issue['target_version'] = array( 'name' => $t_target_version );\n}\n\n$t_profile_id = gpc_get_int( 'profile_id', 0 );\nif( $t_profile_id != 0 ) {\n\t$t_issue['profile'] = array( 'id' => $t_profile_id );\n}\n\n$t_handler_id = gpc_get_int( 'handler_id', NO_USER );\nif( $t_handler_id != NO_USER ) {\n\t$t_issue['handler'] = array( 'id' => $t_handler_id );\n}\n\n$t_view_state = gpc_get_int( 'view_state', 0 );\nif( $t_view_state != 0 ) {\n\t$t_issue['view_state'] = array( 'id' => $t_view_state );\n}\n\n$t_category_id = gpc_get_int( 'category_id', 0 );\nif( $t_category_id != 0 ) {\n\t$t_issue['category'] = array( 'id' => $t_category_id );\n}\n\n$t_reproducibility = gpc_get_int( 'reproducibility', 0 );\nif( $t_reproducibility != 0 ) {\n\t$t_issue['reproducibility'] = array( 'id' => $t_reproducibility );\n}\n\n$t_severity = gpc_get_int( 'severity', 0 );\nif( $t_severity != 0 ) {\n\t$t_issue['severity'] = array( 'id' => $t_severity );\n}\n\n$t_priority = gpc_get_int( 'priority', 0 );\nif( $t_priority != 0 ) {\n\t$t_issue['priority'] = array( 'id' => $t_priority );\n}\n\n$t_projection = gpc_get_int( 'projection', 0 );\nif( $t_projection != 0 ) {\n\t$t_issue['projection'] = array( 'id' => $t_projection );\n}\n\n$t_eta = gpc_get_int( 'eta', 0 );\nif( $t_eta != 0 ) {\n\t$t_issue['eta'] = array( 'id' => $t_eta );\n}\n\n$t_resolution = gpc_get_int( 'resolution', 0 );\nif( $t_resolution != 0 ) {\n\t$t_issue['resolution'] = array( 'id' => $t_resolution );\n}\n\n$t_status = gpc_get_int( 'status', 0 );\nif( $t_status != 0 ) {\n\t$t_issue['status'] = array( 'id' => $t_status );\n}\n\n$t_steps_to_reproduce = gpc_get_string( 'steps_to_reproduce', null );\nif( $t_steps_to_reproduce !== null ) {\n\t$t_issue['steps_to_reproduce'] = $t_steps_to_reproduce;\n}\n\n$t_additional_info = gpc_get_string( 'additional_info', null );\nif( $t_additional_info !== null ) {\n\t$t_issue['additional_information'] = $t_additional_info;\n}\n\n$t_due_date = gpc_get_string( 'due_date', null );\nif( $t_due_date !== null ) {\n\t$t_issue['due_date'] = $t_due_date;\n}\n\n# Validate the custom fields before adding the bug.\n$t_related_custom_field_ids = custom_field_get_linked_ids( $t_project_id );\n$t_custom_fields = array();\nforeach( $t_related_custom_field_ids as $t_id ) {\n\t$t_def = custom_field_get_definition( $t_id );\n\n\t# Produce an error if the field is required but wasn't posted\n\tif( gpc_isset_custom_field( $t_id, $t_def['type'] ) ) {\n\t\t$t_custom_fields[] = array(\n\t\t\t'field' => array( 'id' => $t_id ),\n\t\t\t'value' => gpc_get_custom_field( 'custom_field_' . $t_id, $t_def['type'], null )\n\t\t);\n\t}\n}\n\nif( !empty( $t_custom_fields ) ) {\n\t$t_issue['custom_fields'] = $t_custom_fields;\n}\n\n$t_data = array(\n\t'payload' => array( 'issue' => $t_issue ),\n);\n\nif( $f_master_bug_id > 0 ) {\n\t$t_data['options'] = array( 'clone_info' => $t_clone_info );\n}\n\n$t_command = new IssueAddCommand( $t_data );\n$t_result = $t_command->execute();\n$t_issue_id = (int)$t_result['issue_id'];\n\nform_security_purge( 'bug_report' );\n\nlayout_page_header_begin();\n\nif( $f_report_stay ) {\n\t$t_fields = array(\n\t\t'category_id', 'severity', 'reproducibility', 'profile_id', 'platform',\n\t\t'os', 'os_build', 'target_version', 'build', 'view_state', 'due_date'\n\t);\n\n\t$t_issue = bug_get( $t_issue_id );\n\n\t$t_data = array();\n\tforeach( $t_fields as $t_field ) {\n\t\t$t_data[$t_field] = $t_issue->$t_field;\n\t}\n\n\t$t_data['product_version'] = $t_issue->version;\n\t$t_data['report_stay'] = 1;\n\n\t$t_report_more_bugs_url = string_get_bug_report_url() . '?' . http_build_query( $t_data );\n\n\thtml_meta_redirect( $t_report_more_bugs_url );\n} else {\n\thtml_meta_redirect( 'view_all_bug_page.php' );\n}\n\nlayout_page_header_end();\n\nlayout_page_begin( 'bug_report_page.php' );\n\n$t_buttons = array(\n\tarray( string_get_bug_view_url( $t_issue_id ), sprintf( lang_get( 'view_submitted_bug_link' ), $t_issue_id ) ),\n\tarray( 'view_all_bug_page.php', lang_get( 'view_bugs_link' ) ),\n);\n\nif( $f_report_stay ) {\n\t$t_buttons[] = array( $t_report_more_bugs_url, lang_get( 'report_more_bugs' ) );\n}\n\nhtml_operation_confirmation( $t_buttons, '', CONFIRMATION_TYPE_SUCCESS );\n\nlayout_page_end();\n", "<?php\n# MantisBT - A PHP based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This file POSTs data to report_bug.php\n *\n * @package MantisBT\n * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org\n * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n * @link http://www.mantisbt.org\n *\n * @uses core.php\n * @uses access_api.php\n * @uses authentication_api.php\n * @uses bug_api.php\n * @uses collapse_api.php\n * @uses columns_api.php\n * @uses config_api.php\n * @uses constant_inc.php\n * @uses custom_field_api.php\n * @uses date_api.php\n * @uses error_api.php\n * @uses event_api.php\n * @uses file_api.php\n * @uses form_api.php\n * @uses gpc_api.php\n * @uses helper_api.php\n * @uses html_api.php\n * @uses lang_api.php\n * @uses print_api.php\n * @uses profile_api.php\n * @uses project_api.php\n * @uses relationship_api.php\n * @uses string_api.php\n * @uses utility_api.php\n * @uses version_api.php\n */\n\n$g_allow_browser_cache = 1;\n\nrequire_once( 'core.php' );\nrequire_api( 'access_api.php' );\nrequire_api( 'authentication_api.php' );\nrequire_api( 'bug_api.php' );\nrequire_api( 'collapse_api.php' );\nrequire_api( 'columns_api.php' );\nrequire_api( 'config_api.php' );\nrequire_api( 'constant_inc.php' );\nrequire_api( 'custom_field_api.php' );\nrequire_api( 'date_api.php' );\nrequire_api( 'error_api.php' );\nrequire_api( 'event_api.php' );\nrequire_api( 'file_api.php' );\nrequire_api( 'form_api.php' );\nrequire_api( 'gpc_api.php' );\nrequire_api( 'helper_api.php' );\nrequire_api( 'html_api.php' );\nrequire_api( 'lang_api.php' );\nrequire_api( 'print_api.php' );\nrequire_api( 'profile_api.php' );\nrequire_api( 'project_api.php' );\nrequire_api( 'relationship_api.php' );\nrequire_api( 'string_api.php' );\nrequire_api( 'utility_api.php' );\nrequire_api( 'version_api.php' );\n\n$f_master_bug_id = gpc_get_int( 'm_id', 0 );\n\nif( $f_master_bug_id > 0 ) {\n\t# master bug exists...\n\tbug_ensure_exists( $f_master_bug_id );\n\n\t# master bug is not read-only...\n\tif( bug_is_readonly( $f_master_bug_id ) ) {\n\t\terror_parameters( $f_master_bug_id );\n\t\ttrigger_error( ERROR_BUG_READ_ONLY_ACTION_DENIED, ERROR );\n\t}\n\n\t$t_bug = bug_get( $f_master_bug_id, true );\n\n\t#@@@ (thraxisp) Note that the master bug is cloned into the same project as the master, independent of\n\t#       what the current project is set to.\n\tif( $t_bug->project_id != helper_get_current_project() ) {\n\t\t# in case the current project is not the same project of the bug we are viewing...\n\t\t# ... override the current project. This to avoid problems with categories and handlers lists etc.\n\t\t$g_project_override = $t_bug->project_id;\n\t\t$t_changed_project = true;\n\t} else {\n\t\t$t_changed_project = false;\n\t}\n\n\taccess_ensure_project_level( config_get( 'report_bug_threshold' ) );\n\n\t$f_build\t\t\t\t= $t_bug->build;\n\t$f_platform\t\t\t\t= $t_bug->platform;\n\t$f_os\t\t\t\t\t= $t_bug->os;\n\t$f_os_build\t\t\t\t= $t_bug->os_build;\n\t$f_product_version\t\t= $t_bug->version;\n\t$f_target_version\t\t= $t_bug->target_version;\n\t$f_profile_id\t\t\t= 0;\n\t$f_handler_id\t\t\t= $t_bug->handler_id;\n\n\t$f_category_id\t\t\t= $t_bug->category_id;\n\t$f_reproducibility\t\t= $t_bug->reproducibility;\n\t$f_eta\t\t\t\t\t= $t_bug->eta;\n\t$f_severity\t\t\t\t= $t_bug->severity;\n\t$f_priority\t\t\t\t= $t_bug->priority;\n\t$f_summary\t\t\t\t= $t_bug->summary;\n\t$f_description\t\t\t= $t_bug->description;\n\t$f_steps_to_reproduce\t= $t_bug->steps_to_reproduce;\n\t$f_additional_info\t\t= $t_bug->additional_information;\n\t$f_view_state\t\t\t= (int)$t_bug->view_state;\n\t$f_due_date\t\t\t\t= $t_bug->due_date;\n\n\t$t_project_id\t\t\t= $t_bug->project_id;\n} else {\n\t# Get Project Id and set it as current\n\t$t_current_project = helper_get_current_project();\n\t$t_project_id = gpc_get_int( 'project_id', $t_current_project );\n\n\t# If all projects, use default project if set\n\t$t_default_project = user_pref_get_pref( auth_get_current_user_id(), 'default_project' );\n\tif( ALL_PROJECTS == $t_project_id && ALL_PROJECTS != $t_default_project ) {\n\t\t$t_project_id = $t_default_project;\n\t}\n\n\tif( ( ALL_PROJECTS == $t_project_id || project_exists( $t_project_id ) )\n\t\t&& $t_project_id != $t_current_project\n\t\t&& project_enabled( $t_project_id ) ) {\n\t\thelper_set_current_project( $t_project_id );\n\t\t# Reloading the page is required so that the project browser\n\t\t# reflects the new current project\n\t\tprint_header_redirect( $_SERVER['REQUEST_URI'], true, false, true );\n\t}\n\n\t# New issues cannot be reported for the 'All Project' selection\n\tif( ALL_PROJECTS == $t_current_project ) {\n\t\tprint_header_redirect( 'login_select_proj_page.php?ref=bug_report_page.php' );\n\t}\n\n\t# Check for bug report threshold\n\tif( !access_has_project_level( config_get( 'report_bug_threshold' ) ) ) {\n\t\t# If can't report on current project, show project selector if there is any other allowed project\n\t\taccess_ensure_any_project_level( 'report_bug_threshold' );\n\t\tprint_header_redirect( 'login_select_proj_page.php?ref=bug_report_page.php' );\n\t}\n\taccess_ensure_project_level( config_get( 'report_bug_threshold' ) );\n\n\t$f_build\t\t\t\t= gpc_get_string( 'build', '' );\n\t$f_platform\t\t\t\t= gpc_get_string( 'platform', '' );\n\t$f_os\t\t\t\t\t= gpc_get_string( 'os', '' );\n\t$f_os_build\t\t\t\t= gpc_get_string( 'os_build', '' );\n\t$f_product_version\t\t= gpc_get_string( 'product_version', '' );\n\t$f_target_version\t\t= gpc_get_string( 'target_version', '' );\n\t$f_profile_id\t\t\t= gpc_get_int( 'profile_id', 0 );\n\t$f_handler_id\t\t\t= gpc_get_int( 'handler_id', 0 );\n\n\t$f_category_id\t\t\t= gpc_get_int( 'category_id', 0 );\n\t$f_reproducibility\t\t= gpc_get_int( 'reproducibility', (int)config_get( 'default_bug_reproducibility' ) );\n\t$f_eta\t\t\t\t\t= gpc_get_int( 'eta', (int)config_get( 'default_bug_eta' ) );\n\t$f_severity\t\t\t\t= gpc_get_int( 'severity', (int)config_get( 'default_bug_severity' ) );\n\t$f_priority\t\t\t\t= gpc_get_int( 'priority', (int)config_get( 'default_bug_priority' ) );\n\t$f_summary\t\t\t\t= gpc_get_string( 'summary', '' );\n\t$f_description\t\t\t= gpc_get_string( 'description', config_get( 'default_bug_description' ) );\n\t$f_steps_to_reproduce\t= gpc_get_string( 'steps_to_reproduce', config_get( 'default_bug_steps_to_reproduce' ) );\n\t$f_additional_info\t\t= gpc_get_string( 'additional_info', config_get( 'default_bug_additional_info' ) );\n\t$f_view_state\t\t\t= gpc_get_int( 'view_state', (int)config_get( 'default_bug_view_status' ) );\n\t$f_due_date\t\t\t\t= gpc_get_string( 'due_date', date_strtotime( config_get( 'due_date_default' ) ) );\n\n\tif( $f_due_date == '' ) {\n\t\t$f_due_date = date_get_null();\n\t}\n\n\t$t_changed_project\t\t= false;\n}\n\n$f_report_stay\t\t\t= gpc_get_bool( 'report_stay', false );\n$f_copy_notes_from_parent         = gpc_get_bool( 'copy_notes_from_parent', false );\n$f_copy_attachments_from_parent   = gpc_get_bool( 'copy_attachments_from_parent', false );\n\n$t_fields = config_get( 'bug_report_page_fields' );\n$t_fields = columns_filter_disabled( $t_fields );\n\n$t_show_category = in_array( 'category_id', $t_fields );\n$t_show_reproducibility = in_array( 'reproducibility', $t_fields );\n$t_show_eta = in_array( 'eta', $t_fields );\n$t_show_severity = in_array( 'severity', $t_fields );\n$t_show_priority = in_array( 'priority', $t_fields );\n$t_show_steps_to_reproduce = in_array( 'steps_to_reproduce', $t_fields );\n$t_show_handler = in_array( 'handler', $t_fields ) && access_has_project_level( config_get( 'update_bug_assign_threshold' ) );\n$t_show_profiles = config_get( 'enable_profiles' );\n$t_show_platform = $t_show_profiles && in_array( 'platform', $t_fields );\n$t_show_os = $t_show_profiles && in_array( 'os', $t_fields );\n$t_show_os_version = $t_show_profiles && in_array( 'os_version', $t_fields );\n$t_show_resolution = in_array( 'resolution', $t_fields );\n$t_show_status = in_array( 'status', $t_fields );\n$t_show_tags =\n\tin_array( 'tags', $t_fields ) &&\n\taccess_has_project_level(\n\t\tconfig_get( 'tag_attach_threshold', /* default */ null, /* user */ null, $t_project_id ),\n\t\t$t_project_id );\n\n$t_show_versions = version_should_show_product_version( $t_project_id );\n$t_show_product_version = $t_show_versions && in_array( 'product_version', $t_fields );\n$t_show_product_build = $t_show_versions && in_array( 'product_build', $t_fields ) && config_get( 'enable_product_build' ) == ON;\n$t_show_target_version = $t_show_versions && in_array( 'target_version', $t_fields ) && access_has_project_level( config_get( 'roadmap_update_threshold' ) );\n$t_show_additional_info = in_array( 'additional_info', $t_fields );\n$t_show_due_date = in_array( 'due_date', $t_fields ) && access_has_project_level( config_get( 'due_date_update_threshold' ), helper_get_current_project(), auth_get_current_user_id() );\n$t_show_attachments = in_array( 'attachments', $t_fields ) && file_allow_bug_upload();\n$t_show_view_state = in_array( 'view_state', $t_fields ) && access_has_project_level( config_get( 'set_view_status_threshold' ) );\n\n# don't index bug report page\nhtml_robots_noindex();\n\nlayout_page_header( lang_get( 'report_bug_link' ) );\n\nlayout_page_begin( __FILE__ );\n\n$t_form_encoding = '';\nif( $t_show_attachments ) {\n\t$t_form_encoding = 'enctype=\"multipart/form-data\"';\n}\n?>\n<div class=\"col-md-12 col-xs-12\">\n<form id=\"report_bug_form\"\n\tmethod=\"post\" <?php echo $t_form_encoding; ?>\n\taction=\"bug_report.php?posted=1\">\n<?php echo form_security_field( 'bug_report' ) ?>\n<input type=\"hidden\" name=\"m_id\" value=\"<?php echo $f_master_bug_id ?>\" />\n<input type=\"hidden\" name=\"project_id\" value=\"<?php echo $t_project_id ?>\" />\n<div class=\"widget-box widget-color-blue2\">\n\t<div class=\"widget-header widget-header-small\">\n\t\t<h4 class=\"widget-title lighter\">\n\t\t\t\t<i class=\"ace-icon fa fa-edit\"></i>\n\t\t\t\t<?php echo lang_get( 'enter_report_details_title' ) ?>\n\t\t</h4>\n\t</div>\n<div class=\"widget-body dz-clickable\">\n<div class=\"widget-main no-padding\">\n<div class=\"table-responsive\">\n<table class=\"table table-bordered table-condensed\">\n<?php\n\tevent_signal( 'EVENT_REPORT_BUG_FORM_TOP', array( $t_project_id ) );\n\n\tif( $t_show_category ) {\n?>\n\t<tr>\n\t\t<th class=\"category\" width=\"30%\">\n\t\t\t<?php\n\t\t\techo config_get( 'allow_no_category' ) ? '' : '<span class=\"required\">*</span> ';\n\t\t\techo '<label for=\"category_id\">';\n\t\t\tprint_documentation_link( 'category' );\n\t\t\techo '</label>';\n\t\t\t?>\n\t\t</th>\n\t\t<td width=\"70%\">\n\t\t\t<?php if( $t_changed_project ) {\n\t\t\t\techo '[' . project_get_field( $t_bug->project_id, 'name' ) . '] ';\n\t\t\t} ?>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"category_id\" name=\"category_id\" class=\"autofocus input-sm\">\n\t\t\t\t<?php\n\t\t\t\t\tprint_category_option_list( $f_category_id );\n\t\t\t\t?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php }\n\n\tif( $t_show_reproducibility ) {\n?>\n\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"reproducibility\"><?php print_documentation_link( 'reproducibility' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"reproducibility\" name=\"reproducibility\" class=\"input-sm\">\n\t\t\t\t<?php print_enum_string_option_list( 'reproducibility', $f_reproducibility ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif( $t_show_eta ) {\n?>\n\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"eta\"><?php print_documentation_link( 'eta' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"eta\" name=\"eta\" class=\"input-sm\">\n\t\t\t\t<?php print_enum_string_option_list( 'eta', $f_eta ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif( $t_show_severity ) {\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"severity\"><?php print_documentation_link( 'severity' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"severity\" name=\"severity\" class=\"input-sm\">\n\t\t\t\t<?php print_enum_string_option_list( 'severity', $f_severity ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif( $t_show_priority ) {\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"priority\"><?php print_documentation_link( 'priority' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"priority\" name=\"priority\" class=\"input-sm\">\n\t\t\t\t<?php print_enum_string_option_list( 'priority', $f_priority ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif( $t_show_due_date ) {\n\t\t$t_date_to_display = '';\n\n\t\tif( !date_is_null( $f_due_date ) ) {\n\t\t\t$t_date_to_display = date( config_get( 'normal_date_format' ), $f_due_date );\n\t\t}\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"due_date\"><?php print_documentation_link( 'due_date' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<?php echo '<input ' . helper_get_tab_index() . ' type=\"text\" id=\"due_date\" name=\"due_date\" class=\"datetimepicker input-sm\" ' .\n\t\t\t\t'data-picker-locale=\"' . lang_get_current_datetime_locale() .\n\t\t\t\t'\" data-picker-format=\"' . config_get( 'datetime_picker_format' ) . '\" ' .\n\t\t\t\t'size=\"20\" maxlength=\"16\" value=\"' . $t_date_to_display . '\" />' ?>\n\t\t\t<i class=\"fa fa-calendar fa-xlg datetimepicker\"></i>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php if( $t_show_platform || $t_show_os || $t_show_os_version ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"profile_id\"><?php echo lang_get( 'select_profile' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<?php if( count( profile_get_all_for_user( auth_get_current_user_id() ) ) > 0 ) { ?>\n\t\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"profile_id\" name=\"profile_id\" class=\"input-sm\">\n\t\t\t\t\t<?php print_profile_option_list( auth_get_current_user_id(), $f_profile_id ) ?>\n\t\t\t\t</select>\n\t\t\t<?php } ?>\n\t\t\t<?php collapse_open( 'profile' ); collapse_icon( 'profile' ); ?>\n\t\t\t<?php echo lang_get( 'or_fill_in' ); ?>\n\t\t\t<table class=\"table-bordered table-condensed\">\n\t\t\t\t<tr>\n\t\t\t\t\t<th class=\"category\" width=\"30%\">\n\t\t\t\t\t\t<label for=\"platform\"><?php echo lang_get( 'platform' ) ?></label>\n\t\t\t\t\t</th>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<?php if( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) { ?>\n\t\t\t\t\t\t<select id=\"platform\" name=\"platform\" class=\"input-sm\">\n\t\t\t\t\t\t\t<option value=\"\"></option>\n\t\t\t\t\t\t\t<?php print_platform_option_list( $f_platform ); ?>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\techo '<input type=\"text\" id=\"platform\" name=\"platform\" class=\"typeahead input-sm\" autocomplete = \"off\" size=\"32\" maxlength=\"32\" tabindex=\"' . helper_get_tab_index_value() . '\" value=\"' . string_attribute( $f_platform ) . '\" />';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<th class=\"category\">\n\t\t\t\t\t\t<label for=\"os\"><?php echo lang_get( 'os' ) ?></label>\n\t\t\t\t\t</th>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<?php if( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) { ?>\n\t\t\t\t\t\t<select id=\"os\" name=\"os\" class=\"input-sm\">\n\t\t\t\t\t\t\t<option value=\"\"></option>\n\t\t\t\t\t\t\t<?php print_os_option_list( $f_os ); ?>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\techo '<input type=\"text\" id=\"os\" name=\"os\" class=\"typeahead input-sm\" autocomplete = \"off\" size=\"32\" maxlength=\"32\" tabindex=\"' . helper_get_tab_index_value() . '\" value=\"' . string_attribute( $f_os ) . '\" />';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<th class=\"category\">\n\t\t\t\t\t\t<label for=\"os_build\"><?php echo lang_get( 'os_version' ) ?></label>\n\t\t\t\t\t</th>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\tif( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) {\n\t\t\t\t\t\t?>\n\t\t\t\t\t\t<select id=\"os_build\" name=\"os_build\" class=\"input-sm\">\n\t\t\t\t\t\t\t<option value=\"\"></option>\n\t\t\t\t\t\t\t\t<?php print_os_build_option_list( $f_os_build ); ?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\techo '<input type=\"text\" id=\"os_build\" name=\"os_build\" class=\"typeahead input-sm\" autocomplete = \"off\" size=\"16\" maxlength=\"16\" tabindex=\"' . helper_get_tab_index_value() . '\" value=\"' . string_attribute( $f_os_build ) . '\" />';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t\t<?php collapse_closed( 'profile' ); collapse_icon( 'profile' ); ?>\n\t\t\t<?php echo lang_get( 'or_fill_in' ); ?>\n\t\t\t<?php collapse_end( 'profile' ); ?>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php\n\tif( $t_show_product_version ) {\n\t\t$t_product_version_released_mask = VERSION_RELEASED;\n\n\t\tif( access_has_project_level( config_get( 'report_issues_for_unreleased_versions_threshold' ) ) ) {\n\t\t\t$t_product_version_released_mask = VERSION_ALL;\n\t\t}\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"product_version\"><?php echo lang_get( 'product_version' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"product_version\" name=\"product_version\" class=\"input-sm\">\n\t\t\t\t<?php print_version_option_list( $f_product_version, $t_project_id, $t_product_version_released_mask ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n?>\n<?php if( $t_show_product_build ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"build\"><?php echo lang_get( 'product_build' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"text\" id=\"build\" name=\"build\" size=\"32\" maxlength=\"32\" value=\"<?php echo string_attribute( $f_build ) ?>\" />\n\t\t</td>\n\t</tr>\n<?php } ?>\n\n<?php if( $t_show_handler ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"handler_id\"><?php echo lang_get( 'assign_to' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"handler_id\" name=\"handler_id\" class=\"input-sm\">\n\t\t\t\t<option value=\"0\" selected=\"selected\"></option>\n\t\t\t\t<?php print_assign_to_option_list( $f_handler_id ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php } ?>\n\n<?php if( $t_show_status ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"status\"><?php echo lang_get( 'status' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"status\" class=\"input-sm\">\n\t\t\t<?php\n\t\t\t$t_resolution_options = get_status_option_list(\n\t\t\t\taccess_get_project_level( $t_project_id ),\n\t\t\t\tconfig_get( 'bug_submit_status' ),\n\t\t\t\ttrue,\n\t\t\t\tON == config_get( 'allow_reporter_close' ),\n\t\t\t\t$t_project_id );\n\t\t\tforeach ( $t_resolution_options as $t_key => $t_value ) {\n\t\t\t?>\n\t\t\t\t<option value=\"<?php echo $t_key ?>\" <?php check_selected( $t_key, config_get( 'bug_submit_status' ) ); ?> >\n\t\t\t\t\t<?php echo $t_value ?>\n\t\t\t\t</option>\n\t\t\t<?php } ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php } ?>\n\n<?php if( $t_show_resolution ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"resolution\"><?php echo lang_get( 'resolution' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"resolution\" class=\"input-sm\">\n\t\t\t\t<?php\n\t\t\t\tprint_enum_string_option_list( 'resolution', config_get( 'default_bug_resolution' ) );\n\t\t\t\t?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php } ?>\n\n<?php # Target Version (if permissions allow)\n\tif( $t_show_target_version ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"target_version\"><?php echo lang_get( 'target_version' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"target_version\" name=\"target_version\" class=\"input-sm\">\n\t\t\t\t<?php print_version_option_list( '', null, VERSION_FUTURE ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php event_signal( 'EVENT_REPORT_BUG_FORM', array( $t_project_id ) ) ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<span class=\"required\">*</span><label for=\"summary\"><?php print_documentation_link( 'summary' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"text\" id=\"summary\" name=\"summary\" size=\"105\" maxlength=\"128\" value=\"<?php echo string_attribute( $f_summary ) ?>\" required />\n\t\t</td>\n\t</tr>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<span class=\"required\">*</span><label for=\"description\"><?php print_documentation_link( 'description' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<textarea class=\"form-control\" <?php echo helper_get_tab_index() ?> id=\"description\" name=\"description\" cols=\"80\" rows=\"10\" required><?php echo string_textarea( $f_description ) ?></textarea>\n\t\t</td>\n\t</tr>\n\n<?php if( $t_show_steps_to_reproduce ) { ?>\n\t\t<tr>\n\t\t\t<th class=\"category\">\n\t\t\t\t<label for=\"steps_to_reproduce\"><?php print_documentation_link( 'steps_to_reproduce' ) ?></label>\n\t\t\t</th>\n\t\t\t<td>\n\t\t\t\t<textarea class=\"form-control\" <?php echo helper_get_tab_index() ?> id=\"steps_to_reproduce\" name=\"steps_to_reproduce\" cols=\"80\" rows=\"10\"><?php echo string_textarea( $f_steps_to_reproduce ) ?></textarea>\n\t\t\t</td>\n\t\t</tr>\n<?php } ?>\n\n<?php if( $t_show_additional_info ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"additional_info\"><?php print_documentation_link( 'additional_information' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<textarea class=\"form-control\" <?php echo helper_get_tab_index() ?> id=\"additional_info\" name=\"additional_info\" cols=\"80\" rows=\"10\"><?php echo string_textarea( $f_additional_info ) ?></textarea>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php if( $t_show_tags ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"attach_tag\"><?php echo lang_get( 'tag_attach_long' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<?php print_tag_input( '' ); ?>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\t$t_custom_fields_found = false;\n\t$t_related_custom_field_ids = custom_field_get_linked_ids( $t_project_id );\n\n\tforeach( $t_related_custom_field_ids as $t_id ) {\n\t\t$t_def = custom_field_get_definition( $t_id );\n\t\tif( ( $t_def['display_report'] || $t_def['require_report']) && custom_field_has_write_access_to_project( $t_id, $t_project_id ) ) {\n\t\t\t$t_custom_fields_found = true;\n\n\t\t\tif( $t_def['type'] != CUSTOM_FIELD_TYPE_RADIO && $t_def['type'] != CUSTOM_FIELD_TYPE_CHECKBOX ) {\n\t\t\t\t$t_label_for = 'for=\"custom_field_' . string_attribute( $t_def['id'] ) . '\" ';\n\t\t\t} else {\n\t\t\t\t$t_label_for = '';\n\t\t\t}\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<?php if( $t_def['require_report'] ) {?><span class=\"required\">*</span><?php } ?>\n\t\t\t<?php if( $t_def['type'] != CUSTOM_FIELD_TYPE_RADIO && $t_def['type'] != CUSTOM_FIELD_TYPE_CHECKBOX ) { ?>\n\t\t\t\t<label for=\"custom_field_<?php echo string_attribute( $t_def['id'] ) ?>\">\n\t\t\t\t\t<?php echo string_display( lang_get_defaulted( $t_def['name'] ) ) ?>\n\t\t\t\t</label>\n\t\t\t<?php } else { echo string_display( lang_get_defaulted( $t_def['name'] ) ); } ?>\n\t\t</th>\n\t\t<td>\n\t\t\t<?php print_custom_field_input( $t_def, ( $f_master_bug_id === 0 ) ? null : $f_master_bug_id, $t_def['require_report'] ) ?>\n\t\t</td>\n\t</tr>\n<?php\n\t\t}\n\t} # foreach( $t_related_custom_field_ids as $t_id )\n?>\n<?php\n\t# File Upload (if enabled)\n\tif( $t_show_attachments ) {\n\t\t$t_max_file_size = (int)min( ini_get_number( 'upload_max_filesize' ), ini_get_number( 'post_max_size' ), config_get( 'max_file_size' ) );\n\t\t$t_file_upload_max_num = max( 1, config_get( 'file_upload_max_num' ) );\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"ufile[]\"><?php echo lang_get( $t_file_upload_max_num == 1 ? 'upload_file' : 'upload_files' ) ?></label>\n\t\t\t<br />\n\t\t\t<?php print_max_filesize( $t_max_file_size ); ?>\n\t\t</th>\n\t\t<td>\n\t\t\t<input type=\"hidden\" name=\"max_file_size\" value=\"<?php echo $t_max_file_size ?>\" />\n\t\t\t<div class=\"dropzone center\" <?php print_dropzone_form_data() ?>>\n\t\t\t\t<i class=\"upload-icon ace-icon fa fa-cloud-upload blue fa-3x\"></i><br>\n\t\t\t\t<span class=\"bigger-150 grey\"><?php echo lang_get( 'dropzone_default_message' ) ?></span>\n\t\t\t\t<div id=\"dropzone-previews-box\" class=\"dropzone-previews dz-max-files-reached\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"fallback\">\n\t\t\t\t<div class=\"dz-message\" data-dz-message></div>\n\t\t\t<input <?php echo helper_get_tab_index() ?> id=\"ufile[]\" name=\"ufile[]\" type=\"file\" size=\"60\" />\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n\n<?php\n\t}\n\n\tif( $t_show_view_state ) {\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<?php echo lang_get( 'view_status' ) ?>\n\t\t</th>\n\t\t<td>\n\t\t\t<label>\n\t\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"radio\" class=\"ace\" name=\"view_state\" value=\"<?php echo VS_PUBLIC ?>\" <?php check_checked( $f_view_state, VS_PUBLIC ) ?> />\n\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'public' ) ?></span>\n\t\t\t</label>\n\t\t\t&#160;&#160;&#160;&#160;\n\t\t\t<label>\n\t\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"radio\" class=\"ace\" name=\"view_state\" value=\"<?php echo VS_PRIVATE ?>\" <?php check_checked( $f_view_state, VS_PRIVATE ) ?> />\n\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'private' ) ?></span>\n\t\t\t</label>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\t# Relationship (in case of cloned bug creation...)\n\tif( $f_master_bug_id > 0 ) {\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<?php echo lang_get( 'relationship_with_parent' ) ?>\n\t\t</th>\n\t\t<td>\n\t\t\t<?php relationship_list_box( config_get( 'default_bug_relationship_clone' ), \"rel_type\", false, true ) ?>\n\t\t\t<?php echo '<strong>' . lang_get( 'bug' ) . ' ' . bug_format_id( $f_master_bug_id ) . '</strong>' ?>\n\t\t</td>\n\t</tr>\n\n\t<tr>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'copy_from_parent' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<label>\n\t\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"checkbox\" class=\"ace\" id=\"copy_notes_from_parent\" name=\"copy_notes_from_parent\" <?php check_checked( $f_copy_notes_from_parent ) ?> />\n\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'copy_notes_from_parent' ) ?></span>\n\t\t\t</label>\n\t\t\t&#160;&#160;&#160;&#160;\n\t\t\t<label>\n\t\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"checkbox\" class=\"ace\" id=\"copy_attachments_from_parent\" name=\"copy_attachments_from_parent\" <?php check_checked( $f_copy_attachments_from_parent ) ?> />\n\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'copy_attachments_from_parent' ) ?></span>\n\t\t\t</label>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<?php print_documentation_link( 'report_stay' ) ?>\n\t\t</th>\n\t\t<td>\n\t\t\t<label>\n\t\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"checkbox\" class=\"ace\" id=\"report_stay\" name=\"report_stay\" <?php check_checked( $f_report_stay ) ?> />\n\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'check_report_more_bugs' ) ?></span>\n\t\t\t</label>\n\t\t</td>\n\t</tr>\n</table>\n</div>\n</div>\n<div class=\"widget-toolbox padding-8 clearfix\">\n\t<span class=\"required pull-right\"> * <?php echo lang_get( 'required' ) ?></span>\n\t<input <?php echo helper_get_tab_index() ?> type=\"submit\" class=\"btn btn-primary btn-white btn-round\" value=\"<?php echo lang_get( 'submit_report_button' ) ?>\" />\n</div>\n</div>\n</div>\n</form>\n</div>\n<?php\nlayout_page_end();\n"], "fixing_code": ["<?php\n# MantisBT - A PHP based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This page stores the reported bug\n *\n * @package MantisBT\n * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org\n * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n * @link http://www.mantisbt.org\n *\n * @uses core.php\n * @uses authentication_api.php\n * @uses constant_inc.php\n * @uses custom_field_api.php\n * @uses error_api.php\n * @uses file_api.php\n * @uses form_api.php\n * @uses gpc_api.php\n * @uses helper_api.php\n * @uses html_api.php\n * @uses lang_api.php\n * @uses print_api.php\n * @uses string_api.php\n * @uses utility_api.php\n */\n\nrequire_once( 'core.php' );\nrequire_api( 'constant_inc.php' );\nrequire_api( 'custom_field_api.php' );\nrequire_api( 'error_api.php' );\nrequire_api( 'file_api.php' );\nrequire_api( 'form_api.php' );\nrequire_api( 'gpc_api.php' );\nrequire_api( 'helper_api.php' );\nrequire_api( 'html_api.php' );\nrequire_api( 'lang_api.php' );\nrequire_api( 'print_api.php' );\nrequire_api( 'string_api.php' );\nrequire_api( 'utility_api.php' );\n\nform_security_validate( 'bug_report' );\n\n$f_master_bug_id = gpc_get_int( 'm_id', 0 );\n$f_rel_type = gpc_get_int( 'rel_type', BUG_REL_NONE );\n$f_copy_notes_from_parent = gpc_get_bool( 'copy_notes_from_parent', false );\n$f_copy_attachments_from_parent = gpc_get_bool( 'copy_attachments_from_parent', false );\n$f_report_stay = gpc_get_bool( 'report_stay', false );\n\n$t_clone_info = array(\n\t'master_issue_id' => $f_master_bug_id,\n\t'relationship_type' => $f_rel_type,\n\t'copy_notes' => $f_copy_notes_from_parent,\n\t'copy_files' => $f_copy_attachments_from_parent\n);\n\nif( $f_master_bug_id > 0 ) {\n\tbug_ensure_exists( $f_master_bug_id );\n\n\t# User can view the master bug\n\taccess_ensure_bug_level( config_get( 'view_bug_threshold' ), $f_master_bug_id );\n\n\tif( bug_is_readonly( $f_master_bug_id ) ) {\n\t\terror_parameters( $f_master_bug_id );\n\t\ttrigger_error( ERROR_BUG_READ_ONLY_ACTION_DENIED, ERROR );\n\t}\n\t$t_master_bug = bug_get( $f_master_bug_id, true );\n\t$t_project_id = $t_master_bug->project_id;\n} else {\n\t$f_project_id = gpc_get_int( 'project_id' );\n\t$t_project_id = $f_project_id;\n}\n\n$t_issue = array(\n\t'project' => array( 'id' => $t_project_id ),\n\t'reporter' => array( 'id' => auth_get_current_user_id() ),\n\t'summary' => gpc_get_string( 'summary' ),\n\t'description' => gpc_get_string( 'description' ),\n);\n\n$t_tag_string = '';\n$f_tag_select = gpc_get_int( 'tag_select', 0 );\nif( $f_tag_select != 0 ) {\n\t$t_tag_string = tag_get_name( $f_tag_select );\n}\n\n$f_tag_string = gpc_get_string( 'tag_string', '' );\nif( !is_blank( $f_tag_string ) ) {\n\t$t_tag_string = is_blank( $t_tag_string ) ? $f_tag_string : ',' . $f_tag_string;\n}\n\n$t_tags = tag_parse_string( $t_tag_string );\nif( !empty( $t_tags ) ) {\n\t$t_issue['tags'] = array();\n\tforeach( $t_tags as $t_tag ) {\n\t\t$t_issue['tags'][] = array( 'id' => $t_tag['id'] );\n\t}\n}\n\n$f_files = gpc_get_file( 'ufile', null );\nif( $f_files !== null && !empty( $f_files ) ) {\n\t$t_issue['files'] = helper_array_transpose( $f_files );\n}\n\n$t_build = gpc_get_string( 'build', '' );\nif( !is_blank( $t_build ) ) {\n\t$t_issue['build'] = $t_build;\n}\n\n$t_platform = gpc_get_string( 'platform', '' );\nif( !is_blank( $t_platform ) ) {\n\t$t_issue['platform'] = $t_platform;\n}\n\n$t_os = gpc_get_string( 'os', '' );\nif( !is_blank( $t_os ) ) {\n\t$t_issue['os'] = $t_os;\n}\n\n$t_os_build = gpc_get_string( 'os_build', '' );\nif( !is_blank( $t_os_build ) ) {\n\t$t_issue['os_build'] = $t_os_build;\n}\n\n$t_version = gpc_get_string( 'product_version', '' );\nif( !is_blank( $t_version ) ) {\n\t$t_issue['version'] = array( 'name' => $t_version );\n}\n\n$t_target_version = gpc_get_string( 'target_version', '' );\nif( !is_blank( $t_target_version ) ) {\n\t$t_issue['target_version'] = array( 'name' => $t_target_version );\n}\n\n$t_profile_id = gpc_get_int( 'profile_id', 0 );\nif( $t_profile_id != 0 ) {\n\t$t_issue['profile'] = array( 'id' => $t_profile_id );\n}\n\n$t_handler_id = gpc_get_int( 'handler_id', NO_USER );\nif( $t_handler_id != NO_USER ) {\n\t$t_issue['handler'] = array( 'id' => $t_handler_id );\n}\n\n$t_view_state = gpc_get_int( 'view_state', 0 );\nif( $t_view_state != 0 ) {\n\t$t_issue['view_state'] = array( 'id' => $t_view_state );\n}\n\n$t_category_id = gpc_get_int( 'category_id', 0 );\nif( $t_category_id != 0 ) {\n\t$t_issue['category'] = array( 'id' => $t_category_id );\n}\n\n$t_reproducibility = gpc_get_int( 'reproducibility', 0 );\nif( $t_reproducibility != 0 ) {\n\t$t_issue['reproducibility'] = array( 'id' => $t_reproducibility );\n}\n\n$t_severity = gpc_get_int( 'severity', 0 );\nif( $t_severity != 0 ) {\n\t$t_issue['severity'] = array( 'id' => $t_severity );\n}\n\n$t_priority = gpc_get_int( 'priority', 0 );\nif( $t_priority != 0 ) {\n\t$t_issue['priority'] = array( 'id' => $t_priority );\n}\n\n$t_projection = gpc_get_int( 'projection', 0 );\nif( $t_projection != 0 ) {\n\t$t_issue['projection'] = array( 'id' => $t_projection );\n}\n\n$t_eta = gpc_get_int( 'eta', 0 );\nif( $t_eta != 0 ) {\n\t$t_issue['eta'] = array( 'id' => $t_eta );\n}\n\n$t_resolution = gpc_get_int( 'resolution', 0 );\nif( $t_resolution != 0 ) {\n\t$t_issue['resolution'] = array( 'id' => $t_resolution );\n}\n\n$t_status = gpc_get_int( 'status', 0 );\nif( $t_status != 0 ) {\n\t$t_issue['status'] = array( 'id' => $t_status );\n}\n\n$t_steps_to_reproduce = gpc_get_string( 'steps_to_reproduce', null );\nif( $t_steps_to_reproduce !== null ) {\n\t$t_issue['steps_to_reproduce'] = $t_steps_to_reproduce;\n}\n\n$t_additional_info = gpc_get_string( 'additional_info', null );\nif( $t_additional_info !== null ) {\n\t$t_issue['additional_information'] = $t_additional_info;\n}\n\n$t_due_date = gpc_get_string( 'due_date', null );\nif( $t_due_date !== null ) {\n\t$t_issue['due_date'] = $t_due_date;\n}\n\n# Validate the custom fields before adding the bug.\n$t_related_custom_field_ids = custom_field_get_linked_ids( $t_project_id );\n$t_custom_fields = array();\nforeach( $t_related_custom_field_ids as $t_id ) {\n\t$t_def = custom_field_get_definition( $t_id );\n\n\t# Produce an error if the field is required but wasn't posted\n\tif( gpc_isset_custom_field( $t_id, $t_def['type'] ) ) {\n\t\t$t_custom_fields[] = array(\n\t\t\t'field' => array( 'id' => $t_id ),\n\t\t\t'value' => gpc_get_custom_field( 'custom_field_' . $t_id, $t_def['type'], null )\n\t\t);\n\t}\n}\n\nif( !empty( $t_custom_fields ) ) {\n\t$t_issue['custom_fields'] = $t_custom_fields;\n}\n\n$t_data = array(\n\t'payload' => array( 'issue' => $t_issue ),\n);\n\nif( $f_master_bug_id > 0 ) {\n\t$t_data['options'] = array( 'clone_info' => $t_clone_info );\n}\n\n$t_command = new IssueAddCommand( $t_data );\n$t_result = $t_command->execute();\n$t_issue_id = (int)$t_result['issue_id'];\n\nform_security_purge( 'bug_report' );\n\nlayout_page_header_begin();\n\nif( $f_report_stay ) {\n\t$t_fields = array(\n\t\t'category_id', 'severity', 'reproducibility', 'profile_id', 'platform',\n\t\t'os', 'os_build', 'target_version', 'build', 'view_state', 'due_date'\n\t);\n\n\t$t_issue = bug_get( $t_issue_id );\n\n\t$t_data = array();\n\tforeach( $t_fields as $t_field ) {\n\t\t$t_data[$t_field] = $t_issue->$t_field;\n\t}\n\n\t$t_data['product_version'] = $t_issue->version;\n\t$t_data['report_stay'] = 1;\n\n\t$t_report_more_bugs_url = string_get_bug_report_url() . '?' . http_build_query( $t_data );\n\n\thtml_meta_redirect( $t_report_more_bugs_url );\n} else {\n\thtml_meta_redirect( 'view_all_bug_page.php' );\n}\n\nlayout_page_header_end();\n\nlayout_page_begin( 'bug_report_page.php' );\n\n$t_buttons = array(\n\tarray( string_get_bug_view_url( $t_issue_id ), sprintf( lang_get( 'view_submitted_bug_link' ), $t_issue_id ) ),\n\tarray( 'view_all_bug_page.php', lang_get( 'view_bugs_link' ) ),\n);\n\nif( $f_report_stay ) {\n\t$t_buttons[] = array( $t_report_more_bugs_url, lang_get( 'report_more_bugs' ) );\n}\n\nhtml_operation_confirmation( $t_buttons, '', CONFIRMATION_TYPE_SUCCESS );\n\nlayout_page_end();\n", "<?php\n# MantisBT - A PHP based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This file POSTs data to report_bug.php\n *\n * @package MantisBT\n * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org\n * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n * @link http://www.mantisbt.org\n *\n * @uses core.php\n * @uses access_api.php\n * @uses authentication_api.php\n * @uses bug_api.php\n * @uses collapse_api.php\n * @uses columns_api.php\n * @uses config_api.php\n * @uses constant_inc.php\n * @uses custom_field_api.php\n * @uses date_api.php\n * @uses error_api.php\n * @uses event_api.php\n * @uses file_api.php\n * @uses form_api.php\n * @uses gpc_api.php\n * @uses helper_api.php\n * @uses html_api.php\n * @uses lang_api.php\n * @uses print_api.php\n * @uses profile_api.php\n * @uses project_api.php\n * @uses relationship_api.php\n * @uses string_api.php\n * @uses utility_api.php\n * @uses version_api.php\n */\n\n$g_allow_browser_cache = 1;\n\nrequire_once( 'core.php' );\nrequire_api( 'access_api.php' );\nrequire_api( 'authentication_api.php' );\nrequire_api( 'bug_api.php' );\nrequire_api( 'collapse_api.php' );\nrequire_api( 'columns_api.php' );\nrequire_api( 'config_api.php' );\nrequire_api( 'constant_inc.php' );\nrequire_api( 'custom_field_api.php' );\nrequire_api( 'date_api.php' );\nrequire_api( 'error_api.php' );\nrequire_api( 'event_api.php' );\nrequire_api( 'file_api.php' );\nrequire_api( 'form_api.php' );\nrequire_api( 'gpc_api.php' );\nrequire_api( 'helper_api.php' );\nrequire_api( 'html_api.php' );\nrequire_api( 'lang_api.php' );\nrequire_api( 'print_api.php' );\nrequire_api( 'profile_api.php' );\nrequire_api( 'project_api.php' );\nrequire_api( 'relationship_api.php' );\nrequire_api( 'string_api.php' );\nrequire_api( 'utility_api.php' );\nrequire_api( 'version_api.php' );\n\n$f_master_bug_id = gpc_get_int( 'm_id', 0 );\n\nif( $f_master_bug_id > 0 ) {\n\t# master bug exists...\n\tbug_ensure_exists( $f_master_bug_id );\n\n\t# master bug is not read-only...\n\tif( bug_is_readonly( $f_master_bug_id ) ) {\n\t\terror_parameters( $f_master_bug_id );\n\t\ttrigger_error( ERROR_BUG_READ_ONLY_ACTION_DENIED, ERROR );\n\t}\n\n\t# User can view the master bug\n\taccess_ensure_bug_level( config_get( 'view_bug_threshold' ), $f_master_bug_id );\n\n\t$t_bug = bug_get( $f_master_bug_id, true );\n\n\t#@@@ (thraxisp) Note that the master bug is cloned into the same project as the master, independent of\n\t#       what the current project is set to.\n\tif( $t_bug->project_id != helper_get_current_project() ) {\n\t\t# in case the current project is not the same project of the bug we are viewing...\n\t\t# ... override the current project. This to avoid problems with categories and handlers lists etc.\n\t\t$g_project_override = $t_bug->project_id;\n\t\t$t_changed_project = true;\n\t} else {\n\t\t$t_changed_project = false;\n\t}\n\n\taccess_ensure_project_level( config_get( 'report_bug_threshold' ) );\n\n\t$f_build\t\t\t\t= $t_bug->build;\n\t$f_platform\t\t\t\t= $t_bug->platform;\n\t$f_os\t\t\t\t\t= $t_bug->os;\n\t$f_os_build\t\t\t\t= $t_bug->os_build;\n\t$f_product_version\t\t= $t_bug->version;\n\t$f_target_version\t\t= $t_bug->target_version;\n\t$f_profile_id\t\t\t= 0;\n\t$f_handler_id\t\t\t= $t_bug->handler_id;\n\n\t$f_category_id\t\t\t= $t_bug->category_id;\n\t$f_reproducibility\t\t= $t_bug->reproducibility;\n\t$f_eta\t\t\t\t\t= $t_bug->eta;\n\t$f_severity\t\t\t\t= $t_bug->severity;\n\t$f_priority\t\t\t\t= $t_bug->priority;\n\t$f_summary\t\t\t\t= $t_bug->summary;\n\t$f_description\t\t\t= $t_bug->description;\n\t$f_steps_to_reproduce\t= $t_bug->steps_to_reproduce;\n\t$f_additional_info\t\t= $t_bug->additional_information;\n\t$f_view_state\t\t\t= (int)$t_bug->view_state;\n\t$f_due_date\t\t\t\t= $t_bug->due_date;\n\n\t$t_project_id\t\t\t= $t_bug->project_id;\n} else {\n\t# Get Project Id and set it as current\n\t$t_current_project = helper_get_current_project();\n\t$t_project_id = gpc_get_int( 'project_id', $t_current_project );\n\n\t# If all projects, use default project if set\n\t$t_default_project = user_pref_get_pref( auth_get_current_user_id(), 'default_project' );\n\tif( ALL_PROJECTS == $t_project_id && ALL_PROJECTS != $t_default_project ) {\n\t\t$t_project_id = $t_default_project;\n\t}\n\n\tif( ( ALL_PROJECTS == $t_project_id || project_exists( $t_project_id ) )\n\t\t&& $t_project_id != $t_current_project\n\t\t&& project_enabled( $t_project_id ) ) {\n\t\thelper_set_current_project( $t_project_id );\n\t\t# Reloading the page is required so that the project browser\n\t\t# reflects the new current project\n\t\tprint_header_redirect( $_SERVER['REQUEST_URI'], true, false, true );\n\t}\n\n\t# New issues cannot be reported for the 'All Project' selection\n\tif( ALL_PROJECTS == $t_current_project ) {\n\t\tprint_header_redirect( 'login_select_proj_page.php?ref=bug_report_page.php' );\n\t}\n\n\t# Check for bug report threshold\n\tif( !access_has_project_level( config_get( 'report_bug_threshold' ) ) ) {\n\t\t# If can't report on current project, show project selector if there is any other allowed project\n\t\taccess_ensure_any_project_level( 'report_bug_threshold' );\n\t\tprint_header_redirect( 'login_select_proj_page.php?ref=bug_report_page.php' );\n\t}\n\taccess_ensure_project_level( config_get( 'report_bug_threshold' ) );\n\n\t$f_build\t\t\t\t= gpc_get_string( 'build', '' );\n\t$f_platform\t\t\t\t= gpc_get_string( 'platform', '' );\n\t$f_os\t\t\t\t\t= gpc_get_string( 'os', '' );\n\t$f_os_build\t\t\t\t= gpc_get_string( 'os_build', '' );\n\t$f_product_version\t\t= gpc_get_string( 'product_version', '' );\n\t$f_target_version\t\t= gpc_get_string( 'target_version', '' );\n\t$f_profile_id\t\t\t= gpc_get_int( 'profile_id', 0 );\n\t$f_handler_id\t\t\t= gpc_get_int( 'handler_id', 0 );\n\n\t$f_category_id\t\t\t= gpc_get_int( 'category_id', 0 );\n\t$f_reproducibility\t\t= gpc_get_int( 'reproducibility', (int)config_get( 'default_bug_reproducibility' ) );\n\t$f_eta\t\t\t\t\t= gpc_get_int( 'eta', (int)config_get( 'default_bug_eta' ) );\n\t$f_severity\t\t\t\t= gpc_get_int( 'severity', (int)config_get( 'default_bug_severity' ) );\n\t$f_priority\t\t\t\t= gpc_get_int( 'priority', (int)config_get( 'default_bug_priority' ) );\n\t$f_summary\t\t\t\t= gpc_get_string( 'summary', '' );\n\t$f_description\t\t\t= gpc_get_string( 'description', config_get( 'default_bug_description' ) );\n\t$f_steps_to_reproduce\t= gpc_get_string( 'steps_to_reproduce', config_get( 'default_bug_steps_to_reproduce' ) );\n\t$f_additional_info\t\t= gpc_get_string( 'additional_info', config_get( 'default_bug_additional_info' ) );\n\t$f_view_state\t\t\t= gpc_get_int( 'view_state', (int)config_get( 'default_bug_view_status' ) );\n\t$f_due_date\t\t\t\t= gpc_get_string( 'due_date', date_strtotime( config_get( 'due_date_default' ) ) );\n\n\tif( $f_due_date == '' ) {\n\t\t$f_due_date = date_get_null();\n\t}\n\n\t$t_changed_project\t\t= false;\n}\n\n$f_report_stay\t\t\t= gpc_get_bool( 'report_stay', false );\n$f_copy_notes_from_parent         = gpc_get_bool( 'copy_notes_from_parent', false );\n$f_copy_attachments_from_parent   = gpc_get_bool( 'copy_attachments_from_parent', false );\n\n$t_fields = config_get( 'bug_report_page_fields' );\n$t_fields = columns_filter_disabled( $t_fields );\n\n$t_show_category = in_array( 'category_id', $t_fields );\n$t_show_reproducibility = in_array( 'reproducibility', $t_fields );\n$t_show_eta = in_array( 'eta', $t_fields );\n$t_show_severity = in_array( 'severity', $t_fields );\n$t_show_priority = in_array( 'priority', $t_fields );\n$t_show_steps_to_reproduce = in_array( 'steps_to_reproduce', $t_fields );\n$t_show_handler = in_array( 'handler', $t_fields ) && access_has_project_level( config_get( 'update_bug_assign_threshold' ) );\n$t_show_profiles = config_get( 'enable_profiles' );\n$t_show_platform = $t_show_profiles && in_array( 'platform', $t_fields );\n$t_show_os = $t_show_profiles && in_array( 'os', $t_fields );\n$t_show_os_version = $t_show_profiles && in_array( 'os_version', $t_fields );\n$t_show_resolution = in_array( 'resolution', $t_fields );\n$t_show_status = in_array( 'status', $t_fields );\n$t_show_tags =\n\tin_array( 'tags', $t_fields ) &&\n\taccess_has_project_level(\n\t\tconfig_get( 'tag_attach_threshold', /* default */ null, /* user */ null, $t_project_id ),\n\t\t$t_project_id );\n\n$t_show_versions = version_should_show_product_version( $t_project_id );\n$t_show_product_version = $t_show_versions && in_array( 'product_version', $t_fields );\n$t_show_product_build = $t_show_versions && in_array( 'product_build', $t_fields ) && config_get( 'enable_product_build' ) == ON;\n$t_show_target_version = $t_show_versions && in_array( 'target_version', $t_fields ) && access_has_project_level( config_get( 'roadmap_update_threshold' ) );\n$t_show_additional_info = in_array( 'additional_info', $t_fields );\n$t_show_due_date = in_array( 'due_date', $t_fields ) && access_has_project_level( config_get( 'due_date_update_threshold' ), helper_get_current_project(), auth_get_current_user_id() );\n$t_show_attachments = in_array( 'attachments', $t_fields ) && file_allow_bug_upload();\n$t_show_view_state = in_array( 'view_state', $t_fields ) && access_has_project_level( config_get( 'set_view_status_threshold' ) );\n\n# don't index bug report page\nhtml_robots_noindex();\n\nlayout_page_header( lang_get( 'report_bug_link' ) );\n\nlayout_page_begin( __FILE__ );\n\n$t_form_encoding = '';\nif( $t_show_attachments ) {\n\t$t_form_encoding = 'enctype=\"multipart/form-data\"';\n}\n?>\n<div class=\"col-md-12 col-xs-12\">\n<form id=\"report_bug_form\"\n\tmethod=\"post\" <?php echo $t_form_encoding; ?>\n\taction=\"bug_report.php?posted=1\">\n<?php echo form_security_field( 'bug_report' ) ?>\n<input type=\"hidden\" name=\"m_id\" value=\"<?php echo $f_master_bug_id ?>\" />\n<input type=\"hidden\" name=\"project_id\" value=\"<?php echo $t_project_id ?>\" />\n<div class=\"widget-box widget-color-blue2\">\n\t<div class=\"widget-header widget-header-small\">\n\t\t<h4 class=\"widget-title lighter\">\n\t\t\t\t<i class=\"ace-icon fa fa-edit\"></i>\n\t\t\t\t<?php echo lang_get( 'enter_report_details_title' ) ?>\n\t\t</h4>\n\t</div>\n<div class=\"widget-body dz-clickable\">\n<div class=\"widget-main no-padding\">\n<div class=\"table-responsive\">\n<table class=\"table table-bordered table-condensed\">\n<?php\n\tevent_signal( 'EVENT_REPORT_BUG_FORM_TOP', array( $t_project_id ) );\n\n\tif( $t_show_category ) {\n?>\n\t<tr>\n\t\t<th class=\"category\" width=\"30%\">\n\t\t\t<?php\n\t\t\techo config_get( 'allow_no_category' ) ? '' : '<span class=\"required\">*</span> ';\n\t\t\techo '<label for=\"category_id\">';\n\t\t\tprint_documentation_link( 'category' );\n\t\t\techo '</label>';\n\t\t\t?>\n\t\t</th>\n\t\t<td width=\"70%\">\n\t\t\t<?php if( $t_changed_project ) {\n\t\t\t\techo '[' . project_get_field( $t_bug->project_id, 'name' ) . '] ';\n\t\t\t} ?>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"category_id\" name=\"category_id\" class=\"autofocus input-sm\">\n\t\t\t\t<?php\n\t\t\t\t\tprint_category_option_list( $f_category_id );\n\t\t\t\t?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php }\n\n\tif( $t_show_reproducibility ) {\n?>\n\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"reproducibility\"><?php print_documentation_link( 'reproducibility' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"reproducibility\" name=\"reproducibility\" class=\"input-sm\">\n\t\t\t\t<?php print_enum_string_option_list( 'reproducibility', $f_reproducibility ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif( $t_show_eta ) {\n?>\n\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"eta\"><?php print_documentation_link( 'eta' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"eta\" name=\"eta\" class=\"input-sm\">\n\t\t\t\t<?php print_enum_string_option_list( 'eta', $f_eta ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif( $t_show_severity ) {\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"severity\"><?php print_documentation_link( 'severity' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"severity\" name=\"severity\" class=\"input-sm\">\n\t\t\t\t<?php print_enum_string_option_list( 'severity', $f_severity ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif( $t_show_priority ) {\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"priority\"><?php print_documentation_link( 'priority' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"priority\" name=\"priority\" class=\"input-sm\">\n\t\t\t\t<?php print_enum_string_option_list( 'priority', $f_priority ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\tif( $t_show_due_date ) {\n\t\t$t_date_to_display = '';\n\n\t\tif( !date_is_null( $f_due_date ) ) {\n\t\t\t$t_date_to_display = date( config_get( 'normal_date_format' ), $f_due_date );\n\t\t}\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"due_date\"><?php print_documentation_link( 'due_date' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<?php echo '<input ' . helper_get_tab_index() . ' type=\"text\" id=\"due_date\" name=\"due_date\" class=\"datetimepicker input-sm\" ' .\n\t\t\t\t'data-picker-locale=\"' . lang_get_current_datetime_locale() .\n\t\t\t\t'\" data-picker-format=\"' . config_get( 'datetime_picker_format' ) . '\" ' .\n\t\t\t\t'size=\"20\" maxlength=\"16\" value=\"' . $t_date_to_display . '\" />' ?>\n\t\t\t<i class=\"fa fa-calendar fa-xlg datetimepicker\"></i>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php if( $t_show_platform || $t_show_os || $t_show_os_version ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"profile_id\"><?php echo lang_get( 'select_profile' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<?php if( count( profile_get_all_for_user( auth_get_current_user_id() ) ) > 0 ) { ?>\n\t\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"profile_id\" name=\"profile_id\" class=\"input-sm\">\n\t\t\t\t\t<?php print_profile_option_list( auth_get_current_user_id(), $f_profile_id ) ?>\n\t\t\t\t</select>\n\t\t\t<?php } ?>\n\t\t\t<?php collapse_open( 'profile' ); collapse_icon( 'profile' ); ?>\n\t\t\t<?php echo lang_get( 'or_fill_in' ); ?>\n\t\t\t<table class=\"table-bordered table-condensed\">\n\t\t\t\t<tr>\n\t\t\t\t\t<th class=\"category\" width=\"30%\">\n\t\t\t\t\t\t<label for=\"platform\"><?php echo lang_get( 'platform' ) ?></label>\n\t\t\t\t\t</th>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<?php if( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) { ?>\n\t\t\t\t\t\t<select id=\"platform\" name=\"platform\" class=\"input-sm\">\n\t\t\t\t\t\t\t<option value=\"\"></option>\n\t\t\t\t\t\t\t<?php print_platform_option_list( $f_platform ); ?>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\techo '<input type=\"text\" id=\"platform\" name=\"platform\" class=\"typeahead input-sm\" autocomplete = \"off\" size=\"32\" maxlength=\"32\" tabindex=\"' . helper_get_tab_index_value() . '\" value=\"' . string_attribute( $f_platform ) . '\" />';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<th class=\"category\">\n\t\t\t\t\t\t<label for=\"os\"><?php echo lang_get( 'os' ) ?></label>\n\t\t\t\t\t</th>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<?php if( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) { ?>\n\t\t\t\t\t\t<select id=\"os\" name=\"os\" class=\"input-sm\">\n\t\t\t\t\t\t\t<option value=\"\"></option>\n\t\t\t\t\t\t\t<?php print_os_option_list( $f_os ); ?>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\techo '<input type=\"text\" id=\"os\" name=\"os\" class=\"typeahead input-sm\" autocomplete = \"off\" size=\"32\" maxlength=\"32\" tabindex=\"' . helper_get_tab_index_value() . '\" value=\"' . string_attribute( $f_os ) . '\" />';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<th class=\"category\">\n\t\t\t\t\t\t<label for=\"os_build\"><?php echo lang_get( 'os_version' ) ?></label>\n\t\t\t\t\t</th>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\tif( config_get( 'allow_freetext_in_profile_fields' ) == OFF ) {\n\t\t\t\t\t\t?>\n\t\t\t\t\t\t<select id=\"os_build\" name=\"os_build\" class=\"input-sm\">\n\t\t\t\t\t\t\t<option value=\"\"></option>\n\t\t\t\t\t\t\t\t<?php print_os_build_option_list( $f_os_build ); ?>\n\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\techo '<input type=\"text\" id=\"os_build\" name=\"os_build\" class=\"typeahead input-sm\" autocomplete = \"off\" size=\"16\" maxlength=\"16\" tabindex=\"' . helper_get_tab_index_value() . '\" value=\"' . string_attribute( $f_os_build ) . '\" />';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t?>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t\t<?php collapse_closed( 'profile' ); collapse_icon( 'profile' ); ?>\n\t\t\t<?php echo lang_get( 'or_fill_in' ); ?>\n\t\t\t<?php collapse_end( 'profile' ); ?>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php\n\tif( $t_show_product_version ) {\n\t\t$t_product_version_released_mask = VERSION_RELEASED;\n\n\t\tif( access_has_project_level( config_get( 'report_issues_for_unreleased_versions_threshold' ) ) ) {\n\t\t\t$t_product_version_released_mask = VERSION_ALL;\n\t\t}\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"product_version\"><?php echo lang_get( 'product_version' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"product_version\" name=\"product_version\" class=\"input-sm\">\n\t\t\t\t<?php print_version_option_list( $f_product_version, $t_project_id, $t_product_version_released_mask ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n?>\n<?php if( $t_show_product_build ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"build\"><?php echo lang_get( 'product_build' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"text\" id=\"build\" name=\"build\" size=\"32\" maxlength=\"32\" value=\"<?php echo string_attribute( $f_build ) ?>\" />\n\t\t</td>\n\t</tr>\n<?php } ?>\n\n<?php if( $t_show_handler ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"handler_id\"><?php echo lang_get( 'assign_to' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"handler_id\" name=\"handler_id\" class=\"input-sm\">\n\t\t\t\t<option value=\"0\" selected=\"selected\"></option>\n\t\t\t\t<?php print_assign_to_option_list( $f_handler_id ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php } ?>\n\n<?php if( $t_show_status ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"status\"><?php echo lang_get( 'status' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"status\" class=\"input-sm\">\n\t\t\t<?php\n\t\t\t$t_resolution_options = get_status_option_list(\n\t\t\t\taccess_get_project_level( $t_project_id ),\n\t\t\t\tconfig_get( 'bug_submit_status' ),\n\t\t\t\ttrue,\n\t\t\t\tON == config_get( 'allow_reporter_close' ),\n\t\t\t\t$t_project_id );\n\t\t\tforeach ( $t_resolution_options as $t_key => $t_value ) {\n\t\t\t?>\n\t\t\t\t<option value=\"<?php echo $t_key ?>\" <?php check_selected( $t_key, config_get( 'bug_submit_status' ) ); ?> >\n\t\t\t\t\t<?php echo $t_value ?>\n\t\t\t\t</option>\n\t\t\t<?php } ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php } ?>\n\n<?php if( $t_show_resolution ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"resolution\"><?php echo lang_get( 'resolution' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> name=\"resolution\" class=\"input-sm\">\n\t\t\t\t<?php\n\t\t\t\tprint_enum_string_option_list( 'resolution', config_get( 'default_bug_resolution' ) );\n\t\t\t\t?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php } ?>\n\n<?php # Target Version (if permissions allow)\n\tif( $t_show_target_version ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"target_version\"><?php echo lang_get( 'target_version' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<select <?php echo helper_get_tab_index() ?> id=\"target_version\" name=\"target_version\" class=\"input-sm\">\n\t\t\t\t<?php print_version_option_list( '', null, VERSION_FUTURE ) ?>\n\t\t\t</select>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php event_signal( 'EVENT_REPORT_BUG_FORM', array( $t_project_id ) ) ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<span class=\"required\">*</span><label for=\"summary\"><?php print_documentation_link( 'summary' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"text\" id=\"summary\" name=\"summary\" size=\"105\" maxlength=\"128\" value=\"<?php echo string_attribute( $f_summary ) ?>\" required />\n\t\t</td>\n\t</tr>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<span class=\"required\">*</span><label for=\"description\"><?php print_documentation_link( 'description' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<textarea class=\"form-control\" <?php echo helper_get_tab_index() ?> id=\"description\" name=\"description\" cols=\"80\" rows=\"10\" required><?php echo string_textarea( $f_description ) ?></textarea>\n\t\t</td>\n\t</tr>\n\n<?php if( $t_show_steps_to_reproduce ) { ?>\n\t\t<tr>\n\t\t\t<th class=\"category\">\n\t\t\t\t<label for=\"steps_to_reproduce\"><?php print_documentation_link( 'steps_to_reproduce' ) ?></label>\n\t\t\t</th>\n\t\t\t<td>\n\t\t\t\t<textarea class=\"form-control\" <?php echo helper_get_tab_index() ?> id=\"steps_to_reproduce\" name=\"steps_to_reproduce\" cols=\"80\" rows=\"10\"><?php echo string_textarea( $f_steps_to_reproduce ) ?></textarea>\n\t\t\t</td>\n\t\t</tr>\n<?php } ?>\n\n<?php if( $t_show_additional_info ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"additional_info\"><?php print_documentation_link( 'additional_information' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<textarea class=\"form-control\" <?php echo helper_get_tab_index() ?> id=\"additional_info\" name=\"additional_info\" cols=\"80\" rows=\"10\"><?php echo string_textarea( $f_additional_info ) ?></textarea>\n\t\t</td>\n\t</tr>\n<?php } ?>\n<?php if( $t_show_tags ) { ?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"attach_tag\"><?php echo lang_get( 'tag_attach_long' ) ?></label>\n\t\t</th>\n\t\t<td>\n\t\t\t<?php print_tag_input( '' ); ?>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\t$t_custom_fields_found = false;\n\t$t_related_custom_field_ids = custom_field_get_linked_ids( $t_project_id );\n\n\tforeach( $t_related_custom_field_ids as $t_id ) {\n\t\t$t_def = custom_field_get_definition( $t_id );\n\t\tif( ( $t_def['display_report'] || $t_def['require_report']) && custom_field_has_write_access_to_project( $t_id, $t_project_id ) ) {\n\t\t\t$t_custom_fields_found = true;\n\n\t\t\tif( $t_def['type'] != CUSTOM_FIELD_TYPE_RADIO && $t_def['type'] != CUSTOM_FIELD_TYPE_CHECKBOX ) {\n\t\t\t\t$t_label_for = 'for=\"custom_field_' . string_attribute( $t_def['id'] ) . '\" ';\n\t\t\t} else {\n\t\t\t\t$t_label_for = '';\n\t\t\t}\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<?php if( $t_def['require_report'] ) {?><span class=\"required\">*</span><?php } ?>\n\t\t\t<?php if( $t_def['type'] != CUSTOM_FIELD_TYPE_RADIO && $t_def['type'] != CUSTOM_FIELD_TYPE_CHECKBOX ) { ?>\n\t\t\t\t<label for=\"custom_field_<?php echo string_attribute( $t_def['id'] ) ?>\">\n\t\t\t\t\t<?php echo string_display( lang_get_defaulted( $t_def['name'] ) ) ?>\n\t\t\t\t</label>\n\t\t\t<?php } else { echo string_display( lang_get_defaulted( $t_def['name'] ) ); } ?>\n\t\t</th>\n\t\t<td>\n\t\t\t<?php print_custom_field_input( $t_def, ( $f_master_bug_id === 0 ) ? null : $f_master_bug_id, $t_def['require_report'] ) ?>\n\t\t</td>\n\t</tr>\n<?php\n\t\t}\n\t} # foreach( $t_related_custom_field_ids as $t_id )\n?>\n<?php\n\t# File Upload (if enabled)\n\tif( $t_show_attachments ) {\n\t\t$t_max_file_size = (int)min( ini_get_number( 'upload_max_filesize' ), ini_get_number( 'post_max_size' ), config_get( 'max_file_size' ) );\n\t\t$t_file_upload_max_num = max( 1, config_get( 'file_upload_max_num' ) );\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<label for=\"ufile[]\"><?php echo lang_get( $t_file_upload_max_num == 1 ? 'upload_file' : 'upload_files' ) ?></label>\n\t\t\t<br />\n\t\t\t<?php print_max_filesize( $t_max_file_size ); ?>\n\t\t</th>\n\t\t<td>\n\t\t\t<input type=\"hidden\" name=\"max_file_size\" value=\"<?php echo $t_max_file_size ?>\" />\n\t\t\t<div class=\"dropzone center\" <?php print_dropzone_form_data() ?>>\n\t\t\t\t<i class=\"upload-icon ace-icon fa fa-cloud-upload blue fa-3x\"></i><br>\n\t\t\t\t<span class=\"bigger-150 grey\"><?php echo lang_get( 'dropzone_default_message' ) ?></span>\n\t\t\t\t<div id=\"dropzone-previews-box\" class=\"dropzone-previews dz-max-files-reached\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"fallback\">\n\t\t\t\t<div class=\"dz-message\" data-dz-message></div>\n\t\t\t<input <?php echo helper_get_tab_index() ?> id=\"ufile[]\" name=\"ufile[]\" type=\"file\" size=\"60\" />\n\t\t\t</div>\n\t\t</td>\n\t</tr>\n\n<?php\n\t}\n\n\tif( $t_show_view_state ) {\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<?php echo lang_get( 'view_status' ) ?>\n\t\t</th>\n\t\t<td>\n\t\t\t<label>\n\t\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"radio\" class=\"ace\" name=\"view_state\" value=\"<?php echo VS_PUBLIC ?>\" <?php check_checked( $f_view_state, VS_PUBLIC ) ?> />\n\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'public' ) ?></span>\n\t\t\t</label>\n\t\t\t&#160;&#160;&#160;&#160;\n\t\t\t<label>\n\t\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"radio\" class=\"ace\" name=\"view_state\" value=\"<?php echo VS_PRIVATE ?>\" <?php check_checked( $f_view_state, VS_PRIVATE ) ?> />\n\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'private' ) ?></span>\n\t\t\t</label>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n\n\t# Relationship (in case of cloned bug creation...)\n\tif( $f_master_bug_id > 0 ) {\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<?php echo lang_get( 'relationship_with_parent' ) ?>\n\t\t</th>\n\t\t<td>\n\t\t\t<?php relationship_list_box( config_get( 'default_bug_relationship_clone' ), \"rel_type\", false, true ) ?>\n\t\t\t<?php echo '<strong>' . lang_get( 'bug' ) . ' ' . bug_format_id( $f_master_bug_id ) . '</strong>' ?>\n\t\t</td>\n\t</tr>\n\n\t<tr>\n\t\t<td class=\"category\">\n\t\t\t<?php echo lang_get( 'copy_from_parent' ) ?>\n\t\t</td>\n\t\t<td>\n\t\t\t<label>\n\t\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"checkbox\" class=\"ace\" id=\"copy_notes_from_parent\" name=\"copy_notes_from_parent\" <?php check_checked( $f_copy_notes_from_parent ) ?> />\n\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'copy_notes_from_parent' ) ?></span>\n\t\t\t</label>\n\t\t\t&#160;&#160;&#160;&#160;\n\t\t\t<label>\n\t\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"checkbox\" class=\"ace\" id=\"copy_attachments_from_parent\" name=\"copy_attachments_from_parent\" <?php check_checked( $f_copy_attachments_from_parent ) ?> />\n\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'copy_attachments_from_parent' ) ?></span>\n\t\t\t</label>\n\t\t</td>\n\t</tr>\n<?php\n\t}\n?>\n\t<tr>\n\t\t<th class=\"category\">\n\t\t\t<?php print_documentation_link( 'report_stay' ) ?>\n\t\t</th>\n\t\t<td>\n\t\t\t<label>\n\t\t\t\t<input <?php echo helper_get_tab_index() ?> type=\"checkbox\" class=\"ace\" id=\"report_stay\" name=\"report_stay\" <?php check_checked( $f_report_stay ) ?> />\n\t\t\t\t<span class=\"lbl padding-6\"><?php echo lang_get( 'check_report_more_bugs' ) ?></span>\n\t\t\t</label>\n\t\t</td>\n\t</tr>\n</table>\n</div>\n</div>\n<div class=\"widget-toolbox padding-8 clearfix\">\n\t<span class=\"required pull-right\"> * <?php echo lang_get( 'required' ) ?></span>\n\t<input <?php echo helper_get_tab_index() ?> type=\"submit\" class=\"btn btn-primary btn-white btn-round\" value=\"<?php echo lang_get( 'submit_report_button' ) ?>\" />\n</div>\n</div>\n</div>\n</form>\n</div>\n<?php\nlayout_page_end();\n"], "filenames": ["bug_report.php", "bug_report_page.php"], "buggy_code_start_loc": [71, 90], "buggy_code_end_loc": [71, 90], "fixing_code_start_loc": [72, 91], "fixing_code_end_loc": [76, 94], "type": "CWE-20", "message": "An issue was discovered in MantisBT through 1.3.14, and 2.0.0. Using a crafted request on bug_report_page.php (modifying the 'm_id' parameter), any user with REPORTER access or above is able to view any private issue's details (summary, description, steps to reproduce, additional information) when cloning it. By checking the 'Copy issue notes' and 'Copy attachments' checkboxes and completing the clone operation, this data also becomes public (except private notes).", "other": {"cve": {"id": "CVE-2018-9839", "sourceIdentifier": "cve@mitre.org", "published": "2019-06-06T19:29:00.297", "lastModified": "2019-06-09T18:57:15.233", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "An issue was discovered in MantisBT through 1.3.14, and 2.0.0. Using a crafted request on bug_report_page.php (modifying the 'm_id' parameter), any user with REPORTER access or above is able to view any private issue's details (summary, description, steps to reproduce, additional information) when cloning it. By checking the 'Copy issue notes' and 'Copy attachments' checkboxes and completing the clone operation, this data also becomes public (except private notes)."}, {"lang": "es", "value": "Se descubri\u00f3 un problema en MantisBT a trav\u00e9s de 1.3.14 y 2.0.0. Al usar una solicitud dise\u00f1ada en bug_report_page.php (modificando el par\u00e1metro 'm_id'), cualquier usuario con acceso a REPORTER o superior puede ver los detalles de cualquier problema privado (resumen, descripci\u00f3n, pasos para reproducir, informaci\u00f3n adicional) al clonarlo. Al marcar las casillas de verificaci\u00f3n 'Copiar notas de emisi\u00f3n' y 'Copiar adjuntos' y completar la operaci\u00f3n de clonaci\u00f3n, estos datos tambi\u00e9n se vuelven p\u00fablicos (excepto las notas privadas)."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-20"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.3.14", "matchCriteriaId": "7F88B279-DEC2-47DA-ADBB-509EB0AB2431"}, {"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:2.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "B537D8BB-944B-4B92-B48D-0CA5A2D01372"}]}]}], "references": [{"url": "https://github.com/mantisbt/mantisbt/commit/1fbcd9bca2f2c77cb61624d36ddee4b3802c38ea", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://mantisbt.org/bugs/view.php?id=24221", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/mantisbt/mantisbt/commit/1fbcd9bca2f2c77cb61624d36ddee4b3802c38ea"}}