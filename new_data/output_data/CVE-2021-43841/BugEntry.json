{"buggy_code": ["/*\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n */\npackage com.xpn.xwiki.web;\n\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collections;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\n\nimport javax.servlet.http.HttpServletResponse;\n\nimport org.apache.commons.io.IOUtils;\nimport org.apache.commons.io.input.BoundedInputStream;\nimport org.apache.commons.lang3.StringUtils;\nimport org.apache.commons.lang3.math.NumberUtils;\nimport org.apache.commons.lang3.tuple.ImmutablePair;\nimport org.apache.commons.lang3.tuple.Pair;\nimport org.xwiki.configuration.ConfigurationSource;\nimport org.xwiki.context.Execution;\nimport org.xwiki.context.ExecutionContext;\nimport org.xwiki.model.EntityType;\nimport org.xwiki.model.reference.DocumentReference;\nimport org.xwiki.model.reference.EntityReference;\nimport org.xwiki.resource.ResourceReference;\nimport org.xwiki.resource.ResourceReferenceManager;\nimport org.xwiki.resource.entity.EntityResourceReference;\nimport org.xwiki.stability.Unstable;\n\nimport com.xpn.xwiki.XWiki;\nimport com.xpn.xwiki.XWikiContext;\nimport com.xpn.xwiki.XWikiException;\nimport com.xpn.xwiki.doc.XWikiAttachment;\nimport com.xpn.xwiki.doc.XWikiDocument;\nimport com.xpn.xwiki.plugin.XWikiPluginManager;\nimport com.xpn.xwiki.util.Util;\n\n/**\n * The action for downloading attachments from the server.\n *\n * @version $Id$\n */\npublic class DownloadAction extends XWikiAction\n{\n    /** The identifier of the download action. */\n    public static final String ACTION_NAME = \"download\";\n\n    /** The identifier of the attachment disposition. */\n    public static final String ATTACHMENT = \"attachment\";\n\n    /** List of authorized attachment mimetypes. */\n    public static final List<String> MIMETYPE_WHITELIST =\n        Arrays.asList(\"audio/basic\", \"audio/L24\", \"audio/mp4\", \"audio/mpeg\", \"audio/ogg\", \"audio/vorbis\",\n            \"audio/vnd.rn-realaudio\", \"audio/vnd.wave\", \"audio/webm\", \"image/gif\", \"image/jpeg\", \"image/pjpeg\",\n            \"image/png\", \"image/svg+xml\", \"image/tiff\", \"text/csv\", \"text/plain\", \"text/xml\", \"text/rtf\", \"video/mpeg\",\n            \"video/ogg\", \"video/quicktime\", \"video/webm\", \"video/x-matroska\", \"video/x-ms-wmv\", \"video/x-flv\");\n\n    /** Key of the whitelist in xwiki.properties. */\n    public static final String WHITELIST_PROPERTY = \"attachment.download.whitelist\";\n\n    /** Key of the blacklist in xwiki.properties. */\n    public static final String BLACKLIST_PROPERTY = \"attachment.download.blacklist\";\n\n    /**\n     * Key of the forceDownload list in xwiki.properties.\n     * @since 12.10\n     */\n    @Unstable\n    public static final String FORCE_DOWNLOAD_PROPERTY = \"attachment.download.forceDownload\";\n\n    /** The URL part separator. */\n    private static final String SEPARATOR = \"/\";\n\n    /** The name of the HTTP Header that signals a byte-range request. */\n    private static final String RANGE_HEADER_NAME = \"Range\";\n\n    /** The format of a valid range header. */\n    private static final Pattern RANGE_HEADER_PATTERN = Pattern.compile(\"bytes=([0-9]+)?-([0-9]+)?\");\n\n    /**\n     * Default constructor.\n     */\n    public DownloadAction()\n    {\n        this.handleRedirectObject = true;\n    }\n\n    @Override\n    public String render(XWikiContext context) throws XWikiException\n    {\n        XWikiRequest request = context.getRequest();\n        XWikiResponse response = context.getResponse();\n\n        XWikiDocument doc = context.getDoc();\n        String filename = getFileName();\n        XWikiAttachment attachment = getAttachment(request, doc, filename);\n\n        Map<String, Object> backwardCompatibilityContextObjects = null;\n\n        if (attachment == null) {\n            // If some plugins extend the Download URL format for the Standard Scheme the document in the context will\n            // most likely not have a reference that corresponds to what the plugin expects. For example imagine that\n            // the URL is a Zip Explorer URL like .../download/space/page/attachment/index.html. This will be parsed\n            // as space.page.attachment@index.html by the Standard URL scheme parsers. Thus the attachment won't be\n            // found since index.html is not the correct attachment for the Zip Explorer plugin's URL format.\n            //\n            // Thus in order to preserve backward compatibility for existing plugins that have custom URL formats\n            // extending the Download URL format, we parse again the URL by considering that it doesn't contain any\n            // Nested Space. This also means that those plugins will need to completely reparse the URL if they wish to\n            // support Nested Spaces.\n            //\n            // Also note that this code below is not compatible with the notion of having several URL schemes. The real\n            // fix will be to not allow plugins to support custom URL formats and instead to have them register new\n            // Actions if they need a different URL format.\n            Pair<XWikiDocument, XWikiAttachment> result =\n                extractAttachmentAndDocumentFromURLWithoutSupportingNestedSpaces(request, context);\n\n            if (result == null) {\n                throwNotFoundException(filename);\n            }\n\n            XWikiDocument backwardCompatibilityDocument = result.getLeft();\n            attachment = result.getRight();\n\n            // Set the new doc as the context doc so that plugins see it as the context doc\n            backwardCompatibilityContextObjects = new HashMap<>();\n            pushDocumentInContext(backwardCompatibilityContextObjects,\n                backwardCompatibilityDocument.getDocumentReference());\n        }\n\n        try {\n            XWikiPluginManager plugins = context.getWiki().getPluginManager();\n            attachment = plugins.downloadAttachment(attachment, context);\n\n            if (attachment == null) {\n                throwNotFoundException(filename);\n            }\n\n            // Try to load the attachment content just to make sure that the attachment really exists\n            // This will throw an exception if the attachment content isn't available\n            try {\n                attachment.getContentLongSize(context);\n            } catch (XWikiException e) {\n                Object[] args = { filename };\n                throw new XWikiException(XWikiException.MODULE_XWIKI_APP,\n                    XWikiException.ERROR_XWIKI_APP_ATTACHMENT_NOT_FOUND, \"Attachment content {0} not found\", null,\n                    args);\n            }\n\n            long lastModifiedOnClient = request.getDateHeader(\"If-Modified-Since\");\n            long lastModifiedOnServer = attachment.getDate().getTime();\n            if (lastModifiedOnClient != -1 && lastModifiedOnClient >= lastModifiedOnServer) {\n                response.setStatus(HttpServletResponse.SC_NOT_MODIFIED);\n                return null;\n            }\n\n            // Sending the content of the attachment\n            if (request.getHeader(RANGE_HEADER_NAME) != null) {\n                try {\n                    if (sendPartialContent(attachment, request, response, context)) {\n                        return null;\n                    }\n                } catch (IOException ex) {\n                    // Broken response...\n                }\n            }\n            sendContent(attachment, request, response, context);\n            return null;\n        } finally {\n            if (backwardCompatibilityContextObjects != null) {\n                popDocumentFromContext(backwardCompatibilityContextObjects);\n            }\n        }\n    }\n\n    private void throwNotFoundException(String filename) throws XWikiException\n    {\n        String message =\n            filename == null ? \"Attachment not found\" : String.format(\"Attachment [%s] not found\", filename);\n        throw new XWikiException(XWikiException.MODULE_XWIKI_APP, XWikiException.ERROR_XWIKI_APP_ATTACHMENT_NOT_FOUND,\n            message);\n    }\n\n    /**\n     * Respond to a range request, either with the requested bytes, or with a {@code 416 REQUESTED RANGE NOT\n     * SATISFIABLE} response if the requested byte range falls outside the length of the attachment. If the range\n     * request header is syntactically invalid, nothing is written, and instead {@code false} is returned, letting the\n     * action handler ignore the Range header and treat this as a normal (full) download request.\n     *\n     * @param attachment the attachment to get content from\n     * @param request the current client request\n     * @param response the response to write to.\n     * @param context the current request context\n     * @return {@code true} if the partial content request was syntactically valid and a response was sent,\n     *         {@code false} otherwise\n     * @throws XWikiException if the attachment content cannot be retrieved\n     * @throws IOException if the response cannot be written\n     */\n    private boolean sendPartialContent(final XWikiAttachment attachment, final XWikiRequest request,\n        final XWikiResponse response, final XWikiContext context) throws XWikiException, IOException\n    {\n        String range = request.getHeader(RANGE_HEADER_NAME);\n        Matcher m = RANGE_HEADER_PATTERN.matcher(range);\n        if (m.matches()) {\n            String startStr = m.group(1);\n            String endStr = m.group(2);\n            Long start = NumberUtils.createLong(startStr);\n            Long end = NumberUtils.createLong(endStr);\n            if (start == null && end != null && end > 0) {\n                // Tail request, output the last <end> bytes\n                start = Math.max(attachment.getContentLongSize(context) - end, 0L);\n                end = attachment.getContentLongSize(context) - 1L;\n            }\n            if (!isValidRange(start, end)) {\n                return false;\n            }\n            if (end == null) {\n                end = attachment.getContentLongSize(context) - 1L;\n            }\n            end = Math.min(end, attachment.getContentLongSize(context) - 1L);\n            writeByteRange(attachment, start, end, request, response, context);\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Write a byte range from the attachment to the response, if the requested range is valid and falls within the file\n     * limits.\n     *\n     * @param attachment the attachment to get content from\n     * @param start the first byte to write\n     * @param end the last byte to write\n     * @param request the current client request\n     * @param response the response to write to.\n     * @param context the current request context\n     * @throws XWikiException if the attachment content cannot be retrieved\n     * @throws IOException if the response cannot be written\n     */\n    private void writeByteRange(final XWikiAttachment attachment, Long start, Long end, final XWikiRequest request,\n        final XWikiResponse response, final XWikiContext context) throws XWikiException, IOException\n    {\n        if (start >= 0 && start < attachment.getContentLongSize(context)) {\n            InputStream data = attachment.getContentInputStream(context);\n            data = new BoundedInputStream(data, end + 1);\n            data.skip(start);\n            setCommonHeaders(attachment, request, response, context);\n            response.setStatus(HttpServletResponse.SC_PARTIAL_CONTENT);\n            if ((end - start + 1L) < Integer.MAX_VALUE) {\n                setContentLength(response, end - start + 1);\n            }\n            response.setHeader(\"Content-Range\",\n                \"bytes \" + start + \"-\" + end + SEPARATOR + attachment.getContentLongSize(context));\n            IOUtils.copyLarge(data, response.getOutputStream());\n        } else {\n            response.setStatus(HttpServletResponse.SC_REQUESTED_RANGE_NOT_SATISFIABLE);\n        }\n    }\n\n    /**\n     * Send the attachment content in the response.\n     *\n     * @param attachment the attachment to get content from\n     * @param request the current client request\n     * @param response the response to write to.\n     * @param context the XWikiContext just in case it is needed to load the attachment content\n     * @throws XWikiException if something goes wrong\n     */\n    protected void sendContent(final XWikiAttachment attachment, final XWikiRequest request,\n        final XWikiResponse response, final XWikiContext context) throws XWikiException\n    {\n        InputStream stream = null;\n        try {\n            setCommonHeaders(attachment, request, response, context);\n            setContentLength(response, attachment.getContentLongSize(context));\n            stream = attachment.getContentInputStream(context);\n            IOUtils.copy(stream, response.getOutputStream());\n        } catch (IOException e) {\n            throw new XWikiException(XWikiException.MODULE_XWIKI_APP,\n                XWikiException.ERROR_XWIKI_APP_SEND_RESPONSE_EXCEPTION, \"Exception while sending response\", e);\n        } finally {\n            if (stream != null) {\n                IOUtils.closeQuietly(stream);\n            }\n        }\n    }\n\n    /**\n     * @return the filename of the attachment or null if the URL didn't point to an attachment\n     */\n    private String getFileName()\n    {\n        // Extract the Attachment file name from the parsed request URL that was done before this Action is called\n        ResourceReference resourceReference = Utils.getComponent(ResourceReferenceManager.class).getResourceReference();\n        EntityResourceReference entityResource = (EntityResourceReference) resourceReference;\n\n        // Try to extract the attachment from the reference but it's possible that the URL didn't point to an\n        // attachment, in which case we return null.\n        EntityReference attachmentReference =\n            entityResource.getEntityReference().extractReference(EntityType.ATTACHMENT);\n\n        return attachmentReference == null ? null : attachmentReference.getName();\n    }\n\n    private Pair<XWikiDocument, XWikiAttachment> extractAttachmentAndDocumentFromURLWithoutSupportingNestedSpaces(\n        XWikiRequest request, XWikiContext context)\n    {\n        String path = request.getRequestURI();\n\n        // Extract the path part after the action, e.g. \"/space/page/attachment/path1/path2\" when you have\n        // \".../download/space/page/attachment/path1/path2\".\n        int pos = path.indexOf(SEPARATOR + ACTION_NAME);\n        String subPath = path.substring(pos + (SEPARATOR + ACTION_NAME).length() + 1);\n\n        List<String> segments = new ArrayList<>();\n        for (String pathSegment : subPath.split(SEPARATOR, -1)) {\n            segments.add(Util.decodeURI(pathSegment, context));\n        }\n\n        // We need at least 3 segments\n        if (segments.size() < 3) {\n            return null;\n        }\n\n        String spaceName = segments.get(0);\n        String pageName = segments.get(1);\n        String attachmentName = segments.get(2);\n\n        // Generate the XWikiDocument and try to load it (if the user has permission to it)\n        DocumentReference reference = new DocumentReference(context.getWikiId(), spaceName, pageName);\n        XWiki xwiki = context.getWiki();\n\n        XWikiDocument backwardCompatibilityDocument;\n        try {\n            backwardCompatibilityDocument = xwiki.getDocument(reference, context);\n            if (!backwardCompatibilityDocument.isNew()) {\n                if (!context.getWiki().checkAccess(context.getAction(), backwardCompatibilityDocument, context)) {\n                    // No permission to access the document, consider that the attachment doesn't exist\n                    return null;\n                }\n            } else {\n                // Document doesn't exist\n                return null;\n            }\n        } catch (XWikiException e) {\n            // An error happened when getting the doc or checking the permission, consider that the attachment\n            // doesn't exist\n            return null;\n        }\n\n        // Look for the attachment and return it\n        XWikiAttachment attachment = getAttachment(request, backwardCompatibilityDocument, attachmentName);\n\n        return new ImmutablePair<>(backwardCompatibilityDocument, attachment);\n    }\n\n    private void pushDocumentInContext(Map<String, Object> backupObjects, DocumentReference documentReference)\n        throws XWikiException\n    {\n        XWikiContext xcontext = getContext();\n\n        // Backup current context state\n        XWikiDocument.backupContext(backupObjects, xcontext);\n\n        // Make sure to get the current XWikiContext after ExcutionContext clone\n        xcontext = getContext();\n\n        // Change context document\n        xcontext.getWiki().getDocument(documentReference, xcontext).setAsContextDoc(xcontext);\n    }\n\n    private void popDocumentFromContext(Map<String, Object> backupObjects)\n    {\n        XWikiDocument.restoreContext(backupObjects, getContext());\n    }\n\n    private XWikiContext getContext()\n    {\n        Execution execution = Utils.getComponent(Execution.class);\n        ExecutionContext econtext = execution.getContext();\n        return econtext != null ? (XWikiContext) econtext.getProperty(\"xwikicontext\") : null;\n    }\n\n    private XWikiAttachment getAttachment(XWikiRequest request, XWikiDocument document, String filename)\n    {\n        XWikiAttachment attachment = null;\n\n        String idStr = request.getParameter(\"id\");\n        if (StringUtils.isNumeric(idStr)) {\n            int id = Integer.parseInt(idStr);\n            if (document.getAttachmentList().size() > id) {\n                attachment = document.getAttachmentList().get(id);\n            }\n        } else {\n            attachment = document.getAttachment(filename);\n        }\n\n        return attachment;\n    }\n\n    /**\n     * Set the response HTTP headers common to both partial (Range) and full responses.\n     *\n     * @param attachment the attachment to get content from\n     * @param request the current client request\n     * @param response the response to write to.\n     * @param context the current request context\n     */\n    private void setCommonHeaders(final XWikiAttachment attachment, final XWikiRequest request,\n        final XWikiResponse response, final XWikiContext context)\n    {\n        // Choose the right content type\n        String mimetype = attachment.getMimeType(context);\n        response.setContentType(mimetype);\n\n        // Set the character encoding\n        String characterEncoding = attachment.getCharset();\n        if (characterEncoding != null) {\n            response.setCharacterEncoding(characterEncoding);\n        }\n\n        String ofilename = Util.encodeURI(attachment.getFilename(), context).replaceAll(\"\\\\+\", \"%20\");\n\n        // The inline attribute of Content-Disposition tells the browser that they should display\n        // the downloaded file in the page (see http://www.ietf.org/rfc/rfc1806.txt for more\n        // details). We do this so that JPG, GIF, PNG, etc are displayed without prompting a Save\n        // dialog box. However, all mime types that cannot be displayed by the browser do prompt a\n        // Save dialog box (exe, zip, xar, etc).\n        String dispType = \"inline\";\n\n        // Determine whether the user who attached the file has Programming Rights or not.\n        boolean hasPR = false;\n        String author = attachment.getAuthor();\n        try {\n            hasPR = context.getWiki().getRightService().hasAccessLevel(\"programming\", author, \"XWiki.XWikiPreferences\",\n                context);\n        } catch (Exception e) {\n            hasPR = false;\n        }\n        // If the mimetype is not authorized to be displayed inline, let's force its content disposition to download.\n        if (shouldBeDownloaded(hasPR, request, mimetype)) {\n            dispType = ATTACHMENT;\n        }\n        // Use RFC 2231 for encoding filenames, since the normal HTTP headers only allows ASCII characters.\n        // See http://tools.ietf.org/html/rfc2231 for more details.\n        response.addHeader(\"Content-disposition\", dispType + \"; filename*=utf-8''\" + ofilename);\n\n        response.setDateHeader(\"Last-Modified\", attachment.getDate().getTime());\n        // Advertise that downloads can be resumed\n        response.setHeader(\"Accept-Ranges\", \"bytes\");\n    }\n\n    /**\n     * Check if the specified byte range first and last bytes form a syntactically valid range. For a range to be valid,\n     * at least one of the ends must be specified, and if both are present, the range end must be greater than the range\n     * start.\n     *\n     * @param start the requested range start, i.e. the first byte to be transfered, or {@code null} if missing from the\n     *            Range header\n     * @param end the requested range end, i.e. the last byte to be transfered, or {@code null} if missing from the\n     *            Range header\n     * @return {@code true} if the range is valid, {@code false} otherwise\n     */\n    private boolean isValidRange(Long start, Long end)\n    {\n        if (start == null && end == null) {\n            return false;\n        }\n        return start == null || end == null || end >= start;\n    }\n\n    /**\n     * Check if an attachment should be downloaded or can be displayed inline.\n     * Attachments should be downloaded if:\n     * <ul>\n     *     <li>the request contains a force-download parameter with the value 1</li>\n     *     <li>or the mimetype is part of the forceDownload property list</li>\n     *     <li>or no custom whitelist exists and a custom blacklist exists and contains the mimetype and the attachment\n     *     has not been added by a user with programming rights</li>\n     *     <li>or the whitelist (default or custom) does not contains the mimetype and the attachment has not been added\n     *     by a user with programming rights</li>\n     * </ul>\n     *\n     * Note that in the case of the request does not contain a force-downloaded parameter with the value 1 and the\n     * mimetype is not part of the forceDownload property list, but the attachment has been added by a user with\n     * programming right, then the attachment is always displayed inline.\n     *\n     * @param hasPR a boolean indicating if the attachment has been added by someone with programming rights.\n     * @param request the current download request.\n     * @param mimeType the mimetype of the attachment.\n     * @return {@code true} if the attachment should be downloaded, and {@code false} if it can be displayed inline.\n     */\n    private boolean shouldBeDownloaded(boolean hasPR, XWikiRequest request, String mimeType)\n    {\n        boolean result;\n        ConfigurationSource configuration = Utils.getComponent(ConfigurationSource.class, \"xwikiproperties\");\n\n        boolean whiteListExists = configuration.containsKey(WHITELIST_PROPERTY);\n        boolean blackListExists = configuration.containsKey(BLACKLIST_PROPERTY);\n        List<String> blackList = configuration.getProperty(BLACKLIST_PROPERTY, Collections.emptyList());\n        List<String> whiteList = configuration.getProperty(WHITELIST_PROPERTY, MIMETYPE_WHITELIST);\n        List<String> forceDownloadList = configuration.getProperty(FORCE_DOWNLOAD_PROPERTY, Collections.emptyList());\n\n        if (\"1\".equals(request.getParameter(\"force-download\")) || forceDownloadList.contains(mimeType)) {\n            result = true;\n        } else if (hasPR) {\n            result = false;\n        } else if (blackListExists && !whiteListExists) {\n            result = blackList.contains(mimeType);\n        } else {\n            result = !whiteList.contains(mimeType);\n        }\n\n        return result;\n    }\n}\n", "# ---------------------------------------------------------------------------\n# See the NOTICE file distributed with this work for additional\n# information regarding copyright ownership.\n#\n# This is free software; you can redistribute it and/or modify it\n# under the terms of the GNU Lesser General Public License as\n# published by the Free Software Foundation; either version 2.1 of\n# the License, or (at your option) any later version.\n#\n# This software is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n# Lesser General Public License for more details.\n#\n# You should have received a copy of the GNU Lesser General Public\n# License along with this software; if not, write to the Free\n# Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n# 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n# ---------------------------------------------------------------------------\n\n# This is the new XWiki configuration file. In the future it'll replace the old\n# xwiki.cfg file. However right now it's only used by some XWiki components.\n# As time progresses more and more component will get their configurations from\n# this file.\n# \n# This file come from one of those locations (in this order):\n# * [since 9.3] /etc/xwiki/xwiki.properties\n# * /WEB-INF/xwiki.properties in the web application resources\n\n#-------------------------------------------------------------------------------------\n# Core\n#-------------------------------------------------------------------------------------\n\n#-# [Since 1.8RC2]\n#-# Specifies the default syntax to use when creating new documents.\n#-# Default value is xwiki/2.1.\n# core.defaultDocumentSyntax = xwiki/2.1\n\n#-# [Since 2.4M1]\n#-# Indicate if the rendering cache is enabled.\n#-# Default value is false.\n# core.renderingcache.enabled = true\n\n#-# [Since 2.4M1]\n#-# A list of Java regex patterns matching full documents reference.\n# core.renderingcache.documents = wiki:Space\\.Page\n# core.renderingcache.documents = wiki:Space\\..*\n# core.renderingcache.documents = Space\\.PageOnWhateverWiki\n\n#-# [Since 2.4M1]\n#-# The time (in seconds) after which data should be removed from the cache when not used.\n#-# Default value is 300 (5 min).\n# core.renderingcache.duration = 300\n\n#-# [Since 2.4M1]\n#-# The size of the rendering cache. Not that it's not the number of cached documents but the number of cached results.\n#-# (For a single document several cache entries are created, because each action, language and request query string\n#-# produces a unique rendering result)\n#-# Default value is 100.\n# core.renderingcache.size = 100\n\n#-# [Since 7.2M2]\n#-# Define which hierarchy is used between pages (for example inside the breadcrumb).\n#-# Possible values are \"reference\" (default) or \"parentchild\".\n#-# If \"parentchild\" is used, the hierachy is based on the parent/child relationship, which means that any document\n#-# could be defined as the parent of an other document.\n#-# If \"reference\" is used, then the children of a document must be placed inside this document. It's less flexible but\n#-# more clear.\n# core.hierarchyMode = reference\n\n#-------------------------------------------------------------------------------------\n# Environment\n#-------------------------------------------------------------------------------------\n\n#-# [Since 3.5M1, replaces the container.persistentDirectory property]\n#-# The directory used to store persistent data (data that should persist across server restarts). This is an\n#-# important directory containing important data and thus it should never be deleted (it should be backed-up along\n#-# with the database).\n#-# For example this is where the Extension Manager stores downloaded extensions if the extension.localRepository\n#-# property isn't configured.\n#-#\n#-# You can set:\n#-# * an absolute path (recommended)\n#-# * a relative path (not recommended at all)but in this case the directory will be relative to where the XWiki server\n#-#   is started and thus the user under which XWiki is started will need write permissions for the current directory\n#-#\n#-# Note if the system property xwiki.data.dir is set then this property is not used.\n#-# If neither the system property nor this configuration value here are set then the Servlet container's temporary\n#-# directory is used; This is absolutely not recommended since that directory could be wiped out at any time and you\n#-# should specify a value.\n#if ($xwikiPropertiesEnvironmentPermanentDirectory)\nenvironment.permanentDirectory = $xwikiPropertiesEnvironmentPermanentDirectory\n#else\n# environment.permanentDirectory = /var/lib/xwiki/data/\n#end\n\n#-------------------------------------------------------------------------------------\n# Rendering\n#-------------------------------------------------------------------------------------\n\n#-# [Since 1.8RC2]\n#-# Specifies how links labels are displayed when the user doesn't specify the label explicitly.\n#-# Valid values:\n#-#   %w: wiki name\n#-#   %s: full space name (e.g. space1.space2)\n#-#       Note: Prior to 7.4.2/8.0M2 this was only displaying the last space name\n#-#   %ls: last space name. New in 7.4.2/8.0M2\n#-#   %p: page name\n#-#   %np: nested page name (i.e. will display the space name for Nested Pages). New in 7.4.2/8.0M2\n#-#   %P: page name with spaces between camel case words, i.e. \"My Page\" if the page name is \"MyPage\"\n#-#   %NP: nested page name with spaces between camel case words, i.e. \"My Page\" if the page name is \"MyPage\".\n#-#        New in 7.4.2/8.0M2\n#-#   %t: page title\n#-#\n#-# Note that if the page title is empty or not defined then it defaults to %np. This is also the case\n#-# if the title cannot be retrieved for the document.\n#-#\n#-# The default is \"%np\". Some examples: \"%s.%p\", \"%w:%s.%p\".\n# rendering.linkLabelFormat = %np\n\n#-# [Since 2.0M3]\n#-# Overrides default macro categories (Each macro has a default category already defined, for example\n#-# \"presentation\" for the Table of Contents Macro).\n#-#\n#-# Ex: To redefine the macro category for the TOC macro so that it'd be in the \"My Category\" category +\n#-# redefine the category for the Script Macro to be \"My Other Category\", you'd use:\n# rendering.macroCategories = toc:My Category\n# rendering.macroCategories = script:My Other Category\n\n#-# [Since 2.5M2]\n#-# Specify whether the image dimensions should be extracted from the image parameters and included in the image URL\n#-# or not. When image dimensions are included in the image URL the image can be resized on the server side before being\n#-# downloaded, improving thus the page loading speed.\n#-#\n#-# Default value is true.\n# rendering.imageDimensionsIncludedInImageURL = true\n\n#-# [Since 2.5M2]\n#-# One way to improve page load speed is to resize images on the server side just before rendering the page. The\n#-# rendering module can use the image width provided by the user to scale the image (See\n#-# rendering.includeImageDimensionsInImageURL configuration parameter). When the user doesn't specify the image width\n#-# the rendering module can limit the width of the image based on this configuration parameter.\n#-#\n#-# The default value is -1 which means image width is not limited by default. Use a value greater than 0 to limit the\n#-# image width (pixels). Note that the aspect ratio is kept even when both the width and the height of the image are\n#-# limited.\n# rendering.imageWidthLimit = 1024\n# rendering.imageWidthLimit = -1\n\n#-# [Since 2.5M2]\n#-# See rendering.imageWidthLimit\n# rendering.imageHeightLimit = 768\n# rendering.imageHeightLimit = -1\n\n#-# [Since 2.5M2]\n#-# InterWiki definitions in the format alias = URL\n#-# See http://en.wikipedia.org/wiki/Interwiki_links for a definition of an InterWiki link\n# Some examples:\n# rendering.interWikiDefinitions = wikipedia = http://en.wikipedia.org/wiki/\n# rendering.interWikiDefinitions = definition = http://www.yourdictionary.com/\n\n#-# [Since 2.4M1]\n#-# Change the Pygments style used in the code macro (see http://pygments.org/docs/styles/)\n#-# If not set \"default\" style is used.\n# rendering.macro.code.pygments.style = vs\n\n#-------------------------------------------------------------------------------------\n# Rendering Transformations\n#-------------------------------------------------------------------------------------\n\n#-# [Since 2.6RC1]\n#-# Controls what transformations will be executed when rendering content.\n#-# A transformation modifies the parsed content. For example the Icon transformation replaces some characters with\n#-# icons, a WikiWord transformation will automatically create links when it finds wiki words, etc.\n#-# Note that the Macro transformation is a special transformation that replaces macro markers by the result of the\n#-# macro execution. If you don't list it, macros won't get executed.\n#-# The default value is: macro, icon\n#if ($xwikiRenderingTransformations)\nrendering.transformations = $xwikiRenderingTransformations\n#else\n# rendering.transformations = macro, icon\n#end\n\n#-# [Since 2.6RC1]\n#-# Icon Transformation Configuration\n#-# Defines mappings between suite of characters and the icon to display when those characters are found.\n#-# The format is: rendering.transformation.icon.mappings = <suite of characters> = <icon name>\n#-# The following mappings are already predefined and you don't need to redefine them unless you wish to override them\n#-# [Since 9.3RC1/8.4.5] To disable a default mapping, define it with an empty value. For example:\n#-#   rendering.transformation.icon.mappings = (n) =\n#-#\n#-# rendering.transformation.icon.mappings = :) = emoticon_smile\n#-# rendering.transformation.icon.mappings = :( = emoticon_unhappy\n#-# rendering.transformation.icon.mappings = :P = emoticon_tongue\n#-# rendering.transformation.icon.mappings = :D = emoticon_grin\n#-# rendering.transformation.icon.mappings = ;) = emoticon_wink\n#-# rendering.transformation.icon.mappings = (y) = thumb_up\n#-# rendering.transformation.icon.mappings = (n) = thumb_down\n#-# rendering.transformation.icon.mappings = (i) = information\n#-# rendering.transformation.icon.mappings = (/) = accept\n#-# rendering.transformation.icon.mappings = (x) = cancel\n#-# rendering.transformation.icon.mappings = (!) = error\n#-# rendering.transformation.icon.mappings = (+) = add\n#-# rendering.transformation.icon.mappings = (-) = delete\n#-# rendering.transformation.icon.mappings = (?) = help\n#-# rendering.transformation.icon.mappings = (on) = lightbulb\n#-# rendering.transformation.icon.mappings = (off) = lightbulb_off\n#-# rendering.transformation.icon.mappings = (*) = star\n\n#-------------------------------------------------------------------------------------\n# LinkChecker Transformation\n#-------------------------------------------------------------------------------------\n\n#-# [Since 3.3M2]\n#-# Defines the time (in ms) after which an external link should be checked again for validity.\n#-# the default configuration is:\n# rendering.transformation.linkchecker.timeout = 3600000\n\n#-# [Since 5.3RC1]\n#-# List of document references that are excluded from link checking, specified using regexes.\n#-# the default configuration is:\n# rendering.transformation.linkchecker.excludedReferencePatterns = .*:XWiki\\.ExternalLinksJSON\n\n#-------------------------------------------------------------------------------------\n# Rendering Macros\n#-------------------------------------------------------------------------------------\n\n#-# Velocity Macro\n\n#-# [Since 2.0M1]\n#-# Defines which Velocity Filter to use by default. This offers the possibility to filter the Velocity macro content\n#-# before and after the Velocity Engine execution.\n#-# The following filters are available:\n#-# - indent (the default): Remove all first whites spaces of lines to support source code indentation without\n#-#          generating whitespaces in the resulting XDOM.\n#-# - none: Doesn't change the content\n#-# - html: Removes all leading and trailing white spaces and new lines. If you need a space you'll need to use\n#-#         \\$sp and if you need a new line you'll need to use \\$nl\n#-# rendering.macro.velocity.filter = indent\n\n#-------------------------------------------------------------------------------------\n# Cache\n#-------------------------------------------------------------------------------------\n\n#-# [Since 1.7M1]\n#-# The standard cache component implementation to use (can be local or distributed depending on the implementation).\n#-# The default standard cache implementation is Infinispan.\n# cache.defaultCache = infinispan\n\n#-# [Since 1.7M1]\n#-# The local cache implementation to use.\n#-# The default local cache implementation is Infinispan.\n# cache.defaultLocalCache = infinispan/local\n\n#-------------------------------------------------------------------------------------\n# Settings for the OpenOffice server instance consumed by the OfficeImporter component\n#-------------------------------------------------------------------------------------\n\n#-# [Since 1.9M2]\n#-# Type of the openoffice server instance used by officeimporter component.\n#-# 0 - Internally managed server instance. (Default)\n#-# 1 - Externally managed (local) server instance.\n# openoffice.serverType = 0\n\n#-# [Since 12.1RC1]\n#-# Port numbers used for connecting to the openoffice server instance.\n#-# For an internally managed server instance, it will create the process for all ports.\n#-# For an externally managed server instance, only the first server port is taken into account.\n# openoffice.serverPorts = 8100,8101\n\n#-# [Since 1.9M2]\n#-# If the openoffice server should be started / connected upon XE start.\n#-# Default value is false\n# openoffice.autoStart = false\n\n#-# [Since 1.8RC3]\n#-# Path to openoffice installation (serverType:0 only).\n#-# If no path is provided, a default value will be calculated based on the operating environment.\n# openoffice.homePath = /opt/openoffice.org3/\n\n#-# [Since 1.8RC3]\n#-# Path to openoffice execution profile (serverType:0 only).\n#-# If no path is provided, a default value will be calculated based on the operating environment.\n# openoffice.profilePath = /home/user/.openoffice.org/3\n\n#-# [Since 1.8RC3]\n#-# Maximum number of simultaneous conversion tasks to be handled by a single openoffice process (serverType:0 only).\n#-# Default value is 50\n# openoffice.maxTasksPerProcess = 50\n\n#-# [Since 1.8RC3]\n#-# Timeout for conversion tasks (in milliseconds) (serverType:0 only).\n#-# Default value is 60 seconds\n# openoffice.taskExecutionTimeout = 60000\n\n#-------------------------------------------------------------------------------------\n# Velocity\n#-------------------------------------------------------------------------------------\n\n#-# [Since 2.0M1]\n#-# Velocity Tools that will be available from your scripts. The format is\n#-# velocity.tools = <name under which it'll be available in the context> = <class name>\n#-# Default values (no need to add them)\n#-#   velocity.tools = numbertool = org.xwiki.velocity.internal.XWikiNumberTool\n#-#   velocity.tools = datetool = org.xwiki.velocity.internal.XWikiDateTool\n#-#   velocity.tools = mathtool = org.xwiki.velocity.internal.XWikiMathTool\n#-#   velocity.tools = escapetool = org.apache.velocity.tools.generic.EscapeTool\n#-#   velocity.tools = regextool = org.xwiki.velocity.tools.RegexTool\n#-#   velocity.tools = collectiontool = org.xwiki.velocity.tools.CollectionTool\n#-#   velocity.tools = stringtool = org.xwiki.text.StringUtils\n#-#   velocity.tools = jsontool = org.xwiki.velocity.tools.JSONTool\n#-#   velocity.tools = urltool = org.xwiki.velocity.tools.URLTool\n#-#   velocity.tools = exceptiontool = org.apache.commons.lang3.exception.ExceptionUtils\n#-#   velocity.tools = niotool = org.xwiki.velocity.tools.nio.NIOTool\n#-#   velocity.tools = logtool = org.apache.velocity.tools.generic.LogTool\n#-#   velocity.tools = objecttool = org.xwiki.velocity.tools.ObjectTool\n#-#   velocity.tools = listtool = org.apache.velocity.tools.generic.ListTool (deprecated)\n#-#   velocity.tools = sorttool = org.apache.velocity.tools.generic.SortTool (deprecated)\n#-#   velocity.tools = collectionstool = org.xwiki.velocity.tools.CollectionsTool (deprecated)\n\n#-# [Since 2.0M1]\n#-# Velocity configuration properties. The format is\n#-# velocity.properties = <Velocity property name> = <value>\n#-# Default values (no need to add them)\n#-#   velocity.properties = resource.loader = xwiki\n#-#   velocity.properties = xwiki.resource.loader.class = org.xwiki.velocity.XWikiWebappResourceLoader\n#-#   velocity.properties = velocimacro.library = \"/templates/macros.vm\"\n#-#   velocity.properties = velocimacro.max_depth = 100\n#-#   velocity.properties = resource.manager.log_when_found = false\n#-#   velocity.properties = velocimacro.inline.local_scope = true\n#-#   velocity.properties = velocimacro.inline.replace_global = true\n#-#   velocity.properties = directive.if.empty_check = false\n#-#   velocity.properties = parser.space_gobbling = bc\n#-#   velocity.properties = parser.allow_hyphen_in_identifiers = true\n#-#   velocity.properties = velocimacro.enable_bc_mode = true\n#-#   velocity.properties = context.scope_control.template = true\n#-#   velocity.properties = context.scope_control.macro = true\n#-#   velocity.properties = event_handler.include.class = org.xwiki.velocity.internal.util.RestrictParseLocationEventHandler\n#-#   velocity.properties = runtime.introspection.uberspect = org.xwiki.velocity.introspection.SecureUberspector\\,org.apache.velocity.util.introspection.DeprecatedCheckUberspector\\,org.xwiki.velocity.introspection.MethodArgumentsUberspector\n\n#-------------------------------------------------------------------------------------\n# Groovy\n#-------------------------------------------------------------------------------------\n\n#-# [Since 4.1M1]\n#-# Allows to specify Compiler customization for the Groovy execution engine.\n#-# There's no customizers defined by default. Available customizer ids:\n#-# - timedinterrupt: interrupt script execution if it takes longer than a given time (default to 1 minute)\n#-# - secure: runs Groovy in a security sandbox\n#-# groovy.compilationCustomizers = <list of customizer ids here>\n\n#-# Timed Interrupt Customizer\n\n#-# [Since 4.1M1]\n#-# Default execution time for a script before a timeout occurs, in seconds.\n#-# groovy.customizer.timedInterrupt.timeout = 60\n\n#-------------------------------------------------------------------------------------\n# Events distribution\n#-------------------------------------------------------------------------------------\n\n#-# [Since 2.0M3]\n#-# Indicate if the network distribution module is enabled or not.\n#-# By default remote events are disabled.\n# observation.remote.enabled = false\n\n#-# [Since 2.0M3]\n#-# The list of events communication channels to start when the application starts.\n#-# By default no channel is configured.\n#-#\n#-# The default remote event distribution implementation is using JGroups and you'll need to either use embedded\n#-# JGroups configuration files or drop your custom configuration in the WEB-INF/observation/remote/jgroups/ directory.\n#-# There's a README file in that directory with more information.\n#-# Example: observation.remote.channels = public, cluster\n\n#-# [Since 2.0M4]\n#-# The implementation of network adapter to use.\n#-# The default is jgroups.\n#-#\n#-# By default only jgroups is provided. To add one implements NetworkAdaptor component interface. The identifier\n#-# provided in the configuration is matched with the component role hint.\n#-# Example: observation.remote.networkadapter = jgroups\n\n#-------------------------------------------------------------------------------------\n# CSRF token component\n#-------------------------------------------------------------------------------------\n\n#-# [Since 2.5M2]\n#-# Controls whether secret token validation mechanism should be used (to prevent CSRF attacks).\n#-#\n#-# If enabled, all actions requiring \"comment\", \"edit\", \"delete\", \"admin\" or \"programming\" rights\n#-# will check that the parameter \"form_token\" with the value of a random secret token is present\n#-# in the request.\n#-#\n#-# Valid values:\n#-#   true : Enabled\n#-#   false: Disabled\n#-#\n#-# Default value is true\n# csrf.enabled = true\n\n#-------------------------------------------------------------------------------------\n# Jobs\n#-------------------------------------------------------------------------------------\n\n#-# [Since 4.0M1]\n#-# The folder containing job executing status.\n#-# The default is {environment.permanentDirectory}/jobs/\n# job.statusFolder = /var/lib/xwiki/data/jobs/\n\n#-# [Since 7.2M2]\n#-# The maximum number of entries to put in the job status cache.\n#-# The default is 50.\n# job.statusCacheSize = 50\n\n#-# [Since 12.5RC1]\n#-# The maximum number of entries to put in cache for the GroupedJobInitializer components.\n#-# The default is 100.\n# job.groupedJobInitializerCacheSize = 100\n\n#-# [Since 12.5RC1]\n#-# The thread keep-alive time in milliseconds for the single job executor.\n#-# This value defines how long a thread can be idle before being terminated by the executor.\n#-# The default value is 60000 for 60 000ms.\n# job.singleJobThreadKeepAliveTime = 60000\n\n#-# [Since 12.5RC1]\n#-# The thread keep-alive time in milliseconds for the grouped job executors.\n#-# This value defines how long a thread can be idle before being terminated by an executor.\n#-# The default value is 60000 for 60 000ms.\n# job.groupedJobThreadKeepAliveTime = 60000\n\n#-------------------------------------------------------------------------------------\n# Extension Manager\n#-------------------------------------------------------------------------------------\n\n#-# [Since 2.5]\n#-# Repositories to use when searching and downloading extensions.\n#-# Repositories will be checked in the same order they have in this configuration file.\n#-#\n#-# The format is <id>:<type>:<url> where\n#-# * id can be anything as long as there is only one\n#-# * type is the type of the repository (maven, xwiki, etc.)\n#-# * url is the URL or the root of the repository\n#-#\n#-# [Since 4.3] It's also possible to associate various properties to each repository.\n#-# Here are the standard properties:\n#-# * user: the user to use to authenticate to the repository\n#-# * password: the password to use to authenticate to the repository\n#-# \n#-# And here those for \"maven\" repositories:\n#-# * [Since 10.7RC1] checksumPolicy: what to do when checksum validation fail. Possible values are \"fail\", \"warn\"\n#-#   (the default) and \"ignore\"\n#-#\n#-# Here is an example:\n# extension.repositories = privatemavenid:maven:http://host.com/private/maven/\n# extension.repositories.privatemavenid.auth.user = someuser\n# extension.repositories.privatemavenid.auth.password = thepassword\n#-#\n#-# Here's an example to add your local Maven Repository\n## Note: Since this file is parsed by Velocity in the Maven Remote Resource plugin we need to escape the\n## Apache Commons Configuration syntax for specifying the user.home system property!\n#set ($userHome = '${sys:user.home}')\n# extension.repositories = maven-local:maven:file://${userHome}/.m2/repository\n#-#\n#-# And an example to add the XWiki Maven Snapshot Repository\n# extension.repositories = maven-xwiki-snapshot:maven:https://nexus.xwiki.org/nexus/content/groups/public-snapshots\n#-#\n#-# When not set the following is taken (in this order):\n# extension.repositories = maven-xwiki:maven:https://nexus.xwiki.org/nexus/content/groups/public\n# extension.repositories = store.xwiki.com:xwiki:https://store.xwiki.com/xwiki/rest/\n# extension.repositories = extensions.xwiki.org:xwiki:https://extensions.xwiki.org/xwiki/rest/\n#-#\n#-# To not have any repository enabled (including disabling default repositories) you can explicitly make this list\n#-# empty:\n# extension.repositories=\n#if ($xwikiExtensionRepositories)\n#foreach ($extensionRepository in $xwikiExtensionRepositories.split(','))\nextension.repositories = $extensionRepository\n#end\n#end\n\n#-# [Since 2.5]\n#-# The directory where extensions are stored after being downloaded.\n#-#\n#-# The default is extension/repository in whatever is the general persistent directory.\n#-# See container.persistentDirectory.\n# extension.localRepository=extension/repository\n\n#-# [Since 3.4]\n#-# The user agent to use when communication with external services (generally repositories).\n#-#\n#-# The default is:\n# extension.userAgent=XWikiExtensionManager\n\n#-# [Since 7.1RC1]\n#-# Some extensions considered now as flavor but released before the category exists\n#-#\n#if ($xwikiPropertiesExtensionOldFlavors)\n#foreach($oldFlavor in $xwikiPropertiesExtensionOldFlavors.split(','))\nextension.oldflavors=$oldFlavor.trim()\n#end\n#else\n# extension.oldflavors=\n#end\n\n#-# [Since 8.3]\n#-# Indicate if XWiki should try to find more informations about the core extension in the repositories.\n#-#\n#-# The default is:\n# extension.core.resolve=true\n\n#-# [Since 9.6]\n#-# Indicate a list of pattern extension ids and the corresponding recommended version.\n#-# This version will be used for dependencies matching the pattern and fallback on the version declared by the\n#-# extension in case of failure.\n#-#\n#-# Here is an example:\n# extension.recommendedVersions=org.xwiki.commons:.*/[9.6]\n# extension.recommendedVersions=org.xwiki.rendering:.*/[9.6]\n# extension.recommendedVersions=org.xwiki.platform:.*/[9.6]\n# extension.recommendedVersions=com.mygroupid:.*/[1.9]\n\n#-# [Since 9.9]\n#-# Indicate whether the server should automatically check for new available environment versions.\n#-#\n#if ($xwikiPropertiesEnvironmentVersionCheck)\nextension.versioncheck.environment.enabled=$xwikiPropertiesEnvironmentVersionCheck\n#else\n#-# The default is:\n# extension.versioncheck.environment.enabled=false\n#end\n#-#\n#-# If the version check is enabled (through extension.versioncheck.environment.enabled), the following properties\n#-# can be used to customize how the version check is performed.\n#-#\n#-# Indicate the number of seconds between each check for a new version of the server.\n#-# The default is:\n# extension.versioncheck.environment.interval=3600\n#-#\n#-# Indicate a pattern that will be used to filter which version should be considered as a new version.\n#-# By default, no pattern is given an the pattern is not applied.\n#-# Example:\n# extension.versioncheck.environment.allowedVersions=9.*\n\n#-# [Since 10.5RC1]\n#-# Indicate how extension documents are protected.\n#-#\n#-# The possible choices are:\n#-# * none: no protection at all\n#-# * warning (the default): everyone get a warning when trying to edit a protected document\n#-# * deny = EDIT/DELETE right is denied for everyone except for admins who just get a warning\n#-# * forcedDeny = EDIT/DELETE right is denied for everyone, admins can't force edit/delete\n#-# * denySimple = EDIT/DELETE right is denied for simple users except for simple admins who just get a warning\n#-# * forcedDenySimple = EDIT/DELETE right is denied for all simple users, simple admins can't force edit/delete\n# extension.xar.protection=warning\n\n#-# [Since 12.2RC and 11.10.4]\n#-# Indicate a list of extension dependencies to ignore\n#-# \n#-# The default list is:\n# extension.ignoredDependencies=stax:stax\n# extension.ignoredDependencies=javax.xml.stream:stax-api\n# extension.ignoredDependencies=stax:stax-api\n# extension.ignoredDependencies=xalan:xalan\n# extension.ignoredDependencies=xalan:serializer\n\n#-------------------------------------------------------------------------------------\n# Distribution Wizard\n#-------------------------------------------------------------------------------------\n\n#-# [Since 7.1RC1] Enable or disable the automatic start of Distribution Wizard on empty/outdated wiki.\n#-#\n#-# The default is:\n# distribution.automaticStartOnMainWiki=true\n# distribution.automaticStartOnWiki=true\n\n#-#\u00a0[Since 10.2RC1] Control if the Distribution Wizard should be automatic or interactive (the default)\n#-# \n#-# On the main wiki\n# distribution.job.interactive=true\n#-# On the subwikis\n# distribution.job.interactive.wiki=true\n\n#-# [Since 10.2RC1] Override the default UI indicated in the \"environment extension\" (usually means the WAR).\n#-# It usually make more sense to set that at the WAR level (since it's usually synchronized with it).\n#-# If this is set it also means the Distribution Wizard will switch to default UI mode in which you cannot choose the\n#-# flavor.\n#-#\n#-# The id[/version] of the default UI for the main wiki. If the version is not indicated it will be the version of the\n#-# environment extension.\n# distribution.defaultUI=org.my.groupid:artifactid-mainwiki/1.5\n#-# The id[/version] default UI for the subwikis.  If the version is not indicated it will be the version of the\n#-# environment extension.\n# distribution.defaultWikiUI=org.my.groupid:artifactid-wiki/1.5\n\n#-------------------------------------------------------------------------------------\n# Solr Search\n#-------------------------------------------------------------------------------------\n\n#-# [Since 4.5M1]\n#-# The Solr server type. Currently accepted values are \"embedded\" (default) and \"remote\".\n# solr.type=embedded\n\n#-# [Since 4.5M1]\n#-# The location where the embedded Solr instance home folder is located.\n#-# The default is the subfolder \"store/solr\" inside folder defined by the property \"environment.permanentDirectory\".\n# solr.embedded.home=/var/local/xwiki/store/solr\n\n#-# [Since 12.2]\n#-# The URL of the Solr server (the root server and not the URL of a core).\n#-# The default value assumes that the remote Solr server is started in a different process on the same machine,\n#-# using the default port.\n# solr.remote.baseURL=http://localhost:8983/solr\n\n#-# [Since 12.6]\n#-# The prefix to add in front on each remote core name to avoid collisions with non-XWiki cores.\n#-# The default is \"xwiki\" which will produce names likes \"xwiki_events\" for example.\n# solr.remote.corePrefix=xwiki\n\n#-# [Since 5.1M1]\n#-# Elements to index are not sent to the Solr server one by one but in batch to improve performances.\n#-# It's possible to configure this behavior with the following properties:\n#-#\n#-# The maximum number of elements sent at the same time to the Solr server\n#-# The default is 50.\n# solr.indexer.batch.size=50\n#-# The maximum number of characters in the batch of elements to send to the Solr server.\n#-# The default is 10000.\n# solr.indexer.batch.maxLength=10000\n\n#-# [Since 5.1M1]\n#-# The maximum number of elements in the background queue of elements to index/delete\n#-# The default is 10000.\n# solr.indexer.queue.capacity=100000\n\n#-# [Since 6.1M2]\n#-# Indicates if a synchronization between SOLR index and XWiki database should be performed at startup.\n#-# Synchronization can be started from the search administration UI.\n#-# The default is true.\n# solr.synchronizeAtStartup=false\n\n#-# [Since 12.5RC1]\n#-# Indicates which wiki synchronization to perform when the \"solr.synchronizeAtStartup\" property is set to true.\n#-# Two modes are available:\n#-#   - WIKI: indicate that the synchronization is performed when each wiki is accessed for the first time.\n#-#   - FARM: indicate that the synchronization is performed once for the full farm when XWiki is started.\n#-# For large farms and in order to spread the machine's indexing load, the WIKI value is recommended, especially if\n#-# some wikis are not used.\n#-# The default is:\n# solr.synchronizeAtStartupMode=FARM\n\n#-------------------------------------------------------------------------------------\n# Security\n#-------------------------------------------------------------------------------------\n\n#-# [Since 5.0M2]\n#-# Define the authorization policies by choosing another implementation of the AuthorizationSettler. This component\n#-# is solely responsible for settling access decisions based on user, target entity and available security rules.\n#-# The identifier provided here is matched with the component role hint.\n#-#\n#-# The default is:\n# security.authorization.settler=default\n\n#-------------------------------------------------------------------------------------\n# URL\n#-------------------------------------------------------------------------------------\n\n#-# IMPORTANT: The URL module is a feature still in development and as such should be considered experimental at the\n#-# moment. The configuration parameters below are used only in some part of the code at the moment. The idea is to\n#-# progressively refactor more and more till only the new properties are used. For the moment you should continue to\n#-# use the following old properties located in xwiki.cfg:\n#-#  xwiki.virtual.usepath\n#-#  xwiki.virtual.usepath.servletpath\n\n#-# [Since 5.1M1]\n#-# The id of the URL format to use. This allows to plug in different implementations and thus allows to completely\n#-# control the format of XWiki URLs.\n#-#\n#-# The default is:\n# url.format=standard\n\n#-# [Since 5.1M1]\n#-# Defines where the wiki part is defined in a URL pointing to a subwiki\n#-# If true then the wiki part is located in the URL path (a.k.a path-based), for example:\n#-#   http://server/xwiki/wiki/mywiki/view/Space/Page\n#-# If false then the wiki part is located in the URL host domain (a.k.a domain-based), for example:\n#-#   http://mywiki.domain/xwiki/bin/view/Space/Page\n#-#\n#-# The default is:\n# url.standard.multiwiki.isPathBased=true\n\n#-# [Since 5.1M1]\n#-# For path-based setups, this property defines the path segment before the one identifying the subwiki in the URL.\n#-# For example if set to \"thewiki\", then the following URL will point to a subwiki named \"mywiki\":\n#-#   http://server/xwiki/thewiki/mywiki/view/Space/Page\n#-# Note that the mapping in web.xml has to be modified accordingly if you don't use the default value:\n#-#   <servlet-mapping>\n#-#     <servlet-name>action</servlet-name>\n#-#     <url-pattern>/wiki/*</url-pattern>\n#-#   </servlet-mapping>\n#-#\n#-# The default is:\n# url.standard.multiwiki.wikiPathPrefix=wiki\n\n#-# [Since 5.2M1]\n#-# Defines the URL path prefix used for Entity URLs, i.e. URLs pointing to a Document, Space, Object, etc.\n#-# For example this is the \"bin\" part in the following URL:\n#-#   http://server/xwiki/bin/view/space/page\n#-# Note that this replaces the old xwiki.defaultservletpath property in the xwiki.cfg file.\n#-#\n#-# The default is:\n# url.standard.entityPathPrefix=bin\n\n#-# [Since 5.3M1]\n#-# The action to take when a subwiki is not found (ie there's no wiki descriptor for it). Valid values are:\n#-# - redirect_to_main_wiki: default to displaying the main wiki\n#-# - display_error: redirect to a vm to display an error\n#-#\n#-# The default is:\n# url.standard.multiwiki.notFoundBehavior=redirect_to_main_wiki\n\n#-# [Since 7.2M1]\n#-# Whether the \"view\" action is omitted in URLs (in order to have shorter URLs).\n#-# Note that this replaces the old xwiki.showviewaction property in the xwiki.cfg file.\n#-#\n#-# The default is:\n# url.standard.hideViewAction=false\n\n#-# [Since 11.1RC1]\n#-# Whether a the last modified date of the file to be loaded should be checked and put in the URL query parameter.\n#-# Disabling this might improve a bit the performance on some old hard drives, or custom filesystem, however\n#-# it might imply the need to force-reload some resources in the browser, when migrating.\n#-#\n#-# The default is:\n# url.useResourceLastModificationDate=true\n\n#-------------------------------------------------------------------------------------\n# Attachment\n#-------------------------------------------------------------------------------------\n\n#-# [Since 5.2M2]\n#-# Define the kind of attachment that can be displayed inline. You can either choose to do it through a whitelist\n#-# (only the mimetypes defined in this list would be displayed inline) or a blacklist (every mimetype that is not in\n#-# this list would be displayed inline if possible).\n#-# Note that only one configuration is used between the whitelist and the blacklist, and the whitelist always have\n#-# the priority over the blacklist. Also note that these configurations exist for security reason so they are only\n#-# impacting attachments added by users who do not have programming rights.\n#-# If you want to force downloading some attachments types please check the configuration below.\n#-#\n#-# By default we use the following whitelist (coma separated list of values).\n# attachment.download.whitelist=audio/basic,audio/L24,audio/mp4,audio/mpeg,audio/ogg,audio/vorbis,audio/vnd.rn-realaudio,audio/vnd.wave,audio/webm,image/gif,image/jpeg,image/pjpeg,image/png,image/svg+xml,image/tiff,text/csv,text/plain,text/xml,text/rtf,video/mpeg,video/ogg,video/quicktime,video/webm,video/x-matroska,video/x-ms-wmv,video/x-flv\n#-#\n#-# If you prefer to use a blacklist instead, you can define the forbidden types here, as a coma separated list of\n#-# values. We advise you to forbid at least the following mimetypes : text/html, text/javascript\n# attachment.download.blacklist=text/html,text/javascript\n\n#-# [Since 12.10]\n#-# Define the kind of attachment that you always want to be downloaded and never displayed inline.\n#-# By default this list is empty, but you can specify a list of mime-types (coma separated list of values) which\n#-# should be always downloaded no matter who attached them or what is the whitelist/blacklist configuration.\n#-#\n#-# The distinction with the blacklist configuration above is that the blacklist won't affect file attached by a user\n#-# with programming rights, while this configuration affect any attachment.\n# attachment.download.forceDownload=\n\n#-------------------------------------------------------------------------------------\n# Active Installs\n#-------------------------------------------------------------------------------------\n\n#-# [Since 5.2M2]\n#-# The URL of where the Active Installs module should connect to in order to send a ping of activity. This feature\n#-# regularly sends the following information to xwiki.org about the current instance:\n#-# - its unique id\n#-# - the id and versions of all installed extensions)\n#-# The goal is to count the number of active installs of XWiki out there and provide statistics on xwiki.org\n#-#\n#-# The default is:\n# activeinstalls.pingURL=http://extensions.xwiki.org/activeinstalls\n\n#-------------------------------------------------------------------------------------\n# Wikis\n#-------------------------------------------------------------------------------------\n\n#-# [Since 5.4.4]\n#-# Add a default suffix to the alias of a new wiki in the wiki creation wizard, only when the path mode is not used\n#-# (i.e. domain-based, see url.standard.multiwiki.isPathBased). If this value is empty, XWiki will try to compute it\n#-# automatically from the request URL.\n#-#\n#-# eg: if wiki.alias.suffix is \"xwiki.org\" and the wiki name is \"playground\"\n#-#     then the computed alias will be: \"playground.xwiki.org\".\n#-#\n#-# The default is:\n# wiki.alias.suffix=\n\n#-------------------------------------------------------------------------------------\n# Store\n#-------------------------------------------------------------------------------------\n\n#-# [Since 6.1M2]\n#-# If active, the Filesystem Attachment Store will automatically clear empty directories on startup,\n#-# in some cases this may create undue load on the server and may need to be disabled. To do that,\n#-# set the following to false.\n#-# Note that if you disable this feature, empty directories will accumulate and you are responsible\n#-# for cleaning them up.\n# store.fsattach.cleanOnStartup=true\n\n#-# [Since 11.4RC1]\n#-# The root directory used by the various \"file\" stores implementation (attachment, deleted document, etc.).\n#-# \n#-# The default is ${environment.permanentDirectory}/store/file.\n#if ($xwikiPropertiesStoreFileDirectory)\nstore.file.directory=$xwikiPropertiesStoreFileDirectory\n#else\n# store.file.directory=/var/lib/xwiki/data/store/file/\n#end\n\n#-------------------------------------------------------------------------------------\n# Mail\n#-------------------------------------------------------------------------------------\n\n#-# [Since 6.1M2]\n#-# SMTP host when sending emails, defaults to \"localhost\".\n#-# This configuration property can be overridden in XWikiPreferences objects, by using the \"smtp_server\" property name.\n# mail.sender.host = localhost\n\n#-# [Since 6.1M2]\n#-# SMTP port when sending emails, defaults to 25.\n#-# This configuration property can be overridden in XWikiPreferences objects, by using the \"smtp_port\" property name.\n# mail.sender.port = 25\n\n#-# [Since 6.1M2]\n#-# From email address to use. Not defined by default and needs to be set up when calling the mail API.\n#-# This configuration property can be overridden in XWikiPreferences objects, by using the \"admin_email\" property name.\n# mail.sender.from = john@doe.com\n\n#-# [Since 6.1M2]\n#-# Username to authenticate on the SMTP server, if needed. By default no authentication is performed.\n#-# This configuration property can be overridden in XWikiPreferences objects, by using the \"smtp_server_username\"\n#-# property name.\n# mail.sender.username = someuser\n\n#-# [Since 6.1M2]\n#-# Password to authenticate on the SMTP server, if needed. By default no authentication is performed.\n#-# This configuration property can be overridden in XWikiPreferences objects, by using the \"smtp_server_password\"\n#-# property name.\n# mail.sender.password = somepassword\n\n#-# [Since 6.1M2]\n#-# Extra Java Mail options (see https://javamail.java.net/nonav/docs/api/).\n#-# This configuration property can be overridden in XWikiPreferences objects, by using the \"javamail_extra_props\"\n#-# property name.\n#-# By default the following properties are set automatically:\n#-#   mail.transport.protocol = smtp\n#-#   mail.smtp.host = <value of the mail.sender.host property>\n#-#   mail.smtp.port = <value of the mail.sender.port property>\n#-#   mail.smtp.user = <value of the mail.sender.username property>\n#-#   mail.smtp.from = <value of the mail.sender.from property>\n#-# Example:\n# mail.sender.properties = mail.smtp.starttls.enable = true\n# mail.sender.properties = mail.smtp.socks.host = someserver\n\n#-# [Since 6.4M2]\n#-# Defines which authorization checks are done when sending mails using the Mail Sender Script Service.\n#-# Example of valid values:\n#-# - \"programmingrights\": the current document must have Programming Rights\n#-# - \"alwaysallow\": no check is performed. This is useful when running XWiki in a secure environment where we\n#-#   want to allow all users to be able to send emails through the Script Service.\n#-# The default is:\n# mail.sender.scriptServiceCheckerHint = programmingrights\n\n#-# [Since 6.4M2]\n#-# optional default email addresses to add to the BCC mail header when sending email.\n# mail.sender.bcc = john@doe.com,mary@doe.com\n\n#-# [Since 6.4RC1]\n#-# The delay to wait between each mail being sent, in milliseconds. This is done to support mail throttling and not\n#-# be considered a spammer by mail servers.\n#-# The default is 8 seconds:\n# mail.sender.sendWaitTime = 8000\n\n#-# [Since 6.4.1, 7.0M1]\n#-# When using the Database Mail Listener, whether mail statuses for mails that have been sent successfully must be\n#-# discarded or not. They could be kept for tracability purpose for example.\n#-# The default is:\n# mail.sender.database.discardSuccessStatuses = true\n\n#-# [Since 11.6RC1]\n#-# Max queue size for the prepare mail thread. When the max size is reached, asynchronously sending a mail will block\n#-# till the first mail item in the prepare queue has been processed.\n# mail.sender.prepareQueueCapacity = 1000\n\n#-# [Since 11.6RC1]\n#-# Max queue size for the send mail thread. When the max size is reached, the prepare queue will block till the first\n# mail item in the send queue has been sent.\n# mail.sender.sendQueueCapacity = 1000\n\n#-# [Since 12.9RC1]\n#-# Decides if XWiki should resend automatically mails that were prepared but not sent, at restart.\n#-# Note that emails that were in the prepare_error state are not resent since they failed to be saved and thus cannot\n#-# be resent.\n# mail.sender.database.resendAutomaticallyAtStartup = true\n\n#-------------------------------------------------------------------------------------\n# Debug\n#-------------------------------------------------------------------------------------\n\n#-# [Since 7.0RC1]\n#-# Indicate if web resources should be loaded minified by default.\n#-# It's enabled by default which can make js/css hard to read.\n# debug.minify=false\n\n#-------------------------------------------------------------------------------------\n# LESS CSS\n#-------------------------------------------------------------------------------------\n\n#-# [Since 7.4.2, 8.0M2]\n#-# The number of LESS compilations that can be performed simultaneously. Put a little number if your resources are\n#-# limited.\n#-#\n#-# The default is:\n# lesscss.maximumSimultaneousCompilations = 4\n\n#-# [Since 8.0RC1]\n#-# Generate sourcemaps inline in the CSS files.\n#-#\n#-# The default is:\n# lesscss.generateInlineSourceMaps = false\n\n#-------------------------------------------------------------------------------------\n# Edit\n#-------------------------------------------------------------------------------------\n\n#-# [Since 8.2RC1]\n#-# Indicate the default editor to use for a specific data type.\n#-# The editors are components so they are specified using their role hints.\n#-# Some data types can be edited in multiple ways, by different types of editors.\n#-# Thus you can also indicate the default editor to use from a specific category (editor type).\n#-#\n#-# The format is this:\n#-# edit.defaultEditor.<dataType>=<roleHintOrCategory>\n#-# edit.defaultEditor.<dataType>#<category>=<roleHintOrSubCategory>\n#-#\n#-# The default bindings are:\n# edit.defaultEditor.org.xwiki.rendering.syntax.SyntaxContent=text\n# edit.defaultEditor.org.xwiki.rendering.syntax.SyntaxContent#text=text\n# edit.defaultEditor.org.xwiki.rendering.block.XDOM=text\n# edit.defaultEditor.org.xwiki.rendering.block.XDOM#text=text\n#if ($xwikiPropertiesDefaultWysiwygEditor)\nedit.defaultEditor.org.xwiki.rendering.syntax.SyntaxContent#wysiwyg=$xwikiPropertiesDefaultWysiwygEditor\nedit.defaultEditor.org.xwiki.rendering.block.XDOM#wysiwyg=$xwikiPropertiesDefaultWysiwygEditor\n#end\n\n#-# [Since 11.3.2, 11.6RC1]\n#-# Indicate if the mechanism to detect and handle edition conflicts should be enabled or not.\n#-# If disabled, it means that in case of edition conflicts, the latest save will be always take into account, and\n#-# erase previous data (which can always be recovered in the history of the document).\n#-# This option is provided because the feature is still experimental and it could be useful is some specific usecases\n#-# to switch it off. However it is not recommended to do so.\n#-#\n#-# The default is:\n# edit.conflictChecking.enabled = true\n\n#-# [Since 12.5]\n#-# Indicate if the XWiki documents should be edited in-place, without leaving the view mode, whenever possible (e.g. if\n#-# the default edit mode for that document and the preferred editor both support in-place editing). When enabled,\n#-# clicking on the document Edit button makes the document title and content editable in-place, without leaving the\n#-# view mode. When disabled, clicking on the document Edit button loads the default (stand-alone) edit mode for that\n#-# document.\n#-#\n#-# The default is:\n# edit.document.inPlaceEditing.enabled = true\n\n#-------------------------------------------------------------------------------------\n# Notifications\n#-------------------------------------------------------------------------------------\n\n#-# [Since 9.4RC1]\n#-# Indicates if the notifications module should be enabled on the platform.\n#-#\n#-# The default is :\n# notifications.enabled = true\n\n#-# [Since 9.5C1]\n#-# Indicates if the notifications module can send emails.\n#-#\n#-# The default is :\n# notifications.emails.enabled = true\n\n#-# [Since 9.6RC1]\n#-# Indicate the grace time used when sending live email notifications.\n#-# When an event is triggered in the wiki (for example, a document update), the platform will wait X minutes\n#-# before sending live notifications emails. During this time, if events of the same kind are recieved, they will\n#-# be grouped in the same email.\n#-#\n#-# The grace time define the period (in minutes) for which the platform should wait before sending a notification\n#-# mail after an event.\n#-#\n#-# The default is :\n# notifications.emails.live.graceTime = 10\n\n#-# [Since 9.8RC1]\n#-# Indicate if the \"watched entities\" feature is enabled on the platform.\n#-# This feature mimics what the \"Watchlist Application\" does so it may not be a good idea to have both on the platform.\n#-#\n#-# The default is :\n# notifications.watchedEntities.enabled = true\n\n#-# [Since 9.11.8]\n#-# [Since 10.6RC1]\n#-# The automatic watch mode used by default. The value can be changed by an administrator in the wiki's administration\n#-# or by any user in their own settings.\n#-#\n#-# Possible values:\n#-#\n#-# - none:  no page is added to the list of watched pages automatically.\n#-# - all:   everytime a user makes a change on a page, it is automatically added to her list of watched pages.\n#-# - major: everytime a user makes a major change on a page, it is automatically added to her list of watched pages.\n#-# - new:   only pages created by a user are added to her list of watched pages.\n#-#\n#-# The default is :\n# notifications.watchedEntities.autoWatch = major\n\n#-# [Since 10.11.4]\n#-# [Since 11.2]\n#-# The search for notifications in the REST API is done trough a thread pool to limit the impact on the rest of the\n#-# XWiki instance.\n#-# This properties controls the size of this pool. Any number lower than 1 disable the thread pool system.\n#-# \n#-# The default is :\n# notifications.rest.poolSize = 2\n\n#-# [Since 10.11.8]\n#-# [Since 11.3]\n#-# Enable or disable caching of notification search result in the REST or async API.\n#-# \n#-# The default is :\n# notifications.rest.cache = true\n\n#-# [Since 12.6]\n#-# When this option is enabled the relation between users and events is evaluated and stored when the events are\n#-# generated instead of each time they are displayed.\n#-#\n#-# The default is :\n# notifications.eventPrefilteringEnabled = true\n\n#-# [Since 12.5RC1]\n#-# The async notifications renderer is using a dedicated thread pool to limit the impact on the rest of the XWiki\n#-# instance.\n#-# This properties controls the size of this pool.\n#-#\n#-# The default is :\n# notifications.async.poolSize = 2\n\n#-------------------------------------------------------------------------------------\n# Mentions\n#-------------------------------------------------------------------------------------\n\n#-# [Since 12.6]\n#-# The detection and notification for the user mentions in created or edited content is done asynchronously \n#-# by a pool of consumers.\n#-# This properties controls the size of this pool.\n#-#\n#-# The default is :\n# mentions.poolSize = 1\n\n#-------------------------------------------------------------------------------------\n# Event Stream\n#-------------------------------------------------------------------------------------\n\n#-# [Since 11.1RC1]\n#-# The Event Stream, on which the notifications are based, stores data in a dedicated table in the database.\n#-#\u00a0Each wiki has its own database. The feature can be configured to store its data into the database corresponding to\n#-# the wiki, into the main database (default: xwiki) or both. These options should not be both set to false (in this\n#-# case the local store will be forced).\n#-# Important note: disabling storage in the main store will prevent the notifications from retrieving events from\n#-# subwikis. Moreover, disabling the main store makes impossible for global users to watch pages from subwikis. It is\n#-# not recommended.\n#-#\n#-# This feature was originally implemented by the Activity Stream plugin so these settings might sound familiar to you.\n#-#\n#-# The default is :\n# eventstream.uselocalstore = true\n#-#\n#-# The default is :\n# eventstream.usemainstore = true\n#-#\n#-# Number of days the events should be kept (0 or any negative value: infinite duration)\n#-# Note: if this value is greater than 0 a scheduler job will be created, this job will then be fired every week to\n#-# delete events older than the configured value.\n#-# The default is :\n# eventstream.daystokeepevents = 0\n\n#-# [Since 12.4]\n#-# Indicate if the new no-SQL oriented event store is enabled. Once enabled the Solr implementation is\n#-# used by default but other implementations (like a MongoDB based implementation for example) might come later.\n#-# It's enabled by default since 12.6.\n# eventstream.store.enabled = true\n#-# Indicate which event store implementation to use. The default implementation is based on Solr.\n# eventstream.store = solr\n\n#-------------------------------------------------------------------------------------\n# Logging\n#-------------------------------------------------------------------------------------\n\n#-# [Since 12.0RC1]\n#-# Indicate of logging about the use of deprecated APIs/feature should be enabled.\n#-# \n#-# The default is:\n# logging.deprecated.enabled = true\n\n#-------------------------------------------------------------------------------------\n# User\n#-------------------------------------------------------------------------------------\n\n#-# [Since 12.2]\n#-# Indicate where users are stored.\n#-#\n#-# The default (and currently the only supported option) is:\n# user.store.hint = document\n\n#-# [Since 12.2]\n#-# Define preferences for the SuperAdmin user.\n#-#\n#-# The format is:\n#-# user.preferences.superadmin.<preference name> = <value>\n#-#\n#-# Examples:\n#-# user.preferences.superadmin.displayHiddenDocuments = 0\n#-# user.preferences.superadmin.editor = Text\n\n#-# [Since 12.2]\n#-# Define preferences for the Guest user.\n#-#\n#-# The format is:\n#-# user.preferences.guest.<preference name> = <value>\n#-#\n#-# Examples:\n#-# user.preferences.guest.displayHiddenDocuments = 1\n#-# user.preferences.guest.editor = Text\n\n#-------------------------------------------------------------------------------------\n# Refactoring\n#-------------------------------------------------------------------------------------\n\n#-# [Since 12.5RC1]\n#-# Indicate to use the old implementation based on copy and delete, or the new implementation using an atomic operation\n#-# on database (which is a lot more performant).\n#-# This property aims at being removed in the future once the atomic rename has been validated to work 100% fine.\n#-# Only use it if you are facing an issue with the move/rename features.\n#-#\n#-# The default value is:\n# refactoring.rename.useAtomicRename = true\n\n#-# [Since 12.9RC1]\n#-# Indicates whether skipping the recycle bin when deleting pages is allowed for Advanced users.\n#-# It is disabled by default.\n#-# This setting is only used if the wiki has a recycle bin activated (xwiki.recyclebin=1 in xwiki.cfg).\n#-# This setting can be overloaded:\n#-# * By the main wiki in the Refactoring.Code.RefactoringConfigurationClass class of the\n#-#   Refactoring.Code.RefactoringConfiguration document of the main wiki.\n#-# * By sub-wikis in the Refactoring.Code.RefactoringConfigurationClass class of the\n#-#   Refactoring.Code.RefactoringConfiguration document of the sub-wikis (itself overloading the main wiki's\n#-#   configuration).\n#-#\n#-# The default value is:\n# refactoring.isRecycleBinSkippingActivated = false\n\n#-------------------------------------------------------------------------------------\n# Skin Extensions\n#-------------------------------------------------------------------------------------\n\n#-# [Since 12.7.1, 12.8RC1]\n#-# Indicate whether the JavaScript skin extensions should be parsed and minified using strict mode. When strict mode is\n#-# enabled:\n#-# * the JavaScript minification may fail if the code is poorly written. See\n#-#   https://github.com/google/closure-compiler/wiki/Warnings for a list of errors that may occur. When this happens\n#-#   XWiki uses the original (unminified) JavaScript source as a fall-back and logs some error messages that indicate\n#-#   how the bad code can be fixed.\n#-# * the minified JavaScript includes the \"use strict;\" statement which means the code may fail at runtime if it doesn't\n#-#   follow the ECMAScript strict rules. See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode\n#-#\n#-# The default value is:\n# skinx.jsStrictModeEnabled = false\n\n$!xwikiPropertiesAdditionalProperties"], "fixing_code": ["/*\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n */\npackage com.xpn.xwiki.web;\n\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collections;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\n\nimport javax.servlet.http.HttpServletResponse;\n\nimport org.apache.commons.io.IOUtils;\nimport org.apache.commons.io.input.BoundedInputStream;\nimport org.apache.commons.lang3.StringUtils;\nimport org.apache.commons.lang3.math.NumberUtils;\nimport org.apache.commons.lang3.tuple.ImmutablePair;\nimport org.apache.commons.lang3.tuple.Pair;\nimport org.xwiki.configuration.ConfigurationSource;\nimport org.xwiki.context.Execution;\nimport org.xwiki.context.ExecutionContext;\nimport org.xwiki.model.EntityType;\nimport org.xwiki.model.reference.DocumentReference;\nimport org.xwiki.model.reference.EntityReference;\nimport org.xwiki.resource.ResourceReference;\nimport org.xwiki.resource.ResourceReferenceManager;\nimport org.xwiki.resource.entity.EntityResourceReference;\nimport org.xwiki.stability.Unstable;\n\nimport com.xpn.xwiki.XWiki;\nimport com.xpn.xwiki.XWikiContext;\nimport com.xpn.xwiki.XWikiException;\nimport com.xpn.xwiki.doc.XWikiAttachment;\nimport com.xpn.xwiki.doc.XWikiDocument;\nimport com.xpn.xwiki.plugin.XWikiPluginManager;\nimport com.xpn.xwiki.util.Util;\n\n/**\n * The action for downloading attachments from the server.\n *\n * @version $Id$\n */\npublic class DownloadAction extends XWikiAction\n{\n    /** The identifier of the download action. */\n    public static final String ACTION_NAME = \"download\";\n\n    /** The identifier of the attachment disposition. */\n    public static final String ATTACHMENT = \"attachment\";\n\n    /** List of authorized attachment mimetypes. */\n    public static final List<String> MIMETYPE_WHITELIST =\n        Arrays.asList(\"audio/basic\", \"audio/L24\", \"audio/mp4\", \"audio/mpeg\", \"audio/ogg\", \"audio/vorbis\",\n            \"audio/vnd.rn-realaudio\", \"audio/vnd.wave\", \"audio/webm\", \"image/gif\", \"image/jpeg\", \"image/pjpeg\",\n            \"image/png\", \"image/tiff\", \"text/csv\", \"text/plain\", \"text/xml\", \"text/rtf\", \"video/mpeg\",\n            \"video/ogg\", \"video/quicktime\", \"video/webm\", \"video/x-matroska\", \"video/x-ms-wmv\", \"video/x-flv\");\n\n    /** Key of the whitelist in xwiki.properties. */\n    public static final String WHITELIST_PROPERTY = \"attachment.download.whitelist\";\n\n    /** Key of the blacklist in xwiki.properties. */\n    public static final String BLACKLIST_PROPERTY = \"attachment.download.blacklist\";\n\n    /**\n     * Key of the forceDownload list in xwiki.properties.\n     * @since 12.10\n     */\n    @Unstable\n    public static final String FORCE_DOWNLOAD_PROPERTY = \"attachment.download.forceDownload\";\n\n    /** The URL part separator. */\n    private static final String SEPARATOR = \"/\";\n\n    /** The name of the HTTP Header that signals a byte-range request. */\n    private static final String RANGE_HEADER_NAME = \"Range\";\n\n    /** The format of a valid range header. */\n    private static final Pattern RANGE_HEADER_PATTERN = Pattern.compile(\"bytes=([0-9]+)?-([0-9]+)?\");\n\n    /**\n     * Default constructor.\n     */\n    public DownloadAction()\n    {\n        this.handleRedirectObject = true;\n    }\n\n    @Override\n    public String render(XWikiContext context) throws XWikiException\n    {\n        XWikiRequest request = context.getRequest();\n        XWikiResponse response = context.getResponse();\n\n        XWikiDocument doc = context.getDoc();\n        String filename = getFileName();\n        XWikiAttachment attachment = getAttachment(request, doc, filename);\n\n        Map<String, Object> backwardCompatibilityContextObjects = null;\n\n        if (attachment == null) {\n            // If some plugins extend the Download URL format for the Standard Scheme the document in the context will\n            // most likely not have a reference that corresponds to what the plugin expects. For example imagine that\n            // the URL is a Zip Explorer URL like .../download/space/page/attachment/index.html. This will be parsed\n            // as space.page.attachment@index.html by the Standard URL scheme parsers. Thus the attachment won't be\n            // found since index.html is not the correct attachment for the Zip Explorer plugin's URL format.\n            //\n            // Thus in order to preserve backward compatibility for existing plugins that have custom URL formats\n            // extending the Download URL format, we parse again the URL by considering that it doesn't contain any\n            // Nested Space. This also means that those plugins will need to completely reparse the URL if they wish to\n            // support Nested Spaces.\n            //\n            // Also note that this code below is not compatible with the notion of having several URL schemes. The real\n            // fix will be to not allow plugins to support custom URL formats and instead to have them register new\n            // Actions if they need a different URL format.\n            Pair<XWikiDocument, XWikiAttachment> result =\n                extractAttachmentAndDocumentFromURLWithoutSupportingNestedSpaces(request, context);\n\n            if (result == null) {\n                throwNotFoundException(filename);\n            }\n\n            XWikiDocument backwardCompatibilityDocument = result.getLeft();\n            attachment = result.getRight();\n\n            // Set the new doc as the context doc so that plugins see it as the context doc\n            backwardCompatibilityContextObjects = new HashMap<>();\n            pushDocumentInContext(backwardCompatibilityContextObjects,\n                backwardCompatibilityDocument.getDocumentReference());\n        }\n\n        try {\n            XWikiPluginManager plugins = context.getWiki().getPluginManager();\n            attachment = plugins.downloadAttachment(attachment, context);\n\n            if (attachment == null) {\n                throwNotFoundException(filename);\n            }\n\n            // Try to load the attachment content just to make sure that the attachment really exists\n            // This will throw an exception if the attachment content isn't available\n            try {\n                attachment.getContentLongSize(context);\n            } catch (XWikiException e) {\n                Object[] args = { filename };\n                throw new XWikiException(XWikiException.MODULE_XWIKI_APP,\n                    XWikiException.ERROR_XWIKI_APP_ATTACHMENT_NOT_FOUND, \"Attachment content {0} not found\", null,\n                    args);\n            }\n\n            long lastModifiedOnClient = request.getDateHeader(\"If-Modified-Since\");\n            long lastModifiedOnServer = attachment.getDate().getTime();\n            if (lastModifiedOnClient != -1 && lastModifiedOnClient >= lastModifiedOnServer) {\n                response.setStatus(HttpServletResponse.SC_NOT_MODIFIED);\n                return null;\n            }\n\n            // Sending the content of the attachment\n            if (request.getHeader(RANGE_HEADER_NAME) != null) {\n                try {\n                    if (sendPartialContent(attachment, request, response, context)) {\n                        return null;\n                    }\n                } catch (IOException ex) {\n                    // Broken response...\n                }\n            }\n            sendContent(attachment, request, response, context);\n            return null;\n        } finally {\n            if (backwardCompatibilityContextObjects != null) {\n                popDocumentFromContext(backwardCompatibilityContextObjects);\n            }\n        }\n    }\n\n    private void throwNotFoundException(String filename) throws XWikiException\n    {\n        String message =\n            filename == null ? \"Attachment not found\" : String.format(\"Attachment [%s] not found\", filename);\n        throw new XWikiException(XWikiException.MODULE_XWIKI_APP, XWikiException.ERROR_XWIKI_APP_ATTACHMENT_NOT_FOUND,\n            message);\n    }\n\n    /**\n     * Respond to a range request, either with the requested bytes, or with a {@code 416 REQUESTED RANGE NOT\n     * SATISFIABLE} response if the requested byte range falls outside the length of the attachment. If the range\n     * request header is syntactically invalid, nothing is written, and instead {@code false} is returned, letting the\n     * action handler ignore the Range header and treat this as a normal (full) download request.\n     *\n     * @param attachment the attachment to get content from\n     * @param request the current client request\n     * @param response the response to write to.\n     * @param context the current request context\n     * @return {@code true} if the partial content request was syntactically valid and a response was sent,\n     *         {@code false} otherwise\n     * @throws XWikiException if the attachment content cannot be retrieved\n     * @throws IOException if the response cannot be written\n     */\n    private boolean sendPartialContent(final XWikiAttachment attachment, final XWikiRequest request,\n        final XWikiResponse response, final XWikiContext context) throws XWikiException, IOException\n    {\n        String range = request.getHeader(RANGE_HEADER_NAME);\n        Matcher m = RANGE_HEADER_PATTERN.matcher(range);\n        if (m.matches()) {\n            String startStr = m.group(1);\n            String endStr = m.group(2);\n            Long start = NumberUtils.createLong(startStr);\n            Long end = NumberUtils.createLong(endStr);\n            if (start == null && end != null && end > 0) {\n                // Tail request, output the last <end> bytes\n                start = Math.max(attachment.getContentLongSize(context) - end, 0L);\n                end = attachment.getContentLongSize(context) - 1L;\n            }\n            if (!isValidRange(start, end)) {\n                return false;\n            }\n            if (end == null) {\n                end = attachment.getContentLongSize(context) - 1L;\n            }\n            end = Math.min(end, attachment.getContentLongSize(context) - 1L);\n            writeByteRange(attachment, start, end, request, response, context);\n            return true;\n        }\n        return false;\n    }\n\n    /**\n     * Write a byte range from the attachment to the response, if the requested range is valid and falls within the file\n     * limits.\n     *\n     * @param attachment the attachment to get content from\n     * @param start the first byte to write\n     * @param end the last byte to write\n     * @param request the current client request\n     * @param response the response to write to.\n     * @param context the current request context\n     * @throws XWikiException if the attachment content cannot be retrieved\n     * @throws IOException if the response cannot be written\n     */\n    private void writeByteRange(final XWikiAttachment attachment, Long start, Long end, final XWikiRequest request,\n        final XWikiResponse response, final XWikiContext context) throws XWikiException, IOException\n    {\n        if (start >= 0 && start < attachment.getContentLongSize(context)) {\n            InputStream data = attachment.getContentInputStream(context);\n            data = new BoundedInputStream(data, end + 1);\n            data.skip(start);\n            setCommonHeaders(attachment, request, response, context);\n            response.setStatus(HttpServletResponse.SC_PARTIAL_CONTENT);\n            if ((end - start + 1L) < Integer.MAX_VALUE) {\n                setContentLength(response, end - start + 1);\n            }\n            response.setHeader(\"Content-Range\",\n                \"bytes \" + start + \"-\" + end + SEPARATOR + attachment.getContentLongSize(context));\n            IOUtils.copyLarge(data, response.getOutputStream());\n        } else {\n            response.setStatus(HttpServletResponse.SC_REQUESTED_RANGE_NOT_SATISFIABLE);\n        }\n    }\n\n    /**\n     * Send the attachment content in the response.\n     *\n     * @param attachment the attachment to get content from\n     * @param request the current client request\n     * @param response the response to write to.\n     * @param context the XWikiContext just in case it is needed to load the attachment content\n     * @throws XWikiException if something goes wrong\n     */\n    protected void sendContent(final XWikiAttachment attachment, final XWikiRequest request,\n        final XWikiResponse response, final XWikiContext context) throws XWikiException\n    {\n        InputStream stream = null;\n        try {\n            setCommonHeaders(attachment, request, response, context);\n            setContentLength(response, attachment.getContentLongSize(context));\n            stream = attachment.getContentInputStream(context);\n            IOUtils.copy(stream, response.getOutputStream());\n        } catch (IOException e) {\n            throw new XWikiException(XWikiException.MODULE_XWIKI_APP,\n                XWikiException.ERROR_XWIKI_APP_SEND_RESPONSE_EXCEPTION, \"Exception while sending response\", e);\n        } finally {\n            if (stream != null) {\n                IOUtils.closeQuietly(stream);\n            }\n        }\n    }\n\n    /**\n     * @return the filename of the attachment or null if the URL didn't point to an attachment\n     */\n    private String getFileName()\n    {\n        // Extract the Attachment file name from the parsed request URL that was done before this Action is called\n        ResourceReference resourceReference = Utils.getComponent(ResourceReferenceManager.class).getResourceReference();\n        EntityResourceReference entityResource = (EntityResourceReference) resourceReference;\n\n        // Try to extract the attachment from the reference but it's possible that the URL didn't point to an\n        // attachment, in which case we return null.\n        EntityReference attachmentReference =\n            entityResource.getEntityReference().extractReference(EntityType.ATTACHMENT);\n\n        return attachmentReference == null ? null : attachmentReference.getName();\n    }\n\n    private Pair<XWikiDocument, XWikiAttachment> extractAttachmentAndDocumentFromURLWithoutSupportingNestedSpaces(\n        XWikiRequest request, XWikiContext context)\n    {\n        String path = request.getRequestURI();\n\n        // Extract the path part after the action, e.g. \"/space/page/attachment/path1/path2\" when you have\n        // \".../download/space/page/attachment/path1/path2\".\n        int pos = path.indexOf(SEPARATOR + ACTION_NAME);\n        String subPath = path.substring(pos + (SEPARATOR + ACTION_NAME).length() + 1);\n\n        List<String> segments = new ArrayList<>();\n        for (String pathSegment : subPath.split(SEPARATOR, -1)) {\n            segments.add(Util.decodeURI(pathSegment, context));\n        }\n\n        // We need at least 3 segments\n        if (segments.size() < 3) {\n            return null;\n        }\n\n        String spaceName = segments.get(0);\n        String pageName = segments.get(1);\n        String attachmentName = segments.get(2);\n\n        // Generate the XWikiDocument and try to load it (if the user has permission to it)\n        DocumentReference reference = new DocumentReference(context.getWikiId(), spaceName, pageName);\n        XWiki xwiki = context.getWiki();\n\n        XWikiDocument backwardCompatibilityDocument;\n        try {\n            backwardCompatibilityDocument = xwiki.getDocument(reference, context);\n            if (!backwardCompatibilityDocument.isNew()) {\n                if (!context.getWiki().checkAccess(context.getAction(), backwardCompatibilityDocument, context)) {\n                    // No permission to access the document, consider that the attachment doesn't exist\n                    return null;\n                }\n            } else {\n                // Document doesn't exist\n                return null;\n            }\n        } catch (XWikiException e) {\n            // An error happened when getting the doc or checking the permission, consider that the attachment\n            // doesn't exist\n            return null;\n        }\n\n        // Look for the attachment and return it\n        XWikiAttachment attachment = getAttachment(request, backwardCompatibilityDocument, attachmentName);\n\n        return new ImmutablePair<>(backwardCompatibilityDocument, attachment);\n    }\n\n    private void pushDocumentInContext(Map<String, Object> backupObjects, DocumentReference documentReference)\n        throws XWikiException\n    {\n        XWikiContext xcontext = getContext();\n\n        // Backup current context state\n        XWikiDocument.backupContext(backupObjects, xcontext);\n\n        // Make sure to get the current XWikiContext after ExcutionContext clone\n        xcontext = getContext();\n\n        // Change context document\n        xcontext.getWiki().getDocument(documentReference, xcontext).setAsContextDoc(xcontext);\n    }\n\n    private void popDocumentFromContext(Map<String, Object> backupObjects)\n    {\n        XWikiDocument.restoreContext(backupObjects, getContext());\n    }\n\n    private XWikiContext getContext()\n    {\n        Execution execution = Utils.getComponent(Execution.class);\n        ExecutionContext econtext = execution.getContext();\n        return econtext != null ? (XWikiContext) econtext.getProperty(\"xwikicontext\") : null;\n    }\n\n    private XWikiAttachment getAttachment(XWikiRequest request, XWikiDocument document, String filename)\n    {\n        XWikiAttachment attachment = null;\n\n        String idStr = request.getParameter(\"id\");\n        if (StringUtils.isNumeric(idStr)) {\n            int id = Integer.parseInt(idStr);\n            if (document.getAttachmentList().size() > id) {\n                attachment = document.getAttachmentList().get(id);\n            }\n        } else {\n            attachment = document.getAttachment(filename);\n        }\n\n        return attachment;\n    }\n\n    /**\n     * Set the response HTTP headers common to both partial (Range) and full responses.\n     *\n     * @param attachment the attachment to get content from\n     * @param request the current client request\n     * @param response the response to write to.\n     * @param context the current request context\n     */\n    private void setCommonHeaders(final XWikiAttachment attachment, final XWikiRequest request,\n        final XWikiResponse response, final XWikiContext context)\n    {\n        // Choose the right content type\n        String mimetype = attachment.getMimeType(context);\n        response.setContentType(mimetype);\n\n        // Set the character encoding\n        String characterEncoding = attachment.getCharset();\n        if (characterEncoding != null) {\n            response.setCharacterEncoding(characterEncoding);\n        }\n\n        String ofilename = Util.encodeURI(attachment.getFilename(), context).replaceAll(\"\\\\+\", \"%20\");\n\n        // The inline attribute of Content-Disposition tells the browser that they should display\n        // the downloaded file in the page (see http://www.ietf.org/rfc/rfc1806.txt for more\n        // details). We do this so that JPG, GIF, PNG, etc are displayed without prompting a Save\n        // dialog box. However, all mime types that cannot be displayed by the browser do prompt a\n        // Save dialog box (exe, zip, xar, etc).\n        String dispType = \"inline\";\n\n        // Determine whether the user who attached the file has Programming Rights or not.\n        boolean hasPR = false;\n        String author = attachment.getAuthor();\n        try {\n            hasPR = context.getWiki().getRightService().hasAccessLevel(\"programming\", author, \"XWiki.XWikiPreferences\",\n                context);\n        } catch (Exception e) {\n            hasPR = false;\n        }\n        // If the mimetype is not authorized to be displayed inline, let's force its content disposition to download.\n        if (shouldBeDownloaded(hasPR, request, mimetype)) {\n            dispType = ATTACHMENT;\n        }\n        // Use RFC 2231 for encoding filenames, since the normal HTTP headers only allows ASCII characters.\n        // See http://tools.ietf.org/html/rfc2231 for more details.\n        response.addHeader(\"Content-disposition\", dispType + \"; filename*=utf-8''\" + ofilename);\n\n        response.setDateHeader(\"Last-Modified\", attachment.getDate().getTime());\n        // Advertise that downloads can be resumed\n        response.setHeader(\"Accept-Ranges\", \"bytes\");\n    }\n\n    /**\n     * Check if the specified byte range first and last bytes form a syntactically valid range. For a range to be valid,\n     * at least one of the ends must be specified, and if both are present, the range end must be greater than the range\n     * start.\n     *\n     * @param start the requested range start, i.e. the first byte to be transfered, or {@code null} if missing from the\n     *            Range header\n     * @param end the requested range end, i.e. the last byte to be transfered, or {@code null} if missing from the\n     *            Range header\n     * @return {@code true} if the range is valid, {@code false} otherwise\n     */\n    private boolean isValidRange(Long start, Long end)\n    {\n        if (start == null && end == null) {\n            return false;\n        }\n        return start == null || end == null || end >= start;\n    }\n\n    /**\n     * Check if an attachment should be downloaded or can be displayed inline.\n     * Attachments should be downloaded if:\n     * <ul>\n     *     <li>the request contains a force-download parameter with the value 1</li>\n     *     <li>or the mimetype is part of the forceDownload property list</li>\n     *     <li>or no custom whitelist exists and a custom blacklist exists and contains the mimetype and the attachment\n     *     has not been added by a user with programming rights</li>\n     *     <li>or the whitelist (default or custom) does not contains the mimetype and the attachment has not been added\n     *     by a user with programming rights</li>\n     * </ul>\n     *\n     * Note that in the case of the request does not contain a force-downloaded parameter with the value 1 and the\n     * mimetype is not part of the forceDownload property list, but the attachment has been added by a user with\n     * programming right, then the attachment is always displayed inline.\n     *\n     * @param hasPR a boolean indicating if the attachment has been added by someone with programming rights.\n     * @param request the current download request.\n     * @param mimeType the mimetype of the attachment.\n     * @return {@code true} if the attachment should be downloaded, and {@code false} if it can be displayed inline.\n     */\n    private boolean shouldBeDownloaded(boolean hasPR, XWikiRequest request, String mimeType)\n    {\n        boolean result;\n        ConfigurationSource configuration = Utils.getComponent(ConfigurationSource.class, \"xwikiproperties\");\n\n        boolean whiteListExists = configuration.containsKey(WHITELIST_PROPERTY);\n        boolean blackListExists = configuration.containsKey(BLACKLIST_PROPERTY);\n        List<String> blackList = configuration.getProperty(BLACKLIST_PROPERTY, Collections.emptyList());\n        List<String> whiteList = configuration.getProperty(WHITELIST_PROPERTY, MIMETYPE_WHITELIST);\n        List<String> forceDownloadList = configuration.getProperty(FORCE_DOWNLOAD_PROPERTY, Collections.emptyList());\n\n        if (\"1\".equals(request.getParameter(\"force-download\")) || forceDownloadList.contains(mimeType)) {\n            result = true;\n        } else if (hasPR) {\n            result = false;\n        } else if (blackListExists && !whiteListExists) {\n            result = blackList.contains(mimeType);\n        } else {\n            result = !whiteList.contains(mimeType);\n        }\n\n        return result;\n    }\n}\n", "# ---------------------------------------------------------------------------\n# See the NOTICE file distributed with this work for additional\n# information regarding copyright ownership.\n#\n# This is free software; you can redistribute it and/or modify it\n# under the terms of the GNU Lesser General Public License as\n# published by the Free Software Foundation; either version 2.1 of\n# the License, or (at your option) any later version.\n#\n# This software is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n# Lesser General Public License for more details.\n#\n# You should have received a copy of the GNU Lesser General Public\n# License along with this software; if not, write to the Free\n# Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n# 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n# ---------------------------------------------------------------------------\n\n# This is the new XWiki configuration file. In the future it'll replace the old\n# xwiki.cfg file. However right now it's only used by some XWiki components.\n# As time progresses more and more component will get their configurations from\n# this file.\n# \n# This file come from one of those locations (in this order):\n# * [since 9.3] /etc/xwiki/xwiki.properties\n# * /WEB-INF/xwiki.properties in the web application resources\n\n#-------------------------------------------------------------------------------------\n# Core\n#-------------------------------------------------------------------------------------\n\n#-# [Since 1.8RC2]\n#-# Specifies the default syntax to use when creating new documents.\n#-# Default value is xwiki/2.1.\n# core.defaultDocumentSyntax = xwiki/2.1\n\n#-# [Since 2.4M1]\n#-# Indicate if the rendering cache is enabled.\n#-# Default value is false.\n# core.renderingcache.enabled = true\n\n#-# [Since 2.4M1]\n#-# A list of Java regex patterns matching full documents reference.\n# core.renderingcache.documents = wiki:Space\\.Page\n# core.renderingcache.documents = wiki:Space\\..*\n# core.renderingcache.documents = Space\\.PageOnWhateverWiki\n\n#-# [Since 2.4M1]\n#-# The time (in seconds) after which data should be removed from the cache when not used.\n#-# Default value is 300 (5 min).\n# core.renderingcache.duration = 300\n\n#-# [Since 2.4M1]\n#-# The size of the rendering cache. Not that it's not the number of cached documents but the number of cached results.\n#-# (For a single document several cache entries are created, because each action, language and request query string\n#-# produces a unique rendering result)\n#-# Default value is 100.\n# core.renderingcache.size = 100\n\n#-# [Since 7.2M2]\n#-# Define which hierarchy is used between pages (for example inside the breadcrumb).\n#-# Possible values are \"reference\" (default) or \"parentchild\".\n#-# If \"parentchild\" is used, the hierachy is based on the parent/child relationship, which means that any document\n#-# could be defined as the parent of an other document.\n#-# If \"reference\" is used, then the children of a document must be placed inside this document. It's less flexible but\n#-# more clear.\n# core.hierarchyMode = reference\n\n#-------------------------------------------------------------------------------------\n# Environment\n#-------------------------------------------------------------------------------------\n\n#-# [Since 3.5M1, replaces the container.persistentDirectory property]\n#-# The directory used to store persistent data (data that should persist across server restarts). This is an\n#-# important directory containing important data and thus it should never be deleted (it should be backed-up along\n#-# with the database).\n#-# For example this is where the Extension Manager stores downloaded extensions if the extension.localRepository\n#-# property isn't configured.\n#-#\n#-# You can set:\n#-# * an absolute path (recommended)\n#-# * a relative path (not recommended at all)but in this case the directory will be relative to where the XWiki server\n#-#   is started and thus the user under which XWiki is started will need write permissions for the current directory\n#-#\n#-# Note if the system property xwiki.data.dir is set then this property is not used.\n#-# If neither the system property nor this configuration value here are set then the Servlet container's temporary\n#-# directory is used; This is absolutely not recommended since that directory could be wiped out at any time and you\n#-# should specify a value.\n#if ($xwikiPropertiesEnvironmentPermanentDirectory)\nenvironment.permanentDirectory = $xwikiPropertiesEnvironmentPermanentDirectory\n#else\n# environment.permanentDirectory = /var/lib/xwiki/data/\n#end\n\n#-------------------------------------------------------------------------------------\n# Rendering\n#-------------------------------------------------------------------------------------\n\n#-# [Since 1.8RC2]\n#-# Specifies how links labels are displayed when the user doesn't specify the label explicitly.\n#-# Valid values:\n#-#   %w: wiki name\n#-#   %s: full space name (e.g. space1.space2)\n#-#       Note: Prior to 7.4.2/8.0M2 this was only displaying the last space name\n#-#   %ls: last space name. New in 7.4.2/8.0M2\n#-#   %p: page name\n#-#   %np: nested page name (i.e. will display the space name for Nested Pages). New in 7.4.2/8.0M2\n#-#   %P: page name with spaces between camel case words, i.e. \"My Page\" if the page name is \"MyPage\"\n#-#   %NP: nested page name with spaces between camel case words, i.e. \"My Page\" if the page name is \"MyPage\".\n#-#        New in 7.4.2/8.0M2\n#-#   %t: page title\n#-#\n#-# Note that if the page title is empty or not defined then it defaults to %np. This is also the case\n#-# if the title cannot be retrieved for the document.\n#-#\n#-# The default is \"%np\". Some examples: \"%s.%p\", \"%w:%s.%p\".\n# rendering.linkLabelFormat = %np\n\n#-# [Since 2.0M3]\n#-# Overrides default macro categories (Each macro has a default category already defined, for example\n#-# \"presentation\" for the Table of Contents Macro).\n#-#\n#-# Ex: To redefine the macro category for the TOC macro so that it'd be in the \"My Category\" category +\n#-# redefine the category for the Script Macro to be \"My Other Category\", you'd use:\n# rendering.macroCategories = toc:My Category\n# rendering.macroCategories = script:My Other Category\n\n#-# [Since 2.5M2]\n#-# Specify whether the image dimensions should be extracted from the image parameters and included in the image URL\n#-# or not. When image dimensions are included in the image URL the image can be resized on the server side before being\n#-# downloaded, improving thus the page loading speed.\n#-#\n#-# Default value is true.\n# rendering.imageDimensionsIncludedInImageURL = true\n\n#-# [Since 2.5M2]\n#-# One way to improve page load speed is to resize images on the server side just before rendering the page. The\n#-# rendering module can use the image width provided by the user to scale the image (See\n#-# rendering.includeImageDimensionsInImageURL configuration parameter). When the user doesn't specify the image width\n#-# the rendering module can limit the width of the image based on this configuration parameter.\n#-#\n#-# The default value is -1 which means image width is not limited by default. Use a value greater than 0 to limit the\n#-# image width (pixels). Note that the aspect ratio is kept even when both the width and the height of the image are\n#-# limited.\n# rendering.imageWidthLimit = 1024\n# rendering.imageWidthLimit = -1\n\n#-# [Since 2.5M2]\n#-# See rendering.imageWidthLimit\n# rendering.imageHeightLimit = 768\n# rendering.imageHeightLimit = -1\n\n#-# [Since 2.5M2]\n#-# InterWiki definitions in the format alias = URL\n#-# See http://en.wikipedia.org/wiki/Interwiki_links for a definition of an InterWiki link\n# Some examples:\n# rendering.interWikiDefinitions = wikipedia = http://en.wikipedia.org/wiki/\n# rendering.interWikiDefinitions = definition = http://www.yourdictionary.com/\n\n#-# [Since 2.4M1]\n#-# Change the Pygments style used in the code macro (see http://pygments.org/docs/styles/)\n#-# If not set \"default\" style is used.\n# rendering.macro.code.pygments.style = vs\n\n#-------------------------------------------------------------------------------------\n# Rendering Transformations\n#-------------------------------------------------------------------------------------\n\n#-# [Since 2.6RC1]\n#-# Controls what transformations will be executed when rendering content.\n#-# A transformation modifies the parsed content. For example the Icon transformation replaces some characters with\n#-# icons, a WikiWord transformation will automatically create links when it finds wiki words, etc.\n#-# Note that the Macro transformation is a special transformation that replaces macro markers by the result of the\n#-# macro execution. If you don't list it, macros won't get executed.\n#-# The default value is: macro, icon\n#if ($xwikiRenderingTransformations)\nrendering.transformations = $xwikiRenderingTransformations\n#else\n# rendering.transformations = macro, icon\n#end\n\n#-# [Since 2.6RC1]\n#-# Icon Transformation Configuration\n#-# Defines mappings between suite of characters and the icon to display when those characters are found.\n#-# The format is: rendering.transformation.icon.mappings = <suite of characters> = <icon name>\n#-# The following mappings are already predefined and you don't need to redefine them unless you wish to override them\n#-# [Since 9.3RC1/8.4.5] To disable a default mapping, define it with an empty value. For example:\n#-#   rendering.transformation.icon.mappings = (n) =\n#-#\n#-# rendering.transformation.icon.mappings = :) = emoticon_smile\n#-# rendering.transformation.icon.mappings = :( = emoticon_unhappy\n#-# rendering.transformation.icon.mappings = :P = emoticon_tongue\n#-# rendering.transformation.icon.mappings = :D = emoticon_grin\n#-# rendering.transformation.icon.mappings = ;) = emoticon_wink\n#-# rendering.transformation.icon.mappings = (y) = thumb_up\n#-# rendering.transformation.icon.mappings = (n) = thumb_down\n#-# rendering.transformation.icon.mappings = (i) = information\n#-# rendering.transformation.icon.mappings = (/) = accept\n#-# rendering.transformation.icon.mappings = (x) = cancel\n#-# rendering.transformation.icon.mappings = (!) = error\n#-# rendering.transformation.icon.mappings = (+) = add\n#-# rendering.transformation.icon.mappings = (-) = delete\n#-# rendering.transformation.icon.mappings = (?) = help\n#-# rendering.transformation.icon.mappings = (on) = lightbulb\n#-# rendering.transformation.icon.mappings = (off) = lightbulb_off\n#-# rendering.transformation.icon.mappings = (*) = star\n\n#-------------------------------------------------------------------------------------\n# LinkChecker Transformation\n#-------------------------------------------------------------------------------------\n\n#-# [Since 3.3M2]\n#-# Defines the time (in ms) after which an external link should be checked again for validity.\n#-# the default configuration is:\n# rendering.transformation.linkchecker.timeout = 3600000\n\n#-# [Since 5.3RC1]\n#-# List of document references that are excluded from link checking, specified using regexes.\n#-# the default configuration is:\n# rendering.transformation.linkchecker.excludedReferencePatterns = .*:XWiki\\.ExternalLinksJSON\n\n#-------------------------------------------------------------------------------------\n# Rendering Macros\n#-------------------------------------------------------------------------------------\n\n#-# Velocity Macro\n\n#-# [Since 2.0M1]\n#-# Defines which Velocity Filter to use by default. This offers the possibility to filter the Velocity macro content\n#-# before and after the Velocity Engine execution.\n#-# The following filters are available:\n#-# - indent (the default): Remove all first whites spaces of lines to support source code indentation without\n#-#          generating whitespaces in the resulting XDOM.\n#-# - none: Doesn't change the content\n#-# - html: Removes all leading and trailing white spaces and new lines. If you need a space you'll need to use\n#-#         \\$sp and if you need a new line you'll need to use \\$nl\n#-# rendering.macro.velocity.filter = indent\n\n#-------------------------------------------------------------------------------------\n# Cache\n#-------------------------------------------------------------------------------------\n\n#-# [Since 1.7M1]\n#-# The standard cache component implementation to use (can be local or distributed depending on the implementation).\n#-# The default standard cache implementation is Infinispan.\n# cache.defaultCache = infinispan\n\n#-# [Since 1.7M1]\n#-# The local cache implementation to use.\n#-# The default local cache implementation is Infinispan.\n# cache.defaultLocalCache = infinispan/local\n\n#-------------------------------------------------------------------------------------\n# Settings for the OpenOffice server instance consumed by the OfficeImporter component\n#-------------------------------------------------------------------------------------\n\n#-# [Since 1.9M2]\n#-# Type of the openoffice server instance used by officeimporter component.\n#-# 0 - Internally managed server instance. (Default)\n#-# 1 - Externally managed (local) server instance.\n# openoffice.serverType = 0\n\n#-# [Since 12.1RC1]\n#-# Port numbers used for connecting to the openoffice server instance.\n#-# For an internally managed server instance, it will create the process for all ports.\n#-# For an externally managed server instance, only the first server port is taken into account.\n# openoffice.serverPorts = 8100,8101\n\n#-# [Since 1.9M2]\n#-# If the openoffice server should be started / connected upon XE start.\n#-# Default value is false\n# openoffice.autoStart = false\n\n#-# [Since 1.8RC3]\n#-# Path to openoffice installation (serverType:0 only).\n#-# If no path is provided, a default value will be calculated based on the operating environment.\n# openoffice.homePath = /opt/openoffice.org3/\n\n#-# [Since 1.8RC3]\n#-# Path to openoffice execution profile (serverType:0 only).\n#-# If no path is provided, a default value will be calculated based on the operating environment.\n# openoffice.profilePath = /home/user/.openoffice.org/3\n\n#-# [Since 1.8RC3]\n#-# Maximum number of simultaneous conversion tasks to be handled by a single openoffice process (serverType:0 only).\n#-# Default value is 50\n# openoffice.maxTasksPerProcess = 50\n\n#-# [Since 1.8RC3]\n#-# Timeout for conversion tasks (in milliseconds) (serverType:0 only).\n#-# Default value is 60 seconds\n# openoffice.taskExecutionTimeout = 60000\n\n#-------------------------------------------------------------------------------------\n# Velocity\n#-------------------------------------------------------------------------------------\n\n#-# [Since 2.0M1]\n#-# Velocity Tools that will be available from your scripts. The format is\n#-# velocity.tools = <name under which it'll be available in the context> = <class name>\n#-# Default values (no need to add them)\n#-#   velocity.tools = numbertool = org.xwiki.velocity.internal.XWikiNumberTool\n#-#   velocity.tools = datetool = org.xwiki.velocity.internal.XWikiDateTool\n#-#   velocity.tools = mathtool = org.xwiki.velocity.internal.XWikiMathTool\n#-#   velocity.tools = escapetool = org.apache.velocity.tools.generic.EscapeTool\n#-#   velocity.tools = regextool = org.xwiki.velocity.tools.RegexTool\n#-#   velocity.tools = collectiontool = org.xwiki.velocity.tools.CollectionTool\n#-#   velocity.tools = stringtool = org.xwiki.text.StringUtils\n#-#   velocity.tools = jsontool = org.xwiki.velocity.tools.JSONTool\n#-#   velocity.tools = urltool = org.xwiki.velocity.tools.URLTool\n#-#   velocity.tools = exceptiontool = org.apache.commons.lang3.exception.ExceptionUtils\n#-#   velocity.tools = niotool = org.xwiki.velocity.tools.nio.NIOTool\n#-#   velocity.tools = logtool = org.apache.velocity.tools.generic.LogTool\n#-#   velocity.tools = objecttool = org.xwiki.velocity.tools.ObjectTool\n#-#   velocity.tools = listtool = org.apache.velocity.tools.generic.ListTool (deprecated)\n#-#   velocity.tools = sorttool = org.apache.velocity.tools.generic.SortTool (deprecated)\n#-#   velocity.tools = collectionstool = org.xwiki.velocity.tools.CollectionsTool (deprecated)\n\n#-# [Since 2.0M1]\n#-# Velocity configuration properties. The format is\n#-# velocity.properties = <Velocity property name> = <value>\n#-# Default values (no need to add them)\n#-#   velocity.properties = resource.loader = xwiki\n#-#   velocity.properties = xwiki.resource.loader.class = org.xwiki.velocity.XWikiWebappResourceLoader\n#-#   velocity.properties = velocimacro.library = \"/templates/macros.vm\"\n#-#   velocity.properties = velocimacro.max_depth = 100\n#-#   velocity.properties = resource.manager.log_when_found = false\n#-#   velocity.properties = velocimacro.inline.local_scope = true\n#-#   velocity.properties = velocimacro.inline.replace_global = true\n#-#   velocity.properties = directive.if.empty_check = false\n#-#   velocity.properties = parser.space_gobbling = bc\n#-#   velocity.properties = parser.allow_hyphen_in_identifiers = true\n#-#   velocity.properties = velocimacro.enable_bc_mode = true\n#-#   velocity.properties = context.scope_control.template = true\n#-#   velocity.properties = context.scope_control.macro = true\n#-#   velocity.properties = event_handler.include.class = org.xwiki.velocity.internal.util.RestrictParseLocationEventHandler\n#-#   velocity.properties = runtime.introspection.uberspect = org.xwiki.velocity.introspection.SecureUberspector\\,org.apache.velocity.util.introspection.DeprecatedCheckUberspector\\,org.xwiki.velocity.introspection.MethodArgumentsUberspector\n\n#-------------------------------------------------------------------------------------\n# Groovy\n#-------------------------------------------------------------------------------------\n\n#-# [Since 4.1M1]\n#-# Allows to specify Compiler customization for the Groovy execution engine.\n#-# There's no customizers defined by default. Available customizer ids:\n#-# - timedinterrupt: interrupt script execution if it takes longer than a given time (default to 1 minute)\n#-# - secure: runs Groovy in a security sandbox\n#-# groovy.compilationCustomizers = <list of customizer ids here>\n\n#-# Timed Interrupt Customizer\n\n#-# [Since 4.1M1]\n#-# Default execution time for a script before a timeout occurs, in seconds.\n#-# groovy.customizer.timedInterrupt.timeout = 60\n\n#-------------------------------------------------------------------------------------\n# Events distribution\n#-------------------------------------------------------------------------------------\n\n#-# [Since 2.0M3]\n#-# Indicate if the network distribution module is enabled or not.\n#-# By default remote events are disabled.\n# observation.remote.enabled = false\n\n#-# [Since 2.0M3]\n#-# The list of events communication channels to start when the application starts.\n#-# By default no channel is configured.\n#-#\n#-# The default remote event distribution implementation is using JGroups and you'll need to either use embedded\n#-# JGroups configuration files or drop your custom configuration in the WEB-INF/observation/remote/jgroups/ directory.\n#-# There's a README file in that directory with more information.\n#-# Example: observation.remote.channels = public, cluster\n\n#-# [Since 2.0M4]\n#-# The implementation of network adapter to use.\n#-# The default is jgroups.\n#-#\n#-# By default only jgroups is provided. To add one implements NetworkAdaptor component interface. The identifier\n#-# provided in the configuration is matched with the component role hint.\n#-# Example: observation.remote.networkadapter = jgroups\n\n#-------------------------------------------------------------------------------------\n# CSRF token component\n#-------------------------------------------------------------------------------------\n\n#-# [Since 2.5M2]\n#-# Controls whether secret token validation mechanism should be used (to prevent CSRF attacks).\n#-#\n#-# If enabled, all actions requiring \"comment\", \"edit\", \"delete\", \"admin\" or \"programming\" rights\n#-# will check that the parameter \"form_token\" with the value of a random secret token is present\n#-# in the request.\n#-#\n#-# Valid values:\n#-#   true : Enabled\n#-#   false: Disabled\n#-#\n#-# Default value is true\n# csrf.enabled = true\n\n#-------------------------------------------------------------------------------------\n# Jobs\n#-------------------------------------------------------------------------------------\n\n#-# [Since 4.0M1]\n#-# The folder containing job executing status.\n#-# The default is {environment.permanentDirectory}/jobs/\n# job.statusFolder = /var/lib/xwiki/data/jobs/\n\n#-# [Since 7.2M2]\n#-# The maximum number of entries to put in the job status cache.\n#-# The default is 50.\n# job.statusCacheSize = 50\n\n#-# [Since 12.5RC1]\n#-# The maximum number of entries to put in cache for the GroupedJobInitializer components.\n#-# The default is 100.\n# job.groupedJobInitializerCacheSize = 100\n\n#-# [Since 12.5RC1]\n#-# The thread keep-alive time in milliseconds for the single job executor.\n#-# This value defines how long a thread can be idle before being terminated by the executor.\n#-# The default value is 60000 for 60 000ms.\n# job.singleJobThreadKeepAliveTime = 60000\n\n#-# [Since 12.5RC1]\n#-# The thread keep-alive time in milliseconds for the grouped job executors.\n#-# This value defines how long a thread can be idle before being terminated by an executor.\n#-# The default value is 60000 for 60 000ms.\n# job.groupedJobThreadKeepAliveTime = 60000\n\n#-------------------------------------------------------------------------------------\n# Extension Manager\n#-------------------------------------------------------------------------------------\n\n#-# [Since 2.5]\n#-# Repositories to use when searching and downloading extensions.\n#-# Repositories will be checked in the same order they have in this configuration file.\n#-#\n#-# The format is <id>:<type>:<url> where\n#-# * id can be anything as long as there is only one\n#-# * type is the type of the repository (maven, xwiki, etc.)\n#-# * url is the URL or the root of the repository\n#-#\n#-# [Since 4.3] It's also possible to associate various properties to each repository.\n#-# Here are the standard properties:\n#-# * user: the user to use to authenticate to the repository\n#-# * password: the password to use to authenticate to the repository\n#-# \n#-# And here those for \"maven\" repositories:\n#-# * [Since 10.7RC1] checksumPolicy: what to do when checksum validation fail. Possible values are \"fail\", \"warn\"\n#-#   (the default) and \"ignore\"\n#-#\n#-# Here is an example:\n# extension.repositories = privatemavenid:maven:http://host.com/private/maven/\n# extension.repositories.privatemavenid.auth.user = someuser\n# extension.repositories.privatemavenid.auth.password = thepassword\n#-#\n#-# Here's an example to add your local Maven Repository\n## Note: Since this file is parsed by Velocity in the Maven Remote Resource plugin we need to escape the\n## Apache Commons Configuration syntax for specifying the user.home system property!\n#set ($userHome = '${sys:user.home}')\n# extension.repositories = maven-local:maven:file://${userHome}/.m2/repository\n#-#\n#-# And an example to add the XWiki Maven Snapshot Repository\n# extension.repositories = maven-xwiki-snapshot:maven:https://nexus.xwiki.org/nexus/content/groups/public-snapshots\n#-#\n#-# When not set the following is taken (in this order):\n# extension.repositories = maven-xwiki:maven:https://nexus.xwiki.org/nexus/content/groups/public\n# extension.repositories = store.xwiki.com:xwiki:https://store.xwiki.com/xwiki/rest/\n# extension.repositories = extensions.xwiki.org:xwiki:https://extensions.xwiki.org/xwiki/rest/\n#-#\n#-# To not have any repository enabled (including disabling default repositories) you can explicitly make this list\n#-# empty:\n# extension.repositories=\n#if ($xwikiExtensionRepositories)\n#foreach ($extensionRepository in $xwikiExtensionRepositories.split(','))\nextension.repositories = $extensionRepository\n#end\n#end\n\n#-# [Since 2.5]\n#-# The directory where extensions are stored after being downloaded.\n#-#\n#-# The default is extension/repository in whatever is the general persistent directory.\n#-# See container.persistentDirectory.\n# extension.localRepository=extension/repository\n\n#-# [Since 3.4]\n#-# The user agent to use when communication with external services (generally repositories).\n#-#\n#-# The default is:\n# extension.userAgent=XWikiExtensionManager\n\n#-# [Since 7.1RC1]\n#-# Some extensions considered now as flavor but released before the category exists\n#-#\n#if ($xwikiPropertiesExtensionOldFlavors)\n#foreach($oldFlavor in $xwikiPropertiesExtensionOldFlavors.split(','))\nextension.oldflavors=$oldFlavor.trim()\n#end\n#else\n# extension.oldflavors=\n#end\n\n#-# [Since 8.3]\n#-# Indicate if XWiki should try to find more informations about the core extension in the repositories.\n#-#\n#-# The default is:\n# extension.core.resolve=true\n\n#-# [Since 9.6]\n#-# Indicate a list of pattern extension ids and the corresponding recommended version.\n#-# This version will be used for dependencies matching the pattern and fallback on the version declared by the\n#-# extension in case of failure.\n#-#\n#-# Here is an example:\n# extension.recommendedVersions=org.xwiki.commons:.*/[9.6]\n# extension.recommendedVersions=org.xwiki.rendering:.*/[9.6]\n# extension.recommendedVersions=org.xwiki.platform:.*/[9.6]\n# extension.recommendedVersions=com.mygroupid:.*/[1.9]\n\n#-# [Since 9.9]\n#-# Indicate whether the server should automatically check for new available environment versions.\n#-#\n#if ($xwikiPropertiesEnvironmentVersionCheck)\nextension.versioncheck.environment.enabled=$xwikiPropertiesEnvironmentVersionCheck\n#else\n#-# The default is:\n# extension.versioncheck.environment.enabled=false\n#end\n#-#\n#-# If the version check is enabled (through extension.versioncheck.environment.enabled), the following properties\n#-# can be used to customize how the version check is performed.\n#-#\n#-# Indicate the number of seconds between each check for a new version of the server.\n#-# The default is:\n# extension.versioncheck.environment.interval=3600\n#-#\n#-# Indicate a pattern that will be used to filter which version should be considered as a new version.\n#-# By default, no pattern is given an the pattern is not applied.\n#-# Example:\n# extension.versioncheck.environment.allowedVersions=9.*\n\n#-# [Since 10.5RC1]\n#-# Indicate how extension documents are protected.\n#-#\n#-# The possible choices are:\n#-# * none: no protection at all\n#-# * warning (the default): everyone get a warning when trying to edit a protected document\n#-# * deny = EDIT/DELETE right is denied for everyone except for admins who just get a warning\n#-# * forcedDeny = EDIT/DELETE right is denied for everyone, admins can't force edit/delete\n#-# * denySimple = EDIT/DELETE right is denied for simple users except for simple admins who just get a warning\n#-# * forcedDenySimple = EDIT/DELETE right is denied for all simple users, simple admins can't force edit/delete\n# extension.xar.protection=warning\n\n#-# [Since 12.2RC and 11.10.4]\n#-# Indicate a list of extension dependencies to ignore\n#-# \n#-# The default list is:\n# extension.ignoredDependencies=stax:stax\n# extension.ignoredDependencies=javax.xml.stream:stax-api\n# extension.ignoredDependencies=stax:stax-api\n# extension.ignoredDependencies=xalan:xalan\n# extension.ignoredDependencies=xalan:serializer\n\n#-------------------------------------------------------------------------------------\n# Distribution Wizard\n#-------------------------------------------------------------------------------------\n\n#-# [Since 7.1RC1] Enable or disable the automatic start of Distribution Wizard on empty/outdated wiki.\n#-#\n#-# The default is:\n# distribution.automaticStartOnMainWiki=true\n# distribution.automaticStartOnWiki=true\n\n#-#\u00a0[Since 10.2RC1] Control if the Distribution Wizard should be automatic or interactive (the default)\n#-# \n#-# On the main wiki\n# distribution.job.interactive=true\n#-# On the subwikis\n# distribution.job.interactive.wiki=true\n\n#-# [Since 10.2RC1] Override the default UI indicated in the \"environment extension\" (usually means the WAR).\n#-# It usually make more sense to set that at the WAR level (since it's usually synchronized with it).\n#-# If this is set it also means the Distribution Wizard will switch to default UI mode in which you cannot choose the\n#-# flavor.\n#-#\n#-# The id[/version] of the default UI for the main wiki. If the version is not indicated it will be the version of the\n#-# environment extension.\n# distribution.defaultUI=org.my.groupid:artifactid-mainwiki/1.5\n#-# The id[/version] default UI for the subwikis.  If the version is not indicated it will be the version of the\n#-# environment extension.\n# distribution.defaultWikiUI=org.my.groupid:artifactid-wiki/1.5\n\n#-------------------------------------------------------------------------------------\n# Solr Search\n#-------------------------------------------------------------------------------------\n\n#-# [Since 4.5M1]\n#-# The Solr server type. Currently accepted values are \"embedded\" (default) and \"remote\".\n# solr.type=embedded\n\n#-# [Since 4.5M1]\n#-# The location where the embedded Solr instance home folder is located.\n#-# The default is the subfolder \"store/solr\" inside folder defined by the property \"environment.permanentDirectory\".\n# solr.embedded.home=/var/local/xwiki/store/solr\n\n#-# [Since 12.2]\n#-# The URL of the Solr server (the root server and not the URL of a core).\n#-# The default value assumes that the remote Solr server is started in a different process on the same machine,\n#-# using the default port.\n# solr.remote.baseURL=http://localhost:8983/solr\n\n#-# [Since 12.6]\n#-# The prefix to add in front on each remote core name to avoid collisions with non-XWiki cores.\n#-# The default is \"xwiki\" which will produce names likes \"xwiki_events\" for example.\n# solr.remote.corePrefix=xwiki\n\n#-# [Since 5.1M1]\n#-# Elements to index are not sent to the Solr server one by one but in batch to improve performances.\n#-# It's possible to configure this behavior with the following properties:\n#-#\n#-# The maximum number of elements sent at the same time to the Solr server\n#-# The default is 50.\n# solr.indexer.batch.size=50\n#-# The maximum number of characters in the batch of elements to send to the Solr server.\n#-# The default is 10000.\n# solr.indexer.batch.maxLength=10000\n\n#-# [Since 5.1M1]\n#-# The maximum number of elements in the background queue of elements to index/delete\n#-# The default is 10000.\n# solr.indexer.queue.capacity=100000\n\n#-# [Since 6.1M2]\n#-# Indicates if a synchronization between SOLR index and XWiki database should be performed at startup.\n#-# Synchronization can be started from the search administration UI.\n#-# The default is true.\n# solr.synchronizeAtStartup=false\n\n#-# [Since 12.5RC1]\n#-# Indicates which wiki synchronization to perform when the \"solr.synchronizeAtStartup\" property is set to true.\n#-# Two modes are available:\n#-#   - WIKI: indicate that the synchronization is performed when each wiki is accessed for the first time.\n#-#   - FARM: indicate that the synchronization is performed once for the full farm when XWiki is started.\n#-# For large farms and in order to spread the machine's indexing load, the WIKI value is recommended, especially if\n#-# some wikis are not used.\n#-# The default is:\n# solr.synchronizeAtStartupMode=FARM\n\n#-------------------------------------------------------------------------------------\n# Security\n#-------------------------------------------------------------------------------------\n\n#-# [Since 5.0M2]\n#-# Define the authorization policies by choosing another implementation of the AuthorizationSettler. This component\n#-# is solely responsible for settling access decisions based on user, target entity and available security rules.\n#-# The identifier provided here is matched with the component role hint.\n#-#\n#-# The default is:\n# security.authorization.settler=default\n\n#-------------------------------------------------------------------------------------\n# URL\n#-------------------------------------------------------------------------------------\n\n#-# IMPORTANT: The URL module is a feature still in development and as such should be considered experimental at the\n#-# moment. The configuration parameters below are used only in some part of the code at the moment. The idea is to\n#-# progressively refactor more and more till only the new properties are used. For the moment you should continue to\n#-# use the following old properties located in xwiki.cfg:\n#-#  xwiki.virtual.usepath\n#-#  xwiki.virtual.usepath.servletpath\n\n#-# [Since 5.1M1]\n#-# The id of the URL format to use. This allows to plug in different implementations and thus allows to completely\n#-# control the format of XWiki URLs.\n#-#\n#-# The default is:\n# url.format=standard\n\n#-# [Since 5.1M1]\n#-# Defines where the wiki part is defined in a URL pointing to a subwiki\n#-# If true then the wiki part is located in the URL path (a.k.a path-based), for example:\n#-#   http://server/xwiki/wiki/mywiki/view/Space/Page\n#-# If false then the wiki part is located in the URL host domain (a.k.a domain-based), for example:\n#-#   http://mywiki.domain/xwiki/bin/view/Space/Page\n#-#\n#-# The default is:\n# url.standard.multiwiki.isPathBased=true\n\n#-# [Since 5.1M1]\n#-# For path-based setups, this property defines the path segment before the one identifying the subwiki in the URL.\n#-# For example if set to \"thewiki\", then the following URL will point to a subwiki named \"mywiki\":\n#-#   http://server/xwiki/thewiki/mywiki/view/Space/Page\n#-# Note that the mapping in web.xml has to be modified accordingly if you don't use the default value:\n#-#   <servlet-mapping>\n#-#     <servlet-name>action</servlet-name>\n#-#     <url-pattern>/wiki/*</url-pattern>\n#-#   </servlet-mapping>\n#-#\n#-# The default is:\n# url.standard.multiwiki.wikiPathPrefix=wiki\n\n#-# [Since 5.2M1]\n#-# Defines the URL path prefix used for Entity URLs, i.e. URLs pointing to a Document, Space, Object, etc.\n#-# For example this is the \"bin\" part in the following URL:\n#-#   http://server/xwiki/bin/view/space/page\n#-# Note that this replaces the old xwiki.defaultservletpath property in the xwiki.cfg file.\n#-#\n#-# The default is:\n# url.standard.entityPathPrefix=bin\n\n#-# [Since 5.3M1]\n#-# The action to take when a subwiki is not found (ie there's no wiki descriptor for it). Valid values are:\n#-# - redirect_to_main_wiki: default to displaying the main wiki\n#-# - display_error: redirect to a vm to display an error\n#-#\n#-# The default is:\n# url.standard.multiwiki.notFoundBehavior=redirect_to_main_wiki\n\n#-# [Since 7.2M1]\n#-# Whether the \"view\" action is omitted in URLs (in order to have shorter URLs).\n#-# Note that this replaces the old xwiki.showviewaction property in the xwiki.cfg file.\n#-#\n#-# The default is:\n# url.standard.hideViewAction=false\n\n#-# [Since 11.1RC1]\n#-# Whether a the last modified date of the file to be loaded should be checked and put in the URL query parameter.\n#-# Disabling this might improve a bit the performance on some old hard drives, or custom filesystem, however\n#-# it might imply the need to force-reload some resources in the browser, when migrating.\n#-#\n#-# The default is:\n# url.useResourceLastModificationDate=true\n\n#-------------------------------------------------------------------------------------\n# Attachment\n#-------------------------------------------------------------------------------------\n\n#-# [Since 5.2M2]\n#-# Define the kind of attachment that can be displayed inline. You can either choose to do it through a whitelist\n#-# (only the mimetypes defined in this list would be displayed inline) or a blacklist (every mimetype that is not in\n#-# this list would be displayed inline if possible).\n#-# Note that only one configuration is used between the whitelist and the blacklist, and the whitelist always have\n#-# the priority over the blacklist. Also note that these configurations exist for security reason so they are only\n#-# impacting attachments added by users who do not have programming rights.\n#-# If you want to force downloading some attachments types please check the configuration below.\n#-#\n#-# By default we use the following whitelist (coma separated list of values).\n# attachment.download.whitelist=audio/basic,audio/L24,audio/mp4,audio/mpeg,audio/ogg,audio/vorbis,audio/vnd.rn-realaudio,audio/vnd.wave,audio/webm,image/gif,image/jpeg,image/pjpeg,image/png,image/tiff,text/csv,text/plain,text/xml,text/rtf,video/mpeg,video/ogg,video/quicktime,video/webm,video/x-matroska,video/x-ms-wmv,video/x-flv\n#-#\n#-# If you prefer to use a blacklist instead, you can define the forbidden types here, as a coma separated list of\n#-# values. We advise you to forbid at least the following mimetypes : text/html, text/javascript\n# attachment.download.blacklist=text/html,text/javascript\n\n#-# [Since 12.10]\n#-# Define the kind of attachment that you always want to be downloaded and never displayed inline.\n#-# By default this list is empty, but you can specify a list of mime-types (coma separated list of values) which\n#-# should be always downloaded no matter who attached them or what is the whitelist/blacklist configuration.\n#-#\n#-# The distinction with the blacklist configuration above is that the blacklist won't affect file attached by a user\n#-# with programming rights, while this configuration affect any attachment.\n# attachment.download.forceDownload=\n\n#-------------------------------------------------------------------------------------\n# Active Installs\n#-------------------------------------------------------------------------------------\n\n#-# [Since 5.2M2]\n#-# The URL of where the Active Installs module should connect to in order to send a ping of activity. This feature\n#-# regularly sends the following information to xwiki.org about the current instance:\n#-# - its unique id\n#-# - the id and versions of all installed extensions)\n#-# The goal is to count the number of active installs of XWiki out there and provide statistics on xwiki.org\n#-#\n#-# The default is:\n# activeinstalls.pingURL=http://extensions.xwiki.org/activeinstalls\n\n#-------------------------------------------------------------------------------------\n# Wikis\n#-------------------------------------------------------------------------------------\n\n#-# [Since 5.4.4]\n#-# Add a default suffix to the alias of a new wiki in the wiki creation wizard, only when the path mode is not used\n#-# (i.e. domain-based, see url.standard.multiwiki.isPathBased). If this value is empty, XWiki will try to compute it\n#-# automatically from the request URL.\n#-#\n#-# eg: if wiki.alias.suffix is \"xwiki.org\" and the wiki name is \"playground\"\n#-#     then the computed alias will be: \"playground.xwiki.org\".\n#-#\n#-# The default is:\n# wiki.alias.suffix=\n\n#-------------------------------------------------------------------------------------\n# Store\n#-------------------------------------------------------------------------------------\n\n#-# [Since 6.1M2]\n#-# If active, the Filesystem Attachment Store will automatically clear empty directories on startup,\n#-# in some cases this may create undue load on the server and may need to be disabled. To do that,\n#-# set the following to false.\n#-# Note that if you disable this feature, empty directories will accumulate and you are responsible\n#-# for cleaning them up.\n# store.fsattach.cleanOnStartup=true\n\n#-# [Since 11.4RC1]\n#-# The root directory used by the various \"file\" stores implementation (attachment, deleted document, etc.).\n#-# \n#-# The default is ${environment.permanentDirectory}/store/file.\n#if ($xwikiPropertiesStoreFileDirectory)\nstore.file.directory=$xwikiPropertiesStoreFileDirectory\n#else\n# store.file.directory=/var/lib/xwiki/data/store/file/\n#end\n\n#-------------------------------------------------------------------------------------\n# Mail\n#-------------------------------------------------------------------------------------\n\n#-# [Since 6.1M2]\n#-# SMTP host when sending emails, defaults to \"localhost\".\n#-# This configuration property can be overridden in XWikiPreferences objects, by using the \"smtp_server\" property name.\n# mail.sender.host = localhost\n\n#-# [Since 6.1M2]\n#-# SMTP port when sending emails, defaults to 25.\n#-# This configuration property can be overridden in XWikiPreferences objects, by using the \"smtp_port\" property name.\n# mail.sender.port = 25\n\n#-# [Since 6.1M2]\n#-# From email address to use. Not defined by default and needs to be set up when calling the mail API.\n#-# This configuration property can be overridden in XWikiPreferences objects, by using the \"admin_email\" property name.\n# mail.sender.from = john@doe.com\n\n#-# [Since 6.1M2]\n#-# Username to authenticate on the SMTP server, if needed. By default no authentication is performed.\n#-# This configuration property can be overridden in XWikiPreferences objects, by using the \"smtp_server_username\"\n#-# property name.\n# mail.sender.username = someuser\n\n#-# [Since 6.1M2]\n#-# Password to authenticate on the SMTP server, if needed. By default no authentication is performed.\n#-# This configuration property can be overridden in XWikiPreferences objects, by using the \"smtp_server_password\"\n#-# property name.\n# mail.sender.password = somepassword\n\n#-# [Since 6.1M2]\n#-# Extra Java Mail options (see https://javamail.java.net/nonav/docs/api/).\n#-# This configuration property can be overridden in XWikiPreferences objects, by using the \"javamail_extra_props\"\n#-# property name.\n#-# By default the following properties are set automatically:\n#-#   mail.transport.protocol = smtp\n#-#   mail.smtp.host = <value of the mail.sender.host property>\n#-#   mail.smtp.port = <value of the mail.sender.port property>\n#-#   mail.smtp.user = <value of the mail.sender.username property>\n#-#   mail.smtp.from = <value of the mail.sender.from property>\n#-# Example:\n# mail.sender.properties = mail.smtp.starttls.enable = true\n# mail.sender.properties = mail.smtp.socks.host = someserver\n\n#-# [Since 6.4M2]\n#-# Defines which authorization checks are done when sending mails using the Mail Sender Script Service.\n#-# Example of valid values:\n#-# - \"programmingrights\": the current document must have Programming Rights\n#-# - \"alwaysallow\": no check is performed. This is useful when running XWiki in a secure environment where we\n#-#   want to allow all users to be able to send emails through the Script Service.\n#-# The default is:\n# mail.sender.scriptServiceCheckerHint = programmingrights\n\n#-# [Since 6.4M2]\n#-# optional default email addresses to add to the BCC mail header when sending email.\n# mail.sender.bcc = john@doe.com,mary@doe.com\n\n#-# [Since 6.4RC1]\n#-# The delay to wait between each mail being sent, in milliseconds. This is done to support mail throttling and not\n#-# be considered a spammer by mail servers.\n#-# The default is 8 seconds:\n# mail.sender.sendWaitTime = 8000\n\n#-# [Since 6.4.1, 7.0M1]\n#-# When using the Database Mail Listener, whether mail statuses for mails that have been sent successfully must be\n#-# discarded or not. They could be kept for tracability purpose for example.\n#-# The default is:\n# mail.sender.database.discardSuccessStatuses = true\n\n#-# [Since 11.6RC1]\n#-# Max queue size for the prepare mail thread. When the max size is reached, asynchronously sending a mail will block\n#-# till the first mail item in the prepare queue has been processed.\n# mail.sender.prepareQueueCapacity = 1000\n\n#-# [Since 11.6RC1]\n#-# Max queue size for the send mail thread. When the max size is reached, the prepare queue will block till the first\n# mail item in the send queue has been sent.\n# mail.sender.sendQueueCapacity = 1000\n\n#-# [Since 12.9RC1]\n#-# Decides if XWiki should resend automatically mails that were prepared but not sent, at restart.\n#-# Note that emails that were in the prepare_error state are not resent since they failed to be saved and thus cannot\n#-# be resent.\n# mail.sender.database.resendAutomaticallyAtStartup = true\n\n#-------------------------------------------------------------------------------------\n# Debug\n#-------------------------------------------------------------------------------------\n\n#-# [Since 7.0RC1]\n#-# Indicate if web resources should be loaded minified by default.\n#-# It's enabled by default which can make js/css hard to read.\n# debug.minify=false\n\n#-------------------------------------------------------------------------------------\n# LESS CSS\n#-------------------------------------------------------------------------------------\n\n#-# [Since 7.4.2, 8.0M2]\n#-# The number of LESS compilations that can be performed simultaneously. Put a little number if your resources are\n#-# limited.\n#-#\n#-# The default is:\n# lesscss.maximumSimultaneousCompilations = 4\n\n#-# [Since 8.0RC1]\n#-# Generate sourcemaps inline in the CSS files.\n#-#\n#-# The default is:\n# lesscss.generateInlineSourceMaps = false\n\n#-------------------------------------------------------------------------------------\n# Edit\n#-------------------------------------------------------------------------------------\n\n#-# [Since 8.2RC1]\n#-# Indicate the default editor to use for a specific data type.\n#-# The editors are components so they are specified using their role hints.\n#-# Some data types can be edited in multiple ways, by different types of editors.\n#-# Thus you can also indicate the default editor to use from a specific category (editor type).\n#-#\n#-# The format is this:\n#-# edit.defaultEditor.<dataType>=<roleHintOrCategory>\n#-# edit.defaultEditor.<dataType>#<category>=<roleHintOrSubCategory>\n#-#\n#-# The default bindings are:\n# edit.defaultEditor.org.xwiki.rendering.syntax.SyntaxContent=text\n# edit.defaultEditor.org.xwiki.rendering.syntax.SyntaxContent#text=text\n# edit.defaultEditor.org.xwiki.rendering.block.XDOM=text\n# edit.defaultEditor.org.xwiki.rendering.block.XDOM#text=text\n#if ($xwikiPropertiesDefaultWysiwygEditor)\nedit.defaultEditor.org.xwiki.rendering.syntax.SyntaxContent#wysiwyg=$xwikiPropertiesDefaultWysiwygEditor\nedit.defaultEditor.org.xwiki.rendering.block.XDOM#wysiwyg=$xwikiPropertiesDefaultWysiwygEditor\n#end\n\n#-# [Since 11.3.2, 11.6RC1]\n#-# Indicate if the mechanism to detect and handle edition conflicts should be enabled or not.\n#-# If disabled, it means that in case of edition conflicts, the latest save will be always take into account, and\n#-# erase previous data (which can always be recovered in the history of the document).\n#-# This option is provided because the feature is still experimental and it could be useful is some specific usecases\n#-# to switch it off. However it is not recommended to do so.\n#-#\n#-# The default is:\n# edit.conflictChecking.enabled = true\n\n#-# [Since 12.5]\n#-# Indicate if the XWiki documents should be edited in-place, without leaving the view mode, whenever possible (e.g. if\n#-# the default edit mode for that document and the preferred editor both support in-place editing). When enabled,\n#-# clicking on the document Edit button makes the document title and content editable in-place, without leaving the\n#-# view mode. When disabled, clicking on the document Edit button loads the default (stand-alone) edit mode for that\n#-# document.\n#-#\n#-# The default is:\n# edit.document.inPlaceEditing.enabled = true\n\n#-------------------------------------------------------------------------------------\n# Notifications\n#-------------------------------------------------------------------------------------\n\n#-# [Since 9.4RC1]\n#-# Indicates if the notifications module should be enabled on the platform.\n#-#\n#-# The default is :\n# notifications.enabled = true\n\n#-# [Since 9.5C1]\n#-# Indicates if the notifications module can send emails.\n#-#\n#-# The default is :\n# notifications.emails.enabled = true\n\n#-# [Since 9.6RC1]\n#-# Indicate the grace time used when sending live email notifications.\n#-# When an event is triggered in the wiki (for example, a document update), the platform will wait X minutes\n#-# before sending live notifications emails. During this time, if events of the same kind are recieved, they will\n#-# be grouped in the same email.\n#-#\n#-# The grace time define the period (in minutes) for which the platform should wait before sending a notification\n#-# mail after an event.\n#-#\n#-# The default is :\n# notifications.emails.live.graceTime = 10\n\n#-# [Since 9.8RC1]\n#-# Indicate if the \"watched entities\" feature is enabled on the platform.\n#-# This feature mimics what the \"Watchlist Application\" does so it may not be a good idea to have both on the platform.\n#-#\n#-# The default is :\n# notifications.watchedEntities.enabled = true\n\n#-# [Since 9.11.8]\n#-# [Since 10.6RC1]\n#-# The automatic watch mode used by default. The value can be changed by an administrator in the wiki's administration\n#-# or by any user in their own settings.\n#-#\n#-# Possible values:\n#-#\n#-# - none:  no page is added to the list of watched pages automatically.\n#-# - all:   everytime a user makes a change on a page, it is automatically added to her list of watched pages.\n#-# - major: everytime a user makes a major change on a page, it is automatically added to her list of watched pages.\n#-# - new:   only pages created by a user are added to her list of watched pages.\n#-#\n#-# The default is :\n# notifications.watchedEntities.autoWatch = major\n\n#-# [Since 10.11.4]\n#-# [Since 11.2]\n#-# The search for notifications in the REST API is done trough a thread pool to limit the impact on the rest of the\n#-# XWiki instance.\n#-# This properties controls the size of this pool. Any number lower than 1 disable the thread pool system.\n#-# \n#-# The default is :\n# notifications.rest.poolSize = 2\n\n#-# [Since 10.11.8]\n#-# [Since 11.3]\n#-# Enable or disable caching of notification search result in the REST or async API.\n#-# \n#-# The default is :\n# notifications.rest.cache = true\n\n#-# [Since 12.6]\n#-# When this option is enabled the relation between users and events is evaluated and stored when the events are\n#-# generated instead of each time they are displayed.\n#-#\n#-# The default is :\n# notifications.eventPrefilteringEnabled = true\n\n#-# [Since 12.5RC1]\n#-# The async notifications renderer is using a dedicated thread pool to limit the impact on the rest of the XWiki\n#-# instance.\n#-# This properties controls the size of this pool.\n#-#\n#-# The default is :\n# notifications.async.poolSize = 2\n\n#-------------------------------------------------------------------------------------\n# Mentions\n#-------------------------------------------------------------------------------------\n\n#-# [Since 12.6]\n#-# The detection and notification for the user mentions in created or edited content is done asynchronously \n#-# by a pool of consumers.\n#-# This properties controls the size of this pool.\n#-#\n#-# The default is :\n# mentions.poolSize = 1\n\n#-------------------------------------------------------------------------------------\n# Event Stream\n#-------------------------------------------------------------------------------------\n\n#-# [Since 11.1RC1]\n#-# The Event Stream, on which the notifications are based, stores data in a dedicated table in the database.\n#-#\u00a0Each wiki has its own database. The feature can be configured to store its data into the database corresponding to\n#-# the wiki, into the main database (default: xwiki) or both. These options should not be both set to false (in this\n#-# case the local store will be forced).\n#-# Important note: disabling storage in the main store will prevent the notifications from retrieving events from\n#-# subwikis. Moreover, disabling the main store makes impossible for global users to watch pages from subwikis. It is\n#-# not recommended.\n#-#\n#-# This feature was originally implemented by the Activity Stream plugin so these settings might sound familiar to you.\n#-#\n#-# The default is :\n# eventstream.uselocalstore = true\n#-#\n#-# The default is :\n# eventstream.usemainstore = true\n#-#\n#-# Number of days the events should be kept (0 or any negative value: infinite duration)\n#-# Note: if this value is greater than 0 a scheduler job will be created, this job will then be fired every week to\n#-# delete events older than the configured value.\n#-# The default is :\n# eventstream.daystokeepevents = 0\n\n#-# [Since 12.4]\n#-# Indicate if the new no-SQL oriented event store is enabled. Once enabled the Solr implementation is\n#-# used by default but other implementations (like a MongoDB based implementation for example) might come later.\n#-# It's enabled by default since 12.6.\n# eventstream.store.enabled = true\n#-# Indicate which event store implementation to use. The default implementation is based on Solr.\n# eventstream.store = solr\n\n#-------------------------------------------------------------------------------------\n# Logging\n#-------------------------------------------------------------------------------------\n\n#-# [Since 12.0RC1]\n#-# Indicate of logging about the use of deprecated APIs/feature should be enabled.\n#-# \n#-# The default is:\n# logging.deprecated.enabled = true\n\n#-------------------------------------------------------------------------------------\n# User\n#-------------------------------------------------------------------------------------\n\n#-# [Since 12.2]\n#-# Indicate where users are stored.\n#-#\n#-# The default (and currently the only supported option) is:\n# user.store.hint = document\n\n#-# [Since 12.2]\n#-# Define preferences for the SuperAdmin user.\n#-#\n#-# The format is:\n#-# user.preferences.superadmin.<preference name> = <value>\n#-#\n#-# Examples:\n#-# user.preferences.superadmin.displayHiddenDocuments = 0\n#-# user.preferences.superadmin.editor = Text\n\n#-# [Since 12.2]\n#-# Define preferences for the Guest user.\n#-#\n#-# The format is:\n#-# user.preferences.guest.<preference name> = <value>\n#-#\n#-# Examples:\n#-# user.preferences.guest.displayHiddenDocuments = 1\n#-# user.preferences.guest.editor = Text\n\n#-------------------------------------------------------------------------------------\n# Refactoring\n#-------------------------------------------------------------------------------------\n\n#-# [Since 12.5RC1]\n#-# Indicate to use the old implementation based on copy and delete, or the new implementation using an atomic operation\n#-# on database (which is a lot more performant).\n#-# This property aims at being removed in the future once the atomic rename has been validated to work 100% fine.\n#-# Only use it if you are facing an issue with the move/rename features.\n#-#\n#-# The default value is:\n# refactoring.rename.useAtomicRename = true\n\n#-# [Since 12.9RC1]\n#-# Indicates whether skipping the recycle bin when deleting pages is allowed for Advanced users.\n#-# It is disabled by default.\n#-# This setting is only used if the wiki has a recycle bin activated (xwiki.recyclebin=1 in xwiki.cfg).\n#-# This setting can be overloaded:\n#-# * By the main wiki in the Refactoring.Code.RefactoringConfigurationClass class of the\n#-#   Refactoring.Code.RefactoringConfiguration document of the main wiki.\n#-# * By sub-wikis in the Refactoring.Code.RefactoringConfigurationClass class of the\n#-#   Refactoring.Code.RefactoringConfiguration document of the sub-wikis (itself overloading the main wiki's\n#-#   configuration).\n#-#\n#-# The default value is:\n# refactoring.isRecycleBinSkippingActivated = false\n\n#-------------------------------------------------------------------------------------\n# Skin Extensions\n#-------------------------------------------------------------------------------------\n\n#-# [Since 12.7.1, 12.8RC1]\n#-# Indicate whether the JavaScript skin extensions should be parsed and minified using strict mode. When strict mode is\n#-# enabled:\n#-# * the JavaScript minification may fail if the code is poorly written. See\n#-#   https://github.com/google/closure-compiler/wiki/Warnings for a list of errors that may occur. When this happens\n#-#   XWiki uses the original (unminified) JavaScript source as a fall-back and logs some error messages that indicate\n#-#   how the bad code can be fixed.\n#-# * the minified JavaScript includes the \"use strict;\" statement which means the code may fail at runtime if it doesn't\n#-#   follow the ECMAScript strict rules. See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Strict_mode\n#-#\n#-# The default value is:\n# skinx.jsStrictModeEnabled = false\n\n$!xwikiPropertiesAdditionalProperties"], "filenames": ["xwiki-platform-core/xwiki-platform-oldcore/src/main/java/com/xpn/xwiki/web/DownloadAction.java", "xwiki-platform-tools/xwiki-platform-tool-configuration-resources/src/main/resources/xwiki.properties.vm"], "buggy_code_start_loc": [77, 752], "buggy_code_end_loc": [78, 753], "fixing_code_start_loc": [77, 752], "fixing_code_end_loc": [78, 753], "type": "CWE-79", "message": "XWiki is a generic wiki platform offering runtime services for applications built on top of it. When using default XWiki configuration, it's possible for an attacker to upload an SVG containing a script executed when executing the download action on the file. This problem has been patched so that the default configuration doesn't allow to display the SVG files in the browser. Users are advised to update or to disallow uploads of SVG files.", "other": {"cve": {"id": "CVE-2021-43841", "sourceIdentifier": "security-advisories@github.com", "published": "2022-02-04T23:15:11.957", "lastModified": "2022-02-10T01:26:19.653", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "XWiki is a generic wiki platform offering runtime services for applications built on top of it. When using default XWiki configuration, it's possible for an attacker to upload an SVG containing a script executed when executing the download action on the file. This problem has been patched so that the default configuration doesn't allow to display the SVG files in the browser. Users are advised to update or to disallow uploads of SVG files."}, {"lang": "es", "value": "XWiki es una plataforma wiki gen\u00e9rica que ofrece servicios de tiempo de ejecuci\u00f3n para aplicaciones construidas sobre ella. Cuando es usada la configuraci\u00f3n predeterminada de XWiki, es posible que un atacante cargue un SVG que contenga un script ejecutado cuando es ejecutada la acci\u00f3n de descarga en el archivo. Este problema ha sido parcheado para que la configuraci\u00f3n por defecto no permita mostrar los archivos SVG en el navegador. Se aconseja a usuarios que actualicen o desestimen la carga de archivos SVG"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "1.0", "versionEndExcluding": "12.10.6", "matchCriteriaId": "630B41D7-65F8-4DCE-B907-4D9728F96EF5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "13.0", "versionEndIncluding": "13.2", "matchCriteriaId": "C03AD841-1825-465A-9149-F4F7840A5EEC"}]}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/5853d492b3a274db0d94d560e2a5ea988a271c62", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9jq9-c2cv-pcrj", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://jira.xwiki.org/browse/XWIKI-18368", "source": "security-advisories@github.com", "tags": ["Exploit", "Patch", "Vendor Advisory"]}, {"url": "https://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Attachments#HAttachmentdisplayordownload", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}]}, "github_commit_url": "https://github.com/xwiki/xwiki-platform/commit/5853d492b3a274db0d94d560e2a5ea988a271c62"}}