{"buggy_code": ["(function (mw, $) {\n\t\"use strict\";\n\n\tmw.PluginManager.add('share', mw.KBaseScreen.extend({\n\n\t\tdefaultConfig: {\n\t\t\tparent: \"topBarContainer\",\n\t\t\torder: 5,\n\t\t\talign: \"right\",\n\t\t\ttooltip:  gM( 'mwe-embedplayer-share' ),\n\t\t\ttitle:  gM( 'mwe-embedplayer-share' ),\n\t\t\tshowTooltip: true,\n\t\t\tdisplayImportance: 'medium',\n\t\t\ttemplatePath: 'components/share/share.tmpl.html',\n\n\t\t\tusePreviewPlayer: false,\n\t\t\tpreviewPlayerEnabled: false,\n\n\t\t\tsocialShareEnabled: true,\n\t\t\tembedEnabled: true,\n\t\t\tallowTimeOffset: true,\n\t\t\tallowSecuredEmbed: true,\n\t\t\temailEnabled: true,\n\n\t\t\tsocialShareURL: 'smart', // 'parent' or 'http://custom.url/entry/{mediaProxy.entry.id}'\n\t\t\tsocialNetworks: 'facebook,twitter,googleplus,email,linkedin,sms',\n\t\t\tshareUiconfID: null,\n\t\t\tshareConfig: {\n\t\t\t\t\"facebook\": {\n\t\t\t\t\t\"name\": \"Facebook\",\n\t\t\t\t\t\"icon\": \"\",\n\t\t\t\t\t\"cssClass\": \"icon-share-facebook\",\n\t\t\t\t\t\"template\": \"https://www.facebook.com/sharer/sharer.php?u={share.shareURL}\",\n\t\t\t\t\t\"redirectUrl\": 'fb://feed/',\n\t\t\t\t\t\"barColor\": '#394F8F'\n\t\t\t\t},\n\t\t\t\t\"twitter\": {\n\t\t\t\t\t\"name\": \"Twitter\",\n\t\t\t\t\t\"icon\": \"\",\n\t\t\t\t\t\"cssClass\": \"icon-share-twitter\",\n\t\t\t\t\t\"template\": \"https://twitter.com/share?url={share.shareURL}\",\n\t\t\t\t\t\"redirectUrl\": 'https://twitter.com/intent/tweet/complete?,https://twitter.com/intent/tweet/update',\n\t\t\t\t\t\"barColor\": '#39BAB6'\n\t\t\t\t},\n\t\t\t\t\"googleplus\": {\n\t\t\t\t\t\"name\": \"Google+\",\n\t\t\t\t\t\"icon\": \"\",\n\t\t\t\t\t\"cssClass\": \"icon-share-google\",\n\t\t\t\t\t\"template\": \"https://plus.google.com/share?url={share.shareURL}\",\n\t\t\t\t\t\"redirectUrl\": 'https://plus.google.com/app/basic/stream',\n\t\t\t\t\t\"barColor\": '#CB2726'\n\t\t\t\t},\n\t\t\t\t\"email\": {\n\t\t\t\t\t\"name\": \"Mail\",\n\t\t\t\t\t\"icon\": \"\",\n\t\t\t\t\t\"cssClass\": \"icon-share-email\",\n\t\t\t\t\t\"template\": \"mailto:?subject=Check out {mediaProxy.entry.name}&body=Check out {mediaProxy.entry.name}: {share.shareURL}\",\n\t\t\t\t\t\"redirectUrl\": '',\n\t\t\t\t\t\"barColor\": '#394F8F'\n\t\t\t\t},\n\t\t\t\t\"linkedin\": {\n\t\t\t\t\t\"name\": \"LinkedIn\",\n\t\t\t\t\t\"icon\": \"\",\n\t\t\t\t\t\"cssClass\": \"icon-share-linkedin\",\n\t\t\t\t\t\"template\": \"http://www.linkedin.com/shareArticle?mini=true&url={share.shareURL}\",\n\t\t\t\t\t\"redirectUrl\": '',\n\t\t\t\t\t\"barColor\": '#222222'\n\t\t\t\t},\n\t\t\t\t\"sms\": {\n\t\t\t\t\t\"name\": \"Message\",\n\t\t\t\t\t\"icon\": \"\",\n\t\t\t\t\t\"cssClass\": \"icon-share-sms\",\n\t\t\t\t\t\"template\": \"Check out {mediaProxy.entry.name}: {share.shareURL}\",\n\t\t\t\t\t\"redirectUrl\": '',\n\t\t\t\t\t\"barColor\": '#394F8F'\n\t\t\t\t}\n\t\t\t},\n\t\t\tembedCodeTemplate: '<iframe src=\"' + mw.getConfig(\"Kaltura.ServiceUrl\") + '/p/{mediaProxy.entry.partnerId}/sp/{mediaProxy.entry.partnerId}00/embedIframeJs/uiconf_id/{configProxy.kw.uiConfId}/partner_id/{mediaProxy.entry.partnerId}?iframeembed=true&playerId={configProxy.targetId}&entry_id={mediaProxy.entry.id}&flashvars[streamerType]=auto\" width=\"560\" height=\"395\" allowfullscreen webkitallowfullscreen mozAllowFullScreen allow=\"autoplay *; fullscreen *; encrypted-media *\" frameborder=\"0\"></iframe>',\n\t\t\tembedOptions: {\n\t\t\t\t\"streamerType\": \"auto\",\n\t\t\t\t\"uiconfID\": null,\n\t\t\t\t\"width\": 560,\n\t\t\t\t\"height\": 395,\n\t\t\t\t\"borderWidth\": 0\n\t\t\t}\n\t\t},\n\n\t\ticonBtnClass: \"icon-share\",\n\t\tlocale:{\n\t\t\tstartTimeLbl: gM( 'mwe-share-startTimeLbl' ),\n\t\t\tsecureEmbedLbl: gM( 'mwe-share-secureEmbedLbl' ),\n\t\t\tcopyLbl: gM( 'mwe-share-copyLbl' ),\n\t\t\terrDuration: gM( 'mwe-share-errDuration' ),\n\t\t\terrFormat: gM( 'mwe-share-errFormat' )\n\t\t},\n\t\tshareScreenOpened: false,\n\n\t\tsetup: function () {\n\t\t\tthis.setShareConfig();\n\t\t\tthis.setupPlayerURL();\n\t\t\tthis.addBindings();\n\n\t\t\t// disable embed option on mobile and native\n\t\t\tif ( mw.isMobileDevice() || mw.isNativeApp() ){\n\t\t\t\tthis.setConfig( 'embedEnabled' , false );\n\t\t\t}\n\n\t\t\t// force parent to be topBarContainer on mobile\n\t\t\tif (this.embedPlayer.isMobileSkin()){\n\t\t\t\tthis.setConfig( 'parent' , 'topBarContainer' );\n\t\t\t}\n\t\t},\n\n\t\tsetShareConfig: function() {\n\t\t\tvar networks = this.getConfig('shareConfig');\n\n\t\t\t// in order to support the legacy socialNetworks Flashvar, we will go through it and remove networks that are not specified in socialNetworks\n\t\t\tvar socialNetworks = this.getConfig(\"socialNetworks\").split(\",\");\n\t\t\t$.each(networks, function(idx, network){\n\t\t\t\tif ( $.inArray(idx, socialNetworks) === -1 ){\n\t\t\t\t\tdelete networks[idx];\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// remove sms option if we are not inside a native app\n\t\t\tif ( !mw.isNativeApp() ) {\n\t\t\t\tdelete networks[\"sms\"];\n\t\t\t}\n\n\t\t\t// remove email option if emailEnabled = false\n\t\t\tif ( this.getConfig(\"emailEnabled\") === false ) {\n\t\t\t\tdelete networks[\"email\"];\n\t\t\t}\n\n\t\t\t// save networks to config\n\t\t\tthis.setConfig( 'shareConfig' , networks );\t\t\t\n\t\t},\n\n\t\taddBindings: function () {\n\t\t\tvar _this = this;\n\t\t\tvar embedPlayer = this.getPlayer();\n\t\t\tthis.bind('playerReady', function () {\n\t\t\t\t_this.setupPlayerURL();\n\t\t\t\t_this.getScreen();\n\t\t\t});\n\t\t\tthis.bind('preShowScreen', function (event, screenName) {\n\t\t\t\tif ( screenName === \"share\" ){\n\t\t\t\t\t_this.getScreen().then(function(screen){\n\t\t\t\t\t\tscreen.addClass('semiTransparentBkg'); // add semi-transparent background for share plugin screen only. Won't affect other screen based plugins\n\t\t\t\t\t\t_this.shareScreenOpened = true;\n\t\t\t\t\t\t// prevent keyboard key actions to allow typing in share screen fields\n\t\t\t\t\t\tembedPlayer.triggerHelper( 'onDisableKeyboardBinding' );\n\t\t\t\t\t\t// disable all player controls except play button, scrubber and volume control\n\t\t\t\t\t\tembedPlayer.disablePlayControls([\"volumeControl\",\"scrubber\",\"playPauseBtn\",\"playlistAPI\"]);\n\t\t\t\t\t\t// setup embed code when the screen opens\n\t\t\t\t\t\t_this.setupEmbedCode();\n\t\t\t\t\t\t// set embed code in the UI as the template doesn't load it correctly when using data binding because of the double quotes inside the text\n\t\t\t\t\t\t$(\".embed-input\").val(_this.getConfig('embedCode'));\n\t\t\t\t\t\t// send event for analytics\n\t\t\t\t\t\t$(embedPlayer).trigger(\"showShareEvent\");\n\t\t\t\t\t\t// enable playback when the share screen is opened\n\t\t\t\t\t\t_this.enablePlayDuringScreen = true;\n\t\t\t\t\t\t// set responsive size\n\t\t\t\t\t\tif (embedPlayer.getVideoHolder().width() < 400){\n\t\t\t\t\t\t\t$(\".share\").addClass(\"small\");\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.tabKeyBind = function(e){\n\t\t\t\tif(e.keyCode === 9){// keyCode = 9 - tab button\n\t\t\t\t\tvar prevFocusedElement = $(':focus');//when you press TAB - focus does not change yet, and in focus will be prev element\n\t\t\t\t\tvar prevFocusedElementParent = prevFocusedElement.parents('.share-input-container');\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\tvar currentFocusedElement = $(':focus');//when timeout will done - new element will be in focus\n\t\t\t\t\t\tvar currentFocusedElementParents  = currentFocusedElement.parents('.share-input-container');\n\t\t\t\t\t\tif(!currentFocusedElement.parents('.videoHolder').hasClass('videoHolder')){\n\t\t\t\t\t\t\t_this.getPlayer().getInterface().find(\".share .icon-close\").focus();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(\n\t\t\t\t\t\t\tprevFocusedElementParent.attr('class') &&\n\t\t\t\t\t\t\tprevFocusedElementParent.attr('class').indexOf('-offset-container') !==-1 &&\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tcurrentFocusedElementParents.attr('class') === undefined ||\n\t\t\t\t\t\t\t\tcurrentFocusedElementParents.attr('class').indexOf('-offset-container') === -1\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\tprevFocusedElementParent.hide();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif( currentFocusedElementParents.hasClass('share-input-container') &&\n\t\t\t\t\t\t\tcurrentFocusedElementParents.next('.share-input-container').attr('class') &&\n\t\t\t\t\t\t\tcurrentFocusedElementParents.next('.share-input-container').attr('class').indexOf('-offset-container') !==-1\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\tcurrentFocusedElementParents.next('.share-input-container').show();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.bind('showScreen', function (event, screenName) {\n\t\t\t\tif ( screenName === \"share\" ){\n\t\t\t\t\t_this.getScreen().then(function(screen){\n\t\t\t\t\t\t$( \"#\" + embedPlayer.getPlayerElement().id ).addClass(\"blur\");\n\t\t\t\t\t\tembedPlayer.getPlayerPoster().addClass(\"blur\");\n\t\t\t\t\t\tscreen.find(\".icon-close\").focus();\n\t\t\t\t\t\tscreen.keydown( $.proxy( _this.tabKeyBind, _this )  );\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.bind('preHideScreen', function (event, screenName) {\n\t\t\t\tif ( screenName === \"share\" ){\n\t\t\t\t\tif ( !_this.enablePlayDuringScreen ){\n\t\t\t\t\t\t_this.shareScreenOpened = false;\n\t\t\t\t\t}\n\t\t\t\t\t// restore keyboard actions\n\t\t\t\t\tembedPlayer.triggerHelper( 'onEnableKeyboardBinding' );\n\t\t\t\t\t// re-enable player controls\n\t\t\t\t\tif ( !embedPlayer.isInSequence() ){\n\t\t\t\t\t\tembedPlayer.enablePlayControls();\n\t\t\t\t\t\tembedPlayer.triggerHelper(\"showLargePlayBtn\");\n\t\t\t\t\t}\n\t\t\t\t\t// remove blur\n\t\t\t\t\tif (embedPlayer.getPlayerElement()) {\n\t\t\t\t\t\t$( \"#\" + embedPlayer.getPlayerElement().id ).removeClass( \"blur\" );\n\t\t\t\t\t\tembedPlayer.getPlayerPoster().removeClass( \"blur\" );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Allow plugins to trigger share for specific platform/network\n\t\t\tthis.bind( 'shareByPlatform', function(e, platform) {\n\t\t\t\tvar platforms = _this.getConfig('shareConfig');\n\t\t\t\tif( platforms[platform] ) {\n\t\t\t\t\tvar url = embedPlayer.evaluate(platforms[platform].template);\n\t\t\t\t\t_this.openPopup(null, {\n\t\t\t\t\t\tid: platform,\n\t\t\t\t\t\turl: url\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// add API support: register to the \"doShare\" notification and dispatch the \"shareEvent\" event with the share link data\n\t\t\tthis.bind( 'doShare', function(event, data){\n\t\t\t\tvar shareUrl = _this.getConfig('shareURL');\n\t\t\t\tif ( data && data.timeOffset ){\n\t\t\t\t\tshareUrl += \"#t=\"+data.timeOffset;\n\t\t\t\t}\n\t\t\t\tembedPlayer.triggerHelper( 'shareEvent', { \"shareLink\" : shareUrl } );\n\t\t\t});\n\n\t\t\tthis.bind( 'onplay', function(event, data){\n\t\t\t\tif ( _this.shareScreenOpened ){\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\tembedPlayer.disablePlayControls([\"volumeControl\",\"scrubber\",\"playPauseBtn\",\"playlistAPI\"]);\n\t\t\t\t\t},0);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.bind( 'onpause', function(event, data){\n\t\t\t\tif ( _this.shareScreenOpened ){\n\t\t\t\t\t$( \"#\" + embedPlayer.getPlayerElement().id ).addClass(\"blur\");\n\t\t\t\t\tembedPlayer.getPlayerPoster().addClass(\"blur\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.bind( 'AdSupport_StartAdPlayback', function(){\n\t\t\t\t_this.closeScreen();\n\t\t\t});\n\n\t\t\tthis.bind( 'updateLayout', function(event, data){\n\t\t\t\tif ( _this.shareScreenOpened ){\n\t\t\t\t\tif (embedPlayer.getVideoHolder().width() < 400){\n\t\t\t\t\t\t$(\".share\").addClass(\"small\");\n\t\t\t\t\t}else{\n\t\t\t\t\t\t$(\".share\").removeClass(\"small\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tgetTemplateData: function () {\n\t\t\treturn {\n\t\t\t\t'share': this,\n\t\t\t\t'socialShareEnabled': this.getConfig('socialShareEnabled'),\n\t\t\t\t'embedEnabled': this.getConfig('embedEnabled'),\n\t\t\t\t'allowTimeOffset': this.getConfig('allowTimeOffset'),\n\t\t\t\t'allowSecuredEmbed': this.getConfig('allowSecuredEmbed'),\n\t\t\t\t'shareURL': this.getConfig('shareURL'),\n\t\t\t\t'networks': this.getConfig('shareConfig')\n\t\t\t};\n\t\t},\n\n\t\t// overwrite addScreenBindings function of mw.KBaseScreen\n\t\taddScreenBindings: function(){\n\t\t\tvar _this = this;\n\t\t\t//add IE8 support for rounded corners using the PIE library\n\t\t\tif( mw.isIE8() ){\n\t\t\t\t$(\".share\").addClass(\"ie8\");\n\t\t\t\t$('.share .PIE').each(function(){\n\t\t\t\t\tPIE.attach(this);\n\t\t\t\t});\n\t\t\t}\n\t\t\t// add bindings\n\t\t\tvar offsetContainerHeight = this.getPlayer().getVideoHolder().width() < 400 ? \"24px\" : \"32px\";\n\t\t\t$(\".share-input\").on(\"click\", function(){\n\t\t\t\tif ( $(\".share-offset-container\").css(\"display\") === \"none\" ){\n\t\t\t\t\t$(\".embed-offset-container\").hide();\n\t\t\t\t\t$(\".embed-container>.share-copy-btn\").hide();\n\t\t\t\t\t$(\".share-offset-container\").height(0).show().animate({ height: offsetContainerHeight }, 150 ,function(){\n\t\t\t\t\t\t//$(\".share-container>.share-copy-btn\").fadeIn(300);\n\t\t\t\t\t\t$(\".share-offset-container\").fadeIn(150);\n\t\t\t\t\t\t$(\".share-icons-container\").hide().show(); // force refresh for IE8 :(\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('mouseup', function (e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t})\n\t\t\t.on('click', function () {\n\t\t\t\t\tthis.setSelectionRange(0, 9999);\n\t\t\t\t});\n\n\t\t\t$(\".embed-input\").on(\"click\", function(){\n\t\t\t\tif ( $(\".embed-offset-container\").css(\"display\") === \"none\" ){\n\t\t\t\t\t$(\".share-offset-container\").hide();\n\t\t\t\t\t$(\".share-container>.share-copy-btn\").hide();\n\t\t\t\t\t$(\".embed-offset-container\").height(0).show().animate({ height: offsetContainerHeight }, 150 ,function(){\n\t\t\t\t\t\t//$(\".embed-container>.share-copy-btn\").fadeIn(300);\n\t\t\t\t\t\t$(\".embed-offset-container\").fadeIn(150);\n\t\t\t\t\t\t$(\".share-icons-container\").hide().show(); // force refresh for IE8 :(\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('mouseup', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t})\n\t\t\t.on('click', function () {\n\t\t\t\tthis.setSelectionRange(0, 9999);\n\t\t\t});\n\n\t\t\tthis.restrictNPTFields();\n\t\t\t// handle time offset for share link\n\t\t\t$(\".share-offset-container>.share-offset\").on(\"propertychange change keyup input paste\", function(event){\n\t\t\t\t_this.setShareTimeOffset($(this).val());\n\t\t\t});\n\n\t\t\t// handle copy button for share link\n//\t\t\t$(\".share-copy-btn\").on(\"click\", function(){\n//\t\t\t\tvar selector = $(this).data(\"target\");\n//\t\t\t\twindow.prompt(\"Copy to clipboard: Ctrl+C, Enter\", $(selector).val());\n//\t\t\t});\n\n\t\t\t// handle time offset for embed code\n\t\t\t$(\".embed-offset-container>.share-offset\").on(\"propertychange change keyup input paste\", function(event){\n\t\t\t\t_this.setEmbedTimeOffset($(this).val());\n\t\t\t});\n\n\t\t\t// handle secured embed\n\t\t\tif ( mw.getConfig(\"Kaltura.ServiceUrl\").indexOf(\".kaltura.com\") !== -1 ){\n\t\t\t\t$(\".share-secured\").on(\"click\", function(){\n\t\t\t\t\tvar embedCode = $(\".embed-input\").val();\n\t\t\t\t\tif ($(this).is(':checked')){\n\t\t\t\t\t\tembedCode = embedCode.split(\"http://cdnapi.kaltura.com\").join(\"https://cdnapisec.kaltura.com\");\n\t\t\t\t\t}else{\n\t\t\t\t\t\tembedCode = embedCode.split(\"https://cdnapisec.kaltura.com\").join(\"http://cdnapi.kaltura.com\");\n\t\t\t\t\t}\n\t\t\t\t\t$(\".embed-input\").val(embedCode);\n\t\t\t\t});\n\t\t\t\t$('.share-secured').prop('checked', mw.getConfig(\"Kaltura.ServiceUrl\").indexOf(\"https\") === 0); // initial check state according to ServiceUrl\n\t\t\t}else{\n\t\t\t\t// on prem - hide the security checkbox as the security settings are derived from the ServiceUrl\n\t\t\t\t$(\".share-secured, .share-secure-lbl\").hide();\n\t\t\t}\n\n\t\t\t// handle scroll buttons\n\t\t\tvar deltaScroll = $(\".share-icons-container .icon-border\").width() + parseInt($(\".share-icons-container .icon-border\").css(\"margin-right\"))*2;\n\t\t\t$(\".share-icons-scroller .next-btn\").on(\"click\", function(){\n\t\t\t\t$(\".share-icons-scroller .back-btn\").show();\n\t\t\t\t$('.share-icons-container').animate({scrollLeft: '+='+deltaScroll }, 300, function(){\n\t\t\t\t\tif (Math.round($('.share-icons-container').scrollLeft()/deltaScroll) === ($(\".icon-border\").length - 5) ){\n\t\t\t\t\t\t$(\".share-icons-scroller .next-btn\").hide();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t$(\".share-icons-scroller .back-btn\").on(\"click\", function(){\n\t\t\t\t$(\".share-icons-scroller .next-btn\").show();\n\t\t\t\t$('.share-icons-container').animate({scrollLeft: '-='+deltaScroll }, 300, function(){\n\t\t\t\t\tif ($('.share-icons-container').scrollLeft() === 0){\n\t\t\t\t\t\t$(\".share-icons-scroller .back-btn\").hide();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tsetTimeout(function(){\n\t\t\t\t_this.addScroll(); // add scroll for social network icons if needed\n\t\t\t},0);\n\n\t\t\t// close button override\n\t\t\t$(\".share .icon-close\").on(\"mousedown\", function(e){\n\t\t\t\t_this.closeScreen();\n\t\t\t})\n\t\t\t.keyup(function (e) {\n\t\t\t\tif(e.keyCode === 13){\n\t\t\t\t\t_this.closeScreen();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\taddScroll: function(){\n\t\t\tif ( $(\".icon-border\").length > 5 ){\n\t\t\t\t$(\".share-icons-container\").scrollLeft(0);\n\t\t\t\t$(\".share-icons-scroller .next-btn\").show();\n\t\t\t}\n\t\t},\n\n\t\trestrictNPTFields: function(){\n\t\t\t$(\".share-offset\").keydown(function (e) {\n\t\t\t\t// Allow: backspace, delete, tab, escape, enter and :\n\t\t\t\tif ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 186, 59]) !== -1 ||\n\t\t\t\t\t// Allow: Ctrl+A\n\t\t\t\t\t(e.keyCode == 65 && e.ctrlKey === true) ||\n\t\t\t\t\t// Allow: home, end, left, right\n\t\t\t\t\t(e.keyCode >= 35 && e.keyCode <= 39)) {\n\t\t\t\t\t// let it happen, don't do anything\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// Ensure that it is a number and stop the keypress\n\t\t\t\tif ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tsetShareTimeOffset: function(offset){\n\t\t\tvar shareLink = $(\".share-input\").val();\n\t\t\tshareLink = shareLink.split(\"#\")[0];\n\t\t\tif ( this.validateTimeOffset(offset) ){\n\t\t\t\tshareLink = shareLink + \"#t=\" + offset;\n\t\t\t}\n\t\t\t$(\".share-input\").val(shareLink);\n\t\t\tthis.setConfig(\"shareURL\", shareLink);\n\t\t},\n\n\t\tsetEmbedTimeOffset: function(offset){\n\t\t\tvar embedCode = $(\".embed-input\").val();\n\t\t\t// remove any existing mediaProxy.mediaPlayFrom flashvars previously defined\n\t\t\tif ( embedCode.indexOf(\"mediaProxy.mediaPlayFrom\") !== -1 ){\n\t\t\t\tembedCode = embedCode.replace( /flashvars\\[mediaProxy.mediaPlayFrom\\]=(.*?)&/ ,\"\");\n\t\t\t}\n\t\t\tif ( this.validateTimeOffset(offset) ){\n\t\t\t\tembedCode = embedCode.split(\"?\").join(\"?flashvars[mediaProxy.mediaPlayFrom]=\" + mw.npt2seconds(offset) + \"&\");\n\t\t\t}\n\t\t\t$(\".embed-input\").val(embedCode);\n\t\t},\n\n\t\tvalidateTimeOffset: function(offset){\n\t\t\t$(\".share-alert\").text(\"\").hide();\n\t\t\tif ( mw.npt2seconds(offset) > this.getPlayer().duration ){\n\t\t\t\t$(\".share-alert\").text(this.locale.errDuration).show();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif ( parseInt(offset) > 59 && offset.indexOf(\":\") === -1 ){\n\t\t\t\t$(\".share-alert\").text(this.locale.errFormat).show();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif ( mw.npt2seconds(offset) === 0 ){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tcloseScreen: function(){\n\t\t\tif (this.getPlayer().getPlayerElement()) {\n\t\t\t\t$(  \"#\" + this.getPlayer().getPlayerElement().id ).removeClass( \"blur\" );\n\t\t\t\tthis.getPlayer().getPlayerPoster().removeClass( \"blur\" );\n\t\t\t}\n\t\t\t$(\".embed-offset-container\").hide();\n\t\t\t$(\".embed-container>.share-copy-btn\").hide();\n\t\t\t$(\".share-offset-container\").hide();\n\t\t\t$(\".share-container>.share-copy-btn\").hide();\n\t\t\t$(\".share-offset\").val(\"00:00\");\n\t\t\t$(\".share-alert\").hide();\n\t\t\t$('.share-secured').attr('checked', false);\n\t\t\tthis.enablePlayDuringScreen = false;\n\t\t\tthis.hideScreen();\n\t\t},\n\n\t\topenPopup: function (e, network) {\n\n\t\t\t// Maintain backward compatibility \n\t\t\tif( e && e.originalEvent ) {\n\t\t\t\tnetwork = {\n\t\t\t\t\tid: $(e.target).attr('id'),\n\t\t\t\t\turl: $(e.target).parents('a').attr('href')\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar embedPlayer = this.getPlayer();\n\t\t\tvar url = network.url;\n\t\t\turl = decodeURIComponent(url);        // url was encoded to keep curly brackets for template tokens\n\t\t\turl = this.getPlayer().evaluate(url); // replace tokens\n\t\t\turl = url.replace('#','%23'); // encode hash sign to keep time offset\n\t\t\tvar networks = this.getConfig('shareConfig');\n\t\t\t// send event for analytics\n\t\t\t$( embedPlayer ).trigger( \"socialShareEvent\", networks[network.id] );\n\t\t\tif (mw.isNativeApp()) {\n\t\t\t\tvar id = network.id;\n\t\t\t\tvar shareParams = {\n\t\t\t\t\tactionType: 'share',\n\t\t\t\t\tid: id[0].toUpperCase() + id.substr(1),\n\t\t\t\t\tsharedLink: this.getConfig(\"shareURL\"),\n\t\t\t\t\tshareNetwork: networks[id],\n\t\t\t\t\tthumbnail: this.getThumbnailURL(),\n\t\t\t\t\tvideoName: this.getPlayer().evaluate(\"{mediaProxy.entry.name}\")\n\t\t\t\t};\n\t\t\t\tembedPlayer.doNativeAction(JSON.stringify(shareParams));\n\t\t\t} else {\n\t\t\t\tif ( mw.isIphone() && url.indexOf(\"mailto\") === 0){\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\twindow.location = url;\n\t\t\t\t}else{\n\t\t\t\t\tvar opener = window.open(url,'_blank','width=626,height=436');\n\t\t\t\t\t// close the window if this is an email\n\t\t\t\t\tif (url.indexOf(\"mailto\") === 0){\n\t\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t\tif (opener && typeof opener.close === 'function') {\n\t\t\t\t\t\t\t\topener.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},2000);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tgetThumbnailURL: function () {\n\t\t\treturn kWidgetSupport.getKalturaThumbnailUrl({\n\t\t\t\turl: this.getPlayer().evaluate('{mediaProxy.entry.thumbnailUrl}'),\n\t\t\t\twidth: this.getPlayer().getWidth(),\n\t\t\t\theight: this.getPlayer().getHeight()\n\t\t\t});\n\t\t},\n\t\t// setup embed code\n\t\tsetupEmbedCode: function(){\n\t\t\tvar embedCode = this.getConfig(\"embedCodeTemplate\",true);\n\t\t\tvar embedConfig = this.getConfig(\"embedOptions\");\n\t\t\tvar embedPlayer = this.getPlayer();\n\n\t\t\t// replace properties that come from configuration\n\t\t\tif (embedConfig[\"uiconfID\"]){\n\t\t\t\tembedCode = embedCode.split(\"{configProxy.kw.uiConfId}\").join(embedConfig[\"uiconfID\"]);\n\t\t\t}\n\t\t\tif ( embedConfig[\"streamerType\"] ){\n\t\t\t\tembedCode = embedCode.replace( /streamerType\\]=(.*?)\"/ ,'streamerType]=' + embedConfig[\"streamerType\"] + '\"');\n\t\t\t}\n\t\t\tif ( embedConfig[\"width\"] ){\n\t\t\t\tembedCode = embedCode.replace( /width=\"(.*?)\"/ ,'width=\"' + embedConfig[\"width\"] + '\"');\n\t\t\t}\n\t\t\tif ( embedConfig[\"height\"] ){\n\t\t\t\tembedCode = embedCode.replace( /height=\"(.*?)\"/ ,'height=\"' + embedConfig[\"height\"] + '\"');\n\t\t\t}\n\t\t\tif ( embedConfig[\"borderWidth\"] ){\n\t\t\t\tembedCode = embedCode.replace( /frameborder=\"(.*?)\"/ ,'frameborder=\"' + embedConfig[\"borderWidth\"] + '\"');\n\t\t\t}\n\t\t\t// replace tokens in template\n\t\t\tembedCode = embedPlayer.evaluate(embedCode);\n\t\t\t// save embed code to Flashvar to be used later\n\t\t\tthis.setConfig('embedCode', embedCode);\n\t\t},\n\t\t// -------------- start setup player url according to the socialShareURL flashvar ------- //\n\t\tsetupPlayerURL: function () {\n\t\t\tvar shareURL = null;\n\t\t\tswitch (this.getConfig('socialShareURL')) {\n\t\t\t\tcase 'smart':\n\t\t\t\t\tshareURL = this.getSmartURL();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'parent':\n\t\t\t\t\tshareURL = this.getParentURL();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tshareURL = this.getConfig(\"socialShareURL\");\n\t\t\t}\n\t\t\tif (shareURL) {\n\t\t\t\tthis.setConfig('shareURL', shareURL);\n\t\t\t}\n\t\t},\n\t\tgetSmartURL: function () {\n\t\t\tvar shareURL = this.getKalturaShareURL();\n\t\t\tif (mw.getConfig('EmbedPlayer.IsFriendlyIframe')) {\n\t\t\t\ttry {\n\t\t\t\t\tvar $parentDoc = $(window['parent'].document);\n\t\t\t\t\tvar hasOpenGraphTags = $parentDoc.find('meta[property=\"og:video\"]').length;\n\t\t\t\t\tvar hasTwitterCardsTags = $parentDoc.find('meta[name=\"twitter:player\"]').length;\n\t\t\t\t\tif (hasOpenGraphTags || hasTwitterCardsTags) {\n\t\t\t\t\t\tshareURL = this.getParentURL();\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn shareURL;\n\t\t},\n\t\tgetKalturaShareURL: function () {\n\t\t\tvar uiConfId = this.getConfig(\"shareUiconfID\") ? this.getConfig(\"shareUiconfID\") : this.getPlayer().kuiconfid;\n\t\t\treturn mw.getConfig('Kaltura.ServiceUrl') + '/index.php/extwidget/preview' +\n\t\t\t\t'/partner_id/' + this.getPlayer().kpartnerid +\n\t\t\t\t'/uiconf_id/' + uiConfId +\n\t\t\t\t'/entry_id/' + this.getPlayer().kentryid + '/embed/dynamic';\n\t\t},\n\t\tgetParentURL: function () {\n\t\t\tvar res;\n\t\t\tif (mw.getConfig('EmbedPlayer.IframeParentUrl')) {\n\t\t\t\tres = mw.getConfig('EmbedPlayer.IframeParentUrl');\n\t\t\t} else {\n\t\t\t\tres = document.referrer;\n\t\t\t\tif (res === \"\") {\n\t\t\t\t\tres = document.URL;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res;\n\t\t}\n\t\t// -------------- finish setup player url according to the socialShareURL flashvar ------- //\n\n\t}));\n\n})(window.mw, window.jQuery);\n"], "fixing_code": ["(function (mw, $) {\n\t\"use strict\";\n\n\tmw.PluginManager.add('share', mw.KBaseScreen.extend({\n\n\t\tdefaultConfig: {\n\t\t\tparent: \"topBarContainer\",\n\t\t\torder: 5,\n\t\t\talign: \"right\",\n\t\t\ttooltip:  gM( 'mwe-embedplayer-share' ),\n\t\t\ttitle:  gM( 'mwe-embedplayer-share' ),\n\t\t\tshowTooltip: true,\n\t\t\tdisplayImportance: 'medium',\n\t\t\ttemplatePath: 'components/share/share.tmpl.html',\n\n\t\t\tusePreviewPlayer: false,\n\t\t\tpreviewPlayerEnabled: false,\n\n\t\t\tsocialShareEnabled: true,\n\t\t\tembedEnabled: true,\n\t\t\tallowTimeOffset: true,\n\t\t\tallowSecuredEmbed: true,\n\t\t\temailEnabled: true,\n\n\t\t\tsocialShareURL: 'smart', // 'parent' or 'http://custom.url/entry/{mediaProxy.entry.id}'\n\t\t\tsocialNetworks: 'facebook,twitter,googleplus,email,linkedin,sms',\n\t\t\tshareUiconfID: null,\n\t\t\tshareConfig: {\n\t\t\t\t\"facebook\": {\n\t\t\t\t\t\"name\": \"Facebook\",\n\t\t\t\t\t\"icon\": \"\",\n\t\t\t\t\t\"cssClass\": \"icon-share-facebook\",\n\t\t\t\t\t\"template\": \"https://www.facebook.com/sharer/sharer.php?u={share.shareURL}\",\n\t\t\t\t\t\"redirectUrl\": 'fb://feed/',\n\t\t\t\t\t\"barColor\": '#394F8F'\n\t\t\t\t},\n\t\t\t\t\"twitter\": {\n\t\t\t\t\t\"name\": \"Twitter\",\n\t\t\t\t\t\"icon\": \"\",\n\t\t\t\t\t\"cssClass\": \"icon-share-twitter\",\n\t\t\t\t\t\"template\": \"https://twitter.com/share?url={share.shareURL}\",\n\t\t\t\t\t\"redirectUrl\": 'https://twitter.com/intent/tweet/complete?,https://twitter.com/intent/tweet/update',\n\t\t\t\t\t\"barColor\": '#39BAB6'\n\t\t\t\t},\n\t\t\t\t\"googleplus\": {\n\t\t\t\t\t\"name\": \"Google+\",\n\t\t\t\t\t\"icon\": \"\",\n\t\t\t\t\t\"cssClass\": \"icon-share-google\",\n\t\t\t\t\t\"template\": \"https://plus.google.com/share?url={share.shareURL}\",\n\t\t\t\t\t\"redirectUrl\": 'https://plus.google.com/app/basic/stream',\n\t\t\t\t\t\"barColor\": '#CB2726'\n\t\t\t\t},\n\t\t\t\t\"email\": {\n\t\t\t\t\t\"name\": \"Mail\",\n\t\t\t\t\t\"icon\": \"\",\n\t\t\t\t\t\"cssClass\": \"icon-share-email\",\n\t\t\t\t\t\"template\": \"mailto:?subject=Check out {mediaProxy.entry.name}&body=Check out {mediaProxy.entry.name}: {share.shareURL}\",\n\t\t\t\t\t\"redirectUrl\": '',\n\t\t\t\t\t\"barColor\": '#394F8F'\n\t\t\t\t},\n\t\t\t\t\"linkedin\": {\n\t\t\t\t\t\"name\": \"LinkedIn\",\n\t\t\t\t\t\"icon\": \"\",\n\t\t\t\t\t\"cssClass\": \"icon-share-linkedin\",\n\t\t\t\t\t\"template\": \"http://www.linkedin.com/shareArticle?mini=true&url={share.shareURL}\",\n\t\t\t\t\t\"redirectUrl\": '',\n\t\t\t\t\t\"barColor\": '#222222'\n\t\t\t\t},\n\t\t\t\t\"sms\": {\n\t\t\t\t\t\"name\": \"Message\",\n\t\t\t\t\t\"icon\": \"\",\n\t\t\t\t\t\"cssClass\": \"icon-share-sms\",\n\t\t\t\t\t\"template\": \"Check out {mediaProxy.entry.name}: {share.shareURL}\",\n\t\t\t\t\t\"redirectUrl\": '',\n\t\t\t\t\t\"barColor\": '#394F8F'\n\t\t\t\t}\n\t\t\t},\n\t\t\tembedCodeTemplate: '<iframe src=\"' + mw.getConfig(\"Kaltura.ServiceUrl\") + '/p/{mediaProxy.entry.partnerId}/sp/{mediaProxy.entry.partnerId}00/embedIframeJs/uiconf_id/{configProxy.kw.uiConfId}/partner_id/{mediaProxy.entry.partnerId}?iframeembed=true&playerId={configProxy.targetId}&entry_id={mediaProxy.entry.id}&flashvars[streamerType]=auto\" width=\"560\" height=\"395\" allowfullscreen webkitallowfullscreen mozAllowFullScreen allow=\"autoplay *; fullscreen *; encrypted-media *\" frameborder=\"0\"></iframe>',\n\t\t\tembedOptions: {\n\t\t\t\t\"streamerType\": \"auto\",\n\t\t\t\t\"uiconfID\": null,\n\t\t\t\t\"width\": 560,\n\t\t\t\t\"height\": 395,\n\t\t\t\t\"borderWidth\": 0\n\t\t\t}\n\t\t},\n\n\t\ticonBtnClass: \"icon-share\",\n\t\tlocale:{\n\t\t\tstartTimeLbl: gM( 'mwe-share-startTimeLbl' ),\n\t\t\tsecureEmbedLbl: gM( 'mwe-share-secureEmbedLbl' ),\n\t\t\tcopyLbl: gM( 'mwe-share-copyLbl' ),\n\t\t\terrDuration: gM( 'mwe-share-errDuration' ),\n\t\t\terrFormat: gM( 'mwe-share-errFormat' )\n\t\t},\n\t\tshareScreenOpened: false,\n\n\t\tsetup: function () {\n\t\t\tthis.setShareConfig();\n\t\t\tthis.setupPlayerURL();\n\t\t\tthis.addBindings();\n\n\t\t\t// disable embed option on mobile and native\n\t\t\tif ( mw.isMobileDevice() || mw.isNativeApp() ){\n\t\t\t\tthis.setConfig( 'embedEnabled' , false );\n\t\t\t}\n\n\t\t\t// force parent to be topBarContainer on mobile\n\t\t\tif (this.embedPlayer.isMobileSkin()){\n\t\t\t\tthis.setConfig( 'parent' , 'topBarContainer' );\n\t\t\t}\n\t\t},\n\n\t\tsetShareConfig: function() {\n\t\t\tvar networks = this.getConfig('shareConfig');\n\n\t\t\t// in order to support the legacy socialNetworks Flashvar, we will go through it and remove networks that are not specified in socialNetworks\n\t\t\tvar socialNetworks = this.getConfig(\"socialNetworks\").split(\",\");\n\t\t\t$.each(networks, function(idx, network){\n\t\t\t\tif ( $.inArray(idx, socialNetworks) === -1 ){\n\t\t\t\t\tdelete networks[idx];\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// remove sms option if we are not inside a native app\n\t\t\tif ( !mw.isNativeApp() ) {\n\t\t\t\tdelete networks[\"sms\"];\n\t\t\t}\n\n\t\t\t// remove email option if emailEnabled = false\n\t\t\tif ( this.getConfig(\"emailEnabled\") === false ) {\n\t\t\t\tdelete networks[\"email\"];\n\t\t\t}\n\n\t\t\t// save networks to config\n\t\t\tthis.setConfig( 'shareConfig' , networks );\t\t\t\n\t\t},\n\n\t\taddBindings: function () {\n\t\t\tvar _this = this;\n\t\t\tvar embedPlayer = this.getPlayer();\n\t\t\tthis.bind('playerReady', function () {\n\t\t\t\t_this.setupPlayerURL();\n\t\t\t\t_this.getScreen();\n\t\t\t});\n\t\t\tthis.bind('preShowScreen', function (event, screenName) {\n\t\t\t\tif ( screenName === \"share\" ){\n\t\t\t\t\t_this.getScreen().then(function(screen){\n\t\t\t\t\t\tscreen.addClass('semiTransparentBkg'); // add semi-transparent background for share plugin screen only. Won't affect other screen based plugins\n\t\t\t\t\t\t_this.shareScreenOpened = true;\n\t\t\t\t\t\t// prevent keyboard key actions to allow typing in share screen fields\n\t\t\t\t\t\tembedPlayer.triggerHelper( 'onDisableKeyboardBinding' );\n\t\t\t\t\t\t// disable all player controls except play button, scrubber and volume control\n\t\t\t\t\t\tembedPlayer.disablePlayControls([\"volumeControl\",\"scrubber\",\"playPauseBtn\",\"playlistAPI\"]);\n\t\t\t\t\t\t// setup embed code when the screen opens\n\t\t\t\t\t\t_this.setupEmbedCode();\n\t\t\t\t\t\t// set embed code in the UI as the template doesn't load it correctly when using data binding because of the double quotes inside the text\n\t\t\t\t\t\t$(\".embed-input\").val(_this.getConfig('embedCode'));\n\t\t\t\t\t\t// send event for analytics\n\t\t\t\t\t\t$(embedPlayer).trigger(\"showShareEvent\");\n\t\t\t\t\t\t// enable playback when the share screen is opened\n\t\t\t\t\t\t_this.enablePlayDuringScreen = true;\n\t\t\t\t\t\t// set responsive size\n\t\t\t\t\t\tif (embedPlayer.getVideoHolder().width() < 400){\n\t\t\t\t\t\t\t$(\".share\").addClass(\"small\");\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.tabKeyBind = function(e){\n\t\t\t\tif(e.keyCode === 9){// keyCode = 9 - tab button\n\t\t\t\t\tvar prevFocusedElement = $(':focus');//when you press TAB - focus does not change yet, and in focus will be prev element\n\t\t\t\t\tvar prevFocusedElementParent = prevFocusedElement.parents('.share-input-container');\n\t\t\t\t\tsetTimeout(function () {\n\t\t\t\t\t\tvar currentFocusedElement = $(':focus');//when timeout will done - new element will be in focus\n\t\t\t\t\t\tvar currentFocusedElementParents  = currentFocusedElement.parents('.share-input-container');\n\t\t\t\t\t\tif(!currentFocusedElement.parents('.videoHolder').hasClass('videoHolder')){\n\t\t\t\t\t\t\t_this.getPlayer().getInterface().find(\".share .icon-close\").focus();\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(\n\t\t\t\t\t\t\tprevFocusedElementParent.attr('class') &&\n\t\t\t\t\t\t\tprevFocusedElementParent.attr('class').indexOf('-offset-container') !==-1 &&\n\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\tcurrentFocusedElementParents.attr('class') === undefined ||\n\t\t\t\t\t\t\t\tcurrentFocusedElementParents.attr('class').indexOf('-offset-container') === -1\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\tprevFocusedElementParent.hide();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif( currentFocusedElementParents.hasClass('share-input-container') &&\n\t\t\t\t\t\t\tcurrentFocusedElementParents.next('.share-input-container').attr('class') &&\n\t\t\t\t\t\t\tcurrentFocusedElementParents.next('.share-input-container').attr('class').indexOf('-offset-container') !==-1\n\t\t\t\t\t\t){\n\t\t\t\t\t\t\tcurrentFocusedElementParents.next('.share-input-container').show();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.bind('showScreen', function (event, screenName) {\n\t\t\t\tif ( screenName === \"share\" ){\n\t\t\t\t\t_this.getScreen().then(function(screen){\n\t\t\t\t\t\t$( \"#\" + embedPlayer.getPlayerElement().id ).addClass(\"blur\");\n\t\t\t\t\t\tembedPlayer.getPlayerPoster().addClass(\"blur\");\n\t\t\t\t\t\tscreen.find(\".icon-close\").focus();\n\t\t\t\t\t\tscreen.keydown( $.proxy( _this.tabKeyBind, _this )  );\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.bind('preHideScreen', function (event, screenName) {\n\t\t\t\tif ( screenName === \"share\" ){\n\t\t\t\t\tif ( !_this.enablePlayDuringScreen ){\n\t\t\t\t\t\t_this.shareScreenOpened = false;\n\t\t\t\t\t}\n\t\t\t\t\t// restore keyboard actions\n\t\t\t\t\tembedPlayer.triggerHelper( 'onEnableKeyboardBinding' );\n\t\t\t\t\t// re-enable player controls\n\t\t\t\t\tif ( !embedPlayer.isInSequence() ){\n\t\t\t\t\t\tembedPlayer.enablePlayControls();\n\t\t\t\t\t\tembedPlayer.triggerHelper(\"showLargePlayBtn\");\n\t\t\t\t\t}\n\t\t\t\t\t// remove blur\n\t\t\t\t\tif (embedPlayer.getPlayerElement()) {\n\t\t\t\t\t\t$( \"#\" + embedPlayer.getPlayerElement().id ).removeClass( \"blur\" );\n\t\t\t\t\t\tembedPlayer.getPlayerPoster().removeClass( \"blur\" );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Allow plugins to trigger share for specific platform/network\n\t\t\tthis.bind( 'shareByPlatform', function(e, platform) {\n\t\t\t\tvar platforms = _this.getConfig('shareConfig');\n\t\t\t\tif( platforms[platform] ) {\n\t\t\t\t\tvar url = embedPlayer.evaluate(platforms[platform].template);\n\t\t\t\t\t_this.openPopup(null, {\n\t\t\t\t\t\tid: platform,\n\t\t\t\t\t\turl: url\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// add API support: register to the \"doShare\" notification and dispatch the \"shareEvent\" event with the share link data\n\t\t\tthis.bind( 'doShare', function(event, data){\n\t\t\t\tvar shareUrl = _this.getConfig('shareURL');\n\t\t\t\tif ( data && data.timeOffset ){\n\t\t\t\t\tshareUrl += \"#t=\"+data.timeOffset;\n\t\t\t\t}\n\t\t\t\tembedPlayer.triggerHelper( 'shareEvent', { \"shareLink\" : shareUrl } );\n\t\t\t});\n\n\t\t\tthis.bind( 'onplay', function(event, data){\n\t\t\t\tif ( _this.shareScreenOpened ){\n\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\tembedPlayer.disablePlayControls([\"volumeControl\",\"scrubber\",\"playPauseBtn\",\"playlistAPI\"]);\n\t\t\t\t\t},0);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.bind( 'onpause', function(event, data){\n\t\t\t\tif ( _this.shareScreenOpened ){\n\t\t\t\t\t$( \"#\" + embedPlayer.getPlayerElement().id ).addClass(\"blur\");\n\t\t\t\t\tembedPlayer.getPlayerPoster().addClass(\"blur\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.bind( 'AdSupport_StartAdPlayback', function(){\n\t\t\t\t_this.closeScreen();\n\t\t\t});\n\n\t\t\tthis.bind( 'updateLayout', function(event, data){\n\t\t\t\tif ( _this.shareScreenOpened ){\n\t\t\t\t\tif (embedPlayer.getVideoHolder().width() < 400){\n\t\t\t\t\t\t$(\".share\").addClass(\"small\");\n\t\t\t\t\t}else{\n\t\t\t\t\t\t$(\".share\").removeClass(\"small\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tgetTemplateData: function () {\n\t\t\treturn {\n\t\t\t\t'share': this,\n\t\t\t\t'socialShareEnabled': this.getConfig('socialShareEnabled'),\n\t\t\t\t'embedEnabled': this.getConfig('embedEnabled'),\n\t\t\t\t'allowTimeOffset': this.getConfig('allowTimeOffset'),\n\t\t\t\t'allowSecuredEmbed': this.getConfig('allowSecuredEmbed'),\n\t\t\t\t'shareURL': this.getConfig('shareURL'),\n\t\t\t\t'networks': this.getConfig('shareConfig')\n\t\t\t};\n\t\t},\n\n\t\t// overwrite addScreenBindings function of mw.KBaseScreen\n\t\taddScreenBindings: function(){\n\t\t\tvar _this = this;\n\t\t\t//add IE8 support for rounded corners using the PIE library\n\t\t\tif( mw.isIE8() ){\n\t\t\t\t$(\".share\").addClass(\"ie8\");\n\t\t\t\t$('.share .PIE').each(function(){\n\t\t\t\t\tPIE.attach(this);\n\t\t\t\t});\n\t\t\t}\n\t\t\t// add bindings\n\t\t\tvar offsetContainerHeight = this.getPlayer().getVideoHolder().width() < 400 ? \"24px\" : \"32px\";\n\t\t\t$(\".share-input\").on(\"click\", function(){\n\t\t\t\tif ( $(\".share-offset-container\").css(\"display\") === \"none\" ){\n\t\t\t\t\t$(\".embed-offset-container\").hide();\n\t\t\t\t\t$(\".embed-container>.share-copy-btn\").hide();\n\t\t\t\t\t$(\".share-offset-container\").height(0).show().animate({ height: offsetContainerHeight }, 150 ,function(){\n\t\t\t\t\t\t//$(\".share-container>.share-copy-btn\").fadeIn(300);\n\t\t\t\t\t\t$(\".share-offset-container\").fadeIn(150);\n\t\t\t\t\t\t$(\".share-icons-container\").hide().show(); // force refresh for IE8 :(\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('mouseup', function (e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t})\n\t\t\t.on('click', function () {\n\t\t\t\t\tthis.setSelectionRange(0, 9999);\n\t\t\t\t});\n\n\t\t\t$(\".embed-input\").on(\"click\", function(){\n\t\t\t\tif ( $(\".embed-offset-container\").css(\"display\") === \"none\" ){\n\t\t\t\t\t$(\".share-offset-container\").hide();\n\t\t\t\t\t$(\".share-container>.share-copy-btn\").hide();\n\t\t\t\t\t$(\".embed-offset-container\").height(0).show().animate({ height: offsetContainerHeight }, 150 ,function(){\n\t\t\t\t\t\t//$(\".embed-container>.share-copy-btn\").fadeIn(300);\n\t\t\t\t\t\t$(\".embed-offset-container\").fadeIn(150);\n\t\t\t\t\t\t$(\".share-icons-container\").hide().show(); // force refresh for IE8 :(\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t\t\t.on('mouseup', function (e) {\n\t\t\t\te.preventDefault();\n\t\t\t})\n\t\t\t.on('click', function () {\n\t\t\t\tthis.setSelectionRange(0, 9999);\n\t\t\t});\n\n\t\t\tthis.restrictNPTFields();\n\t\t\t// handle time offset for share link\n\t\t\t$(\".share-offset-container>.share-offset\").on(\"propertychange change keyup input paste\", function(event){\n\t\t\t\t_this.setShareTimeOffset($(this).val());\n\t\t\t});\n\n\t\t\t// handle copy button for share link\n//\t\t\t$(\".share-copy-btn\").on(\"click\", function(){\n//\t\t\t\tvar selector = $(this).data(\"target\");\n//\t\t\t\twindow.prompt(\"Copy to clipboard: Ctrl+C, Enter\", $(selector).val());\n//\t\t\t});\n\n\t\t\t// handle time offset for embed code\n\t\t\t$(\".embed-offset-container>.share-offset\").on(\"propertychange change keyup input paste\", function(event){\n\t\t\t\t_this.setEmbedTimeOffset($(this).val());\n\t\t\t});\n\n\t\t\t// handle secured embed\n\t\t\tif ( mw.getConfig(\"Kaltura.ServiceUrl\").indexOf(\".kaltura.com\") !== -1 ){\n\t\t\t\t$(\".share-secured\").on(\"click\", function(){\n\t\t\t\t\tvar embedCode = $(\".embed-input\").val();\n\t\t\t\t\tif ($(this).is(':checked')){\n\t\t\t\t\t\tembedCode = embedCode.split(\"http://cdnapi.kaltura.com\").join(\"https://cdnapisec.kaltura.com\");\n\t\t\t\t\t}else{\n\t\t\t\t\t\tembedCode = embedCode.split(\"https://cdnapisec.kaltura.com\").join(\"http://cdnapi.kaltura.com\");\n\t\t\t\t\t}\n\t\t\t\t\t$(\".embed-input\").val(embedCode);\n\t\t\t\t});\n\t\t\t\t$('.share-secured').prop('checked', mw.getConfig(\"Kaltura.ServiceUrl\").indexOf(\"https\") === 0); // initial check state according to ServiceUrl\n\t\t\t}else{\n\t\t\t\t// on prem - hide the security checkbox as the security settings are derived from the ServiceUrl\n\t\t\t\t$(\".share-secured, .share-secure-lbl\").hide();\n\t\t\t}\n\n\t\t\t// handle scroll buttons\n\t\t\tvar deltaScroll = $(\".share-icons-container .icon-border\").width() + parseInt($(\".share-icons-container .icon-border\").css(\"margin-right\"))*2;\n\t\t\t$(\".share-icons-scroller .next-btn\").on(\"click\", function(){\n\t\t\t\t$(\".share-icons-scroller .back-btn\").show();\n\t\t\t\t$('.share-icons-container').animate({scrollLeft: '+='+deltaScroll }, 300, function(){\n\t\t\t\t\tif (Math.round($('.share-icons-container').scrollLeft()/deltaScroll) === ($(\".icon-border\").length - 5) ){\n\t\t\t\t\t\t$(\".share-icons-scroller .next-btn\").hide();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t$(\".share-icons-scroller .back-btn\").on(\"click\", function(){\n\t\t\t\t$(\".share-icons-scroller .next-btn\").show();\n\t\t\t\t$('.share-icons-container').animate({scrollLeft: '-='+deltaScroll }, 300, function(){\n\t\t\t\t\tif ($('.share-icons-container').scrollLeft() === 0){\n\t\t\t\t\t\t$(\".share-icons-scroller .back-btn\").hide();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t\tsetTimeout(function(){\n\t\t\t\t_this.addScroll(); // add scroll for social network icons if needed\n\t\t\t},0);\n\n\t\t\t// close button override\n\t\t\t$(\".share .icon-close\").on(\"mousedown\", function(e){\n\t\t\t\t_this.closeScreen();\n\t\t\t})\n\t\t\t.keyup(function (e) {\n\t\t\t\tif(e.keyCode === 13){\n\t\t\t\t\t_this.closeScreen();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\taddScroll: function(){\n\t\t\tif ( $(\".icon-border\").length > 5 ){\n\t\t\t\t$(\".share-icons-container\").scrollLeft(0);\n\t\t\t\t$(\".share-icons-scroller .next-btn\").show();\n\t\t\t}\n\t\t},\n\n\t\trestrictNPTFields: function(){\n\t\t\t$(\".share-offset\").keydown(function (e) {\n\t\t\t\t// Allow: backspace, delete, tab, escape, enter and :\n\t\t\t\tif ($.inArray(e.keyCode, [46, 8, 9, 27, 13, 110, 186, 59]) !== -1 ||\n\t\t\t\t\t// Allow: Ctrl+A\n\t\t\t\t\t(e.keyCode == 65 && e.ctrlKey === true) ||\n\t\t\t\t\t// Allow: home, end, left, right\n\t\t\t\t\t(e.keyCode >= 35 && e.keyCode <= 39)) {\n\t\t\t\t\t// let it happen, don't do anything\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// Ensure that it is a number and stop the keypress\n\t\t\t\tif ((e.shiftKey || (e.keyCode < 48 || e.keyCode > 57)) && (e.keyCode < 96 || e.keyCode > 105)) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tsetShareTimeOffset: function(offset){\n\t\t\tvar shareLink = $(\".share-input\").val();\n\t\t\tshareLink = shareLink.split(\"#\")[0];\n\t\t\tif ( this.validateTimeOffset(offset) ){\n\t\t\t\tshareLink = shareLink + \"#t=\" + offset;\n\t\t\t}\n\t\t\t$(\".share-input\").val(shareLink);\n\t\t\tthis.setConfig(\"shareURL\", shareLink);\n\t\t},\n\n\t\tsetEmbedTimeOffset: function(offset){\n\t\t\tvar embedCode = $(\".embed-input\").val();\n\t\t\t// remove any existing mediaProxy.mediaPlayFrom flashvars previously defined\n\t\t\tif ( embedCode.indexOf(\"mediaProxy.mediaPlayFrom\") !== -1 ){\n\t\t\t\tembedCode = embedCode.replace( /flashvars\\[mediaProxy.mediaPlayFrom\\]=(.*?)&/ ,\"\");\n\t\t\t}\n\t\t\tif ( this.validateTimeOffset(offset) ){\n\t\t\t\tembedCode = embedCode.split(\"?\").join(\"?flashvars[mediaProxy.mediaPlayFrom]=\" + mw.npt2seconds(offset) + \"&\");\n\t\t\t}\n\t\t\t$(\".embed-input\").val(embedCode);\n\t\t},\n\n\t\tvalidateTimeOffset: function(offset){\n\t\t\t$(\".share-alert\").text(\"\").hide();\n\t\t\tif ( mw.npt2seconds(offset) > this.getPlayer().duration ){\n\t\t\t\t$(\".share-alert\").text(this.locale.errDuration).show();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif ( parseInt(offset) > 59 && offset.indexOf(\":\") === -1 ){\n\t\t\t\t$(\".share-alert\").text(this.locale.errFormat).show();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif ( mw.npt2seconds(offset) === 0 ){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\tcloseScreen: function(){\n\t\t\tif (this.getPlayer().getPlayerElement()) {\n\t\t\t\t$(  \"#\" + this.getPlayer().getPlayerElement().id ).removeClass( \"blur\" );\n\t\t\t\tthis.getPlayer().getPlayerPoster().removeClass( \"blur\" );\n\t\t\t}\n\t\t\t$(\".embed-offset-container\").hide();\n\t\t\t$(\".embed-container>.share-copy-btn\").hide();\n\t\t\t$(\".share-offset-container\").hide();\n\t\t\t$(\".share-container>.share-copy-btn\").hide();\n\t\t\t$(\".share-offset\").val(\"00:00\");\n\t\t\t$(\".share-alert\").hide();\n\t\t\t$('.share-secured').attr('checked', false);\n\t\t\tthis.enablePlayDuringScreen = false;\n\t\t\tthis.hideScreen();\n\t\t},\n\n\t\topenPopup: function (e, network) {\n\n\t\t\t// Maintain backward compatibility \n\t\t\tif( e && e.originalEvent ) {\n\t\t\t\tnetwork = {\n\t\t\t\t\tid: $(e.target).attr('id'),\n\t\t\t\t\turl: $(e.target).parents('a').attr('href')\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tvar embedPlayer = this.getPlayer();\n\t\t\tvar url = network.url;\n\t\t\turl = decodeURIComponent(url);        // url was encoded to keep curly brackets for template tokens\n\t\t\turl = this.getPlayer().evaluate(url); // replace tokens\n\t\t\turl = url.replace('#','%23'); // encode hash sign to keep time offset\n\t\t\tvar networks = this.getConfig('shareConfig');\n\t\t\t// send event for analytics\n\t\t\t$( embedPlayer ).trigger( \"socialShareEvent\", networks[network.id] );\n\t\t\tif (mw.isNativeApp()) {\n\t\t\t\tvar id = network.id;\n\t\t\t\tvar shareParams = {\n\t\t\t\t\tactionType: 'share',\n\t\t\t\t\tid: id[0].toUpperCase() + id.substr(1),\n\t\t\t\t\tsharedLink: this.getConfig(\"shareURL\"),\n\t\t\t\t\tshareNetwork: networks[id],\n\t\t\t\t\tthumbnail: this.getThumbnailURL(),\n\t\t\t\t\tvideoName: this.getPlayer().evaluate(\"{mediaProxy.entry.name}\")\n\t\t\t\t};\n\t\t\t\tembedPlayer.doNativeAction(JSON.stringify(shareParams));\n\t\t\t} else {\n\t\t\t\tif ( mw.isIphone() && url.indexOf(\"mailto\") === 0){\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\twindow.location = url;\n\t\t\t\t}else{\n\t\t\t\t\tvar opener = window.open(url,'_blank','width=626,height=436');\n\t\t\t\t\t// close the window if this is an email\n\t\t\t\t\tif (url.indexOf(\"mailto\") === 0){\n\t\t\t\t\t\tsetTimeout(function(){\n\t\t\t\t\t\t\tif (opener && typeof opener.close === 'function') {\n\t\t\t\t\t\t\t\topener.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},2000);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tgetThumbnailURL: function () {\n\t\t\treturn kWidgetSupport.getKalturaThumbnailUrl({\n\t\t\t\turl: this.getPlayer().evaluate('{mediaProxy.entry.thumbnailUrl}'),\n\t\t\t\twidth: this.getPlayer().getWidth(),\n\t\t\t\theight: this.getPlayer().getHeight()\n\t\t\t});\n\t\t},\n\t\t// setup embed code\n\t\tsetupEmbedCode: function(){\n\t\t\tvar embedCode = this.getConfig(\"embedCodeTemplate\",true);\n\t\t\tvar embedConfig = this.getConfig(\"embedOptions\");\n\t\t\tvar embedPlayer = this.getPlayer();\n\n\t\t\t// replace properties that come from configuration\n\t\t\tif (embedConfig[\"uiconfID\"]){\n\t\t\t\tembedCode = embedCode.split(\"{configProxy.kw.uiConfId}\").join(embedConfig[\"uiconfID\"]);\n\t\t\t}\n\t\t\tif ( embedConfig[\"streamerType\"] ){\n\t\t\t\tembedCode = embedCode.replace( /streamerType\\]=(.*?)\"/ ,'streamerType]=' + embedConfig[\"streamerType\"] + '\"');\n\t\t\t}\n\t\t\tif ( embedConfig[\"width\"] ){\n\t\t\t\tembedCode = embedCode.replace( /width=\"(.*?)\"/ ,'width=\"' + embedConfig[\"width\"] + '\"');\n\t\t\t}\n\t\t\tif ( embedConfig[\"height\"] ){\n\t\t\t\tembedCode = embedCode.replace( /height=\"(.*?)\"/ ,'height=\"' + embedConfig[\"height\"] + '\"');\n\t\t\t}\n\t\t\tif ( embedConfig[\"borderWidth\"] ){\n\t\t\t\tembedCode = embedCode.replace( /frameborder=\"(.*?)\"/ ,'frameborder=\"' + embedConfig[\"borderWidth\"] + '\"');\n\t\t\t}\n\t\t\t// replace tokens in template\n\t\t\tembedCode = embedPlayer.evaluate(embedCode);\n\t\t\t// save embed code to Flashvar to be used later\n\t\t\tthis.setConfig('embedCode', embedCode);\n\t\t},\n\t\t// -------------- start setup player url according to the socialShareURL flashvar ------- //\n\t\tsetupPlayerURL: function () {\n\t\t\tvar shareURL = null;\n\t\t\tswitch (this.getConfig('socialShareURL')) {\n\t\t\t\tcase 'smart':\n\t\t\t\t\tshareURL = this.getSmartURL();\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'parent':\n\t\t\t\t\tshareURL = this.getParentURL();\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tshareURL = this.getConfig(\"socialShareURL\");\n\t\t\t}\n\t\t\tif (shareURL) {\n\t\t\t\tthis.setConfig('shareURL', shareURL);\n\t\t\t}\n\t\t},\n\t\tgetSmartURL: function () {\n\t\t\tvar shareURL = this.getKalturaShareURL();\n\t\t\tif (mw.getConfig('EmbedPlayer.IsFriendlyIframe')) {\n\t\t\t\ttry {\n\t\t\t\t\tvar $parentDoc = $(window['parent'].document);\n\t\t\t\t\tvar hasOpenGraphTags = $parentDoc.find('meta[property=\"og:video\"]').length;\n\t\t\t\t\tvar hasTwitterCardsTags = $parentDoc.find('meta[name=\"twitter:player\"]').length;\n\t\t\t\t\tif (hasOpenGraphTags || hasTwitterCardsTags) {\n\t\t\t\t\t\tshareURL = this.getParentURL();\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn shareURL;\n\t\t},\n\t\tgetKalturaShareURL: function () {\n\t\t\tvar uiConfId = this.getConfig(\"shareUiconfID\") ? this.getConfig(\"shareUiconfID\") : this.getPlayer().kuiconfid;\n\t\t\treturn mw.getConfig('Kaltura.ServiceUrl') + '/index.php/extwidget/preview' +\n\t\t\t\t'/partner_id/' + this.getPlayer().kpartnerid +\n\t\t\t\t'/uiconf_id/' + uiConfId +\n\t\t\t\t'/entry_id/' + this.getPlayer().kentryid + '/embed/dynamic';\n\t\t},\n\t\tgetParentURL: function () {\n\t\t\tvar res;\n\t\t\tif (mw.getConfig('EmbedPlayer.IframeParentUrl')) {\n\t\t\t\tres = mw.getConfig('EmbedPlayer.IframeParentUrl');\n\t\t\t} else {\n\t\t\t\tres = document.referrer;\n\t\t\t\tif (res === \"\") {\n\t\t\t\t\tres = document.URL;\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar sanitized = kWidget.sanitize(decodeURIComponent(res));\n\t\t\treturn encodeURIComponent(sanitized);\n\t\t}\n\t\t// -------------- finish setup player url according to the socialShareURL flashvar ------- //\n\n\t}));\n\n})(window.mw, window.jQuery);\n"], "filenames": ["modules/KalturaSupport/components/share/share.js"], "buggy_code_start_loc": [619], "buggy_code_end_loc": [620], "fixing_code_start_loc": [619], "fixing_code_end_loc": [621], "type": "CWE-79", "message": "A vulnerability was found in kaltura mwEmbed up to 2.91. It has been rated as problematic. Affected by this issue is some unknown functionality of the file modules/KalturaSupport/components/share/share.js of the component Share Plugin. The manipulation of the argument res leads to cross site scripting. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 2.92.rc1 is able to address this issue. The name of the patch is 4f11b6f6610acd6d89de5f8be47cf7c610643845. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-217664.", "other": {"cve": {"id": "CVE-2022-4882", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-09T09:15:10.140", "lastModified": "2023-01-13T13:22:20.230", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in kaltura mwEmbed up to 2.91. It has been rated as problematic. Affected by this issue is some unknown functionality of the file modules/KalturaSupport/components/share/share.js of the component Share Plugin. The manipulation of the argument res leads to cross site scripting. The attack may be launched remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 2.92.rc1 is able to address this issue. The name of the patch is 4f11b6f6610acd6d89de5f8be47cf7c610643845. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-217664."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 2.6, "baseSeverity": "LOW"}, "exploitabilityScore": 1.2, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:H/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "HIGH", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 2.1}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kaltura:mwembed:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.9.1", "matchCriteriaId": "007EEF35-49C2-4E95-ACB5-D03B70E65BDD"}]}]}], "references": [{"url": "https://github.com/kaltura/mwEmbed/commit/4f11b6f6610acd6d89de5f8be47cf7c610643845", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/kaltura/mwEmbed/pull/4255", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/kaltura/mwEmbed/releases/tag/v2.92.rc1", "source": "cna@vuldb.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.217664", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.217664", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/kaltura/mwEmbed/commit/4f11b6f6610acd6d89de5f8be47cf7c610643845"}}