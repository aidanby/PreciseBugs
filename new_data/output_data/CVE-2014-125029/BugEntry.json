{"buggy_code": ["<?php\nuse Quartet\\Silex\\Provider\\PaginationServiceProvider;\nuse Silex\\Application;\nuse Silex\\Provider\\DoctrineServiceProvider;\nuse Silex\\Provider\\TwigServiceProvider;\nuse Symfony\\Component\\HttpFoundation\\Request;\n\nrequire_once __DIR__ . '/../vendor/autoload.php';\n\n$app = new Application();\n$app->register(new TwigServiceProvider());\n$app['twig.path'] = array(__DIR__);\n$app->register(new PaginationServiceProvider());\n\n// just for demo.\n$app['knp_paginator.path'] = __DIR__ . '/../vendor/knplabs/knp-paginator-bundle';\n\n// sample configuration.\n$app['knp_paginator.options'] = array(\n    'template' => array(\n        'pagination' => '@quartet_silex_pagination/pagination-bootstrap3.html.twig',\n    ),\n    'page_range' => 6,\n);\n\n// sample data.\n$app->register(new DoctrineServiceProvider(), [\n    'db.options' => [\n        'driver' => 'pdo_sqlite',\n        'path' => __DIR__ . '/sample.db',\n    ],\n]);\n\n$app->get('/', function (Request $request) use ($app) {\n\n    $page = $request->get('page', 1);\n    $limit = $request->get('limit', 10);\n    $sort = $request->get('sort', 'id');\n    $direction = $request->get('direction', 'asc');\n\n    $sql = \"select * from sample order by \\\"{$sort}\\\" {$direction}\";\n    $array = $app['db']->fetchAll($sql);\n\n    $pagination = $app['knp_paginator']->paginate($array, $page, $limit);\n\n    return $app['twig']->render('index.html.twig', array(\n        'pagination' => $pagination,\n    ));\n})\n;\n\n$app->get('/raw', function () use ($app) {\n    $code = file_get_contents(__DIR__ . '/index.html.twig');\n    return '<pre>' . htmlspecialchars($code) . '</pre>';\n})\n;\n\n$app->run();\n"], "fixing_code": ["<?php\nuse Quartet\\Silex\\Provider\\PaginationServiceProvider;\nuse Silex\\Application;\nuse Silex\\Provider\\DoctrineServiceProvider;\nuse Silex\\Provider\\TwigServiceProvider;\nuse Symfony\\Component\\HttpFoundation\\Request;\n\nrequire_once __DIR__ . '/../vendor/autoload.php';\n\n$app = new Application();\n$app->register(new TwigServiceProvider());\n$app['twig.path'] = array(__DIR__);\n$app->register(new PaginationServiceProvider());\n\n// just for demo.\n$app['knp_paginator.path'] = __DIR__ . '/../vendor/knplabs/knp-paginator-bundle';\n\n// sample configuration.\n$app['knp_paginator.options'] = array(\n    'template' => array(\n        'pagination' => '@quartet_silex_pagination/pagination-bootstrap3.html.twig',\n    ),\n    'page_range' => 6,\n);\n\n// sample data.\n$app->register(new DoctrineServiceProvider(), [\n    'db.options' => [\n        'driver' => 'pdo_sqlite',\n        'path' => __DIR__ . '/sample.db',\n    ],\n]);\n\n$app->get('/', function (Request $request) use ($app) {\n\n    $page = $request->get('page', 1);\n    $limit = $request->get('limit', 10);\n    $sort = $app['db']->quoteIdentifier($request->get('sort', 'id'));\n    $direction = $request->get('direction') === 'desc' ? 'DESC' : 'ASC';\n\n    $sql = \"select * from sample order by {$sort} {$direction}\";\n    $array = $app['db']->fetchAll($sql);\n\n    $pagination = $app['knp_paginator']->paginate($array, $page, $limit);\n\n    return $app['twig']->render('index.html.twig', array(\n        'pagination' => $pagination,\n    ));\n})\n;\n\n$app->get('/raw', function () use ($app) {\n    $code = file_get_contents(__DIR__ . '/index.html.twig');\n    return '<pre>' . htmlspecialchars($code) . '</pre>';\n})\n;\n\n$app->run();\n"], "filenames": ["demo/index.php"], "buggy_code_start_loc": [38], "buggy_code_end_loc": [42], "fixing_code_start_loc": [38], "fixing_code_end_loc": [42], "type": "CWE-89", "message": "A vulnerability was found in ttskch PaginationServiceProvider up to 0.x. It has been declared as critical. This vulnerability affects unknown code of the file demo/index.php of the component demo. The manipulation of the argument sort/id leads to sql injection. Upgrading to version 1.0.0 is able to address this issue. The name of the patch is 619de478efce17ece1a3b913ab16e40651e1ea7b. It is recommended to upgrade the affected component. VDB-217150 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2014-125029", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-07T22:15:08.637", "lastModified": "2023-01-12T20:05:10.673", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in ttskch PaginationServiceProvider up to 0.x. It has been declared as critical. This vulnerability affects unknown code of the file demo/index.php of the component demo. The manipulation of the argument sort/id leads to sql injection. Upgrading to version 1.0.0 is able to address this issue. The name of the patch is 619de478efce17ece1a3b913ab16e40651e1ea7b. It is recommended to upgrade the affected component. VDB-217150 is the identifier assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 5.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.1, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 5.2}, "baseSeverity": "MEDIUM", "exploitabilityScore": 5.1, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:paginationserviceprovider_project:paginationserviceprovider:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.0.0", "matchCriteriaId": "8540D3E9-7691-43A1-8632-D2B5750E0FBE"}]}]}], "references": [{"url": "https://github.com/ttskch/PaginationServiceProvider/commit/619de478efce17ece1a3b913ab16e40651e1ea7b", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/ttskch/PaginationServiceProvider/releases/tag/1.0.0", "source": "cna@vuldb.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.217150", "source": "cna@vuldb.com", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://vuldb.com/?id.217150", "source": "cna@vuldb.com", "tags": ["Third Party Advisory", "VDB Entry"]}]}, "github_commit_url": "https://github.com/ttskch/PaginationServiceProvider/commit/619de478efce17ece1a3b913ab16e40651e1ea7b"}}