{"buggy_code": ["<?php\ninclude_once('./_common.php');\n\nif($w == '')\n    $mb_id = isset($_POST['mb_id']) ? trim($_POST['mb_id']) : '';\nelse\n    alert('\uc798\ubabb\ub41c \uc811\uadfc\uc785\ub2c8\ub2e4', G5_URL);\n\nif(!$mb_id)\n    alert('\ud68c\uc6d0\uc544\uc774\ub514 \uac12\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. \uc62c\ubc14\ub978 \ubc29\ubc95\uc73c\ub85c \uc774\uc6a9\ud574 \uc8fc\uc2ed\uc2dc\uc624.');\n\n$mb_password    = isset($_POST['mb_password']) ? trim($_POST['mb_password_re']) : '';\n$mb_password_re = isset($_POST['mb_password_re']) ? trim($_POST['mb_password_re']) : '';\n\n\nif ($w == '' && !$mb_password)\nalert('\ube44\ubc00\ubc88\ud638\uac00 \ub118\uc5b4\uc624\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.');\nif($w == '' && $mb_password != $mb_password_re)\nalert('\ube44\ubc00\ubc88\ud638\uac00 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.');\n\n$sql_password = \"\";\nif ($mb_password)\n    $sql_password = \"mb_password = '\".get_encrypt_string($mb_password).\"' \";\n\nsql_query(\"update {$g5['member_table']} set {$sql_password} where mb_id = '{$mb_id}'\");\n\ngoto_url(G5_BBS_URL.'/login.php');", "<?php\nif (!defined('_GNUBOARD_')) exit; // \uac1c\ubcc4 \ud398\uc774\uc9c0 \uc811\uadfc \ubd88\uac00\n\n// add_stylesheet('css \uad6c\ubb38', \ucd9c\ub825\uc21c\uc11c); \uc22b\uc790\uac00 \uc791\uc744 \uc218\ub85d \uba3c\uc800 \ucd9c\ub825\ub428\nadd_stylesheet('<link rel=\"stylesheet\" href=\"' . $member_skin_url . '/style.css\">', 0);\n?>\n\n<!-- \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \uc2dc\uc791 { -->\n<div id=\"pw_reset\" class=\"new_win\">\n    <div class=\"new_win_con\">\n        <form name=\"fpasswordreset\" action=\"<?php echo $action_url; ?>\" onsubmit=\"return fpasswordreset_submit(this);\" method=\"post\" autocomplete=\"off\">\n            <fieldset id=\"info_fs\">\n                <p>\uc0c8\ub85c\uc6b4 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.</p>\n                <label for=\"mb_id\" class=\"sound_only\">\uc544\uc774\ub514</label>\n                <input type=\"text\" name=\"mb_id\" id=\"mb_id\" value=\"<?php echo $_POST['mb_id']; ?>\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc544\uc774\ub514\" readonly>\n                <label for=\"mb_pw\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password\" id=\"mb_pw\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638\">\n                <label for=\"mb_pw2\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password_re\" id=\"mb_pw2\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778\">\n            </fieldset>\n            <div class=\"win_btn\">\n                <button type=\"submit\" class=\"btn_submit\">\ud655\uc778</button>\n            </div>\n        </form>\n    </div>\n</div>\n\n<script>\nfunction fpasswordreset_submit(f) {\n    if ($(\"#mb_pw\").val() == $(\"#mb_pw2\").val()) {\n        alert(\"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574 \uc8fc\uc138\uc694.\");\n    } else {\n        alert(\"\uc0c8 \ube44\ubc00\ubc88\ud638\uc640 \ube44\ubc00\ubc88\ud638 \ud655\uc778\uc774 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\");\n        return false;\n    }\n}\n</script>\n<!-- } \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \ub05d -->", "<?php\ninclude_once('./_common.php');\n\n$txId = $_POST['txId'];\n$mid  = substr($txId, 6, 10);\n\nif ($_POST[\"resultCode\"] === \"0000\") { \n\n    $data = array(\n        'mid' => $mid,        \n        'txId' => $txId\n    );\n\n    $post_data = json_encode($data);\n\n    // curl \ud1b5\uc2e0 \uc2dc\uc791 \n    $ch = curl_init();\n    curl_setopt($ch, CURLOPT_URL, $_POST[\"authRequestUrl\"]);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 10);\n    curl_setopt($ch, CURLOPT_POSTFIELDS, $post_data);\n    curl_setopt($ch, CURLOPT_POST, 1);\n    curl_setopt($ch, CURLOPT_HTTPHEADER, array('Accept: application/json', 'Content-Type: application/json'));\n    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);\n    \n    $response = curl_exec($ch);\n    curl_close($ch);\n    $res_data = json_decode($response, true);\n\n    if($res_data['resultCode'] === \"0000\") {\n\n        $cert_type      = 'simple';                                 // \uc778\uc99d\ud0c0\uc785\n        $cert_no        = $res_data['txId'];                    // \uc774\ub2c8\uc2dc\uc2a4 \ud2b8\ub79c\uc7ad\uc158 ID\n        $phone_no       = $res_data['userPhone'];               // \uc804\ud654\ubc88\ud638\n        $user_name      = $res_data['userName'];                // \uc774\ub984\n        $birth_day      = $res_data['userBirthday'];            // \uc0dd\ub144\uc6d4\uc77c\n        $ci             = $res_data['userCi'];                  // CI           \n\n        @insert_cert_history($member['mb_id'], 'inicis', $cert_type); // \uc778\uc99d\uc131\uacf5 \uc2dc \ub0b4\uc5ed \uae30\ub85d\n\n        if(!$phone_no)\n        alert_close(\"\uc815\uc0c1\uc801\uc778 \uc778\uc99d\uc774 \uc544\ub2d9\ub2c8\ub2e4. \uc62c\ubc14\ub978 \ubc29\ubc95\uc73c\ub85c \uc774\uc6a9\ud574 \uc8fc\uc138\uc694.\");\n\n        $md5_ci = md5($ci . $ci);\n        $phone_no = hyphen_hp_number($phone_no);\n        $mb_dupinfo = $md5_ci;\n\n        $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$mb_dupinfo}'\"); // ci\ub370\uc774\ud130\ub85c \ucc3e\uc74c\n        if(empty($row['mb_id'])) { // ci\ub85c \ub4f1\ub85d\ub41c \uacc4\uc815\uc774 \uc5c6\ub2e4\uba74\n            alert_close(\"\uc778\uc99d\ud558\uc2e0 \uc815\ubcf4\ub85c \uac00\uc785\ub41c \ud68c\uc6d0\uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.\");\n            exit;                \n        }\n    } else {\n        // \uc778\uc99d\uc2e4\ud328 curl\uc758 \uc778\uc99d\uc2e4\ud328 \uccb4\ud06c\n        alert_close('\ucf54\ub4dc : '.$res_data['resultCode'].'  '.urldecode($res_data['resultMsg']));\n        exit;\n    }\n} else {   // resultCode===0000 \uc544\ub2d0\uacbd\uc6b0 \uc544\ub798 \uc778\uc99d \uc2e4\ud328\ub97c \ucd9c\ub825\ud568 \n    // \uc778\uc99d\uc2e4\ud328\n    alert_close('\ucf54\ub4dc : '.$_POST['resultCode'].'  '.urldecode($_POST['resultMsg']));\n    exit;\n}\n\n$g5['title'] = 'KG\uc774\ub2c8\uc2dc\uc2a4 \uac04\ud3b8\uc778\uc99d \uacb0\uacfc';\ninclude_once(G5_PATH.'/head.sub.php'); \n?>\n<form name=\"mbFindForm\" method=\"POST\">\n<input type=\"hidden\" name=\"mb_id\" value=\"<?php echo $row[\"mb_id\"]; ?>\">    \n</form>\n<script>\n    jQuery(function($) {\n        \n        var $opener = window.opener;\n        var is_mobile = false;        \n        $opener.name=\"parentPage\";\n\n        if (typeof g5_is_mobile != \"undefined\" && g5_is_mobile ) {\n            $opener = window.parent;\n            is_mobile = true;\n        } else {\n            $opener = window.opener;\n        }\n            \n        document.mbFindForm.target = \"parentPage\";\n        document.mbFindForm.action = \"<?php echo G5_BBS_URL.'/password_reset.php'?>\";\n        document.mbFindForm.submit();\n\n        alert(\"\ubcf8\uc778\uc778\uc99d\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\");\n        window.close();        \n    });\n</script>\n<?php\ninclude_once(G5_PATH.'/tail.sub.php');", "<?php\ninclude_once('./_common.php');\ninclude_once(G5_KCPCERT_PATH.'/kcpcert_config.php');\n\n$site_cd       = \"\";\n$ordr_idxx     = \"\";\n\n$cert_no       = \"\";\n$cert_enc_use  = \"\";\n$enc_info      = \"\";\n$enc_data      = \"\";\n$req_tx        = \"\";\n\n$enc_cert_data = \"\";\n$cert_info     = \"\";\n\n$tran_cd       = \"\";\n$res_cd        = \"\";\n$res_msg       = \"\";\n\n$dn_hash       = \"\";\n\n/*------------------------------------------------------------------------*/\n/*  :: \uc804\uccb4 \ud30c\ub77c\ubbf8\ud130 \ub0a8\uae30\uae30                                               */\n/*------------------------------------------------------------------------*/\n\n// request \ub85c \ub118\uc5b4\uc628 \uac12 \ucc98\ub9ac\n$key = array_keys($_POST);\n$sbParam =\"\";\n\nfor($i=0; $i<count($key); $i++)\n{\n    $nmParam = $key[$i];\n    $valParam = $_POST[$nmParam];\n\n    if ( $nmParam == \"site_cd\" )\n    {\n        $site_cd = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"ordr_idxx\" )\n    {\n        $ordr_idxx = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"res_cd\" )\n    {\n        $res_cd = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"cert_enc_use\" )\n    {\n        $cert_enc_use = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"req_tx\" )\n    {\n        $req_tx = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"cert_no\" )\n    {\n        $cert_no = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"enc_cert_data\" )\n    {\n        $enc_cert_data = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"dn_hash\" )\n    {\n        $dn_hash = f_get_parm_str ( $valParam );\n   }\n\n    // \ubd80\ubaa8\ucc3d\uc73c\ub85c \ub118\uae30\ub294 form \ub370\uc774\ud130 \uc0dd\uc131 \ud544\ub4dc\n    $sbParam .= \"<input type='hidden' name='\" . $nmParam . \"' value='\" . f_get_parm_str( $valParam ) . \"'/>\";\n}\n\n$ct_cert = new C_CT_CLI;\n$ct_cert->mf_clear();\n\n\n$g5['title'] = '\ud734\ub300\ud3f0\uc778\uc99d \uacb0\uacfc';\ninclude_once(G5_PATH.'/head.sub.php');\n\n// \uacb0\uacfc \ucc98\ub9ac\n\nif( $cert_enc_use == \"Y\" )\n{\n    // \uc778\uc99d\ub0b4\uc5ed\uae30\ub85d\n    @insert_cert_history($member['mb_id'], 'kcp', 'hp');\n\n    if( $res_cd == \"0000\" )\n    {\n        // dn_hash \uac80\uc99d\n        // KCP \uac00 \ub9ac\ud134\ud574 \ub4dc\ub9ac\ub294 dn_hash \uc640 \uc0ac\uc774\ud2b8 \ucf54\ub4dc, \uc8fc\ubb38\ubc88\ud638 , \uc778\uc99d\ubc88\ud638\ub97c \uac80\uc99d\ud558\uc5ec\n        // \ud574\ub2f9 \ub370\uc774\ud130\uc758 \uc704\ubcc0\uc870\ub97c \ubc29\uc9c0\ud569\ub2c8\ub2e4\n         $veri_str = $site_cd.$ordr_idxx.$cert_no; // \uc0ac\uc774\ud2b8 \ucf54\ub4dc + \uc8fc\ubb38\ubc88\ud638 + \uc778\uc99d\uac70\ub798\ubc88\ud638\n\n        if ( $ct_cert->check_valid_hash ( $home_dir , $dn_hash , $veri_str ) != \"1\" )\n        {\n            if(strtoupper(substr(PHP_OS, 0, 3)) !== 'WIN') {\n                // \uac80\uc99d \uc2e4\ud328\uc2dc \ucc98\ub9ac \uc601\uc5ed\n                if(PHP_INT_MAX == 2147483647) // 32-bit\n                    $bin_exe = '/bin/ct_cli';\n                else\n                    $bin_exe = '/bin/ct_cli_x64';\n            } else {\n                $bin_exe = '/bin/ct_cli_exe.exe';\n            }\n\n            echo \"dn_hash \ubcc0\uc870 \uc704\ud5d8\uc788\uc74c (\".G5_KCPCERT_PATH.$bin_exe.\" \ud30c\uc77c\uc5d0 \uc2e4\ud589\uad8c\ud55c\uc774 \uc788\ub294\uc9c0 \ud655\uc778\ud558\uc138\uc694.)\";\n            exit;\n            // \uc624\ub958 \ucc98\ub9ac ( dn_hash \ubcc0\uc870 \uc704\ud5d8\uc788\uc74c)\n        }\n\n        // \uac00\ub9f9\uc810 DB \ucc98\ub9ac \ud398\uc774\uc9c0 \uc601\uc5ed\n\n        // \uc778\uc99d\ub370\uc774\ud130 \ubcf5\ud638\ud654 \ud568\uc218\n        // \ud574\ub2f9 \ud568\uc218\ub294 \uc554\ud638\ud654\ub41c enc_cert_data \ub97c\n        // site_cd \uc640 cert_no \ub97c \uac00\uc9c0\uace0 \ubcf5\ud654\ud654 \ud558\ub294 \ud568\uc218 \uc785\ub2c8\ub2e4.\n        // \uc815\uc0c1\uc801\uc73c\ub85c \ubcf5\ud638\ud654 \ub41c\uacbd\uc6b0\uc5d0\ub9cc \uc778\uc99d\ub370\uc774\ud130\ub97c \uac00\uc838\uc62c\uc218 \uc788\uc2b5\ub2c8\ub2e4.\n        $opt = \"1\" ; // \ubcf5\ud638\ud654 \uc778\ucf54\ub529 \uc635\uc158 ( UTF - 8 \uc0ac\uc6a9\uc2dc \"1\" )\n        $ct_cert->decrypt_enc_cert( $home_dir , $site_cd , $cert_no , $enc_cert_data , $opt );\n\n        $comm_id        = $ct_cert->mf_get_key_value(\"comm_id\"    );                // \uc774\ub3d9\ud1b5\uc2e0\uc0ac \ucf54\ub4dc\n        $phone_no       = $ct_cert->mf_get_key_value(\"phone_no\"   );                // \uc804\ud654\ubc88\ud638\n        $user_name      = $ct_cert->mf_get_key_value(\"user_name\"  );                // \uc774\ub984\n        $birth_day      = $ct_cert->mf_get_key_value(\"birth_day\"  );                // \uc0dd\ub144\uc6d4\uc77c\n        $sex_code       = $ct_cert->mf_get_key_value(\"sex_code\"   );                // \uc131\ubcc4\ucf54\ub4dc\n        $local_code     = $ct_cert->mf_get_key_value(\"local_code\" );                // \ub0b4/\uc678\uad6d\uc778 \uc815\ubcf4\n        $ci             = $ct_cert->mf_get_key_value(\"ci\"         );                // CI\n        $di             = $ct_cert->mf_get_key_value(\"di\"         );                // DI \uc911\ubcf5\uac00\uc785 \ud655\uc778\uac12\n        $ci_url         = urldecode( $ct_cert->mf_get_key_value(\"ci\"         ) );   // CI\n        $di_url         = urldecode( $ct_cert->mf_get_key_value(\"di\"         ) );   // DI \uc911\ubcf5\uac00\uc785 \ud655\uc778\uac12\n        $dec_res_cd     = $ct_cert->mf_get_key_value(\"res_cd\"     );                // \uc554\ud638\ud654\ub41c \uacb0\uacfc\ucf54\ub4dc\n        $dec_mes_msg    = $ct_cert->mf_get_key_value(\"res_msg\"    );                // \uc554\ud638\ud654\ub41c \uacb0\uacfc\uba54\uc2dc\uc9c0\n\n        if(strtoupper(substr(PHP_OS, 0, 3)) === 'WIN' && function_exists('mb_detect_encoding') ){\n            if( mb_detect_encoding($user_name, 'EUC-KR') === 'EUC-KR' ){\n                $user_name = iconv_utf8($user_name);\n                $dec_mes_msg = iconv_utf8($dec_mes_msg);\n            }\n        }\n\n        // \uc815\uc0c1\uc778\uc99d\uc778\uc9c0 \uccb4\ud06c\n        if(!$phone_no)\n            alert_close(\"\uc815\uc0c1\uc801\uc778 \uc778\uc99d\uc774 \uc544\ub2d9\ub2c8\ub2e4. \uc62c\ubc14\ub978 \ubc29\ubc95\uc73c\ub85c \uc774\uc6a9\ud574 \uc8fc\uc138\uc694.\");\n\n        $phone_no = hyphen_hp_number($phone_no);\n        $mb_dupinfo = $di;\n        $md5_ci = md5($ci.$ci);\n\n        $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$md5_ci}'\"); // ci\ub370\uc774\ud130\ub85c \ucc3e\uc74c\n        if (empty($row['mb_id'])) { // ci\ub85c \ub4f1\ub85d\ub41c \uacc4\uc815\uc774 \uc5c6\ub2e4\uba74\n            $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$mb_dupinfo}'\"); // di\ub370\uc774\ud130\ub85c \ucc3e\uc74c\n            if (empty($row['mb_id'])) { // di\ub85c \ub4f1\ub85d\ub41c \uacc4\uc815\ub3c4 \uc5c6\ub2e4\uba74\n                alert_close(\"\uc778\uc99d\ud558\uc2e0 \uc815\ubcf4\ub85c \uac00\uc785\ub41c \ud68c\uc6d0\uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.\");\n                exit;\n            }\n        }\n    }\n    else if( $res_cd != \"0000\" )\n    {\n        // \uc778\uc99d\uc2e4\ud328\n        alert_close('\ucf54\ub4dc : '.$_POST['res_cd'].'  '.urldecode($_POST['res_msg']));\n        exit;\n    }\n}\nelse if( $cert_enc_use != \"Y\" )\n{\n    // \uc554\ud638\ud654 \uc778\uc99d \uc548\ud568\n    if( G5_IS_MOBILE ){\n        echo '<script>'.PHP_EOL;\n        echo 'window.parent.$(\"#cert_info\").css(\"display\", \"\");'.PHP_EOL;\n        echo 'window.parent.$(\"#kcp_cert\" ).css(\"display\", \"none\");'.PHP_EOL;\n        echo '</script>'.PHP_EOL;\n    } else {\n        alert_close(\"\ud734\ub300\ud3f0 \ubcf8\uc778\ud655\uc778\uc744 \ucde8\uc18c \ud558\uc168\uc2b5\ub2c8\ub2e4.\");\n    }\n    exit;\n}\n\n$ct_cert->mf_clear();\n?>\n<form name=\"mbFindForm\" method=\"POST\">\n    <input type=\"hidden\" name=\"mb_id\" value=\"<?php echo $row[\"mb_id\"]; ?>\"> \n    <?php echo $sbParam; ?>   \n</form>\n<script>\n    jQuery(function($) {\n        \n        var $opener = window.opener;\n        var is_mobile = false;        \n        $opener.name=\"parentPage\";       \n\n        if (typeof g5_is_mobile != \"undefined\" && g5_is_mobile ) {\n            $opener = window.parent;\n            is_mobile = true;\n        } else {\n            $opener = window.opener;\n        }\n        \n        // up_hash \uac80\uc99d\n        if( document.mbFindForm.up_hash.value != $opener.$(\"input[name=veri_up_hash]\").val() ) {\n            alert(\"up_hash \ubcc0\uc870 \uc704\ud5d8\uc788\uc74c\");\n        }\n            \n        document.mbFindForm.target = \"parentPage\";\n        document.mbFindForm.action = \"<?php echo G5_BBS_URL.'/password_reset.php'?>\";\n        document.mbFindForm.submit();\n\n        alert(\"\ubcf8\uc778\uc778\uc99d\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\");\n        window.close();        \n    });\n</script>\n<?php\ninclude_once(G5_PATH.'/tail.sub.php');", "<?php\r\ninclude_once('./_common.php');\r\n\r\n$_POST = array_map_deep('conv_unescape_nl', $_POST);\r\n\r\n/*\r\n * [\ubcf8\uc778\ud655\uc778 \ucc98\ub9ac \ud398\uc774\uc9c0]\r\n *\r\n * LG\uc720\ud50c\ub7ec\uc2a4\uc73c\ub85c \ubd80\ud130 \ub0b4\ub824\ubc1b\uc740 LGD_AUTHONLYKEY(\uc778\uc99dKey)\ub97c \uac00\uc9c0\uace0 \ucd5c\uc885 \uc778\uc99d\uc694\uccad.(\ud30c\ub77c\ubbf8\ud130 \uc804\ub2ec\uc2dc POST\ub97c \uc0ac\uc6a9\ud558\uc138\uc694)\r\n */\r\n\r\n/*\r\n *************************************************\r\n * 1.\ucd5c\uc885\uc778\uc99d \uc694\uccad - BEGIN\r\n *************************************************\r\n */\r\n\r\n//LG\uc720\ud50c\ub7ec\uc2a4 \uacb0\uc81c \uc11c\ube44\uc2a4 \uc120\ud0dd(test:\ud14c\uc2a4\ud2b8, service:\uc11c\ube44\uc2a4)\r\nif($config['cf_cert_use'] == 2)\r\n    $CST_PLATFORM = 'service';\r\nelse\r\n    $CST_PLATFORM = 'test';\r\n$CST_MID                = 'si_'.$config['cf_lg_mid'];                       //\uc0c1\uc810\uc544\uc774\ub514(LG\uc720\ud50c\ub7ec\uc2a4\uc73c\ub85c \ubd80\ud130 \ubc1c\uae09\ubc1b\uc73c\uc2e0 \uc0c1\uc810\uc544\uc774\ub514\ub97c \uc785\ub825\ud558\uc138\uc694)\r\n                                                                            //\ud14c\uc2a4\ud2b8 \uc544\uc774\ub514\ub294 't'\ub97c \ubc18\ub4dc\uc2dc \uc81c\uc678\ud558\uace0 \uc785\ub825\ud558\uc138\uc694.\r\n$LGD_MID                = (('test' == $CST_PLATFORM) ? 't' : '').$CST_MID;  //\uc0c1\uc810\uc544\uc774\ub514(\uc790\ub3d9\uc0dd\uc131)\r\n$LGD_AUTHONLYKEY        = $_POST['LGD_AUTHONLYKEY'];\t\t\t            //LG\uc720\ud50c\ub7ec\uc2a4\uc73c\ub85c\ubd80\ud130 \ubd80\uc5ec\ubc1b\uc740 \uc778\uc99d\ud0a4\r\n$LGD_PAYTYPE  \t\t\t= $_POST['LGD_PAYTYPE'];\t\t\t\t            //\uc778\uc99d\uc694\uccad\ud0c0\uc785 (\uc2e0\uc6a9\uce74\ub4dc:ASC001, \ud734\ub300\ud3f0:ASC002, \uacc4\uc88c:ASC004)\r\n\r\nrequire_once(G5_LGXPAY_PATH.'/lgdacom/XPayClient.php');\r\n\r\n// mall.conf \uc124\uc815 \ucd94\uac00\ub97c \uc704\ud55c XPayClient \ud655\uc7a5\r\nclass XPay extends XPayClient\r\n{\r\n    public function set_config_value($key, $val)\r\n    {\r\n        $this->config[$key] = $val;\r\n    }\r\n}\r\n\r\n$configPath = G5_LGXPAY_PATH.'/lgdacom'; //LG\uc720\ud50c\ub7ec\uc2a4\uc5d0\uc11c \uc81c\uacf5\ud55c \ud658\uacbd\ud30c\uc77c(\"/conf/lgdacom.conf,/conf/mall.conf\") \uc704\uce58 \uc9c0\uc815.\r\n\r\n$xpay = new XPay($configPath, $CST_PLATFORM);\r\n\r\n// Mert Key \uc124\uc815\r\n$xpay->set_config_value('t'.$LGD_MID, $config['cf_lg_mert_key']);\r\n$xpay->set_config_value($LGD_MID, $config['cf_lg_mert_key']);\r\n\r\n$xpay->Init_TX($LGD_MID);\r\n$xpay->Set(\"LGD_TXNAME\", \"AuthOnlyByKey\");\r\n$xpay->Set(\"LGD_AUTHONLYKEY\", $LGD_AUTHONLYKEY);\r\n$xpay->Set(\"LGD_PAYTYPE\", $LGD_PAYTYPE);\r\n\r\n$g5['title'] = '\ud734\ub300\ud3f0\uc778\uc99d \uacb0\uacfc';\r\ninclude_once(G5_PATH.'/head.sub.php');\r\n\r\n/*\r\n *************************************************\r\n * 1.\ucd5c\uc885\uc778\uc99d \uc694\uccad(\uc218\uc815\ud558\uc9c0 \ub9c8\uc138\uc694) - END\r\n *************************************************\r\n */\r\n\r\n/*\r\n * 2. \ucd5c\uc885\uc778\uc99d \uc694\uccad \uacb0\uacfc\ucc98\ub9ac\r\n *\r\n * \ucd5c\uc885 \uc778\uc99d\uc694\uccad \uacb0\uacfc \ub9ac\ud134 \ud30c\ub77c\ubbf8\ud130\ub294 \uc5f0\ub3d9\uba54\ub274\uc5bc\uc744 \ucc38\uace0\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.\r\n */\r\nif ($xpay->TX()) {\r\n    //1)\uc778\uc99d\uacb0\uacfc \ud654\uba74\ucc98\ub9ac(\uc131\uacf5,\uc2e4\ud328 \uacb0\uacfc \ucc98\ub9ac\ub97c \ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.)\r\n    \r\n    /*\r\n    echo \"\uc778\uc99d\uc694\uccad\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.  <br>\";\r\n    echo \"TX Response_code = \" . $xpay->Response_Code() . \"<br>\";\r\n    echo \"TX Response_msg = \" . $xpay->Response_Msg() . \"<p>\";\r\n\r\n    $keys = $xpay->Response_Names();\r\n    foreach($keys as $name) {\r\n        echo $name . \" = \" . $xpay->Response($name, 0) . \"<br>\";\r\n    }\r\n\r\n    echo \"</p>\";\r\n    */\r\n\r\n    if( \"0000\" == $xpay->Response_Code() ) {\r\n        //\uc778\uc99d\uc694\uccad \uacb0\uacfc \uc131\uacf5 DB\ucc98\ub9ac\r\n        //echo \"\uc778\uc99d\uc694\uccad \uacb0\uacfc \uc131\uacf5 DB\ucc98\ub9ac\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.<br>\";\r\n        // \uc778\uc99d\ub0b4\uc5ed\uae30\ub85d \uc778\uc99d \uc131\uacf5\ud558\uba74 \ub85c\uadf8\ub97c \ub0a8\uae30\ub294\uac83\uc73c\ub85c \uc218\uc815 2021-09-13\r\n        @insert_cert_history($member['mb_id'], 'lg', 'hp');\r\n\r\n        $cert_no        = $xpay->Response('LGD_TID', 0);                      // LG \uc778\uc99d\ucc98\ub9ac\ubc88\ud638\r\n        $comm_id        = $xpay->Response('LGD_FINANCECODE', 0);              // \uc774\ub3d9\ud1b5\uc2e0\uc0ac \ucf54\ub4dc\r\n        $phone_no       = $xpay->Response('LGD_MOBILENUM', 0);                // \uc804\ud654\ubc88\ud638\r\n        $user_name      = $xpay->Response('LGD_MOBILE_SUBAUTH_NAME', 0);      // \uc774\ub984\r\n        $birth_day      = $xpay->Response('LGD_MOBILE_SUBAUTH_BIRTH', 0);     // \uc0dd\ub144\uc6d4\uc77c\r\n        $sex_code       = $xpay->Response('LGD_MOBILE_SUBAUTH_SEX', 0);       // \uc131\ubcc4\ucf54\ub4dc\r\n        $ci             = $xpay->Response('LGD_AUTHSUB_CI', 0);               // CI\r\n        $di             = $xpay->Response('LGD_AUTHSUB_DI', 0);               // DI \uc911\ubcf5\uac00\uc785 \ud655\uc778\uac12\r\n\r\n        // \ub0b4/\uc678\uad6d\uc778\r\n        if($sex_code > 4)\r\n            $local_code = 2; // \uc678\uad6d\uc778\r\n        else\r\n            $local_code = 1; // \ub0b4\uad6d\uc778\r\n\r\n        // \ub0a8/\uc5ec\uad6c\ubd84\r\n        if($sex_code % 2 == 0)\r\n            $mb_sex = 'F';\r\n        else\r\n            $mb_sex = 'M';\r\n\r\n        // \uc0dd\ub144\uc6d4\uc77c\r\n        if($sex_code < 5) {\r\n            if($sex_code <= 2)\r\n                $birth_prefix = '19';\r\n            else\r\n                $birth_prefix = '20';\r\n        } else {\r\n            if($sex_code <= 6)\r\n                $birth_prefix = '19';\r\n            else\r\n                $birth_prefix = '20';\r\n        }\r\n        $birth_day = $birth_prefix.$birth_day;\r\n\r\n        // \uc815\uc0c1\uc778\uc99d\uc778\uc9c0 \uccb4\ud06c\r\n        if(!$phone_no)\r\n            alert_close(\"\uc815\uc0c1\uc801\uc778 \uc778\uc99d\uc774 \uc544\ub2d9\ub2c8\ub2e4. \uc62c\ubc14\ub978 \ubc29\ubc95\uc73c\ub85c \uc774\uc6a9\ud574 \uc8fc\uc138\uc694.\");\r\n\r\n        $phone_no = hyphen_hp_number($phone_no);\r\n        $mb_dupinfo = $di;\r\n        $md5_ci = md5($ci.$ci);\r\n\r\n        $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$md5_ci}'\"); // ci\ub370\uc774\ud130\ub85c \ucc3e\uc74c\r\n        if (empty($row['mb_id'])) { // ci\ub85c \ub4f1\ub85d\ub41c \uacc4\uc815\uc774 \uc5c6\ub2e4\uba74\r\n            $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$mb_dupinfo}'\"); // di\ub370\uc774\ud130\ub85c \ucc3e\uc74c\r\n            if(empty($row['mb_id'])) {\r\n                alert_close(\"\uc778\uc99d\ud558\uc2e0 \uc815\ubcf4\ub85c \uac00\uc785\ub41c \ud68c\uc6d0\uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.\");\r\n                exit;\r\n            }\r\n        }\r\n\r\n    } else {\r\n        //\uc778\uc99d\uc694\uccad \uacb0\uacfc \uc2e4\ud328 DB\ucc98\ub9ac\r\n        //echo \"\uc778\uc99d\uc694\uccad \uacb0\uacfc \uc2e4\ud328 DB\ucc98\ub9ac\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.<br>\";\r\n\r\n        if( G5_IS_MOBILE ){\r\n            echo '<script>'.PHP_EOL;\r\n            echo 'window.parent.$(\"#cert_info\").css(\"display\", \"\");'.PHP_EOL;\r\n            echo 'window.parent.$(\"#lgu_cert\" ).css(\"display\", \"none\");'.PHP_EOL;\r\n            echo 'alert(\"\uc778\uc99d\uc694\uccad\uc774 \ucde8\uc18c \ub610\ub294 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4.\\\\n\\\\n\ucf54\ub4dc : '.$xpay->Response_Code().'  '.$xpay->Response_Msg().'\")';\r\n            echo '</script>'.PHP_EOL;\r\n        } else {\r\n            alert_close('\uc778\uc99d\uc694\uccad\uc774 \ucde8\uc18c \ub610\ub294 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4.\\\\n\\\\n\ucf54\ub4dc : '.$xpay->Response_Code().'  '.$xpay->Response_Msg());\r\n        }\r\n        exit;\r\n    }\r\n} else {\r\n    //2)API \uc694\uccad\uc2e4\ud328 \ud654\uba74\ucc98\ub9ac\r\n    /*\r\n    echo \"\uc778\uc99d\uc694\uccad\uc774 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4.  <br>\";\r\n    echo \"TX Response_code = \" . $xpay->Response_Code() . \"<br>\";\r\n    echo \"TX Response_msg = \" . $xpay->Response_Msg() . \"<p>\";\r\n\r\n    //\uc778\uc99d\uc694\uccad \uacb0\uacfc \uc2e4\ud328 DB\ucc98\ub9ac\r\n    echo \"\uc778\uc99d\uc694\uccad \uacb0\uacfc \uc2e4\ud328 DB\ucc98\ub9ac\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.<br>\";\r\n    */\r\n\r\n    if( G5_IS_MOBILE ){\r\n        echo '<script>'.PHP_EOL;\r\n        echo 'window.parent.$(\"#cert_info\").css(\"display\", \"\");'.PHP_EOL;\r\n        echo 'window.parent.$(\"#lgu_cert\" ).css(\"display\", \"none\");'.PHP_EOL;\r\n        echo 'alert(\"\uc778\uc99d\uc694\uccad\uc774 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4.\\\\n\\\\n\ucf54\ub4dc : '.$xpay->Response_Code().'  '.$xpay->Response_Msg().'\")';\r\n        echo '</script>'.PHP_EOL;\r\n    } else {\r\n        alert_close('\uc778\uc99d\uc694\uccad\uc774 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4.\\\\n\\\\n\ucf54\ub4dc : '.$xpay->Response_Code().'  '.$xpay->Response_Msg());\r\n    }\r\n    exit;\r\n}\r\n?>\r\n<form name=\"mbFindForm\" method=\"POST\">\r\n    <input type=\"hidden\" name=\"mb_id\" value=\"<?php echo $row[\"mb_id\"]; ?>\">    \r\n</form>\r\n<script>\r\n    jQuery(function($) {\r\n        \r\n        var $opener = window.opener;\r\n        var is_mobile = false;        \r\n        $opener.name=\"parentPage\";\r\n\r\n        if (typeof g5_is_mobile != \"undefined\" && g5_is_mobile ) {\r\n            $opener = window.parent;\r\n            is_mobile = true;\r\n        } else {\r\n            $opener = window.opener;\r\n        }\r\n            \r\n        document.mbFindForm.target = \"parentPage\";\r\n        document.mbFindForm.action = \"<?php echo G5_BBS_URL.'/password_reset.php'?>\";\r\n        document.mbFindForm.submit();\r\n\r\n        alert(\"\ubcf8\uc778\uc778\uc99d\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\");\r\n        window.close();        \r\n    });\r\n</script>\r\n<?php\r\ninclude_once(G5_PATH.'/tail.sub.php');", "<?php\ninclude_once('./_common.php');\n\n$check_arrays = array('exe', 'keypath', 'memId', 'endPointURL', 'endPointUrl', 'logPath');\n\nforeach($check_arrays as $key){\n    if( isset($_REQUEST[$key]) && $_REQUEST[$key] ){\n        die('bad request');\n    }\n\n    $$key = '';\n}\n\n// KISA \ucde8\uc57d\uc810 \ub0b4\uc6a9(KVE-2018-0291) hpcert1.php\uc758 $cmd \ud568\uc218\uc5d0 \ub300\ud55c \uc778\uc790 \uac12\uc740 hpcert_config.php \ud30c\uc77c\uc5d0\uc11c \uc124\uc815\ub418\ub098, \uc774\ub97c \ub2e4\ub978 \ud398\uc774\uc9c0\uc5d0\uc11c \ud3ec\ud568\ud55c \ub4a4 \ud638\ucd9c\ud560 \uc2dc \uc784\uc758 \uac12 \uc124\uc815 \uac00\ub2a5\n// \uc774\uc5d0 include_once \ub97c require \ub85c \uc218\uc815\ud568\nrequire('./hpcert.config.php');\n/**************************************************************************\n    \ud30c\uc77c\uba85 : safe_hs_cert3.php\n\n    \uc0dd\ub144\uc6d4\uc77c \ubcf8\uc778 \ud655\uc778\uc11c\ube44\uc2a4 \uacb0\uacfc \ud654\uba74(return url)\n**************************************************************************/\n\n/* \uacf5\ud1b5 \ub9ac\ud134 \ud56d\ubaa9 */\n//$idcfMbrComCd           =   $_REQUEST['idcf_mbr_com_cd'];      // \uace0\uac1d\uc0ac\ucf54\ub4dc\n$idcfMbrComCd           =   $memId;\n$hsCertSvcTxSeqno       =   isset($_REQUEST['hs_cert_svc_tx_seqno']) ? $_REQUEST['hs_cert_svc_tx_seqno'] : ''; // \uac70\ub798\ubc88\ud638\n$rqstSiteNm             =   isset($_REQUEST['rqst_site_nm']) ? $_REQUEST['rqst_site_nm'] : '';         // \uc811\uc18d\ub3c4\uba54\uc778\n$hsCertRqstCausCd       =   isset($_REQUEST['hs_cert_rqst_caus_cd']) ? $_REQUEST['hs_cert_rqst_caus_cd'] : ''; // \uc778\uc99d\uc694\uccad\uc0ac\uc720\ucf54\ub4dc 2byte  (00:\ud68c\uc6d0\uac00\uc785, 01:\uc131\uc778\uc778\uc99d, 02:\ud68c\uc6d0\uc815\ubcf4\uc218\uc815, 03:\ube44\ubc00\ubc88\ud638\ucc3e\uae30, 04:\uc0c1\ud488\uad6c\ub9e4, 99:\uae30\ud0c0)\n\n$resultCd               =   isset($_REQUEST['result_cd']) ? $_REQUEST['result_cd'] : '';            // \uacb0\uacfc\ucf54\ub4dc\n$resultMsg              =   isset($_REQUEST['result_msg']) ? $_REQUEST['result_msg'] : '';           // \uacb0\uacfc\uba54\uc138\uc9c0\n$certDtTm               =   isset($_REQUEST['cert_dt_tm']) ? $_REQUEST['cert_dt_tm'] : '';           // \uc778\uc99d\uc77c\uc2dc\n\nif($resultCd != 'B000') {\n    alert_close('\ud734\ub300\ud3f0 \ubcf8\uc778\ud655\uc778 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \uc624\ub958\ucf54\ub4dc : '.$resultCd.'\\\\n\\\\n\ubb38\uc758\ub294 \ucf54\ub9ac\uc544\ud06c\ub808\ub527\ubdf0\ub85c \uace0\uac1d\uc13c\ud130 02-708-1000 \ub85c \ud574\uc8fc\uc2ed\uc2dc\uc624.');\n}\n\n/**************************************************************************\n * \ubaa8\ub4c8 \ud638\ucd9c    ; \uc0dd\ub144\uc6d4\uc77c \ubcf8\uc778 \ud655\uc778\uc11c\ube44\uc2a4 \uacb0\uacfc \ub370\uc774\ud130\ub97c \ubcf5\ud638\ud654\ud55c\ub2e4.\n **************************************************************************/\n$encInfo = isset($_REQUEST['encInfo']) ? $_REQUEST['encInfo'] : '';\nif(preg_match('~[^0-9a-zA-Z+/=]~', $encInfo, $match)) {echo \"\uc785\ub825 \uac12 \ud655\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4\"; exit;}\n\n//KCB\uc11c\ubc84 \uacf5\uac1c\ud0a4\n$WEBPUBKEY = isset($_REQUEST['WEBPUBKEY']) ? trim($_REQUEST['WEBPUBKEY']) : '';\nif(preg_match('~[^0-9a-zA-Z+/=]~', $WEBPUBKEY, $match)) {echo \"\uc785\ub825 \uac12 \ud655\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4\"; exit;}\n\n//KCB\uc11c\ubc84 \uc11c\uba85\uac12\n$WEBSIGNATURE = isset($_REQUEST['WEBSIGNATURE']) ? trim($_REQUEST['WEBSIGNATURE']) : '';\nif(preg_match('~[^0-9a-zA-Z+/=]~', $WEBSIGNATURE, $match)) {echo \"\uc785\ub825 \uac12 \ud655\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4\"; exit;}\n\n// ########################################################################\n// # \uc554\ud638\ud654\ud0a4 \ud30c\uc77c \uc124\uc815 (\uc808\ub300\uacbd\ub85c) - \ud30c\uc77c\uc740 \uc8fc\uc5b4\uc9c4 \ud30c\uc77c\uba85\uc73c\ub85c \uc790\ub3d9 \uc0dd\uc131 \ub428\n// ########################################################################\n$keypath = G5_OKNAME_PATH.'/key/safecert_'.$idcfMbrComCd.'.key';\n\n$cpubkey = $WEBPUBKEY;    //server publickey\n$csig = $WEBSIGNATURE;    //server signature\n\n// ########################################################################\n// # \ub85c\uadf8 \uacbd\ub85c \uc9c0\uc815 \ubc0f \uad8c\ud55c \ubd80\uc5ec (\uc808\ub300\uacbd\ub85c)\n// # \uc635\uc158\uac12\uc5d0 'L'\uc744 \ucd94\uac00\ud558\ub294 \uacbd\uc6b0\uc5d0\ub9cc \ub85c\uadf8\uac00 \uc0dd\uc131\ub428.\n// ########################################################################\n$option = 'SU';\n\n// \uba85\ub839\uc5b4\n$cmd = \"$exe $keypath $idcfMbrComCd $endPointUrl $WEBPUBKEY $WEBSIGNATURE $encInfo $logPath $option\";\n\n// \uc2e4\ud589\nexec($cmd, $out, $ret);\n\n// \uc778\uc99d\ub0b4\uc5ed\uae30\ub85d\n@insert_cert_history($member['mb_id'], 'kcb', 'hp');\n\nif($ret == 0) {\n    // \uacb0\uacfc\ub77c\uc778\uc5d0\uc11c \uac12\uc744 \ucd94\ucd9c\n    foreach($out as $a => $b) {\n        if($a < 17) {\n            $field[$a] = $b;\n        }\n    }\n    $resultCd = $field[0];\n}\nelse {\n    if($ret <=200)\n        $resultCd=sprintf(\"B%03d\", $ret);\n    else\n        $resultCd=sprintf(\"S%03d\", $ret);\n}\n\n/*\necho \"\ucc98\ub9ac\uacb0\uacfc\ucf54\ub4dc      :$resultCd  <br/>\";\necho \"\ucc98\ub9ac\uacb0\uacfc\uba54\uc2dc\uc9c0    :$field[1]  <br/>\";\necho \"\uac70\ub798\uc77c\ub828\ubc88\ud638      :$field[2]  <br/>\";\necho \"\uc778\uc99d\uc77c\uc2dc          :$field[3]  <br/>\";\necho \"DI                :$field[4]  <br/>\";\necho \"CI                :$field[5]  <br/>\";\necho \"\uc131\uba85              :$field[7]  <br/>\";\necho \"\uc0dd\ub144\uc6d4\uc77c          :$field[8]  <br/>\";\necho \"\uc131\ubcc4              :$field[9]  <br/>\";\necho \"\ub0b4\uc678\uad6d\uc778\uad6c\ubd84      :$field[10] <br/>\";\necho \"\ud1b5\uc2e0\uc0ac\ucf54\ub4dc        :$field[11] <br/>\";\necho \"\ud734\ub300\ud3f0\ubc88\ud638        :$field[12] <br/>\";\necho \"\ub9ac\ud134\uba54\uc2dc\uc9c0        :$field[16] <br/>\";\n*/\n\n// \uc778\uc99d\uacb0\uacfc\ucc98\ub9ac\n$mb_name = $field[7];\n$req_num = $field[12];\n$mb_birth = $field[8];\n$mb_dupinfo = $field[4];\n$ci = $field[5];\n\n$phone_no = hyphen_hp_number($req_num);\n$md5_ci = md5($ci.$ci);\n\n$row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$md5_ci}'\"); // ci\ub370\uc774\ud130\ub85c \ucc3e\uc74c\nif (empty($row['mb_id'])) { // ci\ub85c \ub4f1\ub85d\ub41c \uacc4\uc815\uc774 \uc5c6\ub2e4\uba74\n    $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$mb_dupinfo}'\"); // di\ub370\uc774\ud130\ub85c \ucc3e\uc74c\n    if(empty($row['mb_id'])) {\n        alert_close(\"\uc778\uc99d\ud558\uc2e0 \uc815\ubcf4\ub85c \uac00\uc785\ub41c \ud68c\uc6d0\uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.\");\n        exit;\n    }\n}\n\n$g5['title'] = 'KCB \ud734\ub300\ud3f0 \ubcf8\uc778\ud655\uc778';\ninclude_once(G5_PATH.'/head.sub.php');\n?>\n<form name=\"mbFindForm\" method=\"POST\">\n    <input type=\"hidden\" name=\"mb_id\" value=\"<?php echo $row[\"mb_id\"]; ?>\">    \n</form>\n<script>\n    jQuery(function($) {\n        \n        var $opener = window.opener;\n        var is_mobile = false;        \n        $opener.name=\"parentPage\";\n\n        if (typeof g5_is_mobile != \"undefined\" && g5_is_mobile ) {\n            $opener = window.parent;\n            is_mobile = true;\n        } else {\n            $opener = window.opener;\n        }\n            \n        document.mbFindForm.target = \"parentPage\";\n        document.mbFindForm.action = \"<?php echo G5_BBS_URL.'/password_reset.php'?>\";\n        document.mbFindForm.submit();\n\n        alert(\"\ubcf8\uc778\uc778\uc99d\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\");\n        window.close();        \n    });\n</script>\n<?php\ninclude_once(G5_PATH.'/tail.sub.php');", "<?php\r\ninclude_once('./_common.php');\r\n\r\n$check_arrays = array('exe', 'keypath', 'memid', 'EndPointURL', 'cpubkey', 'csig', 'encdata', 'logpath', 'option');\r\n\r\nforeach($check_arrays as $key){\r\n    if( isset($_REQUEST[$key]) && $_REQUEST[$key] ){\r\n        die('bad request');\r\n    }\r\n\r\n    $$key = '';\r\n}\r\n\r\nrequire('./ipin.config.php');\r\n\r\n//\uc544\uc774\ud540\ud31d\uc5c5\uc5d0\uc11c \uc870\ud68c\ud55c PERSONALINFO\uc774\ub2e4.\r\n@$encPsnlInfo = isset($_REQUEST[\"encPsnlInfo\"]) ? $_REQUEST[\"encPsnlInfo\"] : '';\r\nif(preg_match('~[^0-9a-zA-Z+/=]~', $encPsnlInfo, $match)) {echo \"\uc785\ub825 \uac12 \ud655\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4\"; exit;}\r\n\r\n//KCB\uc11c\ubc84 \uacf5\uac1c\ud0a4\r\n@$WEBPUBKEY = isset($_REQUEST[\"WEBPUBKEY\"]) ? trim($_REQUEST[\"WEBPUBKEY\"]) : '';\r\nif(preg_match('~[^0-9a-zA-Z+/=]~', $WEBPUBKEY, $match)) {echo \"\uc785\ub825 \uac12 \ud655\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4\"; exit;}\r\n\r\n//KCB\uc11c\ubc84 \uc11c\uba85\uac12\r\n@$WEBSIGNATURE = isset($_REQUEST[\"WEBSIGNATURE\"]) ? trim($_REQUEST[\"WEBSIGNATURE\"]) : '';\r\nif(preg_match('~[^0-9a-zA-Z+/=]~', $WEBSIGNATURE, $match)) {echo \"\uc785\ub825 \uac12 \ud655\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4\"; exit;}\r\n\r\n//\uc544\uc774\ud540 \uc11c\ubc84\uc640 \ud1b5\uc2e0\uc744 \uc704\ud55c \ud0a4\ud30c\uc77c \uc0dd\uc131\r\n// \ud30c\ub77c\ubbf8\ud130 \uc815\uc758\r\n$cpubkey = $WEBPUBKEY;    //server publickey\r\n$csig = $WEBSIGNATURE;    //server signature\r\n$encdata = $encPsnlInfo;  //PERSONALINFO\r\n$option = \"SU\";\r\n\r\n// \uba85\ub839\uc5b4\r\n$cmd = \"$exe $keypath $memid $EndPointURL $cpubkey $csig $encdata $logpath $option\";\r\n\r\n// \uc2e4\ud589\r\nexec($cmd, $out, $ret);\r\n\r\n// \uc778\uc99d\ub0b4\uc5ed\uae30\ub85d\r\n@insert_cert_history($member['mb_id'], 'kcb', 'ipin');\r\n\r\nif($ret != 0) {\r\n    if($ret <=200)\r\n        $resultCd=sprintf(\"B%03d\", $ret);\r\n    else\r\n        $resultCd=sprintf(\"S%03d\", $ret);\r\n\r\n    alert_close('\uc544\uc774\ud540 \ubcf8\uc778\ud655\uc778 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \uc624\ub958\ucf54\ub4dc : '.$resultCd.'\\\\n\\\\n\ubb38\uc758\ub294 \ucf54\ub9ac\uc544\ud06c\ub808\ub527\ubdf0\ub85c \uace0\uac1d\uc13c\ud130 02-708-1000 \ub85c \ud574\uc8fc\uc2ed\uc2dc\uc624.');\r\n}\r\n\r\n// \uacb0\uacfc\ub77c\uc778\uc5d0\uc11c \uac12\uc744 \ucd94\ucd9c\r\nforeach($out as $a => $b) {\r\n    if($a < 13) {\r\n        $field[$a] = $b;\r\n    }\r\n}\r\n\r\n/*\r\n$field_name_IPIN_DEC = array(\r\n    \"dupInfo        \",\t// 0\r\n    \"coinfo1        \",\t// 1\r\n    \"coinfo2        \",\t// 2\r\n    \"ciupdate       \",\t// 3\r\n    \"virtualNo      \",\t// 4\r\n    \"cpCode         \",\t// 5\r\n    \"realName       \",\t// 6\r\n    \"cpRequestNumber\",\t// 7\r\n    \"age            \",\t// 8\r\n    \"sex            \",\t// 9\r\n    \"nationalInfo   \",\t// 10\r\n    \"birthDate      \",\t// 11\r\n    \"authInfo       \",\t// 12\r\n);\r\n*/\r\n\r\n$mb_name = $field[6];\r\n$req_num = $field[7];\r\n$mb_birth = $field[11];\r\n$mb_dupinfo = $field[0];\r\nif(!empty($field[1])) { // \uc544\uc774\ud540\uc740 \ub9ac\ud134\ubc1b\ub294 ci \ub370\uc774\ud130\uac00 \ub450\uac00\uc9c0\uc778\uac78\ub85c \ubcf4\uc544 \uac1c\uc778\ubcc4\ub85c \ubc1b\ub294 \uacf3\uc774 \ub2e4\ub97c \uc218\ub3c4 \uc788\uc744\uac83 \uac19\uc544\uc11c \ucd94\uac00\ud568 2021-09-13 hjkim7153\r\n    $ci = $field[1];\r\n}else if(!empty($field[2])) {\r\n    $ci = $field[2];\r\n}else{\r\n    alert_close('\uc544\uc774\ud540 \ubcf8\uc778\ud655\uc778 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. (ci \uc815\ubcf4 \uc5c6\uc74c) \uc624\ub958\ucf54\ub4dc : '.$resultCd.'\\\\n\\\\n\ubb38\uc758\ub294 \ucf54\ub9ac\uc544\ud06c\ub808\ub527\ubdf0\ub85c \uace0\uac1d\uc13c\ud130 02-708-1000 \ub85c \ud574\uc8fc\uc2ed\uc2dc\uc624.');\r\n}\r\n$md5_ci = md5($ci.$ci);\r\n\r\n$row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$md5_ci}'\"); // ci\ub370\uc774\ud130\ub85c \ucc3e\uc74c\r\nif (empty($row['mb_id'])) { // ci\ub85c \ub4f1\ub85d\ub41c \uacc4\uc815\uc774 \uc5c6\ub2e4\uba74\r\n    $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$mb_dupinfo}'\"); // di\ub370\uc774\ud130\ub85c \ucc3e\uc74c\r\n    if(empty($row['mb_id'])) {\r\n        alert_close(\"\uc778\uc99d\ud558\uc2e0 \uc815\ubcf4\ub85c \uac00\uc785\ub41c \ud68c\uc6d0\uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.\");\r\n        exit;\r\n    }\r\n}\r\n$g5['title'] = 'KCB \uc544\uc774\ud540 \ubcf8\uc778\ud655\uc778';\r\ninclude_once(G5_PATH.'/head.sub.php');\r\n?>\r\n\r\n<form name=\"mbFindForm\" method=\"POST\">\r\n    <input type=\"hidden\" name=\"mb_id\" value=\"<?php echo $row[\"mb_id\"]; ?>\">    \r\n</form>\r\n<script>\r\n    jQuery(function($) {\r\n        \r\n        var $opener = window.opener;\r\n        var is_mobile = false;        \r\n        $opener.name=\"parentPage\";\r\n\r\n        if (typeof g5_is_mobile != \"undefined\" && g5_is_mobile ) {\r\n            $opener = window.parent;\r\n            is_mobile = true;\r\n        } else {\r\n            $opener = window.opener;\r\n        }\r\n            \r\n        document.mbFindForm.target = \"parentPage\";\r\n        document.mbFindForm.action = \"<?php echo G5_BBS_URL.'/password_reset.php'?>\";\r\n        document.mbFindForm.submit();\r\n\r\n        alert(\"\ubcf8\uc778\uc778\uc99d\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\");\r\n        window.close();        \r\n    });\r\n</script>\r\n<?php\r\ninclude_once(G5_PATH.'/tail.sub.php');", "<?php\nif (!defined('_GNUBOARD_')) exit; // \uac1c\ubcc4 \ud398\uc774\uc9c0 \uc811\uadfc \ubd88\uac00\n\n// add_stylesheet('css \uad6c\ubb38', \ucd9c\ub825\uc21c\uc11c); \uc22b\uc790\uac00 \uc791\uc744 \uc218\ub85d \uba3c\uc800 \ucd9c\ub825\ub428\nadd_stylesheet('<link rel=\"stylesheet\" href=\"' . $member_skin_url . '/style.css\">', 0);\n?>\n\n<!-- \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \uc2dc\uc791 { -->\n<div id=\"pw_reset\" class=\"new_win\">\n    <div class=\"new_win_con\">\n        <form name=\"fpasswordreset\" action=\"<?php echo $action_url; ?>\" onsubmit=\"return fpasswordreset_submit(this);\" method=\"post\" autocomplete=\"off\">\n            <fieldset id=\"info_fs\">\n                <p>\uc0c8\ub85c\uc6b4 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.</p>\n                <label for=\"mb_id\" class=\"sound_only\">\uc544\uc774\ub514</label>\n                <input type=\"text\" name=\"mb_id\" id=\"mb_id\" value=\"<?php echo $_POST['mb_id']; ?>\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc544\uc774\ub514\" readonly>\n                <label for=\"mb_pw\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password\" id=\"mb_pw\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638\">\n                <label for=\"mb_pw2\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password_re\" id=\"mb_pw2\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778\">\n            </fieldset>\n            <div class=\"win_btn\">\n                <button type=\"submit\" class=\"btn_submit\">\ud655\uc778</button>\n            </div>\n        </form>\n    </div>\n</div>\n\n<script>\nfunction fpasswordreset_submit(f) {\n    if ($(\"#mb_pw\").val() == $(\"#mb_pw2\").val()) {\n        alert(\"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574 \uc8fc\uc138\uc694.\");\n    } else {\n        alert(\"\uc0c8 \ube44\ubc00\ubc88\ud638\uc640 \ube44\ubc00\ubc88\ud638 \ud655\uc778\uc774 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\");\n        return false;\n    }\n}\n</script>\n<!-- } \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \ub05d -->", "<?php\nif (!defined('_GNUBOARD_')) exit; // \uac1c\ubcc4 \ud398\uc774\uc9c0 \uc811\uadfc \ubd88\uac00\n\n// add_stylesheet('css \uad6c\ubb38', \ucd9c\ub825\uc21c\uc11c); \uc22b\uc790\uac00 \uc791\uc744 \uc218\ub85d \uba3c\uc800 \ucd9c\ub825\ub428\nadd_stylesheet('<link rel=\"stylesheet\" href=\"' . $member_skin_url . '/style.css\">', 0);\n?>\n\n<!-- \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \uc2dc\uc791 { -->\n<div id=\"pw_reset\" class=\"new_win\">\n    <div class=\"new_win_con\">\n        <form name=\"fpasswordreset\" action=\"<?php echo $action_url; ?>\" onsubmit=\"return fpasswordreset_submit(this);\" method=\"post\" autocomplete=\"off\">\n            <fieldset id=\"info_fs\">\n                <p>\uc0c8\ub85c\uc6b4 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.</p>\n                <label for=\"mb_id\" class=\"sound_only\">\uc544\uc774\ub514</label>\n                <input type=\"text\" name=\"mb_id\" id=\"mb_id\" value=\"<?php echo $_POST['mb_id']; ?>\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc544\uc774\ub514\" readonly>\n                <label for=\"mb_pw\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password\" id=\"mb_pw\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638\">\n                <label for=\"mb_pw2\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password_re\" id=\"mb_pw2\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778\">\n            </fieldset>\n            <div class=\"win_btn\">\n                <button type=\"submit\" class=\"btn_submit\">\ud655\uc778</button>\n            </div>\n        </form>\n    </div>\n</div>\n\n<script>\nfunction fpasswordreset_submit(f) {\n    if ($(\"#mb_pw\").val() == $(\"#mb_pw2\").val()) {\n        alert(\"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574 \uc8fc\uc138\uc694.\");\n    } else {\n        alert(\"\uc0c8 \ube44\ubc00\ubc88\ud638\uc640 \ube44\ubc00\ubc88\ud638 \ud655\uc778\uc774 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\");\n        return false;\n    }\n}\n</script>\n<!-- } \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \ub05d -->", "<?php\nif (!defined('_GNUBOARD_')) exit; // \uac1c\ubcc4 \ud398\uc774\uc9c0 \uc811\uadfc \ubd88\uac00\n\n// add_stylesheet('css \uad6c\ubb38', \ucd9c\ub825\uc21c\uc11c); \uc22b\uc790\uac00 \uc791\uc744 \uc218\ub85d \uba3c\uc800 \ucd9c\ub825\ub428\nadd_stylesheet('<link rel=\"stylesheet\" href=\"' . $member_skin_url . '/style.css\">', 0);\n?>\n\n<!-- \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \uc2dc\uc791 { -->\n<div id=\"pw_reset\" class=\"new_win\">\n    <div class=\"new_win_con\">\n        <form name=\"fpasswordreset\" action=\"<?php echo $action_url; ?>\" onsubmit=\"return fpasswordreset_submit(this);\" method=\"post\" autocomplete=\"off\">\n            <fieldset id=\"info_fs\">\n                <p>\uc0c8\ub85c\uc6b4 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.</p>\n                <label for=\"mb_id\" class=\"sound_only\">\uc544\uc774\ub514</label>\n                <input type=\"text\" name=\"mb_id\" id=\"mb_id\" value=\"<?php echo $_POST['mb_id']; ?>\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc544\uc774\ub514\" readonly>\n                <label for=\"mb_pw\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password\" id=\"mb_pw\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638\">\n                <label for=\"mb_pw2\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password_re\" id=\"mb_pw2\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778\">\n            </fieldset>\n            <div class=\"win_btn\">\n                <button type=\"submit\" class=\"btn_submit\">\ud655\uc778</button>\n            </div>\n        </form>\n    </div>\n</div>\n\n<script>\nfunction fpasswordreset_submit(f) {\n    if ($(\"#mb_pw\").val() == $(\"#mb_pw2\").val()) {\n        alert(\"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574 \uc8fc\uc138\uc694.\");\n    } else {\n        alert(\"\uc0c8 \ube44\ubc00\ubc88\ud638\uc640 \ube44\ubc00\ubc88\ud638 \ud655\uc778\uc774 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\");\n        return false;\n    }\n}\n</script>\n<!-- } \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \ub05d -->"], "fixing_code": ["<?php\ninclude_once('./_common.php');\n\n$mb_id = isset($_SESSION['ss_cert_mb_id']) ? trim(get_session('ss_cert_mb_id')) : '';\n$mb_dupinfo = isset($_SESSION['ss_cert_dupinfo']) ? trim(get_session('ss_cert_dupinfo')) : '';\n\nif(!$mb_id) alert('\ud68c\uc6d0\uc544\uc774\ub514 \uac12\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. \uc62c\ubc14\ub978 \ubc29\ubc95\uc73c\ub85c \uc774\uc6a9\ud574 \uc8fc\uc2ed\uc2dc\uc624.', G5_URL);\n\nif(!$mb_dupinfo) alert('\uc798\ubabb\ub41c \uc811\uadfc\uc785\ub2c8\ub2e4.', G5_URL);\n\n$mb_check = sql_fetch(\"select * from {$g5['member_table']} where mb_id = '{$mb_id}' AND mb_dupinfo = '{$mb_dupinfo}'\");\n\nif(!$mb_check) alert('\uc798\ubabb\ub41c \uc811\uadfc\uc785\ub2c8\ub2e4.', G5_URL);\n\n$mb_password    = isset($_POST['mb_password']) ? trim($_POST['mb_password_re']) : '';\n$mb_password_re = isset($_POST['mb_password_re']) ? trim($_POST['mb_password_re']) : '';\n\n\nif (!$mb_password)\n    alert('\ube44\ubc00\ubc88\ud638\uac00 \ub118\uc5b4\uc624\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4.');\nif ($mb_password != $mb_password_re)\n    alert('\ube44\ubc00\ubc88\ud638\uac00 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.');\n\n$sql_password = \"mb_password = '\".get_encrypt_string($mb_password).\"' \";\n\nsql_query(\"update {$g5['member_table']} set {$sql_password} where mb_id = '{$mb_id}' AND mb_dupinfo = '{$mb_dupinfo}'\");\n\nset_session('ss_cert_mb_id', '');\nset_session('ss_cert_dupinfo', '');\n\ngoto_url(G5_BBS_URL.'/login.php');", "<?php\nif (!defined('_GNUBOARD_')) exit; // \uac1c\ubcc4 \ud398\uc774\uc9c0 \uc811\uadfc \ubd88\uac00\n\n// add_stylesheet('css \uad6c\ubb38', \ucd9c\ub825\uc21c\uc11c); \uc22b\uc790\uac00 \uc791\uc744 \uc218\ub85d \uba3c\uc800 \ucd9c\ub825\ub428\nadd_stylesheet('<link rel=\"stylesheet\" href=\"' . $member_skin_url . '/style.css\">', 0);\n?>\n\n<!-- \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \uc2dc\uc791 { -->\n<div id=\"pw_reset\" class=\"new_win\">\n    <div class=\"new_win_con\">\n        <form name=\"fpasswordreset\" action=\"<?php echo $action_url; ?>\" onsubmit=\"return fpasswordreset_submit(this);\" method=\"post\" autocomplete=\"off\">\n            <fieldset id=\"info_fs\">\n                <p>\uc0c8\ub85c\uc6b4 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.</p>\n                <label for=\"mb_id\" class=\"sound_only\">\uc544\uc774\ub514</label>\n                <br>\n                <b>\ud68c\uc6d0 \uc544\uc774\ub514 : <?php echo $_POST['mb_id']; ?></b>\n                <label for=\"mb_pw\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password\" id=\"mb_pw\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638\">\n                <label for=\"mb_pw2\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password_re\" id=\"mb_pw2\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778\">\n            </fieldset>\n            <div class=\"win_btn\">\n                <button type=\"submit\" class=\"btn_submit\">\ud655\uc778</button>\n            </div>\n        </form>\n    </div>\n</div>\n\n<script>\nfunction fpasswordreset_submit(f) {\n    if ($(\"#mb_pw\").val() == $(\"#mb_pw2\").val()) {\n        alert(\"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574 \uc8fc\uc138\uc694.\");\n    } else {\n        alert(\"\uc0c8 \ube44\ubc00\ubc88\ud638\uc640 \ube44\ubc00\ubc88\ud638 \ud655\uc778\uc774 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\");\n        return false;\n    }\n}\n</script>\n<!-- } \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \ub05d -->", "<?php\ninclude_once('./_common.php');\n\n$txId = $_POST['txId'];\n$mid  = substr($txId, 6, 10);\n\nif ($_POST[\"resultCode\"] === \"0000\") { \n\n    $data = array(\n        'mid' => $mid,        \n        'txId' => $txId\n    );\n\n    $post_data = json_encode($data);\n\n    // curl \ud1b5\uc2e0 \uc2dc\uc791 \n    $ch = curl_init();\n    curl_setopt($ch, CURLOPT_URL, $_POST[\"authRequestUrl\"]);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);\n    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 10);\n    curl_setopt($ch, CURLOPT_POSTFIELDS, $post_data);\n    curl_setopt($ch, CURLOPT_POST, 1);\n    curl_setopt($ch, CURLOPT_HTTPHEADER, array('Accept: application/json', 'Content-Type: application/json'));\n    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);\n    \n    $response = curl_exec($ch);\n    curl_close($ch);\n    $res_data = json_decode($response, true);\n\n    if($res_data['resultCode'] === \"0000\") {\n\n        $cert_type      = 'simple';                                 // \uc778\uc99d\ud0c0\uc785\n        $cert_no        = $res_data['txId'];                    // \uc774\ub2c8\uc2dc\uc2a4 \ud2b8\ub79c\uc7ad\uc158 ID\n        $phone_no       = $res_data['userPhone'];               // \uc804\ud654\ubc88\ud638\n        $user_name      = $res_data['userName'];                // \uc774\ub984\n        $birth_day      = $res_data['userBirthday'];            // \uc0dd\ub144\uc6d4\uc77c\n        $ci             = $res_data['userCi'];                  // CI           \n\n        @insert_cert_history($member['mb_id'], 'inicis', $cert_type); // \uc778\uc99d\uc131\uacf5 \uc2dc \ub0b4\uc5ed \uae30\ub85d\n\n        if(!$phone_no)\n        alert_close(\"\uc815\uc0c1\uc801\uc778 \uc778\uc99d\uc774 \uc544\ub2d9\ub2c8\ub2e4. \uc62c\ubc14\ub978 \ubc29\ubc95\uc73c\ub85c \uc774\uc6a9\ud574 \uc8fc\uc138\uc694.\");\n\n        $md5_ci = md5($ci . $ci);\n        $phone_no = hyphen_hp_number($phone_no);\n        $mb_dupinfo = $md5_ci;\n\n        $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$mb_dupinfo}'\"); // ci\ub370\uc774\ud130\ub85c \ucc3e\uc74c\n        if(empty($row['mb_id'])) { // ci\ub85c \ub4f1\ub85d\ub41c \uacc4\uc815\uc774 \uc5c6\ub2e4\uba74\n            alert_close(\"\uc778\uc99d\ud558\uc2e0 \uc815\ubcf4\ub85c \uac00\uc785\ub41c \ud68c\uc6d0\uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.\");\n            exit;                \n        }\n\n        $md5_cert_no = md5($cert_no);\n        $hash_data   = md5($user_name.$cert_type.$birth_day.$phone_no.$md5_cert_no);\n\n        // \uc131\uc778\uc778\uc99d\uacb0\uacfc\n        $adult_day = date(\"Ymd\", strtotime(\"-19 years\", G5_SERVER_TIME));\n        $adult = ((int)$birth_day <= (int)$adult_day) ? 1 : 0;\n\n        set_session(\"ss_cert_type\",    $cert_type);\n        set_session(\"ss_cert_no\",      $md5_cert_no);\n        set_session(\"ss_cert_hash\",    $hash_data);\n        set_session(\"ss_cert_adult\",   $adult);\n        set_session(\"ss_cert_birth\",   $birth_day);\n        //set_session(\"ss_cert_sex\",     ($sex_code==\"01\"?\"M\":\"F\")); // \uc774\ub2c8\uc2dc\uc2a4 \uac04\ud3b8\uc778\uc99d\uc740 \uc131\ubcc4\uc815\ubcf4 \ub9ac\ud134 \uc5c6\uc74c\n        set_session('ss_cert_dupinfo', $mb_dupinfo);\n        set_session('ss_cert_mb_id', $row['mb_id']);\n    } else {\n        // \uc778\uc99d\uc2e4\ud328 curl\uc758 \uc778\uc99d\uc2e4\ud328 \uccb4\ud06c\n        alert_close('\ucf54\ub4dc : '.$res_data['resultCode'].'  '.urldecode($res_data['resultMsg']));\n        exit;\n    }\n} else {   // resultCode===0000 \uc544\ub2d0\uacbd\uc6b0 \uc544\ub798 \uc778\uc99d \uc2e4\ud328\ub97c \ucd9c\ub825\ud568 \n    // \uc778\uc99d\uc2e4\ud328\n    alert_close('\ucf54\ub4dc : '.$_POST['resultCode'].'  '.urldecode($_POST['resultMsg']));\n    exit;\n}\n\n$g5['title'] = 'KG\uc774\ub2c8\uc2dc\uc2a4 \uac04\ud3b8\uc778\uc99d \uacb0\uacfc';\ninclude_once(G5_PATH.'/head.sub.php'); \n?>\n<form name=\"mbFindForm\" method=\"POST\">\n<input type=\"hidden\" name=\"mb_id\" value=\"<?php echo $row[\"mb_id\"]; ?>\">    \n</form>\n<script>\n    jQuery(function($) {\n        \n        var $opener = window.opener;\n        var is_mobile = false;        \n        $opener.name=\"parentPage\";\n\n        if (typeof g5_is_mobile != \"undefined\" && g5_is_mobile ) {\n            $opener = window.parent;\n            is_mobile = true;\n        } else {\n            $opener = window.opener;\n        }\n            \n        document.mbFindForm.target = \"parentPage\";\n        document.mbFindForm.action = \"<?php echo G5_BBS_URL.'/password_reset.php'?>\";\n        document.mbFindForm.submit();\n\n        alert(\"\ubcf8\uc778\uc778\uc99d\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\");\n        window.close();        \n    });\n</script>\n<?php\ninclude_once(G5_PATH.'/tail.sub.php');", "<?php\ninclude_once('./_common.php');\ninclude_once(G5_KCPCERT_PATH.'/kcpcert_config.php');\n\n$site_cd       = \"\";\n$ordr_idxx     = \"\";\n\n$cert_no       = \"\";\n$cert_enc_use  = \"\";\n$enc_info      = \"\";\n$enc_data      = \"\";\n$req_tx        = \"\";\n\n$enc_cert_data = \"\";\n$cert_info     = \"\";\n\n$tran_cd       = \"\";\n$res_cd        = \"\";\n$res_msg       = \"\";\n\n$dn_hash       = \"\";\n\n/*------------------------------------------------------------------------*/\n/*  :: \uc804\uccb4 \ud30c\ub77c\ubbf8\ud130 \ub0a8\uae30\uae30                                               */\n/*------------------------------------------------------------------------*/\n\n// request \ub85c \ub118\uc5b4\uc628 \uac12 \ucc98\ub9ac\n$key = array_keys($_POST);\n$sbParam =\"\";\n\nfor($i=0; $i<count($key); $i++)\n{\n    $nmParam = $key[$i];\n    $valParam = $_POST[$nmParam];\n\n    if ( $nmParam == \"site_cd\" )\n    {\n        $site_cd = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"ordr_idxx\" )\n    {\n        $ordr_idxx = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"res_cd\" )\n    {\n        $res_cd = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"cert_enc_use\" )\n    {\n        $cert_enc_use = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"req_tx\" )\n    {\n        $req_tx = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"cert_no\" )\n    {\n        $cert_no = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"enc_cert_data\" )\n    {\n        $enc_cert_data = f_get_parm_str ( $valParam );\n    }\n\n    if ( $nmParam == \"dn_hash\" )\n    {\n        $dn_hash = f_get_parm_str ( $valParam );\n   }\n\n    // \ubd80\ubaa8\ucc3d\uc73c\ub85c \ub118\uae30\ub294 form \ub370\uc774\ud130 \uc0dd\uc131 \ud544\ub4dc\n    $sbParam .= \"<input type='hidden' name='\" . $nmParam . \"' value='\" . f_get_parm_str( $valParam ) . \"'/>\";\n}\n\n$ct_cert = new C_CT_CLI;\n$ct_cert->mf_clear();\n\n\n$g5['title'] = '\ud734\ub300\ud3f0\uc778\uc99d \uacb0\uacfc';\ninclude_once(G5_PATH.'/head.sub.php');\n\n// \uacb0\uacfc \ucc98\ub9ac\n\nif( $cert_enc_use == \"Y\" )\n{\n    // \uc778\uc99d\ub0b4\uc5ed\uae30\ub85d\n    @insert_cert_history($member['mb_id'], 'kcp', 'hp');\n\n    if( $res_cd == \"0000\" )\n    {\n        // dn_hash \uac80\uc99d\n        // KCP \uac00 \ub9ac\ud134\ud574 \ub4dc\ub9ac\ub294 dn_hash \uc640 \uc0ac\uc774\ud2b8 \ucf54\ub4dc, \uc8fc\ubb38\ubc88\ud638 , \uc778\uc99d\ubc88\ud638\ub97c \uac80\uc99d\ud558\uc5ec\n        // \ud574\ub2f9 \ub370\uc774\ud130\uc758 \uc704\ubcc0\uc870\ub97c \ubc29\uc9c0\ud569\ub2c8\ub2e4\n         $veri_str = $site_cd.$ordr_idxx.$cert_no; // \uc0ac\uc774\ud2b8 \ucf54\ub4dc + \uc8fc\ubb38\ubc88\ud638 + \uc778\uc99d\uac70\ub798\ubc88\ud638\n\n        if ( $ct_cert->check_valid_hash ( $home_dir , $dn_hash , $veri_str ) != \"1\" )\n        {\n            if(strtoupper(substr(PHP_OS, 0, 3)) !== 'WIN') {\n                // \uac80\uc99d \uc2e4\ud328\uc2dc \ucc98\ub9ac \uc601\uc5ed\n                if(PHP_INT_MAX == 2147483647) // 32-bit\n                    $bin_exe = '/bin/ct_cli';\n                else\n                    $bin_exe = '/bin/ct_cli_x64';\n            } else {\n                $bin_exe = '/bin/ct_cli_exe.exe';\n            }\n\n            echo \"dn_hash \ubcc0\uc870 \uc704\ud5d8\uc788\uc74c (\".G5_KCPCERT_PATH.$bin_exe.\" \ud30c\uc77c\uc5d0 \uc2e4\ud589\uad8c\ud55c\uc774 \uc788\ub294\uc9c0 \ud655\uc778\ud558\uc138\uc694.)\";\n            exit;\n            // \uc624\ub958 \ucc98\ub9ac ( dn_hash \ubcc0\uc870 \uc704\ud5d8\uc788\uc74c)\n        }\n\n        // \uac00\ub9f9\uc810 DB \ucc98\ub9ac \ud398\uc774\uc9c0 \uc601\uc5ed\n\n        // \uc778\uc99d\ub370\uc774\ud130 \ubcf5\ud638\ud654 \ud568\uc218\n        // \ud574\ub2f9 \ud568\uc218\ub294 \uc554\ud638\ud654\ub41c enc_cert_data \ub97c\n        // site_cd \uc640 cert_no \ub97c \uac00\uc9c0\uace0 \ubcf5\ud654\ud654 \ud558\ub294 \ud568\uc218 \uc785\ub2c8\ub2e4.\n        // \uc815\uc0c1\uc801\uc73c\ub85c \ubcf5\ud638\ud654 \ub41c\uacbd\uc6b0\uc5d0\ub9cc \uc778\uc99d\ub370\uc774\ud130\ub97c \uac00\uc838\uc62c\uc218 \uc788\uc2b5\ub2c8\ub2e4.\n        $opt = \"1\" ; // \ubcf5\ud638\ud654 \uc778\ucf54\ub529 \uc635\uc158 ( UTF - 8 \uc0ac\uc6a9\uc2dc \"1\" )\n        $ct_cert->decrypt_enc_cert( $home_dir , $site_cd , $cert_no , $enc_cert_data , $opt );\n\n        $comm_id        = $ct_cert->mf_get_key_value(\"comm_id\"    );                // \uc774\ub3d9\ud1b5\uc2e0\uc0ac \ucf54\ub4dc\n        $phone_no       = $ct_cert->mf_get_key_value(\"phone_no\"   );                // \uc804\ud654\ubc88\ud638\n        $user_name      = $ct_cert->mf_get_key_value(\"user_name\"  );                // \uc774\ub984\n        $birth_day      = $ct_cert->mf_get_key_value(\"birth_day\"  );                // \uc0dd\ub144\uc6d4\uc77c\n        $sex_code       = $ct_cert->mf_get_key_value(\"sex_code\"   );                // \uc131\ubcc4\ucf54\ub4dc\n        $local_code     = $ct_cert->mf_get_key_value(\"local_code\" );                // \ub0b4/\uc678\uad6d\uc778 \uc815\ubcf4\n        $ci             = $ct_cert->mf_get_key_value(\"ci\"         );                // CI\n        $di             = $ct_cert->mf_get_key_value(\"di\"         );                // DI \uc911\ubcf5\uac00\uc785 \ud655\uc778\uac12\n        $ci_url         = urldecode( $ct_cert->mf_get_key_value(\"ci\"         ) );   // CI\n        $di_url         = urldecode( $ct_cert->mf_get_key_value(\"di\"         ) );   // DI \uc911\ubcf5\uac00\uc785 \ud655\uc778\uac12\n        $dec_res_cd     = $ct_cert->mf_get_key_value(\"res_cd\"     );                // \uc554\ud638\ud654\ub41c \uacb0\uacfc\ucf54\ub4dc\n        $dec_mes_msg    = $ct_cert->mf_get_key_value(\"res_msg\"    );                // \uc554\ud638\ud654\ub41c \uacb0\uacfc\uba54\uc2dc\uc9c0\n\n        if(strtoupper(substr(PHP_OS, 0, 3)) === 'WIN' && function_exists('mb_detect_encoding') ){\n            if( mb_detect_encoding($user_name, 'EUC-KR') === 'EUC-KR' ){\n                $user_name = iconv_utf8($user_name);\n                $dec_mes_msg = iconv_utf8($dec_mes_msg);\n            }\n        }\n\n        // \uc815\uc0c1\uc778\uc99d\uc778\uc9c0 \uccb4\ud06c\n        if(!$phone_no)\n            alert_close(\"\uc815\uc0c1\uc801\uc778 \uc778\uc99d\uc774 \uc544\ub2d9\ub2c8\ub2e4. \uc62c\ubc14\ub978 \ubc29\ubc95\uc73c\ub85c \uc774\uc6a9\ud574 \uc8fc\uc138\uc694.\");\n\n        $phone_no = hyphen_hp_number($phone_no);\n        $mb_dupinfo = $di;\n        $md5_ci = md5($ci.$ci);\n\n        $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$md5_ci}'\"); // ci\ub370\uc774\ud130\ub85c \ucc3e\uc74c\n        if (empty($row['mb_id'])) { // ci\ub85c \ub4f1\ub85d\ub41c \uacc4\uc815\uc774 \uc5c6\ub2e4\uba74\n            $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$mb_dupinfo}'\"); // di\ub370\uc774\ud130\ub85c \ucc3e\uc74c\n            if (empty($row['mb_id'])) { // di\ub85c \ub4f1\ub85d\ub41c \uacc4\uc815\ub3c4 \uc5c6\ub2e4\uba74\n                alert_close(\"\uc778\uc99d\ud558\uc2e0 \uc815\ubcf4\ub85c \uac00\uc785\ub41c \ud68c\uc6d0\uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.\");\n                exit;\n            }\n        }else{\n            $mb_dupinfo = $md5_ci;\n        }\n        \n        $md5_cert_no = md5($cert_no);\n        $hash_data   = md5($user_name.$cert_type.$birth_day.$phone_no.$md5_cert_no);\n        \n        // \uc131\uc778\uc778\uc99d\uacb0\uacfc\n        $adult_day = date(\"Ymd\", strtotime(\"-19 years\", G5_SERVER_TIME));\n        $adult = ((int)$birth_day <= (int)$adult_day) ? 1 : 0;\n        \n        set_session(\"ss_cert_type\",    $cert_type);\n        set_session(\"ss_cert_no\",      $md5_cert_no);\n        set_session(\"ss_cert_hash\",    $hash_data);\n        set_session(\"ss_cert_adult\",   $adult);\n        set_session(\"ss_cert_birth\",   $birth_day);\n        set_session(\"ss_cert_sex\",     ($sex_code==\"01\"?\"M\":\"F\")); // \uc774\ub2c8\uc2dc\uc2a4 \uac04\ud3b8\uc778\uc99d\uc740 \uc131\ubcc4\uc815\ubcf4 \ub9ac\ud134 \uc5c6\uc74c\n        set_session('ss_cert_dupinfo', $mb_dupinfo);\n        set_session('ss_cert_mb_id', $row['mb_id']);\n    }\n    else if( $res_cd != \"0000\" )\n    {\n        // \uc778\uc99d\uc2e4\ud328\n        alert_close('\ucf54\ub4dc : '.$_POST['res_cd'].'  '.urldecode($_POST['res_msg']));\n        exit;\n    }\n}\nelse if( $cert_enc_use != \"Y\" )\n{\n    // \uc554\ud638\ud654 \uc778\uc99d \uc548\ud568\n    if( G5_IS_MOBILE ){\n        echo '<script>'.PHP_EOL;\n        echo 'window.parent.$(\"#cert_info\").css(\"display\", \"\");'.PHP_EOL;\n        echo 'window.parent.$(\"#kcp_cert\" ).css(\"display\", \"none\");'.PHP_EOL;\n        echo '</script>'.PHP_EOL;\n    } else {\n        alert_close(\"\ud734\ub300\ud3f0 \ubcf8\uc778\ud655\uc778\uc744 \ucde8\uc18c \ud558\uc168\uc2b5\ub2c8\ub2e4.\");\n    }\n    exit;\n}\n\n$ct_cert->mf_clear();\n?>\n<form name=\"mbFindForm\" method=\"POST\">\n    <input type=\"hidden\" name=\"mb_id\" value=\"<?php echo $row[\"mb_id\"]; ?>\"> \n    <?php echo $sbParam; ?>   \n</form>\n<script>\n    jQuery(function($) {\n        \n        var $opener = window.opener;\n        var is_mobile = false;        \n        $opener.name=\"parentPage\";       \n\n        if (typeof g5_is_mobile != \"undefined\" && g5_is_mobile ) {\n            $opener = window.parent;\n            is_mobile = true;\n        } else {\n            $opener = window.opener;\n        }\n        \n        // up_hash \uac80\uc99d\n        if( document.mbFindForm.up_hash.value != $opener.$(\"input[name=veri_up_hash]\").val() ) {\n            alert(\"up_hash \ubcc0\uc870 \uc704\ud5d8\uc788\uc74c\");\n        }\n            \n        document.mbFindForm.target = \"parentPage\";\n        document.mbFindForm.action = \"<?php echo G5_BBS_URL.'/password_reset.php'?>\";\n        document.mbFindForm.submit();\n\n        alert(\"\ubcf8\uc778\uc778\uc99d\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\");\n        window.close();        \n    });\n</script>\n<?php\ninclude_once(G5_PATH.'/tail.sub.php');", "<?php\r\ninclude_once('./_common.php');\r\n\r\n$_POST = array_map_deep('conv_unescape_nl', $_POST);\r\n\r\n/*\r\n * [\ubcf8\uc778\ud655\uc778 \ucc98\ub9ac \ud398\uc774\uc9c0]\r\n *\r\n * LG\uc720\ud50c\ub7ec\uc2a4\uc73c\ub85c \ubd80\ud130 \ub0b4\ub824\ubc1b\uc740 LGD_AUTHONLYKEY(\uc778\uc99dKey)\ub97c \uac00\uc9c0\uace0 \ucd5c\uc885 \uc778\uc99d\uc694\uccad.(\ud30c\ub77c\ubbf8\ud130 \uc804\ub2ec\uc2dc POST\ub97c \uc0ac\uc6a9\ud558\uc138\uc694)\r\n */\r\n\r\n/*\r\n *************************************************\r\n * 1.\ucd5c\uc885\uc778\uc99d \uc694\uccad - BEGIN\r\n *************************************************\r\n */\r\n\r\n//LG\uc720\ud50c\ub7ec\uc2a4 \uacb0\uc81c \uc11c\ube44\uc2a4 \uc120\ud0dd(test:\ud14c\uc2a4\ud2b8, service:\uc11c\ube44\uc2a4)\r\nif($config['cf_cert_use'] == 2)\r\n    $CST_PLATFORM = 'service';\r\nelse\r\n    $CST_PLATFORM = 'test';\r\n$CST_MID                = 'si_'.$config['cf_lg_mid'];                       //\uc0c1\uc810\uc544\uc774\ub514(LG\uc720\ud50c\ub7ec\uc2a4\uc73c\ub85c \ubd80\ud130 \ubc1c\uae09\ubc1b\uc73c\uc2e0 \uc0c1\uc810\uc544\uc774\ub514\ub97c \uc785\ub825\ud558\uc138\uc694)\r\n                                                                            //\ud14c\uc2a4\ud2b8 \uc544\uc774\ub514\ub294 't'\ub97c \ubc18\ub4dc\uc2dc \uc81c\uc678\ud558\uace0 \uc785\ub825\ud558\uc138\uc694.\r\n$LGD_MID                = (('test' == $CST_PLATFORM) ? 't' : '').$CST_MID;  //\uc0c1\uc810\uc544\uc774\ub514(\uc790\ub3d9\uc0dd\uc131)\r\n$LGD_AUTHONLYKEY        = $_POST['LGD_AUTHONLYKEY'];\t\t\t            //LG\uc720\ud50c\ub7ec\uc2a4\uc73c\ub85c\ubd80\ud130 \ubd80\uc5ec\ubc1b\uc740 \uc778\uc99d\ud0a4\r\n$LGD_PAYTYPE  \t\t\t= $_POST['LGD_PAYTYPE'];\t\t\t\t            //\uc778\uc99d\uc694\uccad\ud0c0\uc785 (\uc2e0\uc6a9\uce74\ub4dc:ASC001, \ud734\ub300\ud3f0:ASC002, \uacc4\uc88c:ASC004)\r\n\r\nrequire_once(G5_LGXPAY_PATH.'/lgdacom/XPayClient.php');\r\n\r\n// mall.conf \uc124\uc815 \ucd94\uac00\ub97c \uc704\ud55c XPayClient \ud655\uc7a5\r\nclass XPay extends XPayClient\r\n{\r\n    public function set_config_value($key, $val)\r\n    {\r\n        $this->config[$key] = $val;\r\n    }\r\n}\r\n\r\n$configPath = G5_LGXPAY_PATH.'/lgdacom'; //LG\uc720\ud50c\ub7ec\uc2a4\uc5d0\uc11c \uc81c\uacf5\ud55c \ud658\uacbd\ud30c\uc77c(\"/conf/lgdacom.conf,/conf/mall.conf\") \uc704\uce58 \uc9c0\uc815.\r\n\r\n$xpay = new XPay($configPath, $CST_PLATFORM);\r\n\r\n// Mert Key \uc124\uc815\r\n$xpay->set_config_value('t'.$LGD_MID, $config['cf_lg_mert_key']);\r\n$xpay->set_config_value($LGD_MID, $config['cf_lg_mert_key']);\r\n\r\n$xpay->Init_TX($LGD_MID);\r\n$xpay->Set(\"LGD_TXNAME\", \"AuthOnlyByKey\");\r\n$xpay->Set(\"LGD_AUTHONLYKEY\", $LGD_AUTHONLYKEY);\r\n$xpay->Set(\"LGD_PAYTYPE\", $LGD_PAYTYPE);\r\n\r\n$g5['title'] = '\ud734\ub300\ud3f0\uc778\uc99d \uacb0\uacfc';\r\ninclude_once(G5_PATH.'/head.sub.php');\r\n\r\n/*\r\n *************************************************\r\n * 1.\ucd5c\uc885\uc778\uc99d \uc694\uccad(\uc218\uc815\ud558\uc9c0 \ub9c8\uc138\uc694) - END\r\n *************************************************\r\n */\r\n\r\n/*\r\n * 2. \ucd5c\uc885\uc778\uc99d \uc694\uccad \uacb0\uacfc\ucc98\ub9ac\r\n *\r\n * \ucd5c\uc885 \uc778\uc99d\uc694\uccad \uacb0\uacfc \ub9ac\ud134 \ud30c\ub77c\ubbf8\ud130\ub294 \uc5f0\ub3d9\uba54\ub274\uc5bc\uc744 \ucc38\uace0\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.\r\n */\r\nif ($xpay->TX()) {\r\n    //1)\uc778\uc99d\uacb0\uacfc \ud654\uba74\ucc98\ub9ac(\uc131\uacf5,\uc2e4\ud328 \uacb0\uacfc \ucc98\ub9ac\ub97c \ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.)\r\n    \r\n    /*\r\n    echo \"\uc778\uc99d\uc694\uccad\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.  <br>\";\r\n    echo \"TX Response_code = \" . $xpay->Response_Code() . \"<br>\";\r\n    echo \"TX Response_msg = \" . $xpay->Response_Msg() . \"<p>\";\r\n\r\n    $keys = $xpay->Response_Names();\r\n    foreach($keys as $name) {\r\n        echo $name . \" = \" . $xpay->Response($name, 0) . \"<br>\";\r\n    }\r\n\r\n    echo \"</p>\";\r\n    */\r\n\r\n    if( \"0000\" == $xpay->Response_Code() ) {\r\n        //\uc778\uc99d\uc694\uccad \uacb0\uacfc \uc131\uacf5 DB\ucc98\ub9ac\r\n        //echo \"\uc778\uc99d\uc694\uccad \uacb0\uacfc \uc131\uacf5 DB\ucc98\ub9ac\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.<br>\";\r\n        // \uc778\uc99d\ub0b4\uc5ed\uae30\ub85d \uc778\uc99d \uc131\uacf5\ud558\uba74 \ub85c\uadf8\ub97c \ub0a8\uae30\ub294\uac83\uc73c\ub85c \uc218\uc815 2021-09-13\r\n        @insert_cert_history($member['mb_id'], 'lg', 'hp');\r\n\r\n        $cert_no        = $xpay->Response('LGD_TID', 0);                      // LG \uc778\uc99d\ucc98\ub9ac\ubc88\ud638\r\n        $comm_id        = $xpay->Response('LGD_FINANCECODE', 0);              // \uc774\ub3d9\ud1b5\uc2e0\uc0ac \ucf54\ub4dc\r\n        $phone_no       = $xpay->Response('LGD_MOBILENUM', 0);                // \uc804\ud654\ubc88\ud638\r\n        $user_name      = $xpay->Response('LGD_MOBILE_SUBAUTH_NAME', 0);      // \uc774\ub984\r\n        $birth_day      = $xpay->Response('LGD_MOBILE_SUBAUTH_BIRTH', 0);     // \uc0dd\ub144\uc6d4\uc77c\r\n        $sex_code       = $xpay->Response('LGD_MOBILE_SUBAUTH_SEX', 0);       // \uc131\ubcc4\ucf54\ub4dc\r\n        $ci             = $xpay->Response('LGD_AUTHSUB_CI', 0);               // CI\r\n        $di             = $xpay->Response('LGD_AUTHSUB_DI', 0);               // DI \uc911\ubcf5\uac00\uc785 \ud655\uc778\uac12\r\n\r\n        // \ub0b4/\uc678\uad6d\uc778\r\n        if($sex_code > 4)\r\n            $local_code = 2; // \uc678\uad6d\uc778\r\n        else\r\n            $local_code = 1; // \ub0b4\uad6d\uc778\r\n\r\n        // \ub0a8/\uc5ec\uad6c\ubd84\r\n        if($sex_code % 2 == 0)\r\n            $mb_sex = 'F';\r\n        else\r\n            $mb_sex = 'M';\r\n\r\n        // \uc0dd\ub144\uc6d4\uc77c\r\n        if($sex_code < 5) {\r\n            if($sex_code <= 2)\r\n                $birth_prefix = '19';\r\n            else\r\n                $birth_prefix = '20';\r\n        } else {\r\n            if($sex_code <= 6)\r\n                $birth_prefix = '19';\r\n            else\r\n                $birth_prefix = '20';\r\n        }\r\n        $birth_day = $birth_prefix.$birth_day;\r\n\r\n        // \uc815\uc0c1\uc778\uc99d\uc778\uc9c0 \uccb4\ud06c\r\n        if(!$phone_no)\r\n            alert_close(\"\uc815\uc0c1\uc801\uc778 \uc778\uc99d\uc774 \uc544\ub2d9\ub2c8\ub2e4. \uc62c\ubc14\ub978 \ubc29\ubc95\uc73c\ub85c \uc774\uc6a9\ud574 \uc8fc\uc138\uc694.\");\r\n\r\n        $phone_no = hyphen_hp_number($phone_no);\r\n        $mb_dupinfo = $di;\r\n        $md5_ci = md5($ci.$ci);\r\n\r\n        $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$md5_ci}'\"); // ci\ub370\uc774\ud130\ub85c \ucc3e\uc74c\r\n        if (empty($row['mb_id'])) { // ci\ub85c \ub4f1\ub85d\ub41c \uacc4\uc815\uc774 \uc5c6\ub2e4\uba74\r\n            $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$mb_dupinfo}'\"); // di\ub370\uc774\ud130\ub85c \ucc3e\uc74c\r\n            if(empty($row['mb_id'])) {\r\n                alert_close(\"\uc778\uc99d\ud558\uc2e0 \uc815\ubcf4\ub85c \uac00\uc785\ub41c \ud68c\uc6d0\uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.\");\r\n                exit;\r\n            }\r\n        }else{\r\n            $mb_dupinfo = $md5_ci;\r\n        }\r\n        \r\n        $md5_cert_no = md5($cert_no);\r\n        $hash_data   = md5($user_name.$cert_type.$birth_day.$phone_no.$md5_cert_no);\r\n        \r\n        // \uc131\uc778\uc778\uc99d\uacb0\uacfc\r\n        $adult_day = date(\"Ymd\", strtotime(\"-19 years\", G5_SERVER_TIME));\r\n        $adult = ((int)$birth_day <= (int)$adult_day) ? 1 : 0;\r\n        \r\n        set_session(\"ss_cert_type\",    $cert_type);\r\n        set_session(\"ss_cert_no\",      $md5_cert_no);\r\n        set_session(\"ss_cert_hash\",    $hash_data);\r\n        set_session(\"ss_cert_adult\",   $adult);\r\n        set_session(\"ss_cert_birth\",   $birth_day);\r\n        set_session(\"ss_cert_sex\",     $mb_sex); // \uc774\ub2c8\uc2dc\uc2a4 \uac04\ud3b8\uc778\uc99d\uc740 \uc131\ubcc4\uc815\ubcf4 \ub9ac\ud134 \uc5c6\uc74c\r\n        set_session('ss_cert_dupinfo', $mb_dupinfo);\r\n        set_session('ss_cert_mb_id', $row['mb_id']);\r\n    } else {\r\n        //\uc778\uc99d\uc694\uccad \uacb0\uacfc \uc2e4\ud328 DB\ucc98\ub9ac\r\n        //echo \"\uc778\uc99d\uc694\uccad \uacb0\uacfc \uc2e4\ud328 DB\ucc98\ub9ac\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.<br>\";\r\n\r\n        if( G5_IS_MOBILE ){\r\n            echo '<script>'.PHP_EOL;\r\n            echo 'window.parent.$(\"#cert_info\").css(\"display\", \"\");'.PHP_EOL;\r\n            echo 'window.parent.$(\"#lgu_cert\" ).css(\"display\", \"none\");'.PHP_EOL;\r\n            echo 'alert(\"\uc778\uc99d\uc694\uccad\uc774 \ucde8\uc18c \ub610\ub294 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4.\\\\n\\\\n\ucf54\ub4dc : '.$xpay->Response_Code().'  '.$xpay->Response_Msg().'\")';\r\n            echo '</script>'.PHP_EOL;\r\n        } else {\r\n            alert_close('\uc778\uc99d\uc694\uccad\uc774 \ucde8\uc18c \ub610\ub294 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4.\\\\n\\\\n\ucf54\ub4dc : '.$xpay->Response_Code().'  '.$xpay->Response_Msg());\r\n        }\r\n        exit;\r\n    }\r\n} else {\r\n    //2)API \uc694\uccad\uc2e4\ud328 \ud654\uba74\ucc98\ub9ac\r\n    /*\r\n    echo \"\uc778\uc99d\uc694\uccad\uc774 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4.  <br>\";\r\n    echo \"TX Response_code = \" . $xpay->Response_Code() . \"<br>\";\r\n    echo \"TX Response_msg = \" . $xpay->Response_Msg() . \"<p>\";\r\n\r\n    //\uc778\uc99d\uc694\uccad \uacb0\uacfc \uc2e4\ud328 DB\ucc98\ub9ac\r\n    echo \"\uc778\uc99d\uc694\uccad \uacb0\uacfc \uc2e4\ud328 DB\ucc98\ub9ac\ud558\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.<br>\";\r\n    */\r\n\r\n    if( G5_IS_MOBILE ){\r\n        echo '<script>'.PHP_EOL;\r\n        echo 'window.parent.$(\"#cert_info\").css(\"display\", \"\");'.PHP_EOL;\r\n        echo 'window.parent.$(\"#lgu_cert\" ).css(\"display\", \"none\");'.PHP_EOL;\r\n        echo 'alert(\"\uc778\uc99d\uc694\uccad\uc774 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4.\\\\n\\\\n\ucf54\ub4dc : '.$xpay->Response_Code().'  '.$xpay->Response_Msg().'\")';\r\n        echo '</script>'.PHP_EOL;\r\n    } else {\r\n        alert_close('\uc778\uc99d\uc694\uccad\uc774 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4.\\\\n\\\\n\ucf54\ub4dc : '.$xpay->Response_Code().'  '.$xpay->Response_Msg());\r\n    }\r\n    exit;\r\n}\r\n?>\r\n<form name=\"mbFindForm\" method=\"POST\">\r\n    <input type=\"hidden\" name=\"mb_id\" value=\"<?php echo $row[\"mb_id\"]; ?>\">    \r\n</form>\r\n<script>\r\n    jQuery(function($) {\r\n        \r\n        var $opener = window.opener;\r\n        var is_mobile = false;        \r\n        $opener.name=\"parentPage\";\r\n\r\n        if (typeof g5_is_mobile != \"undefined\" && g5_is_mobile ) {\r\n            $opener = window.parent;\r\n            is_mobile = true;\r\n        } else {\r\n            $opener = window.opener;\r\n        }\r\n            \r\n        document.mbFindForm.target = \"parentPage\";\r\n        document.mbFindForm.action = \"<?php echo G5_BBS_URL.'/password_reset.php'?>\";\r\n        document.mbFindForm.submit();\r\n\r\n        alert(\"\ubcf8\uc778\uc778\uc99d\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\");\r\n        window.close();        \r\n    });\r\n</script>\r\n<?php\r\ninclude_once(G5_PATH.'/tail.sub.php');", "<?php\ninclude_once('./_common.php');\n\n$check_arrays = array('exe', 'keypath', 'memId', 'endPointURL', 'endPointUrl', 'logPath');\n\nforeach($check_arrays as $key){\n    if( isset($_REQUEST[$key]) && $_REQUEST[$key] ){\n        die('bad request');\n    }\n\n    $$key = '';\n}\n\n// KISA \ucde8\uc57d\uc810 \ub0b4\uc6a9(KVE-2018-0291) hpcert1.php\uc758 $cmd \ud568\uc218\uc5d0 \ub300\ud55c \uc778\uc790 \uac12\uc740 hpcert_config.php \ud30c\uc77c\uc5d0\uc11c \uc124\uc815\ub418\ub098, \uc774\ub97c \ub2e4\ub978 \ud398\uc774\uc9c0\uc5d0\uc11c \ud3ec\ud568\ud55c \ub4a4 \ud638\ucd9c\ud560 \uc2dc \uc784\uc758 \uac12 \uc124\uc815 \uac00\ub2a5\n// \uc774\uc5d0 include_once \ub97c require \ub85c \uc218\uc815\ud568\nrequire('./hpcert.config.php');\n/**************************************************************************\n    \ud30c\uc77c\uba85 : safe_hs_cert3.php\n\n    \uc0dd\ub144\uc6d4\uc77c \ubcf8\uc778 \ud655\uc778\uc11c\ube44\uc2a4 \uacb0\uacfc \ud654\uba74(return url)\n**************************************************************************/\n\n/* \uacf5\ud1b5 \ub9ac\ud134 \ud56d\ubaa9 */\n//$idcfMbrComCd           =   $_REQUEST['idcf_mbr_com_cd'];      // \uace0\uac1d\uc0ac\ucf54\ub4dc\n$idcfMbrComCd           =   $memId;\n$hsCertSvcTxSeqno       =   isset($_REQUEST['hs_cert_svc_tx_seqno']) ? $_REQUEST['hs_cert_svc_tx_seqno'] : ''; // \uac70\ub798\ubc88\ud638\n$rqstSiteNm             =   isset($_REQUEST['rqst_site_nm']) ? $_REQUEST['rqst_site_nm'] : '';         // \uc811\uc18d\ub3c4\uba54\uc778\n$hsCertRqstCausCd       =   isset($_REQUEST['hs_cert_rqst_caus_cd']) ? $_REQUEST['hs_cert_rqst_caus_cd'] : ''; // \uc778\uc99d\uc694\uccad\uc0ac\uc720\ucf54\ub4dc 2byte  (00:\ud68c\uc6d0\uac00\uc785, 01:\uc131\uc778\uc778\uc99d, 02:\ud68c\uc6d0\uc815\ubcf4\uc218\uc815, 03:\ube44\ubc00\ubc88\ud638\ucc3e\uae30, 04:\uc0c1\ud488\uad6c\ub9e4, 99:\uae30\ud0c0)\n\n$resultCd               =   isset($_REQUEST['result_cd']) ? $_REQUEST['result_cd'] : '';            // \uacb0\uacfc\ucf54\ub4dc\n$resultMsg              =   isset($_REQUEST['result_msg']) ? $_REQUEST['result_msg'] : '';           // \uacb0\uacfc\uba54\uc138\uc9c0\n$certDtTm               =   isset($_REQUEST['cert_dt_tm']) ? $_REQUEST['cert_dt_tm'] : '';           // \uc778\uc99d\uc77c\uc2dc\n\nif($resultCd != 'B000') {\n    alert_close('\ud734\ub300\ud3f0 \ubcf8\uc778\ud655\uc778 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \uc624\ub958\ucf54\ub4dc : '.$resultCd.'\\\\n\\\\n\ubb38\uc758\ub294 \ucf54\ub9ac\uc544\ud06c\ub808\ub527\ubdf0\ub85c \uace0\uac1d\uc13c\ud130 02-708-1000 \ub85c \ud574\uc8fc\uc2ed\uc2dc\uc624.');\n}\n\n/**************************************************************************\n * \ubaa8\ub4c8 \ud638\ucd9c    ; \uc0dd\ub144\uc6d4\uc77c \ubcf8\uc778 \ud655\uc778\uc11c\ube44\uc2a4 \uacb0\uacfc \ub370\uc774\ud130\ub97c \ubcf5\ud638\ud654\ud55c\ub2e4.\n **************************************************************************/\n$encInfo = isset($_REQUEST['encInfo']) ? $_REQUEST['encInfo'] : '';\nif(preg_match('~[^0-9a-zA-Z+/=]~', $encInfo, $match)) {echo \"\uc785\ub825 \uac12 \ud655\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4\"; exit;}\n\n//KCB\uc11c\ubc84 \uacf5\uac1c\ud0a4\n$WEBPUBKEY = isset($_REQUEST['WEBPUBKEY']) ? trim($_REQUEST['WEBPUBKEY']) : '';\nif(preg_match('~[^0-9a-zA-Z+/=]~', $WEBPUBKEY, $match)) {echo \"\uc785\ub825 \uac12 \ud655\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4\"; exit;}\n\n//KCB\uc11c\ubc84 \uc11c\uba85\uac12\n$WEBSIGNATURE = isset($_REQUEST['WEBSIGNATURE']) ? trim($_REQUEST['WEBSIGNATURE']) : '';\nif(preg_match('~[^0-9a-zA-Z+/=]~', $WEBSIGNATURE, $match)) {echo \"\uc785\ub825 \uac12 \ud655\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4\"; exit;}\n\n// ########################################################################\n// # \uc554\ud638\ud654\ud0a4 \ud30c\uc77c \uc124\uc815 (\uc808\ub300\uacbd\ub85c) - \ud30c\uc77c\uc740 \uc8fc\uc5b4\uc9c4 \ud30c\uc77c\uba85\uc73c\ub85c \uc790\ub3d9 \uc0dd\uc131 \ub428\n// ########################################################################\n$keypath = G5_OKNAME_PATH.'/key/safecert_'.$idcfMbrComCd.'.key';\n\n$cpubkey = $WEBPUBKEY;    //server publickey\n$csig = $WEBSIGNATURE;    //server signature\n\n// ########################################################################\n// # \ub85c\uadf8 \uacbd\ub85c \uc9c0\uc815 \ubc0f \uad8c\ud55c \ubd80\uc5ec (\uc808\ub300\uacbd\ub85c)\n// # \uc635\uc158\uac12\uc5d0 'L'\uc744 \ucd94\uac00\ud558\ub294 \uacbd\uc6b0\uc5d0\ub9cc \ub85c\uadf8\uac00 \uc0dd\uc131\ub428.\n// ########################################################################\n$option = 'SU';\n\n// \uba85\ub839\uc5b4\n$cmd = \"$exe $keypath $idcfMbrComCd $endPointUrl $WEBPUBKEY $WEBSIGNATURE $encInfo $logPath $option\";\n\n// \uc2e4\ud589\nexec($cmd, $out, $ret);\n\n// \uc778\uc99d\ub0b4\uc5ed\uae30\ub85d\n@insert_cert_history($member['mb_id'], 'kcb', 'hp');\n\nif($ret == 0) {\n    // \uacb0\uacfc\ub77c\uc778\uc5d0\uc11c \uac12\uc744 \ucd94\ucd9c\n    foreach($out as $a => $b) {\n        if($a < 17) {\n            $field[$a] = $b;\n        }\n    }\n    $resultCd = $field[0];\n}\nelse {\n    if($ret <=200)\n        $resultCd=sprintf(\"B%03d\", $ret);\n    else\n        $resultCd=sprintf(\"S%03d\", $ret);\n}\n\n/*\necho \"\ucc98\ub9ac\uacb0\uacfc\ucf54\ub4dc      :$resultCd  <br/>\";\necho \"\ucc98\ub9ac\uacb0\uacfc\uba54\uc2dc\uc9c0    :$field[1]  <br/>\";\necho \"\uac70\ub798\uc77c\ub828\ubc88\ud638      :$field[2]  <br/>\";\necho \"\uc778\uc99d\uc77c\uc2dc          :$field[3]  <br/>\";\necho \"DI                :$field[4]  <br/>\";\necho \"CI                :$field[5]  <br/>\";\necho \"\uc131\uba85              :$field[7]  <br/>\";\necho \"\uc0dd\ub144\uc6d4\uc77c          :$field[8]  <br/>\";\necho \"\uc131\ubcc4              :$field[9]  <br/>\";\necho \"\ub0b4\uc678\uad6d\uc778\uad6c\ubd84      :$field[10] <br/>\";\necho \"\ud1b5\uc2e0\uc0ac\ucf54\ub4dc        :$field[11] <br/>\";\necho \"\ud734\ub300\ud3f0\ubc88\ud638        :$field[12] <br/>\";\necho \"\ub9ac\ud134\uba54\uc2dc\uc9c0        :$field[16] <br/>\";\n*/\n\n// \uc778\uc99d\uacb0\uacfc\ucc98\ub9ac\n$mb_name = $field[7];\n$req_num = $field[12];\n$mb_birth = $field[8];\n$mb_dupinfo = $field[4];\n$ci = $field[5];\n\n$phone_no = hyphen_hp_number($req_num);\n$md5_ci = md5($ci.$ci);\n\n$row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$md5_ci}'\"); // ci\ub370\uc774\ud130\ub85c \ucc3e\uc74c\nif (empty($row['mb_id'])) { // ci\ub85c \ub4f1\ub85d\ub41c \uacc4\uc815\uc774 \uc5c6\ub2e4\uba74\n    $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$mb_dupinfo}'\"); // di\ub370\uc774\ud130\ub85c \ucc3e\uc74c\n    if(empty($row['mb_id'])) {\n        alert_close(\"\uc778\uc99d\ud558\uc2e0 \uc815\ubcf4\ub85c \uac00\uc785\ub41c \ud68c\uc6d0\uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.\");\n        exit;\n    }\n}else{\n    $mb_dupinfo = $md5_ci;\n}\n\n$md5_cert_no = md5($cert_no);\n$hash_data   = md5($user_name.$cert_type.$birth_day.$phone_no.$md5_cert_no);\n\n// \uc131\uc778\uc778\uc99d\uacb0\uacfc\n$adult_day = date(\"Ymd\", strtotime(\"-19 years\", G5_SERVER_TIME));\n$adult = ((int)$birth_day <= (int)$adult_day) ? 1 : 0;\n\nset_session(\"ss_cert_type\",    $cert_type);\nset_session(\"ss_cert_no\",      $md5_cert_no);\nset_session(\"ss_cert_hash\",    $hash_data);\nset_session(\"ss_cert_adult\",   $adult);\nset_session(\"ss_cert_birth\",   $birth_day);\nset_session('ss_cert_sex',     ($field[9] == 1 ? 'M' : 'F'));\nset_session('ss_cert_dupinfo', $mb_dupinfo);\nset_session('ss_cert_mb_id', $row['mb_id']);\n\n$g5['title'] = 'KCB \ud734\ub300\ud3f0 \ubcf8\uc778\ud655\uc778';\ninclude_once(G5_PATH.'/head.sub.php');\n?>\n<form name=\"mbFindForm\" method=\"POST\">\n    <input type=\"hidden\" name=\"mb_id\" value=\"<?php echo $row[\"mb_id\"]; ?>\">    \n</form>\n<script>\n    jQuery(function($) {\n        \n        var $opener = window.opener;\n        var is_mobile = false;        \n        $opener.name=\"parentPage\";\n\n        if (typeof g5_is_mobile != \"undefined\" && g5_is_mobile ) {\n            $opener = window.parent;\n            is_mobile = true;\n        } else {\n            $opener = window.opener;\n        }\n            \n        document.mbFindForm.target = \"parentPage\";\n        document.mbFindForm.action = \"<?php echo G5_BBS_URL.'/password_reset.php'?>\";\n        document.mbFindForm.submit();\n\n        alert(\"\ubcf8\uc778\uc778\uc99d\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\");\n        window.close();        \n    });\n</script>\n<?php\ninclude_once(G5_PATH.'/tail.sub.php');", "<?php\r\ninclude_once('./_common.php');\r\n\r\n$check_arrays = array('exe', 'keypath', 'memid', 'EndPointURL', 'cpubkey', 'csig', 'encdata', 'logpath', 'option');\r\n\r\nforeach($check_arrays as $key){\r\n    if( isset($_REQUEST[$key]) && $_REQUEST[$key] ){\r\n        die('bad request');\r\n    }\r\n\r\n    $$key = '';\r\n}\r\n\r\nrequire('./ipin.config.php');\r\n\r\n//\uc544\uc774\ud540\ud31d\uc5c5\uc5d0\uc11c \uc870\ud68c\ud55c PERSONALINFO\uc774\ub2e4.\r\n@$encPsnlInfo = isset($_REQUEST[\"encPsnlInfo\"]) ? $_REQUEST[\"encPsnlInfo\"] : '';\r\nif(preg_match('~[^0-9a-zA-Z+/=]~', $encPsnlInfo, $match)) {echo \"\uc785\ub825 \uac12 \ud655\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4\"; exit;}\r\n\r\n//KCB\uc11c\ubc84 \uacf5\uac1c\ud0a4\r\n@$WEBPUBKEY = isset($_REQUEST[\"WEBPUBKEY\"]) ? trim($_REQUEST[\"WEBPUBKEY\"]) : '';\r\nif(preg_match('~[^0-9a-zA-Z+/=]~', $WEBPUBKEY, $match)) {echo \"\uc785\ub825 \uac12 \ud655\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4\"; exit;}\r\n\r\n//KCB\uc11c\ubc84 \uc11c\uba85\uac12\r\n@$WEBSIGNATURE = isset($_REQUEST[\"WEBSIGNATURE\"]) ? trim($_REQUEST[\"WEBSIGNATURE\"]) : '';\r\nif(preg_match('~[^0-9a-zA-Z+/=]~', $WEBSIGNATURE, $match)) {echo \"\uc785\ub825 \uac12 \ud655\uc778\uc774 \ud544\uc694\ud569\ub2c8\ub2e4\"; exit;}\r\n\r\n//\uc544\uc774\ud540 \uc11c\ubc84\uc640 \ud1b5\uc2e0\uc744 \uc704\ud55c \ud0a4\ud30c\uc77c \uc0dd\uc131\r\n// \ud30c\ub77c\ubbf8\ud130 \uc815\uc758\r\n$cpubkey = $WEBPUBKEY;    //server publickey\r\n$csig = $WEBSIGNATURE;    //server signature\r\n$encdata = $encPsnlInfo;  //PERSONALINFO\r\n$option = \"SU\";\r\n\r\n// \uba85\ub839\uc5b4\r\n$cmd = \"$exe $keypath $memid $EndPointURL $cpubkey $csig $encdata $logpath $option\";\r\n\r\n// \uc2e4\ud589\r\nexec($cmd, $out, $ret);\r\n\r\n// \uc778\uc99d\ub0b4\uc5ed\uae30\ub85d\r\n@insert_cert_history($member['mb_id'], 'kcb', 'ipin');\r\n\r\nif($ret != 0) {\r\n    if($ret <=200)\r\n        $resultCd=sprintf(\"B%03d\", $ret);\r\n    else\r\n        $resultCd=sprintf(\"S%03d\", $ret);\r\n\r\n    alert_close('\uc544\uc774\ud540 \ubcf8\uc778\ud655\uc778 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. \uc624\ub958\ucf54\ub4dc : '.$resultCd.'\\\\n\\\\n\ubb38\uc758\ub294 \ucf54\ub9ac\uc544\ud06c\ub808\ub527\ubdf0\ub85c \uace0\uac1d\uc13c\ud130 02-708-1000 \ub85c \ud574\uc8fc\uc2ed\uc2dc\uc624.');\r\n}\r\n\r\n// \uacb0\uacfc\ub77c\uc778\uc5d0\uc11c \uac12\uc744 \ucd94\ucd9c\r\nforeach($out as $a => $b) {\r\n    if($a < 13) {\r\n        $field[$a] = $b;\r\n    }\r\n}\r\n\r\n/*\r\n$field_name_IPIN_DEC = array(\r\n    \"dupInfo        \",\t// 0\r\n    \"coinfo1        \",\t// 1\r\n    \"coinfo2        \",\t// 2\r\n    \"ciupdate       \",\t// 3\r\n    \"virtualNo      \",\t// 4\r\n    \"cpCode         \",\t// 5\r\n    \"realName       \",\t// 6\r\n    \"cpRequestNumber\",\t// 7\r\n    \"age            \",\t// 8\r\n    \"sex            \",\t// 9\r\n    \"nationalInfo   \",\t// 10\r\n    \"birthDate      \",\t// 11\r\n    \"authInfo       \",\t// 12\r\n);\r\n*/\r\n\r\n$mb_name = $field[6];\r\n$req_num = $field[7];\r\n$mb_birth = $field[11];\r\n$mb_dupinfo = $field[0];\r\nif(!empty($field[1])) { // \uc544\uc774\ud540\uc740 \ub9ac\ud134\ubc1b\ub294 ci \ub370\uc774\ud130\uac00 \ub450\uac00\uc9c0\uc778\uac78\ub85c \ubcf4\uc544 \uac1c\uc778\ubcc4\ub85c \ubc1b\ub294 \uacf3\uc774 \ub2e4\ub97c \uc218\ub3c4 \uc788\uc744\uac83 \uac19\uc544\uc11c \ucd94\uac00\ud568 2021-09-13 hjkim7153\r\n    $ci = $field[1];\r\n}else if(!empty($field[2])) {\r\n    $ci = $field[2];\r\n}else{\r\n    alert_close('\uc544\uc774\ud540 \ubcf8\uc778\ud655\uc778 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4. (ci \uc815\ubcf4 \uc5c6\uc74c) \uc624\ub958\ucf54\ub4dc : '.$resultCd.'\\\\n\\\\n\ubb38\uc758\ub294 \ucf54\ub9ac\uc544\ud06c\ub808\ub527\ubdf0\ub85c \uace0\uac1d\uc13c\ud130 02-708-1000 \ub85c \ud574\uc8fc\uc2ed\uc2dc\uc624.');\r\n}\r\n$md5_ci = md5($ci.$ci);\r\n\r\n$row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$md5_ci}'\"); // ci\ub370\uc774\ud130\ub85c \ucc3e\uc74c\r\nif (empty($row['mb_id'])) { // ci\ub85c \ub4f1\ub85d\ub41c \uacc4\uc815\uc774 \uc5c6\ub2e4\uba74\r\n    $row = sql_fetch(\"select mb_id from {$g5['member_table']} where mb_id <> '{$member['mb_id']}' and mb_dupinfo = '{$mb_dupinfo}'\"); // di\ub370\uc774\ud130\ub85c \ucc3e\uc74c\r\n    if(empty($row['mb_id'])) {\r\n        alert_close(\"\uc778\uc99d\ud558\uc2e0 \uc815\ubcf4\ub85c \uac00\uc785\ub41c \ud68c\uc6d0\uc815\ubcf4\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.\");\r\n        exit;\r\n    }\r\n}else{\r\n    $mb_dupinfo = $md5_ci;\r\n}\r\n\r\n$md5_cert_no = md5($cert_no);\r\n$hash_data   = md5($user_name.$cert_type.$birth_day.$phone_no.$md5_cert_no);\r\n\r\n// \uc131\uc778\uc778\uc99d\uacb0\uacfc\r\n$adult_day = date(\"Ymd\", strtotime(\"-19 years\", G5_SERVER_TIME));\r\n$adult = ((int)$birth_day <= (int)$adult_day) ? 1 : 0;\r\n\r\nset_session(\"ss_cert_type\",    $cert_type);\r\nset_session(\"ss_cert_no\",      $md5_cert_no);\r\nset_session(\"ss_cert_hash\",    $hash_data);\r\nset_session(\"ss_cert_adult\",   $adult);\r\nset_session(\"ss_cert_birth\",   $birth_day);\r\nset_session('ss_cert_sex',     ($field[9] == 1 ? 'M' : 'F'));\r\nset_session('ss_cert_dupinfo', $mb_dupinfo);\r\nset_session('ss_cert_mb_id', $row['mb_id']);\r\n\r\n$g5['title'] = 'KCB \uc544\uc774\ud540 \ubcf8\uc778\ud655\uc778';\r\ninclude_once(G5_PATH.'/head.sub.php');\r\n?>\r\n\r\n<form name=\"mbFindForm\" method=\"POST\">\r\n    <input type=\"hidden\" name=\"mb_id\" value=\"<?php echo $row[\"mb_id\"]; ?>\">    \r\n</form>\r\n<script>\r\n    jQuery(function($) {\r\n        \r\n        var $opener = window.opener;\r\n        var is_mobile = false;        \r\n        $opener.name=\"parentPage\";\r\n\r\n        if (typeof g5_is_mobile != \"undefined\" && g5_is_mobile ) {\r\n            $opener = window.parent;\r\n            is_mobile = true;\r\n        } else {\r\n            $opener = window.opener;\r\n        }\r\n            \r\n        document.mbFindForm.target = \"parentPage\";\r\n        document.mbFindForm.action = \"<?php echo G5_BBS_URL.'/password_reset.php'?>\";\r\n        document.mbFindForm.submit();\r\n\r\n        alert(\"\ubcf8\uc778\uc778\uc99d\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\");\r\n        window.close();        \r\n    });\r\n</script>\r\n<?php\r\ninclude_once(G5_PATH.'/tail.sub.php');", "<?php\nif (!defined('_GNUBOARD_')) exit; // \uac1c\ubcc4 \ud398\uc774\uc9c0 \uc811\uadfc \ubd88\uac00\n\n// add_stylesheet('css \uad6c\ubb38', \ucd9c\ub825\uc21c\uc11c); \uc22b\uc790\uac00 \uc791\uc744 \uc218\ub85d \uba3c\uc800 \ucd9c\ub825\ub428\nadd_stylesheet('<link rel=\"stylesheet\" href=\"' . $member_skin_url . '/style.css\">', 0);\n?>\n\n<!-- \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \uc2dc\uc791 { -->\n<div id=\"pw_reset\" class=\"new_win\">\n    <div class=\"new_win_con\">\n        <form name=\"fpasswordreset\" action=\"<?php echo $action_url; ?>\" onsubmit=\"return fpasswordreset_submit(this);\" method=\"post\" autocomplete=\"off\">\n            <fieldset id=\"info_fs\">\n                <p>\uc0c8\ub85c\uc6b4 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.</p>\n                <label for=\"mb_id\" class=\"sound_only\">\uc544\uc774\ub514</label>\n                <br>\n                <b>\ud68c\uc6d0 \uc544\uc774\ub514 : <?php echo $_POST['mb_id']; ?></b>\n                <label for=\"mb_pw\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password\" id=\"mb_pw\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638\">\n                <label for=\"mb_pw2\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password_re\" id=\"mb_pw2\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778\">\n            </fieldset>\n            <div class=\"win_btn\">\n                <button type=\"submit\" class=\"btn_submit\">\ud655\uc778</button>\n            </div>\n        </form>\n    </div>\n</div>\n\n<script>\nfunction fpasswordreset_submit(f) {\n    if ($(\"#mb_pw\").val() == $(\"#mb_pw2\").val()) {\n        alert(\"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574 \uc8fc\uc138\uc694.\");\n    } else {\n        alert(\"\uc0c8 \ube44\ubc00\ubc88\ud638\uc640 \ube44\ubc00\ubc88\ud638 \ud655\uc778\uc774 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\");\n        return false;\n    }\n}\n</script>\n<!-- } \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \ub05d -->", "<?php\nif (!defined('_GNUBOARD_')) exit; // \uac1c\ubcc4 \ud398\uc774\uc9c0 \uc811\uadfc \ubd88\uac00\n\n// add_stylesheet('css \uad6c\ubb38', \ucd9c\ub825\uc21c\uc11c); \uc22b\uc790\uac00 \uc791\uc744 \uc218\ub85d \uba3c\uc800 \ucd9c\ub825\ub428\nadd_stylesheet('<link rel=\"stylesheet\" href=\"' . $member_skin_url . '/style.css\">', 0);\n?>\n\n<!-- \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \uc2dc\uc791 { -->\n<div id=\"pw_reset\" class=\"new_win\">\n    <div class=\"new_win_con\">\n        <form name=\"fpasswordreset\" action=\"<?php echo $action_url; ?>\" onsubmit=\"return fpasswordreset_submit(this);\" method=\"post\" autocomplete=\"off\">\n            <fieldset id=\"info_fs\">\n                <p>\uc0c8\ub85c\uc6b4 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.</p>\n                <label for=\"mb_id\" class=\"sound_only\">\uc544\uc774\ub514</label>\n                <br>\n                <b>\ud68c\uc6d0 \uc544\uc774\ub514 : <?php echo $_POST['mb_id']; ?></b>\n                <label for=\"mb_pw\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password\" id=\"mb_pw\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638\">\n                <label for=\"mb_pw2\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password_re\" id=\"mb_pw2\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778\">\n            </fieldset>\n            <div class=\"win_btn\">\n                <button type=\"submit\" class=\"btn_submit\">\ud655\uc778</button>\n            </div>\n        </form>\n    </div>\n</div>\n\n<script>\nfunction fpasswordreset_submit(f) {\n    if ($(\"#mb_pw\").val() == $(\"#mb_pw2\").val()) {\n        alert(\"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574 \uc8fc\uc138\uc694.\");\n    } else {\n        alert(\"\uc0c8 \ube44\ubc00\ubc88\ud638\uc640 \ube44\ubc00\ubc88\ud638 \ud655\uc778\uc774 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\");\n        return false;\n    }\n}\n</script>\n<!-- } \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \ub05d -->", "<?php\nif (!defined('_GNUBOARD_')) exit; // \uac1c\ubcc4 \ud398\uc774\uc9c0 \uc811\uadfc \ubd88\uac00\n\n// add_stylesheet('css \uad6c\ubb38', \ucd9c\ub825\uc21c\uc11c); \uc22b\uc790\uac00 \uc791\uc744 \uc218\ub85d \uba3c\uc800 \ucd9c\ub825\ub428\nadd_stylesheet('<link rel=\"stylesheet\" href=\"' . $member_skin_url . '/style.css\">', 0);\n?>\n\n<!-- \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \uc2dc\uc791 { -->\n<div id=\"pw_reset\" class=\"new_win\">\n    <div class=\"new_win_con\">\n        <form name=\"fpasswordreset\" action=\"<?php echo $action_url; ?>\" onsubmit=\"return fpasswordreset_submit(this);\" method=\"post\" autocomplete=\"off\">\n            <fieldset id=\"info_fs\">\n                <p>\uc0c8\ub85c\uc6b4 \ube44\ubc00\ubc88\ud638\ub97c \uc785\ub825\ud574\uc8fc\uc138\uc694.</p>\n                <label for=\"mb_id\" class=\"sound_only\">\uc544\uc774\ub514</label>\n                <br>\n                <b>\ud68c\uc6d0 \uc544\uc774\ub514 : <?php echo $_POST['mb_id']; ?></b>\n                <label for=\"mb_pw\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password\" id=\"mb_pw\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638\">\n                <label for=\"mb_pw2\" class=\"sound_only\">\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778<strong class=\"sound_only\">\ud544\uc218</strong></label>\n                <input type=\"password\" name=\"mb_password_re\" id=\"mb_pw2\" required class=\"required frm_input full_input\" size=\"30\" placeholder=\"\uc0c8 \ube44\ubc00\ubc88\ud638 \ud655\uc778\">\n            </fieldset>\n            <div class=\"win_btn\">\n                <button type=\"submit\" class=\"btn_submit\">\ud655\uc778</button>\n            </div>\n        </form>\n    </div>\n</div>\n\n<script>\nfunction fpasswordreset_submit(f) {\n    if ($(\"#mb_pw\").val() == $(\"#mb_pw2\").val()) {\n        alert(\"\ube44\ubc00\ubc88\ud638 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \ub85c\uadf8\uc778\ud574 \uc8fc\uc138\uc694.\");\n    } else {\n        alert(\"\uc0c8 \ube44\ubc00\ubc88\ud638\uc640 \ube44\ubc00\ubc88\ud638 \ud655\uc778\uc774 \uc77c\uce58\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.\");\n        return false;\n    }\n}\n</script>\n<!-- } \ube44\ubc00\ubc88\ud638 \uc7ac\uc124\uc815 \ub05d -->"], "filenames": ["bbs/password_reset_update.php", "mobile/skin/member/basic/password_reset.skin.php", "plugin/inicert/ini_find_result.php", "plugin/kcpcert/find_kcpcert_result.php", "plugin/lgxpay/find_AuthOnlyRes.php", "plugin/okname/find_hpcert2.php", "plugin/okname/find_ipin2.php", "skin/member/basic/password_reset.skin.php", "theme/basic/mobile/skin/member/basic/password_reset.skin.php", "theme/basic/skin/member/basic/password_reset.skin.php"], "buggy_code_start_loc": [4, 15, 52, 162, 139, 123, 97, 15, 15, 15], "buggy_code_end_loc": [26, 16, 52, 163, 141, 124, 98, 16, 16, 16], "fixing_code_start_loc": [4, 15, 53, 162, 139, 124, 98, 15, 15, 15], "fixing_code_end_loc": [30, 17, 69, 181, 158, 143, 118, 17, 17, 17], "type": "CWE-732", "message": "Gnuboard 5.5.4 and 5.5.5 is vulnerable to Insecure Permissions. An attacker can change password of all users without knowing victim's original password.", "other": {"cve": {"id": "CVE-2022-44216", "sourceIdentifier": "cve@mitre.org", "published": "2023-02-20T20:15:10.290", "lastModified": "2023-03-02T19:27:19.917", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Gnuboard 5.5.4 and 5.5.5 is vulnerable to Insecure Permissions. An attacker can change password of all users without knowing victim's original password."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-732"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sir:gnuboard:5.5.4:*:*:*:*:*:*:*", "matchCriteriaId": "BE04DB8C-E78D-40CD-895D-6FB01A9D974C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:sir:gnuboard:5.5.5:*:*:*:*:*:*:*", "matchCriteriaId": "A0D5F8C5-75C4-4586-AEAB-C1868E9E8463"}]}]}], "references": [{"url": "https://github.com/gnuboard/gnuboard5/commit/11718eb4c02ffdca5393bedc0300a75e4e7b19f2", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://gratis-herring-da5.notion.site/Gnuboard-Account-Takeover-version-5-5-4-5-5-5-2f69b0a21be642f58d8b7c72feea343a", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://sir.kr/g5_pds/6400", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/gnuboard/gnuboard5/commit/11718eb4c02ffdca5393bedc0300a75e4e7b19f2"}}