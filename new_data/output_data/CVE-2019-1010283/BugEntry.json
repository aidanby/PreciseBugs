{"buggy_code": ["univention-directory-notifier (12.0.1-10) unstable; urgency=low\n\n  * Bug #48427: Change import limits\n\n -- Philipp Hahn <hahn@univention.de>  Fri, 08 Feb 2019 08:32:06 +0100\n\nunivention-directory-notifier (12.0.1-9) unstable; urgency=low\n\n  * Bug #48427: Add ldap lookup and validate translog DB on startup\n\n -- Philipp Hahn <hahn@univention.de>  Thu, 07 Feb 2019 16:05:07 +0100\n\nunivention-directory-notifier (12.0.1-8) unstable; urgency=low\n\n  * Bug #48427: Fix Python format strings.\n\n -- Philipp Hahn <hahn@univention.de>  Wed, 06 Feb 2019 12:58:02 +0100\n\nunivention-directory-notifier (12.0.1-7) unstable; urgency=medium\n\n  * Bug #41262: improve univention-replicate-many\n\n -- Jannik Ahlers <ahlers@univention.de>  Tue, 05 Feb 2019 17:22:12 +0100\n\nunivention-directory-notifier (12.0.1-6) unstable; urgency=low\n\n  * Bug #48427: Skip invalid transactions\n\n -- Philipp Hahn <hahn@univention.de>  Tue, 05 Feb 2019 16:55:19 +0100\n\nunivention-directory-notifier (12.0.1-5) unstable; urgency=medium\n\n  * Bug #41262: make sure univention-replicate-many gets installed into /sbin\n\n -- Jannik Ahlers <ahlers@univention.de>  Tue, 05 Feb 2019 12:32:06 +0100\n\nunivention-directory-notifier (12.0.1-4) unstable; urgency=low\n\n  * Bug #48427: Implement Univention Directory Notifier protocol version 3\n\n -- Philipp Hahn <hahn@univention.de>  Tue, 05 Feb 2019 11:28:59 +0100\n\nunivention-directory-notifier (12.0.1-3) unstable; urgency=medium\n\n  * Bug #41262: Include new script univention-replicate-many\n\n -- Jannik Ahlers <ahlers@univention.de>  Wed, 30 Jan 2019 12:16:25 +0100\n\nunivention-directory-notifier (12.0.1-2) unstable; urgency=medium\n\n  * Bug #46312: increase runsv timeout to 30 seconds\n\n -- J\u00fcrn Brodersen <brodersen@univention.de>  Wed, 21 Feb 2018 15:16:46 +0100\n\nunivention-directory-notifier (12.0.1-1) unstable; urgency=medium\n\n  * Use service instead of invoke-rc.d since systemd policy layer\n    prevents starting services in a chroot environment (Bug #45905)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 19 Dec 2017 22:18:04 +0100\n\nunivention-directory-notifier (12.0.0-1) unstable; urgency=medium\n\n  * Bug #45841: UCS-4.3 version bump\n\n -- J\u00fcrn Brodersen <brodersen@univention.de>  Mon, 11 Dec 2017 14:40:23 +0100\n\nunivention-directory-notifier (11.0.0-4) unstable; urgency=low\n\n  * Bug #43470: Revert ucs-4.2-0@77762\n\n -- Philipp Hahn <hahn@univention.de>  Thu, 16 Mar 2017 06:00:07 +0100\n\nunivention-directory-notifier (11.0.0-3) unstable; urgency=low\n\n  * Bug #43470: Handle UCRV */autostart through systemd\n\n -- Philipp Hahn <hahn@univention.de>  Wed, 15 Mar 2017 08:52:56 +0100\n\nunivention-directory-notifier (11.0.0-2) unstable; urgency=low\n\n  * Bug #38438: Fix message printing in init-script\n\n -- Philipp Hahn <hahn@univention.de>  Tue, 13 Sep 2016 09:58:29 +0200\n\nunivention-directory-notifier (11.0.0-1) unstable; urgency=medium\n\n  * Bug #41963: UCS-4.2 version bump\n  * Bug #38438: Make init-script LSB compliant\n\n -- Philipp Hahn <hahn@univention.de>  Fri, 12 Aug 2016 13:56:27 +0200\n\nunivention-directory-notifier (10.0.1-1) unstable; urgency=medium\n\n  * Bump version for UCS 4.1 (Bug #39729)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 03 Nov 2015 22:12:06 +0100\n\nunivention-directory-notifier (9.0.3-2) unstable; urgency=low\n\n  * Bug #36532: Speed up network re-config\n\n -- Philipp Hahn <hahn@univention.de>  Thu, 22 Jan 2015 11:24:47 +0100\n\nunivention-directory-notifier (9.0.3-1) unstable; urgency=medium\n\n  * Wait for the notifier start in 15univention-directory-notifier-\n    post.inst (Bug #35723)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 09 Sep 2014 20:37:17 +0200\n\nunivention-directory-notifier (9.0.2-2) unstable; urgency=medium\n\n  * Fix typo in 15univention-directory-notifier-post.inst (Bug #35723)\n\n -- Arvid Requate <requate@univention.de>  Tue, 09 Sep 2014 17:57:43 +0200\n\nunivention-directory-notifier (9.0.2-1) unstable; urgency=medium\n\n  * Changed quoting in 15univention-directory-notifier-post.inst\n    (Bug #35723)\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 08 Sep 2014 21:49:28 +0200\n\nunivention-directory-notifier (9.0.1-2) unstable; urgency=low\n\n  * Fix quoting in previous change (Bug #35723)\n\n -- Arvid Requate <requate@univention.de>  Mon, 08 Sep 2014 15:17:56 +0200\n\nunivention-directory-notifier (9.0.1-1) unstable; urgency=low\n\n  * The notifier join script now waits for the first initialization of\n    the listener on a DC master. This avoids a race condition during the\n    DC master installation (Bug #35723)\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 29 Aug 2014 16:10:12 +0200\n\nunivention-directory-notifier (9.0.0-1) unstable; urgency=low\n\n  * Update to UCS 4.0 (Bug #35144) \n\n -- Felix Botner <botner@univention.de>  Tue, 19 Aug 2014 10:07:51 +0200\n\nunivention-directory-notifier (8.0.0-2) unstable; urgency=low\n\n  * Update/review UCR variable descriptions (Bug #30946)\n\n -- Moritz M\u00fchlenhoff <muehlenhoff@univention.de>  Tue, 24 Sep 2013 09:07:25 +0200\n\nunivention-directory-notifier (8.0.0-1) unstable; urgency=low\n\n  * Bump version for UCS 3.2, update copyright years for 2013\n  * Update/review UCR variable descriptions (Bug #30946)\n\n -- Moritz M\u00fchlenhoff <muehlenhoff@univention.de>  Wed, 11 Sep 2013 12:00:14 +0200\n\nunivention-directory-notifier (7.0.8-4) unstable; urgency=low\n\n  * fix permissions for the script (Bug #30408) \n\n -- Arvid Requate <requate@univention.de>  Wed, 13 Feb 2013 12:06:20 +0100\n\nunivention-directory-notifier (7.0.8-3) unstable; urgency=low\n\n  * rename etc/network/if-post-down.d/appliance-notifier (Bug #30412)\n\n -- Arvid Requate <requate@univention.de>  Wed, 13 Feb 2013 12:00:00 +0100\n\nunivention-directory-notifier (7.0.8-2) unstable; urgency=low\n\n  * rename etc/network/if-post-down.d/appliance-notifier (Bug #30412)\n  * fix permissions for the script\n\n -- Arvid Requate <requate@univention.de>  Wed, 13 Feb 2013 11:49:08 +0100\n\nunivention-directory-notifier (7.0.8-1) unstable; urgency=low\n\n  * Add etc/network/if-post-down.d/appliance-notifier (Bug #30412)\n\n -- Arvid Requate <requate@univention.de>  Wed, 13 Feb 2013 11:25:39 +0100\n\nunivention-directory-notifier (7.0.7-1) unstable; urgency=low\n\n  * univention-directory-notifier now uses the current joinscript-lib\n    (Bug #28993)\n\n -- Erik Damrose <damrose@univention.de>  Fri, 04 Jan 2013 09:07:24 +0100\n\nunivention-directory-notifier (7.0.6-3) unstable; urgency=low\n\n  * Add linking exception for OpenSSL (Bug #26440)\n\n -- Moritz M\u00fchlenhoff <muehlenhoffunivention.de>  Tue, 02 Oct 2012 13:57:32 +0200\n\nunivention-directory-notifier (7.0.6-2) unstable; urgency=low\n\n  * univention-replicate-one: more minor fixes (Bug #27625)\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 17 Sep 2012 15:17:24 +0200\n\nunivention-directory-notifier (7.0.6-1) unstable; urgency=low\n\n  * Cleanups for univention-replicate-one (Bug #27625):\n    - Print error messages on stderr\n    - Call init script directly instead of using invoke-rc.d\n    - Cleanup messages\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 17 Sep 2012 07:20:57 +0200\n\nunivention-directory-notifier (7.0.5-2) unstable; urgency=low\n\n  * Include shell lib before using is_ucr_true (Bug #28361)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 11 Sep 2012 07:48:41 +0200\n\nunivention-directory-notifier (7.0.5-1) unstable; urgency=low\n\n  * Ensure the NSS group cache is up to date (Bug #28361)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 11 Sep 2012 06:48:01 +0200\n\nunivention-directory-notifier (7.0.4-2) unstable; urgency=low\n\n  * Fix atomic locking (Bug #28417)\n\n -- Philipp Hahn <hahn@univention.de>  Wed, 05 Sep 2012 13:07:53 +0200\n\nunivention-directory-notifier (7.0.4-1) unstable; urgency=low\n\n  * Drop LDAP dependencies.\n  * Fix atomic locking (Bug #27330)\n\n -- Philipp Hahn <hahn@univention.de>  Wed, 05 Sep 2012 07:19:15 +0200\n\nunivention-directory-notifier (7.0.3-1) unstable; urgency=low\n\n  * Write changes to /var/lib/univention-ldap/listener/listener instead\n    of /var/lib/univention-ldap/notify/transaction (Bug #27625)\n  * Stop slapd while adding a DN to the listener/listener file\n    (Bug #27625)\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 30 Aug 2012 08:28:13 +0200\n\nunivention-directory-notifier (7.0.2-1) unstable; urgency=low\n\n  * Added univention-replicate-one to replicate one DN (Bug #27625)\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 30 Aug 2012 07:32:24 +0200\n\nunivention-directory-notifier (7.0.1-1) unstable; urgency=low\n\n  * Donwgrade the debug level for an info message from WARNING to INFO\n    (Bug #26916)\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 30 Aug 2012 06:57:24 +0200\n\nunivention-directory-notifier (7.0.0-1) unstable; urgency=low\n\n  * UCS-3.1 version bump.\n  * Add UCR variable descriptions (Bug #28134)\n  * Remove setting unsued UCR variable:\n    - listener/supply/notifier?yes\n\n -- Philipp Hahn <hahn@univention.de>  Thu, 02 Aug 2012 12:54:46 +0200\n\nunivention-directory-notifier (6.0.8-2) unstable; urgency=low\n\n  * src/network.c: Notifier opened socket only with AF_INET6\n    and failed if IPv6 was not available. Added some code that\n    first tries opening with AF_INET6 and (if that fails) tries\n    to open with AF_INET (Bug #26469).\n\n -- Juergen Kahrs <Kahrs@univention.de>  Mon, 11 Jun 2012 11:25:06 +0200\n\nunivention-directory-notifier (6.0.8-1) unstable; urgency=low\n\n  * Restart notifier on update to 3.0 (Bug #24472)\n\n -- Stefan Gohmann <gohmann@univention.de>  Wed, 09 Nov 2011 14:33:07 +0100\n\nunivention-directory-notifier (6.0.7-1) unstable; urgency=low\n\n  * open AF_INET6 socket (can handle IPv6 and IPv4 connections) (Bug #24284)\n\n -- S\u00f6nke Schwardt-Krummrich <schwardt@univention.de>  Tue, 01 Nov 2011 14:41:28 +0100\n\nunivention-directory-notifier (6.0.6-3) unstable; urgency=low\n\n  * Fix dependencies on u-c (Bug #22668)\n\n -- Philipp Hahn <hahn@univention.de>  Sat, 22 Oct 2011 04:11:19 +0200\n\nunivention-directory-notifier (6.0.6-2) unstable; urgency=low\n\n  * updated postinst (Bug #23577)\n\n -- S\u00f6nke Schwardt-Krummrich <schwardt@univention.de>  Wed, 19 Oct 2011 17:57:25 +0200\n\nunivention-directory-notifier (6.0.6-1) unstable; urgency=low\n\n  * added firewall settings (Bug #23577)\n\n -- S\u00f6nke Schwardt-Krummrich <schwardt@univention.de>  Tue, 18 Oct 2011 15:16:50 +0200\n\nunivention-directory-notifier (6.0.5-2) unstable; urgency=low\n\n  * added logrotate template (Bug #18002)\n\n -- Felix Botner <botner@univention.de>  Wed, 12 Oct 2011 09:16:38 +0200\n\nunivention-directory-notifier (6.0.5-1) unstable; urgency=low\n\n  * added logrotate configuration (Bug #18002)\n\n -- Felix Botner <botner@univention.de>  Wed, 12 Oct 2011 09:13:04 +0200\n\nunivention-directory-notifier (6.0.4-1) unstable; urgency=low\n\n  * Restart listener and notifier in 15univention-directory-notifier-post.inst\n    (Bug #23826)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 27 Sep 2011 12:19:02 +0200\n\nunivention-directory-notifier (6.0.3-1) unstable; urgency=low\n\n  * Fixed bashisms (Bug #22431)\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 29 Jul 2011 07:03:32 +0200\n\nunivention-directory-notifier (6.0.2-1) unstable; urgency=low\n\n  * Fixed typo in last commit: Added dependency to shell-univention-lib\n    > 1.0.6 (Bug #22431)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 07 Jun 2011 15:36:15 +0200\n\nunivention-directory-notifier (6.0.1-1) unstable; urgency=low\n\n  * Added dependency to shell-univention-lib > 1.0.6 (Bug #22431)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 07 Jun 2011 09:56:14 +0200\n\nunivention-directory-notifier (6.0.0-2) unstable; urgency=low\n\n  * Added copyright block to conffiles/etc/runit/univention-directory-\n    notifier/run (Bug #22431)\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 16 May 2011 16:52:31 +0200\n\nunivention-directory-notifier (6.0.0-1) unstable; urgency=low\n\n  * Package cleanup for UCS 3.0 (Bug #22431)\n    * Bump version for UCS 3.0\n    * Replace univention-baseconfig with univention-config-registry\n    * Replace static UCR header in the UCR templates with '@%@UCRWARNING=#\n      @%@'\n    * Update copyright to 2011\n    * Update to debhelper 7\n    * Removed transition package univention-ldap-notifier\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 09 May 2011 08:47:14 +0200\n\nunivention-directory-notifier (5.0.0-1) unstable; urgency=low\n\n  * convert to GNU APGL V3 (Bug #17543)\n  * bump version for UCS 2.4\n\n -- Janek Walkenhorst <walkenhorst@univention.de>  Tue, 22 Jun 2010 13:39:03 +0200\n\nunivention-directory-notifier (4.0.0-3) unstable; urgency=low\n\n  * changed predependency to simple dependency (Bug: #15971)\n\n -- S\u00f6nke Schwardt <schwardt@univention.de>  Wed, 14 Oct 2009 16:43:29 +0200\n\nunivention-directory-notifier (4.0.0-2) unstable; urgency=low\n\n  * less verbose debug messages (Bug: #13226)\n\n -- Felix Botner <botner@univention.de>  Tue, 29 Sep 2009 11:08:36 +0200\n\nunivention-directory-notifier (4.0.0-1) unstable; urgency=low\n\n  * Make init script LSB-compliant (Bug #14421)\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue,  2 Jun 2009 17:05:24 +0200\n\nunivention-directory-notifier (3.0.1-3) unstable; urgency=low\n\n  * updated the copyright. Bug #6875\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 12 Mar 2009 13:47:36 +0100\n\nunivention-directory-notifier (3.0.1-2) unstable; urgency=low\n\n  * updated the copyright. Bug #6875\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 19 Feb 2009 08:55:57 +0100\n\nunivention-directory-notifier (3.0.1-1) unstable; urgency=low\n\n  * don't stop the notifier in the preinst. Bug #13065\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 10 Feb 2009 07:45:49 +0100\n\nunivention-directory-notifier (2.2.2-6) unstable; urgency=low\n\n  * Added UCR Warning.\n\n -- Andre Fenske <fenske@univention.de>  Thu,  4 Dec 2008 13:16:40 +0100\n\nunivention-directory-notifier (2.2.2-5) unstable; urgency=low\n\n  * new autostart test in init script\n\n -- Felix Botner <fbotner@visdalen.knut.univention.de>  Tue, 28 Oct 2008 14:51:00 +0100\n\nunivention-directory-notifier (2.2.2-4) unstable; urgency=low\n\n  * call the join script in the postinst\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 25 Oct 2007 08:26:34 +0200\n\nunivention-directory-notifier (2.2.2-3) unstable; urgency=low\n\n  * check if /etc/runit/univention/univention-ldap-notifier is a\n    symbolic link and replace the link with\n    /etc/runit/univention/univention-directory-notifier\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 18 Oct 2007 17:12:51 +0200\n\nunivention-directory-notifier (2.2.2-2) unstable; urgency=low\n\n  * remove old ldap-notifier init script\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 11 Oct 2007 07:56:59 +0200\n\nunivention-directory-notifier (2.2.2-1) unstable; urgency=low\n\n  * fixed logfile permissions\n\n -- S\u00f6nke Schwardt <schwardt@univention.de>  Thu, 27 Sep 2007 14:33:09 +0200\n\nunivention-directory-notifier (2.2.1-3) unstable; urgency=low\n\n  * added conflict to the old transition package\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 20 Sep 2007 08:23:28 +0200\n\nunivention-directory-notifier (2.2.1-2) unstable; urgency=low\n\n  * added univention-ldap-notifier transition package\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 14 Sep 2007 11:56:37 +0200\n\nunivention-directory-notifier (2.2.1-1) unstable; urgency=low\n\n  * more wording stuff\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 31 Aug 2007 08:03:17 +0200\n\nunivention-directory-notifier (2.1.1-10) unstable; urgency=low\n\n  * added permission fix of transaction file in additional join script\n\n -- S\u00f6nke Schwardt <schwardt@univention.de>  Thu, 23 Aug 2007 10:02:05 +0200\n\nunivention-directory-notifier (2.1.1-9) unstable; urgency=low\n\n  * Fixed two typos in postinst\n\n -- S\u00f6nke Schwardt <schwardt@univention.de>  Wed, 22 Aug 2007 13:15:25 +0200\n\nunivention-directory-notifier (2.1.1-8) unstable; urgency=low\n\n  * Drop symlink test, as the files in /etc/runit/univention are always\n    created as symlinks\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 14 Aug 2007 14:43:46 +0200\n\nunivention-directory-notifier (2.1.1-7) unstable; urgency=low\n\n  * Fix directory name\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 14 Aug 2007 10:51:46 +0200\n\nunivention-directory-notifier (2.1.1-6) unstable; urgency=low\n\n  * Add transition code for wording changes\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 14 Aug 2007 09:49:27 +0200\n\nunivention-directory-notifier (2.1.1-5) unstable; urgency=low\n\n  * Fixed permissions of transaction file\n\n -- S\u00f6nke Schwardt <schwardt@univention.de>  Mon, 13 Aug 2007 17:11:01 +0200\n\nunivention-directory-notifier (2.1.1-4) unstable; urgency=low\n\n  * Update service definition\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Wed,  8 Aug 2007 14:41:14 +0200\n\nunivention-directory-notifier (2.1.1-3) unstable; urgency=low\n\n  * Fix join script.\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Thu,  2 Aug 2007 16:15:44 +0200\n\nunivention-directory-notifier (2.1.1-2) unstable; urgency=low\n\n  * Rename join script\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Thu,  2 Aug 2007 12:51:04 +0200\n\nunivention-directory-notifier (2.1.1-1) unstable; urgency=low\n\n  * add version number to join script\n\n -- Andreas B\u00fcsching <buesching@univention.de>  Thu,  2 Aug 2007 09:26:45 +0200\n\nunivention-directory-notifier (2.1.0-4) unstable; urgency=low\n\n  * More wording changes\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 31 Jul 2007 14:15:51 +0200\n\nunivention-directory-notifier (2.1.0-3) unstable; urgency=low\n\n  * Fix Makefile error\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 31 Jul 2007 14:04:10 +0200\n\nunivention-directory-notifier (2.1.0-2) unstable; urgency=low\n\n  * Fix wording-related build failure.\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 31 Jul 2007 12:48:19 +0200\n\nunivention-directory-notifier (2.1.0-1) unstable; urgency=low\n\n  * Rename to Univention Directory Notifier\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 31 Jul 2007 11:37:57 +0200\n\nunivention-ldap-notifier (2.0.4-3) unstable; urgency=low\n\n  * add service description\n  * add Configuration Registry variable notifier/autostart to set start type\n\n -- Andreas B\u00fcsching <buesching@univention.de>  Wed, 25 Jul 2007 11:07:57 +0200\n\nunivention-ldap-notifier (2.0.4-2) unstable; urgency=low\n\n  * create join script\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 18 Jun 2007 19:44:54 +0200\n\nunivention-ldap-notifier (2.0.3-1) unstable; urgency=low\n\n  * only try to start the daemon if the runsv link exists\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 18 Jun 2007 16:17:55 +0200\n\nunivention-ldap-notifier (2.0.2-2) unstable; urgency=low\n\n  * encoded files utf-8\n\n -- Janis Meybohm <meybohm@univention.de>  Wed, 13 Jun 2007 15:29:34 +0200\n\nunivention-ldap-notifier (2.0.2-1) unstable; urgency=low\n\n  * switch from runsvctrl to sv\n\n -- Stefan Gohmann <gohmann@univention.de>  Wed, 13 Jun 2007 13:18:26 +0200\n\nunivention-ldap-notifier (2.0.1-1) unstable; urgency=low\n\n  * the notifier doesn't need to wait for the replog file because now the a\n    ldap overlay module writes the transaction file.\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 14 May 2007 13:15:55 +0200\n\nunivention-ldap-notifier (2.0.0-1) unstable; urgency=low\n\n  * update to ucs 2.0 policies\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 14 May 2007 11:55:08 +0200\n\nunivention-ldap-notifier (1.14) unstable; urgency=low\n\n  * add GPL headers\n  * code cleanup\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 27 Nov 2006 14:29:47 +0100\n\nunivention-ldap-notifier (1.12) unstable; urgency=low\n\n  * check for empty transaction file on powerpc architecture\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 17 Feb 2006 16:17:30 +0100\n\nunivention-ldap-notifier (1.10) unstable; urgency=low\n\n  * update to UCS 1.3\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon,  5 Dec 2005 13:42:15 +0100\n\nunivention-ldap-notifier (1.9) unstable; urgency=low\n\n  * evaluate notifier/replog/sleep on Notifier Slave System\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu,  2 Jun 2005 14:06:24 +0200\n\nunivention-ldap-notifier (1.7) unstable; urgency=low\n\n  * support modrdn\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue,  3 May 2005 14:05:02 +0200\n\nunivention-ldap-notifier (1.6) unstable; urgency=low\n\n  * added baseconfig var for usleep replog pasrsing\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 21 Mar 2005 20:46:11 +0100\n\nunivention-ldap-notifier (1.5) unstable; urgency=low\n\n  * set listener baseconfig var listener/supply/notifier\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 18 Mar 2005 12:59:18 +0100\n\nunivention-ldap-notifier (1.4) unstable; urgency=low\n\n  * support for move ldap objects\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 21 Jan 2005 16:47:25 +0100\n\nunivention-ldap-notifier (1.3) unstable; urgency=low\n\n  * sleep 0,5 seconds before reading the replog file\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 14 Jan 2005 14:14:56 +0100\n\nunivention-ldap-notifier (1.2) unstable; urgency=low\n\n  * fixed schema id bug\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 23 Dec 2004 07:46:23 +0100\n\nunivention-ldap-notifier (1.1) unstable; urgency=low\n\n  * use semaphore for critical sections\n  * open socket before parsing replog (so that we don't parse the\n    replog before realizing that another notifier is already running)\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 18 Jun 2004 12:56:23 +0200\n\nunivention-ldap-notifier (1.0) unstable; urgency=low\n\n  * Add an ID index for the transaction file; this speeds up\n    requests significantly.\n\n -- Roland Bauerschmidt <bauerschmidt@univention.de>  Thu, 10 Jun 2004 15:20:49 +0200\n\nunivention-ldap-notifier (0.06) unstable; urgency=low\n\n  * new protocol v2\n  * support for schema replication\n  * internal cache added\n  * add proper package description\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 26 Apr 2004 16:23:43 +0200\n\nunivention-ldap-notifier (0.05) unstable; urgency=low\n\n  * waiting for lock file\n\n -- Stefan Gohmann <gohmann@univention.de>  Wed, 10 Mar 2004 17:56:52 +0100\n\nunivention-ldap-notifier (0.04) unstable; urgency=low\n\n  * write slurpd replog file (bugfix)\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon,  8 Mar 2004 17:03:19 +0100\n\nunivention-ldap-notifier (0.03) unstable; urgency=low\n\n  * increment last id\n  * restart notifier on update\n  * don't send notifications to all listener if one listener ask\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 19 Feb 2004 08:30:20 +0100\n\nunivention-ldap-notifier (0.02) unstable; urgency=low\n\n  * added init.d start script\n\n -- Stefan Gohmann <gohmann@univention.de>  Sat, 14 Feb 2004 14:13:43 +0100\n\nunivention-ldap-notifier (0.01) unstable; urgency=low\n\n  * Initial release.\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 11 Sep 2003 13:03:44 +0200\n", "/*\n * Univention Directory Notifier\n *\n * Copyright 2004-2019 Univention GmbH\n *\n * http://www.univention.de/\n *\n * All rights reserved.\n *\n * The source code of this program is made available\n * under the terms of the GNU Affero General Public License version 3\n * (GNU AGPL V3) as published by the Free Software Foundation.\n *\n * Binary versions of this program provided by Univention to you as\n * well as other copyrighted, protected or trademarked materials like\n * Logos, graphics, fonts, specific documentations and configurations,\n * cryptographic keys etc. are subject to a license agreement between\n * you and Univention and not subject to the GNU AGPL V3.\n *\n * In the case you use this program under the terms of the GNU AGPL V3,\n * the program is provided in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public\n * License with the Debian GNU/Linux or Univention distribution in file\n * /usr/share/common-licenses/AGPL-3; if not, see\n * <http://www.gnu.org/licenses/>.\n */\n\n#define __USE_GNU\n\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <stdio.h>\n#include <netinet/in.h>\n#include <sys/time.h>\n#include <sys/ioctl.h>\n#include <sys/un.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <stdint.h>\n\n#include <univention/debug.h>\n\n#include \"notify.h\"\n#include \"network.h\"\n#include \"cache.h\"\n#include \"sem.h\"\n\nextern int sem_id;\n\nextern fd_set readfds;\n\nextern NotifyId_t notify_last_id;\n\nextern unsigned long SCHEMA_ID;\n\n\n/* read one line from network packages*/\n\nint get_network_line(char *packet, char *network_line)\n{\n\tint i=0;\n\n\tmemset(network_line, 0, 8192);\n\n\twhile ( packet[i] != '\\0' && packet[i] != '\\n' ) {\n\n\t\tnetwork_line[i]=packet[i];\n\t\ti+=1;\n\t}\n\n\tif ( packet[i] == '\\0' ) {\n\t\treturn 0;\n\t}\n\n\tif ( i == 0 ) {\n\t\tnetwork_line[i]='\\0';\n\t}\n\n\tnetwork_line[i+1]='\\0';\n\n\treturn 1;\n}\n\nint data_on_connection(int fd, callback_remove_handler remove)\n{\n\tint nread;\n\tchar *network_packet;\n\tchar network_line[8192];\n\tchar *p;\n\tunsigned long id;\n\n\tchar string[1024];\n\tunsigned long msg_id = UINT32_MAX;\n\tenum network_protocol version = network_client_get_version(fd);\n\n\tioctl(fd, FIONREAD, &nread);\n\n\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"new connection data = %d\\n\",nread);\n\n\tif(nread == 0)\n\t{\n\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_PROCESS, \"%d failed, got 0 close connection to listener \", fd);\n\t\tclose(fd);\n\t\tFD_CLR(fd, &readfds);\n\t\tremove(fd);\n\t\tnetwork_client_dump ();\n\t\treturn 0;\n\t}\n\n\n\tif ( nread >= 8192 ) {\n\n\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ERROR, \"%d failed, more than 8192 close connection to listener \", fd);\n\t\tclose(fd);\n\t\tFD_CLR(fd, &readfds);\n\t\tremove(fd);\n\n\t\treturn 0;\n\t}\n\n\t/* read the whole package */\n\tnetwork_packet=malloc((nread+1) * sizeof(char));\n\tread(fd, network_packet, nread);\n\tnetwork_packet[nread]='\\0';\n\n\tmemset(network_line, 0, 8192);\n\tp=network_packet;\n\tp_sem(sem_id);\n\n\twhile ( get_network_line(p, network_line) ) {\n\n\t\tif ( strlen(network_line) > 0 ) {\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"line = [%s]\",network_line);\n\t\t}\n\n\t\t\n\t\tif ( !strncmp(network_line, \"MSGID: \", strlen(\"MSGID: \")) ) {\n\t\t\t/* read message id  */\n\n\t\t\tmsg_id=strtoul(&(network_line[strlen(\"MSGID: \")]), NULL, 10);\n\n\t\t\tp+=strlen(network_line);\n\n\n\t\t} else if ( !strncmp(network_line, \"Version: \", strlen(\"Version: \")) ) {\n\t\t\tchar *head = network_line, *end;\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: VERSION\");\n\n\t\t\tversion = strtoul(head + 9, &end, 10);\n\t\t\tif (!head[9] || *end)\n\t\t\t\tgoto failed;\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"VERSION=%d\", version);\n\n\t\t\tif (version < network_procotol_version) {\n\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_PROCESS, \"Forbidden VERSION=%d < %d, close connection to listener\", version, network_procotol_version);\n\t\t\t\tgoto close;\n\t\t\t} else if (version >= PROTOCOL_LAST) {\n\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_PROCESS, \"Future VERSION=%d\", version);\n\t\t\t\tversion = PROTOCOL_LAST - 1;\n\t\t\t}\n\t\t\tnetwork_client_set_version(fd, version);\n\t\t\t\n\t\t\t/* reset message id */\n\t\t\tmsg_id = UINT32_MAX;\n\n\t\t\tp+=strlen(network_line);\n\n\n\t\t} else if ( !strncmp(network_line, \"Capabilities: \", strlen(\"Capabilities: \")) ) {\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: Capabilities\");\n\n\t\t\tif ( version > PROTOCOL_UNKNOWN ) {\n\n\t\t\t\tmemset(string, 0, sizeof(string));\n\t\t\t\t\n\t\t\t\tsnprintf(string, sizeof(string), \"Version: %d\\nCapabilities: \\n\\n\", version);\n\n\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"SEND: %s\", string);\n\n\t\t\t\twrite(fd, string, strlen(string));\n\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"Capabilities recv, but no version line\");\n\t\t\t\t\n\t\t\t}\n\n\t\t\tp+=strlen(network_line);\n\n\n\t\t} else if ( !strncmp(network_line, \"GET_DN \", strlen(\"GET_DN \")) && msg_id != UINT32_MAX && network_client_get_version(fd) > 0) {\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: GET_DN\");\n\n\t\t\tid=strtoul(&(network_line[strlen(\"GET_DN \")]), NULL, 10);\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"id: %ld\",id);\n\n\t\t\tif ( id <= notify_last_id.id) {\n\n\t\t\t\tchar *dn_string = NULL;\n\n\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"try to read %ld from cache\", id);\n\n\t\t\t\t/* try to read from cache */\n\t\t\t\tif ( (dn_string = notifier_cache_get(id)) == NULL ) {\n\n\t\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"%ld not found in cache\", id);\n\n\t\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"%ld get one dn\", id);\n\n\t\t\t\t\t/* read from transaction file, because not in cache */\n\t\t\t\t\tif( (dn_string=notify_transcation_get_one_dn ( id )) == NULL ) {\n\n\t\t\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"%ld failed \", id);\n\t\t\t\t\t\t/* TODO: maybe close connection? */\n\n\t\t\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ERROR, \"%d failed, close connection to listener \", fd);\n\t\t\t\t\t\tclose(fd);\n\t\t\t\t\t\tFD_CLR(fd, &readfds);\n\t\t\t\t\t\tremove(fd);\n\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( dn_string != NULL ) {\n\n\t\t\t\t\tsnprintf(string, sizeof(string), \"MSGID: %ld\\n%s\\n\\n\",msg_id,dn_string);\n\n\t\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"--> %d: [%s]\",fd, string);\n\n\t\t\t\t\twrite(fd, string, strlen(string));\n\n\t\t\t\t\tfree(dn_string);\n\n\t\t\t\t}\n\n\n\t\t\t} else {\n\t\t\t\t/* set wanted id */\n\n\t\t\t\tnetwork_client_set_next_id(fd, id);\n\t\t\t\tnetwork_client_set_msg_id(fd, msg_id);\n\n\t\t\t}\n\n\t\t\tp+=strlen(network_line)+1;\n\t\t\tmsg_id = UINT32_MAX;\n\n\t\t} else if (!strncmp(p, \"WAIT_ID \", 8) && msg_id != UINT32_MAX && version >= PROTOCOL_3) {\n\t\t\tchar *head = network_line, *end;\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: WAIT_ID\");\n\t\t\tid = strtoul(head + 8, &end, 10);\n\t\t\tif (!head[8] || *end)\n\t\t\t\tgoto failed;\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"id: %ld\", id);\n\n\t\t\tif (id <= notify_last_id.id) {\n\t\t\t\tsnprintf(string, sizeof(string), \"MSGID: %ld\\n%ld\\n\\n\", msg_id, notify_last_id.id);\n\t\t\t\twrite(fd, string, strlen(string));\n\t\t\t} else {\n\t\t\t\t/* set wanted id */\n\t\t\t\tnetwork_client_set_next_id(fd, id);\n\t\t\t\tnetwork_client_set_msg_id(fd, msg_id);\n\t\t\t}\n\n\t\t\tp += strlen(network_line) + 1;\n\t\t\tmsg_id = UINT32_MAX;\n\n\t\t} else if ( !strncmp(network_line, \"GET_ID\", strlen(\"GET_ID\")) && msg_id != UINT32_MAX  && network_client_get_version(fd) > 0) {\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: GET_ID\");\n\n\t\t\tmemset(string, 0, sizeof(string));\n\n\t\t\tsnprintf(string, sizeof(string), \"MSGID: %ld\\n%ld\\n\\n\",msg_id,notify_last_id.id);\n\n\t\t\twrite(fd, string, strlen(string));\n\n\t\t\tp+=strlen(network_line)+1;\n\t\t\tmsg_id = UINT32_MAX;\n\n\n\t\t} else if ( !strncmp(network_line, \"GET_SCHEMA_ID\", strlen(\"GET_SCHEMA_ID\")) && msg_id != UINT32_MAX  && network_client_get_version(fd) > 0) {\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: GET_SCHEMA_ID\");\n\n\t\t\tmemset(string, 0, sizeof(string));\n\n\t\t\tsnprintf(string, sizeof(string), \"MSGID: %ld\\n%ld\\n\\n\",msg_id,SCHEMA_ID);\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"--> %d: [%s]\",fd, string);\n\n\t\t\twrite(fd, string, strlen(string));\n\n\t\t\tp+=strlen(network_line)+1;\n\t\t\tmsg_id = UINT32_MAX;\n\n\n\t\t} else if ( !strncmp(network_line, \"ALIVE\", strlen(\"ALIVE\")) && msg_id != UINT32_MAX  && network_client_get_version(fd) > 0) {\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: ALIVE\");\n\n\t\t\tsnprintf(string, sizeof(string), \"MSGID: %ld\\nOKAY\\n\\n\",msg_id);\n\n\t\t\twrite(fd, string, strlen(string));\n\n\t\t\tp+=strlen(network_line)+1;\n\t\t\tmsg_id = UINT32_MAX;\n\n\t\t} else {\n\n\t\t\tp+=strlen(network_line);\n\n\t\t\tif (strlen(network_line) == 0 ) {\n\t\t\t\tp+=1;\n \t\t\t} else {\n\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ERROR, \"Drop package [%s]\", network_line);\n\t\t\t}\n\n\t\t}\n\t}\n\tv_sem(sem_id);\n\n\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"END Package\");\n\t\n\n\tnetwork_client_dump ();\n\n\treturn 0;\n\nfailed:\n\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_PROCESS, \"Failed parsing [%s]\", p);\nclose:\n\tclose(fd);\n\tFD_CLR(fd, &readfds);\n\tremove(fd);\n\treturn 0;\n}\n\n"], "fixing_code": ["univention-directory-notifier (12.0.1-11) unstable; urgency=low\n\n  * Bug #48427: Forbid vulnerable GET_DN for VERSION >= 3\n\n -- Philipp Hahn <hahn@univention.de>  Wed, 13 Feb 2019 10:23:12 +0100\n\nunivention-directory-notifier (12.0.1-10) unstable; urgency=low\n\n  * Bug #48427: Change import limits\n\n -- Philipp Hahn <hahn@univention.de>  Fri, 08 Feb 2019 08:32:06 +0100\n\nunivention-directory-notifier (12.0.1-9) unstable; urgency=low\n\n  * Bug #48427: Add ldap lookup and validate translog DB on startup\n\n -- Philipp Hahn <hahn@univention.de>  Thu, 07 Feb 2019 16:05:07 +0100\n\nunivention-directory-notifier (12.0.1-8) unstable; urgency=low\n\n  * Bug #48427: Fix Python format strings.\n\n -- Philipp Hahn <hahn@univention.de>  Wed, 06 Feb 2019 12:58:02 +0100\n\nunivention-directory-notifier (12.0.1-7) unstable; urgency=medium\n\n  * Bug #41262: improve univention-replicate-many\n\n -- Jannik Ahlers <ahlers@univention.de>  Tue, 05 Feb 2019 17:22:12 +0100\n\nunivention-directory-notifier (12.0.1-6) unstable; urgency=low\n\n  * Bug #48427: Skip invalid transactions\n\n -- Philipp Hahn <hahn@univention.de>  Tue, 05 Feb 2019 16:55:19 +0100\n\nunivention-directory-notifier (12.0.1-5) unstable; urgency=medium\n\n  * Bug #41262: make sure univention-replicate-many gets installed into /sbin\n\n -- Jannik Ahlers <ahlers@univention.de>  Tue, 05 Feb 2019 12:32:06 +0100\n\nunivention-directory-notifier (12.0.1-4) unstable; urgency=low\n\n  * Bug #48427: Implement Univention Directory Notifier protocol version 3\n\n -- Philipp Hahn <hahn@univention.de>  Tue, 05 Feb 2019 11:28:59 +0100\n\nunivention-directory-notifier (12.0.1-3) unstable; urgency=medium\n\n  * Bug #41262: Include new script univention-replicate-many\n\n -- Jannik Ahlers <ahlers@univention.de>  Wed, 30 Jan 2019 12:16:25 +0100\n\nunivention-directory-notifier (12.0.1-2) unstable; urgency=medium\n\n  * Bug #46312: increase runsv timeout to 30 seconds\n\n -- J\u00fcrn Brodersen <brodersen@univention.de>  Wed, 21 Feb 2018 15:16:46 +0100\n\nunivention-directory-notifier (12.0.1-1) unstable; urgency=medium\n\n  * Use service instead of invoke-rc.d since systemd policy layer\n    prevents starting services in a chroot environment (Bug #45905)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 19 Dec 2017 22:18:04 +0100\n\nunivention-directory-notifier (12.0.0-1) unstable; urgency=medium\n\n  * Bug #45841: UCS-4.3 version bump\n\n -- J\u00fcrn Brodersen <brodersen@univention.de>  Mon, 11 Dec 2017 14:40:23 +0100\n\nunivention-directory-notifier (11.0.0-4) unstable; urgency=low\n\n  * Bug #43470: Revert ucs-4.2-0@77762\n\n -- Philipp Hahn <hahn@univention.de>  Thu, 16 Mar 2017 06:00:07 +0100\n\nunivention-directory-notifier (11.0.0-3) unstable; urgency=low\n\n  * Bug #43470: Handle UCRV */autostart through systemd\n\n -- Philipp Hahn <hahn@univention.de>  Wed, 15 Mar 2017 08:52:56 +0100\n\nunivention-directory-notifier (11.0.0-2) unstable; urgency=low\n\n  * Bug #38438: Fix message printing in init-script\n\n -- Philipp Hahn <hahn@univention.de>  Tue, 13 Sep 2016 09:58:29 +0200\n\nunivention-directory-notifier (11.0.0-1) unstable; urgency=medium\n\n  * Bug #41963: UCS-4.2 version bump\n  * Bug #38438: Make init-script LSB compliant\n\n -- Philipp Hahn <hahn@univention.de>  Fri, 12 Aug 2016 13:56:27 +0200\n\nunivention-directory-notifier (10.0.1-1) unstable; urgency=medium\n\n  * Bump version for UCS 4.1 (Bug #39729)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 03 Nov 2015 22:12:06 +0100\n\nunivention-directory-notifier (9.0.3-2) unstable; urgency=low\n\n  * Bug #36532: Speed up network re-config\n\n -- Philipp Hahn <hahn@univention.de>  Thu, 22 Jan 2015 11:24:47 +0100\n\nunivention-directory-notifier (9.0.3-1) unstable; urgency=medium\n\n  * Wait for the notifier start in 15univention-directory-notifier-\n    post.inst (Bug #35723)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 09 Sep 2014 20:37:17 +0200\n\nunivention-directory-notifier (9.0.2-2) unstable; urgency=medium\n\n  * Fix typo in 15univention-directory-notifier-post.inst (Bug #35723)\n\n -- Arvid Requate <requate@univention.de>  Tue, 09 Sep 2014 17:57:43 +0200\n\nunivention-directory-notifier (9.0.2-1) unstable; urgency=medium\n\n  * Changed quoting in 15univention-directory-notifier-post.inst\n    (Bug #35723)\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 08 Sep 2014 21:49:28 +0200\n\nunivention-directory-notifier (9.0.1-2) unstable; urgency=low\n\n  * Fix quoting in previous change (Bug #35723)\n\n -- Arvid Requate <requate@univention.de>  Mon, 08 Sep 2014 15:17:56 +0200\n\nunivention-directory-notifier (9.0.1-1) unstable; urgency=low\n\n  * The notifier join script now waits for the first initialization of\n    the listener on a DC master. This avoids a race condition during the\n    DC master installation (Bug #35723)\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 29 Aug 2014 16:10:12 +0200\n\nunivention-directory-notifier (9.0.0-1) unstable; urgency=low\n\n  * Update to UCS 4.0 (Bug #35144) \n\n -- Felix Botner <botner@univention.de>  Tue, 19 Aug 2014 10:07:51 +0200\n\nunivention-directory-notifier (8.0.0-2) unstable; urgency=low\n\n  * Update/review UCR variable descriptions (Bug #30946)\n\n -- Moritz M\u00fchlenhoff <muehlenhoff@univention.de>  Tue, 24 Sep 2013 09:07:25 +0200\n\nunivention-directory-notifier (8.0.0-1) unstable; urgency=low\n\n  * Bump version for UCS 3.2, update copyright years for 2013\n  * Update/review UCR variable descriptions (Bug #30946)\n\n -- Moritz M\u00fchlenhoff <muehlenhoff@univention.de>  Wed, 11 Sep 2013 12:00:14 +0200\n\nunivention-directory-notifier (7.0.8-4) unstable; urgency=low\n\n  * fix permissions for the script (Bug #30408) \n\n -- Arvid Requate <requate@univention.de>  Wed, 13 Feb 2013 12:06:20 +0100\n\nunivention-directory-notifier (7.0.8-3) unstable; urgency=low\n\n  * rename etc/network/if-post-down.d/appliance-notifier (Bug #30412)\n\n -- Arvid Requate <requate@univention.de>  Wed, 13 Feb 2013 12:00:00 +0100\n\nunivention-directory-notifier (7.0.8-2) unstable; urgency=low\n\n  * rename etc/network/if-post-down.d/appliance-notifier (Bug #30412)\n  * fix permissions for the script\n\n -- Arvid Requate <requate@univention.de>  Wed, 13 Feb 2013 11:49:08 +0100\n\nunivention-directory-notifier (7.0.8-1) unstable; urgency=low\n\n  * Add etc/network/if-post-down.d/appliance-notifier (Bug #30412)\n\n -- Arvid Requate <requate@univention.de>  Wed, 13 Feb 2013 11:25:39 +0100\n\nunivention-directory-notifier (7.0.7-1) unstable; urgency=low\n\n  * univention-directory-notifier now uses the current joinscript-lib\n    (Bug #28993)\n\n -- Erik Damrose <damrose@univention.de>  Fri, 04 Jan 2013 09:07:24 +0100\n\nunivention-directory-notifier (7.0.6-3) unstable; urgency=low\n\n  * Add linking exception for OpenSSL (Bug #26440)\n\n -- Moritz M\u00fchlenhoff <muehlenhoffunivention.de>  Tue, 02 Oct 2012 13:57:32 +0200\n\nunivention-directory-notifier (7.0.6-2) unstable; urgency=low\n\n  * univention-replicate-one: more minor fixes (Bug #27625)\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 17 Sep 2012 15:17:24 +0200\n\nunivention-directory-notifier (7.0.6-1) unstable; urgency=low\n\n  * Cleanups for univention-replicate-one (Bug #27625):\n    - Print error messages on stderr\n    - Call init script directly instead of using invoke-rc.d\n    - Cleanup messages\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 17 Sep 2012 07:20:57 +0200\n\nunivention-directory-notifier (7.0.5-2) unstable; urgency=low\n\n  * Include shell lib before using is_ucr_true (Bug #28361)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 11 Sep 2012 07:48:41 +0200\n\nunivention-directory-notifier (7.0.5-1) unstable; urgency=low\n\n  * Ensure the NSS group cache is up to date (Bug #28361)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 11 Sep 2012 06:48:01 +0200\n\nunivention-directory-notifier (7.0.4-2) unstable; urgency=low\n\n  * Fix atomic locking (Bug #28417)\n\n -- Philipp Hahn <hahn@univention.de>  Wed, 05 Sep 2012 13:07:53 +0200\n\nunivention-directory-notifier (7.0.4-1) unstable; urgency=low\n\n  * Drop LDAP dependencies.\n  * Fix atomic locking (Bug #27330)\n\n -- Philipp Hahn <hahn@univention.de>  Wed, 05 Sep 2012 07:19:15 +0200\n\nunivention-directory-notifier (7.0.3-1) unstable; urgency=low\n\n  * Write changes to /var/lib/univention-ldap/listener/listener instead\n    of /var/lib/univention-ldap/notify/transaction (Bug #27625)\n  * Stop slapd while adding a DN to the listener/listener file\n    (Bug #27625)\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 30 Aug 2012 08:28:13 +0200\n\nunivention-directory-notifier (7.0.2-1) unstable; urgency=low\n\n  * Added univention-replicate-one to replicate one DN (Bug #27625)\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 30 Aug 2012 07:32:24 +0200\n\nunivention-directory-notifier (7.0.1-1) unstable; urgency=low\n\n  * Donwgrade the debug level for an info message from WARNING to INFO\n    (Bug #26916)\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 30 Aug 2012 06:57:24 +0200\n\nunivention-directory-notifier (7.0.0-1) unstable; urgency=low\n\n  * UCS-3.1 version bump.\n  * Add UCR variable descriptions (Bug #28134)\n  * Remove setting unsued UCR variable:\n    - listener/supply/notifier?yes\n\n -- Philipp Hahn <hahn@univention.de>  Thu, 02 Aug 2012 12:54:46 +0200\n\nunivention-directory-notifier (6.0.8-2) unstable; urgency=low\n\n  * src/network.c: Notifier opened socket only with AF_INET6\n    and failed if IPv6 was not available. Added some code that\n    first tries opening with AF_INET6 and (if that fails) tries\n    to open with AF_INET (Bug #26469).\n\n -- Juergen Kahrs <Kahrs@univention.de>  Mon, 11 Jun 2012 11:25:06 +0200\n\nunivention-directory-notifier (6.0.8-1) unstable; urgency=low\n\n  * Restart notifier on update to 3.0 (Bug #24472)\n\n -- Stefan Gohmann <gohmann@univention.de>  Wed, 09 Nov 2011 14:33:07 +0100\n\nunivention-directory-notifier (6.0.7-1) unstable; urgency=low\n\n  * open AF_INET6 socket (can handle IPv6 and IPv4 connections) (Bug #24284)\n\n -- S\u00f6nke Schwardt-Krummrich <schwardt@univention.de>  Tue, 01 Nov 2011 14:41:28 +0100\n\nunivention-directory-notifier (6.0.6-3) unstable; urgency=low\n\n  * Fix dependencies on u-c (Bug #22668)\n\n -- Philipp Hahn <hahn@univention.de>  Sat, 22 Oct 2011 04:11:19 +0200\n\nunivention-directory-notifier (6.0.6-2) unstable; urgency=low\n\n  * updated postinst (Bug #23577)\n\n -- S\u00f6nke Schwardt-Krummrich <schwardt@univention.de>  Wed, 19 Oct 2011 17:57:25 +0200\n\nunivention-directory-notifier (6.0.6-1) unstable; urgency=low\n\n  * added firewall settings (Bug #23577)\n\n -- S\u00f6nke Schwardt-Krummrich <schwardt@univention.de>  Tue, 18 Oct 2011 15:16:50 +0200\n\nunivention-directory-notifier (6.0.5-2) unstable; urgency=low\n\n  * added logrotate template (Bug #18002)\n\n -- Felix Botner <botner@univention.de>  Wed, 12 Oct 2011 09:16:38 +0200\n\nunivention-directory-notifier (6.0.5-1) unstable; urgency=low\n\n  * added logrotate configuration (Bug #18002)\n\n -- Felix Botner <botner@univention.de>  Wed, 12 Oct 2011 09:13:04 +0200\n\nunivention-directory-notifier (6.0.4-1) unstable; urgency=low\n\n  * Restart listener and notifier in 15univention-directory-notifier-post.inst\n    (Bug #23826)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 27 Sep 2011 12:19:02 +0200\n\nunivention-directory-notifier (6.0.3-1) unstable; urgency=low\n\n  * Fixed bashisms (Bug #22431)\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 29 Jul 2011 07:03:32 +0200\n\nunivention-directory-notifier (6.0.2-1) unstable; urgency=low\n\n  * Fixed typo in last commit: Added dependency to shell-univention-lib\n    > 1.0.6 (Bug #22431)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 07 Jun 2011 15:36:15 +0200\n\nunivention-directory-notifier (6.0.1-1) unstable; urgency=low\n\n  * Added dependency to shell-univention-lib > 1.0.6 (Bug #22431)\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 07 Jun 2011 09:56:14 +0200\n\nunivention-directory-notifier (6.0.0-2) unstable; urgency=low\n\n  * Added copyright block to conffiles/etc/runit/univention-directory-\n    notifier/run (Bug #22431)\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 16 May 2011 16:52:31 +0200\n\nunivention-directory-notifier (6.0.0-1) unstable; urgency=low\n\n  * Package cleanup for UCS 3.0 (Bug #22431)\n    * Bump version for UCS 3.0\n    * Replace univention-baseconfig with univention-config-registry\n    * Replace static UCR header in the UCR templates with '@%@UCRWARNING=#\n      @%@'\n    * Update copyright to 2011\n    * Update to debhelper 7\n    * Removed transition package univention-ldap-notifier\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 09 May 2011 08:47:14 +0200\n\nunivention-directory-notifier (5.0.0-1) unstable; urgency=low\n\n  * convert to GNU APGL V3 (Bug #17543)\n  * bump version for UCS 2.4\n\n -- Janek Walkenhorst <walkenhorst@univention.de>  Tue, 22 Jun 2010 13:39:03 +0200\n\nunivention-directory-notifier (4.0.0-3) unstable; urgency=low\n\n  * changed predependency to simple dependency (Bug: #15971)\n\n -- S\u00f6nke Schwardt <schwardt@univention.de>  Wed, 14 Oct 2009 16:43:29 +0200\n\nunivention-directory-notifier (4.0.0-2) unstable; urgency=low\n\n  * less verbose debug messages (Bug: #13226)\n\n -- Felix Botner <botner@univention.de>  Tue, 29 Sep 2009 11:08:36 +0200\n\nunivention-directory-notifier (4.0.0-1) unstable; urgency=low\n\n  * Make init script LSB-compliant (Bug #14421)\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue,  2 Jun 2009 17:05:24 +0200\n\nunivention-directory-notifier (3.0.1-3) unstable; urgency=low\n\n  * updated the copyright. Bug #6875\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 12 Mar 2009 13:47:36 +0100\n\nunivention-directory-notifier (3.0.1-2) unstable; urgency=low\n\n  * updated the copyright. Bug #6875\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 19 Feb 2009 08:55:57 +0100\n\nunivention-directory-notifier (3.0.1-1) unstable; urgency=low\n\n  * don't stop the notifier in the preinst. Bug #13065\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 10 Feb 2009 07:45:49 +0100\n\nunivention-directory-notifier (2.2.2-6) unstable; urgency=low\n\n  * Added UCR Warning.\n\n -- Andre Fenske <fenske@univention.de>  Thu,  4 Dec 2008 13:16:40 +0100\n\nunivention-directory-notifier (2.2.2-5) unstable; urgency=low\n\n  * new autostart test in init script\n\n -- Felix Botner <fbotner@visdalen.knut.univention.de>  Tue, 28 Oct 2008 14:51:00 +0100\n\nunivention-directory-notifier (2.2.2-4) unstable; urgency=low\n\n  * call the join script in the postinst\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 25 Oct 2007 08:26:34 +0200\n\nunivention-directory-notifier (2.2.2-3) unstable; urgency=low\n\n  * check if /etc/runit/univention/univention-ldap-notifier is a\n    symbolic link and replace the link with\n    /etc/runit/univention/univention-directory-notifier\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 18 Oct 2007 17:12:51 +0200\n\nunivention-directory-notifier (2.2.2-2) unstable; urgency=low\n\n  * remove old ldap-notifier init script\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 11 Oct 2007 07:56:59 +0200\n\nunivention-directory-notifier (2.2.2-1) unstable; urgency=low\n\n  * fixed logfile permissions\n\n -- S\u00f6nke Schwardt <schwardt@univention.de>  Thu, 27 Sep 2007 14:33:09 +0200\n\nunivention-directory-notifier (2.2.1-3) unstable; urgency=low\n\n  * added conflict to the old transition package\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 20 Sep 2007 08:23:28 +0200\n\nunivention-directory-notifier (2.2.1-2) unstable; urgency=low\n\n  * added univention-ldap-notifier transition package\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 14 Sep 2007 11:56:37 +0200\n\nunivention-directory-notifier (2.2.1-1) unstable; urgency=low\n\n  * more wording stuff\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 31 Aug 2007 08:03:17 +0200\n\nunivention-directory-notifier (2.1.1-10) unstable; urgency=low\n\n  * added permission fix of transaction file in additional join script\n\n -- S\u00f6nke Schwardt <schwardt@univention.de>  Thu, 23 Aug 2007 10:02:05 +0200\n\nunivention-directory-notifier (2.1.1-9) unstable; urgency=low\n\n  * Fixed two typos in postinst\n\n -- S\u00f6nke Schwardt <schwardt@univention.de>  Wed, 22 Aug 2007 13:15:25 +0200\n\nunivention-directory-notifier (2.1.1-8) unstable; urgency=low\n\n  * Drop symlink test, as the files in /etc/runit/univention are always\n    created as symlinks\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 14 Aug 2007 14:43:46 +0200\n\nunivention-directory-notifier (2.1.1-7) unstable; urgency=low\n\n  * Fix directory name\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 14 Aug 2007 10:51:46 +0200\n\nunivention-directory-notifier (2.1.1-6) unstable; urgency=low\n\n  * Add transition code for wording changes\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 14 Aug 2007 09:49:27 +0200\n\nunivention-directory-notifier (2.1.1-5) unstable; urgency=low\n\n  * Fixed permissions of transaction file\n\n -- S\u00f6nke Schwardt <schwardt@univention.de>  Mon, 13 Aug 2007 17:11:01 +0200\n\nunivention-directory-notifier (2.1.1-4) unstable; urgency=low\n\n  * Update service definition\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Wed,  8 Aug 2007 14:41:14 +0200\n\nunivention-directory-notifier (2.1.1-3) unstable; urgency=low\n\n  * Fix join script.\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Thu,  2 Aug 2007 16:15:44 +0200\n\nunivention-directory-notifier (2.1.1-2) unstable; urgency=low\n\n  * Rename join script\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Thu,  2 Aug 2007 12:51:04 +0200\n\nunivention-directory-notifier (2.1.1-1) unstable; urgency=low\n\n  * add version number to join script\n\n -- Andreas B\u00fcsching <buesching@univention.de>  Thu,  2 Aug 2007 09:26:45 +0200\n\nunivention-directory-notifier (2.1.0-4) unstable; urgency=low\n\n  * More wording changes\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 31 Jul 2007 14:15:51 +0200\n\nunivention-directory-notifier (2.1.0-3) unstable; urgency=low\n\n  * Fix Makefile error\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 31 Jul 2007 14:04:10 +0200\n\nunivention-directory-notifier (2.1.0-2) unstable; urgency=low\n\n  * Fix wording-related build failure.\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 31 Jul 2007 12:48:19 +0200\n\nunivention-directory-notifier (2.1.0-1) unstable; urgency=low\n\n  * Rename to Univention Directory Notifier\n\n -- Moritz Muehlenhoff <muehlenhoff@univention.de>  Tue, 31 Jul 2007 11:37:57 +0200\n\nunivention-ldap-notifier (2.0.4-3) unstable; urgency=low\n\n  * add service description\n  * add Configuration Registry variable notifier/autostart to set start type\n\n -- Andreas B\u00fcsching <buesching@univention.de>  Wed, 25 Jul 2007 11:07:57 +0200\n\nunivention-ldap-notifier (2.0.4-2) unstable; urgency=low\n\n  * create join script\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 18 Jun 2007 19:44:54 +0200\n\nunivention-ldap-notifier (2.0.3-1) unstable; urgency=low\n\n  * only try to start the daemon if the runsv link exists\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 18 Jun 2007 16:17:55 +0200\n\nunivention-ldap-notifier (2.0.2-2) unstable; urgency=low\n\n  * encoded files utf-8\n\n -- Janis Meybohm <meybohm@univention.de>  Wed, 13 Jun 2007 15:29:34 +0200\n\nunivention-ldap-notifier (2.0.2-1) unstable; urgency=low\n\n  * switch from runsvctrl to sv\n\n -- Stefan Gohmann <gohmann@univention.de>  Wed, 13 Jun 2007 13:18:26 +0200\n\nunivention-ldap-notifier (2.0.1-1) unstable; urgency=low\n\n  * the notifier doesn't need to wait for the replog file because now the a\n    ldap overlay module writes the transaction file.\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 14 May 2007 13:15:55 +0200\n\nunivention-ldap-notifier (2.0.0-1) unstable; urgency=low\n\n  * update to ucs 2.0 policies\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 14 May 2007 11:55:08 +0200\n\nunivention-ldap-notifier (1.14) unstable; urgency=low\n\n  * add GPL headers\n  * code cleanup\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 27 Nov 2006 14:29:47 +0100\n\nunivention-ldap-notifier (1.12) unstable; urgency=low\n\n  * check for empty transaction file on powerpc architecture\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 17 Feb 2006 16:17:30 +0100\n\nunivention-ldap-notifier (1.10) unstable; urgency=low\n\n  * update to UCS 1.3\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon,  5 Dec 2005 13:42:15 +0100\n\nunivention-ldap-notifier (1.9) unstable; urgency=low\n\n  * evaluate notifier/replog/sleep on Notifier Slave System\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu,  2 Jun 2005 14:06:24 +0200\n\nunivention-ldap-notifier (1.7) unstable; urgency=low\n\n  * support modrdn\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue,  3 May 2005 14:05:02 +0200\n\nunivention-ldap-notifier (1.6) unstable; urgency=low\n\n  * added baseconfig var for usleep replog pasrsing\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 21 Mar 2005 20:46:11 +0100\n\nunivention-ldap-notifier (1.5) unstable; urgency=low\n\n  * set listener baseconfig var listener/supply/notifier\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 18 Mar 2005 12:59:18 +0100\n\nunivention-ldap-notifier (1.4) unstable; urgency=low\n\n  * support for move ldap objects\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 21 Jan 2005 16:47:25 +0100\n\nunivention-ldap-notifier (1.3) unstable; urgency=low\n\n  * sleep 0,5 seconds before reading the replog file\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 14 Jan 2005 14:14:56 +0100\n\nunivention-ldap-notifier (1.2) unstable; urgency=low\n\n  * fixed schema id bug\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 23 Dec 2004 07:46:23 +0100\n\nunivention-ldap-notifier (1.1) unstable; urgency=low\n\n  * use semaphore for critical sections\n  * open socket before parsing replog (so that we don't parse the\n    replog before realizing that another notifier is already running)\n\n -- Stefan Gohmann <gohmann@univention.de>  Fri, 18 Jun 2004 12:56:23 +0200\n\nunivention-ldap-notifier (1.0) unstable; urgency=low\n\n  * Add an ID index for the transaction file; this speeds up\n    requests significantly.\n\n -- Roland Bauerschmidt <bauerschmidt@univention.de>  Thu, 10 Jun 2004 15:20:49 +0200\n\nunivention-ldap-notifier (0.06) unstable; urgency=low\n\n  * new protocol v2\n  * support for schema replication\n  * internal cache added\n  * add proper package description\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon, 26 Apr 2004 16:23:43 +0200\n\nunivention-ldap-notifier (0.05) unstable; urgency=low\n\n  * waiting for lock file\n\n -- Stefan Gohmann <gohmann@univention.de>  Wed, 10 Mar 2004 17:56:52 +0100\n\nunivention-ldap-notifier (0.04) unstable; urgency=low\n\n  * write slurpd replog file (bugfix)\n\n -- Stefan Gohmann <gohmann@univention.de>  Mon,  8 Mar 2004 17:03:19 +0100\n\nunivention-ldap-notifier (0.03) unstable; urgency=low\n\n  * increment last id\n  * restart notifier on update\n  * don't send notifications to all listener if one listener ask\n\n -- Stefan Gohmann <gohmann@univention.de>  Thu, 19 Feb 2004 08:30:20 +0100\n\nunivention-ldap-notifier (0.02) unstable; urgency=low\n\n  * added init.d start script\n\n -- Stefan Gohmann <gohmann@univention.de>  Sat, 14 Feb 2004 14:13:43 +0100\n\nunivention-ldap-notifier (0.01) unstable; urgency=low\n\n  * Initial release.\n\n -- Stefan Gohmann <gohmann@univention.de>  Tue, 11 Sep 2003 13:03:44 +0200\n", "/*\n * Univention Directory Notifier\n *\n * Copyright 2004-2019 Univention GmbH\n *\n * http://www.univention.de/\n *\n * All rights reserved.\n *\n * The source code of this program is made available\n * under the terms of the GNU Affero General Public License version 3\n * (GNU AGPL V3) as published by the Free Software Foundation.\n *\n * Binary versions of this program provided by Univention to you as\n * well as other copyrighted, protected or trademarked materials like\n * Logos, graphics, fonts, specific documentations and configurations,\n * cryptographic keys etc. are subject to a license agreement between\n * you and Univention and not subject to the GNU AGPL V3.\n *\n * In the case you use this program under the terms of the GNU AGPL V3,\n * the program is provided in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public\n * License with the Debian GNU/Linux or Univention distribution in file\n * /usr/share/common-licenses/AGPL-3; if not, see\n * <http://www.gnu.org/licenses/>.\n */\n\n#define __USE_GNU\n\n#include <sys/types.h>\n#include <sys/socket.h>\n#include <stdio.h>\n#include <netinet/in.h>\n#include <sys/time.h>\n#include <sys/ioctl.h>\n#include <sys/un.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <string.h>\n#include <limits.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <stdint.h>\n\n#include <univention/debug.h>\n\n#include \"notify.h\"\n#include \"network.h\"\n#include \"cache.h\"\n#include \"sem.h\"\n\nextern int sem_id;\n\nextern fd_set readfds;\n\nextern NotifyId_t notify_last_id;\n\nextern unsigned long SCHEMA_ID;\n\n\n/* read one line from network packages*/\n\nint get_network_line(char *packet, char *network_line)\n{\n\tint i=0;\n\n\tmemset(network_line, 0, 8192);\n\n\twhile ( packet[i] != '\\0' && packet[i] != '\\n' ) {\n\n\t\tnetwork_line[i]=packet[i];\n\t\ti+=1;\n\t}\n\n\tif ( packet[i] == '\\0' ) {\n\t\treturn 0;\n\t}\n\n\tif ( i == 0 ) {\n\t\tnetwork_line[i]='\\0';\n\t}\n\n\tnetwork_line[i+1]='\\0';\n\n\treturn 1;\n}\n\nint data_on_connection(int fd, callback_remove_handler remove)\n{\n\tint nread;\n\tchar *network_packet;\n\tchar network_line[8192];\n\tchar *p;\n\tunsigned long id;\n\n\tchar string[1024];\n\tunsigned long msg_id = UINT32_MAX;\n\tenum network_protocol version = network_client_get_version(fd);\n\n\tioctl(fd, FIONREAD, &nread);\n\n\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"new connection data = %d\\n\",nread);\n\n\tif(nread == 0)\n\t{\n\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_PROCESS, \"%d failed, got 0 close connection to listener \", fd);\n\t\tclose(fd);\n\t\tFD_CLR(fd, &readfds);\n\t\tremove(fd);\n\t\tnetwork_client_dump ();\n\t\treturn 0;\n\t}\n\n\n\tif ( nread >= 8192 ) {\n\n\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ERROR, \"%d failed, more than 8192 close connection to listener \", fd);\n\t\tclose(fd);\n\t\tFD_CLR(fd, &readfds);\n\t\tremove(fd);\n\n\t\treturn 0;\n\t}\n\n\t/* read the whole package */\n\tnetwork_packet=malloc((nread+1) * sizeof(char));\n\tread(fd, network_packet, nread);\n\tnetwork_packet[nread]='\\0';\n\n\tmemset(network_line, 0, 8192);\n\tp=network_packet;\n\tp_sem(sem_id);\n\n\twhile ( get_network_line(p, network_line) ) {\n\n\t\tif ( strlen(network_line) > 0 ) {\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"line = [%s]\",network_line);\n\t\t}\n\n\t\t\n\t\tif ( !strncmp(network_line, \"MSGID: \", strlen(\"MSGID: \")) ) {\n\t\t\t/* read message id  */\n\n\t\t\tmsg_id=strtoul(&(network_line[strlen(\"MSGID: \")]), NULL, 10);\n\n\t\t\tp+=strlen(network_line);\n\n\n\t\t} else if ( !strncmp(network_line, \"Version: \", strlen(\"Version: \")) ) {\n\t\t\tchar *head = network_line, *end;\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: VERSION\");\n\n\t\t\tversion = strtoul(head + 9, &end, 10);\n\t\t\tif (!head[9] || *end)\n\t\t\t\tgoto failed;\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"VERSION=%d\", version);\n\n\t\t\tif (version < network_procotol_version) {\n\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_PROCESS, \"Forbidden VERSION=%d < %d, close connection to listener\", version, network_procotol_version);\n\t\t\t\tgoto close;\n\t\t\t} else if (version >= PROTOCOL_LAST) {\n\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_PROCESS, \"Future VERSION=%d\", version);\n\t\t\t\tversion = PROTOCOL_LAST - 1;\n\t\t\t}\n\t\t\tnetwork_client_set_version(fd, version);\n\t\t\t\n\t\t\t/* reset message id */\n\t\t\tmsg_id = UINT32_MAX;\n\n\t\t\tp+=strlen(network_line);\n\n\n\t\t} else if ( !strncmp(network_line, \"Capabilities: \", strlen(\"Capabilities: \")) ) {\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: Capabilities\");\n\n\t\t\tif ( version > PROTOCOL_UNKNOWN ) {\n\n\t\t\t\tmemset(string, 0, sizeof(string));\n\t\t\t\t\n\t\t\t\tsnprintf(string, sizeof(string), \"Version: %d\\nCapabilities: \\n\\n\", version);\n\n\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"SEND: %s\", string);\n\n\t\t\t\twrite(fd, string, strlen(string));\n\n\t\t\t} else {\n\t\t\t\t\n\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"Capabilities recv, but no version line\");\n\t\t\t\t\n\t\t\t}\n\n\t\t\tp+=strlen(network_line);\n\n\n\t\t} else if ( !strncmp(network_line, \"GET_DN \", strlen(\"GET_DN \")) && msg_id != UINT32_MAX && version > PROTOCOL_UNKNOWN && version < PROTOCOL_3) {\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: GET_DN\");\n\n\t\t\tid=strtoul(&(network_line[strlen(\"GET_DN \")]), NULL, 10);\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"id: %ld\",id);\n\n\t\t\tif ( id <= notify_last_id.id) {\n\n\t\t\t\tchar *dn_string = NULL;\n\n\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"try to read %ld from cache\", id);\n\n\t\t\t\t/* try to read from cache */\n\t\t\t\tif ( (dn_string = notifier_cache_get(id)) == NULL ) {\n\n\t\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"%ld not found in cache\", id);\n\n\t\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"%ld get one dn\", id);\n\n\t\t\t\t\t/* read from transaction file, because not in cache */\n\t\t\t\t\tif( (dn_string=notify_transcation_get_one_dn ( id )) == NULL ) {\n\n\t\t\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"%ld failed \", id);\n\t\t\t\t\t\t/* TODO: maybe close connection? */\n\n\t\t\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ERROR, \"%d failed, close connection to listener \", fd);\n\t\t\t\t\t\tclose(fd);\n\t\t\t\t\t\tFD_CLR(fd, &readfds);\n\t\t\t\t\t\tremove(fd);\n\n\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif ( dn_string != NULL ) {\n\n\t\t\t\t\tsnprintf(string, sizeof(string), \"MSGID: %ld\\n%s\\n\\n\",msg_id,dn_string);\n\n\t\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"--> %d: [%s]\",fd, string);\n\n\t\t\t\t\twrite(fd, string, strlen(string));\n\n\t\t\t\t\tfree(dn_string);\n\n\t\t\t\t}\n\n\n\t\t\t} else {\n\t\t\t\t/* set wanted id */\n\n\t\t\t\tnetwork_client_set_next_id(fd, id);\n\t\t\t\tnetwork_client_set_msg_id(fd, msg_id);\n\n\t\t\t}\n\n\t\t\tp+=strlen(network_line)+1;\n\t\t\tmsg_id = UINT32_MAX;\n\n\t\t} else if (!strncmp(p, \"WAIT_ID \", 8) && msg_id != UINT32_MAX && version >= PROTOCOL_3) {\n\t\t\tchar *head = network_line, *end;\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: WAIT_ID\");\n\t\t\tid = strtoul(head + 8, &end, 10);\n\t\t\tif (!head[8] || *end)\n\t\t\t\tgoto failed;\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"id: %ld\", id);\n\n\t\t\tif (id <= notify_last_id.id) {\n\t\t\t\tsnprintf(string, sizeof(string), \"MSGID: %ld\\n%ld\\n\\n\", msg_id, notify_last_id.id);\n\t\t\t\twrite(fd, string, strlen(string));\n\t\t\t} else {\n\t\t\t\t/* set wanted id */\n\t\t\t\tnetwork_client_set_next_id(fd, id);\n\t\t\t\tnetwork_client_set_msg_id(fd, msg_id);\n\t\t\t}\n\n\t\t\tp += strlen(network_line) + 1;\n\t\t\tmsg_id = UINT32_MAX;\n\n\t\t} else if ( !strncmp(network_line, \"GET_ID\", strlen(\"GET_ID\")) && msg_id != UINT32_MAX  && network_client_get_version(fd) > 0) {\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: GET_ID\");\n\n\t\t\tmemset(string, 0, sizeof(string));\n\n\t\t\tsnprintf(string, sizeof(string), \"MSGID: %ld\\n%ld\\n\\n\",msg_id,notify_last_id.id);\n\n\t\t\twrite(fd, string, strlen(string));\n\n\t\t\tp+=strlen(network_line)+1;\n\t\t\tmsg_id = UINT32_MAX;\n\n\n\t\t} else if ( !strncmp(network_line, \"GET_SCHEMA_ID\", strlen(\"GET_SCHEMA_ID\")) && msg_id != UINT32_MAX  && network_client_get_version(fd) > 0) {\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: GET_SCHEMA_ID\");\n\n\t\t\tmemset(string, 0, sizeof(string));\n\n\t\t\tsnprintf(string, sizeof(string), \"MSGID: %ld\\n%ld\\n\\n\",msg_id,SCHEMA_ID);\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"--> %d: [%s]\",fd, string);\n\n\t\t\twrite(fd, string, strlen(string));\n\n\t\t\tp+=strlen(network_line)+1;\n\t\t\tmsg_id = UINT32_MAX;\n\n\n\t\t} else if ( !strncmp(network_line, \"ALIVE\", strlen(\"ALIVE\")) && msg_id != UINT32_MAX  && network_client_get_version(fd) > 0) {\n\n\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"RECV: ALIVE\");\n\n\t\t\tsnprintf(string, sizeof(string), \"MSGID: %ld\\nOKAY\\n\\n\",msg_id);\n\n\t\t\twrite(fd, string, strlen(string));\n\n\t\t\tp+=strlen(network_line)+1;\n\t\t\tmsg_id = UINT32_MAX;\n\n\t\t} else {\n\n\t\t\tp+=strlen(network_line);\n\n\t\t\tif (strlen(network_line) == 0 ) {\n\t\t\t\tp+=1;\n \t\t\t} else {\n\t\t\t\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ERROR, \"Drop package [%s]\", network_line);\n\t\t\t}\n\n\t\t}\n\t}\n\tv_sem(sem_id);\n\n\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_ALL, \"END Package\");\n\t\n\n\tnetwork_client_dump ();\n\n\treturn 0;\n\nfailed:\n\tunivention_debug(UV_DEBUG_TRANSFILE, UV_DEBUG_PROCESS, \"Failed parsing [%s]\", p);\nclose:\n\tclose(fd);\n\tFD_CLR(fd, &readfds);\n\tremove(fd);\n\treturn 0;\n}\n\n"], "filenames": ["management/univention-directory-notifier/debian/changelog", "management/univention-directory-notifier/src/callback.c"], "buggy_code_start_loc": [0, 202], "buggy_code_end_loc": [0, 203], "fixing_code_start_loc": [1, 202], "fixing_code_end_loc": [7, 203], "type": "CWE-200", "message": "Univention Corporate Server univention-directory-notifier 12.0.1-3 and earlier is affected by: CWE-213: Intentional Information Exposure. The impact is: Loss of Confidentiality. The component is: function data_on_connection() in src/callback.c. The attack vector is: network connectivity. The fixed version is: 12.0.1-4 and later.", "other": {"cve": {"id": "CVE-2019-1010283", "sourceIdentifier": "josh@bress.net", "published": "2019-07-17T21:15:11.013", "lastModified": "2019-10-09T23:44:18.820", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "Univention Corporate Server univention-directory-notifier 12.0.1-3 and earlier is affected by: CWE-213: Intentional Information Exposure. The impact is: Loss of Confidentiality. The component is: function data_on_connection() in src/callback.c. The attack vector is: network connectivity. The fixed version is: 12.0.1-4 and later."}, {"lang": "es", "value": "univention-directory-notifier versi\u00f3n 12.0.1-3 y anteriores de Univention Corporate Server, est\u00e1 afectada por: CWE-213: Exposici\u00f3n Intencional de Informaci\u00f3n. El impacto es: P\u00e9rdida de Confidencialidad. El componente es: funci\u00f3n data_on_connection() en el archivo src/callback.c. El vector de ataque es: conectividad de red. La versi\u00f3n corregida es: 12.0.1-4 y posteriores."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-200"}]}, {"source": "josh@bress.net", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-213"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:univention:univention_corporate_server:*:*:*:*:*:*:*:*", "versionEndIncluding": "12.0.1-3", "matchCriteriaId": "B90B497F-E2CC-400B-99E3-00EFB63A658A"}]}]}], "references": [{"url": "https://forge.univention.org/bugzilla/show_bug.cgi?id=48427", "source": "josh@bress.net", "tags": ["Exploit", "Issue Tracking", "Vendor Advisory"]}, {"url": "https://github.com/univention/univention-corporate-server/commit/a28053045bd2e778c50ed1acaf4e52e1e34f6e34", "source": "josh@bress.net", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/univention/univention-corporate-server/commit/a28053045bd2e778c50ed1acaf4e52e1e34f6e34"}}