{"buggy_code": ["<script type=\"text/javascript\">\nvar ws;\nvar ws_loc;\nvar logbody = $('.table tbody')\nvar query_string = '{{ query_string }}'\n\n$(document).ready(function() {\n\n    var get_ws_address = function() {\n        var loc = window.location;\n        if(loc.protocol === 'https:') {\n            var ws_proto = 'wss';\n        } else {\n            var ws_proto = 'ws';\n        }\n        var ws_loc = ws_proto + '://' + loc.hostname + ':5693/ws/tail';\n        return ws_loc;\n    }\n\n    var get_ws_args = function() {\n        var decoded = decodeURIComponent(query_string);\n        return decoded;\n    }\n\n    var get_ws_total = function() {\n        return get_ws_address() + '?' + get_ws_args();\n    }\n\n    var add_log = function(log) {\n        var tr = $('<tr>');\n        $('<td>', {text: log.time_generated}).appendTo(tr);\n        $('<td>', {text: log.application}).appendTo(tr);\n        $('<td>', {text: log.computer_name}).appendTo(tr);\n        $('<td>', {text: log.category}).appendTo(tr);\n        $('<td>', {text: log.severity}).appendTo(tr);\n        $('<td>', {text: log.event_id}).appendTo(tr);\n        $('<td>', {text: log.message}).appendTo(tr);\n\n        logbody.append(tr)\n    };\n\n    var start_websocket = function() {\n        ws_loc = get_ws_total();\n        ws = new WebSocket(ws_loc);\n\n        // Set up what to do when websocket receives data\n        ws.onmessage = function(d) {\n            if ($('.tbl-message').length > 0) {\n                $('.tbl-message').remove();\n            }\n\n            logs = $.parseJSON(d.data);\n            $.each(logs, function(i, log) {\n                add_log(log);\n            })\n        };\n\n        // Set websocket close on page change\n        window.onbeforeunload = function() {\n            ws.onclose = function () {};\n            ws.close()\n        };\n    };\n\n    start_websocket();\n\n    $('.btn-apply').click(function() {\n        var name = $('input[name=\"name\"]').val();\n        query_string = \"name=\" + name;\n        $('.name').html(name);\n\n        // Restart the websocket\n        ws.close();\n        logbody.html('<tr class=\"tbl-message\"><td colspan=\"7\">No logs have came in yet.</td></tr>');\n        start_websocket();\n    });\n\n    $('#log-name').keypress(function(e) {\n        if (e.which == 13) {\n            $('.btn-apply').trigger('click');\n        }\n    });\n\n});\n</script>\n\n<div id='top-container'>\n    <div class=\"well form-inline\">\n        <h1 class=\"fl\">Tail Event Logs</h1>\n        <div class=\"fl\" style=\"line-height: 30px; margin-right: 2.5rem;\">\n            <i class=\"fa fa-refresh fa-14 fa-l\"></i> Refreshing every 5 seconds\n        </div>\n        <div class=\"fl\" style=\"line-height: 30px;\">\n            <i class=\"fa fa-filter fa-14 fa-l\"></i> Filtered to <b class=\"name\">System</b> logs\n        </div>\n        <div class=\"fr\">\n            <div class=\"input-group\" style=\"width: 320px;\">\n                <div class=\"input-group-addon\">Event Log Name</div>\n                <input class=\"form-control\" id=\"log-name\" type=\"text\" name=\"name\" placeholder=\"System\">\n            </div>\n            <button type=\"button\" class=\"btn btn-sm btn-default btn-apply\"><i class=\"fa fa-exchange fa-l\"></i> Apply</button>\n        </div>\n        <div class=\"clear\"></div>\n    </div>\n</div>\n\n<div class=\"container-fluid\">\n    <div class=\"row\">\n        <div class=\"col-sm-12\">\n            <div style=\"padding: 0.25rem 0.75rem 3rem 0.75rem;\">\n                <table class=\"table table-striped table-bordered table-condensed\">\n                    <thead>\n                        <tr>\n                            <th>Date</th>\n                            <th>Application</th>\n                            <th>Hostname</th>\n                            <th>Category</th>\n                            <th>Severity</th>\n                            <th>Event ID</th>\n                            <th>Message</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr class=\"tbl-message\">\n                            <td colspan=\"7\">No logs have came in yet.</td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n</div>"], "fixing_code": ["<script type=\"text/javascript\">\nvar ws;\nvar ws_loc;\nvar logbody = $('.table tbody')\nvar query_string = '{{ query_string }}'\n\n$(document).ready(function() {\n\n    var get_ws_address = function() {\n        var loc = window.location;\n        if(loc.protocol === 'https:') {\n            var ws_proto = 'wss';\n        } else {\n            var ws_proto = 'ws';\n        }\n        var ws_loc = ws_proto + '://' + loc.hostname + ':5693/ws/tail';\n        return ws_loc;\n    }\n\n    var get_ws_args = function() {\n        var decoded = decodeURIComponent(query_string);\n        return decoded;\n    }\n\n    var get_ws_total = function() {\n        return get_ws_address() + '?' + get_ws_args();\n    }\n\n    var add_log = function(log) {\n        var tr = $('<tr>');\n        $('<td>', {text: log.time_generated}).appendTo(tr);\n        $('<td>', {text: log.application}).appendTo(tr);\n        $('<td>', {text: log.computer_name}).appendTo(tr);\n        $('<td>', {text: log.category}).appendTo(tr);\n        $('<td>', {text: log.severity}).appendTo(tr);\n        $('<td>', {text: log.event_id}).appendTo(tr);\n        $('<td>', {text: log.message}).appendTo(tr);\n\n        logbody.append(tr)\n    };\n\n    var start_websocket = function() {\n        ws_loc = get_ws_total();\n        ws = new WebSocket(ws_loc);\n\n        // Set up what to do when websocket receives data\n        ws.onmessage = function(d) {\n            if ($('.tbl-message').length > 0) {\n                $('.tbl-message').remove();\n            }\n\n            logs = $.parseJSON(d.data);\n            $.each(logs, function(i, log) {\n                add_log(log);\n            })\n        };\n\n        // Set websocket close on page change\n        window.onbeforeunload = function() {\n            ws.onclose = function () {};\n            ws.close()\n        };\n    };\n\n    start_websocket();\n\n    $('.btn-apply').click(function() {\n        var name = $('input[name=\"name\"]').val();\n        query_string = \"name=\" + name;\n        $('.name').text(name);\n\n        // Restart the websocket\n        ws.close();\n        logbody.html('<tr class=\"tbl-message\"><td colspan=\"7\">No logs have came in yet.</td></tr>');\n        start_websocket();\n    });\n\n    $('#log-name').keypress(function(e) {\n        if (e.which == 13) {\n            $('.btn-apply').trigger('click');\n        }\n    });\n\n});\n</script>\n\n<div id='top-container'>\n    <div class=\"well form-inline\">\n        <h1 class=\"fl\">Tail Event Logs</h1>\n        <div class=\"fl\" style=\"line-height: 30px; margin-right: 2.5rem;\">\n            <i class=\"fa fa-refresh fa-14 fa-l\"></i> Refreshing every 5 seconds\n        </div>\n        <div class=\"fl\" style=\"line-height: 30px;\">\n            <i class=\"fa fa-filter fa-14 fa-l\"></i> Filtered to <b class=\"name\">System</b> logs\n        </div>\n        <div class=\"fr\">\n            <div class=\"input-group\" style=\"width: 320px;\">\n                <div class=\"input-group-addon\">Event Log Name</div>\n                <input class=\"form-control\" id=\"log-name\" type=\"text\" name=\"name\" placeholder=\"System\">\n            </div>\n            <button type=\"button\" class=\"btn btn-sm btn-default btn-apply\"><i class=\"fa fa-exchange fa-l\"></i> Apply</button>\n        </div>\n        <div class=\"clear\"></div>\n    </div>\n</div>\n\n<div class=\"container-fluid\">\n    <div class=\"row\">\n        <div class=\"col-sm-12\">\n            <div style=\"padding: 0.25rem 0.75rem 3rem 0.75rem;\">\n                <table class=\"table table-striped table-bordered table-condensed\">\n                    <thead>\n                        <tr>\n                            <th>Date</th>\n                            <th>Application</th>\n                            <th>Hostname</th>\n                            <th>Category</th>\n                            <th>Severity</th>\n                            <th>Event ID</th>\n                            <th>Message</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr class=\"tbl-message\">\n                            <td colspan=\"7\">No logs have came in yet.</td>\n                        </tr>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n</div>"], "filenames": ["agent/listener/templates/tail.html"], "buggy_code_start_loc": [70], "buggy_code_end_loc": [71], "fixing_code_start_loc": [70], "fixing_code_end_loc": [71], "type": "CWE-79", "message": "A vulnerability classified as problematic was found in Nagios NCPA. This vulnerability affects unknown code of the file agent/listener/templates/tail.html. The manipulation of the argument name leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 2.4.0 is able to address this issue. The name of the patch is 5abbcd7aa26e0fc815e6b2b0ffe1c15ef3e8fab5. It is recommended to upgrade the affected component. VDB-216874 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2021-4285", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-27T11:15:10.480", "lastModified": "2023-01-06T06:01:10.007", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability classified as problematic was found in Nagios NCPA. This vulnerability affects unknown code of the file agent/listener/templates/tail.html. The manipulation of the argument name leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 2.4.0 is able to address this issue. The name of the patch is 5abbcd7aa26e0fc815e6b2b0ffe1c15ef3e8fab5. It is recommended to upgrade the affected component. VDB-216874 is the identifier assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:nagios:nagios_cross_platform_agent:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.4.0", "matchCriteriaId": "E69DEC17-2E27-4E85-9728-A0E837ECA3F3"}]}]}], "references": [{"url": "https://github.com/NagiosEnterprises/ncpa/commit/5abbcd7aa26e0fc815e6b2b0ffe1c15ef3e8fab5", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/NagiosEnterprises/ncpa/pull/834", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/NagiosEnterprises/ncpa/releases/tag/v2.4.0", "source": "cna@vuldb.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.216874", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.216874", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/NagiosEnterprises/ncpa/commit/5abbcd7aa26e0fc815e6b2b0ffe1c15ef3e8fab5"}}