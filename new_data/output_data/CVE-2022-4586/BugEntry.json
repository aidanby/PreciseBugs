{"buggy_code": ["{***************************************************************************\n * You can find the license in the docs directory\n ***************************************************************************}\n{* OCSTYLE *}\n\n{* JS for cache list description tooltips *}\n<script type=\"text/javascript\" src=\"resource2/{$opt.template.style}/js/wz_tooltip.js\"></script>\n\n    <div class=\"content2-pagetitle\">\n        <img src=\"resource2/{$opt.template.style}/images/misc/32x32-list.png\" style=\"margin-right: 10px;\" width=\"32\" height=\"32\" />\n        {t}Cache lists{/t}\n    </div>\n\n    {literal}\n    <script type=\"text/javascript\">\n    function resetfilter()\n    {\n        document.getElementById('name_filter').value = '';\n        document.getElementById('by_filter').value = '';\n        submitbutton('reset');\n    }\n    </script>\n    {/literal}\n\n    <div class=\"content2-container\">\n        <div class=\"floatbox\">\n            <form method=\"get\" action=\"cachelists.php\">\n                <table class=\"table\" >\n                    <tr>\n                        <td>{t}List name:{/t}</td>\n                        <td><input id=\"name_filter\" name=\"name\" value=\"{$name_filter}\" class=\"input170\" /></td>\n                    </tr>\n                    <tr>\n                        <td>{t}By:{/t}</td>\n                        <td><input id=\"by_filter\" name=\"by\" value=\"{$by_filter}\" class=\"input170\" /></td>\n                    </tr>\n                    <tr><td class=\"separator\"></td></tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align:right\">\n                            <input type=\"submit\" name=\"filter\" value=\"{t}Search{/t}\" class=\"formbutton\" onclick=\"submitbutton('filter')\" />&nbsp;\n                            <input type=\"submit\" name=\"reset\" value=\"{t}Reset{/t}\" class=\"formbutton\" onclick=\"resetfilter()\" />\n                        </td>\n                    </tr>\n                    <tr><td class=\"separator\"></td></tr>\n                    <tr><td class=\"separator\"></td></tr>\n                </table>\n            </form>\n        </div>\n\n        <div>\n            <div style=\"height:4px\"></div>\n            <p>\n                {t}Since July 2015, all registered Opencaching users can create and publish own geocache lists via their <a href=\"mylists.php\">user profile</a>. The following lists have been published so far:{/t}\n            </p>\n        </div>\n    </div>\n\n    <div style=\"height:6px\"></div>\n\n    <table>\n        <tr>\n            <td class=\"header-small\">\n                {include file=\"res_pager.tpl\"}\n            </td>\n        </tr>\n        <tr><td class=\"spacer\"></td></tr>\n    </table>\n\n    {include file=\"res_cachelists.tpl\"}\n\n    <table>\n        <tr><td class=\"spacer\"></td></tr>\n        <tr>\n            <td class=\"header-small\">\n                {include file=\"res_pager.tpl\"}\n            </td>\n        </tr>\n        <tr>\n            <td>&nbsp;</td>\n        </tr>\n    </table>\n"], "fixing_code": ["{***************************************************************************\n * You can find the license in the docs directory\n ***************************************************************************}\n{* OCSTYLE *}\n\n{* JS for cache list description tooltips *}\n<script type=\"text/javascript\" src=\"resource2/{$opt.template.style}/js/wz_tooltip.js\"></script>\n\n    <div class=\"content2-pagetitle\">\n        <img src=\"resource2/{$opt.template.style}/images/misc/32x32-list.png\" style=\"margin-right: 10px;\" width=\"32\" height=\"32\" />\n        {t}Cache lists{/t}\n    </div>\n\n    {literal}\n    <script type=\"text/javascript\">\n    function resetfilter()\n    {\n        document.getElementById('name_filter').value = '';\n        document.getElementById('by_filter').value = '';\n        submitbutton('reset');\n    }\n    </script>\n    {/literal}\n\n    <div class=\"content2-container\">\n        <div class=\"floatbox\">\n            <form method=\"get\" action=\"cachelists.php\">\n                <table class=\"table\" >\n                    <tr>\n                        <td>{t}List name:{/t}</td>\n                        <td><input id=\"name_filter\" name=\"name\" value=\"{$name_filter|escape}\" class=\"input170\" /></td>\n                    </tr>\n                    <tr>\n                        <td>{t}By:{/t}</td>\n                        <td><input id=\"by_filter\" name=\"by\" value=\"{$by_filter|escape}\" class=\"input170\" /></td>\n                    </tr>\n                    <tr><td class=\"separator\"></td></tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align:right\">\n                            <input type=\"submit\" name=\"filter\" value=\"{t}Search{/t}\" class=\"formbutton\" onclick=\"submitbutton('filter')\" />&nbsp;\n                            <input type=\"submit\" name=\"reset\" value=\"{t}Reset{/t}\" class=\"formbutton\" onclick=\"resetfilter()\" />\n                        </td>\n                    </tr>\n                    <tr><td class=\"separator\"></td></tr>\n                    <tr><td class=\"separator\"></td></tr>\n                </table>\n            </form>\n        </div>\n\n        <div>\n            <div style=\"height:4px\"></div>\n            <p>\n                {t}Since July 2015, all registered Opencaching users can create and publish own geocache lists via their <a href=\"mylists.php\">user profile</a>. The following lists have been published so far:{/t}\n            </p>\n        </div>\n    </div>\n\n    <div style=\"height:6px\"></div>\n\n    <table>\n        <tr>\n            <td class=\"header-small\">\n                {include file=\"res_pager.tpl\"}\n            </td>\n        </tr>\n        <tr><td class=\"spacer\"></td></tr>\n    </table>\n\n    {include file=\"res_cachelists.tpl\"}\n\n    <table>\n        <tr><td class=\"spacer\"></td></tr>\n        <tr>\n            <td class=\"header-small\">\n                {include file=\"res_pager.tpl\"}\n            </td>\n        </tr>\n        <tr>\n            <td>&nbsp;</td>\n        </tr>\n    </table>\n"], "filenames": ["htdocs/templates2/ocstyle/cachelists.tpl"], "buggy_code_start_loc": [31], "buggy_code_end_loc": [36], "fixing_code_start_loc": [31], "fixing_code_end_loc": [36], "type": "CWE-79", "message": "A vulnerability classified as problematic was found in Opencaching Deutschland oc-server3. This vulnerability affects unknown code of the file htdocs/templates2/ocstyle/cachelists.tpl of the component Cachelist Handler. The manipulation of the argument name_filter/by_filter leads to cross site scripting. The attack can be initiated remotely. The name of the patch is a9f79c7da78cd24a7ef1d298e6bc86006972ea73. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-216172.", "other": {"cve": {"id": "CVE-2022-4586", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-17T13:15:09.647", "lastModified": "2022-12-22T15:25:09.207", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability classified as problematic was found in Opencaching Deutschland oc-server3. This vulnerability affects unknown code of the file htdocs/templates2/ocstyle/cachelists.tpl of the component Cachelist Handler. The manipulation of the argument name_filter/by_filter leads to cross site scripting. The attack can be initiated remotely. The name of the patch is a9f79c7da78cd24a7ef1d298e6bc86006972ea73. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-216172."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-707"}, {"lang": "en", "value": "CWE-74"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:oc-server3_project:oc-server3:*:*:*:*:*:*:*:*", "versionEndExcluding": "2022-09-04", "matchCriteriaId": "7DD0CB73-32F6-4339-B009-B81EF8A8B743"}]}]}], "references": [{"url": "https://github.com/OpencachingDeutschland/oc-server3/commit/a9f79c7da78cd24a7ef1d298e6bc86006972ea73", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/OpencachingDeutschland/oc-server3/pull/894", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.216172", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/OpencachingDeutschland/oc-server3/commit/a9f79c7da78cd24a7ef1d298e6bc86006972ea73"}}