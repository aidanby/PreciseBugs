{"buggy_code": ["<?php\n/*\n * LibreNMS module to capture statistics from the CISCO-NTP-MIB\n *\n * Copyright (c) 2016 Aaron Daniels <aaron@daniels.id.au>\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n */\n\n$component = new LibreNMS\\Component();\n$options = [];\n$options['filter']['ignore'] = ['=', 0];\n$options['type'] = 'ntp';\n$components = $component->getComponents(null, $options);\n\nprint_optionbar_start();\n\n$view_options = [\n    'all'       => 'All',\n    'error'     => 'Error',\n];\nif (! $vars['view']) {\n    $vars['view'] = 'all';\n}\n\n$graph_options = [\n    'none'          => 'No Graphs',\n    'stratum'       => 'Stratum',\n    'offset'        => 'Offset',\n    'delay'         => 'Delay',\n    'dispersion'    => 'Dispersion',\n];\nif (! $vars['graph']) {\n    $vars['graph'] = 'none';\n}\n\necho '<span style=\"font-weight: bold;\">NTP Peers</span> &#187; ';\n\n// The menu option - on the left\n$sep = '';\nforeach ($view_options as $option => $text) {\n    if (empty($vars['view'])) {\n        $vars['view'] = $option;\n    }\n    echo $sep;\n    if ($vars['view'] == $option) {\n        echo \"<span class='pagemenu-selected'>\";\n    }\n    echo generate_link($text, $vars, ['view' => $option]);\n    if ($vars['view'] == $option) {\n        echo '</span>';\n    }\n    $sep = ' | ';\n}\n\n// The status option - on the right\necho '<div class=\"pull-right\">';\n$sep = '';\nforeach ($graph_options as $option => $text) {\n    if (empty($vars['graph'])) {\n        $vars['graph'] = $option;\n    }\n    echo $sep;\n    if ($vars['graph'] == $option) {\n        echo \"<span class='pagemenu-selected'>\";\n    }\n\n    echo generate_link($text, $vars, ['graph' => $option]);\n    if ($vars['graph'] == $option) {\n        echo '</span>';\n    }\n    $sep = ' | ';\n}\nunset($sep);\necho '</div>';\nprint_optionbar_end();\n\n?>\n<table id='ntp-table' class='table table-condensed table-responsive table-striped'>\n    <thead>\n    <tr>\n        <th data-column-id=\"device\">Device</th>\n        <th data-column-id=\"peer\">Peer</th>\n        <th data-column-id=\"stratum\" data-type=\"numeric\">Stratum</th>\n        <th data-column-id=\"error\">Error</th>\n    </tr>\n    </thead>\n</table>\n<script>\n    $(\"#ntp-table\").bootgrid({\n        ajax: true,\n        post: function ()\n        {\n            return {\n                id: \"app_ntp\",\n                view: '<?php echo $vars['view']; ?>',\n                graph: '<?php echo $vars['graph']; ?>',\n            };\n        },\n        url: \"ajax_table.php\",\n    });\n</script>\n", "<?php\n\n$no_refresh = true;\n\n// FIXME - do this in a function and/or do it in graph-realtime.php\nif (! isset($vars['interval'])) {\n    if ($device['os'] == 'linux') {\n        $vars['interval'] = '15';\n    } else {\n        $vars['interval'] = '2';\n    }\n}\n\nprint_optionbar_start();\n\necho 'Polling Interval: ';\n\n$sep = '';\nforeach ([0.25, 1, 2, 5, 15, 60] as $interval) {\n    echo $sep;\n    if ($vars['interval'] == $interval) {\n        echo \"<span class='pagemenu-selected'>\";\n    }\n\n    echo generate_link($interval . 's', $link_array, ['view' => 'realtime', 'interval' => $interval]);\n    if ($vars['interval'] == $interval) {\n        echo '</span>';\n    }\n\n    $sep = ' | ';\n}\n\nprint_optionbar_end();\n\n?>\n\n<div align=\"center\" style=\"margin: 30px;\">\n<object data=\"graph-realtime.php?type=bits&id=<?php echo $port['port_id'] . '&interval=' . $vars['interval']; ?>\" type=\"image/svg+xml\" width=\"1000\" height=\"400\">\n<param name=\"src\" value=\"graph.php?type=bits&id=<?php echo $port['port_id'] . '&interval=' . $vars['interval']; ?>\" />\nYour browser does not support the type SVG! You need to either use Firefox or download the Adobe SVG plugin.\n</object>\n</div>\n", "<?php\n/*\n * LibreNMS\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\n$pagetitle[] = 'Health :: Memory';\n$graph_view = $vars['view'] == 'graphs';\n\n?>\n\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <div class=\"row\" style=\"padding:0px 10px 0px 10px;\">\n            <div class=\"pull-left\">\n                <?php echo $navbar; ?>\n            </div>\n\n            <div class=\"pull-right\">\n                <?php echo $displayoptions; ?>\n            </div>\n        </div>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"mempool\" class=\"table table-hover table-condensed mempool\">\n            <thead>\n                <tr>\n                    <th data-column-id=\"hostname\">Device</th>\n                    <th data-column-id=\"mempool_descr\"><?php echo $graph_view ? '' : 'Memory' ?></th>\n                    <th data-column-id=\"graph\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                    <th data-column-id=\"mempool_used\" data-searchable=\"false\"><?php echo $graph_view ? '' : 'Used' ?></th>\n                    <th data-column-id=\"mempool_perc\" data-searchable=\"false\"><?php echo $graph_view ? '' : 'Usage' ?></th>\n                </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n    var grid = $(\"#mempool\").bootgrid({\n        ajax: true,\n        rowCount: [50, 100, 250, -1],\n        post: function ()\n        {\n            return {\n                view: '<?php echo $vars['view']; ?>'\n            };\n        },\n        url: \"<?php echo url('/ajax/table/mempools'); ?>\"\n    });\n</script>\n", "<?php\n/*\n * LibreNMS\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\n$pagetitle[] = 'Health :: Processor';\n?>\n\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <div class=\"row\" style=\"padding:0px 10px 0px 10px;\">\n            <div class=\"pull-left\">\n                <?php echo $navbar; ?>\n            </div>\n\n            <div class=\"pull-right\">\n                <?php echo $displayoptions; ?>\n            </div>\n        </div>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"processor\" class=\"table table-hover table-condensed processor\">\n            <thead>\n                <tr>\n                    <th data-column-id=\"hostname\">Device</th>\n                    <th data-column-id=\"processor_descr\">Processor</th>\n                    <th data-column-id=\"graph\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                    <th data-column-id=\"processor_usage\" data-searchable=\"false\">Usage</th>\n                </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n    var grid = $(\"#processor\").bootgrid({\n        ajax: true,\n        rowCount: [50,100,250,-1],\n        post: function ()\n        {\n            return {\n                id: \"processor\",\n                view: '<?php echo $vars['view']; ?>'\n            };\n        },\n        url: \"ajax_table.php\"\n    });\n</script>\n", "<?php\n/*\n * LibreNMS\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\nswitch ($class) {\n    case 'charge':\n        $pagetitle[] = 'Health :: Charge';\n        break;\n    case 'cooling':\n        $pagetitle[] = 'Health :: Cooling';\n        break;\n    case 'current':\n        $pagetitle[] = 'Health :: Current';\n        break;\n    case 'dbm':\n        $pagetitle[] = 'Health :: dBm';\n        break;\n    case 'fanspeed':\n        $pagetitle[] = 'Health :: Fanspeed';\n        break;\n    case 'frequency':\n        $pagetitle[] = 'Health :: Frequency';\n        break;\n    case 'humidity':\n        $pagetitle[] = 'Health :: Humidity';\n        break;\n    case 'load':\n        $pagetitle[] = 'Health :: Load';\n        break;\n    case 'power':\n        $pagetitle[] = 'Health :: Power';\n        break;\n    case 'pressure':\n        $pagetitle[] = 'Health :: Pressure';\n        break;\n    case 'runtime':\n        $pagetitle[] = 'Health :: Runtime';\n        break;\n    case 'signal':\n        $pagetitle[] = 'Health :: Signal';\n        break;\n    case 'snr':\n        $pagetitle[] = 'Health :: SNR';\n        break;\n    case 'state':\n        $pagetitle[] = 'Health :: State';\n        break;\n    case 'count':\n        $pagetitle[] = 'Health :: Count';\n        break;\n    case 'temperature':\n        $pagetitle[] = 'Health :: Temperature';\n        break;\n    case 'voltage':\n        $pagetitle[] = 'Health :: Voltage';\n        break;\n}\n\n?>\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <div class=\"row\" style=\"padding:0px 10px 0px 10px;\">\n            <div class=\"pull-left\">\n                <?php echo $navbar; ?>\n            </div>\n\n            <div class=\"pull-right\">\n                <?php echo $displayoptions; ?>\n            </div>\n        </div>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"sensors\" class=\"table table-hover table-condensed storage\">\n            <thead>\n            <tr>\n                <th data-column-id=\"hostname\">Device</th>\n                <th data-column-id=\"sensor_descr\">Sensor</th>\n                <th data-column-id=\"graph\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                <th data-column-id=\"alert\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                <th data-column-id=\"sensor_current\">Current</th>\n                <th data-column-id=\"sensor_limit_low\" data-searchable=\"false\">Low Limit</th>\n                <th data-column-id=\"sensor_limit\" data-searchable=\"false\">High Limit</th>\n            </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n    var grid = $(\"#sensors\").bootgrid({\n        ajax: true,\n        rowCount: [50, 100, 250, -1],\n        post: function () {\n            return {\n                id: 'sensors',\n                view: '<?php echo $vars['view']; ?>',\n                graph_type: '<?php echo $graph_type; ?>',\n                unit: '<?php echo $unit; ?>',\n                class: '<?php echo $class; ?>'\n            };\n        },\n        url: \"ajax_table.php\"\n    });\n</script>\n", "<?php\n/*\n * LibreNMS\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\n$pagetitle[] = 'Health :: Storage';\n?>\n\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <div class=\"row\" style=\"padding:0px 10px 0px 10px;\">\n            <div class=\"pull-left\">\n                <?php echo $navbar; ?>\n            </div>\n\n            <div class=\"pull-right\">\n                <?php echo $displayoptions; ?>\n            </div>\n        </div>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"storage\" class=\"table table-hover table-condensed storage\">\n            <thead>\n                <tr>\n                    <th data-column-id=\"hostname\">Device</th>\n                    <th data-column-id=\"storage_descr\">Storage</th>\n                    <th data-column-id=\"graph\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                    <th data-column-id=\"storage_used\" data-searchable=\"false\">Used</th>\n                    <th data-column-id=\"storage_perc\" data-searchable=\"false\">Usage</th>\n                </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n    var grid = $(\"#storage\").bootgrid({\n        ajax: true,\n        rowCount: [50, 100, 250, -1],\n        post: function ()\n        {\n            return {\n                id: \"storage\",\n                view: '<?php echo $vars['view']; ?>'\n            };\n        },\n        url: \"ajax_table.php\"\n    });\n</script>\n", "<?php\n/*\n * LibreNMS\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\n$pagetitle[] = 'Health :: Toner';\n?>\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <div class=\"row\" style=\"padding:0px 10px 0px 10px;\">\n            <div class=\"pull-left\">\n                <?php echo $navbar; ?>\n            </div>\n\n            <div class=\"pull-right\">\n                <?php echo $displayoptions; ?>\n            </div>\n        </div>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"toner\" class=\"table table-hover table-condensed mempool\">\n            <thead>\n            <tr>\n                <th data-column-id=\"hostname\">Device</th>\n                <th data-column-id=\"supply_descr\">Toner</th>\n                <th data-column-id=\"supply_type\" data-searchable=\"false\">Type</th>\n                <th data-column-id=\"graph\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                <th data-column-id=\"toner_used\" data-searchable=\"false\">Used</th>\n                <th data-column-id=\"supply_current\" data-searchable=\"false\">Usage</th>\n            </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n    var grid = $(\"#toner\").bootgrid({\n        ajax: true,\n        rowCount: [50, 100, 250, -1],\n        post: function ()\n        {\n            return {\n                id: \"toner\",\n                view: '<?php echo $vars['view']; ?>'\n            };\n        },\n        url: \"ajax_table.php\"\n    });\n</script>\n", "<?php\n/*\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\nuse Carbon\\Carbon;\nuse LibreNMS\\Config;\n\n$no_refresh = true;\n$param = [];\n$device_id = (int) $vars['device'];\n\n$pagetitle[] = 'Outages';\n?>\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <strong>Outages</strong>\n    </div>\n\n    <?php\n    require_once 'includes/html/common/outages.inc.php';\n    echo implode('', $common_output);\n    ?>\n</div>\n<script>\n    $('.actionBar').append(\n        '<div class=\"pull-left\">' +\n        '<form method=\"post\" action=\"\" class=\"form-inline\" role=\"form\" id=\"result_form\">' +\n        '<?php echo csrf_field() ?>'+\n        '<div class=\"form-group\">' +\n        <?php\n        if (! isset($vars['fromdevice'])) {\n            ?>\n        '<select name=\"device\" id=\"device\" class=\"form-control\">' +\n        '<option value=\"\">All Devices&nbsp;&nbsp;</option>' +\n            <?php\n            if ($device_id) {\n                echo \"'<option value=$device_id>\" . format_hostname(device_by_id_cache($device_id)) . \"</option>' +\";\n            } ?>\n        '</select>' +\n            <?php\n        } else {\n            echo \"'&nbsp;&nbsp;<input type=\\\"hidden\\\" name=\\\"device\\\" id=\\\"device\\\" value=\\\"\" . $device_id . \"\\\">' + \";\n        }\n        ?>\n        '</div>' +\n        '&nbsp;&nbsp;<div class=\"form-group\">' +\n        '<input name=\"from\" type=\"text\" class=\"form-control\" id=\"dtpickerfrom\" maxlength=\"16\" value=\"<?php echo $vars['from']; ?>\" placeholder=\"From\" data-date-format=\"YYYY-MM-DD HH:mm\">' +\n        '</div>' +\n        '<div class=\"form-group\">' +\n        '&nbsp;&nbsp;<input name=\"to\" type=\"text\" class=\"form-control\" id=\"dtpickerto\" maxlength=\"16\" value=\"<?php echo $vars['to']; ?>\" placeholder=\"To\" data-date-format=\"YYYY-MM-DD HH:mm\">' +\n        '</div>' +\n        '&nbsp;&nbsp;<button type=\"submit\" class=\"btn btn-default\">Filter</button>' +\n        '</form>' +\n        '</div>'\n    );\n\n    $(function () {\n        $(\"#dtpickerfrom\").datetimepicker({\n            icons: {\n                time: 'fa fa-clock-o',\n                date: 'fa fa-calendar',\n                up: 'fa fa-chevron-up',\n                down: 'fa fa-chevron-down',\n                previous: 'fa fa-chevron-left',\n                next: 'fa fa-chevron-right',\n                today: 'fa fa-calendar-check-o',\n                clear: 'fa fa-trash-o',\n                close: 'fa fa-close'\n            },\n            defaultDate: '<?php echo Carbon::now(session('preferences.timezone'))->subMonth()->format(Config::get('dateformat.byminute', 'Y-m-d H:i')); ?>'\n        });\n        $(\"#dtpickerfrom\").on(\"dp.change\", function (e) {\n            $(\"#dtpickerto\").data(\"DateTimePicker\").minDate(e.date);\n        });\n        $(\"#dtpickerto\").datetimepicker({\n            icons: {\n                time: 'fa fa-clock-o',\n                date: 'fa fa-calendar',\n                up: 'fa fa-chevron-up',\n                down: 'fa fa-chevron-down',\n                previous: 'fa fa-chevron-left',\n                next: 'fa fa-chevron-right',\n                today: 'fa fa-calendar-check-o',\n                clear: 'fa fa-trash-o',\n                close: 'fa fa-close'\n            },\n            defaultDate: '<?php echo Carbon::now(session('preferences.timezone'))->format(Config::get('dateformat.byminute', 'Y-m-d H:i')); ?>'\n        });\n        $(\"#dtpickerto\").on(\"dp.change\", function (e) {\n            $(\"#dtpickerfrom\").data(\"DateTimePicker\").maxDate(e.date);\n        });\n        if ($(\"#dtpickerfrom\").val() != \"\") {\n            $(\"#dtpickerto\").data(\"DateTimePicker\").minDate($(\"#dtpickerfrom\").val());\n        }\n        if ($(\"#dtpickerto\").val() != \"\") {\n            $(\"#dtpickerfrom\").data(\"DateTimePicker\").maxDate($(\"#dtpickerto\").val());\n        } else {\n            $(\"#dtpickerto\").data(\"DateTimePicker\").maxDate('<?php echo Carbon::now(session('preferences.timezone'))->format(Config::get('dateformat.byminute', 'Y-m-d H:i')); ?>');\n        }\n    });\n\n    <?php if (! isset($vars['fromdevice'])) { ?>\n    $(\"#device\").select2({\n        theme: \"bootstrap\",\n        dropdownAutoWidth : true,\n        width: \"auto\",\n        allowClear: true,\n        placeholder: \"All Devices\",\n        ajax: {\n            url: '<?php echo url('/ajax/select/device'); ?>',\n            delay: 200\n        }\n    })<?php echo $device_id ? \".val($device_id).trigger('change');\" : ''; ?>;\n    <?php } ?>\n</script>\n\n", "<?php\n/*\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\n$details_visible = var_export($vars['format'] == 'list_detail', 1);\n$errors_visible = var_export($vars['format'] == 'list_detail' || isset($vars['errors']), 1);\n$no_refresh = true;\n$device = DeviceCache::get((int) $vars['device_id']);\n$device_selected = json_encode($device->exists ? ['id' => $device->device_id, 'text' => $device->displayName()] : '');\n$location = \\App\\Models\\Location::find((int) $vars['location']);\n$location_selected = json_encode(! empty($location) ? ['id' => $location->id, 'text' => $location->location] : '');\n\nif (isset($vars['errors'])) {\n    $error_sort = ' data-order=\"desc\"';\n    $sort = '';\n} else {\n    $error_sort = '';\n    $sort = ' data-order=\"asc\"';\n}\n?>\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <?php echo $displayLists; ?>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"ports\" class=\"table table-condensed table-hover table-striped\">\n            <thead>\n            <tr>\n                <th data-column-id=\"hostname\" data-formatter=\"device\">Device</th>\n                <th data-column-id=\"ifDescr\"<?php echo $sort ?> data-formatter=\"port\">Port</th>\n                <th data-column-id=\"secondsIfLastChange\" data-converter=\"duration\">Status Changed</th>\n                <th data-column-id=\"ifConnectorPresent\" data-visible=\"false\">Connected</th>\n                <th data-column-id=\"ifSpeed\" data-converter=\"human-bps\">Speed</th>\n                <th data-column-id=\"ifMtu\" data-visible=\"false\">MTU</th>\n                <th data-column-id=\"ifInOctets_rate\" data-searchable=\"false\" data-css-class=\"green\"\n                    data-converter=\"human-bps\">Down\n                </th>\n                <th data-column-id=\"ifOutOctets_rate\" data-searchable=\"false\" data-css-class=\"blue\"\n                    data-converter=\"human-bps\">Up\n                </th>\n                <th data-column-id=\"ifInUcastPkts_rate\" data-searchable=\"false\"\n                    data-visible=\"<?php echo $details_visible ?>\" data-css-class=\"green\" data-converter=\"human-pps\">\n                    Packets In\n                </th>\n                <th data-column-id=\"ifOutUcastPkts_rate\" data-searchable=\"false\"\n                    data-visible=\"<?php echo $details_visible ?>\" data-css-class=\"blue\" data-converter=\"human-pps\">\n                    Packets Out\n                </th>\n                <th data-column-id=\"ifInErrors_delta\" data-searchable=\"false\" data-visible=\"<?php echo $errors_visible ?>\"\n                    data-css-class=\"red\"<?php echo $error_sort ?>>Errors In\n                </th>\n                <th data-column-id=\"ifOutErrors_delta\" data-searchable=\"false\" data-visible=\"<?php echo $errors_visible ?>\"\n                    data-css-class=\"red\">Errors Out\n                </th>\n                <th data-column-id=\"ifType\">Media</th>\n                <th data-column-id=\"ifAlias\">Description</th>\n                <th data-column-id=\"actions\" data-sortable=\"false\" data-searchable=\"false\">Actions</th>\n            </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n\nfunction formatUnits(units,decimals,display,base) {\n    if(!units) return '';\n    if(display === undefined) display = ['bps', 'Kbps', 'Mbps', 'Gbps', 'Tbps', 'Pbps', 'Ebps', 'Zbps', 'Ybps'];\n    if(units == 0) return units + display[0];\n    base = base || 1000; // or 1024 for binary\n    var dm = decimals || 2;\n    var i = Math.floor(Math.log(units) / Math.log(base));\n    return parseFloat((units / Math.pow(base, i)).toFixed(dm)) + display[i];\n}\n\nvar grid = $(\"#ports\").bootgrid({\n    ajax: true,\n    rowCount: [50, 100, 250, -1],\n    converters: {\n        'duration': {\n            to: function (value) { return moment.duration(value, 'seconds').humanize(); }\n        },\n        'human-bps': {\n            to: function (value) { return formatUnits(value); }\n        },\n        'human-pps': {\n            to: function (value) {\n                return formatUnits(value, 2, ['pps', 'Kpps', 'Mpps', 'Gpps', 'Tpps', 'Ppps', 'Epps', 'Zpps', 'Ypps']);\n            }\n        }\n    },\n    formatters: {\n      'device': function (column, row) {\n          return \"<span class='alert-status \" + row.status + \"' style='float:left;margin-right:10px;'></span>\" + row.device + \"\";\n      },\n      'port': function (column, row) {\n          return row.port\n      }\n    },\n    templates: {\n        search: \"\" // hide the generic search\n    },\n    post: function ()\n    {\n        return {\n            device_id: '<?php echo $vars['device_id'] ?? ''; ?>',\n            hostname: '<?php echo htmlspecialchars($vars['hostname'] ?? ''); ?>',\n            state: '<?php echo $vars['state'] ?? ''; ?>',\n            ifSpeed: '<?php echo $vars['ifSpeed'] ?? ''; ?>',\n            ifType: '<?php echo $vars['ifType'] ?? ''; ?>',\n            port_descr_type: '<?php echo $vars['port_descr_type'] ?? ''; ?>',\n            ifAlias: '<?php echo $vars['ifAlias'] ?? ''; ?>',\n            location: '<?php echo $vars['location'] ?? ''; ?>',\n            disabled: '<?php echo $vars['disabled'] ?? ''; ?>',\n            ignore: '<?php echo $vars['ignore'] ?? ''; ?>',\n            deleted: '<?php echo $vars['deleted'] ?? ''; ?>',\n            errors: '<?php echo $vars['errors'] ?? ''; ?>',\n            group: '<?php echo $vars['group'] ?? ''; ?>',\n            devicegroup: '<?php echo $vars['devicegroup'] ?? ''; ?>',\n        };\n    },\n    url: '<?php echo route('table.ports') ?>'\n});\n\n$(\".actionBar\").append(\"<div class=\\\"pull-left\\\"><?php echo $output; ?></div>\");\n\ninit_select2('#device_id', 'device', {}, <?php echo $device_selected ?>, 'All Devices');\ninit_select2('#location', 'location', {}, <?php echo $location_selected ?>, 'All Locations');\n\n</script>\n", "<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <strong>FDB Entries</strong>\n    </div>\n    <table id=\"fdb-search\" class=\"table table-hover table-condensed table-striped\">\n        <thead>\n            <tr>\n                <th data-column-id=\"device\">Device</th>\n                <th data-column-id=\"mac_address\" data-width=\"150px\" data-formatter=\"tooltip\">MAC Address</th>\n<?php\nif (\\LibreNMS\\Config::get('mac_oui.enabled') === true) {\n    echo '                <th data-column-id=\"mac_oui\" data-sortable=\"false\" data-width=\"150px\" data-visible=\"false\" data-formatter=\"tooltip\">Vendor</th>';\n}\n?>\n                <th data-column-id=\"ipv4_address\" data-sortable=\"false\" data-formatter=\"tooltip\">IPv4 Address</th>\n                <th data-column-id=\"interface\">Port</th>\n                <th data-column-id=\"vlan\" data-width=\"60px\">Vlan</th>\n                <th data-column-id=\"description\" data-formatter=\"tooltip\">Description</th>\n                <th data-column-id=\"dnsname\" data-sortable=\"false\" data-visible=\"false\" data-formatter=\"tooltip\">DNS Name</th>\n                <th data-column-id=\"first_seen\" data-width=\"165px\">First seen</th>\n                <th data-column-id=\"last_seen\" data-width=\"165px\">Last seen</th>\n            </tr>\n        </thead>\n    </table>\n</div>\n\n<script>\n\nvar grid = $(\"#fdb-search\").bootgrid({\n    ajax: true,\n    rowCount: [50, 100, 250, -1],\n    templates: {\n        header: \"<div id=\\\"{{ctx.id}}\\\" class=\\\"{{css.header}}\\\"><div class=\\\"row\\\">\"+\n                \"<div class=\\\"col-sm-9 actionBar\\\"><span class=\\\"pull-left\\\">\"+\n                \"<form method=\\\"post\\\" action=\\\"\\\" class=\\\"form-inline\\\" role=\\\"form\\\">\"+\n                \"<?php echo addslashes(csrf_field()) ?>\"+\n                \"<div class=\\\"form-group\\\">\"+\n                \"<select name=\\\"device_id\\\" id=\\\"device_id\\\" class=\\\"form-control input-sm\\\">\"+\n                \"<option value=\\\"\\\">All Devices</option>\"+\n<?php\n\n// Select the devices only with FDB tables\n$sql = 'SELECT D.device_id AS device_id, `hostname`, `sysName`, `display` FROM `ports_fdb` AS F, `ports` AS P, `devices` AS D';\n$param = [];\n\nif (! Auth::user()->hasGlobalRead()) {\n    $device_ids = Permissions::devicesForUser()->toArray() ?: [0];\n    $where .= ' AND `D`.`device_id` IN ' . dbGenPlaceholders(count($device_ids));\n    $param = array_merge($param, $device_ids);\n}\n\n$sql .= \" WHERE F.port_id = P.port_id AND P.device_id = D.device_id $where GROUP BY `D`.`device_id`, `D`.`hostname` ORDER BY `hostname`\";\nforeach (dbFetchRows($sql, $param) as $data) {\n    echo '\"<option value=\\\"' . $data['device_id'] . '\\\"\"+';\n    if ($data['device_id'] == $vars['device_id']) {\n        echo '\" selected \"+';\n    }\n\n    echo '\">' . format_hostname($data) . '</option>\"+';\n}\n?>\n                \"</select>\"+\n                \"</div>\"+\n                \"<div class=\\\"form-group\\\">\"+\n                \"<select name=\\\"searchby\\\" id=\\\"searchby\\\" class=\\\"form-control input-sm\\\">\"+\n                \"<option value=\\\"mac\\\" \"+\n<?php\nif ($vars['searchby'] == 'mac') {\n    echo '\" selected \"+';\n}\n?>\n\n                \">MAC Address</option>\"+\n                \"<option value=\\\"ip\\\" \"+\n<?php\nif ($vars['searchby'] == 'ip') {\n    echo '\" selected \"+';\n}\n?>\n\n                \">IP Address</option>\"+\n                \"<option value=\\\"dnsname\\\" \"+\n<?php\nif ($vars['searchby'] == 'dnsname') {\n    echo '\" selected \"+';\n}\n?>\n\n                \">DNS Name</option>\"+\n                \"<option value=\\\"description\\\" \"+\n<?php\nif ($vars['searchby'] == 'description') {\n    echo '\" selected \"+';\n}\n?>\n\n                \">Description</option>\"+\n                \"<option value=\\\"vendor\\\" \"+\n<?php\nif ($vars['searchby'] == 'vendor') {\n    echo '\" selected \"+';\n}\n?>\n\n                \">Vendor</option>\"+\n                \"<option value=\\\"vlan\\\" \"+\n<?php\nif ($vars['searchby'] == 'vlan') {\n    echo '\" selected \"+';\n}\n?>\n\n                \">Vlan</option>\"+\n                \"</select>\"+\n                \"</div>\"+\n                \"<div class=\\\"form-group\\\">\"+\n                \"<input type=\\\"text\\\" name=\\\"searchPhrase\\\" id=\\\"address\\\" value=\\\"\"+\n<?php\necho '\"' . $vars['searchPhrase'] . '\"+';\n?>\n\n                \"\\\" class=\\\"form-control input-sm\\\" placeholder=\\\"Value\\\" />\"+\n                \"</div>\"+\n                \"<button type=\\\"submit\\\" class=\\\"btn btn-default input-sm\\\">Search</button>\"+\n                \"</form></span></div>\"+\n               \"<div class=\\\"col-sm-3 actionBar\\\"><p class=\\\"{{css.actions}}\\\"></p></div></div></div>\"\n    },\n    post: function ()\n    {\n        return {\n            device_id: '<?php echo $vars['device_id']; ?>',\n            searchby: '<?php echo $vars['searchby']; ?>',\n            searchPhrase: '<?php echo $vars['searchPhrase']; ?>',\n            dns: $(\"#fdb-search\").bootgrid(\"getColumnSettings\").find(col => col.id === \"dnsname\").visible,\n        };\n    },\n    url: \"<?php echo url('/ajax/table/fdb-tables'); ?>\",\n    formatters: {\n        \"tooltip\": function (column, row) {\n                var value = row[column.id];\n                var vendor = '';\n                if (column.id == 'mac_address' && ((vendor = row['mac_oui']) != '' )) {\n                    return \"<span title=\\'\" + value + \" (\" + vendor + \")\\' data-toggle=\\'tooltip\\'>\" + value + \"</span>\";\n                }\n                return \"<span title=\\'\" + value + \"\\' data-toggle=\\'tooltip\\'>\" + value + \"</span>\";\n            },\n    },\n});\n\n</script>\n", "<?php\n/*\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\nuse Carbon\\Carbon;\nuse LibreNMS\\Config;\n\n$no_refresh = true;\n$param = [];\n$device_id = (int) $vars['device'];\n\nif (isset($vars['action']) && $vars['action'] == 'expunge' && \\Auth::user()->hasGlobalAdmin()) {\n    dbQuery('TRUNCATE TABLE `syslog`');\n    print_message('syslog truncated');\n}\n\n$pagetitle[] = 'Syslog';\n?>\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <strong>Syslog</strong>\n    </div>\n\n    <?php\n    require_once 'includes/html/common/syslog.inc.php';\n    echo implode('', $common_output);\n    ?>\n</div>\n<script>\n    $('.actionBar').append(\n        '<div class=\"pull-left\">' +\n        '<form method=\"post\" action=\"\" class=\"form-inline\" role=\"form\" id=\"result_form\">' +\n        '<?php echo csrf_field() ?>'+\n        '<div class=\"form-group\">' +\n        <?php\n        if (! isset($vars['fromdevice'])) {\n            ?>\n        '<select name=\"device\" id=\"device\" class=\"form-control\">' +\n        '<option value=\"\">All Devices&nbsp;&nbsp;</option>' +\n            <?php\n            if ($device_id) {\n                echo \"'<option value=$device_id>\" . format_hostname(device_by_id_cache($device_id)) . \"</option>' +\";\n            } ?>\n        '</select>' +\n            <?php\n        } else {\n            echo \"'&nbsp;&nbsp;<input type=\\\"hidden\\\" name=\\\"device\\\" id=\\\"device\\\" value=\\\"\" . $device_id . \"\\\">' + \";\n        }\n        ?>\n        '</div>' +\n        '&nbsp;&nbsp;<div class=\"form-group\">' +\n        '<select name=\"program\" id=\"program\" class=\"form-control\">' +\n        '<option value=\"\">All Programs&nbsp;&nbsp;</option>' +\n        <?php\n        if (! empty($vars['program'])) {\n            $js_program = addcslashes(htmlentities($vars['program']), \"'\");\n            echo \"'<option value=\\\"$js_program\\\">$js_program</option>' +\";\n        }\n        ?>\n        '</select>' +\n        '</div>' +\n        '&nbsp;&nbsp;<div class=\"form-group\">' +\n        '<select name=\"priority\" id=\"priority\" class=\"form-control\">' +\n        '<option value=\"\">All Priorities</option>' +\n        <?php\n        if (! empty($vars['priority'])) {\n            $js_priority = addcslashes(htmlentities($vars['priority']), \"'\");\n            echo \"'<option value=\\\"$js_priority\\\">$js_priority</option>' +\";\n        }\n        ?>\n        '</select>' +\n        '</div>' +\n        '&nbsp;&nbsp;<div class=\"form-group\">' +\n        '<input name=\"from\" type=\"text\" class=\"form-control\" id=\"dtpickerfrom\" maxlength=\"16\" value=\"<?php echo $vars['from'] ?? ''; ?>\" placeholder=\"From\" data-date-format=\"YYYY-MM-DD HH:mm\">' +\n        '</div>' +\n        '<div class=\"form-group\">' +\n        '&nbsp;&nbsp;<input name=\"to\" type=\"text\" class=\"form-control\" id=\"dtpickerto\" maxlength=\"16\" value=\"<?php echo $vars['to'] ?? ''; ?>\" placeholder=\"To\" data-date-format=\"YYYY-MM-DD HH:mm\">' +\n        '</div>' +\n        '&nbsp;&nbsp;<button type=\"submit\" class=\"btn btn-default\">Filter</button>' +\n        '</form>' +\n        '</div>' +\n        '</div>' +\n        '</div>' +\n        '</div>'\n    );\n\n    $(function () {\n        $(\"#dtpickerfrom\").datetimepicker({\n            icons: {\n                time: 'fa fa-clock-o',\n                date: 'fa fa-calendar',\n                up: 'fa fa-chevron-up',\n                down: 'fa fa-chevron-down',\n                previous: 'fa fa-chevron-left',\n                next: 'fa fa-chevron-right',\n                today: 'fa fa-calendar-check-o',\n                clear: 'fa fa-trash-o',\n                close: 'fa fa-close'\n            },\n            defaultDate: '<?php echo Carbon::now()->subDay()->format(Config::get('dateformat.byminute', 'Y-m-d H:i')); ?>'\n        });\n        $(\"#dtpickerfrom\").on(\"dp.change\", function (e) {\n            $(\"#dtpickerto\").data(\"DateTimePicker\").minDate(e.date);\n        });\n        $(\"#dtpickerto\").datetimepicker({\n            icons: {\n                time: 'fa fa-clock-o',\n                date: 'fa fa-calendar',\n                up: 'fa fa-chevron-up',\n                down: 'fa fa-chevron-down',\n                previous: 'fa fa-chevron-left',\n                next: 'fa fa-chevron-right',\n                today: 'fa fa-calendar-check-o',\n                clear: 'fa fa-trash-o',\n                close: 'fa fa-close'\n            }\n        });\n        $(\"#dtpickerto\").on(\"dp.change\", function (e) {\n            $(\"#dtpickerfrom\").data(\"DateTimePicker\").maxDate(e.date);\n        });\n        if ($(\"#dtpickerfrom\").val() != \"\") {\n            $(\"#dtpickerto\").data(\"DateTimePicker\").minDate($(\"#dtpickerfrom\").val());\n        }\n        if ($(\"#dtpickerto\").val() != \"\") {\n            $(\"#dtpickerfrom\").data(\"DateTimePicker\").maxDate($(\"#dtpickerto\").val());\n        } else {\n            $(\"#dtpickerto\").data(\"DateTimePicker\").maxDate('<?php echo Carbon::now()->format(Config::get('dateformat.byminute', 'Y-m-d H:i')); ?>');\n        }\n    });\n\n    <?php if (! isset($vars['fromdevice'])) { ?>\n    $(\"#device\").select2({\n        theme: \"bootstrap\",\n        dropdownAutoWidth : true,\n        width: \"auto\",\n        allowClear: true,\n        placeholder: \"All Devices\",\n        ajax: {\n            url: '<?php echo url('/ajax/select/device'); ?>',\n            delay: 200\n        }\n    })<?php echo $device_id ? \".val($device_id).trigger('change');\" : ''; ?>;\n    <?php } ?>\n\n    $(\"#program\").select2({\n        theme: \"bootstrap\",\n        dropdownAutoWidth : true,\n        width: \"auto\",\n        allowClear: true,\n        placeholder: \"All Programs\",\n        ajax: {\n            url: '<?php echo url('/ajax/select/syslog'); ?>',\n            delay: 200,\n            data: function(params) {\n                return {\n                    field: \"program\",\n                    device: $('#device').val(),\n                    term: params.term,\n                    page: params.page || 1\n                }\n            }\n        }\n    })<?php echo isset($vars['program']) ? \".val('\" . addcslashes($vars['program'], \"'\") . \"').trigger('change');\" : ''; ?>;\n\n    $(\"#priority\").select2({\n        theme: \"bootstrap\",\n        dropdownAutoWidth : true,\n        width: \"auto\",\n        allowClear: true,\n        placeholder: \"All Priorities\",\n        ajax: {\n            url: '<?php echo url('/ajax/select/syslog'); ?>',\n            delay: 200,\n            data: function(params) {\n                return {\n                    field: \"priority\",\n                    device: $('#device').val(),\n                    term: params.term,\n                    page: params.page || 1\n                }\n            }\n        }\n    })<?php echo isset($vars['priority']) ? \".val('\" . addcslashes($vars['priority'], \"'\") . \"').trigger('change');\" : ''; ?>;\n</script>\n\n", "<?php\n/*\n * LibreNMS\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\n?>\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <div class=\"row\" style=\"padding:0px 10px 0px 10px;\">\n        <div class=\"pull-left\">\n            <?php echo $linkoptions; ?>\n        </div>\n        <div class=\"pull-right\">\n            <?php echo $displayoptions; ?>\n        </div>\n        </div>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"sensors\" class=\"table table-hover table-condensed storage\">\n            <thead>\n                <tr>\n                    <th data-column-id=\"hostname\">Device</th>\n                    <th data-column-id=\"sensor_descr\">Sensor</th>\n                    <th data-column-id=\"graph\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                    <th data-column-id=\"alert\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                    <th data-column-id=\"sensor_current\">Current</th>\n                    <th data-column-id=\"sensor_limit_low\" data-searchable=\"false\">Low Limit</th>\n                    <th data-column-id=\"sensor_limit\" data-searchable=\"false\">High Limit</th>\n                </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n    var grid = $(\"#sensors\").bootgrid({\n        ajax: true,\n        rowCount: [50, 100, 250, -1],\n        post: function ()\n        {\n            return {\n                id:         'wireless-sensors',\n                view:       '<?php echo $vars['view']; ?>',\n                graph_type: '<?php echo $graph_type; ?>',\n                unit:       '<?php echo $unit; ?>',\n                class:      '<?php echo $class; ?>'\n            };\n        },\n        url: \"ajax_table.php\"\n    });\n</script>\n"], "fixing_code": ["<?php\n/*\n * LibreNMS module to capture statistics from the CISCO-NTP-MIB\n *\n * Copyright (c) 2016 Aaron Daniels <aaron@daniels.id.au>\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n */\n\n$component = new LibreNMS\\Component();\n$options = [];\n$options['filter']['ignore'] = ['=', 0];\n$options['type'] = 'ntp';\n$components = $component->getComponents(null, $options);\n\nprint_optionbar_start();\n\n$view_options = [\n    'all'       => 'All',\n    'error'     => 'Error',\n];\nif (! $vars['view']) {\n    $vars['view'] = 'all';\n}\n\n$graph_options = [\n    'none'          => 'No Graphs',\n    'stratum'       => 'Stratum',\n    'offset'        => 'Offset',\n    'delay'         => 'Delay',\n    'dispersion'    => 'Dispersion',\n];\nif (! $vars['graph']) {\n    $vars['graph'] = 'none';\n}\n\necho '<span style=\"font-weight: bold;\">NTP Peers</span> &#187; ';\n\n// The menu option - on the left\n$sep = '';\nforeach ($view_options as $option => $text) {\n    if (empty($vars['view'])) {\n        $vars['view'] = $option;\n    }\n    echo $sep;\n    if ($vars['view'] == $option) {\n        echo \"<span class='pagemenu-selected'>\";\n    }\n    echo generate_link($text, $vars, ['view' => $option]);\n    if ($vars['view'] == $option) {\n        echo '</span>';\n    }\n    $sep = ' | ';\n}\n\n// The status option - on the right\necho '<div class=\"pull-right\">';\n$sep = '';\nforeach ($graph_options as $option => $text) {\n    if (empty($vars['graph'])) {\n        $vars['graph'] = $option;\n    }\n    echo $sep;\n    if ($vars['graph'] == $option) {\n        echo \"<span class='pagemenu-selected'>\";\n    }\n\n    echo generate_link($text, $vars, ['graph' => $option]);\n    if ($vars['graph'] == $option) {\n        echo '</span>';\n    }\n    $sep = ' | ';\n}\nunset($sep);\necho '</div>';\nprint_optionbar_end();\n\n?>\n<table id='ntp-table' class='table table-condensed table-responsive table-striped'>\n    <thead>\n    <tr>\n        <th data-column-id=\"device\">Device</th>\n        <th data-column-id=\"peer\">Peer</th>\n        <th data-column-id=\"stratum\" data-type=\"numeric\">Stratum</th>\n        <th data-column-id=\"error\">Error</th>\n    </tr>\n    </thead>\n</table>\n<script>\n    $(\"#ntp-table\").bootgrid({\n        ajax: true,\n        post: function ()\n        {\n            return {\n                id: \"app_ntp\",\n                view: '<?php echo htmlspecialchars($vars['view']); ?>',\n                graph: '<?php echo htmlspecialchars($vars['graph']); ?>',\n            };\n        },\n        url: \"ajax_table.php\",\n    });\n</script>\n", "<?php\n\n$no_refresh = true;\n\n// FIXME - do this in a function and/or do it in graph-realtime.php\nif (! isset($vars['interval'])) {\n    if ($device['os'] == 'linux') {\n        $vars['interval'] = '15';\n    } else {\n        $vars['interval'] = '2';\n    }\n}\n\nprint_optionbar_start();\n\necho 'Polling Interval: ';\n\n$sep = '';\nforeach ([0.25, 1, 2, 5, 15, 60] as $interval) {\n    echo $sep;\n    if ($vars['interval'] == $interval) {\n        echo \"<span class='pagemenu-selected'>\";\n    }\n\n    echo generate_link($interval . 's', $link_array, ['view' => 'realtime', 'interval' => $interval]);\n    if ($vars['interval'] == $interval) {\n        echo '</span>';\n    }\n\n    $sep = ' | ';\n}\n\nprint_optionbar_end();\n\n?>\n\n<div align=\"center\" style=\"margin: 30px;\">\n<object data=\"graph-realtime.php?type=bits&id=<?php echo $port['port_id'] . '&interval=' . htmlspecialchars($vars['interval']); ?>\" type=\"image/svg+xml\" width=\"1000\" height=\"400\">\n<param name=\"src\" value=\"graph.php?type=bits&id=<?php echo $port['port_id'] . '&interval=' . htmlspecialchars($vars['interval']); ?>\" />\nYour browser does not support the type SVG! You need to either use Firefox or download the Adobe SVG plugin.\n</object>\n</div>\n", "<?php\n/*\n * LibreNMS\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\n$pagetitle[] = 'Health :: Memory';\n$graph_view = $vars['view'] == 'graphs';\n\n?>\n\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <div class=\"row\" style=\"padding:0px 10px 0px 10px;\">\n            <div class=\"pull-left\">\n                <?php echo $navbar; ?>\n            </div>\n\n            <div class=\"pull-right\">\n                <?php echo $displayoptions; ?>\n            </div>\n        </div>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"mempool\" class=\"table table-hover table-condensed mempool\">\n            <thead>\n                <tr>\n                    <th data-column-id=\"hostname\">Device</th>\n                    <th data-column-id=\"mempool_descr\"><?php echo $graph_view ? '' : 'Memory' ?></th>\n                    <th data-column-id=\"graph\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                    <th data-column-id=\"mempool_used\" data-searchable=\"false\"><?php echo $graph_view ? '' : 'Used' ?></th>\n                    <th data-column-id=\"mempool_perc\" data-searchable=\"false\"><?php echo $graph_view ? '' : 'Usage' ?></th>\n                </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n    var grid = $(\"#mempool\").bootgrid({\n        ajax: true,\n        rowCount: [50, 100, 250, -1],\n        post: function ()\n        {\n            return {\n                view: '<?php echo htmlspecialchars($vars['view']); ?>'\n            };\n        },\n        url: \"<?php echo url('/ajax/table/mempools'); ?>\"\n    });\n</script>\n", "<?php\n/*\n * LibreNMS\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\n$pagetitle[] = 'Health :: Processor';\n?>\n\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <div class=\"row\" style=\"padding:0px 10px 0px 10px;\">\n            <div class=\"pull-left\">\n                <?php echo $navbar; ?>\n            </div>\n\n            <div class=\"pull-right\">\n                <?php echo $displayoptions; ?>\n            </div>\n        </div>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"processor\" class=\"table table-hover table-condensed processor\">\n            <thead>\n                <tr>\n                    <th data-column-id=\"hostname\">Device</th>\n                    <th data-column-id=\"processor_descr\">Processor</th>\n                    <th data-column-id=\"graph\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                    <th data-column-id=\"processor_usage\" data-searchable=\"false\">Usage</th>\n                </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n    var grid = $(\"#processor\").bootgrid({\n        ajax: true,\n        rowCount: [50,100,250,-1],\n        post: function ()\n        {\n            return {\n                id: \"processor\",\n                view: '<?php echo htmlspecialchars($vars['view']); ?>'\n            };\n        },\n        url: \"ajax_table.php\"\n    });\n</script>\n", "<?php\n/*\n * LibreNMS\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\nswitch ($class) {\n    case 'charge':\n        $pagetitle[] = 'Health :: Charge';\n        break;\n    case 'cooling':\n        $pagetitle[] = 'Health :: Cooling';\n        break;\n    case 'current':\n        $pagetitle[] = 'Health :: Current';\n        break;\n    case 'dbm':\n        $pagetitle[] = 'Health :: dBm';\n        break;\n    case 'fanspeed':\n        $pagetitle[] = 'Health :: Fanspeed';\n        break;\n    case 'frequency':\n        $pagetitle[] = 'Health :: Frequency';\n        break;\n    case 'humidity':\n        $pagetitle[] = 'Health :: Humidity';\n        break;\n    case 'load':\n        $pagetitle[] = 'Health :: Load';\n        break;\n    case 'power':\n        $pagetitle[] = 'Health :: Power';\n        break;\n    case 'pressure':\n        $pagetitle[] = 'Health :: Pressure';\n        break;\n    case 'runtime':\n        $pagetitle[] = 'Health :: Runtime';\n        break;\n    case 'signal':\n        $pagetitle[] = 'Health :: Signal';\n        break;\n    case 'snr':\n        $pagetitle[] = 'Health :: SNR';\n        break;\n    case 'state':\n        $pagetitle[] = 'Health :: State';\n        break;\n    case 'count':\n        $pagetitle[] = 'Health :: Count';\n        break;\n    case 'temperature':\n        $pagetitle[] = 'Health :: Temperature';\n        break;\n    case 'voltage':\n        $pagetitle[] = 'Health :: Voltage';\n        break;\n}\n\n?>\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <div class=\"row\" style=\"padding:0px 10px 0px 10px;\">\n            <div class=\"pull-left\">\n                <?php echo $navbar; ?>\n            </div>\n\n            <div class=\"pull-right\">\n                <?php echo $displayoptions; ?>\n            </div>\n        </div>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"sensors\" class=\"table table-hover table-condensed storage\">\n            <thead>\n            <tr>\n                <th data-column-id=\"hostname\">Device</th>\n                <th data-column-id=\"sensor_descr\">Sensor</th>\n                <th data-column-id=\"graph\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                <th data-column-id=\"alert\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                <th data-column-id=\"sensor_current\">Current</th>\n                <th data-column-id=\"sensor_limit_low\" data-searchable=\"false\">Low Limit</th>\n                <th data-column-id=\"sensor_limit\" data-searchable=\"false\">High Limit</th>\n            </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n    var grid = $(\"#sensors\").bootgrid({\n        ajax: true,\n        rowCount: [50, 100, 250, -1],\n        post: function () {\n            return {\n                id: 'sensors',\n                view: '<?php echo htmlspecialchars($vars['view']); ?>',\n                graph_type: '<?php echo htmlspecialchars($graph_type); ?>',\n                unit: '<?php echo htmlspecialchars($unit); ?>',\n                class: '<?php echo htmlspecialchars($class); ?>'\n            };\n        },\n        url: \"ajax_table.php\"\n    });\n</script>\n", "<?php\n/*\n * LibreNMS\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\n$pagetitle[] = 'Health :: Storage';\n?>\n\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <div class=\"row\" style=\"padding:0px 10px 0px 10px;\">\n            <div class=\"pull-left\">\n                <?php echo $navbar; ?>\n            </div>\n\n            <div class=\"pull-right\">\n                <?php echo $displayoptions; ?>\n            </div>\n        </div>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"storage\" class=\"table table-hover table-condensed storage\">\n            <thead>\n                <tr>\n                    <th data-column-id=\"hostname\">Device</th>\n                    <th data-column-id=\"storage_descr\">Storage</th>\n                    <th data-column-id=\"graph\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                    <th data-column-id=\"storage_used\" data-searchable=\"false\">Used</th>\n                    <th data-column-id=\"storage_perc\" data-searchable=\"false\">Usage</th>\n                </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n    var grid = $(\"#storage\").bootgrid({\n        ajax: true,\n        rowCount: [50, 100, 250, -1],\n        post: function ()\n        {\n            return {\n                id: \"storage\",\n                view: '<?php echo htmlspecialchars($vars['view']); ?>'\n            };\n        },\n        url: \"ajax_table.php\"\n    });\n</script>\n", "<?php\n/*\n * LibreNMS\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\n$pagetitle[] = 'Health :: Toner';\n?>\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <div class=\"row\" style=\"padding:0px 10px 0px 10px;\">\n            <div class=\"pull-left\">\n                <?php echo $navbar; ?>\n            </div>\n\n            <div class=\"pull-right\">\n                <?php echo $displayoptions; ?>\n            </div>\n        </div>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"toner\" class=\"table table-hover table-condensed mempool\">\n            <thead>\n            <tr>\n                <th data-column-id=\"hostname\">Device</th>\n                <th data-column-id=\"supply_descr\">Toner</th>\n                <th data-column-id=\"supply_type\" data-searchable=\"false\">Type</th>\n                <th data-column-id=\"graph\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                <th data-column-id=\"toner_used\" data-searchable=\"false\">Used</th>\n                <th data-column-id=\"supply_current\" data-searchable=\"false\">Usage</th>\n            </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n    var grid = $(\"#toner\").bootgrid({\n        ajax: true,\n        rowCount: [50, 100, 250, -1],\n        post: function ()\n        {\n            return {\n                id: \"toner\",\n                view: '<?php echo htmlspecialchars($vars['view']); ?>'\n            };\n        },\n        url: \"ajax_table.php\"\n    });\n</script>\n", "<?php\n/*\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\nuse Carbon\\Carbon;\nuse LibreNMS\\Config;\n\n$no_refresh = true;\n$param = [];\n$device_id = (int) $vars['device'];\n\n$pagetitle[] = 'Outages';\n?>\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <strong>Outages</strong>\n    </div>\n\n    <?php\n    require_once 'includes/html/common/outages.inc.php';\n    echo implode('', $common_output);\n    ?>\n</div>\n<script>\n    $('.actionBar').append(\n        '<div class=\"pull-left\">' +\n        '<form method=\"post\" action=\"\" class=\"form-inline\" role=\"form\" id=\"result_form\">' +\n        '<?php echo csrf_field() ?>'+\n        '<div class=\"form-group\">' +\n        <?php\n        if (! isset($vars['fromdevice'])) {\n            ?>\n        '<select name=\"device\" id=\"device\" class=\"form-control\">' +\n        '<option value=\"\">All Devices&nbsp;&nbsp;</option>' +\n            <?php\n            if ($device_id) {\n                echo \"'<option value=$device_id>\" . format_hostname(device_by_id_cache($device_id)) . \"</option>' +\";\n            } ?>\n        '</select>' +\n            <?php\n        } else {\n            echo \"'&nbsp;&nbsp;<input type=\\\"hidden\\\" name=\\\"device\\\" id=\\\"device\\\" value=\\\"\" . $device_id . \"\\\">' + \";\n        }\n        ?>\n        '</div>' +\n        '&nbsp;&nbsp;<div class=\"form-group\">' +\n        '<input name=\"from\" type=\"text\" class=\"form-control\" id=\"dtpickerfrom\" maxlength=\"16\" value=\"<?php echo htmlspecialchars($vars['from']); ?>\" placeholder=\"From\" data-date-format=\"YYYY-MM-DD HH:mm\">' +\n        '</div>' +\n        '<div class=\"form-group\">' +\n        '&nbsp;&nbsp;<input name=\"to\" type=\"text\" class=\"form-control\" id=\"dtpickerto\" maxlength=\"16\" value=\"<?php echo htmlspecialchars($vars['to']); ?>\" placeholder=\"To\" data-date-format=\"YYYY-MM-DD HH:mm\">' +\n        '</div>' +\n        '&nbsp;&nbsp;<button type=\"submit\" class=\"btn btn-default\">Filter</button>' +\n        '</form>' +\n        '</div>'\n    );\n\n    $(function () {\n        $(\"#dtpickerfrom\").datetimepicker({\n            icons: {\n                time: 'fa fa-clock-o',\n                date: 'fa fa-calendar',\n                up: 'fa fa-chevron-up',\n                down: 'fa fa-chevron-down',\n                previous: 'fa fa-chevron-left',\n                next: 'fa fa-chevron-right',\n                today: 'fa fa-calendar-check-o',\n                clear: 'fa fa-trash-o',\n                close: 'fa fa-close'\n            },\n            defaultDate: '<?php echo Carbon::now(session('preferences.timezone'))->subMonth()->format(Config::get('dateformat.byminute', 'Y-m-d H:i')); ?>'\n        });\n        $(\"#dtpickerfrom\").on(\"dp.change\", function (e) {\n            $(\"#dtpickerto\").data(\"DateTimePicker\").minDate(e.date);\n        });\n        $(\"#dtpickerto\").datetimepicker({\n            icons: {\n                time: 'fa fa-clock-o',\n                date: 'fa fa-calendar',\n                up: 'fa fa-chevron-up',\n                down: 'fa fa-chevron-down',\n                previous: 'fa fa-chevron-left',\n                next: 'fa fa-chevron-right',\n                today: 'fa fa-calendar-check-o',\n                clear: 'fa fa-trash-o',\n                close: 'fa fa-close'\n            },\n            defaultDate: '<?php echo Carbon::now(session('preferences.timezone'))->format(Config::get('dateformat.byminute', 'Y-m-d H:i')); ?>'\n        });\n        $(\"#dtpickerto\").on(\"dp.change\", function (e) {\n            $(\"#dtpickerfrom\").data(\"DateTimePicker\").maxDate(e.date);\n        });\n        if ($(\"#dtpickerfrom\").val() != \"\") {\n            $(\"#dtpickerto\").data(\"DateTimePicker\").minDate($(\"#dtpickerfrom\").val());\n        }\n        if ($(\"#dtpickerto\").val() != \"\") {\n            $(\"#dtpickerfrom\").data(\"DateTimePicker\").maxDate($(\"#dtpickerto\").val());\n        } else {\n            $(\"#dtpickerto\").data(\"DateTimePicker\").maxDate('<?php echo Carbon::now(session('preferences.timezone'))->format(Config::get('dateformat.byminute', 'Y-m-d H:i')); ?>');\n        }\n    });\n\n    <?php if (! isset($vars['fromdevice'])) { ?>\n    $(\"#device\").select2({\n        theme: \"bootstrap\",\n        dropdownAutoWidth : true,\n        width: \"auto\",\n        allowClear: true,\n        placeholder: \"All Devices\",\n        ajax: {\n            url: '<?php echo url('/ajax/select/device'); ?>',\n            delay: 200\n        }\n    })<?php echo $device_id ? \".val($device_id).trigger('change');\" : ''; ?>;\n    <?php } ?>\n</script>\n\n", "<?php\n/*\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\n$details_visible = var_export($vars['format'] == 'list_detail', 1);\n$errors_visible = var_export($vars['format'] == 'list_detail' || isset($vars['errors']), 1);\n$no_refresh = true;\n$device = DeviceCache::get((int) $vars['device_id']);\n$device_selected = json_encode($device->exists ? ['id' => $device->device_id, 'text' => $device->displayName()] : '');\n$location = \\App\\Models\\Location::find((int) $vars['location']);\n$location_selected = json_encode(! empty($location) ? ['id' => $location->id, 'text' => $location->location] : '');\n\nif (isset($vars['errors'])) {\n    $error_sort = ' data-order=\"desc\"';\n    $sort = '';\n} else {\n    $error_sort = '';\n    $sort = ' data-order=\"asc\"';\n}\n?>\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <?php echo $displayLists; ?>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"ports\" class=\"table table-condensed table-hover table-striped\">\n            <thead>\n            <tr>\n                <th data-column-id=\"hostname\" data-formatter=\"device\">Device</th>\n                <th data-column-id=\"ifDescr\"<?php echo $sort ?> data-formatter=\"port\">Port</th>\n                <th data-column-id=\"secondsIfLastChange\" data-converter=\"duration\">Status Changed</th>\n                <th data-column-id=\"ifConnectorPresent\" data-visible=\"false\">Connected</th>\n                <th data-column-id=\"ifSpeed\" data-converter=\"human-bps\">Speed</th>\n                <th data-column-id=\"ifMtu\" data-visible=\"false\">MTU</th>\n                <th data-column-id=\"ifInOctets_rate\" data-searchable=\"false\" data-css-class=\"green\"\n                    data-converter=\"human-bps\">Down\n                </th>\n                <th data-column-id=\"ifOutOctets_rate\" data-searchable=\"false\" data-css-class=\"blue\"\n                    data-converter=\"human-bps\">Up\n                </th>\n                <th data-column-id=\"ifInUcastPkts_rate\" data-searchable=\"false\"\n                    data-visible=\"<?php echo $details_visible ?>\" data-css-class=\"green\" data-converter=\"human-pps\">\n                    Packets In\n                </th>\n                <th data-column-id=\"ifOutUcastPkts_rate\" data-searchable=\"false\"\n                    data-visible=\"<?php echo $details_visible ?>\" data-css-class=\"blue\" data-converter=\"human-pps\">\n                    Packets Out\n                </th>\n                <th data-column-id=\"ifInErrors_delta\" data-searchable=\"false\" data-visible=\"<?php echo $errors_visible ?>\"\n                    data-css-class=\"red\"<?php echo $error_sort ?>>Errors In\n                </th>\n                <th data-column-id=\"ifOutErrors_delta\" data-searchable=\"false\" data-visible=\"<?php echo $errors_visible ?>\"\n                    data-css-class=\"red\">Errors Out\n                </th>\n                <th data-column-id=\"ifType\">Media</th>\n                <th data-column-id=\"ifAlias\">Description</th>\n                <th data-column-id=\"actions\" data-sortable=\"false\" data-searchable=\"false\">Actions</th>\n            </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n\nfunction formatUnits(units,decimals,display,base) {\n    if(!units) return '';\n    if(display === undefined) display = ['bps', 'Kbps', 'Mbps', 'Gbps', 'Tbps', 'Pbps', 'Ebps', 'Zbps', 'Ybps'];\n    if(units == 0) return units + display[0];\n    base = base || 1000; // or 1024 for binary\n    var dm = decimals || 2;\n    var i = Math.floor(Math.log(units) / Math.log(base));\n    return parseFloat((units / Math.pow(base, i)).toFixed(dm)) + display[i];\n}\n\nvar grid = $(\"#ports\").bootgrid({\n    ajax: true,\n    rowCount: [50, 100, 250, -1],\n    converters: {\n        'duration': {\n            to: function (value) { return moment.duration(value, 'seconds').humanize(); }\n        },\n        'human-bps': {\n            to: function (value) { return formatUnits(value); }\n        },\n        'human-pps': {\n            to: function (value) {\n                return formatUnits(value, 2, ['pps', 'Kpps', 'Mpps', 'Gpps', 'Tpps', 'Ppps', 'Epps', 'Zpps', 'Ypps']);\n            }\n        }\n    },\n    formatters: {\n      'device': function (column, row) {\n          return \"<span class='alert-status \" + row.status + \"' style='float:left;margin-right:10px;'></span>\" + row.device + \"\";\n      },\n      'port': function (column, row) {\n          return row.port\n      }\n    },\n    templates: {\n        search: \"\" // hide the generic search\n    },\n    post: function ()\n    {\n        return {\n            device_id: '<?php echo htmlspecialchars($vars['device_id'] ?? ''); ?>',\n            hostname: '<?php echo htmlspecialchars($vars['hostname'] ?? ''); ?>',\n            state: '<?php echo htmlspecialchars($vars['state'] ?? ''); ?>',\n            ifSpeed: '<?php echo htmlspecialchars($vars['ifSpeed'] ?? ''); ?>',\n            ifType: '<?php echo htmlspecialchars($vars['ifType'] ?? ''); ?>',\n            port_descr_type: '<?php echo htmlspecialchars($vars['port_descr_type'] ?? ''); ?>',\n            ifAlias: '<?php echo htmlspecialchars($vars['ifAlias'] ?? ''); ?>',\n            location: '<?php echo htmlspecialchars($vars['location'] ?? '') ?>',\n            disabled: '<?php echo htmlspecialchars($vars['disabled'] ?? ''); ?>',\n            ignore: '<?php echo htmlspecialchars($vars['ignore'] ?? ''); ?>',\n            deleted: '<?php echo htmlspecialchars($vars['deleted'] ?? ''); ?>',\n            errors: '<?php echo htmlspecialchars($vars['errors'] ?? ''); ?>',\n            group: '<?php echo htmlspecialchars($vars['group'] ?? ''); ?>',\n            devicegroup: '<?php echo htmlspecialchars($vars['devicegroup'] ?? ''); ?>',\n        };\n    },\n    url: '<?php echo route('table.ports') ?>'\n});\n\n$(\".actionBar\").append(\"<div class=\\\"pull-left\\\"><?php echo $output; ?></div>\");\n\ninit_select2('#device_id', 'device', {}, <?php echo $device_selected ?>, 'All Devices');\ninit_select2('#location', 'location', {}, <?php echo $location_selected ?>, 'All Locations');\n\n</script>\n", "<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <strong>FDB Entries</strong>\n    </div>\n    <table id=\"fdb-search\" class=\"table table-hover table-condensed table-striped\">\n        <thead>\n            <tr>\n                <th data-column-id=\"device\">Device</th>\n                <th data-column-id=\"mac_address\" data-width=\"150px\" data-formatter=\"tooltip\">MAC Address</th>\n<?php\nif (\\LibreNMS\\Config::get('mac_oui.enabled') === true) {\n    echo '                <th data-column-id=\"mac_oui\" data-sortable=\"false\" data-width=\"150px\" data-visible=\"false\" data-formatter=\"tooltip\">Vendor</th>';\n}\n?>\n                <th data-column-id=\"ipv4_address\" data-sortable=\"false\" data-formatter=\"tooltip\">IPv4 Address</th>\n                <th data-column-id=\"interface\">Port</th>\n                <th data-column-id=\"vlan\" data-width=\"60px\">Vlan</th>\n                <th data-column-id=\"description\" data-formatter=\"tooltip\">Description</th>\n                <th data-column-id=\"dnsname\" data-sortable=\"false\" data-visible=\"false\" data-formatter=\"tooltip\">DNS Name</th>\n                <th data-column-id=\"first_seen\" data-width=\"165px\">First seen</th>\n                <th data-column-id=\"last_seen\" data-width=\"165px\">Last seen</th>\n            </tr>\n        </thead>\n    </table>\n</div>\n\n<script>\n\nvar grid = $(\"#fdb-search\").bootgrid({\n    ajax: true,\n    rowCount: [50, 100, 250, -1],\n    templates: {\n        header: \"<div id=\\\"{{ctx.id}}\\\" class=\\\"{{css.header}}\\\"><div class=\\\"row\\\">\"+\n                \"<div class=\\\"col-sm-9 actionBar\\\"><span class=\\\"pull-left\\\">\"+\n                \"<form method=\\\"post\\\" action=\\\"\\\" class=\\\"form-inline\\\" role=\\\"form\\\">\"+\n                \"<?php echo addslashes(csrf_field()) ?>\"+\n                \"<div class=\\\"form-group\\\">\"+\n                \"<select name=\\\"device_id\\\" id=\\\"device_id\\\" class=\\\"form-control input-sm\\\">\"+\n                \"<option value=\\\"\\\">All Devices</option>\"+\n<?php\n\n// Select the devices only with FDB tables\n$sql = 'SELECT D.device_id AS device_id, `hostname`, `sysName`, `display` FROM `ports_fdb` AS F, `ports` AS P, `devices` AS D';\n$param = [];\n\nif (! Auth::user()->hasGlobalRead()) {\n    $device_ids = Permissions::devicesForUser()->toArray() ?: [0];\n    $where .= ' AND `D`.`device_id` IN ' . dbGenPlaceholders(count($device_ids));\n    $param = array_merge($param, $device_ids);\n}\n\n$sql .= \" WHERE F.port_id = P.port_id AND P.device_id = D.device_id $where GROUP BY `D`.`device_id`, `D`.`hostname` ORDER BY `hostname`\";\nforeach (dbFetchRows($sql, $param) as $data) {\n    echo '\"<option value=\\\"' . $data['device_id'] . '\\\"\"+';\n    if ($data['device_id'] == $vars['device_id']) {\n        echo '\" selected \"+';\n    }\n\n    echo '\">' . format_hostname($data) . '</option>\"+';\n}\n?>\n                \"</select>\"+\n                \"</div>\"+\n                \"<div class=\\\"form-group\\\">\"+\n                \"<select name=\\\"searchby\\\" id=\\\"searchby\\\" class=\\\"form-control input-sm\\\">\"+\n                \"<option value=\\\"mac\\\" \"+\n<?php\nif ($vars['searchby'] == 'mac') {\n    echo '\" selected \"+';\n}\n?>\n\n                \">MAC Address</option>\"+\n                \"<option value=\\\"ip\\\" \"+\n<?php\nif ($vars['searchby'] == 'ip') {\n    echo '\" selected \"+';\n}\n?>\n\n                \">IP Address</option>\"+\n                \"<option value=\\\"dnsname\\\" \"+\n<?php\nif ($vars['searchby'] == 'dnsname') {\n    echo '\" selected \"+';\n}\n?>\n\n                \">DNS Name</option>\"+\n                \"<option value=\\\"description\\\" \"+\n<?php\nif ($vars['searchby'] == 'description') {\n    echo '\" selected \"+';\n}\n?>\n\n                \">Description</option>\"+\n                \"<option value=\\\"vendor\\\" \"+\n<?php\nif ($vars['searchby'] == 'vendor') {\n    echo '\" selected \"+';\n}\n?>\n\n                \">Vendor</option>\"+\n                \"<option value=\\\"vlan\\\" \"+\n<?php\nif ($vars['searchby'] == 'vlan') {\n    echo '\" selected \"+';\n}\n?>\n\n                \">Vlan</option>\"+\n                \"</select>\"+\n                \"</div>\"+\n                \"<div class=\\\"form-group\\\">\"+\n                \"<input type=\\\"text\\\" name=\\\"searchPhrase\\\" id=\\\"address\\\" value=\\\"\"+\n<?php\necho '\"' . $vars['searchPhrase'] . '\"+';\n?>\n\n                \"\\\" class=\\\"form-control input-sm\\\" placeholder=\\\"Value\\\" />\"+\n                \"</div>\"+\n                \"<button type=\\\"submit\\\" class=\\\"btn btn-default input-sm\\\">Search</button>\"+\n                \"</form></span></div>\"+\n               \"<div class=\\\"col-sm-3 actionBar\\\"><p class=\\\"{{css.actions}}\\\"></p></div></div></div>\"\n    },\n    post: function ()\n    {\n        return {\n            device_id: '<?php echo htmlspecialchars($vars['device_id']); ?>',\n            searchby: '<?php echo htmlspecialchars($vars['searchby']); ?>',\n            searchPhrase: '<?php echo htmlspecialchars($vars['searchPhrase']); ?>',\n            dns: $(\"#fdb-search\").bootgrid(\"getColumnSettings\").find(col => col.id === \"dnsname\").visible,\n        };\n    },\n    url: \"<?php echo url('/ajax/table/fdb-tables'); ?>\",\n    formatters: {\n        \"tooltip\": function (column, row) {\n                var value = row[column.id];\n                var vendor = '';\n                if (column.id == 'mac_address' && ((vendor = row['mac_oui']) != '' )) {\n                    return \"<span title=\\'\" + value + \" (\" + vendor + \")\\' data-toggle=\\'tooltip\\'>\" + value + \"</span>\";\n                }\n                return \"<span title=\\'\" + value + \"\\' data-toggle=\\'tooltip\\'>\" + value + \"</span>\";\n            },\n    },\n});\n\n</script>\n", "<?php\n/*\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\nuse Carbon\\Carbon;\nuse LibreNMS\\Config;\n\n$no_refresh = true;\n$param = [];\n$device_id = (int) $vars['device'];\n\nif (isset($vars['action']) && $vars['action'] == 'expunge' && \\Auth::user()->hasGlobalAdmin()) {\n    dbQuery('TRUNCATE TABLE `syslog`');\n    print_message('syslog truncated');\n}\n\n$pagetitle[] = 'Syslog';\n?>\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <strong>Syslog</strong>\n    </div>\n\n    <?php\n    require_once 'includes/html/common/syslog.inc.php';\n    echo implode('', $common_output);\n    ?>\n</div>\n<script>\n    $('.actionBar').append(\n        '<div class=\"pull-left\">' +\n        '<form method=\"post\" action=\"\" class=\"form-inline\" role=\"form\" id=\"result_form\">' +\n        '<?php echo csrf_field() ?>'+\n        '<div class=\"form-group\">' +\n        <?php\n        if (! isset($vars['fromdevice'])) {\n            ?>\n        '<select name=\"device\" id=\"device\" class=\"form-control\">' +\n        '<option value=\"\">All Devices&nbsp;&nbsp;</option>' +\n            <?php\n            if ($device_id) {\n                echo \"'<option value=$device_id>\" . format_hostname(device_by_id_cache($device_id)) . \"</option>' +\";\n            } ?>\n        '</select>' +\n            <?php\n        } else {\n            echo \"'&nbsp;&nbsp;<input type=\\\"hidden\\\" name=\\\"device\\\" id=\\\"device\\\" value=\\\"\" . $device_id . \"\\\">' + \";\n        }\n        ?>\n        '</div>' +\n        '&nbsp;&nbsp;<div class=\"form-group\">' +\n        '<select name=\"program\" id=\"program\" class=\"form-control\">' +\n        '<option value=\"\">All Programs&nbsp;&nbsp;</option>' +\n        <?php\n        if (! empty($vars['program'])) {\n            $js_program = addcslashes(htmlentities($vars['program']), \"'\");\n            echo \"'<option value=\\\"$js_program\\\">$js_program</option>' +\";\n        }\n        ?>\n        '</select>' +\n        '</div>' +\n        '&nbsp;&nbsp;<div class=\"form-group\">' +\n        '<select name=\"priority\" id=\"priority\" class=\"form-control\">' +\n        '<option value=\"\">All Priorities</option>' +\n        <?php\n        if (! empty($vars['priority'])) {\n            $js_priority = addcslashes(htmlentities($vars['priority']), \"'\");\n            echo \"'<option value=\\\"$js_priority\\\">$js_priority</option>' +\";\n        }\n        ?>\n        '</select>' +\n        '</div>' +\n        '&nbsp;&nbsp;<div class=\"form-group\">' +\n        '<input name=\"from\" type=\"text\" class=\"form-control\" id=\"dtpickerfrom\" maxlength=\"16\" value=\"<?php echo htmlspecialchars($vars['from'] ?? ''); ?>\" placeholder=\"From\" data-date-format=\"YYYY-MM-DD HH:mm\">' +\n        '</div>' +\n        '<div class=\"form-group\">' +\n        '&nbsp;&nbsp;<input name=\"to\" type=\"text\" class=\"form-control\" id=\"dtpickerto\" maxlength=\"16\" value=\"<?php echo htmlspecialchars($vars['to'] ?? ''); ?>\" placeholder=\"To\" data-date-format=\"YYYY-MM-DD HH:mm\">' +\n        '</div>' +\n        '&nbsp;&nbsp;<button type=\"submit\" class=\"btn btn-default\">Filter</button>' +\n        '</form>' +\n        '</div>' +\n        '</div>' +\n        '</div>' +\n        '</div>'\n    );\n\n    $(function () {\n        $(\"#dtpickerfrom\").datetimepicker({\n            icons: {\n                time: 'fa fa-clock-o',\n                date: 'fa fa-calendar',\n                up: 'fa fa-chevron-up',\n                down: 'fa fa-chevron-down',\n                previous: 'fa fa-chevron-left',\n                next: 'fa fa-chevron-right',\n                today: 'fa fa-calendar-check-o',\n                clear: 'fa fa-trash-o',\n                close: 'fa fa-close'\n            },\n            defaultDate: '<?php echo Carbon::now()->subDay()->format(Config::get('dateformat.byminute', 'Y-m-d H:i')); ?>'\n        });\n        $(\"#dtpickerfrom\").on(\"dp.change\", function (e) {\n            $(\"#dtpickerto\").data(\"DateTimePicker\").minDate(e.date);\n        });\n        $(\"#dtpickerto\").datetimepicker({\n            icons: {\n                time: 'fa fa-clock-o',\n                date: 'fa fa-calendar',\n                up: 'fa fa-chevron-up',\n                down: 'fa fa-chevron-down',\n                previous: 'fa fa-chevron-left',\n                next: 'fa fa-chevron-right',\n                today: 'fa fa-calendar-check-o',\n                clear: 'fa fa-trash-o',\n                close: 'fa fa-close'\n            }\n        });\n        $(\"#dtpickerto\").on(\"dp.change\", function (e) {\n            $(\"#dtpickerfrom\").data(\"DateTimePicker\").maxDate(e.date);\n        });\n        if ($(\"#dtpickerfrom\").val() != \"\") {\n            $(\"#dtpickerto\").data(\"DateTimePicker\").minDate($(\"#dtpickerfrom\").val());\n        }\n        if ($(\"#dtpickerto\").val() != \"\") {\n            $(\"#dtpickerfrom\").data(\"DateTimePicker\").maxDate($(\"#dtpickerto\").val());\n        } else {\n            $(\"#dtpickerto\").data(\"DateTimePicker\").maxDate('<?php echo Carbon::now()->format(Config::get('dateformat.byminute', 'Y-m-d H:i')); ?>');\n        }\n    });\n\n    <?php if (! isset($vars['fromdevice'])) { ?>\n    $(\"#device\").select2({\n        theme: \"bootstrap\",\n        dropdownAutoWidth : true,\n        width: \"auto\",\n        allowClear: true,\n        placeholder: \"All Devices\",\n        ajax: {\n            url: '<?php echo url('/ajax/select/device'); ?>',\n            delay: 200\n        }\n    })<?php echo $device_id ? \".val($device_id).trigger('change');\" : ''; ?>;\n    <?php } ?>\n\n    $(\"#program\").select2({\n        theme: \"bootstrap\",\n        dropdownAutoWidth : true,\n        width: \"auto\",\n        allowClear: true,\n        placeholder: \"All Programs\",\n        ajax: {\n            url: '<?php echo url('/ajax/select/syslog'); ?>',\n            delay: 200,\n            data: function(params) {\n                return {\n                    field: \"program\",\n                    device: $('#device').val(),\n                    term: params.term,\n                    page: params.page || 1\n                }\n            }\n        }\n    })<?php echo isset($vars['program']) ? \".val('\" . addcslashes($vars['program'], \"'\") . \"').trigger('change');\" : ''; ?>;\n\n    $(\"#priority\").select2({\n        theme: \"bootstrap\",\n        dropdownAutoWidth : true,\n        width: \"auto\",\n        allowClear: true,\n        placeholder: \"All Priorities\",\n        ajax: {\n            url: '<?php echo url('/ajax/select/syslog'); ?>',\n            delay: 200,\n            data: function(params) {\n                return {\n                    field: \"priority\",\n                    device: $('#device').val(),\n                    term: params.term,\n                    page: params.page || 1\n                }\n            }\n        }\n    })<?php echo isset($vars['priority']) ? \".val('\" . addcslashes($vars['priority'], \"'\") . \"').trigger('change');\" : ''; ?>;\n</script>\n\n", "<?php\n/*\n * LibreNMS\n *\n * This program is free software: you can redistribute it and/or modify it\n * under the terms of the GNU General Public License as published by the\n * Free Software Foundation, either version 3 of the License, or (at your\n * option) any later version.  Please see LICENSE.txt at the top level of\n * the source code distribution for details.\n *\n * @package    LibreNMS\n * @subpackage webui\n * @link       https://www.librenms.org\n * @copyright  2017 LibreNMS\n * @author     LibreNMS Contributors\n*/\n\n?>\n<div class=\"panel panel-default panel-condensed\">\n    <div class=\"panel-heading\">\n        <div class=\"row\" style=\"padding:0px 10px 0px 10px;\">\n        <div class=\"pull-left\">\n            <?php echo $linkoptions; ?>\n        </div>\n        <div class=\"pull-right\">\n            <?php echo $displayoptions; ?>\n        </div>\n        </div>\n    </div>\n    <div class=\"table-responsive\">\n        <table id=\"sensors\" class=\"table table-hover table-condensed storage\">\n            <thead>\n                <tr>\n                    <th data-column-id=\"hostname\">Device</th>\n                    <th data-column-id=\"sensor_descr\">Sensor</th>\n                    <th data-column-id=\"graph\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                    <th data-column-id=\"alert\" data-sortable=\"false\" data-searchable=\"false\"></th>\n                    <th data-column-id=\"sensor_current\">Current</th>\n                    <th data-column-id=\"sensor_limit_low\" data-searchable=\"false\">Low Limit</th>\n                    <th data-column-id=\"sensor_limit\" data-searchable=\"false\">High Limit</th>\n                </tr>\n            </thead>\n        </table>\n    </div>\n</div>\n<script>\n    var grid = $(\"#sensors\").bootgrid({\n        ajax: true,\n        rowCount: [50, 100, 250, -1],\n        post: function ()\n        {\n            return {\n                id:         'wireless-sensors',\n                view:       '<?php echo htmlspecialchars($vars['view']); ?>',\n                graph_type: '<?php echo htmlspecialchars($graph_type); ?>',\n                unit:       '<?php echo htmlspecialchars($unit); ?>',\n                class:      '<?php echo htmlspecialchars($class); ?>'\n            };\n        },\n        url: \"ajax_table.php\"\n    });\n</script>\n"], "filenames": ["includes/html/pages/apps/ntp.inc.php", "includes/html/pages/device/port/realtime.inc.php", "includes/html/pages/health/mempool.inc.php", "includes/html/pages/health/processor.inc.php", "includes/html/pages/health/sensors.inc.php", "includes/html/pages/health/storage.inc.php", "includes/html/pages/health/toner.inc.php", "includes/html/pages/outages.inc.php", "includes/html/pages/ports/list.inc.php", "includes/html/pages/search/fdb.inc.php", "includes/html/pages/syslog.inc.php", "includes/html/pages/wireless/sensors.inc.php"], "buggy_code_start_loc": [100, 38, 56, 54, 108, 55, 55, 58, 116, 131, 85, 54], "buggy_code_end_loc": [102, 40, 57, 55, 112, 56, 56, 62, 130, 134, 89, 58], "fixing_code_start_loc": [100, 38, 56, 54, 108, 55, 55, 58, 116, 131, 85, 54], "fixing_code_end_loc": [102, 40, 57, 55, 112, 56, 56, 62, 130, 134, 89, 58], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Reflected in GitHub repository librenms/librenms prior to 23.8.0.", "other": {"cve": {"id": "CVE-2023-4347", "sourceIdentifier": "security@huntr.dev", "published": "2023-08-15T02:15:48.093", "lastModified": "2023-08-22T01:22:29.127", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Reflected in GitHub repository librenms/librenms prior to 23.8.0."}, {"lang": "es", "value": "Cross-site Scripting (XSS) - Reflejado en el repositorio GitHub librenms/librenms anterior a 23.8.0."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 7.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.7}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:librenms:librenms:*:*:*:*:*:*:*:*", "versionEndExcluding": "23.8.0", "matchCriteriaId": "0D4BC1C6-7A0C-4201-AF67-2EDBD8038606"}]}]}], "references": [{"url": "https://github.com/librenms/librenms/commit/91c57a1ee54631e071b6b0c952d99c8ee892e824", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.dev/bounties/1f78c6e1-2923-46c5-9376-4cc5a8f1152f", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/librenms/librenms/commit/91c57a1ee54631e071b6b0c952d99c8ee892e824"}}