{"buggy_code": ["<?php if( isset($t->data[ 'params'][ \"cs\" ]) ): ?>\n    <div>\n        <h2>\n            Ports for Console Server: <?= $t->data[ 'params'][ \"css\" ][$t->data[ 'params'][ \"cs\" ] ][ 'name' ] ?><br><br>\n        </h2>\n    </div>\n<?php endif;?>", "<?php if( !isset( $t->feParams->readonly ) || !$t->feParams->readonly ): ?>\n    <div class=\"btn-group btn-group-sm\" role=\"group\">\n        <div class=\"btn-group btn-group-sm\">\n            <button type=\"button\" class=\"btn btn-white dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <?= isset( $t->data[ 'params'][ \"cs\" ] ) ? $t->data[ 'params'][ \"css\" ][$t->data[ 'params'][ \"cs\" ] ][ 'name' ] : \"All Console Server Ports\" ?> <span class=\"caret\"></span>\n            </button>\n\n            <div class=\"dropdown-menu dropdown-menu-right scrollable-dropdown\">\n                <a class=\"dropdown-item <?= isset($t->data[ 'params'][ \"cs\" ]) ? \"\" : \"active\" ?>\" href=\"<?= route( \"console-server-connection@list\" ) ?>\">\n                    All Console Server Ports\n                </a>\n                <div class=\"dropdown-divider\"></div>\n                <?php foreach( $t->data[ 'params'][ \"css\" ] as $css ): ?>\n                    <a class=\"dropdown-item <?= isset( $t->data[ 'params'][ \"cs\" ] ) && $t->data[ 'params'][ \"cs\" ] === $css[ 'id' ] ? 'active' : '' ?>\" href=\"<?= route( \"console-server-connection@listPort\", [ \"cs\" => $css[ 'id' ] ] ) ?>\"><?= $css[ 'name' ] ?></a>\n                <?php endforeach; ?>\n            </div>\n        </div>\n\n        <a  class=\"btn btn-white\" href=\"<?= route($t->feParams->route_prefix.'@create' ) ?><?= isset( $t->data[ 'params'][ \"cs\" ] ) ? \"?console_server_id=\" . $t->data[ 'params'][ \"cs\" ] : \"\"  ?>\">\n            <i class=\"fa fa-plus\"></i>\n        </a>\n    </div>\n<?php endif;?>", "<?php\n    $privs          = Auth::getUser()->privs();\n    $isSuperUser    = $privs === \\IXP\\Models\\User::AUTH_SUPERUSER;\n    $isCustAdmin    = $privs === \\IXP\\Models\\User::AUTH_CUSTADMIN;\n?>\n\n<div class=\"card\">\n    <div class=\"card-body\">\n        <?= Former::open()->method( $t->data['params']['isAdd'] ? 'POST' : 'PUT'  )\n            ->id( 'form' )\n            ->action( $t->data['params']['isAdd'] ? route( $t->feParams->route_prefix . '@store' ) : route($t->feParams->route_prefix . '@update', [ 'id' => $t->data[ 'params'][ 'object']->id ] ) )\n            ->customInputWidthClass( 'col-sm-6 col-md-6 col-lg-8 col-xl-6' )\n            ->customLabelWidthClass( 'col-sm-2 col-md-2 col-lg-3 text-xs-center' )\n            ->actionButtonsCustomClass( \"grey-box\")\n        ?>\n        <?php\n            $checkedRoles = [];\n            if( old( 'roles' ) !== null ) {\n                $checkedRoles = array_values( old( 'roles' ) );\n            } else {\n                $checkedRoles = array_keys( $t->data[ 'params' ][ 'groupsForContact' ] );\n            }\n        ?>\n\n        <div class=\"row\">\n            <div class=\"col-lg-6\">\n                <?= Former::text( 'name' )\n                    ->label( 'Name' )\n                    ->placeholder( 'Firstname Lastname' )\n                    ->blockHelp( \"The full name of the contact.\" );\n                ?>\n\n                <?= Former::text( 'position' )\n                    ->label( 'Position' )\n                    ->placeholder( 'Senior Network Engineer' )\n                    ->blockHelp( \"The contact's job title / position.\" );\n                ?>\n\n                <?php if( $isSuperUser ):?>\n                    <?= Former::select( 'custid' )\n                        ->id( 'cust' )\n                        ->label( ucfirst( config( 'ixp_fe.lang.customer.one' ) ) )\n                        ->placeholder( 'Select a ' . config( 'ixp_fe.lang.customer.one' ) )\n                        ->fromQuery( $t->data[ 'params'][ 'custs' ], 'name' )\n                        ->addClass( 'chzn-select' )\n                        ->blockHelp( ucfirst( config( 'ixp_fe.lang.customer.one' ) )  . ' to assign this contact to.' );\n                    ?>\n                <?php endif; ?>\n\n                <?= Former::text( 'email' )\n                    ->label( 'Email' )\n                    ->placeholder( 'firstname.lastname@example.com' )\n                    ->blockHelp( \"Email address of the contact.\" );\n                ?>\n\n                <?= Former::text( 'phone' )\n                    ->label( 'Phone' )\n                    ->placeholder( config( 'ixp_fe.customer.form.placeholders.phone' ) )\n                    ->blockHelp( \"Office / landline phone number of the contact.\" );\n                ?>\n\n                <?= Former::text( 'mobile' )\n                    ->label( 'Mobile' )\n                    ->placeholder( config( 'ixp_fe.customer.form.placeholders.phone' ) )\n                    ->blockHelp( \"Mobile phone / cell number of the contact.\" );\n                ?>\n            </div>\n\n            <div class=\"col-lg-6\">\n                <div class=\"form-group row\" >\n                    <?php if( $t->data[ 'params'][ \"allGroups\" ] && isset( $t->data[ 'params'][ \"allGroups\" ][ 'ROLE' ] ) ): ?>\n                        <div class=\"collapse\">\n                            <label class=\"control-label col-lg-3 col-sm-3\">&nbsp;\n                                Role&nbsp;\n                            </label>\n                        </div>\n                        <div>\n                            <?php foreach( $t->data[ 'params'][ \"allGroups\" ][ 'ROLE' ] as $role ): ?>\n                                <div class=\"form-group row\">\n                                    <div class=\"col-sm-6 col-md-6 col-lg-8 col-xl-6\">\n                                        <div class=\"form-check form-check-inline\">\n                                            <input id='role_<?= $role[ 'id' ] ?>' type='checkbox' name='roles[]' <?= in_array( $role[ 'id' ], $checkedRoles, false ) ? 'checked' : '' ?> value='<?= $role[ 'id' ] ?>'>\n                                            <label for=\"role_<?= $role[ 'id' ] ?>\" class=\"form-check-label\">\n                                                <?= $role[ 'name' ] ?>\n                                            </label>\n                                        </div>\n                                    </div>\n                                </div>\n                            <?php endforeach; ?>\n                        </div>\n                    <?php endif; ?>\n                </div>\n\n                <?php if( !$isCustAdmin ): ?>\n                    <div class=\"form-group col-sm-12\">\n                        <div class=\"card mt-4\">\n                            <div class=\"card-header\">\n                                <ul class=\"nav nav-tabs card-header-tabs\">\n                                    <li role=\"presentation\" class=\"nav-item\">\n                                        <a class=\"tab-link-body-note nav-link active\" href=\"#body\">Notes</a>\n                                    </li>\n                                    <li role=\"presentation\" class=\"nav-item\">\n                                        <a class=\"tab-link-preview-note nav-link\" href=\"#preview\">Preview</a>\n                                    </li>\n                                </ul>\n                            </div>\n\n                            <div class=\"tab-content card-body\">\n                                <div role=\"tabpanel\" class=\"tab-pane show active\" id=\"body\">\n                                    <?= Former::textarea( 'notes' )\n                                        ->id( 'notes' )\n                                        ->label( '' )\n                                        ->rows( 10 )\n                                    ?>\n                                </div>\n                                <div role=\"tabpanel\" class=\"tab-pane\" id=\"preview\">\n                                    <div class=\"bg-light p-4 well-preview\">\n                                        Loading...\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                <?php endif; ?>\n\n                <?php if( $isSuperUser ): ?>\n                    <?php if( ( $t->data[ 'params' ][ \"allGroups\" ] && count( $t->data[ 'params' ][ \"allGroups\" ] ) > 1 ) || ( count( $t->data[ 'params'][ \"allGroups\" ] ) == 1 && !isset( $t->data[ 'params'][ \"allGroups\" ]['ROLE'] ) ) ): ?>\n                        <div class=\"form-group\">\n                            <label for=\"mayauthorize\" class=\"control-label col-lg-2 col-sm-4\">&nbsp;Groups&nbsp;</label>\n                            <table class=\"table table-no-border\">\n                                <?php foreach( $t->data[ 'params'][ \"allGroups\" ] as $gname => $gvalue ): ?>\n                                    <?php if( $gname !== \"ROLE\" && config('contact_group.types.' . $gname ) ): ?>\n                                        <tr>\n                                            <td>\n                                                <label for=\"mayauthorize\" class=\"control-label col-lg-2 col-sm-4\" style=\"display: grid\">&nbsp;<?= $gname ?>&nbsp;</label>\n                                            </td>\n\n                                            <?php foreach( $gvalue as $ggroup ): ?>\n                                                <td>\n                                                    <div class=\"form-group row\">\n                                                        <div class=\"col-sm-6 col-md-6 col-lg-8 col-xl-6\">\n                                                            <div class=\"form-check form-check-inline\">\n                                                                <input id='role_<?= $ggroup[ 'id' ] ?>' type='checkbox' <?= in_array( $ggroup[ 'id' ], $checkedRoles, false ) ? 'checked' : '' ?> name='roles[]' value='<?= $ggroup[ 'id' ] ?>'>\n                                                                <label for=\"role_<?= $ggroup[ 'id' ] ?>\" class=\"form-check-label\">\n                                                                    <?= $ggroup[ 'name' ] ?>\n                                                                </label>\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                                </td>\n                                            <?php endforeach; ?>\n                                        </tr>\n                                    <?php endif; ?>\n                                <?php endforeach; ?>\n                            </table>\n                        </div>\n                    <?php endif; ?>\n                <?php endif; ?>\n            </div>\n        </div>\n\n            <?php\n                // need to figure out where the cancel button foes. shouldn't be this hard :-(\n                $redirect = session()->get( 'contact_post_store_redirect' );\n\n                if( $redirect === 'contact@list' || $redirect === 'contact@add' ) {\n                        $cancel_url = route('contact@list' );\n                } else {\n                    $custid = null;\n                    if( isset( $t->data[ 'params'][ 'object'] ) && $t->data[ 'params'][ 'object'] instanceof \\IXP\\Models\\ContactGroup ) {\n                        $custid = $t->data[ 'params'][ 'object']->custid;\n                    } else if( session()->get( 'contact_post_store_redirect_cid', null ) !== null ) {\n                        $custid = session()->get( 'contact_post_store_redirect_cid' );\n                    }\n\n                    if( $custid !== null ) {\n                        $cancel_url = route( 'customer@overview', [ 'cust' => $custid,  \"tab\" => \"contacts\" ] );\n                    } else {\n                        $cancel_url = route( 'contact@list' );\n                    }\n                }\n            ?>\n\n            <?= Former::actions(\n                Former::primary_submit( $t->data['params']['isAdd'] ? 'Create' : 'Save Changes' )->class( \"mb-2 mb-sm-0\" ),\n                Former::secondary_link( 'Cancel' )->href( $cancel_url )->class( \"mb-2 mb-sm-0\" ),\n                Former::success_button( 'Help' )->id( 'help-btn' )->class( \"mb-2 mb-sm-0\" )\n            ); ?>\n        <?= Former::close() ?>\n    </div>\n</div>", "<?php if( !isset( $t->feParams->readonly ) || !$t->feParams->readonly ): ?>\n    <div class=\"btn-group btn-group-sm\" role=\"group\">\n        <?php if( isset( $t->feParams->documentation ) && $t->feParams->documentation ): ?>\n            <a target=\"_blank\" class=\"btn btn-white\" href=\"<?= $t->feParams->documentation ?>\">\n                Documentation\n            </a>\n        <?php endif; ?>\n\n        <?php if( config('contact_group.types.ROLE') ): ?>\n            <button type=\"button\" class=\"btn btn-white dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <?= isset( $t->data[ 'params'][ \"role\" ] ) ? $t->data[ 'params'][ \"roles\" ][ $t->data[ 'params'][ \"role\" ] ][ 'name']  : \"All Roles\" ?>\n            </button>\n            <ul class=\"dropdown-menu dropdown-menu-right\">\n                <a class=\"dropdown-item <?= isset( $t->data[ 'params'][ \"role\" ]) ?: \"active\" ?>\" href=\"<?= route( $t->feParams->route_prefix . \"@list\" ) ?>\">\n                    All Roles\n                </a>\n\n                <div class=\"dropdown-divider\"></div>\n\n                <?php foreach( $t->data[ 'params'][ \"roles\" ] as $index => $role ): ?>\n                    <a class=\"dropdown-item <?= isset($t->data[ 'params'][ \"role\" ]) && (int)$t->data[ 'params'][ \"role\" ] === $role[ 'id'] ? 'active' : '' ?>\" href=\"<?= route( $t->feParams->route_prefix . \"@list\" ) ?>?role=<?= $role[ 'id' ] ?>\">\n                        <?= $role[ 'name' ] ?>\n                    </a>\n                <?php endforeach; ?>\n            </ul>\n        <?php endif;?>\n\n        <a class=\"btn btn-white\" href=\"<?= route($t->feParams->route_prefix.'@create' ) ?>\">\n            <span class=\"fa fa-plus\"></span>\n        </a>\n    </div>\n<?php endif;?>", "<?php\n    /** @var Foil\\Template\\Template $t */\n    $this->layout( 'layouts/ixpv4' );\n\n    /** @var \\IXP\\Models\\Customer $c */\n    $c = $t->c;\n    $user = Auth::getUser();\n    $isSuperUser = $user->isSuperUser();\n    $logo = $c->logo;\n?>\n\n<?php $this->section( 'page-header-postamble' ) ?>\n    <div class=\"btn-group btn-group-sm ml-auto\" role=\"group\" aria-label=\"...\">\n        <a class=\"btn btn-white\" href=\"<?= route('statistics@member', [ 'cust' => $c->id ] ) ?>\">\n            Port Graphs\n        </a>\n        <div class=\"btn-group btn-group-sm\">\n            <button class=\"btn btn-white dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <i class=\"fa fa-cog\"></i>\n            </button>\n            <div class=\"dropdown-menu dropdown-menu-right\">\n                <a class=\"dropdown-item\" href=\"<?= route( 'virtual-interface@create-wizard-for-cust', [ 'cust' => $c->id ] ) ?>\">\n                    Provision new port...\n                </a>\n\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href=\"<?= route( \"irrdb@list\", [ \"cust\" => $c->id, \"type\" => 'prefix', \"protocol\" => $c->isIPvXEnabled( 4) ? 4 : 6 ] ) ?>\">\n                    View / Update IRRDB Entries...\n                </a>\n\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href=\"<?= route( 'customer@welcome-email', [ 'cust' => $c->id ] ) ?>\">\n                    Send Welcome Email...\n                </a>\n            </div>\n        </div>\n\n        <div class=\"btn-group btn-group-sm\">\n            <button class=\"btn btn-white dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <i class=\"fa fa-pencil\"></i>\n            </button>\n            <div class=\"dropdown-menu dropdown-menu-right\">\n                <a class=\"dropdown-item\" href=\"<?= route( 'customer@edit' , [ 'cust' => $c->id ] ) ?>\">\n                    Edit <?= ucfirst( config( 'ixp_fe.lang.customer.one' ) ) ?> Details\n                </a>\n\n                <a class=\"dropdown-item\" href=\"<?= route( 'customer@billing-registration' , [ 'cust' => $c->id ] ) ?>\" >\n                    <?php if( !config('ixp.reseller.no_billing') || !$t->resellerMode() || !$c->reseller ): ?>\n                        Edit Billing/Registration Details\n                    <?php else: ?>\n                        Edit Registration Details\n                    <?php endif; ?>\n                </a>\n\n                <?php if( !config( 'ixp_fe.frontend.disabled.docstore_customer' ) ): ?>\n                    <div class=\"dropdown-divider\"></div>\n                    <a class=\"dropdown-item\" href=\"<?= route( 'docstore-c-dir@list', [ 'cust' => $c->id ] ) ?>\">\n                        <?= ucfirst( config( 'ixp_fe.lang.customer.one' ) ) ?> Documents...\n                    </a>\n                <?php endif; ?>\n\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href=\"<?= route( 'customer-tag@link-customer', [ 'cust' => $c->id ] ) ?>\">\n                    Manage Tags...\n                </a>\n\n                <?php if( $t->logoManagementEnabled() ): ?>\n                    <div class=\"dropdown-divider\"></div>\n                    <a class=\"dropdown-item\" href=\"<?= route( 'logo@manage', [ 'id' => $c->id ] ) ?>\">\n                        Manage Logo...\n                    </a>\n                <?php endif; ?>\n\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href=\"<?= route( 'customer@delete-recap', [ 'cust' => $c->id ] ) ?>\">\n                  Delete <?= ucfirst( config( 'ixp_fe.lang.customer.one' ) ) ?>...\n                </a>\n            </div>\n        </div>\n        <?php\n            $keys = array_keys( $t->customers );\n\n            if( array_search( $c->id, $keys, true ) ===  0 || !array_search( $c->id, $keys, true ) ){\n                $cidprev = $c->id;\n            } else {\n                $cidprev = $keys[ array_search( $c->id, $keys, true ) -1 ];\n            }\n\n            if( array_search( $c->id, $keys, true ) ===  count( $keys ) ){\n                $cidnext = $c->id;\n            } else {\n                $cidnext = $keys[ array_search( $c->id, $keys, true ) +1 ] ?? $keys[ array_search( $c->id, $keys, true ) ];\n            }\n        ?>\n\n        <a class=\"btn btn-white\" href=\"<?= route( \"customer@overview\", [ 'cust' => $cidprev ] ) ?>\">\n            <span class=\"fa fa-chevron-left\"></span>\n        </a>\n\n        <a class=\"btn btn-white\" href=\"<?= route( \"customer@overview\", [ 'cust' => $c->id ] ) ?>\">\n            <span class=\"fa fa-refresh\"></span>\n        </a>\n\n        <a class=\"btn btn-white\" href=\"<?= route( \"customer@overview\", [ 'cust' => $cidnext ] ) ?>\">\n            <span class=\"fa fa-chevron-right\"></span>\n        </a>\n        <?php if( !config( 'ixp_fe.frontend.disabled.logs' ) && method_exists( \\IXP\\Models\\Customer::class, 'logSubject') ): ?>\n            <a class=\"btn btn-white btn-sm\" href=\"<?= route( 'log@list', [ 'model' => 'Customer' , 'model_id' => $c->id ] ) ?>\">\n                View logs\n            </a>\n        <?php endif; ?>\n    </div>\n<?php $this->append() ?>\n\n<?php $this->section('content') ?>\n    <?= $t->alerts() ?>\n    <div class=\"tw-bg-white shadow-sm tw-p-6\">\n        <div class=\"row\">\n            <div class=\"<?= $t->logoManagementEnabled() && $logo  ? \"col-md-9 col-lg-7\" : \"col-12\" ?>\">\n                <h3>\n                    <?= $t->ee( $c->getFormattedName() ) ?>\n                    <span class=\"tw-text-sm\">\n                        <?= $t->insert( 'customer/cust-type', [ 'cust' => $c ] ); ?>\n                    </span>\n                </h3>\n\n                <p class=\"tw-mt-2\">\n                    <?php if( $c->corpwww ): ?>\n                        <a href=\"<?= $c->corpwww ?>\" target=\"_blank\">\n                            <?= $t->nakedUrl( $c->corpwww ) ?>\n                        </a>\n                        <span class=\"tw-text-gray-600\">\n                            -\n                        </span>\n                    <?php endif; ?>\n\n                    <span class=\"tw-text-gray-600\">\n                         joined <?= \\Carbon\\Carbon::instance( $c->datejoin )->format('Y') ?>\n                        <?php if( $r = $c->resellerObject ): ?>\n                           - resold via <a href=\"<?= route( \"customer@overview\" , [ 'cust' => $r->id ] ) ?>\"><?= $t->ee($r->abbreviatedName)?></a>\n                        <?php endif; ?>\n                    </span>\n                </p>\n\n                <p class=\"tw-mt-6\">\n                    <?php if( !$c->typeAssociate() ): ?>\n                        <?php if( $c->in_manrs ): ?>\n                            <a href=\"https://www.manrs.org/\" target=\"_blank\" class=\"hover:tw-no-underline\">\n                                <span class=\"tw-inline-block tw-border-1 tw-border-green-500 tw-rounded-full tw-text-green-500 tw-font-semibold tw-uppercase tw-text-xs tw-px-3 tw-py-1 tw-mr-3\">\n                                    MANRS\n                                </span>\n                            </a>\n                        <?php endif; ?>\n                    <?php endif; ?>\n\n                    <?php if( $c->tags ): ?>\n                        <?php foreach( $c->tags as $tag ): ?>\n                            <span class=\"badge badge-secondary\">\n                                <?= $tag->display_as ?>\n                            </span>\n                        <?php endforeach; ?>\n\n                        <a class=\"btn btn-white btn-sm tw-rounded-full tw-text-xs\" href=\"<?= route( 'customer-tag@link-customer', [ 'cust' => $c->id ] ) ?>\">\n                            Edit tags...\n                        </a>\n                    <?php elseif( \\IXP\\Models\\CustomerTag::all()->count() ): ?>\n                        <a class=\"btn btn-white btn-sm tw-rounded-full tw-border-gray-500 tw-text-gray-500 tw-text-xs\" href=\"<?= route( 'customer-tag@link-customer', [ 'cust' => $c->id ] ) ?>\">\n                            Add tags...\n                        </a>\n                    <?php endif; ?>\n                </p>\n            </div>\n\n            <?php if( $t->logoManagementEnabled() && $logo ): ?>\n                <div class=\"col-md-3 col-lg-5 col-12 tw-mt-6 md:tw-mt-0 tw-text-center align-self-center\">\n                    <img class=\"img-fluid lg:tw-inline-block tw-align-middle\" src=\"<?= url( 'logos/' . $logo->shardedPath() ) ?>\">\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n\n    <div class=\"card mt-4\">\n        <div class=\"card-header\">\n            <ul class=\"nav nav-tabs card-header-tabs\">\n                <li class=\"nav-item\">\n                    <a class=\"nav-link <?php if( !$t->tab || $t->tab === 'overview' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#overview\">\n                        Overview\n                    </a>\n                </li>\n                <li role=\"details\" class=\"nav-item\" >\n                    <a class=\"nav-link <?php if( $t->tab === 'details' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#details\">\n                        Details\n                    </a>\n                </li>\n\n                <?php if( $t->resellerMode() && $c->isReseller ): ?>\n                    <li role=\"resold-customers\" class=\"nav-item <?php if( $t->tab === 'resold-customers' ): ?>active<?php endif; ?>\">\n                        <a class=\"nav-link \" data-toggle=\"tab\" href=\"#resold-customers\" data-toggle=\"tab\">\n                            Resold <?= ucfirst( config( 'ixp_fe.lang.customer.many' ) ) ?>\n                        </a>\n                    </li>\n                <?php endif; ?>\n\n                <?php if( !$c->typeAssociate() && !$c->hasLeft() ):?>\n                    <li role=\"ports\" class=\"nav-item \">\n                        <a class=\"nav-link <?php if( $t->tab === 'ports' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#ports\" data-toggle=\"tab\">\n                            Ports\n                        </a>\n                    </li>\n\n                    <?php if( $c->hasPrivateVLANs() ): ?>\n                        <li role=\"private-vlans\" class=\"nav-item \">\n                            <a class=\"nav-link <?php if( $t->tab === 'private-vlans' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#private-vlans\" data-toggle=\"tab\">\n                                Private VLANs\n                            </a>\n                        </li>\n                    <?php endif; ?>\n                <?php endif; ?>\n\n                <li role=\"users\" class=\"nav-item \">\n                    <a class=\"nav-link <?php if( $t->tab === 'users' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#users\" data-toggle=\"tab\">\n                        Users\n                    </a>\n                </li>\n\n                <li role=\"contacts\" class=\"nav-item \">\n                    <a class=\"nav-link <?php if( $t->tab === 'contacts' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#contacts\" data-toggle=\"tab\">\n                        Contacts\n                    </a>\n                </li>\n\n                <li role=\"logins\" class=\"nav-item\">\n                    <a class=\"nav-link <?php if( $t->tab === 'logins' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#logins\" data-toggle=\"tab\">\n                        Logins\n                    </a>\n                </li>\n\n                <li role=\"notes\" class=\"nav-item \">\n                    <a class=\"nav-link <?php if( $t->tab === 'notes' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#notes\" id=\"tab-notes\" data-toggle=\"tab\">\n                        Notes\n                        <?php if( $t->notesInfo[ \"unreadNotes\"] > 0 ): ?>\n                            <span id=\"notes-unread-indicator\" class=\"badge badge-success\"><?= $t->notesInfo[ \"unreadNotes\"] ?></span>\n                        <?php endif ?>\n                    </a>\n                </li>\n\n                <li role=\"cross-connects\" class=\"nav-item \">\n                    <a class=\"nav-link <?php if( $t->tab === 'cross-connects' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#cross-connects\" data-toggle=\"tab\">\n                        Cross Connects\n                    </a>\n                </li>\n\n                <li role=\"peers\" class=\"nav-item\">\n                    <a class=\"nav-link peers-tab <?php if( $t->tab === 'peers' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#peers\" data-toggle=\"tab\">\n                        Peers\n                    </a>\n                </li>\n\n                <?php if( !config( 'ixp_fe.frontend.disabled.console-server-connection' ) && $c->consoleServerConnections->count() ): ?>\n                    <li role=\"console-server-connections\" class=\"nav-item \">\n                        <a class=\"nav-link <?php if( $t->tab === 'console-server-connections' ): ?>active<?php endif; ?>\" data-toggle=\"tab\" href=\"#console-server-connections\" data-toggle=\"tab\">\n                            OOB Access\n                        </a>\n                    </li>\n                <?php endif ?>\n\n                <?php if( !config( 'ixp_fe.frontend.disabled.docstore_customer' ) ): ?>\n                    <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"<?= route( 'docstore-c-dir@list', [ 'cust' => $c->id ] ) ?>\">\n                            Documents &raquo;\n                        </a>\n                    </li>\n                <?php endif; ?>\n\n                <?php if( !$c->typeAssociate() && !$c->hasLeft() ): ?>\n                    <?php if( $c->routeServerClient() ): ?>\n                        <?php if( !config( 'ixp_fe.frontend.disabled.rs-prefixes' ) ): ?>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"<?= route( \"rs-prefixes@view\", [ 'cust' =>  $c->id ] ) ?>\">\n                                    RS Prefixes &raquo;\n                                </a>\n                            </li>\n                        <?php endif ?>\n\n                        <?php if( !config( 'ixp_fe.frontend.disabled.filtered-prefixes' ) ): ?>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"<?= route( \"filtered-prefixes@list\", [ 'cust' =>  $c->id ] ) ?>\">\n                                    Filtered Prefixes &raquo;\n                                </a>\n                            </li>\n                        <?php elseif( $c->irrdbFiltered() ): ?>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"<?= route( \"irrdb@list\", [ \"cust\" => $c->id, \"type\" => 'prefix', \"protocol\" => $c->isIPvXEnabled( 4) ? 4 : 6 ] ) ?>\">\n                                    IRRDB Entries &raquo;\n                                </a>\n                            </li>\n                        <?php endif; ?>\n                    <?php endif ?>\n\n                    <?php if( config('grapher.backends.sflow.enabled') ) : ?>\n                        <li class=\"nav-item\">\n                            <a class=\"nav-link\" href=\"<?= route( \"statistics@p2p\", [ 'cust' => $c->id ] )  ?>\">\n                              P2P &raquo;\n                            </a>\n                        </li>\n                    <?php endif ?>\n                <?php endif ?>\n            </ul>\n        </div>\n\n        <div class=\"card-body\">\n            <div class=\"tab-content\">\n                <div id=\"overview\" class=\"tab-pane fade <?php if( !$t->tab || $t->tab === 'overview' ): ?> active show <?php endif; ?>\">\n                    <?= $t->insert( 'customer/overview-tabs/overview' ); ?>\n                </div>\n\n                <div id=\"details\" class=\"tab-pane fade <?php if( $t->tab === 'details' ): ?> active show <?php endif; ?>\">\n                    <?= $t->insert( 'customer/overview-tabs/details' ); ?>\n                </div>\n\n                <?php if( $t->resellerMode() && $c->isReseller ): ?>\n                    <div id=\"resold-customers\" class=\"tab-pane fade\">\n                        <?= $t->insert( 'customer/overview-tabs/resold-customers', [ 'isSuperUser' => $isSuperUser ] ); ?>\n                    </div>\n                <?php endif ?>\n\n                <?php if( !$c->typeAssociate() && !$c->hasLeft() ):?>\n                    <div id=\"ports\" class=\"tab-pane fade <?php if( $t->tab === 'ports' ): ?> active show <?php endif; ?> \">\n                        <?php if( $t->resellerMode() && $c->isReseller ): ?>\n                            <?= $t->insert( 'customer/overview-tabs/reseller-ports', [ 'isSuperUser' => $isSuperUser ] ); ?>\n                        <?php else: ?>\n                            <?= $t->insert( 'customer/overview-tabs/ports', [ 'isSuperUser' => $isSuperUser ] ); ?>\n                        <?php endif ?>\n                    </div>\n\n                    <?php if( $c->hasPrivateVLANs() ): ?>\n                        <div id=\"private-vlans\" class=\"tab-pane fade <?php if( $t->tab === 'private-vlans' ): ?> active show <?php endif; ?> \">\n                            <?= $t->insert( 'customer/overview-tabs/private-vlans' ); ?>\n                        </div>\n                    <?php endif ?>\n                <?php endif ?>\n\n                <div id=\"users\" class=\"tab-pane fade <?php if( $t->tab === 'users' ): ?> active show <?php endif; ?> \">\n                    <?= $t->insert( 'customer/overview-tabs/users', [ 'isSuperUser' => $isSuperUser ] ); ?>\n                </div>\n\n                <div id=\"contacts\" class=\"tab-pane fade <?php if( $t->tab === 'contacts' ): ?> active show <?php endif; ?>\">\n                    <?= $t->insert( 'customer/overview-tabs/contacts' ); ?>\n                </div>\n\n                <div id=\"logins\" class=\"tab-pane fade <?php if( $t->tab === 'logins' ): ?> active show <?php endif; ?>\">\n                    <?= $t->insert( 'customer/overview-tabs/logins' ); ?>\n                </div>\n\n                <div id=\"notes\" class=\"tab-pane fade <?php if( $t->tab === 'notes' ): ?> active show <?php endif; ?>\">\n                    <?= $t->insert( 'customer/overview-tabs/notes', [ 'isSuperUser' => $isSuperUser, 'user' => $user ] ); ?>\n                </div>\n\n                <div id=\"cross-connects\" class=\"tab-pane fade\">\n                    <?= $t->insert( 'customer/overview-tabs/cross-connects', [ 'isSuperUser' => $isSuperUser ] ); ?>\n                </div>\n\n                <div id=\"peers\" class=\"tab-pane peers-tab fade <?php if( $t->tab === 'peers' ): ?> active show <?php endif; ?>\">\n                    <p class=\"tw-text-center\">\n                        <br/>\n                        <b>Data loading please wait...</b>\n                    </p>\n                </div>\n\n                <div id=\"console-server-connections\" class=\"tab-pane fade\">\n                    <?= $t->insert( 'customer/overview-tabs/console-server-connections' ); ?>\n                </div>\n            </div>\n        </div>\n    </div>\n<?php $this->append() ?>\n\n<?php $this->section( 'scripts' ) ?>\n    <?= $t->insert( 'customer/js/overview/users' ); ?>\n    <?= $t->insert( 'customer/js/overview/contacts' ); ?>\n    <?= $t->insert( 'customer/js/overview/notes', [ 'isSuperUser' => $isSuperUser ] ); ?>\n\n    <script>\n        $(document).ready( function() {\n            $('.table-responsive-ixp').dataTable( {\n                responsive: true,\n                ordering: false,\n                searching: false,\n                paging:   false,\n                info:   false,\n                stateSave: true,\n                stateDuration : DATATABLE_STATE_DURATION,\n            } ).show();\n            \n            $('.table-responsive-ixp-action').dataTable( {\n                responsive: true,\n                ordering: false,\n                searching: false,\n                paging:   false,\n                info:   false,\n                stateSave: true,\n                stateDuration : DATATABLE_STATE_DURATION,\n                columnDefs: [\n                    { responsivePriority: 1, targets: 0 },\n                    { responsivePriority: 2, targets: -1 }\n                ],\n            } ).show();\n\n            $('a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\n                $($.fn.dataTable.tables(true)).DataTable()\n                    .columns.adjust()\n                    .responsive.recalc();\n            })\n\n            // Loads peers with ajax\n            let url = \"<?= route( 'customer@load-peers', [ 'cust' => $c->id ] ) ?>\";\n\n            $.ajax( url , {\n                type: 'get'\n            })\n            .done( function( data ) {\n                if( data.success ){\n                    // load th frag in the view\n                    $('#peers').html( data.htmlFrag );\n                }\n            })\n            .fail( function() {\n                alert( \"Error running ajax query for \" + url );\n                throw new Error( \"Error running ajax query for \" + url );\n            })\n        });\n    </script>\n<?php $this->append() ?>\n", "<?php\n    /** @var Foil\\Template\\Template $t */\n    $this->layout( 'layouts/ixpv4' );\n?>\n\n<?php $this->section( 'page-header-preamble' ) ?>\n    Tags /\n    <a href=\"<?= route( 'customer@overview', [ 'cust' => $t->c->id ] ) ?>\">\n        <?= $t->c->getFormattedName() ?>\n    </a>\n<?php $this->append() ?>\n\n<?php $this->section('content') ?>\n    <div class=\"row\">\n        <div class=\"col-lg-12\">\n            <?= $t->alerts() ?>\n            <?php if( $t->tags->count() ): ?>\n                <div class=\"card\">\n                    <div class=\"card-body\">\n                        <?= Former::open()->method( 'POST' )\n                            ->action( route ('customer-tag@link', [ 'cust' => $t->c->id ] ) )\n                            ->customInputWidthClass( 'col-sm-6' )\n                            ->customLabelWidthClass( 'col-sm-2 col-2' )\n                            ->actionButtonsCustomClass( \"grey-box\")\n                        ?>\n\n                        <?php foreach( $t->tags as $tag ): ?>\n                            <div class=\"form-group row\">\n                                <label for=\"tags\" class=\"control-label col-sm-2 col-2\"> </label>\n                                <div class=\"col-sm-6 col-md-6 col-lg-8 col-xl-6\">\n                                    <div class=\"form-check form-check-inline\">\n                                        <input id='tag_<?= $tag->id ?>' type='checkbox' name='tags[]' <?= $t->c->tags->contains( 'id', $tag->id ) ? 'checked' : ''  ?> value='<?= $tag->id ?>'>\n                                        <label for=\"tag_<?= $tag->id ?>\" class=\"form-check-label\">\n                                            <?= $tag->display_as . \" (\" . $tag->tag . \")\" ?>\n                                        </label>\n                                    </div>\n                                  <small class=\"form-text text-muted former-help-text\">\n                                      <?= $tag->description ?>\n                                  </small>\n                                </div>\n                            </div>\n                        <?php endforeach; ?>\n\n                        <?= Former::actions( Former::primary_submit( 'Save Changes' )->class( \"mb-2 mb-sm-0\" ),\n                            Former::secondary_link( 'Cancel' )->href( route( \"customer@overview\" , [ 'cust' => $t->c->id ] ) )->class( \"mb-2 mb-sm-0\" ),\n                            Former::success_button( 'Help' )->id( 'help-btn' )->class( \"mb-2 mb-sm-0\" )\n                        );?>\n\n                        <?= Former::close() ?>\n                    </div>\n                </div>\n            <?php else: ?>\n                <div class=\"alert alert-info mt-4\" role=\"alert\">\n                    <div class=\"d-flex align-items-center\">\n                        <div class=\"text-center\">\n                            <i class=\"fa fa-question-circle fa-2x\"></i>\n                        </div>\n                        <div class=\"col-sm-12\">\n                            No Customer tag available.\n                            <a class=\"btn btn-white\" href=\"<?= route( \"customer-tag@create\" ) ?>\">\n                                Create one\n                            </a>\n                        </div>\n                    </div>\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n<?php $this->append() ?>", "<?php\n    /** @var Foil\\Template\\Template $t */\n    $this->layout( 'layouts/ixpv4' );\n    $log = $t->log; /** @var $log \\IXP\\Models\\Log */\n?>\n\n<?php $this->section( 'page-header-preamble' ) ?>\n    Logs/View\n<?php $this->append() ?>\n\n<?php $this->section( 'page-header-postamble' ) ?>\n    <div class=\"btn-group btn-group-sm\" role=\"group\">\n        <a id=\"e2f-list-a\" class=\"btn btn-white\" href=\"<?= route('log@list') ?>\">\n            <span class=\"fa fa-th-list\"></span>\n        </a>\n    </div>\n<?php $this->append() ?>\n\n<?php $this->section('content') ?>\n    <div class=\"card\">\n        <div class=\"card-header\">\n            <b>\n                Details\n            </b>\n        </div>\n        <div class=\"card-body\">\n            <div class=\"row\">\n                <div class=\"col-lg-12 col-md-12\">\n                    <table class=\"table_view_info\">\n                        <tbody>\n                            <tr>\n                                <td>\n                                    <b>Model</b>\n                                </td>\n                                <td>\n                                    <?= $t->ee( $log->model ) ?>\n                                </td>\n                            </tr>\n                        <tr>\n                            <td>\n                                <b>UID</b>\n                            </td>\n                            <td>\n                                <?= $t->ee( $log->model_id ) ?>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>\n                                <b>Action</b>\n                            </td>\n                            <td>\n                                <?= $t->ee( $log->action ) ?>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>\n                                <b>User</b>\n                            </td>\n                            <td>\n                                <a href=\"<?= route( 'user@view', [ 'u' => $log->user_id ] ) ?>\">\n                                    <?= $t->ee( $log->user->username ) ?>\n                                </a>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>\n                                <b>Created</b>\n                            </td>\n                            <td>\n                                <?= $log->created_at ?>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>\n                                <b>Message</b>\n                            </td>\n                            <td>\n                                <?= $t->ee( $log->message ) ?>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>\n                                <b>Models</b>\n                            </td>\n                            <td>\n                                <?php\n                                    $new        = $log->models[ 'new' ];\n                                    $old        = $log->models[ 'old' ];\n                                    $changed    = $log->models[ 'changed' ];\n                                ?>\n                                <table class=\"table table-striped\">\n                                    <thead class=\"thead-dark\">\n                                        <tr>\n                                            <th>\n                                                Field\n                                            </th>\n                                            <?php if( $new ): ?>\n                                                <th>\n                                                    New\n                                                </th>\n                                            <?php endif; ?>\n                                            <?php if( $old ): ?>\n                                                <th>\n                                                    Old\n                                                </th>\n                                            <?php endif; ?>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                    <?php $keys = $new ? array_keys( $new ) : array_keys( $old ) ?>\n\n                                        <?php foreach( $keys as $key ): ?>\n                                            <tr>\n                                                <td>\n                                                    <b>\n                                                        <?= $key ?>\n                                                    </b>\n                                                </td>\n                                                <?php if( $new ): ?>\n                                                    <td class=\"<?= isset( $changed[ $key ] ) ? 'tw-bg-gray-500': '' ?> \">\n                                                        <?= $new[ $key ] ?>\n                                                    </td>\n                                                <?php endif; ?>\n                                                <?php if( $old ): ?>\n                                                    <td>\n                                                        <?php if( !is_array( $old[ $key ] ) ): ?>\n                                                            <?= $old[ $key ] ?>\n                                                        <?php else: ?>\n                                                            <?= json_encode($old[ $key ], JSON_THROW_ON_ERROR) ?>\n                                                        <?php endif; ?>\n                                                    </td>\n                                                <?php endif; ?>\n                                            </tr>\n                                        <?php endforeach; ?>\n                                    </tbody>\n                                </table>\n                            </td>\n                        </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n    </div>\n<?php $this->append() ?>"], "fixing_code": ["<?php if( isset($t->data[ 'params'][ \"cs\" ]) ): ?>\n    <div>\n        <h2>\n            Ports for Console Server: <?= $t->ee( $t->data[ 'params'][ \"css\" ][$t->data[ 'params'][ \"cs\" ] ][ 'name' ] ) ?><br><br>\n        </h2>\n    </div>\n<?php endif;?>", "<?php if( !isset( $t->feParams->readonly ) || !$t->feParams->readonly ): ?>\n    <div class=\"btn-group btn-group-sm\" role=\"group\">\n        <div class=\"btn-group btn-group-sm\">\n            <button type=\"button\" class=\"btn btn-white dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <?= isset( $t->data[ 'params'][ \"cs\" ] ) ? $t->ee( $t->data[ 'params'][ \"css\" ][$t->data[ 'params'][ \"cs\" ] ][ 'name' ] ) : \"All Console Server Ports\" ?> <span class=\"caret\"></span>\n            </button>\n\n            <div class=\"dropdown-menu dropdown-menu-right scrollable-dropdown\">\n                <a class=\"dropdown-item <?= isset($t->data[ 'params'][ \"cs\" ]) ? \"\" : \"active\" ?>\" href=\"<?= route( \"console-server-connection@list\" ) ?>\">\n                    All Console Server Ports\n                </a>\n                <div class=\"dropdown-divider\"></div>\n                <?php foreach( $t->data[ 'params'][ \"css\" ] as $css ): ?>\n                    <a class=\"dropdown-item <?= isset( $t->data[ 'params'][ \"cs\" ] ) && $t->data[ 'params'][ \"cs\" ] === $css[ 'id' ] ? 'active' : '' ?>\" href=\"<?= route( \"console-server-connection@listPort\", [ \"cs\" => $css[ 'id' ] ] ) ?>\"><?= $t->ee( $css[ 'name' ] ) ?></a>\n                <?php endforeach; ?>\n            </div>\n        </div>\n\n        <a  class=\"btn btn-white\" href=\"<?= route($t->feParams->route_prefix.'@create' ) ?><?= isset( $t->data[ 'params'][ \"cs\" ] ) ? \"?console_server_id=\" . $t->data[ 'params'][ \"cs\" ] : \"\"  ?>\">\n            <i class=\"fa fa-plus\"></i>\n        </a>\n    </div>\n<?php endif;?>", "<?php\n    $privs          = Auth::getUser()->privs();\n    $isSuperUser    = $privs === \\IXP\\Models\\User::AUTH_SUPERUSER;\n    $isCustAdmin    = $privs === \\IXP\\Models\\User::AUTH_CUSTADMIN;\n?>\n\n<div class=\"card\">\n    <div class=\"card-body\">\n        <?= Former::open()->method( $t->data['params']['isAdd'] ? 'POST' : 'PUT'  )\n            ->id( 'form' )\n            ->action( $t->data['params']['isAdd'] ? route( $t->feParams->route_prefix . '@store' ) : route($t->feParams->route_prefix . '@update', [ 'id' => $t->data[ 'params'][ 'object']->id ] ) )\n            ->customInputWidthClass( 'col-sm-6 col-md-6 col-lg-8 col-xl-6' )\n            ->customLabelWidthClass( 'col-sm-2 col-md-2 col-lg-3 text-xs-center' )\n            ->actionButtonsCustomClass( \"grey-box\")\n        ?>\n        <?php\n            $checkedRoles = [];\n            if( old( 'roles' ) !== null ) {\n                $checkedRoles = array_values( old( 'roles' ) );\n            } else {\n                $checkedRoles = array_keys( $t->data[ 'params' ][ 'groupsForContact' ] );\n            }\n        ?>\n\n        <div class=\"row\">\n            <div class=\"col-lg-6\">\n                <?= Former::text( 'name' )\n                    ->label( 'Name' )\n                    ->placeholder( 'Firstname Lastname' )\n                    ->blockHelp( \"The full name of the contact.\" );\n                ?>\n\n                <?= Former::text( 'position' )\n                    ->label( 'Position' )\n                    ->placeholder( 'Senior Network Engineer' )\n                    ->blockHelp( \"The contact's job title / position.\" );\n                ?>\n\n                <?php if( $isSuperUser ):?>\n                    <?= Former::select( 'custid' )\n                        ->id( 'cust' )\n                        ->label( ucfirst( config( 'ixp_fe.lang.customer.one' ) ) )\n                        ->placeholder( 'Select a ' . config( 'ixp_fe.lang.customer.one' ) )\n                        ->fromQuery( $t->data[ 'params'][ 'custs' ], 'name' )\n                        ->addClass( 'chzn-select' )\n                        ->blockHelp( ucfirst( config( 'ixp_fe.lang.customer.one' ) )  . ' to assign this contact to.' );\n                    ?>\n                <?php endif; ?>\n\n                <?= Former::text( 'email' )\n                    ->label( 'Email' )\n                    ->placeholder( 'firstname.lastname@example.com' )\n                    ->blockHelp( \"Email address of the contact.\" );\n                ?>\n\n                <?= Former::text( 'phone' )\n                    ->label( 'Phone' )\n                    ->placeholder( config( 'ixp_fe.customer.form.placeholders.phone' ) )\n                    ->blockHelp( \"Office / landline phone number of the contact.\" );\n                ?>\n\n                <?= Former::text( 'mobile' )\n                    ->label( 'Mobile' )\n                    ->placeholder( config( 'ixp_fe.customer.form.placeholders.phone' ) )\n                    ->blockHelp( \"Mobile phone / cell number of the contact.\" );\n                ?>\n            </div>\n\n            <div class=\"col-lg-6\">\n                <div class=\"form-group row\" >\n                    <?php if( $t->data[ 'params'][ \"allGroups\" ] && isset( $t->data[ 'params'][ \"allGroups\" ][ 'ROLE' ] ) ): ?>\n                        <div class=\"collapse\">\n                            <label class=\"control-label col-lg-3 col-sm-3\">&nbsp;\n                                Role&nbsp;\n                            </label>\n                        </div>\n                        <div>\n                            <?php foreach( $t->data[ 'params'][ \"allGroups\" ][ 'ROLE' ] as $role ): ?>\n                                <div class=\"form-group row\">\n                                    <div class=\"col-sm-6 col-md-6 col-lg-8 col-xl-6\">\n                                        <div class=\"form-check form-check-inline\">\n                                            <input id='role_<?= $role[ 'id' ] ?>' type='checkbox' name='roles[]' <?= in_array( $role[ 'id' ], $checkedRoles, false ) ? 'checked' : '' ?> value='<?= $role[ 'id' ] ?>'>\n                                            <label for=\"role_<?= $role[ 'id' ] ?>\" class=\"form-check-label\">\n                                                <?= $t->ee( $role[ 'name' ] ) ?>\n                                            </label>\n                                        </div>\n                                    </div>\n                                </div>\n                            <?php endforeach; ?>\n                        </div>\n                    <?php endif; ?>\n                </div>\n\n                <?php if( !$isCustAdmin ): ?>\n                    <div class=\"form-group col-sm-12\">\n                        <div class=\"card mt-4\">\n                            <div class=\"card-header\">\n                                <ul class=\"nav nav-tabs card-header-tabs\">\n                                    <li role=\"presentation\" class=\"nav-item\">\n                                        <a class=\"tab-link-body-note nav-link active\" href=\"#body\">Notes</a>\n                                    </li>\n                                    <li role=\"presentation\" class=\"nav-item\">\n                                        <a class=\"tab-link-preview-note nav-link\" href=\"#preview\">Preview</a>\n                                    </li>\n                                </ul>\n                            </div>\n\n                            <div class=\"tab-content card-body\">\n                                <div role=\"tabpanel\" class=\"tab-pane show active\" id=\"body\">\n                                    <?= Former::textarea( 'notes' )\n                                        ->id( 'notes' )\n                                        ->label( '' )\n                                        ->rows( 10 )\n                                    ?>\n                                </div>\n                                <div role=\"tabpanel\" class=\"tab-pane\" id=\"preview\">\n                                    <div class=\"bg-light p-4 well-preview\">\n                                        Loading...\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                <?php endif; ?>\n\n                <?php if( $isSuperUser ): ?>\n                    <?php if( ( $t->data[ 'params' ][ \"allGroups\" ] && count( $t->data[ 'params' ][ \"allGroups\" ] ) > 1 ) || ( count( $t->data[ 'params'][ \"allGroups\" ] ) == 1 && !isset( $t->data[ 'params'][ \"allGroups\" ]['ROLE'] ) ) ): ?>\n                        <div class=\"form-group\">\n                            <label for=\"mayauthorize\" class=\"control-label col-lg-2 col-sm-4\">&nbsp;Groups&nbsp;</label>\n                            <table class=\"table table-no-border\">\n                                <?php foreach( $t->data[ 'params'][ \"allGroups\" ] as $gname => $gvalue ): ?>\n                                    <?php if( $gname !== \"ROLE\" && config('contact_group.types.' . $gname ) ): ?>\n                                        <tr>\n                                            <td>\n                                                <label for=\"mayauthorize\" class=\"control-label col-lg-2 col-sm-4\" style=\"display: grid\">&nbsp;<?= $gname ?>&nbsp;</label>\n                                            </td>\n\n                                            <?php foreach( $gvalue as $ggroup ): ?>\n                                                <td>\n                                                    <div class=\"form-group row\">\n                                                        <div class=\"col-sm-6 col-md-6 col-lg-8 col-xl-6\">\n                                                            <div class=\"form-check form-check-inline\">\n                                                                <input id='role_<?= $ggroup[ 'id' ] ?>' type='checkbox' <?= in_array( $ggroup[ 'id' ], $checkedRoles, false ) ? 'checked' : '' ?> name='roles[]' value='<?= $ggroup[ 'id' ] ?>'>\n                                                                <label for=\"role_<?= $ggroup[ 'id' ] ?>\" class=\"form-check-label\">\n                                                                    <?= $ggroup[ 'name' ] ?>\n                                                                </label>\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                                </td>\n                                            <?php endforeach; ?>\n                                        </tr>\n                                    <?php endif; ?>\n                                <?php endforeach; ?>\n                            </table>\n                        </div>\n                    <?php endif; ?>\n                <?php endif; ?>\n            </div>\n        </div>\n\n            <?php\n                // need to figure out where the cancel button foes. shouldn't be this hard :-(\n                $redirect = session()->get( 'contact_post_store_redirect' );\n\n                if( $redirect === 'contact@list' || $redirect === 'contact@add' ) {\n                        $cancel_url = route('contact@list' );\n                } else {\n                    $custid = null;\n                    if( isset( $t->data[ 'params'][ 'object'] ) && $t->data[ 'params'][ 'object'] instanceof \\IXP\\Models\\ContactGroup ) {\n                        $custid = $t->data[ 'params'][ 'object']->custid;\n                    } else if( session()->get( 'contact_post_store_redirect_cid', null ) !== null ) {\n                        $custid = session()->get( 'contact_post_store_redirect_cid' );\n                    }\n\n                    if( $custid !== null ) {\n                        $cancel_url = route( 'customer@overview', [ 'cust' => $custid,  \"tab\" => \"contacts\" ] );\n                    } else {\n                        $cancel_url = route( 'contact@list' );\n                    }\n                }\n            ?>\n\n            <?= Former::actions(\n                Former::primary_submit( $t->data['params']['isAdd'] ? 'Create' : 'Save Changes' )->class( \"mb-2 mb-sm-0\" ),\n                Former::secondary_link( 'Cancel' )->href( $cancel_url )->class( \"mb-2 mb-sm-0\" ),\n                Former::success_button( 'Help' )->id( 'help-btn' )->class( \"mb-2 mb-sm-0\" )\n            ); ?>\n        <?= Former::close() ?>\n    </div>\n</div>", "<?php if( !isset( $t->feParams->readonly ) || !$t->feParams->readonly ): ?>\n    <div class=\"btn-group btn-group-sm\" role=\"group\">\n        <?php if( isset( $t->feParams->documentation ) && $t->feParams->documentation ): ?>\n            <a target=\"_blank\" class=\"btn btn-white\" href=\"<?= $t->feParams->documentation ?>\">\n                Documentation\n            </a>\n        <?php endif; ?>\n\n        <?php if( config('contact_group.types.ROLE') ): ?>\n            <button type=\"button\" class=\"btn btn-white dropdown-toggle\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <?= isset( $t->data[ 'params'][ \"role\" ] ) ? $t->ee( $t->data[ 'params'][ \"roles\" ][ $t->data[ 'params'][ \"role\" ] ][ 'name'] ) : \"All Roles\" ?>\n            </button>\n            <ul class=\"dropdown-menu dropdown-menu-right\">\n                <a class=\"dropdown-item <?= isset( $t->data[ 'params'][ \"role\" ]) ?: \"active\" ?>\" href=\"<?= route( $t->feParams->route_prefix . \"@list\" ) ?>\">\n                    All Roles\n                </a>\n\n                <div class=\"dropdown-divider\"></div>\n\n                <?php foreach( $t->data[ 'params'][ \"roles\" ] as $index => $role ): ?>\n                    <a class=\"dropdown-item <?= isset($t->data[ 'params'][ \"role\" ]) && (int)$t->data[ 'params'][ \"role\" ] === $role[ 'id'] ? 'active' : '' ?>\" href=\"<?= route( $t->feParams->route_prefix . \"@list\" ) ?>?role=<?= $role[ 'id' ] ?>\">\n                        <?= $t->ee( $role[ 'name' ] ) ?>\n                    </a>\n                <?php endforeach; ?>\n            </ul>\n        <?php endif;?>\n\n        <a class=\"btn btn-white\" href=\"<?= route($t->feParams->route_prefix.'@create' ) ?>\">\n            <span class=\"fa fa-plus\"></span>\n        </a>\n    </div>\n<?php endif;?>", "<?php\n    /** @var Foil\\Template\\Template $t */\n    $this->layout( 'layouts/ixpv4' );\n\n    /** @var \\IXP\\Models\\Customer $c */\n    $c = $t->c;\n    $user = Auth::getUser();\n    $isSuperUser = $user->isSuperUser();\n    $logo = $c->logo;\n?>\n\n<?php $this->section( 'page-header-postamble' ) ?>\n    <div class=\"btn-group btn-group-sm ml-auto\" role=\"group\" aria-label=\"...\">\n        <a class=\"btn btn-white\" href=\"<?= route('statistics@member', [ 'cust' => $c->id ] ) ?>\">\n            Port Graphs\n        </a>\n        <div class=\"btn-group btn-group-sm\">\n            <button class=\"btn btn-white dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <i class=\"fa fa-cog\"></i>\n            </button>\n            <div class=\"dropdown-menu dropdown-menu-right\">\n                <a class=\"dropdown-item\" href=\"<?= route( 'virtual-interface@create-wizard-for-cust', [ 'cust' => $c->id ] ) ?>\">\n                    Provision new port...\n                </a>\n\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href=\"<?= route( \"irrdb@list\", [ \"cust\" => $c->id, \"type\" => 'prefix', \"protocol\" => $c->isIPvXEnabled( 4) ? 4 : 6 ] ) ?>\">\n                    View / Update IRRDB Entries...\n                </a>\n\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href=\"<?= route( 'customer@welcome-email', [ 'cust' => $c->id ] ) ?>\">\n                    Send Welcome Email...\n                </a>\n            </div>\n        </div>\n\n        <div class=\"btn-group btn-group-sm\">\n            <button class=\"btn btn-white dropdown-toggle\" type=\"button\" data-toggle=\"dropdown\" aria-haspopup=\"true\" aria-expanded=\"false\">\n                <i class=\"fa fa-pencil\"></i>\n            </button>\n            <div class=\"dropdown-menu dropdown-menu-right\">\n                <a class=\"dropdown-item\" href=\"<?= route( 'customer@edit' , [ 'cust' => $c->id ] ) ?>\">\n                    Edit <?= ucfirst( config( 'ixp_fe.lang.customer.one' ) ) ?> Details\n                </a>\n\n                <a class=\"dropdown-item\" href=\"<?= route( 'customer@billing-registration' , [ 'cust' => $c->id ] ) ?>\" >\n                    <?php if( !config('ixp.reseller.no_billing') || !$t->resellerMode() || !$c->reseller ): ?>\n                        Edit Billing/Registration Details\n                    <?php else: ?>\n                        Edit Registration Details\n                    <?php endif; ?>\n                </a>\n\n                <?php if( !config( 'ixp_fe.frontend.disabled.docstore_customer' ) ): ?>\n                    <div class=\"dropdown-divider\"></div>\n                    <a class=\"dropdown-item\" href=\"<?= route( 'docstore-c-dir@list', [ 'cust' => $c->id ] ) ?>\">\n                        <?= ucfirst( config( 'ixp_fe.lang.customer.one' ) ) ?> Documents...\n                    </a>\n                <?php endif; ?>\n\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href=\"<?= route( 'customer-tag@link-customer', [ 'cust' => $c->id ] ) ?>\">\n                    Manage Tags...\n                </a>\n\n                <?php if( $t->logoManagementEnabled() ): ?>\n                    <div class=\"dropdown-divider\"></div>\n                    <a class=\"dropdown-item\" href=\"<?= route( 'logo@manage', [ 'id' => $c->id ] ) ?>\">\n                        Manage Logo...\n                    </a>\n                <?php endif; ?>\n\n                <div class=\"dropdown-divider\"></div>\n                <a class=\"dropdown-item\" href=\"<?= route( 'customer@delete-recap', [ 'cust' => $c->id ] ) ?>\">\n                  Delete <?= ucfirst( config( 'ixp_fe.lang.customer.one' ) ) ?>...\n                </a>\n            </div>\n        </div>\n        <?php\n            $keys = array_keys( $t->customers );\n\n            if( array_search( $c->id, $keys, true ) ===  0 || !array_search( $c->id, $keys, true ) ){\n                $cidprev = $c->id;\n            } else {\n                $cidprev = $keys[ array_search( $c->id, $keys, true ) -1 ];\n            }\n\n            if( array_search( $c->id, $keys, true ) ===  count( $keys ) ){\n                $cidnext = $c->id;\n            } else {\n                $cidnext = $keys[ array_search( $c->id, $keys, true ) +1 ] ?? $keys[ array_search( $c->id, $keys, true ) ];\n            }\n        ?>\n\n        <a class=\"btn btn-white\" href=\"<?= route( \"customer@overview\", [ 'cust' => $cidprev ] ) ?>\">\n            <span class=\"fa fa-chevron-left\"></span>\n        </a>\n\n        <a class=\"btn btn-white\" href=\"<?= route( \"customer@overview\", [ 'cust' => $c->id ] ) ?>\">\n            <span class=\"fa fa-refresh\"></span>\n        </a>\n\n        <a class=\"btn btn-white\" href=\"<?= route( \"customer@overview\", [ 'cust' => $cidnext ] ) ?>\">\n            <span class=\"fa fa-chevron-right\"></span>\n        </a>\n        <?php if( !config( 'ixp_fe.frontend.disabled.logs' ) && method_exists( \\IXP\\Models\\Customer::class, 'logSubject') ): ?>\n            <a class=\"btn btn-white btn-sm\" href=\"<?= route( 'log@list', [ 'model' => 'Customer' , 'model_id' => $c->id ] ) ?>\">\n                View logs\n            </a>\n        <?php endif; ?>\n    </div>\n<?php $this->append() ?>\n\n<?php $this->section('content') ?>\n    <?= $t->alerts() ?>\n    <div class=\"tw-bg-white shadow-sm tw-p-6\">\n        <div class=\"row\">\n            <div class=\"<?= $t->logoManagementEnabled() && $logo  ? \"col-md-9 col-lg-7\" : \"col-12\" ?>\">\n                <h3>\n                    <?= $t->ee( $c->getFormattedName() ) ?>\n                    <span class=\"tw-text-sm\">\n                        <?= $t->insert( 'customer/cust-type', [ 'cust' => $c ] ); ?>\n                    </span>\n                </h3>\n\n                <p class=\"tw-mt-2\">\n                    <?php if( $c->corpwww ): ?>\n                        <a href=\"<?= $c->corpwww ?>\" target=\"_blank\">\n                            <?= $t->nakedUrl( $c->corpwww ) ?>\n                        </a>\n                        <span class=\"tw-text-gray-600\">\n                            -\n                        </span>\n                    <?php endif; ?>\n\n                    <span class=\"tw-text-gray-600\">\n                         joined <?= \\Carbon\\Carbon::instance( $c->datejoin )->format('Y') ?>\n                        <?php if( $r = $c->resellerObject ): ?>\n                           - resold via <a href=\"<?= route( \"customer@overview\" , [ 'cust' => $r->id ] ) ?>\"><?= $t->ee($r->abbreviatedName)?></a>\n                        <?php endif; ?>\n                    </span>\n                </p>\n\n                <p class=\"tw-mt-6\">\n                    <?php if( !$c->typeAssociate() ): ?>\n                        <?php if( $c->in_manrs ): ?>\n                            <a href=\"https://www.manrs.org/\" target=\"_blank\" class=\"hover:tw-no-underline\">\n                                <span class=\"tw-inline-block tw-border-1 tw-border-green-500 tw-rounded-full tw-text-green-500 tw-font-semibold tw-uppercase tw-text-xs tw-px-3 tw-py-1 tw-mr-3\">\n                                    MANRS\n                                </span>\n                            </a>\n                        <?php endif; ?>\n                    <?php endif; ?>\n\n                    <?php if( $c->tags ): ?>\n                        <?php foreach( $c->tags as $tag ): ?>\n                            <span class=\"badge badge-secondary\">\n                                <?= $t->ee( $tag->display_as ) ?>\n                            </span>\n                        <?php endforeach; ?>\n\n                        <a class=\"btn btn-white btn-sm tw-rounded-full tw-text-xs\" href=\"<?= route( 'customer-tag@link-customer', [ 'cust' => $c->id ] ) ?>\">\n                            Edit tags...\n                        </a>\n                    <?php elseif( \\IXP\\Models\\CustomerTag::all()->count() ): ?>\n                        <a class=\"btn btn-white btn-sm tw-rounded-full tw-border-gray-500 tw-text-gray-500 tw-text-xs\" href=\"<?= route( 'customer-tag@link-customer', [ 'cust' => $c->id ] ) ?>\">\n                            Add tags...\n                        </a>\n                    <?php endif; ?>\n                </p>\n            </div>\n\n            <?php if( $t->logoManagementEnabled() && $logo ): ?>\n                <div class=\"col-md-3 col-lg-5 col-12 tw-mt-6 md:tw-mt-0 tw-text-center align-self-center\">\n                    <img class=\"img-fluid lg:tw-inline-block tw-align-middle\" src=\"<?= url( 'logos/' . $logo->shardedPath() ) ?>\">\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n\n    <div class=\"card mt-4\">\n        <div class=\"card-header\">\n            <ul class=\"nav nav-tabs card-header-tabs\">\n                <li class=\"nav-item\">\n                    <a class=\"nav-link <?php if( !$t->tab || $t->tab === 'overview' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#overview\">\n                        Overview\n                    </a>\n                </li>\n                <li role=\"details\" class=\"nav-item\" >\n                    <a class=\"nav-link <?php if( $t->tab === 'details' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#details\">\n                        Details\n                    </a>\n                </li>\n\n                <?php if( $t->resellerMode() && $c->isReseller ): ?>\n                    <li role=\"resold-customers\" class=\"nav-item <?php if( $t->tab === 'resold-customers' ): ?>active<?php endif; ?>\">\n                        <a class=\"nav-link \" data-toggle=\"tab\" href=\"#resold-customers\" data-toggle=\"tab\">\n                            Resold <?= ucfirst( config( 'ixp_fe.lang.customer.many' ) ) ?>\n                        </a>\n                    </li>\n                <?php endif; ?>\n\n                <?php if( !$c->typeAssociate() && !$c->hasLeft() ):?>\n                    <li role=\"ports\" class=\"nav-item \">\n                        <a class=\"nav-link <?php if( $t->tab === 'ports' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#ports\" data-toggle=\"tab\">\n                            Ports\n                        </a>\n                    </li>\n\n                    <?php if( $c->hasPrivateVLANs() ): ?>\n                        <li role=\"private-vlans\" class=\"nav-item \">\n                            <a class=\"nav-link <?php if( $t->tab === 'private-vlans' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#private-vlans\" data-toggle=\"tab\">\n                                Private VLANs\n                            </a>\n                        </li>\n                    <?php endif; ?>\n                <?php endif; ?>\n\n                <li role=\"users\" class=\"nav-item \">\n                    <a class=\"nav-link <?php if( $t->tab === 'users' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#users\" data-toggle=\"tab\">\n                        Users\n                    </a>\n                </li>\n\n                <li role=\"contacts\" class=\"nav-item \">\n                    <a class=\"nav-link <?php if( $t->tab === 'contacts' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#contacts\" data-toggle=\"tab\">\n                        Contacts\n                    </a>\n                </li>\n\n                <li role=\"logins\" class=\"nav-item\">\n                    <a class=\"nav-link <?php if( $t->tab === 'logins' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#logins\" data-toggle=\"tab\">\n                        Logins\n                    </a>\n                </li>\n\n                <li role=\"notes\" class=\"nav-item \">\n                    <a class=\"nav-link <?php if( $t->tab === 'notes' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#notes\" id=\"tab-notes\" data-toggle=\"tab\">\n                        Notes\n                        <?php if( $t->notesInfo[ \"unreadNotes\"] > 0 ): ?>\n                            <span id=\"notes-unread-indicator\" class=\"badge badge-success\"><?= $t->notesInfo[ \"unreadNotes\"] ?></span>\n                        <?php endif ?>\n                    </a>\n                </li>\n\n                <li role=\"cross-connects\" class=\"nav-item \">\n                    <a class=\"nav-link <?php if( $t->tab === 'cross-connects' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#cross-connects\" data-toggle=\"tab\">\n                        Cross Connects\n                    </a>\n                </li>\n\n                <li role=\"peers\" class=\"nav-item\">\n                    <a class=\"nav-link peers-tab <?php if( $t->tab === 'peers' ): ?> active <?php endif; ?>\" data-toggle=\"tab\" href=\"#peers\" data-toggle=\"tab\">\n                        Peers\n                    </a>\n                </li>\n\n                <?php if( !config( 'ixp_fe.frontend.disabled.console-server-connection' ) && $c->consoleServerConnections->count() ): ?>\n                    <li role=\"console-server-connections\" class=\"nav-item \">\n                        <a class=\"nav-link <?php if( $t->tab === 'console-server-connections' ): ?>active<?php endif; ?>\" data-toggle=\"tab\" href=\"#console-server-connections\" data-toggle=\"tab\">\n                            OOB Access\n                        </a>\n                    </li>\n                <?php endif ?>\n\n                <?php if( !config( 'ixp_fe.frontend.disabled.docstore_customer' ) ): ?>\n                    <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"<?= route( 'docstore-c-dir@list', [ 'cust' => $c->id ] ) ?>\">\n                            Documents &raquo;\n                        </a>\n                    </li>\n                <?php endif; ?>\n\n                <?php if( !$c->typeAssociate() && !$c->hasLeft() ): ?>\n                    <?php if( $c->routeServerClient() ): ?>\n                        <?php if( !config( 'ixp_fe.frontend.disabled.rs-prefixes' ) ): ?>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"<?= route( \"rs-prefixes@view\", [ 'cust' =>  $c->id ] ) ?>\">\n                                    RS Prefixes &raquo;\n                                </a>\n                            </li>\n                        <?php endif ?>\n\n                        <?php if( !config( 'ixp_fe.frontend.disabled.filtered-prefixes' ) ): ?>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"<?= route( \"filtered-prefixes@list\", [ 'cust' =>  $c->id ] ) ?>\">\n                                    Filtered Prefixes &raquo;\n                                </a>\n                            </li>\n                        <?php elseif( $c->irrdbFiltered() ): ?>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"<?= route( \"irrdb@list\", [ \"cust\" => $c->id, \"type\" => 'prefix', \"protocol\" => $c->isIPvXEnabled( 4) ? 4 : 6 ] ) ?>\">\n                                    IRRDB Entries &raquo;\n                                </a>\n                            </li>\n                        <?php endif; ?>\n                    <?php endif ?>\n\n                    <?php if( config('grapher.backends.sflow.enabled') ) : ?>\n                        <li class=\"nav-item\">\n                            <a class=\"nav-link\" href=\"<?= route( \"statistics@p2p\", [ 'cust' => $c->id ] )  ?>\">\n                              P2P &raquo;\n                            </a>\n                        </li>\n                    <?php endif ?>\n                <?php endif ?>\n            </ul>\n        </div>\n\n        <div class=\"card-body\">\n            <div class=\"tab-content\">\n                <div id=\"overview\" class=\"tab-pane fade <?php if( !$t->tab || $t->tab === 'overview' ): ?> active show <?php endif; ?>\">\n                    <?= $t->insert( 'customer/overview-tabs/overview' ); ?>\n                </div>\n\n                <div id=\"details\" class=\"tab-pane fade <?php if( $t->tab === 'details' ): ?> active show <?php endif; ?>\">\n                    <?= $t->insert( 'customer/overview-tabs/details' ); ?>\n                </div>\n\n                <?php if( $t->resellerMode() && $c->isReseller ): ?>\n                    <div id=\"resold-customers\" class=\"tab-pane fade\">\n                        <?= $t->insert( 'customer/overview-tabs/resold-customers', [ 'isSuperUser' => $isSuperUser ] ); ?>\n                    </div>\n                <?php endif ?>\n\n                <?php if( !$c->typeAssociate() && !$c->hasLeft() ):?>\n                    <div id=\"ports\" class=\"tab-pane fade <?php if( $t->tab === 'ports' ): ?> active show <?php endif; ?> \">\n                        <?php if( $t->resellerMode() && $c->isReseller ): ?>\n                            <?= $t->insert( 'customer/overview-tabs/reseller-ports', [ 'isSuperUser' => $isSuperUser ] ); ?>\n                        <?php else: ?>\n                            <?= $t->insert( 'customer/overview-tabs/ports', [ 'isSuperUser' => $isSuperUser ] ); ?>\n                        <?php endif ?>\n                    </div>\n\n                    <?php if( $c->hasPrivateVLANs() ): ?>\n                        <div id=\"private-vlans\" class=\"tab-pane fade <?php if( $t->tab === 'private-vlans' ): ?> active show <?php endif; ?> \">\n                            <?= $t->insert( 'customer/overview-tabs/private-vlans' ); ?>\n                        </div>\n                    <?php endif ?>\n                <?php endif ?>\n\n                <div id=\"users\" class=\"tab-pane fade <?php if( $t->tab === 'users' ): ?> active show <?php endif; ?> \">\n                    <?= $t->insert( 'customer/overview-tabs/users', [ 'isSuperUser' => $isSuperUser ] ); ?>\n                </div>\n\n                <div id=\"contacts\" class=\"tab-pane fade <?php if( $t->tab === 'contacts' ): ?> active show <?php endif; ?>\">\n                    <?= $t->insert( 'customer/overview-tabs/contacts' ); ?>\n                </div>\n\n                <div id=\"logins\" class=\"tab-pane fade <?php if( $t->tab === 'logins' ): ?> active show <?php endif; ?>\">\n                    <?= $t->insert( 'customer/overview-tabs/logins' ); ?>\n                </div>\n\n                <div id=\"notes\" class=\"tab-pane fade <?php if( $t->tab === 'notes' ): ?> active show <?php endif; ?>\">\n                    <?= $t->insert( 'customer/overview-tabs/notes', [ 'isSuperUser' => $isSuperUser, 'user' => $user ] ); ?>\n                </div>\n\n                <div id=\"cross-connects\" class=\"tab-pane fade\">\n                    <?= $t->insert( 'customer/overview-tabs/cross-connects', [ 'isSuperUser' => $isSuperUser ] ); ?>\n                </div>\n\n                <div id=\"peers\" class=\"tab-pane peers-tab fade <?php if( $t->tab === 'peers' ): ?> active show <?php endif; ?>\">\n                    <p class=\"tw-text-center\">\n                        <br/>\n                        <b>Data loading please wait...</b>\n                    </p>\n                </div>\n\n                <div id=\"console-server-connections\" class=\"tab-pane fade\">\n                    <?= $t->insert( 'customer/overview-tabs/console-server-connections' ); ?>\n                </div>\n            </div>\n        </div>\n    </div>\n<?php $this->append() ?>\n\n<?php $this->section( 'scripts' ) ?>\n    <?= $t->insert( 'customer/js/overview/users' ); ?>\n    <?= $t->insert( 'customer/js/overview/contacts' ); ?>\n    <?= $t->insert( 'customer/js/overview/notes', [ 'isSuperUser' => $isSuperUser ] ); ?>\n\n    <script>\n        $(document).ready( function() {\n            $('.table-responsive-ixp').dataTable( {\n                responsive: true,\n                ordering: false,\n                searching: false,\n                paging:   false,\n                info:   false,\n                stateSave: true,\n                stateDuration : DATATABLE_STATE_DURATION,\n            } ).show();\n            \n            $('.table-responsive-ixp-action').dataTable( {\n                responsive: true,\n                ordering: false,\n                searching: false,\n                paging:   false,\n                info:   false,\n                stateSave: true,\n                stateDuration : DATATABLE_STATE_DURATION,\n                columnDefs: [\n                    { responsivePriority: 1, targets: 0 },\n                    { responsivePriority: 2, targets: -1 }\n                ],\n            } ).show();\n\n            $('a[data-toggle=\"tab\"]').on('shown.bs.tab', function (e) {\n                $($.fn.dataTable.tables(true)).DataTable()\n                    .columns.adjust()\n                    .responsive.recalc();\n            })\n\n            // Loads peers with ajax\n            let url = \"<?= route( 'customer@load-peers', [ 'cust' => $c->id ] ) ?>\";\n\n            $.ajax( url , {\n                type: 'get'\n            })\n            .done( function( data ) {\n                if( data.success ){\n                    // load th frag in the view\n                    $('#peers').html( data.htmlFrag );\n                }\n            })\n            .fail( function() {\n                alert( \"Error running ajax query for \" + url );\n                throw new Error( \"Error running ajax query for \" + url );\n            })\n        });\n    </script>\n<?php $this->append() ?>\n", "<?php\n    /** @var Foil\\Template\\Template $t */\n    $this->layout( 'layouts/ixpv4' );\n?>\n\n<?php $this->section( 'page-header-preamble' ) ?>\n    Tags /\n    <a href=\"<?= route( 'customer@overview', [ 'cust' => $t->c->id ] ) ?>\">\n        <?= $t->c->getFormattedName() ?>\n    </a>\n<?php $this->append() ?>\n\n<?php $this->section('content') ?>\n    <div class=\"row\">\n        <div class=\"col-lg-12\">\n            <?= $t->alerts() ?>\n            <?php if( $t->tags->count() ): ?>\n                <div class=\"card\">\n                    <div class=\"card-body\">\n                        <?= Former::open()->method( 'POST' )\n                            ->action( route ('customer-tag@link', [ 'cust' => $t->c->id ] ) )\n                            ->customInputWidthClass( 'col-sm-6' )\n                            ->customLabelWidthClass( 'col-sm-2 col-2' )\n                            ->actionButtonsCustomClass( \"grey-box\")\n                        ?>\n\n                        <?php foreach( $t->tags as $tag ): ?>\n                            <div class=\"form-group row\">\n                                <label for=\"tags\" class=\"control-label col-sm-2 col-2\"> </label>\n                                <div class=\"col-sm-6 col-md-6 col-lg-8 col-xl-6\">\n                                    <div class=\"form-check form-check-inline\">\n                                        <input id='tag_<?= $tag->id ?>' type='checkbox' name='tags[]' <?= $t->c->tags->contains( 'id', $tag->id ) ? 'checked' : ''  ?> value='<?= $tag->id ?>'>\n                                        <label for=\"tag_<?= $tag->id ?>\" class=\"form-check-label\">\n                                            <?= $t->ee( $tag->display_as ) . \" (\" . $t->ee( $tag->tag ) . \")\" ?>\n                                        </label>\n                                    </div>\n                                  <small class=\"form-text text-muted former-help-text\">\n                                      <?= $t->ee( $tag->description ) ?>\n                                  </small>\n                                </div>\n                            </div>\n                        <?php endforeach; ?>\n\n                        <?= Former::actions( Former::primary_submit( 'Save Changes' )->class( \"mb-2 mb-sm-0\" ),\n                            Former::secondary_link( 'Cancel' )->href( route( \"customer@overview\" , [ 'cust' => $t->c->id ] ) )->class( \"mb-2 mb-sm-0\" ),\n                            Former::success_button( 'Help' )->id( 'help-btn' )->class( \"mb-2 mb-sm-0\" )\n                        );?>\n\n                        <?= Former::close() ?>\n                    </div>\n                </div>\n            <?php else: ?>\n                <div class=\"alert alert-info mt-4\" role=\"alert\">\n                    <div class=\"d-flex align-items-center\">\n                        <div class=\"text-center\">\n                            <i class=\"fa fa-question-circle fa-2x\"></i>\n                        </div>\n                        <div class=\"col-sm-12\">\n                            No Customer tag available.\n                            <a class=\"btn btn-white\" href=\"<?= route( \"customer-tag@create\" ) ?>\">\n                                Create one\n                            </a>\n                        </div>\n                    </div>\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n<?php $this->append() ?>", "<?php\n    /** @var Foil\\Template\\Template $t */\n    $this->layout( 'layouts/ixpv4' );\n    $log = $t->log; /** @var $log \\IXP\\Models\\Log */\n?>\n\n<?php $this->section( 'page-header-preamble' ) ?>\n    Logs/View\n<?php $this->append() ?>\n\n<?php $this->section( 'page-header-postamble' ) ?>\n    <div class=\"btn-group btn-group-sm\" role=\"group\">\n        <a id=\"e2f-list-a\" class=\"btn btn-white\" href=\"<?= route('log@list') ?>\">\n            <span class=\"fa fa-th-list\"></span>\n        </a>\n    </div>\n<?php $this->append() ?>\n\n<?php $this->section('content') ?>\n    <div class=\"card\">\n        <div class=\"card-header\">\n            <b>\n                Details\n            </b>\n        </div>\n        <div class=\"card-body\">\n            <div class=\"row\">\n                <div class=\"col-lg-12 col-md-12\">\n                    <table class=\"table_view_info\">\n                        <tbody>\n                            <tr>\n                                <td>\n                                    <b>Model</b>\n                                </td>\n                                <td>\n                                    <?= $t->ee( $log->model ) ?>\n                                </td>\n                            </tr>\n                        <tr>\n                            <td>\n                                <b>UID</b>\n                            </td>\n                            <td>\n                                <?= $t->ee( $log->model_id ) ?>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>\n                                <b>Action</b>\n                            </td>\n                            <td>\n                                <?= $t->ee( $log->action ) ?>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>\n                                <b>User</b>\n                            </td>\n                            <td>\n                                <a href=\"<?= route( 'user@view', [ 'u' => $log->user_id ] ) ?>\">\n                                    <?= $t->ee( $log->user->username ) ?>\n                                </a>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>\n                                <b>Created</b>\n                            </td>\n                            <td>\n                                <?= $log->created_at ?>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>\n                                <b>Message</b>\n                            </td>\n                            <td>\n                                <?= $t->ee( $log->message ) ?>\n                            </td>\n                        </tr>\n                        <tr>\n                            <td>\n                                <b>Models</b>\n                            </td>\n                            <td>\n                                <?php\n                                    $new        = $log->models[ 'new' ];\n                                    $old        = $log->models[ 'old' ];\n                                    $changed    = $log->models[ 'changed' ];\n                                ?>\n                                <table class=\"table table-striped\">\n                                    <thead class=\"thead-dark\">\n                                        <tr>\n                                            <th>\n                                                Field\n                                            </th>\n                                            <?php if( $new ): ?>\n                                                <th>\n                                                    New\n                                                </th>\n                                            <?php endif; ?>\n                                            <?php if( $old ): ?>\n                                                <th>\n                                                    Old\n                                                </th>\n                                            <?php endif; ?>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                    <?php $keys = $new ? array_keys( $new ) : array_keys( $old ) ?>\n\n                                        <?php foreach( $keys as $key ): ?>\n                                            <tr>\n                                                <td>\n                                                    <b>\n                                                        <?= $t->ee( $key ) ?>\n                                                    </b>\n                                                </td>\n                                                <?php if( $new ): ?>\n                                                    <td class=\"<?= isset( $changed[ $key ] ) ? 'tw-bg-gray-500': '' ?> \">\n                                                        <?= $t->ee( $new[ $key ] ) ?>\n                                                    </td>\n                                                <?php endif; ?>\n                                                <?php if( $old ): ?>\n                                                    <td>\n                                                        <?php if( !is_array( $old[ $key ] ) ): ?>\n                                                            <?= $t->ee( $old[ $key ] ) ?>\n                                                        <?php else: ?>\n                                                            <?= json_encode($old[ $key ], JSON_HEX_QUOT|JSON_HEX_TAG|JSON_HEX_AMP|JSON_HEX_APOS|JSON_THROW_ON_ERROR) ?>\n                                                        <?php endif; ?>\n                                                    </td>\n                                                <?php endif; ?>\n                                            </tr>\n                                        <?php endforeach; ?>\n                                    </tbody>\n                                </table>\n                            </td>\n                        </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n    </div>\n<?php $this->append() ?>"], "filenames": ["resources/views/console-server-connection/list-preamble.foil.php", "resources/views/console-server-connection/page-header-preamble.foil.php", "resources/views/contact/edit-form.foil.php", "resources/views/contact/page-header-preamble.foil.php", "resources/views/customer/overview.foil.php", "resources/views/customer/tag/cust.foil.php", "resources/views/log/view.foil.php"], "buggy_code_start_loc": [4, 5, 84, 11, 159, 34, 116], "buggy_code_end_loc": [5, 15, 85, 23, 160, 39, 130], "fixing_code_start_loc": [4, 5, 84, 11, 159, 34, 116], "fixing_code_end_loc": [5, 15, 85, 23, 160, 39, 130], "type": "CWE-79", "message": "INEX IXP-Manager before 6.3.1 allows XSS. list-preamble.foil.php, page-header-preamble.foil.php, edit-form.foil.php, page-header-preamble.foil.php, overview.foil.php, cust.foil.php, and view.foil.php may be affected.", "other": {"cve": {"id": "CVE-2023-36666", "sourceIdentifier": "cve@mitre.org", "published": "2023-06-25T22:15:21.527", "lastModified": "2023-07-03T19:07:18.410", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "INEX IXP-Manager before 6.3.1 allows XSS. list-preamble.foil.php, page-header-preamble.foil.php, edit-form.foil.php, page-header-preamble.foil.php, overview.foil.php, cust.foil.php, and view.foil.php may be affected."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:inex:ixp_manager:*:*:*:*:*:*:*:*", "versionEndExcluding": "6.3.1", "matchCriteriaId": "50ECE4A6-8FD8-416A-9D29-DB4B190314ED"}]}]}], "references": [{"url": "https://github.com/inex/IXP-Manager/commit/fddbc38adb477c9cd46a462655ffed96d3d42229", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/inex/IXP-Manager/compare/v6.3.0...v6.3.1", "source": "cve@mitre.org", "tags": ["Patch"]}]}, "github_commit_url": "https://github.com/inex/IXP-Manager/commit/fddbc38adb477c9cd46a462655ffed96d3d42229"}}