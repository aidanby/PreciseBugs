{"buggy_code": [".d-flex.justify-content-between.flex-wrap.flex-md-nowrap.align-items-center.pt-3.pb-2.mb-3.border-bottom\n  - if @user\n    %h1.h2 Edit User\n  - else\n    %h1.h2 Add User\n\n%form{ :method => \"post\", :action => \"/admin/add_user\" }\n  .form-group.row\n    %label.col-lg-2.col-form-label{ :for => \"username\" } Username\n    .col-lg-4\n      - if @user\n        %input#username.form-control{ :type => \"text\", :name => \"username\", :value => \"#{@user.username}\" }\n      - else\n        %input#username.form-control{ :type => \"text\", :name => \"username\" }\n  .form-group.row\n    %label.col-lg-2.col-form-label{ :for => \"password\" } Password (Not required for AD Auth Type)\n    .col-lg-4\n      %input#password.form-control{ :type => \"password\", :name => \"password\" }\n  .form-group.row\n    %label.col-lg-2.col-form-label{ :for => \"auth_type\" } Authorization Type\n    .col-lg-4\n      %select#auth_type.custom-select{ :name => \"auth_type\" }\n        - if @user\n          - if @user.auth_type == \"AD\"\n            %option{ :selected => \"selected\" } AD\n          - else\n            %option AD\n          - if @user.auth_type == \"Local\"\n            %option{ :selected => \"selected\" } Local\n          - else\n            %option Local\n        - else\n          %option{ :selected => \"selected\" } AD\n          %option Local\n  .form-group.row\n    %label.col-lg-2.col-form-label{ :for => \"type\" } User Level\n    .col-lg-4\n      %select#type.custom-select{ :name => \"type\" }\n        - if @user\n          - if @user.type == \"Administrator\"\n            %option{ :selected => \"selected\" } Administrator\n          - else\n            %option Administrator\n          - if @user.type == \"User\"\n            %option{ :selected => \"selected\" } User\n          - else\n            %option User\n        - else\n          %option{ :selected => \"selected\" } User\n          %option Administrator\n\n  %br\n  %input.btn.btn-primary{ :type => \"submit\", :value => \"Add\" }\n  %a.btn.btn-secondary{ :href => \"/admin/list_user\" }\n    Cancel\n", ".d-flex.justify-content-between.flex-wrap.flex-md-nowrap.align-items-center.pt-3.pb-2.mb-3.border-bottom\n  %h1.h2 Editing #{@report.report_name} Report\n\n%h2.h4 Current Authors\n.table-responsive.col-6.px-0\n  %table.table.table-striped.table-sm\n    %tbody\n      %tr\n        %td\n          #{@report.owner}\n        %td\n          &nbsp;\n      - if @report.authors\n        - @report.authors.each do |user|\n          %tr\n            %td\n              #{user}\n            %td.text-right\n              %a.btn.btn-sm.btn-danger{ :href => \"/admin/del_user_report/#{@report.id}/#{user}\" }\n                %i.far.fa-trash-alt{ :title => \"Remove Author\" }\n\n%br\n\n%form{ :method => \"post\", :action => \"/admin/add_user/#{@report.id}\" }\n  .form-group.row\n    %label.col-lg-2.col-form-label{ :for => \"author\" } Add Collaborator\n    .col-lg-4\n      %select#author.custom-select{ :name => \"author\" }\n        - @users.each do |user|\n          %option #{user.username}\n\n  %br\n  %input.btn.btn-primary{ :type => \"submit\", :value => \"Add\" }\n  %a.btn.btn-secondary{ :href => \"/reports/list\" }\n    Cancel\n", ".d-flex.justify-content-between.flex-wrap.flex-md-nowrap.align-items-center.pt-3.pb-2.mb-3.border-bottom\n  %h1.h2 Current Users\n\n- if @users\n  .table.table-striped\n    %table{ :style => \"width: 50%\" }\n      %thead\n        %tr\n          %td{ :style => \"width: 40%\" }\n            %b Username\n          %td{ :style => \"width: 34%\" }\n            %b Level/Authentication Type\n          %td.text-right{ :style => \"width: 15%\" }\n            %b Actions\n      %tbody\n        - @users.each do |user|\n          %tr\n            %td\n              #{user.username}\n            %td\n              #{user.type} / #{user.auth_type}\n            %td.text-right\n              %a.btn.btn-sm.btn-warning{ :href => \"/admin/edit_user/#{user.id}\" }\n                %i.fas.fa-pencil-alt{ :title => \"Edit Password\" }\n              %a.btn.btn-sm.btn-danger{ :href => \"/admin/delete/#{user.id}\" }\n                %i.far.fa-trash-alt{ :title => \"Delete User\" }\n- else\n  No Users. How Curious. Who are you?\n"], "fixing_code": [".d-flex.justify-content-between.flex-wrap.flex-md-nowrap.align-items-center.pt-3.pb-2.mb-3.border-bottom\n  - if @user\n    %h1.h2 Edit User\n  - else\n    %h1.h2 Add User\n\n%form{ :method => \"post\", :action => \"/admin/add_user\" }\n  .form-group.row\n    %label.col-lg-2.col-form-label{ :for => \"username\" } Username\n    .col-lg-4\n      - if @user\n        %input#username.form-control{ :type => \"text\", :name => \"username\", :value => \"#{@user.username}\" }\n      - else\n        %input#username.form-control{ :type => \"text\", :name => \"username\" }\n  .form-group.row\n    %label.col-lg-2.col-form-label{ :for => \"password\" } Password (Not required for AD Auth Type)\n    .col-lg-4\n      %input#password.form-control{ :type => \"password\", :name => \"password\" }\n  .form-group.row\n    %label.col-lg-2.col-form-label{ :for => \"auth_type\" } Authorization Type\n    .col-lg-4\n      %select#auth_type.custom-select{ :name => \"auth_type\" }\n        - if @user\n          - if @user.auth_type == \"AD\"\n            %option{ :selected => \"selected\" } AD\n          - else\n            %option AD\n          - if @user.auth_type == \"Local\"\n            %option{ :selected => \"selected\" } Local\n          - else\n            %option Local\n        - else\n          %option{ :selected => \"selected\" } AD\n          %option Local\n  .form-group.row\n    %label.col-lg-2.col-form-label{ :for => \"type\" } User Level\n    .col-lg-4\n      %select#type.custom-select{ :name => \"type\" }\n        - if @user\n          - if @user.type == \"Administrator\"\n            %option{ :selected => \"selected\" } Administrator\n          - else\n            %option Administrator\n          - if @user.type == \"User\"\n            %option{ :selected => \"selected\" } User\n          - else\n            %option User\n        - else\n          %option{ :selected => \"selected\" } User\n          %option Administrator\n\n  %br\n  %input#authenticity-token{:type => \"hidden\", :name => \"authenticity_token\", :value => \"#{env['rack.session'][:csrf]}\" }\n  %input.btn.btn-primary{ :type => \"submit\", :value => \"Add\" }\n  %a.btn.btn-secondary{ :href => \"/admin/list_user\" }\n    Cancel\n", ".d-flex.justify-content-between.flex-wrap.flex-md-nowrap.align-items-center.pt-3.pb-2.mb-3.border-bottom\n  %h1.h2 Editing #{@report.report_name} Report FFFF\n\n%h2.h4 Current Authors\n.table-responsive.col-6.px-0\n  %table.table.table-striped.table-sm\n    %tbody\n      %tr\n        %td\n          #{@report.owner}\n        %td\n          &nbsp;\n      - if @report.authors\n        - @report.authors.each do |user|\n          %tr\n            %td\n              :escaped\n                #{user}\n            %td.text-right\n              %a.btn.btn-sm.btn-danger{ :href => \"/admin/del_user_report/#{@report.id}/#{user}\" }\n                %i.far.fa-trash-alt{ :title => \"Remove Author\" }\n\n%br\n\n%form{ :method => \"post\", :action => \"/admin/add_user/#{@report.id}\" }\n  .form-group.row\n    %label.col-lg-2.col-form-label{ :for => \"author\" } Add Collaborator\n    .col-lg-4\n      %select#author.custom-select{ :name => \"author\" }\n        - @users.each do |user|\n          %option #{user.username}\n\n  %br\n  %input.btn.btn-primary{ :type => \"submit\", :value => \"Add\" }\n  %a.btn.btn-secondary{ :href => \"/reports/list\" }\n    Cancel\n", ".d-flex.justify-content-between.flex-wrap.flex-md-nowrap.align-items-center.pt-3.pb-2.mb-3.border-bottom\n  %h1.h2 Current Users\n\n- if @users\n  .table.table-striped\n    %table{ :style => \"width: 50%\" }\n      %thead\n        %tr\n          %td{ :style => \"width: 40%\" }\n            %b Username\n          %td{ :style => \"width: 34%\" }\n            %b Level/Authentication Type\n          %td.text-right{ :style => \"width: 15%\" }\n            %b Actions\n      %tbody\n        - @users.each do |user|\n          %tr\n            %td\n              :escaped\n                #{user.username}\n            %td\n              :escaped\n                #{user.type} / #{user.auth_type}\n            %td.text-right\n              %a.btn.btn-sm.btn-warning{ :href => \"/admin/edit_user/#{user.id}\" }\n                %i.fas.fa-pencil-alt{ :title => \"Edit Password\" }\n              %a.btn.btn-sm.btn-danger{ :href => \"/admin/delete/#{user.id}\" }\n                %i.far.fa-trash-alt{ :title => \"Delete User\" }\n- else\n  No Users. How Curious. Who are you?\n"], "filenames": ["views/add_user.haml", "views/add_user_report.haml", "views/list_user.haml"], "buggy_code_start_loc": [52, 2, 19], "buggy_code_end_loc": [52, 18, 22], "fixing_code_start_loc": [53, 2, 19], "fixing_code_end_loc": [54, 19, 24], "type": "CWE-79", "message": "An issue was discovered in Serpico (aka SimplE RePort wrIting and CollaboratiOn tool) 1.3.0. The User Type on the admin/list_user page allows stored XSS via the type parameter.", "other": {"cve": {"id": "CVE-2019-19856", "sourceIdentifier": "cve@mitre.org", "published": "2020-01-15T23:15:11.730", "lastModified": "2020-01-17T22:36:14.823", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "An issue was discovered in Serpico (aka SimplE RePort wrIting and CollaboratiOn tool) 1.3.0. The User Type on the admin/list_user page allows stored XSS via the type parameter."}, {"lang": "es", "value": "Se descubri\u00f3 un problema en Serpico (tambi\u00e9n se conoce como SimplE RePort wrIting and CollaboratiOn tool) versi\u00f3n 1.3.0. El User Type en la p\u00e1gina admin/list_user permite un ataque de tipo XSS almacenado por medio del par\u00e1metro type ."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:serpico_project:serpico:1.3.0:*:*:*:*:*:*:*", "matchCriteriaId": "5B0682FF-A9EC-4DE4-AF14-7956F3DB2800"}]}]}], "references": [{"url": "https://github.com/SerpicoProject/Serpico/commit/270f05ca6e51c87bb0867abb0511b61bf2aae182", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://websec.nl/news.php", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/SerpicoProject/Serpico/commit/270f05ca6e51c87bb0867abb0511b61bf2aae182"}}