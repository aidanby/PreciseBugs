{"buggy_code": ["[% IF id.defined %]\n    [% IF id %]\n        <h3>Update contractor</h3>\n    [% ELSE %]\n        <h3>Add new contractor</h3>\n    [% END %]\n\n    <form role=\"form\" method=\"post\">\n        <input type=\"hidden\" name=\"csrf_token\" value=\"[% csrf_token %]\">\n        <div class=\"row\">\n            <div class=\"col-sm-6\">\n                <div class=\"form-group\">\n\t\t    <input type=\"text\" name=\"name\" id=\"name\" class=\"form-control\" value=\"[% contractor.name %]\">\n                </div>\n                <div class=\"form-group\">\n\t\t    <button type=\"submit\" name=\"submit\" value=\"submit\" class=\"btn btn-default\">\n\t\t\t[% IF id %]\n\t\t\t    Update\n\t\t\t[% ELSE %]\n\t\t\t    Add\n\t\t\t[% END %]\n\t\t    </button>\n                    [% IF id %]\n                        <button type=\"submit\" name=\"delete\" value=\"submit\" class=\"btn btn-primary\">\n                            Delete\n                        </button>\n                    [% END %]\n                </div>\n            </div>\n            <div class=\"col-sm-6\">\n            </div>\n        </div>\n    </form>\n\n[% ELSE %]\n    <h3>Contractors</h3>\n    <p>\n        <a href=\"/contractor/0\" class=\"btn btn-default\" role=\"button\">Add new contractor</a>\n    </p>\n    [% IF contractors.size %]\n\t<table class=\"table table-striped\">\n\t    <tr>\n\t\t<th>ID</th>\n\t\t<th>Name</th>\n\t    </tr>\n\n\t    [% FOR contractor IN contractors %]\n\t    <tr>\n\t\t<td class=\"col-sm-1\"><a href=\"/contractor/[% contractor.id %]\">[% contractor.id %]</a></td>\n\t\t<td class=\"col-sm-10\">[% contractor.name %]</td>\n\t    </tr>\n\t    [% END %]\n\t</table> \n    [% ELSE %]\n\t<p>There are no existing contractors</p>\n    [% END %]\n[% END %]\n\n", "<h3>Tasks overdue and unplanned</h3>\n\n[% IF login.is_admin %]\n\n    [% IF tasks.size %]\n\n        <table class=\"table table-striped\">\n            <tr>\n                <th><a href=\"?sort=task\" style=\"color:inherit\">Task</a></th>\n                <th><a href=\"?sort=org\" style=\"color:inherit\">Site</a></th>\n                <th><a href=\"?sort=completed\" style=\"color:inherit\">Last done</a></th>\n                <th><a href=\"?sort=planned\" style=\"color:inherit\">Planned</a></th>\n                <th>Relevant uncompleted ticket</th>\n            </tr>\n\n            [% FOR task IN tasks %]\n                <tr>\n                    <td>[% task.name %]\n                    </td>\n                    <td>[% task.site.org.name %] ([% task.site.name %])</td>\n                    <td>\n                        [% IF task.last_completed %]\n                            <a href=\"/ticket/[% task.last_completed_id %]\">[% task.last_completed.strftime(dateformat) %]</a>\n                        [% ELSE %]\n                            (never)\n                        [% END %]\n                    </td>\n                    <td>\n                        [% IF task.last_planned %]\n                            <a href=\"/ticket/[% task.last_planned_id %]\">[% task.last_planned.strftime(dateformat) %]</a>\n                        [% ELSE %]\n                            (no planned date)\n                        [% END %]\n                    </td>\n                    <td>\n                        [% IF task.first_provisional_id %]\n                            <a href=\"/ticket/[% task.first_provisional_id %]\">\n                                Ticket [% task.first_provisional_id %]\n                            </a>\n                        [% ELSE %]\n                            [% IF login.is_admin OR NOT task.global %]\n                                (<a href=\"/ticket/0?task_id=[% task.id %]&site_id=[% task.site.id %]\">Create ticket</a>)\n                            [% ELSE %]\n                                (no uncompleted ticket)\n                            [% END %]\n                        [% END %]\n                    </td>\n                </tr>\n            [% END %]\n        </table>\n\n    [% ELSE %]\n\n        <p>No tasks overdue</p>\n\n    [% END %]\n\n[% END %]\n\n<h3>Calendar</h3>\n<table>\n    <tr>\n        <td><div class=\"circle event-important\"></div>Task overdue</td>\n        <td><div class=\"circle event-warning\"></div>Task due (not planned)</td>\n        <td><div class=\"circle event-info\"></div>Task planned</td>\n        <td><div class=\"circle event-success\"></div>Task completed</td>\n        <td><div class=\"circle event-special\"></div>Reactive</td>\n        <td><div class=\"circle event-warning-planned\"></div>Task due (planned for other date)</td>\n    </tr>\n    [% IF NOT login.is_admin %]\n        <tr>\n            <td><div class=\"check-margin check-notdone check-margin\"></div>Check not done</td>\n            <td><div class=\"check-margin check-due-daily\"></div>Check due</td>\n            <td><div class=\"check-margin check-partdone\"></div>Check partly done</td>\n            <td><div class=\"check-margin check-done\"></div>Check done</td>\n            <td><div class=\"check-margin check-comment\"></div>Check done with comments</td>\n        </tr>\n    [% END %]\n</table>\n<div class=\"page-header\">\n    <div class=\"pull-right form-inline\">\n        <div class=\"btn-group\">\n            <button class=\"btn btn-primary\" data-calendar-nav=\"prev\"><< Prev</button>\n            <button class=\"btn\" data-calendar-nav=\"today\">Today</button>\n            <button class=\"btn btn-primary\" data-calendar-nav=\"next\">Next >></button>\n        </div>\n        <div class=\"btn-group\">\n            <button class=\"btn btn-warning\" data-calendar-view=\"year\">Year</button>\n            <button class=\"btn btn-warning active\" data-calendar-view=\"month\">Month</button>\n            <button class=\"btn btn-warning\" data-calendar-view=\"week\">Week</button>\n            <button class=\"btn btn-warning\" data-calendar-view=\"day\">Day</button>\n        </div>\n    </div>\n    <h4></h4>\n</div>\n\n<div id=\"calendar\"></div>\n\n<p></p>\n\n"], "fixing_code": ["[% IF id.defined %]\n    [% IF id %]\n        <h3>Update contractor</h3>\n    [% ELSE %]\n        <h3>Add new contractor</h3>\n    [% END %]\n\n    <form role=\"form\" method=\"post\">\n        <input type=\"hidden\" name=\"csrf_token\" value=\"[% csrf_token %]\">\n        <div class=\"row\">\n            <div class=\"col-sm-6\">\n                <div class=\"form-group\">\n\t\t    <input type=\"text\" name=\"name\" id=\"name\" class=\"form-control\" value=\"[% contractor.name %]\">\n                </div>\n                <div class=\"form-group\">\n\t\t    <button type=\"submit\" name=\"submit\" value=\"submit\" class=\"btn btn-default\">\n\t\t\t[% IF id %]\n\t\t\t    Update\n\t\t\t[% ELSE %]\n\t\t\t    Add\n\t\t\t[% END %]\n\t\t    </button>\n                    [% IF id %]\n                        <button type=\"submit\" name=\"delete\" value=\"submit\" class=\"btn btn-primary\">\n                            Delete\n                        </button>\n                    [% END %]\n                </div>\n            </div>\n            <div class=\"col-sm-6\">\n            </div>\n        </div>\n    </form>\n\n[% ELSE %]\n    <h3>Contractors</h3>\n    <p>\n        <a href=\"/contractor/0\" class=\"btn btn-default\" role=\"button\">Add new contractor</a>\n    </p>\n    [% IF contractors.size %]\n\t<table class=\"table table-striped\">\n\t    <tr>\n\t\t<th>ID</th>\n\t\t<th>Name</th>\n\t    </tr>\n\n\t    [% FOR contractor IN contractors %]\n\t    <tr>\n\t\t<td class=\"col-sm-1\"><a href=\"/contractor/[% contractor.id %]\">[% contractor.id %]</a></td>\n\t\t<td class=\"col-sm-10\">[% contractor.name | html %]</td>\n\t    </tr>\n\t    [% END %]\n\t</table> \n    [% ELSE %]\n\t<p>There are no existing contractors</p>\n    [% END %]\n[% END %]\n\n", "<h3>Tasks overdue and unplanned</h3>\n\n[% IF login.is_admin %]\n\n    [% IF tasks.size %]\n\n        <table class=\"table table-striped\">\n            <tr>\n                <th><a href=\"?sort=task\" style=\"color:inherit\">Task</a></th>\n                <th><a href=\"?sort=org\" style=\"color:inherit\">Site</a></th>\n                <th><a href=\"?sort=completed\" style=\"color:inherit\">Last done</a></th>\n                <th><a href=\"?sort=planned\" style=\"color:inherit\">Planned</a></th>\n                <th>Relevant uncompleted ticket</th>\n            </tr>\n\n            [% FOR task IN tasks %]\n                <tr>\n                    <td>[% task.name | html %]\n                    </td>\n                    <td>[% task.site.org.name | html %] ([% task.site.name | html %])</td>\n                    <td>\n                        [% IF task.last_completed %]\n                            <a href=\"/ticket/[% task.last_completed_id %]\">[% task.last_completed.strftime(dateformat) %]</a>\n                        [% ELSE %]\n                            (never)\n                        [% END %]\n                    </td>\n                    <td>\n                        [% IF task.last_planned %]\n                            <a href=\"/ticket/[% task.last_planned_id %]\">[% task.last_planned.strftime(dateformat) %]</a>\n                        [% ELSE %]\n                            (no planned date)\n                        [% END %]\n                    </td>\n                    <td>\n                        [% IF task.first_provisional_id %]\n                            <a href=\"/ticket/[% task.first_provisional_id %]\">\n                                Ticket [% task.first_provisional_id %]\n                            </a>\n                        [% ELSE %]\n                            [% IF login.is_admin OR NOT task.global %]\n                                (<a href=\"/ticket/0?task_id=[% task.id %]&site_id=[% task.site.id %]\">Create ticket</a>)\n                            [% ELSE %]\n                                (no uncompleted ticket)\n                            [% END %]\n                        [% END %]\n                    </td>\n                </tr>\n            [% END %]\n        </table>\n\n    [% ELSE %]\n\n        <p>No tasks overdue</p>\n\n    [% END %]\n\n[% END %]\n\n<h3>Calendar</h3>\n<table>\n    <tr>\n        <td><div class=\"circle event-important\"></div>Task overdue</td>\n        <td><div class=\"circle event-warning\"></div>Task due (not planned)</td>\n        <td><div class=\"circle event-info\"></div>Task planned</td>\n        <td><div class=\"circle event-success\"></div>Task completed</td>\n        <td><div class=\"circle event-special\"></div>Reactive</td>\n        <td><div class=\"circle event-warning-planned\"></div>Task due (planned for other date)</td>\n    </tr>\n    [% IF NOT login.is_admin %]\n        <tr>\n            <td><div class=\"check-margin check-notdone check-margin\"></div>Check not done</td>\n            <td><div class=\"check-margin check-due-daily\"></div>Check due</td>\n            <td><div class=\"check-margin check-partdone\"></div>Check partly done</td>\n            <td><div class=\"check-margin check-done\"></div>Check done</td>\n            <td><div class=\"check-margin check-comment\"></div>Check done with comments</td>\n        </tr>\n    [% END %]\n</table>\n<div class=\"page-header\">\n    <div class=\"pull-right form-inline\">\n        <div class=\"btn-group\">\n            <button class=\"btn btn-primary\" data-calendar-nav=\"prev\"><< Prev</button>\n            <button class=\"btn\" data-calendar-nav=\"today\">Today</button>\n            <button class=\"btn btn-primary\" data-calendar-nav=\"next\">Next >></button>\n        </div>\n        <div class=\"btn-group\">\n            <button class=\"btn btn-warning\" data-calendar-view=\"year\">Year</button>\n            <button class=\"btn btn-warning active\" data-calendar-view=\"month\">Month</button>\n            <button class=\"btn btn-warning\" data-calendar-view=\"week\">Week</button>\n            <button class=\"btn btn-warning\" data-calendar-view=\"day\">Day</button>\n        </div>\n    </div>\n    <h4></h4>\n</div>\n\n<div id=\"calendar\"></div>\n\n<p></p>\n\n"], "filenames": ["views/contractor.tt", "views/index.tt"], "buggy_code_start_loc": [50, 18], "buggy_code_end_loc": [51, 21], "fixing_code_start_loc": [50, 18], "fixing_code_end_loc": [51, 21], "type": "CWE-79", "message": "A vulnerability was found in ctrlo lenio. It has been classified as problematic. This affects an unknown part of the file views/index.tt. The manipulation of the argument task.name/task.site.org.name leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is e1646d5cd0a2fbab9eb505196dd2ca1c9e4cdd97. It is recommended to apply a patch to fix this issue. The identifier VDB-216213 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2021-4256", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-18T22:15:10.547", "lastModified": "2022-12-22T19:31:30.630", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in ctrlo lenio. It has been classified as problematic. This affects an unknown part of the file views/index.tt. The manipulation of the argument task.name/task.site.org.name leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is e1646d5cd0a2fbab9eb505196dd2ca1c9e4cdd97. It is recommended to apply a patch to fix this issue. The identifier VDB-216213 was assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-707"}, {"lang": "en", "value": "CWE-74"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:ctrlo:lenio:*:*:*:*:*:*:*:*", "versionEndIncluding": "2021-02-08", "matchCriteriaId": "53D6F2CB-C411-41D1-8115-A4C3BD661474"}]}]}], "references": [{"url": "https://github.com/ctrlo/lenio/commit/e1646d5cd0a2fbab9eb505196dd2ca1c9e4cdd97", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.216213", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/ctrlo/lenio/commit/e1646d5cd0a2fbab9eb505196dd2ca1c9e4cdd97"}}