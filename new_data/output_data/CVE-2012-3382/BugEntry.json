{"buggy_code": ["//\n// System.Web.HttpForbiddenHandler\n//\n// Authors:\n//\tGonzalo Paniagua Javier (gonzalo@ximian.com)\n//\n// (C) 2002 Ximian, Inc (http://www.ximian.com)\n//\n\n//\n// Permission is hereby granted, free of charge, to any person obtaining\n// a copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to\n// permit persons to whom the Software is furnished to do so, subject to\n// the following conditions:\n// \n// The above copyright notice and this permission notice shall be\n// included in all copies or substantial portions of the Software.\n// \n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\nnamespace System.Web\n{\n\tclass HttpForbiddenHandler : IHttpHandler\n\t{\n\t\tpublic void ProcessRequest (HttpContext context)\n\t\t{\n\t\t\tHttpRequest req = context != null ? context.Request : null;\n\t\t\tstring path = req != null ? req.Path : null;\n\t\t\tstring description = \"The type of page you have requested is not served because it has been explicitly forbidden. The extension '\" +\n\t\t\t\t(path == null ? String.Empty : VirtualPathUtility.GetExtension (path)) +\n\t\t\t\t\"' may be incorrect. Please review the URL below and make sure that it is spelled correctly.\";\n\t\t\t\t\n\t\t\tthrow new HttpException (403,\n\t\t\t\t\t\t \"This type of page is not served.\",\n\t\t\t\t\t\t req != null ? req.Path : null,\n\t\t\t\t\t\t description);\n\t\t}\n\n\t\tpublic bool IsReusable\n\t\t{\n\t\t\tget {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n}\n\n"], "fixing_code": ["//\n// System.Web.HttpForbiddenHandler\n//\n// Authors:\n//\tGonzalo Paniagua Javier (gonzalo@ximian.com)\n//\n// (C) 2002 Ximian, Inc (http://www.ximian.com)\n//\n\n//\n// Permission is hereby granted, free of charge, to any person obtaining\n// a copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to\n// permit persons to whom the Software is furnished to do so, subject to\n// the following conditions:\n// \n// The above copyright notice and this permission notice shall be\n// included in all copies or substantial portions of the Software.\n// \n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\nnamespace System.Web\n{\n\tclass HttpForbiddenHandler : IHttpHandler\n\t{\n\t\tpublic void ProcessRequest (HttpContext context)\n\t\t{\n\t\t\tHttpRequest req = context != null ? context.Request : null;\n\t\t\tstring path = req != null ? req.Path : null;\n\t\t\tstring description = \"The type of page you have requested is not served because it has been explicitly forbidden. The extension '\" +\n\t\t\t\t(path == null ? String.Empty : VirtualPathUtility.GetExtension (path)) +\n\t\t\t\t\"' may be incorrect. Please review the URL below and make sure that it is spelled correctly.\";\n\t\t\t\t\n\t\t\tthrow new HttpException (403,\n\t\t\t\t\t\t \"This type of page is not served.\",\n\t\t\t\t\t\t req != null ? HttpUtility.HtmlEncode (req.Path) : null,\n\t\t\t\t\t\t description);\n\t\t}\n\n\t\tpublic bool IsReusable\n\t\t{\n\t\t\tget {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n}\n\n"], "filenames": ["mcs/class/System.Web/System.Web/HttpForbiddenHandler.cs"], "buggy_code_start_loc": [45], "buggy_code_end_loc": [46], "fixing_code_start_loc": [45], "fixing_code_end_loc": [46], "type": "CWE-79", "message": "Cross-site scripting (XSS) vulnerability in the ProcessRequest function in mcs/class/System.Web/System.Web/HttpForbiddenHandler.cs in Mono 2.10.8 and earlier allows remote attackers to inject arbitrary web script or HTML via a file with a crafted name and a forbidden extension, which is not properly handled in an error message.", "other": {"cve": {"id": "CVE-2012-3382", "sourceIdentifier": "secalert@redhat.com", "published": "2012-07-12T21:55:08.187", "lastModified": "2013-04-05T03:11:57.297", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in the ProcessRequest function in mcs/class/System.Web/System.Web/HttpForbiddenHandler.cs in Mono 2.10.8 and earlier allows remote attackers to inject arbitrary web script or HTML via a file with a crafted name and a forbidden extension, which is not properly handled in an error message."}, {"lang": "es", "value": "Una vulnerabilidad de ejecuci\u00f3n de comandos en sitios cruzados (XSS) en la funci\u00f3n ProcessRequest en mcs/class/System.Web/System.web/HttpForbiddenHandler.cs en Mono v2.10.8 y anteriores permite a atacantes remotos inyectar secuencias de comandos web o HTML a trav\u00e9s de un archivo con un nombre modificado y una extensi\u00f3n prohibida, que no es correctamente manipulado en un mensaje de error."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mono:mono:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.10.8", "matchCriteriaId": "74ABAAEC-7F7A-4561-9C97-9FD3B4B353E0"}]}]}], "references": [{"url": "http://www.mandriva.com/security/advisories?name=MDVSA-2012:140", "source": "secalert@redhat.com"}, {"url": "http://www.openwall.com/lists/oss-security/2012/07/06/11", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.novell.com/show_bug.cgi?id=769799", "source": "secalert@redhat.com"}, {"url": "https://github.com/mono/mono/commit/d16d4623edb210635bec3ca3786481b82cde25a2", "source": "secalert@redhat.com", "tags": ["Exploit", "Patch"]}, {"url": "https://hermes.opensuse.org/messages/15374367", "source": "secalert@redhat.com"}]}, "github_commit_url": "https://github.com/mono/mono/commit/d16d4623edb210635bec3ca3786481b82cde25a2"}}