{"buggy_code": ["# $FreeBSD$\n\nPORTNAME=\tpfSense-pkg-freeradius3\nPORTVERSION=\t0.15.7\nPORTREVISION=\t2\nCATEGORIES=\tnet\nMASTER_SITES=\t# empty\nDISTFILES=\t# empty\nEXTRACT_ONLY=\t# empty\n\nMAINTAINER=\tcoreteam@pfsense.org\nCOMMENT=\tFreeRADIUS 3.x package for pfSense\n\nLICENSE=\tAPACHE20\n\nRUN_DEPENDS=\t${LOCALBASE}/sbin/radiusd:net/freeradius3 \\\n\t\t${LOCALBASE}/bin/bash:shells/bash\n\nUSES=\t\tpython shebangfix\n\nNO_BUILD=\tyes\nNO_MTREE=\tyes\n\nSUB_FILES=\tpkg-install pkg-deinstall\nSUB_LIST=\tPORTNAME=${PORTNAME}\n\nSHEBANG_FILES=\t${WRKSRC}${PREFIX}/pkg/googleauth.py\n\ndo-extract:\n\t${MKDIR} ${WRKSRC}\n\t${CP} -R ${FILESDIR}/ ${WRKSRC}\n\ndo-install:\n\t${MKDIR} ${STAGEDIR}${PREFIX}/pkg\n\t${MKDIR} ${STAGEDIR}/etc/inc/priv\n\t${MKDIR} ${STAGEDIR}${PREFIX}/www/freeradius/qrcode/\n\t${MKDIR} ${STAGEDIR}${DATADIR}\n\t${INSTALL_DATA} -m 0644 ${WRKSRC}${PREFIX}/pkg/freeradius.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradius.inc \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}/etc/inc/priv/freeradius.priv.inc \\\n\t\t${STAGEDIR}/etc/inc/priv\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/www/freeradius_view_config.php \\\n\t\t${STAGEDIR}${PREFIX}/www\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/www/freeradius/qrcode/LICENSE \\\n\t\t${STAGEDIR}${PREFIX}/www/freeradius/qrcode\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/www/freeradius/qrcode/qrcode.js \\\n\t\t${STAGEDIR}${PREFIX}/www/freeradius/qrcode\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiusclients.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiussettings.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiuseapconf.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiussqlconf.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiusinterfaces.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiussync.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiusmodulesldap.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiusauthorizedmacs.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${DATADIR}/info.xml \\\n\t\t${STAGEDIR}${DATADIR}\n\t${INSTALL_SCRIPT} ${WRKSRC}${PREFIX}/pkg/googleauth.py \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t@${REINPLACE_CMD} -i '' -e \"s|%%PKGVERSION%%|${PKGVERSION}|\" \\\n\t\t${STAGEDIR}${DATADIR}/info.xml\n\n.include <bsd.port.mk>\n", "<?php\n/*\n * freeradius_view_config.php\n *\n * part of pfSense (https://www.pfsense.org)\n * Copyright (c) 2015-2017 Rubicon Communications, LLC (Netgate)\n * Copyright (c) 2013 Alexander Wilke <nachtfalkeaw@web.de>\n * Copyright (c) 2011 Marcello Coutinho <marcellocoutinho@gmail.com>\n * All rights reserved.\n *\n * Originally based on m0n0wall (http://m0n0.ch/wall)\n * Copyright (C) 2003-2006 Manuel Kasper <mk@neon1.net>.\n * All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nrequire(\"guiconfig.inc\");\nrequire(\"freeradius.inc\");\n\nfunction get_file($file) {\n\t$files['radiusd'] = FREERADIUS_RADDB . \"/radiusd.conf\";\n\t$files['eap'] = FREERADIUS_MODSENABLED . \"/eap\";\n\t$files['sql'] = FREERADIUS_MODSENABLED . \"/sql\";\n\t$files['clients'] = FREERADIUS_RADDB . \"/clients.conf\";\n\t$files['users'] = FREERADIUS_RADDB . \"/users\";\n\t$files['macs'] = FREERADIUS_RADDB . \"/authorized_macs\";\n\t$files['virtual-server-default'] = FREERADIUS_RADDB . \"/sites-enabled/default\";\n\t$files['ldap'] = FREERADIUS_MODSENABLED . \"/ldap\";\n\n\tif ($files[$file] != \"\" && file_exists($files[$file])) {\n\t\tprint '<pre>';\n\t\tprint $files[$file] . \"\\n\" . file_get_contents($files[$file]);\n\t\tprint '</pre>';\n\t}\n}\n\nif ($_REQUEST['file'] != \"\") {\n\tget_file($_REQUEST['file']);\n\treturn;\n}\n\n$pgtitle = array(gettext(\"Package\"), gettext(\"FreeRADIUS\"), gettext(\"View Configuration\"));\nrequire(\"head.inc\");\n\n$tab_array = array();\n$tab_array[] = array(gettext(\"Users\"), false, \"/pkg.php?xml=freeradius.xml\");\n$tab_array[] = array(gettext(\"MACs\"), false, \"/pkg.php?xml=freeradiusauthorizedmacs.xml\");\n$tab_array[] = array(gettext(\"NAS / Clients\"), false, \"/pkg.php?xml=freeradiusclients.xml\");\n$tab_array[] = array(gettext(\"Interfaces\"), false, \"/pkg.php?xml=freeradiusinterfaces.xml\");\n$tab_array[] = array(gettext(\"Settings\"), false, \"/pkg_edit.php?xml=freeradiussettings.xml&id=0\");\n$tab_array[] = array(gettext(\"EAP\"), false, \"/pkg_edit.php?xml=freeradiuseapconf.xml&id=0\");\n$tab_array[] = array(gettext(\"SQL\"), false, \"/pkg_edit.php?xml=freeradiussqlconf.xml&id=0\");\n$tab_array[] = array(gettext(\"LDAP\"), false, \"/pkg_edit.php?xml=freeradiusmodulesldap.xml&id=0\");\n$tab_array[] = array(gettext(\"View config\"), true, \"/freeradius_view_config.php\");\n$tab_array[] = array(gettext(\"XMLRPC Sync\"), false, \"/pkg_edit.php?xml=freeradiussync.xml&amp;id=0\");\ndisplay_top_tabs($tab_array);\n\nif ($savemsg) {\n\tprint_info_box($savemsg);\n}\n?>\n\n<div class=\"panel panel-default\">\n\t<div class=\"panel-heading\"><h2 class=\"panel-title\"><?=gettext(\"View FreeRADIUS Configuration Files\"); ?></h2></div>\n\t<div class=\"panel-body\">\n\t\t<div class=\"table-responsive\">\n\t\t\t<form action=\"freeradius_view_config.php\" method=\"post\">\n\t\t\t<table class=\"table table-hover table-condensed\">\n\t\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th class=\"text-center\">\n\t\t\t\t\t\t<div class=\"btn-group\">\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('radiusd');\" id='btn_radiusd' value=\"radiusd.conf\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tradiusd.conf\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('eap');\" id='btn_eap' value=\"eap.conf\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\teap\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('sql');\" id='btn_sql' value=\"sql.conf\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tsql\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('clients');\" id='btn_clients' value=\"clients.conf\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tclients.conf\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('users');\" id='btn_users' value=\"users\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tusers\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('macs');\" id='btn_macs' value=\"macs\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tmacs\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('virtual-server-default');\" id='btn_virtual-server-default' value=\"virtual-server-default\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tvirtual-server-default\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('ldap');\" id='btn_ldap' value=\"ldap\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tldap\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</th>\n\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td colspan=\"12\">\n\t\t\t\t\t\t\t<div id=\"file_div\">Click one of the buttons above to display its contents.</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n</div>\n<script type=\"text/javascript\">\n//<![CDATA[\nfunction get_freeradius_file(file) {\n\t$('#btn_'+file).value=\"reading...\";\n\tvar pars = 'file='+file;\n\tvar url = \"/freeradius_view_config.php\";\n\tjQuery.ajax(url,\n\t\t{\n\t\ttype: 'post',\n\t\tdata: pars,\n\t\tsuccess: activitycallback_freeradius_file,\n\t\terror: function() {\n\t\t\t$('#file_div').html(\"<div class=\\\"alert alert-danger\\\"><?=gettext('Unable to retrieve file'); ?></div>\");\n\t\t}\n\t});\n}\nfunction activitycallback_freeradius_file(html) {\n\t$('#file_div').html(html);\n\t$('#btn_radiusd').value=\"radiusd.conf\";\n\t$('#btn_eap').value=\"eap.conf\";\n\t$('#btn_sql').value=\"sql.conf\";\n\t$('#btn_clients').value=\"clients.conf\";\n\t$('#btn_users').value=\"users\";\n\t$('#btn_macs').value=\"macs\";\n\t$('#btn_virtual').value=\"virtual-server-default\";\n\t$('#btn_ldap').value=\"ldap\";\n\tscroll(0,0);\n}\n//]]>\n</script>\n\n<?php include(\"foot.inc\"); ?>\n"], "fixing_code": ["# $FreeBSD$\n\nPORTNAME=\tpfSense-pkg-freeradius3\nPORTVERSION=\t0.15.7\nPORTREVISION=\t3\nCATEGORIES=\tnet\nMASTER_SITES=\t# empty\nDISTFILES=\t# empty\nEXTRACT_ONLY=\t# empty\n\nMAINTAINER=\tcoreteam@pfsense.org\nCOMMENT=\tFreeRADIUS 3.x package for pfSense\n\nLICENSE=\tAPACHE20\n\nRUN_DEPENDS=\t${LOCALBASE}/sbin/radiusd:net/freeradius3 \\\n\t\t${LOCALBASE}/bin/bash:shells/bash\n\nUSES=\t\tpython shebangfix\n\nNO_BUILD=\tyes\nNO_MTREE=\tyes\n\nSUB_FILES=\tpkg-install pkg-deinstall\nSUB_LIST=\tPORTNAME=${PORTNAME}\n\nSHEBANG_FILES=\t${WRKSRC}${PREFIX}/pkg/googleauth.py\n\ndo-extract:\n\t${MKDIR} ${WRKSRC}\n\t${CP} -R ${FILESDIR}/ ${WRKSRC}\n\ndo-install:\n\t${MKDIR} ${STAGEDIR}${PREFIX}/pkg\n\t${MKDIR} ${STAGEDIR}/etc/inc/priv\n\t${MKDIR} ${STAGEDIR}${PREFIX}/www/freeradius/qrcode/\n\t${MKDIR} ${STAGEDIR}${DATADIR}\n\t${INSTALL_DATA} -m 0644 ${WRKSRC}${PREFIX}/pkg/freeradius.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradius.inc \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}/etc/inc/priv/freeradius.priv.inc \\\n\t\t${STAGEDIR}/etc/inc/priv\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/www/freeradius_view_config.php \\\n\t\t${STAGEDIR}${PREFIX}/www\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/www/freeradius/qrcode/LICENSE \\\n\t\t${STAGEDIR}${PREFIX}/www/freeradius/qrcode\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/www/freeradius/qrcode/qrcode.js \\\n\t\t${STAGEDIR}${PREFIX}/www/freeradius/qrcode\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiusclients.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiussettings.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiuseapconf.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiussqlconf.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiusinterfaces.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiussync.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiusmodulesldap.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${PREFIX}/pkg/freeradiusauthorizedmacs.xml \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t${INSTALL_DATA} ${WRKSRC}${DATADIR}/info.xml \\\n\t\t${STAGEDIR}${DATADIR}\n\t${INSTALL_SCRIPT} ${WRKSRC}${PREFIX}/pkg/googleauth.py \\\n\t\t${STAGEDIR}${PREFIX}/pkg\n\t@${REINPLACE_CMD} -i '' -e \"s|%%PKGVERSION%%|${PKGVERSION}|\" \\\n\t\t${STAGEDIR}${DATADIR}/info.xml\n\n.include <bsd.port.mk>\n", "<?php\n/*\n * freeradius_view_config.php\n *\n * part of pfSense (https://www.pfsense.org)\n * Copyright (c) 2015-2017 Rubicon Communications, LLC (Netgate)\n * Copyright (c) 2013 Alexander Wilke <nachtfalkeaw@web.de>\n * Copyright (c) 2011 Marcello Coutinho <marcellocoutinho@gmail.com>\n * All rights reserved.\n *\n * Originally based on m0n0wall (http://m0n0.ch/wall)\n * Copyright (C) 2003-2006 Manuel Kasper <mk@neon1.net>.\n * All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nrequire(\"guiconfig.inc\");\nrequire(\"freeradius.inc\");\n\nfunction get_file($file) {\n\t$files['radiusd'] = FREERADIUS_RADDB . \"/radiusd.conf\";\n\t$files['eap'] = FREERADIUS_MODSENABLED . \"/eap\";\n\t$files['sql'] = FREERADIUS_MODSENABLED . \"/sql\";\n\t$files['clients'] = FREERADIUS_RADDB . \"/clients.conf\";\n\t$files['users'] = FREERADIUS_RADDB . \"/users\";\n\t$files['macs'] = FREERADIUS_RADDB . \"/authorized_macs\";\n\t$files['virtual-server-default'] = FREERADIUS_RADDB . \"/sites-enabled/default\";\n\t$files['ldap'] = FREERADIUS_MODSENABLED . \"/ldap\";\n\n\tif ($files[$file] != \"\" && file_exists($files[$file])) {\n\t\tprint '<pre>';\n\t\tprint $files[$file] . \"\\n\" . htmlspecialchars(file_get_contents($files[$file]));\n\t\tprint '</pre>';\n\t}\n}\n\nif ($_REQUEST['file'] != \"\") {\n\tget_file($_REQUEST['file']);\n\treturn;\n}\n\n$pgtitle = array(gettext(\"Package\"), gettext(\"FreeRADIUS\"), gettext(\"View Configuration\"));\nrequire(\"head.inc\");\n\n$tab_array = array();\n$tab_array[] = array(gettext(\"Users\"), false, \"/pkg.php?xml=freeradius.xml\");\n$tab_array[] = array(gettext(\"MACs\"), false, \"/pkg.php?xml=freeradiusauthorizedmacs.xml\");\n$tab_array[] = array(gettext(\"NAS / Clients\"), false, \"/pkg.php?xml=freeradiusclients.xml\");\n$tab_array[] = array(gettext(\"Interfaces\"), false, \"/pkg.php?xml=freeradiusinterfaces.xml\");\n$tab_array[] = array(gettext(\"Settings\"), false, \"/pkg_edit.php?xml=freeradiussettings.xml&id=0\");\n$tab_array[] = array(gettext(\"EAP\"), false, \"/pkg_edit.php?xml=freeradiuseapconf.xml&id=0\");\n$tab_array[] = array(gettext(\"SQL\"), false, \"/pkg_edit.php?xml=freeradiussqlconf.xml&id=0\");\n$tab_array[] = array(gettext(\"LDAP\"), false, \"/pkg_edit.php?xml=freeradiusmodulesldap.xml&id=0\");\n$tab_array[] = array(gettext(\"View config\"), true, \"/freeradius_view_config.php\");\n$tab_array[] = array(gettext(\"XMLRPC Sync\"), false, \"/pkg_edit.php?xml=freeradiussync.xml&amp;id=0\");\ndisplay_top_tabs($tab_array);\n\nif ($savemsg) {\n\tprint_info_box($savemsg);\n}\n?>\n\n<div class=\"panel panel-default\">\n\t<div class=\"panel-heading\"><h2 class=\"panel-title\"><?=gettext(\"View FreeRADIUS Configuration Files\"); ?></h2></div>\n\t<div class=\"panel-body\">\n\t\t<div class=\"table-responsive\">\n\t\t\t<form action=\"freeradius_view_config.php\" method=\"post\">\n\t\t\t<table class=\"table table-hover table-condensed\">\n\t\t\t\t<thead>\n\t\t\t\t<tr>\n\t\t\t\t\t<th class=\"text-center\">\n\t\t\t\t\t\t<div class=\"btn-group\">\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('radiusd');\" id='btn_radiusd' value=\"radiusd.conf\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tradiusd.conf\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('eap');\" id='btn_eap' value=\"eap.conf\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\teap\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('sql');\" id='btn_sql' value=\"sql.conf\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tsql\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('clients');\" id='btn_clients' value=\"clients.conf\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tclients.conf\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('users');\" id='btn_users' value=\"users\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tusers\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('macs');\" id='btn_macs' value=\"macs\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tmacs\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('virtual-server-default');\" id='btn_virtual-server-default' value=\"virtual-server-default\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tvirtual-server-default\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<button type=\"button\" class=\"btn btn-default btn-sm\" onClick=\"get_freeradius_file('ldap');\" id='btn_ldap' value=\"ldap\">\n\t\t\t\t\t\t\t\t<i class=\"fa fa-file-text-o\"></i>\n\t\t\t\t\t\t\t\tldap\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</th>\n\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td colspan=\"12\">\n\t\t\t\t\t\t\t<div id=\"file_div\">Click one of the buttons above to display its contents.</div>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n</div>\n<script type=\"text/javascript\">\n//<![CDATA[\nfunction get_freeradius_file(file) {\n\t$('#btn_'+file).value=\"reading...\";\n\tvar pars = 'file='+file;\n\tvar url = \"/freeradius_view_config.php\";\n\tjQuery.ajax(url,\n\t\t{\n\t\ttype: 'post',\n\t\tdata: pars,\n\t\tsuccess: activitycallback_freeradius_file,\n\t\terror: function() {\n\t\t\t$('#file_div').html(\"<div class=\\\"alert alert-danger\\\"><?=gettext('Unable to retrieve file'); ?></div>\");\n\t\t}\n\t});\n}\nfunction activitycallback_freeradius_file(html) {\n\t$('#file_div').html(html);\n\t$('#btn_radiusd').value=\"radiusd.conf\";\n\t$('#btn_eap').value=\"eap.conf\";\n\t$('#btn_sql').value=\"sql.conf\";\n\t$('#btn_clients').value=\"clients.conf\";\n\t$('#btn_users').value=\"users\";\n\t$('#btn_macs').value=\"macs\";\n\t$('#btn_virtual').value=\"virtual-server-default\";\n\t$('#btn_ldap').value=\"ldap\";\n\tscroll(0,0);\n}\n//]]>\n</script>\n\n<?php include(\"foot.inc\"); ?>\n"], "filenames": ["net/pfSense-pkg-freeradius3/Makefile", "net/pfSense-pkg-freeradius3/files/usr/local/www/freeradius_view_config.php"], "buggy_code_start_loc": [5, 43], "buggy_code_end_loc": [6, 44], "fixing_code_start_loc": [5, 43], "fixing_code_end_loc": [6, 44], "type": "CWE-79", "message": "/usr/local/www/freeradius_view_config.php in the freeradius3 package before 0.15.7_3 for pfSense on FreeBSD allows a user with an XSS payload as password or username to execute arbitrary javascript code on a victim browser.", "other": {"cve": {"id": "CVE-2019-18667", "sourceIdentifier": "cve@mitre.org", "published": "2019-11-02T16:15:10.217", "lastModified": "2019-11-07T18:09:22.370", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "/usr/local/www/freeradius_view_config.php in the freeradius3 package before 0.15.7_3 for pfSense on FreeBSD allows a user with an XSS payload as password or username to execute arbitrary javascript code on a victim browser."}, {"lang": "es", "value": "El archivo /usr/local/www/freeradius_view_config.php en el paquete freeradius3 versiones anteriores a 0.15.7_3 para pfSense, en FreeBSD permite a un usuario con una carga \u00fatil XSS como contrase\u00f1a o nombre de usuario ejecutar c\u00f3digo javascript arbitrario en el navegador de la v\u00edctima."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:pfsense:pfsense-pkg-freeradius3:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.15.7_3", "matchCriteriaId": "7A39BF14-532D-49EF-A388-E11B4B3211B4"}]}]}], "references": [{"url": "https://github.com/pfsense/FreeBSD-ports/commit/30b22b6b0db7b73732a5da346afca66dc244e02a", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/pfsense/FreeBSD-ports/commit/30b22b6b0db7b73732a5da346afca66dc244e02a"}}