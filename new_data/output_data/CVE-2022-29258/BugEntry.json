{"buggy_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.2\" reference=\"Filter.FilterStreamDescriptorForm\" locale=\"\">\n  <web>Filter</web>\n  <name>FilterStreamDescriptorForm</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title/>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{velocity output=\"false\"}}\n#macro(filterDescriptorForm $descriptor $id)\n  &lt;dl#if ($id) id=\"$id\"#end&gt;\n    #foreach($descriptor in $descriptor.properties)\n      #if ($id)\n        #set($descriptorId = \"${id}_descriptor_${descriptor.id}\")\n      #else\n        #set($descriptorId = \"descriptor_${descriptor.id}\")\n      #end\n      &lt;dt&gt;\n        &lt;label for=\"$descriptorId\"&gt;$descriptor.name&lt;/label&gt;\n        &lt;span class=\"xHint\"&gt;$descriptor.description&lt;/span&gt;\n        &lt;span class=\"xHint\"&gt;&lt;tt&gt;#if($descriptor.type.name)$descriptor.type.name#{else}$descriptor.type#end&lt;/tt&gt;&lt;/span&gt;\n        #if ($descriptor.type.getName() == 'org.xwiki.filter.output.OutputTarget')\n          &lt;span class=\"xHint\"&gt;&lt;tt&gt;Supported format is &lt;strong&gt;file:&amp;lt;path in server&amp;gt;&lt;/strong&gt; (e.g. &lt;strong&gt;file:/home/myuser/target.xml&lt;/strong&gt;). When empty it send a file named &lt;strong&gt;target&lt;/strong&gt; to the browser.&lt;/tt&gt;&lt;/span&gt;\n        #elseif ($descriptor.type.getName() == 'org.xwiki.filter.input.InputSource')\n          &lt;span class=\"xHint\"&gt;&lt;tt&gt;Supported formats are &lt;strong&gt;file:&amp;lt;path in server&amp;gt;&lt;/strong&gt; (e.g. &lt;strong&gt;file:/home/myuser/target.ext&lt;/strong&gt;) and &lt;strong&gt;url:&amp;lt;url&amp;gt;&lt;/strong&gt; (e.g. &lt;strong&gt;url:http://myserver/some/file/to/parse.ext&lt;/strong&gt;). When empty it read the request input stream.&lt;/tt&gt;&lt;/span&gt;\n        #end\n      &lt;/dt&gt;\n      &lt;dd&gt;\n        ## TODO: design a real framework to generate form by type\n        #if (($descriptor.defaultValue || \"$!descriptor.defaultValue\" != '') &amp;&amp; ($descriptor.type.getName() == 'boolean' || $descriptor.type.getName() == 'int' || $descriptor.type.getName() == 'java.lang.String'))\n          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\" value=\"#if($request.get($descriptorId))$request.get($descriptorId)#else$descriptor.defaultValue#end\"/&gt;\n        #else\n          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\"#if($request.get($descriptorId))value=\"$request.get($descriptorId)\"#end/&gt;\n        #end\n      &lt;/dd&gt;\n    #end\n  &lt;/dl&gt;\n#end\n{{/velocity}}\n\n{{velocity wiki=false}}\n#if ($xcontext.action == 'get' &amp;&amp; $request.type)\n  #if ($request.input == 'true')\n    #filterDescriptorForm($services.filter.getInputFilterStreamDescriptor($request.type), $request.id)\n  #else\n    #filterDescriptorForm($services.filter.getOutputFilterStreamDescriptor($request.type), $request.id)\n  #end\n#end\n{{/velocity}}</content>\n</xwikidoc>\n"], "fixing_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.2\" reference=\"Filter.FilterStreamDescriptorForm\" locale=\"\">\n  <web>Filter</web>\n  <name>FilterStreamDescriptorForm</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title/>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>{{velocity output=\"false\"}}\n#macro(filterDescriptorForm $descriptor $id)\n  &lt;dl#if ($id) id=\"$id\"#end&gt;\n    #foreach($descriptor in $descriptor.properties)\n      #if ($id)\n        #set($descriptorId = \"${id}_descriptor_${descriptor.id}\")\n      #else\n        #set($descriptorId = \"descriptor_${descriptor.id}\")\n      #end\n      &lt;dt&gt;\n        &lt;label for=\"$descriptorId\"&gt;$descriptor.name&lt;/label&gt;\n        &lt;span class=\"xHint\"&gt;$descriptor.description&lt;/span&gt;\n        &lt;span class=\"xHint\"&gt;&lt;tt&gt;#if($descriptor.type.name)$descriptor.type.name#{else}$descriptor.type#end&lt;/tt&gt;&lt;/span&gt;\n        #if ($descriptor.type.getName() == 'org.xwiki.filter.output.OutputTarget')\n          &lt;span class=\"xHint\"&gt;&lt;tt&gt;Supported format is &lt;strong&gt;file:&amp;lt;path in server&amp;gt;&lt;/strong&gt; (e.g. &lt;strong&gt;file:/home/myuser/target.xml&lt;/strong&gt;). When empty it send a file named &lt;strong&gt;target&lt;/strong&gt; to the browser.&lt;/tt&gt;&lt;/span&gt;\n        #elseif ($descriptor.type.getName() == 'org.xwiki.filter.input.InputSource')\n          &lt;span class=\"xHint\"&gt;&lt;tt&gt;Supported formats are &lt;strong&gt;file:&amp;lt;path in server&amp;gt;&lt;/strong&gt; (e.g. &lt;strong&gt;file:/home/myuser/target.ext&lt;/strong&gt;) and &lt;strong&gt;url:&amp;lt;url&amp;gt;&lt;/strong&gt; (e.g. &lt;strong&gt;url:http://myserver/some/file/to/parse.ext&lt;/strong&gt;). When empty it read the request input stream.&lt;/tt&gt;&lt;/span&gt;\n        #end\n      &lt;/dt&gt;\n      &lt;dd&gt;\n        ## TODO: design a real framework to generate form by type\n        #if (($descriptor.defaultValue || \"$!descriptor.defaultValue\" != '') &amp;&amp; ($descriptor.type.getName() == 'boolean' || $descriptor.type.getName() == 'int' || $descriptor.type.getName() == 'java.lang.String'))\n          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\" value=\"#if($request.get($descriptorId))$escapetool.xml($request.get($descriptorId))#else$descriptor.defaultValue#end\"/&gt;\n        #else\n          &lt;input type=\"text\" id=\"$descriptorId\" name=\"$descriptorId\"#if($request.get($descriptorId))value=\"$escapetool.xml($request.get($descriptorId))\"#end/&gt;\n        #end\n      &lt;/dd&gt;\n    #end\n  &lt;/dl&gt;\n#end\n{{/velocity}}\n\n{{velocity wiki=false}}\n#if ($xcontext.action == 'get' &amp;&amp; $request.type)\n  #if ($request.input == 'true')\n    #filterDescriptorForm($services.filter.getInputFilterStreamDescriptor($request.type), $request.id)\n  #else\n    #filterDescriptorForm($services.filter.getOutputFilterStreamDescriptor($request.type), $request.id)\n  #end\n#end\n{{/velocity}}</content>\n</xwikidoc>\n"], "filenames": ["xwiki-platform-core/xwiki-platform-filter/xwiki-platform-filter-ui/src/main/resources/Filter/FilterStreamDescriptorForm.xml"], "buggy_code_start_loc": [61], "buggy_code_end_loc": [64], "fixing_code_start_loc": [61], "fixing_code_end_loc": [64], "type": "CWE-79", "message": "XWiki Platform Filter UI provides a generic user interface to convert from a XWiki Filter input stream to an output stream with settings for each stream. Starting with versions 6.0-milestone-2 and 5.4.4 and prior to versions 12.10.11, 14.0-rc-1, 13.4.7, and 13.10.3, XWiki Platform Filter UI contains a possible cross-site scripting vector in the `Filter.FilterStreamDescriptorForm` wiki page related to pretty much all the form fields printed in the home page of the application. The issue is patched in versions 12.10.11, 14.0-rc-1, 13.4.7, and 13.10.3. The easiest workaround is to edit the wiki page `Filter.FilterStreamDescriptorForm` (with wiki editor) according to the instructions in the GitHub Security Advisory.", "other": {"cve": {"id": "CVE-2022-29258", "sourceIdentifier": "security-advisories@github.com", "published": "2022-05-31T17:15:07.903", "lastModified": "2022-06-09T14:25:07.050", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "XWiki Platform Filter UI provides a generic user interface to convert from a XWiki Filter input stream to an output stream with settings for each stream. Starting with versions 6.0-milestone-2 and 5.4.4 and prior to versions 12.10.11, 14.0-rc-1, 13.4.7, and 13.10.3, XWiki Platform Filter UI contains a possible cross-site scripting vector in the `Filter.FilterStreamDescriptorForm` wiki page related to pretty much all the form fields printed in the home page of the application. The issue is patched in versions 12.10.11, 14.0-rc-1, 13.4.7, and 13.10.3. The easiest workaround is to edit the wiki page `Filter.FilterStreamDescriptorForm` (with wiki editor) according to the instructions in the GitHub Security Advisory."}, {"lang": "es", "value": "La interfaz de usuario del filtro de la plataforma XWiki proporciona una interfaz de usuario gen\u00e9rica para convertir de un flujo de entrada del filtro XWiki a un flujo de salida con ajustes para cada flujo. A partir de las versiones 6.0-milestone-2 y 5.4.4 y en versiones anteriores a 12.10.11, 14.0-rc-1, 13.4.7 y 13.10.3, la interfaz de usuario de XWiki Platform Filter contiene un posible vector de tipo cross-site scripting en la p\u00e1gina wiki \"Filter.FilterStreamDescriptorForm\" relacionado con casi todos los campos de formulario impresos en la p\u00e1gina de inicio de la aplicaci\u00f3n. El problema est\u00e1 parcheado en versiones 12.10.11, 14.0-rc-1, 13.4.7 y 13.10.3. La mitigaci\u00f3n m\u00e1s sencilla es editar la p\u00e1gina wiki \"Filter.FilterStreamDescriptorForm\" (con el editor wiki) seg\u00fan las instrucciones del aviso de seguridad de GitHub"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 4.0}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-116"}, {"lang": "en", "value": "CWE-80"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.4.4", "versionEndExcluding": "12.10.11", "matchCriteriaId": "B60A31D3-BCC5-49CF-A93C-D5FACD270E9C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "13.0", "versionEndExcluding": "13.4.7", "matchCriteriaId": "46DEE085-75DA-4505-A874-EB0EBEC70FBE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "13.5", "versionEndExcluding": "13.10.3", "matchCriteriaId": "14BFEB5B-7E8A-431B-A265-CE9FAE6A2F60"}]}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/21906acb5ee2304552f56f9bbdbf8e7d368f7f3a", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-xjfw-5vv5-vjq2", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}, {"url": "https://jira.xwiki.org/browse/XWIKI-19293", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}]}, "github_commit_url": "https://github.com/xwiki/xwiki-platform/commit/21906acb5ee2304552f56f9bbdbf8e7d368f7f3a"}}