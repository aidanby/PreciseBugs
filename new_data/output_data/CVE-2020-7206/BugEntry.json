{"buggy_code": ["<meta http-equiv=\"X-UA-Compatible\" content=\"IE=EDGE\" />\r\n<html>\r\n<head>\r\n\r\n<style>\r\n@import \"Base.css\";\r\n</style>\r\n</head>\r\n\r\n<body>\r\n<script type=\"text/javascript\" src=\"PS_Info.js\" ></script>\r\n<script type=\"text/javascript\" src=\"Fan_Info.js\" ></script>\r\n<script type=\"text/javascript\" src=\"Temp_Info.js\" ></script>\r\n<script type=\"text/javascript\" src=\"Storage_Info.js\" ></script>\r\n<script type=\"text/javascript\" src=\"Memory_Info.js\" ></script>\r\n<script type=\"text/javascript\" src=\"CPU_Info.js\" ></script>\r\n<script type=\"text/javascript\" src=\"Network_Info.js\" ></script>\r\n\r\n<script language=\"JavaScript\" type=\"text/javascript\" >\r\n\r\n<?php\r\n        $ip=$_GET[\"ip\"];\r\n        $comm=$_GET[\"comm\"];\r\n        $id=$_GET[\"id\"];\r\n        $cmd=\"./nagios_hpeilo_engine -H $ip -C $comm -o $id -J\";\r\n        $ret = exec($cmd,$output);\r\n        echo join(\"\\n\",$output);\r\n?>\r\n\r\nif (jData != \"\") {\r\n\tTableProcessing(serviceID);\r\n}\r\nelse {\r\n\tNojsonData(serviceID);\r\n}\r\n\r\nfunction TableProcessing (value) {\r\n    switch (value) {\r\n    case 1:\r\n\t\tPS_Table();\r\n        break;\r\n    case 2:\r\n\t\tFan_Table();\r\n        break;\r\n    case 3:\r\n        Temp_Table();\r\n        break;\r\n    case 4:\r\n        Storage_Table();\r\n        break;\r\n    case 5:\r\n        Memory_Table();\r\n        break;\r\n    case 6:\r\n        CPU_Table();\r\n        break;\r\n    case 7:\r\n        Network_Table();\r\n        break;\r\n\tdefault:  \r\n\t\tdocument.write(\"<h1>Some thing Went Wrong...</h1>\");\r\n    }\r\n}\r\n\r\nfunction NojsonData (value) {\r\n    switch (value) {\r\n    case 1:\r\n\t\tdocument.write(\"<h1>Power Supply Info Data is not available</h1>\");\r\n        break;\r\n    case 2:\r\n\t\tdocument.write(\"<h1>Fan Info Data is not available</h1>\");\r\n        break;\r\n    case 3:\r\n        document.write(\"<h1>Temperature Info Data is not available</h1>\");\r\n        break;\r\n    case 4:\r\n        document.write(\"<h1>Storage Info Data is not available</h1>\");\r\n        break;\r\n    case 5:\r\n        document.write(\"<h1>Memory Info Data is not available</h1>\");\r\n        break;\r\n    case 6:\r\n        document.write(\"<h1>CPU Info Data is not available</h1>\");\r\n        break;\r\n    case 7:\r\n        document.write(\"<h1>Network Info Data is not available</h1>\");\r\n        break;\r\n\tdefault:  \r\n\t\tdocument.write(\"<h1>Some thing went Wrong...</h1>\");\r\n    }\r\n}\r\n\r\n</script>\r\n</body>\r\n</html>\r\n"], "fixing_code": ["<meta http-equiv=\"X-UA-Compatible\" content=\"IE=EDGE\" />\r\n<html>\r\n<head>\r\n\r\n<style>\r\n@import \"Base.css\";\r\n</style>\r\n</head>\r\n\r\n<body>\r\n<script type=\"text/javascript\" src=\"PS_Info.js\" ></script>\r\n<script type=\"text/javascript\" src=\"Fan_Info.js\" ></script>\r\n<script type=\"text/javascript\" src=\"Temp_Info.js\" ></script>\r\n<script type=\"text/javascript\" src=\"Storage_Info.js\" ></script>\r\n<script type=\"text/javascript\" src=\"Memory_Info.js\" ></script>\r\n<script type=\"text/javascript\" src=\"CPU_Info.js\" ></script>\r\n<script type=\"text/javascript\" src=\"Network_Info.js\" ></script>\r\n\r\n<script language=\"JavaScript\" type=\"text/javascript\" >\r\n\r\n<?php\r\n        $ip=$_GET[\"ip\"];\r\n        $comm=$_GET[\"comm\"];\r\n        $id=$_GET[\"id\"];\r\n        $cmd=escapeshellcmd(\"./nagios_hpeilo_engine -H $ip -C $comm -o $id -J\");\r\n        $ret = exec($cmd,$output);\r\n        echo join(\"\\n\",$output);\r\n?>\r\n\r\nif (jData != \"\") {\r\n\tTableProcessing(serviceID);\r\n}\r\nelse {\r\n\tNojsonData(serviceID);\r\n}\r\n\r\nfunction TableProcessing (value) {\r\n    switch (value) {\r\n    case 1:\r\n\t\tPS_Table();\r\n        break;\r\n    case 2:\r\n\t\tFan_Table();\r\n        break;\r\n    case 3:\r\n        Temp_Table();\r\n        break;\r\n    case 4:\r\n        Storage_Table();\r\n        break;\r\n    case 5:\r\n        Memory_Table();\r\n        break;\r\n    case 6:\r\n        CPU_Table();\r\n        break;\r\n    case 7:\r\n        Network_Table();\r\n        break;\r\n\tdefault:  \r\n\t\tdocument.write(\"<h1>Some thing Went Wrong...</h1>\");\r\n    }\r\n}\r\n\r\nfunction NojsonData (value) {\r\n    switch (value) {\r\n    case 1:\r\n\t\tdocument.write(\"<h1>Power Supply Info Data is not available</h1>\");\r\n        break;\r\n    case 2:\r\n\t\tdocument.write(\"<h1>Fan Info Data is not available</h1>\");\r\n        break;\r\n    case 3:\r\n        document.write(\"<h1>Temperature Info Data is not available</h1>\");\r\n        break;\r\n    case 4:\r\n        document.write(\"<h1>Storage Info Data is not available</h1>\");\r\n        break;\r\n    case 5:\r\n        document.write(\"<h1>Memory Info Data is not available</h1>\");\r\n        break;\r\n    case 6:\r\n        document.write(\"<h1>CPU Info Data is not available</h1>\");\r\n        break;\r\n    case 7:\r\n        document.write(\"<h1>Network Info Data is not available</h1>\");\r\n        break;\r\n\tdefault:  \r\n\t\tdocument.write(\"<h1>Some thing went Wrong...</h1>\");\r\n    }\r\n}\r\n\r\n</script>\r\n</body>\r\n</html>\r\n"], "filenames": ["action-url/nagios_hpeilo_service_details.php"], "buggy_code_start_loc": [25], "buggy_code_end_loc": [26], "fixing_code_start_loc": [25], "fixing_code_end_loc": [26], "type": "CWE-78", "message": "HP nagios plugin for iLO (nagios-plugins-hpilo v1.50 and earlier) has a php code injection vulnerability.", "other": {"cve": {"id": "CVE-2020-7206", "sourceIdentifier": "security-alert@hpe.com", "published": "2020-07-17T22:15:11.573", "lastModified": "2021-07-21T11:39:23.747", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "HP nagios plugin for iLO (nagios-plugins-hpilo v1.50 and earlier) has a php code injection vulnerability."}, {"lang": "es", "value": "El plugin HP nagios para iLO (nagios-plugins-hpilo versi\u00f3n v1.50 y anteriores), presenta una vulnerabilidad de inyecci\u00f3n de c\u00f3digo php"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-78"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hp:nagios-plugins-hpilo:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.50", "matchCriteriaId": "1CD1155C-9D85-4489-95CD-278193ADC810"}]}]}], "references": [{"url": "https://github.com/HewlettPackard/nagios-plugins-hpilo/commit/7617b2736a95c7f354198f092febe37e7005c677", "source": "security-alert@hpe.com", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/HewlettPackard/nagios-plugins-hpilo/commit/7617b2736a95c7f354198f092febe37e7005c677"}}