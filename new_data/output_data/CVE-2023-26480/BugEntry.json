{"buggy_code": ["/*\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n */\npackage org.xwiki.livedata.internal.macro;\n\nimport java.lang.annotation.Documented;\nimport java.lang.annotation.Inherited;\nimport java.lang.annotation.Retention;\nimport java.lang.annotation.Target;\n\nimport org.xwiki.livedata.internal.DefaultLiveDataConfigurationResolver;\nimport org.xwiki.livedata.internal.StringLiveDataConfigurationResolver;\nimport org.xwiki.skinx.internal.JsFileSkinExtension;\nimport org.xwiki.test.annotation.ComponentList;\n\nimport static java.lang.annotation.ElementType.ANNOTATION_TYPE;\nimport static java.lang.annotation.ElementType.METHOD;\nimport static java.lang.annotation.ElementType.TYPE;\nimport static java.lang.annotation.RetentionPolicy.RUNTIME;\n\n/**\n * Pack of default Component implementations that are needed for running the Live Data macro.\n *\n * @version $Id$\n * @since 13.7RC1\n * @since 13.6.1\n * @since 13.4.3\n */\n@Documented\n@Retention(RUNTIME)\n@Target({ TYPE, METHOD, ANNOTATION_TYPE })\n@ComponentList({\n    LiveDataMacro.class,\n    DefaultLiveDataConfigurationResolver.class,\n    StringLiveDataConfigurationResolver.class,\n    JsFileSkinExtension.class\n})\n@Inherited\npublic @interface LiveDataMacroComponentList\n{\n}\n"], "fixing_code": ["/*\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n */\npackage org.xwiki.livedata.internal.macro;\n\nimport java.lang.annotation.Documented;\nimport java.lang.annotation.Inherited;\nimport java.lang.annotation.Retention;\nimport java.lang.annotation.Target;\n\nimport org.xwiki.livedata.internal.DefaultLiveDataConfigurationResolver;\nimport org.xwiki.livedata.internal.StringLiveDataConfigurationResolver;\nimport org.xwiki.skinx.internal.JsFileSkinExtension;\nimport org.xwiki.test.annotation.ComponentList;\n\nimport static java.lang.annotation.ElementType.ANNOTATION_TYPE;\nimport static java.lang.annotation.ElementType.METHOD;\nimport static java.lang.annotation.ElementType.TYPE;\nimport static java.lang.annotation.RetentionPolicy.RUNTIME;\n\n/**\n * Pack of default Component implementations that are needed for running the Live Data macro.\n *\n * @version $Id$\n * @since 13.7RC1\n * @since 13.6.1\n * @since 13.4.3\n */\n@Documented\n@Retention(RUNTIME)\n@Target({ TYPE, METHOD, ANNOTATION_TYPE })\n@ComponentList({\n    LiveDataMacro.class,\n    DefaultLiveDataConfigurationResolver.class,\n    StringLiveDataConfigurationResolver.class,\n    JsFileSkinExtension.class,\n    LiveDataMacroConfiguration.class,\n    LiveDataMacroRights.class\n})\n@Inherited\npublic @interface LiveDataMacroComponentList\n{\n}\n"], "filenames": ["xwiki-platform-core/xwiki-platform-livedata/xwiki-platform-livedata-macro/src/test/java/org/xwiki/livedata/internal/macro/LiveDataMacroComponentList.java"], "buggy_code_start_loc": [52], "buggy_code_end_loc": [53], "fixing_code_start_loc": [52], "fixing_code_end_loc": [55], "type": "CWE-79", "message": "XWiki Platform is a generic wiki platform. Starting in version 12.10, a user without script rights can introduce a stored cross-site scripting by using the Live Data macro. This has been patched in XWiki 14.9, 14.4.7, and 13.10.10. There are no known workarounds.", "other": {"cve": {"id": "CVE-2023-26480", "sourceIdentifier": "security-advisories@github.com", "published": "2023-03-02T18:15:11.407", "lastModified": "2023-03-10T05:02:26.307", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "XWiki Platform is a generic wiki platform. Starting in version 12.10, a user without script rights can introduce a stored cross-site scripting by using the Live Data macro. This has been patched in XWiki 14.9, 14.4.7, and 13.10.10. There are no known workarounds."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 8.9, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.3, "impactScore": 6.0}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "12.10", "versionEndExcluding": "13.10.10", "matchCriteriaId": "52A4D585-FE3E-46F2-97F6-A352F8C8D3FC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "14.0", "versionEndExcluding": "14.4.7", "matchCriteriaId": "FA3A5151-58FB-48CF-BFFB-5688608200C8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "14.5", "versionEndExcluding": "14.9", "matchCriteriaId": "E0DE5CA5-2618-434D-854A-CDAB06A713E2"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:14.9:rc1:*:*:*:*:*:*", "matchCriteriaId": "2D4D4AE3-507D-4F0A-B597-E8AF301EB26A"}]}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/23d5ea9b23e84b5f3d1f1b2d5673fe8c774d0d79", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/xwiki/xwiki-platform/commit/556e7823260b826f344c1a6e95d935774587e028", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-32fq-m2q5-h83g", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://jira.xwiki.org/browse/XWIKI-20143", "source": "security-advisories@github.com", "tags": ["Exploit", "Issue Tracking", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/xwiki/xwiki-platform/commit/23d5ea9b23e84b5f3d1f1b2d5673fe8c774d0d79"}}