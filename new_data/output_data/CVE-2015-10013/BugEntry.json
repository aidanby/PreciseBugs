{"buggy_code": ["Taxonomy Switcher\n======================\n\nSwitch the taxonomy for terms by a specific parent of another taxonomy.\n\n## Instructions\n\n1. **Backup!**\n2. Activate the plugin and browse to yourdomain.com/wp-admin/tools.php?page=taxonomy-switcher\n3. Select your \"From\", and \"To\" Taxonomies.\n\n**Optional**  \n\n1. Select a parent term to limit terms to switch. Typing term names will do a live search of terms with the name you are typing AND possess child terms.\n2. OR add a comma-separated list of term ids to switch.\n\n## Notes\n\nIf parent isn't set, or you don't specify a comma-separated list of term ids to migrate, it will migrate *all* terms for that taxonomy to the new taxonomy.\n\nCompatible with [wp-cli](http://wp-cli.org/). `wp taxonomy-switcher` for instructions.\n\n## Changelog\n\n#### 1.0.1\n* Add ability to switch comma-separated list of term IDs.\n\n#### 1.0.0\n* Release\n", "=== Taxonomy Switcher ===\nContributors: webdevstudios, sc0ttkclark, jtsternberg\nDonate link: https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=3084056\nTags: taxonomy, taxonomies, term, terms, category, categories, convert, converter, tag, tags, custom taxonomy, custom taxonomies, switch taxonomies\nRequires at least: 3.5\nTested up to: 3.8.1\nStable tag: 1.0.1\nLicense: GNU AGPLv3\nLicense URI: http://www.gnu.org/licenses/agpl-3.0.html\n\nSwitch the taxonomy for all terms or only child terms of a specified parent term.\n\n== Description ==\n\nThis plugin allows you to select your \"From\", and \"To\" Taxonomies, to convert all terms. Optionally select a parent term to limit terms to switch. Typing term names will do a live search of terms with the name you are typing AND possess child terms.\n\nPlugin also has built-in support for [WP-CLI](http://wp-cli.org/). In the command line, type in `wp taxonomy-switcher` for instructions.\n\n[Plugin is on GitHub](https://github.com/WebDevStudios/taxonomy-switcher). Pull Requests and Forks welcome.\n\n### Notes\n\nPlease keep in mind, if parent isn't set, or you don't specify a comma-separated list of term ids to migrate, it will migrate *all* terms for that taxonomy to the new taxonomy.\n\n== Installation ==\n\n1. **Backup!**\n2. Upload 'taxonomy-switcher' to the '/wp-content/plugins/' directory\n3. Activate the plugin through the 'Plugins' menu in WordPress\n4. Navigate to the 'Taxonomy Switcher' admin page. You'll find the menu item under the 'Tools' menu item on the left.\n5. Select your \"From\", and \"To\" Taxonomies.\n6. **a)** Optionally select a parent term to limit terms to switch. Typing term names will do a live search of terms with the name you are typing AND possess child terms. **OR** **b)** Add a comma-separated list of term ids to switch.\n7. Switch them!\n\n== Frequently Asked Questions ==\n\n\n== Screenshots ==\n\n1. Admin page\n2. Live-searching for a parent term\n\n== Changelog ==\n\n= 1.0.1 =\n* Add ability to switch comma-separated list of term IDs.\n\n= 1.0.0 =\n* Release\n\n== Upgrade Notice ==\n\n= 1.0.1 =\n* Add ability to switch comma-separated list of term IDs.\n\n= 1.0.0 =\n* Release\n", "<?php\n/*\nPlugin Name: Taxonomy Switcher\nPlugin URI: https://github.com/WebDevStudios/taxonomy-switcher\nDescription: Switches the Taxonomy of terms to a different Taxonomy\nVersion: 1.0.1\nAuthor: WebDevStudios\nAuthor URI: http://webdevstudios.com\n*/\n\n/**\n * Class Taxonomy_Switcher_Init\n */\nclass Taxonomy_Switcher_Init {\n\n\t/**\n\t * Setup the object\n\t *\n\t * @since 1.0.0\n\t */\n\tpublic function __construct() {\n\n\t\t// WP-CLI integration\n\t\tif ( defined( 'WP_CLI' ) && WP_CLI ) {\n\t\t\trequire_once( dirname( __FILE__ ) . '/Taxonomy_Switcher.php' );\n\t\t\trequire_once( dirname( __FILE__ ) . '/wp-cli.php' );\n\t\t} else {\n\t\t\t// No WP-CLI? Ok, let's add our UI\n\t\t\trequire_once( dirname( __FILE__ ) . '/Taxonomy_Switcher_UI.php' );\n\t\t\t$this->ui = new Taxonomy_Switcher_UI();\n\t\t\t$this->ui->hooks();\n\t\t}\n\n\t\tadd_action( 'admin_init', array( $this, 'taxonomy_switcher_init' ) );\n\n\t\tif ( $this->notices = get_option( 'taxonomy-switcher-notices' ) ) {\n\t\t\tadd_action( 'all_admin_notices', array( $this, 'do_admin_notice' ) );\n\t\t}\n\n\t}\n\n\t/**\n\t * Include Taxonomy_Switcher if being run\n\t *\n\t * @since 1.0.0\n\t */\n\tpublic function taxonomy_switcher_init() {\n\n\t\tif (\n\t\t\t! isset( $_GET[ 'taxonomy_switcher' ] )\n\t\t\t|| 1 != $_GET[ 'taxonomy_switcher' ]\n\t\t\t|| ! current_user_can( 'install_plugins' )\n\t\t\t|| ! isset( $_GET[ 'from_tax' ] )\n\t\t\t|| empty( $_GET[ 'from_tax' ] )\n\t\t\t|| ! isset( $_GET[ 'to_tax' ] )\n\t\t\t|| empty( $_GET[ 'to_tax' ] )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\trequire_once( dirname( __FILE__ ) . '/Taxonomy_Switcher.php' );\n\n\t\t$taxonomy_switcher = new Taxonomy_Switcher( $_GET );\n\n\t\t$success_notices = $taxonomy_switcher->admin_convert();\n\n\t\tif ( empty( $success_notices ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Save notices\n\t\tadd_option( 'taxonomy-switcher-notices', $success_notices, null, 'no' );\n\t\t// Redirect and strip query string\n\t\twp_redirect( add_query_arg( 'page', $this->ui->admin_slug, admin_url( '/tools.php' ) ) );\n\n\t}\n\n\t/**\n\t * Show Notices for taxonomy switch\n\t *\n\t * @since 1.0.0\n\t */\n\tpublic function do_admin_notice() {\n\t\techo '<div id=\"message\" class=\"updated\"><p>'. implode( '</p><p>', $this->notices ) .'</p></div>';\n\t\tdelete_option( 'taxonomy-switcher-notices' );\n\t}\n\n}\n\n$Taxonomy_Switcher_Init = new Taxonomy_Switcher_Init();\n"], "fixing_code": ["Taxonomy Switcher\n======================\n\nSwitch the taxonomy for terms by a specific parent of another taxonomy.\n\n## Instructions\n\n1. **Backup!**\n2. Activate the plugin and browse to yourdomain.com/wp-admin/tools.php?page=taxonomy-switcher\n3. Select your \"From\", and \"To\" Taxonomies.\n\n**Optional**  \n\n1. Select a parent term to limit terms to switch. Typing term names will do a live search of terms with the name you are typing AND possess child terms.\n2. OR add a comma-separated list of term ids to switch.\n\n## Notes\n\nIf parent isn't set, or you don't specify a comma-separated list of term ids to migrate, it will migrate *all* terms for that taxonomy to the new taxonomy.\n\nCompatible with [wp-cli](http://wp-cli.org/). `wp taxonomy-switcher` for instructions.\n\n## Changelog\n\n#### 1.0.2\n* Update for xss vulnerability, https://make.wordpress.org/plugins/2015/04/20/fixing-add_query_arg-and-remove_query_arg-usage\n\n#### 1.0.1\n* Add ability to switch comma-separated list of term IDs.\n\n#### 1.0.0\n* Release\n", "=== Taxonomy Switcher ===\nContributors: webdevstudios, sc0ttkclark, jtsternberg\nDonate link: https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=3084056\nTags: taxonomy, taxonomies, term, terms, category, categories, convert, converter, tag, tags, custom taxonomy, custom taxonomies, switch taxonomies\nRequires at least: 3.5\nTested up to: 3.8.1\nStable tag: 1.0.2\nLicense: GNU AGPLv3\nLicense URI: http://www.gnu.org/licenses/agpl-3.0.html\n\nSwitch the taxonomy for all terms or only child terms of a specified parent term.\n\n== Description ==\n\nThis plugin allows you to select your \"From\", and \"To\" Taxonomies, to convert all terms. Optionally select a parent term to limit terms to switch. Typing term names will do a live search of terms with the name you are typing AND possess child terms.\n\nPlugin also has built-in support for [WP-CLI](http://wp-cli.org/). In the command line, type in `wp taxonomy-switcher` for instructions.\n\n[Plugin is on GitHub](https://github.com/WebDevStudios/taxonomy-switcher). Pull Requests and Forks welcome.\n\n### Notes\n\nPlease keep in mind, if parent isn't set, or you don't specify a comma-separated list of term ids to migrate, it will migrate *all* terms for that taxonomy to the new taxonomy.\n\n== Installation ==\n\n1. **Backup!**\n2. Upload 'taxonomy-switcher' to the '/wp-content/plugins/' directory\n3. Activate the plugin through the 'Plugins' menu in WordPress\n4. Navigate to the 'Taxonomy Switcher' admin page. You'll find the menu item under the 'Tools' menu item on the left.\n5. Select your \"From\", and \"To\" Taxonomies.\n6. **a)** Optionally select a parent term to limit terms to switch. Typing term names will do a live search of terms with the name you are typing AND possess child terms. **OR** **b)** Add a comma-separated list of term ids to switch.\n7. Switch them!\n\n== Frequently Asked Questions ==\n\n\n== Screenshots ==\n\n1. Admin page\n2. Live-searching for a parent term\n\n== Changelog ==\n\n= 1.0.2 =\n* Update for xss vulnerability, https://make.wordpress.org/plugins/2015/04/20/fixing-add_query_arg-and-remove_query_arg-usage\n\n= 1.0.1 =\n* Add ability to switch comma-separated list of term IDs.\n\n= 1.0.0 =\n* Release\n\n== Upgrade Notice ==\n\n= 1.0.1 =\n* Add ability to switch comma-separated list of term IDs.\n\n= 1.0.0 =\n* Release\n", "<?php\n/*\nPlugin Name: Taxonomy Switcher\nPlugin URI: https://github.com/WebDevStudios/taxonomy-switcher\nDescription: Switches the Taxonomy of terms to a different Taxonomy\nVersion: 1.0.2\nAuthor: WebDevStudios\nAuthor URI: http://webdevstudios.com\n*/\n\n/**\n * Class Taxonomy_Switcher_Init\n */\nclass Taxonomy_Switcher_Init {\n\n\t/**\n\t * Setup the object\n\t *\n\t * @since 1.0.0\n\t */\n\tpublic function __construct() {\n\n\t\t// WP-CLI integration\n\t\tif ( defined( 'WP_CLI' ) && WP_CLI ) {\n\t\t\trequire_once( dirname( __FILE__ ) . '/Taxonomy_Switcher.php' );\n\t\t\trequire_once( dirname( __FILE__ ) . '/wp-cli.php' );\n\t\t} else {\n\t\t\t// No WP-CLI? Ok, let's add our UI\n\t\t\trequire_once( dirname( __FILE__ ) . '/Taxonomy_Switcher_UI.php' );\n\t\t\t$this->ui = new Taxonomy_Switcher_UI();\n\t\t\t$this->ui->hooks();\n\t\t}\n\n\t\tadd_action( 'admin_init', array( $this, 'taxonomy_switcher_init' ) );\n\n\t\tif ( $this->notices = get_option( 'taxonomy-switcher-notices' ) ) {\n\t\t\tadd_action( 'all_admin_notices', array( $this, 'do_admin_notice' ) );\n\t\t}\n\n\t}\n\n\t/**\n\t * Include Taxonomy_Switcher if being run\n\t *\n\t * @since 1.0.0\n\t */\n\tpublic function taxonomy_switcher_init() {\n\n\t\tif (\n\t\t\t! isset( $_GET[ 'taxonomy_switcher' ] )\n\t\t\t|| 1 != $_GET[ 'taxonomy_switcher' ]\n\t\t\t|| ! current_user_can( 'install_plugins' )\n\t\t\t|| ! isset( $_GET[ 'from_tax' ] )\n\t\t\t|| empty( $_GET[ 'from_tax' ] )\n\t\t\t|| ! isset( $_GET[ 'to_tax' ] )\n\t\t\t|| empty( $_GET[ 'to_tax' ] )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\trequire_once( dirname( __FILE__ ) . '/Taxonomy_Switcher.php' );\n\n\t\t$taxonomy_switcher = new Taxonomy_Switcher( $_GET );\n\n\t\t$success_notices = $taxonomy_switcher->admin_convert();\n\n\t\tif ( empty( $success_notices ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Save notices\n\t\tadd_option( 'taxonomy-switcher-notices', $success_notices, null, 'no' );\n\t\t// Redirect and strip query string\n\t\twp_redirect( esc_url_raw( add_query_arg( 'page', $this->ui->admin_slug, admin_url( '/tools.php' ) ) ) );\n\n\t}\n\n\t/**\n\t * Show Notices for taxonomy switch\n\t *\n\t * @since 1.0.0\n\t */\n\tpublic function do_admin_notice() {\n\t\techo '<div id=\"message\" class=\"updated\"><p>'. implode( '</p><p>', $this->notices ) .'</p></div>';\n\t\tdelete_option( 'taxonomy-switcher-notices' );\n\t}\n\n}\n\n$Taxonomy_Switcher_Init = new Taxonomy_Switcher_Init();\n"], "filenames": ["README.md", "readme.txt", "taxonomy-switcher.php"], "buggy_code_start_loc": [24, 7, 6], "buggy_code_end_loc": [24, 44, 75], "fixing_code_start_loc": [25, 7, 6], "fixing_code_end_loc": [28, 48, 75], "type": "CWE-79", "message": "A vulnerability was found in WebDevStudios taxonomy-switcher Plugin up to 1.0.3. It has been classified as problematic. Affected is the function taxonomy_switcher_init of the file taxonomy-switcher.php. The manipulation leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 1.0.4 is able to address this issue. It is recommended to upgrade the affected component. VDB-217446 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2015-10013", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-05T10:15:09.100", "lastModified": "2023-01-11T16:16:35.363", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in WebDevStudios taxonomy-switcher Plugin up to 1.0.3. It has been classified as problematic. Affected is the function taxonomy_switcher_init of the file taxonomy-switcher.php. The manipulation leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 1.0.4 is able to address this issue. It is recommended to upgrade the affected component. VDB-217446 is the identifier assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:webdevstudios:taxonomy_switcher:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "1.0.4", "matchCriteriaId": "64BA32B6-16E1-47B5-A4D0-1790F5206DBA"}]}]}], "references": [{"url": "https://github.com/WebDevStudios/taxonomy-switcher/commit/e1a0d99f936e7427b31e210c67aeb4833d804099", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/WebDevStudios/taxonomy-switcher/releases/tag/1.0.4", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.217446", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.217446", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/WebDevStudios/taxonomy-switcher/commit/e1a0d99f936e7427b31e210c67aeb4833d804099"}}