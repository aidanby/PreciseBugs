{"buggy_code": ["/* $OpenBSD: compat.c,v 1.119 2021/09/10 05:46:09 djm Exp $ */\n/*\n * Copyright (c) 1999, 2000, 2001, 2002 Markus Friedl.  All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR\n * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,\n * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\n * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#include \"includes.h\"\n\n#include <sys/types.h>\n\n#include <stdlib.h>\n#include <string.h>\n#include <stdarg.h>\n\n#include \"xmalloc.h\"\n#include \"packet.h\"\n#include \"compat.h\"\n#include \"log.h\"\n#include \"match.h\"\n#include \"kex.h\"\n\n/* determine bug flags from SSH protocol banner */\nvoid\ncompat_banner(struct ssh *ssh, const char *version)\n{\n\tint i;\n\tstatic struct {\n\t\tchar\t*pat;\n\t\tint\tbugs;\n\t} check[] = {\n\t\t{ \"OpenSSH_2.*,\"\n\t\t  \"OpenSSH_3.0*,\"\n\t\t  \"OpenSSH_3.1*\",\tSSH_BUG_EXTEOF|SSH_OLD_FORWARD_ADDR|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_3.*\",\tSSH_OLD_FORWARD_ADDR|SSH_BUG_SIGTYPE },\n\t\t{ \"Sun_SSH_1.0*\",\tSSH_BUG_NOREKEY|SSH_BUG_EXTEOF|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_2*,\"\n\t\t  \"OpenSSH_3*,\"\n\t\t  \"OpenSSH_4*\",\t\tSSH_BUG_SIGTYPE },\n\t\t{ \"OpenSSH_5*\",\t\tSSH_NEW_OPENSSH|SSH_BUG_DYNAMIC_RPORT|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_6.6.1*\",\tSSH_NEW_OPENSSH|SSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_6.5*,\"\n\t\t  \"OpenSSH_6.6*\",\tSSH_NEW_OPENSSH|SSH_BUG_CURVE25519PAD|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_7.4*\",\tSSH_NEW_OPENSSH|SSH_BUG_SIGTYPE|\n\t\t\t\t\tSSH_BUG_SIGTYPE74},\n\t\t{ \"OpenSSH_7.0*,\"\n\t\t  \"OpenSSH_7.1*,\"\n\t\t  \"OpenSSH_7.2*,\"\n\t\t  \"OpenSSH_7.3*,\"\n\t\t  \"OpenSSH_7.5*,\"\n\t\t  \"OpenSSH_7.6*,\"\n\t\t  \"OpenSSH_7.7*\",\tSSH_NEW_OPENSSH|SSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH*\",\t\tSSH_NEW_OPENSSH },\n\t\t{ \"*MindTerm*\",\t\t0 },\n\t\t{ \"3.0.*\",\t\tSSH_BUG_DEBUG },\n\t\t{ \"3.0 SecureCRT*\",\tSSH_OLD_SESSIONID },\n\t\t{ \"1.7 SecureFX*\",\tSSH_OLD_SESSIONID },\n\t\t{ \"1.2.18*,\"\n\t\t  \"1.2.19*,\"\n\t\t  \"1.2.20*,\"\n\t\t  \"1.2.21*,\"\n\t\t  \"1.2.22*\",\t\tSSH_BUG_IGNOREMSG },\n\t\t{ \"1.3.2*\",\t\t/* F-Secure */\n\t\t\t\t\tSSH_BUG_IGNOREMSG },\n\t\t{ \"Cisco-1.*\",\t\tSSH_BUG_DHGEX_LARGE|\n\t\t\t\t\tSSH_BUG_HOSTKEYS },\n\t\t{ \"*SSH Compatible Server*\",\t\t\t/* Netscreen */\n\t\t\t\t\tSSH_BUG_PASSWORDPAD },\n\t\t{ \"*OSU_0*,\"\n\t\t  \"OSU_1.0*,\"\n\t\t  \"OSU_1.1*,\"\n\t\t  \"OSU_1.2*,\"\n\t\t  \"OSU_1.3*,\"\n\t\t  \"OSU_1.4*,\"\n\t\t  \"OSU_1.5alpha1*,\"\n\t\t  \"OSU_1.5alpha2*,\"\n\t\t  \"OSU_1.5alpha3*\",\tSSH_BUG_PASSWORDPAD },\n\t\t{ \"*SSH_Version_Mapper*\",\n\t\t\t\t\tSSH_BUG_SCANNER },\n\t\t{ \"PuTTY_Local:*,\"\t/* dev versions < Sep 2014 */\n\t\t  \"PuTTY-Release-0.5*,\" /* 0.50-0.57, DH-GEX in >=0.52 */\n\t\t  \"PuTTY_Release_0.5*,\"\t/* 0.58-0.59 */\n\t\t  \"PuTTY_Release_0.60*,\"\n\t\t  \"PuTTY_Release_0.61*,\"\n\t\t  \"PuTTY_Release_0.62*,\"\n\t\t  \"PuTTY_Release_0.63*,\"\n\t\t  \"PuTTY_Release_0.64*\",\n\t\t\t\t\tSSH_OLD_DHGEX },\n\t\t{ \"FuTTY*\",\t\tSSH_OLD_DHGEX }, /* Putty Fork */\n\t\t{ \"Probe-*\",\n\t\t\t\t\tSSH_BUG_PROBE },\n\t\t{ \"TeraTerm SSH*,\"\n\t\t  \"TTSSH/1.5.*,\"\n\t\t  \"TTSSH/2.1*,\"\n\t\t  \"TTSSH/2.2*,\"\n\t\t  \"TTSSH/2.3*,\"\n\t\t  \"TTSSH/2.4*,\"\n\t\t  \"TTSSH/2.5*,\"\n\t\t  \"TTSSH/2.6*,\"\n\t\t  \"TTSSH/2.70*,\"\n\t\t  \"TTSSH/2.71*,\"\n\t\t  \"TTSSH/2.72*\",\tSSH_BUG_HOSTKEYS },\n\t\t{ \"WinSCP_release_4*,\"\n\t\t  \"WinSCP_release_5.0*,\"\n\t\t  \"WinSCP_release_5.1,\"\n\t\t  \"WinSCP_release_5.1.*,\"\n\t\t  \"WinSCP_release_5.5,\"\n\t\t  \"WinSCP_release_5.5.*,\"\n\t\t  \"WinSCP_release_5.6,\"\n\t\t  \"WinSCP_release_5.6.*,\"\n\t\t  \"WinSCP_release_5.7,\"\n\t\t  \"WinSCP_release_5.7.1,\"\n\t\t  \"WinSCP_release_5.7.2,\"\n\t\t  \"WinSCP_release_5.7.3,\"\n\t\t  \"WinSCP_release_5.7.4\",\n\t\t\t\t\tSSH_OLD_DHGEX },\n\t\t{ \"ConfD-*\",\n\t\t\t\t\tSSH_BUG_UTF8TTYMODE },\n\t\t{ \"Twisted_*\",\t\t0 },\n\t\t{ \"Twisted*\",\t\tSSH_BUG_DEBUG },\n\t\t{ NULL,\t\t\t0 }\n\t};\n\n\t/* process table, return first match */\n\tssh->compat = 0;\n\tfor (i = 0; check[i].pat; i++) {\n\t\tif (match_pattern_list(version, check[i].pat, 0) == 1) {\n\t\t\tdebug_f(\"match: %s pat %s compat 0x%08x\",\n\t\t\t    version, check[i].pat, check[i].bugs);\n\t\t\tssh->compat = check[i].bugs;\n\t\t\treturn;\n\t\t}\n\t}\n\tdebug_f(\"no match: %s\", version);\n}\n\nchar *\ncompat_cipher_proposal(struct ssh *ssh, char *cipher_prop)\n{\n\tif (!(ssh->compat & SSH_BUG_BIGENDIANAES))\n\t\treturn cipher_prop;\n\tdebug2_f(\"original cipher proposal: %s\", cipher_prop);\n\tif ((cipher_prop = match_filter_denylist(cipher_prop, \"aes*\")) == NULL)\n\t\tfatal(\"match_filter_denylist failed\");\n\tdebug2_f(\"compat cipher proposal: %s\", cipher_prop);\n\tif (*cipher_prop == '\\0')\n\t\tfatal(\"No supported ciphers found\");\n\treturn cipher_prop;\n}\n\nchar *\ncompat_pkalg_proposal(struct ssh *ssh, char *pkalg_prop)\n{\n\tif (!(ssh->compat & SSH_BUG_RSASIGMD5))\n\t\treturn pkalg_prop;\n\tdebug2_f(\"original public key proposal: %s\", pkalg_prop);\n\tif ((pkalg_prop = match_filter_denylist(pkalg_prop, \"ssh-rsa\")) == NULL)\n\t\tfatal(\"match_filter_denylist failed\");\n\tdebug2_f(\"compat public key proposal: %s\", pkalg_prop);\n\tif (*pkalg_prop == '\\0')\n\t\tfatal(\"No supported PK algorithms found\");\n\treturn pkalg_prop;\n}\n\nchar *\ncompat_kex_proposal(struct ssh *ssh, char *p)\n{\n\tif ((ssh->compat & (SSH_BUG_CURVE25519PAD|SSH_OLD_DHGEX)) == 0)\n\t\treturn p;\n\tdebug2_f(\"original KEX proposal: %s\", p);\n\tif ((ssh->compat & SSH_BUG_CURVE25519PAD) != 0)\n\t\tif ((p = match_filter_denylist(p,\n\t\t    \"curve25519-sha256@libssh.org\")) == NULL)\n\t\t\tfatal(\"match_filter_denylist failed\");\n\tif ((ssh->compat & SSH_OLD_DHGEX) != 0) {\n\t\tif ((p = match_filter_denylist(p,\n\t\t    \"diffie-hellman-group-exchange-sha256,\"\n\t\t    \"diffie-hellman-group-exchange-sha1\")) == NULL)\n\t\t\tfatal(\"match_filter_denylist failed\");\n\t}\n\tdebug2_f(\"compat KEX proposal: %s\", p);\n\tif (*p == '\\0')\n\t\tfatal(\"No supported key exchange algorithms found\");\n\treturn p;\n}\n\n"], "fixing_code": ["/* $OpenBSD: compat.c,v 1.120 2022/07/01 03:35:45 dtucker Exp $ */\n/*\n * Copyright (c) 1999, 2000, 2001, 2002 Markus Friedl.  All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions\n * are met:\n * 1. Redistributions of source code must retain the above copyright\n *    notice, this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright\n *    notice, this list of conditions and the following disclaimer in the\n *    documentation and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR\n * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,\n * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF\n * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#include \"includes.h\"\n\n#include <sys/types.h>\n\n#include <stdlib.h>\n#include <string.h>\n#include <stdarg.h>\n\n#include \"xmalloc.h\"\n#include \"packet.h\"\n#include \"compat.h\"\n#include \"log.h\"\n#include \"match.h\"\n#include \"kex.h\"\n\n/* determine bug flags from SSH protocol banner */\nvoid\ncompat_banner(struct ssh *ssh, const char *version)\n{\n\tint i;\n\tstatic struct {\n\t\tchar\t*pat;\n\t\tint\tbugs;\n\t} check[] = {\n\t\t{ \"OpenSSH_2.*,\"\n\t\t  \"OpenSSH_3.0*,\"\n\t\t  \"OpenSSH_3.1*\",\tSSH_BUG_EXTEOF|SSH_OLD_FORWARD_ADDR|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_3.*\",\tSSH_OLD_FORWARD_ADDR|SSH_BUG_SIGTYPE },\n\t\t{ \"Sun_SSH_1.0*\",\tSSH_BUG_NOREKEY|SSH_BUG_EXTEOF|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_2*,\"\n\t\t  \"OpenSSH_3*,\"\n\t\t  \"OpenSSH_4*\",\t\tSSH_BUG_SIGTYPE },\n\t\t{ \"OpenSSH_5*\",\t\tSSH_NEW_OPENSSH|SSH_BUG_DYNAMIC_RPORT|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_6.6.1*\",\tSSH_NEW_OPENSSH|SSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_6.5*,\"\n\t\t  \"OpenSSH_6.6*\",\tSSH_NEW_OPENSSH|SSH_BUG_CURVE25519PAD|\n\t\t\t\t\tSSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH_7.4*\",\tSSH_NEW_OPENSSH|SSH_BUG_SIGTYPE|\n\t\t\t\t\tSSH_BUG_SIGTYPE74},\n\t\t{ \"OpenSSH_7.0*,\"\n\t\t  \"OpenSSH_7.1*,\"\n\t\t  \"OpenSSH_7.2*,\"\n\t\t  \"OpenSSH_7.3*,\"\n\t\t  \"OpenSSH_7.5*,\"\n\t\t  \"OpenSSH_7.6*,\"\n\t\t  \"OpenSSH_7.7*\",\tSSH_NEW_OPENSSH|SSH_BUG_SIGTYPE},\n\t\t{ \"OpenSSH*\",\t\tSSH_NEW_OPENSSH },\n\t\t{ \"*MindTerm*\",\t\t0 },\n\t\t{ \"3.0.*\",\t\tSSH_BUG_DEBUG },\n\t\t{ \"3.0 SecureCRT*\",\tSSH_OLD_SESSIONID },\n\t\t{ \"1.7 SecureFX*\",\tSSH_OLD_SESSIONID },\n\t\t{ \"1.2.18*,\"\n\t\t  \"1.2.19*,\"\n\t\t  \"1.2.20*,\"\n\t\t  \"1.2.21*,\"\n\t\t  \"1.2.22*\",\t\tSSH_BUG_IGNOREMSG },\n\t\t{ \"1.3.2*\",\t\t/* F-Secure */\n\t\t\t\t\tSSH_BUG_IGNOREMSG },\n\t\t{ \"Cisco-1.*\",\t\tSSH_BUG_DHGEX_LARGE|\n\t\t\t\t\tSSH_BUG_HOSTKEYS },\n\t\t{ \"*SSH Compatible Server*\",\t\t\t/* Netscreen */\n\t\t\t\t\tSSH_BUG_PASSWORDPAD },\n\t\t{ \"*OSU_0*,\"\n\t\t  \"OSU_1.0*,\"\n\t\t  \"OSU_1.1*,\"\n\t\t  \"OSU_1.2*,\"\n\t\t  \"OSU_1.3*,\"\n\t\t  \"OSU_1.4*,\"\n\t\t  \"OSU_1.5alpha1*,\"\n\t\t  \"OSU_1.5alpha2*,\"\n\t\t  \"OSU_1.5alpha3*\",\tSSH_BUG_PASSWORDPAD },\n\t\t{ \"*SSH_Version_Mapper*\",\n\t\t\t\t\tSSH_BUG_SCANNER },\n\t\t{ \"PuTTY_Local:*,\"\t/* dev versions < Sep 2014 */\n\t\t  \"PuTTY-Release-0.5*,\" /* 0.50-0.57, DH-GEX in >=0.52 */\n\t\t  \"PuTTY_Release_0.5*,\"\t/* 0.58-0.59 */\n\t\t  \"PuTTY_Release_0.60*,\"\n\t\t  \"PuTTY_Release_0.61*,\"\n\t\t  \"PuTTY_Release_0.62*,\"\n\t\t  \"PuTTY_Release_0.63*,\"\n\t\t  \"PuTTY_Release_0.64*\",\n\t\t\t\t\tSSH_OLD_DHGEX },\n\t\t{ \"FuTTY*\",\t\tSSH_OLD_DHGEX }, /* Putty Fork */\n\t\t{ \"Probe-*\",\n\t\t\t\t\tSSH_BUG_PROBE },\n\t\t{ \"TeraTerm SSH*,\"\n\t\t  \"TTSSH/1.5.*,\"\n\t\t  \"TTSSH/2.1*,\"\n\t\t  \"TTSSH/2.2*,\"\n\t\t  \"TTSSH/2.3*,\"\n\t\t  \"TTSSH/2.4*,\"\n\t\t  \"TTSSH/2.5*,\"\n\t\t  \"TTSSH/2.6*,\"\n\t\t  \"TTSSH/2.70*,\"\n\t\t  \"TTSSH/2.71*,\"\n\t\t  \"TTSSH/2.72*\",\tSSH_BUG_HOSTKEYS },\n\t\t{ \"WinSCP_release_4*,\"\n\t\t  \"WinSCP_release_5.0*,\"\n\t\t  \"WinSCP_release_5.1,\"\n\t\t  \"WinSCP_release_5.1.*,\"\n\t\t  \"WinSCP_release_5.5,\"\n\t\t  \"WinSCP_release_5.5.*,\"\n\t\t  \"WinSCP_release_5.6,\"\n\t\t  \"WinSCP_release_5.6.*,\"\n\t\t  \"WinSCP_release_5.7,\"\n\t\t  \"WinSCP_release_5.7.1,\"\n\t\t  \"WinSCP_release_5.7.2,\"\n\t\t  \"WinSCP_release_5.7.3,\"\n\t\t  \"WinSCP_release_5.7.4\",\n\t\t\t\t\tSSH_OLD_DHGEX },\n\t\t{ \"ConfD-*\",\n\t\t\t\t\tSSH_BUG_UTF8TTYMODE },\n\t\t{ \"Twisted_*\",\t\t0 },\n\t\t{ \"Twisted*\",\t\tSSH_BUG_DEBUG },\n\t\t{ NULL,\t\t\t0 }\n\t};\n\n\t/* process table, return first match */\n\tssh->compat = 0;\n\tfor (i = 0; check[i].pat; i++) {\n\t\tif (match_pattern_list(version, check[i].pat, 0) == 1) {\n\t\t\tdebug_f(\"match: %s pat %s compat 0x%08x\",\n\t\t\t    version, check[i].pat, check[i].bugs);\n\t\t\tssh->compat = check[i].bugs;\n\t\t\treturn;\n\t\t}\n\t}\n\tdebug_f(\"no match: %s\", version);\n}\n\n/* Always returns pointer to allocated memory, caller must free. */\nchar *\ncompat_cipher_proposal(struct ssh *ssh, char *cipher_prop)\n{\n\tif (!(ssh->compat & SSH_BUG_BIGENDIANAES))\n\t\treturn xstrdup(cipher_prop);\n\tdebug2_f(\"original cipher proposal: %s\", cipher_prop);\n\tif ((cipher_prop = match_filter_denylist(cipher_prop, \"aes*\")) == NULL)\n\t\tfatal(\"match_filter_denylist failed\");\n\tdebug2_f(\"compat cipher proposal: %s\", cipher_prop);\n\tif (*cipher_prop == '\\0')\n\t\tfatal(\"No supported ciphers found\");\n\treturn cipher_prop;\n}\n\n/* Always returns pointer to allocated memory, caller must free. */\nchar *\ncompat_pkalg_proposal(struct ssh *ssh, char *pkalg_prop)\n{\n\tif (!(ssh->compat & SSH_BUG_RSASIGMD5))\n\t\treturn xstrdup(pkalg_prop);\n\tdebug2_f(\"original public key proposal: %s\", pkalg_prop);\n\tif ((pkalg_prop = match_filter_denylist(pkalg_prop, \"ssh-rsa\")) == NULL)\n\t\tfatal(\"match_filter_denylist failed\");\n\tdebug2_f(\"compat public key proposal: %s\", pkalg_prop);\n\tif (*pkalg_prop == '\\0')\n\t\tfatal(\"No supported PK algorithms found\");\n\treturn pkalg_prop;\n}\n\n/* Always returns pointer to allocated memory, caller must free. */\nchar *\ncompat_kex_proposal(struct ssh *ssh, char *p)\n{\n\tchar *cp = NULL;\n\n\tif ((ssh->compat & (SSH_BUG_CURVE25519PAD|SSH_OLD_DHGEX)) == 0)\n\t\treturn xstrdup(p);\n\tdebug2_f(\"original KEX proposal: %s\", p);\n\tif ((ssh->compat & SSH_BUG_CURVE25519PAD) != 0)\n\t\tif ((p = match_filter_denylist(p,\n\t\t    \"curve25519-sha256@libssh.org\")) == NULL)\n\t\t\tfatal(\"match_filter_denylist failed\");\n\tif ((ssh->compat & SSH_OLD_DHGEX) != 0) {\n\t\tcp = p;\n\t\tif ((p = match_filter_denylist(p,\n\t\t    \"diffie-hellman-group-exchange-sha256,\"\n\t\t    \"diffie-hellman-group-exchange-sha1\")) == NULL)\n\t\t\tfatal(\"match_filter_denylist failed\");\n\t\tfree(cp);\n\t}\n\tdebug2_f(\"compat KEX proposal: %s\", p);\n\tif (*p == '\\0')\n\t\tfatal(\"No supported key exchange algorithms found\");\n\treturn p;\n}\n\n"], "filenames": ["compat.c"], "buggy_code_start_loc": [1], "buggy_code_end_loc": [201], "fixing_code_start_loc": [1], "fixing_code_end_loc": [209], "type": "CWE-415", "message": "OpenSSH server (sshd) 9.1 introduced a double-free vulnerability during options.kex_algorithms handling. This is fixed in OpenSSH 9.2. The double free can be leveraged, by an unauthenticated remote attacker in the default configuration, to jump to any location in the sshd address space. One third-party report states \"remote code execution is theoretically possible.\"", "other": {"cve": {"id": "CVE-2023-25136", "sourceIdentifier": "cve@mitre.org", "published": "2023-02-03T06:15:09.350", "lastModified": "2023-04-19T04:15:31.223", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "OpenSSH server (sshd) 9.1 introduced a double-free vulnerability during options.kex_algorithms handling. This is fixed in OpenSSH 9.2. The double free can be leveraged, by an unauthenticated remote attacker in the default configuration, to jump to any location in the sshd address space. One third-party report states \"remote code execution is theoretically possible.\""}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.2, "impactScore": 4.2}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-415"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:openssh:openssh:9.1:*:*:*:*:*:*:*", "matchCriteriaId": "7E9E86AE-C082-48FD-8F3F-599FD7036E38"}]}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2023/02/13/1", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2023/02/22/1", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2023/02/22/2", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2023/02/23/3", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2023/03/06/1", "source": "cve@mitre.org", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2023/03/09/2", "source": "cve@mitre.org"}, {"url": "https://bugzilla.mindrot.org/show_bug.cgi?id=3522", "source": "cve@mitre.org", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}, {"url": "https://ftp.openbsd.org/pub/OpenBSD/patches/7.2/common/017_sshd.patch.sig", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/openssh/openssh-portable/commit/486c4dc3b83b4b67d663fb0fa62bc24138ec3946", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://jfrog.com/blog/openssh-pre-auth-double-free-cve-2023-25136-writeup-and-proof-of-concept/", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/JGAUIXJ3TEKCRKVWFQ6GDAGQFTIIGQQP/", "source": "cve@mitre.org"}, {"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/R7LKQDFZWKYHQ65TBSH2X2HJQ4V2THS3/", "source": "cve@mitre.org"}, {"url": "https://news.ycombinator.com/item?id=34711565", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://security.netapp.com/advisory/ntap-20230309-0003/", "source": "cve@mitre.org"}, {"url": "https://www.openwall.com/lists/oss-security/2023/02/02/2", "source": "cve@mitre.org", "tags": ["Exploit", "Mailing List", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/openssh/openssh-portable/commit/486c4dc3b83b4b67d663fb0fa62bc24138ec3946"}}