{"buggy_code": ["<?php\n/**\n * ShortDescription actions hooks\n *\n * @file\n * @ingroup Extensions\n * @license GPL-3.0-or-later\n */\n\ndeclare( strict_types=1 );\n\nnamespace MediaWiki\\Extension\\ShortDescription\\Hooks;\n\nuse MediaWiki\\Hook\\InfoActionHook;\n\nclass ActionsHooks implements InfoActionHook {\n\n\t/**\n\t * InfoAction hook handler, adds the short description to the info=action page\n\t *\n\t * @see https://www.mediawiki.org/wiki/Manual:Hooks/InfoAction\n\t *\n\t * @param IContextSource $context Context, used to extract the title of the page\n\t * @param array[] $pageInfo Auxillary information about the page.\n\t */\n\tpublic function onInfoAction( $context, &$pageInfo ) {\n\t\t$shortdesc = HookUtils::getShortDescription( $context->getTitle() );\n\t\tif ( !$shortdesc ) {\n\t\t\t// The page has no short description\n\t\t\treturn;\n\t\t}\n\n\t\t$pageInfo['header-basic'][] = [\n\t\t\t$context->msg( 'shortdescription-info-label' ),\n\t\t\t$shortdesc\n\t\t];\n\t}\n}\n", "function main() {\n\tvar shortdesc = mw.config.get( 'wgShortDesc' ),\n\t\ttagline;\n\n\tif ( shortdesc ) {\n\t\ttagline = document.getElementById( 'siteSub' );\n\t\t// Wikipedia uses shortdescription class\n\t\t// Added for gadgets and extension compatibility\n\t\ttagline.classList.add( 'ext-shortdesc', 'shortdescription' );\n\t\ttagline.innerHTML = shortdesc;\n\t}\n}\n\nmain();\n"], "fixing_code": ["<?php\n/**\n * ShortDescription actions hooks\n *\n * @file\n * @ingroup Extensions\n * @license GPL-3.0-or-later\n */\n\ndeclare( strict_types=1 );\n\nnamespace MediaWiki\\Extension\\ShortDescription\\Hooks;\n\nuse MediaWiki\\Hook\\InfoActionHook;\n\nclass ActionsHooks implements InfoActionHook {\n\n\t/**\n\t * InfoAction hook handler, adds the short description to the info=action page\n\t *\n\t * @see https://www.mediawiki.org/wiki/Manual:Hooks/InfoAction\n\t *\n\t * @param IContextSource $context Context, used to extract the title of the page\n\t * @param array[] $pageInfo Auxillary information about the page.\n\t */\n\tpublic function onInfoAction( $context, &$pageInfo ) {\n\t\t$shortdesc = HookUtils::getShortDescription( $context->getTitle() );\n\t\tif ( !$shortdesc ) {\n\t\t\t// The page has no short description\n\t\t\treturn;\n\t\t}\n\n\t\t$pageInfo['header-basic'][] = [\n\t\t\t$context->msg( 'shortdescription-info-label' ),\n\t\t\thtmlspecialchars( $shortdesc )\n\t\t];\n\t}\n}\n", "function main() {\n\tvar shortdesc = mw.config.get( 'wgShortDesc' ),\n\t\ttagline;\n\n\tif ( shortdesc ) {\n\t\ttagline = document.getElementById( 'siteSub' );\n\t\t// Wikipedia uses shortdescription class\n\t\t// Added for gadgets and extension compatibility\n\t\ttagline.classList.add( 'ext-shortdesc', 'shortdescription' );\n\t\ttagline.innerHTML = mw.html.escape( shortdesc );\n\t}\n}\n\nmain();\n"], "filenames": ["includes/Hooks/ActionsHooks.php", "modules/ext.shortDescription.js"], "buggy_code_start_loc": [35, 10], "buggy_code_end_loc": [36, 11], "fixing_code_start_loc": [35, 10], "fixing_code_end_loc": [36, 11], "type": "CWE-79", "message": "ShortDescription is a MediaWiki extension that provides local short description support. A cross-site scripting (XSS) vulnerability exists in versions prior to 2.3.4. On a wiki that has the ShortDescription enabled, XSS can be triggered on any page or the page with the action=info parameter, which displays the shortdesc property. This is achieved using the wikitext `{{SHORTDESC:&lt;img src=x onerror=alert()&gt;}}`. This issue has a patch in version 2.3.4.", "other": {"cve": {"id": "CVE-2022-21710", "sourceIdentifier": "security-advisories@github.com", "published": "2022-01-24T20:15:08.600", "lastModified": "2022-01-28T18:56:22.597", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "ShortDescription is a MediaWiki extension that provides local short description support. A cross-site scripting (XSS) vulnerability exists in versions prior to 2.3.4. On a wiki that has the ShortDescription enabled, XSS can be triggered on any page or the page with the action=info parameter, which displays the shortdesc property. This is achieved using the wikitext `{{SHORTDESC:&lt;img src=x onerror=alert()&gt;}}`. This issue has a patch in version 2.3.4."}, {"lang": "es", "value": "ShortDescription es una extensi\u00f3n de MediaWiki que proporciona soporte local para descripciones cortas. Se presenta una vulnerabilidad de tipo cross-site scripting (XSS) en versiones anteriores a 2.3.4. En un wiki que tenga la ShortDescription habilitada, un ataque de tipo XSS puede ser desencadenado en cualquier p\u00e1gina o en la p\u00e1gina con el par\u00e1metro action=info, que muestra la propiedad shortdesc. Esto es conseguido usando el wikitext \"{SHORTDESC:&lt;img src=x onerror=alert()&gt;}}\". Este problema presenta un parche en la versi\u00f3n 2.3.4"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.7, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mediawiki:shortdescription:*:*:*:*:*:mediawiki:*:*", "versionEndExcluding": "2.3.4", "matchCriteriaId": "161BDB24-4950-4933-AEB4-E6B208EA1521"}]}]}], "references": [{"url": "https://github.com/StarCitizenTools/mediawiki-extensions-ShortDescription/commit/7c86644158388620c6c858258cc4e1a8de6e48ea", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/StarCitizenTools/mediawiki-extensions-ShortDescription/commit/bf568edd892adb8528dcb64f75dddf3eeaccc12c", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/StarCitizenTools/mediawiki-extensions-ShortDescription/security/advisories/GHSA-mgcp-qw2r-6832", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/StarCitizenTools/mediawiki-extensions-ShortDescription/commit/7c86644158388620c6c858258cc4e1a8de6e48ea"}}