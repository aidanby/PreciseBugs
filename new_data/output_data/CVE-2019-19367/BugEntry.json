{"buggy_code": ["<?php\n/*\n\tFusionPBX\n\tVersion: MPL 1.1\n\n\tThe contents of this file are subject to the Mozilla Public License Version\n\t1.1 (the \"License\"); you may not use this file except in compliance with\n\tthe License. You may obtain a copy of the License at\n\thttp://www.mozilla.org/MPL/\n\n\tSoftware distributed under the License is distributed on an \"AS IS\" basis,\n\tWITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n\tfor the specific language governing rights and limitations under the\n\tLicense.\n\n\tThe Original Code is FusionPBX\n\n\tThe Initial Developer of the Original Code is\n\tMark J Crane <markjcrane@fusionpbx.com>\n\tPortions created by the Initial Developer are Copyright (C) 2018\n\tthe Initial Developer. All Rights Reserved.\n\n\tContributor(s):\n\tMark J Crane <markjcrane@fusionpbx.com>\n*/\n\n//includes\n\trequire_once \"root.php\";\n\trequire_once \"resources/require.php\";\n\trequire_once \"resources/check_auth.php\";\n\n//check permissions\n\tif (permission_exists('fax_file_view')) {\n\t\t//access granted\n\t}\n\telse {\n\t\techo \"access denied\";\n\t\texit;\n\t}\n\n//add multi-lingual support\n\t$language = new text;\n\t$text = $language->get();\n\n//get variables used to control the order\n\t$order_by = $_GET[\"order_by\"];\n\t$order = $_GET[\"order\"];\n\n//get fax extension\n\tif (is_uuid($_GET[\"id\"])) {\n\t\t$fax_uuid = $_GET[\"id\"];\n\t\tif (if_group(\"superadmin\") || if_group(\"admin\")) {\n\t\t\t//show all fax extensions\n\t\t\t$sql = \"select fax_name, fax_extension from v_fax \";\n\t\t\t$sql .= \"where domain_uuid = :domain_uuid \";\n\t\t\t$sql .= \"and fax_uuid = :fax_uuid \";\n\t\t\t$parameters['domain_uuid'] = $_SESSION['domain_uuid'];\n\t\t\t$parameters['fax_uuid'] = $fax_uuid;\n\t\t}\n\t\telse {\n\t\t\t//show only assigned fax extensions\n\t\t\t$sql = \"select fax_name, fax_extension from v_fax as f, v_fax_users as u \";\n\t\t\t$sql .= \"where f.fax_uuid = u.fax_uuid \";\n\t\t\t$sql .= \"and f.domain_uuid = :domain_uuid \";\n\t\t\t$sql .= \"and f.fax_uuid = :fax_uuid \";\n\t\t\t$sql .= \"and u.user_uuid = :user_uuid \";\n\t\t\t$parameters['domain_uuid'] = $_SESSION['domain_uuid'];\n\t\t\t$parameters['fax_uuid'] = $fax_uuid;\n\t\t\t$parameters['user_uuid'] = $_SESSION['user_uuid'];\n\t\t}\n\t\t$database = new database;\n\t\t$row = $database->select($sql, $parameters, 'row');\n\t\tif (is_array($row) && @sizeof($row) != 0) {\n\t\t\t//set database fields as variables\n\t\t\t\t$fax_name = $row[\"fax_name\"];\n\t\t\t\t$fax_extension = $row[\"fax_extension\"];\n\t\t}\n\t\telse {\n\t\t\tif (!if_group(\"superadmin\") && !if_group(\"admin\")) {\n\t\t\t\techo \"access denied\";\n\t\t\t\texit;\n\t\t\t}\n\t\t}\n\t\tunset($sql, $parameters, $row);\n\t}\n\n//set the fax directory\n\t$fax_dir = $_SESSION['switch']['storage']['dir'].'/fax/'.$_SESSION['domain_name'];\n\n//download the fax\n\tif ($_GET['a'] == \"download\") {\n\t\tsession_cache_limiter('public');\n\t\t//test to see if it is in the inbox or sent directory.\n\t\tif ($_GET['type'] == \"fax_inbox\") {\n\t\t\tif (file_exists($fax_dir.'/'.$_GET['ext'].'/inbox/'.$_GET['filename'])) {\n\t\t\t\t$tmp_faxdownload_file = $fax_dir.'/'.$_GET['ext'].'/inbox/'.$_GET['filename'];\n\t\t\t}\n\t\t}\n\t\telse if ($_GET['type'] == \"fax_sent\") {\n\t\t\tif  (file_exists($fax_dir.'/'.$_GET['ext'].'/sent/'.$_GET['filename'])) {\n\t\t\t\t$tmp_faxdownload_file = $fax_dir.'/'.$_GET['ext'].'/sent/'.$_GET['filename'];\n\t\t\t}\n\t\t}\n\t\t//let's see if we found it\n\t\tif (strlen($tmp_faxdownload_file) > 0) {\n\t\t\t$fd = fopen($tmp_faxdownload_file, \"rb\");\n\t\t\tif ($_GET['t'] == \"bin\") {\n\t\t\t\theader(\"Content-Type: application/force-download\");\n\t\t\t\theader(\"Content-Type: application/octet-stream\");\n\t\t\t\theader(\"Content-Description: File Transfer\");\n\t\t\t\theader('Content-Disposition: attachment; filename=\"'.$_GET['filename'].'\"');\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$file_ext = substr($_GET['filename'], -3);\n\t\t\t\tif ($file_ext == \"tif\") {\n\t\t\t\t\theader(\"Content-Type: image/tiff\");\n\t\t\t\t}\n\t\t\t\telse if ($file_ext == \"png\") {\n\t\t\t\t\theader(\"Content-Type: image/png\");\n\t\t\t\t}\n\t\t\t\telse if ($file_ext == \"jpg\") {\n\t\t\t\t\theader('Content-Type: image/jpeg');\n\t\t\t\t}\n\t\t\t\telse if ($file_ext == \"pdf\") {\n\t\t\t\t\theader(\"Content-Type: application/pdf\");\n\t\t\t\t}\n\t\t\t}\n\t\t\theader('Accept-Ranges: bytes');\n\t\t\theader(\"Cache-Control: no-cache, must-revalidate\"); // HTTP/1.1\n\t\t\theader(\"Expires: Sat, 26 Jul 1997 05:00:00 GMT\"); // date in the past\n\t\t\theader(\"Content-Length: \".filesize($tmp_faxdownload_file));\n\t\t\tfpassthru($fd);\n\t\t}\n\t\telse {\n\t\t\techo $text['label-file'];\n\t\t}\n\t\texit;\n\t}\n\n//get the fax extension\n\tif (strlen($fax_extension) > 0) {\n\t\t//set the fax directories. example /usr/local/freeswitch/storage/fax/329/inbox\n\t\t\t$dir_fax_inbox = $fax_dir.'/'.$fax_extension.'/inbox';\n\t\t\t$dir_fax_sent = $fax_dir.'/'.$fax_extension.'/sent';\n\t\t\t$dir_fax_temp = $fax_dir.'/'.$fax_extension.'/temp';\n\n\t\t//make sure the directories exist\n\t\t\tif (!is_dir($_SESSION['switch']['storage']['dir'])) {\n\t\t\t\tevent_socket_mkdir($_SESSION['switch']['storage']['dir']);\n\t\t\t}\n\t\t\tif (!is_dir($fax_dir.'/'.$fax_extension)) {\n\t\t\t\tevent_socket_mkdir($fax_dir.'/'.$fax_extension);\n\t\t\t}\n\t\t\tif (!is_dir($dir_fax_inbox)) {\n\t\t\t\tevent_socket_mkdir($dir_fax_inbox);\n\t\t\t}\n\t\t\tif (!is_dir($dir_fax_sent)) {\n\t\t\t\tevent_socket_mkdir($dir_fax_sent);\n\t\t\t}\n\t\t\tif (!is_dir($dir_fax_temp)) {\n\t\t\t\tevent_socket_mkdir($dir_fax_temp);\n\t\t\t}\n\t}\n\n//additional includes\n\trequire_once \"resources/header.php\";\n\trequire_once \"resources/paging.php\";\n\n//prepare to page the results\n\t$sql = \"select count(*) from v_fax_files \";\n\t$sql .= \"where fax_uuid = :fax_uuid \";\n\t$sql .= \"and domain_uuid = :domain_uuid \";\n\tif ($_REQUEST['box'] == 'inbox') {\n\t\t$sql .= \"and fax_mode = 'rx' \";\n\t}\n\tif ($_REQUEST['box'] == 'sent') {\n\t\t$sql .= \"and fax_mode = 'tx' \";\n\t}\n\t$parameters['fax_uuid'] = $fax_uuid;\n\t$parameters['domain_uuid'] = $domain_uuid;\n\t$database = new database;\n\t$num_rows = $database->select($sql, $parameters, 'column');\n\n//prepare to page the results\n\t$rows_per_page = ($_SESSION['domain']['paging']['numeric'] != '') ? $_SESSION['domain']['paging']['numeric'] : 50;\n\t$param = \"&id=\".$_GET['id'].\"&box=\".$_GET['box'].\"&order_by=\".$_GET['order_by'].\"&order=\".$_GET['order'];\n\t$page = $_GET['page'];\n\tif (strlen($page) == 0) { $page = 0; $_GET['page'] = 0; }\n\tlist($paging_controls, $rows_per_page, $var3) = paging($num_rows, $param, $rows_per_page);\n\t$offset = $rows_per_page * $page;\n\n//get the list\n\t$sql = str_replace('count(*)', '*', $sql);\n\t$sql .= order_by($order_by, $order, 'fax_date', 'desc');\n\t$sql .= limit_offset($rows_per_page, $offset);\n\t$database = new database;\n\t$fax_files = $database->select($sql, $parameters, 'all');\n\tunset($sql, $parameters, $num_rows);\n\n//show the header\n\techo \"<table width='100%' border='0' cellpadding='0' cellspacing='0'>\\n\";\n\techo \"\t<tr>\\n\";\n\techo \"\t\t<td align='left' valign='top'>\\n\";\n\tif ($_REQUEST['box'] == 'inbox' && permission_exists('fax_inbox_view')) {\n\t\techo \"\t\t\t<b>\".$text['header-inbox'].\": \".escape($fax_name).\" (\".escape($fax_extension).\")</b>\\n\";\n\t}\n\tif ($_REQUEST['box'] == 'sent' && permission_exists('fax_sent_view')) {\n\t\techo \"\t\t\t<b>\".$text['header-sent'].\": \".escape($fax_name).\" (\".escape($fax_extension).\")</b>\\n\";\n\t}\n\techo \"\t\t</td>\\n\";\n\techo \"\t\t<td width='70%' align='right' valign='top'>\\n\";\n\techo \"\t\t\t<input type='button' class='btn' name='' alt='back' onclick=\\\"window.location='fax.php'\\\" value='\".$text['button-back'].\"'>\\n\";\n\techo \"\t\t</td>\\n\";\n\techo \"\t</tr>\\n\";\n\techo \"</table>\\n\";\n\techo \"<br>\\n\";\n\n//show the table and content\n\t$c = 0;\n\t$row_style[\"0\"] = \"row_style0\";\n\t$row_style[\"1\"] = \"row_style1\";\n\n//show the fax files\n\techo \"<table class='tr_hover' width='100%' border='0' cellpadding='0' cellspacing='0'>\\n\";\n\techo \"<tr>\\n\";\n\techo th_order_by('fax_caller_id_name', $text['label-fax_caller_id_name'], $order_by, $order, \"&id=\".$_GET['id'].\"&box=\".$_GET['box'].\"&page=\".$_GET['page']);\n\techo th_order_by('fax_caller_id_number', $text['label-fax_caller_id_number'], $order_by, $order, \"&id=\".$_GET['id'].\"&box=\".$_GET['box'].\"&page=\".$_GET['page']);\n\tif ($_REQUEST['box'] == 'sent') {\n\t\techo th_order_by('fax_destination', $text['label-fax_destination'], $order_by, $order, \"&id=\".$_GET['id'].\"&box=\".$_GET['box'].\"&page=\".$_GET['page']);\n\t}\n\techo \"<th width=''>\".$text['table-file'].\"</th>\\n\";\n\techo \"<th width='10%'>\".$text['table-view'].\"</th>\\n\";\n\techo th_order_by('fax_date', $text['label-fax_date'], $order_by, $order, \"&id=\".$_GET['id'].\"&box=\".$_GET['box'].\"&page=\".$_GET['page']);\n\techo \"<td style='width: 25px;' class='list_control_icons'>&nbsp;</td>\\n\";\n\techo \"</tr>\\n\";\n\tif (is_array($fax_files) && @sizeof($fax_files) != 0) {\n\t\tforeach($fax_files as $row) {\n\t\t\t$file = basename($row['fax_file_path']);\n\t\t\tif (strtolower(substr($file, -3)) == \"tif\" || strtolower(substr($file, -3)) == \"pdf\") {\n\t\t\t\t$file_name = substr($file, 0, (strlen($file) -4));\n\t\t\t}\n\t\t\t$file_ext = $row['fax_file_type'];\n\n\t\t\t//decode the base64\n\t\t\tif (strlen($row['fax_base64']) > 0) {\n\t\t\t\tif ($_REQUEST['box'] == 'inbox' && permission_exists('fax_inbox_view')) {\n\t\t\t\t\tif (!file_exists($dir_fax_inbox.'/'.$file)) {\n\t\t\t\t\t\tfile_put_contents($dir_fax_inbox.'/'.$file, base64_decode($row['fax_base64']));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ($_REQUEST['box'] == 'sent' && permission_exists('fax_sent_view')) {\n\t\t\t\t\tif (!file_exists($dir_fax_sent.'/'.$file)) {\n\t\t\t\t\t\t//decode the base64\n\t\t\t\t\t\tfile_put_contents($dir_fax_sent.'/'.$file, base64_decode($row['fax_base64']));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//convert the tif to pdf\n\t\t\tunset($dir_fax);\n\t\t\tif ($_REQUEST['box'] == 'inbox' && permission_exists('fax_inbox_view')) {\n\t\t\t\tif (!file_exists($dir_fax_inbox.'/'.$file_name.\".pdf\")) {\n\t\t\t\t\t$dir_fax = $dir_fax_inbox;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ($_REQUEST['box'] == 'sent' && permission_exists('fax_sent_view')) {\n\t\t\t\tif (!file_exists($dir_fax_sent.'/'.$file_name.\".pdf\")) {\n\t\t\t\t\t$dir_fax = $dir_fax_sent;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ($dir_fax != '') {\n\t\t\t\tchdir($dir_fax);\n\t\t\t\t//get fax resolution (ppi, W & H)\n\t\t\t\t\t$resp = exec(\"tiffinfo \".$file_name.\".tif | grep 'Resolution:'\");\n\t\t\t\t\t$resp_array = explode(' ', trim($resp));\n\t\t\t\t\t$ppi_w = (int) $resp_array[1];\n\t\t\t\t\t$ppi_h = (int) $resp_array[2];\n\t\t\t\t\tunset($resp_array);\n\t\t\t\t\t$gs_r = $ppi_w.'x'.$ppi_h; //used by ghostscript\n\t\t\t\t//get page dimensions/size (pixels/inches, W & H)\n\t\t\t\t\t$resp = exec(\"tiffinfo \".$file_name.\".tif | grep 'Image Width:'\");\n\t\t\t\t\t$resp_array = explode(' ', trim($resp));\n\t\t\t\t\t$pix_w = $resp_array[2];\n\t\t\t\t\t$pix_h = $resp_array[5];\n\t\t\t\t\tunset($resp_array);\n\t\t\t\t\t$gs_g = $pix_w.'x'.$pix_h; //used by ghostscript\n\t\t\t\t\t$page_width = $pix_w / $ppi_w;\n\t\t\t\t\t$page_height = $pix_h / $ppi_h;\n\t\t\t\t\tif ($page_width > 8.4 && $page_height > 13) {\n\t\t\t\t\t\t$page_width = 8.5;\n\t\t\t\t\t\t$page_height = 14;\n\t\t\t\t\t\t$page_size = 'legal';\n\t\t\t\t\t}\n\t\t\t\t\telse if ($page_width > 8.4 && $page_height < 12) {\n\t\t\t\t\t\t$page_width = 8.5;\n\t\t\t\t\t\t$page_height = 11;\n\t\t\t\t\t\t$page_size = 'letter';\n\t\t\t\t\t}\n\t\t\t\t\telse if ($page_width < 8.4 && $page_height > 11) {\n\t\t\t\t\t\t$page_width = 8.3;\n\t\t\t\t\t\t$page_height = 11.7;\n\t\t\t\t\t\t$page_size = 'a4';\n\t\t\t\t\t}\n\t\t\t\t//generate pdf (a work around, as tiff2pdf improperly inverts the colors)\n\t\t\t\t\t$cmd_tif2pdf = \"tiff2pdf -i -u i -p \".$page_size.\" -w \".$page_width.\" -l \".$page_height.\" -f -o \".$dir_fax_temp.'/'.$file_name.\".pdf \".$dir_fax.'/'.$file_name.\".tif\";\n\t\t\t\t\t//echo $cmd_tif2pdf.\"<br>\";\n\t\t\t\t\texec($cmd_tif2pdf);\n\t\t\t\t\tchdir($dir_fax_temp);\n\t\t\t\t\t$cmd_pdf2tif = \"gs -q -sDEVICE=tiffg3 -r\".$gs_r.\" -g\".$gs_g.\" -dNOPAUSE -sOutputFile=\".$file_name.\"_temp.tif -- \".$file_name.\".pdf -c quit\";\n\t\t\t\t\t//echo $cmd_pdf2tif.\"<br>\";\n\t\t\t\t\texec($cmd_pdf2tif); //convert pdf to tif\n\t\t\t\t\t@unlink($dir_fax_temp.'/'.$file_name.\".pdf\");\n\t\t\t\t\t$cmd_tif2pdf = \"tiff2pdf -i -u i -p \".$page_size.\" -w \".$page_width.\" -l \".$page_height.\" -f -o \".$dir_fax.'/'.$file_name.\".pdf \".$dir_fax_temp.'/'.$file_name.\"_temp.tif\";\n\t\t\t\t\t//echo $cmd_tif2pdf.\"<br>\";\n\t\t\t\t\texec($cmd_tif2pdf);\n\t\t\t\t\t@unlink($dir_fax_temp.'/'.$file_name.\"_temp.tif\");\n\t\t\t}\n\t\t\techo \"</td></tr>\";\n\t\t\techo \"<tr \".$tr_link.\">\\n\";\n\t\t\techo \"\t<td valign='top' class='\".$row_style[$c].\"'>\".escape($row['fax_caller_id_name']).\"&nbsp;</td>\\n\";\n\t\t\techo \"\t<td valign='top' class='\".$row_style[$c].\"'>\".escape(format_phone($row['fax_caller_id_number'])).\"&nbsp;</td>\\n\";\n\t\t\tif ($_REQUEST['box'] == 'sent') {\n\t\t\t\techo \"\t<td valign='top' class='\".$row_style[$c].\"'>\".escape(format_phone($row['fax_destination'])).\"&nbsp;</td>\\n\";\n\t\t\t}\n\t\t\techo \"  <td class='\".$row_style[$c].\"' ondblclick=\\\"\\\">\\n\";\n\t\t\tif ($_REQUEST['box'] == 'inbox' && permission_exists('fax_inbox_view')) {\n\t\t\t\techo \"\t  <a href=\\\"fax_files.php?id=\".$fax_uuid.\"&a=download&type=fax_inbox&t=bin&ext=\".escape(urlencode($fax_extension)).\"&filename=\".escape(urlencode($file)).\"\\\">\\n\";\n\t\t\t}\n\t\t\tif ($_REQUEST['box'] == 'sent' && permission_exists('fax_sent_view')) {\n\t\t\t\techo \"\t  <a href=\\\"fax_files.php?id=\".$fax_uuid.\"&a=download&type=fax_sent&t=bin&ext=\".escape(urlencode($fax_extension)).\"&filename=\".escape(urlencode($file)).\"\\\">\\n\";\n\t\t\t}\n\t\t\techo \"    \t$file_name\";\n\t\t\techo \"\t  </a>\";\n\t\t\techo \"  </td>\\n\";\n\t\t\techo \"  <td class='\".$row_style[$c].\"' ondblclick=''>\\n\";\n\t\t\tif ($_REQUEST['box'] == 'inbox') {\n\t\t\t\t$dir_fax = $dir_fax_inbox;\n\t\t\t}\n\t\t\tif ($_REQUEST['box'] == 'sent') {\n\t\t\t\t$dir_fax = $dir_fax_sent;\n\t\t\t}\n\t\t\tif (file_exists($dir_fax.'/'.$file_name.\".pdf\")) {\n\t\t\t\tif ($_REQUEST['box'] == 'inbox' && permission_exists('fax_inbox_view')) {\n\t\t\t\t\techo \"\t  <a href=\\\"fax_files.php?id=\".escape($fax_uuid).\"&a=download&type=fax_inbox&t=bin&ext=\".escape(urlencode($fax_extension)).\"&filename=\".escape(urlencode($file_name)).\".pdf\\\">PDF</a>\\n\";\n\t\t\t\t}\n\t\t\t\tif ($_REQUEST['box'] == 'sent' && permission_exists('fax_sent_view')) {\n\t\t\t\t\techo \"\t  <a href=\\\"fax_files.php?id=\".escape($fax_uuid).\"&a=download&type=fax_sent&t=bin&ext=\".escape(urlencode($fax_extension)).\"&filename=\".escape(urlencode($file_name)).\".pdf\\\">PDF</a>\\n\";\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\techo \"&nbsp;\\n\";\n\t\t\t}\n\t\t\t$fax_date = ($_SESSION['domain']['time_format']['text'] == '12h') ? date(\"F d Y H:i\", $row['fax_epoch']) : date(\"F d Y H:i\", $row['fax_epoch']);\n\t\t\t\n\t\t\techo \"  </td>\\n\";\n\t\t\techo \"\t<td valign='top' class='\".$row_style[$c].\"'>\".$fax_date.\"&nbsp;</td>\\n\";\n\t\t\techo \"\t<td style='width: 25px;' class='list_control_icons'>\";\n\t\t\tif (permission_exists('fax_file_delete')) {\n\t\t\t\techo \"<a href='fax_file_delete.php?id=\".escape($row['fax_file_uuid']).\"' alt='\".$text['button-delete'].\"' onclick=\\\"return confirm('\".$text['confirm-delete'].\"')\\\">$v_link_label_delete</a>\";\n\t\t\t}\n\t\t\techo \"\t</td>\\n\";\n\t\t\techo \"</tr>\\n\";\n\t\t\t$c = ($c) ? 0 : 1;\n\t\t}\n\t}\n\tunset($fax_files, $row);\n\n//show the paging controls\n\techo \"</table>\";\n\techo \"<br /><br />\";\n\n\techo \"<div align='center'>\".$paging_controls.\"</div>\\n\";\n\techo \"<br /><br />\";\n\n//include the footer\n\trequire_once \"resources/footer.php\";\n\n?>\n"], "fixing_code": ["<?php\n/*\n\tFusionPBX\n\tVersion: MPL 1.1\n\n\tThe contents of this file are subject to the Mozilla Public License Version\n\t1.1 (the \"License\"); you may not use this file except in compliance with\n\tthe License. You may obtain a copy of the License at\n\thttp://www.mozilla.org/MPL/\n\n\tSoftware distributed under the License is distributed on an \"AS IS\" basis,\n\tWITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\n\tfor the specific language governing rights and limitations under the\n\tLicense.\n\n\tThe Original Code is FusionPBX\n\n\tThe Initial Developer of the Original Code is\n\tMark J Crane <markjcrane@fusionpbx.com>\n\tPortions created by the Initial Developer are Copyright (C) 2018\n\tthe Initial Developer. All Rights Reserved.\n\n\tContributor(s):\n\tMark J Crane <markjcrane@fusionpbx.com>\n*/\n\n//includes\n\trequire_once \"root.php\";\n\trequire_once \"resources/require.php\";\n\trequire_once \"resources/check_auth.php\";\n\n//check permissions\n\tif (permission_exists('fax_file_view')) {\n\t\t//access granted\n\t}\n\telse {\n\t\techo \"access denied\";\n\t\texit;\n\t}\n\n//add multi-lingual support\n\t$language = new text;\n\t$text = $language->get();\n\n//get variables used to control the order\n\t$order_by = $_GET[\"order_by\"];\n\t$order = $_GET[\"order\"];\n\n//get fax extension\n\tif (is_uuid($_GET[\"id\"])) {\n\t\t$fax_uuid = $_GET[\"id\"];\n\t\tif (if_group(\"superadmin\") || if_group(\"admin\")) {\n\t\t\t//show all fax extensions\n\t\t\t$sql = \"select fax_name, fax_extension from v_fax \";\n\t\t\t$sql .= \"where domain_uuid = :domain_uuid \";\n\t\t\t$sql .= \"and fax_uuid = :fax_uuid \";\n\t\t\t$parameters['domain_uuid'] = $_SESSION['domain_uuid'];\n\t\t\t$parameters['fax_uuid'] = $fax_uuid;\n\t\t}\n\t\telse {\n\t\t\t//show only assigned fax extensions\n\t\t\t$sql = \"select fax_name, fax_extension from v_fax as f, v_fax_users as u \";\n\t\t\t$sql .= \"where f.fax_uuid = u.fax_uuid \";\n\t\t\t$sql .= \"and f.domain_uuid = :domain_uuid \";\n\t\t\t$sql .= \"and f.fax_uuid = :fax_uuid \";\n\t\t\t$sql .= \"and u.user_uuid = :user_uuid \";\n\t\t\t$parameters['domain_uuid'] = $_SESSION['domain_uuid'];\n\t\t\t$parameters['fax_uuid'] = $fax_uuid;\n\t\t\t$parameters['user_uuid'] = $_SESSION['user_uuid'];\n\t\t}\n\t\t$database = new database;\n\t\t$row = $database->select($sql, $parameters, 'row');\n\t\tif (is_array($row) && @sizeof($row) != 0) {\n\t\t\t//set database fields as variables\n\t\t\t\t$fax_name = $row[\"fax_name\"];\n\t\t\t\t$fax_extension = $row[\"fax_extension\"];\n\t\t}\n\t\telse {\n\t\t\tif (!if_group(\"superadmin\") && !if_group(\"admin\")) {\n\t\t\t\techo \"access denied\";\n\t\t\t\texit;\n\t\t\t}\n\t\t}\n\t\tunset($sql, $parameters, $row);\n\t}\n\n//set the fax directory\n\t$fax_dir = $_SESSION['switch']['storage']['dir'].'/fax/'.$_SESSION['domain_name'];\n\n//download the fax\n\tif ($_GET['a'] == \"download\") {\n\t\tsession_cache_limiter('public');\n\t\t//test to see if it is in the inbox or sent directory.\n\t\tif ($_GET['type'] == \"fax_inbox\") {\n\t\t\tif (file_exists($fax_dir.'/'.$_GET['ext'].'/inbox/'.$_GET['filename'])) {\n\t\t\t\t$tmp_faxdownload_file = $fax_dir.'/'.$_GET['ext'].'/inbox/'.$_GET['filename'];\n\t\t\t}\n\t\t}\n\t\telse if ($_GET['type'] == \"fax_sent\") {\n\t\t\tif  (file_exists($fax_dir.'/'.$_GET['ext'].'/sent/'.$_GET['filename'])) {\n\t\t\t\t$tmp_faxdownload_file = $fax_dir.'/'.$_GET['ext'].'/sent/'.$_GET['filename'];\n\t\t\t}\n\t\t}\n\t\t//let's see if we found it\n\t\tif (strlen($tmp_faxdownload_file) > 0) {\n\t\t\t$fd = fopen($tmp_faxdownload_file, \"rb\");\n\t\t\tif ($_GET['t'] == \"bin\") {\n\t\t\t\theader(\"Content-Type: application/force-download\");\n\t\t\t\theader(\"Content-Type: application/octet-stream\");\n\t\t\t\theader(\"Content-Description: File Transfer\");\n\t\t\t\theader('Content-Disposition: attachment; filename=\"'.$_GET['filename'].'\"');\n\t\t\t}\n\t\t\telse {\n\t\t\t\t$file_ext = substr($_GET['filename'], -3);\n\t\t\t\tif ($file_ext == \"tif\") {\n\t\t\t\t\theader(\"Content-Type: image/tiff\");\n\t\t\t\t}\n\t\t\t\telse if ($file_ext == \"png\") {\n\t\t\t\t\theader(\"Content-Type: image/png\");\n\t\t\t\t}\n\t\t\t\telse if ($file_ext == \"jpg\") {\n\t\t\t\t\theader('Content-Type: image/jpeg');\n\t\t\t\t}\n\t\t\t\telse if ($file_ext == \"pdf\") {\n\t\t\t\t\theader(\"Content-Type: application/pdf\");\n\t\t\t\t}\n\t\t\t}\n\t\t\theader('Accept-Ranges: bytes');\n\t\t\theader(\"Cache-Control: no-cache, must-revalidate\"); // HTTP/1.1\n\t\t\theader(\"Expires: Sat, 26 Jul 1997 05:00:00 GMT\"); // date in the past\n\t\t\theader(\"Content-Length: \".filesize($tmp_faxdownload_file));\n\t\t\tfpassthru($fd);\n\t\t}\n\t\telse {\n\t\t\techo $text['label-file'];\n\t\t}\n\t\texit;\n\t}\n\n//get the fax extension\n\tif (strlen($fax_extension) > 0) {\n\t\t//set the fax directories. example /usr/local/freeswitch/storage/fax/329/inbox\n\t\t\t$dir_fax_inbox = $fax_dir.'/'.$fax_extension.'/inbox';\n\t\t\t$dir_fax_sent = $fax_dir.'/'.$fax_extension.'/sent';\n\t\t\t$dir_fax_temp = $fax_dir.'/'.$fax_extension.'/temp';\n\n\t\t//make sure the directories exist\n\t\t\tif (!is_dir($_SESSION['switch']['storage']['dir'])) {\n\t\t\t\tevent_socket_mkdir($_SESSION['switch']['storage']['dir']);\n\t\t\t}\n\t\t\tif (!is_dir($fax_dir.'/'.$fax_extension)) {\n\t\t\t\tevent_socket_mkdir($fax_dir.'/'.$fax_extension);\n\t\t\t}\n\t\t\tif (!is_dir($dir_fax_inbox)) {\n\t\t\t\tevent_socket_mkdir($dir_fax_inbox);\n\t\t\t}\n\t\t\tif (!is_dir($dir_fax_sent)) {\n\t\t\t\tevent_socket_mkdir($dir_fax_sent);\n\t\t\t}\n\t\t\tif (!is_dir($dir_fax_temp)) {\n\t\t\t\tevent_socket_mkdir($dir_fax_temp);\n\t\t\t}\n\t}\n\n//additional includes\n\trequire_once \"resources/header.php\";\n\trequire_once \"resources/paging.php\";\n\n//prepare to page the results\n\t$sql = \"select count(*) from v_fax_files \";\n\t$sql .= \"where fax_uuid = :fax_uuid \";\n\t$sql .= \"and domain_uuid = :domain_uuid \";\n\tif ($_REQUEST['box'] == 'inbox') {\n\t\t$sql .= \"and fax_mode = 'rx' \";\n\t}\n\tif ($_REQUEST['box'] == 'sent') {\n\t\t$sql .= \"and fax_mode = 'tx' \";\n\t}\n\t$parameters['fax_uuid'] = $fax_uuid;\n\t$parameters['domain_uuid'] = $domain_uuid;\n\t$database = new database;\n\t$num_rows = $database->select($sql, $parameters, 'column');\n\n//prepare to page the results\n\t$rows_per_page = ($_SESSION['domain']['paging']['numeric'] != '') ? $_SESSION['domain']['paging']['numeric'] : 50;\n\t$param = \"&id=\".$fax_uuid.\"&box=\".$_GET['box'].\"&order_by=\".$_GET['order_by'].\"&order=\".$_GET['order'];\n\t$page = $_GET['page'];\n\tif (strlen($page) == 0) { $page = 0; $_GET['page'] = 0; }\n\tlist($paging_controls, $rows_per_page, $var3) = paging($num_rows, $param, $rows_per_page);\n\t$offset = $rows_per_page * $page;\n\n//get the list\n\t$sql = str_replace('count(*)', '*', $sql);\n\t$sql .= order_by($order_by, $order, 'fax_date', 'desc');\n\t$sql .= limit_offset($rows_per_page, $offset);\n\t$database = new database;\n\t$fax_files = $database->select($sql, $parameters, 'all');\n\tunset($sql, $parameters, $num_rows);\n\n//show the header\n\techo \"<table width='100%' border='0' cellpadding='0' cellspacing='0'>\\n\";\n\techo \"\t<tr>\\n\";\n\techo \"\t\t<td align='left' valign='top'>\\n\";\n\tif ($_REQUEST['box'] == 'inbox' && permission_exists('fax_inbox_view')) {\n\t\techo \"\t\t\t<b>\".$text['header-inbox'].\": \".escape($fax_name).\" (\".escape($fax_extension).\")</b>\\n\";\n\t}\n\tif ($_REQUEST['box'] == 'sent' && permission_exists('fax_sent_view')) {\n\t\techo \"\t\t\t<b>\".$text['header-sent'].\": \".escape($fax_name).\" (\".escape($fax_extension).\")</b>\\n\";\n\t}\n\techo \"\t\t</td>\\n\";\n\techo \"\t\t<td width='70%' align='right' valign='top'>\\n\";\n\techo \"\t\t\t<input type='button' class='btn' name='' alt='back' onclick=\\\"window.location='fax.php'\\\" value='\".$text['button-back'].\"'>\\n\";\n\techo \"\t\t</td>\\n\";\n\techo \"\t</tr>\\n\";\n\techo \"</table>\\n\";\n\techo \"<br>\\n\";\n\n//show the table and content\n\t$c = 0;\n\t$row_style[\"0\"] = \"row_style0\";\n\t$row_style[\"1\"] = \"row_style1\";\n\n//show the fax files\n\techo \"<table class='tr_hover' width='100%' border='0' cellpadding='0' cellspacing='0'>\\n\";\n\techo \"<tr>\\n\";\n\techo th_order_by('fax_caller_id_name', $text['label-fax_caller_id_name'], $order_by, $order, \"&id=\".$fax_uuid.\"&box=\".$_GET['box'].\"&page=\".$_GET['page']);\n\techo th_order_by('fax_caller_id_number', $text['label-fax_caller_id_number'], $order_by, $order, \"&id=\".$fax_uuid.\"&box=\".$_GET['box'].\"&page=\".$_GET['page']);\n\tif ($_REQUEST['box'] == 'sent') {\n\t\techo th_order_by('fax_destination', $text['label-fax_destination'], $order_by, $order, \"&id=\".$fax_uuid.\"&box=\".$_GET['box'].\"&page=\".$_GET['page']);\n\t}\n\techo \"<th width=''>\".$text['table-file'].\"</th>\\n\";\n\techo \"<th width='10%'>\".$text['table-view'].\"</th>\\n\";\n\techo th_order_by('fax_date', $text['label-fax_date'], $order_by, $order, \"&id=\".$fax_uuid.\"&box=\".$_GET['box'].\"&page=\".$_GET['page']);\n\techo \"<td style='width: 25px;' class='list_control_icons'>&nbsp;</td>\\n\";\n\techo \"</tr>\\n\";\n\tif (is_array($fax_files) && @sizeof($fax_files) != 0) {\n\t\tforeach($fax_files as $row) {\n\t\t\t$file = basename($row['fax_file_path']);\n\t\t\tif (strtolower(substr($file, -3)) == \"tif\" || strtolower(substr($file, -3)) == \"pdf\") {\n\t\t\t\t$file_name = substr($file, 0, (strlen($file) -4));\n\t\t\t}\n\t\t\t$file_ext = $row['fax_file_type'];\n\n\t\t\t//decode the base64\n\t\t\tif (strlen($row['fax_base64']) > 0) {\n\t\t\t\tif ($_REQUEST['box'] == 'inbox' && permission_exists('fax_inbox_view')) {\n\t\t\t\t\tif (!file_exists($dir_fax_inbox.'/'.$file)) {\n\t\t\t\t\t\tfile_put_contents($dir_fax_inbox.'/'.$file, base64_decode($row['fax_base64']));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ($_REQUEST['box'] == 'sent' && permission_exists('fax_sent_view')) {\n\t\t\t\t\tif (!file_exists($dir_fax_sent.'/'.$file)) {\n\t\t\t\t\t\t//decode the base64\n\t\t\t\t\t\tfile_put_contents($dir_fax_sent.'/'.$file, base64_decode($row['fax_base64']));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//convert the tif to pdf\n\t\t\tunset($dir_fax);\n\t\t\tif ($_REQUEST['box'] == 'inbox' && permission_exists('fax_inbox_view')) {\n\t\t\t\tif (!file_exists($dir_fax_inbox.'/'.$file_name.\".pdf\")) {\n\t\t\t\t\t$dir_fax = $dir_fax_inbox;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ($_REQUEST['box'] == 'sent' && permission_exists('fax_sent_view')) {\n\t\t\t\tif (!file_exists($dir_fax_sent.'/'.$file_name.\".pdf\")) {\n\t\t\t\t\t$dir_fax = $dir_fax_sent;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ($dir_fax != '') {\n\t\t\t\tchdir($dir_fax);\n\t\t\t\t//get fax resolution (ppi, W & H)\n\t\t\t\t\t$resp = exec(\"tiffinfo \".$file_name.\".tif | grep 'Resolution:'\");\n\t\t\t\t\t$resp_array = explode(' ', trim($resp));\n\t\t\t\t\t$ppi_w = (int) $resp_array[1];\n\t\t\t\t\t$ppi_h = (int) $resp_array[2];\n\t\t\t\t\tunset($resp_array);\n\t\t\t\t\t$gs_r = $ppi_w.'x'.$ppi_h; //used by ghostscript\n\t\t\t\t//get page dimensions/size (pixels/inches, W & H)\n\t\t\t\t\t$resp = exec(\"tiffinfo \".$file_name.\".tif | grep 'Image Width:'\");\n\t\t\t\t\t$resp_array = explode(' ', trim($resp));\n\t\t\t\t\t$pix_w = $resp_array[2];\n\t\t\t\t\t$pix_h = $resp_array[5];\n\t\t\t\t\tunset($resp_array);\n\t\t\t\t\t$gs_g = $pix_w.'x'.$pix_h; //used by ghostscript\n\t\t\t\t\t$page_width = $pix_w / $ppi_w;\n\t\t\t\t\t$page_height = $pix_h / $ppi_h;\n\t\t\t\t\tif ($page_width > 8.4 && $page_height > 13) {\n\t\t\t\t\t\t$page_width = 8.5;\n\t\t\t\t\t\t$page_height = 14;\n\t\t\t\t\t\t$page_size = 'legal';\n\t\t\t\t\t}\n\t\t\t\t\telse if ($page_width > 8.4 && $page_height < 12) {\n\t\t\t\t\t\t$page_width = 8.5;\n\t\t\t\t\t\t$page_height = 11;\n\t\t\t\t\t\t$page_size = 'letter';\n\t\t\t\t\t}\n\t\t\t\t\telse if ($page_width < 8.4 && $page_height > 11) {\n\t\t\t\t\t\t$page_width = 8.3;\n\t\t\t\t\t\t$page_height = 11.7;\n\t\t\t\t\t\t$page_size = 'a4';\n\t\t\t\t\t}\n\t\t\t\t//generate pdf (a work around, as tiff2pdf improperly inverts the colors)\n\t\t\t\t\t$cmd_tif2pdf = \"tiff2pdf -i -u i -p \".$page_size.\" -w \".$page_width.\" -l \".$page_height.\" -f -o \".$dir_fax_temp.'/'.$file_name.\".pdf \".$dir_fax.'/'.$file_name.\".tif\";\n\t\t\t\t\t//echo $cmd_tif2pdf.\"<br>\";\n\t\t\t\t\texec($cmd_tif2pdf);\n\t\t\t\t\tchdir($dir_fax_temp);\n\t\t\t\t\t$cmd_pdf2tif = \"gs -q -sDEVICE=tiffg3 -r\".$gs_r.\" -g\".$gs_g.\" -dNOPAUSE -sOutputFile=\".$file_name.\"_temp.tif -- \".$file_name.\".pdf -c quit\";\n\t\t\t\t\t//echo $cmd_pdf2tif.\"<br>\";\n\t\t\t\t\texec($cmd_pdf2tif); //convert pdf to tif\n\t\t\t\t\t@unlink($dir_fax_temp.'/'.$file_name.\".pdf\");\n\t\t\t\t\t$cmd_tif2pdf = \"tiff2pdf -i -u i -p \".$page_size.\" -w \".$page_width.\" -l \".$page_height.\" -f -o \".$dir_fax.'/'.$file_name.\".pdf \".$dir_fax_temp.'/'.$file_name.\"_temp.tif\";\n\t\t\t\t\t//echo $cmd_tif2pdf.\"<br>\";\n\t\t\t\t\texec($cmd_tif2pdf);\n\t\t\t\t\t@unlink($dir_fax_temp.'/'.$file_name.\"_temp.tif\");\n\t\t\t}\n\t\t\techo \"</td></tr>\";\n\t\t\techo \"<tr \".$tr_link.\">\\n\";\n\t\t\techo \"\t<td valign='top' class='\".$row_style[$c].\"'>\".escape($row['fax_caller_id_name']).\"&nbsp;</td>\\n\";\n\t\t\techo \"\t<td valign='top' class='\".$row_style[$c].\"'>\".escape(format_phone($row['fax_caller_id_number'])).\"&nbsp;</td>\\n\";\n\t\t\tif ($_REQUEST['box'] == 'sent') {\n\t\t\t\techo \"\t<td valign='top' class='\".$row_style[$c].\"'>\".escape(format_phone($row['fax_destination'])).\"&nbsp;</td>\\n\";\n\t\t\t}\n\t\t\techo \"  <td class='\".$row_style[$c].\"' ondblclick=\\\"\\\">\\n\";\n\t\t\tif ($_REQUEST['box'] == 'inbox' && permission_exists('fax_inbox_view')) {\n\t\t\t\techo \"\t  <a href=\\\"fax_files.php?id=\".urlencode($fax_uuid).\"&a=download&type=fax_inbox&t=bin&ext=\".urlencode($fax_extension).\"&filename=\".urlencode($file).\"\\\">\\n\";\n\t\t\t}\n\t\t\tif ($_REQUEST['box'] == 'sent' && permission_exists('fax_sent_view')) {\n\t\t\t\techo \"\t  <a href=\\\"fax_files.php?id=\".urlencode($fax_uuid).\"&a=download&type=fax_sent&t=bin&ext=\".urlencode($fax_extension).\"&filename=\".urlencode($file).\"\\\">\\n\";\n\t\t\t}\n\t\t\techo \"    \t$file_name\";\n\t\t\techo \"\t  </a>\";\n\t\t\techo \"  </td>\\n\";\n\t\t\techo \"  <td class='\".$row_style[$c].\"' ondblclick=''>\\n\";\n\t\t\tif ($_REQUEST['box'] == 'inbox') {\n\t\t\t\t$dir_fax = $dir_fax_inbox;\n\t\t\t}\n\t\t\tif ($_REQUEST['box'] == 'sent') {\n\t\t\t\t$dir_fax = $dir_fax_sent;\n\t\t\t}\n\t\t\tif (file_exists($dir_fax.'/'.$file_name.\".pdf\")) {\n\t\t\t\tif ($_REQUEST['box'] == 'inbox' && permission_exists('fax_inbox_view')) {\n\t\t\t\t\techo \"\t  <a href=\\\"fax_files.php?id=\".urlencode($fax_uuid).\"&a=download&type=fax_inbox&t=bin&ext=\".urlencode($fax_extension).\"&filename=\".urlencode($file_name).\".pdf\\\">PDF</a>\\n\";\n\t\t\t\t}\n\t\t\t\tif ($_REQUEST['box'] == 'sent' && permission_exists('fax_sent_view')) {\n\t\t\t\t\techo \"\t  <a href=\\\"fax_files.php?id=\".urlencode($fax_uuid).\"&a=download&type=fax_sent&t=bin&ext=\".urlencode($fax_extension).\"&filename=\".urlencode($file_name).\".pdf\\\">PDF</a>\\n\";\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\techo \"&nbsp;\\n\";\n\t\t\t}\n\t\t\t$fax_date = ($_SESSION['domain']['time_format']['text'] == '12h') ? date(\"F d Y H:i\", $row['fax_epoch']) : date(\"F d Y H:i\", $row['fax_epoch']);\n\t\t\t\n\t\t\techo \"  </td>\\n\";\n\t\t\techo \"\t<td valign='top' class='\".$row_style[$c].\"'>\".$fax_date.\"&nbsp;</td>\\n\";\n\t\t\techo \"\t<td style='width: 25px;' class='list_control_icons'>\";\n\t\t\tif (permission_exists('fax_file_delete')) {\n\t\t\t\techo \"<a href='fax_file_delete.php?id=\".urlencode($row['fax_file_uuid']).\"' alt='\".$text['button-delete'].\"' onclick=\\\"return confirm('\".$text['confirm-delete'].\"')\\\">$v_link_label_delete</a>\";\n\t\t\t}\n\t\t\techo \"\t</td>\\n\";\n\t\t\techo \"</tr>\\n\";\n\t\t\t$c = ($c) ? 0 : 1;\n\t\t}\n\t}\n\tunset($fax_files, $row);\n\n//show the paging controls\n\techo \"</table>\";\n\techo \"<br /><br />\";\n\n\techo \"<div align='center'>\".$paging_controls.\"</div>\\n\";\n\techo \"<br /><br />\";\n\n//include the footer\n\trequire_once \"resources/footer.php\";\n\n?>\n"], "filenames": ["app/fax/fax_files.php"], "buggy_code_start_loc": [186], "buggy_code_end_loc": [360], "fixing_code_start_loc": [186], "fixing_code_end_loc": [360], "type": "CWE-79", "message": "A cross-site scripting (XSS) vulnerability in app/fax/fax_files.php in FusionPBX 4.4.1 allows remote attackers to inject arbitrary web script or HTML via the id parameter.", "other": {"cve": {"id": "CVE-2019-19367", "sourceIdentifier": "cve@mitre.org", "published": "2019-11-27T20:15:11.613", "lastModified": "2019-12-04T15:25:04.970", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A cross-site scripting (XSS) vulnerability in app/fax/fax_files.php in FusionPBX 4.4.1 allows remote attackers to inject arbitrary web script or HTML via the id parameter."}, {"lang": "es", "value": "Una vulnerabilidad de tipo cross-site scripting (XSS) en el archivo app/fax/fax_files.php en FusionPBX versi\u00f3n 4.4.1, permite a atacantes remotos inyectar script web o HTML arbitrario por medio del par\u00e1metro id."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:fusionpbx:fusionpbx:4.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "954E2072-AC03-4E55-8A7F-640534279042"}]}]}], "references": [{"url": "https://gist.github.com/xax007/94183b11bdfe579fd860a37e74cd3a8e", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/fusionpbx/fusionpbx/commit/72a5ce4d2d6bc0ec0e72bbfb76487e4761f292c5", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/fusionpbx/fusionpbx/commit/72a5ce4d2d6bc0ec0e72bbfb76487e4761f292c5"}}