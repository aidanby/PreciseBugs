{"buggy_code": ["<div\n    id=\"<?= $this->getId() ?>\"\n    class=\"\n        field-colorpicker\n        <?php if ($readOnly || $disabled || $this->previewMode): ?>\n            disabled\n        <?php endif; ?>\n    \"\n    data-control=\"colorpicker\"\n    data-formats=\"<?= e(json_encode($formats)) ?>\"\n    data-available-colors=\"<?= e(json_encode($availableColors)) ?>\"\n    data-data-locker=\"#<?= $this->getId('input') ?>\"\n    <?php if ($showAlpha): ?>\n        data-show-alpha=\"<?= $showAlpha ?>\"\n    <?php endif ?>\n    <?php if ($allowEmpty): ?>\n        data-allow-empty=\"<?= $allowEmpty ?>\"\n    <?php endif ?>\n    <?php if ($allowCustom): ?>\n        data-allow-custom=\"<?= $allowCustom ?>\"\n    <?php endif ?>\n    <?php if ($readOnly || $disabled || $this->previewMode): ?>\n        data-disabled=\"true\"\n    <?php endif; ?>\n    <?= $this->formField->getAttributes() ?>\n>\n\n    <div class=\"colorpicker-container\">\n        <?php if ($readOnly || !$allowCustom || $this->previewMode): ?>\n            <span\n                data-color-value\n                class=\"form-control\"\n            >\n                <?= $value ?>\n            </span>\n        <?php else: ?>\n            <input\n                data-color-value\n                class=\"form-control\"\n                placeholder=\"No color\"\n                value=\"<?= $value ?>\"\n                <?php if ($disabled): ?>\n                    disabled\n                <?php endif ?>\n            >\n        <?php endif ?>\n        <div\n            data-color-preview\n        ></div>\n    </div>\n\n    <input\n        type=\"hidden\"\n        id=\"<?= $this->getId('input') ?>\"\n        name=\"<?= $name ?>\"\n        value=\"<?= e($value) ?>\" />\n</div>\n"], "fixing_code": ["<div\n    id=\"<?= $this->getId() ?>\"\n    class=\"\n        field-colorpicker\n        <?php if ($readOnly || $disabled || $this->previewMode): ?>\n            disabled\n        <?php endif; ?>\n    \"\n    data-control=\"colorpicker\"\n    data-formats=\"<?= e(json_encode($formats)) ?>\"\n    data-available-colors=\"<?= e(json_encode($availableColors)) ?>\"\n    data-data-locker=\"#<?= $this->getId('input') ?>\"\n    <?php if ($showAlpha): ?>\n        data-show-alpha=\"<?= $showAlpha ?>\"\n    <?php endif ?>\n    <?php if ($allowEmpty): ?>\n        data-allow-empty=\"<?= $allowEmpty ?>\"\n    <?php endif ?>\n    <?php if ($allowCustom): ?>\n        data-allow-custom=\"<?= $allowCustom ?>\"\n    <?php endif ?>\n    <?php if ($readOnly || $disabled || $this->previewMode): ?>\n        data-disabled=\"true\"\n    <?php endif; ?>\n    <?= $this->formField->getAttributes() ?>\n>\n\n    <div class=\"colorpicker-container\">\n        <?php if ($readOnly || !$allowCustom || $this->previewMode): ?>\n            <span\n                data-color-value\n                class=\"form-control\"\n            >\n                <?= e($value); ?>\n            </span>\n        <?php else: ?>\n            <input\n                data-color-value\n                class=\"form-control\"\n                placeholder=\"No color\"\n                value=\"<?= e($value); ?>\"\n                <?php if ($disabled): ?>\n                    disabled\n                <?php endif ?>\n            >\n        <?php endif ?>\n        <div\n            data-color-preview\n        ></div>\n    </div>\n\n    <input\n        type=\"hidden\"\n        id=\"<?= $this->getId('input') ?>\"\n        name=\"<?= $name ?>\"\n        value=\"<?= e($value) ?>\" />\n</div>\n"], "filenames": ["modules/backend/formwidgets/colorpicker/partials/_colorpicker.php"], "buggy_code_start_loc": [34], "buggy_code_end_loc": [42], "fixing_code_start_loc": [34], "fixing_code_end_loc": [42], "type": "CWE-79", "message": "Winter is a free, open-source content management system. Prior to 1.2.4, Users with access to backend forms that include a ColorPicker FormWidget can provide a value that would then be rendered unescaped in the backend form, potentially allowing for a stored XSS attack. This issue has been patched in v1.2.4.", "other": {"cve": {"id": "CVE-2023-52084", "sourceIdentifier": "security-advisories@github.com", "published": "2023-12-28T23:15:43.777", "lastModified": "2024-01-05T00:08:19.287", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Winter is a free, open-source content management system. Prior to 1.2.4, Users with access to backend forms that include a ColorPicker FormWidget can provide a value that would then be rendered unescaped in the backend form, potentially allowing for a stored XSS attack. This issue has been patched in v1.2.4."}, {"lang": "es", "value": "Winter es un sistema de gesti\u00f3n de contenidos gratuito y de c\u00f3digo abierto. Antes de 1.2.4, los usuarios con acceso a formularios de backend que incluyen un FormWidget ColorPicker pueden proporcionar un valor que luego se mostrar\u00eda sin formato de escape en el formulario de backend, lo que podr\u00eda permitir un ataque XSS almacenado. Este problema se solucion\u00f3 en la versi\u00f3n 1.2.4."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 2.0, "baseSeverity": "LOW"}, "exploitabilityScore": 0.5, "impactScore": 1.4}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:wintercms:winter:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.2.4", "matchCriteriaId": "1EE69DF4-BDE7-4A22-9947-BBD648026BA4"}]}]}], "references": [{"url": "https://github.com/wintercms/winter/commit/517f65dfae679b57575b047de13c5af48915a5ba", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/wintercms/winter/security/advisories/GHSA-43w4-4j3c-jx29", "source": "security-advisories@github.com", "tags": ["Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/wintercms/winter/commit/517f65dfae679b57575b047de13c5af48915a5ba"}}