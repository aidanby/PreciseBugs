{"buggy_code": ["<?php\n    require_once '../inc/config.inc.php';\n\n    $title       = \"Statistiques de recherche\";\n    $description = \"Mapicoin, statistiques de recherche - D\u00e9couvrez les recherches effectu\u00e9es sur Mapicoin !\";\n    $searches    = stats_get_searches();\n?>\n<!DOCTYPE html>\n<html lang=\"fr\">\n    <head>\n        <title><?= $title ?> - Mapicoin</title>\n        <meta name=\"description\" content=\"<?= $description ?>\" />\n\n        <!-- Open Graph -->\n        <meta property=\"og:title\" content=\"<?= $title ?? 'Mapicoin' ?>\" />\n        <meta property=\"og:description\" content=\"<?= $description ?>\" />\n        <meta property=\"og:type\" content=\"website\" />\n        <meta property=\"og:url\" content=\"https://<?= $_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'] ?>\" />\n        <meta property=\"og:image\" content=\"https://<?= $_SERVER['HTTP_HOST']?>/img/mapicoin-meta-og.png\" />\n\n        <?php include 'inc/header.inc.php'; ?>\n\n        <link href=\"/css/mapicoin-page.css?<?= VERSION ?>\" rel=\"stylesheet\" />\n\n    </head>\n\n    <body class=\"page\">\n\n        <?php include 'inc/cookies-cnil-banner.inc.php' ?>\n\n        <div class=\"page-container\">\n\n            <div class=\"text-center\">\n                <a href=\"/\">\n                    <img id=\"logo\" src=\"/img/mapicoin-logo.png\" width=\"409\" height=\"112\" />\n                </a>\n            </div>\n\n            <div class=\"page-body\">\n\n                <div class=\"page-breadcrumb\">\n                    <a href=\"/\">Accueil</a> &raquo; Mapicoin : Statistiques de recherche\n                </div>\n\n                <h1><span>Mapicoin : <?= $title ?></span></h1>\n\n<div class=\"page-content\">\n    <table>\n        <thead>\n            <tr>\n                <th>Recherche</th>\n                <th>Compteur</th>\n                <th>Derni\u00e8re recherche</th>\n            </tr>\n        </thead>\n        <tbody>\n        <?php foreach ($searches as $search):?>\n            <?php $link = str_replace(['?','&'], ['%3F','%26'], $search['search']); ?>\n            <tr>\n                <td>\n                    <a href=\"https://mapicoin.fr/?u=<?= $link ?>\"><?= $search['search'] ?></a>\n                </td>\n                <td><?= $search['count'] ?></td>\n                <td><?= time_elapsed_string(strtotime($search['updated'])) ?></td>\n            </tr>\n        <?php endforeach; ?>\n        </tbody>\n    </table>\n</div><!-- /.page-content -->\n\n            </div><!-- /.page-body -->\n\n        <?php include 'inc/page-footer.inc.php' ?>\n\n        </div><!-- /.page-container -->\n\n        <?php include 'inc/ga.inc.php' ?>\n\n    </body>\n</html>\n"], "fixing_code": ["<?php\n    require_once '../inc/config.inc.php';\n\n    $title       = \"Statistiques de recherche\";\n    $description = \"Mapicoin, statistiques de recherche - D\u00e9couvrez les recherches effectu\u00e9es sur Mapicoin !\";\n    $searches    = stats_get_searches();\n?>\n<!DOCTYPE html>\n<html lang=\"fr\">\n    <head>\n        <title><?= $title ?> - Mapicoin</title>\n        <meta name=\"description\" content=\"<?= $description ?>\" />\n\n        <!-- Open Graph -->\n        <meta property=\"og:title\" content=\"<?= $title ?? 'Mapicoin' ?>\" />\n        <meta property=\"og:description\" content=\"<?= $description ?>\" />\n        <meta property=\"og:type\" content=\"website\" />\n        <meta property=\"og:url\" content=\"https://<?= $_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'] ?>\" />\n        <meta property=\"og:image\" content=\"https://<?= $_SERVER['HTTP_HOST']?>/img/mapicoin-meta-og.png\" />\n\n        <?php include 'inc/header.inc.php'; ?>\n\n        <link href=\"/css/mapicoin-page.css?<?= VERSION ?>\" rel=\"stylesheet\" />\n\n    </head>\n\n    <body class=\"page\">\n\n        <?php include 'inc/cookies-cnil-banner.inc.php' ?>\n\n        <div class=\"page-container\">\n\n            <div class=\"text-center\">\n                <a href=\"/\">\n                    <img id=\"logo\" src=\"/img/mapicoin-logo.png\" width=\"409\" height=\"112\" />\n                </a>\n            </div>\n\n            <div class=\"page-body\">\n\n                <div class=\"page-breadcrumb\">\n                    <a href=\"/\">Accueil</a> &raquo; Mapicoin : Statistiques de recherche\n                </div>\n\n                <h1><span>Mapicoin : <?= $title ?></span></h1>\n\n<div class=\"page-content\">\n    <table>\n        <thead>\n            <tr>\n                <th>Recherche</th>\n                <th>Compteur</th>\n                <th>Derni\u00e8re recherche</th>\n            </tr>\n        </thead>\n        <tbody>\n        <?php foreach ($searches as $search):?>\n            <?php $link = str_replace(['?','&'], ['%3F','%26'], $search['search']); ?>\n            <tr>\n                <td>\n                    <a href=\"https://mapicoin.fr/?u=<?= htmlentities($link, ENT_QUOTES, \"UTF-8\"); ?>\"><?= htmlentities($search['search'], ENT_QUOTES, \"UTF-8\") ?></a>\n                </td>\n                <td><?= $search['count'] ?></td>\n                <td><?= time_elapsed_string(strtotime($search['updated'])) ?></td>\n            </tr>\n        <?php endforeach; ?>\n        </tbody>\n    </table>\n</div><!-- /.page-content -->\n\n            </div><!-- /.page-body -->\n\n        <?php include 'inc/page-footer.inc.php' ?>\n\n        </div><!-- /.page-container -->\n\n        <?php include 'inc/ga.inc.php' ?>\n\n    </body>\n</html>\n"], "filenames": ["webroot/stats.php"], "buggy_code_start_loc": [61], "buggy_code_end_loc": [62], "fixing_code_start_loc": [61], "fixing_code_end_loc": [62], "type": "CWE-79", "message": "A vulnerability has been found in Ydalb mapicoin up to 1.9.0 and classified as problematic. This vulnerability affects unknown code of the file webroot/stats.php. The manipulation of the argument link/search leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 1.10.0 is able to address this issue. The name of the patch is 67e87f0f0c1ac238fcd050f4c3db298229bc9679. It is recommended to upgrade the affected component. VDB-223402 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2016-15029", "sourceIdentifier": "cna@vuldb.com", "published": "2023-03-21T11:15:10.103", "lastModified": "2023-03-24T17:09:46.683", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability has been found in Ydalb mapicoin up to 1.9.0 and classified as problematic. This vulnerability affects unknown code of the file webroot/stats.php. The manipulation of the argument link/search leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 1.10.0 is able to address this issue. The name of the patch is 67e87f0f0c1ac238fcd050f4c3db298229bc9679. It is recommended to upgrade the affected component. VDB-223402 is the identifier assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mapicoin_project:mapicoin:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.10.0", "matchCriteriaId": "72505E33-B55D-4F4A-837B-D9B655D73ADE"}]}]}], "references": [{"url": "https://github.com/Ydalb/mapicoin/commit/67e87f0f0c1ac238fcd050f4c3db298229bc9679", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.223402", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.223402", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/Ydalb/mapicoin/commit/67e87f0f0c1ac238fcd050f4c3db298229bc9679"}}