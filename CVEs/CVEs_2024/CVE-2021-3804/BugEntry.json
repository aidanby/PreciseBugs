{"buggy_code": ["import * as os from 'os'\nimport * as chalk from 'chalk'\n\n// eslint-disable-next-line dot-notation\nexport const PLATFORMS = global['PLATFORMS'] = global['PLATFORMS'] || {}\n\nexport const enum processTypeEnum {\n  START = 'start',\n  CREATE = 'create',\n  COMPILE = 'compile',\n  CONVERT = 'convert',\n  COPY = 'copy',\n  GENERATE = 'generate',\n  MODIFY = 'modify',\n  ERROR = 'error',\n  WARNING = 'warning',\n  UNLINK = 'unlink',\n  REFERENCE = 'reference',\n  REMIND = 'remind'\n}\n\nexport interface IProcessTypeMap {\n  [key: string]: {\n    name: string,\n    color: string | chalk.Chalk\n  }\n}\n\nexport const processTypeMap: IProcessTypeMap = {\n  [processTypeEnum.CREATE]: {\n    name: '\u521b\u5efa',\n    color: 'cyan'\n  },\n  [processTypeEnum.COMPILE]: {\n    name: '\u7f16\u8bd1',\n    color: 'green'\n  },\n  [processTypeEnum.CONVERT]: {\n    name: '\u8f6c\u6362',\n    color: chalk.rgb(255, 136, 0)\n  },\n  [processTypeEnum.COPY]: {\n    name: '\u62f7\u8d1d',\n    color: 'magenta'\n  },\n  [processTypeEnum.GENERATE]: {\n    name: '\u751f\u6210',\n    color: 'blue'\n  },\n  [processTypeEnum.MODIFY]: {\n    name: '\u4fee\u6539',\n    color: 'yellow'\n  },\n  [processTypeEnum.ERROR]: {\n    name: '\u9519\u8bef',\n    color: 'red'\n  },\n  [processTypeEnum.WARNING]: {\n    name: '\u8b66\u544a',\n    color: 'yellowBright'\n  },\n  [processTypeEnum.UNLINK]: {\n    name: '\u5220\u9664',\n    color: 'magenta'\n  },\n  [processTypeEnum.START]: {\n    name: '\u542f\u52a8',\n    color: 'green'\n  },\n  [processTypeEnum.REFERENCE]: {\n    name: '\u5f15\u7528',\n    color: 'blue'\n  },\n  [processTypeEnum.REMIND]: {\n    name: '\u63d0\u793a',\n    color: 'green'\n  }\n}\n\nexport const CSS_EXT: string[] = ['.css', '.scss', '.sass', '.less', '.styl', '.stylus', '.wxss', '.acss']\nexport const SCSS_EXT: string[] = ['.scss']\nexport const JS_EXT: string[] = ['.js', '.jsx']\nexport const TS_EXT: string[] = ['.ts', '.tsx']\nexport const UX_EXT: string[] = ['.ux']\nexport const SCRIPT_EXT: string[] = JS_EXT.concat(TS_EXT)\nexport const VUE_EXT: string[] = ['.vue']\n\nexport const REG_JS = /\\.js(\\?.*)?$/\nexport const REG_SCRIPT = /\\.(js|jsx)(\\?.*)?$/\nexport const REG_TYPESCRIPT = /\\.(tsx|ts)(\\?.*)?$/\nexport const REG_SCRIPTS = /\\.[tj]sx?$/i\nexport const REG_VUE = /\\.vue$/i\nexport const REG_SASS = /\\.(s[ac]ss)$/\nexport const REG_SASS_SASS = /\\.sass$/\nexport const REG_SASS_SCSS = /\\.scss$/\nexport const REG_LESS = /\\.less$/\nexport const REG_STYLUS = /\\.styl(us)?$/\nexport const REG_STYLE = /\\.(css|scss|sass|less|styl|stylus|wxss|acss|ttss|jxss|qss)(\\?.*)?$/\nexport const REG_CSS = /\\.(css|wxss|acss|ttss)(\\?.*)?$/\nexport const REG_MEDIA = /\\.(mp4|webm|ogg|mp3|m4a|wav|flac|aac)(\\?.*)?$/\nexport const REG_IMAGE = /\\.(png|jpe?g|gif|bpm|svg|webp)(\\?.*)?$/\nexport const REG_FONT = /\\.(woff2?|eot|ttf|otf)(\\?.*)?$/\nexport const REG_JSON = /\\.json(\\?.*)?$/\nexport const REG_UX = /\\.ux(\\?.*)?$/\nexport const REG_TEMPLATE = /\\.(wxml|axml|ttml|qml|swan|jxml)(\\?.*)?$/\nexport const REG_WXML_IMPORT = /<import(.*)?src=(?:(?:'([^']*)')|(?:\"([^\"]*)\"))/gi\nexport const REG_URL = /^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))\\.?)(?::\\d{2,5})?(?:[/?#]\\S*)?$/i\nexport const CSS_IMPORT_REG = /@import ([\"'])(.+?)\\1;/g\n\nexport const NODE_MODULES = 'node_modules'\nexport const NODE_MODULES_REG = /(.*)node_modules/\n\nexport const PROJECT_CONFIG = 'config/index'\n\nexport const DEVICE_RATIO = {\n  640: 2.34 / 2,\n  750: 1,\n  828: 1.81 / 2\n}\n\nexport const FILE_PROCESSOR_MAP = {\n  '.js': 'babel',\n  '.scss': 'sass',\n  '.sass': 'sass',\n  '.less': 'less',\n  '.styl': 'stylus'\n}\n\nexport const UPDATE_PACKAGE_LIST = [\n  'babel-plugin-transform-taroapi',\n  'babel-preset-taro',\n  'eslint-config-taro',\n  'eslint-plugin-taro',\n  'postcss-plugin-constparse',\n  'postcss-pxtransform',\n  '@tarojs/shared',\n  '@tarojs/taro',\n  '@tarojs/cli',\n  '@tarojs/components',\n  '@tarojs/taro-h5',\n  '@tarojs/helper',\n  '@tarojs/taro-loader',\n  '@tarojs/mini-runner',\n  '@tarojs/react',\n  '@tarojs/router',\n  '@tarojs/runner-utils',\n  '@tarojs/runtime',\n  '@tarojs/service',\n  '@tarojs/webpack-runner',\n  '@tarojs/with-weapp',\n  '@tarojs/taroize',\n  '@tarojs/plugin-platform-weapp',\n  '@tarojs/plugin-platform-alipay',\n  '@tarojs/plugin-platform-swan',\n  '@tarojs/plugin-platform-tt',\n  '@tarojs/plugin-platform-qq',\n  '@tarojs/plugin-platform-jd',\n  'nervjs',\n  'nerv-devtools'\n]\n\nexport enum META_TYPE {\n  ENTRY = 'ENTRY',\n  PAGE = 'PAGE',\n  COMPONENT = 'COMPONENT',\n  NORMAL = 'NORMAL',\n  STATIC = 'STATIC',\n  CONFIG = 'CONFIG',\n  EXPORTS = 'EXPORTS'\n}\n\nexport const taroJsComponents = '@tarojs/components'\nexport const taroJsQuickAppComponents = '@tarojs/components-qa'\nexport const taroJsFramework = '@tarojs/taro'\nexport const taroJsRedux = '@tarojs/redux'\nexport const taroJsMobx = '@tarojs/mobx'\nexport const taroJsMobxCommon = '@tarojs/mobx-common'\n\nexport const DEVICE_RATIO_NAME = 'deviceRatio'\nexport const isWindows = os.platform() === 'win32'\n\nexport const DEFAULT_TEMPLATE_SRC = 'github:NervJS/taro-project-templates#v3.1'\nexport const DEFAULT_TEMPLATE_SRC_GITEE = 'direct:https://gitee.com/o2team/taro-project-templates.git#v3.1'\nexport const TARO_CONFIG_FLODER = '.taro3.1'\nexport const TARO_BASE_CONFIG = 'index.json'\n\nexport const OUTPUT_DIR = 'dist'\nexport const SOURCE_DIR = 'src'\nexport const TEMP_DIR = '.temp'\nexport const NPM_DIR = 'npm'\nexport const ENTRY = 'app'\n\nexport enum FRAMEWORK_MAP {\n  VUE = 'vue',\n  VUE3 = 'vue3',\n  REACT = 'react',\n  NERV = 'nerv'\n}\n\nexport const FRAMEWORK_EXT_MAP = {\n  vue: VUE_EXT,\n  vue3: VUE_EXT,\n  react: SCRIPT_EXT,\n  nerv: SCRIPT_EXT\n}\n"], "fixing_code": ["import * as os from 'os'\nimport * as chalk from 'chalk'\n\n// eslint-disable-next-line dot-notation\nexport const PLATFORMS = global['PLATFORMS'] = global['PLATFORMS'] || {}\n\nexport const enum processTypeEnum {\n  START = 'start',\n  CREATE = 'create',\n  COMPILE = 'compile',\n  CONVERT = 'convert',\n  COPY = 'copy',\n  GENERATE = 'generate',\n  MODIFY = 'modify',\n  ERROR = 'error',\n  WARNING = 'warning',\n  UNLINK = 'unlink',\n  REFERENCE = 'reference',\n  REMIND = 'remind'\n}\n\nexport interface IProcessTypeMap {\n  [key: string]: {\n    name: string,\n    color: string | chalk.Chalk\n  }\n}\n\nexport const processTypeMap: IProcessTypeMap = {\n  [processTypeEnum.CREATE]: {\n    name: '\u521b\u5efa',\n    color: 'cyan'\n  },\n  [processTypeEnum.COMPILE]: {\n    name: '\u7f16\u8bd1',\n    color: 'green'\n  },\n  [processTypeEnum.CONVERT]: {\n    name: '\u8f6c\u6362',\n    color: chalk.rgb(255, 136, 0)\n  },\n  [processTypeEnum.COPY]: {\n    name: '\u62f7\u8d1d',\n    color: 'magenta'\n  },\n  [processTypeEnum.GENERATE]: {\n    name: '\u751f\u6210',\n    color: 'blue'\n  },\n  [processTypeEnum.MODIFY]: {\n    name: '\u4fee\u6539',\n    color: 'yellow'\n  },\n  [processTypeEnum.ERROR]: {\n    name: '\u9519\u8bef',\n    color: 'red'\n  },\n  [processTypeEnum.WARNING]: {\n    name: '\u8b66\u544a',\n    color: 'yellowBright'\n  },\n  [processTypeEnum.UNLINK]: {\n    name: '\u5220\u9664',\n    color: 'magenta'\n  },\n  [processTypeEnum.START]: {\n    name: '\u542f\u52a8',\n    color: 'green'\n  },\n  [processTypeEnum.REFERENCE]: {\n    name: '\u5f15\u7528',\n    color: 'blue'\n  },\n  [processTypeEnum.REMIND]: {\n    name: '\u63d0\u793a',\n    color: 'green'\n  }\n}\n\nexport const CSS_EXT: string[] = ['.css', '.scss', '.sass', '.less', '.styl', '.stylus', '.wxss', '.acss']\nexport const SCSS_EXT: string[] = ['.scss']\nexport const JS_EXT: string[] = ['.js', '.jsx']\nexport const TS_EXT: string[] = ['.ts', '.tsx']\nexport const UX_EXT: string[] = ['.ux']\nexport const SCRIPT_EXT: string[] = JS_EXT.concat(TS_EXT)\nexport const VUE_EXT: string[] = ['.vue']\n\nexport const REG_JS = /\\.js(\\?.*)?$/\nexport const REG_SCRIPT = /\\.(js|jsx)(\\?.*)?$/\nexport const REG_TYPESCRIPT = /\\.(tsx|ts)(\\?.*)?$/\nexport const REG_SCRIPTS = /\\.[tj]sx?$/i\nexport const REG_VUE = /\\.vue$/i\nexport const REG_SASS = /\\.(s[ac]ss)$/\nexport const REG_SASS_SASS = /\\.sass$/\nexport const REG_SASS_SCSS = /\\.scss$/\nexport const REG_LESS = /\\.less$/\nexport const REG_STYLUS = /\\.styl(us)?$/\nexport const REG_STYLE = /\\.(css|scss|sass|less|styl|stylus|wxss|acss|ttss|jxss|qss)(\\?.*)?$/\nexport const REG_CSS = /\\.(css|wxss|acss|ttss)(\\?.*)?$/\nexport const REG_MEDIA = /\\.(mp4|webm|ogg|mp3|m4a|wav|flac|aac)(\\?.*)?$/\nexport const REG_IMAGE = /\\.(png|jpe?g|gif|bpm|svg|webp)(\\?.*)?$/\nexport const REG_FONT = /\\.(woff2?|eot|ttf|otf)(\\?.*)?$/\nexport const REG_JSON = /\\.json(\\?.*)?$/\nexport const REG_UX = /\\.ux(\\?.*)?$/\nexport const REG_TEMPLATE = /\\.(wxml|axml|ttml|qml|swan|jxml)(\\?.*)?$/\nexport const REG_WXML_IMPORT = /<import(.*)?src=(?:(?:'([^']*)')|(?:\"([^\"]*)\"))/gi\nexport const REG_URL = /^(?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z0-9\\u00a1-\\uffff][a-z0-9\\u00a1-\\uffff_-]{0,62})?[a-z0-9\\u00a1-\\uffff]\\.)+(?:[a-z\\u00a1-\\uffff]{2,}\\.?))(?::\\d{2,5})?(?:[/?#]\\S*)?$/i\nexport const CSS_IMPORT_REG = /@import ([\"'])(.+?)\\1;/g\n\nexport const NODE_MODULES = 'node_modules'\nexport const NODE_MODULES_REG = /(.*)node_modules/\n\nexport const PROJECT_CONFIG = 'config/index'\n\nexport const DEVICE_RATIO = {\n  640: 2.34 / 2,\n  750: 1,\n  828: 1.81 / 2\n}\n\nexport const FILE_PROCESSOR_MAP = {\n  '.js': 'babel',\n  '.scss': 'sass',\n  '.sass': 'sass',\n  '.less': 'less',\n  '.styl': 'stylus'\n}\n\nexport const UPDATE_PACKAGE_LIST = [\n  'babel-plugin-transform-taroapi',\n  'babel-preset-taro',\n  'eslint-config-taro',\n  'eslint-plugin-taro',\n  'postcss-plugin-constparse',\n  'postcss-pxtransform',\n  '@tarojs/shared',\n  '@tarojs/taro',\n  '@tarojs/cli',\n  '@tarojs/components',\n  '@tarojs/taro-h5',\n  '@tarojs/helper',\n  '@tarojs/taro-loader',\n  '@tarojs/mini-runner',\n  '@tarojs/react',\n  '@tarojs/router',\n  '@tarojs/runner-utils',\n  '@tarojs/runtime',\n  '@tarojs/service',\n  '@tarojs/webpack-runner',\n  '@tarojs/with-weapp',\n  '@tarojs/taroize',\n  '@tarojs/plugin-platform-weapp',\n  '@tarojs/plugin-platform-alipay',\n  '@tarojs/plugin-platform-swan',\n  '@tarojs/plugin-platform-tt',\n  '@tarojs/plugin-platform-qq',\n  '@tarojs/plugin-platform-jd',\n  'nervjs',\n  'nerv-devtools'\n]\n\nexport enum META_TYPE {\n  ENTRY = 'ENTRY',\n  PAGE = 'PAGE',\n  COMPONENT = 'COMPONENT',\n  NORMAL = 'NORMAL',\n  STATIC = 'STATIC',\n  CONFIG = 'CONFIG',\n  EXPORTS = 'EXPORTS'\n}\n\nexport const taroJsComponents = '@tarojs/components'\nexport const taroJsQuickAppComponents = '@tarojs/components-qa'\nexport const taroJsFramework = '@tarojs/taro'\nexport const taroJsRedux = '@tarojs/redux'\nexport const taroJsMobx = '@tarojs/mobx'\nexport const taroJsMobxCommon = '@tarojs/mobx-common'\n\nexport const DEVICE_RATIO_NAME = 'deviceRatio'\nexport const isWindows = os.platform() === 'win32'\n\nexport const DEFAULT_TEMPLATE_SRC = 'github:NervJS/taro-project-templates#v3.1'\nexport const DEFAULT_TEMPLATE_SRC_GITEE = 'direct:https://gitee.com/o2team/taro-project-templates.git#v3.1'\nexport const TARO_CONFIG_FLODER = '.taro3.1'\nexport const TARO_BASE_CONFIG = 'index.json'\n\nexport const OUTPUT_DIR = 'dist'\nexport const SOURCE_DIR = 'src'\nexport const TEMP_DIR = '.temp'\nexport const NPM_DIR = 'npm'\nexport const ENTRY = 'app'\n\nexport enum FRAMEWORK_MAP {\n  VUE = 'vue',\n  VUE3 = 'vue3',\n  REACT = 'react',\n  NERV = 'nerv'\n}\n\nexport const FRAMEWORK_EXT_MAP = {\n  vue: VUE_EXT,\n  vue3: VUE_EXT,\n  react: SCRIPT_EXT,\n  nerv: SCRIPT_EXT\n}\n"], "filenames": ["packages/taro-helper/src/constants.ts"], "buggy_code_start_loc": [107], "buggy_code_end_loc": [108], "fixing_code_start_loc": [107], "fixing_code_end_loc": [108], "type": "NVD-CWE-Other", "message": "taro is vulnerable to Inefficient Regular Expression Complexity", "other": {"cve": {"id": "CVE-2021-3804", "sourceIdentifier": "security@huntr.dev", "published": "2021-09-17T07:15:09.213", "lastModified": "2022-07-29T16:56:12.247", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "taro is vulnerable to Inefficient Regular Expression Complexity"}, {"lang": "es", "value": "taro es vulnerable a una Complejidad de Expresiones Regulares Ineficientes"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "COMPLETE", "baseScore": 7.8}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-Other"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-1333"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:taro:taro:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "3.3.9", "matchCriteriaId": "D4555A14-5623-4B00-9669-F524ECE0AD54"}]}]}], "references": [{"url": "https://github.com/nervjs/taro/commit/acadb6c826ba57f2030a626f1de4f7b4608fcdb5", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/0ebe85e6-cc85-42b8-957e-18d8df277414", "source": "security@huntr.dev", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/nervjs/taro/commit/acadb6c826ba57f2030a626f1de4f7b4608fcdb5"}}