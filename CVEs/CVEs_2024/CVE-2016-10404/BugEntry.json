{"buggy_code": ["<%--\n/**\n * Copyright (c) 2000-present Liferay, Inc. All rights reserved.\n *\n * This library is free software; you can redistribute it and/or modify it under\n * the terms of the GNU Lesser General Public License as published by the Free\n * Software Foundation; either version 2.1 of the License, or (at your option)\n * any later version.\n *\n * This library is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\n * FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more\n * details.\n */\n--%>\n\n<%@ taglib uri=\"http://liferay.com/tld/aui\" prefix=\"aui\" %><%@\ntaglib uri=\"http://liferay.com/tld/theme\" prefix=\"liferay-theme\" %>\n\n<%@ page import=\"com.liferay.frontend.js.spa.web.internal.constants.SPAWebKeys\" %><%@\npage import=\"com.liferay.frontend.js.spa.web.internal.servlet.taglib.util.SPAUtil\" %><%@\npage import=\"com.liferay.portal.kernel.language.LanguageUtil\" %>\n\n<liferay-theme:defineObjects />\n\n<%\nSPAUtil spaUtil = (SPAUtil)request.getAttribute(SPAWebKeys.SPA_UTIL);\n%>\n\n<aui:script position=\"inline\" require=\"frontend-js-spa-web/liferay/init.es\">\n\tLiferay.SPA = Liferay.SPA || {};\n\n\tLiferay.SPA.cacheExpirationTime = <%= spaUtil.getCacheExpirationTime(themeDisplay.getCompanyId()) %>;\n\tLiferay.SPA.clearScreensCache = <%= spaUtil.isClearScreensCache(request, session) %>;\n\tLiferay.SPA.excludedPaths = <%= spaUtil.getExcludedPaths() %>;\n\tLiferay.SPA.loginRedirect = '<%= spaUtil.getLoginRedirect(request) %>';\n\tLiferay.SPA.requestTimeout = <%= spaUtil.getRequestTimeout() %>;\n\tLiferay.SPA.userNotification = {\n\t\tmessage: '<%= LanguageUtil.get(spaUtil.getLanguageResourceBundle(themeDisplay.getLocale()), \"it-looks-like-this-is-taking-longer-than-expected\") %>',\n\t\ttimeout: <%= spaUtil.getUserNotificationTimeout() %>,\n\t\ttitle: '<%= LanguageUtil.get(spaUtil.getLanguageResourceBundle(themeDisplay.getLocale()), \"oops\") %>'\n\t};\n\n\tfrontendJsSpaWebLiferayInitEs.default.init(\n\t\tfunction(app) {\n\t\t\tapp.setPortletsBlacklist(<%= spaUtil.getPortletsBlacklist(themeDisplay) %>);\n\t\t\tapp.setValidStatusCodes(<%= spaUtil.getValidStatusCodes() %>);\n\t\t}\n\t);\n</aui:script>"], "fixing_code": ["<%--\n/**\n * Copyright (c) 2000-present Liferay, Inc. All rights reserved.\n *\n * This library is free software; you can redistribute it and/or modify it under\n * the terms of the GNU Lesser General Public License as published by the Free\n * Software Foundation; either version 2.1 of the License, or (at your option)\n * any later version.\n *\n * This library is distributed in the hope that it will be useful, but WITHOUT\n * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS\n * FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License for more\n * details.\n */\n--%>\n\n<%@ taglib uri=\"http://liferay.com/tld/aui\" prefix=\"aui\" %><%@\ntaglib uri=\"http://liferay.com/tld/theme\" prefix=\"liferay-theme\" %>\n\n<%@ page import=\"com.liferay.frontend.js.spa.web.internal.constants.SPAWebKeys\" %><%@\npage import=\"com.liferay.frontend.js.spa.web.internal.servlet.taglib.util.SPAUtil\" %><%@\npage import=\"com.liferay.portal.kernel.language.LanguageUtil\" %><%@\npage import=\"com.liferay.portal.kernel.util.HtmlUtil\" %>\n\n<liferay-theme:defineObjects />\n\n<%\nSPAUtil spaUtil = (SPAUtil)request.getAttribute(SPAWebKeys.SPA_UTIL);\n%>\n\n<aui:script position=\"inline\" require=\"frontend-js-spa-web/liferay/init.es\">\n\tLiferay.SPA = Liferay.SPA || {};\n\n\tLiferay.SPA.cacheExpirationTime = <%= spaUtil.getCacheExpirationTime(themeDisplay.getCompanyId()) %>;\n\tLiferay.SPA.clearScreensCache = <%= spaUtil.isClearScreensCache(request, session) %>;\n\tLiferay.SPA.excludedPaths = <%= spaUtil.getExcludedPaths() %>;\n\tLiferay.SPA.loginRedirect = '<%= HtmlUtil.escapeJS(spaUtil.getLoginRedirect(request)) %>';\n\tLiferay.SPA.requestTimeout = <%= spaUtil.getRequestTimeout() %>;\n\tLiferay.SPA.userNotification = {\n\t\tmessage: '<%= LanguageUtil.get(spaUtil.getLanguageResourceBundle(themeDisplay.getLocale()), \"it-looks-like-this-is-taking-longer-than-expected\") %>',\n\t\ttimeout: <%= spaUtil.getUserNotificationTimeout() %>,\n\t\ttitle: '<%= LanguageUtil.get(spaUtil.getLanguageResourceBundle(themeDisplay.getLocale()), \"oops\") %>'\n\t};\n\n\tfrontendJsSpaWebLiferayInitEs.default.init(\n\t\tfunction(app) {\n\t\t\tapp.setPortletsBlacklist(<%= spaUtil.getPortletsBlacklist(themeDisplay) %>);\n\t\t\tapp.setValidStatusCodes(<%= spaUtil.getValidStatusCodes() %>);\n\t\t}\n\t);\n</aui:script>"], "filenames": ["modules/apps/foundation/frontend-js/frontend-js-spa-web/src/main/resources/META-INF/resources/init.jsp"], "buggy_code_start_loc": [22], "buggy_code_end_loc": [37], "fixing_code_start_loc": [22], "fixing_code_end_loc": [38], "type": "CWE-79", "message": "XSS exists in Liferay Portal before 7.0 CE GA4 via a crafted redirect field to modules/apps/foundation/frontend-js/frontend-js-spa-web/src/main/resources/META-INF/resources/init.jsp.", "other": {"cve": {"id": "CVE-2016-10404", "sourceIdentifier": "cve@mitre.org", "published": "2017-08-07T16:29:00.190", "lastModified": "2017-08-09T17:34:53.650", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "XSS exists in Liferay Portal before 7.0 CE GA4 via a crafted redirect field to modules/apps/foundation/frontend-js/frontend-js-spa-web/src/main/resources/META-INF/resources/init.jsp."}, {"lang": "es", "value": "Existe una vulnerabilidad de tipo Cross-Site Scripting (XSS) en Liferay Portal en versiones anteriores a la 7.0 CE GA4 mediante un campo manipulado de redirecci\u00f3n a modules/apps/foundation/frontend-js/frontend-js-spa-web/src/main/resources/META-INF/resources/init.jsp."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:liferay:liferay_portal:*:ga3:*:*:*:*:*:*", "versionEndIncluding": "7.0", "matchCriteriaId": "2EF349F1-9D4E-41AD-8C60-3E69F4141B75"}]}]}], "references": [{"url": "https://dev.liferay.com/web/community-security-team/known-vulnerabilities/liferay-portal-70/-/asset_publisher/cjE0ourZXJZE/content/cst-7017-multiple-xss-vulnerabilities", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Patch", "Vendor Advisory"]}, {"url": "https://github.com/liferay/liferay-portal/commit/333f65bae9106182d12e02d249d4f95e16e93fa2", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/liferay/liferay-portal/commit/333f65bae9106182d12e02d249d4f95e16e93fa2"}}