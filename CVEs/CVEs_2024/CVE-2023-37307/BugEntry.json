{"buggy_code": ["<?php\n    echo sprintf('<div%s>', empty($ajax) ? ' class=\"index\"' : '');\n    echo $this->element('genericElements/IndexTable/index_table', [\n        'data' => [\n            'light_paginator' => 1,\n            'data' => $data,\n            'top_bar' => [\n                'pull' => 'right',\n                'children' => [\n                    [\n                        'type' => 'search',\n                        'button' => __('Filter'),\n                        'placeholder' => __('Enter value to search'),\n                        'searchKey' => 'quickFilter',\n                    ]\n                ]\n            ],\n            'fields' => [\n                [\n                    'name' => 'Value',\n                    'sort' => 'Correlation.value',\n                    'data_path' => 'Correlation.value',\n                    'class' => 'short'\n                ],\n                [\n                    'name' => 'Correlation count',\n                    'sort' => 'Correlation.count',\n                    'data_path' => 'Correlation.count'\n                ]\n            ],\n            'title' => empty($ajax) ? $title_for_layout : false,\n            'description' => empty($ajax) ? __('The values with the most correlation entries.') : false,\n            'pull' => 'right',\n            'actions' => [\n                [\n                    'onclick' => sprintf(\n                        'openGenericModal(\\'%s/correlation_exclusions/add/redirect:top_correlations/value:[onclick_params_data_path]\\');',\n                        $baseurl\n                    ),\n                    'onclick_params_data_path' => 'Correlation.value',\n                    'icon' => 'trash',\n                    'title' => __('Add exclusion entry for value'),\n                ]\n            ]\n        ]\n    ]);\n    echo '</div>';\n    if (empty($ajax)) {\n        echo $this->element('/genericElements/SideMenu/side_menu', $menuData);\n    }\n?>\n<script type=\"text/javascript\">\n    var passedArgsArray = <?php echo $passedArgs; ?>;\n    $(function() {\n        $('#quickFilterButton').click(function() {\n            runIndexQuickFilter();\n        });\n    });\n</script>\n", "<?php\necho sprintf('<div%s>', empty($ajax) ? ' class=\"index\"' : '');\necho $this->element('genericElements/IndexTable/index_table', [\n    'data' => [\n        'light_paginator' => 1,\n        'data' => $data,\n        'top_bar' => [\n            'children' => [\n                [\n                    'children' => [\n                        [\n                            'type' => 'simple',\n                            'url' => $baseurl . '/correlations/overCorrelations',\n                            'text' => __('All'),\n                            'active' => $scope === 'all',\n                        ],\n                        [\n                            'type' => 'simple',\n                            'url' => $baseurl . '/correlations/overCorrelations/scope:over_correlating',\n                            'text' => __('Over-correlating'),\n                            'active' => $scope === 'over_correlating',\n                        ],\n                        [\n                            'type' => 'simple',\n                            'url' => $baseurl . '/correlations/overCorrelations/scope:not_over_correlating',\n                            'text' => __('Not over-correlating'),\n                            'active' => $scope === 'not_over_correlating',\n                        ],\n                        [\n                            'type' => 'simple',\n                            'url' => $baseurl . '/correlations/generateOccurrences',\n                            'text' => __('Regenerate occurrence counts')\n                        ]\n                    ]\n                ]\n            ]\n        ],\n        'fields' => [\n            [\n                'name' => 'Value',\n                'element' => 'postlink',\n                'data_path' => 'OverCorrelatingValue.value',\n                'url' => '/attributes/search/results',\n                'payload_paths' => [\n                    'value' => 'OverCorrelatingValue.value'\n                ]\n            ],\n            [\n                'name' => 'Occurrences',\n                'data_path' => 'OverCorrelatingValue.occurrence',\n                'class' => 'shortish'\n            ],\n            [\n                'name' => 'Blocked by Threshold',\n                'data_path' => 'OverCorrelatingValue.over_correlation',\n                'class' => 'shortish',\n                'element' => 'boolean'\n            ],\n            [\n                'name' => 'Excluded by Exclusion List',\n                'data_path' => 'OverCorrelatingValue.excluded',\n                'class' => 'shortish',\n                'element' => 'boolean'\n            ]\n        ],\n        'title' => empty($ajax) ? $title_for_layout : false,\n        'description' => empty($ajax) ? __('The values with the most correlation entries.') : false,\n        'pull' => 'right',\n        'actions' => [\n            [\n                'onclick' => sprintf(\n                    'openGenericModal(\\'%s/correlation_exclusions/add/redirect_controller:correlations/redirect:top/value:[onclick_params_data_path]\\');',\n                    $baseurl\n                ),\n                'onclick_params_data_path' => 'OverCorrelatingValue.value',\n                'icon' => 'trash',\n                'title' => __('Add exclusion entry for value'),\n                'complex_requirement' => [\n                    'function' => function (array $row) {\n                        return !$row['OverCorrelatingValue']['excluded'];\n                    }\n                ]\n            ]\n        ]\n    ]\n]);\necho '</div>';\nif (empty($ajax)) {\n    echo $this->element('/genericElements/SideMenu/side_menu', $menuData);\n}\n\n\n", "<?php\n    echo sprintf('<div%s>', empty($ajax) ? ' class=\"index\"' : '');\n    echo $this->element('genericElements/IndexTable/index_table', [\n        'data' => [\n            'light_paginator' => 1,\n            'data' => $data,\n            'top_bar' => [\n                'children' => [\n                    [\n                        'children' => [\n                            [\n                                'type' => 'text',\n                                'text' => __('Cache age: %s%s', $age, $age_unit)\n                            ],\n                            [\n                                'type' => 'simple',\n                                'url' => $baseurl . '/correlations/generateTopCorrelations',\n                                'text' => __('Regenerate cache')\n                            ]\n                        ]\n                    ]\n                ]\n            ],\n            'fields' => [\n                [\n                    'name' => 'Value',\n                    'element' => 'postlink',\n                    'data_path' => 'Correlation.value',\n                    'url' => '/attributes/search/results',\n                    'payload_paths' => [\n                        'value' => 'Correlation.value'\n                    ]\n                ],\n                [\n                    'name' => 'Excluded',\n                    'data_path' => 'Correlation.excluded',\n                    'element' => 'boolean',\n                    'class' => 'short'\n                ],\n                [\n                    'name' => 'Correlation count',\n                    'data_path' => 'Correlation.count',\n                    'class' => 'shortish'\n                ]\n            ],\n            'title' => empty($ajax) ? $title_for_layout : false,\n            'description' => empty($ajax) ? __('The values with the most correlation entries.') : false,\n            'pull' => 'right',\n            'actions' => [\n                [\n                    'onclick' => sprintf(\n                        'openGenericModal(\\'%s/correlation_exclusions/add/redirect_controller:correlations/redirect:top/value:[onclick_params_data_path]\\');',\n                        $baseurl\n                    ),\n                    'onclick_params_data_path' => 'Correlation.value',\n                    'icon' => 'trash',\n                    'title' => __('Add exclusion entry for value'),\n                    'complex_requirement' => [\n                        'function' => function (array $row) {\n                            return !$row['Correlation']['excluded'];\n                        }\n                    ]\n                ]\n            ]\n        ]\n    ]);\n    echo '</div>';\n    if (empty($ajax)) {\n        echo $this->element('/genericElements/SideMenu/side_menu', $menuData);\n    }\n\n\n", "<?php\n/**\n *\n * PHP 5\n *\n * CakePHP(tm) : Rapid Development Framework (http://cakephp.org)\n * Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)\n *\n * Licensed under The MIT License\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)\n * @link          http://cakephp.org CakePHP(tm) Project\n * @package       Cake.View.Layouts.Emails.html\n * @since         CakePHP(tm) v 0.10.0.1076\n * @license       MIT License (http://www.opensource.org/licenses/mit-license.php)\n */\n?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01//EN\">\n<html>\n<head>\n    <title><?php echo $title_for_layout;?></title>\n</head>\n<body>\n    <?php echo $this->fetch('content');?>\n\n</body>\n</html>\n", "<!DOCTYPE html>\n<html lang=\"<?= Configure::read('Config.language') === 'eng' ? 'en' : Configure::read('Config.language') ?>\">\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width\">\n    <link rel=\"shortcut icon\" href=\"<?= $baseurl ?>/img/favicon.png\">\n    <title><?= $title_for_layout, ' - ', h(Configure::read('MISP.title_text') ?: 'MISP') ?></title>\n    <?php\n        $css = [\n            ['bootstrap', ['preload' => true]],\n            ['bootstrap-datepicker', ['preload' => true]],\n            ['bootstrap-colorpicker', ['preload' => true]],\n            ['font-awesome', ['preload' => true]],\n            ['chosen.min', ['preload' => true]],\n            ['main', ['preload' => true]],\n            ['print', ['media' => 'print']],\n        ];\n        if (Configure::read('MISP.custom_css')) {\n            $css[] = preg_replace('/\\.css$/i', '', Configure::read('MISP.custom_css'));\n        }\n        $js = [\n            ['jquery', ['preload' => true]],\n            ['chosen.jquery.min', ['preload' => true]],\n        ];\n        if (!empty($additionalCss)) {\n            $css = array_merge($css, $additionalCss);\n        }\n        if (!empty($additionalJs)) {\n            $js = array_merge($js, $additionalJs);\n        }\n        echo $this->element('genericElements/assetLoader', [\n            'css' => $css,\n            'js' => $js,\n        ]);\n    ?>\n</head>\n<body data-controller=\"<?= h($this->params['controller']) ?>\" data-action=\"<?= h($this->params['action']) ?>\">\n    <div id=\"popover_form\" class=\"ajax_popover_form\"></div>\n    <div id=\"popover_form_large\" class=\"ajax_popover_form ajax_popover_form_large\"></div>\n    <div id=\"popover_form_x_large\" class=\"ajax_popover_form ajax_popover_form_x_large\"></div>\n    <div id=\"popover_matrix\" class=\"ajax_popover_form ajax_popover_matrix\"></div>\n    <div id=\"popover_box\" class=\"popover_box\"></div>\n    <div id=\"confirmation_box\"></div>\n    <div id=\"gray_out\"></div>\n    <div id=\"container\">\n        <?php\n            echo $this->element('global_menu');\n            $topPadding = '50';\n            if (!empty($debugMode) && $debugMode != 'debugOff') {\n                $topPadding = '0';\n            }\n        ?>\n    </div>\n    <div id=\"flashContainer\" style=\"padding-top:<?php echo $topPadding; ?>px; !important;\">\n        <div id=\"main-view-container\" class=\"container-fluid\">\n            <?php\n                echo $this->Flash->render();\n            ?>\n        </div>\n    </div>\n    <div>\n        <?php\n            echo $this->fetch('content');\n        ?>\n    </div>\n    <?php\n    echo $this->element('genericElements/assetLoader', [\n        'js' => [\n            'misp-touch',\n            'bootstrap',\n            'bootstrap-timepicker',\n            'bootstrap-datepicker',\n            'bootstrap-colorpicker',\n            'misp',\n            'keyboard-shortcuts-definition',\n            'keyboard-shortcuts',\n        ],\n    ]);\n    echo $this->element('footer');\n    echo $this->element('sql_dump');\n    ?>\n    <div id=\"ajax_success_container\" class=\"ajax_container\">\n        <div id=\"ajax_success\" class=\"ajax_result ajax_success\"></div>\n    </div>\n    <div id=\"ajax_fail_container\" class=\"ajax_container\">\n        <div id=\"ajax_fail\" class=\"ajax_result ajax_fail\"></div>\n    </div>\n    <div class=\"loading\">\n        <div class=\"spinner\"></div>\n        <div class=\"loadingText\"><?php echo __('Loading');?></div>\n    </div>\n    <script>\n    <?php\n        if (!isset($debugMode)):\n    ?>\n        $(window).scroll(function() {\n            $('.actions').css('left',-$(window).scrollLeft());\n        });\n    <?php\n        endif;\n    ?>\n        var baseurl = '<?php echo $baseurl; ?>';\n        var here = '<?php\n                if (substr($this->params['action'], 0, 6) === 'admin_') {\n                    echo $baseurl . '/admin/' . h($this->params['controller']) . '/' . h(substr($this->params['action'], 6));\n                } else {\n                    echo $baseurl . '/' . h($this->params['controller']) . '/' . h($this->params['action']);\n                }\n            ?>';\n        <?php\n            if (!Configure::read('MISP.disable_auto_logout') && isset($me) && $me):\n        ?>\n                //checkIfLoggedIn();\n        <?php\n            endif;\n        ?>\n    </script>\n</body>\n</html>\n", "<?php\n/**\n *\n * PHP 5\n *\n * CakePHP(tm) : Rapid Development Framework (http://cakephp.org)\n * Copyright 2005-2011, Cake Software Foundation, Inc. (http://cakefoundation.org)\n *\n * Licensed under The MIT License\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright 2005-2011, Cake Software Foundation, Inc. (http://cakefoundation.org)\n * @link          http://cakephp.org CakePHP(tm) Project\n * @package       Cake.View.Layouts\n * @since         CakePHP(tm) v 0.10.0.1076\n * @license       MIT License (http://www.opensource.org/licenses/mit-license.php)\n */\n\n$cakeDescription = __d('cake_dev', 'CakePHP: the rapid development php framework');\n?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n    <?php echo $this->Html->charset(); ?>\n    <title>\n        <?php echo $cakeDescription ?>:\n        <?php echo $title_for_layout; ?>\n    </title>\n    <?php\n        echo $this->Html->meta('icon');\n\n        echo $this->Html->css('cake.generic');\n\n        echo $this->fetch('meta');\n        echo $this->fetch('css');\n        echo $this->fetch('script');\n    ?>\n</head>\n<body>\n    <div id=\"container\">\n        <div id=\"header\">\n            <h1><?php echo $this->Html->link($cakeDescription, 'http://cakephp.org'); ?></h1>\n        </div>\n        <div id=\"content\">\n\n            <?php echo $this->Session->flash(); ?>\n\n            <?php echo $this->fetch('content'); ?>\n        </div>\n        <div id=\"footer\">\n            <?php echo $this->Html->link(\n                    $this->Html->image('cake.power.gif', array('alt' => $cakeDescription, 'border' => '0')),\n                    'http://www.cakephp.org/',\n                    array('target' => '_blank', 'escape' => false)\n                );\n            ?>\n        </div>\n    </div>\n    <?php echo $this->element('sql_dump'); ?>\n</body>\n</html>\n"], "fixing_code": ["<?php\n    echo sprintf('<div%s>', empty($ajax) ? ' class=\"index\"' : '');\n    echo $this->element('genericElements/IndexTable/index_table', [\n        'data' => [\n            'light_paginator' => 1,\n            'data' => $data,\n            'top_bar' => [\n                'pull' => 'right',\n                'children' => [\n                    [\n                        'type' => 'search',\n                        'button' => __('Filter'),\n                        'placeholder' => __('Enter value to search'),\n                        'searchKey' => 'quickFilter',\n                    ]\n                ]\n            ],\n            'fields' => [\n                [\n                    'name' => 'Value',\n                    'sort' => 'Correlation.value',\n                    'data_path' => 'Correlation.value',\n                    'class' => 'short'\n                ],\n                [\n                    'name' => 'Correlation count',\n                    'sort' => 'Correlation.count',\n                    'data_path' => 'Correlation.count'\n                ]\n            ],\n            'title' => empty($ajax) ? h($title_for_layout) : false,\n            'description' => empty($ajax) ? __('The values with the most correlation entries.') : false,\n            'pull' => 'right',\n            'actions' => [\n                [\n                    'onclick' => sprintf(\n                        'openGenericModal(\\'%s/correlation_exclusions/add/redirect:top_correlations/value:[onclick_params_data_path]\\');',\n                        $baseurl\n                    ),\n                    'onclick_params_data_path' => 'Correlation.value',\n                    'icon' => 'trash',\n                    'title' => __('Add exclusion entry for value'),\n                ]\n            ]\n        ]\n    ]);\n    echo '</div>';\n    if (empty($ajax)) {\n        echo $this->element('/genericElements/SideMenu/side_menu', $menuData);\n    }\n?>\n<script type=\"text/javascript\">\n    var passedArgsArray = <?php echo $passedArgs; ?>;\n    $(function() {\n        $('#quickFilterButton').click(function() {\n            runIndexQuickFilter();\n        });\n    });\n</script>\n", "<?php\necho sprintf('<div%s>', empty($ajax) ? ' class=\"index\"' : '');\necho $this->element('genericElements/IndexTable/index_table', [\n    'data' => [\n        'light_paginator' => 1,\n        'data' => $data,\n        'top_bar' => [\n            'children' => [\n                [\n                    'children' => [\n                        [\n                            'type' => 'simple',\n                            'url' => $baseurl . '/correlations/overCorrelations',\n                            'text' => __('All'),\n                            'active' => $scope === 'all',\n                        ],\n                        [\n                            'type' => 'simple',\n                            'url' => $baseurl . '/correlations/overCorrelations/scope:over_correlating',\n                            'text' => __('Over-correlating'),\n                            'active' => $scope === 'over_correlating',\n                        ],\n                        [\n                            'type' => 'simple',\n                            'url' => $baseurl . '/correlations/overCorrelations/scope:not_over_correlating',\n                            'text' => __('Not over-correlating'),\n                            'active' => $scope === 'not_over_correlating',\n                        ],\n                        [\n                            'type' => 'simple',\n                            'url' => $baseurl . '/correlations/generateOccurrences',\n                            'text' => __('Regenerate occurrence counts')\n                        ]\n                    ]\n                ]\n            ]\n        ],\n        'fields' => [\n            [\n                'name' => 'Value',\n                'element' => 'postlink',\n                'data_path' => 'OverCorrelatingValue.value',\n                'url' => '/attributes/search/results',\n                'payload_paths' => [\n                    'value' => 'OverCorrelatingValue.value'\n                ]\n            ],\n            [\n                'name' => 'Occurrences',\n                'data_path' => 'OverCorrelatingValue.occurrence',\n                'class' => 'shortish'\n            ],\n            [\n                'name' => 'Blocked by Threshold',\n                'data_path' => 'OverCorrelatingValue.over_correlation',\n                'class' => 'shortish',\n                'element' => 'boolean'\n            ],\n            [\n                'name' => 'Excluded by Exclusion List',\n                'data_path' => 'OverCorrelatingValue.excluded',\n                'class' => 'shortish',\n                'element' => 'boolean'\n            ]\n        ],\n        'title' => empty($ajax) ? h($title_for_layout) : false,\n        'description' => empty($ajax) ? __('The values with the most correlation entries.') : false,\n        'pull' => 'right',\n        'actions' => [\n            [\n                'onclick' => sprintf(\n                    'openGenericModal(\\'%s/correlation_exclusions/add/redirect_controller:correlations/redirect:top/value:[onclick_params_data_path]\\');',\n                    $baseurl\n                ),\n                'onclick_params_data_path' => 'OverCorrelatingValue.value',\n                'icon' => 'trash',\n                'title' => __('Add exclusion entry for value'),\n                'complex_requirement' => [\n                    'function' => function (array $row) {\n                        return !$row['OverCorrelatingValue']['excluded'];\n                    }\n                ]\n            ]\n        ]\n    ]\n]);\necho '</div>';\nif (empty($ajax)) {\n    echo $this->element('/genericElements/SideMenu/side_menu', $menuData);\n}\n\n\n", "<?php\n    echo sprintf('<div%s>', empty($ajax) ? ' class=\"index\"' : '');\n    echo $this->element('genericElements/IndexTable/index_table', [\n        'data' => [\n            'light_paginator' => 1,\n            'data' => $data,\n            'top_bar' => [\n                'children' => [\n                    [\n                        'children' => [\n                            [\n                                'type' => 'text',\n                                'text' => __('Cache age: %s%s', $age, $age_unit)\n                            ],\n                            [\n                                'type' => 'simple',\n                                'url' => $baseurl . '/correlations/generateTopCorrelations',\n                                'text' => __('Regenerate cache')\n                            ]\n                        ]\n                    ]\n                ]\n            ],\n            'fields' => [\n                [\n                    'name' => 'Value',\n                    'element' => 'postlink',\n                    'data_path' => 'Correlation.value',\n                    'url' => '/attributes/search/results',\n                    'payload_paths' => [\n                        'value' => 'Correlation.value'\n                    ]\n                ],\n                [\n                    'name' => 'Excluded',\n                    'data_path' => 'Correlation.excluded',\n                    'element' => 'boolean',\n                    'class' => 'short'\n                ],\n                [\n                    'name' => 'Correlation count',\n                    'data_path' => 'Correlation.count',\n                    'class' => 'shortish'\n                ]\n            ],\n            'title' => empty($ajax) ? h($title_for_layout) : false,\n            'description' => empty($ajax) ? __('The values with the most correlation entries.') : false,\n            'pull' => 'right',\n            'actions' => [\n                [\n                    'onclick' => sprintf(\n                        'openGenericModal(\\'%s/correlation_exclusions/add/redirect_controller:correlations/redirect:top/value:[onclick_params_data_path]\\');',\n                        $baseurl\n                    ),\n                    'onclick_params_data_path' => 'Correlation.value',\n                    'icon' => 'trash',\n                    'title' => __('Add exclusion entry for value'),\n                    'complex_requirement' => [\n                        'function' => function (array $row) {\n                            return !$row['Correlation']['excluded'];\n                        }\n                    ]\n                ]\n            ]\n        ]\n    ]);\n    echo '</div>';\n    if (empty($ajax)) {\n        echo $this->element('/genericElements/SideMenu/side_menu', $menuData);\n    }\n\n\n", "<?php\n/**\n *\n * PHP 5\n *\n * CakePHP(tm) : Rapid Development Framework (http://cakephp.org)\n * Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)\n *\n * Licensed under The MIT License\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)\n * @link          http://cakephp.org CakePHP(tm) Project\n * @package       Cake.View.Layouts.Emails.html\n * @since         CakePHP(tm) v 0.10.0.1076\n * @license       MIT License (http://www.opensource.org/licenses/mit-license.php)\n */\n?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01//EN\">\n<html>\n<head>\n    <title><?php echo h($title_for_layout);?></title>\n</head>\n<body>\n    <?php echo $this->fetch('content');?>\n\n</body>\n</html>\n", "<!DOCTYPE html>\n<html lang=\"<?= Configure::read('Config.language') === 'eng' ? 'en' : Configure::read('Config.language') ?>\">\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width\">\n    <link rel=\"shortcut icon\" href=\"<?= $baseurl ?>/img/favicon.png\">\n    <title><?= h($title_for_layout), ' - ', h(Configure::read('MISP.title_text') ?: 'MISP') ?></title>\n    <?php\n        $css = [\n            ['bootstrap', ['preload' => true]],\n            ['bootstrap-datepicker', ['preload' => true]],\n            ['bootstrap-colorpicker', ['preload' => true]],\n            ['font-awesome', ['preload' => true]],\n            ['chosen.min', ['preload' => true]],\n            ['main', ['preload' => true]],\n            ['print', ['media' => 'print']],\n        ];\n        if (Configure::read('MISP.custom_css')) {\n            $css[] = preg_replace('/\\.css$/i', '', Configure::read('MISP.custom_css'));\n        }\n        $js = [\n            ['jquery', ['preload' => true]],\n            ['chosen.jquery.min', ['preload' => true]],\n        ];\n        if (!empty($additionalCss)) {\n            $css = array_merge($css, $additionalCss);\n        }\n        if (!empty($additionalJs)) {\n            $js = array_merge($js, $additionalJs);\n        }\n        echo $this->element('genericElements/assetLoader', [\n            'css' => $css,\n            'js' => $js,\n        ]);\n    ?>\n</head>\n<body data-controller=\"<?= h($this->params['controller']) ?>\" data-action=\"<?= h($this->params['action']) ?>\">\n    <div id=\"popover_form\" class=\"ajax_popover_form\"></div>\n    <div id=\"popover_form_large\" class=\"ajax_popover_form ajax_popover_form_large\"></div>\n    <div id=\"popover_form_x_large\" class=\"ajax_popover_form ajax_popover_form_x_large\"></div>\n    <div id=\"popover_matrix\" class=\"ajax_popover_form ajax_popover_matrix\"></div>\n    <div id=\"popover_box\" class=\"popover_box\"></div>\n    <div id=\"confirmation_box\"></div>\n    <div id=\"gray_out\"></div>\n    <div id=\"container\">\n        <?php\n            echo $this->element('global_menu');\n            $topPadding = '50';\n            if (!empty($debugMode) && $debugMode != 'debugOff') {\n                $topPadding = '0';\n            }\n        ?>\n    </div>\n    <div id=\"flashContainer\" style=\"padding-top:<?php echo $topPadding; ?>px; !important;\">\n        <div id=\"main-view-container\" class=\"container-fluid\">\n            <?php\n                echo $this->Flash->render();\n            ?>\n        </div>\n    </div>\n    <div>\n        <?php\n            echo $this->fetch('content');\n        ?>\n    </div>\n    <?php\n    echo $this->element('genericElements/assetLoader', [\n        'js' => [\n            'misp-touch',\n            'bootstrap',\n            'bootstrap-timepicker',\n            'bootstrap-datepicker',\n            'bootstrap-colorpicker',\n            'misp',\n            'keyboard-shortcuts-definition',\n            'keyboard-shortcuts',\n        ],\n    ]);\n    echo $this->element('footer');\n    echo $this->element('sql_dump');\n    ?>\n    <div id=\"ajax_success_container\" class=\"ajax_container\">\n        <div id=\"ajax_success\" class=\"ajax_result ajax_success\"></div>\n    </div>\n    <div id=\"ajax_fail_container\" class=\"ajax_container\">\n        <div id=\"ajax_fail\" class=\"ajax_result ajax_fail\"></div>\n    </div>\n    <div class=\"loading\">\n        <div class=\"spinner\"></div>\n        <div class=\"loadingText\"><?php echo __('Loading');?></div>\n    </div>\n    <script>\n    <?php\n        if (!isset($debugMode)):\n    ?>\n        $(window).scroll(function() {\n            $('.actions').css('left',-$(window).scrollLeft());\n        });\n    <?php\n        endif;\n    ?>\n        var baseurl = '<?php echo $baseurl; ?>';\n        var here = '<?php\n                if (substr($this->params['action'], 0, 6) === 'admin_') {\n                    echo $baseurl . '/admin/' . h($this->params['controller']) . '/' . h(substr($this->params['action'], 6));\n                } else {\n                    echo $baseurl . '/' . h($this->params['controller']) . '/' . h($this->params['action']);\n                }\n            ?>';\n        <?php\n            if (!Configure::read('MISP.disable_auto_logout') && isset($me) && $me):\n        ?>\n                //checkIfLoggedIn();\n        <?php\n            endif;\n        ?>\n    </script>\n</body>\n</html>\n", "<?php\n/**\n *\n * PHP 5\n *\n * CakePHP(tm) : Rapid Development Framework (http://cakephp.org)\n * Copyright 2005-2011, Cake Software Foundation, Inc. (http://cakefoundation.org)\n *\n * Licensed under The MIT License\n * Redistributions of files must retain the above copyright notice.\n *\n * @copyright     Copyright 2005-2011, Cake Software Foundation, Inc. (http://cakefoundation.org)\n * @link          http://cakephp.org CakePHP(tm) Project\n * @package       Cake.View.Layouts\n * @since         CakePHP(tm) v 0.10.0.1076\n * @license       MIT License (http://www.opensource.org/licenses/mit-license.php)\n */\n\n$cakeDescription = __d('cake_dev', 'CakePHP: the rapid development php framework');\n?>\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n    <?php echo $this->Html->charset(); ?>\n    <title>\n        <?php echo $cakeDescription ?>:\n        <?php echo h($title_for_layout); ?>\n    </title>\n    <?php\n        echo $this->Html->meta('icon');\n\n        echo $this->Html->css('cake.generic');\n\n        echo $this->fetch('meta');\n        echo $this->fetch('css');\n        echo $this->fetch('script');\n    ?>\n</head>\n<body>\n    <div id=\"container\">\n        <div id=\"header\">\n            <h1><?php echo $this->Html->link($cakeDescription, 'http://cakephp.org'); ?></h1>\n        </div>\n        <div id=\"content\">\n\n            <?php echo $this->Session->flash(); ?>\n\n            <?php echo $this->fetch('content'); ?>\n        </div>\n        <div id=\"footer\">\n            <?php echo $this->Html->link(\n                    $this->Html->image('cake.power.gif', array('alt' => $cakeDescription, 'border' => '0')),\n                    'http://www.cakephp.org/',\n                    array('target' => '_blank', 'escape' => false)\n                );\n            ?>\n        </div>\n    </div>\n    <?php echo $this->element('sql_dump'); ?>\n</body>\n</html>\n"], "filenames": ["app/View/CorrelationExclusions/top_correlations.ctp", "app/View/Correlations/over_correlations.ctp", "app/View/Correlations/top.ctp", "app/View/Layouts/Emails/html/default.ctp", "app/View/Layouts/default.ctp", "app/View/Layouts/error.ctp"], "buggy_code_start_loc": [31, 66, 46, 22, 8, 27], "buggy_code_end_loc": [32, 67, 47, 23, 9, 28], "fixing_code_start_loc": [31, 66, 46, 22, 8, 27], "fixing_code_end_loc": [32, 67, 47, 23, 9, 28], "type": "CWE-79", "message": "In MISP before 2.4.172, title_for_layout is not properly sanitized in Correlations, CorrelationExclusions, and Layouts.", "other": {"cve": {"id": "CVE-2023-37307", "sourceIdentifier": "cve@mitre.org", "published": "2023-06-30T17:15:09.800", "lastModified": "2024-02-05T17:15:08.680", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "In MISP before 2.4.172, title_for_layout is not properly sanitized in Correlations, CorrelationExclusions, and Layouts."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:misp-project:malware_information_sharing_platform:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.4.172", "matchCriteriaId": "5B85DED7-7D47-4040-B652-630964AF10A1"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/176975/MISP-2.4.171-Cross-Site-Scripting.html", "source": "cve@mitre.org"}, {"url": "https://github.com/MISP/MISP/commit/286c84fab0047726a6a396ceefaae1bb666fc485", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/MISP/MISP/compare/v2.4.171...v2.4.172", "source": "cve@mitre.org", "tags": ["Patch", "Product"]}, {"url": "https://zigrin.com/advisories/misp-stored-xss/", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/MISP/MISP/commit/286c84fab0047726a6a396ceefaae1bb666fc485"}}