{"buggy_code": ["<?php\n    $imgurl = IMAGESERVE_DIR . \"/images/$type/$file.$type\";\n    $protocol = isset($_SERVER['https']) && $_SERVER['https'] != \"off\" ? \"https\" : \"http\";\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <title><?php echo APP_NAME . \" - $file.$type\"; ?></title>\n        <link rel=\"stylesheet\" href=\"/assets/css/style.css\">\n<?php if (TWITTER_CARDS) { ?>\n        <meta name=\"twitter:card\" content=\"photo\" />\n        <meta name=\"twitter:site\" content=\"<?php echo TWITTER_HANDLE; ?>\" />\n        <meta name=\"twitter:title\" content=\"<?php echo $file . '.' . $type; ?>\" />\n        <meta name=\"twitter:image\" content=\"<?php echo $protocol; ?>://<?php echo $_SERVER['SERVER_NAME'] . $imgurl; ?>\" />\n        <meta name=\"twitter:url\" content=\"<?php echo $protocol; ?>://<?php echo $_SERVER['SERVER_NAME'] . $_SERVER['REQUEST_URI']; ?>\" />\n<?php } ?>\n    </head>\n\n    <body>\n        <h1>\n            <?php echo \"$file.$type\"; ?> &middot;\n\n            <abbr title=\"Value rounded to the nearest kb.\">\n                ~<?php echo round($filesize / 1024, 0); ?>kb\n            </abbr>\n        </h1>\n\n        <div class=\"container\">\n            <?php if ($type != \"webm\"): ?>\n            <a href=\"<?php echo $imgurl; ?>\">\n                <img src=\"<?php echo $imgurl; ?>\" alt=\"<?php echo \"$file.$type\"; ?>\">\n            </a>\n            <?php else: ?>\n            <video width=\"1280\" height=\"720\" controls>\n                <source src=\"<?php echo $imgurl; ?>\" type=\"video/webm\">\n            </video>\n            <?php endif; ?>\n        </div>\n\n        <?php\n            $time = microtime();\n            $time = explode(' ', $time);\n            $time = $time[1] + $time[0];\n            $finish = $time;\n            $total_time = round(($finish - $start), 4);\n        ?>\n\n        <p>\n            <a href=\"https://github.com/aerouk/imageserve\">\n                Powered by <b>imageserve</b>\n            </a>\n\n            &middot; Page generated in <?php echo $total_time; ?> seconds\n        </p>\n    </body>\n</html>\n"], "fixing_code": ["<?php\n    $imgurl = IMAGESERVE_DIR . \"/images/$type/$file.$type\";\n    $protocol = isset($_SERVER['https']) && $_SERVER['https'] != \"off\" ? \"https\" : \"http\";\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n    <head>\n        <meta charset=\"UTF-8\">\n        <title><?php echo APP_NAME . \" - $file.$type\"; ?></title>\n        <link rel=\"stylesheet\" href=\"/assets/css/style.css\">\n<?php if (TWITTER_CARDS) { ?>\n        <meta name=\"twitter:card\" content=\"photo\" />\n        <meta name=\"twitter:site\" content=\"<?php echo TWITTER_HANDLE; ?>\" />\n        <meta name=\"twitter:title\" content=\"<?php echo $file . '.' . $type; ?>\" />\n        <meta name=\"twitter:image\" content=\"<?php echo $protocol; ?>://<?php echo $_SERVER['SERVER_NAME'] . $imgurl; ?>\" />\n        <meta name=\"twitter:url\" content=\"<?php echo $protocol; ?>://<?php echo $_SERVER['SERVER_NAME'] . htmlspecialchars($_SERVER['REQUEST_URI']); ?>\" />\n<?php } ?>\n    </head>\n\n    <body>\n        <h1>\n            <?php echo \"$file.$type\"; ?> &middot;\n\n            <abbr title=\"Value rounded to the nearest kb.\">\n                ~<?php echo round($filesize / 1024, 0); ?>kb\n            </abbr>\n        </h1>\n\n        <div class=\"container\">\n            <?php if ($type != \"webm\"): ?>\n            <a href=\"<?php echo $imgurl; ?>\">\n                <img src=\"<?php echo $imgurl; ?>\" alt=\"<?php echo \"$file.$type\"; ?>\">\n            </a>\n            <?php else: ?>\n            <video width=\"1280\" height=\"720\" controls>\n                <source src=\"<?php echo $imgurl; ?>\" type=\"video/webm\">\n            </video>\n            <?php endif; ?>\n        </div>\n\n        <?php\n            $time = microtime();\n            $time = explode(' ', $time);\n            $time = $time[1] + $time[0];\n            $finish = $time;\n            $total_time = round(($finish - $start), 4);\n        ?>\n\n        <p>\n            <a href=\"https://github.com/aerouk/imageserve\">\n                Powered by <b>imageserve</b>\n            </a>\n\n            &middot; Page generated in <?php echo $total_time; ?> seconds\n        </p>\n    </body>\n</html>\n"], "filenames": ["public/protected/templates/viewer.phtml"], "buggy_code_start_loc": [16], "buggy_code_end_loc": [17], "fixing_code_start_loc": [16], "fixing_code_end_loc": [17], "type": "CWE-79", "message": "A vulnerability has been found in aerouk imageserve and classified as problematic. Affected by this vulnerability is an unknown functionality. The manipulation of the argument REQUEST_URI leads to cross site scripting. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. The name of the patch is 2ac3cd4f90b4df66874fab171376ca26868604c4. It is recommended to apply a patch to fix this issue. The identifier VDB-217057 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2017-20153", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-30T12:15:08.910", "lastModified": "2023-01-09T17:47:48.423", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability has been found in aerouk imageserve and classified as problematic. Affected by this vulnerability is an unknown functionality. The manipulation of the argument REQUEST_URI leads to cross site scripting. The attack can be launched remotely. The exploit has been disclosed to the public and may be used. The name of the patch is 2ac3cd4f90b4df66874fab171376ca26868604c4. It is recommended to apply a patch to fix this issue. The identifier VDB-217057 was assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 2.6, "baseSeverity": "LOW"}, "exploitabilityScore": 1.2, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:H/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "HIGH", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 2.1}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:imageserve_project:imageserve:-:*:*:*:*:*:*:*", "matchCriteriaId": "1C2BF72E-B12A-413A-A94F-82A928BF1DF2"}]}]}], "references": [{"url": "https://github.com/aerouk/imageserve/commit/2ac3cd4f90b4df66874fab171376ca26868604c4", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/aerouk/imageserve/pull/27", "source": "cna@vuldb.com", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.217057", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.217057", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/aerouk/imageserve/commit/2ac3cd4f90b4df66874fab171376ca26868604c4"}}