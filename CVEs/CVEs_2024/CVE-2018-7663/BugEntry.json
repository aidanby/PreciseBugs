{"buggy_code": ["<?php\n\n/*\n|--------------------------------------------------------------------------\n| Voten Helpers\n|--------------------------------------------------------------------------\n|\n| This file contains our general helper functions that can be accessed everywhere.\n| Hope you have fun with it and also don't over do it!\n|\n*/\n\nif (!function_exists('getRequestIpAddress')) {\n    /**\n     * Returns the real IP address of the request even if the website is using Cloudflare.\n     *\n     * @return string\n     */\n    function getRequestIpAddress()\n    {\n        return $_SERVER['HTTP_CF_CONNECTING_IP'] ?? $_SERVER['REMOTE_ADDR'] ?? '0.0.0.0';\n    }\n}\n\nif (!function_exists('firstRate')) {\n    /**\n     * Calculates the rate for votable model (currently submissions and comments).\n     *\n     * @return float\n     */\n    function firstRate()\n    {\n        $startTime = 1473696439;\n        $created = time();\n        $timeDiff = $created - $startTime;\n\n        return $timeDiff / 45000;\n    }\n}\n\nif (!function_exists('rate')) {\n    /**\n     * Calculates the rate for sorting by hot.\n     *\n     * @param int       $upvotes\n     * @param int       $downvotes\n     * @param timestamp $created\n     *\n     * @return float\n     */\n    function rate($upvotes, $downvotes, $created)\n    {\n        $startTime = 1473696439; // strtotime('2016-09-12 16:07:19')\n        $created = strtotime($created);\n        $timeDiff = $created - $startTime;\n\n        $x = $upvotes - $downvotes;\n\n        if ($x > 0) {\n            $y = 1;\n        } elseif ($x == 0) {\n            $y = 0;\n        } else {\n            $y = -1;\n        }\n\n        if (abs($x) >= 1) {\n            $z = abs($x);\n        } else {\n            $z = 1;\n        }\n\n        return (log10($z) * $y) + ($timeDiff / 45000);\n    }\n}\n\nif (!function_exists('settings')) {\n    /**\n     * makes it easy for interacting with user's settings (that is implemented as json).\n     *\n     * @param string $key\n     *\n     * @return mixed\n     */\n    function settings($key = null)\n    {\n        $settings = app('App\\Settings');\n\n        return $key ? $settings->get($key) : $settings;\n    }\n}\n\nif (!function_exists('domain')) {\n    /**\n     * makes it easy for interacting with user's settings (that is implemented as json).\n     *\n     * @param string $key\n     *\n     * @return mixed\n     */\n    function domain($url)\n    {\n        return str_ireplace('www.', '', parse_url($url, PHP_URL_HOST));\n    }\n}\n\nif (!function_exists('isValidUrl')) {\n    /**\n     * makes it easy for interacting with user's settings (that is implemented as json).\n     *\n     * @param string $key\n     *\n     * @return bool\n     */\n    function isValidUrl($url)\n    {\n        return !filter_var($url, FILTER_VALIDATE_URL) === false;\n    }\n}\n\nif (!function_exists('isMobileDevice')) {\n    /**\n     * makes it easy for interacting with user's settings (that is implemented as json).\n     *\n     * @param string $key\n     *\n     * @return bool\n     */\n    function isMobileDevice()\n    {\n        $useragent = $_SERVER['HTTP_USER_AGENT'] ?? 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36';\n\n        return preg_match('/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i', $useragent) || preg_match('/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i', substr($useragent, 0, 4));\n    }\n}\n\nif (!function_exists('confirmPassword')) {\n    /**\n     * Used for \"Enter your password to confirm cases\".\n     *\n     * @param string $password\n     *\n     * @return bool\n     */\n    function confirmPassword($password)\n    {\n        return Illuminate\\Support\\Facades\\Hash::check($password, auth()->user()->password);\n    }\n}\n\nif (!function_exists('externalJson')) {\n    /**\n     * Used for \"Enter your password to confirm cases\".\n     *\n     * @param string $url\n     *\n     * @return obj|bool\n     */\n    function externalJson($url)\n    {\n        try {\n            return json_decode(file_get_contents($url));\n        } catch (\\Exception $e) {\n            return false;\n        }\n    }\n}\n\nif (!function_exists('rssForHumans')) {\n    /**\n     * Used for \"Enter your password to confirm cases\".\n     *\n     * @param int $bytes\n     *\n     * @return string\n     */\n    function rssForHumans($bytes)\n    {\n        if ($bytes < 1024) {\n            return $bytes + ' bytes';\n        } elseif ($bytes < 1048576) {\n            return round($bytes / 1048576, 3).' KB';\n        } elseif ($bytes < 1073741824) {\n            return round($bytes / 1073741824 * 1024).' MB';\n        } else {\n            return round($bytes / 1073741824, 3).' GB';\n        }\n    }\n}\n\nif (!function_exists('iso8601')) {\n    /**\n     * Converts timestamp to ISO8601 format.\n     *\n     * @param string $time\n     *\n     * @return string\n     */\n    function iso8601($time)\n    {\n        return gmdate('c', strtotime($time));\n    }\n}\n", "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n    @yield('head')\n    <link rel=\"stylesheet\" href=\"{{ mix('/css/app.css') }}\">\n\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.5/socket.io.min.js\"></script>\n\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/lib/js/emojione.min.js\"></script>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/css/emojione.min.css\"/>\n\n    <!-- CSRF Token -->\n    <meta name=\"csrf-token\" content=\"{{ csrf_token() }}\">\n\n    <script>\n        window.Laravel = <?php echo json_encode([\n            'csrfToken' => csrf_token(),\n            'env' => config('app.env'),\n            'pusherKey' => config('broadcasting.connections.pusher.key'),\n            'pusherCluster' => config('broadcasting.connections.pusher.options.cluster'),\n        ]); ?>\n    </script>\n\n    <link rel=\"shortcut icon\" href=\"/imgs/favicon.png\">\n    @include('user.user-style')\n</head>\n\n<body>\n@include('google-analytics')\n\n<div id=\"voten-app\" :class=\"{ 'background-white': Store.contentRouter != 'content' }\">\n    @include('app-header')\n\n    <div class=\"v-content-wrapper\">\n\t\t<div class=\"v-side {{ settings('sidebar_color') }}\" v-show=\"sidebar\">\n\t\t    <sidebar></sidebar>\n\t\t</div>\n\n\t\t<notifications v-show=\"Store.contentRouter == 'notifications'\"></notifications>\n\t\t<messages v-show=\"Store.contentRouter == 'messages'\" :sidebar=\"sidebar\"></messages>\n\t\t<search-modal v-if=\"Store.contentRouter == 'search'\" :sidebar=\"sidebar\"></search-modal>\n\n        <div class=\"v-content\" id=\"v-content\" v-show=\"Store.contentRouter == 'content'\" @scroll=\"scrolled\">\n            <transition name=\"fade\">\n                <report-submission v-if=\"modalRouter == 'report-submission'\" :submission=\"reportSubmissionId\" :category=\"reportCategory\" :sidebar=\"sidebar\"></report-submission>\n                <report-comment v-if=\"modalRouter == 'report-comment'\" :comment=\"reportCommentId\" :category=\"reportCategory\" :sidebar=\"sidebar\"></report-comment>\n                <feedback v-if=\"modalRouter == 'feedback'\" :sidebar=\"sidebar\"></feedback>\n                <rules v-if=\"modalRouter == 'rules'\" :sidebar=\"sidebar\"></rules>\n                <moderators v-if=\"modalRouter == 'moderators'\" :sidebar=\"sidebar\"></moderators>\n                <keyboard-shortcuts-guide v-if=\"modalRouter == 'keyboard-shortcuts-guide'\" :sidebar=\"sidebar\"></keyboard-shortcuts-guide>\n                <markdown-guide v-if=\"modalRouter == 'markdown-guide'\" :sidebar=\"sidebar\"></markdown-guide>\n            </transition>\n            <crop-modal v-if=\"modalRouter == 'crop-user'\" :sidebar=\"sidebar\" :type=\"'user'\"></crop-modal>\n            <crop-modal v-if=\"modalRouter == 'crop-category'\" :sidebar=\"sidebar\" :type=\"'category'\"></crop-modal>\n\n            <div :class=\"{ 'v-blur-blackandwhite': smallModal }\">\n                @yield('content')\n            </div>\n        </div>\n    </div>\n\n    <scroll-button></scroll-button>\n</div>\n\n<script>\n    var auth = {\n        id: '{{ Auth::user()->id }}',\n        bio: `{!! Auth::user()->bio !!}`,\n        name: '{{ Auth::user()->name }}',\n        email: '{{ Auth::user()->email }}',\n        color: '{{ Auth::user()->color }}',\n        avatar: '{{ Auth::user()->avatar }}',\n        location: '{{ Auth::user()->location }}',\n        username: '{{ Auth::user()->username }}',\n        created_at: '{{ Auth::user()->created_at }}',\n        font: '{{ settings('font') }}',\n        nsfw: {{ settings('nsfw') ? 'true' : 'false' }},\n        nsfwMedia: {{ settings('nsfw_media') ? 'true' : 'false' }},\n        sidebar_color: '{{ settings('sidebar_color') }}',\n        notify_comments_replied: {{ settings('notify_comments_replied') ? 'true' : 'false' }},\n        notify_submissions_replied: {{ settings('notify_submissions_replied') ? 'true' : 'false' }},\n        notify_mentions: {{ settings('notify_mentions') ? 'true' : 'false' }},\n        exclude_upvoted_submissions: {{ settings('exclude_upvoted_submissions') ? 'true' : 'false' }},\n        exclude_downvoted_submissions: {{ settings('exclude_downvoted_submissions') ? 'true' : 'false' }},\n        isMobileDevice: {{ isMobileDevice() ? 'true' : 'false' }},\n        <?php\n            if (isMobileDevice()) {\n                $submission_small_thumbnail = 'false';\n            } else {\n                $submission_small_thumbnail = 'true';\n            }\n        ?>\n        submission_small_thumbnail: {{ $submission_small_thumbnail }},\n        info: {\n        \twebsite: '{{ Auth::user()->info['website'] }}',\n        \ttwitter: '{{ Auth::user()->info['twitter'] }}'\n        },\n        stats: {!! Auth::user()->stats() !!},\n        isGuest: {{ 'false' }}\n    };\n\n    var preload = {};\n</script>\n\n@yield('script')\n\t<script src=\"{{ mix('/js/manifest.js') }}\"></script>\n\t<script src=\"{{ mix('/js/vendor.js') }}\"></script>\n\t<script src=\"{{ mix('/js/app.js') }}\"></script>\n@yield('footer')\n\n</body>\n</html>\n"], "fixing_code": ["<?php\n\n/*\n|--------------------------------------------------------------------------\n| Voten Helpers\n|--------------------------------------------------------------------------\n|\n| This file contains our general helper functions that can be accessed everywhere.\n| Hope you have fun with it and also don't over do it!\n|\n*/\n\nif (!function_exists('getRequestIpAddress')) {\n    /**\n     * Returns the real IP address of the request even if the website is using Cloudflare.\n     *\n     * @return string\n     */\n    function getRequestIpAddress()\n    {\n        return $_SERVER['HTTP_CF_CONNECTING_IP'] ?? $_SERVER['REMOTE_ADDR'] ?? '0.0.0.0';\n    }\n}\n\nif (!function_exists('firstRate')) {\n    /**\n     * Calculates the rate for votable model (currently submissions and comments).\n     *\n     * @return float\n     */\n    function firstRate()\n    {\n        $startTime = 1473696439;\n        $created = time();\n        $timeDiff = $created - $startTime;\n\n        return $timeDiff / 45000;\n    }\n}\n\nif (!function_exists('rate')) {\n    /**\n     * Calculates the rate for sorting by hot.\n     *\n     * @param int       $upvotes\n     * @param int       $downvotes\n     * @param timestamp $created\n     *\n     * @return float\n     */\n    function rate($upvotes, $downvotes, $created)\n    {\n        $startTime = 1473696439; // strtotime('2016-09-12 16:07:19')\n        $created = strtotime($created);\n        $timeDiff = $created - $startTime;\n\n        $x = $upvotes - $downvotes;\n\n        if ($x > 0) {\n            $y = 1;\n        } elseif ($x == 0) {\n            $y = 0;\n        } else {\n            $y = -1;\n        }\n\n        if (abs($x) >= 1) {\n            $z = abs($x);\n        } else {\n            $z = 1;\n        }\n\n        return (log10($z) * $y) + ($timeDiff / 45000);\n    }\n}\n\nif (!function_exists('settings')) {\n    /**\n     * makes it easy for interacting with user's settings (that is implemented as json).\n     *\n     * @param string $key\n     *\n     * @return mixed\n     */\n    function settings($key = null)\n    {\n        $settings = app('App\\Settings');\n\n        return $key ? $settings->get($key) : $settings;\n    }\n}\n\nif (!function_exists('domain')) {\n    /**\n     * makes it easy for interacting with user's settings (that is implemented as json).\n     *\n     * @param string $key\n     *\n     * @return mixed\n     */\n    function domain($url)\n    {\n        return str_ireplace('www.', '', parse_url($url, PHP_URL_HOST));\n    }\n}\n\nif (!function_exists('isValidUrl')) {\n    /**\n     * makes it easy for interacting with user's settings (that is implemented as json).\n     *\n     * @param string $key\n     *\n     * @return bool\n     */\n    function isValidUrl($url)\n    {\n        return !filter_var($url, FILTER_VALIDATE_URL) === false;\n    }\n}\n\nif (!function_exists('isMobileDevice')) {\n    /**\n     * makes it easy for interacting with user's settings (that is implemented as json).\n     *\n     * @param string $key\n     *\n     * @return bool\n     */\n    function isMobileDevice()\n    {\n        $useragent = $_SERVER['HTTP_USER_AGENT'] ?? 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36';\n\n        return preg_match('/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i', $useragent) || preg_match('/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i', substr($useragent, 0, 4));\n    }\n}\n\nif (!function_exists('confirmPassword')) {\n    /**\n     * Used for \"Enter your password to confirm cases\".\n     *\n     * @param string $password\n     *\n     * @return bool\n     */\n    function confirmPassword($password)\n    {\n        return Illuminate\\Support\\Facades\\Hash::check($password, auth()->user()->password);\n    }\n}\n\nif (!function_exists('externalJson')) {\n    /**\n     * Used for \"Enter your password to confirm cases\".\n     *\n     * @param string $url\n     *\n     * @return obj|bool\n     */\n    function externalJson($url)\n    {\n        try {\n            return json_decode(file_get_contents($url));\n        } catch (\\Exception $e) {\n            return false;\n        }\n    }\n}\n\nif (!function_exists('rssForHumans')) {\n    /**\n     * Used for \"Enter your password to confirm cases\".\n     *\n     * @param int $bytes\n     *\n     * @return string\n     */\n    function rssForHumans($bytes)\n    {\n        if ($bytes < 1024) {\n            return $bytes + ' bytes';\n        } elseif ($bytes < 1048576) {\n            return round($bytes / 1048576, 3).' KB';\n        } elseif ($bytes < 1073741824) {\n            return round($bytes / 1073741824 * 1024).' MB';\n        } else {\n            return round($bytes / 1073741824, 3).' GB';\n        }\n    }\n}\n\nif (!function_exists('iso8601')) {\n    /**\n     * Converts timestamp to ISO8601 format.\n     *\n     * @param string $time\n     *\n     * @return string\n     */\n    function iso8601($time)\n    {\n        return gmdate('c', strtotime($time));\n    }\n}\n\nif (!function_exists('strToHex')) {\n    /**\n     * Converts timestamp to ISO8601 format.\n     *\n     * @param string $string\n     *\n     * @return string\n     */\n    function strToHex($string) {\n        $hex = bin2hex($string);\n        $hex = chunk_split($hex, 2, \"\\\\x\");\n        $hex = \"\\\\x\" . substr($hex, 0, -2);\n\n        return $hex;\n    }\n}\n", "<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\n    @yield('head')\n    <link rel=\"stylesheet\" href=\"{{ mix('/css/app.css') }}\">\n\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.4.5/socket.io.min.js\"></script>\n\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/lib/js/emojione.min.js\"></script>\n    <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/emojione/2.2.7/assets/css/emojione.min.css\"/>\n\n    <!-- CSRF Token -->\n    <meta name=\"csrf-token\" content=\"{{ csrf_token() }}\">\n\n    <script>\n        window.Laravel = <?php echo json_encode([\n            'csrfToken' => csrf_token(),\n            'env' => config('app.env'),\n            'pusherKey' => config('broadcasting.connections.pusher.key'),\n            'pusherCluster' => config('broadcasting.connections.pusher.options.cluster'),\n        ]); ?>\n    </script>\n\n    <link rel=\"shortcut icon\" href=\"/imgs/favicon.png\">\n    @include('user.user-style')\n</head>\n\n<body>\n@include('google-analytics')\n\n<div id=\"voten-app\" :class=\"{ 'background-white': Store.contentRouter != 'content' }\">\n    @include('app-header')\n\n    <div class=\"v-content-wrapper\">\n\t\t<div class=\"v-side {{ settings('sidebar_color') }}\" v-show=\"sidebar\">\n\t\t    <sidebar></sidebar>\n\t\t</div>\n\n\t\t<notifications v-show=\"Store.contentRouter == 'notifications'\"></notifications>\n\t\t<messages v-show=\"Store.contentRouter == 'messages'\" :sidebar=\"sidebar\"></messages>\n\t\t<search-modal v-if=\"Store.contentRouter == 'search'\" :sidebar=\"sidebar\"></search-modal>\n\n        <div class=\"v-content\" id=\"v-content\" v-show=\"Store.contentRouter == 'content'\" @scroll=\"scrolled\">\n            <transition name=\"fade\">\n                <report-submission v-if=\"modalRouter == 'report-submission'\" :submission=\"reportSubmissionId\" :category=\"reportCategory\" :sidebar=\"sidebar\"></report-submission>\n                <report-comment v-if=\"modalRouter == 'report-comment'\" :comment=\"reportCommentId\" :category=\"reportCategory\" :sidebar=\"sidebar\"></report-comment>\n                <feedback v-if=\"modalRouter == 'feedback'\" :sidebar=\"sidebar\"></feedback>\n                <rules v-if=\"modalRouter == 'rules'\" :sidebar=\"sidebar\"></rules>\n                <moderators v-if=\"modalRouter == 'moderators'\" :sidebar=\"sidebar\"></moderators>\n                <keyboard-shortcuts-guide v-if=\"modalRouter == 'keyboard-shortcuts-guide'\" :sidebar=\"sidebar\"></keyboard-shortcuts-guide>\n                <markdown-guide v-if=\"modalRouter == 'markdown-guide'\" :sidebar=\"sidebar\"></markdown-guide>\n            </transition>\n            <crop-modal v-if=\"modalRouter == 'crop-user'\" :sidebar=\"sidebar\" :type=\"'user'\"></crop-modal>\n            <crop-modal v-if=\"modalRouter == 'crop-category'\" :sidebar=\"sidebar\" :type=\"'category'\"></crop-modal>\n\n            <div :class=\"{ 'v-blur-blackandwhite': smallModal }\">\n                @yield('content')\n            </div>\n        </div>\n    </div>\n\n    <scroll-button></scroll-button>\n</div>\n\n<script>\n    var auth = {\n        id: '{{ Auth::user()->id }}',\n        bio: '{!! strToHex(Auth::user()->bio) !!}',\n        name: '{{ Auth::user()->name }}',\n        email: '{{ Auth::user()->email }}',\n        color: '{{ Auth::user()->color }}',\n        avatar: '{{ Auth::user()->avatar }}',\n        location: '{{ Auth::user()->location }}',\n        username: '{{ Auth::user()->username }}',\n        created_at: '{{ Auth::user()->created_at }}',\n        font: '{{ settings('font') }}',\n        nsfw: {{ settings('nsfw') ? 'true' : 'false' }},\n        nsfwMedia: {{ settings('nsfw_media') ? 'true' : 'false' }},\n        sidebar_color: '{{ settings('sidebar_color') }}',\n        notify_comments_replied: {{ settings('notify_comments_replied') ? 'true' : 'false' }},\n        notify_submissions_replied: {{ settings('notify_submissions_replied') ? 'true' : 'false' }},\n        notify_mentions: {{ settings('notify_mentions') ? 'true' : 'false' }},\n        exclude_upvoted_submissions: {{ settings('exclude_upvoted_submissions') ? 'true' : 'false' }},\n        exclude_downvoted_submissions: {{ settings('exclude_downvoted_submissions') ? 'true' : 'false' }},\n        isMobileDevice: {{ isMobileDevice() ? 'true' : 'false' }},\n        <?php\n            if (isMobileDevice()) {\n                $submission_small_thumbnail = 'false';\n            } else {\n                $submission_small_thumbnail = 'true';\n            }\n        ?>\n        submission_small_thumbnail: {{ $submission_small_thumbnail }},\n        info: {\n        \twebsite: '{{ Auth::user()->info['website'] }}',\n        \ttwitter: '{{ Auth::user()->info['twitter'] }}'\n        },\n        stats: {!! Auth::user()->stats() !!},\n        isGuest: {{ 'false' }}\n    };\n\n    var preload = {};\n</script>\n\n@yield('script')\n\t<script src=\"{{ mix('/js/manifest.js') }}\"></script>\n\t<script src=\"{{ mix('/js/vendor.js') }}\"></script>\n\t<script src=\"{{ mix('/js/app.js') }}\"></script>\n@yield('footer')\n\n</body>\n</html>\n"], "filenames": ["app/Http/helpers.php", "resources/views/layouts/app.blade.php"], "buggy_code_start_loc": [203, 72], "buggy_code_end_loc": [203, 73], "fixing_code_start_loc": [204, 72], "fixing_code_end_loc": [221, 73], "type": "CWE-79", "message": "An issue was discovered in resources/views/layouts/app.blade.php in Voten.co before 2017-08-25. An unescaped template literal in the bio field of a user profile (resources/views/layouts/app.blade.php) allows for server-side template injection of arbitrary JavaScript.", "other": {"cve": {"id": "CVE-2018-7663", "sourceIdentifier": "cve@mitre.org", "published": "2018-03-05T07:29:00.273", "lastModified": "2018-03-27T17:59:04.563", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "An issue was discovered in resources/views/layouts/app.blade.php in Voten.co before 2017-08-25. An unescaped template literal in the bio field of a user profile (resources/views/layouts/app.blade.php) allows for server-side template injection of arbitrary JavaScript."}, {"lang": "es", "value": "Se ha descubierto un problema en resources/views/layouts/app.blade.php en Voten.co en versiones anteriores a 2017-08-25. Un literal de plantilla no escapado en el campo bio de un perfil de usuario (resources/views/layouts/app.blade.php) permite la inyecci\u00f3n de plantillas del lado del servidor de JavaScript arbitrario."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:voten:voten:*:*:*:*:*:*:*:*", "versionEndExcluding": "2017-08-25", "matchCriteriaId": "1BF676EC-51A6-4BDE-9F2E-EACEF0274D3B"}]}]}], "references": [{"url": "https://github.com/spencerdodd/public-writeups/blob/master/CVE-2018-7663/README.md", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/voten-co/voten/commit/ee6a322568166e28465da075159a6d4adbf74d53", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/voten-co/voten/commit/ee6a322568166e28465da075159a6d4adbf74d53"}}