{"buggy_code": ["name: CI\n\non:\n  push:\n    branches: [ main ]\n  pull_request:\n    branches: [ main ]\n\njobs:\n  install:\n    name: Install\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n\n    - name: Cache node_modules\n      id: cacheModules\n      uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n\n    - name: Install dependencies\n      if: steps.cacheModules.outputs.cache-hit != 'true'\n      run: npm install\n\n  test:\n    name: Test specs\n    needs: [install]\n    runs-on: ubuntu-latest\n    strategy:\n      fail-fast: false\n      matrix:\n        node-version: [10.x, 12.x, 14.x, 15.x]\n        # See supported Node.js release schedule at https://nodejs.org/en/about/releases/\n    steps:\n    - uses: actions/checkout@v2\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - name: Use Node.js ${{ matrix.node-version }}\n      uses: actions/setup-node@v2\n      with:\n        node-version: ${{ matrix.node-version }}\n    - name: Cache node_modules\n      uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    - run: make test\n\n  lint:\n    name: Lint code\n    needs: [install]\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    - run: make lint\n\n  commitlint:\n    name: Lint commits\n    needs: [install]\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n    # The commitlint command needs the main branch available to work.\n    - run: git fetch origin main\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    - run: make commitlint\n\n  typecheck:\n    name: Check types\n    needs: [install]\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    - run: make typecheck\n\n  # The security job can't run on pull requests opened from forks because\n  # Github doesn't pass down the SNYK_TOKEN environment variable.\n  security:\n    name: Check security\n    needs: [install]\n    runs-on: ubuntu-latest\n    if: |\n      github.repository == 'lquixada/cross-fetch' &&\n      github.ref == 'refs/heads/main'\n    steps:\n    - uses: actions/checkout@v2\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    - run: make secure\n      env:\n        SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}\n\n  npm:\n    name: Publish to NPM registry\n    if: |\n      github.repository == 'lquixada/cross-fetch' &&\n      github.ref == 'refs/heads/main' &&\n      contains(github.event.head_commit.message, 'chore(release)')\n    needs: [test, lint, commitlint, typecheck, security]\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n    # Setup .npmrc file to publish to npm\n    - uses: actions/setup-node@v2\n      with:\n        node-version: '10.x'\n        registry-url: 'https://registry.npmjs.org'\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    - run: npm publish\n      env:\n        NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}\n\n  github:\n    name: Publish to Github registry\n    if: |\n      github.repository == 'lquixada/cross-fetch' &&\n      github.ref == 'refs/heads/main' &&\n      contains(github.event.head_commit.message, 'chore(release)')\n    needs: [test, lint, commitlint, typecheck, security]\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n    # Setup .npmrc file to publish to GitHub Packages\n    - uses: actions/setup-node@v2\n      with:\n        registry-url: 'https://npm.pkg.github.com'\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    # The package name needs to be scoped in order to publish on Github Registry\n    - run: sed -i 's/\"cross-fetch\"/\"@lquixada\\/cross-fetch\"/g' package.json\n    - run: npm publish\n      env:\n        NODE_AUTH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n", "{\n  \"name\": \"cross-fetch\",\n  \"version\": \"3.1.4\",\n  \"description\": \"Universal WHATWG Fetch API for Node, Browsers and React Native\",\n  \"homepage\": \"https://github.com/lquixada/cross-fetch\",\n  \"main\": \"dist/node-ponyfill.js\",\n  \"browser\": \"dist/browser-ponyfill.js\",\n  \"react-native\": \"dist/react-native-ponyfill.js\",\n  \"types\": \"index.d.ts\",\n  \"scripts\": {\n    \"prepare\": \"husky install\"\n  },\n  \"lint-staged\": {\n    \"*.js\": [\n      \"make build\",\n      \"standard --fix\"\n    ]\n  },\n  \"standard\": {\n    \"env\": [\n      \"mocha\",\n      \"browser\"\n    ],\n    \"globals\": [\n      \"expect\",\n      \"assert\",\n      \"chai\"\n    ],\n    \"ignore\": [\n      \"/dist/\",\n      \"bundle.js\",\n      \"test.js\",\n      \"test.*.js\",\n      \"api.spec.js\",\n      \"*.ts\"\n    ]\n  },\n  \"mocha\": {\n    \"require\": [\n      \"chai/register-expect\",\n      \"chai/register-assert\"\n    ],\n    \"check-leaks\": true\n  },\n  \"nyc\": {\n    \"temp-dir\": \".reports/.coverage\"\n  },\n  \"commitlint\": {\n    \"extends\": [\n      \"@commitlint/config-conventional\"\n    ]\n  },\n  \"config\": {\n    \"commitizen\": {\n      \"path\": \"./node_modules/cz-conventional-changelog\"\n    }\n  },\n  \"standard-version\": {\n    \"skip\": {\n      \"changelog\": true\n    }\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/lquixada/cross-fetch.git\"\n  },\n  \"author\": \"Leonardo Quixada <lquixada@gmail.com>\",\n  \"license\": \"MIT\",\n  \"bugs\": {\n    \"url\": \"https://github.com/lquixada/cross-fetch/issues\"\n  },\n  \"dependencies\": {\n    \"node-fetch\": \"2.6.5\"\n  },\n  \"devDependencies\": {\n    \"@commitlint/cli\": \"12.0.1\",\n    \"@commitlint/config-conventional\": \"12.0.1\",\n    \"@types/chai\": \"4.2.22\",\n    \"@types/mocha\": \"8.2.2\",\n    \"@types/node\": \"14.14.37\",\n    \"body-parser\": \"1.19.0\",\n    \"chai\": \"4.3.4\",\n    \"codecov\": \"3.8.3\",\n    \"cz-conventional-changelog\": \"3.3.0\",\n    \"express\": \"4.17.1\",\n    \"husky\": \"6.0.0\",\n    \"lint-staged\": \"10.5.4\",\n    \"mocha\": \"8.3.2\",\n    \"mocha-headless-chrome\": \"3.1.0\",\n    \"nock\": \"13.1.3\",\n    \"nyc\": \"15.1.0\",\n    \"open-cli\": \"6.0.1\",\n    \"rollup\": \"2.58.0\",\n    \"rollup-plugin-copy\": \"3.4.0\",\n    \"rollup-plugin-terser\": \"7.0.2\",\n    \"semver\": \"7.3.5\",\n    \"serve-index\": \"1.9.1\",\n    \"standard\": \"16.0.4\",\n    \"standard-version\": \"9.3.1\",\n    \"typescript\": \"4.4.4\",\n    \"webpack\": \"5.58.2\",\n    \"webpack-cli\": \"4.9.0\",\n    \"whatwg-fetch\": \"3.0.0\",\n    \"yargs\": \"16.2.0\"\n  },\n  \"files\": [\n    \"dist\",\n    \"polyfill\",\n    \"index.d.ts\"\n  ],\n  \"keywords\": [\n    \"fetch\",\n    \"http\",\n    \"url\",\n    \"promise\",\n    \"async\",\n    \"await\",\n    \"isomorphic\",\n    \"universal\",\n    \"node\",\n    \"react\",\n    \"native\",\n    \"browser\",\n    \"ponyfill\",\n    \"whatwg\",\n    \"xhr\",\n    \"ajax\"\n  ]\n}\n"], "fixing_code": ["name: CI\n\non:\n  push:\n    branches: [ main ]\n  pull_request:\n    branches: [ main ]\n\njobs:\n  install:\n    name: Install\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n\n    - name: Cache node_modules\n      id: cacheModules\n      uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n\n    - name: Install dependencies\n      if: steps.cacheModules.outputs.cache-hit != 'true'\n      run: npm install\n\n  test:\n    name: Test specs\n    needs: [install]\n    runs-on: ubuntu-latest\n    strategy:\n      fail-fast: false\n      matrix:\n        node-version: [10.x, 12.x, 14.x, 16.x]\n        # See supported Node.js release schedule at https://nodejs.org/en/about/releases/\n    steps:\n    - uses: actions/checkout@v2\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - name: Use Node.js ${{ matrix.node-version }}\n      uses: actions/setup-node@v2\n      with:\n        node-version: ${{ matrix.node-version }}\n    - name: Cache node_modules\n      uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    - run: make test\n\n  lint:\n    name: Lint code\n    needs: [install]\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    - run: make lint\n\n  commitlint:\n    name: Lint commits\n    needs: [install]\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n    # The commitlint command needs the main branch available to work.\n    - run: git fetch origin main\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    - run: make commitlint\n\n  typecheck:\n    name: Check types\n    needs: [install]\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    - run: make typecheck\n\n  # The security job can't run on pull requests opened from forks because\n  # Github doesn't pass down the SNYK_TOKEN environment variable.\n  security:\n    name: Check security\n    needs: [install]\n    runs-on: ubuntu-latest\n    if: |\n      github.repository == 'lquixada/cross-fetch' &&\n      github.ref == 'refs/heads/main'\n    steps:\n    - uses: actions/checkout@v2\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    - run: make secure\n      env:\n        SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}\n\n  npm:\n    name: Publish to NPM registry\n    if: |\n      github.repository == 'lquixada/cross-fetch' &&\n      github.ref == 'refs/heads/main' &&\n      contains(github.event.head_commit.message, 'chore(release)')\n    needs: [test, lint, commitlint, typecheck, security]\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n    # Setup .npmrc file to publish to npm\n    - uses: actions/setup-node@v2\n      with:\n        node-version: '10.x'\n        registry-url: 'https://registry.npmjs.org'\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    - run: npm publish\n      env:\n        NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}\n\n  github:\n    name: Publish to Github registry\n    if: |\n      github.repository == 'lquixada/cross-fetch' &&\n      github.ref == 'refs/heads/main' &&\n      contains(github.event.head_commit.message, 'chore(release)')\n    needs: [test, lint, commitlint, typecheck, security]\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@v2\n    # Setup .npmrc file to publish to GitHub Packages\n    - uses: actions/setup-node@v2\n      with:\n        registry-url: 'https://npm.pkg.github.com'\n    - uses: actions/cache@v2\n      with:\n        path: ~/.npm # this is cache where npm installs from before going out to the network\n        key: ${{ runner.os }}-node-${{ hashFiles('**/package.json') }}\n    - run: npm install --prefer-offline\n    # The package name needs to be scoped in order to publish on Github Registry\n    - run: sed -i 's/\"cross-fetch\"/\"@lquixada\\/cross-fetch\"/g' package.json\n    - run: npm publish\n      env:\n        NODE_AUTH_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n", "{\n  \"name\": \"cross-fetch\",\n  \"version\": \"3.1.4\",\n  \"description\": \"Universal WHATWG Fetch API for Node, Browsers and React Native\",\n  \"homepage\": \"https://github.com/lquixada/cross-fetch\",\n  \"main\": \"dist/node-ponyfill.js\",\n  \"browser\": \"dist/browser-ponyfill.js\",\n  \"react-native\": \"dist/react-native-ponyfill.js\",\n  \"types\": \"index.d.ts\",\n  \"scripts\": {\n    \"prepare\": \"husky install\"\n  },\n  \"lint-staged\": {\n    \"*.js\": [\n      \"make build\",\n      \"standard --fix\"\n    ]\n  },\n  \"standard\": {\n    \"env\": [\n      \"mocha\",\n      \"browser\"\n    ],\n    \"globals\": [\n      \"expect\",\n      \"assert\",\n      \"chai\"\n    ],\n    \"ignore\": [\n      \"/dist/\",\n      \"bundle.js\",\n      \"test.js\",\n      \"test.*.js\",\n      \"api.spec.js\",\n      \"*.ts\"\n    ]\n  },\n  \"mocha\": {\n    \"require\": [\n      \"chai/register-expect\",\n      \"chai/register-assert\"\n    ],\n    \"check-leaks\": true\n  },\n  \"nyc\": {\n    \"temp-dir\": \".reports/.coverage\"\n  },\n  \"commitlint\": {\n    \"extends\": [\n      \"@commitlint/config-conventional\"\n    ]\n  },\n  \"config\": {\n    \"commitizen\": {\n      \"path\": \"./node_modules/cz-conventional-changelog\"\n    }\n  },\n  \"standard-version\": {\n    \"skip\": {\n      \"changelog\": true\n    }\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"https://github.com/lquixada/cross-fetch.git\"\n  },\n  \"author\": \"Leonardo Quixada <lquixada@gmail.com>\",\n  \"license\": \"MIT\",\n  \"bugs\": {\n    \"url\": \"https://github.com/lquixada/cross-fetch/issues\"\n  },\n  \"dependencies\": {\n    \"node-fetch\": \"2.6.7\"\n  },\n  \"devDependencies\": {\n    \"@commitlint/cli\": \"12.0.1\",\n    \"@commitlint/config-conventional\": \"12.0.1\",\n    \"@types/chai\": \"4.2.22\",\n    \"@types/mocha\": \"8.2.2\",\n    \"@types/node\": \"14.14.37\",\n    \"body-parser\": \"1.19.0\",\n    \"chai\": \"4.3.4\",\n    \"codecov\": \"3.8.3\",\n    \"cz-conventional-changelog\": \"3.3.0\",\n    \"express\": \"4.17.1\",\n    \"husky\": \"6.0.0\",\n    \"lint-staged\": \"10.5.4\",\n    \"mocha\": \"8.3.2\",\n    \"mocha-headless-chrome\": \"3.1.0\",\n    \"nock\": \"13.1.3\",\n    \"nyc\": \"15.1.0\",\n    \"open-cli\": \"6.0.1\",\n    \"rollup\": \"2.58.0\",\n    \"rollup-plugin-copy\": \"3.4.0\",\n    \"rollup-plugin-terser\": \"7.0.2\",\n    \"semver\": \"7.3.5\",\n    \"serve-index\": \"1.9.1\",\n    \"standard\": \"16.0.4\",\n    \"standard-version\": \"9.3.1\",\n    \"typescript\": \"4.4.4\",\n    \"webpack\": \"5.58.2\",\n    \"webpack-cli\": \"4.9.0\",\n    \"whatwg-fetch\": \"3.0.0\",\n    \"yargs\": \"16.2.0\"\n  },\n  \"files\": [\n    \"dist\",\n    \"polyfill\",\n    \"index.d.ts\"\n  ],\n  \"keywords\": [\n    \"fetch\",\n    \"http\",\n    \"url\",\n    \"promise\",\n    \"async\",\n    \"await\",\n    \"isomorphic\",\n    \"universal\",\n    \"node\",\n    \"react\",\n    \"native\",\n    \"browser\",\n    \"ponyfill\",\n    \"whatwg\",\n    \"xhr\",\n    \"ajax\"\n  ]\n}\n"], "filenames": [".github/workflows/ci.yml", "package.json"], "buggy_code_start_loc": [34, 73], "buggy_code_end_loc": [35, 74], "fixing_code_start_loc": [34, 73], "fixing_code_end_loc": [35, 74], "type": "CWE-863", "message": "Exposure of Private Personal Information to an Unauthorized Actor in GitHub repository lquixada/cross-fetch prior to 3.1.5.", "other": {"cve": {"id": "CVE-2022-1365", "sourceIdentifier": "security@huntr.dev", "published": "2022-04-15T23:15:08.067", "lastModified": "2022-11-22T19:16:49.490", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Exposure of Private Personal Information to an Unauthorized Actor in GitHub repository lquixada/cross-fetch prior to 3.1.5."}, {"lang": "es", "value": "Una Exposici\u00f3n de Informaci\u00f3n Personal Privada a un Actor no Autorizado en el repositorio de GitHub lquixada/cross-fetch versiones anteriores a 3.1.5"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-863"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-359"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:cross-fetch_project:cross-fetch:*:*:*:*:*:node.js:*:*", "versionEndExcluding": "3.1.5", "matchCriteriaId": "22BF3993-919C-44D9-A298-F08D826CCAEB"}]}]}], "references": [{"url": "https://github.com/lquixada/cross-fetch/commit/a3b3a9481091ddd06b8f83784ba9c4e034dc912a", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/ab55dfdd-2a60-437a-a832-e3efe3d264ac", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/lquixada/cross-fetch/commit/a3b3a9481091ddd06b8f83784ba9c4e034dc912a"}}