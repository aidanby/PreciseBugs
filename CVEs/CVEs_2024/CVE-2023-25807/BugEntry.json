{"buggy_code": ["{\n  \"name\": \"dataease\",\n  \"version\": \"1.18.3\",\n  \"description\": \"dataease front\",\n  \"private\": true,\n  \"scripts\": {\n    \"serve\": \"vue-cli-service serve\",\n    \"build\": \"vue-cli-service build\",\n    \"serves\": \"node --max_old_space_size=4096 node_modules/@vue/cli-service/bin/vue-cli-service.js build\",\n    \"build:prod\": \"vue-cli-service build\",\n    \"build:stage\": \"vue-cli-service build --mode staging\",\n    \"dll\": \"webpack -p --progress --config ./webpack.dll.conf.js\",\n    \"preview\": \"node build/index.js --preview\",\n    \"lint\": \"eslint --ext .js,.vue src --fix\",\n    \"lint-staged\": \"lint-staged\",\n    \"svgo\": \"svgo -f src/icons/svg --config=src/icons/svgo.yml\"\n  },\n  \"husky\": {\n    \"hooks\": {\n      \"pre-commit\": \"npm run lint-staged\"\n    }\n  },\n  \"lint-staged\": {\n    \"src/**/*.js\": \"eslint --ext .js\",\n    \"src/**/*.vue\": \"eslint --ext .vue\"\n  },\n  \"dependencies\": {\n    \"@antv/g2plot\": \"^2.4.9\",\n    \"@antv/l7\": \"2.8.31\",\n    \"@antv/l7-component\": \"2.8.31\",\n    \"@antv/l7-core\": \"2.8.31\",\n    \"@antv/l7-layers\": \"2.8.31\",\n    \"@antv/l7-maps\": \"2.8.31\",\n    \"@antv/l7-renderer\": \"2.8.31\",\n    \"@antv/l7-scene\": \"2.8.31\",\n    \"@antv/l7-source\": \"2.8.31\",\n    \"@antv/l7-utils\": \"2.8.31\",\n    \"@antv/s2\": \"1.35.0\",\n    \"@antv/util\": \"^2.0.17\",\n    \"@riophae/vue-treeselect\": \"0.4.0\",\n    \"@tinymce/tinymce-vue\": \"^3.2.8\",\n    \"axios\": \"^0.21.3\",\n    \"core-js\": \"^2.6.5\",\n    \"echarts\": \"^5.0.1\",\n    \"element-resize-detector\": \"^1.2.3\",\n    \"element-ui\": \"2.15.7\",\n    \"file-saver\": \"^2.0.5\",\n    \"fit2cloud-ui\": \"^1.8.0\",\n    \"flv.js\": \"^1.6.2\",\n    \"html2canvasde\": \"^v1.1.4-de\",\n    \"jquery\": \"^3.1.1\",\n    \"js-base64\": \"^3.7.2\",\n    \"js-cookie\": \"2.2.0\",\n    \"js-pinyin\": \"^0.1.9\",\n    \"jsencrypt\": \"^3.0.0-rc.1\",\n    \"jspdf\": \"^2.3.1\",\n    \"jszip\": \"^3.10.1\",\n    \"lodash\": \"^4.17.21\",\n    \"lodash.isboolean\": \"^3.0.3\",\n    \"lodash.isempty\": \"^4.4.0\",\n    \"lodash.isinteger\": \"^4.0.4\",\n    \"lodash.isnull\": \"^3.0.0\",\n    \"lodash.isnumber\": \"^3.0.3\",\n    \"lodash.isobject\": \"^3.0.2\",\n    \"lodash.isstring\": \"^4.0.1\",\n    \"normalize.css\": \"7.0.0\",\n    \"nprogress\": \"0.2.0\",\n    \"screenfull\": \"4.2.0\",\n    \"sockjs-client\": \"^1.6.0\",\n    \"stompjs\": \"^2.3.3\",\n    \"svg-sprite-loader\": \"4.1.3\",\n    \"svgo\": \"1.2.2\",\n    \"tinymce\": \"^5.8.2\",\n    \"umy-ui\": \"^1.1.6\",\n    \"vue\": \"2.6.10\",\n    \"vue-clipboard2\": \"0.3.1\",\n    \"vue-codemirror\": \"^4.0.6\",\n    \"vue-friendly-iframe\": \"^0.20.0\",\n    \"vue-fullscreen\": \"^2.5.2\",\n    \"vue-i18n\": \"7.3.2\",\n    \"vue-json-views\": \"^1.3.0\",\n    \"vue-proportion-directive\": \"^1.1.0\",\n    \"vue-router\": \"3.0.6\",\n    \"vue-to-pdf\": \"^1.0.0\",\n    \"vue-uuid\": \"2.0.2\",\n    \"vue-video-player\": \"^5.0.2\",\n    \"vue2-ace-editor\": \"0.0.15\",\n    \"vuedraggable\": \"^2.24.3\",\n    \"vuex\": \"3.1.0\",\n    \"webpack\": \"^4.46.0\",\n    \"xlsx\": \"^0.17.0\"\n  },\n  \"devDependencies\": {\n    \"@babel/core\": \"^7.4.0-0\",\n    \"@babel/plugin-proposal-nullish-coalescing-operator\": \"^7.18.6\",\n    \"@babel/plugin-proposal-optional-chaining\": \"^7.18.6\",\n    \"@babel/register\": \"7.0.0\",\n    \"@vue/cli-plugin-babel\": \"3.6.0\",\n    \"@vue/cli-plugin-eslint\": \"^5.0.4\",\n    \"@vue/cli-service\": \"^3.3.1\",\n    \"add-asset-html-webpack-plugin\": \"^3.1.3\",\n    \"babel-eslint\": \"^10.1.0\",\n    \"chalk\": \"2.4.2\",\n    \"clean-webpack-plugin\": \"^1.0.1\",\n    \"connect\": \"3.6.6\",\n    \"copy-webpack-plugin\": \"^4.6.0\",\n    \"eslint\": \"^7.32.0\",\n    \"eslint-config-prettier\": \"^8.5.0\",\n    \"eslint-loader\": \"^4.0.2\",\n    \"eslint-plugin-prettier\": \"^4.0.0\",\n    \"eslint-plugin-vue\": \"^9.1.0\",\n    \"html-webpack-plugin\": \"3.2.0\",\n    \"husky\": \"^8.0.1\",\n    \"less\": \"^3.0.0\",\n    \"less-loader\": \"^5.0.0\",\n    \"lint-staged\": \"^13.0.1\",\n    \"mockjs\": \"1.0.1-beta3\",\n    \"runjs\": \"^4.1.3\",\n    \"sass\": \"^1.33.0\",\n    \"sass-loader\": \"^7.1.0\",\n    \"script-ext-html-webpack-plugin\": \"2.1.3\",\n    \"script-loader\": \"^0.7.2\",\n    \"serve-static\": \"^1.13.2\",\n    \"vue-template-compiler\": \"2.6.10\",\n    \"vuetify\": \"^2.6.6\",\n    \"webpack-cli\": \"^3.2.3\"\n  },\n  \"engines\": {\n    \"node\": \">=8.9\",\n    \"npm\": \">= 3.0.0\"\n  },\n  \"browserslist\": [\n    \"> 1%\",\n    \"last 2 versions\"\n  ]\n}\n", "<template>\n  <div\n    class=\"rich-main-class\"\n    :style=\"autoStyle\"\n    @dblclick=\"setEdit\"\n  >\n    <Editor\n      v-if=\"editShow\"\n      :id=\"tinymceId\"\n      v-model=\"myValue\"\n      style=\"width: 100%;height: 100%\"\n      :init=\"init\"\n      :disabled=\"!canEdit\"\n      @onClick=\"onClick\"\n    />\n  </div>\n</template>\n\n<script>\nimport tinymce from 'tinymce/tinymce' // tinymce\u9ed8\u8ba4hidden\uff0c\u4e0d\u5f15\u5165\u4e0d\u663e\u793a\nimport Editor from '@tinymce/tinymce-vue' // \u7f16\u8f91\u5668\u5f15\u5165\nimport 'tinymce/themes/silver/theme' // \u7f16\u8f91\u5668\u4e3b\u9898\nimport 'tinymce/icons/default' // \u5f15\u5165\u7f16\u8f91\u5668\u56fe\u6807icon\uff0c\u4e0d\u5f15\u5165\u5219\u4e0d\u663e\u793a\u5bf9\u5e94\u56fe\u6807\n// \u5f15\u5165\u7f16\u8f91\u5668\u63d2\u4ef6\uff08\u57fa\u672c\u514d\u8d39\u63d2\u4ef6\u90fd\u5728\u8fd9\u513f\u4e86\uff09\nimport 'tinymce/plugins/advlist' // \u9ad8\u7ea7\u5217\u8868\nimport 'tinymce/plugins/autolink' // \u81ea\u52a8\u94fe\u63a5\nimport 'tinymce/plugins/link' // \u8d85\u94fe\u63a5\nimport 'tinymce/plugins/image' // \u63d2\u5165\u7f16\u8f91\u56fe\u7247\nimport 'tinymce/plugins/lists' // \u5217\u8868\u63d2\u4ef6\nimport 'tinymce/plugins/charmap' // \u7279\u6b8a\u5b57\u7b26\nimport 'tinymce/plugins/media' // \u63d2\u5165\u7f16\u8f91\u5a92\u4f53\nimport 'tinymce/plugins/wordcount' // \u5b57\u6570\u7edf\u8ba1\nimport 'tinymce/plugins/table' // \u8868\u683c\nimport 'tinymce/plugins/contextmenu' // contextmenu\nimport 'tinymce/plugins/directionality'\nimport 'tinymce/plugins/nonbreaking'\nimport 'tinymce/plugins/pagebreak'\nimport { mapState } from 'vuex'\nimport Vue from 'vue'\n\nexport default {\n  name: 'DeRichText',\n  components: {\n    Editor\n  },\n  props: {\n    terminal: {\n      type: String,\n      default: 'pc'\n    },\n    propValue: {\n      type: String,\n      require: true\n    },\n    element: {\n      type: Object\n    },\n    editMode: {\n      type: String,\n      require: false,\n      default: 'preview'\n    },\n    active: {\n      type: Boolean,\n      require: false,\n      default: false\n    },\n    // \u662f\u5426\u7981\u7528\n    disabled: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      editShow: true,\n      canEdit: false,\n      // \u521d\u59cb\u5316\u914d\u7f6e\n      tinymceId: 'tinymce-' + this.element.id,\n      myValue: this.propValue,\n      init: {\n        selector: '#tinymce-' + this.element.id,\n        toolbar_items_size: 'small',\n        language_url: '/tinymce/langs/zh_CN.js', // \u6c49\u5316\u8def\u5f84\u662f\u81ea\u5b9a\u4e49\u7684\uff0c\u4e00\u822c\u653e\u5728public\u6216static\u91cc\u9762\n        language: 'zh_CN',\n        skin_url: '/tinymce/skins/ui/oxide', // \u76ae\u80a4\n        content_css: '/tinymce/skins/content/default/content.css',\n        plugins: 'advlist autolink link image lists charmap  media wordcount table contextmenu directionality pagebreak', // \u63d2\u4ef6\n        // \u5de5\u5177\u680f\n        toolbar: 'undo redo |fontselect fontsizeselect |forecolor backcolor bold italic |underline strikethrough link| formatselect |' +\n          'alignleft aligncenter alignright | bullist numlist |' +\n          ' blockquote subscript superscript removeformat | table image media | fullscreen ' +\n          '| bdmap indent2em lineheight formatpainter axupimgs',\n        toolbar_location: '/',\n        font_formats: '\u5fae\u8f6f\u96c5\u9ed1=Microsoft YaHei;\u5b8b\u4f53=SimSun;\u9ed1\u4f53=SimHei;\u4eff\u5b8b=FangSong;\u534e\u6587\u9ed1\u4f53=STHeiti;\u534e\u6587\u6977\u4f53=STKaiti;\u534e\u6587\u5b8b\u4f53=STSong;\u534e\u6587\u4eff\u5b8b=STFangsong;Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings',\n        fontsize_formats: '12px 14px 16px 18px 20px 22px 24px 28px 32px 36px 48px 56px 72px', // \u5b57\u4f53\u5927\u5c0f\n        menubar: false,\n        placeholder: '\u53cc\u51fb\u8f93\u5165\u6587\u5b57',\n        inline: true, // \u5f00\u542f\u5185\u8054\u6a21\u5f0f\n        branding: false\n      }\n    }\n  },\n  computed: {\n    scale() {\n      return Math.min(this.previewCanvasScale.scalePointWidth, this.previewCanvasScale.scalePointHeight) * this.scaleCoefficient\n    },\n    editStatus() {\n      return this.editMode === 'edit' && !this.mobileLayoutStatus\n    },\n    autoStyle() {\n      return {\n        height: (100 / this.scale) + '%!important',\n        width: (100 / this.scale) + '%!important',\n        left: 50 * (1 - 1 / this.scale) + '%', // \u653e\u5927\u4f59\u91cf \u9664\u4ee5 2\n        top: 50 * (1 - 1 / this.scale) + '%',\n        transform: 'scale(' + this.scale + ')'\n      }\n    },\n    scaleCoefficient() {\n      if (this.terminal === 'pc' && !this.mobileLayoutStatus) {\n        return 1.1\n      } else {\n        return 4.5\n      }\n    },\n    ...mapState([\n      'mobileLayoutStatus',\n      'previewCanvasScale'\n    ])\n  },\n  watch: {\n    // \u76d1\u542c\u5185\u5bb9\u53d8\u5316\n    active(val) {\n      if (!val) {\n        this.canEdit = false\n        this.reShow()\n      }\n    },\n    // \u76d1\u542c\u5185\u5bb9\u53d8\u5316\n    propValue(newValue) {\n      this.myValue = (newValue == null ? '' : newValue)\n    },\n    myValue(newValue) {\n      this.element.propValue = newValue\n      this.$store.commit('canvasChange')\n    }\n  },\n  mounted() {\n    tinymce.init({})\n  },\n  methods: {\n    onClick(e) {\n      this.$emit('onClick', e, tinymce)\n    },\n    setEdit() {\n      if (this.editStatus) {\n        this.canEdit = true\n        Vue.set(this.element, 'editing', true)\n        this.reShow()\n      }\n    },\n    reShow() {\n      this.editShow = false\n      this.$nextTick(() => {\n        this.editShow = true\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.rich-main-class {\n  width: 100%;\n  height: 100%;\n  overflow-y: auto !important;\n  position: relative;\n}\n\n::-webkit-scrollbar {\n  width: 0px !important;\n  height: 0px !important;\n}\n\n::v-deep ol {\n  display: block !important;\n  list-style-type: decimal;\n  margin-block-start: 1em !important;\n  margin-block-end: 1em !important;\n  margin-inline-start: 0px !important;\n  margin-inline-end: 0px !important;\n  padding-inline-start: 40px !important;\n}\n\n::v-deep ul {\n  display: block !important;\n  list-style-type: disc;\n  margin-block-start: 1em !important;\n  margin-block-end: 1em !important;\n  margin-inline-start: 0px !important;\n  margin-inline-end: 0px !important;\n  padding-inline-start: 40px !important;\n}\n\n::v-deep li {\n  display: list-item !important;\n  text-align: -webkit-match-parent !important;\n}\n\n::v-deep p {\n  margin: 0px;\n  padding: 0px;\n}\n</style>\n\n", "<template>\n  <div\n    class=\"rich-main-class\"\n    :style=\"autoStyle\"\n    @dblclick=\"setEdit\"\n  >\n    <Editor\n      v-if=\"editShow\"\n      :id=\"tinymceId\"\n      v-model=\"myValue\"\n      style=\"width: 100%;height: 100%\"\n      :init=\"init\"\n      :disabled=\"!canEdit\"\n      @onClick=\"onClick\"\n    />\n  </div>\n</template>\n\n<script>\nimport tinymce from 'tinymce/tinymce' // tinymce\u9ed8\u8ba4hidden\uff0c\u4e0d\u5f15\u5165\u4e0d\u663e\u793a\nimport Editor from '@tinymce/tinymce-vue' // \u7f16\u8f91\u5668\u5f15\u5165\nimport 'tinymce/themes/silver/theme' // \u7f16\u8f91\u5668\u4e3b\u9898\nimport 'tinymce/icons/default' // \u5f15\u5165\u7f16\u8f91\u5668\u56fe\u6807icon\uff0c\u4e0d\u5f15\u5165\u5219\u4e0d\u663e\u793a\u5bf9\u5e94\u56fe\u6807\n// \u5f15\u5165\u7f16\u8f91\u5668\u63d2\u4ef6\uff08\u57fa\u672c\u514d\u8d39\u63d2\u4ef6\u90fd\u5728\u8fd9\u513f\u4e86\uff09\nimport 'tinymce/plugins/advlist' // \u9ad8\u7ea7\u5217\u8868\nimport 'tinymce/plugins/autolink' // \u81ea\u52a8\u94fe\u63a5\nimport 'tinymce/plugins/link' // \u8d85\u94fe\u63a5\nimport 'tinymce/plugins/image' // \u63d2\u5165\u7f16\u8f91\u56fe\u7247\nimport 'tinymce/plugins/lists' // \u5217\u8868\u63d2\u4ef6\nimport 'tinymce/plugins/charmap' // \u7279\u6b8a\u5b57\u7b26\nimport 'tinymce/plugins/media' // \u63d2\u5165\u7f16\u8f91\u5a92\u4f53\nimport 'tinymce/plugins/wordcount' // \u5b57\u6570\u7edf\u8ba1\nimport 'tinymce/plugins/table' // \u8868\u683c\nimport 'tinymce/plugins/contextmenu' // contextmenu\nimport 'tinymce/plugins/directionality'\nimport 'tinymce/plugins/nonbreaking'\nimport 'tinymce/plugins/pagebreak'\nimport { mapState } from 'vuex'\nimport bus from '@/utils/bus'\nimport { uuid } from 'vue-uuid'\n\nexport default {\n  name: 'DeRichTextView',\n  components: {\n    Editor\n  },\n  props: {\n    scale: {\n      type: Number,\n      required: false,\n      default: 1\n    },\n    element: {\n      type: Object\n    },\n    dataRowSelect: {\n      type: Object\n    },\n    dataRowNameSelect: {\n      type: Object\n    },\n    editMode: {\n      type: String,\n      require: false,\n      default: 'preview'\n    },\n    active: {\n      type: Boolean,\n      require: false,\n      default: false\n    },\n    // \u662f\u5426\u7981\u7528\n    disabled: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      initReady: false,\n      editReady: false,\n      editShow: true,\n      canEdit: false,\n      // \u521d\u59cb\u5316\u914d\u7f6e\n      tinymceId: 'tinymce-view-' + this.element.id,\n      myValue: '',\n      init: {\n        selector: '#tinymce-view-' + this.element.id,\n        toolbar_items_size: 'small',\n        language_url: '/tinymce/langs/zh_CN.js', // \u6c49\u5316\u8def\u5f84\u662f\u81ea\u5b9a\u4e49\u7684\uff0c\u4e00\u822c\u653e\u5728public\u6216static\u91cc\u9762\n        language: 'zh_CN',\n        skin_url: '/tinymce/skins/ui/oxide', // \u76ae\u80a4\n        content_css: '/tinymce/skins/content/default/content.css',\n        plugins: 'advlist autolink link image lists charmap  media wordcount table contextmenu directionality pagebreak', // \u63d2\u4ef6\n        // \u5de5\u5177\u680f\n        toolbar: 'undo redo |fontselect fontsizeselect |forecolor backcolor bold italic |underline strikethrough link| formatselect |' +\n          'alignleft aligncenter alignright | bullist numlist |' +\n          ' blockquote subscript superscript removeformat | table image media | fullscreen ' +\n          '| bdmap indent2em lineheight formatpainter axupimgs',\n        toolbar_location: '/',\n        font_formats: '\u5fae\u8f6f\u96c5\u9ed1=Microsoft YaHei;\u5b8b\u4f53=SimSun;\u9ed1\u4f53=SimHei;\u4eff\u5b8b=FangSong;\u534e\u6587\u9ed1\u4f53=STHeiti;\u534e\u6587\u6977\u4f53=STKaiti;\u534e\u6587\u5b8b\u4f53=STSong;\u534e\u6587\u4eff\u5b8b=STFangsong;Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings',\n        fontsize_formats: '12px 14px 16px 18px 20px 22px 24px 28px 32px 36px 48px 56px 72px', // \u5b57\u4f53\u5927\u5c0f\n        menubar: false,\n        placeholder: '\u53cc\u51fb\u8f93\u5165\u6587\u5b57',\n        inline: true, // \u5f00\u542f\u5185\u8054\u6a21\u5f0f\n        branding: false\n      }\n    }\n  },\n  computed: {\n    editStatus() {\n      return this.editMode === 'edit' && !this.mobileLayoutStatus\n    },\n    autoStyle() {\n      return {\n        height: (100 / this.scale) + '%!important',\n        width: (100 / this.scale) + '%!important',\n        left: 50 * (1 - 1 / this.scale) + '%', // \u653e\u5927\u4f59\u91cf \u9664\u4ee5 2\n        top: 50 * (1 - 1 / this.scale) + '%',\n        transform: 'scale(' + this.scale + ')'\n      }\n    },\n    ...mapState([\n      'mobileLayoutStatus'\n    ])\n  },\n  watch: {\n    // \u76d1\u542c\u5185\u5bb9\u53d8\u5316\n    active(val) {\n      if (!val) {\n        const ed = tinymce.editors[this.tinymceId]\n        if (this.canEdit) {\n          this.element.propValue.textValue = ed.getContent()\n        }\n        this.canEdit = false\n        this.reShow()\n        this.myValue = this.assignment(this.element.propValue.textValue)\n        ed.setContent(this.myValue)\n      }\n    },\n    myValue(newValue) {\n      this.initReady && this.$store.commit('canvasChange')\n    }\n  },\n  mounted() {\n    this.viewInit()\n  },\n  beforeDestroy() {\n    bus.$off('fieldSelect-' + this.element.propValue.viewId)\n  },\n  methods: {\n    viewInit() {\n      bus.$on('fieldSelect-' + this.element.propValue.viewId, this.fieldSelect)\n      tinymce.init({})\n      this.myValue = this.assignment(this.element.propValue.textValue)\n      bus.$on('initCurFields-' + this.element.id, this.initCurFieldsChange)\n      this.$nextTick(() => {\n        this.initReady = true\n      })\n    },\n    initCurFieldsChange() {\n      if (!this.canEdit) {\n        this.myValue = this.assignment(this.element.propValue.textValue)\n      }\n    },\n    assignment(content) {\n      const _this = this\n      const on = content.match(/\\[(.+?)\\]/g)\n      if (on) {\n        on.forEach(itm => {\n          const ele = itm.slice(1, -1)\n          content = content.replace(itm, _this.dataRowNameSelect[ele] !== undefined ? _this.dataRowNameSelect[ele] : '[\u65e0\u6cd5\u83b7\u53d6\u5b57\u6bb5\u503c]')\n        })\n      }\n      content = content.replace('class=\"base-selected\"', '')\n      this.resetSelect()\n      return content\n    },\n    fieldSelect(field) {\n      const ed = tinymce.editors[this.tinymceId]\n      const fieldId = 'changeText-' + uuid.v1()\n      const value = '<span id=\"' + fieldId + '\"><span class=\"mceNonEditable\" contenteditable=\"false\" data-mce-content=\"[' + field.name + ']\">[' + field.name + ']</span></span>'\n      const attachValue = '<span id=\"attachValue\">&nbsp;</span>'\n      ed.insertContent(value)\n      ed.insertContent(attachValue)\n    },\n    onClick(e) {\n      const node = tinymce.activeEditor.selection.getNode()\n      this.resetSelect(node)\n    },\n    resetSelect(node) {\n      const edInner = tinymce.get(this.tinymceId)\n      if (edInner.dom) {\n        const nodeArray = edInner.dom.select('.base-selected')\n        if (nodeArray) {\n          nodeArray.forEach(nodeInner => {\n            nodeInner.removeAttribute('class')\n          })\n        }\n        if (node) {\n          const pNode = node.parentElement\n          if (pNode && pNode.id && pNode.id.indexOf('changeText') > -1) {\n            const innerId = '#' + pNode.id\n            const domTest = edInner.dom.select(innerId)[0]\n            domTest.setAttribute('class', 'base-selected')\n            edInner.selection.select(domTest)\n          }\n        }\n      }\n    },\n    setEdit() {\n      if (this.editStatus && this.canEdit === false) {\n        this.canEdit = true\n        this.element['editing'] = true\n        this.myValue = this.element.propValue.textValue\n        const ed = tinymce.editors[this.tinymceId]\n        ed.setContent(this.myValue)\n        this.reShow()\n      }\n    },\n    reShow() {\n      this.editShow = false\n      this.$nextTick(() => {\n        this.editShow = true\n      })\n    },\n    chartResize() {\n      // ignore\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.rich-main-class {\n  width: 100%;\n  height: 100%;\n  overflow-y: auto !important;\n  position: relative;\n}\n\n::-webkit-scrollbar {\n  width: 0px !important;\n  height: 0px !important;\n}\n\n::v-deep ol {\n  display: block !important;\n  list-style-type: decimal;\n  margin-block-start: 1em !important;\n  margin-block-end: 1em !important;\n  margin-inline-start: 0px !important;\n  margin-inline-end: 0px !important;\n  padding-inline-start: 40px !important;\n}\n\n::v-deep ul {\n  display: block !important;\n  list-style-type: disc;\n  margin-block-start: 1em !important;\n  margin-block-end: 1em !important;\n  margin-inline-start: 0px !important;\n  margin-inline-end: 0px !important;\n  padding-inline-start: 40px !important;\n}\n\n::v-deep li {\n  display: list-item !important;\n  text-align: -webkit-match-parent !important;\n}\n\n::v-deep .base-selected {\n  background-color: #b4d7ff\n}\n\n::v-deep p {\n  margin: 0px;\n  padding: 0px;\n}\n</style>\n\n", "<template>\n  <div\n    v-if=\"editStatus\"\n    class=\"v-text\"\n    @keydown=\"handleKeydown\"\n    @keyup=\"handleKeyup\"\n  >\n    <!-- tabindex >= 0 \u4f7f\u5f97\u53cc\u51fb\u65f6\u805a\u96c6\u8be5\u5143\u7d20 -->\n    <div\n      v-if=\"canEdit\"\n      ref=\"text\"\n      :contenteditable=\"canEdit\"\n      :class=\"{ canEdit }\"\n      :tabindex=\"element.id\"\n      :style=\"{ verticalAlign: element.style.verticalAlign }\"\n      @dblclick=\"setEdit\"\n      @paste=\"clearStyle\"\n      @mousedown=\"handleMousedown\"\n      @blur=\"handleBlur\"\n      @input=\"handleInput\"\n      v-html=\"element.propValue\"\n    />\n    <div\n      v-if=\"!canEdit\"\n      :style=\"{ verticalAlign: element.style.verticalAlign }\"\n      @dblclick=\"setEdit\"\n      @paste=\"clearStyle\"\n      @mousedown=\"handleMousedown\"\n      @blur=\"handleBlur\"\n      @input=\"handleInput\"\n      v-html=\"element.propValue\"\n    />\n  </div>\n  <div\n    v-else\n    class=\"v-text\"\n  >\n    <div\n      :style=\"{ verticalAlign: element.style.verticalAlign }\"\n      v-html=\"textInfo\"\n    />\n  </div>\n</template>\n\n<script>\nimport { keycodes } from '@/components/canvas/utils/shortcutKey.js'\nimport { mapState } from 'vuex'\n\nexport default {\n  props: {\n    propValue: {\n      type: String,\n      require: true\n    },\n    element: {\n      type: Object\n    },\n    editMode: {\n      type: String,\n      require: false,\n      default: 'preview'\n    },\n    active: {\n      type: Boolean,\n      require: false,\n      default: false\n    }\n\n  },\n  data() {\n    return {\n      canEdit: false,\n      ctrlKey: 17,\n      isCtrlDown: false\n    }\n  },\n  computed: {\n    editStatus() {\n      return this.editMode === 'edit' && !this.mobileLayoutStatus\n    },\n    textInfo() {\n      if (this.element && this.element.hyperlinks && this.element.hyperlinks.enable) {\n        return \"<a title='\" + this.element.hyperlinks.content + \"' target='\" + this.element.hyperlinks.openMode + \"' href='\" + this.element.hyperlinks.content + \"'>\" + this.element.propValue + '</a>'\n      } else {\n        return this.element.propValue\n      }\n    },\n    ...mapState([\n      'mobileLayoutStatus'\n    ])\n  },\n\n  watch: {\n    active: {\n      handler(newVal, oldVla) {\n        this.removeSelectText()\n      },\n      deep: true\n    }\n  },\n  methods: {\n    handleInput(e) {\n      this.$store.commit('canvasChange')\n      this.$emit('input', this.element, e.target.innerHTML)\n      this.$store.commit('canvasChange')\n    },\n\n    handleKeydown(e) {\n      if (e.keyCode === this.ctrlKey) {\n        this.isCtrlDown = true\n      } else if (this.isCtrlDown && this.canEdit && keycodes.includes(e.keyCode)) {\n        e.stopPropagation()\n      } else if (e.keyCode === 46) { // deleteKey\n        e.stopPropagation()\n      }\n    },\n\n    handleKeyup(e) {\n      if (e.keyCode === this.ctrlKey) {\n        this.isCtrlDown = false\n      }\n    },\n\n    handleMousedown(e) {\n      if (this.canEdit) {\n        e.stopPropagation()\n      }\n    },\n\n    clearStyle(e) {\n      e.preventDefault()\n      const clp = e.clipboardData\n      const text = clp.getData('text/plain') || ''\n      if (text !== '') {\n        document.execCommand('insertText', false, text)\n      }\n\n      this.$emit('input', this.element, e.target.innerHTML)\n    },\n\n    handleBlur(e) {\n      this.element.propValue = e.target.innerHTML || '&nbsp;'\n      this.canEdit = false\n    },\n\n    setEdit() {\n      this.canEdit = true\n      this.selectText(this.$refs.text)\n    },\n\n    selectText(element) {\n    },\n\n    removeSelectText() {\n      const selection = window.getSelection()\n      selection.removeAllRanges()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.v-text {\n  width: 100%;\n  height: 100%;\n  display: table;\n\n  div {\n    display: table-cell;\n    width: 100%;\n    height: 100%;\n    outline: none;\n\n  }\n\n  .canEdit {\n    cursor: text;\n    height: 100%;\n  }\n}\n\n::v-deep a:hover {\n  text-decoration: underline !important;\n  color: blue !important;\n}\n\n</style>\n", "import Vue from 'vue'\nimport Cookies from 'js-cookie'\nimport '@/styles/index.scss' // global css\nimport ElementUI from 'element-ui'\nimport Vuetify from 'vuetify'\nimport Fit2CloudUI from 'fit2cloud-ui'\n\nimport i18n from './lang' // internationalization\nimport App from './App'\nimport store from './store'\nimport router from './router'\nimport message from './utils/message'\nimport '@/icons' // icon\nimport '@/permission' // permission control\nimport api from '@/api/index.js'\nimport filter from '@/filter/filter'\nimport directives from './directive'\nimport VueClipboard from 'vue-clipboard2'\nimport widgets from '@/components/widget'\nimport Treeselect from '@riophae/vue-treeselect'\nimport '@riophae/vue-treeselect/dist/vue-treeselect.css'\nimport './utils/dialog'\nimport DeComplexInput from '@/components/business/conditionTable/DeComplexInput'\nimport DeComplexSelect from '@/components/business/conditionTable/DeComplexSelect'\nimport DeViewSelect from '@/components/deViewSelect'\nimport RemarkEditor from '@/views/chart/components/componentStyle/dialog/RemarkEditor'\nimport TitleRemark from '@/views/chart/view/TitleRemark'\nimport '@/components/canvas/customComponent' // \u6ce8\u518c\u81ea\u5b9a\u4e49\u7ec4\u4ef6\nimport deBtn from '@/components/deCustomCm/DeBtn.vue'\n\nimport '@/utils/DateUtil'\nimport draggable from 'vuedraggable'\nimport deWebsocket from '@/websocket'\nimport { GaodeMap } from '@antv/l7-maps'\nimport * as echarts from 'echarts'\nimport UmyUi from 'umy-ui'\n// \u5168\u5c4f\u63d2\u4ef6\nimport fullscreen from 'vue-fullscreen'\nimport VueFriendlyIframe from 'vue-friendly-iframe'\nimport vueToPdf from 'vue-to-pdf'\nimport VueVideoPlayer from 'vue-video-player'\nimport 'video.js/dist/video-js.css'\n// \u63a7\u5236\u6807\u7b7e\u5bbd\u9ad8\u6210\u6bd4\u4f8b\u7684\u6307\u4ee4\nimport proportion from 'vue-proportion-directive'\n\nVue.config.productionTip = false\nVue.use(VueClipboard)\nVue.use(widgets)\nVue.component('Draggable', draggable)\nVue.prototype.$api = api\n\nVue.prototype.$echarts = echarts\nVue.prototype.$gaodeMap = GaodeMap\n\nVue.use(UmyUi)\n\nVue.use(fullscreen)\n\nVue.use(VueFriendlyIframe)\nVue.use(Vuetify)\n// import TEditor from '@/components/Tinymce/index.vue'\n// Vue.component('TEditor', TEditor)\n\n/**\n * If you don't want to use mock-server\n * you want to use MockJs for mock api\n * you can execute: mockXHR()\n *\n * Currently MockJs will be used in the production environment,\n * please remove it before going online ! ! !\n */\nif (process.env.NODE_ENV === 'production') {\n//   const { mockXHR } = require('../mock')\n//   mockXHR()\n}\n\n// set ElementUI lang to EN\n// Vue.use(ElementUI, { locale })\n// \u5982\u679c\u60f3\u8981\u4e2d\u6587\u7248 element-ui\uff0c\u6309\u5982\u4e0b\u65b9\u5f0f\u58f0\u660e\nElementUI.Dialog.props.closeOnClickModal.default = false\nElementUI.Dialog.props.closeOnPressEscape.default = false\nVue.use(ElementUI, {\n  size: Cookies.get('size') || 'medium', // set element-ui default size\n  i18n: (key, value) => i18n.t(key, value)\n})\nVue.use(Fit2CloudUI, {\n  i18n: (key, value) => i18n.t(key, value)\n})\n// Vue.use(VueAxios, axios)\nVue.use(filter)\nVue.use(directives)\nVue.use(message)\nVue.component('Treeselect', Treeselect)\nVue.component('DeComplexInput', DeComplexInput)\nVue.component('DeComplexSelect', DeComplexSelect)\nVue.component('DeViewSelect', DeViewSelect)\nVue.component('RemarkEditor', RemarkEditor)\nVue.component('TitleRemark', TitleRemark)\nVue.component('DeBtn', deBtn)\n\nVue.config.productionTip = false\n\nVue.use(vueToPdf)\n\nVue.use(VueVideoPlayer)\n\nVue.use(proportion)\n\nVue.prototype.hasDataPermission = function(pTarget, pSource) {\n  if (this.$store.state.user.user.isAdmin) {\n    return true\n  }\n  if (pSource && pTarget) {\n    return pSource.indexOf(pTarget) > -1\n  }\n  return false\n}\n\nVue.prototype.checkPermission = function(pers) {\n  const permissions = store.getters.permissions\n  const hasPermission = pers.every(needP => {\n    const result = permissions.includes(needP)\n    return result\n  })\n  return hasPermission\n}\nVue.use(deWebsocket)\n\nVue.prototype.$currentHttpRequestList = new Map()\nVue.prototype.$cancelRequest = function(cancelkey) {\n  if (cancelkey) {\n    if (cancelkey.indexOf('/**') > -1) {\n      Vue.prototype.$currentHttpRequestList.forEach((item, key) => {\n        key.indexOf(cancelkey.split('/**')[0]) > -1 && item('Operation canceled by the user.')\n      })\n    } else {\n      Vue.prototype.$currentHttpRequestList.get(cancelkey) && Vue.prototype.$currentHttpRequestList.get(cancelkey)('Operation canceled by the user.')\n    }\n  }\n}\n\nnew Vue({\n\n  router,\n  store,\n  i18n,\n  render: h => h(App)\n}).$mount('#app')\n"], "fixing_code": ["{\n  \"name\": \"dataease\",\n  \"version\": \"1.18.3\",\n  \"description\": \"dataease front\",\n  \"private\": true,\n  \"scripts\": {\n    \"serve\": \"vue-cli-service serve\",\n    \"build\": \"vue-cli-service build\",\n    \"serves\": \"node --max_old_space_size=4096 node_modules/@vue/cli-service/bin/vue-cli-service.js build\",\n    \"build:prod\": \"vue-cli-service build\",\n    \"build:stage\": \"vue-cli-service build --mode staging\",\n    \"dll\": \"webpack -p --progress --config ./webpack.dll.conf.js\",\n    \"preview\": \"node build/index.js --preview\",\n    \"lint\": \"eslint --ext .js,.vue src --fix\",\n    \"lint-staged\": \"lint-staged\",\n    \"svgo\": \"svgo -f src/icons/svg --config=src/icons/svgo.yml\"\n  },\n  \"husky\": {\n    \"hooks\": {\n      \"pre-commit\": \"npm run lint-staged\"\n    }\n  },\n  \"lint-staged\": {\n    \"src/**/*.js\": \"eslint --ext .js\",\n    \"src/**/*.vue\": \"eslint --ext .vue\"\n  },\n  \"dependencies\": {\n    \"@antv/g2plot\": \"^2.4.9\",\n    \"@antv/l7\": \"2.8.31\",\n    \"@antv/l7-component\": \"2.8.31\",\n    \"@antv/l7-core\": \"2.8.31\",\n    \"@antv/l7-layers\": \"2.8.31\",\n    \"@antv/l7-maps\": \"2.8.31\",\n    \"@antv/l7-renderer\": \"2.8.31\",\n    \"@antv/l7-scene\": \"2.8.31\",\n    \"@antv/l7-source\": \"2.8.31\",\n    \"@antv/l7-utils\": \"2.8.31\",\n    \"@antv/s2\": \"1.35.0\",\n    \"@antv/util\": \"^2.0.17\",\n    \"@riophae/vue-treeselect\": \"0.4.0\",\n    \"@tinymce/tinymce-vue\": \"^3.2.8\",\n    \"axios\": \"^0.21.3\",\n    \"core-js\": \"^2.6.5\",\n    \"echarts\": \"^5.0.1\",\n    \"element-resize-detector\": \"^1.2.3\",\n    \"element-ui\": \"2.15.7\",\n    \"file-saver\": \"^2.0.5\",\n    \"fit2cloud-ui\": \"^1.8.0\",\n    \"flv.js\": \"^1.6.2\",\n    \"html2canvasde\": \"^v1.1.4-de\",\n    \"jquery\": \"^3.1.1\",\n    \"js-base64\": \"^3.7.2\",\n    \"js-cookie\": \"2.2.0\",\n    \"js-pinyin\": \"^0.1.9\",\n    \"jsencrypt\": \"^3.0.0-rc.1\",\n    \"jspdf\": \"^2.3.1\",\n    \"jszip\": \"^3.10.1\",\n    \"lodash\": \"^4.17.21\",\n    \"lodash.isboolean\": \"^3.0.3\",\n    \"lodash.isempty\": \"^4.4.0\",\n    \"lodash.isinteger\": \"^4.0.4\",\n    \"lodash.isnull\": \"^3.0.0\",\n    \"lodash.isnumber\": \"^3.0.3\",\n    \"lodash.isobject\": \"^3.0.2\",\n    \"lodash.isstring\": \"^4.0.1\",\n    \"normalize.css\": \"7.0.0\",\n    \"nprogress\": \"0.2.0\",\n    \"screenfull\": \"4.2.0\",\n    \"sockjs-client\": \"^1.6.0\",\n    \"stompjs\": \"^2.3.3\",\n    \"svg-sprite-loader\": \"4.1.3\",\n    \"svgo\": \"1.2.2\",\n    \"tinymce\": \"^5.8.2\",\n    \"umy-ui\": \"^1.1.6\",\n    \"vue\": \"2.6.10\",\n    \"vue-clipboard2\": \"0.3.1\",\n    \"vue-codemirror\": \"^4.0.6\",\n    \"vue-friendly-iframe\": \"^0.20.0\",\n    \"vue-fullscreen\": \"^2.5.2\",\n    \"vue-i18n\": \"7.3.2\",\n    \"vue-json-views\": \"^1.3.0\",\n    \"vue-proportion-directive\": \"^1.1.0\",\n    \"vue-router\": \"3.0.6\",\n    \"vue-to-pdf\": \"^1.0.0\",\n    \"vue-uuid\": \"2.0.2\",\n    \"vue-video-player\": \"^5.0.2\",\n    \"vue2-ace-editor\": \"0.0.15\",\n    \"vuedraggable\": \"^2.24.3\",\n    \"vuex\": \"3.1.0\",\n    \"webpack\": \"^4.46.0\",\n    \"xlsx\": \"^0.17.0\",\n    \"xss\": \"^1.0.14\"\n  },\n  \"devDependencies\": {\n    \"@babel/core\": \"^7.4.0-0\",\n    \"@babel/plugin-proposal-nullish-coalescing-operator\": \"^7.18.6\",\n    \"@babel/plugin-proposal-optional-chaining\": \"^7.18.6\",\n    \"@babel/register\": \"7.0.0\",\n    \"@vue/cli-plugin-babel\": \"3.6.0\",\n    \"@vue/cli-plugin-eslint\": \"^5.0.4\",\n    \"@vue/cli-service\": \"^3.3.1\",\n    \"add-asset-html-webpack-plugin\": \"^3.1.3\",\n    \"babel-eslint\": \"^10.1.0\",\n    \"chalk\": \"2.4.2\",\n    \"clean-webpack-plugin\": \"^1.0.1\",\n    \"connect\": \"3.6.6\",\n    \"copy-webpack-plugin\": \"^4.6.0\",\n    \"eslint\": \"^7.32.0\",\n    \"eslint-config-prettier\": \"^8.5.0\",\n    \"eslint-loader\": \"^4.0.2\",\n    \"eslint-plugin-prettier\": \"^4.0.0\",\n    \"eslint-plugin-vue\": \"^9.1.0\",\n    \"html-webpack-plugin\": \"3.2.0\",\n    \"husky\": \"^8.0.1\",\n    \"less\": \"^3.0.0\",\n    \"less-loader\": \"^5.0.0\",\n    \"lint-staged\": \"^13.0.1\",\n    \"mockjs\": \"1.0.1-beta3\",\n    \"runjs\": \"^4.1.3\",\n    \"sass\": \"^1.33.0\",\n    \"sass-loader\": \"^7.1.0\",\n    \"script-ext-html-webpack-plugin\": \"2.1.3\",\n    \"script-loader\": \"^0.7.2\",\n    \"serve-static\": \"^1.13.2\",\n    \"vue-template-compiler\": \"2.6.10\",\n    \"vuetify\": \"^2.6.6\",\n    \"webpack-cli\": \"^3.2.3\"\n  },\n  \"engines\": {\n    \"node\": \">=8.9\",\n    \"npm\": \">= 3.0.0\"\n  },\n  \"browserslist\": [\n    \"> 1%\",\n    \"last 2 versions\"\n  ]\n}\n", "<template>\n  <div\n    class=\"rich-main-class\"\n    :style=\"autoStyle\"\n    @dblclick=\"setEdit\"\n  >\n    <Editor\n      v-if=\"editShow\"\n      :id=\"tinymceId\"\n      v-model=\"myValue\"\n      style=\"width: 100%;height: 100%\"\n      :init=\"init\"\n      :disabled=\"!canEdit\"\n      @onClick=\"onClick\"\n    />\n  </div>\n</template>\n\n<script>\nimport tinymce from 'tinymce/tinymce' // tinymce\u9ed8\u8ba4hidden\uff0c\u4e0d\u5f15\u5165\u4e0d\u663e\u793a\nimport Editor from '@tinymce/tinymce-vue' // \u7f16\u8f91\u5668\u5f15\u5165\nimport 'tinymce/themes/silver/theme' // \u7f16\u8f91\u5668\u4e3b\u9898\nimport 'tinymce/icons/default' // \u5f15\u5165\u7f16\u8f91\u5668\u56fe\u6807icon\uff0c\u4e0d\u5f15\u5165\u5219\u4e0d\u663e\u793a\u5bf9\u5e94\u56fe\u6807\n// \u5f15\u5165\u7f16\u8f91\u5668\u63d2\u4ef6\uff08\u57fa\u672c\u514d\u8d39\u63d2\u4ef6\u90fd\u5728\u8fd9\u513f\u4e86\uff09\nimport 'tinymce/plugins/advlist' // \u9ad8\u7ea7\u5217\u8868\nimport 'tinymce/plugins/autolink' // \u81ea\u52a8\u94fe\u63a5\nimport 'tinymce/plugins/link' // \u8d85\u94fe\u63a5\nimport 'tinymce/plugins/image' // \u63d2\u5165\u7f16\u8f91\u56fe\u7247\nimport 'tinymce/plugins/lists' // \u5217\u8868\u63d2\u4ef6\nimport 'tinymce/plugins/charmap' // \u7279\u6b8a\u5b57\u7b26\nimport 'tinymce/plugins/media' // \u63d2\u5165\u7f16\u8f91\u5a92\u4f53\nimport 'tinymce/plugins/wordcount' // \u5b57\u6570\u7edf\u8ba1\nimport 'tinymce/plugins/table' // \u8868\u683c\nimport 'tinymce/plugins/contextmenu' // contextmenu\nimport 'tinymce/plugins/directionality'\nimport 'tinymce/plugins/nonbreaking'\nimport 'tinymce/plugins/pagebreak'\nimport { mapState } from 'vuex'\nimport Vue from 'vue'\nimport xssCheck from 'xss'\n\nexport default {\n  name: 'DeRichText',\n  components: {\n    Editor\n  },\n  props: {\n    terminal: {\n      type: String,\n      default: 'pc'\n    },\n    propValue: {\n      type: String,\n      require: true\n    },\n    element: {\n      type: Object\n    },\n    editMode: {\n      type: String,\n      require: false,\n      default: 'preview'\n    },\n    active: {\n      type: Boolean,\n      require: false,\n      default: false\n    },\n    // \u662f\u5426\u7981\u7528\n    disabled: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      editShow: true,\n      canEdit: false,\n      // \u521d\u59cb\u5316\u914d\u7f6e\n      tinymceId: 'tinymce-' + this.element.id,\n      myValue: xssCheck(this.propValue),\n      init: {\n        selector: '#tinymce-' + this.element.id,\n        toolbar_items_size: 'small',\n        language_url: '/tinymce/langs/zh_CN.js', // \u6c49\u5316\u8def\u5f84\u662f\u81ea\u5b9a\u4e49\u7684\uff0c\u4e00\u822c\u653e\u5728public\u6216static\u91cc\u9762\n        language: 'zh_CN',\n        skin_url: '/tinymce/skins/ui/oxide', // \u76ae\u80a4\n        content_css: '/tinymce/skins/content/default/content.css',\n        plugins: 'advlist autolink link image lists charmap  media wordcount table contextmenu directionality pagebreak', // \u63d2\u4ef6\n        // \u5de5\u5177\u680f\n        toolbar: 'undo redo |fontselect fontsizeselect |forecolor backcolor bold italic |underline strikethrough link| formatselect |' +\n          'alignleft aligncenter alignright | bullist numlist |' +\n          ' blockquote subscript superscript removeformat | table image media | fullscreen ' +\n          '| bdmap indent2em lineheight formatpainter axupimgs',\n        toolbar_location: '/',\n        font_formats: '\u5fae\u8f6f\u96c5\u9ed1=Microsoft YaHei;\u5b8b\u4f53=SimSun;\u9ed1\u4f53=SimHei;\u4eff\u5b8b=FangSong;\u534e\u6587\u9ed1\u4f53=STHeiti;\u534e\u6587\u6977\u4f53=STKaiti;\u534e\u6587\u5b8b\u4f53=STSong;\u534e\u6587\u4eff\u5b8b=STFangsong;Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings',\n        fontsize_formats: '12px 14px 16px 18px 20px 22px 24px 28px 32px 36px 48px 56px 72px', // \u5b57\u4f53\u5927\u5c0f\n        menubar: false,\n        placeholder: '\u53cc\u51fb\u8f93\u5165\u6587\u5b57',\n        inline: true, // \u5f00\u542f\u5185\u8054\u6a21\u5f0f\n        branding: false\n      }\n    }\n  },\n  computed: {\n    scale() {\n      return Math.min(this.previewCanvasScale.scalePointWidth, this.previewCanvasScale.scalePointHeight) * this.scaleCoefficient\n    },\n    editStatus() {\n      return this.editMode === 'edit' && !this.mobileLayoutStatus\n    },\n    autoStyle() {\n      return {\n        height: (100 / this.scale) + '%!important',\n        width: (100 / this.scale) + '%!important',\n        left: 50 * (1 - 1 / this.scale) + '%', // \u653e\u5927\u4f59\u91cf \u9664\u4ee5 2\n        top: 50 * (1 - 1 / this.scale) + '%',\n        transform: 'scale(' + this.scale + ')'\n      }\n    },\n    scaleCoefficient() {\n      if (this.terminal === 'pc' && !this.mobileLayoutStatus) {\n        return 1.1\n      } else {\n        return 4.5\n      }\n    },\n    ...mapState([\n      'mobileLayoutStatus',\n      'previewCanvasScale'\n    ])\n  },\n  watch: {\n    // \u76d1\u542c\u5185\u5bb9\u53d8\u5316\n    active(val) {\n      if (!val) {\n        this.canEdit = false\n        this.reShow()\n      }\n    },\n    // \u76d1\u542c\u5185\u5bb9\u53d8\u5316\n    propValue(newValue) {\n      this.myValue = (newValue == null ? '' : newValue)\n    },\n    myValue(newValue) {\n      this.element.propValue = newValue\n      this.$store.commit('canvasChange')\n    }\n  },\n  mounted() {\n    tinymce.init({})\n  },\n  methods: {\n    onClick(e) {\n      this.$emit('onClick', e, tinymce)\n    },\n    setEdit() {\n      if (this.editStatus) {\n        this.canEdit = true\n        Vue.set(this.element, 'editing', true)\n        this.reShow()\n      }\n    },\n    reShow() {\n      this.editShow = false\n      this.$nextTick(() => {\n        this.editShow = true\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.rich-main-class {\n  width: 100%;\n  height: 100%;\n  overflow-y: auto !important;\n  position: relative;\n}\n\n::-webkit-scrollbar {\n  width: 0px !important;\n  height: 0px !important;\n}\n\n::v-deep ol {\n  display: block !important;\n  list-style-type: decimal;\n  margin-block-start: 1em !important;\n  margin-block-end: 1em !important;\n  margin-inline-start: 0px !important;\n  margin-inline-end: 0px !important;\n  padding-inline-start: 40px !important;\n}\n\n::v-deep ul {\n  display: block !important;\n  list-style-type: disc;\n  margin-block-start: 1em !important;\n  margin-block-end: 1em !important;\n  margin-inline-start: 0px !important;\n  margin-inline-end: 0px !important;\n  padding-inline-start: 40px !important;\n}\n\n::v-deep li {\n  display: list-item !important;\n  text-align: -webkit-match-parent !important;\n}\n\n::v-deep p {\n  margin: 0px;\n  padding: 0px;\n}\n</style>\n\n", "<template>\n  <div\n    class=\"rich-main-class\"\n    :style=\"autoStyle\"\n    @dblclick=\"setEdit\"\n  >\n    <Editor\n      v-if=\"editShow\"\n      :id=\"tinymceId\"\n      v-model=\"myValue\"\n      style=\"width: 100%;height: 100%\"\n      :init=\"init\"\n      :disabled=\"!canEdit\"\n      @onClick=\"onClick\"\n    />\n  </div>\n</template>\n\n<script>\nimport tinymce from 'tinymce/tinymce' // tinymce\u9ed8\u8ba4hidden\uff0c\u4e0d\u5f15\u5165\u4e0d\u663e\u793a\nimport Editor from '@tinymce/tinymce-vue' // \u7f16\u8f91\u5668\u5f15\u5165\nimport 'tinymce/themes/silver/theme' // \u7f16\u8f91\u5668\u4e3b\u9898\nimport 'tinymce/icons/default' // \u5f15\u5165\u7f16\u8f91\u5668\u56fe\u6807icon\uff0c\u4e0d\u5f15\u5165\u5219\u4e0d\u663e\u793a\u5bf9\u5e94\u56fe\u6807\n// \u5f15\u5165\u7f16\u8f91\u5668\u63d2\u4ef6\uff08\u57fa\u672c\u514d\u8d39\u63d2\u4ef6\u90fd\u5728\u8fd9\u513f\u4e86\uff09\nimport 'tinymce/plugins/advlist' // \u9ad8\u7ea7\u5217\u8868\nimport 'tinymce/plugins/autolink' // \u81ea\u52a8\u94fe\u63a5\nimport 'tinymce/plugins/link' // \u8d85\u94fe\u63a5\nimport 'tinymce/plugins/image' // \u63d2\u5165\u7f16\u8f91\u56fe\u7247\nimport 'tinymce/plugins/lists' // \u5217\u8868\u63d2\u4ef6\nimport 'tinymce/plugins/charmap' // \u7279\u6b8a\u5b57\u7b26\nimport 'tinymce/plugins/media' // \u63d2\u5165\u7f16\u8f91\u5a92\u4f53\nimport 'tinymce/plugins/wordcount' // \u5b57\u6570\u7edf\u8ba1\nimport 'tinymce/plugins/table' // \u8868\u683c\nimport 'tinymce/plugins/contextmenu' // contextmenu\nimport 'tinymce/plugins/directionality'\nimport 'tinymce/plugins/nonbreaking'\nimport 'tinymce/plugins/pagebreak'\nimport { mapState } from 'vuex'\nimport bus from '@/utils/bus'\nimport { uuid } from 'vue-uuid'\nimport xssCheck from 'xss'\n\nexport default {\n  name: 'DeRichTextView',\n  components: {\n    Editor\n  },\n  props: {\n    scale: {\n      type: Number,\n      required: false,\n      default: 1\n    },\n    element: {\n      type: Object\n    },\n    dataRowSelect: {\n      type: Object\n    },\n    dataRowNameSelect: {\n      type: Object\n    },\n    editMode: {\n      type: String,\n      require: false,\n      default: 'preview'\n    },\n    active: {\n      type: Boolean,\n      require: false,\n      default: false\n    },\n    // \u662f\u5426\u7981\u7528\n    disabled: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      initReady: false,\n      editReady: false,\n      editShow: true,\n      canEdit: false,\n      // \u521d\u59cb\u5316\u914d\u7f6e\n      tinymceId: 'tinymce-view-' + this.element.id,\n      myValue: '',\n      init: {\n        selector: '#tinymce-view-' + this.element.id,\n        toolbar_items_size: 'small',\n        language_url: '/tinymce/langs/zh_CN.js', // \u6c49\u5316\u8def\u5f84\u662f\u81ea\u5b9a\u4e49\u7684\uff0c\u4e00\u822c\u653e\u5728public\u6216static\u91cc\u9762\n        language: 'zh_CN',\n        skin_url: '/tinymce/skins/ui/oxide', // \u76ae\u80a4\n        content_css: '/tinymce/skins/content/default/content.css',\n        plugins: 'advlist autolink link image lists charmap  media wordcount table contextmenu directionality pagebreak', // \u63d2\u4ef6\n        // \u5de5\u5177\u680f\n        toolbar: 'undo redo |fontselect fontsizeselect |forecolor backcolor bold italic |underline strikethrough link| formatselect |' +\n          'alignleft aligncenter alignright | bullist numlist |' +\n          ' blockquote subscript superscript removeformat | table image media | fullscreen ' +\n          '| bdmap indent2em lineheight formatpainter axupimgs',\n        toolbar_location: '/',\n        font_formats: '\u5fae\u8f6f\u96c5\u9ed1=Microsoft YaHei;\u5b8b\u4f53=SimSun;\u9ed1\u4f53=SimHei;\u4eff\u5b8b=FangSong;\u534e\u6587\u9ed1\u4f53=STHeiti;\u534e\u6587\u6977\u4f53=STKaiti;\u534e\u6587\u5b8b\u4f53=STSong;\u534e\u6587\u4eff\u5b8b=STFangsong;Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings',\n        fontsize_formats: '12px 14px 16px 18px 20px 22px 24px 28px 32px 36px 48px 56px 72px', // \u5b57\u4f53\u5927\u5c0f\n        menubar: false,\n        placeholder: '\u53cc\u51fb\u8f93\u5165\u6587\u5b57',\n        inline: true, // \u5f00\u542f\u5185\u8054\u6a21\u5f0f\n        branding: false\n      }\n    }\n  },\n  computed: {\n    editStatus() {\n      return this.editMode === 'edit' && !this.mobileLayoutStatus\n    },\n    autoStyle() {\n      return {\n        height: (100 / this.scale) + '%!important',\n        width: (100 / this.scale) + '%!important',\n        left: 50 * (1 - 1 / this.scale) + '%', // \u653e\u5927\u4f59\u91cf \u9664\u4ee5 2\n        top: 50 * (1 - 1 / this.scale) + '%',\n        transform: 'scale(' + this.scale + ')'\n      }\n    },\n    ...mapState([\n      'mobileLayoutStatus'\n    ])\n  },\n  watch: {\n    // \u76d1\u542c\u5185\u5bb9\u53d8\u5316\n    active(val) {\n      if (!val) {\n        const ed = tinymce.editors[this.tinymceId]\n        if (this.canEdit) {\n          this.element.propValue.textValue = ed.getContent()\n        }\n        this.canEdit = false\n        this.reShow()\n        this.myValue = this.assignment(this.element.propValue.textValue)\n        ed.setContent(this.myValue)\n      }\n    },\n    myValue(newValue) {\n      this.initReady && this.$store.commit('canvasChange')\n    }\n  },\n  mounted() {\n    this.viewInit()\n  },\n  beforeDestroy() {\n    bus.$off('fieldSelect-' + this.element.propValue.viewId)\n  },\n  methods: {\n    viewInit() {\n      bus.$on('fieldSelect-' + this.element.propValue.viewId, this.fieldSelect)\n      tinymce.init({})\n      this.myValue = xssCheck(this.assignment(this.element.propValue.textValue))\n      bus.$on('initCurFields-' + this.element.id, this.initCurFieldsChange)\n      this.$nextTick(() => {\n        this.initReady = true\n      })\n    },\n    initCurFieldsChange() {\n      if (!this.canEdit) {\n        this.myValue = this.assignment(this.element.propValue.textValue)\n      }\n    },\n    assignment(content) {\n      const _this = this\n      const on = content.match(/\\[(.+?)\\]/g)\n      if (on) {\n        on.forEach(itm => {\n          const ele = itm.slice(1, -1)\n          content = content.replace(itm, _this.dataRowNameSelect[ele] !== undefined ? _this.dataRowNameSelect[ele] : '[\u65e0\u6cd5\u83b7\u53d6\u5b57\u6bb5\u503c]')\n        })\n      }\n      content = content.replace('class=\"base-selected\"', '')\n      this.resetSelect()\n      return content\n    },\n    fieldSelect(field) {\n      const ed = tinymce.editors[this.tinymceId]\n      const fieldId = 'changeText-' + uuid.v1()\n      const value = '<span id=\"' + fieldId + '\"><span class=\"mceNonEditable\" contenteditable=\"false\" data-mce-content=\"[' + field.name + ']\">[' + field.name + ']</span></span>'\n      const attachValue = '<span id=\"attachValue\">&nbsp;</span>'\n      ed.insertContent(value)\n      ed.insertContent(attachValue)\n    },\n    onClick(e) {\n      const node = tinymce.activeEditor.selection.getNode()\n      this.resetSelect(node)\n    },\n    resetSelect(node) {\n      const edInner = tinymce.get(this.tinymceId)\n      if (edInner.dom) {\n        const nodeArray = edInner.dom.select('.base-selected')\n        if (nodeArray) {\n          nodeArray.forEach(nodeInner => {\n            nodeInner.removeAttribute('class')\n          })\n        }\n        if (node) {\n          const pNode = node.parentElement\n          if (pNode && pNode.id && pNode.id.indexOf('changeText') > -1) {\n            const innerId = '#' + pNode.id\n            const domTest = edInner.dom.select(innerId)[0]\n            domTest.setAttribute('class', 'base-selected')\n            edInner.selection.select(domTest)\n          }\n        }\n      }\n    },\n    setEdit() {\n      if (this.editStatus && this.canEdit === false) {\n        this.canEdit = true\n        this.element['editing'] = true\n        this.myValue = this.element.propValue.textValue\n        const ed = tinymce.editors[this.tinymceId]\n        ed.setContent(this.myValue)\n        this.reShow()\n      }\n    },\n    reShow() {\n      this.editShow = false\n      this.$nextTick(() => {\n        this.editShow = true\n      })\n    },\n    chartResize() {\n      // ignore\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.rich-main-class {\n  width: 100%;\n  height: 100%;\n  overflow-y: auto !important;\n  position: relative;\n}\n\n::-webkit-scrollbar {\n  width: 0px !important;\n  height: 0px !important;\n}\n\n::v-deep ol {\n  display: block !important;\n  list-style-type: decimal;\n  margin-block-start: 1em !important;\n  margin-block-end: 1em !important;\n  margin-inline-start: 0px !important;\n  margin-inline-end: 0px !important;\n  padding-inline-start: 40px !important;\n}\n\n::v-deep ul {\n  display: block !important;\n  list-style-type: disc;\n  margin-block-start: 1em !important;\n  margin-block-end: 1em !important;\n  margin-inline-start: 0px !important;\n  margin-inline-end: 0px !important;\n  padding-inline-start: 40px !important;\n}\n\n::v-deep li {\n  display: list-item !important;\n  text-align: -webkit-match-parent !important;\n}\n\n::v-deep .base-selected {\n  background-color: #b4d7ff\n}\n\n::v-deep p {\n  margin: 0px;\n  padding: 0px;\n}\n</style>\n\n", "<template>\n  <div\n    v-if=\"editStatus\"\n    class=\"v-text\"\n    @keydown=\"handleKeydown\"\n    @keyup=\"handleKeyup\"\n  >\n    <!-- tabindex >= 0 \u4f7f\u5f97\u53cc\u51fb\u65f6\u805a\u96c6\u8be5\u5143\u7d20 -->\n    <div\n      v-if=\"canEdit\"\n      ref=\"text\"\n      :contenteditable=\"canEdit\"\n      :class=\"{ canEdit }\"\n      :tabindex=\"element.id\"\n      :style=\"{ verticalAlign: element.style.verticalAlign }\"\n      @dblclick=\"setEdit\"\n      @paste=\"clearStyle\"\n      @mousedown=\"handleMousedown\"\n      @blur=\"handleBlur\"\n      @input=\"handleInput\"\n      v-html=\"$xss(element.propValue)\"\n    />\n    <div\n      v-if=\"!canEdit\"\n      :style=\"{ verticalAlign: element.style.verticalAlign }\"\n      @dblclick=\"setEdit\"\n      @paste=\"clearStyle\"\n      @mousedown=\"handleMousedown\"\n      @blur=\"handleBlur\"\n      @input=\"handleInput\"\n      v-html=\"$xss(element.propValue)\"\n    />\n  </div>\n  <div\n    v-else\n    class=\"v-text\"\n  >\n    <div\n      :style=\"{ verticalAlign: element.style.verticalAlign }\"\n      v-html=\"$xss(textInfo)\"\n    />\n  </div>\n</template>\n\n<script>\nimport { keycodes } from '@/components/canvas/utils/shortcutKey.js'\nimport { mapState } from 'vuex'\n\nexport default {\n  props: {\n    propValue: {\n      type: String,\n      require: true\n    },\n    element: {\n      type: Object\n    },\n    editMode: {\n      type: String,\n      require: false,\n      default: 'preview'\n    },\n    active: {\n      type: Boolean,\n      require: false,\n      default: false\n    }\n\n  },\n  data() {\n    return {\n      canEdit: false,\n      ctrlKey: 17,\n      isCtrlDown: false\n    }\n  },\n  computed: {\n    editStatus() {\n      return this.editMode === 'edit' && !this.mobileLayoutStatus\n    },\n    textInfo() {\n      if (this.element && this.element.hyperlinks && this.element.hyperlinks.enable) {\n        return '<a title=\\'' + this.element.hyperlinks.content + '\\' target=\\'' + this.element.hyperlinks.openMode + '\\' href=\\'' + this.element.hyperlinks.content + '\\'>' + this.element.propValue + '</a>'\n      } else {\n        return this.element.propValue\n      }\n    },\n    ...mapState([\n      'mobileLayoutStatus'\n    ])\n  },\n\n  watch: {\n    active: {\n      handler(newVal, oldVla) {\n        this.removeSelectText()\n      },\n      deep: true\n    }\n  },\n  methods: {\n    handleInput(e) {\n      this.$store.commit('canvasChange')\n      this.$emit('input', this.element, e.target.innerHTML)\n      this.$store.commit('canvasChange')\n    },\n\n    handleKeydown(e) {\n      if (e.keyCode === this.ctrlKey) {\n        this.isCtrlDown = true\n      } else if (this.isCtrlDown && this.canEdit && keycodes.includes(e.keyCode)) {\n        e.stopPropagation()\n      } else if (e.keyCode === 46) { // deleteKey\n        e.stopPropagation()\n      }\n    },\n\n    handleKeyup(e) {\n      if (e.keyCode === this.ctrlKey) {\n        this.isCtrlDown = false\n      }\n    },\n\n    handleMousedown(e) {\n      if (this.canEdit) {\n        e.stopPropagation()\n      }\n    },\n\n    clearStyle(e) {\n      e.preventDefault()\n      const clp = e.clipboardData\n      const text = clp.getData('text/plain') || ''\n      if (text !== '') {\n        document.execCommand('insertText', false, text)\n      }\n\n      this.$emit('input', this.element, e.target.innerHTML)\n    },\n\n    handleBlur(e) {\n      this.element.propValue = e.target.innerHTML || '&nbsp;'\n      this.canEdit = false\n    },\n\n    setEdit() {\n      this.canEdit = true\n      this.selectText(this.$refs.text)\n    },\n\n    selectText(element) {\n    },\n\n    removeSelectText() {\n      const selection = window.getSelection()\n      selection.removeAllRanges()\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.v-text {\n  width: 100%;\n  height: 100%;\n  display: table;\n\n  div {\n    display: table-cell;\n    width: 100%;\n    height: 100%;\n    outline: none;\n\n  }\n\n  .canEdit {\n    cursor: text;\n    height: 100%;\n  }\n}\n\n::v-deep a:hover {\n  text-decoration: underline !important;\n  color: blue !important;\n}\n\n</style>\n", "import Vue from 'vue'\nimport Cookies from 'js-cookie'\nimport '@/styles/index.scss' // global css\nimport ElementUI from 'element-ui'\nimport Vuetify from 'vuetify'\nimport Fit2CloudUI from 'fit2cloud-ui'\n\nimport i18n from './lang' // internationalization\nimport App from './App'\nimport store from './store'\nimport router from './router'\nimport message from './utils/message'\nimport '@/icons' // icon\nimport '@/permission' // permission control\nimport api from '@/api/index.js'\nimport filter from '@/filter/filter'\nimport directives from './directive'\nimport VueClipboard from 'vue-clipboard2'\nimport widgets from '@/components/widget'\nimport Treeselect from '@riophae/vue-treeselect'\nimport '@riophae/vue-treeselect/dist/vue-treeselect.css'\nimport './utils/dialog'\nimport DeComplexInput from '@/components/business/conditionTable/DeComplexInput'\nimport DeComplexSelect from '@/components/business/conditionTable/DeComplexSelect'\nimport DeViewSelect from '@/components/deViewSelect'\nimport RemarkEditor from '@/views/chart/components/componentStyle/dialog/RemarkEditor'\nimport TitleRemark from '@/views/chart/view/TitleRemark'\nimport '@/components/canvas/customComponent' // \u6ce8\u518c\u81ea\u5b9a\u4e49\u7ec4\u4ef6\nimport deBtn from '@/components/deCustomCm/DeBtn.vue'\n\nimport '@/utils/DateUtil'\nimport draggable from 'vuedraggable'\nimport deWebsocket from '@/websocket'\nimport { GaodeMap } from '@antv/l7-maps'\nimport * as echarts from 'echarts'\nimport UmyUi from 'umy-ui'\n// \u5168\u5c4f\u63d2\u4ef6\nimport fullscreen from 'vue-fullscreen'\nimport VueFriendlyIframe from 'vue-friendly-iframe'\nimport vueToPdf from 'vue-to-pdf'\nimport VueVideoPlayer from 'vue-video-player'\nimport 'video.js/dist/video-js.css'\n// \u63a7\u5236\u6807\u7b7e\u5bbd\u9ad8\u6210\u6bd4\u4f8b\u7684\u6307\u4ee4\nimport proportion from 'vue-proportion-directive'\n\nimport xss from 'xss'\n// \u5b9a\u4e49\u5168\u5c40XSS\u89e3\u51b3\u65b9\u6cd5\nObject.defineProperty(Vue.prototype, '$xss', {\n  value: xss\n})\n\nVue.config.productionTip = false\nVue.use(VueClipboard)\nVue.use(widgets)\nVue.component('Draggable', draggable)\nVue.prototype.$api = api\n\nVue.prototype.$echarts = echarts\nVue.prototype.$gaodeMap = GaodeMap\n\nVue.use(UmyUi)\n\nVue.use(fullscreen)\n\nVue.use(VueFriendlyIframe)\nVue.use(Vuetify)\n// import TEditor from '@/components/Tinymce/index.vue'\n// Vue.component('TEditor', TEditor)\n\n/**\n * If you don't want to use mock-server\n * you want to use MockJs for mock api\n * you can execute: mockXHR()\n *\n * Currently MockJs will be used in the production environment,\n * please remove it before going online ! ! !\n */\nif (process.env.NODE_ENV === 'production') {\n//   const { mockXHR } = require('../mock')\n//   mockXHR()\n}\n\n// set ElementUI lang to EN\n// Vue.use(ElementUI, { locale })\n// \u5982\u679c\u60f3\u8981\u4e2d\u6587\u7248 element-ui\uff0c\u6309\u5982\u4e0b\u65b9\u5f0f\u58f0\u660e\nElementUI.Dialog.props.closeOnClickModal.default = false\nElementUI.Dialog.props.closeOnPressEscape.default = false\nVue.use(ElementUI, {\n  size: Cookies.get('size') || 'medium', // set element-ui default size\n  i18n: (key, value) => i18n.t(key, value)\n})\nVue.use(Fit2CloudUI, {\n  i18n: (key, value) => i18n.t(key, value)\n})\n// Vue.use(VueAxios, axios)\nVue.use(filter)\nVue.use(directives)\nVue.use(message)\nVue.component('Treeselect', Treeselect)\nVue.component('DeComplexInput', DeComplexInput)\nVue.component('DeComplexSelect', DeComplexSelect)\nVue.component('DeViewSelect', DeViewSelect)\nVue.component('RemarkEditor', RemarkEditor)\nVue.component('TitleRemark', TitleRemark)\nVue.component('DeBtn', deBtn)\n\nVue.config.productionTip = false\n\nVue.use(vueToPdf)\n\nVue.use(VueVideoPlayer)\n\nVue.use(proportion)\n\nVue.prototype.hasDataPermission = function(pTarget, pSource) {\n  if (this.$store.state.user.user.isAdmin) {\n    return true\n  }\n  if (pSource && pTarget) {\n    return pSource.indexOf(pTarget) > -1\n  }\n  return false\n}\n\nVue.prototype.checkPermission = function(pers) {\n  const permissions = store.getters.permissions\n  const hasPermission = pers.every(needP => {\n    const result = permissions.includes(needP)\n    return result\n  })\n  return hasPermission\n}\nVue.use(deWebsocket)\n\nVue.prototype.$currentHttpRequestList = new Map()\nVue.prototype.$cancelRequest = function(cancelkey) {\n  if (cancelkey) {\n    if (cancelkey.indexOf('/**') > -1) {\n      Vue.prototype.$currentHttpRequestList.forEach((item, key) => {\n        key.indexOf(cancelkey.split('/**')[0]) > -1 && item('Operation canceled by the user.')\n      })\n    } else {\n      Vue.prototype.$currentHttpRequestList.get(cancelkey) && Vue.prototype.$currentHttpRequestList.get(cancelkey)('Operation canceled by the user.')\n    }\n  }\n}\n\nnew Vue({\n\n  router,\n  store,\n  i18n,\n  render: h => h(App)\n}).$mount('#app')\n"], "filenames": ["frontend/package.json", "frontend/src/components/canvas/customComponent/DeRichText.vue", "frontend/src/components/canvas/customComponent/DeRichTextView.vue", "frontend/src/components/canvas/customComponent/VText.vue", "frontend/src/main.js"], "buggy_code_start_loc": [91, 39, 40, 21, 44], "buggy_code_end_loc": [92, 81, 156, 84, 44], "fixing_code_start_loc": [91, 40, 41, 21, 45], "fixing_code_end_loc": [93, 82, 157, 84, 51], "type": "CWE-79", "message": "DataEase is an open source data visualization and analysis tool. When saving a dashboard on the DataEase platform saved data can be modified and store malicious code. This vulnerability can lead to the execution of malicious code stored by the attacker on the server side when the user accesses the dashboard. The vulnerability has been fixed in version 1.18.3.", "other": {"cve": {"id": "CVE-2023-25807", "sourceIdentifier": "security-advisories@github.com", "published": "2023-02-28T16:15:09.353", "lastModified": "2023-03-07T22:57:52.003", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "DataEase is an open source data visualization and analysis tool. When saving a dashboard on the DataEase platform saved data can be modified and store malicious code. This vulnerability can lead to the execution of malicious code stored by the attacker on the server side when the user accesses the dashboard. The vulnerability has been fixed in version 1.18.3."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 7.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:dataease:dataease:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.18.3", "matchCriteriaId": "6F420A41-D962-4B89-A618-07F61FDDAF3A"}]}]}], "references": [{"url": "https://github.com/dataease/dataease/commit/cc94fb8e69ddbb37c96d02ec0f0ddcd74273ef49", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/dataease/dataease/security/advisories/GHSA-xj3h-3wmw-j5vf", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/dataease/dataease/commit/cc94fb8e69ddbb37c96d02ec0f0ddcd74273ef49"}}