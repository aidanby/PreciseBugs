{"buggy_code": ["<?php\r\n/***************************************************************\r\n*  Copyright notice\r\n*\r\n*  (c) 2010 Marc Hoersken <info@marc-hoersken.de>\r\n*  All rights reserved\r\n*\r\n*  This script is part of the TYPO3 project. The TYPO3 project is\r\n*  free software; you can redistribute it and/or modify\r\n*  it under the terms of the GNU General Public License as published by\r\n*  the Free Software Foundation; either version 2 of the License, or\r\n*  (at your option) any later version.\r\n*\r\n*  The GNU General Public License can be found at\r\n*  http://www.gnu.org/copyleft/gpl.html.\r\n*\r\n*  This script is distributed in the hope that it will be useful,\r\n*  but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n*  GNU General Public License for more details.\r\n*\r\n*  This copyright notice MUST APPEAR in all copies of the script!\r\n***************************************************************/\r\n/**\r\n * class 'tx_mhhttpbl' for the 'mh_httpbl' extension.\r\n *\r\n */\r\n\r\n/**\r\n * http:BL blocking extension\r\n *\r\n * @author\tMarc Hoersken <info@marc-hoersken.de>\r\n * @author  Jigal van Hemert <jigal@xs4all.nl>\r\n * @package TYPO3\r\n * @subpackage mh_httpbl\r\n */\r\nclass tx_mhhttpbl {\r\n\tvar $extKey = 'mh_httpbl';\r\n\tvar $debug = false;\r\n\tvar $params = false;\r\n\tvar $pObj = false;\r\n\tvar $config = false;\r\n\tvar $domain\t= 'dnsbl.httpbl.org';\r\n\tvar $content = '';\r\n\tvar $request = '';\r\n\tvar $result = '';\r\n\tvar $first = 0;\r\n\tvar $days = 0;\r\n\tvar $score = 0;\r\n\tvar $type = -1;\r\n\tvar $codes = array(\r\n\t\t0 => 'Search Engine',\r\n\t\t1 => 'Suspicious',\r\n\t\t2 => 'Harvester',\r\n\t\t3 => 'Suspicious &amp; Harvester',\r\n\t\t4 => 'Comment Spammer',\r\n\t\t5 => 'Suspicious &amp; Comment Spammer',\r\n\t\t6 => 'Harvester &amp; Comment Spammer',\r\n\t\t7 => 'Suspicious &amp; Harvester &amp; Comment Spammer'\r\n\t);\r\n\r\n\t/**\r\n\t * Hook page id lookup before rendering the content.\r\n\t *\r\n\t * @param\tobject\t\t$_params: parameter array\r\n\t * @param\tobject\t\t$pObj: partent object\r\n\t * @return\tvoid\r\n\t */\r\n\tfunction checkBlacklist(&$params, &$pObj) {\r\n\t\t$this->params = &$params;\r\n\t\t$this->pObj = &$pObj;\r\n\t\t$this->config = unserialize($GLOBALS['TYPO3_CONF_VARS']['EXT']['extConf'][$this->extKey]);\r\n\t\t$this->debug = $this->config['debug'];\r\n\t\t$this->runQuery();\r\n\r\n\t\tif (($this->type >= $this->config['type']) && (($this->score >= $this->config['score']) || (empty($this->config['score'])))) {\r\n\t\t\t$this->stopOutput();\r\n\t\t} else {\r\n\t\t\t$this->pObj->fe_user->setKey('ses','tx_mhhttpbl_user', true);\r\n\t\t\t$this->pObj->fe_user->storeSessionData();\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sends a DNS request to dnsbl.httpbl.org and checks for bad users.\r\n\t *\r\n\t * @return\tinteger\t\tIP type\r\n\t */\r\n\tfunction runQuery() {\r\n\t\tif ($this->debug) {\r\n\t\t\tt3lib_div::devlog('accesskey: ' . $this->config['accesskey'], $this->extKey, 1);\r\n\t\t}\r\n\r\n\t\tif (empty($this->config['accesskey'])) {\r\n\t\t\treturn $this->type = -1;\r\n\t\t}\r\n\r\n\t\tif (empty($_SERVER['REMOTE_ADDR'])) {\r\n\t\t\treturn $this->type = -2;\r\n\t\t}\r\n\r\n\t\t$remote_addr = $_SERVER['REMOTE_ADDR'];\r\n\t\t$remote_addr_quoted = $GLOBALS['TYPO3_DB']->fullQuoteStr($remote_addr, 'tx_mhhttpbl_whitelist');\r\n\t\t$res = $GLOBALS['TYPO3_DB']->exec_SELECTquery('*', 'tx_mhhttpbl_whitelist', 'whitelist_ip = '.$remote_addr_quoted);\r\n\t\tif ($GLOBALS['TYPO3_DB']->sql_num_rows($res)) {\r\n\t\t\treturn $this->type = -3;\r\n\t\t}\r\n\r\n\t\tif ($this->pObj->fe_user->getKey('ses','tx_mhhttpbl_user') == true || (($this->pObj->fe_user->getKey('ses','tx_mhhttpbl_hash') == t3lib_div::_GET('continue')) && (strlen(t3lib_div::_GET('continue')) > 0))) {\r\n\t\t\treturn $this->type = -4;\r\n\t\t}\r\n\r\n\t\t$this->request = $this->config['accesskey'].'.'.implode('.', array_reverse(explode('.', $_SERVER['REMOTE_ADDR']))).'.'.$this->domain;\r\n\t\t$this->result = gethostbyname($this->request);\r\n\r\n\t\tif ($this->result != $this->request) {\r\n\t\t\tlist($this->first, $this->days, $this->score, $this->type) = explode('.', $this->result);\r\n\t\t}\r\n\r\n\t\tif ($this->debug) {\r\n\t\t\tt3lib_div::devlog('dnsbl.httpbl.org result: ' . $result, $this->extKey, 1);\r\n\t\t}\r\n\r\n\t\tif($this->first != 127 || !array_key_exists($this->type, $this->codes)) {\r\n\t\t\treturn $this->type = -5;\r\n\t\t}\r\n\r\n\t\treturn $this->type;\r\n\t}\r\n\r\n\t/**\r\n\t * Stops TYPO3 output and shows an error page.\r\n\t *\r\n\t * @return\tvoid\r\n\t */\r\n\tfunction stopOutput() {\r\n\t\tif ($this->debug)\r\n\t\t\tt3lib_div::devlog('blocking user: ' . $_SERVER['REMOTE_ADDR'], $this->extKey, 1);\r\n\r\n\t\t$remote_addr = $_SERVER['REMOTE_ADDR'];\r\n\t\t$GLOBALS['TYPO3_DB']->exec_INSERTquery('tx_mhhttpbl_blocklog', array('crdate'=>time(), 'tstamp'=>time(), 'block_ip'=>$remote_addr, 'block_type'=>$this->type, 'block_score'=>$this->score));\r\n\r\n\t\t$usrHash = t3lib_div::shortMD5(serialize($_SERVER));\r\n\t\t$stdMsg = \"<strong>You have been blocked.</strong><br />Your IP appears to be on the httpbl.org/projecthoneypot.org blacklist.<br /><br />###REQUEST_IP###<br /><br />###USER_TYPE###\";\r\n\t\t$message = (!empty($this->config['message']) ? $stdMsg : $this->pObj->csConvObj->utf8_encode($message, $this->pObj->renderCharset));\r\n\t\t$message = str_replace('###REQUEST_IP###', '<strong>' . $remote_addr . '</strong> (' . gethostbyaddr($remote_addr) . ')', $message);\r\n\t\t$message = str_replace('###USER_TYPE###', $this->codes[$this->type], $message);\r\n\r\n\t\t$this->pObj->fe_user->setKey('ses','tx_mhhttpbl_hash', $usrHash);\r\n\t\t$this->pObj->fe_user->setKey('ses','tx_mhhttpbl_user', false);\r\n\t\t$this->pObj->fe_user->storeSessionData();\r\n\r\n\t\t$this->content = '\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\"\r\n\t\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n\t<head>\r\n\t\t<title>TYPO3 - http:BL</title>\r\n\t</head>\r\n\t<body style=\"background: #fff; color: #ccc; font-family: \\'Verdana\\', \\'Arial\\', sans-serif; text-align: center;\">\r\n\t\t'.$message.'\r\n\t</body>\r\n\t<script type=\"text/javascript\">\r\n\t\twindow.location.replace(window.location.href.split(\\'?\\')[0] + \\'?continue='.$usrHash.'\\');\r\n\t</script>\r\n</html>\r\n\t\t';\r\n\t}\r\n\r\n\t/**\r\n\t * Hook content before caching.\r\n\t *\r\n\t * @param\tobject\t\t$_params: parameter array\r\n\t * @param\tobject\t\t$pObj: partent object\r\n\t * @return\tvoid\r\n\t */\r\n\tfunction addHoneyPot(&$params, &$pObj) {\r\n\t\t$this->params = &$params;\r\n\t\t$this->pObj = &$pObj;\r\n\t\t$this->config = unserialize($GLOBALS['TYPO3_CONF_VARS']['EXT']['extConf'][$this->extKey]);\r\n\r\n\t\tif (!empty($this->config['quicklink'])) {\r\n\t\t\t$imgconf = array(\r\n\t\t\t\t'file' => 'EXT:mh_httpbl/mod1/clear.gif',\r\n\t\t\t\t'file.' => array(\r\n\t\t\t\t\t'maxH' => 1,\r\n\t\t\t\t\t'maxW' => 1,\r\n\t\t\t\t),\r\n\t\t\t\t'stdWrap.' => array(\r\n\t\t\t\t\t'typolink.' => array(\r\n\t\t\t\t\t\t'parameter' => $this->config['quicklink'],\r\n\t\t\t\t\t\t'title' => '',\r\n\t\t\t\t\t\t'wrap' => '<div style=\"display: none;\">|</div>',\r\n\t\t\t\t\t),\r\n\t\t\t\t),\r\n\t\t\t);\r\n\t\t\t/*\r\n\t\t\t\tCreate file with clear.gif\r\n\t\t\t\tWrap it with a link to the Quicklink\r\n\t\t\t\tWrap it in a div to comply with XHTML 1.0 Strict\r\n\t\t\t*/\r\n\t\t\t$cObj = t3lib_div::makeInstance('tslib_cObj');\r\n\t\t\t$cObj->start('', 'tt_content');\r\n\t\t\t/*\r\n\t\t\t\tCreate a cObj to do the work of generating (X)HTML\r\n\t\t\t*/\r\n\t\t\tif (file_exists(t3lib_extMgm::extPath('mh_httpbl').'mod1/clear.gif')) {\r\n\t\t\t\t$content = $cObj->IMAGE($imgconf);\r\n\t\t\t} else {\r\n\t\t\t\t$content = $cObj->typoLink('<!--&nbsp;-->', $imgconf['stdWrap']['typolink']);\r\n\t\t\t\t/*\r\n\t\t\t\t\tIf no clear.gif is found use a part of the configuration to wrap a link and div around\r\n\t\t\t\t\ta comment...\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!empty($this->content)) {\r\n\t\t\t$pObj->content = trim($this->content);\r\n\t\t\t$pObj->no_cache = true;\r\n\t\t} else if (!empty($this->config['quicklink'])) {\t\t\r\n\t\t\t$pObj->content = str_replace('<body>', '<body>'.$content, $this->pObj->content);\r\n\t\t\t$pObj->content = str_replace('</body>', $content.'</body>', $this->pObj->content);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nif (defined('TYPO3_MODE') && $TYPO3_CONF_VARS[TYPO3_MODE]['XCLASS']['ext/mh_httpbl/class.tx_mhhttpbl.php']) {\r\n\tinclude_once($TYPO3_CONF_VARS[TYPO3_MODE]['XCLASS']['ext/mh_httpbl/class.tx_mhhttpbl.php']);\r\n}\r\n\r\n?>"], "fixing_code": ["<?php\r\n/***************************************************************\r\n*  Copyright notice\r\n*\r\n*  (c) 2010 Marc Hoersken <info@marc-hoersken.de>\r\n*  All rights reserved\r\n*\r\n*  This script is part of the TYPO3 project. The TYPO3 project is\r\n*  free software; you can redistribute it and/or modify\r\n*  it under the terms of the GNU General Public License as published by\r\n*  the Free Software Foundation; either version 2 of the License, or\r\n*  (at your option) any later version.\r\n*\r\n*  The GNU General Public License can be found at\r\n*  http://www.gnu.org/copyleft/gpl.html.\r\n*\r\n*  This script is distributed in the hope that it will be useful,\r\n*  but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n*  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n*  GNU General Public License for more details.\r\n*\r\n*  This copyright notice MUST APPEAR in all copies of the script!\r\n***************************************************************/\r\n/**\r\n * class 'tx_mhhttpbl' for the 'mh_httpbl' extension.\r\n *\r\n */\r\n\r\n/**\r\n * http:BL blocking extension\r\n *\r\n * @author\tMarc Hoersken <info@marc-hoersken.de>\r\n * @author  Jigal van Hemert <jigal@xs4all.nl>\r\n * @package TYPO3\r\n * @subpackage mh_httpbl\r\n */\r\nclass tx_mhhttpbl {\r\n\tvar $extKey = 'mh_httpbl';\r\n\tvar $debug = false;\r\n\tvar $params = false;\r\n\tvar $pObj = false;\r\n\tvar $config = false;\r\n\tvar $domain\t= 'dnsbl.httpbl.org';\r\n\tvar $content = '';\r\n\tvar $request = '';\r\n\tvar $result = '';\r\n\tvar $first = 0;\r\n\tvar $days = 0;\r\n\tvar $score = 0;\r\n\tvar $type = -1;\r\n\tvar $codes = array(\r\n\t\t0 => 'Search Engine',\r\n\t\t1 => 'Suspicious',\r\n\t\t2 => 'Harvester',\r\n\t\t3 => 'Suspicious &amp; Harvester',\r\n\t\t4 => 'Comment Spammer',\r\n\t\t5 => 'Suspicious &amp; Comment Spammer',\r\n\t\t6 => 'Harvester &amp; Comment Spammer',\r\n\t\t7 => 'Suspicious &amp; Harvester &amp; Comment Spammer'\r\n\t);\r\n\r\n\t/**\r\n\t * Hook page id lookup before rendering the content.\r\n\t *\r\n\t * @param\tobject\t\t$_params: parameter array\r\n\t * @param\tobject\t\t$pObj: partent object\r\n\t * @return\tvoid\r\n\t */\r\n\tfunction checkBlacklist(&$params, &$pObj) {\r\n\t\t$this->params = &$params;\r\n\t\t$this->pObj = &$pObj;\r\n\t\t$this->config = unserialize($GLOBALS['TYPO3_CONF_VARS']['EXT']['extConf'][$this->extKey]);\r\n\t\t$this->debug = $this->config['debug'];\r\n\t\t$this->runQuery();\r\n\r\n\t\tif (($this->type >= $this->config['type']) && (($this->score >= $this->config['score']) || (empty($this->config['score'])))) {\r\n\t\t\t$this->stopOutput();\r\n\t\t} else {\r\n\t\t\t$this->pObj->fe_user->setKey('ses','tx_mhhttpbl_user', true);\r\n\t\t\t$this->pObj->fe_user->storeSessionData();\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Sends a DNS request to dnsbl.httpbl.org and checks for bad users.\r\n\t *\r\n\t * @return\tinteger\t\tIP type\r\n\t */\r\n\tfunction runQuery() {\r\n\t\tif ($this->debug) {\r\n\t\t\tt3lib_div::devlog('accesskey: ' . $this->config['accesskey'], $this->extKey, 1);\r\n\t\t}\r\n\r\n\t\tif (empty($this->config['accesskey'])) {\r\n\t\t\treturn $this->type = -1;\r\n\t\t}\r\n\r\n\t\tif (empty($_SERVER['REMOTE_ADDR'])) {\r\n\t\t\treturn $this->type = -2;\r\n\t\t}\r\n\r\n\t\t$remote_addr = $_SERVER['REMOTE_ADDR'];\r\n\t\t$remote_addr_quoted = $GLOBALS['TYPO3_DB']->fullQuoteStr($remote_addr, 'tx_mhhttpbl_whitelist');\r\n\t\t$res = $GLOBALS['TYPO3_DB']->exec_SELECTquery('*', 'tx_mhhttpbl_whitelist', 'whitelist_ip = '.$remote_addr_quoted);\r\n\t\tif ($GLOBALS['TYPO3_DB']->sql_num_rows($res)) {\r\n\t\t\treturn $this->type = -3;\r\n\t\t}\r\n\r\n\t\tif ($this->pObj->fe_user->getKey('ses','tx_mhhttpbl_user') == true || (($this->pObj->fe_user->getKey('ses','tx_mhhttpbl_hash') == t3lib_div::_GET('continue')) && (strlen(t3lib_div::_GET('continue')) > 0))) {\r\n\t\t\treturn $this->type = -4;\r\n\t\t}\r\n\r\n\t\t$this->request = $this->config['accesskey'].'.'.implode('.', array_reverse(explode('.', $_SERVER['REMOTE_ADDR']))).'.'.$this->domain;\r\n\t\t$this->result = gethostbyname($this->request);\r\n\r\n\t\tif ($this->result != $this->request) {\r\n\t\t\tlist($this->first, $this->days, $this->score, $this->type) = explode('.', $this->result);\r\n\t\t}\r\n\r\n\t\tif ($this->debug) {\r\n\t\t\tt3lib_div::devlog('dnsbl.httpbl.org result: ' . $result, $this->extKey, 1);\r\n\t\t}\r\n\r\n\t\tif($this->first != 127 || !array_key_exists($this->type, $this->codes)) {\r\n\t\t\treturn $this->type = -5;\r\n\t\t}\r\n\r\n\t\treturn $this->type;\r\n\t}\r\n\r\n\t/**\r\n\t * Stops TYPO3 output and shows an error page.\r\n\t *\r\n\t * @return\tvoid\r\n\t */\r\n\tfunction stopOutput() {\r\n\t\tif ($this->debug)\r\n\t\t\tt3lib_div::devlog('blocking user: ' . $_SERVER['REMOTE_ADDR'], $this->extKey, 1);\r\n\r\n\t\t$remote_addr = $_SERVER['REMOTE_ADDR'];\r\n\t\t$remote_host = gethostbyaddr($remote_addr);\r\n\t\t$remote_addr_html = htmlspecialchars($remote_addr);\r\n\t\t$remote_host_html = htmlspecialchars($remote_host);\r\n\r\n\t\t$GLOBALS['TYPO3_DB']->exec_INSERTquery('tx_mhhttpbl_blocklog', array('crdate'=>time(), 'tstamp'=>time(), 'block_ip'=>$remote_addr, 'block_type'=>$this->type, 'block_score'=>$this->score));\r\n\r\n\t\t$usrHash = t3lib_div::shortMD5(serialize($_SERVER));\r\n\t\t$stdMsg = \"<strong>You have been blocked.</strong><br />Your IP appears to be on the httpbl.org/projecthoneypot.org blacklist.<br /><br />###REQUEST_IP###<br /><br />###USER_TYPE###\";\r\n\t\t$message = (!empty($this->config['message']) ? $stdMsg : $this->pObj->csConvObj->utf8_encode($message, $this->pObj->renderCharset));\r\n\t\t$message = str_replace('###REQUEST_IP###', '<strong>' . $remote_addr_html . '</strong> (' . $remote_host_html . ')', $message);\r\n\t\t$message = str_replace('###USER_TYPE###', $this->codes[$this->type], $message);\r\n\r\n\t\t$this->pObj->fe_user->setKey('ses','tx_mhhttpbl_hash', $usrHash);\r\n\t\t$this->pObj->fe_user->setKey('ses','tx_mhhttpbl_user', false);\r\n\t\t$this->pObj->fe_user->storeSessionData();\r\n\r\n\t\t$this->content = '\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\"\r\n\t\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n\t<head>\r\n\t\t<title>TYPO3 - http:BL</title>\r\n\t</head>\r\n\t<body style=\"background: #fff; color: #ccc; font-family: \\'Verdana\\', \\'Arial\\', sans-serif; text-align: center;\">\r\n\t\t'.$message.'\r\n\t</body>\r\n\t<script type=\"text/javascript\">\r\n\t\twindow.location.replace(window.location.href.split(\\'?\\')[0] + \\'?continue='.$usrHash.'\\');\r\n\t</script>\r\n</html>\r\n\t\t';\r\n\t}\r\n\r\n\t/**\r\n\t * Hook content before caching.\r\n\t *\r\n\t * @param\tobject\t\t$_params: parameter array\r\n\t * @param\tobject\t\t$pObj: partent object\r\n\t * @return\tvoid\r\n\t */\r\n\tfunction addHoneyPot(&$params, &$pObj) {\r\n\t\t$this->params = &$params;\r\n\t\t$this->pObj = &$pObj;\r\n\t\t$this->config = unserialize($GLOBALS['TYPO3_CONF_VARS']['EXT']['extConf'][$this->extKey]);\r\n\r\n\t\tif (!empty($this->config['quicklink'])) {\r\n\t\t\t$imgconf = array(\r\n\t\t\t\t'file' => 'EXT:mh_httpbl/mod1/clear.gif',\r\n\t\t\t\t'file.' => array(\r\n\t\t\t\t\t'maxH' => 1,\r\n\t\t\t\t\t'maxW' => 1,\r\n\t\t\t\t),\r\n\t\t\t\t'stdWrap.' => array(\r\n\t\t\t\t\t'typolink.' => array(\r\n\t\t\t\t\t\t'parameter' => $this->config['quicklink'],\r\n\t\t\t\t\t\t'title' => '',\r\n\t\t\t\t\t\t'wrap' => '<div style=\"display: none;\">|</div>',\r\n\t\t\t\t\t),\r\n\t\t\t\t),\r\n\t\t\t);\r\n\t\t\t/*\r\n\t\t\t\tCreate file with clear.gif\r\n\t\t\t\tWrap it with a link to the Quicklink\r\n\t\t\t\tWrap it in a div to comply with XHTML 1.0 Strict\r\n\t\t\t*/\r\n\t\t\t$cObj = t3lib_div::makeInstance('tslib_cObj');\r\n\t\t\t$cObj->start('', 'tt_content');\r\n\t\t\t/*\r\n\t\t\t\tCreate a cObj to do the work of generating (X)HTML\r\n\t\t\t*/\r\n\t\t\tif (file_exists(t3lib_extMgm::extPath('mh_httpbl').'mod1/clear.gif')) {\r\n\t\t\t\t$content = $cObj->IMAGE($imgconf);\r\n\t\t\t} else {\r\n\t\t\t\t$content = $cObj->typoLink('<!--&nbsp;-->', $imgconf['stdWrap']['typolink']);\r\n\t\t\t\t/*\r\n\t\t\t\t\tIf no clear.gif is found use a part of the configuration to wrap a link and div around\r\n\t\t\t\t\ta comment...\r\n\t\t\t\t*/\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (!empty($this->content)) {\r\n\t\t\t$pObj->content = trim($this->content);\r\n\t\t\t$pObj->no_cache = true;\r\n\t\t} else if (!empty($this->config['quicklink'])) {\t\t\r\n\t\t\t$pObj->content = str_replace('<body>', '<body>'.$content, $this->pObj->content);\r\n\t\t\t$pObj->content = str_replace('</body>', $content.'</body>', $this->pObj->content);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nif (defined('TYPO3_MODE') && $TYPO3_CONF_VARS[TYPO3_MODE]['XCLASS']['ext/mh_httpbl/class.tx_mhhttpbl.php']) {\r\n\tinclude_once($TYPO3_CONF_VARS[TYPO3_MODE]['XCLASS']['ext/mh_httpbl/class.tx_mhhttpbl.php']);\r\n}\r\n\r\n?>\r\n"], "filenames": ["class.tx_mhhttpbl.php"], "buggy_code_start_loc": [140], "buggy_code_end_loc": [234], "fixing_code_start_loc": [141], "fixing_code_end_loc": [238], "type": "CWE-79", "message": "** UNSUPPPORTED WHEN ASSIGNED ** ** UNSUPPORTED WHEN ASSIGNED ** A vulnerability classified as problematic has been found in mback2k mh_httpbl Extension up to 1.1.7 on TYPO3. This affects the function stopOutput of the file class.tx_mhhttpbl.php. The manipulation of the argument $_SERVER['REMOTE_ADDR'] leads to cross site scripting. It is possible to initiate the attack remotely. Upgrading to version 1.1.8 is able to address this issue. The name of the patch is a754bf306a433a8c18b55e25595593e8f19b9463. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-230391. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.", "other": {"cve": {"id": "CVE-2016-15032", "sourceIdentifier": "cna@vuldb.com", "published": "2023-06-02T00:15:09.443", "lastModified": "2023-06-09T14:03:36.020", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "** UNSUPPPORTED WHEN ASSIGNED ** ** UNSUPPORTED WHEN ASSIGNED ** A vulnerability classified as problematic has been found in mback2k mh_httpbl Extension up to 1.1.7 on TYPO3. This affects the function stopOutput of the file class.tx_mhhttpbl.php. The manipulation of the argument $_SERVER['REMOTE_ADDR'] leads to cross site scripting. It is possible to initiate the attack remotely. Upgrading to version 1.1.8 is able to address this issue. The name of the patch is a754bf306a433a8c18b55e25595593e8f19b9463. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-230391. NOTE: This vulnerability only affects products that are no longer supported by the maintainer."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mh_httpbl_project:mh_httpbl:*:*:*:*:*:typo3:*:*", "versionEndExcluding": "1.1.8", "matchCriteriaId": "496EB296-734C-47B9-8E30-9135EAC83E90"}]}]}], "references": [{"url": "https://github.com/mback2k/mh_httpbl/commit/a754bf306a433a8c18b55e25595593e8f19b9463", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://github.com/mback2k/mh_httpbl/releases/tag/mh_httpbl_1.1.8_security", "source": "cna@vuldb.com", "tags": ["Release Notes"]}, {"url": "https://vuldb.com/?ctiid.230391", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.230391", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/mback2k/mh_httpbl/commit/a754bf306a433a8c18b55e25595593e8f19b9463"}}