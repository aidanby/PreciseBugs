{"buggy_code": ["# Licensed to The Apereo Foundation under one or more contributor license\n# agreements. See the NOTICE file distributed with this work for additional\n# information regarding copyright ownership.\n#\n#\n# The Apereo Foundation licenses this file to you under the Educational\n# Community License, Version 2.0 (the \"License\"); you may not use this file\n# except in compliance with the License. You may obtain a copy of the License\n# at:\n#\n#   http://opensource.org/licenses/ecl2.txt\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n# WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the\n# License for the specific language governing permissions and limitations under\n# the License.\n\n\n\n# Possible configuration options for the start script:\n#\n# export JAVA_HOME         # Location of Java installation\n# export JAVA_MIN_MEM      # Minimum memory for the JVM\n# export JAVA_MAX_MEM      # Maximum memory for the JVM\n# export JAVA_PERM_MEM     # Minimum perm memory for the JVM\n# export JAVA_MAX_PERM_MEM # Maximum perm memory for the JVM\n# export EXTRA_JAVA_OPTS   # Additional JVM options\n# export KARAF_HOME        # Karaf home folder\n# export KARAF_DATA        # Karaf data folder\n# export KARAF_BASE        # Karaf base folder\n# export KARAF_ETC         # Karaf etc  folder\n# export KARAF_OPTS        # Additional Karaf options\n# export KARAF_DEBUG       # Enable debug mode\n# export KARAF_REDIRECT    # Enable/set the std/err redirection when using bin/start\n\nexport EXTRA_JAVA_OPTS=\"${EXTRA_JAVA_OPTS} -Dorg.eclipse.jetty.server.Request.maxFormContentSize=1500000 -Dfile.encoding=UTF-8\"\nexport JAVA_MAX_MEM=\"${JAVA_MAX_MEM:-1G}\"\nexport JAVA_PERM_MEM=\"${JAVA_PERM_MEM:-256M}\"\nexport KARAF_NOROOT=true\n\n# Mitigation for new Tesseract 4.x locking up the system\nexport OMP_THREAD_LIMIT=1\n\n. \"$DIRNAME/check_ports\"\n"], "fixing_code": ["# Licensed to The Apereo Foundation under one or more contributor license\n# agreements. See the NOTICE file distributed with this work for additional\n# information regarding copyright ownership.\n#\n#\n# The Apereo Foundation licenses this file to you under the Educational\n# Community License, Version 2.0 (the \"License\"); you may not use this file\n# except in compliance with the License. You may obtain a copy of the License\n# at:\n#\n#   http://opensource.org/licenses/ecl2.txt\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n# WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  See the\n# License for the specific language governing permissions and limitations under\n# the License.\n\n\n\n# Possible configuration options for the start script:\n#\n# export JAVA_HOME         # Location of Java installation\n# export JAVA_MIN_MEM      # Minimum memory for the JVM\n# export JAVA_MAX_MEM      # Maximum memory for the JVM\n# export JAVA_PERM_MEM     # Minimum perm memory for the JVM\n# export JAVA_MAX_PERM_MEM # Maximum perm memory for the JVM\n# export EXTRA_JAVA_OPTS   # Additional JVM options\n# export KARAF_HOME        # Karaf home folder\n# export KARAF_DATA        # Karaf data folder\n# export KARAF_BASE        # Karaf base folder\n# export KARAF_ETC         # Karaf etc  folder\n# export KARAF_OPTS        # Additional Karaf options\n# export KARAF_REDIRECT    # Enable/set the std/err redirection when using bin/start\n#\n# Debug options\n# export KARAF_DEBUG       # Enable debug mode\n# export JAVA_DEBUG_PORT   # Set debug port (defaults to 5005)\n\n\nexport EXTRA_JAVA_OPTS=\"${EXTRA_JAVA_OPTS} -Dorg.eclipse.jetty.server.Request.maxFormContentSize=1500000 -Dfile.encoding=UTF-8\"\nexport JAVA_MAX_MEM=\"${JAVA_MAX_MEM:-1G}\"\nexport JAVA_PERM_MEM=\"${JAVA_PERM_MEM:-256M}\"\nexport KARAF_NOROOT=true\n\n# Mitigation for new Tesseract 4.x locking up the system\nexport OMP_THREAD_LIMIT=1\n\n. \"$DIRNAME/check_ports\"\n"], "filenames": ["assemblies/resources/bin/setenv"], "buggy_code_start_loc": [33], "buggy_code_end_loc": [36], "fixing_code_start_loc": [34], "fixing_code_end_loc": [40], "type": "CWE-776", "message": "Opencast is a free and open source solution for automated video capture and distribution. Versions of Opencast prior to 9.6 are vulnerable to the billion laughs attack, which allows an attacker to easily execute a (seemingly permanent) denial of service attack, essentially taking down Opencast using a single HTTP request. To exploit this, users need to have ingest privileges, limiting the group of potential attackers The problem has been fixed in Opencast 9.6. There is no known workaround for this issue.", "other": {"cve": {"id": "CVE-2021-32623", "sourceIdentifier": "security-advisories@github.com", "published": "2021-06-16T00:15:07.717", "lastModified": "2021-06-23T19:55:22.117", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Opencast is a free and open source solution for automated video capture and distribution. Versions of Opencast prior to 9.6 are vulnerable to the billion laughs attack, which allows an attacker to easily execute a (seemingly permanent) denial of service attack, essentially taking down Opencast using a single HTTP request. To exploit this, users need to have ingest privileges, limiting the group of potential attackers The problem has been fixed in Opencast 9.6. There is no known workaround for this issue."}, {"lang": "es", "value": "Opencast es una soluci\u00f3n gratuita y de c\u00f3digo abierto para la captura y distribuci\u00f3n autom\u00e1tica de v\u00eddeo. Las versiones de Opencast anteriores a versi\u00f3n 9.6 son vulnerables al ataque de los mil millones de risas, que permite a un atacante ejecutar f\u00e1cilmente un ataque de denegaci\u00f3n de servicio (aparentemente permanente), esencialmente derribando Opencast usando una \u00fanica petici\u00f3n HTTP. Para explotar esto, los usuarios necesitan tener privilegios de ingesta, limitando el grupo de atacantes potenciales. El problema se ha corregido en Opencast  versi\u00f3n 9.6. No se conoce ninguna soluci\u00f3n para este problema"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.1, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.2}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-776"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apereo:opencast:*:*:*:*:*:*:*:*", "versionEndExcluding": "9.6", "matchCriteriaId": "0A9BAD00-C232-4ACC-B2AA-4EC1C37CFECC"}]}]}], "references": [{"url": "https://github.com/opencast/opencast/commit/8ae27da5a6f658011a5741b3210e715b0dc6213e", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/opencast/opencast/security/advisories/GHSA-9gwx-9cwp-5c2m", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/opencast/opencast/commit/8ae27da5a6f658011a5741b3210e715b0dc6213e"}}