{"buggy_code": ["<?php\n$dataurl = \"ajax.php?module=arimanager&command=grid\";\n?>\n<div id=\"toolbar-all\">\n    <a class=\"btn btn-default\" href=\"?display=arimanager&view=form\">\n        <i class=\"fa fa-plus\"></i> <span><?php echo _('Add User')?></span>\n    </a>\n</div>\n <table id=\"ariusergrid\" data-url=\"<?php echo $dataurl?>\" data-cache=\"false\" data-toolbar=\"#toolbar-all\" data-maintain-selected=\"true\" data-show-columns=\"true\" data-show-toggle=\"true\" data-toggle=\"table\" data-pagination=\"true\" data-search=\"true\" class=\"table table-striped\">\n    <thead>\n            <tr>\n            <th data-field=\"name\"><?php echo _(\"Username\")?></th>\n            <th data-field=\"read_only\" data-formatter=\"roFormatter\"><?php echo _(\"Read Only\")?></th>\n            <th data-field=\"id\" data-formatter=\"linkFormatter\"><?php echo _(\"Actions\")?></th>\n        </tr>\n    </thead>\n</table>\n<script type=\"text/javascript\">\n  function roFormatter(value){\n    var html = '';\n    if (value == \"1\"){\n      html += _(\"Yes\");\n    }else{\n      html += _(\"No\");\n    }\n    return html;\n  }\n  function linkFormatter(value){\n    var html = '<a href=\"?display=arimanager&view=form&user='+value+'\"><i class=\"fa fa-pencil\"></i></a>';\n    html += '&nbsp;<a href=\"?display=arimanager&action=delete&user='+value+'\" class=\"delAction\"><i class=\"fa fa-trash\"></i></a>';\n    return html;\n  }\n</script>\n", "<?php\n$dataurl = \"ajax.php?module=arimanager&command=grid\";\n?>\n<div id=\"toolbar-all\">\n    <a class=\"btn btn-default\" href=\"?display=arimanager&view=form\">\n        <i class=\"fa fa-plus\"></i> <span><?php echo _('Add User')?></span>\n    </a>\n</div>\n <table id=\"ariusergrid-side\" data-url=\"<?php echo $dataurl?>\" data-cache=\"false\" data-toolbar=\"#toolbar-all\" data-maintain-selected=\"true\" data-show-columns=\"true\" data-show-toggle=\"true\" data-toggle=\"table\" data-pagination=\"true\" data-search=\"true\" class=\"table table-striped\">\n    <thead>\n            <tr>\n            <th data-field=\"name\"><?php echo _(\"Username\")?></th>\n            <th data-field=\"read_only\" data-formatter=\"roFormatter\"><?php echo _(\"Read Only\")?></th>\n        </tr>\n    </thead>\n</table>\n<script type=\"text/javascript\">\n  function roFormatter(value){\n    var html = '';\n    if (value == \"1\"){\n      html += _(\"Yes\");\n    }else{\n      html += _(\"No\");\n    }\n    return html;\n  }\n  function linkFormatter(value){\n    var html = '<a href=\"?display=arimanager&view=form&user='+value+'\"><i class=\"fa fa-pencil\"></i></a>';\n    html += '&nbsp;<a href=\"?display=arimanager&action=delete&user='+value+'\" class=\"delAction\"><i class=\"fa fa-trash\"></i></a>';\n    return html;\n  }\n</script>\n"], "fixing_code": ["<?php\n$dataurl = \"ajax.php?module=arimanager&command=grid\";\n?>\n<div id=\"toolbar-all\">\n    <a class=\"btn btn-default\" href=\"?display=arimanager&view=form\">\n        <i class=\"fa fa-plus\"></i> <span><?php echo _('Add User')?></span>\n    </a>\n</div>\n <table id=\"ariusergrid\" data-escape=\"true\" data-url=\"<?php echo $dataurl?>\" data-cache=\"false\" data-toolbar=\"#toolbar-all\" data-maintain-selected=\"true\" data-show-columns=\"true\" data-show-toggle=\"true\" data-toggle=\"table\" data-pagination=\"true\" data-search=\"true\" class=\"table table-striped\">\n    <thead>\n            <tr>\n            <th data-field=\"name\"><?php echo _(\"Username\")?></th>\n            <th data-field=\"read_only\" data-formatter=\"roFormatter\"><?php echo _(\"Read Only\")?></th>\n            <th data-field=\"id\" data-formatter=\"linkFormatter\"><?php echo _(\"Actions\")?></th>\n        </tr>\n    </thead>\n</table>\n<script type=\"text/javascript\">\n  function roFormatter(value){\n    var html = '';\n    if (value == \"1\"){\n      html += _(\"Yes\");\n    }else{\n      html += _(\"No\");\n    }\n    return html;\n  }\n  function linkFormatter(value){\n    var html = '<a href=\"?display=arimanager&view=form&user='+value+'\"><i class=\"fa fa-pencil\"></i></a>';\n    html += '&nbsp;<a href=\"?display=arimanager&action=delete&user='+value+'\" class=\"delAction\"><i class=\"fa fa-trash\"></i></a>';\n    return html;\n  }\n</script>\n", "<?php\n$dataurl = \"ajax.php?module=arimanager&command=grid\";\n?>\n<div id=\"toolbar-all\">\n    <a class=\"btn btn-default\" href=\"?display=arimanager&view=form\">\n        <i class=\"fa fa-plus\"></i> <span><?php echo _('Add User')?></span>\n    </a>\n</div>\n <table id=\"ariusergrid-side\" data-escape=\"true\" data-url=\"<?php echo $dataurl?>\" data-cache=\"false\" data-toolbar=\"#toolbar-all\" data-maintain-selected=\"true\" data-show-columns=\"true\" data-show-toggle=\"true\" data-toggle=\"table\" data-pagination=\"true\" data-search=\"true\" class=\"table table-striped\">\n    <thead>\n            <tr>\n            <th data-field=\"name\"><?php echo _(\"Username\")?></th>\n            <th data-field=\"read_only\" data-formatter=\"roFormatter\"><?php echo _(\"Read Only\")?></th>\n        </tr>\n    </thead>\n</table>\n<script type=\"text/javascript\">\n  function roFormatter(value){\n    var html = '';\n    if (value == \"1\"){\n      html += _(\"Yes\");\n    }else{\n      html += _(\"No\");\n    }\n    return html;\n  }\n  function linkFormatter(value){\n    var html = '<a href=\"?display=arimanager&view=form&user='+value+'\"><i class=\"fa fa-pencil\"></i></a>';\n    html += '&nbsp;<a href=\"?display=arimanager&action=delete&user='+value+'\" class=\"delAction\"><i class=\"fa fa-trash\"></i></a>';\n    return html;\n  }\n</script>\n"], "filenames": ["views/grid.php", "views/rnav.php"], "buggy_code_start_loc": [9, 9], "buggy_code_end_loc": [10, 10], "fixing_code_start_loc": [9, 9], "fixing_code_end_loc": [10, 10], "type": "CWE-79", "message": "A vulnerability was found in FreePBX arimanager up to 13.0.5.3 and classified as problematic. Affected by this issue is some unknown functionality of the component Views Handler. The manipulation of the argument dataurl leads to cross site scripting. The attack may be launched remotely. Upgrading to version 13.0.5.4 is able to address this issue. The name of the patch is 199dea7cc7020d3c469a86a39fbd80f5edd3c5ab. It is recommended to upgrade the affected component. VDB-216878 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2019-25090", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-27T13:15:10.703", "lastModified": "2023-01-06T06:03:29.483", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in FreePBX arimanager up to 13.0.5.3 and classified as problematic. Affected by this issue is some unknown functionality of the component Views Handler. The manipulation of the argument dataurl leads to cross site scripting. The attack may be launched remotely. Upgrading to version 13.0.5.4 is able to address this issue. The name of the patch is 199dea7cc7020d3c469a86a39fbd80f5edd3c5ab. It is recommended to upgrade the affected component. VDB-216878 is the identifier assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sangoma:freepbx:*:*:*:*:*:*:*:*", "versionEndExcluding": "13.0.5.4", "matchCriteriaId": "8AB2704E-CFB4-45D4-81FC-FB9B968FA495"}]}]}], "references": [{"url": "https://github.com/FreePBX/arimanager/commit/199dea7cc7020d3c469a86a39fbd80f5edd3c5ab", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/FreePBX/arimanager/releases/tag/release%2F13.0.5.4", "source": "cna@vuldb.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.216878", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.216878", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/FreePBX/arimanager/commit/199dea7cc7020d3c469a86a39fbd80f5edd3c5ab"}}