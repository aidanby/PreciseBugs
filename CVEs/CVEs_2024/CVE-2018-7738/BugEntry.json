{"buggy_code": ["_umount_module()\n{\n\tlocal cur prev OPTS\n\tCOMPREPLY=()\n\tcur=\"${COMP_WORDS[COMP_CWORD]}\"\n\tprev=\"${COMP_WORDS[COMP_CWORD-1]}\"\n\tcase $prev in\n\t\t'-t'|'--types')\n\t\t\tlocal TYPES\n\t\t\tTYPES=\"\n\t\t\t\t$(\\ls /lib/modules/$(uname -r)/kernel/fs | awk '{print $1, \"no\" $1}')\n\t\t\t\t$(awk '{print $NF, \"no\" $NF}' /proc/filesystems)\n\t\t\t\"\n\t\t\tCOMPREPLY=( $(compgen -W \"$TYPES\" -- $cur) )\n\t\t\treturn 0\n\t\t\t;;\n\t\t'-h'|'--help'|'-V'|'--version')\n\t\t\treturn 0\n\t\t\t;;\n\tesac\n\tcase $cur in\n\t\t-*)\n\t\t\tOPTS=\"\t--all\n\t\t\t\t--all-targets\n\t\t\t\t--no-canonicalize\n\t\t\t\t--detach-loop\n\t\t\t\t--fake\n\t\t\t\t--force\n\t\t\t\t--internal-only\n\t\t\t\t--no-mtab\n\t\t\t\t--lazy\n\t\t\t\t--test-opts\n\t\t\t\t--recursive\n\t\t\t\t--read-only\n\t\t\t\t--types\n\t\t\t\t--verbose\n\t\t\t\t--help\n\t\t\t\t--version\"\n\t\t\tCOMPREPLY=( $(compgen -W \"${OPTS[*]}\" -- $cur) )\n\t\t\treturn 0\n\t\t\t;;\n\tesac\n\tlocal DEVS_MPOINTS\n\tDEVS_MPOINTS=\"$(mount | awk '{print $1, $3}')\"\n\tCOMPREPLY=( $(compgen -W \"$DEVS_MPOINTS\" -- $cur) )\n\treturn 0\n}\ncomplete -F _umount_module umount\n"], "fixing_code": ["_umount_module()\n{\n\tlocal cur prev OPTS\n\tCOMPREPLY=()\n\tcur=\"${COMP_WORDS[COMP_CWORD]}\"\n\tprev=\"${COMP_WORDS[COMP_CWORD-1]}\"\n\tcase $prev in\n\t\t'-t'|'--types')\n\t\t\tlocal TYPES\n\t\t\tTYPES=\"\n\t\t\t\t$(\\ls /lib/modules/$(uname -r)/kernel/fs | awk '{print $1, \"no\" $1}')\n\t\t\t\t$(awk '{print $NF, \"no\" $NF}' /proc/filesystems)\n\t\t\t\"\n\t\t\tCOMPREPLY=( $(compgen -W \"$TYPES\" -- $cur) )\n\t\t\treturn 0\n\t\t\t;;\n\t\t'-h'|'--help'|'-V'|'--version')\n\t\t\treturn 0\n\t\t\t;;\n\tesac\n\tcase $cur in\n\t\t-*)\n\t\t\tOPTS=\"\t--all\n\t\t\t\t--all-targets\n\t\t\t\t--no-canonicalize\n\t\t\t\t--detach-loop\n\t\t\t\t--fake\n\t\t\t\t--force\n\t\t\t\t--internal-only\n\t\t\t\t--no-mtab\n\t\t\t\t--lazy\n\t\t\t\t--test-opts\n\t\t\t\t--recursive\n\t\t\t\t--read-only\n\t\t\t\t--types\n\t\t\t\t--verbose\n\t\t\t\t--help\n\t\t\t\t--version\"\n\t\t\tCOMPREPLY=( $(compgen -W \"${OPTS[*]}\" -- $cur) )\n\t\t\treturn 0\n\t\t\t;;\n\tesac\n\n\tlocal oldifs=$IFS\n\tIFS=$'\\n'\n\tCOMPREPLY=( $( compgen -W '$(findmnt -lno TARGET | sed \"s/\\([[:blank:]]\\)/\\\\\\\\\\1/g\")' -- \"$cur\" ) )\n\tIFS=$oldifs\n}\ncomplete -F _umount_module umount\n"], "filenames": ["bash-completion/umount"], "buggy_code_start_loc": [43], "buggy_code_end_loc": [47], "fixing_code_start_loc": [43], "fixing_code_end_loc": [48], "type": "NVD-CWE-noinfo", "message": "In util-linux before 2.32-rc1, bash-completion/umount allows local users to gain privileges by embedding shell commands in a mountpoint name, which is mishandled during a umount command (within Bash) by a different user, as demonstrated by logging in as root and entering umount followed by a tab character for autocompletion.", "other": {"cve": {"id": "CVE-2018-7738", "sourceIdentifier": "cve@mitre.org", "published": "2018-03-07T02:29:03.533", "lastModified": "2020-09-25T18:15:13.193", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "In util-linux before 2.32-rc1, bash-completion/umount allows local users to gain privileges by embedding shell commands in a mountpoint name, which is mishandled during a umount command (within Bash) by a different user, as demonstrated by logging in as root and entering umount followed by a tab character for autocompletion."}, {"lang": "es", "value": "En util-linux, en versiones anteriores a la 2.32-rc1, bash-completion/umount permite que usuarios locales obtengan privilegios embebiendo comandos shell en un nombre mountpoint, que se gestiona de manera incorrecta durante un comando umount (en Bash) ejecutado por otro usuario. Esto se demuestra iniciando sesi\u00f3n como root y escribiendo unmount, seguido por un car\u00e1cter de tabulador para autocompletar."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 7.2}, "baseSeverity": "HIGH", "exploitabilityScore": 3.9, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kernel:util-linux:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.31", "matchCriteriaId": "94A373E4-EB6F-4ECB-AE6A-42B6278FAA9A"}]}]}], "references": [{"url": "http://www.securityfocus.com/bid/103367", "source": "cve@mitre.org", "tags": ["Third Party Advisory", "VDB Entry"]}, {"url": "https://bugs.debian.org/892179", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/karelzak/util-linux/commit/75f03badd7ed9f1dd951863d75e756883d3acc55", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/karelzak/util-linux/issues/539", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Third Party Advisory"]}, {"url": "https://usn.ubuntu.com/4512-1/", "source": "cve@mitre.org"}, {"url": "https://www.debian.org/security/2018/dsa-4134", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/karelzak/util-linux/commit/75f03badd7ed9f1dd951863d75e756883d3acc55"}}