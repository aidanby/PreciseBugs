{"buggy_code": ["# The majority of Puppet's configuration settings are set in this file.\nmodule Puppet\n  setdefaults(:main,\n    :confdir => [Puppet.run_mode.conf_dir, \"The main Puppet configuration directory.  The default for this setting is calculated based on the user.  If the process\n    is running as root or the user that Puppet is supposed to run as, it defaults to a system directory, but if it's running as any other user,\n    it defaults to being in the user's home directory.\"],\n    :vardir => [Puppet.run_mode.var_dir, \"Where Puppet stores dynamic and growing data.  The default for this setting is calculated specially, like `confdir`_.\"],\n    :name => [Puppet.application_name.to_s, \"The name of the application, if we are running as one.  The\n      default is essentially $0 without the path or `.rb`.\"],\n    :run_mode => [Puppet.run_mode.name.to_s, \"The effective 'run mode' of the application: master, agent, or user.\"]\n  )\n\n  setdefaults(:main, :logdir => Puppet.run_mode.logopts)\n\n  setdefaults(:main,\n    :trace => [false, \"Whether to print stack traces on some errors\"],\n    :autoflush => {\n      :default => true,\n      :desc    => \"Whether log files should always flush to disk.\",\n      :hook    => proc { |value| Log.autoflush = value }\n    },\n    :syslogfacility => [\"daemon\", \"What syslog facility to use when logging to\n      syslog.  Syslog has a fixed list of valid facilities, and you must\n      choose one of those; you cannot just make one up.\"],\n    :statedir => { :default => \"$vardir/state\",\n      :mode => 01755,\n      :desc => \"The directory where Puppet state is stored.  Generally,\n        this directory can be removed without causing harm (although it\n        might result in spurious service restarts).\"\n    },\n    :rundir => {\n      :default => Puppet.run_mode.run_dir,\n      :mode => 01777,\n      :desc => \"Where Puppet PID files are kept.\"\n    },\n    :genconfig => [false,\n      \"Whether to just print a configuration to stdout and exit.  Only makes\n      sense when used interactively.  Takes into account arguments specified\n      on the CLI.\"],\n    :genmanifest => [false,\n      \"Whether to just print a manifest to stdout and exit.  Only makes\n      sense when used interactively.  Takes into account arguments specified\n      on the CLI.\"],\n    :configprint => [\"\",\n      \"Print the value of a specific configuration setting.  If the name of a\n      setting is provided for this, then the value is printed and puppet\n      exits.  Comma-separate multiple values.  For a list of all values,\n      specify 'all'.\"],\n    :color => {\n      :default => \"ansi\",\n      :type    => :setting,\n      :desc    => \"Whether to use colors when logging to the console.  Valid values are\n      `ansi` (equivalent to `true`), `html`, and `false`, which produces no color.\",\n    },\n    :mkusers => [false,\n      \"Whether to create the necessary user and group that puppet agent will\n      run as.\"],\n    :manage_internal_file_permissions => [true,\n      \"Whether Puppet should manage the owner, group, and mode of files\n      it uses internally\"\n      ],\n    :onetime => {:default => false,\n      :desc => \"Run the configuration once, rather than as a long-running\n      daemon. This is useful for interactively running puppetd.\",\n      :short => 'o'\n      },\n    :path => {:default => \"none\",\n      :desc => \"The shell search path.  Defaults to whatever is inherited\n        from the parent process.\",\n      :call_on_define => true, # Call our hook with the default value, so we always get the libdir set.\n      :hook => proc do |value|\n        ENV[\"PATH\"] = \"\" if ENV[\"PATH\"].nil?\n        ENV[\"PATH\"] = value unless value == \"none\"\n        paths = ENV[\"PATH\"].split(File::PATH_SEPARATOR)\n        %w{/usr/sbin /sbin}.each do |path|\n          ENV[\"PATH\"] += File::PATH_SEPARATOR + path unless paths.include?(path)\n        end\n        value\n      end\n    },\n    :libdir => {:default => \"$vardir/lib\",\n      :desc => \"An extra search path for Puppet.  This is only useful\n        for those files that Puppet will load on demand, and is only\n        guaranteed to work for those cases.  In fact, the autoload\n        mechanism is responsible for making sure this directory\n        is in Ruby's search path\",\n      :call_on_define => true, # Call our hook with the default value, so we always get the libdir set.\n      :hook => proc do |value|\n        $LOAD_PATH.delete(@oldlibdir) if defined?(@oldlibdir) and $LOAD_PATH.include?(@oldlibdir)\n        @oldlibdir = value\n        $LOAD_PATH << value\n      end\n    },\n    :ignoreimport => [false, \"If true, allows the parser to continue without requiring\n      all files referenced with `import` statements to exist. This setting was primarily\n      designed for use with commit hooks for parse-checking.\"],\n    :authconfig => [ \"$confdir/namespaceauth.conf\",\n      \"The configuration file that defines the rights to the different\n      namespaces and methods.  This can be used as a coarse-grained\n      authorization system for both `puppet agent` and `puppet master`.\"\n    ],\n    :environment => {:default => \"production\", :desc => \"The environment Puppet is running in.  For clients\n      (e.g., `puppet agent`) this determines the environment itself, which\n      is used to find modules and much more.  For servers (i.e., `puppet master`) this provides the default environment for nodes\n      we know nothing about.\"\n    },\n    :diff_args => [\"-u\", \"Which arguments to pass to the diff command when printing differences between\n      files. The command to use can be chosen with the `diff` setting.\"],\n    :diff => {\n      :default => (Puppet.features.microsoft_windows? ? \"\" : \"diff\"),\n      :desc    => \"Which diff command to use when printing differences between files. This setting\n        has no default value on Windows, as standard `diff` is not available, but Puppet can use many\n        third-party diff tools.\",\n    },\n    :show_diff => [false, \"Whether to log and report a contextual diff when files are being replaced.  This causes\n      partial file contents to pass through Puppet's normal logging and reporting system, so this setting should be\n      used with caution if you are sending Puppet's reports to an insecure destination.\n      This feature currently requires the `diff/lcs` Ruby library.\"],\n    :daemonize => {\n      :default => (Puppet.features.microsoft_windows? ? false : true),\n      :desc => \"Whether to send the process into the background.  This defaults to true on POSIX systems,\n        and to false on Windows (where Puppet currently cannot daemonize).\",\n      :short => \"D\",\n      :hook => proc do |value|\n        if value and Puppet.features.microsoft_windows?\n          raise \"Cannot daemonize on Windows\"\n        end\n      end\n    },\n    :maximum_uid => [4294967290, \"The maximum allowed UID.  Some platforms use negative UIDs\n      but then ship with tools that do not know how to handle signed ints, so the UIDs show up as\n      huge numbers that can then not be fed back into the system.  This is a hackish way to fail in a\n      slightly more useful way when that happens.\"],\n    :route_file => [\"$confdir/routes.yaml\", \"The YAML file containing indirector route configuration.\"],\n    :node_terminus => [\"plain\", \"Where to find information about nodes.\"],\n    :catalog_terminus => [\"compiler\", \"Where to get node catalogs.  This is useful to change if, for instance,\n      you'd like to pre-compile catalogs and store them in memcached or some other easily-accessed store.\"],\n    :facts_terminus => {\n      :default => Puppet.application_name.to_s == \"master\" ? 'yaml' : 'facter',\n      :desc => \"The node facts terminus.\",\n      :hook => proc do |value|\n        require 'puppet/node/facts'\n        # Cache to YAML if we're uploading facts away\n        if %w[rest inventory_service].include? value.to_s\n          Puppet::Node::Facts.indirection.cache_class = :yaml\n        end\n      end\n    },\n    :inventory_terminus => [ \"$facts_terminus\", \"Should usually be the same as the facts terminus\" ],\n    :httplog => { :default => \"$logdir/http.log\",\n      :owner => \"root\",\n      :mode => 0640,\n      :desc => \"Where the puppet agent web server logs.\"\n    },\n    :http_proxy_host => [\"none\",\n      \"The HTTP proxy host to use for outgoing connections.  Note: You\n      may need to use a FQDN for the server hostname when using a proxy.\"],\n    :http_proxy_port => [3128, \"The HTTP proxy port to use for outgoing connections\"],\n    :filetimeout => [ 15,\n      \"The minimum time to wait (in seconds) between checking for updates in\n      configuration files.  This timeout determines how quickly Puppet checks whether\n      a file (such as manifests or templates) has changed on disk.\"\n    ],\n    :queue_type => [\"stomp\", \"Which type of queue to use for asynchronous processing.\"],\n    :queue_type => [\"stomp\", \"Which type of queue to use for asynchronous processing.\"],\n    :queue_source => [\"stomp://localhost:61613/\", \"Which type of queue to use for asynchronous processing.  If your stomp server requires\n      authentication, you can include it in the URI as long as your stomp client library is at least 1.1.1\"],\n    :async_storeconfigs => {:default => false, :desc => \"Whether to use a queueing system to provide asynchronous database integration.\n      Requires that `puppetqd` be running and that 'PSON' support for ruby be installed.\",\n      :hook => proc do |value|\n        if value\n          # This reconfigures the terminii for Node, Facts, and Catalog\n          Puppet.settings[:storeconfigs] = true\n\n          # But then we modify the configuration\n          Puppet::Resource::Catalog.indirection.cache_class = :queue\n        else\n          raise \"Cannot disable asynchronous storeconfigs in a running process\"\n        end\n      end\n    },\n    :thin_storeconfigs => {:default => false, :desc =>\n      \"Boolean; wether storeconfigs store in the database only the facts and exported resources.\n      If true, then storeconfigs performance will be higher and still allow exported/collected\n      resources, but other usage external to Puppet might not work\",\n      :hook => proc do |value|\n        Puppet.settings[:storeconfigs] = true if value\n        end\n      },\n    :config_version => [\"\", \"How to determine the configuration version.  By default, it will be the\n      time that the configuration is parsed, but you can provide a shell script to override how the\n      version is determined.  The output of this script will be added to every log message in the\n      reports, allowing you to correlate changes on your hosts to the source version on the server.\"],\n    :zlib => [true,\n      \"Boolean; whether to use the zlib library\",\n    ],\n    :prerun_command => [\"\", \"A command to run before every agent run.  If this command returns a non-zero\n      return code, the entire Puppet run will fail.\"],\n    :postrun_command => [\"\", \"A command to run after every agent run.  If this command returns a non-zero\n      return code, the entire Puppet run will be considered to have failed, even though it might have\n      performed work during the normal run.\"],\n    :freeze_main => [false, \"Freezes the 'main' class, disallowing any code to be added to it.  This\n      essentially means that you can't have any code outside of a node, class, or definition other\n      than in the site manifest.\"]\n  )\n  Puppet.setdefaults(:module_tool,\n    :module_repository  => ['http://forge.puppetlabs.com', \"The module repository\"],\n    :module_working_dir => ['$vardir/puppet-module', \"The directory into which module tool data is stored\"]\n  )\n\n  hostname = Facter[\"hostname\"].value\n  domain = Facter[\"domain\"].value\n  if domain and domain != \"\"\n    fqdn = [hostname, domain].join(\".\")\n  else\n    fqdn = hostname\n  end\n\n\n    Puppet.setdefaults(\n    :main,\n\n    # We have to downcase the fqdn, because the current ssl stuff (as oppsed to in master) doesn't have good facilities for\n    # manipulating naming.\n    :certname => {:default => fqdn.downcase, :desc => \"The name to use when handling certificates.  Defaults\n      to the fully qualified domain name.\",\n      :call_on_define => true, # Call our hook with the default value, so we're always downcased\n      :hook => proc { |value| raise(ArgumentError, \"Certificate names must be lower case; see #1168\") unless value == value.downcase }},\n    :certdnsnames => {\n      :default => '',\n      :hook    => proc do |value|\n        unless value.nil? or value == '' then\n          Puppet.warning <<WARN\nThe `certdnsnames` setting is no longer functional,\nafter CVE-2011-3872. We ignore the value completely.\n\nFor your own certificate request you can set `dns_alt_names` in the\nconfiguration and it will apply locally.  There is no configuration option to\nset DNS alt names, or any other `subjectAltName` value, for another nodes\ncertificate.\n\nAlternately you can use the `--dns_alt_names` command line option to set the\nlabels added while generating your own CSR.\nWARN\n        end\n      end,\n      :desc    => <<EOT\nThe `certdnsnames` setting is no longer functional,\nafter CVE-2011-3872. We ignore the value completely.\n\nFor your own certificate request you can set `dns_alt_names` in the\nconfiguration and it will apply locally.  There is no configuration option to\nset DNS alt names, or any other `subjectAltName` value, for another nodes\ncertificate.\n\nAlternately you can use the `--dns_alt_names` command line option to set the\nlabels added while generating your own CSR.\nEOT\n    },\n    :dns_alt_names => {\n      :default => '',\n      :desc    => <<EOT,\nThe comma-separated list of alternative DNS names to use for the local host.\n\nWhen the node generates a CSR for itself, these are added to the request\nas the desired `subjectAltName` in the certificate: additional DNS labels\nthat the certificate is also valid answering as.\n\nThis is generally required if you use a non-hostname `certname`, or if you\nwant to use `puppet kick` or `puppet resource -H` and the primary certname\ndoes not match the DNS name you use to communicate with the host.\n\nThis is unnecessary for agents, unless you intend to use them as a server for\n`puppet kick` or remote `puppet resource` management.\n\nIt is rarely necessary for servers; it is usually helpful only if you need to\nhave a pool of multiple load balanced masters, or for the same master to\nrespond on two physically separate networks under different names.\nEOT\n    },\n    :certdir => {\n      :default => \"$ssldir/certs\",\n      :owner => \"service\",\n      :desc => \"The certificate directory.\"\n    },\n    :ssldir => {\n      :default => \"$confdir/ssl\",\n      :mode => 0771,\n      :owner => \"service\",\n      :desc => \"Where SSL certificates are kept.\"\n    },\n    :publickeydir => {\n      :default => \"$ssldir/public_keys\",\n      :owner => \"service\",\n      :desc => \"The public key directory.\"\n    },\n    :requestdir => {\n      :default => \"$ssldir/certificate_requests\",\n      :owner => \"service\",\n      :desc => \"Where host certificate requests are stored.\"\n    },\n    :privatekeydir => { :default => \"$ssldir/private_keys\",\n      :mode => 0750,\n      :owner => \"service\",\n      :desc => \"The private key directory.\"\n    },\n    :privatedir => { :default => \"$ssldir/private\",\n      :mode => 0750,\n      :owner => \"service\",\n      :desc => \"Where the client stores private certificate information.\"\n    },\n    :passfile => { :default => \"$privatedir/password\",\n      :mode => 0640,\n      :owner => \"service\",\n      :desc => \"Where puppet agent stores the password for its private key.\n        Generally unused.\"\n    },\n    :hostcsr => { :default => \"$ssldir/csr_$certname.pem\",\n      :mode => 0644,\n      :owner => \"service\",\n      :desc => \"Where individual hosts store and look for their certificate requests.\"\n    },\n    :hostcert => { :default => \"$certdir/$certname.pem\",\n      :mode => 0644,\n      :owner => \"service\",\n      :desc => \"Where individual hosts store and look for their certificates.\"\n    },\n    :hostprivkey => { :default => \"$privatekeydir/$certname.pem\",\n      :mode => 0600,\n      :owner => \"service\",\n      :desc => \"Where individual hosts store and look for their private key.\"\n    },\n    :hostpubkey => { :default => \"$publickeydir/$certname.pem\",\n      :mode => 0644,\n      :owner => \"service\",\n      :desc => \"Where individual hosts store and look for their public key.\"\n    },\n    :localcacert => { :default => \"$certdir/ca.pem\",\n      :mode => 0644,\n      :owner => \"service\",\n      :desc => \"Where each client stores the CA certificate.\"\n    },\n    :hostcrl => { :default => \"$ssldir/crl.pem\",\n      :mode => 0644,\n      :owner => \"service\",\n      :desc => \"Where the host's certificate revocation list can be found.\n        This is distinct from the certificate authority's CRL.\"\n    },\n    :certificate_revocation => [true, \"Whether certificate revocation should be supported by downloading a Certificate Revocation List (CRL)\n      to all clients.  If enabled, CA chaining will almost definitely not work.\"]\n  )\n\n    setdefaults(\n    :ca,\n    :ca_name => [\"Puppet CA: $certname\", \"The name to use the Certificate Authority certificate.\"],\n    :cadir => {  :default => \"$ssldir/ca\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0770,\n      :desc => \"The root directory for the certificate authority.\"\n    },\n    :cacert => { :default => \"$cadir/ca_crt.pem\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0660,\n      :desc => \"The CA certificate.\"\n    },\n    :cakey => { :default => \"$cadir/ca_key.pem\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0660,\n      :desc => \"The CA private key.\"\n    },\n    :capub => { :default => \"$cadir/ca_pub.pem\",\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"The CA public key.\"\n    },\n    :cacrl => { :default => \"$cadir/ca_crl.pem\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0664,\n\n      :desc => \"The certificate revocation list (CRL) for the CA. Will be used if present but otherwise ignored.\",\n      :hook => proc do |value|\n        if value == 'false'\n          Puppet.warning \"Setting the :cacrl to 'false' is deprecated; Puppet will just ignore the crl if yours is missing\"\n        end\n      end\n    },\n    :caprivatedir => { :default => \"$cadir/private\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0770,\n      :desc => \"Where the CA stores private certificate information.\"\n    },\n    :csrdir => { :default => \"$cadir/requests\",\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"Where the CA stores certificate requests\"\n    },\n    :signeddir => { :default => \"$cadir/signed\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0770,\n      :desc => \"Where the CA stores signed certificates.\"\n    },\n    :capass => { :default => \"$caprivatedir/ca.pass\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0660,\n      :desc => \"Where the CA stores the password for the private key\"\n    },\n    :serial => { :default => \"$cadir/serial\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0644,\n      :desc => \"Where the serial number for certificates is stored.\"\n    },\n    :autosign => { :default => \"$confdir/autosign.conf\",\n      :mode => 0644,\n      :desc => \"Whether to enable autosign.  Valid values are true (which\n        autosigns any key request, and is a very bad idea), false (which\n        never autosigns any key request), and the path to a file, which\n        uses that configuration file to determine which keys to sign.\"},\n    :allow_duplicate_certs => [false, \"Whether to allow a new certificate\n      request to overwrite an existing certificate.\"],\n    :ca_days => [\"\", \"How long a certificate should be valid, in days.\n      This setting is deprecated; use `ca_ttl` instead\"],\n    :ca_ttl => [\"5y\", \"The default TTL for new certificates; valid values\n      must be an integer, optionally followed by one of the units\n      'y' (years of 365 days), 'd' (days), 'h' (hours), or\n      's' (seconds). The unit defaults to seconds. If this setting\n      is set, ca_days is ignored. Examples are '3600' (one hour)\n      and '1825d', which is the same as '5y' (5 years) \"],\n    :ca_md => [\"md5\", \"The type of hash used in certificates.\"],\n    :req_bits => [4096, \"The bit length of the certificates.\"],\n    :keylength => [4096, \"The bit length of keys.\"],\n    :cert_inventory => {\n      :default => \"$cadir/inventory.txt\",\n      :mode => 0644,\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"A Complete listing of all certificates\"\n    }\n  )\n\n  # Define the config default.\n\n    setdefaults(\n    Puppet.settings[:name],\n    :config => [\"$confdir/puppet.conf\",\n      \"The configuration file for #{Puppet[:name]}.\"],\n    :pidfile => [\"$rundir/$name.pid\", \"The pid file\"],\n    :bindaddress => [\"\", \"The address a listening server should bind to.  Mongrel servers\n      default to 127.0.0.1 and WEBrick defaults to 0.0.0.0.\"],\n    :servertype => {:default => \"webrick\", :desc => \"The type of server to use.  Currently supported\n      options are webrick and mongrel.  If you use mongrel, you will need\n      a proxy in front of the process or processes, since Mongrel cannot\n      speak SSL.\",\n\n      :call_on_define => true, # Call our hook with the default value, so we always get the correct bind address set.\n      :hook => proc { |value|  value == \"webrick\" ? Puppet.settings[:bindaddress] = \"0.0.0.0\" : Puppet.settings[:bindaddress] = \"127.0.0.1\" if Puppet.settings[:bindaddress] == \"\" }\n    }\n  )\n\n  setdefaults(:master,\n    :user => [\"puppet\", \"The user puppet master should run as.\"],\n    :group => [\"puppet\", \"The group puppet master should run as.\"],\n    :manifestdir => [\"$confdir/manifests\", \"Where puppet master looks for its manifests.\"],\n    :manifest => [\"$manifestdir/site.pp\", \"The entry-point manifest for puppet master.\"],\n    :code => [\"\", \"Code to parse directly.  This is essentially only used\n      by `puppet`, and should only be set if you're writing your own Puppet\n      executable\"],\n    :masterlog => { :default => \"$logdir/puppetmaster.log\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0660,\n      :desc => \"Where puppet master logs.  This is generally not used,\n        since syslog is the default log destination.\"\n    },\n    :masterhttplog => { :default => \"$logdir/masterhttp.log\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0660,\n      :create => true,\n      :desc => \"Where the puppet master web server logs.\"\n    },\n    :masterport => [8140, \"Which port puppet master listens on.\"],\n    :node_name => [\"cert\", \"How the puppet master determines the client's identity\n      and sets the 'hostname', 'fqdn' and 'domain' facts for use in the manifest,\n      in particular for determining which 'node' statement applies to the client.\n      Possible values are 'cert' (use the subject's CN in the client's\n      certificate) and 'facter' (use the hostname that the client\n      reported in its facts)\"],\n    :bucketdir => {\n      :default => \"$vardir/bucket\",\n      :mode => 0750,\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"Where FileBucket files are stored.\"\n    },\n    :rest_authconfig => [ \"$confdir/auth.conf\",\n      \"The configuration file that defines the rights to the different\n      rest indirections.  This can be used as a fine-grained\n      authorization system for `puppet master`.\"\n    ],\n    :ca => [true, \"Wether the master should function as a certificate authority.\"],\n    :modulepath => {\n      :default => \"$confdir/modules#{File::PATH_SEPARATOR}/usr/share/puppet/modules\",\n      :desc => \"The search path for modules, as a list of directories separated by the system path separator character. (The POSIX path separator is ':', and the Windows path separator is ';'.)\",\n      :type => :setting # We don't want this to be considered a file, since it's multiple files.\n    },\n    :ssl_client_header => [\"HTTP_X_CLIENT_DN\", \"The header containing an authenticated\n      client's SSL DN.  Only used with Mongrel.  This header must be set by the proxy\n      to the authenticated client's SSL DN (e.g., `/CN=puppet.puppetlabs.com`).\n      See http://projects.puppetlabs.com/projects/puppet/wiki/Using_Mongrel for more information.\"],\n    :ssl_client_verify_header => [\"HTTP_X_CLIENT_VERIFY\", \"The header containing the status\n      message of the client verification. Only used with Mongrel.  This header must be set by the proxy\n      to 'SUCCESS' if the client successfully authenticated, and anything else otherwise.\n      See http://projects.puppetlabs.com/projects/puppet/wiki/Using_Mongrel for more information.\"],\n    # To make sure this directory is created before we try to use it on the server, we need\n    # it to be in the server section (#1138).\n    :yamldir => {:default => \"$vardir/yaml\", :owner => \"service\", :group => \"service\", :mode => \"750\",\n      :desc => \"The directory in which YAML data is stored, usually in a subdirectory.\"},\n    :server_datadir => {:default => \"$vardir/server_data\", :owner => \"service\", :group => \"service\", :mode => \"750\",\n      :desc => \"The directory in which serialized data is stored, usually in a subdirectory.\"},\n    :reports => [\"store\",\n      \"The list of reports to generate.  All reports are looked for\n      in `puppet/reports/name.rb`, and multiple report names should be\n      comma-separated (whitespace is okay).\"\n    ],\n    :reportdir => {:default => \"$vardir/reports\",\n      :mode => 0750,\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"The directory in which to store reports\n        received from the client.  Each client gets a separate\n        subdirectory.\"},\n    :reporturl => [\"http://localhost:3000/reports/upload\",\n      \"The URL used by the http reports processor to send reports\"],\n    :fileserverconfig => [\"$confdir/fileserver.conf\", \"Where the fileserver configuration is stored.\"],\n    :strict_hostname_checking => [false, \"Whether to only search for the complete\n      hostname as it is in the certificate when searching for node information\n      in the catalogs.\"]\n  )\n\n  setdefaults(:metrics,\n    :rrddir => {:default => \"$vardir/rrd\",\n      :mode => 0750,\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"The directory where RRD database files are stored.\n        Directories for each reporting host will be created under\n        this directory.\"\n    },\n    :rrdinterval => [\"$runinterval\", \"How often RRD should expect data.\n      This should match how often the hosts report back to the server.\"]\n  )\n\n  setdefaults(:device,\n    :devicedir =>  {:default => \"$vardir/devices\", :mode => \"750\", :desc => \"The root directory of devices' $vardir\"},\n    :deviceconfig => [\"$confdir/device.conf\",\"Path to the device config file for puppet device\"]\n  )\n\n  setdefaults(:agent,\n    :node_name_value => { :default => \"$certname\",\n      :desc => \"The explicit value used for the node name for all requests the agent\n        makes to the master. WARNING: This setting is mutually exclusive with\n        node_name_fact.  Changing this setting also requires changes to the default\n        auth.conf configuration on the Puppet Master.  Please see\n        http://links.puppetlabs.com/node_name_value for more information.\"\n    },\n    :node_name_fact => { :default => \"\",\n      :desc => \"The fact name used to determine the node name used for all requests the agent\n        makes to the master. WARNING: This setting is mutually exclusive with\n        node_name_value.  Changing this setting also requires changes to the default\n        auth.conf configuration on the Puppet Master.  Please see\n        http://links.puppetlabs.com/node_name_fact for more information.\",\n      :hook => proc do |value|\n        if !value.empty? and Puppet[:node_name_value] != Puppet[:certname]\n          raise \"Cannot specify both the node_name_value and node_name_fact settings\"\n        end\n      end\n    },\n    :localconfig => { :default => \"$statedir/localconfig\",\n      :owner => \"root\",\n      :mode => 0660,\n      :desc => \"Where puppet agent caches the local configuration.  An\n        extension indicating the cache format is added automatically.\"},\n    :statefile => { :default => \"$statedir/state.yaml\",\n      :mode => 0660,\n      :desc => \"Where puppet agent and puppet master store state associated\n        with the running configuration.  In the case of puppet master,\n        this file reflects the state discovered through interacting\n        with clients.\"\n      },\n    :clientyamldir => {:default => \"$vardir/client_yaml\", :mode => \"750\", :desc => \"The directory in which client-side YAML data is stored.\"},\n    :client_datadir => {:default => \"$vardir/client_data\", :mode => \"750\", :desc => \"The directory in which serialized data is stored on the client.\"},\n    :classfile => { :default => \"$statedir/classes.txt\",\n      :owner => \"root\",\n      :mode => 0644,\n      :desc => \"The file in which puppet agent stores a list of the classes\n        associated with the retrieved configuration.  Can be loaded in\n        the separate `puppet` executable using the `--loadclasses`\n        option.\"},\n    :resourcefile => { :default => \"$statedir/resources.txt\",\n      :owner => \"root\",\n      :mode => 0644,\n      :desc => \"The file in which puppet agent stores a list of the resources\n        associated with the retrieved configuration.\"  },\n    :puppetdlog => { :default => \"$logdir/puppetd.log\",\n      :owner => \"root\",\n      :mode => 0640,\n      :desc => \"The log file for puppet agent.  This is generally not used.\"\n    },\n    :server => [\"puppet\", \"The server to which server puppet agent should connect\"],\n    :ignoreschedules => [false,\n      \"Boolean; whether puppet agent should ignore schedules.  This is useful\n      for initial puppet agent runs.\"],\n    :puppetport => [8139, \"Which port puppet agent listens on.\"],\n    :noop => [false, \"Whether puppet agent should be run in noop mode.\"],\n    :runinterval => [1800, # 30 minutes\n      \"How often puppet agent applies the client configuration; in seconds.\n      Note that a runinterval of 0 means \\\"run continuously\\\" rather than\n      \\\"never run.\\\" If you want puppet agent to never run, you should start\n      it with the `--no-client` option.\"],\n    :listen => [false, \"Whether puppet agent should listen for\n      connections.  If this is true, then puppet agent will accept incoming\n      REST API requests, subject to the default ACLs and the ACLs set in\n      the `rest_authconfig` file. Puppet agent can respond usefully to\n      requests on the `run`, `facts`, `certificate`, and `resource` endpoints.\"],\n    :ca_server => [\"$server\", \"The server to use for certificate\n      authority requests.  It's a separate server because it cannot\n      and does not need to horizontally scale.\"],\n    :ca_port => [\"$masterport\", \"The port to use for the certificate authority.\"],\n    :catalog_format => {\n      :default => \"\",\n      :desc => \"(Deprecated for 'preferred_serialization_format') What format to\n        use to dump the catalog.  Only supports 'marshal' and 'yaml'.  Only\n        matters on the client, since it asks the server for a specific format.\",\n      :hook => proc { |value|\n        if value\n          Puppet.warning \"Setting 'catalog_format' is deprecated; use 'preferred_serialization_format' instead.\"\n          Puppet.settings[:preferred_serialization_format] = value\n        end\n      }\n    },\n    :preferred_serialization_format => [\"pson\", \"The preferred means of serializing\n      ruby instances for passing over the wire.  This won't guarantee that all\n      instances will be serialized using this method, since not all classes\n      can be guaranteed to support this format, but it will be used for all\n      classes that support it.\"],\n    :puppetdlockfile => [ \"$statedir/puppetdlock\", \"A lock file to temporarily stop puppet agent from doing anything.\"],\n    :usecacheonfailure => [true,\n      \"Whether to use the cached configuration when the remote\n      configuration will not compile.  This option is useful for testing\n      new configurations, where you want to fix the broken configuration\n      rather than reverting to a known-good one.\"\n    ],\n    :use_cached_catalog => [false,\n      \"Whether to only use the cached catalog rather than compiling a new catalog\n      on every run.  Puppet can be run with this enabled by default and then selectively\n      disabled when a recompile is desired.\"],\n    :ignorecache => [false,\n      \"Ignore cache and always recompile the configuration.  This is\n      useful for testing new configurations, where the local cache may in\n      fact be stale even if the timestamps are up to date - if the facts\n      change or if the server changes.\"\n    ],\n    :downcasefacts => [false, \"Whether facts should be made all lowercase when sent to the server.\"],\n    :dynamicfacts => [\"memorysize,memoryfree,swapsize,swapfree\",\n      \"Facts that are dynamic; these facts will be ignored when deciding whether\n      changed facts should result in a recompile.  Multiple facts should be\n      comma-separated.\"],\n    :splaylimit => [\"$runinterval\",\n      \"The maximum time to delay before runs.  Defaults to being the same as the\n      run interval.\"],\n    :splay => [false,\n      \"Whether to sleep for a pseudo-random (but consistent) amount of time before\n      a run.\"],\n    :clientbucketdir => {\n      :default => \"$vardir/clientbucket\",\n      :mode => 0750,\n      :desc => \"Where FileBucket files are stored locally.\"\n    },\n    :configtimeout => [120,\n      \"How long the client should wait for the configuration to be retrieved\n      before considering it a failure.  This can help reduce flapping if too\n      many clients contact the server at one time.\"\n    ],\n    :reportserver => {\n      :default => \"$server\",\n      :call_on_define => false,\n      :desc => \"(Deprecated for 'report_server') The server to which to send transaction reports.\",\n      :hook => proc do |value|\n        Puppet.settings[:report_server] = value if value\n      end\n    },\n    :report_server => [\"$server\",\n      \"The server to send transaction reports to.\"\n    ],\n    :report_port => [\"$masterport\",\n      \"The port to communicate with the report_server.\"\n    ],\n    :inventory_server => [\"$server\",\n      \"The server to send facts to.\"\n    ],\n    :inventory_port => [\"$masterport\",\n      \"The port to communicate with the inventory_server.\"\n    ],\n    :report => [true,\n      \"Whether to send reports after every transaction.\"\n    ],\n    :lastrunfile =>  { :default => \"$statedir/last_run_summary.yaml\",\n      :mode => 0644,\n      :desc => \"Where puppet agent stores the last run report summary in yaml format.\"\n    },\n    :lastrunreport =>  { :default => \"$statedir/last_run_report.yaml\",\n      :mode => 0644,\n      :desc => \"Where puppet agent stores the last run report in yaml format.\"\n    },\n    :graph => [false, \"Whether to create dot graph files for the different\n      configuration graphs.  These dot files can be interpreted by tools\n      like OmniGraffle or dot (which is part of ImageMagick).\"],\n    :graphdir => [\"$statedir/graphs\", \"Where to store dot-outputted graphs.\"],\n    :http_compression => [false, \"Allow http compression in REST communication with the master.\n      This setting might improve performance for agent -> master communications over slow WANs.\n      Your puppet master needs to support compression (usually by activating some settings in a reverse-proxy\n      in front of the puppet master, which rules out webrick).\n      It is harmless to activate this settings if your master doesn't support\n      compression, but if it supports it, this setting might reduce performance on high-speed LANs.\"]\n  )\n\n  setdefaults(:inspect,\n      :archive_files => [false, \"During an inspect run, whether to archive files whose contents are audited to a file bucket.\"],\n      :archive_file_server => [\"$server\", \"During an inspect run, the file bucket server to archive files to if archive_files is set.\"]\n  )\n\n  # Plugin information.\n\n    setdefaults(\n    :main,\n    :plugindest => [\"$libdir\",\n      \"Where Puppet should store plugins that it pulls down from the central\n      server.\"],\n    :pluginsource => [\"puppet://$server/plugins\",\n      \"From where to retrieve plugins.  The standard Puppet `file` type\n      is used for retrieval, so anything that is a valid file source can\n      be used here.\"],\n    :pluginsync => [false, \"Whether plugins should be synced with the central server.\"],\n\n    :pluginsignore => [\".svn CVS .git\", \"What files to ignore when pulling down plugins.\"]\n  )\n\n  # Central fact information.\n\n    setdefaults(\n    :main,\n    :factpath => {:default => \"$vardir/lib/facter#{File::PATH_SEPARATOR}$vardir/facts\",\n      :desc => \"Where Puppet should look for facts.  Multiple directories should\n        be separated by the system path separator character. (The POSIX path separator is ':', and the Windows path separator is ';'.)\",\n\n      :call_on_define => true, # Call our hook with the default value, so we always get the value added to facter.\n      :type => :setting, # Don't consider it a file, because it could be multiple colon-separated files\n      :hook => proc { |value| Facter.search(value) if Facter.respond_to?(:search) }},\n    :factdest => [\"$vardir/facts/\",\n      \"Where Puppet should store facts that it pulls down from the central\n      server.\"],\n    :factsource => [\"puppet://$server/facts/\",\n      \"From where to retrieve facts.  The standard Puppet `file` type\n      is used for retrieval, so anything that is a valid file source can\n      be used here.\"],\n    :factsync => [false, \"Whether facts should be synced with the central server.\"],\n    :factsignore => [\".svn CVS\", \"What files to ignore when pulling down facts.\"]\n  )\n\n\n    setdefaults(\n    :tagmail,\n    :tagmap => [\"$confdir/tagmail.conf\", \"The mapping between reporting tags and email addresses.\"],\n    :sendmail => [which('sendmail') || '', \"Where to find the sendmail binary with which to send email.\"],\n\n    :reportfrom => [\"report@\" + [Facter[\"hostname\"].value, Facter[\"domain\"].value].join(\".\"), \"The 'from' email address for the reports.\"],\n    :smtpserver => [\"none\", \"The server through which to send email reports.\"]\n  )\n\n    setdefaults(\n    :rails,\n    :dblocation => { :default => \"$statedir/clientconfigs.sqlite3\",\n      :mode => 0660,\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"The database cache for client configurations.  Used for\n        querying within the language.\"\n    },\n    :dbadapter => [ \"sqlite3\", \"The type of database to use.\" ],\n    :dbmigrate => [ false, \"Whether to automatically migrate the database.\" ],\n    :dbname => [ \"puppet\", \"The name of the database to use.\" ],\n    :dbserver => [ \"localhost\", \"The database server for caching. Only\n      used when networked databases are used.\"],\n    :dbport => [ \"\", \"The database password for caching. Only\n      used when networked databases are used.\"],\n    :dbuser => [ \"puppet\", \"The database user for caching. Only\n      used when networked databases are used.\"],\n    :dbpassword => [ \"puppet\", \"The database password for caching. Only\n      used when networked databases are used.\"],\n    :dbconnections => [ '', \"The number of database connections for networked\n      databases.  Will be ignored unless the value is a positive integer.\"],\n    :dbsocket => [ \"\", \"The database socket location. Only used when networked\n      databases are used.  Will be ignored if the value is an empty string.\"],\n    :railslog => {:default => \"$logdir/rails.log\",\n      :mode => 0600,\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"Where Rails-specific logs are sent\"\n    },\n\n    :rails_loglevel => [\"info\", \"The log level for Rails connections.  The value must be\n      a valid log level within Rails.  Production environments normally use `info`\n      and other environments normally use `debug`.\"]\n  )\n\n    setdefaults(\n    :couchdb,\n\n    :couchdb_url => [\"http://127.0.0.1:5984/puppet\", \"The url where the puppet couchdb database will be created\"]\n  )\n\n    setdefaults(\n    :transaction,\n    :tags => [\"\", \"Tags to use to find resources.  If this is set, then\n      only resources tagged with the specified tags will be applied.\n      Values must be comma-separated.\"],\n    :evaltrace => [false, \"Whether each resource should log when it is\n      being evaluated.  This allows you to interactively see exactly\n      what is being done.\"],\n    :summarize => [false,\n\n      \"Whether to print a transaction summary.\"\n    ]\n  )\n\n    setdefaults(\n    :main,\n    :external_nodes => [\"none\",\n\n      \"An external command that can produce node information.  The command's output\n      must be a YAML dump of a hash, and that hash must have a `classes` key and/or\n      a `parameters` key, where `classes` is an array or hash and\n      `parameters` is a hash.  For unknown nodes, the command should\n      exit with a non-zero exit code.\n\n      This command makes it straightforward to store your node mapping\n      information in other data sources like databases.\"])\n\n        setdefaults(\n        :ldap,\n    :ldapnodes => [false,\n      \"Whether to search for node configurations in LDAP.  See\n      http://projects.puppetlabs.com/projects/puppet/wiki/LDAP_Nodes for more information.\"],\n    :ldapssl => [false,\n      \"Whether SSL should be used when searching for nodes.\n      Defaults to false because SSL usually requires certificates\n      to be set up on the client side.\"],\n    :ldaptls => [false,\n      \"Whether TLS should be used when searching for nodes.\n      Defaults to false because TLS usually requires certificates\n      to be set up on the client side.\"],\n    :ldapserver => [\"ldap\",\n      \"The LDAP server.  Only used if `ldapnodes` is enabled.\"],\n    :ldapport => [389,\n      \"The LDAP port.  Only used if `ldapnodes` is enabled.\"],\n\n    :ldapstring => [\"(&(objectclass=puppetClient)(cn=%s))\",\n      \"The search string used to find an LDAP node.\"],\n    :ldapclassattrs => [\"puppetclass\",\n      \"The LDAP attributes to use to define Puppet classes.  Values\n      should be comma-separated.\"],\n    :ldapstackedattrs => [\"puppetvar\",\n      \"The LDAP attributes that should be stacked to arrays by adding\n      the values in all hierarchy elements of the tree.  Values\n      should be comma-separated.\"],\n    :ldapattrs => [\"all\",\n      \"The LDAP attributes to include when querying LDAP for nodes.  All\n      returned attributes are set as variables in the top-level scope.\n      Multiple values should be comma-separated.  The value 'all' returns\n      all attributes.\"],\n    :ldapparentattr => [\"parentnode\",\n      \"The attribute to use to define the parent node.\"],\n    :ldapuser => [\"\",\n      \"The user to use to connect to LDAP.  Must be specified as a\n      full DN.\"],\n    :ldappassword => [\"\", \"The password to use to connect to LDAP.\"],\n    :ldapbase => [\"\",\n      \"The search base for LDAP searches.  It's impossible to provide\n      a meaningful default here, although the LDAP libraries might\n      have one already set.  Generally, it should be the 'ou=Hosts'\n      branch under your main directory.\"]\n  )\n\n  setdefaults(:master,\n    :storeconfigs => {\n      :default => false,\n      :desc => \"Whether to store each client's configuration, including catalogs, facts,\nand related data.  This also enables the import and export of resources in\nthe Puppet language - a mechanism for exchange resources between nodes.\n\nBy default this uses ActiveRecord and an SQL database to store and query\nthe data; this, in turn, will depend on Rails being available.\n\nYou can adjust the backend using the storeconfigs_backend setting.\",\n      # Call our hook with the default value, so we always get the libdir set.\n      :call_on_define => true,\n      :hook => proc do |value|\n        require 'puppet/node'\n        require 'puppet/node/facts'\n        if value\n          Puppet.settings[:async_storeconfigs] or\n            Puppet::Resource::Catalog.indirection.cache_class = :store_configs\n          Puppet::Node::Facts.indirection.cache_class = :store_configs\n          Puppet::Node.indirection.cache_class = :store_configs\n\n          Puppet::Resource.indirection.terminus_class = :store_configs\n        end\n      end\n    },\n    :storeconfigs_backend => {\n      :default => \"active_record\",\n      :desc => \"Configure the backend terminus used for StoreConfigs.\nBy default, this uses the ActiveRecord store, which directly talks to the\ndatabase from within the Puppet Master process.\"\n    }\n  )\n\n  # This doesn't actually work right now.\n\n    setdefaults(\n    :parser,\n\n    :lexical => [false, \"Whether to use lexical scoping (vs. dynamic).\"],\n    :templatedir => [\"$vardir/templates\",\n      \"Where Puppet looks for template files.  Can be a list of colon-separated\n      directories.\"\n    ]\n  )\n  setdefaults(\n    :puppetdoc,\n    :document_all => [false, \"Document all resources\"]\n  )\nend\n"], "fixing_code": ["# The majority of Puppet's configuration settings are set in this file.\nmodule Puppet\n  setdefaults(:main,\n    :confdir => [Puppet.run_mode.conf_dir, \"The main Puppet configuration directory.  The default for this setting is calculated based on the user.  If the process\n    is running as root or the user that Puppet is supposed to run as, it defaults to a system directory, but if it's running as any other user,\n    it defaults to being in the user's home directory.\"],\n    :vardir => [Puppet.run_mode.var_dir, \"Where Puppet stores dynamic and growing data.  The default for this setting is calculated specially, like `confdir`_.\"],\n    :name => [Puppet.application_name.to_s, \"The name of the application, if we are running as one.  The\n      default is essentially $0 without the path or `.rb`.\"],\n    :run_mode => [Puppet.run_mode.name.to_s, \"The effective 'run mode' of the application: master, agent, or user.\"]\n  )\n\n  setdefaults(:main, :logdir => Puppet.run_mode.logopts)\n\n  setdefaults(:main,\n    :trace => [false, \"Whether to print stack traces on some errors\"],\n    :autoflush => {\n      :default => true,\n      :desc    => \"Whether log files should always flush to disk.\",\n      :hook    => proc { |value| Log.autoflush = value }\n    },\n    :syslogfacility => [\"daemon\", \"What syslog facility to use when logging to\n      syslog.  Syslog has a fixed list of valid facilities, and you must\n      choose one of those; you cannot just make one up.\"],\n    :statedir => { :default => \"$vardir/state\",\n      :mode => 01755,\n      :desc => \"The directory where Puppet state is stored.  Generally,\n        this directory can be removed without causing harm (although it\n        might result in spurious service restarts).\"\n    },\n    :rundir => {\n      :default => Puppet.run_mode.run_dir,\n      :mode => 01777,\n      :desc => \"Where Puppet PID files are kept.\"\n    },\n    :genconfig => [false,\n      \"Whether to just print a configuration to stdout and exit.  Only makes\n      sense when used interactively.  Takes into account arguments specified\n      on the CLI.\"],\n    :genmanifest => [false,\n      \"Whether to just print a manifest to stdout and exit.  Only makes\n      sense when used interactively.  Takes into account arguments specified\n      on the CLI.\"],\n    :configprint => [\"\",\n      \"Print the value of a specific configuration setting.  If the name of a\n      setting is provided for this, then the value is printed and puppet\n      exits.  Comma-separate multiple values.  For a list of all values,\n      specify 'all'.\"],\n    :color => {\n      :default => \"ansi\",\n      :type    => :setting,\n      :desc    => \"Whether to use colors when logging to the console.  Valid values are\n      `ansi` (equivalent to `true`), `html`, and `false`, which produces no color.\",\n    },\n    :mkusers => [false,\n      \"Whether to create the necessary user and group that puppet agent will\n      run as.\"],\n    :manage_internal_file_permissions => [true,\n      \"Whether Puppet should manage the owner, group, and mode of files\n      it uses internally\"\n      ],\n    :onetime => {:default => false,\n      :desc => \"Run the configuration once, rather than as a long-running\n      daemon. This is useful for interactively running puppetd.\",\n      :short => 'o'\n      },\n    :path => {:default => \"none\",\n      :desc => \"The shell search path.  Defaults to whatever is inherited\n        from the parent process.\",\n      :call_on_define => true, # Call our hook with the default value, so we always get the libdir set.\n      :hook => proc do |value|\n        ENV[\"PATH\"] = \"\" if ENV[\"PATH\"].nil?\n        ENV[\"PATH\"] = value unless value == \"none\"\n        paths = ENV[\"PATH\"].split(File::PATH_SEPARATOR)\n        %w{/usr/sbin /sbin}.each do |path|\n          ENV[\"PATH\"] += File::PATH_SEPARATOR + path unless paths.include?(path)\n        end\n        value\n      end\n    },\n    :libdir => {:default => \"$vardir/lib\",\n      :desc => \"An extra search path for Puppet.  This is only useful\n        for those files that Puppet will load on demand, and is only\n        guaranteed to work for those cases.  In fact, the autoload\n        mechanism is responsible for making sure this directory\n        is in Ruby's search path\",\n      :call_on_define => true, # Call our hook with the default value, so we always get the libdir set.\n      :hook => proc do |value|\n        $LOAD_PATH.delete(@oldlibdir) if defined?(@oldlibdir) and $LOAD_PATH.include?(@oldlibdir)\n        @oldlibdir = value\n        $LOAD_PATH << value\n      end\n    },\n    :ignoreimport => [false, \"If true, allows the parser to continue without requiring\n      all files referenced with `import` statements to exist. This setting was primarily\n      designed for use with commit hooks for parse-checking.\"],\n    :authconfig => [ \"$confdir/namespaceauth.conf\",\n      \"The configuration file that defines the rights to the different\n      namespaces and methods.  This can be used as a coarse-grained\n      authorization system for both `puppet agent` and `puppet master`.\"\n    ],\n    :environment => {:default => \"production\", :desc => \"The environment Puppet is running in.  For clients\n      (e.g., `puppet agent`) this determines the environment itself, which\n      is used to find modules and much more.  For servers (i.e., `puppet master`) this provides the default environment for nodes\n      we know nothing about.\"\n    },\n    :diff_args => [\"-u\", \"Which arguments to pass to the diff command when printing differences between\n      files. The command to use can be chosen with the `diff` setting.\"],\n    :diff => {\n      :default => (Puppet.features.microsoft_windows? ? \"\" : \"diff\"),\n      :desc    => \"Which diff command to use when printing differences between files. This setting\n        has no default value on Windows, as standard `diff` is not available, but Puppet can use many\n        third-party diff tools.\",\n    },\n    :show_diff => [false, \"Whether to log and report a contextual diff when files are being replaced.  This causes\n      partial file contents to pass through Puppet's normal logging and reporting system, so this setting should be\n      used with caution if you are sending Puppet's reports to an insecure destination.\n      This feature currently requires the `diff/lcs` Ruby library.\"],\n    :daemonize => {\n      :default => (Puppet.features.microsoft_windows? ? false : true),\n      :desc => \"Whether to send the process into the background.  This defaults to true on POSIX systems,\n        and to false on Windows (where Puppet currently cannot daemonize).\",\n      :short => \"D\",\n      :hook => proc do |value|\n        if value and Puppet.features.microsoft_windows?\n          raise \"Cannot daemonize on Windows\"\n        end\n      end\n    },\n    :maximum_uid => [4294967290, \"The maximum allowed UID.  Some platforms use negative UIDs\n      but then ship with tools that do not know how to handle signed ints, so the UIDs show up as\n      huge numbers that can then not be fed back into the system.  This is a hackish way to fail in a\n      slightly more useful way when that happens.\"],\n    :route_file => [\"$confdir/routes.yaml\", \"The YAML file containing indirector route configuration.\"],\n    :node_terminus => [\"plain\", \"Where to find information about nodes.\"],\n    :catalog_terminus => [\"compiler\", \"Where to get node catalogs.  This is useful to change if, for instance,\n      you'd like to pre-compile catalogs and store them in memcached or some other easily-accessed store.\"],\n    :facts_terminus => {\n      :default => Puppet.application_name.to_s == \"master\" ? 'yaml' : 'facter',\n      :desc => \"The node facts terminus.\",\n      :hook => proc do |value|\n        require 'puppet/node/facts'\n        # Cache to YAML if we're uploading facts away\n        if %w[rest inventory_service].include? value.to_s\n          Puppet::Node::Facts.indirection.cache_class = :yaml\n        end\n      end\n    },\n    :inventory_terminus => [ \"$facts_terminus\", \"Should usually be the same as the facts terminus\" ],\n    :httplog => { :default => \"$logdir/http.log\",\n      :owner => \"root\",\n      :mode => 0640,\n      :desc => \"Where the puppet agent web server logs.\"\n    },\n    :http_proxy_host => [\"none\",\n      \"The HTTP proxy host to use for outgoing connections.  Note: You\n      may need to use a FQDN for the server hostname when using a proxy.\"],\n    :http_proxy_port => [3128, \"The HTTP proxy port to use for outgoing connections\"],\n    :filetimeout => [ 15,\n      \"The minimum time to wait (in seconds) between checking for updates in\n      configuration files.  This timeout determines how quickly Puppet checks whether\n      a file (such as manifests or templates) has changed on disk.\"\n    ],\n    :queue_type => [\"stomp\", \"Which type of queue to use for asynchronous processing.\"],\n    :queue_type => [\"stomp\", \"Which type of queue to use for asynchronous processing.\"],\n    :queue_source => [\"stomp://localhost:61613/\", \"Which type of queue to use for asynchronous processing.  If your stomp server requires\n      authentication, you can include it in the URI as long as your stomp client library is at least 1.1.1\"],\n    :async_storeconfigs => {:default => false, :desc => \"Whether to use a queueing system to provide asynchronous database integration.\n      Requires that `puppetqd` be running and that 'PSON' support for ruby be installed.\",\n      :hook => proc do |value|\n        if value\n          # This reconfigures the terminii for Node, Facts, and Catalog\n          Puppet.settings[:storeconfigs] = true\n\n          # But then we modify the configuration\n          Puppet::Resource::Catalog.indirection.cache_class = :queue\n        else\n          raise \"Cannot disable asynchronous storeconfigs in a running process\"\n        end\n      end\n    },\n    :thin_storeconfigs => {:default => false, :desc =>\n      \"Boolean; wether storeconfigs store in the database only the facts and exported resources.\n      If true, then storeconfigs performance will be higher and still allow exported/collected\n      resources, but other usage external to Puppet might not work\",\n      :hook => proc do |value|\n        Puppet.settings[:storeconfigs] = true if value\n        end\n      },\n    :config_version => [\"\", \"How to determine the configuration version.  By default, it will be the\n      time that the configuration is parsed, but you can provide a shell script to override how the\n      version is determined.  The output of this script will be added to every log message in the\n      reports, allowing you to correlate changes on your hosts to the source version on the server.\"],\n    :zlib => [true,\n      \"Boolean; whether to use the zlib library\",\n    ],\n    :prerun_command => [\"\", \"A command to run before every agent run.  If this command returns a non-zero\n      return code, the entire Puppet run will fail.\"],\n    :postrun_command => [\"\", \"A command to run after every agent run.  If this command returns a non-zero\n      return code, the entire Puppet run will be considered to have failed, even though it might have\n      performed work during the normal run.\"],\n    :freeze_main => [false, \"Freezes the 'main' class, disallowing any code to be added to it.  This\n      essentially means that you can't have any code outside of a node, class, or definition other\n      than in the site manifest.\"]\n  )\n  Puppet.setdefaults(:module_tool,\n    :module_repository  => ['http://forge.puppetlabs.com', \"The module repository\"],\n    :module_working_dir => ['$vardir/puppet-module', \"The directory into which module tool data is stored\"]\n  )\n\n  hostname = Facter[\"hostname\"].value\n  domain = Facter[\"domain\"].value\n  if domain and domain != \"\"\n    fqdn = [hostname, domain].join(\".\")\n  else\n    fqdn = hostname\n  end\n\n\n    Puppet.setdefaults(\n    :main,\n\n    # We have to downcase the fqdn, because the current ssl stuff (as oppsed to in master) doesn't have good facilities for\n    # manipulating naming.\n    :certname => {:default => fqdn.downcase, :desc => \"The name to use when handling certificates.  Defaults\n      to the fully qualified domain name.\",\n      :call_on_define => true, # Call our hook with the default value, so we're always downcased\n      :hook => proc { |value| raise(ArgumentError, \"Certificate names must be lower case; see #1168\") unless value == value.downcase }},\n    :certdnsnames => {\n      :default => '',\n      :hook    => proc do |value|\n        unless value.nil? or value == '' then\n          Puppet.warning <<WARN\nThe `certdnsnames` setting is no longer functional,\nafter CVE-2011-3872. We ignore the value completely.\n\nFor your own certificate request you can set `dns_alt_names` in the\nconfiguration and it will apply locally.  There is no configuration option to\nset DNS alt names, or any other `subjectAltName` value, for another nodes\ncertificate.\n\nAlternately you can use the `--dns_alt_names` command line option to set the\nlabels added while generating your own CSR.\nWARN\n        end\n      end,\n      :desc    => <<EOT\nThe `certdnsnames` setting is no longer functional,\nafter CVE-2011-3872. We ignore the value completely.\n\nFor your own certificate request you can set `dns_alt_names` in the\nconfiguration and it will apply locally.  There is no configuration option to\nset DNS alt names, or any other `subjectAltName` value, for another nodes\ncertificate.\n\nAlternately you can use the `--dns_alt_names` command line option to set the\nlabels added while generating your own CSR.\nEOT\n    },\n    :dns_alt_names => {\n      :default => '',\n      :desc    => <<EOT,\nThe comma-separated list of alternative DNS names to use for the local host.\n\nWhen the node generates a CSR for itself, these are added to the request\nas the desired `subjectAltName` in the certificate: additional DNS labels\nthat the certificate is also valid answering as.\n\nThis is generally required if you use a non-hostname `certname`, or if you\nwant to use `puppet kick` or `puppet resource -H` and the primary certname\ndoes not match the DNS name you use to communicate with the host.\n\nThis is unnecessary for agents, unless you intend to use them as a server for\n`puppet kick` or remote `puppet resource` management.\n\nIt is rarely necessary for servers; it is usually helpful only if you need to\nhave a pool of multiple load balanced masters, or for the same master to\nrespond on two physically separate networks under different names.\nEOT\n    },\n    :certdir => {\n      :default => \"$ssldir/certs\",\n      :owner => \"service\",\n      :desc => \"The certificate directory.\"\n    },\n    :ssldir => {\n      :default => \"$confdir/ssl\",\n      :mode => 0771,\n      :owner => \"service\",\n      :desc => \"Where SSL certificates are kept.\"\n    },\n    :publickeydir => {\n      :default => \"$ssldir/public_keys\",\n      :owner => \"service\",\n      :desc => \"The public key directory.\"\n    },\n    :requestdir => {\n      :default => \"$ssldir/certificate_requests\",\n      :owner => \"service\",\n      :desc => \"Where host certificate requests are stored.\"\n    },\n    :privatekeydir => { :default => \"$ssldir/private_keys\",\n      :mode => 0750,\n      :owner => \"service\",\n      :desc => \"The private key directory.\"\n    },\n    :privatedir => { :default => \"$ssldir/private\",\n      :mode => 0750,\n      :owner => \"service\",\n      :desc => \"Where the client stores private certificate information.\"\n    },\n    :passfile => { :default => \"$privatedir/password\",\n      :mode => 0640,\n      :owner => \"service\",\n      :desc => \"Where puppet agent stores the password for its private key.\n        Generally unused.\"\n    },\n    :hostcsr => { :default => \"$ssldir/csr_$certname.pem\",\n      :mode => 0644,\n      :owner => \"service\",\n      :desc => \"Where individual hosts store and look for their certificate requests.\"\n    },\n    :hostcert => { :default => \"$certdir/$certname.pem\",\n      :mode => 0644,\n      :owner => \"service\",\n      :desc => \"Where individual hosts store and look for their certificates.\"\n    },\n    :hostprivkey => { :default => \"$privatekeydir/$certname.pem\",\n      :mode => 0600,\n      :owner => \"service\",\n      :desc => \"Where individual hosts store and look for their private key.\"\n    },\n    :hostpubkey => { :default => \"$publickeydir/$certname.pem\",\n      :mode => 0644,\n      :owner => \"service\",\n      :desc => \"Where individual hosts store and look for their public key.\"\n    },\n    :localcacert => { :default => \"$certdir/ca.pem\",\n      :mode => 0644,\n      :owner => \"service\",\n      :desc => \"Where each client stores the CA certificate.\"\n    },\n    :hostcrl => { :default => \"$ssldir/crl.pem\",\n      :mode => 0644,\n      :owner => \"service\",\n      :desc => \"Where the host's certificate revocation list can be found.\n        This is distinct from the certificate authority's CRL.\"\n    },\n    :certificate_revocation => [true, \"Whether certificate revocation should be supported by downloading a Certificate Revocation List (CRL)\n      to all clients.  If enabled, CA chaining will almost definitely not work.\"]\n  )\n\n    setdefaults(\n    :ca,\n    :ca_name => [\"Puppet CA: $certname\", \"The name to use the Certificate Authority certificate.\"],\n    :cadir => {  :default => \"$ssldir/ca\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0770,\n      :desc => \"The root directory for the certificate authority.\"\n    },\n    :cacert => { :default => \"$cadir/ca_crt.pem\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0660,\n      :desc => \"The CA certificate.\"\n    },\n    :cakey => { :default => \"$cadir/ca_key.pem\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0660,\n      :desc => \"The CA private key.\"\n    },\n    :capub => { :default => \"$cadir/ca_pub.pem\",\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"The CA public key.\"\n    },\n    :cacrl => { :default => \"$cadir/ca_crl.pem\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0664,\n\n      :desc => \"The certificate revocation list (CRL) for the CA. Will be used if present but otherwise ignored.\",\n      :hook => proc do |value|\n        if value == 'false'\n          Puppet.warning \"Setting the :cacrl to 'false' is deprecated; Puppet will just ignore the crl if yours is missing\"\n        end\n      end\n    },\n    :caprivatedir => { :default => \"$cadir/private\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0770,\n      :desc => \"Where the CA stores private certificate information.\"\n    },\n    :csrdir => { :default => \"$cadir/requests\",\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"Where the CA stores certificate requests\"\n    },\n    :signeddir => { :default => \"$cadir/signed\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0770,\n      :desc => \"Where the CA stores signed certificates.\"\n    },\n    :capass => { :default => \"$caprivatedir/ca.pass\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0660,\n      :desc => \"Where the CA stores the password for the private key\"\n    },\n    :serial => { :default => \"$cadir/serial\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0644,\n      :desc => \"Where the serial number for certificates is stored.\"\n    },\n    :autosign => { :default => \"$confdir/autosign.conf\",\n      :mode => 0644,\n      :desc => \"Whether to enable autosign.  Valid values are true (which\n        autosigns any key request, and is a very bad idea), false (which\n        never autosigns any key request), and the path to a file, which\n        uses that configuration file to determine which keys to sign.\"},\n    :allow_duplicate_certs => [false, \"Whether to allow a new certificate\n      request to overwrite an existing certificate.\"],\n    :ca_days => [\"\", \"How long a certificate should be valid, in days.\n      This setting is deprecated; use `ca_ttl` instead\"],\n    :ca_ttl => [\"5y\", \"The default TTL for new certificates; valid values\n      must be an integer, optionally followed by one of the units\n      'y' (years of 365 days), 'd' (days), 'h' (hours), or\n      's' (seconds). The unit defaults to seconds. If this setting\n      is set, ca_days is ignored. Examples are '3600' (one hour)\n      and '1825d', which is the same as '5y' (5 years) \"],\n    :ca_md => [\"md5\", \"The type of hash used in certificates.\"],\n    :req_bits => [4096, \"The bit length of the certificates.\"],\n    :keylength => [4096, \"The bit length of keys.\"],\n    :cert_inventory => {\n      :default => \"$cadir/inventory.txt\",\n      :mode => 0644,\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"A Complete listing of all certificates\"\n    }\n  )\n\n  # Define the config default.\n\n    setdefaults(\n    Puppet.settings[:name],\n    :config => [\"$confdir/puppet.conf\",\n      \"The configuration file for #{Puppet[:name]}.\"],\n    :pidfile => [\"$rundir/$name.pid\", \"The pid file\"],\n    :bindaddress => [\"\", \"The address a listening server should bind to.  Mongrel servers\n      default to 127.0.0.1 and WEBrick defaults to 0.0.0.0.\"],\n    :servertype => {:default => \"webrick\", :desc => \"The type of server to use.  Currently supported\n      options are webrick and mongrel.  If you use mongrel, you will need\n      a proxy in front of the process or processes, since Mongrel cannot\n      speak SSL.\",\n\n      :call_on_define => true, # Call our hook with the default value, so we always get the correct bind address set.\n      :hook => proc { |value|  value == \"webrick\" ? Puppet.settings[:bindaddress] = \"0.0.0.0\" : Puppet.settings[:bindaddress] = \"127.0.0.1\" if Puppet.settings[:bindaddress] == \"\" }\n    }\n  )\n\n  setdefaults(:master,\n    :user => [\"puppet\", \"The user puppet master should run as.\"],\n    :group => [\"puppet\", \"The group puppet master should run as.\"],\n    :manifestdir => [\"$confdir/manifests\", \"Where puppet master looks for its manifests.\"],\n    :manifest => [\"$manifestdir/site.pp\", \"The entry-point manifest for puppet master.\"],\n    :code => [\"\", \"Code to parse directly.  This is essentially only used\n      by `puppet`, and should only be set if you're writing your own Puppet\n      executable\"],\n    :masterlog => { :default => \"$logdir/puppetmaster.log\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0660,\n      :desc => \"Where puppet master logs.  This is generally not used,\n        since syslog is the default log destination.\"\n    },\n    :masterhttplog => { :default => \"$logdir/masterhttp.log\",\n      :owner => \"service\",\n      :group => \"service\",\n      :mode => 0660,\n      :create => true,\n      :desc => \"Where the puppet master web server logs.\"\n    },\n    :masterport => [8140, \"Which port puppet master listens on.\"],\n    :node_name => [\"cert\", \"How the puppet master determines the client's identity\n      and sets the 'hostname', 'fqdn' and 'domain' facts for use in the manifest,\n      in particular for determining which 'node' statement applies to the client.\n      Possible values are 'cert' (use the subject's CN in the client's\n      certificate) and 'facter' (use the hostname that the client\n      reported in its facts)\"],\n    :bucketdir => {\n      :default => \"$vardir/bucket\",\n      :mode => 0750,\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"Where FileBucket files are stored.\"\n    },\n    :rest_authconfig => [ \"$confdir/auth.conf\",\n      \"The configuration file that defines the rights to the different\n      rest indirections.  This can be used as a fine-grained\n      authorization system for `puppet master`.\"\n    ],\n    :ca => [true, \"Wether the master should function as a certificate authority.\"],\n    :modulepath => {\n      :default => \"$confdir/modules#{File::PATH_SEPARATOR}/usr/share/puppet/modules\",\n      :desc => \"The search path for modules, as a list of directories separated by the system path separator character. (The POSIX path separator is ':', and the Windows path separator is ';'.)\",\n      :type => :setting # We don't want this to be considered a file, since it's multiple files.\n    },\n    :ssl_client_header => [\"HTTP_X_CLIENT_DN\", \"The header containing an authenticated\n      client's SSL DN.  Only used with Mongrel.  This header must be set by the proxy\n      to the authenticated client's SSL DN (e.g., `/CN=puppet.puppetlabs.com`).\n      See http://projects.puppetlabs.com/projects/puppet/wiki/Using_Mongrel for more information.\"],\n    :ssl_client_verify_header => [\"HTTP_X_CLIENT_VERIFY\", \"The header containing the status\n      message of the client verification. Only used with Mongrel.  This header must be set by the proxy\n      to 'SUCCESS' if the client successfully authenticated, and anything else otherwise.\n      See http://projects.puppetlabs.com/projects/puppet/wiki/Using_Mongrel for more information.\"],\n    # To make sure this directory is created before we try to use it on the server, we need\n    # it to be in the server section (#1138).\n    :yamldir => {:default => \"$vardir/yaml\", :owner => \"service\", :group => \"service\", :mode => \"750\",\n      :desc => \"The directory in which YAML data is stored, usually in a subdirectory.\"},\n    :server_datadir => {:default => \"$vardir/server_data\", :owner => \"service\", :group => \"service\", :mode => \"750\",\n      :desc => \"The directory in which serialized data is stored, usually in a subdirectory.\"},\n    :reports => [\"store\",\n      \"The list of reports to generate.  All reports are looked for\n      in `puppet/reports/name.rb`, and multiple report names should be\n      comma-separated (whitespace is okay).\"\n    ],\n    :reportdir => {:default => \"$vardir/reports\",\n      :mode => 0750,\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"The directory in which to store reports\n        received from the client.  Each client gets a separate\n        subdirectory.\"},\n    :reporturl => [\"http://localhost:3000/reports/upload\",\n      \"The URL used by the http reports processor to send reports\"],\n    :fileserverconfig => [\"$confdir/fileserver.conf\", \"Where the fileserver configuration is stored.\"],\n    :strict_hostname_checking => [false, \"Whether to only search for the complete\n      hostname as it is in the certificate when searching for node information\n      in the catalogs.\"]\n  )\n\n  setdefaults(:metrics,\n    :rrddir => {:default => \"$vardir/rrd\",\n      :mode => 0750,\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"The directory where RRD database files are stored.\n        Directories for each reporting host will be created under\n        this directory.\"\n    },\n    :rrdinterval => [\"$runinterval\", \"How often RRD should expect data.\n      This should match how often the hosts report back to the server.\"]\n  )\n\n  setdefaults(:device,\n    :devicedir =>  {:default => \"$vardir/devices\", :mode => \"750\", :desc => \"The root directory of devices' $vardir\"},\n    :deviceconfig => [\"$confdir/device.conf\",\"Path to the device config file for puppet device\"]\n  )\n\n  setdefaults(:agent,\n    :node_name_value => { :default => \"$certname\",\n      :desc => \"The explicit value used for the node name for all requests the agent\n        makes to the master. WARNING: This setting is mutually exclusive with\n        node_name_fact.  Changing this setting also requires changes to the default\n        auth.conf configuration on the Puppet Master.  Please see\n        http://links.puppetlabs.com/node_name_value for more information.\"\n    },\n    :node_name_fact => { :default => \"\",\n      :desc => \"The fact name used to determine the node name used for all requests the agent\n        makes to the master. WARNING: This setting is mutually exclusive with\n        node_name_value.  Changing this setting also requires changes to the default\n        auth.conf configuration on the Puppet Master.  Please see\n        http://links.puppetlabs.com/node_name_fact for more information.\",\n      :hook => proc do |value|\n        if !value.empty? and Puppet[:node_name_value] != Puppet[:certname]\n          raise \"Cannot specify both the node_name_value and node_name_fact settings\"\n        end\n      end\n    },\n    :localconfig => { :default => \"$statedir/localconfig\",\n      :owner => \"root\",\n      :mode => 0660,\n      :desc => \"Where puppet agent caches the local configuration.  An\n        extension indicating the cache format is added automatically.\"},\n    :statefile => { :default => \"$statedir/state.yaml\",\n      :mode => 0660,\n      :desc => \"Where puppet agent and puppet master store state associated\n        with the running configuration.  In the case of puppet master,\n        this file reflects the state discovered through interacting\n        with clients.\"\n      },\n    :clientyamldir => {:default => \"$vardir/client_yaml\", :mode => \"750\", :desc => \"The directory in which client-side YAML data is stored.\"},\n    :client_datadir => {:default => \"$vardir/client_data\", :mode => \"750\", :desc => \"The directory in which serialized data is stored on the client.\"},\n    :classfile => { :default => \"$statedir/classes.txt\",\n      :owner => \"root\",\n      :mode => 0640,\n      :desc => \"The file in which puppet agent stores a list of the classes\n        associated with the retrieved configuration.  Can be loaded in\n        the separate `puppet` executable using the `--loadclasses`\n        option.\"},\n    :resourcefile => { :default => \"$statedir/resources.txt\",\n      :owner => \"root\",\n      :mode => 0640,\n      :desc => \"The file in which puppet agent stores a list of the resources\n        associated with the retrieved configuration.\"  },\n    :puppetdlog => { :default => \"$logdir/puppetd.log\",\n      :owner => \"root\",\n      :mode => 0640,\n      :desc => \"The log file for puppet agent.  This is generally not used.\"\n    },\n    :server => [\"puppet\", \"The server to which server puppet agent should connect\"],\n    :ignoreschedules => [false,\n      \"Boolean; whether puppet agent should ignore schedules.  This is useful\n      for initial puppet agent runs.\"],\n    :puppetport => [8139, \"Which port puppet agent listens on.\"],\n    :noop => [false, \"Whether puppet agent should be run in noop mode.\"],\n    :runinterval => [1800, # 30 minutes\n      \"How often puppet agent applies the client configuration; in seconds.\n      Note that a runinterval of 0 means \\\"run continuously\\\" rather than\n      \\\"never run.\\\" If you want puppet agent to never run, you should start\n      it with the `--no-client` option.\"],\n    :listen => [false, \"Whether puppet agent should listen for\n      connections.  If this is true, then puppet agent will accept incoming\n      REST API requests, subject to the default ACLs and the ACLs set in\n      the `rest_authconfig` file. Puppet agent can respond usefully to\n      requests on the `run`, `facts`, `certificate`, and `resource` endpoints.\"],\n    :ca_server => [\"$server\", \"The server to use for certificate\n      authority requests.  It's a separate server because it cannot\n      and does not need to horizontally scale.\"],\n    :ca_port => [\"$masterport\", \"The port to use for the certificate authority.\"],\n    :catalog_format => {\n      :default => \"\",\n      :desc => \"(Deprecated for 'preferred_serialization_format') What format to\n        use to dump the catalog.  Only supports 'marshal' and 'yaml'.  Only\n        matters on the client, since it asks the server for a specific format.\",\n      :hook => proc { |value|\n        if value\n          Puppet.warning \"Setting 'catalog_format' is deprecated; use 'preferred_serialization_format' instead.\"\n          Puppet.settings[:preferred_serialization_format] = value\n        end\n      }\n    },\n    :preferred_serialization_format => [\"pson\", \"The preferred means of serializing\n      ruby instances for passing over the wire.  This won't guarantee that all\n      instances will be serialized using this method, since not all classes\n      can be guaranteed to support this format, but it will be used for all\n      classes that support it.\"],\n    :puppetdlockfile => [ \"$statedir/puppetdlock\", \"A lock file to temporarily stop puppet agent from doing anything.\"],\n    :usecacheonfailure => [true,\n      \"Whether to use the cached configuration when the remote\n      configuration will not compile.  This option is useful for testing\n      new configurations, where you want to fix the broken configuration\n      rather than reverting to a known-good one.\"\n    ],\n    :use_cached_catalog => [false,\n      \"Whether to only use the cached catalog rather than compiling a new catalog\n      on every run.  Puppet can be run with this enabled by default and then selectively\n      disabled when a recompile is desired.\"],\n    :ignorecache => [false,\n      \"Ignore cache and always recompile the configuration.  This is\n      useful for testing new configurations, where the local cache may in\n      fact be stale even if the timestamps are up to date - if the facts\n      change or if the server changes.\"\n    ],\n    :downcasefacts => [false, \"Whether facts should be made all lowercase when sent to the server.\"],\n    :dynamicfacts => [\"memorysize,memoryfree,swapsize,swapfree\",\n      \"Facts that are dynamic; these facts will be ignored when deciding whether\n      changed facts should result in a recompile.  Multiple facts should be\n      comma-separated.\"],\n    :splaylimit => [\"$runinterval\",\n      \"The maximum time to delay before runs.  Defaults to being the same as the\n      run interval.\"],\n    :splay => [false,\n      \"Whether to sleep for a pseudo-random (but consistent) amount of time before\n      a run.\"],\n    :clientbucketdir => {\n      :default => \"$vardir/clientbucket\",\n      :mode => 0750,\n      :desc => \"Where FileBucket files are stored locally.\"\n    },\n    :configtimeout => [120,\n      \"How long the client should wait for the configuration to be retrieved\n      before considering it a failure.  This can help reduce flapping if too\n      many clients contact the server at one time.\"\n    ],\n    :reportserver => {\n      :default => \"$server\",\n      :call_on_define => false,\n      :desc => \"(Deprecated for 'report_server') The server to which to send transaction reports.\",\n      :hook => proc do |value|\n        Puppet.settings[:report_server] = value if value\n      end\n    },\n    :report_server => [\"$server\",\n      \"The server to send transaction reports to.\"\n    ],\n    :report_port => [\"$masterport\",\n      \"The port to communicate with the report_server.\"\n    ],\n    :inventory_server => [\"$server\",\n      \"The server to send facts to.\"\n    ],\n    :inventory_port => [\"$masterport\",\n      \"The port to communicate with the inventory_server.\"\n    ],\n    :report => [true,\n      \"Whether to send reports after every transaction.\"\n    ],\n    :lastrunfile =>  { :default => \"$statedir/last_run_summary.yaml\",\n      :mode => 0640,\n      :desc => \"Where puppet agent stores the last run report summary in yaml format.\"\n    },\n    :lastrunreport =>  { :default => \"$statedir/last_run_report.yaml\",\n      :mode => 0640,\n      :desc => \"Where puppet agent stores the last run report in yaml format.\"\n    },\n    :graph => [false, \"Whether to create dot graph files for the different\n      configuration graphs.  These dot files can be interpreted by tools\n      like OmniGraffle or dot (which is part of ImageMagick).\"],\n    :graphdir => [\"$statedir/graphs\", \"Where to store dot-outputted graphs.\"],\n    :http_compression => [false, \"Allow http compression in REST communication with the master.\n      This setting might improve performance for agent -> master communications over slow WANs.\n      Your puppet master needs to support compression (usually by activating some settings in a reverse-proxy\n      in front of the puppet master, which rules out webrick).\n      It is harmless to activate this settings if your master doesn't support\n      compression, but if it supports it, this setting might reduce performance on high-speed LANs.\"]\n  )\n\n  setdefaults(:inspect,\n      :archive_files => [false, \"During an inspect run, whether to archive files whose contents are audited to a file bucket.\"],\n      :archive_file_server => [\"$server\", \"During an inspect run, the file bucket server to archive files to if archive_files is set.\"]\n  )\n\n  # Plugin information.\n\n    setdefaults(\n    :main,\n    :plugindest => [\"$libdir\",\n      \"Where Puppet should store plugins that it pulls down from the central\n      server.\"],\n    :pluginsource => [\"puppet://$server/plugins\",\n      \"From where to retrieve plugins.  The standard Puppet `file` type\n      is used for retrieval, so anything that is a valid file source can\n      be used here.\"],\n    :pluginsync => [false, \"Whether plugins should be synced with the central server.\"],\n\n    :pluginsignore => [\".svn CVS .git\", \"What files to ignore when pulling down plugins.\"]\n  )\n\n  # Central fact information.\n\n    setdefaults(\n    :main,\n    :factpath => {:default => \"$vardir/lib/facter#{File::PATH_SEPARATOR}$vardir/facts\",\n      :desc => \"Where Puppet should look for facts.  Multiple directories should\n        be separated by the system path separator character. (The POSIX path separator is ':', and the Windows path separator is ';'.)\",\n\n      :call_on_define => true, # Call our hook with the default value, so we always get the value added to facter.\n      :type => :setting, # Don't consider it a file, because it could be multiple colon-separated files\n      :hook => proc { |value| Facter.search(value) if Facter.respond_to?(:search) }},\n    :factdest => [\"$vardir/facts/\",\n      \"Where Puppet should store facts that it pulls down from the central\n      server.\"],\n    :factsource => [\"puppet://$server/facts/\",\n      \"From where to retrieve facts.  The standard Puppet `file` type\n      is used for retrieval, so anything that is a valid file source can\n      be used here.\"],\n    :factsync => [false, \"Whether facts should be synced with the central server.\"],\n    :factsignore => [\".svn CVS\", \"What files to ignore when pulling down facts.\"]\n  )\n\n\n    setdefaults(\n    :tagmail,\n    :tagmap => [\"$confdir/tagmail.conf\", \"The mapping between reporting tags and email addresses.\"],\n    :sendmail => [which('sendmail') || '', \"Where to find the sendmail binary with which to send email.\"],\n\n    :reportfrom => [\"report@\" + [Facter[\"hostname\"].value, Facter[\"domain\"].value].join(\".\"), \"The 'from' email address for the reports.\"],\n    :smtpserver => [\"none\", \"The server through which to send email reports.\"]\n  )\n\n    setdefaults(\n    :rails,\n    :dblocation => { :default => \"$statedir/clientconfigs.sqlite3\",\n      :mode => 0660,\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"The database cache for client configurations.  Used for\n        querying within the language.\"\n    },\n    :dbadapter => [ \"sqlite3\", \"The type of database to use.\" ],\n    :dbmigrate => [ false, \"Whether to automatically migrate the database.\" ],\n    :dbname => [ \"puppet\", \"The name of the database to use.\" ],\n    :dbserver => [ \"localhost\", \"The database server for caching. Only\n      used when networked databases are used.\"],\n    :dbport => [ \"\", \"The database password for caching. Only\n      used when networked databases are used.\"],\n    :dbuser => [ \"puppet\", \"The database user for caching. Only\n      used when networked databases are used.\"],\n    :dbpassword => [ \"puppet\", \"The database password for caching. Only\n      used when networked databases are used.\"],\n    :dbconnections => [ '', \"The number of database connections for networked\n      databases.  Will be ignored unless the value is a positive integer.\"],\n    :dbsocket => [ \"\", \"The database socket location. Only used when networked\n      databases are used.  Will be ignored if the value is an empty string.\"],\n    :railslog => {:default => \"$logdir/rails.log\",\n      :mode => 0600,\n      :owner => \"service\",\n      :group => \"service\",\n      :desc => \"Where Rails-specific logs are sent\"\n    },\n\n    :rails_loglevel => [\"info\", \"The log level for Rails connections.  The value must be\n      a valid log level within Rails.  Production environments normally use `info`\n      and other environments normally use `debug`.\"]\n  )\n\n    setdefaults(\n    :couchdb,\n\n    :couchdb_url => [\"http://127.0.0.1:5984/puppet\", \"The url where the puppet couchdb database will be created\"]\n  )\n\n    setdefaults(\n    :transaction,\n    :tags => [\"\", \"Tags to use to find resources.  If this is set, then\n      only resources tagged with the specified tags will be applied.\n      Values must be comma-separated.\"],\n    :evaltrace => [false, \"Whether each resource should log when it is\n      being evaluated.  This allows you to interactively see exactly\n      what is being done.\"],\n    :summarize => [false,\n\n      \"Whether to print a transaction summary.\"\n    ]\n  )\n\n    setdefaults(\n    :main,\n    :external_nodes => [\"none\",\n\n      \"An external command that can produce node information.  The command's output\n      must be a YAML dump of a hash, and that hash must have a `classes` key and/or\n      a `parameters` key, where `classes` is an array or hash and\n      `parameters` is a hash.  For unknown nodes, the command should\n      exit with a non-zero exit code.\n\n      This command makes it straightforward to store your node mapping\n      information in other data sources like databases.\"])\n\n        setdefaults(\n        :ldap,\n    :ldapnodes => [false,\n      \"Whether to search for node configurations in LDAP.  See\n      http://projects.puppetlabs.com/projects/puppet/wiki/LDAP_Nodes for more information.\"],\n    :ldapssl => [false,\n      \"Whether SSL should be used when searching for nodes.\n      Defaults to false because SSL usually requires certificates\n      to be set up on the client side.\"],\n    :ldaptls => [false,\n      \"Whether TLS should be used when searching for nodes.\n      Defaults to false because TLS usually requires certificates\n      to be set up on the client side.\"],\n    :ldapserver => [\"ldap\",\n      \"The LDAP server.  Only used if `ldapnodes` is enabled.\"],\n    :ldapport => [389,\n      \"The LDAP port.  Only used if `ldapnodes` is enabled.\"],\n\n    :ldapstring => [\"(&(objectclass=puppetClient)(cn=%s))\",\n      \"The search string used to find an LDAP node.\"],\n    :ldapclassattrs => [\"puppetclass\",\n      \"The LDAP attributes to use to define Puppet classes.  Values\n      should be comma-separated.\"],\n    :ldapstackedattrs => [\"puppetvar\",\n      \"The LDAP attributes that should be stacked to arrays by adding\n      the values in all hierarchy elements of the tree.  Values\n      should be comma-separated.\"],\n    :ldapattrs => [\"all\",\n      \"The LDAP attributes to include when querying LDAP for nodes.  All\n      returned attributes are set as variables in the top-level scope.\n      Multiple values should be comma-separated.  The value 'all' returns\n      all attributes.\"],\n    :ldapparentattr => [\"parentnode\",\n      \"The attribute to use to define the parent node.\"],\n    :ldapuser => [\"\",\n      \"The user to use to connect to LDAP.  Must be specified as a\n      full DN.\"],\n    :ldappassword => [\"\", \"The password to use to connect to LDAP.\"],\n    :ldapbase => [\"\",\n      \"The search base for LDAP searches.  It's impossible to provide\n      a meaningful default here, although the LDAP libraries might\n      have one already set.  Generally, it should be the 'ou=Hosts'\n      branch under your main directory.\"]\n  )\n\n  setdefaults(:master,\n    :storeconfigs => {\n      :default => false,\n      :desc => \"Whether to store each client's configuration, including catalogs, facts,\nand related data.  This also enables the import and export of resources in\nthe Puppet language - a mechanism for exchange resources between nodes.\n\nBy default this uses ActiveRecord and an SQL database to store and query\nthe data; this, in turn, will depend on Rails being available.\n\nYou can adjust the backend using the storeconfigs_backend setting.\",\n      # Call our hook with the default value, so we always get the libdir set.\n      :call_on_define => true,\n      :hook => proc do |value|\n        require 'puppet/node'\n        require 'puppet/node/facts'\n        if value\n          Puppet.settings[:async_storeconfigs] or\n            Puppet::Resource::Catalog.indirection.cache_class = :store_configs\n          Puppet::Node::Facts.indirection.cache_class = :store_configs\n          Puppet::Node.indirection.cache_class = :store_configs\n\n          Puppet::Resource.indirection.terminus_class = :store_configs\n        end\n      end\n    },\n    :storeconfigs_backend => {\n      :default => \"active_record\",\n      :desc => \"Configure the backend terminus used for StoreConfigs.\nBy default, this uses the ActiveRecord store, which directly talks to the\ndatabase from within the Puppet Master process.\"\n    }\n  )\n\n  # This doesn't actually work right now.\n\n    setdefaults(\n    :parser,\n\n    :lexical => [false, \"Whether to use lexical scoping (vs. dynamic).\"],\n    :templatedir => [\"$vardir/templates\",\n      \"Where Puppet looks for template files.  Can be a list of colon-separated\n      directories.\"\n    ]\n  )\n  setdefaults(\n    :puppetdoc,\n    :document_all => [false, \"Document all resources\"]\n  )\nend\n"], "filenames": ["lib/puppet/defaults.rb"], "buggy_code_start_loc": [602], "buggy_code_end_loc": [721], "fixing_code_start_loc": [602], "fixing_code_end_loc": [721], "type": "CWE-264", "message": "lib/puppet/defaults.rb in Puppet 2.7.x before 2.7.18, and Puppet Enterprise before 2.5.2, uses 0644 permissions for last_run_report.yaml, which allows local users to obtain sensitive configuration information by leveraging access to the puppet master server to read this file.", "other": {"cve": {"id": "CVE-2012-3866", "sourceIdentifier": "cve@mitre.org", "published": "2012-08-06T16:55:06.367", "lastModified": "2019-07-10T18:02:28.767", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "lib/puppet/defaults.rb in Puppet 2.7.x before 2.7.18, and Puppet Enterprise before 2.5.2, uses 0644 permissions for last_run_report.yaml, which allows local users to obtain sensitive configuration information by leveraging access to the puppet master server to read this file."}, {"lang": "es", "value": "lib/puppet/defaults.rb en Puppet 2.7.x anterior a 2.7.18, y Puppet Enterprise anterior a 2.5.2,  emplea permisos del tipo 0644 para last_run_report.yaml, lo que permite a usuarios locales obtener informaci\u00f3n sensible de la configuraci\u00f3n aprovechando el acceso al servidor maestro de Puppet para leer el archivo."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:P/I:N/A:N", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 2.1}, "baseSeverity": "LOW", "exploitabilityScore": 3.9, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-264"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.2:*:*:*:*:*:*:*", "matchCriteriaId": "BE56BA6B-BDC4-431E-81FD-D7ED5E8783E9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.3:*:*:*:*:*:*:*", "matchCriteriaId": "FDDDFB28-1971-4CCD-93D2-ABC08FE67F4A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.4:*:*:*:*:*:*:*", "matchCriteriaId": "508105B4-619A-4A9D-8B2F-FE5992C1006A"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.5:*:*:*:*:*:*:*", "matchCriteriaId": "26DB96A5-A57D-452F-A452-98B11F51CAE6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.6:*:*:*:*:*:*:*", "matchCriteriaId": "D33AF704-FA05-4EA8-BE95-0177871A810F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.8:*:*:*:*:*:*:*", "matchCriteriaId": "07DE4213-E233-402E-88C2-B7FF8D7B682C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.9:*:*:*:*:*:*:*", "matchCriteriaId": "4122D8E3-24AD-4A55-9F89-C3AAD50E638D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.10:*:*:*:*:*:*:*", "matchCriteriaId": "AF6D6B90-62BA-4944-A699-6D7C48AFD0A1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.11:*:*:*:*:*:*:*", "matchCriteriaId": "8EC6A7B3-5949-4439-994A-68DA65438F5D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.12:*:*:*:*:*:*:*", "matchCriteriaId": "5140C34D-589C-43DB-BCA7-8434EB173205"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.13:*:*:*:*:*:*:*", "matchCriteriaId": "E561C081-6262-46D3-AB17-01EEA6D3E988"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.14:*:*:*:*:*:*:*", "matchCriteriaId": "4703802D-0E3A-4760-B660-6AE0AF74DD40"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet:2.7.16:*:*:*:*:*:*:*", "matchCriteriaId": "BE3D39F6-F9C8-4E7F-981A-265B04E85579"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppetlabs:puppet:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.7.17", "matchCriteriaId": "3A81EA6F-49C7-4883-8F93-E76A60DE1164"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppetlabs:puppet:2.7.0:*:*:*:*:*:*:*", "matchCriteriaId": "1E5192CB-094F-469E-A644-2255C4F44804"}, {"vulnerable": true, "criteria": "cpe:2.3:a:puppetlabs:puppet:2.7.1:*:*:*:*:*:*:*", "matchCriteriaId": "D17D2752-CB0D-4CC8-8604-FEBF8DEE16E0"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:puppet:puppet_enterprise:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.5.1", "matchCriteriaId": "F66C1E54-FBEA-4008-BC88-A390D415F3F5"}]}]}], "references": [{"url": "http://lists.opensuse.org/opensuse-updates/2012-07/msg00036.html", "source": "cve@mitre.org"}, {"url": "http://puppetlabs.com/security/cve/cve-2012-3866/", "source": "cve@mitre.org", "tags": ["Vendor Advisory"]}, {"url": "http://www.debian.org/security/2012/dsa-2511", "source": "cve@mitre.org"}, {"url": "http://www.ubuntu.com/usn/USN-1506-1", "source": "cve@mitre.org"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=839135", "source": "cve@mitre.org"}, {"url": "https://github.com/puppetlabs/puppet/commit/fd44bf5e6d0d360f6a493d663b653c121fa83c3f", "source": "cve@mitre.org", "tags": ["Exploit", "Patch"]}]}, "github_commit_url": "https://github.com/puppetlabs/puppet/commit/fd44bf5e6d0d360f6a493d663b653c121fa83c3f"}}