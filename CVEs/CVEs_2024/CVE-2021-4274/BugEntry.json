{"buggy_code": ["<!doctype html>\n<html lang=\"en\">\n\t<head>\n\t\t<title>{{config.WEBSITE_TITLE|default(\"Bird-LG / Looking Glass\") }}</title>\n\t\t<meta charset=\"UTF-8\">\n\t\t<link rel=stylesheet type=text/css href=\"{{ url_for('static', filename='css/bootstrap.min.css') }}\">\n\t\t<link rel=stylesheet type=text/css href=\"{{ url_for('static', filename='css/bootstrap-responsive.min.css') }}\">\n\t\t<link rel=stylesheet type=text/css href=\"{{ url_for('static', filename='css/docs.css') }}\">\n\t\t<link rel=stylesheet type=text/css href=\"{{ url_for('static', filename='css/DT_bootstrap.css') }}\">\n\t</head>\n\t<body>\n\t\t<div class=\"navbar navbar-fixed-top\">\n\t\t\t<div class=\"navbar-inner\">\n\t\t\t\t<div class=\"container-fluid\">\n\t\t\t\t\t<a class=\"btn btn-navbar\" data-toggle=\"collapse\" data-target=\".nav-collapse\">\n\n\t\t\t\t\t\t<span class=\"icon-bar\"></span>\n\t\t\t\t\t\t<span class=\"icon-bar\"></span>\n\t\t\t\t\t\t<span class=\"icon-bar\"></span>\n\t\t\t\t\t</a>\n\t\t\t\t\t<a class=\"brand\" href=\"/\">{{config.WEBSITE_TITLE|default(\"Bird-LG / Looking Glass\") }}</a>\n\t\t\t\t\t<div class=\"navbar nav-collapse\">\n\t\t\t\t\t\t<ul class=\"nav nav-pills\">\n\t\t\t\t\t\t\t<li class=\"navbar-text\">Nodes:&nbsp;&nbsp;</li>\n\t\t\t\t\t\t\t<li class=\"hosts\"><a id=\"{{all_hosts}}\" href=\"#\">all</a></li>\n\n\t\t\t\t\t\t\t{% for host in config.PROXY %}\n\t\t\t\t\t\t\t<li class=\"hosts\"><a id=\"{{host}}\" href=\"#\">{{host}}</a></li>\n\t\t\t\t\t\t\t{% endfor %}\n\n\t\t\t\t\t\t\t<li class=\"divider-vertical\"></li>\n\n\t\t\t\t\t\t\t<li class=\"navbar-text\">Protocols:&nbsp;&nbsp;</li>\n\t\t\t\t\t\t\t<li class=\"proto\"><a id=\"ipv4\" href=\"#\">ipv4</a></li>\n\t\t\t\t\t\t\t<li class=\"proto\"><a id=\"ipv6\" href=\"#\">ipv6</a></li>\n\t\t\t\t\t\t\t<li class=\"divider-vertical\"></li>\n\n\t\t\t\t\t\t\t<li class=\"dropdown request_type\">\n\t\t\t\t\t\t\t<a href=\"#\"\n\t\t\t\t\t\t\t\tclass=\"dropdown-toggle\"\n\t\t\t\t\t\t\t\tdata-toggle=\"dropdown\">\n\t\t\t\t\t\t\t\tShow protocols\n\t\t\t\t\t\t\t\t<b class=\"caret\"></b>\n\t\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t\t<ul class=\"dropdown-menu\">\n\t\t\t\t\t\t\t\t{% for id, text in commands %}\n\t\t\t\t\t\t\t\t<li><a id=\"{{id}}\" href=\"#\">{{text}}</a></li>\n\t\t\t\t\t\t\t\t{% endfor %}\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<form class=\"navbar-search pull-left\" action=\"javascript:;\">\n\t\t\t\t\t\t\t\t<input type=\"text\" style=\"width:250px;\" class=\"request_args search-query\" placeholder=\"...\">\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t\t<li class=\"navbar-text\"></li>\n\n\t\t\t\t\t\t</ul>\n\n\t\t\t\t\t\t<p class=\"navbar-text pull-right\"></p>\n\t\t\t\t\t</div><!--/.nav-collapse -->\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"container-fluid\">\n\t\t\t<div class=\"row-fluid\">\n\t\t\t\t<div class=\"span8\">\n\t\t\t\t\t{% if warnings %}\n\t\t\t\t\t<div class=\"alert alert-warning\">\n                        {% for warning in warnings %}{{warning}}<br />{% endfor %}\n                    </div>\n\t\t\t\t\t{% endif %}\n\t\t\t\t\t{% if errors %}\n\t\t\t\t\t<div class=\"alert alert-error\">\n\t\t\t\t\t\t{% for error in errors %}{{error}}<br />{% endfor %}\n                    </div>\n\t\t\t\t\t{% endif %}\n\n\t\t\t\t\t{% block body %}{% endblock %}\n\n\t\t\t\t</div>\n\t\t\t\t<div class=\"span4\">\n\t\t\t\t\t<div class=\"well\" style=\"padding: 8px 0;\">\n\t\t\t\t\t\t<ul class=\"nav nav-list history\">\n\t\t\t\t\t\t\t<li class=\"nav-header\">Request history</li>\n\t\t\t\t\t\t\t{% for hosts, proto, request_type, request_args in session.history %}\n\t\t\t\t\t\t\t<li{% if loop.first %} class=\"active\"{% endif %}>\n\t\t\t\t\t\t\t<a href=\"/{{ [request_type, hosts, proto]|join(\"/\") }}{% if request_args %}?q={{request_args|urlencode}}{% endif %}\">\n\t\t\t\t\t\t\t\t{{hosts}}/{{proto}}: {{ commands_dict[request_type]|replace(\"...\", request_args) }}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t{% endfor %}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"footer\">\n\t\t\t\t<p>bird looking glass, <a href=\"https://github.com/sileht/bird-lg/\">source code</a> under GPL 3.0, powered by <a href=\"http://flask.pocoo.org\">Flask</a>, <a href=\"http://jquery.com/\">jQuery</a> and <a href=\"http://twitter.github.com/bootstrap/\">Bootstrap</a></p>\n\t\t\t</div>\n\n\t\t<div class=\"progress progress-info progress-striped active\" style=\"position:fixed;bottom:0px;right:10px;display:none;height:10px;width:200px;\">\n\t\t\t<div class=\"bar\" style=\"width: 100%;\"></div>\n\t\t</div>\n\t\t\t<div class=\"modal fade\" style=\"display:none;\">\n\t\t\t\t<div class=\"modal-header\">\n\t\t\t\t\t<a class=\"close\" data-dismiss=\"modal\">\u00d7</a>\n\t\t\t\t\t<h3>Modal header</h3>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"modal-body\" style=\"height: 300px; overflow: auto;\">\n\t\t\t\t\t<p>One fine body\u2026</p>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"modal-footer\">\n\t\t\t\t\t<a href=\"#\" class=\"btn btn-primary\">Close</a>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</div>\n\t\t<script type=\"text/javascript\" src=\"{{url_for('static', filename='js/jquery.js') }}\"></script>\n\t\t<script type=\"text/javascript\" src=\"{{url_for('static', filename='js/bootstrap.min.js') }}\"></script>\n        <script type=\"text/javascript\" src=\"{{url_for('static', filename='js/jquery.dataTables.js') }}\"></script>\n        <script type=\"text/javascript\" src=\"{{url_for('static', filename='js/DT_bootstrap.js') }}\"></script>\n\t\t<script type=\"text/javascript\">\n\t\t\trequest_type = \"{{session.request_type}}\";\n\t\t\trequest_args = \"{{session.request_args|safe}}\";\n\t\t\thosts = \"{{session.hosts}}\";\n\t\t\tproto = \"{{session.proto}}\";\n\t\t\thistory_query = {{session.history|tojson|safe}};\n</script>\n<script type=\"text/javascript\" src=\"{{url_for('static', filename='js/lg.js') }}\"></script>\n\t</body>\n</html>\n"], "fixing_code": ["<!doctype html>\n<html lang=\"en\">\n\t<head>\n\t\t<title>{{config.WEBSITE_TITLE|default(\"Bird-LG / Looking Glass\") }}</title>\n\t\t<meta charset=\"UTF-8\">\n\t\t<link rel=stylesheet type=text/css href=\"{{ url_for('static', filename='css/bootstrap.min.css') }}\">\n\t\t<link rel=stylesheet type=text/css href=\"{{ url_for('static', filename='css/bootstrap-responsive.min.css') }}\">\n\t\t<link rel=stylesheet type=text/css href=\"{{ url_for('static', filename='css/docs.css') }}\">\n\t\t<link rel=stylesheet type=text/css href=\"{{ url_for('static', filename='css/DT_bootstrap.css') }}\">\n\t</head>\n\t<body>\n\t\t<div class=\"navbar navbar-fixed-top\">\n\t\t\t<div class=\"navbar-inner\">\n\t\t\t\t<div class=\"container-fluid\">\n\t\t\t\t\t<a class=\"btn btn-navbar\" data-toggle=\"collapse\" data-target=\".nav-collapse\">\n\n\t\t\t\t\t\t<span class=\"icon-bar\"></span>\n\t\t\t\t\t\t<span class=\"icon-bar\"></span>\n\t\t\t\t\t\t<span class=\"icon-bar\"></span>\n\t\t\t\t\t</a>\n\t\t\t\t\t<a class=\"brand\" href=\"/\">{{config.WEBSITE_TITLE|default(\"Bird-LG / Looking Glass\") }}</a>\n\t\t\t\t\t<div class=\"navbar nav-collapse\">\n\t\t\t\t\t\t<ul class=\"nav nav-pills\">\n\t\t\t\t\t\t\t<li class=\"navbar-text\">Nodes:&nbsp;&nbsp;</li>\n\t\t\t\t\t\t\t<li class=\"hosts\"><a id=\"{{all_hosts}}\" href=\"#\">all</a></li>\n\n\t\t\t\t\t\t\t{% for host in config.PROXY %}\n\t\t\t\t\t\t\t<li class=\"hosts\"><a id=\"{{host}}\" href=\"#\">{{host}}</a></li>\n\t\t\t\t\t\t\t{% endfor %}\n\n\t\t\t\t\t\t\t<li class=\"divider-vertical\"></li>\n\n\t\t\t\t\t\t\t<li class=\"navbar-text\">Protocols:&nbsp;&nbsp;</li>\n\t\t\t\t\t\t\t<li class=\"proto\"><a id=\"ipv4\" href=\"#\">ipv4</a></li>\n\t\t\t\t\t\t\t<li class=\"proto\"><a id=\"ipv6\" href=\"#\">ipv6</a></li>\n\t\t\t\t\t\t\t<li class=\"divider-vertical\"></li>\n\n\t\t\t\t\t\t\t<li class=\"dropdown request_type\">\n\t\t\t\t\t\t\t<a href=\"#\"\n\t\t\t\t\t\t\t\tclass=\"dropdown-toggle\"\n\t\t\t\t\t\t\t\tdata-toggle=\"dropdown\">\n\t\t\t\t\t\t\t\tShow protocols\n\t\t\t\t\t\t\t\t<b class=\"caret\"></b>\n\t\t\t\t\t\t\t</a>\n\n\t\t\t\t\t\t\t<ul class=\"dropdown-menu\">\n\t\t\t\t\t\t\t\t{% for id, text in commands %}\n\t\t\t\t\t\t\t\t<li><a id=\"{{id}}\" href=\"#\">{{text}}</a></li>\n\t\t\t\t\t\t\t\t{% endfor %}\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<form class=\"navbar-search pull-left\" action=\"javascript:;\">\n\t\t\t\t\t\t\t\t<input type=\"text\" style=\"width:250px;\" class=\"request_args search-query\" placeholder=\"...\">\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t\t<li class=\"navbar-text\"></li>\n\n\t\t\t\t\t\t</ul>\n\n\t\t\t\t\t\t<p class=\"navbar-text pull-right\"></p>\n\t\t\t\t\t</div><!--/.nav-collapse -->\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"container-fluid\">\n\t\t\t<div class=\"row-fluid\">\n\t\t\t\t<div class=\"span8\">\n\t\t\t\t\t{% if warnings %}\n\t\t\t\t\t<div class=\"alert alert-warning\">\n                        {% for warning in warnings %}{{warning}}<br />{% endfor %}\n                    </div>\n\t\t\t\t\t{% endif %}\n\t\t\t\t\t{% if errors %}\n\t\t\t\t\t<div class=\"alert alert-error\">\n\t\t\t\t\t\t{% for error in errors %}{{error}}<br />{% endfor %}\n                    </div>\n\t\t\t\t\t{% endif %}\n\n\t\t\t\t\t{% block body %}{% endblock %}\n\n\t\t\t\t</div>\n\t\t\t\t<div class=\"span4\">\n\t\t\t\t\t<div class=\"well\" style=\"padding: 8px 0;\">\n\t\t\t\t\t\t<ul class=\"nav nav-list history\">\n\t\t\t\t\t\t\t<li class=\"nav-header\">Request history</li>\n\t\t\t\t\t\t\t{% for hosts, proto, request_type, request_args in session.history %}\n\t\t\t\t\t\t\t<li{% if loop.first %} class=\"active\"{% endif %}>\n\t\t\t\t\t\t\t<a href=\"/{{ [request_type, hosts, proto]|join(\"/\") }}{% if request_args %}?q={{request_args|urlencode}}{% endif %}\">\n\t\t\t\t\t\t\t\t{{hosts}}/{{proto}}: {{ commands_dict[request_type]|replace(\"...\", request_args) }}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t{% endfor %}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"footer\">\n\t\t\t\t<p>bird looking glass, <a href=\"https://github.com/sileht/bird-lg/\">source code</a> under GPL 3.0, powered by <a href=\"http://flask.pocoo.org\">Flask</a>, <a href=\"http://jquery.com/\">jQuery</a> and <a href=\"http://twitter.github.com/bootstrap/\">Bootstrap</a></p>\n\t\t\t</div>\n\n\t\t<div class=\"progress progress-info progress-striped active\" style=\"position:fixed;bottom:0px;right:10px;display:none;height:10px;width:200px;\">\n\t\t\t<div class=\"bar\" style=\"width: 100%;\"></div>\n\t\t</div>\n\t\t\t<div class=\"modal fade\" style=\"display:none;\">\n\t\t\t\t<div class=\"modal-header\">\n\t\t\t\t\t<a class=\"close\" data-dismiss=\"modal\">\u00d7</a>\n\t\t\t\t\t<h3>Modal header</h3>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"modal-body\" style=\"height: 300px; overflow: auto;\">\n\t\t\t\t\t<p>One fine body\u2026</p>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"modal-footer\">\n\t\t\t\t\t<a href=\"#\" class=\"btn btn-primary\">Close</a>\n\t\t\t\t</div>\n\t\t\t</div>\t\n\t\t</div>\n\t\t<script type=\"text/javascript\" src=\"{{url_for('static', filename='js/jquery.js') }}\"></script>\n\t\t<script type=\"text/javascript\" src=\"{{url_for('static', filename='js/bootstrap.min.js') }}\"></script>\n        <script type=\"text/javascript\" src=\"{{url_for('static', filename='js/jquery.dataTables.js') }}\"></script>\n        <script type=\"text/javascript\" src=\"{{url_for('static', filename='js/DT_bootstrap.js') }}\"></script>\n\t\t<script type=\"text/javascript\">\n\t\t\trequest_type = \"{{session.request_type}}\";\n\t\t\trequest_args = \"{{session.request_args}}\";\n\t\t\thosts = \"{{session.hosts}}\";\n\t\t\tproto = \"{{session.proto}}\";\n\t\t\thistory_query = {{session.history|tojson|safe}};\n</script>\n<script type=\"text/javascript\" src=\"{{url_for('static', filename='js/lg.js') }}\"></script>\n\t</body>\n</html>\n"], "filenames": ["templates/layout.html"], "buggy_code_start_loc": [123], "buggy_code_end_loc": [124], "fixing_code_start_loc": [123], "fixing_code_end_loc": [124], "type": "CWE-79", "message": "A vulnerability, which was classified as problematic, has been found in sileht bird-lg. This issue affects some unknown processing of the file templates/layout.html. The manipulation of the argument request_args leads to cross site scripting. The attack may be initiated remotely. The name of the patch is ef6b32c527478fefe7a4436e10b96ee28ed5b308. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-216479.", "other": {"cve": {"id": "CVE-2021-4274", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-21T19:15:14.257", "lastModified": "2022-12-30T21:52:17.073", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability, which was classified as problematic, has been found in sileht bird-lg. This issue affects some unknown processing of the file templates/layout.html. The manipulation of the argument request_args leads to cross site scripting. The attack may be initiated remotely. The name of the patch is ef6b32c527478fefe7a4436e10b96ee28ed5b308. It is recommended to apply a patch to fix this issue. The associated identifier of this vulnerability is VDB-216479."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-707"}, {"lang": "en", "value": "CWE-74"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:bird-lg_project:bird-lg:-:*:*:*:*:*:*:*", "matchCriteriaId": "0A41D3FF-6A5E-4AF7-BE6E-FB4B32E4BF76"}]}]}], "references": [{"url": "https://github.com/sileht/bird-lg/commit/ef6b32c527478fefe7a4436e10b96ee28ed5b308", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/sileht/bird-lg/pull/82", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.216479", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/sileht/bird-lg/commit/ef6b32c527478fefe7a4436e10b96ee28ed5b308"}}