{"buggy_code": ["<?php\n    echo $this->element('/genericElements/SideMenu/side_menu', array('menuList' => 'galaxies', 'menuItem' => 'view'));\n?>\n<div class=\"galaxy view\">\n    <div class=\"row-fluid\">\n        <div class=\"span8\">\n            <h2>\n                <span class=\"<?php echo $this->FontAwesome->findNamespace($galaxy['Galaxy']['icon']); ?> fa-<?php echo h($galaxy['Galaxy']['icon']); ?>\"></span>&nbsp;\n                <?php echo h($galaxy['Galaxy']['name']); ?> galaxy\n            </h2>\n            <dl>\n                <dt><?php echo __('Galaxy ID');?></dt>\n                <dd><?php echo h($galaxy['Galaxy']['id']); ?></dd>\n                <dt><?php echo __('Name');?></dt>\n                <dd><?php echo $galaxy['Galaxy']['name'] ? h($galaxy['Galaxy']['name']) : h($galaxy['Galaxy']['type']); ?></dd>\n                <dt><?php echo __('Namespace');?></dt>\n                <dd><?php echo $galaxy['Galaxy']['namespace'] ? h($galaxy['Galaxy']['namespace']) : 'misp'; ?></dd>\n                <dt><?php echo __('Uuid');?></dt>\n                <dd><?php echo h($galaxy['Galaxy']['uuid']); ?></dd>\n                <dt><?php echo __('Description');?></dt>\n                <dd><?php echo h($galaxy['Galaxy']['description']); ?></dd>\n                <dt><?php echo __('Version');?></dt>\n                <dd><?php echo h($galaxy['Galaxy']['version']); ?></dd>\n\n            </dl>\n            <?php\n            $kco = '';\n            if (isset($galaxy['Galaxy']['kill_chain_order'])) {\n                $kco = '<strong>' . __('Kill chain order') . '</strong> <span class=\"useCursorPointer fa fa-expand\" onclick=\"$(\\'#killChainOrder\\').toggle(\\'blind\\')\"></span>';\n                $kco .= '<div id=\"killChainOrder\" class=\"hidden\" style=\"border: 1px solid #000; border-radius: 5px; padding: 3px; background: #f4f4f4; margin-left: 20px;\">' . json_encode($galaxy['Galaxy']['kill_chain_order']) . '</div>';\n            }\n            echo $kco;\n            ?>\n        </div>\n    </div>\n    <div id=\"clusters_div\"></div>\n</div>\n<script type=\"text/javascript\">\n$(document).ready(function () {\n    <?php\n    $uri = \"/galaxy_clusters/index/\" . $galaxy['Galaxy']['id'];\n    if (isset($passedArgsArray)) $uri .= '/searchall:' . $passedArgsArray['all'];\n    ?>\n    $.get(\"<?php echo $uri;?>\", function(data) {\n        $(\"#clusters_div\").html(data);\n    });\n\n    var $kco = $('#killChainOrder');\n    var j = syntaxHighlightJson($kco.text(), 8)\n    $kco.html(j);\n});\n</script>\n"], "fixing_code": ["<?php\n    echo $this->element('/genericElements/SideMenu/side_menu', array('menuList' => 'galaxies', 'menuItem' => 'view'));\n?>\n<div class=\"galaxy view\">\n    <div class=\"row-fluid\">\n        <div class=\"span8\">\n            <h2>\n                <span class=\"<?php echo $this->FontAwesome->findNamespace($galaxy['Galaxy']['icon']); ?> fa-<?php echo h($galaxy['Galaxy']['icon']); ?>\"></span>&nbsp;\n                <?php echo h($galaxy['Galaxy']['name']); ?> galaxy\n            </h2>\n            <dl>\n                <dt><?php echo __('Galaxy ID');?></dt>\n                <dd><?php echo h($galaxy['Galaxy']['id']); ?></dd>\n                <dt><?php echo __('Name');?></dt>\n                <dd><?php echo $galaxy['Galaxy']['name'] ? h($galaxy['Galaxy']['name']) : h($galaxy['Galaxy']['type']); ?></dd>\n                <dt><?php echo __('Namespace');?></dt>\n                <dd><?php echo $galaxy['Galaxy']['namespace'] ? h($galaxy['Galaxy']['namespace']) : 'misp'; ?></dd>\n                <dt><?php echo __('Uuid');?></dt>\n                <dd><?php echo h($galaxy['Galaxy']['uuid']); ?></dd>\n                <dt><?php echo __('Description');?></dt>\n                <dd><?php echo h($galaxy['Galaxy']['description']); ?></dd>\n                <dt><?php echo __('Version');?></dt>\n                <dd><?php echo h($galaxy['Galaxy']['version']); ?></dd>\n\n            </dl>\n            <?php\n            $kco = '';\n            if (isset($galaxy['Galaxy']['kill_chain_order'])) {\n                $kco = '<strong>' . __('Kill chain order') . '</strong> <span class=\"useCursorPointer fa fa-expand\" onclick=\"$(\\'#killChainOrder\\').toggle(\\'blind\\')\"></span>';\n                $kco .= '<div id=\"killChainOrder\" class=\"hidden\" style=\"border: 1px solid #000; border-radius: 5px; padding: 3px; background: #f4f4f4; margin-left: 20px;\">' . json_encode($galaxy['Galaxy']['kill_chain_order']) . '</div>';\n            }\n            echo $kco;\n            ?>\n        </div>\n    </div>\n    <div id=\"clusters_div\"></div>\n</div>\n<script type=\"text/javascript\">\n$(document).ready(function () {\n    <?php\n    $uri = \"/galaxy_clusters/index/\" . $galaxy['Galaxy']['id'];\n    if (isset($passedArgsArray)) $uri .= '/searchall:' . $passedArgsArray['all'];\n    ?>\n    $.get(\"<?php echo h($uri);?>\", function(data) {\n        $(\"#clusters_div\").html(data);\n    });\n\n    var $kco = $('#killChainOrder');\n    var j = syntaxHighlightJson($kco.text(), 8)\n    $kco.html(j);\n});\n</script>\n"], "filenames": ["app/View/Galaxies/view.ctp"], "buggy_code_start_loc": [44], "buggy_code_end_loc": [45], "fixing_code_start_loc": [44], "fixing_code_end_loc": [45], "type": "NVD-CWE-noinfo", "message": "An issue was discovered in MISP before 2.4.121. The Galaxy view contained an incorrectly sanitized search string in app/View/Galaxies/view.ctp.", "other": {"cve": {"id": "CVE-2020-8893", "sourceIdentifier": "cve@mitre.org", "published": "2020-02-12T00:15:09.810", "lastModified": "2020-02-14T18:43:52.377", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "An issue was discovered in MISP before 2.4.121. The Galaxy view contained an incorrectly sanitized search string in app/View/Galaxies/view.ctp."}, {"lang": "es", "value": "Se detect\u00f3 un problema en MISP versiones anteriores a 2.4.121. La vista Galaxy conten\u00eda una cadena de b\u00fasqueda saneada incorrectamente en el archivo app/View/Galaxies/view.ctp."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "NVD-CWE-noinfo"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:misp:misp:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.4.121", "matchCriteriaId": "C4AE73C5-6FE2-4A7F-86F3-013F1D0A1AC8"}]}]}], "references": [{"url": "https://github.com/MISP/MISP/commit/3d982d92fd26584115c01f8c560a688d1096b65c", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/MISP/MISP/compare/v2.4.120...v2.4.121", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/MISP/MISP/commit/3d982d92fd26584115c01f8c560a688d1096b65c"}}