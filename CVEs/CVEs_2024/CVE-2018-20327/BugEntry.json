{"buggy_code": ["{% extends 'layout/layout_1_col.tpl'|get_template %}\n\n{% block content %}\n    {{ form }}\n\n    {% if gradebook_list %}\n        <table class=\"table\">\n            <thead class=\"title\">\n                <tr>\n                    <th>{{ 'Name' | get_lang }}</th>\n                    <th>{{ 'Course' | get_lang }}</th>\n                    <th>{{ 'Actions' | get_lang }} </th>\n                </tr>\n            </thead>\n        {% for item in gradebook_list %}\n            <tr>\n                <td>\n                    {{ item.name }}\n                </td>\n                <td>\n                    {{ item.courseCode }}\n                </td>\n                <td>\n                    <a href=\"{{ current_url }}&action=edit&id={{ item.id }}\">\n                        <img src=\"{{ 'edit.png'|icon(22) }}\" />\n                    </a>\n\n                    <a href=\"{{ _p.web_main }}admin/gradebook_dependency.php?id={{ item.id }}\">\n                        <img src=\"{{ '2rightarrow.png'|icon(22) }}\" />\n                    </a>\n                </td>\n            </tr>\n        {% endfor %}\n        </table>\n\n       {{ gradebook_list }}\n    {% endif %}\n{% endblock %}\n"], "fixing_code": ["{% extends 'layout/layout_1_col.tpl'|get_template %}\n\n{% block content %}\n    {{ form }}\n\n    {% if gradebook_list %}\n        <table class=\"table\">\n            <thead class=\"title\">\n                <tr>\n                    <th>{{ 'Name' | get_lang }}</th>\n                    <th>{{ 'Course' | get_lang }}</th>\n                    <th>{{ 'Actions' | get_lang }} </th>\n                </tr>\n            </thead>\n        {% for item in gradebook_list %}\n            <tr>\n                <td>\n                    {{ item.name | e }}\n                </td>\n                <td>\n                    {{ item.courseCode }}\n                </td>\n                <td>\n                    <a href=\"{{ current_url }}&action=edit&id={{ item.id }}\">\n                        <img src=\"{{ 'edit.png'|icon(22) }}\" />\n                    </a>\n\n                    <a href=\"{{ _p.web_main }}admin/gradebook_dependency.php?id={{ item.id }}\">\n                        <img src=\"{{ '2rightarrow.png'|icon(22) }}\" />\n                    </a>\n                </td>\n            </tr>\n        {% endfor %}\n        </table>\n\n       {{ gradebook_list }}\n    {% endif %}\n{% endblock %}\n"], "filenames": ["main/template/default/admin/gradebook_list.tpl"], "buggy_code_start_loc": [18], "buggy_code_end_loc": [19], "fixing_code_start_loc": [18], "fixing_code_end_loc": [19], "type": "CWE-79", "message": "Chamilo LMS version 1.11.8 contains XSS in main/template/default/admin/gradebook_list.tpl in the gradebook dependencies tool, allowing authenticated users to affect other users, under specific conditions of permissions granted by administrators. This is considered \"low risk\" due to the nature of the feature it exploits.", "other": {"cve": {"id": "CVE-2018-20327", "sourceIdentifier": "cve@mitre.org", "published": "2018-12-21T06:29:00.220", "lastModified": "2019-01-07T13:43:16.173", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Chamilo LMS version 1.11.8 contains XSS in main/template/default/admin/gradebook_list.tpl in the gradebook dependencies tool, allowing authenticated users to affect other users, under specific conditions of permissions granted by administrators. This is considered \"low risk\" due to the nature of the feature it exploits."}, {"lang": "es", "value": "Chamilo LMS 1.11.8 contiene Cross-Site Scripting (XSS) en main/template/default/admin/gradebook_list.tpl en la herramienta de dependencias del gradebook, lo que permite que usuarios autenticados afecten a otros usuarios en condiciones espec\u00edficas de permisos otorgados por los administradores. Se considera que esto tiene un \"riesgo bajo\" debido a la naturaleza de la caracter\u00edstica que explota."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:chamilo:chamilo_lms:1.11.8:*:*:*:*:*:*:*", "matchCriteriaId": "4F7D15FF-5009-4F3B-B583-DD75E5F9B82D"}]}]}], "references": [{"url": "https://github.com/chamilo/chamilo-lms/commit/814049e5bd5317d761dda0ebbbc519cb2a64ab6c", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://support.chamilo.org/projects/1/wiki/Security_issues#Issue-32-2018-11-28-Low-risk-More-XSS-and-path-disclosure-issues", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/chamilo/chamilo-lms/commit/814049e5bd5317d761dda0ebbbc519cb2a64ab6c"}}