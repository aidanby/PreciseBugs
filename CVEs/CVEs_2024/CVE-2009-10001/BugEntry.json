{"buggy_code": ["<?php session_start(); ?>\r\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\r\n        \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n<head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\" />\r\n<meta name=\"Author\" content=\"Jose Rodriguez\" />\r\n<title>Captcha test</title>\r\n<style type=\"text/css\">\r\nbody { font-family: sans-serif; font-size: 0.8em; padding: 20px; }\r\n#result { border: 1px solid green; width: 300px; margin: 0 0 35px 0; padding: 10px 20px; font-weight: bold; }\r\n#change-image { font-size: 0.8em; }\r\n</style>\r\n</head>\r\n<body onload=\"document.getElementById('captcha-form').focus()\">\r\n\r\n\r\n\r\n<?php\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/** Validate captcha */\r\nif (!empty($_REQUEST['captcha'])) {\r\n    if (empty($_SESSION['captcha']) || trim(strtolower($_REQUEST['captcha'])) != $_SESSION['captcha']) {\r\n        $captcha_message = \"Invalid captcha\";\r\n        $style = \"background-color: #FF606C\";\r\n    } else {\r\n        $captcha_message = \"Valid captcha\";\r\n        $style = \"background-color: #CCFF99\";\r\n    }\r\n\r\n    echo <<<HTML\r\n        <div id=\"result\" style=\"$style\">\r\n        <h2>$captcha_message</h2>\r\n        <table>\r\n        <tr>\r\n            <td>Session CAPTCHA:</td>\r\n            <td>{$_SESSION['captcha']}</td>\r\n        </tr>\r\n        <tr>\r\n            <td>Form CAPTCHA:</td>\r\n            <td>{$_REQUEST['captcha']}</td>\r\n        </tr>\r\n        </table>\r\n        </div>\r\nHTML;\r\n    unset($_SESSION['captcha']);\r\n}\r\n\r\n\r\n?>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<p><strong>Write the following word:</strong></p>\r\n\r\n\r\n<form method=\"GET\">\r\n<img src=\"captcha.php\" id=\"captcha\" /><br/>\r\n\r\n\r\n<!-- CHANGE TEXT LINK -->\r\n<a href=\"#\" onclick=\"\r\n    document.getElementById('captcha').src='captcha.php?'+Math.random();\r\n    document.getElementById('captcha-form').focus();\"\r\n    id=\"change-image\">Not readable? Change text.</a><br/><br/>\r\n\r\n\r\n<input type=\"text\" name=\"captcha\" id=\"captcha-form\" /><br/>\r\n<input type=\"submit\" />\r\n\r\n</form>\r\n\r\n\r\n</body>\r\n</html>\r\n"], "fixing_code": ["<?php session_start(); ?>\r\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\r\n        \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n<head>\r\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\" />\r\n<meta name=\"Author\" content=\"Jose Rodriguez\" />\r\n<title>Captcha test</title>\r\n<style type=\"text/css\">\r\nbody { font-family: sans-serif; font-size: 0.8em; padding: 20px; }\r\n#result { border: 1px solid green; width: 300px; margin: 0 0 35px 0; padding: 10px 20px; font-weight: bold; }\r\n#change-image { font-size: 0.8em; }\r\n</style>\r\n</head>\r\n<body onload=\"document.getElementById('captcha-form').focus()\">\r\n\r\n\r\n\r\n<?php\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/** Validate captcha */\r\nif (!empty($_REQUEST['captcha'])) {\r\n    if (empty($_SESSION['captcha']) || trim(strtolower($_REQUEST['captcha'])) != $_SESSION['captcha']) {\r\n        $captcha_message = \"Invalid captcha\";\r\n        $style = \"background-color: #FF606C\";\r\n    } else {\r\n        $captcha_message = \"Valid captcha\";\r\n        $style = \"background-color: #CCFF99\";\r\n    }\r\n\r\n    $request_captcha = htmlspecialchars($_REQUEST['captcha']);\r\n\r\n    echo <<<HTML\r\n        <div id=\"result\" style=\"$style\">\r\n        <h2>$captcha_message</h2>\r\n        <table>\r\n        <tr>\r\n            <td>Session CAPTCHA:</td>\r\n            <td>{$_SESSION['captcha']}</td>\r\n        </tr>\r\n        <tr>\r\n            <td>Form CAPTCHA:</td>\r\n            <td>$request_captcha</td>\r\n        </tr>\r\n        </table>\r\n        </div>\r\nHTML;\r\n    unset($_SESSION['captcha']);\r\n}\r\n\r\n\r\n?>\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n<p><strong>Write the following word:</strong></p>\r\n\r\n\r\n<form method=\"GET\">\r\n<img src=\"captcha.php\" id=\"captcha\" /><br/>\r\n\r\n\r\n<!-- CHANGE TEXT LINK -->\r\n<a href=\"#\" onclick=\"\r\n    document.getElementById('captcha').src='captcha.php?'+Math.random();\r\n    document.getElementById('captcha-form').focus();\"\r\n    id=\"change-image\">Not readable? Change text.</a><br/><br/>\r\n\r\n\r\n<input type=\"text\" name=\"captcha\" id=\"captcha-form\" /><br/>\r\n<input type=\"submit\" />\r\n\r\n</form>\r\n\r\n\r\n</body>\r\n</html>\r\n"], "filenames": ["example-form.php"], "buggy_code_start_loc": [42], "buggy_code_end_loc": [54], "fixing_code_start_loc": [43], "fixing_code_end_loc": [56], "type": "CWE-79", "message": "A vulnerability classified as problematic was found in jianlinwei cool-php-captcha up to 0.2. This vulnerability affects unknown code of the file example-form.php. The manipulation of the argument captcha with the input %3Cscript%3Ealert(1)%3C/script%3E leads to cross site scripting. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 0.3 is able to address this issue. The name of the patch is c84fb6b153bebaf228feee0cbf50728d27ae3f80. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-218296.", "other": {"cve": {"id": "CVE-2009-10001", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-13T18:15:08.750", "lastModified": "2023-01-23T18:58:13.257", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability classified as problematic was found in jianlinwei cool-php-captcha up to 0.2. This vulnerability affects unknown code of the file example-form.php. The manipulation of the argument captcha with the input %3Cscript%3Ealert(1)%3C/script%3E leads to cross site scripting. The attack can be initiated remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 0.3 is able to address this issue. The name of the patch is c84fb6b153bebaf228feee0cbf50728d27ae3f80. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-218296."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:cool-php-captcha_project:cool-php-captcha:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.3", "matchCriteriaId": "1072A6AD-DE27-46E3-B756-9577DCC644E3"}]}]}], "references": [{"url": "https://github.com/jianlinwei/cool-php-captcha/commit/c84fb6b153bebaf228feee0cbf50728d27ae3f80", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/jianlinwei/cool-php-captcha/issues/2", "source": "cna@vuldb.com", "tags": ["Exploit", "Issue Tracking", "Third Party Advisory"]}, {"url": "https://github.com/jianlinwei/cool-php-captcha/releases/tag/0.3", "source": "cna@vuldb.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.218296", "source": "cna@vuldb.com", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.218296", "source": "cna@vuldb.com", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/jianlinwei/cool-php-captcha/commit/c84fb6b153bebaf228feee0cbf50728d27ae3f80"}}