{"buggy_code": ["<?php\r\n// ckeditor/filemanager/browser/default/image.php\r\nif (isset($_REQUEST['fid']) && isset($_GET['w']) && isset($_GET['h'])) {\r\n  // load Kotchasan\r\n  include '../../../../load.php';\r\n  // Initial Kotchasan Framework\r\n  Kotchasan::createWebApplication('Gcms\\Config');\r\n  // \u0e04\u0e48\u0e32\u0e17\u0e35\u0e48\u0e2a\u0e48\u0e07\u0e21\u0e32\r\n  $id = ROOT_PATH.$_REQUEST['fid'];\r\n  $idW = $_GET['w'];\r\n  $idH = $_GET['h'];\r\n  if ($id != '' && is_file($id)) {\r\n    $image_info = getImageSize($id);\r\n    if (empty($image_info['error'])) {\r\n      //\u0e1b\u0e23\u0e31\u0e1a\u0e02\u0e19\u0e32\u0e14\u0e15\u0e32\u0e21\u0e17\u0e35\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23 \u0e16\u0e49\u0e32\u0e23\u0e39\u0e1b\u0e43\u0e2b\u0e0d\u0e48\u0e01\u0e27\u0e48\u0e32\u0e1b\u0e01\u0e15\u0e34\r\n      if ($image_info[0] > $idW || $image_info[1] > $idH) {\r\n        //\u0e04\u0e33\u0e19\u0e27\u0e13\u0e02\u0e19\u0e32\u0e14\u0e43\u0e2b\u0e21\u0e48\r\n        if ($image_info[0] <= $image_info[1]) {\r\n          //\u0e23\u0e39\u0e1b\u0e2a\u0e39\u0e07\u0e01\u0e27\u0e48\u0e32\u0e01\u0e27\u0e49\u0e32\u0e07\r\n          $h = $idH;\r\n          $w = round($h * $image_info[0] / $image_info[1]);\r\n        } else {\r\n          $w = $idW;\r\n          $h = round($w * $image_info[1] / $image_info[0]);\r\n        }\r\n        //\u0e2a\u0e23\u0e49\u0e32\u0e07\u0e23\u0e39\u0e1b\u0e43\u0e2b\u0e21\u0e48\u0e08\u0e32\u0e01\u0e23\u0e39\u0e1b\u0e40\u0e14\u0e34\u0e21\r\n        switch ($image_info['mime']) {\r\n          case 'image/gif':\r\n            $o_im = imageCreateFromGIF($id);\r\n            break;\r\n          case 'image/jpg':\r\n          case 'image/jpeg':\r\n          case 'image/pjpeg':\r\n            $o_im = imageCreateFromJPEG($id);\r\n            break;\r\n          case 'image/png':\r\n          case 'image/x-png':\r\n            $o_im = imageCreateFromPNG($id);\r\n            break;\r\n        }\r\n        //\u0e2a\u0e23\u0e49\u0e32\u0e07 \u0e23\u0e39\u0e1b\u0e08\u0e32\u0e01\u0e23\u0e39\u0e1b\u0e17\u0e35\u0e48\u0e2a\u0e48\u0e07\u0e40\u0e02\u0e49\u0e32\u0e21\u0e32\r\n        $o_wd = imagesx($o_im);\r\n        $o_ht = imagesy($o_im);\r\n        //\u0e2a\u0e23\u0e49\u0e32\u0e07 image \u0e43\u0e2b\u0e21\u0e48 \u0e02\u0e19\u0e32\u0e14\u0e17\u0e35\u0e48\u0e01\u0e33\u0e2b\u0e19\u0e14\u0e21\u0e32\r\n        $t_im = ImageCreateTrueColor($w, $h);\r\n        //\u0e27\u0e32\u0e14\u0e25\u0e07\u0e1a\u0e19 image \u0e43\u0e2b\u0e21\u0e48\r\n        ImageCopyResampled($t_im, $o_im, 0, 0, 0, 0, $w + 1, $h + 1, $o_wd, $o_ht);\r\n        //png image\r\n        header(\"Content-type: image/jpeg\");\r\n        ImageJPEG($t_im);\r\n        //\u0e17\u0e33\u0e25\u0e32\u0e22\u0e2d\u0e2d\u0e1b\u0e40\u0e08\u0e47\u0e04\u0e17\u0e35\u0e48\u0e2a\u0e23\u0e49\u0e32\u0e07\r\n        imageDestroy($o_im);\r\n        imageDestroy($t_im);\r\n      } else {\r\n        //\u0e41\u0e2a\u0e14\u0e07\u0e23\u0e39\u0e1b\u0e02\u0e19\u0e32\u0e14\u0e40\u0e14\u0e34\u0e21\r\n        $data = @file_get_contents($id);\r\n        echo $data;\r\n      }\r\n    }\r\n  }\r\n}\r\n"], "fixing_code": ["<?php\r\n// ckeditor/filemanager/browser/default/image.php\r\n\r\nif ( isset($_REQUEST['fid']) && isset($_GET['w']) && isset($_GET['h'])) {\r\n  // load Kotchasan\r\n  include '../../../../load.php';\r\n  // Initial Kotchasan Framework\r\n  Kotchasan::createWebApplication('Gcms\\Config');\r\n  // hotfix: these checks need to be changed later\r\n  if(!Kotchasan\\Login::isMember() || strpos($_REQUEST['fid'], '..') === false || strpos($_REQUEST['fid'], '.php') === false) exit();\r\n  // \u0e04\u0e48\u0e32\u0e17\u0e35\u0e48\u0e2a\u0e48\u0e07\u0e21\u0e32\r\n  $id = ROOT_PATH.$_REQUEST['fid'];\r\n  $idW = $_GET['w'];\r\n  $idH = $_GET['h'];\r\n  if ($id != '' && is_file($id)) {\r\n    $image_info = getImageSize($id);\r\n    if (empty($image_info['error'])) {\r\n      //\u0e1b\u0e23\u0e31\u0e1a\u0e02\u0e19\u0e32\u0e14\u0e15\u0e32\u0e21\u0e17\u0e35\u0e48\u0e15\u0e49\u0e2d\u0e07\u0e01\u0e32\u0e23 \u0e16\u0e49\u0e32\u0e23\u0e39\u0e1b\u0e43\u0e2b\u0e0d\u0e48\u0e01\u0e27\u0e48\u0e32\u0e1b\u0e01\u0e15\u0e34\r\n      if ($image_info[0] > $idW || $image_info[1] > $idH) {\r\n        //\u0e04\u0e33\u0e19\u0e27\u0e13\u0e02\u0e19\u0e32\u0e14\u0e43\u0e2b\u0e21\u0e48\r\n        if ($image_info[0] <= $image_info[1]) {\r\n          //\u0e23\u0e39\u0e1b\u0e2a\u0e39\u0e07\u0e01\u0e27\u0e48\u0e32\u0e01\u0e27\u0e49\u0e32\u0e07\r\n          $h = $idH;\r\n          $w = round($h * $image_info[0] / $image_info[1]);\r\n        } else {\r\n          $w = $idW;\r\n          $h = round($w * $image_info[1] / $image_info[0]);\r\n        }\r\n        //\u0e2a\u0e23\u0e49\u0e32\u0e07\u0e23\u0e39\u0e1b\u0e43\u0e2b\u0e21\u0e48\u0e08\u0e32\u0e01\u0e23\u0e39\u0e1b\u0e40\u0e14\u0e34\u0e21\r\n        switch ($image_info['mime']) {\r\n          case 'image/gif':\r\n            $o_im = imageCreateFromGIF($id);\r\n            break;\r\n          case 'image/jpg':\r\n          case 'image/jpeg':\r\n          case 'image/pjpeg':\r\n            $o_im = imageCreateFromJPEG($id);\r\n            break;\r\n          case 'image/png':\r\n          case 'image/x-png':\r\n            $o_im = imageCreateFromPNG($id);\r\n            break;\r\n        }\r\n        //\u0e2a\u0e23\u0e49\u0e32\u0e07 \u0e23\u0e39\u0e1b\u0e08\u0e32\u0e01\u0e23\u0e39\u0e1b\u0e17\u0e35\u0e48\u0e2a\u0e48\u0e07\u0e40\u0e02\u0e49\u0e32\u0e21\u0e32\r\n        $o_wd = imagesx($o_im);\r\n        $o_ht = imagesy($o_im);\r\n        //\u0e2a\u0e23\u0e49\u0e32\u0e07 image \u0e43\u0e2b\u0e21\u0e48 \u0e02\u0e19\u0e32\u0e14\u0e17\u0e35\u0e48\u0e01\u0e33\u0e2b\u0e19\u0e14\u0e21\u0e32\r\n        $t_im = ImageCreateTrueColor($w, $h);\r\n        //\u0e27\u0e32\u0e14\u0e25\u0e07\u0e1a\u0e19 image \u0e43\u0e2b\u0e21\u0e48\r\n        ImageCopyResampled($t_im, $o_im, 0, 0, 0, 0, $w + 1, $h + 1, $o_wd, $o_ht);\r\n        //png image\r\n        header(\"Content-type: image/jpeg\");\r\n        ImageJPEG($t_im);\r\n        //\u0e17\u0e33\u0e25\u0e32\u0e22\u0e2d\u0e2d\u0e1b\u0e40\u0e08\u0e47\u0e04\u0e17\u0e35\u0e48\u0e2a\u0e23\u0e49\u0e32\u0e07\r\n        imageDestroy($o_im);\r\n        imageDestroy($t_im);\r\n      } else {\r\n        //\u0e41\u0e2a\u0e14\u0e07\u0e23\u0e39\u0e1b\u0e02\u0e19\u0e32\u0e14\u0e40\u0e14\u0e34\u0e21\r\n        $data = @file_get_contents($id);\r\n        echo $data;\r\n      }\r\n    }\r\n  }\r\n}\r\n"], "filenames": ["ckeditor/filemanager/browser/default/image.php"], "buggy_code_start_loc": [3], "buggy_code_end_loc": [7], "fixing_code_start_loc": [3], "fixing_code_end_loc": [11], "type": "CWE-22", "message": "A vulnerability was found in \u0e23\u0e30\u0e1a\u0e1a\u0e1a\u0e31\u0e0d\u0e0a\u0e35\u0e2d\u0e2d\u0e19\u0e44\u0e25\u0e19\u0e4c Online Accounting System up to 1.4.0 and classified as problematic. This issue affects some unknown processing of the file ckeditor/filemanager/browser/default/image.php. The manipulation of the argument fid with the input ../../../etc/passwd leads to path traversal: '../filedir'. The exploit has been disclosed to the public and may be used. Upgrading to version 2.0.0 is able to address this issue. The identifier of the patch is 9d9618422b980335bb30be612ea90f4f56cb992c. It is recommended to upgrade the affected component. The identifier VDB-246641 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2018-25094", "sourceIdentifier": "cna@vuldb.com", "published": "2023-12-03T11:15:07.537", "lastModified": "2024-02-29T01:23:15.297", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "A vulnerability was found in \u0e23\u0e30\u0e1a\u0e1a\u0e1a\u0e31\u0e0d\u0e0a\u0e35\u0e2d\u0e2d\u0e19\u0e44\u0e25\u0e19\u0e4c Online Accounting System up to 1.4.0 and classified as problematic. This issue affects some unknown processing of the file ckeditor/filemanager/browser/default/image.php. The manipulation of the argument fid with the input ../../../etc/passwd leads to path traversal: '../filedir'. The exploit has been disclosed to the public and may be used. Upgrading to version 2.0.0 is able to address this issue. The identifier of the patch is 9d9618422b980335bb30be612ea90f4f56cb992c. It is recommended to upgrade the affected component. The identifier VDB-246641 was assigned to this vulnerability."}, {"lang": "es", "value": "Se encontr\u00f3 una vulnerabilidad en Online Accounting System hasta 1.4.0 y clasificada como problem\u00e1tica. Este problema afecta un procesamiento desconocido del archivo ckeditor/filemanager/browser/default/image.php. La manipulaci\u00f3n del argumento fid con la entrada ../../../etc/passwd conduce a path traversal: '../filedir'. El exploit ha sido divulgado al p\u00fablico y puede utilizarse. La actualizaci\u00f3n a la versi\u00f3n 2.0.0 puede solucionar este problema. El identificador del parche es 9d9618422b980335bb30be612ea90f4f56cb992c. Se recomienda actualizar el componente afectado. A esta vulnerabilidad se le asign\u00f3 el identificador VDB-246641."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 2.7}, "baseSeverity": "LOW", "exploitabilityScore": 5.1, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-24"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kotchasan:online_accounting_system:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.0.0", "matchCriteriaId": "59029865-BC15-43D7-BBCE-90D02D56962D"}]}]}], "references": [{"url": "https://github.com/59160781/project/commit/9d9618422b980335bb30be612ea90f4f56cb992c", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.246641", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.246641", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/59160781/project/commit/9d9618422b980335bb30be612ea90f4f56cb992c"}}