{"buggy_code": ["CSP MySQL User Manager Changelog\n--------------------------------\n\n[+] Added feature\n[#] Improved/changed feature\n[-] Bug fixed\n\n\n3.2.0 [not yet released]\n[+] Enable/disable groups\n[+] Override and force database upgrade\n[#] Changed update check url for new releases\n[#] Removed cmum dbversion from database\n\n\n3.1.1 [2015-04-12]\n[-] Fixed a critical bug in the internal start-/expiredate\n\n\n3.1.0 [2015-04-03]\n[+] Random genxmlkey function\n[+] Manager activity logging\n[+] Internal start-/expiredate handling\n[+] Send osd to all connected users\n[+] IP lookup on connected users (requires internet access)\n[+] Change sort order of expired/soon expired users on dashboard\n[+] Listing not started users on dashboard\n[#] Only log failed admin logins\n[#] Only log failed genxml requests\n[#] Fixed broken css on text logo\n[#] Changed pencil icon on dashboard buttons to text\n[#] Improved profile handling in genxml function\n[#] Improved start/expired user listing\n[#] Improved start-/expiredate handling\n[#] Improved quick enabled for not started and expired users\n[#] Improved install script\n[#] Changed MySQL engine to InnoDB for better performance\n[-] Fixed improper error page\n\n\n3.0.0 [2014-11-12]\n[+] New responsive design\n[+] Improved security\n[+] Reworked functions and routines \n[+] Cmum installer\n[+] Boxtype and mac-address fields on users\n[+] Update checker\n[+] Admin login logging\n[+] User groups\n[+] Improved admin types with manager and group manager\n[+] Salted encrypted admin passwords\n[+] More csp info on dashboard\n[+] User start-/expire info on dashboard\n[+] Genxml logging\n[+] Auto creation of new profiles on user import\n[+] Download exported users to file\n[+] Timezone support\n[+] Profile cleanup on users when a profile is removed\n[+] Options for genxml generation\n\n\n2.3.1 [2012-11-03]\n[+] Function for genxml to require a key to generate the xml output\n[+] Added/addedby/changed/changedby added to the csv import/export function\n[+] Function to turn off/on php notices errors (debug mode)\n[+] Added 'js' folder to the robots.txt disallow list\n[+] Better support for special characters\n[+] Sorting after latest user first\n[+] Function to create random usernames\n[#] Charset error on the \"you are not authorized\" page\n[#] &-char could cause genxml to stop working\n[#] Removed unneeded mysql calls\n[#] Secured tools from url hack\n[-] Removed the '::' in the page title\n[-] Locked the 'csp value' textboxes under 'importing profiles from csp' tool\n[-] New style for buttons\n\n\n2.3 [2012-01-10]\n[+] Iphone/Android favicon\n[+] Ecm rate to default values\n[+] Optimize database tool\n[+] Database version check on login page\n[+] Administrator level to admins (administrator/manager)\n[+] Function to change admin username\n[+] Real name field for admins\n[+] Setting to turn off csp connection check\n[#] 'Add user and stay' didnt load the defaults values after a user were added if that function was turned on\n[#] Mixed layout fixes on some pages\n[-] Removed Accounts Expiration from home page\n[-] Changed 'addeby' and 'changedby' to use admin.id insted of admin.name\n\n\n2.2.1 [2011-10-27]\n[#] Session variable on logout page was not set correctly\n\n\n2.2 [2011-10-18]\n[+] Better mysql error control\n[+] Csp server connection check function\n[+] Csp server connection check on all pages that uses it\n[+] Csp server connection failed notice in header\n[+] Setting to change random password characters and length\n[+] Default user order setting\n[+] Service name fetching from csp server for active sessions\n[#] Unset variables on tools page\n[#] Mis-sized tables in csp user info on manager users page\n[#] Added user notification on manage users page didnt show\n[#] Minor code modifications\n[#] Error on listing online/active/idle users\n[#] Improved fetch from csp server function to minimize mysql server load\n\n\n2.1 [2011-07-17]\n[+] Delete user-button on edit user page\n[+] Logout confirmation prompt\n[+] New add-/edituser function\n[+] New confirmation style on login page\n[+] Idle icon for idle users on manage users page\n[+] Fetch data about each user from csp server, click on the username on manage users page to show\n[+] Custom csp values included in csp xml user export tool\n[+] Ecm-rate field to users (requires csp usermanager that supports this, like the AdvXmlUserManager)\n[+] Start-date and expire-date  fields to users (requires csp usermanager that supports this, like the AdvXmlUserManager)\n[+] Acive-/idle users listing option on manage users page\n[+] Expired users are listed with a yellow dot on the manage users page\n[+] Expired users are shown on the home page\n[+] Setting to change what will be shown in the extra column on manage users page (default: password)\n[#] Page layout on some pages\n[#] Default listing on manage users page wasnt always by username\n[#] Search on manage users page now includes all relevant user fields\n[#] Username can no longer be changed to null (nothing)\n[#] Various layout bugs\n[#] PHP notice error on manage users page on some apache configurations\n[#] Better online/offline/idle check on users from csp server\n[-] Moved favicon.ico to www root to avoid apache errors\n[-] Merged some files together and removed unused files\n[-] '10 Latest Failed Login Attempts' only shows if there has been any failed login attempts and logging is enabled\n[-] Removed one column add-/edit user page\n[-] Switched places on displayname and the extra column on manage users page\n\n\n2.0.6 [2011-02-15]\n[+] Custom csp values on userinfo page\n[+] Custom csp values as default value\n[+] Password must be given 2 times and match when changing then password for a admin\n[+] SQL server checks in upgrade script\n[+] Custom csp values to csv user import and export\n[#] Typo in configcheck\n[#] Csp xml user import got broken in version 2.0.5\n[#] Username and password must be included when importing users, else import will skip that user\n[#] Export users to csv output\n[#] Some tools didnt get selected when choosing them under tools\n[#] Improved update csp users tool\n[#] Improved send osd message page layout\n\n\n2.0.5 [2011-02-12]\n[+] Back button on user info page\n[+] Setting to show/hide send osd message link\n[+] Replace function for invalid chars on add-/import users\n[+] Custom csp values field for users, makes it possible to output custom values into the genxml output for special/homemade versions of csp\n[+] Upgrade script for database upgrades\n[#] Profile '*' is auto removed from import list\n[-] Send osd link is hidden by default\n[-] Default is now 2 columns add user page\n\n\n2.0.4 [2011-01-01]\n[+] Tool to export user database to csp xml config code\n[+] Tool to export user database to csv format\n[+] Function to change username for users\n[+] Function to create a random password for a new user\n[+] Function to send osd messages to users\n[+] Tool to import profiles from csp server\n[#] Layout bug with status messages on the 2 columns add user page\n[#] Some typos on the profile pages\n\n\n2.0.3 [2010-12-26]\n[#] 'Clear fields'-button didnt show on 2 columns add user page\n\n\n2.0.2 [2010-12-26]\n[+] 'Clear fields'-button on add user page that clears all fields\n[#] Kick user function didnt work with HTTPS\n[#] Status was not showed correct when use defaults was used on add user page\n[-] Default listing to username on manage user page\n\n\n2.0.1 [2010-12-03]\n[#] genxml.php did only output 1 profile even if user had more\n[#] PHP Undefined offset error when importing users from csv\n[#] When importing users profiles were stuck through the hole import process\n[#] Users with no profile(s) was added with bad data when importing from csv\n\n\n2.0 [2010-12-02]\n[+] Settings page for various settings\n[+] Default values on add user page, can be set on settings page\n[+] Session timeout function, will kill a idle admin connection if it has been idle longer then given time, timeout can be changed on settings page (default: 600 seconds)\n[+] Comment field added to users\n[+] Tool to import users from csv\n[+] Profile manager for managing profiles\n[+] New tool page with various tools\n[+] Setting to hide all text from login page\n[+] Function to log all failed login attempts\n[+] Setting to show/hide help icons from the add user page\n[+] Tool to delete all disabled users\n[+] Tool to enable/disable all users\n[+] Setting to give the c.m.u.m server a custom name\n[+] Information page to show all the info about a user\n[+] Setting to fetch various data from given csp server\n[+] Tool to fetch/install new user files to csp\n[+] Function to show if a user is online on the csp server\n[+] Tool to import users from csp xml config\n[+] Tool to empty the entire user database\n[+] Function to kick a online user from the csp server\n[+] Quick enable/disable users by clicking on their status icon\n[+] Setting to change layout on add-/edit user pages to 1 or 2 columns\n[+] More info on the home page\n[+] Email-address field to userdatabase\n[+] New profile handling system\n[+] Warning message if config.php is not setup correctly or not found\n[+] Group field to userdatabase\n[+] Created and last changed logging added to users\n[+] Admin accounts can now be set as enabled or disabled\n[+] Charset is now configurable from config.php (default: utf-8)\n[+] Different color for odd and even lines on user-/admin-/profile listing\n[+] List after online users on manage users page\n[+] Update-users command is sent to csp server on logout if 'fetch data from csp server' is active\n[+] Charset setting to genxml.php (default: utf-8)\n[+] Border around all input buttons\n[+] MySQL connection check, will show a error if it's not possible to connect to the MySQL server\n[#] Add-/edituser handling\n[#] Various layout bugs\n[#] Minor layout improvements for internet explorer\n[#] The 'maxconnections=0' bug\n[#] Auto remove of empty spaces in beginning and end of textfiled 'quicked' and 'search' on the manage users page\n[#] Cancel-button didnt work on edit profile page\n[#] Modified the code to prevent PHP Notice errors\n[#] List option \"Disabled users\" now also lists users with NULL as enabled value\n[#] Max connection field only accepts numbers\n[-] Most of the mysql code\n[-] Some mysql field types to speed it up a bit and to save some storage\n[-] Replaced \"Profile(s)\" with \"Password\" on manage users page\n[-] Moved the mysql server info into genxml.php so it can be placed anywhere on a server\n[-] Changed \"mySQL\" into \"MySQL\" in the name to follow the officiall name of the database\n\n\n1.0.1 [2010-08-24]\n[#] WSOD (white screen of death) bug\n\n\n1.0 [2010-08-06]\n[+] First stable release", "function checkusername() {\n\tvar username=$('#newuser input[name=user]').val();\n\tvar password=$('#newuser input[name=password]').val();\n\t\tif(username==\"\" || password==\"\") {\n\t\t\ttoastr.error('You must enter a username and a password');\n\t\t\t\tif(username==\"\") {\n\t\t\t\t\tnewuser.user.focus();\n\t\t\t\t} else if(password==\"\") {\n\t\t\t\t\tnewuser.password.focus();\n\t\t\t\t}\n\t\t} else {\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'post',\n\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\tdata: 'function=1&username='+username,\n\t\t\t\tcache: false,\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\ttoastr.error('Username already exists');\n\t\t\t\t\t\tnewuser.user.focus();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$('#newuser').trigger('submit', true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n}\n\nfunction checkeditusername() {\n\tvar username=$('#edituser input[name=user]').val();\n\tvar rusername=$('#edituser input[name=ruser]').val();\n\tvar password=$('#edituser input[name=password]').val();\n\t\tif(username==\"\" || password==\"\") {\n\t\t\ttoastr.error('You must enter a username and a password');\n\t\t\t\tif(password==\"\") {\n\t\t\t\t\tedituser.password.focus();\n\t\t\t\t}\n\t\t\t\tif(username==\"\") {\n\t\t\t\t\tedituser.user.focus();\n\t\t\t\t}\n\t\t} else {\n\t\t\tif(username!=rusername) {\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\ttype: 'post',\n\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\tdata: 'function=1&username='+username,\n\t\t\t\t\tcache: false,\n\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\ttoastr.error('Username already exists');\n\t\t\t\t\t\t\tedituser.user.focus();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$('#edituser').trigger('submit', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t$('#edituser').trigger('submit', true);\n\t\t\t}\n\t\t}\n}\n\nfunction checkgroupname() {\n\tvar groupname=$('#newgroup input[name=name]').val();\n\t\tif(groupname==\"\") {\n\t\t\ttoastr.error('You must enter a group name');\n\t\t\tnewgroup.name.focus();\n\t\t} else {\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'post',\n\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\tdata: 'function=2&groupname='+groupname,\n\t\t\t\tcache: false,\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\ttoastr.error('Group already exists');\n\t\t\t\t\t\tnewgroup.name.focus();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$('#newgroup').trigger('submit', true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n}\n\t\t\nfunction checkeditgroupname() {\n\tvar groupname=$('#editgroup input[name=name]').val();\n\tvar rgroupname=$('#editgroup input[name=rname]').val();\n\t\tif(groupname==\"\") {\n\t\t\ttoastr.error('You must enter a group name');\n\t\t\teditgroup.name.focus();\n\t\t} else {\n\t\t\tif(groupname!=rgroupname) {\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\ttype: 'post',\n\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\tdata: 'function=2&groupname='+groupname,\n\t\t\t\t\tcache: false,\n\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\ttoastr.error('Group already exists');\n\t\t\t\t\t\t\teditgroup.name.focus();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$('#editgroup').trigger('submit', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t$('#editgroup').trigger('submit', true);\n\t\t\t}\n\t\t}\n}\n\nfunction checkprofilename() {\n\tvar profilename=$('#newprofile input[name=name]').val();\n\tvar cspvalue=$('#newprofile input[name=cspvalue]').val();\n\t\tif(profilename==\"\") {\n\t\t\ttoastr.error('You must enter a profile name');\n\t\t\tnewprofile.name.focus();\n\t\t} else {\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'post',\n\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\tdata: 'function=3&profilename='+profilename,\n\t\t\t\tcache: false,\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\ttoastr.error('Profile already exists');\n\t\t\t\t\t\tnewprofile.name.focus();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tjQuery.ajax({\n\t\t\t\t\t\t\ttype: 'post',\n\t\t\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\t\t\tdata: 'function=5&cspvalue='+cspvalue,\n\t\t\t\t\t\t\tcache: false,\n\t\t\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\t\t\ttoastr.error('CSP value already exists');\n\t\t\t\t\t\t\t\t\tnewprofile.cspvalue.focus();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$('#newprofile').trigger('submit', true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n}\n\nfunction checkeditprofilename() {\n\tvar profilename=$('#editprofile input[name=name]').val();\n\tvar rprofilename=$('#editprofile input[name=rname]').val();\n\tvar cspvalue=$('#editprofile input[name=cspvalue]').val();\n\tvar rcspvalue=$('#editprofile input[name=rcspvalue]').val();\n\t\tif(profilename==\"\") {\n\t\t\ttoastr.error('You must enter a profile name');\n\t\t\teditprofile.name.focus();\n\t\t} else {\n\t\t\tif(profilename!=rprofilename) {\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\ttype: 'post',\n\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\tdata: 'function=3&profilename='+profilename,\n\t\t\t\t\tcache: false,\n\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\ttoastr.error('Profile already exists');\n\t\t\t\t\t\t\teditprofile.name.focus();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(cspvalue!=rcspvalue) {\n\t\t\t\t\t\t\t\tjQuery.ajax({\n\t\t\t\t\t\t\t\t\ttype: 'post',\n\t\t\t\t\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\t\t\t\t\tdata: 'function=5&cspvalue='+cspvalue,\n\t\t\t\t\t\t\t\t\tcache: false,\n\t\t\t\t\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\t\t\t\t\ttoastr.error('CSP value already exists');\n\t\t\t\t\t\t\t\t\t\t\teditprofile.cspvalue.focus();\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t$('#editprofile').trigger('submit', true);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$('#editprofile').trigger('submit', true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif(cspvalue!=rcspvalue) {\n\t\t\t\t\tjQuery.ajax({\n\t\t\t\t\t\ttype: 'post',\n\t\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\t\tdata: 'function=5&cspvalue='+cspvalue,\n\t\t\t\t\t\tcache: false,\n\t\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\t\ttoastr.error('CSP value already exists');\n\t\t\t\t\t\t\t\teditprofile.cspvalue.focus();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$('#editprofile').trigger('submit', true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t$('#editprofile').trigger('submit', true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n}\n\nfunction checkadminname() {\n\tvar adminname=$('#newadmin input[name=user]').val();\n\tvar adminpass=$('#newadmin input[name=pass]').val();\n\tvar adminlevel=$('#newadmin select[name=admlvl]').val();\n\tvar usergroup=$('#newadmin select[name=ugroup]').val();\n\t\tif(adminname==\"\" || adminpass==\"\") {\n\t\t\ttoastr.error('You must enter a username and a password');\n\t\t\t\tif(adminname==\"\") {\n\t\t\t\t\tnewadmin.user.focus();\n\t\t\t\t} else if(adminpass==\"\") {\n\t\t\t\t\tnewadmin.pass.focus();\n\t\t\t\t}\n\t\t} else {\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'post',\n\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\tdata: 'function=4&adminname='+adminname,\n\t\t\t\tcache: false,\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\ttoastr.error('Admin already exists');\n\t\t\t\t\t\tnewadmin.user.focus();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(adminlevel==\"2\" && usergroup==\"0\" || adminlevel==\"2\" && usergroup==\"\") {\n\t\t\t\t\t\t\ttoastr.error('You must select a group');\n\t\t\t\t\t\t\tnewadmin.ugroup.focus();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$('#newadmin').trigger('submit', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n}\n\nfunction checkeditadminname() {\n\tvar adminname=$('#editadmin input[name=user]').val();\n\tvar radminname=$('#editadmin input[name=ruser]').val();\n\t\tif(adminname==\"\") {\n\t\t\ttoastr.error('You must enter a username');\n\t\t\t\tif(adminname==\"\") {\n\t\t\t\t\teditadmin.user.focus();\n\t\t\t\t}\n\t\t} else {\n\t\t\tif(adminname!=radminname) {\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\ttype: 'post',\n\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\tdata: 'function=4&adminname='+adminname,\n\t\t\t\t\tcache: false,\n\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\ttoastr.error('Admin already exists');\n\t\t\t\t\t\t\teditadmin.user.focus();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$('#editadmin').trigger('submit', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t$('#editadmin').trigger('submit', true);\n\t\t\t}\n\t\t}\n}\n\nfunction checkchpassadminname() {\n\tvar adminpass1=$('#chpassadmin input[name=pass1]').val();\n\tvar adminpass2=$('#chpassadmin input[name=pass2]').val();\n\t\tif(adminpass1==\"\" || adminpass2==\"\") {\n\t\t\ttoastr.error('You must fill in both fields');\n\t\t\t\tif(adminpass1==\"\") {\n\t\t\t\t\tchpassadmin.pass1.focus();\n\t\t\t\t}\n\t\t\t\tif(adminpass2==\"\") {\n\t\t\t\t\tchpassadmin.pass2.focus();\n\t\t\t\t}\n\t\t} else {\n\t\t\tif(adminpass1==adminpass2) {\n\t\t\t\t$('#chpassadmin').trigger('submit', true);\n\t\t\t} else {\n\t\t\t\ttoastr.error('Passwords dont match');\n\t\t\t\tchpassadmin.pass1.focus();\n\t\t\t}\n\t\t}\n}\n\nfunction enableuser(uid,admlvl,admgrp,admid) {\n\tif(uid!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=6&uid='+uid+'&admlvl='+admlvl+'&admgrp='+admgrp+'&admid='+admid,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==0) {\n\t\t\t\t\t$('#usrenabled-'+uid).html('<span class=\\\"label label-success\\\">Enabled</span>');\n\t\t\t\t\t$('#usrlnkenabled-'+uid).attr('onclick','disableuser(\\''+uid+'\\',\\''+admlvl+'\\',\\''+admgrp+'\\',\\''+admid+'\\');');\n\t\t\t\t\t$('#ausrenabled-'+uid).html('Disable');\n\t\t\t\t\t$('#ausrenabled-'+uid).attr('onclick','disableuser(\\''+uid+'\\',\\''+admlvl+'\\',\\''+admgrp+'\\',\\''+admid+'\\');');\n\t\t\t\t}\n\t\t\t\tif(response==1) {\n\t\t\t\t\ttoastr.error('This user does not belong to you');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction disableuser(uid,admlvl,admgrp,admid) {\n\tif(uid!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=7&uid='+uid+'&admlvl='+admlvl+'&admgrp='+admgrp+'&admid='+admid,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==0) {\n\t\t\t\t\t$('#usrenabled-'+uid).html('<span class=\\\"label label-important\\\">Disabled</span>');\n\t\t\t\t\t$('#usrlnkenabled-'+uid).attr('onclick','enableuser(\\''+uid+'\\',\\''+admlvl+'\\',\\''+admgrp+'\\',\\''+admid+'\\');');\n\t\t\t\t\t$('#ausrenabled-'+uid).html('Enable');\n\t\t\t\t\t$('#ausrenabled-'+uid).attr('onclick','enableuser(\\''+uid+'\\',\\''+admlvl+'\\',\\''+admgrp+'\\',\\''+admid+'\\');');\n\t\t\t\t}\n\t\t\t\tif(response==1) {\n\t\t\t\t\ttoastr.error('This user does not belong to you');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction enableadmin(aid) {\n\tif(aid!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=8&aid='+aid,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==0) {\n\t\t\t\t\t$('#admenabled-'+aid).html('<span class=\\\"label label-success\\\">Enabled</span>');\n\t\t\t\t\t$('#admlnkenabled-'+aid).attr('onclick','disableadmin(\\''+aid+'\\');');\n\t\t\t\t\t$('#aadmenabled-'+aid).html('Disable');\n\t\t\t\t\t$('#aadmenabled-'+aid).attr('onclick','disableadmin(\\''+aid+'\\');');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction disableadmin(aid) {\n\tif(aid!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=9&aid='+aid,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==0) {\n\t\t\t\t\t$('#admenabled-'+aid).html('<span class=\\\"label label-important\\\">Disabled</span>');\n\t\t\t\t\t$('#admlnkenabled-'+aid).attr('onclick','enableadmin(\\''+aid+'\\');');\n\t\t\t\t\t$('#aadmenabled-'+aid).html('Enable');\n\t\t\t\t\t$('#aadmenabled-'+aid).attr('onclick','enableadmin(\\''+aid+'\\');');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction enablegroup(gid) {\n\tif(gid!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=15&gid='+gid,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==0) {\n\t\t\t\t\t$('#grpenabled-'+gid).html('<span class=\\\"label label-success\\\">Enabled</span>');\n\t\t\t\t\t$('#grplnkenabled-'+gid).attr('onclick','disablegroup(\\''+gid+'\\');');\n\t\t\t\t\t$('#agrpenabled-'+gid).html('Disable');\n\t\t\t\t\t$('#agrpenabled-'+gid).attr('onclick','disablegroup(\\''+gid+'\\');');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction disablegroup(gid) {\n\tif(gid!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=16&gid='+gid,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==0) {\n\t\t\t\t\t$('#grpenabled-'+gid).html('<span class=\\\"label label-important\\\">Disabled</span>');\n\t\t\t\t\t$('#grplnkenabled-'+gid).attr('onclick','enablegroup(\\''+gid+'\\');');\n\t\t\t\t\t$('#agrpenabled-'+gid).html('Enable');\n\t\t\t\t\t$('#agrpenabled-'+gid).attr('onclick','enablegroup(\\''+gid+'\\');');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction checkquickedit() {\n\tvar username=$('#newsearch input[name=quickedit]').val();\n\t\tif(username==\"\") {\n\t\t\ttoastr.error('You must enter a username');\n\t\t\tnewsearch.quickedit.focus();\n\t\t} else {\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'post',\n\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\tdata: 'function=10&username='+username,\n\t\t\t\tcache: false,\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif(response!=\"\") {\n\t\t\t\t\t\twindow.location.href='edituser.php?uid='+response;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoastr.error('Username dont exists');\n\t\t\t\t\t\tnewsearch.quickedit.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n}\n\nfunction cspkickuser(username) {\n\tif(username!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=11&username='+username,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==1) {\n\t\t\t\t\t$('#cspstate-'+username).html('');\n\t\t\t\t\ttoastr.success(username+' kicked');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction csploadsendosd(username) {\n\tif(username!=\"\") {\n\t\t$('#osdusr').val(username);\n\t\t$('#osdmsg').val('');\n\t\t$('#osdusrlabel').html('<label>Message to <strong>'+username+'</strong></label>');\n\t\t$('#modalCspSendOsd').modal({ show: true });\n\t}\n}\n\nfunction checkcspsendosd() {\n\tvar username=$('input[name=osdusr]').val();\n\tvar message=$('input[name=osdmsg]').val();\n\t\tif(message==\"\") {\n\t\t\ttoastr.error('Please enter a message');\n\t\t\t$('#osdmsg').focus();\n\t\t} else {\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'post',\n\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\tdata: 'function=12&username='+username+'&message='+message,\n\t\t\t\tcache: false,\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t$('#modalCspSendOsd').modal('hide');\n\t\t\t\t\t\ttoastr.success('Message sent');\n\t\t\t\t\t} \n\t\t\t\t\tif(response==2) {\n\t\t\t\t\t\t$('#modalCspSendOsd').modal('hide');\n\t\t\t\t\t\ttoastr.warning('No active/compatible newcamd sessions found');\n\t\t\t\t\t}\n\t\t\t\t\tif(response==0) {\n\t\t\t\t\t\t$('#modalCspSendOsd').modal('hide');\n\t\t\t\t\t\ttoastr.error('Message not sent, please try again');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n}\n\nfunction cspgetuserinfo(username) {\n\tif(username!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=13&username='+username,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response!=\"\") {\n\t\t\t\t\tvar cspdata=response.split(\";\");\n\t\t\t\t\t\t$('#cspusr-headusr').html('CSP User Info - '+username);\n\t\t\t\t\t\t$('#cspusr-loginfailures').html(ifempty(cspdata[0]));\n\t\t\t\t\t\t$('#cspusr-sessions').html(ifempty(cspdata[1]));\n\t\t\t\t\t\t$('#cspusr-host').html(ifempty(cspdata[2]));\n\t\t\t\t\t\t$('#cspusr-id').html(ifempty(cspdata[3]));\n\t\t\t\t\t\t$('#cspusr-count').html(ifempty(cspdata[4]));\n\t\t\t\t\t\t$('#cspusr-profile').html(ifempty(cspdata[5]));\n\t\t\t\t\t\t$('#cspusr-clientid').html(ifempty(cspdata[6]));\n\t\t\t\t\t\t$('#cspusr-protocol').html(ifempty(cspdata[7]));\n\t\t\t\t\t\t$('#cspusr-context').html(ifempty(cspdata[8]));\n\t\t\t\t\t\t$('#cspusr-connected').html(ifempty(cspdata[9]));\n\t\t\t\t\t\t$('#cspusr-duration').html(ifempty(cspdata[10]));\n\t\t\t\t\t\t$('#cspusr-ecmcount').html(ifempty(cspdata[11]));\n\t\t\t\t\t\t$('#cspusr-emmcount').html(ifempty(cspdata[12]));\n\t\t\t\t\t\t$('#cspusr-pendingcount').html(ifempty(cspdata[13]));\n\t\t\t\t\t\t$('#cspusr-keepalivecount').html(ifempty(cspdata[14]));\n\t\t\t\t\t\t$('#cspusr-lasttransaction').html(ifempty(cspdata[15]));\n\t\t\t\t\t\t$('#cspusr-lastzap').html(ifempty(cspdata[16]));\n\t\t\t\t\t\t$('#cspusr-idletime').html(ifempty(cspdata[17]));\n\t\t\t\t\t\t$('#cspusr-flags').html(ifempty(cspdata[18]));\n\t\t\t\t\t\t$('#cspusr-avgecminterval').html(ifempty(cspdata[19]));\n\t\t\t\t\t\t$('#cspusr-sessionid').html(ifempty(cspdata[20]));\n\t\t\t\t\t\t$('#cspusr-sessioncdata').html(ifempty(cspdata[21]));\n\t\t\t\t\t\t$('#cspusr-sessionname').html(ifempty(cspdata[22]));\n\t\t\t\t\t$('#modalCspUserInfo').modal({ show: true });\n\t\t\t\t} else {\n\t\t\t\t\ttoastr.error('Something went wrong, please try again');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction cspgetuseripinfo(username) {\n\tif(username!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=14&username='+username,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response!=\"\") {\n\t\t\t\t\tvar cspdata=response.split(\";\");\n\t\t\t\t\t\t$('#cspusrip-headusr').html('CSP User IP Info - '+username);\n\t\t\t\t\t\t$('#cspusrip-ip').html(ifempty(cspdata[0]));\n\t\t\t\t\t\t$('#cspusrip-hostname').html(ifempty(cspdata[1]));\n\t\t\t\t\t\t$('#cspusrip-continent').html(ifempty(cspdata[2]));\n\t\t\t\t\t\t$('#cspusrip-country').html(ifempty(cspdata[3]));\n\t\t\t\t\t\t$('#cspusrip-region').html(ifempty(cspdata[4]));\n\t\t\t\t\t\t$('#cspusrip-city').html(ifempty(cspdata[5]));\n\t\t\t\t\t\t$('#cspusrip-timezone').html(ifempty(cspdata[6]));\n\t\t\t\t\t\t$('#cspusrip-isp').html(ifempty(cspdata[7]));\n\t\t\t\t\t$('#modalCspUserIpInfo').modal({ show: true });\n\t\t\t\t} else {\n\t\t\t\t\ttoastr.error('Something went wrong, please try again');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}", "function ifempty(value) {\n\tif(value!=\"\") {\n\t\tretvalue=value;\n\t} else {\n\t\tretvalue=\"&nbsp; \";\n\t}\nreturn retvalue;\n}\n\nfunction rhtmlspecialchars(str) {\n\tif (typeof(str)==\"string\") {\n\t\tstr=str.replace(/&gt;/ig, \">\");\n\t\tstr=str.replace(/&lt;/ig, \"<\");\n\t\tstr=str.replace(/&#039;/g, \"'\");\n\t\tstr=str.replace(/&quot;/ig, '\"');\n\t\tstr=str.replace(/&amp;/ig, '&');\n\t}\nreturn str;\n}\n\nfunction onlynumbers(e) {\n\tif(window.event)\n\t\tvar keyCode=window.event.keyCode;\n\telse\n\t\tvar keyCode=e.which;\n\tif(keyCode > 31 && (keyCode < 48 || keyCode > 57))\nreturn false;\nreturn true;\n}\n\nchecked=false;\nfunction checkedallprof(value) {\n\tvar aa=document.getElementById(value);\n\t\tif (checked==false) {\n\t\t\tchecked=true\n\t\t} else {\n\t\t\tchecked=false\n\t\t}\n\t\tfor (var i=0; i < aa.elements.length; i++) {\n\t\t\taa.elements[i].checked = checked;\n\t\t}\n}\n\nfunction checksearch(e) {\n\tif(window.event)\n\t\tvar keyCode=window.event.keyCode;\n\telse\n\t\tvar keyCode=e.which;\n\tif(keyCode==13) {\n\t\tvar searchfor=$('#newsearch input[name=searchfor]').val();\n\t\t\tif(searchfor==\"\") {\n\t\t\t\tnewsearch.searchfor.focus();\n\t\t\t} else {\n\t\t\t\t$('#newsearch').trigger('submit', true);\n\t\t\t}\n\t}\n}"], "fixing_code": ["CSP MySQL User Manager Changelog\n--------------------------------\n\n[+] Added feature\n[#] Improved/changed feature\n[-] Bug fixed\n\n\n3.2.0 [not yet released]\n[+] Enable/disable groups\n[+] Override and force database upgrade\n[+] Check for invalid characters in username and password\n[#] Changed update check url for new releases\n[#] Removed cmum dbversion from database\n\n\n3.1.1 [2015-04-12]\n[-] Fixed a critical bug in the internal start-/expiredate\n\n\n3.1.0 [2015-04-03]\n[+] Random genxmlkey function\n[+] Manager activity logging\n[+] Internal start-/expiredate handling\n[+] Send osd to all connected users\n[+] IP lookup on connected users (requires internet access)\n[+] Change sort order of expired/soon expired users on dashboard\n[+] Listing not started users on dashboard\n[#] Only log failed admin logins\n[#] Only log failed genxml requests\n[#] Fixed broken css on text logo\n[#] Changed pencil icon on dashboard buttons to text\n[#] Improved profile handling in genxml function\n[#] Improved start/expired user listing\n[#] Improved start-/expiredate handling\n[#] Improved quick enabled for not started and expired users\n[#] Improved install script\n[#] Changed MySQL engine to InnoDB for better performance\n[-] Fixed improper error page\n\n\n3.0.0 [2014-11-12]\n[+] New responsive design\n[+] Improved security\n[+] Reworked functions and routines \n[+] Cmum installer\n[+] Boxtype and mac-address fields on users\n[+] Update checker\n[+] Admin login logging\n[+] User groups\n[+] Improved admin types with manager and group manager\n[+] Salted encrypted admin passwords\n[+] More csp info on dashboard\n[+] User start-/expire info on dashboard\n[+] Genxml logging\n[+] Auto creation of new profiles on user import\n[+] Download exported users to file\n[+] Timezone support\n[+] Profile cleanup on users when a profile is removed\n[+] Options for genxml generation\n\n\n2.3.1 [2012-11-03]\n[+] Function for genxml to require a key to generate the xml output\n[+] Added/addedby/changed/changedby added to the csv import/export function\n[+] Function to turn off/on php notices errors (debug mode)\n[+] Added 'js' folder to the robots.txt disallow list\n[+] Better support for special characters\n[+] Sorting after latest user first\n[+] Function to create random usernames\n[#] Charset error on the \"you are not authorized\" page\n[#] &-char could cause genxml to stop working\n[#] Removed unneeded mysql calls\n[#] Secured tools from url hack\n[-] Removed the '::' in the page title\n[-] Locked the 'csp value' textboxes under 'importing profiles from csp' tool\n[-] New style for buttons\n\n\n2.3 [2012-01-10]\n[+] Iphone/Android favicon\n[+] Ecm rate to default values\n[+] Optimize database tool\n[+] Database version check on login page\n[+] Administrator level to admins (administrator/manager)\n[+] Function to change admin username\n[+] Real name field for admins\n[+] Setting to turn off csp connection check\n[#] 'Add user and stay' didnt load the defaults values after a user were added if that function was turned on\n[#] Mixed layout fixes on some pages\n[-] Removed Accounts Expiration from home page\n[-] Changed 'addeby' and 'changedby' to use admin.id insted of admin.name\n\n\n2.2.1 [2011-10-27]\n[#] Session variable on logout page was not set correctly\n\n\n2.2 [2011-10-18]\n[+] Better mysql error control\n[+] Csp server connection check function\n[+] Csp server connection check on all pages that uses it\n[+] Csp server connection failed notice in header\n[+] Setting to change random password characters and length\n[+] Default user order setting\n[+] Service name fetching from csp server for active sessions\n[#] Unset variables on tools page\n[#] Mis-sized tables in csp user info on manager users page\n[#] Added user notification on manage users page didnt show\n[#] Minor code modifications\n[#] Error on listing online/active/idle users\n[#] Improved fetch from csp server function to minimize mysql server load\n\n\n2.1 [2011-07-17]\n[+] Delete user-button on edit user page\n[+] Logout confirmation prompt\n[+] New add-/edituser function\n[+] New confirmation style on login page\n[+] Idle icon for idle users on manage users page\n[+] Fetch data about each user from csp server, click on the username on manage users page to show\n[+] Custom csp values included in csp xml user export tool\n[+] Ecm-rate field to users (requires csp usermanager that supports this, like the AdvXmlUserManager)\n[+] Start-date and expire-date  fields to users (requires csp usermanager that supports this, like the AdvXmlUserManager)\n[+] Acive-/idle users listing option on manage users page\n[+] Expired users are listed with a yellow dot on the manage users page\n[+] Expired users are shown on the home page\n[+] Setting to change what will be shown in the extra column on manage users page (default: password)\n[#] Page layout on some pages\n[#] Default listing on manage users page wasnt always by username\n[#] Search on manage users page now includes all relevant user fields\n[#] Username can no longer be changed to null (nothing)\n[#] Various layout bugs\n[#] PHP notice error on manage users page on some apache configurations\n[#] Better online/offline/idle check on users from csp server\n[-] Moved favicon.ico to www root to avoid apache errors\n[-] Merged some files together and removed unused files\n[-] '10 Latest Failed Login Attempts' only shows if there has been any failed login attempts and logging is enabled\n[-] Removed one column add-/edit user page\n[-] Switched places on displayname and the extra column on manage users page\n\n\n2.0.6 [2011-02-15]\n[+] Custom csp values on userinfo page\n[+] Custom csp values as default value\n[+] Password must be given 2 times and match when changing then password for a admin\n[+] SQL server checks in upgrade script\n[+] Custom csp values to csv user import and export\n[#] Typo in configcheck\n[#] Csp xml user import got broken in version 2.0.5\n[#] Username and password must be included when importing users, else import will skip that user\n[#] Export users to csv output\n[#] Some tools didnt get selected when choosing them under tools\n[#] Improved update csp users tool\n[#] Improved send osd message page layout\n\n\n2.0.5 [2011-02-12]\n[+] Back button on user info page\n[+] Setting to show/hide send osd message link\n[+] Replace function for invalid chars on add-/import users\n[+] Custom csp values field for users, makes it possible to output custom values into the genxml output for special/homemade versions of csp\n[+] Upgrade script for database upgrades\n[#] Profile '*' is auto removed from import list\n[-] Send osd link is hidden by default\n[-] Default is now 2 columns add user page\n\n\n2.0.4 [2011-01-01]\n[+] Tool to export user database to csp xml config code\n[+] Tool to export user database to csv format\n[+] Function to change username for users\n[+] Function to create a random password for a new user\n[+] Function to send osd messages to users\n[+] Tool to import profiles from csp server\n[#] Layout bug with status messages on the 2 columns add user page\n[#] Some typos on the profile pages\n\n\n2.0.3 [2010-12-26]\n[#] 'Clear fields'-button didnt show on 2 columns add user page\n\n\n2.0.2 [2010-12-26]\n[+] 'Clear fields'-button on add user page that clears all fields\n[#] Kick user function didnt work with HTTPS\n[#] Status was not showed correct when use defaults was used on add user page\n[-] Default listing to username on manage user page\n\n\n2.0.1 [2010-12-03]\n[#] genxml.php did only output 1 profile even if user had more\n[#] PHP Undefined offset error when importing users from csv\n[#] When importing users profiles were stuck through the hole import process\n[#] Users with no profile(s) was added with bad data when importing from csv\n\n\n2.0 [2010-12-02]\n[+] Settings page for various settings\n[+] Default values on add user page, can be set on settings page\n[+] Session timeout function, will kill a idle admin connection if it has been idle longer then given time, timeout can be changed on settings page (default: 600 seconds)\n[+] Comment field added to users\n[+] Tool to import users from csv\n[+] Profile manager for managing profiles\n[+] New tool page with various tools\n[+] Setting to hide all text from login page\n[+] Function to log all failed login attempts\n[+] Setting to show/hide help icons from the add user page\n[+] Tool to delete all disabled users\n[+] Tool to enable/disable all users\n[+] Setting to give the c.m.u.m server a custom name\n[+] Information page to show all the info about a user\n[+] Setting to fetch various data from given csp server\n[+] Tool to fetch/install new user files to csp\n[+] Function to show if a user is online on the csp server\n[+] Tool to import users from csp xml config\n[+] Tool to empty the entire user database\n[+] Function to kick a online user from the csp server\n[+] Quick enable/disable users by clicking on their status icon\n[+] Setting to change layout on add-/edit user pages to 1 or 2 columns\n[+] More info on the home page\n[+] Email-address field to userdatabase\n[+] New profile handling system\n[+] Warning message if config.php is not setup correctly or not found\n[+] Group field to userdatabase\n[+] Created and last changed logging added to users\n[+] Admin accounts can now be set as enabled or disabled\n[+] Charset is now configurable from config.php (default: utf-8)\n[+] Different color for odd and even lines on user-/admin-/profile listing\n[+] List after online users on manage users page\n[+] Update-users command is sent to csp server on logout if 'fetch data from csp server' is active\n[+] Charset setting to genxml.php (default: utf-8)\n[+] Border around all input buttons\n[+] MySQL connection check, will show a error if it's not possible to connect to the MySQL server\n[#] Add-/edituser handling\n[#] Various layout bugs\n[#] Minor layout improvements for internet explorer\n[#] The 'maxconnections=0' bug\n[#] Auto remove of empty spaces in beginning and end of textfiled 'quicked' and 'search' on the manage users page\n[#] Cancel-button didnt work on edit profile page\n[#] Modified the code to prevent PHP Notice errors\n[#] List option \"Disabled users\" now also lists users with NULL as enabled value\n[#] Max connection field only accepts numbers\n[-] Most of the mysql code\n[-] Some mysql field types to speed it up a bit and to save some storage\n[-] Replaced \"Profile(s)\" with \"Password\" on manage users page\n[-] Moved the mysql server info into genxml.php so it can be placed anywhere on a server\n[-] Changed \"mySQL\" into \"MySQL\" in the name to follow the officiall name of the database\n\n\n1.0.1 [2010-08-24]\n[#] WSOD (white screen of death) bug\n\n\n1.0 [2010-08-06]\n[+] First stable release", "function checkusername() {\n\tvar username=$('#newuser input[name=user]').val();\n\tvar password=$('#newuser input[name=password]').val();\n\t\tif(username==\"\" || password==\"\") {\n\t\t\ttoastr.error('You must enter a username and a password');\n\t\t\t\tif(username==\"\") {\n\t\t\t\t\tnewuser.user.focus();\n\t\t\t\t} else if(password==\"\") {\n\t\t\t\t\tnewuser.password.focus();\n\t\t\t\t}\n\t\t} else if(alphanumeric(username)==false || alphanumeric(password)==false) {\n\t\t\tif(alphanumeric(username)==false) {\n\t\t\t\ttoastr.error('Username contains invalid characters');\n\t\t\t\tnewuser.user.focus();\n\t\t\t} else if(alphanumeric(password)==false) {\n\t\t\t\ttoastr.error('Password contains invalid characters');\n\t\t\t\tnewuser.password.focus();\n\t\t\t}\n\t\t} else {\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'post',\n\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\tdata: 'function=1&username='+username,\n\t\t\t\tcache: false,\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\ttoastr.error('Username already exists');\n\t\t\t\t\t\tnewuser.user.focus();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$('#newuser').trigger('submit', true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n}\n\nfunction checkeditusername() {\n\tvar username=$('#edituser input[name=user]').val();\n\tvar rusername=$('#edituser input[name=ruser]').val();\n\tvar password=$('#edituser input[name=password]').val();\n\t\tif(username==\"\" || password==\"\") {\n\t\t\ttoastr.error('You must enter a username and a password');\n\t\t\t\tif(password==\"\") {\n\t\t\t\t\tedituser.password.focus();\n\t\t\t\t}\n\t\t\t\tif(username==\"\") {\n\t\t\t\t\tedituser.user.focus();\n\t\t\t\t}\n\t\t} else if(alphanumeric(username)==false || alphanumeric(password)==false) {\n\t\t\tif(alphanumeric(username)==false) {\n\t\t\t\ttoastr.error('Username contains invalid characters');\n\t\t\t\tnewuser.user.focus();\n\t\t\t} else if(alphanumeric(password)==false) {\n\t\t\t\ttoastr.error('Password contains invalid characters');\n\t\t\t\tnewuser.password.focus();\n\t\t\t}\n\t\t} else {\n\t\t\tif(username!=rusername) {\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\ttype: 'post',\n\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\tdata: 'function=1&username='+username,\n\t\t\t\t\tcache: false,\n\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\ttoastr.error('Username already exists');\n\t\t\t\t\t\t\tedituser.user.focus();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$('#edituser').trigger('submit', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t$('#edituser').trigger('submit', true);\n\t\t\t}\n\t\t}\n}\n\nfunction checkgroupname() {\n\tvar groupname=$('#newgroup input[name=name]').val();\n\t\tif(groupname==\"\") {\n\t\t\ttoastr.error('You must enter a group name');\n\t\t\tnewgroup.name.focus();\n\t\t} else {\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'post',\n\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\tdata: 'function=2&groupname='+groupname,\n\t\t\t\tcache: false,\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\ttoastr.error('Group already exists');\n\t\t\t\t\t\tnewgroup.name.focus();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$('#newgroup').trigger('submit', true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n}\n\t\t\nfunction checkeditgroupname() {\n\tvar groupname=$('#editgroup input[name=name]').val();\n\tvar rgroupname=$('#editgroup input[name=rname]').val();\n\t\tif(groupname==\"\") {\n\t\t\ttoastr.error('You must enter a group name');\n\t\t\teditgroup.name.focus();\n\t\t} else {\n\t\t\tif(groupname!=rgroupname) {\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\ttype: 'post',\n\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\tdata: 'function=2&groupname='+groupname,\n\t\t\t\t\tcache: false,\n\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\ttoastr.error('Group already exists');\n\t\t\t\t\t\t\teditgroup.name.focus();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$('#editgroup').trigger('submit', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t$('#editgroup').trigger('submit', true);\n\t\t\t}\n\t\t}\n}\n\nfunction checkprofilename() {\n\tvar profilename=$('#newprofile input[name=name]').val();\n\tvar cspvalue=$('#newprofile input[name=cspvalue]').val();\n\t\tif(profilename==\"\") {\n\t\t\ttoastr.error('You must enter a profile name');\n\t\t\tnewprofile.name.focus();\n\t\t} else {\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'post',\n\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\tdata: 'function=3&profilename='+profilename,\n\t\t\t\tcache: false,\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\ttoastr.error('Profile already exists');\n\t\t\t\t\t\tnewprofile.name.focus();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tjQuery.ajax({\n\t\t\t\t\t\t\ttype: 'post',\n\t\t\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\t\t\tdata: 'function=5&cspvalue='+cspvalue,\n\t\t\t\t\t\t\tcache: false,\n\t\t\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\t\t\ttoastr.error('CSP value already exists');\n\t\t\t\t\t\t\t\t\tnewprofile.cspvalue.focus();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$('#newprofile').trigger('submit', true);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n}\n\nfunction checkeditprofilename() {\n\tvar profilename=$('#editprofile input[name=name]').val();\n\tvar rprofilename=$('#editprofile input[name=rname]').val();\n\tvar cspvalue=$('#editprofile input[name=cspvalue]').val();\n\tvar rcspvalue=$('#editprofile input[name=rcspvalue]').val();\n\t\tif(profilename==\"\") {\n\t\t\ttoastr.error('You must enter a profile name');\n\t\t\teditprofile.name.focus();\n\t\t} else {\n\t\t\tif(profilename!=rprofilename) {\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\ttype: 'post',\n\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\tdata: 'function=3&profilename='+profilename,\n\t\t\t\t\tcache: false,\n\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\ttoastr.error('Profile already exists');\n\t\t\t\t\t\t\teditprofile.name.focus();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif(cspvalue!=rcspvalue) {\n\t\t\t\t\t\t\t\tjQuery.ajax({\n\t\t\t\t\t\t\t\t\ttype: 'post',\n\t\t\t\t\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\t\t\t\t\tdata: 'function=5&cspvalue='+cspvalue,\n\t\t\t\t\t\t\t\t\tcache: false,\n\t\t\t\t\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\t\t\t\t\ttoastr.error('CSP value already exists');\n\t\t\t\t\t\t\t\t\t\t\teditprofile.cspvalue.focus();\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t$('#editprofile').trigger('submit', true);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$('#editprofile').trigger('submit', true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif(cspvalue!=rcspvalue) {\n\t\t\t\t\tjQuery.ajax({\n\t\t\t\t\t\ttype: 'post',\n\t\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\t\tdata: 'function=5&cspvalue='+cspvalue,\n\t\t\t\t\t\tcache: false,\n\t\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\t\ttoastr.error('CSP value already exists');\n\t\t\t\t\t\t\t\teditprofile.cspvalue.focus();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$('#editprofile').trigger('submit', true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t$('#editprofile').trigger('submit', true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n}\n\nfunction checkadminname() {\n\tvar adminname=$('#newadmin input[name=user]').val();\n\tvar adminpass=$('#newadmin input[name=pass]').val();\n\tvar adminlevel=$('#newadmin select[name=admlvl]').val();\n\tvar usergroup=$('#newadmin select[name=ugroup]').val();\n\t\tif(adminname==\"\" || adminpass==\"\") {\n\t\t\ttoastr.error('You must enter a username and a password');\n\t\t\t\tif(adminname==\"\") {\n\t\t\t\t\tnewadmin.user.focus();\n\t\t\t\t} else if(adminpass==\"\") {\n\t\t\t\t\tnewadmin.pass.focus();\n\t\t\t\t}\n\t\t} else {\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'post',\n\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\tdata: 'function=4&adminname='+adminname,\n\t\t\t\tcache: false,\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\ttoastr.error('Admin already exists');\n\t\t\t\t\t\tnewadmin.user.focus();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(adminlevel==\"2\" && usergroup==\"0\" || adminlevel==\"2\" && usergroup==\"\") {\n\t\t\t\t\t\t\ttoastr.error('You must select a group');\n\t\t\t\t\t\t\tnewadmin.ugroup.focus();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$('#newadmin').trigger('submit', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n}\n\nfunction checkeditadminname() {\n\tvar adminname=$('#editadmin input[name=user]').val();\n\tvar radminname=$('#editadmin input[name=ruser]').val();\n\t\tif(adminname==\"\") {\n\t\t\ttoastr.error('You must enter a username');\n\t\t\t\tif(adminname==\"\") {\n\t\t\t\t\teditadmin.user.focus();\n\t\t\t\t}\n\t\t} else {\n\t\t\tif(adminname!=radminname) {\n\t\t\t\tjQuery.ajax({\n\t\t\t\t\ttype: 'post',\n\t\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\t\tdata: 'function=4&adminname='+adminname,\n\t\t\t\t\tcache: false,\n\t\t\t\t\tsuccess: function(response) {\n\t\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t\ttoastr.error('Admin already exists');\n\t\t\t\t\t\t\teditadmin.user.focus();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$('#editadmin').trigger('submit', true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t$('#editadmin').trigger('submit', true);\n\t\t\t}\n\t\t}\n}\n\nfunction checkchpassadminname() {\n\tvar adminpass1=$('#chpassadmin input[name=pass1]').val();\n\tvar adminpass2=$('#chpassadmin input[name=pass2]').val();\n\t\tif(adminpass1==\"\" || adminpass2==\"\") {\n\t\t\ttoastr.error('You must fill in both fields');\n\t\t\t\tif(adminpass1==\"\") {\n\t\t\t\t\tchpassadmin.pass1.focus();\n\t\t\t\t}\n\t\t\t\tif(adminpass2==\"\") {\n\t\t\t\t\tchpassadmin.pass2.focus();\n\t\t\t\t}\n\t\t} else {\n\t\t\tif(adminpass1==adminpass2) {\n\t\t\t\t$('#chpassadmin').trigger('submit', true);\n\t\t\t} else {\n\t\t\t\ttoastr.error('Passwords dont match');\n\t\t\t\tchpassadmin.pass1.focus();\n\t\t\t}\n\t\t}\n}\n\nfunction enableuser(uid,admlvl,admgrp,admid) {\n\tif(uid!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=6&uid='+uid+'&admlvl='+admlvl+'&admgrp='+admgrp+'&admid='+admid,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==0) {\n\t\t\t\t\t$('#usrenabled-'+uid).html('<span class=\\\"label label-success\\\">Enabled</span>');\n\t\t\t\t\t$('#usrlnkenabled-'+uid).attr('onclick','disableuser(\\''+uid+'\\',\\''+admlvl+'\\',\\''+admgrp+'\\',\\''+admid+'\\');');\n\t\t\t\t\t$('#ausrenabled-'+uid).html('Disable');\n\t\t\t\t\t$('#ausrenabled-'+uid).attr('onclick','disableuser(\\''+uid+'\\',\\''+admlvl+'\\',\\''+admgrp+'\\',\\''+admid+'\\');');\n\t\t\t\t}\n\t\t\t\tif(response==1) {\n\t\t\t\t\ttoastr.error('This user does not belong to you');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction disableuser(uid,admlvl,admgrp,admid) {\n\tif(uid!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=7&uid='+uid+'&admlvl='+admlvl+'&admgrp='+admgrp+'&admid='+admid,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==0) {\n\t\t\t\t\t$('#usrenabled-'+uid).html('<span class=\\\"label label-important\\\">Disabled</span>');\n\t\t\t\t\t$('#usrlnkenabled-'+uid).attr('onclick','enableuser(\\''+uid+'\\',\\''+admlvl+'\\',\\''+admgrp+'\\',\\''+admid+'\\');');\n\t\t\t\t\t$('#ausrenabled-'+uid).html('Enable');\n\t\t\t\t\t$('#ausrenabled-'+uid).attr('onclick','enableuser(\\''+uid+'\\',\\''+admlvl+'\\',\\''+admgrp+'\\',\\''+admid+'\\');');\n\t\t\t\t}\n\t\t\t\tif(response==1) {\n\t\t\t\t\ttoastr.error('This user does not belong to you');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction enableadmin(aid) {\n\tif(aid!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=8&aid='+aid,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==0) {\n\t\t\t\t\t$('#admenabled-'+aid).html('<span class=\\\"label label-success\\\">Enabled</span>');\n\t\t\t\t\t$('#admlnkenabled-'+aid).attr('onclick','disableadmin(\\''+aid+'\\');');\n\t\t\t\t\t$('#aadmenabled-'+aid).html('Disable');\n\t\t\t\t\t$('#aadmenabled-'+aid).attr('onclick','disableadmin(\\''+aid+'\\');');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction disableadmin(aid) {\n\tif(aid!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=9&aid='+aid,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==0) {\n\t\t\t\t\t$('#admenabled-'+aid).html('<span class=\\\"label label-important\\\">Disabled</span>');\n\t\t\t\t\t$('#admlnkenabled-'+aid).attr('onclick','enableadmin(\\''+aid+'\\');');\n\t\t\t\t\t$('#aadmenabled-'+aid).html('Enable');\n\t\t\t\t\t$('#aadmenabled-'+aid).attr('onclick','enableadmin(\\''+aid+'\\');');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction enablegroup(gid) {\n\tif(gid!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=15&gid='+gid,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==0) {\n\t\t\t\t\t$('#grpenabled-'+gid).html('<span class=\\\"label label-success\\\">Enabled</span>');\n\t\t\t\t\t$('#grplnkenabled-'+gid).attr('onclick','disablegroup(\\''+gid+'\\');');\n\t\t\t\t\t$('#agrpenabled-'+gid).html('Disable');\n\t\t\t\t\t$('#agrpenabled-'+gid).attr('onclick','disablegroup(\\''+gid+'\\');');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction disablegroup(gid) {\n\tif(gid!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=16&gid='+gid,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==0) {\n\t\t\t\t\t$('#grpenabled-'+gid).html('<span class=\\\"label label-important\\\">Disabled</span>');\n\t\t\t\t\t$('#grplnkenabled-'+gid).attr('onclick','enablegroup(\\''+gid+'\\');');\n\t\t\t\t\t$('#agrpenabled-'+gid).html('Enable');\n\t\t\t\t\t$('#agrpenabled-'+gid).attr('onclick','enablegroup(\\''+gid+'\\');');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction checkquickedit() {\n\tvar username=$('#newsearch input[name=quickedit]').val();\n\t\tif(username==\"\") {\n\t\t\ttoastr.error('You must enter a username');\n\t\t\tnewsearch.quickedit.focus();\n\t\t} else {\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'post',\n\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\tdata: 'function=10&username='+username,\n\t\t\t\tcache: false,\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif(response!=\"\") {\n\t\t\t\t\t\twindow.location.href='edituser.php?uid='+response;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoastr.error('Username dont exists');\n\t\t\t\t\t\tnewsearch.quickedit.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n}\n\nfunction cspkickuser(username) {\n\tif(username!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=11&username='+username,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response==1) {\n\t\t\t\t\t$('#cspstate-'+username).html('');\n\t\t\t\t\ttoastr.success(username+' kicked');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction csploadsendosd(username) {\n\tif(username!=\"\") {\n\t\t$('#osdusr').val(username);\n\t\t$('#osdmsg').val('');\n\t\t$('#osdusrlabel').html('<label>Message to <strong>'+username+'</strong></label>');\n\t\t$('#modalCspSendOsd').modal({ show: true });\n\t}\n}\n\nfunction checkcspsendosd() {\n\tvar username=$('input[name=osdusr]').val();\n\tvar message=$('input[name=osdmsg]').val();\n\t\tif(message==\"\") {\n\t\t\ttoastr.error('Please enter a message');\n\t\t\t$('#osdmsg').focus();\n\t\t} else {\n\t\t\tjQuery.ajax({\n\t\t\t\ttype: 'post',\n\t\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\t\tdata: 'function=12&username='+username+'&message='+message,\n\t\t\t\tcache: false,\n\t\t\t\tsuccess: function(response) {\n\t\t\t\t\tif(response==1) {\n\t\t\t\t\t\t$('#modalCspSendOsd').modal('hide');\n\t\t\t\t\t\ttoastr.success('Message sent');\n\t\t\t\t\t} \n\t\t\t\t\tif(response==2) {\n\t\t\t\t\t\t$('#modalCspSendOsd').modal('hide');\n\t\t\t\t\t\ttoastr.warning('No active/compatible newcamd sessions found');\n\t\t\t\t\t}\n\t\t\t\t\tif(response==0) {\n\t\t\t\t\t\t$('#modalCspSendOsd').modal('hide');\n\t\t\t\t\t\ttoastr.error('Message not sent, please try again');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n}\n\nfunction cspgetuserinfo(username) {\n\tif(username!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=13&username='+username,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response!=\"\") {\n\t\t\t\t\tvar cspdata=response.split(\";\");\n\t\t\t\t\t\t$('#cspusr-headusr').html('CSP User Info - '+username);\n\t\t\t\t\t\t$('#cspusr-loginfailures').html(ifempty(cspdata[0]));\n\t\t\t\t\t\t$('#cspusr-sessions').html(ifempty(cspdata[1]));\n\t\t\t\t\t\t$('#cspusr-host').html(ifempty(cspdata[2]));\n\t\t\t\t\t\t$('#cspusr-id').html(ifempty(cspdata[3]));\n\t\t\t\t\t\t$('#cspusr-count').html(ifempty(cspdata[4]));\n\t\t\t\t\t\t$('#cspusr-profile').html(ifempty(cspdata[5]));\n\t\t\t\t\t\t$('#cspusr-clientid').html(ifempty(cspdata[6]));\n\t\t\t\t\t\t$('#cspusr-protocol').html(ifempty(cspdata[7]));\n\t\t\t\t\t\t$('#cspusr-context').html(ifempty(cspdata[8]));\n\t\t\t\t\t\t$('#cspusr-connected').html(ifempty(cspdata[9]));\n\t\t\t\t\t\t$('#cspusr-duration').html(ifempty(cspdata[10]));\n\t\t\t\t\t\t$('#cspusr-ecmcount').html(ifempty(cspdata[11]));\n\t\t\t\t\t\t$('#cspusr-emmcount').html(ifempty(cspdata[12]));\n\t\t\t\t\t\t$('#cspusr-pendingcount').html(ifempty(cspdata[13]));\n\t\t\t\t\t\t$('#cspusr-keepalivecount').html(ifempty(cspdata[14]));\n\t\t\t\t\t\t$('#cspusr-lasttransaction').html(ifempty(cspdata[15]));\n\t\t\t\t\t\t$('#cspusr-lastzap').html(ifempty(cspdata[16]));\n\t\t\t\t\t\t$('#cspusr-idletime').html(ifempty(cspdata[17]));\n\t\t\t\t\t\t$('#cspusr-flags').html(ifempty(cspdata[18]));\n\t\t\t\t\t\t$('#cspusr-avgecminterval').html(ifempty(cspdata[19]));\n\t\t\t\t\t\t$('#cspusr-sessionid').html(ifempty(cspdata[20]));\n\t\t\t\t\t\t$('#cspusr-sessioncdata').html(ifempty(cspdata[21]));\n\t\t\t\t\t\t$('#cspusr-sessionname').html(ifempty(cspdata[22]));\n\t\t\t\t\t$('#modalCspUserInfo').modal({ show: true });\n\t\t\t\t} else {\n\t\t\t\t\ttoastr.error('Something went wrong, please try again');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction cspgetuseripinfo(username) {\n\tif(username!=\"\") {\n\t\tjQuery.ajax({\n\t\t\ttype: 'post',\n\t\t\turl: 'functions/ajaxhelper.php',\n\t\t\tdata: 'function=14&username='+username,\n\t\t\tcache: false,\n\t\t\tsuccess: function(response) {\n\t\t\t\tif(response!=\"\") {\n\t\t\t\t\tvar cspdata=response.split(\";\");\n\t\t\t\t\t\t$('#cspusrip-headusr').html('CSP User IP Info - '+username);\n\t\t\t\t\t\t$('#cspusrip-ip').html(ifempty(cspdata[0]));\n\t\t\t\t\t\t$('#cspusrip-hostname').html(ifempty(cspdata[1]));\n\t\t\t\t\t\t$('#cspusrip-continent').html(ifempty(cspdata[2]));\n\t\t\t\t\t\t$('#cspusrip-country').html(ifempty(cspdata[3]));\n\t\t\t\t\t\t$('#cspusrip-region').html(ifempty(cspdata[4]));\n\t\t\t\t\t\t$('#cspusrip-city').html(ifempty(cspdata[5]));\n\t\t\t\t\t\t$('#cspusrip-timezone').html(ifempty(cspdata[6]));\n\t\t\t\t\t\t$('#cspusrip-isp').html(ifempty(cspdata[7]));\n\t\t\t\t\t$('#modalCspUserIpInfo').modal({ show: true });\n\t\t\t\t} else {\n\t\t\t\t\ttoastr.error('Something went wrong, please try again');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}", "function ifempty(value) {\n\tif(value!=\"\") {\n\t\tretvalue=value;\n\t} else {\n\t\tretvalue=\"&nbsp; \";\n\t}\nreturn retvalue;\n}\n\nfunction rhtmlspecialchars(str) {\n\tif (typeof(str)==\"string\") {\n\t\tstr=str.replace(/&gt;/ig, \">\");\n\t\tstr=str.replace(/&lt;/ig, \"<\");\n\t\tstr=str.replace(/&#039;/g, \"'\");\n\t\tstr=str.replace(/&quot;/ig, '\"');\n\t\tstr=str.replace(/&amp;/ig, '&');\n\t}\nreturn str;\n}\n\nfunction onlynumbers(e) {\n\tif(window.event)\n\t\tvar keyCode=window.event.keyCode;\n\telse\n\t\tvar keyCode=e.which;\n\tif(keyCode > 31 && (keyCode < 48 || keyCode > 57))\nreturn false;\nreturn true;\n}\n\nchecked=false;\nfunction checkedallprof(value) {\n\tvar aa=document.getElementById(value);\n\t\tif (checked==false) {\n\t\t\tchecked=true\n\t\t} else {\n\t\t\tchecked=false\n\t\t}\n\t\tfor (var i=0; i < aa.elements.length; i++) {\n\t\t\taa.elements[i].checked = checked;\n\t\t}\n}\n\nfunction checksearch(e) {\n\tif(window.event)\n\t\tvar keyCode=window.event.keyCode;\n\telse\n\t\tvar keyCode=e.which;\n\tif(keyCode==13) {\n\t\tvar searchfor=$('#newsearch input[name=searchfor]').val();\n\t\t\tif(searchfor==\"\") {\n\t\t\t\tnewsearch.searchfor.focus();\n\t\t\t} else {\n\t\t\t\t$('#newsearch').trigger('submit', true);\n\t\t\t}\n\t}\n}\n\nfunction alphanumeric(inputtxt) { \n\tvar letters = /^[0-9a-zA-Z]+$/;\n\t\tif (letters.test(inputtxt)) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n}"], "filenames": ["CHANGELOG", "js/ajaxcalls.js", "js/cmum.js"], "buggy_code_start_loc": [11, 10, 56], "buggy_code_end_loc": [11, 40, 56], "fixing_code_start_loc": [12, 11, 57], "fixing_code_end_loc": [13, 57, 66], "type": "CWE-89", "message": "CSP MySQL User Manager 2.3.1 allows SQL injection, and resultant Authentication Bypass, via a crafted username during a login attempt.", "other": {"cve": {"id": "CVE-2018-10757", "sourceIdentifier": "cve@mitre.org", "published": "2018-05-05T19:29:00.240", "lastModified": "2018-06-12T17:36:09.250", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "CSP MySQL User Manager 2.3.1 allows SQL injection, and resultant Authentication Bypass, via a crafted username during a login attempt."}, {"lang": "es", "value": "CSP MySQL User Manager 2.3.1 permite la inyecci\u00f3n SQL y una omisi\u00f3n de autenticaci\u00f3n resultante mediante un nombre de usuario manipulado durante un intento de inicio de sesi\u00f3n."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:csp_mysql_user_manager_project:csp_mysql_user_manager:2.3.1:*:*:*:*:*:*:*", "matchCriteriaId": "57CBCF5A-0950-4654-B2E4-E35C95305068"}]}]}], "references": [{"url": "https://github.com/dukereborn/cmum/commit/c89158ec646c4e8e95587b650f6fd86b502ff8b5", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://packetstormsecurity.com/files/147501/cspmysqlum231-sql.txt", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}, {"url": "https://www.exploit-db.com/exploits/44589/", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory", "VDB Entry"]}]}, "github_commit_url": "https://github.com/dukereborn/cmum/commit/c89158ec646c4e8e95587b650f6fd86b502ff8b5"}}