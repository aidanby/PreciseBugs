{"buggy_code": ["# Release Notes\n\n## WIP\n\n- Fix mime type detection on asset upload\n\n## 2.6.3 (2023-08-15)\n\n- Prevent uploading .phps + .(x)html files in assets manager\n- Require verification for updating user data\n- Support post field projection after content population (via ..{fieldname})\n- Extract width + height and colors from uploaded svg files\n- Implement HTTP caching when using response cache (via rspc parameter)\n- Resolve `{field}:locale` in filter and sort parameters\n- Optimize icon font size\n- Add missing meta fields to GraphQL model definitions @filipmiik\n- Fix long text expanding grid items\n\n## 2.6.2 (2023-07-31)\n\n- Add video frame preview (assets manager)\n- Fix `$not` for MongoLite\n- Add `app.system.install` event trigger on initial installation\n- Add support for closing dialogs via `Escape`\n- Add cached modules loading\n- Update icon font\n- Fix global error handler when using spaces\n- Auto map :{space}/storage/* to .spaces/{space}/storage/* (Apache)\n\n## 2.6.1 (2023-06-24)\n\n- Fix api token checking\n\n## 2.6.0 (2023-06-21)\n\n- Try to auto-generate meaningful linked content preview if display setting is missing\n- Update Vue to v3.3.4\n- Add missing permission settings @raffaelj\n- Improve role permissions UI\n- Show locale value picker only if multiple locales are available\n- Use `crypto.randomUUID()` only if available\n- Populate only allowed models in content api (thanks @Ccamm)\n- Fix possible content `models` permission naming collision (thanks @raffaelj)\n- Fix internal content find/populate api exposing data to users without required rights (thanks @raffaelj)\n- Fix empty settings screen\n- Add csrf token validation to internal api calls to improve security (thanks @Ccamm)\n- Add clone functionality to tree content items\n- Add additional checks to `/api/system/healthcheck`\n- Fix disabling asset picker in wysiwyg field\n- Improve fields projection (eg nested fields) when using MongoLite as data storage\n- Use AG Grid instead of Tabulator.js as a foundation for the table field\n- Limit number of files to upload in admin ui based on php setting `max_file_uploads`\n\n## 2.5.2 (2023-05-18)\n\n- Fix link content item dialog\n- Update vendor libs\n\n## 2.5.1 (2023-05-15)\n\n- Fix js error thrown in dialog component\n- Remove 2FA info from internal users/load api\n- Update icons\n- Minor UI improvements\n- add `content.remove.before` event\n- Refactor `kiss-popoutmenu` component to `kiss-popout`\n- Introduce `user-info` component\n- Update Vue to v3.3.2\n- Update vendor libs\n\n## 2.5.0 (2023-04-15)\n\n- Fix initial item position on tree item creation\n- Add avif image type support (depending on used GD lib)\n- Add experimental natural language to mongo query support (only for admin ui filtering collection items and assets)\n- Add lightweight indexing library (for full-text search)\n- Make logged login data configurable\n- Add filter models feature on role permission page\n- Fix populate option singleton data queries via GraphQL\n- Clone / duplicate collection items\n- Refactor admin ui language loading\n- Add `content:field:remove` and `content:field:rename` tower cli commands to cleanup content data after model changes\n\n\n## 2.4.1 (2023-03-20)\n\n- Add field preview renderer for boolen field\n- Fix tag field\n- Add display meta property support for tree content models\n- Add active property to field-nav items\n- Add additional security check when uploading files\n- Fix assets image cache check\n- Add thumbnail api usage to internal bucket storage file previews\n- Improve revisions display performance\n\n## 2.4.0 (2023-03-08)\n\n- Add additional security check editing php files in finder\n- Fix base64 encoding data not in latin char range\n- Add internal bucket storage container feature\n- Add /content/tree/{model} api endpoint\n- Batch edit content items\n- Update vendor libs\n\n## 2.3.9 (2023-02-13)\n\n- Fix batch state update (when using MongoLite) #75\n- Fix min/max settings for number fields #76\n- Set X-Frame-Options to prevent possible clickjacking via iframe layer\n- Allow to load linked content items in display previews #78\n- Allow to load thumbnails from linked assets in display previews\n\n## 2.3.8 (2023-02-04)\n\n- Fix not allowed user role modification by intercepting request\n- Fix tree item view #72\n- Update Vue to v3.2.47\n- Improve svg loading for <kiss-svg /> elements\n- Update vendor libs\n\n## 2.3.7 (2023-01-31)\n\n- Batch update collection items state\n- Add state filter to collection items view\n- Fix possible infinite content population loop\n- Fix filter option for collection link field\n- Add content view aside event triggers\n- Deep clone data object for preview interpolation\n- Update vendor libs\n\n## 2.3.6 (2023-01-03)\n\n- Fix tree model nesting items\n- Fix table preview for repeatable wysiwyg fields\n- Fix clearing readonly fields\n- Fix filter option for collection link field\n- Update vendor libs\n\n## 2.3.5 (2022-12-15)\n\n- Fix getallheaders keys\n- Improve assets api error message on missing parameters\n- Add placeholder container if empty nav field\n- Add autofocus to app search field on show\n- Add current locale context to fields in fields renderer component\n- Invalidate opcache for edited php files via finder\n- Remove avif support due to unpredictable server configurations\n- Fix PHP 8.2 related issues\n- Fix `maxlevel` meta property if value is 0\n- Define default sorting of items in collection model meta settings\n- Auto-resolve $DATE() values in db queries\n\n## 2.3.4 (2022-11-25)\n\n- Fix user settings updating for users without admin role\n- Update vendor libs\n- Update Vue to 3.2.45\n- Cache loaded icons in admin view\n- Add drag'n drop upload of files support (finder module)\n- Fix cross-origin error (content previews) @isemog\n\n## 2.3.3 (2022-11-02)\n\n- Add ESC + auto focus support for dialogs\n- Update Vue to 3.2.41\n- Add finder module (only for super admin users)\n- Set default value to false for boolean fields\n- Update vendor libs\n\n## 2.3.2 (2022-10-24)\n\n- Add clear cache action\n- Fix spaces load error if spaces folder does not exists\n\n\n## 2.3.1 (2022-10-21)\n\n- Fix return type for Utils::parseSize\n- Update Uppy.js to v3.0.1\n- Resolve nested linked content items on content item population\n- Auto-populate content item for content previews\n- Fix response cache\n- Fix time field error (list option)\n- Refactor CORS preflight handling\n- Add spaces feature (beta)\n\n## 2.3.0 (2022-09-16)\n\n- Update vendor libs\n- Fix field-object js error\n- Don't apply default content fields on update (saveItem)\n- Fix GraphQL error when numeric field names are used\n- Fix wysiwyg field (Safari) #24\n- Fix enter on selected result in app search\n- Update Vue to 3.2.39\n- Improve custom api endpoint resolving\n- Fix updating items via API #27 @o-\n\n\n## 2.2.2 (2022-08-20)\n\n- Add `./tower app:update` cli command to update Cockpit to the latest or specific version\n- Fix exposing 2FA secret in JWT token on login\n- Enable keyboard navigation in search modal #14 @raffaelj\n- Prevent double loading of field-code.js #15 @raffaelj\n- Fix 2fa for login modal #13 @raffaelj\n\n## 2.2.1 (2022-08-10)\n\n- Fix linked tree content item display resolver\n- Refactor content models index page\n\n## 2.2.0 (2022-08-08)\n\n- Add create|update|delete endpoints content item to REST API\n- Add GraphQL mutation saveContentItem to create|update content items\n- Add GraphQL mutation deleteContentItem to delete content items\n- Add app side panel (admin layout)\n- Stop execution of code after redirecting\n\n## 2.1.2 (2022-08-04)\n\n- \ud83d\udea8 Fix typo field-contentItemtLink -> Need to re-assign field type contentItemLink \ud83d\udea8\n- General cleanup + fix typos\n- Add content tree items reorder permission\n- Refactor app layout header\n- Show more detailed error message if saving user settings fail\n- Hide publish state configuration ui if missing permission to mange publish state\n- Fix selected item link of tree model\n- Fix missing assets folders permission checks\n\n## 2.1.1 (2022-08-02)\n\n- Fix tree model route in app search results\n- Fix loosing nested level on saving tree item\n\n## 2.1.0 (2022-08-01)\n\n- Add initial global app search implementation (alt|option + f)\n- Minor fixes on closing html tag + uninitialized variable #11 @remluben\n- Update lib/vendor\n- Update vendor assets sortablejs v1.15, uppy v2.13.1, tinyMCE v6.1.2\n- Add model type tree - organize content items as tree\n\n## 2.0.2 (2022-07-20)\n\n- Fix select boxes in dark theme (chrome on windows) #8\n- Change login (noun) to log in (verb)\n- Fix required field check on nested repeatable items\n- Enable picking item by clicking on empty placeholder area (Asset + Content Link field)\n- Open api playground with preselected api key\n- Enable clear field function also in nested fields\n- Make fields-manger + fields-renderer component available by default\n- Set content model icon\n\n## 2.0.1 (2022-07-17)\n\n- Refactor admin ui localization\n- Object.freeze App._vars + App._paths\n- Make logged in user information available on the client side (App.user)\n- Update .htaccess file to deny public access to php files except router entry index.php\n- Add visual hover state to content item tables\n\n## 2.0.0 (2022-07-13)\n\n- Initial release \ud83c\udf7e\ud83e\udd73", "<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"utf-8\" />\n  <title>GraphiQL</title>\n  <meta name=\"robots\" content=\"noindex\" />\n  <style>\n    html, body {\n      height: 100%;\n      margin: 0;\n      overflow: hidden;\n      width: 100%;\n    }\n  </style>\n\n  <style>\n    <?php include($this->path('system:assets/vendor/graphiql/graphiql.min.css')) ?>\n  </style>\n  <script>\n    <?php\n      include($this->path('system:assets/vendor/graphiql/es6-promise.auto.min.js'));\n      include($this->path('system:assets/vendor/graphiql/react.production.min.js'));\n      include($this->path('system:assets/vendor/graphiql/react-dom.production.min.js'));\n      include($this->path('system:assets/vendor/graphiql/graphiql.min.js'));\n    ?>\n  </script>\n\n</head>\n<body>\n  <script>\n      // Parse the search string to get url parameters.\n      let search = window.location.search;\n      let parameters = {};\n      search.substr(1).split('&').forEach(function (entry) {\n        let eq = entry.indexOf('=');\n        if (eq >= 0) {\n          parameters[decodeURIComponent(entry.slice(0, eq))] =\n            decodeURIComponent(entry.slice(eq + 1));\n        }\n      });\n\n      // if variables was provided, try to format it.\n      if (parameters.variables) {\n        try {\n          parameters.variables =\n            JSON.stringify(JSON.parse(parameters.variables), null, 2);\n        } catch (e) {\n          // Do nothing, we want to display the invalid JSON as a string, rather\n          // than present an error.\n        }\n      }\n\n      // When the query and variables string is edited, update the URL bar so\n      // that it can be easily shared\n      function onEditQuery(newQuery) {\n        parameters.query = newQuery;\n        updateURL();\n      }\n      function onEditVariables(newVariables) {\n        parameters.variables = newVariables;\n        updateURL();\n      }\n      function onEditOperationName(newOperationName) {\n        parameters.operationName = newOperationName;\n        updateURL();\n      }\n      function updateURL() {\n        let newSearch = '?' + Object.keys(parameters).filter(function (key) {\n          return Boolean(parameters[key]);\n        }).map(function (key) {\n          return encodeURIComponent(key) + '=' +\n            encodeURIComponent(parameters[key]);\n        }).join('&');\n        history.replaceState(null, null, newSearch);\n      }\n\n       function graphQLFetcher(graphQLParams) {\n          // This example expects a GraphQL server at the path /graphql.\n          // Change this to point wherever you host your GraphQL server.\n          return fetch(window.location.origin + '<?=$this->route('/api/gql')?>', {\n            method: 'post',\n            headers: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json',\n              'API-KEY': (window.apiKey && apiKey.value) || ''\n            },\n            body: JSON.stringify(graphQLParams),\n          }).then(function (response) {\n            return response.text();\n          }).then(function (responseBody) {\n            try {\n              return JSON.parse(responseBody);\n            } catch (error) {\n              return responseBody;\n            }\n          });\n        }\n\n      // Render <GraphiQL /> into the body.\n      ReactDOM.render(\n        React.createElement(GraphiQL, {\n          fetcher: graphQLFetcher,\n          query: parameters.query,\n          variables: parameters.variables,\n          operationName: parameters.operationName,\n          onEditQuery: onEditQuery,\n          onEditVariables: onEditVariables,\n          onEditOperationName: onEditOperationName\n        }),\n        document.body,\n      );\n\n  </script>\n\n  <input id=\"apiKey\" type=\"text\" placeholder=\"API Key\" value=\"<?=($apiKey ? $apiKey : '')?>\">\n\n<style>\n\n/* GraphiQL One Dark Alt (Dark Mode) theme by Ben Keating[1]\n * Colors taken from Atom's One Dark theme[2]. Add this file to the end of\n * your <head> block to override built-in default styling.\n *\n * [1]. https://twitter.com/flowpoke\n * [2]. https://github.com/atom/atom/tree/master/packages/one-dark-ui\n */\n\n.CodeMirror {\n    background: #131720 !important;\n}\n.graphiql-container .doc-explorer-contents, .graphiql-container .history-contents {\n  background-color: #10131a;\n  border-top: 1px solid #181A1F;\n}\n\n.graphiql-container .toolbar-button {\n  background: #1c2125 !important;\n  box-shadow: none !important;\n  color: #5c626d !important;\n  border: 1px solid #181a1f !important;\n  margin: 0 !important;\n}\n\n.graphiql-container .result-window .CodeMirror-gutters {\n  background: #131720;\n  border: none !important;\n}\n\n.graphiql-container .resultWrap {\n  border-left: solid 1px #181a1f;\n}\n\n.graphiql-container .variable-editor-title {\n  background: #10131a;\n  border-bottom: 1px solid #181a1f;\n  border-top: 1px solid #181a1f;\n  color: #cacdd3;\n}\n\n.graphiql-container .topBar {\n  background: #10131a;\n  border-color: #181A1F;\n}\n\n.graphiql-container .docExplorerHide {\n  color: #606671;\n}\n\n.graphiql-container .doc-explorer-title, .graphiql-container .history-title, .doc-explorer-back {\n  color: #CACDD3 !important;\n\n}\n\n.graphiql-container .doc-explorer {\n  background: #10131a;\n}\n\n.graphiql-container .docExplorerWrap, .graphiql-container .historyPaneWrap {\n  box-shadow: none;\n}\n\n.graphiql-container .docExplorerShow {\n  border-left: none;\n}\n.graphiql-container .docExplorerShow, .graphiql-container .historyShow {\nbackground: #10131a;\nborder-bottom: 1px solid #181A1E;\ncolor: #CACDD3;\n}\n\n.graphiql-container .docExplorerShow:before, .graphiql-container .doc-explorer-back:before  {\n  border-color: #CACDD3;\n}\n\n.graphiql-container .search-box {\n  margin: auto auto 10px auto;\n  border: none;\n}\n.graphiql-container .search-box input {\n  background: #1E2127;\n  padding-left: 28px;\n}\n\n.graphiql-container .search-box:before {\n  color: #c1c4ca;\n  font-size: 21px;\n  left: 8px;\n}\n\n.graphiql-container, .graphiql-container button, .graphiql-container input {\n  color: #9299A7;\n}\n\n.CodeMirror-gutters {\n  border: none !important;\n  background-color: #282d33;\n}\n\n.CodeMirror .CodeMirror-cursor {\n    border-left: 1px solid #999;\n}\n\n.graphiql-container .execute-button {\n  background: #10131a;\n  border: 1px solid <?=($primaryColor ? $primaryColor : '#0e8fff')?>;\n  box-shadow: none !important;\n  fill: <?=($primaryColor ? $primaryColor : '#0e8fff')?>;\n}\n\n.graphiql-container .history-contents p {\n  border: none;\n}\n\n.graphiql-container .historyPaneWrap {\n  background: #10131a;\n}\n\n.graphiql-container .execute-options > li.selected, .graphiql-container .toolbar-menu-items > li.hover, .graphiql-container .toolbar-menu-items > li:active, .graphiql-container .toolbar-menu-items > li:hover, .graphiql-container .toolbar-select-options > li.hover, .graphiql-container .toolbar-select-options > li:active, .graphiql-container .toolbar-select-options > li:hover, .graphiql-container .history-contents > p:hover, .graphiql-container .history-contents > p:active {\n  background: #383C41;\n}\n\n.graphiql-container .doc-category-title {\n  border-bottom: 1px solid #181a1f;\n  color: #cacdd3;\n}\n\n.graphiql-container .field-name {\n  color: #9CA3AC;\n}\n\n.graphiql-container .type-name {\n    color: #95be76;\n}\n\n\n.cm-property {\n  color: #A5ACB8;\n}\n\n.cm-string {\n  color: #97BE7B;\n}\n\n.cm-variable {\n    color: #a87f5b;\n}\n\n.cm-attribute {\n  color: #B58860;\n}\n\n.cm-def {\n  color: #CC3932;\n}\n\n.cm-keyword {\n  color: #7cf3ff;\n}\n\n.graphiql-container .keyword {\n    color: #9ea5b0;\n}\n\n.graphiql-container .arg-name {\n    color: #b5875d;\n}\n\n.graphiql-container .doc-category-item {\n    color: #BC6069;\n}\n\na {\n  color: #7b9ad4;\n}\n\n#apiKey {\n  position: absolute;\n  z-index: 2;\n  top: 12px;\n  left: 440px;\n  border: none;\n  padding: 5px;\n  border-radius: 2px;\n  background: #2c313e;\n  color: #ccc;\n}\n</style>\n</body>\n</html>\n", "<!doctype html>\n<html>\n<head>\n    <title>REST - Api</title>\n</head>\n<body>\n    <rapi-doc\n        spec-url=\"<?=$openApiUrl?>\"\n        show-header=\"false\"\n        show-info=\"false\"\n        render-style=\"read\"\n        load-fonts=\"false\"\n\n        <?php if($apiKey): ?>\n        api-key-name = \"api-key\"\n        api-key-location = \"header\"\n        api-key-value = \"<?=$apiKey?>\"\n        <?php endif ?>\n\n        bg-color=\"<?=($bgColor ? $bgColor : '#10131a')?>\"\n        text-color=\"<?=($textColor ? $textColor : '#fafafa')?>\"\n        primary-color=\"<?=($primaryColor ? $primaryColor : '#0e8fff')?>\"\n    ></rapi-doc>\n\n    <script type=\"module\" src=\"<?=$this->base('system:assets/vendor/rapidoc.js')?>\"></script>\n</body>\n</html>\n"], "fixing_code": ["# Release Notes\n\n## WIP\n\n- Fix mime type detection on asset upload\n- Fix possible Cross-site Scripting (XSS) in Rest/GraphQL viewer\n\n## 2.6.3 (2023-08-15)\n\n- Prevent uploading .phps + .(x)html files in assets manager\n- Require verification for updating user data\n- Support post field projection after content population (via ..{fieldname})\n- Extract width + height and colors from uploaded svg files\n- Implement HTTP caching when using response cache (via rspc parameter)\n- Resolve `{field}:locale` in filter and sort parameters\n- Optimize icon font size\n- Add missing meta fields to GraphQL model definitions @filipmiik\n- Fix long text expanding grid items\n\n## 2.6.2 (2023-07-31)\n\n- Add video frame preview (assets manager)\n- Fix `$not` for MongoLite\n- Add `app.system.install` event trigger on initial installation\n- Add support for closing dialogs via `Escape`\n- Add cached modules loading\n- Update icon font\n- Fix global error handler when using spaces\n- Auto map :{space}/storage/* to .spaces/{space}/storage/* (Apache)\n\n## 2.6.1 (2023-06-24)\n\n- Fix api token checking\n\n## 2.6.0 (2023-06-21)\n\n- Try to auto-generate meaningful linked content preview if display setting is missing\n- Update Vue to v3.3.4\n- Add missing permission settings @raffaelj\n- Improve role permissions UI\n- Show locale value picker only if multiple locales are available\n- Use `crypto.randomUUID()` only if available\n- Populate only allowed models in content api (thanks @Ccamm)\n- Fix possible content `models` permission naming collision (thanks @raffaelj)\n- Fix internal content find/populate api exposing data to users without required rights (thanks @raffaelj)\n- Fix empty settings screen\n- Add csrf token validation to internal api calls to improve security (thanks @Ccamm)\n- Add clone functionality to tree content items\n- Add additional checks to `/api/system/healthcheck`\n- Fix disabling asset picker in wysiwyg field\n- Improve fields projection (eg nested fields) when using MongoLite as data storage\n- Use AG Grid instead of Tabulator.js as a foundation for the table field\n- Limit number of files to upload in admin ui based on php setting `max_file_uploads`\n\n## 2.5.2 (2023-05-18)\n\n- Fix link content item dialog\n- Update vendor libs\n\n## 2.5.1 (2023-05-15)\n\n- Fix js error thrown in dialog component\n- Remove 2FA info from internal users/load api\n- Update icons\n- Minor UI improvements\n- add `content.remove.before` event\n- Refactor `kiss-popoutmenu` component to `kiss-popout`\n- Introduce `user-info` component\n- Update Vue to v3.3.2\n- Update vendor libs\n\n## 2.5.0 (2023-04-15)\n\n- Fix initial item position on tree item creation\n- Add avif image type support (depending on used GD lib)\n- Add experimental natural language to mongo query support (only for admin ui filtering collection items and assets)\n- Add lightweight indexing library (for full-text search)\n- Make logged login data configurable\n- Add filter models feature on role permission page\n- Fix populate option singleton data queries via GraphQL\n- Clone / duplicate collection items\n- Refactor admin ui language loading\n- Add `content:field:remove` and `content:field:rename` tower cli commands to cleanup content data after model changes\n\n\n## 2.4.1 (2023-03-20)\n\n- Add field preview renderer for boolen field\n- Fix tag field\n- Add display meta property support for tree content models\n- Add active property to field-nav items\n- Add additional security check when uploading files\n- Fix assets image cache check\n- Add thumbnail api usage to internal bucket storage file previews\n- Improve revisions display performance\n\n## 2.4.0 (2023-03-08)\n\n- Add additional security check editing php files in finder\n- Fix base64 encoding data not in latin char range\n- Add internal bucket storage container feature\n- Add /content/tree/{model} api endpoint\n- Batch edit content items\n- Update vendor libs\n\n## 2.3.9 (2023-02-13)\n\n- Fix batch state update (when using MongoLite) #75\n- Fix min/max settings for number fields #76\n- Set X-Frame-Options to prevent possible clickjacking via iframe layer\n- Allow to load linked content items in display previews #78\n- Allow to load thumbnails from linked assets in display previews\n\n## 2.3.8 (2023-02-04)\n\n- Fix not allowed user role modification by intercepting request\n- Fix tree item view #72\n- Update Vue to v3.2.47\n- Improve svg loading for <kiss-svg /> elements\n- Update vendor libs\n\n## 2.3.7 (2023-01-31)\n\n- Batch update collection items state\n- Add state filter to collection items view\n- Fix possible infinite content population loop\n- Fix filter option for collection link field\n- Add content view aside event triggers\n- Deep clone data object for preview interpolation\n- Update vendor libs\n\n## 2.3.6 (2023-01-03)\n\n- Fix tree model nesting items\n- Fix table preview for repeatable wysiwyg fields\n- Fix clearing readonly fields\n- Fix filter option for collection link field\n- Update vendor libs\n\n## 2.3.5 (2022-12-15)\n\n- Fix getallheaders keys\n- Improve assets api error message on missing parameters\n- Add placeholder container if empty nav field\n- Add autofocus to app search field on show\n- Add current locale context to fields in fields renderer component\n- Invalidate opcache for edited php files via finder\n- Remove avif support due to unpredictable server configurations\n- Fix PHP 8.2 related issues\n- Fix `maxlevel` meta property if value is 0\n- Define default sorting of items in collection model meta settings\n- Auto-resolve $DATE() values in db queries\n\n## 2.3.4 (2022-11-25)\n\n- Fix user settings updating for users without admin role\n- Update vendor libs\n- Update Vue to 3.2.45\n- Cache loaded icons in admin view\n- Add drag'n drop upload of files support (finder module)\n- Fix cross-origin error (content previews) @isemog\n\n## 2.3.3 (2022-11-02)\n\n- Add ESC + auto focus support for dialogs\n- Update Vue to 3.2.41\n- Add finder module (only for super admin users)\n- Set default value to false for boolean fields\n- Update vendor libs\n\n## 2.3.2 (2022-10-24)\n\n- Add clear cache action\n- Fix spaces load error if spaces folder does not exists\n\n\n## 2.3.1 (2022-10-21)\n\n- Fix return type for Utils::parseSize\n- Update Uppy.js to v3.0.1\n- Resolve nested linked content items on content item population\n- Auto-populate content item for content previews\n- Fix response cache\n- Fix time field error (list option)\n- Refactor CORS preflight handling\n- Add spaces feature (beta)\n\n## 2.3.0 (2022-09-16)\n\n- Update vendor libs\n- Fix field-object js error\n- Don't apply default content fields on update (saveItem)\n- Fix GraphQL error when numeric field names are used\n- Fix wysiwyg field (Safari) #24\n- Fix enter on selected result in app search\n- Update Vue to 3.2.39\n- Improve custom api endpoint resolving\n- Fix updating items via API #27 @o-\n\n\n## 2.2.2 (2022-08-20)\n\n- Add `./tower app:update` cli command to update Cockpit to the latest or specific version\n- Fix exposing 2FA secret in JWT token on login\n- Enable keyboard navigation in search modal #14 @raffaelj\n- Prevent double loading of field-code.js #15 @raffaelj\n- Fix 2fa for login modal #13 @raffaelj\n\n## 2.2.1 (2022-08-10)\n\n- Fix linked tree content item display resolver\n- Refactor content models index page\n\n## 2.2.0 (2022-08-08)\n\n- Add create|update|delete endpoints content item to REST API\n- Add GraphQL mutation saveContentItem to create|update content items\n- Add GraphQL mutation deleteContentItem to delete content items\n- Add app side panel (admin layout)\n- Stop execution of code after redirecting\n\n## 2.1.2 (2022-08-04)\n\n- \ud83d\udea8 Fix typo field-contentItemtLink -> Need to re-assign field type contentItemLink \ud83d\udea8\n- General cleanup + fix typos\n- Add content tree items reorder permission\n- Refactor app layout header\n- Show more detailed error message if saving user settings fail\n- Hide publish state configuration ui if missing permission to mange publish state\n- Fix selected item link of tree model\n- Fix missing assets folders permission checks\n\n## 2.1.1 (2022-08-02)\n\n- Fix tree model route in app search results\n- Fix loosing nested level on saving tree item\n\n## 2.1.0 (2022-08-01)\n\n- Add initial global app search implementation (alt|option + f)\n- Minor fixes on closing html tag + uninitialized variable #11 @remluben\n- Update lib/vendor\n- Update vendor assets sortablejs v1.15, uppy v2.13.1, tinyMCE v6.1.2\n- Add model type tree - organize content items as tree\n\n## 2.0.2 (2022-07-20)\n\n- Fix select boxes in dark theme (chrome on windows) #8\n- Change login (noun) to log in (verb)\n- Fix required field check on nested repeatable items\n- Enable picking item by clicking on empty placeholder area (Asset + Content Link field)\n- Open api playground with preselected api key\n- Enable clear field function also in nested fields\n- Make fields-manger + fields-renderer component available by default\n- Set content model icon\n\n## 2.0.1 (2022-07-17)\n\n- Refactor admin ui localization\n- Object.freeze App._vars + App._paths\n- Make logged in user information available on the client side (App.user)\n- Update .htaccess file to deny public access to php files except router entry index.php\n- Add visual hover state to content item tables\n\n## 2.0.0 (2022-07-13)\n\n- Initial release \ud83c\udf7e\ud83e\udd73", "<!DOCTYPE html>\n<html>\n<head>\n  <meta charset=\"utf-8\" />\n  <title>GraphiQL</title>\n  <meta name=\"robots\" content=\"noindex\" />\n  <style>\n    html, body {\n      height: 100%;\n      margin: 0;\n      overflow: hidden;\n      width: 100%;\n    }\n  </style>\n\n  <style>\n    <?php include($this->path('system:assets/vendor/graphiql/graphiql.min.css')) ?>\n  </style>\n  <script>\n    <?php\n      include($this->path('system:assets/vendor/graphiql/es6-promise.auto.min.js'));\n      include($this->path('system:assets/vendor/graphiql/react.production.min.js'));\n      include($this->path('system:assets/vendor/graphiql/react-dom.production.min.js'));\n      include($this->path('system:assets/vendor/graphiql/graphiql.min.js'));\n    ?>\n  </script>\n\n</head>\n<body>\n  <script>\n      // Parse the search string to get url parameters.\n      let search = window.location.search;\n      let parameters = {};\n      search.substr(1).split('&').forEach(function (entry) {\n        let eq = entry.indexOf('=');\n        if (eq >= 0) {\n          parameters[decodeURIComponent(entry.slice(0, eq))] =\n            decodeURIComponent(entry.slice(eq + 1));\n        }\n      });\n\n      // if variables was provided, try to format it.\n      if (parameters.variables) {\n        try {\n          parameters.variables =\n            JSON.stringify(JSON.parse(parameters.variables), null, 2);\n        } catch (e) {\n          // Do nothing, we want to display the invalid JSON as a string, rather\n          // than present an error.\n        }\n      }\n\n      // When the query and variables string is edited, update the URL bar so\n      // that it can be easily shared\n      function onEditQuery(newQuery) {\n        parameters.query = newQuery;\n        updateURL();\n      }\n      function onEditVariables(newVariables) {\n        parameters.variables = newVariables;\n        updateURL();\n      }\n      function onEditOperationName(newOperationName) {\n        parameters.operationName = newOperationName;\n        updateURL();\n      }\n      function updateURL() {\n        let newSearch = '?' + Object.keys(parameters).filter(function (key) {\n          return Boolean(parameters[key]);\n        }).map(function (key) {\n          return encodeURIComponent(key) + '=' +\n            encodeURIComponent(parameters[key]);\n        }).join('&');\n        history.replaceState(null, null, newSearch);\n      }\n\n       function graphQLFetcher(graphQLParams) {\n          // This example expects a GraphQL server at the path /graphql.\n          // Change this to point wherever you host your GraphQL server.\n          return fetch(window.location.origin + '<?=$this->route('/api/gql')?>', {\n            method: 'post',\n            headers: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json',\n              'API-KEY': (window.apiKey && apiKey.value) || ''\n            },\n            body: JSON.stringify(graphQLParams),\n          }).then(function (response) {\n            return response.text();\n          }).then(function (responseBody) {\n            try {\n              return JSON.parse(responseBody);\n            } catch (error) {\n              return responseBody;\n            }\n          });\n        }\n\n      // Render <GraphiQL /> into the body.\n      ReactDOM.render(\n        React.createElement(GraphiQL, {\n          fetcher: graphQLFetcher,\n          query: parameters.query,\n          variables: parameters.variables,\n          operationName: parameters.operationName,\n          onEditQuery: onEditQuery,\n          onEditVariables: onEditVariables,\n          onEditOperationName: onEditOperationName\n        }),\n        document.body,\n      );\n\n  </script>\n\n  <input id=\"apiKey\" type=\"text\" placeholder=\"API Key\" value=\"<?=$this->escape($apiKey ? $apiKey : '')?>\">\n\n<style>\n\n/* GraphiQL One Dark Alt (Dark Mode) theme by Ben Keating[1]\n * Colors taken from Atom's One Dark theme[2]. Add this file to the end of\n * your <head> block to override built-in default styling.\n *\n * [1]. https://twitter.com/flowpoke\n * [2]. https://github.com/atom/atom/tree/master/packages/one-dark-ui\n */\n\n.CodeMirror {\n    background: #131720 !important;\n}\n.graphiql-container .doc-explorer-contents, .graphiql-container .history-contents {\n  background-color: #10131a;\n  border-top: 1px solid #181A1F;\n}\n\n.graphiql-container .toolbar-button {\n  background: #1c2125 !important;\n  box-shadow: none !important;\n  color: #5c626d !important;\n  border: 1px solid #181a1f !important;\n  margin: 0 !important;\n}\n\n.graphiql-container .result-window .CodeMirror-gutters {\n  background: #131720;\n  border: none !important;\n}\n\n.graphiql-container .resultWrap {\n  border-left: solid 1px #181a1f;\n}\n\n.graphiql-container .variable-editor-title {\n  background: #10131a;\n  border-bottom: 1px solid #181a1f;\n  border-top: 1px solid #181a1f;\n  color: #cacdd3;\n}\n\n.graphiql-container .topBar {\n  background: #10131a;\n  border-color: #181A1F;\n}\n\n.graphiql-container .docExplorerHide {\n  color: #606671;\n}\n\n.graphiql-container .doc-explorer-title, .graphiql-container .history-title, .doc-explorer-back {\n  color: #CACDD3 !important;\n\n}\n\n.graphiql-container .doc-explorer {\n  background: #10131a;\n}\n\n.graphiql-container .docExplorerWrap, .graphiql-container .historyPaneWrap {\n  box-shadow: none;\n}\n\n.graphiql-container .docExplorerShow {\n  border-left: none;\n}\n.graphiql-container .docExplorerShow, .graphiql-container .historyShow {\nbackground: #10131a;\nborder-bottom: 1px solid #181A1E;\ncolor: #CACDD3;\n}\n\n.graphiql-container .docExplorerShow:before, .graphiql-container .doc-explorer-back:before  {\n  border-color: #CACDD3;\n}\n\n.graphiql-container .search-box {\n  margin: auto auto 10px auto;\n  border: none;\n}\n.graphiql-container .search-box input {\n  background: #1E2127;\n  padding-left: 28px;\n}\n\n.graphiql-container .search-box:before {\n  color: #c1c4ca;\n  font-size: 21px;\n  left: 8px;\n}\n\n.graphiql-container, .graphiql-container button, .graphiql-container input {\n  color: #9299A7;\n}\n\n.CodeMirror-gutters {\n  border: none !important;\n  background-color: #282d33;\n}\n\n.CodeMirror .CodeMirror-cursor {\n    border-left: 1px solid #999;\n}\n\n.graphiql-container .execute-button {\n  background: #10131a;\n  border: 1px solid <?=($primaryColor ? $primaryColor : '#0e8fff')?>;\n  box-shadow: none !important;\n  fill: <?= $this->escape($primaryColor ? $primaryColor : '#0e8fff')?>;\n}\n\n.graphiql-container .history-contents p {\n  border: none;\n}\n\n.graphiql-container .historyPaneWrap {\n  background: #10131a;\n}\n\n.graphiql-container .execute-options > li.selected, .graphiql-container .toolbar-menu-items > li.hover, .graphiql-container .toolbar-menu-items > li:active, .graphiql-container .toolbar-menu-items > li:hover, .graphiql-container .toolbar-select-options > li.hover, .graphiql-container .toolbar-select-options > li:active, .graphiql-container .toolbar-select-options > li:hover, .graphiql-container .history-contents > p:hover, .graphiql-container .history-contents > p:active {\n  background: #383C41;\n}\n\n.graphiql-container .doc-category-title {\n  border-bottom: 1px solid #181a1f;\n  color: #cacdd3;\n}\n\n.graphiql-container .field-name {\n  color: #9CA3AC;\n}\n\n.graphiql-container .type-name {\n    color: #95be76;\n}\n\n\n.cm-property {\n  color: #A5ACB8;\n}\n\n.cm-string {\n  color: #97BE7B;\n}\n\n.cm-variable {\n    color: #a87f5b;\n}\n\n.cm-attribute {\n  color: #B58860;\n}\n\n.cm-def {\n  color: #CC3932;\n}\n\n.cm-keyword {\n  color: #7cf3ff;\n}\n\n.graphiql-container .keyword {\n    color: #9ea5b0;\n}\n\n.graphiql-container .arg-name {\n    color: #b5875d;\n}\n\n.graphiql-container .doc-category-item {\n    color: #BC6069;\n}\n\na {\n  color: #7b9ad4;\n}\n\n#apiKey {\n  position: absolute;\n  z-index: 2;\n  top: 12px;\n  left: 440px;\n  border: none;\n  padding: 5px;\n  border-radius: 2px;\n  background: #2c313e;\n  color: #ccc;\n}\n</style>\n</body>\n</html>\n", "<!doctype html>\n<html>\n<head>\n    <title>REST - Api</title>\n</head>\n<body>\n    <rapi-doc\n        spec-url=\"<?=$this->escape($openApiUrl)?>\"\n        show-header=\"false\"\n        show-info=\"false\"\n        render-style=\"read\"\n        load-fonts=\"false\"\n\n        <?php if($apiKey): ?>\n        api-key-name = \"api-key\"\n        api-key-location = \"header\"\n        api-key-value = \"<?=$this->escape($apiKey)?>\"\n        <?php endif ?>\n\n        bg-color=\"<?=$this->escape($bgColor ? $bgColor : '#10131a')?>\"\n        text-color=\"<?= $this->escape($textColor ? $textColor : '#fafafa')?>\"\n        primary-color=\"<?= $this->escape($primaryColor ? $primaryColor : '#0e8fff')?>\"\n    ></rapi-doc>\n\n    <script type=\"module\" src=\"<?=$this->base('system:assets/vendor/rapidoc.js')?>\"></script>\n</body>\n</html>\n"], "filenames": ["CHANGELOG.md", "modules/System/views/api/graphql-viewer.php", "modules/System/views/api/rest-api-viewer.php"], "buggy_code_start_loc": [5, 115, 8], "buggy_code_end_loc": [5, 227, 23], "fixing_code_start_loc": [6, 115, 8], "fixing_code_end_loc": [7, 227, 23], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Reflected in GitHub repository cockpit-hq/cockpit prior to 2.6.4.", "other": {"cve": {"id": "CVE-2023-4432", "sourceIdentifier": "security@huntr.dev", "published": "2023-08-19T01:15:09.290", "lastModified": "2023-08-23T16:58:29.763", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Reflected in GitHub repository cockpit-hq/cockpit prior to 2.6.4."}, {"lang": "es", "value": "Vulnerabilidad de Cross-Site Scripting (XSS) reflejado en el repositorio de GitHub cockpit-hq/cockpit anterior a 2.6.4. "}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "LOW", "baseScore": 8.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.5}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:agentejo:cockpit:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.6.3", "matchCriteriaId": "DB13440F-5FAF-437B-A4EF-47CA96DB8FC4"}]}]}], "references": [{"url": "https://github.com/cockpit-hq/cockpit/commit/2a93d391fbd2dd9e730f65d43b29beb65903d195", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.dev/bounties/69684663-6822-41ff-aa05-afbdb8f5268f", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/cockpit-hq/cockpit/commit/2a93d391fbd2dd9e730f65d43b29beb65903d195"}}