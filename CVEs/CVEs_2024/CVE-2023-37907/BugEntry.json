{"buggy_code": ["<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<Wix xmlns=\"http://schemas.microsoft.com/wix/2006/wi\"\n     xmlns:util=\"http://schemas.microsoft.com/wix/UtilExtension\">\n\n  <?ifdef JpIsSystemWide ?>\n    <?define JpInstallScope=\"perMachine\"?>\n  <?else?>\n    <?define JpInstallScope=\"perUser\"?>\n  <?endif?>\n\n  <?define JpProductLanguage=1033 ?>\n  <?define JpInstallerVersion=200 ?>\n  <?define JpCompressedMsi=yes ?>\n\n  <?ifdef JpAllowUpgrades ?>\n    <?define JpUpgradeVersionOnlyDetectUpgrade=\"no\"?>\n  <?else?>\n    <?define JpUpgradeVersionOnlyDetectUpgrade=\"yes\"?>\n  <?endif?>\n  <?ifdef JpAllowDowngrades ?>\n    <?define JpUpgradeVersionOnlyDetectDowngrade=\"no\"?>\n  <?else?>\n    <?define JpUpgradeVersionOnlyDetectDowngrade=\"yes\"?>\n  <?endif?>\n\n  <!-- Cryptomator defaults -->\n  <?define IconFileEncryptedData= \"Cryptomator-Vault.ico\" ?>\n  <?define ProgIdContentType= \"application/vnd.cryptomator.encrypted\" ?>\n  <?define CloseApplicationTarget= \"cryptomator.exe\" ?>\n\n  <?include $(var.JpConfigDir)/overrides.wxi ?>\n\n  <Product\n    Id=\"$(var.JpProductCode)\"\n    Name=\"$(var.JpAppName)\"\n    Language=\"$(var.JpProductLanguage)\"\n    Version=\"$(var.JpAppVersion)\"\n    Manufacturer=\"$(var.JpAppVendor)\"\n    UpgradeCode=\"$(var.JpProductUpgradeCode)\">\n\n    <Package\n      Description=\"$(var.JpAppDescription)\"\n      Manufacturer=\"$(var.JpAppVendor)\"\n      InstallerVersion=\"$(var.JpInstallerVersion)\"\n      Compressed=\"$(var.JpCompressedMsi)\"\n      InstallScope=\"$(var.JpInstallScope)\" Platform=\"x64\"\n    />\n\n    <Media Id=\"1\" Cabinet=\"Data.cab\" EmbedCab=\"yes\" />\n\n    <Upgrade Id=\"$(var.JpProductUpgradeCode)\">\n      <UpgradeVersion\n        OnlyDetect=\"$(var.JpUpgradeVersionOnlyDetectUpgrade)\"\n        Property=\"JP_UPGRADABLE_FOUND\"\n        Maximum=\"$(var.JpAppVersion)\"\n        MigrateFeatures=\"yes\"\n        IncludeMaximum=\"yes\" />  <!-- TODO: check if this needs to be set to yes-->\n      <UpgradeVersion\n        OnlyDetect=\"$(var.JpUpgradeVersionOnlyDetectDowngrade)\"\n        Property=\"JP_DOWNGRADABLE_FOUND\"\n        Minimum=\"$(var.JpAppVersion)\"\n        MigrateFeatures=\"yes\"\n        IncludeMinimum=\"$(var.JpUpgradeVersionOnlyDetectDowngrade)\" />\n    </Upgrade>\n\n    <?ifndef JpAllowUpgrades ?>\n    <CustomAction Id=\"JpDisallowUpgrade\" Error=\"!(loc.DisallowUpgradeErrorMessage)\" />\n    <?endif?>\n    <?ifndef JpAllowDowngrades ?>\n    <CustomAction Id=\"JpDisallowDowngrade\" Error=\"!(loc.DowngradeErrorMessage)\" />\n    <?endif?>\n\n    <Binary Id=\"JpCaDll\" SourceFile=\"wixhelper.dll\"/>\n    <CustomAction Id=\"JpFindRelatedProducts\" BinaryKey=\"JpCaDll\" DllEntry=\"FindRelatedProductsEx\" />\n\n    <?ifndef SkipCryptomatorLegacyCheck ?>\n      <!-- Block installation if innosetup entry of Cryptomator is found -->\n      <Property Id=\"OLDEXEINSTALLER\">\n        <RegistrySearch Id=\"InnoSetupInstallation\" Root=\"HKLM\" Key=\"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Cryptomator_is1\" Type=\"raw\" Name=\"DisplayName\" />\n      </Property>\n      <!-- TODO: localize -->\n      <Condition Message=\"A lower version of [ProductName] is already installed. Uninstall it first and then start the setup again. Setup will now exit.\">\n          <![CDATA[Installed OR NOT OLDEXEINSTALLER]]>\n      </Condition>\n    <?endif?>\n    <!-- Cryptomator uses UNIX Sockets, which are supported starting with Windows 10 v1803-->\n    <Property Id=\"WINDOWSBUILDNUMBER\" Secure=\"yes\">\n      <RegistrySearch Id=\"BuildNumberSearch\" Root=\"HKLM\" Key=\"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" Name=\"CurrentBuildNumber\" Type=\"raw\" />\n    </Property>\n    <Condition Message=\"This application requires Windows 10 version 1803 (build 17134) or newer.\">\n      <![CDATA[Installed OR (WINDOWSBUILDNUMBER >= 17134)]]>\n    </Condition>\n\n    <!-- Non-Opening ProgID -->\n    <DirectoryRef Id=\"INSTALLDIR\">\n        <Component Win64=\"yes\" Id=\"nonStartingProgID\" >\n          <File Id=\"IconFileForEncryptedData\" KeyPath=\"yes\" Source=\"$(env.JP_WIXWIZARD_RESOURCES)\\$(var.IconFileEncryptedData)\" Name=\"$(var.IconFileEncryptedData)\"></File>\n          <ProgId Id=\"$(var.JpAppName).Encrypted.1\" Description=\"$(var.JpAppName) Encrypted Data\" Icon=\"IconFileForEncryptedData\" IconIndex=\"0\">\n            <Extension Id=\"c9r\" Advertise=\"no\" ContentType=\"$(var.ProgIdContentType)\">\n              <MIME ContentType=\"$(var.ProgIdContentType)\" Default=\"yes\"></MIME>\n            </Extension>\n            <Extension Id=\"c9s\" Advertise=\"no\" ContentType=\"$(var.ProgIdContentType)\"/>\n          </ProgId>\n        </Component>\n    </DirectoryRef>\n\n    <!-- Standard required root -->\n    <Directory Id=\"TARGETDIR\" Name=\"SourceDir\"/>\n\n    <Feature Id=\"DefaultFeature\" Title=\"!(loc.MainFeatureTitle)\" Level=\"1\">\n      <ComponentGroupRef Id=\"Shortcuts\"/>\n      <ComponentGroupRef Id=\"Files\"/>\n      <ComponentGroupRef Id=\"FileAssociations\"/>\n      <!-- Ref to additional ProgIDs -->\n      <ComponentRef Id=\"nonStartingProgID\" />\n    </Feature>\n\n    <CustomAction Id=\"JpSetARPINSTALLLOCATION\" Property=\"ARPINSTALLLOCATION\" Value=\"[INSTALLDIR]\" />\n    <CustomAction Id=\"JpSetARPCOMMENTS\" Property=\"ARPCOMMENTS\" Value=\"$(var.JpAppDescription)\" />\n    <CustomAction Id=\"JpSetARPCONTACT\" Property=\"ARPCONTACT\" Value=\"$(var.JpAppVendor)\" />\n    <CustomAction Id=\"JpSetARPSIZE\" Property=\"ARPSIZE\" Value=\"$(var.JpAppSizeKb)\" />\n\n    <?ifdef JpHelpURL ?>\n      <CustomAction Id=\"JpSetARPHELPLINK\" Property=\"ARPHELPLINK\" Value=\"$(var.JpHelpURL)\" />\n    <?endif?>\n\n    <?ifdef JpAboutURL ?>\n      <CustomAction Id=\"JpSetARPURLINFOABOUT\" Property=\"ARPURLINFOABOUT\" Value=\"$(var.JpAboutURL)\" />\n    <?endif?>\n\n    <?ifdef JpUpdateURL ?>\n      <CustomAction Id=\"JpSetARPURLUPDATEINFO\" Property=\"ARPURLUPDATEINFO\" Value=\"$(var.JpUpdateURL)\" />\n    <?endif?>\n\n    <!-- WebDAV patches -->\n    <CustomAction Id=\"PatchWebDAV\" Impersonate=\"no\" ExeCommand=\"[INSTALLDIR]patchWebDAV.bat\" Directory=\"INSTALLDIR\" Execute=\"deferred\" Return=\"asyncWait\" />\n\n    <!-- Special Settings migration for 1.7.0,. Should be removed eventually, for more info, see ../contrib/version170-migrate-settings.ps1-->\n    <CustomAction Id=\"V170MigrateSettings\" Impersonate=\"no\" ExeCommand=\"[INSTALLDIR]version170-migrate-settings.bat\" Directory=\"INSTALLDIR\" Execute=\"deferred\" Return=\"asyncWait\" />\n\n    <!-- Running App detection and exit -->\n    <Property Id=\"FOUNDRUNNINGAPP\" Admin=\"yes\"/>\n    <util:CloseApplication\n      Target=\"$(var.CloseApplicationTarget)\"\n      Id=\"Close$(var.JpAppName)\"\n      CloseMessage=\"no\"\n      RebootPrompt=\"no\"\n      PromptToContinue=\"yes\"\n      Description=\"A running instance of $(var.JpAppName) is found, using files marked for update. Please close it to continue.\"\n      Property=\"FOUNDRUNNINGAPP\"\n      >\n    </util:CloseApplication>\n    <CustomAction Id=\"FailOnRunningApp\" Error=\"Installation aborted, because files marked for update are used by a running instance of $(var.JpAppName).\"/>\n\n    <?ifdef JpIcon ?>\n    <Property Id=\"ARPPRODUCTICON\" Value=\"JpARPPRODUCTICON\"/>\n    <Icon Id=\"JpARPPRODUCTICON\" SourceFile=\"$(var.JpIcon)\"/>\n    <?endif?>\n\n    <UIRef Id=\"JpUI\"/>\n\n    <InstallExecuteSequence>\n      <Custom Action=\"JpSetARPINSTALLLOCATION\" After=\"CostFinalize\">Not Installed</Custom>\n      <Custom Action=\"JpSetARPCOMMENTS\" After=\"CostFinalize\">Not Installed</Custom>\n      <Custom Action=\"JpSetARPCONTACT\" After=\"CostFinalize\">Not Installed</Custom>\n      <Custom Action=\"JpSetARPSIZE\" After=\"CostFinalize\">Not Installed</Custom>\n      <?ifdef JpHelpURL ?>\n        <Custom Action=\"JpSetARPHELPLINK\" After=\"CostFinalize\">Not Installed</Custom>\n      <?endif?>\n      <?ifdef JpAboutURL ?>\n        <Custom Action=\"JpSetARPURLINFOABOUT\" After=\"CostFinalize\">Not Installed</Custom>\n      <?endif?>\n      <?ifdef JpUpdateURL ?>\n        <Custom Action=\"JpSetARPURLUPDATEINFO\" After=\"CostFinalize\">Not Installed</Custom>\n      <?endif?>\n\n      <?ifndef JpAllowUpgrades ?>\n      <Custom Action=\"JpDisallowUpgrade\" After=\"JpFindRelatedProducts\">JP_UPGRADABLE_FOUND</Custom>\n      <?endif?>\n      <?ifndef JpAllowDowngrades ?>\n      <Custom Action=\"JpDisallowDowngrade\" After=\"JpFindRelatedProducts\">JP_DOWNGRADABLE_FOUND</Custom>\n      <?endif?>\n      <Custom Action=\"JpFindRelatedProducts\" After=\"FindRelatedProducts\"/>\n\n      <!-- Check and fail if Cryptomator is running -->\n      <Custom Action=\"WixCloseApplications\" Before=\"InstallValidate\"></Custom>\n      <Custom Action=\"FailOnRunningApp\" After=\"WixCloseApplications\" >FOUNDRUNNINGAPP</Custom>\n\n      <RemoveExistingProducts After=\"InstallValidate\"/> <!-- Moved from CostInitialize, due to WixCloseApplications -->\n\n      <Custom Action=\"PatchWebDAV\" After=\"InstallFiles\">NOT Installed OR REINSTALL</Custom>\n      <Custom Action=\"V170MigrateSettings\" After=\"InstallFiles\">NOT Installed OR REINSTALL</Custom>\n    </InstallExecuteSequence>\n\n    <InstallUISequence>\n      <Custom Action=\"JpFindRelatedProducts\" After=\"FindRelatedProducts\"/>\n    </InstallUISequence>\n\n    <WixVariable Id=\"WixUIBannerBmp\" Value=\"$(env.JP_WIXWIZARD_RESOURCES)\\banner.bmp\" />\n    <WixVariable Id=\"WixUIDialogBmp\" Value=\"$(env.JP_WIXWIZARD_RESOURCES)\\background.bmp\" />\n  </Product>\n\n</Wix>\n"], "fixing_code": ["<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<Wix xmlns=\"http://schemas.microsoft.com/wix/2006/wi\"\n     xmlns:util=\"http://schemas.microsoft.com/wix/UtilExtension\">\n\n  <?ifdef JpIsSystemWide ?>\n    <?define JpInstallScope=\"perMachine\"?>\n  <?else?>\n    <?define JpInstallScope=\"perUser\"?>\n  <?endif?>\n\n  <?define JpProductLanguage=1033 ?>\n  <?define JpInstallerVersion=200 ?>\n  <?define JpCompressedMsi=yes ?>\n\n  <?ifdef JpAllowUpgrades ?>\n    <?define JpUpgradeVersionOnlyDetectUpgrade=\"no\"?>\n  <?else?>\n    <?define JpUpgradeVersionOnlyDetectUpgrade=\"yes\"?>\n  <?endif?>\n  <?ifdef JpAllowDowngrades ?>\n    <?define JpUpgradeVersionOnlyDetectDowngrade=\"no\"?>\n  <?else?>\n    <?define JpUpgradeVersionOnlyDetectDowngrade=\"yes\"?>\n  <?endif?>\n\n  <!-- Cryptomator defaults -->\n  <?define IconFileEncryptedData= \"Cryptomator-Vault.ico\" ?>\n  <?define ProgIdContentType= \"application/vnd.cryptomator.encrypted\" ?>\n  <?define CloseApplicationTarget= \"cryptomator.exe\" ?>\n\n  <?include $(var.JpConfigDir)/overrides.wxi ?>\n\n  <Product\n    Id=\"$(var.JpProductCode)\"\n    Name=\"$(var.JpAppName)\"\n    Language=\"$(var.JpProductLanguage)\"\n    Version=\"$(var.JpAppVersion)\"\n    Manufacturer=\"$(var.JpAppVendor)\"\n    UpgradeCode=\"$(var.JpProductUpgradeCode)\">\n\n    <Package\n      Description=\"$(var.JpAppDescription)\"\n      Manufacturer=\"$(var.JpAppVendor)\"\n      InstallerVersion=\"$(var.JpInstallerVersion)\"\n      Compressed=\"$(var.JpCompressedMsi)\"\n      InstallScope=\"$(var.JpInstallScope)\" Platform=\"x64\"\n    />\n\n    <Media Id=\"1\" Cabinet=\"Data.cab\" EmbedCab=\"yes\" />\n\n    <Upgrade Id=\"$(var.JpProductUpgradeCode)\">\n      <UpgradeVersion\n        OnlyDetect=\"$(var.JpUpgradeVersionOnlyDetectUpgrade)\"\n        Property=\"JP_UPGRADABLE_FOUND\"\n        Maximum=\"$(var.JpAppVersion)\"\n        MigrateFeatures=\"yes\"\n        IncludeMaximum=\"yes\" />  <!-- TODO: check if this needs to be set to yes-->\n      <UpgradeVersion\n        OnlyDetect=\"$(var.JpUpgradeVersionOnlyDetectDowngrade)\"\n        Property=\"JP_DOWNGRADABLE_FOUND\"\n        Minimum=\"$(var.JpAppVersion)\"\n        MigrateFeatures=\"yes\"\n        IncludeMinimum=\"$(var.JpUpgradeVersionOnlyDetectDowngrade)\" />\n    </Upgrade>\n\n    <?ifndef JpAllowUpgrades ?>\n    <CustomAction Id=\"JpDisallowUpgrade\" Error=\"!(loc.DisallowUpgradeErrorMessage)\" />\n    <?endif?>\n    <?ifndef JpAllowDowngrades ?>\n    <CustomAction Id=\"JpDisallowDowngrade\" Error=\"!(loc.DowngradeErrorMessage)\" />\n    <?endif?>\n\n    <Binary Id=\"JpCaDll\" SourceFile=\"wixhelper.dll\"/>\n    <CustomAction Id=\"JpFindRelatedProducts\" BinaryKey=\"JpCaDll\" DllEntry=\"FindRelatedProductsEx\" />\n\n    <?ifndef SkipCryptomatorLegacyCheck ?>\n      <!-- Block installation if innosetup entry of Cryptomator is found -->\n      <Property Id=\"OLDEXEINSTALLER\">\n        <RegistrySearch Id=\"InnoSetupInstallation\" Root=\"HKLM\" Key=\"Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Cryptomator_is1\" Type=\"raw\" Name=\"DisplayName\" />\n      </Property>\n      <!-- TODO: localize -->\n      <Condition Message=\"A lower version of [ProductName] is already installed. Uninstall it first and then start the setup again. Setup will now exit.\">\n          <![CDATA[Installed OR NOT OLDEXEINSTALLER]]>\n      </Condition>\n    <?endif?>\n    <!-- Cryptomator uses UNIX Sockets, which are supported starting with Windows 10 v1803-->\n    <Property Id=\"WINDOWSBUILDNUMBER\" Secure=\"yes\">\n      <RegistrySearch Id=\"BuildNumberSearch\" Root=\"HKLM\" Key=\"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\" Name=\"CurrentBuildNumber\" Type=\"raw\" />\n    </Property>\n    <Condition Message=\"This application requires Windows 10 version 1803 (build 17134) or newer.\">\n      <![CDATA[Installed OR (WINDOWSBUILDNUMBER >= 17134)]]>\n    </Condition>\n\n    <!-- Non-Opening ProgID -->\n    <DirectoryRef Id=\"INSTALLDIR\">\n        <Component Win64=\"yes\" Id=\"nonStartingProgID\" >\n          <File Id=\"IconFileForEncryptedData\" KeyPath=\"yes\" Source=\"$(env.JP_WIXWIZARD_RESOURCES)\\$(var.IconFileEncryptedData)\" Name=\"$(var.IconFileEncryptedData)\"></File>\n          <ProgId Id=\"$(var.JpAppName).Encrypted.1\" Description=\"$(var.JpAppName) Encrypted Data\" Icon=\"IconFileForEncryptedData\" IconIndex=\"0\">\n            <Extension Id=\"c9r\" Advertise=\"no\" ContentType=\"$(var.ProgIdContentType)\">\n              <MIME ContentType=\"$(var.ProgIdContentType)\" Default=\"yes\"></MIME>\n            </Extension>\n            <Extension Id=\"c9s\" Advertise=\"no\" ContentType=\"$(var.ProgIdContentType)\"/>\n          </ProgId>\n        </Component>\n    </DirectoryRef>\n\n    <!-- Standard required root -->\n    <Directory Id=\"TARGETDIR\" Name=\"SourceDir\"/>\n\n    <Feature Id=\"DefaultFeature\" Title=\"!(loc.MainFeatureTitle)\" Level=\"1\">\n      <ComponentGroupRef Id=\"Shortcuts\"/>\n      <ComponentGroupRef Id=\"Files\"/>\n      <ComponentGroupRef Id=\"FileAssociations\"/>\n      <!-- Ref to additional ProgIDs -->\n      <ComponentRef Id=\"nonStartingProgID\" />\n    </Feature>\n\n    <CustomAction Id=\"JpSetARPINSTALLLOCATION\" Property=\"ARPINSTALLLOCATION\" Value=\"[INSTALLDIR]\" />\n    <CustomAction Id=\"JpSetARPCOMMENTS\" Property=\"ARPCOMMENTS\" Value=\"$(var.JpAppDescription)\" />\n    <CustomAction Id=\"JpSetARPCONTACT\" Property=\"ARPCONTACT\" Value=\"$(var.JpAppVendor)\" />\n    <CustomAction Id=\"JpSetARPSIZE\" Property=\"ARPSIZE\" Value=\"$(var.JpAppSizeKb)\" />\n\n    <?ifdef JpHelpURL ?>\n      <CustomAction Id=\"JpSetARPHELPLINK\" Property=\"ARPHELPLINK\" Value=\"$(var.JpHelpURL)\" />\n    <?endif?>\n\n    <?ifdef JpAboutURL ?>\n      <CustomAction Id=\"JpSetARPURLINFOABOUT\" Property=\"ARPURLINFOABOUT\" Value=\"$(var.JpAboutURL)\" />\n    <?endif?>\n\n    <?ifdef JpUpdateURL ?>\n      <CustomAction Id=\"JpSetARPURLUPDATEINFO\" Property=\"ARPURLUPDATEINFO\" Value=\"$(var.JpUpdateURL)\" />\n    <?endif?>\n\n    <Property Id=\"WixQuietExec64CmdTimeout\" Value=\"20\" />\n    <!-- Note for custom actions: Immediate CAs run BEFORE the files are installed, hence if you depend on installed files, the CAs must be deferred.-->\n    <!-- WebDAV patches -->\n    <SetProperty Id=\"PatchWebDAV\" Value=\"&quot;[INSTALLDIR]patchWebDAV.bat&quot;\"\n            Sequence=\"execute\" Before=\"PatchWebDAV\" />\n    <CustomAction Id=\"PatchWebDAV\" BinaryKey=\"WixCA\" DllEntry=\"WixQuietExec64\" Execute=\"deferred\" Return=\"ignore\" Impersonate=\"no\"/>\n\n    <!-- Special Settings migration for 1.7.0,. Should be removed eventually, for more info, see ../contrib/version170-migrate-settings.ps1-->\n    <SetProperty Id=\"V170MigrateSettings\" Value=\"&quot;[INSTALLDIR]version170-migrate-settings.bat&quot;\"\n            Sequence=\"execute\" Before=\"V170MigrateSettings\" />\n    <CustomAction Id=\"V170MigrateSettings\" BinaryKey=\"WixCA\" DllEntry=\"WixQuietExec64\" Execute=\"deferred\" Return=\"ignore\" Impersonate=\"no\"/>\n\n    <!-- Running App detection and exit -->\n    <Property Id=\"FOUNDRUNNINGAPP\" Admin=\"yes\"/>\n    <util:CloseApplication\n      Target=\"$(var.CloseApplicationTarget)\"\n      Id=\"Close$(var.JpAppName)\"\n      CloseMessage=\"no\"\n      RebootPrompt=\"no\"\n      PromptToContinue=\"yes\"\n      Description=\"A running instance of $(var.JpAppName) is found, using files marked for update. Please close it to continue.\"\n      Property=\"FOUNDRUNNINGAPP\"\n      >\n    </util:CloseApplication>\n    <CustomAction Id=\"FailOnRunningApp\" Error=\"Installation aborted, because files marked for update are used by a running instance of $(var.JpAppName).\"/>\n\n    <?ifdef JpIcon ?>\n    <Property Id=\"ARPPRODUCTICON\" Value=\"JpARPPRODUCTICON\"/>\n    <Icon Id=\"JpARPPRODUCTICON\" SourceFile=\"$(var.JpIcon)\"/>\n    <?endif?>\n\n    <UIRef Id=\"JpUI\"/>\n\n    <InstallExecuteSequence>\n      <Custom Action=\"JpSetARPINSTALLLOCATION\" After=\"CostFinalize\">Not Installed</Custom>\n      <Custom Action=\"JpSetARPCOMMENTS\" After=\"CostFinalize\">Not Installed</Custom>\n      <Custom Action=\"JpSetARPCONTACT\" After=\"CostFinalize\">Not Installed</Custom>\n      <Custom Action=\"JpSetARPSIZE\" After=\"CostFinalize\">Not Installed</Custom>\n      <?ifdef JpHelpURL ?>\n        <Custom Action=\"JpSetARPHELPLINK\" After=\"CostFinalize\">Not Installed</Custom>\n      <?endif?>\n      <?ifdef JpAboutURL ?>\n        <Custom Action=\"JpSetARPURLINFOABOUT\" After=\"CostFinalize\">Not Installed</Custom>\n      <?endif?>\n      <?ifdef JpUpdateURL ?>\n        <Custom Action=\"JpSetARPURLUPDATEINFO\" After=\"CostFinalize\">Not Installed</Custom>\n      <?endif?>\n\n      <?ifndef JpAllowUpgrades ?>\n      <Custom Action=\"JpDisallowUpgrade\" After=\"JpFindRelatedProducts\">JP_UPGRADABLE_FOUND</Custom>\n      <?endif?>\n      <?ifndef JpAllowDowngrades ?>\n      <Custom Action=\"JpDisallowDowngrade\" After=\"JpFindRelatedProducts\">JP_DOWNGRADABLE_FOUND</Custom>\n      <?endif?>\n      <Custom Action=\"JpFindRelatedProducts\" After=\"FindRelatedProducts\"/>\n\n      <!-- Check and fail if Cryptomator is running -->\n      <Custom Action=\"WixCloseApplications\" Before=\"InstallValidate\"></Custom>\n      <Custom Action=\"FailOnRunningApp\" After=\"WixCloseApplications\" >FOUNDRUNNINGAPP</Custom>\n\n      <RemoveExistingProducts After=\"InstallValidate\"/> <!-- Moved from CostInitialize, due to WixCloseApplications -->\n\n      <Custom Action=\"PatchWebDAV\" After=\"InstallFiles\">NOT Installed OR REINSTALL</Custom>\n      <Custom Action=\"V170MigrateSettings\" After=\"InstallFiles\">NOT Installed OR REINSTALL</Custom>\n    </InstallExecuteSequence>\n\n    <InstallUISequence>\n      <Custom Action=\"JpFindRelatedProducts\" After=\"FindRelatedProducts\"/>\n    </InstallUISequence>\n\n    <WixVariable Id=\"WixUIBannerBmp\" Value=\"$(env.JP_WIXWIZARD_RESOURCES)\\banner.bmp\" />\n    <WixVariable Id=\"WixUIDialogBmp\" Value=\"$(env.JP_WIXWIZARD_RESOURCES)\\background.bmp\" />\n  </Product>\n\n</Wix>\n"], "filenames": ["dist/win/resources/main.wxs"], "buggy_code_start_loc": [134], "buggy_code_end_loc": [140], "fixing_code_start_loc": [135], "fixing_code_end_loc": [146], "type": "CWE-269", "message": "Cryptomator is data encryption software for users who store their files in the cloud. Prior to version 1.9.2, the MSI installer provided on the homepage allows local privilege escalation (LPE) for low privileged users, if already installed. The problem occurs as the repair function of the MSI spawns two administrative CMDs. A simple LPE is possible via a breakout. Version 1.9.2 fixes this issue.", "other": {"cve": {"id": "CVE-2023-37907", "sourceIdentifier": "security-advisories@github.com", "published": "2023-07-25T21:15:10.647", "lastModified": "2023-08-03T17:01:24.863", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cryptomator is data encryption software for users who store their files in the cloud. Prior to version 1.9.2, the MSI installer provided on the homepage allows local privilege escalation (LPE) for low privileged users, if already installed. The problem occurs as the repair function of the MSI spawns two administrative CMDs. A simple LPE is possible via a breakout. Version 1.9.2 fixes this issue."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.0, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.0, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-269"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:cryptomator:cryptomator:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.9.2", "matchCriteriaId": "A6EF2069-0E55-490C-B06D-DB5B9BC584D2"}]}]}], "references": [{"url": "https://github.com/cryptomator/cryptomator/commit/b48ebd524b1626bf12ac98e35a7670b868fa208c", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/cryptomator/cryptomator/releases/tag/1.9.2", "source": "security-advisories@github.com", "tags": ["Release Notes"]}, {"url": "https://github.com/cryptomator/cryptomator/security/advisories/GHSA-9c9p-c3mg-hpjq", "source": "security-advisories@github.com", "tags": ["Exploit", "Issue Tracking", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/cryptomator/cryptomator/commit/b48ebd524b1626bf12ac98e35a7670b868fa208c"}}