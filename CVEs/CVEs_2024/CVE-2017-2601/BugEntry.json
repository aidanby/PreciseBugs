{"buggy_code": ["/*\n * The MIT License\n * \n * Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts,\n *      Yahoo! Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\npackage hudson.model;\n\nimport hudson.EnvVars;\nimport hudson.Util;\nimport hudson.model.queue.SubTask;\nimport hudson.scm.SCM;\nimport hudson.tasks.BuildWrapper;\nimport hudson.tasks.Builder;\nimport hudson.util.VariableResolver;\n\nimport java.io.Serializable;\nimport java.util.Map;\n\nimport net.sf.json.JSONObject;\n\nimport org.kohsuke.stapler.StaplerRequest;\nimport org.kohsuke.stapler.export.Exported;\nimport org.kohsuke.stapler.export.ExportedBean;\n\n/**\n * A value for a parameter in a build.\n *\n * Created by {@link ParameterDefinition#createValue(StaplerRequest, JSONObject)} for\n * a particular build (although this 'owner' build object is passed in for every method\n * call as a parameter so that the parameter won't have to persist it.)\n *\n * <h2>Persistence</h2>\n * <p>\n * Instances of {@link ParameterValue}s are persisted into build's <tt>build.xml</tt>\n * through XStream (via {@link ParametersAction}), so instances need to be persistable.\n *\n * <h2>Associated Views</h2>\n * <h4>value.jelly</h4>\n * The <tt>value.jelly</tt> view contributes a UI fragment to display the parameter\n * values used for a build.\n *\n * <h2>Notes</h2>\n * <ol>\n * <li>{@link ParameterValue} is used to record values of the past build, but\n *     {@link ParameterDefinition} used back then might be gone already, or represent\n *     a different parameter now. So don't try to use the name to infer\n *     {@link ParameterDefinition} is.\n * </ol>\n * @see ParameterDefinition\n * @see ParametersAction\n */\n@ExportedBean(defaultVisibility=3)\npublic abstract class ParameterValue implements Serializable {\n    protected final String name;\n\n    private String description;\n\n    protected ParameterValue(String name, String description) {\n        this.name = name;\n        this.description = description;\n    }\n\n    protected ParameterValue(String name) {\n        this(name, null);\n    }\n\n    public String getDescription() {\n        return description;\n    }\n\n    public void setDescription(String description) {\n        this.description = description;\n    }\n\n    /**\n     * Name of the parameter.\n     *\n     * This uniquely distinguishes {@link ParameterValue} among other parameters\n     * for the same build. This must be the same as {@link ParameterDefinition#getName()}.\n     */\n    @Exported\n    public final String getName() {\n        return name;\n    }\n\n    /**\n     * Adds environmental variables for the builds to the given map.\n     *\n     * <p>\n     * This provides a means for a parameter to pass the parameter\n     * values to the build to be performed.\n     *\n     * <p>\n     * When this method is invoked, the map already contains the\n     * current \"planned export\" list. The implementation is\n     * expected to add more values to this map (or do nothing)\n     *\n     * <p>\n     * <strike>Environment variables should be by convention all upper case.\n     * (This is so that a Windows/Unix heterogeneous environment\n     * won't get inconsistent result depending on which platform to\n     * execute.)</strike> (see {@link EnvVars} why upper casing is a bad idea.)\n     *\n     * @param env\n     *      never null.\n     * @param build\n     *      The build for which this parameter is being used. Never null.\n     * @deprecated as of 1.344\n     *      Use {@link #buildEnvironment(Run, EnvVars)} instead.\n     */\n    @Deprecated\n    public void buildEnvVars(AbstractBuild<?,?> build, Map<String,String> env) {\n        if (env instanceof EnvVars) {\n            if (Util.isOverridden(ParameterValue.class, getClass(), \"buildEnvironment\", Run.class, EnvVars.class)) {\n                // if the subtype already derives buildEnvironment, then delegate to it\n                buildEnvironment(build, (EnvVars) env);\n            } else if (Util.isOverridden(ParameterValue.class, getClass(), \"buildEnvVars\", AbstractBuild.class, EnvVars.class)) {\n                buildEnvVars(build, (EnvVars) env);\n            }\n        }\n        // otherwise no-op by default\n    }\n\n    /** @deprecated Use {@link #buildEnvironment(Run, EnvVars)} instead. */\n    @Deprecated\n    public void buildEnvVars(AbstractBuild<?,?> build, EnvVars env) {\n        if (Util.isOverridden(ParameterValue.class, getClass(), \"buildEnvironment\", Run.class, EnvVars.class)) {\n            buildEnvironment(build, env);\n        } else {\n            // for backward compatibility\n            buildEnvVars(build,(Map<String,String>)env);\n        }\n    }\n\n    /**\n     * Adds environmental variables for the builds to the given map.\n     *\n     * <p>\n     * This provides a means for a parameter to pass the parameter\n     * values to the build to be performed.\n     *\n     * <p>\n     * When this method is invoked, the map already contains the\n     * current \"planned export\" list. The implementation is\n     * expected to add more values to this map (or do nothing)\n     *\n     * @param env\n     *      never null.\n     * @param build\n     *      The build for which this parameter is being used. Never null.\n     * @since 1.556\n     */\n    public void buildEnvironment(Run<?,?> build, EnvVars env) {\n        if (build instanceof AbstractBuild) {\n            buildEnvVars((AbstractBuild) build, env);\n        }\n        // else do not know how to do it\n    }\n\n    /**\n     * Called at the beginning of a build (but after {@link SCM} operations\n     * have taken place) to let a {@link ParameterValue} contributes a\n     * {@link BuildWrapper} to the build.\n     *\n     * <p>\n     * This provides a means for a parameter to perform more extensive\n     * set up / tear down during a build.\n     *\n     * @param build\n     *      The build for which this parameter is being used. Never null.\n     * @return\n     *      null if the parameter has no {@link BuildWrapper} to contribute to.\n     */\n    public BuildWrapper createBuildWrapper(AbstractBuild<?,?> build) {\n        return null;\n    }\n\n    /**\n     * Returns a {@link VariableResolver} so that other components like {@link Builder}s\n     * can perform variable substitution to reflect parameter values into the build process.\n     *\n     * <p.\n     * This is yet another means in which a {@link ParameterValue} can influence\n     * a build.\n     *\n     * @param build\n     *      The build for which this parameter is being used. Never null.\n     * @return\n     *      if the parameter value is not interested in participating to the\n     *      variable replacement process, return {@link VariableResolver#NONE}.\n     */\n    public VariableResolver<String> createVariableResolver(AbstractBuild<?,?> build) {\n        return VariableResolver.NONE;\n    }\n\n    // TODO should there be a Run overload of this?\n\n    /**\n     * Accessing {@link ParameterDefinition} is not a good idea.\n     *\n     * @deprecated since 2008-09-20.\n     *    parameter definition may change any time. So if you find yourself\n     *    in need of accessing the information from {@link ParameterDefinition},\n     *    instead copy them in {@link ParameterDefinition#createValue(StaplerRequest, JSONObject)}\n     *    into {@link ParameterValue}.\n     */\n    @Deprecated\n    public ParameterDefinition getDefinition() {\n        throw new UnsupportedOperationException();\n    }\n\n    @Override\n    public int hashCode() {\n        final int prime = 31;\n        int result = 1;\n        result = prime * result + ((name == null) ? 0 : name.hashCode());\n        return result;\n    }\n\n    @Override\n    public boolean equals(Object obj) {\n        if (this == obj)\n            return true;\n        if (obj == null)\n            return false;\n        if (getClass() != obj.getClass())\n            return false;\n        ParameterValue other = (ParameterValue) obj;\n        if (name == null) {\n            if (other.name != null)\n                return false;\n        } else if (!name.equals(other.name))\n            return false;\n        return true;\n    }\n\n    /**\n     * Computes a human-readable possible-localized one-line description of the parameter value.\n     *\n     * <P>\n     * This message is used as a tooltip to describe jobs in the queue. The text should be one line without\n     * new line. No HTML allowed (the caller will perform necessary HTML escapes, so any text can be returend.)\n     *\n     * @since 1.323\n     */\n    public String getShortDescription() {\n        return toString();\n    }\n\n    /**\n     * Returns whether the information contained in this ParameterValue is\n     * sensitive or security related. Used to determine whether the value\n     * provided by this object should be masked in output.\n     *\n     * <p>\n     * Subclasses can override this to control the return value.\n     *\n     * @since 1.378\n     */\n    public boolean isSensitive() {\n        return false;\n    }\n\n    /**\n     * Returns the most natural Java object that represents the actual value, like\n     * boolean, string, etc.\n     *\n     * If there's nothing that really fits the bill, the callee can return {@code this}.\n     * @since 1.568\n     */\n    public Object getValue() {\n        return null;\n    }\n\n    /**\n     * Controls where the build (that this parameter is submitted to) will happen.\n     *\n     * @return\n     *      null to run the build where it normally runs. If non-null, this will\n     *      override {@link AbstractProject#getAssignedLabel()}. If a build is\n     *      submitted with multiple parameters, the first one that returns non-null\n     *      from this method will win, and all others won't be consulted.\n     *\n     *\n     * @since 1.414\n     */\n    public Label getAssignedLabel(SubTask task) {\n        return null;\n    }\n}\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n\t\t<div name=\"parameter\">\n\t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n\t\t\t<f:checkbox name=\"value\" checked=\"${it.defaultValue}\" />\n\t\t</div>\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n\t<f:entry title=\"${it.name}\" description=\"${it.description}\">\n\t\t<f:checkbox name=\"value\" checked=\"${it.value}\" readonly=\"true\" />\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n\t\t<div name=\"parameter\">\n\t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n            <select name=\"value\">\n              <j:forEach var=\"value\" items=\"${it.choices}\">\n                <f:option selected=\"${it.defaultParameterValue.value==value}\">${value}</f:option>\n              </j:forEach>\n            </select>\n\t\t</div>\n\t</f:entry>\n</j:jelly>\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n\t\t<div name=\"parameter\">\n\t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n\t\t\t<input name=\"file\" type=\"file\" jsonAware=\"true\" />\n\t\t</div>\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n    <f:entry title=\"${it.name}\">\n        <j:if test=\"${it.originalFileName != null}\">\n            <j:invokeStatic var=\"encodedName\" className=\"hudson.Util\" method=\"rawEncode\">\n                <j:arg value=\"${it.name}\" />\n            </j:invokeStatic>\n            <j:set var=\"path\" value=\"parameter/${encodedName}/${it.originalFileName}\"/>\n            <a href=\"${path}\">${it.originalFileName}</a>\n            <st:nbsp/>\n            <a href=\"${path}?view\">${%view}</a>\n        </j:if>\n    </f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi,\nSeiji Sogabe, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n    xmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n    xmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n  <l:layout title=\"${it.displayName}\">\n    <j:invokeStatic var=\"currentThread\" className=\"java.lang.Thread\" method=\"currentThread\" />\n    <j:invoke var=\"buildClass\" on=\"${currentThread.contextClassLoader}\" method=\"loadClass\">\n      <j:arg value=\"hudson.model.Run\"/>\n    </j:invoke>\n    <j:set var=\"build\" value=\"${request.findAncestorObject(buildClass)}\" />\n\t\t<st:include page=\"sidepanel.jelly\" it=\"${build}\" />\n\t\t<l:main-panel>\n\t\t\t<h1>${%Build} ${build.displayName}</h1>\n\t\t\t<l:pane title=\"${%Parameters}\" width=\"3\">\n\t\t\t<j:forEach var=\"parameterValue\" items=\"${it.parameters}\">\n\t\t\t\t<st:include it=\"${parameterValue}\"\n\t\t\t\t\tpage=\"value.jelly\" />\n\t\t\t</j:forEach>\n\t\t\t</l:pane>\n\t\t</l:main-panel>\n  </l:layout>\n</j:jelly>\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2011, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts,\nRomain Seguy\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<!--\n  This view is rendered as /hudson/job/XYZ/build\n-->\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n  <!--\n    send back 4xx code so that machine agents don't confuse this form with successful build triggering\n    405 is \"Method Not Allowed\" and this fits here because we need POST.\n  -->\n  <st:statusCode value=\"405\" />\n  <l:layout title=\"${it.displayName}\" norefresh=\"true\">\n    <st:include page=\"sidepanel.jelly\" it=\"${it.job}\"/>\n    <l:main-panel>\n      <div class=\"behavior-loading\">${%LOADING}</div>\n      <h1>${it.job.pronoun} ${it.job.displayName}</h1>\n      <p>${%description}</p>\n      <j:set var=\"delay\" value=\"${request.getParameter('delay')}\" />\n      <f:form method=\"post\" action=\"build${empty(delay)?'':'?delay='+delay}\" name=\"parameters\"\n              tableClass=\"parameters\">\n        <j:forEach var=\"parameterDefinition\" items=\"${it.parameterDefinitions}\">\n          <tbody>\n            <st:include it=\"${parameterDefinition}\"\n                        page=\"${parameterDefinition.descriptor.valuePage}\" />\n          </tbody>\n        </j:forEach>\n        <f:block>\n          <!--\n            When used from the UI, use 303 redirect and send back to the job top page.\n            When neither of those options are given, we'll report \"201 Created\".\n\n            We can't use XHR for submitting this as there might be file parameters,\n            and submitting to IFRAME won't work either because 201 can't have HTML response.\n\n            So I think all we can do is this somewhat clunky workaround.\n           -->\n          <input type=\"hidden\" name=\"statusCode\" value=\"303\" />\n          <input type=\"hidden\" name=\"redirectTo\" value=\".\" />\n          <f:submit value=\"${%Build}\" />\n        </f:block>\n      </f:form>\n    </l:main-panel>\n  </l:layout>\n</j:jelly>\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n\t\t<div name=\"parameter\">\n\t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n\t\t\t<f:password name=\"value\" value=\"${it.defaultValueAsSecret}\" />\n\t\t</div>\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n\t<f:entry title=\"${it.name}\" description=\"${it.description}\">\n\t\t<f:password name=\"value\" value=\"********\" readonly=\"true\" />\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n\t\t<div name=\"parameter\">\n\t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n            <select name=\"runId\">\n              <j:forEach var=\"run\" items=\"${it.builds}\">\n                <option value=\"${run.externalizableId}\">${run.fullDisplayName}</option>\n              </j:forEach>\n            </select>\n\t\t</div>\n\t</f:entry>\n</j:jelly>\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n\t<f:entry title=\"${it.name}\" description=\"${it.description}\">\n\t\t<a href=\"${rootURL}/${it.run.url}\" class=\"model-link inside\">${it.run.fullDisplayName}</a>\n\t</f:entry>\n</j:jelly>\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n\t<f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n\t\t<div name=\"parameter\">\n\t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n\t\t\t<f:textbox name=\"value\" value=\"${it.defaultValue}\" />\n\t\t</div>\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n\t<f:entry title=\"${it.name}\" description=\"${it.description}\">\n\t\t<f:textbox name=\"value\" value=\"${it.value}\" readonly=\"true\" />\n\t</f:entry>\n</j:jelly>", "<?xml version=\"1.0\"?>\n<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\" xmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\" xmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n  <f:entry title=\"${it.name}\" description=\"${it.formattedDescription}\">\n    <div name=\"parameter\">\n      <input type=\"hidden\" name=\"name\" value=\"${it.name}\"/>\n      <f:textarea name=\"value\" value=\"${it.defaultValue}\"/>\n    </div>\n  </f:entry>\n</j:jelly>\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2012, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts, Rafa de la Torre\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n\t<f:entry title=\"${it.name}\" description=\"${it.description}\">\n\t\t<f:textarea name=\"value\" value=\"${it.value}\" readonly=\"readonly\" />\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\" xmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\">\n  <st:documentation>\n    An entry of the &lt;f:form>, which is one logical row (that consists of\n    several &lt;TR> tags.\n\n    One entry normally host one control.\n\n    <st:attribute name=\"title\">\n      Name of the entry. Think of this like a label for the control.\n    </st:attribute>\n    <st:attribute name=\"field\">\n      Used for the databinding. TBD. When this attribute\n      is specified, @help is inferred, and nested input controls don't need\n      the @field nor @name.\n    </st:attribute>\n    <st:attribute name=\"description\">\n      If it's not obvious to the user as to what the control expects,\n      specify some description text (which currently gets rendered as\n      small text under the control, but that may change.)\n\n      This text shouldn't get too long, and in recent Hudson, this feature\n      is somewhat de-emphasized, in favor of the inline foldable help page\n      specified via @help.\n    </st:attribute>\n    <st:attribute name=\"help\">\n      URL to the HTML page. When this attribute is specified, the entry gets\n      a (?) icon on the right, and if the user clicks it, the contents of the\n      given URL is rendered as a box below the entry.\n\n      The URL should return an HTML document wrapped in a &lt;div> tag.\n      The URL is interpreted to be rooted at the context path of Hudson,\n      so it's normally something like \"/plugin/foobar/help/abc.html\".\n    </st:attribute>\n  </st:documentation>\n  <j:if test=\"${attrs.help==null and attrs.field!=null}\">\n    <!-- infer the help page from the current descriptor and field if possible -->\n    <j:set target=\"${attrs}\" property=\"help\"\n           value=\"${descriptor.getHelpFile(attrs.field)}\" />\n  </j:if>\n  <!-- expose this so that we can look up the @field value later from prepareDatabinding.jelly -->\n  <j:set var=\"entry\" value=\"${attrs}\" />\n  <tr>\n    <td class=\"setting-leftspace\"><st:nbsp/></td>\n    <td class=\"setting-name\">\n      <j:out value=\"${attrs.title}\" />\n    </td>\n    <td class=\"setting-main\">\n      <d:invokeBody />\n    </td>\n    <f:helpLink url=\"${attrs.help}\" featureName=\"${title}\"/>\n  </tr>\n  <!-- used to display the form validation error -->\n  <tr class=\"validation-error-area\"><td colspan=\"2\" /><td /><td /></tr>\n  <j:if test=\"${!empty(attrs.description)}\">\n    <f:description>\n      <j:out value=\"${description}\"/>\n    </f:description>\n  </j:if>\n  <j:if test=\"${attrs.help!=null}\">\n    <f:helpArea />\n  </j:if>\n</j:jelly>\n", "package hudson.model;\n\nimport static org.junit.Assert.*;\n\nimport com.gargoylesoftware.htmlunit.html.DomNodeUtil;\nimport com.gargoylesoftware.htmlunit.html.HtmlFormUtil;\nimport org.junit.Rule;\nimport org.junit.Test;\n\nimport com.gargoylesoftware.htmlunit.html.HtmlPage;\nimport com.gargoylesoftware.htmlunit.html.HtmlForm;\nimport com.gargoylesoftware.htmlunit.html.HtmlElement;\nimport com.gargoylesoftware.htmlunit.html.HtmlTextInput;\nimport com.gargoylesoftware.htmlunit.html.HtmlCheckBoxInput;\nimport com.gargoylesoftware.htmlunit.html.HtmlOption;\nimport org.jvnet.hudson.test.CaptureEnvironmentBuilder;\nimport org.jvnet.hudson.test.Issue;\nimport org.jvnet.hudson.test.JenkinsRule;\nimport org.jvnet.hudson.test.JenkinsRule.WebClient;\n\nimport java.util.Set;\n\n/**\n * @author huybrechts\n */\npublic class ParametersTest {\n\n    @Rule\n    public JenkinsRule j = new JenkinsRule();\n\n    @Test\n    public void parameterTypes() throws Exception {\n        FreeStyleProject otherProject = j.createFreeStyleProject();\n        otherProject.scheduleBuild2(0).get();\n\n        FreeStyleProject project = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdp = new ParametersDefinitionProperty(\n                new StringParameterDefinition(\"string\", \"defaultValue\", \"string description\"),\n                new BooleanParameterDefinition(\"boolean\", true, \"boolean description\"),\n                new ChoiceParameterDefinition(\"choice\", \"Choice 1\\nChoice 2\", \"choice description\"),\n                new RunParameterDefinition(\"run\", otherProject.getName(), \"run description\", null));\n        project.addProperty(pdp);\n        CaptureEnvironmentBuilder builder = new CaptureEnvironmentBuilder();\n        project.getBuildersList().add(builder);\n\n        WebClient wc = j.createWebClient();\n        wc.getOptions().setThrowExceptionOnFailingStatusCode(false);\n        HtmlPage page = wc.goTo(\"job/\" + project.getName() + \"/build?delay=0sec\");\n\n        HtmlForm form = page.getFormByName(\"parameters\");\n\n        HtmlElement element = (HtmlElement) DomNodeUtil.selectSingleNode(form, \"//tr[td/div/input/@value='string']\");\n        assertNotNull(element);\n        assertEquals(\"string description\", ((HtmlElement) DomNodeUtil.selectSingleNode(element.getNextSibling().getNextSibling(), \"td[@class='setting-description']\")).getTextContent());\n\n        HtmlTextInput stringParameterInput = (HtmlTextInput) DomNodeUtil.selectSingleNode(element, \".//input[@name='value']\");\n        assertEquals(\"defaultValue\", stringParameterInput.getAttribute(\"value\"));\n        assertEquals(\"string\", ((HtmlElement) DomNodeUtil.selectSingleNode(element, \"td[@class='setting-name']\")).getTextContent());\n        stringParameterInput.setAttribute(\"value\", \"newValue\");\n\n        element = (HtmlElement) DomNodeUtil.selectSingleNode(form, \"//tr[td/div/input/@value='boolean']\");\n        assertNotNull(element);\n        assertEquals(\"boolean description\", ((HtmlElement) DomNodeUtil.selectSingleNode(element.getNextSibling().getNextSibling(), \"td[@class='setting-description']\")).getTextContent());\n        Object o = DomNodeUtil.selectSingleNode(element, \".//input[@name='value']\");\n        System.out.println(o);\n        HtmlCheckBoxInput booleanParameterInput = (HtmlCheckBoxInput) o;\n        assertEquals(true, booleanParameterInput.isChecked());\n        assertEquals(\"boolean\", ((HtmlElement) DomNodeUtil.selectSingleNode(element, \"td[@class='setting-name']\")).getTextContent());\n\n        element = (HtmlElement) DomNodeUtil.selectSingleNode(form, \".//tr[td/div/input/@value='choice']\");\n        assertNotNull(element);\n        assertEquals(\"choice description\", ((HtmlElement) DomNodeUtil.selectSingleNode(element.getNextSibling().getNextSibling(), \"td[@class='setting-description']\")).getTextContent());\n        assertEquals(\"choice\", ((HtmlElement) DomNodeUtil.selectSingleNode(element, \"td[@class='setting-name']\")).getTextContent());\n\n        element = (HtmlElement) DomNodeUtil.selectSingleNode(form, \".//tr[td/div/input/@value='run']\");\n        assertNotNull(element);\n        assertEquals(\"run description\", ((HtmlElement) DomNodeUtil.selectSingleNode(element.getNextSibling().getNextSibling(), \"td[@class='setting-description']\")).getTextContent());\n        assertEquals(\"run\", ((HtmlElement) DomNodeUtil.selectSingleNode(element, \"td[@class='setting-name']\")).getTextContent());\n\n        j.submit(form);\n        Queue.Item q = j.jenkins.getQueue().getItem(project);\n        if (q != null) q.getFuture().get();\n        else Thread.sleep(1000);\n\n        assertEquals(\"newValue\", builder.getEnvVars().get(\"STRING\"));\n        assertEquals(\"true\", builder.getEnvVars().get(\"BOOLEAN\"));\n        assertEquals(\"Choice 1\", builder.getEnvVars().get(\"CHOICE\"));\n        assertEquals(j.jenkins.getRootUrl() + otherProject.getLastBuild().getUrl(), builder.getEnvVars().get(\"RUN\"));\n    }\n\n    @Test\n    public void choiceWithLTGT() throws Exception {\n        FreeStyleProject project = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdp = new ParametersDefinitionProperty(\n                new ChoiceParameterDefinition(\"choice\", \"Choice 1\\nChoice <2>\", \"choice description\"));\n        project.addProperty(pdp);\n        CaptureEnvironmentBuilder builder = new CaptureEnvironmentBuilder();\n        project.getBuildersList().add(builder);\n\n        WebClient wc = j.createWebClient();\n        wc.getOptions().setThrowExceptionOnFailingStatusCode(false);\n        HtmlPage page = wc.goTo(\"job/\" + project.getName() + \"/build?delay=0sec\");\n        HtmlForm form = page.getFormByName(\"parameters\");\n\n        HtmlElement element = (HtmlElement) DomNodeUtil.selectSingleNode(form, \".//tr[td/div/input/@value='choice']\");\n        assertNotNull(element);\n        assertEquals(\"choice description\", ((HtmlElement) DomNodeUtil.selectSingleNode(element.getNextSibling().getNextSibling(), \"td[@class='setting-description']\")).getTextContent());\n        assertEquals(\"choice\", ((HtmlElement) DomNodeUtil.selectSingleNode(element, \"td[@class='setting-name']\")).getTextContent());\n        HtmlOption opt = (HtmlOption)DomNodeUtil.selectSingleNode(element, \"td/div/select/option[@value='Choice <2>']\");\n        assertNotNull(opt);\n        assertEquals(\"Choice <2>\", opt.asText());\n        opt.setSelected(true);\n\n        j.submit(form);\n        Queue.Item q = j.jenkins.getQueue().getItem(project);\n        if (q != null) q.getFuture().get();\n        else Thread.sleep(1000);\n\n        assertNotNull(builder.getEnvVars());\n        assertEquals(\"Choice <2>\", builder.getEnvVars().get(\"CHOICE\"));\n    }\n\n    @Test\n    public void sensitiveParameters() throws Exception {\n        FreeStyleProject project = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdb = new ParametersDefinitionProperty(\n                new PasswordParameterDefinition(\"password\", \"12345\", \"password description\"));\n        project.addProperty(pdb);\n\n        CaptureEnvironmentBuilder builder = new CaptureEnvironmentBuilder();\n        project.getBuildersList().add(builder);\n\n        FreeStyleBuild build = project.scheduleBuild2(0).get();\n        Set<String> sensitiveVars = build.getSensitiveBuildVariables();\n\n        assertNotNull(sensitiveVars);\n        assertTrue(sensitiveVars.contains(\"password\"));\n    }\n\n    @Test\n    public void nonSensitiveParameters() throws Exception {\n        FreeStyleProject project = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdb = new ParametersDefinitionProperty(\n                new StringParameterDefinition(\"string\", \"defaultValue\", \"string description\"));\n        project.addProperty(pdb);\n\n        CaptureEnvironmentBuilder builder = new CaptureEnvironmentBuilder();\n        project.getBuildersList().add(builder);\n\n        FreeStyleBuild build = project.scheduleBuild2(0).get();\n        Set<String> sensitiveVars = build.getSensitiveBuildVariables();\n\n        assertNotNull(sensitiveVars);\n        assertFalse(sensitiveVars.contains(\"string\"));\n    }\n\n    @Test\n    public void mixedSensitivity() throws Exception {\n        FreeStyleProject project = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdb = new ParametersDefinitionProperty(\n                new StringParameterDefinition(\"string\", \"defaultValue\", \"string description\"),\n                new PasswordParameterDefinition(\"password\", \"12345\", \"password description\"),\n                new StringParameterDefinition(\"string2\", \"Value2\", \"string description\")\n        );\n        project.addProperty(pdb);\n\n        CaptureEnvironmentBuilder builder = new CaptureEnvironmentBuilder();\n        project.getBuildersList().add(builder);\n\n        FreeStyleBuild build = project.scheduleBuild2(0).get();\n        Set<String> sensitiveVars = build.getSensitiveBuildVariables();\n\n        assertNotNull(sensitiveVars);\n        assertFalse(sensitiveVars.contains(\"string\"));\n        assertTrue(sensitiveVars.contains(\"password\"));\n        assertFalse(sensitiveVars.contains(\"string2\"));\n    }\n\n    @Test\n    @Issue(\"JENKINS-3539\")\n    public void fileParameterNotSet() throws Exception {\n        FreeStyleProject project = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdp = new ParametersDefinitionProperty(\n                new FileParameterDefinition(\"filename\", \"description\"));\n        project.addProperty(pdp);\n\n        WebClient wc = j.createWebClient();\n        wc.getOptions().setThrowExceptionOnFailingStatusCode(false);\n        HtmlPage page = wc.goTo(\"job/\" + project.getName() + \"/build?delay=0sec\");\n        HtmlForm form = page.getFormByName(\"parameters\");\n\n        j.submit(form);\n        Queue.Item q = j.jenkins.getQueue().getItem(project);\n        if (q != null) q.getFuture().get();\n        else Thread.sleep(1000);\n\n        assertFalse(\"file must not exist\", project.getSomeWorkspace().child(\"filename\").exists());\n    }\n\n    @Test\n    @Issue(\"JENKINS-11543\")\n    public void unicodeParametersArePresetCorrectly() throws Exception {\n        final FreeStyleProject p = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdb = new ParametersDefinitionProperty(\n                new StringParameterDefinition(\"sname:a\u00b6\u2031\ufef7\", \"svalue:a\u00b6\u2031\ufef7\", \"sdesc:a\u00b6\u2031\ufef7\"),\n                new FileParameterDefinition(\"fname:a\u00b6\u2031\ufef7\", \"fdesc:a\u00b6\u2031\ufef7\")\n        );\n        p.addProperty(pdb);\n\n        WebClient wc = j.createWebClient();\n        wc.getOptions().setThrowExceptionOnFailingStatusCode(false); // Ignore 405\n        HtmlPage page = wc.getPage(p, \"build\");\n\n        // java.lang.IllegalArgumentException: No such parameter definition: <gibberish>.\n        wc.getOptions().setThrowExceptionOnFailingStatusCode(true);\n        final HtmlForm form = page.getFormByName(\"parameters\");\n        HtmlFormUtil.submit(form, HtmlFormUtil.getButtonByCaption(form, \"Build\"));\n    }\n}\n"], "fixing_code": ["/*\n * The MIT License\n * \n * Copyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts,\n *      Yahoo! Inc.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\npackage hudson.model;\n\nimport hudson.EnvVars;\nimport hudson.Util;\nimport hudson.model.queue.SubTask;\nimport hudson.scm.SCM;\nimport hudson.tasks.BuildWrapper;\nimport hudson.tasks.Builder;\nimport hudson.util.VariableResolver;\nimport java.io.IOException;\n\nimport java.io.Serializable;\nimport java.util.Map;\nimport java.util.logging.Logger;\nimport jenkins.model.Jenkins;\n\nimport net.sf.json.JSONObject;\nimport org.kohsuke.accmod.Restricted;\nimport org.kohsuke.accmod.restrictions.DoNotUse;\n\nimport org.kohsuke.stapler.StaplerRequest;\nimport org.kohsuke.stapler.export.Exported;\nimport org.kohsuke.stapler.export.ExportedBean;\n\n/**\n * A value for a parameter in a build.\n *\n * Created by {@link ParameterDefinition#createValue(StaplerRequest, JSONObject)} for\n * a particular build (although this 'owner' build object is passed in for every method\n * call as a parameter so that the parameter won't have to persist it.)\n *\n * <h2>Persistence</h2>\n * <p>\n * Instances of {@link ParameterValue}s are persisted into build's <tt>build.xml</tt>\n * through XStream (via {@link ParametersAction}), so instances need to be persistable.\n *\n * <h2>Associated Views</h2>\n * <h4>value.jelly</h4>\n * The <tt>value.jelly</tt> view contributes a UI fragment to display the parameter\n * values used for a build.\n *\n * <h2>Notes</h2>\n * <ol>\n * <li>{@link ParameterValue} is used to record values of the past build, but\n *     {@link ParameterDefinition} used back then might be gone already, or represent\n *     a different parameter now. So don't try to use the name to infer\n *     {@link ParameterDefinition} is.\n * </ol>\n * @see ParameterDefinition\n * @see ParametersAction\n */\n@ExportedBean(defaultVisibility=3)\npublic abstract class ParameterValue implements Serializable {\n\n    private static final Logger LOGGER = Logger.getLogger(ParameterValue.class.getName());\n\n    protected final String name;\n\n    private String description;\n\n    protected ParameterValue(String name, String description) {\n        this.name = name;\n        this.description = description;\n    }\n\n    protected ParameterValue(String name) {\n        this(name, null);\n    }\n\n    public String getDescription() {\n        return description;\n    }\n\n    public void setDescription(String description) {\n        this.description = description;\n    }\n\n    @Restricted(DoNotUse.class) // for value.jelly\n    public String getFormattedDescription() {\n        try {\n            return Jenkins.getInstance().getMarkupFormatter().translate(description);\n        } catch (IOException e) {\n            LOGGER.warning(\"failed to translate description using configured markup formatter\");\n            return \"\";\n        }\n    }\n\n    /**\n     * Name of the parameter.\n     *\n     * This uniquely distinguishes {@link ParameterValue} among other parameters\n     * for the same build. This must be the same as {@link ParameterDefinition#getName()}.\n     */\n    @Exported\n    public final String getName() {\n        return name;\n    }\n\n    /**\n     * Adds environmental variables for the builds to the given map.\n     *\n     * <p>\n     * This provides a means for a parameter to pass the parameter\n     * values to the build to be performed.\n     *\n     * <p>\n     * When this method is invoked, the map already contains the\n     * current \"planned export\" list. The implementation is\n     * expected to add more values to this map (or do nothing)\n     *\n     * <p>\n     * <strike>Environment variables should be by convention all upper case.\n     * (This is so that a Windows/Unix heterogeneous environment\n     * won't get inconsistent result depending on which platform to\n     * execute.)</strike> (see {@link EnvVars} why upper casing is a bad idea.)\n     *\n     * @param env\n     *      never null.\n     * @param build\n     *      The build for which this parameter is being used. Never null.\n     * @deprecated as of 1.344\n     *      Use {@link #buildEnvironment(Run, EnvVars)} instead.\n     */\n    @Deprecated\n    public void buildEnvVars(AbstractBuild<?,?> build, Map<String,String> env) {\n        if (env instanceof EnvVars) {\n            if (Util.isOverridden(ParameterValue.class, getClass(), \"buildEnvironment\", Run.class, EnvVars.class)) {\n                // if the subtype already derives buildEnvironment, then delegate to it\n                buildEnvironment(build, (EnvVars) env);\n            } else if (Util.isOverridden(ParameterValue.class, getClass(), \"buildEnvVars\", AbstractBuild.class, EnvVars.class)) {\n                buildEnvVars(build, (EnvVars) env);\n            }\n        }\n        // otherwise no-op by default\n    }\n\n    /** @deprecated Use {@link #buildEnvironment(Run, EnvVars)} instead. */\n    @Deprecated\n    public void buildEnvVars(AbstractBuild<?,?> build, EnvVars env) {\n        if (Util.isOverridden(ParameterValue.class, getClass(), \"buildEnvironment\", Run.class, EnvVars.class)) {\n            buildEnvironment(build, env);\n        } else {\n            // for backward compatibility\n            buildEnvVars(build,(Map<String,String>)env);\n        }\n    }\n\n    /**\n     * Adds environmental variables for the builds to the given map.\n     *\n     * <p>\n     * This provides a means for a parameter to pass the parameter\n     * values to the build to be performed.\n     *\n     * <p>\n     * When this method is invoked, the map already contains the\n     * current \"planned export\" list. The implementation is\n     * expected to add more values to this map (or do nothing)\n     *\n     * @param env\n     *      never null.\n     * @param build\n     *      The build for which this parameter is being used. Never null.\n     * @since 1.556\n     */\n    public void buildEnvironment(Run<?,?> build, EnvVars env) {\n        if (build instanceof AbstractBuild) {\n            buildEnvVars((AbstractBuild) build, env);\n        }\n        // else do not know how to do it\n    }\n\n    /**\n     * Called at the beginning of a build (but after {@link SCM} operations\n     * have taken place) to let a {@link ParameterValue} contributes a\n     * {@link BuildWrapper} to the build.\n     *\n     * <p>\n     * This provides a means for a parameter to perform more extensive\n     * set up / tear down during a build.\n     *\n     * @param build\n     *      The build for which this parameter is being used. Never null.\n     * @return\n     *      null if the parameter has no {@link BuildWrapper} to contribute to.\n     */\n    public BuildWrapper createBuildWrapper(AbstractBuild<?,?> build) {\n        return null;\n    }\n\n    /**\n     * Returns a {@link VariableResolver} so that other components like {@link Builder}s\n     * can perform variable substitution to reflect parameter values into the build process.\n     *\n     * <p.\n     * This is yet another means in which a {@link ParameterValue} can influence\n     * a build.\n     *\n     * @param build\n     *      The build for which this parameter is being used. Never null.\n     * @return\n     *      if the parameter value is not interested in participating to the\n     *      variable replacement process, return {@link VariableResolver#NONE}.\n     */\n    public VariableResolver<String> createVariableResolver(AbstractBuild<?,?> build) {\n        return VariableResolver.NONE;\n    }\n\n    // TODO should there be a Run overload of this?\n\n    /**\n     * Accessing {@link ParameterDefinition} is not a good idea.\n     *\n     * @deprecated since 2008-09-20.\n     *    parameter definition may change any time. So if you find yourself\n     *    in need of accessing the information from {@link ParameterDefinition},\n     *    instead copy them in {@link ParameterDefinition#createValue(StaplerRequest, JSONObject)}\n     *    into {@link ParameterValue}.\n     */\n    @Deprecated\n    public ParameterDefinition getDefinition() {\n        throw new UnsupportedOperationException();\n    }\n\n    @Override\n    public int hashCode() {\n        final int prime = 31;\n        int result = 1;\n        result = prime * result + ((name == null) ? 0 : name.hashCode());\n        return result;\n    }\n\n    @Override\n    public boolean equals(Object obj) {\n        if (this == obj)\n            return true;\n        if (obj == null)\n            return false;\n        if (getClass() != obj.getClass())\n            return false;\n        ParameterValue other = (ParameterValue) obj;\n        if (name == null) {\n            if (other.name != null)\n                return false;\n        } else if (!name.equals(other.name))\n            return false;\n        return true;\n    }\n\n    /**\n     * Computes a human-readable possible-localized one-line description of the parameter value.\n     *\n     * <P>\n     * This message is used as a tooltip to describe jobs in the queue. The text should be one line without\n     * new line. No HTML allowed (the caller will perform necessary HTML escapes, so any text can be returend.)\n     *\n     * @since 1.323\n     */\n    public String getShortDescription() {\n        return toString();\n    }\n\n    /**\n     * Returns whether the information contained in this ParameterValue is\n     * sensitive or security related. Used to determine whether the value\n     * provided by this object should be masked in output.\n     *\n     * <p>\n     * Subclasses can override this to control the return value.\n     *\n     * @since 1.378\n     */\n    public boolean isSensitive() {\n        return false;\n    }\n\n    /**\n     * Returns the most natural Java object that represents the actual value, like\n     * boolean, string, etc.\n     *\n     * If there's nothing that really fits the bill, the callee can return {@code this}.\n     * @since 1.568\n     */\n    public Object getValue() {\n        return null;\n    }\n\n    /**\n     * Controls where the build (that this parameter is submitted to) will happen.\n     *\n     * @return\n     *      null to run the build where it normally runs. If non-null, this will\n     *      override {@link AbstractProject#getAssignedLabel()}. If a build is\n     *      submitted with multiple parameters, the first one that returns non-null\n     *      from this method will win, and all others won't be consulted.\n     *\n     *\n     * @since 1.414\n     */\n    public Label getAssignedLabel(SubTask task) {\n        return null;\n    }\n}\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n\t\t<div name=\"parameter\">\n\t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n\t\t\t<f:checkbox name=\"value\" checked=\"${it.defaultValue}\" />\n\t\t</div>\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n\t\t<f:checkbox name=\"value\" checked=\"${it.value}\" readonly=\"true\" />\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n\t\t<div name=\"parameter\">\n\t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n            <select name=\"value\">\n              <j:forEach var=\"value\" items=\"${it.choices}\">\n                <f:option selected=\"${it.defaultParameterValue.value==value}\">${value}</f:option>\n              </j:forEach>\n            </select>\n\t\t</div>\n\t</f:entry>\n</j:jelly>\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n\t\t<div name=\"parameter\">\n\t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n\t\t\t<input name=\"file\" type=\"file\" jsonAware=\"true\" />\n\t\t</div>\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n        <j:if test=\"${it.originalFileName != null}\">\n            <j:invokeStatic var=\"encodedName\" className=\"hudson.Util\" method=\"rawEncode\">\n                <j:arg value=\"${it.name}\" />\n            </j:invokeStatic>\n            <j:set var=\"path\" value=\"parameter/${encodedName}/${it.originalFileName}\"/>\n            <a href=\"${path}\">${it.originalFileName}</a>\n            <st:nbsp/>\n            <a href=\"${path}?view\">${%view}</a>\n        </j:if>\n    </f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2010, Sun Microsystems, Inc., Kohsuke Kawaguchi,\nSeiji Sogabe, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n    xmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n    xmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n  <l:layout title=\"${it.displayName}\">\n    <j:invokeStatic var=\"currentThread\" className=\"java.lang.Thread\" method=\"currentThread\" />\n    <j:invoke var=\"buildClass\" on=\"${currentThread.contextClassLoader}\" method=\"loadClass\">\n      <j:arg value=\"hudson.model.Run\"/>\n    </j:invoke>\n    <j:set var=\"build\" value=\"${request.findAncestorObject(buildClass)}\" />\n\t\t<st:include page=\"sidepanel.jelly\" it=\"${build}\" />\n\t\t<l:main-panel>\n\t\t\t<h1>${%Build} ${build.displayName}</h1>\n\t\t\t<l:pane title=\"${%Parameters}\" width=\"3\">\n                        <j:set var=\"escapeEntryTitleAndDescription\" value=\"true\"/> <!-- SECURITY-353 defense unless overridden -->\n\t\t\t<j:forEach var=\"parameterValue\" items=\"${it.parameters}\">\n\t\t\t\t<st:include it=\"${parameterValue}\"\n\t\t\t\t\tpage=\"value.jelly\" />\n\t\t\t</j:forEach>\n\t\t\t</l:pane>\n\t\t</l:main-panel>\n  </l:layout>\n</j:jelly>\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2011, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts,\nRomain Seguy\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<!--\n  This view is rendered as /hudson/job/XYZ/build\n-->\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n  <!--\n    send back 4xx code so that machine agents don't confuse this form with successful build triggering\n    405 is \"Method Not Allowed\" and this fits here because we need POST.\n  -->\n  <st:statusCode value=\"405\" />\n  <l:layout title=\"${it.displayName}\" norefresh=\"true\">\n    <st:include page=\"sidepanel.jelly\" it=\"${it.job}\"/>\n    <l:main-panel>\n      <div class=\"behavior-loading\">${%LOADING}</div>\n      <h1>${it.job.pronoun} ${it.job.displayName}</h1>\n      <p>${%description}</p>\n      <j:set var=\"delay\" value=\"${request.getParameter('delay')}\" />\n      <f:form method=\"post\" action=\"build${empty(delay)?'':'?delay='+delay}\" name=\"parameters\"\n              tableClass=\"parameters\">\n        <j:forEach var=\"parameterDefinition\" items=\"${it.parameterDefinitions}\">\n          <j:set var=\"escapeEntryTitleAndDescription\" value=\"true\"/> <!-- SECURITY-353 defense unless overridden -->\n          <tbody>\n            <st:include it=\"${parameterDefinition}\"\n                        page=\"${parameterDefinition.descriptor.valuePage}\" />\n          </tbody>\n        </j:forEach>\n        <f:block>\n          <!--\n            When used from the UI, use 303 redirect and send back to the job top page.\n            When neither of those options are given, we'll report \"201 Created\".\n\n            We can't use XHR for submitting this as there might be file parameters,\n            and submitting to IFRAME won't work either because 201 can't have HTML response.\n\n            So I think all we can do is this somewhat clunky workaround.\n           -->\n          <input type=\"hidden\" name=\"statusCode\" value=\"303\" />\n          <input type=\"hidden\" name=\"redirectTo\" value=\".\" />\n          <f:submit value=\"${%Build}\" />\n        </f:block>\n      </f:form>\n    </l:main-panel>\n  </l:layout>\n</j:jelly>\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n\t\t<div name=\"parameter\">\n\t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n\t\t\t<f:password name=\"value\" value=\"${it.defaultValueAsSecret}\" />\n\t\t</div>\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n\t\t<f:password name=\"value\" value=\"********\" readonly=\"true\" />\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n\t\t<div name=\"parameter\">\n\t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n            <select name=\"runId\">\n              <j:forEach var=\"run\" items=\"${it.builds}\">\n                <option value=\"${run.externalizableId}\">${run.fullDisplayName}</option>\n              </j:forEach>\n            </select>\n\t\t</div>\n\t</f:entry>\n</j:jelly>\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n\t\t<a href=\"${rootURL}/${it.run.url}\" class=\"model-link inside\">${it.run.fullDisplayName}</a>\n\t</f:entry>\n</j:jelly>\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n\t\t<div name=\"parameter\">\n\t\t\t<input type=\"hidden\" name=\"name\" value=\"${it.name}\" />\n\t\t\t<f:textbox name=\"value\" value=\"${it.defaultValue}\" />\n\t\t</div>\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n\t\t<f:textbox name=\"value\" value=\"${it.value}\" readonly=\"true\" />\n\t</f:entry>\n</j:jelly>", "<?xml version=\"1.0\"?>\n<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\" xmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\" xmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n    <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n    <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n    <div name=\"parameter\">\n      <input type=\"hidden\" name=\"name\" value=\"${it.name}\"/>\n      <f:textarea name=\"value\" value=\"${it.defaultValue}\"/>\n    </div>\n  </f:entry>\n</j:jelly>\n", "<!--\nThe MIT License\n\nCopyright (c) 2004-2012, Sun Microsystems, Inc., Kohsuke Kawaguchi, Tom Huybrechts, Rafa de la Torre\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\"\n\txmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\"\n\txmlns:i=\"jelly:fmt\" xmlns:p=\"/lib/hudson/project\">\n        <j:set var=\"escapeEntryTitleAndDescription\" value=\"false\"/>\n        <f:entry title=\"${h.escape(it.name)}\" description=\"${it.formattedDescription}\">\n\t\t<f:textarea name=\"value\" value=\"${it.value}\" readonly=\"readonly\" />\n\t</f:entry>\n</j:jelly>", "<!--\nThe MIT License\n\nCopyright (c) 2004-2009, Sun Microsystems, Inc., Kohsuke Kawaguchi\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n-->\n\n<?jelly escape-by-default='true'?>\n<j:jelly xmlns:j=\"jelly:core\" xmlns:st=\"jelly:stapler\" xmlns:d=\"jelly:define\" xmlns:l=\"/lib/layout\" xmlns:t=\"/lib/hudson\" xmlns:f=\"/lib/form\">\n  <st:documentation>\n    An entry of the &lt;f:form>, which is one logical row (that consists of\n    several &lt;TR> tags.\n\n    One entry normally host one control.\n\n    <st:attribute name=\"title\">\n      Name of the entry. Think of this like a label for the control.\n\n      This content is HTML (unless the boolean variable escapeEntryTitleAndDescription is set). Use h.escape if necessary.\n    </st:attribute>\n    <st:attribute name=\"field\">\n      Used for the databinding. TBD. When this attribute\n      is specified, @help is inferred, and nested input controls don't need\n      the @field nor @name.\n    </st:attribute>\n    <st:attribute name=\"description\">\n      If it's not obvious to the user as to what the control expects,\n      specify some description text (which currently gets rendered as\n      small text under the control, but that may change.)\n\n      This text shouldn't get too long, and in recent Hudson, this feature\n      is somewhat de-emphasized, in favor of the inline foldable help page\n      specified via @help.\n\n      This content is HTML (unless the boolean variable escapeEntryTitleAndDescription is set). Use h.escape if necessary.\n    </st:attribute>\n    <st:attribute name=\"help\">\n      URL to the HTML page. When this attribute is specified, the entry gets\n      a (?) icon on the right, and if the user clicks it, the contents of the\n      given URL is rendered as a box below the entry.\n\n      The URL should return an HTML document wrapped in a &lt;div> tag.\n      The URL is interpreted to be rooted at the context path of Hudson,\n      so it's normally something like \"/plugin/foobar/help/abc.html\".\n    </st:attribute>\n  </st:documentation>\n  <j:if test=\"${attrs.help==null and attrs.field!=null}\">\n    <!-- infer the help page from the current descriptor and field if possible -->\n    <j:set target=\"${attrs}\" property=\"help\"\n           value=\"${descriptor.getHelpFile(attrs.field)}\" />\n  </j:if>\n  <!-- expose this so that we can look up the @field value later from prepareDatabinding.jelly -->\n  <j:set var=\"entry\" value=\"${attrs}\" />\n  <tr>\n    <td class=\"setting-leftspace\"><st:nbsp/></td>\n    <td class=\"setting-name\">\n      <j:out value=\"${escapeEntryTitleAndDescription ? h.escape(attrs.title) : attrs.title}\" />\n    </td>\n    <td class=\"setting-main\">\n      <d:invokeBody />\n    </td>\n    <f:helpLink url=\"${attrs.help}\" featureName=\"${title}\"/>\n  </tr>\n  <!-- used to display the form validation error -->\n  <tr class=\"validation-error-area\"><td colspan=\"2\" /><td /><td /></tr>\n  <j:if test=\"${!empty(attrs.description)}\">\n    <f:description>\n      <j:out value=\"${escapeEntryTitleAndDescription ? h.escape(attrs.description) : attrs.description}\"/>\n    </f:description>\n  </j:if>\n  <j:if test=\"${attrs.help!=null}\">\n    <f:helpArea />\n  </j:if>\n</j:jelly>\n", "package hudson.model;\n\nimport com.gargoylesoftware.htmlunit.html.DomNodeUtil;\nimport com.gargoylesoftware.htmlunit.html.HtmlCheckBoxInput;\nimport com.gargoylesoftware.htmlunit.html.HtmlElement;\nimport com.gargoylesoftware.htmlunit.html.HtmlForm;\nimport com.gargoylesoftware.htmlunit.html.HtmlFormUtil;\nimport com.gargoylesoftware.htmlunit.html.HtmlOption;\nimport com.gargoylesoftware.htmlunit.html.HtmlPage;\nimport com.gargoylesoftware.htmlunit.html.HtmlTextInput;\nimport hudson.markup.MarkupFormatter;\nimport java.io.IOException;\nimport java.io.Writer;\nimport java.util.Set;\nimport java.util.regex.Matcher;\nimport java.util.regex.Pattern;\nimport org.apache.http.HttpStatus;\nimport static org.hamcrest.Matchers.*;\nimport static org.junit.Assert.*;\nimport org.junit.Rule;\nimport org.junit.Test;\nimport org.junit.rules.ErrorCollector;\nimport org.jvnet.hudson.test.CaptureEnvironmentBuilder;\nimport org.jvnet.hudson.test.Issue;\nimport org.jvnet.hudson.test.JenkinsRule;\nimport org.jvnet.hudson.test.JenkinsRule.WebClient;\n\n/**\n * @author huybrechts\n */\npublic class ParametersTest {\n\n    @Rule\n    public JenkinsRule j = new JenkinsRule();\n\n    @Rule\n    public ErrorCollector collector = new ErrorCollector();\n\n    @Test\n    public void parameterTypes() throws Exception {\n        FreeStyleProject otherProject = j.createFreeStyleProject();\n        otherProject.scheduleBuild2(0).get();\n\n        FreeStyleProject project = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdp = new ParametersDefinitionProperty(\n                new StringParameterDefinition(\"string\", \"defaultValue\", \"string description\"),\n                new BooleanParameterDefinition(\"boolean\", true, \"boolean description\"),\n                new ChoiceParameterDefinition(\"choice\", \"Choice 1\\nChoice 2\", \"choice description\"),\n                new RunParameterDefinition(\"run\", otherProject.getName(), \"run description\", null));\n        project.addProperty(pdp);\n        CaptureEnvironmentBuilder builder = new CaptureEnvironmentBuilder();\n        project.getBuildersList().add(builder);\n\n        WebClient wc = j.createWebClient();\n        wc.getOptions().setThrowExceptionOnFailingStatusCode(false);\n        HtmlPage page = wc.goTo(\"job/\" + project.getName() + \"/build?delay=0sec\");\n\n        HtmlForm form = page.getFormByName(\"parameters\");\n\n        HtmlElement element = (HtmlElement) DomNodeUtil.selectSingleNode(form, \"//tr[td/div/input/@value='string']\");\n        assertNotNull(element);\n        assertEquals(\"string description\", ((HtmlElement) DomNodeUtil.selectSingleNode(element.getNextSibling().getNextSibling(), \"td[@class='setting-description']\")).getTextContent());\n\n        HtmlTextInput stringParameterInput = (HtmlTextInput) DomNodeUtil.selectSingleNode(element, \".//input[@name='value']\");\n        assertEquals(\"defaultValue\", stringParameterInput.getAttribute(\"value\"));\n        assertEquals(\"string\", ((HtmlElement) DomNodeUtil.selectSingleNode(element, \"td[@class='setting-name']\")).getTextContent());\n        stringParameterInput.setAttribute(\"value\", \"newValue\");\n\n        element = (HtmlElement) DomNodeUtil.selectSingleNode(form, \"//tr[td/div/input/@value='boolean']\");\n        assertNotNull(element);\n        assertEquals(\"boolean description\", ((HtmlElement) DomNodeUtil.selectSingleNode(element.getNextSibling().getNextSibling(), \"td[@class='setting-description']\")).getTextContent());\n        Object o = DomNodeUtil.selectSingleNode(element, \".//input[@name='value']\");\n        System.out.println(o);\n        HtmlCheckBoxInput booleanParameterInput = (HtmlCheckBoxInput) o;\n        assertEquals(true, booleanParameterInput.isChecked());\n        assertEquals(\"boolean\", ((HtmlElement) DomNodeUtil.selectSingleNode(element, \"td[@class='setting-name']\")).getTextContent());\n\n        element = (HtmlElement) DomNodeUtil.selectSingleNode(form, \".//tr[td/div/input/@value='choice']\");\n        assertNotNull(element);\n        assertEquals(\"choice description\", ((HtmlElement) DomNodeUtil.selectSingleNode(element.getNextSibling().getNextSibling(), \"td[@class='setting-description']\")).getTextContent());\n        assertEquals(\"choice\", ((HtmlElement) DomNodeUtil.selectSingleNode(element, \"td[@class='setting-name']\")).getTextContent());\n\n        element = (HtmlElement) DomNodeUtil.selectSingleNode(form, \".//tr[td/div/input/@value='run']\");\n        assertNotNull(element);\n        assertEquals(\"run description\", ((HtmlElement) DomNodeUtil.selectSingleNode(element.getNextSibling().getNextSibling(), \"td[@class='setting-description']\")).getTextContent());\n        assertEquals(\"run\", ((HtmlElement) DomNodeUtil.selectSingleNode(element, \"td[@class='setting-name']\")).getTextContent());\n\n        j.submit(form);\n        Queue.Item q = j.jenkins.getQueue().getItem(project);\n        if (q != null) q.getFuture().get();\n        else Thread.sleep(1000);\n\n        assertEquals(\"newValue\", builder.getEnvVars().get(\"STRING\"));\n        assertEquals(\"true\", builder.getEnvVars().get(\"BOOLEAN\"));\n        assertEquals(\"Choice 1\", builder.getEnvVars().get(\"CHOICE\"));\n        assertEquals(j.jenkins.getRootUrl() + otherProject.getLastBuild().getUrl(), builder.getEnvVars().get(\"RUN\"));\n    }\n\n    @Test\n    public void choiceWithLTGT() throws Exception {\n        FreeStyleProject project = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdp = new ParametersDefinitionProperty(\n                new ChoiceParameterDefinition(\"choice\", \"Choice 1\\nChoice <2>\", \"choice description\"));\n        project.addProperty(pdp);\n        CaptureEnvironmentBuilder builder = new CaptureEnvironmentBuilder();\n        project.getBuildersList().add(builder);\n\n        WebClient wc = j.createWebClient();\n        wc.getOptions().setThrowExceptionOnFailingStatusCode(false);\n        HtmlPage page = wc.goTo(\"job/\" + project.getName() + \"/build?delay=0sec\");\n        HtmlForm form = page.getFormByName(\"parameters\");\n\n        HtmlElement element = (HtmlElement) DomNodeUtil.selectSingleNode(form, \".//tr[td/div/input/@value='choice']\");\n        assertNotNull(element);\n        assertEquals(\"choice description\", ((HtmlElement) DomNodeUtil.selectSingleNode(element.getNextSibling().getNextSibling(), \"td[@class='setting-description']\")).getTextContent());\n        assertEquals(\"choice\", ((HtmlElement) DomNodeUtil.selectSingleNode(element, \"td[@class='setting-name']\")).getTextContent());\n        HtmlOption opt = (HtmlOption)DomNodeUtil.selectSingleNode(element, \"td/div/select/option[@value='Choice <2>']\");\n        assertNotNull(opt);\n        assertEquals(\"Choice <2>\", opt.asText());\n        opt.setSelected(true);\n\n        j.submit(form);\n        Queue.Item q = j.jenkins.getQueue().getItem(project);\n        if (q != null) q.getFuture().get();\n        else Thread.sleep(1000);\n\n        assertNotNull(builder.getEnvVars());\n        assertEquals(\"Choice <2>\", builder.getEnvVars().get(\"CHOICE\"));\n    }\n\n    @Test\n    public void sensitiveParameters() throws Exception {\n        FreeStyleProject project = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdb = new ParametersDefinitionProperty(\n                new PasswordParameterDefinition(\"password\", \"12345\", \"password description\"));\n        project.addProperty(pdb);\n\n        CaptureEnvironmentBuilder builder = new CaptureEnvironmentBuilder();\n        project.getBuildersList().add(builder);\n\n        FreeStyleBuild build = project.scheduleBuild2(0).get();\n        Set<String> sensitiveVars = build.getSensitiveBuildVariables();\n\n        assertNotNull(sensitiveVars);\n        assertTrue(sensitiveVars.contains(\"password\"));\n    }\n\n    @Test\n    public void nonSensitiveParameters() throws Exception {\n        FreeStyleProject project = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdb = new ParametersDefinitionProperty(\n                new StringParameterDefinition(\"string\", \"defaultValue\", \"string description\"));\n        project.addProperty(pdb);\n\n        CaptureEnvironmentBuilder builder = new CaptureEnvironmentBuilder();\n        project.getBuildersList().add(builder);\n\n        FreeStyleBuild build = project.scheduleBuild2(0).get();\n        Set<String> sensitiveVars = build.getSensitiveBuildVariables();\n\n        assertNotNull(sensitiveVars);\n        assertFalse(sensitiveVars.contains(\"string\"));\n    }\n\n    @Test\n    public void mixedSensitivity() throws Exception {\n        FreeStyleProject project = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdb = new ParametersDefinitionProperty(\n                new StringParameterDefinition(\"string\", \"defaultValue\", \"string description\"),\n                new PasswordParameterDefinition(\"password\", \"12345\", \"password description\"),\n                new StringParameterDefinition(\"string2\", \"Value2\", \"string description\")\n        );\n        project.addProperty(pdb);\n\n        CaptureEnvironmentBuilder builder = new CaptureEnvironmentBuilder();\n        project.getBuildersList().add(builder);\n\n        FreeStyleBuild build = project.scheduleBuild2(0).get();\n        Set<String> sensitiveVars = build.getSensitiveBuildVariables();\n\n        assertNotNull(sensitiveVars);\n        assertFalse(sensitiveVars.contains(\"string\"));\n        assertTrue(sensitiveVars.contains(\"password\"));\n        assertFalse(sensitiveVars.contains(\"string2\"));\n    }\n\n    @Test\n    @Issue(\"JENKINS-3539\")\n    public void fileParameterNotSet() throws Exception {\n        FreeStyleProject project = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdp = new ParametersDefinitionProperty(\n                new FileParameterDefinition(\"filename\", \"description\"));\n        project.addProperty(pdp);\n\n        WebClient wc = j.createWebClient();\n        wc.getOptions().setThrowExceptionOnFailingStatusCode(false);\n        HtmlPage page = wc.goTo(\"job/\" + project.getName() + \"/build?delay=0sec\");\n        HtmlForm form = page.getFormByName(\"parameters\");\n\n        j.submit(form);\n        Queue.Item q = j.jenkins.getQueue().getItem(project);\n        if (q != null) q.getFuture().get();\n        else Thread.sleep(1000);\n\n        assertFalse(\"file must not exist\", project.getSomeWorkspace().child(\"filename\").exists());\n    }\n\n    @Test\n    @Issue(\"JENKINS-11543\")\n    public void unicodeParametersArePresetCorrectly() throws Exception {\n        final FreeStyleProject p = j.createFreeStyleProject();\n        ParametersDefinitionProperty pdb = new ParametersDefinitionProperty(\n                new StringParameterDefinition(\"sname:a\u00b6\u2031\ufef7\", \"svalue:a\u00b6\u2031\ufef7\", \"sdesc:a\u00b6\u2031\ufef7\"),\n                new FileParameterDefinition(\"fname:a\u00b6\u2031\ufef7\", \"fdesc:a\u00b6\u2031\ufef7\")\n        );\n        p.addProperty(pdb);\n\n        WebClient wc = j.createWebClient();\n        wc.getOptions().setThrowExceptionOnFailingStatusCode(false); // Ignore 405\n        HtmlPage page = wc.getPage(p, \"build\");\n\n        // java.lang.IllegalArgumentException: No such parameter definition: <gibberish>.\n        wc.getOptions().setThrowExceptionOnFailingStatusCode(true);\n        final HtmlForm form = page.getFormByName(\"parameters\");\n        HtmlFormUtil.submit(form, HtmlFormUtil.getButtonByCaption(form, \"Build\"));\n    }\n\n    @Issue(\"SECURITY-353\")\n    @Test\n    public void xss() throws Exception {\n        j.jenkins.setMarkupFormatter(new MyMarkupFormatter());\n        FreeStyleProject p = j.createFreeStyleProject(\"p\");\n        StringParameterDefinition param = new StringParameterDefinition(\"<param name>\", \"<param default>\", \"<param description>\");\n        assertEquals(\"<b>[</b>param description<b>]</b>\", param.getFormattedDescription());\n        p.addProperty(new ParametersDefinitionProperty(param));\n        WebClient wc = j.createWebClient();\n        wc.getOptions().setThrowExceptionOnFailingStatusCode(false);\n        HtmlPage page = wc.getPage(p, \"build?delay=0sec\");\n        collector.checkThat(page.getWebResponse().getStatusCode(), is(HttpStatus.SC_METHOD_NOT_ALLOWED)); // 405 to dissuade scripts from thinking this triggered the build\n        String text = page.getWebResponse().getContentAsString();\n        collector.checkThat(\"build page should escape param name\", text, containsString(\"&lt;param name&gt;\"));\n        collector.checkThat(\"build page should not leave param name unescaped\", text, not(containsString(\"<param name>\")));\n        collector.checkThat(\"build page should escape param default\", text, containsString(\"&lt;param default&gt;\"));\n        collector.checkThat(\"build page should not leave param default unescaped\", text, not(containsString(\"<param default>\")));\n        collector.checkThat(\"build page should mark up param description\", text, containsString(\"<b>[</b>param description<b>]</b>\"));\n        collector.checkThat(\"build page should not leave param description unescaped\", text, not(containsString(\"<param description>\")));\n        HtmlForm form = page.getFormByName(\"parameters\");\n        HtmlTextInput value = form.getInputByValue(\"<param default>\");\n        value.setText(\"<param value>\");\n        j.submit(form);\n        j.waitUntilNoActivity();\n        FreeStyleBuild b = p.getBuildByNumber(1);\n        page = j.createWebClient().getPage(b, \"parameters/\");\n        text = page.getWebResponse().getContentAsString();\n        collector.checkThat(\"parameters page should escape param name\", text, containsString(\"&lt;param name&gt;\"));\n        collector.checkThat(\"parameters page should not leave param name unescaped\", text, not(containsString(\"<param name>\")));\n        collector.checkThat(\"parameters page should escape param value\", text, containsString(\"&lt;param value&gt;\"));\n        collector.checkThat(\"parameters page should not leave param value unescaped\", text, not(containsString(\"<param value>\")));\n        collector.checkThat(\"parameters page should mark up param description\", text, containsString(\"<b>[</b>param description<b>]</b>\"));\n        collector.checkThat(\"parameters page should not leave param description unescaped\", text, not(containsString(\"<param description>\")));\n    }\n    static class MyMarkupFormatter extends MarkupFormatter {\n        @Override\n        public void translate(String markup, Writer output) throws IOException {\n            Matcher m = Pattern.compile(\"[<>]\").matcher(markup);\n            StringBuffer buf = new StringBuffer();\n            while (m.find()) {\n                m.appendReplacement(buf, m.group().equals(\"<\") ? \"<b>[</b>\" : \"<b>]</b>\");\n            }\n            m.appendTail(buf);\n            output.write(buf.toString());\n        }\n    }\n\n}\n"], "filenames": ["core/src/main/java/hudson/model/ParameterValue.java", "core/src/main/resources/hudson/model/BooleanParameterDefinition/index.jelly", "core/src/main/resources/hudson/model/BooleanParameterValue/value.jelly", "core/src/main/resources/hudson/model/ChoiceParameterDefinition/index.jelly", "core/src/main/resources/hudson/model/FileParameterDefinition/index.jelly", "core/src/main/resources/hudson/model/FileParameterValue/value.jelly", "core/src/main/resources/hudson/model/ParametersAction/index.jelly", "core/src/main/resources/hudson/model/ParametersDefinitionProperty/index.jelly", "core/src/main/resources/hudson/model/PasswordParameterDefinition/index.jelly", "core/src/main/resources/hudson/model/PasswordParameterValue/value.jelly", "core/src/main/resources/hudson/model/RunParameterDefinition/index.jelly", "core/src/main/resources/hudson/model/RunParameterValue/value.jelly", "core/src/main/resources/hudson/model/StringParameterDefinition/index.jelly", "core/src/main/resources/hudson/model/StringParameterValue/value.jelly", "core/src/main/resources/hudson/model/TextParameterDefinition/index.jelly", "core/src/main/resources/hudson/model/TextParameterValue/value.jelly", "core/src/main/resources/lib/form/entry.jelly", "test/src/test/java/hudson/model/ParametersTest.java"], "buggy_code_start_loc": [33, 29, 29, 29, 29, 29, 38, 47, 29, 29, 29, 29, 29, 29, 27, 29, 34, 2], "buggy_code_end_loc": [91, 30, 30, 30, 30, 30, 38, 47, 30, 30, 30, 30, 30, 30, 28, 30, 82, 218], "fixing_code_start_loc": [34, 29, 29, 29, 29, 29, 39, 48, 29, 29, 29, 29, 29, 29, 27, 29, 35, 3], "fixing_code_end_loc": [110, 31, 31, 31, 31, 31, 40, 49, 31, 31, 31, 31, 31, 31, 29, 31, 86, 275], "type": "CWE-79", "message": "Jenkins before versions 2.44, 2.32.2 is vulnerable to a persisted cross-site scripting in parameter names and descriptions (SECURITY-353). Users with the permission to configure jobs were able to inject JavaScript into parameter names and descriptions.", "other": {"cve": {"id": "CVE-2017-2601", "sourceIdentifier": "secalert@redhat.com", "published": "2018-05-10T13:29:00.233", "lastModified": "2022-10-19T18:15:11.350", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "Jenkins before versions 2.44, 2.32.2 is vulnerable to a persisted cross-site scripting in parameter names and descriptions (SECURITY-353). Users with the permission to configure jobs were able to inject JavaScript into parameter names and descriptions."}, {"lang": "es", "value": "Jenkins en versiones anteriores a la 2.44, 2.32.2 es vulnerable a Cross-Site Scripting (XSS) persistente en nombres y descripciones de par\u00e1metros (SECURITY-353). Los usuarios con el permiso para configurar jobs pudieron inyectar JavaScript en nombres y descripciones de par\u00e1metro."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV30": [{"source": "secalert@redhat.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "secalert@redhat.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "nvd@nist.gov", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:jenkins:jenkins:*:*:*:*:lts:*:*:*", "versionEndExcluding": "2.32.2", "matchCriteriaId": "F1F48E96-6C2B-4773-98A4-BFF626A0811F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:jenkins:jenkins:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.44", "matchCriteriaId": "D4595374-F7F2-43D5-BB78-37E8377B1E45"}]}]}], "references": [{"url": "http://www.openwall.com/lists/oss-security/2022/04/12/5", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2022/05/17/8", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2022/06/22/3", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2022/06/30/3", "source": "secalert@redhat.com", "tags": ["Mailing List", "Third Party Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2022/10/19/3", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/bid/95960", "source": "secalert@redhat.com", "tags": ["VDB Entry", "Third Party Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2017-2601", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/jenkinsci/jenkins/commit/fd2e081b947124c90bcd97bfc55e1a7f2ef41a74", "source": "secalert@redhat.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://jenkins.io/security/advisory/2017-02-01/", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}]}, "github_commit_url": "https://github.com/jenkinsci/jenkins/commit/fd2e081b947124c90bcd97bfc55e1a7f2ef41a74"}}