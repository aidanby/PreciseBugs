{"buggy_code": ["{***************************************************************************\n* You can find the license in the docs directory\n***************************************************************************}\n{* OCSTYLE *}\n<div class=\"content2-pagetitle\">\n    <img src=\"resource2/{$opt.template.style}/images/misc/32x32-profile.png\" style=\"margin-right: 10px;\" width=\"32\" height=\"32\" alt=\"\" />\n    {t}Login{/t}\n</div>\n\n<div class=\"systemlink\">\n<form action=\"{$opt.page.login_url}\" method=\"post\" enctype=\"application/x-www-form-urlencoded\" style=\"display: inline;\">\n    <input type=\"hidden\" name=\"target\" value=\"{$target|escape}\" />\n    <input type=\"hidden\" name=\"action\" value=\"login\" />\n    <div class=\"content-txtbox-noshade\">\n        <p style=\"line-height: 1.6em;\" {if $error!=LOGIN_OK && $error!=LOGIN_LOGOUT_OK}class=\"errormsg\"{/if}>\n            {if $error!=LOGIN_OK}\n                {if $error==LOGIN_BADUSERPW}\n                    {t}The login was not successfull.{/t}<br />\n                    {t}The entered username or password did not match.{/t}<br />\n                {elseif $error==LOGIN_TOOMUCHLOGINS}\n                    {t}The login was not successfull.{/t}<br />\n                    {t 1=$opt.page.max_logins_per_hour}Your tried to login more than %1 times in the last hour. The next login will not be allowed before one hour since the first try has passed.{/t}<br />\n                {elseif $error==LOGIN_USERNOTACTIVE}\n                    {t}Your account is not acivated.{/t}<br />\n                    {t}&gt;<a href=\"activation.php\">Here</a>&lt; you can activate your account.{/t}<br />\n                {elseif $error==LOGIN_EMPTY_USERPASSWORD}\n                    {t}Please fill in username and password!{/t}\n                {elseif $error==LOGIN_LOGOUT_OK}\n                    {t}Logout was successful.{/t}\n                {else}\n                    {t}The login was not successfull.{/t}<br />\n                    {t 1=$opt.mail.contact}If this problem persists over a longer time, please contact us at <a href=\"mailto:%1\">%1</a>.{/t}<br />\n                {/if}\n            {else}\n                {t}Please login to continue:{/t}\n            {/if}\n        </p>\n        <div class=\"buffer\" style=\"width: 500px;\">&nbsp;</div>\n    </div>\n\n    <table class=\"table\">\n        <tr>\n            <td>{t}Username:{/t}</td>\n            <td><input name=\"email\" maxlength=\"80\" type=\"text\" value=\"{$username}\" class=\"input200\" /></td>\n        </tr>\n        <tr>\n            <td>{t}Password:{/t}</td>\n            <td><input name=\"password\" maxlength=\"60\" type=\"password\" value=\"\" class=\"input200\" /></td>\n        </tr>\n        <tr><td class=\"spacer\" colspan=\"2\"></td></tr>\n\n        <tr>\n            <td></td>\n            <td class=\"header-small\">\n                <!-- <input type=\"reset\" name=\"reset\" value=\"{t}Reset{/t}\" class=\"formbutton\" onclick=\"flashbutton('reset')\" />&nbsp;&nbsp; -->\n                <input type=\"submit\" name=\"submit\" value=\"{t}Login{/t}\" class=\"formbutton\" onclick=\"submitbutton('submit')\" />\n            </td>\n        </tr>\n        <tr><td class=\"spacer\" colspan=\"2\"></td></tr>\n    </table>\n</form>\n\n<div class=\"content-txtbox-noshade\">\n    <p style=\"line-height: 1.6em;\">\n        <br />\n        {t}Not registered?{/t} &nbsp;&rarr;&nbsp; <a href=\"register.php\">{t}Register{/t}</a><br />\n        {t}Forgotten your password?{/t} &nbsp;&rarr;&nbsp; <a href=\"newpw.php\">{t}Create a new password{/t}</a><br />\n        {t}Forgotten your E-Mail-Address?{/t} &nbsp;&rarr;&nbsp; <a href=\"remindemail.php\">{t}Remind me{/t}</a><br />\n    </p>\n    <p>\n        {t}Here you can find more troubleshooting:{/t} {$loginhelplink}{t}Problems with login{/t}</a>.\n    </p>\n    <div class=\"buffer\" style=\"width: 500px;\">&nbsp;</div>\n</div>\n\n</div>\n"], "fixing_code": ["{***************************************************************************\n* You can find the license in the docs directory\n***************************************************************************}\n{* OCSTYLE *}\n<h1>login.tpl</h1>\n<div class=\"content2-pagetitle\">\n    <img src=\"resource2/{$opt.template.style}/images/misc/32x32-profile.png\" style=\"margin-right: 10px;\" width=\"32\" height=\"32\" alt=\"\" />\n    {t}Login{/t}\n</div>\n\n<div class=\"systemlink\">\n<form action=\"{$opt.page.login_url}\" method=\"post\" enctype=\"application/x-www-form-urlencoded\" style=\"display: inline;\">\n    <input type=\"hidden\" name=\"target\" value=\"{$target|escape}\" />\n    <input type=\"hidden\" name=\"action\" value=\"login\" />\n    <div class=\"content-txtbox-noshade\">\n        <p style=\"line-height: 1.6em;\" {if $error!=LOGIN_OK && $error!=LOGIN_LOGOUT_OK}class=\"errormsg\"{/if}>\n            {if $error!=LOGIN_OK}\n                {if $error==LOGIN_BADUSERPW}\n                    {t}The login was not successfull.{/t}<br />\n                    {t}The entered username or password did not match.{/t}<br />\n                {elseif $error==LOGIN_TOOMUCHLOGINS}\n                    {t}The login was not successfull.{/t}<br />\n                    {t 1=$opt.page.max_logins_per_hour}Your tried to login more than %1 times in the last hour. The next login will not be allowed before one hour since the first try has passed.{/t}<br />\n                {elseif $error==LOGIN_USERNOTACTIVE}\n                    {t}Your account is not acivated.{/t}<br />\n                    {t}&gt;<a href=\"activation.php\">Here</a>&lt; you can activate your account.{/t}<br />\n                {elseif $error==LOGIN_EMPTY_USERPASSWORD}\n                    {t}Please fill in username and password!{/t}\n                {elseif $error==LOGIN_LOGOUT_OK}\n                    {t}Logout was successful.{/t}\n                {else}\n                    {t}The login was not successfull.{/t}<br />\n                    {t 1=$opt.mail.contact}If this problem persists over a longer time, please contact us at <a href=\"mailto:%1\">%1</a>.{/t}<br />\n                {/if}\n            {else}\n                {t}Please login to continue:{/t}\n            {/if}\n        </p>\n        <div class=\"buffer\" style=\"width: 500px;\">&nbsp;</div>\n    </div>\n\n    <table class=\"table\">\n        <tr>\n            <td>{t}Username:{/t}</td>\n            <td><input name=\"email\" maxlength=\"80\" type=\"text\" value=\"{$username|escape}\" class=\"input200\" /></td>\n        </tr>\n        <tr>\n            <td>{t}Password:{/t}</td>\n            <td><input name=\"password\" maxlength=\"60\" type=\"password\" value=\"\" class=\"input200\" /></td>\n        </tr>\n        <tr><td class=\"spacer\" colspan=\"2\"></td></tr>\n\n        <tr>\n            <td></td>\n            <td class=\"header-small\">\n                <!-- <input type=\"reset\" name=\"reset\" value=\"{t}Reset{/t}\" class=\"formbutton\" onclick=\"flashbutton('reset')\" />&nbsp;&nbsp; -->\n                <input type=\"submit\" name=\"submit\" value=\"{t}Login{/t}\" class=\"formbutton\" onclick=\"submitbutton('submit')\" />\n            </td>\n        </tr>\n        <tr><td class=\"spacer\" colspan=\"2\"></td></tr>\n    </table>\n</form>\n\n<div class=\"content-txtbox-noshade\">\n    <p style=\"line-height: 1.6em;\">\n        <br />\n        {t}Not registered?{/t} &nbsp;&rarr;&nbsp; <a href=\"register.php\">{t}Register{/t}</a><br />\n        {t}Forgotten your password?{/t} &nbsp;&rarr;&nbsp; <a href=\"newpw.php\">{t}Create a new password{/t}</a><br />\n        {t}Forgotten your E-Mail-Address?{/t} &nbsp;&rarr;&nbsp; <a href=\"remindemail.php\">{t}Remind me{/t}</a><br />\n    </p>\n    <p>\n        {t}Here you can find more troubleshooting:{/t} {$loginhelplink}{t}Problems with login{/t}</a>.\n    </p>\n    <div class=\"buffer\" style=\"width: 500px;\">&nbsp;</div>\n</div>\n\n</div>\n"], "filenames": ["htdocs/templates2/ocstyle/login.tpl"], "buggy_code_start_loc": [4], "buggy_code_end_loc": [45], "fixing_code_start_loc": [5], "fixing_code_end_loc": [46], "type": "CWE-79", "message": "A vulnerability, which was classified as problematic, has been found in Opencaching Deutschland oc-server3. This issue affects some unknown processing of the file htdocs/templates2/ocstyle/login.tpl of the component Login Page. The manipulation of the argument username leads to cross site scripting. The attack may be initiated remotely. The name of the patch is 3296ebd61e7fe49e93b5755d5d7766d6e94a7667. It is recommended to apply a patch to fix this issue. The identifier VDB-216173 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2022-4587", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-17T13:15:09.730", "lastModified": "2022-12-22T15:38:40.777", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability, which was classified as problematic, has been found in Opencaching Deutschland oc-server3. This issue affects some unknown processing of the file htdocs/templates2/ocstyle/login.tpl of the component Login Page. The manipulation of the argument username leads to cross site scripting. The attack may be initiated remotely. The name of the patch is 3296ebd61e7fe49e93b5755d5d7766d6e94a7667. It is recommended to apply a patch to fix this issue. The identifier VDB-216173 was assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-707"}, {"lang": "en", "value": "CWE-74"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:oc-server3_project:oc-server3:*:*:*:*:*:*:*:*", "versionEndExcluding": "2022-09-04", "matchCriteriaId": "7DD0CB73-32F6-4339-B009-B81EF8A8B743"}]}]}], "references": [{"url": "https://github.com/OpencachingDeutschland/oc-server3/commit/3296ebd61e7fe49e93b5755d5d7766d6e94a7667", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/OpencachingDeutschland/oc-server3/pull/893", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.216173", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/OpencachingDeutschland/oc-server3/commit/3296ebd61e7fe49e93b5755d5d7766d6e94a7667"}}