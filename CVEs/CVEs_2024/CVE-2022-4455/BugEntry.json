{"buggy_code": ["<?php\n/*\n * Copyright 2012 Sean Proctor\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/*\n * The following variables are intended to be modified to fit your\n * setup.\n */\n\n/*\n * If you want different scripts with different default calendars, you can\n * copy this script and modify $default_calendar_id to contain the CID of\n * the calendar you want to be the default\n */\n$default_calendar_id = 1;\n\n/*\n * $phpc_root_path gives the location of the base calendar install.\n * if you move this file to a new location, modify $phpc_root_path to point\n * to the location where the support files for the callendar are located.\n */\n$phpc_root_path = dirname(__FILE__);\n$phpc_includes_path = \"$phpc_root_path/src\";\n$phpc_config_file = \"$phpc_root_path/config.php\";\n$phpc_locale_path = \"$phpc_root_path/locale\";\n$phpc_script = htmlentities($_SERVER['PHP_SELF']);\n\n$phpc_server = $_SERVER['SERVER_NAME'];\nif(!empty($_SERVER[\"SERVER_PORT\"]) && $_SERVER[\"SERVER_PORT\"] != 80)\n\t$phpc_server .= \":{$_SERVER[\"SERVER_PORT\"]}\";\n\n// Protcol ex. http or https\nif (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] != 'off'\n\t\t|| $_SERVER['SERVER_PORT'] == 443\n\t\t|| isset($_SERVER['HTTP_X_FORWARDED_PROTO']) && $_SERVER['HTTP_X_FORWARDED_PROTO'] == 'https'\n\t\t|| isset($_SERVER['HTTP_X_FORWARDED_SSL']) && $_SERVER['HTTP_X_FORWARDED_SSL'] == 'on') {\n    $phpc_proto = \"https\";\n} else {\n    $phpc_proto = \"http\";\n}\n\n$phpc_home_url=\"$phpc_proto://$phpc_server$phpc_script\";\n$phpc_url = $phpc_home_url . (empty($_SERVER['QUERY_STRING']) ? ''\n\t\t: '?' . $_SERVER['QUERY_STRING']);\n\n// Remove this line if you must\nini_set('arg_separator.output', '&amp;');\n\n/*\n * Do not modify anything under this point\n */\nif (!defined('IN_PHPC'))\ndefine('IN_PHPC', true);\n\ntry {\n\trequire_once(\"$phpc_includes_path/calendar.php\");\n\trequire_once(\"$phpc_includes_path/setup.php\");\n\n\t$calendar_title = $phpc_cal->get_title();\n\t$content = display_phpc();\n} catch(Exception $e) {\n\t$calendar_title = $e->getMessage();\n\t$content = tag('div', attributes('class=\"php-calendar\"'),\n\t\t\t$e->getMessage());\n}\n\n$html = tag('html', attrs(\"lang=\\\"$phpc_lang\\\"\"),\n\t\ttag('head',\n\t\t\ttag('title', $calendar_title),\n\t\t\ttag('link', attrs('rel=\"icon\"',\n\t\t\t\t\t\"href=\\\"static/office-calendar.png\\\"\")),\n\t\t\tget_header_tags(\"static\"),\n\t\t\ttag('meta', attrs('http-equiv=\"Content-Type\"',\n\t\t\t\t\t   'content=\"text/html; charset=UTF-8\"'))),\n\t\ttag('body', $content));\n\necho '<!DOCTYPE html>', \"\\n\", $html->toString();\n"], "fixing_code": ["<?php\n/*\n * Copyright 2012 Sean Proctor\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/*\n * The following variables are intended to be modified to fit your\n * setup.\n */\n\n/*\n * If you want different scripts with different default calendars, you can\n * copy this script and modify $default_calendar_id to contain the CID of\n * the calendar you want to be the default\n */\n$default_calendar_id = 1;\n\n/*\n * $phpc_root_path gives the location of the base calendar install.\n * if you move this file to a new location, modify $phpc_root_path to point\n * to the location where the support files for the calendar are located.\n */\n$phpc_root_path = dirname(__FILE__);\n$phpc_includes_path = \"$phpc_root_path/src\";\n$phpc_config_file = \"$phpc_root_path/config.php\";\n$phpc_locale_path = \"$phpc_root_path/locale\";\n$phpc_script = htmlspecialchars($_SERVER['PHP_SELF'], ENT_QUOTES, 'UTF-8');\n\n$phpc_server = $_SERVER['SERVER_NAME'];\nif(!empty($_SERVER[\"SERVER_PORT\"]) && $_SERVER[\"SERVER_PORT\"] != 80)\n\t$phpc_server .= \":{$_SERVER[\"SERVER_PORT\"]}\";\n\n// Protcol ex. http or https\nif (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] != 'off'\n\t\t|| $_SERVER['SERVER_PORT'] == 443\n\t\t|| isset($_SERVER['HTTP_X_FORWARDED_PROTO']) && $_SERVER['HTTP_X_FORWARDED_PROTO'] == 'https'\n\t\t|| isset($_SERVER['HTTP_X_FORWARDED_SSL']) && $_SERVER['HTTP_X_FORWARDED_SSL'] == 'on') {\n    $phpc_proto = \"https\";\n} else {\n    $phpc_proto = \"http\";\n}\n\n$phpc_home_url=\"$phpc_proto://$phpc_server$phpc_script\";\n$phpc_url = $phpc_home_url . (empty($_SERVER['QUERY_STRING']) ? ''\n\t\t: '?' . $_SERVER['QUERY_STRING']);\n\n// Remove this line if you must\nini_set('arg_separator.output', '&amp;');\n\n/*\n * Do not modify anything under this point\n */\nif (!defined('IN_PHPC'))\ndefine('IN_PHPC', true);\n\ntry {\n\trequire_once(\"$phpc_includes_path/calendar.php\");\n\trequire_once(\"$phpc_includes_path/setup.php\");\n\n\t$calendar_title = $phpc_cal->get_title();\n\t$content = display_phpc();\n} catch(Exception $e) {\n\t$calendar_title = $e->getMessage();\n\t$content = tag('div', attributes('class=\"php-calendar\"'),\n\t\t\t$e->getMessage());\n}\n\n$html = tag('html', attrs(\"lang=\\\"$phpc_lang\\\"\"),\n\t\ttag('head',\n\t\t\ttag('title', $calendar_title),\n\t\t\ttag('link', attrs('rel=\"icon\"',\n\t\t\t\t\t\"href=\\\"static/office-calendar.png\\\"\")),\n\t\t\tget_header_tags(\"static\"),\n\t\t\ttag('meta', attrs('http-equiv=\"Content-Type\"',\n\t\t\t\t\t   'content=\"text/html; charset=UTF-8\"'))),\n\t\ttag('body', $content));\n\necho '<!DOCTYPE html>', \"\\n\", $html->toString();\n"], "filenames": ["index.php"], "buggy_code_start_loc": [33], "buggy_code_end_loc": [40], "fixing_code_start_loc": [33], "fixing_code_end_loc": [40], "type": "CWE-79", "message": "A vulnerability, which was classified as problematic, was found in sproctor php-calendar. This affects an unknown part of the file index.php. The manipulation of the argument $_SERVER['PHP_SELF'] leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is a2941109b42201c19733127ced763e270a357809. It is recommended to apply a patch to fix this issue. The identifier VDB-215445 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2022-4455", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-13T18:15:10.830", "lastModified": "2022-12-19T16:45:37.610", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability, which was classified as problematic, was found in sproctor php-calendar. This affects an unknown part of the file index.php. The manipulation of the argument $_SERVER['PHP_SELF'] leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is a2941109b42201c19733127ced763e270a357809. It is recommended to apply a patch to fix this issue. The identifier VDB-215445 was assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-707"}, {"lang": "en", "value": "CWE-74"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:php-calendar:php-calendar:*:*:*:*:*:*:*:*", "versionEndExcluding": "2022-04-28", "matchCriteriaId": "D384292A-B632-4CBC-90B7-4E9B8D7F2C04"}]}]}], "references": [{"url": "https://github.com/sproctor/php-calendar/commit/a2941109b42201c19733127ced763e270a357809", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.215445", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/sproctor/php-calendar/commit/a2941109b42201c19733127ced763e270a357809"}}