{"buggy_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.1\">\n  <web>IconThemesCode</web>\n  <name>IconPickerMacro</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>IconThemes.WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>Icon Picker Macro</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>= Usage =\n{{code}}\n{{iconPicker id=\"\" class=\"\" prefix=\"\" /}}\n{{/code}}\n\n**Where:**\n|=id (optional)|DOM id of the input field where the picker will apply\n|=class (optional)|CSS class of inputs where the picker will apply\n|=prefix (optional)|Prefix to add before the name of the icon in the input field (default: \"{{{image:icon:}}}\")\n== Live example ==\n{{code}}\n{{html}}\n  &lt;p&gt;Field 1: &lt;input type=\"text\" id=\"myPicker\" /&gt;&lt;/p&gt;\n  &lt;p&gt;Field 2: &lt;input type=\"text\" class=\"fieldWithPicker\" /&gt;&lt;/p&gt;\n{{/html}}\n\n{{iconPicker id=\"myPicker\" class=\"fieldWithPicker\" prefix=\"icon:\" /}}\n{{/code}}\n== Play with it ==\n{{html}}\n  &lt;p&gt;Field 1: &lt;input type=\"text\" id=\"myPicker\" /&gt;&lt;/p&gt;\n  &lt;p&gt;Field 2: &lt;input type=\"text\" class=\"fieldWithPicker\" /&gt;&lt;/p&gt;\n{{/html}}\n\n{{iconPicker id=\"myPicker\" class=\"fieldWithPicker\" prefix=\"icon:\" /}}</content>\n  <object>\n    <name>IconThemesCode.IconPickerMacro</name>\n    <number>0</number>\n    <className>XWiki.WikiMacroClass</className>\n    <guid>a5daaf5a-bdf5-4a63-b0de-db25061f5874</guid>\n    <class>\n      <name>XWiki.WikiMacroClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <code>\n        <disabled>0</disabled>\n        <name>code</name>\n        <number>9</number>\n        <prettyName>Macro code</prettyName>\n        <rows>20</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentDescription>\n        <disabled>0</disabled>\n        <name>contentDescription</name>\n        <number>8</number>\n        <prettyName>Content description (Not applicable for \"No content\" type)</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </contentDescription>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>7</number>\n        <prettyName>Macro content type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>|</separator>\n        <separators>|</separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>Optional|Mandatory|No content</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <defaultCategory>\n        <disabled>0</disabled>\n        <name>defaultCategory</name>\n        <number>4</number>\n        <prettyName>Default category</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </defaultCategory>\n      <description>\n        <disabled>0</disabled>\n        <name>description</name>\n        <number>3</number>\n        <prettyName>Macro description</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </description>\n      <id>\n        <disabled>0</disabled>\n        <name>id</name>\n        <number>1</number>\n        <prettyName>Macro id</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </id>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>2</number>\n        <prettyName>Macro name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <supportsInlineMode>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>supportsInlineMode</name>\n        <number>5</number>\n        <prettyName>Supports inline mode</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </supportsInlineMode>\n      <visibility>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>visibility</name>\n        <number>6</number>\n        <prettyName>Macro visibility</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>|</separator>\n        <separators>|</separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>Current User|Current Wiki|Global</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </visibility>\n    </class>\n    <property>\n      <code>{{velocity output=\"false\"}}\n  $xwiki.ssx.use('IconThemesCode.IconPicker')\n  ## The icons themes may need some SSX, so we ask for a rendering of an icon of each icon theme, to be able to display\n  ## all icon themes in the picker\n  ## ToDo: since it is a bit hacky, a better system would be to dynamically load the needed SSX on demand\n  #foreach($iconSetName in $services.icon.iconSetNames)\n    $services.icon.render('wiki', $iconSetName)\n  #end\n{{/velocity}}\n\n{{velocity}}\n{{html clean=\"false\"}}\n&lt;script&gt;\n  require.config({\n    paths: {\n      'xwiki-icon-picker': '$xwiki.getURL($services.model.createDocumentReference('', 'IconThemesCode', 'IconPicker'), 'jsx', \"minify=$!{escapetool.url($request.minify)}\")'\n    }\n  });\n  require(['jquery', 'xwiki-icon-picker'], function($) {\n    var options = {};\n    #if($xcontext.macro.params.parameterNames.contains('prefix'))\n      options['prefix'] = '$escapetool.javascript($xcontext.macro.params.prefix)';\n    #end\n    #if(\"$!xcontext.macro.params.id\" != '')\n      $('#${xcontext.macro.params.id}').xwikiIconPicker(options);\n    #end\n    #if(\"$!xcontext.macro.params.get('class')\" != '')\n      $('.${xcontext.macro.params.get('class')}').xwikiIconPicker(options);\n    #end\n  });\n&lt;/script&gt;\n{{/html}}\n{{/velocity}}</code>\n    </property>\n    <property>\n      <contentDescription/>\n    </property>\n    <property>\n      <contentType>No content</contentType>\n    </property>\n    <property>\n      <defaultCategory>Development</defaultCategory>\n    </property>\n    <property>\n      <description>Select an icon within the XWiki icon set.</description>\n    </property>\n    <property>\n      <id>iconPicker</id>\n    </property>\n    <property>\n      <name>Icon Picker</name>\n    </property>\n    <property>\n      <supportsInlineMode>1</supportsInlineMode>\n    </property>\n    <property>\n      <visibility>Current Wiki</visibility>\n    </property>\n  </object>\n  <object>\n    <name>IconThemesCode.IconPickerMacro</name>\n    <number>0</number>\n    <className>XWiki.WikiMacroParameterClass</className>\n    <guid>bff4d631-8c3a-47fd-b54a-a542874bb81e</guid>\n    <class>\n      <name>XWiki.WikiMacroParameterClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <defaultValue>\n        <disabled>0</disabled>\n        <name>defaultValue</name>\n        <number>4</number>\n        <prettyName>Parameter default value</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </defaultValue>\n      <description>\n        <disabled>0</disabled>\n        <name>description</name>\n        <number>2</number>\n        <prettyName>Parameter description</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </description>\n      <mandatory>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>mandatory</name>\n        <number>3</number>\n        <prettyName>Parameter mandatory</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </mandatory>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Parameter name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n    </class>\n    <property>\n      <defaultValue/>\n    </property>\n    <property>\n      <description>DOM id of the input field where the picker will apply</description>\n    </property>\n    <property>\n      <mandatory>0</mandatory>\n    </property>\n    <property>\n      <name>id</name>\n    </property>\n  </object>\n  <object>\n    <name>IconThemesCode.IconPickerMacro</name>\n    <number>1</number>\n    <className>XWiki.WikiMacroParameterClass</className>\n    <guid>f9169e0d-a47c-4598-b0d7-4211940d1886</guid>\n    <class>\n      <name>XWiki.WikiMacroParameterClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <defaultValue>\n        <disabled>0</disabled>\n        <name>defaultValue</name>\n        <number>4</number>\n        <prettyName>Parameter default value</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </defaultValue>\n      <description>\n        <disabled>0</disabled>\n        <name>description</name>\n        <number>2</number>\n        <prettyName>Parameter description</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </description>\n      <mandatory>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>mandatory</name>\n        <number>3</number>\n        <prettyName>Parameter mandatory</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </mandatory>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Parameter name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n    </class>\n    <property>\n      <defaultValue/>\n    </property>\n    <property>\n      <description>CSS class of inputs where the picker will apply</description>\n    </property>\n    <property>\n      <mandatory>0</mandatory>\n    </property>\n    <property>\n      <name>class</name>\n    </property>\n  </object>\n  <object>\n    <name>IconThemesCode.IconPickerMacro</name>\n    <number>2</number>\n    <className>XWiki.WikiMacroParameterClass</className>\n    <guid>3a99d1ba-b108-45c6-a828-e76902f25783</guid>\n    <class>\n      <name>XWiki.WikiMacroParameterClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <defaultValue>\n        <disabled>0</disabled>\n        <name>defaultValue</name>\n        <number>4</number>\n        <prettyName>Parameter default value</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </defaultValue>\n      <description>\n        <disabled>0</disabled>\n        <name>description</name>\n        <number>2</number>\n        <prettyName>Parameter description</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </description>\n      <mandatory>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>mandatory</name>\n        <number>3</number>\n        <prettyName>Parameter mandatory</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </mandatory>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Parameter name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n    </class>\n    <property>\n      <defaultValue/>\n    </property>\n    <property>\n      <description>Prefix to add before the name of the icon in the input field (default: \"image:icon:\")</description>\n    </property>\n    <property>\n      <mandatory>0</mandatory>\n    </property>\n    <property>\n      <name>prefix</name>\n    </property>\n  </object>\n</xwikidoc>\n"], "fixing_code": ["<?xml version=\"1.1\" encoding=\"UTF-8\"?>\n\n<!--\n * See the NOTICE file distributed with this work for additional\n * information regarding copyright ownership.\n *\n * This is free software; you can redistribute it and/or modify it\n * under the terms of the GNU Lesser General Public License as\n * published by the Free Software Foundation; either version 2.1 of\n * the License, or (at your option) any later version.\n *\n * This software is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public\n * License along with this software; if not, write to the Free\n * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n-->\n\n<xwikidoc version=\"1.1\">\n  <web>IconThemesCode</web>\n  <name>IconPickerMacro</name>\n  <language/>\n  <defaultLanguage/>\n  <translation>0</translation>\n  <creator>xwiki:XWiki.Admin</creator>\n  <parent>IconThemes.WebHome</parent>\n  <author>xwiki:XWiki.Admin</author>\n  <contentAuthor>xwiki:XWiki.Admin</contentAuthor>\n  <version>1.1</version>\n  <title>Icon Picker Macro</title>\n  <comment/>\n  <minorEdit>false</minorEdit>\n  <syntaxId>xwiki/2.1</syntaxId>\n  <hidden>true</hidden>\n  <content>= Usage =\n{{code}}\n{{iconPicker id=\"\" class=\"\" prefix=\"\" /}}\n{{/code}}\n\n**Where:**\n|=id (optional)|DOM id of the input field where the picker will apply\n|=class (optional)|CSS class of inputs where the picker will apply\n|=prefix (optional)|Prefix to add before the name of the icon in the input field (default: \"{{{image:icon:}}}\")\n== Live example ==\n{{code}}\n{{html}}\n  &lt;p&gt;Field 1: &lt;input type=\"text\" id=\"myPicker\" /&gt;&lt;/p&gt;\n  &lt;p&gt;Field 2: &lt;input type=\"text\" class=\"fieldWithPicker\" /&gt;&lt;/p&gt;\n{{/html}}\n\n{{iconPicker id=\"myPicker\" class=\"fieldWithPicker\" prefix=\"icon:\" /}}\n{{/code}}\n== Play with it ==\n{{html}}\n  &lt;p&gt;Field 1: &lt;input type=\"text\" id=\"myPicker\" /&gt;&lt;/p&gt;\n  &lt;p&gt;Field 2: &lt;input type=\"text\" class=\"fieldWithPicker\" /&gt;&lt;/p&gt;\n{{/html}}\n\n{{iconPicker id=\"myPicker\" class=\"fieldWithPicker\" prefix=\"icon:\" /}}</content>\n  <object>\n    <name>IconThemesCode.IconPickerMacro</name>\n    <number>0</number>\n    <className>XWiki.WikiMacroClass</className>\n    <guid>a5daaf5a-bdf5-4a63-b0de-db25061f5874</guid>\n    <class>\n      <name>XWiki.WikiMacroClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <code>\n        <disabled>0</disabled>\n        <name>code</name>\n        <number>9</number>\n        <prettyName>Macro code</prettyName>\n        <rows>20</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </code>\n      <contentDescription>\n        <disabled>0</disabled>\n        <name>contentDescription</name>\n        <number>8</number>\n        <prettyName>Content description (Not applicable for \"No content\" type)</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </contentDescription>\n      <contentType>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>contentType</name>\n        <number>7</number>\n        <prettyName>Macro content type</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>|</separator>\n        <separators>|</separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>Optional|Mandatory|No content</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </contentType>\n      <defaultCategory>\n        <disabled>0</disabled>\n        <name>defaultCategory</name>\n        <number>4</number>\n        <prettyName>Default category</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </defaultCategory>\n      <description>\n        <disabled>0</disabled>\n        <name>description</name>\n        <number>3</number>\n        <prettyName>Macro description</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </description>\n      <id>\n        <disabled>0</disabled>\n        <name>id</name>\n        <number>1</number>\n        <prettyName>Macro id</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </id>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>2</number>\n        <prettyName>Macro name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n      <supportsInlineMode>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>supportsInlineMode</name>\n        <number>5</number>\n        <prettyName>Supports inline mode</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </supportsInlineMode>\n      <visibility>\n        <cache>0</cache>\n        <disabled>0</disabled>\n        <displayType>select</displayType>\n        <multiSelect>0</multiSelect>\n        <name>visibility</name>\n        <number>6</number>\n        <prettyName>Macro visibility</prettyName>\n        <relationalStorage>0</relationalStorage>\n        <separator>|</separator>\n        <separators>|</separators>\n        <size>1</size>\n        <unmodifiable>0</unmodifiable>\n        <values>Current User|Current Wiki|Global</values>\n        <classType>com.xpn.xwiki.objects.classes.StaticListClass</classType>\n      </visibility>\n    </class>\n    <property>\n      <code>{{velocity output=\"false\"}}\n  $xwiki.ssx.use('IconThemesCode.IconPicker')\n  ## The icons themes may need some SSX, so we ask for a rendering of an icon of each icon theme, to be able to display\n  ## all icon themes in the picker\n  ## ToDo: since it is a bit hacky, a better system would be to dynamically load the needed SSX on demand\n  #foreach($iconSetName in $services.icon.iconSetNames)\n    $services.icon.render('wiki', $iconSetName)\n  #end\n{{/velocity}}\n\n{{velocity}}\n{{html clean=\"false\"}}\n&lt;script&gt;\n  require.config({\n    paths: {\n      'xwiki-icon-picker': '$xwiki.getURL($services.model.createDocumentReference('', 'IconThemesCode', 'IconPicker'), 'jsx', \"minify=$!{escapetool.url($request.minify)}\")'\n    }\n  });\n  require(['jquery', 'xwiki-icon-picker'], function($) {\n    var options = {};\n    #if($xcontext.macro.params.parameterNames.contains('prefix'))\n      options['prefix'] = '$escapetool.javascript($xcontext.macro.params.prefix)';\n    #end\n    #if(\"$!xcontext.macro.params.id\" != '')\n      $('#${escapetool.javascript(${xcontext.macro.params.id})}').xwikiIconPicker(options);\n    #end\n    #if(\"$!xcontext.macro.params.get('class')\" != '')\n      $('.${escapetool.javascript(${xcontext.macro.params.get('class')})}').xwikiIconPicker(options);\n    #end\n  });\n&lt;/script&gt;\n{{/html}}\n{{/velocity}}</code>\n    </property>\n    <property>\n      <contentDescription/>\n    </property>\n    <property>\n      <contentType>No content</contentType>\n    </property>\n    <property>\n      <defaultCategory>Development</defaultCategory>\n    </property>\n    <property>\n      <description>Select an icon within the XWiki icon set.</description>\n    </property>\n    <property>\n      <id>iconPicker</id>\n    </property>\n    <property>\n      <name>Icon Picker</name>\n    </property>\n    <property>\n      <supportsInlineMode>1</supportsInlineMode>\n    </property>\n    <property>\n      <visibility>Current Wiki</visibility>\n    </property>\n  </object>\n  <object>\n    <name>IconThemesCode.IconPickerMacro</name>\n    <number>0</number>\n    <className>XWiki.WikiMacroParameterClass</className>\n    <guid>bff4d631-8c3a-47fd-b54a-a542874bb81e</guid>\n    <class>\n      <name>XWiki.WikiMacroParameterClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <defaultValue>\n        <disabled>0</disabled>\n        <name>defaultValue</name>\n        <number>4</number>\n        <prettyName>Parameter default value</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </defaultValue>\n      <description>\n        <disabled>0</disabled>\n        <name>description</name>\n        <number>2</number>\n        <prettyName>Parameter description</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </description>\n      <mandatory>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>mandatory</name>\n        <number>3</number>\n        <prettyName>Parameter mandatory</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </mandatory>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Parameter name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n    </class>\n    <property>\n      <defaultValue/>\n    </property>\n    <property>\n      <description>DOM id of the input field where the picker will apply</description>\n    </property>\n    <property>\n      <mandatory>0</mandatory>\n    </property>\n    <property>\n      <name>id</name>\n    </property>\n  </object>\n  <object>\n    <name>IconThemesCode.IconPickerMacro</name>\n    <number>1</number>\n    <className>XWiki.WikiMacroParameterClass</className>\n    <guid>f9169e0d-a47c-4598-b0d7-4211940d1886</guid>\n    <class>\n      <name>XWiki.WikiMacroParameterClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <defaultValue>\n        <disabled>0</disabled>\n        <name>defaultValue</name>\n        <number>4</number>\n        <prettyName>Parameter default value</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </defaultValue>\n      <description>\n        <disabled>0</disabled>\n        <name>description</name>\n        <number>2</number>\n        <prettyName>Parameter description</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </description>\n      <mandatory>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>mandatory</name>\n        <number>3</number>\n        <prettyName>Parameter mandatory</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </mandatory>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Parameter name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n    </class>\n    <property>\n      <defaultValue/>\n    </property>\n    <property>\n      <description>CSS class of inputs where the picker will apply</description>\n    </property>\n    <property>\n      <mandatory>0</mandatory>\n    </property>\n    <property>\n      <name>class</name>\n    </property>\n  </object>\n  <object>\n    <name>IconThemesCode.IconPickerMacro</name>\n    <number>2</number>\n    <className>XWiki.WikiMacroParameterClass</className>\n    <guid>3a99d1ba-b108-45c6-a828-e76902f25783</guid>\n    <class>\n      <name>XWiki.WikiMacroParameterClass</name>\n      <customClass/>\n      <customMapping/>\n      <defaultViewSheet/>\n      <defaultEditSheet/>\n      <defaultWeb/>\n      <nameField/>\n      <validationScript/>\n      <defaultValue>\n        <disabled>0</disabled>\n        <name>defaultValue</name>\n        <number>4</number>\n        <prettyName>Parameter default value</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </defaultValue>\n      <description>\n        <disabled>0</disabled>\n        <name>description</name>\n        <number>2</number>\n        <prettyName>Parameter description</prettyName>\n        <rows>5</rows>\n        <size>40</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>\n      </description>\n      <mandatory>\n        <disabled>0</disabled>\n        <displayFormType>select</displayFormType>\n        <displayType>yesno</displayType>\n        <name>mandatory</name>\n        <number>3</number>\n        <prettyName>Parameter mandatory</prettyName>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n      </mandatory>\n      <name>\n        <disabled>0</disabled>\n        <name>name</name>\n        <number>1</number>\n        <prettyName>Parameter name</prettyName>\n        <size>30</size>\n        <unmodifiable>0</unmodifiable>\n        <classType>com.xpn.xwiki.objects.classes.StringClass</classType>\n      </name>\n    </class>\n    <property>\n      <defaultValue/>\n    </property>\n    <property>\n      <description>Prefix to add before the name of the icon in the input field (default: \"image:icon:\")</description>\n    </property>\n    <property>\n      <mandatory>0</mandatory>\n    </property>\n    <property>\n      <name>prefix</name>\n    </property>\n  </object>\n</xwikidoc>\n"], "filenames": ["xwiki-platform-core/xwiki-platform-icon/xwiki-platform-icon-ui/src/main/resources/IconThemesCode/IconPickerMacro.xml"], "buggy_code_start_loc": [203], "buggy_code_end_loc": [207], "fixing_code_start_loc": [203], "fixing_code_end_loc": [207], "type": "CWE-95", "message": "xwiki-platform-icon-ui is vulnerable to Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection'). Any user with view rights on commonly accessible documents including the icon picker macro can execute arbitrary Groovy, Python or Velocity code in XWiki due to improper neutralization of the macro parameters of the icon picker macro. The problem has been patched in XWiki 13.10.7, 14.5 and 14.4.2. Workarounds: The [patch](https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01) can be manually applied by editing `IconThemesCode.IconPickerMacro` in the object editor. The whole document can also be replaced by the current version by importing the document from the XAR archive of a fixed version as the only changes to the document have been security fixes and small formatting changes.", "other": {"cve": {"id": "CVE-2022-41931", "sourceIdentifier": "security-advisories@github.com", "published": "2022-11-23T20:15:10.023", "lastModified": "2022-11-30T17:00:37.137", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "xwiki-platform-icon-ui is vulnerable to Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection'). Any user with view rights on commonly accessible documents including the icon picker macro can execute arbitrary Groovy, Python or Velocity code in XWiki due to improper neutralization of the macro parameters of the icon picker macro. The problem has been patched in XWiki 13.10.7, 14.5 and 14.4.2. Workarounds: The [patch](https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01) can be manually applied by editing `IconThemesCode.IconPickerMacro` in the object editor. The whole document can also be replaced by the current version by importing the document from the XAR archive of a fixed version as the only changes to the document have been security fixes and small formatting changes."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.9, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.1, "impactScore": 6.0}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-95"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartExcluding": "6.4", "versionEndExcluding": "13.10.7", "matchCriteriaId": "A2983665-C5BF-4D43-983A-585BA30399E7"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*", "versionStartIncluding": "14.0.0", "versionEndExcluding": "14.4.2", "matchCriteriaId": "B5DF0A47-B3DD-4A49-BA56-35374D029F02"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:6.4:milestone2:*:*:*:*:*:*", "matchCriteriaId": "2ED3CF77-5A0B-4A1C-9F83-B5851D415D3E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:6.4:milestone3:*:*:*:*:*:*", "matchCriteriaId": "34004E8E-213E-4D7F-A6BF-953A5A5C3CA6"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:14.4.3:*:*:*:*:*:*:*", "matchCriteriaId": "C9646DA8-7C5A-458E-975C-A67099D43047"}, {"vulnerable": true, "criteria": "cpe:2.3:a:xwiki:xwiki:14.4.4:*:*:*:*:*:*:*", "matchCriteriaId": "CDAB9E27-2E41-44EA-BBCB-8015B22272B7"}]}]}], "references": [{"url": "https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5j7g-cf6r-g2h7", "source": "security-advisories@github.com", "tags": ["Exploit", "Patch", "Third Party Advisory"]}, {"url": "https://jira.xwiki.org/browse/XWIKI-19805", "source": "security-advisories@github.com", "tags": ["Exploit", "Issue Tracking", "Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01"}}