{"buggy_code": ["<%@ include file=\"/WEB-INF/fragments/workspace/javascript.jspf\" %>\r\n<script type=\"text/javascript\" src=\"${structurizrConfiguration.cdnUrl}/js/structurizr-ui${structurizrConfiguration.versionSuffix}.js\"></script>\r\n\r\n<style>\r\n    h2 {\r\n        margin-bottom: 20px;\r\n    }\r\n    .container {\r\n        width: auto;\r\n        margin-left: 30px;\r\n        margin-right: 30px;\r\n    }\r\n\r\n    #navigationPanel {\r\n        margin-top: 20px;\r\n    }\r\n\r\n    .navigationItem {\r\n        font-size: 14px;\r\n        margin-bottom: 10px;\r\n    }\r\n\r\n    .navigationItemHeading {\r\n        font-size: 30px;\r\n        margin-bottom: 20px;\r\n    }\r\n\r\n    .navigationItemSeparator {\r\n        margin-bottom: 40px;\r\n    }\r\n</style>\r\n\r\n<div class=\"row\" style=\"padding-bottom: 0; margin-left: 0; margin-right: 0\">\r\n\r\n    <div class=\"col-sm-2\" style=\"padding-left: 30px; margin-bottom: 100px\">\r\n        <div id=\"navigationPanel\" class=\"hidden-xs\">\r\n\r\n            <div class=\"navigationItemHeading\">\r\n                Workspace\r\n            </div>\r\n\r\n            <c:if test=\"${not empty param.version}\">\r\n            <div class=\"navigationItem\">\r\n                <span class=\"label label-version\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/clock-history.svg\" class=\"icon-xs icon-white\" /> ${workspace.internalVersion}</span>\r\n            </div>\r\n            </c:if>\r\n\r\n            <c:if test=\"${workspace.clientEncrypted}\">\r\n            <div class=\"navigationItem\">\r\n                <img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/file-earmark-lock.svg\" class=\"icon-sm\" /> Client-side encrypted\r\n            </div>\r\n            </c:if>\r\n\r\n            <c:if test=\"${fn:startsWith(urlPrefix, '/workspace')}\">\r\n            <div class=\"navigationItem\">\r\n                <a href=\"/workspace/${workspace.id}\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/lock.svg\" class=\"icon-sm\" /> Private link</a>\r\n            </div>\r\n\r\n            <c:if test=\"${workspace.shareable && workspace.ownerUserType.allowedToShareWorkspacesWithLink}\">\r\n            <div class=\"navigationItem\">\r\n                <a href=\"/share/${workspace.id}/${workspace.sharingToken}\" target=\"_blank\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/link.svg\" class=\"icon-sm\" /> Sharing link</a>\r\n            </div>\r\n            </c:if>\r\n\r\n            <c:if test=\"${workspace.open}\">\r\n            <div class=\"navigationItem\">\r\n                <a href=\"/share/${workspace.id}\" target=\"_blank\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/unlock.svg\" class=\"icon-sm\" /> Public link</a>\r\n            </div>\r\n            </c:if>\r\n\r\n            <div class=\"navigationItemSeparator\"></div>\r\n            </c:if>\r\n            \r\n            <c:if test=\"${fn:startsWith(urlPrefix, '/workspace') && structurizrConfiguration.dslEditorEnabled}\">\r\n            <div class=\"navigationItem dslEditorNavigation\">\r\n                <a href=\"${urlPrefix}/dsl${urlSuffix}\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/code-slash.svg\" class=\"icon-sm\" /> DSL editor</a>\r\n            </div>\r\n            </c:if>\r\n\r\n            <div id=\"diagramsLink\" class=\"navigationItem hidden\">\r\n            <a href=\"${urlPrefix}/diagrams${urlSuffix}\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/bounding-box.svg\" class=\"icon-sm\" /> Diagrams</a>\r\n            </div>\r\n\r\n            <div id=\"documentationLink\"  class=\"navigationItem hidden\">\r\n                <a href=\"${urlPrefix}/documentation${urlSuffix}\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/book.svg\" class=\"icon-sm\" /> Documentation</a>\r\n            </div>\r\n            <div id=\"decisionsLink\" class=\"navigationItem hidden\">\r\n                <a href=\"${urlPrefix}/decisions${urlSuffix}\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/journal-text.svg\" class=\"icon-sm\" /> Decisions</a>\r\n            </div>\r\n            <div id=\"exploreLink\" class=\"navigationItem hidden\">\r\n                <a href=\"${urlPrefix}/explore${urlSuffix}\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/diagram-3.svg\" class=\"icon-sm\" /> Explore</a>\r\n            </div>\r\n\r\n            <div id=\"themeLink\" class=\"navigationItem hidden\">\r\n                <a href=\"${urlPrefix}/theme${urlSuffix}\" target=\"_blank\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/palette.svg\" class=\"icon-sm\" /> Theme</a>\r\n            </div>\r\n\r\n            <div id=\"imagesLink\" class=\"navigationItem hidden\">\r\n                <a href=\"${urlPrefix}/images\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/filetype-png.svg\" class=\"icon-sm\" /> Published images</a>\r\n            </div>\r\n\r\n            <div id=\"exportJsonLinkNavItem\" class=\"navigationItem\">\r\n                <a id=\"exportJsonLink\" href=\"\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/filetype-json.svg\" class=\"icon-sm\" /> Export JSON</a>\r\n            </div>\r\n\r\n            <div id=\"exportDslLinkNavItem\" class=\"navigationItem\">\r\n                <a id=\"exportDslLink\" href=\"\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/filetype-txt.svg\" class=\"icon-sm\" /> Export DSL</a>\r\n            </div>\r\n\r\n            <c:if test=\"${workspace.editable && not workspace.locked}\">\r\n            <div class=\"navigationItem\">\r\n                <a id=\"importJsonLink1\" href=\"\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/upload.svg\" class=\"icon-sm\" /> Import JSON</a>\r\n                <input id=\"importFromJsonControl\" type=\"file\" style=\"display: none;\" />\r\n            </div>\r\n            </c:if>\r\n\r\n            <div class=\"navigationItemSeparator\"></div>\r\n            <c:if test=\"${fn:startsWith(urlPrefix, '/workspace')}\">\r\n            <div class=\"navigationItem\">\r\n                <a href=\"${urlPrefix}/settings\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/gear.svg\" class=\"icon-sm\" /> Settings</a>\r\n            </div>\r\n\r\n            <c:if test=\"${workspace.editable eq true and workspace.locked eq true}\">\r\n            <div class=\"navigationItem\">\r\n                <a id=\"unlockWorkspaceLink\" href=\"\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/unlock.svg\" class=\"icon-sm\" /> Unlock</a>\r\n            </div>\r\n            </c:if>\r\n\r\n            <div class=\"navigationItem\">\r\n                <a href=\"${urlPrefix}/users\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/people.svg\" class=\"icon-sm\" /> Users</a>\r\n            </div>\r\n            </c:if>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"col-sm-10\">\r\n        <div class=\"section\" style=\"padding-bottom: 20px\">\r\n            <div class=\"container centered\">\r\n                <h1><span id=\"workspaceName\" class=\"workspace${workspace.id}Name\"><c:out value=\"${workspace.name}\" escapeXml=\"true\" /></span></h1>\r\n                <p id=\"workspaceDescription\" class=\"workspace${workspace.id}Description\">\r\n                    <c:out value=\"${workspace.description}\" escapeXml=\"true\" />\r\n                </p>\r\n\r\n                <p class=\"workspaceMetaData\">\r\n                    <c:if test=\"${empty param.version}\">\r\n                    Last modified: <fmt:formatDate value=\"${workspace.lastModifiedDate}\" pattern=\"EEE dd MMM yyyy HH:mm:ss z\" timeZone=\"${user.timeZone}\" />\r\n                    <c:if test=\"${workspace.editable eq true}\">by ${workspace.lastModifiedUser} using ${workspace.lastModifiedAgent}</c:if>\r\n\r\n                    <c:if test=\"${not empty workspace.version}\">\r\n                    | Version: ${workspace.version}\r\n                    </c:if>\r\n                    <c:if test=\"${workspace.size gt 0}\">\r\n                    |\r\n                    Size: <fmt:formatNumber minFractionDigits=\"2\" maxFractionDigits=\"2\" value=\"${workspace.sizeInMegaBytes}\" /> MB\r\n                    </c:if>\r\n                    </c:if>\r\n                </p>\r\n\r\n                <c:if test=\"${fn:startsWith(urlPrefix, '/workspace') && not empty versions}\">\r\n                <div class=\"centered\" style=\"margin-top: 20px\">\r\n                    <form class=\"form-inline\" style=\"display: inline-block\" method=\"get\" action=\"${urlPrefix}\">\r\n                        <select id=\"workspaceVersion\" name=\"version\" class=\"form-control\">\r\n                            <c:forEach var=\"version\" items=\"${versions}\">\r\n                                <option value=\"${version.versionId}\"><fmt:formatDate value=\"${version.lastModifiedDate}\" pattern=\"EEE dd MMM yyyy HH:mm:ss z\" timeZone=\"${user.timeZone}\" /></option>\r\n                            </c:forEach>\r\n                        </select>\r\n                        <input type=\"submit\" class=\"btn btn-default\" value=\"Load version\" style=\"height: 35.5px\"/>\r\n                    </form>\r\n                    <c:if test=\"${not empty param.version && workspace.editable && not workspace.locked}\">\r\n                        <button id=\"revertButton\" class=\"btn btn-default small\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/clock-history.svg\" class=\"icon-btn\" /> Revert to ${workspace.internalVersion}</button>\r\n                    </c:if>\r\n                </div>\r\n                </c:if>\r\n\r\n                <div id=\"gettingStarted\" class=\"centered hidden\">\r\n                    <c:if test=\"${workspace.editable && not workspace.locked}\">\r\n                    <br />\r\n                    <p>\r\n                        This is your workspace summary page, and from here you can access your diagrams, documentation, and architecture decision records.\r\n                        We recommend that a workspace contains the model, views, and documentation for a single software system\r\n                        - see <a href=\"https://structurizr.com/help/usage-recommendations\" target=\"_blank\">usage recommendations</a> for more details.\r\n                        This workspace is empty, and you can use one of the following authoring options to create content.\r\n                    </p>\r\n\r\n                    <div class=\"row\" style=\"margin-top: 20px; margin-bottom: 20px\">\r\n                        <div class=\"col-sm-4 centered\">\r\n                            <div style=\"padding: 10px; margin: 10px\">\r\n                                <div style=\"margin-top: 5px; font-size: 20px\">\r\n                                    <a href=\"${urlPrefix}/dsl\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/code-slash.svg\" class=\"icon-lg\"/> DSL editor</a>\r\n                                </div>\r\n                                <div class=\"small\">\r\n                                    Open the online DSL editor, and create your workspace using the Structurizr DSL.\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-sm-4 centered\">\r\n                            <div style=\"padding: 10px; margin: 10px\">\r\n                                <div style=\"margin-top: 5px; font-size: 20px\">\r\n                                    <a id=\"importJsonLink2\" href=\"\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/upload.svg\" class=\"icon-lg\" /> Import JSON</a>\r\n                                </div>\r\n                                <div class=\"small\">\r\n                                    Import an existing workspace from a JSON file.\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-sm-4 centered\">\r\n                            <div style=\"padding: 10px; margin: 10px\">\r\n                                <div style=\"margin-top: 5px; font-size: 20px\">\r\n                                    <a href=\"${urlPrefix}/settings#api\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/gear.svg\" class=\"icon-lg\" /> Settings</a>\r\n                                </div>\r\n                                <div class=\"small\">\r\n                                    Use the workspace settings page to find your API key/secret, for uploading your workspace with the Structurizr CLI or code-based libraries.\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    </c:if>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"section workspaceContent\">\r\n            <div class=\"container centered\">\r\n                <div id=\"diagrams\"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<%@ include file=\"/WEB-INF/fragments/progress-message.jspf\" %>\r\n\r\n<script nonce=\"${scriptNonce}\">\r\n\r\n    progressMessage.show('<p>Loading workspace...</p>');\r\n\r\n    $('#unlockWorkspaceLink').click(function(event) { unlockWorkspace(event); });\r\n\r\n    <c:if test=\"${not empty param.version}\">\r\n    $('#workspaceVersion').val(\"${workspace.internalVersion}\");\r\n    </c:if>\r\n\r\n    function addOnClickHandler(domId, handler) {\r\n        var element = document.getElementById(domId);\r\n        if (element) {\r\n            element.onclick = handler;\r\n        }\r\n    }\r\n\r\n    addOnClickHandler('revertButton', revertToLoadedVersion);\r\n\r\n    addOnClickHandler('exportJsonLink', function(e) {\r\n        structurizr.util.exportWorkspace(structurizr.workspace.id, structurizr.workspace.getJson());\r\n        e.preventDefault();\r\n    });\r\n\r\n    addOnClickHandler('exportDslLink', function(e) {\r\n        var dslSource = structurizr.workspace.getProperty('structurizr.dsl');\r\n        if (dslSource !== undefined) {\r\n            dslSource = structurizr.util.atob(dslSource);\r\n            const filename = 'structurizr-' + structurizr.workspace.id + '-workspace.dsl';\r\n            structurizr.util.downloadFile(dslSource, \"text/plain;charset=utf-8\", filename);\r\n        }\r\n\r\n        e.preventDefault();\r\n    });\r\n\r\n    addOnClickHandler('importJsonLink1', function(e) {\r\n        $('#importFromJsonControl').trigger('click');\r\n        e.preventDefault();\r\n    });\r\n\r\n    addOnClickHandler('importJsonLink2', function(e) {\r\n        $('#importFromJsonControl').trigger('click');\r\n        e.preventDefault();\r\n    });\r\n\r\n    var importFromJsonControl = document.getElementById('importFromJsonControl');\r\n    if (importFromJsonControl) {\r\n        importFromJsonControl.onchange = function() {\r\n            importWorkspaceFromFile(importFromJsonControl.files[0], structurizr.workspace.id);\r\n        };\r\n    }\r\n\r\n    function workspaceLoaded() {\r\n        if (structurizr.workspace.getProperty('structurizr.dslEditor') === 'false') {\r\n            $('.dslEditorNavigation').addClass('hidden');\r\n        }\r\n\r\n        $('#workspaceName').html(structurizr.util.escapeHtml(structurizr.workspace.name));\r\n        $('#workspaceDescription').html(structurizr.util.escapeHtml(structurizr.workspace.description));\r\n        var diagramsDiv = $('#diagrams');\r\n\r\n        structurizr.ui.applyBranding();\r\n\r\n        if (structurizr.workspace.hasViews()) {\r\n            var maxNumberOfViews = 10;\r\n            var count = 1;\r\n            var views = structurizr.workspace.getViews();\r\n            const thumbnailSize = 200;\r\n            var html = '';\r\n\r\n            views.forEach(function(view) {\r\n                var url = '${urlPrefix}/diagrams${urlSuffix}#' + structurizr.util.escapeHtml(view.key);\r\n                var title = structurizr.util.escapeHtml(structurizr.ui.getTitleForView(view));\r\n\r\n                if (count <= maxNumberOfViews) {\r\n                    html += '<div class=\"centered\" style=\"display: inline-block; margin: 10px 10px 40px 10px; width: ' + thumbnailSize + 'px;\">';\r\n\r\n                    if (view.type === structurizr.constants.IMAGE_VIEW_TYPE) {\r\n                        html += '  <a href=\"' + url + '\"><img src=\"' + view.content + '\" class=\"img-thumbnail viewThumbnail\" style=\"margin-bottom: 10px; max-height: ' + thumbnailSize + 'px\" /></a>';\r\n                    } else {\r\n                    <c:choose>\r\n                    <c:when test=\"${not empty param.version}\">\r\n                    html += '  <a href=\"' + url + '\"><img src=\"/static/img/thumbnail-not-available.png\" class=\"img-thumbnail\" style=\"margin-bottom: 10px\" /></a>';\r\n                    </c:when>\r\n                    <c:otherwise>\r\n                    html += '  <a href=\"' + url + '\"><img src=\"${thumbnailUrl}' + structurizr.util.escapeHtml(view.key) + '-thumbnail.png\" class=\"img-thumbnail viewThumbnail\" style=\"margin-bottom: 10px; max-height: ' + thumbnailSize + 'px\" /></a>';\r\n                    </c:otherwise>\r\n                    </c:choose>\r\n                    }\r\n\r\n                    html += '  <div class=\"smaller\">';\r\n                    html += '    <a href=\"' + url + '\">' + title + '</a><br />';\r\n                    html += '    #' + structurizr.util.escapeHtml(view.key) + '';\r\n                    html += '  </div>';\r\n                    html += '</div>';\r\n                }\r\n                count++;\r\n            });\r\n\r\n            if (views.length > maxNumberOfViews) {\r\n                html += '<div class=\"small\"><a href=\"${urlPrefix}/diagrams${urlSuffix}\">More diagrams...</a></div>';\r\n            }\r\n\r\n            diagramsDiv.addClass('centered');\r\n            diagramsDiv.append(html);\r\n\r\n            $('.viewThumbnail').on('error', function() {\r\n                $(this).on('error', undefined);\r\n                $(this).attr('src', '/static/img/thumbnail-not-available.png');\r\n            });\r\n\r\n            $('#diagramsLink').removeClass('hidden');\r\n            $('#imagesLink').removeClass('hidden');\r\n        }\r\n\r\n        if (structurizr.workspace.hasDocumentation()) {\r\n            $('#documentationLink').removeClass('hidden');\r\n        }\r\n\r\n        if (structurizr.workspace.hasDecisions()) {\r\n            $('#decisionsLink').removeClass('hidden');\r\n        }\r\n\r\n        if (structurizr.workspace.hasElements()) {\r\n            $('#exploreLink').removeClass('hidden');\r\n        }\r\n\r\n        if (structurizr.workspace.hasStyles()) {\r\n            $('#themeLink').removeClass('hidden');\r\n        }\r\n\r\n        if (!structurizr.workspace.hasElements() && !structurizr.workspace.hasViews() && !structurizr.workspace.hasDocumentation() && !structurizr.workspace.hasDecisions()) {\r\n            <c:if test=\"${workspace.editable}\">\r\n            $('#gettingStarted').removeClass('hidden');\r\n            </c:if>\r\n            $('.workspaceContent').addClass('hidden');\r\n            $('#exportJsonLinkNavItem').addClass('hidden');\r\n        }\r\n\r\n        if (structurizr.workspace.getProperty('structurizr.dsl') === undefined) {\r\n            $('#exportDslLinkNavItem').addClass('hidden');\r\n        }\r\n\r\n        progressMessage.hide();\r\n    }\r\n\r\n    function formatDate(dateAsString) {\r\n        return new Date(dateAsString).toLocaleDateString('en-GB', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });\r\n    }\r\n\r\n    function revertToLoadedVersion() {\r\n        if (confirm('Are you sure you want to revert to this version?')) {\r\n            structurizrApiClient.resetRevision();\r\n            structurizr.saveWorkspace(function() {\r\n                const indexOfVersionParameter = window.location.href.indexOf('?version=');\r\n                if (indexOfVersionParameter > -1) {\r\n                    window.location.href = window.location.href.substr(0, indexOfVersionParameter);\r\n                } else {\r\n                    location.reload();\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    <c:if test=\"${workspace.editable eq true and workspace.locked eq true}\">\r\n    function unlockWorkspace(e) {\r\n        e.preventDefault();\r\n\r\n        if (confirm('${workspace.lockedUser} will lose any unsaved changes - are you sure you want to unlock this workspace?')) {\r\n            window.location.href = '/workspace/${workspace.id}/unlock';\r\n        }\r\n    }\r\n    </c:if>\r\n\r\n    function importWorkspaceFromFile(file, workspaceId) {\r\n        var reader = new FileReader();\r\n        reader.readAsText(file, \"UTF-8\");\r\n\r\n        reader.onload = function (evt) {\r\n            try {\r\n                var json = JSON.parse(evt.target.result);\r\n                json.id = workspaceId;\r\n            } catch(err) {\r\n                alert(\"Sorry, there was a problem reading the file: \" + err);\r\n                console.log(err);\r\n                return;\r\n            }\r\n\r\n            progressMessage.show('<p>Saving workspace...</p>');\r\n            structurizrEncryptionStrategy = undefined;\r\n            structurizrApiClient.resetRevision();\r\n            structurizrApiClient.putWorkspace(json, function(response) {\r\n                if (response.success) {\r\n                    window.location.reload();\r\n                } else {\r\n                    progressMessage.show('<p>' + response.message + '</p>');\r\n                }\r\n            });\r\n        };\r\n\r\n        reader.onerror = function (evt) {\r\n            alert(\"Sorry, there was a problem reading the file.\");\r\n        };\r\n    }\r\n\r\n    $(\"#workspaceVersion\").change(function () {\r\n        $('#revertButton').prop('disabled', true);\r\n    });\r\n</script>\r\n\r\n<c:choose>\r\n    <c:when test=\"${not empty workspaceAsJson}\">\r\n        <%@ include file=\"/WEB-INF/fragments/workspace/load-via-inline.jspf\" %>\r\n    </c:when>\r\n    <c:otherwise>\r\n        <%@ include file=\"/WEB-INF/fragments/workspace/load-via-api.jspf\" %>\r\n    </c:otherwise>\r\n</c:choose>"], "fixing_code": ["<%@ include file=\"/WEB-INF/fragments/workspace/javascript.jspf\" %>\r\n<script type=\"text/javascript\" src=\"${structurizrConfiguration.cdnUrl}/js/structurizr-ui${structurizrConfiguration.versionSuffix}.js\"></script>\r\n\r\n<style>\r\n    h2 {\r\n        margin-bottom: 20px;\r\n    }\r\n    .container {\r\n        width: auto;\r\n        margin-left: 30px;\r\n        margin-right: 30px;\r\n    }\r\n\r\n    #navigationPanel {\r\n        margin-top: 20px;\r\n    }\r\n\r\n    .navigationItem {\r\n        font-size: 14px;\r\n        margin-bottom: 10px;\r\n    }\r\n\r\n    .navigationItemHeading {\r\n        font-size: 30px;\r\n        margin-bottom: 20px;\r\n    }\r\n\r\n    .navigationItemSeparator {\r\n        margin-bottom: 40px;\r\n    }\r\n</style>\r\n\r\n<div class=\"row\" style=\"padding-bottom: 0; margin-left: 0; margin-right: 0\">\r\n\r\n    <div class=\"col-sm-2\" style=\"padding-left: 30px; margin-bottom: 100px\">\r\n        <div id=\"navigationPanel\" class=\"hidden-xs\">\r\n\r\n            <div class=\"navigationItemHeading\">\r\n                Workspace\r\n            </div>\r\n\r\n            <c:if test=\"${not empty param.version}\">\r\n            <div class=\"navigationItem\">\r\n                <span class=\"label label-version\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/clock-history.svg\" class=\"icon-xs icon-white\" /> <c:out value=\"${workspace.internalVersion}\" /></span>\r\n            </div>\r\n            </c:if>\r\n\r\n            <c:if test=\"${workspace.clientEncrypted}\">\r\n            <div class=\"navigationItem\">\r\n                <img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/file-earmark-lock.svg\" class=\"icon-sm\" /> Client-side encrypted\r\n            </div>\r\n            </c:if>\r\n\r\n            <c:if test=\"${fn:startsWith(urlPrefix, '/workspace')}\">\r\n            <div class=\"navigationItem\">\r\n                <a href=\"/workspace/${workspace.id}\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/lock.svg\" class=\"icon-sm\" /> Private link</a>\r\n            </div>\r\n\r\n            <c:if test=\"${workspace.shareable && workspace.ownerUserType.allowedToShareWorkspacesWithLink}\">\r\n            <div class=\"navigationItem\">\r\n                <a href=\"/share/${workspace.id}/${workspace.sharingToken}\" target=\"_blank\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/link.svg\" class=\"icon-sm\" /> Sharing link</a>\r\n            </div>\r\n            </c:if>\r\n\r\n            <c:if test=\"${workspace.open}\">\r\n            <div class=\"navigationItem\">\r\n                <a href=\"/share/${workspace.id}\" target=\"_blank\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/unlock.svg\" class=\"icon-sm\" /> Public link</a>\r\n            </div>\r\n            </c:if>\r\n\r\n            <div class=\"navigationItemSeparator\"></div>\r\n            </c:if>\r\n            \r\n            <c:if test=\"${fn:startsWith(urlPrefix, '/workspace') && structurizrConfiguration.dslEditorEnabled}\">\r\n            <div class=\"navigationItem dslEditorNavigation\">\r\n                <a href=\"<c:out value=\"${urlPrefix}\" />/dsl<c:out value=\"${urlSuffix}\" />\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/code-slash.svg\" class=\"icon-sm\" /> DSL editor</a>\r\n            </div>\r\n            </c:if>\r\n\r\n            <div id=\"diagramsLink\" class=\"navigationItem hidden\">\r\n            <a href=\"<c:out value=\"${urlPrefix}\" />/diagrams<c:out value=\"${urlSuffix}\" />\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/bounding-box.svg\" class=\"icon-sm\" /> Diagrams</a>\r\n            </div>\r\n\r\n            <div id=\"documentationLink\"  class=\"navigationItem hidden\">\r\n                <a href=\"<c:out value=\"${urlPrefix}\" />/documentation<c:out value=\"${urlSuffix}\" />\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/book.svg\" class=\"icon-sm\" /> Documentation</a>\r\n            </div>\r\n            <div id=\"decisionsLink\" class=\"navigationItem hidden\">\r\n                <a href=\"<c:out value=\"${urlPrefix}\" />/decisions<c:out value=\"${urlSuffix}\" />\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/journal-text.svg\" class=\"icon-sm\" /> Decisions</a>\r\n            </div>\r\n            <div id=\"exploreLink\" class=\"navigationItem hidden\">\r\n                <a href=\"<c:out value=\"${urlPrefix}\" />/explore<c:out value=\"${urlSuffix}\" />\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/diagram-3.svg\" class=\"icon-sm\" /> Explore</a>\r\n            </div>\r\n\r\n            <div id=\"themeLink\" class=\"navigationItem hidden\">\r\n                <a href=\"<c:out value=\"${urlPrefix}\" />/theme<c:out value=\"${urlSuffix}\" />\" target=\"_blank\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/palette.svg\" class=\"icon-sm\" /> Theme</a>\r\n            </div>\r\n\r\n            <div id=\"imagesLink\" class=\"navigationItem hidden\">\r\n                <a href=\"<c:out value=\"${urlPrefix}\" />/images\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/filetype-png.svg\" class=\"icon-sm\" /> Published images</a>\r\n            </div>\r\n\r\n            <div id=\"exportJsonLinkNavItem\" class=\"navigationItem\">\r\n                <a id=\"exportJsonLink\" href=\"\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/filetype-json.svg\" class=\"icon-sm\" /> Export JSON</a>\r\n            </div>\r\n\r\n            <div id=\"exportDslLinkNavItem\" class=\"navigationItem\">\r\n                <a id=\"exportDslLink\" href=\"\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/filetype-txt.svg\" class=\"icon-sm\" /> Export DSL</a>\r\n            </div>\r\n\r\n            <c:if test=\"${workspace.editable && not workspace.locked}\">\r\n            <div class=\"navigationItem\">\r\n                <a id=\"importJsonLink1\" href=\"\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/upload.svg\" class=\"icon-sm\" /> Import JSON</a>\r\n                <input id=\"importFromJsonControl\" type=\"file\" style=\"display: none;\" />\r\n            </div>\r\n            </c:if>\r\n\r\n            <div class=\"navigationItemSeparator\"></div>\r\n            <c:if test=\"${fn:startsWith(urlPrefix, '/workspace')}\">\r\n            <div class=\"navigationItem\">\r\n                <a href=\"<c:out value=\"${urlPrefix}\" />/settings\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/gear.svg\" class=\"icon-sm\" /> Settings</a>\r\n            </div>\r\n\r\n            <c:if test=\"${workspace.editable eq true and workspace.locked eq true}\">\r\n            <div class=\"navigationItem\">\r\n                <a id=\"unlockWorkspaceLink\" href=\"\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/unlock.svg\" class=\"icon-sm\" /> Unlock</a>\r\n            </div>\r\n            </c:if>\r\n\r\n            <div class=\"navigationItem\">\r\n                <a href=\"<c:out value=\"${urlPrefix}\" />/users\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/people.svg\" class=\"icon-sm\" /> Users</a>\r\n            </div>\r\n            </c:if>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"col-sm-10\">\r\n        <div class=\"section\" style=\"padding-bottom: 20px\">\r\n            <div class=\"container centered\">\r\n                <h1><span id=\"workspaceName\" class=\"workspace${workspace.id}Name\"><c:out value=\"${workspace.name}\" escapeXml=\"true\" /></span></h1>\r\n                <p id=\"workspaceDescription\" class=\"workspace${workspace.id}Description\">\r\n                    <c:out value=\"${workspace.description}\" escapeXml=\"true\" />\r\n                </p>\r\n\r\n                <p class=\"workspaceMetaData\">\r\n                    <c:if test=\"${empty param.version}\">\r\n                    Last modified: <fmt:formatDate value=\"${workspace.lastModifiedDate}\" pattern=\"EEE dd MMM yyyy HH:mm:ss z\" timeZone=\"${user.timeZone}\" />\r\n                    <c:if test=\"${workspace.editable eq true}\">by ${workspace.lastModifiedUser} using ${workspace.lastModifiedAgent}</c:if>\r\n\r\n                    <c:if test=\"${not empty workspace.version}\">\r\n                    | Version: ${workspace.version}\r\n                    </c:if>\r\n                    <c:if test=\"${workspace.size gt 0}\">\r\n                    |\r\n                    Size: <fmt:formatNumber minFractionDigits=\"2\" maxFractionDigits=\"2\" value=\"${workspace.sizeInMegaBytes}\" /> MB\r\n                    </c:if>\r\n                    </c:if>\r\n                </p>\r\n\r\n                <c:if test=\"${fn:startsWith(urlPrefix, '/workspace') && not empty versions}\">\r\n                <div class=\"centered\" style=\"margin-top: 20px\">\r\n                    <form class=\"form-inline\" style=\"display: inline-block\" method=\"get\" action=\"<c:out value=\"${urlPrefix}\" />\">\r\n                        <select id=\"workspaceVersion\" name=\"version\" class=\"form-control\">\r\n                            <c:forEach var=\"version\" items=\"${versions}\">\r\n                                <option value=\"${version.versionId}\"><fmt:formatDate value=\"${version.lastModifiedDate}\" pattern=\"EEE dd MMM yyyy HH:mm:ss z\" timeZone=\"${user.timeZone}\" /></option>\r\n                            </c:forEach>\r\n                        </select>\r\n                        <input type=\"submit\" class=\"btn btn-default\" value=\"Load version\" style=\"height: 35.5px\"/>\r\n                    </form>\r\n                    <c:if test=\"${not empty param.version && workspace.editable && not workspace.locked}\">\r\n                        <button id=\"revertButton\" class=\"btn btn-default small\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/clock-history.svg\" class=\"icon-btn\" /> Revert to <c:out value=\"${workspace.internalVersion}\" /></button>\r\n                    </c:if>\r\n                </div>\r\n                </c:if>\r\n\r\n                <div id=\"gettingStarted\" class=\"centered hidden\">\r\n                    <c:if test=\"${workspace.editable && not workspace.locked}\">\r\n                    <br />\r\n                    <p>\r\n                        This is your workspace summary page, and from here you can access your diagrams, documentation, and architecture decision records.\r\n                        We recommend that a workspace contains the model, views, and documentation for a single software system\r\n                        - see <a href=\"https://structurizr.com/help/usage-recommendations\" target=\"_blank\">usage recommendations</a> for more details.\r\n                        This workspace is empty, and you can use one of the following authoring options to create content.\r\n                    </p>\r\n\r\n                    <div class=\"row\" style=\"margin-top: 20px; margin-bottom: 20px\">\r\n                        <div class=\"col-sm-4 centered\">\r\n                            <div style=\"padding: 10px; margin: 10px\">\r\n                                <div style=\"margin-top: 5px; font-size: 20px\">\r\n                                    <a href=\"<c:out value=\"${urlPrefix}\" />/dsl\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/code-slash.svg\" class=\"icon-lg\"/> DSL editor</a>\r\n                                </div>\r\n                                <div class=\"small\">\r\n                                    Open the online DSL editor, and create your workspace using the Structurizr DSL.\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-sm-4 centered\">\r\n                            <div style=\"padding: 10px; margin: 10px\">\r\n                                <div style=\"margin-top: 5px; font-size: 20px\">\r\n                                    <a id=\"importJsonLink2\" href=\"\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/upload.svg\" class=\"icon-lg\" /> Import JSON</a>\r\n                                </div>\r\n                                <div class=\"small\">\r\n                                    Import an existing workspace from a JSON file.\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"col-sm-4 centered\">\r\n                            <div style=\"padding: 10px; margin: 10px\">\r\n                                <div style=\"margin-top: 5px; font-size: 20px\">\r\n                                    <a href=\"<c:out value=\"${urlPrefix}\" />/settings#api\"><img src=\"${structurizrConfiguration.cdnUrl}/bootstrap-icons/gear.svg\" class=\"icon-lg\" /> Settings</a>\r\n                                </div>\r\n                                <div class=\"small\">\r\n                                    Use the workspace settings page to find your API key/secret, for uploading your workspace with the Structurizr CLI or code-based libraries.\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    </c:if>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"section workspaceContent\">\r\n            <div class=\"container centered\">\r\n                <div id=\"diagrams\"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<%@ include file=\"/WEB-INF/fragments/progress-message.jspf\" %>\r\n\r\n<script nonce=\"${scriptNonce}\">\r\n\r\n    progressMessage.show('<p>Loading workspace...</p>');\r\n\r\n    $('#unlockWorkspaceLink').click(function(event) { unlockWorkspace(event); });\r\n\r\n    <c:if test=\"${not empty param.version}\">\r\n    $('#workspaceVersion').val(\"<c:out value=\"${workspace.internalVersion}\" />\");\r\n    </c:if>\r\n\r\n    function addOnClickHandler(domId, handler) {\r\n        var element = document.getElementById(domId);\r\n        if (element) {\r\n            element.onclick = handler;\r\n        }\r\n    }\r\n\r\n    addOnClickHandler('revertButton', revertToLoadedVersion);\r\n\r\n    addOnClickHandler('exportJsonLink', function(e) {\r\n        structurizr.util.exportWorkspace(structurizr.workspace.id, structurizr.workspace.getJson());\r\n        e.preventDefault();\r\n    });\r\n\r\n    addOnClickHandler('exportDslLink', function(e) {\r\n        var dslSource = structurizr.workspace.getProperty('structurizr.dsl');\r\n        if (dslSource !== undefined) {\r\n            dslSource = structurizr.util.atob(dslSource);\r\n            const filename = 'structurizr-' + structurizr.workspace.id + '-workspace.dsl';\r\n            structurizr.util.downloadFile(dslSource, \"text/plain;charset=utf-8\", filename);\r\n        }\r\n\r\n        e.preventDefault();\r\n    });\r\n\r\n    addOnClickHandler('importJsonLink1', function(e) {\r\n        $('#importFromJsonControl').trigger('click');\r\n        e.preventDefault();\r\n    });\r\n\r\n    addOnClickHandler('importJsonLink2', function(e) {\r\n        $('#importFromJsonControl').trigger('click');\r\n        e.preventDefault();\r\n    });\r\n\r\n    var importFromJsonControl = document.getElementById('importFromJsonControl');\r\n    if (importFromJsonControl) {\r\n        importFromJsonControl.onchange = function() {\r\n            importWorkspaceFromFile(importFromJsonControl.files[0], structurizr.workspace.id);\r\n        };\r\n    }\r\n\r\n    function workspaceLoaded() {\r\n        if (structurizr.workspace.getProperty('structurizr.dslEditor') === 'false') {\r\n            $('.dslEditorNavigation').addClass('hidden');\r\n        }\r\n\r\n        $('#workspaceName').html(structurizr.util.escapeHtml(structurizr.workspace.name));\r\n        $('#workspaceDescription').html(structurizr.util.escapeHtml(structurizr.workspace.description));\r\n        var diagramsDiv = $('#diagrams');\r\n\r\n        structurizr.ui.applyBranding();\r\n\r\n        if (structurizr.workspace.hasViews()) {\r\n            var maxNumberOfViews = 10;\r\n            var count = 1;\r\n            var views = structurizr.workspace.getViews();\r\n            const thumbnailSize = 200;\r\n            var html = '';\r\n\r\n            views.forEach(function(view) {\r\n                var url = '<c:out value=\"${urlPrefix}\" />/diagrams<c:out value=\"${urlSuffix}\" />#' + structurizr.util.escapeHtml(view.key);\r\n                var title = structurizr.util.escapeHtml(structurizr.ui.getTitleForView(view));\r\n\r\n                if (count <= maxNumberOfViews) {\r\n                    html += '<div class=\"centered\" style=\"display: inline-block; margin: 10px 10px 40px 10px; width: ' + thumbnailSize + 'px;\">';\r\n\r\n                    if (view.type === structurizr.constants.IMAGE_VIEW_TYPE) {\r\n                        html += '  <a href=\"' + url + '\"><img src=\"' + view.content + '\" class=\"img-thumbnail viewThumbnail\" style=\"margin-bottom: 10px; max-height: ' + thumbnailSize + 'px\" /></a>';\r\n                    } else {\r\n                    <c:choose>\r\n                    <c:when test=\"${not empty param.version}\">\r\n                    html += '  <a href=\"' + url + '\"><img src=\"/static/img/thumbnail-not-available.png\" class=\"img-thumbnail\" style=\"margin-bottom: 10px\" /></a>';\r\n                    </c:when>\r\n                    <c:otherwise>\r\n                    html += '  <a href=\"' + url + '\"><img src=\"${thumbnailUrl}' + structurizr.util.escapeHtml(view.key) + '-thumbnail.png\" class=\"img-thumbnail viewThumbnail\" style=\"margin-bottom: 10px; max-height: ' + thumbnailSize + 'px\" /></a>';\r\n                    </c:otherwise>\r\n                    </c:choose>\r\n                    }\r\n\r\n                    html += '  <div class=\"smaller\">';\r\n                    html += '    <a href=\"' + url + '\">' + title + '</a><br />';\r\n                    html += '    #' + structurizr.util.escapeHtml(view.key) + '';\r\n                    html += '  </div>';\r\n                    html += '</div>';\r\n                }\r\n                count++;\r\n            });\r\n\r\n            if (views.length > maxNumberOfViews) {\r\n                html += '<div class=\"small\"><a href=\"<c:out value=\"${urlPrefix}\" />/diagrams<c:out value=\"${urlSuffix}\" />\">More diagrams...</a></div>';\r\n            }\r\n\r\n            diagramsDiv.addClass('centered');\r\n            diagramsDiv.append(html);\r\n\r\n            $('.viewThumbnail').on('error', function() {\r\n                $(this).on('error', undefined);\r\n                $(this).attr('src', '/static/img/thumbnail-not-available.png');\r\n            });\r\n\r\n            $('#diagramsLink').removeClass('hidden');\r\n            $('#imagesLink').removeClass('hidden');\r\n        }\r\n\r\n        if (structurizr.workspace.hasDocumentation()) {\r\n            $('#documentationLink').removeClass('hidden');\r\n        }\r\n\r\n        if (structurizr.workspace.hasDecisions()) {\r\n            $('#decisionsLink').removeClass('hidden');\r\n        }\r\n\r\n        if (structurizr.workspace.hasElements()) {\r\n            $('#exploreLink').removeClass('hidden');\r\n        }\r\n\r\n        if (structurizr.workspace.hasStyles()) {\r\n            $('#themeLink').removeClass('hidden');\r\n        }\r\n\r\n        if (!structurizr.workspace.hasElements() && !structurizr.workspace.hasViews() && !structurizr.workspace.hasDocumentation() && !structurizr.workspace.hasDecisions()) {\r\n            <c:if test=\"${workspace.editable}\">\r\n            $('#gettingStarted').removeClass('hidden');\r\n            </c:if>\r\n            $('.workspaceContent').addClass('hidden');\r\n            $('#exportJsonLinkNavItem').addClass('hidden');\r\n        }\r\n\r\n        if (structurizr.workspace.getProperty('structurizr.dsl') === undefined) {\r\n            $('#exportDslLinkNavItem').addClass('hidden');\r\n        }\r\n\r\n        progressMessage.hide();\r\n    }\r\n\r\n    function formatDate(dateAsString) {\r\n        return new Date(dateAsString).toLocaleDateString('en-GB', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });\r\n    }\r\n\r\n    function revertToLoadedVersion() {\r\n        if (confirm('Are you sure you want to revert to this version?')) {\r\n            structurizrApiClient.resetRevision();\r\n            structurizr.saveWorkspace(function() {\r\n                const indexOfVersionParameter = window.location.href.indexOf('?version=');\r\n                if (indexOfVersionParameter > -1) {\r\n                    window.location.href = window.location.href.substr(0, indexOfVersionParameter);\r\n                } else {\r\n                    location.reload();\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    <c:if test=\"${workspace.editable eq true and workspace.locked eq true}\">\r\n    function unlockWorkspace(e) {\r\n        e.preventDefault();\r\n\r\n        if (confirm('${workspace.lockedUser} will lose any unsaved changes - are you sure you want to unlock this workspace?')) {\r\n            window.location.href = '/workspace/${workspace.id}/unlock';\r\n        }\r\n    }\r\n    </c:if>\r\n\r\n    function importWorkspaceFromFile(file, workspaceId) {\r\n        var reader = new FileReader();\r\n        reader.readAsText(file, \"UTF-8\");\r\n\r\n        reader.onload = function (evt) {\r\n            try {\r\n                var json = JSON.parse(evt.target.result);\r\n                json.id = workspaceId;\r\n            } catch(err) {\r\n                alert(\"Sorry, there was a problem reading the file: \" + err);\r\n                console.log(err);\r\n                return;\r\n            }\r\n\r\n            progressMessage.show('<p>Saving workspace...</p>');\r\n            structurizrEncryptionStrategy = undefined;\r\n            structurizrApiClient.resetRevision();\r\n            structurizrApiClient.putWorkspace(json, function(response) {\r\n                if (response.success) {\r\n                    window.location.reload();\r\n                } else {\r\n                    progressMessage.show('<p>' + response.message + '</p>');\r\n                }\r\n            });\r\n        };\r\n\r\n        reader.onerror = function (evt) {\r\n            alert(\"Sorry, there was a problem reading the file.\");\r\n        };\r\n    }\r\n\r\n    $(\"#workspaceVersion\").change(function () {\r\n        $('#revertButton').prop('disabled', true);\r\n    });\r\n</script>\r\n\r\n<c:choose>\r\n    <c:when test=\"${not empty workspaceAsJson}\">\r\n        <%@ include file=\"/WEB-INF/fragments/workspace/load-via-inline.jspf\" %>\r\n    </c:when>\r\n    <c:otherwise>\r\n        <%@ include file=\"/WEB-INF/fragments/workspace/load-via-api.jspf\" %>\r\n    </c:otherwise>\r\n</c:choose>"], "filenames": ["structurizr-onpremises/src/main/webapp/WEB-INF/views/workspace-summary.jsp"], "buggy_code_start_loc": [44], "buggy_code_end_loc": [333], "fixing_code_start_loc": [44], "fixing_code_end_loc": [333], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Reflected in GitHub repository structurizr/onpremises prior to 3194.", "other": {"cve": {"id": "CVE-2023-5556", "sourceIdentifier": "security@huntr.dev", "published": "2023-10-12T11:15:23.873", "lastModified": "2023-10-16T19:23:44.070", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Reflected in GitHub repository structurizr/onpremises prior to 3194."}, {"lang": "es", "value": "Cross-Site Scripting (XSS) Reflejado en el repositorio de GitHub structurizr/onpremises anterior a 3194."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:structurizr:on-premises_installation:*:*:*:*:*:*:*:*", "versionEndExcluding": "3194", "matchCriteriaId": "07AE3041-EDE4-4566-8EFC-33814E884BDE"}]}]}], "references": [{"url": "https://github.com/structurizr/onpremises/commit/6cff4f792b010dfb1ff6a0b4ae1c6e398f8f8a18", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.dev/bounties/a3ee0f98-6898-41ae-b1bd-242a03a73d1b", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/structurizr/onpremises/commit/6cff4f792b010dfb1ff6a0b4ae1c6e398f8f8a18"}}