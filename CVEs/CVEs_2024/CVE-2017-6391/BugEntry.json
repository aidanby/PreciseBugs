{"buggy_code": ["<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\" />\n<title>AkamaiBroadcaster_v1.1</title>\n<script language=\"javascript\">AC_FL_RunContent = 0;</script>\n<script src=\"../js/AC_RunActiveContent.js\" language=\"javascript\"></script>\n</head>\n<body bgcolor=\"#ffffff\">\n<!--url's used in the movie-->\n<!--text used in the movie-->\n<!-- saved from url=(0013)about:internet -->\n<script language=\"javascript\">\n\n\t\n\tvar flashVars = 'cpcode=<?php echo $_GET['streamUsername']; ?>';\n\tflashVars += '&passwd=<?php echo $_GET['streamPassword']; ?>';\n\tflashVars += '&streamname=<?php echo $_GET['entryId']; ?>@<?php echo $_GET['streamRemoteId']; ?>';\n\tflashVars += '&primaryep=p.ep<?php echo $_GET['streamRemoteId']; ?>.i.akamaientrypoint.net';\n\tflashVars += '&backupep=b.ep<?php echo $_GET['streamRemoteBackupId']; ?>.i.akamaientrypoint.net';\n\t\n\n\tif (AC_FL_RunContent == 0) {\n\t\talert(\"This page requires AC_RunActiveContent.js. In Flash, run \\\"Apply Active Content Update\\\" in the Commands menu to copy AC_RunActiveContent.js to the HTML output folder.\");\n\t} else {\n\t\tAC_FL_RunContent(\n\t\t\t'codebase', 'http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0',\n\t\t\t'width', '760',\n\t\t\t'height', '744',\n\t\t\t'src', 'AkamaiBroadcaster_v1.1',\n\t\t\t'quality', 'best',\n\t\t\t'pluginspage', 'http://www.macromedia.com/go/getflashplayer',\n\t\t\t'align', 'middle',\n\t\t\t'play', 'true',\n\t\t\t'loop', 'false',\n\t\t\t'scale', 'showall',\n\t\t\t'wmode', 'window',\n\t\t\t'devicefont', 'false',\n\t\t\t'id', 'AkamaiBroadcaster_v1.1',\n\t\t\t'bgcolor', '#ffffff',\n\t\t\t'name', 'AkamaiBroadcaster_v1.1',\n\t\t\t'menu', 'true',\n\t\t\t'allowScriptAccess','sameDomain',\n\t\t\t'movie', 'AkamaiBroadcaster_v1.1',\n\t\t\t'salign', '',\n\t\t\t'flashvars', flashVars\n\t\t\t); //end AC code\n\t}\n</script>\n</body>\n</html>\n", "<html>\n  <body>\n    <div id=\"jw_wrap_1267721422280\">\n      <object width=\"400\" height=\"319\" id=\"jw_player_1267721422280\"\n      name=\"jw_player_1267721422280\">\n        <param name=\"movie\"\n        value=\"non-commercial.swf\" />\n        <param name=\"wmode\" value=\"transparent\" />\n        <param name=\"allowScriptAccess\" value=\"always\" />\n        <param name=\"flashvars\" value=\"file=<?php echo $_GET['entryId']; ?>_1@<?php echo $_GET['streamRemoteId']; ?>&subscribe=true&streamer=rtmp://cp<?php echo $_GET['streamUsername']; ?>.live.edgefcs.net/live/&type=fcsubscribe\" />\n        <embed id=\"jw_player__1267721422280\"\n        name=\"jw_player__1267721422280\"\n        src=\"non-commercial.swf\"\n        width=\"400\" height=\"319\" allowfullscreen=\"true\"\n        wmode=\"transparent\" allowscriptaccess=\"always\"\n        flashvars=\"file=<?php echo $_GET['entryId']; ?>_1@<?php echo $_GET['streamRemoteId']; ?>&subscribe=true&streamer=rtmp://cp<?php echo $_GET['streamUsername']; ?>.live.edgefcs.net/live/&type=fcsubscribe\" />\n        <noembed>\n          <a href=\"http://www.kaltura.org/\">Open Source Video</a>\n        </noembed>\n      </object>\n    </div>\n  </body>\n</html>\n", "<html>\n  <body>\n    <div id=\"jw_wrap_1267721422280\">\n      <object width=\"400\" height=\"319\" id=\"jw_player_1267721422280\"\n      name=\"jw_player_1267721422280\">\n        <param name=\"movie\"\n        value=\"non-commercial.swf\" />\n        <param name=\"wmode\" value=\"transparent\" />\n        <param name=\"allowScriptAccess\" value=\"always\" />\n        <param name=\"flashvars\" value=\"config=/index.php/extwidget/streamclipper?entryId=<?php echo $_GET['entryId']; ?>\" />\n        <embed id=\"jw_player__1267721422280\"\n        name=\"jw_player__1267721422280\"\n        src=\"non-commercial.swf\"\n        width=\"400\" height=\"319\" allowfullscreen=\"true\"\n        wmode=\"transparent\" allowscriptaccess=\"always\" \n        flashvars=\"config=/index.php/extwidget/streamclipper?entryId=<?php echo $_GET['entryId']; ?>\" />\n        <noembed>\n          <a href=\"http://www.kaltura.org/\">Open Source Video</a>\n        </noembed>\n      </object>\n    </div>\n  </body>\n</html>\n", "<?php \nif(!isset($_GET['partnerId']))\n\tdie('partnerId must be supplied in query string');\n\t\nif(!isset($_GET['playerVersion']))\n\tdie('html5 lib version must be supplied in query string');\n\n$partnerId = $_GET['partnerId'];\n\n$html5Version = $_GET['playerVersion'];\n?>\n<!DOCTYPE html>\n<!--[if lt IE 7]>      <html class=\"lt-ie10 lt-ie9 lt-ie8 lt-ie7\"> <![endif]-->\n<!--[if IE 7]>         <html class=\"lt-ie10 lt-ie9 lt-ie8\"> <![endif]-->\n<!--[if IE 8]>         <html class=\"lt-ie10 lt-ie9\"> <![endif]-->\n<!--[if lt IE 10]>     <html class=\"lt-ie10\"> <![endif]-->\n<!--[if gt IE 8]><!--> <html> <!--<![endif]-->\n<head>\n\t<meta charset=\"utf-8\">\n\t<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n\t\n\t<title>Big-Red-Button Demo</title>\n\t<link type=\"text/css\" rel=\"stylesheet\" href=\"/lib/css/kmc.css\" />\n\t<style>\n\t\t#main .content .title h1 { font-size: 24px; font-weight: bold; }\n\t\t#main p { margin-bottom: 20px; font-size: 18px; }\n\t</style>\n\t\n\t<script src=\"/lib/js/jquery-1.8.3.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"/html5/html5lib/<?php echo $html5Version; ?>/mwEmbedLoader.php\"></script>\n\t<script type=\"text/javascript\" src=\"swfobject.js\"></script>\n\t<script>\n\t\tvar partnerId = <?php echo $partnerId; ?>;\n\t\tvar ks = null;\n\t\tvar lastSyncPointTime = null;\n\t\tvar lastSyncPointOffset = null;\n\t\tvar lastSyncPointTimestamp = null;\n\n\t\tfunction loadPlayer(){\n\t\t\tvar entryId = $('#txtEntryId').val();\n\t\t\tvar uiConfId = $('#txtUiConfId').val();\n\n\t\t\tvar hlsUrl = location.protocol + '//';\n\t\t\thlsUrl += location.host;\n\t\t\thlsUrl += '/p/' + partnerId + '/playManifest/format/applehttp';\n\t\t\thlsUrl += '/entryId/' + entryId;\n\n\t\t\tvar stitchedUrl = hlsUrl;\n\n\t\t\thlsUrl += '/a/playlist.m3u8';\n\t\t\tstitchedUrl += '/uiConfId/' + uiConfId;\n\t\t\tstitchedUrl += '/usePlayServer/1/a/playlist.m3u8';\n\n\t\t\tvar hdsUrl = location.protocol + '//';\n\t\t\thdsUrl += location.host;\n\t\t\thdsUrl += '/p/' + partnerId + '/playManifest/format/hds';\n\t\t\thdsUrl += '/entryId/' + entryId;\n\t\t\thdsUrl += '/a/a.f4m';\n\n\t\t\tvar html = '<b>HLS URL:</b> <a href=\"' + hlsUrl + '\" target=\"_tab\">' + hlsUrl + '</a><br/>';\n\t\t\thtml += '<b>Stitched URL:</b> <a href=\"' + stitchedUrl + '\" target=\"_tab\">' + stitchedUrl + '</a><br/>';\n\t\t\thtml += '<b>HDS URL:</b> <a href=\"' + hdsUrl + '\" target=\"_tab\">' + hdsUrl + '</a>';\n\t\t\t$('#lblUrl').html(html);\n\n\t\t\t mw.setConfig('Kaltura.LeadWithHTML5', true);\n\t\t\tloadAdminPlayer(entryId, uiConfId);\n\t\t\tloadUserPlayer(entryId, uiConfId);\n\t\t\tstartSession();\n\t\t}\n\n\t\tfunction startSession(){\n\t\t\tvar secret = $('#txtSecret').val();\n\n\t\t\t$.ajax(\n\t\t\t\t'/api_v3/index.php/service/session/action/start', {\n\t\t\t\tdata: {\n\t\t\t\t\tformat: 1,\n\t\t\t\t\tpartnerId: partnerId,\n\t\t\t\t\tsecret: secret,\n\t\t\t\t\ttype: 2\n\t\t\t\t},\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\n\t\t\t\t\talert(errorThrown);\n\t\t\t\t},\n\t\t\t\tsuccess: function(data, textStatus, jqXHR){\n\t\t\t\t\tif(data.code && data.message){\n\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\tks = data;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfunction loadUserPlayer(entryId, uiConfId){\n            kWidget.embed({\n                    targetId: 'userPlayerContainer',\n                    wid: '_' + partnerId,\n                    \"uiconf_id\": uiConfId,\n                    \"flashvars\": {\n                            \"streamerType\": \"auto\",\n                            \"autoPlay\": true,\n                            \"LeadWithHLSOnFlash\": true,\n\t\t\t\t\t\t\t\"Kaltura.Protocol\":\"http\"\n                    },\n                    \"cache_st\": 1410340114,\n                    \"entry_id\": entryId\n            });\n\t\t}\n\n\t\tfunction loadAdminPlayer(entryId, uiConfId){\n\t\t     kWidget.embed({\n\t\t\t\t\t targetId: 'adminPlayerContainer',\n\t\t\t\t\t wid: '_' + partnerId,\n\t\t\t\t\t \"uiconf_id\": uiConfId,\n\t\t\t\t\t \"flashvars\": {\n\t\t\t\t\t\t \t \"playServerUrls\": {\"plugin\": false},\n\t\t\t\t\t\t\t \"streamerType\": \"hds\",\n\t\t\t\t\t\t\t \"autoPlay\": true,\n\t\t\t\t\t\t\t \"forceHDS\": true,\n\t\t\t\t\t\t\t \"LeadWithHLSOnFlash\": false\n\t\t\t\t\t },\n\t\t\t\t\t \"cache_st\": 1410340114,\n\t\t\t\t\t \"entry_id\": entryId,\n\t\t\t\t\t \"readyCallback\": function( playerId ){\n\t\t\t\t\t\tvar adminKdp = document.getElementById( playerId );\n\t\t\t\t\t\tadminKdp.addJsListener( 'videoMetadataReceived', 'onSyncPoint' );\n\t\t\t\t\t\tadminKdp.addJsListener( 'onId3Tag', 'onSyncPoint' );\n\t\t\t\t\t}\n\t\t\t });\n\t\t}\n\n\t\tfunction onSyncPoint(metadata){\n\t\t\tif ( metadata && metadata.objectType == \"KalturaSyncPoint\") {\n\t\t\t\tif(lastSyncPointTimestamp && lastSyncPointTimestamp >= metadata.timestamp)\n\t\t\t\t\treturn;\n\t\t\t\tvar date = new Date();\n\t\t\t\tlastSyncPointTime = date.getTime();\n\t\t\t\tlastSyncPointTimestamp = metadata.timestamp;\n\t\t\t\t$('#last_cue_point_time').html(new Date(lastSyncPointTimestamp).toUTCString());\n\n\t\t\t\t$('#btnSendAd').removeAttr('disabled');\n\t\t\t\tlog('Ads Enabled last offset:' + lastSyncPointOffset + ' last timestamp: ' + lastSyncPointTimestamp);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction enableAds(){\n\t\t\tif(!ks){\n\t\t\t\talert('kaltura API is not enabled');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar interval = $('#txtSyncPointInterval').val();\n\t\t\tvar duration = $('#txtSyncPointDuration').val();\n\t\t\tvar entryId = $('#txtEntryId').val();\n\t\t\t\n\t\t\t$.ajax(\n\t\t\t\t'/api_v3/index.php/service/liveStream/action/createPeriodicSyncPoints', {\n\t\t\t\tdata: {\n\t\t\t\t\tformat: 1,\n\t\t\t\t\tks: ks,\n\t\t\t\t\tentryId: entryId,\n\t\t\t\t\tinterval: interval,\n\t\t\t\t\tduration: duration\n\t\t\t\t},\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\n\t\t\t\t\talert(errorThrown);\n\t\t\t\t},\n\t\t\t\tsuccess: function(data, textStatus, jqXHR){\n\t\t\t\t\tif(data && data.code && data.message){\n\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfunction sendAd(){\n\t\t\tvar date = new Date();\n\t\t\tvar timeSinceLastSyncPoint = date.getTime() - lastSyncPointTime;\n\n\t\t\tvar entryId = $('#txtEntryId').val();\n\t\t\tvar adUrl = $('#txtAdUrl').val();\n\t\t\tvar duration = $('#txtAdDuration').val();\n\t\t\tvar cuePointType = $('#cuePointType').val();\n\n\t\t\tif(cuePointType == 'offset'){\n\t\t\t\tvar startTime = lastSyncPointOffset + timeSinceLastSyncPoint;\n\t\t\t\t$.ajax(\n\t\t\t\t\t\t'/api_v3/index.php/service/cuePoint_cuePoint/action/add', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tformat: 1,\n\t\t\t\t\t\t\tks: ks,\n\t\t\t\t\t\t\t'cuePoint:objectType': 'KalturaAdCuePoint',\n\t\t\t\t\t\t\t'cuePoint:entryId': entryId,\n\t\t\t\t\t\t\t'cuePoint:startTime': startTime,\n\t\t\t\t\t\t\t'cuePoint:protocolType': 'VPAID',\n\t\t\t\t\t\t\t'cuePoint:sourceUrl': adUrl,\n\t\t\t\t\t\t\t'cuePoint:adType': 1, // VIDEO\n\t\t\t\t\t\t\t'cuePoint:title': 'Test Cue-Point',\n\t\t\t\t\t\t\t'cuePoint:duration': duration\n\t\t\t\t\t\t},\n\t\t\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\n\t\t\t\t\t\t\talert(errorThrown);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function(data, textStatus, jqXHR){\n\t\t\t\t\t\t\tif(data.code && data.message){\n\t\t\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlog('Cue-Point created [' + data.id + '] startTime [' + startTime + '] timeSinceLastSyncPoint [' + timeSinceLastSyncPoint +']');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tvar delay = $('#txtAdDelay').val();\n\t\t\t\tvar triggeredAt = (lastSyncPointTimestamp + timeSinceLastSyncPoint + parseInt(delay)) / 1000;\n\n\t\t\t\t$.ajax(\n\t\t\t\t\t'/api_v3/index.php/service/cuePoint_cuePoint/action/add', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tformat: 1,\n\t\t\t\t\t\tks: ks,\n\t\t\t\t\t\t'cuePoint:objectType': 'KalturaAdCuePoint',\n\t\t\t\t\t\t'cuePoint:entryId': entryId,\n\t\t\t\t\t\t'cuePoint:triggeredAt': triggeredAt,\n\t\t\t\t\t\t'cuePoint:protocolType': 'VPAID',\n\t\t\t\t\t\t'cuePoint:sourceUrl': adUrl,\n\t\t\t\t\t\t'cuePoint:adType': 1, // VIDEO\n\t\t\t\t\t\t'cuePoint:title': 'Test Cue-Point',\n\t\t\t\t\t\t'cuePoint:duration': duration\n\t\t\t\t\t},\n\t\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\n\t\t\t\t\t\talert(errorThrown);\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: function(data, textStatus, jqXHR){\n\t\t\t\t\t\tif(data.code && data.message){\n\t\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlog('Cue-Point created [' + data.id + '] triggeredAt [' + triggeredAt + '] timeSinceLastSyncPoint [' + timeSinceLastSyncPoint +']');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfunction selectCuePointType(type){\n\t\t\tif(type == 'offset'){\n\t\t\t\t$('#txtAdDelay').attr(\"disabled\", \"disabled\");\n\t\t\t}\n\t\t\telse{\n\t\t\t\t$('#txtAdDelay').removeAttr(\"disabled\");\n\t\t\t}\n\t\t}\n\n\t\tfunction log(log){\n\t\t\t$('#eraLog').val(log + '\\n' + $('#eraLog').val());\n\t\t}\n\n\t\tfunction updateSystemTime()\n\t\t{\n\t\t\tvar currentTime = new Date();\n\t\t\tsetTimeout(\"updateSystemTime()\",500);\n\t\t\t$('#current_system_time').html(currentTime.toUTCString());\n\t\t}\n\t</script>\n</head>\n<body onload=\"updateSystemTime()\">\n<div id=\"main\" style=\"position: static;\">\n\t<div class=\"content\">\n\t\t<div class=\"title\">\n\t\t\t<h1>Big-Red-Button Demo</h1>\n\t\t</div>\n\t\t<div class=\"contwrap\">\n\t\t\t<p></p>\n\t\t\t<table>\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th>Admin Player</th>\n\t\t\t\t\t\t<th></th>\n\t\t\t\t\t\t<th>User Player</th>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td><div id=\"adminPlayerContainer\" style=\"width: 400px; height: 333px;\" /></td>\n\t\t\t\t\t\t<td><textarea id=\"eraLog\" style=\"width: 400px; height: 333px;\"></textarea></td>\n\t\t\t\t\t\t<td><div id=\"userPlayerContainer\" style=\"width: 400px; height: 333px;\" /></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</div><!-- end contwrap -->\n\t</div><!-- end content -->\n\t<div id=\"lblUrl\"></div>\n\t<br/>\n\t<table>\n\t\t<tr>\n\t\t\t<td>Current PC Time</td>\n\t\t\t<td><div id=\"current_system_time\">&nbsp;</div></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>Last sync point time</td>\n\t\t\t<td><div id=\"last_cue_point_time\">&nbsp;</div></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>Admin Secret:</td>\n\t\t\t<td><input type=\"text\" id=\"txtSecret\" value=\"<?php echo isset($_GET['secret']) ? $_GET['secret'] : ''; ?>\" />\n\t\t</td>\n\t\t<tr>\n\t\t\t<td>Entry Id:</td>\n\t\t\t<td><input type=\"text\" id=\"txtEntryId\" value=\"<?php echo isset($_GET['entryId']) ? $_GET['entryId'] : ''; ?>\" />\n\t\t</td>\n\t\t<tr>\n        \t<td>uiConf Id:</td>\n            <td><input type=\"text\" id=\"txtUiConfId\" value=\"<?php echo isset($_GET['uiConfId']) ? $_GET['uiConfId'] : ''; ?>\" />\n\t\t</td>\n\t\t<tr>\n\t\t\t<td colspan=\"2\">\n\t\t\t\t<input type=\"button\" onclick=\"loadPlayer()\" value=\"Load Player\" />\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td colspan=\"2\"><br/><br/></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>Ad URL:</td>\n\t\t\t<td><input type=\"text\" id=\"txtAdUrl\" value=\"http://projects.kaltura.com/vast/vast10.xml\" />\n\t\t</td>\n\t\t<tr>\n\t\t\t<td>Ad Duration (milliseconds):</td>\n\t\t\t<td><input type=\"text\" id=\"txtAdDuration\" value=\"5000\" />\n\t\t</td>\n\t\t<tr>\n\t\t\t<td>Cue point type:</td>\n\t\t\t<td>\n\t\t\t\t<select id=\"cuePointType\" onchange=\"selectCuePointType(this.options[this.selectedIndex].value)\">\n  \t\t\t\t\t<option value=\"offset\" selected>Offset</option>\n  \t\t\t\t\t<option value=\"time\">Timestamp</option>\n\t\t\t\t</select>\n\t\t</td>\n\t\t<tr>\t\t\t\n\t\t\t<td>Add cue point in (milliseconds):</td>\n\t\t\t<td><input type=\"text\" id=\"txtAdDelay\" value=\"300000\" disabled=\"disabled\"/>\t\t\t\n\t\t</td>\t\n\t\t<tr>\n\t\t\t<td colspan=\"2\">\n\t\t\t\t<input id=\"btnSendAd\" type=\"button\" onclick=\"sendAd()\" disabled=\"disabled\" value=\"Insert Ad\" style=\"background-color: red; height: 50px; font-size: 15pt;\" />\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td colspan=\"2\"><br/><br/></td>\n\t\t</tr>\n\t</table>\n</div><!-- end #main -->\n</body>\n</html>\n", "<?php \nif(!isset($_GET['partnerId']))\n\tdie('partnerId must be supplied in query string');\n\t\nif(!isset($_GET['playerVersion']))\n\tdie('html5 lib version must be supplied in query string');\n\n$partnerId = $_GET['partnerId'];\n\n$html5Version = $_GET['playerVersion'];\n?>\n<!DOCTYPE html>\n<!--[if lt IE 7]>      <html class=\"lt-ie10 lt-ie9 lt-ie8 lt-ie7\"> <![endif]-->\n<!--[if IE 7]>         <html class=\"lt-ie10 lt-ie9 lt-ie8\"> <![endif]-->\n<!--[if IE 8]>         <html class=\"lt-ie10 lt-ie9\"> <![endif]-->\n<!--[if lt IE 10]>     <html class=\"lt-ie10\"> <![endif]-->\n<!--[if gt IE 8]><!--> <html> <!--<![endif]-->\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->\n    <title>Kaltura</title>\n\n    <!-- Bootstrap -->\n    <link href=\"css/main.css\" rel=\"stylesheet\">\t\n\t<link href='https://fonts.googleapis.com/css?family=Lato:400,700,300' rel='stylesheet' type='text/css'>\n\t\n\t<script src=\"/lib/js/jquery-1.8.3.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"/html5/html5lib/<?php echo $html5Version; ?>/mwEmbedLoader.php\"></script>\n\t<script type=\"text/javascript\" src=\"swfobject.js\"></script>\n\t<script>\n\t\tvar partnerId = <?php echo $partnerId; ?>;\n\t\tvar ks = null;\n\t\tvar currentTime = null;\n\n\t\tfunction loadPlayer(){\n\t\t\tvar entryId = $('#txtEntryId').val();\n\t\t\tvar uiConfId = $('#txtUiConfId').val();\n\t\t\tvar adminUiConfId = $('#txtAdminUiConfId').val();\n\n\t\t\tmw.setConfig('Kaltura.LeadWithHTML5', true);\n\t\t\tloadAdminPlayer(entryId, adminUiConfId);\n\t\t\tloadUserPlayer(entryId, uiConfId);\n\t\t\tstartSession();\n\t\t}\n\n\t\tfunction startSession(){\n\t\t\tvar secret = $('#txtSecret').val();\n\n\t\t\t$.ajax(\n\t\t\t\t'/api_v3/index.php/service/session/action/start', {\n\t\t\t\tdata: {\n\t\t\t\t\tformat: 1,\n\t\t\t\t\tpartnerId: partnerId,\n\t\t\t\t\tsecret: secret,\n\t\t\t\t\ttype: 2\n\t\t\t\t},\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\n\t\t\t\t\talert(errorThrown);\n\t\t\t\t},\n\t\t\t\tsuccess: function(data, textStatus, jqXHR){\n\t\t\t\t\tif(data.code && data.message){\n\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\tks = data;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfunction userPlayerUrl(){\n\t\t\tlog('url', '#cpLog');\n\t\t\tvar entryId = $('#txtEntryId').val();\n\t\t\tvar uiConfId = $('#txtUiConfId').val();\n\t\t\tvar url = location.protocol + '//';\n\t\t\turl += location.host + '/admin_console/tools/bigRedButtonPtsPocUserPlayer.php?partnerId='\n\t\t\turl += partnerId + '&entryId=0_oyfjxo3a' + '&uiConfId=15098051' + '&playerVersion=v2.39';\n\t\t\tlog(url, '#cpLog');\n\t\t\treturn url;\n\t\t}\n\t\t\n\t\tfunction loadUserPlayer(entryId, uiConfId){\n            kWidget.embed({\n                    targetId: 'userPlayerContainer',\n                    wid: '_' + partnerId,\n                    \"uiconf_id\": uiConfId,\n                    \"flashvars\": {\n                            \"streamerType\": \"auto\",\n                            \"autoPlay\": true,\n                            \"LeadWithHLSOnFlash\": true,\n\t\t\t\t\t\t\t\"Kaltura.Protocol\":\"http\"\n                    },\n                    \"cache_st\": 1410340114,\n                    \"entry_id\": entryId\n            });\n\t\t}\n\n\t\tfunction loadAdminPlayer(entryId, uiConfId){\n\t\t     kWidget.embed({\n\t\t\t\t\t targetId: 'adminPlayerContainer',\n\t\t\t\t\t wid: '_' + partnerId,\n\t\t\t\t\t \"uiconf_id\": uiConfId,\n\t\t\t\t\t \"flashvars\": {\n\t\t\t\t\t\t\t \"streamerType\": \"auto\",\n\t\t\t\t\t\t\t \"autoPlay\": true,\n\t\t\t\t\t\t\t \"hlsLogs\": true,\n\t\t\t\t\t\t\t \"LeadWithHLSOnFlash\": true\n\t\t\t\t\t },\n\t\t\t\t\t \"cache_st\": 1410340114,\n\t\t\t\t\t \"entry_id\": entryId\n\t\t\t });\n\t\t}\n\t\t\n\t\tfunction onCurrentTime(t, isAbsolute){\n\t\t\tif(t > 0){\n\t\t\t\tcurrentTime = t*1000;\n\t\t\t\t$('#btnSendAd').removeAttr('disabled');\n\t\t\t\tdocument.getElementById(\"adminTime\").innerHTML = currentTime;\n\t\t\t}\n\t\t}\n\n\t\tfunction sendAd(){\t\n\t\t\tvar entryId = $('#txtEntryId').val();\n\t\t\tvar adUrl = $('#txtAdUrl').val();\n\t\t\tvar duration = $('#txtAdDuration').val();\n\n\t\t\tvar startTime  = currentTime;\n\n\t\t\t$.ajax(\n\t\t\t\t'/api_v3/index.php/service/cuePoint_cuePoint/action/add', {\n\t\t\t\tdata: {\n\t\t\t\t\tformat: 1,\n\t\t\t\t\tks: ks,\n\t\t\t\t\t'cuePoint:objectType': 'KalturaAdCuePoint',\n\t\t\t\t\t'cuePoint:entryId': entryId,\n\t\t\t\t\t'cuePoint:startTime': startTime,\n\t\t\t\t\t'cuePoint:protocolType': 'VPAID',\n\t\t\t\t\t'cuePoint:sourceUrl': adUrl,\n\t\t\t\t\t'cuePoint:adType': 1, // VIDEO\n\t\t\t\t\t'cuePoint:title': 'Test Cue-Point',\n\t\t\t\t\t'cuePoint:duration': duration\n\t\t\t\t},\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\n\t\t\t\t\t\talert(errorThrown);\n\t\t\t\t},\n\t\t\t\tsuccess: function(data, textStatus, jqXHR){\n\t\t\t\t\tif(data.code && data.message){\n\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar ul = document.getElementById(\"cpList\");\n\t\t\t\t\tvar li = document.createElement(\"li\");\n\t\t\t\t\tvar timeSpan = document.createElement('span')\n\t\t\t\t\ttimeSpan.innerHTML = \"Start time \" + startTime;\n\t\t\t\t\tli.appendChild(document.createTextNode(\"Cue point created\"));\n\t\t\t\t\tli.appendChild(timeSpan);\n\t\t\t\t\tul.appendChild(li);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t</script>\n</head>\n<body onload=\"loadPlayer()\">\n   <nav class=\"navbar navbar-default navbar-static-top\">\n      <div class=\"container\">\n        <div class=\"row\">\n          <div class=\"col col-xs-8\">\n            <span class=\"navbar-brand\">BIG RED BUTTON</span>\n          </div>\n          <div class=\"col col-xs-4 text-right\">\n            <img class=\"logo\" src=\"images/kaltura.png\">\n          </div>\n        </div>\n      </div>\n    </nav>\n\t<div class=\"videos-wrapper\">\n      <div class=\"container\">\n        <div class=\"row\">\n          <div class=\"col col-sm-6 video-col\">\n            <div class=\"video\">\n              <div id=\"adminPlayerContainer\" class=\"video-content\">\n               </div>\n            </div>\n\t\t\t<p><strong>Admin</strong> <span id=\"adminTime\"> </span></p>\n          </div>\n          <div class=\"col col-sm-6 video-col\">\n            <div class=\"video\">\n              <div id=\"userPlayerContainer\" class=\"video-content\">\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <a class=\"btn btn-primary btn-rounded btn-lg\" id=\"btnSendAd\" disabled=\"disabled\" onclick=\"sendAd()\">+ Insert Ad</a>\n    </div>\n    <div class=\"container\">\n      <div class=\"row\">\n        <div class=\"col col-sm-offset-2 col-sm-8\">\n          <p class=\"section-title\">History</p>\n          <ul id=\"cpList\" class=\"history-list\">\n          </ul>\n        </div>\n      </div>\n    </div>\n<div id=\"main\" style=\"position: static;\">\n\t  \t<table>\n\t\t<tr style=\"display: none; \">\n\t\t\t<td>Admin Secret:</td>\n\t\t\t<td><input type=\"text\" id=\"txtSecret\" value=\"<?php echo isset($_GET['secret']) ? $_GET['secret'] : ''; ?>\" />\n\t\t</td>\n\t\t<tr style=\"display: none; \">\n\t\t\t<td>Entry Id:</td>\n\t\t\t<td><input type=\"text\" id=\"txtEntryId\" value=\"<?php echo isset($_GET['entryId']) ? $_GET['entryId'] : ''; ?>\" />\n\t\t</td>\n\t\t<tr style=\"display: none; \">\n        \t<td>Admin uiConf Id:</td>\n            <td><input type=\"text\" id=\"txtAdminUiConfId\" value=\"<?php echo isset($_GET['adminUiConfId']) ? $_GET['adminUiConfId'] : ''; ?>\" />\n\t\t</td>\n\t\t<tr style=\"display: none; \">\n        \t<td>User uiConf Id:</td>\n            <td><input type=\"text\" id=\"txtUiConfId\" value=\"<?php echo isset($_GET['uiConfId']) ? $_GET['uiConfId'] : ''; ?>\" />\n\t\t</td>\n\t\t<tr style=\"display: none; \">\n\t\t\t<td colspan=\"2\">\n\t\t\t\t<input type=\"button\" onclick=\"loadPlayer()\" value=\"Load Player\" />\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr style=\"display: none; \">\n\t\t\t<td colspan=\"2\"><br/><br/></td>\n\t\t</tr>\n\t\t<tr style=\"display: none; \">\n\t\t\t<td>Ad URL:</td>\n\t\t\t<td><input type=\"text\" id=\"txtAdUrl\" value=\"http://projects.kaltura.com/vast/vast11.xml\" />\n\t\t</td>\n\t\t<tr style=\"display: none; \">\n\t\t\t<td>Ad Duration (milliseconds):</td>\n\t\t\t<td><input type=\"text\" id=\"txtAdDuration\" value=\"30000\" />\n\t\t</td>\n\t</table>\n</div><!-- end #main -->\n</body>\n</html>\n"], "fixing_code": ["<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\" lang=\"en\">\n<head>\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\" />\n<title>AkamaiBroadcaster_v1.1</title>\n<script language=\"javascript\">AC_FL_RunContent = 0;</script>\n<script src=\"../js/AC_RunActiveContent.js\" language=\"javascript\"></script>\n</head>\n<body bgcolor=\"#ffffff\">\n<!--url's used in the movie-->\n<!--text used in the movie-->\n<!-- saved from url=(0013)about:internet -->\n<script language=\"javascript\">\n\n\t\n\tvar flashVars = 'cpcode=<?php echo strip_tags($_GET['streamUsername']); ?>';\n\tflashVars += '&passwd=<?php echo strip_tags($_GET['streamPassword']); ?>';\n\tflashVars += '&streamname=<?php echo strip_tags($_GET['entryId']); ?>@<?php echo strip_tags($_GET['streamRemoteId']); ?>';\n\tflashVars += '&primaryep=p.ep<?php echo strip_tags($_GET['streamRemoteId']); ?>.i.akamaientrypoint.net';\n\tflashVars += '&backupep=b.ep<?php echo strip_tags($_GET['streamRemoteBackupId']); ?>.i.akamaientrypoint.net';\n\t\n\n\tif (AC_FL_RunContent == 0) {\n\t\talert(\"This page requires AC_RunActiveContent.js. In Flash, run \\\"Apply Active Content Update\\\" in the Commands menu to copy AC_RunActiveContent.js to the HTML output folder.\");\n\t} else {\n\t\tAC_FL_RunContent(\n\t\t\t'codebase', 'http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,0,0',\n\t\t\t'width', '760',\n\t\t\t'height', '744',\n\t\t\t'src', 'AkamaiBroadcaster_v1.1',\n\t\t\t'quality', 'best',\n\t\t\t'pluginspage', 'http://www.macromedia.com/go/getflashplayer',\n\t\t\t'align', 'middle',\n\t\t\t'play', 'true',\n\t\t\t'loop', 'false',\n\t\t\t'scale', 'showall',\n\t\t\t'wmode', 'window',\n\t\t\t'devicefont', 'false',\n\t\t\t'id', 'AkamaiBroadcaster_v1.1',\n\t\t\t'bgcolor', '#ffffff',\n\t\t\t'name', 'AkamaiBroadcaster_v1.1',\n\t\t\t'menu', 'true',\n\t\t\t'allowScriptAccess','sameDomain',\n\t\t\t'movie', 'AkamaiBroadcaster_v1.1',\n\t\t\t'salign', '',\n\t\t\t'flashvars', flashVars\n\t\t\t); //end AC code\n\t}\n</script>\n</body>\n</html>\n", "<html>\n  <body>\n    <div id=\"jw_wrap_1267721422280\">\n      <object width=\"400\" height=\"319\" id=\"jw_player_1267721422280\"\n      name=\"jw_player_1267721422280\">\n        <param name=\"movie\"\n        value=\"non-commercial.swf\" />\n        <param name=\"wmode\" value=\"transparent\" />\n        <param name=\"allowScriptAccess\" value=\"always\" />\n        <param name=\"flashvars\" value=\"file=<?php echo strip_tags($_GET['entryId']); ?>_1@<?php echo strip_tags($_GET['streamRemoteId']); ?>&subscribe=true&streamer=rtmp://cp<?php echo strip_tags($_GET['streamUsername']); ?>.live.edgefcs.net/live/&type=fcsubscribe\" />\n        <embed id=\"jw_player__1267721422280\"\n        name=\"jw_player__1267721422280\"\n        src=\"non-commercial.swf\"\n        width=\"400\" height=\"319\" allowfullscreen=\"true\"\n        wmode=\"transparent\" allowscriptaccess=\"always\"\n        flashvars=\"file=<?php echo strip_tags($_GET['entryId']); ?>_1@<?php echo strip_tags($_GET['streamRemoteId']); ?>&subscribe=true&streamer=rtmp://cp<?php echo strip_tags($_GET['streamUsername']); ?>.live.edgefcs.net/live/&type=fcsubscribe\" />\n        <noembed>\n          <a href=\"http://www.kaltura.org/\">Open Source Video</a>\n        </noembed>\n      </object>\n    </div>\n  </body>\n</html>\n", "<html>\n  <body>\n    <div id=\"jw_wrap_1267721422280\">\n      <object width=\"400\" height=\"319\" id=\"jw_player_1267721422280\"\n      name=\"jw_player_1267721422280\">\n        <param name=\"movie\"\n        value=\"non-commercial.swf\" />\n        <param name=\"wmode\" value=\"transparent\" />\n        <param name=\"allowScriptAccess\" value=\"always\" />\n        <param name=\"flashvars\" value=\"config=/index.php/extwidget/streamclipper?entryId=<?php echo strip_tags($_GET['entryId']); ?>\" />\n        <embed id=\"jw_player__1267721422280\"\n        name=\"jw_player__1267721422280\"\n        src=\"non-commercial.swf\"\n        width=\"400\" height=\"319\" allowfullscreen=\"true\"\n        wmode=\"transparent\" allowscriptaccess=\"always\" \n        flashvars=\"config=/index.php/extwidget/streamclipper?entryId=<?php echo strip_tags($_GET['entryId']); ?>\" />\n        <noembed>\n          <a href=\"http://www.kaltura.org/\">Open Source Video</a>\n        </noembed>\n      </object>\n    </div>\n  </body>\n</html>\n", "<?php \nif(!isset($_GET['partnerId']))\n\tdie('partnerId must be supplied in query string');\n\t\nif(!isset($_GET['playerVersion']))\n\tdie('html5 lib version must be supplied in query string');\n\n$partnerId = strip_tags($_GET['partnerId']);\n\n$html5Version = strip_tags($_GET['playerVersion']);\n?>\n<!DOCTYPE html>\n<!--[if lt IE 7]>      <html class=\"lt-ie10 lt-ie9 lt-ie8 lt-ie7\"> <![endif]-->\n<!--[if IE 7]>         <html class=\"lt-ie10 lt-ie9 lt-ie8\"> <![endif]-->\n<!--[if IE 8]>         <html class=\"lt-ie10 lt-ie9\"> <![endif]-->\n<!--[if lt IE 10]>     <html class=\"lt-ie10\"> <![endif]-->\n<!--[if gt IE 8]><!--> <html> <!--<![endif]-->\n<head>\n\t<meta charset=\"utf-8\">\n\t<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge,chrome=1\">\n\t\n\t<title>Big-Red-Button Demo</title>\n\t<link type=\"text/css\" rel=\"stylesheet\" href=\"/lib/css/kmc.css\" />\n\t<style>\n\t\t#main .content .title h1 { font-size: 24px; font-weight: bold; }\n\t\t#main p { margin-bottom: 20px; font-size: 18px; }\n\t</style>\n\t\n\t<script src=\"/lib/js/jquery-1.8.3.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"/html5/html5lib/<?php echo $html5Version; ?>/mwEmbedLoader.php\"></script>\n\t<script type=\"text/javascript\" src=\"swfobject.js\"></script>\n\t<script>\n\t\tvar partnerId = <?php echo $partnerId; ?>;\n\t\tvar ks = null;\n\t\tvar lastSyncPointTime = null;\n\t\tvar lastSyncPointOffset = null;\n\t\tvar lastSyncPointTimestamp = null;\n\n\t\tfunction loadPlayer(){\n\t\t\tvar entryId = $('#txtEntryId').val();\n\t\t\tvar uiConfId = $('#txtUiConfId').val();\n\n\t\t\tvar hlsUrl = location.protocol + '//';\n\t\t\thlsUrl += location.host;\n\t\t\thlsUrl += '/p/' + partnerId + '/playManifest/format/applehttp';\n\t\t\thlsUrl += '/entryId/' + entryId;\n\n\t\t\tvar stitchedUrl = hlsUrl;\n\n\t\t\thlsUrl += '/a/playlist.m3u8';\n\t\t\tstitchedUrl += '/uiConfId/' + uiConfId;\n\t\t\tstitchedUrl += '/usePlayServer/1/a/playlist.m3u8';\n\n\t\t\tvar hdsUrl = location.protocol + '//';\n\t\t\thdsUrl += location.host;\n\t\t\thdsUrl += '/p/' + partnerId + '/playManifest/format/hds';\n\t\t\thdsUrl += '/entryId/' + entryId;\n\t\t\thdsUrl += '/a/a.f4m';\n\n\t\t\tvar html = '<b>HLS URL:</b> <a href=\"' + hlsUrl + '\" target=\"_tab\">' + hlsUrl + '</a><br/>';\n\t\t\thtml += '<b>Stitched URL:</b> <a href=\"' + stitchedUrl + '\" target=\"_tab\">' + stitchedUrl + '</a><br/>';\n\t\t\thtml += '<b>HDS URL:</b> <a href=\"' + hdsUrl + '\" target=\"_tab\">' + hdsUrl + '</a>';\n\t\t\t$('#lblUrl').html(html);\n\n\t\t\t mw.setConfig('Kaltura.LeadWithHTML5', true);\n\t\t\tloadAdminPlayer(entryId, uiConfId);\n\t\t\tloadUserPlayer(entryId, uiConfId);\n\t\t\tstartSession();\n\t\t}\n\n\t\tfunction startSession(){\n\t\t\tvar secret = $('#txtSecret').val();\n\n\t\t\t$.ajax(\n\t\t\t\t'/api_v3/index.php/service/session/action/start', {\n\t\t\t\tdata: {\n\t\t\t\t\tformat: 1,\n\t\t\t\t\tpartnerId: partnerId,\n\t\t\t\t\tsecret: secret,\n\t\t\t\t\ttype: 2\n\t\t\t\t},\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\n\t\t\t\t\talert(errorThrown);\n\t\t\t\t},\n\t\t\t\tsuccess: function(data, textStatus, jqXHR){\n\t\t\t\t\tif(data.code && data.message){\n\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\tks = data;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfunction loadUserPlayer(entryId, uiConfId){\n            kWidget.embed({\n                    targetId: 'userPlayerContainer',\n                    wid: '_' + partnerId,\n                    \"uiconf_id\": uiConfId,\n                    \"flashvars\": {\n                            \"streamerType\": \"auto\",\n                            \"autoPlay\": true,\n                            \"LeadWithHLSOnFlash\": true,\n\t\t\t\t\t\t\t\"Kaltura.Protocol\":\"http\"\n                    },\n                    \"cache_st\": 1410340114,\n                    \"entry_id\": entryId\n            });\n\t\t}\n\n\t\tfunction loadAdminPlayer(entryId, uiConfId){\n\t\t     kWidget.embed({\n\t\t\t\t\t targetId: 'adminPlayerContainer',\n\t\t\t\t\t wid: '_' + partnerId,\n\t\t\t\t\t \"uiconf_id\": uiConfId,\n\t\t\t\t\t \"flashvars\": {\n\t\t\t\t\t\t \t \"playServerUrls\": {\"plugin\": false},\n\t\t\t\t\t\t\t \"streamerType\": \"hds\",\n\t\t\t\t\t\t\t \"autoPlay\": true,\n\t\t\t\t\t\t\t \"forceHDS\": true,\n\t\t\t\t\t\t\t \"LeadWithHLSOnFlash\": false\n\t\t\t\t\t },\n\t\t\t\t\t \"cache_st\": 1410340114,\n\t\t\t\t\t \"entry_id\": entryId,\n\t\t\t\t\t \"readyCallback\": function( playerId ){\n\t\t\t\t\t\tvar adminKdp = document.getElementById( playerId );\n\t\t\t\t\t\tadminKdp.addJsListener( 'videoMetadataReceived', 'onSyncPoint' );\n\t\t\t\t\t\tadminKdp.addJsListener( 'onId3Tag', 'onSyncPoint' );\n\t\t\t\t\t}\n\t\t\t });\n\t\t}\n\n\t\tfunction onSyncPoint(metadata){\n\t\t\tif ( metadata && metadata.objectType == \"KalturaSyncPoint\") {\n\t\t\t\tif(lastSyncPointTimestamp && lastSyncPointTimestamp >= metadata.timestamp)\n\t\t\t\t\treturn;\n\t\t\t\tvar date = new Date();\n\t\t\t\tlastSyncPointTime = date.getTime();\n\t\t\t\tlastSyncPointTimestamp = metadata.timestamp;\n\t\t\t\t$('#last_cue_point_time').html(new Date(lastSyncPointTimestamp).toUTCString());\n\n\t\t\t\t$('#btnSendAd').removeAttr('disabled');\n\t\t\t\tlog('Ads Enabled last offset:' + lastSyncPointOffset + ' last timestamp: ' + lastSyncPointTimestamp);\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction enableAds(){\n\t\t\tif(!ks){\n\t\t\t\talert('kaltura API is not enabled');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar interval = $('#txtSyncPointInterval').val();\n\t\t\tvar duration = $('#txtSyncPointDuration').val();\n\t\t\tvar entryId = $('#txtEntryId').val();\n\t\t\t\n\t\t\t$.ajax(\n\t\t\t\t'/api_v3/index.php/service/liveStream/action/createPeriodicSyncPoints', {\n\t\t\t\tdata: {\n\t\t\t\t\tformat: 1,\n\t\t\t\t\tks: ks,\n\t\t\t\t\tentryId: entryId,\n\t\t\t\t\tinterval: interval,\n\t\t\t\t\tduration: duration\n\t\t\t\t},\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\n\t\t\t\t\talert(errorThrown);\n\t\t\t\t},\n\t\t\t\tsuccess: function(data, textStatus, jqXHR){\n\t\t\t\t\tif(data && data.code && data.message){\n\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfunction sendAd(){\n\t\t\tvar date = new Date();\n\t\t\tvar timeSinceLastSyncPoint = date.getTime() - lastSyncPointTime;\n\n\t\t\tvar entryId = $('#txtEntryId').val();\n\t\t\tvar adUrl = $('#txtAdUrl').val();\n\t\t\tvar duration = $('#txtAdDuration').val();\n\t\t\tvar cuePointType = $('#cuePointType').val();\n\n\t\t\tif(cuePointType == 'offset'){\n\t\t\t\tvar startTime = lastSyncPointOffset + timeSinceLastSyncPoint;\n\t\t\t\t$.ajax(\n\t\t\t\t\t\t'/api_v3/index.php/service/cuePoint_cuePoint/action/add', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tformat: 1,\n\t\t\t\t\t\t\tks: ks,\n\t\t\t\t\t\t\t'cuePoint:objectType': 'KalturaAdCuePoint',\n\t\t\t\t\t\t\t'cuePoint:entryId': entryId,\n\t\t\t\t\t\t\t'cuePoint:startTime': startTime,\n\t\t\t\t\t\t\t'cuePoint:protocolType': 'VPAID',\n\t\t\t\t\t\t\t'cuePoint:sourceUrl': adUrl,\n\t\t\t\t\t\t\t'cuePoint:adType': 1, // VIDEO\n\t\t\t\t\t\t\t'cuePoint:title': 'Test Cue-Point',\n\t\t\t\t\t\t\t'cuePoint:duration': duration\n\t\t\t\t\t\t},\n\t\t\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\n\t\t\t\t\t\t\talert(errorThrown);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuccess: function(data, textStatus, jqXHR){\n\t\t\t\t\t\t\tif(data.code && data.message){\n\t\t\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlog('Cue-Point created [' + data.id + '] startTime [' + startTime + '] timeSinceLastSyncPoint [' + timeSinceLastSyncPoint +']');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\tvar delay = $('#txtAdDelay').val();\n\t\t\t\tvar triggeredAt = (lastSyncPointTimestamp + timeSinceLastSyncPoint + parseInt(delay)) / 1000;\n\n\t\t\t\t$.ajax(\n\t\t\t\t\t'/api_v3/index.php/service/cuePoint_cuePoint/action/add', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tformat: 1,\n\t\t\t\t\t\tks: ks,\n\t\t\t\t\t\t'cuePoint:objectType': 'KalturaAdCuePoint',\n\t\t\t\t\t\t'cuePoint:entryId': entryId,\n\t\t\t\t\t\t'cuePoint:triggeredAt': triggeredAt,\n\t\t\t\t\t\t'cuePoint:protocolType': 'VPAID',\n\t\t\t\t\t\t'cuePoint:sourceUrl': adUrl,\n\t\t\t\t\t\t'cuePoint:adType': 1, // VIDEO\n\t\t\t\t\t\t'cuePoint:title': 'Test Cue-Point',\n\t\t\t\t\t\t'cuePoint:duration': duration\n\t\t\t\t\t},\n\t\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\n\t\t\t\t\t\talert(errorThrown);\n\t\t\t\t\t},\n\t\t\t\t\tsuccess: function(data, textStatus, jqXHR){\n\t\t\t\t\t\tif(data.code && data.message){\n\t\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlog('Cue-Point created [' + data.id + '] triggeredAt [' + triggeredAt + '] timeSinceLastSyncPoint [' + timeSinceLastSyncPoint +']');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfunction selectCuePointType(type){\n\t\t\tif(type == 'offset'){\n\t\t\t\t$('#txtAdDelay').attr(\"disabled\", \"disabled\");\n\t\t\t}\n\t\t\telse{\n\t\t\t\t$('#txtAdDelay').removeAttr(\"disabled\");\n\t\t\t}\n\t\t}\n\n\t\tfunction log(log){\n\t\t\t$('#eraLog').val(log + '\\n' + $('#eraLog').val());\n\t\t}\n\n\t\tfunction updateSystemTime()\n\t\t{\n\t\t\tvar currentTime = new Date();\n\t\t\tsetTimeout(\"updateSystemTime()\",500);\n\t\t\t$('#current_system_time').html(currentTime.toUTCString());\n\t\t}\n\t</script>\n</head>\n<body onload=\"updateSystemTime()\">\n<div id=\"main\" style=\"position: static;\">\n\t<div class=\"content\">\n\t\t<div class=\"title\">\n\t\t\t<h1>Big-Red-Button Demo</h1>\n\t\t</div>\n\t\t<div class=\"contwrap\">\n\t\t\t<p></p>\n\t\t\t<table>\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th>Admin Player</th>\n\t\t\t\t\t\t<th></th>\n\t\t\t\t\t\t<th>User Player</th>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td><div id=\"adminPlayerContainer\" style=\"width: 400px; height: 333px;\" /></td>\n\t\t\t\t\t\t<td><textarea id=\"eraLog\" style=\"width: 400px; height: 333px;\"></textarea></td>\n\t\t\t\t\t\t<td><div id=\"userPlayerContainer\" style=\"width: 400px; height: 333px;\" /></td>\n\t\t\t\t\t</tr>\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</div><!-- end contwrap -->\n\t</div><!-- end content -->\n\t<div id=\"lblUrl\"></div>\n\t<br/>\n\t<table>\n\t\t<tr>\n\t\t\t<td>Current PC Time</td>\n\t\t\t<td><div id=\"current_system_time\">&nbsp;</div></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>Last sync point time</td>\n\t\t\t<td><div id=\"last_cue_point_time\">&nbsp;</div></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>Admin Secret:</td>\n\t\t\t<td><input type=\"text\" id=\"txtSecret\" value=\"<?php echo isset($_GET['secret']) ? strip_tags($_GET['secret']) : ''; ?>\" />\n\t\t</td>\n\t\t<tr>\n\t\t\t<td>Entry Id:</td>\n\t\t\t<td><input type=\"text\" id=\"txtEntryId\" value=\"<?php echo isset($_GET['entryId']) ? strip_tags($_GET['entryId']) : ''; ?>\" />\n\t\t</td>\n\t\t<tr>\n        \t<td>uiConf Id:</td>\n            <td><input type=\"text\" id=\"txtUiConfId\" value=\"<?php echo isset($_GET['uiConfId']) ? strip_tags($_GET['uiConfId']) : ''; ?>\" />\n\t\t</td>\n\t\t<tr>\n\t\t\t<td colspan=\"2\">\n\t\t\t\t<input type=\"button\" onclick=\"loadPlayer()\" value=\"Load Player\" />\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td colspan=\"2\"><br/><br/></td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td>Ad URL:</td>\n\t\t\t<td><input type=\"text\" id=\"txtAdUrl\" value=\"http://projects.kaltura.com/vast/vast10.xml\" />\n\t\t</td>\n\t\t<tr>\n\t\t\t<td>Ad Duration (milliseconds):</td>\n\t\t\t<td><input type=\"text\" id=\"txtAdDuration\" value=\"5000\" />\n\t\t</td>\n\t\t<tr>\n\t\t\t<td>Cue point type:</td>\n\t\t\t<td>\n\t\t\t\t<select id=\"cuePointType\" onchange=\"selectCuePointType(this.options[this.selectedIndex].value)\">\n  \t\t\t\t\t<option value=\"offset\" selected>Offset</option>\n  \t\t\t\t\t<option value=\"time\">Timestamp</option>\n\t\t\t\t</select>\n\t\t</td>\n\t\t<tr>\t\t\t\n\t\t\t<td>Add cue point in (milliseconds):</td>\n\t\t\t<td><input type=\"text\" id=\"txtAdDelay\" value=\"300000\" disabled=\"disabled\"/>\t\t\t\n\t\t</td>\t\n\t\t<tr>\n\t\t\t<td colspan=\"2\">\n\t\t\t\t<input id=\"btnSendAd\" type=\"button\" onclick=\"sendAd()\" disabled=\"disabled\" value=\"Insert Ad\" style=\"background-color: red; height: 50px; font-size: 15pt;\" />\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr>\n\t\t\t<td colspan=\"2\"><br/><br/></td>\n\t\t</tr>\n\t</table>\n</div><!-- end #main -->\n</body>\n</html>\n", "<?php \nif(!isset($_GET['partnerId']))\n\tdie('partnerId must be supplied in query string');\n\t\nif(!isset($_GET['playerVersion']))\n\tdie('html5 lib version must be supplied in query string');\n\n$partnerId = strip_tags($_GET['partnerId']);\n\n$html5Version = strip_tags($_GET['playerVersion']);\n?>\n<!DOCTYPE html>\n<!--[if lt IE 7]>      <html class=\"lt-ie10 lt-ie9 lt-ie8 lt-ie7\"> <![endif]-->\n<!--[if IE 7]>         <html class=\"lt-ie10 lt-ie9 lt-ie8\"> <![endif]-->\n<!--[if IE 8]>         <html class=\"lt-ie10 lt-ie9\"> <![endif]-->\n<!--[if lt IE 10]>     <html class=\"lt-ie10\"> <![endif]-->\n<!--[if gt IE 8]><!--> <html> <!--<![endif]-->\n<head>\n    <meta charset=\"utf-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->\n    <title>Kaltura</title>\n\n    <!-- Bootstrap -->\n    <link href=\"css/main.css\" rel=\"stylesheet\">\t\n\t<link href='https://fonts.googleapis.com/css?family=Lato:400,700,300' rel='stylesheet' type='text/css'>\n\t\n\t<script src=\"/lib/js/jquery-1.8.3.min.js\"></script>\n\t<script type=\"text/javascript\" src=\"/html5/html5lib/<?php echo $html5Version; ?>/mwEmbedLoader.php\"></script>\n\t<script type=\"text/javascript\" src=\"swfobject.js\"></script>\n\t<script>\n\t\tvar partnerId = <?php echo $partnerId; ?>;\n\t\tvar ks = null;\n\t\tvar currentTime = null;\n\n\t\tfunction loadPlayer(){\n\t\t\tvar entryId = $('#txtEntryId').val();\n\t\t\tvar uiConfId = $('#txtUiConfId').val();\n\t\t\tvar adminUiConfId = $('#txtAdminUiConfId').val();\n\n\t\t\tmw.setConfig('Kaltura.LeadWithHTML5', true);\n\t\t\tloadAdminPlayer(entryId, adminUiConfId);\n\t\t\tloadUserPlayer(entryId, uiConfId);\n\t\t\tstartSession();\n\t\t}\n\n\t\tfunction startSession(){\n\t\t\tvar secret = $('#txtSecret').val();\n\n\t\t\t$.ajax(\n\t\t\t\t'/api_v3/index.php/service/session/action/start', {\n\t\t\t\tdata: {\n\t\t\t\t\tformat: 1,\n\t\t\t\t\tpartnerId: partnerId,\n\t\t\t\t\tsecret: secret,\n\t\t\t\t\ttype: 2\n\t\t\t\t},\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\n\t\t\t\t\talert(errorThrown);\n\t\t\t\t},\n\t\t\t\tsuccess: function(data, textStatus, jqXHR){\n\t\t\t\t\tif(data.code && data.message){\n\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\tks = data;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfunction userPlayerUrl(){\n\t\t\tlog('url', '#cpLog');\n\t\t\tvar entryId = $('#txtEntryId').val();\n\t\t\tvar uiConfId = $('#txtUiConfId').val();\n\t\t\tvar url = location.protocol + '//';\n\t\t\turl += location.host + '/admin_console/tools/bigRedButtonPtsPocUserPlayer.php?partnerId='\n\t\t\turl += partnerId + '&entryId=0_oyfjxo3a' + '&uiConfId=15098051' + '&playerVersion=v2.39';\n\t\t\tlog(url, '#cpLog');\n\t\t\treturn url;\n\t\t}\n\t\t\n\t\tfunction loadUserPlayer(entryId, uiConfId){\n            kWidget.embed({\n                    targetId: 'userPlayerContainer',\n                    wid: '_' + partnerId,\n                    \"uiconf_id\": uiConfId,\n                    \"flashvars\": {\n                            \"streamerType\": \"auto\",\n                            \"autoPlay\": true,\n                            \"LeadWithHLSOnFlash\": true,\n\t\t\t\t\t\t\t\"Kaltura.Protocol\":\"http\"\n                    },\n                    \"cache_st\": 1410340114,\n                    \"entry_id\": entryId\n            });\n\t\t}\n\n\t\tfunction loadAdminPlayer(entryId, uiConfId){\n\t\t     kWidget.embed({\n\t\t\t\t\t targetId: 'adminPlayerContainer',\n\t\t\t\t\t wid: '_' + partnerId,\n\t\t\t\t\t \"uiconf_id\": uiConfId,\n\t\t\t\t\t \"flashvars\": {\n\t\t\t\t\t\t\t \"streamerType\": \"auto\",\n\t\t\t\t\t\t\t \"autoPlay\": true,\n\t\t\t\t\t\t\t \"hlsLogs\": true,\n\t\t\t\t\t\t\t \"LeadWithHLSOnFlash\": true\n\t\t\t\t\t },\n\t\t\t\t\t \"cache_st\": 1410340114,\n\t\t\t\t\t \"entry_id\": entryId\n\t\t\t });\n\t\t}\n\t\t\n\t\tfunction onCurrentTime(t, isAbsolute){\n\t\t\tif(t > 0){\n\t\t\t\tcurrentTime = t*1000;\n\t\t\t\t$('#btnSendAd').removeAttr('disabled');\n\t\t\t\tdocument.getElementById(\"adminTime\").innerHTML = currentTime;\n\t\t\t}\n\t\t}\n\n\t\tfunction sendAd(){\t\n\t\t\tvar entryId = $('#txtEntryId').val();\n\t\t\tvar adUrl = $('#txtAdUrl').val();\n\t\t\tvar duration = $('#txtAdDuration').val();\n\n\t\t\tvar startTime  = currentTime;\n\n\t\t\t$.ajax(\n\t\t\t\t'/api_v3/index.php/service/cuePoint_cuePoint/action/add', {\n\t\t\t\tdata: {\n\t\t\t\t\tformat: 1,\n\t\t\t\t\tks: ks,\n\t\t\t\t\t'cuePoint:objectType': 'KalturaAdCuePoint',\n\t\t\t\t\t'cuePoint:entryId': entryId,\n\t\t\t\t\t'cuePoint:startTime': startTime,\n\t\t\t\t\t'cuePoint:protocolType': 'VPAID',\n\t\t\t\t\t'cuePoint:sourceUrl': adUrl,\n\t\t\t\t\t'cuePoint:adType': 1, // VIDEO\n\t\t\t\t\t'cuePoint:title': 'Test Cue-Point',\n\t\t\t\t\t'cuePoint:duration': duration\n\t\t\t\t},\n\t\t\t\terror: function(jqXHR, textStatus, errorThrown){\n\t\t\t\t\t\talert(errorThrown);\n\t\t\t\t},\n\t\t\t\tsuccess: function(data, textStatus, jqXHR){\n\t\t\t\t\tif(data.code && data.message){\n\t\t\t\t\t\talert(data.message);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar ul = document.getElementById(\"cpList\");\n\t\t\t\t\tvar li = document.createElement(\"li\");\n\t\t\t\t\tvar timeSpan = document.createElement('span')\n\t\t\t\t\ttimeSpan.innerHTML = \"Start time \" + startTime;\n\t\t\t\t\tli.appendChild(document.createTextNode(\"Cue point created\"));\n\t\t\t\t\tli.appendChild(timeSpan);\n\t\t\t\t\tul.appendChild(li);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t</script>\n</head>\n<body onload=\"loadPlayer()\">\n   <nav class=\"navbar navbar-default navbar-static-top\">\n      <div class=\"container\">\n        <div class=\"row\">\n          <div class=\"col col-xs-8\">\n            <span class=\"navbar-brand\">BIG RED BUTTON</span>\n          </div>\n          <div class=\"col col-xs-4 text-right\">\n            <img class=\"logo\" src=\"images/kaltura.png\">\n          </div>\n        </div>\n      </div>\n    </nav>\n\t<div class=\"videos-wrapper\">\n      <div class=\"container\">\n        <div class=\"row\">\n          <div class=\"col col-sm-6 video-col\">\n            <div class=\"video\">\n              <div id=\"adminPlayerContainer\" class=\"video-content\">\n               </div>\n            </div>\n\t\t\t<p><strong>Admin</strong> <span id=\"adminTime\"> </span></p>\n          </div>\n          <div class=\"col col-sm-6 video-col\">\n            <div class=\"video\">\n              <div id=\"userPlayerContainer\" class=\"video-content\">\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      <a class=\"btn btn-primary btn-rounded btn-lg\" id=\"btnSendAd\" disabled=\"disabled\" onclick=\"sendAd()\">+ Insert Ad</a>\n    </div>\n    <div class=\"container\">\n      <div class=\"row\">\n        <div class=\"col col-sm-offset-2 col-sm-8\">\n          <p class=\"section-title\">History</p>\n          <ul id=\"cpList\" class=\"history-list\">\n          </ul>\n        </div>\n      </div>\n    </div>\n<div id=\"main\" style=\"position: static;\">\n\t  \t<table>\n\t\t<tr style=\"display: none; \">\n\t\t\t<td>Admin Secret:</td>\n\t\t\t<td><input type=\"text\" id=\"txtSecret\" value=\"<?php echo isset($_GET['secret']) ? strip_tags($_GET['secret']) : ''; ?>\" />\n\t\t</td>\n\t\t<tr style=\"display: none; \">\n\t\t\t<td>Entry Id:</td>\n\t\t\t<td><input type=\"text\" id=\"txtEntryId\" value=\"<?php echo isset($_GET['entryId']) ? strip_tags($_GET['entryId']) : ''; ?>\" />\n\t\t</td>\n\t\t<tr style=\"display: none; \">\n        \t<td>Admin uiConf Id:</td>\n            <td><input type=\"text\" id=\"txtAdminUiConfId\" value=\"<?php echo isset($_GET['adminUiConfId']) ? strip_tags($_GET['adminUiConfId']) : ''; ?>\" />\n\t\t</td>\n\t\t<tr style=\"display: none; \">\n        \t<td>User uiConf Id:</td>\n            <td><input type=\"text\" id=\"txtUiConfId\" value=\"<?php echo isset($_GET['uiConfId']) ? strip_tags($_GET['uiConfId']) : ''; ?>\" />\n\t\t</td>\n\t\t<tr style=\"display: none; \">\n\t\t\t<td colspan=\"2\">\n\t\t\t\t<input type=\"button\" onclick=\"loadPlayer()\" value=\"Load Player\" />\n\t\t\t</td>\n\t\t</tr>\n\t\t<tr style=\"display: none; \">\n\t\t\t<td colspan=\"2\"><br/><br/></td>\n\t\t</tr>\n\t\t<tr style=\"display: none; \">\n\t\t\t<td>Ad URL:</td>\n\t\t\t<td><input type=\"text\" id=\"txtAdUrl\" value=\"http://projects.kaltura.com/vast/vast11.xml\" />\n\t\t</td>\n\t\t<tr style=\"display: none; \">\n\t\t\t<td>Ad Duration (milliseconds):</td>\n\t\t\t<td><input type=\"text\" id=\"txtAdDuration\" value=\"30000\" />\n\t\t</td>\n\t</table>\n</div><!-- end #main -->\n</body>\n</html>\n"], "filenames": ["admin_console/web/tools/AkamaiBroadcaster.php", "admin_console/web/tools/SimpleJWPlayer.php", "admin_console/web/tools/XmlJWPlayer.php", "admin_console/web/tools/bigRedButton.php", "admin_console/web/tools/bigRedButtonPtsPoc.php"], "buggy_code_start_loc": [15, 10, 10, 8, 8], "buggy_code_end_loc": [20, 17, 17, 317, 226], "fixing_code_start_loc": [15, 10, 10, 8, 8], "fixing_code_end_loc": [20, 17, 17, 317, 226], "type": "CWE-79", "message": "An issue was discovered in Kaltura server Lynx-12.11.0. The vulnerability exists due to insufficient filtration of user-supplied data passed to the \"admin_console/web/tools/SimpleJWPlayer.php\" URL, the \"admin_console/web/tools/AkamaiBroadcaster.php\" URL, the \"admin_console/web/tools/bigRedButton.php\" URL, and the \"admin_console/web/tools/bigRedButtonPtsPoc.php\" URL. An attacker could execute arbitrary HTML and script code in a browser in the context of the vulnerable website.", "other": {"cve": {"id": "CVE-2017-6391", "sourceIdentifier": "cve@mitre.org", "published": "2017-03-02T06:59:00.340", "lastModified": "2017-03-07T02:59:02.797", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "An issue was discovered in Kaltura server Lynx-12.11.0. The vulnerability exists due to insufficient filtration of user-supplied data passed to the \"admin_console/web/tools/SimpleJWPlayer.php\" URL, the \"admin_console/web/tools/AkamaiBroadcaster.php\" URL, the \"admin_console/web/tools/bigRedButton.php\" URL, and the \"admin_console/web/tools/bigRedButtonPtsPoc.php\" URL. An attacker could execute arbitrary HTML and script code in a browser in the context of the vulnerable website."}, {"lang": "es", "value": "Se ha descubierto un problema en el servidor Lynx-12.11.0 de Kaltura. La vulnerabilidad existe debido a filtraci\u00f3n insuficiente de datos suministrados por el usuario pasados a la URL \"admin_console/web/tools/SimpleJWPlayer.php\", la URL \"admin_console/web/tools/AkamaiBroadcaster.php\", la URL \"admin_console/web/tools/bigRedButton.php\" y la URL \"admin_console/web/tools/bigRedButtonPtsPoc.php\". Un atacante podr\u00eda ejecutar c\u00f3digo HTML y secuencia de comandos arbitrario en un buscador en el contexto de un sitio web vulnerable."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kaltura:kaltura_server:*:*:*:*:*:*:*:*", "versionEndIncluding": "lynx-12.11.0", "matchCriteriaId": "9736FE19-44FC-41B0-8C43-290446A87E2D"}]}]}], "references": [{"url": "http://www.securityfocus.com/bid/96534", "source": "cve@mitre.org"}, {"url": "https://github.com/kaltura/server/commit/041a6d5e8336f7713985b120139c8f4b6279a337", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/kaltura/server/issues/5300", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/kaltura/server/commit/041a6d5e8336f7713985b120139c8f4b6279a337"}}