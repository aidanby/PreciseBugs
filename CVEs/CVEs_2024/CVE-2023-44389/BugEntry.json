{"buggy_code": ["<dtml-var manage_navbar>\n\n<dtml-with \"_(manage_options=filtered_manage_options())\"\n\t><dtml-if manage_options\n\t\t><dtml-call \"REQUEST.set('n_', _.len(manage_options)-1)\"\n\t\t><dtml-call \"REQUEST.set('a_', 0)\"\n\t\t><dtml-in manage_options mapping\n\t\t\t><dtml-if expr=\"REQUEST.URL[-(_.len(action)):]==action or\n\t\t\t\tREQUEST.URL[-17:]=='/manage_workspace' and _['sequence-start']\"\n\t\t\t\t><dtml-call \"REQUEST.set('a_', _['sequence-index'])\"\n\t\t\t></dtml-if\n\t\t\t><dtml-if \"_.has_key('management_view') and management_view==label\"\n\t\t\t\t><dtml-call \"REQUEST.set('a_', _['sequence-index'])\"\n\t\t\t></dtml-if\n\t\t></dtml-in>\n\n\t\t<nav id=\"tabs\" class=\"navbar navbar-light navbar-expand-md mt-0 mb-0 pb-0\" role=\"navigation\">\n\t\t\t<div class=\"collapse navbar-collapse row\" id=\"tabs_items\">\n\t\t\t\t<ul class=\"nav nav-tabs\">\n\t\t\t\t\t<dtml-in manage_options mapping>\n\t\t\t\t\t\t<dtml-let s_item=sequence-item s_index=sequence-index>\n\t\t\t\t\t\t\t<li class=\"nav-item\">\n\t\t\t\t\t\t\t\t<a <dtml-if \"s_index==a_\"> class=\"nav-link active\"<dtml-else> class=\"nav-link\"</dtml-if\n\t\t\t\t\t\t\t\t\t><dtml-if \"s_item.get('action')\"> href=\"&dtml-action;\"<dtml-else> href=\"<dtml-var \"REQUEST.URL1\" html_quote>\"</dtml-if\n\t\t\t\t\t\t\t\t\t><dtml-if \"s_item.get('target')\"> target=\"&dtml-target;\"</dtml-if>\n\t\t\t\t\t\t\t\t\t><dtml-var \"s_item['label']\"></a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</dtml-let>\n\t\t\t\t\t</dtml-in>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</nav>\n\t</dtml-if>\n\n<dtml-comment>\n\t<dtml-unless MANAGE_TABS_NO_BANNER>\n\t\t<!-- IS THIS STILL NEEDED? WHY SHOW NOT BREADCRUMB etc.?\n\t\t\thttps://mail.zope.dev/pipermail/zope-checkins/1999-August/001313.html\n\t\t-->\n\t</dtml-unless>\n</dtml-comment>\n\n\t<nav aria-label=\"breadcrumb\">\n\t<dtml-let breadcrumb_length=\"tabs_path_length(REQUEST)\">\n\t\t<ol class=\"breadcrumb <dtml-var \"'zmi-' + title_or_id().replace(' ','')\">\"\n\t\t\tdata-length=\"<dtml-var breadcrumb_length>\">\n\t\t\t<li class=\"breadcrumb-item meta_type\">\n\t\t\t\t<dtml-if meta_type>\n\t\t\t\t\t<i class=\"&dtml-zmi_icon;\" title=\"&dtml-meta_type;\"></i>\n\t\t\t\t\t<dtml-var \"breadcrumb_length==1 and 'Root Folder' or meta_type\">\n\t\t\t\t<dtml-else>\n\t\t\t\t\tObject\n\t\t\t\t</dtml-if>\n\t\t\t</li>\n\t\t\t<dtml-in expr=\"tabs_path_default(REQUEST)\" mapping>\n\t\t\t\t<li class=\"breadcrumb-item<dtml-if last> active</dtml-if>\"\n\t\t\t\t\t<dtml-if last>\n\t\t\t\t\t\taria-current=\"page\"\n\t\t\t\t\t\ttitle=\"<dtml-if meta_type>&dtml-meta_type;<dtml-else>Object</dtml-if>\"\n\t\t\t\t\t</dtml-if>\n\t\t\t\t\t><a href=\"&dtml-url;\">\n\t\t\t\t\t\t<dtml-if \"_['sequence-index']==0\">\n\t\t\t\t\t\t\t<strong title=\"Root Folder\">&nbsp;/&nbsp;</strong>\n\t\t\t\t\t\t<dtml-else>\n\t\t\t\t\t\t\t<dtml-var title html_quote>\n\t\t\t\t\t\t</dtml-if>\n\t\t\t\t\t</a>\n\t\t\t\t\t<dtml-if \"_['sequence-index']!=0 and last==False\">\n\t\t\t\t\t\t&nbsp;/&nbsp;\n\t\t\t\t\t</dtml-if>\n\t\t\t\t\t<dtml-if last>\n\t\t\t\t\t\t<dtml-if wl_isLocked\n\t\t\t\t\t\t\t><span class=\"badge badge-warning\"\n\t\t\t\t\t\t\t\ttitle=\"This item has been locked by WebDAV\"><i class=\"fa fa-lock\"></i></span>\n\t\t\t\t\t\t</dtml-if>\n\t\t\t\t\t</dtml-if>\n\t\t\t\t</li>\n\t\t\t</dtml-in>\n\t\t</ol>\n\t\t</dtml-let>\n\t</nav>\n\n\n\t<dtml-if manage_tabs_message>\n\t\t<div class=\"alert alert-<dtml-var manage_tabs_type missing=success html_quote>\" role=\"alert\">\n\t\t\t<dtml-var manage_tabs_message newline_to_br html_quote\n\t\t\t> (<dtml-var ZopeTime fmt=\"%Y-%m-%d %H:%M\">)\n\t\t</div>\n\t</dtml-if>\n\n</dtml-with>\n"], "fixing_code": ["<dtml-var manage_navbar>\n\n<dtml-with \"_(manage_options=filtered_manage_options())\"\n\t><dtml-if manage_options\n\t\t><dtml-call \"REQUEST.set('n_', _.len(manage_options)-1)\"\n\t\t><dtml-call \"REQUEST.set('a_', 0)\"\n\t\t><dtml-in manage_options mapping\n\t\t\t><dtml-if expr=\"REQUEST.URL[-(_.len(action)):]==action or\n\t\t\t\tREQUEST.URL[-17:]=='/manage_workspace' and _['sequence-start']\"\n\t\t\t\t><dtml-call \"REQUEST.set('a_', _['sequence-index'])\"\n\t\t\t></dtml-if\n\t\t\t><dtml-if \"_.has_key('management_view') and management_view==label\"\n\t\t\t\t><dtml-call \"REQUEST.set('a_', _['sequence-index'])\"\n\t\t\t></dtml-if\n\t\t></dtml-in>\n\n\t\t<nav id=\"tabs\" class=\"navbar navbar-light navbar-expand-md mt-0 mb-0 pb-0\" role=\"navigation\">\n\t\t\t<div class=\"collapse navbar-collapse row\" id=\"tabs_items\">\n\t\t\t\t<ul class=\"nav nav-tabs\">\n\t\t\t\t\t<dtml-in manage_options mapping>\n\t\t\t\t\t\t<dtml-let s_item=sequence-item s_index=sequence-index>\n\t\t\t\t\t\t\t<li class=\"nav-item\">\n\t\t\t\t\t\t\t\t<a <dtml-if \"s_index==a_\"> class=\"nav-link active\"<dtml-else> class=\"nav-link\"</dtml-if\n\t\t\t\t\t\t\t\t\t><dtml-if \"s_item.get('action')\"> href=\"&dtml-action;\"<dtml-else> href=\"<dtml-var \"REQUEST.URL1\" html_quote>\"</dtml-if\n\t\t\t\t\t\t\t\t\t><dtml-if \"s_item.get('target')\"> target=\"&dtml-target;\"</dtml-if>\n\t\t\t\t\t\t\t\t\t><dtml-var \"s_item['label']\"></a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</dtml-let>\n\t\t\t\t\t</dtml-in>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</nav>\n\t</dtml-if>\n\n<dtml-comment>\n\t<dtml-unless MANAGE_TABS_NO_BANNER>\n\t\t<!-- IS THIS STILL NEEDED? WHY SHOW NOT BREADCRUMB etc.?\n\t\t\thttps://mail.zope.dev/pipermail/zope-checkins/1999-August/001313.html\n\t\t-->\n\t</dtml-unless>\n</dtml-comment>\n\n\t<nav aria-label=\"breadcrumb\">\n\t<dtml-let breadcrumb_length=\"tabs_path_length(REQUEST)\">\n\t\t<ol class=\"breadcrumb <dtml-var \"'zmi-' + title_or_id().replace(' ','')\" html_quote>\"\n\t\t\tdata-length=\"<dtml-var breadcrumb_length>\">\n\t\t\t<li class=\"breadcrumb-item meta_type\">\n\t\t\t\t<dtml-if meta_type>\n\t\t\t\t\t<i class=\"&dtml-zmi_icon;\" title=\"&dtml-meta_type;\"></i>\n\t\t\t\t\t<dtml-var \"breadcrumb_length==1 and 'Root Folder' or meta_type\">\n\t\t\t\t<dtml-else>\n\t\t\t\t\tObject\n\t\t\t\t</dtml-if>\n\t\t\t</li>\n\t\t\t<dtml-in expr=\"tabs_path_default(REQUEST)\" mapping>\n\t\t\t\t<li class=\"breadcrumb-item<dtml-if last> active</dtml-if>\"\n\t\t\t\t\t<dtml-if last>\n\t\t\t\t\t\taria-current=\"page\"\n\t\t\t\t\t\ttitle=\"<dtml-if meta_type>&dtml-meta_type;<dtml-else>Object</dtml-if>\"\n\t\t\t\t\t</dtml-if>\n\t\t\t\t\t><a href=\"&dtml-url;\">\n\t\t\t\t\t\t<dtml-if \"_['sequence-index']==0\">\n\t\t\t\t\t\t\t<strong title=\"Root Folder\">&nbsp;/&nbsp;</strong>\n\t\t\t\t\t\t<dtml-else>\n\t\t\t\t\t\t\t<dtml-var title html_quote>\n\t\t\t\t\t\t</dtml-if>\n\t\t\t\t\t</a>\n\t\t\t\t\t<dtml-if \"_['sequence-index']!=0 and last==False\">\n\t\t\t\t\t\t&nbsp;/&nbsp;\n\t\t\t\t\t</dtml-if>\n\t\t\t\t\t<dtml-if last>\n\t\t\t\t\t\t<dtml-if wl_isLocked\n\t\t\t\t\t\t\t><span class=\"badge badge-warning\"\n\t\t\t\t\t\t\t\ttitle=\"This item has been locked by WebDAV\"><i class=\"fa fa-lock\"></i></span>\n\t\t\t\t\t\t</dtml-if>\n\t\t\t\t\t</dtml-if>\n\t\t\t\t</li>\n\t\t\t</dtml-in>\n\t\t</ol>\n\t\t</dtml-let>\n\t</nav>\n\n\n\t<dtml-if manage_tabs_message>\n\t\t<div class=\"alert alert-<dtml-var manage_tabs_type missing=success html_quote>\" role=\"alert\">\n\t\t\t<dtml-var manage_tabs_message newline_to_br html_quote\n\t\t\t> (<dtml-var ZopeTime fmt=\"%Y-%m-%d %H:%M\">)\n\t\t</div>\n\t</dtml-if>\n\n</dtml-with>\n"], "filenames": ["src/App/dtml/manage_tabs.dtml"], "buggy_code_start_loc": [45], "buggy_code_end_loc": [46], "fixing_code_start_loc": [45], "fixing_code_end_loc": [46], "type": "CWE-79", "message": "Zope is an open-source web application server. The title property, available on most Zope objects, can be used to store script code that is executed while viewing the affected object in the Zope Management Interface (ZMI). All versions of Zope 4 and Zope 5 are affected. Patches will be released with Zope versions 4.8.11 and 5.8.6.", "other": {"cve": {"id": "CVE-2023-44389", "sourceIdentifier": "security-advisories@github.com", "published": "2023-10-04T21:15:10.360", "lastModified": "2024-02-01T00:50:52.917", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Zope is an open-source web application server. The title property, available on most Zope objects, can be used to store script code that is executed while viewing the affected object in the Zope Management Interface (ZMI). All versions of Zope 4 and Zope 5 are affected. Patches will be released with Zope versions 4.8.11 and 5.8.6."}, {"lang": "es", "value": "Zope es un servidor de aplicaciones web de c\u00f3digo abierto. La propiedad title, disponible en la mayor\u00eda de los objetos Zope, se puede utilizar para almacenar c\u00f3digo de script que se ejecuta mientras se visualiza el objeto afectado en Zope Management Interface (ZMI). Todas las versiones de Zope 4 y Zope 5 se ven afectadas. Los parches se lanzar\u00e1n con las versiones 4.8.11 y 5.8.6 de Zope."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.1, "baseSeverity": "LOW"}, "exploitabilityScore": 0.5, "impactScore": 2.5}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:zope:zope:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0", "versionEndExcluding": "4.8.11", "matchCriteriaId": "945F18A2-06BA-4B4B-A159-C98E0C2AD2E5"}, {"vulnerable": true, "criteria": "cpe:2.3:a:zope:zope:*:*:*:*:*:*:*:*", "versionStartIncluding": "5.0", "versionEndExcluding": "5.8.6", "matchCriteriaId": "7FB6AD5C-64B6-4EDE-B24F-38D833200E41"}]}]}], "references": [{"url": "https://github.com/zopefoundation/Zope/commit/21dfa78609ffd8b6bd8143805678ebbacae5141a", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/zopefoundation/Zope/commit/aeaf2cdc80dff60815e3706af448f086ddc3b98d", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/zopefoundation/Zope/security/advisories/GHSA-m755-gxxg-r5qh", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}]}, "github_commit_url": "https://github.com/zopefoundation/Zope/commit/21dfa78609ffd8b6bd8143805678ebbacae5141a"}}