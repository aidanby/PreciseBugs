{"buggy_code": ["<?php\n\nclass Install\n{\n    function __construct($ini_file)\n    {\n        openlog(\"livehelperchat\", LOG_PID | LOG_PERROR, LOG_LOCAL0);\n        syslog(LOG_DEBUG, \"Start installation\"); \n        $this->settings = parse_ini_file($ini_file, true, INI_SCANNER_TYPED);\n    }\n\n    function __destruct()\n    {\n        syslog(LOG_DEBUG, \"Finish installation\"); \n        closelog();\n    }\n\n    function step1() {\n        $Errors = array();\n        $directories = $this->_scandir('cache');\n        $this->file_is_writable(array('cache'),'', $Errors);\n        $this->file_is_writable($directories, 'cache/', $Errors);\n        $this->file_is_writable(array('settings'), '', $Errors);\n        $var_directories = array(\n            'var/storage',\n            'var/storageform',\n            'var/storagetheme',\n            'var/storageadmintheme',\n            'var/tmpfiles',\n            'var/userphoto',\n        );\n        $this->file_is_writable(array('var'),'', $Errors);\n        $this->file_is_writable($var_directories, '', $Errors);\n\n        if (!extension_loaded ('pdo_mysql' ))\n            $Errors[] = \"php-pdo extension not detected. Please install php extension\";\n\n        if (!extension_loaded('curl'))\n            $Errors[] = \"php_curl extension not detected. Please install php extension\";\t\n\n        if (!extension_loaded('mbstring'))\n            $Errors[] = \"mbstring extension not detected. Please install php extension\";\t\n\n        if (!extension_loaded('gd'))\n            $Errors[] = \"gd extension not detected. Please install php extension\";\t\n\n        if (!function_exists('json_encode'))\n            $Errors[] = \"json support not detected. Please install php extension\";\t\n\n        if (version_compare(PHP_VERSION, '5.4.0','<')) {\n            $Errors[] = \"Minimum 5.4.0 PHP version is required\";\t\n        }\n\n        if (count($Errors) == 0){\n            return true;\n        } else {\n            return $Errors;\n        }\n    }\n\n    function step2() {\n        $Errors = array();\n        $database = $this->settings['db'];\n        foreach ($database as $key => $value) {\n            if (!filter_var($database[$key], FILTER_UNSAFE_RAW)) {\n                $Errors[] = \"Please enter database $key\";\n            }\n        }\n        if (!filter_var($database['database'], FILTER_SANITIZE_STRING))\n        {\n            $Errors[] = 'Please enter database name';\n        }\n\n        if (count($Errors) == 0) {\n            try {\n                $db = ezcDbFactory::create( \"mysql://{$database['user']}:{$database['password']}@{$database['host']}:{$database['port']}/{$database['database']}\" );\n            } catch (Exception $e) {\n                $Errors[] = \"Cannot login with provided logins. Returned message: \".$e->getMessage();\n            }\n        }\n\n        if (count($Errors) == 0) {\n            $cfgSite = erConfigClassLhConfig::getInstance();\n            foreach ($database as $key => $value) {\n                $cfgSite->setSetting( 'db', $key, $value);\n            }\n            $cfgSite->setSetting( 'site', 'secrethash', substr(md5(time() . \":\" . mt_rand()),0,10));\n            return true;\n        } else {\n            return $Errors;\n        }\n    }\n\n    function step3() {\n\n        $Errors = array();\n\n        $form = (object)$this->settings['admin'];\n        if (!filter_var($form->AdminUsername, FILTER_UNSAFE_RAW))\n        {\n            $Errors[] = 'Please enter admin username';\n        }\n\n        if (!empty($form->AdminUsername) && strlen($form->AdminUsername) > 40)\n        {\n            $Errors[] = 'Maximum 40 characters for admin username';\n        }\n\n        if (!filter_var($form->AdminPassword, FILTER_UNSAFE_RAW))\n        {\n            $Errors[] = 'Please enter admin password';\n        }\n\n        if (!empty($form->AdminPassword) && strlen($form->AdminPassword) > 40)\n        {\n            $Errors[] = 'Maximum 40 characters for admin password';\n        }\n\n        if (!filter_var($form->AdminEmail, FILTER_VALIDATE_EMAIL))\n        {\n            $Errors[] = 'Wrong email address';\n        }\n\n        if (!filter_var($form->DefaultDepartament, FILTER_SANITIZE_STRING))\n        {\n            $Errors[] = 'Please enter default department name';\n        }\n\n        if (count($Errors) == 0) {\n            $adminEmail = $form->AdminEmail;\n\n            /*DATABASE TABLES SETUP*/\n            $db = ezcDbInstance::get();\n\n            try {\n                $db->query(\"set global innodb_large_prefix = 1\");\n            } catch (Exception $e) {\n                // Just ignore if not succeed\n            }\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat` (\n\t\t\t\t  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `nick` varchar(100) NOT NULL,\n\t\t\t\t  `status` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `status_sub` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `status_sub_sub` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `time` int(11) NOT NULL,\n\t\t\t\t  `user_id` int(11) NOT NULL,\n\t\t\t\t  `hash` varchar(40) NOT NULL,\n\t\t\t\t  `referrer` text NOT NULL,\n        \t   \t  `session_referrer` text NOT NULL,\n        \t   \t  `chat_variables` text NOT NULL,\n        \t   \t  `remarks` text NOT NULL,\n\t\t\t\t  `ip` varchar(100) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\t\t\t\t \n\t\t\t\t  `gbot_id` int(11) NOT NULL DEFAULT '0',\t\t\t\t \n\t\t\t\t  `invitation_id` int(11) NOT NULL,\t\t\t\t \n\t\t\t\t  `sender_user_id` int(11) NOT NULL,\n\t\t\t\t  `product_id` int(11) NOT NULL,\n                  `cls_us` tinyint(1) NOT NULL DEFAULT '0',\n\t\t\t\t  `pnd_time` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `cls_time` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `usaccept` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_status` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_closed_ts` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `support_informed` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `unread_messages_informed` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `reinform_timeout` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `last_op_msg_time` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `has_unread_op_messages` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `unread_op_messages_informed` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `email` varchar(100) NOT NULL,\n\t\t\t\t  `country_code` varchar(100) NOT NULL,\n\t\t\t\t  `country_name` varchar(100) NOT NULL,\n\t\t\t\t  `unanswered_chat` int(11) NOT NULL,\n\t\t\t\t  `anonymized` tinyint(1) NOT NULL,\n\t\t\t\t  `user_typing` int(11) NOT NULL,\n\t\t\t\t  `user_typing_txt` varchar(200) NOT NULL,\n\t\t\t\t  `operator_typing` int(11) NOT NULL,\n        \t   \t  `operator_typing_id` int(11) NOT NULL,\n\t\t\t\t  `phone` varchar(100) NOT NULL,\n\t\t\t\t  `has_unread_messages` int(11) NOT NULL,\n\t\t\t\t  `last_user_msg_time` int(11) NOT NULL,\n\t\t\t\t  `fbst` tinyint(1) NOT NULL,\n\t\t\t\t  `online_user_id` int(11) NOT NULL,\n\t\t\t\t  `auto_responder_id` int(11) NOT NULL,\n\t\t\t\t  `last_msg_id` int(11) NOT NULL,\n\t\t\t\t  `lsync` int(11) NOT NULL,\n\t\t\t\t  `transfer_uid` int(11) NOT NULL,\n\t\t\t\t  `additional_data` text NOT NULL,\t\t\t\t  \n\t\t\t\t  `user_tz_identifier` varchar(50) NOT NULL,\n\t\t\t\t  `lat` varchar(10) NOT NULL,\n\t\t\t\t  `lon` varchar(10) NOT NULL,\n\t\t\t\t  `city` varchar(100) NOT NULL,\n\t\t\t\t  `operation` text NOT NULL,\n\t\t\t\t  `operation_admin` varchar(200) NOT NULL,\n\t\t\t\t  `status_sub_arg` varchar(200) NOT NULL,\n\t\t\t\t  `uagent` varchar(250) NOT NULL,\n\t\t\t\t  `chat_locale` varchar(10) NOT NULL,\n\t\t\t\t  `chat_locale_to` varchar(10) NOT NULL,\n\t\t\t\t  `mail_send` int(11) NOT NULL,\n        \t   \t  `screenshot_id` int(11) NOT NULL,\n        \t   \t  `wait_time` int(11) NOT NULL,\n  \t\t\t\t  `chat_duration` int(11) NOT NULL,\n  \t\t\t\t  `tslasign` int(11) NOT NULL,\n        \t   \t  `priority` int(11) NOT NULL,\n        \t   \t  `chat_initiator` int(11) NOT NULL,\n        \t   \t  `transfer_timeout_ts` int(11) NOT NULL,\n        \t   \t  `transfer_timeout_ac` int(11) NOT NULL,\n        \t   \t  `transfer_if_na` int(11) NOT NULL,\n        \t   \t  `na_cb_executed` int(11) NOT NULL,\n        \t   \t  `device_type` int(11) NOT NULL,\n        \t   \t  `nc_cb_executed` tinyint(1) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `status_user_id` (`status`,`user_id`),\n\t\t\t\t  KEY `unanswered_chat` (`unanswered_chat`),\n\t\t\t\t  KEY `online_user_id` (`online_user_id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `product_id` (`product_id`),\n\t\t\t\t  KEY `unread_operator` (`has_unread_op_messages`,`unread_op_messages_informed`),\n\t\t\t\t  KEY `user_id_sender_user_id` (`user_id`,`sender_user_id`),\n\t\t\t\t  KEY `sender_user_id` (`sender_user_id`),\n\t\t\t\t  KEY `anonymized` (`anonymized`),\n\t\t\t\t  KEY `has_unread_messages` (`has_unread_messages`),\n\t\t\t\t  KEY `status` (`status`),\n                  KEY `nick` (`nick`),\n\t\t\t\t  KEY `email` (`email`),\n\t\t\t\t  KEY `dep_id_status` (`dep_id`,`status`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_chat_blocked_user` (\n                  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `ip` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `user_id` bigint(20) unsigned NOT NULL,\n                  `datets` bigint(20) unsigned NOT NULL,\n                  `chat_id` bigint(20) unsigned NOT NULL,\n                  `dep_id` bigint(20) unsigned NOT NULL,\n                  `nick` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `btype` tinyint(1) NOT NULL DEFAULT 0,\n                  `expires` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  `online_user_id` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  PRIMARY KEY (`id`),\n                  KEY `ip` (`ip`),\n                  KEY `nick` (`nick`),\n                  KEY `online_user_id` (`online_user_id`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_users_online_session` ( \n        \t       `id` bigint(20) NOT NULL AUTO_INCREMENT, \n        \t       `user_id` int(11) NOT NULL, \n        \t       `time` int(11) NOT NULL, \n        \t       `duration` int(11) NOT NULL, \n        \t       `lactivity` int(11) NOT NULL, \n        \t       PRIMARY KEY (`id`), \n        \t       KEY `user_id_lactivity` (`user_id`, `lactivity`), KEY `lactivity` (`lactivity`) ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_chat_start_settings` ( \n        \t       `id` int(11) NOT NULL AUTO_INCREMENT, \n        \t       `name` varchar(50) NOT NULL, \n        \t       `data` longtext NOT NULL, \n        \t       `department_id` int(11) NOT NULL, \n        \t       PRIMARY KEY (`id`), \n        \t       KEY `department_id` (`department_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_chat_event_track` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL, `data` longtext NOT NULL, `department_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `department_id` (`department_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_canned_msg_use` (`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT, `canned_id` int(11) unsigned NOT NULL, `chat_id` bigint(20) unsigned NOT NULL, `ctime` bigint(20) unsigned NOT NULL, `user_id` bigint(20) unsigned NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`), KEY `ctime` (`ctime`), KEY `canned_id` (`canned_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            \n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_archive_range` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `range_from` int(11) NOT NULL,\n        \t   `range_to` int(11) NOT NULL,\n        \t   `year_month` int(11) NOT NULL,\n        \t   `older_than` int(11) NOT NULL,\n        \t   `last_id` int(11) NOT NULL,\n        \t   `first_id` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_notification_subscriber` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `online_user_id` bigint(20) NOT NULL, `dep_id` int(11) NOT NULL, `theme_id` int(11) NOT NULL, `ctime` int(11) NOT NULL, `utime` int(11) NOT NULL, `status` int(11) NOT NULL, `params` text NOT NULL, `device_type` tinyint(1) NOT NULL,`subscriber_hash` varchar(50) NOT NULL, `uagent` varchar(250) NOT NULL, `ip` varchar(250) NOT NULL, `last_error` text NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`), KEY `dep_id` (`dep_id`), KEY `online_user_id` (`online_user_id`), KEY `subscriber_hash` (`subscriber_hash`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_auto_responder` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `siteaccess` varchar(3) NOT NULL,\n                  `wait_message` text NOT NULL,\n                  `wait_timeout` int(11) NOT NULL,\n                  `position` int(11) NOT NULL,\n                  `timeout_message` text NOT NULL,\n                  `bot_configuration` text NOT NULL,\n                  `name` varchar(50) NOT NULL,\n                  `operator` varchar(50) NOT NULL,\n                  `dep_id` int(11) NOT NULL,\n                  `user_id` int(11) NOT NULL,\n                  `only_proactive` int(11) NOT NULL,\n                  `repeat_number` int(11) NOT NULL DEFAULT '1',\n                  `survey_timeout` int(11) NOT NULL DEFAULT '0',\n                  `survey_id` int(11) NOT NULL DEFAULT '0',\n                  `wait_timeout_hold_1` int(11) NOT NULL,\n                  `wait_timeout_hold_2` int(11) NOT NULL,\n                  `wait_timeout_hold_3` int(11) NOT NULL,\n                  `wait_timeout_hold_4` int(11) NOT NULL,\n                  `wait_timeout_hold_5` int(11) NOT NULL,\n                  `timeout_hold_message_1` text NOT NULL,\n                  `timeout_hold_message_2` text NOT NULL,\n                  `timeout_hold_message_3` text NOT NULL,\n                  `timeout_hold_message_4` text NOT NULL,\n                  `timeout_hold_message_5` text NOT NULL,\n                  `wait_timeout_hold` text NOT NULL,\n                  `wait_timeout_2` int(11) NOT NULL,\n                  `timeout_message_2` text NOT NULL,\n                  `wait_timeout_3` int(11) NOT NULL,\n                  `timeout_message_3` text NOT NULL,\n                  `wait_timeout_4` int(11) NOT NULL,\n                  `timeout_message_4` text NOT NULL,\n                  `wait_timeout_5` int(11) NOT NULL,\n                  `timeout_message_5` text NOT NULL,\n                  `wait_timeout_reply_1` int(11) NOT NULL,\n                  `timeout_reply_message_1` text NOT NULL,\n                  `wait_timeout_reply_2` int(11) NOT NULL,\n                  `timeout_reply_message_2` text NOT NULL,\n                  `wait_timeout_reply_3` int(11) NOT NULL,\n                  `timeout_reply_message_3` text NOT NULL,\n                  `wait_timeout_reply_4` int(11) NOT NULL,\n                  `timeout_reply_message_4` text NOT NULL,\n                  `wait_timeout_reply_5` int(11) NOT NULL,\n                  `timeout_reply_message_5` text NOT NULL,\n                  `languages` text NOT NULL,\n                  `ignore_pa_chat` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `siteaccess_position` (`siteaccess`,`position`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n\n\n            $db->query(\"CREATE TABLE `lh_abstract_widget_theme` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `name` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `name_company` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `onl_bcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `bor_bcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT 'e3e3e3',\n  `text_color` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `online_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `online_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `offline_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `offline_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `logo_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `logo_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `header_background` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_tcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_bcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_border` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_close_bg` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_hover_bg` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_close_hover_bg` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `custom_status_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `custom_container_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `custom_widget_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_header` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `online_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `offline_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `widget_border_color` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `copyright_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `copyright_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `widget_copyright_url` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `show_copyright` int(11) NOT NULL DEFAULT 1,\n  `explain_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `intro_operator_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `operator_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `operator_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `minimize_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `minimize_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `restore_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `restore_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `close_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `close_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `popup_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `popup_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `hide_close` int(11) NOT NULL,\n  `hide_popup` int(11) NOT NULL,\n  `header_height` int(11) NOT NULL,\n  `header_padding` int(11) NOT NULL,\n  `widget_border_width` int(11) NOT NULL,\n  `support_joined` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `support_closed` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `pending_join` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `noonline_operators` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `noonline_operators_offline` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `show_need_help` int(11) NOT NULL DEFAULT 1,\n  `show_need_help_timeout` int(11) NOT NULL DEFAULT 24,\n  `show_voting` tinyint(1) NOT NULL DEFAULT 1,\n  `department_title` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `department_select` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `buble_visitor_background` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `buble_visitor_title_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `buble_visitor_text_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `buble_operator_background` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `buble_operator_title_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `buble_operator_text_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `custom_popup_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `hide_ts` int(11) NOT NULL,\n  `widget_response_width` int(11) NOT NULL,\n  `show_need_help_delay` int(11) NOT NULL,\n  `show_status_delay` int(11) NOT NULL,\n  `modern_look` tinyint(1) NOT NULL DEFAULT 0,\n  `bot_status_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `bot_configuration` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n  `notification_configuration` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n  `pending_join_queue` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `modified` int(11) NOT NULL,\n  `widget_show_leave_form` tinyint(1) NOT NULL,\n  `enable_widget_embed_override` tinyint(1) NOT NULL,\n  `widget_popheight` int(11) NOT NULL,\n  `widget_popwidth` int(11) NOT NULL,\n  `widget_survey` int(11) NOT NULL,\n  `widget_position` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `widget_pright` int(11) NOT NULL,\n  `widget_pbottom` int(11) NOT NULL,\n  `alias` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `alias` (`alias`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_faq` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `question` varchar(250) NOT NULL,\n\t\t\t\t  `answer` text NOT NULL,\n\t\t\t\t  `url` varchar(250) NOT NULL,\n\t\t\t\t  `email` varchar(50) NOT NULL,\n\t\t\t\t  `identifier` varchar(10) NOT NULL,\n\t\t\t\t  `active` int(11) NOT NULL,\n\t\t\t\t  `has_url` tinyint(1) NOT NULL,\n\t\t\t\t  `is_wildcard` tinyint(1) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `active` (`active`),\n\t\t\t\t  KEY `active_url_2` (`active`,`url`(191)),\n\t\t\t\t  KEY `has_url` (`has_url`),\n\t\t\t\t  KEY `identifier` (`identifier`),\n\t\t\t\t  KEY `is_wildcard` (`is_wildcard`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n            $db->query(\"CREATE TABLE `lh_group_chat` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `name` varchar(50) NOT NULL,\n  `status` int(11) NOT NULL,\n  `time` int(11) NOT NULL,\n  `user_id` int(11) NOT NULL,\n  `last_msg_op_id` bigint(20) NOT NULL,\n  `last_msg` varchar(200) NOT NULL,\n  `chat_id` bigint(20) NOT NULL DEFAULT 0,\n  `last_user_msg_time` int(11) NOT NULL,\n  `last_msg_id` bigint(20) NOT NULL,\n  `type` tinyint(1) NOT NULL DEFAULT 0,\n  `tm` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `user_id` (`user_id`),\n  KEY `chat_id` (`chat_id`),\n  KEY `type` (`type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_group_msg` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `msg` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n  `time` int(11) NOT NULL,\n  `chat_id` int(11) NOT NULL DEFAULT 0,\n  `user_id` int(11) NOT NULL DEFAULT 0,\n  `name_support` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `meta_msg` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `chat_id_id` (`chat_id`,`id`),\n  KEY `user_id` (`user_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_group_chat_member` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `user_id` bigint(20) NOT NULL,\n  `group_id` bigint(20) NOT NULL,\n  `last_activity` int(11) NOT NULL,\n  `last_msg_id` bigint(20) NOT NULL DEFAULT 0,\n  `type` tinyint(1) NOT NULL DEFAULT 0,\n  `jtime` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `group_id` (`group_id`),\n  KEY `user_id` (`user_id`),\n  KEY `type` (`type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_cobrowse` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `chat_id` int(11) NOT NULL,\n        \t   `online_user_id` int(11) NOT NULL,\n        \t   `mtime` int(11) NOT NULL,\n        \t   `url` varchar(250) NOT NULL,\n        \t   `initialize` longtext NOT NULL,\n        \t   `modifications` longtext NOT NULL,\n        \t   `finished` tinyint(1) NOT NULL,\n        \t   `w` int NOT NULL,\n\t\t\t   `wh` int NOT NULL,\n\t\t\t   `x` int NOT NULL,\n\t\t\t   `y` int NOT NULL,        \t   \t\t\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `chat_id` (`chat_id`),\n        \t   KEY `online_user_id` (`online_user_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_survey` (\n        \t      `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `name` varchar(250) NOT NULL,\n                  `feedback_text` text NOT NULL,\n                  `max_stars_1_title` varchar(250) NOT NULL,\n                  `max_stars_1_pos` int(11) NOT NULL,\n                  `max_stars_2_title` varchar(250) NOT NULL,\n                  `max_stars_2_pos` int(11) NOT NULL,\n                  `max_stars_2` int(11) NOT NULL,\n                  `max_stars_3_title` varchar(250) NOT NULL,\n                  `max_stars_3_pos` int(11) NOT NULL,\n                  `max_stars_3` int(11) NOT NULL,\n                  `max_stars_4_title` varchar(250) NOT NULL,\n                  `max_stars_4_pos` int(11) NOT NULL,\n                  `max_stars_4` int(11) NOT NULL,\n                  `max_stars_5_title` varchar(250) NOT NULL,\n                  `max_stars_5_pos` int(11) NOT NULL,\n                  `max_stars_5` int(11) NOT NULL,\n                  `question_options_1` varchar(250) NOT NULL,\n                  `question_options_1_items` text NOT NULL,\n                  `question_options_1_pos` int(11) NOT NULL,\n                  `question_options_2` varchar(250) NOT NULL,\n                  `question_options_2_items` text NOT NULL,\n                  `question_options_2_pos` int(11) NOT NULL,\n                  `question_options_3` varchar(250) NOT NULL,\n                  `question_options_3_items` text NOT NULL,\n                  `question_options_3_pos` int(11) NOT NULL,\n                  `question_options_4` varchar(250) NOT NULL,\n                  `question_options_4_items` text NOT NULL,\n                  `question_options_4_pos` int(11) NOT NULL,\n                  `question_options_5` varchar(250) NOT NULL,\n                  `question_options_5_items` text NOT NULL,\n                  `question_options_5_pos` int(11) NOT NULL,\n                  `question_plain_1` text NOT NULL,\n                  `question_plain_1_pos` int(11) NOT NULL,\n                  `question_plain_2` text NOT NULL,\n                  `question_plain_2_pos` int(11) NOT NULL,\n                  `question_plain_3` text NOT NULL,\n                  `question_plain_3_pos` int(11) NOT NULL,\n                  `question_plain_4` text NOT NULL,\n                  `question_plain_4_pos` int(11) NOT NULL,\n                  `question_plain_5` text NOT NULL,\n                  `question_plain_5_pos` int(11) NOT NULL,\n                  `max_stars_1_enabled` int(11) NOT NULL,\n                  `max_stars_2_enabled` int(11) NOT NULL,\n                  `max_stars_3_enabled` int(11) NOT NULL,\n                  `max_stars_4_enabled` int(11) NOT NULL,\n                  `max_stars_5_enabled` int(11) NOT NULL,\n                  `question_options_1_enabled` int(11) NOT NULL,\n                  `question_options_2_enabled` int(11) NOT NULL,\n                  `question_options_3_enabled` int(11) NOT NULL,\n                  `question_options_4_enabled` int(11) NOT NULL,\n                  `question_options_5_enabled` int(11) NOT NULL,\n                  `question_plain_1_enabled` int(11) NOT NULL,\n                  `question_plain_2_enabled` int(11) NOT NULL,\n                  `question_plain_3_enabled` int(11) NOT NULL,\n                  `question_plain_4_enabled` int(11) NOT NULL,\n                  `question_plain_5_enabled` int(11) NOT NULL,\n                  `max_stars_1` int(11) NOT NULL,\n                  `max_stars_1_req` int(11) NOT NULL,\n                  `max_stars_2_req` int(11) NOT NULL,\n                  `max_stars_3_req` int(11) NOT NULL,\n                  `max_stars_4_req` int(11) NOT NULL,\n                  `max_stars_5_req` int(11) NOT NULL,\n                  `question_options_1_req` int(11) NOT NULL,\n                  `question_options_2_req` int(11) NOT NULL,\n                  `question_options_3_req` int(11) NOT NULL,\n                  `question_options_4_req` int(11) NOT NULL,\n                  `question_options_5_req` int(11) NOT NULL,\n                  `question_plain_1_req` int(11) NOT NULL,\n                  `question_plain_2_req` int(11) NOT NULL,\n                  `question_plain_3_req` int(11) NOT NULL,\n                  `question_plain_4_req` int(11) NOT NULL,\n                  `question_plain_5_req` int(11) NOT NULL,\n                  `configuration` longtext NOT NULL,\n                  PRIMARY KEY (`id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            $db->query(\"CREATE TABLE `lh_admin_theme` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `name` varchar(100) NOT NULL,\n        \t       `static_content` longtext NOT NULL,\n        \t       `static_js_content` longtext NOT NULL,\n        \t       `static_css_content` longtext NOT NULL,\n        \t       `css_attributes` longtext NOT NULL,\n        \t       `header_content` text NOT NULL,\n        \t       `user_id` int(11) NOT NULL, \n        \t       `header_css` text NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `user_id` (`user_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            $db->query(\"CREATE TABLE `lh_chat_paid` ( \n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,  \n        \t       `hash` varchar(250) NOT NULL,  \n        \t       `chat_id` int(11) NOT NULL, \n        \t        PRIMARY KEY (`id`),  \n        \t       KEY `hash` (`hash`(191)),  \n        \t       KEY `chat_id` (`chat_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_survey_item` (\n        \t      `id` bigint(20) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `survey_id` int(11) NOT NULL,\n\t\t\t\t  `status` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `chat_id` int(11) NOT NULL,\n\t\t\t\t  `user_id` int(11) NOT NULL,\n\t\t\t\t  `ftime` int(11) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `max_stars_1` int(11) NOT NULL,\n\t\t\t\t  `max_stars_2` int(11) NOT NULL,\n\t\t\t\t  `max_stars_3` int(11) NOT NULL,\n\t\t\t\t  `max_stars_4` int(11) NOT NULL,\n\t\t\t\t  `max_stars_5` int(11) NOT NULL,\n\t\t\t\t  `question_options_1` int(11) NOT NULL,\n\t\t\t\t  `question_options_2` int(11) NOT NULL,\n\t\t\t\t  `question_options_3` int(11) NOT NULL,\n\t\t\t\t  `question_options_4` int(11) NOT NULL,\n\t\t\t\t  `question_options_5` int(11) NOT NULL,\n\t\t\t\t  `question_plain_1` text NOT NULL,\n\t\t\t\t  `question_plain_2` text NOT NULL,\n\t\t\t\t  `question_plain_3` text NOT NULL,\n\t\t\t\t  `question_plain_4` text NOT NULL,\n\t\t\t\t  `question_plain_5` text NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `survey_id` (`survey_id`),\n\t\t\t\t  KEY `chat_id` (`chat_id`),\n\t\t\t\t  KEY `user_id` (`user_id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `ftime` (`ftime`),\n\t\t\t\t  KEY `max_stars_1` (`max_stars_1`),\n\t\t\t\t  KEY `max_stars_2` (`max_stars_2`),\n\t\t\t\t  KEY `max_stars_3` (`max_stars_3`),\n\t\t\t\t  KEY `max_stars_4` (`max_stars_4`),\n\t\t\t\t  KEY `max_stars_5` (`max_stars_5`),\n\t\t\t\t  KEY `question_options_1` (`question_options_1`),\n\t\t\t\t  KEY `question_options_2` (`question_options_2`),\n\t\t\t\t  KEY `question_options_3` (`question_options_3`),\n\t\t\t\t  KEY `question_options_4` (`question_options_4`),\n\t\t\t\t  KEY `question_options_5` (`question_options_5`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_speech_language` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `name` varchar(100) NOT NULL,\n                  `siteaccess` varchar(3) NOT NULL DEFAULT '',\n                  PRIMARY KEY (`id`)\n               ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_speech_language_dialect` (\n                `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `language_id` int(11) NOT NULL,\n                  `lang_name` varchar(100) NOT NULL,\n                  `lang_code` varchar(100) NOT NULL,\n                  `short_code` varchar(4) NOT NULL DEFAULT '',\n                  PRIMARY KEY (`id`),\n                  KEY `language_id` (`language_id`),\n                  KEY `short_code` (`short_code`),\n                  KEY `lang_code` (`lang_code`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"INSERT INTO `lh_speech_language` (`id`, `name`, `siteaccess`) VALUES\n\t\t\t\t(1,\t'Afrikaans',''),\n\t\t\t\t(2,\t'Bahasa Indonesia',''),\n\t\t\t\t(3,\t'Bahasa Melayu',''),\n\t\t\t\t(4,\t'Catal\u00e0',''),\n\t\t\t\t(5,\t'\u010ce\u0161tina',''),\n\t\t\t\t(6,\t'Deutsch','ger'),\n\t\t\t\t(7,\t'English',''),\n\t\t\t\t(8,\t'Espa\u00f1ol','esp'),\n\t\t\t\t(9,\t'Euskara',''),\n\t\t\t\t(10,\t'Fran\u00e7ais','fre'),\n\t\t\t\t(11,\t'Galego',''),\n\t\t\t\t(12,\t'Hrvatski',''),\n\t\t\t\t(13,\t'IsiZulu',''),\n\t\t\t\t(14,\t'\u00cdslenska',''),\n\t\t\t\t(15,\t'Italiano','ita'),\n\t\t\t\t(16,\t'Magyar',''),\n\t\t\t\t(17,\t'Nederlands','nld'),\n\t\t\t\t(18,\t'Norsk bokm\u00e5l',''),\n\t\t\t\t(19,\t'Polski','pol'),\n\t\t\t\t(20,\t'Portugu\u00eas','por'),\n\t\t\t\t(21,\t'Rom\u00e2n\u0103',''),\n\t\t\t\t(22,\t'Sloven\u010dina',''),\n\t\t\t\t(23,\t'Suomi','fin'),\n\t\t\t\t(24,\t'Svenska',''),\n\t\t\t\t(25,\t'T\u00fcrk\u00e7e','tur'),\n\t\t\t\t(26,\t'\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438',''),\n\t\t\t\t(27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439','rus'),\n\t\t\t\t(28,\t'\u0421\u0440\u043f\u0441\u043a\u0438',''),\n\t\t\t\t(29,\t'\ud55c\uad6d\uc5b4',''),\n\t\t\t\t(30,\t'\u4e2d\u6587',''),\n\t\t\t\t(31,\t'\u65e5\u672c\u8a9e',''),\n\t\t\t\t(32,\t'Lingua lat\u012bna',''),\n\t\t\t\t(33,\t'Lithuanian','lit'),\n\t\t\t\t(34,\t'Latvia',''),\n\t\t\t\t(35,\t'Afar',''),\n\t\t\t\t(36,\t'Arabic',''),\n\t\t\t\t(37,\t'Assamese',''),\n\t\t\t\t(38,\t'Azerbaijani',''),\n\t\t\t\t(39,\t'Bulgarian','bgr'),\n\t\t\t\t(40,\t'Bangla',''),\n\t\t\t\t(41,\t'Bosnian',''),\n\t\t\t\t(42,\t'Cakchiquel',''),\n\t\t\t\t(43,\t'Danish',''),\n\t\t\t\t(44,\t'Greek',''),\n\t\t\t\t(45,\t'Estonian',''),\n\t\t\t\t(46,\t'Persian',''),\n\t\t\t\t(47,\t'Filipino',''),\n\t\t\t\t(48,\t'Gujarati',''),\n\t\t\t\t(49,\t'Hebrew',''),\n\t\t\t\t(50,\t'Croatian',''),\n\t\t\t\t(51,\t'Indonesia',''),\n\t\t\t\t(52,\t'Icelandic',''),\n\t\t\t\t(53,\t'Georgian',''),\n\t\t\t\t(54,\t'Maori (New Zealand)',''),\n\t\t\t\t(55,\t'Macedonian',''),\n\t\t\t\t(56,\t'Malay (Latin)',''),\n\t\t\t\t(57,\t'Maltese',''),\n\t\t\t\t(58,\t'Norwegian Nynorsk',''),\n\t\t\t\t(59,\t'Norwegian','nor'),\n\t\t\t\t(60,\t'Northern Sotho (South Africa)',''),\n\t\t\t\t(61,\t'Slovenian',''),\n\t\t\t\t(63,\t'Thai',''),\n\t\t\t\t(64,\t'Tagalog',''),\n\t\t\t\t(65,\t'Tongan',''),\n\t\t\t\t(66,\t'Ukrainian',''),\n\t\t\t\t(67,\t'Vietnamese','vnm'),\n\t\t\t\t(68,\t'Chinese','chn');\");\n\n            $db->query(\"INSERT INTO `lh_speech_language_dialect` (`id`, `language_id`, `lang_name`, `lang_code`, `short_code`) VALUES\n(1,\t1,\t'Afrikaans',\t'af-ZA',\t'af'),\n(2,\t2,\t'Bahasa Indonesia',\t'id-ID',\t'id'),\n(3,\t3,\t'Bahasa Melayu',\t'ms-MY',\t''),\n(4,\t4,\t'Catal\u00e0',\t'ca-ES',\t''),\n(5,\t5,\t'\u010ce\u0161tina',\t'cs-CZ',\t'cs'),\n(6,\t6,\t'Deutsch',\t'de-DE',\t'de'),\n(7,\t7,\t'Australia',\t'en-AU',\t''),\n(8,\t7,\t'Canada',\t'en-CA',\t''),\n(9,\t7,\t'India',\t'en-IN',\t''),\n(10,\t7,\t'New Zealand',\t'en-NZ',\t''),\n(11,\t7,\t'South Africa',\t'en-ZA',\t''),\n(12,\t7,\t'United Kingdom',\t'en-GB',\t'en'),\n(13,\t7,\t'United States',\t'en-US',\t''),\n(14,\t8,\t'Argentina',\t'es-AR',\t''),\n(15,\t8,\t'Bolivia',\t'es-BO',\t''),\n(16,\t8,\t'Chile',\t'es-CL',\t''),\n(17,\t8,\t'Colombia',\t'es-CO',\t''),\n(18,\t8,\t'Costa Rica',\t'es-CR',\t''),\n(19,\t8,\t'Ecuador',\t'es-EC',\t''),\n(20,\t8,\t'El Salvador',\t'es-SV',\t''),\n(21,\t8,\t'Espa\u00f1a',\t'es-ES',\t'es'),\n(22,\t8,\t'Estados Unidos',\t'es-US',\t''),\n(23,\t8,\t'Guatemala',\t'es-GT',\t''),\n(24,\t8,\t'Honduras',\t'es-HN',\t''),\n(25,\t8,\t'M\u00e9xico',\t'es-MX',\t''),\n(26,\t8,\t'Nicaragua',\t'es-NI',\t''),\n(27,\t8,\t'Panam\u00e1',\t'es-PA',\t''),\n(28,\t8,\t'Paraguay',\t'es-PY',\t''),\n(29,\t8,\t'Per\u00fa',\t'es-PE',\t''),\n(30,\t8,\t'Puerto Rico',\t'es-PR',\t''),\n(31,\t8,\t'Rep\u00fablica Dominicana',\t'es-DO',\t''),\n(32,\t8,\t'Uruguay',\t'es-UY',\t''),\n(33,\t8,\t'Venezuela',\t'es-VE',\t''),\n(34,\t9,\t'Euskara',\t'eu-ES',\t''),\n(35,\t10,\t'Fran\u00e7ais',\t'fr-FR',\t'fr'),\n(36,\t11,\t'Galego',\t'gl-ES',\t''),\n(37,\t12,\t'Hrvatski',\t'hr_HR',\t''),\n(38,\t13,\t'IsiZulu',\t'zu-ZA',\t''),\n(39,\t14,\t'\u00cdslenska',\t'is-IS',\t''),\n(40,\t15,\t'Italia',\t'it-IT',\t'it'),\n(41,\t15,\t'Svizzera',\t'it-CH',\t'it'),\n(42,\t16,\t'Magyar',\t'hu-HU',\t'hu'),\n(43,\t17,\t'Nederlands',\t'nl-NL',\t'nl'),\n(44,\t18,\t'Norsk bokm\u00e5l',\t'nb-NO',\t'nb'),\n(45,\t19,\t'Polski',\t'pl-PL',\t'pl'),\n(46,\t20,\t'Brasil',\t'pt-BR',\t''),\n(47,\t20,\t'Portugal',\t'pt-PT',\t'pt'),\n(48,\t21,\t'Rom\u00e2n\u0103',\t'ro-RO',\t'ro'),\n(49,\t22,\t'Sloven\u010dina',\t'sk-SK',\t'sk'),\n(50,\t23,\t'Suomi',\t'fi-FI',\t'fi'),\n(51,\t24,\t'Swedish',\t'sv-SE',\t'sv'),\n(52,\t25,\t'T\u00fcrk\u00e7e',\t'tr-TR',\t'tr'),\n(53,\t26,\t'\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438',\t'bg-BG',\t''),\n(54,\t27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439',\t'ru-RU',\t'ru'),\n(55,\t28,\t'Serbian',\t'sr-RS',\t'sr'),\n(56,\t29,\t'\ud55c\uad6d\uc5b4',\t'ko-KR',\t'ko'),\n(57,\t30,\t'\u666e\u901a\u8bdd (\u4e2d\u56fd\u5927\u9646)',\t'cmn-Hans-CN',\t''),\n(58,\t30,\t'\u666e\u901a\u8bdd (\u9999\u6e2f)',\t'cmn-Hans-HK',\t''),\n(59,\t30,\t'\u4e2d\u6587 (\u53f0\u7063)',\t'cmn-Hant-TW',\t''),\n(60,\t30,\t'\u7cb5\u8a9e (\u9999\u6e2f)',\t'yue-Hant-HK',\t''),\n(61,\t31,\t'\u65e5\u672c\u8a9e',\t'ja-JP',\t'ja'),\n(62,\t32,\t'Lingua lat\u012bna',\t'la',\t''),\n(64,\t33,\t'Lithuanian',\t'lt-LT',\t'lt'),\n(65,\t34,\t'Latvia',\t'lv-LV',\t'lv'),\n(66,\t35,\t'Afar',\t'aa-DJ',\t'aa'),\n(67,\t36,\t'Egypt',\t'ar-EG',\t'ar'),\n(68,\t37,\t'India',\t'as-IN',\t'as'),\n(69,\t38,\t'Azerbaijani',\t'az-AZ',\t'az'),\n(70,\t39,\t'Bulgarian',\t'bg',\t'bg'),\n(71,\t40,\t'Bangla',\t'bn',\t'bn'),\n(72,\t41,\t'Bosnian',\t'bs-BA',\t'bs'),\n(73,\t42,\t'Cakchiquel',\t'cak',\t'cak'),\n(74,\t43,\t'Danish',\t'da-dk',\t'da'),\n(75,\t44,\t'Greek',\t'el-GR',\t'el'),\n(76,\t45,\t'Estonian',\t'et-EE',\t'et'),\n(77,\t46,\t'Persian',\t'fa-IR',\t'fa'),\n(78,\t47,\t'Filipino',\t'fil',\t'fil'),\n(79,\t48,\t'Gujarati',\t'gu-IN',\t'gu'),\n(80,\t49,\t'Hebrew',\t'he',\t'he'),\n(81,\t50,\t'Croatian',\t'hr-HR',\t'hr'),\n(82,\t51,\t'Indonesia',\t'in',\t'in'),\n(83,\t52,\t'Icelandic',\t'is',\t'is'),\n(84,\t53,\t'Georgian',\t'ka-ge',\t'ka'),\n(85,\t54,\t'Maori (New Zealand)',\t'mi-nz',\t'mi'),\n(86,\t55,\t'Macedonian',\t'mk-MK',\t'mk'),\n(87,\t56,\t'Malay (Latin)',\t'ms',\t'ms'),\n(88,\t57,\t'Maltese',\t'mt',\t'mt'),\n(89,\t58,\t'Norwegian Nynorsk',\t'nn-NO',\t'nn'),\n(90,\t59,\t'Norwegian',\t'no',\t'no'),\n(91,\t60,\t'Northern Sotho (South Africa)',\t'nso-za',\t'nso'),\n(92,\t61,\t'Slovenian',\t'sl-SI',\t'sl'),\n(94,\t63,\t'Thai',\t'th-TH',\t'th'),\n(95,\t64,\t'Tagalog',\t'tl',\t'tl'),\n(96,\t65,\t'Tongan',\t'to-TO',\t'to'),\n(97,\t66,\t'Ukrainian',\t'uk-UA',\t'uk'),\n(98,\t67,\t'Vietnamese',\t'vi-VN',\t'vi'),\n(99,\t68,\t'Chinese',\t'zh-CN',\t'zh'),\n(100,\t36,\t'Egypt',\t'ar-AE',\t''),\n(101,\t36,\t'Egypt',\t'ar-IQ',\t''),\n(102,\t41,\t'Bosnian',\t'bs-Latn-BA',\t''),\n(103,\t6,\t'Deutsch',\t'de-at',\t''),\n(104,\t6,\t'Deutsch',\t'de-ch',\t''),\n(105,\t6,\t'Deutsch',\t'de-GB',\t''),\n(106,\t6,\t'Deutsch',\t'de-LI',\t''),\n(107,\t6,\t'Deutsch',\t'de-LU',\t''),\n(108,\t7,\t'United Kingdom',\t'en-029',\t''),\n(109,\t7,\t'United Kingdom',\t'en-AS',\t''),\n(110,\t7,\t'United Kingdom',\t'en-BE',\t''),\n(111,\t7,\t'United Kingdom',\t'en-BM',\t''),\n(112,\t7,\t'United Kingdom',\t'en-BS',\t''),\n(113,\t7,\t'United Kingdom',\t'en-BW',\t''),\n(114,\t7,\t'United Kingdom',\t'en-CH',\t''),\n(115,\t7,\t'United Kingdom',\t'en-CX',\t''),\n(116,\t7,\t'United Kingdom',\t'en-CY',\t''),\n(117,\t7,\t'United Kingdom',\t'en-DE',\t''),\n(118,\t7,\t'United Kingdom',\t'en-DK',\t''),\n(119,\t7,\t'United Kingdom',\t'en-DM',\t''),\n(120,\t7,\t'United Kingdom',\t'en-GY',\t''),\n(121,\t7,\t'United Kingdom',\t'en-HK',\t''),\n(122,\t7,\t'United Kingdom',\t'en-ie',\t''),\n(123,\t7,\t'United Kingdom',\t'en-IM',\t''),\n(124,\t7,\t'United Kingdom',\t'en-JM',\t''),\n(125,\t7,\t'United Kingdom',\t'en-KY',\t''),\n(126,\t7,\t'United Kingdom',\t'en-MY',\t''),\n(127,\t7,\t'United Kingdom',\t'en-NF',\t''),\n(128,\t7,\t'United Kingdom',\t'en-NG',\t''),\n(129,\t7,\t'United Kingdom',\t'en-NL',\t''),\n(130,\t7,\t'United Kingdom',\t'en-PH',\t''),\n(131,\t7,\t'United Kingdom',\t'en-SE',\t''),\n(132,\t7,\t'United Kingdom',\t'en-sg',\t''),\n(133,\t7,\t'United Kingdom',\t'en-SI',\t''),\n(134,\t7,\t'United Kingdom',\t'en-SS',\t''),\n(135,\t7,\t'United Kingdom',\t'en-TO',\t''),\n(136,\t7,\t'United Kingdom',\t'en-TZ',\t''),\n(137,\t7,\t'United Kingdom',\t'en-UG',\t''),\n(138,\t7,\t'United Kingdom',\t'en-UK',\t''),\n(139,\t7,\t'United Kingdom',\t'en-ZG',\t''),\n(140,\t7,\t'United Kingdom',\t'en-ZM',\t''),\n(141,\t7,\t'United Kingdom',\t'en-ZW',\t''),\n(142,\t8,\t'Espa\u00f1a',\t'es-419',\t''),\n(143,\t8,\t'Espa\u00f1a',\t'es-xl',\t''),\n(144,\t47,\t'Filipino',\t'fil-PH',\t''),\n(145,\t10,\t'Fran\u00e7ais',\t'fr-BE',\t''),\n(146,\t10,\t'Fran\u00e7ais',\t'fr-ca',\t''),\n(147,\t10,\t'Fran\u00e7ais',\t'fr-ch',\t''),\n(148,\t10,\t'Fran\u00e7ais',\t'fr-CM',\t''),\n(149,\t10,\t'Fran\u00e7ais',\t'fr-MC',\t''),\n(150,\t49,\t'Hebrew',\t'he-IL',\t''),\n(151,\t50,\t'Croatian',\t'hr-BA',\t''),\n(152,\t17,\t'Nederlands',\t'nl-BE',\t''),\n(153,\t19,\t'Polski',\t'pl-GB',\t''),\n(154,\t27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439',\t'ru-KZ',\t''),\n(155,\t27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439',\t'ru-UA',\t''),\n(156,\t28,\t'Serbian',\t'sr-BA',\t''),\n(157,\t28,\t'Serbian',\t'sr-Latn-RS',\t''),\n(158,\t68,\t'Chinese',\t'zh-MO',\t''),\n(159,\t68,\t'Chinese',\t'zh-SG',\t''),\n(160,\t68,\t'Chinese',\t'zh-TW',\t'');\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_speech_chat_language` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `chat_id` int(11) NOT NULL,\n                  `language_id` int(11) NOT NULL,\n                  `dialect` varchar(50) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `chat_id` (`chat_id`)\n               ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_file` (\n        \t   `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n        \t   `name` varchar(255) NOT NULL,\n        \t   `upload_name` varchar(255) NOT NULL,\n        \t   `size` int(11) NOT NULL,\n        \t   `type` varchar(255) NOT NULL,\n        \t   `file_path` varchar(255) NOT NULL,\n        \t   `extension` varchar(255) NOT NULL,\n        \t   `chat_id` bigint(20) NOT NULL,\n        \t   `persistent` int(11) NOT NULL,\n        \t   `online_user_id` int(11) NOT NULL,\n        \t   `user_id` int(11) NOT NULL,\n        \t   `date` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `chat_id` (`chat_id`),\n        \t   KEY `online_user_id` (`online_user_id`),\n        \t   KEY `user_id` (`user_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_email_template` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `name` varchar(250) NOT NULL,\n\t\t\t\t  `from_name` varchar(150) NOT NULL,\n\t\t\t\t  `from_name_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `from_email` varchar(150) NOT NULL,\n\t\t\t\t  `from_email_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `user_mail_as_sender` tinyint(4) NOT NULL,\n\t\t\t\t  `content` text NOT NULL,\n\t\t\t\t  `use_chat_locale` tinyint(1) NOT NULL DEFAULT '0',\n                  `translations` longtext NOT NULL,\n\t\t\t\t  `subject` varchar(250) NOT NULL,\n\t\t\t\t  `bcc_recipients` varchar(200) NOT NULL,\n\t\t\t\t  `subject_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `reply_to` varchar(150) NOT NULL,\n\t\t\t\t  `reply_to_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `recipient` varchar(150) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"INSERT INTO `lh_abstract_email_template` (`id`, `translations`, `name`, `from_name`, `from_name_ac`, `from_email`, `from_email_ac`, `content`, `subject`, `subject_ac`, `reply_to`, `reply_to_ac`, `recipient`, `bcc_recipients`, `user_mail_as_sender`) VALUES\n            \t   (1,'',\t'Send mail to user',\t'Live Helper Chat',\t0,\t'',\t0,\t'Dear {user_chat_nick},\\r\\n\\r\\n{additional_message}\\r\\n\\r\\nLive Support response:\\r\\n{messages_content}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team\\r\\n',\t'{name_surname} has responded to your request',\t1,\t'',\t1,\t'',\t'',\t0),\n            \t   (2,'',\t'Support request from user',\t'',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nAdditional data, if any:\\r\\n{additional_data}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nLink to chat if any:\\r\\n{prefillchat}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'{name}, {country}, {department}, Support request from user',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (3,'',\t'User mail for himself',\t'Live Helper Chat',\t0,\t'',\t0,\t'Dear {user_chat_nick},\\r\\n\\r\\nTranscript:\\r\\n{messages_content}\\r\\nChat ID: {chat_id}\\n\\r\\nSincerely,\\r\\nLive Support Team\\r\\n',\t'Chat transcript',\t0,\t'',\t0,\t'',\t'',\t0),\n            \t   (4,'',\t'New chat request',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nClick to accept chat automatically\\r\\n{url_accept}\\r\\n\\r\\nSurvey\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'New chat request',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (5,'',\t'Chat was closed',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\n{operator} has closed a chat\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nAdditional data, if any:\\r\\n{additional_data}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nSurvey:\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Chat was closed',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (6,'',\t'New FAQ question',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nNew FAQ question\\r\\nEmail: {email}\\r\\n\\r\\nQuestion:\\r\\n{question}\\r\\n\\r\\nQuestion URL:\\r\\n{url_question}\\r\\n\\r\\nURL to answer a question:\\r\\n{url_request}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'New FAQ question',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (7,'',\t'New unread message',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nClick to accept chat automatically\\r\\n{url_accept}\\r\\n\\r\\nSurvey:\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'New unread message',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (8,'',\t'Filled form',\t'MCFC',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser has filled a form\\r\\nForm name - {form_name}\\r\\nUser IP - {ip}\\r\\nDownload filled data - {url_download}\\r\\nView filled data - {url_view}\\r\\n\\r\\n{content}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Filled form - {form_name}',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (9,'',\t'Chat was accepted',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nOperator {user_name} has accepted a chat [{chat_id}]\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nClick to accept chat automatically\\r\\n{url_accept}\\r\\n\\r\\nSurvey:\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Chat was accepted [{chat_id}]',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (10,'',\t'Permission request',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nOperator {user} has requested these permissions\\n\\r\\n{permissions}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Permission request from {user}',\t0,\t'',\t0,\t'',\t'',\t0),\n            \t   (11,'',\t'You have unread messages',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nOperator {operator} has answered to you\\r\\n\\r\\n{messages}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Operator has answered to your request',\t0,\t'',\t0,\t'',\t'',\t0),\n            \t   (12,'',\t'Visitor returned',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nVisitor information\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nSee more information at\\r\\n{url_accept}\\r\\n\\r\\nLast chat:\\r\\n{message}\\r\\n\\r\\nAdditional data, if any:\\r\\n{additional_data}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Visitor returned - {username}',\t0,\t'',\t0,\t'',\t'',\t0);\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `question` varchar(250) NOT NULL,\n        \t   `location` varchar(250) NOT NULL,\n        \t   `active` int(11) NOT NULL,\n        \t   `priority` int(11) NOT NULL,\n        \t   `is_voting` int(11) NOT NULL,\n        \t   `question_intro` text NOT NULL,\n        \t   `revote` int(11) NOT NULL DEFAULT '0',\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `priority` (`priority`),\n        \t   KEY `active_priority` (`active`,`priority`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question_answer` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `ip` bigint(20) NOT NULL,\n        \t   `question_id` int(11) NOT NULL,\n        \t   `answer` text NOT NULL,\n        \t   `ctime` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `ip` (`ip`),\n        \t   KEY `question_id` (`question_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question_option` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `question_id` int(11) NOT NULL,\n        \t   `option_name` varchar(250) NOT NULL,\n        \t   `priority` tinyint(4) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `question_id` (`question_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question_option_answer` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `question_id` int(11) NOT NULL,\n        \t   `option_id` int(11) NOT NULL,\n        \t   `ctime` int(11) NOT NULL,\n        \t   `ip` bigint(20) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `question_id` (`question_id`),\n        \t   KEY `ip` (`ip`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_product` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT, \n        \t       `name` varchar(250) NOT NULL, \n        \t       `disabled` int(11) NOT NULL, \n        \t       `priority` int(11) NOT NULL, \n        \t       `departament_id` int(11) NOT NULL, \n        \t       KEY `departament_id` (`departament_id`), \n        \t       PRIMARY KEY (`id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_browse_offer_invitation` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `siteaccess` varchar(10) NOT NULL,\n\t\t\t\t  `time_on_site` int(11) NOT NULL,\n\t\t\t\t  `content` longtext NOT NULL,\n\t\t\t\t  `callback_content` longtext NOT NULL,\n\t\t\t\t  `lhc_iframe_content` tinyint(4) NOT NULL,\n\t\t\t\t  `custom_iframe_url` varchar(250) NOT NULL,\n\t\t\t\t  `name` varchar(250) NOT NULL,\n\t\t\t\t  `identifier` varchar(50) NOT NULL,\n\t\t\t\t  `executed_times` int(11) NOT NULL,\n\t\t\t\t  `url` varchar(250) NOT NULL,\n\t\t\t\t  `active` int(11) NOT NULL,\n\t\t\t\t  `has_url` int(11) NOT NULL,\n\t\t\t\t  `is_wildcard` int(11) NOT NULL,\n\t\t\t\t  `referrer` varchar(250) NOT NULL,\n\t\t\t\t  `priority` varchar(250) NOT NULL,\n\t\t\t\t  `hash` varchar(40) NOT NULL,\n\t\t\t\t  `width` int(11) NOT NULL,\n\t\t\t\t  `height` int(11) NOT NULL,\n\t\t\t\t  `unit` varchar(10) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `active` (`active`),\n\t\t\t\t  KEY `identifier` (`identifier`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_form` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `name` varchar(100) NOT NULL,        \t   \n        \t   `content` longtext NOT NULL,\n        \t   `recipient` varchar(250) NOT NULL,\n        \t   `active` int(11) NOT NULL,\n        \t   `name_attr` varchar(250) NOT NULL,\n        \t   `intro_attr` varchar(250) NOT NULL,\n        \t   `xls_columns` text NOT NULL,\n        \t   `pagelayout` varchar(200) NOT NULL,\n        \t   `post_content` text NOT NULL,\n        \t   PRIMARY KEY (`id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_form_collected` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `form_id` int(11) NOT NULL,\n\t\t\t\t  `ctime` int(11) NOT NULL,\n\t\t\t\t  `ip` varchar(250) NOT NULL,\n        \t   \t  `identifier` varchar(250) NOT NULL,\n        \t   \t  `chat_id` bigint(20) NOT NULL,\n\t\t\t\t  `content` longtext NOT NULL,\n\t\t\t\t  `custom_fields` longtext NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `form_id` (`form_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chatbox` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `identifier` varchar(50) NOT NULL,\n\t\t\t\t  `name` varchar(100) NOT NULL,\n\t\t\t\t  `chat_id` int(11) NOT NULL,\n\t\t\t\t  `active` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `identifier` (`identifier`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_chat_action` (\n                `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `chat_id` bigint(20) NOT NULL,\n                  `action` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `body` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `created_at` bigint(20) unsigned NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `chat_id` (`chat_id`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_canned_msg` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `msg` longtext NOT NULL,\n                  `fallback_msg` text NOT NULL,\n                  `title` varchar(250) NOT NULL,\n                  `explain` varchar(250) NOT NULL,\n                  `languages` text NOT NULL,\n                  `additional_data` text NOT NULL,\n        \t   \t  `position` int(11) NOT NULL,\n                  `disabled` tinyint(1) unsigned NOT NULL NULL DEFAULT 0,\n        \t   \t  `department_id` int(11) NOT NULL,\n        \t   \t  `user_id` int(11) NOT NULL,\n  \t\t\t\t  `delay` int(11) NOT NULL,\n        \t   \t  `auto_send` tinyint(1) NOT NULL,\n        \t   \t  `html_snippet` longtext NOT NULL,\n        \t   \t  `attr_int_1` int(11) NOT NULL,\n        \t   \t  `attr_int_2` int(11) NOT NULL,\n        \t   \t  `attr_int_3` int(11) NOT NULL,\n                  `unique_id` varchar(20) NOT NULL,\n                  `updated_at` int(11) unsigned NOT NULL DEFAULT 0,\n                  `created_at` int(11) unsigned NOT NULL DEFAULT 0,\n                  `active_from` int(11) unsigned NOT NULL DEFAULT 0,\n                  `active_to` int(11) unsigned NOT NULL DEFAULT 0,\n                  `repetitiveness` int(11) unsigned NOT NULL DEFAULT 0,\n                  `days_activity` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                  PRIMARY KEY (`id`),\n        \t   \t  KEY `department_id` (`department_id`),\n        \t   \t  KEY `disabled` (`disabled`),\n        \t   \t  KEY `attr_int_1` (`attr_int_1`),\n        \t   \t  KEY `attr_int_2` (`attr_int_2`),\n        \t   \t  KEY `attr_int_3` (`attr_int_3`),\n        \t   \t  KEY `position_title_v2` (`position`, `title`(191)),\n        \t   \t  KEY `user_id` (`user_id`),\n        \t   \t  KEY `unique_id` (`unique_id`),\n                  KEY `repetitiveness` (`repetitiveness`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_online_user_footprint` (\n\t\t\t\t  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `chat_id` bigint(20) NOT NULL,\n\t\t\t\t  `online_user_id` int(11) NOT NULL,\n\t\t\t\t  `page` varchar(2083) NOT NULL,\n\t\t\t\t  `vtime` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `chat_id` (`chat_id`),\n\t\t\t\t  KEY `online_user_id` (`online_user_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_invitation_dep` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n    `invitation_id` int(11) NOT NULL,\n    `dep_id` int(11) NOT NULL,\n    PRIMARY KEY (`id`),\n    KEY `invitation_id` (`invitation_id`),\n    KEY `dep_id` (`dep_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_event` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `vid_id` int(11) NOT NULL,\n        \t       `ev_id` int(11) NOT NULL,\n        \t       `ts` int(11) NOT NULL,\n        \t       `val` varchar(50) NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `vid_id_ev_id_val_ts` (`vid_id`,`ev_id`,`val`,`ts`),\n        \t       KEY `vid_id_ev_id_ts` (`vid_id`,`ev_id`,`ts`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_invitation_event` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `invitation_id` int(11) NOT NULL,\n        \t       `event_id` int(11) NOT NULL,\n        \t       `min_number` int(11) NOT NULL,\n        \t       `during_seconds` int(11) NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `invitation_id` (`invitation_id`),\n        \t       KEY `event_id` (`event_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_variables` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `name` varchar(50) NOT NULL,\n        \t       `identifier` varchar(50) NOT NULL,\n        \t       `store_timeout` int(11) NOT NULL,\n        \t       `filter_val` int(11) NOT NULL DEFAULT '0',\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `identifier` (`identifier`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_campaign` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL, `text` text NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_abstract_chat_alert_icon` (`id` bigint(20) NOT NULL AUTO_INCREMENT,`name` varchar(50) NOT NULL, `identifier` varchar(50) NOT NULL,PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_campaign_conv` (\n                  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `device_type` tinyint(11) NOT NULL,\n\t\t\t\t  `invitation_type` tinyint(1) NOT NULL,\n\t\t\t\t  `invitation_status` tinyint(1) NOT NULL,\n\t\t\t\t  `chat_id` bigint(20) NOT NULL,\n\t\t\t\t  `campaign_id` int(11) NOT NULL,\n\t\t\t\t  `invitation_id` int(11) NOT NULL,\n\t\t\t\t  `department_id` int(11) NOT NULL,\n\t\t\t\t  `ctime` int(11) NOT NULL,\n\t\t\t\t  `con_time` int(11) NOT NULL,\n\t\t\t\t  `vid_id` bigint(20) DEFAULT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `ctime` (`ctime`),\n\t\t\t\t  KEY `campaign_id` (`campaign_id`),\n\t\t\t\t  KEY `invitation_id` (`invitation_id`),\n\t\t\t\t  KEY `invitation_status` (`invitation_status`)\n\t\t\t\t) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users_setting` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `user_id` int(11) NOT NULL,\n        \t   `identifier` varchar(50) NOT NULL,\n        \t   `value` text NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `user_id` (`user_id`,`identifier`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_departament_limit_group_member` (  \n    \t       `id` int(11) NOT NULL AUTO_INCREMENT,  \n    \t       `dep_id` int(11) NOT NULL,  \n    \t       `dep_limit_group_id` int(11) NOT NULL,  \n    \t       PRIMARY KEY (`id`),  \n    \t       KEY `dep_limit_group_id` (`dep_limit_group_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_departament_limit_group` (  \n    \t       `id` int(11) NOT NULL AUTO_INCREMENT,  \n    \t       `name` varchar(50) NOT NULL,\n    \t       `pending_max` int(11) NOT NULL,  \n    \t       PRIMARY KEY (`id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_auto_responder_chat` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `chat_id` int(11) NOT NULL,\n                  `auto_responder_id` int(11) NOT NULL,\n                  `wait_timeout_send` int(11) NOT NULL,\n                  `pending_send_status` int(11) NOT NULL,\n                  `active_send_status` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `chat_id` (`chat_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users_setting_option` (\n\t\t\t\t  `identifier` varchar(50) NOT NULL,\n\t\t\t\t  `class` varchar(50) NOT NULL,\n\t\t\t\t  `attribute` varchar(40) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`identifier`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"INSERT INTO `lh_users_setting_option` (`identifier`, `class`, `attribute`) VALUES\n        \t   ('chat_message',\t'',\t''),\n        \t   ('new_chat_sound',\t'',\t''),\n        \t   ('enable_pending_list', '', ''),\n        \t   ('enable_active_list', '', ''),\n        \t   ('enable_close_list', '', ''),\n        \t   ('new_user_bn', '', ''),\n        \t   ('new_user_sound', '', ''),\n        \t   ('oupdate_timeout', '', ''),\n        \t   ('ouser_timeout', '', ''),\n        \t   ('o_department', '', ''),\n        \t   ('omax_rows', '', ''),\n        \t   ('ogroup_by', '', ''),\n        \t   ('omap_depid', '', ''),\n        \t   ('omap_mtimeout', '', ''),\n        \t   ('ocountry', '', ''),\n        \t   ('otime_on_site', '', ''),\n        \t   ('dwo', '', ''),\n        \t   ('enable_unread_list', '', '')\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_config` (\n                  `identifier` varchar(50) NOT NULL,\n                  `value` text NOT NULL,\n                  `type` tinyint(1) NOT NULL DEFAULT '0',\n                  `explain` varchar(250) NOT NULL,\n                  `hidden` int(11) NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`identifier`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $randomHash = erLhcoreClassModelForgotPassword::randomPassword(9);\n            $randomHashLength = strlen($randomHash);\n            $exportHash = erLhcoreClassModelForgotPassword::randomPassword(9);\n\n            if (extension_loaded('bcmath')){\n                $geoRow = \"('geo_data','a:5:{i:0;b:0;s:21:\\\"geo_detection_enabled\\\";i:1;s:22:\\\"geo_service_identifier\\\";s:8:\\\"max_mind\\\";s:23:\\\"max_mind_detection_type\\\";s:7:\\\"country\\\";s:22:\\\"max_mind_city_location\\\";s:37:\\\"var/external/geoip/GeoLite2-City.mmdb\\\";}',0,'',1)\";\n            } else {\n                $geoRow = \"('geo_data', '', '0', '', '1')\";\n            }\n\n            $db->query(\"INSERT INTO `lh_chat_config` (`identifier`, `value`, `type`, `explain`, `hidden`) VALUES\n                ('tracked_users_cleanup',\t'160',\t0,\t'How many days keep records of online users.',\t0),\n        \t   \t('list_online_operators', '1', '0', 'List online operators.', '0'),\n        \t   \t('voting_days_limit',\t'7',\t0,\t'How many days voting widget should not be expanded after last show',\t0),\n                ('track_online_visitors',\t'1',\t0,\t'Enable online site visitors tracking',\t0),\n        \t   \t('pro_active_invite',\t'1',\t0,\t'Is pro active chat invitation active. Online users tracking also has to be enabled',\t0),\n                ('customer_company_name',\t'Live Helper Chat',\t0,\t'Your company name - visible in bottom left corner',\t0),\n                ('customer_site_url',\t'http://livehelperchat.com',\t0,\t'Your site URL address',\t0),\n                ('transfer_configuration','0','0','Transfer configuration','1'),\n                ('list_unread','0','0','List unread chats','0'),\n                ('autoclose_abandon_pending','0,0','0','Automatically close pending chats where visitor has left a chat. Timeout in minutes, last activity by visitor <desktop timeout>,<mobile timeout>,<status chat>.','0'),\n                ('mobile_options',\t'a:2:{s:13:\\\"notifications\\\";i:0;s:7:\\\"fcm_key\\\";s:152:\\\"AAAAiF8DeNk:APA91bFVHu2ybhBUTtlEtQrUEPpM2fb-5ovgo0FVNm4XxK3cYJtSwRcd-pqcBot_422yDOzHyw2p9ZFplkHrmNXjm8f5f-OIzfalGmpsypeXvnPxhU6Db1B2Z1Acc-TamHUn2F4xBJkP\\\";}',\t0,\t'',\t1),\n                ('list_closed','0','0','List closed chats','0'),\n                ('autoclose_activity_timeout','0','0','Automatically close active chat if from last visitor/operator message passed. 0 - disabled, n > 0 time in minutes','0'),\n                ('footprint_background','0','0','Footprint updates should be processed in the background. Make sure you are running workflow background cronjob.','0'),\n                ('reverse_pending','0','0','Make default pending chats order from old to new','0'),\n                ('departament_availability','364','0','How long department availability statistic should be kept? (days)','0'),\n                ('uonline_sessions','364','0','How long keep operators online sessions data? (days)','0'),\n                ('disable_live_autoassign','0','0','Disable live auto assign','0'),\n                ('tracked_footprint_cleanup','90','0','How many days keep records of users footprint.','0'),\n                ('cleanup_cronjob','0','0','Cleanup should be done only using cronjob.','0'),         \n                ('vwait_to_long','120','0','How long we should wait before we inform operator about unanswered chat.','0'),\n                ('no_wildcard_cookie','0','0','Cookie should be valid only for domain where Javascript is embedded (excludes subdomains)','0'),\n                ('cduration_timeout_user','4','0','How long operator can wait for message from visitor before time between messages are ignored. Values in minutes.','0'),\n                ('cduration_timeout_operator','10','0','How long visitor can wait for message from operator before time between messages are ignored. Values in minutes.','0'),       \n                ('assign_workflow_timeout','0','0','Chats waiting in pending line more than n seconds should be auto assigned first. Time in seconds','0'),\n        \t   \t('smtp_data',\t'a:5:{s:4:\\\"host\\\";s:0:\\\"\\\";s:4:\\\"port\\\";s:2:\\\"25\\\";s:8:\\\"use_smtp\\\";i:0;s:8:\\\"username\\\";s:0:\\\"\\\";s:8:\\\"password\\\";s:0:\\\"\\\";}',\t0,\t'SMTP configuration',\t1),\n        \t    ('chatbox_data',\t'a:6:{i:0;b:0;s:20:\\\"chatbox_auto_enabled\\\";i:0;s:19:\\\"chatbox_secret_hash\\\";s:{$randomHashLength}:\\\"{$randomHash}\\\";s:20:\\\"chatbox_default_name\\\";s:7:\\\"Chatbox\\\";s:17:\\\"chatbox_msg_limit\\\";i:50;s:22:\\\"chatbox_default_opname\\\";s:7:\\\"Manager\\\";}',\t0,\t'Chatbox configuration',\t1),\n                ('start_chat_data',\t'a:80:{i:0;b:0;s:21:\\\"name_visible_in_popup\\\";b:0;s:27:\\\"name_visible_in_page_widget\\\";b:0;s:19:\\\"name_require_option\\\";s:8:\\\"required\\\";s:22:\\\"email_visible_in_popup\\\";b:0;s:28:\\\"email_visible_in_page_widget\\\";b:0;s:20:\\\"email_require_option\\\";s:8:\\\"required\\\";s:24:\\\"message_visible_in_popup\\\";b:1;s:30:\\\"message_visible_in_page_widget\\\";b:1;s:22:\\\"message_require_option\\\";s:8:\\\"required\\\";s:22:\\\"phone_visible_in_popup\\\";b:0;s:28:\\\"phone_visible_in_page_widget\\\";b:0;s:20:\\\"phone_require_option\\\";s:8:\\\"required\\\";s:21:\\\"force_leave_a_message\\\";b:0;s:29:\\\"offline_name_visible_in_popup\\\";b:1;s:35:\\\"offline_name_visible_in_page_widget\\\";b:1;s:27:\\\"offline_name_require_option\\\";s:8:\\\"required\\\";s:30:\\\"offline_phone_visible_in_popup\\\";b:0;s:36:\\\"offline_phone_visible_in_page_widget\\\";b:0;s:28:\\\"offline_phone_require_option\\\";s:8:\\\"required\\\";s:32:\\\"offline_message_visible_in_popup\\\";b:1;s:38:\\\"offline_message_visible_in_page_widget\\\";b:1;s:30:\\\"offline_message_require_option\\\";s:8:\\\"required\\\";s:15:\\\"auto_start_chat\\\";b:0;s:12:\\\"mobile_popup\\\";b:0;s:17:\\\"dont_auto_process\\\";b:0;s:20:\\\"tos_visible_in_popup\\\";b:0;s:12:\\\"requires_dep\\\";b:0;s:17:\\\"requires_dep_lock\\\";b:0;s:17:\\\"show_messages_box\\\";b:1;s:26:\\\"tos_visible_in_page_widget\\\";b:0;s:19:\\\"tos_checked_offline\\\";b:0;s:18:\\\"tos_checked_online\\\";b:0;s:28:\\\"offline_tos_visible_in_popup\\\";b:0;s:34:\\\"offline_tos_visible_in_page_widget\\\";b:0;s:35:\\\"offline_file_visible_in_page_widget\\\";b:0;s:29:\\\"offline_file_visible_in_popup\\\";b:0;s:11:\\\"name_hidden\\\";b:0;s:15:\\\"name_hidden_bot\\\";b:0;s:24:\\\"custom_fields_encryption\\\";s:0:\\\"\\\";s:19:\\\"offline_name_hidden\\\";b:0;s:13:\\\"pre_chat_html\\\";s:0:\\\"\\\";s:21:\\\"pre_offline_chat_html\\\";s:0:\\\"\\\";s:12:\\\"email_hidden\\\";b:0;s:16:\\\"email_hidden_bot\\\";b:0;s:20:\\\"offline_email_hidden\\\";b:0;s:15:\\\"user_msg_height\\\";s:0:\\\"\\\";s:12:\\\"phone_hidden\\\";b:0;s:16:\\\"phone_hidden_bot\\\";b:0;s:20:\\\"offline_phone_hidden\\\";b:0;s:14:\\\"message_hidden\\\";b:0;s:18:\\\"message_hidden_bot\\\";b:0;s:18:\\\"message_auto_start\\\";b:0;s:28:\\\"message_auto_start_key_press\\\";b:0;s:22:\\\"offline_message_hidden\\\";b:0;s:21:\\\"show_operator_profile\\\";b:1;s:21:\\\"remove_operator_space\\\";b:0;s:18:\\\"hide_message_label\\\";b:0;s:17:\\\"custom_fields_url\\\";s:0:\\\"\\\";s:13:\\\"custom_fields\\\";s:0:\\\"\\\";s:21:\\\"name_hidden_prefilled\\\";b:0;s:22:\\\"email_hidden_prefilled\\\";b:0;s:24:\\\"message_hidden_prefilled\\\";b:0;s:22:\\\"phone_hidden_prefilled\\\";b:0;s:29:\\\"offline_name_hidden_prefilled\\\";b:0;s:32:\\\"offline_message_hidden_prefilled\\\";b:0;s:30:\\\"offline_phone_hidden_prefilled\\\";b:0;s:18:\\\"disable_start_chat\\\";b:0;s:18:\\\"offline_name_width\\\";i:0;s:19:\\\"offline_email_width\\\";i:0;s:19:\\\"offline_phone_width\\\";i:0;s:10:\\\"name_width\\\";i:0;s:11:\\\"email_width\\\";i:0;s:11:\\\"phone_width\\\";i:0;s:17:\\\"hide_start_button\\\";b:0;s:9:\\\"lazy_load\\\";b:0;s:28:\\\"offline_email_require_option\\\";s:8:\\\"required\\\";s:30:\\\"offline_email_hidden_prefilled\\\";b:0;s:36:\\\"offline_email_visible_in_page_widget\\\";b:1;s:30:\\\"offline_email_visible_in_popup\\\";b:1;}',\t0,\t'',\t1),\n                ('application_name',\t'a:6:{s:3:\\\"eng\\\";s:31:\\\"Live Helper Chat - live support\\\";s:3:\\\"lit\\\";s:26:\\\"Live Helper Chat - pagalba\\\";s:3:\\\"hrv\\\";s:0:\\\"\\\";s:3:\\\"esp\\\";s:0:\\\"\\\";s:3:\\\"por\\\";s:0:\\\"\\\";s:10:\\\"site_admin\\\";s:31:\\\"Live Helper Chat - live support\\\";}',\t1,\t'Support application name, visible in browser title.',\t0),\n                ('track_footprint',\t'0',\t0,\t'Track users footprint. For this also online visitors tracking should be enabled',\t0),\n                ('pro_active_limitation',\t'-1',\t0,\t'Pro active chats invitations limitation based on pending chats, (-1) do not limit, (0,1,n+1) number of pending chats can be for invitation to be shown.',\t0),\n                ('pro_active_show_if_offline',\t'0',\t0,\t'Should invitation logic be executed if there is no online operators',\t0),\n                ('export_hash',\t'{$exportHash}',\t0,\t'Chats export secret hash',\t0),\n                ('do_no_track_ip', 0, 0, 'Do not track visitors IP',0),\n                ('remember_username','1','0','Should we remember username for the next time visitor starts a chat?','0'),\n                ('ignore_typing', 0, 0, 'Do not store what visitor is typing',0),\n                ('encrypt_msg_after', 0, 0, 'After how many days anonymize messages',0),\n                ('encrypt_msg_op', 0, 0, 'Anonymize also operators messages',0),\n                ('valid_domains','','0','Domains where script can be embedded. E.g example.com, google.com','0'),\n                ('message_seen_timeout', 24, 0, 'Proactive message timeout in hours. After how many hours proactive chat mesasge should be shown again.',\t0),\n                ('reopen_chat_enabled',0,\t0,\t'Reopen chat functionality enabled',\t0),\n                ('ignorable_ip',\t'',\t0,\t'Which ip should be ignored in online users list, separate by comma',0),\n                ('run_departments_workflow', 0, 0, 'Should cronjob run departments transfer workflow, even if user leaves a chat',\t0),\n                ('geo_location_data', 'a:3:{s:4:\\\"zoom\\\";i:4;s:3:\\\"lat\\\";s:7:\\\"49.8211\\\";s:3:\\\"lng\\\";s:7:\\\"11.7835\\\";}', '0', '', '1'),\n                ('xmp_data','a:14:{i:0;b:0;s:4:\\\"host\\\";s:15:\\\"talk.google.com\\\";s:6:\\\"server\\\";s:9:\\\"gmail.com\\\";s:8:\\\"resource\\\";s:6:\\\"xmpphp\\\";s:4:\\\"port\\\";s:4:\\\"5222\\\";s:7:\\\"use_xmp\\\";i:0;s:8:\\\"username\\\";s:0:\\\"\\\";s:8:\\\"password\\\";s:0:\\\"\\\";s:11:\\\"xmp_message\\\";s:98:\\\"New chat request [{chat_id}] from [{department}]\\r\\n{messages}\\r\\nClick to accept a chat\\r\\n{url_accept}\\\";s:10:\\\"recipients\\\";s:0:\\\"\\\";s:20:\\\"xmp_accepted_message\\\";s:89:\\\"{user_name} has accepted a chat [{chat_id}] from [{department}]\\r\\n{messages}\\r\\n{url_accept}\\\";s:16:\\\"use_standard_xmp\\\";i:0;s:15:\\\"test_recipients\\\";s:0:\\\"\\\";s:21:\\\"test_group_recipients\\\";s:0:\\\"\\\";}',0,'XMP data',1),\n                ('run_unaswered_chat_workflow', 0, 0, 'Should cronjob run unanswered chats workflow and execute unaswered chats callback, 0 - no, any other number bigger than 0 is a minits how long chat have to be not accepted before executing callback.',0),\n                ('disable_popup_restore', 0, 0, 'Disable option in widget to open new window. Restore icon will be hidden',\t0),\n                ('accept_tos_link', '#', 0, 'Change to your site Terms of Service', 0),\n                ('hide_button_dropdown', '0', 0, 'Hide close button in dropdown', 0),\n                ('on_close_exit_chat', '0', 0, 'On chat close exit chat', 0),\n                ('activity_timeout', '5', 0, 'How long operator should go offline automatically because of inactivity. Value in minutes', 0),\n                ('product_enabled_module','0','0','Product module is enabled', '1'),\n                ('preload_iframes','0','0','Preload widget. It will avoid loading delay after clicking widget','0'),\n                ('product_show_departament','0','0','Enable products show by departments', '1'),\n                ('paidchat_data','','0','Paid chat configuration','1'),\n                ('mheight_op','200','0','Messages box height for operator','0'),\n                ('listd_op','10','0','Default number of online operators to show','0'),\n                ('disable_iframe_sharing',\t'1',\t0,\t'Disable iframes in sharing mode',\t0),\n                ('file_configuration',\t'a:7:{i:0;b:0;s:5:\\\"ft_op\\\";s:47:\\\"gif|jpe?g|png|zip|svg|rar|xls|doc|docx|xlsx|pdf\\\";s:5:\\\"ft_us\\\";s:30:\\\"gif|jpe?g|png|svg|doc|docx|pdf\\\";s:6:\\\"fs_max\\\";i:2048;s:18:\\\"active_user_upload\\\";b:0;s:16:\\\"active_op_upload\\\";b:1;s:19:\\\"active_admin_upload\\\";b:1;}',\t0,\t'Files configuration item',\t1),\n                ('accept_chat_link_timeout',\t'300',\t0,\t'How many seconds chat accept link is valid. Set 0 to force login all the time manually.',\t0),\n                ('open_closed_chat_timeout',\t'1800',\t0,\t'How many seconds customer has to open already closed chat.',\t0),\n                ('session_captcha',0,\t0,\t'Use session captcha. LHC have to be installed on the same domain or subdomain.',\t0),\n                ('sync_sound_settings',\t'a:16:{i:0;b:0;s:12:\\\"repeat_sound\\\";i:1;s:18:\\\"repeat_sound_delay\\\";i:5;s:10:\\\"show_alert\\\";b:0;s:22:\\\"new_chat_sound_enabled\\\";b:1;s:31:\\\"new_message_sound_admin_enabled\\\";b:1;s:30:\\\"new_message_sound_user_enabled\\\";b:1;s:14:\\\"online_timeout\\\";d:300;s:22:\\\"check_for_operator_msg\\\";d:10;s:21:\\\"back_office_sinterval\\\";d:10;s:22:\\\"chat_message_sinterval\\\";d:3.5;s:20:\\\"long_polling_enabled\\\";b:0;s:30:\\\"polling_chat_message_sinterval\\\";d:1.5;s:29:\\\"polling_back_office_sinterval\\\";d:5;s:18:\\\"connection_timeout\\\";i:30;s:28:\\\"browser_notification_message\\\";b:0;}',\t0,\t'',\t1),\n                ('sound_invitation', 1, 0, 'Play sound on invitation to chat.',\t0),\n                ('explicit_http_mode', '',0,'Please enter explicit http mode. Either http: or https:, do not forget : at the end.', '0'),\n                ('track_domain',\t'',\t0,\t'Set your domain to enable user tracking across different domain subdomains.',\t0),\n                ('max_message_length','500',0,'Maximum message length in characters', '0'),\n                ('need_help_tip','1',0,'Show need help tooltip?', '0'),\n                ('recaptcha_data','a:4:{i:0;b:0;s:8:\\\"site_key\\\";s:0:\\\"\\\";s:10:\\\"secret_key\\\";s:0:\\\"\\\";s:7:\\\"enabled\\\";i:0;}','0','Re-captcha configuration','1'),\n                ('need_help_tip_timeout','24',0,'Need help tooltip timeout, after how many hours show again tooltip?', '0'),\n                ('use_secure_cookie','0',0,'Use secure cookie, check this if you want to force SSL all the time', '0'),\n                ('faq_email_required','0',0,'Is visitor e-mail required for FAQ', '0'),\n                ('disable_print','0',0,'Disable chat print', '0'),\n                ('hide_disabled_department','1',0,'Hide disabled department widget', '0'),\n                ('disable_send','0',0,'Disable chat transcript send', '0'),\n                ('ignore_user_status','0',0,'Ignore users online statuses and use departments online hours', '0'),\n                ('bbc_button_visible','1',0,'Show BB Code button', '0'),\n                ('password_data','','0','Password requirements','1'),\n                ('activity_track_all','0','0','Track all logged operators activity and ignore their individual settings.','0'),\n                ('allow_reopen_closed','0', 0, 'Allow user to reopen closed chats?', '0'),\n                ('reopen_as_new','0', 0, 'Reopen closed chat as new? Otherwise it will be reopened as active.', '0'),\n                ('default_theme_id','0', 0, 'Default theme ID.', '1'),  \n                ('default_admin_theme_id','0', 0, 'Default admin theme ID', '1'),  \n                ('translation_data',\t'a:6:{i:0;b:0;s:19:\\\"translation_handler\\\";s:4:\\\"bing\\\";s:19:\\\"enable_translations\\\";b:0;s:14:\\\"bing_client_id\\\";s:0:\\\"\\\";s:18:\\\"bing_client_secret\\\";s:0:\\\"\\\";s:14:\\\"google_api_key\\\";s:0:\\\"\\\";}',\t0,\t'Translation data',\t1),              \n                ('disable_html5_storage','1',0,'Disable HMTL5 storage, check it if your site is switching between http and https', '0'),\n                ('automatically_reopen_chat','1',0,'Automatically reopen chat on widget open', '0'),\n                ('autoclose_timeout','0', 0, 'Automatic chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autoclose_timeout_pending','0', 0, 'Automatic pending chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autoclose_timeout_active','0', 0, 'Automatic active chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autoclose_timeout_bot','0', 0, 'Automatic bot chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autopurge_timeout','0', 0, 'Automatic chats purging. 0 - disabled, n > 0 time in minutes before chat is automatically deleted', '0'),\n                ('update_ip',\t'127.0.0.1',\t0,\t'Which ip should be allowed to update DB by executing http request, separate by comma?',0),\n                ('track_if_offline',\t'0',\t0,\t'Track online visitors even if there is no online operators',0),\n                ('min_phone_length','8',0,'Minimum phone number length',0),\n                ('mheight','',0,'Messages box height',0),\n                ('inform_unread_message','0',0,'Inform visitor about unread messages from operator, value in minutes. 0 - disabled',0),\n                ('dashboard_order', '[[\\\"online_operators\\\",\\\"departments_stats\\\",\\\"online_visitors\\\"],[\\\"group_chats\\\",\\\"my_chats\\\",\\\"pending_chats\\\",\\\"transfered_chats\\\"],[\\\"active_chats\\\",\\\"bot_chats\\\"]]', '0', 'Home page dashboard widgets order', '0'),\n                ('banned_ip_range','',0,'Which ip should not be allowed to chat',0),\n                ('suggest_leave_msg','1',0,'Suggest user to leave a message then user chooses offline department',0),\n                ('checkstatus_timeout','0',0,'Interval between chat status checks in seconds, 0 disabled.',0),\n                ('show_language_switcher','0',0,'Show users option to switch language at widget',0),\n                ('sharing_auto_allow','0',0,'Do not ask permission for users to see their screen',0),\n                ('sharing_nodejs_enabled','0',0,'NodeJs support enabled',0),\n                ('sharing_nodejs_path','',0,'socket.io path, optional',0),\n                ('online_if','0','0','','0'),\n                ('track_mouse_activity','0','0','Should mouse movement be tracked as activity measure, if not checked only basic events would be tracked','0'),\n                ('track_activity','0','0','Track users activity on site?','0'),\n                ('autologin_data','a:3:{i:0;b:0;s:11:\\\"secret_hash\\\";s:16:\\\"please_change_me\\\";s:7:\\\"enabled\\\";i:0;}',0,'Autologin configuration data',\t1),\n                ('sharing_nodejs_secure','0',0,'Connect to NodeJs in https mode',0),\n                ('disable_js_execution','1',0,'Disable JS execution in Co-Browsing operator window',0),\n                ('sharing_nodejs_socket_host','',0,'Host where NodeJs is running',0),\n                ('hide_right_column_frontpage','1','0','Hide right column in frontpage','0'),\n                ('front_tabs', 'dashboard,online_users,online_map', '0', 'Home page tabs order', '0'),\n                ('speech_data',\t'a:3:{i:0;b:0;s:8:\\\"language\\\";i:7;s:7:\\\"dialect\\\";s:5:\\\"en-US\\\";}',\t1,\t'',\t1),\n                ('sharing_nodejs_sllocation','https://cdn.jsdelivr.net/npm/socket.io-client@2/dist/socket.io.js',0,'Location of SocketIO JS library',0),\n                ('track_is_online','0',0,'Track is user still on site, chat status checks also has to be enabled',0),\n\t\t\t\t('show_languages','eng,lit,hrv,esp,por,nld,ara,ger,pol,rus,ita,fre,chn,cse,nor,tur,vnm,idn,sve,per,ell,dnk,rou,bgr,tha,geo,fin,alb',0,'Between what languages user should be able to switch',0),\n                ('geoadjustment_data',\t'a:8:{i:0;b:0;s:18:\\\"use_geo_adjustment\\\";b:0;s:13:\\\"available_for\\\";s:0:\\\"\\\";s:15:\\\"other_countries\\\";s:6:\\\"custom\\\";s:8:\\\"hide_for\\\";s:0:\\\"\\\";s:12:\\\"other_status\\\";s:7:\\\"offline\\\";s:11:\\\"rest_status\\\";s:6:\\\"hidden\\\";s:12:\\\"apply_widget\\\";i:0;}',\t0,\t'Geo adjustment settings',\t1),\n                {$geoRow}\");\n\n\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_online_user` (\n                  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `vid` varchar(50) NOT NULL,\n                  `ip` varchar(50) NOT NULL,\n                  `current_page` text NOT NULL,\n        \t   \t  `page_title` varchar(250) NOT NULL,\n                  `referrer` text NOT NULL,\n                  `chat_id` int(11) NOT NULL,\n                  `invitation_seen_count` int(11) NOT NULL,\n        \t   \t  `invitation_id` int(11) NOT NULL,\n                  `last_visit` int(11) NOT NULL,\n        \t   \t  `first_visit` int(11) NOT NULL,\n        \t   \t  `total_visits` int(11) NOT NULL,\n        \t   \t  `pages_count` int(11) NOT NULL,\n        \t   \t  `tt_pages_count` int(11) NOT NULL,\n        \t   \t  `invitation_count` int(11) NOT NULL,\n        \t   \t  `last_check_time` int(11) NOT NULL,\n        \t   \t  `dep_id` int(11) NOT NULL,        \t   \t \n                  `user_agent` text NOT NULL,\n                  `notes` varchar(250) NOT NULL,\n                  `user_country_code` varchar(50) NOT NULL,\n                  `user_country_name` varchar(50) NOT NULL,\n                  `visitor_tz` varchar(50) NOT NULL,\n                  `operator_message` text NOT NULL,\n                  `operator_user_proactive` varchar(100) NOT NULL,\n                  `operator_user_id` int(11) NOT NULL,\n                  `conversion_id` int(11) NOT NULL,\n                  `message_seen` int(11) NOT NULL,\n                  `message_seen_ts` int(11) NOT NULL,\n                  `user_active` int(11) NOT NULL,\n        \t   \t  `lat` varchar(10) NOT NULL,\n  \t\t\t\t  `lon` varchar(10) NOT NULL,\n  \t\t\t\t  `city` varchar(100) NOT NULL,\n        \t   \t  `reopen_chat` int(11) NOT NULL,\n        \t   \t  `time_on_site` int(11) NOT NULL,\n  \t\t\t\t  `tt_time_on_site` int(11) NOT NULL,\n        \t   \t  `requires_email` int(11) NOT NULL,\n        \t   \t  `requires_username` int(11) NOT NULL,\n        \t   \t  `requires_phone` int(11) NOT NULL,\n        \t   \t  `screenshot_id` int(11) NOT NULL,\n        \t   \t  `identifier` varchar(50) NOT NULL,\n        \t   \t  `operation` text NOT NULL,\n        \t   \t  `online_attr_system` text NOT NULL,\n        \t   \t  `operation_chat` text NOT NULL,\n        \t   \t  `online_attr` text NOT NULL,\n        \t   \t  `device_type` tinyint(1) NOT NULL DEFAULT '0',\n                  `chat_time` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  `last_visit_prev` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  PRIMARY KEY (`id`),\n                  KEY `vid` (`vid`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `last_visit_dep_id` (`last_visit`,`dep_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_proactive_chat_invitation` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `siteaccess` varchar(10) NOT NULL,\n\t\t\t\t  `time_on_site` int(11) NOT NULL,\n\t\t\t\t  `pageviews` int(11) NOT NULL,\n\t\t\t\t  `message` text NOT NULL,\n\t\t\t\t  `message_returning` text NOT NULL,\n\t\t\t\t  `executed_times` int(11) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `hide_after_ntimes` int(11) NOT NULL,\n\t\t\t\t  `show_on_mobile` int(11) NOT NULL,\n\t\t\t\t  `delay` int(11) NOT NULL,\n\t\t\t\t  `delay_init` int(11) NOT NULL,\n\t\t\t\t  `show_instant` int(11) NOT NULL,\n\t\t\t\t  `autoresponder_id` int(11) NOT NULL,\n\t\t\t\t  `disabled` int(11) NOT NULL,\n\t\t\t\t  `inject_only_html` tinyint(1) NOT NULL,\n\t\t\t\t  `name` varchar(50) NOT NULL,\n\t\t\t\t  `operator_ids` varchar(100) NOT NULL,\t\t\t\t \n\t\t\t\t  `message_returning_nick` varchar(250) NOT NULL,\n\t\t\t\t  `referrer` varchar(250) NOT NULL,\t\t\t\t  \n\t\t\t\t  `show_random_operator` int(11) NOT NULL,\n\t\t\t\t  `operator_name` varchar(100) NOT NULL,\n\t\t\t\t  `campaign_id` int(11) NOT NULL,\n\t\t\t\t  `position` int(11) NOT NULL,\n\t\t\t\t  `event_invitation` int(11) NOT NULL,\n\t\t\t\t  `dynamic_invitation` int(11) NOT NULL,\n\t\t\t\t  `bot_id` int(11) NOT NULL,\n\t\t\t\t  `trigger_id` int(11) NOT NULL,\n\t\t\t\t  `bot_offline` tinyint(1) NOT NULL,\n        \t   \t  `identifier` varchar(50) NOT NULL,\n        \t   \t  `tag` varchar(50) NOT NULL,\n        \t   \t  `requires_email` int(11) NOT NULL,\n        \t   \t  `iddle_for` int(11) NOT NULL,\n        \t   \t  `event_type` int(11) NOT NULL,\n        \t   \t  `requires_username` int(11) NOT NULL,\n        \t   \t  `requires_phone` int(11) NOT NULL,        \t   \t  \n        \t   \t  `design_data` longtext NOT NULL,        \t   \t  \n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `time_on_site_pageviews_siteaccess_position` (`time_on_site`,`pageviews`,`siteaccess`,`identifier`,`position`),\n        \t      KEY `identifier` (`identifier`),\n        \t      KEY `dynamic_invitation` (`dynamic_invitation`),\n        \t      KEY `tag` (`tag`),\n        \t      KEY `dep_id` (`dep_id`),\n        \t      KEY `show_on_mobile` (`show_on_mobile`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_accept` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `chat_id` bigint(20) NOT NULL,\n        \t   `hash` varchar(50) NOT NULL,\n        \t   `ctime` int(11) NOT NULL,\n        \t   `wused` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `hash` (`hash`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            //Default departament\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_departament` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `name` varchar(100) NOT NULL,\n\t\t\t\t  `email` varchar(100) NOT NULL,\n\t\t\t\t  `xmpp_recipients` text NOT NULL,\n\t\t\t\t  `xmpp_group_recipients` text NOT NULL,\n\t\t\t\t  `priority` int(11) NOT NULL,\n\t\t\t\t  `sort_priority` int(11) NOT NULL,\n\t\t\t\t  `department_transfer_id` int(11) NOT NULL,\n\t\t\t\t  `transfer_timeout` int(11) NOT NULL,\n\t\t\t\t  `exclude_inactive_chats` int(11) NOT NULL,\n\t\t\t\t  `delay_before_assign` int(11) NOT NULL,\n\t\t\t\t  `max_ac_dep_chats` int(11) NOT NULL,\n\t\t\t\t  `archive` tinyint(1) NOT NULL DEFAULT '0',\n\t\t\t\t  `max_load` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `max_load_h` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `assign_same_language` int(11) NOT NULL,\n\t\t\t\t  `disabled` int(11) NOT NULL,\n\t\t\t\t  `hidden` int(11) NOT NULL,\n\t\t\t\t  `delay_lm` int(11) NOT NULL,\n\t\t\t\t  `max_active_chats` int(11) NOT NULL,\n\t\t\t\t  `max_timeout_seconds` int(11) NOT NULL,\n\t\t\t\t  `identifier` varchar(2083) NOT NULL,\n\t\t\t\t  `mod_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `mod_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `tud_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `tud_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `wed_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `wed_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `thd_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `thd_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `frd_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `frd_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sad_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sad_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sud_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sud_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `nc_cb_execute` tinyint(1) NOT NULL,\n\t\t\t\t  `na_cb_execute` tinyint(1) NOT NULL,\n\t\t\t\t  `inform_unread` tinyint(1) NOT NULL,\n\t\t\t\t  `active_balancing` tinyint(1) NOT NULL,\n\t\t\t\t  `visible_if_online` tinyint(1) NOT NULL,\n\t\t\t\t  `inform_close` int(11) NOT NULL,\n\t\t\t\t  `inform_unread_delay` int(11) NOT NULL,\n\t\t\t\t  `inform_options` varchar(250) NOT NULL,\n\t\t\t\t  `online_hours_active` tinyint(1) NOT NULL,\n\t\t\t\t  `inform_delay` int(11) NOT NULL,\n\t\t\t\t  `attr_int_1` int(11) NOT NULL,\n\t\t\t\t  `attr_int_2` int(11) NOT NULL,\n\t\t\t\t  `attr_int_3` int(11) NOT NULL,\n\t\t\t\t  `pending_max` int(11) NOT NULL,\n\t\t\t\t  `pending_group_max` int(11) NOT NULL,\n\t\t\t\t  `active_chats_counter` int(11) NOT NULL,\n\t\t\t\t  `inactive_chats_cnt` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `pending_chats_counter` int(11) NOT NULL,\n\t\t\t\t  `bot_chats_counter` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `inop_chats_cnt` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `acop_chats_cnt` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `inform_close_all` int(11) NOT NULL,\n\t\t\t\t  `inform_close_all_email` varchar(250) NOT NULL,\n\t\t\t\t  `alias` varchar(50) NOT NULL,\n\t\t\t\t  `product_configuration` longtext NOT NULL,\n\t\t\t\t  `bot_configuration` text NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `identifier_2` (`identifier`(191)),\n\t\t\t\t  KEY `archive` (`archive`),\n\t\t\t\t  KEY `attr_int_1` (`attr_int_1`),\n\t\t\t\t  KEY `attr_int_2` (`attr_int_2`),\n\t\t\t\t  KEY `attr_int_3` (`attr_int_3`),\n\t\t\t\t  KEY `active_chats_counter` (`active_chats_counter`),\n\t\t\t\t  KEY `pending_chats_counter` (`pending_chats_counter`),\n\t\t\t\t  KEY `bot_chats_counter` (`bot_chats_counter`),\n\t\t\t\t  KEY `disabled_hidden` (`disabled`, `hidden`),\n\t\t\t\t  KEY `sort_priority_name` (`sort_priority`, `name`),\n\t\t\t\t  KEY `alias` (`alias`),\n\t\t\t\t  KEY `active_mod` (`online_hours_active`,`mod_start_hour`,`mod_end_hour`),\n\t\t\t\t  KEY `active_tud` (`online_hours_active`,`tud_start_hour`,`tud_end_hour`),\n\t\t\t\t  KEY `active_wed` (`online_hours_active`,`wed_start_hour`,`wed_end_hour`),\n\t\t\t\t  KEY `active_thd` (`online_hours_active`,`thd_start_hour`,`thd_end_hour`),\n\t\t\t\t  KEY `active_frd` (`online_hours_active`,`frd_start_hour`,`frd_end_hour`),\n\t\t\t\t  KEY `active_sad` (`online_hours_active`,`sad_start_hour`,`sad_end_hour`),\n\t\t\t\t  KEY `active_sud` (`online_hours_active`,`sud_start_hour`,`sud_end_hour`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_saved_search` (\n                    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `name` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `params` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `user_id` bigint(20) unsigned NOT NULL,\n                  `position` int(11) unsigned NOT NULL,\n                  `scope` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `days` int(11) unsigned NOT NULL,\n                  `updated_at` bigint(20) unsigned NOT NULL,\n                  `requested_at` bigint(20) unsigned NOT NULL,\n                  `total_records` bigint(20) unsigned NOT NULL,\n                  `passive` tinyint(1) unsigned NOT NULL DEFAULT 0,\n                  PRIMARY KEY (`id`),\n                  KEY `user_id` (`user_id`),\n                  KEY `scope` (`scope`),\n                  KEY `updated_at` (`updated_at`),\n                  KEY `requested_at` (`requested_at`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_departament_group_user` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `dep_group_id` int(11) NOT NULL,\n                  `user_id` int(11) NOT NULL,\n                  `read_only` tinyint(1) unsigned NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`id`),\n                  KEY `dep_group_id` (`dep_group_id`),\n                  KEY `user_id` (`user_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_departament_availability` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `dep_id` int(11) NOT NULL, `hour` int(11) NOT NULL, `hourminute` int(4) NOT NULL, `minute` int(11) NOT NULL, `time` int(11) NOT NULL, `ymdhi` bigint(20) NOT NULL, `ymd` int(11) NOT NULL, `status` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `ymdhi` (`ymdhi`), KEY `dep_id` (`dep_id`),  KEY `hourminute` (`hourminute`), KEY `time` (`time`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_product_departament` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `product_id` int(11) NOT NULL,\n        \t       `departament_id` int(11) NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `departament_id` (`departament_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_departament_group_member` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `dep_id` int(11) NOT NULL,\n                  `dep_group_id` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `dep_group_id` (`dep_group_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_generic_bot_rest_api` (`id` bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY, `name` varchar(50) NOT NULL, `description` varchar(250), `configuration` text NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_departament_group` (\n                      `id` int(11) NOT NULL AUTO_INCREMENT,\n                      `name` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `achats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `inachats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `pchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `max_load` int(11) NOT NULL DEFAULT 0,\n                      `max_load_h` int(11) NOT NULL DEFAULT 0,\n                      `bchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `inopchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `acopchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      PRIMARY KEY (`id`)\n                    ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_canned_msg_tag_link` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `tag_id` int(11) NOT NULL,  `canned_id` int(11) NOT NULL,  PRIMARY KEY (`id`), KEY `canned_id` (`canned_id`), KEY `tag_id` (`tag_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_canned_msg_tag` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `tag` varchar(40) NOT NULL, PRIMARY KEY (`id`), KEY `tag` (`tag`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_abstract_subject` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `name` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `internal` tinyint(1) NOT NULL DEFAULT 0,\n  `internal_type` varchar(20) NOT NULL DEFAULT '',\n  PRIMARY KEY (`id`),\n  KEY `internal` (`internal`),\n  KEY `internal_type` (`internal_type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_abstract_subject_dep` ( `id` int(11) NOT NULL AUTO_INCREMENT, `dep_id` int(11) NOT NULL, `subject_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `subject_id` (`subject_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_abstract_subject_chat` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `subject_id` int(11) NOT NULL, `chat_id` bigint(20) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_group_object` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `object_id` bigint(20) NOT NULL, `group_id` bigint(20) NOT NULL, `type` bigint(20) NOT NULL, PRIMARY KEY (`id`), KEY `object_id_type` (`object_id`,`type`), KEY `group_id` (`group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Bot tables\n            $db->query(\"CREATE TABLE `lh_generic_bot_bot` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `configuration` longtext NOT NULL, `avatar` varchar(150) NOT NULL, `filename` varchar(250) NOT NULL, `filepath` varchar(250) NOT NULL, `name` varchar(100) NOT NULL, `nick` varchar(100) NOT NULL,`attr_str_1` varchar(100) NOT NULL, `attr_str_2` varchar(100) NOT NULL, `attr_str_3` varchar(100) NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_group` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL,`is_collapsed` int(11) NOT NULL DEFAULT '0', `pos` int(11) NOT NULL DEFAULT '0', `bot_id` bigint(20) NOT NULL, PRIMARY KEY (`id`), KEY `bot_id` (`bot_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_trigger` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL, `actions` longtext NOT NULL, `group_id` bigint(20) NOT NULL, `bot_id` int(11) NOT NULL, `default` int(11) NOT NULL, `default_unknown` int(11) NOT NULL, `as_argument` int(11) NOT NULL DEFAULT '0', `in_progress` int(11) NOT NULL DEFAULT '0', `default_unknown_btn` int(11) NOT NULL DEFAULT '0', `default_always` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `bot_id` (`bot_id`),  KEY `default_unknown` (`default_unknown`), KEY `in_progress` (`in_progress`), KEY `default_unknown_btn` (`default_unknown_btn`), KEY `default_always` (`default_always`), KEY `group_id` (`group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_trigger_event` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `pattern` text NOT NULL, `pattern_exc` text NOT NULL, `configuration` longtext NOT NULL, `trigger_id` bigint(20) NOT NULL, `bot_id` int(11) NOT NULL, `on_start_type` tinyint(1) NOT NULL, `priority` int(11) NOT NULL, `type` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `pattern_v2` (`pattern`(191)), KEY `type` (`type`), KEY `on_start_type` (`on_start_type`), KEY `trigger_id` (`trigger_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_payload` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL, `payload` varchar(100) NOT NULL, `bot_id` int(11) NOT NULL, `trigger_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `bot_id` (`bot_id`), KEY `trigger_id` (`trigger_id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_chat_workflow` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL,`trigger_id` bigint(20) NOT NULL, `time` int(11) NOT NULL, `identifier` varchar(100) NOT NULL, `status` int(11) NOT NULL, `collected_data` text, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_chat_event` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `counter` int(11) NOT NULL, `content` longtext NOT NULL, `ctime` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_pending_event` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `trigger_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_exception` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL, `priority` int(11) NOT NULL, `active` tinyint(1) NOT NULL, PRIMARY KEY (`id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_exception_message` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `code` varchar(20) NOT NULL, `exception_group_id` int(11) NOT NULL, `priority` int(11) NOT NULL, `active` tinyint(1) NOT NULL, `message` text NOT NULL, PRIMARY KEY (`id`), KEY `code` (`code`), KEY `exception_group_id` (`exception_group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_tr_group` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL,`filename` varchar(250) NOT NULL,`filepath` varchar(250) NOT NULL,`configuration` longtext NOT NULL,`nick` varchar(100) NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_tr_item` ( `id` int(11) NOT NULL AUTO_INCREMENT, `group_id` int(11) NOT NULL, `identifier` varchar(50) NOT NULL, `translation` text NOT NULL, PRIMARY KEY (`id`),  KEY `identifier` (`identifier`), KEY `group_id` (`group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_speech_user_language` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `user_id` bigint(20) NOT NULL, `language` varchar(20) NOT NULL, PRIMARY KEY (`id`), KEY `user_id_language` (`user_id`,`language`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_audits` (`id` bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY, `category` varchar(255) NOT NULL, `file` varchar(255), `object_id` bigint(20) DEFAULT '0', `line` bigint(20), `message` longtext NOT NULL, `severity` varchar(255) NOT NULL, `source` varchar(255) NOT NULL, `time` timestamp NOT NULL, KEY `object_id` (`object_id`), KEY `source` (`source`(191)), KEY `category` (`category`(191))) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_chat_online_user_footprint_update` (`online_user_id` bigint(20) NOT NULL,  `command` varchar(20) NOT NULL,  `args` varchar(250) NOT NULL,  `ctime` int(11) NOT NULL, KEY `online_user_id` (`online_user_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_repeat_restrict` (`id` bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY, `chat_id` bigint(20) NOT NULL, `trigger_id` bigint(20), `identifier` varchar(20), `counter` int(11) DEFAULT '0', KEY `chat_id_trigger_id` (`chat_id`,`trigger_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_users_login` (`id` bigint(20) NOT NULL AUTO_INCREMENT,`user_id` bigint(20) NOT NULL,`type` int(11) NOT NULL,`ctime` bigint(20) NOT NULL,`status` int(11) NOT NULL,`ip` varchar(100) NOT NULL,`msg` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,PRIMARY KEY (`id`),KEY `user_id_type` (`user_id`,`type`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            \n            $Departament = new erLhcoreClassModelDepartament();\n            $Departament->name = $form->DefaultDepartament;\n            erLhcoreClassDepartament::getSession()->save($Departament);\n            \n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_voice_video` (\n                   `id` bigint(20) NOT NULL AUTO_INCREMENT,\n                   `chat_id` bigint(20) NOT NULL,\n                   `user_id` bigint(20) NOT NULL,\n                   `op_status` tinyint(4) NOT NULL,\n                   `vi_status` tinyint(4) NOT NULL,\n                   `voice` tinyint(4) NOT NULL,\n                   `video` tinyint(4) NOT NULL,\n                   `screen_share` tinyint(4) NOT NULL,\n                   `status` tinyint(4) NOT NULL,\n                   `ctime` int(11) NOT NULL,\n                   `token` varchar(200) NOT NULL,\n                   PRIMARY KEY (`id`),\n                   KEY `chat_id` (`chat_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_canned_msg_replace` (\n                    `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n                    `identifier` varchar(50) NOT NULL,\n                    `default` text NOT NULL, `conditions` longtext NOT NULL,\n                    PRIMARY KEY (`id`),\n                   KEY `identifier` (`identifier`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            //Department custom work hours\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_departament_custom_work_hours` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `date_from` int(11) NOT NULL,\n\t\t\t\t  `date_to` int(11) NOT NULL,\n\t\t\t\t  `start_hour` int(11) NOT NULL,\n\t\t\t\t  `end_hour` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `date_from` (`date_from`),\n\t\t\t\t  KEY `search_active` (`date_from`, `date_to`, `dep_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            //Administrators group\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_group` (\n               `id` int(11) NOT NULL AUTO_INCREMENT,\n               `name` varchar(50) NOT NULL,\n               `disabled` tinyint(1) NOT NULL,\n               `required` tinyint(1) NOT NULL DEFAULT '0',\n               PRIMARY KEY (`id`),\n               KEY `disabled` (`disabled`)\n               ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_stats` (\n              `id` bigint(20) NOT NULL AUTO_INCREMENT,\n              `type` int(11) NOT NULL,\n              `lupdate` bigint(20) NOT NULL,\n              `object_id` bigint(20) NOT NULL,\n              `stats` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,\n              PRIMARY KEY (`id`),\n              KEY `type_object_id` (`type`,`object_id`)\n            ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            //Administrators group\n            $db->query(\"CREATE TABLE `lh_generic_bot_command` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `command` varchar(50) NOT NULL,\n  `bot_id` int(11) NOT NULL,\n  `trigger_id` int(11) NOT NULL,\n  `dep_id` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `dep_id` (`dep_id`),\n  KEY `command` (`command`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Admin group\n            $GroupData = new erLhcoreClassModelGroup();\n            $GroupData->name    = \"Administrators\";\n            erLhcoreClassUser::getSession()->save($GroupData);\n\n            // Precreate operators group\n            $GroupDataOperators = new erLhcoreClassModelGroup();\n            $GroupDataOperators->name    = \"Operators\";\n            erLhcoreClassUser::getSession()->save($GroupDataOperators);\n\n            //Administrators role\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_role` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `name` varchar(50) NOT NULL,\n                  PRIMARY KEY (`id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Administrators role\n            $Role = new erLhcoreClassModelRole();\n            $Role->name = 'Administrators';\n            erLhcoreClassRole::getSession()->save($Role);\n\n            // Operators role\n            $RoleOperators = new erLhcoreClassModelRole();\n            $RoleOperators->name = 'Operators';\n            erLhcoreClassRole::getSession()->save($RoleOperators);\n\n            //Assing group role\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_grouprole` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `group_id` int(11) NOT NULL,\n                  `role_id` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `group_id` (`role_id`,`group_id`),\n                  KEY `group_id_primary` (`group_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Assign admin role to admin group\n            $GroupRole = new erLhcoreClassModelGroupRole();\n            $GroupRole->group_id =$GroupData->id;\n            $GroupRole->role_id = $Role->id;\n            erLhcoreClassRole::getSession()->save($GroupRole);\n\n            // Assign operators role to operators group\n            $GroupRoleOperators = new erLhcoreClassModelGroupRole();\n            $GroupRoleOperators->group_id =$GroupDataOperators->id;\n            $GroupRoleOperators->role_id = $RoleOperators->id;\n            erLhcoreClassRole::getSession()->save($GroupRoleOperators);\n\n            // Users\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `username` varchar(80) NOT NULL,\n                  `password` varchar(200) NOT NULL,\n                  `email` varchar(100) NOT NULL,\n                  `time_zone` varchar(100) NOT NULL,\n                  `name` varchar(100) NOT NULL,\n                  `surname` varchar(100) NOT NULL,\n                  `avatar` varchar(150) NOT NULL,\n                  `filepath` varchar(200) NOT NULL,\n                  `filename` varchar(200) NOT NULL,\n                  `job_title` varchar(100) NOT NULL,\n                  `departments_ids` text NOT NULL,\n                  `chat_nickname` varchar(100) NOT NULL,\n                  `xmpp_username` varchar(200) NOT NULL,\n                  `session_id` varchar(40) NOT NULL,\n                  `operation_admin` text NOT NULL,\n                  `skype` varchar(50) NOT NULL,\n                  `exclude_autoasign` tinyint(1) NOT NULL,\n                  `disabled` tinyint(4) NOT NULL,\n                  `hide_online` tinyint(1) NOT NULL,\n                  `all_departments` tinyint(1) NOT NULL,\n                  `invisible_mode` tinyint(1) NOT NULL,\n                  `inactive_mode` tinyint(1) NOT NULL,\n                  `rec_per_req` tinyint(1) NOT NULL,\n                  `auto_accept` tinyint(1) NOT NULL,\n                  `max_active_chats` int(11) NOT NULL,\n                  `cache_version` int(11) unsigned NOT NULL DEFAULT '0',\n                  `pswd_updated` int(11) NOT NULL,\n                  `attr_int_1` int(11) NOT NULL,\n                  `attr_int_2` int(11) NOT NULL,\n                  `attr_int_3` int(11) NOT NULL,\n                   `force_logout` tinyint(1) unsigned NOT NULL DEFAULT '0',\n                  `llogin` bigint(20) unsigned NOT NULL DEFAULT '0',\n                  `always_on` tinyint(1) NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`id`),\n                  KEY `hide_online` (`hide_online`),\n                  KEY `rec_per_req` (`rec_per_req`),\n                  KEY `email` (`email`),\n                  KEY `disabled` (`disabled`),\n                  KEY `xmpp_username` (`xmpp_username`(191))\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $UserData = new erLhcoreClassModelUser();\n\n            $UserData->setPassword($form->AdminPassword);\n            $UserData->email   = $form->AdminEmail;\n            $UserData->name    = $form->AdminName;\n            $UserData->surname = $form->AdminSurname;\n            $UserData->username = $form->AdminUsername;\n            $UserData->all_departments = 1;\n            $UserData->departments_ids = 0;\n            $UserData->pswd_updated = time();\n\n            erLhcoreClassUser::getSession()->save($UserData);\n\n            // User departaments\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_userdep` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `user_id` int(11) NOT NULL,\n                  `dep_id` int(11) NOT NULL,\n                  `last_activity` int(11) NOT NULL,\n                  `lastd_activity` int(11) NOT NULL DEFAULT '0',\n                  `exclude_autoasign` tinyint(1) NOT NULL DEFAULT '0',\n                  `hide_online` int(11) NOT NULL,\n                  `last_accepted` int(11) NOT NULL DEFAULT '0',\n                  `active_chats` int(11) NOT NULL DEFAULT '0',\n                  `pending_chats` int(11) NOT NULL DEFAULT '0',\n                  `inactive_chats` int(11) NOT NULL DEFAULT '0',\n                  `max_chats` int(11) NOT NULL DEFAULT '0',\n                  `type` int(11) NOT NULL DEFAULT '0',\n                  `ro` tinyint(1) NOT NULL DEFAULT '0',\n                  `hide_online_ts` int(11) NOT NULL DEFAULT '0',\n                  `dep_group_id` int(11) NOT NULL DEFAULT '0',\n                  `always_on` tinyint(1) NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`id`),\n                  KEY `last_activity_hide_online_dep_id` (`last_activity`,`hide_online`,`dep_id`),\n                  KEY `dep_id` (`dep_id`),\n                  KEY `user_id_type` (`user_id`,`type`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            // Insert record to departament instantly\n            $db->query(\"INSERT INTO `lh_userdep` (`user_id`,`dep_id`,`last_activity`,`hide_online`,`last_accepted`,`active_chats`,`type`,`dep_group_id`,`exclude_autoasign`) VALUES ({$UserData->id},0,0,0,0,0,0,0,0)\");\n\n            $db->query(\"CREATE TABLE `lh_group_work` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `group_id` int(11) NOT NULL, `group_work_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `group_id` (`group_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Transfer chat\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_transfer` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `chat_id` int(11) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `transfer_user_id` int(11) NOT NULL,\n\t\t\t\t  `from_dep_id` int(11) NOT NULL,\n\t\t\t\t  `ctime` int(11) NOT NULL,\n\t\t\t\t  `transfer_to_user_id` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `transfer_user_id_dep_id` (`transfer_user_id`,`dep_id`),\n\t\t\t\t  KEY `transfer_to_user_id` (`transfer_to_user_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Remember user table\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users_remember` (\n\t\t\t\t `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t `user_id` int(11) NOT NULL,\n\t\t\t\t `mtime` int(11) NOT NULL,\n\t\t\t\t PRIMARY KEY (`id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // API table\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_rest_api_key` (\n                    `id` int(11) NOT NULL AUTO_INCREMENT,\n                    `api_key` varchar(50) NOT NULL,\n                    `user_id` int(11) NOT NULL DEFAULT '0',\n                    `active` int(11) NOT NULL DEFAULT '0',\n                    `ip_restrictions` varchar(250) NOT NULL,\n                    PRIMARY KEY (`id`),\n                    KEY `api_key` (`api_key`),\n                    KEY `user_id` (`user_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_rest_api_key_remote` ( `id` int(11) NOT NULL AUTO_INCREMENT, `api_key` varchar(50) NOT NULL, `username` varchar(50) NOT NULL, `name` varchar(50) NOT NULL, `host` varchar(250) NOT NULL, `active` tinyint(1) NOT NULL DEFAULT '0', `position` int(11) NOT NULL DEFAULT '0', PRIMARY KEY (`id`), KEY `active` (`active`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n            $db->query(\"CREATE TABLE `lh_abstract_chat_variable` ( `id` int(11) NOT NULL AUTO_INCREMENT, `var_name` varchar(255) NOT NULL, `var_identifier` varchar(255) NOT NULL, `inv` tinyint(1) NOT NULL, `change_message` varchar(250) NOT NULL, `type` tinyint(1) NOT NULL, `persistent` tinyint(1) NOT NULL, `js_variable` varchar(255) NOT NULL, `dep_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `dep_id` (`dep_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_webhook` ( `id` int(11) NOT NULL AUTO_INCREMENT, `event` varchar(50) NOT NULL, `bot_id_alt` int(11) NOT NULL DEFAULT '0', `trigger_id_alt` int(11) NOT NULL DEFAULT '0',`bot_id` int(11) NOT NULL, `trigger_id` int(11) NOT NULL, `disabled` tinyint(1) NOT NULL, `configuration` longtext NOT NULL, `type` tinyint(1) NOT NULL DEFAULT 0, PRIMARY KEY (`id`), KEY `event_disabled` (`event`,`disabled`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_incoming_webhook` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL,`identifier` varchar(50) NOT NULL, `scope` varchar(50) NOT NULL, `dep_id` int(11) NOT NULL, `disabled` tinyint(1) NOT NULL, `configuration` longtext NOT NULL, PRIMARY KEY (`id`), KEY `identifier` (`identifier`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_chat_incoming` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `utime` bigint(20) NOT NULL, `incoming_id` int(11) NOT NULL, `payload` longtext NOT NULL, `chat_external_id` varchar(50) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`),  KEY `incoming_ext_id` (`incoming_id`,`chat_external_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_abstract_chat_column` (`id` int(11) NOT NULL AUTO_INCREMENT,`column_name` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,`variable` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, `position` int(11) NOT NULL, `enabled` tinyint(1) NOT NULL, `online_enabled` tinyint(1) NOT NULL, `chat_enabled` tinyint(1) NOT NULL, `conditions` text COLLATE utf8mb4_unicode_ci NOT NULL,`column_icon` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, `column_identifier` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, PRIMARY KEY (`id`), KEY `enabled` (`enabled`), KEY `online_enabled` (`online_enabled`), KEY `chat_enabled` (`chat_enabled`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_abstract_chat_priority` (`id` int(11) NOT NULL AUTO_INCREMENT,`value` text COLLATE utf8mb4_unicode_ci NOT NULL,`dep_id` int(11) NOT NULL, `dest_dep_id` int(11) NOT NULL DEFAULT 0, `sort_priority` int(11) NOT NULL DEFAULT 0,`priority` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `dep_id` (`dep_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_canned_msg_dep` (\n                                 `id` bigint(20) NOT NULL AUTO_INCREMENT,\n                                 `canned_id` int(11) NOT NULL,\n                                 `dep_id` int(11) NOT NULL,\n                                 PRIMARY KEY (`id`),\n                                 KEY `canned_id` (`canned_id`),\n                                 KEY `dep_id` (`dep_id`)\n                            ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_canned_msg_subject` (\n    `id` int(11) NOT NULL AUTO_INCREMENT,\n    `canned_id` int(11) NOT NULL,\n    `subject_id` int(11) NOT NULL,\n    PRIMARY KEY (`id`),\n    KEY `canned_id` (`canned_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Session\n            $db->query(\"CREATE TABLE `lh_users_session` (\n                      `id` int(11) NOT NULL AUTO_INCREMENT,\n                      `token` varchar(40) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `device_type` int(11) NOT NULL,\n                      `device_token` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `user_id` int(11) NOT NULL,\n                      `created_on` int(11) NOT NULL,\n                      `updated_on` int(11) NOT NULL,\n                      `expires_on` int(11) NOT NULL,\n                      `notifications_status` int(11) NOT NULL DEFAULT 1,\n                      `error` int(11) NOT NULL DEFAULT 0,\n                      `last_error` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      PRIMARY KEY (`id`),\n                      KEY `token` (`token`),\n                      KEY `device_token_device_type_v2` (`device_token`(191),`device_type`),\n                      KEY `error` (`error`)\n                    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Chat messages\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_msg` (\n\t\t\t\t  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `msg` longtext NOT NULL,\n\t\t\t\t  `meta_msg` longtext NOT NULL,\n\t\t\t\t  `time` int(11) NOT NULL,\n\t\t\t\t  `chat_id` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_id` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `name_support` varchar(100) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `chat_id_id` (`chat_id`, `id`),\n\t\t\t\t  KEY `user_id` (`user_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Forgot password table\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_forgotpasswordhash` (\n                `id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,\n                `user_id` INT NOT NULL ,\n                `hash` VARCHAR( 40 ) NOT NULL ,\n                `created` INT NOT NULL\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // User groups table\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_groupuser` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `group_id` int(11) NOT NULL,\n                  `user_id` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `group_id` (`group_id`),\n                  KEY `user_id` (`user_id`),\n                  KEY `group_id_2` (`group_id`,`user_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Assign admin user to admin group\n            $GroupUser = new erLhcoreClassModelGroupUser();\n            $GroupUser->group_id = $GroupData->id;\n            $GroupUser->user_id = $UserData->id;\n            erLhcoreClassUser::getSession()->save($GroupUser);\n\n            //Assign default role functions\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_rolefunction` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `role_id` int(11) NOT NULL,\n                  `module` varchar(100) NOT NULL,\n                  `function` varchar(100) NOT NULL,\n                  `limitation` text NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `role_id` (`role_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Admin role and function\n            $RoleFunction = new erLhcoreClassModelRoleFunction();\n            $RoleFunction->role_id = $Role->id;\n            $RoleFunction->module = '*';\n            $RoleFunction->function = '*';\n            erLhcoreClassRole::getSession()->save($RoleFunction);\n\n            // Operators rules and functions\n            $permissionsArray = array(\n                array('module' => 'lhuser',  'function' => 'selfedit'),\n                array('module' => 'lhuser',  'function' => 'changeonlinestatus'),\n                array('module' => 'lhuser',  'function' => 'changeskypenick'),\n                array('module' => 'lhuser',  'function' => 'personalcannedmsg'),\n                array('module' => 'lhuser',  'function' => 'change_visibility_list'),\n                array('module' => 'lhuser',  'function' => 'see_assigned_departments'),\n                array('module' => 'lhuser',  'function' => 'canseedepartmentstats'),\n                array('module' => 'lhchat',  'function' => 'use'),\n                array('module' => 'lhchat',  'function' => 'open_all'),\n                array('module' => 'lhchat',  'function' => 'chattabschrome'),\n                array('module' => 'lhchat',  'function' => 'singlechatwindow'),\n                array('module' => 'lhchat',  'function' => 'allowopenremotechat'),\n                array('module' => 'lhchat',  'function' => 'writeremotechat'),\n                array('module' => 'lhchat',  'function' => 'allowchattabs'),\n                array('module' => 'lhchat',  'function' => 'use_onlineusers'),\n                array('module' => 'lhchat',  'function' => 'take_screenshot'),\n                array('module' => 'lhfront', 'function' => 'use'),\n                array('module' => 'lhchat', 'function' => 'prev_chats'),\n                array('module' => 'lhsystem','function' => 'use'),\n                array('module' => 'lhcannedmsg', 'function' => 'see_global'),\n                array('module' => 'lhtranslation','function' => 'use'),\n                array('module' => 'lhchat',  'function' => 'allowblockusers'),\n                array('module' => 'lhsystem','function' => 'generatejs'),\n                array('module' => 'lhsystem','function' => 'changelanguage'),\n                array('module' => 'lhchat',  'function' => 'allowredirect'),\n                array('module' => 'lhchat',  'function' => 'allowtransfer'),\n                array('module' => 'lhchat',  'function' => 'allowtransferdirectly'),\n                array('module' => 'lhchat',  'function' => 'administratecannedmsg'),\n                array('module' => 'lhchat',  'function' => 'sees_all_online_visitors'),\n                array('module' => 'lhpermission',   'function' => 'see_permissions'),\n                array('module' => 'lhquestionary',  'function' => 'manage_questionary'),\n                array('module' => 'lhfaq',   \t\t'function' => 'manage_faq'),\n                array('module' => 'lhchatbox',   \t'function' => 'manage_chatbox'),\n                array('module' => 'lhbrowseoffer',  'function' => 'manage_bo'),\n                array('module' => 'lhxml',   \t\t'function' => '*'),\n                array('module' => 'lhcobrowse',   \t'function' => 'browse'),\n                array('module' => 'lhfile',   \t\t'function' => 'use_operator'),\n                array('module' => 'lhfile',   \t\t'function' => 'file_delete_chat'),\n                array('module' => 'lhstatistic',   \t'function' => 'use'),\n                array('module' => 'lhspeech', 'function' => 'changedefaultlanguage'),\n                array('module' => 'lhspeech', 'function' => 'use'),\n                array('module' => 'lhcannedmsg', 'function' => 'use'),\n                array('module' => 'lhtheme', 'function' => 'personaltheme'),\n                array('module' => 'lhuser', 'function' => 'userlistonline'),\n                array('module' => 'lhspeech', 'function' => 'change_chat_recognition'),\n                array('module' => 'lhgroupchat', 'function' => 'use'),\n                array('module' => 'lhuser', 'function' => 'see_all_group_users'),\n                array('module' => 'lhvoicevideo', 'function' => 'use'),\n            );\n\n            foreach ($permissionsArray as $paramsPermission) {\n                $RoleFunctionOperator = new erLhcoreClassModelRoleFunction();\n                $RoleFunctionOperator->role_id = $RoleOperators->id;\n                $RoleFunctionOperator->module = $paramsPermission['module'];\n                $RoleFunctionOperator->function = $paramsPermission['function'];\n                erLhcoreClassRole::getSession()->save($RoleFunctionOperator);\n            }\n\n            $cfgSite = erConfigClassLhConfig::getInstance();\n            $cfgSite->setSetting( 'site', 'installed', true);\n            $cfgSite->setSetting( 'site', 'templatecache', true);\n            $cfgSite->setSetting( 'site', 'templatecompile', true);\n            $cfgSite->setSetting( 'site', 'modulecompile', true);\n            $cfgSite->setSetting( 'site', 'force_virtual_host', $form->ForceVirtualHost == 1);\n            $cfgSite->setSetting( 'webhooks', 'enabled', isset($form->WebhooksEnabled) &&$form->WebhooksEnabled == 1);\n            $cfgSite->setSetting( 'webhooks', 'worker', isset($form->WebhooksWorker) ? $form->WebhooksWorker : 'http');\n            \n            if ($form->Extensions != '') {\n                $extensions = explode(',',str_replace(' ','',$form->Extensions));\n                if (!empty($extensions) ) {\n                    $cfgSite->setSetting( 'site', 'extensions', $extensions);\n                }\n            }\n\n            if ($form->ApacheUserGroupName != '') {\n                $cfgSite->setSetting( 'site', 'default_group', $form->ApacheUserGroupName);\n            }\n\n            if ($form->ApacheUserName != '') {\n                $cfgSite->setSetting( 'site', 'default_user', $form->ApacheUserName);\n            }\n\n            if ($form->TimeZone != '') {\n                $cfgSite->setSetting( 'site', 'time_zone', $form->TimeZone);\n            }\n\n            if (isset($form->DefaultConfigs) && is_array($form->DefaultConfigs)) {\n                foreach ($form->DefaultConfigs as $identifier => $value) {\n                    $sql = \"UPDATE `lh_chat_config` SET `value` = :value WHERE `identifier` = :identifier\";\n                    $stmt = $db->prepare($sql);\n                    $stmt->bindValue(':value',$value);\n                    $stmt->bindValue(':identifier',$identifier);\n                    $stmt->execute();\n                }\n            }\n\n            $smtpData = erLhcoreClassModelChatConfig::fetch('smtp_data');\n\n            $data = (array)$smtpData->data;\n            $data['default_from'] = 'info@'.$form->Domain;\n            $data['default_from_name'] = trim($form->AdminName . ' ' . $form->AdminSurname);\n            $data['sender'] = 'info@'.$form->Domain;\n\n            $smtpData->value = serialize($data);\n            $smtpData->saveThis();\n\n            return true;\n        } else {\n            return $Errors;\n        }\n    }\n\n    function step4() {\n        $cfgSite = erConfigClassLhConfig::getInstance();\n        $cfgSite->save();\n        $msg = \"Installation is complete. You can start by adding users and departments\";\n        syslog(LOG_DEBUG, $msg);\n    }\n\n    function print_errors($errors) {\n        foreach($errors as $error) {\n            syslog(LOG_ERR, \"ERROR: \".$error);\n        }\n        exit(-1);\n    }\n\n    private function file_perms($file, $octal = true) {\n        if(!file_exists($file)) return false;\n\n        $perms = fileperms($file);\n\n        $cut = $octal ? 2 : 3;\n\n        return substr(decoct($perms), $cut);\n    }\n    private function file_is_writable($directories, $preffix = '', &$Errors) {\n        foreach ($directories as $directory) {\n            $error = false;\n            syslog(LOG_DEBUG, \"Evaluate $directory if writable\");\n            $owner = fileowner($preffix.$directory);\n            $group = filegroup($preffix.$directory);\n            $permission = $this->file_perms($preffix.$directory);\n            if ($permission[2] == 7) {\n                continue;\n            }\n            if ($owner == 33 and $permission[0] != 7) {\n                $error = true;\n            }\n            if ($group == 33 and $permission[1] != 7) {\n                $error = true;\n            }\n            if ($error) {\n                $Errors[] = $preffix.$directory.\" is not writable\";\n            }\n        }\n    }\n\n    private function _scandir($directory) {\n        $directories = scandir($directory);\n        $directories = array_diff($directories, ['.']);\n        $directories = array_diff($directories, ['..']);\n        return $directories;\n    }\n}\n", "<?php\nerLhcoreClassRestAPIHandler::setHeaders();\n\nheader('P3P:CP=\"IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT\"');\nheader('Expires: Sat, 26 Jul 1997 05:00:00 GMT' );\nheader('Last-Modified: ' . gmdate( 'D, d M Y H:i:s',time()+60*60*8 ) . ' GMT' );\nheader('Cache-Control: no-store, no-cache, must-revalidate' );\nheader('Cache-Control: post-check=0, pre-check=0', false );\nheader('Pragma: no-cache' );\n\n$hash = sha1(erLhcoreClassIPDetect::getIP().$Params['user_parameters']['timets'].erConfigClassLhConfig::getInstance()->getSetting( 'site', 'secrethash' ));\n\nif ( (time()-$Params['user_parameters']['timets']) > 600 || (time()-($Params['user_parameters']['timets'] - 5)) < 0) {\n\techo json_encode(array('result' => 'false'));\n\texit;\n}\n\nif (erLhcoreClassModelChatConfig::fetch('session_captcha')->current_value == 1) {\n\t// Start session if required only\n\t$currentUser = erLhcoreClassUser::instance();\n\t\n\t$_SESSION[$_SERVER['REMOTE_ADDR']][$Params['user_parameters']['captcha_name']] = $hash;\n}\n\necho json_encode(array('result' => $hash));\n\nexit;", "<?php\n\ntry {\n\n    $cfgSite = erConfigClassLhConfig::getInstance();\n\n    if ($cfgSite->getSetting( 'site', 'installed' ) == true)\n    {\n        $Params['module']['functions'] = array('install');\n        include_once('modules/lhkernel/nopermission.php');\n\n        $Result['pagelayout'] = 'install';\n        $Result['path'] = array(array('title' => 'Live helper chat installation'));\n        return $Result;\n\n        exit;\n    }\n\n    $instance = erLhcoreClassSystem::instance();\n\n    if ($instance->SiteAccess != 'site_admin') {\n        header('Location: ' .erLhcoreClassDesign::baseurldirect('site_admin/install/install') );\n        exit;\n    }\n\n    $tpl = new erLhcoreClassTemplate( 'lhinstall/install1.tpl.php');\n\n    switch ((int)$Params['user_parameters']['step_id']) {\n\n        case '1':\n            $Errors = array();\n            if (!is_writable(\"cache/cacheconfig\"))\n                $Errors[] = \"cache/cacheconfig is not writable\";\n\n            if (!is_writable(\"settings/\"))\n                $Errors[] = \"settings/ is not writable\";\n\n            if (!is_writable(\"cache/translations\"))\n                $Errors[] = \"cache/translations is not writable\";\n\n            if (!is_writable(\"cache/userinfo\"))\n                $Errors[] = \"cache/userinfo is not writable\";\n\n            if (!is_writable(\"cache/compiledtemplates\"))\n                $Errors[] = \"cache/compiledtemplates is not writable\";\n\n            if (!is_writable(\"var/storage\"))\n                $Errors[] = \"var/storage is not writable\";\n\n            if (!is_writable(\"var/storageform\"))\n                $Errors[] = \"var/storageform is not writable\";\n\n            if (!is_writable(\"var/userphoto\"))\n                $Errors[] = \"var/userphoto is not writable\";\n\n            if (!is_writable(\"var/tmpfiles\"))\n                $Errors[] = \"var/tmpfiles is not writable\";\n\n            if (!is_writable(\"var/storagetheme\"))\n                $Errors[] = \"var/storagetheme is not writable\";\n\n            if (!is_writable(\"var/botphoto\"))\n                $Errors[] = \"var/botphoto is not writable\";\n\n            if (!is_writable(\"var/bottrphoto\"))\n                $Errors[] = \"var/bottrphoto is not writable\";\n\n            if (!is_writable(\"var/storageinvitation\"))\n                $Errors[] = \"var/storageinvitation is not writable\";\n\n            if (!is_writable(\"var/storageadmintheme\"))\n                $Errors[] = \"var/storageadmintheme is not writable\";\n\n            if (!extension_loaded ('pdo_mysql' ))\n                $Errors[] = \"php-pdo extension not detected. Please install php extension\";\n\n            if (!extension_loaded('curl'))\n                $Errors[] = \"php_curl extension not detected. Please install php extension\";\n\n            if (!extension_loaded('mbstring'))\n                $Errors[] = \"mbstring extension not detected. Please install php extension\";\n\n            if (!extension_loaded('gd'))\n                $Errors[] = \"gd extension not detected. Please install php extension\";\n\n            if (!function_exists('json_encode'))\n                $Errors[] = \"json support not detected. Please install php extension\";\n\n            if (!function_exists('simplexml_load_string'))\n                $Errors[] = \"XML support not detected. Please install php-xml extension\";\n\n            if (version_compare(PHP_VERSION, '5.4.0','<')) {\n                $Errors[] = \"Minimum 5.4.0 PHP version is required\";\n            }\n\n            if (count($Errors) == 0){\n                $tpl->setFile('lhinstall/install2.tpl.php');\n            }\n            break;\n\n        case '2':\n            $Errors = array();\n\n            $definition = array(\n                'DatabaseUsername' => new ezcInputFormDefinitionElement(\n                    ezcInputFormDefinitionElement::REQUIRED, 'unsafe_raw'\n                ),\n                'DatabasePassword' => new ezcInputFormDefinitionElement(\n                    ezcInputFormDefinitionElement::REQUIRED, 'unsafe_raw'\n                ),\n                'DatabaseHost' => new ezcInputFormDefinitionElement(\n                    ezcInputFormDefinitionElement::REQUIRED, 'string'\n                ),\n                'DatabasePort' => new ezcInputFormDefinitionElement(\n                    ezcInputFormDefinitionElement::REQUIRED, 'int'\n                ),\n                'DatabaseDatabaseName' => new ezcInputFormDefinitionElement(\n                    ezcInputFormDefinitionElement::REQUIRED, 'string'\n                ),\n            );\n\n            $form = new ezcInputForm( INPUT_POST, $definition );\n\n\n            if ( !$form->hasValidData( 'DatabaseUsername' ) )\n            {\n                $Errors[] = 'Please enter database username';\n            }\n\n            if ( !$form->hasValidData( 'DatabasePassword' ) )\n            {\n                $Errors[] = 'Please enter database password';\n            }\n\n            if ( !$form->hasValidData( 'DatabaseHost' ) || $form->DatabaseHost == '' )\n            {\n                $Errors[] = 'Please enter database host';\n            }\n\n            if ( !$form->hasValidData( 'DatabasePort' ) || $form->DatabasePort == '' )\n            {\n                $Errors[] = 'Please enter database post';\n            }\n\n            if ( !$form->hasValidData( 'DatabaseDatabaseName' ) || $form->DatabaseDatabaseName == '' )\n            {\n                $Errors[] = 'Please enter database name';\n            }\n\n            if (count($Errors) == 0)\n            {\n                try {\n                    $db = ezcDbFactory::create( \"mysql://{$form->DatabaseUsername}:{$form->DatabasePassword}@{$form->DatabaseHost}:{$form->DatabasePort}/{$form->DatabaseDatabaseName}\" );\n                } catch (Exception $e) {\n                    $Errors[] = 'Cannot login with provided logins. Returned message: <br/>'.$e->getMessage();\n                }\n            }\n\n            if (count($Errors) == 0){\n\n                $cfgSite = erConfigClassLhConfig::getInstance();\n                $cfgSite->setSetting( 'db', 'host', $form->DatabaseHost);\n                $cfgSite->setSetting( 'db', 'user', $form->DatabaseUsername);\n                $cfgSite->setSetting( 'db', 'password', $form->DatabasePassword);\n                $cfgSite->setSetting( 'db', 'database', $form->DatabaseDatabaseName);\n                $cfgSite->setSetting( 'db', 'port', $form->DatabasePort);\n                $cfgSite->setSetting( 'site', 'secrethash', (!empty(getenv('LHC_SECRET_HASH')) ? getenv('LHC_SECRET_HASH') : substr(md5(time() . \":\" . mt_rand()),0,10)));\n                $cfgSite->save();\n\n                $tpl->setFile('lhinstall/install3.tpl.php');\n            } else {\n\n                $tpl->set('db_username',$form->DatabaseUsername);\n                $tpl->set('db_password',$form->DatabasePassword);\n                $tpl->set('db_host',$form->DatabaseHost);\n                $tpl->set('db_port',$form->DatabasePort);\n                $tpl->set('db_name',$form->DatabaseDatabaseName);\n\n                $tpl->set('errors',$Errors);\n                $tpl->setFile('lhinstall/install2.tpl.php');\n            }\n            break;\n\n        case '3':\n\n            $Errors = array();\n\n            if ($_SERVER['REQUEST_METHOD'] == 'POST')\n            {\n                $definition = array(\n                    'AdminUsername' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::REQUIRED, 'unsafe_raw'\n                    ),\n                    'AdminPassword' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::REQUIRED, 'unsafe_raw'\n                    ),\n                    'AdminPassword1' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::REQUIRED, 'unsafe_raw'\n                    ),\n                    'AdminEmail' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::REQUIRED, 'validate_email'\n                    ),\n                    'AdminName' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::OPTIONAL, 'unsafe_raw'\n                    ),\n                    'AdminSurname' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::OPTIONAL, 'unsafe_raw'\n                    ),\n                    'DefaultDepartament' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::REQUIRED, 'string'\n                    )\n                );\n\n                $form = new ezcInputForm( INPUT_POST, $definition );\n\n\n                if ( !$form->hasValidData( 'AdminUsername' ) || $form->AdminUsername == '')\n                {\n                    $Errors[] = 'Please enter admin username';\n                }\n\n                if ($form->hasValidData( 'AdminUsername' ) && $form->AdminUsername != '' && strlen($form->AdminUsername) > 40)\n                {\n                    $Errors[] = 'Maximum 40 characters for admin username';\n                }\n\n                if ( !$form->hasValidData( 'AdminPassword' ) || $form->AdminPassword == '')\n                {\n                    $Errors[] = 'Please enter admin password';\n                }\n\n                if ($form->hasValidData( 'AdminPassword' ) && $form->AdminPassword != '' && strlen($form->AdminPassword) > 40)\n                {\n                    $Errors[] = 'Maximum 40 characters for admin password';\n                }\n\n                if ($form->hasValidData( 'AdminPassword' ) && $form->AdminPassword != '' && strlen($form->AdminPassword) <= 40 && $form->AdminPassword1 != $form->AdminPassword)\n                {\n                    $Errors[] = 'Passwords missmatch';\n                }\n\n\n                if ( !$form->hasValidData( 'AdminEmail' ) )\n                {\n                    $Errors[] = 'Wrong email address';\n                }\n\n\n                if ( !$form->hasValidData( 'DefaultDepartament' ) || $form->DefaultDepartament == '')\n                {\n                    $Errors[] = 'Please enter default department name';\n                }\n\n                if (count($Errors) == 0) {\n\n                    $tpl->set('admin_username',$form->AdminUsername);\n                    $adminEmail = '';\n                    if ( $form->hasValidData( 'AdminEmail' ) ) {\n                        $tpl->set('admin_email',$form->AdminEmail);\n                        $adminEmail = $form->AdminEmail;\n                    }\n                    $tpl->set('admin_name',$form->AdminName);\n                    $tpl->set('admin_surname',$form->AdminSurname);\n                    $tpl->set('admin_departament',$form->DefaultDepartament);\n\n                    /*DATABASE TABLES SETUP*/\n                    $db = ezcDbInstance::get();\n\n                    try {\n                        $db->query(\"set global innodb_large_prefix = 1\");\n                    } catch (Exception $e) {\n                        // Just ignore if not succeed\n                    }\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat` (\n\t\t\t\t  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `nick` varchar(100) NOT NULL,\n\t\t\t\t  `status` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `status_sub` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `status_sub_sub` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `time` int(11) NOT NULL,\n\t\t\t\t  `user_id` int(11) NOT NULL,\n\t\t\t\t  `hash` varchar(40) NOT NULL,\n\t\t\t\t  `referrer` text NOT NULL,\n        \t   \t  `session_referrer` text NOT NULL,\n        \t   \t  `chat_variables` text NOT NULL,\n        \t   \t  `remarks` text NOT NULL,\n\t\t\t\t  `ip` varchar(100) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\t\t\t\t \n\t\t\t\t  `invitation_id` int(11) NOT NULL,\t\t\t\t \n\t\t\t\t  `sender_user_id` int(11) NOT NULL,\n\t\t\t\t  `product_id` int(11) NOT NULL,\n\t\t\t\t  `pnd_time` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `cls_time` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `usaccept` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_status` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_closed_ts` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `support_informed` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `unread_messages_informed` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `reinform_timeout` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `last_op_msg_time` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `has_unread_op_messages` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `unread_op_messages_informed` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `email` varchar(100) NOT NULL,\n\t\t\t\t  `country_code` varchar(100) NOT NULL,\n\t\t\t\t  `country_name` varchar(100) NOT NULL,\n\t\t\t\t  `unanswered_chat` int(11) NOT NULL,\n\t\t\t\t  `cls_us` tinyint(1) NOT NULL DEFAULT '0',\n\t\t\t\t  `anonymized` tinyint(1) NOT NULL,\n\t\t\t\t  `user_typing` int(11) NOT NULL,\n\t\t\t\t  `gbot_id` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_typing_txt` varchar(200) NOT NULL,\n\t\t\t\t  `operator_typing` int(11) NOT NULL,\n        \t   \t  `operator_typing_id` int(11) NOT NULL,\n\t\t\t\t  `phone` varchar(100) NOT NULL,\n\t\t\t\t  `has_unread_messages` int(11) NOT NULL,\n\t\t\t\t  `last_user_msg_time` int(11) NOT NULL,\n\t\t\t\t  `fbst` tinyint(1) NOT NULL,\n\t\t\t\t  `online_user_id` int(11) NOT NULL,\n\t\t\t\t  `auto_responder_id` int(11) NOT NULL,\n\t\t\t\t  `last_msg_id` int(11) NOT NULL,\n\t\t\t\t  `lsync` int(11) NOT NULL,\n\t\t\t\t  `transfer_uid` int(11) NOT NULL,\n\t\t\t\t  `additional_data` text NOT NULL,\t\t\t\t  \n\t\t\t\t  `user_tz_identifier` varchar(50) NOT NULL,\n\t\t\t\t  `lat` varchar(10) NOT NULL,\n\t\t\t\t  `lon` varchar(10) NOT NULL,\n\t\t\t\t  `city` varchar(100) NOT NULL,\n\t\t\t\t  `operation` text NOT NULL,\n\t\t\t\t  `operation_admin` varchar(200) NOT NULL,\n\t\t\t\t  `status_sub_arg` varchar(200) NOT NULL,\n\t\t\t\t  `uagent` varchar(250) NOT NULL,\n\t\t\t\t  `chat_locale` varchar(10) NOT NULL,\n\t\t\t\t  `chat_locale_to` varchar(10) NOT NULL,\n\t\t\t\t  `mail_send` int(11) NOT NULL,\n        \t   \t  `screenshot_id` int(11) NOT NULL,\n        \t   \t  `wait_time` int(11) NOT NULL,\n  \t\t\t\t  `chat_duration` int(11) NOT NULL,\n  \t\t\t\t  `tslasign` int(11) NOT NULL,\n        \t   \t  `priority` int(11) NOT NULL,\n        \t   \t  `chat_initiator` int(11) NOT NULL,\n        \t   \t  `transfer_timeout_ts` int(11) NOT NULL,\n        \t   \t  `transfer_timeout_ac` int(11) NOT NULL,\n        \t   \t  `transfer_if_na` int(11) NOT NULL,\n        \t   \t  `na_cb_executed` int(11) NOT NULL,\n        \t   \t  `device_type` int(11) NOT NULL,\n        \t   \t  `nc_cb_executed` tinyint(1) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `status_user_id` (`status`,`user_id`),\n\t\t\t\t  KEY `unanswered_chat` (`unanswered_chat`),\n\t\t\t\t  KEY `online_user_id` (`online_user_id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `product_id` (`product_id`),\n\t\t\t\t  KEY `unread_operator` (`has_unread_op_messages`,`unread_op_messages_informed`),\n\t\t\t\t  KEY `user_id_sender_user_id` (`user_id`,`sender_user_id`),\n\t\t\t\t  KEY `sender_user_id` (`sender_user_id`),\n\t\t\t\t  KEY `anonymized` (`anonymized`),\n\t\t\t\t  KEY `has_unread_messages` (`has_unread_messages`),\n\t\t\t\t  KEY `status` (`status`),\n\t\t\t\t  KEY `nick` (`nick`),\n\t\t\t\t  KEY `email` (`email`),\n\t\t\t\t  KEY `dep_id_status` (`dep_id`,`status`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n               $db->query(\"CREATE TABLE `lh_chat_blocked_user` (\n                  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `ip` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `user_id` bigint(20) unsigned NOT NULL,\n                  `datets` bigint(20) unsigned NOT NULL,\n                  `chat_id` bigint(20) unsigned NOT NULL,\n                  `dep_id` bigint(20) unsigned NOT NULL,\n                  `nick` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `btype` tinyint(1) NOT NULL DEFAULT 0,\n                  `expires` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  `online_user_id` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  PRIMARY KEY (`id`),\n                  KEY `ip` (`ip`),\n                  KEY `nick` (`nick`),\n                  KEY `online_user_id` (`online_user_id`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_users_online_session` ( \n        \t       `id` bigint(20) NOT NULL AUTO_INCREMENT, \n        \t       `user_id` int(11) NOT NULL, \n        \t       `time` int(11) NOT NULL, \n        \t       `duration` int(11) NOT NULL, \n        \t       `lactivity` int(11) NOT NULL, \n        \t       PRIMARY KEY (`id`), \n        \t       KEY `user_id_lactivity` (`user_id`, `lactivity`), KEY `lactivity` (`lactivity`) ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_chat_start_settings` ( \n        \t       `id` int(11) NOT NULL AUTO_INCREMENT, \n        \t       `name` varchar(50) NOT NULL, \n        \t       `data` longtext NOT NULL, \n        \t       `department_id` int(11) NOT NULL, \n        \t       PRIMARY KEY (`id`), \n        \t       KEY `department_id` (`department_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_chat_event_track` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL, `data` longtext NOT NULL, `department_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `department_id` (`department_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_archive_range` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `range_from` int(11) NOT NULL,\n        \t   `range_to` int(11) NOT NULL,\n        \t   `year_month` int(11) NOT NULL,\n        \t   `older_than` int(11) NOT NULL,\n        \t   `last_id` int(11) NOT NULL,\n        \t   `first_id` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_notification_subscriber` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `online_user_id` bigint(20) NOT NULL, `dep_id` int(11) NOT NULL, `theme_id` int(11) NOT NULL, `ctime` int(11) NOT NULL, `utime` int(11) NOT NULL, `status` int(11) NOT NULL, `params` text NOT NULL, `device_type` tinyint(1) NOT NULL,`subscriber_hash` varchar(50) NOT NULL, `uagent` varchar(250) NOT NULL, `ip` varchar(250) NOT NULL, `last_error` text NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`), KEY `dep_id` (`dep_id`), KEY `online_user_id` (`online_user_id`), KEY `subscriber_hash` (`subscriber_hash`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_auto_responder` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `siteaccess` varchar(3) NOT NULL,\n                  `wait_message` text NOT NULL,\n                  `wait_timeout` int(11) NOT NULL,\n                  `position` int(11) NOT NULL,\n                  `timeout_message` text NOT NULL,\n                  `bot_configuration` text NOT NULL,\n                  `name` varchar(50) NOT NULL,\n                  `operator` varchar(50) NOT NULL,\n                  `dep_id` int(11) NOT NULL,\n                  `user_id` int(11) NOT NULL,\n                  `only_proactive` int(11) NOT NULL,\n                  `repeat_number` int(11) NOT NULL DEFAULT '1',\n                  `survey_timeout` int(11) NOT NULL DEFAULT '0',\n                  `survey_id` int(11) NOT NULL DEFAULT '0',\n                  `wait_timeout_hold_1` int(11) NOT NULL,\n                  `wait_timeout_hold_2` int(11) NOT NULL,\n                  `wait_timeout_hold_3` int(11) NOT NULL,\n                  `wait_timeout_hold_4` int(11) NOT NULL,\n                  `wait_timeout_hold_5` int(11) NOT NULL,\n                  `timeout_hold_message_1` text NOT NULL,\n                  `timeout_hold_message_2` text NOT NULL,\n                  `timeout_hold_message_3` text NOT NULL,\n                  `timeout_hold_message_4` text NOT NULL,\n                  `timeout_hold_message_5` text NOT NULL,\n                  `wait_timeout_hold` text NOT NULL,\n                  `wait_timeout_2` int(11) NOT NULL,\n                  `timeout_message_2` text NOT NULL,\n                  `wait_timeout_3` int(11) NOT NULL,\n                  `timeout_message_3` text NOT NULL,\n                  `wait_timeout_4` int(11) NOT NULL,\n                  `timeout_message_4` text NOT NULL,\n                  `wait_timeout_5` int(11) NOT NULL,\n                  `timeout_message_5` text NOT NULL,\n                  `wait_timeout_reply_1` int(11) NOT NULL,\n                  `timeout_reply_message_1` text NOT NULL,\n                  `wait_timeout_reply_2` int(11) NOT NULL,\n                  `timeout_reply_message_2` text NOT NULL,\n                  `wait_timeout_reply_3` int(11) NOT NULL,\n                  `timeout_reply_message_3` text NOT NULL,\n                  `wait_timeout_reply_4` int(11) NOT NULL,\n                  `timeout_reply_message_4` text NOT NULL,\n                  `wait_timeout_reply_5` int(11) NOT NULL,\n                  `timeout_reply_message_5` text NOT NULL,\n                  `languages` text NOT NULL,\n                  `ignore_pa_chat` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `siteaccess_position` (`siteaccess`,`position`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_widget_theme` (\n                      `id` int(11) NOT NULL AUTO_INCREMENT,\n                      `name` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `name_company` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `onl_bcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `bor_bcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT 'e3e3e3',\n                      `text_color` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `online_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `online_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `offline_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `offline_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `logo_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `logo_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `header_background` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_tcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_bcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_border` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_close_bg` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_hover_bg` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_close_hover_bg` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `custom_status_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `custom_container_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `custom_widget_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_header` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `online_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `offline_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `widget_border_color` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `copyright_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `copyright_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `widget_copyright_url` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `show_copyright` int(11) NOT NULL DEFAULT 1,\n                      `explain_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `intro_operator_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `operator_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `operator_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `minimize_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `minimize_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `restore_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `restore_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `close_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `close_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `popup_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `popup_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `hide_close` int(11) NOT NULL,\n                      `hide_popup` int(11) NOT NULL,\n                      `header_height` int(11) NOT NULL,\n                      `header_padding` int(11) NOT NULL,\n                      `widget_border_width` int(11) NOT NULL,\n                      `support_joined` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `support_closed` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `pending_join` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `noonline_operators` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `noonline_operators_offline` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `show_need_help` int(11) NOT NULL DEFAULT 1,\n                      `show_need_help_timeout` int(11) NOT NULL DEFAULT 24,\n                      `show_voting` tinyint(1) NOT NULL DEFAULT 1,\n                      `department_title` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `department_select` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `buble_visitor_background` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `buble_visitor_title_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `buble_visitor_text_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `buble_operator_background` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `buble_operator_title_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `buble_operator_text_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `custom_popup_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `hide_ts` int(11) NOT NULL,\n                      `widget_response_width` int(11) NOT NULL,\n                      `show_need_help_delay` int(11) NOT NULL,\n                      `show_status_delay` int(11) NOT NULL,\n                      `modern_look` tinyint(1) NOT NULL DEFAULT 0,\n                      `bot_status_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `bot_configuration` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `notification_configuration` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `pending_join_queue` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `modified` int(11) NOT NULL,\n                      `widget_show_leave_form` tinyint(1) NOT NULL,\n                      `enable_widget_embed_override` tinyint(1) NOT NULL,\n                      `widget_popheight` int(11) NOT NULL,\n                      `widget_popwidth` int(11) NOT NULL,\n                      `widget_survey` int(11) NOT NULL,\n                      `widget_position` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `widget_pright` int(11) NOT NULL,\n                      `widget_pbottom` int(11) NOT NULL,\n                      `alias` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      PRIMARY KEY (`id`),\n                      KEY `alias` (`alias`)\n                    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_faq` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `question` varchar(250) NOT NULL,\n\t\t\t\t  `answer` text NOT NULL,\n\t\t\t\t  `url` varchar(250) NOT NULL,\n\t\t\t\t  `email` varchar(50) NOT NULL,\n\t\t\t\t  `identifier` varchar(10) NOT NULL,\n\t\t\t\t  `active` int(11) NOT NULL,\n\t\t\t\t  `has_url` tinyint(1) NOT NULL,\n\t\t\t\t  `is_wildcard` tinyint(1) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `active` (`active`),\n\t\t\t\t  KEY `active_url_2` (`active`,`url`(191)),\n\t\t\t\t  KEY `has_url` (`has_url`),\n\t\t\t\t  KEY `identifier` (`identifier`),\n\t\t\t\t  KEY `is_wildcard` (`is_wildcard`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    $db->query(\"CREATE TABLE `lh_group_chat` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `name` varchar(50) NOT NULL,\n  `status` int(11) NOT NULL,\n  `time` int(11) NOT NULL,\n  `user_id` int(11) NOT NULL,\n  `chat_id` bigint(20) NOT NULL DEFAULT 0,\n  `last_msg_op_id` bigint(20) NOT NULL,\n  `last_msg` varchar(200) NOT NULL,\n  `last_user_msg_time` int(11) NOT NULL,\n  `last_msg_id` bigint(20) NOT NULL,\n  `type` tinyint(1) NOT NULL DEFAULT 0,\n  `tm` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `user_id` (`user_id`),\n  KEY `chat_id` (`chat_id`),\n  KEY `type` (`type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_group_msg` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `msg` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n  `time` int(11) NOT NULL,\n  `chat_id` int(11) NOT NULL DEFAULT 0,\n  `user_id` int(11) NOT NULL DEFAULT 0,\n  `name_support` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `meta_msg` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `chat_id_id` (`chat_id`,`id`),\n  KEY `user_id` (`user_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_group_chat_member` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `user_id` bigint(20) NOT NULL,\n  `group_id` bigint(20) NOT NULL,\n  `last_activity` int(11) NOT NULL,\n  `last_msg_id` bigint(20) NOT NULL DEFAULT 0,\n  `type` tinyint(1) NOT NULL DEFAULT 0,\n  `jtime` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `group_id` (`group_id`),\n  KEY `user_id` (`user_id`),\n  KEY `type` (`type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_cobrowse` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `chat_id` int(11) NOT NULL,\n        \t   `online_user_id` int(11) NOT NULL,\n        \t   `mtime` int(11) NOT NULL,\n        \t   `url` varchar(250) NOT NULL,\n        \t   `initialize` longtext NOT NULL,\n        \t   `modifications` longtext NOT NULL,\n        \t   `finished` tinyint(1) NOT NULL,\n        \t   `w` int NOT NULL,\n\t\t\t   `wh` int NOT NULL,\n\t\t\t   `x` int NOT NULL,\n\t\t\t   `y` int NOT NULL,        \t   \t\t\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `chat_id` (`chat_id`),\n        \t   KEY `online_user_id` (`online_user_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_survey` (\n        \t      `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `name` varchar(250) NOT NULL,\n                  `feedback_text` text NOT NULL,\n                  `max_stars_1_title` varchar(250) NOT NULL,\n                  `max_stars_1_pos` int(11) NOT NULL,\n                  `max_stars_2_title` varchar(250) NOT NULL,\n                  `max_stars_2_pos` int(11) NOT NULL,\n                  `max_stars_2` int(11) NOT NULL,\n                  `max_stars_3_title` varchar(250) NOT NULL,\n                  `max_stars_3_pos` int(11) NOT NULL,\n                  `max_stars_3` int(11) NOT NULL,\n                  `max_stars_4_title` varchar(250) NOT NULL,\n                  `max_stars_4_pos` int(11) NOT NULL,\n                  `max_stars_4` int(11) NOT NULL,\n                  `max_stars_5_title` varchar(250) NOT NULL,\n                  `max_stars_5_pos` int(11) NOT NULL,\n                  `max_stars_5` int(11) NOT NULL,\n                  `question_options_1` varchar(250) NOT NULL,\n                  `question_options_1_items` text NOT NULL,\n                  `question_options_1_pos` int(11) NOT NULL,\n                  `question_options_2` varchar(250) NOT NULL,\n                  `question_options_2_items` text NOT NULL,\n                  `question_options_2_pos` int(11) NOT NULL,\n                  `question_options_3` varchar(250) NOT NULL,\n                  `question_options_3_items` text NOT NULL,\n                  `question_options_3_pos` int(11) NOT NULL,\n                  `question_options_4` varchar(250) NOT NULL,\n                  `question_options_4_items` text NOT NULL,\n                  `question_options_4_pos` int(11) NOT NULL,\n                  `question_options_5` varchar(250) NOT NULL,\n                  `question_options_5_items` text NOT NULL,\n                  `question_options_5_pos` int(11) NOT NULL,\n                  `question_plain_1` text NOT NULL,\n                  `question_plain_1_pos` int(11) NOT NULL,\n                  `question_plain_2` text NOT NULL,\n                  `question_plain_2_pos` int(11) NOT NULL,\n                  `question_plain_3` text NOT NULL,\n                  `question_plain_3_pos` int(11) NOT NULL,\n                  `question_plain_4` text NOT NULL,\n                  `question_plain_4_pos` int(11) NOT NULL,\n                  `question_plain_5` text NOT NULL,\n                  `question_plain_5_pos` int(11) NOT NULL,\n                  `max_stars_1_enabled` int(11) NOT NULL,\n                  `max_stars_2_enabled` int(11) NOT NULL,\n                  `max_stars_3_enabled` int(11) NOT NULL,\n                  `max_stars_4_enabled` int(11) NOT NULL,\n                  `max_stars_5_enabled` int(11) NOT NULL,\n                  `question_options_1_enabled` int(11) NOT NULL,\n                  `question_options_2_enabled` int(11) NOT NULL,\n                  `question_options_3_enabled` int(11) NOT NULL,\n                  `question_options_4_enabled` int(11) NOT NULL,\n                  `question_options_5_enabled` int(11) NOT NULL,\n                  `question_plain_1_enabled` int(11) NOT NULL,\n                  `question_plain_2_enabled` int(11) NOT NULL,\n                  `question_plain_3_enabled` int(11) NOT NULL,\n                  `question_plain_4_enabled` int(11) NOT NULL,\n                  `question_plain_5_enabled` int(11) NOT NULL,\n                  `max_stars_1` int(11) NOT NULL,\n                  `max_stars_1_req` int(11) NOT NULL,\n                  `max_stars_2_req` int(11) NOT NULL,\n                  `max_stars_3_req` int(11) NOT NULL,\n                  `max_stars_4_req` int(11) NOT NULL,\n                  `max_stars_5_req` int(11) NOT NULL,\n                  `question_options_1_req` int(11) NOT NULL,\n                  `question_options_2_req` int(11) NOT NULL,\n                  `question_options_3_req` int(11) NOT NULL,\n                  `question_options_4_req` int(11) NOT NULL,\n                  `question_options_5_req` int(11) NOT NULL,\n                  `question_plain_1_req` int(11) NOT NULL,\n                  `question_plain_2_req` int(11) NOT NULL,\n                  `question_plain_3_req` int(11) NOT NULL,\n                  `question_plain_4_req` int(11) NOT NULL,\n                  `question_plain_5_req` int(11) NOT NULL,\n                  `configuration` longtext NOT NULL,\n                  PRIMARY KEY (`id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    $db->query(\"CREATE TABLE `lh_admin_theme` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `name` varchar(100) NOT NULL,\n        \t       `static_content` longtext NOT NULL,\n        \t       `static_js_content` longtext NOT NULL,\n        \t       `static_css_content` longtext NOT NULL,\n        \t       `css_attributes` longtext NOT NULL,\n        \t       `header_content` text NOT NULL,\n        \t       `user_id` int(11) NOT NULL, \n        \t       `header_css` text NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `user_id` (`user_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    $db->query(\"CREATE TABLE `lh_chat_paid` ( \n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,  \n        \t       `hash` varchar(250) NOT NULL,  \n        \t       `chat_id` int(11) NOT NULL, \n        \t        PRIMARY KEY (`id`),  \n        \t       KEY `hash` (`hash`(191)),  \n        \t       KEY `chat_id` (`chat_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_survey_item` (\n        \t      `id` bigint(20) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `survey_id` int(11) NOT NULL,\n\t\t\t\t  `status` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `chat_id` int(11) NOT NULL,\n\t\t\t\t  `user_id` int(11) NOT NULL,\n\t\t\t\t  `ftime` int(11) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `max_stars_1` int(11) NOT NULL,\n\t\t\t\t  `max_stars_2` int(11) NOT NULL,\n\t\t\t\t  `max_stars_3` int(11) NOT NULL,\n\t\t\t\t  `max_stars_4` int(11) NOT NULL,\n\t\t\t\t  `max_stars_5` int(11) NOT NULL,\n\t\t\t\t  `question_options_1` int(11) NOT NULL,\n\t\t\t\t  `question_options_2` int(11) NOT NULL,\n\t\t\t\t  `question_options_3` int(11) NOT NULL,\n\t\t\t\t  `question_options_4` int(11) NOT NULL,\n\t\t\t\t  `question_options_5` int(11) NOT NULL,\n\t\t\t\t  `question_plain_1` text NOT NULL,\n\t\t\t\t  `question_plain_2` text NOT NULL,\n\t\t\t\t  `question_plain_3` text NOT NULL,\n\t\t\t\t  `question_plain_4` text NOT NULL,\n\t\t\t\t  `question_plain_5` text NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `survey_id` (`survey_id`),\n\t\t\t\t  KEY `chat_id` (`chat_id`),\n\t\t\t\t  KEY `user_id` (`user_id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `ftime` (`ftime`),\n\t\t\t\t  KEY `max_stars_1` (`max_stars_1`),\n\t\t\t\t  KEY `max_stars_2` (`max_stars_2`),\n\t\t\t\t  KEY `max_stars_3` (`max_stars_3`),\n\t\t\t\t  KEY `max_stars_4` (`max_stars_4`),\n\t\t\t\t  KEY `max_stars_5` (`max_stars_5`),\n\t\t\t\t  KEY `question_options_1` (`question_options_1`),\n\t\t\t\t  KEY `question_options_2` (`question_options_2`),\n\t\t\t\t  KEY `question_options_3` (`question_options_3`),\n\t\t\t\t  KEY `question_options_4` (`question_options_4`),\n\t\t\t\t  KEY `question_options_5` (`question_options_5`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_speech_language` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `name` varchar(100) NOT NULL,\n                  `siteaccess` varchar(3) NOT NULL DEFAULT '',\n                  PRIMARY KEY (`id`)\n               ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_speech_language_dialect` (\n                `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `language_id` int(11) NOT NULL,\n                  `lang_name` varchar(100) NOT NULL,\n                  `lang_code` varchar(100) NOT NULL,\n                  `short_code` varchar(4) NOT NULL DEFAULT '',\n                  PRIMARY KEY (`id`),\n                  KEY `language_id` (`language_id`),\n                  KEY `short_code` (`short_code`),\n                  KEY `lang_code` (`lang_code`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"INSERT INTO `lh_speech_language` (`id`, `name`, `siteaccess`) VALUES\n\t\t\t\t(1,\t'Afrikaans',''),\n\t\t\t\t(2,\t'Bahasa Indonesia',''),\n\t\t\t\t(3,\t'Bahasa Melayu',''),\n\t\t\t\t(4,\t'Catal\u00e0',''),\n\t\t\t\t(5,\t'\u010ce\u0161tina','cse'),\n\t\t\t\t(6,\t'Deutsch','ger'),\n\t\t\t\t(7,\t'English',''),\n\t\t\t\t(8,\t'Espa\u00f1ol','esp'),\n\t\t\t\t(9,\t'Euskara',''),\n\t\t\t\t(10,\t'Fran\u00e7ais','fre'),\n\t\t\t\t(11,\t'Galego',''),\n\t\t\t\t(12,\t'Hrvatski',''),\n\t\t\t\t(13,\t'IsiZulu',''),\n\t\t\t\t(14,\t'\u00cdslenska',''),\n\t\t\t\t(15,\t'Italiano','ita'),\n\t\t\t\t(16,\t'Magyar',''),\n\t\t\t\t(17,\t'Nederlands','nld'),\n\t\t\t\t(18,\t'Norsk bokm\u00e5l',''),\n\t\t\t\t(19,\t'Polski','pol'),\n\t\t\t\t(20,\t'Portugu\u00eas','por'),\n\t\t\t\t(21,\t'Rom\u00e2n\u0103',''),\n\t\t\t\t(22,\t'Sloven\u010dina','svk'),\n\t\t\t\t(23,\t'Suomi','fin'),\n\t\t\t\t(24,\t'Svenska',''),\n\t\t\t\t(25,\t'T\u00fcrk\u00e7e','tur'),\n\t\t\t\t(26,\t'\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438',''),\n\t\t\t\t(27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439','rus'),\n\t\t\t\t(28,\t'\u0421\u0440\u043f\u0441\u043a\u0438',''),\n\t\t\t\t(29,\t'\ud55c\uad6d\uc5b4',''),\n\t\t\t\t(30,\t'\u4e2d\u6587',''),\n\t\t\t\t(31,\t'\u65e5\u672c\u8a9e',''),\n\t\t\t\t(32,\t'Lingua lat\u012bna',''),\n\t\t\t\t(33,\t'Lithuanian','lit'),\n\t\t\t\t(34,\t'Latvia',''),\n\t\t\t\t(35,\t'Afar',''),\n\t\t\t\t(36,\t'Arabic',''),\n\t\t\t\t(37,\t'Assamese',''),\n\t\t\t\t(38,\t'Azerbaijani',''),\n\t\t\t\t(39,\t'Bulgarian','bgr'),\n\t\t\t\t(40,\t'Bangla',''),\n\t\t\t\t(41,\t'Bosnian',''),\n\t\t\t\t(42,\t'Cakchiquel',''),\n\t\t\t\t(43,\t'Danish',''),\n\t\t\t\t(44,\t'Greek',''),\n\t\t\t\t(45,\t'Estonian',''),\n\t\t\t\t(46,\t'Persian',''),\n\t\t\t\t(47,\t'Filipino',''),\n\t\t\t\t(48,\t'Gujarati',''),\n\t\t\t\t(49,\t'Hebrew',''),\n\t\t\t\t(50,\t'Croatian',''),\n\t\t\t\t(51,\t'Indonesia',''),\n\t\t\t\t(52,\t'Icelandic',''),\n\t\t\t\t(53,\t'Georgian',''),\n\t\t\t\t(54,\t'Maori (New Zealand)',''),\n\t\t\t\t(55,\t'Macedonian',''),\n\t\t\t\t(56,\t'Malay (Latin)',''),\n\t\t\t\t(57,\t'Maltese',''),\n\t\t\t\t(58,\t'Norwegian Nynorsk',''),\n\t\t\t\t(59,\t'Norwegian','nor'),\n\t\t\t\t(60,\t'Northern Sotho (South Africa)',''),\n\t\t\t\t(61,\t'Slovenian',''),\n\t\t\t\t(63,\t'Thai',''),\n\t\t\t\t(64,\t'Tagalog',''),\n\t\t\t\t(65,\t'Tongan',''),\n\t\t\t\t(66,\t'Ukrainian',''),\n\t\t\t\t(67,\t'Vietnamese','vnm'),\n\t\t\t\t(68,\t'Chinese','chn');\");\n\n                    $db->query(\"INSERT INTO `lh_speech_language_dialect` (`id`, `language_id`, `lang_name`, `lang_code`, `short_code`) VALUES\n(1,\t1,\t'Afrikaans',\t'af-ZA',\t'af'),\n(2,\t2,\t'Bahasa Indonesia',\t'id-ID',\t'id'),\n(3,\t3,\t'Bahasa Melayu',\t'ms-MY',\t''),\n(4,\t4,\t'Catal\u00e0',\t'ca-ES',\t''),\n(5,\t5,\t'\u010ce\u0161tina',\t'cs-CZ',\t'cs'),\n(6,\t6,\t'Deutsch',\t'de-DE',\t'de'),\n(7,\t7,\t'Australia',\t'en-AU',\t''),\n(8,\t7,\t'Canada',\t'en-CA',\t''),\n(9,\t7,\t'India',\t'en-IN',\t''),\n(10,\t7,\t'New Zealand',\t'en-NZ',\t''),\n(11,\t7,\t'South Africa',\t'en-ZA',\t''),\n(12,\t7,\t'United Kingdom',\t'en-GB',\t'en'),\n(13,\t7,\t'United States',\t'en-US',\t''),\n(14,\t8,\t'Argentina',\t'es-AR',\t''),\n(15,\t8,\t'Bolivia',\t'es-BO',\t''),\n(16,\t8,\t'Chile',\t'es-CL',\t''),\n(17,\t8,\t'Colombia',\t'es-CO',\t''),\n(18,\t8,\t'Costa Rica',\t'es-CR',\t''),\n(19,\t8,\t'Ecuador',\t'es-EC',\t''),\n(20,\t8,\t'El Salvador',\t'es-SV',\t''),\n(21,\t8,\t'Espa\u00f1a',\t'es-ES',\t'es'),\n(22,\t8,\t'Estados Unidos',\t'es-US',\t''),\n(23,\t8,\t'Guatemala',\t'es-GT',\t''),\n(24,\t8,\t'Honduras',\t'es-HN',\t''),\n(25,\t8,\t'M\u00e9xico',\t'es-MX',\t''),\n(26,\t8,\t'Nicaragua',\t'es-NI',\t''),\n(27,\t8,\t'Panam\u00e1',\t'es-PA',\t''),\n(28,\t8,\t'Paraguay',\t'es-PY',\t''),\n(29,\t8,\t'Per\u00fa',\t'es-PE',\t''),\n(30,\t8,\t'Puerto Rico',\t'es-PR',\t''),\n(31,\t8,\t'Rep\u00fablica Dominicana',\t'es-DO',\t''),\n(32,\t8,\t'Uruguay',\t'es-UY',\t''),\n(33,\t8,\t'Venezuela',\t'es-VE',\t''),\n(34,\t9,\t'Euskara',\t'eu-ES',\t''),\n(35,\t10,\t'Fran\u00e7ais',\t'fr-FR',\t'fr'),\n(36,\t11,\t'Galego',\t'gl-ES',\t''),\n(37,\t12,\t'Hrvatski',\t'hr_HR',\t''),\n(38,\t13,\t'IsiZulu',\t'zu-ZA',\t''),\n(39,\t14,\t'\u00cdslenska',\t'is-IS',\t''),\n(40,\t15,\t'Italia',\t'it-IT',\t'it'),\n(41,\t15,\t'Svizzera',\t'it-CH',\t'it'),\n(42,\t16,\t'Magyar',\t'hu-HU',\t'hu'),\n(43,\t17,\t'Nederlands',\t'nl-NL',\t'nl'),\n(44,\t18,\t'Norsk bokm\u00e5l',\t'nb-NO',\t'nb'),\n(45,\t19,\t'Polski',\t'pl-PL',\t'pl'),\n(46,\t20,\t'Brasil',\t'pt-BR',\t''),\n(47,\t20,\t'Portugal',\t'pt-PT',\t'pt'),\n(48,\t21,\t'Rom\u00e2n\u0103',\t'ro-RO',\t'ro'),\n(49,\t22,\t'Sloven\u010dina',\t'sk-SK',\t'sk'),\n(50,\t23,\t'Suomi',\t'fi-FI',\t'fi'),\n(51,\t24,\t'Swedish',\t'sv-SE',\t'sv'),\n(52,\t25,\t'T\u00fcrk\u00e7e',\t'tr-TR',\t'tr'),\n(53,\t26,\t'\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438',\t'bg-BG',\t''),\n(54,\t27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439',\t'ru-RU',\t'ru'),\n(55,\t28,\t'Serbian',\t'sr-RS',\t'sr'),\n(56,\t29,\t'\ud55c\uad6d\uc5b4',\t'ko-KR',\t'ko'),\n(57,\t30,\t'\u666e\u901a\u8bdd (\u4e2d\u56fd\u5927\u9646)',\t'cmn-Hans-CN',\t''),\n(58,\t30,\t'\u666e\u901a\u8bdd (\u9999\u6e2f)',\t'cmn-Hans-HK',\t''),\n(59,\t30,\t'\u4e2d\u6587 (\u53f0\u7063)',\t'cmn-Hant-TW',\t''),\n(60,\t30,\t'\u7cb5\u8a9e (\u9999\u6e2f)',\t'yue-Hant-HK',\t''),\n(61,\t31,\t'\u65e5\u672c\u8a9e',\t'ja-JP',\t'ja'),\n(62,\t32,\t'Lingua lat\u012bna',\t'la',\t''),\n(64,\t33,\t'Lithuanian',\t'lt-LT',\t'lt'),\n(65,\t34,\t'Latvia',\t'lv-LV',\t'lv'),\n(66,\t35,\t'Afar',\t'aa-DJ',\t'aa'),\n(67,\t36,\t'Egypt',\t'ar-EG',\t'ar'),\n(68,\t37,\t'India',\t'as-IN',\t'as'),\n(69,\t38,\t'Azerbaijani',\t'az-AZ',\t'az'),\n(70,\t39,\t'Bulgarian',\t'bg',\t'bg'),\n(71,\t40,\t'Bangla',\t'bn',\t'bn'),\n(72,\t41,\t'Bosnian',\t'bs-BA',\t'bs'),\n(73,\t42,\t'Cakchiquel',\t'cak',\t'cak'),\n(74,\t43,\t'Danish',\t'da-dk',\t'da'),\n(75,\t44,\t'Greek',\t'el-GR',\t'el'),\n(76,\t45,\t'Estonian',\t'et-EE',\t'et'),\n(77,\t46,\t'Persian',\t'fa-IR',\t'fa'),\n(78,\t47,\t'Filipino',\t'fil',\t'fil'),\n(79,\t48,\t'Gujarati',\t'gu-IN',\t'gu'),\n(80,\t49,\t'Hebrew',\t'he',\t'he'),\n(81,\t50,\t'Croatian',\t'hr-HR',\t'hr'),\n(82,\t51,\t'Indonesia',\t'in',\t'in'),\n(83,\t52,\t'Icelandic',\t'is',\t'is'),\n(84,\t53,\t'Georgian',\t'ka-ge',\t'ka'),\n(85,\t54,\t'Maori (New Zealand)',\t'mi-nz',\t'mi'),\n(86,\t55,\t'Macedonian',\t'mk-MK',\t'mk'),\n(87,\t56,\t'Malay (Latin)',\t'ms',\t'ms'),\n(88,\t57,\t'Maltese',\t'mt',\t'mt'),\n(89,\t58,\t'Norwegian Nynorsk',\t'nn-NO',\t'nn'),\n(90,\t59,\t'Norwegian',\t'no',\t'no'),\n(91,\t60,\t'Northern Sotho (South Africa)',\t'nso-za',\t'nso'),\n(92,\t61,\t'Slovenian',\t'sl-SI',\t'sl'),\n(94,\t63,\t'Thai',\t'th-TH',\t'th'),\n(95,\t64,\t'Tagalog',\t'tl',\t'tl'),\n(96,\t65,\t'Tongan',\t'to-TO',\t'to'),\n(97,\t66,\t'Ukrainian',\t'uk-UA',\t'uk'),\n(98,\t67,\t'Vietnamese',\t'vi-VN',\t'vi'),\n(99,\t68,\t'Chinese',\t'zh-CN',\t'zh'),\n(100,\t36,\t'Egypt',\t'ar-AE',\t''),\n(101,\t36,\t'Egypt',\t'ar-IQ',\t''),\n(102,\t41,\t'Bosnian',\t'bs-Latn-BA',\t''),\n(103,\t6,\t'Deutsch',\t'de-at',\t''),\n(104,\t6,\t'Deutsch',\t'de-ch',\t''),\n(105,\t6,\t'Deutsch',\t'de-GB',\t''),\n(106,\t6,\t'Deutsch',\t'de-LI',\t''),\n(107,\t6,\t'Deutsch',\t'de-LU',\t''),\n(108,\t7,\t'United Kingdom',\t'en-029',\t''),\n(109,\t7,\t'United Kingdom',\t'en-AS',\t''),\n(110,\t7,\t'United Kingdom',\t'en-BE',\t''),\n(111,\t7,\t'United Kingdom',\t'en-BM',\t''),\n(112,\t7,\t'United Kingdom',\t'en-BS',\t''),\n(113,\t7,\t'United Kingdom',\t'en-BW',\t''),\n(114,\t7,\t'United Kingdom',\t'en-CH',\t''),\n(115,\t7,\t'United Kingdom',\t'en-CX',\t''),\n(116,\t7,\t'United Kingdom',\t'en-CY',\t''),\n(117,\t7,\t'United Kingdom',\t'en-DE',\t''),\n(118,\t7,\t'United Kingdom',\t'en-DK',\t''),\n(119,\t7,\t'United Kingdom',\t'en-DM',\t''),\n(120,\t7,\t'United Kingdom',\t'en-GY',\t''),\n(121,\t7,\t'United Kingdom',\t'en-HK',\t''),\n(122,\t7,\t'United Kingdom',\t'en-ie',\t''),\n(123,\t7,\t'United Kingdom',\t'en-IM',\t''),\n(124,\t7,\t'United Kingdom',\t'en-JM',\t''),\n(125,\t7,\t'United Kingdom',\t'en-KY',\t''),\n(126,\t7,\t'United Kingdom',\t'en-MY',\t''),\n(127,\t7,\t'United Kingdom',\t'en-NF',\t''),\n(128,\t7,\t'United Kingdom',\t'en-NG',\t''),\n(129,\t7,\t'United Kingdom',\t'en-NL',\t''),\n(130,\t7,\t'United Kingdom',\t'en-PH',\t''),\n(131,\t7,\t'United Kingdom',\t'en-SE',\t''),\n(132,\t7,\t'United Kingdom',\t'en-sg',\t''),\n(133,\t7,\t'United Kingdom',\t'en-SI',\t''),\n(134,\t7,\t'United Kingdom',\t'en-SS',\t''),\n(135,\t7,\t'United Kingdom',\t'en-TO',\t''),\n(136,\t7,\t'United Kingdom',\t'en-TZ',\t''),\n(137,\t7,\t'United Kingdom',\t'en-UG',\t''),\n(138,\t7,\t'United Kingdom',\t'en-UK',\t''),\n(139,\t7,\t'United Kingdom',\t'en-ZG',\t''),\n(140,\t7,\t'United Kingdom',\t'en-ZM',\t''),\n(141,\t7,\t'United Kingdom',\t'en-ZW',\t''),\n(142,\t8,\t'Espa\u00f1a',\t'es-419',\t''),\n(143,\t8,\t'Espa\u00f1a',\t'es-xl',\t''),\n(144,\t47,\t'Filipino',\t'fil-PH',\t''),\n(145,\t10,\t'Fran\u00e7ais',\t'fr-BE',\t''),\n(146,\t10,\t'Fran\u00e7ais',\t'fr-ca',\t''),\n(147,\t10,\t'Fran\u00e7ais',\t'fr-ch',\t''),\n(148,\t10,\t'Fran\u00e7ais',\t'fr-CM',\t''),\n(149,\t10,\t'Fran\u00e7ais',\t'fr-MC',\t''),\n(150,\t49,\t'Hebrew',\t'he-IL',\t''),\n(151,\t50,\t'Croatian',\t'hr-BA',\t''),\n(152,\t17,\t'Nederlands',\t'nl-BE',\t''),\n(153,\t19,\t'Polski',\t'pl-GB',\t''),\n(154,\t27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439',\t'ru-KZ',\t''),\n(155,\t27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439',\t'ru-UA',\t''),\n(156,\t28,\t'Serbian',\t'sr-BA',\t''),\n(157,\t28,\t'Serbian',\t'sr-Latn-RS',\t''),\n(158,\t68,\t'Chinese',\t'zh-MO',\t''),\n(159,\t68,\t'Chinese',\t'zh-SG',\t''),\n(160,\t68,\t'Chinese',\t'zh-TW',\t'');\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_speech_chat_language` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `chat_id` int(11) NOT NULL,\n                  `language_id` int(11) NOT NULL,\n                  `dialect` varchar(50) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `chat_id` (`chat_id`)\n               ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_chat_alert_icon` (`id` bigint(20) NOT NULL AUTO_INCREMENT,`name` varchar(50) NOT NULL, `identifier` varchar(50) NOT NULL,PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_file` (\n        \t   `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n        \t   `name` varchar(255) NOT NULL,\n        \t   `upload_name` varchar(255) NOT NULL,\n        \t   `size` int(11) NOT NULL,\n        \t   `type` varchar(255) NOT NULL,\n        \t   `file_path` varchar(255) NOT NULL,\n        \t   `extension` varchar(255) NOT NULL,\n        \t   `chat_id` bigint(20) NOT NULL,\n        \t   `persistent` int(11) NOT NULL,\n        \t   `online_user_id` int(11) NOT NULL,\n        \t   `user_id` int(11) NOT NULL,\n        \t   `date` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `chat_id` (`chat_id`),\n        \t   KEY `online_user_id` (`online_user_id`),\n        \t   KEY `user_id` (`user_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_email_template` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `name` varchar(250) NOT NULL,\n\t\t\t\t  `from_name` varchar(150) NOT NULL,\n\t\t\t\t  `from_name_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `from_email` varchar(150) NOT NULL,\n\t\t\t\t  `from_email_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `user_mail_as_sender` tinyint(4) NOT NULL,\n                  `use_chat_locale` tinyint(1) NOT NULL DEFAULT '0',\n\t\t\t\t  `content` text NOT NULL,\n                  `translations` longtext NOT NULL,\n\t\t\t\t  `subject` varchar(250) NOT NULL,\n\t\t\t\t  `bcc_recipients` varchar(200) NOT NULL,\n\t\t\t\t  `subject_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `reply_to` varchar(150) NOT NULL,\n\t\t\t\t  `reply_to_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `recipient` varchar(150) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"INSERT INTO `lh_abstract_email_template` (`id`, `translations`, `name`, `from_name`, `from_name_ac`, `from_email`, `from_email_ac`, `content`, `subject`, `subject_ac`, `reply_to`, `reply_to_ac`, `recipient`, `bcc_recipients`, `user_mail_as_sender`) VALUES\n            \t   (1,'',\t'Send mail to user',\t'Live Helper Chat',\t0,\t'',\t0,\t'Dear {user_chat_nick},\\r\\n\\r\\n{additional_message}\\r\\n\\r\\nLive Support response:\\r\\n{messages_content}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team\\r\\n',\t'{name_surname} has responded to your request',\t1,\t'',\t1,\t'',\t'',\t0),\n            \t   (2,'',\t'Support request from user',\t'',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nAdditional data, if any:\\r\\n{additional_data}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nLink to chat if any:\\r\\n{prefillchat}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'{name}, {country}, {department}, Support request from user',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (3,'',\t'User mail for himself',\t'Live Helper Chat',\t0,\t'',\t0,\t'Dear {user_chat_nick},\\r\\n\\r\\nTranscript:\\r\\n{messages_content}\\r\\nChat ID: {chat_id}\\n\\r\\nSincerely,\\r\\nLive Support Team\\r\\n',\t'Chat transcript',\t0,\t'',\t0,\t'',\t'',\t0),\n            \t   (4,'',\t'New chat request',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nClick to accept chat automatically\\r\\n{url_accept}\\r\\n\\r\\nSurvey\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'New chat request',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (5,'',\t'Chat was closed',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\n{operator} has closed a chat\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nAdditional data, if any:\\r\\n{additional_data}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nSurvey:\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Chat was closed',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (6,'',\t'New FAQ question',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nNew FAQ question\\r\\nEmail: {email}\\r\\n\\r\\nQuestion:\\r\\n{question}\\r\\n\\r\\nQuestion URL:\\r\\n{url_question}\\r\\n\\r\\nURL to answer a question:\\r\\n{url_request}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'New FAQ question',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (7,'',\t'New unread message',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nClick to accept chat automatically\\r\\n{url_accept}\\r\\n\\r\\nSurvey:\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'New unread message',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (8,'',\t'Filled form',\t'MCFC',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser has filled a form\\r\\nForm name - {form_name}\\r\\nUser IP - {ip}\\r\\nDownload filled data - {url_download}\\r\\nView filled data - {url_view}\\r\\n\\r\\n{content}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Filled form - {form_name}',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (9,'',\t'Chat was accepted',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nOperator {user_name} has accepted a chat [{chat_id}]\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nClick to accept chat automatically\\r\\n{url_accept}\\r\\n\\r\\nSurvey:\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Chat was accepted [{chat_id}]',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (10,'',\t'Permission request',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nOperator {user} has requested these permissions\\n\\r\\n{permissions}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Permission request from {user}',\t0,\t'',\t0,\t'',\t'',\t0),\n            \t   (11,'',\t'You have unread messages',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nOperator {operator} has answered to you\\r\\n\\r\\n{messages}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Operator has answered to your request',\t0,\t'',\t0,\t'',\t'',\t0),\n            \t   (12,'',\t'Visitor returned',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nVisitor information\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nSee more information at\\r\\n{url_accept}\\r\\n\\r\\nLast chat:\\r\\n{message}\\r\\n\\r\\nAdditional data, if any:\\r\\n{additional_data}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Visitor returned - {username}',\t0,\t'',\t0,\t'',\t'',\t0);\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `question` varchar(250) NOT NULL,\n        \t   `location` varchar(250) NOT NULL,\n        \t   `active` int(11) NOT NULL,\n        \t   `priority` int(11) NOT NULL,\n        \t   `is_voting` int(11) NOT NULL,\n        \t   `question_intro` text NOT NULL,\n        \t   `revote` int(11) NOT NULL DEFAULT '0',\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `priority` (`priority`),\n        \t   KEY `active_priority` (`active`,`priority`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question_answer` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `ip` bigint(20) NOT NULL,\n        \t   `question_id` int(11) NOT NULL,\n        \t   `answer` text NOT NULL,\n        \t   `ctime` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `ip` (`ip`),\n        \t   KEY `question_id` (`question_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question_option` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `question_id` int(11) NOT NULL,\n        \t   `option_name` varchar(250) NOT NULL,\n        \t   `priority` tinyint(4) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `question_id` (`question_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                $db->query(\"CREATE TABLE `lh_chat_action` (\n                `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `chat_id` bigint(20) NOT NULL,\n                  `action` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `body` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `created_at` bigint(20) unsigned NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `chat_id` (`chat_id`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n               $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_stats` (\n                  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n                  `type` int(11) NOT NULL,\n                  `lupdate` bigint(20) NOT NULL,\n                  `object_id` bigint(20) NOT NULL,\n                  `stats` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `type_object_id` (`type`,`object_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question_option_answer` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `question_id` int(11) NOT NULL,\n        \t   `option_id` int(11) NOT NULL,\n        \t   `ctime` int(11) NOT NULL,\n        \t   `ip` bigint(20) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `question_id` (`question_id`),\n        \t   KEY `ip` (`ip`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_voice_video` (\n                   `id` bigint(20) NOT NULL AUTO_INCREMENT,\n                   `chat_id` bigint(20) NOT NULL,\n                   `user_id` bigint(20) NOT NULL,\n                   `op_status` tinyint(4) NOT NULL,\n                   `vi_status` tinyint(4) NOT NULL,\n                   `voice` tinyint(4) NOT NULL,\n                   `video` tinyint(4) NOT NULL,\n                   `screen_share` tinyint(4) NOT NULL,\n                   `status` tinyint(4) NOT NULL,\n                   `ctime` int(11) NOT NULL,\n                   `token` varchar(200) NOT NULL,\n                   PRIMARY KEY (`id`),\n                   KEY `chat_id` (`chat_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_product` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT, \n        \t       `name` varchar(250) NOT NULL, \n        \t       `disabled` int(11) NOT NULL, \n        \t       `priority` int(11) NOT NULL, \n        \t       `departament_id` int(11) NOT NULL, \n        \t       KEY `departament_id` (`departament_id`), \n        \t       PRIMARY KEY (`id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_browse_offer_invitation` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `siteaccess` varchar(10) NOT NULL,\n\t\t\t\t  `time_on_site` int(11) NOT NULL,\n\t\t\t\t  `content` longtext NOT NULL,\n\t\t\t\t  `callback_content` longtext NOT NULL,\n\t\t\t\t  `lhc_iframe_content` tinyint(4) NOT NULL,\n\t\t\t\t  `custom_iframe_url` varchar(250) NOT NULL,\n\t\t\t\t  `name` varchar(250) NOT NULL,\n\t\t\t\t  `identifier` varchar(50) NOT NULL,\n\t\t\t\t  `executed_times` int(11) NOT NULL,\n\t\t\t\t  `url` varchar(250) NOT NULL,\n\t\t\t\t  `active` int(11) NOT NULL,\n\t\t\t\t  `has_url` int(11) NOT NULL,\n\t\t\t\t  `is_wildcard` int(11) NOT NULL,\n\t\t\t\t  `referrer` varchar(250) NOT NULL,\n\t\t\t\t  `priority` varchar(250) NOT NULL,\n\t\t\t\t  `hash` varchar(40) NOT NULL,\n\t\t\t\t  `width` int(11) NOT NULL,\n\t\t\t\t  `height` int(11) NOT NULL,\n\t\t\t\t  `unit` varchar(10) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `active` (`active`),\n\t\t\t\t  KEY `identifier` (`identifier`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_form` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `name` varchar(100) NOT NULL,        \t   \n        \t   `content` longtext NOT NULL,\n        \t   `recipient` varchar(250) NOT NULL,\n        \t   `active` int(11) NOT NULL,\n        \t   `name_attr` varchar(250) NOT NULL,\n        \t   `intro_attr` varchar(250) NOT NULL,\n        \t   `xls_columns` text NOT NULL,\n        \t   `pagelayout` varchar(200) NOT NULL,\n        \t   `post_content` text NOT NULL,\n        \t   PRIMARY KEY (`id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_form_collected` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `form_id` int(11) NOT NULL,\n\t\t\t\t  `ctime` int(11) NOT NULL,\n\t\t\t\t  `ip` varchar(250) NOT NULL,\n        \t   \t  `identifier` varchar(250) NOT NULL,\n        \t   \t  `chat_id` bigint(20) NOT NULL,\n\t\t\t\t  `content` longtext NOT NULL,\n\t\t\t\t  `custom_fields` longtext NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `form_id` (`form_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chatbox` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `identifier` varchar(50) NOT NULL,\n\t\t\t\t  `name` varchar(100) NOT NULL,\n\t\t\t\t  `chat_id` int(11) NOT NULL,\n\t\t\t\t  `active` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `identifier` (`identifier`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_canned_msg` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `msg` longtext NOT NULL,\n                  `fallback_msg` text NOT NULL,\n                  `title` varchar(250) NOT NULL,\n                  `explain` varchar(250) NOT NULL,\n                  `languages` text NOT NULL,\n                  `additional_data` text NOT NULL,\n        \t   \t  `position` int(11) NOT NULL,\n        \t   \t  `department_id` int(11) NOT NULL,\n        \t   \t  `user_id` int(11) NOT NULL,\n  \t\t\t\t  `delay` int(11) NOT NULL,\n        \t   \t  `auto_send` tinyint(1) NOT NULL,\n        \t   \t  `html_snippet` longtext NOT NULL,\n        \t   \t  `attr_int_1` int(11) NOT NULL,\n        \t   \t  `attr_int_2` int(11) NOT NULL,\n        \t   \t  `attr_int_3` int(11) NOT NULL,\n        \t   \t  `disabled` tinyint(1) unsigned NOT NULL NULL DEFAULT 0,\n        \t   \t  `unique_id` varchar(20) NOT NULL,\n                  `updated_at` int(11) unsigned NOT NULL DEFAULT 0,\n                  `created_at` int(11) unsigned NOT NULL DEFAULT 0,\n                  `active_from` int(11) unsigned NOT NULL DEFAULT 0,\n                  `active_to` int(11) unsigned NOT NULL DEFAULT 0,\n                  `repetitiveness` int(11) unsigned NOT NULL DEFAULT 0,\n                  `days_activity` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                  PRIMARY KEY (`id`),\n        \t   \t  KEY `department_id` (`department_id`),\n        \t   \t  KEY `disabled` (`disabled`),\n        \t   \t  KEY `attr_int_1` (`attr_int_1`),\n        \t   \t  KEY `attr_int_2` (`attr_int_2`),\n        \t   \t  KEY `attr_int_3` (`attr_int_3`),\n        \t   \t  KEY `position_title_v2` (`position`, `title`(191)),\n        \t   \t  KEY `user_id` (`user_id`),\n        \t   \t  KEY `unique_id` (`unique_id`),\n                  KEY `repetitiveness` (`repetitiveness`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_online_user_footprint` (\n\t\t\t\t  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `chat_id` bigint(20) NOT NULL,\n\t\t\t\t  `online_user_id` int(11) NOT NULL,\n\t\t\t\t  `page` varchar(2083) NOT NULL,\n\t\t\t\t  `vtime` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `chat_id` (`chat_id`),\n\t\t\t\t  KEY `online_user_id` (`online_user_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                $db->query(\"CREATE TABLE `lh_canned_msg_dep` (\n                                 `id` bigint(20) NOT NULL AUTO_INCREMENT,\n                                 `canned_id` int(11) NOT NULL,\n                                 `dep_id` int(11) NOT NULL,\n                                 PRIMARY KEY (`id`),\n                                 KEY `canned_id` (`canned_id`),\n                                 KEY `dep_id` (`dep_id`)\n                            ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_invitation_dep` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n    `invitation_id` int(11) NOT NULL,\n    `dep_id` int(11) NOT NULL,\n    PRIMARY KEY (`id`),\n    KEY `invitation_id` (`invitation_id`),\n    KEY `dep_id` (`dep_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                 $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_event` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `vid_id` int(11) NOT NULL,\n        \t       `ev_id` int(11) NOT NULL,\n        \t       `ts` int(11) NOT NULL,\n        \t       `val` varchar(50) NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `vid_id_ev_id_val_ts` (`vid_id`,`ev_id`,`val`,`ts`),\n        \t       KEY `vid_id_ev_id_ts` (`vid_id`,`ev_id`,`ts`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_invitation_event` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `invitation_id` int(11) NOT NULL,\n        \t       `event_id` int(11) NOT NULL,\n        \t       `min_number` int(11) NOT NULL,\n        \t       `during_seconds` int(11) NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `invitation_id` (`invitation_id`),\n        \t       KEY `event_id` (`event_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_variables` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `name` varchar(50) NOT NULL,\n        \t       `identifier` varchar(50) NOT NULL,\n        \t       `store_timeout` int(11) NOT NULL,\n        \t       `filter_val` int(11) NOT NULL DEFAULT '0',\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `identifier` (`identifier`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_campaign` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL, `text` text NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_campaign_conv` (\n                  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `device_type` tinyint(11) NOT NULL,\n\t\t\t\t  `invitation_type` tinyint(1) NOT NULL,\n\t\t\t\t  `invitation_status` tinyint(1) NOT NULL,\n\t\t\t\t  `chat_id` bigint(20) NOT NULL,\n\t\t\t\t  `campaign_id` int(11) NOT NULL,\n\t\t\t\t  `invitation_id` int(11) NOT NULL,\n\t\t\t\t  `department_id` int(11) NOT NULL,\n\t\t\t\t  `ctime` int(11) NOT NULL,\n\t\t\t\t  `con_time` int(11) NOT NULL,\n\t\t\t\t  `vid_id` bigint(20) DEFAULT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `ctime` (`ctime`),\n\t\t\t\t  KEY `campaign_id` (`campaign_id`),\n\t\t\t\t  KEY `invitation_id` (`invitation_id`),\n\t\t\t\t  KEY `invitation_status` (`invitation_status`)\n\t\t\t\t) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users_setting` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `user_id` int(11) NOT NULL,\n        \t   `identifier` varchar(50) NOT NULL,\n        \t   `value` text NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `user_id` (`user_id`,`identifier`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_departament_limit_group_member` (  \n    \t       `id` int(11) NOT NULL AUTO_INCREMENT,  \n    \t       `dep_id` int(11) NOT NULL,  \n    \t       `dep_limit_group_id` int(11) NOT NULL,  \n    \t       PRIMARY KEY (`id`),  \n    \t       KEY `dep_limit_group_id` (`dep_limit_group_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_departament_limit_group` (  \n    \t       `id` int(11) NOT NULL AUTO_INCREMENT,  \n    \t       `name` varchar(50) NOT NULL,\n    \t       `pending_max` int(11) NOT NULL,  \n    \t       PRIMARY KEY (`id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_auto_responder_chat` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `chat_id` int(11) NOT NULL,\n                  `auto_responder_id` int(11) NOT NULL,\n                  `wait_timeout_send` int(11) NOT NULL,\n                  `pending_send_status` int(11) NOT NULL,\n                  `active_send_status` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `chat_id` (`chat_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users_setting_option` (\n\t\t\t\t  `identifier` varchar(50) NOT NULL,\n\t\t\t\t  `class` varchar(50) NOT NULL,\n\t\t\t\t  `attribute` varchar(40) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`identifier`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"INSERT INTO `lh_users_setting_option` (`identifier`, `class`, `attribute`) VALUES\n        \t   ('chat_message',\t'',\t''),\n        \t   ('new_chat_sound',\t'',\t''),\n        \t   ('enable_pending_list', '', ''),\n        \t   ('enable_active_list', '', ''),\n        \t   ('enable_close_list', '', ''),\n        \t   ('new_user_bn', '', ''),\n        \t   ('new_user_sound', '', ''),\n        \t   ('oupdate_timeout', '', ''),\n        \t   ('ouser_timeout', '', ''),\n        \t   ('o_department', '', ''),\n        \t   ('omax_rows', '', ''),\n        \t   ('ogroup_by', '', ''),\n        \t   ('omap_depid', '', ''),\n        \t   ('omap_mtimeout', '', ''),\n        \t   ('ocountry', '', ''),\n        \t   ('otime_on_site', '', ''),\n        \t   ('dwo', '', ''),\n        \t   ('enable_unread_list', '', '')\");\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_config` (\n                  `identifier` varchar(50) NOT NULL,\n                  `value` text NOT NULL,\n                  `type` tinyint(1) NOT NULL DEFAULT '0',\n                  `explain` varchar(250) NOT NULL,\n                  `hidden` int(11) NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`identifier`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $randomHash = erLhcoreClassModelForgotPassword::randomPassword(9);\n                    $randomHashLength = strlen($randomHash);\n                    $exportHash = erLhcoreClassModelForgotPassword::randomPassword(9);\n\n                    if (extension_loaded('bcmath')){\n                        $geoRow = \"('geo_data','a:5:{i:0;b:0;s:21:\\\"geo_detection_enabled\\\";i:1;s:22:\\\"geo_service_identifier\\\";s:8:\\\"max_mind\\\";s:23:\\\"max_mind_detection_type\\\";s:7:\\\"country\\\";s:22:\\\"max_mind_city_location\\\";s:37:\\\"var/external/geoip/GeoLite2-City.mmdb\\\";}',0,'',1)\";\n                    } else {\n                        $geoRow = \"('geo_data', '', '0', '', '1')\";\n                    }\n\n                    $db->query(\"INSERT INTO `lh_chat_config` (`identifier`, `value`, `type`, `explain`, `hidden`) VALUES\n                ('tracked_users_cleanup',\t'160',\t0,\t'How many days keep records of online users.',\t0),\n        \t   \t('list_online_operators', '1', '0', 'List online operators.', '0'),\n        \t   \t('voting_days_limit',\t'7',\t0,\t'How many days voting widget should not be expanded after last show',\t0),\n                ('track_online_visitors',\t'1',\t0,\t'Enable online site visitors tracking',\t0),\n        \t   \t('pro_active_invite',\t'1',\t0,\t'Is pro active chat invitation active. Online users tracking also has to be enabled',\t0),\n                ('customer_company_name',\t'Live Helper Chat',\t0,\t'Your company name - visible in bottom left corner',\t0),\n                ('customer_site_url',\t'http://livehelperchat.com',\t0,\t'Your site URL address',\t0),\n                ('transfer_configuration','0','0','Transfer configuration','1'),\n                ('list_unread','0','0','List unread chats','0'),\n                ('list_closed','0','0','List closed chats','0'),\n                ('vwait_to_long','120','0','How long we should wait before we inform operator about unanswered chat.','0'),\n                ('autoclose_activity_timeout','0','0','Automatically close active chat if from last visitor/operator message passed. 0 - disabled, n > 0 time in minutes','0'),\n                ('mobile_options',\t'a:2:{s:13:\\\"notifications\\\";i:0;s:7:\\\"fcm_key\\\";s:152:\\\"AAAAiF8DeNk:APA91bFVHu2ybhBUTtlEtQrUEPpM2fb-5ovgo0FVNm4XxK3cYJtSwRcd-pqcBot_422yDOzHyw2p9ZFplkHrmNXjm8f5f-OIzfalGmpsypeXvnPxhU6Db1B2Z1Acc-TamHUn2F4xBJkP\\\";}',\t0,\t'',\t1),\n                ('footprint_background','0','0','Footprint updates should be processed in the background. Make sure you are running workflow background cronjob.','0'),\n                ('reverse_pending','0','0','Make default pending chats order from old to new','0'),\n                ('departament_availability','364','0','How long department availability statistic should be kept? (days)','0'),\n                ('uonline_sessions','364','0','How long keep operators online sessions data? (days)','0'),\n                ('disable_live_autoassign','0','0','Disable live auto assign','0'),\n                ('tracked_footprint_cleanup','90','0','How many days keep records of users footprint.','0'),\n                ('cleanup_cronjob','0','0','Cleanup should be done only using cronjob.','0'),         \n                ('no_wildcard_cookie','0','0','Cookie should be valid only for domain where Javascript is embedded (excludes subdomains)','0'),\n                ('cduration_timeout_user','4','0','How long operator can wait for message from visitor before time between messages are ignored. Values in minutes.','0'),\n                ('cduration_timeout_operator','10','0','How long visitor can wait for message from operator before time between messages are ignored. Values in minutes.','0'),       \n                ('assign_workflow_timeout','0','0','Chats waiting in pending line more than n seconds should be auto assigned first. Time in seconds','0'),\n        \t   \t('smtp_data',\t'a:5:{s:4:\\\"host\\\";s:0:\\\"\\\";s:4:\\\"port\\\";s:2:\\\"25\\\";s:8:\\\"use_smtp\\\";i:0;s:8:\\\"username\\\";s:0:\\\"\\\";s:8:\\\"password\\\";s:0:\\\"\\\";}',\t0,\t'SMTP configuration',\t1),\n        \t    ('chatbox_data',\t'a:6:{i:0;b:0;s:20:\\\"chatbox_auto_enabled\\\";i:0;s:19:\\\"chatbox_secret_hash\\\";s:{$randomHashLength}:\\\"{$randomHash}\\\";s:20:\\\"chatbox_default_name\\\";s:7:\\\"Chatbox\\\";s:17:\\\"chatbox_msg_limit\\\";i:50;s:22:\\\"chatbox_default_opname\\\";s:7:\\\"Manager\\\";}',\t0,\t'Chatbox configuration',\t1),\n                ('start_chat_data',\t'a:80:{i:0;b:0;s:21:\\\"name_visible_in_popup\\\";b:0;s:27:\\\"name_visible_in_page_widget\\\";b:0;s:19:\\\"name_require_option\\\";s:8:\\\"required\\\";s:22:\\\"email_visible_in_popup\\\";b:0;s:28:\\\"email_visible_in_page_widget\\\";b:0;s:20:\\\"email_require_option\\\";s:8:\\\"required\\\";s:24:\\\"message_visible_in_popup\\\";b:1;s:30:\\\"message_visible_in_page_widget\\\";b:1;s:22:\\\"message_require_option\\\";s:8:\\\"required\\\";s:22:\\\"phone_visible_in_popup\\\";b:0;s:28:\\\"phone_visible_in_page_widget\\\";b:0;s:20:\\\"phone_require_option\\\";s:8:\\\"required\\\";s:21:\\\"force_leave_a_message\\\";b:0;s:29:\\\"offline_name_visible_in_popup\\\";b:1;s:35:\\\"offline_name_visible_in_page_widget\\\";b:1;s:27:\\\"offline_name_require_option\\\";s:8:\\\"required\\\";s:30:\\\"offline_phone_visible_in_popup\\\";b:0;s:36:\\\"offline_phone_visible_in_page_widget\\\";b:0;s:28:\\\"offline_phone_require_option\\\";s:8:\\\"required\\\";s:32:\\\"offline_message_visible_in_popup\\\";b:1;s:38:\\\"offline_message_visible_in_page_widget\\\";b:1;s:30:\\\"offline_message_require_option\\\";s:8:\\\"required\\\";s:15:\\\"auto_start_chat\\\";b:0;s:12:\\\"mobile_popup\\\";b:0;s:17:\\\"dont_auto_process\\\";b:0;s:20:\\\"tos_visible_in_popup\\\";b:0;s:12:\\\"requires_dep\\\";b:0;s:17:\\\"requires_dep_lock\\\";b:0;s:17:\\\"show_messages_box\\\";b:1;s:26:\\\"tos_visible_in_page_widget\\\";b:0;s:19:\\\"tos_checked_offline\\\";b:0;s:18:\\\"tos_checked_online\\\";b:0;s:28:\\\"offline_tos_visible_in_popup\\\";b:0;s:34:\\\"offline_tos_visible_in_page_widget\\\";b:0;s:35:\\\"offline_file_visible_in_page_widget\\\";b:0;s:29:\\\"offline_file_visible_in_popup\\\";b:0;s:11:\\\"name_hidden\\\";b:0;s:15:\\\"name_hidden_bot\\\";b:0;s:24:\\\"custom_fields_encryption\\\";s:0:\\\"\\\";s:19:\\\"offline_name_hidden\\\";b:0;s:13:\\\"pre_chat_html\\\";s:0:\\\"\\\";s:21:\\\"pre_offline_chat_html\\\";s:0:\\\"\\\";s:12:\\\"email_hidden\\\";b:0;s:16:\\\"email_hidden_bot\\\";b:0;s:20:\\\"offline_email_hidden\\\";b:0;s:15:\\\"user_msg_height\\\";s:0:\\\"\\\";s:12:\\\"phone_hidden\\\";b:0;s:16:\\\"phone_hidden_bot\\\";b:0;s:20:\\\"offline_phone_hidden\\\";b:0;s:14:\\\"message_hidden\\\";b:0;s:18:\\\"message_hidden_bot\\\";b:0;s:18:\\\"message_auto_start\\\";b:0;s:28:\\\"message_auto_start_key_press\\\";b:0;s:22:\\\"offline_message_hidden\\\";b:0;s:21:\\\"show_operator_profile\\\";b:1;s:21:\\\"remove_operator_space\\\";b:0;s:18:\\\"hide_message_label\\\";b:0;s:17:\\\"custom_fields_url\\\";s:0:\\\"\\\";s:13:\\\"custom_fields\\\";s:0:\\\"\\\";s:21:\\\"name_hidden_prefilled\\\";b:0;s:22:\\\"email_hidden_prefilled\\\";b:0;s:24:\\\"message_hidden_prefilled\\\";b:0;s:22:\\\"phone_hidden_prefilled\\\";b:0;s:29:\\\"offline_name_hidden_prefilled\\\";b:0;s:32:\\\"offline_message_hidden_prefilled\\\";b:0;s:30:\\\"offline_phone_hidden_prefilled\\\";b:0;s:18:\\\"disable_start_chat\\\";b:0;s:18:\\\"offline_name_width\\\";i:0;s:19:\\\"offline_email_width\\\";i:0;s:19:\\\"offline_phone_width\\\";i:0;s:10:\\\"name_width\\\";i:0;s:11:\\\"email_width\\\";i:0;s:11:\\\"phone_width\\\";i:0;s:17:\\\"hide_start_button\\\";b:0;s:9:\\\"lazy_load\\\";b:0;s:28:\\\"offline_email_require_option\\\";s:8:\\\"required\\\";s:30:\\\"offline_email_hidden_prefilled\\\";b:0;s:36:\\\"offline_email_visible_in_page_widget\\\";b:1;s:30:\\\"offline_email_visible_in_popup\\\";b:1;}',\t0,\t'',\t1),\n                ('application_name',\t'a:6:{s:3:\\\"eng\\\";s:31:\\\"Live Helper Chat - live support\\\";s:3:\\\"lit\\\";s:26:\\\"Live Helper Chat - pagalba\\\";s:3:\\\"hrv\\\";s:0:\\\"\\\";s:3:\\\"esp\\\";s:0:\\\"\\\";s:3:\\\"por\\\";s:0:\\\"\\\";s:10:\\\"site_admin\\\";s:31:\\\"Live Helper Chat - live support\\\";}',\t1,\t'Support application name, visible in browser title.',\t0),\n                ('track_footprint',\t'0',\t0,\t'Track users footprint. For this also online visitors tracking should be enabled',\t0),\n                ('pro_active_limitation',\t'-1',\t0,\t'Pro active chats invitations limitation based on pending chats, (-1) do not limit, (0,1,n+1) number of pending chats can be for invitation to be shown.',\t0),\n                ('pro_active_show_if_offline',\t'0',\t0,\t'Should invitation logic be executed if there is no online operators',\t0),\n                ('export_hash',\t'{$exportHash}',\t0,\t'Chats export secret hash',\t0),\n                ('do_no_track_ip', 0, 0, 'Do not track visitors IP',0),\n                ('remember_username','1','0','Should we remember username for the next time visitor starts a chat?','0'),\n                ('ignore_typing', 0, 0, 'Do not store what visitor is typing',0),\n                ('encrypt_msg_after', 0, 0, 'After how many days anonymize messages',0),\n                ('encrypt_msg_op', 0, 0, 'Anonymize also operators messages',0),\n                ('valid_domains','','0','Domains where script can be embedded. E.g example.com, google.com','0'),\n                ('message_seen_timeout', 24, 0, 'Proactive message timeout in hours. After how many hours proactive chat mesasge should be shown again.',\t0),\n                ('reopen_chat_enabled',0,\t0,\t'Reopen chat functionality enabled',\t0),\n                ('ignorable_ip',\t'',\t0,\t'Which ip should be ignored in online users list, separate by comma',0),\n                ('run_departments_workflow', 0, 0, 'Should cronjob run departments transfer workflow, even if user leaves a chat',\t0),\n                ('geo_location_data', 'a:3:{s:4:\\\"zoom\\\";i:4;s:3:\\\"lat\\\";s:7:\\\"49.8211\\\";s:3:\\\"lng\\\";s:7:\\\"11.7835\\\";}', '0', '', '1'),\n                ('xmp_data','a:14:{i:0;b:0;s:4:\\\"host\\\";s:15:\\\"talk.google.com\\\";s:6:\\\"server\\\";s:9:\\\"gmail.com\\\";s:8:\\\"resource\\\";s:6:\\\"xmpphp\\\";s:4:\\\"port\\\";s:4:\\\"5222\\\";s:7:\\\"use_xmp\\\";i:0;s:8:\\\"username\\\";s:0:\\\"\\\";s:8:\\\"password\\\";s:0:\\\"\\\";s:11:\\\"xmp_message\\\";s:98:\\\"New chat request [{chat_id}] from [{department}]\\r\\n{messages}\\r\\nClick to accept a chat\\r\\n{url_accept}\\\";s:10:\\\"recipients\\\";s:0:\\\"\\\";s:20:\\\"xmp_accepted_message\\\";s:89:\\\"{user_name} has accepted a chat [{chat_id}] from [{department}]\\r\\n{messages}\\r\\n{url_accept}\\\";s:16:\\\"use_standard_xmp\\\";i:0;s:15:\\\"test_recipients\\\";s:0:\\\"\\\";s:21:\\\"test_group_recipients\\\";s:0:\\\"\\\";}',0,'XMP data',1),\n                ('run_unaswered_chat_workflow', 0, 0, 'Should cronjob run unanswered chats workflow and execute unaswered chats callback, 0 - no, any other number bigger than 0 is a minits how long chat have to be not accepted before executing callback.',0),\n                ('disable_popup_restore', 0, 0, 'Disable option in widget to open new window. Restore icon will be hidden',\t0),\n                ('accept_tos_link', '#', 0, 'Change to your site Terms of Service', 0),\n                ('hide_button_dropdown', '0', 0, 'Hide close button in dropdown', 0),\n                ('on_close_exit_chat', '0', 0, 'On chat close exit chat', 0),\n                ('activity_timeout', '5', 0, 'How long operator should go offline automatically because of inactivity. Value in minutes', 0),\n                ('product_enabled_module','0','0','Product module is enabled', '1'),\n                ('preload_iframes','0','0','Preload widget. It will avoid loading delay after clicking widget','0'),\n                ('product_show_departament','0','0','Enable products show by departments', '1'),\n                ('paidchat_data','','0','Paid chat configuration','1'),\n                ('mheight_op','200','0','Messages box height for operator','0'),\n                ('listd_op','10','0','Default number of online operators to show','0'),\n                ('disable_iframe_sharing',\t'1',\t0,\t'Disable iframes in sharing mode',\t0),\n                ('file_configuration',\t'a:7:{i:0;b:0;s:5:\\\"ft_op\\\";s:47:\\\"gif|jpe?g|png|zip|svg|rar|xls|doc|docx|xlsx|pdf\\\";s:5:\\\"ft_us\\\";s:30:\\\"gif|jpe?g|png|svg|doc|docx|pdf\\\";s:6:\\\"fs_max\\\";i:2048;s:18:\\\"active_user_upload\\\";b:0;s:16:\\\"active_op_upload\\\";b:1;s:19:\\\"active_admin_upload\\\";b:1;}',\t0,\t'Files configuration item',\t1),\n                ('accept_chat_link_timeout',\t'300',\t0,\t'How many seconds chat accept link is valid. Set 0 to force login all the time manually.',\t0),\n                ('open_closed_chat_timeout',\t'1800',\t0,\t'How many seconds customer has to open already closed chat.',\t0),\n                ('session_captcha',0,\t0,\t'Use session captcha. LHC have to be installed on the same domain or subdomain.',\t0),\n                ('sync_sound_settings',\t'a:16:{i:0;b:0;s:12:\\\"repeat_sound\\\";i:1;s:18:\\\"repeat_sound_delay\\\";i:5;s:10:\\\"show_alert\\\";b:0;s:22:\\\"new_chat_sound_enabled\\\";b:1;s:31:\\\"new_message_sound_admin_enabled\\\";b:1;s:30:\\\"new_message_sound_user_enabled\\\";b:1;s:14:\\\"online_timeout\\\";d:300;s:22:\\\"check_for_operator_msg\\\";d:10;s:21:\\\"back_office_sinterval\\\";d:10;s:22:\\\"chat_message_sinterval\\\";d:3.5;s:20:\\\"long_polling_enabled\\\";b:0;s:30:\\\"polling_chat_message_sinterval\\\";d:1.5;s:29:\\\"polling_back_office_sinterval\\\";d:5;s:18:\\\"connection_timeout\\\";i:30;s:28:\\\"browser_notification_message\\\";b:0;}',\t0,\t'',\t1),\n                ('sound_invitation', 1, 0, 'Play sound on invitation to chat.',\t0),\n                ('explicit_http_mode', '',0,'Please enter explicit http mode. Either http: or https:, do not forget : at the end.', '0'),\n                ('track_domain',\t'',\t0,\t'Set your domain to enable user tracking across different domain subdomains.',\t0),\n                ('max_message_length','500',0,'Maximum message length in characters', '0'),\n                ('need_help_tip','1',0,'Show need help tooltip?', '0'),\n                ('recaptcha_data','a:4:{i:0;b:0;s:8:\\\"site_key\\\";s:0:\\\"\\\";s:10:\\\"secret_key\\\";s:0:\\\"\\\";s:7:\\\"enabled\\\";i:0;}','0','Re-captcha configuration','1'),\n                ('need_help_tip_timeout','24',0,'Need help tooltip timeout, after how many hours show again tooltip?', '0'),\n                ('use_secure_cookie','0',0,'Use secure cookie, check this if you want to force SSL all the time', '0'),\n                ('faq_email_required','0',0,'Is visitor e-mail required for FAQ', '0'),\n                ('disable_print','0',0,'Disable chat print', '0'),\n                ('hide_disabled_department','1',0,'Hide disabled department widget', '0'),\n                ('disable_send','0',0,'Disable chat transcript send', '0'),\n                ('autoclose_abandon_pending','0,0','0','Automatically close pending chats where visitor has left a chat. Timeout in minutes, last activity by visitor <desktop timeout>,<mobile timeout>,<status chat>','0'),\n                ('ignore_user_status','0',0,'Ignore users online statuses and use departments online hours', '0'),\n                ('bbc_button_visible','1',0,'Show BB Code button', '0'),\n                ('password_data','','0','Password requirements','1'),\n                ('activity_track_all','0','0','Track all logged operators activity and ignore their individual settings.','0'),\n                ('allow_reopen_closed','0', 0, 'Allow user to reopen closed chats?', '0'),\n                ('reopen_as_new','1', 0, 'Reopen closed chat as new? Otherwise it will be reopened as active.', '0'),\n                ('default_theme_id','0', 0, 'Default theme ID.', '1'),  \n                ('default_admin_theme_id','0', 0, 'Default admin theme ID', '1'),  \n                ('translation_data',\t'a:6:{i:0;b:0;s:19:\\\"translation_handler\\\";s:4:\\\"bing\\\";s:19:\\\"enable_translations\\\";b:0;s:14:\\\"bing_client_id\\\";s:0:\\\"\\\";s:18:\\\"bing_client_secret\\\";s:0:\\\"\\\";s:14:\\\"google_api_key\\\";s:0:\\\"\\\";}',\t0,\t'Translation data',\t1),              \n                ('disable_html5_storage','1',0,'Disable HMTL5 storage, check it if your site is switching between http and https', '0'),\n                ('automatically_reopen_chat','1',0,'Automatically reopen chat on widget open', '0'),\n                ('autoclose_timeout','0', 0, 'Automatic chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autoclose_timeout_pending','0', 0, 'Automatic pending chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autoclose_timeout_active','0', 0, 'Automatic active chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autoclose_timeout_bot','0', 0, 'Automatic bot chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autopurge_timeout','0', 0, 'Automatic chats purging. 0 - disabled, n > 0 time in minutes before chat is automatically deleted', '0'),\n                ('update_ip',\t'127.0.0.1',\t0,\t'Which ip should be allowed to update DB by executing http request, separate by comma?',0),\n                ('track_if_offline',\t'0',\t0,\t'Track online visitors even if there is no online operators',0),\n                ('min_phone_length','8',0,'Minimum phone number length',0),\n                ('mheight','',0,'Messages box height',0),\n                ('inform_unread_message','0',0,'Inform visitor about unread messages from operator, value in minutes. 0 - disabled',0),\n                ('dashboard_order', '[[\\\"online_operators\\\",\\\"departments_stats\\\",\\\"online_visitors\\\"],[\\\"group_chats\\\",\\\"my_chats\\\",\\\"pending_chats\\\",\\\"transfered_chats\\\"],[\\\"active_chats\\\",\\\"bot_chats\\\"]]', '0', 'Home page dashboard widgets order', '0'),\n                ('banned_ip_range','',0,'Which ip should not be allowed to chat',0),\n                ('suggest_leave_msg','1',0,'Suggest user to leave a message then user chooses offline department',0),\n                ('checkstatus_timeout','0',0,'Interval between chat status checks in seconds, 0 disabled.',0),\n                ('show_language_switcher','0',0,'Show users option to switch language at widget',0),\n                ('sharing_auto_allow','0',0,'Do not ask permission for users to see their screen',0),\n                ('sharing_nodejs_enabled','0',0,'NodeJs support enabled',0),\n                ('sharing_nodejs_path','',0,'socket.io path, optional',0),\n                ('online_if','0','0','','0'),\n                ('track_mouse_activity','0','0','Should mouse movement be tracked as activity measure, if not checked only basic events would be tracked','0'),\n                ('track_activity','0','0','Track users activity on site?','0'),\n                ('autologin_data','a:3:{i:0;b:0;s:11:\\\"secret_hash\\\";s:16:\\\"please_change_me\\\";s:7:\\\"enabled\\\";i:0;}',0,'Autologin configuration data',\t1),\n                ('sharing_nodejs_secure','0',0,'Connect to NodeJs in https mode',0),\n                ('disable_js_execution','1',0,'Disable JS execution in Co-Browsing operator window',0),\n                ('sharing_nodejs_socket_host','',0,'Host where NodeJs is running',0),\n                ('hide_right_column_frontpage','1','0','Hide right column in frontpage','0'),\n                ('front_tabs', 'dashboard,online_users,online_map', '0', 'Home page tabs order', '0'),\n                ('speech_data',\t'a:3:{i:0;b:0;s:8:\\\"language\\\";i:7;s:7:\\\"dialect\\\";s:5:\\\"en-US\\\";}',\t1,\t'',\t1),\n                ('sharing_nodejs_sllocation','https://cdn.jsdelivr.net/npm/socket.io-client@2/dist/socket.io.js',0,'Location of SocketIO JS library',0),\n                ('track_is_online','0',0,'Track is user still on site, chat status checks also has to be enabled',0),\n\t\t\t\t('show_languages','eng,lit,hrv,esp,por,nld,ara,ger,pol,rus,ita,fre,chn,cse,nor,tur,vnm,idn,sve,per,ell,dnk,rou,bgr,tha,geo,fin,alb',0,'Between what languages user should be able to switch',0),\n                ('geoadjustment_data',\t'a:8:{i:0;b:0;s:18:\\\"use_geo_adjustment\\\";b:0;s:13:\\\"available_for\\\";s:0:\\\"\\\";s:15:\\\"other_countries\\\";s:6:\\\"custom\\\";s:8:\\\"hide_for\\\";s:0:\\\"\\\";s:12:\\\"other_status\\\";s:7:\\\"offline\\\";s:11:\\\"rest_status\\\";s:6:\\\"hidden\\\";s:12:\\\"apply_widget\\\";i:0;}',\t0,\t'Geo adjustment settings',\t1),\n                {$geoRow}\");\n\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_online_user` (\n                  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `vid` varchar(50) NOT NULL,\n                  `ip` varchar(50) NOT NULL,\n                  `current_page` text NOT NULL,\n        \t   \t  `page_title` varchar(250) NOT NULL,\n                  `referrer` text NOT NULL,\n                  `chat_id` bigint(20) NOT NULL,\n                  `invitation_seen_count` int(11) NOT NULL,\n        \t   \t  `invitation_id` int(11) NOT NULL,\n                  `last_visit` int(11) NOT NULL,\n        \t   \t  `first_visit` int(11) NOT NULL,\n        \t   \t  `total_visits` int(11) NOT NULL,\n        \t   \t  `pages_count` int(11) NOT NULL,\n        \t   \t  `tt_pages_count` int(11) NOT NULL,\n        \t   \t  `invitation_count` int(11) NOT NULL,\n        \t   \t  `last_check_time` int(11) NOT NULL,\n        \t   \t  `dep_id` int(11) NOT NULL,        \t   \t \n                  `user_agent` text NOT NULL,\n                  `notes` varchar(250) NOT NULL,\n                  `user_country_code` varchar(50) NOT NULL,\n                  `user_country_name` varchar(50) NOT NULL,\n                  `visitor_tz` varchar(50) NOT NULL,\n                  `operator_message` text NOT NULL,\n                  `operator_user_proactive` varchar(100) NOT NULL,\n                  `operator_user_id` int(11) NOT NULL,\n                  `conversion_id` int(11) NOT NULL,\n                  `message_seen` int(11) NOT NULL,\n                  `message_seen_ts` int(11) NOT NULL,\n                  `user_active` int(11) NOT NULL,\n        \t   \t  `lat` varchar(10) NOT NULL,\n  \t\t\t\t  `lon` varchar(10) NOT NULL,\n  \t\t\t\t  `city` varchar(100) NOT NULL,\n        \t   \t  `reopen_chat` int(11) NOT NULL,\n        \t   \t  `time_on_site` int(11) NOT NULL,\n  \t\t\t\t  `tt_time_on_site` int(11) NOT NULL,\n        \t   \t  `requires_email` int(11) NOT NULL,\n        \t   \t  `requires_username` int(11) NOT NULL,\n        \t   \t  `requires_phone` int(11) NOT NULL,\n        \t   \t  `screenshot_id` int(11) NOT NULL,\n        \t   \t  `identifier` varchar(50) NOT NULL,\n        \t   \t  `operation` text NOT NULL,\n        \t   \t  `online_attr_system` text NOT NULL,\n        \t   \t  `operation_chat` text NOT NULL,\n        \t   \t  `online_attr` text NOT NULL,\n        \t   \t  `device_type` tinyint(1) NOT NULL DEFAULT '0',\n                  `chat_time` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  `last_visit_prev` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  PRIMARY KEY (`id`),\n                  KEY `vid` (`vid`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `last_visit_dep_id` (`last_visit`,`dep_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_proactive_chat_invitation` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `siteaccess` varchar(10) NOT NULL,\n\t\t\t\t  `time_on_site` int(11) NOT NULL,\n\t\t\t\t  `pageviews` int(11) NOT NULL,\n\t\t\t\t  `message` text NOT NULL,\n\t\t\t\t  `message_returning` text NOT NULL,\n\t\t\t\t  `executed_times` int(11) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `hide_after_ntimes` int(11) NOT NULL,\n\t\t\t\t  `show_on_mobile` int(11) NOT NULL,\n\t\t\t\t  `delay` int(11) NOT NULL,\n\t\t\t\t  `delay_init` int(11) NOT NULL,\n\t\t\t\t  `show_instant` int(11) NOT NULL,\n\t\t\t\t  `autoresponder_id` int(11) NOT NULL,\n\t\t\t\t  `disabled` int(11) NOT NULL,\n\t\t\t\t  `inject_only_html` tinyint(1) NOT NULL,\n\t\t\t\t  `name` varchar(50) NOT NULL,\n\t\t\t\t  `operator_ids` varchar(100) NOT NULL,\t\t\t\t \n\t\t\t\t  `message_returning_nick` varchar(250) NOT NULL,\n\t\t\t\t  `referrer` varchar(250) NOT NULL,\t\t\t\t  \n\t\t\t\t  `show_random_operator` int(11) NOT NULL,\n\t\t\t\t  `operator_name` varchar(100) NOT NULL,\n\t\t\t\t  `campaign_id` int(11) NOT NULL,\n\t\t\t\t  `position` int(11) NOT NULL,\n\t\t\t\t  `event_invitation` int(11) NOT NULL,\n\t\t\t\t  `dynamic_invitation` int(11) NOT NULL,\n\t\t\t\t  `bot_id` int(11) NOT NULL,\n\t\t\t\t  `trigger_id` int(11) NOT NULL,\n\t\t\t\t  `bot_offline` tinyint(1) NOT NULL,\n        \t   \t  `identifier` varchar(50) NOT NULL,\n        \t   \t  `tag` varchar(50) NOT NULL,\n        \t   \t  `requires_email` int(11) NOT NULL,\n        \t   \t  `iddle_for` int(11) NOT NULL,\n        \t   \t  `event_type` int(11) NOT NULL,\n        \t   \t  `requires_username` int(11) NOT NULL,\n        \t   \t  `requires_phone` int(11) NOT NULL,        \t   \t  \n        \t   \t  `design_data` longtext NOT NULL,        \t   \t  \n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `time_on_site_pageviews_siteaccess_position` (`time_on_site`,`pageviews`,`siteaccess`,`identifier`,`position`),\n        \t      KEY `identifier` (`identifier`),\n        \t      KEY `dynamic_invitation` (`dynamic_invitation`),\n        \t      KEY `tag` (`tag`),\n        \t      KEY `show_on_mobile` (`show_on_mobile`),\n        \t      KEY `dep_id` (`dep_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_accept` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `chat_id` bigint(20) NOT NULL,\n        \t   `hash` varchar(50) NOT NULL,\n        \t   `ctime` int(11) NOT NULL,\n        \t   `wused` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `hash` (`hash`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    //Default departament\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_departament` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `name` varchar(100) NOT NULL,\n\t\t\t\t  `email` varchar(100) NOT NULL,\n\t\t\t\t  `xmpp_recipients` text NOT NULL,\n\t\t\t\t  `xmpp_group_recipients` text NOT NULL,\n\t\t\t\t  `priority` int(11) NOT NULL,\n\t\t\t\t  `sort_priority` int(11) NOT NULL,\n\t\t\t\t  `department_transfer_id` int(11) NOT NULL,\n\t\t\t\t  `transfer_timeout` int(11) NOT NULL,\n\t\t\t\t  `exclude_inactive_chats` int(11) NOT NULL,\n\t\t\t\t  `delay_before_assign` int(11) NOT NULL,\n\t\t\t\t  `max_ac_dep_chats` int(11) NOT NULL,\n\t\t\t\t  `assign_same_language` int(11) NOT NULL,\n\t\t\t\t  `archive` tinyint(1) NOT NULL DEFAULT '0',\n\t\t\t\t  `max_load` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `max_load_h` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `disabled` int(11) NOT NULL,\n\t\t\t\t  `hidden` int(11) NOT NULL,\n\t\t\t\t  `delay_lm` int(11) NOT NULL,\n\t\t\t\t  `max_active_chats` int(11) NOT NULL,\n\t\t\t\t  `max_timeout_seconds` int(11) NOT NULL,\n\t\t\t\t  `identifier` varchar(2083) NOT NULL,\n\t\t\t\t  `mod_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `mod_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `tud_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `tud_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `wed_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `wed_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `thd_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `thd_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `frd_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `frd_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sad_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sad_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sud_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sud_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `nc_cb_execute` tinyint(1) NOT NULL,\n\t\t\t\t  `na_cb_execute` tinyint(1) NOT NULL,\n\t\t\t\t  `inform_unread` tinyint(1) NOT NULL,\n\t\t\t\t  `active_balancing` tinyint(1) NOT NULL,\n\t\t\t\t  `visible_if_online` tinyint(1) NOT NULL,\n\t\t\t\t  `inform_close` int(11) NOT NULL,\n\t\t\t\t  `inform_unread_delay` int(11) NOT NULL,\n\t\t\t\t  `inform_options` varchar(250) NOT NULL,\n\t\t\t\t  `online_hours_active` tinyint(1) NOT NULL,\n\t\t\t\t  `inform_delay` int(11) NOT NULL,\n\t\t\t\t  `attr_int_1` int(11) NOT NULL,\n\t\t\t\t  `attr_int_2` int(11) NOT NULL,\n\t\t\t\t  `attr_int_3` int(11) NOT NULL,\n\t\t\t\t  `pending_max` int(11) NOT NULL,\n\t\t\t\t  `pending_group_max` int(11) NOT NULL,\n\t\t\t\t  `active_chats_counter` int(11) NOT NULL,\n\t\t\t\t  `inactive_chats_cnt` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `pending_chats_counter` int(11) NOT NULL,\n\t\t\t\t  `bot_chats_counter` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `inop_chats_cnt` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `acop_chats_cnt` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `inform_close_all` int(11) NOT NULL,\n\t\t\t\t  `inform_close_all_email` varchar(250) NOT NULL,\n\t\t\t\t  `alias` varchar(50) NOT NULL,\n\t\t\t\t  `product_configuration` longtext NOT NULL,\n\t\t\t\t  `bot_configuration` text NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `identifier_2` (`identifier`(191)),\n\t\t\t\t  KEY `archive` (`archive`),\n\t\t\t\t  KEY `alias` (`alias`),\n\t\t\t\t  KEY `attr_int_1` (`attr_int_1`),\n\t\t\t\t  KEY `attr_int_2` (`attr_int_2`),\n\t\t\t\t  KEY `attr_int_3` (`attr_int_3`),\n\t\t\t\t  KEY `active_chats_counter` (`active_chats_counter`),\n\t\t\t\t  KEY `pending_chats_counter` (`pending_chats_counter`),\n\t\t\t\t  KEY `bot_chats_counter` (`bot_chats_counter`),\n\t\t\t\t  KEY `disabled_hidden` (`disabled`, `hidden`),\n\t\t\t\t  KEY `sort_priority_name` (`sort_priority`, `name`),\n\t\t\t\t  KEY `active_mod` (`online_hours_active`,`mod_start_hour`,`mod_end_hour`),\n\t\t\t\t  KEY `active_tud` (`online_hours_active`,`tud_start_hour`,`tud_end_hour`),\n\t\t\t\t  KEY `active_wed` (`online_hours_active`,`wed_start_hour`,`wed_end_hour`),\n\t\t\t\t  KEY `active_thd` (`online_hours_active`,`thd_start_hour`,`thd_end_hour`),\n\t\t\t\t  KEY `active_frd` (`online_hours_active`,`frd_start_hour`,`frd_end_hour`),\n\t\t\t\t  KEY `active_sad` (`online_hours_active`,`sad_start_hour`,`sad_end_hour`),\n\t\t\t\t  KEY `active_sud` (`online_hours_active`,`sud_start_hour`,`sud_end_hour`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_departament_group_user` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `dep_group_id` int(11) NOT NULL,\n                  `user_id` int(11) NOT NULL,\n                  `read_only` tinyint(1) unsigned NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`id`),\n                  KEY `dep_group_id` (`dep_group_id`),\n                  KEY `user_id` (`user_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_departament_availability` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `dep_id` int(11) NOT NULL, `hour` int(11) NOT NULL, `hourminute` int(4) NOT NULL, `minute` int(11) NOT NULL, `time` int(11) NOT NULL, `ymdhi` bigint(20) NOT NULL, `ymd` int(11) NOT NULL, `status` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `ymdhi` (`ymdhi`), KEY `dep_id` (`dep_id`),  KEY `hourminute` (`hourminute`), KEY `time` (`time`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_product_departament` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `product_id` int(11) NOT NULL,\n        \t       `departament_id` int(11) NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `departament_id` (`departament_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_departament_group_member` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `dep_id` int(11) NOT NULL,\n                  `dep_group_id` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `dep_group_id` (`dep_group_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_generic_bot_rest_api` (`id` bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY, `name` varchar(50) NOT NULL, `description` varchar(250), `configuration` text NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_departament_group` (\n                      `id` int(11) NOT NULL AUTO_INCREMENT,\n                      `name` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `achats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `inachats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `pchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `max_load` int(11) NOT NULL DEFAULT 0,\n                      `max_load_h` int(11) NOT NULL DEFAULT 0,\n                      `bchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `inopchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `acopchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      PRIMARY KEY (`id`)\n                    ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_canned_msg_tag_link` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `tag_id` int(11) NOT NULL,  `canned_id` int(11) NOT NULL,  PRIMARY KEY (`id`), KEY `canned_id` (`canned_id`), KEY `tag_id` (`tag_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_canned_msg_tag` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `tag` varchar(40) NOT NULL, PRIMARY KEY (`id`), KEY `tag` (`tag`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_subject` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `name` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `internal` tinyint(1) NOT NULL DEFAULT 0,\n  `internal_type` varchar(20) NOT NULL DEFAULT '',\n  PRIMARY KEY (`id`),\n  KEY `internal` (`internal`),\n  KEY `internal_type` (`internal_type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_subject_dep` ( `id` int(11) NOT NULL AUTO_INCREMENT, `dep_id` int(11) NOT NULL, `subject_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `subject_id` (`subject_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_abstract_subject_chat` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `subject_id` int(11) NOT NULL, `chat_id` bigint(20) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_group_object` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `object_id` bigint(20) NOT NULL, `group_id` bigint(20) NOT NULL, `type` bigint(20) NOT NULL, PRIMARY KEY (`id`), KEY `object_id_type` (`object_id`,`type`), KEY `group_id` (`group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Bot tables\n                    $db->query(\"CREATE TABLE `lh_generic_bot_bot` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `configuration` longtext NOT NULL, `avatar` varchar(150) NOT NULL, `filename` varchar(250) NOT NULL, `filepath` varchar(250) NOT NULL, `name` varchar(100) NOT NULL, `nick` varchar(100) NOT NULL,`attr_str_1` varchar(100) NOT NULL, `attr_str_2` varchar(100) NOT NULL, `attr_str_3` varchar(100) NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_group` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL,`is_collapsed` int(11) NOT NULL DEFAULT '0', `pos` int(11) NOT NULL DEFAULT '0', `bot_id` bigint(20) NOT NULL, PRIMARY KEY (`id`), KEY `bot_id` (`bot_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_trigger` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL, `actions` longtext NOT NULL, `group_id` bigint(20) NOT NULL, `bot_id` int(11) NOT NULL, `default` int(11) NOT NULL, `default_unknown` int(11) NOT NULL, `as_argument` int(11) NOT NULL DEFAULT '0', `in_progress` int(11) NOT NULL DEFAULT '0', `default_unknown_btn` int(11) NOT NULL DEFAULT '0', `default_always` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `bot_id` (`bot_id`),  KEY `default_unknown` (`default_unknown`), KEY `in_progress` (`in_progress`), KEY `default_unknown_btn` (`default_unknown_btn`), KEY `default_always` (`default_always`), KEY `group_id` (`group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_trigger_event` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `pattern` text NOT NULL, `pattern_exc` text NOT NULL, `configuration` longtext NOT NULL, `trigger_id` bigint(20) NOT NULL, `bot_id` int(11) NOT NULL, `on_start_type` tinyint(1) NOT NULL, `priority` int(11) NOT NULL, `type` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `pattern_v2` (`pattern`(191)), KEY `type` (`type`), KEY `on_start_type` (`on_start_type`), KEY `trigger_id` (`trigger_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_payload` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL, `payload` varchar(100) NOT NULL, `bot_id` int(11) NOT NULL, `trigger_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `bot_id` (`bot_id`), KEY `trigger_id` (`trigger_id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_chat_workflow` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL,`trigger_id` bigint(20) NOT NULL, `time` int(11) NOT NULL, `identifier` varchar(100) NOT NULL, `status` int(11) NOT NULL, `collected_data` text, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_chat_event` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `counter` int(11) NOT NULL, `content` longtext NOT NULL, `ctime` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_pending_event` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `trigger_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_exception` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL, `priority` int(11) NOT NULL, `active` tinyint(1) NOT NULL, PRIMARY KEY (`id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_exception_message` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `code` varchar(20) NOT NULL, `exception_group_id` int(11) NOT NULL, `priority` int(11) NOT NULL, `active` tinyint(1) NOT NULL, `message` text NOT NULL, PRIMARY KEY (`id`), KEY `code` (`code`), KEY `exception_group_id` (`exception_group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_tr_group` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL,`filename` varchar(250) NOT NULL,`filepath` varchar(250) NOT NULL,`configuration` longtext NOT NULL,`nick` varchar(100) NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_tr_item` ( `id` int(11) NOT NULL AUTO_INCREMENT, `group_id` int(11) NOT NULL, `identifier` varchar(50) NOT NULL, `translation` text NOT NULL, PRIMARY KEY (`id`),  KEY `identifier` (`identifier`), KEY `group_id` (`group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_speech_user_language` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `user_id` bigint(20) NOT NULL, `language` varchar(20) NOT NULL, PRIMARY KEY (`id`), KEY `user_id_language` (`user_id`,`language`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_audits` (`id` bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY, `category` varchar(255) NOT NULL, `file` varchar(255), `object_id` bigint(20) DEFAULT '0', `line` bigint(20), `message` longtext NOT NULL, `severity` varchar(255) NOT NULL, `source` varchar(255) NOT NULL, `time` timestamp NOT NULL, KEY `object_id` (`object_id`), KEY `source` (`source`(191)), KEY `category` (`category`(191))) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_chat_online_user_footprint_update` (`online_user_id` bigint(20) NOT NULL,  `command` varchar(20) NOT NULL,  `args` varchar(250) NOT NULL,  `ctime` int(11) NOT NULL, KEY `online_user_id` (`online_user_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_repeat_restrict` (`id` bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY, `chat_id` bigint(20) NOT NULL, `trigger_id` bigint(20), `identifier` varchar(20), `counter` int(11) DEFAULT '0', KEY `chat_id_trigger_id` (`chat_id`,`trigger_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_users_login` (`id` bigint(20) NOT NULL AUTO_INCREMENT,`user_id` bigint(20) NOT NULL,`type` int(11) NOT NULL,`ctime` bigint(20) NOT NULL,`status` int(11) NOT NULL,`ip` varchar(100) NOT NULL,`msg` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,PRIMARY KEY (`id`),KEY `user_id_type` (`user_id`,`type`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    $Departament = new erLhcoreClassModelDepartament();\n                    $Departament->name = $form->DefaultDepartament;\n                    erLhcoreClassDepartament::getSession()->save($Departament);\n\n                    //Department custom work hours\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_departament_custom_work_hours` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `date_from` int(11) NOT NULL,\n\t\t\t\t  `date_to` int(11) NOT NULL,\n\t\t\t\t  `start_hour` int(11) NOT NULL,\n\t\t\t\t  `end_hour` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `date_from` (`date_from`),\n\t\t\t\t  KEY `search_active` (`date_from`, `date_to`, `dep_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    //Administrators group\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_group` (\n               `id` int(11) NOT NULL AUTO_INCREMENT,\n               `name` varchar(50) NOT NULL,\n               `disabled` tinyint(1) NOT NULL,\n               `required` tinyint(1) NOT NULL DEFAULT '0',\n               PRIMARY KEY (`id`),\n               KEY `disabled` (`disabled`)\n               ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Admin group\n                    $GroupData = new erLhcoreClassModelGroup();\n                    $GroupData->name    = \"Administrators\";\n                    erLhcoreClassUser::getSession()->save($GroupData);\n\n                    // Precreate operators group\n                    $GroupDataOperators = new erLhcoreClassModelGroup();\n                    $GroupDataOperators->name    = \"Operators\";\n                    erLhcoreClassUser::getSession()->save($GroupDataOperators);\n\n                    //Administrators role\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_role` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `name` varchar(50) NOT NULL,\n                  PRIMARY KEY (`id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Administrators role\n                    $Role = new erLhcoreClassModelRole();\n                    $Role->name = 'Administrators';\n                    erLhcoreClassRole::getSession()->save($Role);\n\n                    // Operators role\n                    $RoleOperators = new erLhcoreClassModelRole();\n                    $RoleOperators->name = 'Operators';\n                    erLhcoreClassRole::getSession()->save($RoleOperators);\n\n                    //Assing group role\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_grouprole` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `group_id` int(11) NOT NULL,\n                  `role_id` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `group_id` (`role_id`,`group_id`),\n                  KEY `group_id_primary` (`group_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Assign admin role to admin group\n                    $GroupRole = new erLhcoreClassModelGroupRole();\n                    $GroupRole->group_id =$GroupData->id;\n                    $GroupRole->role_id = $Role->id;\n                    erLhcoreClassRole::getSession()->save($GroupRole);\n\n                    // Assign operators role to operators group\n                    $GroupRoleOperators = new erLhcoreClassModelGroupRole();\n                    $GroupRoleOperators->group_id =$GroupDataOperators->id;\n                    $GroupRoleOperators->role_id = $RoleOperators->id;\n                    erLhcoreClassRole::getSession()->save($GroupRoleOperators);\n\n                    // Users\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `username` varchar(80) NOT NULL,\n                  `password` varchar(200) NOT NULL,\n                  `email` varchar(100) NOT NULL,\n                  `time_zone` varchar(100) NOT NULL,\n                  `name` varchar(100) NOT NULL,\n                  `surname` varchar(100) NOT NULL,\n                  `filepath` varchar(200) NOT NULL,\n                  `filename` varchar(200) NOT NULL,\n                  `job_title` varchar(100) NOT NULL,\n                  `departments_ids` text NOT NULL,\n                  `chat_nickname` varchar(100) NOT NULL,\n                  `xmpp_username` varchar(200) NOT NULL,\n                  `session_id` varchar(40) NOT NULL,\n                  `avatar` varchar(150) NOT NULL,\n                  `operation_admin` text NOT NULL,\n                  `skype` varchar(50) NOT NULL,\n                  `exclude_autoasign` tinyint(1) NOT NULL,\n                  `disabled` tinyint(4) NOT NULL,\n                  `hide_online` tinyint(1) NOT NULL,\n                  `all_departments` tinyint(1) NOT NULL,\n                  `invisible_mode` tinyint(1) NOT NULL,\n                  `inactive_mode` tinyint(1) NOT NULL,\n                  `rec_per_req` tinyint(1) NOT NULL,\n                  `auto_accept` tinyint(1) NOT NULL,\n                  `max_active_chats` int(11) NOT NULL,\n                  `cache_version` int(11) unsigned NOT NULL DEFAULT '0',\n                  `pswd_updated` int(11) NOT NULL,\n                  `attr_int_1` int(11) NOT NULL,\n                  `attr_int_2` int(11) NOT NULL,\n                  `attr_int_3` int(11) NOT NULL,\n                  `force_logout` tinyint(1) unsigned NOT NULL DEFAULT '0',\n                  `llogin` bigint(20) unsigned NOT NULL DEFAULT '0',\n                  `always_on` tinyint(1) NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`id`),\n                  KEY `hide_online` (`hide_online`),\n                  KEY `rec_per_req` (`rec_per_req`),\n                  KEY `disabled` (`disabled`),\n                  KEY `email` (`email`),\n                  KEY `xmpp_username` (`xmpp_username`(191))\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $UserData = new erLhcoreClassModelUser();\n\n                    $UserData->setPassword($form->AdminPassword);\n                    $UserData->email   = $form->AdminEmail;\n                    $UserData->name    = $form->AdminName;\n                    $UserData->surname = $form->AdminSurname;\n                    $UserData->username = $form->AdminUsername;\n                    $UserData->all_departments = 1;\n                    $UserData->departments_ids = 0;\n                    $UserData->pswd_updated = time();\n\n                    erLhcoreClassUser::getSession()->save($UserData);\n\n                    // User departaments\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_userdep` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `user_id` int(11) NOT NULL,\n                  `dep_id` int(11) NOT NULL,\n                  `last_activity` int(11) NOT NULL,\n                  `lastd_activity` int(11) NOT NULL DEFAULT '0',\n                  `exclude_autoasign` tinyint(1) NOT NULL DEFAULT '0',\n                  `hide_online` int(11) NOT NULL,\n                  `last_accepted` int(11) NOT NULL DEFAULT '0',\n                  `active_chats` int(11) NOT NULL DEFAULT '0',\n                  `pending_chats` int(11) NOT NULL DEFAULT '0',\n                  `inactive_chats` int(11) NOT NULL DEFAULT '0',\n                  `max_chats` int(11) NOT NULL DEFAULT '0',\n                  `type` int(11) NOT NULL DEFAULT '0',\n                  `ro` tinyint(1) NOT NULL DEFAULT '0',\n                  `hide_online_ts` int(11) NOT NULL DEFAULT '0',\n                  `dep_group_id` int(11) NOT NULL DEFAULT '0',\n                  `always_on` tinyint(1) NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`id`),\n                  KEY `last_activity_hide_online_dep_id` (`last_activity`,`hide_online`,`dep_id`),\n                  KEY `dep_id` (`dep_id`),\n                  KEY `user_id_type` (`user_id`,`type`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    // Insert record to departament instantly\n                    $db->query(\"INSERT INTO `lh_userdep` (`user_id`,`dep_id`,`last_activity`,`hide_online`,`last_accepted`,`active_chats`,`type`,`dep_group_id`,`exclude_autoasign`) VALUES ({$UserData->id},0,0,0,0,0,0,0,0)\");\n\n                    $db->query(\"CREATE TABLE `lh_group_work` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `group_id` int(11) NOT NULL, `group_work_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `group_id` (`group_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Transfer chat\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_transfer` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `chat_id` int(11) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `transfer_user_id` int(11) NOT NULL,\n\t\t\t\t  `from_dep_id` int(11) NOT NULL,\n\t\t\t\t  `ctime` int(11) NOT NULL,\n\t\t\t\t  `transfer_to_user_id` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `transfer_user_id_dep_id` (`transfer_user_id`,`dep_id`),\n\t\t\t\t  KEY `transfer_to_user_id` (`transfer_to_user_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Remember user table\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users_remember` (\n\t\t\t\t `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t `user_id` int(11) NOT NULL,\n\t\t\t\t `mtime` int(11) NOT NULL,\n\t\t\t\t PRIMARY KEY (`id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_generic_bot_command` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `command` varchar(50) NOT NULL,\n  `bot_id` int(11) NOT NULL,\n  `trigger_id` int(11) NOT NULL,\n  `dep_id` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `dep_id` (`dep_id`),\n  KEY `command` (`command`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_canned_msg_subject` (\n    `id` int(11) NOT NULL AUTO_INCREMENT,\n    `canned_id` int(11) NOT NULL,\n    `subject_id` int(11) NOT NULL,\n    PRIMARY KEY (`id`),\n    KEY `canned_id` (`canned_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_canned_msg_replace` (\n                    `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n                    `identifier` varchar(50) NOT NULL,\n                    `default` text NOT NULL, `conditions` longtext NOT NULL,\n                    PRIMARY KEY (`id`),\n                   KEY `identifier` (`identifier`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_saved_search` (\n                    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `name` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `params` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `user_id` bigint(20) unsigned NOT NULL,\n                  `position` int(11) unsigned NOT NULL,\n                  `scope` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `days` int(11) unsigned NOT NULL,\n                  `updated_at` bigint(20) unsigned NOT NULL,\n                  `requested_at` bigint(20) unsigned NOT NULL,\n                  `total_records` bigint(20) unsigned NOT NULL,\n                  `passive` tinyint(1) unsigned NOT NULL DEFAULT 0,\n                  PRIMARY KEY (`id`),\n                  KEY `user_id` (`user_id`),\n                  KEY `scope` (`scope`),\n                  KEY `updated_at` (`updated_at`),\n                  KEY `requested_at` (`requested_at`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // API table\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_rest_api_key` (\n                    `id` int(11) NOT NULL AUTO_INCREMENT,\n                    `api_key` varchar(50) NOT NULL,\n                    `user_id` int(11) NOT NULL DEFAULT '0',\n                    `active` int(11) NOT NULL DEFAULT '0',\n                    `ip_restrictions` varchar(250) NOT NULL,\n                    PRIMARY KEY (`id`),\n                    KEY `api_key` (`api_key`),\n                    KEY `user_id` (`user_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_rest_api_key_remote` ( `id` int(11) NOT NULL AUTO_INCREMENT, `api_key` varchar(50) NOT NULL, `username` varchar(50) NOT NULL, `name` varchar(50) NOT NULL, `host` varchar(250) NOT NULL, `active` tinyint(1) NOT NULL DEFAULT '0', `position` int(11) NOT NULL DEFAULT '0', PRIMARY KEY (`id`), KEY `active` (`active`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n                    $db->query(\"CREATE TABLE `lh_abstract_chat_variable` ( `id` int(11) NOT NULL AUTO_INCREMENT, `var_name` varchar(255) NOT NULL, `var_identifier` varchar(255) NOT NULL,`inv` tinyint(1) NOT NULL, `change_message` varchar(250) NOT NULL, `type` tinyint(1) NOT NULL, `persistent` tinyint(1) NOT NULL, `js_variable` varchar(255) NOT NULL, `dep_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `dep_id` (`dep_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_webhook` ( `id` int(11) NOT NULL AUTO_INCREMENT, `event` varchar(50) NOT NULL, `bot_id_alt` int(11) NOT NULL DEFAULT '0', `trigger_id_alt` int(11) NOT NULL DEFAULT '0', `bot_id` int(11) NOT NULL, `trigger_id` int(11) NOT NULL, `disabled` tinyint(1) NOT NULL, `configuration` longtext NOT NULL, `type` tinyint(1) NOT NULL DEFAULT 0, PRIMARY KEY (`id`), KEY `event_disabled` (`event`,`disabled`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_incoming_webhook` ( `id` int(11) NOT NULL AUTO_INCREMENT, `dep_id` int(11) NOT NULL, `name` varchar(50) NOT NULL,`identifier` varchar(50) NOT NULL, `scope` varchar(50) NOT NULL, `disabled` tinyint(1) NOT NULL, `configuration` longtext NOT NULL, PRIMARY KEY (`id`), KEY `identifier` (`identifier`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_chat_incoming` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `utime` bigint(20) NOT NULL, `incoming_id` int(11) NOT NULL,`payload` longtext NOT NULL, `chat_external_id` varchar(50) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`),  KEY `incoming_ext_id` (`incoming_id`,`chat_external_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_chat_column` (`id` int(11) NOT NULL AUTO_INCREMENT,`column_name` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,`variable` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, `position` int(11) NOT NULL, `enabled` tinyint(1) NOT NULL, `online_enabled` tinyint(1) NOT NULL, `chat_enabled` tinyint(1) NOT NULL, `conditions` text COLLATE utf8mb4_unicode_ci NOT NULL,`column_icon` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, `column_identifier` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, PRIMARY KEY (`id`), KEY `enabled` (`enabled`), KEY `online_enabled` (`online_enabled`), KEY `chat_enabled` (`chat_enabled`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_abstract_chat_priority` (`id` int(11) NOT NULL AUTO_INCREMENT,`value` text COLLATE utf8mb4_unicode_ci NOT NULL,`dep_id` int(11) NOT NULL, `dest_dep_id` int(11) NOT NULL DEFAULT 0, `sort_priority` int(11) NOT NULL DEFAULT 0,`priority` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `dep_id` (`dep_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_canned_msg_use` (`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT, `canned_id` int(11) unsigned NOT NULL, `chat_id` bigint(20) unsigned NOT NULL, `ctime` bigint(20) unsigned NOT NULL, `user_id` bigint(20) unsigned NOT NULL, PRIMARY KEY (`id`), KEY `ctime` (`ctime`), KEY `chat_id` (`chat_id`), KEY `canned_id` (`canned_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    // Session\n                    $db->query(\"CREATE TABLE `lh_users_session` (\n                      `id` int(11) NOT NULL AUTO_INCREMENT,\n                      `token` varchar(40) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `device_type` int(11) NOT NULL,\n                      `device_token` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `user_id` int(11) NOT NULL,\n                      `created_on` int(11) NOT NULL,\n                      `updated_on` int(11) NOT NULL,\n                      `expires_on` int(11) NOT NULL,\n                      `notifications_status` int(11) NOT NULL DEFAULT 1,\n                      `error` int(11) NOT NULL DEFAULT 0,\n                      `last_error` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      PRIMARY KEY (`id`),\n                      KEY `token` (`token`),\n                      KEY `device_token_device_type_v2` (`device_token`(191),`device_type`),\n                      KEY `error` (`error`)\n                    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Chat messages\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_msg` (\n\t\t\t\t  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `msg` longtext NOT NULL,\n\t\t\t\t  `meta_msg` longtext NOT NULL,\n\t\t\t\t  `time` int(11) NOT NULL,\n\t\t\t\t  `chat_id` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_id` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `name_support` varchar(100) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `chat_id_id` (`chat_id`, `id`),\n\t\t\t\t  KEY `user_id` (`user_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Forgot password table\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_forgotpasswordhash` (\n                `id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,\n                `user_id` INT NOT NULL ,\n                `hash` VARCHAR( 40 ) NOT NULL ,\n                `created` INT NOT NULL\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // User groups table\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_groupuser` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `group_id` int(11) NOT NULL,\n                  `user_id` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `group_id` (`group_id`),\n                  KEY `user_id` (`user_id`),\n                  KEY `group_id_2` (`group_id`,`user_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Assign admin user to admin group\n                    $GroupUser = new erLhcoreClassModelGroupUser();\n                    $GroupUser->group_id = $GroupData->id;\n                    $GroupUser->user_id = $UserData->id;\n                    erLhcoreClassUser::getSession()->save($GroupUser);\n\n                    //Assign default role functions\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_rolefunction` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `role_id` int(11) NOT NULL,\n                  `module` varchar(100) NOT NULL,\n                  `function` varchar(100) NOT NULL,\n                  `limitation` text NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `role_id` (`role_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Admin role and function\n                    $RoleFunction = new erLhcoreClassModelRoleFunction();\n                    $RoleFunction->role_id = $Role->id;\n                    $RoleFunction->module = '*';\n                    $RoleFunction->function = '*';\n                    erLhcoreClassRole::getSession()->save($RoleFunction);\n\n                    // Operators rules and functions\n                    $permissionsArray = array(\n                        array('module' => 'lhuser',  'function' => 'selfedit'),\n                        array('module' => 'lhuser',  'function' => 'change_chat_nickname'),\n                        array('module' => 'lhuser',  'function' => 'changephoto'),\n                        array('module' => 'lhuser',  'function' => 'change_job_title'),\n                        array('module' => 'lhuser',  'function' => 'change_core_attributes'),\n                        array('module' => 'lhuser',  'function' => 'change_name_surname'),\n                        array('module' => 'lhuser',  'function' => 'selfedit'),\n                        array('module' => 'lhuser',  'function' => 'changeonlinestatus'),\n                        array('module' => 'lhuser',  'function' => 'changeskypenick'),\n                        array('module' => 'lhuser',  'function' => 'personalcannedmsg'),\n                        array('module' => 'lhuser',  'function' => 'change_visibility_list'),\n                        array('module' => 'lhuser',  'function' => 'see_assigned_departments'),\n                        array('module' => 'lhuser',  'function' => 'canseedepartmentstats'),\n                        array('module' => 'lhchat',  'function' => 'use'),\n                        array('module' => 'lhchat',  'function' => 'open_all'),\n                        array('module' => 'lhchat',  'function' => 'chattabschrome'),\n                        array('module' => 'lhchat',  'function' => 'singlechatwindow'),\n                        array('module' => 'lhchat',  'function' => 'allowopenremotechat'),\n                        array('module' => 'lhchat',  'function' => 'writeremotechat'),\n                        array('module' => 'lhchat',  'function' => 'allowchattabs'),\n                        array('module' => 'lhchat',  'function' => 'use_onlineusers'),\n                        array('module' => 'lhchat',  'function' => 'take_screenshot'),\n                        array('module' => 'lhfront', 'function' => 'use'),\n                        array('module' => 'lhsystem','function' => 'use'),\n                        array('module' => 'lhtranslation','function' => 'use'),\n                        array('module' => 'lhchat',  'function' => 'allowblockusers'),\n                        array('module' => 'lhsystem','function' => 'generatejs'),\n                        array('module' => 'lhsystem','function' => 'changelanguage'),\n                        array('module' => 'lhchat',  'function' => 'allowredirect'),\n                        array('module' => 'lhchat',  'function' => 'allowtransfer'),\n                        array('module' => 'lhchat',  'function' => 'allowtransferdirectly'),\n                        array('module' => 'lhchat',  'function' => 'administratecannedmsg'),\n                        array('module' => 'lhchat',  'function' => 'explorecannedmsg'),\n                        array('module' => 'lhchat',  'function' => 'sees_all_online_visitors'),\n                        array('module' => 'lhpermission',   'function' => 'see_permissions'),\n                        array('module' => 'lhquestionary',  'function' => 'manage_questionary'),\n                        array('module' => 'lhfaq',   \t\t'function' => 'manage_faq'),\n                        array('module' => 'lhchatbox',   \t'function' => 'manage_chatbox'),\n                        array('module' => 'lhbrowseoffer',  'function' => 'manage_bo'),\n                        array('module' => 'lhxml',   \t\t'function' => '*'),\n                        array('module' => 'lhcobrowse',   \t'function' => 'browse'),\n                        array('module' => 'lhfile',   \t\t'function' => 'use_operator'),\n                        array('module' => 'lhfile',   \t\t'function' => 'file_delete_chat'),\n                        array('module' => 'lhstatistic',   \t'function' => 'use'),\n                        array('module' => 'lhspeech', 'function' => 'changedefaultlanguage'),\n                        array('module' => 'lhspeech', 'function' => 'use'),\n                        array('module' => 'lhcannedmsg', 'function' => 'use'),\n                        array('module' => 'lhcannedmsg', 'function' => 'see_global'),\n                        array('module' => 'lhchat', 'function' => 'prev_chats'),\n                        array('module' => 'lhtheme', 'function' => 'personaltheme'),\n                        array('module' => 'lhuser', 'function' => 'userlistonline'),\n                        array('module' => 'lhspeech', 'function' => 'change_chat_recognition'),\n                        array('module' => 'lhgroupchat', 'function' => 'use'),\n                        array('module' => 'lhuser', 'function' => 'see_all_group_users'),\n                        array('module' => 'lhvoicevideo', 'function' => 'use'),\n                        array('module' => 'lhtheme', 'function' => 'use_operator'),\n                        array('module' => 'lhgenericbot', 'function' => 'use_operator'),\n                    );\n\n                    foreach ($permissionsArray as $paramsPermission) {\n                        $RoleFunctionOperator = new erLhcoreClassModelRoleFunction();\n                        $RoleFunctionOperator->role_id = $RoleOperators->id;\n                        $RoleFunctionOperator->module = $paramsPermission['module'];\n                        $RoleFunctionOperator->function = $paramsPermission['function'];\n                        erLhcoreClassRole::getSession()->save($RoleFunctionOperator);\n                    }\n\n                    $cfgSite = erConfigClassLhConfig::getInstance();\n                    $cfgSite->setSetting( 'site', 'installed', true);\n                    $cfgSite->setSetting( 'site', 'templatecache', true);\n                    $cfgSite->setSetting( 'site', 'templatecompile', true);\n                    $cfgSite->setSetting( 'site', 'modulecompile', true);\n                    $cfgSite->setSetting( 'webhooks', 'enabled', (!empty(getenv('LHC_WEBHOOKS_ENABLED')) ? getenv('LHC_WEBHOOKS_ENABLED') : 0));\n                    $cfgSite->save();\n\n                    $tpl->setFile('lhinstall/install4.tpl.php');\n\n                } else {\n\n                    $tpl->set('admin_username',$form->AdminUsername);\n                    if ( $form->hasValidData( 'AdminEmail' ) ) $tpl->set('admin_email',$form->AdminEmail);\n                    $tpl->set('admin_name',$form->AdminName);\n                    $tpl->set('admin_surname',$form->AdminSurname);\n                    $tpl->set('admin_departament',$form->DefaultDepartament);\n\n                    $tpl->set('errors',$Errors);\n\n                    $tpl->setFile('lhinstall/install3.tpl.php');\n                }\n            } else {\n                $tpl->setFile('lhinstall/install3.tpl.php');\n            }\n\n            break;\n\n        case '4':\n            $tpl->setFile('lhinstall/install4.tpl.php');\n            break;\n\n        default:\n            $tpl->setFile('lhinstall/install1.tpl.php');\n            break;\n    }\n\n    $Result['content'] = $tpl->fetch();\n    $Result['pagelayout'] = 'install';\n    $Result['path'] = array(array('title' => 'Live helper chat installation'));\n\n} catch (Exception $e) {\n    echo \"Make sure that &quot;cache/*&quot; is writable and then <a href=\\\"\".erLhcoreClassDesign::baseurl('install/install').\"\\\">try again</a>\";\n\n    echo \"<pre>\";\n    print_r($e);\n    echo \"</pre>\";\n    exit;\n}\n?>\n"], "fixing_code": ["<?php\n\nclass Install\n{\n    function __construct($ini_file)\n    {\n        openlog(\"livehelperchat\", LOG_PID | LOG_PERROR, LOG_LOCAL0);\n        syslog(LOG_DEBUG, \"Start installation\"); \n        $this->settings = parse_ini_file($ini_file, true, INI_SCANNER_TYPED);\n    }\n\n    function __destruct()\n    {\n        syslog(LOG_DEBUG, \"Finish installation\"); \n        closelog();\n    }\n\n    function step1() {\n        $Errors = array();\n        $directories = $this->_scandir('cache');\n        $this->file_is_writable(array('cache'),'', $Errors);\n        $this->file_is_writable($directories, 'cache/', $Errors);\n        $this->file_is_writable(array('settings'), '', $Errors);\n        $var_directories = array(\n            'var/storage',\n            'var/storageform',\n            'var/storagetheme',\n            'var/storageadmintheme',\n            'var/tmpfiles',\n            'var/userphoto',\n        );\n        $this->file_is_writable(array('var'),'', $Errors);\n        $this->file_is_writable($var_directories, '', $Errors);\n\n        if (!extension_loaded ('pdo_mysql' ))\n            $Errors[] = \"php-pdo extension not detected. Please install php extension\";\n\n        if (!extension_loaded('curl'))\n            $Errors[] = \"php_curl extension not detected. Please install php extension\";\t\n\n        if (!extension_loaded('mbstring'))\n            $Errors[] = \"mbstring extension not detected. Please install php extension\";\t\n\n        if (!extension_loaded('gd'))\n            $Errors[] = \"gd extension not detected. Please install php extension\";\t\n\n        if (!function_exists('json_encode'))\n            $Errors[] = \"json support not detected. Please install php extension\";\t\n\n        if (version_compare(PHP_VERSION, '5.4.0','<')) {\n            $Errors[] = \"Minimum 5.4.0 PHP version is required\";\t\n        }\n\n        if (count($Errors) == 0){\n            return true;\n        } else {\n            return $Errors;\n        }\n    }\n\n    function step2() {\n        $Errors = array();\n        $database = $this->settings['db'];\n        foreach ($database as $key => $value) {\n            if (!filter_var($database[$key], FILTER_UNSAFE_RAW)) {\n                $Errors[] = \"Please enter database $key\";\n            }\n        }\n        if (!filter_var($database['database'], FILTER_SANITIZE_STRING))\n        {\n            $Errors[] = 'Please enter database name';\n        }\n\n        if (count($Errors) == 0) {\n            try {\n                $db = ezcDbFactory::create( \"mysql://{$database['user']}:{$database['password']}@{$database['host']}:{$database['port']}/{$database['database']}\" );\n            } catch (Exception $e) {\n                $Errors[] = \"Cannot login with provided logins. Returned message: \".$e->getMessage();\n            }\n        }\n\n        if (count($Errors) == 0) {\n            $cfgSite = erConfigClassLhConfig::getInstance();\n            foreach ($database as $key => $value) {\n                $cfgSite->setSetting( 'db', $key, $value);\n            }\n            $cfgSite->setSetting( 'site', 'secrethash', erLhcoreClassChat::generateHash(80));\n            return true;\n        } else {\n            return $Errors;\n        }\n    }\n\n    function step3() {\n\n        $Errors = array();\n\n        $form = (object)$this->settings['admin'];\n        if (!filter_var($form->AdminUsername, FILTER_UNSAFE_RAW))\n        {\n            $Errors[] = 'Please enter admin username';\n        }\n\n        if (!empty($form->AdminUsername) && strlen($form->AdminUsername) > 40)\n        {\n            $Errors[] = 'Maximum 40 characters for admin username';\n        }\n\n        if (!filter_var($form->AdminPassword, FILTER_UNSAFE_RAW))\n        {\n            $Errors[] = 'Please enter admin password';\n        }\n\n        if (!empty($form->AdminPassword) && strlen($form->AdminPassword) > 40)\n        {\n            $Errors[] = 'Maximum 40 characters for admin password';\n        }\n\n        if (!filter_var($form->AdminEmail, FILTER_VALIDATE_EMAIL))\n        {\n            $Errors[] = 'Wrong email address';\n        }\n\n        if (!filter_var($form->DefaultDepartament, FILTER_SANITIZE_STRING))\n        {\n            $Errors[] = 'Please enter default department name';\n        }\n\n        if (count($Errors) == 0) {\n            $adminEmail = $form->AdminEmail;\n\n            /*DATABASE TABLES SETUP*/\n            $db = ezcDbInstance::get();\n\n            try {\n                $db->query(\"set global innodb_large_prefix = 1\");\n            } catch (Exception $e) {\n                // Just ignore if not succeed\n            }\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat` (\n\t\t\t\t  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `nick` varchar(100) NOT NULL,\n\t\t\t\t  `status` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `status_sub` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `status_sub_sub` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `time` int(11) NOT NULL,\n\t\t\t\t  `user_id` int(11) NOT NULL,\n\t\t\t\t  `hash` varchar(40) NOT NULL,\n\t\t\t\t  `referrer` text NOT NULL,\n        \t   \t  `session_referrer` text NOT NULL,\n        \t   \t  `chat_variables` text NOT NULL,\n        \t   \t  `remarks` text NOT NULL,\n\t\t\t\t  `ip` varchar(100) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\t\t\t\t \n\t\t\t\t  `gbot_id` int(11) NOT NULL DEFAULT '0',\t\t\t\t \n\t\t\t\t  `invitation_id` int(11) NOT NULL,\t\t\t\t \n\t\t\t\t  `sender_user_id` int(11) NOT NULL,\n\t\t\t\t  `product_id` int(11) NOT NULL,\n                  `cls_us` tinyint(1) NOT NULL DEFAULT '0',\n\t\t\t\t  `pnd_time` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `cls_time` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `usaccept` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_status` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_closed_ts` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `support_informed` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `unread_messages_informed` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `reinform_timeout` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `last_op_msg_time` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `has_unread_op_messages` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `unread_op_messages_informed` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `email` varchar(100) NOT NULL,\n\t\t\t\t  `country_code` varchar(100) NOT NULL,\n\t\t\t\t  `country_name` varchar(100) NOT NULL,\n\t\t\t\t  `unanswered_chat` int(11) NOT NULL,\n\t\t\t\t  `anonymized` tinyint(1) NOT NULL,\n\t\t\t\t  `user_typing` int(11) NOT NULL,\n\t\t\t\t  `user_typing_txt` varchar(200) NOT NULL,\n\t\t\t\t  `operator_typing` int(11) NOT NULL,\n        \t   \t  `operator_typing_id` int(11) NOT NULL,\n\t\t\t\t  `phone` varchar(100) NOT NULL,\n\t\t\t\t  `has_unread_messages` int(11) NOT NULL,\n\t\t\t\t  `last_user_msg_time` int(11) NOT NULL,\n\t\t\t\t  `fbst` tinyint(1) NOT NULL,\n\t\t\t\t  `online_user_id` int(11) NOT NULL,\n\t\t\t\t  `auto_responder_id` int(11) NOT NULL,\n\t\t\t\t  `last_msg_id` int(11) NOT NULL,\n\t\t\t\t  `lsync` int(11) NOT NULL,\n\t\t\t\t  `transfer_uid` int(11) NOT NULL,\n\t\t\t\t  `additional_data` text NOT NULL,\t\t\t\t  \n\t\t\t\t  `user_tz_identifier` varchar(50) NOT NULL,\n\t\t\t\t  `lat` varchar(10) NOT NULL,\n\t\t\t\t  `lon` varchar(10) NOT NULL,\n\t\t\t\t  `city` varchar(100) NOT NULL,\n\t\t\t\t  `operation` text NOT NULL,\n\t\t\t\t  `operation_admin` varchar(200) NOT NULL,\n\t\t\t\t  `status_sub_arg` varchar(200) NOT NULL,\n\t\t\t\t  `uagent` varchar(250) NOT NULL,\n\t\t\t\t  `chat_locale` varchar(10) NOT NULL,\n\t\t\t\t  `chat_locale_to` varchar(10) NOT NULL,\n\t\t\t\t  `mail_send` int(11) NOT NULL,\n        \t   \t  `screenshot_id` int(11) NOT NULL,\n        \t   \t  `wait_time` int(11) NOT NULL,\n  \t\t\t\t  `chat_duration` int(11) NOT NULL,\n  \t\t\t\t  `tslasign` int(11) NOT NULL,\n        \t   \t  `priority` int(11) NOT NULL,\n        \t   \t  `chat_initiator` int(11) NOT NULL,\n        \t   \t  `transfer_timeout_ts` int(11) NOT NULL,\n        \t   \t  `transfer_timeout_ac` int(11) NOT NULL,\n        \t   \t  `transfer_if_na` int(11) NOT NULL,\n        \t   \t  `na_cb_executed` int(11) NOT NULL,\n        \t   \t  `device_type` int(11) NOT NULL,\n        \t   \t  `nc_cb_executed` tinyint(1) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `status_user_id` (`status`,`user_id`),\n\t\t\t\t  KEY `unanswered_chat` (`unanswered_chat`),\n\t\t\t\t  KEY `online_user_id` (`online_user_id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `product_id` (`product_id`),\n\t\t\t\t  KEY `unread_operator` (`has_unread_op_messages`,`unread_op_messages_informed`),\n\t\t\t\t  KEY `user_id_sender_user_id` (`user_id`,`sender_user_id`),\n\t\t\t\t  KEY `sender_user_id` (`sender_user_id`),\n\t\t\t\t  KEY `anonymized` (`anonymized`),\n\t\t\t\t  KEY `has_unread_messages` (`has_unread_messages`),\n\t\t\t\t  KEY `status` (`status`),\n                  KEY `nick` (`nick`),\n\t\t\t\t  KEY `email` (`email`),\n\t\t\t\t  KEY `dep_id_status` (`dep_id`,`status`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_chat_blocked_user` (\n                  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `ip` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `user_id` bigint(20) unsigned NOT NULL,\n                  `datets` bigint(20) unsigned NOT NULL,\n                  `chat_id` bigint(20) unsigned NOT NULL,\n                  `dep_id` bigint(20) unsigned NOT NULL,\n                  `nick` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `btype` tinyint(1) NOT NULL DEFAULT 0,\n                  `expires` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  `online_user_id` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  PRIMARY KEY (`id`),\n                  KEY `ip` (`ip`),\n                  KEY `nick` (`nick`),\n                  KEY `online_user_id` (`online_user_id`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_users_online_session` ( \n        \t       `id` bigint(20) NOT NULL AUTO_INCREMENT, \n        \t       `user_id` int(11) NOT NULL, \n        \t       `time` int(11) NOT NULL, \n        \t       `duration` int(11) NOT NULL, \n        \t       `lactivity` int(11) NOT NULL, \n        \t       PRIMARY KEY (`id`), \n        \t       KEY `user_id_lactivity` (`user_id`, `lactivity`), KEY `lactivity` (`lactivity`) ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_chat_start_settings` ( \n        \t       `id` int(11) NOT NULL AUTO_INCREMENT, \n        \t       `name` varchar(50) NOT NULL, \n        \t       `data` longtext NOT NULL, \n        \t       `department_id` int(11) NOT NULL, \n        \t       PRIMARY KEY (`id`), \n        \t       KEY `department_id` (`department_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_chat_event_track` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL, `data` longtext NOT NULL, `department_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `department_id` (`department_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_canned_msg_use` (`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT, `canned_id` int(11) unsigned NOT NULL, `chat_id` bigint(20) unsigned NOT NULL, `ctime` bigint(20) unsigned NOT NULL, `user_id` bigint(20) unsigned NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`), KEY `ctime` (`ctime`), KEY `canned_id` (`canned_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            \n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_archive_range` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `range_from` int(11) NOT NULL,\n        \t   `range_to` int(11) NOT NULL,\n        \t   `year_month` int(11) NOT NULL,\n        \t   `older_than` int(11) NOT NULL,\n        \t   `last_id` int(11) NOT NULL,\n        \t   `first_id` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_notification_subscriber` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `online_user_id` bigint(20) NOT NULL, `dep_id` int(11) NOT NULL, `theme_id` int(11) NOT NULL, `ctime` int(11) NOT NULL, `utime` int(11) NOT NULL, `status` int(11) NOT NULL, `params` text NOT NULL, `device_type` tinyint(1) NOT NULL,`subscriber_hash` varchar(50) NOT NULL, `uagent` varchar(250) NOT NULL, `ip` varchar(250) NOT NULL, `last_error` text NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`), KEY `dep_id` (`dep_id`), KEY `online_user_id` (`online_user_id`), KEY `subscriber_hash` (`subscriber_hash`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_auto_responder` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `siteaccess` varchar(3) NOT NULL,\n                  `wait_message` text NOT NULL,\n                  `wait_timeout` int(11) NOT NULL,\n                  `position` int(11) NOT NULL,\n                  `timeout_message` text NOT NULL,\n                  `bot_configuration` text NOT NULL,\n                  `name` varchar(50) NOT NULL,\n                  `operator` varchar(50) NOT NULL,\n                  `dep_id` int(11) NOT NULL,\n                  `user_id` int(11) NOT NULL,\n                  `only_proactive` int(11) NOT NULL,\n                  `repeat_number` int(11) NOT NULL DEFAULT '1',\n                  `survey_timeout` int(11) NOT NULL DEFAULT '0',\n                  `survey_id` int(11) NOT NULL DEFAULT '0',\n                  `wait_timeout_hold_1` int(11) NOT NULL,\n                  `wait_timeout_hold_2` int(11) NOT NULL,\n                  `wait_timeout_hold_3` int(11) NOT NULL,\n                  `wait_timeout_hold_4` int(11) NOT NULL,\n                  `wait_timeout_hold_5` int(11) NOT NULL,\n                  `timeout_hold_message_1` text NOT NULL,\n                  `timeout_hold_message_2` text NOT NULL,\n                  `timeout_hold_message_3` text NOT NULL,\n                  `timeout_hold_message_4` text NOT NULL,\n                  `timeout_hold_message_5` text NOT NULL,\n                  `wait_timeout_hold` text NOT NULL,\n                  `wait_timeout_2` int(11) NOT NULL,\n                  `timeout_message_2` text NOT NULL,\n                  `wait_timeout_3` int(11) NOT NULL,\n                  `timeout_message_3` text NOT NULL,\n                  `wait_timeout_4` int(11) NOT NULL,\n                  `timeout_message_4` text NOT NULL,\n                  `wait_timeout_5` int(11) NOT NULL,\n                  `timeout_message_5` text NOT NULL,\n                  `wait_timeout_reply_1` int(11) NOT NULL,\n                  `timeout_reply_message_1` text NOT NULL,\n                  `wait_timeout_reply_2` int(11) NOT NULL,\n                  `timeout_reply_message_2` text NOT NULL,\n                  `wait_timeout_reply_3` int(11) NOT NULL,\n                  `timeout_reply_message_3` text NOT NULL,\n                  `wait_timeout_reply_4` int(11) NOT NULL,\n                  `timeout_reply_message_4` text NOT NULL,\n                  `wait_timeout_reply_5` int(11) NOT NULL,\n                  `timeout_reply_message_5` text NOT NULL,\n                  `languages` text NOT NULL,\n                  `ignore_pa_chat` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `siteaccess_position` (`siteaccess`,`position`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n\n\n            $db->query(\"CREATE TABLE `lh_abstract_widget_theme` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `name` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `name_company` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `onl_bcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `bor_bcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT 'e3e3e3',\n  `text_color` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `online_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `online_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `offline_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `offline_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `logo_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `logo_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `header_background` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_tcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_bcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_border` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_close_bg` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_hover_bg` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_close_hover_bg` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `custom_status_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `custom_container_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `custom_widget_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_header` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `need_help_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `online_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `offline_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `widget_border_color` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `copyright_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `copyright_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `widget_copyright_url` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `show_copyright` int(11) NOT NULL DEFAULT 1,\n  `explain_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `intro_operator_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `operator_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `operator_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `minimize_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `minimize_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `restore_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `restore_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `close_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `close_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `popup_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `popup_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `hide_close` int(11) NOT NULL,\n  `hide_popup` int(11) NOT NULL,\n  `header_height` int(11) NOT NULL,\n  `header_padding` int(11) NOT NULL,\n  `widget_border_width` int(11) NOT NULL,\n  `support_joined` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `support_closed` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `pending_join` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `noonline_operators` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `noonline_operators_offline` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `show_need_help` int(11) NOT NULL DEFAULT 1,\n  `show_need_help_timeout` int(11) NOT NULL DEFAULT 24,\n  `show_voting` tinyint(1) NOT NULL DEFAULT 1,\n  `department_title` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `department_select` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `buble_visitor_background` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `buble_visitor_title_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `buble_visitor_text_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `buble_operator_background` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `buble_operator_title_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `buble_operator_text_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `custom_popup_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `hide_ts` int(11) NOT NULL,\n  `widget_response_width` int(11) NOT NULL,\n  `show_need_help_delay` int(11) NOT NULL,\n  `show_status_delay` int(11) NOT NULL,\n  `modern_look` tinyint(1) NOT NULL DEFAULT 0,\n  `bot_status_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `bot_configuration` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n  `notification_configuration` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n  `pending_join_queue` text COLLATE utf8mb4_unicode_ci NOT NULL,\n  `modified` int(11) NOT NULL,\n  `widget_show_leave_form` tinyint(1) NOT NULL,\n  `enable_widget_embed_override` tinyint(1) NOT NULL,\n  `widget_popheight` int(11) NOT NULL,\n  `widget_popwidth` int(11) NOT NULL,\n  `widget_survey` int(11) NOT NULL,\n  `widget_position` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `widget_pright` int(11) NOT NULL,\n  `widget_pbottom` int(11) NOT NULL,\n  `alias` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `alias` (`alias`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_faq` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `question` varchar(250) NOT NULL,\n\t\t\t\t  `answer` text NOT NULL,\n\t\t\t\t  `url` varchar(250) NOT NULL,\n\t\t\t\t  `email` varchar(50) NOT NULL,\n\t\t\t\t  `identifier` varchar(10) NOT NULL,\n\t\t\t\t  `active` int(11) NOT NULL,\n\t\t\t\t  `has_url` tinyint(1) NOT NULL,\n\t\t\t\t  `is_wildcard` tinyint(1) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `active` (`active`),\n\t\t\t\t  KEY `active_url_2` (`active`,`url`(191)),\n\t\t\t\t  KEY `has_url` (`has_url`),\n\t\t\t\t  KEY `identifier` (`identifier`),\n\t\t\t\t  KEY `is_wildcard` (`is_wildcard`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n            $db->query(\"CREATE TABLE `lh_group_chat` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `name` varchar(50) NOT NULL,\n  `status` int(11) NOT NULL,\n  `time` int(11) NOT NULL,\n  `user_id` int(11) NOT NULL,\n  `last_msg_op_id` bigint(20) NOT NULL,\n  `last_msg` varchar(200) NOT NULL,\n  `chat_id` bigint(20) NOT NULL DEFAULT 0,\n  `last_user_msg_time` int(11) NOT NULL,\n  `last_msg_id` bigint(20) NOT NULL,\n  `type` tinyint(1) NOT NULL DEFAULT 0,\n  `tm` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `user_id` (`user_id`),\n  KEY `chat_id` (`chat_id`),\n  KEY `type` (`type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_group_msg` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `msg` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n  `time` int(11) NOT NULL,\n  `chat_id` int(11) NOT NULL DEFAULT 0,\n  `user_id` int(11) NOT NULL DEFAULT 0,\n  `name_support` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `meta_msg` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `chat_id_id` (`chat_id`,`id`),\n  KEY `user_id` (`user_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_group_chat_member` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `user_id` bigint(20) NOT NULL,\n  `group_id` bigint(20) NOT NULL,\n  `last_activity` int(11) NOT NULL,\n  `last_msg_id` bigint(20) NOT NULL DEFAULT 0,\n  `type` tinyint(1) NOT NULL DEFAULT 0,\n  `jtime` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `group_id` (`group_id`),\n  KEY `user_id` (`user_id`),\n  KEY `type` (`type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_cobrowse` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `chat_id` int(11) NOT NULL,\n        \t   `online_user_id` int(11) NOT NULL,\n        \t   `mtime` int(11) NOT NULL,\n        \t   `url` varchar(250) NOT NULL,\n        \t   `initialize` longtext NOT NULL,\n        \t   `modifications` longtext NOT NULL,\n        \t   `finished` tinyint(1) NOT NULL,\n        \t   `w` int NOT NULL,\n\t\t\t   `wh` int NOT NULL,\n\t\t\t   `x` int NOT NULL,\n\t\t\t   `y` int NOT NULL,        \t   \t\t\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `chat_id` (`chat_id`),\n        \t   KEY `online_user_id` (`online_user_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_survey` (\n        \t      `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `name` varchar(250) NOT NULL,\n                  `feedback_text` text NOT NULL,\n                  `max_stars_1_title` varchar(250) NOT NULL,\n                  `max_stars_1_pos` int(11) NOT NULL,\n                  `max_stars_2_title` varchar(250) NOT NULL,\n                  `max_stars_2_pos` int(11) NOT NULL,\n                  `max_stars_2` int(11) NOT NULL,\n                  `max_stars_3_title` varchar(250) NOT NULL,\n                  `max_stars_3_pos` int(11) NOT NULL,\n                  `max_stars_3` int(11) NOT NULL,\n                  `max_stars_4_title` varchar(250) NOT NULL,\n                  `max_stars_4_pos` int(11) NOT NULL,\n                  `max_stars_4` int(11) NOT NULL,\n                  `max_stars_5_title` varchar(250) NOT NULL,\n                  `max_stars_5_pos` int(11) NOT NULL,\n                  `max_stars_5` int(11) NOT NULL,\n                  `question_options_1` varchar(250) NOT NULL,\n                  `question_options_1_items` text NOT NULL,\n                  `question_options_1_pos` int(11) NOT NULL,\n                  `question_options_2` varchar(250) NOT NULL,\n                  `question_options_2_items` text NOT NULL,\n                  `question_options_2_pos` int(11) NOT NULL,\n                  `question_options_3` varchar(250) NOT NULL,\n                  `question_options_3_items` text NOT NULL,\n                  `question_options_3_pos` int(11) NOT NULL,\n                  `question_options_4` varchar(250) NOT NULL,\n                  `question_options_4_items` text NOT NULL,\n                  `question_options_4_pos` int(11) NOT NULL,\n                  `question_options_5` varchar(250) NOT NULL,\n                  `question_options_5_items` text NOT NULL,\n                  `question_options_5_pos` int(11) NOT NULL,\n                  `question_plain_1` text NOT NULL,\n                  `question_plain_1_pos` int(11) NOT NULL,\n                  `question_plain_2` text NOT NULL,\n                  `question_plain_2_pos` int(11) NOT NULL,\n                  `question_plain_3` text NOT NULL,\n                  `question_plain_3_pos` int(11) NOT NULL,\n                  `question_plain_4` text NOT NULL,\n                  `question_plain_4_pos` int(11) NOT NULL,\n                  `question_plain_5` text NOT NULL,\n                  `question_plain_5_pos` int(11) NOT NULL,\n                  `max_stars_1_enabled` int(11) NOT NULL,\n                  `max_stars_2_enabled` int(11) NOT NULL,\n                  `max_stars_3_enabled` int(11) NOT NULL,\n                  `max_stars_4_enabled` int(11) NOT NULL,\n                  `max_stars_5_enabled` int(11) NOT NULL,\n                  `question_options_1_enabled` int(11) NOT NULL,\n                  `question_options_2_enabled` int(11) NOT NULL,\n                  `question_options_3_enabled` int(11) NOT NULL,\n                  `question_options_4_enabled` int(11) NOT NULL,\n                  `question_options_5_enabled` int(11) NOT NULL,\n                  `question_plain_1_enabled` int(11) NOT NULL,\n                  `question_plain_2_enabled` int(11) NOT NULL,\n                  `question_plain_3_enabled` int(11) NOT NULL,\n                  `question_plain_4_enabled` int(11) NOT NULL,\n                  `question_plain_5_enabled` int(11) NOT NULL,\n                  `max_stars_1` int(11) NOT NULL,\n                  `max_stars_1_req` int(11) NOT NULL,\n                  `max_stars_2_req` int(11) NOT NULL,\n                  `max_stars_3_req` int(11) NOT NULL,\n                  `max_stars_4_req` int(11) NOT NULL,\n                  `max_stars_5_req` int(11) NOT NULL,\n                  `question_options_1_req` int(11) NOT NULL,\n                  `question_options_2_req` int(11) NOT NULL,\n                  `question_options_3_req` int(11) NOT NULL,\n                  `question_options_4_req` int(11) NOT NULL,\n                  `question_options_5_req` int(11) NOT NULL,\n                  `question_plain_1_req` int(11) NOT NULL,\n                  `question_plain_2_req` int(11) NOT NULL,\n                  `question_plain_3_req` int(11) NOT NULL,\n                  `question_plain_4_req` int(11) NOT NULL,\n                  `question_plain_5_req` int(11) NOT NULL,\n                  `configuration` longtext NOT NULL,\n                  PRIMARY KEY (`id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            $db->query(\"CREATE TABLE `lh_admin_theme` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `name` varchar(100) NOT NULL,\n        \t       `static_content` longtext NOT NULL,\n        \t       `static_js_content` longtext NOT NULL,\n        \t       `static_css_content` longtext NOT NULL,\n        \t       `css_attributes` longtext NOT NULL,\n        \t       `header_content` text NOT NULL,\n        \t       `user_id` int(11) NOT NULL, \n        \t       `header_css` text NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `user_id` (`user_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            $db->query(\"CREATE TABLE `lh_chat_paid` ( \n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,  \n        \t       `hash` varchar(250) NOT NULL,  \n        \t       `chat_id` int(11) NOT NULL, \n        \t        PRIMARY KEY (`id`),  \n        \t       KEY `hash` (`hash`(191)),  \n        \t       KEY `chat_id` (`chat_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_survey_item` (\n        \t      `id` bigint(20) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `survey_id` int(11) NOT NULL,\n\t\t\t\t  `status` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `chat_id` int(11) NOT NULL,\n\t\t\t\t  `user_id` int(11) NOT NULL,\n\t\t\t\t  `ftime` int(11) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `max_stars_1` int(11) NOT NULL,\n\t\t\t\t  `max_stars_2` int(11) NOT NULL,\n\t\t\t\t  `max_stars_3` int(11) NOT NULL,\n\t\t\t\t  `max_stars_4` int(11) NOT NULL,\n\t\t\t\t  `max_stars_5` int(11) NOT NULL,\n\t\t\t\t  `question_options_1` int(11) NOT NULL,\n\t\t\t\t  `question_options_2` int(11) NOT NULL,\n\t\t\t\t  `question_options_3` int(11) NOT NULL,\n\t\t\t\t  `question_options_4` int(11) NOT NULL,\n\t\t\t\t  `question_options_5` int(11) NOT NULL,\n\t\t\t\t  `question_plain_1` text NOT NULL,\n\t\t\t\t  `question_plain_2` text NOT NULL,\n\t\t\t\t  `question_plain_3` text NOT NULL,\n\t\t\t\t  `question_plain_4` text NOT NULL,\n\t\t\t\t  `question_plain_5` text NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `survey_id` (`survey_id`),\n\t\t\t\t  KEY `chat_id` (`chat_id`),\n\t\t\t\t  KEY `user_id` (`user_id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `ftime` (`ftime`),\n\t\t\t\t  KEY `max_stars_1` (`max_stars_1`),\n\t\t\t\t  KEY `max_stars_2` (`max_stars_2`),\n\t\t\t\t  KEY `max_stars_3` (`max_stars_3`),\n\t\t\t\t  KEY `max_stars_4` (`max_stars_4`),\n\t\t\t\t  KEY `max_stars_5` (`max_stars_5`),\n\t\t\t\t  KEY `question_options_1` (`question_options_1`),\n\t\t\t\t  KEY `question_options_2` (`question_options_2`),\n\t\t\t\t  KEY `question_options_3` (`question_options_3`),\n\t\t\t\t  KEY `question_options_4` (`question_options_4`),\n\t\t\t\t  KEY `question_options_5` (`question_options_5`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_speech_language` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `name` varchar(100) NOT NULL,\n                  `siteaccess` varchar(3) NOT NULL DEFAULT '',\n                  PRIMARY KEY (`id`)\n               ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_speech_language_dialect` (\n                `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `language_id` int(11) NOT NULL,\n                  `lang_name` varchar(100) NOT NULL,\n                  `lang_code` varchar(100) NOT NULL,\n                  `short_code` varchar(4) NOT NULL DEFAULT '',\n                  PRIMARY KEY (`id`),\n                  KEY `language_id` (`language_id`),\n                  KEY `short_code` (`short_code`),\n                  KEY `lang_code` (`lang_code`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"INSERT INTO `lh_speech_language` (`id`, `name`, `siteaccess`) VALUES\n\t\t\t\t(1,\t'Afrikaans',''),\n\t\t\t\t(2,\t'Bahasa Indonesia',''),\n\t\t\t\t(3,\t'Bahasa Melayu',''),\n\t\t\t\t(4,\t'Catal\u00e0',''),\n\t\t\t\t(5,\t'\u010ce\u0161tina',''),\n\t\t\t\t(6,\t'Deutsch','ger'),\n\t\t\t\t(7,\t'English',''),\n\t\t\t\t(8,\t'Espa\u00f1ol','esp'),\n\t\t\t\t(9,\t'Euskara',''),\n\t\t\t\t(10,\t'Fran\u00e7ais','fre'),\n\t\t\t\t(11,\t'Galego',''),\n\t\t\t\t(12,\t'Hrvatski',''),\n\t\t\t\t(13,\t'IsiZulu',''),\n\t\t\t\t(14,\t'\u00cdslenska',''),\n\t\t\t\t(15,\t'Italiano','ita'),\n\t\t\t\t(16,\t'Magyar',''),\n\t\t\t\t(17,\t'Nederlands','nld'),\n\t\t\t\t(18,\t'Norsk bokm\u00e5l',''),\n\t\t\t\t(19,\t'Polski','pol'),\n\t\t\t\t(20,\t'Portugu\u00eas','por'),\n\t\t\t\t(21,\t'Rom\u00e2n\u0103',''),\n\t\t\t\t(22,\t'Sloven\u010dina',''),\n\t\t\t\t(23,\t'Suomi','fin'),\n\t\t\t\t(24,\t'Svenska',''),\n\t\t\t\t(25,\t'T\u00fcrk\u00e7e','tur'),\n\t\t\t\t(26,\t'\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438',''),\n\t\t\t\t(27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439','rus'),\n\t\t\t\t(28,\t'\u0421\u0440\u043f\u0441\u043a\u0438',''),\n\t\t\t\t(29,\t'\ud55c\uad6d\uc5b4',''),\n\t\t\t\t(30,\t'\u4e2d\u6587',''),\n\t\t\t\t(31,\t'\u65e5\u672c\u8a9e',''),\n\t\t\t\t(32,\t'Lingua lat\u012bna',''),\n\t\t\t\t(33,\t'Lithuanian','lit'),\n\t\t\t\t(34,\t'Latvia',''),\n\t\t\t\t(35,\t'Afar',''),\n\t\t\t\t(36,\t'Arabic',''),\n\t\t\t\t(37,\t'Assamese',''),\n\t\t\t\t(38,\t'Azerbaijani',''),\n\t\t\t\t(39,\t'Bulgarian','bgr'),\n\t\t\t\t(40,\t'Bangla',''),\n\t\t\t\t(41,\t'Bosnian',''),\n\t\t\t\t(42,\t'Cakchiquel',''),\n\t\t\t\t(43,\t'Danish',''),\n\t\t\t\t(44,\t'Greek',''),\n\t\t\t\t(45,\t'Estonian',''),\n\t\t\t\t(46,\t'Persian',''),\n\t\t\t\t(47,\t'Filipino',''),\n\t\t\t\t(48,\t'Gujarati',''),\n\t\t\t\t(49,\t'Hebrew',''),\n\t\t\t\t(50,\t'Croatian',''),\n\t\t\t\t(51,\t'Indonesia',''),\n\t\t\t\t(52,\t'Icelandic',''),\n\t\t\t\t(53,\t'Georgian',''),\n\t\t\t\t(54,\t'Maori (New Zealand)',''),\n\t\t\t\t(55,\t'Macedonian',''),\n\t\t\t\t(56,\t'Malay (Latin)',''),\n\t\t\t\t(57,\t'Maltese',''),\n\t\t\t\t(58,\t'Norwegian Nynorsk',''),\n\t\t\t\t(59,\t'Norwegian','nor'),\n\t\t\t\t(60,\t'Northern Sotho (South Africa)',''),\n\t\t\t\t(61,\t'Slovenian',''),\n\t\t\t\t(63,\t'Thai',''),\n\t\t\t\t(64,\t'Tagalog',''),\n\t\t\t\t(65,\t'Tongan',''),\n\t\t\t\t(66,\t'Ukrainian',''),\n\t\t\t\t(67,\t'Vietnamese','vnm'),\n\t\t\t\t(68,\t'Chinese','chn');\");\n\n            $db->query(\"INSERT INTO `lh_speech_language_dialect` (`id`, `language_id`, `lang_name`, `lang_code`, `short_code`) VALUES\n(1,\t1,\t'Afrikaans',\t'af-ZA',\t'af'),\n(2,\t2,\t'Bahasa Indonesia',\t'id-ID',\t'id'),\n(3,\t3,\t'Bahasa Melayu',\t'ms-MY',\t''),\n(4,\t4,\t'Catal\u00e0',\t'ca-ES',\t''),\n(5,\t5,\t'\u010ce\u0161tina',\t'cs-CZ',\t'cs'),\n(6,\t6,\t'Deutsch',\t'de-DE',\t'de'),\n(7,\t7,\t'Australia',\t'en-AU',\t''),\n(8,\t7,\t'Canada',\t'en-CA',\t''),\n(9,\t7,\t'India',\t'en-IN',\t''),\n(10,\t7,\t'New Zealand',\t'en-NZ',\t''),\n(11,\t7,\t'South Africa',\t'en-ZA',\t''),\n(12,\t7,\t'United Kingdom',\t'en-GB',\t'en'),\n(13,\t7,\t'United States',\t'en-US',\t''),\n(14,\t8,\t'Argentina',\t'es-AR',\t''),\n(15,\t8,\t'Bolivia',\t'es-BO',\t''),\n(16,\t8,\t'Chile',\t'es-CL',\t''),\n(17,\t8,\t'Colombia',\t'es-CO',\t''),\n(18,\t8,\t'Costa Rica',\t'es-CR',\t''),\n(19,\t8,\t'Ecuador',\t'es-EC',\t''),\n(20,\t8,\t'El Salvador',\t'es-SV',\t''),\n(21,\t8,\t'Espa\u00f1a',\t'es-ES',\t'es'),\n(22,\t8,\t'Estados Unidos',\t'es-US',\t''),\n(23,\t8,\t'Guatemala',\t'es-GT',\t''),\n(24,\t8,\t'Honduras',\t'es-HN',\t''),\n(25,\t8,\t'M\u00e9xico',\t'es-MX',\t''),\n(26,\t8,\t'Nicaragua',\t'es-NI',\t''),\n(27,\t8,\t'Panam\u00e1',\t'es-PA',\t''),\n(28,\t8,\t'Paraguay',\t'es-PY',\t''),\n(29,\t8,\t'Per\u00fa',\t'es-PE',\t''),\n(30,\t8,\t'Puerto Rico',\t'es-PR',\t''),\n(31,\t8,\t'Rep\u00fablica Dominicana',\t'es-DO',\t''),\n(32,\t8,\t'Uruguay',\t'es-UY',\t''),\n(33,\t8,\t'Venezuela',\t'es-VE',\t''),\n(34,\t9,\t'Euskara',\t'eu-ES',\t''),\n(35,\t10,\t'Fran\u00e7ais',\t'fr-FR',\t'fr'),\n(36,\t11,\t'Galego',\t'gl-ES',\t''),\n(37,\t12,\t'Hrvatski',\t'hr_HR',\t''),\n(38,\t13,\t'IsiZulu',\t'zu-ZA',\t''),\n(39,\t14,\t'\u00cdslenska',\t'is-IS',\t''),\n(40,\t15,\t'Italia',\t'it-IT',\t'it'),\n(41,\t15,\t'Svizzera',\t'it-CH',\t'it'),\n(42,\t16,\t'Magyar',\t'hu-HU',\t'hu'),\n(43,\t17,\t'Nederlands',\t'nl-NL',\t'nl'),\n(44,\t18,\t'Norsk bokm\u00e5l',\t'nb-NO',\t'nb'),\n(45,\t19,\t'Polski',\t'pl-PL',\t'pl'),\n(46,\t20,\t'Brasil',\t'pt-BR',\t''),\n(47,\t20,\t'Portugal',\t'pt-PT',\t'pt'),\n(48,\t21,\t'Rom\u00e2n\u0103',\t'ro-RO',\t'ro'),\n(49,\t22,\t'Sloven\u010dina',\t'sk-SK',\t'sk'),\n(50,\t23,\t'Suomi',\t'fi-FI',\t'fi'),\n(51,\t24,\t'Swedish',\t'sv-SE',\t'sv'),\n(52,\t25,\t'T\u00fcrk\u00e7e',\t'tr-TR',\t'tr'),\n(53,\t26,\t'\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438',\t'bg-BG',\t''),\n(54,\t27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439',\t'ru-RU',\t'ru'),\n(55,\t28,\t'Serbian',\t'sr-RS',\t'sr'),\n(56,\t29,\t'\ud55c\uad6d\uc5b4',\t'ko-KR',\t'ko'),\n(57,\t30,\t'\u666e\u901a\u8bdd (\u4e2d\u56fd\u5927\u9646)',\t'cmn-Hans-CN',\t''),\n(58,\t30,\t'\u666e\u901a\u8bdd (\u9999\u6e2f)',\t'cmn-Hans-HK',\t''),\n(59,\t30,\t'\u4e2d\u6587 (\u53f0\u7063)',\t'cmn-Hant-TW',\t''),\n(60,\t30,\t'\u7cb5\u8a9e (\u9999\u6e2f)',\t'yue-Hant-HK',\t''),\n(61,\t31,\t'\u65e5\u672c\u8a9e',\t'ja-JP',\t'ja'),\n(62,\t32,\t'Lingua lat\u012bna',\t'la',\t''),\n(64,\t33,\t'Lithuanian',\t'lt-LT',\t'lt'),\n(65,\t34,\t'Latvia',\t'lv-LV',\t'lv'),\n(66,\t35,\t'Afar',\t'aa-DJ',\t'aa'),\n(67,\t36,\t'Egypt',\t'ar-EG',\t'ar'),\n(68,\t37,\t'India',\t'as-IN',\t'as'),\n(69,\t38,\t'Azerbaijani',\t'az-AZ',\t'az'),\n(70,\t39,\t'Bulgarian',\t'bg',\t'bg'),\n(71,\t40,\t'Bangla',\t'bn',\t'bn'),\n(72,\t41,\t'Bosnian',\t'bs-BA',\t'bs'),\n(73,\t42,\t'Cakchiquel',\t'cak',\t'cak'),\n(74,\t43,\t'Danish',\t'da-dk',\t'da'),\n(75,\t44,\t'Greek',\t'el-GR',\t'el'),\n(76,\t45,\t'Estonian',\t'et-EE',\t'et'),\n(77,\t46,\t'Persian',\t'fa-IR',\t'fa'),\n(78,\t47,\t'Filipino',\t'fil',\t'fil'),\n(79,\t48,\t'Gujarati',\t'gu-IN',\t'gu'),\n(80,\t49,\t'Hebrew',\t'he',\t'he'),\n(81,\t50,\t'Croatian',\t'hr-HR',\t'hr'),\n(82,\t51,\t'Indonesia',\t'in',\t'in'),\n(83,\t52,\t'Icelandic',\t'is',\t'is'),\n(84,\t53,\t'Georgian',\t'ka-ge',\t'ka'),\n(85,\t54,\t'Maori (New Zealand)',\t'mi-nz',\t'mi'),\n(86,\t55,\t'Macedonian',\t'mk-MK',\t'mk'),\n(87,\t56,\t'Malay (Latin)',\t'ms',\t'ms'),\n(88,\t57,\t'Maltese',\t'mt',\t'mt'),\n(89,\t58,\t'Norwegian Nynorsk',\t'nn-NO',\t'nn'),\n(90,\t59,\t'Norwegian',\t'no',\t'no'),\n(91,\t60,\t'Northern Sotho (South Africa)',\t'nso-za',\t'nso'),\n(92,\t61,\t'Slovenian',\t'sl-SI',\t'sl'),\n(94,\t63,\t'Thai',\t'th-TH',\t'th'),\n(95,\t64,\t'Tagalog',\t'tl',\t'tl'),\n(96,\t65,\t'Tongan',\t'to-TO',\t'to'),\n(97,\t66,\t'Ukrainian',\t'uk-UA',\t'uk'),\n(98,\t67,\t'Vietnamese',\t'vi-VN',\t'vi'),\n(99,\t68,\t'Chinese',\t'zh-CN',\t'zh'),\n(100,\t36,\t'Egypt',\t'ar-AE',\t''),\n(101,\t36,\t'Egypt',\t'ar-IQ',\t''),\n(102,\t41,\t'Bosnian',\t'bs-Latn-BA',\t''),\n(103,\t6,\t'Deutsch',\t'de-at',\t''),\n(104,\t6,\t'Deutsch',\t'de-ch',\t''),\n(105,\t6,\t'Deutsch',\t'de-GB',\t''),\n(106,\t6,\t'Deutsch',\t'de-LI',\t''),\n(107,\t6,\t'Deutsch',\t'de-LU',\t''),\n(108,\t7,\t'United Kingdom',\t'en-029',\t''),\n(109,\t7,\t'United Kingdom',\t'en-AS',\t''),\n(110,\t7,\t'United Kingdom',\t'en-BE',\t''),\n(111,\t7,\t'United Kingdom',\t'en-BM',\t''),\n(112,\t7,\t'United Kingdom',\t'en-BS',\t''),\n(113,\t7,\t'United Kingdom',\t'en-BW',\t''),\n(114,\t7,\t'United Kingdom',\t'en-CH',\t''),\n(115,\t7,\t'United Kingdom',\t'en-CX',\t''),\n(116,\t7,\t'United Kingdom',\t'en-CY',\t''),\n(117,\t7,\t'United Kingdom',\t'en-DE',\t''),\n(118,\t7,\t'United Kingdom',\t'en-DK',\t''),\n(119,\t7,\t'United Kingdom',\t'en-DM',\t''),\n(120,\t7,\t'United Kingdom',\t'en-GY',\t''),\n(121,\t7,\t'United Kingdom',\t'en-HK',\t''),\n(122,\t7,\t'United Kingdom',\t'en-ie',\t''),\n(123,\t7,\t'United Kingdom',\t'en-IM',\t''),\n(124,\t7,\t'United Kingdom',\t'en-JM',\t''),\n(125,\t7,\t'United Kingdom',\t'en-KY',\t''),\n(126,\t7,\t'United Kingdom',\t'en-MY',\t''),\n(127,\t7,\t'United Kingdom',\t'en-NF',\t''),\n(128,\t7,\t'United Kingdom',\t'en-NG',\t''),\n(129,\t7,\t'United Kingdom',\t'en-NL',\t''),\n(130,\t7,\t'United Kingdom',\t'en-PH',\t''),\n(131,\t7,\t'United Kingdom',\t'en-SE',\t''),\n(132,\t7,\t'United Kingdom',\t'en-sg',\t''),\n(133,\t7,\t'United Kingdom',\t'en-SI',\t''),\n(134,\t7,\t'United Kingdom',\t'en-SS',\t''),\n(135,\t7,\t'United Kingdom',\t'en-TO',\t''),\n(136,\t7,\t'United Kingdom',\t'en-TZ',\t''),\n(137,\t7,\t'United Kingdom',\t'en-UG',\t''),\n(138,\t7,\t'United Kingdom',\t'en-UK',\t''),\n(139,\t7,\t'United Kingdom',\t'en-ZG',\t''),\n(140,\t7,\t'United Kingdom',\t'en-ZM',\t''),\n(141,\t7,\t'United Kingdom',\t'en-ZW',\t''),\n(142,\t8,\t'Espa\u00f1a',\t'es-419',\t''),\n(143,\t8,\t'Espa\u00f1a',\t'es-xl',\t''),\n(144,\t47,\t'Filipino',\t'fil-PH',\t''),\n(145,\t10,\t'Fran\u00e7ais',\t'fr-BE',\t''),\n(146,\t10,\t'Fran\u00e7ais',\t'fr-ca',\t''),\n(147,\t10,\t'Fran\u00e7ais',\t'fr-ch',\t''),\n(148,\t10,\t'Fran\u00e7ais',\t'fr-CM',\t''),\n(149,\t10,\t'Fran\u00e7ais',\t'fr-MC',\t''),\n(150,\t49,\t'Hebrew',\t'he-IL',\t''),\n(151,\t50,\t'Croatian',\t'hr-BA',\t''),\n(152,\t17,\t'Nederlands',\t'nl-BE',\t''),\n(153,\t19,\t'Polski',\t'pl-GB',\t''),\n(154,\t27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439',\t'ru-KZ',\t''),\n(155,\t27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439',\t'ru-UA',\t''),\n(156,\t28,\t'Serbian',\t'sr-BA',\t''),\n(157,\t28,\t'Serbian',\t'sr-Latn-RS',\t''),\n(158,\t68,\t'Chinese',\t'zh-MO',\t''),\n(159,\t68,\t'Chinese',\t'zh-SG',\t''),\n(160,\t68,\t'Chinese',\t'zh-TW',\t'');\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_speech_chat_language` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `chat_id` int(11) NOT NULL,\n                  `language_id` int(11) NOT NULL,\n                  `dialect` varchar(50) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `chat_id` (`chat_id`)\n               ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_file` (\n        \t   `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n        \t   `name` varchar(255) NOT NULL,\n        \t   `upload_name` varchar(255) NOT NULL,\n        \t   `size` int(11) NOT NULL,\n        \t   `type` varchar(255) NOT NULL,\n        \t   `file_path` varchar(255) NOT NULL,\n        \t   `extension` varchar(255) NOT NULL,\n        \t   `chat_id` bigint(20) NOT NULL,\n        \t   `persistent` int(11) NOT NULL,\n        \t   `online_user_id` int(11) NOT NULL,\n        \t   `user_id` int(11) NOT NULL,\n        \t   `date` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `chat_id` (`chat_id`),\n        \t   KEY `online_user_id` (`online_user_id`),\n        \t   KEY `user_id` (`user_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_email_template` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `name` varchar(250) NOT NULL,\n\t\t\t\t  `from_name` varchar(150) NOT NULL,\n\t\t\t\t  `from_name_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `from_email` varchar(150) NOT NULL,\n\t\t\t\t  `from_email_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `user_mail_as_sender` tinyint(4) NOT NULL,\n\t\t\t\t  `content` text NOT NULL,\n\t\t\t\t  `use_chat_locale` tinyint(1) NOT NULL DEFAULT '0',\n                  `translations` longtext NOT NULL,\n\t\t\t\t  `subject` varchar(250) NOT NULL,\n\t\t\t\t  `bcc_recipients` varchar(200) NOT NULL,\n\t\t\t\t  `subject_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `reply_to` varchar(150) NOT NULL,\n\t\t\t\t  `reply_to_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `recipient` varchar(150) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"INSERT INTO `lh_abstract_email_template` (`id`, `translations`, `name`, `from_name`, `from_name_ac`, `from_email`, `from_email_ac`, `content`, `subject`, `subject_ac`, `reply_to`, `reply_to_ac`, `recipient`, `bcc_recipients`, `user_mail_as_sender`) VALUES\n            \t   (1,'',\t'Send mail to user',\t'Live Helper Chat',\t0,\t'',\t0,\t'Dear {user_chat_nick},\\r\\n\\r\\n{additional_message}\\r\\n\\r\\nLive Support response:\\r\\n{messages_content}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team\\r\\n',\t'{name_surname} has responded to your request',\t1,\t'',\t1,\t'',\t'',\t0),\n            \t   (2,'',\t'Support request from user',\t'',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nAdditional data, if any:\\r\\n{additional_data}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nLink to chat if any:\\r\\n{prefillchat}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'{name}, {country}, {department}, Support request from user',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (3,'',\t'User mail for himself',\t'Live Helper Chat',\t0,\t'',\t0,\t'Dear {user_chat_nick},\\r\\n\\r\\nTranscript:\\r\\n{messages_content}\\r\\nChat ID: {chat_id}\\n\\r\\nSincerely,\\r\\nLive Support Team\\r\\n',\t'Chat transcript',\t0,\t'',\t0,\t'',\t'',\t0),\n            \t   (4,'',\t'New chat request',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nClick to accept chat automatically\\r\\n{url_accept}\\r\\n\\r\\nSurvey\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'New chat request',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (5,'',\t'Chat was closed',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\n{operator} has closed a chat\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nAdditional data, if any:\\r\\n{additional_data}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nSurvey:\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Chat was closed',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (6,'',\t'New FAQ question',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nNew FAQ question\\r\\nEmail: {email}\\r\\n\\r\\nQuestion:\\r\\n{question}\\r\\n\\r\\nQuestion URL:\\r\\n{url_question}\\r\\n\\r\\nURL to answer a question:\\r\\n{url_request}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'New FAQ question',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (7,'',\t'New unread message',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nClick to accept chat automatically\\r\\n{url_accept}\\r\\n\\r\\nSurvey:\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'New unread message',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (8,'',\t'Filled form',\t'MCFC',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser has filled a form\\r\\nForm name - {form_name}\\r\\nUser IP - {ip}\\r\\nDownload filled data - {url_download}\\r\\nView filled data - {url_view}\\r\\n\\r\\n{content}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Filled form - {form_name}',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (9,'',\t'Chat was accepted',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nOperator {user_name} has accepted a chat [{chat_id}]\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nClick to accept chat automatically\\r\\n{url_accept}\\r\\n\\r\\nSurvey:\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Chat was accepted [{chat_id}]',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (10,'',\t'Permission request',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nOperator {user} has requested these permissions\\n\\r\\n{permissions}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Permission request from {user}',\t0,\t'',\t0,\t'',\t'',\t0),\n            \t   (11,'',\t'You have unread messages',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nOperator {operator} has answered to you\\r\\n\\r\\n{messages}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Operator has answered to your request',\t0,\t'',\t0,\t'',\t'',\t0),\n            \t   (12,'',\t'Visitor returned',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nVisitor information\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nSee more information at\\r\\n{url_accept}\\r\\n\\r\\nLast chat:\\r\\n{message}\\r\\n\\r\\nAdditional data, if any:\\r\\n{additional_data}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Visitor returned - {username}',\t0,\t'',\t0,\t'',\t'',\t0);\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `question` varchar(250) NOT NULL,\n        \t   `location` varchar(250) NOT NULL,\n        \t   `active` int(11) NOT NULL,\n        \t   `priority` int(11) NOT NULL,\n        \t   `is_voting` int(11) NOT NULL,\n        \t   `question_intro` text NOT NULL,\n        \t   `revote` int(11) NOT NULL DEFAULT '0',\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `priority` (`priority`),\n        \t   KEY `active_priority` (`active`,`priority`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question_answer` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `ip` bigint(20) NOT NULL,\n        \t   `question_id` int(11) NOT NULL,\n        \t   `answer` text NOT NULL,\n        \t   `ctime` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `ip` (`ip`),\n        \t   KEY `question_id` (`question_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question_option` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `question_id` int(11) NOT NULL,\n        \t   `option_name` varchar(250) NOT NULL,\n        \t   `priority` tinyint(4) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `question_id` (`question_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question_option_answer` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `question_id` int(11) NOT NULL,\n        \t   `option_id` int(11) NOT NULL,\n        \t   `ctime` int(11) NOT NULL,\n        \t   `ip` bigint(20) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `question_id` (`question_id`),\n        \t   KEY `ip` (`ip`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_product` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT, \n        \t       `name` varchar(250) NOT NULL, \n        \t       `disabled` int(11) NOT NULL, \n        \t       `priority` int(11) NOT NULL, \n        \t       `departament_id` int(11) NOT NULL, \n        \t       KEY `departament_id` (`departament_id`), \n        \t       PRIMARY KEY (`id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_browse_offer_invitation` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `siteaccess` varchar(10) NOT NULL,\n\t\t\t\t  `time_on_site` int(11) NOT NULL,\n\t\t\t\t  `content` longtext NOT NULL,\n\t\t\t\t  `callback_content` longtext NOT NULL,\n\t\t\t\t  `lhc_iframe_content` tinyint(4) NOT NULL,\n\t\t\t\t  `custom_iframe_url` varchar(250) NOT NULL,\n\t\t\t\t  `name` varchar(250) NOT NULL,\n\t\t\t\t  `identifier` varchar(50) NOT NULL,\n\t\t\t\t  `executed_times` int(11) NOT NULL,\n\t\t\t\t  `url` varchar(250) NOT NULL,\n\t\t\t\t  `active` int(11) NOT NULL,\n\t\t\t\t  `has_url` int(11) NOT NULL,\n\t\t\t\t  `is_wildcard` int(11) NOT NULL,\n\t\t\t\t  `referrer` varchar(250) NOT NULL,\n\t\t\t\t  `priority` varchar(250) NOT NULL,\n\t\t\t\t  `hash` varchar(40) NOT NULL,\n\t\t\t\t  `width` int(11) NOT NULL,\n\t\t\t\t  `height` int(11) NOT NULL,\n\t\t\t\t  `unit` varchar(10) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `active` (`active`),\n\t\t\t\t  KEY `identifier` (`identifier`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_form` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `name` varchar(100) NOT NULL,        \t   \n        \t   `content` longtext NOT NULL,\n        \t   `recipient` varchar(250) NOT NULL,\n        \t   `active` int(11) NOT NULL,\n        \t   `name_attr` varchar(250) NOT NULL,\n        \t   `intro_attr` varchar(250) NOT NULL,\n        \t   `xls_columns` text NOT NULL,\n        \t   `pagelayout` varchar(200) NOT NULL,\n        \t   `post_content` text NOT NULL,\n        \t   PRIMARY KEY (`id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_form_collected` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `form_id` int(11) NOT NULL,\n\t\t\t\t  `ctime` int(11) NOT NULL,\n\t\t\t\t  `ip` varchar(250) NOT NULL,\n        \t   \t  `identifier` varchar(250) NOT NULL,\n        \t   \t  `chat_id` bigint(20) NOT NULL,\n\t\t\t\t  `content` longtext NOT NULL,\n\t\t\t\t  `custom_fields` longtext NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `form_id` (`form_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chatbox` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `identifier` varchar(50) NOT NULL,\n\t\t\t\t  `name` varchar(100) NOT NULL,\n\t\t\t\t  `chat_id` int(11) NOT NULL,\n\t\t\t\t  `active` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `identifier` (`identifier`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_chat_action` (\n                `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `chat_id` bigint(20) NOT NULL,\n                  `action` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `body` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `created_at` bigint(20) unsigned NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `chat_id` (`chat_id`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_canned_msg` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `msg` longtext NOT NULL,\n                  `fallback_msg` text NOT NULL,\n                  `title` varchar(250) NOT NULL,\n                  `explain` varchar(250) NOT NULL,\n                  `languages` text NOT NULL,\n                  `additional_data` text NOT NULL,\n        \t   \t  `position` int(11) NOT NULL,\n                  `disabled` tinyint(1) unsigned NOT NULL NULL DEFAULT 0,\n        \t   \t  `department_id` int(11) NOT NULL,\n        \t   \t  `user_id` int(11) NOT NULL,\n  \t\t\t\t  `delay` int(11) NOT NULL,\n        \t   \t  `auto_send` tinyint(1) NOT NULL,\n        \t   \t  `html_snippet` longtext NOT NULL,\n        \t   \t  `attr_int_1` int(11) NOT NULL,\n        \t   \t  `attr_int_2` int(11) NOT NULL,\n        \t   \t  `attr_int_3` int(11) NOT NULL,\n                  `unique_id` varchar(20) NOT NULL,\n                  `updated_at` int(11) unsigned NOT NULL DEFAULT 0,\n                  `created_at` int(11) unsigned NOT NULL DEFAULT 0,\n                  `active_from` int(11) unsigned NOT NULL DEFAULT 0,\n                  `active_to` int(11) unsigned NOT NULL DEFAULT 0,\n                  `repetitiveness` int(11) unsigned NOT NULL DEFAULT 0,\n                  `days_activity` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                  PRIMARY KEY (`id`),\n        \t   \t  KEY `department_id` (`department_id`),\n        \t   \t  KEY `disabled` (`disabled`),\n        \t   \t  KEY `attr_int_1` (`attr_int_1`),\n        \t   \t  KEY `attr_int_2` (`attr_int_2`),\n        \t   \t  KEY `attr_int_3` (`attr_int_3`),\n        \t   \t  KEY `position_title_v2` (`position`, `title`(191)),\n        \t   \t  KEY `user_id` (`user_id`),\n        \t   \t  KEY `unique_id` (`unique_id`),\n                  KEY `repetitiveness` (`repetitiveness`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_online_user_footprint` (\n\t\t\t\t  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `chat_id` bigint(20) NOT NULL,\n\t\t\t\t  `online_user_id` int(11) NOT NULL,\n\t\t\t\t  `page` varchar(2083) NOT NULL,\n\t\t\t\t  `vtime` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `chat_id` (`chat_id`),\n\t\t\t\t  KEY `online_user_id` (`online_user_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_invitation_dep` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n    `invitation_id` int(11) NOT NULL,\n    `dep_id` int(11) NOT NULL,\n    PRIMARY KEY (`id`),\n    KEY `invitation_id` (`invitation_id`),\n    KEY `dep_id` (`dep_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_event` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `vid_id` int(11) NOT NULL,\n        \t       `ev_id` int(11) NOT NULL,\n        \t       `ts` int(11) NOT NULL,\n        \t       `val` varchar(50) NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `vid_id_ev_id_val_ts` (`vid_id`,`ev_id`,`val`,`ts`),\n        \t       KEY `vid_id_ev_id_ts` (`vid_id`,`ev_id`,`ts`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_invitation_event` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `invitation_id` int(11) NOT NULL,\n        \t       `event_id` int(11) NOT NULL,\n        \t       `min_number` int(11) NOT NULL,\n        \t       `during_seconds` int(11) NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `invitation_id` (`invitation_id`),\n        \t       KEY `event_id` (`event_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_variables` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `name` varchar(50) NOT NULL,\n        \t       `identifier` varchar(50) NOT NULL,\n        \t       `store_timeout` int(11) NOT NULL,\n        \t       `filter_val` int(11) NOT NULL DEFAULT '0',\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `identifier` (`identifier`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_campaign` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL, `text` text NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_abstract_chat_alert_icon` (`id` bigint(20) NOT NULL AUTO_INCREMENT,`name` varchar(50) NOT NULL, `identifier` varchar(50) NOT NULL,PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_campaign_conv` (\n                  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `device_type` tinyint(11) NOT NULL,\n\t\t\t\t  `invitation_type` tinyint(1) NOT NULL,\n\t\t\t\t  `invitation_status` tinyint(1) NOT NULL,\n\t\t\t\t  `chat_id` bigint(20) NOT NULL,\n\t\t\t\t  `campaign_id` int(11) NOT NULL,\n\t\t\t\t  `invitation_id` int(11) NOT NULL,\n\t\t\t\t  `department_id` int(11) NOT NULL,\n\t\t\t\t  `ctime` int(11) NOT NULL,\n\t\t\t\t  `con_time` int(11) NOT NULL,\n\t\t\t\t  `vid_id` bigint(20) DEFAULT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `ctime` (`ctime`),\n\t\t\t\t  KEY `campaign_id` (`campaign_id`),\n\t\t\t\t  KEY `invitation_id` (`invitation_id`),\n\t\t\t\t  KEY `invitation_status` (`invitation_status`)\n\t\t\t\t) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users_setting` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `user_id` int(11) NOT NULL,\n        \t   `identifier` varchar(50) NOT NULL,\n        \t   `value` text NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `user_id` (`user_id`,`identifier`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_departament_limit_group_member` (  \n    \t       `id` int(11) NOT NULL AUTO_INCREMENT,  \n    \t       `dep_id` int(11) NOT NULL,  \n    \t       `dep_limit_group_id` int(11) NOT NULL,  \n    \t       PRIMARY KEY (`id`),  \n    \t       KEY `dep_limit_group_id` (`dep_limit_group_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_departament_limit_group` (  \n    \t       `id` int(11) NOT NULL AUTO_INCREMENT,  \n    \t       `name` varchar(50) NOT NULL,\n    \t       `pending_max` int(11) NOT NULL,  \n    \t       PRIMARY KEY (`id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_auto_responder_chat` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `chat_id` int(11) NOT NULL,\n                  `auto_responder_id` int(11) NOT NULL,\n                  `wait_timeout_send` int(11) NOT NULL,\n                  `pending_send_status` int(11) NOT NULL,\n                  `active_send_status` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `chat_id` (`chat_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users_setting_option` (\n\t\t\t\t  `identifier` varchar(50) NOT NULL,\n\t\t\t\t  `class` varchar(50) NOT NULL,\n\t\t\t\t  `attribute` varchar(40) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`identifier`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"INSERT INTO `lh_users_setting_option` (`identifier`, `class`, `attribute`) VALUES\n        \t   ('chat_message',\t'',\t''),\n        \t   ('new_chat_sound',\t'',\t''),\n        \t   ('enable_pending_list', '', ''),\n        \t   ('enable_active_list', '', ''),\n        \t   ('enable_close_list', '', ''),\n        \t   ('new_user_bn', '', ''),\n        \t   ('new_user_sound', '', ''),\n        \t   ('oupdate_timeout', '', ''),\n        \t   ('ouser_timeout', '', ''),\n        \t   ('o_department', '', ''),\n        \t   ('omax_rows', '', ''),\n        \t   ('ogroup_by', '', ''),\n        \t   ('omap_depid', '', ''),\n        \t   ('omap_mtimeout', '', ''),\n        \t   ('ocountry', '', ''),\n        \t   ('otime_on_site', '', ''),\n        \t   ('dwo', '', ''),\n        \t   ('enable_unread_list', '', '')\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_config` (\n                  `identifier` varchar(50) NOT NULL,\n                  `value` text NOT NULL,\n                  `type` tinyint(1) NOT NULL DEFAULT '0',\n                  `explain` varchar(250) NOT NULL,\n                  `hidden` int(11) NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`identifier`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $randomHash = erLhcoreClassModelForgotPassword::randomPassword(9);\n            $randomHashLength = strlen($randomHash);\n            $exportHash = erLhcoreClassModelForgotPassword::randomPassword(9);\n\n            if (extension_loaded('bcmath')){\n                $geoRow = \"('geo_data','a:5:{i:0;b:0;s:21:\\\"geo_detection_enabled\\\";i:1;s:22:\\\"geo_service_identifier\\\";s:8:\\\"max_mind\\\";s:23:\\\"max_mind_detection_type\\\";s:7:\\\"country\\\";s:22:\\\"max_mind_city_location\\\";s:37:\\\"var/external/geoip/GeoLite2-City.mmdb\\\";}',0,'',1)\";\n            } else {\n                $geoRow = \"('geo_data', '', '0', '', '1')\";\n            }\n\n            $db->query(\"INSERT INTO `lh_chat_config` (`identifier`, `value`, `type`, `explain`, `hidden`) VALUES\n                ('tracked_users_cleanup',\t'160',\t0,\t'How many days keep records of online users.',\t0),\n        \t   \t('list_online_operators', '1', '0', 'List online operators.', '0'),\n        \t   \t('voting_days_limit',\t'7',\t0,\t'How many days voting widget should not be expanded after last show',\t0),\n                ('track_online_visitors',\t'1',\t0,\t'Enable online site visitors tracking',\t0),\n        \t   \t('pro_active_invite',\t'1',\t0,\t'Is pro active chat invitation active. Online users tracking also has to be enabled',\t0),\n                ('customer_company_name',\t'Live Helper Chat',\t0,\t'Your company name - visible in bottom left corner',\t0),\n                ('customer_site_url',\t'http://livehelperchat.com',\t0,\t'Your site URL address',\t0),\n                ('transfer_configuration','0','0','Transfer configuration','1'),\n                ('list_unread','0','0','List unread chats','0'),\n                ('autoclose_abandon_pending','0,0','0','Automatically close pending chats where visitor has left a chat. Timeout in minutes, last activity by visitor <desktop timeout>,<mobile timeout>,<status chat>.','0'),\n                ('mobile_options',\t'a:2:{s:13:\\\"notifications\\\";i:0;s:7:\\\"fcm_key\\\";s:152:\\\"AAAAiF8DeNk:APA91bFVHu2ybhBUTtlEtQrUEPpM2fb-5ovgo0FVNm4XxK3cYJtSwRcd-pqcBot_422yDOzHyw2p9ZFplkHrmNXjm8f5f-OIzfalGmpsypeXvnPxhU6Db1B2Z1Acc-TamHUn2F4xBJkP\\\";}',\t0,\t'',\t1),\n                ('list_closed','0','0','List closed chats','0'),\n                ('autoclose_activity_timeout','0','0','Automatically close active chat if from last visitor/operator message passed. 0 - disabled, n > 0 time in minutes','0'),\n                ('footprint_background','0','0','Footprint updates should be processed in the background. Make sure you are running workflow background cronjob.','0'),\n                ('reverse_pending','0','0','Make default pending chats order from old to new','0'),\n                ('departament_availability','364','0','How long department availability statistic should be kept? (days)','0'),\n                ('uonline_sessions','364','0','How long keep operators online sessions data? (days)','0'),\n                ('disable_live_autoassign','0','0','Disable live auto assign','0'),\n                ('tracked_footprint_cleanup','90','0','How many days keep records of users footprint.','0'),\n                ('cleanup_cronjob','0','0','Cleanup should be done only using cronjob.','0'),         \n                ('vwait_to_long','120','0','How long we should wait before we inform operator about unanswered chat.','0'),\n                ('no_wildcard_cookie','0','0','Cookie should be valid only for domain where Javascript is embedded (excludes subdomains)','0'),\n                ('cduration_timeout_user','4','0','How long operator can wait for message from visitor before time between messages are ignored. Values in minutes.','0'),\n                ('cduration_timeout_operator','10','0','How long visitor can wait for message from operator before time between messages are ignored. Values in minutes.','0'),       \n                ('assign_workflow_timeout','0','0','Chats waiting in pending line more than n seconds should be auto assigned first. Time in seconds','0'),\n        \t   \t('smtp_data',\t'a:5:{s:4:\\\"host\\\";s:0:\\\"\\\";s:4:\\\"port\\\";s:2:\\\"25\\\";s:8:\\\"use_smtp\\\";i:0;s:8:\\\"username\\\";s:0:\\\"\\\";s:8:\\\"password\\\";s:0:\\\"\\\";}',\t0,\t'SMTP configuration',\t1),\n        \t    ('chatbox_data',\t'a:6:{i:0;b:0;s:20:\\\"chatbox_auto_enabled\\\";i:0;s:19:\\\"chatbox_secret_hash\\\";s:{$randomHashLength}:\\\"{$randomHash}\\\";s:20:\\\"chatbox_default_name\\\";s:7:\\\"Chatbox\\\";s:17:\\\"chatbox_msg_limit\\\";i:50;s:22:\\\"chatbox_default_opname\\\";s:7:\\\"Manager\\\";}',\t0,\t'Chatbox configuration',\t1),\n                ('start_chat_data',\t'a:80:{i:0;b:0;s:21:\\\"name_visible_in_popup\\\";b:0;s:27:\\\"name_visible_in_page_widget\\\";b:0;s:19:\\\"name_require_option\\\";s:8:\\\"required\\\";s:22:\\\"email_visible_in_popup\\\";b:0;s:28:\\\"email_visible_in_page_widget\\\";b:0;s:20:\\\"email_require_option\\\";s:8:\\\"required\\\";s:24:\\\"message_visible_in_popup\\\";b:1;s:30:\\\"message_visible_in_page_widget\\\";b:1;s:22:\\\"message_require_option\\\";s:8:\\\"required\\\";s:22:\\\"phone_visible_in_popup\\\";b:0;s:28:\\\"phone_visible_in_page_widget\\\";b:0;s:20:\\\"phone_require_option\\\";s:8:\\\"required\\\";s:21:\\\"force_leave_a_message\\\";b:0;s:29:\\\"offline_name_visible_in_popup\\\";b:1;s:35:\\\"offline_name_visible_in_page_widget\\\";b:1;s:27:\\\"offline_name_require_option\\\";s:8:\\\"required\\\";s:30:\\\"offline_phone_visible_in_popup\\\";b:0;s:36:\\\"offline_phone_visible_in_page_widget\\\";b:0;s:28:\\\"offline_phone_require_option\\\";s:8:\\\"required\\\";s:32:\\\"offline_message_visible_in_popup\\\";b:1;s:38:\\\"offline_message_visible_in_page_widget\\\";b:1;s:30:\\\"offline_message_require_option\\\";s:8:\\\"required\\\";s:15:\\\"auto_start_chat\\\";b:0;s:12:\\\"mobile_popup\\\";b:0;s:17:\\\"dont_auto_process\\\";b:0;s:20:\\\"tos_visible_in_popup\\\";b:0;s:12:\\\"requires_dep\\\";b:0;s:17:\\\"requires_dep_lock\\\";b:0;s:17:\\\"show_messages_box\\\";b:1;s:26:\\\"tos_visible_in_page_widget\\\";b:0;s:19:\\\"tos_checked_offline\\\";b:0;s:18:\\\"tos_checked_online\\\";b:0;s:28:\\\"offline_tos_visible_in_popup\\\";b:0;s:34:\\\"offline_tos_visible_in_page_widget\\\";b:0;s:35:\\\"offline_file_visible_in_page_widget\\\";b:0;s:29:\\\"offline_file_visible_in_popup\\\";b:0;s:11:\\\"name_hidden\\\";b:0;s:15:\\\"name_hidden_bot\\\";b:0;s:24:\\\"custom_fields_encryption\\\";s:0:\\\"\\\";s:19:\\\"offline_name_hidden\\\";b:0;s:13:\\\"pre_chat_html\\\";s:0:\\\"\\\";s:21:\\\"pre_offline_chat_html\\\";s:0:\\\"\\\";s:12:\\\"email_hidden\\\";b:0;s:16:\\\"email_hidden_bot\\\";b:0;s:20:\\\"offline_email_hidden\\\";b:0;s:15:\\\"user_msg_height\\\";s:0:\\\"\\\";s:12:\\\"phone_hidden\\\";b:0;s:16:\\\"phone_hidden_bot\\\";b:0;s:20:\\\"offline_phone_hidden\\\";b:0;s:14:\\\"message_hidden\\\";b:0;s:18:\\\"message_hidden_bot\\\";b:0;s:18:\\\"message_auto_start\\\";b:0;s:28:\\\"message_auto_start_key_press\\\";b:0;s:22:\\\"offline_message_hidden\\\";b:0;s:21:\\\"show_operator_profile\\\";b:1;s:21:\\\"remove_operator_space\\\";b:0;s:18:\\\"hide_message_label\\\";b:0;s:17:\\\"custom_fields_url\\\";s:0:\\\"\\\";s:13:\\\"custom_fields\\\";s:0:\\\"\\\";s:21:\\\"name_hidden_prefilled\\\";b:0;s:22:\\\"email_hidden_prefilled\\\";b:0;s:24:\\\"message_hidden_prefilled\\\";b:0;s:22:\\\"phone_hidden_prefilled\\\";b:0;s:29:\\\"offline_name_hidden_prefilled\\\";b:0;s:32:\\\"offline_message_hidden_prefilled\\\";b:0;s:30:\\\"offline_phone_hidden_prefilled\\\";b:0;s:18:\\\"disable_start_chat\\\";b:0;s:18:\\\"offline_name_width\\\";i:0;s:19:\\\"offline_email_width\\\";i:0;s:19:\\\"offline_phone_width\\\";i:0;s:10:\\\"name_width\\\";i:0;s:11:\\\"email_width\\\";i:0;s:11:\\\"phone_width\\\";i:0;s:17:\\\"hide_start_button\\\";b:0;s:9:\\\"lazy_load\\\";b:0;s:28:\\\"offline_email_require_option\\\";s:8:\\\"required\\\";s:30:\\\"offline_email_hidden_prefilled\\\";b:0;s:36:\\\"offline_email_visible_in_page_widget\\\";b:1;s:30:\\\"offline_email_visible_in_popup\\\";b:1;}',\t0,\t'',\t1),\n                ('application_name',\t'a:6:{s:3:\\\"eng\\\";s:31:\\\"Live Helper Chat - live support\\\";s:3:\\\"lit\\\";s:26:\\\"Live Helper Chat - pagalba\\\";s:3:\\\"hrv\\\";s:0:\\\"\\\";s:3:\\\"esp\\\";s:0:\\\"\\\";s:3:\\\"por\\\";s:0:\\\"\\\";s:10:\\\"site_admin\\\";s:31:\\\"Live Helper Chat - live support\\\";}',\t1,\t'Support application name, visible in browser title.',\t0),\n                ('track_footprint',\t'0',\t0,\t'Track users footprint. For this also online visitors tracking should be enabled',\t0),\n                ('pro_active_limitation',\t'-1',\t0,\t'Pro active chats invitations limitation based on pending chats, (-1) do not limit, (0,1,n+1) number of pending chats can be for invitation to be shown.',\t0),\n                ('pro_active_show_if_offline',\t'0',\t0,\t'Should invitation logic be executed if there is no online operators',\t0),\n                ('export_hash',\t'{$exportHash}',\t0,\t'Chats export secret hash',\t0),\n                ('do_no_track_ip', 0, 0, 'Do not track visitors IP',0),\n                ('remember_username','1','0','Should we remember username for the next time visitor starts a chat?','0'),\n                ('ignore_typing', 0, 0, 'Do not store what visitor is typing',0),\n                ('encrypt_msg_after', 0, 0, 'After how many days anonymize messages',0),\n                ('encrypt_msg_op', 0, 0, 'Anonymize also operators messages',0),\n                ('valid_domains','','0','Domains where script can be embedded. E.g example.com, google.com','0'),\n                ('message_seen_timeout', 24, 0, 'Proactive message timeout in hours. After how many hours proactive chat mesasge should be shown again.',\t0),\n                ('reopen_chat_enabled',0,\t0,\t'Reopen chat functionality enabled',\t0),\n                ('ignorable_ip',\t'',\t0,\t'Which ip should be ignored in online users list, separate by comma',0),\n                ('run_departments_workflow', 0, 0, 'Should cronjob run departments transfer workflow, even if user leaves a chat',\t0),\n                ('geo_location_data', 'a:3:{s:4:\\\"zoom\\\";i:4;s:3:\\\"lat\\\";s:7:\\\"49.8211\\\";s:3:\\\"lng\\\";s:7:\\\"11.7835\\\";}', '0', '', '1'),\n                ('xmp_data','a:14:{i:0;b:0;s:4:\\\"host\\\";s:15:\\\"talk.google.com\\\";s:6:\\\"server\\\";s:9:\\\"gmail.com\\\";s:8:\\\"resource\\\";s:6:\\\"xmpphp\\\";s:4:\\\"port\\\";s:4:\\\"5222\\\";s:7:\\\"use_xmp\\\";i:0;s:8:\\\"username\\\";s:0:\\\"\\\";s:8:\\\"password\\\";s:0:\\\"\\\";s:11:\\\"xmp_message\\\";s:98:\\\"New chat request [{chat_id}] from [{department}]\\r\\n{messages}\\r\\nClick to accept a chat\\r\\n{url_accept}\\\";s:10:\\\"recipients\\\";s:0:\\\"\\\";s:20:\\\"xmp_accepted_message\\\";s:89:\\\"{user_name} has accepted a chat [{chat_id}] from [{department}]\\r\\n{messages}\\r\\n{url_accept}\\\";s:16:\\\"use_standard_xmp\\\";i:0;s:15:\\\"test_recipients\\\";s:0:\\\"\\\";s:21:\\\"test_group_recipients\\\";s:0:\\\"\\\";}',0,'XMP data',1),\n                ('run_unaswered_chat_workflow', 0, 0, 'Should cronjob run unanswered chats workflow and execute unaswered chats callback, 0 - no, any other number bigger than 0 is a minits how long chat have to be not accepted before executing callback.',0),\n                ('disable_popup_restore', 0, 0, 'Disable option in widget to open new window. Restore icon will be hidden',\t0),\n                ('accept_tos_link', '#', 0, 'Change to your site Terms of Service', 0),\n                ('hide_button_dropdown', '0', 0, 'Hide close button in dropdown', 0),\n                ('on_close_exit_chat', '0', 0, 'On chat close exit chat', 0),\n                ('activity_timeout', '5', 0, 'How long operator should go offline automatically because of inactivity. Value in minutes', 0),\n                ('product_enabled_module','0','0','Product module is enabled', '1'),\n                ('preload_iframes','0','0','Preload widget. It will avoid loading delay after clicking widget','0'),\n                ('product_show_departament','0','0','Enable products show by departments', '1'),\n                ('paidchat_data','','0','Paid chat configuration','1'),\n                ('mheight_op','200','0','Messages box height for operator','0'),\n                ('listd_op','10','0','Default number of online operators to show','0'),\n                ('disable_iframe_sharing',\t'1',\t0,\t'Disable iframes in sharing mode',\t0),\n                ('file_configuration',\t'a:7:{i:0;b:0;s:5:\\\"ft_op\\\";s:47:\\\"gif|jpe?g|png|zip|svg|rar|xls|doc|docx|xlsx|pdf\\\";s:5:\\\"ft_us\\\";s:30:\\\"gif|jpe?g|png|svg|doc|docx|pdf\\\";s:6:\\\"fs_max\\\";i:2048;s:18:\\\"active_user_upload\\\";b:0;s:16:\\\"active_op_upload\\\";b:1;s:19:\\\"active_admin_upload\\\";b:1;}',\t0,\t'Files configuration item',\t1),\n                ('accept_chat_link_timeout',\t'300',\t0,\t'How many seconds chat accept link is valid. Set 0 to force login all the time manually.',\t0),\n                ('open_closed_chat_timeout',\t'1800',\t0,\t'How many seconds customer has to open already closed chat.',\t0),\n                ('session_captcha',0,\t0,\t'Use session captcha. LHC have to be installed on the same domain or subdomain.',\t0),\n                ('sync_sound_settings',\t'a:16:{i:0;b:0;s:12:\\\"repeat_sound\\\";i:1;s:18:\\\"repeat_sound_delay\\\";i:5;s:10:\\\"show_alert\\\";b:0;s:22:\\\"new_chat_sound_enabled\\\";b:1;s:31:\\\"new_message_sound_admin_enabled\\\";b:1;s:30:\\\"new_message_sound_user_enabled\\\";b:1;s:14:\\\"online_timeout\\\";d:300;s:22:\\\"check_for_operator_msg\\\";d:10;s:21:\\\"back_office_sinterval\\\";d:10;s:22:\\\"chat_message_sinterval\\\";d:3.5;s:20:\\\"long_polling_enabled\\\";b:0;s:30:\\\"polling_chat_message_sinterval\\\";d:1.5;s:29:\\\"polling_back_office_sinterval\\\";d:5;s:18:\\\"connection_timeout\\\";i:30;s:28:\\\"browser_notification_message\\\";b:0;}',\t0,\t'',\t1),\n                ('sound_invitation', 1, 0, 'Play sound on invitation to chat.',\t0),\n                ('explicit_http_mode', '',0,'Please enter explicit http mode. Either http: or https:, do not forget : at the end.', '0'),\n                ('track_domain',\t'',\t0,\t'Set your domain to enable user tracking across different domain subdomains.',\t0),\n                ('max_message_length','500',0,'Maximum message length in characters', '0'),\n                ('need_help_tip','1',0,'Show need help tooltip?', '0'),\n                ('recaptcha_data','a:4:{i:0;b:0;s:8:\\\"site_key\\\";s:0:\\\"\\\";s:10:\\\"secret_key\\\";s:0:\\\"\\\";s:7:\\\"enabled\\\";i:0;}','0','Re-captcha configuration','1'),\n                ('need_help_tip_timeout','24',0,'Need help tooltip timeout, after how many hours show again tooltip?', '0'),\n                ('use_secure_cookie','0',0,'Use secure cookie, check this if you want to force SSL all the time', '0'),\n                ('faq_email_required','0',0,'Is visitor e-mail required for FAQ', '0'),\n                ('disable_print','0',0,'Disable chat print', '0'),\n                ('hide_disabled_department','1',0,'Hide disabled department widget', '0'),\n                ('disable_send','0',0,'Disable chat transcript send', '0'),\n                ('ignore_user_status','0',0,'Ignore users online statuses and use departments online hours', '0'),\n                ('bbc_button_visible','1',0,'Show BB Code button', '0'),\n                ('password_data','','0','Password requirements','1'),\n                ('activity_track_all','0','0','Track all logged operators activity and ignore their individual settings.','0'),\n                ('allow_reopen_closed','0', 0, 'Allow user to reopen closed chats?', '0'),\n                ('reopen_as_new','0', 0, 'Reopen closed chat as new? Otherwise it will be reopened as active.', '0'),\n                ('default_theme_id','0', 0, 'Default theme ID.', '1'),  \n                ('default_admin_theme_id','0', 0, 'Default admin theme ID', '1'),  \n                ('translation_data',\t'a:6:{i:0;b:0;s:19:\\\"translation_handler\\\";s:4:\\\"bing\\\";s:19:\\\"enable_translations\\\";b:0;s:14:\\\"bing_client_id\\\";s:0:\\\"\\\";s:18:\\\"bing_client_secret\\\";s:0:\\\"\\\";s:14:\\\"google_api_key\\\";s:0:\\\"\\\";}',\t0,\t'Translation data',\t1),              \n                ('disable_html5_storage','1',0,'Disable HMTL5 storage, check it if your site is switching between http and https', '0'),\n                ('automatically_reopen_chat','1',0,'Automatically reopen chat on widget open', '0'),\n                ('autoclose_timeout','0', 0, 'Automatic chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autoclose_timeout_pending','0', 0, 'Automatic pending chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autoclose_timeout_active','0', 0, 'Automatic active chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autoclose_timeout_bot','0', 0, 'Automatic bot chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autopurge_timeout','0', 0, 'Automatic chats purging. 0 - disabled, n > 0 time in minutes before chat is automatically deleted', '0'),\n                ('update_ip',\t'127.0.0.1',\t0,\t'Which ip should be allowed to update DB by executing http request, separate by comma?',0),\n                ('track_if_offline',\t'0',\t0,\t'Track online visitors even if there is no online operators',0),\n                ('min_phone_length','8',0,'Minimum phone number length',0),\n                ('mheight','',0,'Messages box height',0),\n                ('inform_unread_message','0',0,'Inform visitor about unread messages from operator, value in minutes. 0 - disabled',0),\n                ('dashboard_order', '[[\\\"online_operators\\\",\\\"departments_stats\\\",\\\"online_visitors\\\"],[\\\"group_chats\\\",\\\"my_chats\\\",\\\"pending_chats\\\",\\\"transfered_chats\\\"],[\\\"active_chats\\\",\\\"bot_chats\\\"]]', '0', 'Home page dashboard widgets order', '0'),\n                ('banned_ip_range','',0,'Which ip should not be allowed to chat',0),\n                ('suggest_leave_msg','1',0,'Suggest user to leave a message then user chooses offline department',0),\n                ('checkstatus_timeout','0',0,'Interval between chat status checks in seconds, 0 disabled.',0),\n                ('show_language_switcher','0',0,'Show users option to switch language at widget',0),\n                ('sharing_auto_allow','0',0,'Do not ask permission for users to see their screen',0),\n                ('sharing_nodejs_enabled','0',0,'NodeJs support enabled',0),\n                ('sharing_nodejs_path','',0,'socket.io path, optional',0),\n                ('online_if','0','0','','0'),\n                ('track_mouse_activity','0','0','Should mouse movement be tracked as activity measure, if not checked only basic events would be tracked','0'),\n                ('track_activity','0','0','Track users activity on site?','0'),\n                ('autologin_data','a:3:{i:0;b:0;s:11:\\\"secret_hash\\\";s:16:\\\"please_change_me\\\";s:7:\\\"enabled\\\";i:0;}',0,'Autologin configuration data',\t1),\n                ('sharing_nodejs_secure','0',0,'Connect to NodeJs in https mode',0),\n                ('disable_js_execution','1',0,'Disable JS execution in Co-Browsing operator window',0),\n                ('sharing_nodejs_socket_host','',0,'Host where NodeJs is running',0),\n                ('hide_right_column_frontpage','1','0','Hide right column in frontpage','0'),\n                ('front_tabs', 'dashboard,online_users,online_map', '0', 'Home page tabs order', '0'),\n                ('speech_data',\t'a:3:{i:0;b:0;s:8:\\\"language\\\";i:7;s:7:\\\"dialect\\\";s:5:\\\"en-US\\\";}',\t1,\t'',\t1),\n                ('sharing_nodejs_sllocation','https://cdn.jsdelivr.net/npm/socket.io-client@2/dist/socket.io.js',0,'Location of SocketIO JS library',0),\n                ('track_is_online','0',0,'Track is user still on site, chat status checks also has to be enabled',0),\n\t\t\t\t('show_languages','eng,lit,hrv,esp,por,nld,ara,ger,pol,rus,ita,fre,chn,cse,nor,tur,vnm,idn,sve,per,ell,dnk,rou,bgr,tha,geo,fin,alb',0,'Between what languages user should be able to switch',0),\n                ('geoadjustment_data',\t'a:8:{i:0;b:0;s:18:\\\"use_geo_adjustment\\\";b:0;s:13:\\\"available_for\\\";s:0:\\\"\\\";s:15:\\\"other_countries\\\";s:6:\\\"custom\\\";s:8:\\\"hide_for\\\";s:0:\\\"\\\";s:12:\\\"other_status\\\";s:7:\\\"offline\\\";s:11:\\\"rest_status\\\";s:6:\\\"hidden\\\";s:12:\\\"apply_widget\\\";i:0;}',\t0,\t'Geo adjustment settings',\t1),\n                {$geoRow}\");\n\n\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_online_user` (\n                  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `vid` varchar(50) NOT NULL,\n                  `ip` varchar(50) NOT NULL,\n                  `current_page` text NOT NULL,\n        \t   \t  `page_title` varchar(250) NOT NULL,\n                  `referrer` text NOT NULL,\n                  `chat_id` int(11) NOT NULL,\n                  `invitation_seen_count` int(11) NOT NULL,\n        \t   \t  `invitation_id` int(11) NOT NULL,\n                  `last_visit` int(11) NOT NULL,\n        \t   \t  `first_visit` int(11) NOT NULL,\n        \t   \t  `total_visits` int(11) NOT NULL,\n        \t   \t  `pages_count` int(11) NOT NULL,\n        \t   \t  `tt_pages_count` int(11) NOT NULL,\n        \t   \t  `invitation_count` int(11) NOT NULL,\n        \t   \t  `last_check_time` int(11) NOT NULL,\n        \t   \t  `dep_id` int(11) NOT NULL,        \t   \t \n                  `user_agent` text NOT NULL,\n                  `notes` varchar(250) NOT NULL,\n                  `user_country_code` varchar(50) NOT NULL,\n                  `user_country_name` varchar(50) NOT NULL,\n                  `visitor_tz` varchar(50) NOT NULL,\n                  `operator_message` text NOT NULL,\n                  `operator_user_proactive` varchar(100) NOT NULL,\n                  `operator_user_id` int(11) NOT NULL,\n                  `conversion_id` int(11) NOT NULL,\n                  `message_seen` int(11) NOT NULL,\n                  `message_seen_ts` int(11) NOT NULL,\n                  `user_active` int(11) NOT NULL,\n        \t   \t  `lat` varchar(10) NOT NULL,\n  \t\t\t\t  `lon` varchar(10) NOT NULL,\n  \t\t\t\t  `city` varchar(100) NOT NULL,\n        \t   \t  `reopen_chat` int(11) NOT NULL,\n        \t   \t  `time_on_site` int(11) NOT NULL,\n  \t\t\t\t  `tt_time_on_site` int(11) NOT NULL,\n        \t   \t  `requires_email` int(11) NOT NULL,\n        \t   \t  `requires_username` int(11) NOT NULL,\n        \t   \t  `requires_phone` int(11) NOT NULL,\n        \t   \t  `screenshot_id` int(11) NOT NULL,\n        \t   \t  `identifier` varchar(50) NOT NULL,\n        \t   \t  `operation` text NOT NULL,\n        \t   \t  `online_attr_system` text NOT NULL,\n        \t   \t  `operation_chat` text NOT NULL,\n        \t   \t  `online_attr` text NOT NULL,\n        \t   \t  `device_type` tinyint(1) NOT NULL DEFAULT '0',\n                  `chat_time` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  `last_visit_prev` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  PRIMARY KEY (`id`),\n                  KEY `vid` (`vid`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `last_visit_dep_id` (`last_visit`,`dep_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_proactive_chat_invitation` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `siteaccess` varchar(10) NOT NULL,\n\t\t\t\t  `time_on_site` int(11) NOT NULL,\n\t\t\t\t  `pageviews` int(11) NOT NULL,\n\t\t\t\t  `message` text NOT NULL,\n\t\t\t\t  `message_returning` text NOT NULL,\n\t\t\t\t  `executed_times` int(11) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `hide_after_ntimes` int(11) NOT NULL,\n\t\t\t\t  `show_on_mobile` int(11) NOT NULL,\n\t\t\t\t  `delay` int(11) NOT NULL,\n\t\t\t\t  `delay_init` int(11) NOT NULL,\n\t\t\t\t  `show_instant` int(11) NOT NULL,\n\t\t\t\t  `autoresponder_id` int(11) NOT NULL,\n\t\t\t\t  `disabled` int(11) NOT NULL,\n\t\t\t\t  `inject_only_html` tinyint(1) NOT NULL,\n\t\t\t\t  `name` varchar(50) NOT NULL,\n\t\t\t\t  `operator_ids` varchar(100) NOT NULL,\t\t\t\t \n\t\t\t\t  `message_returning_nick` varchar(250) NOT NULL,\n\t\t\t\t  `referrer` varchar(250) NOT NULL,\t\t\t\t  \n\t\t\t\t  `show_random_operator` int(11) NOT NULL,\n\t\t\t\t  `operator_name` varchar(100) NOT NULL,\n\t\t\t\t  `campaign_id` int(11) NOT NULL,\n\t\t\t\t  `position` int(11) NOT NULL,\n\t\t\t\t  `event_invitation` int(11) NOT NULL,\n\t\t\t\t  `dynamic_invitation` int(11) NOT NULL,\n\t\t\t\t  `bot_id` int(11) NOT NULL,\n\t\t\t\t  `trigger_id` int(11) NOT NULL,\n\t\t\t\t  `bot_offline` tinyint(1) NOT NULL,\n        \t   \t  `identifier` varchar(50) NOT NULL,\n        \t   \t  `tag` varchar(50) NOT NULL,\n        \t   \t  `requires_email` int(11) NOT NULL,\n        \t   \t  `iddle_for` int(11) NOT NULL,\n        \t   \t  `event_type` int(11) NOT NULL,\n        \t   \t  `requires_username` int(11) NOT NULL,\n        \t   \t  `requires_phone` int(11) NOT NULL,        \t   \t  \n        \t   \t  `design_data` longtext NOT NULL,        \t   \t  \n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `time_on_site_pageviews_siteaccess_position` (`time_on_site`,`pageviews`,`siteaccess`,`identifier`,`position`),\n        \t      KEY `identifier` (`identifier`),\n        \t      KEY `dynamic_invitation` (`dynamic_invitation`),\n        \t      KEY `tag` (`tag`),\n        \t      KEY `dep_id` (`dep_id`),\n        \t      KEY `show_on_mobile` (`show_on_mobile`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_accept` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `chat_id` bigint(20) NOT NULL,\n        \t   `hash` varchar(50) NOT NULL,\n        \t   `ctime` int(11) NOT NULL,\n        \t   `wused` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `hash` (`hash`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            //Default departament\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_departament` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `name` varchar(100) NOT NULL,\n\t\t\t\t  `email` varchar(100) NOT NULL,\n\t\t\t\t  `xmpp_recipients` text NOT NULL,\n\t\t\t\t  `xmpp_group_recipients` text NOT NULL,\n\t\t\t\t  `priority` int(11) NOT NULL,\n\t\t\t\t  `sort_priority` int(11) NOT NULL,\n\t\t\t\t  `department_transfer_id` int(11) NOT NULL,\n\t\t\t\t  `transfer_timeout` int(11) NOT NULL,\n\t\t\t\t  `exclude_inactive_chats` int(11) NOT NULL,\n\t\t\t\t  `delay_before_assign` int(11) NOT NULL,\n\t\t\t\t  `max_ac_dep_chats` int(11) NOT NULL,\n\t\t\t\t  `archive` tinyint(1) NOT NULL DEFAULT '0',\n\t\t\t\t  `max_load` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `max_load_h` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `assign_same_language` int(11) NOT NULL,\n\t\t\t\t  `disabled` int(11) NOT NULL,\n\t\t\t\t  `hidden` int(11) NOT NULL,\n\t\t\t\t  `delay_lm` int(11) NOT NULL,\n\t\t\t\t  `max_active_chats` int(11) NOT NULL,\n\t\t\t\t  `max_timeout_seconds` int(11) NOT NULL,\n\t\t\t\t  `identifier` varchar(2083) NOT NULL,\n\t\t\t\t  `mod_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `mod_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `tud_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `tud_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `wed_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `wed_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `thd_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `thd_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `frd_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `frd_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sad_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sad_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sud_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sud_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `nc_cb_execute` tinyint(1) NOT NULL,\n\t\t\t\t  `na_cb_execute` tinyint(1) NOT NULL,\n\t\t\t\t  `inform_unread` tinyint(1) NOT NULL,\n\t\t\t\t  `active_balancing` tinyint(1) NOT NULL,\n\t\t\t\t  `visible_if_online` tinyint(1) NOT NULL,\n\t\t\t\t  `inform_close` int(11) NOT NULL,\n\t\t\t\t  `inform_unread_delay` int(11) NOT NULL,\n\t\t\t\t  `inform_options` varchar(250) NOT NULL,\n\t\t\t\t  `online_hours_active` tinyint(1) NOT NULL,\n\t\t\t\t  `inform_delay` int(11) NOT NULL,\n\t\t\t\t  `attr_int_1` int(11) NOT NULL,\n\t\t\t\t  `attr_int_2` int(11) NOT NULL,\n\t\t\t\t  `attr_int_3` int(11) NOT NULL,\n\t\t\t\t  `pending_max` int(11) NOT NULL,\n\t\t\t\t  `pending_group_max` int(11) NOT NULL,\n\t\t\t\t  `active_chats_counter` int(11) NOT NULL,\n\t\t\t\t  `inactive_chats_cnt` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `pending_chats_counter` int(11) NOT NULL,\n\t\t\t\t  `bot_chats_counter` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `inop_chats_cnt` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `acop_chats_cnt` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `inform_close_all` int(11) NOT NULL,\n\t\t\t\t  `inform_close_all_email` varchar(250) NOT NULL,\n\t\t\t\t  `alias` varchar(50) NOT NULL,\n\t\t\t\t  `product_configuration` longtext NOT NULL,\n\t\t\t\t  `bot_configuration` text NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `identifier_2` (`identifier`(191)),\n\t\t\t\t  KEY `archive` (`archive`),\n\t\t\t\t  KEY `attr_int_1` (`attr_int_1`),\n\t\t\t\t  KEY `attr_int_2` (`attr_int_2`),\n\t\t\t\t  KEY `attr_int_3` (`attr_int_3`),\n\t\t\t\t  KEY `active_chats_counter` (`active_chats_counter`),\n\t\t\t\t  KEY `pending_chats_counter` (`pending_chats_counter`),\n\t\t\t\t  KEY `bot_chats_counter` (`bot_chats_counter`),\n\t\t\t\t  KEY `disabled_hidden` (`disabled`, `hidden`),\n\t\t\t\t  KEY `sort_priority_name` (`sort_priority`, `name`),\n\t\t\t\t  KEY `alias` (`alias`),\n\t\t\t\t  KEY `active_mod` (`online_hours_active`,`mod_start_hour`,`mod_end_hour`),\n\t\t\t\t  KEY `active_tud` (`online_hours_active`,`tud_start_hour`,`tud_end_hour`),\n\t\t\t\t  KEY `active_wed` (`online_hours_active`,`wed_start_hour`,`wed_end_hour`),\n\t\t\t\t  KEY `active_thd` (`online_hours_active`,`thd_start_hour`,`thd_end_hour`),\n\t\t\t\t  KEY `active_frd` (`online_hours_active`,`frd_start_hour`,`frd_end_hour`),\n\t\t\t\t  KEY `active_sad` (`online_hours_active`,`sad_start_hour`,`sad_end_hour`),\n\t\t\t\t  KEY `active_sud` (`online_hours_active`,`sud_start_hour`,`sud_end_hour`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_saved_search` (\n                    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `name` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `params` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `user_id` bigint(20) unsigned NOT NULL,\n                  `position` int(11) unsigned NOT NULL,\n                  `scope` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `days` int(11) unsigned NOT NULL,\n                  `updated_at` bigint(20) unsigned NOT NULL,\n                  `requested_at` bigint(20) unsigned NOT NULL,\n                  `total_records` bigint(20) unsigned NOT NULL,\n                  `passive` tinyint(1) unsigned NOT NULL DEFAULT 0,\n                  PRIMARY KEY (`id`),\n                  KEY `user_id` (`user_id`),\n                  KEY `scope` (`scope`),\n                  KEY `updated_at` (`updated_at`),\n                  KEY `requested_at` (`requested_at`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_departament_group_user` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `dep_group_id` int(11) NOT NULL,\n                  `user_id` int(11) NOT NULL,\n                  `read_only` tinyint(1) unsigned NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`id`),\n                  KEY `dep_group_id` (`dep_group_id`),\n                  KEY `user_id` (`user_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_departament_availability` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `dep_id` int(11) NOT NULL, `hour` int(11) NOT NULL, `hourminute` int(4) NOT NULL, `minute` int(11) NOT NULL, `time` int(11) NOT NULL, `ymdhi` bigint(20) NOT NULL, `ymd` int(11) NOT NULL, `status` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `ymdhi` (`ymdhi`), KEY `dep_id` (`dep_id`),  KEY `hourminute` (`hourminute`), KEY `time` (`time`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_product_departament` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `product_id` int(11) NOT NULL,\n        \t       `departament_id` int(11) NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `departament_id` (`departament_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_departament_group_member` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `dep_id` int(11) NOT NULL,\n                  `dep_group_id` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `dep_group_id` (`dep_group_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_generic_bot_rest_api` (`id` bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY, `name` varchar(50) NOT NULL, `description` varchar(250), `configuration` text NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_departament_group` (\n                      `id` int(11) NOT NULL AUTO_INCREMENT,\n                      `name` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `achats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `inachats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `pchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `max_load` int(11) NOT NULL DEFAULT 0,\n                      `max_load_h` int(11) NOT NULL DEFAULT 0,\n                      `bchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `inopchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `acopchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      PRIMARY KEY (`id`)\n                    ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_canned_msg_tag_link` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `tag_id` int(11) NOT NULL,  `canned_id` int(11) NOT NULL,  PRIMARY KEY (`id`), KEY `canned_id` (`canned_id`), KEY `tag_id` (`tag_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_canned_msg_tag` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `tag` varchar(40) NOT NULL, PRIMARY KEY (`id`), KEY `tag` (`tag`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_abstract_subject` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `name` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `internal` tinyint(1) NOT NULL DEFAULT 0,\n  `internal_type` varchar(20) NOT NULL DEFAULT '',\n  PRIMARY KEY (`id`),\n  KEY `internal` (`internal`),\n  KEY `internal_type` (`internal_type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_abstract_subject_dep` ( `id` int(11) NOT NULL AUTO_INCREMENT, `dep_id` int(11) NOT NULL, `subject_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `subject_id` (`subject_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_abstract_subject_chat` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `subject_id` int(11) NOT NULL, `chat_id` bigint(20) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_group_object` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `object_id` bigint(20) NOT NULL, `group_id` bigint(20) NOT NULL, `type` bigint(20) NOT NULL, PRIMARY KEY (`id`), KEY `object_id_type` (`object_id`,`type`), KEY `group_id` (`group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Bot tables\n            $db->query(\"CREATE TABLE `lh_generic_bot_bot` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `configuration` longtext NOT NULL, `avatar` varchar(150) NOT NULL, `filename` varchar(250) NOT NULL, `filepath` varchar(250) NOT NULL, `name` varchar(100) NOT NULL, `nick` varchar(100) NOT NULL,`attr_str_1` varchar(100) NOT NULL, `attr_str_2` varchar(100) NOT NULL, `attr_str_3` varchar(100) NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_group` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL,`is_collapsed` int(11) NOT NULL DEFAULT '0', `pos` int(11) NOT NULL DEFAULT '0', `bot_id` bigint(20) NOT NULL, PRIMARY KEY (`id`), KEY `bot_id` (`bot_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_trigger` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL, `actions` longtext NOT NULL, `group_id` bigint(20) NOT NULL, `bot_id` int(11) NOT NULL, `default` int(11) NOT NULL, `default_unknown` int(11) NOT NULL, `as_argument` int(11) NOT NULL DEFAULT '0', `in_progress` int(11) NOT NULL DEFAULT '0', `default_unknown_btn` int(11) NOT NULL DEFAULT '0', `default_always` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `bot_id` (`bot_id`),  KEY `default_unknown` (`default_unknown`), KEY `in_progress` (`in_progress`), KEY `default_unknown_btn` (`default_unknown_btn`), KEY `default_always` (`default_always`), KEY `group_id` (`group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_trigger_event` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `pattern` text NOT NULL, `pattern_exc` text NOT NULL, `configuration` longtext NOT NULL, `trigger_id` bigint(20) NOT NULL, `bot_id` int(11) NOT NULL, `on_start_type` tinyint(1) NOT NULL, `priority` int(11) NOT NULL, `type` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `pattern_v2` (`pattern`(191)), KEY `type` (`type`), KEY `on_start_type` (`on_start_type`), KEY `trigger_id` (`trigger_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_payload` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL, `payload` varchar(100) NOT NULL, `bot_id` int(11) NOT NULL, `trigger_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `bot_id` (`bot_id`), KEY `trigger_id` (`trigger_id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_chat_workflow` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL,`trigger_id` bigint(20) NOT NULL, `time` int(11) NOT NULL, `identifier` varchar(100) NOT NULL, `status` int(11) NOT NULL, `collected_data` text, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_chat_event` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `counter` int(11) NOT NULL, `content` longtext NOT NULL, `ctime` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_pending_event` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `trigger_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_exception` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL, `priority` int(11) NOT NULL, `active` tinyint(1) NOT NULL, PRIMARY KEY (`id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_exception_message` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `code` varchar(20) NOT NULL, `exception_group_id` int(11) NOT NULL, `priority` int(11) NOT NULL, `active` tinyint(1) NOT NULL, `message` text NOT NULL, PRIMARY KEY (`id`), KEY `code` (`code`), KEY `exception_group_id` (`exception_group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_tr_group` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL,`filename` varchar(250) NOT NULL,`filepath` varchar(250) NOT NULL,`configuration` longtext NOT NULL,`nick` varchar(100) NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_tr_item` ( `id` int(11) NOT NULL AUTO_INCREMENT, `group_id` int(11) NOT NULL, `identifier` varchar(50) NOT NULL, `translation` text NOT NULL, PRIMARY KEY (`id`),  KEY `identifier` (`identifier`), KEY `group_id` (`group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_speech_user_language` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `user_id` bigint(20) NOT NULL, `language` varchar(20) NOT NULL, PRIMARY KEY (`id`), KEY `user_id_language` (`user_id`,`language`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_audits` (`id` bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY, `category` varchar(255) NOT NULL, `file` varchar(255), `object_id` bigint(20) DEFAULT '0', `line` bigint(20), `message` longtext NOT NULL, `severity` varchar(255) NOT NULL, `source` varchar(255) NOT NULL, `time` timestamp NOT NULL, KEY `object_id` (`object_id`), KEY `source` (`source`(191)), KEY `category` (`category`(191))) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_chat_online_user_footprint_update` (`online_user_id` bigint(20) NOT NULL,  `command` varchar(20) NOT NULL,  `args` varchar(250) NOT NULL,  `ctime` int(11) NOT NULL, KEY `online_user_id` (`online_user_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_generic_bot_repeat_restrict` (`id` bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY, `chat_id` bigint(20) NOT NULL, `trigger_id` bigint(20), `identifier` varchar(20), `counter` int(11) DEFAULT '0', KEY `chat_id_trigger_id` (`chat_id`,`trigger_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_users_login` (`id` bigint(20) NOT NULL AUTO_INCREMENT,`user_id` bigint(20) NOT NULL,`type` int(11) NOT NULL,`ctime` bigint(20) NOT NULL,`status` int(11) NOT NULL,`ip` varchar(100) NOT NULL,`msg` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,PRIMARY KEY (`id`),KEY `user_id_type` (`user_id`,`type`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            \n            $Departament = new erLhcoreClassModelDepartament();\n            $Departament->name = $form->DefaultDepartament;\n            erLhcoreClassDepartament::getSession()->save($Departament);\n            \n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_voice_video` (\n                   `id` bigint(20) NOT NULL AUTO_INCREMENT,\n                   `chat_id` bigint(20) NOT NULL,\n                   `user_id` bigint(20) NOT NULL,\n                   `op_status` tinyint(4) NOT NULL,\n                   `vi_status` tinyint(4) NOT NULL,\n                   `voice` tinyint(4) NOT NULL,\n                   `video` tinyint(4) NOT NULL,\n                   `screen_share` tinyint(4) NOT NULL,\n                   `status` tinyint(4) NOT NULL,\n                   `ctime` int(11) NOT NULL,\n                   `token` varchar(200) NOT NULL,\n                   PRIMARY KEY (`id`),\n                   KEY `chat_id` (`chat_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_canned_msg_replace` (\n                    `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n                    `identifier` varchar(50) NOT NULL,\n                    `default` text NOT NULL, `conditions` longtext NOT NULL,\n                    PRIMARY KEY (`id`),\n                   KEY `identifier` (`identifier`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            //Department custom work hours\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_departament_custom_work_hours` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `date_from` int(11) NOT NULL,\n\t\t\t\t  `date_to` int(11) NOT NULL,\n\t\t\t\t  `start_hour` int(11) NOT NULL,\n\t\t\t\t  `end_hour` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `date_from` (`date_from`),\n\t\t\t\t  KEY `search_active` (`date_from`, `date_to`, `dep_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            //Administrators group\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_group` (\n               `id` int(11) NOT NULL AUTO_INCREMENT,\n               `name` varchar(50) NOT NULL,\n               `disabled` tinyint(1) NOT NULL,\n               `required` tinyint(1) NOT NULL DEFAULT '0',\n               PRIMARY KEY (`id`),\n               KEY `disabled` (`disabled`)\n               ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_stats` (\n              `id` bigint(20) NOT NULL AUTO_INCREMENT,\n              `type` int(11) NOT NULL,\n              `lupdate` bigint(20) NOT NULL,\n              `object_id` bigint(20) NOT NULL,\n              `stats` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,\n              PRIMARY KEY (`id`),\n              KEY `type_object_id` (`type`,`object_id`)\n            ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            //Administrators group\n            $db->query(\"CREATE TABLE `lh_generic_bot_command` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `command` varchar(50) NOT NULL,\n  `bot_id` int(11) NOT NULL,\n  `trigger_id` int(11) NOT NULL,\n  `dep_id` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `dep_id` (`dep_id`),\n  KEY `command` (`command`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Admin group\n            $GroupData = new erLhcoreClassModelGroup();\n            $GroupData->name    = \"Administrators\";\n            erLhcoreClassUser::getSession()->save($GroupData);\n\n            // Precreate operators group\n            $GroupDataOperators = new erLhcoreClassModelGroup();\n            $GroupDataOperators->name    = \"Operators\";\n            erLhcoreClassUser::getSession()->save($GroupDataOperators);\n\n            //Administrators role\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_role` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `name` varchar(50) NOT NULL,\n                  PRIMARY KEY (`id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Administrators role\n            $Role = new erLhcoreClassModelRole();\n            $Role->name = 'Administrators';\n            erLhcoreClassRole::getSession()->save($Role);\n\n            // Operators role\n            $RoleOperators = new erLhcoreClassModelRole();\n            $RoleOperators->name = 'Operators';\n            erLhcoreClassRole::getSession()->save($RoleOperators);\n\n            //Assing group role\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_grouprole` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `group_id` int(11) NOT NULL,\n                  `role_id` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `group_id` (`role_id`,`group_id`),\n                  KEY `group_id_primary` (`group_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Assign admin role to admin group\n            $GroupRole = new erLhcoreClassModelGroupRole();\n            $GroupRole->group_id =$GroupData->id;\n            $GroupRole->role_id = $Role->id;\n            erLhcoreClassRole::getSession()->save($GroupRole);\n\n            // Assign operators role to operators group\n            $GroupRoleOperators = new erLhcoreClassModelGroupRole();\n            $GroupRoleOperators->group_id =$GroupDataOperators->id;\n            $GroupRoleOperators->role_id = $RoleOperators->id;\n            erLhcoreClassRole::getSession()->save($GroupRoleOperators);\n\n            // Users\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `username` varchar(80) NOT NULL,\n                  `password` varchar(200) NOT NULL,\n                  `email` varchar(100) NOT NULL,\n                  `time_zone` varchar(100) NOT NULL,\n                  `name` varchar(100) NOT NULL,\n                  `surname` varchar(100) NOT NULL,\n                  `avatar` varchar(150) NOT NULL,\n                  `filepath` varchar(200) NOT NULL,\n                  `filename` varchar(200) NOT NULL,\n                  `job_title` varchar(100) NOT NULL,\n                  `departments_ids` text NOT NULL,\n                  `chat_nickname` varchar(100) NOT NULL,\n                  `xmpp_username` varchar(200) NOT NULL,\n                  `session_id` varchar(40) NOT NULL,\n                  `operation_admin` text NOT NULL,\n                  `skype` varchar(50) NOT NULL,\n                  `exclude_autoasign` tinyint(1) NOT NULL,\n                  `disabled` tinyint(4) NOT NULL,\n                  `hide_online` tinyint(1) NOT NULL,\n                  `all_departments` tinyint(1) NOT NULL,\n                  `invisible_mode` tinyint(1) NOT NULL,\n                  `inactive_mode` tinyint(1) NOT NULL,\n                  `rec_per_req` tinyint(1) NOT NULL,\n                  `auto_accept` tinyint(1) NOT NULL,\n                  `max_active_chats` int(11) NOT NULL,\n                  `cache_version` int(11) unsigned NOT NULL DEFAULT '0',\n                  `pswd_updated` int(11) NOT NULL,\n                  `attr_int_1` int(11) NOT NULL,\n                  `attr_int_2` int(11) NOT NULL,\n                  `attr_int_3` int(11) NOT NULL,\n                   `force_logout` tinyint(1) unsigned NOT NULL DEFAULT '0',\n                  `llogin` bigint(20) unsigned NOT NULL DEFAULT '0',\n                  `always_on` tinyint(1) NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`id`),\n                  KEY `hide_online` (`hide_online`),\n                  KEY `rec_per_req` (`rec_per_req`),\n                  KEY `email` (`email`),\n                  KEY `disabled` (`disabled`),\n                  KEY `xmpp_username` (`xmpp_username`(191))\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $UserData = new erLhcoreClassModelUser();\n\n            $UserData->setPassword($form->AdminPassword);\n            $UserData->email   = $form->AdminEmail;\n            $UserData->name    = $form->AdminName;\n            $UserData->surname = $form->AdminSurname;\n            $UserData->username = $form->AdminUsername;\n            $UserData->all_departments = 1;\n            $UserData->departments_ids = 0;\n            $UserData->pswd_updated = time();\n\n            erLhcoreClassUser::getSession()->save($UserData);\n\n            // User departaments\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_userdep` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `user_id` int(11) NOT NULL,\n                  `dep_id` int(11) NOT NULL,\n                  `last_activity` int(11) NOT NULL,\n                  `lastd_activity` int(11) NOT NULL DEFAULT '0',\n                  `exclude_autoasign` tinyint(1) NOT NULL DEFAULT '0',\n                  `hide_online` int(11) NOT NULL,\n                  `last_accepted` int(11) NOT NULL DEFAULT '0',\n                  `active_chats` int(11) NOT NULL DEFAULT '0',\n                  `pending_chats` int(11) NOT NULL DEFAULT '0',\n                  `inactive_chats` int(11) NOT NULL DEFAULT '0',\n                  `max_chats` int(11) NOT NULL DEFAULT '0',\n                  `type` int(11) NOT NULL DEFAULT '0',\n                  `ro` tinyint(1) NOT NULL DEFAULT '0',\n                  `hide_online_ts` int(11) NOT NULL DEFAULT '0',\n                  `dep_group_id` int(11) NOT NULL DEFAULT '0',\n                  `always_on` tinyint(1) NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`id`),\n                  KEY `last_activity_hide_online_dep_id` (`last_activity`,`hide_online`,`dep_id`),\n                  KEY `dep_id` (`dep_id`),\n                  KEY `user_id_type` (`user_id`,`type`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n            // Insert record to departament instantly\n            $db->query(\"INSERT INTO `lh_userdep` (`user_id`,`dep_id`,`last_activity`,`hide_online`,`last_accepted`,`active_chats`,`type`,`dep_group_id`,`exclude_autoasign`) VALUES ({$UserData->id},0,0,0,0,0,0,0,0)\");\n\n            $db->query(\"CREATE TABLE `lh_group_work` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `group_id` int(11) NOT NULL, `group_work_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `group_id` (`group_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Transfer chat\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_transfer` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `chat_id` int(11) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `transfer_user_id` int(11) NOT NULL,\n\t\t\t\t  `from_dep_id` int(11) NOT NULL,\n\t\t\t\t  `ctime` int(11) NOT NULL,\n\t\t\t\t  `transfer_to_user_id` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `transfer_user_id_dep_id` (`transfer_user_id`,`dep_id`),\n\t\t\t\t  KEY `transfer_to_user_id` (`transfer_to_user_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Remember user table\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users_remember` (\n\t\t\t\t `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t `user_id` int(11) NOT NULL,\n\t\t\t\t `mtime` int(11) NOT NULL,\n\t\t\t\t PRIMARY KEY (`id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // API table\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_rest_api_key` (\n                    `id` int(11) NOT NULL AUTO_INCREMENT,\n                    `api_key` varchar(50) NOT NULL,\n                    `user_id` int(11) NOT NULL DEFAULT '0',\n                    `active` int(11) NOT NULL DEFAULT '0',\n                    `ip_restrictions` varchar(250) NOT NULL,\n                    PRIMARY KEY (`id`),\n                    KEY `api_key` (`api_key`),\n                    KEY `user_id` (`user_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_abstract_rest_api_key_remote` ( `id` int(11) NOT NULL AUTO_INCREMENT, `api_key` varchar(50) NOT NULL, `username` varchar(50) NOT NULL, `name` varchar(50) NOT NULL, `host` varchar(250) NOT NULL, `active` tinyint(1) NOT NULL DEFAULT '0', `position` int(11) NOT NULL DEFAULT '0', PRIMARY KEY (`id`), KEY `active` (`active`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n            $db->query(\"CREATE TABLE `lh_abstract_chat_variable` ( `id` int(11) NOT NULL AUTO_INCREMENT, `var_name` varchar(255) NOT NULL, `var_identifier` varchar(255) NOT NULL, `inv` tinyint(1) NOT NULL, `change_message` varchar(250) NOT NULL, `type` tinyint(1) NOT NULL, `persistent` tinyint(1) NOT NULL, `js_variable` varchar(255) NOT NULL, `dep_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `dep_id` (`dep_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_webhook` ( `id` int(11) NOT NULL AUTO_INCREMENT, `event` varchar(50) NOT NULL, `bot_id_alt` int(11) NOT NULL DEFAULT '0', `trigger_id_alt` int(11) NOT NULL DEFAULT '0',`bot_id` int(11) NOT NULL, `trigger_id` int(11) NOT NULL, `disabled` tinyint(1) NOT NULL, `configuration` longtext NOT NULL, `type` tinyint(1) NOT NULL DEFAULT 0, PRIMARY KEY (`id`), KEY `event_disabled` (`event`,`disabled`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_incoming_webhook` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL,`identifier` varchar(50) NOT NULL, `scope` varchar(50) NOT NULL, `dep_id` int(11) NOT NULL, `disabled` tinyint(1) NOT NULL, `configuration` longtext NOT NULL, PRIMARY KEY (`id`), KEY `identifier` (`identifier`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_chat_incoming` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `utime` bigint(20) NOT NULL, `incoming_id` int(11) NOT NULL, `payload` longtext NOT NULL, `chat_external_id` varchar(50) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`),  KEY `incoming_ext_id` (`incoming_id`,`chat_external_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_abstract_chat_column` (`id` int(11) NOT NULL AUTO_INCREMENT,`column_name` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,`variable` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, `position` int(11) NOT NULL, `enabled` tinyint(1) NOT NULL, `online_enabled` tinyint(1) NOT NULL, `chat_enabled` tinyint(1) NOT NULL, `conditions` text COLLATE utf8mb4_unicode_ci NOT NULL,`column_icon` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, `column_identifier` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, PRIMARY KEY (`id`), KEY `enabled` (`enabled`), KEY `online_enabled` (`online_enabled`), KEY `chat_enabled` (`chat_enabled`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n            $db->query(\"CREATE TABLE `lh_abstract_chat_priority` (`id` int(11) NOT NULL AUTO_INCREMENT,`value` text COLLATE utf8mb4_unicode_ci NOT NULL,`dep_id` int(11) NOT NULL, `dest_dep_id` int(11) NOT NULL DEFAULT 0, `sort_priority` int(11) NOT NULL DEFAULT 0,`priority` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `dep_id` (`dep_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_canned_msg_dep` (\n                                 `id` bigint(20) NOT NULL AUTO_INCREMENT,\n                                 `canned_id` int(11) NOT NULL,\n                                 `dep_id` int(11) NOT NULL,\n                                 PRIMARY KEY (`id`),\n                                 KEY `canned_id` (`canned_id`),\n                                 KEY `dep_id` (`dep_id`)\n                            ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            $db->query(\"CREATE TABLE `lh_canned_msg_subject` (\n    `id` int(11) NOT NULL AUTO_INCREMENT,\n    `canned_id` int(11) NOT NULL,\n    `subject_id` int(11) NOT NULL,\n    PRIMARY KEY (`id`),\n    KEY `canned_id` (`canned_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Session\n            $db->query(\"CREATE TABLE `lh_users_session` (\n                      `id` int(11) NOT NULL AUTO_INCREMENT,\n                      `token` varchar(40) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `device_type` int(11) NOT NULL,\n                      `device_token` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `user_id` int(11) NOT NULL,\n                      `created_on` int(11) NOT NULL,\n                      `updated_on` int(11) NOT NULL,\n                      `expires_on` int(11) NOT NULL,\n                      `notifications_status` int(11) NOT NULL DEFAULT 1,\n                      `error` int(11) NOT NULL DEFAULT 0,\n                      `last_error` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      PRIMARY KEY (`id`),\n                      KEY `token` (`token`),\n                      KEY `device_token_device_type_v2` (`device_token`(191),`device_type`),\n                      KEY `error` (`error`)\n                    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Chat messages\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_msg` (\n\t\t\t\t  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `msg` longtext NOT NULL,\n\t\t\t\t  `meta_msg` longtext NOT NULL,\n\t\t\t\t  `time` int(11) NOT NULL,\n\t\t\t\t  `chat_id` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_id` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `name_support` varchar(100) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `chat_id_id` (`chat_id`, `id`),\n\t\t\t\t  KEY `user_id` (`user_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Forgot password table\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_forgotpasswordhash` (\n                `id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,\n                `user_id` INT NOT NULL ,\n                `hash` VARCHAR( 40 ) NOT NULL ,\n                `created` INT NOT NULL\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // User groups table\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_groupuser` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `group_id` int(11) NOT NULL,\n                  `user_id` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `group_id` (`group_id`),\n                  KEY `user_id` (`user_id`),\n                  KEY `group_id_2` (`group_id`,`user_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Assign admin user to admin group\n            $GroupUser = new erLhcoreClassModelGroupUser();\n            $GroupUser->group_id = $GroupData->id;\n            $GroupUser->user_id = $UserData->id;\n            erLhcoreClassUser::getSession()->save($GroupUser);\n\n            //Assign default role functions\n            $db->query(\"CREATE TABLE IF NOT EXISTS `lh_rolefunction` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `role_id` int(11) NOT NULL,\n                  `module` varchar(100) NOT NULL,\n                  `function` varchar(100) NOT NULL,\n                  `limitation` text NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `role_id` (`role_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n            // Admin role and function\n            $RoleFunction = new erLhcoreClassModelRoleFunction();\n            $RoleFunction->role_id = $Role->id;\n            $RoleFunction->module = '*';\n            $RoleFunction->function = '*';\n            erLhcoreClassRole::getSession()->save($RoleFunction);\n\n            // Operators rules and functions\n            $permissionsArray = array(\n                array('module' => 'lhuser',  'function' => 'selfedit'),\n                array('module' => 'lhuser',  'function' => 'changeonlinestatus'),\n                array('module' => 'lhuser',  'function' => 'changeskypenick'),\n                array('module' => 'lhuser',  'function' => 'personalcannedmsg'),\n                array('module' => 'lhuser',  'function' => 'change_visibility_list'),\n                array('module' => 'lhuser',  'function' => 'see_assigned_departments'),\n                array('module' => 'lhuser',  'function' => 'canseedepartmentstats'),\n                array('module' => 'lhchat',  'function' => 'use'),\n                array('module' => 'lhchat',  'function' => 'open_all'),\n                array('module' => 'lhchat',  'function' => 'chattabschrome'),\n                array('module' => 'lhchat',  'function' => 'singlechatwindow'),\n                array('module' => 'lhchat',  'function' => 'allowopenremotechat'),\n                array('module' => 'lhchat',  'function' => 'writeremotechat'),\n                array('module' => 'lhchat',  'function' => 'allowchattabs'),\n                array('module' => 'lhchat',  'function' => 'use_onlineusers'),\n                array('module' => 'lhchat',  'function' => 'take_screenshot'),\n                array('module' => 'lhfront', 'function' => 'use'),\n                array('module' => 'lhchat', 'function' => 'prev_chats'),\n                array('module' => 'lhsystem','function' => 'use'),\n                array('module' => 'lhcannedmsg', 'function' => 'see_global'),\n                array('module' => 'lhtranslation','function' => 'use'),\n                array('module' => 'lhchat',  'function' => 'allowblockusers'),\n                array('module' => 'lhsystem','function' => 'generatejs'),\n                array('module' => 'lhsystem','function' => 'changelanguage'),\n                array('module' => 'lhchat',  'function' => 'allowredirect'),\n                array('module' => 'lhchat',  'function' => 'allowtransfer'),\n                array('module' => 'lhchat',  'function' => 'allowtransferdirectly'),\n                array('module' => 'lhchat',  'function' => 'administratecannedmsg'),\n                array('module' => 'lhchat',  'function' => 'sees_all_online_visitors'),\n                array('module' => 'lhpermission',   'function' => 'see_permissions'),\n                array('module' => 'lhquestionary',  'function' => 'manage_questionary'),\n                array('module' => 'lhfaq',   \t\t'function' => 'manage_faq'),\n                array('module' => 'lhchatbox',   \t'function' => 'manage_chatbox'),\n                array('module' => 'lhbrowseoffer',  'function' => 'manage_bo'),\n                array('module' => 'lhxml',   \t\t'function' => '*'),\n                array('module' => 'lhcobrowse',   \t'function' => 'browse'),\n                array('module' => 'lhfile',   \t\t'function' => 'use_operator'),\n                array('module' => 'lhfile',   \t\t'function' => 'file_delete_chat'),\n                array('module' => 'lhstatistic',   \t'function' => 'use'),\n                array('module' => 'lhspeech', 'function' => 'changedefaultlanguage'),\n                array('module' => 'lhspeech', 'function' => 'use'),\n                array('module' => 'lhcannedmsg', 'function' => 'use'),\n                array('module' => 'lhtheme', 'function' => 'personaltheme'),\n                array('module' => 'lhuser', 'function' => 'userlistonline'),\n                array('module' => 'lhspeech', 'function' => 'change_chat_recognition'),\n                array('module' => 'lhgroupchat', 'function' => 'use'),\n                array('module' => 'lhuser', 'function' => 'see_all_group_users'),\n                array('module' => 'lhvoicevideo', 'function' => 'use'),\n            );\n\n            foreach ($permissionsArray as $paramsPermission) {\n                $RoleFunctionOperator = new erLhcoreClassModelRoleFunction();\n                $RoleFunctionOperator->role_id = $RoleOperators->id;\n                $RoleFunctionOperator->module = $paramsPermission['module'];\n                $RoleFunctionOperator->function = $paramsPermission['function'];\n                erLhcoreClassRole::getSession()->save($RoleFunctionOperator);\n            }\n\n            $cfgSite = erConfigClassLhConfig::getInstance();\n            $cfgSite->setSetting( 'site', 'installed', true);\n            $cfgSite->setSetting( 'site', 'templatecache', true);\n            $cfgSite->setSetting( 'site', 'templatecompile', true);\n            $cfgSite->setSetting( 'site', 'modulecompile', true);\n            $cfgSite->setSetting( 'site', 'force_virtual_host', $form->ForceVirtualHost == 1);\n            $cfgSite->setSetting( 'webhooks', 'enabled', isset($form->WebhooksEnabled) &&$form->WebhooksEnabled == 1);\n            $cfgSite->setSetting( 'webhooks', 'worker', isset($form->WebhooksWorker) ? $form->WebhooksWorker : 'http');\n            \n            if ($form->Extensions != '') {\n                $extensions = explode(',',str_replace(' ','',$form->Extensions));\n                if (!empty($extensions) ) {\n                    $cfgSite->setSetting( 'site', 'extensions', $extensions);\n                }\n            }\n\n            if ($form->ApacheUserGroupName != '') {\n                $cfgSite->setSetting( 'site', 'default_group', $form->ApacheUserGroupName);\n            }\n\n            if ($form->ApacheUserName != '') {\n                $cfgSite->setSetting( 'site', 'default_user', $form->ApacheUserName);\n            }\n\n            if ($form->TimeZone != '') {\n                $cfgSite->setSetting( 'site', 'time_zone', $form->TimeZone);\n            }\n\n            if (isset($form->DefaultConfigs) && is_array($form->DefaultConfigs)) {\n                foreach ($form->DefaultConfigs as $identifier => $value) {\n                    $sql = \"UPDATE `lh_chat_config` SET `value` = :value WHERE `identifier` = :identifier\";\n                    $stmt = $db->prepare($sql);\n                    $stmt->bindValue(':value',$value);\n                    $stmt->bindValue(':identifier',$identifier);\n                    $stmt->execute();\n                }\n            }\n\n            $smtpData = erLhcoreClassModelChatConfig::fetch('smtp_data');\n\n            $data = (array)$smtpData->data;\n            $data['default_from'] = 'info@'.$form->Domain;\n            $data['default_from_name'] = trim($form->AdminName . ' ' . $form->AdminSurname);\n            $data['sender'] = 'info@'.$form->Domain;\n\n            $smtpData->value = serialize($data);\n            $smtpData->saveThis();\n\n            return true;\n        } else {\n            return $Errors;\n        }\n    }\n\n    function step4() {\n        $cfgSite = erConfigClassLhConfig::getInstance();\n        $cfgSite->save();\n        $msg = \"Installation is complete. You can start by adding users and departments\";\n        syslog(LOG_DEBUG, $msg);\n    }\n\n    function print_errors($errors) {\n        foreach($errors as $error) {\n            syslog(LOG_ERR, \"ERROR: \".$error);\n        }\n        exit(-1);\n    }\n\n    private function file_perms($file, $octal = true) {\n        if(!file_exists($file)) return false;\n\n        $perms = fileperms($file);\n\n        $cut = $octal ? 2 : 3;\n\n        return substr(decoct($perms), $cut);\n    }\n    private function file_is_writable($directories, $preffix = '', &$Errors) {\n        foreach ($directories as $directory) {\n            $error = false;\n            syslog(LOG_DEBUG, \"Evaluate $directory if writable\");\n            $owner = fileowner($preffix.$directory);\n            $group = filegroup($preffix.$directory);\n            $permission = $this->file_perms($preffix.$directory);\n            if ($permission[2] == 7) {\n                continue;\n            }\n            if ($owner == 33 and $permission[0] != 7) {\n                $error = true;\n            }\n            if ($group == 33 and $permission[1] != 7) {\n                $error = true;\n            }\n            if ($error) {\n                $Errors[] = $preffix.$directory.\" is not writable\";\n            }\n        }\n    }\n\n    private function _scandir($directory) {\n        $directories = scandir($directory);\n        $directories = array_diff($directories, ['.']);\n        $directories = array_diff($directories, ['..']);\n        return $directories;\n    }\n}\n", "<?php\nerLhcoreClassRestAPIHandler::setHeaders();\n\nheader('P3P:CP=\"IDC DSP COR ADM DEVi TAIi PSA PSD IVAi IVDi CONi HIS OUR IND CNT\"');\nheader('Expires: Sat, 26 Jul 1997 05:00:00 GMT' );\nheader('Last-Modified: ' . gmdate( 'D, d M Y H:i:s',time()+60*60*8 ) . ' GMT' );\nheader('Cache-Control: no-store, no-cache, must-revalidate' );\nheader('Cache-Control: post-check=0, pre-check=0', false );\nheader('Pragma: no-cache' );\n\n$hash = sha1(erLhcoreClassIPDetect::getIP() . $Params['user_parameters']['timets'] . erConfigClassLhConfig::getInstance()->getSetting( 'site', 'secrethash' ));\n\nif ( (time()-$Params['user_parameters']['timets']) > 600 || (time()-($Params['user_parameters']['timets'] - 5)) < 0) {\n\techo json_encode(array('result' => 'false'));\n\texit;\n}\n\nif (erLhcoreClassModelChatConfig::fetch('session_captcha')->current_value == 1) {\n\t// Start session if required only\n\t$currentUser = erLhcoreClassUser::instance();\n\t\n\t$_SESSION[$_SERVER['REMOTE_ADDR']][$Params['user_parameters']['captcha_name']] = $hash;\n}\n\necho json_encode(array('result' => $hash));\n\nexit;", "<?php\n\ntry {\n\n    $cfgSite = erConfigClassLhConfig::getInstance();\n\n    if ($cfgSite->getSetting( 'site', 'installed' ) == true)\n    {\n        $Params['module']['functions'] = array('install');\n        include_once('modules/lhkernel/nopermission.php');\n\n        $Result['pagelayout'] = 'install';\n        $Result['path'] = array(array('title' => 'Live helper chat installation'));\n        return $Result;\n\n        exit;\n    }\n\n    $instance = erLhcoreClassSystem::instance();\n\n    if ($instance->SiteAccess != 'site_admin') {\n        header('Location: ' .erLhcoreClassDesign::baseurldirect('site_admin/install/install') );\n        exit;\n    }\n\n    $tpl = new erLhcoreClassTemplate( 'lhinstall/install1.tpl.php');\n\n    switch ((int)$Params['user_parameters']['step_id']) {\n\n        case '1':\n            $Errors = array();\n            if (!is_writable(\"cache/cacheconfig\"))\n                $Errors[] = \"cache/cacheconfig is not writable\";\n\n            if (!is_writable(\"settings/\"))\n                $Errors[] = \"settings/ is not writable\";\n\n            if (!is_writable(\"cache/translations\"))\n                $Errors[] = \"cache/translations is not writable\";\n\n            if (!is_writable(\"cache/userinfo\"))\n                $Errors[] = \"cache/userinfo is not writable\";\n\n            if (!is_writable(\"cache/compiledtemplates\"))\n                $Errors[] = \"cache/compiledtemplates is not writable\";\n\n            if (!is_writable(\"var/storage\"))\n                $Errors[] = \"var/storage is not writable\";\n\n            if (!is_writable(\"var/storageform\"))\n                $Errors[] = \"var/storageform is not writable\";\n\n            if (!is_writable(\"var/userphoto\"))\n                $Errors[] = \"var/userphoto is not writable\";\n\n            if (!is_writable(\"var/tmpfiles\"))\n                $Errors[] = \"var/tmpfiles is not writable\";\n\n            if (!is_writable(\"var/storagetheme\"))\n                $Errors[] = \"var/storagetheme is not writable\";\n\n            if (!is_writable(\"var/botphoto\"))\n                $Errors[] = \"var/botphoto is not writable\";\n\n            if (!is_writable(\"var/bottrphoto\"))\n                $Errors[] = \"var/bottrphoto is not writable\";\n\n            if (!is_writable(\"var/storageinvitation\"))\n                $Errors[] = \"var/storageinvitation is not writable\";\n\n            if (!is_writable(\"var/storageadmintheme\"))\n                $Errors[] = \"var/storageadmintheme is not writable\";\n\n            if (!extension_loaded ('pdo_mysql' ))\n                $Errors[] = \"php-pdo extension not detected. Please install php extension\";\n\n            if (!extension_loaded('curl'))\n                $Errors[] = \"php_curl extension not detected. Please install php extension\";\n\n            if (!extension_loaded('mbstring'))\n                $Errors[] = \"mbstring extension not detected. Please install php extension\";\n\n            if (!extension_loaded('gd'))\n                $Errors[] = \"gd extension not detected. Please install php extension\";\n\n            if (!function_exists('json_encode'))\n                $Errors[] = \"json support not detected. Please install php extension\";\n\n            if (!function_exists('simplexml_load_string'))\n                $Errors[] = \"XML support not detected. Please install php-xml extension\";\n\n            if (version_compare(PHP_VERSION, '5.4.0','<')) {\n                $Errors[] = \"Minimum 5.4.0 PHP version is required\";\n            }\n\n            if (count($Errors) == 0){\n                $tpl->setFile('lhinstall/install2.tpl.php');\n            }\n            break;\n\n        case '2':\n            $Errors = array();\n\n            $definition = array(\n                'DatabaseUsername' => new ezcInputFormDefinitionElement(\n                    ezcInputFormDefinitionElement::REQUIRED, 'unsafe_raw'\n                ),\n                'DatabasePassword' => new ezcInputFormDefinitionElement(\n                    ezcInputFormDefinitionElement::REQUIRED, 'unsafe_raw'\n                ),\n                'DatabaseHost' => new ezcInputFormDefinitionElement(\n                    ezcInputFormDefinitionElement::REQUIRED, 'string'\n                ),\n                'DatabasePort' => new ezcInputFormDefinitionElement(\n                    ezcInputFormDefinitionElement::REQUIRED, 'int'\n                ),\n                'DatabaseDatabaseName' => new ezcInputFormDefinitionElement(\n                    ezcInputFormDefinitionElement::REQUIRED, 'string'\n                ),\n            );\n\n            $form = new ezcInputForm( INPUT_POST, $definition );\n\n\n            if ( !$form->hasValidData( 'DatabaseUsername' ) )\n            {\n                $Errors[] = 'Please enter database username';\n            }\n\n            if ( !$form->hasValidData( 'DatabasePassword' ) )\n            {\n                $Errors[] = 'Please enter database password';\n            }\n\n            if ( !$form->hasValidData( 'DatabaseHost' ) || $form->DatabaseHost == '' )\n            {\n                $Errors[] = 'Please enter database host';\n            }\n\n            if ( !$form->hasValidData( 'DatabasePort' ) || $form->DatabasePort == '' )\n            {\n                $Errors[] = 'Please enter database post';\n            }\n\n            if ( !$form->hasValidData( 'DatabaseDatabaseName' ) || $form->DatabaseDatabaseName == '' )\n            {\n                $Errors[] = 'Please enter database name';\n            }\n\n            if (count($Errors) == 0)\n            {\n                try {\n                    $db = ezcDbFactory::create( \"mysql://{$form->DatabaseUsername}:{$form->DatabasePassword}@{$form->DatabaseHost}:{$form->DatabasePort}/{$form->DatabaseDatabaseName}\" );\n                } catch (Exception $e) {\n                    $Errors[] = 'Cannot login with provided logins. Returned message: <br/>'.$e->getMessage();\n                }\n            }\n\n            if (count($Errors) == 0){\n\n                $cfgSite = erConfigClassLhConfig::getInstance();\n                $cfgSite->setSetting( 'db', 'host', $form->DatabaseHost);\n                $cfgSite->setSetting( 'db', 'user', $form->DatabaseUsername);\n                $cfgSite->setSetting( 'db', 'password', $form->DatabasePassword);\n                $cfgSite->setSetting( 'db', 'database', $form->DatabaseDatabaseName);\n                $cfgSite->setSetting( 'db', 'port', $form->DatabasePort);\n                $cfgSite->setSetting( 'site', 'secrethash', (!empty(getenv('LHC_SECRET_HASH')) ? getenv('LHC_SECRET_HASH') : erLhcoreClassChat::generateHash(80)));\n                $cfgSite->save();\n\n                $tpl->setFile('lhinstall/install3.tpl.php');\n            } else {\n\n                $tpl->set('db_username',$form->DatabaseUsername);\n                $tpl->set('db_password',$form->DatabasePassword);\n                $tpl->set('db_host',$form->DatabaseHost);\n                $tpl->set('db_port',$form->DatabasePort);\n                $tpl->set('db_name',$form->DatabaseDatabaseName);\n\n                $tpl->set('errors',$Errors);\n                $tpl->setFile('lhinstall/install2.tpl.php');\n            }\n            break;\n\n        case '3':\n\n            $Errors = array();\n\n            if ($_SERVER['REQUEST_METHOD'] == 'POST')\n            {\n                $definition = array(\n                    'AdminUsername' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::REQUIRED, 'unsafe_raw'\n                    ),\n                    'AdminPassword' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::REQUIRED, 'unsafe_raw'\n                    ),\n                    'AdminPassword1' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::REQUIRED, 'unsafe_raw'\n                    ),\n                    'AdminEmail' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::REQUIRED, 'validate_email'\n                    ),\n                    'AdminName' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::OPTIONAL, 'unsafe_raw'\n                    ),\n                    'AdminSurname' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::OPTIONAL, 'unsafe_raw'\n                    ),\n                    'DefaultDepartament' => new ezcInputFormDefinitionElement(\n                        ezcInputFormDefinitionElement::REQUIRED, 'string'\n                    )\n                );\n\n                $form = new ezcInputForm( INPUT_POST, $definition );\n\n\n                if ( !$form->hasValidData( 'AdminUsername' ) || $form->AdminUsername == '')\n                {\n                    $Errors[] = 'Please enter admin username';\n                }\n\n                if ($form->hasValidData( 'AdminUsername' ) && $form->AdminUsername != '' && strlen($form->AdminUsername) > 40)\n                {\n                    $Errors[] = 'Maximum 40 characters for admin username';\n                }\n\n                if ( !$form->hasValidData( 'AdminPassword' ) || $form->AdminPassword == '')\n                {\n                    $Errors[] = 'Please enter admin password';\n                }\n\n                if ($form->hasValidData( 'AdminPassword' ) && $form->AdminPassword != '' && strlen($form->AdminPassword) > 40)\n                {\n                    $Errors[] = 'Maximum 40 characters for admin password';\n                }\n\n                if ($form->hasValidData( 'AdminPassword' ) && $form->AdminPassword != '' && strlen($form->AdminPassword) <= 40 && $form->AdminPassword1 != $form->AdminPassword)\n                {\n                    $Errors[] = 'Passwords missmatch';\n                }\n\n\n                if ( !$form->hasValidData( 'AdminEmail' ) )\n                {\n                    $Errors[] = 'Wrong email address';\n                }\n\n\n                if ( !$form->hasValidData( 'DefaultDepartament' ) || $form->DefaultDepartament == '')\n                {\n                    $Errors[] = 'Please enter default department name';\n                }\n\n                if (count($Errors) == 0) {\n\n                    $tpl->set('admin_username',$form->AdminUsername);\n                    $adminEmail = '';\n                    if ( $form->hasValidData( 'AdminEmail' ) ) {\n                        $tpl->set('admin_email',$form->AdminEmail);\n                        $adminEmail = $form->AdminEmail;\n                    }\n                    $tpl->set('admin_name',$form->AdminName);\n                    $tpl->set('admin_surname',$form->AdminSurname);\n                    $tpl->set('admin_departament',$form->DefaultDepartament);\n\n                    /*DATABASE TABLES SETUP*/\n                    $db = ezcDbInstance::get();\n\n                    try {\n                        $db->query(\"set global innodb_large_prefix = 1\");\n                    } catch (Exception $e) {\n                        // Just ignore if not succeed\n                    }\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat` (\n\t\t\t\t  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `nick` varchar(100) NOT NULL,\n\t\t\t\t  `status` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `status_sub` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `status_sub_sub` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `time` int(11) NOT NULL,\n\t\t\t\t  `user_id` int(11) NOT NULL,\n\t\t\t\t  `hash` varchar(40) NOT NULL,\n\t\t\t\t  `referrer` text NOT NULL,\n        \t   \t  `session_referrer` text NOT NULL,\n        \t   \t  `chat_variables` text NOT NULL,\n        \t   \t  `remarks` text NOT NULL,\n\t\t\t\t  `ip` varchar(100) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\t\t\t\t \n\t\t\t\t  `invitation_id` int(11) NOT NULL,\t\t\t\t \n\t\t\t\t  `sender_user_id` int(11) NOT NULL,\n\t\t\t\t  `product_id` int(11) NOT NULL,\n\t\t\t\t  `pnd_time` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `cls_time` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `usaccept` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_status` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_closed_ts` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `support_informed` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `unread_messages_informed` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `reinform_timeout` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `last_op_msg_time` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `has_unread_op_messages` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `unread_op_messages_informed` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `email` varchar(100) NOT NULL,\n\t\t\t\t  `country_code` varchar(100) NOT NULL,\n\t\t\t\t  `country_name` varchar(100) NOT NULL,\n\t\t\t\t  `unanswered_chat` int(11) NOT NULL,\n\t\t\t\t  `cls_us` tinyint(1) NOT NULL DEFAULT '0',\n\t\t\t\t  `anonymized` tinyint(1) NOT NULL,\n\t\t\t\t  `user_typing` int(11) NOT NULL,\n\t\t\t\t  `gbot_id` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_typing_txt` varchar(200) NOT NULL,\n\t\t\t\t  `operator_typing` int(11) NOT NULL,\n        \t   \t  `operator_typing_id` int(11) NOT NULL,\n\t\t\t\t  `phone` varchar(100) NOT NULL,\n\t\t\t\t  `has_unread_messages` int(11) NOT NULL,\n\t\t\t\t  `last_user_msg_time` int(11) NOT NULL,\n\t\t\t\t  `fbst` tinyint(1) NOT NULL,\n\t\t\t\t  `online_user_id` int(11) NOT NULL,\n\t\t\t\t  `auto_responder_id` int(11) NOT NULL,\n\t\t\t\t  `last_msg_id` int(11) NOT NULL,\n\t\t\t\t  `lsync` int(11) NOT NULL,\n\t\t\t\t  `transfer_uid` int(11) NOT NULL,\n\t\t\t\t  `additional_data` text NOT NULL,\t\t\t\t  \n\t\t\t\t  `user_tz_identifier` varchar(50) NOT NULL,\n\t\t\t\t  `lat` varchar(10) NOT NULL,\n\t\t\t\t  `lon` varchar(10) NOT NULL,\n\t\t\t\t  `city` varchar(100) NOT NULL,\n\t\t\t\t  `operation` text NOT NULL,\n\t\t\t\t  `operation_admin` varchar(200) NOT NULL,\n\t\t\t\t  `status_sub_arg` varchar(200) NOT NULL,\n\t\t\t\t  `uagent` varchar(250) NOT NULL,\n\t\t\t\t  `chat_locale` varchar(10) NOT NULL,\n\t\t\t\t  `chat_locale_to` varchar(10) NOT NULL,\n\t\t\t\t  `mail_send` int(11) NOT NULL,\n        \t   \t  `screenshot_id` int(11) NOT NULL,\n        \t   \t  `wait_time` int(11) NOT NULL,\n  \t\t\t\t  `chat_duration` int(11) NOT NULL,\n  \t\t\t\t  `tslasign` int(11) NOT NULL,\n        \t   \t  `priority` int(11) NOT NULL,\n        \t   \t  `chat_initiator` int(11) NOT NULL,\n        \t   \t  `transfer_timeout_ts` int(11) NOT NULL,\n        \t   \t  `transfer_timeout_ac` int(11) NOT NULL,\n        \t   \t  `transfer_if_na` int(11) NOT NULL,\n        \t   \t  `na_cb_executed` int(11) NOT NULL,\n        \t   \t  `device_type` int(11) NOT NULL,\n        \t   \t  `nc_cb_executed` tinyint(1) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `status_user_id` (`status`,`user_id`),\n\t\t\t\t  KEY `unanswered_chat` (`unanswered_chat`),\n\t\t\t\t  KEY `online_user_id` (`online_user_id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `product_id` (`product_id`),\n\t\t\t\t  KEY `unread_operator` (`has_unread_op_messages`,`unread_op_messages_informed`),\n\t\t\t\t  KEY `user_id_sender_user_id` (`user_id`,`sender_user_id`),\n\t\t\t\t  KEY `sender_user_id` (`sender_user_id`),\n\t\t\t\t  KEY `anonymized` (`anonymized`),\n\t\t\t\t  KEY `has_unread_messages` (`has_unread_messages`),\n\t\t\t\t  KEY `status` (`status`),\n\t\t\t\t  KEY `nick` (`nick`),\n\t\t\t\t  KEY `email` (`email`),\n\t\t\t\t  KEY `dep_id_status` (`dep_id`,`status`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n               $db->query(\"CREATE TABLE `lh_chat_blocked_user` (\n                  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `ip` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `user_id` bigint(20) unsigned NOT NULL,\n                  `datets` bigint(20) unsigned NOT NULL,\n                  `chat_id` bigint(20) unsigned NOT NULL,\n                  `dep_id` bigint(20) unsigned NOT NULL,\n                  `nick` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `btype` tinyint(1) NOT NULL DEFAULT 0,\n                  `expires` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  `online_user_id` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  PRIMARY KEY (`id`),\n                  KEY `ip` (`ip`),\n                  KEY `nick` (`nick`),\n                  KEY `online_user_id` (`online_user_id`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_users_online_session` ( \n        \t       `id` bigint(20) NOT NULL AUTO_INCREMENT, \n        \t       `user_id` int(11) NOT NULL, \n        \t       `time` int(11) NOT NULL, \n        \t       `duration` int(11) NOT NULL, \n        \t       `lactivity` int(11) NOT NULL, \n        \t       PRIMARY KEY (`id`), \n        \t       KEY `user_id_lactivity` (`user_id`, `lactivity`), KEY `lactivity` (`lactivity`) ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_chat_start_settings` ( \n        \t       `id` int(11) NOT NULL AUTO_INCREMENT, \n        \t       `name` varchar(50) NOT NULL, \n        \t       `data` longtext NOT NULL, \n        \t       `department_id` int(11) NOT NULL, \n        \t       PRIMARY KEY (`id`), \n        \t       KEY `department_id` (`department_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_chat_event_track` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL, `data` longtext NOT NULL, `department_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `department_id` (`department_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_archive_range` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `range_from` int(11) NOT NULL,\n        \t   `range_to` int(11) NOT NULL,\n        \t   `year_month` int(11) NOT NULL,\n        \t   `older_than` int(11) NOT NULL,\n        \t   `last_id` int(11) NOT NULL,\n        \t   `first_id` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_notification_subscriber` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `online_user_id` bigint(20) NOT NULL, `dep_id` int(11) NOT NULL, `theme_id` int(11) NOT NULL, `ctime` int(11) NOT NULL, `utime` int(11) NOT NULL, `status` int(11) NOT NULL, `params` text NOT NULL, `device_type` tinyint(1) NOT NULL,`subscriber_hash` varchar(50) NOT NULL, `uagent` varchar(250) NOT NULL, `ip` varchar(250) NOT NULL, `last_error` text NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`), KEY `dep_id` (`dep_id`), KEY `online_user_id` (`online_user_id`), KEY `subscriber_hash` (`subscriber_hash`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_auto_responder` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `siteaccess` varchar(3) NOT NULL,\n                  `wait_message` text NOT NULL,\n                  `wait_timeout` int(11) NOT NULL,\n                  `position` int(11) NOT NULL,\n                  `timeout_message` text NOT NULL,\n                  `bot_configuration` text NOT NULL,\n                  `name` varchar(50) NOT NULL,\n                  `operator` varchar(50) NOT NULL,\n                  `dep_id` int(11) NOT NULL,\n                  `user_id` int(11) NOT NULL,\n                  `only_proactive` int(11) NOT NULL,\n                  `repeat_number` int(11) NOT NULL DEFAULT '1',\n                  `survey_timeout` int(11) NOT NULL DEFAULT '0',\n                  `survey_id` int(11) NOT NULL DEFAULT '0',\n                  `wait_timeout_hold_1` int(11) NOT NULL,\n                  `wait_timeout_hold_2` int(11) NOT NULL,\n                  `wait_timeout_hold_3` int(11) NOT NULL,\n                  `wait_timeout_hold_4` int(11) NOT NULL,\n                  `wait_timeout_hold_5` int(11) NOT NULL,\n                  `timeout_hold_message_1` text NOT NULL,\n                  `timeout_hold_message_2` text NOT NULL,\n                  `timeout_hold_message_3` text NOT NULL,\n                  `timeout_hold_message_4` text NOT NULL,\n                  `timeout_hold_message_5` text NOT NULL,\n                  `wait_timeout_hold` text NOT NULL,\n                  `wait_timeout_2` int(11) NOT NULL,\n                  `timeout_message_2` text NOT NULL,\n                  `wait_timeout_3` int(11) NOT NULL,\n                  `timeout_message_3` text NOT NULL,\n                  `wait_timeout_4` int(11) NOT NULL,\n                  `timeout_message_4` text NOT NULL,\n                  `wait_timeout_5` int(11) NOT NULL,\n                  `timeout_message_5` text NOT NULL,\n                  `wait_timeout_reply_1` int(11) NOT NULL,\n                  `timeout_reply_message_1` text NOT NULL,\n                  `wait_timeout_reply_2` int(11) NOT NULL,\n                  `timeout_reply_message_2` text NOT NULL,\n                  `wait_timeout_reply_3` int(11) NOT NULL,\n                  `timeout_reply_message_3` text NOT NULL,\n                  `wait_timeout_reply_4` int(11) NOT NULL,\n                  `timeout_reply_message_4` text NOT NULL,\n                  `wait_timeout_reply_5` int(11) NOT NULL,\n                  `timeout_reply_message_5` text NOT NULL,\n                  `languages` text NOT NULL,\n                  `ignore_pa_chat` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `siteaccess_position` (`siteaccess`,`position`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_widget_theme` (\n                      `id` int(11) NOT NULL AUTO_INCREMENT,\n                      `name` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `name_company` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `onl_bcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `bor_bcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT 'e3e3e3',\n                      `text_color` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `online_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `online_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `offline_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `offline_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `logo_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `logo_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `header_background` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_tcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_bcolor` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_border` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_close_bg` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_hover_bg` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_close_hover_bg` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `custom_status_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `custom_container_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `custom_widget_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_header` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `need_help_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `online_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `offline_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `widget_border_color` varchar(10) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `copyright_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `copyright_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `widget_copyright_url` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `show_copyright` int(11) NOT NULL DEFAULT 1,\n                      `explain_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `intro_operator_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `operator_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `operator_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `minimize_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `minimize_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `restore_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `restore_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `close_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `close_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `popup_image` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `popup_image_path` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `hide_close` int(11) NOT NULL,\n                      `hide_popup` int(11) NOT NULL,\n                      `header_height` int(11) NOT NULL,\n                      `header_padding` int(11) NOT NULL,\n                      `widget_border_width` int(11) NOT NULL,\n                      `support_joined` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `support_closed` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `pending_join` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `noonline_operators` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `noonline_operators_offline` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `show_need_help` int(11) NOT NULL DEFAULT 1,\n                      `show_need_help_timeout` int(11) NOT NULL DEFAULT 24,\n                      `show_voting` tinyint(1) NOT NULL DEFAULT 1,\n                      `department_title` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `department_select` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `buble_visitor_background` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `buble_visitor_title_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `buble_visitor_text_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `buble_operator_background` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `buble_operator_title_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `buble_operator_text_color` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `custom_popup_css` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `hide_ts` int(11) NOT NULL,\n                      `widget_response_width` int(11) NOT NULL,\n                      `show_need_help_delay` int(11) NOT NULL,\n                      `show_status_delay` int(11) NOT NULL,\n                      `modern_look` tinyint(1) NOT NULL DEFAULT 0,\n                      `bot_status_text` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `bot_configuration` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `notification_configuration` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `pending_join_queue` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `modified` int(11) NOT NULL,\n                      `widget_show_leave_form` tinyint(1) NOT NULL,\n                      `enable_widget_embed_override` tinyint(1) NOT NULL,\n                      `widget_popheight` int(11) NOT NULL,\n                      `widget_popwidth` int(11) NOT NULL,\n                      `widget_survey` int(11) NOT NULL,\n                      `widget_position` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `widget_pright` int(11) NOT NULL,\n                      `widget_pbottom` int(11) NOT NULL,\n                      `alias` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      PRIMARY KEY (`id`),\n                      KEY `alias` (`alias`)\n                    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_faq` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `question` varchar(250) NOT NULL,\n\t\t\t\t  `answer` text NOT NULL,\n\t\t\t\t  `url` varchar(250) NOT NULL,\n\t\t\t\t  `email` varchar(50) NOT NULL,\n\t\t\t\t  `identifier` varchar(10) NOT NULL,\n\t\t\t\t  `active` int(11) NOT NULL,\n\t\t\t\t  `has_url` tinyint(1) NOT NULL,\n\t\t\t\t  `is_wildcard` tinyint(1) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `active` (`active`),\n\t\t\t\t  KEY `active_url_2` (`active`,`url`(191)),\n\t\t\t\t  KEY `has_url` (`has_url`),\n\t\t\t\t  KEY `identifier` (`identifier`),\n\t\t\t\t  KEY `is_wildcard` (`is_wildcard`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    $db->query(\"CREATE TABLE `lh_group_chat` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `name` varchar(50) NOT NULL,\n  `status` int(11) NOT NULL,\n  `time` int(11) NOT NULL,\n  `user_id` int(11) NOT NULL,\n  `chat_id` bigint(20) NOT NULL DEFAULT 0,\n  `last_msg_op_id` bigint(20) NOT NULL,\n  `last_msg` varchar(200) NOT NULL,\n  `last_user_msg_time` int(11) NOT NULL,\n  `last_msg_id` bigint(20) NOT NULL,\n  `type` tinyint(1) NOT NULL DEFAULT 0,\n  `tm` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `user_id` (`user_id`),\n  KEY `chat_id` (`chat_id`),\n  KEY `type` (`type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_group_msg` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `msg` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n  `time` int(11) NOT NULL,\n  `chat_id` int(11) NOT NULL DEFAULT 0,\n  `user_id` int(11) NOT NULL DEFAULT 0,\n  `name_support` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `meta_msg` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `chat_id_id` (`chat_id`,`id`),\n  KEY `user_id` (`user_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_group_chat_member` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n  `user_id` bigint(20) NOT NULL,\n  `group_id` bigint(20) NOT NULL,\n  `last_activity` int(11) NOT NULL,\n  `last_msg_id` bigint(20) NOT NULL DEFAULT 0,\n  `type` tinyint(1) NOT NULL DEFAULT 0,\n  `jtime` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `group_id` (`group_id`),\n  KEY `user_id` (`user_id`),\n  KEY `type` (`type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_cobrowse` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `chat_id` int(11) NOT NULL,\n        \t   `online_user_id` int(11) NOT NULL,\n        \t   `mtime` int(11) NOT NULL,\n        \t   `url` varchar(250) NOT NULL,\n        \t   `initialize` longtext NOT NULL,\n        \t   `modifications` longtext NOT NULL,\n        \t   `finished` tinyint(1) NOT NULL,\n        \t   `w` int NOT NULL,\n\t\t\t   `wh` int NOT NULL,\n\t\t\t   `x` int NOT NULL,\n\t\t\t   `y` int NOT NULL,        \t   \t\t\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `chat_id` (`chat_id`),\n        \t   KEY `online_user_id` (`online_user_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_survey` (\n        \t      `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `name` varchar(250) NOT NULL,\n                  `feedback_text` text NOT NULL,\n                  `max_stars_1_title` varchar(250) NOT NULL,\n                  `max_stars_1_pos` int(11) NOT NULL,\n                  `max_stars_2_title` varchar(250) NOT NULL,\n                  `max_stars_2_pos` int(11) NOT NULL,\n                  `max_stars_2` int(11) NOT NULL,\n                  `max_stars_3_title` varchar(250) NOT NULL,\n                  `max_stars_3_pos` int(11) NOT NULL,\n                  `max_stars_3` int(11) NOT NULL,\n                  `max_stars_4_title` varchar(250) NOT NULL,\n                  `max_stars_4_pos` int(11) NOT NULL,\n                  `max_stars_4` int(11) NOT NULL,\n                  `max_stars_5_title` varchar(250) NOT NULL,\n                  `max_stars_5_pos` int(11) NOT NULL,\n                  `max_stars_5` int(11) NOT NULL,\n                  `question_options_1` varchar(250) NOT NULL,\n                  `question_options_1_items` text NOT NULL,\n                  `question_options_1_pos` int(11) NOT NULL,\n                  `question_options_2` varchar(250) NOT NULL,\n                  `question_options_2_items` text NOT NULL,\n                  `question_options_2_pos` int(11) NOT NULL,\n                  `question_options_3` varchar(250) NOT NULL,\n                  `question_options_3_items` text NOT NULL,\n                  `question_options_3_pos` int(11) NOT NULL,\n                  `question_options_4` varchar(250) NOT NULL,\n                  `question_options_4_items` text NOT NULL,\n                  `question_options_4_pos` int(11) NOT NULL,\n                  `question_options_5` varchar(250) NOT NULL,\n                  `question_options_5_items` text NOT NULL,\n                  `question_options_5_pos` int(11) NOT NULL,\n                  `question_plain_1` text NOT NULL,\n                  `question_plain_1_pos` int(11) NOT NULL,\n                  `question_plain_2` text NOT NULL,\n                  `question_plain_2_pos` int(11) NOT NULL,\n                  `question_plain_3` text NOT NULL,\n                  `question_plain_3_pos` int(11) NOT NULL,\n                  `question_plain_4` text NOT NULL,\n                  `question_plain_4_pos` int(11) NOT NULL,\n                  `question_plain_5` text NOT NULL,\n                  `question_plain_5_pos` int(11) NOT NULL,\n                  `max_stars_1_enabled` int(11) NOT NULL,\n                  `max_stars_2_enabled` int(11) NOT NULL,\n                  `max_stars_3_enabled` int(11) NOT NULL,\n                  `max_stars_4_enabled` int(11) NOT NULL,\n                  `max_stars_5_enabled` int(11) NOT NULL,\n                  `question_options_1_enabled` int(11) NOT NULL,\n                  `question_options_2_enabled` int(11) NOT NULL,\n                  `question_options_3_enabled` int(11) NOT NULL,\n                  `question_options_4_enabled` int(11) NOT NULL,\n                  `question_options_5_enabled` int(11) NOT NULL,\n                  `question_plain_1_enabled` int(11) NOT NULL,\n                  `question_plain_2_enabled` int(11) NOT NULL,\n                  `question_plain_3_enabled` int(11) NOT NULL,\n                  `question_plain_4_enabled` int(11) NOT NULL,\n                  `question_plain_5_enabled` int(11) NOT NULL,\n                  `max_stars_1` int(11) NOT NULL,\n                  `max_stars_1_req` int(11) NOT NULL,\n                  `max_stars_2_req` int(11) NOT NULL,\n                  `max_stars_3_req` int(11) NOT NULL,\n                  `max_stars_4_req` int(11) NOT NULL,\n                  `max_stars_5_req` int(11) NOT NULL,\n                  `question_options_1_req` int(11) NOT NULL,\n                  `question_options_2_req` int(11) NOT NULL,\n                  `question_options_3_req` int(11) NOT NULL,\n                  `question_options_4_req` int(11) NOT NULL,\n                  `question_options_5_req` int(11) NOT NULL,\n                  `question_plain_1_req` int(11) NOT NULL,\n                  `question_plain_2_req` int(11) NOT NULL,\n                  `question_plain_3_req` int(11) NOT NULL,\n                  `question_plain_4_req` int(11) NOT NULL,\n                  `question_plain_5_req` int(11) NOT NULL,\n                  `configuration` longtext NOT NULL,\n                  PRIMARY KEY (`id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    $db->query(\"CREATE TABLE `lh_admin_theme` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `name` varchar(100) NOT NULL,\n        \t       `static_content` longtext NOT NULL,\n        \t       `static_js_content` longtext NOT NULL,\n        \t       `static_css_content` longtext NOT NULL,\n        \t       `css_attributes` longtext NOT NULL,\n        \t       `header_content` text NOT NULL,\n        \t       `user_id` int(11) NOT NULL, \n        \t       `header_css` text NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `user_id` (`user_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    $db->query(\"CREATE TABLE `lh_chat_paid` ( \n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,  \n        \t       `hash` varchar(250) NOT NULL,  \n        \t       `chat_id` int(11) NOT NULL, \n        \t        PRIMARY KEY (`id`),  \n        \t       KEY `hash` (`hash`(191)),  \n        \t       KEY `chat_id` (`chat_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_survey_item` (\n        \t      `id` bigint(20) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `survey_id` int(11) NOT NULL,\n\t\t\t\t  `status` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `chat_id` int(11) NOT NULL,\n\t\t\t\t  `user_id` int(11) NOT NULL,\n\t\t\t\t  `ftime` int(11) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `max_stars_1` int(11) NOT NULL,\n\t\t\t\t  `max_stars_2` int(11) NOT NULL,\n\t\t\t\t  `max_stars_3` int(11) NOT NULL,\n\t\t\t\t  `max_stars_4` int(11) NOT NULL,\n\t\t\t\t  `max_stars_5` int(11) NOT NULL,\n\t\t\t\t  `question_options_1` int(11) NOT NULL,\n\t\t\t\t  `question_options_2` int(11) NOT NULL,\n\t\t\t\t  `question_options_3` int(11) NOT NULL,\n\t\t\t\t  `question_options_4` int(11) NOT NULL,\n\t\t\t\t  `question_options_5` int(11) NOT NULL,\n\t\t\t\t  `question_plain_1` text NOT NULL,\n\t\t\t\t  `question_plain_2` text NOT NULL,\n\t\t\t\t  `question_plain_3` text NOT NULL,\n\t\t\t\t  `question_plain_4` text NOT NULL,\n\t\t\t\t  `question_plain_5` text NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `survey_id` (`survey_id`),\n\t\t\t\t  KEY `chat_id` (`chat_id`),\n\t\t\t\t  KEY `user_id` (`user_id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `ftime` (`ftime`),\n\t\t\t\t  KEY `max_stars_1` (`max_stars_1`),\n\t\t\t\t  KEY `max_stars_2` (`max_stars_2`),\n\t\t\t\t  KEY `max_stars_3` (`max_stars_3`),\n\t\t\t\t  KEY `max_stars_4` (`max_stars_4`),\n\t\t\t\t  KEY `max_stars_5` (`max_stars_5`),\n\t\t\t\t  KEY `question_options_1` (`question_options_1`),\n\t\t\t\t  KEY `question_options_2` (`question_options_2`),\n\t\t\t\t  KEY `question_options_3` (`question_options_3`),\n\t\t\t\t  KEY `question_options_4` (`question_options_4`),\n\t\t\t\t  KEY `question_options_5` (`question_options_5`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_speech_language` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `name` varchar(100) NOT NULL,\n                  `siteaccess` varchar(3) NOT NULL DEFAULT '',\n                  PRIMARY KEY (`id`)\n               ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_speech_language_dialect` (\n                `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `language_id` int(11) NOT NULL,\n                  `lang_name` varchar(100) NOT NULL,\n                  `lang_code` varchar(100) NOT NULL,\n                  `short_code` varchar(4) NOT NULL DEFAULT '',\n                  PRIMARY KEY (`id`),\n                  KEY `language_id` (`language_id`),\n                  KEY `short_code` (`short_code`),\n                  KEY `lang_code` (`lang_code`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"INSERT INTO `lh_speech_language` (`id`, `name`, `siteaccess`) VALUES\n\t\t\t\t(1,\t'Afrikaans',''),\n\t\t\t\t(2,\t'Bahasa Indonesia',''),\n\t\t\t\t(3,\t'Bahasa Melayu',''),\n\t\t\t\t(4,\t'Catal\u00e0',''),\n\t\t\t\t(5,\t'\u010ce\u0161tina','cse'),\n\t\t\t\t(6,\t'Deutsch','ger'),\n\t\t\t\t(7,\t'English',''),\n\t\t\t\t(8,\t'Espa\u00f1ol','esp'),\n\t\t\t\t(9,\t'Euskara',''),\n\t\t\t\t(10,\t'Fran\u00e7ais','fre'),\n\t\t\t\t(11,\t'Galego',''),\n\t\t\t\t(12,\t'Hrvatski',''),\n\t\t\t\t(13,\t'IsiZulu',''),\n\t\t\t\t(14,\t'\u00cdslenska',''),\n\t\t\t\t(15,\t'Italiano','ita'),\n\t\t\t\t(16,\t'Magyar',''),\n\t\t\t\t(17,\t'Nederlands','nld'),\n\t\t\t\t(18,\t'Norsk bokm\u00e5l',''),\n\t\t\t\t(19,\t'Polski','pol'),\n\t\t\t\t(20,\t'Portugu\u00eas','por'),\n\t\t\t\t(21,\t'Rom\u00e2n\u0103',''),\n\t\t\t\t(22,\t'Sloven\u010dina','svk'),\n\t\t\t\t(23,\t'Suomi','fin'),\n\t\t\t\t(24,\t'Svenska',''),\n\t\t\t\t(25,\t'T\u00fcrk\u00e7e','tur'),\n\t\t\t\t(26,\t'\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438',''),\n\t\t\t\t(27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439','rus'),\n\t\t\t\t(28,\t'\u0421\u0440\u043f\u0441\u043a\u0438',''),\n\t\t\t\t(29,\t'\ud55c\uad6d\uc5b4',''),\n\t\t\t\t(30,\t'\u4e2d\u6587',''),\n\t\t\t\t(31,\t'\u65e5\u672c\u8a9e',''),\n\t\t\t\t(32,\t'Lingua lat\u012bna',''),\n\t\t\t\t(33,\t'Lithuanian','lit'),\n\t\t\t\t(34,\t'Latvia',''),\n\t\t\t\t(35,\t'Afar',''),\n\t\t\t\t(36,\t'Arabic',''),\n\t\t\t\t(37,\t'Assamese',''),\n\t\t\t\t(38,\t'Azerbaijani',''),\n\t\t\t\t(39,\t'Bulgarian','bgr'),\n\t\t\t\t(40,\t'Bangla',''),\n\t\t\t\t(41,\t'Bosnian',''),\n\t\t\t\t(42,\t'Cakchiquel',''),\n\t\t\t\t(43,\t'Danish',''),\n\t\t\t\t(44,\t'Greek',''),\n\t\t\t\t(45,\t'Estonian',''),\n\t\t\t\t(46,\t'Persian',''),\n\t\t\t\t(47,\t'Filipino',''),\n\t\t\t\t(48,\t'Gujarati',''),\n\t\t\t\t(49,\t'Hebrew',''),\n\t\t\t\t(50,\t'Croatian',''),\n\t\t\t\t(51,\t'Indonesia',''),\n\t\t\t\t(52,\t'Icelandic',''),\n\t\t\t\t(53,\t'Georgian',''),\n\t\t\t\t(54,\t'Maori (New Zealand)',''),\n\t\t\t\t(55,\t'Macedonian',''),\n\t\t\t\t(56,\t'Malay (Latin)',''),\n\t\t\t\t(57,\t'Maltese',''),\n\t\t\t\t(58,\t'Norwegian Nynorsk',''),\n\t\t\t\t(59,\t'Norwegian','nor'),\n\t\t\t\t(60,\t'Northern Sotho (South Africa)',''),\n\t\t\t\t(61,\t'Slovenian',''),\n\t\t\t\t(63,\t'Thai',''),\n\t\t\t\t(64,\t'Tagalog',''),\n\t\t\t\t(65,\t'Tongan',''),\n\t\t\t\t(66,\t'Ukrainian',''),\n\t\t\t\t(67,\t'Vietnamese','vnm'),\n\t\t\t\t(68,\t'Chinese','chn');\");\n\n                    $db->query(\"INSERT INTO `lh_speech_language_dialect` (`id`, `language_id`, `lang_name`, `lang_code`, `short_code`) VALUES\n(1,\t1,\t'Afrikaans',\t'af-ZA',\t'af'),\n(2,\t2,\t'Bahasa Indonesia',\t'id-ID',\t'id'),\n(3,\t3,\t'Bahasa Melayu',\t'ms-MY',\t''),\n(4,\t4,\t'Catal\u00e0',\t'ca-ES',\t''),\n(5,\t5,\t'\u010ce\u0161tina',\t'cs-CZ',\t'cs'),\n(6,\t6,\t'Deutsch',\t'de-DE',\t'de'),\n(7,\t7,\t'Australia',\t'en-AU',\t''),\n(8,\t7,\t'Canada',\t'en-CA',\t''),\n(9,\t7,\t'India',\t'en-IN',\t''),\n(10,\t7,\t'New Zealand',\t'en-NZ',\t''),\n(11,\t7,\t'South Africa',\t'en-ZA',\t''),\n(12,\t7,\t'United Kingdom',\t'en-GB',\t'en'),\n(13,\t7,\t'United States',\t'en-US',\t''),\n(14,\t8,\t'Argentina',\t'es-AR',\t''),\n(15,\t8,\t'Bolivia',\t'es-BO',\t''),\n(16,\t8,\t'Chile',\t'es-CL',\t''),\n(17,\t8,\t'Colombia',\t'es-CO',\t''),\n(18,\t8,\t'Costa Rica',\t'es-CR',\t''),\n(19,\t8,\t'Ecuador',\t'es-EC',\t''),\n(20,\t8,\t'El Salvador',\t'es-SV',\t''),\n(21,\t8,\t'Espa\u00f1a',\t'es-ES',\t'es'),\n(22,\t8,\t'Estados Unidos',\t'es-US',\t''),\n(23,\t8,\t'Guatemala',\t'es-GT',\t''),\n(24,\t8,\t'Honduras',\t'es-HN',\t''),\n(25,\t8,\t'M\u00e9xico',\t'es-MX',\t''),\n(26,\t8,\t'Nicaragua',\t'es-NI',\t''),\n(27,\t8,\t'Panam\u00e1',\t'es-PA',\t''),\n(28,\t8,\t'Paraguay',\t'es-PY',\t''),\n(29,\t8,\t'Per\u00fa',\t'es-PE',\t''),\n(30,\t8,\t'Puerto Rico',\t'es-PR',\t''),\n(31,\t8,\t'Rep\u00fablica Dominicana',\t'es-DO',\t''),\n(32,\t8,\t'Uruguay',\t'es-UY',\t''),\n(33,\t8,\t'Venezuela',\t'es-VE',\t''),\n(34,\t9,\t'Euskara',\t'eu-ES',\t''),\n(35,\t10,\t'Fran\u00e7ais',\t'fr-FR',\t'fr'),\n(36,\t11,\t'Galego',\t'gl-ES',\t''),\n(37,\t12,\t'Hrvatski',\t'hr_HR',\t''),\n(38,\t13,\t'IsiZulu',\t'zu-ZA',\t''),\n(39,\t14,\t'\u00cdslenska',\t'is-IS',\t''),\n(40,\t15,\t'Italia',\t'it-IT',\t'it'),\n(41,\t15,\t'Svizzera',\t'it-CH',\t'it'),\n(42,\t16,\t'Magyar',\t'hu-HU',\t'hu'),\n(43,\t17,\t'Nederlands',\t'nl-NL',\t'nl'),\n(44,\t18,\t'Norsk bokm\u00e5l',\t'nb-NO',\t'nb'),\n(45,\t19,\t'Polski',\t'pl-PL',\t'pl'),\n(46,\t20,\t'Brasil',\t'pt-BR',\t''),\n(47,\t20,\t'Portugal',\t'pt-PT',\t'pt'),\n(48,\t21,\t'Rom\u00e2n\u0103',\t'ro-RO',\t'ro'),\n(49,\t22,\t'Sloven\u010dina',\t'sk-SK',\t'sk'),\n(50,\t23,\t'Suomi',\t'fi-FI',\t'fi'),\n(51,\t24,\t'Swedish',\t'sv-SE',\t'sv'),\n(52,\t25,\t'T\u00fcrk\u00e7e',\t'tr-TR',\t'tr'),\n(53,\t26,\t'\u0431\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438',\t'bg-BG',\t''),\n(54,\t27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439',\t'ru-RU',\t'ru'),\n(55,\t28,\t'Serbian',\t'sr-RS',\t'sr'),\n(56,\t29,\t'\ud55c\uad6d\uc5b4',\t'ko-KR',\t'ko'),\n(57,\t30,\t'\u666e\u901a\u8bdd (\u4e2d\u56fd\u5927\u9646)',\t'cmn-Hans-CN',\t''),\n(58,\t30,\t'\u666e\u901a\u8bdd (\u9999\u6e2f)',\t'cmn-Hans-HK',\t''),\n(59,\t30,\t'\u4e2d\u6587 (\u53f0\u7063)',\t'cmn-Hant-TW',\t''),\n(60,\t30,\t'\u7cb5\u8a9e (\u9999\u6e2f)',\t'yue-Hant-HK',\t''),\n(61,\t31,\t'\u65e5\u672c\u8a9e',\t'ja-JP',\t'ja'),\n(62,\t32,\t'Lingua lat\u012bna',\t'la',\t''),\n(64,\t33,\t'Lithuanian',\t'lt-LT',\t'lt'),\n(65,\t34,\t'Latvia',\t'lv-LV',\t'lv'),\n(66,\t35,\t'Afar',\t'aa-DJ',\t'aa'),\n(67,\t36,\t'Egypt',\t'ar-EG',\t'ar'),\n(68,\t37,\t'India',\t'as-IN',\t'as'),\n(69,\t38,\t'Azerbaijani',\t'az-AZ',\t'az'),\n(70,\t39,\t'Bulgarian',\t'bg',\t'bg'),\n(71,\t40,\t'Bangla',\t'bn',\t'bn'),\n(72,\t41,\t'Bosnian',\t'bs-BA',\t'bs'),\n(73,\t42,\t'Cakchiquel',\t'cak',\t'cak'),\n(74,\t43,\t'Danish',\t'da-dk',\t'da'),\n(75,\t44,\t'Greek',\t'el-GR',\t'el'),\n(76,\t45,\t'Estonian',\t'et-EE',\t'et'),\n(77,\t46,\t'Persian',\t'fa-IR',\t'fa'),\n(78,\t47,\t'Filipino',\t'fil',\t'fil'),\n(79,\t48,\t'Gujarati',\t'gu-IN',\t'gu'),\n(80,\t49,\t'Hebrew',\t'he',\t'he'),\n(81,\t50,\t'Croatian',\t'hr-HR',\t'hr'),\n(82,\t51,\t'Indonesia',\t'in',\t'in'),\n(83,\t52,\t'Icelandic',\t'is',\t'is'),\n(84,\t53,\t'Georgian',\t'ka-ge',\t'ka'),\n(85,\t54,\t'Maori (New Zealand)',\t'mi-nz',\t'mi'),\n(86,\t55,\t'Macedonian',\t'mk-MK',\t'mk'),\n(87,\t56,\t'Malay (Latin)',\t'ms',\t'ms'),\n(88,\t57,\t'Maltese',\t'mt',\t'mt'),\n(89,\t58,\t'Norwegian Nynorsk',\t'nn-NO',\t'nn'),\n(90,\t59,\t'Norwegian',\t'no',\t'no'),\n(91,\t60,\t'Northern Sotho (South Africa)',\t'nso-za',\t'nso'),\n(92,\t61,\t'Slovenian',\t'sl-SI',\t'sl'),\n(94,\t63,\t'Thai',\t'th-TH',\t'th'),\n(95,\t64,\t'Tagalog',\t'tl',\t'tl'),\n(96,\t65,\t'Tongan',\t'to-TO',\t'to'),\n(97,\t66,\t'Ukrainian',\t'uk-UA',\t'uk'),\n(98,\t67,\t'Vietnamese',\t'vi-VN',\t'vi'),\n(99,\t68,\t'Chinese',\t'zh-CN',\t'zh'),\n(100,\t36,\t'Egypt',\t'ar-AE',\t''),\n(101,\t36,\t'Egypt',\t'ar-IQ',\t''),\n(102,\t41,\t'Bosnian',\t'bs-Latn-BA',\t''),\n(103,\t6,\t'Deutsch',\t'de-at',\t''),\n(104,\t6,\t'Deutsch',\t'de-ch',\t''),\n(105,\t6,\t'Deutsch',\t'de-GB',\t''),\n(106,\t6,\t'Deutsch',\t'de-LI',\t''),\n(107,\t6,\t'Deutsch',\t'de-LU',\t''),\n(108,\t7,\t'United Kingdom',\t'en-029',\t''),\n(109,\t7,\t'United Kingdom',\t'en-AS',\t''),\n(110,\t7,\t'United Kingdom',\t'en-BE',\t''),\n(111,\t7,\t'United Kingdom',\t'en-BM',\t''),\n(112,\t7,\t'United Kingdom',\t'en-BS',\t''),\n(113,\t7,\t'United Kingdom',\t'en-BW',\t''),\n(114,\t7,\t'United Kingdom',\t'en-CH',\t''),\n(115,\t7,\t'United Kingdom',\t'en-CX',\t''),\n(116,\t7,\t'United Kingdom',\t'en-CY',\t''),\n(117,\t7,\t'United Kingdom',\t'en-DE',\t''),\n(118,\t7,\t'United Kingdom',\t'en-DK',\t''),\n(119,\t7,\t'United Kingdom',\t'en-DM',\t''),\n(120,\t7,\t'United Kingdom',\t'en-GY',\t''),\n(121,\t7,\t'United Kingdom',\t'en-HK',\t''),\n(122,\t7,\t'United Kingdom',\t'en-ie',\t''),\n(123,\t7,\t'United Kingdom',\t'en-IM',\t''),\n(124,\t7,\t'United Kingdom',\t'en-JM',\t''),\n(125,\t7,\t'United Kingdom',\t'en-KY',\t''),\n(126,\t7,\t'United Kingdom',\t'en-MY',\t''),\n(127,\t7,\t'United Kingdom',\t'en-NF',\t''),\n(128,\t7,\t'United Kingdom',\t'en-NG',\t''),\n(129,\t7,\t'United Kingdom',\t'en-NL',\t''),\n(130,\t7,\t'United Kingdom',\t'en-PH',\t''),\n(131,\t7,\t'United Kingdom',\t'en-SE',\t''),\n(132,\t7,\t'United Kingdom',\t'en-sg',\t''),\n(133,\t7,\t'United Kingdom',\t'en-SI',\t''),\n(134,\t7,\t'United Kingdom',\t'en-SS',\t''),\n(135,\t7,\t'United Kingdom',\t'en-TO',\t''),\n(136,\t7,\t'United Kingdom',\t'en-TZ',\t''),\n(137,\t7,\t'United Kingdom',\t'en-UG',\t''),\n(138,\t7,\t'United Kingdom',\t'en-UK',\t''),\n(139,\t7,\t'United Kingdom',\t'en-ZG',\t''),\n(140,\t7,\t'United Kingdom',\t'en-ZM',\t''),\n(141,\t7,\t'United Kingdom',\t'en-ZW',\t''),\n(142,\t8,\t'Espa\u00f1a',\t'es-419',\t''),\n(143,\t8,\t'Espa\u00f1a',\t'es-xl',\t''),\n(144,\t47,\t'Filipino',\t'fil-PH',\t''),\n(145,\t10,\t'Fran\u00e7ais',\t'fr-BE',\t''),\n(146,\t10,\t'Fran\u00e7ais',\t'fr-ca',\t''),\n(147,\t10,\t'Fran\u00e7ais',\t'fr-ch',\t''),\n(148,\t10,\t'Fran\u00e7ais',\t'fr-CM',\t''),\n(149,\t10,\t'Fran\u00e7ais',\t'fr-MC',\t''),\n(150,\t49,\t'Hebrew',\t'he-IL',\t''),\n(151,\t50,\t'Croatian',\t'hr-BA',\t''),\n(152,\t17,\t'Nederlands',\t'nl-BE',\t''),\n(153,\t19,\t'Polski',\t'pl-GB',\t''),\n(154,\t27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439',\t'ru-KZ',\t''),\n(155,\t27,\t'P\u0443\u0441\u0441\u043a\u0438\u0439',\t'ru-UA',\t''),\n(156,\t28,\t'Serbian',\t'sr-BA',\t''),\n(157,\t28,\t'Serbian',\t'sr-Latn-RS',\t''),\n(158,\t68,\t'Chinese',\t'zh-MO',\t''),\n(159,\t68,\t'Chinese',\t'zh-SG',\t''),\n(160,\t68,\t'Chinese',\t'zh-TW',\t'');\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_speech_chat_language` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `chat_id` int(11) NOT NULL,\n                  `language_id` int(11) NOT NULL,\n                  `dialect` varchar(50) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `chat_id` (`chat_id`)\n               ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_chat_alert_icon` (`id` bigint(20) NOT NULL AUTO_INCREMENT,`name` varchar(50) NOT NULL, `identifier` varchar(50) NOT NULL,PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_file` (\n        \t   `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n        \t   `name` varchar(255) NOT NULL,\n        \t   `upload_name` varchar(255) NOT NULL,\n        \t   `size` int(11) NOT NULL,\n        \t   `type` varchar(255) NOT NULL,\n        \t   `file_path` varchar(255) NOT NULL,\n        \t   `extension` varchar(255) NOT NULL,\n        \t   `chat_id` bigint(20) NOT NULL,\n        \t   `persistent` int(11) NOT NULL,\n        \t   `online_user_id` int(11) NOT NULL,\n        \t   `user_id` int(11) NOT NULL,\n        \t   `date` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `chat_id` (`chat_id`),\n        \t   KEY `online_user_id` (`online_user_id`),\n        \t   KEY `user_id` (`user_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_email_template` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `name` varchar(250) NOT NULL,\n\t\t\t\t  `from_name` varchar(150) NOT NULL,\n\t\t\t\t  `from_name_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `from_email` varchar(150) NOT NULL,\n\t\t\t\t  `from_email_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `user_mail_as_sender` tinyint(4) NOT NULL,\n                  `use_chat_locale` tinyint(1) NOT NULL DEFAULT '0',\n\t\t\t\t  `content` text NOT NULL,\n                  `translations` longtext NOT NULL,\n\t\t\t\t  `subject` varchar(250) NOT NULL,\n\t\t\t\t  `bcc_recipients` varchar(200) NOT NULL,\n\t\t\t\t  `subject_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `reply_to` varchar(150) NOT NULL,\n\t\t\t\t  `reply_to_ac` tinyint(4) NOT NULL,\n\t\t\t\t  `recipient` varchar(150) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"INSERT INTO `lh_abstract_email_template` (`id`, `translations`, `name`, `from_name`, `from_name_ac`, `from_email`, `from_email_ac`, `content`, `subject`, `subject_ac`, `reply_to`, `reply_to_ac`, `recipient`, `bcc_recipients`, `user_mail_as_sender`) VALUES\n            \t   (1,'',\t'Send mail to user',\t'Live Helper Chat',\t0,\t'',\t0,\t'Dear {user_chat_nick},\\r\\n\\r\\n{additional_message}\\r\\n\\r\\nLive Support response:\\r\\n{messages_content}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team\\r\\n',\t'{name_surname} has responded to your request',\t1,\t'',\t1,\t'',\t'',\t0),\n            \t   (2,'',\t'Support request from user',\t'',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nAdditional data, if any:\\r\\n{additional_data}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nLink to chat if any:\\r\\n{prefillchat}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'{name}, {country}, {department}, Support request from user',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (3,'',\t'User mail for himself',\t'Live Helper Chat',\t0,\t'',\t0,\t'Dear {user_chat_nick},\\r\\n\\r\\nTranscript:\\r\\n{messages_content}\\r\\nChat ID: {chat_id}\\n\\r\\nSincerely,\\r\\nLive Support Team\\r\\n',\t'Chat transcript',\t0,\t'',\t0,\t'',\t'',\t0),\n            \t   (4,'',\t'New chat request',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nClick to accept chat automatically\\r\\n{url_accept}\\r\\n\\r\\nSurvey\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'New chat request',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (5,'',\t'Chat was closed',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\n{operator} has closed a chat\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nAdditional data, if any:\\r\\n{additional_data}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nSurvey:\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Chat was closed',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (6,'',\t'New FAQ question',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nNew FAQ question\\r\\nEmail: {email}\\r\\n\\r\\nQuestion:\\r\\n{question}\\r\\n\\r\\nQuestion URL:\\r\\n{url_question}\\r\\n\\r\\nURL to answer a question:\\r\\n{url_request}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'New FAQ question',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (7,'',\t'New unread message',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nClick to accept chat automatically\\r\\n{url_accept}\\r\\n\\r\\nSurvey:\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'New unread message',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (8,'',\t'Filled form',\t'MCFC',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nUser has filled a form\\r\\nForm name - {form_name}\\r\\nUser IP - {ip}\\r\\nDownload filled data - {url_download}\\r\\nView filled data - {url_view}\\r\\n\\r\\n{content}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Filled form - {form_name}',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (9,'',\t'Chat was accepted',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nOperator {user_name} has accepted a chat [{chat_id}]\\r\\n\\r\\nUser request data:\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nMessage:\\r\\n{message}\\r\\n\\r\\nURL of page from which user has send request:\\r\\n{url_request}\\r\\n\\r\\nClick to accept chat automatically\\r\\n{url_accept}\\r\\n\\r\\nSurvey:\\r\\n{survey}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Chat was accepted [{chat_id}]',\t0,\t'',\t0,\t'{$adminEmail}',\t'',\t0),\n            \t   (10,'',\t'Permission request',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nOperator {user} has requested these permissions\\n\\r\\n{permissions}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Permission request from {user}',\t0,\t'',\t0,\t'',\t'',\t0),\n            \t   (11,'',\t'You have unread messages',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nOperator {operator} has answered to you\\r\\n\\r\\n{messages}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Operator has answered to your request',\t0,\t'',\t0,\t'',\t'',\t0),\n            \t   (12,'',\t'Visitor returned',\t'Live Helper Chat',\t0,\t'',\t0,\t'Hello,\\r\\n\\r\\nVisitor information\\r\\nName: {name}\\r\\nEmail: {email}\\r\\nPhone: {phone}\\r\\nDepartment: {department}\\r\\nCountry: {country}\\r\\nCity: {city}\\r\\nIP: {ip}\\r\\nCreated:\t{created}\\r\\nUser left:\t{user_left}\\r\\nWaited:\t{waited}\\r\\nChat duration:\t{chat_duration}\\r\\n\\r\\nSee more information at\\r\\n{url_accept}\\r\\n\\r\\nLast chat:\\r\\n{message}\\r\\n\\r\\nAdditional data, if any:\\r\\n{additional_data}\\r\\n\\r\\nSincerely,\\r\\nLive Support Team',\t'Visitor returned - {username}',\t0,\t'',\t0,\t'',\t'',\t0);\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `question` varchar(250) NOT NULL,\n        \t   `location` varchar(250) NOT NULL,\n        \t   `active` int(11) NOT NULL,\n        \t   `priority` int(11) NOT NULL,\n        \t   `is_voting` int(11) NOT NULL,\n        \t   `question_intro` text NOT NULL,\n        \t   `revote` int(11) NOT NULL DEFAULT '0',\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `priority` (`priority`),\n        \t   KEY `active_priority` (`active`,`priority`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question_answer` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `ip` bigint(20) NOT NULL,\n        \t   `question_id` int(11) NOT NULL,\n        \t   `answer` text NOT NULL,\n        \t   `ctime` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `ip` (`ip`),\n        \t   KEY `question_id` (`question_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question_option` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `question_id` int(11) NOT NULL,\n        \t   `option_name` varchar(250) NOT NULL,\n        \t   `priority` tinyint(4) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `question_id` (`question_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                $db->query(\"CREATE TABLE `lh_chat_action` (\n                `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `chat_id` bigint(20) NOT NULL,\n                  `action` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `body` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `created_at` bigint(20) unsigned NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `chat_id` (`chat_id`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n               $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_stats` (\n                  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n                  `type` int(11) NOT NULL,\n                  `lupdate` bigint(20) NOT NULL,\n                  `object_id` bigint(20) NOT NULL,\n                  `stats` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `type_object_id` (`type`,`object_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_question_option_answer` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `question_id` int(11) NOT NULL,\n        \t   `option_id` int(11) NOT NULL,\n        \t   `ctime` int(11) NOT NULL,\n        \t   `ip` bigint(20) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `question_id` (`question_id`),\n        \t   KEY `ip` (`ip`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_voice_video` (\n                   `id` bigint(20) NOT NULL AUTO_INCREMENT,\n                   `chat_id` bigint(20) NOT NULL,\n                   `user_id` bigint(20) NOT NULL,\n                   `op_status` tinyint(4) NOT NULL,\n                   `vi_status` tinyint(4) NOT NULL,\n                   `voice` tinyint(4) NOT NULL,\n                   `video` tinyint(4) NOT NULL,\n                   `screen_share` tinyint(4) NOT NULL,\n                   `status` tinyint(4) NOT NULL,\n                   `ctime` int(11) NOT NULL,\n                   `token` varchar(200) NOT NULL,\n                   PRIMARY KEY (`id`),\n                   KEY `chat_id` (`chat_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_product` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT, \n        \t       `name` varchar(250) NOT NULL, \n        \t       `disabled` int(11) NOT NULL, \n        \t       `priority` int(11) NOT NULL, \n        \t       `departament_id` int(11) NOT NULL, \n        \t       KEY `departament_id` (`departament_id`), \n        \t       PRIMARY KEY (`id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_browse_offer_invitation` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `siteaccess` varchar(10) NOT NULL,\n\t\t\t\t  `time_on_site` int(11) NOT NULL,\n\t\t\t\t  `content` longtext NOT NULL,\n\t\t\t\t  `callback_content` longtext NOT NULL,\n\t\t\t\t  `lhc_iframe_content` tinyint(4) NOT NULL,\n\t\t\t\t  `custom_iframe_url` varchar(250) NOT NULL,\n\t\t\t\t  `name` varchar(250) NOT NULL,\n\t\t\t\t  `identifier` varchar(50) NOT NULL,\n\t\t\t\t  `executed_times` int(11) NOT NULL,\n\t\t\t\t  `url` varchar(250) NOT NULL,\n\t\t\t\t  `active` int(11) NOT NULL,\n\t\t\t\t  `has_url` int(11) NOT NULL,\n\t\t\t\t  `is_wildcard` int(11) NOT NULL,\n\t\t\t\t  `referrer` varchar(250) NOT NULL,\n\t\t\t\t  `priority` varchar(250) NOT NULL,\n\t\t\t\t  `hash` varchar(40) NOT NULL,\n\t\t\t\t  `width` int(11) NOT NULL,\n\t\t\t\t  `height` int(11) NOT NULL,\n\t\t\t\t  `unit` varchar(10) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `active` (`active`),\n\t\t\t\t  KEY `identifier` (`identifier`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_form` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `name` varchar(100) NOT NULL,        \t   \n        \t   `content` longtext NOT NULL,\n        \t   `recipient` varchar(250) NOT NULL,\n        \t   `active` int(11) NOT NULL,\n        \t   `name_attr` varchar(250) NOT NULL,\n        \t   `intro_attr` varchar(250) NOT NULL,\n        \t   `xls_columns` text NOT NULL,\n        \t   `pagelayout` varchar(200) NOT NULL,\n        \t   `post_content` text NOT NULL,\n        \t   PRIMARY KEY (`id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_form_collected` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `form_id` int(11) NOT NULL,\n\t\t\t\t  `ctime` int(11) NOT NULL,\n\t\t\t\t  `ip` varchar(250) NOT NULL,\n        \t   \t  `identifier` varchar(250) NOT NULL,\n        \t   \t  `chat_id` bigint(20) NOT NULL,\n\t\t\t\t  `content` longtext NOT NULL,\n\t\t\t\t  `custom_fields` longtext NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `form_id` (`form_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chatbox` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `identifier` varchar(50) NOT NULL,\n\t\t\t\t  `name` varchar(100) NOT NULL,\n\t\t\t\t  `chat_id` int(11) NOT NULL,\n\t\t\t\t  `active` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `identifier` (`identifier`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_canned_msg` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `msg` longtext NOT NULL,\n                  `fallback_msg` text NOT NULL,\n                  `title` varchar(250) NOT NULL,\n                  `explain` varchar(250) NOT NULL,\n                  `languages` text NOT NULL,\n                  `additional_data` text NOT NULL,\n        \t   \t  `position` int(11) NOT NULL,\n        \t   \t  `department_id` int(11) NOT NULL,\n        \t   \t  `user_id` int(11) NOT NULL,\n  \t\t\t\t  `delay` int(11) NOT NULL,\n        \t   \t  `auto_send` tinyint(1) NOT NULL,\n        \t   \t  `html_snippet` longtext NOT NULL,\n        \t   \t  `attr_int_1` int(11) NOT NULL,\n        \t   \t  `attr_int_2` int(11) NOT NULL,\n        \t   \t  `attr_int_3` int(11) NOT NULL,\n        \t   \t  `disabled` tinyint(1) unsigned NOT NULL NULL DEFAULT 0,\n        \t   \t  `unique_id` varchar(20) NOT NULL,\n                  `updated_at` int(11) unsigned NOT NULL DEFAULT 0,\n                  `created_at` int(11) unsigned NOT NULL DEFAULT 0,\n                  `active_from` int(11) unsigned NOT NULL DEFAULT 0,\n                  `active_to` int(11) unsigned NOT NULL DEFAULT 0,\n                  `repetitiveness` int(11) unsigned NOT NULL DEFAULT 0,\n                  `days_activity` text COLLATE utf8mb4_unicode_ci NOT NULL,\n                  PRIMARY KEY (`id`),\n        \t   \t  KEY `department_id` (`department_id`),\n        \t   \t  KEY `disabled` (`disabled`),\n        \t   \t  KEY `attr_int_1` (`attr_int_1`),\n        \t   \t  KEY `attr_int_2` (`attr_int_2`),\n        \t   \t  KEY `attr_int_3` (`attr_int_3`),\n        \t   \t  KEY `position_title_v2` (`position`, `title`(191)),\n        \t   \t  KEY `user_id` (`user_id`),\n        \t   \t  KEY `unique_id` (`unique_id`),\n                  KEY `repetitiveness` (`repetitiveness`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_online_user_footprint` (\n\t\t\t\t  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `chat_id` bigint(20) NOT NULL,\n\t\t\t\t  `online_user_id` int(11) NOT NULL,\n\t\t\t\t  `page` varchar(2083) NOT NULL,\n\t\t\t\t  `vtime` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `chat_id` (`chat_id`),\n\t\t\t\t  KEY `online_user_id` (`online_user_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                $db->query(\"CREATE TABLE `lh_canned_msg_dep` (\n                                 `id` bigint(20) NOT NULL AUTO_INCREMENT,\n                                 `canned_id` int(11) NOT NULL,\n                                 `dep_id` int(11) NOT NULL,\n                                 PRIMARY KEY (`id`),\n                                 KEY `canned_id` (`canned_id`),\n                                 KEY `dep_id` (`dep_id`)\n                            ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_invitation_dep` (\n                    `id` bigint(20) NOT NULL AUTO_INCREMENT,\n    `invitation_id` int(11) NOT NULL,\n    `dep_id` int(11) NOT NULL,\n    PRIMARY KEY (`id`),\n    KEY `invitation_id` (`invitation_id`),\n    KEY `dep_id` (`dep_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                 $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_event` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `vid_id` int(11) NOT NULL,\n        \t       `ev_id` int(11) NOT NULL,\n        \t       `ts` int(11) NOT NULL,\n        \t       `val` varchar(50) NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `vid_id_ev_id_val_ts` (`vid_id`,`ev_id`,`val`,`ts`),\n        \t       KEY `vid_id_ev_id_ts` (`vid_id`,`ev_id`,`ts`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_invitation_event` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `invitation_id` int(11) NOT NULL,\n        \t       `event_id` int(11) NOT NULL,\n        \t       `min_number` int(11) NOT NULL,\n        \t       `during_seconds` int(11) NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `invitation_id` (`invitation_id`),\n        \t       KEY `event_id` (`event_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_variables` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `name` varchar(50) NOT NULL,\n        \t       `identifier` varchar(50) NOT NULL,\n        \t       `store_timeout` int(11) NOT NULL,\n        \t       `filter_val` int(11) NOT NULL DEFAULT '0',\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `identifier` (`identifier`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_campaign` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL, `text` text NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_proactive_chat_campaign_conv` (\n                  `id` bigint(20) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `device_type` tinyint(11) NOT NULL,\n\t\t\t\t  `invitation_type` tinyint(1) NOT NULL,\n\t\t\t\t  `invitation_status` tinyint(1) NOT NULL,\n\t\t\t\t  `chat_id` bigint(20) NOT NULL,\n\t\t\t\t  `campaign_id` int(11) NOT NULL,\n\t\t\t\t  `invitation_id` int(11) NOT NULL,\n\t\t\t\t  `department_id` int(11) NOT NULL,\n\t\t\t\t  `ctime` int(11) NOT NULL,\n\t\t\t\t  `con_time` int(11) NOT NULL,\n\t\t\t\t  `vid_id` bigint(20) DEFAULT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `ctime` (`ctime`),\n\t\t\t\t  KEY `campaign_id` (`campaign_id`),\n\t\t\t\t  KEY `invitation_id` (`invitation_id`),\n\t\t\t\t  KEY `invitation_status` (`invitation_status`)\n\t\t\t\t) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users_setting` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `user_id` int(11) NOT NULL,\n        \t   `identifier` varchar(50) NOT NULL,\n        \t   `value` text NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `user_id` (`user_id`,`identifier`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_departament_limit_group_member` (  \n    \t       `id` int(11) NOT NULL AUTO_INCREMENT,  \n    \t       `dep_id` int(11) NOT NULL,  \n    \t       `dep_limit_group_id` int(11) NOT NULL,  \n    \t       PRIMARY KEY (`id`),  \n    \t       KEY `dep_limit_group_id` (`dep_limit_group_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_departament_limit_group` (  \n    \t       `id` int(11) NOT NULL AUTO_INCREMENT,  \n    \t       `name` varchar(50) NOT NULL,\n    \t       `pending_max` int(11) NOT NULL,  \n    \t       PRIMARY KEY (`id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_auto_responder_chat` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `chat_id` int(11) NOT NULL,\n                  `auto_responder_id` int(11) NOT NULL,\n                  `wait_timeout_send` int(11) NOT NULL,\n                  `pending_send_status` int(11) NOT NULL,\n                  `active_send_status` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `chat_id` (`chat_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users_setting_option` (\n\t\t\t\t  `identifier` varchar(50) NOT NULL,\n\t\t\t\t  `class` varchar(50) NOT NULL,\n\t\t\t\t  `attribute` varchar(40) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`identifier`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"INSERT INTO `lh_users_setting_option` (`identifier`, `class`, `attribute`) VALUES\n        \t   ('chat_message',\t'',\t''),\n        \t   ('new_chat_sound',\t'',\t''),\n        \t   ('enable_pending_list', '', ''),\n        \t   ('enable_active_list', '', ''),\n        \t   ('enable_close_list', '', ''),\n        \t   ('new_user_bn', '', ''),\n        \t   ('new_user_sound', '', ''),\n        \t   ('oupdate_timeout', '', ''),\n        \t   ('ouser_timeout', '', ''),\n        \t   ('o_department', '', ''),\n        \t   ('omax_rows', '', ''),\n        \t   ('ogroup_by', '', ''),\n        \t   ('omap_depid', '', ''),\n        \t   ('omap_mtimeout', '', ''),\n        \t   ('ocountry', '', ''),\n        \t   ('otime_on_site', '', ''),\n        \t   ('dwo', '', ''),\n        \t   ('enable_unread_list', '', '')\");\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_config` (\n                  `identifier` varchar(50) NOT NULL,\n                  `value` text NOT NULL,\n                  `type` tinyint(1) NOT NULL DEFAULT '0',\n                  `explain` varchar(250) NOT NULL,\n                  `hidden` int(11) NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`identifier`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $randomHash = erLhcoreClassModelForgotPassword::randomPassword(9);\n                    $randomHashLength = strlen($randomHash);\n                    $exportHash = erLhcoreClassModelForgotPassword::randomPassword(9);\n\n                    if (extension_loaded('bcmath')){\n                        $geoRow = \"('geo_data','a:5:{i:0;b:0;s:21:\\\"geo_detection_enabled\\\";i:1;s:22:\\\"geo_service_identifier\\\";s:8:\\\"max_mind\\\";s:23:\\\"max_mind_detection_type\\\";s:7:\\\"country\\\";s:22:\\\"max_mind_city_location\\\";s:37:\\\"var/external/geoip/GeoLite2-City.mmdb\\\";}',0,'',1)\";\n                    } else {\n                        $geoRow = \"('geo_data', '', '0', '', '1')\";\n                    }\n\n                    $db->query(\"INSERT INTO `lh_chat_config` (`identifier`, `value`, `type`, `explain`, `hidden`) VALUES\n                ('tracked_users_cleanup',\t'160',\t0,\t'How many days keep records of online users.',\t0),\n        \t   \t('list_online_operators', '1', '0', 'List online operators.', '0'),\n        \t   \t('voting_days_limit',\t'7',\t0,\t'How many days voting widget should not be expanded after last show',\t0),\n                ('track_online_visitors',\t'1',\t0,\t'Enable online site visitors tracking',\t0),\n        \t   \t('pro_active_invite',\t'1',\t0,\t'Is pro active chat invitation active. Online users tracking also has to be enabled',\t0),\n                ('customer_company_name',\t'Live Helper Chat',\t0,\t'Your company name - visible in bottom left corner',\t0),\n                ('customer_site_url',\t'http://livehelperchat.com',\t0,\t'Your site URL address',\t0),\n                ('transfer_configuration','0','0','Transfer configuration','1'),\n                ('list_unread','0','0','List unread chats','0'),\n                ('list_closed','0','0','List closed chats','0'),\n                ('vwait_to_long','120','0','How long we should wait before we inform operator about unanswered chat.','0'),\n                ('autoclose_activity_timeout','0','0','Automatically close active chat if from last visitor/operator message passed. 0 - disabled, n > 0 time in minutes','0'),\n                ('mobile_options',\t'a:2:{s:13:\\\"notifications\\\";i:0;s:7:\\\"fcm_key\\\";s:152:\\\"AAAAiF8DeNk:APA91bFVHu2ybhBUTtlEtQrUEPpM2fb-5ovgo0FVNm4XxK3cYJtSwRcd-pqcBot_422yDOzHyw2p9ZFplkHrmNXjm8f5f-OIzfalGmpsypeXvnPxhU6Db1B2Z1Acc-TamHUn2F4xBJkP\\\";}',\t0,\t'',\t1),\n                ('footprint_background','0','0','Footprint updates should be processed in the background. Make sure you are running workflow background cronjob.','0'),\n                ('reverse_pending','0','0','Make default pending chats order from old to new','0'),\n                ('departament_availability','364','0','How long department availability statistic should be kept? (days)','0'),\n                ('uonline_sessions','364','0','How long keep operators online sessions data? (days)','0'),\n                ('disable_live_autoassign','0','0','Disable live auto assign','0'),\n                ('tracked_footprint_cleanup','90','0','How many days keep records of users footprint.','0'),\n                ('cleanup_cronjob','0','0','Cleanup should be done only using cronjob.','0'),         \n                ('no_wildcard_cookie','0','0','Cookie should be valid only for domain where Javascript is embedded (excludes subdomains)','0'),\n                ('cduration_timeout_user','4','0','How long operator can wait for message from visitor before time between messages are ignored. Values in minutes.','0'),\n                ('cduration_timeout_operator','10','0','How long visitor can wait for message from operator before time between messages are ignored. Values in minutes.','0'),       \n                ('assign_workflow_timeout','0','0','Chats waiting in pending line more than n seconds should be auto assigned first. Time in seconds','0'),\n        \t   \t('smtp_data',\t'a:5:{s:4:\\\"host\\\";s:0:\\\"\\\";s:4:\\\"port\\\";s:2:\\\"25\\\";s:8:\\\"use_smtp\\\";i:0;s:8:\\\"username\\\";s:0:\\\"\\\";s:8:\\\"password\\\";s:0:\\\"\\\";}',\t0,\t'SMTP configuration',\t1),\n        \t    ('chatbox_data',\t'a:6:{i:0;b:0;s:20:\\\"chatbox_auto_enabled\\\";i:0;s:19:\\\"chatbox_secret_hash\\\";s:{$randomHashLength}:\\\"{$randomHash}\\\";s:20:\\\"chatbox_default_name\\\";s:7:\\\"Chatbox\\\";s:17:\\\"chatbox_msg_limit\\\";i:50;s:22:\\\"chatbox_default_opname\\\";s:7:\\\"Manager\\\";}',\t0,\t'Chatbox configuration',\t1),\n                ('start_chat_data',\t'a:80:{i:0;b:0;s:21:\\\"name_visible_in_popup\\\";b:0;s:27:\\\"name_visible_in_page_widget\\\";b:0;s:19:\\\"name_require_option\\\";s:8:\\\"required\\\";s:22:\\\"email_visible_in_popup\\\";b:0;s:28:\\\"email_visible_in_page_widget\\\";b:0;s:20:\\\"email_require_option\\\";s:8:\\\"required\\\";s:24:\\\"message_visible_in_popup\\\";b:1;s:30:\\\"message_visible_in_page_widget\\\";b:1;s:22:\\\"message_require_option\\\";s:8:\\\"required\\\";s:22:\\\"phone_visible_in_popup\\\";b:0;s:28:\\\"phone_visible_in_page_widget\\\";b:0;s:20:\\\"phone_require_option\\\";s:8:\\\"required\\\";s:21:\\\"force_leave_a_message\\\";b:0;s:29:\\\"offline_name_visible_in_popup\\\";b:1;s:35:\\\"offline_name_visible_in_page_widget\\\";b:1;s:27:\\\"offline_name_require_option\\\";s:8:\\\"required\\\";s:30:\\\"offline_phone_visible_in_popup\\\";b:0;s:36:\\\"offline_phone_visible_in_page_widget\\\";b:0;s:28:\\\"offline_phone_require_option\\\";s:8:\\\"required\\\";s:32:\\\"offline_message_visible_in_popup\\\";b:1;s:38:\\\"offline_message_visible_in_page_widget\\\";b:1;s:30:\\\"offline_message_require_option\\\";s:8:\\\"required\\\";s:15:\\\"auto_start_chat\\\";b:0;s:12:\\\"mobile_popup\\\";b:0;s:17:\\\"dont_auto_process\\\";b:0;s:20:\\\"tos_visible_in_popup\\\";b:0;s:12:\\\"requires_dep\\\";b:0;s:17:\\\"requires_dep_lock\\\";b:0;s:17:\\\"show_messages_box\\\";b:1;s:26:\\\"tos_visible_in_page_widget\\\";b:0;s:19:\\\"tos_checked_offline\\\";b:0;s:18:\\\"tos_checked_online\\\";b:0;s:28:\\\"offline_tos_visible_in_popup\\\";b:0;s:34:\\\"offline_tos_visible_in_page_widget\\\";b:0;s:35:\\\"offline_file_visible_in_page_widget\\\";b:0;s:29:\\\"offline_file_visible_in_popup\\\";b:0;s:11:\\\"name_hidden\\\";b:0;s:15:\\\"name_hidden_bot\\\";b:0;s:24:\\\"custom_fields_encryption\\\";s:0:\\\"\\\";s:19:\\\"offline_name_hidden\\\";b:0;s:13:\\\"pre_chat_html\\\";s:0:\\\"\\\";s:21:\\\"pre_offline_chat_html\\\";s:0:\\\"\\\";s:12:\\\"email_hidden\\\";b:0;s:16:\\\"email_hidden_bot\\\";b:0;s:20:\\\"offline_email_hidden\\\";b:0;s:15:\\\"user_msg_height\\\";s:0:\\\"\\\";s:12:\\\"phone_hidden\\\";b:0;s:16:\\\"phone_hidden_bot\\\";b:0;s:20:\\\"offline_phone_hidden\\\";b:0;s:14:\\\"message_hidden\\\";b:0;s:18:\\\"message_hidden_bot\\\";b:0;s:18:\\\"message_auto_start\\\";b:0;s:28:\\\"message_auto_start_key_press\\\";b:0;s:22:\\\"offline_message_hidden\\\";b:0;s:21:\\\"show_operator_profile\\\";b:1;s:21:\\\"remove_operator_space\\\";b:0;s:18:\\\"hide_message_label\\\";b:0;s:17:\\\"custom_fields_url\\\";s:0:\\\"\\\";s:13:\\\"custom_fields\\\";s:0:\\\"\\\";s:21:\\\"name_hidden_prefilled\\\";b:0;s:22:\\\"email_hidden_prefilled\\\";b:0;s:24:\\\"message_hidden_prefilled\\\";b:0;s:22:\\\"phone_hidden_prefilled\\\";b:0;s:29:\\\"offline_name_hidden_prefilled\\\";b:0;s:32:\\\"offline_message_hidden_prefilled\\\";b:0;s:30:\\\"offline_phone_hidden_prefilled\\\";b:0;s:18:\\\"disable_start_chat\\\";b:0;s:18:\\\"offline_name_width\\\";i:0;s:19:\\\"offline_email_width\\\";i:0;s:19:\\\"offline_phone_width\\\";i:0;s:10:\\\"name_width\\\";i:0;s:11:\\\"email_width\\\";i:0;s:11:\\\"phone_width\\\";i:0;s:17:\\\"hide_start_button\\\";b:0;s:9:\\\"lazy_load\\\";b:0;s:28:\\\"offline_email_require_option\\\";s:8:\\\"required\\\";s:30:\\\"offline_email_hidden_prefilled\\\";b:0;s:36:\\\"offline_email_visible_in_page_widget\\\";b:1;s:30:\\\"offline_email_visible_in_popup\\\";b:1;}',\t0,\t'',\t1),\n                ('application_name',\t'a:6:{s:3:\\\"eng\\\";s:31:\\\"Live Helper Chat - live support\\\";s:3:\\\"lit\\\";s:26:\\\"Live Helper Chat - pagalba\\\";s:3:\\\"hrv\\\";s:0:\\\"\\\";s:3:\\\"esp\\\";s:0:\\\"\\\";s:3:\\\"por\\\";s:0:\\\"\\\";s:10:\\\"site_admin\\\";s:31:\\\"Live Helper Chat - live support\\\";}',\t1,\t'Support application name, visible in browser title.',\t0),\n                ('track_footprint',\t'0',\t0,\t'Track users footprint. For this also online visitors tracking should be enabled',\t0),\n                ('pro_active_limitation',\t'-1',\t0,\t'Pro active chats invitations limitation based on pending chats, (-1) do not limit, (0,1,n+1) number of pending chats can be for invitation to be shown.',\t0),\n                ('pro_active_show_if_offline',\t'0',\t0,\t'Should invitation logic be executed if there is no online operators',\t0),\n                ('export_hash',\t'{$exportHash}',\t0,\t'Chats export secret hash',\t0),\n                ('do_no_track_ip', 0, 0, 'Do not track visitors IP',0),\n                ('remember_username','1','0','Should we remember username for the next time visitor starts a chat?','0'),\n                ('ignore_typing', 0, 0, 'Do not store what visitor is typing',0),\n                ('encrypt_msg_after', 0, 0, 'After how many days anonymize messages',0),\n                ('encrypt_msg_op', 0, 0, 'Anonymize also operators messages',0),\n                ('valid_domains','','0','Domains where script can be embedded. E.g example.com, google.com','0'),\n                ('message_seen_timeout', 24, 0, 'Proactive message timeout in hours. After how many hours proactive chat mesasge should be shown again.',\t0),\n                ('reopen_chat_enabled',0,\t0,\t'Reopen chat functionality enabled',\t0),\n                ('ignorable_ip',\t'',\t0,\t'Which ip should be ignored in online users list, separate by comma',0),\n                ('run_departments_workflow', 0, 0, 'Should cronjob run departments transfer workflow, even if user leaves a chat',\t0),\n                ('geo_location_data', 'a:3:{s:4:\\\"zoom\\\";i:4;s:3:\\\"lat\\\";s:7:\\\"49.8211\\\";s:3:\\\"lng\\\";s:7:\\\"11.7835\\\";}', '0', '', '1'),\n                ('xmp_data','a:14:{i:0;b:0;s:4:\\\"host\\\";s:15:\\\"talk.google.com\\\";s:6:\\\"server\\\";s:9:\\\"gmail.com\\\";s:8:\\\"resource\\\";s:6:\\\"xmpphp\\\";s:4:\\\"port\\\";s:4:\\\"5222\\\";s:7:\\\"use_xmp\\\";i:0;s:8:\\\"username\\\";s:0:\\\"\\\";s:8:\\\"password\\\";s:0:\\\"\\\";s:11:\\\"xmp_message\\\";s:98:\\\"New chat request [{chat_id}] from [{department}]\\r\\n{messages}\\r\\nClick to accept a chat\\r\\n{url_accept}\\\";s:10:\\\"recipients\\\";s:0:\\\"\\\";s:20:\\\"xmp_accepted_message\\\";s:89:\\\"{user_name} has accepted a chat [{chat_id}] from [{department}]\\r\\n{messages}\\r\\n{url_accept}\\\";s:16:\\\"use_standard_xmp\\\";i:0;s:15:\\\"test_recipients\\\";s:0:\\\"\\\";s:21:\\\"test_group_recipients\\\";s:0:\\\"\\\";}',0,'XMP data',1),\n                ('run_unaswered_chat_workflow', 0, 0, 'Should cronjob run unanswered chats workflow and execute unaswered chats callback, 0 - no, any other number bigger than 0 is a minits how long chat have to be not accepted before executing callback.',0),\n                ('disable_popup_restore', 0, 0, 'Disable option in widget to open new window. Restore icon will be hidden',\t0),\n                ('accept_tos_link', '#', 0, 'Change to your site Terms of Service', 0),\n                ('hide_button_dropdown', '0', 0, 'Hide close button in dropdown', 0),\n                ('on_close_exit_chat', '0', 0, 'On chat close exit chat', 0),\n                ('activity_timeout', '5', 0, 'How long operator should go offline automatically because of inactivity. Value in minutes', 0),\n                ('product_enabled_module','0','0','Product module is enabled', '1'),\n                ('preload_iframes','0','0','Preload widget. It will avoid loading delay after clicking widget','0'),\n                ('product_show_departament','0','0','Enable products show by departments', '1'),\n                ('paidchat_data','','0','Paid chat configuration','1'),\n                ('mheight_op','200','0','Messages box height for operator','0'),\n                ('listd_op','10','0','Default number of online operators to show','0'),\n                ('disable_iframe_sharing',\t'1',\t0,\t'Disable iframes in sharing mode',\t0),\n                ('file_configuration',\t'a:7:{i:0;b:0;s:5:\\\"ft_op\\\";s:47:\\\"gif|jpe?g|png|zip|svg|rar|xls|doc|docx|xlsx|pdf\\\";s:5:\\\"ft_us\\\";s:30:\\\"gif|jpe?g|png|svg|doc|docx|pdf\\\";s:6:\\\"fs_max\\\";i:2048;s:18:\\\"active_user_upload\\\";b:0;s:16:\\\"active_op_upload\\\";b:1;s:19:\\\"active_admin_upload\\\";b:1;}',\t0,\t'Files configuration item',\t1),\n                ('accept_chat_link_timeout',\t'300',\t0,\t'How many seconds chat accept link is valid. Set 0 to force login all the time manually.',\t0),\n                ('open_closed_chat_timeout',\t'1800',\t0,\t'How many seconds customer has to open already closed chat.',\t0),\n                ('session_captcha',0,\t0,\t'Use session captcha. LHC have to be installed on the same domain or subdomain.',\t0),\n                ('sync_sound_settings',\t'a:16:{i:0;b:0;s:12:\\\"repeat_sound\\\";i:1;s:18:\\\"repeat_sound_delay\\\";i:5;s:10:\\\"show_alert\\\";b:0;s:22:\\\"new_chat_sound_enabled\\\";b:1;s:31:\\\"new_message_sound_admin_enabled\\\";b:1;s:30:\\\"new_message_sound_user_enabled\\\";b:1;s:14:\\\"online_timeout\\\";d:300;s:22:\\\"check_for_operator_msg\\\";d:10;s:21:\\\"back_office_sinterval\\\";d:10;s:22:\\\"chat_message_sinterval\\\";d:3.5;s:20:\\\"long_polling_enabled\\\";b:0;s:30:\\\"polling_chat_message_sinterval\\\";d:1.5;s:29:\\\"polling_back_office_sinterval\\\";d:5;s:18:\\\"connection_timeout\\\";i:30;s:28:\\\"browser_notification_message\\\";b:0;}',\t0,\t'',\t1),\n                ('sound_invitation', 1, 0, 'Play sound on invitation to chat.',\t0),\n                ('explicit_http_mode', '',0,'Please enter explicit http mode. Either http: or https:, do not forget : at the end.', '0'),\n                ('track_domain',\t'',\t0,\t'Set your domain to enable user tracking across different domain subdomains.',\t0),\n                ('max_message_length','500',0,'Maximum message length in characters', '0'),\n                ('need_help_tip','1',0,'Show need help tooltip?', '0'),\n                ('recaptcha_data','a:4:{i:0;b:0;s:8:\\\"site_key\\\";s:0:\\\"\\\";s:10:\\\"secret_key\\\";s:0:\\\"\\\";s:7:\\\"enabled\\\";i:0;}','0','Re-captcha configuration','1'),\n                ('need_help_tip_timeout','24',0,'Need help tooltip timeout, after how many hours show again tooltip?', '0'),\n                ('use_secure_cookie','0',0,'Use secure cookie, check this if you want to force SSL all the time', '0'),\n                ('faq_email_required','0',0,'Is visitor e-mail required for FAQ', '0'),\n                ('disable_print','0',0,'Disable chat print', '0'),\n                ('hide_disabled_department','1',0,'Hide disabled department widget', '0'),\n                ('disable_send','0',0,'Disable chat transcript send', '0'),\n                ('autoclose_abandon_pending','0,0','0','Automatically close pending chats where visitor has left a chat. Timeout in minutes, last activity by visitor <desktop timeout>,<mobile timeout>,<status chat>','0'),\n                ('ignore_user_status','0',0,'Ignore users online statuses and use departments online hours', '0'),\n                ('bbc_button_visible','1',0,'Show BB Code button', '0'),\n                ('password_data','','0','Password requirements','1'),\n                ('activity_track_all','0','0','Track all logged operators activity and ignore their individual settings.','0'),\n                ('allow_reopen_closed','0', 0, 'Allow user to reopen closed chats?', '0'),\n                ('reopen_as_new','1', 0, 'Reopen closed chat as new? Otherwise it will be reopened as active.', '0'),\n                ('default_theme_id','0', 0, 'Default theme ID.', '1'),  \n                ('default_admin_theme_id','0', 0, 'Default admin theme ID', '1'),  \n                ('translation_data',\t'a:6:{i:0;b:0;s:19:\\\"translation_handler\\\";s:4:\\\"bing\\\";s:19:\\\"enable_translations\\\";b:0;s:14:\\\"bing_client_id\\\";s:0:\\\"\\\";s:18:\\\"bing_client_secret\\\";s:0:\\\"\\\";s:14:\\\"google_api_key\\\";s:0:\\\"\\\";}',\t0,\t'Translation data',\t1),              \n                ('disable_html5_storage','1',0,'Disable HMTL5 storage, check it if your site is switching between http and https', '0'),\n                ('automatically_reopen_chat','1',0,'Automatically reopen chat on widget open', '0'),\n                ('autoclose_timeout','0', 0, 'Automatic chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autoclose_timeout_pending','0', 0, 'Automatic pending chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autoclose_timeout_active','0', 0, 'Automatic active chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autoclose_timeout_bot','0', 0, 'Automatic bot chats closing. 0 - disabled, n > 0 time in minutes before chat is automatically closed', '0'),\n                ('autopurge_timeout','0', 0, 'Automatic chats purging. 0 - disabled, n > 0 time in minutes before chat is automatically deleted', '0'),\n                ('update_ip',\t'127.0.0.1',\t0,\t'Which ip should be allowed to update DB by executing http request, separate by comma?',0),\n                ('track_if_offline',\t'0',\t0,\t'Track online visitors even if there is no online operators',0),\n                ('min_phone_length','8',0,'Minimum phone number length',0),\n                ('mheight','',0,'Messages box height',0),\n                ('inform_unread_message','0',0,'Inform visitor about unread messages from operator, value in minutes. 0 - disabled',0),\n                ('dashboard_order', '[[\\\"online_operators\\\",\\\"departments_stats\\\",\\\"online_visitors\\\"],[\\\"group_chats\\\",\\\"my_chats\\\",\\\"pending_chats\\\",\\\"transfered_chats\\\"],[\\\"active_chats\\\",\\\"bot_chats\\\"]]', '0', 'Home page dashboard widgets order', '0'),\n                ('banned_ip_range','',0,'Which ip should not be allowed to chat',0),\n                ('suggest_leave_msg','1',0,'Suggest user to leave a message then user chooses offline department',0),\n                ('checkstatus_timeout','0',0,'Interval between chat status checks in seconds, 0 disabled.',0),\n                ('show_language_switcher','0',0,'Show users option to switch language at widget',0),\n                ('sharing_auto_allow','0',0,'Do not ask permission for users to see their screen',0),\n                ('sharing_nodejs_enabled','0',0,'NodeJs support enabled',0),\n                ('sharing_nodejs_path','',0,'socket.io path, optional',0),\n                ('online_if','0','0','','0'),\n                ('track_mouse_activity','0','0','Should mouse movement be tracked as activity measure, if not checked only basic events would be tracked','0'),\n                ('track_activity','0','0','Track users activity on site?','0'),\n                ('autologin_data','a:3:{i:0;b:0;s:11:\\\"secret_hash\\\";s:16:\\\"please_change_me\\\";s:7:\\\"enabled\\\";i:0;}',0,'Autologin configuration data',\t1),\n                ('sharing_nodejs_secure','0',0,'Connect to NodeJs in https mode',0),\n                ('disable_js_execution','1',0,'Disable JS execution in Co-Browsing operator window',0),\n                ('sharing_nodejs_socket_host','',0,'Host where NodeJs is running',0),\n                ('hide_right_column_frontpage','1','0','Hide right column in frontpage','0'),\n                ('front_tabs', 'dashboard,online_users,online_map', '0', 'Home page tabs order', '0'),\n                ('speech_data',\t'a:3:{i:0;b:0;s:8:\\\"language\\\";i:7;s:7:\\\"dialect\\\";s:5:\\\"en-US\\\";}',\t1,\t'',\t1),\n                ('sharing_nodejs_sllocation','https://cdn.jsdelivr.net/npm/socket.io-client@2/dist/socket.io.js',0,'Location of SocketIO JS library',0),\n                ('track_is_online','0',0,'Track is user still on site, chat status checks also has to be enabled',0),\n\t\t\t\t('show_languages','eng,lit,hrv,esp,por,nld,ara,ger,pol,rus,ita,fre,chn,cse,nor,tur,vnm,idn,sve,per,ell,dnk,rou,bgr,tha,geo,fin,alb',0,'Between what languages user should be able to switch',0),\n                ('geoadjustment_data',\t'a:8:{i:0;b:0;s:18:\\\"use_geo_adjustment\\\";b:0;s:13:\\\"available_for\\\";s:0:\\\"\\\";s:15:\\\"other_countries\\\";s:6:\\\"custom\\\";s:8:\\\"hide_for\\\";s:0:\\\"\\\";s:12:\\\"other_status\\\";s:7:\\\"offline\\\";s:11:\\\"rest_status\\\";s:6:\\\"hidden\\\";s:12:\\\"apply_widget\\\";i:0;}',\t0,\t'Geo adjustment settings',\t1),\n                {$geoRow}\");\n\n\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_online_user` (\n                  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `vid` varchar(50) NOT NULL,\n                  `ip` varchar(50) NOT NULL,\n                  `current_page` text NOT NULL,\n        \t   \t  `page_title` varchar(250) NOT NULL,\n                  `referrer` text NOT NULL,\n                  `chat_id` bigint(20) NOT NULL,\n                  `invitation_seen_count` int(11) NOT NULL,\n        \t   \t  `invitation_id` int(11) NOT NULL,\n                  `last_visit` int(11) NOT NULL,\n        \t   \t  `first_visit` int(11) NOT NULL,\n        \t   \t  `total_visits` int(11) NOT NULL,\n        \t   \t  `pages_count` int(11) NOT NULL,\n        \t   \t  `tt_pages_count` int(11) NOT NULL,\n        \t   \t  `invitation_count` int(11) NOT NULL,\n        \t   \t  `last_check_time` int(11) NOT NULL,\n        \t   \t  `dep_id` int(11) NOT NULL,        \t   \t \n                  `user_agent` text NOT NULL,\n                  `notes` varchar(250) NOT NULL,\n                  `user_country_code` varchar(50) NOT NULL,\n                  `user_country_name` varchar(50) NOT NULL,\n                  `visitor_tz` varchar(50) NOT NULL,\n                  `operator_message` text NOT NULL,\n                  `operator_user_proactive` varchar(100) NOT NULL,\n                  `operator_user_id` int(11) NOT NULL,\n                  `conversion_id` int(11) NOT NULL,\n                  `message_seen` int(11) NOT NULL,\n                  `message_seen_ts` int(11) NOT NULL,\n                  `user_active` int(11) NOT NULL,\n        \t   \t  `lat` varchar(10) NOT NULL,\n  \t\t\t\t  `lon` varchar(10) NOT NULL,\n  \t\t\t\t  `city` varchar(100) NOT NULL,\n        \t   \t  `reopen_chat` int(11) NOT NULL,\n        \t   \t  `time_on_site` int(11) NOT NULL,\n  \t\t\t\t  `tt_time_on_site` int(11) NOT NULL,\n        \t   \t  `requires_email` int(11) NOT NULL,\n        \t   \t  `requires_username` int(11) NOT NULL,\n        \t   \t  `requires_phone` int(11) NOT NULL,\n        \t   \t  `screenshot_id` int(11) NOT NULL,\n        \t   \t  `identifier` varchar(50) NOT NULL,\n        \t   \t  `operation` text NOT NULL,\n        \t   \t  `online_attr_system` text NOT NULL,\n        \t   \t  `operation_chat` text NOT NULL,\n        \t   \t  `online_attr` text NOT NULL,\n        \t   \t  `device_type` tinyint(1) NOT NULL DEFAULT '0',\n                  `chat_time` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  `last_visit_prev` bigint(20) unsigned NOT NULL DEFAULT 0,\n                  PRIMARY KEY (`id`),\n                  KEY `vid` (`vid`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `last_visit_dep_id` (`last_visit`,`dep_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_proactive_chat_invitation` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `siteaccess` varchar(10) NOT NULL,\n\t\t\t\t  `time_on_site` int(11) NOT NULL,\n\t\t\t\t  `pageviews` int(11) NOT NULL,\n\t\t\t\t  `message` text NOT NULL,\n\t\t\t\t  `message_returning` text NOT NULL,\n\t\t\t\t  `executed_times` int(11) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `hide_after_ntimes` int(11) NOT NULL,\n\t\t\t\t  `show_on_mobile` int(11) NOT NULL,\n\t\t\t\t  `delay` int(11) NOT NULL,\n\t\t\t\t  `delay_init` int(11) NOT NULL,\n\t\t\t\t  `show_instant` int(11) NOT NULL,\n\t\t\t\t  `autoresponder_id` int(11) NOT NULL,\n\t\t\t\t  `disabled` int(11) NOT NULL,\n\t\t\t\t  `inject_only_html` tinyint(1) NOT NULL,\n\t\t\t\t  `name` varchar(50) NOT NULL,\n\t\t\t\t  `operator_ids` varchar(100) NOT NULL,\t\t\t\t \n\t\t\t\t  `message_returning_nick` varchar(250) NOT NULL,\n\t\t\t\t  `referrer` varchar(250) NOT NULL,\t\t\t\t  \n\t\t\t\t  `show_random_operator` int(11) NOT NULL,\n\t\t\t\t  `operator_name` varchar(100) NOT NULL,\n\t\t\t\t  `campaign_id` int(11) NOT NULL,\n\t\t\t\t  `position` int(11) NOT NULL,\n\t\t\t\t  `event_invitation` int(11) NOT NULL,\n\t\t\t\t  `dynamic_invitation` int(11) NOT NULL,\n\t\t\t\t  `bot_id` int(11) NOT NULL,\n\t\t\t\t  `trigger_id` int(11) NOT NULL,\n\t\t\t\t  `bot_offline` tinyint(1) NOT NULL,\n        \t   \t  `identifier` varchar(50) NOT NULL,\n        \t   \t  `tag` varchar(50) NOT NULL,\n        \t   \t  `requires_email` int(11) NOT NULL,\n        \t   \t  `iddle_for` int(11) NOT NULL,\n        \t   \t  `event_type` int(11) NOT NULL,\n        \t   \t  `requires_username` int(11) NOT NULL,\n        \t   \t  `requires_phone` int(11) NOT NULL,        \t   \t  \n        \t   \t  `design_data` longtext NOT NULL,        \t   \t  \n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `time_on_site_pageviews_siteaccess_position` (`time_on_site`,`pageviews`,`siteaccess`,`identifier`,`position`),\n        \t      KEY `identifier` (`identifier`),\n        \t      KEY `dynamic_invitation` (`dynamic_invitation`),\n        \t      KEY `tag` (`tag`),\n        \t      KEY `show_on_mobile` (`show_on_mobile`),\n        \t      KEY `dep_id` (`dep_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_chat_accept` (\n        \t   `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t   `chat_id` bigint(20) NOT NULL,\n        \t   `hash` varchar(50) NOT NULL,\n        \t   `ctime` int(11) NOT NULL,\n        \t   `wused` int(11) NOT NULL,\n        \t   PRIMARY KEY (`id`),\n        \t   KEY `hash` (`hash`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    //Default departament\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_departament` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `name` varchar(100) NOT NULL,\n\t\t\t\t  `email` varchar(100) NOT NULL,\n\t\t\t\t  `xmpp_recipients` text NOT NULL,\n\t\t\t\t  `xmpp_group_recipients` text NOT NULL,\n\t\t\t\t  `priority` int(11) NOT NULL,\n\t\t\t\t  `sort_priority` int(11) NOT NULL,\n\t\t\t\t  `department_transfer_id` int(11) NOT NULL,\n\t\t\t\t  `transfer_timeout` int(11) NOT NULL,\n\t\t\t\t  `exclude_inactive_chats` int(11) NOT NULL,\n\t\t\t\t  `delay_before_assign` int(11) NOT NULL,\n\t\t\t\t  `max_ac_dep_chats` int(11) NOT NULL,\n\t\t\t\t  `assign_same_language` int(11) NOT NULL,\n\t\t\t\t  `archive` tinyint(1) NOT NULL DEFAULT '0',\n\t\t\t\t  `max_load` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `max_load_h` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `disabled` int(11) NOT NULL,\n\t\t\t\t  `hidden` int(11) NOT NULL,\n\t\t\t\t  `delay_lm` int(11) NOT NULL,\n\t\t\t\t  `max_active_chats` int(11) NOT NULL,\n\t\t\t\t  `max_timeout_seconds` int(11) NOT NULL,\n\t\t\t\t  `identifier` varchar(2083) NOT NULL,\n\t\t\t\t  `mod_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `mod_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `tud_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `tud_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `wed_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `wed_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `thd_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `thd_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `frd_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `frd_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sad_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sad_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sud_start_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `sud_end_hour` int(4) NOT NULL DEFAULT '-1',\n\t\t\t\t  `nc_cb_execute` tinyint(1) NOT NULL,\n\t\t\t\t  `na_cb_execute` tinyint(1) NOT NULL,\n\t\t\t\t  `inform_unread` tinyint(1) NOT NULL,\n\t\t\t\t  `active_balancing` tinyint(1) NOT NULL,\n\t\t\t\t  `visible_if_online` tinyint(1) NOT NULL,\n\t\t\t\t  `inform_close` int(11) NOT NULL,\n\t\t\t\t  `inform_unread_delay` int(11) NOT NULL,\n\t\t\t\t  `inform_options` varchar(250) NOT NULL,\n\t\t\t\t  `online_hours_active` tinyint(1) NOT NULL,\n\t\t\t\t  `inform_delay` int(11) NOT NULL,\n\t\t\t\t  `attr_int_1` int(11) NOT NULL,\n\t\t\t\t  `attr_int_2` int(11) NOT NULL,\n\t\t\t\t  `attr_int_3` int(11) NOT NULL,\n\t\t\t\t  `pending_max` int(11) NOT NULL,\n\t\t\t\t  `pending_group_max` int(11) NOT NULL,\n\t\t\t\t  `active_chats_counter` int(11) NOT NULL,\n\t\t\t\t  `inactive_chats_cnt` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `pending_chats_counter` int(11) NOT NULL,\n\t\t\t\t  `bot_chats_counter` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `inop_chats_cnt` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `acop_chats_cnt` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `inform_close_all` int(11) NOT NULL,\n\t\t\t\t  `inform_close_all_email` varchar(250) NOT NULL,\n\t\t\t\t  `alias` varchar(50) NOT NULL,\n\t\t\t\t  `product_configuration` longtext NOT NULL,\n\t\t\t\t  `bot_configuration` text NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `identifier_2` (`identifier`(191)),\n\t\t\t\t  KEY `archive` (`archive`),\n\t\t\t\t  KEY `alias` (`alias`),\n\t\t\t\t  KEY `attr_int_1` (`attr_int_1`),\n\t\t\t\t  KEY `attr_int_2` (`attr_int_2`),\n\t\t\t\t  KEY `attr_int_3` (`attr_int_3`),\n\t\t\t\t  KEY `active_chats_counter` (`active_chats_counter`),\n\t\t\t\t  KEY `pending_chats_counter` (`pending_chats_counter`),\n\t\t\t\t  KEY `bot_chats_counter` (`bot_chats_counter`),\n\t\t\t\t  KEY `disabled_hidden` (`disabled`, `hidden`),\n\t\t\t\t  KEY `sort_priority_name` (`sort_priority`, `name`),\n\t\t\t\t  KEY `active_mod` (`online_hours_active`,`mod_start_hour`,`mod_end_hour`),\n\t\t\t\t  KEY `active_tud` (`online_hours_active`,`tud_start_hour`,`tud_end_hour`),\n\t\t\t\t  KEY `active_wed` (`online_hours_active`,`wed_start_hour`,`wed_end_hour`),\n\t\t\t\t  KEY `active_thd` (`online_hours_active`,`thd_start_hour`,`thd_end_hour`),\n\t\t\t\t  KEY `active_frd` (`online_hours_active`,`frd_start_hour`,`frd_end_hour`),\n\t\t\t\t  KEY `active_sad` (`online_hours_active`,`sad_start_hour`,`sad_end_hour`),\n\t\t\t\t  KEY `active_sud` (`online_hours_active`,`sud_start_hour`,`sud_end_hour`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_departament_group_user` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `dep_group_id` int(11) NOT NULL,\n                  `user_id` int(11) NOT NULL,\n                  `read_only` tinyint(1) unsigned NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`id`),\n                  KEY `dep_group_id` (`dep_group_id`),\n                  KEY `user_id` (`user_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_departament_availability` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `dep_id` int(11) NOT NULL, `hour` int(11) NOT NULL, `hourminute` int(4) NOT NULL, `minute` int(11) NOT NULL, `time` int(11) NOT NULL, `ymdhi` bigint(20) NOT NULL, `ymd` int(11) NOT NULL, `status` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `ymdhi` (`ymdhi`), KEY `dep_id` (`dep_id`),  KEY `hourminute` (`hourminute`), KEY `time` (`time`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_product_departament` (\n        \t       `id` int(11) NOT NULL AUTO_INCREMENT,\n        \t       `product_id` int(11) NOT NULL,\n        \t       `departament_id` int(11) NOT NULL,\n        \t       PRIMARY KEY (`id`),\n        \t       KEY `departament_id` (`departament_id`)\n        \t   ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_departament_group_member` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `dep_id` int(11) NOT NULL,\n                  `dep_group_id` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `dep_group_id` (`dep_group_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_generic_bot_rest_api` (`id` bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY, `name` varchar(50) NOT NULL, `description` varchar(250), `configuration` text NOT NULL) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_departament_group` (\n                      `id` int(11) NOT NULL AUTO_INCREMENT,\n                      `name` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `achats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `inachats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `pchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `max_load` int(11) NOT NULL DEFAULT 0,\n                      `max_load_h` int(11) NOT NULL DEFAULT 0,\n                      `bchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `inopchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      `acopchats_cnt` int(11) NOT NULL DEFAULT 0,\n                      PRIMARY KEY (`id`)\n                    ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_canned_msg_tag_link` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `tag_id` int(11) NOT NULL,  `canned_id` int(11) NOT NULL,  PRIMARY KEY (`id`), KEY `canned_id` (`canned_id`), KEY `tag_id` (`tag_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_canned_msg_tag` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `tag` varchar(40) NOT NULL, PRIMARY KEY (`id`), KEY `tag` (`tag`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_subject` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `name` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n  `internal` tinyint(1) NOT NULL DEFAULT 0,\n  `internal_type` varchar(20) NOT NULL DEFAULT '',\n  PRIMARY KEY (`id`),\n  KEY `internal` (`internal`),\n  KEY `internal_type` (`internal_type`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_subject_dep` ( `id` int(11) NOT NULL AUTO_INCREMENT, `dep_id` int(11) NOT NULL, `subject_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `subject_id` (`subject_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_abstract_subject_chat` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `subject_id` int(11) NOT NULL, `chat_id` bigint(20) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_group_object` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `object_id` bigint(20) NOT NULL, `group_id` bigint(20) NOT NULL, `type` bigint(20) NOT NULL, PRIMARY KEY (`id`), KEY `object_id_type` (`object_id`,`type`), KEY `group_id` (`group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Bot tables\n                    $db->query(\"CREATE TABLE `lh_generic_bot_bot` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `configuration` longtext NOT NULL, `avatar` varchar(150) NOT NULL, `filename` varchar(250) NOT NULL, `filepath` varchar(250) NOT NULL, `name` varchar(100) NOT NULL, `nick` varchar(100) NOT NULL,`attr_str_1` varchar(100) NOT NULL, `attr_str_2` varchar(100) NOT NULL, `attr_str_3` varchar(100) NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_group` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL,`is_collapsed` int(11) NOT NULL DEFAULT '0', `pos` int(11) NOT NULL DEFAULT '0', `bot_id` bigint(20) NOT NULL, PRIMARY KEY (`id`), KEY `bot_id` (`bot_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_trigger` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL, `actions` longtext NOT NULL, `group_id` bigint(20) NOT NULL, `bot_id` int(11) NOT NULL, `default` int(11) NOT NULL, `default_unknown` int(11) NOT NULL, `as_argument` int(11) NOT NULL DEFAULT '0', `in_progress` int(11) NOT NULL DEFAULT '0', `default_unknown_btn` int(11) NOT NULL DEFAULT '0', `default_always` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `bot_id` (`bot_id`),  KEY `default_unknown` (`default_unknown`), KEY `in_progress` (`in_progress`), KEY `default_unknown_btn` (`default_unknown_btn`), KEY `default_always` (`default_always`), KEY `group_id` (`group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_trigger_event` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `pattern` text NOT NULL, `pattern_exc` text NOT NULL, `configuration` longtext NOT NULL, `trigger_id` bigint(20) NOT NULL, `bot_id` int(11) NOT NULL, `on_start_type` tinyint(1) NOT NULL, `priority` int(11) NOT NULL, `type` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `pattern_v2` (`pattern`(191)), KEY `type` (`type`), KEY `on_start_type` (`on_start_type`), KEY `trigger_id` (`trigger_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_payload` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL, `payload` varchar(100) NOT NULL, `bot_id` int(11) NOT NULL, `trigger_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `bot_id` (`bot_id`), KEY `trigger_id` (`trigger_id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_chat_workflow` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL,`trigger_id` bigint(20) NOT NULL, `time` int(11) NOT NULL, `identifier` varchar(100) NOT NULL, `status` int(11) NOT NULL, `collected_data` text, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_chat_event` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `counter` int(11) NOT NULL, `content` longtext NOT NULL, `ctime` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_pending_event` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `trigger_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_exception` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `name` varchar(100) NOT NULL, `priority` int(11) NOT NULL, `active` tinyint(1) NOT NULL, PRIMARY KEY (`id`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_exception_message` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `code` varchar(20) NOT NULL, `exception_group_id` int(11) NOT NULL, `priority` int(11) NOT NULL, `active` tinyint(1) NOT NULL, `message` text NOT NULL, PRIMARY KEY (`id`), KEY `code` (`code`), KEY `exception_group_id` (`exception_group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_tr_group` ( `id` int(11) NOT NULL AUTO_INCREMENT, `name` varchar(50) NOT NULL,`filename` varchar(250) NOT NULL,`filepath` varchar(250) NOT NULL,`configuration` longtext NOT NULL,`nick` varchar(100) NOT NULL, PRIMARY KEY (`id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_tr_item` ( `id` int(11) NOT NULL AUTO_INCREMENT, `group_id` int(11) NOT NULL, `identifier` varchar(50) NOT NULL, `translation` text NOT NULL, PRIMARY KEY (`id`),  KEY `identifier` (`identifier`), KEY `group_id` (`group_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_speech_user_language` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `user_id` bigint(20) NOT NULL, `language` varchar(20) NOT NULL, PRIMARY KEY (`id`), KEY `user_id_language` (`user_id`,`language`)) DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_audits` (`id` bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY, `category` varchar(255) NOT NULL, `file` varchar(255), `object_id` bigint(20) DEFAULT '0', `line` bigint(20), `message` longtext NOT NULL, `severity` varchar(255) NOT NULL, `source` varchar(255) NOT NULL, `time` timestamp NOT NULL, KEY `object_id` (`object_id`), KEY `source` (`source`(191)), KEY `category` (`category`(191))) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_chat_online_user_footprint_update` (`online_user_id` bigint(20) NOT NULL,  `command` varchar(20) NOT NULL,  `args` varchar(250) NOT NULL,  `ctime` int(11) NOT NULL, KEY `online_user_id` (`online_user_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_generic_bot_repeat_restrict` (`id` bigint(20) NOT NULL AUTO_INCREMENT PRIMARY KEY, `chat_id` bigint(20) NOT NULL, `trigger_id` bigint(20), `identifier` varchar(20), `counter` int(11) DEFAULT '0', KEY `chat_id_trigger_id` (`chat_id`,`trigger_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_users_login` (`id` bigint(20) NOT NULL AUTO_INCREMENT,`user_id` bigint(20) NOT NULL,`type` int(11) NOT NULL,`ctime` bigint(20) NOT NULL,`status` int(11) NOT NULL,`ip` varchar(100) NOT NULL,`msg` varchar(250) COLLATE utf8mb4_unicode_ci NOT NULL,PRIMARY KEY (`id`),KEY `user_id_type` (`user_id`,`type`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    $Departament = new erLhcoreClassModelDepartament();\n                    $Departament->name = $form->DefaultDepartament;\n                    erLhcoreClassDepartament::getSession()->save($Departament);\n\n                    //Department custom work hours\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_departament_custom_work_hours` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `date_from` int(11) NOT NULL,\n\t\t\t\t  `date_to` int(11) NOT NULL,\n\t\t\t\t  `start_hour` int(11) NOT NULL,\n\t\t\t\t  `end_hour` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `date_from` (`date_from`),\n\t\t\t\t  KEY `search_active` (`date_from`, `date_to`, `dep_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    //Administrators group\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_group` (\n               `id` int(11) NOT NULL AUTO_INCREMENT,\n               `name` varchar(50) NOT NULL,\n               `disabled` tinyint(1) NOT NULL,\n               `required` tinyint(1) NOT NULL DEFAULT '0',\n               PRIMARY KEY (`id`),\n               KEY `disabled` (`disabled`)\n               ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Admin group\n                    $GroupData = new erLhcoreClassModelGroup();\n                    $GroupData->name    = \"Administrators\";\n                    erLhcoreClassUser::getSession()->save($GroupData);\n\n                    // Precreate operators group\n                    $GroupDataOperators = new erLhcoreClassModelGroup();\n                    $GroupDataOperators->name    = \"Operators\";\n                    erLhcoreClassUser::getSession()->save($GroupDataOperators);\n\n                    //Administrators role\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_role` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `name` varchar(50) NOT NULL,\n                  PRIMARY KEY (`id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Administrators role\n                    $Role = new erLhcoreClassModelRole();\n                    $Role->name = 'Administrators';\n                    erLhcoreClassRole::getSession()->save($Role);\n\n                    // Operators role\n                    $RoleOperators = new erLhcoreClassModelRole();\n                    $RoleOperators->name = 'Operators';\n                    erLhcoreClassRole::getSession()->save($RoleOperators);\n\n                    //Assing group role\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_grouprole` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `group_id` int(11) NOT NULL,\n                  `role_id` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `group_id` (`role_id`,`group_id`),\n                  KEY `group_id_primary` (`group_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Assign admin role to admin group\n                    $GroupRole = new erLhcoreClassModelGroupRole();\n                    $GroupRole->group_id =$GroupData->id;\n                    $GroupRole->role_id = $Role->id;\n                    erLhcoreClassRole::getSession()->save($GroupRole);\n\n                    // Assign operators role to operators group\n                    $GroupRoleOperators = new erLhcoreClassModelGroupRole();\n                    $GroupRoleOperators->group_id =$GroupDataOperators->id;\n                    $GroupRoleOperators->role_id = $RoleOperators->id;\n                    erLhcoreClassRole::getSession()->save($GroupRoleOperators);\n\n                    // Users\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `username` varchar(80) NOT NULL,\n                  `password` varchar(200) NOT NULL,\n                  `email` varchar(100) NOT NULL,\n                  `time_zone` varchar(100) NOT NULL,\n                  `name` varchar(100) NOT NULL,\n                  `surname` varchar(100) NOT NULL,\n                  `filepath` varchar(200) NOT NULL,\n                  `filename` varchar(200) NOT NULL,\n                  `job_title` varchar(100) NOT NULL,\n                  `departments_ids` text NOT NULL,\n                  `chat_nickname` varchar(100) NOT NULL,\n                  `xmpp_username` varchar(200) NOT NULL,\n                  `session_id` varchar(40) NOT NULL,\n                  `avatar` varchar(150) NOT NULL,\n                  `operation_admin` text NOT NULL,\n                  `skype` varchar(50) NOT NULL,\n                  `exclude_autoasign` tinyint(1) NOT NULL,\n                  `disabled` tinyint(4) NOT NULL,\n                  `hide_online` tinyint(1) NOT NULL,\n                  `all_departments` tinyint(1) NOT NULL,\n                  `invisible_mode` tinyint(1) NOT NULL,\n                  `inactive_mode` tinyint(1) NOT NULL,\n                  `rec_per_req` tinyint(1) NOT NULL,\n                  `auto_accept` tinyint(1) NOT NULL,\n                  `max_active_chats` int(11) NOT NULL,\n                  `cache_version` int(11) unsigned NOT NULL DEFAULT '0',\n                  `pswd_updated` int(11) NOT NULL,\n                  `attr_int_1` int(11) NOT NULL,\n                  `attr_int_2` int(11) NOT NULL,\n                  `attr_int_3` int(11) NOT NULL,\n                  `force_logout` tinyint(1) unsigned NOT NULL DEFAULT '0',\n                  `llogin` bigint(20) unsigned NOT NULL DEFAULT '0',\n                  `always_on` tinyint(1) NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`id`),\n                  KEY `hide_online` (`hide_online`),\n                  KEY `rec_per_req` (`rec_per_req`),\n                  KEY `disabled` (`disabled`),\n                  KEY `email` (`email`),\n                  KEY `xmpp_username` (`xmpp_username`(191))\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $UserData = new erLhcoreClassModelUser();\n\n                    $UserData->setPassword($form->AdminPassword);\n                    $UserData->email   = $form->AdminEmail;\n                    $UserData->name    = $form->AdminName;\n                    $UserData->surname = $form->AdminSurname;\n                    $UserData->username = $form->AdminUsername;\n                    $UserData->all_departments = 1;\n                    $UserData->departments_ids = 0;\n                    $UserData->pswd_updated = time();\n\n                    erLhcoreClassUser::getSession()->save($UserData);\n\n                    // User departaments\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_userdep` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `user_id` int(11) NOT NULL,\n                  `dep_id` int(11) NOT NULL,\n                  `last_activity` int(11) NOT NULL,\n                  `lastd_activity` int(11) NOT NULL DEFAULT '0',\n                  `exclude_autoasign` tinyint(1) NOT NULL DEFAULT '0',\n                  `hide_online` int(11) NOT NULL,\n                  `last_accepted` int(11) NOT NULL DEFAULT '0',\n                  `active_chats` int(11) NOT NULL DEFAULT '0',\n                  `pending_chats` int(11) NOT NULL DEFAULT '0',\n                  `inactive_chats` int(11) NOT NULL DEFAULT '0',\n                  `max_chats` int(11) NOT NULL DEFAULT '0',\n                  `type` int(11) NOT NULL DEFAULT '0',\n                  `ro` tinyint(1) NOT NULL DEFAULT '0',\n                  `hide_online_ts` int(11) NOT NULL DEFAULT '0',\n                  `dep_group_id` int(11) NOT NULL DEFAULT '0',\n                  `always_on` tinyint(1) NOT NULL DEFAULT '0',\n                  PRIMARY KEY (`id`),\n                  KEY `last_activity_hide_online_dep_id` (`last_activity`,`hide_online`,`dep_id`),\n                  KEY `dep_id` (`dep_id`),\n                  KEY `user_id_type` (`user_id`,`type`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n\n                    // Insert record to departament instantly\n                    $db->query(\"INSERT INTO `lh_userdep` (`user_id`,`dep_id`,`last_activity`,`hide_online`,`last_accepted`,`active_chats`,`type`,`dep_group_id`,`exclude_autoasign`) VALUES ({$UserData->id},0,0,0,0,0,0,0,0)\");\n\n                    $db->query(\"CREATE TABLE `lh_group_work` (  `id` int(11) NOT NULL AUTO_INCREMENT,  `group_id` int(11) NOT NULL, `group_work_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `group_id` (`group_id`)) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Transfer chat\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_transfer` (\n\t\t\t\t  `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `chat_id` int(11) NOT NULL,\n\t\t\t\t  `dep_id` int(11) NOT NULL,\n\t\t\t\t  `transfer_user_id` int(11) NOT NULL,\n\t\t\t\t  `from_dep_id` int(11) NOT NULL,\n\t\t\t\t  `ctime` int(11) NOT NULL,\n\t\t\t\t  `transfer_to_user_id` int(11) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `dep_id` (`dep_id`),\n\t\t\t\t  KEY `transfer_user_id_dep_id` (`transfer_user_id`,`dep_id`),\n\t\t\t\t  KEY `transfer_to_user_id` (`transfer_to_user_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Remember user table\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_users_remember` (\n\t\t\t\t `id` int(11) NOT NULL AUTO_INCREMENT,\n\t\t\t\t `user_id` int(11) NOT NULL,\n\t\t\t\t `mtime` int(11) NOT NULL,\n\t\t\t\t PRIMARY KEY (`id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_generic_bot_command` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `command` varchar(50) NOT NULL,\n  `bot_id` int(11) NOT NULL,\n  `trigger_id` int(11) NOT NULL,\n  `dep_id` int(11) NOT NULL,\n  PRIMARY KEY (`id`),\n  KEY `dep_id` (`dep_id`),\n  KEY `command` (`command`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_canned_msg_subject` (\n    `id` int(11) NOT NULL AUTO_INCREMENT,\n    `canned_id` int(11) NOT NULL,\n    `subject_id` int(11) NOT NULL,\n    PRIMARY KEY (`id`),\n    KEY `canned_id` (`canned_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_canned_msg_replace` (\n                    `id` int(11) unsigned NOT NULL AUTO_INCREMENT,\n                    `identifier` varchar(50) NOT NULL,\n                    `default` text NOT NULL, `conditions` longtext NOT NULL,\n                    PRIMARY KEY (`id`),\n                   KEY `identifier` (`identifier`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_saved_search` (\n                    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n                  `name` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `params` longtext COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `user_id` bigint(20) unsigned NOT NULL,\n                  `position` int(11) unsigned NOT NULL,\n                  `scope` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL,\n                  `days` int(11) unsigned NOT NULL,\n                  `updated_at` bigint(20) unsigned NOT NULL,\n                  `requested_at` bigint(20) unsigned NOT NULL,\n                  `total_records` bigint(20) unsigned NOT NULL,\n                  `passive` tinyint(1) unsigned NOT NULL DEFAULT 0,\n                  PRIMARY KEY (`id`),\n                  KEY `user_id` (`user_id`),\n                  KEY `scope` (`scope`),\n                  KEY `updated_at` (`updated_at`),\n                  KEY `requested_at` (`requested_at`)\n                ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // API table\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_abstract_rest_api_key` (\n                    `id` int(11) NOT NULL AUTO_INCREMENT,\n                    `api_key` varchar(50) NOT NULL,\n                    `user_id` int(11) NOT NULL DEFAULT '0',\n                    `active` int(11) NOT NULL DEFAULT '0',\n                    `ip_restrictions` varchar(250) NOT NULL,\n                    PRIMARY KEY (`id`),\n                    KEY `api_key` (`api_key`),\n                    KEY `user_id` (`user_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_rest_api_key_remote` ( `id` int(11) NOT NULL AUTO_INCREMENT, `api_key` varchar(50) NOT NULL, `username` varchar(50) NOT NULL, `name` varchar(50) NOT NULL, `host` varchar(250) NOT NULL, `active` tinyint(1) NOT NULL DEFAULT '0', `position` int(11) NOT NULL DEFAULT '0', PRIMARY KEY (`id`), KEY `active` (`active`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\");\n                    $db->query(\"CREATE TABLE `lh_abstract_chat_variable` ( `id` int(11) NOT NULL AUTO_INCREMENT, `var_name` varchar(255) NOT NULL, `var_identifier` varchar(255) NOT NULL,`inv` tinyint(1) NOT NULL, `change_message` varchar(250) NOT NULL, `type` tinyint(1) NOT NULL, `persistent` tinyint(1) NOT NULL, `js_variable` varchar(255) NOT NULL, `dep_id` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `dep_id` (`dep_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_webhook` ( `id` int(11) NOT NULL AUTO_INCREMENT, `event` varchar(50) NOT NULL, `bot_id_alt` int(11) NOT NULL DEFAULT '0', `trigger_id_alt` int(11) NOT NULL DEFAULT '0', `bot_id` int(11) NOT NULL, `trigger_id` int(11) NOT NULL, `disabled` tinyint(1) NOT NULL, `configuration` longtext NOT NULL, `type` tinyint(1) NOT NULL DEFAULT 0, PRIMARY KEY (`id`), KEY `event_disabled` (`event`,`disabled`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_incoming_webhook` ( `id` int(11) NOT NULL AUTO_INCREMENT, `dep_id` int(11) NOT NULL, `name` varchar(50) NOT NULL,`identifier` varchar(50) NOT NULL, `scope` varchar(50) NOT NULL, `disabled` tinyint(1) NOT NULL, `configuration` longtext NOT NULL, PRIMARY KEY (`id`), KEY `identifier` (`identifier`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_chat_incoming` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `chat_id` bigint(20) NOT NULL, `utime` bigint(20) NOT NULL, `incoming_id` int(11) NOT NULL,`payload` longtext NOT NULL, `chat_external_id` varchar(50) NOT NULL, PRIMARY KEY (`id`), KEY `chat_id` (`chat_id`),  KEY `incoming_ext_id` (`incoming_id`,`chat_external_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    $db->query(\"CREATE TABLE `lh_abstract_chat_column` (`id` int(11) NOT NULL AUTO_INCREMENT,`column_name` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,`variable` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, `position` int(11) NOT NULL, `enabled` tinyint(1) NOT NULL, `online_enabled` tinyint(1) NOT NULL, `chat_enabled` tinyint(1) NOT NULL, `conditions` text COLLATE utf8mb4_unicode_ci NOT NULL,`column_icon` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, `column_identifier` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL, PRIMARY KEY (`id`), KEY `enabled` (`enabled`), KEY `online_enabled` (`online_enabled`), KEY `chat_enabled` (`chat_enabled`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_abstract_chat_priority` (`id` int(11) NOT NULL AUTO_INCREMENT,`value` text COLLATE utf8mb4_unicode_ci NOT NULL,`dep_id` int(11) NOT NULL, `dest_dep_id` int(11) NOT NULL DEFAULT 0, `sort_priority` int(11) NOT NULL DEFAULT 0,`priority` int(11) NOT NULL, PRIMARY KEY (`id`), KEY `dep_id` (`dep_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n                    $db->query(\"CREATE TABLE `lh_canned_msg_use` (`id` bigint(20) unsigned NOT NULL AUTO_INCREMENT, `canned_id` int(11) unsigned NOT NULL, `chat_id` bigint(20) unsigned NOT NULL, `ctime` bigint(20) unsigned NOT NULL, `user_id` bigint(20) unsigned NOT NULL, PRIMARY KEY (`id`), KEY `ctime` (`ctime`), KEY `chat_id` (`chat_id`), KEY `canned_id` (`canned_id`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n\n                    // Session\n                    $db->query(\"CREATE TABLE `lh_users_session` (\n                      `id` int(11) NOT NULL AUTO_INCREMENT,\n                      `token` varchar(40) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `device_type` int(11) NOT NULL,\n                      `device_token` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      `user_id` int(11) NOT NULL,\n                      `created_on` int(11) NOT NULL,\n                      `updated_on` int(11) NOT NULL,\n                      `expires_on` int(11) NOT NULL,\n                      `notifications_status` int(11) NOT NULL DEFAULT 1,\n                      `error` int(11) NOT NULL DEFAULT 0,\n                      `last_error` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL,\n                      PRIMARY KEY (`id`),\n                      KEY `token` (`token`),\n                      KEY `device_token_device_type_v2` (`device_token`(191),`device_type`),\n                      KEY `error` (`error`)\n                    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Chat messages\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_msg` (\n\t\t\t\t  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,\n\t\t\t\t  `msg` longtext NOT NULL,\n\t\t\t\t  `meta_msg` longtext NOT NULL,\n\t\t\t\t  `time` int(11) NOT NULL,\n\t\t\t\t  `chat_id` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `user_id` int(11) NOT NULL DEFAULT '0',\n\t\t\t\t  `name_support` varchar(100) NOT NULL,\n\t\t\t\t  PRIMARY KEY (`id`),\n\t\t\t\t  KEY `chat_id_id` (`chat_id`, `id`),\n\t\t\t\t  KEY `user_id` (`user_id`)\n\t\t\t\t) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Forgot password table\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_forgotpasswordhash` (\n                `id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,\n                `user_id` INT NOT NULL ,\n                `hash` VARCHAR( 40 ) NOT NULL ,\n                `created` INT NOT NULL\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // User groups table\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_groupuser` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `group_id` int(11) NOT NULL,\n                  `user_id` int(11) NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `group_id` (`group_id`),\n                  KEY `user_id` (`user_id`),\n                  KEY `group_id_2` (`group_id`,`user_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Assign admin user to admin group\n                    $GroupUser = new erLhcoreClassModelGroupUser();\n                    $GroupUser->group_id = $GroupData->id;\n                    $GroupUser->user_id = $UserData->id;\n                    erLhcoreClassUser::getSession()->save($GroupUser);\n\n                    //Assign default role functions\n                    $db->query(\"CREATE TABLE IF NOT EXISTS `lh_rolefunction` (\n                  `id` int(11) NOT NULL AUTO_INCREMENT,\n                  `role_id` int(11) NOT NULL,\n                  `module` varchar(100) NOT NULL,\n                  `function` varchar(100) NOT NULL,\n                  `limitation` text NOT NULL,\n                  PRIMARY KEY (`id`),\n                  KEY `role_id` (`role_id`)\n                ) ENGINE=InnoDB CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\");\n\n                    // Admin role and function\n                    $RoleFunction = new erLhcoreClassModelRoleFunction();\n                    $RoleFunction->role_id = $Role->id;\n                    $RoleFunction->module = '*';\n                    $RoleFunction->function = '*';\n                    erLhcoreClassRole::getSession()->save($RoleFunction);\n\n                    // Operators rules and functions\n                    $permissionsArray = array(\n                        array('module' => 'lhuser',  'function' => 'selfedit'),\n                        array('module' => 'lhuser',  'function' => 'change_chat_nickname'),\n                        array('module' => 'lhuser',  'function' => 'changephoto'),\n                        array('module' => 'lhuser',  'function' => 'change_job_title'),\n                        array('module' => 'lhuser',  'function' => 'change_core_attributes'),\n                        array('module' => 'lhuser',  'function' => 'change_name_surname'),\n                        array('module' => 'lhuser',  'function' => 'selfedit'),\n                        array('module' => 'lhuser',  'function' => 'changeonlinestatus'),\n                        array('module' => 'lhuser',  'function' => 'changeskypenick'),\n                        array('module' => 'lhuser',  'function' => 'personalcannedmsg'),\n                        array('module' => 'lhuser',  'function' => 'change_visibility_list'),\n                        array('module' => 'lhuser',  'function' => 'see_assigned_departments'),\n                        array('module' => 'lhuser',  'function' => 'canseedepartmentstats'),\n                        array('module' => 'lhchat',  'function' => 'use'),\n                        array('module' => 'lhchat',  'function' => 'open_all'),\n                        array('module' => 'lhchat',  'function' => 'chattabschrome'),\n                        array('module' => 'lhchat',  'function' => 'singlechatwindow'),\n                        array('module' => 'lhchat',  'function' => 'allowopenremotechat'),\n                        array('module' => 'lhchat',  'function' => 'writeremotechat'),\n                        array('module' => 'lhchat',  'function' => 'allowchattabs'),\n                        array('module' => 'lhchat',  'function' => 'use_onlineusers'),\n                        array('module' => 'lhchat',  'function' => 'take_screenshot'),\n                        array('module' => 'lhfront', 'function' => 'use'),\n                        array('module' => 'lhsystem','function' => 'use'),\n                        array('module' => 'lhtranslation','function' => 'use'),\n                        array('module' => 'lhchat',  'function' => 'allowblockusers'),\n                        array('module' => 'lhsystem','function' => 'generatejs'),\n                        array('module' => 'lhsystem','function' => 'changelanguage'),\n                        array('module' => 'lhchat',  'function' => 'allowredirect'),\n                        array('module' => 'lhchat',  'function' => 'allowtransfer'),\n                        array('module' => 'lhchat',  'function' => 'allowtransferdirectly'),\n                        array('module' => 'lhchat',  'function' => 'administratecannedmsg'),\n                        array('module' => 'lhchat',  'function' => 'explorecannedmsg'),\n                        array('module' => 'lhchat',  'function' => 'sees_all_online_visitors'),\n                        array('module' => 'lhpermission',   'function' => 'see_permissions'),\n                        array('module' => 'lhquestionary',  'function' => 'manage_questionary'),\n                        array('module' => 'lhfaq',   \t\t'function' => 'manage_faq'),\n                        array('module' => 'lhchatbox',   \t'function' => 'manage_chatbox'),\n                        array('module' => 'lhbrowseoffer',  'function' => 'manage_bo'),\n                        array('module' => 'lhxml',   \t\t'function' => '*'),\n                        array('module' => 'lhcobrowse',   \t'function' => 'browse'),\n                        array('module' => 'lhfile',   \t\t'function' => 'use_operator'),\n                        array('module' => 'lhfile',   \t\t'function' => 'file_delete_chat'),\n                        array('module' => 'lhstatistic',   \t'function' => 'use'),\n                        array('module' => 'lhspeech', 'function' => 'changedefaultlanguage'),\n                        array('module' => 'lhspeech', 'function' => 'use'),\n                        array('module' => 'lhcannedmsg', 'function' => 'use'),\n                        array('module' => 'lhcannedmsg', 'function' => 'see_global'),\n                        array('module' => 'lhchat', 'function' => 'prev_chats'),\n                        array('module' => 'lhtheme', 'function' => 'personaltheme'),\n                        array('module' => 'lhuser', 'function' => 'userlistonline'),\n                        array('module' => 'lhspeech', 'function' => 'change_chat_recognition'),\n                        array('module' => 'lhgroupchat', 'function' => 'use'),\n                        array('module' => 'lhuser', 'function' => 'see_all_group_users'),\n                        array('module' => 'lhvoicevideo', 'function' => 'use'),\n                        array('module' => 'lhtheme', 'function' => 'use_operator'),\n                        array('module' => 'lhgenericbot', 'function' => 'use_operator'),\n                    );\n\n                    foreach ($permissionsArray as $paramsPermission) {\n                        $RoleFunctionOperator = new erLhcoreClassModelRoleFunction();\n                        $RoleFunctionOperator->role_id = $RoleOperators->id;\n                        $RoleFunctionOperator->module = $paramsPermission['module'];\n                        $RoleFunctionOperator->function = $paramsPermission['function'];\n                        erLhcoreClassRole::getSession()->save($RoleFunctionOperator);\n                    }\n\n                    $cfgSite = erConfigClassLhConfig::getInstance();\n                    $cfgSite->setSetting( 'site', 'installed', true);\n                    $cfgSite->setSetting( 'site', 'templatecache', true);\n                    $cfgSite->setSetting( 'site', 'templatecompile', true);\n                    $cfgSite->setSetting( 'site', 'modulecompile', true);\n                    $cfgSite->setSetting( 'webhooks', 'enabled', (!empty(getenv('LHC_WEBHOOKS_ENABLED')) ? getenv('LHC_WEBHOOKS_ENABLED') : 0));\n                    $cfgSite->save();\n\n                    $tpl->setFile('lhinstall/install4.tpl.php');\n\n                } else {\n\n                    $tpl->set('admin_username',$form->AdminUsername);\n                    if ( $form->hasValidData( 'AdminEmail' ) ) $tpl->set('admin_email',$form->AdminEmail);\n                    $tpl->set('admin_name',$form->AdminName);\n                    $tpl->set('admin_surname',$form->AdminSurname);\n                    $tpl->set('admin_departament',$form->DefaultDepartament);\n\n                    $tpl->set('errors',$Errors);\n\n                    $tpl->setFile('lhinstall/install3.tpl.php');\n                }\n            } else {\n                $tpl->setFile('lhinstall/install3.tpl.php');\n            }\n\n            break;\n\n        case '4':\n            $tpl->setFile('lhinstall/install4.tpl.php');\n            break;\n\n        default:\n            $tpl->setFile('lhinstall/install1.tpl.php');\n            break;\n    }\n\n    $Result['content'] = $tpl->fetch();\n    $Result['pagelayout'] = 'install';\n    $Result['path'] = array(array('title' => 'Live helper chat installation'));\n\n} catch (Exception $e) {\n    echo \"Make sure that &quot;cache/*&quot; is writable and then <a href=\\\"\".erLhcoreClassDesign::baseurl('install/install').\"\\\">try again</a>\";\n\n    echo \"<pre>\";\n    print_r($e);\n    echo \"</pre>\";\n    exit;\n}\n?>\n"], "filenames": ["lhc_web/cli/lib/install.php", "lhc_web/modules/lhcaptcha/captchastring.php", "lhc_web/modules/lhinstall/install.php"], "buggy_code_start_loc": [87, 11, 167], "buggy_code_end_loc": [88, 12, 168], "fixing_code_start_loc": [87, 11, 167], "fixing_code_end_loc": [88, 12, 168], "type": "CWE-916", "message": "Weak secrethash can be brute-forced in GitHub repository livehelperchat/livehelperchat prior to 3.96.", "other": {"cve": {"id": "CVE-2022-1235", "sourceIdentifier": "security@huntr.dev", "published": "2022-04-05T07:15:08.353", "lastModified": "2022-04-13T17:10:02.240", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Weak secrethash can be brute-forced in GitHub repository livehelperchat/livehelperchat prior to 3.96."}, {"lang": "es", "value": "Puede forzarse un secrethash d\u00e9bil en el repositorio de GitHub livehelperchat/livehelperchat versiones anteriores a 3.96"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.2, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 4.2}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 6.4}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-916"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:livehelperchat:live_helper_chat:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.96", "matchCriteriaId": "A501764D-64D8-4CD8-9AE9-9B340EDD3DE4"}]}]}], "references": [{"url": "https://github.com/livehelperchat/livehelperchat/commit/6538d6df3d8a60fee254170b08dd76a161f7bfdc", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/92f7b2d4-fa88-4c62-a2ee-721eebe01705", "source": "security@huntr.dev", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/livehelperchat/livehelperchat/commit/6538d6df3d8a60fee254170b08dd76a161f7bfdc"}}