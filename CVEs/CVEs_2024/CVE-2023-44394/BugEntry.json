{"buggy_code": ["<?php\n# MantisBT - A PHP based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Wiki Functionality\n *\n * @package MantisBT\n * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org\n * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n * @link http://www.mantisbt.org\n *\n * @uses core.php\n * @uses bug_api.php\n * @uses gpc_api.php\n * @uses print_api.php\n * @uses project_api.php\n * @uses wiki_api.php\n */\n\nrequire_once( 'core.php' );\nrequire_api( 'bug_api.php' );\nrequire_api( 'gpc_api.php' );\nrequire_api( 'print_api.php' );\nrequire_api( 'project_api.php' );\nrequire_api( 'wiki_api.php' );\n\n$f_id = gpc_get_int( 'id' );\n$f_type = gpc_get_string( 'type', 'issue' );\n\nif( $f_type == 'project' ) {\n\tif( $f_id !== 0 ) {\n\t\tproject_ensure_exists( $f_id );\n\t}\n\n\t$t_url = wiki_link_project( $f_id );\n} else {\n\tbug_ensure_exists( $f_id );\n\t$t_url = wiki_link_bug( $f_id );\n}\n\nprint_header_redirect( $t_url, true, false, true );\n"], "fixing_code": ["<?php\n# MantisBT - A PHP based bugtracking system\n\n# MantisBT is free software: you can redistribute it and/or modify\n# it under the terms of the GNU General Public License as published by\n# the Free Software Foundation, either version 2 of the License, or\n# (at your option) any later version.\n#\n# MantisBT is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU General Public License for more details.\n#\n# You should have received a copy of the GNU General Public License\n# along with MantisBT.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Wiki Functionality\n *\n * @package MantisBT\n * @copyright Copyright 2000 - 2002  Kenzaburo Ito - kenito@300baud.org\n * @copyright Copyright 2002  MantisBT Team - mantisbt-dev@lists.sourceforge.net\n * @link http://www.mantisbt.org\n *\n * @uses core.php\n * @uses bug_api.php\n * @uses gpc_api.php\n * @uses print_api.php\n * @uses project_api.php\n * @uses wiki_api.php\n */\n\nrequire_once( 'core.php' );\nrequire_api( 'bug_api.php' );\nrequire_api( 'gpc_api.php' );\nrequire_api( 'print_api.php' );\nrequire_api( 'project_api.php' );\nrequire_api( 'wiki_api.php' );\n\n$f_id = gpc_get_int( 'id' );\n$f_type = gpc_get_string( 'type', 'issue' );\n\nif( $f_type == 'project' ) {\n\tif( $f_id !== 0 ) {\n\t\tproject_ensure_exists( $f_id );\n\t\taccess_ensure_project_level( VIEWER, $f_id );\n\t}\n\n\t$t_url = wiki_link_project( $f_id );\n} else {\n\tbug_ensure_exists( $f_id );\n\taccess_ensure_bug_level( VIEWER, $f_id );\n\t$t_url = wiki_link_bug( $f_id );\n}\n\nprint_header_redirect( $t_url, true, false, true );\n"], "filenames": ["wiki.php"], "buggy_code_start_loc": [45], "buggy_code_end_loc": [50], "fixing_code_start_loc": [46], "fixing_code_end_loc": [53], "type": "CWE-668", "message": "MantisBT is an open source bug tracker. Due to insufficient access-level checks on the Wiki redirection page, any user can reveal private Projects' names, by accessing wiki.php with sequentially incremented IDs. This issue has been addressed in commit `65c44883f` which has been included in release `2.258`. Users are advised to upgrade. Users unable to upgrade should disable wiki integration ( `$g_wiki_enable = OFF;`).", "other": {"cve": {"id": "CVE-2023-44394", "sourceIdentifier": "security-advisories@github.com", "published": "2023-10-16T22:15:12.560", "lastModified": "2023-10-23T13:40:07.230", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "MantisBT is an open source bug tracker. Due to insufficient access-level checks on the Wiki redirection page, any user can reveal private Projects' names, by accessing wiki.php with sequentially incremented IDs. This issue has been addressed in commit `65c44883f` which has been included in release `2.258`. Users are advised to upgrade. Users unable to upgrade should disable wiki integration ( `$g_wiki_enable = OFF;`)."}, {"lang": "es", "value": "MantisBT es un rastreador de errores de c\u00f3digo abierto. Debido a comprobaciones insuficientes del nivel de acceso en la p\u00e1gina de redirecci\u00f3n Wiki, cualquier usuario puede revelar los nombres de los proyectos privados accediendo a wiki.php con ID incrementadas secuencialmente. Este problema se solucion\u00f3 en el commit \"65c44883f\" que se incluy\u00f3 en la versi\u00f3n \"2.258\". Se recomienda a los usuarios que actualicen. Los usuarios que no puedan actualizar deben desactivar la integraci\u00f3n wiki (`$g_wiki_enable = OFF;`)."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-668"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-200"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:mantisbt:mantisbt:*:*:*:*:*:*:*:*", "versionEndExcluding": "2.25.8", "matchCriteriaId": "B2693D3D-D2B9-46EE-AB37-5D642D2F9600"}]}]}], "references": [{"url": "https://github.com/mantisbt/mantisbt/commit/65c44883f9d24f3ccef066fb523c93d8fdd7afc1", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/mantisbt/mantisbt/security/advisories/GHSA-v642-mh27-8j6m", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://mantisbt.org/bugs/view.php?id=32981", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}]}, "github_commit_url": "https://github.com/mantisbt/mantisbt/commit/65c44883f9d24f3ccef066fb523c93d8fdd7afc1"}}