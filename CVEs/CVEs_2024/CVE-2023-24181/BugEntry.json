{"buggy_code": ["<%#\n Copyright 2008 Steven Barth <steven@midlink.org>\n Copyright 2008 Jo-Philipp Wich <jow@openwrt.org>\n Licensed to the public under the Apache License 2.0.\n-%>\n\n<%+openvpn/ovpn_css%>\n\n<div class=\"cbi-section\">\n\t<h3>\n\t\t<a href=\"<%=url('admin/vpn/openvpn')%>\"><%:Overview%></a> &#187;\n\t\t<%=luci.i18n.translatef(\"Instance \\\"%s\\\"\", self.instance)%>\n\t</h3>\n\t<% if self.mode == \"basic\" then %>\n\t\t<a href=\"<%=url('admin/vpn/openvpn/advanced', self.instance)%>\"><%:Switch to advanced configuration%> &#187;</a><p/>\n\t\t<hr />\n\t<% elseif self.mode == \"advanced\" then %>\n\t\t<a href=\"<%=url('admin/vpn/openvpn/basic', self.instance)%>\"><%:Switch to basic configuration%> &#187;</a><p/>\n\t\t<hr />\n\t\t<%:Configuration category%>:\n\t\t<% for i, c in ipairs(self.categories) do %>\n\t\t\t<% if c.id == self.category then %>\n\t\t\t\t<strong><%=c.title%></strong>\n\t\t\t<% else %>\n\t\t\t\t<a href=\"<%=luci.dispatcher.build_url(\"admin\", \"vpn\", \"openvpn\", \"advanced\", self.instance, c.id)%>\"><%=c.title%></a>\n\t\t\t<% end %>\n\t\t\t<% if next(self.categories, i) then %>|<% end %>\n\t\t<% end %>\n\t<% end %>\n</div>\n"], "fixing_code": ["<%#\n Copyright 2008 Steven Barth <steven@midlink.org>\n Copyright 2008 Jo-Philipp Wich <jow@openwrt.org>\n Licensed to the public under the Apache License 2.0.\n-%>\n\n<%+openvpn/ovpn_css%>\n\n<div class=\"cbi-section\">\n\t<h3>\n\t\t<a href=\"<%=url('admin/vpn/openvpn')%>\"><%:Overview%></a> &#187;\n\t\t<%=luci.i18n.translatef(\"Instance \\\"%s\\\"\", pcdata(self.instance))%>\n\t</h3>\n\t<% if self.mode == \"basic\" then %>\n\t\t<a href=\"<%=url('admin/vpn/openvpn/advanced', self.instance)%>\"><%:Switch to advanced configuration%> &#187;</a><p/>\n\t\t<hr />\n\t<% elseif self.mode == \"advanced\" then %>\n\t\t<a href=\"<%=url('admin/vpn/openvpn/basic', self.instance)%>\"><%:Switch to basic configuration%> &#187;</a><p/>\n\t\t<hr />\n\t\t<%:Configuration category%>:\n\t\t<% for i, c in ipairs(self.categories) do %>\n\t\t\t<% if c.id == self.category then %>\n\t\t\t\t<strong><%=c.title%></strong>\n\t\t\t<% else %>\n\t\t\t\t<a href=\"<%=luci.dispatcher.build_url(\"admin\", \"vpn\", \"openvpn\", \"advanced\", self.instance, c.id)%>\"><%=c.title%></a>\n\t\t\t<% end %>\n\t\t\t<% if next(self.categories, i) then %>|<% end %>\n\t\t<% end %>\n\t<% end %>\n</div>\n"], "filenames": ["applications/luci-app-openvpn/luasrc/view/openvpn/pageswitch.htm"], "buggy_code_start_loc": [12], "buggy_code_end_loc": [13], "fixing_code_start_loc": [12], "fixing_code_end_loc": [13], "type": "CWE-79", "message": "LuCI openwrt-22.03 branch git-22.361.69894-438c598 was discovered to contain a reflected cross-site scripting (XSS) vulnerability via the component /openvpn/pageswitch.htm.", "other": {"cve": {"id": "CVE-2023-24181", "sourceIdentifier": "cve@mitre.org", "published": "2023-04-10T14:15:09.687", "lastModified": "2023-04-13T20:25:34.733", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "LuCI openwrt-22.03 branch git-22.361.69894-438c598 was discovered to contain a reflected cross-site scripting (XSS) vulnerability via the component /openvpn/pageswitch.htm."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:openwrt:luci:22.03.3:*:*:*:*:*:*:*", "matchCriteriaId": "E2AF8349-39DE-4DE4-9781-D6F9AED1D1F3"}]}]}], "references": [{"url": "https://github.com/ABB-EL/external-vulnerability-disclosures/security/advisories/GHSA-9gqg-pp5p-q9hg", "source": "cve@mitre.org", "tags": ["Exploit", "Third Party Advisory"]}, {"url": "https://github.com/openwrt/luci/commit/25983b9fa572a640a7ecd077378df2790266cd61", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/openwrt/luci/commit/749268a2cad4a08722e30f66a578e254885f450f", "source": "cve@mitre.org", "tags": ["Patch"]}]}, "github_commit_url": "https://github.com/openwrt/luci/commit/25983b9fa572a640a7ecd077378df2790266cd61"}}