{"buggy_code": ["=== TinyChat Room Spy ===\r\n\r\nContributors: ruddernation\r\nDonate link: https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=FFAC7FBEBH6JE\r\nTags: tinychat-roomspy, tinychat, chat, room spy, wordpress chat, buddypress chat, wordpress video chat, buddypress video chat\r\nRequires at least: 3.6.0\r\nTested up to: 4.1.1\r\nStable tag: 1.2.8\r\nLicense: GPLv3\r\nLicense URI: http://www.gnu.org/licenses/gpl-3.0.html\r\n\r\n== Description ==\r\nAllows you to check who is in a TinyChat room and who is on Video/Audio, This is very useful for checking who is in a room before you enter it,\r\nThis has minimal css code so it should display fine on all themes and devices.\r\n\r\n== Installation ==\r\n\r\nThis will automatically create the page and install the short code with link domain name/roomspy, If it does not then please read below.\r\n\r\nSimply use shortcode [room_spy_page] in a page and publish.\r\n\r\n== Screenshots ==\r\n\r\n* This is the search bar, Enter the name and click \"Spy\".\r\n* Once you clicked spy it will locate the room and pull the images and names of the users in the chat room, It'll tell you number of admin/chatters and on camera.\r\n\r\n== Notes ==\r\n\r\nThis is to view who is in a TinyChat room and who is on video/audio, If you need to find the room name then visit the room on http://tinychat.com/Roomname \r\nand copy the Roomname part and paste in to the search bar and it'll show you images of who's in the room.\r\n\r\n== Frequently Asked Questions ==\r\n\r\n* Q. Can I use this if I'm not logged in?\r\n* A. Yes!.\r\n\r\n* Q. How do I add it to my blog/website?\r\n* A. Just go to the backend and on appearance select menus, From there you can add your page, It'll be roomspy by default.\r\n\r\n== Changelog ==\r\n\r\n= 1.0.1 =\r\n* first start, This will auto create the page for you and insert the shortcode, Just type in the Tinychat room name in the search box and click *Spy*,\r\nIt'll grab the images and selected data for who is in the room, number of users and admin and how many are using video/audio.\r\n\r\n= 1.0.2 =\r\n* Update to the CSS code as wp-image was overwriting the main height of the image, If this creates a problem then you can remove \r\n.entry-content img,img[class=wp-image-]{height:190px;} from line 62.\r\n\r\n= 1.0.3 =\r\n* Fix for plugin error.\r\n\r\n= 1.0.6 =\r\n* Removed PHP errors from displaying on websites to protect web masters, To check for errors then please check your error logs for correct error.\r\n\r\n= 1.2.0 =\r\n* I've re-added the code that removes error reporting at the top of the page.\r\n\r\n= 1.2.7 =\r\n* I've done a major update, If you want to continue to use this then you'll need to update as all previous versions will not work.\r\n\r\n= 1.2.8 =\r\n* I've now optimised my PHP code and removed unnecessary code for increased speed and performance.\r\n\r\n== Social Sites ==\r\n\r\n* Website - https://www.ruddernation.com\r\n\r\n* Room Spy - https://www.tinychat-spy.com\r\n\r\n* Facebook - https://www.facebook.com/rndtc\r\n\r\n* Twitter - https://twitter.com/R_N_Designs\r\n\r\n* Github - https://github.com/ruddernation\r\n\r\n* WordPress - https://profiles.wordpress.org/ruddernation\r\n\r\n* Skype - ruddernation.designs", "<?php\r\n/*\r\n* Plugin Name: TinyChat Room Spy\r\n* Plugin URI: https://wordpress.org/plugins/tinychat-roomspy/\r\n* Author: Ruddernation Designs\r\n* Author URI: http://profiles.wordpress.org/ruddernation\r\n* Description: Allows you to check who is in a TinyChat room and who is on Video/Audio.\r\n* Requires at least: WordPress 3.6.0, BuddyPress 1.8.1\r\n* Tested up to: WordPress 4.1.1 / BuddyPress 2.2.2.1\r\n* Version: 1.2.8\r\n* License: GPLv3\r\n* License URI: http://www.gnu.org/licenses/gpl-3.0.html\r\n* Date: 14th April 2015\r\n*/\r\n// Turn off all error reporting\r\nerror_reporting(0);\r\ndefine('COMPARE_VERSION', '1.2.7');\r\nregister_activation_hook(__FILE__, 'room_spy_install');\r\nfunction room_spy_install() {\r\n\r\n\tglobal $wpdb, $wp_version;\r\n\t$post_date = date(\"Y-m-d H:i:s\");\r\n\t$post_date_gmt = gmdate(\"Y-m-d H:i:s\");\r\n\t$sql = \"SELECT * FROM \".$wpdb->posts.\" WHERE post_content LIKE '%[room_spy_page]%' AND `post_type` NOT IN('revision') LIMIT 1\";\r\n\t$page = $wpdb->get_row($sql, ARRAY_A);\r\n\tif($page == NULL) {\r\n\t\t$sql =\"INSERT INTO \".$wpdb->posts.\"(\r\n\r\n\t\t\tpost_author, post_date, post_date_gmt, post_content, post_content_filtered, post_title, post_excerpt,  post_status, comment_status, ping_status, post_password, post_name, to_ping, pinged, post_modified, post_modified_gmt, post_parent, menu_order, post_type)\r\n\r\n\t\t\tVALUES\r\n\r\n\t\t\t('1', '$post_date', '$post_date_gmt', '[room_spy_page]', '', 'roomspy', '', 'publish', 'closed', 'closed', '', 'roomspy', '', '', '$post_date', '$post_date_gmt', '0', '0', 'page')\";\r\n\r\n\t\t$wpdb->query($sql);\r\n\t\t$post_id = $wpdb->insert_id;\r\n\t\t$wpdb->query(\"UPDATE $wpdb->posts SET guid = '\" . get_permalink($post_id) . \"' WHERE ID = '$post_id'\");\r\n\t} else {\r\n\t\t$post_id = $page['ID'];\r\n\t}\r\n\tupdate_option('room_spy_url', get_permalink($post_id));\r\n}\r\nadd_filter('the_content', 'wp_show_room_spy_page', 52);\r\n\r\nfunction wp_show_room_spy_page($content = '') {\r\n\r\n\tif(preg_match(\"/\\[room_spy_page\\]/\",$content)) {\r\n\t\twp_show_room_spy();\r\n\r\n\t\treturn \"\";\r\n\t}\r\n\treturn $content;\r\n}\r\nfunction wp_show_room_spy() {\r\n\tif(!get_option('room_spy_enabled', 0)) {\r\n\t}\r\n\t?>\r\n    <style>#chat,.chatimages{margin:2px 6px 15px;width:220px;height:190px;-webkit-transition:all .3s ease;-moz-transition:all .3s ease;-o-transition:all .3s ease;-ms-transition:all .3s ease;transition:all .3s ease;display:inline-block;text-decoration:none;font-size:17px;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:4px}input[type=text]{width:25%;}.entry-content img,img[class*=wp-image-]{height:190px;}.password{color:red;text-decoration:none}</style>\r\n<?php\r\n\t$room = $_POST ['room']; \r\n\t$names = $_POST ['username'];\r\nif (($room === 'Room')){}\r\n\telseif(preg_match(\"/^[a-z0-9]{3,}/\", $_POST['room'])){\r\n\t$room = preg_replace('/[^a-z0-9]/s', '',$room);\r\n\t$data = file_get_contents('http://api.tinychat.com/'.$room.'.xml');\r\n\t$rooms = new SimpleXMLElement($data,libxml_use_internal_errors(true));\r\n\t$array = json_decode(json_encode((array)simplexml_load_string($xml)),1);}?>\r\n<div><?php echo ' \r\n<form method=\"post\">Room Name: <input type=\"text\" name=\"room\" title=\"Just enter the name of the tinychat room and press spy.\" placeholder=\"Lowercase Letters!\"/> <input type=\"submit\" value=\"Spy\" name=\"monachechat4\"/>&nbsp;&bull;&nbsp;Admins: '.$rooms['mod_count'].'&nbsp;&bull;&nbsp;Chatters: '.$rooms['total_count'].'&nbsp;&bull;&nbsp;On Cam: '.$rooms['broadcaster_count'].'<a class=\"password\" title=\"Password is required to enter the room\"/>'.$rooms['error'].'</a>';if($room!=='Room name'){echo '</form>';}?> </div><br><?php\r\nif((preg_match(\"/^[a-z0-9]{3,}/\",$_POST['room'])=='1')){$room=preg_replace('/[^a-z0-9]/s','',$room);$room=htmlspecialchars($room,ENT_QUOTES, 'UTF-8');if($room!=='Room name'){echo '<br><br>';{echo ' <br> '.$room.'<br>';$pic='http://upload.tinychat.com/pic/'.$room.'';$picture='<a href=\"https://www.ruddernation.net/'.urlencode($room).'\" title=\"'.$room.'\" target=\"_blank\"><img src=\"'.$pic.'\"class=\"chatimages\"><br></a>';echo $picture;}echo '<br><br>';foreach($rooms->names as $username){echo '<div id=\"chat\">'.$username.'<br>';$pic='http://upload.tinychat.com/i/'.$room.'-'.$username.'.jpg';$picture='<a href=\"https://www.ruddernation.net/'.$room.'\" title=\"Hey! I&#39;m '.$username.', Click to come and chat with me.\" target=\"_blank\"><img src=\"'.$pic.'\"class=\"chatimages\"></a><br></div>';echo $picture;}}}}?>"], "fixing_code": ["=== TinyChat Room Spy ===\r\n\r\nContributors: ruddernation\r\nDonate link: https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&hosted_button_id=FFAC7FBEBH6JE\r\nTags: tinychat-roomspy, tinychat, chat, room spy, wordpress chat, buddypress chat, wordpress video chat, buddypress video chat\r\nRequires at least: 3.6.0\r\nTested up to: 4.1.1\r\nStable tag: 1.2.9\r\nLicense: GPLv3\r\nLicense URI: http://www.gnu.org/licenses/gpl-3.0.html\r\n\r\n== Description ==\r\nAllows you to check who is in a TinyChat room and who is on Video/Audio, This is very useful for checking who is in a room before you enter it,\r\nThis has minimal css code so it should display fine on all themes and devices.\r\n\r\n== Installation ==\r\n\r\nThis will automatically create the page and install the short code with link domain name/roomspy, If it does not then please read below.\r\n\r\nSimply use shortcode [room_spy_page] in a page and publish.\r\n\r\n== Screenshots ==\r\n\r\n* This is the search bar, Enter the name and click \"Spy\".\r\n* Once you clicked spy it will locate the room and pull the images and names of the users in the chat room, It'll tell you number of admin/chatters and on camera.\r\n\r\n== Notes ==\r\n\r\nThis is to view who is in a TinyChat room and who is on video/audio, If you need to find the room name then visit the room on http://tinychat.com/Roomname \r\nand copy the Roomname part and paste in to the search bar and it'll show you images of who's in the room.\r\n\r\n== Frequently Asked Questions ==\r\n\r\n* Q. Can I use this if I'm not logged in?\r\n* A. Yes!.\r\n\r\n* Q. How do I add it to my blog/website?\r\n* A. Just go to the backend and on appearance select menus, From there you can add your page, It'll be roomspy by default.\r\n\r\n== Changelog ==\r\n\r\n= 1.0.1 =\r\n* first start, This will auto create the page for you and insert the shortcode, Just type in the Tinychat room name in the search box and click *Spy*,\r\nIt'll grab the images and selected data for who is in the room, number of users and admin and how many are using video/audio.\r\n\r\n= 1.0.2 =\r\n* Update to the CSS code as wp-image was overwriting the main height of the image, If this creates a problem then you can remove \r\n.entry-content img,img[class=wp-image-]{height:190px;} from line 62.\r\n\r\n= 1.0.3 =\r\n* Fix for plugin error.\r\n\r\n= 1.0.6 =\r\n* Removed PHP errors from displaying on websites to protect web masters, To check for errors then please check your error logs for correct error.\r\n\r\n= 1.2.0 =\r\n* I've re-added the code that removes error reporting at the top of the page.\r\n\r\n= 1.2.7 =\r\n* I've done a major update, If you want to continue to use this then you'll need to update as all previous versions will not work.\r\n\r\n= 1.2.8 =\r\n* I've now optimised my PHP code and removed unnecessary code for increased speed and performance.\r\n\r\n== Social Sites ==\r\n\r\n* Website - https://www.ruddernation.com\r\n\r\n* Room Spy - https://www.tinychat-spy.com\r\n\r\n* Facebook - https://www.facebook.com/rndtc\r\n\r\n* Twitter - https://twitter.com/R_N_Designs\r\n\r\n* Github - https://github.com/ruddernation\r\n\r\n* WordPress - https://profiles.wordpress.org/ruddernation\r\n\r\n* Skype - ruddernation.designs", "<?php\r\n/*\r\n* Plugin Name: TinyChat Room Spy\r\n* Plugin URI: https://wordpress.org/plugins/tinychat-roomspy/\r\n* Author: Ruddernation Designs\r\n* Author URI: http://profiles.wordpress.org/ruddernation\r\n* Description: Allows you to check who is in a TinyChat room and who is on Video/Audio.\r\n* Requires at least: WordPress 3.6.0, BuddyPress 1.8.1\r\n* Tested up to: WordPress 4.1.1 / BuddyPress 2.2.2.1\r\n* Version: 1.2.9\r\n* License: GPLv3\r\n* License URI: http://www.gnu.org/licenses/gpl-3.0.html\r\n* Date: 18th April 2015\r\n*/\r\n// Turn off all error reporting\r\nerror_reporting(0);\r\ndefine('COMPARE_VERSION', '1.2.8');\r\nregister_activation_hook(__FILE__, 'room_spy_install');\r\nfunction room_spy_install() {\r\n\r\n\tglobal $wpdb, $wp_version;\r\n\t$post_date = date(\"Y-m-d H:i:s\");\r\n\t$post_date_gmt = gmdate(\"Y-m-d H:i:s\");\r\n\t$sql = \"SELECT * FROM \".$wpdb->posts.\" WHERE post_content LIKE '%[room_spy_page]%' AND `post_type` NOT IN('revision') LIMIT 1\";\r\n\t$page = $wpdb->get_row($sql, ARRAY_A);\r\n\tif($page == NULL) {\r\n\t\t$sql =\"INSERT INTO \".$wpdb->posts.\"(\r\n\r\n\t\t\tpost_author, post_date, post_date_gmt, post_content, post_content_filtered, post_title, post_excerpt,  post_status, comment_status, ping_status, post_password, post_name, to_ping, pinged, post_modified, post_modified_gmt, post_parent, menu_order, post_type)\r\n\r\n\t\t\tVALUES\r\n\r\n\t\t\t('1', '$post_date', '$post_date_gmt', '[room_spy_page]', '', 'roomspy', '', 'publish', 'closed', 'closed', '', 'roomspy', '', '', '$post_date', '$post_date_gmt', '0', '0', 'page')\";\r\n\r\n\t\t$wpdb->query($sql);\r\n\t\t$post_id = $wpdb->insert_id;\r\n\t\t$wpdb->query(\"UPDATE $wpdb->posts SET guid = '\" . get_permalink($post_id) . \"' WHERE ID = '$post_id'\");\r\n\t} else {\r\n\t\t$post_id = $page['ID'];\r\n\t}\r\n\tupdate_option('room_spy_url', get_permalink($post_id));\r\n}\r\nadd_filter('the_content', 'wp_show_room_spy_page', 52);\r\n\r\nfunction wp_show_room_spy_page($content = '') {\r\n\r\n\tif(preg_match(\"/\\[room_spy_page\\]/\",$content)) {\r\n\t\twp_show_room_spy();\r\n\r\n\t\treturn \"\";\r\n\t}\r\n\treturn $content;\r\n}\r\nfunction wp_show_room_spy() {\r\n\tif(!get_option('room_spy_enabled', 0)) {\r\n\t}\r\n\t?>\r\n    <style>#chat,.chatimages{margin:2px 6px 15px;width:220px;height:190px;-webkit-transition:all .3s ease;-moz-transition:all .3s ease;-o-transition:all .3s ease;-ms-transition:all .3s ease;transition:all .3s ease;display:inline-block;text-decoration:none;font-size:17px;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:4px}input[type=text]{width:25%;}.entry-content img,img[class*=wp-image-]{height:190px;}.password{color:red;text-decoration:none}</style>\r\n<?php\r\n\t$room = $_POST ['room']; \r\n\t$names = $_POST ['username'];\r\nif (($room === 'Room')){}\r\n\telseif(preg_match(\"/^[a-z0-9]{3,}/\", $_POST['room'])){\r\n\t$room = preg_replace('/[^a-z0-9]/s', '',$room);\r\n\t$room=(strlen($room) > 32) ? substr($room,0,32).'' : $room;\r\n\t$room=htmlspecialchars($room,ENT_QUOTES, 'UTF-8');\r\n\t$data = file_get_contents('http://api.tinychat.com/'.$room.'.xml');\r\n\t$rooms = new SimpleXMLElement($data,libxml_use_internal_errors(true));\r\n\t$array = json_decode(json_encode((array)simplexml_load_string($xml)),1);}?>\r\n<div><?php echo ' \r\n<form method=\"post\">Room Name: <input type=\"text\" name=\"room\" title=\"Just enter the name of the tinychat room and press spy.\" placeholder=\"Lowercase Letters!\"/> <input type=\"submit\" value=\"Spy\" name=\"monachechat4\"/>&nbsp;&bull;&nbsp;Admins: '.$rooms['mod_count'].'&nbsp;&bull;&nbsp;Chatters: '.$rooms['total_count'].'&nbsp;&bull;&nbsp;On Cam: '.$rooms['broadcaster_count'].'<a class=\"password\" title=\"Password is required to enter the room\"/>'.$rooms['error'].'</a>';if($room!=='Room name'){echo '</form>';}?> </div><br><?php\r\nif((preg_match(\"/^[a-z0-9]{3,}/\",$_POST['room'])=='1')){$room=preg_replace('/[^a-z0-9]/s','',$room);$room=htmlspecialchars($room,ENT_QUOTES, 'UTF-8');if($room!=='Room name'){echo '<br><br>';{echo ' <br> '.$room.'<br>';$pic='http://upload.tinychat.com/pic/'.$room.'';$picture='<a href=\"https://www.ruddernation.net/'.urlencode($room).'\" title=\"'.$room.'\" target=\"_blank\"><img src=\"'.$pic.'\"class=\"chatimages\"><br></a>';echo $picture;}echo '<br><br>';foreach($rooms->names as $username){echo '<div id=\"chat\">'.$username.'<br>';$pic='http://upload.tinychat.com/i/'.$room.'-'.$username.'.jpg';$picture='<a href=\"https://www.ruddernation.net/'.$room.'\" title=\"Hey! I&#39;m '.$username.', Click to come and chat with me.\" target=\"_blank\"><img src=\"'.$pic.'\"class=\"chatimages\"></a><br></div>';echo $picture;}}}}?>"], "filenames": ["readme.txt", "room-spy.php"], "buggy_code_start_loc": [8, 10], "buggy_code_end_loc": [9, 64], "fixing_code_start_loc": [8, 10], "fixing_code_end_loc": [9, 67], "type": "CWE-79", "message": "A vulnerability classified as problematic was found in ruddernation TinyChat Room Spy Plugin up to 1.2.8 on WordPress. This vulnerability affects the function wp_show_room_spy of the file room-spy.php. The manipulation of the argument room leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 1.2.9 is able to address this issue. The name of the patch is ab72627a963d61fb3bc31018e3855b08dc94a979. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-230392.", "other": {"cve": {"id": "CVE-2015-10110", "sourceIdentifier": "cna@vuldb.com", "published": "2023-06-02T00:15:09.303", "lastModified": "2023-06-09T13:54:30.817", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability classified as problematic was found in ruddernation TinyChat Room Spy Plugin up to 1.2.8 on WordPress. This vulnerability affects the function wp_show_room_spy of the file room-spy.php. The manipulation of the argument room leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 1.2.9 is able to address this issue. The name of the patch is ab72627a963d61fb3bc31018e3855b08dc94a979. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-230392."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:tinychat:room_spy:*:*:*:*:*:wordpress:*:*", "versionEndExcluding": "1.2.9", "matchCriteriaId": "605127F5-D308-46FF-8A9B-F8663E1BBE88"}]}]}], "references": [{"url": "https://github.com/wp-plugins/tinychat-roomspy/commit/ab72627a963d61fb3bc31018e3855b08dc94a979", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.230392", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.230392", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/wp-plugins/tinychat-roomspy/commit/ab72627a963d61fb3bc31018e3855b08dc94a979"}}