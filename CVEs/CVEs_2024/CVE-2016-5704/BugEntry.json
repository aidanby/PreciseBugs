{"buggy_code": ["<div id=\"tablestatistics\">\n    <?php $odd_row = false; ?>\n    <fieldset>\n        <legend><?= __('Information'); ?></legend>\n        <p> <strong> <?= __('Table comments: ') ?> </strong>\n            <?= isset($showtable['TABLE_COMMENT']) ? $showtable['TABLE_COMMENT'] : '';?>\n        </p>\n        <a id=\"showusage\"></a>\n\n        <?php if (! $tbl_is_view && ! $db_is_system_schema): ?>\n            <table id=\"tablespaceusage\" class=\"data\">\n                <caption class=\"tblHeaders\"><?= __('Space usage'); ?></caption>\n                <tbody>\n                    <tr class=\"<?= (($odd_row = !$odd_row) ? 'odd' : 'even'); ?>\">\n                        <th class=\"name\"><?= __('Data'); ?></th>\n                        <td class=\"value\"><?= $data_size; ?></td>\n                        <td class=\"unit\"><?= $data_unit; ?></td>\n                    </tr>\n\n                <?php if (isset($index_size)): ?>\n                    <tr class=\"<?= (($odd_row = !$odd_row) ? 'odd' : 'even'); ?>\">\n                        <th class=\"name\"><?= __('Index'); ?></th>\n                        <td class=\"value\"><?= $index_size; ?></td>\n                        <td class=\"unit\"><?= $index_unit; ?></td>\n                    </tr>\n                <?php endif; ?>\n\n                <?php if (isset($free_size)): ?>\n                    <tr class=\"<?= (($odd_row = !$odd_row) ? 'odd' : 'even'); ?>\">\n                        <th class=\"name\"><?= __('Overhead'); ?></th>\n                        <td class=\"value\"><?= $free_size; ?></td>\n                        <td class=\"unit\"><?= $free_unit; ?></td>\n                    </tr>\n                    <tr class=\"<?= (($odd_row = !$odd_row) ? 'odd' : 'even'); ?>\">\n                        <th class=\"name\"><?= __('Effective'); ?></th>\n                        <td class=\"value\"><?= $effect_size; ?></td>\n                        <td class=\"unit\"><?= $effect_unit; ?></td>\n                    </tr>\n                <?php endif; ?>\n\n                <?php if (isset($tot_size) && $mergetable == false): ?>\n                    <tr class=\"<?= (($odd_row = !$odd_row) ? 'odd' : 'even'); ?>\">\n                        <th class=\"name\"><?= __('Total'); ?></th>\n                        <td class=\"value\"><?= $tot_size; ?></td>\n                        <td class=\"unit\"><?= $tot_unit; ?></td>\n                    </tr>\n                <?php endif; ?>\n\n                <!-- Optimize link if overhead -->\n                <?php if (isset($free_size)\n                            && ($tbl_storage_engine == 'MYISAM'\n                            || $tbl_storage_engine == 'ARIA'\n                            || $tbl_storage_engine == 'MARIA'\n                            || $tbl_storage_engine == 'BDB')): ?>\n                    <tr class=\"tblFooters\">\n                        <td colspan=\"3\" class=\"center\">\n                            <a href=\"sql.php<?= $url_query; ?>&pos=0&amp;sql_query=<?= urlencode(\n                                    'OPTIMIZE TABLE ' . PMA\\libraries\\Util::backquote($GLOBALS['table'])); ?>\">\n                                <?= PMA\\libraries\\Util::getIcon('b_tbloptimize.png', __('Optimize table')); ?>\n                            </a>\n                        </td>\n                    </tr>\n                <?php endif; ?>\n                </tbody>\n            </table>\n        <?php endif; ?>\n        <?= PMA\\libraries\\Template::get('table/structure/row_stats_table')->render(\n              array(\n                  'showtable' => $showtable,\n                  'tbl_collation' => $tbl_collation,\n                  'is_innodb' => $is_innodb,\n                  'mergetable' => $mergetable,\n                  'avg_size' => (isset ($avg_size) ? $avg_size : ''),\n                  'avg_unit' => (isset ($avg_unit) ? $avg_unit : '')\n              )\n            )\n        ?>\n    </fieldset>\n</div>\n"], "fixing_code": ["<div id=\"tablestatistics\">\n    <?php $odd_row = false; ?>\n    <fieldset>\n        <legend><?= __('Information'); ?></legend>\n        <p> <strong> <?= __('Table comments: ') ?> </strong>\n            <?= isset($showtable['TABLE_COMMENT']) ? htmlspecialchars($showtable['TABLE_COMMENT']) : '';?>\n        </p>\n        <a id=\"showusage\"></a>\n\n        <?php if (! $tbl_is_view && ! $db_is_system_schema): ?>\n            <table id=\"tablespaceusage\" class=\"data\">\n                <caption class=\"tblHeaders\"><?= __('Space usage'); ?></caption>\n                <tbody>\n                    <tr class=\"<?= (($odd_row = !$odd_row) ? 'odd' : 'even'); ?>\">\n                        <th class=\"name\"><?= __('Data'); ?></th>\n                        <td class=\"value\"><?= $data_size; ?></td>\n                        <td class=\"unit\"><?= $data_unit; ?></td>\n                    </tr>\n\n                <?php if (isset($index_size)): ?>\n                    <tr class=\"<?= (($odd_row = !$odd_row) ? 'odd' : 'even'); ?>\">\n                        <th class=\"name\"><?= __('Index'); ?></th>\n                        <td class=\"value\"><?= $index_size; ?></td>\n                        <td class=\"unit\"><?= $index_unit; ?></td>\n                    </tr>\n                <?php endif; ?>\n\n                <?php if (isset($free_size)): ?>\n                    <tr class=\"<?= (($odd_row = !$odd_row) ? 'odd' : 'even'); ?>\">\n                        <th class=\"name\"><?= __('Overhead'); ?></th>\n                        <td class=\"value\"><?= $free_size; ?></td>\n                        <td class=\"unit\"><?= $free_unit; ?></td>\n                    </tr>\n                    <tr class=\"<?= (($odd_row = !$odd_row) ? 'odd' : 'even'); ?>\">\n                        <th class=\"name\"><?= __('Effective'); ?></th>\n                        <td class=\"value\"><?= $effect_size; ?></td>\n                        <td class=\"unit\"><?= $effect_unit; ?></td>\n                    </tr>\n                <?php endif; ?>\n\n                <?php if (isset($tot_size) && $mergetable == false): ?>\n                    <tr class=\"<?= (($odd_row = !$odd_row) ? 'odd' : 'even'); ?>\">\n                        <th class=\"name\"><?= __('Total'); ?></th>\n                        <td class=\"value\"><?= $tot_size; ?></td>\n                        <td class=\"unit\"><?= $tot_unit; ?></td>\n                    </tr>\n                <?php endif; ?>\n\n                <!-- Optimize link if overhead -->\n                <?php if (isset($free_size)\n                            && ($tbl_storage_engine == 'MYISAM'\n                            || $tbl_storage_engine == 'ARIA'\n                            || $tbl_storage_engine == 'MARIA'\n                            || $tbl_storage_engine == 'BDB')): ?>\n                    <tr class=\"tblFooters\">\n                        <td colspan=\"3\" class=\"center\">\n                            <a href=\"sql.php<?= $url_query; ?>&pos=0&amp;sql_query=<?= urlencode(\n                                    'OPTIMIZE TABLE ' . PMA\\libraries\\Util::backquote($GLOBALS['table'])); ?>\">\n                                <?= PMA\\libraries\\Util::getIcon('b_tbloptimize.png', __('Optimize table')); ?>\n                            </a>\n                        </td>\n                    </tr>\n                <?php endif; ?>\n                </tbody>\n            </table>\n        <?php endif; ?>\n        <?= PMA\\libraries\\Template::get('table/structure/row_stats_table')->render(\n              array(\n                  'showtable' => $showtable,\n                  'tbl_collation' => $tbl_collation,\n                  'is_innodb' => $is_innodb,\n                  'mergetable' => $mergetable,\n                  'avg_size' => (isset ($avg_size) ? $avg_size : ''),\n                  'avg_unit' => (isset ($avg_unit) ? $avg_unit : '')\n              )\n            )\n        ?>\n    </fieldset>\n</div>\n"], "filenames": ["templates/table/structure/display_table_stats.phtml"], "buggy_code_start_loc": [6], "buggy_code_end_loc": [7], "fixing_code_start_loc": [6], "fixing_code_end_loc": [7], "type": "CWE-79", "message": "Cross-site scripting (XSS) vulnerability in the table-structure page in phpMyAdmin 4.6.x before 4.6.3 allows remote attackers to inject arbitrary web script or HTML via vectors involving a comment.", "other": {"cve": {"id": "CVE-2016-5704", "sourceIdentifier": "cve@mitre.org", "published": "2016-07-03T01:59:15.970", "lastModified": "2017-07-01T01:29:58.423", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "Cross-site scripting (XSS) vulnerability in the table-structure page in phpMyAdmin 4.6.x before 4.6.3 allows remote attackers to inject arbitrary web script or HTML via vectors involving a comment."}, {"lang": "es", "value": "Vulnerabilidad de XSS en la p\u00e1gina table-structure en phpMyAdmin 4.6.x en versiones anteriores a 4.6.3 permite a atacantes remotos inyectar secuencias de comandos web y HTML arbitrarios a trav\u00e9s de vectores relacionados con comentarios."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.6.0:*:*:*:*:*:*:*", "matchCriteriaId": "C641F362-D37D-47CB-BE6C-36E5F116F844"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.6.0:alpha1:*:*:*:*:*:*", "matchCriteriaId": "A0EA8819-70F8-48DC-8667-6CF25E7D9C53"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.6.0:rc1:*:*:*:*:*:*", "matchCriteriaId": "DD2796DA-3E74-4765-90D1-783849C7A44C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.6.0:rc2:*:*:*:*:*:*", "matchCriteriaId": "4024DA77-BFE4-48C6-A2AF-46003071BDE8"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.6.1:*:*:*:*:*:*:*", "matchCriteriaId": "85631B69-7060-42D1-AE24-466BA10EB390"}, {"vulnerable": true, "criteria": "cpe:2.3:a:phpmyadmin:phpmyadmin:4.6.2:*:*:*:*:*:*:*", "matchCriteriaId": "E62EDC79-47AA-4CED-AB7F-1E4D158EB653"}]}]}], "references": [{"url": "https://github.com/phpmyadmin/phpmyadmin/commit/72213573182896bd6a6e5af5ba1881dd87c4a20b", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://security.gentoo.org/glsa/201701-32", "source": "cve@mitre.org"}, {"url": "https://www.phpmyadmin.net/security/PMASA-2016-20/", "source": "cve@mitre.org", "tags": ["Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/phpmyadmin/phpmyadmin/commit/72213573182896bd6a6e5af5ba1881dd87c4a20b"}}