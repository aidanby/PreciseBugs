{"buggy_code": ["// \u8bdd\u9898\uff08\u5e16\u5b50\uff09\u76f8\u5173js\u529f\u80fd\n(function(){\n\temojify.setConfig({\n\t\t// emojify_tag_type : 'span',\n\t\tonly_crawl_id    : null,\n\t\timg_dir          : SG.EMOJI_DOMAIN,\n\t\tignored_tags     : { //\u5ffd\u7565\u4ee5\u4e0b\u51e0\u79cd\u6807\u7b7e\u5185\u7684emoji\u8bc6\u522b\n\t\t\t'SCRIPT'  : 1,\n\t\t\t'TEXTAREA': 1,\n\t\t\t'A'       : 1,\n\t\t\t'PRE'     : 1,\n\t\t\t'CODE'    : 1\n\t\t}\n\t});\n\t\n\tSG.Topics = function(){}\n\tSG.Topics.prototype = new SG.Publisher();\n\tSG.Topics.prototype.parseContent = function(selector) {\n\t\t// \u914d\u7f6e marked \u8bed\u6cd5\u9ad8\u4eae\n\t\tmarked = SG.markSettingNoHightlight();\n\n\t\tselector.each(function() {\n\t\t\tvar markdownString = $(this).text();\n\n\t\t\tvar contentHtml = marked(markdownString);\n\t\t\tcontentHtml = SG.replaceCodeChar(contentHtml);\n\t\t\t\n\t\t\t$(this).html(contentHtml);\n\n\t\t\t// emoji \u8868\u60c5\u89e3\u6790\n\t\t\temojify.run(this);\n\t\t});\n\t}\n\n\tjQuery(document).ready(function($) {\n\t\t// \u53d1\u5e03\u4e3b\u9898\n\t\t$('#submit').on('click', function(evt){\n\t\t\tevt.preventDefault();\n\t\t\tvar validator = $('.validate-form').validate();\n\t\t\tif (!validator.form()) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif ($('.usernames').length != 0) {\n\t\t\t\tvar usernames = SG.analyzeAt($('#content').val());\n\t\t\t\t$('.usernames').val(usernames);\n\t\t\t}\n\n\t\t\tvar topics = new SG.Topics();\n\t\t\ttopics.publish(this, function(data) {\n\t\t\t\tpurgeComposeDraft(uid, 'topic');\n\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tif (data.tid) {\n\t\t\t\t\t\twindow.location.href = '/topics/'+data.tid;\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.location.href = '/topics';\n\t\t\t\t\t}\n\t\t\t\t}, 1000);\n\t\t\t});\n\t\t});\n\n\t\t$(document).keypress(function(evt){\n\t\t\tif (evt.ctrlKey && (evt.which == 10 || evt.which == 13)) {\n\t\t\t\t$('#submit').click();\n\t\t\t}\n\t\t});\n\n\t\tSG.registerAtEvent();\n\t});\n}).call(this);\n"], "fixing_code": ["// \u8bdd\u9898\uff08\u5e16\u5b50\uff09\u76f8\u5173js\u529f\u80fd\n(function(){\n\temojify.setConfig({\n\t\t// emojify_tag_type : 'span',\n\t\tonly_crawl_id    : null,\n\t\timg_dir          : SG.EMOJI_DOMAIN,\n\t\tignored_tags     : { //\u5ffd\u7565\u4ee5\u4e0b\u51e0\u79cd\u6807\u7b7e\u5185\u7684emoji\u8bc6\u522b\n\t\t\t'SCRIPT'  : 1,\n\t\t\t'TEXTAREA': 1,\n\t\t\t'A'       : 1,\n\t\t\t'PRE'     : 1,\n\t\t\t'CODE'    : 1\n\t\t}\n\t});\n\t\n\tSG.Topics = function(){}\n\tSG.Topics.prototype = new SG.Publisher();\n\tSG.Topics.prototype.parseContent = function(selector) {\n\t\t// \u914d\u7f6e marked \u8bed\u6cd5\u9ad8\u4eae\n\t\tmarked = SG.markSettingNoHightlight();\n\n\t\tselector.each(function() {\n\t\t\tvar markdownString = $(this).text();\n\n\t\t\tvar contentHtml = marked(markdownString);\n\n\t\t\t// JS \u5904\u7406\uff0c\u907f\u514d XSS\u3002\u6700\u7ec8\u8fd8\u662f\u6539\u4e3a\u670d\u52a1\u7aef\u6e32\u67d3\u66f4\u597d\n\t\t\tif (contentHtml.indexOf('<script') != -1) {\n\t\t\t\tcontentHtml = contentHtml.replace(/<script/g, '&lt;script');\n\t\t\t}\n\t\t\tif (contentHtml.indexOf('<form') != -1) {\n\t\t\t\tcontentHtml = contentHtml.replace(/<form/g, '&lt;form');\n\t\t\t}\n\t\t\tif (contentHtml.indexOf('<input') != -1) {\n\t\t\t\tcontentHtml = contentHtml.replace(/<input/g, '&lt;input');\n\t\t\t}\n\t\t\tif (contentHtml.indexOf('<select') != -1) {\n\t\t\t\tcontentHtml = contentHtml.replace(/<select/g, '&lt;select');\n\t\t\t}\n\t\t\tif (contentHtml.indexOf('<textarea') != -1) {\n\t\t\t\tcontentHtml = contentHtml.replace(/<textarea/g, '&lt;textarea');\n\t\t\t}\n\n\t\t\tcontentHtml = SG.replaceCodeChar(contentHtml);\n\t\t\t\n\t\t\t$(this).html(contentHtml);\n\n\t\t\t// emoji \u8868\u60c5\u89e3\u6790\n\t\t\temojify.run(this);\n\t\t});\n\t}\n\n\tjQuery(document).ready(function($) {\n\t\t// \u53d1\u5e03\u4e3b\u9898\n\t\t$('#submit').on('click', function(evt){\n\t\t\tevt.preventDefault();\n\t\t\tvar validator = $('.validate-form').validate();\n\t\t\tif (!validator.form()) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif ($('.usernames').length != 0) {\n\t\t\t\tvar usernames = SG.analyzeAt($('#content').val());\n\t\t\t\t$('.usernames').val(usernames);\n\t\t\t}\n\n\t\t\tvar topics = new SG.Topics();\n\t\t\ttopics.publish(this, function(data) {\n\t\t\t\tpurgeComposeDraft(uid, 'topic');\n\n\t\t\t\tsetTimeout(function(){\n\t\t\t\t\tif (data.tid) {\n\t\t\t\t\t\twindow.location.href = '/topics/'+data.tid;\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.location.href = '/topics';\n\t\t\t\t\t}\n\t\t\t\t}, 1000);\n\t\t\t});\n\t\t});\n\n\t\t$(document).keypress(function(evt){\n\t\t\tif (evt.ctrlKey && (evt.which == 10 || evt.which == 13)) {\n\t\t\t\t$('#submit').click();\n\t\t\t}\n\t\t});\n\n\t\tSG.registerAtEvent();\n\t});\n}).call(this);\n"], "filenames": ["static/js/topics.js"], "buggy_code_start_loc": [25], "buggy_code_end_loc": [25], "fixing_code_start_loc": [26], "fixing_code_end_loc": [44], "type": "CWE-79", "message": "A vulnerability classified as problematic has been found in studygolang. This affects an unknown part of the file static/js/topics.js. The manipulation of the argument contentHtml leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is 0fb30f9640bd5fa0cae58922eac6c00bb1a94391. It is recommended to apply a patch to fix this issue. The identifier VDB-216477 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2021-4272", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-21T19:15:13.957", "lastModified": "2022-12-29T18:23:14.720", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability classified as problematic has been found in studygolang. This affects an unknown part of the file static/js/topics.js. The manipulation of the argument contentHtml leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is 0fb30f9640bd5fa0cae58922eac6c00bb1a94391. It is recommended to apply a patch to fix this issue. The identifier VDB-216477 was assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-707"}, {"lang": "en", "value": "CWE-74"}, {"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:studygolang:studygolang:-:*:*:*:*:*:*:*", "matchCriteriaId": "FAF8AF37-176A-4125-B263-D273A17DC3ED"}]}]}], "references": [{"url": "https://github.com/studygolang/studygolang/commit/0fb30f9640bd5fa0cae58922eac6c00bb1a94391", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.216477", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/studygolang/studygolang/commit/0fb30f9640bd5fa0cae58922eac6c00bb1a94391"}}