{"buggy_code": ["<?php\n\nob_start();\n$TAB = 'DB';\n\n// Main include\ninclude($_SERVER['DOCUMENT_ROOT'].'/inc/main.php');\n\n// Check database id\nif (empty($_GET['database'])) {\n    header(\"Location: /list/db/\");\n    exit;\n}\n\n// Edit as someone else?\nif (($_SESSION['userContext'] === 'admin') && (!empty($_GET['user']))) {\n    $user=escapeshellarg($_GET['user']);\n}\n\n// List datbase\n$v_database = $_GET['database'];\nexec(HESTIA_CMD.\"v-list-database \".$user.\" \".escapeshellarg($v_database).\" 'json'\", $output, $return_var);\ncheck_return_code_redirect($return_var, $output, '/list/db/');\n$data = json_decode(implode('', $output), true);\nunset($output);\n\n// Parse database\n$v_username = $user;\n$v_dbuser =  preg_replace(\"/^\".$user_plain.\"_/\", \"\", $data[$v_database]['DBUSER']);\n$v_password = \"\";\n$v_host = $data[$v_database]['HOST'];\n$v_type = $data[$v_database]['TYPE'];\n$v_charset = $data[$v_database]['CHARSET'];\n$v_date = $data[$v_database]['DATE'];\n$v_time = $data[$v_database]['TIME'];\n$v_suspended = $data[$v_database]['SUSPENDED'];\nif ($v_suspended == 'yes') {\n    $v_status =  'suspended';\n} else {\n    $v_status =  'active';\n}\n\n// Check POST request\nif (!empty($_POST['save'])) {\n    $v_username = $user;\n\n    // Check token\n    verify_csrf($_POST);\n\n    // Change database user\n    if (($v_dbuser != $_POST['v_dbuser']) && (empty($_SESSION['error_msg']))) {\n        $v_dbuser = escapeshellarg($v_dbuser);\n        exec(HESTIA_CMD.\"v-change-database-user \".$user.\" \".escapeshellarg($v_database).\" \".$v_dbuser, $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_dbuser = $_POST['v_dbuser'];\n    }\n\n    // Change database password\n    if ((!empty($_POST['v_password'])) && (empty($_SESSION['error_msg']))) {\n        if (!validate_password($_POST['v_password'])) {\n            $_SESSION['error_msg'] = _('Password does not match the minimum requirements');\n        } else {\n            $v_password = tempnam(\"/tmp\", \"vst\");\n            $fp = fopen($v_password, \"w\");\n            fwrite($fp, $_POST['v_password'].\"\\n\");\n            fclose($fp);\n            exec(HESTIA_CMD.\"v-change-database-password \".$user.\" \".escapeshellarg($v_database).\" \".$v_password, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            unlink($v_password);\n            $v_password = escapeshellarg($_POST['v_password']);\n        }\n    }\n\n    // Set success message\n    if (empty($_SESSION['error_msg'])) {\n        $_SESSION['ok_msg'] = _('Changes has been saved.');\n    }\n}\n\n// Render page\nrender_page($user, $TAB, 'edit_db');\n\n// Flush session messages\nunset($_SESSION['error_msg']);\nunset($_SESSION['ok_msg']);\n", "<?php\n\nob_start();\n$TAB = 'DNS';\n\n// Main include\ninclude($_SERVER['DOCUMENT_ROOT'].\"/inc/main.php\");\n\n// Check domain name\nif (empty($_GET['domain'])) {\n    header(\"Location: /list/dns/\");\n    exit;\n}\n\n// Edit as someone else?\nif (($_SESSION['userContext'] === 'admin') && (!empty($_GET['user']))) {\n    $user=escapeshellarg($_GET['user']);\n}\n\n// List ip addresses\nexec(HESTIA_CMD.\"v-list-user-ips \".$user.\" json\", $output, $return_var);\n$v_ips = json_decode(implode('', $output), true);\nunset($output);\n\n// List dns domain\nif ((!empty($_GET['domain'])) && (empty($_GET['record_id']))) {\n    $v_domain = escapeshellarg($_GET['domain']);\n    exec(HESTIA_CMD.\"v-list-dns-domain \".$user.\" \".$v_domain.\" json\", $output, $return_var);\n    check_return_code_redirect($return_var, $output,'/list/dns/');\n    $data = json_decode(implode('', $output), true);\n    unset($output);\n\n    // Parse dns domain\n    $v_username = $user;\n    $v_domain = $_GET['domain'];\n    $v_ip = $data[$v_domain]['IP'];\n    $v_template = $data[$v_domain]['TPL'];\n    $v_ttl = $data[$v_domain]['TTL'];\n    $v_exp = $data[$v_domain]['EXP'];\n    $v_soa = $data[$v_domain]['SOA'];\n    $v_date = $data[$v_domain]['DATE'];\n    $v_time = $data[$v_domain]['TIME'];\n    $v_suspended = $data[$v_domain]['SUSPENDED'];\n    if ($v_suspended == 'yes') {\n        $v_status =  'suspended';\n    } else {\n        $v_status =  'active';\n    }\n\n    // List dns templates\n    exec(HESTIA_CMD.\"v-list-dns-templates json\", $output, $return_var);\n    $templates = json_decode(implode('', $output), true);\n    unset($output);\n}\n\n// List dns record\nif ((!empty($_GET['domain'])) && (!empty($_GET['record_id']))) {\n    $v_domain = escapeshellarg($_GET['domain']);\n    $v_record_id = escapeshellarg($_GET['record_id']);\n    exec(HESTIA_CMD.\"v-list-dns-records \".$user.\" \".$v_domain.\" 'json'\", $output, $return_var);\n    check_return_code_redirect($return_var, $output,'/list/dns/');\n    $data = json_decode(implode('', $output), true);\n    unset($output);\n    // Parse dns record\n    $v_username = $user;\n    $v_domain = $_GET['domain'];\n    $v_record_id = $_GET['record_id'];\n    $v_rec = $data[$v_record_id]['RECORD'];\n    $v_type = $data[$v_record_id]['TYPE'];\n    $v_val = $data[$v_record_id]['VALUE'];\n    $v_priority = $data[$v_record_id]['PRIORITY'];\n    $v_suspended = $data[$v_record_id]['SUSPENDED'];\n    if ($v_suspended == 'yes') {\n        $v_status =  'suspended';\n    } else {\n        $v_status =  'active';\n    }\n    $v_date = $data[$v_record_id]['DATE'];\n    $v_time = $data[$v_record_id]['TIME'];\n    $v_ttl = $data[$v_record_id]['TTL'];\n}\n\n// Check POST request for dns domain\nif ((!empty($_POST['save'])) && (!empty($_GET['domain'])) && (empty($_GET['record_id']))) {\n    $v_domain = escapeshellarg($_POST['v_domain']);\n\n    // Check token\n    verify_csrf($_POST);\n\n    // Change domain IP\n    if (($v_ip != $_POST['v_ip']) && (empty($_SESSION['error_msg']))) {\n        $v_ip = escapeshellarg($_POST['v_ip']);\n        exec(HESTIA_CMD.\"v-change-dns-domain-ip \".$user.\" \".$v_domain.\" \".$v_ip.\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        $restart_dns = 'yes';\n        unset($output);\n    }\n\n    // Change domain template\n    if (($v_template != $_POST['v_template']) && (empty($_SESSION['error_msg']))) {\n        $v_template = escapeshellarg($_POST['v_template']);\n        exec(HESTIA_CMD.\"v-change-dns-domain-tpl \".$user.\" \".$v_domain.\" \".$v_template.\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $restart_dns = 'yes';\n    }\n\n    // Change SOA record\n    if (($v_soa != $_POST['v_soa']) && (empty($_SESSION['error_msg']))) {\n        $v_soa = escapeshellarg($_POST['v_soa']);\n        exec(HESTIA_CMD.\"v-change-dns-domain-soa \".$user.\" \".$v_domain.\" \".$v_soa.\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $restart_dns = 'yes';\n    }\n\n    // Change expiriation date\n    if (($v_exp != $_POST['v_exp']) && (empty($_SESSION['error_msg']))) {\n        $v_exp = escapeshellarg($_POST['v_exp']);\n        exec(HESTIA_CMD.\"v-change-dns-domain-exp \".$user.\" \".$v_domain.\" \".$v_exp.\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Change domain ttl\n    if (($v_ttl != $_POST['v_ttl']) && (empty($_SESSION['error_msg']))) {\n        $v_ttl = escapeshellarg($_POST['v_ttl']);\n        exec(HESTIA_CMD.\"v-change-dns-domain-ttl \".$user.\" \".$v_domain.\" \".$v_ttl.\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $restart_dns = 'yes';\n    }\n\n    // Restart dns server\n    if (!empty($restart_dns) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-restart-dns\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Set success message\n    if (empty($_SESSION['error_msg'])) {\n        $_SESSION['ok_msg'] = _('Changes has been saved.');\n    }\n}\n\n// Check POST request for dns record\nif ((!empty($_POST['save'])) && (!empty($_GET['domain'])) && (!empty($_GET['record_id']))) {\n\n    // Check token\n    verify_csrf($_POST);\n\n    // Protect input\n    $v_domain = escapeshellarg($_POST['v_domain']);\n    $v_record_id = escapeshellarg($_POST['v_record_id']);\n\n    // Change dns record\n    if (($v_rec != $_POST['v_rec']) || ($v_type != $_POST['v_type']) || ($v_val != $_POST['v_val']) || ($v_priority != $_POST['v_priority']) || ($v_ttl != $_POST['v_ttl']) && (empty($_SESSION['error_msg']))) {\n        $v_rec = escapeshellarg($_POST['v_rec']);\n        $v_type = escapeshellarg($_POST['v_type']);\n        $v_val = escapeshellarg($_POST['v_val']);\n        $v_priority = escapeshellarg($_POST['v_priority']);\n        $v_ttl = escapeshellarg($_POST['v_ttl']);\n        exec(HESTIA_CMD.\"v-change-dns-record \".$user.\" \".$v_domain.\" \".$v_record_id.\" \".$v_rec.\" \".$v_type.\" \".$v_val.\" \".$v_priority.\" false \".$v_ttl, $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_rec = $_POST['v_rec'];\n        $v_type = $_POST['v_type'];\n        $v_val = $_POST['v_val'];\n        unset($output);\n        $restart_dns = 'yes';\n    }\n\n\n    // Change dns record id\n    if (($_GET['record_id'] != $_POST['v_record_id']) && (empty($_SESSION['error_msg']))) {\n        $v_old_record_id = escapeshellarg($_GET['record_id']);\n        exec(HESTIA_CMD.\"v-change-dns-record-id \".$user.\" \".$v_domain.\" \".$v_old_record_id.\" \".$v_record_id, $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $restart_dns = 'yes';\n    }\n\n    // Restart dns server\n    if (!empty($restart_dns) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-restart-dns\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Set success message\n    if (empty($_SESSION['error_msg'])) {\n        $_SESSION['ok_msg'] = _('Changes has been saved.');\n    }\n\n    // Change url if record id was changed\n    if ((empty($_SESSION['error_msg'])) && ($_GET['record_id'] != $_POST['v_record_id'])) {\n        header(\"Location: /edit/dns/?domain=\".$_GET['domain'].\"&record_id=\".$_POST['v_record_id']);\n        exit;\n    }\n}\n\n\n// Render page\nif (empty($_GET['record_id'])) {\n    // Display body for dns domain\n    render_page($user, $TAB, 'edit_dns');\n} else {\n    if(empty($data[$_GET['record_id']])){\n        header(\"Location: /list/dns/\");\n        $_SESSION['error_msg'] = _(\"Unknown record ID\");\n    }\n    // Display body for dns record\n    render_page($user, $TAB, 'edit_dns_rec');\n}\n\n// Flush session messages\nunset($_SESSION['error_msg']);\nunset($_SESSION['ok_msg']);\n", "<?php\n\nob_start();\n$TAB = 'MAIL';\n\n// Main include\ninclude($_SERVER['DOCUMENT_ROOT'].\"/inc/main.php\");\n\n// Check domain argument\nif (empty($_GET['domain'])) {\n    header(\"Location: /list/mail/\");\n    exit;\n}\n\n// Edit as someone else?\nif (($_SESSION['userContext'] === 'admin') && (!empty($_GET['user']))) {\n    $user=escapeshellarg($_GET['user']);\n}\n\n$v_username = $user;\n\n// List mail domain\nif ((!empty($_GET['domain'])) && (empty($_GET['account']))) {\n    $v_domain = $_GET['domain'];\n    \n    exec(HESTIA_CMD.\"v-list-sys-webmail json\", $output, $return_var);\n    $webmail_clients = json_decode(implode('', $output), true);\n    unset($output);\n    \n    exec(HESTIA_CMD.\"v-list-mail-domain \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n    $data = json_decode(implode('', $output), true);\n    check_return_code_redirect($return_var, $output, '/list/mail/');\n    unset($output);\n\n    // Parse domain\n    $v_antispam = $data[$v_domain]['ANTISPAM'];\n    $v_antivirus = $data[$v_domain]['ANTIVIRUS'];\n    $v_dkim = $data[$v_domain]['DKIM'];\n    $v_catchall = $data[$v_domain]['CATCHALL'];\n    $v_date = $data[$v_domain]['DATE'];\n    $v_time = $data[$v_domain]['TIME'];\n    $v_suspended = $data[$v_domain]['SUSPENDED'];\n    $v_webmail_alias = $data[$v_domain]['WEBMAIL_ALIAS'];\n    $v_webmail = $data[$v_domain]['WEBMAIL'];\n    $v_smtp_relay = $data[$v_domain]['U_SMTP_RELAY'];\n    $v_smtp_relay_host = $data[$v_domain]['U_SMTP_RELAY_HOST'];\n    $v_smtp_relay_port = $data[$v_domain]['U_SMTP_RELAY_PORT'];\n    $v_smtp_relay_user = $data[$v_domain]['U_SMTP_RELAY_USERNAME'];\n\n    if ($v_suspended == 'yes') {\n        $v_status =  'suspended';\n    } else {\n        $v_status =  'active';\n    }\n\n    $v_ssl = $data[$v_domain]['SSL'];\n    if (!empty($v_ssl)) {\n        exec(HESTIA_CMD.\"v-list-mail-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n        $ssl_str = json_decode(implode('', $output), true);\n        unset($output);\n        $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n        $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n        $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n        $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n        $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n        $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n        $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n        $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n        $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n        $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n    }\n    $v_letsencrypt = $data[$v_domain]['LETSENCRYPT'];\n    if (empty($v_letsencrypt)) {\n        $v_letsencrypt = 'no';\n    }\n}\n\n// List mail account\nif ((!empty($_GET['domain'])) && (!empty($_GET['account']))) {\n    $v_domain = $_GET['domain'];\n\n    $v_account = $_GET['account'];\n    exec(HESTIA_CMD.\"v-list-mail-account \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" 'json'\", $output, $return_var);\n    $data = json_decode(implode('', $output), true);\n    check_return_code_redirect($return_var, $output, '/list/mail/');\n    unset($output);\n\n    // Parse mail account\n    $v_username = $user;\n    $v_password = \"\";\n    $v_aliases = str_replace(',', \"\\n\", $data[$v_account]['ALIAS']);\n    $valiases = explode(\",\", $data[$v_account]['ALIAS']);\n    $v_fwd = str_replace(',', \"\\n\", $data[$v_account]['FWD']);\n    if ($v_fwd == \":blackhole:\") {\n        $v_fwd = '';\n        $v_blackhole = \"yes\";\n    } else {\n        $v_blackhole = \"no\";\n    }\n    $vfwd = explode(\",\", $data[$v_account]['FWD']);\n    $v_fwd_only = $data[$v_account]['FWD_ONLY'];\n    $v_quota = $data[$v_account]['QUOTA'];\n    $v_autoreply = $data[$v_account]['AUTOREPLY'];\n    $v_suspended = $data[$v_account]['SUSPENDED'];\n    $v_webmail_alias = $data[$v_account]['WEBMAIL_ALIAS'];\n    if ($v_suspended == 'yes') {\n        $v_status =  'suspended';\n    } else {\n        $v_status =  'active';\n    }\n    $v_date = $data[$v_account]['DATE'];\n    $v_time = $data[$v_account]['TIME'];\n\n    // Parse autoreply\n    if ($v_autoreply == 'yes') {\n        exec(HESTIA_CMD.\"v-list-mail-account-autoreply \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" json\", $output, $return_var);\n        $autoreply_str = json_decode(implode('', $output), true);\n        unset($output);\n        $v_autoreply_message = $autoreply_str[$v_account]['MSG'];\n        $v_autoreply_message=str_replace(\"\\\\n\", \"\\n\", $v_autoreply_message);\n    }\n}\n\n\n// Check POST request for mail domain\nif ((!empty($_POST['save'])) && (!empty($_GET['domain'])) && (empty($_GET['account']))) {\n    // Check token\n    verify_csrf($_POST);\n    \n    \n    exec(HESTIA_CMD.\"v-list-mail-domain \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n    $data = json_decode(implode('', $output), true);\n    check_return_code_redirect($return_var, $output, '/list/mail/');\n    unset($output);\n    \n    // Delete antispam\n    if (($v_antispam == 'yes') && (empty($_POST['v_antispam'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-domain-antispam \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_antispam = 'no';\n        unset($output);\n    }\n\n    // Add antispam\n    if (($v_antispam == 'no') && (!empty($_POST['v_antispam'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-add-mail-domain-antispam \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_antispam = 'yes';\n        unset($output);\n    }\n\n    // Delete antivirus\n    if (($v_antivirus == 'yes') && (empty($_POST['v_antivirus'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-domain-antivirus \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_antivirus = 'no';\n        unset($output);\n    }\n\n    // Add antivirus\n    if (($v_antivirus == 'no') && (!empty($_POST['v_antivirus'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-add-mail-domain-antivirus \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_antivirus = 'yes';\n        unset($output);\n    }\n\n    // Delete DKIM\n    if (($v_dkim == 'yes') && (empty($_POST['v_dkim'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-domain-dkim \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_dkim = 'no';\n        unset($output);\n    }\n\n    // Add DKIM\n    if (($v_dkim == 'no') && (!empty($_POST['v_dkim'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-add-mail-domain-dkim \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_dkim = 'yes';\n        unset($output);\n    }\n\n    // Delete catchall\n    if ((!empty($v_catchall)) && (empty($_POST['v_catchall'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-domain-catchall \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_catchall = '';\n        unset($output);\n    }\n\n    // Change catchall address\n    if ((!empty($v_catchall)) && (!empty($_POST['v_catchall'])) && (empty($_SESSION['error_msg']))) {\n        if ($v_catchall != $_POST['v_catchall']) {\n            $v_catchall = escapeshellarg($_POST['v_catchall']);\n            exec(HESTIA_CMD.\"v-change-mail-domain-catchall \".$v_username.\" \".escapeshellarg($v_domain).\" \".$v_catchall, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n        }\n    }\n\n    // Add catchall\n    if ((empty($v_catchall)) && (!empty($_POST['v_catchall'])) && (empty($_SESSION['error_msg']))) {\n        $v_catchall = escapeshellarg($_POST['v_catchall']);\n        exec(HESTIA_CMD.\"v-add-mail-domain-catchall \".$v_username.\" \".escapeshellarg($v_domain).\" \".$v_catchall, $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    if (!empty($_SESSION['IMAP_SYSTEM']) && !empty($_SESSION['WEBMAIL_SYSTEM'])) {\n        if (empty($_SESSION['error_msg'])) {\n            if (!empty($_POST['v_webmail'])) {\n                $v_webmail = escapeshellarg($_POST['v_webmail']);\n                exec(HESTIA_CMD.\"v-add-mail-domain-webmail \".$user.\" \".$v_domain.\" \".$v_webmail.\" yes\", $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n        }\n    }\n\n    if (!empty($_SESSION['IMAP_SYSTEM']) && !empty($_SESSION['WEBMAIL_SYSTEM'])) {\n        if (empty($_POST['v_webmail'])) {\n            if (empty($_SESSION['error_msg'])) {\n                exec(HESTIA_CMD.\"v-delete-mail-domain-webmail \".$user.\" \".$v_domain.\" yes\", $output, $return_var);\n                check_return_code($return_var, $output);\n                $v_webmail = \"\";\n                unset($output);\n            }\n        }\n    }\n\n    // Change SSL certificate\n    if (($v_letsencrypt == 'no') && (empty($_POST['v_letsencrypt'])) && ($v_ssl == 'yes') && (!empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        if (($v_ssl_crt != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_crt'])) || ($v_ssl_key != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_key'])) || ($v_ssl_ca != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_ca']))) {\n            exec('mktemp -d', $mktemp_output, $return_var);\n            $tmpdir = $mktemp_output[0];\n\n            // Certificate\n            if (!empty($_POST['v_ssl_crt'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".crt\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_crt']));\n                fwrite($fp, \"\\n\");\n                fclose($fp);\n            }\n\n            // Key\n            if (!empty($_POST['v_ssl_key'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".key\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_key']));\n                fwrite($fp, \"\\n\");\n                fclose($fp);\n            }\n\n            // CA\n            if (!empty($_POST['v_ssl_ca'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".ca\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_ca']));\n                fwrite($fp, \"\\n\");\n                fclose($fp);\n            }\n\n            exec(HESTIA_CMD.\"v-change-mail-domain-sslcert \".$user.\" \".escapeshellarg($v_domain).\" \".$tmpdir.\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $restart_web = 'yes';\n            $restart_proxy = 'yes';\n\n            exec(HESTIA_CMD.\"v-list-mail-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n            $ssl_str = json_decode(implode('', $output), true);\n            unset($output);\n            $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n            $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n            $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n            $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n            $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n            $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n            $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n            $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n            $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n            $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n\n            // Cleanup certificate tempfiles\n            if (!empty($_POST['v_ssl_crt'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".crt\");\n            }\n            if (!empty($_POST['v_ssl_key'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".key\");\n            }\n            if (!empty($_POST['v_ssl_ca'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".ca\");\n            }\n            rmdir($tmpdir);\n        }\n    }\n\n    // Delete Lets Encrypt support\n    if (($v_letsencrypt == 'yes') && (empty($_POST['v_letsencrypt']) || empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-letsencrypt-domain \".$user.\" \".escapeshellarg($v_domain).\" ' ' 'yes'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_crt = '';\n        $v_ssl_key = '';\n        $v_ssl_ca = '';\n        $v_letsencrypt = 'no';\n        $v_letsencrypt_deleted = 'yes';\n        $v_ssl = 'no';\n        $restart_mail = 'yes';\n    }\n\n    // Delete SSL certificate\n    if (($v_ssl == 'yes') && (empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-domain-ssl \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_crt = '';\n        $v_ssl_key = '';\n        $v_ssl_ca = '';\n        $v_ssl = 'no';\n        $restart_mail = 'yes';\n    }\n\n    // Add Lets Encrypt support\n    if ((!empty($_POST['v_ssl'])) && ($v_letsencrypt == 'no') && (!empty($_POST['v_letsencrypt'])) && empty($_SESSION['error_msg'])) {\n        exec(HESTIA_CMD.\"v-add-letsencrypt-domain \".$user.\" \".escapeshellarg($v_domain).\" ' ' 'yes'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_letsencrypt = 'yes';\n        $v_ssl = 'yes';\n        $restart_mail = 'yes';\n    }\n\n    // Add SSL certificate\n    if (($v_ssl == 'no') && (!empty($_POST['v_ssl']))  && (empty($v_letsencrypt_deleted)) && (empty($_SESSION['error_msg']))) {\n        if (empty($_POST['v_ssl_crt'])) {\n            $errors[] = 'ssl certificate';\n        }\n        if (empty($_POST['v_ssl_key'])) {\n            $errors[] = 'ssl key';\n        }\n        if (!empty($errors[0])) {\n            foreach ($errors as $i => $error) {\n                if ($i == 0) {\n                    $error_msg = $error;\n                } else {\n                    $error_msg = $error_msg.\", \".$error;\n                }\n            }\n            $_SESSION['error_msg'] = _('Field \"%s\" can not be blank.', $error_msg);\n        } else {\n            exec('mktemp -d', $mktemp_output, $return_var);\n            $tmpdir = $mktemp_output[0];\n\n            // Certificate\n            if (!empty($_POST['v_ssl_crt'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".crt\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_crt']));\n                fclose($fp);\n            }\n\n            // Key\n            if (!empty($_POST['v_ssl_key'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".key\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_key']));\n                fclose($fp);\n            }\n\n            // CA\n            if (!empty($_POST['v_ssl_ca'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".ca\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_ca']));\n                fclose($fp);\n            }\n            exec(HESTIA_CMD.\"v-add-mail-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" \".$tmpdir.\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $v_ssl = 'yes';\n            $restart_web = 'yes';\n            $restart_proxy = 'yes';\n\n            exec(HESTIA_CMD.\"v-list-mail-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n            $ssl_str = json_decode(implode('', $output), true);\n            unset($output);\n            $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n            $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n            $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n            $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n            $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n            $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n            $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n            $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n            $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n            $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n\n            // Cleanup certificate tempfiles\n            if (!empty($_POST['v_ssl_crt'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".crt\");\n            }\n            if (!empty($_POST['v_ssl_key'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".key\");\n            }\n            if (!empty($_POST['v_ssl_ca'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".ca\");\n            }\n            rmdir($tmpdir);\n        }\n    }\n\n    // Add SMTP Relay Support\n    if (empty($_SESSION['error_msg'])) {\n        if (isset($_POST['v_smtp_relay']) && (!empty($_POST['v_smtp_relay_host'])) && (!empty($_POST['v_smtp_relay_user']))) {\n            if (($_POST['v_smtp_relay_host'] != $v_smtp_relay_host) ||\n                ($_POST['v_smtp_relay_user'] != $v_smtp_relay_user) ||\n                ($_POST['v_smtp_relay_port'] != $v_smtp_relay_port) ||\n                (!empty($_POST['v_smtp_relay_pass']))) {\n                if (!empty($_POST['v_smtp_relay_pass'])) {\n                    $v_smtp_relay = true;\n                    $v_smtp_relay_host = escapeshellarg($_POST['v_smtp_relay_host']);\n                    $v_smtp_relay_user = escapeshellarg($_POST['v_smtp_relay_user']);\n                    $v_smtp_relay_pass = escapeshellarg($_POST['v_smtp_relay_pass']);\n                    if (!empty($_POST['v_smtp_relay_port'])) {\n                        $v_smtp_relay_port = escapeshellarg($_POST['v_smtp_relay_port']);\n                    } else {\n                        $v_smtp_relay_port = '587';\n                    }\n                    exec(HESTIA_CMD.\"v-add-mail-domain-smtp-relay \".$v_username.\" \".escapeshellarg($v_domain).\" \".$v_smtp_relay_host.\" \".$v_smtp_relay_user.\" \".$v_smtp_relay_pass.\" \".$v_smtp_relay_port, $output, $return_var);\n                    check_return_code($return_var, $output);\n                    unset($output);\n                } else {\n                    $_SESSION['error_msg'] = _('SMTP Relay Password is required');\n                }\n            }\n        }\n        if ((!isset($_POST['v_smtp_relay'])) && ($v_smtp_relay == true)) {\n            $v_smtp_relay = false;\n            $v_smtp_relay_host = $v_smtp_relay_user = $v_smtp_relay_pass = $v_smtp_relay_port = '';\n            exec(HESTIA_CMD.\"v-delete-mail-domain-smtp-relay \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n        }\n    }\n\n    // Set success message\n    if (empty($_SESSION['error_msg'])) {\n        $_SESSION['ok_msg'] = _('Changes has been saved.');\n    }\n}\n\n// Check POST request for mail account\nif ((!empty($_POST['save'])) && (!empty($_GET['domain'])) && (!empty($_GET['account']))) {\n\n    // Check token\n    verify_csrf($_POST);\n\n    // Validate email\n    if ((!empty($_POST['v_send_email'])) && (empty($_SESSION['error_msg']))) {\n        if (!filter_var($_POST['v_send_email'], FILTER_VALIDATE_EMAIL)) {\n            $_SESSION['error_msg'] = _('Please enter valid email address.');\n        }\n    }\n\n    $v_account = $_POST['v_account'];\n    $v_send_email = $_POST['v_send_email'];\n    $v_credentials = $_POST['v_credentials'];\n\n    exec(HESTIA_CMD.\"v-list-mail-account \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" json\", $output, $return_var);\n    $data = json_decode(implode('', $output), true);\n    check_return_code_redirect($return_var, $output, '/list/mail/');\n    unset($output);\n\n    // Change password\n    if ((!empty($_POST['v_password'])) && (empty($_SESSION['error_msg']))) {\n        if (!validate_password($_POST['v_password'])) {\n            $_SESSION['error_msg'] = _('Password does not match the minimum requirements');\n        } else {\n            $v_password = tempnam(\"/tmp\", \"vst\");\n            $fp = fopen($v_password, \"w\");\n            fwrite($fp, $_POST['v_password'].\"\\n\");\n            fclose($fp);\n            exec(HESTIA_CMD.\"v-change-mail-account-password \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".$v_password, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            unlink($v_password);\n            $v_password = escapeshellarg($_POST['v_password']);\n        }\n    }\n\n    // Change quota\n    if (($v_quota != $_POST['v_quota']) && (empty($_SESSION['error_msg']))) {\n        if (empty($_POST['v_quota'])) {\n            $v_quota = 0;\n        } else {\n            $v_quota = escapeshellarg($_POST['v_quota']);\n        }\n        exec(HESTIA_CMD.\"v-change-mail-account-quota \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".$v_quota, $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Change account aliases\n    if (empty($_SESSION['error_msg'])) {\n        $waliases = preg_replace(\"/\\n/\", \" \", $_POST['v_aliases']);\n        $waliases = preg_replace(\"/,/\", \" \", $waliases);\n        $waliases = preg_replace('/\\s+/', ' ', $waliases);\n        $waliases = trim($waliases);\n        $aliases = explode(\" \", $waliases);\n        $v_aliases = str_replace(' ', \"\\n\", $waliases);\n        $result = array_diff($valiases, $aliases);\n        foreach ($result as $alias) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($alias))) {\n                exec(HESTIA_CMD.\"v-delete-mail-account-alias \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".escapeshellarg($alias), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n        }\n        $result = array_diff($aliases, $valiases);\n        foreach ($result as $alias) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($alias))) {\n                exec(HESTIA_CMD.\"v-add-mail-account-alias \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".escapeshellarg($alias), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n        }\n    }\n    // Change forwarders to :blackhole:\n    if (empty($_SESSION['error_msg']) && !empty($_POST['v_blackhole'])) {\n        foreach ($vfwd as $forward) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($forward))) {\n                exec(HESTIA_CMD.\"v-delete-mail-account-forward \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".escapeshellarg($forward), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n            exec(HESTIA_CMD.\"v-add-mail-account-forward \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" :blackhole:\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $v_fwd  = '';\n            $v_blackhole = \"yes\";\n        }\n    }\n    // Change forwarders\n    if (empty($_SESSION['error_msg']) && empty($_POST['v_blackhole'])) {\n        $wfwd = preg_replace(\"/\\n/\", \" \", $_POST['v_fwd']);\n        $wfwd = preg_replace(\"/,/\", \" \", $wfwd);\n        $wfwd = preg_replace('/\\s+/', ' ', $wfwd);\n        $wfwd = trim($wfwd);\n        $fwd = explode(\" \", $wfwd);\n        $v_fwd = str_replace(' ', \"\\n\", $wfwd);\n        $result = array_diff($vfwd, $fwd);\n        foreach ($result as $forward) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($forward))) {\n                exec(HESTIA_CMD.\"v-delete-mail-account-forward \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".escapeshellarg($forward), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n        }\n        $result = array_diff($fwd, $vfwd);\n        foreach ($result as $forward) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($forward))) {\n                exec(HESTIA_CMD.\"v-add-mail-account-forward \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".escapeshellarg($forward), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n        }\n        $v_blackhole = \"no\";\n    }\n\n    // Delete FWD_ONLY flag\n    if (($v_fwd_only == 'yes') && (empty($_POST['v_fwd_only'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-account-fwd-only \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_fwd_only = '';\n    }\n\n    // Add FWD_ONLY flag\n    if (($v_fwd_only != 'yes') && (!empty($_POST['v_fwd_only'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-add-mail-account-fwd-only \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_fwd_only = 'yes';\n    }\n\n    // Delete autoreply\n    if (($v_autoreply == 'yes') && (empty($_POST['v_autoreply'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-account-autoreply \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_autoreply = 'no';\n        $v_autoreply_message = '';\n    }\n\n    // Add autoreply\n    if ((!empty($_POST['v_autoreply'])) && (empty($_SESSION['error_msg']))) {\n        if ($v_autoreply_message != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_autoreply_message'])) {\n            $v_autoreply_message = str_replace(\"\\r\\n\", \"\\n\", $_POST['v_autoreply_message']);\n            $v_autoreply_message = escapeshellarg($v_autoreply_message);\n            exec(HESTIA_CMD.\"v-add-mail-account-autoreply \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".$v_autoreply_message, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $v_autoreply = 'yes';\n            $v_autoreply_message = $_POST['v_autoreply_message'];\n        }\n    }\n\n    // Email login credentials\n    if ((!empty($v_send_email)) && (empty($_SESSION['error_msg']))) {\n        $to = $v_send_email;\n        $subject = _(\"Email Credentials\");\n        $hostname = exec('hostname');\n        $from = \"noreply@\".$hostname;\n        $from_name = _('Hestia Control Panel');\n        $mailtext = $v_credentials;\n        send_email($to, $subject, $mailtext, $from, $from_name);\n    }\n\n    // Set success message\n    if (empty($_SESSION['error_msg'])) {\n        $_SESSION['ok_msg'] = _('Changes has been saved.');\n    }\n}\n\n\n// Render page\nif (empty($_GET['account'])) {\n    // Display body for mail domain\n    render_page($user, $TAB, 'edit_mail');\n} else {\n    // Display body for mail account\n    render_page($user, $TAB, 'edit_mail_acc');\n}\n\n// Flush session messages\nunset($_SESSION['error_msg']);\nunset($_SESSION['ok_msg']);\n", "<?php\n\nob_start();\nunset($_SESSION['error_msg']);\n$TAB = 'WEB';\n\n// Main include\ninclude($_SERVER['DOCUMENT_ROOT'].\"/inc/main.php\");\n\n// Check domain argument\nif (empty($_GET['domain'])) {\n    header(\"Location: /list/web/\");\n    exit;\n}\n\n// Edit as someone else?\nif (($_SESSION['userContext'] === 'admin') && (!empty($_GET['user']))) {\n    $user=escapeshellarg($_GET['user']);\n}\n\n// Get all user domains\nexec(HESTIA_CMD.\"v-list-web-domains \".$user.\" json\", $output, $return_var);\n$user_domains = json_decode(implode('', $output), true);\n$user_domains = array_keys($user_domains);\nunset($output);\n\n$v_domain = $_GET['domain'];\nexec(HESTIA_CMD.\"v-list-web-domain \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n# Check if domain exists if not return /list/web/\ncheck_return_code_redirect($return_var, $output, '/list/web/');\n$data = json_decode(implode('', $output), true);\nunset($output);\n\n// Parse domain\n$v_ip = $data[$v_domain]['IP'];\n$v_template = $data[$v_domain]['TPL'];\n$v_aliases = str_replace(',', \"\\n\", $data[$v_domain]['ALIAS']);\n$valiases = explode(\",\", $data[$v_domain]['ALIAS']);\n\n$v_tpl = $data[$v_domain]['IP'];\n$v_cgi = $data[$v_domain]['CGI'];\n$v_elog = $data[$v_domain]['ELOG'];\n$v_ssl = $data[$v_domain]['SSL'];\nif (!empty($v_ssl)) {\n    exec(HESTIA_CMD.\"v-list-web-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n    $ssl_str = json_decode(implode('', $output), true);\n    unset($output);\n    $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n    $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n    $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n    $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n    $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n    $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n    $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n    $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n    $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n    $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n    $v_ssl_forcessl = $data[$v_domain]['SSL_FORCE'];\n    $v_ssl_hsts = $data[$v_domain]['SSL_HSTS'];\n}\n$v_letsencrypt = $data[$v_domain]['LETSENCRYPT'];\nif (empty($v_letsencrypt)) {\n    $v_letsencrypt = 'no';\n}\n$v_ssl_home = $data[$v_domain]['SSL_HOME'];\n$v_backend_template = $data[$v_domain]['BACKEND'];\n$v_nginx_cache = $data[$v_domain]['FASTCGI_CACHE'];\n$v_nginx_cache_duration = $data[$v_domain]['FASTCGI_DURATION'];\n$v_nginx_cache_check = '';\nif (empty($v_nginx_cache_duration)) {\n    $v_nginx_cache_duration = '2m';\n    $v_nginx_cache_check = '';\n} else {\n    $v_nginx_cache_check = 'on';\n}\n$v_proxy = $data[$v_domain]['PROXY'];\n$v_proxy_template = $data[$v_domain]['PROXY'];\n$v_proxy_ext = str_replace(',', ', ', $data[$v_domain]['PROXY_EXT']);\n$v_stats = $data[$v_domain]['STATS'];\n$v_stats_user = $data[$v_domain]['STATS_USER'];\nif (!empty($v_stats_user)) {\n    $v_stats_password = \"\";\n}\n$v_custom_doc_root_prepath = '/home/'.$user_plain.'/web/';\n\nif (!empty($data[$v_domain]['CUSTOM_DOCROOT'])) {\n    $v_custom_doc_root = realpath($data[$v_domain]['CUSTOM_DOCROOT']) . DIRECTORY_SEPARATOR;\n}\n\nif (!empty($v_custom_doc_root) &&\n    false !== preg_match('/\\/home\\/'.$user_plain.'\\/web\\/([[:alnum:]].*?)\\/public_html\\/([[:alnum:]].*)?/', $v_custom_doc_root, $matches)) {\n    // Regex for extracting target web domain and custom document root. Regex test: https://regex101.com/r/2CLvIF/1\n\n    if (!empty($matches[1])) {\n        $v_custom_doc_domain = $matches[1];\n    }\n\n    if (!empty($matches[2])) {\n        $v_custom_doc_folder = rtrim($matches[2], '/');\n    }\n\n    if ($v_custom_doc_domain && !in_array($v_custom_doc_domain, $user_domains)) {\n        $v_custom_doc_domain = '';\n        $v_custom_doc_folder = '';\n    }\n}\n\n$redirect_code_options = array(301,302);\n$v_redirect = $data[$v_domain]['REDIRECT'];\n$v_redirect_code = $data[$v_domain]['REDIRECT_CODE'];\nif (!in_array($v_redirect, array('www.'.$v_domain, $v_domain))) {\n    $v_redirect_custom = $v_redirect;\n}\n\n$v_ftp_user = $data[$v_domain]['FTP_USER'];\n$v_ftp_path = $data[$v_domain]['FTP_PATH'];\nif (!empty($v_ftp_user)) {\n    $v_ftp_password = \"\";\n}\n\nif ($v_custom_doc_domain != '') {\n    $v_ftp_user_prepath = '/home/'.$user_plain.'/web/'.$v_custom_doc_domain;\n} else {\n    $v_ftp_user_prepath = '/home/'.$user_plain.'/web/'.$v_domain;\n}\n\n\n$v_ftp_email = $panel[$user]['CONTACT'];\n$v_suspended = $data[$v_domain]['SUSPENDED'];\nif ($v_suspended == 'yes') {\n    $v_status =  'suspended';\n} else {\n    $v_status =  'active';\n}\n$v_time = $data[$v_domain]['TIME'];\n$v_date = $data[$v_domain]['DATE'];\n\n// List ip addresses\nexec(HESTIA_CMD.\"v-list-user-ips \".$user.\" json\", $output, $return_var);\n$ips = json_decode(implode('', $output), true);\nunset($output);\n\n$v_ip_public = empty($ips[$v_ip]['NAT']) ? $v_ip : $ips[$v_ip]['NAT'];\n\n// List web templates\nexec(HESTIA_CMD.\"v-list-web-templates json\", $output, $return_var);\n$templates = json_decode(implode('', $output), true);\nunset($output);\n\n// List backend templates\nif (!empty($_SESSION['WEB_BACKEND'])) {\n    exec(HESTIA_CMD.\"v-list-web-templates-backend json\", $output, $return_var);\n    $backend_templates = json_decode(implode('', $output), true);\n    unset($output);\n}\n\n// List proxy templates\nif (!empty($_SESSION['PROXY_SYSTEM'])) {\n    exec(HESTIA_CMD.\"v-list-web-templates-proxy json\", $output, $return_var);\n    $proxy_templates = json_decode(implode('', $output), true);\n    unset($output);\n}\n\n// List web stat engines\nexec(HESTIA_CMD.\"v-list-web-stats json\", $output, $return_var);\n$stats = json_decode(implode('', $output), true);\nunset($output);\n\n// Check POST request\nif (!empty($_POST['save'])) {\n    $v_domain = $_POST['v_domain'];\n    if (!in_array($v_domain, $user_domains)) {\n        check_return_code(3, [\"Unknown domain\"]);\n    }\n    // Check token\n    verify_csrf($_POST);\n\n    // Change web domain IP\n    $v_newip='';\n    $v_newip_public='';\n\n    if (!empty($_POST['v_ip'])) {\n        $v_newip = $_POST['v_ip'];\n        $v_newip_public = empty($ips[$v_newip]['NAT']) ? $v_newip : $ips[$v_newip]['NAT'];\n    }\n\n    if (($v_ip != $_POST['v_ip']) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-change-web-domain-ip \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($_POST['v_ip']).\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n        unset($output);\n    }\n\n    // Change dns domain IP\n    if (($v_ip != $_POST['v_ip']) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-list-dns-domain \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n        unset($output);\n        if ($return_var == 0) {\n            exec(HESTIA_CMD.\"v-change-dns-domain-ip \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_newip_public).\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $restart_dns = 'yes';\n        }\n    }\n\n    // Change dns ip for each alias\n    if (($v_ip != $_POST['v_ip']) && (empty($_SESSION['error_msg']))) {\n        foreach ($valiases as $v_alias) {\n            exec(HESTIA_CMD.\"v-list-dns-domain \".$user.\" \".escapeshellarg($v_alias).\" json\", $output, $return_var);\n            unset($output);\n            if ($return_var == 0) {\n                exec(HESTIA_CMD.\"v-change-dns-domain-ip \".$user.\" \".escapeshellarg($v_alias).\" \".escapeshellarg($v_newip_public), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n                $restart_dns = 'yes';\n            }\n        }\n    }\n\n    // Change mail domain IP\n    if (($v_ip != $_POST['v_ip']) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-list-mail-domain \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n        unset($output);\n        if ($return_var == 0) {\n            exec(HESTIA_CMD.\"v-rebuild-mail-domain \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $restart_email = 'yes';\n        }\n    }\n\n\n    if (($_SESSION['POLICY_USER_EDIT_WEB_TEMPLATES'] == 'yes') || ($_SESSION['userContext'] === \"admin\")) {\n        // Change template\n        if (($v_template != $_POST['v_template']) && (empty($_SESSION['error_msg']))) {\n            exec(HESTIA_CMD.\"v-change-web-domain-tpl \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($_POST['v_template']).\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $restart_web = 'yes';\n        }\n\n        // Change backend template\n        if ((!empty($_SESSION['WEB_BACKEND'])) && ($v_backend_template != $_POST['v_backend_template'])  && (empty($_SESSION['error_msg']))) {\n            $v_backend_template = $_POST['v_backend_template'];\n            exec(HESTIA_CMD.\"v-change-web-domain-backend-tpl \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_backend_template), $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n        }\n\n        // Enable/Disable nginx cache\n        if (($_SESSION['WEB_SYSTEM'] == 'nginx') && ($v_nginx_cache_check != $_POST['v_nginx_cache_check']) || ($v_nginx_cache_duration != $_POST['v_nginx_cache_duration'] && $_POST['v_nginx_cache'] = \"yes\") && (empty($_SESSION['error_msg']))) {\n            if ($_POST['v_nginx_cache_check'] == 'on') {\n                if (empty($_POST['v_nginx_cache_duration'])) {\n                    $_POST['v_nginx_cache_duration'] = \"2m\";\n                }\n                exec(HESTIA_CMD.\"v-add-fastcgi-cache \".$user.\" \".escapeshellarg($v_domain).' '. escapeshellarg($_POST['v_nginx_cache_duration']), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            } else {\n                exec(HESTIA_CMD.\"v-delete-fastcgi-cache \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n            $restart_web = 'yes';\n        }\n\n        // Delete proxy support\n        if ((!empty($_SESSION['PROXY_SYSTEM'])) && (!empty($v_proxy)) && (empty($_POST['v_proxy'])) && (empty($_SESSION['error_msg']))) {\n            exec(HESTIA_CMD.\"v-delete-web-domain-proxy \".$user.\" \".escapeshellarg($v_domain).\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            unset($v_proxy);\n            $restart_web = 'yes';\n        }\n\n        // Change proxy template / Update extension list\n        if ((!empty($_SESSION['PROXY_SYSTEM'])) && (!empty($v_proxy)) && (!empty($_POST['v_proxy'])) && (empty($_SESSION['error_msg']))) {\n            $ext = preg_replace(\"/\\n/\", \" \", $_POST['v_proxy_ext']);\n            $ext = preg_replace(\"/,/\", \" \", $ext);\n            $ext = preg_replace('/\\s+/', ' ', $ext);\n            $ext = trim($ext);\n            $ext = str_replace(' ', \", \", $ext);\n            if (($v_proxy_template != $_POST['v_proxy_template']) || ($v_proxy_ext != $ext)) {\n                $ext = str_replace(', ', \",\", $ext);\n                if (!empty($_POST['v_proxy_template'])) {\n                    $v_proxy_template = $_POST['v_proxy_template'];\n                }\n                exec(HESTIA_CMD.\"v-change-web-domain-proxy-tpl \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_proxy_template).\" \".escapeshellarg($ext).\" 'no'\", $output, $return_var);\n                check_return_code($return_var, $output);\n                $v_proxy_ext = str_replace(',', ', ', $ext);\n                unset($output);\n                $restart_proxy = 'yes';\n            }\n        }\n\n        // Add proxy support\n        if ((!empty($_SESSION['PROXY_SYSTEM'])) && (empty($v_proxy)) && (!empty($_POST['v_proxy'])) && (empty($_SESSION['error_msg']))) {\n            $v_proxy_template = $_POST['v_proxy_template'];\n            if (!empty($_POST['v_proxy_ext'])) {\n                $ext = preg_replace(\"/\\n/\", \" \", $_POST['v_proxy_ext']);\n                $ext = preg_replace(\"/,/\", \" \", $ext);\n                $ext = preg_replace('/\\s+/', ' ', $ext);\n                $ext = trim($ext);\n                $ext = str_replace(' ', \",\", $ext);\n                $v_proxy_ext = str_replace(',', ', ', $ext);\n            }\n            exec(HESTIA_CMD.\"v-add-web-domain-proxy \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_proxy_template).\" \".escapeshellarg($ext).\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $restart_proxy = 'yes';\n        }\n    }\n    // Change aliases\n    if (empty($_SESSION['error_msg'])) {\n        $waliases = preg_replace(\"/\\n/\", \" \", $_POST['v_aliases']);\n        $waliases = preg_replace(\"/,/\", \" \", $waliases);\n        $waliases = preg_replace('/\\s+/', ' ', $waliases);\n        $waliases = trim($waliases);\n        $aliases = explode(\" \", $waliases);\n        $v_aliases = str_replace(' ', \"\\n\", $waliases);\n        $result = array_diff($valiases, $aliases);\n        foreach ($result as $alias) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($alias))) {\n                $restart_web = 'yes';\n                $restart_proxy = 'yes';\n                exec(HESTIA_CMD.\"v-delete-web-domain-alias \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($alias).\" 'no'\", $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n\n                if (empty($_SESSION['error_msg'])) {\n                    exec(HESTIA_CMD.\"v-list-dns-domain \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n                    unset($output);\n                    if ($return_var == 0) {\n                        exec(HESTIA_CMD.\"v-delete-dns-on-web-alias \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($alias).\" 'no'\", $output, $return_var);\n                        check_return_code($return_var, $output);\n                        unset($output);\n                        $restart_dns = 'yes';\n                    }\n                }\n            }\n        }\n\n        $result = array_diff($aliases, $valiases);\n        foreach ($result as $alias) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($alias))) {\n                $restart_web = 'yes';\n                $restart_proxy = 'yes';\n                exec(HESTIA_CMD.\"v-add-web-domain-alias \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($alias).\" 'no'\", $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n                if (empty($_SESSION['error_msg'])) {\n                    exec(HESTIA_CMD.\"v-list-dns-domain \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n                    unset($output);\n                    if ($return_var == 0) {\n                        exec(HESTIA_CMD.\"v-add-dns-on-web-alias \".$user.\" \".escapeshellarg($alias).\" \".escapeshellarg($v_newip_public ?: $v_ip_public).\" no\", $output, $return_var);\n                        check_return_code($return_var, $output);\n                        unset($output);\n                        $restart_dns = 'yes';\n                    }\n                }\n            }\n        }\n\n        // Regenerate LE if aliases are different\n        if ((!empty($_POST['v_ssl'])) && ($v_letsencrypt == 'yes') && (!empty($_POST['v_letsencrypt'])) && empty($_SESSION['error_msg'])) {\n\n        // If aliases are different from stored aliases\n            if (array_diff($valiases, $aliases) || array_diff($aliases, $valiases)) {\n\n            // Add certificate with new aliases\n                $l_aliases = str_replace(\"\\n\", ',', $v_aliases);\n                exec(HESTIA_CMD.\"v-add-letsencrypt-domain \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($l_aliases).\" ''\", $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n                $v_letsencrypt = 'yes';\n                $v_ssl = 'yes';\n                $restart_web = 'yes';\n                $restart_proxy = 'yes';\n\n                exec(HESTIA_CMD.\"v-list-web-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n                $ssl_str = json_decode(implode('', $output), true);\n                unset($output);\n                $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n                $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n                $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n                $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n                $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n                $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n                $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n                $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n                $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n                $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n            }\n        }\n\n        if ((!empty($v_stats)) && ($_POST['v_stats'] == $v_stats) && (empty($_SESSION['error_msg']))) {\n            // Update statistics configuration when changing domain aliases\n            $v_stats = escapeshellarg($_POST['v_stats']);\n            exec(HESTIA_CMD.\"v-change-web-domain-stats \".$user.\" \".escapeshellarg($v_domain).\" \".$v_stats, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n        }\n    }\n\n    // Change document root for ssl domain\n    if (($v_ssl == 'yes') && (!empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        if ($v_ssl_home != $_POST['v_ssl_home']) {\n            $v_ssl_home = escapeshellarg($_POST['v_ssl_home']);\n            exec(HESTIA_CMD.\"v-change-web-domain-sslhome \".$user.\" \".escapeshellarg($v_domain).\" \".$v_ssl_home.\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            $v_ssl_home = $_POST['v_ssl_home'];\n            $restart_web = 'yes';\n            $restart_proxy = 'yes';\n            unset($output);\n        }\n    }\n\n    // Change SSL certificate\n    if (($v_letsencrypt == 'no') && (empty($_POST['v_letsencrypt'])) && ($v_ssl == 'yes') && (!empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        if (($v_ssl_crt != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_crt'])) || ($v_ssl_key != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_key'])) || ($v_ssl_ca != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_ca']))) {\n            exec('mktemp -d', $mktemp_output, $return_var);\n            $tmpdir = $mktemp_output[0];\n\n            // Certificate\n            if (!empty($_POST['v_ssl_crt'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".crt\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_crt']));\n                fwrite($fp, \"\\n\");\n                fclose($fp);\n            }\n\n            // Key\n            if (!empty($_POST['v_ssl_key'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".key\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_key']));\n                fwrite($fp, \"\\n\");\n                fclose($fp);\n            }\n\n            // CA\n            if (!empty($_POST['v_ssl_ca'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".ca\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_ca']));\n                fwrite($fp, \"\\n\");\n                fclose($fp);\n            }\n\n            exec(HESTIA_CMD.\"v-change-web-domain-sslcert \".$user.\" \".escapeshellarg($v_domain).\" \".$tmpdir.\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $restart_web = 'yes';\n            $restart_proxy = 'yes';\n\n            exec(HESTIA_CMD.\"v-list-web-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n            $ssl_str = json_decode(implode('', $output), true);\n            unset($output);\n            $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n            $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n            $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n            $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n            $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n            $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n            $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n            $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n            $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n            $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n\n            // Cleanup certificate tempfiles\n            if (!empty($_POST['v_ssl_crt'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".crt\");\n            }\n            if (!empty($_POST['v_ssl_key'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".key\");\n            }\n            if (!empty($_POST['v_ssl_ca'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".ca\");\n            }\n            rmdir($tmpdir);\n        }\n    }\n\n    // Delete Lets Encrypt support\n    if (($v_letsencrypt == 'yes') && (empty($_POST['v_letsencrypt']) || empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-letsencrypt-domain \".$user.\" \".escapeshellarg($v_domain).\" ''\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_crt = '';\n        $v_ssl_key = '';\n        $v_ssl_ca = '';\n        $v_letsencrypt = 'no';\n        $v_letsencrypt_deleted = 'yes';\n        $v_ssl = 'no';\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Delete SSL certificate\n    if (($v_ssl == 'yes') && (empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-web-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_crt = '';\n        $v_ssl_key = '';\n        $v_ssl_ca = '';\n        $v_ssl = 'no';\n        $v_ssl_forcessl = 'no';\n        $v_ssl_hsts = 'no';\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Add Lets Encrypt support\n    if ((!empty($_POST['v_ssl'])) && ($v_letsencrypt == 'no') && (!empty($_POST['v_letsencrypt'])) && empty($_SESSION['error_msg'])) {\n        $l_aliases = str_replace(\"\\n\", ',', $v_aliases);\n        exec(HESTIA_CMD.\"v-add-letsencrypt-domain \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($l_aliases).\" ''\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        if ($return_var != 0) {\n            $v_letsencrypt = 'no';\n        } else {\n            $v_letsencrypt = 'yes';\n        }\n        $v_ssl = 'yes';\n        if ($_POST['v_ssl_forcessl'] == 'on') {\n            $v_ssl_forcessl = 'yes';\n        } else {\n            $v_ssl_forcessl = 'no';\n        }\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Add SSL certificate\n    if (($v_ssl == 'no') && (!empty($_POST['v_ssl']))  && (empty($v_letsencrypt_deleted)) && (empty($_SESSION['error_msg']))) {\n        if (empty($_POST['v_ssl_crt'])) {\n            $errors[] = 'ssl certificate';\n        }\n        if (empty($_POST['v_ssl_key'])) {\n            $errors[] = 'ssl key';\n        }\n        if (empty($_POST['v_ssl_home'])) {\n            $errors[] = 'ssl home';\n        }\n        $v_ssl_home = escapeshellarg($_POST['v_ssl_home']);\n        if (!empty($errors[0])) {\n            foreach ($errors as $i => $error) {\n                if ($i == 0) {\n                    $error_msg = $error;\n                } else {\n                    $error_msg = $error_msg.\", \".$error;\n                }\n            }\n            $_SESSION['error_msg'] = _('Field \"%s\" can not be blank.', $error_msg);\n        } else {\n            exec('mktemp -d', $mktemp_output, $return_var);\n            $tmpdir = $mktemp_output[0];\n\n            // Certificate\n            if (!empty($_POST['v_ssl_crt'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".crt\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_crt']));\n                fclose($fp);\n            }\n\n            // Key\n            if (!empty($_POST['v_ssl_key'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".key\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_key']));\n                fclose($fp);\n            }\n\n            // CA\n            if (!empty($_POST['v_ssl_ca'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".ca\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_ca']));\n                fclose($fp);\n            }\n            exec(HESTIA_CMD.\"v-add-web-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" \".$tmpdir.\" \".$v_ssl_home.\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $v_ssl = 'yes';\n            $restart_web = 'yes';\n            $restart_proxy = 'yes';\n\n            exec(HESTIA_CMD.\"v-list-web-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n            $ssl_str = json_decode(implode('', $output), true);\n            unset($output);\n            $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n            $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n            $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n            $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n            $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n            $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n            $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n            $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n            $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n            $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n\n            // Cleanup certificate tempfiles\n            if (!empty($_POST['v_ssl_crt'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".crt\");\n            }\n            if (!empty($_POST['v_ssl_key'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".key\");\n            }\n            if (!empty($_POST['v_ssl_ca'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".ca\");\n            }\n            rmdir($tmpdir);\n        }\n    }\n\n    // Add Force SSL\n    if ((!empty($_POST['v_ssl_forcessl'])) && (!empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-add-web-domain-ssl-force \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_forcessl = 'yes';\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Add SSL HSTS\n    if ((!empty($_POST['v_ssl_hsts'])) && (!empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-add-web-domain-ssl-hsts \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_hsts = 'yes';\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Delete Force SSL\n    if (($v_ssl_forcessl == 'yes') && (empty($_POST['v_ssl_forcessl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-web-domain-ssl-force \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_forcessl = 'no';\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Delete SSL HSTS\n    if (($v_ssl_hsts == 'yes') && (empty($_POST['v_ssl_hsts'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-web-domain-ssl-hsts \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_hsts = 'no';\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Delete web stats\n    if ((!empty($v_stats)) && ($_POST['v_stats'] == 'none') && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-web-domain-stats \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_stats = '';\n    }\n\n    // Change web stats engine\n    if ((!empty($v_stats)) && ($_POST['v_stats'] != $v_stats) && (empty($_SESSION['error_msg']))) {\n        $v_stats = escapeshellarg($_POST['v_stats']);\n        exec(HESTIA_CMD.\"v-change-web-domain-stats \".$user.\" \".escapeshellarg($v_domain).\" \".$v_stats, $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Add web stats\n    if ((empty($v_stats)) && ($_POST['v_stats'] != 'none') && (empty($_SESSION['error_msg']))) {\n        $v_stats = escapeshellarg($_POST['v_stats']);\n        exec(HESTIA_CMD.\"v-add-web-domain-stats \".$user.\" \".escapeshellarg($v_domain).\" \".$v_stats, $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Delete web stats authorization\n    if ((!empty($v_stats_user)) && (empty($_POST['v_stats_auth'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-web-domain-stats-user \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_stats_user = '';\n        $v_stats_password = '';\n    }\n\n    // Change web stats user or password\n    if ((empty($v_stats_user)) && (!empty($_POST['v_stats_auth'])) && (empty($_SESSION['error_msg']))) {\n        if (empty($_POST['v_stats_user'])) {\n            $errors[] = _('stats username');\n        }\n        if (!empty($errors[0])) {\n            foreach ($errors as $i => $error) {\n                if ($i == 0) {\n                    $error_msg = $error;\n                } else {\n                    $error_msg = $error_msg.\", \".$error;\n                }\n            }\n            $_SESSION['error_msg'] = _('Field \"%s\" can not be blank.', $error_msg);\n        } else {\n            $v_stats_user = escapeshellarg($_POST['v_stats_user']);\n            $v_stats_password = tempnam(\"/tmp\", \"vst\");\n            $fp = fopen($v_stats_password, \"w\");\n            fwrite($fp, $_POST['v_stats_password'].\"\\n\");\n            fclose($fp);\n            exec(HESTIA_CMD.\"v-add-web-domain-stats-user \".$user.\" \".escapeshellarg($v_domain).\" \".$v_stats_user.\" \".$v_stats_password, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            unlink($v_stats_password);\n            $v_stats_password = escapeshellarg($_POST['v_stats_password']);\n        }\n    }\n\n    // Add web stats authorization\n    if ((!empty($v_stats_user)) && (!empty($_POST['v_stats_auth'])) && (empty($_SESSION['error_msg']))) {\n        if (empty($_POST['v_stats_user'])) {\n            $errors[] = _('stats user');\n        }\n        if (!empty($errors[0])) {\n            foreach ($errors as $i => $error) {\n                if ($i == 0) {\n                    $error_msg = $error;\n                } else {\n                    $error_msg = $error_msg.\", \".$error;\n                }\n            }\n            $_SESSION['error_msg'] = _('Field \"%s\" can not be blank.', $error_msg);\n        }\n        if (($v_stats_user != $_POST['v_stats_user']) || (!empty($_POST['v_stats_password'])) && (empty($_SESSION['error_msg']))) {\n            $v_stats_user = escapeshellarg($_POST['v_stats_user']);\n            $v_stats_password = tempnam(\"/tmp\", \"vst\");\n            $fp = fopen($v_stats_password, \"w\");\n            fwrite($fp, $_POST['v_stats_password'].\"\\n\");\n            fclose($fp);\n            exec(HESTIA_CMD.\"v-add-web-domain-stats-user \".$user.\" \".escapeshellarg($v_domain).\" \".$v_stats_user.\" \".$v_stats_password, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            unlink($v_stats_password);\n            $v_stats_password = escapeshellarg($_POST['v_stats_password']);\n        }\n    }\n\n    // Update ftp account\n    if (!empty($_POST['v_ftp_user'])) {\n        $v_ftp_users_updated = array();\n        foreach ($_POST['v_ftp_user'] as $i => $v_ftp_user_data) {\n            if (empty($v_ftp_user_data['v_ftp_user'])) {\n                continue;\n            }\n\n            $v_ftp_user_data['v_ftp_user'] = preg_replace(\"/^\".$user.\"_/i\", \"\", $v_ftp_user_data['v_ftp_user']);\n            if ($v_ftp_user_data['is_new'] == 1 && !empty($_POST['v_ftp'])) {\n                if ((!empty($v_ftp_user_data['v_ftp_email'])) && (!filter_var($v_ftp_user_data['v_ftp_email'], FILTER_VALIDATE_EMAIL))) {\n                    $_SESSION['error_msg'] = _('Please enter valid email address.');\n                }\n                if (empty($v_ftp_user_data['v_ftp_user'])) {\n                    $errors[] = 'ftp user';\n                }\n                if (!empty($errors[0])) {\n                    foreach ($errors as $i => $error) {\n                        if ($i == 0) {\n                            $error_msg = $error;\n                        } else {\n                            $error_msg = $error_msg.\", \".$error;\n                        }\n                    }\n                    $_SESSION['error_msg'] = _('Field \"%s\" can not be blank.', $error_msg);\n                }\n\n                // Add ftp account\n                $v_ftp_username      = $v_ftp_user_data['v_ftp_user'];\n                $v_ftp_username_full = $user . '_' . $v_ftp_user_data['v_ftp_user'];\n                $v_ftp_user = escapeshellarg($v_ftp_username);\n                $v_ftp_path = escapeshellarg(trim($v_ftp_user_data['v_ftp_path']));\n                if (empty($_SESSION['error_msg'])) {\n                    $v_ftp_password = tempnam(\"/tmp\", \"vst\");\n                    $fp = fopen($v_ftp_password, \"w\");\n                    fwrite($fp, $v_ftp_user_data['v_ftp_password'].\"\\n\");\n                    fclose($fp);\n                    exec(HESTIA_CMD.\"v-add-web-domain-ftp \".$user.\" \".escapeshellarg($v_domain).\" \".$v_ftp_user.\" \".$v_ftp_password . \" \" . $v_ftp_path, $output, $return_var);\n                    check_return_code($return_var, $output);\n                    if ((!empty($v_ftp_user_data['v_ftp_email'])) && (empty($_SESSION['error_msg']))) {\n                        $to = $v_ftp_user_data['v_ftp_email'];\n                        $subject = _(\"FTP login credentials\");\n                        $hostname = exec('hostname');\n                        $from = \"noreply@\".$hostname;\n                        $from_name = _('Hestia Control Panel');\n                        $mailtext = sprintf(_('FTP_ACCOUNT_READY'), escapeshellarg($_GET['domain']), $user, $v_ftp_username, $v_ftp_user_data['v_ftp_password']);\n                        send_email($to, $subject, $mailtext, $from, $from_name);\n                        unset($v_ftp_email);\n                    }\n                    unset($output);\n                    unlink($v_ftp_password);\n                    $v_ftp_password = escapeshellarg($v_ftp_user_data['v_ftp_password']);\n                }\n\n                if ($return_var == 0) {\n                    $v_ftp_password = \"\";\n                    $v_ftp_user_data['is_new'] = 0;\n                } else {\n                    $v_ftp_user_data['is_new'] = 1;\n                }\n\n                $v_ftp_users_updated[] = array(\n                    'is_new'            => empty($_SESSION['error_msg']) ? 0 : 1,\n                    'v_ftp_user'        => $v_ftp_username_full,\n                    'v_ftp_password'    => $v_ftp_password,\n                    'v_ftp_path'        => $v_ftp_user_data['v_ftp_path'],\n                    'v_ftp_email'       => $v_ftp_user_data['v_ftp_email'],\n                    'v_ftp_pre_path'    => $v_ftp_user_prepath\n                );\n\n                continue;\n            }\n\n            // Delete FTP account\n            if ($v_ftp_user_data['delete'] == 1) {\n                $v_ftp_username = $user_plain . '_' . $v_ftp_user_data['v_ftp_user'];\n                exec(HESTIA_CMD.\"v-delete-web-domain-ftp \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_ftp_username), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n\n                continue;\n            }\n\n            if (!empty($_POST['v_ftp'])) {\n                if (empty($v_ftp_user_data['v_ftp_user'])) {\n                    $errors[] = _('ftp user');\n                }\n                if (!empty($errors[0])) {\n                    foreach ($errors as $i => $error) {\n                        if ($i == 0) {\n                            $error_msg = $error;\n                        } else {\n                            $error_msg = $error_msg.\", \".$error;\n                        }\n                    }\n                    $_SESSION['error_msg'] = _('Field \"%s\" can not be blank.', $error_msg);\n                }\n\n                // Change FTP account path\n                $v_ftp_username_for_emailing = $v_ftp_user_data['v_ftp_user'];\n                $v_ftp_username = $user_plain . '_' . $v_ftp_user_data['v_ftp_user']; //preg_replace(\"/^\".$user.\"_/\", \"\", $v_ftp_user_data['v_ftp_user']);\n                $v_ftp_username = escapeshellarg($v_ftp_username);\n                $v_ftp_path = escapeshellarg(trim($v_ftp_user_data['v_ftp_path']));\n                if (escapeshellarg(trim($v_ftp_user_data['v_ftp_path_prev'])) != $v_ftp_path) {\n                    exec(HESTIA_CMD.\"v-change-web-domain-ftp-path \".$user.\" \".escapeshellarg($v_domain).\" \".$v_ftp_username.\" \".$v_ftp_path, $output, $return_var);\n                }\n\n                // Change FTP account password\n                if (!empty($v_ftp_user_data['v_ftp_password'])) {\n                    $v_ftp_password = tempnam(\"/tmp\", \"vst\");\n                    $fp = fopen($v_ftp_password, \"w\");\n                    fwrite($fp, $v_ftp_user_data['v_ftp_password'].\"\\n\");\n                    fclose($fp);\n                    exec(HESTIA_CMD.\"v-change-web-domain-ftp-password \".$user.\" \".escapeshellarg($v_domain).\" \".$v_ftp_username.\" \".$v_ftp_password, $output, $return_var);\n                    unlink($v_ftp_password);\n\n                    $to = $v_ftp_user_data['v_ftp_email'];\n                    $subject = _(\"FTP login credentials\");\n                    $hostname = exec('hostname');\n                    $from = \"noreply@\".$hostname;\n                    $from_name = _('Hestia Control Panel');\n                    $mailtext = _('FTP_ACCOUNT_READY', escapeshellarg($_GET['domain']), $user, $v_ftp_username_for_emailing, $v_ftp_user_data['v_ftp_password']);\n                    send_email($to, $subject, $mailtext, $from, $from_name);\n                    unset($v_ftp_email);\n                }\n                check_return_code($return_var, $output);\n                unset($output);\n\n                $v_ftp_users_updated[] = array(\n                    'is_new'            => 0,\n                    'v_ftp_user'        => $v_ftp_username,\n                    'v_ftp_password'    => $v_ftp_user_data['v_ftp_password'],\n                    'v_ftp_path'        => $v_ftp_user_data['v_ftp_path'],\n                    'v_ftp_email'       => $v_ftp_user_data['v_ftp_email'],\n                    'v_ftp_pre_path'    => $v_ftp_user_prepath\n                );\n            }\n        }\n    }\n    //custom docoot with check box disabled\n    if (!empty($v_custom_doc_root) && empty($_POST['v_custom_doc_root_check'])) {\n        exec(HESTIA_CMD.\"v-change-web-domain-docroot \".$user.\" \".escapeshellarg($v_domain).\" default\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        unset($_POST['v-custom-doc-domain'], $_POST['v-custom-doc-folder']);\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    if (!empty($_POST['v-custom-doc-domain']) && !empty($_POST['v_custom_doc_root_check']) && $v_custom_doc_root_prepath.$v_custom_doc_domain.'/public_html'.$v_custom_doc_folder != $v_custom_doc_root) {\n        if ($_POST['v-custom-doc-domain'] == $v_domain && empty($_POST['v-custom-doc-folder'])) {\n            exec(HESTIA_CMD.\"v-change-web-domain-docroot \".$user.\" \".escapeshellarg($v_domain).\" default\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n        } else {\n            $v_custom_doc_folder = escapeshellarg(rtrim($_POST['v-custom-doc-folder'], '/'));\n            $v_custom_doc_domain = escapeshellarg($_POST['v-custom-doc-domain']);\n\n            exec(HESTIA_CMD.\"v-change-web-domain-docroot \".$user.\" \".escapeshellarg($v_domain).\" \".$v_custom_doc_domain.\" \".$v_custom_doc_folder .\" yes\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $v_custom_doc_root = 1;\n        }\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    } else {\n        unset($v_custom_doc_root);\n    }\n\n    if (!empty($v_redirect) && empty($_POST['v-redirect-checkbox'])) {\n        exec(HESTIA_CMD.\"v-delete-web-domain-redirect \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        unset($_POST['v-redirect']);\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    if (!empty($_POST['v-redirect']) && !empty($_POST['v-redirect-checkbox'])) {\n        if (empty($v_redirect)) {\n            if ($_POST['v-redirect']  == 'custom' && empty($_POST['v-redirect-custom'])) {\n            } else {\n                if ($_POST['v-redirect']  == 'custom') {\n                    $_POST['v-redirect'] = $_POST['v-redirect-custom'];\n                }\n                exec(HESTIA_CMD.\"v-add-web-domain-redirect \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($_POST['v-redirect']).\" \".escapeshellarg($_POST['v-redirect-code']), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n                $restart_web = 'yes';\n                $restart_proxy = 'yes';\n            }\n        } else {\n            if ($_POST['v-redirect'] == 'custom') {\n                $_POST['v-redirect'] = $_POST['v-redirect-custom'];\n            }\n            if ($_POST['v-redirect'] != $v_redirect || $_POST['v-redirect-code'] != $v_redirect_code) {\n                exec(HESTIA_CMD.\"v-add-web-domain-redirect \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($_POST['v-redirect']).\" \".escapeshellarg($_POST['v-redirect-code']), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n                $restart_web = 'yes';\n                $restart_proxy = 'yes';\n            }\n        }\n    }\n    // Restart web server\n    if (!empty($restart_web) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-restart-web\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Restart proxy server\n    if ((!empty($_SESSION['PROXY_SYSTEM'])) && !empty($restart_proxy) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-restart-proxy\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Restart dns server\n    if (!empty($restart_dns) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-restart-dns\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Set success message\n    if (empty($_SESSION['error_msg'])) {\n        $_SESSION['ok_msg'] = _('Changes has been saved.');\n        header(\"Location: /edit/web/?domain=\" . $v_domain);\n        exit();\n    }\n}\n\n\n$v_ftp_users_raw = explode(':', $v_ftp_user);\n$v_ftp_users_paths_raw = explode(':', $data[$v_domain]['FTP_PATH']);\n$v_ftp_users = array();\nforeach ($v_ftp_users_raw as $v_ftp_user_index => $v_ftp_user_val) {\n    if (empty($v_ftp_user_val)) {\n        continue;\n    }\n    $v_ftp_users[] = array(\n        'is_new'            => 0,\n        'v_ftp_user'        => preg_replace(\"/^\".$user_plain.\"_/\", \"\", $v_ftp_user_val),\n        'v_ftp_password'    => $v_ftp_password,\n        'v_ftp_path'        => (isset($v_ftp_users_paths_raw[$v_ftp_user_index]) ? $v_ftp_users_paths_raw[$v_ftp_user_index] : ''),\n        'v_ftp_email'       => $v_ftp_email,\n        'v_ftp_pre_path'    => $v_ftp_user_prepath\n    );\n}\n\nif (empty($v_ftp_users)) {\n    $v_ftp_user = null;\n    $v_ftp_users[] = array(\n        'is_new'            => 1,\n        'v_ftp_user'        => '',\n        'v_ftp_password'    => '',\n        'v_ftp_path'        => (isset($v_ftp_users_paths_raw[$v_ftp_user_index]) ? $v_ftp_users_paths_raw[$v_ftp_user_index] : ''),\n        'v_ftp_email'       => '',\n        'v_ftp_pre_path'    => $v_ftp_user_prepath\n    );\n}\n\n// set default pre path for newly created users\n$v_ftp_pre_path_new_user = $v_ftp_user_prepath;\nif (isset($v_ftp_users_updated)) {\n    $v_ftp_users = $v_ftp_users_updated;\n    if (empty($v_ftp_users_updated)) {\n        $v_ftp_user = null;\n        $v_ftp_users[] = array(\n            'is_new'            => 1,\n            'v_ftp_user'        => '',\n            'v_ftp_password'    => '',\n            'v_ftp_path'        => (isset($v_ftp_users_paths_raw[$v_ftp_user_index]) ? $v_ftp_users_paths_raw[$v_ftp_user_index] : ''),\n            'v_ftp_email'       => '',\n            'v_ftp_pre_path'    => $v_ftp_user_prepath\n        );\n    }\n}\n\n// Render page\nrender_page($user, $TAB, 'edit_web');\n\n// Flush session messages\nunset($_SESSION['error_msg']);\nunset($_SESSION['ok_msg']);\n", "<!-- Begin toolbar -->\n<div class=\"l-center edit\">\n\t<div class=\"l-sort clearfix\">\n\t\t<div class=\"l-unit-toolbar__buttonstrip\">\n\t\t\t<a class=\"ui-button cancel\" dir=\"ltr\" id=\"btn-back\" href=\"/list/server/\"><i class=\"fas fa-arrow-left status-icon blue\"></i><?=_('Back');?></a>\n\t\t\t<a href=\"/list/ip/\" class=\"ui-button cancel\" dir=\"ltr\"><i class=\"fas fa-ethernet status-icon blue\"></i><?=_('IP');?></a>\n\t\t\t<?php if ((isset($_SESSION['FIREWALL_SYSTEM'])) && (!empty($_SESSION['FIREWALL_SYSTEM']))) {?>\n\t\t\t\t<a href=\"/list/firewall/\" class=\"ui-button cancel\" dir=\"ltr\"><i class=\"fas fa-shield-alt status-icon red\"></i><?=_('Firewall');?></a>\n\t\t\t<?php }?>\n\t\t</div>\n\t\t<div class=\"l-unit-toolbar__buttonstrip float-right\">\n\t\t\t<a href=\"#\" class=\"ui-button\" data-action=\"submit\" data-id=\"vstobjects\"><i class=\"fas fa-save status-icon purple\"></i><?=_('Save');?></a>\n\t\t</div>\n\t</div>\n</div>\n<!-- End toolbar -->\n\n<div class=\"l-separator\"></div>\n\n<div class=\"l-center animated fadeIn\">\n\n\t<form id=\"vstobjects\" name=\"v_configure_server\" method=\"post\">\n\t\t<input type=\"hidden\" name=\"token\" value=\"<?=$_SESSION['token']?>\" />\n\t\t<input type=\"hidden\" name=\"save\" value=\"save\" />\n\n\t\t<table class=\"data mode-add\">\n\t\t\t<tr class=\"data-add\">\n\t\t\t\t<td class=\"data-dotted\">\n\t\t\t\t\t<table class=\"data-col1\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t\t<td class=\"data-dotted\">\n\t\t\t\t\t<table class=\"data-col2\" width=\"600px\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"step-top\">\n\t\t\t\t\t\t\t\t<span class=\"page-title\"><?=_('Configuring Server');?></span>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<?php show_error_panel($_SESSION);?>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<!-- Basic options tab -->\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('basic');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-cog\"></i><b><?=_('Basic options');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_adv)) echo 'none';?> ;\" id=\"basic\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Hostname');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_hostname\" value=\"<?=htmlentities(trim($v_hostname, \"'\"))?>\">\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Time Zone');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_timezone\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\t\t\tforeach ($v_timezones as $key => $value) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\techo \"\\t\\t\\t\\t<option value=\\\"\".$key.\"\\\"\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ((!empty($v_timezone)) && ( $key == $v_timezone)){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\techo ' selected' ;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ((!empty($v_timezone)) && ( $key == $_POST['v_timezone'])){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\techo ' selected' ;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\techo \">\".$value.\"</option>\\n\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Theme');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_theme\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\t\t\tforeach ($theme as $key => $value) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\techo \"\\t\\t\\t\\t<option value=\\\"\".$value.\"\\\"\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ((!empty($_SESSION['THEME'])) && ( $value == $_SESSION['THEME'])){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\techo ' selected' ;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ((!empty($_SESSION['THEME'])) && ( $value == $_POST['v_theme'])){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\techo ' selected' ;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\techo \">\".$value.\"</option>\\n\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_policy_user_change_theme\" <?php if ((isset($_SESSION['POLICY_USER_CHANGE_THEME'])) && (!empty($_SESSION['POLICY_USER_CHANGE_THEME'])) && ($_SESSION['POLICY_USER_CHANGE_THEME'] == \"no\")) echo \"checked=yes\" ?>><?=_('Set as selected theme for all users');?></label>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Default Language');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_language\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\t\t\tforeach ($languages as $key => $value) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\techo \"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<option value=\\\"\".$key.\"\\\"\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ( $key == $v_language ){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\techo 'selected' ;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (( $key == $_SESSION['LANGUAGE'] && (empty($v_language)) )) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\techo 'selected' ;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\techo \">\".htmlentities($value).\"</option>\\n\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_language_update\"><?=_('Set as default language for all users');?></label>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<!-- Updates tab -->\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('version');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-code-branch\"></i><b><?=_('Updates');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_adv)) echo 'none';?> ;\" id=\"version\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Version'); ?>: <span class=\"optional\"><?=$_SESSION['VERSION'];?></span>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php if ($_SESSION['RELEASE_BRANCH'] !== 'release') {?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Release'); ?>: <span class=\"optional\"><?=$_SESSION['RELEASE_BRANCH'];?></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Options'); ?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_debug_mode\" <?php if ((isset($_SESSION['DEBUG_MODE'])) && (!empty($_SESSION['DEBUG_MODE'])) && ($_SESSION['DEBUG_MODE'] == \"true\")) echo \"checked=yes\" ?>><?=_('Enable debug mode');?></label>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_experimental_features\" <?php if ((isset($_SESSION['POLICY_SYSTEM_ENABLE_BACON'])) && (!empty($_SESSION['POLICY_SYSTEM_ENABLE_BACON'])) && ($_SESSION['POLICY_SYSTEM_ENABLE_BACON'] == \"true\")) echo \"checked=yes\" ?>><?=_('Enable preview features');?></label> <span class=\"hint\">(<a href=\"/list/server/preview/\"><?=_('View');?></a>)</span>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_upgrade_send_notification_email\" <?php if ((isset($_SESSION['UPGRADE_SEND_EMAIL'])) && (!empty($_SESSION['UPGRADE_SEND_EMAIL'])) && ($_SESSION['UPGRADE_SEND_EMAIL'] == \"true\")) echo \"checked=yes\" ?>><?=_('SYSTEM_UPGRADE_SEND_NOTIFICATION_EMAIL');?></label>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_upgrade_send_email_log\" <?php if ((isset($_SESSION['UPGRADE_SEND_EMAIL_LOG'])) && (!empty($_SESSION['UPGRADE_SEND_EMAIL_LOG'])) && ($_SESSION['UPGRADE_SEND_EMAIL_LOG'] == \"true\")) echo \"checked=yes\" ?>><?=_('SYSTEM_UPGRADE_SEND_EMAIL_LOG');?></label>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<!-- Web Server tab -->\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('web');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-globe-americas\"></i><b><?=_('Web Server');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_adv)) echo 'none';?> ;\" id=\"web\" class=\"step-top\">\n\t\t\t\t\t\t\t\t\t<?php if (!empty($_SESSION['PROXY_SYSTEM'])) { ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Proxy Server');?>: <span class=\"optional\"><?=$_SESSION['PROXY_SYSTEM']; ?> <a href=\"/edit/server/<? echo $_SESSION['PROXY_SYSTEM'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t<?php if (!empty($_SESSION['WEB_SYSTEM'])) { ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Web Server');?>: <span class=\"optional\"><?=$_SESSION['WEB_SYSTEM']; ?> <a href=\"/edit/server/<? echo $_SESSION['WEB_SYSTEM'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t<?php if (!empty($_SESSION['WEB_BACKEND'])) { ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Backend Server');?>: <span class=\"optional\"><?=$_SESSION['WEB_BACKEND']; ?> <a href=\"/edit/server/<? echo $_SESSION['WEB_BACKEND'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t<?php if (!empty($_SESSION['WEB_BACKEND_POOL'])) { ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Backend Pool Mode');?>: <span class=\"optional\"><?=$_SESSION['WEB_BACKEND_POOL']; ?></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t<?php if(count($v_php_versions)): ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Enabled multi PHP versions');?>\n\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"alert alert-info alert-with-icon\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-info\"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Please wait while php is installed or removed');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php foreach($v_php_versions as $php_version): ?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$php_version->installed?'checked':''; ?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$php_version->protected?'disabled':''; ?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"<?=$php_version->name?>\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"v_php_versions[<?=$php_version->tpl?>]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label for=\"<?=$php_version->name?>\"><?=$php_version->name?></label>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<?php foreach($php_version->usedby as $wd_user => $wd_domains ): ?>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php foreach($wd_domains as $wd_domain ): ?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\" style=\"border: 1px lightgrey; padding:0 10px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-user\"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$wd_user;?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"optional\" style=\"float:right\"><?=$wd_domain;?></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endforeach; ?>\n\t\t\t\t\t\t\t\t\t\t\t<?php endforeach; ?>\n\t\t\t\t\t\t\t\t\t\t<?php endforeach; ?>\n\t\t\t\t\t\t\t\t\t<?php endif; ?>\n\t\t\t\t\t\t\t\t\t<?php if(!empty($_SESSION['WEB_BACKEND'])){\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('System PHP version');?></span>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_php_default_version\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php foreach($v_php_versions as $php_version){\n\t\t\t\t\t\t\t\t\t\t\t\tif($php_version -> installed){\n\t\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"<?=$php_version->version; ?>\" <?php if($php_version->name == DEFAULT_PHP_VERSION){ echo \"selected\" ;}?> ><?=$php_version->name; ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php\t\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<!-- DNS Server tab -->\n\t\t\t\t\t\t<?php if (!empty($_SESSION['DNS_SYSTEM'])) { ?>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('dns');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-atlas\"></i><b><?=_('DNS Server');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_adv)) echo 'none';?> ;\" id=\"dns\">\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('DNS Server');?>: <span class=\"optional\"><?=$_SESSION['DNS_SYSTEM']; ?> <a href=\"/edit/server/<? echo $_SESSION['DNS_SYSTEM'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('DNS Cluster');?>: <span class=\"optional\"><?php if ($v_dns_cluster == 'yes') { echo _('Yes'); } else { echo _('No'); } ?></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php if ($v_dns_cluster == 'yes') {\n\t\t\t\t\t\t\t\t\t\t\t$i = 0;\n\t\t\t\t\t\t\t\t\t\t\tforeach ($dns_cluster as $key => $value) {\n\t\t\t\t\t\t\t\t\t\t\t\t$i++;\n\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Host'). ' #'.$i  ?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_dns_remote_host\" value=\"<?=$key; ?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php } } ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td><br></td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t<!-- Mail Server tab -->\n\t\t\t\t\t\t<?php if ((!empty($_SESSION['MAIL_SYSTEM']))) { ?>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('mail');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-mail-bulk\"></i><b><?=_('Mail Server');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_mail_adv)) echo 'none';?> ;\" id=\"mail\">\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Mail Server');?>: <span class=\"optional\"><?=$_SESSION['MAIL_SYSTEM']; ?> <a href=\"/edit/server/<? echo $_SESSION['MAIL_SYSTEM'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php if (!empty($_SESSION['ANTIVIRUS_SYSTEM'])) { ?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Antivirus');?>: <span class=\"optional\"><?=$_SESSION['ANTIVIRUS_SYSTEM']; ?> <a href=\"/edit/server/<? echo $_SESSION['ANTIVIRUS_SYSTEM'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t<?php if (!empty($_SESSION['ANTISPAM_SYSTEM'])) { ?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('AntiSpam');?>: <span class=\"optional\"><?=$_SESSION['ANTISPAM_SYSTEM']; ?> <a href=\"/edit/server/<? echo $_SESSION['ANTISPAM_SYSTEM'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t<?php if($_SESSION['WEBMAIL_SYSTEM']){?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Webmail URL');?> <span class=\"hint\">(<?=$_SESSION['WEBMAIL_ALIAS'];?>.example.com)</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_webmail_alias\" value=\"<?=$_SESSION['WEBMAIL_ALIAS']; ?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_smtp_relay\" <?php if ($v_smtp_relay == 'true') echo \"checked=yes\"; ?> onclick=\"javascript:elementHideShow('smtp_relay_table');\"><?=_('Global SMTP Relay');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<table style=\"display:<?php if ($v_smtp_relay == 'true') {echo 'block';} else {echo 'none';} ?>;\" id=\"smtp_relay_table\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"input-label vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Host');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_smtp_relay_host\" value=\"<?=htmlentities(trim($v_smtp_relay_host, \"'\"))?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"input-label vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Port');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_smtp_relay_port\" value=\"<?=htmlentities(trim($v_smtp_relay_port, \"'\"))?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"input-label vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Username');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_smtp_relay_user\" value=\"<?=htmlentities(trim($v_smtp_relay_user, \"'\"))?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"input-label vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Password');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input password\" name=\"v_smtp_relay_pass\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t<!-- Databases tab -->\n\t\t\t\t\t\t<?php if (!empty($_SESSION['DB_SYSTEM'])) { ?>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('db');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-database\"></i><b><?=_('Databases');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_db_adv)) echo 'none';?> ;\" id=\"db\">\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('MySQL Support');?> <a href=\"/edit/server/mysql/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_mysql\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($v_mysql == 'yes') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t\t\t\t<!-- MySQL / MariaDB Options-->\n\t\t\t\t\t\t\t\t\t\t<?php if ($v_mysql == 'yes') { ?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('phpMyAdmin URL');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_mysql_url\" value=\"<?=$_SESSION['DB_PMA_ALIAS']; ?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('phpMyAdmin Single Sign On');?><span class=\"hint\">(<a href=\"https://docs.hestiacp.com/admin_docs/database/phpmyadmin-sso.html\" target=\"_blank\"><?=_('More info');?>)</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_phpmyadmin_key\" <?php if ($_SESSION['API'] != 'yes'){ echo \"disabled\"; }?>>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no'><?=_('Disabled'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_POST['v_phpmyadmin_key'] == \"yes\" || $_SESSION['PHPMYADMIN_KEY'] != ''){ echo 'selected=\"selected\"'; }; ?>><?=_('Enabled'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t<?php if ($v_mysql == 'yes') {\n\t\t\t\t\t\t\t\t\t\t\t$i = 0;\n\t\t\t\t\t\t\t\t\t\t\tforeach ($v_mysql_hosts as $value) {\n\t\t\t\t\t\t\t\t\t\t\t\t$i++;\n\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Host'). ' #'.$i  ?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_mysql_host\" value=\"<?=$value['HOST']?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Password');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input password\" name=\"v_mysql_password\" value=\"\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Maximum Number Of Databases');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_mysql_max\" value=\"<?=$value['MAX_DB']; ?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Current Number Of Databases');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_mysql_max\" value=\"<?=$value['U_DB_BASES']; ?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php }} ?>\n\n\t\t\t\t\t\t\t\t\t\t<!-- PostgreSQL Options-->\n\t\t\t\t\t\t\t\t\t\t<?php if ($v_pgsql == 'yes') { ?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('PostgreSQL Support');?> <a href=\"/edit/server/postgresql/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_pgsql\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($v_pgsql == 'yes') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('phpPgAdmin URL');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_pgsql_url\" value=\"<?=$_SESSION['DB_PGA_ALIAS']; ?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t<?php if ($v_pgsql == 'yes') {\n\t\t\t\t\t\t\t\t\t\t\t$i = 0;\n\t\t\t\t\t\t\t\t\t\t\tforeach ($v_pgsql_hosts as $value) {\n\t\t\t\t\t\t\t\t\t\t\t\t$i++;\n\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Host'). ' #'.$i  ?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_pgsql_host\" value=\"<?=$value['HOST']?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Maximum Number Of Databases');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_psql_max\" value=\"<?=$value['MAX_DB']; ?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Current Number Of Databases');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_pgsql_max\" value=\"<?=$value['U_DB_BASES']; ?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br><br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php }} ?>\n\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('backup');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-undo\"></i><b><?=_('Backups');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"<?php if (empty($v_backup_adv)) echo 'display:none';?> ;\" id=\"backup\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Local backup');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_backup\">\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='no'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($v_backup == 'yes') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Compression');?> <a target=\"_blank\" href=\"http://docs.hestiacp.com/admin_docs/backups.html#what-is-the-difference-between-zstd-and-gzip\"><i class=\"fas fa-question-circle\"></i></a>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_backup_mode\">\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='gzip' <?php if($v_backup_mode != 'zstd') echo 'selected' ?>>gzip</option>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='zstd' <?php if($v_backup_mode == 'zstd') echo 'selected' ?>>zstd</option>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Compression level');?> <a target=\"_blank\" href=\"http://docs.hestiacp.com/admin_docs/backups.html#what-is-the-optimal-compression-ratio\"><i class=\"fas fa-question-circle\"></i></a>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_backup_gzip\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php for ($level = 1; $level < 20; $level++) { ?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='<?=$level;?>' <?php if($v_backup_gzip == $level) echo 'selected' ?>><?=$level;?><?php if($level > 9){ echo sprintf(' (%s)', _('zstd only')); } ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Directory');?> <a target=\"_blank\" href=\"https://docs.hestiacp.com/admin_docs/backups.html#how-to-change-default-backup-folder\"><i class=\"fas fa-question-circle\"></i></a>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_dir\" value=\"<?=trim($v_backup_dir, \"'\")?>\" disabled=\"disabled\">\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_backup_remote_adv\" <?php if (!empty($v_backup_remote_adv)) echo \"checked=yes\" ?> onclick=\"javascript:elementHideShow('remote_backup');\"><?=_('Remote backup');?></label>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_backup_remote_adv)) echo 'none';?> ;\" id=\"remote_backup\">\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Protocol');?> <a target=\"_blank\" href=\"http://docs.hestiacp.com/admin_docs/backups.html#what-kind-of-protocols-are-currently-supported\"><i class=\"fas fa-question-circle\"></i></a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_backup_type\" id=\"backup_type\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='ftp'><?=_('ftp'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='sftp' <?php if((!empty($v_backup_type)) && (trim($v_backup_type,\"'\")  == 'sftp' )) echo 'selected=\"selected\"'; ?>><?=_('sftp'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"b2\" <?php if((!empty($v_backup_type)) && (trim($v_backup_type,\"'\")  == 'b2' )) echo 'selected=\"selected\"'; ?>><?=_('Backblaze'); ?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr style=\"display: <?php if ((!empty($v_backup_type)) && !in_array(trim($v_backup_type, \"'\"),array('ftp','sftp'))){ echo 'none';} else {echo 'block';} ?>\" id=\"backup_sftp\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Host');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_host\" value=\"<?=trim($v_backup_host, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Port');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_port\" value=\"<?=trim($v_backup_port, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Username');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_username\" value=\"<?=trim($v_backup_username, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Password');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input password\" name=\"v_backup_password\" value=\"<?=trim($v_backup_password, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Directory');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_bpath\" value=\"<?=trim($v_backup_bpath, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr style=\"display: <?php if ((empty($v_backup_type)) || !in_array(trim($v_backup_type, \"'\"),array('b2'))){ echo 'none';} else {echo 'block';} ?>\" id=\"backup_bucket\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Bucket');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_bucket\" value=\"<?=trim($v_backup_bucket, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Application ID');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_application_id\" value=\"<?=trim($v_backup_application_id, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Application Key');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_application_key\" value=\"<?=trim($v_backup_application_key, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('ssl');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-lock\"></i><b><?=_('Hestia SSL');?><img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_adv)) echo 'none';?> ;\" id=\"ssl\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('SSL Certificate');?>\n\t\t\t\t\t\t\t\t\t\t\t<span id=\"generate-csr\"> / <a class=\"generate\" target=\"_blank\" href=\"/generate/ssl/?domain=<?=$v_hostname?>\"><?=_('Generate CSR');?></a></span>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<textarea size=\"20\" class=\"vst-textinput short console\" name=\"v_ssl_crt\"><?=htmlentities(trim($v_ssl_crt, \"'\"))?></textarea>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('SSL Key');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<textarea size=\"20\" class=\"vst-textinput short console\" name=\"v_ssl_key\"><?=htmlentities(trim($v_ssl_key, \"'\"))?></textarea>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<table class=\"additional-info\">\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('SUBJECT');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_subject?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if ($v_ssl_aliases){?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('Aliases');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_aliases?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('NOT_BEFORE');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_not_before?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('NOT_AFTER');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_not_after?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('SIGNATURE');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_signature?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('PUB_KEY');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_pub_key?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('ISSUER');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_issuer?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('security');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-key\"></i><b><?=_('Security');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"<?php if (empty($v_security_adv)) echo 'display:none;';?>\" id=\"security\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"section-title\" onclick=\"javascript:elementHideShow('security-system-table',this);\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('System');?>\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-plus-square status-icon dim maroon section-hide-button\"></i>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<table id=\"security-system-table\" style=\"display: none;\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top\" style=\"font-size:1rem;padding-bottom:12px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('API');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Enable API access');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_api\" id=\"api\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes'><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['API'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table id=\"security_ip\" style=\"<?php if ($_SESSION['API'] == \"no\") echo 'display:none;';?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allowed IP addresses for API');?> <span class=\"optional\" style=\"float:right\">1 IP address per line</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<textarea size=\"20\" class=\"vst-textinput short\" name=\"v_api_allowed_ip\"><?php \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tforeach(explode(',',$_SESSION['API_ALLOWED_IP']) as $ip ){ \n                                                                            echo trim($ip).\"\\n\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t?></textarea>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top\" style=\"font-size:1rem;padding-bottom:12px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Login');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Login screen style');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_login_style\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='default'><?=_('Default'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='old' <?php if($_SESSION['LOGIN_STYLE'] == 'old') echo 'selected' ?>><?=_('Old Style'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow users to reset their passwords');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_system_password_reset\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes'><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_SYSTEM_PASSWORD_RESET'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Inactive session timeout');?> (<?=_('Minutes');?>)\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_inactive_session_timeout\" value=\"<?=trim($_SESSION['INACTIVE_SESSION_TIMEOUT'], \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Prevent CSRF');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_csrf_strictness\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"0\"  <?php if($_SESSION['POLICY_CSRF_STRICTNESS'] == '0') echo 'selected' ?>><?=_('Disabled');?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"1\"  <?php if($_SESSION['POLICY_CSRF_STRICTNESS'] == '1') echo 'selected' ?>><?=_('Enabled');?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"2\"  <?php if($_SESSION['POLICY_CSRF_STRICTNESS'] == '2') echo 'selected' ?>><?=_('Strict');?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php if (($_SESSION['userContext'] === \"admin\") && ($_SESSION['user'] === 'admin')) {?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"section-title\" onclick=\"javascript:elementHideShow('security-sysadminprotect-table',this);\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('System Protection');?>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-plus-square status-icon dim maroon section-hide-button\"></i>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t<table id=\"security-sysadminprotect-table\" class=\"step-top\" style=\"display: none;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top\" style=\"font-size:1rem;padding-bottom:12px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('System Administrator account');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Restrict access to read-only for other administrators');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_system_protected_admin\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes'><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_SYSTEM_PROTECTED_ADMIN'] !== 'yes') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Hide account from other administrators');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_system_hide_admin\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes'><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_SYSTEM_HIDE_ADMIN'] !== 'yes') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Do not allow other administrators to access Server Settings');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_system_hide_services\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes'><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_SYSTEM_HIDE_SERVICES'] !== 'yes') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"section-title\" onclick=\"javascript:elementHideShow('security-policies-table',this);\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Policies');?>\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-plus-square status-icon dim maroon section-hide-button\"></i>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<table id=\"security-policies-table\" style=\"display: none;\">\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top\" style=\"font-size:1rem;padding-bottom:12px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Users');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if ($_SESSION['POLICY_SYSTEM_ENABLE_BACON'] === 'true') { ?>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow suspended users to log in with read-only access');?> <span class=\"hint\">(<?=_('Preview');?>)</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_user_view_suspended\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['POLICY_USER_VIEW_SUSPENDED'] !== 'no') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_USER_VIEW_SUSPENDED'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow users to edit their account details');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_user_edit_details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['POLICY_USER_EDIT_DETAILS'] !== 'no') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_USER_EDIT_DETAILS'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow users to change templates when editing web domains');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_user_edit_web_templates\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['POLICY_USER_EDIT_WEB_TEMPLATES'] !== 'no') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_USER_EDIT_WEB_TEMPLATES'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow users to change templates when editing DNS zones');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_user_edit_dns_templates\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['POLICY_USER_EDIT_DNS_TEMPLATES'] !== 'no') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_USER_EDIT_DNS_TEMPLATES'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow users to view action and login history logs');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_user_view_logs\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['POLICY_USER_VIEW_LOGS'] !== 'no') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_USER_VIEW_LOGS'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow users to delete log history');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_user_delete_logs\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['POLICY_USER_DELETE_LOGS'] !== 'no') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_USER_DELETE_LOGS'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top\" style=\"font-size:1rem;padding-bottom:12px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Domains');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Enforce subdomain ownership');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_enforce_subdomain_ownership\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes'><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['ENFORCE_SUBDOMAIN_OWNERSHIP'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('hestia');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-puzzle-piece\"></i><b><?=_('Hestia Control Panel Plugins');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_adv)) echo 'none';?> ;\" id=\"hestia\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Quick App Installer');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_plugin_app_installer\">\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='false'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='true' <?php if($_SESSION['PLUGIN_APP_INSTALLER'] == 'true') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Filemanager');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_filemanager\">\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='false'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='true' <?php if($_SESSION['FILE_MANAGER'] == 'true') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('FileSystem Disk Quota');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_quota\">\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='no'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['DISK_QUOTA'] == 'yes') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Firewall');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_firewall\">\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='no'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['FIREWALL_SYSTEM'] == 'iptables') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t\t<table class=\"data-col2\"></table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t</form>\n</div>\n"], "fixing_code": ["<?php\n\nob_start();\n$TAB = 'DB';\n\n// Main include\ninclude($_SERVER['DOCUMENT_ROOT'].'/inc/main.php');\n\n// Check database id\nif (empty($_GET['database'])) {\n    header(\"Location: /list/db/\");\n    exit;\n}\n\n// Edit as someone else?\nif (($_SESSION['userContext'] === 'admin') && (!empty($_GET['user']))) {\n    $user=escapeshellarg($_GET['user']);\n    $user_plain=htmlentities($_GET['user']);\n}\n\n// List datbase\n$v_database = $_GET['database'];\nexec(HESTIA_CMD.\"v-list-database \".$user.\" \".escapeshellarg($v_database).\" 'json'\", $output, $return_var);\ncheck_return_code_redirect($return_var, $output, '/list/db/');\n$data = json_decode(implode('', $output), true);\nunset($output);\n\n// Parse database\n$v_username = $user;\n$v_dbuser =  preg_replace(\"/^\".$user_plain.\"_/\", \"\", $data[$v_database]['DBUSER']);\n$v_password = \"\";\n$v_host = $data[$v_database]['HOST'];\n$v_type = $data[$v_database]['TYPE'];\n$v_charset = $data[$v_database]['CHARSET'];\n$v_date = $data[$v_database]['DATE'];\n$v_time = $data[$v_database]['TIME'];\n$v_suspended = $data[$v_database]['SUSPENDED'];\nif ($v_suspended == 'yes') {\n    $v_status =  'suspended';\n} else {\n    $v_status =  'active';\n}\n\n// Check POST request\nif (!empty($_POST['save'])) {\n    $v_username = $user;\n\n    // Check token\n    verify_csrf($_POST);\n\n    // Change database user\n    if (($v_dbuser != $_POST['v_dbuser']) && (empty($_SESSION['error_msg']))) {\n        $v_dbuser = escapeshellarg($v_dbuser);\n        exec(HESTIA_CMD.\"v-change-database-user \".$user.\" \".escapeshellarg($v_database).\" \".$v_dbuser, $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_dbuser = $_POST['v_dbuser'];\n    }\n\n    // Change database password\n    if ((!empty($_POST['v_password'])) && (empty($_SESSION['error_msg']))) {\n        if (!validate_password($_POST['v_password'])) {\n            $_SESSION['error_msg'] = _('Password does not match the minimum requirements');\n        } else {\n            $v_password = tempnam(\"/tmp\", \"vst\");\n            $fp = fopen($v_password, \"w\");\n            fwrite($fp, $_POST['v_password'].\"\\n\");\n            fclose($fp);\n            exec(HESTIA_CMD.\"v-change-database-password \".$user.\" \".escapeshellarg($v_database).\" \".$v_password, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            unlink($v_password);\n            $v_password = escapeshellarg($_POST['v_password']);\n        }\n    }\n\n    // Set success message\n    if (empty($_SESSION['error_msg'])) {\n        $_SESSION['ok_msg'] = _('Changes has been saved.');\n    }\n}\n\n// Render page\nrender_page($user, $TAB, 'edit_db');\n\n// Flush session messages\nunset($_SESSION['error_msg']);\nunset($_SESSION['ok_msg']);\n", "<?php\n\nob_start();\n$TAB = 'DNS';\n\n// Main include\ninclude($_SERVER['DOCUMENT_ROOT'].\"/inc/main.php\");\n\n// Check domain name\nif (empty($_GET['domain'])) {\n    header(\"Location: /list/dns/\");\n    exit;\n}\n\n// Edit as someone else?\nif (($_SESSION['userContext'] === 'admin') && (!empty($_GET['user']))) {\n    $user=escapeshellarg($_GET['user']);\n    $user_plain=htmlentities($_GET['user']);\n}\n\n// List ip addresses\nexec(HESTIA_CMD.\"v-list-user-ips \".$user.\" json\", $output, $return_var);\n$v_ips = json_decode(implode('', $output), true);\nunset($output);\n\n// List dns domain\nif ((!empty($_GET['domain'])) && (empty($_GET['record_id']))) {\n    $v_domain = escapeshellarg($_GET['domain']);\n    exec(HESTIA_CMD.\"v-list-dns-domain \".$user.\" \".$v_domain.\" json\", $output, $return_var);\n    check_return_code_redirect($return_var, $output,'/list/dns/');\n    $data = json_decode(implode('', $output), true);\n    unset($output);\n\n    // Parse dns domain\n    $v_username = $user;\n    $v_domain = $_GET['domain'];\n    $v_ip = $data[$v_domain]['IP'];\n    $v_template = $data[$v_domain]['TPL'];\n    $v_ttl = $data[$v_domain]['TTL'];\n    $v_exp = $data[$v_domain]['EXP'];\n    $v_soa = $data[$v_domain]['SOA'];\n    $v_date = $data[$v_domain]['DATE'];\n    $v_time = $data[$v_domain]['TIME'];\n    $v_suspended = $data[$v_domain]['SUSPENDED'];\n    if ($v_suspended == 'yes') {\n        $v_status =  'suspended';\n    } else {\n        $v_status =  'active';\n    }\n\n    // List dns templates\n    exec(HESTIA_CMD.\"v-list-dns-templates json\", $output, $return_var);\n    $templates = json_decode(implode('', $output), true);\n    unset($output);\n}\n\n// List dns record\nif ((!empty($_GET['domain'])) && (!empty($_GET['record_id']))) {\n    $v_domain = escapeshellarg($_GET['domain']);\n    $v_record_id = escapeshellarg($_GET['record_id']);\n    exec(HESTIA_CMD.\"v-list-dns-records \".$user.\" \".$v_domain.\" 'json'\", $output, $return_var);\n    check_return_code_redirect($return_var, $output,'/list/dns/');\n    $data = json_decode(implode('', $output), true);\n    unset($output);\n    // Parse dns record\n    $v_username = $user;\n    $v_domain = $_GET['domain'];\n    $v_record_id = $_GET['record_id'];\n    $v_rec = $data[$v_record_id]['RECORD'];\n    $v_type = $data[$v_record_id]['TYPE'];\n    $v_val = $data[$v_record_id]['VALUE'];\n    $v_priority = $data[$v_record_id]['PRIORITY'];\n    $v_suspended = $data[$v_record_id]['SUSPENDED'];\n    if ($v_suspended == 'yes') {\n        $v_status =  'suspended';\n    } else {\n        $v_status =  'active';\n    }\n    $v_date = $data[$v_record_id]['DATE'];\n    $v_time = $data[$v_record_id]['TIME'];\n    $v_ttl = $data[$v_record_id]['TTL'];\n}\n\n// Check POST request for dns domain\nif ((!empty($_POST['save'])) && (!empty($_GET['domain'])) && (empty($_GET['record_id']))) {\n    $v_domain = escapeshellarg($_POST['v_domain']);\n\n    // Check token\n    verify_csrf($_POST);\n\n    // Change domain IP\n    if (($v_ip != $_POST['v_ip']) && (empty($_SESSION['error_msg']))) {\n        $v_ip = escapeshellarg($_POST['v_ip']);\n        exec(HESTIA_CMD.\"v-change-dns-domain-ip \".$user.\" \".$v_domain.\" \".$v_ip.\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        $restart_dns = 'yes';\n        unset($output);\n    }\n\n    // Change domain template\n    if (($v_template != $_POST['v_template']) && (empty($_SESSION['error_msg']))) {\n        $v_template = escapeshellarg($_POST['v_template']);\n        exec(HESTIA_CMD.\"v-change-dns-domain-tpl \".$user.\" \".$v_domain.\" \".$v_template.\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $restart_dns = 'yes';\n    }\n\n    // Change SOA record\n    if (($v_soa != $_POST['v_soa']) && (empty($_SESSION['error_msg']))) {\n        $v_soa = escapeshellarg($_POST['v_soa']);\n        exec(HESTIA_CMD.\"v-change-dns-domain-soa \".$user.\" \".$v_domain.\" \".$v_soa.\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $restart_dns = 'yes';\n    }\n\n    // Change expiriation date\n    if (($v_exp != $_POST['v_exp']) && (empty($_SESSION['error_msg']))) {\n        $v_exp = escapeshellarg($_POST['v_exp']);\n        exec(HESTIA_CMD.\"v-change-dns-domain-exp \".$user.\" \".$v_domain.\" \".$v_exp.\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Change domain ttl\n    if (($v_ttl != $_POST['v_ttl']) && (empty($_SESSION['error_msg']))) {\n        $v_ttl = escapeshellarg($_POST['v_ttl']);\n        exec(HESTIA_CMD.\"v-change-dns-domain-ttl \".$user.\" \".$v_domain.\" \".$v_ttl.\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $restart_dns = 'yes';\n    }\n\n    // Restart dns server\n    if (!empty($restart_dns) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-restart-dns\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Set success message\n    if (empty($_SESSION['error_msg'])) {\n        $_SESSION['ok_msg'] = _('Changes has been saved.');\n    }\n}\n\n// Check POST request for dns record\nif ((!empty($_POST['save'])) && (!empty($_GET['domain'])) && (!empty($_GET['record_id']))) {\n\n    // Check token\n    verify_csrf($_POST);\n\n    // Protect input\n    $v_domain = escapeshellarg($_POST['v_domain']);\n    $v_record_id = escapeshellarg($_POST['v_record_id']);\n\n    // Change dns record\n    if (($v_rec != $_POST['v_rec']) || ($v_type != $_POST['v_type']) || ($v_val != $_POST['v_val']) || ($v_priority != $_POST['v_priority']) || ($v_ttl != $_POST['v_ttl']) && (empty($_SESSION['error_msg']))) {\n        $v_rec = escapeshellarg($_POST['v_rec']);\n        $v_type = escapeshellarg($_POST['v_type']);\n        $v_val = escapeshellarg($_POST['v_val']);\n        $v_priority = escapeshellarg($_POST['v_priority']);\n        $v_ttl = escapeshellarg($_POST['v_ttl']);\n        exec(HESTIA_CMD.\"v-change-dns-record \".$user.\" \".$v_domain.\" \".$v_record_id.\" \".$v_rec.\" \".$v_type.\" \".$v_val.\" \".$v_priority.\" false \".$v_ttl, $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_rec = $_POST['v_rec'];\n        $v_type = $_POST['v_type'];\n        $v_val = $_POST['v_val'];\n        unset($output);\n        $restart_dns = 'yes';\n    }\n\n\n    // Change dns record id\n    if (($_GET['record_id'] != $_POST['v_record_id']) && (empty($_SESSION['error_msg']))) {\n        $v_old_record_id = escapeshellarg($_GET['record_id']);\n        exec(HESTIA_CMD.\"v-change-dns-record-id \".$user.\" \".$v_domain.\" \".$v_old_record_id.\" \".$v_record_id, $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $restart_dns = 'yes';\n    }\n\n    // Restart dns server\n    if (!empty($restart_dns) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-restart-dns\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Set success message\n    if (empty($_SESSION['error_msg'])) {\n        $_SESSION['ok_msg'] = _('Changes has been saved.');\n    }\n\n    // Change url if record id was changed\n    if ((empty($_SESSION['error_msg'])) && ($_GET['record_id'] != $_POST['v_record_id'])) {\n        header(\"Location: /edit/dns/?domain=\".$_GET['domain'].\"&record_id=\".$_POST['v_record_id']);\n        exit;\n    }\n}\n\n\n// Render page\nif (empty($_GET['record_id'])) {\n    // Display body for dns domain\n    render_page($user, $TAB, 'edit_dns');\n} else {\n    if(empty($data[$_GET['record_id']])){\n        header(\"Location: /list/dns/\");\n        $_SESSION['error_msg'] = _(\"Unknown record ID\");\n    }\n    // Display body for dns record\n    render_page($user, $TAB, 'edit_dns_rec');\n}\n\n// Flush session messages\nunset($_SESSION['error_msg']);\nunset($_SESSION['ok_msg']);\n", "<?php\n\nob_start();\n$TAB = 'MAIL';\n\n// Main include\ninclude($_SERVER['DOCUMENT_ROOT'].\"/inc/main.php\");\n\n// Check domain argument\nif (empty($_GET['domain'])) {\n    header(\"Location: /list/mail/\");\n    exit;\n}\n\n// Edit as someone else?\nif (($_SESSION['userContext'] === 'admin') && (!empty($_GET['user']))) {\n    $user=escapeshellarg($_GET['user']);\n    $user_plain=htmlentities($_GET['user']);\n}\n\n$v_username = $user;\n\n// List mail domain\nif ((!empty($_GET['domain'])) && (empty($_GET['account']))) {\n    $v_domain = $_GET['domain'];\n    \n    exec(HESTIA_CMD.\"v-list-sys-webmail json\", $output, $return_var);\n    $webmail_clients = json_decode(implode('', $output), true);\n    unset($output);\n    \n    exec(HESTIA_CMD.\"v-list-mail-domain \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n    $data = json_decode(implode('', $output), true);\n    check_return_code_redirect($return_var, $output, '/list/mail/');\n    unset($output);\n\n    // Parse domain\n    $v_antispam = $data[$v_domain]['ANTISPAM'];\n    $v_antivirus = $data[$v_domain]['ANTIVIRUS'];\n    $v_dkim = $data[$v_domain]['DKIM'];\n    $v_catchall = $data[$v_domain]['CATCHALL'];\n    $v_date = $data[$v_domain]['DATE'];\n    $v_time = $data[$v_domain]['TIME'];\n    $v_suspended = $data[$v_domain]['SUSPENDED'];\n    $v_webmail_alias = $data[$v_domain]['WEBMAIL_ALIAS'];\n    $v_webmail = $data[$v_domain]['WEBMAIL'];\n    $v_smtp_relay = $data[$v_domain]['U_SMTP_RELAY'];\n    $v_smtp_relay_host = $data[$v_domain]['U_SMTP_RELAY_HOST'];\n    $v_smtp_relay_port = $data[$v_domain]['U_SMTP_RELAY_PORT'];\n    $v_smtp_relay_user = $data[$v_domain]['U_SMTP_RELAY_USERNAME'];\n\n    if ($v_suspended == 'yes') {\n        $v_status =  'suspended';\n    } else {\n        $v_status =  'active';\n    }\n\n    $v_ssl = $data[$v_domain]['SSL'];\n    if (!empty($v_ssl)) {\n        exec(HESTIA_CMD.\"v-list-mail-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n        $ssl_str = json_decode(implode('', $output), true);\n        unset($output);\n        $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n        $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n        $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n        $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n        $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n        $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n        $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n        $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n        $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n        $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n    }\n    $v_letsencrypt = $data[$v_domain]['LETSENCRYPT'];\n    if (empty($v_letsencrypt)) {\n        $v_letsencrypt = 'no';\n    }\n}\n\n// List mail account\nif ((!empty($_GET['domain'])) && (!empty($_GET['account']))) {\n    $v_domain = $_GET['domain'];\n\n    $v_account = $_GET['account'];\n    exec(HESTIA_CMD.\"v-list-mail-account \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" 'json'\", $output, $return_var);\n    $data = json_decode(implode('', $output), true);\n    check_return_code_redirect($return_var, $output, '/list/mail/');\n    unset($output);\n\n    // Parse mail account\n    $v_username = $user;\n    $v_password = \"\";\n    $v_aliases = str_replace(',', \"\\n\", $data[$v_account]['ALIAS']);\n    $valiases = explode(\",\", $data[$v_account]['ALIAS']);\n    $v_fwd = str_replace(',', \"\\n\", $data[$v_account]['FWD']);\n    if ($v_fwd == \":blackhole:\") {\n        $v_fwd = '';\n        $v_blackhole = \"yes\";\n    } else {\n        $v_blackhole = \"no\";\n    }\n    $vfwd = explode(\",\", $data[$v_account]['FWD']);\n    $v_fwd_only = $data[$v_account]['FWD_ONLY'];\n    $v_quota = $data[$v_account]['QUOTA'];\n    $v_autoreply = $data[$v_account]['AUTOREPLY'];\n    $v_suspended = $data[$v_account]['SUSPENDED'];\n    $v_webmail_alias = $data[$v_account]['WEBMAIL_ALIAS'];\n    if ($v_suspended == 'yes') {\n        $v_status =  'suspended';\n    } else {\n        $v_status =  'active';\n    }\n    $v_date = $data[$v_account]['DATE'];\n    $v_time = $data[$v_account]['TIME'];\n\n    // Parse autoreply\n    if ($v_autoreply == 'yes') {\n        exec(HESTIA_CMD.\"v-list-mail-account-autoreply \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" json\", $output, $return_var);\n        $autoreply_str = json_decode(implode('', $output), true);\n        unset($output);\n        $v_autoreply_message = $autoreply_str[$v_account]['MSG'];\n        $v_autoreply_message=str_replace(\"\\\\n\", \"\\n\", $v_autoreply_message);\n    }\n}\n\n\n// Check POST request for mail domain\nif ((!empty($_POST['save'])) && (!empty($_GET['domain'])) && (empty($_GET['account']))) {\n    // Check token\n    verify_csrf($_POST);\n    \n    \n    exec(HESTIA_CMD.\"v-list-mail-domain \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n    $data = json_decode(implode('', $output), true);\n    check_return_code_redirect($return_var, $output, '/list/mail/');\n    unset($output);\n    \n    // Delete antispam\n    if (($v_antispam == 'yes') && (empty($_POST['v_antispam'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-domain-antispam \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_antispam = 'no';\n        unset($output);\n    }\n\n    // Add antispam\n    if (($v_antispam == 'no') && (!empty($_POST['v_antispam'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-add-mail-domain-antispam \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_antispam = 'yes';\n        unset($output);\n    }\n\n    // Delete antivirus\n    if (($v_antivirus == 'yes') && (empty($_POST['v_antivirus'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-domain-antivirus \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_antivirus = 'no';\n        unset($output);\n    }\n\n    // Add antivirus\n    if (($v_antivirus == 'no') && (!empty($_POST['v_antivirus'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-add-mail-domain-antivirus \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_antivirus = 'yes';\n        unset($output);\n    }\n\n    // Delete DKIM\n    if (($v_dkim == 'yes') && (empty($_POST['v_dkim'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-domain-dkim \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_dkim = 'no';\n        unset($output);\n    }\n\n    // Add DKIM\n    if (($v_dkim == 'no') && (!empty($_POST['v_dkim'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-add-mail-domain-dkim \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_dkim = 'yes';\n        unset($output);\n    }\n\n    // Delete catchall\n    if ((!empty($v_catchall)) && (empty($_POST['v_catchall'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-domain-catchall \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        $v_catchall = '';\n        unset($output);\n    }\n\n    // Change catchall address\n    if ((!empty($v_catchall)) && (!empty($_POST['v_catchall'])) && (empty($_SESSION['error_msg']))) {\n        if ($v_catchall != $_POST['v_catchall']) {\n            $v_catchall = escapeshellarg($_POST['v_catchall']);\n            exec(HESTIA_CMD.\"v-change-mail-domain-catchall \".$v_username.\" \".escapeshellarg($v_domain).\" \".$v_catchall, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n        }\n    }\n\n    // Add catchall\n    if ((empty($v_catchall)) && (!empty($_POST['v_catchall'])) && (empty($_SESSION['error_msg']))) {\n        $v_catchall = escapeshellarg($_POST['v_catchall']);\n        exec(HESTIA_CMD.\"v-add-mail-domain-catchall \".$v_username.\" \".escapeshellarg($v_domain).\" \".$v_catchall, $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    if (!empty($_SESSION['IMAP_SYSTEM']) && !empty($_SESSION['WEBMAIL_SYSTEM'])) {\n        if (empty($_SESSION['error_msg'])) {\n            if (!empty($_POST['v_webmail'])) {\n                $v_webmail = escapeshellarg($_POST['v_webmail']);\n                exec(HESTIA_CMD.\"v-add-mail-domain-webmail \".$user.\" \".$v_domain.\" \".$v_webmail.\" yes\", $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n        }\n    }\n\n    if (!empty($_SESSION['IMAP_SYSTEM']) && !empty($_SESSION['WEBMAIL_SYSTEM'])) {\n        if (empty($_POST['v_webmail'])) {\n            if (empty($_SESSION['error_msg'])) {\n                exec(HESTIA_CMD.\"v-delete-mail-domain-webmail \".$user.\" \".$v_domain.\" yes\", $output, $return_var);\n                check_return_code($return_var, $output);\n                $v_webmail = \"\";\n                unset($output);\n            }\n        }\n    }\n\n    // Change SSL certificate\n    if (($v_letsencrypt == 'no') && (empty($_POST['v_letsencrypt'])) && ($v_ssl == 'yes') && (!empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        if (($v_ssl_crt != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_crt'])) || ($v_ssl_key != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_key'])) || ($v_ssl_ca != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_ca']))) {\n            exec('mktemp -d', $mktemp_output, $return_var);\n            $tmpdir = $mktemp_output[0];\n\n            // Certificate\n            if (!empty($_POST['v_ssl_crt'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".crt\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_crt']));\n                fwrite($fp, \"\\n\");\n                fclose($fp);\n            }\n\n            // Key\n            if (!empty($_POST['v_ssl_key'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".key\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_key']));\n                fwrite($fp, \"\\n\");\n                fclose($fp);\n            }\n\n            // CA\n            if (!empty($_POST['v_ssl_ca'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".ca\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_ca']));\n                fwrite($fp, \"\\n\");\n                fclose($fp);\n            }\n\n            exec(HESTIA_CMD.\"v-change-mail-domain-sslcert \".$user.\" \".escapeshellarg($v_domain).\" \".$tmpdir.\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $restart_web = 'yes';\n            $restart_proxy = 'yes';\n\n            exec(HESTIA_CMD.\"v-list-mail-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n            $ssl_str = json_decode(implode('', $output), true);\n            unset($output);\n            $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n            $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n            $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n            $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n            $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n            $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n            $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n            $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n            $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n            $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n\n            // Cleanup certificate tempfiles\n            if (!empty($_POST['v_ssl_crt'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".crt\");\n            }\n            if (!empty($_POST['v_ssl_key'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".key\");\n            }\n            if (!empty($_POST['v_ssl_ca'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".ca\");\n            }\n            rmdir($tmpdir);\n        }\n    }\n\n    // Delete Lets Encrypt support\n    if (($v_letsencrypt == 'yes') && (empty($_POST['v_letsencrypt']) || empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-letsencrypt-domain \".$user.\" \".escapeshellarg($v_domain).\" ' ' 'yes'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_crt = '';\n        $v_ssl_key = '';\n        $v_ssl_ca = '';\n        $v_letsencrypt = 'no';\n        $v_letsencrypt_deleted = 'yes';\n        $v_ssl = 'no';\n        $restart_mail = 'yes';\n    }\n\n    // Delete SSL certificate\n    if (($v_ssl == 'yes') && (empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-domain-ssl \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_crt = '';\n        $v_ssl_key = '';\n        $v_ssl_ca = '';\n        $v_ssl = 'no';\n        $restart_mail = 'yes';\n    }\n\n    // Add Lets Encrypt support\n    if ((!empty($_POST['v_ssl'])) && ($v_letsencrypt == 'no') && (!empty($_POST['v_letsencrypt'])) && empty($_SESSION['error_msg'])) {\n        exec(HESTIA_CMD.\"v-add-letsencrypt-domain \".$user.\" \".escapeshellarg($v_domain).\" ' ' 'yes'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_letsencrypt = 'yes';\n        $v_ssl = 'yes';\n        $restart_mail = 'yes';\n    }\n\n    // Add SSL certificate\n    if (($v_ssl == 'no') && (!empty($_POST['v_ssl']))  && (empty($v_letsencrypt_deleted)) && (empty($_SESSION['error_msg']))) {\n        if (empty($_POST['v_ssl_crt'])) {\n            $errors[] = 'ssl certificate';\n        }\n        if (empty($_POST['v_ssl_key'])) {\n            $errors[] = 'ssl key';\n        }\n        if (!empty($errors[0])) {\n            foreach ($errors as $i => $error) {\n                if ($i == 0) {\n                    $error_msg = $error;\n                } else {\n                    $error_msg = $error_msg.\", \".$error;\n                }\n            }\n            $_SESSION['error_msg'] = _('Field \"%s\" can not be blank.', $error_msg);\n        } else {\n            exec('mktemp -d', $mktemp_output, $return_var);\n            $tmpdir = $mktemp_output[0];\n\n            // Certificate\n            if (!empty($_POST['v_ssl_crt'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".crt\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_crt']));\n                fclose($fp);\n            }\n\n            // Key\n            if (!empty($_POST['v_ssl_key'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".key\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_key']));\n                fclose($fp);\n            }\n\n            // CA\n            if (!empty($_POST['v_ssl_ca'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".ca\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_ca']));\n                fclose($fp);\n            }\n            exec(HESTIA_CMD.\"v-add-mail-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" \".$tmpdir.\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $v_ssl = 'yes';\n            $restart_web = 'yes';\n            $restart_proxy = 'yes';\n\n            exec(HESTIA_CMD.\"v-list-mail-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n            $ssl_str = json_decode(implode('', $output), true);\n            unset($output);\n            $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n            $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n            $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n            $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n            $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n            $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n            $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n            $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n            $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n            $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n\n            // Cleanup certificate tempfiles\n            if (!empty($_POST['v_ssl_crt'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".crt\");\n            }\n            if (!empty($_POST['v_ssl_key'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".key\");\n            }\n            if (!empty($_POST['v_ssl_ca'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".ca\");\n            }\n            rmdir($tmpdir);\n        }\n    }\n\n    // Add SMTP Relay Support\n    if (empty($_SESSION['error_msg'])) {\n        if (isset($_POST['v_smtp_relay']) && (!empty($_POST['v_smtp_relay_host'])) && (!empty($_POST['v_smtp_relay_user']))) {\n            if (($_POST['v_smtp_relay_host'] != $v_smtp_relay_host) ||\n                ($_POST['v_smtp_relay_user'] != $v_smtp_relay_user) ||\n                ($_POST['v_smtp_relay_port'] != $v_smtp_relay_port) ||\n                (!empty($_POST['v_smtp_relay_pass']))) {\n                if (!empty($_POST['v_smtp_relay_pass'])) {\n                    $v_smtp_relay = true;\n                    $v_smtp_relay_host = escapeshellarg($_POST['v_smtp_relay_host']);\n                    $v_smtp_relay_user = escapeshellarg($_POST['v_smtp_relay_user']);\n                    $v_smtp_relay_pass = escapeshellarg($_POST['v_smtp_relay_pass']);\n                    if (!empty($_POST['v_smtp_relay_port'])) {\n                        $v_smtp_relay_port = escapeshellarg($_POST['v_smtp_relay_port']);\n                    } else {\n                        $v_smtp_relay_port = '587';\n                    }\n                    exec(HESTIA_CMD.\"v-add-mail-domain-smtp-relay \".$v_username.\" \".escapeshellarg($v_domain).\" \".$v_smtp_relay_host.\" \".$v_smtp_relay_user.\" \".$v_smtp_relay_pass.\" \".$v_smtp_relay_port, $output, $return_var);\n                    check_return_code($return_var, $output);\n                    unset($output);\n                } else {\n                    $_SESSION['error_msg'] = _('SMTP Relay Password is required');\n                }\n            }\n        }\n        if ((!isset($_POST['v_smtp_relay'])) && ($v_smtp_relay == true)) {\n            $v_smtp_relay = false;\n            $v_smtp_relay_host = $v_smtp_relay_user = $v_smtp_relay_pass = $v_smtp_relay_port = '';\n            exec(HESTIA_CMD.\"v-delete-mail-domain-smtp-relay \".$v_username.\" \".escapeshellarg($v_domain), $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n        }\n    }\n\n    // Set success message\n    if (empty($_SESSION['error_msg'])) {\n        $_SESSION['ok_msg'] = _('Changes has been saved.');\n    }\n}\n\n// Check POST request for mail account\nif ((!empty($_POST['save'])) && (!empty($_GET['domain'])) && (!empty($_GET['account']))) {\n\n    // Check token\n    verify_csrf($_POST);\n\n    // Validate email\n    if ((!empty($_POST['v_send_email'])) && (empty($_SESSION['error_msg']))) {\n        if (!filter_var($_POST['v_send_email'], FILTER_VALIDATE_EMAIL)) {\n            $_SESSION['error_msg'] = _('Please enter valid email address.');\n        }\n    }\n\n    $v_account = $_POST['v_account'];\n    $v_send_email = $_POST['v_send_email'];\n    $v_credentials = $_POST['v_credentials'];\n\n    exec(HESTIA_CMD.\"v-list-mail-account \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" json\", $output, $return_var);\n    $data = json_decode(implode('', $output), true);\n    check_return_code_redirect($return_var, $output, '/list/mail/');\n    unset($output);\n\n    // Change password\n    if ((!empty($_POST['v_password'])) && (empty($_SESSION['error_msg']))) {\n        if (!validate_password($_POST['v_password'])) {\n            $_SESSION['error_msg'] = _('Password does not match the minimum requirements');\n        } else {\n            $v_password = tempnam(\"/tmp\", \"vst\");\n            $fp = fopen($v_password, \"w\");\n            fwrite($fp, $_POST['v_password'].\"\\n\");\n            fclose($fp);\n            exec(HESTIA_CMD.\"v-change-mail-account-password \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".$v_password, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            unlink($v_password);\n            $v_password = escapeshellarg($_POST['v_password']);\n        }\n    }\n\n    // Change quota\n    if (($v_quota != $_POST['v_quota']) && (empty($_SESSION['error_msg']))) {\n        if (empty($_POST['v_quota'])) {\n            $v_quota = 0;\n        } else {\n            $v_quota = escapeshellarg($_POST['v_quota']);\n        }\n        exec(HESTIA_CMD.\"v-change-mail-account-quota \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".$v_quota, $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Change account aliases\n    if (empty($_SESSION['error_msg'])) {\n        $waliases = preg_replace(\"/\\n/\", \" \", $_POST['v_aliases']);\n        $waliases = preg_replace(\"/,/\", \" \", $waliases);\n        $waliases = preg_replace('/\\s+/', ' ', $waliases);\n        $waliases = trim($waliases);\n        $aliases = explode(\" \", $waliases);\n        $v_aliases = str_replace(' ', \"\\n\", $waliases);\n        $result = array_diff($valiases, $aliases);\n        foreach ($result as $alias) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($alias))) {\n                exec(HESTIA_CMD.\"v-delete-mail-account-alias \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".escapeshellarg($alias), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n        }\n        $result = array_diff($aliases, $valiases);\n        foreach ($result as $alias) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($alias))) {\n                exec(HESTIA_CMD.\"v-add-mail-account-alias \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".escapeshellarg($alias), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n        }\n    }\n    // Change forwarders to :blackhole:\n    if (empty($_SESSION['error_msg']) && !empty($_POST['v_blackhole'])) {\n        foreach ($vfwd as $forward) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($forward))) {\n                exec(HESTIA_CMD.\"v-delete-mail-account-forward \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".escapeshellarg($forward), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n            exec(HESTIA_CMD.\"v-add-mail-account-forward \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" :blackhole:\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $v_fwd  = '';\n            $v_blackhole = \"yes\";\n        }\n    }\n    // Change forwarders\n    if (empty($_SESSION['error_msg']) && empty($_POST['v_blackhole'])) {\n        $wfwd = preg_replace(\"/\\n/\", \" \", $_POST['v_fwd']);\n        $wfwd = preg_replace(\"/,/\", \" \", $wfwd);\n        $wfwd = preg_replace('/\\s+/', ' ', $wfwd);\n        $wfwd = trim($wfwd);\n        $fwd = explode(\" \", $wfwd);\n        $v_fwd = str_replace(' ', \"\\n\", $wfwd);\n        $result = array_diff($vfwd, $fwd);\n        foreach ($result as $forward) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($forward))) {\n                exec(HESTIA_CMD.\"v-delete-mail-account-forward \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".escapeshellarg($forward), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n        }\n        $result = array_diff($fwd, $vfwd);\n        foreach ($result as $forward) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($forward))) {\n                exec(HESTIA_CMD.\"v-add-mail-account-forward \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".escapeshellarg($forward), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n        }\n        $v_blackhole = \"no\";\n    }\n\n    // Delete FWD_ONLY flag\n    if (($v_fwd_only == 'yes') && (empty($_POST['v_fwd_only'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-account-fwd-only \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_fwd_only = '';\n    }\n\n    // Add FWD_ONLY flag\n    if (($v_fwd_only != 'yes') && (!empty($_POST['v_fwd_only'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-add-mail-account-fwd-only \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_fwd_only = 'yes';\n    }\n\n    // Delete autoreply\n    if (($v_autoreply == 'yes') && (empty($_POST['v_autoreply'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-mail-account-autoreply \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_autoreply = 'no';\n        $v_autoreply_message = '';\n    }\n\n    // Add autoreply\n    if ((!empty($_POST['v_autoreply'])) && (empty($_SESSION['error_msg']))) {\n        if ($v_autoreply_message != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_autoreply_message'])) {\n            $v_autoreply_message = str_replace(\"\\r\\n\", \"\\n\", $_POST['v_autoreply_message']);\n            $v_autoreply_message = escapeshellarg($v_autoreply_message);\n            exec(HESTIA_CMD.\"v-add-mail-account-autoreply \".$v_username.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_account).\" \".$v_autoreply_message, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $v_autoreply = 'yes';\n            $v_autoreply_message = $_POST['v_autoreply_message'];\n        }\n    }\n\n    // Email login credentials\n    if ((!empty($v_send_email)) && (empty($_SESSION['error_msg']))) {\n        $to = $v_send_email;\n        $subject = _(\"Email Credentials\");\n        $hostname = exec('hostname');\n        $from = \"noreply@\".$hostname;\n        $from_name = _('Hestia Control Panel');\n        $mailtext = $v_credentials;\n        send_email($to, $subject, $mailtext, $from, $from_name);\n    }\n\n    // Set success message\n    if (empty($_SESSION['error_msg'])) {\n        $_SESSION['ok_msg'] = _('Changes has been saved.');\n    }\n}\n\n\n// Render page\nif (empty($_GET['account'])) {\n    // Display body for mail domain\n    render_page($user, $TAB, 'edit_mail');\n} else {\n    // Display body for mail account\n    render_page($user, $TAB, 'edit_mail_acc');\n}\n\n// Flush session messages\nunset($_SESSION['error_msg']);\nunset($_SESSION['ok_msg']);\n", "<?php\n\nob_start();\nunset($_SESSION['error_msg']);\n$TAB = 'WEB';\n\n// Main include\ninclude($_SERVER['DOCUMENT_ROOT'].\"/inc/main.php\");\n\n// Check domain argument\nif (empty($_GET['domain'])) {\n    header(\"Location: /list/web/\");\n    exit;\n}\n\n// Edit as someone else?\nif (($_SESSION['userContext'] === 'admin') && (!empty($_GET['user']))) {\n    $user=escapeshellarg($_GET['user']);\n    $user_plain=htmlentities($_GET['user']);\n}\n\n// Get all user domains\nexec(HESTIA_CMD.\"v-list-web-domains \".$user.\" json\", $output, $return_var);\n$user_domains = json_decode(implode('', $output), true);\n$user_domains = array_keys($user_domains);\nunset($output);\n\n$v_domain = $_GET['domain'];\nexec(HESTIA_CMD.\"v-list-web-domain \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n# Check if domain exists if not return /list/web/\ncheck_return_code_redirect($return_var, $output, '/list/web/');\n$data = json_decode(implode('', $output), true);\nunset($output);\n\n// Parse domain\n$v_ip = $data[$v_domain]['IP'];\n$v_template = $data[$v_domain]['TPL'];\n$v_aliases = str_replace(',', \"\\n\", $data[$v_domain]['ALIAS']);\n$valiases = explode(\",\", $data[$v_domain]['ALIAS']);\n\n$v_tpl = $data[$v_domain]['IP'];\n$v_cgi = $data[$v_domain]['CGI'];\n$v_elog = $data[$v_domain]['ELOG'];\n$v_ssl = $data[$v_domain]['SSL'];\nif (!empty($v_ssl)) {\n    exec(HESTIA_CMD.\"v-list-web-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n    $ssl_str = json_decode(implode('', $output), true);\n    unset($output);\n    $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n    $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n    $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n    $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n    $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n    $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n    $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n    $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n    $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n    $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n    $v_ssl_forcessl = $data[$v_domain]['SSL_FORCE'];\n    $v_ssl_hsts = $data[$v_domain]['SSL_HSTS'];\n}\n$v_letsencrypt = $data[$v_domain]['LETSENCRYPT'];\nif (empty($v_letsencrypt)) {\n    $v_letsencrypt = 'no';\n}\n$v_ssl_home = $data[$v_domain]['SSL_HOME'];\n$v_backend_template = $data[$v_domain]['BACKEND'];\n$v_nginx_cache = $data[$v_domain]['FASTCGI_CACHE'];\n$v_nginx_cache_duration = $data[$v_domain]['FASTCGI_DURATION'];\n$v_nginx_cache_check = '';\nif (empty($v_nginx_cache_duration)) {\n    $v_nginx_cache_duration = '2m';\n    $v_nginx_cache_check = '';\n} else {\n    $v_nginx_cache_check = 'on';\n}\n$v_proxy = $data[$v_domain]['PROXY'];\n$v_proxy_template = $data[$v_domain]['PROXY'];\n$v_proxy_ext = str_replace(',', ', ', $data[$v_domain]['PROXY_EXT']);\n$v_stats = $data[$v_domain]['STATS'];\n$v_stats_user = $data[$v_domain]['STATS_USER'];\nif (!empty($v_stats_user)) {\n    $v_stats_password = \"\";\n}\n$v_custom_doc_root_prepath = '/home/'.$user_plain.'/web/';\n\nif (!empty($data[$v_domain]['CUSTOM_DOCROOT'])) {\n    $v_custom_doc_root = realpath($data[$v_domain]['CUSTOM_DOCROOT']) . DIRECTORY_SEPARATOR;\n}\n\nif (!empty($v_custom_doc_root) &&\n    false !== preg_match('/\\/home\\/'.$user_plain.'\\/web\\/([[:alnum:]].*?)\\/public_html\\/([[:alnum:]].*)?/', $v_custom_doc_root, $matches)) {\n    // Regex for extracting target web domain and custom document root. Regex test: https://regex101.com/r/2CLvIF/1\n\n    if (!empty($matches[1])) {\n        $v_custom_doc_domain = $matches[1];\n    }\n\n    if (!empty($matches[2])) {\n        $v_custom_doc_folder = rtrim($matches[2], '/');\n    }\n\n    if ($v_custom_doc_domain && !in_array($v_custom_doc_domain, $user_domains)) {\n        $v_custom_doc_domain = '';\n        $v_custom_doc_folder = '';\n    }\n}\n\n$redirect_code_options = array(301,302);\n$v_redirect = $data[$v_domain]['REDIRECT'];\n$v_redirect_code = $data[$v_domain]['REDIRECT_CODE'];\nif (!in_array($v_redirect, array('www.'.$v_domain, $v_domain))) {\n    $v_redirect_custom = $v_redirect;\n}\n\n$v_ftp_user = $data[$v_domain]['FTP_USER'];\n$v_ftp_path = $data[$v_domain]['FTP_PATH'];\nif (!empty($v_ftp_user)) {\n    $v_ftp_password = \"\";\n}\n\nif ($v_custom_doc_domain != '') {\n    $v_ftp_user_prepath = '/home/'.$user_plain.'/web/'.$v_custom_doc_domain;\n} else {\n    $v_ftp_user_prepath = '/home/'.$user_plain.'/web/'.$v_domain;\n}\n\n\n$v_ftp_email = $panel[$user]['CONTACT'];\n$v_suspended = $data[$v_domain]['SUSPENDED'];\nif ($v_suspended == 'yes') {\n    $v_status =  'suspended';\n} else {\n    $v_status =  'active';\n}\n$v_time = $data[$v_domain]['TIME'];\n$v_date = $data[$v_domain]['DATE'];\n\n// List ip addresses\nexec(HESTIA_CMD.\"v-list-user-ips \".$user.\" json\", $output, $return_var);\n$ips = json_decode(implode('', $output), true);\nunset($output);\n\n$v_ip_public = empty($ips[$v_ip]['NAT']) ? $v_ip : $ips[$v_ip]['NAT'];\n\n// List web templates\nexec(HESTIA_CMD.\"v-list-web-templates json\", $output, $return_var);\n$templates = json_decode(implode('', $output), true);\nunset($output);\n\n// List backend templates\nif (!empty($_SESSION['WEB_BACKEND'])) {\n    exec(HESTIA_CMD.\"v-list-web-templates-backend json\", $output, $return_var);\n    $backend_templates = json_decode(implode('', $output), true);\n    unset($output);\n}\n\n// List proxy templates\nif (!empty($_SESSION['PROXY_SYSTEM'])) {\n    exec(HESTIA_CMD.\"v-list-web-templates-proxy json\", $output, $return_var);\n    $proxy_templates = json_decode(implode('', $output), true);\n    unset($output);\n}\n\n// List web stat engines\nexec(HESTIA_CMD.\"v-list-web-stats json\", $output, $return_var);\n$stats = json_decode(implode('', $output), true);\nunset($output);\n\n// Check POST request\nif (!empty($_POST['save'])) {\n    $v_domain = $_POST['v_domain'];\n    if (!in_array($v_domain, $user_domains)) {\n        check_return_code(3, [\"Unknown domain\"]);\n    }\n    // Check token\n    verify_csrf($_POST);\n\n    // Change web domain IP\n    $v_newip='';\n    $v_newip_public='';\n\n    if (!empty($_POST['v_ip'])) {\n        $v_newip = $_POST['v_ip'];\n        $v_newip_public = empty($ips[$v_newip]['NAT']) ? $v_newip : $ips[$v_newip]['NAT'];\n    }\n\n    if (($v_ip != $_POST['v_ip']) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-change-web-domain-ip \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($_POST['v_ip']).\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n        unset($output);\n    }\n\n    // Change dns domain IP\n    if (($v_ip != $_POST['v_ip']) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-list-dns-domain \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n        unset($output);\n        if ($return_var == 0) {\n            exec(HESTIA_CMD.\"v-change-dns-domain-ip \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_newip_public).\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $restart_dns = 'yes';\n        }\n    }\n\n    // Change dns ip for each alias\n    if (($v_ip != $_POST['v_ip']) && (empty($_SESSION['error_msg']))) {\n        foreach ($valiases as $v_alias) {\n            exec(HESTIA_CMD.\"v-list-dns-domain \".$user.\" \".escapeshellarg($v_alias).\" json\", $output, $return_var);\n            unset($output);\n            if ($return_var == 0) {\n                exec(HESTIA_CMD.\"v-change-dns-domain-ip \".$user.\" \".escapeshellarg($v_alias).\" \".escapeshellarg($v_newip_public), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n                $restart_dns = 'yes';\n            }\n        }\n    }\n\n    // Change mail domain IP\n    if (($v_ip != $_POST['v_ip']) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-list-mail-domain \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n        unset($output);\n        if ($return_var == 0) {\n            exec(HESTIA_CMD.\"v-rebuild-mail-domain \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $restart_email = 'yes';\n        }\n    }\n\n\n    if (($_SESSION['POLICY_USER_EDIT_WEB_TEMPLATES'] == 'yes') || ($_SESSION['userContext'] === \"admin\")) {\n        // Change template\n        if (($v_template != $_POST['v_template']) && (empty($_SESSION['error_msg']))) {\n            exec(HESTIA_CMD.\"v-change-web-domain-tpl \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($_POST['v_template']).\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $restart_web = 'yes';\n        }\n\n        // Change backend template\n        if ((!empty($_SESSION['WEB_BACKEND'])) && ($v_backend_template != $_POST['v_backend_template'])  && (empty($_SESSION['error_msg']))) {\n            $v_backend_template = $_POST['v_backend_template'];\n            exec(HESTIA_CMD.\"v-change-web-domain-backend-tpl \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_backend_template), $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n        }\n\n        // Enable/Disable nginx cache\n        if (($_SESSION['WEB_SYSTEM'] == 'nginx') && ($v_nginx_cache_check != $_POST['v_nginx_cache_check']) || ($v_nginx_cache_duration != $_POST['v_nginx_cache_duration'] && $_POST['v_nginx_cache'] = \"yes\") && (empty($_SESSION['error_msg']))) {\n            if ($_POST['v_nginx_cache_check'] == 'on') {\n                if (empty($_POST['v_nginx_cache_duration'])) {\n                    $_POST['v_nginx_cache_duration'] = \"2m\";\n                }\n                exec(HESTIA_CMD.\"v-add-fastcgi-cache \".$user.\" \".escapeshellarg($v_domain).' '. escapeshellarg($_POST['v_nginx_cache_duration']), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            } else {\n                exec(HESTIA_CMD.\"v-delete-fastcgi-cache \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n            }\n            $restart_web = 'yes';\n        }\n\n        // Delete proxy support\n        if ((!empty($_SESSION['PROXY_SYSTEM'])) && (!empty($v_proxy)) && (empty($_POST['v_proxy'])) && (empty($_SESSION['error_msg']))) {\n            exec(HESTIA_CMD.\"v-delete-web-domain-proxy \".$user.\" \".escapeshellarg($v_domain).\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            unset($v_proxy);\n            $restart_web = 'yes';\n        }\n\n        // Change proxy template / Update extension list\n        if ((!empty($_SESSION['PROXY_SYSTEM'])) && (!empty($v_proxy)) && (!empty($_POST['v_proxy'])) && (empty($_SESSION['error_msg']))) {\n            $ext = preg_replace(\"/\\n/\", \" \", $_POST['v_proxy_ext']);\n            $ext = preg_replace(\"/,/\", \" \", $ext);\n            $ext = preg_replace('/\\s+/', ' ', $ext);\n            $ext = trim($ext);\n            $ext = str_replace(' ', \", \", $ext);\n            if (($v_proxy_template != $_POST['v_proxy_template']) || ($v_proxy_ext != $ext)) {\n                $ext = str_replace(', ', \",\", $ext);\n                if (!empty($_POST['v_proxy_template'])) {\n                    $v_proxy_template = $_POST['v_proxy_template'];\n                }\n                exec(HESTIA_CMD.\"v-change-web-domain-proxy-tpl \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_proxy_template).\" \".escapeshellarg($ext).\" 'no'\", $output, $return_var);\n                check_return_code($return_var, $output);\n                $v_proxy_ext = str_replace(',', ', ', $ext);\n                unset($output);\n                $restart_proxy = 'yes';\n            }\n        }\n\n        // Add proxy support\n        if ((!empty($_SESSION['PROXY_SYSTEM'])) && (empty($v_proxy)) && (!empty($_POST['v_proxy'])) && (empty($_SESSION['error_msg']))) {\n            $v_proxy_template = $_POST['v_proxy_template'];\n            if (!empty($_POST['v_proxy_ext'])) {\n                $ext = preg_replace(\"/\\n/\", \" \", $_POST['v_proxy_ext']);\n                $ext = preg_replace(\"/,/\", \" \", $ext);\n                $ext = preg_replace('/\\s+/', ' ', $ext);\n                $ext = trim($ext);\n                $ext = str_replace(' ', \",\", $ext);\n                $v_proxy_ext = str_replace(',', ', ', $ext);\n            }\n            exec(HESTIA_CMD.\"v-add-web-domain-proxy \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_proxy_template).\" \".escapeshellarg($ext).\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $restart_proxy = 'yes';\n        }\n    }\n    // Change aliases\n    if (empty($_SESSION['error_msg'])) {\n        $waliases = preg_replace(\"/\\n/\", \" \", $_POST['v_aliases']);\n        $waliases = preg_replace(\"/,/\", \" \", $waliases);\n        $waliases = preg_replace('/\\s+/', ' ', $waliases);\n        $waliases = trim($waliases);\n        $aliases = explode(\" \", $waliases);\n        $v_aliases = str_replace(' ', \"\\n\", $waliases);\n        $result = array_diff($valiases, $aliases);\n        foreach ($result as $alias) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($alias))) {\n                $restart_web = 'yes';\n                $restart_proxy = 'yes';\n                exec(HESTIA_CMD.\"v-delete-web-domain-alias \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($alias).\" 'no'\", $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n\n                if (empty($_SESSION['error_msg'])) {\n                    exec(HESTIA_CMD.\"v-list-dns-domain \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n                    unset($output);\n                    if ($return_var == 0) {\n                        exec(HESTIA_CMD.\"v-delete-dns-on-web-alias \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($alias).\" 'no'\", $output, $return_var);\n                        check_return_code($return_var, $output);\n                        unset($output);\n                        $restart_dns = 'yes';\n                    }\n                }\n            }\n        }\n\n        $result = array_diff($aliases, $valiases);\n        foreach ($result as $alias) {\n            if ((empty($_SESSION['error_msg'])) && (!empty($alias))) {\n                $restart_web = 'yes';\n                $restart_proxy = 'yes';\n                exec(HESTIA_CMD.\"v-add-web-domain-alias \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($alias).\" 'no'\", $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n                if (empty($_SESSION['error_msg'])) {\n                    exec(HESTIA_CMD.\"v-list-dns-domain \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n                    unset($output);\n                    if ($return_var == 0) {\n                        exec(HESTIA_CMD.\"v-add-dns-on-web-alias \".$user.\" \".escapeshellarg($alias).\" \".escapeshellarg($v_newip_public ?: $v_ip_public).\" no\", $output, $return_var);\n                        check_return_code($return_var, $output);\n                        unset($output);\n                        $restart_dns = 'yes';\n                    }\n                }\n            }\n        }\n\n        // Regenerate LE if aliases are different\n        if ((!empty($_POST['v_ssl'])) && ($v_letsencrypt == 'yes') && (!empty($_POST['v_letsencrypt'])) && empty($_SESSION['error_msg'])) {\n\n        // If aliases are different from stored aliases\n            if (array_diff($valiases, $aliases) || array_diff($aliases, $valiases)) {\n\n            // Add certificate with new aliases\n                $l_aliases = str_replace(\"\\n\", ',', $v_aliases);\n                exec(HESTIA_CMD.\"v-add-letsencrypt-domain \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($l_aliases).\" ''\", $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n                $v_letsencrypt = 'yes';\n                $v_ssl = 'yes';\n                $restart_web = 'yes';\n                $restart_proxy = 'yes';\n\n                exec(HESTIA_CMD.\"v-list-web-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n                $ssl_str = json_decode(implode('', $output), true);\n                unset($output);\n                $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n                $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n                $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n                $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n                $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n                $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n                $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n                $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n                $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n                $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n            }\n        }\n\n        if ((!empty($v_stats)) && ($_POST['v_stats'] == $v_stats) && (empty($_SESSION['error_msg']))) {\n            // Update statistics configuration when changing domain aliases\n            $v_stats = escapeshellarg($_POST['v_stats']);\n            exec(HESTIA_CMD.\"v-change-web-domain-stats \".$user.\" \".escapeshellarg($v_domain).\" \".$v_stats, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n        }\n    }\n\n    // Change document root for ssl domain\n    if (($v_ssl == 'yes') && (!empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        if ($v_ssl_home != $_POST['v_ssl_home']) {\n            $v_ssl_home = escapeshellarg($_POST['v_ssl_home']);\n            exec(HESTIA_CMD.\"v-change-web-domain-sslhome \".$user.\" \".escapeshellarg($v_domain).\" \".$v_ssl_home.\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            $v_ssl_home = $_POST['v_ssl_home'];\n            $restart_web = 'yes';\n            $restart_proxy = 'yes';\n            unset($output);\n        }\n    }\n\n    // Change SSL certificate\n    if (($v_letsencrypt == 'no') && (empty($_POST['v_letsencrypt'])) && ($v_ssl == 'yes') && (!empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        if (($v_ssl_crt != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_crt'])) || ($v_ssl_key != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_key'])) || ($v_ssl_ca != str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_ca']))) {\n            exec('mktemp -d', $mktemp_output, $return_var);\n            $tmpdir = $mktemp_output[0];\n\n            // Certificate\n            if (!empty($_POST['v_ssl_crt'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".crt\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_crt']));\n                fwrite($fp, \"\\n\");\n                fclose($fp);\n            }\n\n            // Key\n            if (!empty($_POST['v_ssl_key'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".key\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_key']));\n                fwrite($fp, \"\\n\");\n                fclose($fp);\n            }\n\n            // CA\n            if (!empty($_POST['v_ssl_ca'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".ca\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_ca']));\n                fwrite($fp, \"\\n\");\n                fclose($fp);\n            }\n\n            exec(HESTIA_CMD.\"v-change-web-domain-sslcert \".$user.\" \".escapeshellarg($v_domain).\" \".$tmpdir.\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $restart_web = 'yes';\n            $restart_proxy = 'yes';\n\n            exec(HESTIA_CMD.\"v-list-web-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n            $ssl_str = json_decode(implode('', $output), true);\n            unset($output);\n            $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n            $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n            $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n            $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n            $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n            $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n            $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n            $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n            $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n            $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n\n            // Cleanup certificate tempfiles\n            if (!empty($_POST['v_ssl_crt'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".crt\");\n            }\n            if (!empty($_POST['v_ssl_key'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".key\");\n            }\n            if (!empty($_POST['v_ssl_ca'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".ca\");\n            }\n            rmdir($tmpdir);\n        }\n    }\n\n    // Delete Lets Encrypt support\n    if (($v_letsencrypt == 'yes') && (empty($_POST['v_letsencrypt']) || empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-letsencrypt-domain \".$user.\" \".escapeshellarg($v_domain).\" ''\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_crt = '';\n        $v_ssl_key = '';\n        $v_ssl_ca = '';\n        $v_letsencrypt = 'no';\n        $v_letsencrypt_deleted = 'yes';\n        $v_ssl = 'no';\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Delete SSL certificate\n    if (($v_ssl == 'yes') && (empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-web-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" 'no'\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_crt = '';\n        $v_ssl_key = '';\n        $v_ssl_ca = '';\n        $v_ssl = 'no';\n        $v_ssl_forcessl = 'no';\n        $v_ssl_hsts = 'no';\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Add Lets Encrypt support\n    if ((!empty($_POST['v_ssl'])) && ($v_letsencrypt == 'no') && (!empty($_POST['v_letsencrypt'])) && empty($_SESSION['error_msg'])) {\n        $l_aliases = str_replace(\"\\n\", ',', $v_aliases);\n        exec(HESTIA_CMD.\"v-add-letsencrypt-domain \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($l_aliases).\" ''\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        if ($return_var != 0) {\n            $v_letsencrypt = 'no';\n        } else {\n            $v_letsencrypt = 'yes';\n        }\n        $v_ssl = 'yes';\n        if ($_POST['v_ssl_forcessl'] == 'on') {\n            $v_ssl_forcessl = 'yes';\n        } else {\n            $v_ssl_forcessl = 'no';\n        }\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Add SSL certificate\n    if (($v_ssl == 'no') && (!empty($_POST['v_ssl']))  && (empty($v_letsencrypt_deleted)) && (empty($_SESSION['error_msg']))) {\n        if (empty($_POST['v_ssl_crt'])) {\n            $errors[] = 'ssl certificate';\n        }\n        if (empty($_POST['v_ssl_key'])) {\n            $errors[] = 'ssl key';\n        }\n        if (empty($_POST['v_ssl_home'])) {\n            $errors[] = 'ssl home';\n        }\n        $v_ssl_home = escapeshellarg($_POST['v_ssl_home']);\n        if (!empty($errors[0])) {\n            foreach ($errors as $i => $error) {\n                if ($i == 0) {\n                    $error_msg = $error;\n                } else {\n                    $error_msg = $error_msg.\", \".$error;\n                }\n            }\n            $_SESSION['error_msg'] = _('Field \"%s\" can not be blank.', $error_msg);\n        } else {\n            exec('mktemp -d', $mktemp_output, $return_var);\n            $tmpdir = $mktemp_output[0];\n\n            // Certificate\n            if (!empty($_POST['v_ssl_crt'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".crt\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_crt']));\n                fclose($fp);\n            }\n\n            // Key\n            if (!empty($_POST['v_ssl_key'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".key\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_key']));\n                fclose($fp);\n            }\n\n            // CA\n            if (!empty($_POST['v_ssl_ca'])) {\n                $fp = fopen($tmpdir.\"/\".$v_domain.\".ca\", 'w');\n                fwrite($fp, str_replace(\"\\r\\n\", \"\\n\", $_POST['v_ssl_ca']));\n                fclose($fp);\n            }\n            exec(HESTIA_CMD.\"v-add-web-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" \".$tmpdir.\" \".$v_ssl_home.\" 'no'\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $v_ssl = 'yes';\n            $restart_web = 'yes';\n            $restart_proxy = 'yes';\n\n            exec(HESTIA_CMD.\"v-list-web-domain-ssl \".$user.\" \".escapeshellarg($v_domain).\" json\", $output, $return_var);\n            $ssl_str = json_decode(implode('', $output), true);\n            unset($output);\n            $v_ssl_crt = $ssl_str[$v_domain]['CRT'];\n            $v_ssl_key = $ssl_str[$v_domain]['KEY'];\n            $v_ssl_ca = $ssl_str[$v_domain]['CA'];\n            $v_ssl_subject = $ssl_str[$v_domain]['SUBJECT'];\n            $v_ssl_aliases = $ssl_str[$v_domain]['ALIASES'];\n            $v_ssl_not_before = $ssl_str[$v_domain]['NOT_BEFORE'];\n            $v_ssl_not_after = $ssl_str[$v_domain]['NOT_AFTER'];\n            $v_ssl_signature = $ssl_str[$v_domain]['SIGNATURE'];\n            $v_ssl_pub_key = $ssl_str[$v_domain]['PUB_KEY'];\n            $v_ssl_issuer = $ssl_str[$v_domain]['ISSUER'];\n\n            // Cleanup certificate tempfiles\n            if (!empty($_POST['v_ssl_crt'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".crt\");\n            }\n            if (!empty($_POST['v_ssl_key'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".key\");\n            }\n            if (!empty($_POST['v_ssl_ca'])) {\n                unlink($tmpdir.\"/\".$v_domain.\".ca\");\n            }\n            rmdir($tmpdir);\n        }\n    }\n\n    // Add Force SSL\n    if ((!empty($_POST['v_ssl_forcessl'])) && (!empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-add-web-domain-ssl-force \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_forcessl = 'yes';\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Add SSL HSTS\n    if ((!empty($_POST['v_ssl_hsts'])) && (!empty($_POST['v_ssl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-add-web-domain-ssl-hsts \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_hsts = 'yes';\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Delete Force SSL\n    if (($v_ssl_forcessl == 'yes') && (empty($_POST['v_ssl_forcessl'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-web-domain-ssl-force \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_forcessl = 'no';\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Delete SSL HSTS\n    if (($v_ssl_hsts == 'yes') && (empty($_POST['v_ssl_hsts'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-web-domain-ssl-hsts \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_ssl_hsts = 'no';\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    // Delete web stats\n    if ((!empty($v_stats)) && ($_POST['v_stats'] == 'none') && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-web-domain-stats \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_stats = '';\n    }\n\n    // Change web stats engine\n    if ((!empty($v_stats)) && ($_POST['v_stats'] != $v_stats) && (empty($_SESSION['error_msg']))) {\n        $v_stats = escapeshellarg($_POST['v_stats']);\n        exec(HESTIA_CMD.\"v-change-web-domain-stats \".$user.\" \".escapeshellarg($v_domain).\" \".$v_stats, $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Add web stats\n    if ((empty($v_stats)) && ($_POST['v_stats'] != 'none') && (empty($_SESSION['error_msg']))) {\n        $v_stats = escapeshellarg($_POST['v_stats']);\n        exec(HESTIA_CMD.\"v-add-web-domain-stats \".$user.\" \".escapeshellarg($v_domain).\" \".$v_stats, $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Delete web stats authorization\n    if ((!empty($v_stats_user)) && (empty($_POST['v_stats_auth'])) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-delete-web-domain-stats-user \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        $v_stats_user = '';\n        $v_stats_password = '';\n    }\n\n    // Change web stats user or password\n    if ((empty($v_stats_user)) && (!empty($_POST['v_stats_auth'])) && (empty($_SESSION['error_msg']))) {\n        if (empty($_POST['v_stats_user'])) {\n            $errors[] = _('stats username');\n        }\n        if (!empty($errors[0])) {\n            foreach ($errors as $i => $error) {\n                if ($i == 0) {\n                    $error_msg = $error;\n                } else {\n                    $error_msg = $error_msg.\", \".$error;\n                }\n            }\n            $_SESSION['error_msg'] = _('Field \"%s\" can not be blank.', $error_msg);\n        } else {\n            $v_stats_user = escapeshellarg($_POST['v_stats_user']);\n            $v_stats_password = tempnam(\"/tmp\", \"vst\");\n            $fp = fopen($v_stats_password, \"w\");\n            fwrite($fp, $_POST['v_stats_password'].\"\\n\");\n            fclose($fp);\n            exec(HESTIA_CMD.\"v-add-web-domain-stats-user \".$user.\" \".escapeshellarg($v_domain).\" \".$v_stats_user.\" \".$v_stats_password, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            unlink($v_stats_password);\n            $v_stats_password = escapeshellarg($_POST['v_stats_password']);\n        }\n    }\n\n    // Add web stats authorization\n    if ((!empty($v_stats_user)) && (!empty($_POST['v_stats_auth'])) && (empty($_SESSION['error_msg']))) {\n        if (empty($_POST['v_stats_user'])) {\n            $errors[] = _('stats user');\n        }\n        if (!empty($errors[0])) {\n            foreach ($errors as $i => $error) {\n                if ($i == 0) {\n                    $error_msg = $error;\n                } else {\n                    $error_msg = $error_msg.\", \".$error;\n                }\n            }\n            $_SESSION['error_msg'] = _('Field \"%s\" can not be blank.', $error_msg);\n        }\n        if (($v_stats_user != $_POST['v_stats_user']) || (!empty($_POST['v_stats_password'])) && (empty($_SESSION['error_msg']))) {\n            $v_stats_user = escapeshellarg($_POST['v_stats_user']);\n            $v_stats_password = tempnam(\"/tmp\", \"vst\");\n            $fp = fopen($v_stats_password, \"w\");\n            fwrite($fp, $_POST['v_stats_password'].\"\\n\");\n            fclose($fp);\n            exec(HESTIA_CMD.\"v-add-web-domain-stats-user \".$user.\" \".escapeshellarg($v_domain).\" \".$v_stats_user.\" \".$v_stats_password, $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            unlink($v_stats_password);\n            $v_stats_password = escapeshellarg($_POST['v_stats_password']);\n        }\n    }\n\n    // Update ftp account\n    if (!empty($_POST['v_ftp_user'])) {\n        $v_ftp_users_updated = array();\n        foreach ($_POST['v_ftp_user'] as $i => $v_ftp_user_data) {\n            if (empty($v_ftp_user_data['v_ftp_user'])) {\n                continue;\n            }\n\n            $v_ftp_user_data['v_ftp_user'] = preg_replace(\"/^\".$user.\"_/i\", \"\", $v_ftp_user_data['v_ftp_user']);\n            if ($v_ftp_user_data['is_new'] == 1 && !empty($_POST['v_ftp'])) {\n                if ((!empty($v_ftp_user_data['v_ftp_email'])) && (!filter_var($v_ftp_user_data['v_ftp_email'], FILTER_VALIDATE_EMAIL))) {\n                    $_SESSION['error_msg'] = _('Please enter valid email address.');\n                }\n                if (empty($v_ftp_user_data['v_ftp_user'])) {\n                    $errors[] = 'ftp user';\n                }\n                if (!empty($errors[0])) {\n                    foreach ($errors as $i => $error) {\n                        if ($i == 0) {\n                            $error_msg = $error;\n                        } else {\n                            $error_msg = $error_msg.\", \".$error;\n                        }\n                    }\n                    $_SESSION['error_msg'] = _('Field \"%s\" can not be blank.', $error_msg);\n                }\n\n                // Add ftp account\n                $v_ftp_username      = $v_ftp_user_data['v_ftp_user'];\n                $v_ftp_username_full = $user . '_' . $v_ftp_user_data['v_ftp_user'];\n                $v_ftp_user = escapeshellarg($v_ftp_username);\n                $v_ftp_path = escapeshellarg(trim($v_ftp_user_data['v_ftp_path']));\n                if (empty($_SESSION['error_msg'])) {\n                    $v_ftp_password = tempnam(\"/tmp\", \"vst\");\n                    $fp = fopen($v_ftp_password, \"w\");\n                    fwrite($fp, $v_ftp_user_data['v_ftp_password'].\"\\n\");\n                    fclose($fp);\n                    exec(HESTIA_CMD.\"v-add-web-domain-ftp \".$user.\" \".escapeshellarg($v_domain).\" \".$v_ftp_user.\" \".$v_ftp_password . \" \" . $v_ftp_path, $output, $return_var);\n                    check_return_code($return_var, $output);\n                    if ((!empty($v_ftp_user_data['v_ftp_email'])) && (empty($_SESSION['error_msg']))) {\n                        $to = $v_ftp_user_data['v_ftp_email'];\n                        $subject = _(\"FTP login credentials\");\n                        $hostname = exec('hostname');\n                        $from = \"noreply@\".$hostname;\n                        $from_name = _('Hestia Control Panel');\n                        $mailtext = sprintf(_('FTP_ACCOUNT_READY'), escapeshellarg($_GET['domain']), $user, $v_ftp_username, $v_ftp_user_data['v_ftp_password']);\n                        send_email($to, $subject, $mailtext, $from, $from_name);\n                        unset($v_ftp_email);\n                    }\n                    unset($output);\n                    unlink($v_ftp_password);\n                    $v_ftp_password = escapeshellarg($v_ftp_user_data['v_ftp_password']);\n                }\n\n                if ($return_var == 0) {\n                    $v_ftp_password = \"\";\n                    $v_ftp_user_data['is_new'] = 0;\n                } else {\n                    $v_ftp_user_data['is_new'] = 1;\n                }\n\n                $v_ftp_users_updated[] = array(\n                    'is_new'            => empty($_SESSION['error_msg']) ? 0 : 1,\n                    'v_ftp_user'        => $v_ftp_username_full,\n                    'v_ftp_password'    => $v_ftp_password,\n                    'v_ftp_path'        => $v_ftp_user_data['v_ftp_path'],\n                    'v_ftp_email'       => $v_ftp_user_data['v_ftp_email'],\n                    'v_ftp_pre_path'    => $v_ftp_user_prepath\n                );\n\n                continue;\n            }\n\n            // Delete FTP account\n            if ($v_ftp_user_data['delete'] == 1) {\n                $v_ftp_username = $user_plain . '_' . $v_ftp_user_data['v_ftp_user'];\n                exec(HESTIA_CMD.\"v-delete-web-domain-ftp \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($v_ftp_username), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n\n                continue;\n            }\n\n            if (!empty($_POST['v_ftp'])) {\n                if (empty($v_ftp_user_data['v_ftp_user'])) {\n                    $errors[] = _('ftp user');\n                }\n                if (!empty($errors[0])) {\n                    foreach ($errors as $i => $error) {\n                        if ($i == 0) {\n                            $error_msg = $error;\n                        } else {\n                            $error_msg = $error_msg.\", \".$error;\n                        }\n                    }\n                    $_SESSION['error_msg'] = _('Field \"%s\" can not be blank.', $error_msg);\n                }\n\n                // Change FTP account path\n                $v_ftp_username_for_emailing = $v_ftp_user_data['v_ftp_user'];\n                $v_ftp_username = $user_plain . '_' . $v_ftp_user_data['v_ftp_user']; //preg_replace(\"/^\".$user.\"_/\", \"\", $v_ftp_user_data['v_ftp_user']);\n                $v_ftp_username = escapeshellarg($v_ftp_username);\n                $v_ftp_path = escapeshellarg(trim($v_ftp_user_data['v_ftp_path']));\n                if (escapeshellarg(trim($v_ftp_user_data['v_ftp_path_prev'])) != $v_ftp_path) {\n                    exec(HESTIA_CMD.\"v-change-web-domain-ftp-path \".$user.\" \".escapeshellarg($v_domain).\" \".$v_ftp_username.\" \".$v_ftp_path, $output, $return_var);\n                }\n\n                // Change FTP account password\n                if (!empty($v_ftp_user_data['v_ftp_password'])) {\n                    $v_ftp_password = tempnam(\"/tmp\", \"vst\");\n                    $fp = fopen($v_ftp_password, \"w\");\n                    fwrite($fp, $v_ftp_user_data['v_ftp_password'].\"\\n\");\n                    fclose($fp);\n                    exec(HESTIA_CMD.\"v-change-web-domain-ftp-password \".$user.\" \".escapeshellarg($v_domain).\" \".$v_ftp_username.\" \".$v_ftp_password, $output, $return_var);\n                    unlink($v_ftp_password);\n\n                    $to = $v_ftp_user_data['v_ftp_email'];\n                    $subject = _(\"FTP login credentials\");\n                    $hostname = exec('hostname');\n                    $from = \"noreply@\".$hostname;\n                    $from_name = _('Hestia Control Panel');\n                    $mailtext = _('FTP_ACCOUNT_READY', escapeshellarg($_GET['domain']), $user, $v_ftp_username_for_emailing, $v_ftp_user_data['v_ftp_password']);\n                    send_email($to, $subject, $mailtext, $from, $from_name);\n                    unset($v_ftp_email);\n                }\n                check_return_code($return_var, $output);\n                unset($output);\n\n                $v_ftp_users_updated[] = array(\n                    'is_new'            => 0,\n                    'v_ftp_user'        => $v_ftp_username,\n                    'v_ftp_password'    => $v_ftp_user_data['v_ftp_password'],\n                    'v_ftp_path'        => $v_ftp_user_data['v_ftp_path'],\n                    'v_ftp_email'       => $v_ftp_user_data['v_ftp_email'],\n                    'v_ftp_pre_path'    => $v_ftp_user_prepath\n                );\n            }\n        }\n    }\n    //custom docoot with check box disabled\n    if (!empty($v_custom_doc_root) && empty($_POST['v_custom_doc_root_check'])) {\n        exec(HESTIA_CMD.\"v-change-web-domain-docroot \".$user.\" \".escapeshellarg($v_domain).\" default\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        unset($_POST['v-custom-doc-domain'], $_POST['v-custom-doc-folder']);\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    if (!empty($_POST['v-custom-doc-domain']) && !empty($_POST['v_custom_doc_root_check']) && $v_custom_doc_root_prepath.$v_custom_doc_domain.'/public_html'.$v_custom_doc_folder != $v_custom_doc_root) {\n        if ($_POST['v-custom-doc-domain'] == $v_domain && empty($_POST['v-custom-doc-folder'])) {\n            exec(HESTIA_CMD.\"v-change-web-domain-docroot \".$user.\" \".escapeshellarg($v_domain).\" default\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n        } else {\n            $v_custom_doc_folder = escapeshellarg(rtrim($_POST['v-custom-doc-folder'], '/'));\n            $v_custom_doc_domain = escapeshellarg($_POST['v-custom-doc-domain']);\n\n            exec(HESTIA_CMD.\"v-change-web-domain-docroot \".$user.\" \".escapeshellarg($v_domain).\" \".$v_custom_doc_domain.\" \".$v_custom_doc_folder .\" yes\", $output, $return_var);\n            check_return_code($return_var, $output);\n            unset($output);\n            $v_custom_doc_root = 1;\n        }\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    } else {\n        unset($v_custom_doc_root);\n    }\n\n    if (!empty($v_redirect) && empty($_POST['v-redirect-checkbox'])) {\n        exec(HESTIA_CMD.\"v-delete-web-domain-redirect \".$user.\" \".escapeshellarg($v_domain), $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n        unset($_POST['v-redirect']);\n        $restart_web = 'yes';\n        $restart_proxy = 'yes';\n    }\n\n    if (!empty($_POST['v-redirect']) && !empty($_POST['v-redirect-checkbox'])) {\n        if (empty($v_redirect)) {\n            if ($_POST['v-redirect']  == 'custom' && empty($_POST['v-redirect-custom'])) {\n            } else {\n                if ($_POST['v-redirect']  == 'custom') {\n                    $_POST['v-redirect'] = $_POST['v-redirect-custom'];\n                }\n                exec(HESTIA_CMD.\"v-add-web-domain-redirect \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($_POST['v-redirect']).\" \".escapeshellarg($_POST['v-redirect-code']), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n                $restart_web = 'yes';\n                $restart_proxy = 'yes';\n            }\n        } else {\n            if ($_POST['v-redirect'] == 'custom') {\n                $_POST['v-redirect'] = $_POST['v-redirect-custom'];\n            }\n            if ($_POST['v-redirect'] != $v_redirect || $_POST['v-redirect-code'] != $v_redirect_code) {\n                exec(HESTIA_CMD.\"v-add-web-domain-redirect \".$user.\" \".escapeshellarg($v_domain).\" \".escapeshellarg($_POST['v-redirect']).\" \".escapeshellarg($_POST['v-redirect-code']), $output, $return_var);\n                check_return_code($return_var, $output);\n                unset($output);\n                $restart_web = 'yes';\n                $restart_proxy = 'yes';\n            }\n        }\n    }\n    // Restart web server\n    if (!empty($restart_web) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-restart-web\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Restart proxy server\n    if ((!empty($_SESSION['PROXY_SYSTEM'])) && !empty($restart_proxy) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-restart-proxy\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Restart dns server\n    if (!empty($restart_dns) && (empty($_SESSION['error_msg']))) {\n        exec(HESTIA_CMD.\"v-restart-dns\", $output, $return_var);\n        check_return_code($return_var, $output);\n        unset($output);\n    }\n\n    // Set success message\n    if (empty($_SESSION['error_msg'])) {\n        $_SESSION['ok_msg'] = _('Changes has been saved.');\n        header(\"Location: /edit/web/?domain=\" . $v_domain);\n        exit();\n    }\n}\n\n\n$v_ftp_users_raw = explode(':', $v_ftp_user);\n$v_ftp_users_paths_raw = explode(':', $data[$v_domain]['FTP_PATH']);\n$v_ftp_users = array();\nforeach ($v_ftp_users_raw as $v_ftp_user_index => $v_ftp_user_val) {\n    if (empty($v_ftp_user_val)) {\n        continue;\n    }\n    $v_ftp_users[] = array(\n        'is_new'            => 0,\n        'v_ftp_user'        => preg_replace(\"/^\".$user_plain.\"_/\", \"\", $v_ftp_user_val),\n        'v_ftp_password'    => $v_ftp_password,\n        'v_ftp_path'        => (isset($v_ftp_users_paths_raw[$v_ftp_user_index]) ? $v_ftp_users_paths_raw[$v_ftp_user_index] : ''),\n        'v_ftp_email'       => $v_ftp_email,\n        'v_ftp_pre_path'    => $v_ftp_user_prepath\n    );\n}\n\nif (empty($v_ftp_users)) {\n    $v_ftp_user = null;\n    $v_ftp_users[] = array(\n        'is_new'            => 1,\n        'v_ftp_user'        => '',\n        'v_ftp_password'    => '',\n        'v_ftp_path'        => (isset($v_ftp_users_paths_raw[$v_ftp_user_index]) ? $v_ftp_users_paths_raw[$v_ftp_user_index] : ''),\n        'v_ftp_email'       => '',\n        'v_ftp_pre_path'    => $v_ftp_user_prepath\n    );\n}\n\n// set default pre path for newly created users\n$v_ftp_pre_path_new_user = $v_ftp_user_prepath;\nif (isset($v_ftp_users_updated)) {\n    $v_ftp_users = $v_ftp_users_updated;\n    if (empty($v_ftp_users_updated)) {\n        $v_ftp_user = null;\n        $v_ftp_users[] = array(\n            'is_new'            => 1,\n            'v_ftp_user'        => '',\n            'v_ftp_password'    => '',\n            'v_ftp_path'        => (isset($v_ftp_users_paths_raw[$v_ftp_user_index]) ? $v_ftp_users_paths_raw[$v_ftp_user_index] : ''),\n            'v_ftp_email'       => '',\n            'v_ftp_pre_path'    => $v_ftp_user_prepath\n        );\n    }\n}\n\n// Render page\nrender_page($user, $TAB, 'edit_web');\n\n// Flush session messages\nunset($_SESSION['error_msg']);\nunset($_SESSION['ok_msg']);\n", "<!-- Begin toolbar -->\n<div class=\"l-center edit\">\n\t<div class=\"l-sort clearfix\">\n\t\t<div class=\"l-unit-toolbar__buttonstrip\">\n\t\t\t<a class=\"ui-button cancel\" dir=\"ltr\" id=\"btn-back\" href=\"/list/server/\"><i class=\"fas fa-arrow-left status-icon blue\"></i><?=_('Back');?></a>\n\t\t\t<a href=\"/list/ip/\" class=\"ui-button cancel\" dir=\"ltr\"><i class=\"fas fa-ethernet status-icon blue\"></i><?=_('IP');?></a>\n\t\t\t<?php if ((isset($_SESSION['FIREWALL_SYSTEM'])) && (!empty($_SESSION['FIREWALL_SYSTEM']))) {?>\n\t\t\t\t<a href=\"/list/firewall/\" class=\"ui-button cancel\" dir=\"ltr\"><i class=\"fas fa-shield-alt status-icon red\"></i><?=_('Firewall');?></a>\n\t\t\t<?php }?>\n\t\t</div>\n\t\t<div class=\"l-unit-toolbar__buttonstrip float-right\">\n\t\t\t<a href=\"#\" class=\"ui-button\" data-action=\"submit\" data-id=\"vstobjects\"><i class=\"fas fa-save status-icon purple\"></i><?=_('Save');?></a>\n\t\t</div>\n\t</div>\n</div>\n<!-- End toolbar -->\n\n<div class=\"l-separator\"></div>\n\n<div class=\"l-center animated fadeIn\">\n\n\t<form id=\"vstobjects\" name=\"v_configure_server\" method=\"post\">\n\t\t<input type=\"hidden\" name=\"token\" value=\"<?=$_SESSION['token']?>\" />\n\t\t<input type=\"hidden\" name=\"save\" value=\"save\" />\n\n\t\t<table class=\"data mode-add\">\n\t\t\t<tr class=\"data-add\">\n\t\t\t\t<td class=\"data-dotted\">\n\t\t\t\t\t<table class=\"data-col1\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</td>\n\t\t\t\t<td class=\"data-dotted\">\n\t\t\t\t\t<table class=\"data-col2\" width=\"600px\">\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"step-top\">\n\t\t\t\t\t\t\t\t<span class=\"page-title\"><?=_('Configuring Server');?></span>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<?php show_error_panel($_SESSION);?>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<!-- Basic options tab -->\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('basic');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-cog\"></i><b><?=_('Basic options');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_adv)) echo 'none';?> ;\" id=\"basic\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Hostname');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_hostname\" value=\"<?=htmlentities(trim($v_hostname, \"'\"))?>\">\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Time Zone');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_timezone\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\t\t\tforeach ($v_timezones as $key => $value) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\techo \"\\t\\t\\t\\t<option value=\\\"\".$key.\"\\\"\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ((!empty($v_timezone)) && ( $key == $v_timezone)){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\techo ' selected' ;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ((!empty($v_timezone)) && ( $key == $_POST['v_timezone'])){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\techo ' selected' ;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\techo \">\".$value.\"</option>\\n\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Theme');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_theme\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\t\t\tforeach ($theme as $key => $value) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\techo \"\\t\\t\\t\\t<option value=\\\"\".$value.\"\\\"\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ((!empty($_SESSION['THEME'])) && ( $value == $_SESSION['THEME'])){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\techo ' selected' ;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ((!empty($_SESSION['THEME'])) && ( $value == $_POST['v_theme'])){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\techo ' selected' ;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\techo \">\".$value.\"</option>\\n\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_policy_user_change_theme\" <?php if ((isset($_SESSION['POLICY_USER_CHANGE_THEME'])) && (!empty($_SESSION['POLICY_USER_CHANGE_THEME'])) && ($_SESSION['POLICY_USER_CHANGE_THEME'] == \"no\")) echo \"checked=yes\" ?>><?=_('Set as selected theme for all users');?></label>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Default Language');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_language\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t\t\t\t\tforeach ($languages as $key => $value) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\techo \"\\n\\t\\t\\t\\t\\t\\t\\t\\t\\t<option value=\\\"\".$key.\"\\\"\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ( $key == $v_language ){\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\techo 'selected' ;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (( $key == $_SESSION['LANGUAGE'] && (empty($v_language)) )) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\techo 'selected' ;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\techo \">\".htmlentities($value).\"</option>\\n\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_language_update\"><?=_('Set as default language for all users');?></label>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<!-- Updates tab -->\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('version');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-code-branch\"></i><b><?=_('Updates');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_adv)) echo 'none';?> ;\" id=\"version\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Version'); ?>: <span class=\"optional\"><?=$_SESSION['VERSION'];?></span>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php if ($_SESSION['RELEASE_BRANCH'] !== 'release') {?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Release'); ?>: <span class=\"optional\"><?=$_SESSION['RELEASE_BRANCH'];?></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Options'); ?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_debug_mode\" <?php if ((isset($_SESSION['DEBUG_MODE'])) && (!empty($_SESSION['DEBUG_MODE'])) && ($_SESSION['DEBUG_MODE'] == \"true\")) echo \"checked=yes\" ?>><?=_('Enable debug mode');?></label>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_experimental_features\" <?php if ((isset($_SESSION['POLICY_SYSTEM_ENABLE_BACON'])) && (!empty($_SESSION['POLICY_SYSTEM_ENABLE_BACON'])) && ($_SESSION['POLICY_SYSTEM_ENABLE_BACON'] == \"true\")) echo \"checked=yes\" ?>><?=_('Enable preview features');?></label> <span class=\"hint\">(<a href=\"/list/server/preview/\"><?=_('View');?></a>)</span>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_upgrade_send_notification_email\" <?php if ((isset($_SESSION['UPGRADE_SEND_EMAIL'])) && (!empty($_SESSION['UPGRADE_SEND_EMAIL'])) && ($_SESSION['UPGRADE_SEND_EMAIL'] == \"true\")) echo \"checked=yes\" ?>><?=_('SYSTEM_UPGRADE_SEND_NOTIFICATION_EMAIL');?></label>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_upgrade_send_email_log\" <?php if ((isset($_SESSION['UPGRADE_SEND_EMAIL_LOG'])) && (!empty($_SESSION['UPGRADE_SEND_EMAIL_LOG'])) && ($_SESSION['UPGRADE_SEND_EMAIL_LOG'] == \"true\")) echo \"checked=yes\" ?>><?=_('SYSTEM_UPGRADE_SEND_EMAIL_LOG');?></label>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t<!-- Web Server tab -->\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('web');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-globe-americas\"></i><b><?=_('Web Server');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_adv)) echo 'none';?> ;\" id=\"web\" class=\"step-top\">\n\t\t\t\t\t\t\t\t\t<?php if (!empty($_SESSION['PROXY_SYSTEM'])) { ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Proxy Server');?>: <span class=\"optional\"><?=$_SESSION['PROXY_SYSTEM']; ?> <a href=\"/edit/server/<? echo $_SESSION['PROXY_SYSTEM'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t<?php if (!empty($_SESSION['WEB_SYSTEM'])) { ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Web Server');?>: <span class=\"optional\"><?=$_SESSION['WEB_SYSTEM']; ?> <a href=\"/edit/server/<? echo $_SESSION['WEB_SYSTEM'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t<?php if (!empty($_SESSION['WEB_BACKEND'])) { ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Backend Server');?>: <span class=\"optional\"><?=$_SESSION['WEB_BACKEND']; ?> <a href=\"/edit/server/<? echo $_SESSION['WEB_BACKEND'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t<?php if (!empty($_SESSION['WEB_BACKEND_POOL'])) { ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Backend Pool Mode');?>: <span class=\"optional\"><?=$_SESSION['WEB_BACKEND_POOL']; ?></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t<?php if(count($v_php_versions)): ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Enabled multi PHP versions');?>\n\n\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"alert alert-info alert-with-icon\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-info\"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Please wait while php is installed or removed');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php foreach($v_php_versions as $php_version): ?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$php_version->installed?'checked':''; ?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$php_version->protected?'disabled':''; ?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"<?=$php_version->name?>\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname=\"v_php_versions[<?=$php_version->tpl?>]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<label for=\"<?=$php_version->name?>\"><?=$php_version->name?></label>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<?php foreach($php_version->usedby as $wd_user => $wd_domains ): ?>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php foreach($wd_domains as $wd_domain ): ?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\" style=\"border: 1px lightgrey; padding:0 10px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-user\"></i>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$wd_user;?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span class=\"optional\" style=\"float:right\"><?=$wd_domain;?></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php endforeach; ?>\n\t\t\t\t\t\t\t\t\t\t\t<?php endforeach; ?>\n\t\t\t\t\t\t\t\t\t\t<?php endforeach; ?>\n\t\t\t\t\t\t\t\t\t<?php endif; ?>\n\t\t\t\t\t\t\t\t\t<?php if(!empty($_SESSION['WEB_BACKEND'])){\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('System PHP version');?></span>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_php_default_version\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php foreach($v_php_versions as $php_version){\n\t\t\t\t\t\t\t\t\t\t\t\tif($php_version -> installed){\n\t\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"<?=$php_version->version; ?>\" <?php if($php_version->name == DEFAULT_PHP_VERSION){ echo \"selected\" ;}?> ><?=$php_version->name; ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php\t\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<!-- DNS Server tab -->\n\t\t\t\t\t\t<?php if (!empty($_SESSION['DNS_SYSTEM'])) { ?>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('dns');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-atlas\"></i><b><?=_('DNS Server');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_adv)) echo 'none';?> ;\" id=\"dns\">\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('DNS Server');?>: <span class=\"optional\"><?=$_SESSION['DNS_SYSTEM']; ?> <a href=\"/edit/server/<? echo $_SESSION['DNS_SYSTEM'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('DNS Cluster');?>: <span class=\"optional\"><?php if ($v_dns_cluster == 'yes') { echo _('Yes'); } else { echo _('No'); } ?></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php if ($v_dns_cluster == 'yes') {\n\t\t\t\t\t\t\t\t\t\t\t$i = 0;\n\t\t\t\t\t\t\t\t\t\t\tforeach ($dns_cluster as $key => $value) {\n\t\t\t\t\t\t\t\t\t\t\t\t$i++;\n\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Host'). ' #'.$i  ?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_dns_remote_host\" value=\"<?=$key; ?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php } } ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td><br></td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t<!-- Mail Server tab -->\n\t\t\t\t\t\t<?php if ((!empty($_SESSION['MAIL_SYSTEM']))) { ?>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('mail');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-mail-bulk\"></i><b><?=_('Mail Server');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_mail_adv)) echo 'none';?> ;\" id=\"mail\">\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Mail Server');?>: <span class=\"optional\"><?=$_SESSION['MAIL_SYSTEM']; ?> <a href=\"/edit/server/<? echo $_SESSION['MAIL_SYSTEM'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php if (!empty($_SESSION['ANTIVIRUS_SYSTEM'])) { ?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Antivirus');?>: <span class=\"optional\"><?=$_SESSION['ANTIVIRUS_SYSTEM']; ?> <a href=\"/edit/server/<? echo $_SESSION['ANTIVIRUS_SYSTEM'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t<?php if (!empty($_SESSION['ANTISPAM_SYSTEM'])) { ?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('AntiSpam');?>: <span class=\"optional\"><?=$_SESSION['ANTISPAM_SYSTEM']; ?> <a href=\"/edit/server/<? echo $_SESSION['ANTISPAM_SYSTEM'] ?>/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a></span>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t<?php if($_SESSION['WEBMAIL_SYSTEM']){?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Webmail URL');?> <span class=\"hint\">(<?=$_SESSION['WEBMAIL_ALIAS'];?>.example.com)</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_webmail_alias\" value=\"<?=$_SESSION['WEBMAIL_ALIAS']; ?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t<label>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_smtp_relay\" <?php if ($v_smtp_relay == 'true') echo \"checked=yes\"; ?> onclick=\"javascript:elementHideShow('smtp_relay_table');\"><?=_('Global SMTP Relay');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t<table style=\"display:<?php if ($v_smtp_relay == 'true') {echo 'block';} else {echo 'none';} ?>;\" id=\"smtp_relay_table\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"input-label vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Host');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_smtp_relay_host\" value=\"<?=htmlentities(trim($v_smtp_relay_host, \"'\"))?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"input-label vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Port');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_smtp_relay_port\" value=\"<?=htmlentities(trim($v_smtp_relay_port, \"'\"))?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"input-label vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Username');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_smtp_relay_user\" value=\"<?=htmlentities(trim($v_smtp_relay_user, \"'\"))?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"input-label vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Password');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input password\" name=\"v_smtp_relay_pass\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t<!-- Databases tab -->\n\t\t\t\t\t\t<?php if (!empty($_SESSION['DB_SYSTEM'])) { ?>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('db');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-database\"></i><b><?=_('Databases');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_db_adv)) echo 'none';?> ;\" id=\"db\">\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('MySQL Support');?> <a href=\"/edit/server/mysql/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_mysql\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($v_mysql == 'yes') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t\t\t\t<!-- MySQL / MariaDB Options-->\n\t\t\t\t\t\t\t\t\t\t<?php if ($v_mysql == 'yes') { ?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('phpMyAdmin URL');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_mysql_url\" value=\"<?=$_SESSION['DB_PMA_ALIAS']; ?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('phpMyAdmin Single Sign On');?><span class=\"hint\">(<a href=\"https://docs.hestiacp.com/admin_docs/database/phpmyadmin-sso.html\" target=\"_blank\"><?=_('More info');?>)</span>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_phpmyadmin_key\" <?php if ($_SESSION['API'] != 'yes'){ echo \"disabled\"; }?>>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no'><?=_('Disabled'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_POST['v_phpmyadmin_key'] == \"yes\" || $_SESSION['PHPMYADMIN_KEY'] != ''){ echo 'selected=\"selected\"'; }; ?>><?=_('Enabled'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t<?php if ($v_mysql == 'yes') {\n\t\t\t\t\t\t\t\t\t\t\t$i = 0;\n\t\t\t\t\t\t\t\t\t\t\tforeach ($v_mysql_hosts as $value) {\n\t\t\t\t\t\t\t\t\t\t\t\t$i++;\n\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Host'). ' #'.$i  ?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_mysql_host\" value=\"<?=$value['HOST']?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Password');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input password\" name=\"v_mysql_password\" value=\"\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Maximum Number Of Databases');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_mysql_max\" value=\"<?=$value['MAX_DB']; ?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Current Number Of Databases');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_mysql_max\" value=\"<?=$value['U_DB_BASES']; ?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php }} ?>\n\n\t\t\t\t\t\t\t\t\t\t<!-- PostgreSQL Options-->\n\t\t\t\t\t\t\t\t\t\t<?php if ($v_pgsql == 'yes') { ?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('PostgreSQL Support');?> <a href=\"/edit/server/postgresql/\"><i class=\"fas fa-pencil-alt status-icon orange icon-pad-right\"></i></a>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_pgsql\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($v_pgsql == 'yes') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('phpPgAdmin URL');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_pgsql_url\" value=\"<?=$_SESSION['DB_PGA_ALIAS']; ?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t<?php if ($v_pgsql == 'yes') {\n\t\t\t\t\t\t\t\t\t\t\t$i = 0;\n\t\t\t\t\t\t\t\t\t\t\tforeach ($v_pgsql_hosts as $value) {\n\t\t\t\t\t\t\t\t\t\t\t\t$i++;\n\t\t\t\t\t\t\t\t\t\t\t?>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Host'). ' #'.$i  ?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_pgsql_host\" value=\"<?=$value['HOST']?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Maximum Number Of Databases');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_psql_max\" value=\"<?=$value['MAX_DB']; ?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Current Number Of Databases');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"step-left\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_pgsql_max\" value=\"<?=$value['U_DB_BASES']; ?>\" disabled>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br><br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<?php }} ?>\n\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('backup');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-undo\"></i><b><?=_('Backups');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"<?php if (empty($v_backup_adv)) echo 'display:none';?> ;\" id=\"backup\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Local backup');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_backup\">\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='no'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($v_backup == 'yes') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Compression');?> <a target=\"_blank\" href=\"http://docs.hestiacp.com/admin_docs/backups.html#what-is-the-difference-between-zstd-and-gzip\"><i class=\"fas fa-question-circle\"></i></a>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_backup_mode\">\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='gzip' <?php if($v_backup_mode != 'zstd') echo 'selected' ?>>gzip</option>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='zstd' <?php if($v_backup_mode == 'zstd') echo 'selected' ?>>zstd</option>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Compression level');?> <a target=\"_blank\" href=\"http://docs.hestiacp.com/admin_docs/backups.html#what-is-the-optimal-compression-ratio\"><i class=\"fas fa-question-circle\"></i></a>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_backup_gzip\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?php for ($level = 1; $level < 20; $level++) { ?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='<?=$level;?>' <?php if($v_backup_gzip == $level) echo 'selected' ?>><?=$level;?><?php if($level > 9){ echo sprintf(' (%s)', _('zstd only')); } ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Directory');?> <a target=\"_blank\" href=\"https://docs.hestiacp.com/admin_docs/backups.html#how-to-change-default-backup-folder\"><i class=\"fas fa-question-circle\"></i></a>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_dir\" value=\"<?=trim($v_backup_dir, \"'\")?>\" disabled=\"disabled\">\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<label><input type=\"checkbox\" size=\"20\" class=\"vst-checkbox\" name=\"v_backup_remote_adv\" <?php if (!empty($v_backup_remote_adv)) echo \"checked=yes\" ?> onclick=\"javascript:elementHideShow('remote_backup');\"><?=_('Remote backup');?></label>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_backup_remote_adv)) echo 'none';?> ;\" id=\"remote_backup\">\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Protocol');?> <a target=\"_blank\" href=\"http://docs.hestiacp.com/admin_docs/backups.html#what-kind-of-protocols-are-currently-supported\"><i class=\"fas fa-question-circle\"></i></a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_backup_type\" id=\"backup_type\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='ftp'><?=_('ftp'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='sftp' <?php if((!empty($v_backup_type)) && (trim($v_backup_type,\"'\")  == 'sftp' )) echo 'selected=\"selected\"'; ?>><?=_('sftp'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"b2\" <?php if((!empty($v_backup_type)) && (trim($v_backup_type,\"'\")  == 'b2' )) echo 'selected=\"selected\"'; ?>><?=_('Backblaze'); ?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr style=\"display: <?php if ((!empty($v_backup_type)) && !in_array(trim($v_backup_type, \"'\"),array('ftp','sftp'))){ echo 'none';} else {echo 'block';} ?>\" id=\"backup_sftp\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Host');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_host\" value=\"<?=trim($v_backup_host, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Port');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_port\" value=\"<?=trim($v_backup_port, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Username');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_username\" value=\"<?=trim($v_backup_username, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Password');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input password\" name=\"v_backup_password\" value=\"<?=trim($v_backup_password, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Directory');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_bpath\" value=\"<?=trim($v_backup_bpath, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr style=\"display: <?php if ((empty($v_backup_type)) || !in_array(trim($v_backup_type, \"'\"),array('b2'))){ echo 'none';} else {echo 'block';} ?>\" id=\"backup_bucket\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Bucket');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_bucket\" value=\"<?=trim($v_backup_bucket, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Application ID');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_application_id\" value=\"<?=trim($v_backup_application_id, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Application Key');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_backup_application_key\" value=\"<?=trim($v_backup_application_key, \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('ssl');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-lock\"></i><b><?=_('Hestia SSL');?><img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_adv)) echo 'none';?> ;\" id=\"ssl\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('SSL Certificate');?>\n\t\t\t\t\t\t\t\t\t\t\t<span id=\"generate-csr\"> / <a class=\"generate\" target=\"_blank\" href=\"/generate/ssl/?domain=<?=htmlentities(trim($v_hostname,'\"'));?>\"><?=_('Generate CSR');?></a></span>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<textarea size=\"20\" class=\"vst-textinput short console\" name=\"v_ssl_crt\"><?=htmlentities(trim($v_ssl_crt, \"'\"))?></textarea>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('SSL Key');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<textarea size=\"20\" class=\"vst-textinput short console\" name=\"v_ssl_key\"><?=htmlentities(trim($v_ssl_key, \"'\"))?></textarea>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<table class=\"additional-info\">\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('SUBJECT');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_subject?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if ($v_ssl_aliases){?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('Aliases');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_aliases?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('NOT_BEFORE');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_not_before?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('NOT_AFTER');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_not_after?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('SIGNATURE');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_signature?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('PUB_KEY');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_pub_key?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<b><?=_('ISSUER');?>:</b>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=$v_ssl_issuer?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('security');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-key\"></i><b><?=_('Security');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"<?php if (empty($v_security_adv)) echo 'display:none;';?>\" id=\"security\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"section-title\" onclick=\"javascript:elementHideShow('security-system-table',this);\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('System');?>\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-plus-square status-icon dim maroon section-hide-button\"></i>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<table id=\"security-system-table\" style=\"display: none;\">\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top\" style=\"font-size:1rem;padding-bottom:12px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('API');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Enable API access');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_api\" id=\"api\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes'><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['API'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<table id=\"security_ip\" style=\"<?php if ($_SESSION['API'] == \"no\") echo 'display:none;';?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allowed IP addresses for API');?> <span class=\"optional\" style=\"float:right\">1 IP address per line</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<textarea size=\"20\" class=\"vst-textinput short\" name=\"v_api_allowed_ip\"><?php \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tforeach(explode(',',$_SESSION['API_ALLOWED_IP']) as $ip ){ \n                                                                            echo trim($ip).\"\\n\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t?></textarea>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top\" style=\"font-size:1rem;padding-bottom:12px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Login');?>\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Login screen style');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_login_style\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='default'><?=_('Default'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='old' <?php if($_SESSION['LOGIN_STYLE'] == 'old') echo 'selected' ?>><?=_('Old Style'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow users to reset their passwords');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_system_password_reset\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes'><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_SYSTEM_PASSWORD_RESET'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Inactive session timeout');?> (<?=_('Minutes');?>)\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<input type=\"text\" size=\"20\" class=\"vst-input\" name=\"v_inactive_session_timeout\" value=\"<?=trim($_SESSION['INACTIVE_SESSION_TIMEOUT'], \"'\")?>\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Prevent CSRF');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_csrf_strictness\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"0\"  <?php if($_SESSION['POLICY_CSRF_STRICTNESS'] == '0') echo 'selected' ?>><?=_('Disabled');?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"1\"  <?php if($_SESSION['POLICY_CSRF_STRICTNESS'] == '1') echo 'selected' ?>><?=_('Enabled');?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"2\"  <?php if($_SESSION['POLICY_CSRF_STRICTNESS'] == '2') echo 'selected' ?>><?=_('Strict');?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php if (($_SESSION['userContext'] === \"admin\") && ($_SESSION['user'] === 'admin')) {?>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td class=\"section-title\" onclick=\"javascript:elementHideShow('security-sysadminprotect-table',this);\">\n\t\t\t\t\t\t\t\t\t\t\t\t<?=_('System Protection');?>\n\t\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-plus-square status-icon dim maroon section-hide-button\"></i>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t<table id=\"security-sysadminprotect-table\" class=\"step-top\" style=\"display: none;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top\" style=\"font-size:1rem;padding-bottom:12px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('System Administrator account');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Restrict access to read-only for other administrators');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_system_protected_admin\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes'><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_SYSTEM_PROTECTED_ADMIN'] !== 'yes') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Hide account from other administrators');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_system_hide_admin\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes'><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_SYSTEM_HIDE_ADMIN'] !== 'yes') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Do not allow other administrators to access Server Settings');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_system_hide_services\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes'><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_SYSTEM_HIDE_SERVICES'] !== 'yes') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"section-title\" onclick=\"javascript:elementHideShow('security-policies-table',this);\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Policies');?>\n\t\t\t\t\t\t\t\t\t\t\t<i class=\"fas fa-plus-square status-icon dim maroon section-hide-button\"></i>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<table id=\"security-policies-table\" style=\"display: none;\">\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top\" style=\"font-size:1rem;padding-bottom:12px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Users');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php if ($_SESSION['POLICY_SYSTEM_ENABLE_BACON'] === 'true') { ?>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow suspended users to log in with read-only access');?> <span class=\"hint\">(<?=_('Preview');?>)</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_user_view_suspended\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['POLICY_USER_VIEW_SUSPENDED'] !== 'no') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_USER_VIEW_SUSPENDED'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<?php } ?>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow users to edit their account details');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_user_edit_details\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['POLICY_USER_EDIT_DETAILS'] !== 'no') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_USER_EDIT_DETAILS'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow users to change templates when editing web domains');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_user_edit_web_templates\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['POLICY_USER_EDIT_WEB_TEMPLATES'] !== 'no') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_USER_EDIT_WEB_TEMPLATES'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow users to change templates when editing DNS zones');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_user_edit_dns_templates\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['POLICY_USER_EDIT_DNS_TEMPLATES'] !== 'no') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_USER_EDIT_DNS_TEMPLATES'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow users to view action and login history logs');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_user_view_logs\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['POLICY_USER_VIEW_LOGS'] !== 'no') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_USER_VIEW_LOGS'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Allow users to delete log history');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_policy_user_delete_logs\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['POLICY_USER_DELETE_LOGS'] !== 'no') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['POLICY_USER_DELETE_LOGS'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top\" style=\"font-size:1rem;padding-bottom:12px;\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Domains');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<?=_('Enforce subdomain ownership');?>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_enforce_subdomain_ownership\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes'><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<option value='no' <?php if($_SESSION['ENFORCE_SUBDOMAIN_OWNERSHIP'] == 'no') echo 'selected' ?>><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-top advanced-options\">\n\t\t\t\t\t\t\t\t<a href=\"javascript:elementHideShow('hestia');\" class=\"vst-text\">\n\t\t\t\t\t\t\t\t\t<i class=\"fas fa-puzzle-piece\"></i><b><?=_('Hestia Control Panel Plugins');?> <img src=\"/images/arrow.png\"></b>\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td class=\"vst-text input-label step-left\">\n\t\t\t\t\t\t\t\t<table style=\"display:<?php if (empty($v_adv)) echo 'none';?> ;\" id=\"hestia\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text step-top\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Quick App Installer');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_plugin_app_installer\">\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='false'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='true' <?php if($_SESSION['PLUGIN_APP_INSTALLER'] == 'true') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Filemanager');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_filemanager\">\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='false'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='true' <?php if($_SESSION['FILE_MANAGER'] == 'true') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('FileSystem Disk Quota');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_quota\">\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='no'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['DISK_QUOTA'] == 'yes') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td class=\"vst-text input-label\">\n\t\t\t\t\t\t\t\t\t\t\t<?=_('Firewall');?>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<select class=\"vst-list\" name=\"v_firewall\">\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='no'><?=_('No'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t\t<option value='yes' <?php if($_SESSION['FIREWALL_SYSTEM'] == 'iptables') echo 'selected' ?>><?=_('Yes'); ?></option>\n\t\t\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t\t\t<br><br>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t\t<table class=\"data-col2\"></table>\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t</form>\n</div>\n"], "filenames": ["web/edit/db/index.php", "web/edit/dns/index.php", "web/edit/mail/index.php", "web/edit/web/index.php", "web/templates/pages/edit_server.html"], "buggy_code_start_loc": [17, 17, 17, 18, 860], "buggy_code_end_loc": [17, 17, 17, 18, 861], "fixing_code_start_loc": [18, 18, 18, 19, 860], "fixing_code_end_loc": [19, 19, 19, 20, 861], "type": "CWE-79", "message": "Reflected Cross-site Scripting (XSS) Vulnerability in GitHub repository hestiacp/hestiacp prior to 1.5.11.", "other": {"cve": {"id": "CVE-2022-0986", "sourceIdentifier": "security@huntr.dev", "published": "2022-03-16T13:15:08.880", "lastModified": "2022-03-22T17:10:59.420", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Reflected Cross-site Scripting (XSS) Vulnerability in GitHub repository hestiacp/hestiacp prior to 1.5.11."}, {"lang": "es", "value": "Una vulnerabilidad de tipo Cross-site Scripting (XSS) Reflejado en el repositorio de GitHub hestiacp/hestiacp versiones anteriores a 1.5.11"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 2.4, "baseSeverity": "LOW"}, "exploitabilityScore": 0.9, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hestiacp:control_panel:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.5.11", "matchCriteriaId": "26883CF8-1F36-4CD9-80FD-F77247FE62C3"}]}]}], "references": [{"url": "https://github.com/hestiacp/hestiacp/commit/fd42196718a6fa7fe17b37fab0933d3cbcb3db0d", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/57635c78-303f-412f-b75a-623df9fa9edd", "source": "security@huntr.dev", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/hestiacp/hestiacp/commit/fd42196718a6fa7fe17b37fab0933d3cbcb3db0d"}}