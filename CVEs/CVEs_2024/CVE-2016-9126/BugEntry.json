{"buggy_code": ["{*<!--\n\n+---------------------------------------------------------------------------+\n| Revive Adserver                                                           |\n| http://www.revive-adserver.com                                            |\n|                                                                           |\n| Copyright: See the COPYRIGHT.txt file.                                    |\n| License: GPLv2 or later, see the LICENSE.txt file.                        |\n+---------------------------------------------------------------------------+\n\n-->*}<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n  <title>{t str=AuditTrail}</title>\n  <link rel='stylesheet' type='text/css' href='{$assetPath}/css/dashboard-widget.css'>\n  <!--[if IE]>\n      <link rel=\"stylesheet\" type=\"text/css\" href=\"{$assetPath}/css/dashboard-widget-ie.css\" />\n  <![endif]-->\n</head>\n\n<body>\n\n{if $screen == 'enabled'}\n    {if $aAuditData|@count > 0}\n    <div class=\"widgetListWrapper widgetContainer\">\n        <!-- normal view -->\n        <ul class=\"widgetList auditList\">\n           {foreach from=$aAuditData key=key item=aValue}\n            <li>\n                <div class=\"title\">\n                    <a target=\"_top\" href=\"userlog-audit-detailed.php?auditId={$aValue.auditid}\">\n                        {$aValue.desc}\n                    </a>\n                </div>\n                <div>\n                    <span class=\"date\">{$aValue.updated|date_format:\"%d %b %Y\"}</span>\n                </div>\n            </li>\n            {/foreach}\n        </ul>\n    </div>\n    <div><a class=\"site-link\" target=\"_top\" href=\"{$siteUrl}\">{$siteTitle}</a></div>\n    {else}\n    <div class=\"widgetListWrapper widgetContainer\">\n      <ul class=\"widgetList auditList\">\n        <li>{$noData}</li>\n      </ul>\n    </div>\n    {/if}\n{else}\n    <div class=\"widgetListWrapper widgetContainer\">\n        <ul class=\"widgetList auditList\">\n            {t str=AuditTrailNotEnabled}\n        </ul>\n    </div>\n    <div><a class=\"site-link\" target=\"_top\" href=\"{$siteUrl}\">{$siteTitle}</a></div>\n    {/if}\n</body>\n</html>\n"], "fixing_code": ["{*<!--\n\n+---------------------------------------------------------------------------+\n| Revive Adserver                                                           |\n| http://www.revive-adserver.com                                            |\n|                                                                           |\n| Copyright: See the COPYRIGHT.txt file.                                    |\n| License: GPLv2 or later, see the LICENSE.txt file.                        |\n+---------------------------------------------------------------------------+\n\n-->*}<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n  <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />\n  <title>{t str=AuditTrail}</title>\n  <link rel='stylesheet' type='text/css' href='{$assetPath}/css/dashboard-widget.css'>\n  <!--[if IE]>\n      <link rel=\"stylesheet\" type=\"text/css\" href=\"{$assetPath}/css/dashboard-widget-ie.css\" />\n  <![endif]-->\n</head>\n\n<body>\n\n{if $screen == 'enabled'}\n    {if $aAuditData|@count > 0}\n    <div class=\"widgetListWrapper widgetContainer\">\n        <!-- normal view -->\n        <ul class=\"widgetList auditList\">\n           {foreach from=$aAuditData key=key item=aValue}\n            <li>\n                <div class=\"title\">\n                    <a target=\"_top\" href=\"userlog-audit-detailed.php?auditId={$aValue.auditid}\">\n                        {$aValue.desc|escape}\n                    </a>\n                </div>\n                <div>\n                    <span class=\"date\">{$aValue.updated|date_format:\"%d %b %Y\"}</span>\n                </div>\n            </li>\n            {/foreach}\n        </ul>\n    </div>\n    <div><a class=\"site-link\" target=\"_top\" href=\"{$siteUrl}\">{$siteTitle}</a></div>\n    {else}\n    <div class=\"widgetListWrapper widgetContainer\">\n      <ul class=\"widgetList auditList\">\n        <li>{$noData}</li>\n      </ul>\n    </div>\n    {/if}\n{else}\n    <div class=\"widgetListWrapper widgetContainer\">\n        <ul class=\"widgetList auditList\">\n            {t str=AuditTrailNotEnabled}\n        </ul>\n    </div>\n    <div><a class=\"site-link\" target=\"_top\" href=\"{$siteUrl}\">{$siteTitle}</a></div>\n    {/if}\n</body>\n</html>\n"], "filenames": ["lib/templates/admin/dashboard/audit.html"], "buggy_code_start_loc": [33], "buggy_code_end_loc": [34], "fixing_code_start_loc": [33], "fixing_code_end_loc": [34], "type": "CWE-79", "message": "Revive Adserver before 3.2.3 suffers from persistent XSS. Usernames are not properly escaped when displayed in the audit trail widget of the dashboard upon login, allowing persistent XSS attacks. An authenticated user with enough privileges to create other users could exploit the vulnerability to access the administrator account.", "other": {"cve": {"id": "CVE-2016-9126", "sourceIdentifier": "support@hackerone.com", "published": "2017-03-28T02:59:00.417", "lastModified": "2019-10-09T23:20:18.990", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "Revive Adserver before 3.2.3 suffers from persistent XSS. Usernames are not properly escaped when displayed in the audit trail widget of the dashboard upon login, allowing persistent XSS attacks. An authenticated user with enough privileges to create other users could exploit the vulnerability to access the administrator account."}, {"lang": "es", "value": "Revive Adserver en versiones anteriores a 3.2.3 sufre de persistente XSS. Los nombres de usuario no se fugan correctamente cuando se muestran en el widget de seguimiento de auditor\u00eda del panel de control al iniciar sesi\u00f3n, lo que permite ataques persistentes de XSS. Un usuario autenticado con suficientes privilegios para crear otros usuarios podr\u00eda explotar la vulnerabilidad para acceder a la cuenta de administrador."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "support@hackerone.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:revive-adserver:revive_adserver:*:*:*:*:*:*:*:*", "versionEndIncluding": "3.2.2", "matchCriteriaId": "94F64F5A-ACD3-4AED-82BE-832D7B4801DA"}]}]}], "references": [{"url": "https://github.com/revive-adserver/revive-adserver/commit/8d8c6df309ff5fde9dd4770abcd4ec5d2449b3ec", "source": "support@hackerone.com", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://hackerone.com/reports/97073", "source": "support@hackerone.com", "tags": ["Permissions Required"]}, {"url": "https://www.revive-adserver.com/security/revive-sa-2016-001/", "source": "support@hackerone.com", "tags": ["Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/revive-adserver/revive-adserver/commit/8d8c6df309ff5fde9dd4770abcd4ec5d2449b3ec"}}