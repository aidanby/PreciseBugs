{"buggy_code": ["########################\nShinken ChangeLog\n########################\n\n\n3.0.03 - X/X/2017\n-----------------\n        CORE ENHANCEMENT\n        Enh: (backport from Enterprise, internal ref #SEF-202) Big boost for the broker daemons, especially for very large setups and slow modules (yes Graphite, I'm looking at you).\n        Enh: (backport from Enterprise ref:#SEF-103) Slight boost of startup time by remiving useless hash computation.\n\n        CORE FIXES\n        Fix: (backport from Enterprise ref:#SEF-76) In some case, we can have \"negative\" value for downtime depth, and then the element will never exit from downtime.\n\n\n2.4.3 - 10/03/2016\n-------------------\n        CORE ENHANCEMENT\n        Add: First version for a online profiling system, not enabled currently\n\n        CORE FIXES\n        Fix: Fix missing Services/Hosts in Livestatus (Close #1691)\n        Fix: initial_state mapping for hosts\n        Fix: Fix duration when a parent is down (Close #1779)\n        Add: Better logging for regenerator\n\n        MISC ENHANCEMENT\n        Enh: HTML mail notifications fix and improvements\n        Enh: Change TCP Connect scan to TCP Syn scan with nmap for discovery features\n        Enh: Various Documentation \n\n2.4.2 - 01/10/2015\n-------------------\n        CORE ENHANCEMENT\n        Add: Service excludes/includes/overrides extension\n        Add: Implementation of inital_state\n        Add: Broks when host/service downtime is scheduled\n        Add: Solaris SMF manifests\n        Enh: Allow white space between foreach elements\n        Enh: Increase default http thread_pool to 16\n\n        CORE FIXES\n        Fix: Duplicate Service from template using duplicate_foreach with the same name\n        Fix: Service_(includes|excludes) template recursion\n        Fix: Service description with multi level inheritance \n        Fix: Default business rule notification options\n\n2.4.1 - 15/07/2015\n-------------------\n        CORE ENHANCEMENT\n        Add: Safe Pickle\n        Add: Better Debian 8 Jessie support\n\n        CORE FIXES\n        Fix: Display_name when using duplicate_foreach\n        Fix: template definition loop did segfault python\n        Fix: Service Description inheritance when using several level of inheritance\n        Fix: cpu looping for receiver\n\n2.4   - 04/05/2015\n-------------------\n\tCORE ENHANCEMENT\n\tAdd: Hosts - Service_includes feature. Similar to service_excludes\n\tAdd: Deprecation in the doc about the discovery part. Should be move to contrib or as a module in next versions\n\tAdd: (by Ddurieux) better logging of failed external modules\n\n\n\tEnh: Actions - Catch stderr output\n\tEnh: Arbiter -  Unpickle new conf earlier. Prevent a memory issue\n\tEnh: Config - Remove sudo from restart/reload commands\n\tEnh: Daemon - Factorization of  get_objects_from_from_queues\n\tEnh: DaemonsLinks : Move files to object directory\n\tEnh: Datamanager - Function get_contactgroup\n\tEnh: Doc - A lot of typo and improvements!\n\tEnh: Init Scripts - use readlink to avoid failure on symlinks\n\tEnh: Modulesmanager - Reworking module loading, now try to import in 3 different ways\n\tEnh: Pep8 : Shinken is now pep8 compliant (enforced by Travis) excepted for 3 specific rules\n\tEnh: Scheduler - Use iterator instead of list when necessary. Reduce memory consumption\n\tEnh: Setup - Refactoring to be virtualenv compatible\n\tEnh: Tests - Stabilization\n\n\n\tDel: Check Shinken script. It has its own repository\n\tDel: Windows files from 1.4 version\n\n\n\tCORE FIXES\n\tFix: Config Parsing - Arbiter module auto creation\n\tFix: Config Parsing - Infinite recursion loop in template\n\tFix: Config Parsing - Inheritance of custom variable\n\tFix: Config Parsing - Raise error properly in ArbiterLink object\n\tFix: Config Parsing - Type properties in Contact, NotificationWay and Arbiter objects\n\tFix: Escalations - escalated parameter in notification object and macro $NOTIFICATIONISESCALATED$ are set correctly\n\tFix: Event Handlers - Global event handlers parsing and launching\n\tFix: External Command - Internal argument for CHANGE_RETRY_HOST_CHECK_INTERVAL command\n\tFix: Realm - Bailout when there are two default realm\n\tFix: (reported by:St\u00e9phane Loeuillet) init.d - Unset http(s)_proxy env variables in the init.d script (curl was using them by default)\n\tFix: (reported by: Arthur Lutz) CLI - manage shinken install call without arguments\n\tFix: (reported by mohierf) STATS - fix statsd format.\n\tFix: (reported by: St\u00e9phane Loeuillet) Config Parsing - manage , case at the end of members list (hostgroups & contactgroups)\n\tFix: (reported by: St\u00e9phane Loeuillet) Config Parsing - host check_period was mandatory with some parameters, now is missing always true period.\n\tFix: + char in servicegroups\n\n\n\n\n2.2   - 16/01/2015\n-------------------\n\tCORE ENHANCEMENT\n\tAdd : Bottle - HTTP_X_FORWARDED_PROTO support (for WebUI)\n\tAdd : BpRules - Expands bp_rules t flag from tags\n\tAdd : BpRules - Use standard macros expansion in bp_rules output\n\tAdd : Broks - new type unknown_check_result_brok (included in the previous add)\n\tAdd : CLI - update command for the shinken.io install\n\tAdd : Contact - new parameter expert. For UI purpose\n\tAdd : Escalations - Time properties for host and service escalations\n\tAdd : External Command - Implement SCHEDULE_HOSTGROUP_HOST_DOWNTIME and SCHEDULE_HOSTGROUP_SVC_DOWNTIME\n\tAdd : External Commands - Reload-config function\n\tAdd : External Commands - support for reset modify attribute\n\tAdd : HTTP API - get_start_time call returning timestamp\n\tAdd : HTTP API - Inner stats can be sent to shinken.io\n\tAdd : LogEvent - Output key to properties dict\n\tAdd : LogEvent - Pattern for FLAPPING events\n\tAdd : Receiver - Accept passive results from host or service not in configuration\n\tAdd : Realms - Handle properly multi level of realms\n\tAdd : SchedulingItem - callbacks for HOSTDOWNTIME and SERVICEDOWNTIME macros\n\tAdd : SchedulingItem - Parameter to remove host-service dependency\n\tAdd : Service Escalation - wildcard service_description\n\tAdd : Service - method  get_service_tags (for WebUI)\n\tAdd : Snapshots  - Feature to get more output when we have a bad state\n\t\n\tDel : Move WebUI image and template to the good repo\n\tDel : Pack Distribution tuning (hosts where fixd on the same scehduler between reload) - causing more damage in load balancing that it solve problems\n\n\tEnh : CLI now exit with a real system return code when fail to install\n\tEnh : Config - Module name formatting in config files\n\tEnh : Config parsing - Refactoring to pythonize at object creation. Attribute have correct type very early.\n\tEnh : Config parsing - Refactoring to reduce parse time, and scope code to ease future evolutions\n\tEnh : Daemon - Refactor bailout and edit message\n\tEnh : Datarange - Better datarange parsing\n\tEnh : Deamon - additional call to  os.setgroups to drop privileges\n\tEnh : Doc - A lot of typo and improvments!\n\tEnh : External Command - Moved manager initialization to init\n\tEnh : Imports - use importlib when available to import module properly.\n\tEnh : Init scripts - Refactoring script. Add LSB standard functions\n\tEnh : Logger - Only use time rotated file handler for regular files\n\tEnh : Logger - Refactoring logger class to inherit from standard logger class.\n\tEnh : Logger - Use lazy logger syntax to enhance performances\n\tEnh : Perfdata - Better internal parsing\n\tEnh : Realm - Code refactoring\n\tEnh : Scheduler - use a lock to acces put_result\n\tEnh : SchedulingItem - use return_code attribute to remember plugin return code so that it is available in broks.\n\tEnh : Tests - better Jenkins and Travis integration and Coverall support\n\tEnh : Tests - Code cleaning\n\tEnh : Tests - Use assert function from unittest2\n\tEnh : Triggers - Try except statement when executing them\n\n\n\tCORE FIXES\n\tFix : BpRules - '+' was causing segfault in some cases\n\tFix : Broker - Crash when sub process goes down\n\tFix : Config parsing - Unknown members list is common to all items\n\tFix : Daemon - Proper https URL\n\tFix : Daemons - Timeout and data timeout for scheduler connexion\n\tFix : Daemon - When replacing a daemon kill all processes in the group instead of one pid\n\tFix : Datamanager -  Service totals and host totals computation\n\tFix : Discovery - Linux hosts with recent nmap versions\n\tFix : HTTP API - Code stabilization\n\tFix : HTTP API - Realm not displayed in get-all-states call\n\tFix : Init scripts - Use last python version\n\tFix : Logs - Manage pre-daemon logs.\n\tFix : Macroresolver - Move output_macros definition to avoid error in WebUI (eltdetail template)\n\tFix : Notifications - Master notifications must not be sent to reactionner so that we scatter them.\n\tFix : Passive reactionners are now working\n\tFix : Scheduler - Pack size for multi-schedulers environnements. Reduce memory consumption and boot time in big setup.\n\tFix : Scheduler - Segfault with circular service dependency loop\n\tFix : Scheduler - Skip compensate if daemon is not init\n\tFix : SchedulingItem - Bad behavior for use_aggressive_host_checking.\n\tFix : SchedulingItem - Up state for a host generates a recovery if necessary\n\tFix : SSL - Crash under Windows\n\tFix : Timeperiods - remove bad modulo calculation for months\n\tFix : Sub-sub-realms where not assigned to higer realms brokers/reactionners\n\tFix : Add callbacks for HOSTDOWNTIME and SERVICEDOWNTIME macros\n\n\n\n2.0-RC   - 10/02/2014\n---------------------\n\tCORE ENHANCEMENT\n\tEnh : Replace Pyro layer with HTTP(s) communication layer, still the same ports of course\n\tEnh : (huge) Business rules enhancement (parsing level, output and tag/group linking) (thanks to Christophe Simon)\n\tAdd : Shinken command line interface (cli) to install packages (module and packs) and serve doc\n\tEnh : Split configuration files into directory for daemons and objects\n\tAdd : service_check_timeout : customize exit status\n\tEnh : Ensure LSB path for daemons and default paths\n\tDel : Nagios(r) references from test dir\n\tEnh : Test coverage : Tests have now report per file and a global percentage of code coverage is available\n\tEnh : installation is now possible with \"pip install shinken\"\n\tDel : remove the python 2.4/2.5 compatibility. Now shinken need >= 2.6\n\tAdd : definition_order parameter for objects order twins remove, only active for services\n\tEnh : remove lot of useless configuration file samples\n\tEnh : do not bail out at startup is a host service is not having a valid host, just raise a warning now\n\tAdd : big doc grok from wiki into rst files into /doc. Thanks guys for this! compile with sphinx\n\tAdd : (from Christophe Simon) Added bp_rule child notification opts management\n\tAdd : (from Christophe Simon) service_overrides attributes to hosts\n\tAdd : (from Jean-charles Delon) manage duplicate_foreach and event_handler\n\tAdd : (from Christophe Simon) Added reversed (negative) xof business rules\n\tAdd : (from Christophe Simon) percentage support to Xof: business rules\n\tAdd : (from Jan Ulferts) enable_environment_macros and disable_environment_macros to commands\n\tAdd : (from Christophe Simon) service excludes feature\n\t\n\n\n\tCORE FIXES\n\tFix : adjust_worker_by_load was wrong, worker was not created again\n\tFix : crash 'c.t_to_go is  None' in scheduler when time change\n\tFix : Arbiter parsing (Catch bad service_dependencies, timeperiod definitions)\n\tFix : Hosts over-checked when services are critical (don't respect retry_interval)\n\tFix : Prevent from returning next time notif in the past (don't over notify).\n\tFix : allow the \"__ANTI-VIRG__\" substring in the configuration files\n\tFix : do not send notification after a downtime to a contact that has been notified if notification_interval = 0\n\tFix : (reported by : Aina Rakotoson) notification logic failed when reactionners with different reactionner_tags\n\tFix : issue with some discovery rules with mutli-keys\n\tFix : set the python daemons into unbeffered stdout mode by default, centos guys will love it.\n\tFix : some fix on the contact-notifway inheritance\n\tFix : (openglx) bin/nagios : forces -v argument to be used as config file\n\tFix : (from Christophe Simon) impacts/problems retention loaded services\n\tFix : (reported by:fitzdsl) a spare that got a bad configuration can crash when try to send a configuration it do not have in master failback\n\t\n\n\tMODULES ENHANCEMENT\n\tDel : Move modules to their own repository! They are now in https://github.com/shinken-monitoring\n\n\tMODULES FIXES\n\tEnh: Bunch of fixes on the most used modules (livestatus, graphite, ws arbiter, ) and test cases added, look at each modules for details\n\n\tPACKS ENHANCEMENT\n\tDel : Move packs to their own repository! They are now in https://github.com/shinken-monitoring\n\t\n\n\n\n1.4   - 27/05/2013\n------------------\n\tCORE ENHANCEMENT\n\tAdd : Change Vsphere SDK Version\n\tAdd : new option for realm : broker complete links, so now a scheduler can give broks to several brokers instead of only one.\n\tAdd : now the arbiter can take its arbiter lookup name from parameter. Use to allow same host to run arbiter in HA for tests.\n\tAdd : macro_modulations objects, to dynamically change the macro based on the timeperiod. Can be useful as check_modulations, but easier to use, so maybe they will simply replace them\tUse persistent cookies by defaut\n\tAdd : (nerocide) now KEY are expand on the service_dependencies\tproperty.\n\tAdd : first version of user/system time catch for checks.\n\tAdd : check_modulations objects.\n\t\n\tCORE FIXES\n\tFix : (reported by:Georges Racinet) lot of SSL errors with Pyro3. Fix #839\n\tFix : bad offline receiver was too much verbose. Fix #559\t\n\tFix : (reported by: Beuc) : bad discovery script name. Fix #843\t\n\tFIX : #613 macros was overinding modules list instead of just adding a module. No bug at all just a misleading configuration in macro\n\tFix : the mysql python module installation on redhat/centos\n\tFIX : Jenkins tests + autogeneration of all_tests based on py file in the tests directory\n\tFIX : Jenkis test scripts : The loop skip empty lines\n\tFix : (reported by: miluebbe) catch bad protocol exception in daemons, like a telnet connexion. Fix #829\n\tFix : Timeperiod calculation\n\tFix : (reported by:darthelmet) bad NOT management for bp_rule and complex expression. Fix #827\n\tFix : remove useless print.\n\tFix : (reported by:sebguilbaud) bad URL for check_hpasm.\n\tFix : try to fix the no log error for scheduler and log\tlevel. Need a beter solution.\n\tFix : Check if a poller exists to handle services tag.Raise error if not\n\tFix : (reported by:boardstretcher) fix #814 about regression since last SSO related patch.\n\tFix : get_all_host_names_set functions since 1.2.4.\n\tFix : fix #509  now bp_rules can manage multi-levels rules with ()\n\tFix : Missing quote in host state notification e-mails\n\tFix : (reported by: Johan Svensson) now poller worker crashs are now put in the log.\n\tFix : (reported by: flaf and Imrane.Dessai) bad additive inheritance with multiples templates.\n\tFIX : MySQL-python complainig about outdated version of distribute\n\tFIX : (by :Alexandre Veyrenc) graphite module now manage perfdata with space in names\n\t\n\t\n\tMODULES ENHANCEMENT\n\tAdd : Sqlite to Mongodb logstore converter\n\tAdd : ws_arbiter now supports multiple input values. The ws_arbiter module can now accept a list of metrics to process. See:http://www.shinken-monitoring.org/forum/index.php/topic,846.0.html\n\tAdd : remote_user_variable from wsgi environment, to use set 'remote_user_enable 2'\n\tAdd : collectd header in shinken-specific.cfg\n\tAdd : proper support for counter/derive/absolute datatypes, by taking the derivative. Removed debug logging.\n\tAdd : support for collectd messages. Added support for more than one value in VALUES collectd part. Fixed graphite broker to nicely deal with multiple values. Fixed graphite graphs to support\tmultiple values by sh\n\tAdd : new arbiter module, FileTag, taht will tag a host if it is present in a flat file.\t\n\tAdd : support for high resolution time/interval (collectd 5.0),\tand also added support for derive and absolute types\n\tAdd : AWS arbiter module, to import your hosts from AWS/EC2.\n\tAdd : (reported by: joachim schiele) update the PNP version to the lastest one.\n\tEhn : add an optionnal list of hostnames to ignore for iptag module\t\n\tAdd : example client for zmq_broker.py\t\n\tAdd : A ZeroMQ pub socket broker for shinken\n\t\n\tMODULES FIXES\n\tFix : (reported by:Benoit Dunand-Laisin) livestatus command management with json option.\n\tFix : (reported by:pepejey) void password in ldap auth module. Fix #822\t\n\tFix : make the NDO synchronize_database_id option 1 by default to avoid single scheduler mode bug. Make the module far less verbose too.\n\tFix : (reported by:Johan Svensson) nrpe booster module now manage more than 1024 simultaneous connexions by switchting from select based poll to a real poll call.\n\tFix : mongodb fsync as a parameter\n\tFix : invalid variable name causes nrpe_poller crash when recieving SSLError exception\n\tFix : (reported by : igup) logstore_mongodb did nt manage the\tclass filter.\n\tFix : Livestatus and pnpgraph_present\n\t\n\t\n\t\n\tUI ENHANCEMENT\n\tAdd : New impact panel design\n\tAdd : jquery triggerd hover effect\n\tEnh : layout aligned\n\tAdd : font color class\n\tAdd : Update Font Awesome 3.0.2\n\tAdd : auto refresh function to view\n\tAdd : Screenfull lib\t\n\tAdd : WebUI start of a geomap, imported from\thttps://github.com/darkweaver87/alertsmap with Remi Buisson\tauth. Still work to do, for centring the map (wtf....) and give\treal data.\n\tAdd : [mq]: flupscgi.patch\n\tAdd : fullscreen dashboard menu\n\tAdd : WebUI now manage aggregation in the dep trees, reducing the number of visible elements.\n\tAdd : WebUI Glances view now raise a real error message when fail to connect.\n\tAdd : WebUI /detail view now save the tab on the location hash, so a refresh will put the user in the good tab.\n\tAdd : WebUI can now load an additonnal path for plugins taht can override the default ones.\n\t\n\t\n\tUI FIXES\n\tFix : Font color / dashboard\n\tFix : get back refresh on dashboard, so widget edit work again.\n\tFix : WebUI /impacts now display root problems even if there are lot of them.\n\tAdd : Tooltip to overview bar / eltgroup\n\tEnh : Enabled refresh disable function / fullscreen\n\tEnh : Change tab names / system log\n\tFix : #776  use \"expires\" of simplecookie (of bottle.py) Be carefull, \"expires\" uses String and not Datetime nor TimeStamp see\t: http://stackoverflow.com/questions/7913169/python-bottle-persistent-cookie-not-work\n\tFix : #779 : sorting fathers before printing\n\tFix : wrong btn alignment for Host Detail Impact\n\tFix : Parents werent displayed in webui\t\n\tFix : Forced check are now handled\n\t\n\n\tDEFAULT PACKS\n\tFix : disable the PickleRetentionArbiter and PickleRetentionBrokerby default. Very advanced modules taht should not be used without\n\tFix : currently removing skonf from standard install. If people want to TEST it, they will have to go to the init.d script. This will remove all script-kiddies from testing it and cry because it dont work. Dev are\n\tAdd : properties to ESX Host and ESX VM in discovery_runner\n\tAdd : collectd_disk.trig example\n\tFix : remove _fs_custom stuff\n\tFix : Modified collectd pack in accordance to proper naming aswell\n\tFix : typo in service Disks of linux pack Add new check_disk_custom for linux pack as sample for multi-value duplicate_foreach statement\n\tFix : MsSQL packk Typo Add Host Macros for Windows Pack\n\tFix : type in _MSSQL_CONNECTION_CRIT\n\tFix : type in WARN macros Added Macro definitions in mssql.pack\n\t\n\n\n\n1.2.4 - 11/02/2013\n------------------\n\tMODULES FIXES\n\t* Fix : LS module crash when bad socket close on the client side.\n\n\t\n1.2.3 - 30/01/2013\n------------------\n\tCORE FIXES\n\t* Fix : (Romain Forlot) wrong plugin owners after installation\n\t* Fix : (Romain Forlot) add mysql-client for Debian when install the server.\n\t* Fix : (Romain Forlot) Make arbiter last after all daemons except skonf because of issue 647\n\t* Fix : (reported by: opc and ppj) get back the arbiter spare management.\n\t* Fix : Manage sudoers to use nmap by discovery process\n\t* Fix : Set the HOME var to use the home of shinken, instead of the root's.\n\t* FIX : #689 add sudo prerequisite\n\t* Fix : Poller handling of abnormal plugin failures. Non-english shell stderr is captured too\n\t* Fix : Honor check_for_orphaned_* config params + add time_to_orphanage support for service and host\n\t* Fix : bad_start test for environments where groupname != username\n\t* Fix : Daemon timeout and receiver module options descriptions\n\t* Fix : bad import in shinken-admin\n\t* Fix : add default pack_distribution_file to nagios.cfg file, so it fix #576\n\t* Fix : (reported by: ethtricks) manage hosts macros addressX. Fix #640\n\t* Fix : (reported by: R\u00e9mi BUISSON, fixed by Olivier Hanesse) the \"too much notification\" bug after a restart, and also a potential bug for hosts downtimes overlap.\n\t* Fix : (By : Olivier Hanesse) schedule times load from retention were used even if the time was past, and make launch a bunch of useless checks.\n\t* Fix : (from rdumonnet) and remove alias for generic-host, so the value will be used from real hosts instead.\n\t* Fix : more Pyro exceptions handling\n\t* Fix : new way of parsing the complex expressions for hostgroups and templates. Fix #676\n\n\tCORE ENHANCEMENTS\n\t* Add : (Jean-francois BUTKIEWICZ) Windows installation for shinken, using .net services instead of instsrv.\n\t* Add : (Romain Forlot) distro support to install notify_by_xmpp\n\t* Add : (Denetariko) Added pnp4nagios, multisite and nagvis add-on's config folders into restore function (prior version didn't restore them)\n\t* Add : (from : Joel Ramat) include the -property feature in discovery.\n\t* Add : making orphanage time configurable\n\t* Add : first version of a Trending broker module, and libexec scripts.\n\t* Add : auto-magically add the shinken root dir parent to the PYTHONPATH environ variable in the daemons if the shinken lib is nout found.\n\t\n\tMODULES FIXES\n\t* Fix : Canopsis module - File handler and os path join\n\t* Fix : LiveStatus Correct bug with indexed access connected to issue #648.\n\t* Fix : let livestatus handle display_name correctly\n\t* Fix : (from Nicolas Pichon) Graphite, URI generation when using datasource, _GRAPHITE_PRE and _GRAPHITE_post\n\n\tMODULES ENHANCEMENTS\n\t* Add : (from Thibault Cohen) realm and poller_tag attributes in Livestatus module\n\t* Add : mongodb replicat set management in the scehduler retention module.\n\t* Add : hot host dependencies with libvirt\n\t* Add : Better handling of Carbon connection.\n\t* Add : (from Nicolas DUPEUX) SO_REUSEADDR to nsca sock to allow fast stop/start\n\t\n\tUI FIXES\n\t* Fix : WebUI manage service description with / for actions.\n\t* Fix : skonf stop script\n\t* Fix : (reported by:sebguilbaud) fix #668  : was not managed in webui for names.\n\n\tUI ENHANCEMENTS\n\t* Add : (from : Caez) webui,auth manage the $1$ htpasswd md5 way.\n\t* Add : (From Frescha) shinken informations\n\t* Add : (from Frescha) Logout link moved to admin submenu and submenu moved to the right\n\t* Add : (from Steve Schnepp) dashboard/currently, use a 24H clock format\n\t* Add : \"Beta\" badge\n\t* Add : caps lock detection login form\n\n\tDEFAULT PACKS\n\t* Fix : discovery for safekit cluster\n\t* Add : postgreSQL monitoring pack\n\t* Add : first part of tomcat pack. This pack need a proper installation of jmx4perl on shinken server (or poller) and a proper installation off jolokia\n\t\n\t\n1.2.2 - 22/10/2012\n------------------\n\tCORE FIXES\n\t* Fix : bug in scheduler when next check was impossible.\n\t\n\n\n1.2.1 - 22/10/2012\n------------------\n\tCORE ENHANCEMENTS\n\t* Add : Landscape (ubuntu SaaS) arbiter importer module\n\n\n\tCORE FIXES\n\t* Fix : (reported by: Yannig Perre) bad contacts/notifways notif periods were not caught\n\t* Fix : Realm objects were not being stripped when hostgroups were used\n\t* Fix : (reported by : R\u00e9mi BUISSON) there was still realm objects on sub-conf hostgroups objects\n\t* Fix : Issue #588 Graphite Templates formatting\n\t* Fix : (from Nicolas Boos) output an error at setup if the lsb_release\n\t* Fix : make service property service_dependencies take a void hostname\n\t* Fix : broker failed to initialize new modules when it get a new configuration\n\t* Fix : Restore Python 2.4 compatibility for test suite\n\t* Fix : (reported by: Dravail) bad install for PNP in install script\n\t* Fix : Cleanup shinken-specific-* files\n\t* Fix : (from : xkillian) less time latency between checks, so perfdata modules won't lost some checks anymore\n\n\tMODULE FIXES\n\t* Fix : (Reported by pushou) graphite_broker typo in logger call \n\t* Fix : a bug in livestatus \"GET log\" for python 2.4 (no partition method)\n\t* Fix : No override mongo replication state levels\n\t* Fix : Correct livestatus commands table. Fix #520\n\t* Fix : (Reported by igup) Livestatus Issue 628 UTF8 not decoded in query matching == \n\n\tUI ENHANCEMENTS\n\t* Add : Business impact Filter\n\t* Add : Multiple action URLS (Thanks to h4wkmoon)\n\t* Add : (Thanks GAULUPEAU Jonathan) Webui, move the show/hide tool bar button \n\n\tUI FIXES\n\t* Fix : Dynamic reload of widget after save\n\t* Fix : bug in active_directory_ui for unknown users\n\t* Fix : typo in javascript for bookmarks\n\t* Fix : Bookmark Business impact Filter\n\t* Fix : Issue #570 gear.png\n\t\n\n\tDEFAULT PACKS\n\t* Fix : (Thanks jhurliman) check_mongodb invalid option -C \n\t* Fix : Missing IMAPS/POPS ports\n\t* Fix : update check_nwc_health install to the 1.3 version.\n\t* Fix : Typo in Packs.tpl and accept packs with no services\n\t* Fix : invalid nmap parameter\n\n\n\n1.2 - 31/08/2012\n------------------\n\tCORE ENHANCEMENTS\n\t* Add : Skonf daemon, as a configuration UI over the discovery lib\n\t* Add : Triggers to the scheduler. This code is launched after each \"check\"\n\t* Add : issue #349 (from David Guenault) Installation script now has a backup repository for installing MK Multisite.\n\t* Add : option to skip mongo installation. Useful for poller installation that does not need mongo to be installed.\n\t* Add : daemon_enabled option for ini and nagios.cfg files to disable a daemon from running.\n\t* Add : (by Hartmut Goebel and xkilian) huge work to replace old log code by a logging based one, print to logger, adjust levels, messages, typos\n\t* Add : (by Hartmut Goebel) huge code cleaning\n\t* Add : install script available at the install.shinken-monitoring.org address.\n\t* Add : make the daemon and the module names appears on the process line (setproctitle mode)\n\t* Add : receiver can now send directly commands to schedulers. (direct_routing)\n\t* Add : HOSTREALM macro for host/service.\n\t* Add : 'address' directive into generated host by discovery\n\t* Add : (reported by : Mathias Fussenegger) enhance the README, to just put install script way. Put other methods in the packagers and dev files.\n\t* Add : reload option for the init script. Fix #385\n\t* Add : install script: trap signals INT, TERM with a cleanup function\n\t* Add : USR2 signal management for the scheduler to dump objects (checks, notification, event handlers and broks)\n\t* Add : Reorganize Configuration file in sections. More consistent layout. Clarify the role and scope of shinken-specific.cfg.\n\t* Add : Use the new folder \"graphite\" for graphite templates. Existing templates should be prefixed with .graph, and move to that folder.\n\t* Add : the not list for services generators. So the primary list can be automatically generated, and the user can just maintain the not one.\n\t* Add : (from Lars Hansson) manage Apache2 htpasswd crypt pass.\n\t* Add : Allow running shinken satellites in a NATted environment\n\t* Add : shinken-packs to easily create .zip pack files\n\t* Add : Hostd daemon, for running community.shinken-monitoring.org website\n\t* Add : multi-layers discovery, with rules on runners.\n\t* Add : discoveryrule_order so the admin can manage the template order in a more easy way than with the order in the file\n\t* Add : support for Linux Mint\n\t* Add : nmap discovery speedup, and skonf scan part.\n\t* Add : support to explode_hostgroup directive\n\t* Add : new external command, PROCESS_SERVICE_OUTPUT and host, same than check_result for passive, but with no return code.\n\t* Add : configurable logging level (per daemon)\n\t* Add : shinken-admin can now change logging levels during runtime (Guillaume Bour)\n\t* Add : now passive checks take their timestamp from the external command instead of the received time.\n\t* Add : pre-serialize the configurations in the arbiter before going in daemon, and so kill the previous instance. (startup boost)\n\t* Add : brok time part boost, with less useless objects sent, like contacts, timeperiods or commands. (big startup boost)\n\t* Add : host pack dispatching history is saved in a pickle file, so we will be able to push same objects in the same scheduler\n\t* Add : arbiter -p options for dumping profile\n\t* Add : (thibault cohen) Added hook in Scheduler daemon to permit the use of the Shinken SNMP poller module, SnmpBooster.\n\n\n\tCORE FIXES\n\t* Fix : (from raphaeltr) Typo in mysql monitoring pack command arguments\n\t* Fix : Fix minor installation issues on centos/redhat. Mainly on services activation and pnp\n\t* Fix : escalation issue when we restart the scheduler during the escalation process. Should fix #525\n\t* Fix : potential endless loop on bp_rule + parent relation ship, and problem/impact setting. Fix #198\n\t* Fix : bad characters in external commands make logging not happy at all. Fix #498\n\t* Fix : bad start for arbiter with Pyro4 and enable_ssl=1.\n\t* Fix : issue #272 where the shinken user home was forced to be in /home and that make some system not eligible to install.\n\t* Fix : Pyro 4.14 issue, where we remove every where the MSG_WAITALL for all where it was useful only for first Pyro4 version. Fix #345\n\t* Fix : Update format of log message to be less prone to breaking\n\t* Fix : $USERn$ macros aren't published in env anymore\n\t* Fix : Nconf installation : apache was not restarted after dependency installation.\n\t* Fix : (reported by : D.Durieux) remove the self.process link for a killed action, because such object cant be pickle.\n\t* Fix : spare arbiter now take the lead is the master is never start. Fix #231\n\t* Fix : (reported by Sven) the configuration loader was not following symlinks. BEWARE : on python 2.4 and 2.5 it is NOT managed.\n\t* Fix : (reported by : Sven) space in hostgroups problems. Fix #452\n\t* Fix : (reported by : Nicolas DUPEUX) : bad DISABLE_HOST_FRESHNESS_CHECKS and ENABLE_HOST_FRESHNESS_CHECKS code fix #376\n\t* Fix : (reported by : Chettor) #342 comments from downtime and ack where not put in the global list, and so not removed\n\t* Fix : catch a case where service dep got no hostname nor hostgroup_name.\n\t* Fix : issue with retention and notification that make notification not sent.\n\t* Fix : (reported by banderas07, analysed by : Radu Gheorghe) :  #401 escalation notification_interval issue\n\t* Fix : disable 'FLAPPINGSTART', 'FLAPPINGSTOP', 'FLAPPINGDISABLED' notifications during downtimes.\n\t* Fix : issue #404 to treat Tracebacks correctly for Pyro3 and Pyro4.\n\t* Fix : Op5 guys changed the name of check_esx3.pl to check_vmware_api.pl so now we host a copy of the plugin to workaround problems\n\t* Fix : (Reported by : Morkxy, fixed by : Lars Hansson) change deprecated md5 by haslib.\n\t* Fix : add a check_type attribute for checks\n\t* Fix : remove illegal char from service_description when duplicated\n\t* Fix : wrong name for mongodb debian packages\n\t* Fix : CHANGE_HOST_CHECK_TIMEPERIOD apply to a host not a service\n\t* Fix : (from : CHAMLEY Stephane) add notifications_enabled to the retention data.\n\t* Fix : (reported by : Nicolas DUPEUX) #244 missing from_q property for regenerator.\n\t* Fix : (reported by : Akiooutori) fix #325 (missing SOCK_REUSE in some pyro versions) .\n\t* Fix : (From : Michael COQUARD) setup.py build with simple user.\n\t* Fix : missing mongo dependency for debian like distro < 6\n\t* Fix : mongodb 10gen repo configuration path was not found on redhat/centos\n\n\n\tMODULE ENHANCEMENTS\n\t* Add: (from: xkilian and Thibault Cohen) Graphite broker supports pickle protocol, bulk updates and buffers output when it can't connect to Carbon daemons\n\t* Add: (from: Thibault Cohen and ???) Graphite broker replaces invalid caracters by _ and supports negative values\n\t* Add: (from: xkilian and Thibault Cohen) Graphite broker adds _PRE_GRAPHITE and _POST_GRAPHITE host or service macros to each dot delimited data name\n\t* Add: (from: Claneys Skyne) Graphite broker Create additionnal data points for warning and critical thresholds per data value\n\t* Add: (from Romain Forlot) Graphite broker Compile regex\n\t* Add: (from: bclermont) Graphite broker add graphite_data_source variable between hostname and service name in data to Graphite\n\t* Add : a read_only option to logstore_sqlite\n\t* Add : Finalyse the time filter to avoid loading all the logs database in use_aggressive_sql=0 mode\n\t* Add : Added more hints for the livestatus query metadata resulting in massive speedup for Nagvis, Multisite, Thruk\n\t* Add : Creating new authentification module for OpenLDAP directory service\n\t* Add : Most modules do not raise Warning if the module need (like python-ldap for active directory, etc) but instead raise a real Exception\n\t* Add : Collectd template with trigger sample.\n\t* Add : First working version of Canopsis broker module\n\t* Add : Use usjon optional import to improve LS output performance\n\t* Add : NDO add table prefix as a parameter.\n\t* Add : (Thibault Cohen) Livestatus will now only store STATE messages and no longer any general logs in logstores\n\t* Add : (Nicolas Dupeux) TSCA module documentation updated and files consolidated in modules sections of the code\n\n\tMODULE FIXES\n\t* Fix : issue #450 (from vaxvms) removed thrift broker, similar to Livestatus, as it is unmaintained.\n\t* Fix : MerlinDB for Ninja UI, removed documentation and marked as deprecated, as it is unmaintained.\n\t* Fix : (from : Fr\u00e9d\u00e9ric P\u00e9g\u00e9) make the sqlite db files put in a good default place, in devel mode or init.d mode.\n\t* Fix : the program_start attribute in livestatus status table\n\t* Fix : (reported by : Nicolas Dupeux) remove a useless method in logstore_sqlite, and add a protection against endless loops. Fix #374\n\t* Fix : Livestatus allowed_hosts options does not work\n\t* Fix : Call the right function for !=~ LQL filter (livestatus)\n\t* Fix : do not push back monitoring status in GLPI database when the host configuration does not come from GLPI\n\t* Fix : a bug in livestatus module and add the attribute host.event_handler (needed by Thruk)\n\n\n\tUI ENHANCEMENTS\n\t* Add : UI /detail full rewrite. Thanks Andreas!!\n\t* Add : UI new dashboard!\n\t* Add : (from Mael Vincent, julien pilou, Gael Millet, Damien Mathieu and hugo viricel) new /mobile part!\n\t* Add : Enable easy activation of application monitoring performance feature. Use ./install --enableeue to enable eue feature\n\t* Add : WebUI in a /problem page a user can now press the sift key and over the selection tick to select them. It make easier for massive selection\n\t* Add : UI sqlite backend to save common preferences\n\t* Add : the page to save common prefs\n\t* Add : webui, /depgraph, now add a loop and loop_time option, to make the graph root change between important elements.\n\t* Add : sound on new non-acknowledge IT problem (disabled by default)\n\t* Add : UI /detail now dep graph is also print on a tab, so this feature will be more visible.\n\t* Add : UI /problems add the downtime filtering.\n\t* Add : UI /problems filtering by ack state.\n\n\tUI FIXES\n\t* Fix : (reported by : Vincent Riquer) WebUI do not print 1970 for 0 time, but N/A instead. issue fix #241\n\t* Fix : (reported by : xkilian) WebUI would not display names containing dots.\n\n\tDEFAULT PACKS\n\t* Add : discovery packs for ibm storage management and beginning of clustering solutions discovery\n\t* Add : cluster discovery for Safekit and HACMP.\n\t* Add : snmp plugins for AIX to monitor VG, inode, HACMP and Safekit\n\t* Add : first 2nd level real discovery script, here for listing windows shares, like shares or printers. It auto-hide the $ ones.\n\t* Add : (Camille Vacquie): AIX service pack\n\t* Add : SNI support to https and https certificate checks\n\t* Add : pack/os/linux - check_linux_network_usage - use last_perfdata to determin bandwidth\n\t* Add : commands for notification by XMPP (Jabber)\n\t* Add : a basic rsync check template in the network/services pack.\n\t* Add : macros for Basic HTTP authentification in the HTTP(S) services templates.\n\t* Fix : The check_mysql_health plugin need a : sign after the thresholds for greater is better metrics.\n\t* Fix : generic corrupted block oracle database check\n\t* Fix : call sudo to execute SMcli into IBM_DS plugins\n\n\tDOCUMENTATION\n\t* Add : (from xkilian, MathieuMD,  Claneys Skyne, H4wkmoon, etc.) Wiki documentation in-depth renewal of Getting Started pages for new users\n\t* Add : Monitoring Pack documentation, modules, installation, FAQ , diagrams, scaling shinken, dev+user resources, etc.\n\t* Add : dummy_broker module example.\n\n1.0.1 - 13/03/2012\n------------------\n\tCORE FIXES\n\t* Fix: recovery contacts were lost after a restart\n\t* Fix: allow } in commands if it's not alone in the line\n\t* Fix: (from: Laurent Ollagnier) typo on mysql pack\n\t* Fix: issue #214 (shinken-admin catches backtrace for lost connections)\n\t* Fix: inheritance with +\n\t* Fix: ticket #213 This will manage cases where an active satellite dies and there is no spare. It's useful for pollers where spare is not so interesting.\n\t* Fix: (reported by: H4wkmoon) time change compensation lead to a scheduler crash when objets don't get check perdios or notification periods.\n\t* Fix: manage LARGE output from sub commands (>64k). Only works under Unix for now, because it uses the fcntl module\n\t* Fix: (reported by: Unicow) bug in escalations, there were too many escalations raised\n\t* Fix: (from: Arthur Gautier) fix buildpath\n\t* Fix: (From: Thomas Meson) Various fixes in setup.py and add missing files to build the package\n\n\tMODULE ENHANCEMENTS\n\t* Add: many GLPI module enhancements, with new properties managed\n\n\tMODULE FIXES\n\t* Fix: check_esx3 install under ubuntu 32bits edition\n\t* Fix: multisite layout, add custom links\n\t* Fix: workaround problem with official pyro3 under Debian squeeze. Use pyro4 instead of the official one\n\t* FIX: #210 added test of parent target folder. if it does not exist then create it\n\t* Fix: HTML in sendmails\n\t* Fix: a bug in livestatus attribute action_url_expanded.\n\t* Fix: (reported by: Jonathan Gaulupeau) ip_tag was launch too late to access check_command objets.\n\t* Fix: (By: zllak) ndodb_mysql_broker module was not working on python2.5\n\t* Fix: Fix a bug in livestatus Service.contact_groups\n\n\tUI FIXES\n\t* Fix: Sort alphabeticaly in WebUI\n\n\n1.0 - 28/02/2012\n------------------\n\tCORE ENHANCEMENTS\n\t* Add: shinken.sh script and skonf.py with a LOT of features for setup and configuration management.\n\t* Add: better logging for warnings for host, service and npcd configuration\n\t* Add: poller daemon will use all available CPUs by default\n\t* Add: poller daemon can now load standard external modules like namedPipe to get external commands from it\n\t* Add: brok queue watchdog for satellites, activated for Broker by default at 100000 broks to kill/restart the module..\n\t* Add: if the run/var directories are missing, try to create them in the init.d script.\n\t* Add: service templates can now be applied on a host template\n\t* Add: reactionner can run under android\n\t* Add: android SMS module\n\t* Add: imlemented a check for dead queue threads. When detected restarts the thread\n\t* Add: mail python script\n\t* Add: better error text when the pickle load gets an error\n\t* Add: manage connexion timeouts in the broker and Pyro4\n\t* Add: $$ are now interpreted as $ in macro solving\n\t* Add: (reported by: sduchesneau) check_shinken.py now has a timeout. It is set by default at 10s\n\t* Add: business rules now support the NOT operand\n\t* Add: send broks in external modules as a biglist instead of n broks. It's more efficient (X3 perf for this, can be huge time for huge conf)\n\t* Add: templates for monitoring common devices and services are now included\n\t* Add: manage \\; to be changed in ; without cutting the rest of the line to be removed as a comment\n\t* Add: (reported by: foobar1111) arbiter only matched hostname, and not fqdn. Now it will try fqdn and then the hostname.\n\t* Add: retention is now enabled by default at installation time (Pickle)\n\t* Add: (From Michael Leinartas) man pages updates\n\t* Add: '+' in discovery rule management, so you can 'add' something, like a template\n\t* Add: using an undefined template in the configuration is no longer a critical error, just a warning.\n\t\tSo the user can just 'tag' hosts first and then create the template\n\t* Add: Sebastien Coavoux conducted a large code review! :)\n\t* Add: xkilian reviewed and corrected many many pages of the wiki documentation and a few english fixes in the distribution :)\n\t* Add: skonf daemon preview. It is not yet meant for production, but is included to get feedback\n\t* Add: mongodb insert capabilities for the discovery\n\t* Add: TIMEPERIOD TRANSITION logs from the Arbiter to get timeperiods transition output\n\t* Add: is_admin property is now available for contacts\n\t* Add: make the nmap discovery do tcp and udp scan\n\t* Add: (Victor Igumnov) installation for Solaris\n\n\tCORE FIXES\n\t* Fix: use StringIO to read configuration files into a string (much faster with lots of config files)\n\t* Fix: (reported by: lminoza) bug in inheritance if templates give only a + elements, should continue to loop and not stop here.\n\t* Fix: keep multiple spaces in config files. (check_command!\"args   \" were stripped)\n\t* Fix: pyro 4.10 management\n\t* Fix: (reported by: MINOZA, Landy) multi-layer management for service template on host template. So if you apply a service on layer 3 and your host inherit from layer1->layer2\n\t* Fix: (reported by: Thibaut Notteboom) catch ConnectionClosedError on poller/reactionner connections\n\t* Fix: A better safe_print\n\t* Fix: lot of encoding stuff!\n\t* FIX: proxy support and python-setuptools installation on RHEL/CENTOS 6\n\t* Fix: (reproted by: darkweaver87) somethimes we got a malformed external command. If so, bailout and warn in debug mode.\n\t* Fix: when there is a dispatching problem, the arbiter send and send again the same configuration to satellites.\n\t* Fix: crash bug when timezone set in config file\n\t* Fix: make all log pass the utf8 management\n\t* Fix: use auto-generated, absolute path for README (Daniel Widerin)\n\t* Fix: last line of email notification must finish by a \\n otherwise it will not be sent (Laurent Ollagnier)\n\t* Fix: (from rootix2) catch case where service do not have imported_from from modules.\n\t* Fix: (reported by: Venelin Petkov) print in hostgroup names was a problem.\n\t* Fix: if a scheduler restarted, we got problem because the arbiter did not resend it the configuration\n\t* Fix: \"host_notification_period\" and \"service_notification_period\" defined twice in the contact definition (Fournet Matthieu)\n\t* Fix: (reported by: Httqm) default notification_interval was one minute, 1hour is better.\n\t* Fix: (reported by: sprudhomme) longoutput parsing and perfdata did not follow nagios way.\n\t* Fix: change sourceforgetrac with github in tracebacks.\n\t* Fix: (reported by: lminoza) too many notifications for a contact with multiple notification methods, all where sent when only some would pass filter.\n\t* Fix: (reported by: puisea) kill all sub process action tree on unix\n\t* Fix: flaw on multiple date and multiple timerange\n\t* Fix: if missing alias in objects, put the name if available\n\t* Fix: (reported by: denetariko) manage spaces before and after type name in define line\n\t* Fix: (reported by: Steve Kieu) missing get_name() method for config\n\t* Fix: (reported by: Mihai Efrim) flapping notifications\n\n\n\n\n\tMODULE ENHANCEMENTS\n\t* Add: rewrite the LiveStatus module, performance boost and simpler. Thanks Gerhard for this huge undertaking!\n\t* Add: two new modules for storing livestatus logs. sqlite and mongodb\n\t* Add: graphite module for the Broker to export performance data to a Graphite time series database.\n\t* Add: module to deal with flat file dependencies\n\t* Add: mongodb module for the arbiter, to load hosts object from it\n\t* Add: mongodb retention module\n\t* Add: the Service-perfdata module now open/close the perfdata file each second. So it's compatible with tools like Centreon that move it\n\t* Add: macros supported in skonf. Lots of bug fixes\n\t* Add: merlindb now inserts host_contactgroups\n\t* Add: NDO Nagios/Shinken mix in database (Sebastien Coavoux)\n\t* Add: port option for the mysql connexion with NDO\n\t* Add: ip_tag module that can change configuration properties based on the host IP address or IP address range.\n\t* Add: simulation mode for the nmap disco wrapper, so we can ask for xml output from users, and then simulate it easily.\n\t* Add: new process for nmap discovery output. There is no longer a big mapping pass. It will output what it can, and it's for the discovery_rule to do this job now,\n\t\tit's far more a BIG thanks to all folks that send me sample xml output :)\n\t* Add: enhanced capabilities for the mysql import module (OlivierHa)\n\n\tMODULE FIXES\n\t* Fix: useless and dangerous str in redis module.\n\t* FIX: htpasswd.users file was not correctly updated at installation\n\t* Fix: (reported by: DGuenault) hack_poller_tag_by_macros was not applying poller_tag to commands, only root objects\n\t* Fix: memcache and redis retention modules. They were loading notifications->contacts->commands but this class got slots but no __getstate__\n\t* Fix: (reported by: sprudhomme): long_output in ndo for 1.4b9 version\n\t* Fix: NSCA, a loop when the client initiate the socket closing\n\n\tUI\n\t* Add: now page rendering can be launched in parallel, and so page can now call 'long' queries without breaking all. But during a long query, we still cannot eat broks.\n\t* Fix: the WebUI now exits when the brok thread encounters a problem\n\t* Add: UI PNP module\n\t* Add: if contact is not is_admin, then the /problems view only shows its related elements (if he is a contact of the elemetn, of an impact or a source problems one).\n\t* Add: add graph time selection in the detail page\n\t* Add: Graphite graph backend\n\t* Add: /mobile part\n\t* Add: External Authentification for WebUI (SSO) (olivierHa)\n\t* Add: tips on the eltgraph view\n\t* Fix: acknowledge typo\n\t* Fix: Change the scale of the impact view divs\n\t* Fix: UI page navigation should not propose page too high if not need\n\t* Add: gesture canvas as smaller and visible\n\t* Add: address to the eltdetail.tpl\n\t* Fix: utf8 names in the UI\n\t* Add: allow_html_output parameter for the WebUI\n\t* Add: generic perfometer manager for the UI\n\t* Fix: search button (Thanx to pydubreucq)\n\t* Add: make all nodes apears in the dep graph, but hidden one in very smalls\n\t* Add: perfometer image hovering with the graph module like PNP\n\t* Add: password iphone like in the login screen\n\t* Add: an orange outline to see where the focus is on input\n\n\n\n0.8 - 17/10/2011\n------------------\n\tCORE ENHANCEMENTS\n\t* Add: WebUI broker module. More info in the UI changelog part.\n\t* Add: (by: Vincent Riquer) no_event_handlers_during_downtimes parameter to choose between nagios and shinken behavior to (not) run event handlers during a downtime.\n\t* Add: added RUN var relocation in shinken default file\n\t* Add: support for serviceextinfo\n\t* Add: support for hostextinfo\n\t* Add: a workdir parameter in the nagios.cfg file for set the arbiter working directory\n\t* Add: modules for modules. Will be useful for the global configuration in the WebUI (it's a module, but will need additonnal modules)\n\t* Add: alternative installation method in contrib\n\t* Add: shinken-admin command that can connect to an arbiter and ask daemons status.\n\t* Add: discovery runners timeout parameter. Set by default at one hour.\n\t* Add: rename criticity into business_impact for hosts and services. Criticity is automatically mapped into business_impact in the configuration reading, and rename min_criticity into min_business_impact for contacts and notifways. And keep a mapping for old conf.\n\t* Add: if set to 0, min_workers will set the pollers/reactionners to use ALL cpus of the server.\n\t* Add: business modulation objects.\n\t* Add: new tests for A,B,Cof: rules and a fix for the default return logic.\n\t* Add: arbiter ask one a check_interval the managed conf for satellites. Makes for smoother decisions.\n\n\n\tCORE FIXES\n\t* Fix: BugFix Pyro4 compatibility\n\t* fix: try to fix bad notification output make scehduler crash.\n\t* Fix: (Seb-Solon) catch incomplet service group members\n\t* Fix: bad message for arbiter in HA without host_name value.\n\t* Fix: (reported by: fraggod): inline comment in boolean cause an arbiter crash when lookup conf.\n\t* Fix: (reported by titilambert) bug about linkify and templates, so need to clean search lists after remove templates.\n\t* Fix: (reported by Vincent Riquer ) Pyro got problem in connect() and so need a low socket timeout by default.\n\t* Fix: (reported by: grim) manage flap_detection_enabled and enable_flap_detection\n\t* Fix: when disable active check was done, the pending check was still executed, so the effect was not immediate. Now we change it as a dumym check with curretn value the value of the host/service.\n\t* Fix: external_command.py where the config setting log_external_commands was ignored\n\t* Fix: (reported by: obiouane) missing object value is now reported correctly.\n\t* Fix: (Etienne Obriot) multiple = in macos values\n\t* Fix: a bug in config.py where resource macros containing a \"=\" were not correctly processed. Thanks Etienne\n\t* Fix: (reported by Seb-Solon) custome macros get problems in notifications.\n\t* Fix: (reported by: Michael Grundmann) a service for a void hostgroup and a host exclusion was reporting a bad conf instead if forgot this service.\n\t* Fix: (Reported by: Dirk Hallanzy) was not launching under XP due to some pid file creation bad mode.\n\t* Fix: (reported by: Vincent Riquer) now a spare broker can be send to sleep again by the arbiter. It will clean its queues and stop modules.\n\t* Fix: arbiter crash with a spare and the new smoothing wat i managed behavior.\n\t* Fix: Change default check/eventhandler/notification timeouts and flap thresholds to make nagios more compatible to shinken.\n\t* fix: Better handling of check timeouts (there was an empty output)\n\t* fix: Log notification and eventhandler timeouts\n\t* Fix: (reported by: Denis GERMAIN) service with no description cause a host problem in linking phase.\n\t* Fix: (reported by: Seb-Solon) manage utf8 in host and service perfdata.\n\t* Fix: protect broker agains module taht ask for full instance init about unknown scheduler.\n\t* Fix: (reported by Markus Elger) add next schedule date in the retention data.\n\t* Fix: (reported by: Olivier Hanesse) bad realm configuration was not detected for satellites.\n\t* Fix: (reported by:Markus Elger) bad host count in realms.\n\t* Fix: (reported by:Markus Elger) bad host reaml conf were not detected.\n\n\n\tMODULES ENHANCEMENTS\n\t* Add: module for autotagging poller_tag from a custom macro.\n\t* Add: create the simple-log archive dir automatically if it doesn't exist\n\t* Add: Initial import of the thrift broker with a sample client in python\n\t* Add: Initial import of TSCA, Thrift Service Check Acceptor\n\t* Add: Module arbiter load all configuration from GLPI (plugin monitoring) bywebservice\n\t* Add: a new module to import configuration data (hosts/services) from a MySQL database\n\t* NDO/MySQL:\n\t* Add: current_notification_number in the ndo module.\n\t* Add: last_notification in ndo module.\n\t* Add: last_state_change to the ndo module.\n\t* Add: add the is_flapping data to broks and update teh ndo module so it update the value.\n\t* Add: percent_state_change as check_result brok and in the ndo module.\n\t* LIVESTATUS:\n\t* Add: Derive the archives filenames from the main livestatus db\n\t* Add: Rewrite the livestatus sqlite code. Now there is one database file with logging events for each day.\n\t*!!: If you have a huge livestatus.db it is recommended to stop shinken and run the script contrib/livestatus/splitlivelogs.py\n\t* Add: the livestatus sqlite db will now be opened in do_start() instead of init(). Now only the livestatus process has an open filehandle. (the main broker process had one too)\n\t* Add: Make the livestatus socket world read/writable\n\t* Add: the REUSEADDR flag to livestatus's socket. Thanks Olivier Hanesse\n\t* Add: performance improvement for livestatus queries with Limit:\n\n\n\n\tMODULES FIXES\n\t* Fix: important bugfix in ncpdmod\n\t* Fix: Livestatus path database\n\t* Fix: string comparison for livestatus. None is equivalent to empty string\n\t* Fix: collumn name change in merlin ds.\n\t* Fix: (reported by: Seb-Solon) bad contact group insert in objects in NDO\n\t* Fix: (reported by: seb-solon) bad contact group id in NDO\n\t* Fix: (seb-solon) ndo contacts were not registered with the good id.\n\t* Fix: add the flap_detection_enabled in the ndo status tables too. (I love duplicate data...)\n\t* Fix: the ndo module with is_flapping value for update states.\n\t* Fix: (reported by: Ronny Lindner & Markus Elger) LiveStatus crash in log parsing.\n\t* Fix: (reported by: Ronny Lindner) fix status.dat module with utf8 characters\n\t* Fix: (reported by: Olivier Hanesse) nrpe module did not tag the check_time value for checks, and so pnp and other tools were not happy. BP rules were alike.\n\t* Fix: (reported by Markus Elger) LiveStatus module did not clean previously added elements before recreating them.\n\n\n\tUI\n\t* Add: Andreas to main contributors :)\n\t* Add: welcome text and error text in the login page.\n\t* Add: make appears on the dep graph only interesting elements, so near the root or hosts or service in real problems. Far more redable with huge conf.\n\t* Add: default http backend auto, so if a better one (paste, cehrrypy) is founded, use it instead of the simple swsgi.\n\t* Add: less info in the detail page, with a moee button for rarely used infos.\n\t* Add: dock effect for actions buttons on /problems.\n\t* Add: /system page with satellites info in it.\n\t* Add: search form in the problems page, with autocompletion. Search problems and impacts names too.\n\t* Add: new way of handling cookies. Now it's a crypted way, and so stateless. Needto remove all session file thing so.\n\t* Add: in cfg file password for users, or AD or apache passwd file\n\t* Add: AD module that will get user photos from Ldap.\n\t* Add: icon sets: network_service, servers., disk, database\n\t* Add: gesture management for the detail page.\n\t* Add: parallax effect in the top right banner to see huge impacts\n\t* Add: make known bad nodes shown in the dep tree, so the admin don't even have to expand and find the bad thing that cause him a problem. Lasy admin mdoe on :)\n\t* Add: swtich buttons for ths hostdetail page for enable/disable things.\n\t* Add: if you change host topology (new dependency like fror VMotion), the UI is updated too.\n\n\n\n\n0.6 - 03/05/2011\n------------------\nENHANCEMENTS\n\t* Add: discovery script and rule engine\n\t* Enh: lot of code clean from Gregory Starck, big Thanks :)\n\t* Add: manage several brokers by realm\n\t* Add: LiveStatus Wait commands\n\t* Add: Recevier daemon, for distributed realms in distant LAN\n\t* Add: passive poller for DMZ management\n\t* Add: (David Guenault) a way for people that install shinken lib in non standard place (like /opt) to get it working for python path.\n\t* Add: poller and reactionner modules\n\t* Add: nrpe poller module for tuning nrpe calls without having to 'forks'\n\t* Add: human_timestamp_log option so the log will output time as human readable format.\n\t* Add: make the local log rotate with the logging module, max keep file at 5.\n\t* Add: the crash catching in the log for all daemons\n\t* Add: enable by default local log, should be enable by default, and if the admin want it down, he can.\n\t* Add: (Eric Beaulieu) Windows installation script\n\t* Add: Thte configuration is read as UTF8\n\t* Add: round robin dispatching way between the worker of a module for the satellites.\n\t* Add: set a check_interval to satellites, so we do not try every second to ping them, each a minute is quite enouth.\n\t* Add: sending USR1 do a memory dump of the daemon\n\t* Add: Manage Pyro4.2 and higer.\n\t* Add: manage no notification period for hosts and services\n\t* Add: print the sleep_time as a load average, so will smooth in one minute average, so is a good scheduler load indicator\n\t* Add: force LANG=us and UTF8 in init scripts. No sense admin can set another langage for system and hope for tools to work.\n\t* Add: print the latencies for scheduler in 95percentile way\n\t* Add: when a hook point failed set the module to restart, not to kill, even external ones\n\t* Add: support for multisite's double-requests (extcmd+query) to the livestatus module\n\t* Add: now the nagios.cmd named pipe reading is an external module\n\t* Add: statistics for the livestatus module (multisite needs it)\n\t* Add: retention modules for broker and arbiter\n\t* Add: reationner tag, like poller tag, but for reactionner\n\t* Add: (Denis GERMAIN) check_shinken plugin and interface in the arbiter to get data.\n\t* Add: (R\u00e9mi BUISSON) common init script for easy launch\n\t* Add: sendmailhost.pl + sendmailservices.pl in libexec.\n\t* Add: hot poller addition commands\n\t* Add: automatic VMware host-> VM dependencies modules, with VMotion support\n\t* Add: \"Unknown phase\", so limit useless notifications\n\n\nFIXES\n\t* Fix:the livestatus module so that multiple external commands in one request are possible. (thruk uses this for mass operations)\n\t* Fix:the livestatus, so that host_name and service_description are shown correctly for downtiems and comments.\n\t* Fix: (reported by: Raynald de Lahond\u00e8s) for python2.7, if shell launch, do not go in shlex split pass.\n\t* Fix: catch an exception when deregistering Pyro. (When the scheduler was started as the only process and no communication happened\n\t* Fix: Add the path of the current script (ex: bin/shinken-arbiter) and \"..\" to the list of paths where Python looks for shinken modules.\n\t* Fix: default config had duplicate command name define: check_http\n\t* Fix: clean Command(s) now subclass Item(s) as any \"shinken.objects\"\n\t* Fix: (reported by: Raynald de Lahond\u00e8s) if a hostgroup member got no host defined, create a dummy service for no host, so failed.\n\t* Fix: bad UTC hour for scheduler.\n\t* Fix: in a rare case, the picle need to call the __init__ of notification before the __get_state__, but it will call it without args.\n\t* Fix: (reported by: Raynald de Lahond\u00e8s) bad hostdep definition (link host) was badly detected.\n\t* Fix: utf8 management in the db class.\n\t* Fix: the * member was wrong in service calling hostgroup of this kind.\n\t* Fix: the schedule immediate check now work without having to force it.\n\t* Fix: correct the check launch under python2.7 with utf8 char.\n\t* Fix: (reported by: Denis GERMAIN) set by default retention update inverval to 60 minutes.\n\t* Fix: bad sys.path management for ndo module\n\t* Fix: too much loop in daemons! do_loop_tunr must WAIT a little! To managed in the main_loop part I think.\n\t* Fix: if the scheduler gotthe same conf but got a wait a new one before, it do a zombie scheduler then....\n\t* Fix: (reported by: Hienz Michael) do not close local file in the daemon pass.\n\t* Fix: (Raynald de Lahond\u00e8s) setup.py for bsd systems.\n\t* Fix: service without host will be just droped, like Nagios.\n\t* Fix: Nagios allow elements without contacts. Do alike.\n\t* Fix: add protection against adding again and again the same actions ifthe scheduler ask it, like for orphaned checks.\n\t* Fix: sys.path management, not far more clear and error proof\n\t* Fix: (reported by: capibaru) add a strip pass before loading cfg files.\n\t* Fix: raise only one log for orphaned instead of xK useless logs.\n\t* Fix: (Venelin Petkov) missing customs on services copy of a based one (multiple hosts, hostgroups, etc)\n\t* Fix: (reported by: Ronny Lindner) manage the not host expressions for services.\n\n\n0.5.1 - 19/01/2011\n------------------\nENHANCEMENTS\n\t*Add: Business rules\n\t*Add: Downtime for contacts\n\t*Add: Escalations based on time, with notification period shorting capabilities\n\t*Add: options allowed_hosts and max_logs_age to the livestatus broker\n\t*Add: some rarely used operators to the livestatus module (!>=)\n\t*Add: SSL connections between daemons with certificates and a CA\n\t*Add: module exception/kill catch in the scheduler.\n\t*Add: use the binary format for the pickle, so it take less space.\n\t*Add: (Hartmut Goebel) use universal open way for conf reading.\n\t*Add: support for unix sockets to the livestatus module\n\t*Add: criticity value for host/services, with problem/impacts max criticity management\n\t*Add: min_criticity definition in cotnact and notificationways.\n\t*Add: pylint and coverage pass in the integration server\n\t*Add: the new column pnpgraph_present to the livestatus module\n\t*Add: now create the pickle retention file with a .tmp, so in case of problem, we do not lost the old one.\n\t*Add: event handlers command can now be send by external commands\n\nFIXES\n\t*Fix: (Laurent Guyon) select with no timeout in NSCA arbiter module.\n\t*Fix: shinken init script: enable use of another \"default\" shinken file than hardcoded one by env variable.\n\t*Fix: (current_service_groups needs to return an empty list instead of string) in the livestatus module\n\t*Fix: 'setup.py -h install' now also exit\n\t*Fix: () crash for some bad conf, should raise a message instead.\n\t*Fix: missing check for no args in 'shinken' init script\n\t*Fix: a bug in livestatus Servicegroup.members, minor cosmetics, test case for thruk\n\t*Fix: a bug in host.parents livestatus representation to make thruk happy\n\t*Fix: check for /dev/shm access for the satellites.\n\t*Clean: Redesign of the livestatus module\n\t*Fix: testing with multisite and thruk\n\t*Clean: factorized .is_correct() call for all object types & added log to see more clearly wherer the error is.\n\t*Clean: factorization/simplification of code in action.py (and related) for spawning checks processes.+ clean of old deprecated commented code (& \"related\" too).\n\t*Fix: downtime and comment are now pickle in a dict, not a list.\n\t*Fix: pickle pass for look at tyype, so downtime and comment from 0.4 still ok.\n\t*Fix: acknoledge got too much information in the pickle pass, making the pickle save very very huge. Now fit from 100Mo to..2Mo :)\n\t*Clean: big clean of hasattr->getattr with default value\n\t*Clean: repalce dict for properties with real objects\n\t*Fix: Implement in_check_period/in_notification_period for livestatus to make multisite happy\n\t*Fix: Remove a leftover atribute from timeperiod&daterange\n\t*Fix: Transmit dateranges in timeperiod-full_status-broks\n\t*Fix: Replaced the deprecated StatsGroupBy, implemented Stats: for log entries, making Multisite happy with shinken-livestatus\n\t*Fix: manage the 'null' for inheritance.\n\t*Fix: add timeout to the status_dat module so that the status.dat is written even if no broks are sent.\n\t*Fix: escalations were offset of notif number by -1.\n\t*Fix: Replace Queue with an own implementation of LifoQueue for Python 2.4 (livestatus)\n\t*Fix: Fallback to sqlite 1.x for Python 2.4 (livestatus)\n\t*Fix: bug in the table structure where logging messages are kept (livestatus)\n\t*Fix: problem/impacts should be list, not string.\n\t*Fix: missing customs values in host/service tables in livestatus and Thruk was not happy.\n\t*Fix: is_impact/is_problem got bad format in lviestatus tables.\n\t*Fix: (Kristoffer Moegle) missing check in generic object configuration module.\n\t*Fix: a bug in livestatus. Catch the exception if a peer is not listening for the response\n\t*Fix: support for hosts without check_command (assumed to be always up)\n\t*Fix: hostgroup realm assoc was broken. Now it's tested.\n\t*Fix: (Maximilien Bersoult) fix mysql_db module search path.\n\t*Fix: bug in compensate time when thecore got event handler\n\t*Fix: a bug in the npcd module (spoolfile timestamp extension was float, not int)\n\t*Fix: windows registry paths.\n\t*Fix: problem with Nagios retention that was not happy about host properties type.\n\t*Fix: pickle/nagios retention was loading a retention host/service in the comment.ref link!\n\t*Fix: now only previously notified contacts are send for recovery notifications.\n\t*Fix: bug in NDO module for hostgroups\n\t*Fix: (0.5.1) bugs in LiveStatus module for Service get_full_name call and queries with no space after:\n\n0.4 - 08/12/2010\n------------------\nENHANCEMENTS\n\t*Add: Service generators\n\t*Add: \"Limit:\" in livestatus\n\t*Add: the scheduler now save retention data before stop or take a new conf\n\t*Add: the broker clean quit the modules before quitting\n\t*Add: better output to know which external process for the broker is who in the log\n\t*Add: NodeSet lib use if available for the [X-Y] keys in service generators.\n\t*Add: retention modules, Memcache, Redis or simple file.\n\t*Add: lot of tests, even a end_to_end one for Ha and load balanced installations\n\t*Add: user can put what he want as MACRO in resources.cfg\n\t*Add: lot of log output, and clean a lot of others\n\t*Add: conf sample for PNP integration.\n\t*Add: (Nicolas Dupeux) add a NSCA server module for the Arbiter! (only XOR and none encryption from now)\n\t*Add: now the retention_update_interval parameter is managed.\n\t*Add: the! character before a host_name is now managed in the services. (even if host was defined in a hostgroup). And with test.\n\t*Add: perfdata command management for host/service\n\t*Add: manage modules in the Arbtier and in the schedulers\n\t*Add: nowthe whole documentation is done in the wiki\n\t*Add: obsess_over_host/service and executing oc*p_commands like eventhandlers\n\t*Add: \"templates\" and modes and more for service/host perf data module.\n\t*Add: now host with no address are fill with host_name for this value.\n\t*Add: timeperiod inheritance\n\t*Add: Allow \"members *\" in a hostgroup definition\n\t*Add: manage inherit_parents for dependencies.\n\t*Add: system time change catch for satellites.\n\t*Add: enable_environment_macros now create or not the env dict for checks\n\t*Add: O*HP command management\n\nFIXES\n\t*Fix: Some missing properties in the livestatus tables\n\t*Fix: Some missing properties in the NDO/Mysql export\n\t*Fix: parents property was not stripped(), and a error value was not catched as error\n\t*fix: missing some errors catch in contact definitions\n\t*Fix: Nagios allow contact_name to miss if there is an alias\n\t*Fix: Nagios allow a contact with no 'action' if his options are n/n\n\t*Fix: Resolv macro can loop forever with special output. Now limit it at 32 loop max!\n\t*Fix: the env_macros were enable if we use the tweaks, not good. And they are REALLY CPU killers.\n\t*Fix: LiveStatus: do not close the socket before we are sure the other peer send us nothing. If so, we can close it.\n\t*Fix: solve a case where config files do not end with a line return and will mix parameters.\n\t*Fix: broker spare not look at pollers/reactionners when he come active.\n\t*Fix: now the poller/reactionner REALLY raise broks to the broker (it was clear before...)\n\t*Fix: bug in the Broker that make in some cases broks lost for extarnal modules if they come from the arbiter. (like logs)\n\t*Fix: add a workaround to the livestatus module so it can handle requests from thruk 0.71.1 (which uses strange Stats: requests)\n\t*Fix: rename all 'binaries' without the .py extention so distrib will be happy.\n\t*Fix: livestatus work now with Python 2.4\n\t*Fix: (Hermann Lauer) important bug in status.dat (and in fact all other 'external modules') that make the brok not manage in the good order in some case or Arbtier restart. Thanks a lot to Hermann Lauer that help me a LOT with all the debug logs!\n\t*Fix: (Zoran Zaric) big indentation cleanup\n\t*Fix: error handling in timeperiod inheritance\n\t*Fix: clean on the default configuration\n\t*Fix: manage additional_freshness_latency parameter with a test for check_freshness now.\n\t*Fix: setup.py can create a zip file (egg) for the librairy under Centos. It's not a good thing. It should avoid it\n\t*Fix: From Nicolas Dupeux: error in livestatus split.\n\t*Fix: From Nicolas Dupeux: fix typos in host code\n\n\n\n\n0.3 - 06/10/2010\n------------------\nENHANCEMENTS\n\t*Add: complex hostgroup amtching with & ( ) |!\n\t*Add: resultmodulation code and tests\n\t*Add: brok information about problem/impacts\n\t*Add: livestatus export about problem/impacts\n\t*Add: clean quit on daemons (pid file and sub processes)\n\t*Add: maintenance_period parameter in hosts and services\n\t*Add: even more unit test cases\n\t*Add: now external commands raised in livestatus module are taken by the arbiter\n\t*Add: satellites states are now exported by livestatus\n\t*Add: arbiter module managment\n\t*Add: GLPI import arbiter module :)\n\t*Add: notificationways for contacts\n\t*Add: warning about unmanaged parameters\n\t*Add: log rotation and syslog managment\n\n\nFIXES\n\t*Fix: install crash is now catch with Pyro 4 in Centos (python 2.4)\n\t*Fix: host/service dep where not filled with default properties\n\t*Fix: catch realm configuration errors\n\t*Fix: but in status.dat about parents printing\n\t*Fix: problem with the Collums talbe in livestatus module\n\t*Fix: next valid time was one minute delay for cases with excludes\n\t*Fix: livestatus export in json was bad for service group members\n\t*Fix: bug in windows check launch\n\t*Clean: dispatcher code about useless options\n\t*Clean: tests cases setUp\n\n\n0.2 - 06/09/2010\n------------------\nENHANCEMENTS\n\t*New code layout\n\t*Installation is easy with the setup.py process (first version from Maximilien Bersoult)\n\t*Now compatible with Pyro 3 AND 4\n\t*Now compatible with Python 2.4 and 2.5 too\n\t*Add sticky acknowledgement. Non-permanent ack-comments are now automatically removed\n\t*Add host acknowledgement and acknowledgement stickiness\n\t*Finished service problem acknowledgement. one more testcase\n\t*Add REMOVE_HOST/SVC_ACKNOWLEDGEMENT external command\n\t*Now broker get broks from pollers and reactionners. (Useful for Logs)\n\t*Give Broker a way to make broks :) (like for it's own log)\n\t*Add a problem/incident change states when apply. But it do not interfer with the standard check way of doing (or at least should not).\n\t*Add some LSB init.d scripts\n\t*Add max_plugins_output_length parameter to limit the checks output size.\n\t*\"Hack\" the old nagios parameters: now status_file and nagios_log are catched. If the user defined them, but do not defined the good broker modules, we create them \"on the fly\". I hope one day we will remove it...\n\t*Nested macros are managed (like USERN in ARGN macro).\n\t*Add a pass about changing Nagios2 properties to Nagios3 ones.\n\t*Add json outputformat to the livestatus module\n\t*Add a broker module npcdmod (plus test_npcdmod) which writes a perfdata file suitable for pnp4nagios\n\t*Add check_period implicitly inheritate to service from host.\n\t*Redesign of the notifications (far easier to understand than the old async way)\n\t*Notice about unused parameters and explain why it can be removed from conf.\n\t*Catch non standard return code in actions.py so we can add stderr to the output for such cases.\n\t*Now arbiter host_name property is not mandatory. But WARNING: for a multiple arbiter conf, it must be set.\n\t*Updated cfg documentation (Author: Luke L <lukehasnoname@gmail.com>)\n\t*Add documentation about date range format because it was not documented.\n\t*Update the nagios to shinken migration file\n\t*Change the way broks are send from Arbiter to Broker: before, the Broker connect to the Arbiter, take broks like for schedulers. But Arbiter also connect to broker. That's a nightmare about hangout. Now, Arbiter push the broks. It's far more easy and efficient.\n\t*Add template handling to servicedependencies\n\t*Add test_dependencies as the regression test\n\t*Less status_dat verbosity :)\n\t*Add a last_perf_data + macros to access last perfdatas as in https://sourceforge.net/apps/trac/shinken/ticket/76\n\t*HUGE clean on shinken-specific.cfg file.\n\t*Add a README file\n\t*Add a little note about how migrate from Nagios to Shinken\n\t*Add a hint about how solve 'cannot find my own arbiter' error message.\n\t*Add bin directory with some bash scripts to launch/stop the whole application.\n\t*Relative path, now we can have a easy portable sample configuration. (Gerhard)\n\t*Add two missing operators in livestatus.py\n\t*Big clean up conf sample!\n\t*No more modulespath need in brokerd.ini. Will be easier for packagers.\n\t*Acknowledgement test cases\n\t*Add some hard tests about timeperiods calculations\n\t*Add a test.sh script for Hudson test (launch all tests)\n\t*Add a problem/impact test.\n\t*Now external modules can return objects (from now nobody use it, but it can be useful in the future)\n\t*Make easier to raise checks/notificatiosn from in deep objects class.\n\t*repository cosmetics (Luke L)\n\nFIXES\n\t*Fix: now merlin is correctly filled with update program value\n\t*Bug Fix: ndo do not have command_file, so do not export it.\n\t*Bug fix: retention load was loading not good tab (impacts ones) and so cause problem with remove (not the good object!) (nicolas.dupeux)\n\t*Fix a bug in ACKNOWLEDGE_SVC_PROBLEM ext. command. Sticky can be 0/1/2, not bool\n\t*Bug fix in find_day_by_weekday_offset.\n\t*Bug Fix: when a date was calcl before teh ref time for a weekday it was not recalculated, so problem.\n\t*Bug Fix: error in get_end_of_day. It was given the first secon of the next day, so some exclude make problem with it.\n\t*Bug Fix: shell like commands where not good :(. Thanks to Gilles Seban for pointing it and to Hiren Patel for giving a list of shell caracters (so we know if we should use shell or not :) )\n\t*Bug fix: external commands to send checks should work now\n\t*Bug fix: Arbiter do not more crash when scheduler is down and broker is up (not initialized make a missign parameter)\n\t*Bug Fix: cehck orphaned was badly status set. Thanks Pylint.\n\t*Bug fix: host in unreach were set DOWN un state, but unreach in state_id. Now it say clearly it's UNREACHABLE.\n\t*Bug: retention was loading services objects from retention file. It's not good at all.\n\t*Fix a and -> or bug in the dependancies\n\t*Fix a bug in livestatus. state_type is now a number instead of HARD/SOFT\n\t*Fix a bug in the livestatus module. Eventhandler command is now serializable\n\t*Fix a bug in execute_unix. If there is an exception during plugin execution, use it's string representation as plugin_output\n\t*Fix a bug in the livestatus module. Multiline input is now possible\n\t*Bug: patch from David GU\u00c9NAULT about stopping all brokers\n\t*Correct launched/lanched type everywhere (Gr\u00e9gory Starck)\n\t*Fixed scheduler.add so that master notifications (without contact) don't create a status brok\n\t*Patch from Nicolas DUPEUX about typo correction in service.py\n\t*Reduce CPU comsumption of livestatus broker (thanks flox for the patch)\n\t*Fix a bug in the npcdmod test case\n\t*Fix: configurations files can be mix if the previous do not finished with a line return (Sebastian Reimers)\n\t*Fix: Correct a bad default arbiter pid configuration (Sebastian Reimers)\n\t*Bug fix a missing save of shinken-reactionner.py about path in relative mode\n\t*Global external commands now create an update_program_status_brok instead of program_status_brok\n\t*Fix a bug in the status_dat_broker (incorrect servicegroup-definition in objects.cache)\n\t*Fix: add Gerhard in print screen :)\n\t*Bug Fix: add duplication check for elements (and groups). Only service is allowed to have duplicated (will Warning, but no error).\n\t*Bug Fix: patch from Nicolas Dupeux. Thruk socket shutdowns are now handled in an exception\n\t*Bux Fix (Sven Velt): patch about recursive dir load and check timeperiod typo\n\t*NO MORE nap in code, now all are shinken :)\n\n\n\n0.1 - 31/05/2010\n------------------\nENHANCEMENTS\n\t*Initial realease\n", "To Fronteau Romuald for the logo :)\nTo Gerhard Lausser for patches, features and the Python Livestatus API\nTo Icinga guys for theirs sql files!\nTo David Walsh for mootools!\nTo Haypo for the Ipy lib!\nTo Maximilien Bersoult for it's setup.py\nTo Sebastian Reimers for being the first to add a ticket in the Trac, and hunting a lot of bugs :)\nTo Luke L for reading and correcting the website and the documentation :p\nTo Nicolas Dupeux for patches, bug fixes, bug reports and the NSCA daemon\nTo Gregory Starck for his patch about worker typo, and pyro hooks\nTo David Gu\u00e9nault for the installer, patches, bug fixes, WebUI and more\nTo David Hannequin for his bug reports and his packages :)\nTo Jfbutkiewicz for his full windows management (installation and services!!)\nTo Danijel Tasov for his repositiry cosmetics patch\nTo Zoran Zaric for his help on website corrections and for help file typos\nTo Gilles Seban for is bug report about commands that look like shells\nTo Hiren Patel for giving a list of shells caracters\nTo Sven Velt for it's patch about recursive dir load and check timeperiod typo\nTo Michael Jeanson for the first Shinken Ubuntu LTS package!\nTo Andreas Karfusehr for his proposition of donation of a Board licence :)\nTo Hermann Lauer for his help on the hard brok order bug in status.dat!\nTo Andreas Ericsson for his ideas for service generators\nTo Degremont Aurelien for his code about NodeSet and how to manage the multiple paterns\nTo \u041f\u0435\u0442\u0440\u043e\u0432 \u0418\u0432\u0430\u043d to identify a huge bug on windows\nTo Hartmut Goebel for his advice on code quality, and for the patches :)\nTo Gregory Ranchy for his help on the official doc\nTo Kristoffer Moegle for this patch on arbiter configuration module\nTo Eric Beaulieu for his help on the ssl certificates, and for the Windows installation script :)\nTo Laurent Guyon, our best bug hunter :)\nTo Alan Brenner for his SSL core for the NRPE module\nTo Venelin Petkov for this bug report about missing customs on services, and the 'print' in name bug problem :)\nTo Papp Tamas for his bug report of bad python version under ubuntu (and debian)\nTo R\u00e9mi Buisson for his bug report about bad etc/default/shinken file :)\nTo Julien Toscano for his bug report about bad launch_all.sh launch.\nTo Raynald de Lahond\u00e8s and the Sibio team for the FreeBSD testing, Tuto and the host dep bug report!\nTo Hienz Michael for the bug report about bad local_file :)\nTo Ronny Lindner for the bug report about non host expressions for services\nTo Olivier Hanesse bug reports, patches and new features\nTo Markus Elger for this bug report about no schedule retention data\nTo Vincent Riquer for his bug report about HA installation and sapre broker that stay alive\nTo Michael Grundmann for his bug report about service host exclusion and void hostgroup\nTo Jan Kaliszewski for his implementation of sorted dicts\nTo Claneys Skyne bug reports and patches\nTo Etienne Obriot for his patch about multiple = in macos values\nTo obiouane for his bug report about missing object value\nTo Thibault Cohen for his patches and bug reports\nTo Carmelle Monkoun for the bug report about Pyro4.8\nTo Bruno Clermont for the fix in bottle call and the typos\nTo St\u00e9phane Duchesneau for his work on the setup.py file and log/run driectories.\nTo grim for his bug report about disabling flapping options\nTo peter woodman for his bug report about timezone override crash\nTo Laurent Ollagnier for his bug report and patch about notification commands\nTo sprudhomme for his feature request about long_output in Centreon/Ndo\nTo Gabor Varga for his patch about the \"sc\" command for windowns setup :)\nTo foobar1111 for his ask about fqdn and arbiter matching for hostname\nTo twellspring for hs bug report about escalation and templates\nTo Michael Leinartas for his patch about man pages\nTo Nelson Pascoal for his patch about typos in daemons\nTo Steve Kieu for his bug report about missing name in Config object\nTo Victor Igumnov for his patch about Solaris installation\nTo Thomas Meson for his patch for setup.py and 1.0 version :)\nTo Manicow for his bug report on escalations\nTo Mocnik Matjaz for his dump of Allied equipement\nTo Daniel Roche for his bug report for hostdeps and multiple names\nTo Guillaume Bour (Uperto) for his numerous patches!\nTo Raphael Doursenaud for his patch about SNI option in https pack\nTo Forlot Romain for his multiple patches\nTo Michael Coquard for his patch about setup.py and build path\nTo Akiooutori for his bug report about pyro missing SOCK_REUSE parameter in some os\nTo Timo Veith for this work on the Wiki refactoring!\nTo Lars Hansson for this patches about cfg password module and Apache one\nTo the webui mobile guys: Mael Vincent, julien Pilou, Gael Millet, Damien Mathieu and hugo Viricel for their new webui mobile ui.\nTo Mathias Fussenegger for his large patch about configuration tab/space resolution.\nTo banderas07 and Radu Gheorghe for their works on the escalation notification_interval issue!\nTo Simon Rother for discovering a possible race condition.\nTo David Laval for his graphite templates on the linux checks\nTo nerocide for his bug report about bad event handler catch\nTo Mathieu.md for multiple configuration file updates\nTo raphaeltr for a typo patch on a monitoring pack\nTo Jan Ulferts for his patch about env macros fix on notifications\nTo R\u00e9mi Sauvat for his patch about dashboard automatic widget refresh\nTo chris81 for his patch for graphite API URLs\nTo maethor and scaminad for reporting IMAP/POPS missing port\nTo Florent Houbart for this bug fix on LiveStatus+NagVis\nTo olc and ppj for the arbiter spare bug report\nTo Nicolas Pichon for his patch about Graphite and custom macro use\nTo Thomas Cellerier for his patch about a ZeroMQ broker module.\nTo Christoph Roeder for his patch about pnp xml file in livestatus\nTo Fran\u00e7ois Lafont for his patch about business impact macro\nTo Spil-brensen for his patch about Scientific Linux in install script.\nTo jbeltran for his bug report about GLPIDB\nTo Joachim Schiele for his bug report about PNP version\nTo flaf and Imrane.Dessai for their bug report about additive inheritance.\nTo Johan Svensson for his bug report about poller worker crash not in logs, and for his patch about NRPE booster crash with bad SSL\nTo Finn Christiansen for his bug report about function get_all_host_names_set missing since 1.2.4\nTo Michael L\u00fcbben for his bug report about telnet crashing daemons\nTo GILLARDEAU Thibaut for his bug report about the windows pack\nTo Georges Racinet for his bugs reports about SSL\nTo pepejey for his bug report about void password in ldap auth module. And NO THANKS to the Ldap protocol RFC guys :( \nTo Benoit Dunand-Laisin for his bug report about livestatus command management regression\nTo Alexandre Veyrenc for his patch about Graphite management of perfdata with spare in names\nTo Frederic Mohier for his fix about nmap discovery and windows\nTo Micka\u00ebl Falck for his patch about network packs interface new parameters\nTo Squizou for his patch about ; split code\nTo Alexander Springer for his patch about merging host and services contacts\nTo Stefan Taute for his patch about syslog module collisions\nTo Jean-Claude Computing for his patch about syslog module collisions too\nTo Robin Gloster for his bug fix about bad wmi ini dir\nTo Samuel Milette-Lacombe for his patch about core configuration export on broker\nTo Mathieu Parent for his patch about Thruk doc\nTo Aina Rakotoson for his bug report about reactionner_tag logic fail, and his patch to fix about it\nTo jylenhofgfi for his bug report about shinken cli problems and | grep\nTo Alexandre Viau for his patch about passive unmanaged host broks generation\n", "#!/usr/bin/python2\n\n# -*- coding: utf-8 -*-\n\nimport os\nimport sys\nimport re\n\ntry:\n    import pwd\n    import grp\nexcept ImportError:\n    # don't expect to have this on windows :)\n    pwd = grp = None\nimport stat\n\n# Utility function to read the README file.\n# Used for the long_description.  It's nice, because now 1) we have a top level\n# README file and 2) it's easier to type in the README file than to put a raw\n# string in below ...\n\ntry:\n    from setuptools import setup\n    from setuptools import find_packages\nexcept:\n    sys.exit(\"Error: missing python-setuptools library\")\n\nfrom itertools import chain\nimport optparse\nimport itertools\nfrom glob import glob\n\nfrom distutils.dir_util import mkpath\n\ntry:\n    python_version = sys.version_info\nexcept:\n    python_version = (1, 5)\nif python_version < (2, 6):\n    sys.exit(\"Shinken require as a minimum Python 2.6.x, sorry\")\nelif python_version >= (3,):\n    sys.exit(\"Shinken is not yet compatible with Python3k, sorry\")\n\npackage_data = ['*.py', 'modules/*.py', 'modules/*/*.py']\n\n\ndef read(fname):\n    return open(os.path.join(os.path.dirname(__file__), fname)).read()\n\n\ndef ensure_dir_exist(f):\n    dirname = os.path.dirname(f)\n    if not os.path.exists(dirname):\n        os.makedirs(dirname)\n\n\ndef generate_default_shinken_file():\n    # The default file must have good values for the directories:\n    # etc, var and where to push scripts that launch the app.\n    templatefile = \"bin/default/shinken.in\"\n    build_base = 'build'\n    outfile = os.path.join(build_base, \"bin/default/shinken\")\n    \n    # print('generating %s from %s', outfile, templatefile)\n    \n    mkpath(os.path.dirname(outfile))\n    \n    bin_path = default_paths['bin']\n    \n    # Read the template file\n    f = open(templatefile)\n    buf = f.read()\n    f.close()\n    # substitute\n    buf = buf.replace(\"$ETC$\", default_paths['etc'])\n    buf = buf.replace(\"$VAR$\", default_paths['var'])\n    buf = buf.replace(\"$RUN$\", default_paths['run'])\n    buf = buf.replace(\"$LOG$\", default_paths['log'])\n    buf = buf.replace(\"$SCRIPTS_BIN$\", bin_path)\n    # write out the new file\n    f = open(outfile, \"w\")\n    f.write(buf)\n    f.close()\n\n\ndef update_file_with_string(infilename, outfilename, matches, new_strings):\n    f = open(infilename)\n    buf = f.read()\n    f.close()\n    for match, new_string in zip(matches, new_strings):\n        buf = re.sub(match, new_string, buf)\n    f = open(outfilename, \"w\")\n    f.write(buf)\n    f.close()\n\n\ndef append_file_with(infilename, outfilename, append_string):\n    f = open(infilename)\n    buf = f.read()\n    f.close()\n    ensure_dir_exist(outfilename)\n    f = open(outfilename, \"w\")\n    f.write(buf)\n    f.write('\\n')\n    f.write(append_string)\n    f.close()\n\n\ndef recursive_chown(path, uid, gid, owner, group):\n    print(\"Changing owner of %s to %s:%s\" % (path, owner, group))\n    os.chown(path, uid, gid)\n    if os.path.isdir(path):\n        for dirname, dirs, files in os.walk(path):\n            for path in itertools.chain(dirs, files):\n                path = os.path.join(dirname, path)\n                os.chown(path, uid, gid)\n\n\ndef get_uid(user_name):\n    try:\n        return pwd.getpwnam(user_name)[2]\n    except KeyError, exp:\n        return None\n\n\ndef get_gid(group_name):\n    try:\n        return grp.getgrnam(group_name)[2]\n    except KeyError, exp:\n        return None\n\n\n# Do a chmod -R +x\ndef _chmodplusx(d):\n    if not os.path.exists(d):\n        print \"warn: _chmodplusx missing dir\", d\n        return\n    if os.path.isdir(d):\n        for item in os.listdir(d):\n            p = os.path.join(d, item)\n            if os.path.isdir(p):\n                _chmodplusx(p)\n            else:\n                st = os.stat(p)\n                os.chmod(p, st.st_mode | stat.S_IEXEC | stat.S_IXGRP | stat.S_IXOTH)\n    else:\n        st = os.stat(d)\n        os.chmod(d, st.st_mode | stat.S_IEXEC | stat.S_IXGRP | stat.S_IXOTH)\n\n\nparser = optparse.OptionParser(\n    \"%prog [options]\", version=\"%prog \")\nparser.add_option('--root', dest=\"proot\", metavar=\"ROOT\", help='Root dir to install, usefull only for packagers')\nparser.add_option('--upgrade', '--update', dest=\"upgrade\", action='store_true', help='Only upgrade')\nparser.add_option('--owner', dest=\"owner\", metavar=\"OWNER\", help='User to install with, default shinken')\nparser.add_option('--group', dest=\"group\", metavar=\"GROUP\", help='Group to install with, default shinken')\nparser.add_option('--install-scripts', dest=\"install_scripts\", help='Path to install the shinken-* scripts')\nparser.add_option('--skip-build', dest=\"skip_build\", action='store_true', help='skipping build')\nparser.add_option('-O', type=\"int\", dest=\"optimize\", help='skipping build')\nparser.add_option('--record', dest=\"record\", help='File to save writing files. Used by pip install only')\nparser.add_option('--single-version-externally-managed', dest=\"single_version\", action='store_true', help='I really dont know, this option is for pip only')\n\nold_error = parser.error\n\n\ndef _error(msg):\n    print 'Parser error', msg\n\n\nparser.error = _error\nopts, args = parser.parse_args()\n# reenable the errors for later use\nparser.error = old_error\n\nroot = opts.proot or ''\n\n# We try to see if we are in a full install or an update process\nis_update = False\n# Try to import shinekn but not the local one. If avialable, we are in\n# and upgrade phase, not a classic install\ntry:\n    if '.' in sys.path:\n        sys.path.remove('.')\n    if os.path.abspath('.') in sys.path:\n        sys.path.remove(os.path.abspath('.'))\n    if '' in sys.path:\n        sys.path.remove('')\n    import shinken\n    \n    is_update = True\n    print \"Previous Shinken lib detected (%s)\" % shinken.__file__\nexcept ImportError:\n    pass\n\nif '--update' in args or opts.upgrade or '--upgrade' in args:\n    print \"Shinken Lib Updating process only\"\n    if 'update' in args:\n        sys.argv.remove('update')\n        sys.argv.insert(1, 'install')\n    if '--update' in args:\n        sys.argv.remove('--update')\n    if '--upgrade' in args:\n        sys.argv.remove('--upgrade')\n    \n    print \"Shinken Lib Updating process only\"\n    is_update = True\n\nis_install = False\nif 'install' in args:\n    is_install = True\n\n# Last step for pip insta an install one (at least in pip 9.0.1)\nis_pip_real_install_step = 'bdist_wheel' in sys.argv\nif is_pip_real_install_step:\n    is_update = False\n    is_install = True\n\n\ninstall_scripts = opts.install_scripts or ''\n\nuser = opts.owner or 'shinken'\ngroup = opts.group or 'shinken'\n\n# Maybe the user is unknown, but we are in a \"classic\" install, if so, bail out\nif is_install and not root and not is_update and pwd and not opts.skip_build:\n    uid = get_uid(user)\n    gid = get_gid(group)\n    \n    if uid is None or gid is None:\n        print \"Error: the user/group %s/%s is unknown. Please create it first 'useradd %s'\" % (user, group, user)\n        sys.exit(2)\n\n# setup() will warn about unknown parameter we already managed\n# to delete them\ndeleting_args = ['--owner', '--group', '--skip-build']\n\nto_del = []\nfor a in deleting_args:\n    for av in sys.argv:\n        if av.startswith(a):\n            idx = sys.argv.index(av)\n            print \"AV,\", av, \"IDX\", idx\n            to_del.append(idx)\n            # We can have --owner=shinken or --owner shinken, if so del also the\n            # next one\n            if '=' not in av:\n                to_del.append(idx + 1)\n\nto_del.sort()\nto_del.reverse()\nfor idx in to_del:\n    sys.argv.pop(idx)\n\n# compute scripts\nscripts = [s for s in glob('bin/shinken*') if not s.endswith('.py')]\n\n# Define files\nif sys.platform.startswith('win'):\n    default_paths = {\n        'bin'    : install_scripts or \"c:\\\\shinken\\\\bin\",\n        'var'    : \"c:\\\\shinken\\\\var\",\n        'share'  : \"c:\\\\shinken\\\\var\\\\share\",\n        'etc'    : \"c:\\\\shinken\\\\etc\",\n        'log'    : \"c:\\\\shinken\\\\var\",\n        'run'    : \"c:\\\\shinken\\\\var\",\n        'libexec': \"c:\\\\shinken\\\\libexec\",\n    }\n    data_files = []\nelif 'linux' in sys.platform or 'sunos5' in sys.platform:\n    default_paths = {\n        'bin'    : install_scripts or \"/usr/bin\",\n        'var'    : \"/var/lib/shinken/\",\n        'share'  : \"/var/lib/shinken/share\",\n        'etc'    : \"/etc/shinken\",\n        'run'    : \"/var/run/shinken\",\n        'log'    : \"/var/log/shinken\",\n        'libexec': \"/var/lib/shinken/libexec\",\n    }\n    data_files = [\n        (\n            os.path.join('/etc', 'init.d'),\n            ['bin/init.d/shinken',\n             'bin/init.d/shinken-arbiter',\n             'bin/init.d/shinken-broker',\n             'bin/init.d/shinken-receiver',\n             'bin/init.d/shinken-poller',\n             'bin/init.d/shinken-reactionner',\n             'bin/init.d/shinken-scheduler',\n             ]\n        )\n    ]\n    \n    if is_install:\n        # warning: The default file will be generated a bit later\n        data_files.append(\n            (os.path.join('/etc', 'default', ),\n             ['build/bin/default/shinken']\n             ))\nelif 'bsd' in sys.platform or 'dragonfly' in sys.platform:\n    default_paths = {\n        'bin'    : install_scripts or \"/usr/local/bin\",\n        'var'    : \"/usr/local/libexec/shinken\",\n        'share'  : \"/usr/local/share/shinken\",\n        'etc'    : \"/usr/local/etc/shinken\",\n        'run'    : \"/var/run/shinken\",\n        'log'    : \"/var/log/shinken\",\n        'libexec': \"/usr/local/libexec/shinken/plugins\",\n    }\n    data_files = [\n        (\n            '/usr/local/etc/rc.d',\n            ['bin/rc.d/shinken-arbiter',\n             'bin/rc.d/shinken-broker',\n             'bin/rc.d/shinken-receiver',\n             'bin/rc.d/shinken-poller',\n             'bin/rc.d/shinken-reactionner',\n             'bin/rc.d/shinken-scheduler',\n             ]\n        )\n    ]\nelse:\n    raise Exception(\"Unsupported platform, sorry\")\n    data_files = []\n\n# Change paths if need\n# if root:\n#    for (k,v) in default_paths.iteritems():\n#        default_paths[k] = os.path.join(root, v[1:])\n\n\n# Beware to install scripts in the bin dir\ndata_files.append((default_paths['bin'], scripts))\n# Only some platform are managed by the init.d scripts\nif is_install and ('linux' in sys.platform or 'sunos5' in sys.platform):\n    generate_default_shinken_file()\n\nif not is_update:\n    ## get all files + under-files in etc/ except daemons folder\n    daemonsini = []\n    for path, subdirs, files in os.walk('etc'):\n        if len(files) == 0:\n            data_files.append((os.path.join(default_paths['etc'], re.sub(r\"^(etc\\/|etc$)\", \"\", path)), []))\n        for name in files:\n            if name == 'shinken.cfg':\n                continue\n            if 'daemons' in path:\n                daemonsini.append(os.path.join(path, name))\n            else:\n                data_files.append((os.path.join(default_paths['etc'], re.sub(r\"^(etc\\/|etc$)\", \"\", path)),\n                                   [os.path.join(path, name)]))\n\nif os.name != 'nt' and not is_update:\n    for _file in daemonsini:\n        inifile = _file\n        outname = os.path.join('build', _file)\n        # force the user setting as it's not set by default\n        append_file_with(inifile, outname, \"modules_dir=%s\\nuser=%s\\ngroup=%s\\n\" % (\n            os.path.join(default_paths['var'], 'modules'),\n            user, group))\n        data_files.append((os.path.join(default_paths['etc'], 'daemons'),\n                           [outname]))\n    \n    # And update the shinken.cfg file for all /usr/local/shinken/var\n    # value with good one\n    for name in ['shinken.cfg']:\n        inname = os.path.join('etc', name)\n        outname = os.path.join('build', name)\n        print('updating path in %s', outname)\n        \n        ## but we HAVE to set the shinken_user & shinken_group to thoses requested:\n        update_file_with_string(inname, outname,\n                                [\"shinken_user=\\w+\", \"shinken_group=\\w+\", \"workdir=.+\", \"lock_file=.+\", \"local_log=.+\", \"modules_dir=.+\", \"pack_distribution_file=.+\"],\n                                [\"shinken_user=%s\" % user,\n                                 \"shinken_group=%s\" % group,\n                                 \"workdir=%s\" % default_paths['var'],\n                                 \"lock_file=%s/arbiterd.pid\" % default_paths['run'],\n                                 \"local_log=%s/arbiterd.log\" % default_paths['log'],\n                                 \"modules_dir=%s\" % os.path.join(default_paths['var'], 'modules'),\n                                 \"pack_distribution_file=%s\" % os.path.join(default_paths['var'], 'pack_distribution.dat')],\n                                )\n        data_files.append((default_paths['etc'], [outname]))\n\n# Modules, doc, inventory and cli are always installed\npaths = ('modules', 'doc', 'inventory', 'cli')\nfor path, subdirs, files in chain.from_iterable(os.walk(patho) for patho in paths):\n    for name in files:\n        data_files.append((os.path.join(default_paths['var'], path), [os.path.join(path, name)]))\n\nfor path, subdirs, files in os.walk('share'):\n    for name in files:\n        data_files.append((os.path.join(default_paths['share'], re.sub(r\"^(share\\/|share$)\", \"\", path)),\n                           [os.path.join(path, name)]))\n\nfor path, subdirs, files in os.walk('libexec'):\n    for name in files:\n        data_files.append((os.path.join(default_paths['libexec'], re.sub(r\"^(libexec\\/|libexec$)\", \"\", path)),\n                           [os.path.join(path, name)]))\n\ndata_files.append((default_paths['run'], []))\ndata_files.append((default_paths['log'], []))\n\n# Note: we do not add the \"scripts\" entry in the setup phase because we need to generate the\n# default/shinken file with the bin path before run the setup phase, and it's not so\n# easy to do in a clean and easy way\n\nnot_allowed_options = ['--upgrade', '--update']\nfor o in not_allowed_options:\n    if o in sys.argv:\n        sys.argv.remove(o)\n\nrequired_pkgs = ['pycurl']\nsetup(\n    name=\"Shinken\",\n    version=\"2.4.3\",\n    packages=find_packages(),\n    package_data={'': package_data},\n    description=\"Shinken is a monitoring framework compatible with Nagios configuration and plugins\",\n    long_description=read('README.rst'),\n    author=\"Gabes Jean\",\n    author_email=\"naparuba@gmail.com\",\n    license=\"GNU Affero General Public License\",\n    url=\"http://www.shinken-monitoring.org\",\n    zip_safe=False,\n    classifiers=[\n        'Development Status :: 5 - Production/Stable',\n        'Environment :: Console',\n        'Intended Audience :: System Administrators',\n        'License :: OSI Approved :: GNU Affero General Public License v3',\n        'Operating System :: MacOS :: MacOS X',\n        'Operating System :: Microsoft :: Windows',\n        'Operating System :: POSIX',\n        'Programming Language :: Python',\n        'Topic :: System :: Monitoring',\n        'Topic :: System :: Networking :: Monitoring',\n    ],\n    install_requires=[\n        required_pkgs\n    ],\n    \n    extras_require={\n        'setproctitle': ['setproctitle']\n    },\n    \n    data_files=data_files,\n)\n\n# if root is set, it's for package, so NO chown\nif pwd and not root and is_install:\n    # assume a posix system\n    uid = get_uid(user)\n    gid = get_gid(group)\n    \n    if uid is not None and gid is not None:\n        # recursivly changing permissions for etc/shinken and var/lib/shinken\n        for c in ['etc', 'run', 'log', 'var', 'libexec']:\n            p = default_paths[c]\n            recursive_chown(p, uid, gid, user, group)\n        # Also change the rights of the shinken- scripts\n        for s in scripts:\n            bs = os.path.basename(s)\n            recursive_chown(os.path.join(default_paths['bin'], bs), uid, gid, user, group)\n            _chmodplusx(os.path.join(default_paths['bin'], bs))\n        _chmodplusx(default_paths['libexec'])\n    \n    # If not exists, won't raise an error there\n    _chmodplusx('/etc/init.d/shinken')\n    for d in ['scheduler', 'broker', 'receiver', 'reactionner', 'poller', 'arbiter']:\n        _chmodplusx('/etc/init.d/shinken-' + d)\n\ntry:\n    import pycurl\nexcept ImportError:\n    print \"Warning: missing python-pycurl lib, you MUST install it before launch the shinken daemons\"\n\ntry:\n    import cherrypy\nexcept ImportError:\n    print \"Notice: for better performances for the daemons communication, you should install the python-cherrypy3 lib\"\n\nprint \"Shinken setup done\"\n", "# -*- coding: utf-8 -*-\n\n# Copyright (C) 2009-2014:\n#     Gabes Jean, naparuba@gmail.com\n#     Gerhard Lausser, Gerhard.Lausser@consol.de\n#     Gregory Starck, g.starck@gmail.com\n#     Hartmut Goebel, h.goebel@goebel-consult.de\n#\n# This file is part of Shinken.\n#\n# Shinken is free software: you can redistribute it and/or modify\n# it under the terms of the GNU Affero General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Shinken is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU Affero General Public License for more details.\n#\n# You should have received a copy of the GNU Affero General Public License\n# along with Shinken.  If not, see <http://www.gnu.org/licenses/>.\n\nimport sys\nimport cPickle\nfrom cStringIO import StringIO\n\n\n\n# Unpickle but strip and remove all __reduce__ things\n# so we don't allow external code to be executed\n# Code from Graphite::carbon project\nclass SafeUnpickler(object):\n    PICKLE_SAFE = {\n        'copy_reg': set(['_reconstructor']),\n        '__builtin__': set(['object', 'set']),\n    }\n\n\n    @classmethod\n    def find_class(cls, module, name):\n        if module not in cls.PICKLE_SAFE and not module.startswith('shinken.'):\n            raise ValueError('Attempting to unpickle unsafe module %s' % module)\n        __import__(module)\n        mod = sys.modules[module]\n        if not module.startswith('shinken.') and name not in cls.PICKLE_SAFE[module]:\n            raise ValueError('Attempting to unpickle unsafe class %s/%s' %\n                             (module, name))\n        return getattr(mod, name)\n\n\n    @classmethod\n    def loads(cls, pickle_string):\n        pickle_obj = cPickle.Unpickler(StringIO(pickle_string))\n        pickle_obj.find_global = cls.find_class\n        return pickle_obj.load()\n", "#!/usr/bin/env python\n# Copyright (C) 2009-2014:\n#    Gabes Jean, naparuba@gmail.com\n#    Gerhard Lausser, Gerhard.Lausser@consol.de\n#\n# This file is part of Shinken.\n#\n# Shinken is free software: you can redistribute it and/or modify\n# it under the terms of the GNU Affero General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Shinken is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU Affero General Public License for more details.\n#\n# You should have received a copy of the GNU Affero General Public License\n# along with Shinken.  If not, see <http://www.gnu.org/licenses/>.\n\n#\n# This file is used to test reading and processing of config files\n#\n\n\nimport cPickle as pickle\nfrom shinken_test import *\n\nfrom shinken.safepickle import SafeUnpickler\n\n\nshould_not_change = False\ndef fff(b):\n    global should_not_change\n    should_not_change = b\n\n\nclass SadPanda(object):\n    def __reduce__(self):\n        return (fff, (True,))\n\n\nclass TestSafePickle(ShinkenTest):\n\n    def setUp(self):\n        pass\n\n\n    def launch_safe_pickle(self, buf):\n        SafeUnpickler.loads(buf)\n        \n        \n    def test_safe_pickle(self):\n        global should_not_change\n\n        print \"Creating payload\"\n        buf = pickle.dumps(SadPanda(), 0)\n        should_not_change = False\n        print \"Payload\", buf\n        #self.assertEqual('HARD', host.state_type)\n        print \"Now loading payload\"\n        pickle.loads(buf)\n        print should_not_change\n        self.assertTrue(should_not_change)\n        \n        # reset and try our fix\n        should_not_change = False\n        #SafeUnpickler.loads(buf)\n        def launch_safe_pickle():\n            SafeUnpickler.loads(buf)\n        self.assertRaises(ValueError, launch_safe_pickle)\n        print should_not_change\n        self.assertFalse(should_not_change)\n        \n        \nif __name__ == '__main__':\n    unittest.main()\n"], "fixing_code": ["########################\nShinken ChangeLog\n########################\n\n\n2.4.4 - XX/02/2022\n-----------------\n        CORE ENHANCEMENT\n        Enh: (backport from Enterprise, internal ref #SEF-202) Big boost for the broker daemons, especially for very large setups and slow modules (yes Graphite, I'm looking at you).\n        Enh: (backport from Enterprise ref:#SEF-103) Slight boost of startup time by remiving useless hash computation.\n        Enh: (Christophe Simon) Force problem/impact evaluation\n        Enh: (Christophe Simon) added strict object name conflict policy\n        Enh: (Christophe Simon) better objects balancing between schedulers (#1999)\n        Enh: (Christophe Simon) Maintenance checks (#1929)\n        Enh: (Nicolas DUPEUX) Add an option to dump configuration as build by shinken to a json file (#1954)\n        Enh: (Lionel Sausin) Add instructions to use --install-scripts in pip (#1890)\n        Enh: (Christophe Simon) extend duplicate_foreach to host/hostgroups (#1905)\n        Enh: (Christophe Simon) Made memory free an opt-in option\n        Enh: (Christophe Simon) Explicitly frees memory when receiving new conf\n        Enh: (Christophe Simon) Harmonized graceful restart\n        Enh: (David Durieux) Add support of proxy socks5 for shinken cli (#1583)\n        Enh: (Mateusz Korniak) Add info about exit error code when check finished with error/was signalled. (#1766)\n\n        CORE FIXES\n        Fix: (backport from Enterprise ref:#SEF-76) In some case, we can have \"negative\" value for downtime depth, and then the element will never exit from downtime.\n        Fix: Dailymotion team (Nicolas Perraud) found a way to bypass pickle.loads protection and execute code from daemon if you can exchange with it's internal port. Now we whitelist allowed class only :)\n        Fix: (Christophe Simon) Enforced downtime state after retention load\n        Fix: (V. D'AGOSTINO) Update about.rst to fix a typo\n        Fix: (Flavien Peyre) multiple notification way when using a contact template (#1867)\n        Fix: (Dani Rodr\u00edguez) Update typographic errors and explain things in the help messages (#1968)\n        Fix: (Dani Rodr\u00edguez) brok queues not producing broks (#1971)\n        Fix: (David Gil) Pin CherryPy dependpency < 9.0.0 (#1983)\n        Fix: (Vladimir Kazarin) Update dmz-monitoring.rst (#1980)\n        Fix: (Muhammad Zeeshan Qazi) #1961 : Replace #!/usr/bin/python to #!/usr/bin/python2 (#1979)\n        Fix: (Dani Rodr\u00edguez) Fixes calls to cProfile in shinken binaries (#1967)\n        Fix: (wilfriedroset) shinken typo (#1974)\n        Fix: (efficks) CherryPy >= 3 required (#1943)\n        Fix: (David Gil) osmatch in nmap discovery process (#1944)\n        Fix: (Konstantin Shalygin) modules_manager: ignore '.git' dir when load modules. (#1883)\n        Fix: (Christophe Simon) http_client exceptions management\n        Fix: (Christophe Simon) OSX (darwin) platform detection\n        Fix: (Christophe Simon) unicode string parisng in shinken cmdline\n        Fix: (Olivier Hanesse) missing ini file for shinken.io\n        Fix: (Olivier Hanesse) #1857 Set default value for proxy/proxy_socks5 for shinken cli\n        Fix: (Olivier Hanesse) #1845 Add missing paramter for statsd\n        Fix: (Nicolas Le Manchet) Improve systemd units reliability\n        Fix: (Fr\u00e9d\u00e9ric MOHIER) Iterate correctly in the Services object (#1842)\n\n\n        MISC FIXES\n        Fix: (Yann 'Ze' Richard) missing email header to prevent \"Out Of Office\" messages (#2014)\n        Fix: (se4598*) #1951: Email notification in text mode (#1986)\n        Enh: (Arthur Lutz) starttls and username/password for SMTP\n        Fix: (George Shuklin) trace on sening smtp messages\n        Doc: (rdmo) than -> as\n        Doc: (dodofox) specify host inheritance for contact/contactgroup (#1872)\n        Doc: (Elliott Peay) Fix default reactionner port in docs\n        Fix: (Konstantin Shalygin) Encode attachment. (#1817)\n        Fix: (Marc Remy) Typo: Update some doc files. (#1821)\n\n\n2.4.3 - 10/03/2016\n-------------------\n        CORE ENHANCEMENT\n        Add: First version for a online profiling system, not enabled currently\n\n        CORE FIXES\n        Fix: Fix missing Services/Hosts in Livestatus (Close #1691)\n        Fix: initial_state mapping for hosts\n        Fix: Fix duration when a parent is down (Close #1779)\n        Add: Better logging for regenerator\n\n        MISC ENHANCEMENT\n        Enh: HTML mail notifications fix and improvements\n        Enh: Change TCP Connect scan to TCP Syn scan with nmap for discovery features\n        Enh: Various Documentation \n\n2.4.2 - 01/10/2015\n-------------------\n        CORE ENHANCEMENT\n        Add: Service excludes/includes/overrides extension\n        Add: Implementation of inital_state\n        Add: Broks when host/service downtime is scheduled\n        Add: Solaris SMF manifests\n        Enh: Allow white space between foreach elements\n        Enh: Increase default http thread_pool to 16\n\n        CORE FIXES\n        Fix: Duplicate Service from template using duplicate_foreach with the same name\n        Fix: Service_(includes|excludes) template recursion\n        Fix: Service description with multi level inheritance \n        Fix: Default business rule notification options\n\n2.4.1 - 15/07/2015\n-------------------\n        CORE ENHANCEMENT\n        Add: Safe Pickle\n        Add: Better Debian 8 Jessie support\n\n        CORE FIXES\n        Fix: Display_name when using duplicate_foreach\n        Fix: template definition loop did segfault python\n        Fix: Service Description inheritance when using several level of inheritance\n        Fix: cpu looping for receiver\n\n2.4   - 04/05/2015\n-------------------\n\tCORE ENHANCEMENT\n\tAdd: Hosts - Service_includes feature. Similar to service_excludes\n\tAdd: Deprecation in the doc about the discovery part. Should be move to contrib or as a module in next versions\n\tAdd: (by Ddurieux) better logging of failed external modules\n\n\n\tEnh: Actions - Catch stderr output\n\tEnh: Arbiter -  Unpickle new conf earlier. Prevent a memory issue\n\tEnh: Config - Remove sudo from restart/reload commands\n\tEnh: Daemon - Factorization of  get_objects_from_from_queues\n\tEnh: DaemonsLinks : Move files to object directory\n\tEnh: Datamanager - Function get_contactgroup\n\tEnh: Doc - A lot of typo and improvements!\n\tEnh: Init Scripts - use readlink to avoid failure on symlinks\n\tEnh: Modulesmanager - Reworking module loading, now try to import in 3 different ways\n\tEnh: Pep8 : Shinken is now pep8 compliant (enforced by Travis) excepted for 3 specific rules\n\tEnh: Scheduler - Use iterator instead of list when necessary. Reduce memory consumption\n\tEnh: Setup - Refactoring to be virtualenv compatible\n\tEnh: Tests - Stabilization\n\n\n\tDel: Check Shinken script. It has its own repository\n\tDel: Windows files from 1.4 version\n\n\n\tCORE FIXES\n\tFix: Config Parsing - Arbiter module auto creation\n\tFix: Config Parsing - Infinite recursion loop in template\n\tFix: Config Parsing - Inheritance of custom variable\n\tFix: Config Parsing - Raise error properly in ArbiterLink object\n\tFix: Config Parsing - Type properties in Contact, NotificationWay and Arbiter objects\n\tFix: Escalations - escalated parameter in notification object and macro $NOTIFICATIONISESCALATED$ are set correctly\n\tFix: Event Handlers - Global event handlers parsing and launching\n\tFix: External Command - Internal argument for CHANGE_RETRY_HOST_CHECK_INTERVAL command\n\tFix: Realm - Bailout when there are two default realm\n\tFix: (reported by:St\u00e9phane Loeuillet) init.d - Unset http(s)_proxy env variables in the init.d script (curl was using them by default)\n\tFix: (reported by: Arthur Lutz) CLI - manage shinken install call without arguments\n\tFix: (reported by mohierf) STATS - fix statsd format.\n\tFix: (reported by: St\u00e9phane Loeuillet) Config Parsing - manage , case at the end of members list (hostgroups & contactgroups)\n\tFix: (reported by: St\u00e9phane Loeuillet) Config Parsing - host check_period was mandatory with some parameters, now is missing always true period.\n\tFix: + char in servicegroups\n\n\n\n\n2.2   - 16/01/2015\n-------------------\n\tCORE ENHANCEMENT\n\tAdd : Bottle - HTTP_X_FORWARDED_PROTO support (for WebUI)\n\tAdd : BpRules - Expands bp_rules t flag from tags\n\tAdd : BpRules - Use standard macros expansion in bp_rules output\n\tAdd : Broks - new type unknown_check_result_brok (included in the previous add)\n\tAdd : CLI - update command for the shinken.io install\n\tAdd : Contact - new parameter expert. For UI purpose\n\tAdd : Escalations - Time properties for host and service escalations\n\tAdd : External Command - Implement SCHEDULE_HOSTGROUP_HOST_DOWNTIME and SCHEDULE_HOSTGROUP_SVC_DOWNTIME\n\tAdd : External Commands - Reload-config function\n\tAdd : External Commands - support for reset modify attribute\n\tAdd : HTTP API - get_start_time call returning timestamp\n\tAdd : HTTP API - Inner stats can be sent to shinken.io\n\tAdd : LogEvent - Output key to properties dict\n\tAdd : LogEvent - Pattern for FLAPPING events\n\tAdd : Receiver - Accept passive results from host or service not in configuration\n\tAdd : Realms - Handle properly multi level of realms\n\tAdd : SchedulingItem - callbacks for HOSTDOWNTIME and SERVICEDOWNTIME macros\n\tAdd : SchedulingItem - Parameter to remove host-service dependency\n\tAdd : Service Escalation - wildcard service_description\n\tAdd : Service - method  get_service_tags (for WebUI)\n\tAdd : Snapshots  - Feature to get more output when we have a bad state\n\t\n\tDel : Move WebUI image and template to the good repo\n\tDel : Pack Distribution tuning (hosts where fixd on the same scehduler between reload) - causing more damage in load balancing that it solve problems\n\n\tEnh : CLI now exit with a real system return code when fail to install\n\tEnh : Config - Module name formatting in config files\n\tEnh : Config parsing - Refactoring to pythonize at object creation. Attribute have correct type very early.\n\tEnh : Config parsing - Refactoring to reduce parse time, and scope code to ease future evolutions\n\tEnh : Daemon - Refactor bailout and edit message\n\tEnh : Datarange - Better datarange parsing\n\tEnh : Deamon - additional call to  os.setgroups to drop privileges\n\tEnh : Doc - A lot of typo and improvments!\n\tEnh : External Command - Moved manager initialization to init\n\tEnh : Imports - use importlib when available to import module properly.\n\tEnh : Init scripts - Refactoring script. Add LSB standard functions\n\tEnh : Logger - Only use time rotated file handler for regular files\n\tEnh : Logger - Refactoring logger class to inherit from standard logger class.\n\tEnh : Logger - Use lazy logger syntax to enhance performances\n\tEnh : Perfdata - Better internal parsing\n\tEnh : Realm - Code refactoring\n\tEnh : Scheduler - use a lock to acces put_result\n\tEnh : SchedulingItem - use return_code attribute to remember plugin return code so that it is available in broks.\n\tEnh : Tests - better Jenkins and Travis integration and Coverall support\n\tEnh : Tests - Code cleaning\n\tEnh : Tests - Use assert function from unittest2\n\tEnh : Triggers - Try except statement when executing them\n\n\n\tCORE FIXES\n\tFix : BpRules - '+' was causing segfault in some cases\n\tFix : Broker - Crash when sub process goes down\n\tFix : Config parsing - Unknown members list is common to all items\n\tFix : Daemon - Proper https URL\n\tFix : Daemons - Timeout and data timeout for scheduler connexion\n\tFix : Daemon - When replacing a daemon kill all processes in the group instead of one pid\n\tFix : Datamanager -  Service totals and host totals computation\n\tFix : Discovery - Linux hosts with recent nmap versions\n\tFix : HTTP API - Code stabilization\n\tFix : HTTP API - Realm not displayed in get-all-states call\n\tFix : Init scripts - Use last python version\n\tFix : Logs - Manage pre-daemon logs.\n\tFix : Macroresolver - Move output_macros definition to avoid error in WebUI (eltdetail template)\n\tFix : Notifications - Master notifications must not be sent to reactionner so that we scatter them.\n\tFix : Passive reactionners are now working\n\tFix : Scheduler - Pack size for multi-schedulers environnements. Reduce memory consumption and boot time in big setup.\n\tFix : Scheduler - Segfault with circular service dependency loop\n\tFix : Scheduler - Skip compensate if daemon is not init\n\tFix : SchedulingItem - Bad behavior for use_aggressive_host_checking.\n\tFix : SchedulingItem - Up state for a host generates a recovery if necessary\n\tFix : SSL - Crash under Windows\n\tFix : Timeperiods - remove bad modulo calculation for months\n\tFix : Sub-sub-realms where not assigned to higer realms brokers/reactionners\n\tFix : Add callbacks for HOSTDOWNTIME and SERVICEDOWNTIME macros\n\n\n\n2.0-RC   - 10/02/2014\n---------------------\n\tCORE ENHANCEMENT\n\tEnh : Replace Pyro layer with HTTP(s) communication layer, still the same ports of course\n\tEnh : (huge) Business rules enhancement (parsing level, output and tag/group linking) (thanks to Christophe Simon)\n\tAdd : Shinken command line interface (cli) to install packages (module and packs) and serve doc\n\tEnh : Split configuration files into directory for daemons and objects\n\tAdd : service_check_timeout : customize exit status\n\tEnh : Ensure LSB path for daemons and default paths\n\tDel : Nagios(r) references from test dir\n\tEnh : Test coverage : Tests have now report per file and a global percentage of code coverage is available\n\tEnh : installation is now possible with \"pip install shinken\"\n\tDel : remove the python 2.4/2.5 compatibility. Now shinken need >= 2.6\n\tAdd : definition_order parameter for objects order twins remove, only active for services\n\tEnh : remove lot of useless configuration file samples\n\tEnh : do not bail out at startup is a host service is not having a valid host, just raise a warning now\n\tAdd : big doc grok from wiki into rst files into /doc. Thanks guys for this! compile with sphinx\n\tAdd : (from Christophe Simon) Added bp_rule child notification opts management\n\tAdd : (from Christophe Simon) service_overrides attributes to hosts\n\tAdd : (from Jean-charles Delon) manage duplicate_foreach and event_handler\n\tAdd : (from Christophe Simon) Added reversed (negative) xof business rules\n\tAdd : (from Christophe Simon) percentage support to Xof: business rules\n\tAdd : (from Jan Ulferts) enable_environment_macros and disable_environment_macros to commands\n\tAdd : (from Christophe Simon) service excludes feature\n\t\n\n\n\tCORE FIXES\n\tFix : adjust_worker_by_load was wrong, worker was not created again\n\tFix : crash 'c.t_to_go is  None' in scheduler when time change\n\tFix : Arbiter parsing (Catch bad service_dependencies, timeperiod definitions)\n\tFix : Hosts over-checked when services are critical (don't respect retry_interval)\n\tFix : Prevent from returning next time notif in the past (don't over notify).\n\tFix : allow the \"__ANTI-VIRG__\" substring in the configuration files\n\tFix : do not send notification after a downtime to a contact that has been notified if notification_interval = 0\n\tFix : (reported by : Aina Rakotoson) notification logic failed when reactionners with different reactionner_tags\n\tFix : issue with some discovery rules with mutli-keys\n\tFix : set the python daemons into unbeffered stdout mode by default, centos guys will love it.\n\tFix : some fix on the contact-notifway inheritance\n\tFix : (openglx) bin/nagios : forces -v argument to be used as config file\n\tFix : (from Christophe Simon) impacts/problems retention loaded services\n\tFix : (reported by:fitzdsl) a spare that got a bad configuration can crash when try to send a configuration it do not have in master failback\n\t\n\n\tMODULES ENHANCEMENT\n\tDel : Move modules to their own repository! They are now in https://github.com/shinken-monitoring\n\n\tMODULES FIXES\n\tEnh: Bunch of fixes on the most used modules (livestatus, graphite, ws arbiter, ) and test cases added, look at each modules for details\n\n\tPACKS ENHANCEMENT\n\tDel : Move packs to their own repository! They are now in https://github.com/shinken-monitoring\n\t\n\n\n\n1.4   - 27/05/2013\n------------------\n\tCORE ENHANCEMENT\n\tAdd : Change Vsphere SDK Version\n\tAdd : new option for realm : broker complete links, so now a scheduler can give broks to several brokers instead of only one.\n\tAdd : now the arbiter can take its arbiter lookup name from parameter. Use to allow same host to run arbiter in HA for tests.\n\tAdd : macro_modulations objects, to dynamically change the macro based on the timeperiod. Can be useful as check_modulations, but easier to use, so maybe they will simply replace them\tUse persistent cookies by defaut\n\tAdd : (nerocide) now KEY are expand on the service_dependencies\tproperty.\n\tAdd : first version of user/system time catch for checks.\n\tAdd : check_modulations objects.\n\t\n\tCORE FIXES\n\tFix : (reported by:Georges Racinet) lot of SSL errors with Pyro3. Fix #839\n\tFix : bad offline receiver was too much verbose. Fix #559\t\n\tFix : (reported by: Beuc) : bad discovery script name. Fix #843\t\n\tFIX : #613 macros was overinding modules list instead of just adding a module. No bug at all just a misleading configuration in macro\n\tFix : the mysql python module installation on redhat/centos\n\tFIX : Jenkins tests + autogeneration of all_tests based on py file in the tests directory\n\tFIX : Jenkis test scripts : The loop skip empty lines\n\tFix : (reported by: miluebbe) catch bad protocol exception in daemons, like a telnet connexion. Fix #829\n\tFix : Timeperiod calculation\n\tFix : (reported by:darthelmet) bad NOT management for bp_rule and complex expression. Fix #827\n\tFix : remove useless print.\n\tFix : (reported by:sebguilbaud) bad URL for check_hpasm.\n\tFix : try to fix the no log error for scheduler and log\tlevel. Need a beter solution.\n\tFix : Check if a poller exists to handle services tag.Raise error if not\n\tFix : (reported by:boardstretcher) fix #814 about regression since last SSO related patch.\n\tFix : get_all_host_names_set functions since 1.2.4.\n\tFix : fix #509  now bp_rules can manage multi-levels rules with ()\n\tFix : Missing quote in host state notification e-mails\n\tFix : (reported by: Johan Svensson) now poller worker crashs are now put in the log.\n\tFix : (reported by: flaf and Imrane.Dessai) bad additive inheritance with multiples templates.\n\tFIX : MySQL-python complainig about outdated version of distribute\n\tFIX : (by :Alexandre Veyrenc) graphite module now manage perfdata with space in names\n\t\n\t\n\tMODULES ENHANCEMENT\n\tAdd : Sqlite to Mongodb logstore converter\n\tAdd : ws_arbiter now supports multiple input values. The ws_arbiter module can now accept a list of metrics to process. See:http://www.shinken-monitoring.org/forum/index.php/topic,846.0.html\n\tAdd : remote_user_variable from wsgi environment, to use set 'remote_user_enable 2'\n\tAdd : collectd header in shinken-specific.cfg\n\tAdd : proper support for counter/derive/absolute datatypes, by taking the derivative. Removed debug logging.\n\tAdd : support for collectd messages. Added support for more than one value in VALUES collectd part. Fixed graphite broker to nicely deal with multiple values. Fixed graphite graphs to support\tmultiple values by sh\n\tAdd : new arbiter module, FileTag, taht will tag a host if it is present in a flat file.\t\n\tAdd : support for high resolution time/interval (collectd 5.0),\tand also added support for derive and absolute types\n\tAdd : AWS arbiter module, to import your hosts from AWS/EC2.\n\tAdd : (reported by: joachim schiele) update the PNP version to the lastest one.\n\tEhn : add an optionnal list of hostnames to ignore for iptag module\t\n\tAdd : example client for zmq_broker.py\t\n\tAdd : A ZeroMQ pub socket broker for shinken\n\t\n\tMODULES FIXES\n\tFix : (reported by:Benoit Dunand-Laisin) livestatus command management with json option.\n\tFix : (reported by:pepejey) void password in ldap auth module. Fix #822\t\n\tFix : make the NDO synchronize_database_id option 1 by default to avoid single scheduler mode bug. Make the module far less verbose too.\n\tFix : (reported by:Johan Svensson) nrpe booster module now manage more than 1024 simultaneous connexions by switchting from select based poll to a real poll call.\n\tFix : mongodb fsync as a parameter\n\tFix : invalid variable name causes nrpe_poller crash when recieving SSLError exception\n\tFix : (reported by : igup) logstore_mongodb did nt manage the\tclass filter.\n\tFix : Livestatus and pnpgraph_present\n\t\n\t\n\t\n\tUI ENHANCEMENT\n\tAdd : New impact panel design\n\tAdd : jquery triggerd hover effect\n\tEnh : layout aligned\n\tAdd : font color class\n\tAdd : Update Font Awesome 3.0.2\n\tAdd : auto refresh function to view\n\tAdd : Screenfull lib\t\n\tAdd : WebUI start of a geomap, imported from\thttps://github.com/darkweaver87/alertsmap with Remi Buisson\tauth. Still work to do, for centring the map (wtf....) and give\treal data.\n\tAdd : [mq]: flupscgi.patch\n\tAdd : fullscreen dashboard menu\n\tAdd : WebUI now manage aggregation in the dep trees, reducing the number of visible elements.\n\tAdd : WebUI Glances view now raise a real error message when fail to connect.\n\tAdd : WebUI /detail view now save the tab on the location hash, so a refresh will put the user in the good tab.\n\tAdd : WebUI can now load an additonnal path for plugins taht can override the default ones.\n\t\n\t\n\tUI FIXES\n\tFix : Font color / dashboard\n\tFix : get back refresh on dashboard, so widget edit work again.\n\tFix : WebUI /impacts now display root problems even if there are lot of them.\n\tAdd : Tooltip to overview bar / eltgroup\n\tEnh : Enabled refresh disable function / fullscreen\n\tEnh : Change tab names / system log\n\tFix : #776  use \"expires\" of simplecookie (of bottle.py) Be carefull, \"expires\" uses String and not Datetime nor TimeStamp see\t: http://stackoverflow.com/questions/7913169/python-bottle-persistent-cookie-not-work\n\tFix : #779 : sorting fathers before printing\n\tFix : wrong btn alignment for Host Detail Impact\n\tFix : Parents werent displayed in webui\t\n\tFix : Forced check are now handled\n\t\n\n\tDEFAULT PACKS\n\tFix : disable the PickleRetentionArbiter and PickleRetentionBrokerby default. Very advanced modules taht should not be used without\n\tFix : currently removing skonf from standard install. If people want to TEST it, they will have to go to the init.d script. This will remove all script-kiddies from testing it and cry because it dont work. Dev are\n\tAdd : properties to ESX Host and ESX VM in discovery_runner\n\tAdd : collectd_disk.trig example\n\tFix : remove _fs_custom stuff\n\tFix : Modified collectd pack in accordance to proper naming aswell\n\tFix : typo in service Disks of linux pack Add new check_disk_custom for linux pack as sample for multi-value duplicate_foreach statement\n\tFix : MsSQL packk Typo Add Host Macros for Windows Pack\n\tFix : type in _MSSQL_CONNECTION_CRIT\n\tFix : type in WARN macros Added Macro definitions in mssql.pack\n\t\n\n\n\n1.2.4 - 11/02/2013\n------------------\n\tMODULES FIXES\n\t* Fix : LS module crash when bad socket close on the client side.\n\n\t\n1.2.3 - 30/01/2013\n------------------\n\tCORE FIXES\n\t* Fix : (Romain Forlot) wrong plugin owners after installation\n\t* Fix : (Romain Forlot) add mysql-client for Debian when install the server.\n\t* Fix : (Romain Forlot) Make arbiter last after all daemons except skonf because of issue 647\n\t* Fix : (reported by: opc and ppj) get back the arbiter spare management.\n\t* Fix : Manage sudoers to use nmap by discovery process\n\t* Fix : Set the HOME var to use the home of shinken, instead of the root's.\n\t* FIX : #689 add sudo prerequisite\n\t* Fix : Poller handling of abnormal plugin failures. Non-english shell stderr is captured too\n\t* Fix : Honor check_for_orphaned_* config params + add time_to_orphanage support for service and host\n\t* Fix : bad_start test for environments where groupname != username\n\t* Fix : Daemon timeout and receiver module options descriptions\n\t* Fix : bad import in shinken-admin\n\t* Fix : add default pack_distribution_file to nagios.cfg file, so it fix #576\n\t* Fix : (reported by: ethtricks) manage hosts macros addressX. Fix #640\n\t* Fix : (reported by: R\u00e9mi BUISSON, fixed by Olivier Hanesse) the \"too much notification\" bug after a restart, and also a potential bug for hosts downtimes overlap.\n\t* Fix : (By : Olivier Hanesse) schedule times load from retention were used even if the time was past, and make launch a bunch of useless checks.\n\t* Fix : (from rdumonnet) and remove alias for generic-host, so the value will be used from real hosts instead.\n\t* Fix : more Pyro exceptions handling\n\t* Fix : new way of parsing the complex expressions for hostgroups and templates. Fix #676\n\n\tCORE ENHANCEMENTS\n\t* Add : (Jean-francois BUTKIEWICZ) Windows installation for shinken, using .net services instead of instsrv.\n\t* Add : (Romain Forlot) distro support to install notify_by_xmpp\n\t* Add : (Denetariko) Added pnp4nagios, multisite and nagvis add-on's config folders into restore function (prior version didn't restore them)\n\t* Add : (from : Joel Ramat) include the -property feature in discovery.\n\t* Add : making orphanage time configurable\n\t* Add : first version of a Trending broker module, and libexec scripts.\n\t* Add : auto-magically add the shinken root dir parent to the PYTHONPATH environ variable in the daemons if the shinken lib is nout found.\n\t\n\tMODULES FIXES\n\t* Fix : Canopsis module - File handler and os path join\n\t* Fix : LiveStatus Correct bug with indexed access connected to issue #648.\n\t* Fix : let livestatus handle display_name correctly\n\t* Fix : (from Nicolas Pichon) Graphite, URI generation when using datasource, _GRAPHITE_PRE and _GRAPHITE_post\n\n\tMODULES ENHANCEMENTS\n\t* Add : (from Thibault Cohen) realm and poller_tag attributes in Livestatus module\n\t* Add : mongodb replicat set management in the scehduler retention module.\n\t* Add : hot host dependencies with libvirt\n\t* Add : Better handling of Carbon connection.\n\t* Add : (from Nicolas DUPEUX) SO_REUSEADDR to nsca sock to allow fast stop/start\n\t\n\tUI FIXES\n\t* Fix : WebUI manage service description with / for actions.\n\t* Fix : skonf stop script\n\t* Fix : (reported by:sebguilbaud) fix #668  : was not managed in webui for names.\n\n\tUI ENHANCEMENTS\n\t* Add : (from : Caez) webui,auth manage the $1$ htpasswd md5 way.\n\t* Add : (From Frescha) shinken informations\n\t* Add : (from Frescha) Logout link moved to admin submenu and submenu moved to the right\n\t* Add : (from Steve Schnepp) dashboard/currently, use a 24H clock format\n\t* Add : \"Beta\" badge\n\t* Add : caps lock detection login form\n\n\tDEFAULT PACKS\n\t* Fix : discovery for safekit cluster\n\t* Add : postgreSQL monitoring pack\n\t* Add : first part of tomcat pack. This pack need a proper installation of jmx4perl on shinken server (or poller) and a proper installation off jolokia\n\t\n\t\n1.2.2 - 22/10/2012\n------------------\n\tCORE FIXES\n\t* Fix : bug in scheduler when next check was impossible.\n\t\n\n\n1.2.1 - 22/10/2012\n------------------\n\tCORE ENHANCEMENTS\n\t* Add : Landscape (ubuntu SaaS) arbiter importer module\n\n\n\tCORE FIXES\n\t* Fix : (reported by: Yannig Perre) bad contacts/notifways notif periods were not caught\n\t* Fix : Realm objects were not being stripped when hostgroups were used\n\t* Fix : (reported by : R\u00e9mi BUISSON) there was still realm objects on sub-conf hostgroups objects\n\t* Fix : Issue #588 Graphite Templates formatting\n\t* Fix : (from Nicolas Boos) output an error at setup if the lsb_release\n\t* Fix : make service property service_dependencies take a void hostname\n\t* Fix : broker failed to initialize new modules when it get a new configuration\n\t* Fix : Restore Python 2.4 compatibility for test suite\n\t* Fix : (reported by: Dravail) bad install for PNP in install script\n\t* Fix : Cleanup shinken-specific-* files\n\t* Fix : (from : xkillian) less time latency between checks, so perfdata modules won't lost some checks anymore\n\n\tMODULE FIXES\n\t* Fix : (Reported by pushou) graphite_broker typo in logger call \n\t* Fix : a bug in livestatus \"GET log\" for python 2.4 (no partition method)\n\t* Fix : No override mongo replication state levels\n\t* Fix : Correct livestatus commands table. Fix #520\n\t* Fix : (Reported by igup) Livestatus Issue 628 UTF8 not decoded in query matching == \n\n\tUI ENHANCEMENTS\n\t* Add : Business impact Filter\n\t* Add : Multiple action URLS (Thanks to h4wkmoon)\n\t* Add : (Thanks GAULUPEAU Jonathan) Webui, move the show/hide tool bar button \n\n\tUI FIXES\n\t* Fix : Dynamic reload of widget after save\n\t* Fix : bug in active_directory_ui for unknown users\n\t* Fix : typo in javascript for bookmarks\n\t* Fix : Bookmark Business impact Filter\n\t* Fix : Issue #570 gear.png\n\t\n\n\tDEFAULT PACKS\n\t* Fix : (Thanks jhurliman) check_mongodb invalid option -C \n\t* Fix : Missing IMAPS/POPS ports\n\t* Fix : update check_nwc_health install to the 1.3 version.\n\t* Fix : Typo in Packs.tpl and accept packs with no services\n\t* Fix : invalid nmap parameter\n\n\n\n1.2 - 31/08/2012\n------------------\n\tCORE ENHANCEMENTS\n\t* Add : Skonf daemon, as a configuration UI over the discovery lib\n\t* Add : Triggers to the scheduler. This code is launched after each \"check\"\n\t* Add : issue #349 (from David Guenault) Installation script now has a backup repository for installing MK Multisite.\n\t* Add : option to skip mongo installation. Useful for poller installation that does not need mongo to be installed.\n\t* Add : daemon_enabled option for ini and nagios.cfg files to disable a daemon from running.\n\t* Add : (by Hartmut Goebel and xkilian) huge work to replace old log code by a logging based one, print to logger, adjust levels, messages, typos\n\t* Add : (by Hartmut Goebel) huge code cleaning\n\t* Add : install script available at the install.shinken-monitoring.org address.\n\t* Add : make the daemon and the module names appears on the process line (setproctitle mode)\n\t* Add : receiver can now send directly commands to schedulers. (direct_routing)\n\t* Add : HOSTREALM macro for host/service.\n\t* Add : 'address' directive into generated host by discovery\n\t* Add : (reported by : Mathias Fussenegger) enhance the README, to just put install script way. Put other methods in the packagers and dev files.\n\t* Add : reload option for the init script. Fix #385\n\t* Add : install script: trap signals INT, TERM with a cleanup function\n\t* Add : USR2 signal management for the scheduler to dump objects (checks, notification, event handlers and broks)\n\t* Add : Reorganize Configuration file in sections. More consistent layout. Clarify the role and scope of shinken-specific.cfg.\n\t* Add : Use the new folder \"graphite\" for graphite templates. Existing templates should be prefixed with .graph, and move to that folder.\n\t* Add : the not list for services generators. So the primary list can be automatically generated, and the user can just maintain the not one.\n\t* Add : (from Lars Hansson) manage Apache2 htpasswd crypt pass.\n\t* Add : Allow running shinken satellites in a NATted environment\n\t* Add : shinken-packs to easily create .zip pack files\n\t* Add : Hostd daemon, for running community.shinken-monitoring.org website\n\t* Add : multi-layers discovery, with rules on runners.\n\t* Add : discoveryrule_order so the admin can manage the template order in a more easy way than with the order in the file\n\t* Add : support for Linux Mint\n\t* Add : nmap discovery speedup, and skonf scan part.\n\t* Add : support to explode_hostgroup directive\n\t* Add : new external command, PROCESS_SERVICE_OUTPUT and host, same than check_result for passive, but with no return code.\n\t* Add : configurable logging level (per daemon)\n\t* Add : shinken-admin can now change logging levels during runtime (Guillaume Bour)\n\t* Add : now passive checks take their timestamp from the external command instead of the received time.\n\t* Add : pre-serialize the configurations in the arbiter before going in daemon, and so kill the previous instance. (startup boost)\n\t* Add : brok time part boost, with less useless objects sent, like contacts, timeperiods or commands. (big startup boost)\n\t* Add : host pack dispatching history is saved in a pickle file, so we will be able to push same objects in the same scheduler\n\t* Add : arbiter -p options for dumping profile\n\t* Add : (thibault cohen) Added hook in Scheduler daemon to permit the use of the Shinken SNMP poller module, SnmpBooster.\n\n\n\tCORE FIXES\n\t* Fix : (from raphaeltr) Typo in mysql monitoring pack command arguments\n\t* Fix : Fix minor installation issues on centos/redhat. Mainly on services activation and pnp\n\t* Fix : escalation issue when we restart the scheduler during the escalation process. Should fix #525\n\t* Fix : potential endless loop on bp_rule + parent relation ship, and problem/impact setting. Fix #198\n\t* Fix : bad characters in external commands make logging not happy at all. Fix #498\n\t* Fix : bad start for arbiter with Pyro4 and enable_ssl=1.\n\t* Fix : issue #272 where the shinken user home was forced to be in /home and that make some system not eligible to install.\n\t* Fix : Pyro 4.14 issue, where we remove every where the MSG_WAITALL for all where it was useful only for first Pyro4 version. Fix #345\n\t* Fix : Update format of log message to be less prone to breaking\n\t* Fix : $USERn$ macros aren't published in env anymore\n\t* Fix : Nconf installation : apache was not restarted after dependency installation.\n\t* Fix : (reported by : D.Durieux) remove the self.process link for a killed action, because such object cant be pickle.\n\t* Fix : spare arbiter now take the lead is the master is never start. Fix #231\n\t* Fix : (reported by Sven) the configuration loader was not following symlinks. BEWARE : on python 2.4 and 2.5 it is NOT managed.\n\t* Fix : (reported by : Sven) space in hostgroups problems. Fix #452\n\t* Fix : (reported by : Nicolas DUPEUX) : bad DISABLE_HOST_FRESHNESS_CHECKS and ENABLE_HOST_FRESHNESS_CHECKS code fix #376\n\t* Fix : (reported by : Chettor) #342 comments from downtime and ack where not put in the global list, and so not removed\n\t* Fix : catch a case where service dep got no hostname nor hostgroup_name.\n\t* Fix : issue with retention and notification that make notification not sent.\n\t* Fix : (reported by banderas07, analysed by : Radu Gheorghe) :  #401 escalation notification_interval issue\n\t* Fix : disable 'FLAPPINGSTART', 'FLAPPINGSTOP', 'FLAPPINGDISABLED' notifications during downtimes.\n\t* Fix : issue #404 to treat Tracebacks correctly for Pyro3 and Pyro4.\n\t* Fix : Op5 guys changed the name of check_esx3.pl to check_vmware_api.pl so now we host a copy of the plugin to workaround problems\n\t* Fix : (Reported by : Morkxy, fixed by : Lars Hansson) change deprecated md5 by haslib.\n\t* Fix : add a check_type attribute for checks\n\t* Fix : remove illegal char from service_description when duplicated\n\t* Fix : wrong name for mongodb debian packages\n\t* Fix : CHANGE_HOST_CHECK_TIMEPERIOD apply to a host not a service\n\t* Fix : (from : CHAMLEY Stephane) add notifications_enabled to the retention data.\n\t* Fix : (reported by : Nicolas DUPEUX) #244 missing from_q property for regenerator.\n\t* Fix : (reported by : Akiooutori) fix #325 (missing SOCK_REUSE in some pyro versions) .\n\t* Fix : (From : Michael COQUARD) setup.py build with simple user.\n\t* Fix : missing mongo dependency for debian like distro < 6\n\t* Fix : mongodb 10gen repo configuration path was not found on redhat/centos\n\n\n\tMODULE ENHANCEMENTS\n\t* Add: (from: xkilian and Thibault Cohen) Graphite broker supports pickle protocol, bulk updates and buffers output when it can't connect to Carbon daemons\n\t* Add: (from: Thibault Cohen and ???) Graphite broker replaces invalid caracters by _ and supports negative values\n\t* Add: (from: xkilian and Thibault Cohen) Graphite broker adds _PRE_GRAPHITE and _POST_GRAPHITE host or service macros to each dot delimited data name\n\t* Add: (from: Claneys Skyne) Graphite broker Create additionnal data points for warning and critical thresholds per data value\n\t* Add: (from Romain Forlot) Graphite broker Compile regex\n\t* Add: (from: bclermont) Graphite broker add graphite_data_source variable between hostname and service name in data to Graphite\n\t* Add : a read_only option to logstore_sqlite\n\t* Add : Finalyse the time filter to avoid loading all the logs database in use_aggressive_sql=0 mode\n\t* Add : Added more hints for the livestatus query metadata resulting in massive speedup for Nagvis, Multisite, Thruk\n\t* Add : Creating new authentification module for OpenLDAP directory service\n\t* Add : Most modules do not raise Warning if the module need (like python-ldap for active directory, etc) but instead raise a real Exception\n\t* Add : Collectd template with trigger sample.\n\t* Add : First working version of Canopsis broker module\n\t* Add : Use usjon optional import to improve LS output performance\n\t* Add : NDO add table prefix as a parameter.\n\t* Add : (Thibault Cohen) Livestatus will now only store STATE messages and no longer any general logs in logstores\n\t* Add : (Nicolas Dupeux) TSCA module documentation updated and files consolidated in modules sections of the code\n\n\tMODULE FIXES\n\t* Fix : issue #450 (from vaxvms) removed thrift broker, similar to Livestatus, as it is unmaintained.\n\t* Fix : MerlinDB for Ninja UI, removed documentation and marked as deprecated, as it is unmaintained.\n\t* Fix : (from : Fr\u00e9d\u00e9ric P\u00e9g\u00e9) make the sqlite db files put in a good default place, in devel mode or init.d mode.\n\t* Fix : the program_start attribute in livestatus status table\n\t* Fix : (reported by : Nicolas Dupeux) remove a useless method in logstore_sqlite, and add a protection against endless loops. Fix #374\n\t* Fix : Livestatus allowed_hosts options does not work\n\t* Fix : Call the right function for !=~ LQL filter (livestatus)\n\t* Fix : do not push back monitoring status in GLPI database when the host configuration does not come from GLPI\n\t* Fix : a bug in livestatus module and add the attribute host.event_handler (needed by Thruk)\n\n\n\tUI ENHANCEMENTS\n\t* Add : UI /detail full rewrite. Thanks Andreas!!\n\t* Add : UI new dashboard!\n\t* Add : (from Mael Vincent, julien pilou, Gael Millet, Damien Mathieu and hugo viricel) new /mobile part!\n\t* Add : Enable easy activation of application monitoring performance feature. Use ./install --enableeue to enable eue feature\n\t* Add : WebUI in a /problem page a user can now press the sift key and over the selection tick to select them. It make easier for massive selection\n\t* Add : UI sqlite backend to save common preferences\n\t* Add : the page to save common prefs\n\t* Add : webui, /depgraph, now add a loop and loop_time option, to make the graph root change between important elements.\n\t* Add : sound on new non-acknowledge IT problem (disabled by default)\n\t* Add : UI /detail now dep graph is also print on a tab, so this feature will be more visible.\n\t* Add : UI /problems add the downtime filtering.\n\t* Add : UI /problems filtering by ack state.\n\n\tUI FIXES\n\t* Fix : (reported by : Vincent Riquer) WebUI do not print 1970 for 0 time, but N/A instead. issue fix #241\n\t* Fix : (reported by : xkilian) WebUI would not display names containing dots.\n\n\tDEFAULT PACKS\n\t* Add : discovery packs for ibm storage management and beginning of clustering solutions discovery\n\t* Add : cluster discovery for Safekit and HACMP.\n\t* Add : snmp plugins for AIX to monitor VG, inode, HACMP and Safekit\n\t* Add : first 2nd level real discovery script, here for listing windows shares, like shares or printers. It auto-hide the $ ones.\n\t* Add : (Camille Vacquie): AIX service pack\n\t* Add : SNI support to https and https certificate checks\n\t* Add : pack/os/linux - check_linux_network_usage - use last_perfdata to determin bandwidth\n\t* Add : commands for notification by XMPP (Jabber)\n\t* Add : a basic rsync check template in the network/services pack.\n\t* Add : macros for Basic HTTP authentification in the HTTP(S) services templates.\n\t* Fix : The check_mysql_health plugin need a : sign after the thresholds for greater is better metrics.\n\t* Fix : generic corrupted block oracle database check\n\t* Fix : call sudo to execute SMcli into IBM_DS plugins\n\n\tDOCUMENTATION\n\t* Add : (from xkilian, MathieuMD,  Claneys Skyne, H4wkmoon, etc.) Wiki documentation in-depth renewal of Getting Started pages for new users\n\t* Add : Monitoring Pack documentation, modules, installation, FAQ , diagrams, scaling shinken, dev+user resources, etc.\n\t* Add : dummy_broker module example.\n\n1.0.1 - 13/03/2012\n------------------\n\tCORE FIXES\n\t* Fix: recovery contacts were lost after a restart\n\t* Fix: allow } in commands if it's not alone in the line\n\t* Fix: (from: Laurent Ollagnier) typo on mysql pack\n\t* Fix: issue #214 (shinken-admin catches backtrace for lost connections)\n\t* Fix: inheritance with +\n\t* Fix: ticket #213 This will manage cases where an active satellite dies and there is no spare. It's useful for pollers where spare is not so interesting.\n\t* Fix: (reported by: H4wkmoon) time change compensation lead to a scheduler crash when objets don't get check perdios or notification periods.\n\t* Fix: manage LARGE output from sub commands (>64k). Only works under Unix for now, because it uses the fcntl module\n\t* Fix: (reported by: Unicow) bug in escalations, there were too many escalations raised\n\t* Fix: (from: Arthur Gautier) fix buildpath\n\t* Fix: (From: Thomas Meson) Various fixes in setup.py and add missing files to build the package\n\n\tMODULE ENHANCEMENTS\n\t* Add: many GLPI module enhancements, with new properties managed\n\n\tMODULE FIXES\n\t* Fix: check_esx3 install under ubuntu 32bits edition\n\t* Fix: multisite layout, add custom links\n\t* Fix: workaround problem with official pyro3 under Debian squeeze. Use pyro4 instead of the official one\n\t* FIX: #210 added test of parent target folder. if it does not exist then create it\n\t* Fix: HTML in sendmails\n\t* Fix: a bug in livestatus attribute action_url_expanded.\n\t* Fix: (reported by: Jonathan Gaulupeau) ip_tag was launch too late to access check_command objets.\n\t* Fix: (By: zllak) ndodb_mysql_broker module was not working on python2.5\n\t* Fix: Fix a bug in livestatus Service.contact_groups\n\n\tUI FIXES\n\t* Fix: Sort alphabeticaly in WebUI\n\n\n1.0 - 28/02/2012\n------------------\n\tCORE ENHANCEMENTS\n\t* Add: shinken.sh script and skonf.py with a LOT of features for setup and configuration management.\n\t* Add: better logging for warnings for host, service and npcd configuration\n\t* Add: poller daemon will use all available CPUs by default\n\t* Add: poller daemon can now load standard external modules like namedPipe to get external commands from it\n\t* Add: brok queue watchdog for satellites, activated for Broker by default at 100000 broks to kill/restart the module..\n\t* Add: if the run/var directories are missing, try to create them in the init.d script.\n\t* Add: service templates can now be applied on a host template\n\t* Add: reactionner can run under android\n\t* Add: android SMS module\n\t* Add: imlemented a check for dead queue threads. When detected restarts the thread\n\t* Add: mail python script\n\t* Add: better error text when the pickle load gets an error\n\t* Add: manage connexion timeouts in the broker and Pyro4\n\t* Add: $$ are now interpreted as $ in macro solving\n\t* Add: (reported by: sduchesneau) check_shinken.py now has a timeout. It is set by default at 10s\n\t* Add: business rules now support the NOT operand\n\t* Add: send broks in external modules as a biglist instead of n broks. It's more efficient (X3 perf for this, can be huge time for huge conf)\n\t* Add: templates for monitoring common devices and services are now included\n\t* Add: manage \\; to be changed in ; without cutting the rest of the line to be removed as a comment\n\t* Add: (reported by: foobar1111) arbiter only matched hostname, and not fqdn. Now it will try fqdn and then the hostname.\n\t* Add: retention is now enabled by default at installation time (Pickle)\n\t* Add: (From Michael Leinartas) man pages updates\n\t* Add: '+' in discovery rule management, so you can 'add' something, like a template\n\t* Add: using an undefined template in the configuration is no longer a critical error, just a warning.\n\t\tSo the user can just 'tag' hosts first and then create the template\n\t* Add: Sebastien Coavoux conducted a large code review! :)\n\t* Add: xkilian reviewed and corrected many many pages of the wiki documentation and a few english fixes in the distribution :)\n\t* Add: skonf daemon preview. It is not yet meant for production, but is included to get feedback\n\t* Add: mongodb insert capabilities for the discovery\n\t* Add: TIMEPERIOD TRANSITION logs from the Arbiter to get timeperiods transition output\n\t* Add: is_admin property is now available for contacts\n\t* Add: make the nmap discovery do tcp and udp scan\n\t* Add: (Victor Igumnov) installation for Solaris\n\n\tCORE FIXES\n\t* Fix: use StringIO to read configuration files into a string (much faster with lots of config files)\n\t* Fix: (reported by: lminoza) bug in inheritance if templates give only a + elements, should continue to loop and not stop here.\n\t* Fix: keep multiple spaces in config files. (check_command!\"args   \" were stripped)\n\t* Fix: pyro 4.10 management\n\t* Fix: (reported by: MINOZA, Landy) multi-layer management for service template on host template. So if you apply a service on layer 3 and your host inherit from layer1->layer2\n\t* Fix: (reported by: Thibaut Notteboom) catch ConnectionClosedError on poller/reactionner connections\n\t* Fix: A better safe_print\n\t* Fix: lot of encoding stuff!\n\t* FIX: proxy support and python-setuptools installation on RHEL/CENTOS 6\n\t* Fix: (reproted by: darkweaver87) somethimes we got a malformed external command. If so, bailout and warn in debug mode.\n\t* Fix: when there is a dispatching problem, the arbiter send and send again the same configuration to satellites.\n\t* Fix: crash bug when timezone set in config file\n\t* Fix: make all log pass the utf8 management\n\t* Fix: use auto-generated, absolute path for README (Daniel Widerin)\n\t* Fix: last line of email notification must finish by a \\n otherwise it will not be sent (Laurent Ollagnier)\n\t* Fix: (from rootix2) catch case where service do not have imported_from from modules.\n\t* Fix: (reported by: Venelin Petkov) print in hostgroup names was a problem.\n\t* Fix: if a scheduler restarted, we got problem because the arbiter did not resend it the configuration\n\t* Fix: \"host_notification_period\" and \"service_notification_period\" defined twice in the contact definition (Fournet Matthieu)\n\t* Fix: (reported by: Httqm) default notification_interval was one minute, 1hour is better.\n\t* Fix: (reported by: sprudhomme) longoutput parsing and perfdata did not follow nagios way.\n\t* Fix: change sourceforgetrac with github in tracebacks.\n\t* Fix: (reported by: lminoza) too many notifications for a contact with multiple notification methods, all where sent when only some would pass filter.\n\t* Fix: (reported by: puisea) kill all sub process action tree on unix\n\t* Fix: flaw on multiple date and multiple timerange\n\t* Fix: if missing alias in objects, put the name if available\n\t* Fix: (reported by: denetariko) manage spaces before and after type name in define line\n\t* Fix: (reported by: Steve Kieu) missing get_name() method for config\n\t* Fix: (reported by: Mihai Efrim) flapping notifications\n\n\n\n\n\tMODULE ENHANCEMENTS\n\t* Add: rewrite the LiveStatus module, performance boost and simpler. Thanks Gerhard for this huge undertaking!\n\t* Add: two new modules for storing livestatus logs. sqlite and mongodb\n\t* Add: graphite module for the Broker to export performance data to a Graphite time series database.\n\t* Add: module to deal with flat file dependencies\n\t* Add: mongodb module for the arbiter, to load hosts object from it\n\t* Add: mongodb retention module\n\t* Add: the Service-perfdata module now open/close the perfdata file each second. So it's compatible with tools like Centreon that move it\n\t* Add: macros supported in skonf. Lots of bug fixes\n\t* Add: merlindb now inserts host_contactgroups\n\t* Add: NDO Nagios/Shinken mix in database (Sebastien Coavoux)\n\t* Add: port option for the mysql connexion with NDO\n\t* Add: ip_tag module that can change configuration properties based on the host IP address or IP address range.\n\t* Add: simulation mode for the nmap disco wrapper, so we can ask for xml output from users, and then simulate it easily.\n\t* Add: new process for nmap discovery output. There is no longer a big mapping pass. It will output what it can, and it's for the discovery_rule to do this job now,\n\t\tit's far more a BIG thanks to all folks that send me sample xml output :)\n\t* Add: enhanced capabilities for the mysql import module (OlivierHa)\n\n\tMODULE FIXES\n\t* Fix: useless and dangerous str in redis module.\n\t* FIX: htpasswd.users file was not correctly updated at installation\n\t* Fix: (reported by: DGuenault) hack_poller_tag_by_macros was not applying poller_tag to commands, only root objects\n\t* Fix: memcache and redis retention modules. They were loading notifications->contacts->commands but this class got slots but no __getstate__\n\t* Fix: (reported by: sprudhomme): long_output in ndo for 1.4b9 version\n\t* Fix: NSCA, a loop when the client initiate the socket closing\n\n\tUI\n\t* Add: now page rendering can be launched in parallel, and so page can now call 'long' queries without breaking all. But during a long query, we still cannot eat broks.\n\t* Fix: the WebUI now exits when the brok thread encounters a problem\n\t* Add: UI PNP module\n\t* Add: if contact is not is_admin, then the /problems view only shows its related elements (if he is a contact of the elemetn, of an impact or a source problems one).\n\t* Add: add graph time selection in the detail page\n\t* Add: Graphite graph backend\n\t* Add: /mobile part\n\t* Add: External Authentification for WebUI (SSO) (olivierHa)\n\t* Add: tips on the eltgraph view\n\t* Fix: acknowledge typo\n\t* Fix: Change the scale of the impact view divs\n\t* Fix: UI page navigation should not propose page too high if not need\n\t* Add: gesture canvas as smaller and visible\n\t* Add: address to the eltdetail.tpl\n\t* Fix: utf8 names in the UI\n\t* Add: allow_html_output parameter for the WebUI\n\t* Add: generic perfometer manager for the UI\n\t* Fix: search button (Thanx to pydubreucq)\n\t* Add: make all nodes apears in the dep graph, but hidden one in very smalls\n\t* Add: perfometer image hovering with the graph module like PNP\n\t* Add: password iphone like in the login screen\n\t* Add: an orange outline to see where the focus is on input\n\n\n\n0.8 - 17/10/2011\n------------------\n\tCORE ENHANCEMENTS\n\t* Add: WebUI broker module. More info in the UI changelog part.\n\t* Add: (by: Vincent Riquer) no_event_handlers_during_downtimes parameter to choose between nagios and shinken behavior to (not) run event handlers during a downtime.\n\t* Add: added RUN var relocation in shinken default file\n\t* Add: support for serviceextinfo\n\t* Add: support for hostextinfo\n\t* Add: a workdir parameter in the nagios.cfg file for set the arbiter working directory\n\t* Add: modules for modules. Will be useful for the global configuration in the WebUI (it's a module, but will need additonnal modules)\n\t* Add: alternative installation method in contrib\n\t* Add: shinken-admin command that can connect to an arbiter and ask daemons status.\n\t* Add: discovery runners timeout parameter. Set by default at one hour.\n\t* Add: rename criticity into business_impact for hosts and services. Criticity is automatically mapped into business_impact in the configuration reading, and rename min_criticity into min_business_impact for contacts and notifways. And keep a mapping for old conf.\n\t* Add: if set to 0, min_workers will set the pollers/reactionners to use ALL cpus of the server.\n\t* Add: business modulation objects.\n\t* Add: new tests for A,B,Cof: rules and a fix for the default return logic.\n\t* Add: arbiter ask one a check_interval the managed conf for satellites. Makes for smoother decisions.\n\n\n\tCORE FIXES\n\t* Fix: BugFix Pyro4 compatibility\n\t* fix: try to fix bad notification output make scehduler crash.\n\t* Fix: (Seb-Solon) catch incomplet service group members\n\t* Fix: bad message for arbiter in HA without host_name value.\n\t* Fix: (reported by: fraggod): inline comment in boolean cause an arbiter crash when lookup conf.\n\t* Fix: (reported by titilambert) bug about linkify and templates, so need to clean search lists after remove templates.\n\t* Fix: (reported by Vincent Riquer ) Pyro got problem in connect() and so need a low socket timeout by default.\n\t* Fix: (reported by: grim) manage flap_detection_enabled and enable_flap_detection\n\t* Fix: when disable active check was done, the pending check was still executed, so the effect was not immediate. Now we change it as a dumym check with curretn value the value of the host/service.\n\t* Fix: external_command.py where the config setting log_external_commands was ignored\n\t* Fix: (reported by: obiouane) missing object value is now reported correctly.\n\t* Fix: (Etienne Obriot) multiple = in macos values\n\t* Fix: a bug in config.py where resource macros containing a \"=\" were not correctly processed. Thanks Etienne\n\t* Fix: (reported by Seb-Solon) custome macros get problems in notifications.\n\t* Fix: (reported by: Michael Grundmann) a service for a void hostgroup and a host exclusion was reporting a bad conf instead if forgot this service.\n\t* Fix: (Reported by: Dirk Hallanzy) was not launching under XP due to some pid file creation bad mode.\n\t* Fix: (reported by: Vincent Riquer) now a spare broker can be send to sleep again by the arbiter. It will clean its queues and stop modules.\n\t* Fix: arbiter crash with a spare and the new smoothing wat i managed behavior.\n\t* Fix: Change default check/eventhandler/notification timeouts and flap thresholds to make nagios more compatible to shinken.\n\t* fix: Better handling of check timeouts (there was an empty output)\n\t* fix: Log notification and eventhandler timeouts\n\t* Fix: (reported by: Denis GERMAIN) service with no description cause a host problem in linking phase.\n\t* Fix: (reported by: Seb-Solon) manage utf8 in host and service perfdata.\n\t* Fix: protect broker agains module taht ask for full instance init about unknown scheduler.\n\t* Fix: (reported by Markus Elger) add next schedule date in the retention data.\n\t* Fix: (reported by: Olivier Hanesse) bad realm configuration was not detected for satellites.\n\t* Fix: (reported by:Markus Elger) bad host count in realms.\n\t* Fix: (reported by:Markus Elger) bad host reaml conf were not detected.\n\n\n\tMODULES ENHANCEMENTS\n\t* Add: module for autotagging poller_tag from a custom macro.\n\t* Add: create the simple-log archive dir automatically if it doesn't exist\n\t* Add: Initial import of the thrift broker with a sample client in python\n\t* Add: Initial import of TSCA, Thrift Service Check Acceptor\n\t* Add: Module arbiter load all configuration from GLPI (plugin monitoring) bywebservice\n\t* Add: a new module to import configuration data (hosts/services) from a MySQL database\n\t* NDO/MySQL:\n\t* Add: current_notification_number in the ndo module.\n\t* Add: last_notification in ndo module.\n\t* Add: last_state_change to the ndo module.\n\t* Add: add the is_flapping data to broks and update teh ndo module so it update the value.\n\t* Add: percent_state_change as check_result brok and in the ndo module.\n\t* LIVESTATUS:\n\t* Add: Derive the archives filenames from the main livestatus db\n\t* Add: Rewrite the livestatus sqlite code. Now there is one database file with logging events for each day.\n\t*!!: If you have a huge livestatus.db it is recommended to stop shinken and run the script contrib/livestatus/splitlivelogs.py\n\t* Add: the livestatus sqlite db will now be opened in do_start() instead of init(). Now only the livestatus process has an open filehandle. (the main broker process had one too)\n\t* Add: Make the livestatus socket world read/writable\n\t* Add: the REUSEADDR flag to livestatus's socket. Thanks Olivier Hanesse\n\t* Add: performance improvement for livestatus queries with Limit:\n\n\n\n\tMODULES FIXES\n\t* Fix: important bugfix in ncpdmod\n\t* Fix: Livestatus path database\n\t* Fix: string comparison for livestatus. None is equivalent to empty string\n\t* Fix: collumn name change in merlin ds.\n\t* Fix: (reported by: Seb-Solon) bad contact group insert in objects in NDO\n\t* Fix: (reported by: seb-solon) bad contact group id in NDO\n\t* Fix: (seb-solon) ndo contacts were not registered with the good id.\n\t* Fix: add the flap_detection_enabled in the ndo status tables too. (I love duplicate data...)\n\t* Fix: the ndo module with is_flapping value for update states.\n\t* Fix: (reported by: Ronny Lindner & Markus Elger) LiveStatus crash in log parsing.\n\t* Fix: (reported by: Ronny Lindner) fix status.dat module with utf8 characters\n\t* Fix: (reported by: Olivier Hanesse) nrpe module did not tag the check_time value for checks, and so pnp and other tools were not happy. BP rules were alike.\n\t* Fix: (reported by Markus Elger) LiveStatus module did not clean previously added elements before recreating them.\n\n\n\tUI\n\t* Add: Andreas to main contributors :)\n\t* Add: welcome text and error text in the login page.\n\t* Add: make appears on the dep graph only interesting elements, so near the root or hosts or service in real problems. Far more redable with huge conf.\n\t* Add: default http backend auto, so if a better one (paste, cehrrypy) is founded, use it instead of the simple swsgi.\n\t* Add: less info in the detail page, with a moee button for rarely used infos.\n\t* Add: dock effect for actions buttons on /problems.\n\t* Add: /system page with satellites info in it.\n\t* Add: search form in the problems page, with autocompletion. Search problems and impacts names too.\n\t* Add: new way of handling cookies. Now it's a crypted way, and so stateless. Needto remove all session file thing so.\n\t* Add: in cfg file password for users, or AD or apache passwd file\n\t* Add: AD module that will get user photos from Ldap.\n\t* Add: icon sets: network_service, servers., disk, database\n\t* Add: gesture management for the detail page.\n\t* Add: parallax effect in the top right banner to see huge impacts\n\t* Add: make known bad nodes shown in the dep tree, so the admin don't even have to expand and find the bad thing that cause him a problem. Lasy admin mdoe on :)\n\t* Add: swtich buttons for ths hostdetail page for enable/disable things.\n\t* Add: if you change host topology (new dependency like fror VMotion), the UI is updated too.\n\n\n\n\n0.6 - 03/05/2011\n------------------\nENHANCEMENTS\n\t* Add: discovery script and rule engine\n\t* Enh: lot of code clean from Gregory Starck, big Thanks :)\n\t* Add: manage several brokers by realm\n\t* Add: LiveStatus Wait commands\n\t* Add: Recevier daemon, for distributed realms in distant LAN\n\t* Add: passive poller for DMZ management\n\t* Add: (David Guenault) a way for people that install shinken lib in non standard place (like /opt) to get it working for python path.\n\t* Add: poller and reactionner modules\n\t* Add: nrpe poller module for tuning nrpe calls without having to 'forks'\n\t* Add: human_timestamp_log option so the log will output time as human readable format.\n\t* Add: make the local log rotate with the logging module, max keep file at 5.\n\t* Add: the crash catching in the log for all daemons\n\t* Add: enable by default local log, should be enable by default, and if the admin want it down, he can.\n\t* Add: (Eric Beaulieu) Windows installation script\n\t* Add: Thte configuration is read as UTF8\n\t* Add: round robin dispatching way between the worker of a module for the satellites.\n\t* Add: set a check_interval to satellites, so we do not try every second to ping them, each a minute is quite enouth.\n\t* Add: sending USR1 do a memory dump of the daemon\n\t* Add: Manage Pyro4.2 and higer.\n\t* Add: manage no notification period for hosts and services\n\t* Add: print the sleep_time as a load average, so will smooth in one minute average, so is a good scheduler load indicator\n\t* Add: force LANG=us and UTF8 in init scripts. No sense admin can set another langage for system and hope for tools to work.\n\t* Add: print the latencies for scheduler in 95percentile way\n\t* Add: when a hook point failed set the module to restart, not to kill, even external ones\n\t* Add: support for multisite's double-requests (extcmd+query) to the livestatus module\n\t* Add: now the nagios.cmd named pipe reading is an external module\n\t* Add: statistics for the livestatus module (multisite needs it)\n\t* Add: retention modules for broker and arbiter\n\t* Add: reationner tag, like poller tag, but for reactionner\n\t* Add: (Denis GERMAIN) check_shinken plugin and interface in the arbiter to get data.\n\t* Add: (R\u00e9mi BUISSON) common init script for easy launch\n\t* Add: sendmailhost.pl + sendmailservices.pl in libexec.\n\t* Add: hot poller addition commands\n\t* Add: automatic VMware host-> VM dependencies modules, with VMotion support\n\t* Add: \"Unknown phase\", so limit useless notifications\n\n\nFIXES\n\t* Fix:the livestatus module so that multiple external commands in one request are possible. (thruk uses this for mass operations)\n\t* Fix:the livestatus, so that host_name and service_description are shown correctly for downtiems and comments.\n\t* Fix: (reported by: Raynald de Lahond\u00e8s) for python2.7, if shell launch, do not go in shlex split pass.\n\t* Fix: catch an exception when deregistering Pyro. (When the scheduler was started as the only process and no communication happened\n\t* Fix: Add the path of the current script (ex: bin/shinken-arbiter) and \"..\" to the list of paths where Python looks for shinken modules.\n\t* Fix: default config had duplicate command name define: check_http\n\t* Fix: clean Command(s) now subclass Item(s) as any \"shinken.objects\"\n\t* Fix: (reported by: Raynald de Lahond\u00e8s) if a hostgroup member got no host defined, create a dummy service for no host, so failed.\n\t* Fix: bad UTC hour for scheduler.\n\t* Fix: in a rare case, the picle need to call the __init__ of notification before the __get_state__, but it will call it without args.\n\t* Fix: (reported by: Raynald de Lahond\u00e8s) bad hostdep definition (link host) was badly detected.\n\t* Fix: utf8 management in the db class.\n\t* Fix: the * member was wrong in service calling hostgroup of this kind.\n\t* Fix: the schedule immediate check now work without having to force it.\n\t* Fix: correct the check launch under python2.7 with utf8 char.\n\t* Fix: (reported by: Denis GERMAIN) set by default retention update inverval to 60 minutes.\n\t* Fix: bad sys.path management for ndo module\n\t* Fix: too much loop in daemons! do_loop_tunr must WAIT a little! To managed in the main_loop part I think.\n\t* Fix: if the scheduler gotthe same conf but got a wait a new one before, it do a zombie scheduler then....\n\t* Fix: (reported by: Hienz Michael) do not close local file in the daemon pass.\n\t* Fix: (Raynald de Lahond\u00e8s) setup.py for bsd systems.\n\t* Fix: service without host will be just droped, like Nagios.\n\t* Fix: Nagios allow elements without contacts. Do alike.\n\t* Fix: add protection against adding again and again the same actions ifthe scheduler ask it, like for orphaned checks.\n\t* Fix: sys.path management, not far more clear and error proof\n\t* Fix: (reported by: capibaru) add a strip pass before loading cfg files.\n\t* Fix: raise only one log for orphaned instead of xK useless logs.\n\t* Fix: (Venelin Petkov) missing customs on services copy of a based one (multiple hosts, hostgroups, etc)\n\t* Fix: (reported by: Ronny Lindner) manage the not host expressions for services.\n\n\n0.5.1 - 19/01/2011\n------------------\nENHANCEMENTS\n\t*Add: Business rules\n\t*Add: Downtime for contacts\n\t*Add: Escalations based on time, with notification period shorting capabilities\n\t*Add: options allowed_hosts and max_logs_age to the livestatus broker\n\t*Add: some rarely used operators to the livestatus module (!>=)\n\t*Add: SSL connections between daemons with certificates and a CA\n\t*Add: module exception/kill catch in the scheduler.\n\t*Add: use the binary format for the pickle, so it take less space.\n\t*Add: (Hartmut Goebel) use universal open way for conf reading.\n\t*Add: support for unix sockets to the livestatus module\n\t*Add: criticity value for host/services, with problem/impacts max criticity management\n\t*Add: min_criticity definition in cotnact and notificationways.\n\t*Add: pylint and coverage pass in the integration server\n\t*Add: the new column pnpgraph_present to the livestatus module\n\t*Add: now create the pickle retention file with a .tmp, so in case of problem, we do not lost the old one.\n\t*Add: event handlers command can now be send by external commands\n\nFIXES\n\t*Fix: (Laurent Guyon) select with no timeout in NSCA arbiter module.\n\t*Fix: shinken init script: enable use of another \"default\" shinken file than hardcoded one by env variable.\n\t*Fix: (current_service_groups needs to return an empty list instead of string) in the livestatus module\n\t*Fix: 'setup.py -h install' now also exit\n\t*Fix: () crash for some bad conf, should raise a message instead.\n\t*Fix: missing check for no args in 'shinken' init script\n\t*Fix: a bug in livestatus Servicegroup.members, minor cosmetics, test case for thruk\n\t*Fix: a bug in host.parents livestatus representation to make thruk happy\n\t*Fix: check for /dev/shm access for the satellites.\n\t*Clean: Redesign of the livestatus module\n\t*Fix: testing with multisite and thruk\n\t*Clean: factorized .is_correct() call for all object types & added log to see more clearly wherer the error is.\n\t*Clean: factorization/simplification of code in action.py (and related) for spawning checks processes.+ clean of old deprecated commented code (& \"related\" too).\n\t*Fix: downtime and comment are now pickle in a dict, not a list.\n\t*Fix: pickle pass for look at tyype, so downtime and comment from 0.4 still ok.\n\t*Fix: acknoledge got too much information in the pickle pass, making the pickle save very very huge. Now fit from 100Mo to..2Mo :)\n\t*Clean: big clean of hasattr->getattr with default value\n\t*Clean: repalce dict for properties with real objects\n\t*Fix: Implement in_check_period/in_notification_period for livestatus to make multisite happy\n\t*Fix: Remove a leftover atribute from timeperiod&daterange\n\t*Fix: Transmit dateranges in timeperiod-full_status-broks\n\t*Fix: Replaced the deprecated StatsGroupBy, implemented Stats: for log entries, making Multisite happy with shinken-livestatus\n\t*Fix: manage the 'null' for inheritance.\n\t*Fix: add timeout to the status_dat module so that the status.dat is written even if no broks are sent.\n\t*Fix: escalations were offset of notif number by -1.\n\t*Fix: Replace Queue with an own implementation of LifoQueue for Python 2.4 (livestatus)\n\t*Fix: Fallback to sqlite 1.x for Python 2.4 (livestatus)\n\t*Fix: bug in the table structure where logging messages are kept (livestatus)\n\t*Fix: problem/impacts should be list, not string.\n\t*Fix: missing customs values in host/service tables in livestatus and Thruk was not happy.\n\t*Fix: is_impact/is_problem got bad format in lviestatus tables.\n\t*Fix: (Kristoffer Moegle) missing check in generic object configuration module.\n\t*Fix: a bug in livestatus. Catch the exception if a peer is not listening for the response\n\t*Fix: support for hosts without check_command (assumed to be always up)\n\t*Fix: hostgroup realm assoc was broken. Now it's tested.\n\t*Fix: (Maximilien Bersoult) fix mysql_db module search path.\n\t*Fix: bug in compensate time when thecore got event handler\n\t*Fix: a bug in the npcd module (spoolfile timestamp extension was float, not int)\n\t*Fix: windows registry paths.\n\t*Fix: problem with Nagios retention that was not happy about host properties type.\n\t*Fix: pickle/nagios retention was loading a retention host/service in the comment.ref link!\n\t*Fix: now only previously notified contacts are send for recovery notifications.\n\t*Fix: bug in NDO module for hostgroups\n\t*Fix: (0.5.1) bugs in LiveStatus module for Service get_full_name call and queries with no space after:\n\n0.4 - 08/12/2010\n------------------\nENHANCEMENTS\n\t*Add: Service generators\n\t*Add: \"Limit:\" in livestatus\n\t*Add: the scheduler now save retention data before stop or take a new conf\n\t*Add: the broker clean quit the modules before quitting\n\t*Add: better output to know which external process for the broker is who in the log\n\t*Add: NodeSet lib use if available for the [X-Y] keys in service generators.\n\t*Add: retention modules, Memcache, Redis or simple file.\n\t*Add: lot of tests, even a end_to_end one for Ha and load balanced installations\n\t*Add: user can put what he want as MACRO in resources.cfg\n\t*Add: lot of log output, and clean a lot of others\n\t*Add: conf sample for PNP integration.\n\t*Add: (Nicolas Dupeux) add a NSCA server module for the Arbiter! (only XOR and none encryption from now)\n\t*Add: now the retention_update_interval parameter is managed.\n\t*Add: the! character before a host_name is now managed in the services. (even if host was defined in a hostgroup). And with test.\n\t*Add: perfdata command management for host/service\n\t*Add: manage modules in the Arbtier and in the schedulers\n\t*Add: nowthe whole documentation is done in the wiki\n\t*Add: obsess_over_host/service and executing oc*p_commands like eventhandlers\n\t*Add: \"templates\" and modes and more for service/host perf data module.\n\t*Add: now host with no address are fill with host_name for this value.\n\t*Add: timeperiod inheritance\n\t*Add: Allow \"members *\" in a hostgroup definition\n\t*Add: manage inherit_parents for dependencies.\n\t*Add: system time change catch for satellites.\n\t*Add: enable_environment_macros now create or not the env dict for checks\n\t*Add: O*HP command management\n\nFIXES\n\t*Fix: Some missing properties in the livestatus tables\n\t*Fix: Some missing properties in the NDO/Mysql export\n\t*Fix: parents property was not stripped(), and a error value was not catched as error\n\t*fix: missing some errors catch in contact definitions\n\t*Fix: Nagios allow contact_name to miss if there is an alias\n\t*Fix: Nagios allow a contact with no 'action' if his options are n/n\n\t*Fix: Resolv macro can loop forever with special output. Now limit it at 32 loop max!\n\t*Fix: the env_macros were enable if we use the tweaks, not good. And they are REALLY CPU killers.\n\t*Fix: LiveStatus: do not close the socket before we are sure the other peer send us nothing. If so, we can close it.\n\t*Fix: solve a case where config files do not end with a line return and will mix parameters.\n\t*Fix: broker spare not look at pollers/reactionners when he come active.\n\t*Fix: now the poller/reactionner REALLY raise broks to the broker (it was clear before...)\n\t*Fix: bug in the Broker that make in some cases broks lost for extarnal modules if they come from the arbiter. (like logs)\n\t*Fix: add a workaround to the livestatus module so it can handle requests from thruk 0.71.1 (which uses strange Stats: requests)\n\t*Fix: rename all 'binaries' without the .py extention so distrib will be happy.\n\t*Fix: livestatus work now with Python 2.4\n\t*Fix: (Hermann Lauer) important bug in status.dat (and in fact all other 'external modules') that make the brok not manage in the good order in some case or Arbtier restart. Thanks a lot to Hermann Lauer that help me a LOT with all the debug logs!\n\t*Fix: (Zoran Zaric) big indentation cleanup\n\t*Fix: error handling in timeperiod inheritance\n\t*Fix: clean on the default configuration\n\t*Fix: manage additional_freshness_latency parameter with a test for check_freshness now.\n\t*Fix: setup.py can create a zip file (egg) for the librairy under Centos. It's not a good thing. It should avoid it\n\t*Fix: From Nicolas Dupeux: error in livestatus split.\n\t*Fix: From Nicolas Dupeux: fix typos in host code\n\n\n\n\n0.3 - 06/10/2010\n------------------\nENHANCEMENTS\n\t*Add: complex hostgroup amtching with & ( ) |!\n\t*Add: resultmodulation code and tests\n\t*Add: brok information about problem/impacts\n\t*Add: livestatus export about problem/impacts\n\t*Add: clean quit on daemons (pid file and sub processes)\n\t*Add: maintenance_period parameter in hosts and services\n\t*Add: even more unit test cases\n\t*Add: now external commands raised in livestatus module are taken by the arbiter\n\t*Add: satellites states are now exported by livestatus\n\t*Add: arbiter module managment\n\t*Add: GLPI import arbiter module :)\n\t*Add: notificationways for contacts\n\t*Add: warning about unmanaged parameters\n\t*Add: log rotation and syslog managment\n\n\nFIXES\n\t*Fix: install crash is now catch with Pyro 4 in Centos (python 2.4)\n\t*Fix: host/service dep where not filled with default properties\n\t*Fix: catch realm configuration errors\n\t*Fix: but in status.dat about parents printing\n\t*Fix: problem with the Collums talbe in livestatus module\n\t*Fix: next valid time was one minute delay for cases with excludes\n\t*Fix: livestatus export in json was bad for service group members\n\t*Fix: bug in windows check launch\n\t*Clean: dispatcher code about useless options\n\t*Clean: tests cases setUp\n\n\n0.2 - 06/09/2010\n------------------\nENHANCEMENTS\n\t*New code layout\n\t*Installation is easy with the setup.py process (first version from Maximilien Bersoult)\n\t*Now compatible with Pyro 3 AND 4\n\t*Now compatible with Python 2.4 and 2.5 too\n\t*Add sticky acknowledgement. Non-permanent ack-comments are now automatically removed\n\t*Add host acknowledgement and acknowledgement stickiness\n\t*Finished service problem acknowledgement. one more testcase\n\t*Add REMOVE_HOST/SVC_ACKNOWLEDGEMENT external command\n\t*Now broker get broks from pollers and reactionners. (Useful for Logs)\n\t*Give Broker a way to make broks :) (like for it's own log)\n\t*Add a problem/incident change states when apply. But it do not interfer with the standard check way of doing (or at least should not).\n\t*Add some LSB init.d scripts\n\t*Add max_plugins_output_length parameter to limit the checks output size.\n\t*\"Hack\" the old nagios parameters: now status_file and nagios_log are catched. If the user defined them, but do not defined the good broker modules, we create them \"on the fly\". I hope one day we will remove it...\n\t*Nested macros are managed (like USERN in ARGN macro).\n\t*Add a pass about changing Nagios2 properties to Nagios3 ones.\n\t*Add json outputformat to the livestatus module\n\t*Add a broker module npcdmod (plus test_npcdmod) which writes a perfdata file suitable for pnp4nagios\n\t*Add check_period implicitly inheritate to service from host.\n\t*Redesign of the notifications (far easier to understand than the old async way)\n\t*Notice about unused parameters and explain why it can be removed from conf.\n\t*Catch non standard return code in actions.py so we can add stderr to the output for such cases.\n\t*Now arbiter host_name property is not mandatory. But WARNING: for a multiple arbiter conf, it must be set.\n\t*Updated cfg documentation (Author: Luke L <lukehasnoname@gmail.com>)\n\t*Add documentation about date range format because it was not documented.\n\t*Update the nagios to shinken migration file\n\t*Change the way broks are send from Arbiter to Broker: before, the Broker connect to the Arbiter, take broks like for schedulers. But Arbiter also connect to broker. That's a nightmare about hangout. Now, Arbiter push the broks. It's far more easy and efficient.\n\t*Add template handling to servicedependencies\n\t*Add test_dependencies as the regression test\n\t*Less status_dat verbosity :)\n\t*Add a last_perf_data + macros to access last perfdatas as in https://sourceforge.net/apps/trac/shinken/ticket/76\n\t*HUGE clean on shinken-specific.cfg file.\n\t*Add a README file\n\t*Add a little note about how migrate from Nagios to Shinken\n\t*Add a hint about how solve 'cannot find my own arbiter' error message.\n\t*Add bin directory with some bash scripts to launch/stop the whole application.\n\t*Relative path, now we can have a easy portable sample configuration. (Gerhard)\n\t*Add two missing operators in livestatus.py\n\t*Big clean up conf sample!\n\t*No more modulespath need in brokerd.ini. Will be easier for packagers.\n\t*Acknowledgement test cases\n\t*Add some hard tests about timeperiods calculations\n\t*Add a test.sh script for Hudson test (launch all tests)\n\t*Add a problem/impact test.\n\t*Now external modules can return objects (from now nobody use it, but it can be useful in the future)\n\t*Make easier to raise checks/notificatiosn from in deep objects class.\n\t*repository cosmetics (Luke L)\n\nFIXES\n\t*Fix: now merlin is correctly filled with update program value\n\t*Bug Fix: ndo do not have command_file, so do not export it.\n\t*Bug fix: retention load was loading not good tab (impacts ones) and so cause problem with remove (not the good object!) (nicolas.dupeux)\n\t*Fix a bug in ACKNOWLEDGE_SVC_PROBLEM ext. command. Sticky can be 0/1/2, not bool\n\t*Bug fix in find_day_by_weekday_offset.\n\t*Bug Fix: when a date was calcl before teh ref time for a weekday it was not recalculated, so problem.\n\t*Bug Fix: error in get_end_of_day. It was given the first secon of the next day, so some exclude make problem with it.\n\t*Bug Fix: shell like commands where not good :(. Thanks to Gilles Seban for pointing it and to Hiren Patel for giving a list of shell caracters (so we know if we should use shell or not :) )\n\t*Bug fix: external commands to send checks should work now\n\t*Bug fix: Arbiter do not more crash when scheduler is down and broker is up (not initialized make a missign parameter)\n\t*Bug Fix: cehck orphaned was badly status set. Thanks Pylint.\n\t*Bug fix: host in unreach were set DOWN un state, but unreach in state_id. Now it say clearly it's UNREACHABLE.\n\t*Bug: retention was loading services objects from retention file. It's not good at all.\n\t*Fix a and -> or bug in the dependancies\n\t*Fix a bug in livestatus. state_type is now a number instead of HARD/SOFT\n\t*Fix a bug in the livestatus module. Eventhandler command is now serializable\n\t*Fix a bug in execute_unix. If there is an exception during plugin execution, use it's string representation as plugin_output\n\t*Fix a bug in the livestatus module. Multiline input is now possible\n\t*Bug: patch from David GU\u00c9NAULT about stopping all brokers\n\t*Correct launched/lanched type everywhere (Gr\u00e9gory Starck)\n\t*Fixed scheduler.add so that master notifications (without contact) don't create a status brok\n\t*Patch from Nicolas DUPEUX about typo correction in service.py\n\t*Reduce CPU comsumption of livestatus broker (thanks flox for the patch)\n\t*Fix a bug in the npcdmod test case\n\t*Fix: configurations files can be mix if the previous do not finished with a line return (Sebastian Reimers)\n\t*Fix: Correct a bad default arbiter pid configuration (Sebastian Reimers)\n\t*Bug fix a missing save of shinken-reactionner.py about path in relative mode\n\t*Global external commands now create an update_program_status_brok instead of program_status_brok\n\t*Fix a bug in the status_dat_broker (incorrect servicegroup-definition in objects.cache)\n\t*Fix: add Gerhard in print screen :)\n\t*Bug Fix: add duplication check for elements (and groups). Only service is allowed to have duplicated (will Warning, but no error).\n\t*Bug Fix: patch from Nicolas Dupeux. Thruk socket shutdowns are now handled in an exception\n\t*Bux Fix (Sven Velt): patch about recursive dir load and check timeperiod typo\n\t*NO MORE nap in code, now all are shinken :)\n\n\n\n0.1 - 31/05/2010\n------------------\nENHANCEMENTS\n\t*Initial realease\n", "To Fronteau Romuald for the logo :)\nTo Gerhard Lausser for patches, features and the Python Livestatus API\nTo Icinga guys for theirs sql files!\nTo David Walsh for mootools!\nTo Haypo for the Ipy lib!\nTo Maximilien Bersoult for it's setup.py\nTo Sebastian Reimers for being the first to add a ticket in the Trac, and hunting a lot of bugs :)\nTo Luke L for reading and correcting the website and the documentation :p\nTo Nicolas Dupeux for patches, bug fixes, bug reports and the NSCA daemon\nTo Gregory Starck for his patch about worker typo, and pyro hooks\nTo David Gu\u00e9nault for the installer, patches, bug fixes, WebUI and more\nTo David Hannequin for his bug reports and his packages :)\nTo Jfbutkiewicz for his full windows management (installation and services!!)\nTo Danijel Tasov for his repositiry cosmetics patch\nTo Zoran Zaric for his help on website corrections and for help file typos\nTo Gilles Seban for is bug report about commands that look like shells\nTo Hiren Patel for giving a list of shells caracters\nTo Sven Velt for it's patch about recursive dir load and check timeperiod typo\nTo Michael Jeanson for the first Shinken Ubuntu LTS package!\nTo Andreas Karfusehr for his proposition of donation of a Board licence :)\nTo Hermann Lauer for his help on the hard brok order bug in status.dat!\nTo Andreas Ericsson for his ideas for service generators\nTo Degremont Aurelien for his code about NodeSet and how to manage the multiple paterns\nTo \u041f\u0435\u0442\u0440\u043e\u0432 \u0418\u0432\u0430\u043d to identify a huge bug on windows\nTo Hartmut Goebel for his advice on code quality, and for the patches :)\nTo Gregory Ranchy for his help on the official doc\nTo Kristoffer Moegle for this patch on arbiter configuration module\nTo Eric Beaulieu for his help on the ssl certificates, and for the Windows installation script :)\nTo Laurent Guyon, our best bug hunter :)\nTo Alan Brenner for his SSL core for the NRPE module\nTo Venelin Petkov for this bug report about missing customs on services, and the 'print' in name bug problem :)\nTo Papp Tamas for his bug report of bad python version under ubuntu (and debian)\nTo R\u00e9mi Buisson for his bug report about bad etc/default/shinken file :)\nTo Julien Toscano for his bug report about bad launch_all.sh launch.\nTo Raynald de Lahond\u00e8s and the Sibio team for the FreeBSD testing, Tuto and the host dep bug report!\nTo Hienz Michael for the bug report about bad local_file :)\nTo Ronny Lindner for the bug report about non host expressions for services\nTo Olivier Hanesse bug reports, patches and new features\nTo Markus Elger for this bug report about no schedule retention data\nTo Vincent Riquer for his bug report about HA installation and sapre broker that stay alive\nTo Michael Grundmann for his bug report about service host exclusion and void hostgroup\nTo Jan Kaliszewski for his implementation of sorted dicts\nTo Claneys Skyne bug reports and patches\nTo Etienne Obriot for his patch about multiple = in macos values\nTo obiouane for his bug report about missing object value\nTo Thibault Cohen for his patches and bug reports\nTo Carmelle Monkoun for the bug report about Pyro4.8\nTo Bruno Clermont for the fix in bottle call and the typos\nTo St\u00e9phane Duchesneau for his work on the setup.py file and log/run driectories.\nTo grim for his bug report about disabling flapping options\nTo peter woodman for his bug report about timezone override crash\nTo Laurent Ollagnier for his bug report and patch about notification commands\nTo sprudhomme for his feature request about long_output in Centreon/Ndo\nTo Gabor Varga for his patch about the \"sc\" command for windowns setup :)\nTo foobar1111 for his ask about fqdn and arbiter matching for hostname\nTo twellspring for hs bug report about escalation and templates\nTo Michael Leinartas for his patch about man pages\nTo Nelson Pascoal for his patch about typos in daemons\nTo Steve Kieu for his bug report about missing name in Config object\nTo Victor Igumnov for his patch about Solaris installation\nTo Thomas Meson for his patch for setup.py and 1.0 version :)\nTo Manicow for his bug report on escalations\nTo Mocnik Matjaz for his dump of Allied equipement\nTo Daniel Roche for his bug report for hostdeps and multiple names\nTo Guillaume Bour (Uperto) for his numerous patches!\nTo Raphael Doursenaud for his patch about SNI option in https pack\nTo Forlot Romain for his multiple patches\nTo Michael Coquard for his patch about setup.py and build path\nTo Akiooutori for his bug report about pyro missing SOCK_REUSE parameter in some os\nTo Timo Veith for this work on the Wiki refactoring!\nTo Lars Hansson for this patches about cfg password module and Apache one\nTo the webui mobile guys: Mael Vincent, julien Pilou, Gael Millet, Damien Mathieu and hugo Viricel for their new webui mobile ui.\nTo Mathias Fussenegger for his large patch about configuration tab/space resolution.\nTo banderas07 and Radu Gheorghe for their works on the escalation notification_interval issue!\nTo Simon Rother for discovering a possible race condition.\nTo David Laval for his graphite templates on the linux checks\nTo nerocide for his bug report about bad event handler catch\nTo Mathieu.md for multiple configuration file updates\nTo raphaeltr for a typo patch on a monitoring pack\nTo Jan Ulferts for his patch about env macros fix on notifications\nTo R\u00e9mi Sauvat for his patch about dashboard automatic widget refresh\nTo chris81 for his patch for graphite API URLs\nTo maethor and scaminad for reporting IMAP/POPS missing port\nTo Florent Houbart for this bug fix on LiveStatus+NagVis\nTo olc and ppj for the arbiter spare bug report\nTo Nicolas Pichon for his patch about Graphite and custom macro use\nTo Thomas Cellerier for his patch about a ZeroMQ broker module.\nTo Christoph Roeder for his patch about pnp xml file in livestatus\nTo Fran\u00e7ois Lafont for his patch about business impact macro\nTo Spil-brensen for his patch about Scientific Linux in install script.\nTo jbeltran for his bug report about GLPIDB\nTo Joachim Schiele for his bug report about PNP version\nTo flaf and Imrane.Dessai for their bug report about additive inheritance.\nTo Johan Svensson for his bug report about poller worker crash not in logs, and for his patch about NRPE booster crash with bad SSL\nTo Finn Christiansen for his bug report about function get_all_host_names_set missing since 1.2.4\nTo Michael L\u00fcbben for his bug report about telnet crashing daemons\nTo GILLARDEAU Thibaut for his bug report about the windows pack\nTo Georges Racinet for his bugs reports about SSL\nTo pepejey for his bug report about void password in ldap auth module. And NO THANKS to the Ldap protocol RFC guys :( \nTo Benoit Dunand-Laisin for his bug report about livestatus command management regression\nTo Alexandre Veyrenc for his patch about Graphite management of perfdata with spare in names\nTo Frederic Mohier for his fix about nmap discovery and windows\nTo Micka\u00ebl Falck for his patch about network packs interface new parameters\nTo Squizou for his patch about ; split code\nTo Alexander Springer for his patch about merging host and services contacts\nTo Stefan Taute for his patch about syslog module collisions\nTo Jean-Claude Computing for his patch about syslog module collisions too\nTo Robin Gloster for his bug fix about bad wmi ini dir\nTo Samuel Milette-Lacombe for his patch about core configuration export on broker\nTo Mathieu Parent for his patch about Thruk doc\nTo Aina Rakotoson for his bug report about reactionner_tag logic fail, and his patch to fix about it\nTo jylenhofgfi for his bug report about shinken cli problems and | grep\nTo Alexandre Viau for his patch about passive unmanaged host broks generation\nTo Nicolas Perraud for his warn about a RCE in the daemon exchange\n", "#!/usr/bin/python2\n\n# -*- coding: utf-8 -*-\n\nimport os\nimport sys\nimport re\n\ntry:\n    import pwd\n    import grp\nexcept ImportError:\n    # don't expect to have this on windows :)\n    pwd = grp = None\nimport stat\n\n# Utility function to read the README file.\n# Used for the long_description.  It's nice, because now 1) we have a top level\n# README file and 2) it's easier to type in the README file than to put a raw\n# string in below ...\n\ntry:\n    from setuptools import setup\n    from setuptools import find_packages\nexcept:\n    sys.exit(\"Error: missing python-setuptools library\")\n\nfrom itertools import chain\nimport optparse\nimport itertools\nfrom glob import glob\n\nfrom distutils.dir_util import mkpath\n\ntry:\n    python_version = sys.version_info\nexcept:\n    python_version = (1, 5)\nif python_version < (2, 6):\n    sys.exit(\"Shinken require as a minimum Python 2.6.x, sorry\")\nelif python_version >= (3,):\n    sys.exit(\"Shinken is not yet compatible with Python3k, sorry\")\n\npackage_data = ['*.py', 'modules/*.py', 'modules/*/*.py']\n\n\ndef read(fname):\n    return open(os.path.join(os.path.dirname(__file__), fname)).read()\n\n\ndef ensure_dir_exist(f):\n    dirname = os.path.dirname(f)\n    if not os.path.exists(dirname):\n        os.makedirs(dirname)\n\n\ndef generate_default_shinken_file():\n    # The default file must have good values for the directories:\n    # etc, var and where to push scripts that launch the app.\n    templatefile = \"bin/default/shinken.in\"\n    build_base = 'build'\n    outfile = os.path.join(build_base, \"bin/default/shinken\")\n    \n    # print('generating %s from %s', outfile, templatefile)\n    \n    mkpath(os.path.dirname(outfile))\n    \n    bin_path = default_paths['bin']\n    \n    # Read the template file\n    f = open(templatefile)\n    buf = f.read()\n    f.close()\n    # substitute\n    buf = buf.replace(\"$ETC$\", default_paths['etc'])\n    buf = buf.replace(\"$VAR$\", default_paths['var'])\n    buf = buf.replace(\"$RUN$\", default_paths['run'])\n    buf = buf.replace(\"$LOG$\", default_paths['log'])\n    buf = buf.replace(\"$SCRIPTS_BIN$\", bin_path)\n    # write out the new file\n    f = open(outfile, \"w\")\n    f.write(buf)\n    f.close()\n\n\ndef update_file_with_string(infilename, outfilename, matches, new_strings):\n    f = open(infilename)\n    buf = f.read()\n    f.close()\n    for match, new_string in zip(matches, new_strings):\n        buf = re.sub(match, new_string, buf)\n    f = open(outfilename, \"w\")\n    f.write(buf)\n    f.close()\n\n\ndef append_file_with(infilename, outfilename, append_string):\n    f = open(infilename)\n    buf = f.read()\n    f.close()\n    ensure_dir_exist(outfilename)\n    f = open(outfilename, \"w\")\n    f.write(buf)\n    f.write('\\n')\n    f.write(append_string)\n    f.close()\n\n\ndef recursive_chown(path, uid, gid, owner, group):\n    print(\"Changing owner of %s to %s:%s\" % (path, owner, group))\n    os.chown(path, uid, gid)\n    if os.path.isdir(path):\n        for dirname, dirs, files in os.walk(path):\n            for path in itertools.chain(dirs, files):\n                path = os.path.join(dirname, path)\n                os.chown(path, uid, gid)\n\n\ndef get_uid(user_name):\n    try:\n        return pwd.getpwnam(user_name)[2]\n    except KeyError, exp:\n        return None\n\n\ndef get_gid(group_name):\n    try:\n        return grp.getgrnam(group_name)[2]\n    except KeyError, exp:\n        return None\n\n\n# Do a chmod -R +x\ndef _chmodplusx(d):\n    if not os.path.exists(d):\n        print \"warn: _chmodplusx missing dir\", d\n        return\n    if os.path.isdir(d):\n        for item in os.listdir(d):\n            p = os.path.join(d, item)\n            if os.path.isdir(p):\n                _chmodplusx(p)\n            else:\n                st = os.stat(p)\n                os.chmod(p, st.st_mode | stat.S_IEXEC | stat.S_IXGRP | stat.S_IXOTH)\n    else:\n        st = os.stat(d)\n        os.chmod(d, st.st_mode | stat.S_IEXEC | stat.S_IXGRP | stat.S_IXOTH)\n\n\nparser = optparse.OptionParser(\n    \"%prog [options]\", version=\"%prog \")\nparser.add_option('--root', dest=\"proot\", metavar=\"ROOT\", help='Root dir to install, usefull only for packagers')\nparser.add_option('--upgrade', '--update', dest=\"upgrade\", action='store_true', help='Only upgrade')\nparser.add_option('--owner', dest=\"owner\", metavar=\"OWNER\", help='User to install with, default shinken')\nparser.add_option('--group', dest=\"group\", metavar=\"GROUP\", help='Group to install with, default shinken')\nparser.add_option('--install-scripts', dest=\"install_scripts\", help='Path to install the shinken-* scripts')\nparser.add_option('--skip-build', dest=\"skip_build\", action='store_true', help='skipping build')\nparser.add_option('-O', type=\"int\", dest=\"optimize\", help='skipping build')\nparser.add_option('--record', dest=\"record\", help='File to save writing files. Used by pip install only')\nparser.add_option('--single-version-externally-managed', dest=\"single_version\", action='store_true', help='I really dont know, this option is for pip only')\n\nold_error = parser.error\n\n\ndef _error(msg):\n    print 'Parser error', msg\n\n\nparser.error = _error\nopts, args = parser.parse_args()\n# reenable the errors for later use\nparser.error = old_error\n\nroot = opts.proot or ''\n\n# We try to see if we are in a full install or an update process\nis_update = False\n# Try to import shinekn but not the local one. If avialable, we are in\n# and upgrade phase, not a classic install\ntry:\n    if '.' in sys.path:\n        sys.path.remove('.')\n    if os.path.abspath('.') in sys.path:\n        sys.path.remove(os.path.abspath('.'))\n    if '' in sys.path:\n        sys.path.remove('')\n    import shinken\n    \n    is_update = True\n    print \"Previous Shinken lib detected (%s)\" % shinken.__file__\nexcept ImportError:\n    pass\n\nif '--update' in args or opts.upgrade or '--upgrade' in args:\n    print \"Shinken Lib Updating process only\"\n    if 'update' in args:\n        sys.argv.remove('update')\n        sys.argv.insert(1, 'install')\n    if '--update' in args:\n        sys.argv.remove('--update')\n    if '--upgrade' in args:\n        sys.argv.remove('--upgrade')\n    \n    print \"Shinken Lib Updating process only\"\n    is_update = True\n\nis_install = False\nif 'install' in args:\n    is_install = True\n\n# Last step for pip insta an install one (at least in pip 9.0.1)\nis_pip_real_install_step = 'bdist_wheel' in sys.argv\nif is_pip_real_install_step:\n    is_update = False\n    is_install = True\n\n\ninstall_scripts = opts.install_scripts or ''\n\nuser = opts.owner or 'shinken'\ngroup = opts.group or 'shinken'\n\n# Maybe the user is unknown, but we are in a \"classic\" install, if so, bail out\nif is_install and not root and not is_update and pwd and not opts.skip_build:\n    uid = get_uid(user)\n    gid = get_gid(group)\n    \n    if uid is None or gid is None:\n        print \"Error: the user/group %s/%s is unknown. Please create it first 'useradd %s'\" % (user, group, user)\n        sys.exit(2)\n\n# setup() will warn about unknown parameter we already managed\n# to delete them\ndeleting_args = ['--owner', '--group', '--skip-build']\n\nto_del = []\nfor a in deleting_args:\n    for av in sys.argv:\n        if av.startswith(a):\n            idx = sys.argv.index(av)\n            print \"AV,\", av, \"IDX\", idx\n            to_del.append(idx)\n            # We can have --owner=shinken or --owner shinken, if so del also the\n            # next one\n            if '=' not in av:\n                to_del.append(idx + 1)\n\nto_del.sort()\nto_del.reverse()\nfor idx in to_del:\n    sys.argv.pop(idx)\n\n# compute scripts\nscripts = [s for s in glob('bin/shinken*') if not s.endswith('.py')]\n\n# Define files\nif sys.platform.startswith('win'):\n    default_paths = {\n        'bin'    : install_scripts or \"c:\\\\shinken\\\\bin\",\n        'var'    : \"c:\\\\shinken\\\\var\",\n        'share'  : \"c:\\\\shinken\\\\var\\\\share\",\n        'etc'    : \"c:\\\\shinken\\\\etc\",\n        'log'    : \"c:\\\\shinken\\\\var\",\n        'run'    : \"c:\\\\shinken\\\\var\",\n        'libexec': \"c:\\\\shinken\\\\libexec\",\n    }\n    data_files = []\nelif 'linux' in sys.platform or 'sunos5' in sys.platform:\n    default_paths = {\n        'bin'    : install_scripts or \"/usr/bin\",\n        'var'    : \"/var/lib/shinken/\",\n        'share'  : \"/var/lib/shinken/share\",\n        'etc'    : \"/etc/shinken\",\n        'run'    : \"/var/run/shinken\",\n        'log'    : \"/var/log/shinken\",\n        'libexec': \"/var/lib/shinken/libexec\",\n    }\n    data_files = [\n        (\n            os.path.join('/etc', 'init.d'),\n            ['bin/init.d/shinken',\n             'bin/init.d/shinken-arbiter',\n             'bin/init.d/shinken-broker',\n             'bin/init.d/shinken-receiver',\n             'bin/init.d/shinken-poller',\n             'bin/init.d/shinken-reactionner',\n             'bin/init.d/shinken-scheduler',\n             ]\n        )\n    ]\n    \n    if is_install:\n        # warning: The default file will be generated a bit later\n        data_files.append(\n            (os.path.join('/etc', 'default', ),\n             ['build/bin/default/shinken']\n             ))\nelif 'bsd' in sys.platform or 'dragonfly' in sys.platform:\n    default_paths = {\n        'bin'    : install_scripts or \"/usr/local/bin\",\n        'var'    : \"/usr/local/libexec/shinken\",\n        'share'  : \"/usr/local/share/shinken\",\n        'etc'    : \"/usr/local/etc/shinken\",\n        'run'    : \"/var/run/shinken\",\n        'log'    : \"/var/log/shinken\",\n        'libexec': \"/usr/local/libexec/shinken/plugins\",\n    }\n    data_files = [\n        (\n            '/usr/local/etc/rc.d',\n            ['bin/rc.d/shinken-arbiter',\n             'bin/rc.d/shinken-broker',\n             'bin/rc.d/shinken-receiver',\n             'bin/rc.d/shinken-poller',\n             'bin/rc.d/shinken-reactionner',\n             'bin/rc.d/shinken-scheduler',\n             ]\n        )\n    ]\nelse:\n    raise Exception(\"Unsupported platform, sorry\")\n    data_files = []\n\n# Change paths if need\n# if root:\n#    for (k,v) in default_paths.iteritems():\n#        default_paths[k] = os.path.join(root, v[1:])\n\n\n# Beware to install scripts in the bin dir\ndata_files.append((default_paths['bin'], scripts))\n# Only some platform are managed by the init.d scripts\nif is_install and ('linux' in sys.platform or 'sunos5' in sys.platform):\n    generate_default_shinken_file()\n\nif not is_update:\n    ## get all files + under-files in etc/ except daemons folder\n    daemonsini = []\n    for path, subdirs, files in os.walk('etc'):\n        if len(files) == 0:\n            data_files.append((os.path.join(default_paths['etc'], re.sub(r\"^(etc\\/|etc$)\", \"\", path)), []))\n        for name in files:\n            if name == 'shinken.cfg':\n                continue\n            if 'daemons' in path:\n                daemonsini.append(os.path.join(path, name))\n            else:\n                data_files.append((os.path.join(default_paths['etc'], re.sub(r\"^(etc\\/|etc$)\", \"\", path)),\n                                   [os.path.join(path, name)]))\n\nif os.name != 'nt' and not is_update:\n    for _file in daemonsini:\n        inifile = _file\n        outname = os.path.join('build', _file)\n        # force the user setting as it's not set by default\n        append_file_with(inifile, outname, \"modules_dir=%s\\nuser=%s\\ngroup=%s\\n\" % (\n            os.path.join(default_paths['var'], 'modules'),\n            user, group))\n        data_files.append((os.path.join(default_paths['etc'], 'daemons'),\n                           [outname]))\n    \n    # And update the shinken.cfg file for all /usr/local/shinken/var\n    # value with good one\n    for name in ['shinken.cfg']:\n        inname = os.path.join('etc', name)\n        outname = os.path.join('build', name)\n        print('updating path in %s', outname)\n        \n        ## but we HAVE to set the shinken_user & shinken_group to thoses requested:\n        update_file_with_string(inname, outname,\n                                [\"shinken_user=\\w+\", \"shinken_group=\\w+\", \"workdir=.+\", \"lock_file=.+\", \"local_log=.+\", \"modules_dir=.+\", \"pack_distribution_file=.+\"],\n                                [\"shinken_user=%s\" % user,\n                                 \"shinken_group=%s\" % group,\n                                 \"workdir=%s\" % default_paths['var'],\n                                 \"lock_file=%s/arbiterd.pid\" % default_paths['run'],\n                                 \"local_log=%s/arbiterd.log\" % default_paths['log'],\n                                 \"modules_dir=%s\" % os.path.join(default_paths['var'], 'modules'),\n                                 \"pack_distribution_file=%s\" % os.path.join(default_paths['var'], 'pack_distribution.dat')],\n                                )\n        data_files.append((default_paths['etc'], [outname]))\n\n# Modules, doc, inventory and cli are always installed\npaths = ('modules', 'doc', 'inventory', 'cli')\nfor path, subdirs, files in chain.from_iterable(os.walk(patho) for patho in paths):\n    for name in files:\n        data_files.append((os.path.join(default_paths['var'], path), [os.path.join(path, name)]))\n\nfor path, subdirs, files in os.walk('share'):\n    for name in files:\n        data_files.append((os.path.join(default_paths['share'], re.sub(r\"^(share\\/|share$)\", \"\", path)),\n                           [os.path.join(path, name)]))\n\nfor path, subdirs, files in os.walk('libexec'):\n    for name in files:\n        data_files.append((os.path.join(default_paths['libexec'], re.sub(r\"^(libexec\\/|libexec$)\", \"\", path)),\n                           [os.path.join(path, name)]))\n\ndata_files.append((default_paths['run'], []))\ndata_files.append((default_paths['log'], []))\n\n# Note: we do not add the \"scripts\" entry in the setup phase because we need to generate the\n# default/shinken file with the bin path before run the setup phase, and it's not so\n# easy to do in a clean and easy way\n\nnot_allowed_options = ['--upgrade', '--update']\nfor o in not_allowed_options:\n    if o in sys.argv:\n        sys.argv.remove(o)\n\nrequired_pkgs = ['pycurl']\nsetup(\n    name=\"Shinken\",\n    version=\"2.4.4\",\n    packages=find_packages(),\n    package_data={'': package_data},\n    description=\"Shinken is a monitoring framework compatible with Nagios configuration and plugins\",\n    long_description=read('README.rst'),\n    author=\"Gabes Jean\",\n    author_email=\"naparuba@gmail.com\",\n    license=\"GNU Affero General Public License\",\n    url=\"http://www.shinken-monitoring.org\",\n    zip_safe=False,\n    classifiers=[\n        'Development Status :: 5 - Production/Stable',\n        'Environment :: Console',\n        'Intended Audience :: System Administrators',\n        'License :: OSI Approved :: GNU Affero General Public License v3',\n        'Operating System :: MacOS :: MacOS X',\n        'Operating System :: Microsoft :: Windows',\n        'Operating System :: POSIX',\n        'Programming Language :: Python',\n        'Topic :: System :: Monitoring',\n        'Topic :: System :: Networking :: Monitoring',\n    ],\n    install_requires=[\n        required_pkgs\n    ],\n    \n    extras_require={\n        'setproctitle': ['setproctitle']\n    },\n    \n    data_files=data_files,\n)\n\n# if root is set, it's for package, so NO chown\nif pwd and not root and is_install:\n    # assume a posix system\n    uid = get_uid(user)\n    gid = get_gid(group)\n    \n    if uid is not None and gid is not None:\n        # recursivly changing permissions for etc/shinken and var/lib/shinken\n        for c in ['etc', 'run', 'log', 'var', 'libexec']:\n            p = default_paths[c]\n            recursive_chown(p, uid, gid, user, group)\n        # Also change the rights of the shinken- scripts\n        for s in scripts:\n            bs = os.path.basename(s)\n            recursive_chown(os.path.join(default_paths['bin'], bs), uid, gid, user, group)\n            _chmodplusx(os.path.join(default_paths['bin'], bs))\n        _chmodplusx(default_paths['libexec'])\n    \n    # If not exists, won't raise an error there\n    _chmodplusx('/etc/init.d/shinken')\n    for d in ['scheduler', 'broker', 'receiver', 'reactionner', 'poller', 'arbiter']:\n        _chmodplusx('/etc/init.d/shinken-' + d)\n\ntry:\n    import pycurl\nexcept ImportError:\n    print \"Warning: missing python-pycurl lib, you MUST install it before launch the shinken daemons\"\n\ntry:\n    import cherrypy\nexcept ImportError:\n    print \"Notice: for better performances for the daemons communication, you should install the python-cherrypy3 lib\"\n\nprint \"Shinken setup done\"\n", "# -*- coding: utf-8 -*-\n\n# Copyright (C) 2009-2014:\n#     Gabes Jean, naparuba@gmail.com\n#     Gerhard Lausser, Gerhard.Lausser@consol.de\n#     Gregory Starck, g.starck@gmail.com\n#     Hartmut Goebel, h.goebel@goebel-consult.de\n#\n# This file is part of Shinken.\n#\n# Shinken is free software: you can redistribute it and/or modify\n# it under the terms of the GNU Affero General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Shinken is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU Affero General Public License for more details.\n#\n# You should have received a copy of the GNU Affero General Public License\n# along with Shinken.  If not, see <http://www.gnu.org/licenses/>.\n\nimport sys\nimport cPickle\nfrom cStringIO import StringIO\n\n\n# Unpickle but strip and remove all __reduce__ things so we don't allow external code to be executed\n# Code from Graphite::carbon project\nclass SafeUnpickler(object):\n    PICKLE_SAFE = {\n        'copy_reg'                                : set(['_reconstructor']),\n        '__builtin__'                             : set(['object', 'set']),\n        \n        # Be sure to white list all we need to pickle.loads so user cannot exploit other modules (like bottle ^^)\n        'shinken.acknowledge'                     : set(['Acknowledge']),\n        'shinken.basemodule'                      : set(['BaseModule']),\n        'shinken.borg'                            : set(['Borg']),\n        'shinken.check'                           : set(['Check']),\n        'shinken.brok'                            : set(['Brok']),\n        'shinken.commandcall'                     : set(['CommandCall']),\n        'shinken.comment'                         : set(['Comment']),\n        'shinken.complexexpression'               : set(['ComplexExpressionNode']),\n        'shinken.contactdowntime'                 : set(['ContactDowntime']),\n        'shinken.daterange'                       : set(['Timerange',\n                                                         'Daterange',\n                                                         'CalendarDaterange',\n                                                         'StandardDaterange',\n                                                         'MonthWeekDayDaterange',\n                                                         'MonthDateDaterange',\n                                                         'WeekDayDaterange',\n                                                         'MonthDayDaterange',\n                                                         ]),\n        'shinken.dependencynode'                  : set(['DependencyNode']),\n        'shinken.downtime'                        : set(['Downtime']),\n        'shinken.discovery.discoverymanager'      : set(['DiscoveredHost']),\n        'shinken.eventhandler'                    : set(['EventHandler']),\n        'shinken.external_command'                : set(['ExternalCommand']),\n        'shinken.graph'                           : set(['Graph']),\n        'shinken.message'                         : set(['Message']),\n        'shinken.modulesctx'                      : set(['ModulesContext']),\n        'shinken.modulesmanager'                  : set(['ModulesManager']),\n        'shinken.notification'                    : set(['Notification']),\n        'shinken.objects.command'                 : set(['DummyCommand', 'Command', 'Commands']),\n        'shinken.objects.arbiterlink'             : set(['ArbiterLink', 'ArbiterLinks']),\n        'shinken.objects.businessimpactmodulation': set(['Businessimpactmodulation', 'Businessimpactmodulations']),\n        'shinken.objects.brokerlink'              : set(['BrokerLink', 'BrokerLinks']),\n        'shinken.objects.checkmodulation'         : set(['CheckModulation', 'CheckModulations']),\n        'shinken.objects.config'                  : set(['Config']),\n        'shinken.objects.contact'                 : set(['Contact', 'Contacts']),\n        'shinken.objects.contactgroup'            : set(['Contactgroup', 'Contactgroups']),\n        'shinken.objects.discoveryrule'           : set(['Discoveryrule', 'Discoveryrules']),\n        'shinken.objects.discoveryrun'            : set(['Discoveryrun', 'Discoveryruns']),\n        'shinken.objects.escalation'              : set(['Escalation', 'Escalations']),\n        'shinken.objects.hostdependency'          : set(['Hostdependency', 'Hostdependencies']),\n        'shinken.objects.host'                    : set(['Host', 'Hosts']),\n        'shinken.objects.hostescalation'          : set(['Hostescalation', 'Hostescalations']),\n        'shinken.objects.itemgroup'               : set(['Itemgroup', 'Itemgroups']),\n        'shinken.objects.hostgroup'               : set(['Hostgroup', 'Hostgroups']),\n        'shinken.objects.hostextinfo'             : set(['HostExtInfo', 'HostsExtInfo']),\n        'shinken.objects.item'                    : set(['Item', 'Items']),\n        'shinken.objects.macromodulation'         : set(['MacroModulation', 'MacroModulations']),\n        'shinken.objects.matchingitem'            : set(['MatchingItem']),\n        'shinken.objects.pack'                    : set(['Pack', 'Packs']),\n        'shinken.objects.notificationway'         : set(['NotificationWay', 'NotificationWays']),\n        'shinken.objects.module'                  : set(['Module', 'Modules']),\n        'shinken.objects.pollerlink'              : set(['PollerLink', 'PollerLinks']),\n        'shinken.objects.reactionnerlink'         : set(['ReactionnerLink', 'ReactionnerLinks']),\n        'shinken.objects.realm'                   : set(['Realm', 'Realms']),\n        'shinken.objects.receiverlink'            : set(['ReceiverLink', 'ReceiverLinks']),\n        'shinken.objects.resultmodulation'        : set(['Resultmodulation', 'Resultmodulations']),\n        'shinken.objects.satellitelink'           : set(['SatelliteLink', 'SatelliteLinks']),\n        'shinken.objects.schedulingitem'          : set(['SchedulingItem']),\n        'shinken.objects.schedulerlink'           : set(['SchedulerLink', 'SchedulerLinks']),\n        'shinken.objects.service'                 : set(['Service', 'Services']),\n        'shinken.objects.servicedependency'       : set(['Servicedependency', 'Servicedependencies']),\n        'shinken.objects.serviceescalation'       : set(['Serviceescalation', 'Serviceescalations']),\n        'shinken.objects.serviceextinfo'          : set(['ServiceExtInfo', 'ServicesExtInfo']),\n        'shinken.objects.servicegroup'            : set(['Servicegroup', 'Servicegroups']),\n        'shinken.objects.timeperiod'              : set(['Timeperiod', 'Timeperiods']),\n        'shinken.objects.trigger'                 : set(['Trigger', 'Triggers']),\n        \n    }\n    \n    \n    @classmethod\n    def find_class(cls, module, name):\n        if module not in cls.PICKLE_SAFE:\n            raise ValueError('Attempting to unpickle unsafe module %s' % module)\n        __import__(module)\n        mod = sys.modules[module]\n        if name not in cls.PICKLE_SAFE[module]:\n            raise ValueError('Attempting to unpickle unsafe class %s/%s' %\n                             (module, name))\n        return getattr(mod, name)\n    \n    \n    @classmethod\n    def loads(cls, pickle_string):\n        pickle_obj = cPickle.Unpickler(StringIO(pickle_string))\n        pickle_obj.find_global = cls.find_class\n        return pickle_obj.load()\n", "#!/usr/bin/env python\n# Copyright (C) 2009-2014:\n#    Gabes Jean, naparuba@gmail.com\n#    Gerhard Lausser, Gerhard.Lausser@consol.de\n#\n# This file is part of Shinken.\n#\n# Shinken is free software: you can redistribute it and/or modify\n# it under the terms of the GNU Affero General Public License as published by\n# the Free Software Foundation, either version 3 of the License, or\n# (at your option) any later version.\n#\n# Shinken is distributed in the hope that it will be useful,\n# but WITHOUT ANY WARRANTY; without even the implied warranty of\n# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n# GNU Affero General Public License for more details.\n#\n# You should have received a copy of the GNU Affero General Public License\n# along with Shinken.  If not, see <http://www.gnu.org/licenses/>.\n\n#\n# This file is used to test reading and processing of config files\n#\n\n\nimport cPickle as pickle\nimport sys\n\nfrom shinken_test import *\n\nfrom shinken.safepickle import SafeUnpickler\n\nshould_not_change = False\n\n\ndef fff(b):\n    global should_not_change\n    should_not_change = b\n\n\nclass SadPanda(object):\n    def __reduce__(self):\n        return (fff, (True,))\n\n\nclass TestSafePickle(ShinkenTest):\n    \n    def setUp(self):\n        pass\n    \n    \n    def launch_safe_pickle(self, buf):\n        SafeUnpickler.loads(buf)\n    \n    \n    def test_safe_pickle(self):\n        global should_not_change\n        \n        print(\"Creating payload\")\n        buf = pickle.dumps(SadPanda(), 0)\n        should_not_change = False\n        print(\"Payload\", buf)\n        # self.assertEqual('HARD', host.state_type)\n        print(\"Now loading payload\")\n        pickle.loads(buf)\n        print should_not_change\n        self.assertTrue(should_not_change)\n        \n        # reset and try our fix\n        should_not_change = False\n        \n        \n        # SafeUnpickler.loads(buf)\n        def launch_safe_pickle():\n            SafeUnpickler.loads(buf)\n        \n        \n        self.assertRaises(ValueError, launch_safe_pickle)\n        print (should_not_change)\n        self.assertFalse(should_not_change)\n    \n    \n    # Thanks to security team @Dailymotion, we did have a RCE that ook like a return into libc\n    # exploit: they are using the bottle._load code (that blindly __import__) so the injected\n    # code will finally be executed. And as it's shinken.webui.bottle, it's ok with the\n    # safe_pickle filter. Smart ^^\n    def test_safe_pickle_exploit_rce(self):\n        ###### Phase 1: can be exploited\n        # Arrange\n        rce_path = '/rce_exploited'\n        if rce_path in sys.path:\n            sys.path.remove(rce_path)\n        \n        payload = b\"\"\"cshinken.webui.bottlewebui\n_load\n(S'sys:path.append(\"%s\")'\ntR.\"\"\" % rce_path\n        \n        # Act\n        print(\"Now loading payload\")\n        pickle.loads(payload)\n        \n        # Assert\n        self.assertTrue(rce_path in sys.path)\n        \n        ##### Phase 2: no more exploitable by calling the good one\n        # Arrange\n        sys.path.remove(rce_path)\n        \n        \n        # SafeUnpickler.loads(buf)\n        def launch_safe_pickle():\n            SafeUnpickler.loads(payload)\n        \n        \n        # Act\n        self.assertRaises(ValueError, launch_safe_pickle)\n        \n        # Assert\n        self.assertTrue(rce_path not in sys.path)\n    \n    \n    # Thanks to security team @Dailymotion, we did have a RCE that ook like a return into libc\n    # exploit: they are using the bottle._load code (that blindly __import__) so the injected\n    # code will finally be executed. And as it's shinken.webui.bottle, it's ok with the\n    # safe_pickle filter. Smart ^^\n    def test_safe_pickle_exploit_rce_can_load(self):\n        ###### Phase 1: can be exploited\n        # Arrange\n        \n        payload = pickle.dumps(Brok('void', {}))\n        \n        # Act\n        b = SafeUnpickler.loads(payload)\n        \n        # Assert\n        self.assertTrue(isinstance(b, Brok))\n\n\nif __name__ == '__main__':\n    unittest.main()\n"], "filenames": ["Changelog", "THANKS", "setup.py", "shinken/safepickle.py", "test/test_safe_pickle.py"], "buggy_code_start_loc": [6, 113, 414, 29, 26], "buggy_code_end_loc": [13, 113, 415, 52, 75], "fixing_code_start_loc": [6, 114, 414, 29, 27], "fixing_code_end_loc": [60, 115, 415, 119, 140], "type": "CWE-306", "message": "Shinken Solutions Shinken Monitoring Version 2.4.3 affected is vulnerable to Incorrect Access Control. The SafeUnpickler class found in shinken/safepickle.py implements a weak authentication scheme when unserializing objects passed from monitoring nodes to the Shinken monitoring server.", "other": {"cve": {"id": "CVE-2022-37298", "sourceIdentifier": "cve@mitre.org", "published": "2022-10-20T11:15:10.380", "lastModified": "2022-10-21T16:25:43.080", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Shinken Solutions Shinken Monitoring Version 2.4.3 affected is vulnerable to Incorrect Access Control. The SafeUnpickler class found in shinken/safepickle.py implements a weak authentication scheme when unserializing objects passed from monitoring nodes to the Shinken monitoring server."}, {"lang": "es", "value": "Shinken Solutions Shinken Monitoring versi\u00f3n afectada 2.4.3, es vulnerable a un Control de Acceso Incorrecto. La clase SafeUnpickler que es encontrada en el archivo shinken/safepickle.py implementa un esquema de autenticaci\u00f3n d\u00e9bil cuando son deserializados los objetos pasados desde los nodos de monitorizaci\u00f3n al servidor de monitorizaci\u00f3n de Shinken"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-306"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:shinken-monitoring:shinken_monitoring:2.4.3:*:*:*:*:*:*:*", "matchCriteriaId": "8E8BB8DE-A07F-4DF6-87A9-4AFEFD49ACFD"}]}]}], "references": [{"url": "https://github.com/dbyio/cve-2022-37298", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/naparuba/shinken/commit/2dae40fd1e713aec9e1966a0ab7a580b9180cff2", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/naparuba/shinken/commit/2dae40fd1e713aec9e1966a0ab7a580b9180cff2"}}