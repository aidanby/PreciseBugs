{"buggy_code": ["<?php\nheader('Content-type: text/javascript');\n\n?>\n\n/*------------------------------------------------------------------------------\n * End redefinition of window.alert function\n *----------------------------------------------------------------------------*/\n\nfunction fieldInfo(id){\n\talert(info[id]);\n}\n\nfunction testftp(form){\n\t\n\tpostDataReturnText('installer.php','-action=testftp&-ftphost='+escape(form.ftp_host.value)+'&-ftpuser='+escape(form.ftp_username.value)+'&-ftppass='+escape(form.ftp_password.value)+'&-ftppath='+escape(form.ftp_path.value), function(result){\n\t\tvar resultDiv = document.getElementById('ftp-test-results');\n\t\teval('var results = '+result+';');\n\t\tresultDiv.innerHTML = results.message;\n\t\t});\n\t\n\n}\n\nfunction testdb(form){\n\tpostDataReturnText('installer.php','-action=testdb&-dbname='+escape(form.database_name.options[form.database_name.selectedIndex].value)+'&-dbuser='+escape(form.mysql_user.value)+'&-dbpass='+escape(form.mysql_password.value), function(result){\n\t\tvar resultDiv = document.getElementById('db-test-results');\n\t\teval('var results = '+result+';');\n\t\tresultDiv.innerHTML = results.message;\n\t});\n}\n\n\nvar listeners = {\n\t'database_name' : {\n\t\t'onchange' : function(fld){\n\t\t\t\n\t\t\tvar option = fld.options[fld.selectedIndex].value;\n\t\t\tif ( option ){\n\t\t\t\tdocument.getElementById('step2').style.display='';\n\t\t\t} else {\n\t\t\t\tdocument.getElementById('step2').style.display='none';\n\t\t\t}\n\t\t\n\t\t}\n\t},\n\t'install_type': {\n\t\t'onchange': function(fld){\n\t\t\tvar option = fld.options[fld.selectedIndex].value;\n\t\t\tif ( option == 'ftp_install' ){\n\t\t\t\tdocument.getElementById('step4').style.display='';\n\t\t\t} else {\n\t\t\t\tdocument.getElementById('step4').style.display='none';\n\t\t\t\tdocument.getElementById('submitstep').style.display='';\n\t\t\t}\n\t\t}\n\t}\n};\n\n\t\n\n\n\t\n\t\n\t\n"], "fixing_code": ["<?php\nheader('Content-type: text/javascript');\n\n?>\n\n/*------------------------------------------------------------------------------\n * End redefinition of window.alert function\n *----------------------------------------------------------------------------*/\n\nfunction fieldInfo(id){\n\talert(info[id]);\n}\n\nfunction testftp(form){\n\t\n\tpostDataReturnText('installer.php','-action=testftp&-ftphost='+escape(form.ftp_host.value)+'&-ftpuser='+escape(form.ftp_username.value)+'&-ftppass='+escape(form.ftp_password.value)+'&-ftppath='+escape(form.ftp_path.value), function(result){\n\t\tvar resultDiv = document.getElementById('ftp-test-results');\n\t\tvar results = JSON.parse(result);\n\t\tresultDiv.innerText = results.message;\n\t\t});\n\t\n\n}\n\nfunction testdb(form){\n\tpostDataReturnText('installer.php','-action=testdb&-dbname='+escape(form.database_name.options[form.database_name.selectedIndex].value)+'&-dbuser='+escape(form.mysql_user.value)+'&-dbpass='+escape(form.mysql_password.value), function(result){\n        var results = JSON.parse(result);\n\t\tresultDiv.innerText = results.message;\n\t});\n}\n\n\nvar listeners = {\n\t'database_name' : {\n\t\t'onchange' : function(fld){\n\t\t\t\n\t\t\tvar option = fld.options[fld.selectedIndex].value;\n\t\t\tif ( option ){\n\t\t\t\tdocument.getElementById('step2').style.display='';\n\t\t\t} else {\n\t\t\t\tdocument.getElementById('step2').style.display='none';\n\t\t\t}\n\t\t\n\t\t}\n\t},\n\t'install_type': {\n\t\t'onchange': function(fld){\n\t\t\tvar option = fld.options[fld.selectedIndex].value;\n\t\t\tif ( option == 'ftp_install' ){\n\t\t\t\tdocument.getElementById('step4').style.display='';\n\t\t\t} else {\n\t\t\t\tdocument.getElementById('step4').style.display='none';\n\t\t\t\tdocument.getElementById('submitstep').style.display='';\n\t\t\t}\n\t\t}\n\t}\n};\n\n\t\n\n\n\t\n\t\n\t\n"], "filenames": ["install/install_form.js.php"], "buggy_code_start_loc": [18], "buggy_code_end_loc": [30], "fixing_code_start_loc": [18], "fixing_code_end_loc": [29], "type": "CWE-79", "message": "A vulnerability, which was classified as problematic, has been found in shannah Xataface up to 2.x. Affected by this issue is the function testftp of the file install/install_form.js.php of the component Installer. The manipulation leads to cross site scripting. The attack may be launched remotely. Upgrading to version 3.0.0 is able to address this issue. The name of the patch is 94143a4299e386f33bf582139cd4702571d93bde. It is recommended to upgrade the affected component. VDB-217442 is the identifier assigned to this vulnerability. NOTE: Installer is disabled by default.", "other": {"cve": {"id": "CVE-2021-4303", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-05T09:15:08.647", "lastModified": "2023-01-11T17:06:39.900", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability, which was classified as problematic, has been found in shannah Xataface up to 2.x. Affected by this issue is the function testftp of the file install/install_form.js.php of the component Installer. The manipulation leads to cross site scripting. The attack may be launched remotely. Upgrading to version 3.0.0 is able to address this issue. The name of the patch is 94143a4299e386f33bf582139cd4702571d93bde. It is recommended to upgrade the affected component. VDB-217442 is the identifier assigned to this vulnerability. NOTE: Installer is disabled by default."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 2.0, "baseSeverity": "LOW"}, "exploitabilityScore": 0.5, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:H/Au:M/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "HIGH", "authentication": "MULTIPLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 1.7}, "baseSeverity": "LOW", "exploitabilityScore": 3.2, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xataface_project:xataface:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.0.0", "matchCriteriaId": "8FDDAE35-CCE9-495D-BF9E-AEF85E89B89F"}]}]}], "references": [{"url": "https://github.com/shannah/xataface/commit/94143a4299e386f33bf582139cd4702571d93bde", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/shannah/xataface/releases/tag/3.0.0", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.217442", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.217442", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/shannah/xataface/commit/94143a4299e386f33bf582139cd4702571d93bde"}}