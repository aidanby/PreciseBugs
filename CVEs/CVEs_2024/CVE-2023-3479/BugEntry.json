{"buggy_code": ["<div x-data=\"{ open: false }\" class=\"debug-panel\">\n\t<button\n\t\ttype=\"button\"\n\t\tclass=\"debug-panel-toggle\"\n\t\tx-on:click=\"open = !open\"\n\t\tx-text=\"open ? '<?= _(\"Close debug panel\") ?>' : '<?= _(\"Open debug panel\") ?>'\">\n\t\t<?= _(\"Open debug panel\") ?>\n\t</button>\n\t<div x-cloak x-show=\"open\" class=\"debug-panel-content animate__animated animate__fadeIn\">\n\t\t<?php\n\t\t\techo \"<h3 class=\\\"u-mb10\\\">Server Variables</h3>\";\n\t\t\tforeach ($_SERVER as $key => $val) {\n\t\t\t\techo \"<b>\" . $key . \"= </b> \" . $val . \" \";\n\t\t\t}\n  \t?>\n\t\t<?php\n\t\t\techo \"<h3 class=\\\"u-mb10 u-mt10\\\">Session Variables</h3>\";\n\t\t\tforeach ($_SESSION as $key => $val) {\n\t\t\t\techo \"<b>\" . $key . \"= </b> \" . $val . \" \";\n\t\t\t}\n  \t?>\n\t\t<?php\n\t\t\techo \"<h3 class=\\\"u-mb10 u-mt10\\\">POST Variables</h3>\";\n\t\t\tforeach ($_POST as $key => $val) {\n\t\t\t\techo \"<b>\" . $key . \"= </b> \" . $val . \" \";\n\t\t\t}\n  \t?>\n\t\t<?php\n\t\t\techo \"<h3 class=\\\"u-mb10 u-mt10\\\">GET Variables</h3>\";\n\t\t\tforeach ($_GET as $key => $val) {\n\t\t\t\techo \"<b>\" . $key . \"= </b> \" . $val . \" \";\n\t\t\t}\n  \t?>\n\t</div>\n</div>\n"], "fixing_code": ["<?php\nif( !defined(\"HESTIA_DIR_BIN\") ){\n\tdie(\"Direct access disabled\");\n}\n?>\n\n<div x-data=\"{ open: false }\" class=\"debug-panel\">\n\t<button\n\t\ttype=\"button\"\n\t\tclass=\"debug-panel-toggle\"\n\t\tx-on:click=\"open = !open\"\n\t\tx-text=\"open ? '<?= _(\"Close debug panel\") ?>' : '<?= _(\"Open debug panel\") ?>'\">\n\t\t<?= _(\"Open debug panel\") ?>\n\t</button>\n\t<div x-cloak x-show=\"open\" class=\"debug-panel-content animate__animated animate__fadeIn\">\n\t\t<?php\n\t\t\techo \"<h3 class=\\\"u-mb10\\\">Server Variables</h3>\";\n\t\t\tforeach ($_SERVER as $key => $val) {\n\t\t\t\techo \"<span class=\\\"u-text-bold\\\">\" . htmlentities($key) . \"= </span> \" . htmlentities($val) . \" \";\n\t\t\t}\n\t\t?>\n\t\t<?php\n\t\t\techo \"<h3 class=\\\"u-mb10 u-mt10\\\">Session Variables</h3>\";\n\t\t\tforeach ($_SESSION as $key => $val) {\n\t\t\t\techo \"<span class=\\\"u-text-bold\\\">\" . htmlentities($key) . \"= </span> \" . htmlentities($val) . \" \";\n\t\t\t}\n\t\t?>\n\t\t<?php\n\t\t\techo \"<h3 class=\\\"u-mb10 u-mt10\\\">POST Variables</h3>\";\n\t\t\tforeach ($_POST as $key => $val) {\n\t\t\t\techo \"<span class=\\\"u-text-bold\\\">\" . htmlentities($key) . \"= </span> \" . htmlentities($val) . \" \";\n\t\t\t}\n\t\t?>\n\t\t<?php\n\t\t\techo \"<h3 class=\\\"u-mb10 u-mt10\\\">GET Variables</h3>\";\n\t\t\tforeach ($_GET as $key => $val) {\n\t\t\t\techo \"<span class=\\\"u-text-bold\\\">\" . htmlentities($key) . \"= </span> \" . htmlentities($val) . \" \";\n\t\t\t}\n\t\t?>\n\t</div>\n</div>\n"], "filenames": ["web/templates/pages/debug_panel.php"], "buggy_code_start_loc": [0], "buggy_code_end_loc": [34], "fixing_code_start_loc": [1], "fixing_code_end_loc": [40], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Reflected in GitHub repository hestiacp/hestiacp prior to 1.7.8.", "other": {"cve": {"id": "CVE-2023-3479", "sourceIdentifier": "security@huntr.dev", "published": "2023-06-30T10:15:09.567", "lastModified": "2023-07-06T18:50:34.680", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Reflected in GitHub repository hestiacp/hestiacp prior to 1.7.8."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hestiacp:control_panel:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.7.8", "matchCriteriaId": "39AAED7C-8F09-4567-BF50-150F255627C3"}]}]}], "references": [{"url": "https://github.com/hestiacp/hestiacp/commit/2326aa525a7ba14513af783f29cb5e62a476e67a", "source": "security@huntr.dev", "tags": ["Patch"]}, {"url": "https://huntr.dev/bounties/6ac5cf87-6350-4645-8930-8f2876427723", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/hestiacp/hestiacp/commit/2326aa525a7ba14513af783f29cb5e62a476e67a"}}