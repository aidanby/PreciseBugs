{"buggy_code": ["<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!--\n\nBigBlueButton open source conferencing system - http://www.bigbluebutton.org/\n\nCopyright (c) 2012 BigBlueButton Inc. and by respective authors (see below).\n\nThis program is free software; you can redistribute it and/or modify it under the\nterms of the GNU Lesser General Public License as published by the Free Software\nFoundation; either version 3.0 of the License, or (at your option) any later\nversion.\n\nBigBlueButton is distributed in the hope that it will be useful, but WITHOUT ANY\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A\nPARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.\n\nYou should have received a copy of the GNU Lesser General Public License along\nwith BigBlueButton; if not, see <http://www.gnu.org/licenses/>.\n\n-->\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n            http://www.springframework.org/schema/beans/spring-beans-2.5.xsd\n            \">\n\n    <bean id=\"stun1\" class=\"org.bigbluebutton.web.services.turn.StunServer\">\n        <constructor-arg index=\"0\" value=\"stun:stun.freeswitch.org\"/>\n    </bean>\n\n    <!--bean id=\"stun2\" class=\"org.bigbluebutton.web.services.turn.StunServer\">\n        <constructor-arg index=\"0\" value=\"stun:stun2.example.com\"/>\n    </bean-->\n\n    <!--bean id=\"iceCandidate1\" class=\"org.bigbluebutton.web.services.turn.RemoteIceCandidate\">\n        <constructor-arg index=\"0\" value=\"192.168.0.1\"/>\n    </bean-->\n\n    <!-- Turn servers are configured with a secret that's compatible with\n         http://tools.ietf.org/html/draft-uberti-behave-turn-rest-00\n         as supported by the coturn and rfc5766-turn-server turn servers -->\n\n    <!--bean id=\"turn1\" class=\"org.bigbluebutton.web.services.turn.TurnServer\">\n        Secret:\n        <constructor-arg index=\"0\" value=\"secret\"/>\n        TURN server URL, use turn: or turns:\n        <constructor-arg index=\"1\" value=\"turn:turn1.example.com\"/>\n        TTL in seconds for shared secret\n        <constructor-arg index=\"2\" value=\"86400\"/>\n    </bean-->\n\n    <!--bean id=\"turn2\" class=\"org.bigbluebutton.web.services.turn.TurnServer\">\n        <constructor-arg index=\"0\" value=\"secret\"/>\n        <constructor-arg index=\"1\" value=\"turns:turn2.example.com:443\"/>\n        <constructor-arg index=\"2\" value=\"86400\"/>\n    </bean-->\n\n    <bean id=\"stunTurnService\" class=\"org.bigbluebutton.web.services.turn.StunTurnService\">\n        <property name=\"stunServers\">\n            <set>\n                <ref bean=\"stun1\" />\n                <!--ref bean=\"stun2\" /-->\n            </set>\n        </property>\n        <property name=\"turnServers\">\n            <set>\n                <!--ref bean=\"turn1\" /-->\n                <!--ref bean=\"turn2\" /-->\n            </set>\n        </property>\n        <property name=\"remoteIceCandidates\">\n            <set>\n                <!--ref bean=\"iceCandidate1\" /-->\n                <!--ref bean=\"iceCandidate2\" /-->\n            </set>\n        </property>\n    </bean>\n</beans>\n"], "fixing_code": ["<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!--\n\nBigBlueButton open source conferencing system - http://www.bigbluebutton.org/\n\nCopyright (c) 2012 BigBlueButton Inc. and by respective authors (see below).\n\nThis program is free software; you can redistribute it and/or modify it under the\nterms of the GNU Lesser General Public License as published by the Free Software\nFoundation; either version 3.0 of the License, or (at your option) any later\nversion.\n\nBigBlueButton is distributed in the hope that it will be useful, but WITHOUT ANY\nWARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A\nPARTICULAR PURPOSE. See the GNU Lesser General Public License for more details.\n\nYou should have received a copy of the GNU Lesser General Public License along\nwith BigBlueButton; if not, see <http://www.gnu.org/licenses/>.\n\n-->\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n            http://www.springframework.org/schema/beans/spring-beans-2.5.xsd\n            \">\n\n    <bean id=\"stun1\" class=\"org.bigbluebutton.web.services.turn.StunServer\">\n        <constructor-arg index=\"0\" value=\"stun:stun.l.google.com:19302\"/>\n    </bean>\n\n    <!--bean id=\"stun2\" class=\"org.bigbluebutton.web.services.turn.StunServer\">\n        <constructor-arg index=\"0\" value=\"stun:stun2.example.com\"/>\n    </bean-->\n\n    <!--bean id=\"iceCandidate1\" class=\"org.bigbluebutton.web.services.turn.RemoteIceCandidate\">\n        <constructor-arg index=\"0\" value=\"192.168.0.1\"/>\n    </bean-->\n\n    <!-- Turn servers are configured with a secret that's compatible with\n         http://tools.ietf.org/html/draft-uberti-behave-turn-rest-00\n         as supported by the coturn and rfc5766-turn-server turn servers -->\n\n    <!--bean id=\"turn1\" class=\"org.bigbluebutton.web.services.turn.TurnServer\">\n        Secret:\n        <constructor-arg index=\"0\" value=\"secret\"/>\n        TURN server URL, use turn: or turns:\n        <constructor-arg index=\"1\" value=\"turn:turn1.example.com\"/>\n        TTL in seconds for shared secret\n        <constructor-arg index=\"2\" value=\"86400\"/>\n    </bean-->\n\n    <!--bean id=\"turn2\" class=\"org.bigbluebutton.web.services.turn.TurnServer\">\n        <constructor-arg index=\"0\" value=\"secret\"/>\n        <constructor-arg index=\"1\" value=\"turns:turn2.example.com:443\"/>\n        <constructor-arg index=\"2\" value=\"86400\"/>\n    </bean-->\n\n    <bean id=\"stunTurnService\" class=\"org.bigbluebutton.web.services.turn.StunTurnService\">\n        <property name=\"stunServers\">\n            <set>\n                <ref bean=\"stun1\" />\n                <!--ref bean=\"stun2\" /-->\n            </set>\n        </property>\n        <property name=\"turnServers\">\n            <set>\n                <!--ref bean=\"turn1\" /-->\n                <!--ref bean=\"turn2\" /-->\n            </set>\n        </property>\n        <property name=\"remoteIceCandidates\">\n            <set>\n                <!--ref bean=\"iceCandidate1\" /-->\n                <!--ref bean=\"iceCandidate2\" /-->\n            </set>\n        </property>\n    </bean>\n</beans>\n"], "filenames": ["bigbluebutton-web/grails-app/conf/spring/turn-stun-servers.xml"], "buggy_code_start_loc": [28], "buggy_code_end_loc": [29], "fixing_code_start_loc": [28], "fixing_code_end_loc": [29], "type": "CWE-327", "message": "BigBlueButton through 2.2.28 uses STUN/TURN resources from a third party, which may represent an unintended endpoint.", "other": {"cve": {"id": "CVE-2020-27611", "sourceIdentifier": "cve@mitre.org", "published": "2020-10-21T15:15:27.437", "lastModified": "2022-06-15T03:16:45.837", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "BigBlueButton through 2.2.28 uses STUN/TURN resources from a third party, which may represent an unintended endpoint."}, {"lang": "es", "value": "BigBlueButton versiones hasta 2.2.8, utiliza recursos STUN/TURN de un tercero, que pueden representar un endpoint no previsto"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 7.3, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 7.5}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-327"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:bigbluebutton:bigbluebutton:*:*:*:*:*:*:*:*", "versionEndIncluding": "2.2.28", "matchCriteriaId": "DFDA0178-046A-4806-9AA6-5A7DF87FB382"}]}]}], "references": [{"url": "https://docs.bigbluebutton.org/admin/privacy.html", "source": "cve@mitre.org", "tags": ["Not Applicable"]}, {"url": "https://github.com/bigbluebutton/bigbluebutton/commit/d0bc77c3dbd858295004f15d7a57ec35e6b203d6", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/bigbluebutton/bigbluebutton/commit/d0bc77c3dbd858295004f15d7a57ec35e6b203d6"}}