{"buggy_code": ["/*\n*         OpenPBS (Portable Batch System) v2.3 Software License\n*\n* Copyright (c) 1999-2000 Veridian Information Solutions, Inc.\n* All rights reserved.\n*\n* ---------------------------------------------------------------------------\n* For a license to use or redistribute the OpenPBS software under conditions\n* other than those described below, or to purchase support for this software,\n* please contact Veridian Systems, PBS Products Department (\"Licensor\") at:\n*\n*    www.OpenPBS.org  +1 650 967-4675                  sales@OpenPBS.org\n*                        877 902-4PBS (US toll-free)\n* ---------------------------------------------------------------------------\n*\n* This license covers use of the OpenPBS v2.3 software (the \"Software\") at\n* your site or location, and, for certain users, redistribution of the\n* Software to other sites and locations.  Use and redistribution of\n* OpenPBS v2.3 in source and binary forms, with or without modification,\n* are permitted provided that all of the following conditions are met.\n* After December 31, 2001, only conditions 3-6 must be met:\n*\n* 1. Commercial and/or non-commercial use of the Software is permitted\n*    provided a current software registration is on file at www.OpenPBS.org.\n*    If use of this software contributes to a publication, product, or\n*    service, proper attribution must be given; see www.OpenPBS.org/credit.html\n*\n* 2. Redistribution in any form is only permitted for non-commercial,\n*    non-profit purposes.  There can be no charge for the Software or any\n*    software incorporating the Software.  Further, there can be no\n*    expectation of revenue generated as a consequence of redistributing\n*    the Software.\n*\n* 3. Any Redistribution of source code must retain the above copyright notice\n*    and the acknowledgment contained in paragraph 6, this list of conditions\n*    and the disclaimer contained in paragraph 7.\n*\n* 4. Any Redistribution in binary form must reproduce the above copyright\n*    notice and the acknowledgment contained in paragraph 6, this list of\n*    conditions and the disclaimer contained in paragraph 7 in the\n*    documentation and/or other materials provided with the distribution.\n*\n* 5. Redistributions in any form must be accompanied by information on how to\n*    obtain complete source code for the OpenPBS software and any\n*    modifications and/or additions to the OpenPBS software.  The source code\n*    must either be included in the distribution or be available for no more\n*    than the cost of distribution plus a nominal fee, and all modifications\n*    and additions to the Software must be freely redistributable by any party\n*    (including Licensor) without restriction.\n*\n* 6. All advertising materials mentioning features or use of the Software must\n*    display the following acknowledgment:\n*\n*     \"This product includes software developed by NASA Ames Research Center,\n*     Lawrence Livermore National Laboratory, and Veridian Information\n*     Solutions, Inc.\n*     Visit www.OpenPBS.org for OpenPBS software support,\n*     products, and information.\"\n*\n* 7. DISCLAIMER OF WARRANTY\n*\n* THIS SOFTWARE IS PROVIDED \"AS IS\" WITHOUT WARRANTY OF ANY KIND. ANY EXPRESS\n* OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT\n* ARE EXPRESSLY DISCLAIMED.\n*\n* IN NO EVENT SHALL VERIDIAN CORPORATION, ITS AFFILIATED COMPANIES, OR THE\n* U.S. GOVERNMENT OR ANY OF ITS AGENCIES BE LIABLE FOR ANY DIRECT OR INDIRECT,\n* INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n* LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,\n* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n* LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n* EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*\n* This license will be governed by the laws of the Commonwealth of Virginia,\n* without reference to its choice of law rules.\n*/\n#include <pbs_config.h>   /* the master config generated by configure */\n\n#include <assert.h>\n#include <stddef.h>\n\n#include \"dis.h\"\n#include \"dis_.h\"\n\n\n\n\nint disrsi_(\n\n  int       stream,\n  int      *negate,\n  unsigned *value,\n  unsigned  count)\n\n  {\n  int  c;\n  unsigned locval;\n  unsigned ndigs;\n  char  *cp;\n  char  scratch[DIS_BUFSIZ+1];\n\n  assert(negate != NULL);\n  assert(value != NULL);\n  assert(count);\n  assert(stream >= 0);\n  assert(dis_getc != NULL);\n  assert(dis_gets != NULL);\n\n  memset(scratch, 0, DIS_BUFSIZ+1);\n  if (dis_umaxd == 0)\n    disiui_();\n\n  switch (c = (*dis_getc)(stream))\n    {\n\n    case '-':\n\n    case '+':\n\n      *negate = c == '-';\n\n      if ((*dis_gets)(stream, scratch, count) != (int)count)\n        {\n        return(DIS_EOD);\n        }\n\n      if (count >= dis_umaxd)\n        {\n        if (count > dis_umaxd)\n          goto overflow;\n\n        if (memcmp(scratch, dis_umax, dis_umaxd) > 0)\n          goto overflow;\n        }\n\n      cp = scratch;\n\n      locval = 0;\n\n      do\n        {\n        if (((c = *cp++) < '0') || (c > '9'))\n          {\n          return(DIS_NONDIGIT);\n          }\n\n        locval = 10 * locval + c - '0';\n        }\n      while (--count);\n\n      *value = locval;\n\n      return (DIS_SUCCESS);\n\n      break;\n\n    case '0':\n\n      return (DIS_LEADZRO);\n\n      break;\n\n    case '1':\n\n    case '2':\n\n    case '3':\n\n    case '4':\n\n    case '5':\n\n    case '6':\n\n    case '7':\n\n    case '8':\n\n    case '9':\n\n      ndigs = c - '0';\n\n      if (count > 1)\n        {\n        if ((*dis_gets)(stream, scratch + 1, count - 1) != (int)count - 1)\n          {\n          return(DIS_EOD);\n          }\n\n        cp = scratch;\n\n        if (count >= dis_umaxd)\n          {\n          if (count > dis_umaxd)\n            break;\n\n          *cp = c;\n\n          if (memcmp(scratch, dis_umax, dis_umaxd) > 0)\n            break;\n          }\n\n        while (--count)\n          {\n          if (((c = *++cp) < '0') || (c > '9'))\n            {\n            return(DIS_NONDIGIT);\n            }\n\n          ndigs = 10 * ndigs + c - '0';\n          }\n        }    /* END if (count > 1) */\n\n      return(disrsi_(stream, negate, value, ndigs));\n\n      /*NOTREACHED*/\n\n      break;\n\n    case - 1:\n\n      return(DIS_EOD);\n\n      /*NOTREACHED*/\n\n      break;\n\n    case -2:\n\n      return(DIS_EOF);\n\n      /*NOTREACHED*/\n\n      break;\n\n    default:\n\n      return(DIS_NONDIGIT);\n\n      /*NOTREACHED*/\n\n      break;\n    }\n\n  *negate = FALSE;\n\noverflow:\n\n  *value = UINT_MAX;\n\n  return(DIS_OVERFLOW);\n  }  /* END disrsi_() */\n\n\n\n\n"], "fixing_code": ["/*\n*         OpenPBS (Portable Batch System) v2.3 Software License\n*\n* Copyright (c) 1999-2000 Veridian Information Solutions, Inc.\n* All rights reserved.\n*\n* ---------------------------------------------------------------------------\n* For a license to use or redistribute the OpenPBS software under conditions\n* other than those described below, or to purchase support for this software,\n* please contact Veridian Systems, PBS Products Department (\"Licensor\") at:\n*\n*    www.OpenPBS.org  +1 650 967-4675                  sales@OpenPBS.org\n*                        877 902-4PBS (US toll-free)\n* ---------------------------------------------------------------------------\n*\n* This license covers use of the OpenPBS v2.3 software (the \"Software\") at\n* your site or location, and, for certain users, redistribution of the\n* Software to other sites and locations.  Use and redistribution of\n* OpenPBS v2.3 in source and binary forms, with or without modification,\n* are permitted provided that all of the following conditions are met.\n* After December 31, 2001, only conditions 3-6 must be met:\n*\n* 1. Commercial and/or non-commercial use of the Software is permitted\n*    provided a current software registration is on file at www.OpenPBS.org.\n*    If use of this software contributes to a publication, product, or\n*    service, proper attribution must be given; see www.OpenPBS.org/credit.html\n*\n* 2. Redistribution in any form is only permitted for non-commercial,\n*    non-profit purposes.  There can be no charge for the Software or any\n*    software incorporating the Software.  Further, there can be no\n*    expectation of revenue generated as a consequence of redistributing\n*    the Software.\n*\n* 3. Any Redistribution of source code must retain the above copyright notice\n*    and the acknowledgment contained in paragraph 6, this list of conditions\n*    and the disclaimer contained in paragraph 7.\n*\n* 4. Any Redistribution in binary form must reproduce the above copyright\n*    notice and the acknowledgment contained in paragraph 6, this list of\n*    conditions and the disclaimer contained in paragraph 7 in the\n*    documentation and/or other materials provided with the distribution.\n*\n* 5. Redistributions in any form must be accompanied by information on how to\n*    obtain complete source code for the OpenPBS software and any\n*    modifications and/or additions to the OpenPBS software.  The source code\n*    must either be included in the distribution or be available for no more\n*    than the cost of distribution plus a nominal fee, and all modifications\n*    and additions to the Software must be freely redistributable by any party\n*    (including Licensor) without restriction.\n*\n* 6. All advertising materials mentioning features or use of the Software must\n*    display the following acknowledgment:\n*\n*     \"This product includes software developed by NASA Ames Research Center,\n*     Lawrence Livermore National Laboratory, and Veridian Information\n*     Solutions, Inc.\n*     Visit www.OpenPBS.org for OpenPBS software support,\n*     products, and information.\"\n*\n* 7. DISCLAIMER OF WARRANTY\n*\n* THIS SOFTWARE IS PROVIDED \"AS IS\" WITHOUT WARRANTY OF ANY KIND. ANY EXPRESS\n* OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE, AND NON-INFRINGEMENT\n* ARE EXPRESSLY DISCLAIMED.\n*\n* IN NO EVENT SHALL VERIDIAN CORPORATION, ITS AFFILIATED COMPANIES, OR THE\n* U.S. GOVERNMENT OR ANY OF ITS AGENCIES BE LIABLE FOR ANY DIRECT OR INDIRECT,\n* INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n* LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,\n* OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n* LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING\n* NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,\n* EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*\n* This license will be governed by the laws of the Commonwealth of Virginia,\n* without reference to its choice of law rules.\n*/\n#include <pbs_config.h>   /* the master config generated by configure */\n\n#include <assert.h>\n#include <stddef.h>\n\n#include \"dis.h\"\n#include \"dis_.h\"\n\n\n\n\nint disrsi_(\n\n  int       stream,\n  int      *negate,\n  unsigned *value,\n  unsigned  count)\n\n  {\n  int  c;\n  unsigned locval;\n  unsigned ndigs;\n  char  *cp;\n  char  scratch[DIS_BUFSIZ+1];\n\n  assert(negate != NULL);\n  assert(value != NULL);\n  assert(count);\n  assert(stream >= 0);\n  assert(dis_getc != NULL);\n  assert(dis_gets != NULL);\n\n  memset(scratch, 0, DIS_BUFSIZ+1);\n  if (dis_umaxd == 0)\n    disiui_();\n\n  if (count >= dis_umaxd)\n    {\n    if (count > dis_umaxd)\n      goto overflow;\n\n    if (memcmp(scratch, dis_umax, dis_umaxd) > 0)\n      goto overflow;\n    }\n\n  switch (c = (*dis_getc)(stream))\n    {\n\n    case '-':\n\n    case '+':\n\n      *negate = c == '-';\n\n      if ((*dis_gets)(stream, scratch, count) != (int)count)\n        {\n        return(DIS_EOD);\n        }\n\n      if (count >= dis_umaxd)\n        {\n        if (count > dis_umaxd)\n          goto overflow;\n\n        if (memcmp(scratch, dis_umax, dis_umaxd) > 0)\n          goto overflow;\n        }\n\n      cp = scratch;\n\n      locval = 0;\n\n      do\n        {\n        if (((c = *cp++) < '0') || (c > '9'))\n          {\n          return(DIS_NONDIGIT);\n          }\n\n        locval = 10 * locval + c - '0';\n        }\n      while (--count);\n\n      *value = locval;\n\n      return (DIS_SUCCESS);\n\n      break;\n\n    case '0':\n\n      return (DIS_LEADZRO);\n\n      break;\n\n    case '1':\n\n    case '2':\n\n    case '3':\n\n    case '4':\n\n    case '5':\n\n    case '6':\n\n    case '7':\n\n    case '8':\n\n    case '9':\n\n      ndigs = c - '0';\n\n      if (count > 1)\n        {\n        if ((*dis_gets)(stream, scratch + 1, count - 1) != (int)count - 1)\n          {\n          return(DIS_EOD);\n          }\n\n        cp = scratch;\n\n        if (count >= dis_umaxd)\n          {\n          if (count > dis_umaxd)\n            break;\n\n          *cp = c;\n\n          if (memcmp(scratch, dis_umax, dis_umaxd) > 0)\n            break;\n          }\n\n        while (--count)\n          {\n          if (((c = *++cp) < '0') || (c > '9'))\n            {\n            return(DIS_NONDIGIT);\n            }\n\n          ndigs = 10 * ndigs + c - '0';\n          }\n        }    /* END if (count > 1) */\n\n      return(disrsi_(stream, negate, value, ndigs));\n\n      /*NOTREACHED*/\n\n      break;\n\n    case - 1:\n\n      return(DIS_EOD);\n\n      /*NOTREACHED*/\n\n      break;\n\n    case -2:\n\n      return(DIS_EOF);\n\n      /*NOTREACHED*/\n\n      break;\n\n    default:\n\n      return(DIS_NONDIGIT);\n\n      /*NOTREACHED*/\n\n      break;\n    }\n\n  *negate = FALSE;\n\noverflow:\n\n  *value = UINT_MAX;\n\n  return(DIS_OVERFLOW);\n  }  /* END disrsi_() */\n\n\n\n\n"], "filenames": ["src/lib/Libdis/disrsi_.c"], "buggy_code_start_loc": [114], "buggy_code_end_loc": [114], "fixing_code_start_loc": [115], "fixing_code_end_loc": [124], "type": "CWE-119", "message": "Stack-based buffer overflow in lib/Libdis/disrsi_.c in Terascale Open-Source Resource and Queue Manager (aka TORQUE Resource Manager) 2.5.x through 2.5.13 allows remote attackers to execute arbitrary code via a large count value.", "other": {"cve": {"id": "CVE-2014-0749", "sourceIdentifier": "cve@mitre.org", "published": "2014-05-16T14:55:05.547", "lastModified": "2018-10-09T19:42:05.327", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "Stack-based buffer overflow in lib/Libdis/disrsi_.c in Terascale Open-Source Resource and Queue Manager (aka TORQUE Resource Manager) 2.5.x through 2.5.13 allows remote attackers to execute arbitrary code via a large count value."}, {"lang": "es", "value": "Desbordamiento de buffer basado en pila en lib/Libdis/disrsi_.c en Terascale Open-Source Resource And Queue Manager (tambi\u00e9n conocido como TORQUE Resource Manager) 2.5.x hasta 2.5.13 permite a atacantes remotos ejecutar c\u00f3digo arbitrario a trav\u00e9s de un valor de contador grande."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "COMPLETE", "integrityImpact": "COMPLETE", "availabilityImpact": "COMPLETE", "baseScore": 10.0}, "baseSeverity": "HIGH", "exploitabilityScore": 10.0, "impactScore": 10.0, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-119"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.0:*:*:*:*:*:*:*", "matchCriteriaId": "682462F9-38E2-4631-8AE2-4ACC2BFDA336"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.1:*:*:*:*:*:*:*", "matchCriteriaId": "F484AC97-0A7C-42D7-8A8A-3F0EE951A7E1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.2:*:*:*:*:*:*:*", "matchCriteriaId": "F929EC66-9E7B-4D8D-AA36-DAE4DF96C01F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.3:*:*:*:*:*:*:*", "matchCriteriaId": "40E5D70B-0965-4794-BD25-42F7C189AD0B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.4:*:*:*:*:*:*:*", "matchCriteriaId": "E3287BE3-DF6B-4C81-9065-50BF91B37664"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.5:*:*:*:*:*:*:*", "matchCriteriaId": "78083338-09F7-4C94-AF55-4998640A5ABE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.6:*:*:*:*:*:*:*", "matchCriteriaId": "A7010B77-6FD0-4A51-81BA-19DA1F2D4881"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.7:*:*:*:*:*:*:*", "matchCriteriaId": "4CA855F9-CAA9-4B65-AAEE-5AA36F8F9538"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.8:*:*:*:*:*:*:*", "matchCriteriaId": "CCBEBC0F-4AE4-4D94-B1E5-503FE2039D43"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.9:*:*:*:*:*:*:*", "matchCriteriaId": "1C896A54-9557-4B24-8542-98C025D34B07"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.10:*:*:*:*:*:*:*", "matchCriteriaId": "257109FC-7E26-4EBB-9059-58D418EA4A6D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.11:*:*:*:*:*:*:*", "matchCriteriaId": "956F57CD-314F-41DC-B76D-CC847C3F12DA"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.12:*:*:*:*:*:*:*", "matchCriteriaId": "CE18F486-1C07-4388-B8E6-A942143A18FC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:adaptivecomputing:torque_resource_manager:2.5.13:*:*:*:*:*:*:*", "matchCriteriaId": "E157EA4C-051A-4195-886B-016BC1616A46"}]}]}], "references": [{"url": "http://packetstormsecurity.com/files/126651/Torque-2.5.13-Buffer-Overflow.html", "source": "cve@mitre.org"}, {"url": "http://packetstormsecurity.com/files/126855/TORQUE-Resource-Manager-2.5.13-Buffer-Overflow.html", "source": "cve@mitre.org"}, {"url": "http://www.debian.org/security/2014/dsa-2936", "source": "cve@mitre.org"}, {"url": "http://www.exploit-db.com/exploits/33554", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/archive/1/532110/100/0/threaded", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/67420", "source": "cve@mitre.org", "tags": ["Exploit"]}, {"url": "https://github.com/adaptivecomputing/torque/commit/3ed749263abe3d69fa3626d142a5789dcb5a5684", "source": "cve@mitre.org", "tags": ["Patch"]}, {"url": "https://github.com/adaptivecomputing/torque/pull/171", "source": "cve@mitre.org"}, {"url": "https://labs.mwrinfosecurity.com/advisories/2014/05/14/torque-buffer-overflow", "source": "cve@mitre.org"}, {"url": "https://labs.mwrinfosecurity.com/system/assets/662/original/torque-buffer-overflow_2014-05-14.pdf", "source": "cve@mitre.org", "tags": ["Exploit"]}]}, "github_commit_url": "https://github.com/adaptivecomputing/torque/commit/3ed749263abe3d69fa3626d142a5789dcb5a5684"}}