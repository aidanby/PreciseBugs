{"buggy_code": ["# v1.6.23\n## mm/dd/2020\n\n1. [](#new)\n    * Moved `Parsedown` 1.6 and `ParsedownExtra` 0.7 into `Grav\\Framework\\Parsedown` to allow fixes\n1. [](#bugfix)\n    * Fixed PHP 7.4 issue in ParsedownExtra [#2832](https://github.com/getgrav/grav/issues/2832)\n\n# v1.6.22\n## 03/05/2020\n\n1. [](#new)\n    * Added `Pages::reset()` method\n1. [](#improved)\n    * Updated Negotiation library to address issues [#2513](https://github.com/getgrav/grav/issues/2513)\n1. [](#bugfix)\n    * Fixed issue with search plugins not being able to switch between page translations\n    * Fixed issues with `Pages::baseRoute()` not picking up active language reliably\n    * Reverted `validation: strict` fix as it breaks sites, see [#1273](https://github.com/getgrav/grav/issues/1273)\n\n# v1.6.21\n## 02/11/2020\n\n1. [](#new)\n    * Added `ConsoleCommand::setLanguage()` method to set language to be used from CLI\n    * Added `ConsoleCommand::initializeGrav()` method to properly set up Grav instance to be used from CLI\n    * Added `ConsoleCommand::initializePlugins()`method to properly set up all plugins to be used from CLI\n    * Added `ConsoleCommand::initializeThemes()`method to properly set up current theme to be used from CLI\n    * Added `ConsoleCommand::initializePages()` method to properly set up pages to be used from CLI\n1. [](#improved)\n    * Vendor updates\n1. [](#bugfix)\n    * Fixed `bin/plugin` CLI calling `$themes->init()` way too early (removed it, use above methods instead)\n    * Fixed call to `$grav['page']` crashing CLI\n    * Fixed encoding problems when PHP INI setting `default_charset` is not `utf-8` [#2154](https://github.com/getgrav/grav/issues/2154)\n\n# v1.6.20\n## 02/03/2020\n\n1. [](#bugfix)\n    * Fixed incorrect routing caused by `str_replace()` in `Uri::init()` [#2754](https://github.com/getgrav/grav/issues/2754)\n    * Fixed session cookie is being set twice in the HTTP header [#2745](https://github.com/getgrav/grav/issues/2745)\n    * Fixed session not restarting if user was invalid (downgrading from Grav 1.7)\n    * Fixed filesystem iterator calls with non-existing folders\n    * Fixed `checkbox` field not being saved, requires also Form v4.0.2 [#1225](https://github.com/getgrav/grav/issues/1225)\n    * Fixed `validation: strict` not working in blueprints [#1273](https://github.com/getgrav/grav/issues/1273)\n    * Fixed `Data::filter()` removing empty fields (such as empty list) by default [#2805](https://github.com/getgrav/grav/issues/2805)\n    * Fixed fatal error with non-integer page param value [#2803](https://github.com/getgrav/grav/issues/2803)\n    * Fixed `Assets::addInlineJs()` parameter type mismatch between v1.5 and v1.6 [#2659](https://github.com/getgrav/grav/issues/2659)\n    * Fixed `site.metadata` saving issues [#2615](https://github.com/getgrav/grav/issues/2615)\n\n# v1.6.19\n## 12/04/2019\n\n1. [](#new)\n    * Catch PHP 7.4 deprecation messages and report them in debugbar instead of throwing fatal error\n1. [](#bugfix)\n    * Fixed fatal error when calling `{{ grav.undefined }}`\n    * Fixed multiple issues when there are no pages in the site\n    * PHP 7.4 fix for [#2750](https://github.com/getgrav/grav/issues/2750)\n\n# v1.6.18\n## 12/02/2019\n\n1. [](#bugfix)\n    * PHP 7.4 fix in `Pages::buildSort()`\n    * Updated vendor libraries for PHP 7.4 fixes in Twig and other libraries\n    * Fixed fatal error when `$page->id()` is null [#2731](https://github.com/getgrav/grav/pull/2731)\n    * Fixed cache conflicts on pages with no set id\n    * Fix rewrite rule for for `lighttpd` default config [#721](https://github.com/getgrav/grav/pull/2721)\n\n# v1.6.17\n## 11/06/2019\n\n1. [](#new)\n    * Added working ETag (304 Not Modified) support based on the final rendered HTML\n1. [](#improved)\n    * Safer file handling + customizable null char replacement in `CsvFormatter::decode()`\n    * Change of Behavior: `Inflector::hyphenize` will now automatically trim dashes at beginning and end of a string.\n    * Change in Behavior for `Folder::all()` so no longer fails if trying to copy non-existent dot file [#2581](https://github.com/getgrav/grav/pull/2581)\n    * renamed composer `test-plugins` script to `phpstan-plugins` to be more explicit [#2637](https://github.com/getgrav/grav/pull/2637)\n1. [](#bugfix)\n    * Fixed PHP 7.1 bug in FlexMedia\n    * Fix cache image generation when using cropResize [#2639](https://github.com/getgrav/grav/pull/2639)\n    * Fix `array_merge()` exception with non-array page header metadata [#2701](https://github.com/getgrav/grav/pull/2701)\n\n# v1.6.16\n## 09/19/2019\n\n1. [](#bugfix)\n    * Fixed Flex user creation if file storage is being used [#2444](https://github.com/getgrav/grav/issues/2444)\n    * Fixed `Badly encoded JSON data` warning when uploading files [#2663](https://github.com/getgrav/grav/issues/2663)\n\n# v1.6.15\n## 08/20/2019\n\n1. [](#improved)\n    * Improved robots.txt [#2632](https://github.com/getgrav/grav/issues/2632)\n1. [](#bugfix)\n    * Fixed broken markdown Twig tag [#2635](https://github.com/getgrav/grav/issues/2635)\n    * Force Symfony 4.2 in Grav 1.6 to remove a bunch of deprecated messages\n\n# v1.6.14\n## 08/18/2019\n\n1. [](#bugfix)\n    * Actually include fix for `system\\router.php` [#2627](https://github.com/getgrav/grav/issues/2627)\n\n# v1.6.13\n## 08/16/2019\n\n1. [](#bugfix)\n    * Regression fix for `system\\router.php` [#2627](https://github.com/getgrav/grav/issues/2627)\n\n# v1.6.12\n## 08/14/2019\n\n1. [](#new)\n    * Added support for custom `FormFlash` save locations\n    * Added a new `Utils::arrayLower()` method for lowercasing arrays\n    * Support new GRAV_BASEDIR environment variable [#2541](https://github.com/getgrav/grav/pull/2541)\n    * Allow users to override plugin handler priorities [#2165](https://github.com/getgrav/grav/pull/2165)\n1. [](#improved)\n    * Use new `Utils::getSupportedPageTypes()` to enforce `html,htm` at the front of the list [#2531](https://github.com/getgrav/grav/issues/2531)\n    * Updated vendor libraries\n    * Markdown filter is now page-aware so that it works with modular references [admin#1731](https://github.com/getgrav/grav-plugin-admin/issues/1731)\n    * Check of `GRAV_USER_INSTANCE` constant is already defined [#2621](https://github.com/getgrav/grav/pull/2621)\n1. [](#bugfix)\n    * Fixed some potential issues when `$grav['user']` is not set\n    * Fixed error when calling `Media::add($name, null)`\n    * Fixed `url()` returning wrong path if using stream with grav root path in it, eg: `user-data://shop` when Grav is in `/shop`\n    * Fixed `url()` not returning a path to non-existing file (`user-data://shop` => `/user/data/shop`) if it is set to fail gracefully\n    * Fixed `url()` returning false on unknown streams, such as `ftp://domain.com`, they should be treated as external URL\n    * Fixed Flex User to have permissions to save and delete his own user\n    * Fixed new Flex User creation not being possible because of username could not be given\n    * Fixed fatal error 'Expiration date must be an integer, a DateInterval or null, \"double\" given' [#2529](https://github.com/getgrav/grav/issues/2529)\n    * Fixed non-existing Flex object having a bad media folder\n    * Fixed collections using `page@.self:` should allow modular pages if requested\n    * Fixed an error when trying to delete a file from non-existing Flex Object\n    * Fixed `FlexObject::exists()` failing sometimes just after the object has been saved\n    * Fixed CSV formatter not encoding strings with `\"` and `,` properly\n    * Fixed var order in `Validation.php` [#2610](https://github.com/getgrav/grav/issues/2610)\n\n# v1.6.11\n## 06/21/2019\n\n1. [](#new)\n    * Added `FormTrait::getAllFlashes()` method to get all the available form flash objects for the form\n    * Added creation and update timestamps to `FormFlash` objects\n1. [](#improved)\n    * Added `FormFlashInterface`, changed constructor to take `$config` array\n1. [](#bugfix)\n    * Fixed error in `ImageMedium::url()` if the image cache folder does not exist\n    * Fixed empty form flash name after file upload or form state update\n    * Fixed a bug in `Route::withParam()` method\n    * Fixed issue with `FormFlash` objects when there is no session initialized\n\n# v1.6.10\n## 06/14/2019\n\n1. [](#improved)\n    * Added **page blueprints** to `YamlLinter` CLI and Admin reports\n    * Removed `Gitter` and `Slack` [#2502](https://github.com/getgrav/grav/issues/2502)\n    * Optimizations for Plugin/Theme loading\n    * Generalized markdown classes so they can be used outside of `Page` scope with a custom `Excerpts` class instance\n    * Change minimal port number to 0 (unix socket) [#2452](https://github.com/getgrav/grav/issues/2452)\n1. [](#bugfix)\n    * Force question to install demo content in theme update [#2493](https://github.com/getgrav/grav/issues/2493)\n    * Fixed GPM errors from blueprints not being logged [#2505](https://github.com/getgrav/grav/issues/2505)\n    * Don't error when IP is invalid [#2507](https://github.com/getgrav/grav/issues/2507)\n    * Fixed regression with `bin/plugin` not listing the plugins available (1c725c0)\n    * Fixed bitwise operator in `TwigExtension::exifFunc()` [#2518](https://github.com/getgrav/grav/issues/2518)\n    * Fixed issue with lang prefix incorrectly identifying as admin [#2511](https://github.com/getgrav/grav/issues/2511)\n    * Fixed issue with `U0ils::pathPrefixedBYLanguageCode()` and trailing slash [#2510](https://github.com/getgrav/grav/issues/2511)\n    * Fixed regresssion issue of `Utils::Url()` not returning `false` on failure. Added new optional `fail_gracefully` 3rd attribute to return string that caused failure [#2524](https://github.com/getgrav/grav/issues/2524)\n\n# v1.6.9\n## 05/09/2019\n\n1. [](#new)\n    * Added `Route::withoutParams()` methods\n    * Added `Pages::setCheckMethod()` method to override page configuration in Admin Plugin\n    * Added `Cache::clearCache('invalidate')` parameter for just invalidating the cache without deleting any cached files\n    * Made `UserCollectionInderface` to extend `Countable` to get the count of existing users\n1. [](#improved)\n    * Flex admin: added default search options for flex objects\n    * Flex collection and object now fall back to the default template if template file doesn't exist\n    * Updated Vendor libraries including Twig 1.40.1\n    * Updated language files from `https://crowdin.com/project/grav-core`\n1. [](#bugfix)\n    * Fixed `$grav['route']` from being modified when the route instance gets modified\n    * Fixed Assets options array mixed with standalone priority [#2477](https://github.com/getgrav/grav/issues/2477)\n    * Fix for `avatar_url` provided by 3rd party providers\n    * Fixed non standard `lang` code lengths in `Utils` and `Session` detection\n    * Fixed saving a new object in Flex `SimpleStorage`\n    * Fixed exception in `Flex::getDirectories()` if the first parameter is set\n    * Output correct \"Last Updated\" in `bin/gpm info` command\n    * Checkbox getting interpreted as string, so created new `Validation::filterCheckbox()`\n    * Fixed backwards compatibility to `select` field with `selectize.create` set to true [git-sync#141](https://github.com/trilbymedia/grav-plugin-git-sync/issues/141)\n    * Fixed `YamlFormatter::decode()` to always return array [#2494](https://github.com/getgrav/grav/pull/2494)\n    * Fixed empty `$grav['request']->getAttribute('route')->getExtension()`\n\n# v1.6.8\n## 04/23/2019\n\n1. [](#new)\n    * Added `FlexCollection::filterBy()` method\n1. [](#bugfix)\n    * Revert `Use Null Coalesce Operator` [#2466](https://github.com/getgrav/grav/pull/2466)\n    * Fixed `FormTrait::render()` not providing config variable\n    * Updated `bin/grav clean` to clear `cache/compiled` and `user/config/security.yaml`\n\n# v1.6.7\n## 04/22/2019\n\n1. [](#new)\n    * Added a new `bin/grav yamllinter` CLI command to find YAML Linting issues [#2468](https://github.com/getgrav/grav/issues/2468#issuecomment-485151681)\n1. [](#improved)\n    * Improve `FormTrait` backwards compatibility with existing forms\n    * Added a new `Utils::getSubnet()` function for IPv4/IPv6 parsing [#2465](https://github.com/getgrav/grav/pull/2465)\n1. [](#bugfix)\n    * Remove disabled fields from the form schema\n    * Fix issue when excluding `inlineJs` and `inlineCss` from Assets pipeline [#2468](https://github.com/getgrav/grav/issues/2468)\n    * Fix for manually set position on external URLs [#2470](https://github.com/getgrav/grav/issues/2470)\n\n# v1.6.6\n## 04/17/2019\n\n1. [](#new)\n    * `FormInterface` now implements `RenderInterface`\n    * Added new `FormInterface::getTask()` method which reads the task from `form.task` in the blueprint\n1. [](#improved)\n    * Updated vendor libraries to latest\n1. [](#bugfix)\n    * Rollback `redirect_default_route` logic as it has issues with multi-lang [#2459](https://github.com/getgrav/grav/issues/2459)\n    * Fix potential issue with `|contains` Twig filter on PHP 7.3\n    * Fixed bug in text field filtering: return empty string if value isn't a string or number [#2460](https://github.com/getgrav/grav/issues/2460)\n    * Force Asset `priority` to be an integer and not throw error if invalid string passed [#2461](https://github.com/getgrav/grav/issues/2461)\n    * Fixed bug in text field filtering: return empty string if value isn't a string or number\n    * Fixed `FlexForm` missing getter methods for defining form variables\n\n# v1.6.5\n## 04/15/2019\n\n1. [](#bugfix)\n    * Backwards compatiblity with old `Uri::__toString()` output\n\n# v1.6.4\n## 04/15/2019\n\n1. [](#bugfix)\n    * Improved `redirect_default_route` logic as well as `Uri::toArray()` to take into account `root_path` and `extension`\n    * Rework logic to pull out excluded files from pipeline more reliably [#2445](https://github.com/getgrav/grav/issues/2445)\n    * Better logic in `Utils::normalizePath` to handle externals properly [#2216](https://github.com/getgrav/grav/issues/2216)\n    * Fixed to force all `Page::taxonomy` to be treated as strings [#2446](https://github.com/getgrav/grav/issues/2446)\n    * Fixed issue with `Grav['user']` not being available [form#332](https://github.com/getgrav/grav-plugin-form/issues/332)\n    * Updated rounding logic for `Utils::parseSize()` [#2394](https://github.com/getgrav/grav/issues/2394)\n    * Fixed Flex simple storage not being properly initialized if used with caching\n\n# v1.6.3\n## 04/12/2019\n\n1. [](#new)\n    * Added `Blueprint::addDynamicHandler()` method to allow custom dynamic handlers, for example `custom-options@: getCustomOptions`\n1. [](#bugfix)\n    * Missed a `CacheCommand` reference in `bin/grav` [#2442](https://github.com/getgrav/grav/issues/2442)\n    * Fixed issue with `Utils::normalizePath` messing with external URLs [#2216](https://github.com/getgrav/grav/issues/2216)\n    * Fix for `vUndefined` versions when upgrading\n\n# v1.6.2\n## 04/11/2019\n\n1. [](#bugfix)\n    * Revert renaming of `ClearCacheCommand` to ensure CLI GPM upgrades go smoothly\n\n# v1.6.1\n## 04/11/2019\n\n1. [](#improved)\n    * Improved CSS for the bottom filter bar of DebugBar\n1. [](#bugfix)\n    * Fixed issue with `@import` not being added to top of pipelined css [#2440](https://github.com/getgrav/grav/issues/2440)\n\n# v1.6.0\n## 04/11/2019\n\n1. [](#new)\n    * Set minimum requirements to [PHP 7.1.3](https://getgrav.org/blog/raising-php-requirements-2018)\n    * New `Scheduler` functionality for periodic jobs\n    * New `Backup` functionality with multiple backup profiles and scheduler integration\n    * Refactored `Assets Manager` to be more powerful and flexible\n    * Updated Doctrine Collections to 1.6\n    * Updated Doctrine Cache to 1.8\n    * Updated Symfony Components to 4.2\n    * Added new Cache purge functionality old cache manually via CLI/Admin as well as scheduler integration\n    * Added new `{% throw 404 'Not Found' %}` twig tag (with custom code/message)\n    * Added `Grav\\Framework\\File` classes for handling YAML, Markdown, JSON, INI and PHP serialized files\n    * Added `Grav\\Framework\\Collection\\AbstractIndexCollection` class\n    * Added `Grav\\Framework\\Object\\ObjectIndex` class\n    * Added `Grav\\Framework\\Flex` classes\n    * Added support for hiding form fields in blueprints by using dynamic property like `security@: admin.foobar`, `scope@: object` or `scope-ignore@: object` to any field\n    * New experimental **FlexObjects** powered `Users` for increased performance and capability (**disabled** by default)\n    * Added PSR-7 and PSR-15 classes\n    * Added `Grav\\Framework\\DI\\Container` class\n    * Added `Grav\\Framework\\RequestHandler\\RequestHandler` class\n    * Added `Page::httpResponseCode()` and `Page::httpHeaders()` methods\n    * Added `Grav\\Framework\\Form\\Interfaces\\FormInterface`\n    * Added `Grav\\Framework\\Form\\Interfaces\\FormFactoryInterface`\n    * Added `Grav\\Framework\\Form\\FormTrait`\n    * Added `Page::forms()` method to get normalized list of all form headers defined in the page\n    * Added `onPageAction`, `onPageTask`, `onPageAction.{$action}` and `onPageTask.{$task}` events\n    * Added `Blueprint::processForm()` method to filter form inputs\n    * Move `processMarkdown()` method from `TwigExtension` to more general `Utils` class\n    * Added support to include extra files into `Media` (such as uploaded files)\n    * Added form preview support for `FlexObject`, including a way to render newly uploaded files before saving them\n    * Added `FlexObject::getChanges()` to determine what fields change during an update\n    * Added `arrayDiffMultidimensional`, `arrayIsAssociative`, `arrayCombine` Util functions\n    * New `$grav['users']` service to allow custom user classes implementing `UserInterface`\n    * Added `LogViewer` helper class and CLI command: `bin/grav logviewer`\n    * Added `select()` and `unselect()` methods to `CollectionInterface` and its base classes\n    * Added `orderBy()` and `limit()` methods to `ObjectCollectionInterface` and its base classes\n    * Added `user-data://` which is a writable stream (`user://data` is not and should be avoided)\n    * Added support for `/action:{$action}` (like task but used without nonce when only receiving data)\n    * Added `onAction.{$action}` event\n    * Added `Grav\\Framework\\Form\\FormFlash` class to contain AJAX uploaded files in more reliable way\n    * Added `Grav\\Framework\\Form\\FormFlashFile` class which implements `UploadedFileInterface` from PSR-7\n    * Added `Grav\\Framework\\Filesystem\\Filesystem` class with methods to manipulate stream URLs\n    * Added new `$grav['filesystem']` service using an instance of the new `Filesystem` object\n    * Added `{% render object layout: 'default' with { variable: true } %}` for Flex objects and collections\n    * Added `$grav->setup()` to simplify CLI and custom access points\n    * Added `CsvFormatter` and `CsvFile` classes\n    * Added new system config option to `pages.hide_empty_folders` if a folder has no valid `.md` file available. Default behavior is `false` for compatibility.\n    * Added new system config option for `languages.pages_fallback_only` forcing only 'fallback' to find page content through supported languages, default behavior is to display any language found if active language is missing\n    * Added `Utils::arrayFlattenDotNotation()` and `Utils::arrayUnflattenDotNotation()` helper methods\n1. [](#improved)\n    * Add the page to onMarkdownInitialized event [#2412](https://github.com/getgrav/grav/issues/2412)\n    * Doctrine filecache is now namespaced with prefix to support purging\n    * Register all page types into `blueprint://pages` stream\n    * Removed `apc` and `xcache` support, made `apc` alias of `apcu`\n    * Support admin and regular translations via the `|t` twig filter and `t()` twig function\n    * Improved Grav Core installer/updater to run installer script\n    * Updated vendor libraries including Symfony `4.2.3`\n    * Renamed old `User` class to `Grav\\Common\\User\\DataUser\\User` with multiple improvements and small fixes\n    * `User` class now acts as a compatibility layer to older versions of Grav\n    * Deprecated `new User()`, `User::load()`, `User::find()` and `User::delete()` in favor of `$grav['users']` service\n    * `Media` constructor has now support to not to initialize the media objects\n    * Cleanly handle session corruption due to changing Flex object types\n    * Added `FlexObjectInterface::getDefaultValue()` and `FormInterface::getDefaultValue()`\n    * Added new `onPageContent()` event for every call to `Page::content()`\n    * Added phpstan: PHP Static Analysis Tool [#2393](https://github.com/getgrav/grav/pull/2393)\n    * Added `composer test-plugins` to test plugin issues with the current version of Grav\n    * Added `Flex::getObjects()` and `Flex::getMixedCollection()` methods for co-mingled collections\n    * Added support to use single Flex key parameter in `Flex::getObject()` method\n    * Added `FlexObjectInterface::search()` and `FlexCollectionInterface::search()` methods\n    * Override `system.media.upload_limit` with PHP's `post_max_size` or `upload_max_filesize`\n    * Class `Grav\\Common\\Page\\Medium\\AbstractMedia` now use array traits instead of extending `Grav\\Common\\Getters`\n    * Implemented `Grav\\Framework\\Psr7` classes as `Nyholm/psr7` decorators\n    * Added a new `cache-clear` scheduled job to go along with `cache-purge`\n    * Renamed `Grav\\Framework\\File\\Formatter\\FormatterInterface` to `Grav\\Framework\\File\\Interfaces\\FileFormatterInterface`\n    * Improved `File::save()` to use a temporary file if file isn't locked\n    * Improved `|t` filter to better support admin `|tu` style filter if in admin\n    * Update all classes to rely on `PageInterface` instead of `Page` class\n    * Better error checking in `bin/plugin` for existence and enabled\n    * Removed `media.upload_limit` references\n    * Twig `nicenumber`: do not use 0 + string casting hack\n    * Converted Twig tags to use namespaced Twig classes\n    * Site shows error on page rather than hard-crash when page has invalid frontmatter [#2343](https://github.com/getgrav/grav/issues/2343)\n    * Added `languages.default_lang` option to override the default lang (usually first supported language)\n    * Added `Content-Type: application/json` body support for PSR-7 `ServerRequest`\n    * Remove PHP time limit in `ZipArchive`\n    * DebugBar: Resolve twig templates in deprecated backtraces in order to help locating Twig issues\n    * Added `$grav['cache']->getSimpleCache()` method for getting PSR-16 compatible cache\n    * MediaTrait: Use PSR-16 cache\n    * Improved `Utils::normalizePath()` to support non-protocol URLs\n    * Added ability to reset `Page::metadata` to allow rebuilding from automatically generated values\n    * Added back missing `page.types` field in system content configuration [admin#1612](https://github.com/getgrav/grav-plugin-admin/issues/1612)\n    * Console commands: add method for invalidating cache\n    * Updated languages\n    * Improved `$page->forms()` call, added `$page->addForms()`\n    * Updated languages from crowdin\n    * Fixed `ImageMedium` constructor warning when file does not exist\n    * Improved `Grav\\Common\\User` class; added `$user->update()` method\n    * Added trim support for text input fields `validate: trim: true`\n    * Improved `Grav\\Framework\\File\\Formatter` classes to have abstract parent class and some useful methods\n    * Support negotiated content types set via the Request `Accept:` header\n    * Support negotiated language types set via the Request `Accept-Language:` header\n    * Cleaned up and sorted the Service `idMap`\n    * Updated `Grav` container object to implement PSR-11 `ContainerInterface`\n    * Updated Grav `Processor` classes to implement PSR-15 `MiddlewareInterface`\n    * Make `Data` class to extend `JsonSerializable`\n    * Modified debugger icon to use retina space-dude version\n    * Added missing `Video::preload()` method\n    * Set session name based on `security.salt` rather than `GRAV_ROOT` [#2242](https://github.com/getgrav/grav/issues/2242)\n    * Added option to configure list of `xss_invalid_protocols` in `Security` config [#2250](https://github.com/getgrav/grav/issues/2250)\n    * Smarter `security.salt` checking now we use `security.yaml` for other options\n    * Added apcu autoloader optimization\n    * Additional helper methods in `Language`, `Languages`, and `LanguageCodes` classes\n    * Call `onFatalException` event also on internal PHP errors\n    * Built-in PHP Webserver: log requests before handling them\n    * Added support for syslog and syslog facility logging (default: 'file')\n    * Improved usability of `System` configuration blueprint with side-tabs\n 1. [](#bugfix)\n    * Fixed issue with `Truncator::truncateWords` and `Truncator::truncateLetters` when string not wrapped in tags [#2432](https://github.com/getgrav/grav/issues/2432)\n    * Fixed `Undefined method closure::fields()` when getting avatar for user, thanks @Romarain [#2422](https://github.com/getgrav/grav/issues/2422)\n    * Fixed cached images not being updated when source image is modified\n    * Fixed deleting last list item in the form\n    * Fixed issue with `Utils::url()` method would append extra `base_url` if URL already included it\n    * Fixed `mkdir(...)` race condition\n    * Fixed `Obtaining write lock failed on file...`\n    * Fixed potential undefined property in `onPageNotFound` event handling\n    * Fixed some potential issues/bugs found by phpstan\n    * Fixed regression in GPM packages casted to Array (ref, getgrav/grav-plugin-admin@e3fc4ce)\n    * Fixed session_start(): Setting option 'session.name' failed [#2408](https://github.com/getgrav/grav/issues/2408)\n    * Fixed validation for select field type with selectize\n    * Fixed validation for boolean toggles\n    * Fixed non-namespaced exceptions in scheduler\n    * Fixed trailing slash redirect in multlang environment [#2350](https://github.com/getgrav/grav/issues/2350)\n    * Fixed some issues related to Medium objects losing query string attributes\n    * Broke out Medium timestamp so it's not cleared on `reset()`s\n    * Fixed issue with `redirect_trailing_slash` losing query string [#2269](https://github.com/getgrav/grav/issues/2269)\n    * Fixed failed login if user attempts to log in with upper case non-english letters\n    * Removed extra authenticated/authorized fields when saving existing user from a form\n    * Fixed `Grav\\Framework\\Route::__toString()` returning relative URL, not relative route\n    * Fixed handling of `append_url_extension` inside of `Page::templateFormat()` [#2264](https://github.com/getgrav/grav/issues/2264)\n    * Fixed a broken language string [#2261](https://github.com/getgrav/grav/issues/2261)\n    * Fixed clearing cache having no effect on Doctrine cache\n    * Fixed `Medium::relativePath()` for streams\n    * Fixed `Object` serialization breaking if overriding `jsonSerialize()` method\n    * Fixed `YamlFormatter::decode()` when calling `init_set()` with integer\n    * Fixed session throwing error in CLI if initialized\n    * Fixed `Uri::hasStandardPort()` to support reverse proxy configurations [#1786](https://github.com/getgrav/grav/issues/1786)\n    * Use `append_url_extension` from page header to set template format if set [#2604](https://github.com/getgrav/grav/pull/2064)\n    * Fixed some bugs in Grav environment selection logic\n    * Use login provider User avatar if set\n    * Fixed `Folder::doDelete($folder, false)` removing symlink when it should not\n    * Fixed asset manager to not add empty assets when they don't exist in the filesystem\n    * Update `script` and `style` Twig tags to use the new `Assets` classes\n    * Fixed asset pipeline to rewrite remote URLs as well as local [#2216](https://github.com/getgrav/grav/issues/2216)\n\n# v1.5.10\n## 03/21/2019\n\n1. [](#new)\n    * Added new `deferred` Twig extension\n\n# v1.5.9\n## 03/20/2019\n\n1. [](#new)\n    * Added new `onPageContent()` event for every call to `Page::content()`\n1. [](#improved)\n    * Fixed phpdoc generation\n    * Updated vendor libraries\n    * Force Toolbox v1.4.2\n1. [](#bugfix)\n    * EXIF fix for streams\n    * Fix for User avatar not working due to uppercase or spaces in email [#2403](https://github.com/getgrav/grav/pull/2403)\n\n# v1.5.8\n## 02/07/2019\n\n1. [](#improved)\n    * Improved `User` unserialize to not to break the object if serialized data is not what expected\n    * Removed unused parameter [#2357](https://github.com/getgrav/grav/pull/2357)\n\n# v1.5.7\n## 01/25/2019\n\n1. [](#new)\n    * Support for AWS Cloudfront forwarded scheme header [#2297](https://github.com/getgrav/grav/pull/2297)\n1. [](#improved)\n    * Set homepage with `https://` protocol [#2299](https://github.com/getgrav/grav/pull/2299)\n    * Preserve accents in fields containing Twig expr. using unicode [#2279](https://github.com/getgrav/grav/pull/2279)\n    * Updated vendor libraries\n1. [](#bugfix)\n    * Support spaces with filenames in responsive images [#2300](https://github.com/getgrav/grav/pull/2300)\n\n# v1.5.6\n## 12/14/2018\n\n1. [](#improved)\n    * Updated InitializeProcessor.php to use lang-safe redirect [#2268](https://github.com/getgrav/grav/pull/2268)\n    * Improved user serialization to use less memory in the session\n\n# v1.5.5\n## 11/12/2018\n\n1. [](#new)\n    * Register theme prefixes as namespaces in Twig [#2210](https://github.com/getgrav/grav/pull/2210)\n1. [](#improved)\n    * Propogate error code between 400 and 600 for production sites [#2181](https://github.com/getgrav/grav/pull/2181)\n1. [](#bugfix)\n    * Remove hardcoded `302` when redirecting trailing slash [#2155](https://github.com/getgrav/grav/pull/2155)\n\n# v1.5.4\n## 11/05/2018\n\n1. [](#improved)\n    * Updated default page `index.md` with some consistency fixes [#2245](https://github.com/getgrav/grav/pull/2245)\n1. [](#bugfix)\n    * Fixed fatal error if calling `$session->invalidate()` when there's no active session\n    * Fixed typo in media.yaml for `webm` extension [#2220](https://github.com/getgrav/grav/pull/2220)\n    * Fixed markdown processing for telephone links [#2235](https://github.com/getgrav/grav/pull/2235)\n\n# v1.5.3\n## 10/08/2018\n\n1. [](#new)\n    * Added `Utils::getMimeByFilename()`, `Utils::getMimeByLocalFile()` and `Utils::checkFilename()` methods\n    * Added configurable dangerous upload extensions in `security.yaml`\n1. [](#improved)\n    * Updated vendor libraries to latest\n\n# v1.5.2\n## 10/01/2018\n\n1. [](#new)\n    * Added new `Security` class for Grav security functionality including XSS checks\n    * Added new `bin/grav security` command to scan for security issues\n    * Added new `xss()` Twig function to allow for XSS checks on strings and arrays\n    * Added `onHttpPostFilter` event to allow plugins to globally clean up XSS in the forms and tasks\n    * Added `Deprecated` tab to DebugBar to catch future incompatibilities with later Grav versions\n    * Added deprecation notices for features which will be removed in Grav 2.0\n1. [](#improved)\n    * Updated vendor libraries to latest\n1. [](#bugfix)\n    * Allow `$page->slug()` to be called before `$page->init()` without breaking the page\n    * Fix for `Page::translatedLanguages()` to use routes always [#2163](https://github.com/getgrav/grav/issues/2163)\n    * Fixed `nicetime()` twig function\n    * Allow twig tags `{% script %}`, `{% style %}` and `{% switch %}` to be placed outside of blocks\n    * Session expires in 30 mins independent from config settings [login#178](https://github.com/getgrav/grav-plugin-login/issues/178)\n\n# v1.5.1\n## 08/23/2018\n\n1. [](#new)\n    * Added static `Grav\\Common\\Yaml` class which should be used instead of `Symfony\\Component\\Yaml\\Yaml`\n1. [](#improved)\n    * Updated deprecated Twig code so it works in both in Twig 1.34+ and Twig 2.4+\n    * Switched to new Grav Yaml class to support Native + Fallback YAML libraries\n1. [](#bugfix)\n    * Broken handling of user folder in Grav URI object [#2151](https://github.com/getgrav/grav/issues/2151)\n\n# v1.5.0\n## 08/17/2018\n\n1. [](#new)\n    * Set minimum requirements to [PHP 5.6.4](https://getgrav.org/blog/raising-php-requirements-2018)\n    * Updated Doctrine Collections to 1.4\n    * Updated Symfony Components to 3.4 (with compatibility mode to fall back to Symfony YAML 2.8)\n    * Added `Uri::method()` to get current HTTP method (GET/POST etc)\n    * `FormatterInterface`: Added `getSupportedFileExtensions()` and `getDefaultFileExtension()` methods\n    * Added option to disable `SimpleCache` key validation\n    * Added support for multiple repo locations for `bin/grav install` command\n    * Added twig filters for casting values: `|string`, `|int`, `|bool`, `|float`, `|array`\n    * Made `ObjectCollection::matching()` criteria expressions to behave more like in Twig\n    * Criteria: Added support for `LENGTH()`, `LOWER()`, `UPPER()`, `LTRIM()`, `RTRIM()` and `TRIM()`\n    * Added `Grav\\Framework\\File\\Formatter` classes for encoding/decoding YAML, Markdown, JSON, INI and PHP serialized strings\n    * Added `Grav\\Framework\\Session` class to replace `RocketTheme\\Toolbox\\Session\\Session`\n    * Added `Grav\\Common\\Media` interfaces and trait; use those in `Page` and `Media` classes\n    * Added `Grav\\Common\\Page` interface to allow custom page types in the future\n    * Added setting to disable sessions from the site [#2013](https://github.com/getgrav/grav/issues/2013)\n    * Added new `strict_mode` settings in `system.yaml` for compatibility\n1. [](#improved)\n    * Improved `Utils::url()` to support query strings\n    * Display better exception message if Grav fails to initialize\n    * Added `muted` and `playsinline` support to videos [#2124](https://github.com/getgrav/grav/pull/2124)\n    * Added `MediaTrait::clearMediaCache()` to allow cache to be cleared\n    * Added `MediaTrait::getMediaCache()` to allow custom caching\n    * Improved session handling, allow all session configuration options in `system.session.options`\n1. [](#bugfix)\n    * Fix broken form nonce logic [#2121](https://github.com/getgrav/grav/pull/2121)\n    * Fixed issue with uppercase extensions and fallback media URLs [#2133](https://github.com/getgrav/grav/issues/2133)\n    * Fixed theme inheritance issue with `camel-case` that includes numbers [#2134](https://github.com/getgrav/grav/issues/2134)\n    * Typo in demo typography page [#2136](https://github.com/getgrav/grav/pull/2136)\n    * Fix for incorrect plugin order in debugger panel\n    * Made `|markdown` filter HTML safe\n    * Fixed bug in `ContentBlock` serialization\n    * Fixed `Route::withQueryParam()` to accept array values\n    * Fixed typo in truncate function [#1943](https://github.com/getgrav/grav/issues/1943)\n    * Fixed blueprint field validation: Allow numeric inputs in text fields\n\n# v1.4.8\n## 07/31/2018\n\n1. [](#improved)\n    * Add Grav version to debug bar messages tab [#2106](https://github.com/getgrav/grav/pull/2106)\n    * Add Nginx config for ddev project to `webserver-configs` [#2117](https://github.com/getgrav/grav/pull/2117)\n    * Vendor library updates\n1. [](#bugfix)\n    * Don't allow `null` to be set as Page content\n\n# v1.4.7\n## 07/13/2018\n\n1. [](#improved)\n    * Use `getFilename` instead of `getBasename` [#2087](https://github.com/getgrav/grav/issues/2087)\n1. [](#bugfix)\n    * Fix for modular page preview [#2066](https://github.com/getgrav/grav/issues/2066)\n    * `Page::routeCanonical()` should be string not array [#2069](https://github.com/getgrav/grav/issues/2069)\n\n# v1.4.6\n## 06/20/2018\n\n1. [](#improved)\n    * Manually re-added the improved SSL off-loading that was lost with Grav v1.4.0 merge [#1888](https://github.com/getgrav/grav/pull/1888)\n    * Handle multibyte strings in `truncateLetters()` [#2007](https://github.com/getgrav/grav/pull/2007)\n    * Updated robots.txt to include `/user/images/` folder [#2043](https://github.com/getgrav/grav/pull/2043)\n    * Add getter methods for original and action to the Page object [#2005](https://github.com/getgrav/grav/pull/2005)\n    * Modular template extension follows the master page extension [#2044](https://github.com/getgrav/grav/pull/2044)\n    * Vendor library updates\n1. [](#bugfix)\n    * Handle `errors.display` system property better in admin plugin [admin#1452](https://github.com/getgrav/grav-plugin-admin/issues/1452)\n    * Fix classes on non-http based protocol links [#2034](https://github.com/getgrav/grav/issues/2034)\n    * Fixed crash on IIS (Windows) with open_basedir in effect [#2053](https://github.com/getgrav/grav/issues/2053)\n    * Fixed incorrect routing with setup.php based base [#1892](https://github.com/getgrav/grav/issues/1892)\n    * Fixed image resource memory deallocation [#2045](https://github.com/getgrav/grav/pull/2045)\n    * Fixed issue with Errors `display:` option not handling integers properly [admin#1452](https://github.com/getgrav/grav-plugin-admin/issues/1452)\n\n# v1.4.5\n## 05/15/2018\n\n1. [](#bugfix)\n    * Fixed an issue with some users getting **2FA** prompt after upgrade [admin#1442](https://github.com/getgrav/grav-plugin-admin/issues/1442)\n    * Do not crash when generating URLs with arrays as parameters [#2018](https://github.com/getgrav/grav/pull/2018)\n    * Utils::truncateHTML removes whitespace when generating summaries [#2004](https://github.com/getgrav/grav/pull/2004)\n\n# v1.4.4\n## 05/11/2018\n\n1. [](#new)\n    * Added support for `Uri::post()` and `Uri::getConentType()`\n    * Added a new `Medium:thumbnailExists()` function [#1966](https://github.com/getgrav/grav/issues/1966)\n    * Added `authorized` support for 2FA\n1. [](#improved)\n    * Added default configuration for images [#1979](https://github.com/getgrav/grav/pull/1979)\n    * Added dedicated PHPUnit assertions [#1990](https://github.com/getgrav/grav/pull/1990)\n1. [](#bugfix)\n    * Use `array_key_exists` instead of `in_array + array_keys` [#1991](https://github.com/getgrav/grav/pull/1991)\n    * Fixed an issue with `custom_base_url` always causing 404 errors\n    * Improve support for regex redirects with query and params [#1983](https://github.com/getgrav/grav/issues/1983)\n    * Changed collection-based date sorting to `SORT_REGULAR` for better server compatibility [#1910](https://github.com/getgrav/grav/issues/1910)\n    * Fix hardcoded string in modular blueprint [#1933](https://github.com/getgrav/grav/pull/1993)\n\n# v1.4.3\n## 04/12/2018\n\n1. [](#new)\n    * moved Twig `sortArrayByKey` logic into `Utils::` class\n1. [](#improved)\n    * Rolled back Parsedown library to stable `1.6.4` until a better solution for `1.8.0` compatibility can fe found\n    * Updated vendor libraries to latest versions\n1. [](#bugfix)\n    * Fix for bad reference to `ZipArchive` in `GPM::Installer`\n\n# v1.4.2\n## 03/21/2018\n\n1. [](#new)\n    * Added new `|nicefilesize` Twig filter for pretty file (auto converts to bytes, kB, MB, GB, etc)\n    * Added new `regex_filter()` Twig function to values in arrays\n1. [](#improved)\n    * Added bosnian to lang codes [#1917](\ufeffhttps://github.com/getgrav/grav/issues/1917)\n    * Improved Zip extraction error codes [#1922](\ufeffhttps://github.com/getgrav/grav/issues/1922)\n1. [](#bugfix)\n    * Fixed an issue with Markdown Video and Audio that broke after Parsedown 1.7.0 Security updates [#1924](\ufeffhttps://github.com/getgrav/grav/issues/1924)\n    * Fix for case-sensitive page metadata [admin#1370](https://github.com/getgrav/grav-plugin-admin/issues/1370)\n    * Fixed missing composer requirements for the new `Grav\\Framework\\Uri` classes\n    * Added missing PSR-7 vendor library required for URI additions in Grav 1.4.0\n\n# v1.4.1\n## 03/11/2018\n\n1. [](#bugfix)\n    * Fixed session timing out because of session cookie was not being sent\n\n# v1.4.0\n## 03/09/2018\n\n1. [](#new)\n    * Added `Grav\\Framework\\Uri` classes extending PSR-7 `HTTP message UriInterface` implementation\n    * Added `Grav\\Framework\\Route` classes to allow route/link manipulation\n    * Added `$grav['uri]->getCurrentUri()` method to get `Grav\\Framework\\Uri\\Uri` instance for the current URL\n    * Added `$grav['uri]->getCurrentRoute()` method to get `Grav\\Framework\\Route\\Route` instance for the current URL\n    * Added ability to have `php` version dependencies in GPM assets\n    * Added new `{% switch %}` twig tag for more elegant if statements\n    * Added new `{% markdown %}` twig tag\n    * Added **Route Overrides** to the default page blueprint\n    * Added new `Collection::toExtendedArray()` method that's particularly useful for Json output of data\n    * Added new `|yaml_encode` and `|yaml_decode` Twig filter to convert to and from YAML\n    * Added new `read_file()` Twig function to allow you to load and display a file in Twig (Supports streams and regular paths)\n    * Added a new `Medium::exists()` method to check for file existence\n    * Moved Twig `urlFunc()` to `Utils::url()` as its so darn handy\n    * Transferred overall copyright from RocketTheme, LLC, to Trilby Media LLC\n    * Added `theme_var`, `header_var` and `body_class` Twig functions for themes\n    * Added `Grav\\Framework\\Cache` classes providing PSR-16 `Simple Cache` implementation\n    * Added `Grav\\Framework\\ContentBlock` classes for nested HTML blocks with CSS/JS assets\n    * Added `Grav\\Framework\\Object` classes for creating collections of objects\n    * Added `|nicenumber` Twig filter\n    * Added `{% try %} ... {% catch %} Error: {{ e.message }} {% endcatch %}` tag to allow basic exception handling inside Twig\n    * Added `{% script %}` and `{% style %}` tags for Twig templates\n    * Deprecated GravTrait\n1. [](#improved)\n    * Improved `Session` initialization\n    * Added ability to set a `theme_var()` option in page frontmatter\n    * Force clearing PHP `clearstatcache` and `opcache-reset` on `Cache::clear()`\n    * Better `Page.collection()` filtering support including ability to have non-published pages in collections\n    * Stopped Chrome from auto-completing admin user profile form [#1847](https://github.com/getgrav/grav/issues/1847)\n    * Support for empty `switch` field like a `checkbox`\n    * Made `modular` blueprint more flexible\n    * Code optimizations to `Utils` class [#1830](https://github.com/getgrav/grav/pull/1830)\n    * Objects: Add protected function `getElement()` to get serialized value for a single property\n    * `ObjectPropertyTrait`: Added protected functions `isPropertyLoaded()`, `offsetLoad()`, `offsetPrepare()` and `offsetSerialize()`\n    * `Grav\\Framework\\Cache`: Allow unlimited TTL\n    * Optimizations & refactoring to the test suite [#1779](https://github.com/getgrav/grav/pull/1779)\n    * Slight modification of Whoops error colors\n    * Added new configuration option `system.session.initialize` to delay session initialization if needed by a plugin\n    * Updated vendor libraries to latest versions\n    * Removed constructor from `ObjectInterface`\n    * Make it possible to include debug bar also into non-HTML responses\n    * Updated built-in JQuery to latest 3.3.1\n1. [](#bugfix)\n    * Fixed issue with image alt tag always getting empted out unless set in markdown\n    * Fixed issue with remote PHP version determination for Grav updates [#1883](https://github.com/getgrav/grav/issues/1883)\n    * Fixed issue with _illegal scheme offset_ in `Uri::convertUrl()` [page-inject#8](https://github.com/getgrav/grav-plugin-page-inject/issues/8)\n    * Properly validate YAML blueprint fields so admin can save as proper YAML now  [addresses many issues]\n    * Fixed OpenGraph metatags so only Twitter uses `name=`, and all others use `property=` [#1849](https://github.com/getgrav/grav/issues/1849)\n    * Fixed an issue with `evaluate()` and `evaluate_twig()` Twig functions that throws invalid template error\n    * Fixed issue with `|sort_by_key` twig filter if the input was null or not an array\n    * Date ordering should always be numeric [#1810](https://github.com/getgrav/grav/issues/1810)\n    * Fix for base paths containing special characters [#1799](https://github.com/getgrav/grav/issues/1799)\n    * Fix for session cookies in paths containing special characters\n    * Fix for `vundefined` error for version numbers in GPM [form#222](https://github.com/getgrav/grav-plugin-form/issues/222)\n    * Fixed `BadMethodCallException` thrown in GPM updates [#1784](https://github.com/getgrav/grav/issues/1784)\n    * NOTE: Parsedown security release now escapes `&` to `&amp;` in Markdown links\n\n# v1.3.10\n## 12/06/2017\n\n1. [](#bugfix)\n    * Reverted GPM Local pull request as it broken admin [#1742](https://github.com/getgrav/grav/issues/1742)\n\n# v1.3.9\n## 12/05/2017\n\n1. [](#new)\n    * Added new core Twig templates for `partials/metadata.html.twig` and `partials/messages.html.twig`\n    * Added ability to work with GPM locally [#1742](https://github.com/getgrav/grav/issues/1742)\n    * Added new HTML5 audio controls [#1756](https://github.com/getgrav/grav/issues/1756)\n    * Added `Medium::copy()` method to create a copy of a medium object\n    * Added new `force_lowercase_urls` functionality on routes and slugs\n    * Added new `item-list` filter type to remove empty items\n    * Added new `setFlashCookieObject()` and `getFlashCookieObject()` methods to `Session` object\n    * Added new `intl_enabled` option to disable PHP intl module collation when not needed\n1. [](#bugfix)\n    * Fixed an issue with checkbox field validation [form#216](https://github.com/getgrav/grav-plugin-form/issues/216)\n    * Fixed issue with multibyte Markdown link URLs [#1749](https://github.com/getgrav/grav/issues/1749)\n    * Fixed issue with multibyte folder names [#1751](https://github.com/getgrav/grav/issues/1751)\n    * Fixed several issues related to `system.custom_base_url` that were broken [#1736](https://github.com/getgrav/grav/issues/1736)\n    * Dynamically added pages via `Pages::addPage()` were not firing `onPageProcessed()` event causing forms not to be processed\n    * Fixed `Page::active()` and `Page::activeChild()` to work with UTF-8 characters in the URL [#1727](https://github.com/getgrav/grav/issues/1727)\n    * Fixed typo in `modular.yaml` causing media to be ignored [#1725](https://github.com/getgrav/grav/issues/1725)\n    * Reverted `case_insensitive_urls` option as it was causing issues with taxonomy [#1733](https://github.com/getgrav/grav/pull/1733)\n    * Removed an extra `/` in `CompileFile.php` [#1693](https://github.com/getgrav/grav/pull/1693)\n    * Uri::Encode user and password to prevent issues in browsers\n    * Fixed \"Invalid AJAX response\" When using Built-in PHP Webserver in Windows [#1258](https://github.com/getgrav/grav-plugin-admin/issues/1258)\n    * Remove support for `config.user`, it was broken and bad practise\n    * Make sure that `clean cache` uses valid path [#1745](https://github.com/getgrav/grav/pull/1745)\n    * Fixed token creation issue with `Uri` params like `/id:3`\n    * Fixed CSS Pipeline failing with Google remote fonts if the file was minified [#1261](https://github.com/getgrav/grav-plugin-admin/issues/1261)\n    * Forced `field.multiple: true` to allow use of min/max options in `checkboxes.validate`\n\n# v1.3.8\n## 10/26/2017\n\n1. [](#new)\n    * Added Page `media_order` capability to manually order page media via a page header\n1. [](#bugfix)\n    * Fixed GPM update issue with filtered slugs [#1711](https://github.com/getgrav/grav/issues/1711)\n    * Fixed issue with missing image file not throwing 404 properly [#1713](https://github.com/getgrav/grav/issues/1713)\n\n# v1.3.7\n## 10/18/2017\n\n1. [](#bugfix)\n    * Regression Uri: `base_url_absolute` always has the port number [#1690](https://github.com/getgrav/grav-plugin-admin/issues/1690)\n    * Uri: Prefer using REQUEST_SCHEME instead of HTTPS [#1698](https://github.com/getgrav/grav-plugin-admin/issues/1698)\n    * Fixed routing paths with urlencoded spaces and non-latin letters [#1688](https://github.com/getgrav/grav-plugin-admin/issues/1688)\n\n# v1.3.6\n## 10/12/2017\n\n1. [](#bugfix)\n    * Regression: Ajax error in Nginx [admin#1244](https://github.com/getgrav/grav-plugin-admin/issues/1244)\n    * Remove the `_url=$uri` portion of the the Nginx `try_files` command [admin#1244](https://github.com/getgrav/grav-plugin-admin/issues/1244)\n\n# v1.3.5\n## 10/11/2017\n\n1. [](#improved)\n    * Refactored `URI` class with numerous bug fixes, and optimizations\n    * Override `system.media.upload_limit` with PHP's `post_max_size` or `upload_max_filesize`\n    * Updated `bin/grav clean` command to remove unnecessary vendor files (save some bytes)\n    * Added a `http_status_code` Twig function to allow setting HTTP status codes from Twig directly.\n    * Deter XSS attacks via URI path/uri methods (credit:newbthenewbd)\n    * Added support for `$uri->toArray()` and `(string)$uri`\n    * Added support for `type` on `Asstes::addInlineJs()` [#1683](https://github.com/getgrav/grav/pull/1683)\n1. [](#bugfix)\n    * Fixed method signature error with `GPM\\InstallCommand::processPackage()` [#1682](https://github.com/getgrav/grav/pull/1682)\n\n# v1.3.4\n## 09/29/2017\n\n1. [](#new)\n    * Added filter support for Page collections (routable/visible/type/access/etc.)\n1. [](#improved)\n    * Implemented `Composer\\CaBundle` for SSL Certs [#1241](https://github.com/getgrav/grav/issues/1241)\n    * Refactored the Assets sorting logic\n    * Improved language overrides to merge only 'extra' translations [#1514](https://github.com/getgrav/grav/issues/1514)\n    * Improved support for Assets with query strings [#1451](https://github.com/getgrav/grav/issues/1451)\n    * Twig extension cleanup\n1. [](#bugfix)\n    * Fixed an issue where fallback was not supporting dynamic page generation\n    * Fixed issue with Image query string not being fully URL encoded [#1622](https://github.com/getgrav/grav/issues/1622)\n    * Fixed `Page::summary()` when using delimiter and multibyte UTF8 Characters [#1644](https://github.com/getgrav/grav/issues/1644)\n    * Fixed missing `.json` thumbnail throwing error when adding media [grav-plugin-admin#1156](https://github.com/getgrav/grav-plugin-admin/issues/1156)\n    * Fixed insecure session cookie initialization [#1656](https://github.com/getgrav/grav/pull/1656)\n\n# v1.3.3\n## 09/07/2017\n\n1. [](#new)\n    * Added support for 2-Factor Authentication in admin profile\n    * Added `gaussianBlur` media method [#1623](https://github.com/getgrav/grav/pull/1623)\n    * Added new `|chunk_split()`, `|basename`, and `|dirname` Twig filter\n    * Added new `tl` Twig filter/function to support specific translations [#1618](https://github.com/getgrav/grav/issues/1618)\n1. [](#improved)\n    * User `authorization` now requires a check for `authenticated` - REQUIRED: `Login v2.4.0`\n    * Added options to `Page::summary()` to support size without HTML tags [#1554](https://github.com/getgrav/grav/issues/1554)\n    * Forced `natsort` on plugins to ensure consistent plugin load ordering across platforms [#1614](https://github.com/getgrav/grav/issues/1614)\n    * Use new `multilevel` field to handle Asset Collections [#1201](https://github.com/getgrav/grav-plugin-admin/issues/1201)\n    * Added support for redis `password` option [#1620](https://github.com/getgrav/grav/issues/1620)\n    * Use 302 rather than 301 redirects by default [#1619](https://github.com/getgrav/grav/issues/1619)\n    * GPM Installer will try to load alphanumeric version of the class if no standard class found [#1630](https://github.com/getgrav/grav/issues/1630)\n    * Add current page position to `User` class [#1632](https://github.com/getgrav/grav/issues/1632)\n    * Added option to enable case insensitive URLs [#1638](https://github.com/getgrav/grav/issues/1638)\n    * Updated vendor libraries\n    * Updated `travis.yml` to add support for PHP 7.1 as well as 7.0.21 for test suite\n1. [](#bugfix)\n    * Fixed UTF8 multibyte UTF8 character support in `Page::summary()` [#1554](https://github.com/getgrav/grav/issues/1554)\n\n# v1.3.2\n## 08/16/2017\n\n1. [](#new)\n    * Added a new `cache_control` system and page level property [#1591](https://github.com/getgrav/grav/issues/1591)\n    * Added a new `clear_images_by_default` system property to stop cache clear events from removing processed images [#1481](https://github.com/getgrav/grav/pull/1481)\n    * Added new `onTwigLoader()` event to enable utilization of loader methods\n    * Added new `Twig::addPath()` and `Twig::prependPath()` methods to wrap loader methods and support namespacing [#1604](https://github.com/getgrav/grav/issues/1604)\n    * Added new `array_key_exists()` Twig function wrapper\n    * Added a new `Collection::intersect()` method [#1605](https://github.com/getgrav/grav/issues/1605)\n1. [](#bugfix)\n    * Allow `session.timeout` field to be set to `0` via blueprints [#1598](https://github.com/getgrav/grav/issues/1598)\n    * Fixed `Data::exists()` and `Data::raw()` functions breaking if `Data::file()` hasn't been called with non-null value\n    * Fixed parent theme auto-loading in child themes of Gantry 5\n\n# v1.3.1\n## 07/19/2017\n\n1. [](#bugfix)\n    * Fix ordering for Linux + International environments [#1574](https://github.com/getgrav/grav/issues/1574)\n    * Check if medium thumbnail exists before resetting\n    * Update Travis' auth token\n\n# v1.3.0\n## 07/16/2017\n\n1. [](#bugfix)\n    * Fixed an undefined variable `$difference` [#1563](https://github.com/getgrav/grav/pull/1563)\n    * Fix broken range slider [grav-plugin-admin#1153](https://github.com/getgrav/grav-plugin-admin/issues/1153)\n    * Fix natural sort when > 100 pages [#1564](https://github.com/getgrav/grav/pull/1564)\n\n# v1.3.0-rc.5\n## 07/05/2017\n\n1. [](#new)\n    * Setting `system.session.timeout` to 0 clears the session when the browser session ends [#1538](https://github.com/getgrav/grav/pull/1538)\n    * Created a `CODE_OF_CONDUCT.md` so everyone knows how to behave :)\n1. [](#improved)\n    * Renamed new `media()` Twig function to `media_directory()` to avoid conflict with Page's `media` object\n1. [](#bugfix)\n    * Fixed global media files disappearing after a reload [#1545](https://github.com/getgrav/grav/issues/1545)\n    * Fix for broken regex redirects/routes via `site.yaml`\n    * Sanitize the error message in the error handler page\n\n# v1.3.0-rc.4\n## 06/22/2017\n\n1. [](#new)\n    * Added `lower` and `upper` Twig filters\n    * Added `pathinfo()` Twig function\n    * Added 165 new thumbnail images for use in `media.yaml`\n1. [](#improved)\n    * Improved error message when running `bin/grav install` instead of `bin/gpm install`, and also when running on a non-skeleton site [#1027](https://github.com/getgrav/grav/issues/1027)\n    * Updated vendor libraries\n1. [](#bugfix)\n    * Don't rebuild metadata every time, only when file does not exist\n    * Restore GravTrait in ConsoleTrait [grav-plugin-login#119](https://github.com/getgrav/grav-plugin-login/issues/119)\n    * Fix Windows routing with built-in server [#1502](https://github.com/getgrav/grav/issues/1502)\n    * Fix [#1504](https://github.com/getgrav/grav/issues/1504) `process_twig` and `frontmatter.yaml`\n    * Nicetime fix: 0 seconds from now -> just now [#1509](https://github.com/getgrav/grav/issues/1509)\n\n# v1.3.0-rc.3\n## 05/22/2017\n\n1. [](#new)\n    * Added new unified `Utils::getPagePathFromToken()` method which is used by various plugins (Admin, Forms, Downloads, etc.)\n1. [](#improved)\n    * Optionally remove unpublished pages from the translated languages, move into untranslated list [#1482](https://github.com/getgrav/grav/pull/1482)\n    * Improved reliability of `hash` file-check method\n1. [](#bugfix)\n    * Updated to latest Toolbox library to fix issue with some blueprints rendering in admin plugin [#1117](https://github.com/getgrav/grav-plugin-admin/issues/1117)\n    * Fix output handling in RenderProcessor [#1483](https://github.com/getgrav/grav/pull/1483)\n\n# v1.3.0-rc.2\n## 05/17/2017\n\n1. [](#new)\n    * Added new `media` and `vardump` Twig functions\n1. [](#improved)\n    * Put in various checks to ensure Exif is available before trying to use it\n    * Add timestamp to configuration settings [#1445](https://github.com/getgrav/grav/pull/1445)\n1. [](#bugfix)\n    * Fix an issue saving YAML textarea fields in expert mode [#1480](https://github.com/getgrav/grav/pull/1480)\n    * Moved `onOutputRendered()` back into Grav core\n\n# v1.3.0-rc.1\n## 05/16/2017\n\n1. [](#new)\n    * Added support for a single array field in the forms\n    * Added EXIF support with automatic generation of Page Media metafiles\n    * Added Twig function to get EXIF data on any image file\n    * Added `Pages::baseUrl()`, `Pages::homeUrl()` and `Pages::url()` functions\n    * Added `base32_encode`, `base32_decode`, `base64_encode`, `base64_decode` Twig filters\n    * Added `Debugger::getCaller()` to figure out where the method was called from\n    * Added support for custom output providers like Slim Framework\n    * Added `Grav\\Framework\\Collection` classes for creating collections\n1. [](#improved)\n    * Add more controls over HTML5 video attributes (autoplay, poster, loop controls) [#1442](https://github.com/getgrav/grav/pull/1442)\n    * Removed logging statement for invalid slug [#1459](https://github.com/getgrav/grav/issues/1459)\n    * Groups selection pre-filled in user form\n    * Improve error handling in `Folder::move()`\n    * Added extra parameter for `Twig::processSite()` to include custom context\n    * Updated RocketTheme Toolbox vendor library\n1. [](#bugfix)\n    * Fix to force route/redirect matching from the start of the route by default [#1446](https://github.com/getgrav/grav/issues/1446)\n    * Edit check for valid slug [#1459](https://github.com/getgrav/grav/issues/1459)\n\n# v1.2.4\n## 04/24/2017\n\n1. [](#improved)\n    * Added optional ignores for `Installer::sophisticatedInstall()` [#1447](https://github.com/getgrav/grav/issues/1447)\n1. [](#bugfix)\n    * Allow multiple calls to `Themes::initTheme()` without throwing errors\n    * Fixed querystrings in root pages with multi-lang enabled [#1436](https://github.com/getgrav/grav/issues/1436)\n    * Allow support for `Pages::getList()` with `show_modular` option [#1080](https://github.com/getgrav/grav-plugin-admin/issues/1080)\n\n# v1.2.3\n## 04/19/2017\n\n1. [](#improved)\n    * Added new `pwd_regex` and `username_regex` system configuration options to allow format modifications\n    * Allow `user/accounts.yaml` overrides and implemented more robust theme initialization\n    * improved `getList()` method to do more powerful things\n    * Fix Typo in GPM [#1427](https://github.com/getgrav/grav/issues/1427)\n\n# v1.2.2\n## 04/11/2017\n\n1. [](#bugfix)\n    * Fix for redirects breaking [#1420](https://github.com/getgrav/grav/issues/1420)\n    * Fix issue in direct-install with github-style dependencies [#1405](https://github.com/getgrav/grav/issues/1405)\n\n# v1.2.1\n## 04/10/2017\n\n1. [](#improved)\n    * Added various `ancestor` helper methods in Page and Pages classes [#1362](https://github.com/getgrav/grav/pull/1362)\n    * Added new `parents` field and switched Page blueprints to use this\n    * Added `isajaxrequest()` Twig function [#1400](https://github.com/getgrav/grav/issues/1400)\n    * Added ability to inline CSS and JS code via Asset manager [#1377](https://github.com/getgrav/grav/pull/1377)\n    * Add query string in lighttpd default config [#1393](https://github.com/getgrav/grav/issues/1393)\n    * Add `--all-yes` and `--destination` options for `bin/gpm direct-install` [#1397](https://github.com/getgrav/grav/pull/1397)\n1. [](#bugfix)\n    * Fix for direct-install of plugins with `languages.yaml` [#1396](https://github.com/getgrav/grav/issues/1396)\n    * When determining language from HTTP_ACCEPT_LANGUAGE, also try base language only [#1402](https://github.com/getgrav/grav/issues/1402)\n    * Fixed a bad method signature causing warning when running tests on `GPMTest` object\n\n# v1.2.0\n## 03/31/2017\n\n1. [](#new)\n    * Added file upload for user avatar in user/admin blueprint\n1. [](#improved)\n    * Analysis fixes\n    * Switched to stable composer lib versions\n\n# v1.2.0-rc.3\n## 03/22/2017\n\n1. [](#new)\n    * Refactored Page re-ordering to handle all siblings at once\n    * Added `language_codes` to Twig init to allow for easy language name/code/native-name lookup\n1. [](#improved)\n    * Added an _Admin Overrides_ section with option to choose the order of children in Pages Management\n1. [](#bugfix)\n    * Fixed loading issues with improperly named themes (use old broken method first) [#1373](https://github.com/getgrav/grav/issues/1373)\n    * Simplified modular/twig processing logic and fixed an issue with system process config [#1351](https://github.com/getgrav/grav/issues/1351)\n    * Cleanup package files via GPM install to make them more windows-friendly [#1361](https://github.com/getgrav/grav/pull/1361)\n    * Fix for page-level debugger override changing the option site-wide\n    * Allow `url()` twig function to pass-through external links\n\n# v1.2.0-rc.2\n## 03/17/2017\n\n1. [](#improved)\n    * Updated vendor libraries to latest\n    * Added the ability to disable debugger on a per-page basis with `debugger: false` in page frontmatter\n1. [](#bugfix)\n    * Fixed an issue with theme inheritance and hyphenated base themes [#1353](https://github.com/getgrav/grav/issues/1353)\n    * Fixed an issue when trying to use an `@2x` derivative on a non-image media file [#1341](https://github.com/getgrav/grav/issues/1341)\n\n# v1.2.0-rc.1\n## 03/13/2017\n\n1. [](#new)\n    * Added default setting to only allow `direct-installs` from official GPM.  Can be configured in `system.yaml`\n    * Added a new `Utils::isValidUrl()` method\n    * Added optional parameter to `|markdown(false)` filter to toggle block/line processing (default|true = `block`)\n    * Added new `Page::folderExists()` method\n1. [](#improved)\n    * `Twig::evaluate()` now takes current environment and context into account\n    * Genericized `direct-install` so it can be called via Admin plugin\n1. [](#bugfix)\n    * Fixed a minor bug in Number validation [#1329](https://github.com/getgrav/grav/issues/1329)\n    * Fixed exception when trying to find user account and there is no `user://accounts` folder\n    * Fixed issue when setting `Page::expires(0)` [Admin #1009](https://github.com/getgrav/grav-plugin-admin/issues/1009)\n    * Removed ID from `nonce_field()` Twig function causing validation errors [Form #115](https://github.com/getgrav/grav-plugin-form/issues/115)\n\n# v1.1.17\n## 02/17/2017\n\n1. [](#bugfix)\n    * Fix for double extensions getting added during some redirects [#1307](https://github.com/getgrav/grav/issues/1307)\n    * Fix syntax error in PHP 5.3. Move the version check before requiring the autoloaded deps\n    * Fix Whoops displaying error page if there is PHP core warning or error [Admin #980](https://github.com/getgrav/grav-plugin-admin/issues/980)\n\n# v1.1.16\n## 02/10/2017\n\n1. [](#new)\n    * Exposed the Pages cache ID for use by plugins (e.g. Form) via `Pages::getPagesCacheId()`\n    * Added `Languages::resetFallbackPageExtensions()` regarding [#1276](https://github.com/getgrav/grav/pull/1276)\n1. [](#improved)\n    * Allowed CLI to use non-volatile cache drivers for better integration with CLI and Web caches\n    * Added Gantry5-compatible query information to Caddy configuration\n    * Added some missing docblocks and type-hints\n    * Various code cleanups (return types, missing variables in doclbocks, etc.)\n1. [](#bugfix)\n    * Fix blueprints slug validation [https://github.com/getgrav/grav-plugin-admin/issues/955](https://github.com/getgrav/grav-plugin-admin/issues/955)\n\n# v1.1.15\n## 01/30/2017\n\n1. [](#new)\n    * Added a new `Collection::merge()` method to allow merging of multiple collections [#1258](https://github.com/getgrav/grav/pull/1258)\n    * Added [OpenCollective](https://opencollective.com/grav) backer/sponsor info to `README.md`\n1. [](#improved)\n    * Add an additional parameter to GPM::findPackage to avoid throwing an exception, for use in Twig [#1008](https://github.com/getgrav/grav/issues/1008)\n    * Skip symlinks if found while clearing cache [#1269](https://github.com/getgrav/grav/issues/1269)\n1. [](#bugfix)\n    * Fixed an issue when page collection with header-based `sort.by` returns an array [#1264](https://github.com/getgrav/grav/issues/1264)\n    * Fix `Response` object to handle `303` redirects when `open_basedir` in effect [#1267](https://github.com/getgrav/grav/issues/1267)\n    * Silence `E_WARNING: Zend OPcache API is restricted by \"restrict_api\" configuration directive`\n\n# v1.1.14\n## 01/18/2017\n\n1. [](#bugfix)\n    * Fixed `Page::collection()` returning array and not Collection object when header variable did not exist\n    * Revert `Content-Encoding: identity` fix, and let you set `cache: allow_webserver_gzip:` option to switch to `identity` [#548](https://github.com/getgrav/grav/issues/548)\n\n# v1.1.13\n## 01/17/2017\n\n1. [](#new)\n    * Added new `never_cache_twig` page option in `system.yaml` and frontmatter. Allows dynamic Twig logic in regular and modular Twig templates [#1244](https://github.com/getgrav/grav/pull/1244)\n1. [](#improved)\n    * Several improvements to aid theme development [#232](https://github.com/getgrav/grav/pull/1232)\n    * Added `hash` cache check option and made dropdown more descriptive [Admin #923](https://github.com/getgrav/grav-plugin-admin/issues/923)\n1. [](#bugfix)\n    * Fixed cross volume file system operations [#635](https://github.com/getgrav/grav/issues/635)\n    * Fix issue with pages folders validation not accepting uppercase letters\n    * Fix renaming the folder name if the page, in the default language, had a custom slug set in its header\n    * Fixed issue with `Content-Encoding: none`. It should really be `Content-Encoding: identity` instead\n    * Fixed broken `hash` method on page modifications detection\n    * Fixed issue with multi-lang pages not caching independently without unique `.md` file [#1211](https://github.com/getgrav/grav/issues/1211)\n    * Fixed all `$_GET` parameters missing in Nginx (please update your nginx.conf) [#1245](https://github.com/getgrav/grav/issues/1245)\n    * Fixed issue in trying to process broken symlink [#1254](https://github.com/getgrav/grav/issues/1254)\n\n# v1.1.12\n## 12/26/2016\n\n1. [](#bugfix)\n    * Fixed issue with JSON calls throwing errors due to debugger enabled [#1227](https://github.com/getgrav/grav/issues/1227)\n\n# v1.1.11\n## 12/22/2016\n\n1. [](#improved)\n    * Fall back properly to HTML if template type not found\n1. [](#bugfix)\n    * Fix issue with modular pages folders validation [#900](https://github.com/getgrav/grav-plugin-admin/issues/900)\n\n# v1.1.10\n## 12/21/2016\n\n1. [](#improved)\n    * Improve detection of home path. Also allow `~/.grav` on Windows, drop `ConsoleTrait::isWindows()` method, used only for that [#1204](https://github.com/getgrav/grav/pull/1204)\n    * Reworked PHP CLI router [#1219](https://github.com/getgrav/grav/pull/1219)\n    * More robust theme/plugin logic in `bin/gpm direct-install`\n1. [](#bugfix)\n    * Fixed case where extracting a package would cause an error during rename\n    * Fix issue with using `Yaml::parse` direcly on a filename, now deprecated\n    * Add pattern for frontend validation of folder slugs [#891](https://github.com/getgrav/grav-plugin-admin/issues/891)\n    * Fix issue with Inflector when translation is disabled [SimpleSearch #87](https://github.com/getgrav/grav-plugin-simplesearch/issues/87)\n    * Explicitly expose `array_unique` Twig filter [Admin #897](https://github.com/getgrav/grav-plugin-admin/issues/897)\n\n# v1.1.9\n## 12/13/2016\n\n1. [](#new)\n    * RC released as stable\n1. [](#improved)\n    * Better error handling in cache clear\n    * YAML syntax fixes for the future compatibility\n    * Added new parameter `remove` for `onBeforeCacheClear` event\n    * Add support for calling Media object as function to get medium by filename\n1. [](#bugfix)\n    * Added checks before accessing admin reference during `Page::blueprints()` call. Allows to access `page.blueprints` from Twig in the frontend\n\n# v1.1.9-rc.3\n## 12/07/2016\n\n1. [](#new)\n    * Add `ignore_empty` property to be used on array fields, if positive only save options with a value\n    * Use new `permissions` field in user account\n    * Add `range(int start, int end, int step)` twig function to generate an array of numbers between start and end, inclusive\n    * New retina Media image derivatives array support (`![](image.jpg?derivatives=[640,1024,1440])`) [#1147](https://github.com/getgrav/grav/pull/1147)\n    * Added stream support for images (`![Sepia Image](image://image.jpg?sepia)`)\n    * Added stream support for links (`[Download PDF](user://data/pdf/my.pdf)`)\n    * Added new `onBeforeCacheClear` event to add custom paths to cache clearing process\n1. [](#improved)\n    * Added alias `selfupdate` to the `self-upgrade` `bin/gpm` CLI command\n    * Synced `webserver-configs/htaccess.txt` with `.htaccess`\n    * Use permissions field in group details.\n    * Updated vendor libraries\n    * Added a warning on GPM update to update Grav first if needed [#1194](https://github.com/getgrav/grav/pull/1194)\n 1. [](#bugfix)\n    * Fix page collections problem with `@page.modular` [#1178](https://github.com/getgrav/grav/pull/1178)\n    * Fix issue with using a multiple taxonomy filter of which one had no results, thanks to @hughbris [#1184](https://github.com/getgrav/grav/issues/1184)\n    * Fix saving permissions in group\n    * Fixed issue with redirect of a page getting moved to a different location\n\n# v1.1.9-rc.2\n## 11/26/2016\n\n1. [](#new)\n    * Added two new sort order options for pages: `publish_date` and `unpublish_date` [#1173](https://github.com/getgrav/grav/pull/1173))\n1. [](#improved)\n    * Multisite: Create image cache folder if it doesn't exist\n    * Add 2 new language values for French [#1174](https://github.com/getgrav/grav/issues/1174)\n1. [](#bugfix)\n    * Fixed issue when we have a meta file without corresponding media [#1179](https://github.com/getgrav/grav/issues/1179)\n    * Update class namespace for Admin class [Admin #874](https://github.com/getgrav/grav-plugin-admin/issues/874)\n\n# v1.1.9-rc.1\n## 11/09/2016\n\n1. [](#new)\n    * Added a `CompiledJsonFile` object to better handle Json files.\n    * Added Base32 encode/decode class\n    * Added a new `User::find()` method\n1. [](#improved)\n    * Moved `messages` object into core Grav from login plugin\n    * Added `getTaxonomyItemKeys` to the Taxonomy object [#1124](https://github.com/getgrav/grav/issues/1124)\n    * Added a `redirect_me` Twig function [#1124](https://github.com/getgrav/grav/issues/1124)\n    * Added a Caddyfile for newer Caddy versions [#1115](https://github.com/getgrav/grav/issues/1115)\n    * Allow to override sorting flags for page header-based or default ordering. If the `intl` PHP extension is loaded, only these flags are available: https://secure.php.net/manual/en/collator.asort.php. Otherwise, you can use the PHP standard sorting flags (https://secure.php.net/manual/en/array.constants.php) [#1169](https://github.com/getgrav/grav/issues/1169)\n1. [](#bugfix)\n    * Fixed an issue with site redirects/routes, not processing with extension (.html, .json, etc.)\n    * Don't truncate HTML if content length is less than summary size [#1125](https://github.com/getgrav/grav/issues/1125)\n    * Return max available number when calling random() on a collection passing an int > available items [#1135](https://github.com/getgrav/grav/issues/1135)\n    * Use correct ratio when applying image filters to image alternatives [#1147](https://github.com/getgrav/grav/issues/1147)\n    * Fixed URI path in multi-site when query parameters were used in front page\n\n# v1.1.8\n## 10/22/2016\n\n1. [](#bugfix)\n    * Fixed warning with unset `ssl` option when using GPM [#1132](https://github.com/getgrav/grav/issues/1132)\n\n# v1.1.7\n## 10/22/2016\n\n1. [](#improved)\n    * Improved the capabilities of Image derivatives [#1107](https://github.com/getgrav/grav/pull/1107)\n1. [](#bugfix)\n    * Only pass verify_peer settings to cURL and fopen if the setting is disabled [#1120](https://github.com/getgrav/grav/issues/1120)\n\n# v1.1.6\n## 10/19/2016\n\n1. [](#new)\n    * Added ability for Page to override the output format (`html`, `xml`, etc..) [#1067](https://github.com/getgrav/grav/issues/1067)\n    * Added `Utils::getExtensionByMime()` and cleaned up `Utils::getMimeByExtension` + tests\n    * Added a `cache.check.method: 'hash'` option in `system.yaml` that checks all files + dates inclusively\n    * Include jQuery 3.x in the Grav assets\n    * Added the option to automatically fix orientation on images based on their Exif data, by enabling `system.images.auto_fix_orientation`.\n1. [](#improved)\n    * Add `batch()` function to Page Collection class\n    * Added new `cache.redis.socket` setting that allow to pass a UNIX socket as redis server\n    * It is now possible to opt-out of the SSL verification via the new `system.gpm.verify_peer` setting. This is sometimes necessary when receiving a \"GPM Unable to Connect\" error. More details in ([#1053](https://github.com/getgrav/grav/issues/1053))\n    * It is now possible to force the use of either `curl` or `fopen` as `Response` connection method, via the new `system.gpm.method` setting. By default this is set to 'auto' and gives priority to 'fopen' first, curl otherwise.\n    * InstallCommand can now handle Licenses\n    * Uses more helpful `1x`, `2x`, `3x`, etc names in the Retina derivatives cache files.\n    * Added new method `Plugins::isPluginActiveAdmin()` to check if plugin route is active in Admin plugin\n    * Added new `Cache::setEnabled` and `Cache::getEnabled` to enable outside control of cache\n    * Updated vendor libs including Twig `1.25.0`\n    * Avoid git ignoring any vendor folder in a Grav site subfolder (but still ignore the main `vendor/` folder)\n    * Added an option to get just a route back from `Uri::convertUrl()` function\n    * Added option to control split session [#1096](https://github.com/getgrav/grav/pull/1096)\n    * Added new `verbosity` levels to `system.error.display` to allow for system error messages [#1091](https://github.com/getgrav/grav/pull/1091)\n    * Improved the API for Grav plugins to access the Parsedown parser directly [#1062](https://github.com/getgrav/grav/pull/1062)\n1. [](#bugfix)\n    * Fixed missing `progress` method in the DirectInstall Command\n    * `Response` class now handles better unsuccessful requests such as 404 and 401\n    * Fixed saving of `external` page types [Admin #789](https://github.com/getgrav/grav-plugin-admin/issues/789)\n    * Fixed issue deleting parent folder of folder with `param_sep` in the folder name [admin #796](https://github.com/getgrav/grav-plugin-admin/issues/796)\n    * Fixed an issue with streams in `bin/plugin`\n    * Fixed `jpeg` file format support in Media\n\n# v1.1.5\n## 09/09/2016\n\n1. [](#new)\n    * Added new `bin/gpm direct-install` command to install local and remote zip archives\n1. [](#improved)\n    * Refactored `onPageNotFound` event to fire after `onPageInitialized`\n    * Follow symlinks in `Folder::all()`\n    * Twig variable `base_url` now supports multi-site by path feature\n    * Improved `bin/plugin` to list plugins with commands faster by limiting the depth of recursion\n1. [](#bugfix)\n    * Quietly skip missing streams in `Cache::clearCache()`\n    * Fix issue in calling page.summary when no content is present in a page\n    * Fix for HUGE session timeouts [#1050](https://github.com/getgrav/grav/issues/1050)\n\n# v1.1.4\n## 09/07/2016\n\n1. [](#new)\n    * Added new `tmp` folder at root. Accessible via stream `tmp://`. Can be cleared with `bin/grav clear --tmp-only` as well as `--all`.\n    * Added support for RTL in `LanguageCodes` so you can determine if a language is RTL or not\n    * Ability to set `custom_base_url` in system configuration\n    * Added `override` and `force` options for Streams setup\n1. [](#improved)\n    * Important vendor updates to provide PHP 7.1 beta support!\n    * Added a `Util::arrayFlatten()` static function\n    * Added support for 'external_url' page header to enable easier external URL based menu items\n    * Improved the UI for CLI GPM Index view to use a table\n    * Added `@page.modular` Collection type [#988](https://github.com/getgrav/grav/issues/988)\n    * Added support for `self@`, `page@`, `taxonomy@`, `root@` Collection syntax for cleaner YAML compatibility\n    * Improved GPM commands to allow for `-y` to automate **yes** responses and `-o` for **update** and **selfupgrade** to overwrite installations [#985](https://github.com/getgrav/grav/issues/985)\n    * Added randomization to `safe_email` Twig filter for greater security [#998](https://github.com/getgrav/grav/issues/998)\n    * Allow `Utils::setDotNotation` to merge data, rather than just set\n    * Moved default `Image::filter()` to the `save` action to ensure they are applied last [#984](https://github.com/getgrav/grav/issues/984)\n    * Improved the `Truncator` code to be more reliable [#1019](https://github.com/getgrav/grav/issues/1019)\n    * Moved media blueprints out of core (now in Admin plugin)\n1. [](#bugfix)\n    * Removed 307 redirect code option as it is not well supported [#743](https://github.com/getgrav/grav-plugin-admin/issues/743)\n    * Fixed issue with folders with name `*.md` are not confused with pages [#995](https://github.com/getgrav/grav/issues/995)\n    * Fixed an issue when filtering collections causing null key\n    * Fix for invalid HTML when rendering GIF and Vector media [#1001](https://github.com/getgrav/grav/issues/1001)\n    * Use pages.markdown.extra in the user's system.yaml [#1007](https://github.com/getgrav/grav/issues/1007)\n    * Fix for `Memcached` connection [#1020](https://github.com/getgrav/grav/issues/1020)\n\n# v1.1.3\n## 08/14/2016\n\n1. [](#bugfix)\n    * Fix for lightbox media function throwing error [#981](https://github.com/getgrav/grav/issues/981)\n\n# v1.1.2\n## 08/10/2016\n\n1. [](#new)\n    * Allow forcing SSL by setting `system.force_ssl` (Force SSL in the Admin System Config) [#899](https://github.com/getgrav/grav/pull/899)\n1. [](#improved)\n    * Improved `authorize` Twig extension to accept a nested array of authorizations  [#948](https://github.com/getgrav/grav/issues/948)\n    * Don't add timestamps on remote assets as it can cause conflicts\n    * Grav now looks at types from `media.yaml` when retrieving page mime types [#966](https://github.com/getgrav/grav/issues/966)\n    * Added support for dumping exceptions in the Debugger\n1. [](#bugfix)\n    * Fixed `Folder::delete` method to recursively remove files and folders and causing Upgrade to fail.\n    * Fix [#952](https://github.com/getgrav/grav/issues/952) hyphenize the session name.\n    * If no parent is set and siblings collection is called, return a new and empty collection [grav-plugin-sitemap/issues/22](https://github.com/getgrav/grav-plugin-sitemap/issues/22)\n    * Prevent exception being thrown when calling the Collator constructor failed in a Windows environment with the Intl PHP Extension enabled [#961](https://github.com/getgrav/grav/issues/961)\n    * Fix for markdown images not properly rendering `id` attribute [#956](https://github.com/getgrav/grav/issues/956)\n\n# v1.1.1\n## 07/16/2016\n\n1. [](#improved)\n    * Made `paramsRegex()` static to allow it to be called statically\n1. [](#bugfix)\n    * Fixed backup when using very long site titles with invalid characters [grav-plugin-admin#701](https://github.com/getgrav/grav-plugin-admin/issues/701)\n    * Fixed a typo in the `webserver-configs/nginx.conf` example\n\n# v1.1.0\n## 07/14/2016\n\n1. [](#improved)\n    * Added support for validation of multiple email in the `type: email` field [grav-plugin-email#31](https://github.com/getgrav/grav-plugin-email/issues/31)\n    * Unified PHP code header styling\n    * Added 6 more languages and updated language codes\n    * set default \"releases\" option to `stable`\n1. [](#bugfix)\n    * Fix backend validation for file fields marked as required [grav-plugin-form#78](https://github.com/getgrav/grav-plugin-form/issues/78)\n\n# v1.1.0-rc.3\n## 06/21/2016\n\n1. [](#new)\n    * Add a onPageFallBackUrl event when starting the fallbackUrl() method to allow the Login plugin to protect the page media\n    * Conveniently allow ability to retrieve user information via config object [#913](https://github.com/getgrav/grav/pull/913) - @Vivalldi\n    * Grav served images can now use header caching [#905](https://github.com/getgrav/grav/pull/905)\n1. [](#improved)\n    * Take asset modification timestamp into consideration in pipelining [#917](https://github.com/getgrav/grav/pull/917) - @Sommerregen\n1. [](#bugfix)\n    * Respect `enable_asset_timestamp` settings for pipelined Assets [#906](https://github.com/getgrav/grav/issues/906)\n    * Fixed collections end dates for 32-bit systems [#902](https://github.com/getgrav/grav/issues/902)\n    * Fixed a recent regression (1.1.0-rc1) with parameter separator different than `:`\n\n# v1.1.0-rc.2\n## 06/14/2016\n\n1. [](#new)\n    * Added getters and setters for Assets to allow manipulation of CSS/JS/Collection based assets via plugins [#876](https://github.com/getgrav/grav/issues/876)\n1. [](#improved)\n    * Pass the exception to the `onFatalException()` event\n    * Updated to latest jQuery 2.2.4 release\n    * Moved list items in `system/config/media.yaml` config into a `types:` key which allows you delete default items.\n    * Updated `webserver-configs/nginx.conf` with `try_files` fix from @mrhein and @rondlite [#743](https://github.com/getgrav/grav/pull/743)\n    * Updated cache references to include `memecache` and `redis` [#887](https://github.com/getgrav/grav/issues/887)\n    * Updated composer libraries\n1. [](#bugfix)\n    * Fixed `Utils::normalizePath()` that was truncating 0's [#882](https://github.com/getgrav/grav/issues/882)\n\n# v1.1.0-rc.1\n## 06/01/2016\n\n1. [](#new)\n    * Added `Utils::getDotNotation()` and `Utils::setDotNotation()` methods + tests\n    * Added support for `xx-XX` locale language lookups in `LanguageCodes` class [#854](https://github.com/getgrav/grav/issues/854)\n    * New CSS/JS Minify library that does a more reliable job [#864](https://github.com/getgrav/grav/issues/864)\n1. [](#improved)\n    * GPM installation of plugins and themes into correct multisite folders [#841](https://github.com/getgrav/grav/issues/841)\n    * Use `Page::rawRoute()` in blueprints for more reliable mulit-language support\n1. [](#bugfix)\n    * Fixes for `zlib.output_compression` as well as `mod_deflate` GZIP compression\n    * Fix for corner-case redirect logic causing infinite loops and out-of-memory errors\n    * Fix for saving fields in expert mode that have no `Validation::typeX()` methods [#626](https://github.com/getgrav/grav-plugin-admin/issues/626)\n    * Detect if user really meant to extend parent blueprint, not another one (fixes old page type blueprints)\n    * Fixed a bug in `Page::relativePagePath()` when `Page::$name` is not defined\n    * Fix for poor handling of params + query element in `Uri::processParams()` [#859](https://github.com/getgrav/grav/issues/859)\n    * Fix for double encoding in markdown links [#860](https://github.com/getgrav/grav/issues/860)\n    * Correctly handle language strings to determine if it's in admin or not [#627](https://github.com/getgrav/grav-plugin-admin/issues/627)\n\n# v1.1.0-beta.5\n## 05/23/2016\n\n1. [](#improved)\n    * Updated jQuery from 2.2.0 to 2.2.3\n    * Set `Uri::ip()` to static by default so it can be used in form fields\n    * Improved `Session` class with flash storage\n    * `Page::getContentMeta()` now supports an optional key.\n1. [](#bugfix)\n    * Fixed \"Invalid slug set in YAML frontmatter\" when setting `Page::slug()` with empty string [#580](https://github.com/getgrav/grav-plugin-admin/issues/580)\n    * Only `.gitignore` Grav's vendor folder\n    * Fix trying to remove Grav with `GPM uninstall` of a plugin with Grav dependency\n    * Fix Page Type blueprints not being able to extend their parents\n    * `filterFile` validation method always returns an array of files, behaving like `multiple=\"multiple\"`\n    * Fixed [#835](https://github.com/getgrav/grav-plugin-admin/issues/835) check for empty image file first to prevent getimagesize() fatal error\n    * Avoid throwing an error when Grav's Gzip and mod_deflate are enabled at the same time on a non php-fpm setup\n\n# v1.1.0-beta.4\n## 05/09/2016\n\n1. [](#bugfix)\n    * Drop dependencies calculations if plugin is installed via symlink\n    * Drop Grav from dependencies calculations\n    * Send slug name as part of installed packages\n    * Fix for summary entities not being properly decoded [#825](https://github.com/getgrav/grav/issues/825)\n\n\n# v1.1.0-beta.3\n## 05/04/2016\n\n1. [](#improved)\n    * Pass the Page type when calling `onBlueprintCreated`\n    * Changed `Page::cachePageContent()` form **private** to **public** so a page can be recached via plugin\n1. [](#bugfix)\n    * Fixed handling of `{'loading':'async'}` with Assets Pipeline\n    * Fix for new modular page modal `Page` field requiring a value [#529](https://github.com/getgrav/grav-plugin-admin/issues/529)\n    * Fix for broken `bin/gpm version` command\n    * Fix handling \"grav\" as a dependency\n    * Fix when installing multiple packages and one is the dependency of another, don't try to install it twice\n    * Fix using name instead of the slug to determine a package folder. Broke for packages whose name was 2+ words\n\n# v1.1.0-beta.2\n## 04/27/2016\n\n1. [](#new)\n    * Added new `Plugin::getBlueprint()` and `Theme::getBlueprint()` method\n    * Allow **page blueprints** to be added via Plugins.\n1. [](#improved)\n    * Moved to new `data-*@` format in blueprints\n    * Updated composer-based libraries\n    * Moved some hard-coded `CACHE_DIR` references to use locator\n    * Set `twig.debug: true` by default\n1. [](#bugfix)\n    * Fixed issue with link rewrites and local assets pipeline with `absolute_urls: true`\n    * Allow Cyrillic slugs [#520](https://github.com/getgrav/grav-plugin-admin/issues/520)\n    * Fix ordering issue with accented letters [#784](https://github.com/getgrav/grav/issues/784)\n    * Fix issue with Assets pipeline and missing newlines causing invalid JavaScript\n\n# v1.1.0-beta.1\n## 04/20/2016\n\n1. [](#new)\n    * **Blueprint Improvements**: The main improvements to Grav take the form of a major rewrite of our blueprint functionality. Blueprints are an essential piece of functionality within Grav that helps define configuration fields. These allow us to create a definition of a form field that can be rendered in the administrator plugin and allow the input, validation, and storage of values into the various configuration and page files that power Grav. Grav 1.0 had extensive support for building and extending blueprints, but Grav 1.1 takes this even further and adds improvements to our existing system.\n    * **Extending Blueprints**: You could extend forms in Grav 1.0, but now you can use a newer `extends@:` default syntax rather than the previous `'@extends'` string that needed to be quoted in YAML. Also this new format allows for the defining of a `context` which lets you define where to look for the base blueprint. Another new feature is the ability to extend from multiple blueprints.\n    * **Embedding/Importing Blueprints**: One feature that has been requested is the ability to embed or import one blueprint into another blueprint. This allows you to share fields or sub-form between multiple forms. This is accomplished via the `import@` syntax.\n    * **Removing Existing Fields and Properties**: Another new feature is the ability to remove completely existing fields or properties from an extended blueprint. This allows the user a lot more flexibility when creating custom forms by simply using the new `unset@: true` syntax. To remove a field property you would use `unset-<property>@: true` in your extended field definition, for example: `unset-options@: true`.\n    * **Replacing Existing Fields and Properties**: Similar to removing, you can now replace an existing field or property with the `replace@: true` syntax for the whole field, and `replace-<property>@: true` for a specific property.\n    * **Field Ordering**: Probably the most frequently requested blueprint functionality that we have added is the ability to change field ordering. Imagine that you want to extend the default page blueprint but add a new tab. Previously, this meant your tab would be added at the end of the form, but now you can define that you wish the new tab to be added right after the `content` tab. This works for any field too, so you can extend a blueprint and add your own custom fields anywhere you wish! This is accomplished by using the new `ordering@:` syntax with either an existing property name or an integer.\n    * **Configuration Properties**: Another useful new feature is the ability to directly access Grav configuration in blueprints with `config-<property>@` syntax. For example you can set a default for a field via `config-default@: site.author.name` which will use the author.name value from the `site.yaml` file as the `default` value for this field.\n    * **Function Calls**: The ability to call PHP functions for values has been improved in Grav 1.1 to be more powerful. You can use the `data-<property>@` syntax to call static methods to obtain values. For example: `data-default@: '\\Grav\\Plugin\\Admin::route'`. You can now even pass parameters to these methods.\n    * **Validation Rules**: You can now define a custom blueprint-level validation rule and assign this rule to a form field.\n    * **Custom Form Field Types**: This advanced new functionality allows you to create a custom field type via a new plugin event called getFormFieldTypes(). This allows you to provide extra functionality or instructions on how to handle the form form field.\n    * **GPM Versioning**: A new feature that we have wanted to add to our GPM package management system is the ability to control dependencies by version. We have opted to use a syntax very similar to the Composer Package Manager that is already familiar to most PHP developers. This new versioning system allows you to define specific minimum version requirements of dependent packages within Grav. This should ensure that we have less (hopefully none!) issues when you update one package that also requires a specific minimum version of another package. The admin plugin for example may have an update that requires a specific version of Grav itself.\n    * **GPM Testing Channel**: GPM repository now comes with both a `stable` and `testing` channel. A new setting in `system.gpm.releases` allow to switch between the two channels. Developers will be able to decide whether their resource is going to be in a pre-release state or stable. Only users who switch to the **testing** channel will be able to install a pre-release version.\n    * **GPM Events**: Packages (plugins and themes) can now add event handlers to hook in the package GPM events: install, update, uninstall. A package can listen for events before and after each of these events, and can execute any PHP code, and optionally halt the procedure or return a message.\n    * Refactor of the process chain breaking out `Processors` into individual classes to allow for easier modification and addition. Thanks to toovy for this work. - [#745](https://github.com/getgrav/grav/pull/745)\n    * Added multipart downloads, resumable downloads, download throttling, and video streaming in the `Utils::download()` method.\n    * Added optional config to allow Twig processing in page frontmatter - [#788](https://github.com/getgrav/grav/pull/788)\n    * Added the ability to provide blueprints via a plugin (previously limited to Themes only).\n    * Added Developer CLI Tools to easily create a new theme or plugin\n    * Allow authentication for proxies - [#698](https://github.com/getgrav/grav/pull/698)\n    * Allow to override the default Parsedown behavior - [#747](https://github.com/getgrav/grav/pull/747)\n    * Added an option to allow to exclude external files from the pipeline, and to render the pipeline before/after excluded files\n    * Added the possibility to store translations of themes in separate files inside the `languages` folder\n    * Added a method to the Uri class to return the base relative URL including the language prefix, or the base relative url if multilanguage is not enabled\n    * Added a shortcut for pages.find() alias\n1. [](#improved)\n    * Now supporting hostnames with localhost environments for better vhost support/development\n    * Refactor hard-coded paths to use PHP Streams that allow a setup file to configure where certain parts of Grav are stored in the physical filesystem.\n    * If multilanguage is active, include the Intl Twig Extension to allow translating dates automatically (http://twig.sensiolabs.org/doc/extensions/intl.html)\n    * Allow having local themes with the same name as GPM themes, by adding `gpm: false` to the theme blueprint - [#767](https://github.com/getgrav/grav/pull/767)\n    * Caddyfile and Lighttpd config files updated\n    * Removed `node_modules` folder from backups to make them faster\n    * Display error when `bin/grav install` hasn't been run instead of throwing exception. Prevents \"white page\" errors if error display is off\n    * Improved command line flow when installing multiple packages: don't reinstall packages if already installed, ask once if should use symlinks if symlinks are found\n    * Added more tests to our testing suite\n    * Added x-ua-compatible to http_equiv metadata processing\n    * Added ability to have a per-page `frontmatter.yaml` file to set header frontmatter defaults. Especially useful for multilang scenarios - [#775](https://github.com/getgrav/grav/pull/775)\n    * Removed deprecated `bin/grav newuser` CLI command.  use `bin/plugin login newuser` instead.\n    * Added `webm` and `ogv` video types to the default media types list.\n1. [](#bugfix)\n    * Fix Zend Opcache `opcache.validate_timestamps=0` not detecting changes in compiled yaml and twig files\n    * Avoid losing params, query and fragment from the URL when auto-redirecting to a language-specific route - [#759](https://github.com/getgrav/grav/pull/759)\n    * Fix for non-pipeline assets getting lost when pipeline is cached to filesystem\n    * Fix for double encoding resulting from Markdown Extra\n    * Fix for a remote link breaking all CSS rewrites for pipeline\n    * Fix an issue with Retina alternatives not clearing properly between repeat uses\n    * Fix for non standard http/s external markdown links - [#738](https://github.com/getgrav/grav/issues/738)\n    * Fix for `find()` calling redirects via `dispatch()` causing infinite loops - [#781](https://github.com/getgrav/grav/issues/781)\n\n# v1.0.10\n## 02/11/2016\n\n1. [](#new)\n    * Added new `Page::contentMeta()` mechanism to store content-level meta data alongside content\n    * Added Japanese language translation\n1. [](#improved)\n    * Updated some vendor libraries\n1. [](#bugfix)\n    * Hide `streams` blueprint from Admin plugin\n    * Fix translations of languages with `---` in YAML files\n\n# v1.0.9\n## 02/05/2016\n\n1. [](#new)\n    * New **Unit Testing** via Codeception http://codeception.com/\n    * New **page-level SSL** functionality when using `absolute_urls`\n    * Added `reverse_proxy` config option for issues with non-standard ports\n    * Added `proxy_url` config option to support GPM behind proxy servers #639\n    * New `Pages::parentsRawRoutes()` method\n    * Enhanced `bin/gpm info` CLI command with Changelog support #559\n    * Ability to add empty *Folder* via admin plugin\n    * Added latest `jQuery 2.2.0` library to core\n    * Added translations from Crowdin\n1. [](#improved)\n    * [BC] Metadata now supports only flat arrays. To use open graph metas and the likes (ie, 'og:title'), simply specify it in the key.\n    * Refactored `Uri::convertUrl()` method to be more reliable + tests created\n    * Date for last update of a modular sub-page sets modified date of modular page itself\n    * Split configuration up into two steps\n    * Moved Grav-based `base_uri` variables into `Uri::init()`\n    * Refactored init in `URI` to better support testing\n    * Allow `twig_vars` to be exposed earlier and merged later\n    * Avoid setting empty metadata\n    * Accept single group access as a string rather than requiring an array\n    * Return `$this` in Page constructor and init to allow chaining\n    * Added `ext-*` PHP requirements to `composer.json`\n    * Use Whoops 2.0 library while supporting old style\n    * Removed redundant old default-hash fallback mechanisms\n    * Commented out default redirects and routes in `site.yaml`\n    * Added `/tests` folder to deny's of all `webserver-configs/*` files\n    * Various PS and code style fixes\n1. [](#bugfix)\n    * Fix default generator metadata\n    * Fix for broken image processing caused by `Uri::convertUrl()` bugs\n    * Fix loading JS and CSS from collections #623\n    * Fix stream overriding\n    * Remove the URL extension for home link\n    * Fix permissions when the user has no access level set at all\n    * Fix issue with user with multiple groups getting denied on first group\n    * Fixed an issue with `Pages()` internal cache lookup not being unique enough\n    * Fix for bug with `site.redirects` and `site.routes` being an empty list\n    * [Markdown] Don't process links for **special protocols**\n    * [Whoops] serve JSON errors when request is JSON\n\n\n# v1.0.8\n## 01/08/2016\n\n1. [](#new)\n    * Added `rotate`, `flip` and `fixOrientation` image medium methods\n1. [](#bugfix)\n    * Removed IP from Nonce generation. Should be more reliable in a variety of scenarios\n\n# v1.0.7\n## 01/07/2016\n\n1. [](#new)\n    * Added `composer create-project` as an additional installation method #585\n    * New optional system config setting to strip home from page routs and urls #561\n    * Added Greek, Finnish, Norwegian, Polish, Portuguese, and Romanian languages\n    * Added new `Page->topParent()` method to return top most parent of a page\n    * Added plugins configuration tab to debugger\n    * Added support for APCu and PHP7.0 via new Doctrine Cache release\n    * Added global setting for `twig_first` processing (false by default)\n    * New configuration options for Session settings #553\n1. [](#improved)\n    * Switched to SSL for GPM calls\n    * Use `URI->host()` for session domain\n    * Add support for `open_basedir` when installing packages via GPM\n    * Improved `Utils::generateNonceString()` method to handle reverse proxies\n    * Optimized core thumbnails saving 38% in file size\n    * Added new `bin/gpm index --installed-only` option\n    * Improved GPM errors to provider more helpful diagnostic of issues\n    * Removed old hardcoded PHP version references\n    * Moved `onPageContentProcessed()` event so it's fired more reliably\n    * Maintain md5 keys during sorting of Assets #566\n    * Update to Caddyfile for Caddy web server\n1. [](#bugfix)\n    * Fixed an issue with cache/config checksum not being set on cache load\n    * Fix for page blueprint and theme inheritance issue #534\n    * Set `ZipBackup` timeout to 10 minutes if possible\n    * Fix case where we only have inline data for CSS or JS  #565\n    * Fix `bin/grav sandbox` command to work with new `webserver-config` folder\n    * Fix for markdown attributes on external URLs\n    * Fixed issue where `data:` page header was acting as `publish_date:`\n    * Fix for special characters in URL parameters (e.g. /tag:c++) #541\n    * Safety check for an array of nonces to only use the first one\n\n# v1.0.6\n## 12/22/2015\n\n1. [](#new)\n    * Set minimum requirements to [PHP 5.5.9](http://bit.ly/1Jt9OXO)\n    * Added `saveConfig` to Themes\n1. [](#improved)\n    * Updated Whoops to new 2.0 version (PHP 7.0 compatible)\n    * Moved sample web server configs into dedicated directory\n    * FastCGI will use Apache's `mod_deflate` if gzip turned off\n1. [](#bugfix)\n    * Fix broken media image operators\n    * Only call extra method of blueprints if blueprints exist\n    * Fix lang prefix in url twig variables #523\n    * Fix case insensitive HTTPS check #535\n    * Field field validation handles case `multiple` missing\n\n# v1.0.5\n## 12/18/2015\n\n1. [](#new)\n    * Add ability to extend markdown with plugins\n    * Added support for plugins to have individual language files\n    * Added `7z` to media formats\n    * Use Grav's fork of Parsedown until PR is merged\n    * New function to persist plugin configuration to disk\n    * GPM `selfupgrade` will now check PHP version requirements\n1. [](#improved)\n    * If the field allows multiple files, return array\n    * Handle non-array values in file validation\n1. [](#bugfix)\n    * Fix when looping `fields` param in a `list` field\n    * Properly convert commas to spaces for media attributes\n    * Forcing Travis VM to HI timezone to address future files in zip file\n\n# v1.0.4\n## 12/12/2015\n\n1. [](#bugfix)\n    * Needed to put default image folder permissions for YAML compatibility\n\n# v1.0.3\n## 12/11/2015\n\n1. [](#bugfix)\n    * Fixed issue when saving config causing incorrect image cache folder perms\n\n# v1.0.2\n## 12/11/2015\n\n1. [](#bugfix)\n    * Fix for timing display in debugbar\n\n# v1.0.1\n## 12/11/2015\n\n1. [](#improved)\n    * Reduced package sizes by removing extra vendor dev bits\n1. [](#bugfix)\n    * Fix issue when you enable debugger from admin plugin\n\n# v1.0.0\n## 12/11/2015\n\n1. [](#new)\n    * Add new link attributes via markdown media\n    * Added setters to set state of CSS/JS pipelining\n    * Added `user/accounts` to `.gitignore`\n    * Added configurable permissions option for Image cache\n1. [](#improved)\n    * Hungarian translation updated\n    * Refactored Theme initialization for improved flexibility\n    * Wrapped security section of account blueprints in an 'super user' authorize check\n    * Minor performance optimizations\n    * Updated core page blueprints with markdown preview option\n    * Added useful cache info output to Debugbar\n    * Added `iconv` polyfill library used by Symfony 2.8\n    * Force lowercase of username in a few places for case sensitive filesystems\n1. [](#bugfix)\n    * Fix for GPM problems \"Call to a member function set() on null\"\n    * Fix for individual asset pipeline values not functioning\n    * Fix `Page::copy()` and `Page::move()` to support multiple moves at once\n    * Fixed page moving of a page with no content\n    * Fix for wrong ordering when moving many pages\n    * Escape root path in page medium files to work with special characters\n    * Add missing parent constructor to Themes class\n    * Fix missing file error in `bin/grav sandbox` command\n    * Fixed changelog differ when upgrading Grav\n    * Fixed a logic error in `Validation->validate()`\n    * Make `$container` available in `setup.php` to fix multi-site\n\n# v1.0.0-rc.6\n## 12/01/2015\n\n1. [](#new)\n    * Refactor Config classes for improved performance!\n    * Refactor Data classes to use `NestedArrayAccess` instead of `DataMutatorTrait`\n    * Added support for `classes` and `id` on medium objects to set CSS values\n    * Data objects: Allow function call chaining\n    * Data objects: Lazy load blueprints only if needed\n    * Automatically create unique security salt for each configuration\n    * Added Hungarian translation\n    * Added support for User groups\n1. [](#improved)\n    * Improved robots.txt to disallow crawling of non-user folders\n    * Nonces only generated once per action and process\n    * Added IP into Nonce string calculation\n    * Nonces now use random string with random salt to improve performance\n    * Improved list form handling #475\n    * Vendor library updates\n1. [](#bugfix)\n    * Fixed help output for `bin/plugin`\n    * Fix for nested logic for lists and form parsing #273\n    * Fix for array form fields and last entry not getting deleted\n    * Should not be able to set parent to self #308\n\n# v1.0.0-rc.5\n## 11/20/2015\n\n1. [](#new)\n    * Added **nonce** functionality for all admin forms for improved security\n    * Implemented the ability for Plugins to provide their own CLI commands through `bin/plugin`\n    * Added Croatian translation\n    * Added missing `umask_fix` property to `system.yaml`\n    * Added current theme's config to global config. E.g. `config.theme.dropdown_enabled`\n    * Added `append_url_extension` option to system config & page headers\n    * Users have a new `state` property to allow disabling/banning\n    * Added new `Page.relativePagePath()` helper method\n    * Added new `|pad` Twig filter for strings (uses `str_pad()`)\n    * Added `lighttpd.conf` for Lightly web server\n1. [](#improved)\n    * Clear previously applied operations when doing a reset on image media\n    * Password no longer required when editing user\n    * Improved support for trailing `/` URLs\n    * Improved `.nginx.conf` configuration file\n    * Improved `.htaccess` security\n    * Updated vendor libs\n    * Updated `composer.phar`\n    * Use streams instead of paths for `clearCache()`\n    * Use PCRE_UTF8 so unicode strings can be regexed in Truncator\n    * Handle case when login plugin is disabled\n    * Improved `quality` functionality in media handling\n    * Added some missing translation strings\n    * Deprecated `bin/grav newuser` in favor of `bin/plugin login new-user`\n    * Moved fallback types to use any valid media type\n    * Renamed `system.pages.fallback_types` to `system.media.allowed_fallback_types`\n    * Removed version number in default `generator` meta tag\n    * Disable time limit in case of slow downloads\n    * Removed default hash in `system.yaml`\n1. [](#bugfix)\n    * Fix for media using absolute URLs causing broken links\n    * Fix theme auto-loading #432\n    * Don't create empty `<style>` or `<script>` scripts if no data\n    * Code cleanups\n    * Fix undefined variable in Config class\n    * Fix exception message when label is not set\n    * Check in `Plugins::get()` to ensure plugins exists\n    * Fixed GZip compression making output buffering work correctly with all servers and browsers\n    * Fixed date representation in system config\n\n# v1.0.0-rc.4\n## 10/29/2015\n\n1. [](#bugfix)\n    * Fixed a fatal error if you have a collection with missing or invalid `@page: /route`\n\n# v1.0.0-rc.3\n## 10/29/2015\n\n1. [](#new)\n    * New Page collection options! `@self.parent, @self.siblings, @self.descendants` + more\n    * White list of file types for fallback route functionality (images by default)\n1. [](#improved)\n    * Assets switched from defines to streams\n1. [](#bugfix)\n    * README.md typos fixed\n    * Fixed issue with routes that have lang string in them (`/en/english`)\n    * Trim strings before validation so whitespace is not satisfy 'required'\n\n# v1.0.0-rc.2\n## 10/27/2015\n\n1. [](#new)\n    * Added support for CSS Asset groups\n    * Added a `wrapped_site` system option for themes/plugins to use\n    * Pass `Page` object as event to `onTwigPageVariables()` event hook\n    * New `Data.items()` method to get all items\n1. [](#improved)\n    * Missing pipelined remote asset will now fail quietly\n    * More reliably handle inline JS and CSS to remove only surrounding HTML tags\n    * `Medium.meta` returns new Data object so null checks are possible\n    * Improved Medium metadata merging to allow for automatic title/alt/class attributes\n    * Moved Grav object to global variable rather than template variable (useful for macros)\n    * German language improvements\n    * Updated bundled composer\n1. [](#bugfix)\n    * Accept variety of `true` values in `User.authorize()` method\n    * Fix for `Validation` throwing an error if no label set\n\n# v1.0.0-rc.1\n## 10/23/2015\n\n1. [](#new)\n    * Use native PECL YAML parser if installed for 4X speed boost in parsing YAML files\n    * Support for inherited theme class\n    * Added new default language prepend system configuration option\n    * New `|evaluate` Twig filter to evaluate a string as twig\n    * New system option to ignore all **hidden** files and folders\n    * New system option for default redirect code\n    * Added ability to append specific `[30x]` codes to redirect URLs\n    * Added `url_taxonomy_filters` for page collections\n    * Added `@root` page and `recurse` flag for page collections\n    * Support for **multiple** page collection types as an array\n    * Added Dutch language file\n    * Added Russian language file\n    * Added `remove` method to User object\n1. [](#improved)\n    * Moved hardcoded mimetypes to `media.yaml` to be treated as Page media files\n    * Set `errors: display: false` by default in `system.yaml`\n    * Strip out extra slashes in the URI\n    * Validate hostname to ensure it is valid\n    * Ignore more SCM folders in Backups\n    * Removed `home_redirect` settings from `system.yaml`\n    * Added Page `media` as root twig object for consistency\n    * Updated to latest vendor libraries\n    * Optimizations to Asset pipeline logic for minor speed increase\n    * Block direct access to a variety of files in `.htaccess` for increased security\n    * Debugbar vendor library update\n    * Always fallback to english if other translations are not available\n1. [](#bugfix)\n    * Fix for redirecting external URL with multi-language\n    * Fix for Asset pipeline not respecting asset groups\n    * Fix language files with child/parent theme relationships\n    * Fixed a regression issue resulting in incorrect default language\n    * Ensure error handler is initialized before URI is processed\n    * Use default language in Twig if active language is not set\n    * Fixed issue with `safeEmailFilter()` Twig filter not separating with `;` properly\n    * Fixed empty YAML file causing error with native PECL YAML parser\n    * Fixed `SVG` mimetype\n    * Fixed incorrect `Cache-control: max-age` value format\n\n# v0.9.45\n## 10/08/2015\n\n1. [](#bugfix)\n    * Fixed a regression issue resulting in incorrect default language\n\n# v0.9.44\n## 10/07/2015\n\n1. [](#new)\n    * Added Redis back as a supported cache mechanism\n    * Allow Twig `nicetime` translations\n    * Added `-y` option for 'Yes to all' in `bin/gpm update`\n    * Added CSS `media` attribute to the Assets manager\n    * New German language support\n    * New Czech language support\n    * New French language support\n    * Added `modulus` twig filter\n1. [](#improved)\n    * URL decode in medium actions to allow complex syntax\n    * Take into account `HTTP_HOST` before `SERVER_NAME` (helpful with Nginx)\n    * More friendly cache naming to ease manual management of cache systems\n    * Added default Apache resource for `DirectoryIndex`\n1. [](#bugfix)\n    * Fix GPM failure when offline\n    * Fix `open_basedir` error in `bin/gpm install`\n    * Fix an HHVM error in Truncator\n    * Fix for XSS vulnerability with params\n    * Fix chaining for responsive size derivatives\n    * Fix for saving pages when removing the page title and all other header elements\n    * Fix when saving array fields\n    * Fix for ports being included in `HTTP_HOST`\n    * Fix for Truncator to handle PHP tags gracefully\n    * Fix for locate style lang codes in `getNativeName()`\n    * Urldecode image basenames in markdown\n\n# v0.9.43\n## 09/16/2015\n\n1. [](#new)\n    * Added new `AudioMedium` for HTML5 audio\n    * Added ability for Assets to be added and displayed in separate *groups*\n    * New support for responsive image derivative sizes\n1. [](#improved)\n    * GPM theme install now uses a `copy` method so new files are not lost (e.g. `/css/custom.css`)\n    * Code analysis improvements and cleanup\n    * Removed Twig panel from debugger (no longer supported in Twig 1.20)\n    * Updated composer packages\n    * Prepend active language to `convertUrl()` when used in markdown links\n    * Added some pre/post flight options for installer via blueprints\n    * Hyphenize the site name in the backup filename\n1. [](#bugfix)\n    * Fix broken routable logic\n    * Check for `phpinfo()` method in case it is restricted by hosting provider\n    * Fixes for windows when running GPM\n    * Fix for ampersand (`&`) causing error in `truncateHtml()` via `Page.summary()`\n\n# v0.9.42\n## 09/11/2015\n\n1. [](#bugfix)\n    * Fixed `User.authorise()` to be backwards compabile\n\n# v0.9.41\n## 09/11/2015\n\n1. [](#new)\n    * New and improved multibyte-safe TruncateHTML function and filter\n    * Added support for custom page date format\n    * Added a `string` Twig filter to render as json_encoded string\n    * Added `authorize` Twig filter\n    * Added support for theme inheritance in the admin\n    * Support for multiple content collections on a page\n    * Added configurable files/folders ignores for pages\n    * Added the ability to set the default PHP locale and override via multi-lang configuration\n    * Added ability to save as YAML via admin\n    * Added check for `mbstring` support\n    * Added new `redirect` header for pages\n1. [](#improved)\n    * Changed dependencies from `develop` to `master`\n    * Updated logging to log everything from `debug` level on (was `warning`)\n    * Added missing `accounts/` folder\n    * Default to performing a 301 redirect for URIs with trailing slashes\n    * Improved Twig error messages\n    * Allow validating of forms from anywhere such as plugins\n    * Added logic so modular pages are by default non-routable\n    * Hide password input in `bin/grav newuser` command\n1. [](#bugfix)\n    * Fixed `Pages.all()` not returning modular pages\n    * Fix for modular template types not getting found\n    * Fix for `markdown_extra:` overriding `markdown:extra:` setting\n    * Fix for multi-site routing\n    * Fix for multi-lang page name error\n    * Fixed a redirect loop in `URI` class\n    * Fixed a potential error when `unsupported_inline_types` is empty\n    * Correctly generate 2x retina image\n    * Typo fixes in page publish/unpublish blueprint\n\n# v0.9.40\n## 08/31/2015\n\n1. [](#new)\n    * Added some new Twig filters: `defined`, `rtrim`, `ltrim`\n    * Admin support for customizable page file name + template override\n1. [](#improved)\n    * Better message for incompatible/unsupported Twig template\n    * Improved User blueprints with better help\n    * Switched to composer **install** rather than **update** by default\n    * Admin autofocus on page title\n    * `.htaccess` hardening (`.htaccess` & `htaccess.txt`)\n    * Cache safety checks for missing folders\n1. [](#bugfix)\n    * Fixed issue with unescaped `o` character in date formats\n\n# v0.9.39\n## 08/25/2015\n\n1. [](#bugfix)\n    * `Page.active()` not triggering on **homepage**\n    * Fix for invalid session name in Opera browser\n\n# v0.9.38\n## 08/24/2015\n\n1. [](#new)\n    * Added `language` to **user** blueprint\n    * Added translations to blueprints\n    * New extending logic for blueprints\n    * Blueprints are now loaded with Streams to allow for better overrides\n    * Added new Symfony `dump()` method\n1. [](#improved)\n    * Catch YAML header parse exception so site doesn't die\n    * Better `Page.parent()` logic\n    * Improved GPM display layout\n    * Tweaked default page layout\n    * Unset route and slug for improved reliability of route changes\n    * Added requirements to README.md\n    * Updated various libraries\n    * Allow use of custom page date field for dateRange collections\n1. [](#bugfix)\n    * Slug fixes with GPM\n    * Unset plaintext password on save\n    * Fix for trailing `/` not matching active children\n\n# v0.9.37\n## 08/12/2015\n\n3. [](#bugfix)\n    * Fixed issue when saving `header.process` in page forms via the **admin plugin**\n    * Fixed error due to use of `set_time_limit` that might be disabled on some hosts\n\n# v0.9.36\n## 08/11/2015\n\n1. [](#new)\n    * Added a new `newuser` CLI command to create user accounts\n    * Added `default` blueprint for all templates\n    * Support `user` and `system` language translation merging\n1. [](#improved)\n    * Added isSymlink method in GPM to determine if Grav is symbolically linked or not\n    * Refactored page recursing\n    * Updated blueprints to use new toggles\n    * Updated blueprints to use current date for date format fields\n    * Updated composer.phar\n    * Use sessions for admin even when disabled for site\n    * Use `GRAV_ROOT` in session identifier\n\n# v0.9.35\n## 08/06/2015\n\n1. [](#new)\n    * Added `body_classes` field\n    * Added `visiblity` toggle and help tooltips on new page form\n    * Added new `Page.unsetRoute()` method to allow admin to regenerate the route\n2. [](#improved)\n    * User save no longer stores username each time\n    * Page list form field now shows all pages except root\n    * Removed required option from page title\n    * Added configuration settings for running Nginx in sub directory\n3. [](#bugfix)\n    * Fixed deep translation merging\n    * Fixed broken **metadata** merging with site defaults\n    * Fixed broken **summary** field\n    * Fixed broken robots field\n    * Fixed GPM issue when using cURL, throwing an `Undefined offset: 1` exception\n    * Removed duplicate hidden page `type` field\n\n# v0.9.34\n## 08/04/2015\n\n1. [](#new)\n    * Added new `cache_all` system setting + media `cache()` method\n    * Added base languages configuration\n    * Added property language to page to help plugins identify page language\n    * New `Utils::arrayFilterRecursive()` method\n2. [](#improved)\n    * Improved Session handling to support site and admin independently\n    * Allow Twig variables to be modified in other events\n    * Blueprint updates in preparation for Admin plugin\n    * Changed `Inflector` from static to object and added multi-language support\n    * Support for admin override of a page's blueprints\n3. [](#bugfix)\n    * Removed unused `use` in `VideoMedium` that was causing error\n    * Array fix in `User.authorise()` method\n    * Fix for typo in `translations_fallback`\n    * Fixed moving page to the root\n\n# v0.9.33\n## 07/21/2015\n\n1. [](#new)\n    * Added new `onImageMediumSaved()` event (useful for post-image processing)\n    * Added `Vary: Accept-Encoding` option\n2. [](#improved)\n    * Multilang-safe delimiter position\n    * Refactored Twig classes and added optional umask setting\n    * Removed `pageinit()` timing\n    * `Page->routable()` now takes `published()` state into account\n    * Improved how page extension is set\n    * Support `Language->translate()` method taking string and array\n3. [](#bugfix)\n    * Fixed `backup` command to include empty folders\n\n# v0.9.32\n## 07/14/2015\n\n1. [](#new)\n    * Detect users preferred language via `http_accept_language` setting\n    * Added new `translateArray()` language method\n2. [](#improved)\n    * Support `en` translations by default for plugins & themes\n    * Improved default generator tag\n    * Minor language tweaks and fixes\n3. [](#bugfix)\n    * Fix for session active language and homepage redirects\n    * Ignore root-level page rather than throwing error\n\n# v0.9.31\n## 07/09/2015\n\n1. [](#new)\n    * Added xml, json, css and js to valid media file types\n2. [](#improved)\n    * Better handling of unsupported media type downloads\n    * Improved `bin/grav backup` command to mimic admin plugin location/name\n3. [](#bugfix)\n    * Critical fix for broken language translations\n    * Fix for Twig markdown filter error\n    * Safety check for download extension\n\n# v0.9.30\n## 07/08/2015\n\n1. [](#new)\n    * BIG NEWS! Extensive Multi-Language support is all new in 0.9.30!\n    * Translation support via Twig filter/function and PHP method\n    * Page specific default route\n    * Page specific route aliases\n    * Canonical URL route support\n    * Added built-in session support\n    * New `Page.rawRoute()` to get a consistent folder-based route to a page\n    * Added option to always redirect to default page on alias URL\n    * Added language safe redirect function for use in core and plugins\n2. [](#improved)\n    * Improved `Page.active()` and `Page.activeChild()` methods to support route aliases\n    * Various spelling corrections in `.php` comments, `.md` and `.yaml` files\n    * `Utils::startsWith()` and `Utils::endsWith()` now support needle arrays\n    * Added a new timer around `pageInitialized` event\n    * Updated jQuery library to v2.1.4\n3. [](#bugfix)\n    * In-page CSS and JS files are now handled properly\n    * Fix for `enable_media_timestamp` not working properly\n\n# v0.9.29\n## 06/22/2015\n\n1. [](#new)\n    * New and improved Regex-powered redirect and route alias logic\n    * Added new `onBuildPagesInitialized` event for memory critical or time-consuming plugins\n    * Added a `setSummary()` method for pages\n2. [](#improved)\n    * Improved `MergeConfig()` logic for more control\n    * Travis skeleton build trigger implemented\n    * Set composer.json versions to stable versions where possible\n    * Disabled `last_modified` and `etag` page headers by default (causing too much page caching)\n3. [](#bugfix)\n    * Preload classes during `bin/gpm selfupgrade` to avoid issues with updated classes\n    * Fix for directory relative _down_ links\n\n# v0.9.28\n## 06/16/2015\n\n1. [](#new)\n    * Added method to set raw markdown on a page\n    * Added ability to enabled system and page level `etag` and `last_modified` headers\n2. [](#improved)\n    * Improved image path processing\n    * Improved query string handling\n    * Optimization to image handling supporting URL encoded filenames\n    * Use global `composer` when available rather than Grv provided one\n    * Use `PHP_BINARY` constant rather than `php` executable\n    * Updated Doctrine Cache library\n    * Updated Symfony libraries\n    * Moved `convertUrl()` method to Uri object\n3. [](#bugfix)\n    * Fix incorrect slug causing problems with CLI `uninstall`\n    * Fix Twig runtime error with assets pipeline in sufolder installations\n    * Fix for `+` in image filenames\n    * Fix for dot files causing issues with page processing\n    * Fix for Uri path detection on Windows platform\n    * Fix for alternative media resolutions\n    * Fix for modularTypes key properties\n\n# v0.9.27\n## 05/09/2015\n\n1. [](#new)\n    * Added new composer CLI command\n    * Added page-level summary header overrides\n    * Added `size` back for Media objects\n    * Refactored Backup command in preparation for admin plugin\n    * Added a new `parseLinks` method to Plugins class\n    * Added `starts_with` and `ends_with` Twig filters\n2. [](#improved)\n    * Optimized install of vendor libraries for speed improvement\n    * Improved configuration handling in preparation for admin plugin\n    * Cache optimization: Don't cache Twig templates when you pass dynamic params\n    * Moved `Utils::rcopy` to `Folder::rcopy`\n    * Improved `Folder::doDelete`\n    * Added check for required Curl in GPM\n    * Updated included composer.phar to latest version\n    * Various blueprint fixes for admin plugin\n    * Various PSR and code cleanup tasks\n3. [](#bugfix)\n    * Fix issue with Gzip not working with `onShutDown()` event\n    * Fix for URLs with trailing slashes\n    * Handle condition where certain errors resulted in blank page\n    * Fix for issue with theme name equal to base_url and asset pipeline\n    * Fix to properly normalize font rewrite path\n    * Fix for absolute URLs below the current page\n    * Fix for `..` page references\n\n# v0.9.26\n## 04/24/2015\n\n3. [](#bugfix)\n    * Fixed issue with homepage routes failing with 'dirname' error\n\n# v0.9.25\n## 04/24/2015\n\n1. [](#new)\n    * Added support for E-Tag, Last-Modified, Cache-Control and Page-based expires headers\n2. [](#improved)\n    * Refactored media image handling to make it more flexible and support absolute paths\n    * Refactored page modification check process to make it faster\n    * User account improvements in preparation for admin plugin\n    * Protect against timing attacks\n    * Reset default system expires time to 0 seconds (can override if you need to)\n3. [](#bugfix)\n    * Fix issues with spaces in webroot when using `bin/grav install`\n    * Fix for spaces in relative directory\n    * Bug fix in collection filtering\n\n# v0.9.24\n## 04/15/2015\n\n1. [](#new)\n    * Added support for chunked downloads of Assets\n    * Added new `onBeforeDownload()` event\n    * Added new `download()` and `getMimeType()` methods to Utils class\n    * Added configuration option for supported page types\n    * Added assets and media timestamp options (off by default)\n    * Added page expires configuration option\n2. [](#bugfix)\n    * Fixed issue with Nginx/Gzip and `ob_flush()` throwing error\n    * Fixed assets actions on 'direct media' URLs\n    * Fix for 'direct assets` with any parameters\n\n# v0.9.23\n## 04/09/2015\n\n1. [](#bugfix)\n    * Fix for broken GPM `selfupgrade` (Grav 0.9.21 and 0.9.22 will need to manually upgrade to this version)\n\n# v0.9.22\n## 04/08/2015\n\n1. [](#bugfix)\n    * Fix to normalize GRAV_ROOT path for Windows\n    * Fix to normalize Media image paths for Windows\n    * Fix for GPM `selfupgrade` when you are on latest version\n\n# v0.9.21\n## 04/07/2015\n\n1. [](#new)\n    * Major Media functionality enhancements: SVG, Animated GIF, Video support!\n    * Added ability to configure default image quality in system configuration\n    * Added `sizes` attributes for custom retina image breakpoints\n2. [](#improved)\n    * Don't scale @1x retina images\n    * Add filter to Iterator class\n    * Updated various composer packages\n    * Various PSR fixes\n\n# v0.9.20\n## 03/24/2015\n\n1. [](#new)\n    * Added `addAsyncJs()` and `addDeferJs()` to Assets manager\n    * Added support for extranal URL redirects\n2. [](#improved)\n    * Fix unpredictable asset ordering when set from plugin/system\n    * Updated `nginx.conf` to ensure system assets are accessible\n    * Ensure images are served as static files in Nginx\n    * Updated vendor libraries to latest versions\n    * Updated included composer.phar to latest version\n3. [](#bugfix)\n    * Fixed issue with markdown links to `#` breaking HTML\n\n# v0.9.19\n## 02/28/2015\n\n1. [](#new)\n    * Added named assets capability and bundled jQuery into Grav core\n    * Added `first()` and `last()` to `Iterator` class\n2. [](#improved)\n    * Improved page modification routine to skip _dot files_\n    * Only use files to calculate page modification dates\n    * Broke out Folder iterators into their own classes\n    * Various Sensiolabs Insight fixes\n3. [](#bugfix)\n    * Fixed `Iterator.nth()` method\n\n# v0.9.18\n## 02/19/2015\n\n1. [](#new)\n    * Added ability for GPM `install` to automatically install `_demo` content if found (w/backup)\n    * Added ability for themes and plugins to have dependencies required to install via GPM\n    * Added ability to override the system timezone rather than relying on server setting only\n    * Added new Twig filter `random_string` for generating random id values\n    * Added new Twig filter `markdown` for on-the-fly markdown processing\n    * Added new Twig filter `absoluteUrl` to convert relative to absolute URLs\n    * Added new `processTemplate()` method to Twig object for on-the-fly processing of twig template\n    * Added `rcopy()` and `contains()` helper methods in Utils\n2. [](#improved)\n    * Provided new `param_sep` variable to better support Apache on Windows\n    * Moved parsedown configuration into the trait\n    * Added optional **deep-copy** option to `mergeConfig()` for plugins\n    * Updated bundled `composer.phar` package\n    * Various Sensiolabs Insight fixes - Silver level now!\n    * Various PSR Fixes\n3. [](#bugfix)\n    * Fix for windows platforms not displaying installed themes/plugins via GPM\n    * Fix page IDs not picking up folder-only pages\n\n# v0.9.17\n## 02/05/2015\n\n1. [](#new)\n    * Added **full HHVM support!** Get your speed on with Facebook's crazy fast PHP JIT compiler\n2. [](#improved)\n    * More flexible page summary control\n    * Support **CamelCase** plugin and theme class names. Replaces dashes and underscores\n    * Moved summary delimiter into `site.yaml` so it can be configurable\n    * Various PSR fixes\n3. [](#bugfix)\n     * Fix for `mergeConfig()` not falling back to defaults\n     * Fix for `addInlineCss()` and `addInlineJs()` Assets not working between Twig tags\n     * Fix for Markdown adding HTML tags into inline CSS and JS\n\n# v0.9.16\n## 01/30/2015\n\n1. [](#new)\n    * Added **Retina** and **Responsive** image support via Grav media and `srcset` image attribute\n    * Added image debug option that overlays responsive resolution\n    * Added a new image cache stream\n2. [](#improved)\n    * Improved the markdown Lightbox functionality to better mimic Twig version\n    * Fullsize Lightbox can now have filters applied\n    * Added a new `mergeConfig()` method to Plugin class to merge system + page header configuration\n    * Added a new `disable()` method to Plugin class to programmatically disable a plugin\n    * Updated Parsedown and Parsedown Extra to address bugs\n    * Various PSR fixes\n3. [](#bugfix)\n     * Fix bug with image dispatch in traditionally _non-routable_ pages\n     * Fix for markdown link not working on non-current pages\n     * Fix for markdown images not being found on homepage\n\n# v0.9.15\n## 01/23/2015\n\n3. [](#bugfix)\n     * Typo in video mime types\n     * Fix for old `markdown_extra` system setting not getting picked up\n     * Fix in regex for Markdown links with numeric values in path\n     * Fix for broken image routing mechanism that got broken at some point\n     * Fix for markdown images/links in pages with page slug override\n\n# v0.9.14\n## 01/23/2015\n\n1. [](#new)\n    * Added **GZip** support\n    * Added multiple configurations via `setup.php`\n    * Added base structure for unit tests\n    * New `onPageContentRaw()` plugin event that processes before any page processing\n    * Added ability to dynamically set Metadata on page\n    * Added ability to dynamically configure Markdown processing via Parsedown options\n2. [](#improved)\n    * Refactored `page.content()` method to be more flexible and reliable\n    * Various updates and fixes for streams resulting in better multi-site support\n    * Updated Twig, Parsedown, ParsedownExtra, DoctrineCache libraries\n    * Refactored Parsedown trait\n    * Force modular pages to be non-visible in menus\n    * Moved RewriteBase before Exploits in `.htaccess`\n    * Added standard video formats to Media support\n    * Added priority for inline assets\n    * Check for uniqueness when adding multiple inline assets\n    * Improved support for Twig-based URLs inside Markdown links and images\n    * Improved Twig `url()` function\n3. [](#bugfix)\n    * Fix for HTML entities quotes in Metadata values\n    * Fix for `published` setting to have precedent of `publish_date` and `unpublish_date`\n    * Fix for `onShutdown()` events not closing connections properly in **php-fpm** environments\n\n# v0.9.13\n## 01/09/2015\n\n1. [](#new)\n    * Added new published `true|false` state in page headers\n    * Added `publish_date` in page headers to automatically publish page\n    * Added `unpublish_date` in page headers to automatically unpublish page\n    * Added `dateRange()` capability for collections\n    * Added ability to dynamically control Cache lifetime programmatically\n    * Added ability to sort by anything in the page header. E.g. `sort: header.taxonomy.year`\n    * Added various helper methods to collections: `copy, nonVisible, modular, nonModular, published, nonPublished, nonRoutable`\n2. [](#improved)\n    * Modified all Collection methods so they can be chained together: `$collection->published()->visible()`\n    * Set default Cache lifetime to default of 1 week (604800 seconds) - was infinite\n    * House-cleaning of some unused methods in Pages object\n3. [](#bugfix)\n    * Fix `uninstall` GPM command that was broken in last release\n    * Fix for intermittent `undefined index` error when working with Collections\n    * Fix for date of some pages being set to incorrect future timestamps\n\n# v0.9.12\n## 01/06/2015\n\n1. [](#new)\n    * Added an all-access robots.txt file for search engines\n    * Added new GPM `uninstall` command\n    * Added support for **in-page** Twig processing in **modular** pages\n    * Added configurable support for `undefined` Twig functions and filters\n2. [](#improved)\n    * Fall back to default `.html` template if error occurs on non-html pages\n    * Added ability to have PSR-1 friendly plugin names (CamelCase, no-dashes)\n    * Fix to `composer.json` to deter API rate-limit errors\n    * Added **non-exception-throwing** handler for undefined methods on `Medium` objects\n3. [](#bugfix)\n    * Fix description for `self-upgrade` method of GPM command\n    * Fix for incorrect version number when performing GPM `update`\n    * Fix for argument description of GPM `install` command\n    * Fix for recalcitrant CodeKit mac application\n\n# v0.9.11\n## 12/21/2014\n\n1. [](#new)\n    * Added support for simple redirects as well as routes\n2. [](#improved)\n    * Handle Twig errors more cleanly\n3. [](#bugfix)\n    * Fix for error caused by invalid or missing user agent string\n    * Fix for directory relative links and URL fragments (#pagelink)\n    * Fix for relative links with no subfolder in `base_url`\n\n# v0.9.10\n## 12/12/2014\n\n1. [](#new)\n    * Added Facebook-style `nicetime` date Twig filter\n2. [](#improved)\n    * Moved `clear-cache` functionality into Cache object required for Admin plugin\n3. [](#bugfix)\n    * Fix for undefined index with previous/next buttons\n\n# v0.9.9\n## 12/05/2014\n\n1. [](#new)\n    * Added new `@page` collection type\n    * Added `ksort` and `contains` Twig filters\n    * Added `gist` Twig function\n2. [](#improved)\n    * Refactored Page previous/next/adjacent functionality\n    * Updated to Symfony 2.6 for yaml/console/event-dispatcher libraries\n    * More PSR code fixes\n3. [](#bugfix)\n    * Fix for over-escaped apostrophes in YAML\n\n# v0.9.8\n## 12/01/2014\n\n1. [](#new)\n    * Added configuration option to set default lifetime on cache saves\n    * Added ability to set HTTP status code from page header\n    * Implemented simple wild-card custom routing\n2. [](#improved)\n    * Fixed elusive double load to fully cache issue (crossing fingers...)\n    * Ensure Twig tags are treated as block items in markdown\n    * Removed some older deprecated methods\n    * Ensure onPageContentProcessed() event only fires when not cached\n    * More PSR code fixes\n3. [](#bugfix)\n    * Fix issue with miscalculation of blog separator location `===`\n\n# v0.9.7\n## 11/24/2014\n\n1. [](#improved)\n    * Nginx configuration updated\n    * Added gitter.im badge to README\n    * Removed `set_time_limit()` and put checks around `ignore_user_abort`\n    * More PSR code fixes\n2. [](#bugfix)\n    * Fix issue with non-valid asset path showing up when they shouldn't\n    * Fix for JS asset pipeline and scripts that don't end in `;`\n    * Fix for schema-based markdown URLs broken routes (eg `mailto:`)\n\n# v0.9.6\n## 11/17/2014\n\n1. [](#improved)\n    * Moved base_url variables into Grav container\n    * Forced media sorting to use natural sort order by default\n    * Various PSR code tidying\n    * Added filename, extension, thumb to all medium objects\n2. [](#bugfix)\n    * Fix for infinite loop in page.content()\n    * Fix hostname for configuration overrides\n    * Fix for cached configuration\n    * Fix for relative URLs in markdown on installs with no base_url\n    * Fix for page media images with uppercase extension\n\n# v0.9.5\n## 11/09/2014\n\n1. [](#new)\n    * Added quality setting to medium for compression configuration of images\n    * Added new onPageContentProcessed() event that is post-content processing but pre-caching\n2. [](#improved)\n    * Added support for AND and OR taxonomy filtering.  AND by default (was OR)\n    * Added specific clearing options for CLI clear-cache command\n    * Moved environment method to URI so it can be accessible in plugins and themes\n    * Set Grav's output variable to public so it can be manipulated in onOutputGenerated event\n    * Updated vendor libraries to latest versions\n    * Better handing of 'home' in active menu state detection\n    * Various PSR code tidying\n    * Improved some error messages and notices\n3. [](#bugfix)\n    * Force route rebuild when configuration changes\n    * Fix for 'installed undefined' error in CLI versions command\n    * Do not remove the JSON/Text error handlers\n    * Fix for supporting inline JS and CSS when Asset pipeline enabled\n    * Fix for Data URLs in CSS being badly formed\n    * Fix Markdown links with fragment and query elements\n\n# v0.9.4\n## 10/29/2014\n\n1. [](#new)\n    * New improved Debugbar with messages, timing, config, twig information\n    * New exception handling system utilizing Whoops\n    * New logging system utilizing Monolog\n    * Support for auto-detecting environment configuration\n    * New version command for CLI\n    * Integrate Twig dump() calls into Debugbar\n2. [](#improved)\n    * Selfupgrade now clears cache on successful upgrade\n    * Selfupgrade now supports files without extensions\n    * Improved error messages when plugin is missing\n    * Improved security in .htaccess\n    * Support CSS/JS/Image assets in vendor/system folders via .htaccess\n    * Add support for system timers\n    * Improved and optimized configuration loading\n    * Automatically disable Debugbar on non-HTML pages\n    * Disable Debugbar by default\n3. [](#bugfix)\n    * More YAML blueprint fixes\n    * Fix potential double // in assets\n    * Load debugger as early as possible\n\n# v0.9.3\n## 10/09/2014\n\n1. [](#new)\n    * GPM (Grav Package Manager) Added\n    * Support for multiple Grav configurations\n    * Dynamic media support via URL\n    * Added inlineCss and inlineJs support for Assets\n2. [](#improved)\n    * YAML caching for increased performance\n    * Use stream wrapper in pages, plugins and themes\n    * Switched to RocketTheme toolbox for some core functionality\n    * Renamed `setup` CLI command to `sandbox`\n    * Broke cache types out into multiple directories in the cache folder\n    * Removed vendor libs from github repository\n    * Various PSR cleanup of code\n    * Various Blueprint updates to support upcoming admin plugin\n    * Added ability to filter page children for normal/modular/all\n    * Added `sort_by_key` twig filter\n    * Added `visible()` and `routable()` filters to page collections\n    * Use session class in shutdown process\n    * Improvements to modular page loading\n    * Various code cleanup and optimizations\n3. [](#bugfix)\n    * Fixed file checking not updating the last modified time. For real this time!\n    * Switched debugger to PRODUCTION mode by default\n    * Various fixes in URI class for increased reliability\n\n# v0.9.2\n## 09/15/2014\n\n1. [](#new)\n    * New flexible site and page metadata support including ObjectGraph and Facebook\n    * New method to get user IP address in URI object\n    * Added new onShutdown() event that fires after connection is closed for Async features\n2. [](#improved)\n    * Skip assets pipeline minify on Windows platforms by default due to PHP issue 47689\n    * Fixed multiple level menus not highlighting correctly\n    * Updated some blueprints in preparation for admin plugin\n    * Fail gracefully when theme does not exist\n    * Add stream support into ResourceLocator::addPath()\n    * Separate themes from plugins, add themes:// stream and onTask events\n    * Added barDump() to Debugger\n    * Removed stray test page\n    * Override modified only if a non-markdown file was modified\n    * Added assets attributes support\n    * Auto-run composer install when running the Grav CLI\n    * Vendor folder removed from repository\n    * Minor configuration performance optimizations\n    * Minor debugger performance optimizations\n3. [](#bugfix)\n    * Fix url() twig function when Grav isn't installed at root\n    * Workaround for PHP bug 52065\n    * Fixed getList() method on Pages object that was not working\n    * Fix for open_basedir error\n    * index.php now warns if not running on PHP 5.4\n    * Removed memcached option (redundant)\n    * Removed memcache from auto setup, added memcache server configuration option\n    * Fix broken password validation\n    * Back to proper PSR-4 Autoloader\n\n# v0.9.1\n## 09/02/2014\n\n1. [](#new)\n    * Added new `theme://` PHP stream for current theme\n2. [](#improved)\n    * Default to new `file` modification checking rather than `folder`\n    * Added support for various markdown link formats to convert to Grav-friendly URLs\n    * Moved configure() from Theme to Themes class\n    * Fix autoloading without composer update -o\n    * Added support for Twig url method\n    * Minor code cleanup\n3. [](#bugfix)\n    * Fixed issue with page changes not being picked up\n    * Fixed Minify to provide `@supports` tag compatibility\n    * Fixed ResourceLocator not working with multiple paths\n    * Fixed issue with Markdown process not stripping LFs\n    * Restrict file type extensions for added security\n    * Fixed template inheritance\n    * Moved Browser class to proper location\n\n# v0.9.0\n## 08/25/2014\n\n1. [](#new)\n    * Addition of Dependency Injection Container\n    * Refactored plugins to use Symfony Event Dispatcher\n    * New Asset Manager to provide unified management of JavaScript and CSS\n    * Asset Pipelining to provide unification, minify, and optimization of JavaScript and CSS\n    * Grav Media support directly in Markdown syntax\n    * Additional Grav Generator meta tag in default themes\n    * Added support for PHP Stream Wrapper for resource location\n    * Markdown Extra support\n    * Browser object for fast browser detection\n2. [](#improved)\n    * PSR-4 Autoloader mechanism\n    * Tracy Debugger new `detect` option to detect running environment\n    * Added new `random` collection sort option\n    * Make media images progressive by default\n    * Additional URI filtering for improved security\n    * Safety checks to ensure PHP 5.4.0+\n    * Move to Slidebars side navigation in default Antimatter theme\n    * Updates to `.htaccess` including section on `RewriteBase` which is needed for some hosting providers\n3. [](#bugfix)\n    * Fixed issue when installing in an apache userdir (~username) folder\n    * Various mobile CSS issues in default themes\n    * Various minor bug fixes\n\n\n# v0.8.0\n## 08/13/2014\n\n1. [](#new)\n    * Initial Release\n", "<?php\n\n/**\n * @package    Grav\\Common\n *\n * @copyright  Copyright (C) 2015 - 2019 Trilby Media, LLC. All rights reserved.\n * @license    MIT License; see LICENSE file for details.\n */\n\nnamespace Grav\\Common;\n\nuse Grav\\Common\\Config\\Config;\nuse Grav\\Common\\Config\\Setup;\nuse Grav\\Common\\Page\\Interfaces\\PageInterface;\nuse Grav\\Common\\Page\\Medium\\ImageMedium;\nuse Grav\\Common\\Page\\Medium\\Medium;\nuse Grav\\Common\\Processors\\AssetsProcessor;\nuse Grav\\Common\\Processors\\BackupsProcessor;\nuse Grav\\Common\\Processors\\ConfigurationProcessor;\nuse Grav\\Common\\Processors\\DebuggerAssetsProcessor;\nuse Grav\\Common\\Processors\\DebuggerProcessor;\nuse Grav\\Common\\Processors\\ErrorsProcessor;\nuse Grav\\Common\\Processors\\InitializeProcessor;\nuse Grav\\Common\\Processors\\LoggerProcessor;\nuse Grav\\Common\\Processors\\PagesProcessor;\nuse Grav\\Common\\Processors\\PluginsProcessor;\nuse Grav\\Common\\Processors\\RenderProcessor;\nuse Grav\\Common\\Processors\\RequestProcessor;\nuse Grav\\Common\\Processors\\SchedulerProcessor;\nuse Grav\\Common\\Processors\\TasksProcessor;\nuse Grav\\Common\\Processors\\ThemesProcessor;\nuse Grav\\Common\\Processors\\TwigProcessor;\nuse Grav\\Framework\\DI\\Container;\nuse Grav\\Framework\\Psr7\\Response;\nuse Grav\\Framework\\RequestHandler\\RequestHandler;\nuse Psr\\Http\\Message\\ResponseInterface;\nuse Psr\\Http\\Message\\ServerRequestInterface;\nuse RocketTheme\\Toolbox\\Event\\Event;\nuse RocketTheme\\Toolbox\\Event\\EventDispatcher;\n\n/**\n * Grav container is the heart of Grav.\n *\n * @package Grav\\Common\n */\nclass Grav extends Container\n{\n    /**\n     * @var string Processed output for the page.\n     */\n    public $output;\n\n    /**\n     * @var static The singleton instance\n     */\n    protected static $instance;\n\n    /**\n     * @var array Contains all Services and ServicesProviders that are mapped\n     *            to the dependency injection container.\n     */\n    protected static $diMap = [\n        'Grav\\Common\\Service\\AccountsServiceProvider',\n        'Grav\\Common\\Service\\AssetsServiceProvider',\n        'Grav\\Common\\Service\\BackupsServiceProvider',\n        'Grav\\Common\\Service\\ConfigServiceProvider',\n        'Grav\\Common\\Service\\ErrorServiceProvider',\n        'Grav\\Common\\Service\\FilesystemServiceProvider',\n        'Grav\\Common\\Service\\InflectorServiceProvider',\n        'Grav\\Common\\Service\\LoggerServiceProvider',\n        'Grav\\Common\\Service\\OutputServiceProvider',\n        'Grav\\Common\\Service\\PagesServiceProvider',\n        'Grav\\Common\\Service\\RequestServiceProvider',\n        'Grav\\Common\\Service\\SessionServiceProvider',\n        'Grav\\Common\\Service\\StreamsServiceProvider',\n        'Grav\\Common\\Service\\TaskServiceProvider',\n        'browser'    => 'Grav\\Common\\Browser',\n        'cache'      => 'Grav\\Common\\Cache',\n        'events'     => 'RocketTheme\\Toolbox\\Event\\EventDispatcher',\n        'exif'       => 'Grav\\Common\\Helpers\\Exif',\n        'plugins'    => 'Grav\\Common\\Plugins',\n        'scheduler'  => 'Grav\\Common\\Scheduler\\Scheduler',\n        'taxonomy'   => 'Grav\\Common\\Taxonomy',\n        'themes'     => 'Grav\\Common\\Themes',\n        'twig'       => 'Grav\\Common\\Twig\\Twig',\n        'uri'        => 'Grav\\Common\\Uri',\n    ];\n\n    /**\n     * @var array All middleware processors that are processed in $this->process()\n     */\n    protected $middleware = [\n        'configurationProcessor',\n        'loggerProcessor',\n        'errorsProcessor',\n        'debuggerProcessor',\n        'initializeProcessor',\n        'pluginsProcessor',\n        'themesProcessor',\n        'requestProcessor',\n        'tasksProcessor',\n        'backupsProcessor',\n        'schedulerProcessor',\n        'assetsProcessor',\n        'twigProcessor',\n        'pagesProcessor',\n        'debuggerAssetsProcessor',\n        'renderProcessor',\n    ];\n\n    protected $initialized = [];\n\n    /**\n     * Reset the Grav instance.\n     */\n    public static function resetInstance()\n    {\n        if (self::$instance) {\n            self::$instance = null;\n        }\n    }\n\n    /**\n     * Return the Grav instance. Create it if it's not already instanced\n     *\n     * @param array $values\n     *\n     * @return Grav\n     */\n    public static function instance(array $values = [])\n    {\n        if (!self::$instance) {\n            self::$instance = static::load($values);\n        } elseif ($values) {\n            $instance = self::$instance;\n            foreach ($values as $key => $value) {\n                $instance->offsetSet($key, $value);\n            }\n        }\n\n        return self::$instance;\n    }\n\n    /**\n     * Setup Grav instance using specific environment.\n     *\n     * Initializes Grav streams by\n     *\n     * @param string|null $environment\n     * @return $this\n     */\n    public function setup(string $environment = null)\n    {\n        if (isset($this->initialized['setup'])) {\n            return $this;\n        }\n\n        $this->initialized['setup'] = true;\n\n        $this->measureTime('_setup', 'Site Setup', function () use ($environment) {\n            // Force environment if passed to the method.\n            if ($environment) {\n                Setup::$environment = $environment;\n            }\n\n            $this['setup'];\n            $this['streams'];\n        });\n\n        return $this;\n    }\n\n    /**\n     * Initialize CLI environment.\n     *\n     * Call after `$grav->setup($environment)`\n     *\n     * - Load configuration\n     * - Disable debugger\n     * - Set timezone, locale\n     * - Load plugins\n     * - Set Users type to be used in the site\n     *\n     * This method WILL NOT initialize assets, twig or pages.\n     *\n     * @param string|null $environment\n     * @return $this\n     */\n    public function initializeCli()\n    {\n        InitializeProcessor::initializeCli($this);\n\n        return $this;\n    }\n\n    /**\n     * Process a request\n     */\n    public function process()\n    {\n        if (isset($this->initialized['process'])) {\n            return;\n        }\n\n        // Initialize Grav if needed.\n        $this->setup();\n\n        $this->initialized['process'] = true;\n\n        $container = new Container(\n            [\n                'configurationProcessor' => function () {\n                    return new ConfigurationProcessor($this);\n                },\n                'loggerProcessor' => function () {\n                    return new LoggerProcessor($this);\n                },\n                'errorsProcessor' => function () {\n                    return new ErrorsProcessor($this);\n                },\n                'debuggerProcessor' => function () {\n                    return new DebuggerProcessor($this);\n                },\n                'initializeProcessor' => function () {\n                    return new InitializeProcessor($this);\n                },\n                'backupsProcessor' => function () {\n                    return new BackupsProcessor($this);\n                },\n                'pluginsProcessor' => function () {\n                    return new PluginsProcessor($this);\n                },\n                'themesProcessor' => function () {\n                    return new ThemesProcessor($this);\n                },\n                'schedulerProcessor' => function () {\n                    return new SchedulerProcessor($this);\n                },\n                'requestProcessor' => function () {\n                    return new RequestProcessor($this);\n                },\n                'tasksProcessor' => function () {\n                    return new TasksProcessor($this);\n                },\n                'assetsProcessor' => function () {\n                    return new AssetsProcessor($this);\n                },\n                'twigProcessor' => function () {\n                    return new TwigProcessor($this);\n                },\n                'pagesProcessor' => function () {\n                    return new PagesProcessor($this);\n                },\n                'debuggerAssetsProcessor' => function () {\n                    return new DebuggerAssetsProcessor($this);\n                },\n                'renderProcessor' => function () {\n                    return new RenderProcessor($this);\n                },\n            ]\n        );\n\n        $default = function (ServerRequestInterface $request) {\n            return new Response(404);\n        };\n\n        /** @var Debugger $debugger */\n        $debugger = $this['debugger'];\n\n        $collection = new RequestHandler($this->middleware, $default, $container);\n\n        $response = $collection->handle($this['request']);\n        $body = $response->getBody();\n\n        // Handle ETag and If-None-Match headers.\n        if ($response->getHeaderLine('ETag') === '1') {\n            $etag = md5($body);\n            $response = $response->withHeader('ETag', $etag);\n\n            if ($this['request']->getHeaderLine('If-None-Match') === $etag) {\n                $response = $response->withStatus(304);\n                $body = '';\n            }\n        }\n\n        $this->header($response);\n        echo $body;\n\n        $debugger->render();\n\n        register_shutdown_function([$this, 'shutdown']);\n    }\n\n    /**\n     * Set the system locale based on the language and configuration\n     */\n    public function setLocale()\n    {\n        // Initialize Locale if set and configured.\n        if ($this['language']->enabled() && $this['config']->get('system.languages.override_locale')) {\n            $language = $this['language']->getLanguage();\n            setlocale(LC_ALL, \\strlen($language) < 3 ? ($language . '_' . strtoupper($language)) : $language);\n        } elseif ($this['config']->get('system.default_locale')) {\n            setlocale(LC_ALL, $this['config']->get('system.default_locale'));\n        }\n    }\n\n    /**\n     * Redirect browser to another location.\n     *\n     * @param string $route Internal route.\n     * @param int    $code  Redirection code (30x)\n     */\n    public function redirect($route, $code = null)\n    {\n        /** @var Uri $uri */\n        $uri = $this['uri'];\n\n        //Check for code in route\n        $regex = '/.*(\\[(30[1-7])\\])$/';\n        preg_match($regex, $route, $matches);\n        if ($matches) {\n            $route = str_replace($matches[1], '', $matches[0]);\n            $code = $matches[2];\n        }\n\n        if ($code === null) {\n            $code = $this['config']->get('system.pages.redirect_default_code', 302);\n        }\n\n        if (isset($this['session'])) {\n            $this['session']->close();\n        }\n\n        if ($uri->isExternal($route)) {\n            $url = $route;\n        } else {\n            $url = rtrim($uri->rootUrl(), '/') . '/';\n\n            if ($this['config']->get('system.pages.redirect_trailing_slash', true)) {\n                $url .= trim($route, '/'); // Remove trailing slash\n            } else {\n                $url .= ltrim($route, '/'); // Support trailing slash default routes\n            }\n        }\n\n        header(\"Location: {$url}\", true, $code);\n        exit();\n    }\n\n    /**\n     * Redirect browser to another location taking language into account (preferred)\n     *\n     * @param string $route Internal route.\n     * @param int    $code  Redirection code (30x)\n     */\n    public function redirectLangSafe($route, $code = null)\n    {\n        if (!$this['uri']->isExternal($route)) {\n            $this->redirect($this['pages']->route($route), $code);\n        } else {\n            $this->redirect($route, $code);\n        }\n    }\n\n    /**\n     * Set response header.\n     *\n     * @param ResponseInterface|null $response\n     */\n    public function header(ResponseInterface $response = null)\n    {\n        if (null === $response) {\n            /** @var PageInterface $page */\n            $page = $this['page'];\n            $response = new Response($page->httpResponseCode(), $page->httpHeaders(), '');\n        }\n\n        header(\"HTTP/{$response->getProtocolVersion()} {$response->getStatusCode()} {$response->getReasonPhrase()}\");\n        foreach ($response->getHeaders() as $key => $values) {\n            foreach ($values as $i => $value) {\n                header($key . ': ' . $value, $i === 0);\n            }\n        }\n    }\n\n    /**\n     * Fires an event with optional parameters.\n     *\n     * @param  string $eventName\n     * @param  Event  $event\n     *\n     * @return Event\n     */\n    public function fireEvent($eventName, Event $event = null)\n    {\n        /** @var EventDispatcher $events */\n        $events = $this['events'];\n\n        return $events->dispatch($eventName, $event);\n    }\n\n    /**\n     * Set the final content length for the page and flush the buffer\n     *\n     */\n    public function shutdown()\n    {\n        // Prevent user abort allowing onShutdown event to run without interruptions.\n        if (\\function_exists('ignore_user_abort')) {\n            @ignore_user_abort(true);\n        }\n\n        // Close the session allowing new requests to be handled.\n        if (isset($this['session'])) {\n            $this['session']->close();\n        }\n\n        if ($this['config']->get('system.debugger.shutdown.close_connection', true)) {\n            // Flush the response and close the connection to allow time consuming tasks to be performed without leaving\n            // the connection to the client open. This will make page loads to feel much faster.\n\n            // FastCGI allows us to flush all response data to the client and finish the request.\n            $success = \\function_exists('fastcgi_finish_request') ? @fastcgi_finish_request() : false;\n\n            if (!$success) {\n                // Unfortunately without FastCGI there is no way to force close the connection.\n                // We need to ask browser to close the connection for us.\n                if ($this['config']->get('system.cache.gzip')) {\n                    // Flush gzhandler buffer if gzip setting was enabled.\n                    ob_end_flush();\n\n                } else {\n                    // Without gzip we have no other choice than to prevent server from compressing the output.\n                    // This action turns off mod_deflate which would prevent us from closing the connection.\n                    if ($this['config']->get('system.cache.allow_webserver_gzip')) {\n                        header('Content-Encoding: identity');\n                    } else {\n                        header('Content-Encoding: none');\n                    }\n\n                }\n\n\n                // Get length and close the connection.\n                header('Content-Length: ' . ob_get_length());\n                header('Connection: close');\n\n                ob_end_flush();\n                @ob_flush();\n                flush();\n            }\n        }\n\n        // Run any time consuming tasks.\n        $this->fireEvent('onShutdown');\n    }\n\n    /**\n     * Magic Catch All Function\n     *\n     * Used to call closures.\n     *\n     * Source: http://stackoverflow.com/questions/419804/closures-as-class-members\n     *\n     * @param string $method\n     * @param array $args\n     * @return\n     */\n    public function __call($method, $args)\n    {\n        $closure = $this->{$method} ?? null;\n\n        return is_callable($closure) ? $closure(...$args) : null;\n    }\n\n    /**\n     * Measure how long it takes to do an action.\n     *\n     * @param string $timerId\n     * @param string $timerTitle\n     * @param callable $callback\n     * @return mixed   Returns value returned by the callable.\n     */\n    public function measureTime(string $timerId, string $timerTitle, callable $callback)\n    {\n        $debugger = $this['debugger'];\n        $debugger->startTimer($timerId, $timerTitle);\n        $result = $callback();\n        $debugger->stopTimer($timerId);\n\n        return $result;\n    }\n\n    /**\n     * Initialize and return a Grav instance\n     *\n     * @param  array $values\n     *\n     * @return static\n     */\n    protected static function load(array $values)\n    {\n        $container = new static($values);\n\n        $container['debugger'] = new Debugger();\n        $container['grav'] = function (Container $container) {\n            user_error('Calling $grav[\\'grav\\'] or {{ grav.grav }} is deprecated since Grav 1.6, just use $grav or {{ grav }}', E_USER_DEPRECATED);\n\n            return $container;\n        };\n\n        $container->measureTime('_services', 'Services', function () use ($container) {\n            $container->registerServices();\n        });\n\n        return $container;\n    }\n\n    /**\n     * Register all services\n     * Services are defined in the diMap. They can either only the class\n     * of a Service Provider or a pair of serviceKey => serviceClass that\n     * gets directly mapped into the container.\n     *\n     * @return void\n     */\n    protected function registerServices()\n    {\n        foreach (self::$diMap as $serviceKey => $serviceClass) {\n            if (\\is_int($serviceKey)) {\n                $this->register(new $serviceClass);\n            } else {\n                $this[$serviceKey] = function ($c) use ($serviceClass) {\n                    return new $serviceClass($c);\n                };\n            }\n        }\n    }\n\n    /**\n     * This attempts to find media, other files, and download them\n     *\n     * @param string $path\n     */\n    public function fallbackUrl($path)\n    {\n        $this->fireEvent('onPageFallBackUrl');\n\n        /** @var Uri $uri */\n        $uri = $this['uri'];\n\n        /** @var Config $config */\n        $config = $this['config'];\n\n        $uri_extension = strtolower($uri->extension());\n        $fallback_types = $config->get('system.media.allowed_fallback_types', null);\n        $supported_types = $config->get('media.types');\n\n        // Check whitelist first, then ensure extension is a valid media type\n        if (!empty($fallback_types) && !\\in_array($uri_extension, $fallback_types, true)) {\n            return false;\n        }\n        if (!array_key_exists($uri_extension, $supported_types)) {\n            return false;\n        }\n\n        $path_parts = pathinfo($path);\n\n        /** @var PageInterface $page */\n        $page = $this['pages']->dispatch($path_parts['dirname'], true);\n\n        if ($page) {\n            $media = $page->media()->all();\n            $parsed_url = parse_url(rawurldecode($uri->basename()));\n            $media_file = $parsed_url['path'];\n\n            // if this is a media object, try actions first\n            if (isset($media[$media_file])) {\n                /** @var Medium $medium */\n                $medium = $media[$media_file];\n                foreach ($uri->query(null, true) as $action => $params) {\n                    if (\\in_array($action, ImageMedium::$magic_actions, true)) {\n                        \\call_user_func_array([&$medium, $action], explode(',', $params));\n                    }\n                }\n                Utils::download($medium->path(), false);\n            }\n\n            // unsupported media type, try to download it...\n            if ($uri_extension) {\n                $extension = $uri_extension;\n            } else {\n                if (isset($path_parts['extension'])) {\n                    $extension = $path_parts['extension'];\n                } else {\n                    $extension = null;\n                }\n            }\n\n            if ($extension) {\n                $download = true;\n                if (\\in_array(ltrim($extension, '.'), $config->get('system.media.unsupported_inline_types', []), true)) {\n                    $download = false;\n                }\n                Utils::download($page->path() . DIRECTORY_SEPARATOR . $uri->basename(), $download);\n            }\n\n            // Nothing found\n            return false;\n        }\n\n        return $page;\n    }\n}\n"], "fixing_code": ["# v1.6.23\n## mm/dd/2020\n\n1. [](#new)\n    * Moved `Parsedown` 1.6 and `ParsedownExtra` 0.7 into `Grav\\Framework\\Parsedown` to allow fixes\n1. [](#bugfix)\n    * Fixed PHP 7.4 issue in ParsedownExtra [#2832](https://github.com/getgrav/grav/issues/2832)\n    * Fix for [user reported](https://twitter.com/OriginalSicksec) CVE path-based open redirect\n\n# v1.6.22\n## 03/05/2020\n\n1. [](#new)\n    * Added `Pages::reset()` method\n1. [](#improved)\n    * Updated Negotiation library to address issues [#2513](https://github.com/getgrav/grav/issues/2513)\n1. [](#bugfix)\n    * Fixed issue with search plugins not being able to switch between page translations\n    * Fixed issues with `Pages::baseRoute()` not picking up active language reliably\n    * Reverted `validation: strict` fix as it breaks sites, see [#1273](https://github.com/getgrav/grav/issues/1273)\n\n# v1.6.21\n## 02/11/2020\n\n1. [](#new)\n    * Added `ConsoleCommand::setLanguage()` method to set language to be used from CLI\n    * Added `ConsoleCommand::initializeGrav()` method to properly set up Grav instance to be used from CLI\n    * Added `ConsoleCommand::initializePlugins()`method to properly set up all plugins to be used from CLI\n    * Added `ConsoleCommand::initializeThemes()`method to properly set up current theme to be used from CLI\n    * Added `ConsoleCommand::initializePages()` method to properly set up pages to be used from CLI\n1. [](#improved)\n    * Vendor updates\n1. [](#bugfix)\n    * Fixed `bin/plugin` CLI calling `$themes->init()` way too early (removed it, use above methods instead)\n    * Fixed call to `$grav['page']` crashing CLI\n    * Fixed encoding problems when PHP INI setting `default_charset` is not `utf-8` [#2154](https://github.com/getgrav/grav/issues/2154)\n\n# v1.6.20\n## 02/03/2020\n\n1. [](#bugfix)\n    * Fixed incorrect routing caused by `str_replace()` in `Uri::init()` [#2754](https://github.com/getgrav/grav/issues/2754)\n    * Fixed session cookie is being set twice in the HTTP header [#2745](https://github.com/getgrav/grav/issues/2745)\n    * Fixed session not restarting if user was invalid (downgrading from Grav 1.7)\n    * Fixed filesystem iterator calls with non-existing folders\n    * Fixed `checkbox` field not being saved, requires also Form v4.0.2 [#1225](https://github.com/getgrav/grav/issues/1225)\n    * Fixed `validation: strict` not working in blueprints [#1273](https://github.com/getgrav/grav/issues/1273)\n    * Fixed `Data::filter()` removing empty fields (such as empty list) by default [#2805](https://github.com/getgrav/grav/issues/2805)\n    * Fixed fatal error with non-integer page param value [#2803](https://github.com/getgrav/grav/issues/2803)\n    * Fixed `Assets::addInlineJs()` parameter type mismatch between v1.5 and v1.6 [#2659](https://github.com/getgrav/grav/issues/2659)\n    * Fixed `site.metadata` saving issues [#2615](https://github.com/getgrav/grav/issues/2615)\n\n# v1.6.19\n## 12/04/2019\n\n1. [](#new)\n    * Catch PHP 7.4 deprecation messages and report them in debugbar instead of throwing fatal error\n1. [](#bugfix)\n    * Fixed fatal error when calling `{{ grav.undefined }}`\n    * Fixed multiple issues when there are no pages in the site\n    * PHP 7.4 fix for [#2750](https://github.com/getgrav/grav/issues/2750)\n\n# v1.6.18\n## 12/02/2019\n\n1. [](#bugfix)\n    * PHP 7.4 fix in `Pages::buildSort()`\n    * Updated vendor libraries for PHP 7.4 fixes in Twig and other libraries\n    * Fixed fatal error when `$page->id()` is null [#2731](https://github.com/getgrav/grav/pull/2731)\n    * Fixed cache conflicts on pages with no set id\n    * Fix rewrite rule for for `lighttpd` default config [#721](https://github.com/getgrav/grav/pull/2721)\n\n# v1.6.17\n## 11/06/2019\n\n1. [](#new)\n    * Added working ETag (304 Not Modified) support based on the final rendered HTML\n1. [](#improved)\n    * Safer file handling + customizable null char replacement in `CsvFormatter::decode()`\n    * Change of Behavior: `Inflector::hyphenize` will now automatically trim dashes at beginning and end of a string.\n    * Change in Behavior for `Folder::all()` so no longer fails if trying to copy non-existent dot file [#2581](https://github.com/getgrav/grav/pull/2581)\n    * renamed composer `test-plugins` script to `phpstan-plugins` to be more explicit [#2637](https://github.com/getgrav/grav/pull/2637)\n1. [](#bugfix)\n    * Fixed PHP 7.1 bug in FlexMedia\n    * Fix cache image generation when using cropResize [#2639](https://github.com/getgrav/grav/pull/2639)\n    * Fix `array_merge()` exception with non-array page header metadata [#2701](https://github.com/getgrav/grav/pull/2701)\n\n# v1.6.16\n## 09/19/2019\n\n1. [](#bugfix)\n    * Fixed Flex user creation if file storage is being used [#2444](https://github.com/getgrav/grav/issues/2444)\n    * Fixed `Badly encoded JSON data` warning when uploading files [#2663](https://github.com/getgrav/grav/issues/2663)\n\n# v1.6.15\n## 08/20/2019\n\n1. [](#improved)\n    * Improved robots.txt [#2632](https://github.com/getgrav/grav/issues/2632)\n1. [](#bugfix)\n    * Fixed broken markdown Twig tag [#2635](https://github.com/getgrav/grav/issues/2635)\n    * Force Symfony 4.2 in Grav 1.6 to remove a bunch of deprecated messages\n\n# v1.6.14\n## 08/18/2019\n\n1. [](#bugfix)\n    * Actually include fix for `system\\router.php` [#2627](https://github.com/getgrav/grav/issues/2627)\n\n# v1.6.13\n## 08/16/2019\n\n1. [](#bugfix)\n    * Regression fix for `system\\router.php` [#2627](https://github.com/getgrav/grav/issues/2627)\n\n# v1.6.12\n## 08/14/2019\n\n1. [](#new)\n    * Added support for custom `FormFlash` save locations\n    * Added a new `Utils::arrayLower()` method for lowercasing arrays\n    * Support new GRAV_BASEDIR environment variable [#2541](https://github.com/getgrav/grav/pull/2541)\n    * Allow users to override plugin handler priorities [#2165](https://github.com/getgrav/grav/pull/2165)\n1. [](#improved)\n    * Use new `Utils::getSupportedPageTypes()` to enforce `html,htm` at the front of the list [#2531](https://github.com/getgrav/grav/issues/2531)\n    * Updated vendor libraries\n    * Markdown filter is now page-aware so that it works with modular references [admin#1731](https://github.com/getgrav/grav-plugin-admin/issues/1731)\n    * Check of `GRAV_USER_INSTANCE` constant is already defined [#2621](https://github.com/getgrav/grav/pull/2621)\n1. [](#bugfix)\n    * Fixed some potential issues when `$grav['user']` is not set\n    * Fixed error when calling `Media::add($name, null)`\n    * Fixed `url()` returning wrong path if using stream with grav root path in it, eg: `user-data://shop` when Grav is in `/shop`\n    * Fixed `url()` not returning a path to non-existing file (`user-data://shop` => `/user/data/shop`) if it is set to fail gracefully\n    * Fixed `url()` returning false on unknown streams, such as `ftp://domain.com`, they should be treated as external URL\n    * Fixed Flex User to have permissions to save and delete his own user\n    * Fixed new Flex User creation not being possible because of username could not be given\n    * Fixed fatal error 'Expiration date must be an integer, a DateInterval or null, \"double\" given' [#2529](https://github.com/getgrav/grav/issues/2529)\n    * Fixed non-existing Flex object having a bad media folder\n    * Fixed collections using `page@.self:` should allow modular pages if requested\n    * Fixed an error when trying to delete a file from non-existing Flex Object\n    * Fixed `FlexObject::exists()` failing sometimes just after the object has been saved\n    * Fixed CSV formatter not encoding strings with `\"` and `,` properly\n    * Fixed var order in `Validation.php` [#2610](https://github.com/getgrav/grav/issues/2610)\n\n# v1.6.11\n## 06/21/2019\n\n1. [](#new)\n    * Added `FormTrait::getAllFlashes()` method to get all the available form flash objects for the form\n    * Added creation and update timestamps to `FormFlash` objects\n1. [](#improved)\n    * Added `FormFlashInterface`, changed constructor to take `$config` array\n1. [](#bugfix)\n    * Fixed error in `ImageMedium::url()` if the image cache folder does not exist\n    * Fixed empty form flash name after file upload or form state update\n    * Fixed a bug in `Route::withParam()` method\n    * Fixed issue with `FormFlash` objects when there is no session initialized\n\n# v1.6.10\n## 06/14/2019\n\n1. [](#improved)\n    * Added **page blueprints** to `YamlLinter` CLI and Admin reports\n    * Removed `Gitter` and `Slack` [#2502](https://github.com/getgrav/grav/issues/2502)\n    * Optimizations for Plugin/Theme loading\n    * Generalized markdown classes so they can be used outside of `Page` scope with a custom `Excerpts` class instance\n    * Change minimal port number to 0 (unix socket) [#2452](https://github.com/getgrav/grav/issues/2452)\n1. [](#bugfix)\n    * Force question to install demo content in theme update [#2493](https://github.com/getgrav/grav/issues/2493)\n    * Fixed GPM errors from blueprints not being logged [#2505](https://github.com/getgrav/grav/issues/2505)\n    * Don't error when IP is invalid [#2507](https://github.com/getgrav/grav/issues/2507)\n    * Fixed regression with `bin/plugin` not listing the plugins available (1c725c0)\n    * Fixed bitwise operator in `TwigExtension::exifFunc()` [#2518](https://github.com/getgrav/grav/issues/2518)\n    * Fixed issue with lang prefix incorrectly identifying as admin [#2511](https://github.com/getgrav/grav/issues/2511)\n    * Fixed issue with `U0ils::pathPrefixedBYLanguageCode()` and trailing slash [#2510](https://github.com/getgrav/grav/issues/2511)\n    * Fixed regresssion issue of `Utils::Url()` not returning `false` on failure. Added new optional `fail_gracefully` 3rd attribute to return string that caused failure [#2524](https://github.com/getgrav/grav/issues/2524)\n\n# v1.6.9\n## 05/09/2019\n\n1. [](#new)\n    * Added `Route::withoutParams()` methods\n    * Added `Pages::setCheckMethod()` method to override page configuration in Admin Plugin\n    * Added `Cache::clearCache('invalidate')` parameter for just invalidating the cache without deleting any cached files\n    * Made `UserCollectionInderface` to extend `Countable` to get the count of existing users\n1. [](#improved)\n    * Flex admin: added default search options for flex objects\n    * Flex collection and object now fall back to the default template if template file doesn't exist\n    * Updated Vendor libraries including Twig 1.40.1\n    * Updated language files from `https://crowdin.com/project/grav-core`\n1. [](#bugfix)\n    * Fixed `$grav['route']` from being modified when the route instance gets modified\n    * Fixed Assets options array mixed with standalone priority [#2477](https://github.com/getgrav/grav/issues/2477)\n    * Fix for `avatar_url` provided by 3rd party providers\n    * Fixed non standard `lang` code lengths in `Utils` and `Session` detection\n    * Fixed saving a new object in Flex `SimpleStorage`\n    * Fixed exception in `Flex::getDirectories()` if the first parameter is set\n    * Output correct \"Last Updated\" in `bin/gpm info` command\n    * Checkbox getting interpreted as string, so created new `Validation::filterCheckbox()`\n    * Fixed backwards compatibility to `select` field with `selectize.create` set to true [git-sync#141](https://github.com/trilbymedia/grav-plugin-git-sync/issues/141)\n    * Fixed `YamlFormatter::decode()` to always return array [#2494](https://github.com/getgrav/grav/pull/2494)\n    * Fixed empty `$grav['request']->getAttribute('route')->getExtension()`\n\n# v1.6.8\n## 04/23/2019\n\n1. [](#new)\n    * Added `FlexCollection::filterBy()` method\n1. [](#bugfix)\n    * Revert `Use Null Coalesce Operator` [#2466](https://github.com/getgrav/grav/pull/2466)\n    * Fixed `FormTrait::render()` not providing config variable\n    * Updated `bin/grav clean` to clear `cache/compiled` and `user/config/security.yaml`\n\n# v1.6.7\n## 04/22/2019\n\n1. [](#new)\n    * Added a new `bin/grav yamllinter` CLI command to find YAML Linting issues [#2468](https://github.com/getgrav/grav/issues/2468#issuecomment-485151681)\n1. [](#improved)\n    * Improve `FormTrait` backwards compatibility with existing forms\n    * Added a new `Utils::getSubnet()` function for IPv4/IPv6 parsing [#2465](https://github.com/getgrav/grav/pull/2465)\n1. [](#bugfix)\n    * Remove disabled fields from the form schema\n    * Fix issue when excluding `inlineJs` and `inlineCss` from Assets pipeline [#2468](https://github.com/getgrav/grav/issues/2468)\n    * Fix for manually set position on external URLs [#2470](https://github.com/getgrav/grav/issues/2470)\n\n# v1.6.6\n## 04/17/2019\n\n1. [](#new)\n    * `FormInterface` now implements `RenderInterface`\n    * Added new `FormInterface::getTask()` method which reads the task from `form.task` in the blueprint\n1. [](#improved)\n    * Updated vendor libraries to latest\n1. [](#bugfix)\n    * Rollback `redirect_default_route` logic as it has issues with multi-lang [#2459](https://github.com/getgrav/grav/issues/2459)\n    * Fix potential issue with `|contains` Twig filter on PHP 7.3\n    * Fixed bug in text field filtering: return empty string if value isn't a string or number [#2460](https://github.com/getgrav/grav/issues/2460)\n    * Force Asset `priority` to be an integer and not throw error if invalid string passed [#2461](https://github.com/getgrav/grav/issues/2461)\n    * Fixed bug in text field filtering: return empty string if value isn't a string or number\n    * Fixed `FlexForm` missing getter methods for defining form variables\n\n# v1.6.5\n## 04/15/2019\n\n1. [](#bugfix)\n    * Backwards compatiblity with old `Uri::__toString()` output\n\n# v1.6.4\n## 04/15/2019\n\n1. [](#bugfix)\n    * Improved `redirect_default_route` logic as well as `Uri::toArray()` to take into account `root_path` and `extension`\n    * Rework logic to pull out excluded files from pipeline more reliably [#2445](https://github.com/getgrav/grav/issues/2445)\n    * Better logic in `Utils::normalizePath` to handle externals properly [#2216](https://github.com/getgrav/grav/issues/2216)\n    * Fixed to force all `Page::taxonomy` to be treated as strings [#2446](https://github.com/getgrav/grav/issues/2446)\n    * Fixed issue with `Grav['user']` not being available [form#332](https://github.com/getgrav/grav-plugin-form/issues/332)\n    * Updated rounding logic for `Utils::parseSize()` [#2394](https://github.com/getgrav/grav/issues/2394)\n    * Fixed Flex simple storage not being properly initialized if used with caching\n\n# v1.6.3\n## 04/12/2019\n\n1. [](#new)\n    * Added `Blueprint::addDynamicHandler()` method to allow custom dynamic handlers, for example `custom-options@: getCustomOptions`\n1. [](#bugfix)\n    * Missed a `CacheCommand` reference in `bin/grav` [#2442](https://github.com/getgrav/grav/issues/2442)\n    * Fixed issue with `Utils::normalizePath` messing with external URLs [#2216](https://github.com/getgrav/grav/issues/2216)\n    * Fix for `vUndefined` versions when upgrading\n\n# v1.6.2\n## 04/11/2019\n\n1. [](#bugfix)\n    * Revert renaming of `ClearCacheCommand` to ensure CLI GPM upgrades go smoothly\n\n# v1.6.1\n## 04/11/2019\n\n1. [](#improved)\n    * Improved CSS for the bottom filter bar of DebugBar\n1. [](#bugfix)\n    * Fixed issue with `@import` not being added to top of pipelined css [#2440](https://github.com/getgrav/grav/issues/2440)\n\n# v1.6.0\n## 04/11/2019\n\n1. [](#new)\n    * Set minimum requirements to [PHP 7.1.3](https://getgrav.org/blog/raising-php-requirements-2018)\n    * New `Scheduler` functionality for periodic jobs\n    * New `Backup` functionality with multiple backup profiles and scheduler integration\n    * Refactored `Assets Manager` to be more powerful and flexible\n    * Updated Doctrine Collections to 1.6\n    * Updated Doctrine Cache to 1.8\n    * Updated Symfony Components to 4.2\n    * Added new Cache purge functionality old cache manually via CLI/Admin as well as scheduler integration\n    * Added new `{% throw 404 'Not Found' %}` twig tag (with custom code/message)\n    * Added `Grav\\Framework\\File` classes for handling YAML, Markdown, JSON, INI and PHP serialized files\n    * Added `Grav\\Framework\\Collection\\AbstractIndexCollection` class\n    * Added `Grav\\Framework\\Object\\ObjectIndex` class\n    * Added `Grav\\Framework\\Flex` classes\n    * Added support for hiding form fields in blueprints by using dynamic property like `security@: admin.foobar`, `scope@: object` or `scope-ignore@: object` to any field\n    * New experimental **FlexObjects** powered `Users` for increased performance and capability (**disabled** by default)\n    * Added PSR-7 and PSR-15 classes\n    * Added `Grav\\Framework\\DI\\Container` class\n    * Added `Grav\\Framework\\RequestHandler\\RequestHandler` class\n    * Added `Page::httpResponseCode()` and `Page::httpHeaders()` methods\n    * Added `Grav\\Framework\\Form\\Interfaces\\FormInterface`\n    * Added `Grav\\Framework\\Form\\Interfaces\\FormFactoryInterface`\n    * Added `Grav\\Framework\\Form\\FormTrait`\n    * Added `Page::forms()` method to get normalized list of all form headers defined in the page\n    * Added `onPageAction`, `onPageTask`, `onPageAction.{$action}` and `onPageTask.{$task}` events\n    * Added `Blueprint::processForm()` method to filter form inputs\n    * Move `processMarkdown()` method from `TwigExtension` to more general `Utils` class\n    * Added support to include extra files into `Media` (such as uploaded files)\n    * Added form preview support for `FlexObject`, including a way to render newly uploaded files before saving them\n    * Added `FlexObject::getChanges()` to determine what fields change during an update\n    * Added `arrayDiffMultidimensional`, `arrayIsAssociative`, `arrayCombine` Util functions\n    * New `$grav['users']` service to allow custom user classes implementing `UserInterface`\n    * Added `LogViewer` helper class and CLI command: `bin/grav logviewer`\n    * Added `select()` and `unselect()` methods to `CollectionInterface` and its base classes\n    * Added `orderBy()` and `limit()` methods to `ObjectCollectionInterface` and its base classes\n    * Added `user-data://` which is a writable stream (`user://data` is not and should be avoided)\n    * Added support for `/action:{$action}` (like task but used without nonce when only receiving data)\n    * Added `onAction.{$action}` event\n    * Added `Grav\\Framework\\Form\\FormFlash` class to contain AJAX uploaded files in more reliable way\n    * Added `Grav\\Framework\\Form\\FormFlashFile` class which implements `UploadedFileInterface` from PSR-7\n    * Added `Grav\\Framework\\Filesystem\\Filesystem` class with methods to manipulate stream URLs\n    * Added new `$grav['filesystem']` service using an instance of the new `Filesystem` object\n    * Added `{% render object layout: 'default' with { variable: true } %}` for Flex objects and collections\n    * Added `$grav->setup()` to simplify CLI and custom access points\n    * Added `CsvFormatter` and `CsvFile` classes\n    * Added new system config option to `pages.hide_empty_folders` if a folder has no valid `.md` file available. Default behavior is `false` for compatibility.\n    * Added new system config option for `languages.pages_fallback_only` forcing only 'fallback' to find page content through supported languages, default behavior is to display any language found if active language is missing\n    * Added `Utils::arrayFlattenDotNotation()` and `Utils::arrayUnflattenDotNotation()` helper methods\n1. [](#improved)\n    * Add the page to onMarkdownInitialized event [#2412](https://github.com/getgrav/grav/issues/2412)\n    * Doctrine filecache is now namespaced with prefix to support purging\n    * Register all page types into `blueprint://pages` stream\n    * Removed `apc` and `xcache` support, made `apc` alias of `apcu`\n    * Support admin and regular translations via the `|t` twig filter and `t()` twig function\n    * Improved Grav Core installer/updater to run installer script\n    * Updated vendor libraries including Symfony `4.2.3`\n    * Renamed old `User` class to `Grav\\Common\\User\\DataUser\\User` with multiple improvements and small fixes\n    * `User` class now acts as a compatibility layer to older versions of Grav\n    * Deprecated `new User()`, `User::load()`, `User::find()` and `User::delete()` in favor of `$grav['users']` service\n    * `Media` constructor has now support to not to initialize the media objects\n    * Cleanly handle session corruption due to changing Flex object types\n    * Added `FlexObjectInterface::getDefaultValue()` and `FormInterface::getDefaultValue()`\n    * Added new `onPageContent()` event for every call to `Page::content()`\n    * Added phpstan: PHP Static Analysis Tool [#2393](https://github.com/getgrav/grav/pull/2393)\n    * Added `composer test-plugins` to test plugin issues with the current version of Grav\n    * Added `Flex::getObjects()` and `Flex::getMixedCollection()` methods for co-mingled collections\n    * Added support to use single Flex key parameter in `Flex::getObject()` method\n    * Added `FlexObjectInterface::search()` and `FlexCollectionInterface::search()` methods\n    * Override `system.media.upload_limit` with PHP's `post_max_size` or `upload_max_filesize`\n    * Class `Grav\\Common\\Page\\Medium\\AbstractMedia` now use array traits instead of extending `Grav\\Common\\Getters`\n    * Implemented `Grav\\Framework\\Psr7` classes as `Nyholm/psr7` decorators\n    * Added a new `cache-clear` scheduled job to go along with `cache-purge`\n    * Renamed `Grav\\Framework\\File\\Formatter\\FormatterInterface` to `Grav\\Framework\\File\\Interfaces\\FileFormatterInterface`\n    * Improved `File::save()` to use a temporary file if file isn't locked\n    * Improved `|t` filter to better support admin `|tu` style filter if in admin\n    * Update all classes to rely on `PageInterface` instead of `Page` class\n    * Better error checking in `bin/plugin` for existence and enabled\n    * Removed `media.upload_limit` references\n    * Twig `nicenumber`: do not use 0 + string casting hack\n    * Converted Twig tags to use namespaced Twig classes\n    * Site shows error on page rather than hard-crash when page has invalid frontmatter [#2343](https://github.com/getgrav/grav/issues/2343)\n    * Added `languages.default_lang` option to override the default lang (usually first supported language)\n    * Added `Content-Type: application/json` body support for PSR-7 `ServerRequest`\n    * Remove PHP time limit in `ZipArchive`\n    * DebugBar: Resolve twig templates in deprecated backtraces in order to help locating Twig issues\n    * Added `$grav['cache']->getSimpleCache()` method for getting PSR-16 compatible cache\n    * MediaTrait: Use PSR-16 cache\n    * Improved `Utils::normalizePath()` to support non-protocol URLs\n    * Added ability to reset `Page::metadata` to allow rebuilding from automatically generated values\n    * Added back missing `page.types` field in system content configuration [admin#1612](https://github.com/getgrav/grav-plugin-admin/issues/1612)\n    * Console commands: add method for invalidating cache\n    * Updated languages\n    * Improved `$page->forms()` call, added `$page->addForms()`\n    * Updated languages from crowdin\n    * Fixed `ImageMedium` constructor warning when file does not exist\n    * Improved `Grav\\Common\\User` class; added `$user->update()` method\n    * Added trim support for text input fields `validate: trim: true`\n    * Improved `Grav\\Framework\\File\\Formatter` classes to have abstract parent class and some useful methods\n    * Support negotiated content types set via the Request `Accept:` header\n    * Support negotiated language types set via the Request `Accept-Language:` header\n    * Cleaned up and sorted the Service `idMap`\n    * Updated `Grav` container object to implement PSR-11 `ContainerInterface`\n    * Updated Grav `Processor` classes to implement PSR-15 `MiddlewareInterface`\n    * Make `Data` class to extend `JsonSerializable`\n    * Modified debugger icon to use retina space-dude version\n    * Added missing `Video::preload()` method\n    * Set session name based on `security.salt` rather than `GRAV_ROOT` [#2242](https://github.com/getgrav/grav/issues/2242)\n    * Added option to configure list of `xss_invalid_protocols` in `Security` config [#2250](https://github.com/getgrav/grav/issues/2250)\n    * Smarter `security.salt` checking now we use `security.yaml` for other options\n    * Added apcu autoloader optimization\n    * Additional helper methods in `Language`, `Languages`, and `LanguageCodes` classes\n    * Call `onFatalException` event also on internal PHP errors\n    * Built-in PHP Webserver: log requests before handling them\n    * Added support for syslog and syslog facility logging (default: 'file')\n    * Improved usability of `System` configuration blueprint with side-tabs\n 1. [](#bugfix)\n    * Fixed issue with `Truncator::truncateWords` and `Truncator::truncateLetters` when string not wrapped in tags [#2432](https://github.com/getgrav/grav/issues/2432)\n    * Fixed `Undefined method closure::fields()` when getting avatar for user, thanks @Romarain [#2422](https://github.com/getgrav/grav/issues/2422)\n    * Fixed cached images not being updated when source image is modified\n    * Fixed deleting last list item in the form\n    * Fixed issue with `Utils::url()` method would append extra `base_url` if URL already included it\n    * Fixed `mkdir(...)` race condition\n    * Fixed `Obtaining write lock failed on file...`\n    * Fixed potential undefined property in `onPageNotFound` event handling\n    * Fixed some potential issues/bugs found by phpstan\n    * Fixed regression in GPM packages casted to Array (ref, getgrav/grav-plugin-admin@e3fc4ce)\n    * Fixed session_start(): Setting option 'session.name' failed [#2408](https://github.com/getgrav/grav/issues/2408)\n    * Fixed validation for select field type with selectize\n    * Fixed validation for boolean toggles\n    * Fixed non-namespaced exceptions in scheduler\n    * Fixed trailing slash redirect in multlang environment [#2350](https://github.com/getgrav/grav/issues/2350)\n    * Fixed some issues related to Medium objects losing query string attributes\n    * Broke out Medium timestamp so it's not cleared on `reset()`s\n    * Fixed issue with `redirect_trailing_slash` losing query string [#2269](https://github.com/getgrav/grav/issues/2269)\n    * Fixed failed login if user attempts to log in with upper case non-english letters\n    * Removed extra authenticated/authorized fields when saving existing user from a form\n    * Fixed `Grav\\Framework\\Route::__toString()` returning relative URL, not relative route\n    * Fixed handling of `append_url_extension` inside of `Page::templateFormat()` [#2264](https://github.com/getgrav/grav/issues/2264)\n    * Fixed a broken language string [#2261](https://github.com/getgrav/grav/issues/2261)\n    * Fixed clearing cache having no effect on Doctrine cache\n    * Fixed `Medium::relativePath()` for streams\n    * Fixed `Object` serialization breaking if overriding `jsonSerialize()` method\n    * Fixed `YamlFormatter::decode()` when calling `init_set()` with integer\n    * Fixed session throwing error in CLI if initialized\n    * Fixed `Uri::hasStandardPort()` to support reverse proxy configurations [#1786](https://github.com/getgrav/grav/issues/1786)\n    * Use `append_url_extension` from page header to set template format if set [#2604](https://github.com/getgrav/grav/pull/2064)\n    * Fixed some bugs in Grav environment selection logic\n    * Use login provider User avatar if set\n    * Fixed `Folder::doDelete($folder, false)` removing symlink when it should not\n    * Fixed asset manager to not add empty assets when they don't exist in the filesystem\n    * Update `script` and `style` Twig tags to use the new `Assets` classes\n    * Fixed asset pipeline to rewrite remote URLs as well as local [#2216](https://github.com/getgrav/grav/issues/2216)\n\n# v1.5.10\n## 03/21/2019\n\n1. [](#new)\n    * Added new `deferred` Twig extension\n\n# v1.5.9\n## 03/20/2019\n\n1. [](#new)\n    * Added new `onPageContent()` event for every call to `Page::content()`\n1. [](#improved)\n    * Fixed phpdoc generation\n    * Updated vendor libraries\n    * Force Toolbox v1.4.2\n1. [](#bugfix)\n    * EXIF fix for streams\n    * Fix for User avatar not working due to uppercase or spaces in email [#2403](https://github.com/getgrav/grav/pull/2403)\n\n# v1.5.8\n## 02/07/2019\n\n1. [](#improved)\n    * Improved `User` unserialize to not to break the object if serialized data is not what expected\n    * Removed unused parameter [#2357](https://github.com/getgrav/grav/pull/2357)\n\n# v1.5.7\n## 01/25/2019\n\n1. [](#new)\n    * Support for AWS Cloudfront forwarded scheme header [#2297](https://github.com/getgrav/grav/pull/2297)\n1. [](#improved)\n    * Set homepage with `https://` protocol [#2299](https://github.com/getgrav/grav/pull/2299)\n    * Preserve accents in fields containing Twig expr. using unicode [#2279](https://github.com/getgrav/grav/pull/2279)\n    * Updated vendor libraries\n1. [](#bugfix)\n    * Support spaces with filenames in responsive images [#2300](https://github.com/getgrav/grav/pull/2300)\n\n# v1.5.6\n## 12/14/2018\n\n1. [](#improved)\n    * Updated InitializeProcessor.php to use lang-safe redirect [#2268](https://github.com/getgrav/grav/pull/2268)\n    * Improved user serialization to use less memory in the session\n\n# v1.5.5\n## 11/12/2018\n\n1. [](#new)\n    * Register theme prefixes as namespaces in Twig [#2210](https://github.com/getgrav/grav/pull/2210)\n1. [](#improved)\n    * Propogate error code between 400 and 600 for production sites [#2181](https://github.com/getgrav/grav/pull/2181)\n1. [](#bugfix)\n    * Remove hardcoded `302` when redirecting trailing slash [#2155](https://github.com/getgrav/grav/pull/2155)\n\n# v1.5.4\n## 11/05/2018\n\n1. [](#improved)\n    * Updated default page `index.md` with some consistency fixes [#2245](https://github.com/getgrav/grav/pull/2245)\n1. [](#bugfix)\n    * Fixed fatal error if calling `$session->invalidate()` when there's no active session\n    * Fixed typo in media.yaml for `webm` extension [#2220](https://github.com/getgrav/grav/pull/2220)\n    * Fixed markdown processing for telephone links [#2235](https://github.com/getgrav/grav/pull/2235)\n\n# v1.5.3\n## 10/08/2018\n\n1. [](#new)\n    * Added `Utils::getMimeByFilename()`, `Utils::getMimeByLocalFile()` and `Utils::checkFilename()` methods\n    * Added configurable dangerous upload extensions in `security.yaml`\n1. [](#improved)\n    * Updated vendor libraries to latest\n\n# v1.5.2\n## 10/01/2018\n\n1. [](#new)\n    * Added new `Security` class for Grav security functionality including XSS checks\n    * Added new `bin/grav security` command to scan for security issues\n    * Added new `xss()` Twig function to allow for XSS checks on strings and arrays\n    * Added `onHttpPostFilter` event to allow plugins to globally clean up XSS in the forms and tasks\n    * Added `Deprecated` tab to DebugBar to catch future incompatibilities with later Grav versions\n    * Added deprecation notices for features which will be removed in Grav 2.0\n1. [](#improved)\n    * Updated vendor libraries to latest\n1. [](#bugfix)\n    * Allow `$page->slug()` to be called before `$page->init()` without breaking the page\n    * Fix for `Page::translatedLanguages()` to use routes always [#2163](https://github.com/getgrav/grav/issues/2163)\n    * Fixed `nicetime()` twig function\n    * Allow twig tags `{% script %}`, `{% style %}` and `{% switch %}` to be placed outside of blocks\n    * Session expires in 30 mins independent from config settings [login#178](https://github.com/getgrav/grav-plugin-login/issues/178)\n\n# v1.5.1\n## 08/23/2018\n\n1. [](#new)\n    * Added static `Grav\\Common\\Yaml` class which should be used instead of `Symfony\\Component\\Yaml\\Yaml`\n1. [](#improved)\n    * Updated deprecated Twig code so it works in both in Twig 1.34+ and Twig 2.4+\n    * Switched to new Grav Yaml class to support Native + Fallback YAML libraries\n1. [](#bugfix)\n    * Broken handling of user folder in Grav URI object [#2151](https://github.com/getgrav/grav/issues/2151)\n\n# v1.5.0\n## 08/17/2018\n\n1. [](#new)\n    * Set minimum requirements to [PHP 5.6.4](https://getgrav.org/blog/raising-php-requirements-2018)\n    * Updated Doctrine Collections to 1.4\n    * Updated Symfony Components to 3.4 (with compatibility mode to fall back to Symfony YAML 2.8)\n    * Added `Uri::method()` to get current HTTP method (GET/POST etc)\n    * `FormatterInterface`: Added `getSupportedFileExtensions()` and `getDefaultFileExtension()` methods\n    * Added option to disable `SimpleCache` key validation\n    * Added support for multiple repo locations for `bin/grav install` command\n    * Added twig filters for casting values: `|string`, `|int`, `|bool`, `|float`, `|array`\n    * Made `ObjectCollection::matching()` criteria expressions to behave more like in Twig\n    * Criteria: Added support for `LENGTH()`, `LOWER()`, `UPPER()`, `LTRIM()`, `RTRIM()` and `TRIM()`\n    * Added `Grav\\Framework\\File\\Formatter` classes for encoding/decoding YAML, Markdown, JSON, INI and PHP serialized strings\n    * Added `Grav\\Framework\\Session` class to replace `RocketTheme\\Toolbox\\Session\\Session`\n    * Added `Grav\\Common\\Media` interfaces and trait; use those in `Page` and `Media` classes\n    * Added `Grav\\Common\\Page` interface to allow custom page types in the future\n    * Added setting to disable sessions from the site [#2013](https://github.com/getgrav/grav/issues/2013)\n    * Added new `strict_mode` settings in `system.yaml` for compatibility\n1. [](#improved)\n    * Improved `Utils::url()` to support query strings\n    * Display better exception message if Grav fails to initialize\n    * Added `muted` and `playsinline` support to videos [#2124](https://github.com/getgrav/grav/pull/2124)\n    * Added `MediaTrait::clearMediaCache()` to allow cache to be cleared\n    * Added `MediaTrait::getMediaCache()` to allow custom caching\n    * Improved session handling, allow all session configuration options in `system.session.options`\n1. [](#bugfix)\n    * Fix broken form nonce logic [#2121](https://github.com/getgrav/grav/pull/2121)\n    * Fixed issue with uppercase extensions and fallback media URLs [#2133](https://github.com/getgrav/grav/issues/2133)\n    * Fixed theme inheritance issue with `camel-case` that includes numbers [#2134](https://github.com/getgrav/grav/issues/2134)\n    * Typo in demo typography page [#2136](https://github.com/getgrav/grav/pull/2136)\n    * Fix for incorrect plugin order in debugger panel\n    * Made `|markdown` filter HTML safe\n    * Fixed bug in `ContentBlock` serialization\n    * Fixed `Route::withQueryParam()` to accept array values\n    * Fixed typo in truncate function [#1943](https://github.com/getgrav/grav/issues/1943)\n    * Fixed blueprint field validation: Allow numeric inputs in text fields\n\n# v1.4.8\n## 07/31/2018\n\n1. [](#improved)\n    * Add Grav version to debug bar messages tab [#2106](https://github.com/getgrav/grav/pull/2106)\n    * Add Nginx config for ddev project to `webserver-configs` [#2117](https://github.com/getgrav/grav/pull/2117)\n    * Vendor library updates\n1. [](#bugfix)\n    * Don't allow `null` to be set as Page content\n\n# v1.4.7\n## 07/13/2018\n\n1. [](#improved)\n    * Use `getFilename` instead of `getBasename` [#2087](https://github.com/getgrav/grav/issues/2087)\n1. [](#bugfix)\n    * Fix for modular page preview [#2066](https://github.com/getgrav/grav/issues/2066)\n    * `Page::routeCanonical()` should be string not array [#2069](https://github.com/getgrav/grav/issues/2069)\n\n# v1.4.6\n## 06/20/2018\n\n1. [](#improved)\n    * Manually re-added the improved SSL off-loading that was lost with Grav v1.4.0 merge [#1888](https://github.com/getgrav/grav/pull/1888)\n    * Handle multibyte strings in `truncateLetters()` [#2007](https://github.com/getgrav/grav/pull/2007)\n    * Updated robots.txt to include `/user/images/` folder [#2043](https://github.com/getgrav/grav/pull/2043)\n    * Add getter methods for original and action to the Page object [#2005](https://github.com/getgrav/grav/pull/2005)\n    * Modular template extension follows the master page extension [#2044](https://github.com/getgrav/grav/pull/2044)\n    * Vendor library updates\n1. [](#bugfix)\n    * Handle `errors.display` system property better in admin plugin [admin#1452](https://github.com/getgrav/grav-plugin-admin/issues/1452)\n    * Fix classes on non-http based protocol links [#2034](https://github.com/getgrav/grav/issues/2034)\n    * Fixed crash on IIS (Windows) with open_basedir in effect [#2053](https://github.com/getgrav/grav/issues/2053)\n    * Fixed incorrect routing with setup.php based base [#1892](https://github.com/getgrav/grav/issues/1892)\n    * Fixed image resource memory deallocation [#2045](https://github.com/getgrav/grav/pull/2045)\n    * Fixed issue with Errors `display:` option not handling integers properly [admin#1452](https://github.com/getgrav/grav-plugin-admin/issues/1452)\n\n# v1.4.5\n## 05/15/2018\n\n1. [](#bugfix)\n    * Fixed an issue with some users getting **2FA** prompt after upgrade [admin#1442](https://github.com/getgrav/grav-plugin-admin/issues/1442)\n    * Do not crash when generating URLs with arrays as parameters [#2018](https://github.com/getgrav/grav/pull/2018)\n    * Utils::truncateHTML removes whitespace when generating summaries [#2004](https://github.com/getgrav/grav/pull/2004)\n\n# v1.4.4\n## 05/11/2018\n\n1. [](#new)\n    * Added support for `Uri::post()` and `Uri::getConentType()`\n    * Added a new `Medium:thumbnailExists()` function [#1966](https://github.com/getgrav/grav/issues/1966)\n    * Added `authorized` support for 2FA\n1. [](#improved)\n    * Added default configuration for images [#1979](https://github.com/getgrav/grav/pull/1979)\n    * Added dedicated PHPUnit assertions [#1990](https://github.com/getgrav/grav/pull/1990)\n1. [](#bugfix)\n    * Use `array_key_exists` instead of `in_array + array_keys` [#1991](https://github.com/getgrav/grav/pull/1991)\n    * Fixed an issue with `custom_base_url` always causing 404 errors\n    * Improve support for regex redirects with query and params [#1983](https://github.com/getgrav/grav/issues/1983)\n    * Changed collection-based date sorting to `SORT_REGULAR` for better server compatibility [#1910](https://github.com/getgrav/grav/issues/1910)\n    * Fix hardcoded string in modular blueprint [#1933](https://github.com/getgrav/grav/pull/1993)\n\n# v1.4.3\n## 04/12/2018\n\n1. [](#new)\n    * moved Twig `sortArrayByKey` logic into `Utils::` class\n1. [](#improved)\n    * Rolled back Parsedown library to stable `1.6.4` until a better solution for `1.8.0` compatibility can fe found\n    * Updated vendor libraries to latest versions\n1. [](#bugfix)\n    * Fix for bad reference to `ZipArchive` in `GPM::Installer`\n\n# v1.4.2\n## 03/21/2018\n\n1. [](#new)\n    * Added new `|nicefilesize` Twig filter for pretty file (auto converts to bytes, kB, MB, GB, etc)\n    * Added new `regex_filter()` Twig function to values in arrays\n1. [](#improved)\n    * Added bosnian to lang codes [#1917](\ufeffhttps://github.com/getgrav/grav/issues/1917)\n    * Improved Zip extraction error codes [#1922](\ufeffhttps://github.com/getgrav/grav/issues/1922)\n1. [](#bugfix)\n    * Fixed an issue with Markdown Video and Audio that broke after Parsedown 1.7.0 Security updates [#1924](\ufeffhttps://github.com/getgrav/grav/issues/1924)\n    * Fix for case-sensitive page metadata [admin#1370](https://github.com/getgrav/grav-plugin-admin/issues/1370)\n    * Fixed missing composer requirements for the new `Grav\\Framework\\Uri` classes\n    * Added missing PSR-7 vendor library required for URI additions in Grav 1.4.0\n\n# v1.4.1\n## 03/11/2018\n\n1. [](#bugfix)\n    * Fixed session timing out because of session cookie was not being sent\n\n# v1.4.0\n## 03/09/2018\n\n1. [](#new)\n    * Added `Grav\\Framework\\Uri` classes extending PSR-7 `HTTP message UriInterface` implementation\n    * Added `Grav\\Framework\\Route` classes to allow route/link manipulation\n    * Added `$grav['uri]->getCurrentUri()` method to get `Grav\\Framework\\Uri\\Uri` instance for the current URL\n    * Added `$grav['uri]->getCurrentRoute()` method to get `Grav\\Framework\\Route\\Route` instance for the current URL\n    * Added ability to have `php` version dependencies in GPM assets\n    * Added new `{% switch %}` twig tag for more elegant if statements\n    * Added new `{% markdown %}` twig tag\n    * Added **Route Overrides** to the default page blueprint\n    * Added new `Collection::toExtendedArray()` method that's particularly useful for Json output of data\n    * Added new `|yaml_encode` and `|yaml_decode` Twig filter to convert to and from YAML\n    * Added new `read_file()` Twig function to allow you to load and display a file in Twig (Supports streams and regular paths)\n    * Added a new `Medium::exists()` method to check for file existence\n    * Moved Twig `urlFunc()` to `Utils::url()` as its so darn handy\n    * Transferred overall copyright from RocketTheme, LLC, to Trilby Media LLC\n    * Added `theme_var`, `header_var` and `body_class` Twig functions for themes\n    * Added `Grav\\Framework\\Cache` classes providing PSR-16 `Simple Cache` implementation\n    * Added `Grav\\Framework\\ContentBlock` classes for nested HTML blocks with CSS/JS assets\n    * Added `Grav\\Framework\\Object` classes for creating collections of objects\n    * Added `|nicenumber` Twig filter\n    * Added `{% try %} ... {% catch %} Error: {{ e.message }} {% endcatch %}` tag to allow basic exception handling inside Twig\n    * Added `{% script %}` and `{% style %}` tags for Twig templates\n    * Deprecated GravTrait\n1. [](#improved)\n    * Improved `Session` initialization\n    * Added ability to set a `theme_var()` option in page frontmatter\n    * Force clearing PHP `clearstatcache` and `opcache-reset` on `Cache::clear()`\n    * Better `Page.collection()` filtering support including ability to have non-published pages in collections\n    * Stopped Chrome from auto-completing admin user profile form [#1847](https://github.com/getgrav/grav/issues/1847)\n    * Support for empty `switch` field like a `checkbox`\n    * Made `modular` blueprint more flexible\n    * Code optimizations to `Utils` class [#1830](https://github.com/getgrav/grav/pull/1830)\n    * Objects: Add protected function `getElement()` to get serialized value for a single property\n    * `ObjectPropertyTrait`: Added protected functions `isPropertyLoaded()`, `offsetLoad()`, `offsetPrepare()` and `offsetSerialize()`\n    * `Grav\\Framework\\Cache`: Allow unlimited TTL\n    * Optimizations & refactoring to the test suite [#1779](https://github.com/getgrav/grav/pull/1779)\n    * Slight modification of Whoops error colors\n    * Added new configuration option `system.session.initialize` to delay session initialization if needed by a plugin\n    * Updated vendor libraries to latest versions\n    * Removed constructor from `ObjectInterface`\n    * Make it possible to include debug bar also into non-HTML responses\n    * Updated built-in JQuery to latest 3.3.1\n1. [](#bugfix)\n    * Fixed issue with image alt tag always getting empted out unless set in markdown\n    * Fixed issue with remote PHP version determination for Grav updates [#1883](https://github.com/getgrav/grav/issues/1883)\n    * Fixed issue with _illegal scheme offset_ in `Uri::convertUrl()` [page-inject#8](https://github.com/getgrav/grav-plugin-page-inject/issues/8)\n    * Properly validate YAML blueprint fields so admin can save as proper YAML now  [addresses many issues]\n    * Fixed OpenGraph metatags so only Twitter uses `name=`, and all others use `property=` [#1849](https://github.com/getgrav/grav/issues/1849)\n    * Fixed an issue with `evaluate()` and `evaluate_twig()` Twig functions that throws invalid template error\n    * Fixed issue with `|sort_by_key` twig filter if the input was null or not an array\n    * Date ordering should always be numeric [#1810](https://github.com/getgrav/grav/issues/1810)\n    * Fix for base paths containing special characters [#1799](https://github.com/getgrav/grav/issues/1799)\n    * Fix for session cookies in paths containing special characters\n    * Fix for `vundefined` error for version numbers in GPM [form#222](https://github.com/getgrav/grav-plugin-form/issues/222)\n    * Fixed `BadMethodCallException` thrown in GPM updates [#1784](https://github.com/getgrav/grav/issues/1784)\n    * NOTE: Parsedown security release now escapes `&` to `&amp;` in Markdown links\n\n# v1.3.10\n## 12/06/2017\n\n1. [](#bugfix)\n    * Reverted GPM Local pull request as it broken admin [#1742](https://github.com/getgrav/grav/issues/1742)\n\n# v1.3.9\n## 12/05/2017\n\n1. [](#new)\n    * Added new core Twig templates for `partials/metadata.html.twig` and `partials/messages.html.twig`\n    * Added ability to work with GPM locally [#1742](https://github.com/getgrav/grav/issues/1742)\n    * Added new HTML5 audio controls [#1756](https://github.com/getgrav/grav/issues/1756)\n    * Added `Medium::copy()` method to create a copy of a medium object\n    * Added new `force_lowercase_urls` functionality on routes and slugs\n    * Added new `item-list` filter type to remove empty items\n    * Added new `setFlashCookieObject()` and `getFlashCookieObject()` methods to `Session` object\n    * Added new `intl_enabled` option to disable PHP intl module collation when not needed\n1. [](#bugfix)\n    * Fixed an issue with checkbox field validation [form#216](https://github.com/getgrav/grav-plugin-form/issues/216)\n    * Fixed issue with multibyte Markdown link URLs [#1749](https://github.com/getgrav/grav/issues/1749)\n    * Fixed issue with multibyte folder names [#1751](https://github.com/getgrav/grav/issues/1751)\n    * Fixed several issues related to `system.custom_base_url` that were broken [#1736](https://github.com/getgrav/grav/issues/1736)\n    * Dynamically added pages via `Pages::addPage()` were not firing `onPageProcessed()` event causing forms not to be processed\n    * Fixed `Page::active()` and `Page::activeChild()` to work with UTF-8 characters in the URL [#1727](https://github.com/getgrav/grav/issues/1727)\n    * Fixed typo in `modular.yaml` causing media to be ignored [#1725](https://github.com/getgrav/grav/issues/1725)\n    * Reverted `case_insensitive_urls` option as it was causing issues with taxonomy [#1733](https://github.com/getgrav/grav/pull/1733)\n    * Removed an extra `/` in `CompileFile.php` [#1693](https://github.com/getgrav/grav/pull/1693)\n    * Uri::Encode user and password to prevent issues in browsers\n    * Fixed \"Invalid AJAX response\" When using Built-in PHP Webserver in Windows [#1258](https://github.com/getgrav/grav-plugin-admin/issues/1258)\n    * Remove support for `config.user`, it was broken and bad practise\n    * Make sure that `clean cache` uses valid path [#1745](https://github.com/getgrav/grav/pull/1745)\n    * Fixed token creation issue with `Uri` params like `/id:3`\n    * Fixed CSS Pipeline failing with Google remote fonts if the file was minified [#1261](https://github.com/getgrav/grav-plugin-admin/issues/1261)\n    * Forced `field.multiple: true` to allow use of min/max options in `checkboxes.validate`\n\n# v1.3.8\n## 10/26/2017\n\n1. [](#new)\n    * Added Page `media_order` capability to manually order page media via a page header\n1. [](#bugfix)\n    * Fixed GPM update issue with filtered slugs [#1711](https://github.com/getgrav/grav/issues/1711)\n    * Fixed issue with missing image file not throwing 404 properly [#1713](https://github.com/getgrav/grav/issues/1713)\n\n# v1.3.7\n## 10/18/2017\n\n1. [](#bugfix)\n    * Regression Uri: `base_url_absolute` always has the port number [#1690](https://github.com/getgrav/grav-plugin-admin/issues/1690)\n    * Uri: Prefer using REQUEST_SCHEME instead of HTTPS [#1698](https://github.com/getgrav/grav-plugin-admin/issues/1698)\n    * Fixed routing paths with urlencoded spaces and non-latin letters [#1688](https://github.com/getgrav/grav-plugin-admin/issues/1688)\n\n# v1.3.6\n## 10/12/2017\n\n1. [](#bugfix)\n    * Regression: Ajax error in Nginx [admin#1244](https://github.com/getgrav/grav-plugin-admin/issues/1244)\n    * Remove the `_url=$uri` portion of the the Nginx `try_files` command [admin#1244](https://github.com/getgrav/grav-plugin-admin/issues/1244)\n\n# v1.3.5\n## 10/11/2017\n\n1. [](#improved)\n    * Refactored `URI` class with numerous bug fixes, and optimizations\n    * Override `system.media.upload_limit` with PHP's `post_max_size` or `upload_max_filesize`\n    * Updated `bin/grav clean` command to remove unnecessary vendor files (save some bytes)\n    * Added a `http_status_code` Twig function to allow setting HTTP status codes from Twig directly.\n    * Deter XSS attacks via URI path/uri methods (credit:newbthenewbd)\n    * Added support for `$uri->toArray()` and `(string)$uri`\n    * Added support for `type` on `Asstes::addInlineJs()` [#1683](https://github.com/getgrav/grav/pull/1683)\n1. [](#bugfix)\n    * Fixed method signature error with `GPM\\InstallCommand::processPackage()` [#1682](https://github.com/getgrav/grav/pull/1682)\n\n# v1.3.4\n## 09/29/2017\n\n1. [](#new)\n    * Added filter support for Page collections (routable/visible/type/access/etc.)\n1. [](#improved)\n    * Implemented `Composer\\CaBundle` for SSL Certs [#1241](https://github.com/getgrav/grav/issues/1241)\n    * Refactored the Assets sorting logic\n    * Improved language overrides to merge only 'extra' translations [#1514](https://github.com/getgrav/grav/issues/1514)\n    * Improved support for Assets with query strings [#1451](https://github.com/getgrav/grav/issues/1451)\n    * Twig extension cleanup\n1. [](#bugfix)\n    * Fixed an issue where fallback was not supporting dynamic page generation\n    * Fixed issue with Image query string not being fully URL encoded [#1622](https://github.com/getgrav/grav/issues/1622)\n    * Fixed `Page::summary()` when using delimiter and multibyte UTF8 Characters [#1644](https://github.com/getgrav/grav/issues/1644)\n    * Fixed missing `.json` thumbnail throwing error when adding media [grav-plugin-admin#1156](https://github.com/getgrav/grav-plugin-admin/issues/1156)\n    * Fixed insecure session cookie initialization [#1656](https://github.com/getgrav/grav/pull/1656)\n\n# v1.3.3\n## 09/07/2017\n\n1. [](#new)\n    * Added support for 2-Factor Authentication in admin profile\n    * Added `gaussianBlur` media method [#1623](https://github.com/getgrav/grav/pull/1623)\n    * Added new `|chunk_split()`, `|basename`, and `|dirname` Twig filter\n    * Added new `tl` Twig filter/function to support specific translations [#1618](https://github.com/getgrav/grav/issues/1618)\n1. [](#improved)\n    * User `authorization` now requires a check for `authenticated` - REQUIRED: `Login v2.4.0`\n    * Added options to `Page::summary()` to support size without HTML tags [#1554](https://github.com/getgrav/grav/issues/1554)\n    * Forced `natsort` on plugins to ensure consistent plugin load ordering across platforms [#1614](https://github.com/getgrav/grav/issues/1614)\n    * Use new `multilevel` field to handle Asset Collections [#1201](https://github.com/getgrav/grav-plugin-admin/issues/1201)\n    * Added support for redis `password` option [#1620](https://github.com/getgrav/grav/issues/1620)\n    * Use 302 rather than 301 redirects by default [#1619](https://github.com/getgrav/grav/issues/1619)\n    * GPM Installer will try to load alphanumeric version of the class if no standard class found [#1630](https://github.com/getgrav/grav/issues/1630)\n    * Add current page position to `User` class [#1632](https://github.com/getgrav/grav/issues/1632)\n    * Added option to enable case insensitive URLs [#1638](https://github.com/getgrav/grav/issues/1638)\n    * Updated vendor libraries\n    * Updated `travis.yml` to add support for PHP 7.1 as well as 7.0.21 for test suite\n1. [](#bugfix)\n    * Fixed UTF8 multibyte UTF8 character support in `Page::summary()` [#1554](https://github.com/getgrav/grav/issues/1554)\n\n# v1.3.2\n## 08/16/2017\n\n1. [](#new)\n    * Added a new `cache_control` system and page level property [#1591](https://github.com/getgrav/grav/issues/1591)\n    * Added a new `clear_images_by_default` system property to stop cache clear events from removing processed images [#1481](https://github.com/getgrav/grav/pull/1481)\n    * Added new `onTwigLoader()` event to enable utilization of loader methods\n    * Added new `Twig::addPath()` and `Twig::prependPath()` methods to wrap loader methods and support namespacing [#1604](https://github.com/getgrav/grav/issues/1604)\n    * Added new `array_key_exists()` Twig function wrapper\n    * Added a new `Collection::intersect()` method [#1605](https://github.com/getgrav/grav/issues/1605)\n1. [](#bugfix)\n    * Allow `session.timeout` field to be set to `0` via blueprints [#1598](https://github.com/getgrav/grav/issues/1598)\n    * Fixed `Data::exists()` and `Data::raw()` functions breaking if `Data::file()` hasn't been called with non-null value\n    * Fixed parent theme auto-loading in child themes of Gantry 5\n\n# v1.3.1\n## 07/19/2017\n\n1. [](#bugfix)\n    * Fix ordering for Linux + International environments [#1574](https://github.com/getgrav/grav/issues/1574)\n    * Check if medium thumbnail exists before resetting\n    * Update Travis' auth token\n\n# v1.3.0\n## 07/16/2017\n\n1. [](#bugfix)\n    * Fixed an undefined variable `$difference` [#1563](https://github.com/getgrav/grav/pull/1563)\n    * Fix broken range slider [grav-plugin-admin#1153](https://github.com/getgrav/grav-plugin-admin/issues/1153)\n    * Fix natural sort when > 100 pages [#1564](https://github.com/getgrav/grav/pull/1564)\n\n# v1.3.0-rc.5\n## 07/05/2017\n\n1. [](#new)\n    * Setting `system.session.timeout` to 0 clears the session when the browser session ends [#1538](https://github.com/getgrav/grav/pull/1538)\n    * Created a `CODE_OF_CONDUCT.md` so everyone knows how to behave :)\n1. [](#improved)\n    * Renamed new `media()` Twig function to `media_directory()` to avoid conflict with Page's `media` object\n1. [](#bugfix)\n    * Fixed global media files disappearing after a reload [#1545](https://github.com/getgrav/grav/issues/1545)\n    * Fix for broken regex redirects/routes via `site.yaml`\n    * Sanitize the error message in the error handler page\n\n# v1.3.0-rc.4\n## 06/22/2017\n\n1. [](#new)\n    * Added `lower` and `upper` Twig filters\n    * Added `pathinfo()` Twig function\n    * Added 165 new thumbnail images for use in `media.yaml`\n1. [](#improved)\n    * Improved error message when running `bin/grav install` instead of `bin/gpm install`, and also when running on a non-skeleton site [#1027](https://github.com/getgrav/grav/issues/1027)\n    * Updated vendor libraries\n1. [](#bugfix)\n    * Don't rebuild metadata every time, only when file does not exist\n    * Restore GravTrait in ConsoleTrait [grav-plugin-login#119](https://github.com/getgrav/grav-plugin-login/issues/119)\n    * Fix Windows routing with built-in server [#1502](https://github.com/getgrav/grav/issues/1502)\n    * Fix [#1504](https://github.com/getgrav/grav/issues/1504) `process_twig` and `frontmatter.yaml`\n    * Nicetime fix: 0 seconds from now -> just now [#1509](https://github.com/getgrav/grav/issues/1509)\n\n# v1.3.0-rc.3\n## 05/22/2017\n\n1. [](#new)\n    * Added new unified `Utils::getPagePathFromToken()` method which is used by various plugins (Admin, Forms, Downloads, etc.)\n1. [](#improved)\n    * Optionally remove unpublished pages from the translated languages, move into untranslated list [#1482](https://github.com/getgrav/grav/pull/1482)\n    * Improved reliability of `hash` file-check method\n1. [](#bugfix)\n    * Updated to latest Toolbox library to fix issue with some blueprints rendering in admin plugin [#1117](https://github.com/getgrav/grav-plugin-admin/issues/1117)\n    * Fix output handling in RenderProcessor [#1483](https://github.com/getgrav/grav/pull/1483)\n\n# v1.3.0-rc.2\n## 05/17/2017\n\n1. [](#new)\n    * Added new `media` and `vardump` Twig functions\n1. [](#improved)\n    * Put in various checks to ensure Exif is available before trying to use it\n    * Add timestamp to configuration settings [#1445](https://github.com/getgrav/grav/pull/1445)\n1. [](#bugfix)\n    * Fix an issue saving YAML textarea fields in expert mode [#1480](https://github.com/getgrav/grav/pull/1480)\n    * Moved `onOutputRendered()` back into Grav core\n\n# v1.3.0-rc.1\n## 05/16/2017\n\n1. [](#new)\n    * Added support for a single array field in the forms\n    * Added EXIF support with automatic generation of Page Media metafiles\n    * Added Twig function to get EXIF data on any image file\n    * Added `Pages::baseUrl()`, `Pages::homeUrl()` and `Pages::url()` functions\n    * Added `base32_encode`, `base32_decode`, `base64_encode`, `base64_decode` Twig filters\n    * Added `Debugger::getCaller()` to figure out where the method was called from\n    * Added support for custom output providers like Slim Framework\n    * Added `Grav\\Framework\\Collection` classes for creating collections\n1. [](#improved)\n    * Add more controls over HTML5 video attributes (autoplay, poster, loop controls) [#1442](https://github.com/getgrav/grav/pull/1442)\n    * Removed logging statement for invalid slug [#1459](https://github.com/getgrav/grav/issues/1459)\n    * Groups selection pre-filled in user form\n    * Improve error handling in `Folder::move()`\n    * Added extra parameter for `Twig::processSite()` to include custom context\n    * Updated RocketTheme Toolbox vendor library\n1. [](#bugfix)\n    * Fix to force route/redirect matching from the start of the route by default [#1446](https://github.com/getgrav/grav/issues/1446)\n    * Edit check for valid slug [#1459](https://github.com/getgrav/grav/issues/1459)\n\n# v1.2.4\n## 04/24/2017\n\n1. [](#improved)\n    * Added optional ignores for `Installer::sophisticatedInstall()` [#1447](https://github.com/getgrav/grav/issues/1447)\n1. [](#bugfix)\n    * Allow multiple calls to `Themes::initTheme()` without throwing errors\n    * Fixed querystrings in root pages with multi-lang enabled [#1436](https://github.com/getgrav/grav/issues/1436)\n    * Allow support for `Pages::getList()` with `show_modular` option [#1080](https://github.com/getgrav/grav-plugin-admin/issues/1080)\n\n# v1.2.3\n## 04/19/2017\n\n1. [](#improved)\n    * Added new `pwd_regex` and `username_regex` system configuration options to allow format modifications\n    * Allow `user/accounts.yaml` overrides and implemented more robust theme initialization\n    * improved `getList()` method to do more powerful things\n    * Fix Typo in GPM [#1427](https://github.com/getgrav/grav/issues/1427)\n\n# v1.2.2\n## 04/11/2017\n\n1. [](#bugfix)\n    * Fix for redirects breaking [#1420](https://github.com/getgrav/grav/issues/1420)\n    * Fix issue in direct-install with github-style dependencies [#1405](https://github.com/getgrav/grav/issues/1405)\n\n# v1.2.1\n## 04/10/2017\n\n1. [](#improved)\n    * Added various `ancestor` helper methods in Page and Pages classes [#1362](https://github.com/getgrav/grav/pull/1362)\n    * Added new `parents` field and switched Page blueprints to use this\n    * Added `isajaxrequest()` Twig function [#1400](https://github.com/getgrav/grav/issues/1400)\n    * Added ability to inline CSS and JS code via Asset manager [#1377](https://github.com/getgrav/grav/pull/1377)\n    * Add query string in lighttpd default config [#1393](https://github.com/getgrav/grav/issues/1393)\n    * Add `--all-yes` and `--destination` options for `bin/gpm direct-install` [#1397](https://github.com/getgrav/grav/pull/1397)\n1. [](#bugfix)\n    * Fix for direct-install of plugins with `languages.yaml` [#1396](https://github.com/getgrav/grav/issues/1396)\n    * When determining language from HTTP_ACCEPT_LANGUAGE, also try base language only [#1402](https://github.com/getgrav/grav/issues/1402)\n    * Fixed a bad method signature causing warning when running tests on `GPMTest` object\n\n# v1.2.0\n## 03/31/2017\n\n1. [](#new)\n    * Added file upload for user avatar in user/admin blueprint\n1. [](#improved)\n    * Analysis fixes\n    * Switched to stable composer lib versions\n\n# v1.2.0-rc.3\n## 03/22/2017\n\n1. [](#new)\n    * Refactored Page re-ordering to handle all siblings at once\n    * Added `language_codes` to Twig init to allow for easy language name/code/native-name lookup\n1. [](#improved)\n    * Added an _Admin Overrides_ section with option to choose the order of children in Pages Management\n1. [](#bugfix)\n    * Fixed loading issues with improperly named themes (use old broken method first) [#1373](https://github.com/getgrav/grav/issues/1373)\n    * Simplified modular/twig processing logic and fixed an issue with system process config [#1351](https://github.com/getgrav/grav/issues/1351)\n    * Cleanup package files via GPM install to make them more windows-friendly [#1361](https://github.com/getgrav/grav/pull/1361)\n    * Fix for page-level debugger override changing the option site-wide\n    * Allow `url()` twig function to pass-through external links\n\n# v1.2.0-rc.2\n## 03/17/2017\n\n1. [](#improved)\n    * Updated vendor libraries to latest\n    * Added the ability to disable debugger on a per-page basis with `debugger: false` in page frontmatter\n1. [](#bugfix)\n    * Fixed an issue with theme inheritance and hyphenated base themes [#1353](https://github.com/getgrav/grav/issues/1353)\n    * Fixed an issue when trying to use an `@2x` derivative on a non-image media file [#1341](https://github.com/getgrav/grav/issues/1341)\n\n# v1.2.0-rc.1\n## 03/13/2017\n\n1. [](#new)\n    * Added default setting to only allow `direct-installs` from official GPM.  Can be configured in `system.yaml`\n    * Added a new `Utils::isValidUrl()` method\n    * Added optional parameter to `|markdown(false)` filter to toggle block/line processing (default|true = `block`)\n    * Added new `Page::folderExists()` method\n1. [](#improved)\n    * `Twig::evaluate()` now takes current environment and context into account\n    * Genericized `direct-install` so it can be called via Admin plugin\n1. [](#bugfix)\n    * Fixed a minor bug in Number validation [#1329](https://github.com/getgrav/grav/issues/1329)\n    * Fixed exception when trying to find user account and there is no `user://accounts` folder\n    * Fixed issue when setting `Page::expires(0)` [Admin #1009](https://github.com/getgrav/grav-plugin-admin/issues/1009)\n    * Removed ID from `nonce_field()` Twig function causing validation errors [Form #115](https://github.com/getgrav/grav-plugin-form/issues/115)\n\n# v1.1.17\n## 02/17/2017\n\n1. [](#bugfix)\n    * Fix for double extensions getting added during some redirects [#1307](https://github.com/getgrav/grav/issues/1307)\n    * Fix syntax error in PHP 5.3. Move the version check before requiring the autoloaded deps\n    * Fix Whoops displaying error page if there is PHP core warning or error [Admin #980](https://github.com/getgrav/grav-plugin-admin/issues/980)\n\n# v1.1.16\n## 02/10/2017\n\n1. [](#new)\n    * Exposed the Pages cache ID for use by plugins (e.g. Form) via `Pages::getPagesCacheId()`\n    * Added `Languages::resetFallbackPageExtensions()` regarding [#1276](https://github.com/getgrav/grav/pull/1276)\n1. [](#improved)\n    * Allowed CLI to use non-volatile cache drivers for better integration with CLI and Web caches\n    * Added Gantry5-compatible query information to Caddy configuration\n    * Added some missing docblocks and type-hints\n    * Various code cleanups (return types, missing variables in doclbocks, etc.)\n1. [](#bugfix)\n    * Fix blueprints slug validation [https://github.com/getgrav/grav-plugin-admin/issues/955](https://github.com/getgrav/grav-plugin-admin/issues/955)\n\n# v1.1.15\n## 01/30/2017\n\n1. [](#new)\n    * Added a new `Collection::merge()` method to allow merging of multiple collections [#1258](https://github.com/getgrav/grav/pull/1258)\n    * Added [OpenCollective](https://opencollective.com/grav) backer/sponsor info to `README.md`\n1. [](#improved)\n    * Add an additional parameter to GPM::findPackage to avoid throwing an exception, for use in Twig [#1008](https://github.com/getgrav/grav/issues/1008)\n    * Skip symlinks if found while clearing cache [#1269](https://github.com/getgrav/grav/issues/1269)\n1. [](#bugfix)\n    * Fixed an issue when page collection with header-based `sort.by` returns an array [#1264](https://github.com/getgrav/grav/issues/1264)\n    * Fix `Response` object to handle `303` redirects when `open_basedir` in effect [#1267](https://github.com/getgrav/grav/issues/1267)\n    * Silence `E_WARNING: Zend OPcache API is restricted by \"restrict_api\" configuration directive`\n\n# v1.1.14\n## 01/18/2017\n\n1. [](#bugfix)\n    * Fixed `Page::collection()` returning array and not Collection object when header variable did not exist\n    * Revert `Content-Encoding: identity` fix, and let you set `cache: allow_webserver_gzip:` option to switch to `identity` [#548](https://github.com/getgrav/grav/issues/548)\n\n# v1.1.13\n## 01/17/2017\n\n1. [](#new)\n    * Added new `never_cache_twig` page option in `system.yaml` and frontmatter. Allows dynamic Twig logic in regular and modular Twig templates [#1244](https://github.com/getgrav/grav/pull/1244)\n1. [](#improved)\n    * Several improvements to aid theme development [#232](https://github.com/getgrav/grav/pull/1232)\n    * Added `hash` cache check option and made dropdown more descriptive [Admin #923](https://github.com/getgrav/grav-plugin-admin/issues/923)\n1. [](#bugfix)\n    * Fixed cross volume file system operations [#635](https://github.com/getgrav/grav/issues/635)\n    * Fix issue with pages folders validation not accepting uppercase letters\n    * Fix renaming the folder name if the page, in the default language, had a custom slug set in its header\n    * Fixed issue with `Content-Encoding: none`. It should really be `Content-Encoding: identity` instead\n    * Fixed broken `hash` method on page modifications detection\n    * Fixed issue with multi-lang pages not caching independently without unique `.md` file [#1211](https://github.com/getgrav/grav/issues/1211)\n    * Fixed all `$_GET` parameters missing in Nginx (please update your nginx.conf) [#1245](https://github.com/getgrav/grav/issues/1245)\n    * Fixed issue in trying to process broken symlink [#1254](https://github.com/getgrav/grav/issues/1254)\n\n# v1.1.12\n## 12/26/2016\n\n1. [](#bugfix)\n    * Fixed issue with JSON calls throwing errors due to debugger enabled [#1227](https://github.com/getgrav/grav/issues/1227)\n\n# v1.1.11\n## 12/22/2016\n\n1. [](#improved)\n    * Fall back properly to HTML if template type not found\n1. [](#bugfix)\n    * Fix issue with modular pages folders validation [#900](https://github.com/getgrav/grav-plugin-admin/issues/900)\n\n# v1.1.10\n## 12/21/2016\n\n1. [](#improved)\n    * Improve detection of home path. Also allow `~/.grav` on Windows, drop `ConsoleTrait::isWindows()` method, used only for that [#1204](https://github.com/getgrav/grav/pull/1204)\n    * Reworked PHP CLI router [#1219](https://github.com/getgrav/grav/pull/1219)\n    * More robust theme/plugin logic in `bin/gpm direct-install`\n1. [](#bugfix)\n    * Fixed case where extracting a package would cause an error during rename\n    * Fix issue with using `Yaml::parse` direcly on a filename, now deprecated\n    * Add pattern for frontend validation of folder slugs [#891](https://github.com/getgrav/grav-plugin-admin/issues/891)\n    * Fix issue with Inflector when translation is disabled [SimpleSearch #87](https://github.com/getgrav/grav-plugin-simplesearch/issues/87)\n    * Explicitly expose `array_unique` Twig filter [Admin #897](https://github.com/getgrav/grav-plugin-admin/issues/897)\n\n# v1.1.9\n## 12/13/2016\n\n1. [](#new)\n    * RC released as stable\n1. [](#improved)\n    * Better error handling in cache clear\n    * YAML syntax fixes for the future compatibility\n    * Added new parameter `remove` for `onBeforeCacheClear` event\n    * Add support for calling Media object as function to get medium by filename\n1. [](#bugfix)\n    * Added checks before accessing admin reference during `Page::blueprints()` call. Allows to access `page.blueprints` from Twig in the frontend\n\n# v1.1.9-rc.3\n## 12/07/2016\n\n1. [](#new)\n    * Add `ignore_empty` property to be used on array fields, if positive only save options with a value\n    * Use new `permissions` field in user account\n    * Add `range(int start, int end, int step)` twig function to generate an array of numbers between start and end, inclusive\n    * New retina Media image derivatives array support (`![](image.jpg?derivatives=[640,1024,1440])`) [#1147](https://github.com/getgrav/grav/pull/1147)\n    * Added stream support for images (`![Sepia Image](image://image.jpg?sepia)`)\n    * Added stream support for links (`[Download PDF](user://data/pdf/my.pdf)`)\n    * Added new `onBeforeCacheClear` event to add custom paths to cache clearing process\n1. [](#improved)\n    * Added alias `selfupdate` to the `self-upgrade` `bin/gpm` CLI command\n    * Synced `webserver-configs/htaccess.txt` with `.htaccess`\n    * Use permissions field in group details.\n    * Updated vendor libraries\n    * Added a warning on GPM update to update Grav first if needed [#1194](https://github.com/getgrav/grav/pull/1194)\n 1. [](#bugfix)\n    * Fix page collections problem with `@page.modular` [#1178](https://github.com/getgrav/grav/pull/1178)\n    * Fix issue with using a multiple taxonomy filter of which one had no results, thanks to @hughbris [#1184](https://github.com/getgrav/grav/issues/1184)\n    * Fix saving permissions in group\n    * Fixed issue with redirect of a page getting moved to a different location\n\n# v1.1.9-rc.2\n## 11/26/2016\n\n1. [](#new)\n    * Added two new sort order options for pages: `publish_date` and `unpublish_date` [#1173](https://github.com/getgrav/grav/pull/1173))\n1. [](#improved)\n    * Multisite: Create image cache folder if it doesn't exist\n    * Add 2 new language values for French [#1174](https://github.com/getgrav/grav/issues/1174)\n1. [](#bugfix)\n    * Fixed issue when we have a meta file without corresponding media [#1179](https://github.com/getgrav/grav/issues/1179)\n    * Update class namespace for Admin class [Admin #874](https://github.com/getgrav/grav-plugin-admin/issues/874)\n\n# v1.1.9-rc.1\n## 11/09/2016\n\n1. [](#new)\n    * Added a `CompiledJsonFile` object to better handle Json files.\n    * Added Base32 encode/decode class\n    * Added a new `User::find()` method\n1. [](#improved)\n    * Moved `messages` object into core Grav from login plugin\n    * Added `getTaxonomyItemKeys` to the Taxonomy object [#1124](https://github.com/getgrav/grav/issues/1124)\n    * Added a `redirect_me` Twig function [#1124](https://github.com/getgrav/grav/issues/1124)\n    * Added a Caddyfile for newer Caddy versions [#1115](https://github.com/getgrav/grav/issues/1115)\n    * Allow to override sorting flags for page header-based or default ordering. If the `intl` PHP extension is loaded, only these flags are available: https://secure.php.net/manual/en/collator.asort.php. Otherwise, you can use the PHP standard sorting flags (https://secure.php.net/manual/en/array.constants.php) [#1169](https://github.com/getgrav/grav/issues/1169)\n1. [](#bugfix)\n    * Fixed an issue with site redirects/routes, not processing with extension (.html, .json, etc.)\n    * Don't truncate HTML if content length is less than summary size [#1125](https://github.com/getgrav/grav/issues/1125)\n    * Return max available number when calling random() on a collection passing an int > available items [#1135](https://github.com/getgrav/grav/issues/1135)\n    * Use correct ratio when applying image filters to image alternatives [#1147](https://github.com/getgrav/grav/issues/1147)\n    * Fixed URI path in multi-site when query parameters were used in front page\n\n# v1.1.8\n## 10/22/2016\n\n1. [](#bugfix)\n    * Fixed warning with unset `ssl` option when using GPM [#1132](https://github.com/getgrav/grav/issues/1132)\n\n# v1.1.7\n## 10/22/2016\n\n1. [](#improved)\n    * Improved the capabilities of Image derivatives [#1107](https://github.com/getgrav/grav/pull/1107)\n1. [](#bugfix)\n    * Only pass verify_peer settings to cURL and fopen if the setting is disabled [#1120](https://github.com/getgrav/grav/issues/1120)\n\n# v1.1.6\n## 10/19/2016\n\n1. [](#new)\n    * Added ability for Page to override the output format (`html`, `xml`, etc..) [#1067](https://github.com/getgrav/grav/issues/1067)\n    * Added `Utils::getExtensionByMime()` and cleaned up `Utils::getMimeByExtension` + tests\n    * Added a `cache.check.method: 'hash'` option in `system.yaml` that checks all files + dates inclusively\n    * Include jQuery 3.x in the Grav assets\n    * Added the option to automatically fix orientation on images based on their Exif data, by enabling `system.images.auto_fix_orientation`.\n1. [](#improved)\n    * Add `batch()` function to Page Collection class\n    * Added new `cache.redis.socket` setting that allow to pass a UNIX socket as redis server\n    * It is now possible to opt-out of the SSL verification via the new `system.gpm.verify_peer` setting. This is sometimes necessary when receiving a \"GPM Unable to Connect\" error. More details in ([#1053](https://github.com/getgrav/grav/issues/1053))\n    * It is now possible to force the use of either `curl` or `fopen` as `Response` connection method, via the new `system.gpm.method` setting. By default this is set to 'auto' and gives priority to 'fopen' first, curl otherwise.\n    * InstallCommand can now handle Licenses\n    * Uses more helpful `1x`, `2x`, `3x`, etc names in the Retina derivatives cache files.\n    * Added new method `Plugins::isPluginActiveAdmin()` to check if plugin route is active in Admin plugin\n    * Added new `Cache::setEnabled` and `Cache::getEnabled` to enable outside control of cache\n    * Updated vendor libs including Twig `1.25.0`\n    * Avoid git ignoring any vendor folder in a Grav site subfolder (but still ignore the main `vendor/` folder)\n    * Added an option to get just a route back from `Uri::convertUrl()` function\n    * Added option to control split session [#1096](https://github.com/getgrav/grav/pull/1096)\n    * Added new `verbosity` levels to `system.error.display` to allow for system error messages [#1091](https://github.com/getgrav/grav/pull/1091)\n    * Improved the API for Grav plugins to access the Parsedown parser directly [#1062](https://github.com/getgrav/grav/pull/1062)\n1. [](#bugfix)\n    * Fixed missing `progress` method in the DirectInstall Command\n    * `Response` class now handles better unsuccessful requests such as 404 and 401\n    * Fixed saving of `external` page types [Admin #789](https://github.com/getgrav/grav-plugin-admin/issues/789)\n    * Fixed issue deleting parent folder of folder with `param_sep` in the folder name [admin #796](https://github.com/getgrav/grav-plugin-admin/issues/796)\n    * Fixed an issue with streams in `bin/plugin`\n    * Fixed `jpeg` file format support in Media\n\n# v1.1.5\n## 09/09/2016\n\n1. [](#new)\n    * Added new `bin/gpm direct-install` command to install local and remote zip archives\n1. [](#improved)\n    * Refactored `onPageNotFound` event to fire after `onPageInitialized`\n    * Follow symlinks in `Folder::all()`\n    * Twig variable `base_url` now supports multi-site by path feature\n    * Improved `bin/plugin` to list plugins with commands faster by limiting the depth of recursion\n1. [](#bugfix)\n    * Quietly skip missing streams in `Cache::clearCache()`\n    * Fix issue in calling page.summary when no content is present in a page\n    * Fix for HUGE session timeouts [#1050](https://github.com/getgrav/grav/issues/1050)\n\n# v1.1.4\n## 09/07/2016\n\n1. [](#new)\n    * Added new `tmp` folder at root. Accessible via stream `tmp://`. Can be cleared with `bin/grav clear --tmp-only` as well as `--all`.\n    * Added support for RTL in `LanguageCodes` so you can determine if a language is RTL or not\n    * Ability to set `custom_base_url` in system configuration\n    * Added `override` and `force` options for Streams setup\n1. [](#improved)\n    * Important vendor updates to provide PHP 7.1 beta support!\n    * Added a `Util::arrayFlatten()` static function\n    * Added support for 'external_url' page header to enable easier external URL based menu items\n    * Improved the UI for CLI GPM Index view to use a table\n    * Added `@page.modular` Collection type [#988](https://github.com/getgrav/grav/issues/988)\n    * Added support for `self@`, `page@`, `taxonomy@`, `root@` Collection syntax for cleaner YAML compatibility\n    * Improved GPM commands to allow for `-y` to automate **yes** responses and `-o` for **update** and **selfupgrade** to overwrite installations [#985](https://github.com/getgrav/grav/issues/985)\n    * Added randomization to `safe_email` Twig filter for greater security [#998](https://github.com/getgrav/grav/issues/998)\n    * Allow `Utils::setDotNotation` to merge data, rather than just set\n    * Moved default `Image::filter()` to the `save` action to ensure they are applied last [#984](https://github.com/getgrav/grav/issues/984)\n    * Improved the `Truncator` code to be more reliable [#1019](https://github.com/getgrav/grav/issues/1019)\n    * Moved media blueprints out of core (now in Admin plugin)\n1. [](#bugfix)\n    * Removed 307 redirect code option as it is not well supported [#743](https://github.com/getgrav/grav-plugin-admin/issues/743)\n    * Fixed issue with folders with name `*.md` are not confused with pages [#995](https://github.com/getgrav/grav/issues/995)\n    * Fixed an issue when filtering collections causing null key\n    * Fix for invalid HTML when rendering GIF and Vector media [#1001](https://github.com/getgrav/grav/issues/1001)\n    * Use pages.markdown.extra in the user's system.yaml [#1007](https://github.com/getgrav/grav/issues/1007)\n    * Fix for `Memcached` connection [#1020](https://github.com/getgrav/grav/issues/1020)\n\n# v1.1.3\n## 08/14/2016\n\n1. [](#bugfix)\n    * Fix for lightbox media function throwing error [#981](https://github.com/getgrav/grav/issues/981)\n\n# v1.1.2\n## 08/10/2016\n\n1. [](#new)\n    * Allow forcing SSL by setting `system.force_ssl` (Force SSL in the Admin System Config) [#899](https://github.com/getgrav/grav/pull/899)\n1. [](#improved)\n    * Improved `authorize` Twig extension to accept a nested array of authorizations  [#948](https://github.com/getgrav/grav/issues/948)\n    * Don't add timestamps on remote assets as it can cause conflicts\n    * Grav now looks at types from `media.yaml` when retrieving page mime types [#966](https://github.com/getgrav/grav/issues/966)\n    * Added support for dumping exceptions in the Debugger\n1. [](#bugfix)\n    * Fixed `Folder::delete` method to recursively remove files and folders and causing Upgrade to fail.\n    * Fix [#952](https://github.com/getgrav/grav/issues/952) hyphenize the session name.\n    * If no parent is set and siblings collection is called, return a new and empty collection [grav-plugin-sitemap/issues/22](https://github.com/getgrav/grav-plugin-sitemap/issues/22)\n    * Prevent exception being thrown when calling the Collator constructor failed in a Windows environment with the Intl PHP Extension enabled [#961](https://github.com/getgrav/grav/issues/961)\n    * Fix for markdown images not properly rendering `id` attribute [#956](https://github.com/getgrav/grav/issues/956)\n\n# v1.1.1\n## 07/16/2016\n\n1. [](#improved)\n    * Made `paramsRegex()` static to allow it to be called statically\n1. [](#bugfix)\n    * Fixed backup when using very long site titles with invalid characters [grav-plugin-admin#701](https://github.com/getgrav/grav-plugin-admin/issues/701)\n    * Fixed a typo in the `webserver-configs/nginx.conf` example\n\n# v1.1.0\n## 07/14/2016\n\n1. [](#improved)\n    * Added support for validation of multiple email in the `type: email` field [grav-plugin-email#31](https://github.com/getgrav/grav-plugin-email/issues/31)\n    * Unified PHP code header styling\n    * Added 6 more languages and updated language codes\n    * set default \"releases\" option to `stable`\n1. [](#bugfix)\n    * Fix backend validation for file fields marked as required [grav-plugin-form#78](https://github.com/getgrav/grav-plugin-form/issues/78)\n\n# v1.1.0-rc.3\n## 06/21/2016\n\n1. [](#new)\n    * Add a onPageFallBackUrl event when starting the fallbackUrl() method to allow the Login plugin to protect the page media\n    * Conveniently allow ability to retrieve user information via config object [#913](https://github.com/getgrav/grav/pull/913) - @Vivalldi\n    * Grav served images can now use header caching [#905](https://github.com/getgrav/grav/pull/905)\n1. [](#improved)\n    * Take asset modification timestamp into consideration in pipelining [#917](https://github.com/getgrav/grav/pull/917) - @Sommerregen\n1. [](#bugfix)\n    * Respect `enable_asset_timestamp` settings for pipelined Assets [#906](https://github.com/getgrav/grav/issues/906)\n    * Fixed collections end dates for 32-bit systems [#902](https://github.com/getgrav/grav/issues/902)\n    * Fixed a recent regression (1.1.0-rc1) with parameter separator different than `:`\n\n# v1.1.0-rc.2\n## 06/14/2016\n\n1. [](#new)\n    * Added getters and setters for Assets to allow manipulation of CSS/JS/Collection based assets via plugins [#876](https://github.com/getgrav/grav/issues/876)\n1. [](#improved)\n    * Pass the exception to the `onFatalException()` event\n    * Updated to latest jQuery 2.2.4 release\n    * Moved list items in `system/config/media.yaml` config into a `types:` key which allows you delete default items.\n    * Updated `webserver-configs/nginx.conf` with `try_files` fix from @mrhein and @rondlite [#743](https://github.com/getgrav/grav/pull/743)\n    * Updated cache references to include `memecache` and `redis` [#887](https://github.com/getgrav/grav/issues/887)\n    * Updated composer libraries\n1. [](#bugfix)\n    * Fixed `Utils::normalizePath()` that was truncating 0's [#882](https://github.com/getgrav/grav/issues/882)\n\n# v1.1.0-rc.1\n## 06/01/2016\n\n1. [](#new)\n    * Added `Utils::getDotNotation()` and `Utils::setDotNotation()` methods + tests\n    * Added support for `xx-XX` locale language lookups in `LanguageCodes` class [#854](https://github.com/getgrav/grav/issues/854)\n    * New CSS/JS Minify library that does a more reliable job [#864](https://github.com/getgrav/grav/issues/864)\n1. [](#improved)\n    * GPM installation of plugins and themes into correct multisite folders [#841](https://github.com/getgrav/grav/issues/841)\n    * Use `Page::rawRoute()` in blueprints for more reliable mulit-language support\n1. [](#bugfix)\n    * Fixes for `zlib.output_compression` as well as `mod_deflate` GZIP compression\n    * Fix for corner-case redirect logic causing infinite loops and out-of-memory errors\n    * Fix for saving fields in expert mode that have no `Validation::typeX()` methods [#626](https://github.com/getgrav/grav-plugin-admin/issues/626)\n    * Detect if user really meant to extend parent blueprint, not another one (fixes old page type blueprints)\n    * Fixed a bug in `Page::relativePagePath()` when `Page::$name` is not defined\n    * Fix for poor handling of params + query element in `Uri::processParams()` [#859](https://github.com/getgrav/grav/issues/859)\n    * Fix for double encoding in markdown links [#860](https://github.com/getgrav/grav/issues/860)\n    * Correctly handle language strings to determine if it's in admin or not [#627](https://github.com/getgrav/grav-plugin-admin/issues/627)\n\n# v1.1.0-beta.5\n## 05/23/2016\n\n1. [](#improved)\n    * Updated jQuery from 2.2.0 to 2.2.3\n    * Set `Uri::ip()` to static by default so it can be used in form fields\n    * Improved `Session` class with flash storage\n    * `Page::getContentMeta()` now supports an optional key.\n1. [](#bugfix)\n    * Fixed \"Invalid slug set in YAML frontmatter\" when setting `Page::slug()` with empty string [#580](https://github.com/getgrav/grav-plugin-admin/issues/580)\n    * Only `.gitignore` Grav's vendor folder\n    * Fix trying to remove Grav with `GPM uninstall` of a plugin with Grav dependency\n    * Fix Page Type blueprints not being able to extend their parents\n    * `filterFile` validation method always returns an array of files, behaving like `multiple=\"multiple\"`\n    * Fixed [#835](https://github.com/getgrav/grav-plugin-admin/issues/835) check for empty image file first to prevent getimagesize() fatal error\n    * Avoid throwing an error when Grav's Gzip and mod_deflate are enabled at the same time on a non php-fpm setup\n\n# v1.1.0-beta.4\n## 05/09/2016\n\n1. [](#bugfix)\n    * Drop dependencies calculations if plugin is installed via symlink\n    * Drop Grav from dependencies calculations\n    * Send slug name as part of installed packages\n    * Fix for summary entities not being properly decoded [#825](https://github.com/getgrav/grav/issues/825)\n\n\n# v1.1.0-beta.3\n## 05/04/2016\n\n1. [](#improved)\n    * Pass the Page type when calling `onBlueprintCreated`\n    * Changed `Page::cachePageContent()` form **private** to **public** so a page can be recached via plugin\n1. [](#bugfix)\n    * Fixed handling of `{'loading':'async'}` with Assets Pipeline\n    * Fix for new modular page modal `Page` field requiring a value [#529](https://github.com/getgrav/grav-plugin-admin/issues/529)\n    * Fix for broken `bin/gpm version` command\n    * Fix handling \"grav\" as a dependency\n    * Fix when installing multiple packages and one is the dependency of another, don't try to install it twice\n    * Fix using name instead of the slug to determine a package folder. Broke for packages whose name was 2+ words\n\n# v1.1.0-beta.2\n## 04/27/2016\n\n1. [](#new)\n    * Added new `Plugin::getBlueprint()` and `Theme::getBlueprint()` method\n    * Allow **page blueprints** to be added via Plugins.\n1. [](#improved)\n    * Moved to new `data-*@` format in blueprints\n    * Updated composer-based libraries\n    * Moved some hard-coded `CACHE_DIR` references to use locator\n    * Set `twig.debug: true` by default\n1. [](#bugfix)\n    * Fixed issue with link rewrites and local assets pipeline with `absolute_urls: true`\n    * Allow Cyrillic slugs [#520](https://github.com/getgrav/grav-plugin-admin/issues/520)\n    * Fix ordering issue with accented letters [#784](https://github.com/getgrav/grav/issues/784)\n    * Fix issue with Assets pipeline and missing newlines causing invalid JavaScript\n\n# v1.1.0-beta.1\n## 04/20/2016\n\n1. [](#new)\n    * **Blueprint Improvements**: The main improvements to Grav take the form of a major rewrite of our blueprint functionality. Blueprints are an essential piece of functionality within Grav that helps define configuration fields. These allow us to create a definition of a form field that can be rendered in the administrator plugin and allow the input, validation, and storage of values into the various configuration and page files that power Grav. Grav 1.0 had extensive support for building and extending blueprints, but Grav 1.1 takes this even further and adds improvements to our existing system.\n    * **Extending Blueprints**: You could extend forms in Grav 1.0, but now you can use a newer `extends@:` default syntax rather than the previous `'@extends'` string that needed to be quoted in YAML. Also this new format allows for the defining of a `context` which lets you define where to look for the base blueprint. Another new feature is the ability to extend from multiple blueprints.\n    * **Embedding/Importing Blueprints**: One feature that has been requested is the ability to embed or import one blueprint into another blueprint. This allows you to share fields or sub-form between multiple forms. This is accomplished via the `import@` syntax.\n    * **Removing Existing Fields and Properties**: Another new feature is the ability to remove completely existing fields or properties from an extended blueprint. This allows the user a lot more flexibility when creating custom forms by simply using the new `unset@: true` syntax. To remove a field property you would use `unset-<property>@: true` in your extended field definition, for example: `unset-options@: true`.\n    * **Replacing Existing Fields and Properties**: Similar to removing, you can now replace an existing field or property with the `replace@: true` syntax for the whole field, and `replace-<property>@: true` for a specific property.\n    * **Field Ordering**: Probably the most frequently requested blueprint functionality that we have added is the ability to change field ordering. Imagine that you want to extend the default page blueprint but add a new tab. Previously, this meant your tab would be added at the end of the form, but now you can define that you wish the new tab to be added right after the `content` tab. This works for any field too, so you can extend a blueprint and add your own custom fields anywhere you wish! This is accomplished by using the new `ordering@:` syntax with either an existing property name or an integer.\n    * **Configuration Properties**: Another useful new feature is the ability to directly access Grav configuration in blueprints with `config-<property>@` syntax. For example you can set a default for a field via `config-default@: site.author.name` which will use the author.name value from the `site.yaml` file as the `default` value for this field.\n    * **Function Calls**: The ability to call PHP functions for values has been improved in Grav 1.1 to be more powerful. You can use the `data-<property>@` syntax to call static methods to obtain values. For example: `data-default@: '\\Grav\\Plugin\\Admin::route'`. You can now even pass parameters to these methods.\n    * **Validation Rules**: You can now define a custom blueprint-level validation rule and assign this rule to a form field.\n    * **Custom Form Field Types**: This advanced new functionality allows you to create a custom field type via a new plugin event called getFormFieldTypes(). This allows you to provide extra functionality or instructions on how to handle the form form field.\n    * **GPM Versioning**: A new feature that we have wanted to add to our GPM package management system is the ability to control dependencies by version. We have opted to use a syntax very similar to the Composer Package Manager that is already familiar to most PHP developers. This new versioning system allows you to define specific minimum version requirements of dependent packages within Grav. This should ensure that we have less (hopefully none!) issues when you update one package that also requires a specific minimum version of another package. The admin plugin for example may have an update that requires a specific version of Grav itself.\n    * **GPM Testing Channel**: GPM repository now comes with both a `stable` and `testing` channel. A new setting in `system.gpm.releases` allow to switch between the two channels. Developers will be able to decide whether their resource is going to be in a pre-release state or stable. Only users who switch to the **testing** channel will be able to install a pre-release version.\n    * **GPM Events**: Packages (plugins and themes) can now add event handlers to hook in the package GPM events: install, update, uninstall. A package can listen for events before and after each of these events, and can execute any PHP code, and optionally halt the procedure or return a message.\n    * Refactor of the process chain breaking out `Processors` into individual classes to allow for easier modification and addition. Thanks to toovy for this work. - [#745](https://github.com/getgrav/grav/pull/745)\n    * Added multipart downloads, resumable downloads, download throttling, and video streaming in the `Utils::download()` method.\n    * Added optional config to allow Twig processing in page frontmatter - [#788](https://github.com/getgrav/grav/pull/788)\n    * Added the ability to provide blueprints via a plugin (previously limited to Themes only).\n    * Added Developer CLI Tools to easily create a new theme or plugin\n    * Allow authentication for proxies - [#698](https://github.com/getgrav/grav/pull/698)\n    * Allow to override the default Parsedown behavior - [#747](https://github.com/getgrav/grav/pull/747)\n    * Added an option to allow to exclude external files from the pipeline, and to render the pipeline before/after excluded files\n    * Added the possibility to store translations of themes in separate files inside the `languages` folder\n    * Added a method to the Uri class to return the base relative URL including the language prefix, or the base relative url if multilanguage is not enabled\n    * Added a shortcut for pages.find() alias\n1. [](#improved)\n    * Now supporting hostnames with localhost environments for better vhost support/development\n    * Refactor hard-coded paths to use PHP Streams that allow a setup file to configure where certain parts of Grav are stored in the physical filesystem.\n    * If multilanguage is active, include the Intl Twig Extension to allow translating dates automatically (http://twig.sensiolabs.org/doc/extensions/intl.html)\n    * Allow having local themes with the same name as GPM themes, by adding `gpm: false` to the theme blueprint - [#767](https://github.com/getgrav/grav/pull/767)\n    * Caddyfile and Lighttpd config files updated\n    * Removed `node_modules` folder from backups to make them faster\n    * Display error when `bin/grav install` hasn't been run instead of throwing exception. Prevents \"white page\" errors if error display is off\n    * Improved command line flow when installing multiple packages: don't reinstall packages if already installed, ask once if should use symlinks if symlinks are found\n    * Added more tests to our testing suite\n    * Added x-ua-compatible to http_equiv metadata processing\n    * Added ability to have a per-page `frontmatter.yaml` file to set header frontmatter defaults. Especially useful for multilang scenarios - [#775](https://github.com/getgrav/grav/pull/775)\n    * Removed deprecated `bin/grav newuser` CLI command.  use `bin/plugin login newuser` instead.\n    * Added `webm` and `ogv` video types to the default media types list.\n1. [](#bugfix)\n    * Fix Zend Opcache `opcache.validate_timestamps=0` not detecting changes in compiled yaml and twig files\n    * Avoid losing params, query and fragment from the URL when auto-redirecting to a language-specific route - [#759](https://github.com/getgrav/grav/pull/759)\n    * Fix for non-pipeline assets getting lost when pipeline is cached to filesystem\n    * Fix for double encoding resulting from Markdown Extra\n    * Fix for a remote link breaking all CSS rewrites for pipeline\n    * Fix an issue with Retina alternatives not clearing properly between repeat uses\n    * Fix for non standard http/s external markdown links - [#738](https://github.com/getgrav/grav/issues/738)\n    * Fix for `find()` calling redirects via `dispatch()` causing infinite loops - [#781](https://github.com/getgrav/grav/issues/781)\n\n# v1.0.10\n## 02/11/2016\n\n1. [](#new)\n    * Added new `Page::contentMeta()` mechanism to store content-level meta data alongside content\n    * Added Japanese language translation\n1. [](#improved)\n    * Updated some vendor libraries\n1. [](#bugfix)\n    * Hide `streams` blueprint from Admin plugin\n    * Fix translations of languages with `---` in YAML files\n\n# v1.0.9\n## 02/05/2016\n\n1. [](#new)\n    * New **Unit Testing** via Codeception http://codeception.com/\n    * New **page-level SSL** functionality when using `absolute_urls`\n    * Added `reverse_proxy` config option for issues with non-standard ports\n    * Added `proxy_url` config option to support GPM behind proxy servers #639\n    * New `Pages::parentsRawRoutes()` method\n    * Enhanced `bin/gpm info` CLI command with Changelog support #559\n    * Ability to add empty *Folder* via admin plugin\n    * Added latest `jQuery 2.2.0` library to core\n    * Added translations from Crowdin\n1. [](#improved)\n    * [BC] Metadata now supports only flat arrays. To use open graph metas and the likes (ie, 'og:title'), simply specify it in the key.\n    * Refactored `Uri::convertUrl()` method to be more reliable + tests created\n    * Date for last update of a modular sub-page sets modified date of modular page itself\n    * Split configuration up into two steps\n    * Moved Grav-based `base_uri` variables into `Uri::init()`\n    * Refactored init in `URI` to better support testing\n    * Allow `twig_vars` to be exposed earlier and merged later\n    * Avoid setting empty metadata\n    * Accept single group access as a string rather than requiring an array\n    * Return `$this` in Page constructor and init to allow chaining\n    * Added `ext-*` PHP requirements to `composer.json`\n    * Use Whoops 2.0 library while supporting old style\n    * Removed redundant old default-hash fallback mechanisms\n    * Commented out default redirects and routes in `site.yaml`\n    * Added `/tests` folder to deny's of all `webserver-configs/*` files\n    * Various PS and code style fixes\n1. [](#bugfix)\n    * Fix default generator metadata\n    * Fix for broken image processing caused by `Uri::convertUrl()` bugs\n    * Fix loading JS and CSS from collections #623\n    * Fix stream overriding\n    * Remove the URL extension for home link\n    * Fix permissions when the user has no access level set at all\n    * Fix issue with user with multiple groups getting denied on first group\n    * Fixed an issue with `Pages()` internal cache lookup not being unique enough\n    * Fix for bug with `site.redirects` and `site.routes` being an empty list\n    * [Markdown] Don't process links for **special protocols**\n    * [Whoops] serve JSON errors when request is JSON\n\n\n# v1.0.8\n## 01/08/2016\n\n1. [](#new)\n    * Added `rotate`, `flip` and `fixOrientation` image medium methods\n1. [](#bugfix)\n    * Removed IP from Nonce generation. Should be more reliable in a variety of scenarios\n\n# v1.0.7\n## 01/07/2016\n\n1. [](#new)\n    * Added `composer create-project` as an additional installation method #585\n    * New optional system config setting to strip home from page routs and urls #561\n    * Added Greek, Finnish, Norwegian, Polish, Portuguese, and Romanian languages\n    * Added new `Page->topParent()` method to return top most parent of a page\n    * Added plugins configuration tab to debugger\n    * Added support for APCu and PHP7.0 via new Doctrine Cache release\n    * Added global setting for `twig_first` processing (false by default)\n    * New configuration options for Session settings #553\n1. [](#improved)\n    * Switched to SSL for GPM calls\n    * Use `URI->host()` for session domain\n    * Add support for `open_basedir` when installing packages via GPM\n    * Improved `Utils::generateNonceString()` method to handle reverse proxies\n    * Optimized core thumbnails saving 38% in file size\n    * Added new `bin/gpm index --installed-only` option\n    * Improved GPM errors to provider more helpful diagnostic of issues\n    * Removed old hardcoded PHP version references\n    * Moved `onPageContentProcessed()` event so it's fired more reliably\n    * Maintain md5 keys during sorting of Assets #566\n    * Update to Caddyfile for Caddy web server\n1. [](#bugfix)\n    * Fixed an issue with cache/config checksum not being set on cache load\n    * Fix for page blueprint and theme inheritance issue #534\n    * Set `ZipBackup` timeout to 10 minutes if possible\n    * Fix case where we only have inline data for CSS or JS  #565\n    * Fix `bin/grav sandbox` command to work with new `webserver-config` folder\n    * Fix for markdown attributes on external URLs\n    * Fixed issue where `data:` page header was acting as `publish_date:`\n    * Fix for special characters in URL parameters (e.g. /tag:c++) #541\n    * Safety check for an array of nonces to only use the first one\n\n# v1.0.6\n## 12/22/2015\n\n1. [](#new)\n    * Set minimum requirements to [PHP 5.5.9](http://bit.ly/1Jt9OXO)\n    * Added `saveConfig` to Themes\n1. [](#improved)\n    * Updated Whoops to new 2.0 version (PHP 7.0 compatible)\n    * Moved sample web server configs into dedicated directory\n    * FastCGI will use Apache's `mod_deflate` if gzip turned off\n1. [](#bugfix)\n    * Fix broken media image operators\n    * Only call extra method of blueprints if blueprints exist\n    * Fix lang prefix in url twig variables #523\n    * Fix case insensitive HTTPS check #535\n    * Field field validation handles case `multiple` missing\n\n# v1.0.5\n## 12/18/2015\n\n1. [](#new)\n    * Add ability to extend markdown with plugins\n    * Added support for plugins to have individual language files\n    * Added `7z` to media formats\n    * Use Grav's fork of Parsedown until PR is merged\n    * New function to persist plugin configuration to disk\n    * GPM `selfupgrade` will now check PHP version requirements\n1. [](#improved)\n    * If the field allows multiple files, return array\n    * Handle non-array values in file validation\n1. [](#bugfix)\n    * Fix when looping `fields` param in a `list` field\n    * Properly convert commas to spaces for media attributes\n    * Forcing Travis VM to HI timezone to address future files in zip file\n\n# v1.0.4\n## 12/12/2015\n\n1. [](#bugfix)\n    * Needed to put default image folder permissions for YAML compatibility\n\n# v1.0.3\n## 12/11/2015\n\n1. [](#bugfix)\n    * Fixed issue when saving config causing incorrect image cache folder perms\n\n# v1.0.2\n## 12/11/2015\n\n1. [](#bugfix)\n    * Fix for timing display in debugbar\n\n# v1.0.1\n## 12/11/2015\n\n1. [](#improved)\n    * Reduced package sizes by removing extra vendor dev bits\n1. [](#bugfix)\n    * Fix issue when you enable debugger from admin plugin\n\n# v1.0.0\n## 12/11/2015\n\n1. [](#new)\n    * Add new link attributes via markdown media\n    * Added setters to set state of CSS/JS pipelining\n    * Added `user/accounts` to `.gitignore`\n    * Added configurable permissions option for Image cache\n1. [](#improved)\n    * Hungarian translation updated\n    * Refactored Theme initialization for improved flexibility\n    * Wrapped security section of account blueprints in an 'super user' authorize check\n    * Minor performance optimizations\n    * Updated core page blueprints with markdown preview option\n    * Added useful cache info output to Debugbar\n    * Added `iconv` polyfill library used by Symfony 2.8\n    * Force lowercase of username in a few places for case sensitive filesystems\n1. [](#bugfix)\n    * Fix for GPM problems \"Call to a member function set() on null\"\n    * Fix for individual asset pipeline values not functioning\n    * Fix `Page::copy()` and `Page::move()` to support multiple moves at once\n    * Fixed page moving of a page with no content\n    * Fix for wrong ordering when moving many pages\n    * Escape root path in page medium files to work with special characters\n    * Add missing parent constructor to Themes class\n    * Fix missing file error in `bin/grav sandbox` command\n    * Fixed changelog differ when upgrading Grav\n    * Fixed a logic error in `Validation->validate()`\n    * Make `$container` available in `setup.php` to fix multi-site\n\n# v1.0.0-rc.6\n## 12/01/2015\n\n1. [](#new)\n    * Refactor Config classes for improved performance!\n    * Refactor Data classes to use `NestedArrayAccess` instead of `DataMutatorTrait`\n    * Added support for `classes` and `id` on medium objects to set CSS values\n    * Data objects: Allow function call chaining\n    * Data objects: Lazy load blueprints only if needed\n    * Automatically create unique security salt for each configuration\n    * Added Hungarian translation\n    * Added support for User groups\n1. [](#improved)\n    * Improved robots.txt to disallow crawling of non-user folders\n    * Nonces only generated once per action and process\n    * Added IP into Nonce string calculation\n    * Nonces now use random string with random salt to improve performance\n    * Improved list form handling #475\n    * Vendor library updates\n1. [](#bugfix)\n    * Fixed help output for `bin/plugin`\n    * Fix for nested logic for lists and form parsing #273\n    * Fix for array form fields and last entry not getting deleted\n    * Should not be able to set parent to self #308\n\n# v1.0.0-rc.5\n## 11/20/2015\n\n1. [](#new)\n    * Added **nonce** functionality for all admin forms for improved security\n    * Implemented the ability for Plugins to provide their own CLI commands through `bin/plugin`\n    * Added Croatian translation\n    * Added missing `umask_fix` property to `system.yaml`\n    * Added current theme's config to global config. E.g. `config.theme.dropdown_enabled`\n    * Added `append_url_extension` option to system config & page headers\n    * Users have a new `state` property to allow disabling/banning\n    * Added new `Page.relativePagePath()` helper method\n    * Added new `|pad` Twig filter for strings (uses `str_pad()`)\n    * Added `lighttpd.conf` for Lightly web server\n1. [](#improved)\n    * Clear previously applied operations when doing a reset on image media\n    * Password no longer required when editing user\n    * Improved support for trailing `/` URLs\n    * Improved `.nginx.conf` configuration file\n    * Improved `.htaccess` security\n    * Updated vendor libs\n    * Updated `composer.phar`\n    * Use streams instead of paths for `clearCache()`\n    * Use PCRE_UTF8 so unicode strings can be regexed in Truncator\n    * Handle case when login plugin is disabled\n    * Improved `quality` functionality in media handling\n    * Added some missing translation strings\n    * Deprecated `bin/grav newuser` in favor of `bin/plugin login new-user`\n    * Moved fallback types to use any valid media type\n    * Renamed `system.pages.fallback_types` to `system.media.allowed_fallback_types`\n    * Removed version number in default `generator` meta tag\n    * Disable time limit in case of slow downloads\n    * Removed default hash in `system.yaml`\n1. [](#bugfix)\n    * Fix for media using absolute URLs causing broken links\n    * Fix theme auto-loading #432\n    * Don't create empty `<style>` or `<script>` scripts if no data\n    * Code cleanups\n    * Fix undefined variable in Config class\n    * Fix exception message when label is not set\n    * Check in `Plugins::get()` to ensure plugins exists\n    * Fixed GZip compression making output buffering work correctly with all servers and browsers\n    * Fixed date representation in system config\n\n# v1.0.0-rc.4\n## 10/29/2015\n\n1. [](#bugfix)\n    * Fixed a fatal error if you have a collection with missing or invalid `@page: /route`\n\n# v1.0.0-rc.3\n## 10/29/2015\n\n1. [](#new)\n    * New Page collection options! `@self.parent, @self.siblings, @self.descendants` + more\n    * White list of file types for fallback route functionality (images by default)\n1. [](#improved)\n    * Assets switched from defines to streams\n1. [](#bugfix)\n    * README.md typos fixed\n    * Fixed issue with routes that have lang string in them (`/en/english`)\n    * Trim strings before validation so whitespace is not satisfy 'required'\n\n# v1.0.0-rc.2\n## 10/27/2015\n\n1. [](#new)\n    * Added support for CSS Asset groups\n    * Added a `wrapped_site` system option for themes/plugins to use\n    * Pass `Page` object as event to `onTwigPageVariables()` event hook\n    * New `Data.items()` method to get all items\n1. [](#improved)\n    * Missing pipelined remote asset will now fail quietly\n    * More reliably handle inline JS and CSS to remove only surrounding HTML tags\n    * `Medium.meta` returns new Data object so null checks are possible\n    * Improved Medium metadata merging to allow for automatic title/alt/class attributes\n    * Moved Grav object to global variable rather than template variable (useful for macros)\n    * German language improvements\n    * Updated bundled composer\n1. [](#bugfix)\n    * Accept variety of `true` values in `User.authorize()` method\n    * Fix for `Validation` throwing an error if no label set\n\n# v1.0.0-rc.1\n## 10/23/2015\n\n1. [](#new)\n    * Use native PECL YAML parser if installed for 4X speed boost in parsing YAML files\n    * Support for inherited theme class\n    * Added new default language prepend system configuration option\n    * New `|evaluate` Twig filter to evaluate a string as twig\n    * New system option to ignore all **hidden** files and folders\n    * New system option for default redirect code\n    * Added ability to append specific `[30x]` codes to redirect URLs\n    * Added `url_taxonomy_filters` for page collections\n    * Added `@root` page and `recurse` flag for page collections\n    * Support for **multiple** page collection types as an array\n    * Added Dutch language file\n    * Added Russian language file\n    * Added `remove` method to User object\n1. [](#improved)\n    * Moved hardcoded mimetypes to `media.yaml` to be treated as Page media files\n    * Set `errors: display: false` by default in `system.yaml`\n    * Strip out extra slashes in the URI\n    * Validate hostname to ensure it is valid\n    * Ignore more SCM folders in Backups\n    * Removed `home_redirect` settings from `system.yaml`\n    * Added Page `media` as root twig object for consistency\n    * Updated to latest vendor libraries\n    * Optimizations to Asset pipeline logic for minor speed increase\n    * Block direct access to a variety of files in `.htaccess` for increased security\n    * Debugbar vendor library update\n    * Always fallback to english if other translations are not available\n1. [](#bugfix)\n    * Fix for redirecting external URL with multi-language\n    * Fix for Asset pipeline not respecting asset groups\n    * Fix language files with child/parent theme relationships\n    * Fixed a regression issue resulting in incorrect default language\n    * Ensure error handler is initialized before URI is processed\n    * Use default language in Twig if active language is not set\n    * Fixed issue with `safeEmailFilter()` Twig filter not separating with `;` properly\n    * Fixed empty YAML file causing error with native PECL YAML parser\n    * Fixed `SVG` mimetype\n    * Fixed incorrect `Cache-control: max-age` value format\n\n# v0.9.45\n## 10/08/2015\n\n1. [](#bugfix)\n    * Fixed a regression issue resulting in incorrect default language\n\n# v0.9.44\n## 10/07/2015\n\n1. [](#new)\n    * Added Redis back as a supported cache mechanism\n    * Allow Twig `nicetime` translations\n    * Added `-y` option for 'Yes to all' in `bin/gpm update`\n    * Added CSS `media` attribute to the Assets manager\n    * New German language support\n    * New Czech language support\n    * New French language support\n    * Added `modulus` twig filter\n1. [](#improved)\n    * URL decode in medium actions to allow complex syntax\n    * Take into account `HTTP_HOST` before `SERVER_NAME` (helpful with Nginx)\n    * More friendly cache naming to ease manual management of cache systems\n    * Added default Apache resource for `DirectoryIndex`\n1. [](#bugfix)\n    * Fix GPM failure when offline\n    * Fix `open_basedir` error in `bin/gpm install`\n    * Fix an HHVM error in Truncator\n    * Fix for XSS vulnerability with params\n    * Fix chaining for responsive size derivatives\n    * Fix for saving pages when removing the page title and all other header elements\n    * Fix when saving array fields\n    * Fix for ports being included in `HTTP_HOST`\n    * Fix for Truncator to handle PHP tags gracefully\n    * Fix for locate style lang codes in `getNativeName()`\n    * Urldecode image basenames in markdown\n\n# v0.9.43\n## 09/16/2015\n\n1. [](#new)\n    * Added new `AudioMedium` for HTML5 audio\n    * Added ability for Assets to be added and displayed in separate *groups*\n    * New support for responsive image derivative sizes\n1. [](#improved)\n    * GPM theme install now uses a `copy` method so new files are not lost (e.g. `/css/custom.css`)\n    * Code analysis improvements and cleanup\n    * Removed Twig panel from debugger (no longer supported in Twig 1.20)\n    * Updated composer packages\n    * Prepend active language to `convertUrl()` when used in markdown links\n    * Added some pre/post flight options for installer via blueprints\n    * Hyphenize the site name in the backup filename\n1. [](#bugfix)\n    * Fix broken routable logic\n    * Check for `phpinfo()` method in case it is restricted by hosting provider\n    * Fixes for windows when running GPM\n    * Fix for ampersand (`&`) causing error in `truncateHtml()` via `Page.summary()`\n\n# v0.9.42\n## 09/11/2015\n\n1. [](#bugfix)\n    * Fixed `User.authorise()` to be backwards compabile\n\n# v0.9.41\n## 09/11/2015\n\n1. [](#new)\n    * New and improved multibyte-safe TruncateHTML function and filter\n    * Added support for custom page date format\n    * Added a `string` Twig filter to render as json_encoded string\n    * Added `authorize` Twig filter\n    * Added support for theme inheritance in the admin\n    * Support for multiple content collections on a page\n    * Added configurable files/folders ignores for pages\n    * Added the ability to set the default PHP locale and override via multi-lang configuration\n    * Added ability to save as YAML via admin\n    * Added check for `mbstring` support\n    * Added new `redirect` header for pages\n1. [](#improved)\n    * Changed dependencies from `develop` to `master`\n    * Updated logging to log everything from `debug` level on (was `warning`)\n    * Added missing `accounts/` folder\n    * Default to performing a 301 redirect for URIs with trailing slashes\n    * Improved Twig error messages\n    * Allow validating of forms from anywhere such as plugins\n    * Added logic so modular pages are by default non-routable\n    * Hide password input in `bin/grav newuser` command\n1. [](#bugfix)\n    * Fixed `Pages.all()` not returning modular pages\n    * Fix for modular template types not getting found\n    * Fix for `markdown_extra:` overriding `markdown:extra:` setting\n    * Fix for multi-site routing\n    * Fix for multi-lang page name error\n    * Fixed a redirect loop in `URI` class\n    * Fixed a potential error when `unsupported_inline_types` is empty\n    * Correctly generate 2x retina image\n    * Typo fixes in page publish/unpublish blueprint\n\n# v0.9.40\n## 08/31/2015\n\n1. [](#new)\n    * Added some new Twig filters: `defined`, `rtrim`, `ltrim`\n    * Admin support for customizable page file name + template override\n1. [](#improved)\n    * Better message for incompatible/unsupported Twig template\n    * Improved User blueprints with better help\n    * Switched to composer **install** rather than **update** by default\n    * Admin autofocus on page title\n    * `.htaccess` hardening (`.htaccess` & `htaccess.txt`)\n    * Cache safety checks for missing folders\n1. [](#bugfix)\n    * Fixed issue with unescaped `o` character in date formats\n\n# v0.9.39\n## 08/25/2015\n\n1. [](#bugfix)\n    * `Page.active()` not triggering on **homepage**\n    * Fix for invalid session name in Opera browser\n\n# v0.9.38\n## 08/24/2015\n\n1. [](#new)\n    * Added `language` to **user** blueprint\n    * Added translations to blueprints\n    * New extending logic for blueprints\n    * Blueprints are now loaded with Streams to allow for better overrides\n    * Added new Symfony `dump()` method\n1. [](#improved)\n    * Catch YAML header parse exception so site doesn't die\n    * Better `Page.parent()` logic\n    * Improved GPM display layout\n    * Tweaked default page layout\n    * Unset route and slug for improved reliability of route changes\n    * Added requirements to README.md\n    * Updated various libraries\n    * Allow use of custom page date field for dateRange collections\n1. [](#bugfix)\n    * Slug fixes with GPM\n    * Unset plaintext password on save\n    * Fix for trailing `/` not matching active children\n\n# v0.9.37\n## 08/12/2015\n\n3. [](#bugfix)\n    * Fixed issue when saving `header.process` in page forms via the **admin plugin**\n    * Fixed error due to use of `set_time_limit` that might be disabled on some hosts\n\n# v0.9.36\n## 08/11/2015\n\n1. [](#new)\n    * Added a new `newuser` CLI command to create user accounts\n    * Added `default` blueprint for all templates\n    * Support `user` and `system` language translation merging\n1. [](#improved)\n    * Added isSymlink method in GPM to determine if Grav is symbolically linked or not\n    * Refactored page recursing\n    * Updated blueprints to use new toggles\n    * Updated blueprints to use current date for date format fields\n    * Updated composer.phar\n    * Use sessions for admin even when disabled for site\n    * Use `GRAV_ROOT` in session identifier\n\n# v0.9.35\n## 08/06/2015\n\n1. [](#new)\n    * Added `body_classes` field\n    * Added `visiblity` toggle and help tooltips on new page form\n    * Added new `Page.unsetRoute()` method to allow admin to regenerate the route\n2. [](#improved)\n    * User save no longer stores username each time\n    * Page list form field now shows all pages except root\n    * Removed required option from page title\n    * Added configuration settings for running Nginx in sub directory\n3. [](#bugfix)\n    * Fixed deep translation merging\n    * Fixed broken **metadata** merging with site defaults\n    * Fixed broken **summary** field\n    * Fixed broken robots field\n    * Fixed GPM issue when using cURL, throwing an `Undefined offset: 1` exception\n    * Removed duplicate hidden page `type` field\n\n# v0.9.34\n## 08/04/2015\n\n1. [](#new)\n    * Added new `cache_all` system setting + media `cache()` method\n    * Added base languages configuration\n    * Added property language to page to help plugins identify page language\n    * New `Utils::arrayFilterRecursive()` method\n2. [](#improved)\n    * Improved Session handling to support site and admin independently\n    * Allow Twig variables to be modified in other events\n    * Blueprint updates in preparation for Admin plugin\n    * Changed `Inflector` from static to object and added multi-language support\n    * Support for admin override of a page's blueprints\n3. [](#bugfix)\n    * Removed unused `use` in `VideoMedium` that was causing error\n    * Array fix in `User.authorise()` method\n    * Fix for typo in `translations_fallback`\n    * Fixed moving page to the root\n\n# v0.9.33\n## 07/21/2015\n\n1. [](#new)\n    * Added new `onImageMediumSaved()` event (useful for post-image processing)\n    * Added `Vary: Accept-Encoding` option\n2. [](#improved)\n    * Multilang-safe delimiter position\n    * Refactored Twig classes and added optional umask setting\n    * Removed `pageinit()` timing\n    * `Page->routable()` now takes `published()` state into account\n    * Improved how page extension is set\n    * Support `Language->translate()` method taking string and array\n3. [](#bugfix)\n    * Fixed `backup` command to include empty folders\n\n# v0.9.32\n## 07/14/2015\n\n1. [](#new)\n    * Detect users preferred language via `http_accept_language` setting\n    * Added new `translateArray()` language method\n2. [](#improved)\n    * Support `en` translations by default for plugins & themes\n    * Improved default generator tag\n    * Minor language tweaks and fixes\n3. [](#bugfix)\n    * Fix for session active language and homepage redirects\n    * Ignore root-level page rather than throwing error\n\n# v0.9.31\n## 07/09/2015\n\n1. [](#new)\n    * Added xml, json, css and js to valid media file types\n2. [](#improved)\n    * Better handling of unsupported media type downloads\n    * Improved `bin/grav backup` command to mimic admin plugin location/name\n3. [](#bugfix)\n    * Critical fix for broken language translations\n    * Fix for Twig markdown filter error\n    * Safety check for download extension\n\n# v0.9.30\n## 07/08/2015\n\n1. [](#new)\n    * BIG NEWS! Extensive Multi-Language support is all new in 0.9.30!\n    * Translation support via Twig filter/function and PHP method\n    * Page specific default route\n    * Page specific route aliases\n    * Canonical URL route support\n    * Added built-in session support\n    * New `Page.rawRoute()` to get a consistent folder-based route to a page\n    * Added option to always redirect to default page on alias URL\n    * Added language safe redirect function for use in core and plugins\n2. [](#improved)\n    * Improved `Page.active()` and `Page.activeChild()` methods to support route aliases\n    * Various spelling corrections in `.php` comments, `.md` and `.yaml` files\n    * `Utils::startsWith()` and `Utils::endsWith()` now support needle arrays\n    * Added a new timer around `pageInitialized` event\n    * Updated jQuery library to v2.1.4\n3. [](#bugfix)\n    * In-page CSS and JS files are now handled properly\n    * Fix for `enable_media_timestamp` not working properly\n\n# v0.9.29\n## 06/22/2015\n\n1. [](#new)\n    * New and improved Regex-powered redirect and route alias logic\n    * Added new `onBuildPagesInitialized` event for memory critical or time-consuming plugins\n    * Added a `setSummary()` method for pages\n2. [](#improved)\n    * Improved `MergeConfig()` logic for more control\n    * Travis skeleton build trigger implemented\n    * Set composer.json versions to stable versions where possible\n    * Disabled `last_modified` and `etag` page headers by default (causing too much page caching)\n3. [](#bugfix)\n    * Preload classes during `bin/gpm selfupgrade` to avoid issues with updated classes\n    * Fix for directory relative _down_ links\n\n# v0.9.28\n## 06/16/2015\n\n1. [](#new)\n    * Added method to set raw markdown on a page\n    * Added ability to enabled system and page level `etag` and `last_modified` headers\n2. [](#improved)\n    * Improved image path processing\n    * Improved query string handling\n    * Optimization to image handling supporting URL encoded filenames\n    * Use global `composer` when available rather than Grv provided one\n    * Use `PHP_BINARY` constant rather than `php` executable\n    * Updated Doctrine Cache library\n    * Updated Symfony libraries\n    * Moved `convertUrl()` method to Uri object\n3. [](#bugfix)\n    * Fix incorrect slug causing problems with CLI `uninstall`\n    * Fix Twig runtime error with assets pipeline in sufolder installations\n    * Fix for `+` in image filenames\n    * Fix for dot files causing issues with page processing\n    * Fix for Uri path detection on Windows platform\n    * Fix for alternative media resolutions\n    * Fix for modularTypes key properties\n\n# v0.9.27\n## 05/09/2015\n\n1. [](#new)\n    * Added new composer CLI command\n    * Added page-level summary header overrides\n    * Added `size` back for Media objects\n    * Refactored Backup command in preparation for admin plugin\n    * Added a new `parseLinks` method to Plugins class\n    * Added `starts_with` and `ends_with` Twig filters\n2. [](#improved)\n    * Optimized install of vendor libraries for speed improvement\n    * Improved configuration handling in preparation for admin plugin\n    * Cache optimization: Don't cache Twig templates when you pass dynamic params\n    * Moved `Utils::rcopy` to `Folder::rcopy`\n    * Improved `Folder::doDelete`\n    * Added check for required Curl in GPM\n    * Updated included composer.phar to latest version\n    * Various blueprint fixes for admin plugin\n    * Various PSR and code cleanup tasks\n3. [](#bugfix)\n    * Fix issue with Gzip not working with `onShutDown()` event\n    * Fix for URLs with trailing slashes\n    * Handle condition where certain errors resulted in blank page\n    * Fix for issue with theme name equal to base_url and asset pipeline\n    * Fix to properly normalize font rewrite path\n    * Fix for absolute URLs below the current page\n    * Fix for `..` page references\n\n# v0.9.26\n## 04/24/2015\n\n3. [](#bugfix)\n    * Fixed issue with homepage routes failing with 'dirname' error\n\n# v0.9.25\n## 04/24/2015\n\n1. [](#new)\n    * Added support for E-Tag, Last-Modified, Cache-Control and Page-based expires headers\n2. [](#improved)\n    * Refactored media image handling to make it more flexible and support absolute paths\n    * Refactored page modification check process to make it faster\n    * User account improvements in preparation for admin plugin\n    * Protect against timing attacks\n    * Reset default system expires time to 0 seconds (can override if you need to)\n3. [](#bugfix)\n    * Fix issues with spaces in webroot when using `bin/grav install`\n    * Fix for spaces in relative directory\n    * Bug fix in collection filtering\n\n# v0.9.24\n## 04/15/2015\n\n1. [](#new)\n    * Added support for chunked downloads of Assets\n    * Added new `onBeforeDownload()` event\n    * Added new `download()` and `getMimeType()` methods to Utils class\n    * Added configuration option for supported page types\n    * Added assets and media timestamp options (off by default)\n    * Added page expires configuration option\n2. [](#bugfix)\n    * Fixed issue with Nginx/Gzip and `ob_flush()` throwing error\n    * Fixed assets actions on 'direct media' URLs\n    * Fix for 'direct assets` with any parameters\n\n# v0.9.23\n## 04/09/2015\n\n1. [](#bugfix)\n    * Fix for broken GPM `selfupgrade` (Grav 0.9.21 and 0.9.22 will need to manually upgrade to this version)\n\n# v0.9.22\n## 04/08/2015\n\n1. [](#bugfix)\n    * Fix to normalize GRAV_ROOT path for Windows\n    * Fix to normalize Media image paths for Windows\n    * Fix for GPM `selfupgrade` when you are on latest version\n\n# v0.9.21\n## 04/07/2015\n\n1. [](#new)\n    * Major Media functionality enhancements: SVG, Animated GIF, Video support!\n    * Added ability to configure default image quality in system configuration\n    * Added `sizes` attributes for custom retina image breakpoints\n2. [](#improved)\n    * Don't scale @1x retina images\n    * Add filter to Iterator class\n    * Updated various composer packages\n    * Various PSR fixes\n\n# v0.9.20\n## 03/24/2015\n\n1. [](#new)\n    * Added `addAsyncJs()` and `addDeferJs()` to Assets manager\n    * Added support for extranal URL redirects\n2. [](#improved)\n    * Fix unpredictable asset ordering when set from plugin/system\n    * Updated `nginx.conf` to ensure system assets are accessible\n    * Ensure images are served as static files in Nginx\n    * Updated vendor libraries to latest versions\n    * Updated included composer.phar to latest version\n3. [](#bugfix)\n    * Fixed issue with markdown links to `#` breaking HTML\n\n# v0.9.19\n## 02/28/2015\n\n1. [](#new)\n    * Added named assets capability and bundled jQuery into Grav core\n    * Added `first()` and `last()` to `Iterator` class\n2. [](#improved)\n    * Improved page modification routine to skip _dot files_\n    * Only use files to calculate page modification dates\n    * Broke out Folder iterators into their own classes\n    * Various Sensiolabs Insight fixes\n3. [](#bugfix)\n    * Fixed `Iterator.nth()` method\n\n# v0.9.18\n## 02/19/2015\n\n1. [](#new)\n    * Added ability for GPM `install` to automatically install `_demo` content if found (w/backup)\n    * Added ability for themes and plugins to have dependencies required to install via GPM\n    * Added ability to override the system timezone rather than relying on server setting only\n    * Added new Twig filter `random_string` for generating random id values\n    * Added new Twig filter `markdown` for on-the-fly markdown processing\n    * Added new Twig filter `absoluteUrl` to convert relative to absolute URLs\n    * Added new `processTemplate()` method to Twig object for on-the-fly processing of twig template\n    * Added `rcopy()` and `contains()` helper methods in Utils\n2. [](#improved)\n    * Provided new `param_sep` variable to better support Apache on Windows\n    * Moved parsedown configuration into the trait\n    * Added optional **deep-copy** option to `mergeConfig()` for plugins\n    * Updated bundled `composer.phar` package\n    * Various Sensiolabs Insight fixes - Silver level now!\n    * Various PSR Fixes\n3. [](#bugfix)\n    * Fix for windows platforms not displaying installed themes/plugins via GPM\n    * Fix page IDs not picking up folder-only pages\n\n# v0.9.17\n## 02/05/2015\n\n1. [](#new)\n    * Added **full HHVM support!** Get your speed on with Facebook's crazy fast PHP JIT compiler\n2. [](#improved)\n    * More flexible page summary control\n    * Support **CamelCase** plugin and theme class names. Replaces dashes and underscores\n    * Moved summary delimiter into `site.yaml` so it can be configurable\n    * Various PSR fixes\n3. [](#bugfix)\n     * Fix for `mergeConfig()` not falling back to defaults\n     * Fix for `addInlineCss()` and `addInlineJs()` Assets not working between Twig tags\n     * Fix for Markdown adding HTML tags into inline CSS and JS\n\n# v0.9.16\n## 01/30/2015\n\n1. [](#new)\n    * Added **Retina** and **Responsive** image support via Grav media and `srcset` image attribute\n    * Added image debug option that overlays responsive resolution\n    * Added a new image cache stream\n2. [](#improved)\n    * Improved the markdown Lightbox functionality to better mimic Twig version\n    * Fullsize Lightbox can now have filters applied\n    * Added a new `mergeConfig()` method to Plugin class to merge system + page header configuration\n    * Added a new `disable()` method to Plugin class to programmatically disable a plugin\n    * Updated Parsedown and Parsedown Extra to address bugs\n    * Various PSR fixes\n3. [](#bugfix)\n     * Fix bug with image dispatch in traditionally _non-routable_ pages\n     * Fix for markdown link not working on non-current pages\n     * Fix for markdown images not being found on homepage\n\n# v0.9.15\n## 01/23/2015\n\n3. [](#bugfix)\n     * Typo in video mime types\n     * Fix for old `markdown_extra` system setting not getting picked up\n     * Fix in regex for Markdown links with numeric values in path\n     * Fix for broken image routing mechanism that got broken at some point\n     * Fix for markdown images/links in pages with page slug override\n\n# v0.9.14\n## 01/23/2015\n\n1. [](#new)\n    * Added **GZip** support\n    * Added multiple configurations via `setup.php`\n    * Added base structure for unit tests\n    * New `onPageContentRaw()` plugin event that processes before any page processing\n    * Added ability to dynamically set Metadata on page\n    * Added ability to dynamically configure Markdown processing via Parsedown options\n2. [](#improved)\n    * Refactored `page.content()` method to be more flexible and reliable\n    * Various updates and fixes for streams resulting in better multi-site support\n    * Updated Twig, Parsedown, ParsedownExtra, DoctrineCache libraries\n    * Refactored Parsedown trait\n    * Force modular pages to be non-visible in menus\n    * Moved RewriteBase before Exploits in `.htaccess`\n    * Added standard video formats to Media support\n    * Added priority for inline assets\n    * Check for uniqueness when adding multiple inline assets\n    * Improved support for Twig-based URLs inside Markdown links and images\n    * Improved Twig `url()` function\n3. [](#bugfix)\n    * Fix for HTML entities quotes in Metadata values\n    * Fix for `published` setting to have precedent of `publish_date` and `unpublish_date`\n    * Fix for `onShutdown()` events not closing connections properly in **php-fpm** environments\n\n# v0.9.13\n## 01/09/2015\n\n1. [](#new)\n    * Added new published `true|false` state in page headers\n    * Added `publish_date` in page headers to automatically publish page\n    * Added `unpublish_date` in page headers to automatically unpublish page\n    * Added `dateRange()` capability for collections\n    * Added ability to dynamically control Cache lifetime programmatically\n    * Added ability to sort by anything in the page header. E.g. `sort: header.taxonomy.year`\n    * Added various helper methods to collections: `copy, nonVisible, modular, nonModular, published, nonPublished, nonRoutable`\n2. [](#improved)\n    * Modified all Collection methods so they can be chained together: `$collection->published()->visible()`\n    * Set default Cache lifetime to default of 1 week (604800 seconds) - was infinite\n    * House-cleaning of some unused methods in Pages object\n3. [](#bugfix)\n    * Fix `uninstall` GPM command that was broken in last release\n    * Fix for intermittent `undefined index` error when working with Collections\n    * Fix for date of some pages being set to incorrect future timestamps\n\n# v0.9.12\n## 01/06/2015\n\n1. [](#new)\n    * Added an all-access robots.txt file for search engines\n    * Added new GPM `uninstall` command\n    * Added support for **in-page** Twig processing in **modular** pages\n    * Added configurable support for `undefined` Twig functions and filters\n2. [](#improved)\n    * Fall back to default `.html` template if error occurs on non-html pages\n    * Added ability to have PSR-1 friendly plugin names (CamelCase, no-dashes)\n    * Fix to `composer.json` to deter API rate-limit errors\n    * Added **non-exception-throwing** handler for undefined methods on `Medium` objects\n3. [](#bugfix)\n    * Fix description for `self-upgrade` method of GPM command\n    * Fix for incorrect version number when performing GPM `update`\n    * Fix for argument description of GPM `install` command\n    * Fix for recalcitrant CodeKit mac application\n\n# v0.9.11\n## 12/21/2014\n\n1. [](#new)\n    * Added support for simple redirects as well as routes\n2. [](#improved)\n    * Handle Twig errors more cleanly\n3. [](#bugfix)\n    * Fix for error caused by invalid or missing user agent string\n    * Fix for directory relative links and URL fragments (#pagelink)\n    * Fix for relative links with no subfolder in `base_url`\n\n# v0.9.10\n## 12/12/2014\n\n1. [](#new)\n    * Added Facebook-style `nicetime` date Twig filter\n2. [](#improved)\n    * Moved `clear-cache` functionality into Cache object required for Admin plugin\n3. [](#bugfix)\n    * Fix for undefined index with previous/next buttons\n\n# v0.9.9\n## 12/05/2014\n\n1. [](#new)\n    * Added new `@page` collection type\n    * Added `ksort` and `contains` Twig filters\n    * Added `gist` Twig function\n2. [](#improved)\n    * Refactored Page previous/next/adjacent functionality\n    * Updated to Symfony 2.6 for yaml/console/event-dispatcher libraries\n    * More PSR code fixes\n3. [](#bugfix)\n    * Fix for over-escaped apostrophes in YAML\n\n# v0.9.8\n## 12/01/2014\n\n1. [](#new)\n    * Added configuration option to set default lifetime on cache saves\n    * Added ability to set HTTP status code from page header\n    * Implemented simple wild-card custom routing\n2. [](#improved)\n    * Fixed elusive double load to fully cache issue (crossing fingers...)\n    * Ensure Twig tags are treated as block items in markdown\n    * Removed some older deprecated methods\n    * Ensure onPageContentProcessed() event only fires when not cached\n    * More PSR code fixes\n3. [](#bugfix)\n    * Fix issue with miscalculation of blog separator location `===`\n\n# v0.9.7\n## 11/24/2014\n\n1. [](#improved)\n    * Nginx configuration updated\n    * Added gitter.im badge to README\n    * Removed `set_time_limit()` and put checks around `ignore_user_abort`\n    * More PSR code fixes\n2. [](#bugfix)\n    * Fix issue with non-valid asset path showing up when they shouldn't\n    * Fix for JS asset pipeline and scripts that don't end in `;`\n    * Fix for schema-based markdown URLs broken routes (eg `mailto:`)\n\n# v0.9.6\n## 11/17/2014\n\n1. [](#improved)\n    * Moved base_url variables into Grav container\n    * Forced media sorting to use natural sort order by default\n    * Various PSR code tidying\n    * Added filename, extension, thumb to all medium objects\n2. [](#bugfix)\n    * Fix for infinite loop in page.content()\n    * Fix hostname for configuration overrides\n    * Fix for cached configuration\n    * Fix for relative URLs in markdown on installs with no base_url\n    * Fix for page media images with uppercase extension\n\n# v0.9.5\n## 11/09/2014\n\n1. [](#new)\n    * Added quality setting to medium for compression configuration of images\n    * Added new onPageContentProcessed() event that is post-content processing but pre-caching\n2. [](#improved)\n    * Added support for AND and OR taxonomy filtering.  AND by default (was OR)\n    * Added specific clearing options for CLI clear-cache command\n    * Moved environment method to URI so it can be accessible in plugins and themes\n    * Set Grav's output variable to public so it can be manipulated in onOutputGenerated event\n    * Updated vendor libraries to latest versions\n    * Better handing of 'home' in active menu state detection\n    * Various PSR code tidying\n    * Improved some error messages and notices\n3. [](#bugfix)\n    * Force route rebuild when configuration changes\n    * Fix for 'installed undefined' error in CLI versions command\n    * Do not remove the JSON/Text error handlers\n    * Fix for supporting inline JS and CSS when Asset pipeline enabled\n    * Fix for Data URLs in CSS being badly formed\n    * Fix Markdown links with fragment and query elements\n\n# v0.9.4\n## 10/29/2014\n\n1. [](#new)\n    * New improved Debugbar with messages, timing, config, twig information\n    * New exception handling system utilizing Whoops\n    * New logging system utilizing Monolog\n    * Support for auto-detecting environment configuration\n    * New version command for CLI\n    * Integrate Twig dump() calls into Debugbar\n2. [](#improved)\n    * Selfupgrade now clears cache on successful upgrade\n    * Selfupgrade now supports files without extensions\n    * Improved error messages when plugin is missing\n    * Improved security in .htaccess\n    * Support CSS/JS/Image assets in vendor/system folders via .htaccess\n    * Add support for system timers\n    * Improved and optimized configuration loading\n    * Automatically disable Debugbar on non-HTML pages\n    * Disable Debugbar by default\n3. [](#bugfix)\n    * More YAML blueprint fixes\n    * Fix potential double // in assets\n    * Load debugger as early as possible\n\n# v0.9.3\n## 10/09/2014\n\n1. [](#new)\n    * GPM (Grav Package Manager) Added\n    * Support for multiple Grav configurations\n    * Dynamic media support via URL\n    * Added inlineCss and inlineJs support for Assets\n2. [](#improved)\n    * YAML caching for increased performance\n    * Use stream wrapper in pages, plugins and themes\n    * Switched to RocketTheme toolbox for some core functionality\n    * Renamed `setup` CLI command to `sandbox`\n    * Broke cache types out into multiple directories in the cache folder\n    * Removed vendor libs from github repository\n    * Various PSR cleanup of code\n    * Various Blueprint updates to support upcoming admin plugin\n    * Added ability to filter page children for normal/modular/all\n    * Added `sort_by_key` twig filter\n    * Added `visible()` and `routable()` filters to page collections\n    * Use session class in shutdown process\n    * Improvements to modular page loading\n    * Various code cleanup and optimizations\n3. [](#bugfix)\n    * Fixed file checking not updating the last modified time. For real this time!\n    * Switched debugger to PRODUCTION mode by default\n    * Various fixes in URI class for increased reliability\n\n# v0.9.2\n## 09/15/2014\n\n1. [](#new)\n    * New flexible site and page metadata support including ObjectGraph and Facebook\n    * New method to get user IP address in URI object\n    * Added new onShutdown() event that fires after connection is closed for Async features\n2. [](#improved)\n    * Skip assets pipeline minify on Windows platforms by default due to PHP issue 47689\n    * Fixed multiple level menus not highlighting correctly\n    * Updated some blueprints in preparation for admin plugin\n    * Fail gracefully when theme does not exist\n    * Add stream support into ResourceLocator::addPath()\n    * Separate themes from plugins, add themes:// stream and onTask events\n    * Added barDump() to Debugger\n    * Removed stray test page\n    * Override modified only if a non-markdown file was modified\n    * Added assets attributes support\n    * Auto-run composer install when running the Grav CLI\n    * Vendor folder removed from repository\n    * Minor configuration performance optimizations\n    * Minor debugger performance optimizations\n3. [](#bugfix)\n    * Fix url() twig function when Grav isn't installed at root\n    * Workaround for PHP bug 52065\n    * Fixed getList() method on Pages object that was not working\n    * Fix for open_basedir error\n    * index.php now warns if not running on PHP 5.4\n    * Removed memcached option (redundant)\n    * Removed memcache from auto setup, added memcache server configuration option\n    * Fix broken password validation\n    * Back to proper PSR-4 Autoloader\n\n# v0.9.1\n## 09/02/2014\n\n1. [](#new)\n    * Added new `theme://` PHP stream for current theme\n2. [](#improved)\n    * Default to new `file` modification checking rather than `folder`\n    * Added support for various markdown link formats to convert to Grav-friendly URLs\n    * Moved configure() from Theme to Themes class\n    * Fix autoloading without composer update -o\n    * Added support for Twig url method\n    * Minor code cleanup\n3. [](#bugfix)\n    * Fixed issue with page changes not being picked up\n    * Fixed Minify to provide `@supports` tag compatibility\n    * Fixed ResourceLocator not working with multiple paths\n    * Fixed issue with Markdown process not stripping LFs\n    * Restrict file type extensions for added security\n    * Fixed template inheritance\n    * Moved Browser class to proper location\n\n# v0.9.0\n## 08/25/2014\n\n1. [](#new)\n    * Addition of Dependency Injection Container\n    * Refactored plugins to use Symfony Event Dispatcher\n    * New Asset Manager to provide unified management of JavaScript and CSS\n    * Asset Pipelining to provide unification, minify, and optimization of JavaScript and CSS\n    * Grav Media support directly in Markdown syntax\n    * Additional Grav Generator meta tag in default themes\n    * Added support for PHP Stream Wrapper for resource location\n    * Markdown Extra support\n    * Browser object for fast browser detection\n2. [](#improved)\n    * PSR-4 Autoloader mechanism\n    * Tracy Debugger new `detect` option to detect running environment\n    * Added new `random` collection sort option\n    * Make media images progressive by default\n    * Additional URI filtering for improved security\n    * Safety checks to ensure PHP 5.4.0+\n    * Move to Slidebars side navigation in default Antimatter theme\n    * Updates to `.htaccess` including section on `RewriteBase` which is needed for some hosting providers\n3. [](#bugfix)\n    * Fixed issue when installing in an apache userdir (~username) folder\n    * Various mobile CSS issues in default themes\n    * Various minor bug fixes\n\n\n# v0.8.0\n## 08/13/2014\n\n1. [](#new)\n    * Initial Release\n", "<?php\n\n/**\n * @package    Grav\\Common\n *\n * @copyright  Copyright (C) 2015 - 2019 Trilby Media, LLC. All rights reserved.\n * @license    MIT License; see LICENSE file for details.\n */\n\nnamespace Grav\\Common;\n\nuse Grav\\Common\\Config\\Config;\nuse Grav\\Common\\Config\\Setup;\nuse Grav\\Common\\Page\\Interfaces\\PageInterface;\nuse Grav\\Common\\Page\\Medium\\ImageMedium;\nuse Grav\\Common\\Page\\Medium\\Medium;\nuse Grav\\Common\\Processors\\AssetsProcessor;\nuse Grav\\Common\\Processors\\BackupsProcessor;\nuse Grav\\Common\\Processors\\ConfigurationProcessor;\nuse Grav\\Common\\Processors\\DebuggerAssetsProcessor;\nuse Grav\\Common\\Processors\\DebuggerProcessor;\nuse Grav\\Common\\Processors\\ErrorsProcessor;\nuse Grav\\Common\\Processors\\InitializeProcessor;\nuse Grav\\Common\\Processors\\LoggerProcessor;\nuse Grav\\Common\\Processors\\PagesProcessor;\nuse Grav\\Common\\Processors\\PluginsProcessor;\nuse Grav\\Common\\Processors\\RenderProcessor;\nuse Grav\\Common\\Processors\\RequestProcessor;\nuse Grav\\Common\\Processors\\SchedulerProcessor;\nuse Grav\\Common\\Processors\\TasksProcessor;\nuse Grav\\Common\\Processors\\ThemesProcessor;\nuse Grav\\Common\\Processors\\TwigProcessor;\nuse Grav\\Framework\\DI\\Container;\nuse Grav\\Framework\\Psr7\\Response;\nuse Grav\\Framework\\RequestHandler\\RequestHandler;\nuse Psr\\Http\\Message\\ResponseInterface;\nuse Psr\\Http\\Message\\ServerRequestInterface;\nuse RocketTheme\\Toolbox\\Event\\Event;\nuse RocketTheme\\Toolbox\\Event\\EventDispatcher;\n\n/**\n * Grav container is the heart of Grav.\n *\n * @package Grav\\Common\n */\nclass Grav extends Container\n{\n    /**\n     * @var string Processed output for the page.\n     */\n    public $output;\n\n    /**\n     * @var static The singleton instance\n     */\n    protected static $instance;\n\n    /**\n     * @var array Contains all Services and ServicesProviders that are mapped\n     *            to the dependency injection container.\n     */\n    protected static $diMap = [\n        'Grav\\Common\\Service\\AccountsServiceProvider',\n        'Grav\\Common\\Service\\AssetsServiceProvider',\n        'Grav\\Common\\Service\\BackupsServiceProvider',\n        'Grav\\Common\\Service\\ConfigServiceProvider',\n        'Grav\\Common\\Service\\ErrorServiceProvider',\n        'Grav\\Common\\Service\\FilesystemServiceProvider',\n        'Grav\\Common\\Service\\InflectorServiceProvider',\n        'Grav\\Common\\Service\\LoggerServiceProvider',\n        'Grav\\Common\\Service\\OutputServiceProvider',\n        'Grav\\Common\\Service\\PagesServiceProvider',\n        'Grav\\Common\\Service\\RequestServiceProvider',\n        'Grav\\Common\\Service\\SessionServiceProvider',\n        'Grav\\Common\\Service\\StreamsServiceProvider',\n        'Grav\\Common\\Service\\TaskServiceProvider',\n        'browser'    => 'Grav\\Common\\Browser',\n        'cache'      => 'Grav\\Common\\Cache',\n        'events'     => 'RocketTheme\\Toolbox\\Event\\EventDispatcher',\n        'exif'       => 'Grav\\Common\\Helpers\\Exif',\n        'plugins'    => 'Grav\\Common\\Plugins',\n        'scheduler'  => 'Grav\\Common\\Scheduler\\Scheduler',\n        'taxonomy'   => 'Grav\\Common\\Taxonomy',\n        'themes'     => 'Grav\\Common\\Themes',\n        'twig'       => 'Grav\\Common\\Twig\\Twig',\n        'uri'        => 'Grav\\Common\\Uri',\n    ];\n\n    /**\n     * @var array All middleware processors that are processed in $this->process()\n     */\n    protected $middleware = [\n        'configurationProcessor',\n        'loggerProcessor',\n        'errorsProcessor',\n        'debuggerProcessor',\n        'initializeProcessor',\n        'pluginsProcessor',\n        'themesProcessor',\n        'requestProcessor',\n        'tasksProcessor',\n        'backupsProcessor',\n        'schedulerProcessor',\n        'assetsProcessor',\n        'twigProcessor',\n        'pagesProcessor',\n        'debuggerAssetsProcessor',\n        'renderProcessor',\n    ];\n\n    protected $initialized = [];\n\n    /**\n     * Reset the Grav instance.\n     */\n    public static function resetInstance()\n    {\n        if (self::$instance) {\n            self::$instance = null;\n        }\n    }\n\n    /**\n     * Return the Grav instance. Create it if it's not already instanced\n     *\n     * @param array $values\n     *\n     * @return Grav\n     */\n    public static function instance(array $values = [])\n    {\n        if (!self::$instance) {\n            self::$instance = static::load($values);\n        } elseif ($values) {\n            $instance = self::$instance;\n            foreach ($values as $key => $value) {\n                $instance->offsetSet($key, $value);\n            }\n        }\n\n        return self::$instance;\n    }\n\n    /**\n     * Setup Grav instance using specific environment.\n     *\n     * Initializes Grav streams by\n     *\n     * @param string|null $environment\n     * @return $this\n     */\n    public function setup(string $environment = null)\n    {\n        if (isset($this->initialized['setup'])) {\n            return $this;\n        }\n\n        $this->initialized['setup'] = true;\n\n        $this->measureTime('_setup', 'Site Setup', function () use ($environment) {\n            // Force environment if passed to the method.\n            if ($environment) {\n                Setup::$environment = $environment;\n            }\n\n            $this['setup'];\n            $this['streams'];\n        });\n\n        return $this;\n    }\n\n    /**\n     * Initialize CLI environment.\n     *\n     * Call after `$grav->setup($environment)`\n     *\n     * - Load configuration\n     * - Disable debugger\n     * - Set timezone, locale\n     * - Load plugins\n     * - Set Users type to be used in the site\n     *\n     * This method WILL NOT initialize assets, twig or pages.\n     *\n     * @param string|null $environment\n     * @return $this\n     */\n    public function initializeCli()\n    {\n        InitializeProcessor::initializeCli($this);\n\n        return $this;\n    }\n\n    /**\n     * Process a request\n     */\n    public function process()\n    {\n        if (isset($this->initialized['process'])) {\n            return;\n        }\n\n        // Initialize Grav if needed.\n        $this->setup();\n\n        $this->initialized['process'] = true;\n\n        $container = new Container(\n            [\n                'configurationProcessor' => function () {\n                    return new ConfigurationProcessor($this);\n                },\n                'loggerProcessor' => function () {\n                    return new LoggerProcessor($this);\n                },\n                'errorsProcessor' => function () {\n                    return new ErrorsProcessor($this);\n                },\n                'debuggerProcessor' => function () {\n                    return new DebuggerProcessor($this);\n                },\n                'initializeProcessor' => function () {\n                    return new InitializeProcessor($this);\n                },\n                'backupsProcessor' => function () {\n                    return new BackupsProcessor($this);\n                },\n                'pluginsProcessor' => function () {\n                    return new PluginsProcessor($this);\n                },\n                'themesProcessor' => function () {\n                    return new ThemesProcessor($this);\n                },\n                'schedulerProcessor' => function () {\n                    return new SchedulerProcessor($this);\n                },\n                'requestProcessor' => function () {\n                    return new RequestProcessor($this);\n                },\n                'tasksProcessor' => function () {\n                    return new TasksProcessor($this);\n                },\n                'assetsProcessor' => function () {\n                    return new AssetsProcessor($this);\n                },\n                'twigProcessor' => function () {\n                    return new TwigProcessor($this);\n                },\n                'pagesProcessor' => function () {\n                    return new PagesProcessor($this);\n                },\n                'debuggerAssetsProcessor' => function () {\n                    return new DebuggerAssetsProcessor($this);\n                },\n                'renderProcessor' => function () {\n                    return new RenderProcessor($this);\n                },\n            ]\n        );\n\n        $default = function (ServerRequestInterface $request) {\n            return new Response(404);\n        };\n\n        /** @var Debugger $debugger */\n        $debugger = $this['debugger'];\n\n        $collection = new RequestHandler($this->middleware, $default, $container);\n\n        $response = $collection->handle($this['request']);\n        $body = $response->getBody();\n\n        // Handle ETag and If-None-Match headers.\n        if ($response->getHeaderLine('ETag') === '1') {\n            $etag = md5($body);\n            $response = $response->withHeader('ETag', $etag);\n\n            if ($this['request']->getHeaderLine('If-None-Match') === $etag) {\n                $response = $response->withStatus(304);\n                $body = '';\n            }\n        }\n\n        $this->header($response);\n        echo $body;\n\n        $debugger->render();\n\n        register_shutdown_function([$this, 'shutdown']);\n    }\n\n    /**\n     * Set the system locale based on the language and configuration\n     */\n    public function setLocale()\n    {\n        // Initialize Locale if set and configured.\n        if ($this['language']->enabled() && $this['config']->get('system.languages.override_locale')) {\n            $language = $this['language']->getLanguage();\n            setlocale(LC_ALL, \\strlen($language) < 3 ? ($language . '_' . strtoupper($language)) : $language);\n        } elseif ($this['config']->get('system.default_locale')) {\n            setlocale(LC_ALL, $this['config']->get('system.default_locale'));\n        }\n    }\n\n    /**\n     * Redirect browser to another location.\n     *\n     * @param string $route Internal route.\n     * @param int    $code  Redirection code (30x)\n     */\n    public function redirect($route, $code = null)\n    {\n        /** @var Uri $uri */\n        $uri = $this['uri'];\n\n        // Clean route for redirect\n        $route = preg_replace(\"#^\\/[\\\\\\/]+\\/#\", '/', $route);\n\n         // Check for code in route\n        $regex = '/.*(\\[(30[1-7])\\])$/';\n        preg_match($regex, $route, $matches);\n        if ($matches) {\n            $route = str_replace($matches[1], '', $matches[0]);\n            $code = $matches[2];\n        }\n\n        if ($code === null) {\n            $code = $this['config']->get('system.pages.redirect_default_code', 302);\n        }\n\n        if (isset($this['session'])) {\n            $this['session']->close();\n        }\n\n        if ($uri->isExternal($route)) {\n            $url = $route;\n        } else {\n            $url = rtrim($uri->rootUrl(), '/') . '/';\n\n            if ($this['config']->get('system.pages.redirect_trailing_slash', true)) {\n                $url .= trim($route, '/'); // Remove trailing slash\n            } else {\n                $url .= ltrim($route, '/'); // Support trailing slash default routes\n            }\n        }\n\n        header(\"Location: {$url}\", true, $code);\n        exit();\n    }\n\n    /**\n     * Redirect browser to another location taking language into account (preferred)\n     *\n     * @param string $route Internal route.\n     * @param int    $code  Redirection code (30x)\n     */\n    public function redirectLangSafe($route, $code = null)\n    {\n        if (!$this['uri']->isExternal($route)) {\n            $this->redirect($this['pages']->route($route), $code);\n        } else {\n            $this->redirect($route, $code);\n        }\n    }\n\n    /**\n     * Set response header.\n     *\n     * @param ResponseInterface|null $response\n     */\n    public function header(ResponseInterface $response = null)\n    {\n        if (null === $response) {\n            /** @var PageInterface $page */\n            $page = $this['page'];\n            $response = new Response($page->httpResponseCode(), $page->httpHeaders(), '');\n        }\n\n        header(\"HTTP/{$response->getProtocolVersion()} {$response->getStatusCode()} {$response->getReasonPhrase()}\");\n        foreach ($response->getHeaders() as $key => $values) {\n            foreach ($values as $i => $value) {\n                header($key . ': ' . $value, $i === 0);\n            }\n        }\n    }\n\n    /**\n     * Fires an event with optional parameters.\n     *\n     * @param  string $eventName\n     * @param  Event  $event\n     *\n     * @return Event\n     */\n    public function fireEvent($eventName, Event $event = null)\n    {\n        /** @var EventDispatcher $events */\n        $events = $this['events'];\n\n        return $events->dispatch($eventName, $event);\n    }\n\n    /**\n     * Set the final content length for the page and flush the buffer\n     *\n     */\n    public function shutdown()\n    {\n        // Prevent user abort allowing onShutdown event to run without interruptions.\n        if (\\function_exists('ignore_user_abort')) {\n            @ignore_user_abort(true);\n        }\n\n        // Close the session allowing new requests to be handled.\n        if (isset($this['session'])) {\n            $this['session']->close();\n        }\n\n        if ($this['config']->get('system.debugger.shutdown.close_connection', true)) {\n            // Flush the response and close the connection to allow time consuming tasks to be performed without leaving\n            // the connection to the client open. This will make page loads to feel much faster.\n\n            // FastCGI allows us to flush all response data to the client and finish the request.\n            $success = \\function_exists('fastcgi_finish_request') ? @fastcgi_finish_request() : false;\n\n            if (!$success) {\n                // Unfortunately without FastCGI there is no way to force close the connection.\n                // We need to ask browser to close the connection for us.\n                if ($this['config']->get('system.cache.gzip')) {\n                    // Flush gzhandler buffer if gzip setting was enabled.\n                    ob_end_flush();\n\n                } else {\n                    // Without gzip we have no other choice than to prevent server from compressing the output.\n                    // This action turns off mod_deflate which would prevent us from closing the connection.\n                    if ($this['config']->get('system.cache.allow_webserver_gzip')) {\n                        header('Content-Encoding: identity');\n                    } else {\n                        header('Content-Encoding: none');\n                    }\n\n                }\n\n\n                // Get length and close the connection.\n                header('Content-Length: ' . ob_get_length());\n                header('Connection: close');\n\n                ob_end_flush();\n                @ob_flush();\n                flush();\n            }\n        }\n\n        // Run any time consuming tasks.\n        $this->fireEvent('onShutdown');\n    }\n\n    /**\n     * Magic Catch All Function\n     *\n     * Used to call closures.\n     *\n     * Source: http://stackoverflow.com/questions/419804/closures-as-class-members\n     *\n     * @param string $method\n     * @param array $args\n     * @return\n     */\n    public function __call($method, $args)\n    {\n        $closure = $this->{$method} ?? null;\n\n        return is_callable($closure) ? $closure(...$args) : null;\n    }\n\n    /**\n     * Measure how long it takes to do an action.\n     *\n     * @param string $timerId\n     * @param string $timerTitle\n     * @param callable $callback\n     * @return mixed   Returns value returned by the callable.\n     */\n    public function measureTime(string $timerId, string $timerTitle, callable $callback)\n    {\n        $debugger = $this['debugger'];\n        $debugger->startTimer($timerId, $timerTitle);\n        $result = $callback();\n        $debugger->stopTimer($timerId);\n\n        return $result;\n    }\n\n    /**\n     * Initialize and return a Grav instance\n     *\n     * @param  array $values\n     *\n     * @return static\n     */\n    protected static function load(array $values)\n    {\n        $container = new static($values);\n\n        $container['debugger'] = new Debugger();\n        $container['grav'] = function (Container $container) {\n            user_error('Calling $grav[\\'grav\\'] or {{ grav.grav }} is deprecated since Grav 1.6, just use $grav or {{ grav }}', E_USER_DEPRECATED);\n\n            return $container;\n        };\n\n        $container->measureTime('_services', 'Services', function () use ($container) {\n            $container->registerServices();\n        });\n\n        return $container;\n    }\n\n    /**\n     * Register all services\n     * Services are defined in the diMap. They can either only the class\n     * of a Service Provider or a pair of serviceKey => serviceClass that\n     * gets directly mapped into the container.\n     *\n     * @return void\n     */\n    protected function registerServices()\n    {\n        foreach (self::$diMap as $serviceKey => $serviceClass) {\n            if (\\is_int($serviceKey)) {\n                $this->register(new $serviceClass);\n            } else {\n                $this[$serviceKey] = function ($c) use ($serviceClass) {\n                    return new $serviceClass($c);\n                };\n            }\n        }\n    }\n\n    /**\n     * This attempts to find media, other files, and download them\n     *\n     * @param string $path\n     */\n    public function fallbackUrl($path)\n    {\n        $this->fireEvent('onPageFallBackUrl');\n\n        /** @var Uri $uri */\n        $uri = $this['uri'];\n\n        /** @var Config $config */\n        $config = $this['config'];\n\n        $uri_extension = strtolower($uri->extension());\n        $fallback_types = $config->get('system.media.allowed_fallback_types', null);\n        $supported_types = $config->get('media.types');\n\n        // Check whitelist first, then ensure extension is a valid media type\n        if (!empty($fallback_types) && !\\in_array($uri_extension, $fallback_types, true)) {\n            return false;\n        }\n        if (!array_key_exists($uri_extension, $supported_types)) {\n            return false;\n        }\n\n        $path_parts = pathinfo($path);\n\n        /** @var PageInterface $page */\n        $page = $this['pages']->dispatch($path_parts['dirname'], true);\n\n        if ($page) {\n            $media = $page->media()->all();\n            $parsed_url = parse_url(rawurldecode($uri->basename()));\n            $media_file = $parsed_url['path'];\n\n            // if this is a media object, try actions first\n            if (isset($media[$media_file])) {\n                /** @var Medium $medium */\n                $medium = $media[$media_file];\n                foreach ($uri->query(null, true) as $action => $params) {\n                    if (\\in_array($action, ImageMedium::$magic_actions, true)) {\n                        \\call_user_func_array([&$medium, $action], explode(',', $params));\n                    }\n                }\n                Utils::download($medium->path(), false);\n            }\n\n            // unsupported media type, try to download it...\n            if ($uri_extension) {\n                $extension = $uri_extension;\n            } else {\n                if (isset($path_parts['extension'])) {\n                    $extension = $path_parts['extension'];\n                } else {\n                    $extension = null;\n                }\n            }\n\n            if ($extension) {\n                $download = true;\n                if (\\in_array(ltrim($extension, '.'), $config->get('system.media.unsupported_inline_types', []), true)) {\n                    $download = false;\n                }\n                Utils::download($page->path() . DIRECTORY_SEPARATOR . $uri->basename(), $download);\n            }\n\n            // Nothing found\n            return false;\n        }\n\n        return $page;\n    }\n}\n"], "filenames": ["CHANGELOG.md", "system/src/Grav/Common/Grav.php"], "buggy_code_start_loc": [7, 319], "buggy_code_end_loc": [7, 320], "fixing_code_start_loc": [8, 319], "fixing_code_end_loc": [9, 323], "type": "CWE-601", "message": "Common/Grav.php in Grav before 1.7 has an Open Redirect. This is partially fixed in 1.6.23 and still present in 1.6.x.", "other": {"cve": {"id": "CVE-2020-11529", "sourceIdentifier": "cve@mitre.org", "published": "2020-04-04T19:15:11.537", "lastModified": "2021-05-17T14:30:58.110", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Common/Grav.php in Grav before 1.7 has an Open Redirect. This is partially fixed in 1.6.23 and still present in 1.6.x."}, {"lang": "es", "value": "El archivo Common/Grav.php en Grav versiones anteriores a 1.7 presenta un Redireccionamiento Abierto. Esto est\u00e1 parcialmente arreglado en la versi\u00f3n1.6.23 y sigue presente en la versi\u00f3n 1.6.x"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 5.8}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 4.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-601"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:getgrav:grav:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.6.31", "matchCriteriaId": "A790171B-E361-45F8-AEC4-A4BDA5F5BD85"}]}]}], "references": [{"url": "https://getgrav.org/#changelog", "source": "cve@mitre.org", "tags": ["Release Notes", "Vendor Advisory"]}, {"url": "https://github.com/getgrav/grav/commit/2eae104c7a4bf32bc26cb8073d5c40464bfda3f7", "source": "cve@mitre.org", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/getgrav/grav/issues/3134", "source": "cve@mitre.org", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/getgrav/grav/commit/2eae104c7a4bf32bc26cb8073d5c40464bfda3f7"}}