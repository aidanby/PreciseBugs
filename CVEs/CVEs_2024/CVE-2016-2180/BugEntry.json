{"buggy_code": ["/*\n * Copyright 2006-2016 The OpenSSL Project Authors. All Rights Reserved.\n *\n * Licensed under the OpenSSL license (the \"License\").  You may not use\n * this file except in compliance with the License.  You can obtain a copy\n * in the file LICENSE in the source distribution or at\n * https://www.openssl.org/source/license.html\n */\n\n#include <stdio.h>\n#include \"internal/cryptlib.h\"\n#include <openssl/objects.h>\n#include <openssl/bn.h>\n#include <openssl/x509.h>\n#include <openssl/x509v3.h>\n#include <openssl/ts.h>\n#include \"ts_lcl.h\"\n\nint TS_ASN1_INTEGER_print_bio(BIO *bio, const ASN1_INTEGER *num)\n{\n    BIGNUM *num_bn;\n    int result = 0;\n    char *hex;\n\n    num_bn = BN_new();\n    if (num_bn == NULL)\n        return -1;\n    ASN1_INTEGER_to_BN(num, num_bn);\n    if ((hex = BN_bn2hex(num_bn))) {\n        result = BIO_write(bio, \"0x\", 2) > 0;\n        result = result && BIO_write(bio, hex, strlen(hex)) > 0;\n        OPENSSL_free(hex);\n    }\n    BN_free(num_bn);\n\n    return result;\n}\n\nint TS_OBJ_print_bio(BIO *bio, const ASN1_OBJECT *obj)\n{\n    char obj_txt[128];\n\n    int len = OBJ_obj2txt(obj_txt, sizeof(obj_txt), obj, 0);\n    BIO_write(bio, obj_txt, len);\n    BIO_write(bio, \"\\n\", 1);\n\n    return 1;\n}\n\nint TS_ext_print_bio(BIO *bio, const STACK_OF(X509_EXTENSION) *extensions)\n{\n    int i, critical, n;\n    X509_EXTENSION *ex;\n    ASN1_OBJECT *obj;\n\n    BIO_printf(bio, \"Extensions:\\n\");\n    n = X509v3_get_ext_count(extensions);\n    for (i = 0; i < n; i++) {\n        ex = X509v3_get_ext(extensions, i);\n        obj = X509_EXTENSION_get_object(ex);\n        i2a_ASN1_OBJECT(bio, obj);\n        critical = X509_EXTENSION_get_critical(ex);\n        BIO_printf(bio, \": %s\\n\", critical ? \"critical\" : \"\");\n        if (!X509V3_EXT_print(bio, ex, 0, 4)) {\n            BIO_printf(bio, \"%4s\", \"\");\n            ASN1_STRING_print(bio, X509_EXTENSION_get_data(ex));\n        }\n        BIO_write(bio, \"\\n\", 1);\n    }\n\n    return 1;\n}\n\nint TS_X509_ALGOR_print_bio(BIO *bio, const X509_ALGOR *alg)\n{\n    int i = OBJ_obj2nid(alg->algorithm);\n    return BIO_printf(bio, \"Hash Algorithm: %s\\n\",\n                      (i == NID_undef) ? \"UNKNOWN\" : OBJ_nid2ln(i));\n}\n\nint TS_MSG_IMPRINT_print_bio(BIO *bio, TS_MSG_IMPRINT *a)\n{\n    ASN1_OCTET_STRING *msg;\n\n    TS_X509_ALGOR_print_bio(bio, a->hash_algo);\n\n    BIO_printf(bio, \"Message data:\\n\");\n    msg = a->hashed_msg;\n    BIO_dump_indent(bio, (const char *)ASN1_STRING_data(msg),\n                    ASN1_STRING_length(msg), 4);\n\n    return 1;\n}\n"], "fixing_code": ["/*\n * Copyright 2006-2016 The OpenSSL Project Authors. All Rights Reserved.\n *\n * Licensed under the OpenSSL license (the \"License\").  You may not use\n * this file except in compliance with the License.  You can obtain a copy\n * in the file LICENSE in the source distribution or at\n * https://www.openssl.org/source/license.html\n */\n\n#include <stdio.h>\n#include \"internal/cryptlib.h\"\n#include <openssl/objects.h>\n#include <openssl/bn.h>\n#include <openssl/x509.h>\n#include <openssl/x509v3.h>\n#include <openssl/ts.h>\n#include \"ts_lcl.h\"\n\nint TS_ASN1_INTEGER_print_bio(BIO *bio, const ASN1_INTEGER *num)\n{\n    BIGNUM *num_bn;\n    int result = 0;\n    char *hex;\n\n    num_bn = BN_new();\n    if (num_bn == NULL)\n        return -1;\n    ASN1_INTEGER_to_BN(num, num_bn);\n    if ((hex = BN_bn2hex(num_bn))) {\n        result = BIO_write(bio, \"0x\", 2) > 0;\n        result = result && BIO_write(bio, hex, strlen(hex)) > 0;\n        OPENSSL_free(hex);\n    }\n    BN_free(num_bn);\n\n    return result;\n}\n\nint TS_OBJ_print_bio(BIO *bio, const ASN1_OBJECT *obj)\n{\n    char obj_txt[128];\n\n    OBJ_obj2txt(obj_txt, sizeof(obj_txt), obj, 0);\n    BIO_printf(bio, \"%s\\n\", obj_txt);\n\n    return 1;\n}\n\nint TS_ext_print_bio(BIO *bio, const STACK_OF(X509_EXTENSION) *extensions)\n{\n    int i, critical, n;\n    X509_EXTENSION *ex;\n    ASN1_OBJECT *obj;\n\n    BIO_printf(bio, \"Extensions:\\n\");\n    n = X509v3_get_ext_count(extensions);\n    for (i = 0; i < n; i++) {\n        ex = X509v3_get_ext(extensions, i);\n        obj = X509_EXTENSION_get_object(ex);\n        i2a_ASN1_OBJECT(bio, obj);\n        critical = X509_EXTENSION_get_critical(ex);\n        BIO_printf(bio, \": %s\\n\", critical ? \"critical\" : \"\");\n        if (!X509V3_EXT_print(bio, ex, 0, 4)) {\n            BIO_printf(bio, \"%4s\", \"\");\n            ASN1_STRING_print(bio, X509_EXTENSION_get_data(ex));\n        }\n        BIO_write(bio, \"\\n\", 1);\n    }\n\n    return 1;\n}\n\nint TS_X509_ALGOR_print_bio(BIO *bio, const X509_ALGOR *alg)\n{\n    int i = OBJ_obj2nid(alg->algorithm);\n    return BIO_printf(bio, \"Hash Algorithm: %s\\n\",\n                      (i == NID_undef) ? \"UNKNOWN\" : OBJ_nid2ln(i));\n}\n\nint TS_MSG_IMPRINT_print_bio(BIO *bio, TS_MSG_IMPRINT *a)\n{\n    ASN1_OCTET_STRING *msg;\n\n    TS_X509_ALGOR_print_bio(bio, a->hash_algo);\n\n    BIO_printf(bio, \"Message data:\\n\");\n    msg = a->hashed_msg;\n    BIO_dump_indent(bio, (const char *)ASN1_STRING_data(msg),\n                    ASN1_STRING_length(msg), 4);\n\n    return 1;\n}\n"], "filenames": ["crypto/ts/ts_lib.c"], "buggy_code_start_loc": [43], "buggy_code_end_loc": [46], "fixing_code_start_loc": [43], "fixing_code_end_loc": [45], "type": "CWE-125", "message": "The TS_OBJ_print_bio function in crypto/ts/ts_lib.c in the X.509 Public Key Infrastructure Time-Stamp Protocol (TSP) implementation in OpenSSL through 1.0.2h allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted time-stamp file that is mishandled by the \"openssl ts\" command.", "other": {"cve": {"id": "CVE-2016-2180", "sourceIdentifier": "secalert@redhat.com", "published": "2016-08-01T02:59:11.120", "lastModified": "2022-12-13T12:15:22.070", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "The TS_OBJ_print_bio function in crypto/ts/ts_lib.c in the X.509 Public Key Infrastructure Time-Stamp Protocol (TSP) implementation in OpenSSL through 1.0.2h allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted time-stamp file that is mishandled by the \"openssl ts\" command."}, {"lang": "es", "value": "La funci\u00f3n TS_OBJ_print_bio en crypto/ts/ts_lib.c en la implementaci\u00f3n X.509 Public Key Infrastructure Time-Stamp Protocol (TSP) en OpenSSL hasta la versi\u00f3n 1.0.2h permite a atacantes remotos provocar una denegaci\u00f3n de servicio (lectura fuera de rango y ca\u00edda de la aplicaci\u00f3n) a trav\u00e9s de un archivo time-stamp manipulado que es manejado incorrectamente por el comando \"openssl ts\"."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "PARTIAL", "baseScore": 5.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 10.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-125"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "2D1C00C0-C77E-4255-9ECA-20F2673C7366"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1a:*:*:*:*:*:*:*", "matchCriteriaId": "3A66E6CF-39CF-412E-8EF0-8E10BA21B4A4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1b:*:*:*:*:*:*:*", "matchCriteriaId": "C684FB18-FDDC-4BED-A28C-C23EE6CD0094"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1c:*:*:*:*:*:*:*", "matchCriteriaId": "A74A79A7-4FAF-4C81-8622-050008B96AE1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1d:*:*:*:*:*:*:*", "matchCriteriaId": "CEDACCB9-8D61-49EE-9957-9E58BC7BB031"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1e:*:*:*:*:*:*:*", "matchCriteriaId": "4993DD56-F9E3-4AC8-AC3E-BF204B950DEC"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1f:*:*:*:*:*:*:*", "matchCriteriaId": "E884B241-F9C3-44F8-A420-DE65F5F3D660"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1g:*:*:*:*:*:*:*", "matchCriteriaId": "3A383620-B4F7-44A7-85DA-A4FF2E115D80"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1h:*:*:*:*:*:*:*", "matchCriteriaId": "5F0C6812-F455-49CF-B29B-9AC00306DA43"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1i:*:*:*:*:*:*:*", "matchCriteriaId": "3F2D462C-A1B4-4572-A615-BDE9DC5F1E55"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1j:*:*:*:*:*:*:*", "matchCriteriaId": "3703E445-17C0-4C85-A496-A35641C0C8DB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1k:*:*:*:*:*:*:*", "matchCriteriaId": "2F4034B9-EF1C-40E6-B92A-D4D7B7E7E774"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1l:*:*:*:*:*:*:*", "matchCriteriaId": "ABEC1927-F469-4B9E-B544-DA6CF90F0B34"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1m:*:*:*:*:*:*:*", "matchCriteriaId": "DE2188F9-FAF8-4A0C-BB49-E95BDBC119BF"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1n:*:*:*:*:*:*:*", "matchCriteriaId": "A9EC827B-5313-47D7-BF49-CFF033CF3D53"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1o:*:*:*:*:*:*:*", "matchCriteriaId": "A438E65F-33B1-46BC-AD93-200DCC6B43D4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1p:*:*:*:*:*:*:*", "matchCriteriaId": "4BFDCF78-62C1-429E-A43C-0C9FEC14837D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1q:*:*:*:*:*:*:*", "matchCriteriaId": "6A0B4DEF-C6E8-4243-9893-6E650013600C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1r:*:*:*:*:*:*:*", "matchCriteriaId": "E28CD4F7-522F-4ECA-9035-228596CDE769"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1s:*:*:*:*:*:*:*", "matchCriteriaId": "A491B32F-31F0-4151-AE9B-313CBF2C060D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.1t:*:*:*:*:*:*:*", "matchCriteriaId": "0AF4953B-BB23-4C80-8C48-9E94EB234AAE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "AD3E5C1B-EC63-4214-A0BD-0B8681CE6C8B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.2a:*:*:*:*:*:*:*", "matchCriteriaId": "60F946FD-F564-49DA-B043-5943308BA9EE"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.2b:*:*:*:*:*:*:*", "matchCriteriaId": "4847BCF3-EFCE-41AF-8E7D-3D51EB9DCC5B"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.2c:*:*:*:*:*:*:*", "matchCriteriaId": "9B89180B-FB68-4DD8-B076-16E51CC7FB91"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.2d:*:*:*:*:*:*:*", "matchCriteriaId": "4C986592-4086-4A39-9767-EF34DBAA6A53"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.2e:*:*:*:*:*:*:*", "matchCriteriaId": "7B23181C-03DB-4E92-B3F6-6B585B5231B4"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.2f:*:*:*:*:*:*:*", "matchCriteriaId": "94D9EC1C-4843-4026-9B05-E060E9391734"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.2g:*:*:*:*:*:*:*", "matchCriteriaId": "B066401C-21CF-4BE9-9C55-C9F1E0C7BE3F"}, {"vulnerable": true, "criteria": "cpe:2.3:a:openssl:openssl:1.0.2h:*:*:*:*:*:*:*", "matchCriteriaId": "036FB24F-7D86-4730-8BC9-722875BEC807"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:oracle:linux:6:*:*:*:*:*:*:*", "matchCriteriaId": "CC7A498A-A669-4C42-8134-86103C799D13"}, {"vulnerable": true, "criteria": "cpe:2.3:o:oracle:linux:7:*:*:*:*:*:*:*", "matchCriteriaId": "104DA87B-DEE4-4262-AE50-8E6BC43B228B"}]}]}], "references": [{"url": "http://kb.juniper.net/InfoCenter/index?page=content&id=JSA10759", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://rhn.redhat.com/errata/RHSA-2016-1940.html", "source": "secalert@redhat.com"}, {"url": "http://www-01.ibm.com/support/docview.wss?uid=swg21995039", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://www.oracle.com/technetwork/security-advisory/cpuapr2018-3678067.html", "source": "secalert@redhat.com"}, {"url": "http://www.oracle.com/technetwork/security-advisory/cpujan2018-3236628.html", "source": "secalert@redhat.com"}, {"url": "http://www.oracle.com/technetwork/security-advisory/cpujul2017-3236622.html", "source": "secalert@redhat.com"}, {"url": "http://www.oracle.com/technetwork/security-advisory/cpuoct2016-2881722.html", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html", "source": "secalert@redhat.com"}, {"url": "http://www.oracle.com/technetwork/topics/security/linuxbulletinoct2016-3090545.html", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://www.oracle.com/technetwork/topics/security/ovmbulletinoct2016-3090547.html", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://www.securityfocus.com/bid/92117", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://www.securitytracker.com/id/1036486", "source": "secalert@redhat.com"}, {"url": "http://www.splunk.com/view/SP-CAAAPSV", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "http://www.splunk.com/view/SP-CAAAPUE", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "https://bto.bluecoat.com/security-advisory/sa132", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1359615", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Patch"]}, {"url": "https://cert-portal.siemens.com/productcert/pdf/ssa-412672.pdf", "source": "secalert@redhat.com"}, {"url": "https://github.com/openssl/openssl/commit/0ed26acce328ec16a3aa635f1ca37365e8c7403a", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://kb.pulsesecure.net/articles/Pulse_Security_Advisories/SA40312", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "https://security.FreeBSD.org/advisories/FreeBSD-SA-16:26.openssl.asc", "source": "secalert@redhat.com"}, {"url": "https://security.gentoo.org/glsa/201612-16", "source": "secalert@redhat.com", "tags": ["Patch", "Third Party Advisory", "VDB Entry"]}, {"url": "https://support.hpe.com/hpsc/doc/public/display?docLocale=en_US&docId=emr_na-hpesbhf03856en_us", "source": "secalert@redhat.com"}, {"url": "https://www.tenable.com/security/tns-2016-16", "source": "secalert@redhat.com", "tags": ["Third Party Advisory"]}, {"url": "https://www.tenable.com/security/tns-2016-20", "source": "secalert@redhat.com"}, {"url": "https://www.tenable.com/security/tns-2016-21", "source": "secalert@redhat.com"}]}, "github_commit_url": "https://github.com/openssl/openssl/commit/0ed26acce328ec16a3aa635f1ca37365e8c7403a"}}