{"buggy_code": ["<beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:sec=\"http://www.springframework.org/schema/security\"\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:osgi=\"http://www.springframework.org/schema/osgi\"\n  xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans.xsd\n       http://www.springframework.org/schema/osgi\n       http://www.springframework.org/schema/osgi/spring-osgi.xsd\n       http://www.springframework.org/schema/security\n       http://www.springframework.org/schema/security/spring-security-3.1.xsd\">\n\n  <!-- ######################################## -->\n  <!-- # Open and unsecured url patterns      # -->\n  <!-- ######################################## -->\n\n  <sec:http pattern=\"/admin/img/**\" security=\"none\" />\n  <sec:http pattern=\"/favicon.ico\" security=\"none\" />\n  <sec:http pattern=\"/img/**\" security=\"none\" />\n  <sec:http pattern=\"/js/**\" security=\"none\" />\n  <sec:http pattern=\"/lib/**\" security=\"none\" />\n  <sec:http pattern=\"/admin-ng/fonts/**\" security=\"none\" />\n  <sec:http pattern=\"/admin-ng/scripts/**\" security=\"none\" />\n  <sec:http pattern=\"/admin-ng/styles/**\" security=\"none\" />\n  <sec:http pattern=\"/play/*\" security=\"none\" />\n\n  <sec:http create-session=\"ifRequired\" servlet-api-provision=\"true\" realm=\"Opencast\"\n    entry-point-ref=\"opencastEntryPoint\">\n\n    <!-- ################ -->\n    <!-- # URL SECURITY # -->\n    <!-- ################ -->\n\n    <!-- Allow anonymous access to the login form -->\n    <sec:intercept-url pattern=\"/admin-ng/login.html\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/sysinfo/bundles/version\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Protect admin UI facade -->\n    <sec:intercept-url pattern=\"/workflow/definitions.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/acl/acls.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_ACLS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/acl/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_ACLS_VIEW\" />\n    <sec:intercept-url pattern=\"/acl-manager/acl/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_ACLS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/capture-agents/agents.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_LOCATIONS_VIEW, ROLE_UI_EVENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/capture-agents/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_LOCATIONS_DETAILS_CAPABILITIES_VIEW, ROLE_UI_LOCATIONS_DETAILS_CONFIGURATION_VIEW, ROLE_UI_LOCATIONS_DETAILS_GENERAL_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/asset/assets.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/asset/attachment/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/asset/catalog/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/asset/media/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/asset/publication/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/catalogAdapters\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_METADATA_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/events.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/workflowProperties\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_CREATE, ROLE_UI_TASKS_CREATE, ROLE_UI_EVENTS_EDITOR_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/new/metadata\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_METADATA_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/new/processing\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_CREATE, ROLE_UI_TASKS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/attachments.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ATTACHMENTS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comments\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/publications.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_PUBLICATIONS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/hasActiveTransaction\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/hasSnapshots.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/media.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_MEDIA_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/media/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_MEDIA_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/metadata.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_METADATA_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/scheduling.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_SCHEDULING_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/operations.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/operations/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/errors.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/errors/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/access.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ACL_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/groups/groups.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_GROUPS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/groups/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_GROUPS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/job/jobs.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_JOBS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/series.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/new/metadata\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_METADATA_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/new/themes\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_THEMES_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/access.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_ACL_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/metadata.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_METADATA_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/theme.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_THEMES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/server/servers.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERVERS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/services/services.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERVICES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/tasks/processing.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_TASKS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/themes/themes.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/themes/*/usage.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_DETAILS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/themes/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_DETAILS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/tools/*/editor.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_EDITOR_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/tools/*/thumbnail.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_EDITOR_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/tools/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_EDITOR_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/users/users.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_USERS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/users/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_USERS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/user-settings/signature\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/events/filters.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/series/filters.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/themes/filters.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/recordings/filters.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_LOCATIONS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/users/filters.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_USERS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/groups/filters.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_GROUPS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/components.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/providers.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/THEMES.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n    <sec:intercept-url pattern=\"/assets/assets/**\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_VIEW\" />\n\n    <sec:intercept-url pattern=\"/admin-ng/acl/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_ACLS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/metadata\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_METADATA_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/scheduling\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_SCHEDULING_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/action/stop\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/action/retry\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/action/none\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_EDIT\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/bulk/update\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_SCHEDULING_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/groups/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_GROUPS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/metadata\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_METADATA_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/theme\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_THEMES_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/themes/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/users/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_USERS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/user-settings/signature/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n\n    <sec:intercept-url pattern=\"/services/maintenance\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_SERVERS_MAINTENANCE_EDIT\" />\n    <sec:intercept-url pattern=\"/services/sanitize\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_SERVICES_STATUS_EDIT\" />\n    <sec:intercept-url pattern=\"/staticfiles\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_CREATE, ROLE_UI_THEMES_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/acl\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_ACLS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/bulk/conflicts\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_SCHEDULING_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/deleteEvents\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/new\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/new/conflicts\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/scheduling.json\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_SCHEDULING_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/access\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ACL_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/assets\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*/reply\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/groups\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_GROUPS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/index/*\" method=\"POST\" access=\"ROLE_ADMIN\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/deleteSeries\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/new\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/access\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_ACL_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/tasks/new\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_TASKS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/themes\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/tools/*/editor.json\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_EDITOR_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/tools/*/thumbnail.json\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_EDITOR_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/users\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_USERS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/user-settings/signature\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n\n    <sec:intercept-url pattern=\"/admin-ng/acl/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_ACLS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/capture-agents/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_LOCATIONS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/groups/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_GROUPS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/theme\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_THEMES_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/themes/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/users/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_USERS_DELETE\" />\n\n    <!-- Securing the URLs for the external API interface -->\n    <!-- External API GET Endpoints -->\n    <sec:intercept-url pattern=\"/api\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API\"/>\n    <sec:intercept-url pattern=\"/api/agents\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_CAPTURE_AGENTS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/agents/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_CAPTURE_AGENTS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/acl\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_ACL_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/media\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_MEDIA_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/media/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_MEDIA_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/metadata\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_METADATA_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/metadata/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_METADATA_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/publications\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_PUBLICATIONS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/publications/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_PUBLICATIONS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/scheduling\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_SCHEDULING_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/groups\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/groups/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/info/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API\" />\n    <sec:intercept-url pattern=\"/api/info/me/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API\" />\n    <sec:intercept-url pattern=\"/api/series\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_SERIES_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/series/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_SERIES_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/series/*/acl\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_SERIES_ACL_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/series/*/metadata\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_SERIES_METADATA_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/series/*/metadata/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_SERIES_METADATA_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/series/*/properties\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_SERIES_PROPERTIES_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/version\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API\"/>\n    <sec:intercept-url pattern=\"/api/version/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API\"/>\n    <sec:intercept-url pattern=\"/api/workflows\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_INSTANCE_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/workflows/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_INSTANCE_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/workflow-definitions\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_DEFINITION_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/workflow-definitions/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_DEFINITION_VIEW\"/>\n    <!-- External API PUT Endpoints -->\n    <sec:intercept-url pattern=\"/api/events/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/events/*/acl\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_ACL_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/events/*/metadata\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_METADATA_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/events/*/metadata/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_METADATA_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/events/*/scheduling\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_SCHEDULING_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/groups/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/series/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_SERIES_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/series/*/acl\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_SERIES_ACL_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/series/*/metadata\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_SERIES_METADATA_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/series/*/metadata/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_SERIES_METADATA_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/series/*/properties\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_SERIES_PROPERTIES_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/workflows/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_INSTANCE_EDIT\"/>\n    <!-- External API POST Endpoints -->\n    <sec:intercept-url pattern=\"/api/events\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_CREATE\"/>\n    <sec:intercept-url pattern=\"/api/events/*\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/events/*/acl/*\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_ACL_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/groups\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_CREATE\"/>\n    <sec:intercept-url pattern=\"/api/groups/*/members/*\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/clearIndex\" method=\"POST\" access=\"ROLE_ADMIN\"/>\n    <sec:intercept-url pattern=\"/api/recreateIndex\" method=\"POST\" access=\"ROLE_ADMIN\"/>\n    <sec:intercept-url pattern=\"/api/recreateIndex/*\" method=\"POST\" access=\"ROLE_ADMIN\"/>\n    <sec:intercept-url pattern=\"/api/series\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_SERIES_CREATE\"/>\n    <sec:intercept-url pattern=\"/api/security/sign\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_SECURITY_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/workflows\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_INSTANCE_CREATE\"/>\n    <!-- External API DELETE Endpoints -->\n    <sec:intercept-url pattern=\"/api/events/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/events/*/acl/*/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_ACL_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/events/*/metadata\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_METADATA_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/events/*/metadata/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_METADATA_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/groups/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/groups/*/members/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/series/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_SERIES_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/series/*/metadata\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_SERIES_METADATA_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/series/*/metadata/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_SERIES_METADATA_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/workflows/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_INSTANCE_DELETE\"/>\n\n    <sec:intercept-url pattern=\"/admin-ng/css/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/admin-ng/lib/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/admin-ng/img/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/admin-ng/js/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/admin-ng/modules/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/admin-ng/shared/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/admin-ng/app.js\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Enable anonymous access to the admin ui -->\n    <sec:intercept-url pattern=\"/admin-ng/public/**\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Enable anonymous access to the /info/me.json resource -->\n    <sec:intercept-url pattern=\"/info/me.json\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/i18n/languages.json\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/info/components.json\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- anonymous access to user interface configuration -->\n    <sec:intercept-url pattern=\"/ui/config/**\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Paella player -->\n    <sec:intercept-url pattern=\"/paella/ui/auth.html\" access=\"ROLE_USER\" />\n    <sec:intercept-url pattern=\"/paella/ui/**\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Enable anonymous access to the engage player and the GET endpoints it requires -->\n    <sec:intercept-url pattern=\"/engage/ui/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/engage/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/engage-player/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/search/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/usertracking/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/usertracking/**\" method=\"PUT\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/static/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/export/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Enable anonymous access to the annotation and the series endpoints -->\n    <sec:intercept-url pattern=\"/series/**\" method=\"GET\" access=\"ROLE_ANONYMOUS, ROLE_CAPTURE_AGENT\" />\n    <sec:intercept-url pattern=\"/annotation/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/annotation/**\" method=\"PUT\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Enable anonymous access to the OAI-PMH repository              -->\n    <!-- The OAI-PMH specification demands boths GET and POST requests  -->\n    <!-- Please make sure that the path configured here matches         -->\n    <!-- the path configured for the repository servlet.                -->\n    <sec:intercept-url pattern=\"/oaipmh/**\" method=\"GET\" access=\"ROLE_ADMIN\"/>\n    <sec:intercept-url pattern=\"/oaipmh/**\" method=\"POST\" access=\"ROLE_ADMIN\"/>\n\n    <!-- Enable anonymous access to the rss and atom feeds -->\n    <sec:intercept-url pattern=\"/feeds/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Secure the system management URLs for admins only -->\n    <sec:intercept-url pattern=\"/services/available.*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_CAPTURE_AGENT\" />\n    <sec:intercept-url pattern=\"/services/**\" access=\"ROLE_ADMIN\"/>\n    <sec:intercept-url pattern=\"/signing/**\" access=\"ROLE_ADMIN\" />\n    <sec:intercept-url pattern=\"/system/**\" access=\"ROLE_ADMIN\" />\n    <sec:intercept-url pattern=\"/config/**\" access=\"ROLE_ADMIN\" />\n\n    <!-- Enable capture agent updates and ingest -->\n    <sec:intercept-url pattern=\"/capture-admin/**\" access=\"ROLE_ADMIN, ROLE_CAPTURE_AGENT\" />\n    <sec:intercept-url pattern=\"/recordings/**\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_CAPTURE_AGENT\" />\n    <sec:intercept-url pattern=\"/ingest/**\" access=\"ROLE_ADMIN, ROLE_CAPTURE_AGENT\" />\n\n    <!-- Secure the user management URLs for admins only -->\n    <sec:intercept-url pattern=\"/users/**\" access=\"ROLE_ADMIN\" />\n    <sec:intercept-url pattern=\"/admin/users.html\" access=\"ROLE_ADMIN\" />\n\n    <!-- Enable 2-legged OAuth access (\"signed fetch\") to the LTI launch servlet -->\n    <sec:intercept-url pattern=\"/lti\" access=\"ROLE_OAUTH_USER\" />\n\n    <!-- Enable access to the LTI tools -->\n    <sec:intercept-url pattern=\"/ltitools/**\" access=\"ROLE_OAUTH_USER\" />\n\n    <sec:intercept-url pattern=\"/transcripts/watson/results*\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/transcripts/watson/results*\" method=\"POST\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Everything else is for the admin users -->\n    <sec:intercept-url pattern=\"/admin-ng\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI, ROLE_COURSE_ADMIN\" />\n    <sec:intercept-url pattern=\"/admin-ng/\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI, ROLE_COURSE_ADMIN\" />\n    <sec:intercept-url pattern=\"/admin-ng/index.html\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI, ROLE_COURSE_ADMIN\" />\n    <sec:intercept-url pattern=\"/index.html\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI, ROLE_COURSE_ADMIN\" />\n    <sec:intercept-url pattern=\"/**\" access=\"ROLE_ADMIN, ROLE_COURSE_ADMIN\" />\n\n    <!-- ############################# -->\n    <!-- # LOGIN / LOGOUT MECHANISMS # -->\n    <!-- ############################# -->\n\n    <!-- Uncomment to enable x509 client certificates for identifying clients -->\n    <!-- sec:x509 subject-principal-regex=\"CN=(.*?),\" user-service-ref=\"userDetailsService\" / -->\n\n    <!-- Enable and configure the failure URL for form-based logins -->\n    <sec:form-login authentication-failure-url=\"/admin-ng/login.html?error\" authentication-success-handler-ref=\"authSuccessHandler\" />\n\n    <!-- Authentication filter chain -->\n    <sec:custom-filter position=\"BASIC_AUTH_FILTER\" ref=\"authenticationFilters\" />\n\n    <sec:custom-filter ref=\"asyncTimeoutRedirectFilter\" after=\"EXCEPTION_TRANSLATION_FILTER\"/>\n\n    <!-- Opencast is shipping its own implementation of the anonymous filter -->\n    <sec:custom-filter ref=\"anonymousFilter\" position=\"ANONYMOUS_FILTER\" />\n\n    <!-- Shibboleth header authentication filter\n    <sec:custom-filter ref=\"shibbolethHeaderFilter\" position=\"PRE_AUTH_FILTER\"/>\n    -->\n\n    <!-- Enables \"remember me\" functionality -->\n    <sec:remember-me services-ref=\"rememberMeServices\" />\n\n    <!-- Set the request cache -->\n    <sec:request-cache ref=\"requestCache\" />\n\n    <!-- If any URLs are to be exposed to anonymous users, the \"sec:anonymous\" filter must be present -->\n    <sec:anonymous enabled=\"false\" />\n\n    <!-- Enables log out -->\n    <sec:logout success-handler-ref=\"logoutSuccessHandler\" />\n\n    <!-- Shibboleth log out\n         Please specifiy the URL to return to after logging out\n    <sec:logout logout-success-url=\"/Shibboleth.sso/Logout?return=http://www.opencast.org\" />\n    -->\n\n  </sec:http>\n\n  <bean id=\"rememberMeServices\" class=\"org.opencastproject.kernel.security.SystemTokenBasedRememberMeService\">\n    <property name=\"userDetailsService\" ref=\"userDetailsService\"/>\n    <!-- All following settings are optional -->\n    <property name=\"tokenValiditySeconds\" value=\"1209600\"/>\n    <property name=\"cookieName\" value=\"oc-remember-me\"/>\n    <!-- The following key will be augmented by system properties. Thus, leaving this untouched is okay -->\n    <property name=\"key\" value=\"opencast\"/>\n  </bean>\n\n  <!-- ############################# -->\n  <!-- # Authentication Filters    # -->\n  <!-- ############################# -->\n\n  <bean id=\"authenticationFilters\" class=\"org.springframework.web.filter.CompositeFilter\">\n    <property name=\"filters\">\n      <list>\n        <!-- Digest auth is used by capture agents and is used to enable transparent clustering of services -->\n        <!-- ATTENTION! Do not deactivate the digest filter, otherwise the distributed setup would not work -->\n        <ref bean=\"digestFilter\" />\n\n        <!-- Basic authentication  -->\n        <ref bean=\"basicAuthenticationFilter\" />\n\n        <!-- 2-legged OAuth is used by trusted 3rd party applications, including LTI. -->\n        <!-- Uncomment the line below to support LTI or other OAuth clients.          -->\n        <!-- <ref bean=\"oauthProtectedResourceFilter\" /> -->\n      </list>\n    </property>\n  </bean>\n\n  <!-- ########################################### -->\n  <!-- # Custom ajax timeout Filter Definition   # -->\n  <!-- ########################################### -->\n\n  <bean id=\"asyncTimeoutRedirectFilter\" class=\"org.opencastproject.kernel.security.AsyncTimeoutRedirectFilter\" />\n\n  <!-- ######################################## -->\n  <!-- # Custom Anonymous Filter Definition   # -->\n  <!-- ######################################## -->\n\n  <bean id=\"anonymousFilter\" class=\"org.opencastproject.kernel.security.TrustedAnonymousAuthenticationFilter\">\n    <property name=\"userAttribute\" ref=\"anonymousUserAttributes\" />\n    <property name=\"key\" value=\"anonymousKey\" />\n  </bean>\n\n  <bean id=\"anonymousUserAttributes\" class=\"org.springframework.security.core.userdetails.memory.UserAttribute\">\n    <property name=\"authoritiesAsString\" value=\"ROLE_ANONYMOUS\"/>\n    <property name=\"password\" value=\"empty\"/>\n  </bean>\n\n  <!-- ######################################## -->\n  <!-- # Authentication Entry and Exit Points # -->\n  <!-- ######################################## -->\n\n  <!-- Differentiates between \"normal\" user requests and those requesting digest auth -->\n  <bean id=\"opencastEntryPoint\" class=\"org.opencastproject.kernel.security.DelegatingAuthenticationEntryPoint\">\n    <property name=\"userEntryPoint\" ref=\"userEntryPoint\" />\n    <property name=\"digestAuthenticationEntryPoint\" ref=\"digestEntryPoint\" />\n  </bean>\n\n  <!-- Redirects unauthenticated requests to the login form -->\n  <bean id=\"userEntryPoint\" class=\"org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint\">\n    <property name=\"loginFormUrl\" value=\"/admin-ng/login.html\" />\n  </bean>\n\n  <!-- Returns a 401 request for authentication via digest auth -->\n  <bean id=\"digestEntryPoint\" class=\"org.springframework.security.web.authentication.www.DigestAuthenticationEntryPoint\">\n    <property name=\"realmName\" value=\"Opencast\" />\n    <property name=\"key\" value=\"opencast\" />\n    <property name=\"nonceValiditySeconds\" value=\"300\" />\n  </bean>\n\n  <bean id=\"basicEntryPoint\" class=\"org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint\">\n    <property name=\"realmName\" value=\"Opencast\"/>\n  </bean>\n\n  <bean id=\"authSuccessHandler\" class=\"org.opencastproject.kernel.security.AuthenticationSuccessHandler\">\n    <property name=\"securityService\" ref=\"securityService\" />\n    <property name=\"welcomePages\">\n      <map>\n        <entry key=\"ROLE_ADMIN\" value=\"/admin-ng/index.html\" />\n        <entry key=\"ROLE_ADMIN_UI\" value=\"/admin-ng/index.html\" />\n        <entry key=\"*\" value=\"/engage/ui/index.html\" /> <!-- Any role not listed explicitly will redirect here -->\n      </map>\n    </property>\n  </bean>\n\n  <bean id=\"logoutSuccessHandler\" class=\"org.opencastproject.kernel.security.LogoutSuccessHandler\">\n    <property name=\"userDirectoryService\" ref=\"userDirectoryService\" />\n  </bean>\n\n  <!-- ################# -->\n  <!-- # Digest Filter # -->\n  <!-- ################# -->\n\n  <!-- Handles the details of the digest authentication dance -->\n  <bean id=\"digestFilter\" class=\"org.springframework.security.web.authentication.www.DigestAuthenticationFilter\">\n    <!--  Use only the in-memory users, as these have passwords that are not hashed -->\n    <property name=\"userDetailsService\" ref=\"userDetailsService\" />\n    <property name=\"authenticationEntryPoint\" ref=\"digestEntryPoint\" />\n    <property name=\"createAuthenticatedToken\" value=\"true\" />\n    <property name=\"userCache\">\n      <bean class=\"org.springframework.security.core.userdetails.cache.NullUserCache\" />\n    </property>\n  </bean>\n\n  <!-- ############################### -->\n  <!-- # Basic Authentication Filter # -->\n  <!-- ############################### -->\n\n  <!-- Handles the details of the basic authentication dance -->\n  <bean id=\"basicAuthenticationFilter\" class=\"org.springframework.security.web.authentication.www.BasicAuthenticationFilter\">\n    <property name=\"authenticationManager\" ref=\"authenticationManager\"/>\n    <property name=\"authenticationEntryPoint\" ref=\"basicEntryPoint\"/>\n  </bean>\n\n  <!-- ####################### -->\n  <!-- # OAuth (LTI) Support # -->\n  <!-- ####################### -->\n\n  <bean name=\"oauthProtectedResourceFilter\" class=\"org.opencastproject.kernel.security.LtiProcessingFilter\">\n    <property name=\"consumerDetailsService\" ref=\"oAuthConsumerDetailsService\" />\n    <property name=\"tokenServices\">\n      <bean class=\"org.springframework.security.oauth.provider.token.InMemoryProviderTokenServices\" />\n    </property>\n    <property name=\"nonceServices\">\n      <bean class=\"org.springframework.security.oauth.provider.nonce.InMemoryNonceServices\" />\n    </property>\n    <property name=\"authHandler\" ref=\"ltiLaunchAuthenticationHandler\" />\n  </bean>\n\n  <!-- ###################### -->\n  <!-- # Shibboleth Support # -->\n  <!-- ###################### -->\n\n  <!-- General Shibboleth header extration filter\n  <bean id=\"shibbolethHeaderFilter\"\n        class=\"org.opencastproject.security.shibboleth.ShibbolethRequestHeaderAuthenticationFilter\">\n    <property name=\"principalRequestHeader\" value=\"<this need to be configured>\"/>\n    <property name=\"authenticationManager\" ref=\"authenticationManager\" />\n    <property name=\"userDetailsService\" ref=\"userDetailsService\" />\n    <property name=\"userDirectoryService\" ref=\"userDirectoryService\" />\n    <property name=\"shibbolethLoginHandler\" ref=\"aaiLoginHandler\" />\n    <property name=\"exceptionIfHeaderMissing\" value=\"false\" />\n  </bean>\n  -->\n\n  <!-- AAI header extractor and user generator\n  <bean id=\"aaiLoginHandler\" class=\"org.opencastproject.security.aai.ConfigurableLoginHandler\">\n    <property name=\"securityService\" ref=\"securityService\" />\n    <property name=\"userReferenceProvider\" ref=\"userReferenceProvider\" />\n  </bean>\n  -->\n\n  <!--\n  <bean id=\"preauthAuthProvider\"\n        class=\"org.springframework.security.web.authentication.preauth.PreAuthenticatedAuthenticationProvider\">\n    <property name=\"preAuthenticatedUserDetailsService\">\n      <bean id=\"userDetailsServiceWrapper\" class=\"org.springframework.security.core.userdetails.UserDetailsByNameServiceWrapper\">\n        <property name=\"userDetailsService\" ref=\"userDetailsService\"/>\n      </bean>\n    </property>\n  </bean>\n  -->\n\n  <!-- #################### -->\n  <!-- # OSGI Integration # -->\n  <!-- #################### -->\n\n  <!-- Obtain services from the OSGI service registry -->\n  <osgi:reference id=\"userDetailsService\" cardinality=\"1..1\"\n                  interface=\"org.springframework.security.core.userdetails.UserDetailsService\" />\n\n  <osgi:reference id=\"securityService\" cardinality=\"1..1\"\n                  interface=\"org.opencastproject.security.api.SecurityService\" />\n\n  <!-- Uncomment to enable external users e.g. used together shibboleth -->\n  <!-- <osgi:reference id=\"userReferenceProvider\" cardinality=\"1..1\"\n                  interface=\"org.opencastproject.userdirectory.api.UserReferenceProvider\"  /> -->\n\n  <osgi:reference id=\"userDirectoryService\" cardinality=\"1..1\"\n                  interface=\"org.opencastproject.security.api.UserDirectoryService\" />\n\n  <osgi:reference id=\"oAuthConsumerDetailsService\" cardinality=\"1..1\"\n                  interface=\"org.springframework.security.oauth.provider.ConsumerDetailsService\" />\n\n  <osgi:reference id=\"ltiLaunchAuthenticationHandler\" cardinality=\"1..1\"\n                  interface=\"org.springframework.security.oauth.provider.OAuthAuthenticationHandler\" />\n\n  <!-- ############################# -->\n  <!-- # Spring Security Internals # -->\n  <!-- ############################# -->\n\n  <!-- The JPA user directory stores md5 hashed, salted passwords, so we must use a username-salted md5 password encoder. -->\n  <sec:authentication-manager alias=\"authenticationManager\">\n    <!-- Uncomment this if using Shibboleth authentication -->\n    <!--sec:authentication-provider ref=\"preauthAuthProvider\" /-->\n    <sec:authentication-provider user-service-ref=\"userDetailsService\">\n      <sec:password-encoder hash=\"md5\"><sec:salt-source user-property=\"username\" /></sec:password-encoder>\n    </sec:authentication-provider>\n  </sec:authentication-manager>\n\n  <!-- Do not use a request cache -->\n  <bean id=\"requestCache\" class=\"org.springframework.security.web.savedrequest.NullRequestCache\" />\n\n</beans>\n"], "fixing_code": ["<beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:sec=\"http://www.springframework.org/schema/security\"\n  xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:osgi=\"http://www.springframework.org/schema/osgi\"\n  xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n       http://www.springframework.org/schema/beans/spring-beans.xsd\n       http://www.springframework.org/schema/osgi\n       http://www.springframework.org/schema/osgi/spring-osgi.xsd\n       http://www.springframework.org/schema/security\n       http://www.springframework.org/schema/security/spring-security-3.1.xsd\">\n\n  <!-- ######################################## -->\n  <!-- # Open and unsecured url patterns      # -->\n  <!-- ######################################## -->\n\n  <sec:http pattern=\"/admin/img/**\" security=\"none\" />\n  <sec:http pattern=\"/favicon.ico\" security=\"none\" />\n  <sec:http pattern=\"/img/**\" security=\"none\" />\n  <sec:http pattern=\"/js/**\" security=\"none\" />\n  <sec:http pattern=\"/lib/**\" security=\"none\" />\n  <sec:http pattern=\"/admin-ng/fonts/**\" security=\"none\" />\n  <sec:http pattern=\"/admin-ng/scripts/**\" security=\"none\" />\n  <sec:http pattern=\"/admin-ng/styles/**\" security=\"none\" />\n  <sec:http pattern=\"/play/*\" security=\"none\" />\n\n  <sec:http create-session=\"ifRequired\" servlet-api-provision=\"true\" realm=\"Opencast\"\n    entry-point-ref=\"opencastEntryPoint\">\n\n    <!-- ################ -->\n    <!-- # URL SECURITY # -->\n    <!-- ################ -->\n\n    <!-- Allow anonymous access to the login form -->\n    <sec:intercept-url pattern=\"/admin-ng/login.html\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/sysinfo/bundles/version\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Protect admin UI facade -->\n    <sec:intercept-url pattern=\"/workflow/definitions.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/acl/acls.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_ACLS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/acl/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_ACLS_VIEW\" />\n    <sec:intercept-url pattern=\"/acl-manager/acl/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_ACLS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/capture-agents/agents.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_LOCATIONS_VIEW, ROLE_UI_EVENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/capture-agents/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_LOCATIONS_DETAILS_CAPABILITIES_VIEW, ROLE_UI_LOCATIONS_DETAILS_CONFIGURATION_VIEW, ROLE_UI_LOCATIONS_DETAILS_GENERAL_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/asset/assets.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/asset/attachment/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/asset/catalog/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/asset/media/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/asset/publication/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/catalogAdapters\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_METADATA_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/events.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/workflowProperties\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_CREATE, ROLE_UI_TASKS_CREATE, ROLE_UI_EVENTS_EDITOR_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/new/metadata\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_METADATA_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/new/processing\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_CREATE, ROLE_UI_TASKS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/attachments.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ATTACHMENTS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comments\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/publications.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_PUBLICATIONS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/hasActiveTransaction\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/hasSnapshots.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/media.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_MEDIA_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/media/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_MEDIA_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/metadata.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_METADATA_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/scheduling.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_SCHEDULING_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/operations.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/operations/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/errors.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/errors/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_VIEW\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/*/access.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ACL_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/groups/groups.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_GROUPS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/groups/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_GROUPS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/job/jobs.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_JOBS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/series.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/new/metadata\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_METADATA_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/new/themes\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_THEMES_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/access.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_ACL_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/metadata.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_METADATA_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/theme.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_THEMES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/server/servers.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERVERS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/services/services.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERVICES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/tasks/processing.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_TASKS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/themes/themes.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/themes/*/usage.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_DETAILS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/themes/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_DETAILS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/tools/*/editor.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_EDITOR_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/tools/*/thumbnail.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_EDITOR_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/tools/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_EDITOR_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/users/users.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_USERS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/users/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_USERS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/user-settings/signature\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/events/filters.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/series/filters.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/themes/filters.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/recordings/filters.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_LOCATIONS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/users/filters.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_USERS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/groups/filters.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_GROUPS_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/components.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/providers.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/THEMES.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/resources/*.json\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n    <sec:intercept-url pattern=\"/assets/assets/**\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_VIEW\" />\n\n    <sec:intercept-url pattern=\"/admin-ng/acl/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_ACLS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/metadata\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_METADATA_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/scheduling\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_SCHEDULING_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/action/stop\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/action/retry\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*/action/none\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_EDIT\"/>\n    <sec:intercept-url pattern=\"/admin-ng/event/bulk/update\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_SCHEDULING_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/groups/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_GROUPS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/metadata\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_METADATA_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/theme\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_THEMES_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/themes/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/users/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_UI_USERS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/user-settings/signature/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n\n    <sec:intercept-url pattern=\"/services/maintenance\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_SERVERS_MAINTENANCE_EDIT\" />\n    <sec:intercept-url pattern=\"/services/sanitize\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_SERVICES_STATUS_EDIT\" />\n    <sec:intercept-url pattern=\"/staticfiles\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_CREATE, ROLE_UI_THEMES_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/acl\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_ACLS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/bulk/conflicts\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_SCHEDULING_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/deleteEvents\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/new\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/new/conflicts\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/scheduling.json\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_SCHEDULING_VIEW\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/access\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ACL_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/assets\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_ASSETS_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*/reply\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/groups\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_GROUPS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/index/*\" method=\"POST\" access=\"ROLE_ADMIN\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/deleteSeries\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/new\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/access\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_ACL_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/tasks/new\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_TASKS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/themes\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/tools/*/editor.json\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_EDITOR_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/tools/*/thumbnail.json\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_EDITOR_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/users\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_UI_USERS_CREATE\" />\n    <sec:intercept-url pattern=\"/admin-ng/user-settings/signature\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n\n    <sec:intercept-url pattern=\"/admin-ng/acl/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_ACLS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/capture-agents/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_LOCATIONS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/comment/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_COMMENTS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*/workflows/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DETAILS_WORKFLOWS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/event/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_EVENTS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/groups/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_GROUPS_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*/theme\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DETAILS_THEMES_EDIT\" />\n    <sec:intercept-url pattern=\"/admin-ng/series/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_SERIES_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/themes/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_THEMES_DELETE\" />\n    <sec:intercept-url pattern=\"/admin-ng/users/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_UI_USERS_DELETE\" />\n\n    <!-- Securing the URLs for the external API interface -->\n    <!-- External API GET Endpoints -->\n    <sec:intercept-url pattern=\"/api\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API\"/>\n    <sec:intercept-url pattern=\"/api/agents\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_CAPTURE_AGENTS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/agents/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_CAPTURE_AGENTS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/acl\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_ACL_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/media\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_MEDIA_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/media/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_MEDIA_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/metadata\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_METADATA_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/metadata/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_METADATA_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/publications\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_PUBLICATIONS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/publications/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_PUBLICATIONS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/events/*/scheduling\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_SCHEDULING_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/groups\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/groups/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/info/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API\" />\n    <sec:intercept-url pattern=\"/api/info/me/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API\" />\n    <sec:intercept-url pattern=\"/api/series\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_SERIES_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/series/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_SERIES_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/series/*/acl\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_SERIES_ACL_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/series/*/metadata\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_SERIES_METADATA_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/series/*/metadata/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_SERIES_METADATA_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/series/*/properties\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_SERIES_PROPERTIES_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/version\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API\"/>\n    <sec:intercept-url pattern=\"/api/version/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API\"/>\n    <sec:intercept-url pattern=\"/api/workflows\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_INSTANCE_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/workflows/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_INSTANCE_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/workflow-definitions\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_DEFINITION_VIEW\"/>\n    <sec:intercept-url pattern=\"/api/workflow-definitions/*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_DEFINITION_VIEW\"/>\n    <!-- External API PUT Endpoints -->\n    <sec:intercept-url pattern=\"/api/events/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/events/*/acl\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_ACL_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/events/*/metadata\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_METADATA_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/events/*/metadata/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_METADATA_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/events/*/scheduling\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_SCHEDULING_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/groups/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/series/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_SERIES_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/series/*/acl\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_SERIES_ACL_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/series/*/metadata\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_SERIES_METADATA_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/series/*/metadata/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_SERIES_METADATA_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/series/*/properties\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_SERIES_PROPERTIES_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/workflows/*\" method=\"PUT\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_INSTANCE_EDIT\"/>\n    <!-- External API POST Endpoints -->\n    <sec:intercept-url pattern=\"/api/events\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_CREATE\"/>\n    <sec:intercept-url pattern=\"/api/events/*\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/events/*/acl/*\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_ACL_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/groups\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_CREATE\"/>\n    <sec:intercept-url pattern=\"/api/groups/*/members/*\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/clearIndex\" method=\"POST\" access=\"ROLE_ADMIN\"/>\n    <sec:intercept-url pattern=\"/api/recreateIndex\" method=\"POST\" access=\"ROLE_ADMIN\"/>\n    <sec:intercept-url pattern=\"/api/recreateIndex/*\" method=\"POST\" access=\"ROLE_ADMIN\"/>\n    <sec:intercept-url pattern=\"/api/series\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_SERIES_CREATE\"/>\n    <sec:intercept-url pattern=\"/api/security/sign\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_SECURITY_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/workflows\" method=\"POST\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_INSTANCE_CREATE\"/>\n    <!-- External API DELETE Endpoints -->\n    <sec:intercept-url pattern=\"/api/events/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/events/*/acl/*/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_ACL_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/events/*/metadata\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_METADATA_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/events/*/metadata/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_EVENTS_METADATA_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/groups/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/groups/*/members/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_GROUPS_EDIT\"/>\n    <sec:intercept-url pattern=\"/api/series/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_SERIES_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/series/*/metadata\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_SERIES_METADATA_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/series/*/metadata/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_SERIES_METADATA_DELETE\"/>\n    <sec:intercept-url pattern=\"/api/workflows/*\" method=\"DELETE\" access=\"ROLE_ADMIN, ROLE_API_WORKFLOW_INSTANCE_DELETE\"/>\n\n    <sec:intercept-url pattern=\"/admin-ng/css/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/admin-ng/lib/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/admin-ng/img/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/admin-ng/js/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/admin-ng/modules/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/admin-ng/shared/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/admin-ng/app.js\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Enable anonymous access to the admin ui -->\n    <sec:intercept-url pattern=\"/admin-ng/public/**\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Enable anonymous access to the /info/me.json resource -->\n    <sec:intercept-url pattern=\"/info/me.json\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/i18n/languages.json\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/info/components.json\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- anonymous access to user interface configuration -->\n    <sec:intercept-url pattern=\"/ui/config/**\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Paella player -->\n    <sec:intercept-url pattern=\"/paella/ui/auth.html\" access=\"ROLE_USER\" />\n    <sec:intercept-url pattern=\"/paella/ui/**\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Enable anonymous access to the engage player and the GET endpoints it requires -->\n    <sec:intercept-url pattern=\"/engage/ui/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/engage/**\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/engage-player/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/search/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/usertracking/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/usertracking/**\" method=\"PUT\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/static/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/export/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Enable anonymous access to the annotation and the series endpoints -->\n    <sec:intercept-url pattern=\"/series/**\" method=\"GET\" access=\"ROLE_ANONYMOUS, ROLE_CAPTURE_AGENT\" />\n    <sec:intercept-url pattern=\"/annotation/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/annotation/**\" method=\"PUT\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Enable anonymous access to the OAI-PMH repository              -->\n    <!-- The OAI-PMH specification demands boths GET and POST requests  -->\n    <!-- Please make sure that the path configured here matches         -->\n    <!-- the path configured for the repository servlet.                -->\n    <sec:intercept-url pattern=\"/oaipmh/**\" method=\"GET\" access=\"ROLE_ADMIN\"/>\n    <sec:intercept-url pattern=\"/oaipmh/**\" method=\"POST\" access=\"ROLE_ADMIN\"/>\n\n    <!-- Enable anonymous access to the rss and atom feeds -->\n    <sec:intercept-url pattern=\"/feeds/**\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Secure the system management URLs for admins only -->\n    <sec:intercept-url pattern=\"/services/available.*\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_CAPTURE_AGENT\" />\n    <sec:intercept-url pattern=\"/services/**\" access=\"ROLE_ADMIN\"/>\n    <sec:intercept-url pattern=\"/signing/**\" access=\"ROLE_ADMIN\" />\n    <sec:intercept-url pattern=\"/system/**\" access=\"ROLE_ADMIN\" />\n    <sec:intercept-url pattern=\"/config/**\" access=\"ROLE_ADMIN\" />\n\n    <!-- Enable capture agent updates and ingest -->\n    <sec:intercept-url pattern=\"/capture-admin/**\" access=\"ROLE_ADMIN, ROLE_CAPTURE_AGENT\" />\n    <sec:intercept-url pattern=\"/recordings/**\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_CAPTURE_AGENT\" />\n    <sec:intercept-url pattern=\"/ingest/**\" access=\"ROLE_ADMIN, ROLE_CAPTURE_AGENT\" />\n\n    <!-- Secure the user management URLs for admins only -->\n    <sec:intercept-url pattern=\"/users/**\" access=\"ROLE_ADMIN\" />\n    <sec:intercept-url pattern=\"/admin/users.html\" access=\"ROLE_ADMIN\" />\n\n    <!-- Enable 2-legged OAuth access (\"signed fetch\") to the LTI launch servlet -->\n    <sec:intercept-url pattern=\"/lti\" access=\"ROLE_OAUTH_USER\" />\n\n    <!-- Enable access to the LTI tools -->\n    <sec:intercept-url pattern=\"/ltitools/**\" access=\"ROLE_OAUTH_USER\" />\n\n    <sec:intercept-url pattern=\"/transcripts/watson/results*\" method=\"GET\" access=\"ROLE_ANONYMOUS\" />\n    <sec:intercept-url pattern=\"/transcripts/watson/results*\" method=\"POST\" access=\"ROLE_ANONYMOUS\" />\n\n    <!-- Everything else is for the admin users -->\n    <sec:intercept-url pattern=\"/admin-ng\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n    <sec:intercept-url pattern=\"/admin-ng/\" method=\"GET\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n    <sec:intercept-url pattern=\"/admin-ng/index.html\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n    <sec:intercept-url pattern=\"/index.html\" access=\"ROLE_ADMIN, ROLE_ADMIN_UI\" />\n    <sec:intercept-url pattern=\"/**\" access=\"ROLE_ADMIN\" />\n\n    <!-- ############################# -->\n    <!-- # LOGIN / LOGOUT MECHANISMS # -->\n    <!-- ############################# -->\n\n    <!-- Uncomment to enable x509 client certificates for identifying clients -->\n    <!-- sec:x509 subject-principal-regex=\"CN=(.*?),\" user-service-ref=\"userDetailsService\" / -->\n\n    <!-- Enable and configure the failure URL for form-based logins -->\n    <sec:form-login authentication-failure-url=\"/admin-ng/login.html?error\" authentication-success-handler-ref=\"authSuccessHandler\" />\n\n    <!-- Authentication filter chain -->\n    <sec:custom-filter position=\"BASIC_AUTH_FILTER\" ref=\"authenticationFilters\" />\n\n    <sec:custom-filter ref=\"asyncTimeoutRedirectFilter\" after=\"EXCEPTION_TRANSLATION_FILTER\"/>\n\n    <!-- Opencast is shipping its own implementation of the anonymous filter -->\n    <sec:custom-filter ref=\"anonymousFilter\" position=\"ANONYMOUS_FILTER\" />\n\n    <!-- Shibboleth header authentication filter\n    <sec:custom-filter ref=\"shibbolethHeaderFilter\" position=\"PRE_AUTH_FILTER\"/>\n    -->\n\n    <!-- Enables \"remember me\" functionality -->\n    <sec:remember-me services-ref=\"rememberMeServices\" />\n\n    <!-- Set the request cache -->\n    <sec:request-cache ref=\"requestCache\" />\n\n    <!-- If any URLs are to be exposed to anonymous users, the \"sec:anonymous\" filter must be present -->\n    <sec:anonymous enabled=\"false\" />\n\n    <!-- Enables log out -->\n    <sec:logout success-handler-ref=\"logoutSuccessHandler\" />\n\n    <!-- Shibboleth log out\n         Please specifiy the URL to return to after logging out\n    <sec:logout logout-success-url=\"/Shibboleth.sso/Logout?return=http://www.opencast.org\" />\n    -->\n\n  </sec:http>\n\n  <bean id=\"rememberMeServices\" class=\"org.opencastproject.kernel.security.SystemTokenBasedRememberMeService\">\n    <property name=\"userDetailsService\" ref=\"userDetailsService\"/>\n    <!-- All following settings are optional -->\n    <property name=\"tokenValiditySeconds\" value=\"1209600\"/>\n    <property name=\"cookieName\" value=\"oc-remember-me\"/>\n    <!-- The following key will be augmented by system properties. Thus, leaving this untouched is okay -->\n    <property name=\"key\" value=\"opencast\"/>\n  </bean>\n\n  <!-- ############################# -->\n  <!-- # Authentication Filters    # -->\n  <!-- ############################# -->\n\n  <bean id=\"authenticationFilters\" class=\"org.springframework.web.filter.CompositeFilter\">\n    <property name=\"filters\">\n      <list>\n        <!-- Digest auth is used by capture agents and is used to enable transparent clustering of services -->\n        <!-- ATTENTION! Do not deactivate the digest filter, otherwise the distributed setup would not work -->\n        <ref bean=\"digestFilter\" />\n\n        <!-- Basic authentication  -->\n        <ref bean=\"basicAuthenticationFilter\" />\n\n        <!-- 2-legged OAuth is used by trusted 3rd party applications, including LTI. -->\n        <!-- Uncomment the line below to support LTI or other OAuth clients.          -->\n        <!-- <ref bean=\"oauthProtectedResourceFilter\" /> -->\n      </list>\n    </property>\n  </bean>\n\n  <!-- ########################################### -->\n  <!-- # Custom ajax timeout Filter Definition   # -->\n  <!-- ########################################### -->\n\n  <bean id=\"asyncTimeoutRedirectFilter\" class=\"org.opencastproject.kernel.security.AsyncTimeoutRedirectFilter\" />\n\n  <!-- ######################################## -->\n  <!-- # Custom Anonymous Filter Definition   # -->\n  <!-- ######################################## -->\n\n  <bean id=\"anonymousFilter\" class=\"org.opencastproject.kernel.security.TrustedAnonymousAuthenticationFilter\">\n    <property name=\"userAttribute\" ref=\"anonymousUserAttributes\" />\n    <property name=\"key\" value=\"anonymousKey\" />\n  </bean>\n\n  <bean id=\"anonymousUserAttributes\" class=\"org.springframework.security.core.userdetails.memory.UserAttribute\">\n    <property name=\"authoritiesAsString\" value=\"ROLE_ANONYMOUS\"/>\n    <property name=\"password\" value=\"empty\"/>\n  </bean>\n\n  <!-- ######################################## -->\n  <!-- # Authentication Entry and Exit Points # -->\n  <!-- ######################################## -->\n\n  <!-- Differentiates between \"normal\" user requests and those requesting digest auth -->\n  <bean id=\"opencastEntryPoint\" class=\"org.opencastproject.kernel.security.DelegatingAuthenticationEntryPoint\">\n    <property name=\"userEntryPoint\" ref=\"userEntryPoint\" />\n    <property name=\"digestAuthenticationEntryPoint\" ref=\"digestEntryPoint\" />\n  </bean>\n\n  <!-- Redirects unauthenticated requests to the login form -->\n  <bean id=\"userEntryPoint\" class=\"org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint\">\n    <property name=\"loginFormUrl\" value=\"/admin-ng/login.html\" />\n  </bean>\n\n  <!-- Returns a 401 request for authentication via digest auth -->\n  <bean id=\"digestEntryPoint\" class=\"org.springframework.security.web.authentication.www.DigestAuthenticationEntryPoint\">\n    <property name=\"realmName\" value=\"Opencast\" />\n    <property name=\"key\" value=\"opencast\" />\n    <property name=\"nonceValiditySeconds\" value=\"300\" />\n  </bean>\n\n  <bean id=\"basicEntryPoint\" class=\"org.springframework.security.web.authentication.www.BasicAuthenticationEntryPoint\">\n    <property name=\"realmName\" value=\"Opencast\"/>\n  </bean>\n\n  <bean id=\"authSuccessHandler\" class=\"org.opencastproject.kernel.security.AuthenticationSuccessHandler\">\n    <property name=\"securityService\" ref=\"securityService\" />\n    <property name=\"welcomePages\">\n      <map>\n        <entry key=\"ROLE_ADMIN\" value=\"/admin-ng/index.html\" />\n        <entry key=\"ROLE_ADMIN_UI\" value=\"/admin-ng/index.html\" />\n        <entry key=\"*\" value=\"/engage/ui/index.html\" /> <!-- Any role not listed explicitly will redirect here -->\n      </map>\n    </property>\n  </bean>\n\n  <bean id=\"logoutSuccessHandler\" class=\"org.opencastproject.kernel.security.LogoutSuccessHandler\">\n    <property name=\"userDirectoryService\" ref=\"userDirectoryService\" />\n  </bean>\n\n  <!-- ################# -->\n  <!-- # Digest Filter # -->\n  <!-- ################# -->\n\n  <!-- Handles the details of the digest authentication dance -->\n  <bean id=\"digestFilter\" class=\"org.springframework.security.web.authentication.www.DigestAuthenticationFilter\">\n    <!--  Use only the in-memory users, as these have passwords that are not hashed -->\n    <property name=\"userDetailsService\" ref=\"userDetailsService\" />\n    <property name=\"authenticationEntryPoint\" ref=\"digestEntryPoint\" />\n    <property name=\"createAuthenticatedToken\" value=\"true\" />\n    <property name=\"userCache\">\n      <bean class=\"org.springframework.security.core.userdetails.cache.NullUserCache\" />\n    </property>\n  </bean>\n\n  <!-- ############################### -->\n  <!-- # Basic Authentication Filter # -->\n  <!-- ############################### -->\n\n  <!-- Handles the details of the basic authentication dance -->\n  <bean id=\"basicAuthenticationFilter\" class=\"org.springframework.security.web.authentication.www.BasicAuthenticationFilter\">\n    <property name=\"authenticationManager\" ref=\"authenticationManager\"/>\n    <property name=\"authenticationEntryPoint\" ref=\"basicEntryPoint\"/>\n  </bean>\n\n  <!-- ####################### -->\n  <!-- # OAuth (LTI) Support # -->\n  <!-- ####################### -->\n\n  <bean name=\"oauthProtectedResourceFilter\" class=\"org.opencastproject.kernel.security.LtiProcessingFilter\">\n    <property name=\"consumerDetailsService\" ref=\"oAuthConsumerDetailsService\" />\n    <property name=\"tokenServices\">\n      <bean class=\"org.springframework.security.oauth.provider.token.InMemoryProviderTokenServices\" />\n    </property>\n    <property name=\"nonceServices\">\n      <bean class=\"org.springframework.security.oauth.provider.nonce.InMemoryNonceServices\" />\n    </property>\n    <property name=\"authHandler\" ref=\"ltiLaunchAuthenticationHandler\" />\n  </bean>\n\n  <!-- ###################### -->\n  <!-- # Shibboleth Support # -->\n  <!-- ###################### -->\n\n  <!-- General Shibboleth header extration filter\n  <bean id=\"shibbolethHeaderFilter\"\n        class=\"org.opencastproject.security.shibboleth.ShibbolethRequestHeaderAuthenticationFilter\">\n    <property name=\"principalRequestHeader\" value=\"<this need to be configured>\"/>\n    <property name=\"authenticationManager\" ref=\"authenticationManager\" />\n    <property name=\"userDetailsService\" ref=\"userDetailsService\" />\n    <property name=\"userDirectoryService\" ref=\"userDirectoryService\" />\n    <property name=\"shibbolethLoginHandler\" ref=\"aaiLoginHandler\" />\n    <property name=\"exceptionIfHeaderMissing\" value=\"false\" />\n  </bean>\n  -->\n\n  <!-- AAI header extractor and user generator\n  <bean id=\"aaiLoginHandler\" class=\"org.opencastproject.security.aai.ConfigurableLoginHandler\">\n    <property name=\"securityService\" ref=\"securityService\" />\n    <property name=\"userReferenceProvider\" ref=\"userReferenceProvider\" />\n  </bean>\n  -->\n\n  <!--\n  <bean id=\"preauthAuthProvider\"\n        class=\"org.springframework.security.web.authentication.preauth.PreAuthenticatedAuthenticationProvider\">\n    <property name=\"preAuthenticatedUserDetailsService\">\n      <bean id=\"userDetailsServiceWrapper\" class=\"org.springframework.security.core.userdetails.UserDetailsByNameServiceWrapper\">\n        <property name=\"userDetailsService\" ref=\"userDetailsService\"/>\n      </bean>\n    </property>\n  </bean>\n  -->\n\n  <!-- #################### -->\n  <!-- # OSGI Integration # -->\n  <!-- #################### -->\n\n  <!-- Obtain services from the OSGI service registry -->\n  <osgi:reference id=\"userDetailsService\" cardinality=\"1..1\"\n                  interface=\"org.springframework.security.core.userdetails.UserDetailsService\" />\n\n  <osgi:reference id=\"securityService\" cardinality=\"1..1\"\n                  interface=\"org.opencastproject.security.api.SecurityService\" />\n\n  <!-- Uncomment to enable external users e.g. used together shibboleth -->\n  <!-- <osgi:reference id=\"userReferenceProvider\" cardinality=\"1..1\"\n                  interface=\"org.opencastproject.userdirectory.api.UserReferenceProvider\"  /> -->\n\n  <osgi:reference id=\"userDirectoryService\" cardinality=\"1..1\"\n                  interface=\"org.opencastproject.security.api.UserDirectoryService\" />\n\n  <osgi:reference id=\"oAuthConsumerDetailsService\" cardinality=\"1..1\"\n                  interface=\"org.springframework.security.oauth.provider.ConsumerDetailsService\" />\n\n  <osgi:reference id=\"ltiLaunchAuthenticationHandler\" cardinality=\"1..1\"\n                  interface=\"org.springframework.security.oauth.provider.OAuthAuthenticationHandler\" />\n\n  <!-- ############################# -->\n  <!-- # Spring Security Internals # -->\n  <!-- ############################# -->\n\n  <!-- The JPA user directory stores md5 hashed, salted passwords, so we must use a username-salted md5 password encoder. -->\n  <sec:authentication-manager alias=\"authenticationManager\">\n    <!-- Uncomment this if using Shibboleth authentication -->\n    <!--sec:authentication-provider ref=\"preauthAuthProvider\" /-->\n    <sec:authentication-provider user-service-ref=\"userDetailsService\">\n      <sec:password-encoder hash=\"md5\"><sec:salt-source user-property=\"username\" /></sec:password-encoder>\n    </sec:authentication-provider>\n  </sec:authentication-manager>\n\n  <!-- Do not use a request cache -->\n  <bean id=\"requestCache\" class=\"org.springframework.security.web.savedrequest.NullRequestCache\" />\n\n</beans>\n"], "filenames": ["etc/security/mh_default_org.xml"], "buggy_code_start_loc": [300], "buggy_code_end_loc": [305], "fixing_code_start_loc": [300], "fixing_code_end_loc": [305], "type": "CWE-276", "message": "In Opencast before 7.6 and 8.1, users with the role ROLE_COURSE_ADMIN can use the user-utils endpoint to create new users not including the role ROLE_ADMIN. ROLE_COURSE_ADMIN is a non-standard role in Opencast which is referenced neither in the documentation nor in any code (except for tests) but only in the security configuration. From the name \u2013 implying an admin for a specific course \u2013 users would never expect that this role allows user creation. This issue is fixed in 7.6 and 8.1 which both ship a new default security configuration.", "other": {"cve": {"id": "CVE-2020-5231", "sourceIdentifier": "security-advisories@github.com", "published": "2020-01-30T22:15:10.220", "lastModified": "2020-02-10T21:55:25.883", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "In Opencast before 7.6 and 8.1, users with the role ROLE_COURSE_ADMIN can use the user-utils endpoint to create new users not including the role ROLE_ADMIN. ROLE_COURSE_ADMIN is a non-standard role in Opencast which is referenced neither in the documentation nor in any code (except for tests) but only in the security configuration. From the name \u2013 implying an admin for a specific course \u2013 users would never expect that this role allows user creation. This issue is fixed in 7.6 and 8.1 which both ship a new default security configuration."}, {"lang": "es", "value": "En Opencast anterior a las versiones 7.6 y 8.1, los usuarios con el rol ROLE_COURSE_ADMIN pueden usar el punto final user-utils para crear nuevos usuarios sin incluir el rol ROLE_ADMIN. ROLE_COURSE_ADMIN es un rol no est\u00e1ndar en Opencast al que no se hace referencia ni en la documentaci\u00f3n ni en ning\u00fan c\u00f3digo (excepto para las pruebas) sino solo en la configuraci\u00f3n de seguridad. Por el nombre, lo que implica un administrador para un curso espec\u00edfico, los usuarios nunca esperar\u00edan que este rol permita la creaci\u00f3n de usuarios. Este problema se solucion\u00f3 en 7.6 y 8.1, que incluyen una nueva configuraci\u00f3n de seguridad predeterminada."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 6.5, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.6}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-276"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-285"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:apereo:opencast:*:*:*:*:*:*:*:*", "versionEndExcluding": "7.6", "matchCriteriaId": "7056094F-6E63-4BFB-B8A3-125746BA882C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:apereo:opencast:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "4A82AABB-ACF6-4017-99E8-4DA90CE416D7"}]}]}], "references": [{"url": "https://github.com/opencast/opencast/commit/72fad0031d8a82c860e2bde0b27570c5042320ee", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/opencast/opencast/security/advisories/GHSA-94qw-r73x-j7hg", "source": "security-advisories@github.com", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/opencast/opencast/commit/72fad0031d8a82c860e2bde0b27570c5042320ee"}}