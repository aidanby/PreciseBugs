{"buggy_code": ["<?php\n$name = '';\n$slug = '';\n$description = '';\n\n$tagging_tag_id = $params['tagging_tag_id'];\n$filter = [\n    'id'=>$tagging_tag_id,\n    'single'=>1\n];\n$tag = db_get('tagging_tags', $filter);\nif ($tag) {\n    $name = $tag['name'];\n    $slug = $tag['slug'];\n    $description = $tag['description'];\n}\n?>\n\n<style>\n    .demobox {\n        position: relative;\n        padding: 10px 0px;\n    }\n    .mw-ui-field {\n        width: 100%;\n    }\n    .helptext{\n        color: #666;\n    }\n</style>\n\n<script>\n    $(document).ready(function () {\n\n        $('.js-admin-tag-edit-form').submit(function (e) {\n            e.preventDefault();\n\n            $.ajax({\n                url: mw.settings.api_url + 'tagging_tag/edit',\n                type: 'post',\n                data: $(this).serialize(),\n                success: function(data) {\n\n                    if (data.name) {\n\n                        if ($('.js-admin-tags').find('.btn-tag-id-' + data.id).length == 0) {\n                            $('.js-admin-tags').append(getTagButtonHtmlInForm(data.id, data.name, data.slug));\n                        } else {\n                            $('.btn-tag-id-' + data.id).replaceWith(getTagButtonHtmlInForm(data.id, data.name, data.slug));\n                        }\n\n                        $('.js-admin-tag-edit-form').find('.js-clear-after-save').each(function (e) {\n                            $(this).val('');\n                        });\n\n                        searchTagsByKeyowrd();\n\n                        if (typeof(tagsSelect) != \"undefined\") {\n                            tagsSelect.value({});\n                        }\n\n                        //  mw.reload_module_everywhere('tags');\n                        mw.notification.success('<?php _e('Tag is saved!');?>');\n                        $('.js-admin-tag-edit-messages').html('<div class=\"alert alert-success\"><?php _e('Tag is saved!'); ?></div>');\n                    } else if (data.message) {\n                        mw.notification.error(data.message);\n                        $('.js-admin-tag-edit-messages').html('<div class=\"alert alert-danger\">' + data.message + '</div>');\n                    } else {\n                        mw.notification.error('<?php _e('Please, fill all fields.'); ?>');\n                        $('.js-admin-tag-edit-messages').html('<div class=\"alert alert-danger\"><?php _e('Please, fill all fields.'); ?></div>');\n                    }\n                }\n            });\n\n        });\n\n    });\n\n    function getTagButtonHtmlInForm(id,name,slug) {\n\n        var html = '<div class=\"btn-group tag mb-2 mr-1 btn-tag-id-'+id+'\" role=\"group\">' +\n            '    <button type=\"button\" class=\"btn-sm icon-left no-hover btn btn-secondary\" onClick=\"editTaggingTagReplaceForm('+id+')\"><i class=\"mdi mdi-tag\"></i> ' + name + '</button>' +\n            '    <button type=\"button\" class=\"btn btn-primary btn-sm btn-icon\" onClick=\"editTaggingTagReplaceForm('+id+')\"><i class=\"mdi mdi-pencil\"></i></button>' +\n            '    <button type=\"button\" class=\"btn btn-primary btn-sm btn-icon\" onClick=\"deleteTaggingTag('+id+')\"><i class=\"mdi mdi-close\"></i></button>' +\n            '</div>';\n\n        return html;\n    }\n\n    function editTaggingTagReplaceForm(tagging_tag_id) {\n        $.ajax({\n            url: mw.settings.api_url + 'tagging_tag/view',\n            type: 'get',\n            data: {\n                tagging_tag_id:tagging_tag_id\n            },\n            success: function (data) {\n                if (data.name) {\n\n                    if (typeof(tagsSelect) != \"undefined\") {\n                        tagsSelect.value({id: data.id, title: data.name});\n                    }\n\n                    $('.js-admin-tag-edit-form-tag-name').val(data.name);\n                    $('.js-admin-tag-edit-form-tag-slug').val(data.slug);\n                    $('.js-admin-tag-edit-form-tag-description').val(data.description);\n                    $('.js-admin-tag-edit-form-tag-id').val(data.id);\n                }\n\n            }\n        });\n    }\n</script>\n\n<form method=\"post\" class=\"js-admin-tag-edit-form\">\n    <div class=\"form-group\">\n        <label class=\"control-label\"><?php _e('Tag Name');?></label>\n        <small class=\"text-muted mb-2 d-block\"><?php _e('The name is how it appears on your site.');?></small>\n        <input type=\"text\" name=\"name\" value=\"<?php echo $name; ?>\" class=\"form-control js-admin-tag-edit-form-tag-name js-clear-after-save\">\n    </div>\n\n    <div class=\"form-group\" <?php if ($tag): ?> style=\"display: none;\" <?php endif; ?>>\n        <label class=\"control-label\"><?php _e('Tag Slug');?></label>\n        <small class=\"text-muted mb-2 d-block\"><?php _e('The \u201cslug\u201d is the URL-friendly version of the name. It is usually all lowercase and contains only letters, numbers, and hyphens.');?></small>\n        <input type=\"text\" name=\"slug\" value=\"<?php echo $slug; ?>\" class=\"form-control js-admin-tag-edit-form-tag-slug js-clear-after-save\">\n    </div>\n\n\n    <div class=\"form-group\">\n        <label class=\"control-label\"><?php _e('Tag Description'); ?></label>\n        <small class=\"text-muted mb-2 d-block\"><?php _e('The description is not prominent by default; however, some themes may show it.'); ?></small>\n        <textarea name=\"description\" class=\"form-control js-admin-tag-edit-form-tag-description js-clear-after-save\"><?php echo $description; ?></textarea>\n    </div>\n\n    <input type=\"hidden\" name=\"tagging_tag_id\" class=\"js-admin-tag-edit-form-tag-id\" value=\"<?php if ($tag): echo $tag['id']; endif; ?>\" />\n\n    <button class=\"btn btn-success btn-sm\" type=\"submit\"><?php _e('Save Tag');?></button>\n</form>\n\n<div class=\"js-admin-tag-edit-messages\" style=\"padding-top: 15px\"></div>\n\n<div class=\"js-admin-tags mt-3\"></div>"], "fixing_code": ["<?php\n$name = '';\n$slug = '';\n$description = '';\n\n$tagging_tag_id = $params['tagging_tag_id'];\n$filter = [\n    'id'=>$tagging_tag_id,\n    'single'=>1\n];\n$tag = db_get('tagging_tags', $filter);\nif ($tag) {\n    $name = $tag['name'];\n    $slug = $tag['slug'];\n    $description = $tag['description'];\n}\n?>\n\n<style>\n    .demobox {\n        position: relative;\n        padding: 10px 0px;\n    }\n    .mw-ui-field {\n        width: 100%;\n    }\n    .helptext{\n        color: #666;\n    }\n</style>\n\n<script>\n    $(document).ready(function () {\n\n        $('.js-admin-tag-edit-form').submit(function (e) {\n            e.preventDefault();\n\n            $.ajax({\n                url: mw.settings.api_url + 'tagging_tag/edit',\n                type: 'post',\n                data: $(this).serialize(),\n                success: function(data) {\n\n                    if (data.name) {\n\n                        if ($('.js-admin-tags').find('.btn-tag-id-' + data.id).length == 0) {\n                            $('.js-admin-tags').append(getTagButtonHtmlInForm(data.id, data.name, data.slug));\n                        } else {\n                            $('.btn-tag-id-' + data.id).replaceWith(getTagButtonHtmlInForm(data.id, data.name, data.slug));\n                        }\n\n                        $('.js-admin-tag-edit-form').find('.js-clear-after-save').each(function (e) {\n                            $(this).val('');\n                        });\n\n                        searchTagsByKeyowrd();\n\n                        if (typeof(tagsSelect) != \"undefined\") {\n                            tagsSelect.value({});\n                        }\n\n                        //  mw.reload_module_everywhere('tags');\n                        mw.notification.success('<?php _e('Tag is saved!');?>');\n                        $('.js-admin-tag-edit-messages').html('<div class=\"alert alert-success\"><?php _e('Tag is saved!'); ?></div>');\n                    } else if (data.message) {\n                        mw.notification.error(data.message);\n                        $('.js-admin-tag-edit-messages').html('<div class=\"alert alert-danger\">' + data.message + '</div>');\n                    } else {\n                        mw.notification.error('<?php _e('Please, fill all fields.'); ?>');\n                        $('.js-admin-tag-edit-messages').html('<div class=\"alert alert-danger\"><?php _e('Please, fill all fields.'); ?></div>');\n                    }\n                }\n            });\n\n        });\n\n    });\n\n    function getTagButtonHtmlInForm(id,name,slug) {\n\n        // remove html from string before display\n        name =  $('<p>' + name + '</p>').text();\n\n         var html = '<div class=\"btn-group tag mb-2 mr-1 btn-tag-id-'+id+'\" role=\"group\">' +\n            '    <button type=\"button\" class=\"btn-sm icon-left no-hover btn btn-secondary\" onClick=\"editTaggingTagReplaceForm('+id+')\"><i class=\"mdi mdi-tag\"></i> ' + name + '</button>' +\n            '    <button type=\"button\" class=\"btn btn-primary btn-sm btn-icon\" onClick=\"editTaggingTagReplaceForm('+id+')\"><i class=\"mdi mdi-pencil\"></i></button>' +\n            '    <button type=\"button\" class=\"btn btn-primary btn-sm btn-icon\" onClick=\"deleteTaggingTag('+id+')\"><i class=\"mdi mdi-close\"></i></button>' +\n            '</div>';\n\n        return html;\n    }\n\n    function editTaggingTagReplaceForm(tagging_tag_id) {\n        $.ajax({\n            url: mw.settings.api_url + 'tagging_tag/view',\n            type: 'get',\n            data: {\n                tagging_tag_id:tagging_tag_id\n            },\n            success: function (data) {\n                if (data.name) {\n\n                    if (typeof(tagsSelect) != \"undefined\") {\n                        tagsSelect.value({id: data.id, title: data.name});\n                    }\n\n                    $('.js-admin-tag-edit-form-tag-name').val(data.name);\n                    $('.js-admin-tag-edit-form-tag-slug').val(data.slug);\n                    $('.js-admin-tag-edit-form-tag-description').val(data.description);\n                    $('.js-admin-tag-edit-form-tag-id').val(data.id);\n                }\n\n            }\n        });\n    }\n</script>\n\n<form method=\"post\" class=\"js-admin-tag-edit-form\">\n    <div class=\"form-group\">\n        <label class=\"control-label\"><?php _e('Tag Name');?></label>\n        <small class=\"text-muted mb-2 d-block\"><?php _e('The name is how it appears on your site.');?></small>\n        <input type=\"text\" name=\"name\" value=\"<?php echo $name; ?>\" class=\"form-control js-admin-tag-edit-form-tag-name js-clear-after-save\">\n    </div>\n\n    <div class=\"form-group\" <?php if ($tag): ?> style=\"display: none;\" <?php endif; ?>>\n        <label class=\"control-label\"><?php _e('Tag Slug');?></label>\n        <small class=\"text-muted mb-2 d-block\"><?php _e('The \u201cslug\u201d is the URL-friendly version of the name. It is usually all lowercase and contains only letters, numbers, and hyphens.');?></small>\n        <input type=\"text\" name=\"slug\" value=\"<?php echo $slug; ?>\" class=\"form-control js-admin-tag-edit-form-tag-slug js-clear-after-save\">\n    </div>\n\n\n    <div class=\"form-group\">\n        <label class=\"control-label\"><?php _e('Tag Description'); ?></label>\n        <small class=\"text-muted mb-2 d-block\"><?php _e('The description is not prominent by default; however, some themes may show it.'); ?></small>\n        <textarea name=\"description\" class=\"form-control js-admin-tag-edit-form-tag-description js-clear-after-save\"><?php echo $description; ?></textarea>\n    </div>\n\n    <input type=\"hidden\" name=\"tagging_tag_id\" class=\"js-admin-tag-edit-form-tag-id\" value=\"<?php if ($tag): echo $tag['id']; endif; ?>\" />\n\n    <button class=\"btn btn-success btn-sm\" type=\"submit\"><?php _e('Save Tag');?></button>\n</form>\n\n<div class=\"js-admin-tag-edit-messages\" style=\"padding-top: 15px\"></div>\n\n<div class=\"js-admin-tags mt-3\"></div>\n"], "filenames": ["userfiles/modules/tags/edit_tagging_tag.php"], "buggy_code_start_loc": [81], "buggy_code_end_loc": [143], "fixing_code_start_loc": [81], "fixing_code_end_loc": [146], "type": "CWE-79", "message": "HTML injection attack is closely related to Cross-site Scripting (XSS). HTML injection uses HTML to deface the page. XSS, as the name implies, injects JavaScript into the page. Both attacks exploit insufficient validation of user input.", "other": {"cve": {"id": "CVE-2022-3245", "sourceIdentifier": "security@huntr.dev", "published": "2022-09-20T14:15:09.783", "lastModified": "2022-09-22T00:12:29.157", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "HTML injection attack is closely related to Cross-site Scripting (XSS). HTML injection uses HTML to deface the page. XSS, as the name implies, injects JavaScript into the page. Both attacks exploit insufficient validation of user input."}, {"lang": "es", "value": "Un ataque de inyecci\u00f3n HTML est\u00e1 estrechamente relacionado con un ataque de tipo Cross-site Scripting (XSS). La inyecci\u00f3n de HTML usa HTML para desfigurar la p\u00e1gina. El ataque de tipo XSS, como su nombre indica, inyecta JavaScript en la p\u00e1gina. Ambos ataques son aprovechados de una comprobaci\u00f3n insuficiente de las entradas del usuario"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 0.9, "impactScore": 3.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-94"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:microweber:microweber:*:*:*:*:*:*:*:*", "versionEndExcluding": "1.3.2", "matchCriteriaId": "7909A23C-454B-4641-904E-E38E669A5745"}]}]}], "references": [{"url": "https://github.com/microweber/microweber/commit/f20abf30a1d9c1426c5fb757ac63998dc5b92bfc", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/747c2924-95ca-4311-9e69-58ee0fb440a0", "source": "security@huntr.dev", "tags": ["Exploit", "Issue Tracking", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/microweber/microweber/commit/f20abf30a1d9c1426c5fb757ac63998dc5b92bfc"}}