{"buggy_code": ["/*\n * Based on arch/arm/lib/clear_user.S\n *\n * Copyright (C) 2012 ARM Ltd.\n *\n * This program is free software; you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 2 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n#include <linux/linkage.h>\n#include <asm/assembler.h>\n\n\t.text\n\n/* Prototype: int __clear_user(void *addr, size_t sz)\n * Purpose  : clear some user memory\n * Params   : addr - user memory address to clear\n *          : sz   - number of bytes to clear\n * Returns  : number of bytes NOT cleared\n *\n * Alignment fixed up by hardware.\n */\nENTRY(__clear_user)\n\tmov\tx2, x1\t\t\t// save the size for fixup return\n\tsubs\tx1, x1, #8\n\tb.mi\t2f\n1:\nUSER(9f, str\txzr, [x0], #8\t)\n\tsubs\tx1, x1, #8\n\tb.pl\t1b\n2:\tadds\tx1, x1, #4\n\tb.mi\t3f\nUSER(9f, str\twzr, [x0], #4\t)\n\tsub\tx1, x1, #4\n3:\tadds\tx1, x1, #2\n\tb.mi\t4f\nUSER(9f, strh\twzr, [x0], #2\t)\n\tsub\tx1, x1, #2\n4:\tadds\tx1, x1, #1\n\tb.mi\t5f\n\tstrb\twzr, [x0]\n5:\tmov\tx0, #0\n\tret\nENDPROC(__clear_user)\n\n\t.section .fixup,\"ax\"\n\t.align\t2\n9:\tmov\tx0, x2\t\t\t// return the original size\n\tret\n\t.previous\n"], "fixing_code": ["/*\n * Based on arch/arm/lib/clear_user.S\n *\n * Copyright (C) 2012 ARM Ltd.\n *\n * This program is free software; you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 2 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n#include <linux/linkage.h>\n#include <asm/assembler.h>\n\n\t.text\n\n/* Prototype: int __clear_user(void *addr, size_t sz)\n * Purpose  : clear some user memory\n * Params   : addr - user memory address to clear\n *          : sz   - number of bytes to clear\n * Returns  : number of bytes NOT cleared\n *\n * Alignment fixed up by hardware.\n */\nENTRY(__clear_user)\n\tmov\tx2, x1\t\t\t// save the size for fixup return\n\tsubs\tx1, x1, #8\n\tb.mi\t2f\n1:\nUSER(9f, str\txzr, [x0], #8\t)\n\tsubs\tx1, x1, #8\n\tb.pl\t1b\n2:\tadds\tx1, x1, #4\n\tb.mi\t3f\nUSER(9f, str\twzr, [x0], #4\t)\n\tsub\tx1, x1, #4\n3:\tadds\tx1, x1, #2\n\tb.mi\t4f\nUSER(9f, strh\twzr, [x0], #2\t)\n\tsub\tx1, x1, #2\n4:\tadds\tx1, x1, #1\n\tb.mi\t5f\nUSER(9f, strb\twzr, [x0]\t)\n5:\tmov\tx0, #0\n\tret\nENDPROC(__clear_user)\n\n\t.section .fixup,\"ax\"\n\t.align\t2\n9:\tmov\tx0, x2\t\t\t// return the original size\n\tret\n\t.previous\n"], "filenames": ["arch/arm64/lib/clear_user.S"], "buggy_code_start_loc": [49], "buggy_code_end_loc": [50], "fixing_code_start_loc": [49], "fixing_code_end_loc": [50], "type": "CWE-17", "message": "The __clear_user function in arch/arm64/lib/clear_user.S in the Linux kernel before 3.17.4 on the ARM64 platform allows local users to cause a denial of service (system crash) by reading one byte beyond a /dev/zero page boundary.", "other": {"cve": {"id": "CVE-2014-7843", "sourceIdentifier": "secalert@redhat.com", "published": "2014-11-30T01:59:05.570", "lastModified": "2023-02-13T00:42:35.690", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "The __clear_user function in arch/arm64/lib/clear_user.S in the Linux kernel before 3.17.4 on the ARM64 platform allows local users to cause a denial of service (system crash) by reading one byte beyond a /dev/zero page boundary."}, {"lang": "es", "value": "La funci\u00f3n __clear_user en arch/arm64/lib/clear_user.S en el kernel de Linux anterior a 3.17.4 en la plataforma ARM64 permite a usuarios locales causar una denegaci\u00f3n de servicio (ca\u00edda del sistema) mediante la lectura de un byte m\u00e1s all\u00e1 del l\u00edmite de p\u00e1gina /dev/zero."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:L/AC:L/Au:N/C:N/I:N/A:C", "accessVector": "LOCAL", "accessComplexity": "LOW", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "NONE", "availabilityImpact": "COMPLETE", "baseScore": 4.9}, "baseSeverity": "MEDIUM", "exploitabilityScore": 3.9, "impactScore": 6.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-17"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:arm64:*", "versionEndIncluding": "3.17.3", "matchCriteriaId": "AC6F3D3E-8FB9-41AD-901D-BC81B689ECDF"}]}]}], "references": [{"url": "http://git.kernel.org/?p=linux/kernel/git/torvalds/linux-2.6.git%3Ba=commit%3Bh=97fc15436b36ee3956efad83e22a557991f7d19d", "source": "secalert@redhat.com"}, {"url": "http://www.kernel.org/pub/linux/kernel/v3.x/ChangeLog-3.17.4", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "http://www.openwall.com/lists/oss-security/2014/11/13/5", "source": "secalert@redhat.com"}, {"url": "http://www.securityfocus.com/bid/71082", "source": "secalert@redhat.com"}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1163744", "source": "secalert@redhat.com", "tags": ["Patch", "Vendor Advisory"]}, {"url": "https://github.com/torvalds/linux/commit/97fc15436b36ee3956efad83e22a557991f7d19d", "source": "secalert@redhat.com", "tags": ["Patch", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/torvalds/linux/commit/97fc15436b36ee3956efad83e22a557991f7d19d"}}