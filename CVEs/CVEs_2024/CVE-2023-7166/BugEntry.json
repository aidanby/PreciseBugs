{"buggy_code": ["package com.java2nb.novel.entity;\n\nimport io.github.xxyopen.web.valid.AddGroup;\nimport io.github.xxyopen.web.valid.UpdateGroup;\n\nimport javax.annotation.Generated;\nimport javax.validation.constraints.*;\nimport java.util.Date;\n\npublic class User {\n\n    @Null(groups = {AddGroup.class, UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private Long id;\n\n\n    @NotBlank(groups = {AddGroup.class},message=\"\u624b\u673a\u53f7\u4e0d\u80fd\u4e3a\u7a7a\uff01\")\n    @Pattern(groups = {AddGroup.class},regexp=\"^1[3|4|5|6|7|8|9][0-9]{9}$\",message=\"\u624b\u673a\u53f7\u683c\u5f0f\u4e0d\u6b63\u786e\uff01\")\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private String username;\n\n    @NotBlank(groups = {AddGroup.class},message=\"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\uff01\")\n    @Null(groups = {UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private String password;\n\n    @Null(groups = {AddGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private String nickName;\n\n    @Null(groups = {AddGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private String userPhoto;\n\n    @Null(groups = {AddGroup.class})\n    @Min(value = 0,groups = {UpdateGroup.class})\n    @Max(value = 1,groups = {UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private Byte userSex;\n\n    @Null(groups = {AddGroup.class,UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private Long accountBalance;\n\n    @Null(groups = {AddGroup.class,UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private Byte status;\n\n    @Null(groups = {AddGroup.class,UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private Date createTime;\n\n    @Null(groups = {AddGroup.class,UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private Date updateTime;\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public Long getId() {\n        return id;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public String getUsername() {\n        return username;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setUsername(String username) {\n        this.username = username == null ? null : username.trim();\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public String getPassword() {\n        return password;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setPassword(String password) {\n        this.password = password == null ? null : password.trim();\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public String getNickName() {\n        return nickName;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setNickName(String nickName) {\n        this.nickName = nickName == null ? null : nickName.trim();\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public String getUserPhoto() {\n        return userPhoto;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setUserPhoto(String userPhoto) {\n        this.userPhoto = userPhoto == null ? null : userPhoto.trim();\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public Byte getUserSex() {\n        return userSex;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setUserSex(Byte userSex) {\n        this.userSex = userSex;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public Long getAccountBalance() {\n        return accountBalance;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setAccountBalance(Long accountBalance) {\n        this.accountBalance = accountBalance;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public Byte getStatus() {\n        return status;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setStatus(Byte status) {\n        this.status = status;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public Date getCreateTime() {\n        return createTime;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setCreateTime(Date createTime) {\n        this.createTime = createTime;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public Date getUpdateTime() {\n        return updateTime;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setUpdateTime(Date updateTime) {\n        this.updateTime = updateTime;\n    }\n}"], "fixing_code": ["package com.java2nb.novel.entity;\n\nimport io.github.xxyopen.web.valid.AddGroup;\nimport io.github.xxyopen.web.valid.UpdateGroup;\n\nimport javax.annotation.Generated;\nimport javax.validation.constraints.*;\nimport java.util.Date;\n\npublic class User {\n\n    @Null(groups = {AddGroup.class, UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private Long id;\n\n\n    @NotBlank(groups = {AddGroup.class}, message = \"\u624b\u673a\u53f7\u4e0d\u80fd\u4e3a\u7a7a\uff01\")\n    @Pattern(groups = {AddGroup.class}, regexp = \"^1[3|4|5|6|7|8|9][0-9]{9}$\", message = \"\u624b\u673a\u53f7\u683c\u5f0f\u4e0d\u6b63\u786e\uff01\")\n    @Null(groups = {UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private String username;\n\n    @NotBlank(groups = {AddGroup.class}, message = \"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\uff01\")\n    @Null(groups = {UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private String password;\n\n    @Null(groups = {AddGroup.class})\n    @Pattern(groups = {\n        UpdateGroup.class}, regexp = \"[\\u4E00-\\u9FA5A-Za-z0-9_]{1,20}\", message = \"\u6635\u79f0\u683c\u5f0f\u4e0d\u6b63\u786e\uff01\")\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private String nickName;\n\n    @Null(groups = {AddGroup.class})\n    @Pattern(groups = {\n        UpdateGroup.class}, regexp = \"^/localPic/\\\\d{4}/\\\\d{2}/\\\\d{2}/[A-Za-z0-9]+\\\\.(jpg|jpeg|swf|gif|png|JPG|JPEG|SWF|GIF|PNG)$\", message = \"\u53ea\u80fd\u4e0a\u4f20\u56fe\u7247\u683c\u5f0f\u7684\u6587\u4ef6\uff01\")\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private String userPhoto;\n\n    @Null(groups = {AddGroup.class})\n    @Min(value = 0, groups = {UpdateGroup.class})\n    @Max(value = 1, groups = {UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private Byte userSex;\n\n    @Null(groups = {AddGroup.class, UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private Long accountBalance;\n\n    @Null(groups = {AddGroup.class, UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private Byte status;\n\n    @Null(groups = {AddGroup.class, UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private Date createTime;\n\n    @Null(groups = {AddGroup.class, UpdateGroup.class})\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    private Date updateTime;\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public Long getId() {\n        return id;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setId(Long id) {\n        this.id = id;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public String getUsername() {\n        return username;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setUsername(String username) {\n        this.username = username == null ? null : username.trim();\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public String getPassword() {\n        return password;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setPassword(String password) {\n        this.password = password == null ? null : password.trim();\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public String getNickName() {\n        return nickName;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setNickName(String nickName) {\n        this.nickName = nickName == null ? null : nickName.trim();\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public String getUserPhoto() {\n        return userPhoto;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setUserPhoto(String userPhoto) {\n        this.userPhoto = userPhoto == null ? null : userPhoto.trim();\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public Byte getUserSex() {\n        return userSex;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setUserSex(Byte userSex) {\n        this.userSex = userSex;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public Long getAccountBalance() {\n        return accountBalance;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setAccountBalance(Long accountBalance) {\n        this.accountBalance = accountBalance;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public Byte getStatus() {\n        return status;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setStatus(Byte status) {\n        this.status = status;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public Date getCreateTime() {\n        return createTime;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setCreateTime(Date createTime) {\n        this.createTime = createTime;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public Date getUpdateTime() {\n        return updateTime;\n    }\n\n    @Generated(\"org.mybatis.generator.api.MyBatisGenerator\")\n    public void setUpdateTime(Date updateTime) {\n        this.updateTime = updateTime;\n    }\n}"], "filenames": ["novel-common/src/main/java/com/java2nb/novel/entity/User.java"], "buggy_code_start_loc": [17], "buggy_code_end_loc": [54], "fixing_code_start_loc": [17], "fixing_code_end_loc": [59], "type": "CWE-79", "message": "A vulnerability classified as problematic has been found in Novel-Plus up to 4.2.0. This affects an unknown part of the file /user/updateUserInfo of the component HTTP POST Request Handler. The manipulation of the argument nickName leads to cross site scripting. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The identifier of the patch is c62da9bb3a9b3603014d0edb436146512631100d. It is recommended to apply a patch to fix this issue. The identifier VDB-249201 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2023-7166", "sourceIdentifier": "cna@vuldb.com", "published": "2023-12-29T09:15:09.973", "lastModified": "2024-02-29T01:42:57.953", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "A vulnerability classified as problematic has been found in Novel-Plus up to 4.2.0. This affects an unknown part of the file /user/updateUserInfo of the component HTTP POST Request Handler. The manipulation of the argument nickName leads to cross site scripting. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. The identifier of the patch is c62da9bb3a9b3603014d0edb436146512631100d. It is recommended to apply a patch to fix this issue. The identifier VDB-249201 was assigned to this vulnerability."}, {"lang": "es", "value": "Una vulnerabilidad ha sido encontrada en Novel-Plus hasta 4.2.0 y clasificada como problem\u00e1tica. Una parte desconocida del archivo /user/updateUserInfo del componente HTTP POST Request Handler afecta a una parte desconocida. La manipulaci\u00f3n del argumento nickName conduce a cross site scripting. Es posible iniciar el ataque de forma remota. La explotaci\u00f3n ha sido divulgada al p\u00fablico y puede utilizarse. El identificador del parche es c62da9bb3a9b3603014d0edb436146512631100d. Se recomienda aplicar un parche para solucionar este problema. A esta vulnerabilidad se le asign\u00f3 el identificador VDB-249201."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.0}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:xxyopen:novel-plus:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.2.0", "matchCriteriaId": "87014C48-21C3-4855-9141-8F5FD17B5C0D"}]}]}], "references": [{"url": "https://github.com/201206030/novel-plus/commit/c62da9bb3a9b3603014d0edb436146512631100d", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://github.com/JTZ-a/SRC/blob/master/novel-plus/storedXSS/en-us.md", "source": "cna@vuldb.com", "tags": ["Exploit"]}, {"url": "https://vuldb.com/?ctiid.249201", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory", "VDB Entry"]}, {"url": "https://vuldb.com/?id.249201", "source": "cna@vuldb.com", "tags": ["Third Party Advisory", "VDB Entry"]}]}, "github_commit_url": "https://github.com/201206030/novel-plus/commit/c62da9bb3a9b3603014d0edb436146512631100d"}}