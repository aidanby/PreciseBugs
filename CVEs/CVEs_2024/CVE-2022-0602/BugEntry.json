{"buggy_code": ["<?php\n\nnamespace Admin\\FormWidgets;\n\nuse Admin\\Classes\\BaseFormWidget;\nuse Admin\\Models\\Working_hours_model;\nuse Admin\\Traits\\ValidatesForm;\nuse Admin\\Widgets\\Form;\nuse Igniter\\Flame\\Exception\\ApplicationException;\nuse Igniter\\Flame\\Location\\Models\\AbstractLocation;\nuse Illuminate\\Support\\Facades\\DB;\n\nclass ScheduleEditor extends BaseFormWidget\n{\n    use ValidatesForm;\n\n    /**\n     * @var \\Admin\\Models\\Locations_model Form model object.\n     */\n    public $model;\n\n    public $form;\n\n    public $popupSize = 'modal-lg';\n\n    public $formTitle = 'admin::lang.locations.text_title_schedule';\n\n    protected $availableSchedules = [\n        AbstractLocation::OPENING,\n        AbstractLocation::DELIVERY,\n        AbstractLocation::COLLECTION,\n    ];\n\n    protected $schedulesCache;\n\n    public function initialize()\n    {\n        $this->fillFromConfig([\n            'form',\n        ]);\n    }\n\n    public function render()\n    {\n        $this->prepareVars();\n\n        return $this->makePartial('scheduleeditor/scheduleeditor');\n    }\n\n    public function prepareVars()\n    {\n        $this->vars['field'] = $this->formField;\n        $this->vars['schedules'] = $this->listSchedules();\n    }\n\n    public function loadAssets()\n    {\n        $this->addCss('../../datepicker/assets/vendor/clockpicker/bootstrap-clockpicker.min.css', 'bootstrap-clockpicker-css');\n        $this->addJs('../../datepicker/assets/vendor/clockpicker/bootstrap-clockpicker.min.js', 'bootstrap-clockpicker-js');\n        $this->addCss('../../datepicker/assets/css/clockpicker.css', 'clockpicker-css');\n        $this->addJs('../../datepicker/assets/js/clockpicker.js', 'clockpicker-js');\n\n        $this->addJs('../../recordeditor/assets/js/recordeditor.modal.js', 'recordeditor-modal-js');\n        $this->addJs('vendor/timesheet/timesheet.js', 'timesheet-js');\n        $this->addJs('js/scheduleeditor.js', 'scheduleeditor-js');\n        $this->addCss('vendor/timesheet/timesheet.css', 'timesheet-css');\n        $this->addCss('css/scheduleeditor.css', 'scheduleeditor-css');\n    }\n\n    public function onLoadRecord()\n    {\n        $scheduleCode = post('recordId');\n        $scheduleItem = $this->getSchedule($scheduleCode);\n\n        $formTitle = sprintf(lang($this->formTitle), lang('admin::lang.text_'.$scheduleCode));\n\n        return $this->makePartial('recordeditor/form', [\n            'formRecordId' => $scheduleCode,\n            'formTitle' => $formTitle,\n            'formWidget' => $this->makeScheduleFormWidget($scheduleItem),\n        ]);\n    }\n\n    public function onSaveRecord()\n    {\n        $scheduleCode = post('recordId');\n        $scheduleItem = $this->getSchedule($scheduleCode);\n\n        $form = $this->makeScheduleFormWidget($scheduleItem);\n        $saveData = $form->getSaveData();\n\n        $this->validateFormWidget($form, $saveData);\n\n        DB::transaction(function () use ($scheduleCode, $saveData) {\n            $this->model->updateSchedule($scheduleCode, $saveData);\n\n            // Check overlaps\n            $this->model->newWorkingSchedule($scheduleCode);\n        });\n\n        $formName = sprintf('%s %s', $scheduleCode, lang('admin::lang.locations.text_schedule'));\n        flash()->success(sprintf(lang('admin::lang.alert_success'), ucfirst($formName).' '.'updated'))->now();\n\n        $this->model->reloadRelations();\n        $this->schedulesCache = null;\n\n        $this->prepareVars();\n\n        return [\n            '#notification' => $this->makePartial('flash'),\n            '#'.$this->getId('schedules') => $this->makePartial('scheduleeditor/schedules'),\n        ];\n    }\n\n    protected function getSchedule($scheduleCode)\n    {\n        if (!$schedule = array_get($this->listSchedules(), $scheduleCode))\n            throw new ApplicationException(lang('admin::lang.locations.alert_schedule_not_loaded'));\n\n        return $schedule;\n    }\n\n    protected function listSchedules()\n    {\n        if ($this->schedulesCache)\n            return $this->schedulesCache;\n\n        $schedules = [];\n        foreach ($this->model->availableWorkingTypes() as $scheduleCode) {\n            $schedules[$scheduleCode] = $this->model->createScheduleItem($scheduleCode);\n        }\n\n        return $this->schedulesCache = $schedules;\n    }\n\n    protected function makeScheduleFormWidget($scheduleItem)\n    {\n        $widgetConfig = is_string($this->form) ? $this->loadConfig($this->form, ['form'], 'form') : $this->form;\n        $widgetConfig['model'] = Working_hours_model::make();\n        $widgetConfig['data'] = $scheduleItem;\n        $widgetConfig['alias'] = $this->alias.'FormScheduleEditor';\n        $widgetConfig['arrayName'] = $this->formField->arrayName.'[scheduleData]';\n        $widgetConfig['context'] = 'edit';\n        $widget = $this->makeWidget(Form::class, $widgetConfig);\n\n        $widget->bindToController();\n        $widget->previewMode = $this->previewMode;\n\n        return $widget;\n    }\n}\n", "<div class=\"row\">\n    @foreach ($schedules as $schedule)\n        <div class=\"col-lg-4 py-3\">\n            <div\n                id=\"{{ $this->getId('item-'.$loop->iteration) }}\"\n                class=\"card bg-light shadow-sm mb-0\"\n                data-editor-control=\"load-schedule\"\n                data-schedule-code=\"{{ $schedule->name }}\"\n                role=\"button\"\n            >\n                <div class=\"card-body\">\n                    <div class=\"flex-fill\">\n                        <h5 class=\"card-title\">{{ lang('admin::lang.text_'.$schedule->name).' '.lang('admin::lang.locations.text_schedule') }}</h5>\n                        <p class=\"card-text\">{{ lang('admin::lang.locations.text_'.$schedule->type) }}</p>\n                    </div>\n\n                    <div class=\"pt-3\">\n                        @foreach($schedule->getFormatted() as $value)\n                            <div class=\"d-flex pb-2\">\n                                <div class=\"col-5 p-0 text-muted\">{{ $value->day }}</div>\n                                <div class=\"col-7 p-0 text-right text-nowrap text-truncate\">\n                                    <span title=\"{{ $value->hours }}\">{{ $value->hours }}</span>\n                                </div>\n                            </div>\n                        @endforeach\n                    </div>\n                </div>\n            </div>\n        </div>\n    @endforeach\n</div>\n", "<div\n    class=\"components-item\"\n    data-control=\"component\"\n    data-component-alias=\"{{ $component->alias }}\"\n>\n    <div class=\"btn btn-light text-left p-3 component{{ $component->fatalError ? ' border-danger' : '' }}\">\n        <div\n            class=\"components-item-info\"\n            data-component-control=\"load\"\n            data-component-context=\"edit\"\n        >\n            <span class=\"d-block mb-1\"><b>@lang($component->name)</b></span>\n            <p class=\"text-muted text-sm mb-0\">{{ $component->description ? lang($component->description) : '' }}</p>\n            @if ($component->fatalError)\n                <p class=\"text-danger text-sm mb-0\">{{ $component->fatalError }}</p>\n            @endif\n        </div>\n        <div class=\"components-item-action\">\n            <a\n                role=\"button\"\n                class=\"partial btn btn-light btn-sm mr-1\"\n                data-component-control=\"load\"\n                data-component-context=\"partial\"\n                title=\"@lang('main::lang.components.button_copy_partial')\"\n            ><i class=\"fa fa-file-alt\"></i></a>\n            <a\n                data-component-control=\"drag\"\n                class=\"handle btn btn-light btn-sm mr-1\"\n                role=\"button\"\n            ><i class=\"fa fa-arrows-alt\"></i></a>\n            <a\n                data-component-control=\"remove\"\n                class=\"remove btn btn-light btn-sm\"\n                role=\"button\"\n                data-prompt=\"@lang('admin::lang.alert_confirm')\"\n                title=\"@lang('main::lang.components.button_delete')\"\n            ><i class=\"fa fa-trash text-danger\"></i></a>\n        </div>\n    </div>\n    <input\n        type=\"hidden\"\n        name=\"{{ $this->formField->getName() }}[]\"\n        value=\"{{ $component->alias }}\"\n    >\n</div>\n", "<?php\n$config['list']['toolbar'] = [\n    'buttons' => [\n        'create' => [\n            'label' => 'lang:admin::lang.button_new',\n            'class' => 'btn btn-primary',\n            'href' => 'mail_templates/create',\n        ],\n        'layouts' => [\n            'label' => 'lang:system::lang.mail_templates.text_layouts',\n            'class' => 'btn btn-default',\n            'href' => 'mail_layouts',\n        ],\n        'partials' => [\n            'label' => 'lang:system::lang.mail_templates.text_partials',\n            'class' => 'btn btn-default',\n            'href' => 'mail_partials',\n        ],\n    ],\n];\n\n$config['list']['bulkActions'] = [\n    'delete' => [\n        'label' => 'lang:admin::lang.button_delete',\n        'class' => 'btn btn-light text-danger',\n        'data-request-confirm' => 'lang:admin::lang.alert_warning_confirm',\n    ],\n];\n\n$config['list']['columns'] = [\n    'edit' => [\n        'type' => 'button',\n        'iconCssClass' => 'fa fa-pencil',\n        'attributes' => [\n            'class' => 'btn btn-edit',\n            'href' => 'mail_templates/edit/{template_id}',\n        ],\n    ],\n    'title' => [\n        'label' => 'lang:system::lang.mail_templates.column_title',\n        'type' => 'text',\n        'searchable' => TRUE,\n        'sortable' => FALSE,\n    ],\n    'code' => [\n        'label' => 'lang:system::lang.mail_templates.column_code',\n        'type' => 'text',\n        'searchable' => TRUE,\n    ],\n    'layout_id' => [\n        'label' => 'lang:system::lang.mail_templates.column_layout',\n        'relation' => 'layout',\n        'valueFrom' => 'name',\n        'sortable' => FALSE,\n    ],\n    'updated_at' => [\n        'label' => 'lang:admin::lang.column_date_updated',\n        'type' => 'timetense',\n        'searchable' => TRUE,\n    ],\n    'created_at' => [\n        'label' => 'lang:admin::lang.column_date_added',\n        'type' => 'timetense',\n        'searchable' => TRUE,\n    ],\n    'template_id' => [\n        'label' => 'lang:admin::lang.column_id',\n        'invisible' => TRUE,\n    ],\n];\n\n$config['form']['toolbar'] = [\n    'buttons' => [\n        'back' => [\n            'label' => 'lang:admin::lang.button_icon_back',\n            'class' => 'btn btn-default',\n            'href' => 'mail_templates',\n        ],\n        'save' => [\n            'label' => 'lang:admin::lang.button_save',\n            'context' => ['create', 'edit'],\n            'partial' => 'form/toolbar_save_button',\n            'class' => 'btn btn-primary',\n            'data-request' => 'onSave',\n            'data-progress-indicator' => 'admin::lang.text_saving',\n        ],\n        'delete' => [\n            'label' => 'lang:admin::lang.button_icon_delete',\n            'class' => 'btn btn-danger',\n            'data-request' => 'onDelete',\n            'data-request-data' => \"_method:'DELETE'\",\n            'data-request-confirm' => 'lang:admin::lang.alert_warning_confirm',\n            'data-progress-indicator' => 'admin::lang.text_deleting',\n            'context' => 'edit',\n        ],\n        'test_message' => [\n            'label' => 'lang:system::lang.mail_templates.button_test_message',\n            'class' => 'btn btn-default',\n            'data-request' => 'onTestTemplate',\n            'context' => 'edit',\n        ],\n    ],\n];\n\n$config['form']['fields'] = [\n    'code' => [\n        'label' => 'lang:system::lang.mail_templates.label_code',\n        'span' => 'left',\n        'type' => 'text',\n    ],\n    'label' => [\n        'label' => 'lang:admin::lang.label_description',\n        'span' => 'right',\n        'valueFrom' => 'title',\n        'type' => 'text',\n    ],\n    'subject' => [\n        'label' => 'lang:system::lang.mail_templates.label_subject',\n        'span' => 'left',\n        'type' => 'text',\n    ],\n    'layout_id' => [\n        'label' => 'lang:system::lang.mail_templates.label_layout',\n        'span' => 'right',\n        'type' => 'relation',\n        'relationFrom' => 'layout',\n        'placeholder' => 'lang:admin::lang.text_please_select',\n    ],\n];\n\n$config['form']['tabs'] = [\n    'fields' => [\n        'body' => [\n            'tab' => 'lang:system::lang.mail_templates.label_markdown',\n            'type' => 'markdowneditor',\n        ],\n        'plain_body' => [\n            'tab' => 'lang:system::lang.mail_templates.label_plain',\n            'type' => 'textarea',\n            'attributes' => [\n                'rows' => 10,\n            ],\n        ],\n    ],\n];\n\nreturn $config;\n"], "fixing_code": ["<?php\n\nnamespace Admin\\FormWidgets;\n\nuse Admin\\Classes\\BaseFormWidget;\nuse Admin\\Models\\Locations_model;\nuse Admin\\Models\\Working_hours_model;\nuse Admin\\Traits\\ValidatesForm;\nuse Admin\\Widgets\\Form;\nuse Igniter\\Flame\\Exception\\ApplicationException;\nuse Igniter\\Flame\\Location\\Models\\AbstractLocation;\nuse Igniter\\Flame\\Location\\OrderTypes;\nuse Illuminate\\Support\\Facades\\DB;\n\nclass ScheduleEditor extends BaseFormWidget\n{\n    use ValidatesForm;\n\n    /**\n     * @var \\Admin\\Models\\Locations_model Form model object.\n     */\n    public $model;\n\n    public $form;\n\n    public $popupSize = 'modal-lg';\n\n    public $formTitle = 'admin::lang.locations.text_title_schedule';\n\n    protected $availableSchedules = [\n        AbstractLocation::OPENING,\n        AbstractLocation::DELIVERY,\n        AbstractLocation::COLLECTION,\n    ];\n\n    protected $schedulesCache;\n\n    public function initialize()\n    {\n        $this->fillFromConfig([\n            'form',\n        ]);\n    }\n\n    public function render()\n    {\n        $this->prepareVars();\n\n        return $this->makePartial('scheduleeditor/scheduleeditor');\n    }\n\n    public function prepareVars()\n    {\n        $this->vars['field'] = $this->formField;\n        $this->vars['schedules'] = $this->listSchedules();\n    }\n\n    public function loadAssets()\n    {\n        $this->addCss('../../datepicker/assets/vendor/clockpicker/bootstrap-clockpicker.min.css', 'bootstrap-clockpicker-css');\n        $this->addJs('../../datepicker/assets/vendor/clockpicker/bootstrap-clockpicker.min.js', 'bootstrap-clockpicker-js');\n        $this->addCss('../../datepicker/assets/css/clockpicker.css', 'clockpicker-css');\n        $this->addJs('../../datepicker/assets/js/clockpicker.js', 'clockpicker-js');\n\n        $this->addJs('../../recordeditor/assets/js/recordeditor.modal.js', 'recordeditor-modal-js');\n        $this->addJs('vendor/timesheet/timesheet.js', 'timesheet-js');\n        $this->addJs('js/scheduleeditor.js', 'scheduleeditor-js');\n        $this->addCss('vendor/timesheet/timesheet.css', 'timesheet-css');\n        $this->addCss('css/scheduleeditor.css', 'scheduleeditor-css');\n    }\n\n    public function onLoadRecord()\n    {\n        $scheduleCode = post('recordId');\n        $scheduleItem = $this->getSchedule($scheduleCode);\n\n        $formTitle = sprintf(lang($this->formTitle), lang($scheduleItem->name));\n\n        return $this->makePartial('recordeditor/form', [\n            'formRecordId' => $scheduleCode,\n            'formTitle' => $formTitle,\n            'formWidget' => $this->makeScheduleFormWidget($scheduleItem),\n        ]);\n    }\n\n    public function onSaveRecord()\n    {\n        $scheduleCode = post('recordId');\n        $scheduleItem = $this->getSchedule($scheduleCode);\n\n        $form = $this->makeScheduleFormWidget($scheduleItem);\n        $saveData = $form->getSaveData();\n\n        $this->validateFormWidget($form, $saveData);\n\n        DB::transaction(function () use ($scheduleCode, $saveData) {\n            $this->model->updateSchedule($scheduleCode, $saveData);\n\n            // Check overlaps\n            $this->model->newWorkingSchedule($scheduleCode);\n        });\n\n        $formName = sprintf('%s %s', $scheduleCode, lang('admin::lang.locations.text_schedule'));\n        flash()->success(sprintf(lang('admin::lang.alert_success'), ucfirst($formName).' '.'updated'))->now();\n\n        $this->model->reloadRelations();\n        $this->schedulesCache = null;\n\n        $this->prepareVars();\n\n        return [\n            '#notification' => $this->makePartial('flash'),\n            '#'.$this->getId('schedules') => $this->makePartial('scheduleeditor/schedules'),\n        ];\n    }\n\n    protected function getSchedule($scheduleCode)\n    {\n        if (!$schedule = array_get($this->listSchedules(), $scheduleCode))\n            throw new ApplicationException(lang('admin::lang.locations.alert_schedule_not_loaded'));\n\n        return $schedule;\n    }\n\n    protected function listSchedules()\n    {\n        if ($this->schedulesCache)\n            return $this->schedulesCache;\n\n        $schedules = collect(OrderTypes::instance()->listOrderTypes())\n            ->prepend(['name' => 'admin::lang.text_opening'], Locations_model::OPENING)\n            ->mapWithKeys(function ($definition, $code) {\n                $scheduleItem = $this->model->createScheduleItem($code);\n                $scheduleItem->name = array_get($definition, 'name');\n\n                return [$code => $scheduleItem];\n            })\n            ->all();\n\n        return $this->schedulesCache = $schedules;\n    }\n\n    protected function makeScheduleFormWidget($scheduleItem)\n    {\n        $widgetConfig = is_string($this->form) ? $this->loadConfig($this->form, ['form'], 'form') : $this->form;\n        $widgetConfig['model'] = Working_hours_model::make();\n        $widgetConfig['data'] = $scheduleItem;\n        $widgetConfig['alias'] = $this->alias.'FormScheduleEditor';\n        $widgetConfig['arrayName'] = $this->formField->arrayName.'[scheduleData]';\n        $widgetConfig['context'] = 'edit';\n        $widget = $this->makeWidget(Form::class, $widgetConfig);\n\n        $widget->bindToController();\n        $widget->previewMode = $this->previewMode;\n\n        return $widget;\n    }\n}\n", "<div class=\"d-flex flex-nowrap overflow-auto\">\n    @foreach ($schedules as $scheduleCode => $schedule)\n        <div class=\"col-lg-3 {{ $loop->first ? 'py-2 pr-2 pl-0' : 'p-2' }}\">\n            <div\n                id=\"{{ $this->getId('item-'.$loop->iteration) }}\"\n                class=\"card bg-light shadow-sm mb-0\"\n                data-editor-control=\"load-schedule\"\n                data-schedule-code=\"{{ $scheduleCode }}\"\n                role=\"button\"\n            >\n                <div class=\"card-body\">\n                    <div class=\"flex-fill\">\n                        <h5 class=\"card-title\">{{ lang($schedule->name).' '.lang('admin::lang.locations.text_schedule') }}</h5>\n                        <p class=\"card-text\">{{ lang('admin::lang.locations.text_'.$schedule->type) }}</p>\n                    </div>\n\n                    <div class=\"pt-3\">\n                        @foreach($schedule->getFormatted() as $value)\n                            <div class=\"d-flex pb-2\">\n                                <div class=\"col-5 p-0 text-muted\">{{ $value->day }}</div>\n                                <div class=\"col-7 p-0 text-right text-nowrap text-truncate\">\n                                    <span title=\"{{ $value->hours }}\">{{ $value->hours }}</span>\n                                </div>\n                            </div>\n                        @endforeach\n                    </div>\n                </div>\n            </div>\n        </div>\n    @endforeach\n</div>\n", "<div\n    class=\"components-item\"\n    data-control=\"component\"\n    data-component-alias=\"{{ $component->alias }}\"\n>\n    <div class=\"btn btn-light text-left p-3 w-100 component{{ $component->fatalError ? ' border-danger' : '' }}\">\n        <div\n            class=\"components-item-info\"\n            data-component-control=\"load\"\n            data-component-context=\"edit\"\n        >\n            <span class=\"d-block mb-1\"><b>@lang($component->name)</b></span>\n            <p class=\"text-muted text-sm mb-0\">{{ $component->description ? lang($component->description) : '' }}</p>\n            @if ($component->fatalError)\n                <p class=\"text-danger text-sm mb-0\">{{ $component->fatalError }}</p>\n            @endif\n        </div>\n        <div class=\"components-item-action\">\n            <a\n                role=\"button\"\n                class=\"partial btn btn-light btn-sm mr-1\"\n                data-component-control=\"load\"\n                data-component-context=\"partial\"\n                title=\"@lang('main::lang.components.button_copy_partial')\"\n            ><i class=\"fa fa-file-alt\"></i></a>\n            <a\n                data-component-control=\"drag\"\n                class=\"handle btn btn-light btn-sm mr-1\"\n                role=\"button\"\n            ><i class=\"fa fa-arrows-alt\"></i></a>\n            <a\n                data-component-control=\"remove\"\n                class=\"remove btn btn-light btn-sm\"\n                role=\"button\"\n                data-prompt=\"@lang('admin::lang.alert_confirm')\"\n                title=\"@lang('main::lang.components.button_delete')\"\n            ><i class=\"fa fa-trash text-danger\"></i></a>\n        </div>\n    </div>\n    <input\n        type=\"hidden\"\n        name=\"{{ $this->formField->getName() }}[]\"\n        value=\"{{ $component->alias }}\"\n    >\n</div>\n", "<?php\n$config['list']['toolbar'] = [\n    'buttons' => [\n        'create' => [\n            'label' => 'lang:admin::lang.button_new',\n            'class' => 'btn btn-primary',\n            'href' => 'mail_templates/create',\n        ],\n        'layouts' => [\n            'label' => 'lang:system::lang.mail_templates.text_layouts',\n            'class' => 'btn btn-default',\n            'href' => 'mail_layouts',\n        ],\n        'partials' => [\n            'label' => 'lang:system::lang.mail_templates.text_partials',\n            'class' => 'btn btn-default',\n            'href' => 'mail_partials',\n        ],\n    ],\n];\n\n$config['list']['bulkActions'] = [\n    'delete' => [\n        'label' => 'lang:admin::lang.button_delete',\n        'class' => 'btn btn-light text-danger',\n        'data-request-confirm' => 'lang:admin::lang.alert_warning_confirm',\n    ],\n];\n\n$config['list']['columns'] = [\n    'edit' => [\n        'type' => 'button',\n        'iconCssClass' => 'fa fa-pencil',\n        'attributes' => [\n            'class' => 'btn btn-edit',\n            'href' => 'mail_templates/edit/{template_id}',\n        ],\n    ],\n    'title' => [\n        'label' => 'lang:system::lang.mail_templates.column_title',\n        'type' => 'text',\n        'searchable' => TRUE,\n        'sortable' => FALSE,\n    ],\n    'code' => [\n        'label' => 'lang:system::lang.mail_templates.column_code',\n        'type' => 'text',\n        'searchable' => TRUE,\n    ],\n    'layout_id' => [\n        'label' => 'lang:system::lang.mail_templates.column_layout',\n        'relation' => 'layout',\n        'valueFrom' => 'name',\n        'sortable' => FALSE,\n    ],\n    'updated_at' => [\n        'label' => 'lang:admin::lang.column_date_updated',\n        'type' => 'timetense',\n        'searchable' => TRUE,\n    ],\n    'created_at' => [\n        'label' => 'lang:admin::lang.column_date_added',\n        'type' => 'timetense',\n        'searchable' => TRUE,\n        'invisible' => TRUE,\n    ],\n    'template_id' => [\n        'label' => 'lang:admin::lang.column_id',\n        'invisible' => TRUE,\n    ],\n];\n\n$config['form']['toolbar'] = [\n    'buttons' => [\n        'back' => [\n            'label' => 'lang:admin::lang.button_icon_back',\n            'class' => 'btn btn-default',\n            'href' => 'mail_templates',\n        ],\n        'save' => [\n            'label' => 'lang:admin::lang.button_save',\n            'context' => ['create', 'edit'],\n            'partial' => 'form/toolbar_save_button',\n            'class' => 'btn btn-primary',\n            'data-request' => 'onSave',\n            'data-progress-indicator' => 'admin::lang.text_saving',\n        ],\n        'delete' => [\n            'label' => 'lang:admin::lang.button_icon_delete',\n            'class' => 'btn btn-danger',\n            'data-request' => 'onDelete',\n            'data-request-data' => \"_method:'DELETE'\",\n            'data-request-confirm' => 'lang:admin::lang.alert_warning_confirm',\n            'data-progress-indicator' => 'admin::lang.text_deleting',\n            'context' => 'edit',\n        ],\n        'test_message' => [\n            'label' => 'lang:system::lang.mail_templates.button_test_message',\n            'class' => 'btn btn-default',\n            'data-request' => 'onTestTemplate',\n            'context' => 'edit',\n        ],\n    ],\n];\n\n$config['form']['fields'] = [\n    'code' => [\n        'label' => 'lang:system::lang.mail_templates.label_code',\n        'span' => 'left',\n        'type' => 'text',\n    ],\n    'label' => [\n        'label' => 'lang:admin::lang.label_description',\n        'span' => 'right',\n        'valueFrom' => 'title',\n        'type' => 'text',\n    ],\n    'subject' => [\n        'label' => 'lang:system::lang.mail_templates.label_subject',\n        'span' => 'left',\n        'type' => 'text',\n    ],\n    'layout_id' => [\n        'label' => 'lang:system::lang.mail_templates.label_layout',\n        'span' => 'right',\n        'type' => 'relation',\n        'relationFrom' => 'layout',\n        'placeholder' => 'lang:admin::lang.text_please_select',\n    ],\n];\n\n$config['form']['tabs'] = [\n    'fields' => [\n        'body' => [\n            'tab' => 'lang:system::lang.mail_templates.label_markdown',\n            'type' => 'markdowneditor',\n        ],\n        'plain_body' => [\n            'tab' => 'lang:system::lang.mail_templates.label_plain',\n            'type' => 'textarea',\n            'attributes' => [\n                'rows' => 10,\n            ],\n        ],\n    ],\n];\n\nreturn $config;\n"], "filenames": ["app/admin/formwidgets/ScheduleEditor.php", "app/admin/formwidgets/scheduleeditor/schedules.blade.php", "app/main/formwidgets/components/component.blade.php", "app/system/models/config/mail_templates_model.php"], "buggy_code_start_loc": [5, 1, 6, 64], "buggy_code_end_loc": [132, 14, 7, 64], "fixing_code_start_loc": [6, 1, 6, 65], "fixing_code_end_loc": [139, 14, 7, 66], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - DOM in GitHub repository tastyigniter/tastyigniter prior to 3.3.0.", "other": {"cve": {"id": "CVE-2022-0602", "sourceIdentifier": "security@huntr.dev", "published": "2022-04-05T16:15:13.517", "lastModified": "2022-04-12T19:35:42.283", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - DOM in GitHub repository tastyigniter/tastyigniter prior to 3.3.0."}, {"lang": "es", "value": "Una vulnerabilidad de tipo Cross-site Scripting (XSS) - DOM en el repositorio GitHub tastyigniter/tastyigniter versiones anteriores a 3.3.0"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 7.4, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.1, "impactScore": 3.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:tastyigniter:tastyigniter:*:*:*:*:*:*:*:*", "versionEndExcluding": "3.3.0", "matchCriteriaId": "FADE0817-CBF1-4B2D-AF14-C0A9D87DE6A2"}]}]}], "references": [{"url": "https://github.com/tastyigniter/tastyigniter/commit/992d4ce6444805c3132e3635a01b6fd222063554", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/615f1788-d474-4580-b0ef-5edd50274010", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/tastyigniter/tastyigniter/commit/992d4ce6444805c3132e3635a01b6fd222063554"}}