{"buggy_code": ["package org.dstadler.jgit.porcelain;\n\n/*\n   Copyright 2013, 2014 Dominik Stadler\n\n   Licensed under the Apache License, Version 2.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n     http://www.apache.org/licenses/LICENSE-2.0\n\n   Unless required by applicable law or agreed to in writing, software\n   distributed under the License is distributed on an \"AS IS\" BASIS,\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   See the License for the specific language governing permissions and\n   limitations under the License.\n */\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.util.Set;\n\nimport org.apache.commons.io.FileUtils;\nimport org.dstadler.jgit.helper.CookbookHelper;\nimport org.eclipse.jgit.api.Git;\nimport org.eclipse.jgit.api.errors.GitAPIException;\nimport org.eclipse.jgit.lib.Repository;\n\n\n\n/**\n * Simple snippet which shows how to list all Tags\n *\n * @author dominik.stadler at gmx.at\n */\npublic class CleanUntrackedFiles {\n\n    public static void main(String[] args) throws IOException, GitAPIException {\n        final File localPath;\n        try (Repository repository = CookbookHelper.createNewRepository()) {\n            localPath = repository.getWorkTree();\n\n            System.out.println(\"Repository at \" + repository.getWorkTree());\n\n            File untrackedFile = File.createTempFile(\"untracked\", \".txt\", repository.getWorkTree());\n            File untrackedDir = File.createTempFile(\"untrackedDir\", \"\", repository.getWorkTree());\n            if(!untrackedDir.delete()) {\n                throw new IOException(\"Could not delete file \" + untrackedDir);\n            }\n            if(!untrackedDir.mkdirs()) {\n                throw new IOException(\"Could not create directory \" + untrackedDir);\n            }\n\n            System.out.println(\"Untracked exists: \" + untrackedFile.exists() + \" Dir: \" + untrackedDir.exists() + \"/\" + untrackedDir.isDirectory());\n\n            try (Git git = new Git(repository)) {\n                Set<String> removed = git.clean().setCleanDirectories(true).call();\n                for(String item : removed) {\n                \tSystem.out.println(\"Removed: \" + item);\n                }\n                System.out.println(\"Removed \" + removed.size() + \" items\");\n            }\n\n            System.out.println(\"Untracked after: \" + untrackedFile.exists() + \" Dir: \" + untrackedDir.exists() + \"/\" + untrackedDir.isDirectory());\n        }\n\n        // clean up here to not keep using more and more disk-space for these samples\n        FileUtils.deleteDirectory(localPath);\n    }\n}\n"], "fixing_code": ["package org.dstadler.jgit.porcelain;\n\n/*\n   Copyright 2013, 2014 Dominik Stadler\n\n   Licensed under the Apache License, Version 2.0 (the \"License\");\n   you may not use this file except in compliance with the License.\n   You may obtain a copy of the License at\n\n     http://www.apache.org/licenses/LICENSE-2.0\n\n   Unless required by applicable law or agreed to in writing, software\n   distributed under the License is distributed on an \"AS IS\" BASIS,\n   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n   See the License for the specific language governing permissions and\n   limitations under the License.\n */\n\nimport java.io.File;\nimport java.io.IOException;\nimport java.nio.file.Files;\nimport java.util.Set;\n\nimport org.apache.commons.io.FileUtils;\nimport org.dstadler.jgit.helper.CookbookHelper;\nimport org.eclipse.jgit.api.Git;\nimport org.eclipse.jgit.api.errors.GitAPIException;\nimport org.eclipse.jgit.lib.Repository;\n\n\n/**\n * Simple snippet which shows how to list all Tags\n *\n * @author dominik.stadler at gmx.at\n */\npublic class CleanUntrackedFiles {\n\n    public static void main(String[] args) throws IOException, GitAPIException {\n        final File localPath;\n        try (Repository repository = CookbookHelper.createNewRepository()) {\n            localPath = repository.getWorkTree();\n\n            System.out.println(\"Repository at \" + repository.getWorkTree());\n\n            File untrackedFile = File.createTempFile(\"untracked\", \".txt\", repository.getWorkTree());\n            File untrackedDir = Files.createTempDirectory(repository.getWorkTree().toPath(), \"untrackedDir\").toFile();\n\n            System.out.println(\"Untracked exists: \" + untrackedFile.exists() + \" Dir: \" + untrackedDir.exists() + \"/\" + untrackedDir.isDirectory());\n\n            try (Git git = new Git(repository)) {\n                Set<String> removed = git.clean().setCleanDirectories(true).call();\n                for(String item : removed) {\n                \tSystem.out.println(\"Removed: \" + item);\n                }\n                System.out.println(\"Removed \" + removed.size() + \" items\");\n            }\n\n            System.out.println(\"Untracked after: \" + untrackedFile.exists() + \" Dir: \" + untrackedDir.exists() + \"/\" + untrackedDir.isDirectory());\n        }\n\n        // clean up here to not keep using more and more disk-space for these samples\n        FileUtils.deleteDirectory(localPath);\n    }\n}\n"], "filenames": ["src/main/java/org/dstadler/jgit/porcelain/CleanUntrackedFiles.java"], "buggy_code_start_loc": [20], "buggy_code_end_loc": [53], "fixing_code_start_loc": [21], "fixing_code_end_loc": [47], "type": "CWE-668", "message": "A vulnerability was found in centic9 jgit-cookbook. It has been declared as problematic. This vulnerability affects unknown code. The manipulation leads to insecure temporary file. The attack can be initiated remotely. The name of the patch is b8cb29b43dc704708d598c60ac1881db7cf8e9c3. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-216988.", "other": {"cve": {"id": "CVE-2022-4817", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-28T19:15:09.370", "lastModified": "2023-01-06T18:43:46.087", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in centic9 jgit-cookbook. It has been declared as problematic. This vulnerability affects unknown code. The manipulation leads to insecure temporary file. The attack can be initiated remotely. The name of the patch is b8cb29b43dc704708d598c60ac1881db7cf8e9c3. It is recommended to apply a patch to fix this issue. The identifier of this vulnerability is VDB-216988."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.1, "baseSeverity": "LOW"}, "exploitabilityScore": 1.6, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-668"}]}, {"source": "cna@vuldb.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-377"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:jgit-cookbook_project:jgit-cookbook:*:*:*:*:*:*:*:*", "versionEndExcluding": "2022-08-09", "matchCriteriaId": "D9EA7B91-B449-4C5A-8378-46BB40B0FEB3"}]}]}], "references": [{"url": "https://github.com/centic9/jgit-cookbook/commit/b8cb29b43dc704708d598c60ac1881db7cf8e9c3", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/centic9/jgit-cookbook/pull/86", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.216988", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.216988", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/centic9/jgit-cookbook/commit/b8cb29b43dc704708d598c60ac1881db7cf8e9c3"}}