{"buggy_code": ["Revision history\n=====================================\n\n[![Build Status](https://travis-ci.org/mosbth/cimage.svg?branch=master)](https://travis-ci.org/mosbth/cimage)\n[![Build Status](https://scrutinizer-ci.com/g/mosbth/cimage/badges/build.png?b=master)](https://scrutinizer-ci.com/g/mosbth/cimage/build-status/master)\n\n\nv0.7.19* (2016-08-11)\n-------------------------------------\n\n* Composer suggests ext-imagick and ext-curl.\n\n\nv0.7.18 (2016-08-09)\n-------------------------------------\n\n* Made `&lossless` a requirement to not use the original image.\n\n\nv0.7.17 (2016-08-09)\n-------------------------------------\n\n* Made `&lossless` part of the generated cache filename.\n\n\nv0.7.16 (2016-08-09)\n-------------------------------------\n\n* Fix default mode to be production.\n* Added pngquant as extra postprocessing utility for PNG-images, #154.\n* Bug `&status` wrong variable name for fast track cache.\n\n\nv0.7.15 (2016-08-09)\n-------------------------------------\n\n* Added the [Lenna/Lena sample image](http://www.cs.cmu.edu/~chuck/lennapg/) as tif and created a png, jpeg and webp version using Imagick convert `convert lena.tif lena.{png,jpg,webp}`, #152.\n* Limited and basic support for WEBP format, se #132.\n\n\nv0.7.14 (2016-08-08)\n-------------------------------------\n\n* Re-add removed cache directory.\n* Make fast track cache disabled by default in the config file.\n\n\nv0.7.13 (2016-08-08)\n-------------------------------------\n\n* Moved functions from img.php to `functions.php`.\n* Added function `trace()` to measure speed and memory consumption, only for development.\n* Added fast cache #149.\n* Added `imgf.php` as shortcut to check for fast cache, before loading `img.php` as usual, adding `imgf_config.php` as symlink to `img_config.php`.\n* Created `defines.php` and moved definition av version there.\n* Fixed images in README, #148.\n* Initiated dependency injection to `CImage`, class names can be set in config file and will be injected to `CImage` from `img.php`. Not implemented for all classes. #151.\n* Enabled debug mode to make it easier to trace what actually happens while processing the image, #150.\n\n\nv0.7.12 (2016-06-01)\n-------------------------------------\n\n* Fixed to correctly display image when using a resize strategy without height or width.\n* Fixed background color for option `no-upscale`, #144.\n\n\nv0.7.11 (2016-04-18)\n-------------------------------------\n\n* Add option for `skip_original` to config file to always skip original, #118.\n\n\nv0.7.10 (2016-04-01)\n-------------------------------------\n\n* Add backup option for images `src-alt`, #141.\n* Add require of ext-gd in composer.json, #133.\n* Fix strict mode only reporting 404 when failure, #127.\n\n\nv0.7.9 (2015-12-07)\n-------------------------------------\n\n* Strict mode only reporting 404 when failure, #127.\n* Added correct CImage version to remote agent string, #131.\n* Adding CCache to improve cache handling of caching for dummy, remote and srgb. #130.\n\n\nv0.7.8 (2015-12-06)\n-------------------------------------\n\n* HTTP error messages now 403, 404 and 500 as in #128 and #127.\n* More examples on dealing with cache through bash `bin/cache.bash`, #129.\n* Added conversion to sRGB using option `?srgb`. #120. \n* Added Gitter badge to README, #126.\n* Fix proper download url in README, #125.\n* Change path in `webroot/htaccess` to make it work in current environment.\n\n\nv0.7.7 (2015-10-21)\n-------------------------------------\n\n* One can now add a HTTP header for Cache-Control in the config file, #109.\n* Added hook in img,php before CImage is called, #123.\n* Added configuration for default jpeg quality and png compression in the config file, #107. \n* Strip comments and whitespace in imgs.php, #115.\n* Bundle imgs.php did not have the correct mode.\n* Adding option &status to get an overview of the installed on configured utilities, #116.\n* Bug, all files saved as png-files, when not saving as specific file. \n* Removed saving filename extension for alias images.\n* Added option to decide if resample or resize when copying images internally. `&no-resample` makes resize, instead of resample as is default.\n* Verbose now correctly states if transparent color is detected.\n* Compare-tool now supports 6 images.\n* Added option for dark background in the compare-tool.\n* Removed that source png-files, containing less than 255 colors, is always saved as palette images since this migth depend on processing of the image.\n* Adding save-as as part of the generated cache filename, #121.\n* Add extra fields to json-response, #114.\n* Add header for Content-Length, #111.\n* Add check for postprocessing tools in path in `webroot/check_system.php`, #104.\n\n\nv0.7.6 (2015-10-18)\n-------------------------------------\n\n* Adding testpage for dummy images `webroot/test/test_issue101-dummy.php`.\n* Adding width and height when creating dummy image.\n\n\nv0.7.5 (2015-10-18)\n-------------------------------------\n\n* Adding feature for creating dummy images `src=dummy`, #101.\n* Add png compression to generated cache filename, fix #103.\n* Removed file prefix from storing images in cache, breaking filenamestructure for cache images.\n* Code cleaning in `CImage.php`.\n\n\nv0.7.4 (2015-09-15)\n-------------------------------------\n\n* Add CAsciiArt.php to composer for autoloading, fix #102.\n* Generate filename with filters, does not work on Windows, fix #100.\n\n\nv0.7.3 (2015-09-01)\n-------------------------------------\n\n* Support output of ascii images, #67.\n\n\nv0.7.2 (2015-08-17)\n-------------------------------------\n\n* Allow space in remote filenames, fix #98.\n\n\nv0.7.1 (2015-07-25)\n-------------------------------------\n\n* Support for password hashes using `text`, `md5` and `hash`, fix #77.\n* Using `CWhitelist` for checking hotlinking to images, fix #88.\n* Added mode for `test` which enables logging verbose mode to file, fix #97.\n* Improved codestyle and added `phpcs.xml` to start using phpcs to check code style, fix #95.\n* Adding `composer.json` for publishing on packagist. \n* Add permalink to setup for comparing images with `webroot/compare/compare.php`, fix #92.\n* Allow space in filename by using `urlencode()` and allow space as valid filenam character. fix #91.\n* Support redirections for remote images, fix #87, fix #90. \n* Improving usage of Travis and Scrutinizer.\n* Naming cache-file using md5 for remote images, fix #86.\n* Loading images without depending on filename extension, fix #85.\n* Adding unittest with phpunit #84, fix #13 \n* Adding support for whitelist of remote hostnames, #84\n* Adding phpdoc, fix #48.\n* Adding travis, fix #15.\n* Adding scrutinizer, fix #57.\n\n\nv0.7.0 (2015-02-10)\n-------------------------------------\n\n* Always use password, setting in img_config.php, fix #78.\n* Resize gif keeping transparency #81.\n* Now returns statuscode 500 when something fails #55.\n* Three different modes: strict, production, development #44.\n* Three files for all-in-one `imgs.php`, `imgp.php`, `imgd.php` #73.\n* Change name of script all-in-one to `webroot/imgs.php` #73.\n* Combine all code into one singel script, `webroot/img_single.php` #73.\n* Disallow hotlinking/leeching by configuration #46.\n* Alias-name is without extension #47.\n* Option `alias` now requires `password` to work #47.\n* Support for option `password, pwd` to protect usage of `alias` and remote download.\n* Added support for option `alias` that creates a link to a cached version  of the image #47.\n* Create cache directory for remote download if it does not exists.\n* Cleaned up `img_config.php` and introduced default values for almost all options #72.\n\n\nv0.6.2 (2015-01-14)\n-------------------------------------\n\n* Added support for download of remote images #43.\n* Added autoloader.\n\n\nv0.6.1 (2015-01-08)\n-------------------------------------\n\n* Adding compare-page for comparing images. Issue #20.\n* Added option `no-upscale, nu` as resizing strategy to decline upscaling of smaller images. Fix #61.\n* Minor change in `CImage::resize()`, crop now does imagecopy without resamling.\n* Correcting internal details for save-as and response json which indicated wrong colors. Fix #62.\n* Fixed fill-to-fit that failed when using aspect-ratio. Fix #52.\n* JSON returns correct values for resulting image. Fix #58.\n* Corrected behaviour for skip-original. Fix #60.\n\n\nv0.6 (2014-12-06)\n-------------------------------------\n\n* Rewrote and added documentation.\n* Moved conolution expressesion from `img_config.php` to `CImage`.\n* Minor cleaning of properties in `CImage`. Fix #23.\n* Adding `webroot/htaccess` to show off how friendly urls can be created for `img.php`. Fix #45.\n* Added option `fill-to-fit, ff`. Fix #38.\n* Added option `shortcut, sc` to enable configuration of complex expressions. Fix #2.\n* Added support for custom convolutions. Fix #49.\n* Restructured testprograms. Fix #41.\n* Corrected json on PHP 5.3. Fix #42.\n* Improving template for tests in `webroot/tests` when testing out #40.\n* Adding testcase for #40.\n* Adding option `convolve` taking comma-separated list of 11 float-values, wraps and exposes `imageconvoluttion()`. #4\n* Adding option `dpr, device-pixel-ratio` which defaults to 1. Set to 2 to get a twice as large image. Useful for Retina displays. Basically a shortcut to enlarge the image.\n* Adding utility `cache.bash` to ease gathering stats on cache usage. #21\n* Cache-directory can now be readonly and serve all cached files, still failing when need to save files. #5\n* Cache now uses same file extension as original image #37.\n* Can output image as json format using `json` #11.\n\n\nv0.5.3 (2014-11-21)\n-------------------------------------\n\n* Support filenames of uppercase JPEG, JPG, PNG and GIF, as proposed in #37.\n* Changing `CImage::output()` as proposed in #37.\n* Adding security check that image filename is always below the path `image_path` as specified in `img_config.php` #37.\n* Adding configuration item in `img_config.php` for setting valid characters in image filename.\n* Moving `webroot/test*` into directory `webroot/test`.\n* `webroot/check_system.php` now outputs if extension for exif is loaded.\n* Broke API when `initDimensions()` split into two methods, new `initDimensions()` and `loadImageDetails()`.\n* Added `autoRotate, aro` to auto rotate image based on EXIF information.\n* Added `bgColor, bgc` to use as backgroundcolor when needing a filler color, for example rotate 45.\n* Added `rotateBefore, rb` to rotate image a certain angle before processing.\n* Added `rotateAfter, ra` to rotate image a certain angle after processing.\n* Cleaned up code formatting, removed trailing spaces.\n* Removed @ from opening images, better to display correct warning when failing #34, but put it back again.\n* Setting gd.jpeg_ignore_warning to true as default #34.\n* `webroot/check_system.php` now outputs version of PHP and GD.\n* #32 correctly send 404 header when serving an error message.\n* Trying to verify issue #29, but can not.\n* Adding structure for testprograms together with, use `webroot/test_issue29.php` as sample.\n* Improving code formatting.\n* Moving parts of verbose output from img.php to CImage.php.\n\n\nv0.5.2 (2014-04-01)\n-------------------------------------\n\n* Correcting issue #26 providing error message when not using postprocessing.\n* Correcting issue #27 warning of default timezone.\n* Removed default $config options in `img.php`, was not used, all configuration should be in `img_config.php`.\n* Verified known bug - sharpen acts as blur in PHP 5.5.9 and 5.5.10 #28\n\n\nv0.5.1 (2014-02-12)\n-------------------------------------\n\n* Display image in README-file.\n* Create an empty `cache` directory as part of repo.\n\n\nv0.5 (2014-02-12)\n-------------------------------------\n\n* Change constant name `CImage::PNG_QUALITY_DEFAULT` to `CImage::PNG_COMPRESSION_DEFAULT`.\n* Split JPEG quality and PNG compression, `CImage->quality` and `CImage->compression`\n* Changed `img.php` parameter name `d, deflate` to `co, compress`.\n* Separating configuration issues from `img.php` to `img_config.php`.\n* Format code according to PSR-2.\n* Disabled post-processing JPEG and PNG as default.\n* This version is supporting PHP 5.3, later versions will require 5.5 or later.\n* Using GitHub issue tracking for feature requests and planning.\n* Rewrote [the manual](http://dbwebb.se/opensource/cimage).\n* Created directory `webroot` and moved some files there.\n\n\nv0.4.1 (2014-01-27)\n-------------------------------------\n\n* Changed => to == on Modified-Since.\n* Always send Last-Modified-Header.\n* Added `htmlentities()` to verbose output.\n* Fixed support for jpeg, not only jpg.\n* Fixed crop whole image by setting crop=0,0,0,0\n* Use negative values for crop width & height to base calulation on original width/height and withdraw selected amount.\n* Correcting jpeg when setting quality.\n* Removed obsolete reference to `$newName` in `CImage::__construct()` (issue 1).\n\n\nv0.4 (2013-10-08)\n-------------------------------------\n\n* Improved support for pre-defined sizes.\n* Adding grid column size as predefined size, c1-c24 for a 24 column grid. Configure in `img.php`.\n* Corrected error on naming cache-files using subdir.\n* Corrected calculation error on width & height for crop-to-fit.\n* Adding effects for sharpen, emboss and blur through imageconvolution using matrixes.\n* crop-to-fit, add parameter for offset x and y to enable to define which area is the, implemented as area.\n* Support for resizing opaque images.\n* Center of the image from which the crop is done. Improved usage of area to crop.\n* Added support for % in width & height.\n* Added aspect-ratio.\n* Added scale.\n* Quality for PNG images is now knows as deflate.\n* Added palette to create images with max 256 colors.\n* Added usage of all parameters to README.md\n* Added documentation here http://dbwebb.se/opensource/cimage\n* Adding `.gitignore`\n* Re-adding `cache` directory\n\n\nv0.3 (2012-10-02)\n-------------------------------------\n\n* Added crop. Can crop a area (`width`, `height`, `start_x`, `start_y`) from the original\nimage.\n* Corrected to make the 304 Not Modified header work.\n* Predefined sizes can be configured for width in `img.php`.\n* Corrected to make crop work with width or height in combination with crop-to-fit.\n\n\nv0.2 (2012-05-09)\n-------------------------------------\n\n* Implemented filters as in http://php.net/manual/en/function.imagefilter.php\n* Changed `crop` to `crop_to_fit`, works the same way.\n* Changed arguments and sends them in array.\n* Added quality-setting.\n* Added testcases for above.\n\n\nv0.1.1 (2012-04-27)\n-------------------------------------\n\n* Corrected calculation where both width and height were set.\n\n\nv0.1 (2012-04-25)\n-------------------------------------\n\n* Initial release after rewriting some older code doing the same, but not that good and flexible.\n", "<?php\n\necho 'Current PHP version: ' . phpversion() . '<br><br>';\n\necho 'Running on: ' . $_SERVER['SERVER_SOFTWARE'] . '<br><br>';\n\n$no = extension_loaded('exif') ? null : 'NOT';\necho \"Extension exif is $no loaded.<br>\";\n\n$no = extension_loaded('curl') ? null : 'NOT';\necho \"Extension curl is $no loaded.<br>\";\n\n$no = extension_loaded('imagick') ? null : 'NOT';\necho \"Extension imagick is $no loaded.<br>\";\n\n$no = extension_loaded('gd') ? null : 'NOT';\necho \"Extension gd is $no loaded.<br>\";\nif (!$no) {\n    echo \"<pre>\", var_dump(gd_info()), \"</pre>\";\n}\n\necho \"<strong>Checking path for postprocessing tools</strong>\";\n\necho \"<br>pngquant: \";\nsystem(\"which pngquant\");\n\necho \"<br>optipng: \";\nsystem(\"which optipng\");\n\necho \"<br>pngout: \";\nsystem(\"which pngout\");\n\necho \"<br>jpegtran: \";\nsystem(\"which jpegtran\");\n"], "fixing_code": ["Revision history\n=====================================\n\n[![Build Status](https://travis-ci.org/mosbth/cimage.svg?branch=master)](https://travis-ci.org/mosbth/cimage)\n[![Build Status](https://scrutinizer-ci.com/g/mosbth/cimage/badges/build.png?b=master)](https://scrutinizer-ci.com/g/mosbth/cimage/build-status/master)\n\n\nv0.7.19* (2016-08-31)\n-------------------------------------\n\n* Correct XSS injection in `check_system.php`.\n* Composer suggests ext-imagick and ext-curl.\n\n\nv0.7.18 (2016-08-09)\n-------------------------------------\n\n* Made `&lossless` a requirement to not use the original image.\n\n\nv0.7.17 (2016-08-09)\n-------------------------------------\n\n* Made `&lossless` part of the generated cache filename.\n\n\nv0.7.16 (2016-08-09)\n-------------------------------------\n\n* Fix default mode to be production.\n* Added pngquant as extra postprocessing utility for PNG-images, #154.\n* Bug `&status` wrong variable name for fast track cache.\n\n\nv0.7.15 (2016-08-09)\n-------------------------------------\n\n* Added the [Lenna/Lena sample image](http://www.cs.cmu.edu/~chuck/lennapg/) as tif and created a png, jpeg and webp version using Imagick convert `convert lena.tif lena.{png,jpg,webp}`, #152.\n* Limited and basic support for WEBP format, se #132.\n\n\nv0.7.14 (2016-08-08)\n-------------------------------------\n\n* Re-add removed cache directory.\n* Make fast track cache disabled by default in the config file.\n\n\nv0.7.13 (2016-08-08)\n-------------------------------------\n\n* Moved functions from img.php to `functions.php`.\n* Added function `trace()` to measure speed and memory consumption, only for development.\n* Added fast cache #149.\n* Added `imgf.php` as shortcut to check for fast cache, before loading `img.php` as usual, adding `imgf_config.php` as symlink to `img_config.php`.\n* Created `defines.php` and moved definition av version there.\n* Fixed images in README, #148.\n* Initiated dependency injection to `CImage`, class names can be set in config file and will be injected to `CImage` from `img.php`. Not implemented for all classes. #151.\n* Enabled debug mode to make it easier to trace what actually happens while processing the image, #150.\n\n\nv0.7.12 (2016-06-01)\n-------------------------------------\n\n* Fixed to correctly display image when using a resize strategy without height or width.\n* Fixed background color for option `no-upscale`, #144.\n\n\nv0.7.11 (2016-04-18)\n-------------------------------------\n\n* Add option for `skip_original` to config file to always skip original, #118.\n\n\nv0.7.10 (2016-04-01)\n-------------------------------------\n\n* Add backup option for images `src-alt`, #141.\n* Add require of ext-gd in composer.json, #133.\n* Fix strict mode only reporting 404 when failure, #127.\n\n\nv0.7.9 (2015-12-07)\n-------------------------------------\n\n* Strict mode only reporting 404 when failure, #127.\n* Added correct CImage version to remote agent string, #131.\n* Adding CCache to improve cache handling of caching for dummy, remote and srgb. #130.\n\n\nv0.7.8 (2015-12-06)\n-------------------------------------\n\n* HTTP error messages now 403, 404 and 500 as in #128 and #127.\n* More examples on dealing with cache through bash `bin/cache.bash`, #129.\n* Added conversion to sRGB using option `?srgb`. #120. \n* Added Gitter badge to README, #126.\n* Fix proper download url in README, #125.\n* Change path in `webroot/htaccess` to make it work in current environment.\n\n\nv0.7.7 (2015-10-21)\n-------------------------------------\n\n* One can now add a HTTP header for Cache-Control in the config file, #109.\n* Added hook in img,php before CImage is called, #123.\n* Added configuration for default jpeg quality and png compression in the config file, #107. \n* Strip comments and whitespace in imgs.php, #115.\n* Bundle imgs.php did not have the correct mode.\n* Adding option &status to get an overview of the installed on configured utilities, #116.\n* Bug, all files saved as png-files, when not saving as specific file. \n* Removed saving filename extension for alias images.\n* Added option to decide if resample or resize when copying images internally. `&no-resample` makes resize, instead of resample as is default.\n* Verbose now correctly states if transparent color is detected.\n* Compare-tool now supports 6 images.\n* Added option for dark background in the compare-tool.\n* Removed that source png-files, containing less than 255 colors, is always saved as palette images since this migth depend on processing of the image.\n* Adding save-as as part of the generated cache filename, #121.\n* Add extra fields to json-response, #114.\n* Add header for Content-Length, #111.\n* Add check for postprocessing tools in path in `webroot/check_system.php`, #104.\n\n\nv0.7.6 (2015-10-18)\n-------------------------------------\n\n* Adding testpage for dummy images `webroot/test/test_issue101-dummy.php`.\n* Adding width and height when creating dummy image.\n\n\nv0.7.5 (2015-10-18)\n-------------------------------------\n\n* Adding feature for creating dummy images `src=dummy`, #101.\n* Add png compression to generated cache filename, fix #103.\n* Removed file prefix from storing images in cache, breaking filenamestructure for cache images.\n* Code cleaning in `CImage.php`.\n\n\nv0.7.4 (2015-09-15)\n-------------------------------------\n\n* Add CAsciiArt.php to composer for autoloading, fix #102.\n* Generate filename with filters, does not work on Windows, fix #100.\n\n\nv0.7.3 (2015-09-01)\n-------------------------------------\n\n* Support output of ascii images, #67.\n\n\nv0.7.2 (2015-08-17)\n-------------------------------------\n\n* Allow space in remote filenames, fix #98.\n\n\nv0.7.1 (2015-07-25)\n-------------------------------------\n\n* Support for password hashes using `text`, `md5` and `hash`, fix #77.\n* Using `CWhitelist` for checking hotlinking to images, fix #88.\n* Added mode for `test` which enables logging verbose mode to file, fix #97.\n* Improved codestyle and added `phpcs.xml` to start using phpcs to check code style, fix #95.\n* Adding `composer.json` for publishing on packagist. \n* Add permalink to setup for comparing images with `webroot/compare/compare.php`, fix #92.\n* Allow space in filename by using `urlencode()` and allow space as valid filenam character. fix #91.\n* Support redirections for remote images, fix #87, fix #90. \n* Improving usage of Travis and Scrutinizer.\n* Naming cache-file using md5 for remote images, fix #86.\n* Loading images without depending on filename extension, fix #85.\n* Adding unittest with phpunit #84, fix #13 \n* Adding support for whitelist of remote hostnames, #84\n* Adding phpdoc, fix #48.\n* Adding travis, fix #15.\n* Adding scrutinizer, fix #57.\n\n\nv0.7.0 (2015-02-10)\n-------------------------------------\n\n* Always use password, setting in img_config.php, fix #78.\n* Resize gif keeping transparency #81.\n* Now returns statuscode 500 when something fails #55.\n* Three different modes: strict, production, development #44.\n* Three files for all-in-one `imgs.php`, `imgp.php`, `imgd.php` #73.\n* Change name of script all-in-one to `webroot/imgs.php` #73.\n* Combine all code into one singel script, `webroot/img_single.php` #73.\n* Disallow hotlinking/leeching by configuration #46.\n* Alias-name is without extension #47.\n* Option `alias` now requires `password` to work #47.\n* Support for option `password, pwd` to protect usage of `alias` and remote download.\n* Added support for option `alias` that creates a link to a cached version  of the image #47.\n* Create cache directory for remote download if it does not exists.\n* Cleaned up `img_config.php` and introduced default values for almost all options #72.\n\n\nv0.6.2 (2015-01-14)\n-------------------------------------\n\n* Added support for download of remote images #43.\n* Added autoloader.\n\n\nv0.6.1 (2015-01-08)\n-------------------------------------\n\n* Adding compare-page for comparing images. Issue #20.\n* Added option `no-upscale, nu` as resizing strategy to decline upscaling of smaller images. Fix #61.\n* Minor change in `CImage::resize()`, crop now does imagecopy without resamling.\n* Correcting internal details for save-as and response json which indicated wrong colors. Fix #62.\n* Fixed fill-to-fit that failed when using aspect-ratio. Fix #52.\n* JSON returns correct values for resulting image. Fix #58.\n* Corrected behaviour for skip-original. Fix #60.\n\n\nv0.6 (2014-12-06)\n-------------------------------------\n\n* Rewrote and added documentation.\n* Moved conolution expressesion from `img_config.php` to `CImage`.\n* Minor cleaning of properties in `CImage`. Fix #23.\n* Adding `webroot/htaccess` to show off how friendly urls can be created for `img.php`. Fix #45.\n* Added option `fill-to-fit, ff`. Fix #38.\n* Added option `shortcut, sc` to enable configuration of complex expressions. Fix #2.\n* Added support for custom convolutions. Fix #49.\n* Restructured testprograms. Fix #41.\n* Corrected json on PHP 5.3. Fix #42.\n* Improving template for tests in `webroot/tests` when testing out #40.\n* Adding testcase for #40.\n* Adding option `convolve` taking comma-separated list of 11 float-values, wraps and exposes `imageconvoluttion()`. #4\n* Adding option `dpr, device-pixel-ratio` which defaults to 1. Set to 2 to get a twice as large image. Useful for Retina displays. Basically a shortcut to enlarge the image.\n* Adding utility `cache.bash` to ease gathering stats on cache usage. #21\n* Cache-directory can now be readonly and serve all cached files, still failing when need to save files. #5\n* Cache now uses same file extension as original image #37.\n* Can output image as json format using `json` #11.\n\n\nv0.5.3 (2014-11-21)\n-------------------------------------\n\n* Support filenames of uppercase JPEG, JPG, PNG and GIF, as proposed in #37.\n* Changing `CImage::output()` as proposed in #37.\n* Adding security check that image filename is always below the path `image_path` as specified in `img_config.php` #37.\n* Adding configuration item in `img_config.php` for setting valid characters in image filename.\n* Moving `webroot/test*` into directory `webroot/test`.\n* `webroot/check_system.php` now outputs if extension for exif is loaded.\n* Broke API when `initDimensions()` split into two methods, new `initDimensions()` and `loadImageDetails()`.\n* Added `autoRotate, aro` to auto rotate image based on EXIF information.\n* Added `bgColor, bgc` to use as backgroundcolor when needing a filler color, for example rotate 45.\n* Added `rotateBefore, rb` to rotate image a certain angle before processing.\n* Added `rotateAfter, ra` to rotate image a certain angle after processing.\n* Cleaned up code formatting, removed trailing spaces.\n* Removed @ from opening images, better to display correct warning when failing #34, but put it back again.\n* Setting gd.jpeg_ignore_warning to true as default #34.\n* `webroot/check_system.php` now outputs version of PHP and GD.\n* #32 correctly send 404 header when serving an error message.\n* Trying to verify issue #29, but can not.\n* Adding structure for testprograms together with, use `webroot/test_issue29.php` as sample.\n* Improving code formatting.\n* Moving parts of verbose output from img.php to CImage.php.\n\n\nv0.5.2 (2014-04-01)\n-------------------------------------\n\n* Correcting issue #26 providing error message when not using postprocessing.\n* Correcting issue #27 warning of default timezone.\n* Removed default $config options in `img.php`, was not used, all configuration should be in `img_config.php`.\n* Verified known bug - sharpen acts as blur in PHP 5.5.9 and 5.5.10 #28\n\n\nv0.5.1 (2014-02-12)\n-------------------------------------\n\n* Display image in README-file.\n* Create an empty `cache` directory as part of repo.\n\n\nv0.5 (2014-02-12)\n-------------------------------------\n\n* Change constant name `CImage::PNG_QUALITY_DEFAULT` to `CImage::PNG_COMPRESSION_DEFAULT`.\n* Split JPEG quality and PNG compression, `CImage->quality` and `CImage->compression`\n* Changed `img.php` parameter name `d, deflate` to `co, compress`.\n* Separating configuration issues from `img.php` to `img_config.php`.\n* Format code according to PSR-2.\n* Disabled post-processing JPEG and PNG as default.\n* This version is supporting PHP 5.3, later versions will require 5.5 or later.\n* Using GitHub issue tracking for feature requests and planning.\n* Rewrote [the manual](http://dbwebb.se/opensource/cimage).\n* Created directory `webroot` and moved some files there.\n\n\nv0.4.1 (2014-01-27)\n-------------------------------------\n\n* Changed => to == on Modified-Since.\n* Always send Last-Modified-Header.\n* Added `htmlentities()` to verbose output.\n* Fixed support for jpeg, not only jpg.\n* Fixed crop whole image by setting crop=0,0,0,0\n* Use negative values for crop width & height to base calulation on original width/height and withdraw selected amount.\n* Correcting jpeg when setting quality.\n* Removed obsolete reference to `$newName` in `CImage::__construct()` (issue 1).\n\n\nv0.4 (2013-10-08)\n-------------------------------------\n\n* Improved support for pre-defined sizes.\n* Adding grid column size as predefined size, c1-c24 for a 24 column grid. Configure in `img.php`.\n* Corrected error on naming cache-files using subdir.\n* Corrected calculation error on width & height for crop-to-fit.\n* Adding effects for sharpen, emboss and blur through imageconvolution using matrixes.\n* crop-to-fit, add parameter for offset x and y to enable to define which area is the, implemented as area.\n* Support for resizing opaque images.\n* Center of the image from which the crop is done. Improved usage of area to crop.\n* Added support for % in width & height.\n* Added aspect-ratio.\n* Added scale.\n* Quality for PNG images is now knows as deflate.\n* Added palette to create images with max 256 colors.\n* Added usage of all parameters to README.md\n* Added documentation here http://dbwebb.se/opensource/cimage\n* Adding `.gitignore`\n* Re-adding `cache` directory\n\n\nv0.3 (2012-10-02)\n-------------------------------------\n\n* Added crop. Can crop a area (`width`, `height`, `start_x`, `start_y`) from the original\nimage.\n* Corrected to make the 304 Not Modified header work.\n* Predefined sizes can be configured for width in `img.php`.\n* Corrected to make crop work with width or height in combination with crop-to-fit.\n\n\nv0.2 (2012-05-09)\n-------------------------------------\n\n* Implemented filters as in http://php.net/manual/en/function.imagefilter.php\n* Changed `crop` to `crop_to_fit`, works the same way.\n* Changed arguments and sends them in array.\n* Added quality-setting.\n* Added testcases for above.\n\n\nv0.1.1 (2012-04-27)\n-------------------------------------\n\n* Corrected calculation where both width and height were set.\n\n\nv0.1 (2012-04-25)\n-------------------------------------\n\n* Initial release after rewriting some older code doing the same, but not that good and flexible.\n", "<?php\n\necho 'Current PHP version: ' . phpversion() . '<br><br>';\n\necho 'Running on: ' . htmlentities($_SERVER['SERVER_SOFTWARE']) . '<br><br>';\n\n$no = extension_loaded('exif') ? null : 'NOT';\necho \"Extension exif is $no loaded.<br>\";\n\n$no = extension_loaded('curl') ? null : 'NOT';\necho \"Extension curl is $no loaded.<br>\";\n\n$no = extension_loaded('imagick') ? null : 'NOT';\necho \"Extension imagick is $no loaded.<br>\";\n\n$no = extension_loaded('gd') ? null : 'NOT';\necho \"Extension gd is $no loaded.<br>\";\nif (!$no) {\n    echo \"<pre>\", var_dump(gd_info()), \"</pre>\";\n}\n\necho \"<strong>Checking path for postprocessing tools</strong>\";\n\necho \"<br>pngquant: \";\nsystem(\"which pngquant\");\n\necho \"<br>optipng: \";\nsystem(\"which optipng\");\n\necho \"<br>pngout: \";\nsystem(\"which pngout\");\n\necho \"<br>jpegtran: \";\nsystem(\"which jpegtran\");\n"], "filenames": ["REVISION.md", "webroot/check_system.php"], "buggy_code_start_loc": [8, 5], "buggy_code_end_loc": [11, 6], "fixing_code_start_loc": [8, 5], "fixing_code_end_loc": [12, 6], "type": "CWE-79", "message": "A vulnerability was found in mosbth cimage up to 0.7.18. It has been declared as problematic. Affected by this vulnerability is an unknown functionality of the file check_system.php. The manipulation of the argument $_SERVER['SERVER_SOFTWARE'] leads to cross site scripting. The attack can be launched remotely. Upgrading to version 0.7.19 is able to address this issue. The name of the patch is 401478c8393989836beeddfeac5ce44570af162b. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-219715.", "other": {"cve": {"id": "CVE-2016-15022", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-29T19:15:08.940", "lastModified": "2023-02-07T18:46:07.337", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability was found in mosbth cimage up to 0.7.18. It has been declared as problematic. Affected by this vulnerability is an unknown functionality of the file check_system.php. The manipulation of the argument $_SERVER['SERVER_SOFTWARE'] leads to cross site scripting. The attack can be launched remotely. Upgrading to version 0.7.19 is able to address this issue. The name of the patch is 401478c8393989836beeddfeac5ce44570af162b. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-219715."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 2.0, "baseSeverity": "LOW"}, "exploitabilityScore": 0.5, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:H/Au:M/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "HIGH", "authentication": "MULTIPLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 1.7}, "baseSeverity": "LOW", "exploitabilityScore": 3.2, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:cimage:cimage:*:*:*:*:*:*:*:*", "versionEndExcluding": "0.7.19", "matchCriteriaId": "48FDE952-C0AD-45DE-AF0B-52B4B4366982"}]}]}], "references": [{"url": "https://github.com/mosbth/cimage/commit/401478c8393989836beeddfeac5ce44570af162b", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/mosbth/cimage/releases/tag/v0.7.19", "source": "cna@vuldb.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.219715", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.219715", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/mosbth/cimage/commit/401478c8393989836beeddfeac5ce44570af162b"}}