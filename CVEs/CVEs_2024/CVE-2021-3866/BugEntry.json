{"buggy_code": ["{{#if is_stream}}\n<div class=\"message_header message_header_stream right_part\">\n    <div class=\"message-header-wrapper\">\n        <div class=\"message-header-contents\">\n            {{! stream link }}\n            <a class=\"message_label_clickable narrows_by_recipient stream_label {{color_class}}\"\n              style=\"background: {{background_color}}; border-left-color: {{background_color}};\"\n              href=\"{{stream_url}}\"\n              title=\"{{#tr}}Narrow to stream &quot;{display_recipient}&quot;{{/tr}}\">\n                {{~! Icons for invite-only/web-public streams ~}}\n                {{~#if invite_only ~}}\n                    <i class=\"fa fa-lock recipient-row-stream-icon\" title=\"{{t 'This is a private stream' }}\" aria-label=\"{{t 'This is a private stream' }}\"></i>\n                {{/if}}\n\n                {{~#if is_web_public ~}}\n                    <i class=\"fa fa-globe recipient-row-stream-icon\" title=\"{{t 'This is a web public stream' }}\" aria-label=\"{{t 'This is a web public stream' }}\"></i>\n                {{/if}}\n\n                {{~! Recipient (e.g. stream/topic or topic) ~}}\n                {{~{display_recipient}~}}\n            </a>\n\n            {{! hidden narrow icon for copy-pasting }}\n            <span class=\"copy-paste-text\">&gt;</span>\n\n            {{! topic stuff }}\n            <span class=\"stream_topic\">\n                {{! topic link }}\n                <a class=\"message_label_clickable narrows_by_topic\"\n                  href=\"{{topic_url}}\"\n                  title=\"{{#tr}}Narrow to stream &quot;{display_recipient}&quot;, topic &quot;{topic}&quot;{{/tr}}\">\n                    {{#if use_match_properties}}\n                        {{{match_topic}}}\n                    {{else}}\n                        {{topic}}\n                    {{/if}}\n                </a>\n            </span>\n            <span class=\"recipient_bar_controls no-select\">\n                <span class=\"topic_edit hidden-for-spectators\">\n                    <span class=\"topic_edit_form\" id=\"{{id}}\"></span>\n                </span>\n\n                {{! exterior links (e.g. to a trac ticket) }}\n                {{#each topic_links}}\n                    <a href=\"{{this.url}}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"no-underline\">\n                        <i class=\"fa fa-external-link-square recipient_bar_icon\" data-tippy-content=\"Open {{this.text}}\" aria-label=\"{{t 'External link' }}\"></i>\n                    </a>\n                {{/each}}\n\n                {{! edit topic pencil icon }}\n                {{#if always_visible_topic_edit}}\n                    <i class=\"fa fa-pencil always_visible_topic_edit recipient_bar_icon hidden-for-spectators\" {{#unless realm_allow_message_editing}}style=\"display: none\"{{/unless}} data-tippy-content=\"{{t 'Edit topic'}}\" role=\"button\" tabindex=\"0\" aria-label=\"{{t 'Edit topic' }}\"></i>\n                {{else}}\n                    {{#if on_hover_topic_edit}}\n                    <i class=\"fa fa-pencil on_hover_topic_edit recipient_bar_icon hidden-for-spectators\" {{#unless realm_allow_message_editing}}style=\"display: none\"{{/unless}} data-tippy-content=\"{{t 'Edit topic'}}\" role=\"button\" tabindex=\"0\" aria-label=\"{{t 'Edit topic' }}\"></i>\n                    {{/if}}\n                {{/if}}\n\n                {{#if user_can_resolve_topic}}\n                    {{#if topic_is_resolved}}\n                        <i class=\"fa fa-check on_hover_topic_unresolve recipient_bar_icon hidden-for-spectators\" data-topic-name=\"{{topic}}\" data-tippy-content=\"{{t 'Mark as unresolved' }}\" role=\"button\" tabindex=\"0\" aria-label=\"{{t 'Mark as unresolved' }}\"></i>\n                    {{else}}\n                        <i class=\"fa fa-check on_hover_topic_resolve recipient_bar_icon hidden-for-spectators\" data-topic-name=\"{{topic}}\" data-tippy-content=\"{{t 'Mark as resolved' }}\" role=\"button\" tabindex=\"0\" aria-label=\"{{t 'Mark as resolved' }}\"></i>\n                    {{/if}}\n                {{/if}}\n\n                {{#if topic_muted}}\n                    <i class=\"fa fa-bell-slash on_hover_topic_unmute recipient_bar_icon\" data-stream-id=\"{{stream_id}}\" data-topic-name=\"{{topic}}\" data-tippy-content=\"{{t 'Unmute topic' }} (M)\" role=\"button\" tabindex=\"0\" aria-label=\"{{t 'Unmute topic' }}\"></i>\n                {{else}}\n                    <i class=\"fa fa-bell-slash on_hover_topic_mute recipient_bar_icon hidden-for-spectators\" data-stream-id=\"{{stream_id}}\" data-topic-name=\"{{topic}}\" data-tippy-content=\"{{t 'Mute topic' }} (M)\" role=\"button\" tabindex=\"0\" aria-label=\"{{t 'Mute topic' }}\"></i>\n                {{/if}}\n            </span>\n            <span class=\"recipient_row_date {{#if group_date_divider_html}}{{else}}hide-date{{/if}}\">{{{date}}}</span>\n        </div>\n    </div>\n</div>\n{{else}}\n<div class=\"message_header message_header_private_message dark_background\">\n    <div class=\"message-header-wrapper\">\n        <div class=\"message-header-contents\">\n            <a class=\"message_label_clickable narrows_by_recipient stream_label\"\n              href=\"{{pm_with_url}}\"\n              title=\"{{#tr}}Narrow to your private messages with {display_reply_to}{{/tr}}\">\n                {{#tr}}You and {display_reply_to}{{/tr}}\n            </a>\n\n            <span class=\"recipient_row_date {{#if group_date_divider_html}}{{else}}hide-date{{/if}}\">{{{date}}}</span>\n        </div>\n    </div>\n</div>\n{{/if}}\n"], "fixing_code": ["{{#if is_stream}}\n<div class=\"message_header message_header_stream right_part\">\n    <div class=\"message-header-wrapper\">\n        <div class=\"message-header-contents\">\n            {{! stream link }}\n            <a class=\"message_label_clickable narrows_by_recipient stream_label {{color_class}}\"\n              style=\"background: {{background_color}}; border-left-color: {{background_color}};\"\n              href=\"{{stream_url}}\"\n              title=\"{{#tr}}Narrow to stream &quot;{display_recipient}&quot;{{/tr}}\">\n                {{~! Icons for invite-only/web-public streams ~}}\n                {{~#if invite_only ~}}\n                    <i class=\"fa fa-lock recipient-row-stream-icon\" title=\"{{t 'This is a private stream' }}\" aria-label=\"{{t 'This is a private stream' }}\"></i>\n                {{/if}}\n\n                {{~#if is_web_public ~}}\n                    <i class=\"fa fa-globe recipient-row-stream-icon\" title=\"{{t 'This is a web public stream' }}\" aria-label=\"{{t 'This is a web public stream' }}\"></i>\n                {{/if}}\n\n                {{~! Recipient (e.g. stream/topic or topic) ~}}\n                {{~display_recipient~}}\n            </a>\n\n            {{! hidden narrow icon for copy-pasting }}\n            <span class=\"copy-paste-text\">&gt;</span>\n\n            {{! topic stuff }}\n            <span class=\"stream_topic\">\n                {{! topic link }}\n                <a class=\"message_label_clickable narrows_by_topic\"\n                  href=\"{{topic_url}}\"\n                  title=\"{{#tr}}Narrow to stream &quot;{display_recipient}&quot;, topic &quot;{topic}&quot;{{/tr}}\">\n                    {{#if use_match_properties}}\n                        {{{match_topic}}}\n                    {{else}}\n                        {{topic}}\n                    {{/if}}\n                </a>\n            </span>\n            <span class=\"recipient_bar_controls no-select\">\n                <span class=\"topic_edit hidden-for-spectators\">\n                    <span class=\"topic_edit_form\" id=\"{{id}}\"></span>\n                </span>\n\n                {{! exterior links (e.g. to a trac ticket) }}\n                {{#each topic_links}}\n                    <a href=\"{{this.url}}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"no-underline\">\n                        <i class=\"fa fa-external-link-square recipient_bar_icon\" data-tippy-content=\"Open {{this.text}}\" aria-label=\"{{t 'External link' }}\"></i>\n                    </a>\n                {{/each}}\n\n                {{! edit topic pencil icon }}\n                {{#if always_visible_topic_edit}}\n                    <i class=\"fa fa-pencil always_visible_topic_edit recipient_bar_icon hidden-for-spectators\" {{#unless realm_allow_message_editing}}style=\"display: none\"{{/unless}} data-tippy-content=\"{{t 'Edit topic'}}\" role=\"button\" tabindex=\"0\" aria-label=\"{{t 'Edit topic' }}\"></i>\n                {{else}}\n                    {{#if on_hover_topic_edit}}\n                    <i class=\"fa fa-pencil on_hover_topic_edit recipient_bar_icon hidden-for-spectators\" {{#unless realm_allow_message_editing}}style=\"display: none\"{{/unless}} data-tippy-content=\"{{t 'Edit topic'}}\" role=\"button\" tabindex=\"0\" aria-label=\"{{t 'Edit topic' }}\"></i>\n                    {{/if}}\n                {{/if}}\n\n                {{#if user_can_resolve_topic}}\n                    {{#if topic_is_resolved}}\n                        <i class=\"fa fa-check on_hover_topic_unresolve recipient_bar_icon hidden-for-spectators\" data-topic-name=\"{{topic}}\" data-tippy-content=\"{{t 'Mark as unresolved' }}\" role=\"button\" tabindex=\"0\" aria-label=\"{{t 'Mark as unresolved' }}\"></i>\n                    {{else}}\n                        <i class=\"fa fa-check on_hover_topic_resolve recipient_bar_icon hidden-for-spectators\" data-topic-name=\"{{topic}}\" data-tippy-content=\"{{t 'Mark as resolved' }}\" role=\"button\" tabindex=\"0\" aria-label=\"{{t 'Mark as resolved' }}\"></i>\n                    {{/if}}\n                {{/if}}\n\n                {{#if topic_muted}}\n                    <i class=\"fa fa-bell-slash on_hover_topic_unmute recipient_bar_icon\" data-stream-id=\"{{stream_id}}\" data-topic-name=\"{{topic}}\" data-tippy-content=\"{{t 'Unmute topic' }} (M)\" role=\"button\" tabindex=\"0\" aria-label=\"{{t 'Unmute topic' }}\"></i>\n                {{else}}\n                    <i class=\"fa fa-bell-slash on_hover_topic_mute recipient_bar_icon hidden-for-spectators\" data-stream-id=\"{{stream_id}}\" data-topic-name=\"{{topic}}\" data-tippy-content=\"{{t 'Mute topic' }} (M)\" role=\"button\" tabindex=\"0\" aria-label=\"{{t 'Mute topic' }}\"></i>\n                {{/if}}\n            </span>\n            <span class=\"recipient_row_date {{#if group_date_divider_html}}{{else}}hide-date{{/if}}\">{{{date}}}</span>\n        </div>\n    </div>\n</div>\n{{else}}\n<div class=\"message_header message_header_private_message dark_background\">\n    <div class=\"message-header-wrapper\">\n        <div class=\"message-header-contents\">\n            <a class=\"message_label_clickable narrows_by_recipient stream_label\"\n              href=\"{{pm_with_url}}\"\n              title=\"{{#tr}}Narrow to your private messages with {display_reply_to}{{/tr}}\">\n                {{#tr}}You and {display_reply_to}{{/tr}}\n            </a>\n\n            <span class=\"recipient_row_date {{#if group_date_divider_html}}{{else}}hide-date{{/if}}\">{{{date}}}</span>\n        </div>\n    </div>\n</div>\n{{/if}}\n"], "filenames": ["static/templates/recipient_row.hbs"], "buggy_code_start_loc": [20], "buggy_code_end_loc": [21], "fixing_code_start_loc": [20], "fixing_code_end_loc": [21], "type": "CWE-79", "message": "Cross-site Scripting (XSS) - Stored in GitHub repository zulip/zulip more than and including 44f935695d452cc3fb16845a0c6af710438b153d and prior to 3eb2791c3e9695f7d37ffe84e0c2184fae665cb6.", "other": {"cve": {"id": "CVE-2021-3866", "sourceIdentifier": "security@huntr.dev", "published": "2022-01-20T11:15:07.927", "lastModified": "2022-02-03T14:20:48.457", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Cross-site Scripting (XSS) - Stored in GitHub repository zulip/zulip more than and including 44f935695d452cc3fb16845a0c6af710438b153d and prior to 3eb2791c3e9695f7d37ffe84e0c2184fae665cb6."}, {"lang": "es", "value": "Cross-site Scripting (XSS) - Almacenado en el repositorio de GitHub zulip/zulip m\u00e1s de e incluyendo 44f935695d452cc3fb16845a0c6af710438b153d y antes de 3eb2791c3e9695f7d37ffe84e0c2184fae665cb6"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:C/C:H/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.0, "impactScore": 5.3}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:zulip:zulip:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.8", "matchCriteriaId": "C448E394-82E2-49E3-87E3-B80CF406D2FF"}]}]}], "references": [{"url": "https://blog.zulip.com/2022/01/19/cve-2021-3866/", "source": "security@huntr.dev", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/zulip/zulip/commit/3eb2791c3e9695f7d37ffe84e0c2184fae665cb6", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/5f48dac5-e112-4b23-bbbf-cc00ba83bcf2", "source": "security@huntr.dev", "tags": ["Exploit", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/zulip/zulip/commit/3eb2791c3e9695f7d37ffe84e0c2184fae665cb6"}}