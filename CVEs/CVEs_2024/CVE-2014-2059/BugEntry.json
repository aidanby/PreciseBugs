{"buggy_code": ["/*\n * The MIT License\n *\n * Copyright (c) 2004-2010, Sun Microsystems, Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\npackage hudson.cli;\n\nimport hudson.model.ModifiableItemGroup;\nimport hudson.model.TopLevelItem;\nimport jenkins.model.Jenkins;\nimport hudson.Extension;\nimport hudson.model.Item;\nimport jenkins.model.ModifiableTopLevelItemGroup;\nimport org.kohsuke.args4j.Argument;\n\n/**\n * Creates a new job by reading stdin as a configuration XML file.\n * \n * @author Kohsuke Kawaguchi\n */\n@Extension\npublic class CreateJobCommand extends CLICommand {\n    @Override\n    public String getShortDescription() {\n        return Messages.CreateJobCommand_ShortDescription();\n    }\n\n    @Argument(metaVar=\"NAME\",usage=\"Name of the job to create\",required=true)\n    public String name;\n\n    protected int run() throws Exception {\n        Jenkins h = Jenkins.getInstance();\n        h.checkPermission(Item.CREATE);\n\n        if (h.getItemByFullName(name)!=null) {\n            stderr.println(\"Job '\"+name+\"' already exists\");\n            return -1;\n        }\n\n        ModifiableTopLevelItemGroup ig = h;\n        int i = name.lastIndexOf('/');\n        if (i > 0) {\n            String group = name.substring(0, i);\n            Item item = h.getItemByFullName(group);\n            if (item == null) {\n                throw new IllegalArgumentException(\"Unknown ItemGroup \" + group);\n            }\n\n            if (item instanceof ModifiableTopLevelItemGroup) {\n                ig = (ModifiableTopLevelItemGroup) item;\n            } else {\n                throw new IllegalArgumentException(\"Can't create job from CLI in \" + group);\n            }\n            name = name.substring(i + 1);\n        }\n\n        ig.createProjectFromXML(name, stdin);\n        return 0;\n    }\n}\n\n\n"], "fixing_code": ["/*\n * The MIT License\n *\n * Copyright (c) 2004-2010, Sun Microsystems, Inc.\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n * THE SOFTWARE.\n */\npackage hudson.cli;\n\nimport hudson.model.ModifiableItemGroup;\nimport hudson.model.TopLevelItem;\nimport jenkins.model.Jenkins;\nimport hudson.Extension;\nimport hudson.model.Item;\nimport jenkins.model.ModifiableTopLevelItemGroup;\nimport org.kohsuke.args4j.Argument;\n\n/**\n * Creates a new job by reading stdin as a configuration XML file.\n * \n * @author Kohsuke Kawaguchi\n */\n@Extension\npublic class CreateJobCommand extends CLICommand {\n    @Override\n    public String getShortDescription() {\n        return Messages.CreateJobCommand_ShortDescription();\n    }\n\n    @Argument(metaVar=\"NAME\",usage=\"Name of the job to create\",required=true)\n    public String name;\n\n    protected int run() throws Exception {\n        Jenkins h = Jenkins.getInstance();\n        h.checkPermission(Item.CREATE);\n\n        if (h.getItemByFullName(name)!=null) {\n            stderr.println(\"Job '\"+name+\"' already exists\");\n            return -1;\n        }\n\n        ModifiableTopLevelItemGroup ig = h;\n        int i = name.lastIndexOf('/');\n        if (i > 0) {\n            String group = name.substring(0, i);\n            Item item = h.getItemByFullName(group);\n            if (item == null) {\n                throw new IllegalArgumentException(\"Unknown ItemGroup \" + group);\n            }\n\n            if (item instanceof ModifiableTopLevelItemGroup) {\n                ig = (ModifiableTopLevelItemGroup) item;\n            } else {\n                throw new IllegalArgumentException(\"Can't create job from CLI in \" + group);\n            }\n            name = name.substring(i + 1);\n        }\n\n        Jenkins.checkGoodName(name);\n        ig.createProjectFromXML(name, stdin);\n        return 0;\n    }\n}\n\n\n"], "filenames": ["core/src/main/java/hudson/cli/CreateJobCommand.java"], "buggy_code_start_loc": [74], "buggy_code_end_loc": [74], "fixing_code_start_loc": [75], "fixing_code_end_loc": [76], "type": "CWE-22", "message": "Directory traversal vulnerability in the CLI job creation (hudson/cli/CreateJobCommand.java) in Jenkins before 1.551 and LTS before 1.532.2 allows remote authenticated users to overwrite arbitrary files via the job name.", "other": {"cve": {"id": "CVE-2014-2059", "sourceIdentifier": "security@debian.org", "published": "2014-03-01T00:01:09.387", "lastModified": "2017-08-29T01:34:29.200", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "Directory traversal vulnerability in the CLI job creation (hudson/cli/CreateJobCommand.java) in Jenkins before 1.551 and LTS before 1.532.2 allows remote authenticated users to overwrite arbitrary files via the job name."}, {"lang": "es", "value": "Vulnerabilidad de salto de directorio en la creaci\u00f3n de trabajo de CLI (hudson/cli/CreateJobCommand.java) en Jenkins en versiones anteriores a 1.551 y LTS en versiones anteriores a 1.532.2 permite a usuarios remotos autenticados sobrescribir archivos arbitrarios a trav\u00e9s del nombre de trabajo."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:jenkins:jenkins:*:*:*:*:lts:*:*:*", "versionEndIncluding": "1.532.1", "matchCriteriaId": "F5EDE52E-F7BE-457D-8E56-F24800F02241"}]}]}, {"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:jenkins:jenkins:*:*:*:*:*:*:*:*", "versionEndIncluding": "1.550", "matchCriteriaId": "07E4FEB5-A7D9-49FE-839A-0D650CC19C42"}]}]}], "references": [{"url": "http://seclists.org/oss-sec/2014/q1/421", "source": "security@debian.org"}, {"url": "https://exchange.xforce.ibmcloud.com/vulnerabilities/91346", "source": "security@debian.org"}, {"url": "https://github.com/jenkinsci/jenkins/commit/ad38d8480f20ce3cbf8fec3e2003bc83efda4f7d", "source": "security@debian.org", "tags": ["Patch"]}, {"url": "https://wiki.jenkins-ci.org/display/SECURITY/Jenkins+Security+Advisory+2014-02-14", "source": "security@debian.org", "tags": ["Vendor Advisory"]}]}, "github_commit_url": "https://github.com/jenkinsci/jenkins/commit/ad38d8480f20ce3cbf8fec3e2003bc83efda4f7d"}}