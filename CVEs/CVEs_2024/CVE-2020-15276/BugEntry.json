{"buggy_code": ["<?php\n/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) baserCMS Users Community <https://basercms.net/community/>\n *\n * @copyright\t\tCopyright (c) baserCMS Users Community\n * @link\t\t\thttps://basercms.net baserCMS Project\n * @package\t\t\tBaser.View\n * @since\t\t\tbaserCMS v 4.4.0\n * @license\t\t\thttps://basercms.net/license/index.html\n */\n\n/**\n * \u30d6\u30ed\u30b0\u30b3\u30e1\u30f3\u30c8\n * \u547c\u51fa\u7b87\u6240\uff1a\u30d6\u30ed\u30b0\u8a18\u4e8b\u8a73\u7d30\n *\n * @var BcAppView $this\n * @var array $dbData \u30b3\u30e1\u30f3\u30c8\u30c7\u30fc\u30bf\n */\n?>\n\n\n<?php if (!empty($dbData)): ?>\n\t<?php if ($dbData['status']): ?>\n<div class=\"bs-blog-comment__list-item\" id=\"Comment<?php echo $dbData['no'] ?>\">\n\t<div class=\"bs-blog-comment__list-item-name\">\n\t\t<?php if ($dbData['url']): ?>\n\t\t\t<?php $this->BcBaser->link($dbData['name'], $dbData['url'], ['target' => '_blank']) ?>\n\t\t<?php else: ?>\n\t\t\t<?php echo $dbData['name'] ?>\n\t\t<?php endif ?>\n\t</div>\n\t<div class=\"bs-blog-comment__list-item-message\">\n\t\t<?php echo nl2br($this->BcText->autoLinkUrls($dbData['message'])) ?>\n\t</div>\n</div>\n\t<?php endif ?>\n<?php endif ?>\n", "<?php $this->BcBaser->js('admin/libs/jquery.baseUrl.js', false, ['once' => true]); ?>\n<?php $this->BcBaser->js('admin/libs/jquery.bcUtil.js', false, ['once' => true]); ?>\n<?php $this->BcBaser->js('admin/libs/jquery.bcToken.js', false, ['once' => true]); ?>\n<?php $this->BcBaser->js('Blog.blog_comments_scripts.js', false, [\n\t'once' => true,\n\t'id' => 'BlogCommentsScripts',\n\t'data-alertMessageName' => __('\u304a\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044'),\n\t'data-alertMessageComment' => __('\u30b3\u30e1\u30f3\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044'),\n\t'data-alertMessageAuthImage' => __('\u753b\u50cf\u306e\u6587\u5b57\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044'),\n\t'data-alertMessageAuthComplate' => __('\u9001\u4fe1\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\u9001\u4fe1\u3055\u308c\u305f\u5185\u5bb9\u306f\u78ba\u8a8d\u5f8c\u516c\u958b\u3055\u305b\u3066\u9802\u304d\u307e\u3059\u3002'),\n\t'data-alertMessageComplate' => __('\u30b3\u30e1\u30f3\u30c8\u306e\u9001\u4fe1\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002'),\n\t'data-alertMessageError' => __('\u30b3\u30e1\u30f3\u30c8\u306e\u9001\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u5165\u529b\u5185\u5bb9\u3092\u898b\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002'),\n]); ?>\n<div id=\"BaseUrl\" style=\"display: none\"><?php echo $this->request->base; ?></div>\n\n<script>\n\tauthCaptcha = <?php echo $blogContent['BlogContent']['auth_captcha'] ? 'true' : 'false'; ?>;\n\tcommentApprove = <?php echo $blogContent['BlogContent']['comment_approve'] ? 'true' : 'false'; ?>;\n\n\t$(function() {\n\t\tloadAuthCaptcha();\n\t\t$(\"#BlogCommentAddButton\").click(function() {\n\t\t\tsendComment();\n\t\t\treturn false;\n\t\t});\n\t});\n</script>\n"], "fixing_code": ["<?php\n/**\n * baserCMS :  Based Website Development Project <https://basercms.net>\n * Copyright (c) baserCMS Users Community <https://basercms.net/community/>\n *\n * @copyright\t\tCopyright (c) baserCMS Users Community\n * @link\t\t\thttps://basercms.net baserCMS Project\n * @package\t\t\tBaser.View\n * @since\t\t\tbaserCMS v 4.4.0\n * @license\t\t\thttps://basercms.net/license/index.html\n */\n\n/**\n * \u30d6\u30ed\u30b0\u30b3\u30e1\u30f3\u30c8\n * \u547c\u51fa\u7b87\u6240\uff1a\u30d6\u30ed\u30b0\u8a18\u4e8b\u8a73\u7d30\n *\n * @var BcAppView $this\n * @var array $dbData \u30b3\u30e1\u30f3\u30c8\u30c7\u30fc\u30bf\n */\n?>\n\n\n<?php if (!empty($dbData)): ?>\n\t<?php if ($dbData['status']): ?>\n<div class=\"bs-blog-comment__list-item\" id=\"Comment<?php echo $dbData['no'] ?>\">\n\t<div class=\"bs-blog-comment__list-item-name\">\n\t\t<?php if ($dbData['url']): ?>\n\t\t\t<?php $this->BcBaser->link($dbData['name'], $dbData['url'], ['target' => '_blank', 'escape' => true]) ?>\n\t\t<?php else: ?>\n\t\t\t<?php echo h($dbData['name']) ?>\n\t\t<?php endif ?>\n\t</div>\n\t<div class=\"bs-blog-comment__list-item-message\">\n\t\t<?php echo nl2br($this->BcText->autoLinkUrls($dbData['message'])) ?>\n\t</div>\n</div>\n\t<?php endif ?>\n<?php endif ?>\n", "<?php $this->BcBaser->js('admin/libs/jquery.baseUrl.js', false, ['once' => true]); ?>\n<?php $this->BcBaser->js('admin/libs/jquery.bcUtil.js', false, ['once' => true]); ?>\n<?php $this->BcBaser->js('admin/libs/jquery.bcToken.js', false, ['once' => true]); ?>\n<?php $this->BcBaser->js('Blog.blog_comments_scripts.js', false, [\n\t'once' => true,\n\t'id' => 'BlogCommentsScripts',\n\t'data-alertMessageName' => __('\u304a\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044'),\n\t'data-alertMessageComment' => __('\u30b3\u30e1\u30f3\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044'),\n\t'data-alertMessageAuthImage' => __('\u753b\u50cf\u306e\u6587\u5b57\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044'),\n\t'data-alertMessageAuthComplate' => __('\u9001\u4fe1\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\u9001\u4fe1\u3055\u308c\u305f\u5185\u5bb9\u306f\u78ba\u8a8d\u5f8c\u516c\u958b\u3055\u305b\u3066\u9802\u304d\u307e\u3059\u3002'),\n\t'data-alertMessageComplate' => __('\u30b3\u30e1\u30f3\u30c8\u306e\u9001\u4fe1\u304c\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002'),\n\t'data-alertMessageError' => __('\u30b3\u30e1\u30f3\u30c8\u306e\u9001\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u5165\u529b\u5185\u5bb9\u3092\u898b\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002'),\n]); ?>\n<div id=\"BaseUrl\" style=\"display: none\"><?php echo h($this->request->base); ?></div>\n\n<script>\n\tauthCaptcha = <?php echo $blogContent['BlogContent']['auth_captcha'] ? 'true' : 'false'; ?>;\n\tcommentApprove = <?php echo $blogContent['BlogContent']['comment_approve'] ? 'true' : 'false'; ?>;\n\n\t$(function() {\n\t\tloadAuthCaptcha();\n\t\t$(\"#BlogCommentAddButton\").click(function() {\n\t\t\tsendComment();\n\t\t\treturn false;\n\t\t});\n\t});\n</script>\n"], "filenames": ["lib/Baser/Config/theme/bc_sample/Elements/blog_comment.php", "lib/Baser/Plugin/Blog/View/Elements/blog_comments_scripts.php"], "buggy_code_start_loc": [28, 14], "buggy_code_end_loc": [31, 15], "fixing_code_start_loc": [28, 14], "fixing_code_end_loc": [31, 15], "type": "CWE-79", "message": "baserCMS before version 4.4.1 is vulnerable to Cross-Site Scripting. Arbitrary JavaScript may be executed by entering a crafted nickname in blog comments. The issue affects the blog comment component. It is fixed in version 4.4.1.", "other": {"cve": {"id": "CVE-2020-15276", "sourceIdentifier": "security-advisories@github.com", "published": "2020-10-30T19:15:12.707", "lastModified": "2020-11-03T16:47:27.047", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "baserCMS before version 4.4.1 is vulnerable to Cross-Site Scripting. Arbitrary JavaScript may be executed by entering a crafted nickname in blog comments. The issue affects the blog comment component. It is fixed in version 4.4.1."}, {"lang": "es", "value": "baserCMS anterior a la versi\u00f3n 4.4.1, es vulnerable a un ataque de tipo Cross-Site Scripting.&#xa0;Un JavaScript arbitrario puede ser ejecutado ingresando un alias dise\u00f1ado en los comentarios del blog.&#xa0;El problema afecta al componente blog comment.&#xa0;Esto es corregido en la versi\u00f3n 4.4.1"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 8.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.3, "impactScore": 5.8}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "NONE", "baseScore": 7.7, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.3, "impactScore": 5.8}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:basercms:basercms:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.0.0", "versionEndExcluding": "4.4.1", "matchCriteriaId": "BAB5F8EC-8396-41C0-8D37-10F8489CA598"}]}]}], "references": [{"url": "https://basercms.net/security/20201029", "source": "security-advisories@github.com", "tags": ["Vendor Advisory"]}, {"url": "https://github.com/baserproject/basercms/commit/d14f506385f21d67d5ff3462f204d4c2321b7c54", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/baserproject/basercms/security/advisories/GHSA-fw5q-j9p4-3vxg", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/baserproject/basercms/commit/d14f506385f21d67d5ff3462f204d4c2321b7c54"}}