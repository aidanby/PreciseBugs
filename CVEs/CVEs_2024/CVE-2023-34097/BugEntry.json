{"buggy_code": ["import { NestFactory } from '@nestjs/core';\nimport { json } from 'express';\nimport { AppModule } from './app.module';\nimport * as cookieParser from 'cookie-parser';\nimport { VersioningType } from '@nestjs/common';\nimport * as session from 'express-session';\nimport { emitGQLSchemaFile } from './gql-schema';\n\nasync function bootstrap() {\n  console.log(`Running in production: ${process.env.PRODUCTION}`);\n  console.log(`Port: ${process.env.PORT}`);\n  console.log(`Database: ${process.env.DATABASE_URL}`);\n\n  const app = await NestFactory.create(AppModule);\n\n  app.use(\n    session({\n      secret: process.env.SESSION_SECRET,\n    }),\n  );\n\n  // Increase fil upload limit to 50MB\n  app.use(\n    json({\n      limit: '100mb',\n    }),\n  );\n\n  if (process.env.PRODUCTION === 'false') {\n    console.log('Enabling CORS with development settings');\n\n    app.enableCors({\n      origin: process.env.WHITELISTED_ORIGINS.split(','),\n      credentials: true,\n    });\n  } else {\n    console.log('Enabling CORS with production settings');\n\n    app.enableCors({\n      origin: process.env.WHITELISTED_ORIGINS.split(','),\n      credentials: true,\n    });\n  }\n  app.enableVersioning({\n    type: VersioningType.URI,\n  });\n  app.use(cookieParser());\n  await app.listen(process.env.PORT || 3170);\n}\n\nif (!process.env.GENERATE_GQL_SCHEMA) {\n  bootstrap();\n} else {\n  emitGQLSchemaFile();\n}\n"], "fixing_code": ["import { NestFactory } from '@nestjs/core';\nimport { json } from 'express';\nimport { AppModule } from './app.module';\nimport * as cookieParser from 'cookie-parser';\nimport { VersioningType } from '@nestjs/common';\nimport * as session from 'express-session';\nimport { emitGQLSchemaFile } from './gql-schema';\n\nasync function bootstrap() {\n  console.log(`Running in production: ${process.env.PRODUCTION}`);\n  console.log(`Port: ${process.env.PORT}`);\n\n  const app = await NestFactory.create(AppModule);\n\n  app.use(\n    session({\n      secret: process.env.SESSION_SECRET,\n    }),\n  );\n\n  // Increase fil upload limit to 50MB\n  app.use(\n    json({\n      limit: '100mb',\n    }),\n  );\n\n  if (process.env.PRODUCTION === 'false') {\n    console.log('Enabling CORS with development settings');\n\n    app.enableCors({\n      origin: process.env.WHITELISTED_ORIGINS.split(','),\n      credentials: true,\n    });\n  } else {\n    console.log('Enabling CORS with production settings');\n\n    app.enableCors({\n      origin: process.env.WHITELISTED_ORIGINS.split(','),\n      credentials: true,\n    });\n  }\n  app.enableVersioning({\n    type: VersioningType.URI,\n  });\n  app.use(cookieParser());\n  await app.listen(process.env.PORT || 3170);\n}\n\nif (!process.env.GENERATE_GQL_SCHEMA) {\n  bootstrap();\n} else {\n  emitGQLSchemaFile();\n}\n"], "filenames": ["packages/hoppscotch-backend/src/main.ts"], "buggy_code_start_loc": [12], "buggy_code_end_loc": [13], "fixing_code_start_loc": [11], "fixing_code_end_loc": [11], "type": "CWE-532", "message": "hoppscotch is an open source API development ecosystem. In versions prior to 2023.4.5 the database password is exposed in the logs when showing the database connection string. Attackers with access to read system logs will be able to elevate privilege with full access to the database. Users are advised to upgrade. There are no known workarounds for this vulnerability. ", "other": {"cve": {"id": "CVE-2023-34097", "sourceIdentifier": "security-advisories@github.com", "published": "2023-06-05T21:15:11.290", "lastModified": "2023-06-13T17:20:19.417", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "hoppscotch is an open source API development ecosystem. In versions prior to 2023.4.5 the database password is exposed in the logs when showing the database connection string. Attackers with access to read system logs will be able to elevate privilege with full access to the database. Users are advised to upgrade. There are no known workarounds for this vulnerability. "}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 8.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.8, "impactScore": 5.9}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H", "attackVector": "LOCAL", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.8, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.8, "impactScore": 5.9}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-532"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:hoppscotch:hoppscotch:*:*:*:*:*:*:*:*", "versionEndExcluding": "2023.4.5", "matchCriteriaId": "972DADE9-2C4F-43EF-888F-CC45177A10EB"}]}]}], "references": [{"url": "https://github.com/hoppscotch/hoppscotch/commit/15424903ede20b155d764abf4c4f7c2c84c11247", "source": "security-advisories@github.com", "tags": ["Patch"]}, {"url": "https://github.com/hoppscotch/hoppscotch/security/advisories/GHSA-qpx8-wq6q-r833", "source": "security-advisories@github.com", "tags": ["Exploit", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/hoppscotch/hoppscotch/commit/15424903ede20b155d764abf4c4f7c2c84c11247"}}