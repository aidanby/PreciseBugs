{"buggy_code": ["\u362e\u362e\u360a", "<?php\r\n// - - - - - - - - - - - - - BEGIN LICENSE BLOCK - - - - - - - - - - - - -\r\n// Version: MPL 1.1/GPL 2.0/LGPL 2.1\r\n//\r\n// The contents of this file are subject to the Mozilla Public License Version\r\n// 1.1 (the \"License\"); you may not use this file except in compliance with\r\n// the License. You may obtain a copy of the License at\r\n// http://www.mozilla.org/MPL/\r\n//\r\n// Software distributed under the License is distributed on an \"AS IS\" basis,\r\n// WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\r\n// for the specific language governing rights and limitations under the\r\n// License.\r\n//\r\n// The Original Code is sitefusion.sourceforge.net code.\r\n//\r\n// The Initial Developer of the Original Code is\r\n// FrontDoor Media Group.\r\n// Portions created by the Initial Developer are Copyright (C) 2009\r\n// the Initial Developer. All Rights Reserved.\r\n//\r\n// Contributor(s):\r\n//   Nikki Auburger <nikki@thefrontdoor.nl> (original author)\r\n//   Tom Peeters <tom@thefrontdoor.nl>\r\n//\r\n// - - - - - - - - - - - - - - END LICENSE BLOCK - - - - - - - - - - - - -\r\n\r\n\r\n/**\r\n * @package Webfrontend\r\n*/\r\n\r\nob_implicit_flush();\r\n\r\ninclude( '../conf/webfrontend.conf' );\r\ninclude( 'functions.php' );\r\n\r\n$extension = $_GET['extension'];\r\nif( strpos($extension,'/') || strpos($extension,\"\\\\\") or !file_exists($path = $WEBCONFIG['sitefusionPath'].'/extensions/'.$extension) ) {\r\n\techo \"Invalid extension: $extension\";\r\n\texit(1);\r\n}\r\n\r\nheader( 'Content-type: application/octet-stream' );\r\nheader( 'Content-length: ' . filesize($path) );\r\n\r\nreadfile( $path );\r\n"], "fixing_code": ["\u362e\u362e\u370a", "<?php\r\n// - - - - - - - - - - - - - BEGIN LICENSE BLOCK - - - - - - - - - - - - -\r\n// Version: MPL 1.1/GPL 2.0/LGPL 2.1\r\n//\r\n// The contents of this file are subject to the Mozilla Public License Version\r\n// 1.1 (the \"License\"); you may not use this file except in compliance with\r\n// the License. You may obtain a copy of the License at\r\n// http://www.mozilla.org/MPL/\r\n//\r\n// Software distributed under the License is distributed on an \"AS IS\" basis,\r\n// WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License\r\n// for the specific language governing rights and limitations under the\r\n// License.\r\n//\r\n// The Original Code is sitefusion.sourceforge.net code.\r\n//\r\n// The Initial Developer of the Original Code is\r\n// FrontDoor Media Group.\r\n// Portions created by the Initial Developer are Copyright (C) 2009\r\n// the Initial Developer. All Rights Reserved.\r\n//\r\n// Contributor(s):\r\n//   Nikki Auburger <nikki@thefrontdoor.nl> (original author)\r\n//   Tom Peeters <tom@thefrontdoor.nl>\r\n//\r\n// - - - - - - - - - - - - - - END LICENSE BLOCK - - - - - - - - - - - - -\r\n\r\n\r\n/**\r\n * @package Webfrontend\r\n*/\r\n\r\nob_implicit_flush();\r\n\r\ninclude( '../conf/webfrontend.conf' );\r\ninclude( 'functions.php' );\r\n\r\n$extension = $_GET['extension'];\r\n$allowedRoot = realpath($WEBCONFIG['sitefusionPath'].'/extensions');\r\n$path = realpath($allowedRoot.'/'.$extension);\r\n\r\nif (!(substr($path, 0, strlen($allowedRoot)) == $allowedRoot && file_exists($path))) {\r\n\techo \"Invalid extension: $extension\";\r\n\texit(1);\r\n}\r\n\r\nheader( 'Content-type: application/octet-stream' );\r\nheader( 'Content-length: ' . filesize($path) );\r\n\r\nreadfile( $path );\r\n"], "filenames": ["VERSION", "www/getextension.php"], "buggy_code_start_loc": [1, 39], "buggy_code_end_loc": [2, 40], "fixing_code_start_loc": [1, 39], "fixing_code_end_loc": [2, 43], "type": "CWE-22", "message": "A vulnerability, which was classified as problematic, was found in SiteFusion Application Server up to 6.6.6. This affects an unknown part of the file getextension.php of the component Extension Handler. The manipulation leads to path traversal. Upgrading to version 6.6.7 is able to address this issue. The name of the patch is 49fff155c303d6cd06ce8f97bba56c9084bf08ac. It is recommended to upgrade the affected component. The identifier VDB-219765 was assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2016-15023", "sourceIdentifier": "cna@vuldb.com", "published": "2023-01-31T20:15:09.467", "lastModified": "2023-02-08T22:19:58.580", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A vulnerability, which was classified as problematic, was found in SiteFusion Application Server up to 6.6.6. This affects an unknown part of the file getextension.php of the component Extension Handler. The manipulation leads to path traversal. Upgrading to version 6.6.7 is able to address this issue. The name of the patch is 49fff155c303d6cd06ce8f97bba56c9084bf08ac. It is recommended to upgrade the affected component. The identifier VDB-219765 was assigned to this vulnerability."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:A/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N", "attackVector": "ADJACENT_NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:A/AC:L/Au:S/C:P/I:N/A:N", "accessVector": "ADJACENT_NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 2.7}, "baseSeverity": "LOW", "exploitabilityScore": 5.1, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-22"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sitefusion:application_server:*:*:*:*:*:*:*:*", "versionEndExcluding": "6.6.7", "matchCriteriaId": "58771223-F790-4110-9B63-DBF6A9CA7D8F"}]}]}], "references": [{"url": "https://github.com/sitefusion/server/commit/49fff155c303d6cd06ce8f97bba56c9084bf08ac", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/sitefusion/server/pull/67", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/sitefusion/server/releases/tag/v6.6.7", "source": "cna@vuldb.com", "tags": ["Release Notes", "Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.219765", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.219765", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/sitefusion/server/commit/49fff155c303d6cd06ce8f97bba56c9084bf08ac"}}