{"buggy_code": ["<?php\r\n\r\n//zbieranie danych\r\nfunction add_views($postID) {\r\n\tglobal $wpdb;\r\n\t$popular_posts_statistics_table = $wpdb->prefix . 'popular_posts_statistics';\r\n\tif (!$wpdb->query(\"SELECT hit_count FROM $popular_posts_statistics_table WHERE post_id = $postID\") && $postID != 1 && !preg_match('/bot|spider|crawler|slurp|curl|^$/i', $_SERVER['HTTP_USER_AGENT'])) { //je\u015bli nie istnieje rekord hit_count z podanym ID oraz ID nie jest r\u00f3wne 1 oraz odwiedzaj\u0105cy nie jest botem\r\n\t\t$result = $wpdb->query(\"INSERT INTO $popular_posts_statistics_table (post_id, hit_count, date) VALUES ($postID, 1, NOW())\"); //dodaje do tablicy id postu, date oraz hit\r\n\t}elseif ($postID != 1 && !preg_match('/bot|spider|crawler|slurp|curl|^$/i', $_SERVER['HTTP_USER_AGENT'])) { //w innym przypadku...\r\n\t\t$hitsnumber = $wpdb->get_results(\"SELECT hit_count FROM $popular_posts_statistics_table WHERE post_id = $postID\", ARRAY_A);\r\n\t\t$hitsnumber = $hitsnumber[0]['hit_count'];\r\n\t\t$result = $wpdb->query(\"UPDATE $popular_posts_statistics_table SET hit_count = $hitsnumber + 1, date =  NOW() WHERE post_id = $postID\");\r\n\t}\r\n}\r\n\r\n//wy\u015bwietlanie wynik\u00f3w\r\nfunction show_views($postID, $posnumber, $numberofdays, $ignoredpages) {\r\n\tglobal $wpdb;\r\n\t$popular_posts_statistics_table = $wpdb->prefix . 'popular_posts_statistics';\r\n\t$posts_table = $wpdb->prefix . 'posts';\r\n\tif ($wpdb->query(\"SELECT hit_count FROM $popular_posts_statistics_table\")) {\r\n\t\t$result = $wpdb->get_results(\"SELECT hit_count FROM $popular_posts_statistics_table WHERE date >= NOW() - INTERVAL $numberofdays DAY ORDER BY hit_count DESC\", ARRAY_A);\r\n\t\t$post_id_number = $wpdb->get_results(\"SELECT post_id FROM $popular_posts_statistics_table WHERE date >= NOW() - INTERVAL $numberofdays DAY ORDER BY hit_count DESC LIMIT $posnumber\", ARRAY_A);\r\n\t\techo \"<ol>\";\r\n\t\tfor ($i = 0; $i < count($post_id_number); ++$i) {\r\n\t\t\t$post_number = $post_id_number[$i]['post_id'];\r\n\t\t\t$post_link = get_permalink($post_number); //zdobywanie permalinka\r\n\t\t\t$countbeginning = \"<br /><span id=\\\"pp-count\\\">\";\r\n\t\t\t$countending = \"</span></span><br />\";\r\n\t\t\t$post_name_by_id = $wpdb->get_results(\"SELECT post_title FROM $posts_table WHERE ID = $post_number\", ARRAY_A);\r\n\t\t\tif (!$post_name_by_id){ //sprawdza, czy post o danym ID istnieje, je\u015bli nie - kasuje rekord i przerywa skrypt (kt\u00f3ry by wy\u015bwietla\u0142 b\u0142\u0105d w pierwszej linii)\r\n\t\t\t\t$wpdb->query(\"DELETE FROM $popular_posts_statistics_table WHERE post_id = $post_number\");\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (in_array($post_number, $ignoredpages)) { //sprawdza, czy postu nie ma na li\u015bcie ban\u00f3w\r\n\t\t\t\t$cat_or_post_check = TRUE;\r\n\t\t\t}else {\r\n\t\t\t\t$cat_or_post_check = FALSE;\r\n\t\t\t}\r\n\t\t\tif ($cat_or_post_check == FALSE) {\r\n\t\t\t\tstatic $x = 0; //static powoduje, \u017ce warto\u015b\u0107 x po sko\u0144\u0107zeniu p\u0119tli nie jest zerowana\r\n\t\t\t\techo '<span id=\"pp-' . $x++ . '-title\">' . '<a href=\"' . $post_link . '\">' . $post_name_by_id[0]['post_title'] . '</a>';\r\n\t\t\t\techo $countbeginning . $result[$i]['hit_count'] . \" visit(s)\" . $countending;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n?>", "<?php\r\n/*\r\nPlugin Name: Most Popular Posts Widget Lite\r\nPlugin URI: http://smartfan.pl/\r\nDescription: Widget which displays statistics of most popular posts based on mumber of visits. Lite version.\r\nAuthor: Piotr Pesta\r\nVersion: 0.8\r\nAuthor URI: http://smartfan.pl/\r\nLicense: GPL12\r\n*/\r\n\r\ninclude 'functions.php';\r\n\r\n$options = get_option('widget_popular_posts_statistics');\r\n\r\nregister_activation_hook(__FILE__, 'popular_posts_statistics_activate'); //akcja podczas aktywacji pluginu\r\nregister_uninstall_hook(__FILE__, 'popular_posts_statistics_uninstall'); //akcja podczas deaktywacji pluginu\r\n\r\n// instalacja i zak\u0142adanie tabeli w mysql\r\nfunction popular_posts_statistics_activate() {\r\n\tglobal $wpdb;\r\n\t$popular_posts_statistics_table = $wpdb->prefix . 'popular_posts_statistics';\r\n\t\t$wpdb->query(\"CREATE TABLE IF NOT EXISTS $popular_posts_statistics_table (\r\n\t\tid BIGINT(50) NOT NULL AUTO_INCREMENT PRIMARY KEY,\r\n\t\tpost_id BIGINT(50) NOT NULL,\r\n\t\thit_count BIGINT(50),\r\n\t\tdate DATETIME\r\n\t\t);\");\r\n}\r\n\r\n// podczas odinstalowania - usuwanie tabeli\r\nfunction popular_posts_statistics_uninstall() {\r\n\tglobal $wpdb;\r\n\t$popular_posts_statistics_table = $wpdb->prefix . 'popular_posts_statistics';\r\n\tdelete_option('widget_popular_posts_statistics');\r\n\t$wpdb->query( \"DROP TABLE IF EXISTS $popular_posts_statistics_table\" );\r\n}\r\n\r\nclass popular_posts_statistics extends WP_Widget {\r\n\r\n// konstruktor widgetu\r\nfunction popular_posts_statistics() {\r\n\r\n\t$this->WP_Widget(false, $name = __('Most Popular Posts Widget Lite', 'wp_widget_plugin'));\r\n\r\n}\r\n\r\n// tworzenie widgetu, back end (form)\r\nfunction form($instance) {\r\n\r\n// nadawanie i \u0142\u0105czenie defaultowych warto\u015bci\r\n\t$defaults = array('ignoredpages' => '', 'numberofdays' => '7', 'posnumber' => '5', 'title' => 'Popular Posts By Views In The Last 7 Days');\r\n\t$instance = wp_parse_args( (array) $instance, $defaults );\r\n?>\r\n\r\n<p>\r\n\t<label for=\"<?php echo $this->get_field_id( 'title' ); ?>\">Title:</label>\r\n\t<input id=\"<?php echo $this->get_field_id( 'title' ); ?>\" name=\"<?php echo $this->get_field_name( 'title' ); ?>\" value=\"<?php echo $instance['title']; ?>\" style=\"width:100%;\" />\r\n</p>\r\n\r\n<p>\r\n<label for=\"<?php echo $this->get_field_id( 'posnumber' ); ?>\">Number of positions:</label>\r\n<select id=\"<?php echo $this->get_field_id( 'posnumber' ); ?>\" name=\"<?php echo $this->get_field_name('posnumber'); ?>\" value=\"<?php echo $instance['posnumber']; ?>\" style=\"width:100%;\">\t\r\n\t<option value=\"2\" <?php if ($instance['posnumber']==2) {echo \"selected\"; } ?>>1</option>\r\n\t<option value=\"3\" <?php if ($instance['posnumber']==3) {echo \"selected\"; } ?>>2</option>\r\n\t<option value=\"4\" <?php if ($instance['posnumber']==4) {echo \"selected\"; } ?>>3</option>\r\n\t<option value=\"5\" <?php if ($instance['posnumber']==5) {echo \"selected\"; } ?>>4</option>\r\n\t<option value=\"6\" <?php if ($instance['posnumber']==6) {echo \"selected\"; } ?>>5</option>\r\n\t<option value=\"7\" <?php if ($instance['posnumber']==7) {echo \"selected\"; } ?>>6</option>\r\n\t<option value=\"8\" <?php if ($instance['posnumber']==8) {echo \"selected\"; } ?>>7</option>\r\n\t<option value=\"9\" <?php if ($instance['posnumber']==9) {echo \"selected\"; } ?>>8</option>\r\n\t<option value=\"10\" <?php if ($instance['posnumber']==10) {echo \"selected\"; } ?>>9</option>\r\n\t<option value=\"11\" <?php if ($instance['posnumber']==11) {echo \"selected\"; } ?>>10</option>\r\n</select>\r\n</p>\r\n\r\n<p>\r\n<label for=\"<?php echo $this->get_field_id( 'numberofdays' ); ?>\">Number of days:</label>\r\n<select id=\"<?php echo $this->get_field_id( 'numberofdays' ); ?>\" name=\"<?php echo $this->get_field_name('numberofdays'); ?>\" value=\"<?php echo $instance['numberofdays']; ?>\" style=\"width:100%;\">\r\n\t<option value=\"1\" <?php if ($instance['numberofdays']==1) {echo \"selected\"; } ?>>1</option>\r\n\t<option value=\"2\" <?php if ($instance['numberofdays']==2) {echo \"selected\"; } ?>>2</option>\r\n\t<option value=\"3\" <?php if ($instance['numberofdays']==3) {echo \"selected\"; } ?>>3</option>\r\n\t<option value=\"4\" <?php if ($instance['numberofdays']==4) {echo \"selected\"; } ?>>4</option>\r\n\t<option value=\"5\" <?php if ($instance['numberofdays']==5) {echo \"selected\"; } ?>>5</option>\r\n\t<option value=\"6\" <?php if ($instance['numberofdays']==6) {echo \"selected\"; } ?>>6</option>\r\n\t<option value=\"7\" <?php if ($instance['numberofdays']==7) {echo \"selected\"; } ?>>7</option>\r\n</select>\r\n</p>\r\n\r\n<p>\r\n\t<label for=\"<?php echo $this->get_field_id( 'ignoredpages' ); ?>\">If you would like to exclude any pages from being displayed, you can enter the Page IDs (comma separated, e.g. 34, 25, 439):</label>\r\n\t<input id=\"<?php echo $this->get_field_id( 'ignoredpages' ); ?>\" name=\"<?php echo $this->get_field_name( 'ignoredpages' ); ?>\" value=\"<?php echo $instance['ignoredpages']; ?>\" style=\"width:100%;\" />\r\n</p>\r\n\r\n<?php\r\n\r\n}\r\n\r\nfunction update($new_instance, $old_instance) {\r\n$instance = $old_instance;\r\n\r\n// Dost\u0119pne pola\r\n$instance['title'] = strip_tags($new_instance['title']);\r\n$instance['posnumber'] = strip_tags($new_instance['posnumber']);\r\n$instance['numberofdays'] = strip_tags($new_instance['numberofdays']);\r\n$instance['ignoredpages'] = strip_tags($new_instance['ignoredpages']);\r\nreturn $instance;\r\n}\r\n\r\n// wyswietlanie widgetu, front end (widget)\r\nfunction widget($args, $instance) {\r\nextract($args);\r\n\r\n// to s\u0105 funkcje widgetu\r\n$title = apply_filters('widget_title', $instance['title']);\r\n$posnumber = $instance['posnumber'];\r\n$numberofdays = $instance['numberofdays'];\r\n$ignoredpages = $instance['ignoredpages'];\r\n$ignoredpages = trim(preg_replace('/\\s+/', '', $ignoredpages));\r\n$ignoredpages = explode(\",\",$ignoredpages);\r\necho $before_widget;\r\n\r\n// Sprawdzanie, czy istnieje tytu\u0142\r\nif ($title) {\r\necho $before_title . $title . $after_title;\r\n}\r\n\r\n$postID = get_the_ID();\r\n\r\necho '<div id=\"pp-container\">';\r\nshow_views($postID, $posnumber, $numberofdays, $ignoredpages);\r\necho '</div>';\r\n\r\nadd_views($postID);\r\n\r\necho $after_widget;\r\n}\r\n}\r\n\r\n// rejestracja widgetu\r\nadd_action('widgets_init', create_function('', 'return register_widget(\"popular_posts_statistics\");'));\r\n\r\nadd_action('wp_enqueue_scripts', function () {\r\n\twp_enqueue_style('popular_posts_statistics', plugins_url('style-popular-posts-statistics-1.css', __FILE__)); //nazwa pliku uzale\u017cniona od funkcji i aktualnie obowi\u0105zuj\u0105cej opcji\r\n    });\r\n\r\n?>", "=== Most Popular Posts Widget Lite ===\r\nPlugin Name: Most Popular Posts Widget Lite\r\nPlugin URI: http://smartfan.pl/\r\nTags: widget, bars, pupular, pupularity, visits, counter\r\nAuthor: Piotr Pesta\r\nRequires at least: 2.8.0\r\nTested up to: 4.1\r\nStable tag: 0.8\r\nLicense: GPLv2 or later\r\nLicense URI: http://www.gnu.org/licenses/gpl-2.0.html\r\n\r\nWidget which displays statistics of most popular posts based on mumber of visits. Lite version.\r\n\r\n== Description ==\r\n\r\nMost Popular Posts Widget Lite is a widget that displays statistics of most popular posts based on mumber of visits. Lite version. Easy to customize - just edit CSS file. Soon version with more options and styles.\r\n\r\nWidget could be not compatible with catching plugins, like W3 Total Cache etc.\r\n\r\n== Installation ==\r\n\r\n1. Upload the zip to 'plugins' directory\r\n2. Unzip (steps 1 and 2 can also be performed automatically)\r\n3. Activate the plugin\r\n4. Configure and place the widget on your sidebar\r\n5. Now wait some time until widget gather data to show bars\r\n\r\nOr just add .zip file as a new plugin in your Wordpress administration panel.\r\n\r\n== Screenshots ==\r\n\r\n1. Most Popular Posts Widget Lite visible on right block.\r\n2. Options menu.\r\n\r\n== Changelog ==\r\n* 0.8\r\nInitial Release"], "fixing_code": ["<?php\r\n\r\n//zbieranie danych\r\nfunction add_views($postID) {\r\n\tglobal $wpdb;\r\n\t$popular_posts_statistics_table = $wpdb->prefix . 'popular_posts_statistics';\r\n\tif (!$wpdb->query($wpdb->prepare(\"SELECT hit_count FROM $popular_posts_statistics_table WHERE post_id = %d\", $postID)) && !preg_match('/bot|spider|crawler|slurp|curl|^$/i', $_SERVER['HTTP_USER_AGENT'])) { //je\u015bli nie istnieje rekord hit_count z podanym ID oraz ID nie jest r\u00f3wne 1 oraz odwiedzaj\u0105cy nie jest botem\r\n\t\t$wpdb->query($wpdb->prepare(\"INSERT INTO $popular_posts_statistics_table (post_id, hit_count, date) VALUES (%d, 1, NOW())\", $postID)); //dodaje do tablicy id postu, date oraz hit\r\n\t}elseif (!preg_match('/bot|spider|crawler|slurp|curl|^$/i', $_SERVER['HTTP_USER_AGENT'])) { //w innym przypadku...\r\n\t\t$hitsnumber = $wpdb->get_results($wpdb->prepare(\"SELECT hit_count FROM $popular_posts_statistics_table WHERE post_id = %d\", $postID), ARRAY_A);\r\n\t\t$hitsnumber = $hitsnumber[0]['hit_count'];\r\n\t\t$wpdb->query($wpdb->prepare(\"UPDATE $popular_posts_statistics_table SET hit_count = %d + 1, date =  NOW() WHERE post_id = %d\", $hitsnumber, $postID));\r\n\t}\r\n}\r\n\r\n//wy\u015bwietlanie wynik\u00f3w\r\nfunction show_views($postID, $posnumber, $numberofdays, $ignoredpages) {\r\n\tglobal $wpdb;\r\n\t$popular_posts_statistics_table = $wpdb->prefix . 'popular_posts_statistics';\r\n\t$posts_table = $wpdb->prefix . 'posts';\r\n\tif ($wpdb->query(\"SELECT hit_count FROM $popular_posts_statistics_table\")) {\r\n\t\t$result = $wpdb->get_results($wpdb->prepare(\"SELECT hit_count FROM $popular_posts_statistics_table WHERE date >= NOW() - INTERVAL %d DAY ORDER BY hit_count DESC\", $numberofdays), ARRAY_A);\r\n\t\t$post_id_number = $wpdb->get_results($wpdb->prepare(\"SELECT post_id FROM $popular_posts_statistics_table WHERE date >= NOW() - INTERVAL %d DAY ORDER BY hit_count DESC LIMIT %d\", $numberofdays, $posnumber), ARRAY_A);\r\n\t\techo \"<ol>\";\r\n\t\tfor ($i = 0; $i < count($post_id_number); ++$i) {\r\n\t\t\t$post_number = $post_id_number[$i]['post_id'];\r\n\t\t\t$post_link = get_permalink($post_number); //zdobywanie permalinka\r\n\t\t\t$countbeginning = \"<br /><span id=\\\"pp-count\\\">\";\r\n\t\t\t$countending = \"</span></span><br />\";\r\n\t\t\t$post_name_by_id = $wpdb->get_results($wpdb->prepare(\"SELECT post_title FROM $posts_table WHERE ID = %d\", $post_number), ARRAY_A);\r\n\t\t\tif (!$post_name_by_id){ //sprawdza, czy post o danym ID istnieje, je\u015bli nie - kasuje rekord i przerywa skrypt (kt\u00f3ry by wy\u015bwietla\u0142 b\u0142\u0105d w pierwszej linii)\r\n\t\t\t\t$wpdb->query($wpdb->prepare(\"DELETE FROM $popular_posts_statistics_table WHERE post_id = %d\", $post_number));\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tif (in_array($post_number, $ignoredpages)) { //sprawdza, czy postu nie ma na li\u015bcie ban\u00f3w\r\n\t\t\t\t$cat_or_post_check = TRUE;\r\n\t\t\t}else {\r\n\t\t\t\t$cat_or_post_check = FALSE;\r\n\t\t\t}\r\n\t\t\tif ($cat_or_post_check == FALSE) {\r\n\t\t\t\tstatic $x = 0; //static powoduje, \u017ce warto\u015b\u0107 x po sko\u0144\u0107zeniu p\u0119tli nie jest zerowana\r\n\t\t\t\techo '<span id=\"pp-' . $x++ . '-title\">' . '<a href=\"' . $post_link . '\">' . $post_name_by_id[0]['post_title'] . '</a>';\r\n\t\t\t\techo $countbeginning . $result[$i]['hit_count'] . \" visit(s)\" . $countending;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n?>", "<?php\r\n/*\r\nPlugin Name: Most Popular Posts Widget Lite\r\nPlugin URI: http://smartfan.pl/\r\nDescription: Widget which displays statistics of most popular posts based on mumber of visits. Lite version.\r\nAuthor: Piotr Pesta\r\nVersion: 0.9\r\nAuthor URI: http://smartfan.pl/\r\nLicense: GPL12\r\n*/\r\n\r\ninclude 'functions.php';\r\n\r\n$options = get_option('widget_popular_posts_statistics');\r\n\r\nregister_activation_hook(__FILE__, 'popular_posts_statistics_activate'); //akcja podczas aktywacji pluginu\r\nregister_uninstall_hook(__FILE__, 'popular_posts_statistics_uninstall'); //akcja podczas deaktywacji pluginu\r\n\r\n// instalacja i zak\u0142adanie tabeli w mysql\r\nfunction popular_posts_statistics_activate() {\r\n\tglobal $wpdb;\r\n\t$popular_posts_statistics_table = $wpdb->prefix . 'popular_posts_statistics';\r\n\t\t$wpdb->query(\"CREATE TABLE IF NOT EXISTS $popular_posts_statistics_table (\r\n\t\tid BIGINT(50) NOT NULL AUTO_INCREMENT PRIMARY KEY,\r\n\t\tpost_id BIGINT(50) NOT NULL,\r\n\t\thit_count BIGINT(50),\r\n\t\tdate DATETIME\r\n\t\t);\");\r\n}\r\n\r\n// podczas odinstalowania - usuwanie tabeli\r\nfunction popular_posts_statistics_uninstall() {\r\n\tglobal $wpdb;\r\n\t$popular_posts_statistics_table = $wpdb->prefix . 'popular_posts_statistics';\r\n\tdelete_option('widget_popular_posts_statistics');\r\n\t$wpdb->query( \"DROP TABLE IF EXISTS $popular_posts_statistics_table\" );\r\n}\r\n\r\nclass popular_posts_statistics extends WP_Widget {\r\n\r\n// konstruktor widgetu\r\nfunction popular_posts_statistics() {\r\n\r\n\t$this->WP_Widget(false, $name = __('Most Popular Posts Widget Lite', 'wp_widget_plugin'));\r\n\r\n}\r\n\r\n// tworzenie widgetu, back end (form)\r\nfunction form($instance) {\r\n\r\n// nadawanie i \u0142\u0105czenie defaultowych warto\u015bci\r\n\t$defaults = array('ignoredpages' => '', 'numberofdays' => '7', 'posnumber' => '5', 'title' => 'Popular Posts By Views In The Last 7 Days');\r\n\t$instance = wp_parse_args( (array) $instance, $defaults );\r\n?>\r\n\r\n<p>\r\n\t<label for=\"<?php echo $this->get_field_id( 'title' ); ?>\">Title:</label>\r\n\t<input id=\"<?php echo $this->get_field_id( 'title' ); ?>\" name=\"<?php echo $this->get_field_name( 'title' ); ?>\" value=\"<?php echo $instance['title']; ?>\" style=\"width:100%;\" />\r\n</p>\r\n\r\n<p>\r\n<label for=\"<?php echo $this->get_field_id( 'posnumber' ); ?>\">Number of positions:</label>\r\n<select id=\"<?php echo $this->get_field_id( 'posnumber' ); ?>\" name=\"<?php echo $this->get_field_name('posnumber'); ?>\" value=\"<?php echo $instance['posnumber']; ?>\" style=\"width:100%;\">\t\r\n\t<option value=\"2\" <?php if ($instance['posnumber']==2) {echo \"selected\"; } ?>>1</option>\r\n\t<option value=\"3\" <?php if ($instance['posnumber']==3) {echo \"selected\"; } ?>>2</option>\r\n\t<option value=\"4\" <?php if ($instance['posnumber']==4) {echo \"selected\"; } ?>>3</option>\r\n\t<option value=\"5\" <?php if ($instance['posnumber']==5) {echo \"selected\"; } ?>>4</option>\r\n\t<option value=\"6\" <?php if ($instance['posnumber']==6) {echo \"selected\"; } ?>>5</option>\r\n\t<option value=\"7\" <?php if ($instance['posnumber']==7) {echo \"selected\"; } ?>>6</option>\r\n\t<option value=\"8\" <?php if ($instance['posnumber']==8) {echo \"selected\"; } ?>>7</option>\r\n\t<option value=\"9\" <?php if ($instance['posnumber']==9) {echo \"selected\"; } ?>>8</option>\r\n\t<option value=\"10\" <?php if ($instance['posnumber']==10) {echo \"selected\"; } ?>>9</option>\r\n\t<option value=\"11\" <?php if ($instance['posnumber']==11) {echo \"selected\"; } ?>>10</option>\r\n</select>\r\n</p>\r\n\r\n<p>\r\n<label for=\"<?php echo $this->get_field_id( 'numberofdays' ); ?>\">Number of days:</label>\r\n<select id=\"<?php echo $this->get_field_id( 'numberofdays' ); ?>\" name=\"<?php echo $this->get_field_name('numberofdays'); ?>\" value=\"<?php echo $instance['numberofdays']; ?>\" style=\"width:100%;\">\r\n\t<option value=\"1\" <?php if ($instance['numberofdays']==1) {echo \"selected\"; } ?>>1</option>\r\n\t<option value=\"2\" <?php if ($instance['numberofdays']==2) {echo \"selected\"; } ?>>2</option>\r\n\t<option value=\"3\" <?php if ($instance['numberofdays']==3) {echo \"selected\"; } ?>>3</option>\r\n\t<option value=\"4\" <?php if ($instance['numberofdays']==4) {echo \"selected\"; } ?>>4</option>\r\n\t<option value=\"5\" <?php if ($instance['numberofdays']==5) {echo \"selected\"; } ?>>5</option>\r\n\t<option value=\"6\" <?php if ($instance['numberofdays']==6) {echo \"selected\"; } ?>>6</option>\r\n\t<option value=\"7\" <?php if ($instance['numberofdays']==7) {echo \"selected\"; } ?>>7</option>\r\n</select>\r\n</p>\r\n\r\n<p>\r\n\t<label for=\"<?php echo $this->get_field_id( 'ignoredpages' ); ?>\">If you would like to exclude any pages from being displayed, you can enter the Page IDs (comma separated, e.g. 34, 25, 439):</label>\r\n\t<input id=\"<?php echo $this->get_field_id( 'ignoredpages' ); ?>\" name=\"<?php echo $this->get_field_name( 'ignoredpages' ); ?>\" value=\"<?php echo $instance['ignoredpages']; ?>\" style=\"width:100%;\" />\r\n</p>\r\n\r\n<?php\r\n\r\n}\r\n\r\nfunction update($new_instance, $old_instance) {\r\n$instance = $old_instance;\r\n\r\n// Dost\u0119pne pola\r\n$instance['title'] = strip_tags($new_instance['title']);\r\n$instance['posnumber'] = strip_tags($new_instance['posnumber']);\r\n$instance['numberofdays'] = strip_tags($new_instance['numberofdays']);\r\n$instance['ignoredpages'] = strip_tags($new_instance['ignoredpages']);\r\nreturn $instance;\r\n}\r\n\r\n// wyswietlanie widgetu, front end (widget)\r\nfunction widget($args, $instance) {\r\nextract($args);\r\n\r\n// to s\u0105 funkcje widgetu\r\n$title = apply_filters('widget_title', $instance['title']);\r\n$posnumber = $instance['posnumber'];\r\n$numberofdays = $instance['numberofdays'];\r\n$ignoredpages = $instance['ignoredpages'];\r\n$ignoredpages = trim(preg_replace('/\\s+/', '', $ignoredpages));\r\n$ignoredpages = explode(\",\",$ignoredpages);\r\necho $before_widget;\r\n\r\n// Sprawdzanie, czy istnieje tytu\u0142\r\nif ($title) {\r\necho $before_title . $title . $after_title;\r\n}\r\n\r\n$postID = get_the_ID();\r\n\r\necho '<div id=\"pp-container\">';\r\nshow_views($postID, $posnumber, $numberofdays, $ignoredpages);\r\necho '</div>';\r\n\r\nadd_views($postID);\r\n\r\necho $after_widget;\r\n}\r\n}\r\n\r\n// rejestracja widgetu\r\nadd_action('widgets_init', create_function('', 'return register_widget(\"popular_posts_statistics\");'));\r\n\r\nadd_action('wp_enqueue_scripts', function () {\r\n\twp_enqueue_style('popular_posts_statistics', plugins_url('style-popular-posts-statistics-1.css', __FILE__)); //nazwa pliku uzale\u017cniona od funkcji i aktualnie obowi\u0105zuj\u0105cej opcji\r\n    });\r\n\r\n?>", "=== Most Popular Posts Widget Lite ===\r\nPlugin Name: Most Popular Posts Widget Lite\r\nPlugin URI: http://smartfan.pl/\r\nTags: widget, bars, pupular, pupularity, visits, counter\r\nAuthor: Piotr Pesta\r\nRequires at least: 2.8.0\r\nTested up to: 4.1\r\nStable tag: 0.9\r\nLicense: GPLv2 or later\r\nLicense URI: http://www.gnu.org/licenses/gpl-2.0.html\r\n\r\nWidget which displays statistics of most popular posts based on mumber of visits. Lite version.\r\n\r\n== Description ==\r\n\r\nMost Popular Posts Widget Lite is a widget that displays statistics of most popular posts based on mumber of visits. Lite version. Easy to customize - just edit CSS file. Soon version with more options and styles.\r\n\r\nWidget could be not compatible with catching plugins, like W3 Total Cache etc.\r\n\r\n== Installation ==\r\n\r\n1. Upload the zip to 'plugins' directory\r\n2. Unzip (steps 1 and 2 can also be performed automatically)\r\n3. Activate the plugin\r\n4. Configure and place the widget on your sidebar\r\n5. Now wait some time until widget gather data to show bars\r\n\r\nOr just add .zip file as a new plugin in your Wordpress administration panel.\r\n\r\n== Screenshots ==\r\n\r\n1. Most Popular Posts Widget Lite visible on right block.\r\n2. Options menu.\r\n\r\n== Changelog ==\r\n* 0.8\r\nInitial Release\r\n* 0.9\r\nCode cleanup\r\nSQL Injection security fix"], "filenames": ["functions.php", "pp-popular-posts.php", "readme.txt"], "buggy_code_start_loc": [7, 7, 8], "buggy_code_end_loc": [33, 8, 38], "fixing_code_start_loc": [7, 7, 8], "fixing_code_end_loc": [33, 8, 41], "type": "CWE-89", "message": "A vulnerability was found in Most Popular Posts Widget Plugin up to 0.8 on WordPress. It has been classified as critical. Affected is the function add_views/show_views of the file functions.php. The manipulation leads to sql injection. It is possible to launch the attack remotely. Upgrading to version 0.9 is able to address this issue. The patch is identified as a99667d11ac8d320006909387b100e9a8b5c12e1. It is recommended to upgrade the affected component. VDB-241026 is the identifier assigned to this vulnerability.", "other": {"cve": {"id": "CVE-2015-10124", "sourceIdentifier": "cna@vuldb.com", "published": "2023-10-02T14:15:09.757", "lastModified": "2024-02-29T01:16:12.430", "vulnStatus": "Modified", "descriptions": [{"lang": "en", "value": "A vulnerability was found in Most Popular Posts Widget Plugin up to 0.8 on WordPress. It has been classified as critical. Affected is the function add_views/show_views of the file functions.php. The manipulation leads to sql injection. It is possible to launch the attack remotely. Upgrading to version 0.9 is able to address this issue. The patch is identified as a99667d11ac8d320006909387b100e9a8b5c12e1. It is recommended to upgrade the affected component. VDB-241026 is the identifier assigned to this vulnerability."}, {"lang": "es", "value": "Se encontr\u00f3 una vulnerabilidad en el complemento Most Popular Posts Widget hasta la versi\u00f3n 0.8 en WordPress. Ha sido clasificada como cr\u00edtica. La funci\u00f3n add_views/show_views del archivo functions.php es afectada por la vulnerabilidad. La manipulaci\u00f3n conduce a la inyecci\u00f3n de SQL. Es posible lanzar el ataque de forma remota. La actualizaci\u00f3n a la versi\u00f3n 0.9 puede solucionar este problema. El parche se identifica como a99667d11ac8d320006909387b100e9a8b5c12e1. Se recomienda actualizar el componente afectado. VDB-241026 es el identificador asignado a esta vulnerabilidad."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 9.8, "baseSeverity": "CRITICAL"}, "exploitabilityScore": 3.9, "impactScore": 5.9}, {"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "LOW", "baseScore": 6.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 3.4}], "cvssMetricV2": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P", "accessVector": "NETWORK", "accessComplexity": "LOW", "authentication": "SINGLE", "confidentialityImpact": "PARTIAL", "integrityImpact": "PARTIAL", "availabilityImpact": "PARTIAL", "baseScore": 6.5}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.0, "impactScore": 6.4, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": false}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-89"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:smartfan:most_popular_posts_widget:*:*:*:*:*:wordpress:*:*", "versionEndIncluding": "0.8", "matchCriteriaId": "959F1F7A-8386-44B3-8B16-CB24E9380D81"}]}]}], "references": [{"url": "https://github.com/wp-plugins/most-popular-posts-widget-lite/commit/a99667d11ac8d320006909387b100e9a8b5c12e1", "source": "cna@vuldb.com", "tags": ["Patch"]}, {"url": "https://vuldb.com/?ctiid.241026", "source": "cna@vuldb.com", "tags": ["Permissions Required", "Third Party Advisory"]}, {"url": "https://vuldb.com/?id.241026", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/wp-plugins/most-popular-posts-widget-lite/commit/a99667d11ac8d320006909387b100e9a8b5c12e1"}}