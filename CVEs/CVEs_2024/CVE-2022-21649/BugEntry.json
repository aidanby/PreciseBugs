{"buggy_code": ["Revision history for perl distribution Convos\n\n6.49 Not Released\n - Replaced CONVOS_DEBUG=1 with CONVOS_LOG_LEVEL=trace\n - Updated Italian translation #654\n   Contributor: SerHack\n\n6.48 2021-12-29T19:40:00+0900\n - Fix catching invalid nick change #628\n - Fix showing tooltips on desktop\n - Add notification sound #589\n   Contributor: egomassive\n   Reference: https://freesound.org/people/egomassive/sounds/536748/\n - Add more rules for files with Content-Disposition\n   Contributor: Pocas\n   Reference: https://huntr.dev/bounties/ae424798-de01-4972-b73b-2db674f82368/\n\n6.47 2021-12-28T12:32:00+0900\n - Add more rules for potentially evil svg files\n   Contributor: KhanhCM\n   Reference: https://huntr.dev/bounties/142c3dcc-a882-4799-949b-520be0a4d144\n\n6.46 2021-12-28T11:27:00+0900\n - Using WHOIS instead of ISON to check if a user is online #360\n - Presenting WHOIS information in conversation #360\n - Fix joining already joined conversations\n\n6.45 2021-12-27T22:17:00+0900\n - Add \"Check for updates\" button to Settings page #585\n - Trying to fix connect queue issues with Convos::Util::Queue\n   * Removed connect queue logic from Convos::Core\n - Removed \"queued\" connection state\n - Changing the connection URL username or password will also cause a reconnect\n\n6.44 2021-12-23T16:17:00+0900\n - Fix SASL EXTERNAL authentication\n\n6.43 2021-12-23T14:29:00+0900\n - Add certificate fingerprint to connection form, when chosing \"SASL External\"\n - Add support for quotes around **bold**\n - Add is_true() function to check boolean environment variables\n   for \"0\", \"Off\", \"No\", \"false\", \"1\", \"On\", \"Yes\" or \"true\".\n - Changed default SASL username to nick\n - Setting CONVOS_SYSLOG=1 will disable logging to file\n - Stop replacing \" (quote) with &quot;\n\n6.42 2021-12-21T10:00:00+0900\n - Fix resetting reconnect delay when manually updating connection settings\n - Fix not changing wanted state to \"disconnected\" when updating connection settings\n - Fix double line breaks inside <pre> in the CMS by changing to Text::Markdown::Hoedown\n - Fix not adding space before channel name links\n - Avoid making #123 turn into channel links, since they are often pull request numbers\n\n6.41 2021-12-18T14:58:00+0900\n - Add support for CONVOS_ACCESS_LOG (EXPERIMENTAL)\n   https://github.com/jhthorsen/mojolicious-plugin-syslog#register\n - Add support for CONVOS_SYSLOG (EXPERIMENTAL)\n\n6.40 2021-12-13T22:32:00+0900\n - Add clear search button #631\n - Add CSRF-check to /logout #632\n   Contributors: Devendra Bhatla and Jamie Slome\n   Reference: https://huntr.dev/bounties/77559ff3-0494-4186-b6e9-c4146bedc0df\n\n6.39 2021-11-27T08:50:00+0900\n - Add file management to frontend #426\n - Add GET /files endpoint #426\n - Add DELETE /files/:uid/:fid endpoint #426\n\n6.38 2021-11-26T08:46:00+0900\n - Use Crypt::Passphrase for password hashing #627\n   Contributor: Stig Palmquist\n - Converted file upload into a core feature\n - Changed \"/file\" API endpoint to \"/files\"\n - Removed back compat /paste/:email_hash/:file_hash URL\n - Using \"npm\" (instead of \"pnpm\") to install node modules\n\n6.37 2021-10-19T20:06:00+0900\n - Fix not having to enable and then disable notifications to disable notifications\n\n6.36 2021-10-19T11:52:00+0900\n - Using convos/convos:base as base image to fix builds #624\n\n6.35 2021-10-18T23:27:00+0900\n - Bumped Alpine version to 3.14\n - Fix \"ReferenceError: body is not defined\" #625\n\n6.34 2021-10-18T11:00:00+0900\n - Going to build docker \"stable\" and \"vX.XX\" as linux/amd64 and linux/arm64,\n   while \"alpha\" will be linux/amd64 only\n\n6.33 2021-10-18T10:48:00+0900\n - Fix parsing links that end with a unicode character #563\n\n6.32 2021-10-14T08:45:00+0900\n - Fix vulnerability: Cannot upload svg with javascript #623\n - Add support for password for default connection channel #621\n - Add progress bar for uploads\n\n6.31 2021-10-02T06:51:00+0900\n - Fix turning channel names with \"-\" into links\n - Have to build a different tag for arm64 (for now) #464\n\n6.30 2021-09-25T18:30:00+0900\n - Fix not making links inside links when #fragments are seen\n\n6.29 2021-09-25T18:18:00+0900\n - Fix decoding/encoding password and username for connections #620\n - Fix trying to connect if wanted_state is \"connected\"\n - Fix \"Facts\" bot action to only reply if the fact ends with \"?\"\n - Add channel names are now clickable\n - Add AWAY message to WHOIS response #360\n - Add /away command #360\n - Add more connection states: connecting and disconnecting\n - Add server messages when connections state changes\n - Add \"Retry\" button to loading screen\n\n6.28 2021-09-12T15:38:00+0200\n - Fix notifications styling when channel changes\n - Add styling for conversations with notifications\n - Will update unread/notifications on conversation load, instead of unload\n\n6.27 2021-08-28T16:52:00+0200\n - Changed notifications are now per channel #612\n   Contributor: Jess Robinson\n - Fix not converting %\\d+ strings into \"undefined\" #616\n - Fix not showing conversation settings header on small screen\n\n6.26 2021-07-20T07:09:00+0900\n - Fix clearing the global search\n - Fix \"+#\" and \"+@\" in search bar to also filter \"60+\" #607 #609\n - Fix security issue with toggling \"raw\" for messages\n\n6.25 2021-07-18T10:14:00+0900\n - Add handler for irc:// links #311\n - Add support for raw messages #592\n - Add support for a single character within backticks #602\n - Add settings icon to Notifications page #606\n - Add confirmation before deleting a connection #610\n - Made \"+\" filter in search bar sticky and also filter \"60+\" #607 #609\n - Fix not showing double quotes in previews #608\n - Fix animation when focusing sidebar-header search field\n\n6.24 2021-06-02T10:28:00+0900\n - Add chat input field sent messages/commands history #598\n - Fix rendering notifications with non-unicode characters #596\n - Fix /chat/ will render notifications\n - Fix width of sidebar-header input in Firefox 78.10.0 ESR\n - Changed extended formatting to be stripped frontend code #600\n\n6.23 2021-05-29T11:55:00+0900\n - Add popover on nick click, closes #566, #591\n - Fix hiding menu when selecting an emoji\n - Fix allowing to create new connections for non-admin users\n\n6.22 2021-05-28T10:25:00+0900\n - Add GNOME theme #594\n - Fix joining password protected channels\n\n6.21 2021-05-28T09:43:00+0900\n - Add possibility to remove password protection in Conversation Settings\n - Add active conversation modes to Conversation Settings\n - Can toggle channel modes from conversation settings\n - Fix sending messages to participants in connection conversation\n - Fix setting password in conversation settings\n - Fix setting topic in conversation settings\n - Fix toggling notification in conversation settings\n - Fix bug where conversation modes could get reset\n - Fix bug where user modes could get reset\n - Fix being able to change the topic if the channel has mode -t #427\n\n6.20 2021-05-25T10:03:00+0900\n - Add support for Github Webhooks, through the bot system\n - Compatible with Mojolicious::Plugin::Webpack 1.01\n - Bumped many JavaScript dependencies\n - Fix catching unhandled send_p() promises\n - Fix join/part actions for the bot plugin\n - Fix showing the correct copyright year\n - Fix showing the installed version when running \"convos version\"\n\n6.19 2021-05-20T09:03:00+0900\n - Add support for quotes in the CMS\n\n6.18 2021-05-20T07:30:00+0900\n - Changing defaults from freenode to https://libera.chat/\n - Changed sections toggle styling from checkbox to caret\n\n6.17 2021-05-18T12:13:00+0900\n - Fix not enabling the client side router for CMS pages\n - Fix always rendering the same theme for the CMS pages\n - Add support for CONVOS_DEFAULT_THEME and CONVOS_DEFAULT_SCHEME environment variables\n\n6.16 2021-05-18T11:03:00+0900\n - Add <SimpleField> for form fields without styling\n - Add \"viewport\" store, which replaces \"nColumns\" store\n - Add client side log utility for easier debugging\n   * Can be toggled with \"?_debug=root:trace,category:level\"\n - Fix \"removeConnectionProfile\" operation in the API\n - Fix changing nick, realname, sasl, tls and tls_verify for forced connections\n - Fix changing source IP for connections\n - Fix constrast issues for \"South\" theme\n - Fix only loading emojis once\n - Fix only loading translations once\n - Fix rendering issue when switching between connection profiles and profile editor\n - Bumped rollup and svelte dependencies\n - Changed \"Generate invite link\" button to only be active when an email is filled in\n - Changed client side routing logic\n   * Removed routes.js\n   * Moved routing logic into App.svelte\n - Replaced form \"change\" event handling with svelte stores bound to the form elements\n   * This will hopefully fix some issues where toggling TLS did not work properly\n - Replaced node-sass with sass\n - Removed \"anonymous\" and \"authenticated\" roles from client side User object roles\n - Removed support for \"form\" HTML element and \"start\" event in Operation.js\n - Removed support for showing progress bar when loading data\n - Will use the current connection Id when clicking on \"Add conversation\"\n\n6.15 2021-05-06T10:30:00+0900\n - Fix invitation link handling\n - Fix changing \"Source IP\" fo a connection\n - Improved handling of errors on the login page\n - Improved input field focus on login screen\n - Improved \"Dracula\" theme form field rendering\n - Will reconnect to IRC server when \"Your name\" or \"TLS verify\" changes as well\n\n6.14 2021-04-29T20:30:00+0900\n - Fix iOS bug, where Safari would crash because it can't handle complex regexes\n\n6.13 2021-04-29T10:59:00+0900\n - Add \"Dracula\" color theme\n - Fix handling URLs with conversation names ending with \".js\"\n - Improved emoji autocomplete #547\n - Updated emojis list #547\n - Removed emojis selector from ChatInput on small screens\n - Will set MOJO_REVERSE_PROXY based on CONVOS_REVERSE_PROXY\n\n6.12 2021-04-16T09:45:00+0900\n - Fix on_connect_commands might not be set in all cases\n - Fix toggling TLS and TLS verify checkboxes\n - Improved feedback to user on failed/successful save of forms\n - Improved feedback in case TLS settings are incorrect\n\n6.11 2021-04-10T19:54:00+0900\n - Changed /logout to always result in 302 redirect #586\n - Removed \"dependencies\" from /settings\n\n6.10 2021-04-05T14:12:00+0900\n - Will prompt the user to enable notifications\n - Fix chat action links\n - Fix editing connection when uri= is present\n - Fix position for \"jump to now\" above chat input\n\n6.09 2021-04-05T15:18:00+0900\n - Add \"skip_queue\" to connection profile\n - Fix not skip the connection queue on connect failure\n - Hide port number in connection list\n\n6.08 2021-04-05T12:43:00+0900\n - Add support for some more command aliases #580\n - Add logging of login attempts #582\n - Add support for connection profiles #584\n - Add DELETE /api/connection-profiles/:id #584\n - Add GET /api/connection-profiles #584\n - Add POST /api/connection-profiles #584\n - Add focus to login form on desktop\n - Fix width of inputs on ConversationAdd page\n - Renamed /settings/connection to /settings/connections #584\n - Removed \"protocol\" from Convos::Core::Connection\n - Removed dependencies from \"Settings\"\n - Simpler Convos::Core::Settings by removing support for deprecated environment variables\n - Moved global connection settings from \"Settings\" to \"Connections\" #584\n - Moved \"remote_address\" tracking from connection URL to user object\n\n6.07 2021-03-24T12:44:00+0900\n - Add dependency information to Admin page\n - Fix compatibility with Mojolicious 9.11\n - Fix typo in Fallback.svelte\n\n6.06 2021-03-05T08:30:00+0900\n - Add /shrug command\n - Fix not learning \"h is tory\" facts\n\n6.05 2021-02-23T13:43:00+0900\n - Split advanced options into \"Show advanced settings\" and \"Show authentication settings\"\n\n6.04 2021-02-23T11:43:00+0900\n - Add EXPERIMENTAL support for serving CMS pages as text and yaml\n - Fix only sending \"WEBIRC ...\" command if environment variable is set\n - Fix hiding the sidebar menu when URL changes\n\n6.03 2021-02-23T21:15:00+0900\n - Had to revert Alpine to 3.12 to complete the build on hub.docker.com\n\n6.02 2021-02-23T20:28:00+0900\n - Add default lang to stash #578\n - Add support for convos install [--bot,--ldap]\n - Fix \"/reconnect\" command #576\n - Fix placing password toggle at the right place\n\n6.01 2021-02-23T08:48:00+0900\n - Add support for setting source IP for a connection\n - Changed the design on the login screen to only show one form\n - Fix clipping of text in the heading\n - Fix clicking on a the conversation name toggles the settings pane\n - Fix race condition where \"join\" event would override the \"topic\" message\n\n6.00 2021-02-22T09:30:00+0900\n - Changed from Nordaaker to github.com/convos-chat and hub.docker.com/r/convos\n - Highlights since 5.00\n   * Add \"Facts\" bot action\n   * Add \"compact display mode\" as Viewport option\n   * Add /ns (msg nickserv) and /cs (msg chanserv) aliases\n   * Add better user experience for +i (invite only) channels\n   * Add rendering of banlist, exceptlist, invitelist and quietlist\n   * Add support for EXTERNAL and PLAIN SASL authentication\n   * Add support for WEBIRC\n   * Add support for negotiating IRCv3 capabilities\n   * Add support for nicer message-of-the-day (MOTD) server messages\n   * Add support for translations, and got translated to Italian, Norwegian and Spanish\n   * Changed \"chanserv\" and \"nickserv\" to be inside the connection conversation\n   * Compatible with latest Mojolicious 9.0 and M::P::OpenAPI 4.0\n   * Improved animations\n   * Moved video button to chat input\n   * Render Google meet, Webex and Whereby as video invite links\n - Contributors:\n   * Abhijit Menon-Sen\n   * Iv\u00e1n \u00c1valos\n   * Jan Henning Thorsen\n   * Jos\u00e9 Joaqu\u00edn Atria\n   * Marcus Ramberg\n   * Megaf\n   * SerHack\n   * Thibault Duponchelle\n\n5.32 2021-02-22T09:10:00+0900\n - Can toggle password inputs as plain text #569\n - Add alert icon if a channel is frozen in the sidebar #568\n - Changed login screen to be side-by-side\n\n5.31 2021-02-21T14:30:00+0900\n - Fix styling on login screen\n - Allow other hosts than \"localhost\" to skip the connect queuing\n\n5.30 2021-02-20T16:33:00+0900\n - Add better user experience for +i (invite only) channels #568\n\n5.29 2021-02-20T14:00:00+0900\n - Replaced spinning animation with scale translation between icons\n - Replaced hover zoom effect with circular border\n - Changed the headings to be less bold\n - Changed from \"tools\" icon to \"users-cog\" for conversation settings toggle\n - Moved video button down to chat input\n - Changed the textarea to fill up the whole chat input if multiple lines are present\n - Add (+) icon to the chat input with new action menu on small screens\n   * Start video chat\n   * Upload\n   * Emojis\n\n5.28 2021-02-18T23:11:20+0900\n - Fix video iframe to take full height #570\n - Add support for unicode to the Bot backend storage layer\n - Add error handling to Jitsi\n - Add suport for \"suppress_do_not_know_reply\" ot \"Facts\" bot action\n\n5.27 2021-02-17T23:04:00+0900\n - Compatible with latest Mojolicious 9.0 and M::P::OpenAPI 4.0\n - \"Facts\" bot action will not learn questions\n - Fix searching case insensitive\n\n5.26 2021-02-15T10:34:00+0900\n - Reverted \"Add Content-Security-Policy header to Convos\" #508\n\n5.25 2021-02-15T10:25:00+0900\n - Add feedback when changing channel mode #454\n - Add rendering of banlist, exceptlist, invitelist and quietlist #432\n - Add \"Facts\" bot action\n - Add query_db() method to bot plugins\n - Add Content-Security-Policy header to Convos #508 #567\n - Entering \"+\" in the quick search bar will show conversation with unread messages\n - Entering \"+#\" in the quick search bar will show channels with unread messages\n - Entering \"+@\" in the quick search bar will show private conversation with unread messages\n\n5.24 2021-02-11T09:30:00+0900\n - Will not show participants in sidebar if already visible on the right side\n - Will not jump to the first conversation when leaving a conversation\n - Fix loading conversations in \"Add conversation\"\n\n5.23 2021-02-11T08:03:00+0900\n - Fix hover to show timestamp for message\n - Fix loading more messages if scrollbar is not seen #558\n\n5.22 2021-02-10T10:09:00+0900\n - Add support for nicer message-of-the-day (MOTD) server messages\n - Fix rendering multiple spaces in a string\n - Revert \"Changed from connection ID to real_host in chat sidebar\"\n - Will not render message details if the message is simple\n\n5.22 2021-02-08T10:05:00+0900\n - Fix clicking on nicks in conversation\n\n5.21 2021-02-05T09:23:00+0900\n - Fix handling expandUrlToMedia #562\n - Fix keeping track of which nick is yours in conversations\n\n5.20 2021-02-04T13:00:00+0900\n - Fix handling offline/online nick logic\n\n5.19 2021-02-04T12:00:00+0900\n - Fix typo in calculateModes()\n - Fix number of participants in ChatParticipants\n - Fix parsing user modes\n\n5.18 2021-02-04T11:47:00+0900\n - Fix typo in Participants.js\n\n5.17 2021-02-04T11:42:00+0900\n - Fix handling join events\n - Fix handling /names response\n - Fix handling /whois response\n\n5.16 2021-02-04T11:28:00+0900\n - Add nick to video conversation url\n - Add /ns (msg nickserv) and /cs (msg chanserv) aliases\n - Fix rendering action messages\n - Improved video conversation name for private conversations\n - Improved rendering of new conversations\n\n5.15 2021-02-03T10:51:00+0900\n - Hide from and icon for notice and error messages\n - Rolled back \"channel@connection\" as title\n - Changed from connection ID to real_host in chat sidebar\n - Will render Google meet, Webex and Whereby as video invite links\n\n5.14 2021-02-02T06:46:00+0900\n - Add \"real_host\" as connection participant\n - Improve search logic and changed keywords #560\n - Fix rendering internal video chat links #543\n - Fix errors from commands will show up in the same dialog\n - Fix hiding <img> inside embed that cannot be loaded\n - Fix remembering if toggleDetails has been toggled while scrolling\n - Fix details styling to match paste syntax highlight\n - Fix not getting \"#undefined\" when scrolling in conversations\n - Fix not keeping scroll lock forever\n - Fix setting document title\n - Fix showing /names response in same dialog\n - Change any Jitsy link to be rendered inside the /video/... page\n - Change Conversation.title to \"name@server\"\n - Replace renderMessages with Messages store\n - Updated Spanish translation #561\n\n5.13 2021-01-23T12:42:00+0900\n - Fix parsing .po files\n\n5.12 2021-01-23T11:49:00+0900\n - Add language picker to SettingsAccount and login screen\n - Add support for multiple lines in .po files\n - Add \"recover\" command\n - Fix openssl is required in docker tob build certificates\n - Improved Italian translations #559\n   Contributor: SerHack\n - Improved Norwegian translations #553\n - Improved Spanish translations #552\n   Contributor: Iv\u00e1n \u00c1valos and Jos\u00e9 Joaqu\u00edn Atria\n - Improved output from \"convos build\" command\n - Allow .po files to be reloaded when developing\n - Removed \"command\" from Bot action message events\n\n5.11 2021-01-14T08:57:00+0900\n - Add Norwegian translations #549\n - Add Italian translations #548\n   Contributor: SerHack\n - Fix unicode issues related to translations #422\n - Fix loading language files in production\n\n5.10 2021-01-13T14:43:00+0900\n - Add support for other languages #422\n - Add Spanish translations #545\n   Contributor: Iv\u00e1n \u00c1valos and Jos\u00e9 Joaqu\u00edn Atria\n - Add EXPERIMENTAL support for WEBIRC #346 #444 #546\n - Add author to blog posts\n - Fix utf8 issue in blog posts\n\n5.09 2021-01-08T09:35:00+0900\n - Fix SASL authentication process for Oragono IRCd (and others) #356\n - Fix issue where notifications were double encoded UTF-8\n\n5.08 2021-01-05T12:21:00+0900\n - Fix \"convos version\" after install/upgrade #539\n - Fix reading notifications with unicode\n - Fix issue with some pastebin links\n - Add notification when a video link is sent #472\n - Add link to raw version of the paste\n - Improved filename for pasted files\n\n5.07 2020-12-29T13:32:00+0900\n - Add support for EXTERNAL and PLAIN SASL authentication #356 #525\n - Add supoort for nickserv certfp authentication #380\n\n5.06 2020-11-30T11:25:00+0900\n - Add a \"compact display\" mode as Viewport option #535\n   Contributor: Abhijit Menon-Sen\n - Add tighter integration with Jitsi video chat #536\n - Fix leading uppercase characters in usernames #538\n   Contributor: Abhijit Menon-Sen\n - Removed EXPERIMENTAL video support added in 4.08 #204\n\n5.05 2020-11-25T11:52:00+0900\n - Add support for for \":-*\", \":O\" and \"(Y)\" #534\n   Contributor: Megaf\n - Add better rendering of Jitsi links\n - Fix not adding new private messages, unless historyStopAt\n - Fix resetting historyStopAt and historyStartAt when jumping back in history\n\n5.04 2020-11-24T21:42:00+0900\n - Fix pasting text into the chat input\n - Fix updating search field value\n\n5.03 2020-11-24T21:24:00+0900\n - Fix not jumping back in the chat input when pressing shift\n\n5.02 2020-11-24T18:53:00+0900\n - Add user input to localStorage, so it survives refresh\n - Fix injecting upload link to user input field\n - Fix not dropping key pressees\n\n5.01 2020-11-23T14:23:00+0900\n - Add support for negotiating IRCv3 capabilities #444\n - Add chat input text is coupled to conversation #524\n   Contributor: Thibault Duponchelle\n - Add support for hiding join/part messages #527\n   Contributor: Thibault Duponchelle\n - Change WHOIS reply to show more information #528\n   Contributor: Abhijit Menon-Sen\n - Add \"realname\" as a new connection parameter #529\n   Contributor: Abhijit Menon-Sen\n - Add WHOIS will be run on new private messages\n - Changed service accounts \"chanserv\" and \"nickserv\" will show up in connection conversation #379 #532\n - Change clicking on a nick will create a new conversation #530\n - Fix avoid rendering regexes as markdown links #522\n - Fix not sending username with a non-alphanumeric first character #531\n   Contributor: Abhijit Menon-Sen\n - Fix J::V and M::P::OpeAPI dependencies\n - Fix clicking on [settings] link in chat\n - Fix loading notifications\n - Fix not counting your own messages as unread\n - Fix not queueing a connection if wanted_state is \"disconnected\"\n - Fix scrolling to bottom of conversation on initial render\n\n5.00 2020-11-17T07:24:00+0900\n - Renamed \"Dialog\" to \"Conversation\" #519\n - Renamed \"$sidebar-item-dialog-indent\" css variable to \"$sidebar-item-conversation-indent\" #519\n - Renamed API endpoints from \"dialogs\" to \"conversations\" #519\n\n4.42 2020-11-05T09:54:00+0900\n - YAML::XS is an optional module\n - Fix selecting text in chat\n\n4.41 2020-11-04T11:20:00+0900\n - Fix keepalive PING message\n - Fix \"Unknown operationId\" errors in Operation.js\n - Add \"Notify me on new messages\" to private conversations\n - Add \"loading\" page which will be shown if the backend is not ready\n - Add support for \"/sleep 4.2\" in on_connect_commands #517\n - Removed last_active and last_read from Dialog\n - Renamed \"read\" operationIds in OpenAPI spec\n - Mark notifications as read when leaving the \"Notifications\" page\n\n4.40 2020-09-22T10:06:00+0900\n - Fix line numbers in embedded paste\n - Fix opening links inside embeds in new tab/window\n - Fix Docker on Windows #514\n   Contributor: Derzsi D\u00e1niel\n - Upgrade Docker Alpine version to 3.12 #513\n   Contributor: Derzsi D\u00e1niel\n - Bumped LinkEmbedder to v1.14\n\n4.39 2020-09-17T20:19:00+0900\n - Depend on LinkEmbedder v1.13\n - Removed the slash over the notification bell\n\n4.38 2020-09-13T18:31:00+0900\n - Fix typo in renderMessages.js\n\n4.37 2020-09-13T18:22:00+0900\n - Add notification icon on the top of the <SidebarChat/>\n - Add suppport for custom bot password\n - Fix joining dialog when creating connection #512\n - Fix bot Hailo action will not store \"nick: ...\" prefix\n - Fix using \"expandUrlToMedia\" setting from user account\n - Change bot to wait one second before replying\n - Change default Hailo engine class to Hailo::Engine::Scored\n - Will only add \"has-focus\" to message when coming from search or notifications\n\n4.36 2020-09-01T11:12:00+0900\n - Fix clearing dialog messages when loading overlapping messages\n - Fix not loading messages when a dialog already has messages\n - Fix not having #undefined in location when scrolling to \"date change\" marker\n - Fix not skipping a month when fething messages at end of month\n\n4.35 2020-08-28T12:27:00+0900\n - Fix not following link when clicking on a thumbnail\n - Fix not focusing \"search\" input on load/routerender\n - Fix searching for messages\n - Changed styling for message that has focus\n\n4.34 2020-08-28T11:35:00+0900\n - Add support for \"around\" which will load messages faster\n - Improved \"keep scroll position\" logic with <InfinityScroll/> component\n - Improved WebSocket error messages\n - Fix loading relevant messages when clicking on a notification or search result #511\n - Fix focus logic on Shift+Enter and Esc\n - Fix max-width for YouTube iframe on small screens\n - Fix reloading Notifications\n - Fix drag&drop effect when uploading files\n - Fix reporting installed versions after \"convos install\" has run the first time\n - Changed default websocket error message\n - Removed loading of external Instagram JavaScript library\n - Removed loading of external Twitter JavaScript library\n\n4.33 2020-08-08T17:32:00+0900\n - Prevent frontend from sending the whole dialog object, which results in\n   WebSocket close clode \"1009\"\n\n4.32 2020-08-06T19:09:00+0900\n - Fix loading login page for new users\n\n4.31 2020-08-06T12:59:00+0900\n - Add backoff reconnect logic to the WebSocket\n - Fix issue where the WebSocket would not reconnect after being disconnected\n - Fix reloading user object on reconnect\n - Fix showing error messages in current dialog\n - Waiting for \"online\" and \"offline\" events in the browser does not seem to\n   work as expected.\n\n4.30 2020-08-05T09:29:00+0900\n - Will trim target when sending commands\n   * This fixes commands like \"/whois nick \" with trailing spaces\n - User can resend messages when WebSocket reopens\n - Trying to fix WebSocket closing unexpectedly\n - Improved rendering of message details\n - Fix settings \"secure\" for client side \"convos_js\" cookie\n - Fix \"Content-Security-Policy: unsafe-inline\" header is no longer required #508\n - Fix issues with generating pretty connection names #507\n - Changed to base64 encoded email in markup to make it harder for bots\n - Changed to using \"alternate stylesheet\" to represent theme options\n - Removed invalid help in ConnectionForm #507\n - Removed \"!\" prefix from public bot commands #509\n - Updated JavaScript dependencies\n\n4.29 2020-07-29T07:57:00+0900\n - Fix memory leak where connections would not be cleaned up when user was deleted\n - Fix copy invite/recover link to clipboard\n - Fix showing that you are offline (was removed by accident in 4.24)\n - Add support for HTML notifications\n - Made calculating \"unread\" faster\n\n4.28 2020-07-24T18:05:00+0900\n - Fix detecting if Convos has focus, which again enables notifications\n\n4.27 2020-07-24T16:20:00+0900\n - Removed auto-rotate image code\n - Fix not getting notifications when you send messages\n - Fix showing notifications when chat is not focused\n\n4.26 2020-07-24T11:20:00+0900\n - Add bot \"spool\" action\n - Fix loading bot \"karma\" action\n - Fix typo in embedMaker #506\n\n4.24 2020-07-24T09:55:00+0900\n - Add functionality for managing users #417 #505\n - Add API enpoint for listing users #417\n - Improved rotation of images #506\n - Synchronized title between server and client side\n - Fix rendering links inside `code` #503\n - Fix setting proper bot mode (+B)\n - Fix the bot so it does not reply to its own messages\n - Fix Notifications links when mounted under /whatever\n - Fix t/web-admin #504\n - Fix rendering disabled buttons\n - Improved loading time by getting user data from WebSocket\n - Improved readability of unit tests\n - Changed to showing \"https://\" in links\n - Changed API endpoint for updating and deleting users #417\n\n4.23 2020-07-08T19:06:00+0900\n - Fix rendering /register route\n - Add \"script/convos upgrade\" sub-command\n - Add disk usage to the settings page\n - Add EXPERIMENTAL \"bot\" functionality through Convos::Plugin::Bot #502\n   * Add \"Calc\" bot action\n   * Add \"Core\" bot action\n   * Add \"Hailo\" bot action\n   * Add \"Karma\" bot action\n\n4.22 2020-06-18T11:11:00+0900\n - Fix not generating new \"uid\" for the users on restart\n\n4.21 2020-06-18T08:39:00+0900\n - Fix serving existing uploaded files\n\n4.20 2020-06-18T08:31:00+0900\n - Fix hanging up a WebRTC call\n - Fix iOS issue where /login screen is rendered when actually logged in\n - Fix invalid social \"image\" for blog posts\n - Add formatting for <code> for the CMS\n - Converted short_checksum() to use sha1_sum\n - Fix generating random local secret for Docker\n   You might want to regenerate your \"local_secret\" in\n   $CONVOS_HOME/settings.json if you are using Docker\n\n4.19 2020-06-10T08:39:00+0900\n - Fix rendering \"Account\" page on touch devices\n - Fix login/cms footer and header on small screens\n - Fix cpanfile for Text::Markdown\n - Bumped JSON::Validator and Mojolicious::Plugin::OpenAPI dependencies\n\n4.18 2020-06-05T13:37:00+0900\n - New login and fallback page design that matches https://convos.chat\n - Fix <SelectField> click and filter issues\n - Fix reverse proxy detection for the first user\n - Perldoc rendering must be enabled with CONVOS_CMS_PERLDOC=1\n - Will scan for new blogs every 15 seconds\n\n4.17 2020-06-03T10:35:00+0900\n - Fix absolute URL to social image from CMS\n - Fix not setting X-Provider-Name in CMS mode\n - Fix API links in POD\n - Fix \"redirect_to\" for CMS\n - Add TOC to cms pages and perldoc\n - Add shortcut for FontAwesome icon inside markdown\n - Can automatically pull description from the first paragraph\n - Reduce docker image size #492\n - Improved login screen design\n - Improved rendering of perldoc\n - Improved support for markdown inside tags\n - Replaced Text::MultiMarkdown with Text::Markdown since it is easier to install\n\n4.16 2020-06-01T22:16:00+0900\n - Cannot load Module::Install directly\n\n4.15 2020-06-01T22:07:00+0900\n - Add missing dependency\n\n4.14 2020-06-01T21:56:00+0900\n - Add CMS functionality\n - Fixed highlight color for dark themes\n\n4.13 2020-05-31T10:04:00+0900\n - Add light variant of \"Nord\" theme #476\n   Contributor: Thibault Duponchelle\n - Add \"Hacker\" theme #479\n   Contributor: Thibault Duponchelle\n - Add support for \"OPER\" command\n - Fix \"Color scheme\" dropdown reflect the options from the theme #482\n   Contributor: Thibault Duponchelle\n - Fix \"Notifications keywords\" text field value has new value after saving\n   user account #485 #486\n - Fix description in site.webmanifest.ep\n - Fix font awesome cache issue\n - Fix toggling message details\n - Fix not making pictures from https://convos.chat gargantic\n - Changed \"/raw\" to \"/quote\"\n - Changed to always sending \"/quote\" messages from connection conversation\n\n4.12 2020-05-25T10:04:00+0900\n - Fix unread count styling on small screens\n\n4.11 2020-05-25T09:55:00+0900\n - Fix upload files button in chat-input\n - Add animations to some of the buttons\n\n4.10 2020-05-24T12:32:00+0900\n - Fix sending WeBRTC signals between private conversations\n\n4.09 2020-05-24T12:17:00+0900\n - Avoid hearing yourself locally through video chat\n - Can toggle WebRTC connection info by clicking on participant nick\n - Fix accepting calls in private conversations\n - Fix rendering of main menu on small screens\n - Fix making the chat input field stand out on small screens\n\n4.08 2020-05-23T15:32:00+0900\n - Add EXPERIMENTAL video support #204\n - Will send desktop notification on video call #472\n - Add support for parsing \"ahq\" user modes #471\n - Add \"South\" theme #469\n   Contributor: Thibault Duponchelle\n - Fix not forgetting theme settings when browsere is closed\n - Fix how unread count is presented/calculated #470\n - Fix serving themes from correct URL behind reverse proxy\n - Fix button colors for all themes #467 #468\n   Contributor: Thibault Duponchelle\n - Removed Nordaaker background on login screen #439\n\n4.07 2020-05-15T09:39:00+0900\n - Fix \"Go to start page\" and \"Retry\" links inside <Fallback>\n - Fix markdown links to relative links will not refresh the page\n - Changed from \"convos green\" to red in the \"High-contrast\" theme #465\n   Contributor: Thibault Duponchelle\n\n4.06 2020-05-13T13:19:00+0900\n - Improved keeping scroll position\n - Fix loading embeds after the correct message\n\n4.05 2020-05-10T10:06:00+0900\n - Avoid XSS links in the chat\n\n4.04 2020-05-09T08:42:00+0900\n - Add \"Jump to now\" link in Chat #453\n - Add line numbers for hljs #461\n - Add support for searching for \"from\"\n - Add \"Desert\" theme\n - Add \"High contrast\" theme, with dark/light mode\n - Add support for \"CONVOS_REQUEST_BASE\", which is an alternative to\n   the \"X-Request-Base\" header\n - Fix jumping to the right position in chat history #453\n - Fix edge cases for ?after= and ?before= #459\n - Fix being able to make a paste with unicode #460\n - Fix select-field styling on \"Add conversation\" page\n - Fix \"substr outside of string at Mojo/Asset/Memory.pm line 45.\" warning\n - Fix rendering <Fallback/> pages\n - Fix loading PWA assets in <head>\n - Removed support for fetching \"user.json\" with notifications.\n - Replaced Convos icon with \"info-circle\" icon in chat\n - Avoid inactivity_timeout from /api/embed.json\n - Avoid including the short timestamp when doing copy of chat dialog\n - Will persist theme settings in a cookie to prevent flashing between themes\n   on load\n\n4.03 2020-04-07T11:32:00+0900\n - Fix parsing routes such as /chat/irc-convos/%23x%2Fbar\n - Fix rendering of /file/1/lNqUVc43p0h4jaj5 paths\n\n4.02 2020-04-06T22:10:00+0900\n - Fix not being able to subscribe to store\n - Fix not showing the nav menu by default on small screens\n - Made the chat input look more like an input\n\n4.01 2020-04-06T21:39:00+0900\n - Add Nordaaker as background image to login screen #439\n - Add support for searching for anything from main search input #457\n - Fix rendering convos images on small screen #450\n - Fix not allowing injected \"#call:\" and \"#send:\" links\n - Fix not looping through all dialogs and marking them as read on reconnect\n - Fix not showing \"date changed\" in <Search/> before search is performed\n - Fix not asking for protocol handling all the time in Firefox\n - Extended the webmanifest\n - Changed to pagejs for routing on client side\n - Replaced \"settings\" in svelte context with process.env\n\n4.00 2020-03-24T16:00:00+0900\n - Add custom styling for image previews from Convos #450\n - Add checkbox for \"forced_connection\" in \"settings\" #456\n - Add search to frontend #187\n - Made the theming support more flexible #394\n - Fix not sending /query before sending a list of channels to the server #442\n - Fix issue in firefox where padding-bottom is ignored\n - Fix not removing space from sent message before \"/\"\n - Fix creating paste from multiline messages\n - Syncronized Makefile.PL and cpanfile, and bumped dependencies\n - Travis runs the test suite successfully again\n\n3.12 2020-03-04T11:28:00+0900\n - Add /clear history [name] command #150\n - Fix NaN in the help page, for \"/say\" command\n - Fix Timer failed: Can't call method \"write\" on an undefined value in Irc.pm\n - Fix showing \"day changed\" indicator\n - Add \"s\" after seconds in wsEventSentWhois()\n - Add JOIN as alias for QUERY (EXPERIMENTAL)\n - Made the welcome messages less annoying\n - Bumped node dependencies\n\n3.11 2020-03-02T15:11:00+0900\n - Fix exception when searching too long a period #448\n   Contributor: Doug Bell\n - Add support for pasting images #437\n - Add a welcome message when joining a new conversation\n - Fix handling err_badchannelkey #268\n - Fix button alignment in <DialogAdd>\n - Rollback \"Avoid reloading conversation when reconnecting to WebSocket\"\n\n3.10 2020-02-21T16:09:00+0900\n - Fix loading notifications\n\n3.09 2020-02-21T15:40:00+0900\n - Fix compatibility with old versions of Edge/IE #441\n - Fix handling very long messages #443\n - Fix sending a single space #446\n - Fix keeping track when changing nick\n - Fix not having strike-through for Convos messages\n - Add LDAP support to Convos #65 #418\n - Add custom \"help\" and \"version\" commands\n - Add \"--all\" switch to \"install\" sub command, which also installs suggested deps\n - Add \"cpanm\" sub command\n - Add \"exec\" sub command\n - Avoid reloading conversation when reconnecting to WebSocket (EXPERIMENTAL)\n - Documented sub commands that used to be hidden\n - Made it easier for the first user to sign up\n\n3.08 2020-01-30T11:24:00+0900\n - Removed support for underscore markdown formatting #438\n - Removed tooltip for dialogs in <SidebarChat/>\n - Improved rendering of login screen on small screens\n - Will hide the active menu when clicking on the overlay\n\n3.07 2020-01-27T10:00:00+0900\n - Fix not nuking files on disk if no more disk space\n - Add visible tooltips #436\n - Will try to rotate uploaded JPEG images\n\n3.06 2020-01-09T14:08:36+0900\n - Fix link color inside pseudo form elements\n - Fix not focusing the last element in the sidebar\n - Fix timestamp color for the Nord theme\n\n3.05 2020-01-07T11:32:36+0900\n - Fix autocomplete text color\n - Fix not focusing two nav items after going back/forward in history after searching\n - Fix changing focus in navbar when the URL changes\n - Fix channel name not getting collapsed in heading\n - Render readonly topic as html in settings and made the topic clickable as well\n - Better transition between different loading states\n - Bumped LinkEmbedder to 1.11\n\n3.04 2020-01-06T22:07:36+0900\n - Add custom title for all pages\n - Fix bugs in Dark and Nord theme\n - Fix showing <SidebarChat/> only on pages that wants it\n - Fix clearning activeMenu when changing page\n - Fix not reloading User from <ConnectionSettings/>\n - Fix not notifying the user when the user has already accepted notifications\n\n3.03 2020-01-06T14:21:36+0900\n - Fix serving uploaded files with correct Content-Type #435\n - Fix offset for hamburger menu\n - Fix not duplicating notification messages\n - Designed new login/register screen, where they are on the same page\n - Renamed \"Login\" and \"Register\" to \"Sign in\" and \"Sign up\"\n - Will display connection name in sidebar\n - Changed Dark theme: Less dark inputs and darker buttons\n - Changed Nord theme: Made the inputs visible on blue background\n\n3.02 2019-12-29T11:02:36+0900\n - Fix getting topic on connect #433\n - Fix clicking on dropdown options #434\n - Fix \"/ison\" without arguments\n - Add clearing of the password fields to prevent browser autocomplete\n\n3.01 2019-12-28T13:30:36+0900\n - Fix not send command as message by acciden #428\n - Fix removing dialog when sending PART\n - Fix /names logic both in JavaScript and Connection::IRC\n - Improved autocomplete documentation for /mode #430\n - Improved MODE handling, especially related to ban lists #431 #432\n\n3.00 2019-12-24T10:15:35+0900\n - Breaking change: The Perl code changed from callback based API to promises #420 #423\n   * Removed Mojo::IRC as a dependency #392\n   * Removed Convos::Core::Connection->set_wanted_state()\n   * Removed \"get_user\" WebSocket event\n   * Removed \"participants\" API endpoint\n   * Removed all blocking APIs\n   * Replaced CONVOS_STEAL_NICK_INTERVAL with CONVOS_IRC_PERIDOC_INTERVAL\n - Add support for file upload #244 #424\n   * Add back compat URL handling for /paste/:user_public_id/:paste_id\n   * Replaced Convos::Plugin::Paste with Convos::Plugin::Files\n - Add handling of \"Trying to reconnect too fast\" #410\n - Add organization_name and organization_url to sidebar and help page\n - Add removal of embeds that doesn't render correct images\n - Add message errors to the active conversation, instead of connection conversation\n - Fix using connection URL \"username\" when sending \"USER ... 0 * :Name\"\n - Fix indicating that user is offline in chat messages\n - Fix duplicate text in <ChatInput/> when clicking on a nick\n - Fix being able to clear organization_name and organization_url in\n   updateSettings endpoint\n - Fix $fa-font-path when behind reverse proxy #419\n   Contributor: Andreas Voegele\n - Fix snap builds #366 #421\n   Contributor: Adam Stokes\n - Changed default CONVOS_CONNECT_DELAY from 3 to 4\n - Bumped LinkEmbedder to 1.10 which fixes handling of Google links\n - Removed Convos::Plugin->add_backend_helpers()\n - Replaced Convos::Core::User->public_id() with uid()\n - Replaced MOJO_REVERSE_PROXY with CONVOS_REVERSE_PROXY\n - Improved user experience on the Settings page\n\n2.00 2019-11-23T10:23:35+0900\n - Add roles() and role() to Convos::Core::User #99 #407 #411\n   * The first user will get the admin role\n   * Will automatically upgrade the first registered user for legacy reasons\n - Can now generate invite/recovery links from the web #361 #407 #411\n   * Add /user/#email/invite API endpoint\n   * Replaced invite_code and recover logic with invite links\n   * The first user does not need an invite link\n   * Changed \"Register\" is now the default screen, instead of \"Login\"\n   * Removed support for CONVOS_INVITE_CODE\n   * Removed /user/recover/*email/:exp/:check resource\n   * Removed /user/recover/*email resource\n - Add Convos::Core::Settings, and removed support for many environment\n   settings, since they can now be changed through the web interface:\n   * CONVOS_CONTACT\n   * CONVOS_DEFAULT_CONNECTION / CONVOS_DEFAULT_SERVER\n   * CONVOS_FORCED_CONNECTION / CONVOS_FORCED_IRC_SERVER\n   * CONVOS_OPEN_TO_PUBLIC\n   * CONVOS_ORGANIZATION_NAME\n   * CONVOS_ORGANIZATION_URL\n   * MOJO_CONFIG\n - Add support for desktop notifications for all activities in a channel, closes #388\n - Fix calling setLastRead when going from conversation to a non-conversation\n - Fix getting desktop notifications from private messages\n - Fix showing initial desktop notification, when notifications have been enabled\n - Fix unicode issue when reading notifications, closes #412\n - Fix users are loaded in a predictable order on startup\n - Cannot edit dialog password if joined and not an operator #358\n - Changed \"Part\" button to \"Leave\" in conversation settings\n - Changed $app->sessions->secure(...) to be set on each request\n - Mention a quicker way to get to conversation settings in \"Help\"\n - Renamed /settings to /settings/account\n\n1.02 2019-11-13T16:02:05+0900\n - Fix Docker builds for main and tags #401\n   https://hub.docker.com/r/convos/convos\n - Fix service worker so it serves fresh assets #402\n - Fix cleaning user input #403\n - Fix \"convos dev\" command so it works with webpack\n - Fix loading messages and participant list when the conversation gain focus\n - Fix version number in api.json\n - Fix double rendering, where components would overlap each other\n - Fix rendering \"undefined\" when /api/embed.json fail #408\n - Fix showing settings icon on sidebar conversation hover\n - Fix \"/ISON CamelCaseNick\"\n - Will split messages that are too long #386\n - Will auto detect available themes #404\n   https://convos.chat/2019/11/2/custom-styling.html\n - Will postpone loading notification messages\n - Add offline page to the service worker cache #402\n - Add more complex caching rules to the service worker #402\n - Add \"Nord\" theme #405\n   https://www.nordtheme.com\n - Add a new css variable \"--input-focus-placeholder-color\" #409\n - Add support for picking up certificate files in development mode\n   https://convos.chat/doc/develop.html#secure-connection\n - Bumped LinkEmbedder to fix crashes in backend #408\n - Renamed \"last-read\" in the API to \"read\"\n - Renamed \"listNotifications\" in the API to \"notificationMessages\"\n\n1.01 2019-11-01T13:00:41+0900\n - Add handling for connection protocols #311\n - Add dark mode theme #313\n - Add password field to dialog settings #358\n - Add support for channels with \"/\" #365\n - Add unread count to hamburger menu #397\n - Add toggling of details to \"notice\" messages\n - Add upgrade of \"http\" embeds to \"https\"\n - Add warning screen to script/convos if started as root\n - Fix HTML entities at the end of links #362\n - Fix \"Not Found\" page #391\n - Fix duplicate messages after loading messages #396\n - Fix unresponsive hamburger menu while loading a dialog\n - Fix bugs related to join/part/mode events\n - Fix support for setting highlight_keywords\n - Fix loading participants list\n - Bumped Alpine version in Dockerfile\n\n1.00 2019-10-26T13:29:41+0900\n - Changed frontend to use https://svelte.dev/ from Vuejs.\n - Changed to using URLs, so you can link directly to conversations and pages\n   when chatting.\n - Changed sidebar design to a tree view, where conversations are listed under\n   connections.\n - Changed \"unread\" logic to reset to zero when conversations looses focus.\n - Changed notifications to be rendered as a conversation, with the latest\n   notifications in the bottom.\n - Changed notifications to be marked as read, when notifications conversation\n   looses focus.\n - Changed from using Material Design Icons to Font Awesome.\n - Changed twemoji, after emojione/joypixels changed their design.\n - Changed autocomplete dropdown to show when trigger character is seen. This\n   makes it work on phones as well.\n - Changed autocomplete for nicks: Nick has to be prefixed with \"@\".\n - Changed sidebar design for register/login pages, like we do on\n   https://convos.chat.\n - Replaced Mojolicious::Plugin::AssetPack with Mojolicious::Plugin::Webpack.\n - Add number of unread to document title #382\n - Add \"New messages\" indicator.\n - Add support for rendering quotes.\n - Add icons before nicks. The icon is calculated from the nick, so it does not\n   change between installations or reloads.\n - Add \"Autocomplete\" and \"Text formatting\" to /help.\n - Add toggle for error message details.\n - Improved filtering logic in sidebar.\n - Fix not including \")\" (or other special characters) when rendering links.\n - Fix rendering in Safari on iOS.\n - Fix handling of nicks with MixedCaps.\n - Fix reacting to window focus #383\n - Fix for ZNC integration: Connection name based on ZNC usernames #316\n - Removed the ShareDialog plugin.\n - Removed \"Create connection\" when registering. Will instead connect to the\n   default connection.\n - Removed custom styling support.\n - Bumped LinkEmbedder version to 1.06\n - Using \"pnpm\" (instead of \"npm\") to install node modules.\n\n0.99_40 2019-02-08T23:05:00+0100\n - Switch order of isconnect and ison to allow authentication with nickserv before join\n - Remove POD plugin which has been deprecated from Mojo core.\n - Update Alpine image\n - Fix duplicate key in schema\n\n0.99_39 2018-08-30T10:40:39+0200\n - Only keep one conversation open at a time.\n\n0.99_38 2018-08-20 15:09:00\n - Add support for disabling tls verification per connection (jberger)\n\n0.99_37 2018-08-16 11:43:00\n - Added -wn to perltidy for superior welding\n - Make convos a PWA\n - Add a delay helper until we can convert convos to promises\n\n0.99_36 2017-11-28T08:25:51+0200\n - Fix TLS detection when creating a connection #344\n - Fix message with empty content.\n - Remove obsolete AssetPack Reloader.\n\n0.99_35 2017-05-05T00:20:45+0200\n - Fix showing \":port\" when editing a connection #340\n - Fix changing server from default server on \"Create connection\" #345\n - Fix not leaking nick change events to all conversations\n - Fix video link embedder styling\n - Add support for CONVOS_FORCED_IRC_SERVER=\"irc://:password@host:port\" #343\n - Add hiding of chat elements for better rendering in iframe #21 #320 #346\n\n0.99_34 2017-04-24T10:04:55+0200\n - Fix \"create connection\"\n\n0.99_33 2017-04-22T00:09:58+0200\n - Fix \"/ison nick\" handling #336\n - Fix handling saving server username/password #334\n - Fix marking joined users as online\n - Fix showing error messages from IRC commands\n - Add missing \"!default\" to _variables.scss #313\n - Add support for CONVOS_LOG_FILE #337\n - Add nick changing feature from connection editor\n\n0.99_32 2017-04-17T22:30:54+0200\n - Fix annoying \"unread\" count increase on \"notice\"\n\n0.99_31 2017-04-14T13:40:04+0200\n - Fix autocompleting nicks by \"last seen\"\n - Fix background colors for chat and embeds\n - Fix online/offline state in private dialog using \"/ison nick\"\n - Fix private dialogs used to be \"in red\" after reconnect\n - Fix race condition when opening websocket connection\n - Fix rendering \"404 not found\" on unknown paste\n - Fix unread count is not increased when a private dialog user join/parts\n - Improved autocomplete logic for nicks and emojis\n - Add experimental MOTD (message of the day) handling\n - Add \"wanted_state\" to Core::Connection\n - Improved rendering of highlight messages\n\n0.99_30 2017-04-13T13:52:44+0200\n - Fix scrolling on \"Join dialog\" and \"Help\" pages #331\n - Add support for generating \"recover password\" link #302 #323\n - Add Convos::Plugin::Paste #328\n - Add support for sending multiline IRC messages #328\n - Using LinkEmbedder instead of Mojolicious::Plugin::LinkEmbedder\n - Will always have a default IRC server\n - Will not use unsafe secrets anymore\n\n0.99_29 2017-03-21T23:35:17+0100\n - Fix ShareDialog plugin\n - Fix custom assets with Mojolicious::Plugin::AssetPack 1.41\n - Add production 404 and 500 pages\n - Add logging about CONVOS_HOME on startup\n - Remove \"beforeConvosStart\" JavaScript event\n - Bump Mojolicious version to 7.29\n\n0.99_28 2017-03-15T01:34:20+0100\n - Fix keeping scroll at bottom in Firefox #324\n - Fix messages are grouped incorrectly on scrollback #301\n - Fix showing \"Day changed\" in historic messages\n - Will not mark message as \"highlight\" if sent by yourself\n\n0.99_27 2017-03-01T23:20:11+0100\n - Fix going to connection dialog after connection save\n - Fix hitting enter/return inside the \"Dialog name\" field on \"Join dialog\"\n - Fix joining channel which you are already part of\n - Fix reading invite_code from config file #322\n - Will detect if Javascript is disabled and notify user\n - Add support for embedding gist and other pasted text files\n - Add support for notifications on keywords #142\n\n0.99_26 2017-02-20T23:11:01+0100\n - Fix scrolling of sidebars and main menu\n - Change \"Edit profile\" to \"Settings\"\n\n0.99_25 2017-02-20T22:46:07+0100\n - Fix sending server messages to the right dialog\n - Fix joining a dialog by clicking on the dialog name\n - Fix first shown channel shows all users inactive #321\n - Fix creating dialog on /QUERY\n - Fix notifications are disabled when window is active\n - Add better handling of \"create dialog\" errors\n - Add functionality to only enrich visible links\n - Add better \"rich link\" caching\n - Add \"Convos icon\" to notification popup\n - Change default sorting to \"lastRead\"\n\n0.99_24 2017-01-29T00:57:30+0100\n - Fix registration process\n - Fix being able to show profile + help during wizard\n - Fix width of embedded youtube videos on small screens\n - Fix zooming images inline in chat\n - Fix not matching markdown, because a link was injected\n - Fix \"/me message your_nick\" mention rendering\n - Fix markdown rendering\n - Improved materialbox rendering for huge images\n - Can send/receive any IRC message #317\n - Add \"esc key\" to close on materialbox\n - Add listing of available rooms to \"Join dialog...\" #309\n\n0.99_23 2017-01-13T23:05:39+0100\n - Fix adding notifications in frontend\n - Fix saving userinfo in connection URL\n - Will close dropdown when clicking outside of the dropdown\n - Will ask for password if channel has mode +k\n\n0.99_22 2017-01-10T23:32:19+0100\n - Fix use of CONVOS_ORGANIZATION_URL #307\n - Fix unread count should not be increased on join/part/quit/... messages\n - Fix going from \"disconnected\" to \"reconnect\" on connection save\n - Add connection state selector to connection editor\n - Change \"Profile\" to open in main dialog area\n - Change \"Help\" to open in main dialog area\n - Compatible with Mojolicious 7.15\n - Tweaking colors\n\n0.99_21 2017-01-08T14:41:21+0100\n - Fix race condition when creating the websocket connection\n - Fix setting main dialog location on initial load\n - Fix not showing unread count for active channel\n - Fix sending \"/names\" on join #303\n - Fix parsing \"/names\" response #308\n - Add support for CONVOS_ORGANIZATION_URL #307\n - Add \"get_user\" websocket method\n\n0.99_20 2016-12-29T21:00:43+0100\n - Fix will not reconnect without host/port change\n - Add \"close\" icon to main menu conversations\n\n0.99_19 2016-12-06T14:43:43+0100\n - Fix loading message log after events have been received in background\n\n0.99_18 2016-12-04T20:39:43+0100\n - Fix IRC username cannot contain special characters #296\n - Fix parsing IRC user modes dynamically #287\n - Fix \"Goto anything\" sorts by dialog name length\n - Fix queuing connections after connection errors\n - Fix API URL when mounting Convos inside on non-root reverse proxy config\n - Fix handling of new private messages #298\n - Add EXPERIMENTAL sort by last-read/activity\n - Add Dockerfile\n - Add \"disable expanding links\" setting in profile\n - Server messages can be read in frontend\n - Server settings can be edited in the \"info\" sidebar\n\n0.99_17 2016-11-11T09:58:54+0200\n - Add support for editing on_connect_commands\n - Add support for JSON config - https://convos.chat/doc/config.html#introduction\n\n0.99_16 2016-11-08T13:37:58+0200\n - Fix getting historic messages, without duplicates #292\n - Fix getting messages from channel with \".\" in the name #293\n - Add custom styling for participants that are not currently in the channel\n - Add EXPERIMENTAL support for pluggable authentication #89\n - Add support for setting CONVOS_HOME from config file as \"home\" #289\n\n0.99_15 2016-10-13T22:51:01+0200\n - Fix IRC join channel redirect #284\n - Fix parting IRC channel, even if not in the channel\n - Fix highlight color in chat\n - Fix keeping on_connect_commands\n - Improved keeping scroll position to bottom #269\n\n0.99_14 2016-10-06T22:42:15+0200\n - Autocomplete on nick will start from the beginning of the word\n - Do not autocomplete on \"enter\"\n - Improved keeping scroll position to bottom #269\n - Improved keeping scroll position when loading historic messages\n\n0.99_13 2016-10-03T09:40:15+0200\n - Fix clearing Convos.settings.sidebar on mobile\n - Fix resetting max-height\n\n0.99_12 2016-10-03T09:31:02+0200\n - Less icons in header\n - Fix <convos-input/> from overlapping main area\n - Add CustomEvent and dispatchEvent polyfill #282\n - Improved scrolling to bottom logic #269\n\n0.99_11 2016-09-19T23:05:31+0200\n - Fix \"whois\" for participant who is not in any channels\n - Fix removing IRC colors #281\n - Add more information to <convos-message-whois/>\n - Add first optional plugin \"ShareDialog\" #280\n\n0.99_10 2016-09-14T23:35:31+0200\n - Fix handling of \"/whois nick\" when \"nick\" is offline\n - Fix tracking join/part/quit/nick change events #276\n - Fix handling IRC server replies with strange casing #277\n - Will not truncate files when disk is full\n - Normalizing email address for user\n - Add translation for :), :( and <3 into emojis\n - Can select TLS on connect\n\n0.99_09 2016-09-11T22:53:31+0200\n - Fix sorting participants list\n - Add support for /ns (/msg nickserv)\n - Add support for /cs (/msg chanserv)\n - Add clickable emails #265\n - Add support for markdown formatting for <code/>\n - Add support for rendering emojis #186\n - Add support for autocomplete emoji in <convos-input/> #186\n - Add support for custom color themes #161\n - Change dialog settings less confusing\n   * Render dialog title with markdown formatting and links\n   * Getting participants list is more consistent after reconnect\n   * Changed rendering of \"close\" button into a list item\n - Change autocomplete method for <convos-input/>\n\n0.99_08 2016-09-01T22:35:25+0200\n - Fix emitting topic changes to frontend\n - Add dialog settings sidebar with topic and participants list\n - Add support for \"/query nick\"\n - Remove settings dropdown menu\n - Replaced Roboto with system fonts\n\n0.99_07 2016-08-30T10:51:25+0200\n - Fix showing join/part messages in the correct channel\n - Fix running Convos on Windows mobile #271\n - Add favicon and app icons for iOS\n - Add basic support for \"/mode ...\"\n - Add support for \"/kick ...\"\n - Change \"convos version\" to also display running Convos version\n - Replaced \"info\" button with \"settings\" button for dialogs\n\n0.99_06 2016-08-27T12:27:13+0200\n - Fix tracking participants\n - Fix joining channel with key in backend #268\n - Fix joining channel with key in <convos-create-dialog/> #267\n - Fix handling \"part\" events\n - Fix starting \"script/convos dev\" after \"script/convos install --develop\"\n - Fix not show welcome message after log in in in a new browser\n - Fix running test suite with \"script/convos test\"\n - Fix no autocomplete in \"Join dialog\" or \"Add connection\"\n - Fix parsing UTC time in Firefox\n - Add Mojo::IRC 0.33 as required module #267\n - Add IO::Socket::SSL as required module\n   * Required to connect to TLS networks\n   * Required to fetch meta data from https resources\n - Change calculation of dialog.unread to server side\n - Change WebSocket keep-alive interval\n - Change \"Join dialog\" will be shown after a new connection is created\n - Change <convos-message-enable-notifications/> buttons to be disabled on click\n\n0.99_05 2016-08-22T16:30:57+0200\n - Fix breaking long words inside a message template\n - Fix only show nick change in the channels where the nick is active\n - Fix goto anything\n - Fix reading unicode (\u00e6\u00f8\u00e5) back from file\n - Fix dialog.frozen after webscocket comes back online\n - Fix skip installing dev deps by default\n - Fix handling of config file values\n - Fix \"send\" button in <convos-input/>\n - Fix missing Time::Piece on redhat #266\n - Add fetching connections, dialogs and notifications together with user object\n - Add icon to indicate that the WebSocket is down\n - Add last_read() to Convos::Core::Dialog\n - Add sorting of dialogs by lastRead\n - Add support for \"forced_irc_server\"\n - Add clicking on a notitication takes you to the dialog\n - Bundled cpanm, used by \"script/convos install\" (less dependencies)\n - Change client to keep WebSocket alive instead of backend\n - Converted Swagger2 to OpenAPI\n - Converted jQuery dependencies to Vue components\n - Converted Guides to gh-pages branch - http://convos.chat/doc\n\n0.99_04 2016-08-15T16:33:45+0200\n - Fix Could not send \"\\nsome message\": Unable to construct PRIVMSG.\n - Fix remove dialogs when connection is deleted\n - Add search for dialogs\n - Add jump between search and input field\n - Add better rendering on small screens\n - Add count of unseen notifications\n - Add <convos-settings/> which includes wizard, connection editor and dialog creator\n - Add support for invite code\n - Add number of unread messages\n - Add handling of join, nick_change and part events\n - Add support for desktop notifications\n - Change layout: Big green menu on top\n - Change dialog list to be sorted alphabetically\n - Converted vue templates to .vue files\n - Converted data-hint=\"\" to v-tooltip=\"\"\n - Remove hash/fragment navigation\n - Remove EventSource. Going for WebSocket only.\n\n0.99_03 2016-07-21T17:10:57+0200\n - Fix swagger spec: datetime != date-time\n - Fix parting channel when not connected\n - Fix appearance on small screens\n - Fix saving list of dialogs on every join\n - Fix autocomplete commands and nicks case insensitive\n - Add messages in backend are stored with \"highlight\" flag\n - Add notifications in frontend\n - Add loading of more messages when scrolling to top\n\n0.99_02 2016-04-15T08:47:56+0200\n - Fix automatic install require App::cpanminus 1.7016+\n - Fix confusing edit connections icon\n - Fix encode dialog.idvos to %23convos\n - Fix searching for messages in backend\n - Fix sending ACTION messages\n - Fix marking dialogs/connections as disconnected on websocket close\n - Add filter to render messages containing markdown\n - Add \"day changed\" indicator\n - Add whois action to user list and add whois data handler\n - Using Mojolicious::Plugin::AssetPack 1.04\n - Converted JavaScript from riot.js to vue.js\n\n0.99_01 2016-04-02T14:18:39+0200\n - Fix embedding images\n - Fix CTCP action messages on local echo\n - Add \"script/convos dev\" sub-command\n - Add \"script/convos install\" sub-command\n - Add styling of mentions and notice\n - Add handling of whois and topic reponses\n - Add support for sending IRC commands\n - Add /help command\n - Add rendering of autocomplete room list\n - Add autocomplete to <user-input/>\n\n0.99_01 2016-02-28T16:23:44+0200\n - Add config file support\n - Add default (insecure) secrets\n - Add initial Swagger specification\n - Add support for X-Request-Base\n - Add support for setting secure cookies\n - Add auto-detection of TLS/plain text IRC servers\n - Add \"steal nick\" logic\n - Add new layout with sidebars instead of top menu navigation\n - Add riot.js to render web pages\n - Add Convos::Core look-alike objects in JavaScript\n - Add router which acts upon location hash (fragment)\n - Add Swagger over WebSocket communication\n - Add scrollToBottom() on new messages\n - Add handling of highlighted messages in backend\n - Add expanding links in chat to meta data\n - Add Convos::Core\n - Add Convos::Core::Connection::IRC\n - Add Convos::Core::Room\n - Add Convos::Core::User\n\n0.99_00 2015-02-02T15:40:40+0200\n - Started rewriting Convos\n", "import {emojis} from '../../public/emojis/0bf11a9aff0d6da7b46f1490f86a71eb.json';\nimport {i18n} from '../../assets/store/I18N';\n\ntest('l()', () => {\n  expect(i18n.l('Test')).toBe('Test');\n  expect(i18n.l('Test %1', 42)).toBe('Test 42');\n\n  i18n.update({lang: 'en'});\n  i18n.dictionaries.en = {'Test %1': 'Foo %1 bar!'};\n  expect(i18n.l('Test %1', 42)).toBe('Foo 42 bar!');\n\n  i18n.dictionaries.no = {'See %1': 'Se %1!'};\n  i18n.update({lang: 'no'});\n  expect(i18n.l('Se %1!', 42)).toBe('Se 42!');\n});\n\ntest('lmd()', () => {\n  expect(i18n.lmd('`code` %1 *is* cool.', 42)).toBe('<code>code</code> 42 <em>is</em> cool.');\n\n  // Entities should not be translated into \"undefined\"\n  expect(i18n.lmd('https://commons.wikimedia.org/wiki/File:HK_WCD_WC_%E7%81%A3%E4%BB%94_Wan_Chai_%E8%BB%92%E5%B0%BC%E8%A9%A9%E9%81%93_Hennessy_Road_tram_body_ads_Tsingtao_Brewery_August_2021_SS2.jpg'))\n    .toBe('<a href=\"https://commons.wikimedia.org/wiki/File:HK_WCD_WC_%E7%81%A3%E4%BB%94_Wan_Chai_%E8%BB%92%E5%B0%BC%E8%A9%A9%E9%81%93_Hennessy_Road_tram_body_ads_Tsingtao_Brewery_August_2021_SS2.jpg\" target=\"_blank\">https://commons.wikimedia.org/wiki/File:HK_WCD_WC_%E7%81%A3%E4%BB%94_Wan_Chai_%E8%BB%92%E5%B0%BC%E8%A9%A9%E9%81%93_Hennessy_Road_tram_body_ads_Tsingtao_Brewery_August_2021_SS2.jpg</a>');\n});\n\ntest('md - not lmd', () => {\n  expect(i18n.md('`code` %1 *is* cool.')).toBe('<code>code</code> %1 <em>is</em> cool.');\n});\n\ntest('md - unchanged', () => {\n  expect(i18n.md('foo')).toBe('foo');\n  expect(i18n.md('Some text!')).toBe('Some text!');\n});\n\ntest('md - blockquote', () => {\n  expect(i18n.md('> Some quote')).toBe('<blockquote>Some quote</blockquote>');\n});\n\ntest('md - emojis', () => {\n  i18n.emojis._load(emojis);\n  expect(countEmojis(':) :/ :( ;D &lt;3 :D :P ;) :heart:')).toBe(8);\n  expect(i18n.md('wouldn\\'t it need :// too?'))\n    .toBe('wouldn&apos;t it need :// too?');\n  expect(i18n.md('but :/. turns into an emoji'))\n    .toMatch(/but <img.*[^>]+>. turns into an emoji/);\n});\n\ntest('md - em, strong', () => {\n  expect(i18n.md('Hey *foo* \"**bar**\" ***baz***!'))\n    .toBe('Hey <em>foo</em> \"<strong>bar</strong>\" <em><strong>baz</strong></em>!');\n});\n\ntest('md - markdown link', () => {\n  expect(i18n.md('some [cool chat](https://convos.chat)'))\n    .toBe('some <a href=\"https://convos.chat\" target=\"_blank\">cool chat</a>');\n  expect(i18n.md('A link to https://convos.chat, cool ey?'))\n    .toBe('A link to <a href=\"https://convos.chat\" target=\"_blank\">https://convos.chat</a>, cool ey?');\n  expect(i18n.md('A link to mailto:jhthorsen@cpan.org!'))\n    .toBe('A link to <a href=\"mailto:jhthorsen@cpan.org\" target=\"_blank\">jhthorsen@cpan.org</a>!');\n  expect(i18n.md('https://ru.wikipedia.org/wiki/\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u0446\u0430:Gryllida/\u0427\u0435\u0440\u043d\u043e\u0432\u0438\u043a last symbol shows as separate outside of the URL? do you reproduce the bug?'))\n    .toBe('<a href=\\\"https://ru.wikipedia.org/wiki/\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u0446\u0430:Gryllida/\u0427\u0435\u0440\u043d\u043e\u0432\u0438\u043a\\\" target=\\\"_blank\\\">https://ru.wikipedia.org/wiki/\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u0446\u0430:Gryllida/\u0427\u0435\u0440\u043d\u043e\u0432\u0438\u043a</a> last symbol shows as separate outside of the URL? do you reproduce the bug?');\n  expect(i18n.md('[mojo] marcusramberg opened pull request #1894: Minor tweaks to Growing guide. - https://git.io/JD9ph'))\n    .toBe('[mojo] marcusramberg opened pull request #1894: Minor tweaks to Growing guide. - <a href=\\\"https://git.io/JD9ph\\\" target=\\\"_blank\\\">https://git.io/JD9ph</a>');\n});\n\ntest('md - code', () => {\n  expect(i18n.md('single `a` char'))\n    .toBe('single <code>a</code> char');\n  expect(i18n.md('is this \\\\`not code`, or..?'))\n    .toBe('is this `not code`, or..?');\n  expect(i18n.md('is this `not code`, or..?'))\n    .toBe('is this <code>not code</code>, or..?');\n  expect(i18n.md('not a `https://link.com`'))\n    .toBe('not a <code>https://link.com</code>');\n  expect(i18n.md('a regexp: `TShop\\.Setup\\(\\s*([{](?>[^\\\\\"{}]+|\"(?>[^\\\\\"]+|\\\\[\\S\\s])*\"|\\\\[\\S\\s]|(?-1))*[}])`'))\n    .toBe('a regexp: <code>TShop\\.Setup\\(\\s*([{](?&gt;[^\\\\\"{}]+|\"(?&gt;[^\\\\\"]+|\\\\[\\S\\s])*\"|\\\\[\\S\\s]|(?-1))*[}])</code>');\n  expect(i18n.md('kikuchi` changed nick to kikuchi```.'))\n    .toBe('kikuchi` changed nick to kikuchi```.');\n});\n\ntest('md - nbsp', () => {\n  expect(i18n.md('')).toBe('&nbsp;');\n  expect(i18n.md('    ___ ___  _  ___   _____  ___')).toBe('&nbsp; &nbsp; ___ ___ &nbsp;_ &nbsp;___ &nbsp; _____ &nbsp;___');\n});\n\ntest('md - channel names', () => {\n  expect(i18n.md('want to join #foo-1.2 #foo-bar#not href=\"#anchor\" #foo.bar'))\n    .toBe('want to join <a href=\\\"./%23foo-1.2\\\">#foo-1.2</a> <a href=\\\"./%23foo-bar\\\">#foo-bar</a>#not href=\"#anchor\" <a href=\\\"./%23foo.bar\\\">#foo.bar</a>');\n});\n\nfunction countEmojis(str) {\n  return i18n.md(str).match(/class=\"emoji\"/g).length;\n}\n", "import Emojis from '../js/Emojis';\nimport XRegExp from 'xregexp';\nimport Reactive from '../js/Reactive';\nimport {api} from '../js/Api';\nimport {derived} from 'svelte/store';\nimport {route} from '../store/Route';\n\nconst RE = {};\nconst STOP = ' ,.:;!\"\\'';\nconst XML_ESCAPE = {'&': '&amp;', '<': '&lt;', '>': '&gt;', \"'\": '&apos;', '\"': '&quot;'};\n\nexport default class I18N extends Reactive {\n  constructor() {\n    super();\n\n    this.prop('cookie', 'lang', '');\n    this.prop('ro', 'dictionaries', {});\n    this.prop('ro', 'emojis', new Emojis());\n    this.prop('ro', 'languages', () => this._languages);\n    this.prop('ro', 'languageOptions', () => this._languageOptions);\n\n    this._languages = [];\n    this._languageOptions = [];\n  }\n\n  /**\n   * Will take a lexicon and string variables and return a human readable\n   * string. Falls back on returning the input lexicon if no translation\n   * is provided.\n   *\n   * @param {String} lexicon.\n   * @param {...String} A list (not array) of lexicon variables.\n   * @return {String} A translated string.\n   */\n  l(lexicon, ...vars) {\n    const dictionary = this.dictionaries[this.lang] || {};\n    const translated = String(dictionary[lexicon] || lexicon);\n    return translated.replace(/%(\\d)(\\D|$)/g, (all, i, s) => {\n      return typeof vars[i - 1] == 'undefined' ? all : (vars[i - 1] + s);\n    });\n  }\n\n  /**\n   * Load a dictionary.\n   *\n   * @param {String} lang Language such as \"en\", \"es\", \"it\", \"no\", ...\n   * @return {Promise} The promise will be fulfilled when the dictionary is fetched and parsed.\n   */\n  async load(lang) {\n    if (!lang) lang = this.lang || document.documentElement.getAttribute('lang');\n    if (this.dictionaries[lang]) return this.update({lang});\n    const op = await api('/api', 'getDictionary', {lang}).perform();\n    this.dictionaries[lang] = op.res.body.dictionary;\n    this._languages = op.res.body.available_languages || {};\n    this._languageOptions = Object.keys(this._languages).sort().map(id => [id, this._languages[id].language_team.replace(/\\s*<.*/, '')]);\n    return this.update({lang});\n  }\n\n  /**\n   * Combination of l() and md().\n   *\n   * @param {String} lexicon.\n   * @param {...String} A list (not array) of lexicon variables.\n   * @return {String} A translated string which might contain HTML.\n   */\n  lmd(lexicon, ...vars) {\n    return this.md(this.l(lexicon, ...vars));\n  }\n\n  /**\n   * Combination of l() and md(), but will only render some parts.\n   *\n   * @param {String} lexicon.\n   * @param {...String} A list (not array) of lexicon variables.\n   * @return {String} A translated string which might contain HTML.\n   */\n  lmdRaw(lexicon, ...vars) {\n    return this.md(this.l(lexicon, ...vars), {raw: true});\n  }\n\n  /**\n   * md() can convert a (subset) of markdown rules into a HTML string.\n   *\n   * @example\n   * // Hey <em>foo</em> <strong>bar</strong> <em><strong>baz</strong></em> <em><strong>baz</strong></em>\n   * i18n.md(\"Hey *foo* **bar** ***baz***!\");\n   *\n   * // A <a href=\"https://convos.chat\">link</a>\n   * i18n.md(\"A [link](https://convos.chat)\");\n   *\n   * // A link to <a href=\"https://convos.chat\" target=\"_blank\">convos.chat</a>\n   * i18n.md('A link to https://convos.chat');\n   *\n   * // A link to <a href=\"mailto:jhthorsen@cpan.org\" target=\"_blank\">jhthorsen@cpan.org</a>\n   * i18n.md('A link to mailto:jhthorsen@cpan.org');\n   *\n   * // Example <code>snippet</code>\n   * i18n.md(\"Example `snippet`\");\n   *\n   * // <img class=\"emoji\" draggable=\"false\" alt=\"\ud83d\ude42\" src=\"...\"> ...\n   * i18n.md(':) :/ :( ;D &lt;3 :D :P ;) :heart:');\n   *\n   * @param {String} str A markdown formatter string.\n   * @param {Object} opt Options for rendering, such as \"raw\"\n   * @return {String} A string that might contain HTML tags.\n   */\n  md(str, opt = {}) {\n    this._state = {};\n    str = this._xmlEscape(str);\n    str = this._nbsp(str);\n    if (!opt.raw) str = this._mdLink(str);\n    if (!opt.raw) str = this._plainUrlToLink(str);\n    if (!opt.raw) str = this._extendedFormatting(str);\n    if (!opt.raw) str = this._mdCode(str);\n    if (!opt.raw) str = this._mdEmStrong(str);\n    if (!opt.raw) str = this.emojis.markup(str);\n    if (!opt.raw) str = this._mdBlockQuote(str);\n    if (!opt.raw) str = this._mdChannelsAndNicks(str);\n    return str;\n  }\n\n  // https://modern.ircdocs.horse/formatting.html\n  _extendedFormatting(str) {\n    const zeroTo99 = '0[0-9]|[1-9][0-9]';\n    const colorRe = new RegExp('\\x03(' + zeroTo99 + ')(?:,(' + zeroTo99 + '))?([^\\x03]*)', 'g');\n\n    return str.replace(colorRe, (all, fg, bg, text) => text).replace(/[\\x02\\x03\\x1d\\x1f\\x1e\\x11\\x16\\x0f]/g, '');\n  }\n\n  _mdBlockQuote(str) {\n    return str.replace(/^&gt;\\s(.*)/, (all, quote) => '<blockquote>' + quote + '</blockquote>');\n  }\n\n  _mdChannelsAndNicks(str) {\n    // TODO: Make nicks clickable\n    return str.replace(/(^|\\s)(#[a-zA-Z][\\w.-]+)/g, (all, pre, channel) => {\n      const suffix = channel.match(/\\.$/) ? '.' : '';\n      if (suffix) channel = channel.replace(/\\.$/, '');\n      return pre + '<a href=\"./' + route.urlFor(encodeURIComponent(channel)) + '\">' + channel + '</a>' + suffix;\n    });\n  }\n\n  _mdCode(str) {\n    return str.replace(/(\\\\?)`([^` ][^`]*)`/g, (all, esc, text) => {\n      return esc ? all.replace(/^\\\\/, '') : '<code>' + text + '</code>';\n    });\n  }\n\n  _mdEmStrong(str) {\n    return str.replace(/(^|\\s|\")(\\\\?)(\\*+)(\\w[^<]*?)\\3/g, (all, b, esc, md, text) => {\n      if (md.length == 1) return esc ? all.replace(/^\\\\/, '') : b + '<em>' + text + '</em>';\n      if (md.length == 2) return esc ? all.replace(/^\\\\/, '') : b + '<strong>' + text + '</strong>';\n      if (md.length == 3) return esc ? all.replace(/^\\\\/, '') : b + '<em><strong>' + text + '</strong></em>';\n      return all;\n    });\n  }\n\n  _mdLink(str) {\n    const re = RE.mdLink || (RE.mdLink = XRegExp('\\\\[ ([a-zA-Z][^\\\\]]+) \\\\] \\\\( ([^)]+) \\\\)', 'gx'));\n    return XRegExp.replace(str, re, (all, text, href) => {\n      const scheme = href.match(/^\\s*(\\w+):/) || ['', ''];\n      if (scheme[1] && ['http', 'https', 'mailto'].indexOf(scheme[1]) == -1) return all; // Avoid XSS links\n      this._state.md = true;\n      const first = href.substring(0, 1);\n      const target = ['/', '#'].indexOf(first) != -1 ? '' : ' target=\"_blank\"';\n      return '<a href=\"' + route.urlFor(href) + '\"' + target + '>' + text + '</a>';\n    });\n  }\n\n  _nbsp(str) {\n    return !str.length ? '&nbsp;' : str.replace(/^\\s/, '&nbsp;').replace(/\\s{2}/g, ' &nbsp;');\n  }\n\n  _plainUrlToLink(str) {\n    if (this._state.md) return str;\n\n    const urlRe = RE.url || (RE.url = XRegExp(`(^|\\\\s) ( (?:http|https)://\\\\S+ | mailto:\\\\S+ )`, 'gx'));\n    const endRe = RE.urlEnd || (RE.urlEnd = XRegExp('^(.*)([' + STOP + '])$'));\n    return XRegExp.replace(str, urlRe, (all, b, url) => {\n      const parts = XRegExp.exec(url, endRe) || [all, url, ''];\n      return b + '<a href=\"' + parts[1] + '\" target=\"_blank\">' + parts[1].replace(/^mailto:/, '') + '</a>' + parts[2];\n    });\n  }\n\n  _xmlEscape(str) {\n    return str.replace(/[&<>']/g, (m) => XML_ESCAPE[m]);\n  }\n}\n\nexport const i18n = new I18N();\nexport const l = derived(i18n, ($i18n) => (...params) => $i18n.l(...params));\nexport const lmd = derived(i18n, ($i18n) => (...params) => $i18n.lmd(...params));\n"], "fixing_code": ["Revision history for perl distribution Convos\n\n6.49 Not Released\n - Fix XSS vulnerability in links\n   Contributor: Pocas\n   Reference: https://huntr.dev/bounties/4532a0ac-4e7c-4fcf-9fe3-630e132325c0\n - Add EXPERIMENTAL support for IRC color and text formatting #281 #600\n - Changed to hiding \"https://\" from generated links, but keep \"http://\"\n - Changed I18N.md() to be understand recursive tags #601\n - Updated Italian translation #654\n   Contributor: SerHack\n - Replaced CONVOS_DEBUG=1 with CONVOS_LOG_LEVEL=trace\n\n6.48 2021-12-29T19:40:00+0900\n - Fix catching invalid nick change #628\n - Fix showing tooltips on desktop\n - Add notification sound #589\n   Contributor: egomassive\n   Reference: https://freesound.org/people/egomassive/sounds/536748/\n - Add more rules for files with Content-Disposition\n   Contributor: Pocas\n   Reference: https://huntr.dev/bounties/ae424798-de01-4972-b73b-2db674f82368/\n\n6.47 2021-12-28T12:32:00+0900\n - Add more rules for potentially evil svg files\n   Contributor: KhanhCM\n   Reference: https://huntr.dev/bounties/142c3dcc-a882-4799-949b-520be0a4d144\n\n6.46 2021-12-28T11:27:00+0900\n - Using WHOIS instead of ISON to check if a user is online #360\n - Presenting WHOIS information in conversation #360\n - Fix joining already joined conversations\n\n6.45 2021-12-27T22:17:00+0900\n - Add \"Check for updates\" button to Settings page #585\n - Trying to fix connect queue issues with Convos::Util::Queue\n   * Removed connect queue logic from Convos::Core\n - Removed \"queued\" connection state\n - Changing the connection URL username or password will also cause a reconnect\n\n6.44 2021-12-23T16:17:00+0900\n - Fix SASL EXTERNAL authentication\n\n6.43 2021-12-23T14:29:00+0900\n - Add certificate fingerprint to connection form, when chosing \"SASL External\"\n - Add support for quotes around **bold**\n - Add is_true() function to check boolean environment variables\n   for \"0\", \"Off\", \"No\", \"false\", \"1\", \"On\", \"Yes\" or \"true\".\n - Changed default SASL username to nick\n - Setting CONVOS_SYSLOG=1 will disable logging to file\n - Stop replacing \" (quote) with &quot;\n\n6.42 2021-12-21T10:00:00+0900\n - Fix resetting reconnect delay when manually updating connection settings\n - Fix not changing wanted state to \"disconnected\" when updating connection settings\n - Fix double line breaks inside <pre> in the CMS by changing to Text::Markdown::Hoedown\n - Fix not adding space before channel name links\n - Avoid making #123 turn into channel links, since they are often pull request numbers\n\n6.41 2021-12-18T14:58:00+0900\n - Add support for CONVOS_ACCESS_LOG (EXPERIMENTAL)\n   https://github.com/jhthorsen/mojolicious-plugin-syslog#register\n - Add support for CONVOS_SYSLOG (EXPERIMENTAL)\n\n6.40 2021-12-13T22:32:00+0900\n - Add clear search button #631\n - Add CSRF-check to /logout #632\n   Contributors: Devendra Bhatla and Jamie Slome\n   Reference: https://huntr.dev/bounties/77559ff3-0494-4186-b6e9-c4146bedc0df\n\n6.39 2021-11-27T08:50:00+0900\n - Add file management to frontend #426\n - Add GET /files endpoint #426\n - Add DELETE /files/:uid/:fid endpoint #426\n\n6.38 2021-11-26T08:46:00+0900\n - Use Crypt::Passphrase for password hashing #627\n   Contributor: Stig Palmquist\n - Converted file upload into a core feature\n - Changed \"/file\" API endpoint to \"/files\"\n - Removed back compat /paste/:email_hash/:file_hash URL\n - Using \"npm\" (instead of \"pnpm\") to install node modules\n\n6.37 2021-10-19T20:06:00+0900\n - Fix not having to enable and then disable notifications to disable notifications\n\n6.36 2021-10-19T11:52:00+0900\n - Using convos/convos:base as base image to fix builds #624\n\n6.35 2021-10-18T23:27:00+0900\n - Bumped Alpine version to 3.14\n - Fix \"ReferenceError: body is not defined\" #625\n\n6.34 2021-10-18T11:00:00+0900\n - Going to build docker \"stable\" and \"vX.XX\" as linux/amd64 and linux/arm64,\n   while \"alpha\" will be linux/amd64 only\n\n6.33 2021-10-18T10:48:00+0900\n - Fix parsing links that end with a unicode character #563\n\n6.32 2021-10-14T08:45:00+0900\n - Fix vulnerability: Cannot upload svg with javascript #623\n - Add support for password for default connection channel #621\n - Add progress bar for uploads\n\n6.31 2021-10-02T06:51:00+0900\n - Fix turning channel names with \"-\" into links\n - Have to build a different tag for arm64 (for now) #464\n\n6.30 2021-09-25T18:30:00+0900\n - Fix not making links inside links when #fragments are seen\n\n6.29 2021-09-25T18:18:00+0900\n - Fix decoding/encoding password and username for connections #620\n - Fix trying to connect if wanted_state is \"connected\"\n - Fix \"Facts\" bot action to only reply if the fact ends with \"?\"\n - Add channel names are now clickable\n - Add AWAY message to WHOIS response #360\n - Add /away command #360\n - Add more connection states: connecting and disconnecting\n - Add server messages when connections state changes\n - Add \"Retry\" button to loading screen\n\n6.28 2021-09-12T15:38:00+0200\n - Fix notifications styling when channel changes\n - Add styling for conversations with notifications\n - Will update unread/notifications on conversation load, instead of unload\n\n6.27 2021-08-28T16:52:00+0200\n - Changed notifications are now per channel #612\n   Contributor: Jess Robinson\n - Fix not converting %\\d+ strings into \"undefined\" #616\n - Fix not showing conversation settings header on small screen\n\n6.26 2021-07-20T07:09:00+0900\n - Fix clearing the global search\n - Fix \"+#\" and \"+@\" in search bar to also filter \"60+\" #607 #609\n - Fix security issue with toggling \"raw\" for messages\n\n6.25 2021-07-18T10:14:00+0900\n - Add handler for irc:// links #311\n - Add support for raw messages #592\n - Add support for a single character within backticks #602\n - Add settings icon to Notifications page #606\n - Add confirmation before deleting a connection #610\n - Made \"+\" filter in search bar sticky and also filter \"60+\" #607 #609\n - Fix not showing double quotes in previews #608\n - Fix animation when focusing sidebar-header search field\n\n6.24 2021-06-02T10:28:00+0900\n - Add chat input field sent messages/commands history #598\n - Fix rendering notifications with non-unicode characters #596\n - Fix /chat/ will render notifications\n - Fix width of sidebar-header input in Firefox 78.10.0 ESR\n - Changed extended formatting to be stripped frontend code #600\n\n6.23 2021-05-29T11:55:00+0900\n - Add popover on nick click, closes #566, #591\n - Fix hiding menu when selecting an emoji\n - Fix allowing to create new connections for non-admin users\n\n6.22 2021-05-28T10:25:00+0900\n - Add GNOME theme #594\n - Fix joining password protected channels\n\n6.21 2021-05-28T09:43:00+0900\n - Add possibility to remove password protection in Conversation Settings\n - Add active conversation modes to Conversation Settings\n - Can toggle channel modes from conversation settings\n - Fix sending messages to participants in connection conversation\n - Fix setting password in conversation settings\n - Fix setting topic in conversation settings\n - Fix toggling notification in conversation settings\n - Fix bug where conversation modes could get reset\n - Fix bug where user modes could get reset\n - Fix being able to change the topic if the channel has mode -t #427\n\n6.20 2021-05-25T10:03:00+0900\n - Add support for Github Webhooks, through the bot system\n - Compatible with Mojolicious::Plugin::Webpack 1.01\n - Bumped many JavaScript dependencies\n - Fix catching unhandled send_p() promises\n - Fix join/part actions for the bot plugin\n - Fix showing the correct copyright year\n - Fix showing the installed version when running \"convos version\"\n\n6.19 2021-05-20T09:03:00+0900\n - Add support for quotes in the CMS\n\n6.18 2021-05-20T07:30:00+0900\n - Changing defaults from freenode to https://libera.chat/\n - Changed sections toggle styling from checkbox to caret\n\n6.17 2021-05-18T12:13:00+0900\n - Fix not enabling the client side router for CMS pages\n - Fix always rendering the same theme for the CMS pages\n - Add support for CONVOS_DEFAULT_THEME and CONVOS_DEFAULT_SCHEME environment variables\n\n6.16 2021-05-18T11:03:00+0900\n - Add <SimpleField> for form fields without styling\n - Add \"viewport\" store, which replaces \"nColumns\" store\n - Add client side log utility for easier debugging\n   * Can be toggled with \"?_debug=root:trace,category:level\"\n - Fix \"removeConnectionProfile\" operation in the API\n - Fix changing nick, realname, sasl, tls and tls_verify for forced connections\n - Fix changing source IP for connections\n - Fix constrast issues for \"South\" theme\n - Fix only loading emojis once\n - Fix only loading translations once\n - Fix rendering issue when switching between connection profiles and profile editor\n - Bumped rollup and svelte dependencies\n - Changed \"Generate invite link\" button to only be active when an email is filled in\n - Changed client side routing logic\n   * Removed routes.js\n   * Moved routing logic into App.svelte\n - Replaced form \"change\" event handling with svelte stores bound to the form elements\n   * This will hopefully fix some issues where toggling TLS did not work properly\n - Replaced node-sass with sass\n - Removed \"anonymous\" and \"authenticated\" roles from client side User object roles\n - Removed support for \"form\" HTML element and \"start\" event in Operation.js\n - Removed support for showing progress bar when loading data\n - Will use the current connection Id when clicking on \"Add conversation\"\n\n6.15 2021-05-06T10:30:00+0900\n - Fix invitation link handling\n - Fix changing \"Source IP\" fo a connection\n - Improved handling of errors on the login page\n - Improved input field focus on login screen\n - Improved \"Dracula\" theme form field rendering\n - Will reconnect to IRC server when \"Your name\" or \"TLS verify\" changes as well\n\n6.14 2021-04-29T20:30:00+0900\n - Fix iOS bug, where Safari would crash because it can't handle complex regexes\n\n6.13 2021-04-29T10:59:00+0900\n - Add \"Dracula\" color theme\n - Fix handling URLs with conversation names ending with \".js\"\n - Improved emoji autocomplete #547\n - Updated emojis list #547\n - Removed emojis selector from ChatInput on small screens\n - Will set MOJO_REVERSE_PROXY based on CONVOS_REVERSE_PROXY\n\n6.12 2021-04-16T09:45:00+0900\n - Fix on_connect_commands might not be set in all cases\n - Fix toggling TLS and TLS verify checkboxes\n - Improved feedback to user on failed/successful save of forms\n - Improved feedback in case TLS settings are incorrect\n\n6.11 2021-04-10T19:54:00+0900\n - Changed /logout to always result in 302 redirect #586\n - Removed \"dependencies\" from /settings\n\n6.10 2021-04-05T14:12:00+0900\n - Will prompt the user to enable notifications\n - Fix chat action links\n - Fix editing connection when uri= is present\n - Fix position for \"jump to now\" above chat input\n\n6.09 2021-04-05T15:18:00+0900\n - Add \"skip_queue\" to connection profile\n - Fix not skip the connection queue on connect failure\n - Hide port number in connection list\n\n6.08 2021-04-05T12:43:00+0900\n - Add support for some more command aliases #580\n - Add logging of login attempts #582\n - Add support for connection profiles #584\n - Add DELETE /api/connection-profiles/:id #584\n - Add GET /api/connection-profiles #584\n - Add POST /api/connection-profiles #584\n - Add focus to login form on desktop\n - Fix width of inputs on ConversationAdd page\n - Renamed /settings/connection to /settings/connections #584\n - Removed \"protocol\" from Convos::Core::Connection\n - Removed dependencies from \"Settings\"\n - Simpler Convos::Core::Settings by removing support for deprecated environment variables\n - Moved global connection settings from \"Settings\" to \"Connections\" #584\n - Moved \"remote_address\" tracking from connection URL to user object\n\n6.07 2021-03-24T12:44:00+0900\n - Add dependency information to Admin page\n - Fix compatibility with Mojolicious 9.11\n - Fix typo in Fallback.svelte\n\n6.06 2021-03-05T08:30:00+0900\n - Add /shrug command\n - Fix not learning \"h is tory\" facts\n\n6.05 2021-02-23T13:43:00+0900\n - Split advanced options into \"Show advanced settings\" and \"Show authentication settings\"\n\n6.04 2021-02-23T11:43:00+0900\n - Add EXPERIMENTAL support for serving CMS pages as text and yaml\n - Fix only sending \"WEBIRC ...\" command if environment variable is set\n - Fix hiding the sidebar menu when URL changes\n\n6.03 2021-02-23T21:15:00+0900\n - Had to revert Alpine to 3.12 to complete the build on hub.docker.com\n\n6.02 2021-02-23T20:28:00+0900\n - Add default lang to stash #578\n - Add support for convos install [--bot,--ldap]\n - Fix \"/reconnect\" command #576\n - Fix placing password toggle at the right place\n\n6.01 2021-02-23T08:48:00+0900\n - Add support for setting source IP for a connection\n - Changed the design on the login screen to only show one form\n - Fix clipping of text in the heading\n - Fix clicking on a the conversation name toggles the settings pane\n - Fix race condition where \"join\" event would override the \"topic\" message\n\n6.00 2021-02-22T09:30:00+0900\n - Changed from Nordaaker to github.com/convos-chat and hub.docker.com/r/convos\n - Highlights since 5.00\n   * Add \"Facts\" bot action\n   * Add \"compact display mode\" as Viewport option\n   * Add /ns (msg nickserv) and /cs (msg chanserv) aliases\n   * Add better user experience for +i (invite only) channels\n   * Add rendering of banlist, exceptlist, invitelist and quietlist\n   * Add support for EXTERNAL and PLAIN SASL authentication\n   * Add support for WEBIRC\n   * Add support for negotiating IRCv3 capabilities\n   * Add support for nicer message-of-the-day (MOTD) server messages\n   * Add support for translations, and got translated to Italian, Norwegian and Spanish\n   * Changed \"chanserv\" and \"nickserv\" to be inside the connection conversation\n   * Compatible with latest Mojolicious 9.0 and M::P::OpenAPI 4.0\n   * Improved animations\n   * Moved video button to chat input\n   * Render Google meet, Webex and Whereby as video invite links\n - Contributors:\n   * Abhijit Menon-Sen\n   * Iv\u00e1n \u00c1valos\n   * Jan Henning Thorsen\n   * Jos\u00e9 Joaqu\u00edn Atria\n   * Marcus Ramberg\n   * Megaf\n   * SerHack\n   * Thibault Duponchelle\n\n5.32 2021-02-22T09:10:00+0900\n - Can toggle password inputs as plain text #569\n - Add alert icon if a channel is frozen in the sidebar #568\n - Changed login screen to be side-by-side\n\n5.31 2021-02-21T14:30:00+0900\n - Fix styling on login screen\n - Allow other hosts than \"localhost\" to skip the connect queuing\n\n5.30 2021-02-20T16:33:00+0900\n - Add better user experience for +i (invite only) channels #568\n\n5.29 2021-02-20T14:00:00+0900\n - Replaced spinning animation with scale translation between icons\n - Replaced hover zoom effect with circular border\n - Changed the headings to be less bold\n - Changed from \"tools\" icon to \"users-cog\" for conversation settings toggle\n - Moved video button down to chat input\n - Changed the textarea to fill up the whole chat input if multiple lines are present\n - Add (+) icon to the chat input with new action menu on small screens\n   * Start video chat\n   * Upload\n   * Emojis\n\n5.28 2021-02-18T23:11:20+0900\n - Fix video iframe to take full height #570\n - Add support for unicode to the Bot backend storage layer\n - Add error handling to Jitsi\n - Add suport for \"suppress_do_not_know_reply\" ot \"Facts\" bot action\n\n5.27 2021-02-17T23:04:00+0900\n - Compatible with latest Mojolicious 9.0 and M::P::OpenAPI 4.0\n - \"Facts\" bot action will not learn questions\n - Fix searching case insensitive\n\n5.26 2021-02-15T10:34:00+0900\n - Reverted \"Add Content-Security-Policy header to Convos\" #508\n\n5.25 2021-02-15T10:25:00+0900\n - Add feedback when changing channel mode #454\n - Add rendering of banlist, exceptlist, invitelist and quietlist #432\n - Add \"Facts\" bot action\n - Add query_db() method to bot plugins\n - Add Content-Security-Policy header to Convos #508 #567\n - Entering \"+\" in the quick search bar will show conversation with unread messages\n - Entering \"+#\" in the quick search bar will show channels with unread messages\n - Entering \"+@\" in the quick search bar will show private conversation with unread messages\n\n5.24 2021-02-11T09:30:00+0900\n - Will not show participants in sidebar if already visible on the right side\n - Will not jump to the first conversation when leaving a conversation\n - Fix loading conversations in \"Add conversation\"\n\n5.23 2021-02-11T08:03:00+0900\n - Fix hover to show timestamp for message\n - Fix loading more messages if scrollbar is not seen #558\n\n5.22 2021-02-10T10:09:00+0900\n - Add support for nicer message-of-the-day (MOTD) server messages\n - Fix rendering multiple spaces in a string\n - Revert \"Changed from connection ID to real_host in chat sidebar\"\n - Will not render message details if the message is simple\n\n5.22 2021-02-08T10:05:00+0900\n - Fix clicking on nicks in conversation\n\n5.21 2021-02-05T09:23:00+0900\n - Fix handling expandUrlToMedia #562\n - Fix keeping track of which nick is yours in conversations\n\n5.20 2021-02-04T13:00:00+0900\n - Fix handling offline/online nick logic\n\n5.19 2021-02-04T12:00:00+0900\n - Fix typo in calculateModes()\n - Fix number of participants in ChatParticipants\n - Fix parsing user modes\n\n5.18 2021-02-04T11:47:00+0900\n - Fix typo in Participants.js\n\n5.17 2021-02-04T11:42:00+0900\n - Fix handling join events\n - Fix handling /names response\n - Fix handling /whois response\n\n5.16 2021-02-04T11:28:00+0900\n - Add nick to video conversation url\n - Add /ns (msg nickserv) and /cs (msg chanserv) aliases\n - Fix rendering action messages\n - Improved video conversation name for private conversations\n - Improved rendering of new conversations\n\n5.15 2021-02-03T10:51:00+0900\n - Hide from and icon for notice and error messages\n - Rolled back \"channel@connection\" as title\n - Changed from connection ID to real_host in chat sidebar\n - Will render Google meet, Webex and Whereby as video invite links\n\n5.14 2021-02-02T06:46:00+0900\n - Add \"real_host\" as connection participant\n - Improve search logic and changed keywords #560\n - Fix rendering internal video chat links #543\n - Fix errors from commands will show up in the same dialog\n - Fix hiding <img> inside embed that cannot be loaded\n - Fix remembering if toggleDetails has been toggled while scrolling\n - Fix details styling to match paste syntax highlight\n - Fix not getting \"#undefined\" when scrolling in conversations\n - Fix not keeping scroll lock forever\n - Fix setting document title\n - Fix showing /names response in same dialog\n - Change any Jitsy link to be rendered inside the /video/... page\n - Change Conversation.title to \"name@server\"\n - Replace renderMessages with Messages store\n - Updated Spanish translation #561\n\n5.13 2021-01-23T12:42:00+0900\n - Fix parsing .po files\n\n5.12 2021-01-23T11:49:00+0900\n - Add language picker to SettingsAccount and login screen\n - Add support for multiple lines in .po files\n - Add \"recover\" command\n - Fix openssl is required in docker tob build certificates\n - Improved Italian translations #559\n   Contributor: SerHack\n - Improved Norwegian translations #553\n - Improved Spanish translations #552\n   Contributor: Iv\u00e1n \u00c1valos and Jos\u00e9 Joaqu\u00edn Atria\n - Improved output from \"convos build\" command\n - Allow .po files to be reloaded when developing\n - Removed \"command\" from Bot action message events\n\n5.11 2021-01-14T08:57:00+0900\n - Add Norwegian translations #549\n - Add Italian translations #548\n   Contributor: SerHack\n - Fix unicode issues related to translations #422\n - Fix loading language files in production\n\n5.10 2021-01-13T14:43:00+0900\n - Add support for other languages #422\n - Add Spanish translations #545\n   Contributor: Iv\u00e1n \u00c1valos and Jos\u00e9 Joaqu\u00edn Atria\n - Add EXPERIMENTAL support for WEBIRC #346 #444 #546\n - Add author to blog posts\n - Fix utf8 issue in blog posts\n\n5.09 2021-01-08T09:35:00+0900\n - Fix SASL authentication process for Oragono IRCd (and others) #356\n - Fix issue where notifications were double encoded UTF-8\n\n5.08 2021-01-05T12:21:00+0900\n - Fix \"convos version\" after install/upgrade #539\n - Fix reading notifications with unicode\n - Fix issue with some pastebin links\n - Add notification when a video link is sent #472\n - Add link to raw version of the paste\n - Improved filename for pasted files\n\n5.07 2020-12-29T13:32:00+0900\n - Add support for EXTERNAL and PLAIN SASL authentication #356 #525\n - Add supoort for nickserv certfp authentication #380\n\n5.06 2020-11-30T11:25:00+0900\n - Add a \"compact display\" mode as Viewport option #535\n   Contributor: Abhijit Menon-Sen\n - Add tighter integration with Jitsi video chat #536\n - Fix leading uppercase characters in usernames #538\n   Contributor: Abhijit Menon-Sen\n - Removed EXPERIMENTAL video support added in 4.08 #204\n\n5.05 2020-11-25T11:52:00+0900\n - Add support for for \":-*\", \":O\" and \"(Y)\" #534\n   Contributor: Megaf\n - Add better rendering of Jitsi links\n - Fix not adding new private messages, unless historyStopAt\n - Fix resetting historyStopAt and historyStartAt when jumping back in history\n\n5.04 2020-11-24T21:42:00+0900\n - Fix pasting text into the chat input\n - Fix updating search field value\n\n5.03 2020-11-24T21:24:00+0900\n - Fix not jumping back in the chat input when pressing shift\n\n5.02 2020-11-24T18:53:00+0900\n - Add user input to localStorage, so it survives refresh\n - Fix injecting upload link to user input field\n - Fix not dropping key pressees\n\n5.01 2020-11-23T14:23:00+0900\n - Add support for negotiating IRCv3 capabilities #444\n - Add chat input text is coupled to conversation #524\n   Contributor: Thibault Duponchelle\n - Add support for hiding join/part messages #527\n   Contributor: Thibault Duponchelle\n - Change WHOIS reply to show more information #528\n   Contributor: Abhijit Menon-Sen\n - Add \"realname\" as a new connection parameter #529\n   Contributor: Abhijit Menon-Sen\n - Add WHOIS will be run on new private messages\n - Changed service accounts \"chanserv\" and \"nickserv\" will show up in connection conversation #379 #532\n - Change clicking on a nick will create a new conversation #530\n - Fix avoid rendering regexes as markdown links #522\n - Fix not sending username with a non-alphanumeric first character #531\n   Contributor: Abhijit Menon-Sen\n - Fix J::V and M::P::OpeAPI dependencies\n - Fix clicking on [settings] link in chat\n - Fix loading notifications\n - Fix not counting your own messages as unread\n - Fix not queueing a connection if wanted_state is \"disconnected\"\n - Fix scrolling to bottom of conversation on initial render\n\n5.00 2020-11-17T07:24:00+0900\n - Renamed \"Dialog\" to \"Conversation\" #519\n - Renamed \"$sidebar-item-dialog-indent\" css variable to \"$sidebar-item-conversation-indent\" #519\n - Renamed API endpoints from \"dialogs\" to \"conversations\" #519\n\n4.42 2020-11-05T09:54:00+0900\n - YAML::XS is an optional module\n - Fix selecting text in chat\n\n4.41 2020-11-04T11:20:00+0900\n - Fix keepalive PING message\n - Fix \"Unknown operationId\" errors in Operation.js\n - Add \"Notify me on new messages\" to private conversations\n - Add \"loading\" page which will be shown if the backend is not ready\n - Add support for \"/sleep 4.2\" in on_connect_commands #517\n - Removed last_active and last_read from Dialog\n - Renamed \"read\" operationIds in OpenAPI spec\n - Mark notifications as read when leaving the \"Notifications\" page\n\n4.40 2020-09-22T10:06:00+0900\n - Fix line numbers in embedded paste\n - Fix opening links inside embeds in new tab/window\n - Fix Docker on Windows #514\n   Contributor: Derzsi D\u00e1niel\n - Upgrade Docker Alpine version to 3.12 #513\n   Contributor: Derzsi D\u00e1niel\n - Bumped LinkEmbedder to v1.14\n\n4.39 2020-09-17T20:19:00+0900\n - Depend on LinkEmbedder v1.13\n - Removed the slash over the notification bell\n\n4.38 2020-09-13T18:31:00+0900\n - Fix typo in renderMessages.js\n\n4.37 2020-09-13T18:22:00+0900\n - Add notification icon on the top of the <SidebarChat/>\n - Add suppport for custom bot password\n - Fix joining dialog when creating connection #512\n - Fix bot Hailo action will not store \"nick: ...\" prefix\n - Fix using \"expandUrlToMedia\" setting from user account\n - Change bot to wait one second before replying\n - Change default Hailo engine class to Hailo::Engine::Scored\n - Will only add \"has-focus\" to message when coming from search or notifications\n\n4.36 2020-09-01T11:12:00+0900\n - Fix clearing dialog messages when loading overlapping messages\n - Fix not loading messages when a dialog already has messages\n - Fix not having #undefined in location when scrolling to \"date change\" marker\n - Fix not skipping a month when fething messages at end of month\n\n4.35 2020-08-28T12:27:00+0900\n - Fix not following link when clicking on a thumbnail\n - Fix not focusing \"search\" input on load/routerender\n - Fix searching for messages\n - Changed styling for message that has focus\n\n4.34 2020-08-28T11:35:00+0900\n - Add support for \"around\" which will load messages faster\n - Improved \"keep scroll position\" logic with <InfinityScroll/> component\n - Improved WebSocket error messages\n - Fix loading relevant messages when clicking on a notification or search result #511\n - Fix focus logic on Shift+Enter and Esc\n - Fix max-width for YouTube iframe on small screens\n - Fix reloading Notifications\n - Fix drag&drop effect when uploading files\n - Fix reporting installed versions after \"convos install\" has run the first time\n - Changed default websocket error message\n - Removed loading of external Instagram JavaScript library\n - Removed loading of external Twitter JavaScript library\n\n4.33 2020-08-08T17:32:00+0900\n - Prevent frontend from sending the whole dialog object, which results in\n   WebSocket close clode \"1009\"\n\n4.32 2020-08-06T19:09:00+0900\n - Fix loading login page for new users\n\n4.31 2020-08-06T12:59:00+0900\n - Add backoff reconnect logic to the WebSocket\n - Fix issue where the WebSocket would not reconnect after being disconnected\n - Fix reloading user object on reconnect\n - Fix showing error messages in current dialog\n - Waiting for \"online\" and \"offline\" events in the browser does not seem to\n   work as expected.\n\n4.30 2020-08-05T09:29:00+0900\n - Will trim target when sending commands\n   * This fixes commands like \"/whois nick \" with trailing spaces\n - User can resend messages when WebSocket reopens\n - Trying to fix WebSocket closing unexpectedly\n - Improved rendering of message details\n - Fix settings \"secure\" for client side \"convos_js\" cookie\n - Fix \"Content-Security-Policy: unsafe-inline\" header is no longer required #508\n - Fix issues with generating pretty connection names #507\n - Changed to base64 encoded email in markup to make it harder for bots\n - Changed to using \"alternate stylesheet\" to represent theme options\n - Removed invalid help in ConnectionForm #507\n - Removed \"!\" prefix from public bot commands #509\n - Updated JavaScript dependencies\n\n4.29 2020-07-29T07:57:00+0900\n - Fix memory leak where connections would not be cleaned up when user was deleted\n - Fix copy invite/recover link to clipboard\n - Fix showing that you are offline (was removed by accident in 4.24)\n - Add support for HTML notifications\n - Made calculating \"unread\" faster\n\n4.28 2020-07-24T18:05:00+0900\n - Fix detecting if Convos has focus, which again enables notifications\n\n4.27 2020-07-24T16:20:00+0900\n - Removed auto-rotate image code\n - Fix not getting notifications when you send messages\n - Fix showing notifications when chat is not focused\n\n4.26 2020-07-24T11:20:00+0900\n - Add bot \"spool\" action\n - Fix loading bot \"karma\" action\n - Fix typo in embedMaker #506\n\n4.24 2020-07-24T09:55:00+0900\n - Add functionality for managing users #417 #505\n - Add API enpoint for listing users #417\n - Improved rotation of images #506\n - Synchronized title between server and client side\n - Fix rendering links inside `code` #503\n - Fix setting proper bot mode (+B)\n - Fix the bot so it does not reply to its own messages\n - Fix Notifications links when mounted under /whatever\n - Fix t/web-admin #504\n - Fix rendering disabled buttons\n - Improved loading time by getting user data from WebSocket\n - Improved readability of unit tests\n - Changed to showing \"https://\" in links\n - Changed API endpoint for updating and deleting users #417\n\n4.23 2020-07-08T19:06:00+0900\n - Fix rendering /register route\n - Add \"script/convos upgrade\" sub-command\n - Add disk usage to the settings page\n - Add EXPERIMENTAL \"bot\" functionality through Convos::Plugin::Bot #502\n   * Add \"Calc\" bot action\n   * Add \"Core\" bot action\n   * Add \"Hailo\" bot action\n   * Add \"Karma\" bot action\n\n4.22 2020-06-18T11:11:00+0900\n - Fix not generating new \"uid\" for the users on restart\n\n4.21 2020-06-18T08:39:00+0900\n - Fix serving existing uploaded files\n\n4.20 2020-06-18T08:31:00+0900\n - Fix hanging up a WebRTC call\n - Fix iOS issue where /login screen is rendered when actually logged in\n - Fix invalid social \"image\" for blog posts\n - Add formatting for <code> for the CMS\n - Converted short_checksum() to use sha1_sum\n - Fix generating random local secret for Docker\n   You might want to regenerate your \"local_secret\" in\n   $CONVOS_HOME/settings.json if you are using Docker\n\n4.19 2020-06-10T08:39:00+0900\n - Fix rendering \"Account\" page on touch devices\n - Fix login/cms footer and header on small screens\n - Fix cpanfile for Text::Markdown\n - Bumped JSON::Validator and Mojolicious::Plugin::OpenAPI dependencies\n\n4.18 2020-06-05T13:37:00+0900\n - New login and fallback page design that matches https://convos.chat\n - Fix <SelectField> click and filter issues\n - Fix reverse proxy detection for the first user\n - Perldoc rendering must be enabled with CONVOS_CMS_PERLDOC=1\n - Will scan for new blogs every 15 seconds\n\n4.17 2020-06-03T10:35:00+0900\n - Fix absolute URL to social image from CMS\n - Fix not setting X-Provider-Name in CMS mode\n - Fix API links in POD\n - Fix \"redirect_to\" for CMS\n - Add TOC to cms pages and perldoc\n - Add shortcut for FontAwesome icon inside markdown\n - Can automatically pull description from the first paragraph\n - Reduce docker image size #492\n - Improved login screen design\n - Improved rendering of perldoc\n - Improved support for markdown inside tags\n - Replaced Text::MultiMarkdown with Text::Markdown since it is easier to install\n\n4.16 2020-06-01T22:16:00+0900\n - Cannot load Module::Install directly\n\n4.15 2020-06-01T22:07:00+0900\n - Add missing dependency\n\n4.14 2020-06-01T21:56:00+0900\n - Add CMS functionality\n - Fixed highlight color for dark themes\n\n4.13 2020-05-31T10:04:00+0900\n - Add light variant of \"Nord\" theme #476\n   Contributor: Thibault Duponchelle\n - Add \"Hacker\" theme #479\n   Contributor: Thibault Duponchelle\n - Add support for \"OPER\" command\n - Fix \"Color scheme\" dropdown reflect the options from the theme #482\n   Contributor: Thibault Duponchelle\n - Fix \"Notifications keywords\" text field value has new value after saving\n   user account #485 #486\n - Fix description in site.webmanifest.ep\n - Fix font awesome cache issue\n - Fix toggling message details\n - Fix not making pictures from https://convos.chat gargantic\n - Changed \"/raw\" to \"/quote\"\n - Changed to always sending \"/quote\" messages from connection conversation\n\n4.12 2020-05-25T10:04:00+0900\n - Fix unread count styling on small screens\n\n4.11 2020-05-25T09:55:00+0900\n - Fix upload files button in chat-input\n - Add animations to some of the buttons\n\n4.10 2020-05-24T12:32:00+0900\n - Fix sending WeBRTC signals between private conversations\n\n4.09 2020-05-24T12:17:00+0900\n - Avoid hearing yourself locally through video chat\n - Can toggle WebRTC connection info by clicking on participant nick\n - Fix accepting calls in private conversations\n - Fix rendering of main menu on small screens\n - Fix making the chat input field stand out on small screens\n\n4.08 2020-05-23T15:32:00+0900\n - Add EXPERIMENTAL video support #204\n - Will send desktop notification on video call #472\n - Add support for parsing \"ahq\" user modes #471\n - Add \"South\" theme #469\n   Contributor: Thibault Duponchelle\n - Fix not forgetting theme settings when browsere is closed\n - Fix how unread count is presented/calculated #470\n - Fix serving themes from correct URL behind reverse proxy\n - Fix button colors for all themes #467 #468\n   Contributor: Thibault Duponchelle\n - Removed Nordaaker background on login screen #439\n\n4.07 2020-05-15T09:39:00+0900\n - Fix \"Go to start page\" and \"Retry\" links inside <Fallback>\n - Fix markdown links to relative links will not refresh the page\n - Changed from \"convos green\" to red in the \"High-contrast\" theme #465\n   Contributor: Thibault Duponchelle\n\n4.06 2020-05-13T13:19:00+0900\n - Improved keeping scroll position\n - Fix loading embeds after the correct message\n\n4.05 2020-05-10T10:06:00+0900\n - Avoid XSS links in the chat\n\n4.04 2020-05-09T08:42:00+0900\n - Add \"Jump to now\" link in Chat #453\n - Add line numbers for hljs #461\n - Add support for searching for \"from\"\n - Add \"Desert\" theme\n - Add \"High contrast\" theme, with dark/light mode\n - Add support for \"CONVOS_REQUEST_BASE\", which is an alternative to\n   the \"X-Request-Base\" header\n - Fix jumping to the right position in chat history #453\n - Fix edge cases for ?after= and ?before= #459\n - Fix being able to make a paste with unicode #460\n - Fix select-field styling on \"Add conversation\" page\n - Fix \"substr outside of string at Mojo/Asset/Memory.pm line 45.\" warning\n - Fix rendering <Fallback/> pages\n - Fix loading PWA assets in <head>\n - Removed support for fetching \"user.json\" with notifications.\n - Replaced Convos icon with \"info-circle\" icon in chat\n - Avoid inactivity_timeout from /api/embed.json\n - Avoid including the short timestamp when doing copy of chat dialog\n - Will persist theme settings in a cookie to prevent flashing between themes\n   on load\n\n4.03 2020-04-07T11:32:00+0900\n - Fix parsing routes such as /chat/irc-convos/%23x%2Fbar\n - Fix rendering of /file/1/lNqUVc43p0h4jaj5 paths\n\n4.02 2020-04-06T22:10:00+0900\n - Fix not being able to subscribe to store\n - Fix not showing the nav menu by default on small screens\n - Made the chat input look more like an input\n\n4.01 2020-04-06T21:39:00+0900\n - Add Nordaaker as background image to login screen #439\n - Add support for searching for anything from main search input #457\n - Fix rendering convos images on small screen #450\n - Fix not allowing injected \"#call:\" and \"#send:\" links\n - Fix not looping through all dialogs and marking them as read on reconnect\n - Fix not showing \"date changed\" in <Search/> before search is performed\n - Fix not asking for protocol handling all the time in Firefox\n - Extended the webmanifest\n - Changed to pagejs for routing on client side\n - Replaced \"settings\" in svelte context with process.env\n\n4.00 2020-03-24T16:00:00+0900\n - Add custom styling for image previews from Convos #450\n - Add checkbox for \"forced_connection\" in \"settings\" #456\n - Add search to frontend #187\n - Made the theming support more flexible #394\n - Fix not sending /query before sending a list of channels to the server #442\n - Fix issue in firefox where padding-bottom is ignored\n - Fix not removing space from sent message before \"/\"\n - Fix creating paste from multiline messages\n - Syncronized Makefile.PL and cpanfile, and bumped dependencies\n - Travis runs the test suite successfully again\n\n3.12 2020-03-04T11:28:00+0900\n - Add /clear history [name] command #150\n - Fix NaN in the help page, for \"/say\" command\n - Fix Timer failed: Can't call method \"write\" on an undefined value in Irc.pm\n - Fix showing \"day changed\" indicator\n - Add \"s\" after seconds in wsEventSentWhois()\n - Add JOIN as alias for QUERY (EXPERIMENTAL)\n - Made the welcome messages less annoying\n - Bumped node dependencies\n\n3.11 2020-03-02T15:11:00+0900\n - Fix exception when searching too long a period #448\n   Contributor: Doug Bell\n - Add support for pasting images #437\n - Add a welcome message when joining a new conversation\n - Fix handling err_badchannelkey #268\n - Fix button alignment in <DialogAdd>\n - Rollback \"Avoid reloading conversation when reconnecting to WebSocket\"\n\n3.10 2020-02-21T16:09:00+0900\n - Fix loading notifications\n\n3.09 2020-02-21T15:40:00+0900\n - Fix compatibility with old versions of Edge/IE #441\n - Fix handling very long messages #443\n - Fix sending a single space #446\n - Fix keeping track when changing nick\n - Fix not having strike-through for Convos messages\n - Add LDAP support to Convos #65 #418\n - Add custom \"help\" and \"version\" commands\n - Add \"--all\" switch to \"install\" sub command, which also installs suggested deps\n - Add \"cpanm\" sub command\n - Add \"exec\" sub command\n - Avoid reloading conversation when reconnecting to WebSocket (EXPERIMENTAL)\n - Documented sub commands that used to be hidden\n - Made it easier for the first user to sign up\n\n3.08 2020-01-30T11:24:00+0900\n - Removed support for underscore markdown formatting #438\n - Removed tooltip for dialogs in <SidebarChat/>\n - Improved rendering of login screen on small screens\n - Will hide the active menu when clicking on the overlay\n\n3.07 2020-01-27T10:00:00+0900\n - Fix not nuking files on disk if no more disk space\n - Add visible tooltips #436\n - Will try to rotate uploaded JPEG images\n\n3.06 2020-01-09T14:08:36+0900\n - Fix link color inside pseudo form elements\n - Fix not focusing the last element in the sidebar\n - Fix timestamp color for the Nord theme\n\n3.05 2020-01-07T11:32:36+0900\n - Fix autocomplete text color\n - Fix not focusing two nav items after going back/forward in history after searching\n - Fix changing focus in navbar when the URL changes\n - Fix channel name not getting collapsed in heading\n - Render readonly topic as html in settings and made the topic clickable as well\n - Better transition between different loading states\n - Bumped LinkEmbedder to 1.11\n\n3.04 2020-01-06T22:07:36+0900\n - Add custom title for all pages\n - Fix bugs in Dark and Nord theme\n - Fix showing <SidebarChat/> only on pages that wants it\n - Fix clearning activeMenu when changing page\n - Fix not reloading User from <ConnectionSettings/>\n - Fix not notifying the user when the user has already accepted notifications\n\n3.03 2020-01-06T14:21:36+0900\n - Fix serving uploaded files with correct Content-Type #435\n - Fix offset for hamburger menu\n - Fix not duplicating notification messages\n - Designed new login/register screen, where they are on the same page\n - Renamed \"Login\" and \"Register\" to \"Sign in\" and \"Sign up\"\n - Will display connection name in sidebar\n - Changed Dark theme: Less dark inputs and darker buttons\n - Changed Nord theme: Made the inputs visible on blue background\n\n3.02 2019-12-29T11:02:36+0900\n - Fix getting topic on connect #433\n - Fix clicking on dropdown options #434\n - Fix \"/ison\" without arguments\n - Add clearing of the password fields to prevent browser autocomplete\n\n3.01 2019-12-28T13:30:36+0900\n - Fix not send command as message by acciden #428\n - Fix removing dialog when sending PART\n - Fix /names logic both in JavaScript and Connection::IRC\n - Improved autocomplete documentation for /mode #430\n - Improved MODE handling, especially related to ban lists #431 #432\n\n3.00 2019-12-24T10:15:35+0900\n - Breaking change: The Perl code changed from callback based API to promises #420 #423\n   * Removed Mojo::IRC as a dependency #392\n   * Removed Convos::Core::Connection->set_wanted_state()\n   * Removed \"get_user\" WebSocket event\n   * Removed \"participants\" API endpoint\n   * Removed all blocking APIs\n   * Replaced CONVOS_STEAL_NICK_INTERVAL with CONVOS_IRC_PERIDOC_INTERVAL\n - Add support for file upload #244 #424\n   * Add back compat URL handling for /paste/:user_public_id/:paste_id\n   * Replaced Convos::Plugin::Paste with Convos::Plugin::Files\n - Add handling of \"Trying to reconnect too fast\" #410\n - Add organization_name and organization_url to sidebar and help page\n - Add removal of embeds that doesn't render correct images\n - Add message errors to the active conversation, instead of connection conversation\n - Fix using connection URL \"username\" when sending \"USER ... 0 * :Name\"\n - Fix indicating that user is offline in chat messages\n - Fix duplicate text in <ChatInput/> when clicking on a nick\n - Fix being able to clear organization_name and organization_url in\n   updateSettings endpoint\n - Fix $fa-font-path when behind reverse proxy #419\n   Contributor: Andreas Voegele\n - Fix snap builds #366 #421\n   Contributor: Adam Stokes\n - Changed default CONVOS_CONNECT_DELAY from 3 to 4\n - Bumped LinkEmbedder to 1.10 which fixes handling of Google links\n - Removed Convos::Plugin->add_backend_helpers()\n - Replaced Convos::Core::User->public_id() with uid()\n - Replaced MOJO_REVERSE_PROXY with CONVOS_REVERSE_PROXY\n - Improved user experience on the Settings page\n\n2.00 2019-11-23T10:23:35+0900\n - Add roles() and role() to Convos::Core::User #99 #407 #411\n   * The first user will get the admin role\n   * Will automatically upgrade the first registered user for legacy reasons\n - Can now generate invite/recovery links from the web #361 #407 #411\n   * Add /user/#email/invite API endpoint\n   * Replaced invite_code and recover logic with invite links\n   * The first user does not need an invite link\n   * Changed \"Register\" is now the default screen, instead of \"Login\"\n   * Removed support for CONVOS_INVITE_CODE\n   * Removed /user/recover/*email/:exp/:check resource\n   * Removed /user/recover/*email resource\n - Add Convos::Core::Settings, and removed support for many environment\n   settings, since they can now be changed through the web interface:\n   * CONVOS_CONTACT\n   * CONVOS_DEFAULT_CONNECTION / CONVOS_DEFAULT_SERVER\n   * CONVOS_FORCED_CONNECTION / CONVOS_FORCED_IRC_SERVER\n   * CONVOS_OPEN_TO_PUBLIC\n   * CONVOS_ORGANIZATION_NAME\n   * CONVOS_ORGANIZATION_URL\n   * MOJO_CONFIG\n - Add support for desktop notifications for all activities in a channel, closes #388\n - Fix calling setLastRead when going from conversation to a non-conversation\n - Fix getting desktop notifications from private messages\n - Fix showing initial desktop notification, when notifications have been enabled\n - Fix unicode issue when reading notifications, closes #412\n - Fix users are loaded in a predictable order on startup\n - Cannot edit dialog password if joined and not an operator #358\n - Changed \"Part\" button to \"Leave\" in conversation settings\n - Changed $app->sessions->secure(...) to be set on each request\n - Mention a quicker way to get to conversation settings in \"Help\"\n - Renamed /settings to /settings/account\n\n1.02 2019-11-13T16:02:05+0900\n - Fix Docker builds for main and tags #401\n   https://hub.docker.com/r/convos/convos\n - Fix service worker so it serves fresh assets #402\n - Fix cleaning user input #403\n - Fix \"convos dev\" command so it works with webpack\n - Fix loading messages and participant list when the conversation gain focus\n - Fix version number in api.json\n - Fix double rendering, where components would overlap each other\n - Fix rendering \"undefined\" when /api/embed.json fail #408\n - Fix showing settings icon on sidebar conversation hover\n - Fix \"/ISON CamelCaseNick\"\n - Will split messages that are too long #386\n - Will auto detect available themes #404\n   https://convos.chat/2019/11/2/custom-styling.html\n - Will postpone loading notification messages\n - Add offline page to the service worker cache #402\n - Add more complex caching rules to the service worker #402\n - Add \"Nord\" theme #405\n   https://www.nordtheme.com\n - Add a new css variable \"--input-focus-placeholder-color\" #409\n - Add support for picking up certificate files in development mode\n   https://convos.chat/doc/develop.html#secure-connection\n - Bumped LinkEmbedder to fix crashes in backend #408\n - Renamed \"last-read\" in the API to \"read\"\n - Renamed \"listNotifications\" in the API to \"notificationMessages\"\n\n1.01 2019-11-01T13:00:41+0900\n - Add handling for connection protocols #311\n - Add dark mode theme #313\n - Add password field to dialog settings #358\n - Add support for channels with \"/\" #365\n - Add unread count to hamburger menu #397\n - Add toggling of details to \"notice\" messages\n - Add upgrade of \"http\" embeds to \"https\"\n - Add warning screen to script/convos if started as root\n - Fix HTML entities at the end of links #362\n - Fix \"Not Found\" page #391\n - Fix duplicate messages after loading messages #396\n - Fix unresponsive hamburger menu while loading a dialog\n - Fix bugs related to join/part/mode events\n - Fix support for setting highlight_keywords\n - Fix loading participants list\n - Bumped Alpine version in Dockerfile\n\n1.00 2019-10-26T13:29:41+0900\n - Changed frontend to use https://svelte.dev/ from Vuejs.\n - Changed to using URLs, so you can link directly to conversations and pages\n   when chatting.\n - Changed sidebar design to a tree view, where conversations are listed under\n   connections.\n - Changed \"unread\" logic to reset to zero when conversations looses focus.\n - Changed notifications to be rendered as a conversation, with the latest\n   notifications in the bottom.\n - Changed notifications to be marked as read, when notifications conversation\n   looses focus.\n - Changed from using Material Design Icons to Font Awesome.\n - Changed twemoji, after emojione/joypixels changed their design.\n - Changed autocomplete dropdown to show when trigger character is seen. This\n   makes it work on phones as well.\n - Changed autocomplete for nicks: Nick has to be prefixed with \"@\".\n - Changed sidebar design for register/login pages, like we do on\n   https://convos.chat.\n - Replaced Mojolicious::Plugin::AssetPack with Mojolicious::Plugin::Webpack.\n - Add number of unread to document title #382\n - Add \"New messages\" indicator.\n - Add support for rendering quotes.\n - Add icons before nicks. The icon is calculated from the nick, so it does not\n   change between installations or reloads.\n - Add \"Autocomplete\" and \"Text formatting\" to /help.\n - Add toggle for error message details.\n - Improved filtering logic in sidebar.\n - Fix not including \")\" (or other special characters) when rendering links.\n - Fix rendering in Safari on iOS.\n - Fix handling of nicks with MixedCaps.\n - Fix reacting to window focus #383\n - Fix for ZNC integration: Connection name based on ZNC usernames #316\n - Removed the ShareDialog plugin.\n - Removed \"Create connection\" when registering. Will instead connect to the\n   default connection.\n - Removed custom styling support.\n - Bumped LinkEmbedder version to 1.06\n - Using \"pnpm\" (instead of \"npm\") to install node modules.\n\n0.99_40 2019-02-08T23:05:00+0100\n - Switch order of isconnect and ison to allow authentication with nickserv before join\n - Remove POD plugin which has been deprecated from Mojo core.\n - Update Alpine image\n - Fix duplicate key in schema\n\n0.99_39 2018-08-30T10:40:39+0200\n - Only keep one conversation open at a time.\n\n0.99_38 2018-08-20 15:09:00\n - Add support for disabling tls verification per connection (jberger)\n\n0.99_37 2018-08-16 11:43:00\n - Added -wn to perltidy for superior welding\n - Make convos a PWA\n - Add a delay helper until we can convert convos to promises\n\n0.99_36 2017-11-28T08:25:51+0200\n - Fix TLS detection when creating a connection #344\n - Fix message with empty content.\n - Remove obsolete AssetPack Reloader.\n\n0.99_35 2017-05-05T00:20:45+0200\n - Fix showing \":port\" when editing a connection #340\n - Fix changing server from default server on \"Create connection\" #345\n - Fix not leaking nick change events to all conversations\n - Fix video link embedder styling\n - Add support for CONVOS_FORCED_IRC_SERVER=\"irc://:password@host:port\" #343\n - Add hiding of chat elements for better rendering in iframe #21 #320 #346\n\n0.99_34 2017-04-24T10:04:55+0200\n - Fix \"create connection\"\n\n0.99_33 2017-04-22T00:09:58+0200\n - Fix \"/ison nick\" handling #336\n - Fix handling saving server username/password #334\n - Fix marking joined users as online\n - Fix showing error messages from IRC commands\n - Add missing \"!default\" to _variables.scss #313\n - Add support for CONVOS_LOG_FILE #337\n - Add nick changing feature from connection editor\n\n0.99_32 2017-04-17T22:30:54+0200\n - Fix annoying \"unread\" count increase on \"notice\"\n\n0.99_31 2017-04-14T13:40:04+0200\n - Fix autocompleting nicks by \"last seen\"\n - Fix background colors for chat and embeds\n - Fix online/offline state in private dialog using \"/ison nick\"\n - Fix private dialogs used to be \"in red\" after reconnect\n - Fix race condition when opening websocket connection\n - Fix rendering \"404 not found\" on unknown paste\n - Fix unread count is not increased when a private dialog user join/parts\n - Improved autocomplete logic for nicks and emojis\n - Add experimental MOTD (message of the day) handling\n - Add \"wanted_state\" to Core::Connection\n - Improved rendering of highlight messages\n\n0.99_30 2017-04-13T13:52:44+0200\n - Fix scrolling on \"Join dialog\" and \"Help\" pages #331\n - Add support for generating \"recover password\" link #302 #323\n - Add Convos::Plugin::Paste #328\n - Add support for sending multiline IRC messages #328\n - Using LinkEmbedder instead of Mojolicious::Plugin::LinkEmbedder\n - Will always have a default IRC server\n - Will not use unsafe secrets anymore\n\n0.99_29 2017-03-21T23:35:17+0100\n - Fix ShareDialog plugin\n - Fix custom assets with Mojolicious::Plugin::AssetPack 1.41\n - Add production 404 and 500 pages\n - Add logging about CONVOS_HOME on startup\n - Remove \"beforeConvosStart\" JavaScript event\n - Bump Mojolicious version to 7.29\n\n0.99_28 2017-03-15T01:34:20+0100\n - Fix keeping scroll at bottom in Firefox #324\n - Fix messages are grouped incorrectly on scrollback #301\n - Fix showing \"Day changed\" in historic messages\n - Will not mark message as \"highlight\" if sent by yourself\n\n0.99_27 2017-03-01T23:20:11+0100\n - Fix going to connection dialog after connection save\n - Fix hitting enter/return inside the \"Dialog name\" field on \"Join dialog\"\n - Fix joining channel which you are already part of\n - Fix reading invite_code from config file #322\n - Will detect if Javascript is disabled and notify user\n - Add support for embedding gist and other pasted text files\n - Add support for notifications on keywords #142\n\n0.99_26 2017-02-20T23:11:01+0100\n - Fix scrolling of sidebars and main menu\n - Change \"Edit profile\" to \"Settings\"\n\n0.99_25 2017-02-20T22:46:07+0100\n - Fix sending server messages to the right dialog\n - Fix joining a dialog by clicking on the dialog name\n - Fix first shown channel shows all users inactive #321\n - Fix creating dialog on /QUERY\n - Fix notifications are disabled when window is active\n - Add better handling of \"create dialog\" errors\n - Add functionality to only enrich visible links\n - Add better \"rich link\" caching\n - Add \"Convos icon\" to notification popup\n - Change default sorting to \"lastRead\"\n\n0.99_24 2017-01-29T00:57:30+0100\n - Fix registration process\n - Fix being able to show profile + help during wizard\n - Fix width of embedded youtube videos on small screens\n - Fix zooming images inline in chat\n - Fix not matching markdown, because a link was injected\n - Fix \"/me message your_nick\" mention rendering\n - Fix markdown rendering\n - Improved materialbox rendering for huge images\n - Can send/receive any IRC message #317\n - Add \"esc key\" to close on materialbox\n - Add listing of available rooms to \"Join dialog...\" #309\n\n0.99_23 2017-01-13T23:05:39+0100\n - Fix adding notifications in frontend\n - Fix saving userinfo in connection URL\n - Will close dropdown when clicking outside of the dropdown\n - Will ask for password if channel has mode +k\n\n0.99_22 2017-01-10T23:32:19+0100\n - Fix use of CONVOS_ORGANIZATION_URL #307\n - Fix unread count should not be increased on join/part/quit/... messages\n - Fix going from \"disconnected\" to \"reconnect\" on connection save\n - Add connection state selector to connection editor\n - Change \"Profile\" to open in main dialog area\n - Change \"Help\" to open in main dialog area\n - Compatible with Mojolicious 7.15\n - Tweaking colors\n\n0.99_21 2017-01-08T14:41:21+0100\n - Fix race condition when creating the websocket connection\n - Fix setting main dialog location on initial load\n - Fix not showing unread count for active channel\n - Fix sending \"/names\" on join #303\n - Fix parsing \"/names\" response #308\n - Add support for CONVOS_ORGANIZATION_URL #307\n - Add \"get_user\" websocket method\n\n0.99_20 2016-12-29T21:00:43+0100\n - Fix will not reconnect without host/port change\n - Add \"close\" icon to main menu conversations\n\n0.99_19 2016-12-06T14:43:43+0100\n - Fix loading message log after events have been received in background\n\n0.99_18 2016-12-04T20:39:43+0100\n - Fix IRC username cannot contain special characters #296\n - Fix parsing IRC user modes dynamically #287\n - Fix \"Goto anything\" sorts by dialog name length\n - Fix queuing connections after connection errors\n - Fix API URL when mounting Convos inside on non-root reverse proxy config\n - Fix handling of new private messages #298\n - Add EXPERIMENTAL sort by last-read/activity\n - Add Dockerfile\n - Add \"disable expanding links\" setting in profile\n - Server messages can be read in frontend\n - Server settings can be edited in the \"info\" sidebar\n\n0.99_17 2016-11-11T09:58:54+0200\n - Add support for editing on_connect_commands\n - Add support for JSON config - https://convos.chat/doc/config.html#introduction\n\n0.99_16 2016-11-08T13:37:58+0200\n - Fix getting historic messages, without duplicates #292\n - Fix getting messages from channel with \".\" in the name #293\n - Add custom styling for participants that are not currently in the channel\n - Add EXPERIMENTAL support for pluggable authentication #89\n - Add support for setting CONVOS_HOME from config file as \"home\" #289\n\n0.99_15 2016-10-13T22:51:01+0200\n - Fix IRC join channel redirect #284\n - Fix parting IRC channel, even if not in the channel\n - Fix highlight color in chat\n - Fix keeping on_connect_commands\n - Improved keeping scroll position to bottom #269\n\n0.99_14 2016-10-06T22:42:15+0200\n - Autocomplete on nick will start from the beginning of the word\n - Do not autocomplete on \"enter\"\n - Improved keeping scroll position to bottom #269\n - Improved keeping scroll position when loading historic messages\n\n0.99_13 2016-10-03T09:40:15+0200\n - Fix clearing Convos.settings.sidebar on mobile\n - Fix resetting max-height\n\n0.99_12 2016-10-03T09:31:02+0200\n - Less icons in header\n - Fix <convos-input/> from overlapping main area\n - Add CustomEvent and dispatchEvent polyfill #282\n - Improved scrolling to bottom logic #269\n\n0.99_11 2016-09-19T23:05:31+0200\n - Fix \"whois\" for participant who is not in any channels\n - Fix removing IRC colors #281\n - Add more information to <convos-message-whois/>\n - Add first optional plugin \"ShareDialog\" #280\n\n0.99_10 2016-09-14T23:35:31+0200\n - Fix handling of \"/whois nick\" when \"nick\" is offline\n - Fix tracking join/part/quit/nick change events #276\n - Fix handling IRC server replies with strange casing #277\n - Will not truncate files when disk is full\n - Normalizing email address for user\n - Add translation for :), :( and <3 into emojis\n - Can select TLS on connect\n\n0.99_09 2016-09-11T22:53:31+0200\n - Fix sorting participants list\n - Add support for /ns (/msg nickserv)\n - Add support for /cs (/msg chanserv)\n - Add clickable emails #265\n - Add support for markdown formatting for <code/>\n - Add support for rendering emojis #186\n - Add support for autocomplete emoji in <convos-input/> #186\n - Add support for custom color themes #161\n - Change dialog settings less confusing\n   * Render dialog title with markdown formatting and links\n   * Getting participants list is more consistent after reconnect\n   * Changed rendering of \"close\" button into a list item\n - Change autocomplete method for <convos-input/>\n\n0.99_08 2016-09-01T22:35:25+0200\n - Fix emitting topic changes to frontend\n - Add dialog settings sidebar with topic and participants list\n - Add support for \"/query nick\"\n - Remove settings dropdown menu\n - Replaced Roboto with system fonts\n\n0.99_07 2016-08-30T10:51:25+0200\n - Fix showing join/part messages in the correct channel\n - Fix running Convos on Windows mobile #271\n - Add favicon and app icons for iOS\n - Add basic support for \"/mode ...\"\n - Add support for \"/kick ...\"\n - Change \"convos version\" to also display running Convos version\n - Replaced \"info\" button with \"settings\" button for dialogs\n\n0.99_06 2016-08-27T12:27:13+0200\n - Fix tracking participants\n - Fix joining channel with key in backend #268\n - Fix joining channel with key in <convos-create-dialog/> #267\n - Fix handling \"part\" events\n - Fix starting \"script/convos dev\" after \"script/convos install --develop\"\n - Fix not show welcome message after log in in in a new browser\n - Fix running test suite with \"script/convos test\"\n - Fix no autocomplete in \"Join dialog\" or \"Add connection\"\n - Fix parsing UTC time in Firefox\n - Add Mojo::IRC 0.33 as required module #267\n - Add IO::Socket::SSL as required module\n   * Required to connect to TLS networks\n   * Required to fetch meta data from https resources\n - Change calculation of dialog.unread to server side\n - Change WebSocket keep-alive interval\n - Change \"Join dialog\" will be shown after a new connection is created\n - Change <convos-message-enable-notifications/> buttons to be disabled on click\n\n0.99_05 2016-08-22T16:30:57+0200\n - Fix breaking long words inside a message template\n - Fix only show nick change in the channels where the nick is active\n - Fix goto anything\n - Fix reading unicode (\u00e6\u00f8\u00e5) back from file\n - Fix dialog.frozen after webscocket comes back online\n - Fix skip installing dev deps by default\n - Fix handling of config file values\n - Fix \"send\" button in <convos-input/>\n - Fix missing Time::Piece on redhat #266\n - Add fetching connections, dialogs and notifications together with user object\n - Add icon to indicate that the WebSocket is down\n - Add last_read() to Convos::Core::Dialog\n - Add sorting of dialogs by lastRead\n - Add support for \"forced_irc_server\"\n - Add clicking on a notitication takes you to the dialog\n - Bundled cpanm, used by \"script/convos install\" (less dependencies)\n - Change client to keep WebSocket alive instead of backend\n - Converted Swagger2 to OpenAPI\n - Converted jQuery dependencies to Vue components\n - Converted Guides to gh-pages branch - http://convos.chat/doc\n\n0.99_04 2016-08-15T16:33:45+0200\n - Fix Could not send \"\\nsome message\": Unable to construct PRIVMSG.\n - Fix remove dialogs when connection is deleted\n - Add search for dialogs\n - Add jump between search and input field\n - Add better rendering on small screens\n - Add count of unseen notifications\n - Add <convos-settings/> which includes wizard, connection editor and dialog creator\n - Add support for invite code\n - Add number of unread messages\n - Add handling of join, nick_change and part events\n - Add support for desktop notifications\n - Change layout: Big green menu on top\n - Change dialog list to be sorted alphabetically\n - Converted vue templates to .vue files\n - Converted data-hint=\"\" to v-tooltip=\"\"\n - Remove hash/fragment navigation\n - Remove EventSource. Going for WebSocket only.\n\n0.99_03 2016-07-21T17:10:57+0200\n - Fix swagger spec: datetime != date-time\n - Fix parting channel when not connected\n - Fix appearance on small screens\n - Fix saving list of dialogs on every join\n - Fix autocomplete commands and nicks case insensitive\n - Add messages in backend are stored with \"highlight\" flag\n - Add notifications in frontend\n - Add loading of more messages when scrolling to top\n\n0.99_02 2016-04-15T08:47:56+0200\n - Fix automatic install require App::cpanminus 1.7016+\n - Fix confusing edit connections icon\n - Fix encode dialog.idvos to %23convos\n - Fix searching for messages in backend\n - Fix sending ACTION messages\n - Fix marking dialogs/connections as disconnected on websocket close\n - Add filter to render messages containing markdown\n - Add \"day changed\" indicator\n - Add whois action to user list and add whois data handler\n - Using Mojolicious::Plugin::AssetPack 1.04\n - Converted JavaScript from riot.js to vue.js\n\n0.99_01 2016-04-02T14:18:39+0200\n - Fix embedding images\n - Fix CTCP action messages on local echo\n - Add \"script/convos dev\" sub-command\n - Add \"script/convos install\" sub-command\n - Add styling of mentions and notice\n - Add handling of whois and topic reponses\n - Add support for sending IRC commands\n - Add /help command\n - Add rendering of autocomplete room list\n - Add autocomplete to <user-input/>\n\n0.99_01 2016-02-28T16:23:44+0200\n - Add config file support\n - Add default (insecure) secrets\n - Add initial Swagger specification\n - Add support for X-Request-Base\n - Add support for setting secure cookies\n - Add auto-detection of TLS/plain text IRC servers\n - Add \"steal nick\" logic\n - Add new layout with sidebars instead of top menu navigation\n - Add riot.js to render web pages\n - Add Convos::Core look-alike objects in JavaScript\n - Add router which acts upon location hash (fragment)\n - Add Swagger over WebSocket communication\n - Add scrollToBottom() on new messages\n - Add handling of highlighted messages in backend\n - Add expanding links in chat to meta data\n - Add Convos::Core\n - Add Convos::Core::Connection::IRC\n - Add Convos::Core::Room\n - Add Convos::Core::User\n\n0.99_00 2015-02-02T15:40:40+0200\n - Started rewriting Convos\n", "import {emojis} from '../../public/emojis/0bf11a9aff0d6da7b46f1490f86a71eb.json';\nimport {i18n} from '../../assets/store/I18N';\n\ntest('l()', () => {\n  expect(i18n.l('Test')).toBe('Test');\n  expect(i18n.l('Test %1', 42)).toBe('Test 42');\n\n  i18n.update({lang: 'en'});\n  i18n.dictionaries.en = {'Test %1': 'Foo %1 bar!'};\n  expect(i18n.l('Test %1', 42)).toBe('Foo 42 bar!');\n\n  i18n.dictionaries.no = {'See %1': 'Se %1!'};\n  i18n.update({lang: 'no'});\n  expect(i18n.l('Se %1!', 42)).toBe('Se 42!');\n});\n\ntest('lmd()', () => {\n  expect(i18n.lmd('`code` %1 *is* cool.', 42)).toBe('<code>code</code> 42 <em>is</em> cool.');\n\n  // Entities should not be translated into \"undefined\"\n  expect(i18n.lmd('https://commons.wikimedia.org/wiki/File:HK_WCD_WC_%E7%81%A3%E4%BB%94_Wan_Chai_%E8%BB%92%E5%B0%BC%E8%A9%A9%E9%81%93_Hennessy_Road_tram_body_ads_Tsingtao_Brewery_August_2021_SS2.jpg'))\n    .toBe('<a href=\"https://commons.wikimedia.org/wiki/File:HK_WCD_WC_%E7%81%A3%E4%BB%94_Wan_Chai_%E8%BB%92%E5%B0%BC%E8%A9%A9%E9%81%93_Hennessy_Road_tram_body_ads_Tsingtao_Brewery_August_2021_SS2.jpg\" target=\"_blank\">commons.wikimedia.org/wiki/File:HK_WCD_WC_%E7%81%A3%E4%BB%94_Wan_Chai_%E8%BB%92%E5%B0%BC%E8%A9%A9%E9%81%93_Hennessy_Road_tram_body_ads_Tsingtao_Brewery_August_2021_SS2.jpg</a>');\n});\n\ntest('md - raw', () => {\n  expect(i18n.md('> [not a link](https://convos.chat) `<a href=\"#cool\" onclick=\"\"></a>`', {raw: true}))\n    .toBe('&gt; [not a link](https://convos.chat) `&lt;a href=&quot;#cool&quot; onclick=&quot;&quot;&gt;&lt;/a&gt;`');\n});\n\ntest('md - whitespace', () => {\n  expect(i18n.md('')).toBe('&nbsp;');\n  expect(i18n.md('', {})).toBe('&nbsp;');\n  expect(i18n.md('', {raw: true})).toBe('&nbsp;');\n  expect(i18n.md(' f   b a      r ', {raw: true})).toBe('&nbsp;f &nbsp; b a &nbsp; &nbsp; &nbsp;r&nbsp;');\n  expect(i18n.md('')).toBe('&nbsp;');\n  expect(i18n.md('    ___ ___  _  ___   _____  ___'))\n    .toBe('&nbsp; &nbsp; ___ ___ &nbsp;_ &nbsp;___ &nbsp; _____ &nbsp;___');\n});\n\ntest('md - unchanged', () => {\n  expect(i18n.md('foo')).toBe('foo');\n  expect(i18n.md('Some text!')).toBe('Some text!');\n});\n\ntest('md - blockquote', () => {\n  expect(i18n.md('> Some quote'))\n    .toBe('<blockquote>Some quote</blockquote>');\n  expect(i18n.md('> escape <a href=\"#foo\">bar</a>'))\n    .toBe('<blockquote>escape &lt;a href=&quot;#foo&quot;&gt;bar&lt;/a&gt;</blockquote>');\n});\n\ntest('md - code', () => {\n  expect(i18n.md('> Some `code example` yeah'))\n    .toBe('<blockquote>Some <code>code example</code> yeah</blockquote>');\n  expect(i18n.md('Some `code with **[foo](#bar)**`'))\n    .toBe('Some <code>code with **[foo](#bar)**</code>');\n  expect(i18n.md('single `a` char'))\n    .toBe('single <code>a</code> char');\n  expect(i18n.md('is this \\\\`not code`, or..?'))\n    .toBe('is this `not code`, or..?');\n  expect(i18n.md('is this `not code`, or..?'))\n    .toBe('is this <code>not code</code>, or..?');\n  expect(i18n.md('not a `https://link.com`'))\n    .toBe('not a <code>https://link.com</code>');\n  expect(i18n.md('a regexp: `TShop\\.Setup\\(\\s*([{](?>[^\\\\\"{}]+|\"(?>[^\\\\\"]+|\\\\[\\S\\s])*\"|\\\\[\\S\\s]|(?-1))*[}])`'))\n    .toBe('a regexp: <code>TShop\\.Setup\\(\\s*([{](?&gt;[^\\\\&quot;{}]+|&quot;(?&gt;[^\\\\&quot;]+|\\\\[\\S\\s])*&quot;|\\\\[\\S\\s]|(?-1))*[}])</code>');\n  expect(i18n.md('kikuchi` changed nick to kikuchi```.'))\n    .toBe('kikuchi` changed nick to kikuchi```.');\n});\n\ntest('md - em, strong', () => {\n  expect(i18n.md('> Some *em text* right'))\n    .toBe('<blockquote>Some <em>em text</em> right</blockquote>');\n  expect(i18n.md('Some **strong text** right'))\n    .toBe('Some <strong>strong text</strong> right');\n  expect(i18n.md('Some ***strong em text*** right'))\n    .toBe('Some <em><strong>strong em text</strong></em> right');\n  expect(i18n.md('> Some * em text* right'))\n    .toBe('<blockquote>Some * em text* right</blockquote>');\n\n  // Quotes should always be escaped - Pretect against XSS\n  expect(i18n.md('Hey *foo* \\'\"**bar**\"\\' ***baz***!'))\n    .toBe('Hey <em>foo</em> &apos;&quot;<strong>bar</strong>&quot;&apos; <em><strong>baz</strong></em>!');\n});\n\ntest('md - colors', () => {\n  expect(i18n.md('\\x02bold text\\x02')).toBe('<strong>bold text</strong>');\n  expect(i18n.md('\\x1ditalic text\\x1d')).toBe('<em>italic text</em>');\n  expect(i18n.md('\\u00035colored text\\x03')).toBe('<span style=\"color:brown\">colored text</span>');\n  expect(i18n.md('\\u00034,12colored text and background\\u0003')).toBe('<span style=\"color:red;background-color:lightblue\">colored text and background</span>');\n});\n\ntest('md - emojis', () => {\n  i18n.emojis._load(emojis);\n  expect(countEmojis(':) :/ :( ;D &lt;3 :D :P ;) :heart:')).toBe(8);\n  expect(i18n.md('wouldn\\'t it need :// too?'))\n    .toBe('wouldn&apos;t it need :// too?');\n  expect(i18n.md('but :/. turns into an emoji'))\n    .toMatch(/but <img.*[^>]+>. turns into an emoji/);\n});\n\ntest('md - url', () => {\n  expect(i18n.md('A link to https://convos.chat, cool ey?'))\n    .toBe('A link to <a href=\"https://convos.chat\" target=\"_blank\">convos.chat</a>, cool ey?');\n  expect(i18n.md('A link to http://convos.chat, cool ey?'))\n    .toBe('A link to <a href=\"http://convos.chat\" target=\"_blank\">http://convos.chat</a>, cool ey?');\n  expect(i18n.md('A link to mailto:jhthorsen@cpan.org!'))\n    .toBe('A link to <a href=\"mailto:jhthorsen@cpan.org\" target=\"_blank\">jhthorsen@cpan.org</a>!');\n  expect(i18n.md('https://ru.wikipedia.org/wiki/\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u0446\u0430:Gryllida/\u0427\u0435\u0440\u043d\u043e\u0432\u0438\u043a last symbol shows as separate outside of the URL? do you reproduce the bug?'))\n    .toBe('<a href=\\\"https://ru.wikipedia.org/wiki/\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u0446\u0430:Gryllida/\u0427\u0435\u0440\u043d\u043e\u0432\u0438\u043a\\\" target=\\\"_blank\\\">ru.wikipedia.org/wiki/\u0423\u0447\u0430\u0441\u0442\u043d\u0438\u0446\u0430:Gryllida/\u0427\u0435\u0440\u043d\u043e\u0432\u0438\u043a</a> last symbol shows as separate outside of the URL? do you reproduce the bug?');\n  expect(i18n.md('[mojo] marcusramberg opened pull request #1894: Minor tweaks to Growing guide. - https://git.io/JD9ph'))\n    .toBe('[mojo] marcusramberg opened pull request #1894: Minor tweaks to Growing guide. - <a href=\\\"https://git.io/JD9ph\\\" target=\\\"_blank\\\">git.io/JD9ph</a>');\n\n  // Protect against XSS\n  expect(i18n.md('https://x.\"//onfocus=\"alert(document.domain)\"//autofocus=\"\" b=\"'))\n    .toBe('<a href=\"https://x.&quot;//onfocus=&quot;alert(document.domain)&quot;//autofocus=&quot;\" target=\"_blank\">x.&quot;//onfocus=&quot;alert(document.domain)&quot;//autofocus=&quot;</a>&quot; b=&quot;');\n});\n\ntest('md - markdown link', () => {\n  expect(i18n.md('some [cool chat](https://convos.chat)'))\n    .toBe('some <a href=\"https://convos.chat\" target=\"_blank\">cool chat</a>');\n});\n\ntest('md - channel names', () => {\n  expect(i18n.md('want to join #foo-1.2 #foo-bar href=\"#anchor\" #foo.bar'))\n    .toBe('want to join <a href=\"./%23foo-1.2\">#foo-1.2</a> <a href=\"./%23foo-bar\">#foo-bar</a> href=&quot;#anchor&quot; <a href=\"./%23foo.bar\">#foo.bar</a>');\n});\n\nfunction countEmojis(str) {\n  return i18n.md(str).match(/class=\"emoji\"/g).length;\n}\n", "import Emojis from '../js/Emojis';\nimport Reactive from '../js/Reactive';\nimport {api} from '../js/Api';\nimport {derived} from 'svelte/store';\n\nconst ESCAPE = {'&': '&amp;', '<': '&lt;', '>': '&gt;', \"'\": '&apos;', '\"': '&quot;'};\nconst escape = (str, re = /[&<>'\"]/g) => str.replace(re, (m) => ESCAPE[m]);\nconst nbsp = (str) => str.replace(/\\s$/, '&nbsp;').replace(/^\\s/, '&nbsp;').replace(/\\s{2}/g, ' &nbsp;');\nconst tagPair = (tags) => [tags.map(n => `<${n}>`).join(''), tags.reverse().map(n => `</${n}>`).join('')];\n\nconst COLORS = {\n   '0': 'white',\n   '1': 'black',\n   '2': 'blue',\n   '3': 'green',\n   '4': 'red',\n   '5': 'brown',\n   '6': 'magenta',\n   '7': 'orange',\n   '8': 'yellow',\n   '9': 'lightgreen',\n  '10': 'cyan',\n  '11': 'lightcyan',\n  '12': 'lightblue',\n  '13': 'pink',\n  '14': 'grey',\n  '15': 'lightgrey',\n};\n\nexport default class I18N extends Reactive {\n  constructor() {\n    super();\n\n    this.prop('cookie', 'lang', '');\n    this.prop('ro', 'dictionaries', {});\n    this.prop('ro', 'emojis', new Emojis());\n    this.prop('ro', 'languages', () => this._languages);\n    this.prop('ro', 'languageOptions', () => this._languageOptions);\n\n    this._languages = [];\n    this._languageOptions = [];\n    this._rules = this._makeRules();\n  }\n\n  /**\n   * Will take a lexicon and string variables and return a human readable\n   * string. Falls back on returning the input lexicon if no translation\n   * is provided.\n   *\n   * @param {String} lexicon.\n   * @param {...String} A list (not array) of lexicon variables.\n   * @return {String} A translated string.\n   */\n  l(lexicon, ...vars) {\n    const dictionary = this.dictionaries[this.lang] || {};\n    const translated = String(dictionary[lexicon] || lexicon);\n    return translated.replace(/%(\\d)(\\D|$)/g, (all, i, s) => {\n      return typeof vars[i - 1] == 'undefined' ? all : (vars[i - 1] + s);\n    });\n  }\n\n  /**\n   * Load a dictionary.\n   *\n   * @param {String} lang Language such as \"en\", \"es\", \"it\", \"no\", ...\n   * @return {Promise} The promise will be fulfilled when the dictionary is fetched and parsed.\n   */\n  async load(lang) {\n    if (!lang) lang = this.lang || document.documentElement.getAttribute('lang');\n    if (this.dictionaries[lang]) return this.update({lang});\n    const op = await api('/api', 'getDictionary', {lang}).perform();\n    this.dictionaries[lang] = op.res.body.dictionary;\n    this._languages = op.res.body.available_languages || {};\n    this._languageOptions = Object.keys(this._languages).sort().map(id => [id, this._languages[id].language_team.replace(/\\s*<.*/, '')]);\n    return this.update({lang});\n  }\n\n  /**\n   * Combination of l() and md().\n   *\n   * @param {String} lexicon.\n   * @param {...String} A list (not array) of lexicon variables.\n   * @return {String} A translated string which might contain HTML.\n   */\n  lmd(lexicon, ...vars) {\n    return this.md(this.l(lexicon, ...vars));\n  }\n\n  /**\n   * Combination of l() and md(), but will only render some parts.\n   *\n   * @param {String} lexicon.\n   * @param {...String} A list (not array) of lexicon variables.\n   * @return {String} A translated string which might contain HTML.\n   */\n  lmdRaw(lexicon, ...vars) {\n    return this.md(this.l(lexicon, ...vars), {raw: true});\n  }\n\n  /**\n   * md() can convert a (subset) of markdown rules into a HTML string.\n   *\n   * @example\n   * // Hey <em>foo</em> <strong>bar</strong> <em><strong>baz</strong></em> <em><strong>baz</strong></em>\n   * i18n.md(\"Hey *foo* **bar** ***baz***!\");\n   *\n   * // A <a href=\"https://convos.chat\">link</a>\n   * i18n.md(\"A [link](https://convos.chat)\");\n   *\n   * // A link to <a href=\"https://convos.chat\" target=\"_blank\">convos.chat</a>\n   * i18n.md('A link to https://convos.chat');\n   *\n   * // A link to <a href=\"mailto:jhthorsen@cpan.org\" target=\"_blank\">jhthorsen@cpan.org</a>\n   * i18n.md('A link to mailto:jhthorsen@cpan.org');\n   *\n   * // Example <code>snippet</code>\n   * i18n.md(\"Example `snippet`\");\n   *\n   * // <img class=\"emoji\" draggable=\"false\" alt=\"\ud83d\ude42\" src=\"...\"> ...\n   * i18n.md(':) :/ :( ;D &lt;3 :D :P ;) :heart:');\n   *\n   * @param {String} str A markdown formatter string.\n   * @param {Object} opt Options for rendering, such as \"raw\"\n   * @return {String} A string that might contain HTML tags.\n   */\n  md(str, opt = {}) {\n    return !str.length ? '&nbsp;'\n         : opt.raw ? nbsp(escape(str))\n         : this.emojis.markup(nbsp(this._tagToHTML(this._makeTag(str))));\n  }\n\n  _makeRules() {\n    const rules = [];\n\n    rules.push({tag: tagPair(['code']), re: /`(?=[^`\\s])/, rules: [], handler: '_mdTag'});\n    rules.push({tag: tagPair(['em', 'strong']), re: /\\*\\*\\*(?=\\S)/, rules, handler: '_mdTag'});\n    rules.push({tag: tagPair(['strong']), re: /\\*\\*(?=\\S)/, rules, handler: '_mdTag'});\n    rules.push({tag: tagPair(['em']), re: /\\*(?=\\S)/, rules, handler: '_mdTag'});\n    rules.push({tag: tagPair(['span']), re: /\\x03\\d{1,2}(?:,\\d{1,2})?/, rules, handler: '_mdIrcColorFormatting'});\n    rules.push({tag: tagPair(['span']), re: /[\\x02\\x1d\\x1e\\x1f\\x11]/, rules, handler: '_mdIrcTextFormatting'});\n    rules.push({tag: tagPair(['a']), re: /\\[([a-zA-Z][^\\]]+)\\]\\(([^)]+)\\)/, rules: [], handler: '_mdLink'});\n    rules.push({tag: tagPair(['a']), re: /\\b(https?|mailto):\\S+/, rules: [], handler: '_mdURL'});\n    rules.push({tag: tagPair(['a']), re: /(?<=\\s|^)#[a-zA-Z][\\w.-]+(?=\\W|$)/, rules: [], handler: '_mdChannelname'});\n\n    return rules;\n  }\n\n  _makeTag(str, rules = this._rules, depth = 0) {\n    // blockquote\n    if (depth == 0 && str.indexOf('> ') == 0) {\n      return [tagPair(['blockquote']), {}, [this._makeTag(str.replace(/^>\\s/, ''), rules, depth + 1)]];\n    }\n\n    const children = [];\n    for (const rule of rules) {\n      const match = str.match(rule.re);\n      if (!match) continue;\n\n      const tag = {\n        attrs: {},\n        after: str.substring(match.index + match[0].length),\n        before: str.substring(0, match.index),\n        captured: match[0],\n        index: match.index,\n        match,\n        tag: rule.tag,\n      };\n\n      this[rule.handler](tag);\n      if (typeof tag.content !== 'string') {\n        str = tag.before + tag.captured + tag.after;\n        continue;\n      }\n\n      if (tag.before.length) children.push(this._makeTag(tag.before, rules, depth + 1));\n      children.push([tag.tag, tag.attrs, [this._makeTag(tag.content, rule.rules, depth + 1)]]);\n      if (tag.after.length) children.push(this._makeTag(tag.after, rules, depth + 1));\n      break;\n    }\n\n    return [null, {}, children.length ? children : [escape(str)]];\n  }\n\n  _mdChannelname(tag) {\n    tag.content = tag.captured;\n    tag.attrs.href = './' + encodeURIComponent(tag.captured);\n  }\n\n  // https://modern.ircdocs.horse/formatting.html\n  _mdIrcColorFormatting(tag) {\n    const end = tag.after.indexOf('\\x03');\n    if (end == -1) return;\n    tag.content = tag.after.substring(0, end);\n    tag.after = tag.after.substring(end + tag.captured.length);\n\n    const style = [];\n    const color = tag.captured.replace(/\\x030?(\\d{1,2}).*/, '$1');\n    if (COLORS[color]) style.push('color:' + COLORS[color]);\n    const background = tag.captured.replace(/.*,(\\d{1,2}).*/, '$1');\n    if (COLORS[background]) style.push('background-color:' + COLORS[background]);\n    if (style.length) tag.attrs.style = style.join(';');\n  }\n\n  // https://modern.ircdocs.horse/formatting.html\n  _mdIrcTextFormatting(tag) {\n    const end = tag.after.indexOf(tag.captured);\n    if (end == -1) return;\n\n    tag.content = tag.after.substring(0, end);\n    tag.after = tag.after.substring(end + tag.captured.length);\n    tag.tag = tag.captured == '\\x02' ? tagPair(['strong'])\n              : tag.captured == '\\x1d' ? tagPair(['em'])\n              : tag.captured == '\\x1f' ? tagPair(['u'])\n              : tag.captured == '\\x11' ? tagPair(['code'])\n              : tagPair(['span']);\n  }\n\n  _mdLink(tag) {\n    tag.content = tag.match[1];\n    tag.attrs.href = escape(tag.match[2]);\n    if (tag.match[2].match(/^\\w+:/)) tag.attrs.target = '_blank';\n  }\n\n  _mdTag(tag) {\n    // Check if the matched character was escaped\n    if (tag.before.match(/\\\\$/)) {\n      tag.before = tag.before.replace(/\\\\$/, '');\n      return;\n    }\n\n    const end = tag.after.indexOf(tag.captured);\n    if (end == -1) return;\n    tag.content = tag.after.substring(0, end);\n    tag.after = tag.after.substring(end + tag.captured.length);\n  }\n\n  _mdURL(tag) {\n    tag.captured = tag.captured.replace(/[,.:;!\"\\']$/, (after) => {\n      tag.after = after[0] + tag.after;\n      return '';\n    });\n\n    tag.content = tag.captured.replace(/^(https|mailto):(\\/\\/)?/, '');\n    tag.attrs.href = escape(tag.captured);\n    tag.attrs.target = '_blank';\n  }\n\n  _tagToHTML(tag) {\n    if (typeof tag === 'string') return tag;\n\n    const inner = typeof tag[2] === 'string' ? escape(tag[2]) : tag[2].map(n => this._tagToHTML(n)).join('');\n    if (!tag[0]) return inner;\n\n    const attrs = Object.keys(tag[1]).sort().map(k => `${k}=\"${tag[1][k]}\"`).join(' ');\n    const startTag = !attrs ? tag[0][0] : tag[0][0].replace(/>/, ' ' + attrs + '>');\n    return startTag + inner + tag[0][1];\n  }\n}\n\nexport const i18n = new I18N();\nexport const l = derived(i18n, ($i18n) => (...params) => $i18n.l(...params));\nexport const lmd = derived(i18n, ($i18n) => (...params) => $i18n.lmd(...params));\n"], "filenames": ["Changes", "__tests__/store/I18N.js", "assets/store/I18N.js"], "buggy_code_start_loc": [4, 22, 2], "buggy_code_end_loc": [6, 88, 187], "fixing_code_start_loc": [4, 22, 1], "fixing_code_end_loc": [13, 127, 257], "type": "CWE-79", "message": "Convos is an open source multi-user chat that runs in a web browser. Characters starting with \"https://\" in the chat window create an <a> tag. Stored XSS vulnerability using onfocus and autofocus occurs because escaping exists for \"<\" or \">\" but escaping for double quotes does not exist. Through this vulnerability, an attacker is capable to execute malicious scripts. Users are advised to update as soon as possible.", "other": {"cve": {"id": "CVE-2022-21649", "sourceIdentifier": "security-advisories@github.com", "published": "2022-01-04T21:15:07.883", "lastModified": "2022-01-08T02:46:40.037", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Convos is an open source multi-user chat that runs in a web browser. Characters starting with \"https://\" in the chat window create an <a> tag. Stored XSS vulnerability using onfocus and autofocus occurs because escaping exists for \"<\" or \">\" but escaping for double quotes does not exist. Through this vulnerability, an attacker is capable to execute malicious scripts. Users are advised to update as soon as possible."}, {"lang": "es", "value": "Convos es un chat multiusuario de c\u00f3digo abierto que es ejecutado en un navegador web. Los caracteres que empiezan por \"https://\" en la ventana de chat crean una etiqueta (a). Una vulnerabilidad de tipo XSS almacenada que usa onfocus y autofocus se produce porque el escape se presenta para \"(\" o \")\" pero el escape para las comillas dobles no se presenta. Mediante esta vulnerabilidad, un atacante es capaz de ejecutar scripts maliciosos. Se aconseja a usuarios que actualicen lo antes posible"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 7.6, "baseSeverity": "HIGH"}, "exploitabilityScore": 2.3, "impactScore": 4.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:convos:convos:*:*:*:*:*:*:*:*", "versionEndExcluding": "6.52", "matchCriteriaId": "DA5BCD6B-4CE6-430F-BD22-D399291AEFDB"}]}]}], "references": [{"url": "https://blog.pocas.kr/2021/12/30/2021-12-30-s-xss-convos-chat/#Second-vulnerability", "source": "security-advisories@github.com", "tags": ["Broken Link", "Third Party Advisory"]}, {"url": "https://github.com/convos-chat/convos/commit/86b2193de375005ba71d9dd53843562c6ac1847c", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/convos-chat/convos/security/advisories/GHSA-xmpj-xwm3-vww7", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://www.huntr.dev/bounties/4532a0ac-4e7c-4fcf-9fe3-630e132325c0/", "source": "security-advisories@github.com", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/convos-chat/convos/commit/86b2193de375005ba71d9dd53843562c6ac1847c"}}